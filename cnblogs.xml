<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-01-16T04:37:29.411Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ ç»äºæ¾å°äºä¸æ¬¾è¶³å¤ç®åçä»»å¡ç®¡çè½¯ä»¶ ]]></title>
    <link>https://www.cnblogs.com/lbnnbs/p/19491338</link>
    <guid>6fa5eb3ac4adc33286601d557a1ddef9</guid>
    <description>
    <![CDATA[ 
        <div class="postTitle">
            <h1><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/lbnnbs/p/19491338" title="åå¸äº 2026-01-16 12:23">
    <span role="heading" aria-level="2">ç»äºæ¾å°äºä¸æ¬¾è¶³å¤ç®åçä»»å¡ç®¡çè½¯ä»¶</span>
    

</a>
</h1>
        </div>
        <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
ç°å¨å¤§å®¶ä¸ä½ä¼æ¯æ¶é´å¾ç¢çåï¼å·¥ä½æ¶é´å¾å¤æ¶åé½æ¯ç¢çåçãä¸ºäºç®¡çå¥½èªå·±çå·¥ä½ï¼æåç±»è½¯ä»¶é½ä½¿ç¨è¿ãä½å¸é¢ä¸å¤æ°å·¥å·è¦ä¹åè½ç¹æï¼è¦ä¹ä¸æ¯æææºçï¼è¦ä¸å°±æ¯æ¶è´¹å¤ªè´µï¼çä¸æ¯æè¿æ ·çå°ç½è½ç¨çèµ·çãæä¸ªäººä½¿ç¨è¿ä½¿ç¨è¿å¾å¤çå·¥ä½ä»»å¡ç®¡çè½¯ä»¶ï¼æé¡¹ç®ç®¡çç±»çï¼æä¾¿ç­¾ç±»çï¼ææ¥ç¨ç±»çãä½é¡¹ç®ç®¡çç±»çæä½è¿äºå¤æï¼æ¥ç¨ç±»åä¾¿ç­¾ç±»çåæ²¡æå¢éåä½åè½ãæ»ä¹å¾é¾æ¾ä¸æ¬¾ç®åå¥½ç¨çå°å¢éå°é¡¹ç®ä»»å¡ç®¡çè½¯ä»¶ãåæ¥ç¾åº¦çæ¶åæç´¢å°äºä¸æ¬¾å«ä¹è¿ä»»å¡å®çå°å·¥å·ï¼å®å®ç½ä¸å¼ºè°ä»¥ âç®åãè½»å¿«ãå¥½ç¨â ä¸ºæ ¸å¿å®ä½ï¼æè§æç¹ç¹é è°±ãä¸è½½è¯ç¨åæè§è¿çä¸éï¼æèµ·ç è¦çä¸è¥¿é½æãç°å¨ç»è¿äºå ä¸ªæçä½¿ç¨ï¼æè§æ¾å°äºæ¢¦ä¸­æè½¯ï¼è¯´çè¿åäºç¹^_^ï¼ã<br><br>ä¼ ç»ä»»å¡ç®¡çè½¯ä»¶ï¼åå»ºä¸ä¸ªä»»å¡éè¦ç»åå¡«ååç§°ãè®¾ç½®åç±»ãéæ©æåãè°æ´æ¶é´ç­å¤ä¸ªç¹çæ­¥éª¤ï¼çè³éè¦è·³è½¬å¤ä¸ªé¡µé¢æè½å®æéç½®ï¼æ°æå¥é¨éè¦è±ä¸å°æ¶é´å»å­¦ä¹ ï¼ç¹å«æ¯é¡¹ç®ç®¡çç±»çï¼ç¹å«å¤æãä¸ä½æ²¡æå¸®å°å·¥ä½ææï¼åèç»å¢å äºé¢å¤è´æãèä¸æäºå·¥å·çä»»å¡ç¼è¾åè½ç®éï¼ç¼ºå°æ¤ééåï¼ææºä¸æä½ä¸ä¸å°å¿å é¤æ¶å è¿äºå¤´ï¼å°±è¦éåä¸å¤§æ®µäºãä½è¿ä¸ªä¹è¿ä»»å¡å®ä»»å¡åå»ºå¨æµç¨é½åç®åï¼åªéä¸æ³¨å¡«åä»»å¡åå®¹ï¼ä¼èªå¨æ ¹æ®é¦æ®µåå®¹æºè½çæä»»å¡åç§°ï¼ä¸ç¨åå¤æéæ é¢ï¼ç§éå®æä»»å¡è®°å½ãä»»å¡åå®¹ç¼è¾æ¡å¸¦äºæ¤éåéååè½ï¼æä½å¤±è¯¯è¦ä¸æã<br><br>ä»è¿æä¸ä¸ªä¸ä¼ çå¾çä¼èªå¨æ æ³¨åºå·çåè½ï¼å¯ä»¥åä»»å¡åå®¹ä¸çæè¿°å¹éèµ·æ¥ï¼è®©ä»»å¡è¦æ±æ´æ¸æ°ãè¿ç§ âå°æä½ãå¤ä¸æ³¨â çè®¾è®¡ï¼è®©ä»»å¡åå»ºæçæé«ä¸å°ã<br><br>ä¼ ç»ä»»å¡ç®¡çè½¯ä»¶å¸¸å¸¸è¿½æ± âå¤§èå¨âï¼å ç äºå¤§éä½¿ç¨çæä½çå¤æåè½ï¼ä¸ä»å¢å äºè½¯ä»¶ä½ç§¯åæä½é¾åº¦ï¼è¿å®¹æè®©æå¨ä¼å¤åè½é¢åä¸è¸æµé¼ã<br><br>æ¯å¦å§ï¼é¡¹ç®ç®¡çç±»è½¯ä»¶æéç®¡çæ¨¡åè®¾è®¡å¤ªå¤æï¼è®¾ç½®æµç¨ç¹çãå¨æ¯å¦å¤§å¤æ°å·¥å·çä»»å¡ç¶ææ²¡æ âæç½®â ç­éé¡¹ï¼ææ¶æ éå¤ççä»»å¡åªè½å ç¨åè¡¨ç©ºé´ï¼å¯¼è´ä¿¡æ¯æä¹±ã<br><br>ä½è¿ä¸ªä¹è¿ä»»å¡å®å¨ä»»å¡è®¾ç½®ä¸ï¼æâå·²æç½®â è¿ä¸ªä»»å¡ç¶æï¼å°±å¾æ¹ä¾¿ï¼ä»»å¡åè¡¨æ´æ´æ´ãå¨æ¶é´éæ©çé¢ç¨ç»¿è²å ç²å­ä½æ æ³¨èåæ¥ï¼å·¥ä½æææ¶ä¸éè¦é¢å¤åæ¢æ¥åAPPæ¥è¯¢åæãæ¹éæä½åè½ç®åç´è§ï¼é¿æä»»å¡å³å°±å¯ä»¥è¿å¥æ¹éç¼è¾æ¨¡å¼ï¼å³æ»æä½ä¹å¾äººæ§åï¼æå¾æä¸æ¶å°±åå»åä¸ä¸ãæ­¤å¤ï¼ä»»å¡åç±»ãä¼åçº§è®¾ç½®ãåä½äººææ´¾ãçç¹å¾ç­æ ¸å¿åè½ä¸åºä¿±å¨ï¼æ¢æ»¡è¶³å¤åºæ¯éæ±ï¼åæ²¡å¥å¤ä½çæä½ã<br><br>å¦å¤ï¼å¤§å¤æ¥æé¡¹ç®åä»»å¡ç®¡ççè½¯ä»¶ç§»å¨ç«¯é½æ¯è¾é¾ç¨ï¼å¤åºæ¶å®ææºä¸å¤çä»»å¡å¾å¤´ç¼ãè¿ä¸ªä¹è¿ä»»å¡å®å°±æ¯æ PC çµèç«¯ãææº APP ç«¯ãå¾®ä¿¡å°ç¨åºç«¯ãææº H5 ç½é¡µç«¯ï¼å¨å¤é¢ä¹è½éæ¶éå°æä½ã<br><br>æè§ç°å¨çè½¯ä»¶é½è¶åè¶å¤æï¼ä¸å®ç¨çåè½ä¸å¤§å ï¼è¿½æ±å¤§èå¨ï¼åè¿ç±»å³æ³¨æ ¸å¿éè¦çè½¯ä»¶åæ¯æ´å°ï¼ä¹ä¸ç¥éæ¯ååäºï¼æ¯ä¸ç¥éæä»¬éè¦ä»ä¹æ ·çå·¥å·æé¡ºæåã
</div>
<div class="clear"></div>

        <div class="postDesc">posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-16 12:23">2026-01-16 12:23</span>&nbsp;
<a href="https://www.cnblogs.com/lbnnbs">lbnnbs</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19491338);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19491338', targetLink: 'https://www.cnblogs.com/lbnnbs/p/19491338', title: 'ç»äºæ¾å°äºä¸æ¬¾è¶³å¤ç®åçä»»å¡ç®¡çè½¯ä»¶' })">ä¸¾æ¥</a>
</div>
     ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ MySQLæ·±åº¦åé¡µä¼åå®æï¼ä»è¸©åå°è½å°çå¨æ»ç¥ ]]></title>
    <link>https://www.cnblogs.com/sun-10387834/p/19491242</link>
    <guid>20c6b38af60b179ba5022452ce1f5b00</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/sun-10387834/p/19491242" title="åå¸äº 2026-01-16 11:57">
    <span role="heading" aria-level="2">MySQLæ·±åº¦åé¡µä¼åå®æï¼ä»è¸©åå°è½å°çå¨æ»ç¥</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>ååç«¯å¼åçåå­¦ï¼å¤§æ¦çé½éå°è¿MySQLåé¡µçåââæµåé¡µæ¶æ¥è¯¢ç§åï¼ä¸æ¦ç¿»å°å åé¡µãä¸ç¾é¡µä¹åï¼æ¥å£å°±å¼å§å¡é¡¿ï¼çè³ç´æ¥è¶æ¶ãä¹åå¨åçµååååè¡¨æ¥å£æ¶ï¼å°±å ä¸ºæ²¡å¤çå¥½æ·±åº¦åé¡µï¼çº¿ä¸åºç°è¿å¤æ¬¡æ¥å£è¶æ¶åè­¦ï¼ææ¥åæåç°æ¯åé¡µSQLçé®é¢ãä»å¤©å°±ç»åå®éå¼åç»éªï¼èèMySQLæ·±åº¦åé¡µçæ¬è´¨é®é¢ï¼ä»¥åé£äºè½ç´æ¥è½å°çä¼åæ¹æ¡ï¼é½æ¯ç»è¿çäº§ç¯å¢éªè¯çå¹²è´§ã</p>
<p>åè¯´è¯´æå¼å§è¸©çåãå½æ¶åååè¡¨æ¥å£ç¨çæ¯æå¸¸è§çåé¡µåæ³ï¼ä¹å°±æ¯LIMIT offset, sizeï¼ä»£ç éå°è£äºéç¨åé¡µé»è¾ï¼åç«¯ä¼ é¡µç åæ¯é¡µæ¡æ°ï¼åç«¯è®¡ç®offsetåæ¼SQLãä¸çº¿åææ°æ®éå°ï¼ç¿»ä¸ªåå é¡µé½æ²¡é®é¢ï¼å¯éçååæ°æ®æ¶¨å°å åä¸æ¡ï¼ç¨æ·ç¿»å°ç¬¬500é¡µä¹åï¼æ¥å£ååºæ¶é´ç´æ¥ä»å åæ¯«ç§é£åå°å ç¾çè³ä¸åæ¯«ç§ï¼çæ§é¢æ¿ä¸å¨æ¯çº¢è²åè­¦ã</p>
<h2 id="ä¸æ·±åº¦åé¡µä¸ºä»ä¹ä¼æ¢">ä¸ãæ·±åº¦åé¡µä¸ºä»ä¹ä¼æ¢ï¼</h2>
<p>ä¸å¼å§ä»¥ä¸ºæ¯ç´¢å¼æ²¡å»ºå¯¹ï¼ææ¥ååç°ç´¢å¼æ¯æ­£å¸¸çï¼åæ¥ç¿»äºMySQLå®æ¹ææ¡£ï¼åç»åæ§è¡è®¡ååæï¼æææäºæ ¸å¿åå ãæä»¬å¸¸ç¨çLIMIT offset, sizeåæ³ï¼æ¯å¦LIMIT 100000, 20ï¼MySQLå¹¶ä¸æ¯ç´æ¥è·³è¿å10ä¸æ¡æ°æ®ååé¢20æ¡ï¼èæ¯ä¼ä»è¡¨çç¬¬ä¸æ¡æ°æ®å¼å§ï¼éè¡æ«æï¼ä¸å±è¯»å100020æ¡æ°æ®ï¼ç¶åä¸¢å¼å10ä¸æ¡ï¼åªè¿åæå20æ¡ã</p>
<p>è¿å°±æå³çï¼offsetè¶å¤§ï¼MySQLéè¦æ«æçè¡æ°å°±è¶å¤ï¼ç£çIOååå­æ¶èé½ä¼æ¥å§å¢å ï¼æ¥è¯¢æçèªç¶åææ°çº§ä¸éãå¦æåé¡µSQLè¿æ²¡å½ä¸­ç´¢å¼ï¼è§¦åå¨è¡¨æ«æï¼é£æåµä¼æ´ç³ï¼ç´æ¥å¯¼è´æ´ä¸ªæ°æ®åºå®ä¾ååé£åï¼å½±åå¶ä»æ¥å£ã</p>
<h2 id="äºå®æä¼åæ¹æ¡ä»æå°é¾è½å°">äºãå®æä¼åæ¹æ¡ï¼ä»æå°é¾è½å°</h2>
<p>éå¯¹æ·±åº¦åé¡µé®é¢ï¼æ²¡æä¸è½æ¹æ¡ï¼åªè½ç»åä¸å¡åºæ¯éæ©æåéçãä¸é¢æä¼åçº§æåºï¼åäº«å ä¸ªå®éé¡¹ç®ä¸­ç¨è¿çä¼åæ¹æ¡ï¼ä»æ¹é ææ¬ä½å°é«éæ­¥è¯´æã</p>
<h3 id="æ¹æ¡ä¸ä¹¦ç­¾åé¡µæä¼è§£90åºæ¯éç¨">æ¹æ¡ä¸ï¼ä¹¦ç­¾åé¡µï¼æä¼è§£ï¼90%åºæ¯éç¨ï¼</h3>
<p>è¿æ¯æç®åå¨é¡¹ç®ä¸­ç¨å¾æå¤çæ¹æ¡ï¼æ¹é ææ¬ä½ï¼æ§è½æåææ¾ï¼æ ¸å¿æè·¯æ¯æ¾å¼offsetåç§»ï¼ç¨ä¸ä¸é¡µæåä¸æ¡æ°æ®çä¸»é®æå¯ä¸ç´¢å¼ä½ä¸ºâä¹¦ç­¾âï¼è®©MySQLç´æ¥éè¿ç´¢å¼å®ä½å°ä¹¦ç­¾ä½ç½®ï¼åå¾åæ¥è¯¢æå®æ¡æ°ï¼å½»åºé¿åæ«ææ ç¨æ°æ®ã</p>
<p>æ¯å¦ä¹åçåååè¡¨ï¼ç¨ä¸»é®idæåºï¼åæ¥çä½æåæ³æ¯ï¼</p>
<pre><code class="language-sql">-- ç¬¬5001é¡µï¼æ¯é¡µ20æ¡ï¼offset=100000
SELECT id, name, price, category FROM goods WHERE category=1 ORDER BY id LIMIT 100000, 20;
</code></pre>
<p>ä¼ååï¼è®©åç«¯ä¼ éä¸ä¸é¡µæåä¸æ¡æ°æ®çidï¼æ¯å¦ä¸ä¸é¡µæåä¸æ¡idæ¯100000ï¼æ°çSQLåæ³æ¯ï¼</p>
<pre><code class="language-sql">SELECT id, name, price, category FROM goods WHERE category=1 AND id &gt; 100000 ORDER BY id LIMIT 20;
</code></pre>
<p>è¿æ ·MySQLä¼ç´æ¥éè¿ä¸»é®ç´¢å¼å®ä½å°id=100000çä½ç½®ï¼åå¾åå20æ¡æ°æ®ï¼åªæ«æ20æ¡è®°å½ï¼ä¸ç®¡æ°æ®éå¤å¤§ï¼æ¥è¯¢éåº¦é½è½ç¨³å®å¨æ¯«ç§çº§ã</p>
<p>è¿éæä¸ªéè¦æ³¨æçç¹ï¼å¦ææåºå­æ®µä¸æ¯ä¸»é®ï¼èæ¯æ®éå­æ®µï¼æ¯å¦create_timeï¼ï¼ä¸å­å¨éå¤å¼ï¼ç´æ¥ç¨è¯¥å­æ®µä½ä¸ºä¹¦ç­¾ä¼å¯¼è´åé¡µéå¤ææ¼æ°æ®ãè¿æ¶éè¦ç¨âæåºå­æ®µ+ä¸»é®âçç»åä½ä¸ºéç¹ï¼ä¿è¯å¯ä¸æ§ã</p>
<p>æ¯å¦æåå»ºæ¶é´ååºåé¡µï¼ä¼ååæ³å¦ä¸ï¼</p>
<pre><code class="language-sql">-- ä¸ä¸é¡µæåä¸æ¡æ°æ®ï¼create_time='2026-01-15 18:30:00'ï¼id=100000
SELECT id, name, price, create_time FROM goods 
WHERE category=1 AND (create_time &lt; '2026-01-15 18:30:00' OR (create_time = '2026-01-15 18:30:00' AND id &lt; 100000))
ORDER BY create_time DESC, id DESC LIMIT 20;
</code></pre>
<p>è¿ç§ç»åéç¹çæ¹å¼ï¼è½å®ç¾è§£å³æåºå­æ®µéå¤å¯¼è´çåé¡µå¼å¸¸é®é¢ï¼ä¹æ¯çäº§ç¯å¢ä¸­å¤çéä¸»é®æåºåé¡µçæ ååæ³ã</p>
<h3 id="æ¹æ¡äºå­æ¥è¯¢joinä¼åå¼å®¹è·³é¡µéæ±">æ¹æ¡äºï¼å­æ¥è¯¢/JOINä¼åï¼å¼å®¹è·³é¡µéæ±ï¼</h3>
<p>ä¹¦ç­¾åé¡µçç¼ºç¹æ¯ä¸æ¯æç´æ¥è·³è½¬å°æå®é¡µç ï¼èå¾å¤ä¸å¡åºæ¯ï¼æ¯å¦åå°ç®¡çç³»ç»çåé¡µç»ä»¶ï¼å¿é¡»æé¡µç éæ©åè½ï¼è¿æ¶å°±éè¦ç¨å­æ¥è¯¢æJOINæ¥ä¼åã</p>
<p>æ ¸å¿æè·¯æ¯ï¼åéè¿ç´¢å¼æ¥è¯¢åºéè¦çä¸»é®IDï¼åéè¿ä¸»é®å³èæ¥è¯¢å¨å­æ®µæ°æ®ãå ä¸ºä¸»é®æ¯èç°ç´¢å¼ï¼æ¥è¯¢ä¸»é®çéåº¦æå¿«ï¼å­æ¥è¯¢åªæ«æä¸»é®å­æ®µçoffset+sizeæ¡æ°æ®ï¼èä¸æ¯å¨å­æ®µï¼è½å¤§å¹éä½IOå¼éã</p>
<p>åæ¥çä½æåæ³ä¼ååï¼</p>
<pre><code class="language-sql">SELECT * FROM goods WHERE category=1 ORDER BY id LIMIT 100000, 20;
</code></pre>
<p>ç¨JOINä¼ååçåæ³ï¼æ§è½æ´ä¼ï¼MySQLæ¨èï¼ï¼</p>
<pre><code class="language-sql">SELECT g.* FROM goods g
JOIN (SELECT id FROM goods WHERE category=1 ORDER BY id LIMIT 100000, 20) t ON g.id = t.id
ORDER BY g.id;
</code></pre>
<p>è¿ç§æ¹æ¡è½å®ç¾å¼å®¹è·³é¡µéæ±ï¼ä¸éè¦æ¹é åç«¯åé¡µç»ä»¶ï¼æ§è½æ¯åçLIMITæå10~100åï¼offsetè¶å¤§ï¼ä¼åææè¶ææ¾ãéè¦æ³¨æçæ¯ï¼å­æ¥è¯¢ä¸­çæåºå­æ®µå¿é¡»å»ºç«ç´¢å¼ï¼å¦åå­æ¥è¯¢ä¾ç¶ä¼å¨è¡¨æ«æï¼ä¼åå¤±æã</p>
<h3 id="æ¹æ¡ä¸ä¸å¡å±éå¶æç®åçååºæ¹æ¡">æ¹æ¡ä¸ï¼ä¸å¡å±éå¶ï¼æç®åçååºæ¹æ¡ï¼</h3>
<p>å¶å®å¾å¤ToCä¸å¡åºæ¯ä¸­ï¼ç¨æ·æ ¹æ¬ä¸ä¼ç¿»å°ç¬¬100é¡µä¹åãæ¯å¦çµååååè¡¨ï¼ç¨æ·éå¸¸åªçå10é¡µï¼ç¿»å°åé¢çæ¦çæä½ãéå¯¹è¿ç§åºæ¯ï¼æç®åçä¼åæ¹å¼å°±æ¯å¨ä¸å¡å±éå¶æå¤§é¡µç ã</p>
<p>æä»¬å½æ¶å¨åååè¡¨æ¥å£ä¸­åäºéå¶ï¼æå¤åªè½ç¿»å°ç¬¬50é¡µï¼è¶è¿50é¡µå°±æç¤ºâææ æ´å¤æ°æ®âï¼åæ¶å¼å¯¼ç¨æ·éè¿ç­éæ¡ä»¶ï¼æ¯å¦ä»·æ ¼åºé´ãééæåºï¼ç¼©å°æ¥è¯¢èå´ãè¿ç§æ¹å¼é¶å¼åææ¬ï¼é¶æ§è½æèï¼ç´æ¥ä»æ ¹æºè§£å³é®é¢ï¼éåå¤§å¤æ°ToCä¸å¡ã</p>
<h3 id="æ¹æ¡åç¹æ®åºæ¯ååºæµ·éæ°æ®æ¹éå¯¼åº">æ¹æ¡åï¼ç¹æ®åºæ¯ååºï¼æµ·éæ°æ®/æ¹éå¯¼åºï¼</h3>
<p>å¦æéå°åä¸çº§æ°æ®çæ·±åº¦åé¡µï¼æèéè¦æ¹éå¯¼åºæµ·éæ°æ®çåºæ¯ï¼ä¸é¢çæ¹æ¡å¯è½ä¸å¤ç¨ï¼è¿æ¶å¯ä»¥èèé¢çæåæ®µIDæä½¿ç¨æ¸¸æ åé¡µã</p>
<p>é¢çæåæ®µIDçæè·¯æ¯ï¼å¨æ°æ®è¡¨ä¸­æ°å¢segment_idå­æ®µï¼æä¸»é®åæ®µï¼æ¯å¦æ¯1000æ¡æ°æ®ä¸ºä¸ä¸ªåæ®µï¼ï¼å»ºç«segment_idç´¢å¼ãåé¡µæ¶åæsegment_idå®ä½åæ®µï¼åå¨åæ®µååé¡µï¼é¿åå¤§èå´æ«æãè¿ç§æ¹å¼éåæ°æ®æ´æ°é¢çä½çåºæ¯ï¼æ§è½æè´ï¼ä½éè¦é¢å¤çæ°æ®ã</p>
<p>æ¸¸æ åé¡µåéåæ¹éæ°æ®å¯¼åºãç¦»çº¿ä»»å¡ç­ä¸éè¦è·³é¡µçåºæ¯ï¼éè¿MySQLæ¸¸æ éè¡è¯»åæ°æ®ï¼é¿åä¸æ¬¡æ§å è½½å¤§éæ°æ®å°åå­ï¼ä¸ä¼æoffsetçæ§è½é®é¢ï¼ä½ä¸å¡æ¹é ææ¬è¾é«ï¼åªéååç«¯ç¦»çº¿ä»»å¡ã</p>
<h2 id="ä¸ä¼åå¿å®ååç¼ºä¸ä¸å¯">ä¸ãä¼åå¿å®ååï¼ç¼ºä¸ä¸å¯ï¼</h2>
<p>ä¸ç®¡ç¨åªç§ä¼åæ¹æ¡ï¼ä»¥ä¸ä¸¤ä¸ªååå¿é¡»éµå®ï¼å¦åææä¼åé½ä¼å¤±æï¼</p>
<p>1. åé¡µSQLå¿é¡»å½ä¸­ç´¢å¼ï¼WHEREç­éæ¡ä»¶+ORDER BYæåºæ¡ä»¶ï¼å¿é¡»å»ºç«å¯¹åºçååç´¢å¼æèåç´¢å¼ï¼å¦åMySQLä¼è§¦åå¨è¡¨æ«æ+æä»¶æåºï¼æ§è½ä¾ç¶æå·®ãæ¯å¦ä¸é¢çåååè¡¨ï¼éè¦å»ºç«category+idçèåç´¢å¼ï¼æè½è®©åé¡µSQLé«ææ§è¡ã</p>
<p>2. é¿åä½¿ç¨SELECT *ï¼åªæ¥è¯¢éè¦çå­æ®µï¼åå°æ°æ®ä¼ è¾ååå­å¼éãå¦æè¡¨ä¸­ætextãblobç­å¤§å­æ®µï¼SELECT *ä¼å¯¼è´æ§è½ä¸¥éæèï¼çè³ææ¢æ´ä¸ªæ°æ®åºã</p>
<h2 id="åæ»ç»">åãæ»ç»</h2>
<p>MySQLæ·±åº¦åé¡µçæ ¸å¿çç¾ï¼æ¬è´¨æ¯offsetå¯¼è´çæ ææ«æãä¼åçæ ¸å¿æè·¯å°±æ¯ï¼è½ä¸ç¨offsetå°±ä¸ç¨ï¼ä¼åç¨ä¹¦ç­¾åé¡µï¼å¿é¡»ç¨offsetå°±åå°æ«ææ°æ®éï¼ç¨å­æ¥è¯¢/JOINä¼åï¼ä¸å¡ä¸è½éå¶åé¡µæ·±åº¦å°±éå¶ï¼ä»æ ¹æºè§é¿é®é¢ã</p>
<p>å¨å®éå¼åä¸­ï¼ä¸éè¦è¿½æ±æå¤æçæ¹æ¡ï¼èæ¯è¦ç»åä¸å¡åºæ¯éæ©æåéçãå¤§é¨ååºæ¯ä¸ï¼ä¹¦ç­¾åé¡µ+ç´¢å¼ä¼åå°±è½æ»¡è¶³éæ±ï¼æ¹é ææ¬ä½ï¼æ§è½åç¨³å®ãå¸æè¿ç¯å®ææ»ç»è½å¸®å°å¤§å®¶ï¼é¿å¼MySQLæ·±åº¦åé¡µçåã</p>

</div>
<div id="MySignature" role="contentinfo">
    
<p>â¤ï¸ å¦æä½ åæ¬¢è¿ç¯æç« ï¼è¯·ç¹èµæ¯æï¼ ð åæ¶æ¬¢è¿å³æ³¨æçåå®¢ï¼è·åæ´å¤ç²¾å½©åå®¹ï¼</p>

<p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/sun-10387834/" target="_blank">ä½ç¥è®©ææ¥å·¡å±±</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/sun-10387834/p/19491242" target="_blank">https://www.cnblogs.com/sun-10387834/p/19491242</a></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-16 11:57">2026-01-16 11:57</span>&nbsp;
<a href="https://www.cnblogs.com/sun-10387834">ä½ç¥è®©ææ¥å·¡å±±</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19491242);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19491242', targetLink: 'https://www.cnblogs.com/sun-10387834/p/19491242', title: 'MySQLæ·±åº¦åé¡µä¼åå®æï¼ä»è¸©åå°è½å°çå¨æ»ç¥' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ç½ç»é®é¢å¦ä½ææ¥ï¼mtrå½ä»¤è¯¦è§£ ]]></title>
    <link>https://www.cnblogs.com/deep-sky/p/19491194</link>
    <guid>2c1dfe8cb6fced41a144e7dcd5332308</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/deep-sky/p/19491194" title="åå¸äº 2026-01-16 11:47">
    <span role="heading" aria-level="2">ç½ç»é®é¢å¦ä½ææ¥ï¼mtrå½ä»¤è¯¦è§£</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h3 id="mtr">mtr</h3>
<p><code>mtr</code>å½ä»¤æ¯ä¸ä¸ªç½ç»è¯æ­å·¥å·ï¼ç¨äºæ£æµç½ç»çè¿éæ§åå»¶è¿ãMTRæ¯My Tracerouteçç¼©åï¼æ¯tracerouteåpingå½ä»¤çç»åä½ã</p>
<p><code>mtr</code>é»è®¤ä½¿ç¨<code>ICMP</code>åè®®ï¼å¨ä»ç»<code>mtr</code>çè¯¦ç»ç¨æ³åæä»¬åäºè§£ä¸<code>ICMP</code>åè®®ã</p>
<h3 id="imcp">IMCP</h3>
<p><code>ICMP</code>ï¼Internet Control Message Protocolï¼äºèç½æ§å¶æ¥æåè®®ï¼<br>
æ¯ä¸ç§ç½ç»å±ï¼OSI ç¬¬ä¸å±ï¼åè®®ï¼ä¸»è¦ç¨äºå¨ IP ç½ç»ä¸­ä¼ éæ§å¶ä¿¡æ¯åéè¯¯ä¿¡æ¯ï¼èä¸æ¯ç¨æ¥ä¼ è¾ä¸å¡æ°æ®ã<br>
<code>ICMP</code>çä½ç¨æ¯ï¼<br>
1ãç½ç»è¿éæ§æµè¯<br>
æå¸¸ç¨çå°±æ¯<code>ping</code>å½ä»¤ï¼åéçæ¯<code>ICMP Echo Request</code>ï¼å¯¹æ¹åå¤<code>ICMP Echo Reply</code>ï¼ç¨æ¥å¤æ­ç½ç»æ¯å¦å¯è¾¾ãæ¯å¦ä¸¢åä»¥åå»¶è¿</p>
<p>2ãç½ç»æéåéè¯¯åé¦<br>
å½ IP åå¨ä¼ è¾è¿ç¨ä¸­åºç°é®é¢æ¶ï¼<code>ICMP</code> ä¼è¿åéè¯¯ä¿¡æ¯ï¼ä¾å¦ï¼</p>
<table>
<thead>
<tr>
<th>åºæ¯</th>
<th>ICMP ç±»å</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç®æ ä¸»æºä¸å¯è¾¾</td>
<td>Destination Unreachable</td>
</tr>
<tr>
<td>è·¯ç±ä¸­ TTL ç¨å°½</td>
<td>Time Exceeded</td>
</tr>
<tr>
<td>éè¦åçä½ç¦æ­¢åç</td>
<td>Fragmentation Needed</td>
</tr>
</tbody>
</table>
<p>ä¾å¦ï¼è·¯ç±å¨åç°ä¸ä¸è·³ä¸å¯è¾¾æ¶å°±ä¼è¢«æºä¸»æºåéä¸ä¸ªICMPä¸å¯è¾¾æ¥æ</p>
<p>3ãç½ç»è·¯å¾è¯æ­<br>
<code>traceroute</code>å<code>tracert</code>å°±æ¯éè¿<code>ICMP</code>å®ç°ç</p>
<h3 id="mtrçç¨æ³">mtrçç¨æ³</h3>
<pre><code>Usage:
 mtr [options] hostname

 -F, --filename FILE              ä»æä»¶ä¸­è¯»åhostname(s)
 -4                               ä½¿ç¨IPv4
 -6                               ä½¿ç¨IPv6
 -f, --first-ttl NUMBER           èµ·è·³ttlåæ°ï¼è·³è¿åé¢çN-1è·³ï¼åªåªæ¾ç¤ºTTL=Nåçè·³ï¼ä¸æ¹åçå®è·¯ç±ï¼åªæ¯ä¸æ¾ç¤ºï¼
 -m, --max-ttl NUMBER             maximum number of hops
 -u, --udp                        ä½¿ç¨UDP æ¿ä»£ ICMP echo
 -T, --tcp                        ä½¿ç¨ TCP æ¿ä»£ICMP echo
 -P, --port PORT                  ä½¿ç¨TCPãSCTPæUDPæ¢æµæ¶çç®æ ç«¯å£
 -s, --psize PACKETSIZE           è®¾ç½®æ¢æµåç payload å¤§å°ï¼å­èï¼
 -i, --interval SECONDS           è®¾ç½®æ¢æµåç åéé´é
 -r, --report                     æ¥åæ¨¡å¼ï¼ä¸æ¬¡æ§è¾åºï¼ä¸å·æ°ï¼
 -w, --report-wide                æ¥åæ¨¡å¼ï¼å®½å±å¯¹é½è¾åºï¼å­æ®µä¸æªæ­ï¼
 -c, --report-cycles COUNT        åéæ¢æµåæ¬¡æ°ï¼è®¾ç½®20å¿«éå¤æ­ï¼è®¾ç½®100è¾ä¸ºå¯ä¿¡
 -j, --json                       ä»¥jsonæ ¼å¼è¾åº
 -x, --xml                        ä»¥xmlæ ¼å¼è¾åº
 -C, --csv                        ä»¥csvæ ¼å¼è¾åº
 -l, --raw                        ä»¥åå§æ ¼å¼è¾åº
 -n, --no-dns                     ä¸ååådnsè§£æ(åªæ¾ç¤ºip)
 -y, --ipinfo NUMBER              è¾åº IP å½å±ä¿¡æ¯ï¼å½å®¶ / è¿è¥åï¼

</code></pre>
<p>å¨linuxä¸æ§è¡<code>mtr</code>æ¶ï¼<code>mtr</code>ä¼ç´æ¥æä½ç½ç»å±æé IP/ICMPæ¥æï¼æä»¥ä¸è¬éè¦ä½¿ç¨<code>sudo</code>æ§è¡</p>
<p>ç¤ºä¾ï¼<br>
<code>sudo mtr -r -n -c 100 www.baidu.com</code></p>
<p>è¾åºç»æ:</p>
<pre><code>Start: 2026-01-15T19:00:01+0800
HOST: LTB-MBP.local               Loss%   Snt   Last   Avg  Best  Wrst StDev
  1.|-- 183.2.172.177              0.0%   100    2.0   1.8   0.4  26.2   3.4
</code></pre>
<table>
<thead>
<tr>
<th>å­æ®µ</th>
<th>å«ä¹</th>
<th>è§£è¯»è¦ç¹</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>HOST</code></td>
<td>å½åè·³ä¸»æº</td>
<td><code>*</code> ä»£è¡¨æ ååº</td>
</tr>
<tr>
<td><code>Loss%</code></td>
<td>ä¸¢åç</td>
<td><strong>æ ¸å¿ææ </strong></td>
</tr>
<tr>
<td><code>Snt</code></td>
<td>åéåæ°</td>
<td>ç»è®¡æ ·æ¬é</td>
</tr>
<tr>
<td><code>Last</code></td>
<td>æè¿ä¸æ¬¡å»¶è¿</td>
<td>æ³¢å¨åè</td>
</tr>
<tr>
<td><code>Avg</code></td>
<td>å¹³åå»¶è¿</td>
<td>ä¸»è¦ç</td>
</tr>
<tr>
<td><code>Best</code></td>
<td>æå°å»¶è¿</td>
<td>çæ³æåµ</td>
</tr>
<tr>
<td><code>Wrst</code></td>
<td>æå¤§å»¶è¿</td>
<td>æ¯å¦ææå¨</td>
</tr>
<tr>
<td><code>StDev</code></td>
<td>æå¨</td>
<td>è¶å°è¶ç¨³å®</td>
</tr>
</tbody>
</table>
<h4 id="icmpéé">ICMPéé</h4>
<p>åæMTRè¾åºæ¶ï¼éè¦å³æ³¨ä¸¤ä¸ªæ¹é¢ï¼<strong>ä¸¢åç</strong>å<strong>å»¶è¿</strong>ãå¦æå¨æä¸ªè·³ç¹çå°ä¸å®ç¨åº¦çä¸¢åï¼è¿å¯è½è¯´æè¯¥è·¯ç±å¨æé®é¢ãç¶èï¼ä¸äºæå¡æä¾åæ®éä¼éå¶MTRä½¿ç¨ç<code>ICMP</code>ååºéçãè¿å¯è½ä¼è®©äººè¯¯ä»¥ä¸ºä¸¢åï¼å®éä¸å¹¶æ²¡æä¸¢åãè¦å¤æ­çå°çä¸¢åæ¯çå®çè¿æ¯éçéå¶å¼èµ·çï¼å¯ä»¥ççåç»­è·³è·ãå¦æè·³è·æ¾ç¤ºæå¤±ä¸º0.0%ï¼é£ä¹å¾å¯è½æ¯å ä¸ºï¼<code>ICMP</code>ååºéçéå¶å¯¼è´çèéçå®çä¸¢åï¼ä»¥ä¸é¢çMTRç»æä¸ºä¾:</p>
<pre><code>root@localhost:~# mtr -r www.google.com
HOST: example                       Loss%   Snt   Last  Avg  Best  Wrst   StDev
   1. 63.247.74.43                  0.0%    10    0.3   0.6   0.3   1.2   0.3
   2. 63.247.64.157                50.0%    10    0.4   1.0   0.4   6.1   1.8
   3. 209.51.130.213                0.0%    10    0.8   2.7   0.8  19.0   5.7
   4. aix.pr1.atl.google.com        0.0%    10    6.7   6.8   6.7   6.9   0.1
   5. 72.14.233.56                  0.0%    10    7.2   8.3   7.1  16.4   2.9
   6. 209.85.254.247                0.0%    10   39.1  39.4  39.1  39.7   0.2
   7. 64.233.174.46                 0.0%    10   39.6  40.4  39.4  46.9   2.3
   8. gw-in-f147.1e100.net          0.0%    10   39.6  40.5  39.5  46.7   2.2
</code></pre>
<p>ç¬¬äºè·³çä¸¢åçè½ç¶æ¯ 50%ï¼ä½æ¯å¶åç»­è·³æ²¡æä¸¢åä¸æç»è½å°å°è¾¾ç¬¬8è·³ï¼æä»¥æ´ä¸ªé¾è·¯å®éä¸éçï¼ç¬¬äºè·³çä¸¢åçæ¯å ä¸º<code>ICMP</code>ééå¯¼è´çã</p>
<p>å¯è½æçåå­¦ä¼æçé®äºï¼é¾éæåä¸è·³ä¸ä¼åºç°<code>ICMP</code>ééåï¼<br>
å®éä¸ï¼<code>mtr</code>åéæ°æ®ååï¼ä¼æ ¹æ®æ¶å°ç ICMP ååºç±»åæ¥å¤æ­ï¼</p>
<pre><code>ä¸­é´è·³è¿åï¼ICMP Type 11 (Time Exceeded)
            â "TTL èå°½ï¼æä¸æ¯ç®æ "
            â ç»§ç»­å¢å  TTL æ¢æµä¸ä¸è·³

æåä¸è·³è¿åï¼ICMP Type 0 (Echo Reply)
æ ICMP Type 3 (Destination Unreachable)
            â "æå°±æ¯ç®æ ä¸»æº"
            â åæ­¢æ¢æµ
</code></pre>
<p>è¿ç¨å¯ä»¥ç±»æ¯å¿«éééé¾è·¯ï¼</p>
<ul>
<li>ä¸­é´è½¬è¿ç«ï¼è·¯ç±å¨ï¼ï¼å¯è½ä¸ä¼åè¯ä½ "åè£¹ç»è¿äºè¿é"ï¼éå¶æå®å¨ä¸ååºICMP Time Exceededï¼</li>
<li>æç»æ¶è´§ç¹ï¼ç®æ ä¸»æºï¼ï¼å¿é¡»ç­¾æ¶å¹¶ç¡®è®¤"æ¶å°äº"ï¼ååºICMP Echo Replyï¼</li>
</ul>
<p>å³ä½¿ä¸­é´è½¬è¿ç«ä¸åè¯ä½ è¿åº¦ï¼åªè¦æåæ¶å°åè£¹å¹¶æç­¾æ¶ç¡®è®¤ï¼å°±è¯´ææ´æ¡é¾è·¯æ¯éçã</p>
<h4 id="çå®çä¸¢ååºæ¯">çå®çä¸¢ååºæ¯</h4>
<p>ä»¥ä¸é¢çMTRç»æä¸ºä¾ï¼</p>
<pre><code>root@localhost:~# mtr -r www.google.com
HOST: localhost                      Loss%   Snt   Last  Avg  Best  Wrst   StDev
   1. 63.247.74.43                   0.0%    10    0.3   0.6   0.3   1.2   0.3
   2. 63.247.64.157                  0.0%    10    0.4   1.0   0.4   6.1   1.8
   3. 209.51.130.213                60.0%    10    0.8   2.7   0.8  19.0   5.7
   4. aix.pr1.atl.google.com        60.0%    10    6.7   6.8   6.7   6.9   0.1
   5. 72.14.233.56                  50.0%    10    7.2   8.3   7.1  16.4   2.9
   6. 209.85.254.247                40.0%    10   39.1  39.4  39.1  39.7   0.2
   7. 64.233.174.46                 40.0%    10   39.6  40.4  39.4  46.9   2.3
   8. gw-in-f147.1e100.net          40.0%    10   39.6  40.5  39.5  46.7   2.2
</code></pre>
<p>å¨è¿ä¸ªç¤ºä¾ä¸­ï¼ç¬¬ä¸è·³çä¸¢åçé«è¾¾60%ä¸åç»­è·³ååºç°äºä¸¢åçå¹¶ä¸å½±åäºæåçç¬¬8è·³ï¼æä»¥å¯ä»¥å¤æ­ç¬¬ä¸è·³æ¯æé®é¢çãç±äºä¸­é´è·³<code>ICMP</code>ééåçå®ä¸¢åä¼åæ¶åçï¼æä»¥ä¼åºç°ä¸­é´è·³çä¸¢åçé«äºæåä¸è·³ä¸¢åçã</p>
<p>å½å¤æ­ç¡®å®åºç°äºä¸¢åæ¶ï¼æå¥½ä½¿ç¨MTRååæµè¯ä¸ï¼å ä¸ºæ°æ®åå¯è½æ¯åéæ¶éå°äºé®é¢ï¼ä¹å¯è½æ¯å¨è¿åååºæ¶åºç°äºé®é¢ã</p>
<h4 id="å»¶è¿">å»¶è¿</h4>
<p>MTRè¿è½æµè¯ä¸»æºä¸ç®æ ä¸»æºä¹é´è¿æ¥çå»¶è¿ãç±äºç©ççº¦æï¼å»¶è¿æ»æ¯éçè·¯ç±è·³æ°çå¢å èå¢å ãç¶èï¼å¢é¿åºä¿æä¸è´ä¸çº¿æ§ãå»¶è¿éå¸¸æ¯ç¸å¯¹çï¼å¹¶ä¸å¾å¤§ç¨åº¦ä¸åå³äºä¸»æºè¿æ¥çè´¨éåå¶ç©çè·ç¦»ã å¨è¯ä¼°å¯è½æé®é¢çè¿æ¥ç MTR æ¥åæ¶ï¼é¤äºç»å®åºåä¸­å¶ä»ä¸»æºä¹é´çå·²ç¥è¿æ¥éåº¦ä¹å¤ï¼è¿åºå°æ©æçåè½é½å¨çæ¥åè§ä¸ºä¸ä¸æã</p>
<p>ä»¥ä¸é¢çMTRç»æä¸ºä¾ï¼</p>
<pre><code>root@localhost:~# mtr --report www.google.com
HOST: localhost                      Loss%   Snt   Last   Avg  Best  Wrst  StDev
    1. 63.247.74.43                  0.0%    10    0.3   0.6   0.3   1.2   0.3
    2. 63.247.64.157                 0.0%    10    0.4   1.0   0.4   6.1   1.8
    3. 209.51.130.213                0.0%    10    0.8   2.7   0.8  19.0   5.7
    4. aix.pr1.atl.google.com        0.0%    10  388.0 360.4 342.1 396.7   0.2
    5. 72.14.233.56                  0.0%    10  390.6 360.4 342.1 396.7   0.2
    6. 209.85.254.247                0.0%    10  391.6 360.4 342.1 396.7   0.4
    7. 64.233.174.46                 0.0%    10  391.8 360.4 342.1 396.7   2.1
    8. gw-in-f147.1e100.net          0.0%    10  392.0 360.4 342.1 396.7   1.2
</code></pre>
<p>å¨ç¬¬3è·³åç¬¬4è·³ä¹é´å»¶è¿çªç¶å¢é«ï¼å¹¶ä¸å¨åç»­è·³ä¸­ä»ç¶å¾é«ï¼è¿å¯è½è¡¨æå­å¨ç½ç»å»¶è¿é®é¢ã</p>
<p>ä½æ¯ï¼é«å»¶è¿å¹¶ä¸æ»æ¯æå³çå½åè·¯ç±æé®é¢ã åä¸é¢è¿æ ·çæ¥åæå³çï¼å°½ç®¡ç¬¬åè·³å­å¨æç§é®é¢ï¼æµéä»ç¶å°è¾¾ç®æ ä¸»æºå¹¶è¿åæºä¸»æºã å»¶è¿ä¹å¯è½æ¯ç±è¿åè·¯çº¿é®é¢å¼èµ·çã è¿åè·¯çº¿ä¸ä¼å¨ MTR æ¥åä¸­çå°ï¼å¹¶ä¸æ°æ®åå¯ä»¥éç¨å®å¨ä¸åçè·¯çº¿å¾è¿äºç¹å®ç®çå°ã</p>
<p>å¨ä¸é¢çç¤ºä¾ä¸­ï¼è½ç¶å¨ç¬¬3è·³åç¬¬4è·³ä¹é´çå»¶è¿å­å¨è¾å¤§è·³è·ï¼ä½å¨ä»»ä½åç»­è·³ä¸­å»¶è¿å¹¶æ²¡æåå¢é«ã ç±æ­¤ï¼å¯ä»¥åçå°åè®¾ç¬¬åä¸ªè·¯ç±å¨å­å¨é®é¢ã</p>
<p><code>ICMP</code>ééä¹ä¼å¯¼è´å»¶è¿å¢å ï¼ä»¥ä¸é¢çMTRæ¥åä¸ºä¾ï¼</p>
<pre><code>root@localhost:~# mtr --report www.google.com
HOST:  localhost                     Loss%   Snt   Last  Avg  Best  Wrst   StDev
    1. 63.247.74.43                  0.0%    10    0.3   0.6   0.3   1.2   0.3
    2. 63.247.64.157                 0.0%    10    0.4   1.0   0.4   6.1   1.8
    3. 209.51.130.213                0.0%    10    0.8   2.7   0.8  19.0   5.7
    4. aix.pr1.atl.google.com        0.0%    10    6.7   6.8   6.7   6.9   0.1
    5. 72.14.233.56                  0.0%    10  254.2 250.3 230.1 263.4   2.9
    6. 209.85.254.247                0.0%    10   39.1  39.4  39.1  39.7   0.2
    7. 64.233.174.46                 0.0%    10   39.6  40.4  39.4  46.9   2.3
    8. gw-in-f147.1e100.net          0.0%    10   39.6  40.5  39.5  46.7   2.2
</code></pre>
<p>ä¹ä¸çï¼ç¬¬4è·³åç¬¬5è·³ä¹é´çå»¶è¿çªç¶å¢é«äºãç¶èï¼å¨ç¬¬äºè·³ä¹åï¼å»¶è¿æ¥å§ä¸éãè¿éæµå¾çå®éå»¶è¿çº¦ä¸º40msï¼ä¸å¹¶æ²¡æå½±åæåä¸æ¡çå»¶è¿ï¼ç½ç»å®éä¸æ¯æ²¡æé®é¢çã</p>
<h4 id="ä»ä¹æ¶åéè¦ä½¿ç¨tcpåudpåè®®è¿è¡æ£æµ">ä»ä¹æ¶åéè¦ä½¿ç¨TCPåUDPåè®®è¿è¡æ£æµï¼</h4>
<p>ä¸ç§åè®®çå¯¹æ¯</p>
<table>
<thead>
<tr>
<th>åè®®</th>
<th>é»è®¤ä½¿ç¨åºæ¯</th>
<th>ä¼ç¹</th>
<th>ç¼ºç¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>ICMP</td>
<td>é»è®¤æ¨¡å¼</td>
<td>æå¸¸ç¨,å¤§å¤æ°è®¾å¤æ¯æ</td>
<td>å®¹æè¢«é²ç«å¢è¿æ»¤</td>
</tr>
<tr>
<td>UDP</td>
<td>æµè¯ UDP æå¡</td>
<td>æ¨¡æçå® UDP æµé</td>
<td>å¯è½è¢«è¿æ»¤,ä¸å¯é </td>
</tr>
<tr>
<td>TCP</td>
<td>æµè¯ Web/API æå¡</td>
<td>ææ¥è¿çå®åºç¨æµé,ä¸æè¢«è¿æ»¤</td>
<td>éè¦æå®ç«¯å£</td>
</tr>
</tbody>
</table>
<h5 id="ä»ä¹æ¶åä½¿ç¨tcpæ¨¡å¼">ä»ä¹æ¶åä½¿ç¨TCPæ¨¡å¼ï¼</h5>
<ul>
<li>åºæ¯ 1ï¼ICMPè¢«é²ç«å¢å±è½æICMPéé</li>
</ul>
<pre><code># ICMP æ¨¡å¼å¤±è´¥
mtr api.example.com
â å¤§é "waiting for reply" æ 100% ä¸¢å

# æ¹ç¨ TCP æ¨¡å¼ï¼æµè¯ 443 ç«¯å£ï¼
mtr -T -P 443 api.example.com
â æ­£å¸¸æ¾ç¤ºè·¯ç±è·¯å¾
</code></pre>
<ul>
<li>åºæ¯ 2ï¼æµè¯ç¹å®æå¡çç½ç»è´¨é</li>
</ul>
<pre><code># æµè¯ HTTPS æå¡ï¼443 ç«¯å£ï¼
mtr -T -P 443 api.example.com

# æµè¯ HTTP æå¡ï¼80 ç«¯å£ï¼
mtr -T -P 80 www.example.com

# æµè¯ SSH æå¡ï¼22 ç«¯å£ï¼
mtr -T -P 22 server.example.com

# æµè¯æ°æ®åºï¼3306 ç«¯å£ï¼
mtr -T -P 3306 db.example.com
</code></pre>
<p><code>mtr</code>ä½¿ç¨TCPåè®®è¿è¡ç½ç»æ£æµçè¿ç¨æ¯éè¿ TCPä¸æ¬¡æ¡æçåä¸¤æ­¥å®æç</p>
<pre><code>Client â SYN (dst port 443, TTL=N)
Server â SYN-ACK
Client â RST   ï¼ç«å»ï¼

</code></pre>
<p><code>mtr</code>çTCPæ¨¡å¼åªå®æâä¸æ¬¡æ¡æçåä¸¤æ­¥âï¼å¹¶å¨æ¶å°ååºåç«å»ä¸»å¨ <code>RST</code>ï¼ä¸ä¼å»ºç«çæ­£çTCPè¿æ¥ï¼æ´ä¸ä¼å½¢æå¤§éçESTABLISHED è¿æ¥ï¼å¯¹ç®æ ä¸»æºæ§è½å ä¹æ²¡æå½±åã</p>
<h5 id="ä»ä¹æ¶åä½¿ç¨udpæ¨¡å¼">ä»ä¹æ¶åä½¿ç¨UDPæ¨¡å¼ï¼</h5>
<ul>
<li>åºæ¯ 1ï¼æµè¯ UDP åºç¨</li>
</ul>
<pre><code># æµè¯ DNS æå¡ï¼53 ç«¯å£ï¼
mtr -u -P 53 8.8.8.8

# æµè¯ VoIP/è§é¢ä¼è®®ï¼å¦ 10000-20000 ç«¯å£èå´ï¼
mtr -u -P 16384 meeting.example.com

# æµè¯æ¸¸ææå¡å¨
mtr -u -P 27015 game.example.com

# æµè¯ VPNï¼å¦ OpenVPNï¼1194 ç«¯å£ï¼
mtr -u -P 1194 vpn.example.com
</code></pre>
<ul>
<li>åºæ¯ 2ï¼ICMP è¢«éæµä½ UDP æ²¡æ</li>
</ul>
<pre><code># æäºç½ç»å¯¹ ICMP éæµä½åè®¸ UDP
mtr -u api.example.com
</code></pre>
<h3 id="å°ç»">å°ç»</h3>
<p>æäº mtr ä¹åï¼å½å®¢æ·åé¦è¯¸å¦ï¼âæä»¬åå¬å®¤æ¯ååå®½å¸¦ãWi-Fi ä¹æ¯æ»¡æ ¼ï¼å°±æ¯ä½ ä»¬çäº§åä¸è¡ï¼é¡µé¢å è½½æ¢ãæ¥å£ååºæ¢âè¿ç±»é®é¢æ¶ï¼ä¸å¿æå¼ ã</p>
<p>æä¸å®¢æ·ä¸èµ·è·ä¸è· <code>mtr</code>ï¼æé¾è·¯æåµåä¸¢åçãå»¶è¿æåºæ¥ï¼æ²¿éæ¯ä¸è·³çç½ç»ç¶æé½ä¼æ¸æ¸æ¥æ¥å°åç°å¨ç¼åãé®é¢ç©¶ç«åºå¨æ¬å°ç½ç»ãè¿è¥åé¾è·¯ï¼è¿æ¯æå¡å¨ä¾§ï¼åºæ¬å°±ä¸ç®äºç¶äºã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-16 11:48">2026-01-16 11:47</span>&nbsp;
<a href="https://www.cnblogs.com/deep-sky">DeepSkyä¸¶</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19491194);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19491194', targetLink: 'https://www.cnblogs.com/deep-sky/p/19491194', title: 'ç½ç»é®é¢å¦ä½ææ¥ï¼mtrå½ä»¤è¯¦è§£' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æ²¡æåç«¯åï¼ææ MCP åè¿äº Chats 1.7.0 AI ç½å³ ]]></title>
    <link>https://www.cnblogs.com/sdcb/p/19489261/20260115-chats-170</link>
    <guid>bcb1ff02f7695b2f350bbc6988f04710</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/sdcb/p/19489261/20260115-chats-170" title="åå¸äº 2026-01-16 08:45">
    <span role="heading" aria-level="2">æ²¡æåç«¯åï¼ææ MCP åè¿äº Chats 1.7.0 AI ç½å³</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>è¿æ¯ä¸ç¯è¡¥æ¡£æç« ã</p>
<p>å¦æä½ è¿ä¸äºè§£ <strong>Sdcb Chats</strong>ï¼ç®åè¯´ï¼è¿æ¯ä¸ä¸ªæ¯æ 20+ ä¸»æµæ¨¡åæå¡åç AI ç½å³ãå®ä¸åªè½è®©ä½ å¨ä¸ä¸ªç»ä¸çé¢éèåç®¡çæææ¨¡åï¼åæ¶ä¹å¼å®¹æ å API åè®®ï¼æ¯æ Docker ä¸é®é¨ç½²ã</p>
<p>ç°å¨åå¤´çï¼Sdcb Chats ææ°çæ¬å·²ç»å°äº 1.10ï¼åç»­åèåäºäº¤éæèãCode Interpreterãå¤æ¨¡æåä¼ä¸çº§æéç­âçèµ·æ¥æ´é·âçè½åãä½å¦æè¦é®æï¼<strong>åªä¸ªçæ¬æ¯æä¸ªäººå¼åèå¥çåæ°´å²­ï¼</strong>ç­æ¡å¤§æ¦çè¿æ¯ 1.7.0ã</p>
<p>å ä¸º 1.7.0 ä¸åªæ¯âå äºä¸ªåè½âï¼èæ¯æä¸ä»¶äºåæ¶åçï¼</p>
<ul>
<li>MCPï¼Model Context Protocolï¼å¨ Chats éçæ­£è½å°ï¼ç»äºä»âè½èâèµ°åâè½è°ç¨å·¥å·âï¼çè®ºä¸è½æ¯æä»»ä½ç¬¦å MCP çæ¨¡åæå¡ååå·¥å·æå¡åï¼æ¯å¦ç¥è¯åºãæç´¢å¼æãè®¡ç®å¼æç­ï¼</li>
<li>æ°æ®æ¨¡åä¸æ°æ®åºå¤§æ¹ï¼ç ´åæ§åæ´ï¼ï¼ä¸ºåç»­æ¼è¿æå°åºæç¢ï¼</li>
<li>æ´å³é®çæ¯ï¼ä»è¿ä¸ªçæ¬å¼å§ï¼Chats åºæ¬åææä¸ä¸ªäººç»´æ¤äºââèæç¬¬ä¸æ¬¡æ·±åº¦å°è¯äº AI çâæ°å´ç¼ç¨ï¼Vibe Codingï¼âã</li>
</ul>
<hr>
<h2 id="ä¸ä¸ªæç©ºçªæ²¡æåç«¯çæç¬¬ä¸æ¬¡æaiå½åäº">ä¸ä¸ªæç©ºçªï¼æ²¡æåç«¯çæï¼ç¬¬ä¸æ¬¡æAIå½åäº</h2>
<p>è·ç¦»ä¸æ¬¡ 1.6 æ­£å¼åå¸è¿å»äº 3 ä¸ªå¤æãè¿æé´ï¼åææ­æ¡£å Chats åç«¯çæåå ä¸ºæäºæ²¡åæ³ç»§ç»­åä¸å¼åãæ²¡æåç«¯å¼åï¼æä¸ä¸ªåç«¯å¨ Next.js / React è¿å¥ä½ç³»éï¼çäº§åå ä¹ç´æ¥å½é¶ââé¡¹ç®ä¸åº¦é·å¥åæ»ã</p>
<p>äºæ¯æç¬¬ä¸æ¬¡è®¤çå°è¯æ AI å½ä½âå¯é©¾é©¶âï¼ä»é¡µé¢å¸å±ãç¶æç®¡çãç»ä»¶æåï¼å°åç§å¥æªç UI è¾¹è§è¡ä¸ºï¼å°¤å¶æ¯æµå¼è¾åºåå·¥å·è°ç¨å±ç¤ºï¼ï¼é½è®© AI ä¸èµ·åä¸ã</p>
<p>å¯ä»¥è¿æ ·è¯´ï¼</p>
<ul>
<li>Chats 1.7 ä¹åï¼åºæ¬è¿æ¯äººç±»ä¸è¡ä»£ç ä¸è¡ä»£ç æ¸ä¸å»çï¼</li>
<li>Chats 1.7.0 èµ·ï¼æå¼å§âç³»ç»æ§âå° Vibe Codingï¼<strong>å°¤å¶æ¯å¨æå¹¶ä¸çç React ä¸ï¼çäº§åæåéå¸¸ææ¾</strong>ï¼</li>
<li>ä¹ä»è¿æ¶èµ·ï¼Chats çç»´æ¤èï¼å ä¹ï¼åæäºæä¸ä¸ªäººã</li>
</ul>
<p>æä»¥è¿ç¯æç« æ é¢éåâæè°¢ AIâï¼ä¸æ¯å®¢å¥ï¼æ¯äºå®ã</p>
<hr>
<h2 id="170-çæ ¸å¿mcp-åè®®å¨é¢è½å°">1.7.0 çæ ¸å¿ï¼MCP åè®®å¨é¢è½å°</h2>
<p>å¦æä½ æ Chats åªå½æä¸ä¸ªâç»ä¸æ¨¡åç½å³ + æ¼äº® UIâçèå¤©åç«¯ï¼é£å®çä¸éå°±åªæ¯âææ¨¡ååç­å±ç¤ºåºæ¥âãä½ MCP çåºç°ï¼è®©âæ¨¡åè½åäºâæäºæ´ç»ä¸ãæ´å¯ç»åçæ¹å¼ã</p>
<p>å¨ 1.7.0 éï¼MCP çè½å°ä¸æ¯åçå¨âè½è¿ä¸âï¼èæ¯ææ´æ¡é¾è·¯æéäºï¼</p>
<ul>
<li>
<p>åç«¯æå®æ´ç MCP å®ä½ä¸æéå³ç³»ï¼ServerãToolãUser ææãChat ç»å®ï¼ï¼</p>
</li>
<li>
<p>åç«¯è®¾ç½®é¡µæ°å¢ MCP ç®¡çï¼æ°å¢/ç¼è¾ Serverãæåå·¥å·ãåéç¨æ·ï¼<br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260115213720114-1699629549.png" alt="02-mcp-list" loading="lazy"><br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260115213726314-440296231.png" alt="03-mcp-edit" loading="lazy"><br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260115213729222-1808157068.png" alt="04-mcp-assign-user" loading="lazy"></p>
</li>
<li>
<p>ä¼è¯ä¾§å¯ç»å®å¤ä¸ª MCP Serverï¼å¹¶å¨ä¼è¯åæ ¡éªå½åç¨æ·æéï¼</p>
</li>
<li>
<p>å·¥å·è°ç¨å¨ç¨èµ°æµå¼è¾åºï¼åæ°ä¸ç»æè½ä»¥ç»æåæ¹å¼è¿å¥æ¶æ¯åå®¹ï¼åç«¯ä¹è½æ´å¥½å°å¯è§åå±ç¤ºã<br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260115213734256-659322865.png" alt="05-mcp-call" loading="lazy"></p>
</li>
</ul>
<p>å¯¹æèè¨ï¼è¿æå³ç Chats ä»âèå¤© UIâåçº§æäºâå·¥å·ç¼æå¹³å°âçéå½¢ï¼ä½ å¯ä»¥ç»ä¸åç Chat Span éç½®ä¸åçå·¥å·éåï¼è®©å®ä»¬å¨åä¸å¥å¯¹è¯ä½éªéåæ¥ä½ç¨ã</p>
<hr>
<h2 id="å·¥å·è°ç¨ä½éªä¸åªæ¯è½ç¨èæ¯è¦çå¾æ">å·¥å·è°ç¨ä½éªï¼ä¸åªæ¯è½ç¨ï¼èæ¯è¦âçå¾æâ</h2>
<p>åè¿å·¥å·è°ç¨çäººé½ç¥éï¼<strong>è½è°ç¨æ¯ä¸åäºï¼è®©ç¨æ·çæåçäºä»ä¹æ¯å¦ä¸åäºã</strong></p>
<p>1.7.0 å¨å·¥å·è°ç¨çäºä»¶ä¸æ¶æ¯ç»æä¸åäºæ¯è¾å¤§çå¢å¼ºï¼SSE äºä»¶æ´ä¸°å¯ãæ¶æ¯åå®¹éæ°å¢äºå·¥å·è¯·æ±/ååºçç±»åï¼åç«¯è½æâè°ç¨äºä»ä¹å·¥å·ãä¼ äºä»ä¹åæ°ãæ¿å°äºä»ä¹ç»æâä»¥æ´æ¸æ°çæ¹å¼å±ç¤ºåºæ¥ã<br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260115213740193-1073025986.png" alt="06-sse-response-line" loading="lazy"></p>
<p>è¿ä»¶äºçèµ·æ¥åâä½éªâï¼ä½å®ä¼ç´æ¥å½±åä½ æ¯å¦æ¿æå¨çå®ä¸å¡éç¨å·¥å·è°ç¨ï¼å½å·¥å·ä¸å¤ãè°ç¨é¾ä¸é¿ï¼å¦æ UI åªæ¯ä¸å¨ Markdown æ··å¨ä¸èµ·ï¼é£åºæ¬ç­äºä¸å¯ç¨ã</p>
<hr>
<h2 id="ç ´åæ§åæ´æ°æ®åºä¸æ°æ®æ¨¡åçå¤§è§æ¨¡éæ">ç ´åæ§åæ´ï¼æ°æ®åºä¸æ°æ®æ¨¡åçå¤§è§æ¨¡éæ</h2>
<p>1.7.0 è¿æä¸ä¸ªç»ä¸å¼çå³é®è¯ï¼<strong>ç ´åæ§åæ´</strong>ã</p>
<p>ä¸ºäºæåå¯ç»´æ¤æ§ä¸å¯è§æµæ§ï¼æå¨è¿ä¸ªçæ¬éå¯¹æ¶æ¯å­å¨å±åäºéæï¼æ¯å¦æ <code>Message</code> æåä¸º <code>ChatTurn/Step</code> çåå±ç»æï¼ï¼åæ¶è¿ä¼´éäºç¨éå³èãé»è®¤å¼çº¦æãæåºå­æ®µç­ä¸ç³»åè°æ´ã<br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260115213746807-893994786.png" alt="07-db-schema" loading="lazy"></p>
<p>è¿ç§éæçç¹ç¹æ¯ï¼ä½ ç­æä¼çä¸æ¬¡ï¼ä½é¿æä¼çå¾å¤å½ãå°¤å¶æ¯å½ä½ åé¢è¦æç»­å å âæ¨ç/å·¥å·/å¤æ¨¡æ/å®¡è®¡/æ§è½ç»è®¡âè¿äºè½åæ¶ï¼åºå±ç»ææ¯å¦æ¸æ°ï¼å³å®äºä½ æ¯å¨âç»§ç»­ååè½âï¼è¿æ¯å¨âæ¯å ä¸ä¸ªåè½é½è¦æä¸æ¬¡å¢âã</p>
<hr>
<h2 id="ä¸äºæå¾å¨æçç»èæ¹è¿">ä¸äºæå¾å¨æçç»èæ¹è¿</h2>
<p>é¤äº MCP åæ°æ®åºéæï¼1.7.0 è¿æä¸å°âç¨èµ·æ¥ä¼ç½ä¸ç¹âçç¹è¡¥é½äºï¼æ¯å¦ï¼</p>
<ul>
<li>æ¨¡å/å¯é¥/é¢è®¾æ¯æææ½æåºï¼Provider/Key/Model çç»ç»æ¹å¼æ´æ¸æ°ï¼ï¼<br>
<img src="https://io.starworks.cc:88/cv-public/2026/08-drag-reordering.avif" alt="" loading="lazy"></li>
<li>èå¤©åçæè½åå¢å¼ºï¼åæ¡éæ°çæãä»ææ¡ç¨æ·æ¶æ¯å¼å§éæ°çææ´æ®µï¼<br>
<img src="https://io.starworks.cc:88/cv-public/2026/09-regenerate.avif" alt="" loading="lazy"></li>
<li>Markdown Mermaid æ¸²æåçº§ï¼æ/äº®ä¸»é¢ééãå¨å±æ¥çãæµå¼åå¥½ï¼<br>
<img src="https://io.starworks.cc:88/cv-public/2026/10-mermaid.avif" alt="" loading="lazy"></li>
<li>å¾ççæå°ºå¯¸æ§å¶ï¼å¨ä¼è¯ä¸­æå®å¸¸ç¨å°ºå¯¸ï¼</li>
<li>OpenAI å¼å®¹ä¸ç¬¬ä¸æ¹èè°å¢å¼ºï¼å·¥å·è°ç¨ééä¿®å¤ãç»å½å¼å®¹ä¼åç­ï¼ã<br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260115214018456-481361818.png" alt="11-image-size-control" loading="lazy"><br>
è¿äºçèµ·æ¥é¶ç¢ï¼ä½å®ä»¬å±åæååä¸ä¸ªç®æ ï¼<strong>æ Chats ä»âåè½å å âæ¨åâå¯é¿æä½¿ç¨çäº§åè´¨æâã</strong></li>
</ul>
<hr>
<h2 id="åçº§ä¸æ°æ®è¿ç§»ä¸æ¯æèªå¨è¿ç§»è¯·æå¨è·-sqlåªæä¾-sql-server">åçº§ä¸æ°æ®è¿ç§»ï¼ä¸æ¯æèªå¨è¿ç§»ï¼è¯·æå¨è· SQLï¼åªæä¾ SQL Serverï¼</h2>
<p>Sdcb Chatsçæ°æ®åºåæ´ <strong>ä¸æ¯æèªå¨æ°æ®è¿ç§»</strong>ãåçº§æ¶ä½ éè¦<strong>æå¨æ§è¡ SQL è¿ç§»èæ¬</strong>ï¼å¹¶ä¸ç®ååªæä¾äº <strong>SQL Server</strong> çè¿ç§»èæ¬ï¼</p>
<ul>
<li>1.7.0 è¿ç§»èæ¬ï¼<code>src/scripts/db-migration/1.7/20250516-mcp.sql</code></li>
</ul>
<p>åºæ¬æ­¥éª¤ä¹å¾æ´ç´ ï¼</p>
<ol>
<li>åå¤ä»½æ°æ®åºï¼</li>
<li>å¨ SQL Server ä¸æ§è¡ä¸é¢çè¿ç§»èæ¬ï¼</li>
</ol>
<p>å¦æä½ ç¨çæ¯ SQLite æ Postgresâ¦â¦æå»ºè®®ä½ åæä¸æ ·ï¼æ SQL ç©ç» AIï¼è®©å®å¸®ä½ æ¹æ SQLite/Postgres çæ¬ï¼ç¶åä½ åä¸è¾¹è·ä¸è¾¹ä¿®ï¼æèå¦æä½ è½æ¥åï¼åå åºï¼Chats ä¼å¨ç¬¬ä¸æ¬¡å¯å¨æ¶èªå¨åå»ºæ°è¡¨ç»æã</p>
<hr>
<h2 id="è´è°¢">è´è°¢</h2>
<p>1.7.0 çåå¸è¯´æéï¼æç¹å«æè°¢è¿ç¤¾åºè´¡ç®ï¼æ¯å¦<a href="https://github.com/sdcb/chats/pull/96" target="_blank" rel="noopener nofollow">ä¿®å¤ç»å½é¡µé¢è¿è¡æ¶éè¯¯ç PR #96</a>ï¼ãèå¨è¿ç¯è¡¥æ¡£éï¼æè¿æ³å ä¸ä¸ªæ´ä¸ªäººçè´è°¢ï¼æè°¢ AIã</p>
<hr>
<p>æè°¢éè¯»ï¼åæ¬¢çæåè¯·ç»æçGithubé¡¹ç®ä¸ä¸ªstarï¼<a href="https://github.com/sdcb/chats" target="_blank" rel="noopener nofollow">https://github.com/sdcb/chats</a><br>
æä»ä¹æ³æ³ä¹æ¬¢è¿å¨è¯è®ºåºçè¨äº¤æµï¼ä¹æ¬¢è¿å å¥æç <strong>Chats QQç¾¤ï¼498452653</strong>ï¼æä»¬ä¸èµ·æ¢ç´¢æ´å¤AIææ¯ç¡¬æ ¸ç©æ³ã</p>
<p>å¾®ä¿¡ç¾¤ï¼<img src="https://io.starworks.cc:88/cv-public/2026/chats-wxg-qr.png" alt="" loading="lazy"></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-16 08:45">2026-01-16 08:45</span>&nbsp;
<a href="https://www.cnblogs.com/sdcb">.NETéªæä½</a>&nbsp;
éè¯»(<span id="post_view_count">225</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19489261);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19489261', targetLink: 'https://www.cnblogs.com/sdcb/p/19489261/20260115-chats-170', title: 'æ²¡æåç«¯åï¼ææ MCP åè¿äº Chats 1.7.0 AI ç½å³' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å«åæå URL è§£æå¨äºï¼PHP 8.5 URI æ©å±è®© URL å¤çæ´å®å¨ãæ´å¹²å ]]></title>
    <link>https://www.cnblogs.com/catchadmin/p/19490082</link>
    <guid>558c3c53efa3e71fac89d3d533916200</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/catchadmin/p/19490082" title="åå¸äº 2026-01-16 07:48">
    <span role="heading" aria-level="2">å«åæå URL è§£æå¨äºï¼PHP 8.5 URI æ©å±è®© URL å¤çæ´å®å¨ãæ´å¹²å</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="å«åæå-url-è§£æå¨äºphp-85-uri-æ©å±è®©-url-å¤çæ´å®å¨æ´å¹²å">å«åæå URL è§£æå¨äºï¼PHP 8.5 URI æ©å±è®© URL å¤çæ´å®å¨ãæ´å¹²å</h1>
<h2 id="parse_url-è½ç¨ä½ä¸å¤ç¨">parse_url() è½ç¨ï¼ä½ä¸å¤ç¨</h2>
<p>å¤å¹´æ¥ï¼PHP å¼åèå¤ç URL çæ¹å¼å¤§åå°å¼ï¼</p>
<ul>
<li>ç¨ <code>parse_url()</code> æååé¨å</li>
<li>ç¨ <code>rawurlencode()</code> / <code>urlencode()</code> è½¬ä¹</li>
<li>ç¨å­ç¬¦ä¸²æ¼æ¥éå»ºæç» URL</li>
<li>éå°"å¥æª"è¾å¥æ¶ï¼åä¸å ä¸ªæ­£å</li>
</ul>
<p>å¤§å¤æ°æåµä¸è¿å¥æµç¨è½è·éãé®é¢å¨äºï¼URL å¤çæ°æ°æ¯é£ç§"å¨è¾¹è§æåµä¸åºé®é¢"çé¢åï¼ç¼ç ãfragmentãuserinfoãå½éåååã"ç­ä»·ä½ä¸ç¸å"ç URLï¼ä»¥ååç§åªå¨çäº§æ¥å¿éæååºæ¥çè¾¹ç¼åºæ¯ã</p>
<p>PHP 8.5 æä¾äºä¸ä¸ªåç½®æ¿ä»£æ¹æ¡ï¼ä¸ä¸ªå§ç»å¯ç¨ç URI æ©å±ï¼æä¾ API æ¥æç§ RFC 3986 å WHATWG URL æ åè§£æãä¿®æ¹ URL/URIã</p>
<p>å¦æ"æ å"äºå­è®©ä½ è§å¾æ½è±¡ï¼è¿éç»åºå®éå«ä¹ï¼</p>
<ul>
<li>æ¿å° URI/URL å¯¹è±¡ï¼èä¸æ¯æ°ç» + å­ç¬¦ä¸²æ¼æ¥ã</li>
<li>ç¨å®å¨çç»ä»¶ getter åä¸å¯åç <code>with*()</code> æ¹æ³ã</li>
<li>ä½ å¯ä»¥éæ© RFC 3986 è¡ä¸ºï¼ä¸¥æ ¼ URIï¼"åå§ vs è§èåè§£ç "ï¼ææµè§å¨é£æ ¼ç WHATWG è¡ä¸ºï¼Unicode/IDNAãè½¯éè¯¯ãèªå¨ç¼ç ï¼ã</li>
</ul>
<p>æ¬ææ¯ä¸ç¯å®ææç¨ï¼éç¹è®²ï¼</p>
<ul>
<li>ä¸ºä»ä¹æå¨è§£æå®¹æåºéï¼</li>
<li>æ° URI å¯¹è±¡æä¹ç¨ï¼</li>
<li>å¦ä½å®å¨å°ä¿®æ¹/è§èåï¼</li>
<li>å¨éå®åãç­¾åé¾æ¥ç­å®å¨ææåºæ¯ä¸å¦ä½ä½¿ç¨ã</li>
</ul>
<p>ä¸è®²åçº§æåï¼ä¸è®²åºå¼æ¸åââåªè®² URI æ©å±ã</p>
<p><a href="https://catchadmin.com/post/2026-01/php85-uri-extension-safer-cleaner-urls" target="_blank" rel="noopener nofollow">åæ å«åæå URL è§£æå¨äºï¼PHP 8.5 URI æ©å±è®© URL å¤çæ´å®å¨ãæ´å¹²å</a></p>
<h2 id="æå¨-url-è§£æçé®é¢">æå¨ URL è§£æçé®é¢</h2>
<h3 id="parse_url-ä¸è§£ç èä¸å¾å®¹æå¿">parse_url() ä¸è§£ç ï¼èä¸å¾å®¹æå¿ï¼</h3>
<p>PHP ç <code>parse_url()</code> è¿ååç»ä»¶ï¼ä½<strong>ä¸ä¼</strong> URL è§£ç å®ä»¬ã</p>
<p>ä¹å°±æ¯è¯´ï¼</p>
<pre><code class="language-php">$u = parse_url("https://example.com/t%65st?name=Ali%63e#fr%61g");
var_dump($u['path']);   // "/t%65st"
var_dump($u['query']);  // "name=Ali%63e"
var_dump($u['fragment']); // "fr%61g"
</code></pre>
<p>å¦æä½ å¨æ¯è¾è·¯å¾æåºç¨è·¯ç±è§åæ¶æ²¡æç»ä¸è§£ç /è§èåï¼å¯è½ä¼æç­ä»·ç URI å½æä¸åçæ¥å¤çã</p>
<p>æ´ç³çæ¯ï¼å¢éå¾å¾æ··ç¨ï¼</p>
<ul>
<li>æäºå°æ¹ç¨è§£ç åçå¼ï¼</li>
<li>æäºå°æ¹ç¨åå§å¼ï¼</li>
<li>åå ä¸æ£è½å¨åå¤çä¸´æ¶è§£ç é»è¾ã</li>
</ul>
<p>è¿ç§æ··ä¹±å¾å®¹æåä¸éè½ bug åå®å¨éæ£ã</p>
<h3 id="å­ç¬¦ä¸²æ¼æ¥å®¹ææ¼åºå·®ä¸ç¹å¯¹ç-url">å­ç¬¦ä¸²æ¼æ¥å®¹ææ¼åº"å·®ä¸ç¹å¯¹"ç URL</h3>
<p>æå¨éå»º URL å®¹æç¯çéï¼</p>
<ul>
<li>æ¼æ <code>?</code> æ <code>#</code></li>
<li>éå¤ç¼ç </li>
<li>å®å¨æ²¡ç¼ç </li>
<li>ç¼ç éäºä¸è¥¿ï¼æ¯å¦ææ´ä¸ª query string ç¼ç èä¸æ¯åªç¼ç  valueï¼</li>
<li>ä¸¢å¤±ææä¹±åæ°é¡ºåº</li>
<li>ç©º query/fragment å¤çä¸å½</li>
</ul>
<p>ä¸ä¸ªå¸¸è§ç"å·®ä¸ç¹å¯¹"å½æ°ï¼</p>
<pre><code class="language-php">function addQueryParam(string $url, string $key, string $value): string
{
    $parts = parse_url($url);
    $query = $parts['query'] ?? '';
    $query .= ($query === '' ? '' : '&amp;') . $key . '=' . urlencode($value);
    $out = $parts['scheme'] . '://' . $parts['host'] . ($parts['path'] ?? '');
    if ($query !== '') {
        $out .= '?' . $query;
    }
    if (isset($parts['fragment'])) {
        $out .= '#' . $parts['fragment'];
    }
    return $out;
}
</code></pre>
<p>çèµ·æ¥æ²¡é®é¢ãç´å°éå°ï¼</p>
<ul>
<li>æ²¡æ scheme/host ç URLï¼ç¸å¯¹ URLï¼ï¼</li>
<li>å¸¦ userinfo/port ç URLï¼</li>
<li>å·²ç»ç¼ç è¿çå¼ï¼</li>
<li>éè¦ <code>rawurlencode()</code> è§åï¼RFC 3986ï¼çåæ°ï¼</li>
<li>åºè¯¥åæ ·ä¿çç fragmentã</li>
</ul>
<h3 id="ç­ä»·ç-url-ä¸ä¸å®æ¯ç¸åçå­ç¬¦ä¸²">ç­ä»·ç URL ä¸ä¸å®æ¯ç¸åçå­ç¬¦ä¸²</h3>
<p>ä¸é¢è¿äºå¯ä»¥æååä¸ä¸ªèµæºï¼ä½å­ç¬¦ä¸²ä¸åï¼</p>
<ul>
<li>scheme/host å¤§å°åä¸åï¼<code>HTTPS://EXAMPLE.com</code>ï¼</li>
<li>path ä¸­ <code>%65</code> vs <code>e</code>ï¼<code>/t%65st</code> vs <code>/test</code>ï¼</li>
<li>path ä¸­çç¹å·æ®µï¼<code>/foo/../bar/</code>ï¼</li>
<li>é»è®¤ç«¯å£ï¼https ç <code>:443</code>ï¼</li>
</ul>
<p>å¦æä½ æ URL å½æçº¯å­ç¬¦ä¸²å¤çï¼è¦ä¹ï¼</p>
<ul>
<li>ç¼å­/è·¯ç±åºç°è¯¡å¼é®é¢ï¼</li>
<li>è¦ä¹å®å¨æ£æ¥è¢«ç»è¿ï¼å ä¸ºä½ æ¯è¾çæ¯"éè¯¯çè¡¨ç¤ºå½¢å¼"ã</li>
</ul>
<h3 id="idnaå½éåååè¿æ¶åå®å¨é®é¢">IDNAï¼å½éåååï¼è¿æ¶åå®å¨é®é¢</h3>
<p>å¦æä½ åè®¸ç¨æ·æäº¤ URLï¼å½éåååå¯è½æ¯åæ³çââä½ä¹å¯è½é ææ··æ·ãååå¯ä»¥ç¨ Unicode æ punycodeï¼ASCII å½¢å¼ï¼è¡¨ç¤ºãRFC è®¨è®ºä¸­æç¡®æåºäººä¸ºé£é©ï¼punycode ååå¨ Unicode æ¸²ææ¶å¯è½çèµ·æ¥åä¸ä¸ªçæçãä½å®éä¸åçååã</p>
<p>è¿ä¸æ¯ä½ æ³ç¨æ­£å"æå¨å¤ç"ç¶åç¥ç¥·æ²¡é®é¢çäºã</p>
<h2 id="uri-æ©å±çæ¦å¿µuri-å¯¹è±¡--ä¸¤å¥æ å">URI æ©å±çæ¦å¿µï¼URI å¯¹è±¡ + ä¸¤å¥æ å</h2>
<p>PHP 8.5 ç URI æ©å±æä¾ä¸¤ä¸ªä¸»è¦ç±»ï¼</p>
<ul>
<li><code>Uri\Rfc3986\Uri</code>ï¼RFC 3986 åè§ï¼ä¸¥æ ¼ URI è§åï¼</li>
<li><code>Uri\WhatWg\Url</code>ï¼WHATWG URL åè§ï¼æµè§å¨é£æ ¼ç URL è§åï¼</li>
</ul>
<p>éå¥çç±»ååæ¬ï¼</p>
<ul>
<li><code>Uri\InvalidUriException</code></li>
<li><code>Uri\WhatWg\InvalidUrlException</code></li>
<li><code>Uri\WhatWg\UrlValidationError</code> å <code>UrlValidationErrorType</code></li>
<li><code>Uri\UriComparisonMode</code>ï¼ç¨äºæ¯è¾ï¼</li>
</ul>
<p>ä¸ä¸ªå³é®è®¾è®¡å³ç­ï¼ä¸¤ä¸ªå®ç°é½æ¯ readonly ä¸ä»¥ä¸å¯åæ¹å¼ä½¿ç¨ââ<code>withPath()</code>ã<code>withQuery()</code> ç­æ¹æ³è¿åæ°å®ä¾ã</p>
<p>å¦ä¸ä¸ªè¦ç¹ï¼è¿ä¸ªæ©å±å¨ PHP 8.5 ä¸­å§ç»å¯ç¨ï¼åºå±ç±ä»¥ä¸åºé©±å¨ï¼</p>
<ul>
<li>uriparserï¼ç¨äº RFC 3986ï¼</li>
<li>Lexborï¼ç¨äº WHATWG URLï¼</li>
</ul>
<p>æä»¥ä½ ä¸éè¦ç¬¬ä¸æ¹åºå°±è½è·å¾åçç URL å¤çè½åã</p>
<h2 id="åå»ºåè§£æ-uriä»å­ç¬¦ä¸²å°ç»ä»¶">åå»ºåè§£æ URIï¼ä»å­ç¬¦ä¸²å°ç»ä»¶</h2>
<h3 id="æç®åçæåµè§£æä¸ä¸ª-http-url-å¹¶è®¿é®åé¨å">æç®åçæåµï¼è§£æä¸ä¸ª HTTP URL å¹¶è®¿é®åé¨å</h3>
<p>RFC 3986ï¼</p>
<pre><code class="language-php">use Uri\Rfc3986\Uri;

$uri = new Uri("https://php.net/releases/8.5/en.php");

echo $uri-&gt;getScheme(); // "https"
echo $uri-&gt;getHost();   // "php.net"
echo $uri-&gt;getPath();   // "/releases/8.5/en.php"
</code></pre>
<p>WHATWGï¼</p>
<pre><code class="language-php">use Uri\WhatWg\Url;

$url = new Url("https://example.com/path?query=1#frag");

echo $url-&gt;getScheme();      // "https"
echo $url-&gt;getAsciiHost();   // "example.com"
echo $url-&gt;getPath();        // "/path"
echo $url-&gt;getQuery();       // "query=1"
echo $url-&gt;getFragment();    // "frag"
</code></pre>
<p>æ³¨æï¼WHATWG ç getter ææä¸è¿ååéç¬¦ï¼å¦ <code>:</code> <code>/</code> <code>?</code> <code>#</code>ï¼ã</p>
<h3 id="æé å½æ°æå¼å¸¸parse-è¿å-null">æé å½æ°æå¼å¸¸ï¼parse() è¿å null</h3>
<p>ä¸¤ä¸ªå®ç°é½æ¯æä¸¤ç§è§£æé£æ ¼ï¼</p>
<ul>
<li>æé å½æ°ï¼æ ææ¶æå¼å¸¸</li>
<li><code>parse()</code>ï¼æ ææ¶è¿å null</li>
</ul>
<p>RFC 3986 è¡ä¸ºï¼</p>
<pre><code class="language-php">use Uri\Rfc3986\Uri;
use Uri\InvalidUriException;

try {
    $uri = new Uri("not a uri");
} catch (InvalidUriException $e) {
    // æç»è¾å¥
}

$uri = Uri::parse("not a uri");
var_dump($uri); // null
</code></pre>
<p>WHATWG è¡ä¸ºæä¾æ´ä¸°å¯çéè¯¯ä¿¡æ¯ï¼</p>
<pre><code class="language-php">use Uri\WhatWg\Url;
use Uri\WhatWg\InvalidUrlException;

try {
    $url = new Url("invalid url");
} catch (InvalidUrlException $e) {
    // $e-&gt;errors åå« UrlValidationError å®ä¾
}

$errors = [];
$url = Url::parse("invalid url", null, $errors);
var_dump($url);    // null
var_dump($errors); // UrlValidationError æ°ç»
</code></pre>
<p>è¿ç§åºåï¼ç¡¬éè¯¯ vs è½¯éè¯¯ vs parse-and-return-nullï¼å¨ RFC ä¸­æè¯¦ç»è¯´æã</p>
<h3 id="base-url-åå¼ç¨è§£æç¸å¯¹--ç»å¯¹">Base URL åå¼ç¨è§£æï¼ç¸å¯¹ â ç»å¯¹ï¼</h3>
<p>æäºè¿ä¸ªåè½ï¼ä½ ä¸åéè¦æå¨æ£æ¥æ¯å¦ä»¥ <code>/</code> å¼å¤´ç¶åæ¼æ¥ã</p>
<p>å¨æé å½æ°æ <code>parse()</code> ä¸­ä½¿ç¨ base URLï¼</p>
<pre><code class="language-php">use Uri\Rfc3986\Uri;

$base = new Uri("https://example.com");
$uri  = new Uri("/foo", $base);

echo $uri-&gt;toString(); // "https://example.com/foo"
</code></pre>
<p>WHATWG ç±»ä¼¼ï¼</p>
<pre><code class="language-php">use Uri\WhatWg\Url;

$base = new Url("https://example.com");
$url  = Url::parse("/foo", $base);

echo $url-&gt;toAsciiString(); // "https://example.com/foo"
</code></pre>
<p>æ©å±è¿æä¾äºä¾¿æ·ç <code>resolve()</code> æ¹æ³ï¼ä»¥å½åå¯¹è±¡ä½ä¸º baseã</p>
<h2 id="å®å¨ä¿®æ¹è®¾ç½®æ¿æ¢-pathqueryfragmentä¸å¯å">å®å¨ä¿®æ¹ï¼è®¾ç½®/æ¿æ¢ pathãqueryãfragmentï¼ä¸å¯åï¼</h2>
<p>æ¿å°å¯¹è±¡åï¼å¯ä»¥ç¨ <code>with*()</code> æ¹æ³ä¿®æ¹ç»ä»¶ãè¿äºæ¹æ³è¿åæ°å®ä¾ï¼åå¯¹è±¡ä¿æä¸åã</p>
<h3 id="rfc-3986withpathwithquerywithfragment">RFC 3986ï¼withPath()ãwithQuery()ãwithFragment()</h3>
<pre><code class="language-php">use Uri\Rfc3986\Uri;

$uri = new Uri("https://example.com/products?sort=asc#top");

$updated = $uri
    -&gt;withPath("/products/123")
    -&gt;withQuery("sort=desc&amp;ref=home")
    -&gt;withFragment("reviews");

echo $uri-&gt;toString();     // åå¯¹è±¡ä¸å
echo $updated-&gt;toString(); // ä¿®æ¹åç
</code></pre>
<p>RFC 3986 æä¾"åå§"å"è§èåè§£ç "ä¸¤ç§ getterï¼ä¸ä¸èè¯¦è¿°ï¼ï¼ä»¥å <code>toString()</code> å <code>toRawString()</code> æ¹æ³ã</p>
<h3 id="whatwgåæ ·çæè·¯å¤å -asciiunicode-å­ç¬¦ä¸²è¾åº">WHATWGï¼åæ ·çæè·¯ï¼å¤å  ASCII/Unicode å­ç¬¦ä¸²è¾åº</h3>
<pre><code class="language-php">use Uri\WhatWg\Url;

$url = new Url("https://example.com/");

$new = $url
    -&gt;withPath("/search")
    -&gt;withQuery("q=php+8.5")
    -&gt;withFragment("results");

echo $new-&gt;toAsciiString();
echo $new-&gt;toUnicodeString();
</code></pre>
<p>WHATWG æ <code>toAsciiString()</code> å <code>toUnicodeString()</code> ä¸¤ç§è¾åºï¼åå«ç¨äºæºå¨å¤çåäººç±»å±ç¤ºã</p>
<h3 id="ä¸ä¸ªå°ä½éè¦çè¡ä¸ºè¾å¥ä¸­çåéç¬¦">ä¸ä¸ªå°ä½éè¦çè¡ä¸ºï¼è¾å¥ä¸­çåéç¬¦</h3>
<p>ä½¿ç¨ WHATWG æ¶ï¼å¦æä½ å¨è®¾ç½® query/fragment æ¶ä¸å°å¿åå«äº <code>?</code> æ <code>#</code>ï¼å®ä¼æå®ä»¬å½ä½åéç¬¦å¹¶å»æï¼</p>
<pre><code class="language-php">use Uri\WhatWg\Url;

$url = new Url("https://example.com/");
$url = $url-&gt;withQuery("?foo");
$url = $url-&gt;withFragment("#bar");

echo $url-&gt;getQuery();    // "foo"
echo $url-&gt;getFragment(); // "bar"
</code></pre>
<p>è¿ä¸ªè¡ä¸ºå¨ææ¡£ä¸­ææç¡®è¯´æã</p>
<h2 id="è§èåä¸ç¼ç é¿åéå¤ç¼ç åå¥æªå­ç¬¦">è§èåä¸ç¼ç ï¼é¿åéå¤ç¼ç å"å¥æªå­ç¬¦"</h2>
<p>URI æ©å±çä»·å¼ä¸æ­¢äº API è®¾è®¡ââå®è®©ä½ è½æ§å¶ URL çè¡¨ç¤ºå½¢å¼ã</p>
<h3 id="rfc-3986-ç»ä½ ä¸¤ç§è¡¨ç¤ºåå§-vs-è§èåè§£ç ">RFC 3986 ç»ä½ ä¸¤ç§è¡¨ç¤ºï¼åå§ vs è§èåè§£ç </h3>
<p>å¯¹äºå¤§å¤æ°ç»ä»¶ï¼<code>Uri\Rfc3986\Uri</code> æ´é²ï¼</p>
<ul>
<li>rawï¼è§£æå¨ç»åºçå½¢å¼ï¼ææ¥è¿åå§è¾å¥ï¼</li>
<li>è§èåè§£ç ï¼è§èå + ç¾åå·è§£ç ï¼æå¨æä¸ºè§èå½¢å¼ä¸å¯å¾è¿è½¬æ¢</li>
</ul>
<p>RFC è§£éäºä¸ºä»ä¹éè¦ä¸¤ç§å½¢å¼ä»¥åä½æ¶ä½¿ç¨ââç­¾åæ¹å API å®¢æ·ç«¯éå¸¸åå¥½ rawï¼èè·¯ç±/ç¼å­éå¸¸åå¥½è§èåè§£ç ã</p>
<p>å·ä½ææï¼</p>
<pre><code class="language-php">use Uri\Rfc3986\Uri;

$uri = new Uri("https://%61pple:p%61ss@ex%61mple.com:433/foob%61r?%61bc=%61bc#%61bc");

echo $uri-&gt;getRawHost(); // "ex%61mple.com"
echo $uri-&gt;getHost();    // "example.com"

echo $uri-&gt;getRawPath(); // "/foob%61r"
echo $uri-&gt;getPath();    // "/foobar"

echo $uri-&gt;getRawQuery(); // "%61bc=%61bc"
echo $uri-&gt;getQuery();    // "abc=abc"
</code></pre>
<p>è§èåç¤ºä¾ï¼</p>
<pre><code class="language-php">use Uri\Rfc3986\Uri;

$uri = new Uri("HTTPS://EXAMPLE.COM/foo/../bar/");

echo $uri-&gt;getRawScheme(); // "HTTPS"
echo $uri-&gt;getScheme();    // "https"

echo $uri-&gt;getRawHost(); // "EXAMPLE.COM"
echo $uri-&gt;getHost();    // "example.com"

echo $uri-&gt;getRawPath(); // "/foo/../bar/"
echo $uri-&gt;getPath();    // "/bar/"
</code></pre>
<h3 id="whatwg-å¨ä¿®æ¹æ¶èªå¨ç¼ç æäºå­ç¬¦">WHATWG å¨ä¿®æ¹æ¶èªå¨ç¼ç æäºå­ç¬¦</h3>
<p>å¦æä½ è®¾ç½®ç path åå«è¯¥ç»ä»¶å¿é¡»ç¾åå·ç¼ç çå­ç¬¦ï¼WHATWG ä¼èªå¨ç¼ç ï¼</p>
<pre><code class="language-php">use Uri\WhatWg\Url;

$url = new Url("https://example.com");
$url = $url-&gt;withPath("/?#:");

echo $url-&gt;getPath(); // "/%3F%23:"
</code></pre>
<p>è¿è½é²æ­¢æå¤æå»ºåºæåç URLã</p>
<h3 id="éå¤ç¼ç é·é±ä»¥åæ°-api-å¦ä½å¸®å¿">"éå¤ç¼ç "é·é±ï¼ä»¥åæ° API å¦ä½å¸®å¿ï¼</h3>
<p>éå¤ç¼ç éå¸¸è¿æ ·åçï¼</p>
<ol>
<li>ä½ ç¨ <code>rawurlencode()</code> ç¼ç ä¸ä¸ªå¼ï¼å ä¸º"å®è¦æ¾è¿ URL"</li>
<li>ä½ æå¨æå®å å° query string</li>
<li>åæ¥æå¤åç¼ç äºä¸æ¬¡ï¼æ¡æ¶ãä»£çãå®¢æ·ç«¯ï¼</li>
</ol>
<p>ä½¿ç¨ URI å¯¹è±¡ï¼ä¸ä¸ªå¥½åæ³æ¯ï¼</p>
<ul>
<li>æ°æ®ä¿æä¸ºæ®éå­ç¬¦ä¸²ï¼æªç¼ç ï¼</li>
<li>ç¨ <code>http_build_query()</code> æå»º queryï¼æä½ åå¥½çç¼ç å¨ï¼</li>
<li>æç»æä¼ ç» <code>withQuery()</code></li>
</ul>
<p>ç¤ºä¾ï¼</p>
<pre><code class="language-php">use Uri\Rfc3986\Uri;

$base = new Uri("https://example.com/search");

$params = [
    'q' =&gt; 'php 8.5 uri',
    'tag' =&gt; 'url/encoding',
];

// RFC 3986 é£æ ¼ç¼ç ï¼ç©ºæ ¼ç¨ %20 èé +ï¼
$query = str_replace('+', '%20', http_build_query($params));

$uri = $base-&gt;withQuery($query);
echo $uri-&gt;toString();
</code></pre>
<p><code>http_build_query()</code> ä¸ä¸å®éåææåºæ¯ï¼ä½å¥½å¤æ¯ç¼ç è§åéä¸­å¨ä¸å¤ï¼èéæ£è½å¨åç§å­ç¬¦ä¸²æ¼æ¥éã</p>
<p>å¦æç¡®å®éè¦å¯¹ path æ®µè¿è¡ RFC 3986 åå§ç¼ç ï¼PHP ç <code>rawurlencode()</code> éµå¾ª RFC 3986 è§åã</p>
<h2 id="éªè¯ç¨æ·è¾å¥ç-urlå®ç¨çæä½è§å">éªè¯ç¨æ·è¾å¥ç URLï¼å®ç¨çæä½è§å</h2>
<p>å¦æè¾å¥æ¥èªç¨æ·ï¼æä¸å¯ä¿¡æ¥æºï¼ï¼éªè¯åºè¯¥ææç¡®çç«åºã</p>
<p>å¯¹äºä½ æç® fetch æè·³è½¬ç URLï¼ä¸ä¸ªå¡å®çå®å¨å¯¼åæ¨¡å¼ï¼</p>
<ul>
<li>å¿é¡»è§£ææåï¼ç¡¬éè¯¯ç´æ¥æç»ï¼</li>
<li>åªåè®¸ http / https</li>
<li>URL ä¸­ä¸è½æç¨æ·å/å¯ç </li>
<li>ååç½ååï¼ç¨ ASCII å½¢å¼æ¯è¾ï¼</li>
<li>å¯éï¼éå¶ç«¯å£</li>
<li>å¯éï¼è¦æ±ç»å¯¹ URLï¼æç¸å¯¹ URL åºäºå·²ç¥ base è§£æï¼</li>
</ul>
<h3 id="ä¸¥æ ¼éªè¯-helperwhatwg-çæ¬">ä¸¥æ ¼éªè¯ helperï¼WHATWG çæ¬ï¼</h3>
<p>WHATWG éåå¤ç"æµè§å¨é£æ ¼"URL å IDNAã</p>
<pre><code class="language-php">use Uri\WhatWg\Url;
use Uri\WhatWg\InvalidUrlException;

function validateExternalUrl(string $input, array $allowedHosts): Url
{
    try {
        $softErrors = [];
        $url = new Url($input, null, $softErrors);
    } catch (InvalidUrlException $e) {
        throw new InvalidArgumentException("Invalid URL.");
    }

    // Scheme ç½åå
    $scheme = $url-&gt;getScheme();
    if (!in_array($scheme, ['http', 'https'], true)) {
        throw new InvalidArgumentException("Unsupported scheme.");
    }

    // ç¦æ­¢å­è¯
    if ($url-&gt;getUsername() !== null || $url-&gt;getPassword() !== null) {
        throw new InvalidArgumentException("Credentials in URL are not allowed.");
    }

    // Host ç½ååï¼ASCII æ¯è¾ï¼
    $host = $url-&gt;getAsciiHost();
    if ($host === null || !in_array(strtolower($host), $allowedHosts, true)) {
        throw new InvalidArgumentException("Host not allowed.");
    }

    // å¯éï¼ç«¯å£éå¶
    $port = $url-&gt;getPort();
    if ($port !== null &amp;&amp; !in_array($port, [80, 443], true)) {
        throw new InvalidArgumentException("Port not allowed.");
    }

    return $url;
}
</code></pre>
<p>å ç¹è¯´æï¼</p>
<ul>
<li><code>Url</code> å³ä½¿è§£ææåä¹å¯è½è¿åè½¯éè¯¯ãRFC è§£éäº"è½¯ vs ç¡¬"æ¨¡åï¼å¹¶ç»åºäºè§£æç»§ç»­ä½æ¥åéªè¯éè¯¯çä¾å­ã</li>
<li>WHATWG åæ¶æ´é² <code>getAsciiHost()</code> å <code>getUnicodeHost()</code>ï¼æ¯è¾éå¸¸ç¨ ASCIIï¼å±ç¤ºç¨ Unicodeã</li>
</ul>
<h3 id="rfc-3986-éªè¯ä¸¥æ ¼-uri-è§£æ--è§èåéé¡¹">RFC 3986 éªè¯ï¼ä¸¥æ ¼ URI è§£æ + è§èåéé¡¹</h3>
<p>å¦æä½ å¨éªè¯éç¨ URIï¼ä¸åªæ¯ HTTP URLï¼ï¼æèä½ å³å¿ raw vs è§èåè§£ç çè¡¨ç¤ºï¼<code>Uri\Rfc3986\Uri</code> æ¯ä¸ªå¥½éæ©ã</p>
<pre><code class="language-php">use Uri\Rfc3986\Uri;
use Uri\InvalidUriException;

function validateHttpUri(string $input, array $allowedHosts): Uri
{
    try {
        $uri = new Uri($input);
    } catch (InvalidUriException $e) {
        throw new InvalidArgumentException("Invalid URI.");
    }

    $scheme = $uri-&gt;getScheme();
    if (!in_array($scheme, ['http', 'https'], true)) {
        throw new InvalidArgumentException("Unsupported scheme.");
    }

    // Userinfo å¨å¤§å¤æ° Web åºç¨ä¸­æ¯ä¸ªå
    if ($uri-&gt;getUserInfo() !== null) {
        throw new InvalidArgumentException("Userinfo is not allowed.");
    }

    $host = $uri-&gt;getHost();
    if ($host === null || !in_array(strtolower($host), $allowedHosts, true)) {
        throw new InvalidArgumentException("Host not allowed.");
    }

    return $uri;
}
</code></pre>
<h2 id="å®éç¨ä¾ç­¾åé¾æ¥å®å¨éå®åè§è-url">å®éç¨ä¾ï¼ç­¾åé¾æ¥ãå®å¨éå®åãè§è URL</h2>
<h3 id="ç¨ä¾ç­¾åé¾æ¥èä¸ç ´åç¼ç ">ç¨ä¾ï¼ç­¾åé¾æ¥èä¸ç ´åç¼ç </h3>
<p>ç­¾å URLï¼HMAC tokenãä¸´æ¶è®¿é®é¾æ¥ãCDN è®¤è¯ï¼å¯¹è¡¨ç¤ºå½¢å¼æå¶ææãä¸ä¸ªå°ç"è§èååæ´"å°±è½ä½¿ç­¾åå¤±æã</p>
<p>è¿ä¹æ¯ RFC æç¡®æåº"API å®¢æ·ç«¯æç­¾åæ¹"éå¸¸åå¥½åå§è¡¨ç¤ºçåå ã</p>
<p>ä¸ä¸ªç®åçç­¾å URL æ¹æ³ï¼</p>
<ol>
<li>æå»º URL</li>
<li>å¯¹ç¨³å®çå­ç¬¦ä¸²è¡¨ç¤ºè®¡ç®ç­¾å</li>
<li>æç­¾åä½ä¸º query åæ°å è¿å»</li>
</ol>
<p>ç¤ºä¾ï¼ä½¿ç¨ RFC 3986 å <code>toRawString()</code> ç­¾åï¼</p>
<pre><code class="language-php">use Uri\Rfc3986\Uri;

function signUri(Uri $uri, string $secret): Uri
{
    // å½ä½ æ³é¿åæå¤è½¬æ¢æ¶ï¼ç¨ raw string
    $baseString = $uri-&gt;toRawString();
    $sig = hash_hmac('sha256', $baseString, $secret);

    $query = $uri-&gt;getRawQuery();
    $query = $query ? $query . '&amp;' : '';
    $query .= 'sig=' . rawurlencode($sig);

    return $uri-&gt;withQuery($query);
}

$uri = new Uri("https://download.example.com/file/%2Fsafe?expires=1736035200");
$signed = signUri($uri, "super-secret-key");

echo $signed-&gt;toRawString();
</code></pre>
<p>ä¸¤ä¸ªè¦ç¹ï¼</p>
<ul>
<li>ä½ æ¯ææéæ© raw çï¼å ä¸ºç­¾åå³å¿çæ¯"çº¿ä¸å®éåéçæ¯ä»ä¹"ã</li>
<li>query æå»ºä»ç¶è¦å°å¿ï¼é¿åç¼ç éè¯¯ã</li>
</ul>
<p>å¦æä½ çç­¾åç®æ³éè¦è§èå½¢å¼ï¼æäºç¡®å®éè¦ï¼ï¼å¯ä»¥ææå¯¹ <code>toString()</code> ç­¾åââä½è¦ç¥éèªå·±å¨åä»ä¹ï¼èä¸æ¯æå¤è¿ä¹åã</p>
<h3 id="ç¨ä¾å®å¨éå®åé¿åå¼æ¾éå®å--è§£ææ··æ·">ç¨ä¾ï¼å®å¨éå®åï¼é¿åå¼æ¾éå®å + è§£ææ··æ·ï¼</h3>
<p>å®å¨éå®åé®é¢éå¸¸é¿è¿æ ·ï¼</p>
<ol>
<li>ä½ æ <code>/login?next=&lt;something&gt;</code></li>
<li>ç»å½åè·³è½¬å° next</li>
<li>æ»å»èå°è¯ <code>next=https://evil.com</code> æåç§åä½</li>
</ol>
<p>ä¸ä¸ªå¥å£®çæ¨¡å¼æ¯ï¼</p>
<ol>
<li>æç¨æ·è¾å¥è§£æä¸ºç¸å¯¹ URL æç»å¯¹ URL</li>
<li>ç¸å¯¹ URL åºäºä½ èªå·±çå·²ç¥ base è§£æ</li>
<li>éªè¯ host/scheme æ¯ä½ çï¼æå¨åè®¸åè¡¨ä¸­ï¼</li>
</ol>
<p>ä½¿ç¨ WHATWGï¼</p>
<pre><code class="language-php">use Uri\WhatWg\Url;

function safeRedirectTarget(string $next, string $appBase): string
{
    $base = new Url($appBase);

    // å®å¨è§£æç¸å¯¹å¼ç¨
    $errors = [];
    $resolved = Url::parse($next, $base, $errors);

    if ($resolved === null) {
        return $base-&gt;toAsciiString(); // fallback
    }

    // åªåè®¸å host
    if (strtolower($resolved-&gt;getAsciiHost() ?? '') !== strtolower($base-&gt;getAsciiHost() ?? '')) {
        return $base-&gt;toAsciiString();
    }

    // åªåè®¸ http/https
    if (!in_array($resolved-&gt;getScheme(), ['http', 'https'], true)) {
        return $base-&gt;toAsciiString();
    }

    return $resolved-&gt;toAsciiString();
}

echo safeRedirectTarget("/dashboard", "https://app.example.com");
</code></pre>
<p>è¿éç¨å°äº base URL è§£æåå¼ç¨è§£æåè½ã</p>
<h3 id="ç¨ä¾è§è-urlseo-åç¼å­çä¸è´è¡¨ç¤º">ç¨ä¾ï¼è§è URLï¼SEO åç¼å­çä¸è´è¡¨ç¤ºï¼</h3>
<p>è§èåéå¸¸æå³çï¼</p>
<ul>
<li>scheme/host å°å</li>
<li>ç§»é¤ path ä¸­çç¹å·æ®µ</li>
<li>ç§»é¤é»è®¤ç«¯å£</li>
<li>query ä¿æä¸è´ï¼ææ¶æåºï¼</li>
<li>å³å®å¦ä½å¤çæ«å°¾ææ </li>
</ul>
<p>ä½¿ç¨ <code>Uri\Rfc3986\Uri</code>ï¼ä½ å·²ç»å¯ä»¥éè¿ <code>get*()</code> vs <code>getRaw*()</code>ï¼ä»¥å <code>toString()</code> vs <code>toRawString()</code>ï¼æ¸æ°å°è·å¾è§èåè¡ä¸ºã</p>
<p>ä¸ä¸ªç®åçè§èåç¤ºä¾ï¼</p>
<pre><code class="language-php">use Uri\Rfc3986\Uri;

function canonicalizeForCache(Uri $uri): Uri
{
    // ä»è§èåè§£ç çé¨åå¼å§
    $uri = $uri
        -&gt;withScheme($uri-&gt;getScheme())
        -&gt;withHost($uri-&gt;getHost())
        -&gt;withPath($uri-&gt;getPath());

    // ä¸ºç¼å­ key æåº query åæ°ï¼è¿æ¯ä¸ç§ç­ç¥éæ©ï¼
    $query = $uri-&gt;getQuery();
    if ($query) {
        parse_str($query, $params);
        ksort($params);
        $sorted = http_build_query($params, '', '&amp;', PHP_QUERY_RFC3986);
        $uri = $uri-&gt;withQuery($sorted);
    }

    return $uri;
}

$u = new Uri("HTTPS://EXAMPLE.COM/foo/../bar/?b=2&amp;a=1");
echo canonicalizeForCache($u)-&gt;toString();
</code></pre>
<p>è¿ä¸ªå½æ°ä¸è¯å¾è¦çææè§èåç­ç¥ï¼é£æ¯åºç¨å±é¢çäºï¼ï¼ä½ç»æå API çå¥½å¤æ¯ï¼è§åå¯ä»¥æ¾å¼æå»ºãå¯ä»¥æµè¯ã</p>
<h2 id="ä»-parse_url--å­ç¬¦ä¸²æ¼æ¥è¿ç§»ä¸çè¦">ä» parse_url() + å­ç¬¦ä¸²æ¼æ¥è¿ç§»ï¼ä¸çè¦ï¼</h2>
<p>ä½ ä¸éè¦ä¸æ¬¡æ§éåææä»£ç ãæç®åçè¿ç§»è·¯å¾æ¯ï¼</p>
<p><strong>1. æ¾åº URL å¤çå¯¹å®å¨æææå®¹æåº bug çå°æ¹ï¼</strong></p>
<ul>
<li>éå®å</li>
<li>webhook éªè¯</li>
<li>ç­¾å URL</li>
<li>ååç½åå</li>
<li>è·¯ç±/ç¼å­ key</li>
</ul>
<p><strong>2. åæ¿æ¢è¿äºã</strong></p>
<p><strong>3. çº¯å±ç¤ºç¨éçç®åè§£æï¼ç­å°æå¿è¦æ¶åå¤çã</strong></p>
<h3 id="è¿ç§»åæ°ç»è§£æ--æå¨éå»º">è¿ç§»åï¼æ°ç»è§£æ + æå¨éå»º</h3>
<pre><code class="language-php">$parts = parse_url($input);
$host  = $parts['host'] ?? null;

if ($host !== 'example.com') {
    throw new Exception("Bad host");
}

$newUrl = $parts['scheme'] . '://' . $parts['host'] . '/new-path';
</code></pre>
<p>é®é¢ï¼</p>
<ul>
<li>æ²¡å¤ç portãuserinfoãfragmentãç¸å¯¹ URL</li>
<li>æ²¡æè§èå</li>
<li>æ²¡æè§èåéæ©</li>
<li>å®¹ææå»ºåºæ æè¾åº</li>
</ul>
<h3 id="è¿ç§»åä½¿ç¨-urluriæ¹å¨å±é¨å">è¿ç§»åï¼ä½¿ç¨ Url/Uriï¼æ¹å¨å±é¨å</h3>
<pre><code class="language-php">use Uri\WhatWg\Url;

$url = new Url($input);

if (strtolower($url-&gt;getAsciiHost() ?? '') !== 'example.com') {
    throw new InvalidArgumentException("Bad host");
}

$new = $url-&gt;withPath('/new-path');
echo $new-&gt;toAsciiString();
</code></pre>
<p>ä»£ç æ´ç­ï¼æå¾æ´æç¡®ï¼ç»èä¸æ´é¾åºéã</p>
<h3 id="rfc-3986-å-whatwg-æä¹éç»éªæ³å">RFC 3986 å WHATWG æä¹éï¼ç»éªæ³åï¼</h3>
<p><strong>ä½¿ç¨ <code>Uri\WhatWg\Url</code> å½ï¼</strong></p>
<ul>
<li>ä½ å¨å¤çæ¥èªæµè§å¨/ç¨æ·ç HTTP(S) URL</li>
<li>ä½ éè¦ IDNA/Unicode ååå¤çï¼<code>getUnicodeHost()</code> ç¨äºå±ç¤ºï¼<code>getAsciiHost()</code> ç¨äºæ¯è¾ï¼</li>
<li>ä½ æ³è¦ WHATWG è§£æè¡ä¸ºåéè¯¯æ¥åï¼è½¯éè¯¯ï¼</li>
</ul>
<p><strong>ä½¿ç¨ <code>Uri\Rfc3986\Uri</code> å½ï¼</strong></p>
<ul>
<li>ä½ å¨å¤ç"Web URL"ä¹å¤çéç¨ URI</li>
<li>ä½ éè¦ raw vs è§èåè§£ç çè¡¨ç¤º</li>
<li>ä½ å¨åç­¾åæåè®®å±é¢çå·¥ä½ï¼è¡¨ç¤ºå½¢å¼å¾éè¦</li>
</ul>
<p>RFC æç¡®åºåäºè¿ä¸¤ç§æ¹æ³ï¼åæ¬ Unicode/IDNA æ¯æçå·®å¼ã</p>
<h2 id="éå åå®¹æ­£ç¡®æ¯è¾-urlequals-ä»¥åä¸ºä»ä¹æ²¡æ-__tostring">éå åå®¹ï¼æ­£ç¡®æ¯è¾ URLï¼equals() ä»¥åä¸ºä»ä¹æ²¡æ __toString()ï¼</h2>
<p>ä¸ä¸ªå¼å¾çæçè®¾è®¡ï¼åç½® URI ç±»ææä¸å®ç° <code>__toString()</code>ï¼å ä¸ºæ¾æ£æ¯è¾ï¼<code>==</code>ï¼å®¹æåºéã</p>
<p>åèä»£ä¹ï¼ä½ ç¨ <code>equals()</code> æ¯è¾ï¼</p>
<pre><code class="language-php">use Uri\Rfc3986\Uri;
use Uri\UriComparisonMode;

$u1 = new Uri("https://example.COM#foo");
$u2 = new Uri("https://EXAMPLE.COM");

var_dump($u1-&gt;equals($u2)); // true
var_dump($u1-&gt;equals($u2, UriComparisonMode::IncludeFragment)); // false
</code></pre>
<p>WHATWG ç±»ä¼¼ï¼</p>
<pre><code class="language-php">use Uri\WhatWg\Url;
use Uri\UriComparisonMode;

$a = new Url("https:////example.COM/");
$b = new Url("https://EXAMPLE.COM");

var_dump($a-&gt;equals($b)); // true
</code></pre>
<h2 id="ç»è®º">ç»è®º</h2>
<p>PHP 8.5 ç URI æ©å±çèµ·æ¥æ¯ä¸ªå°åè½ï¼ç¨ä¸æ®µæ¶é´åæä¼åç°å®æ¡æäºå¤å°ç»å¾®ç URL bugã</p>
<p>æ ¸å¿ä»·å¼å¨äº<strong>æ§å¶</strong>ï¼</p>
<ul>
<li>ä½ å¯ä»¥éæ© RFC 3986 vs WHATWG è¯­ä¹ã</li>
<li>ä½ å¯ä»¥å³å®è¦ raw è¿æ¯è§èåè§£ç çè¡¨ç¤ºã</li>
<li>ä½ å¯ä»¥ä¸å¯åä¸å®å¨å°ä¿®æ¹ç»ä»¶ã</li>
<li>ä½ å¯ä»¥ç¨æ´é¾æå¤åå¼±çæ¹å¼éªè¯åæ¯è¾ URLã</li>
</ul>
<p>å¦æä½ æ¾ç»åå¸è¿ä¸ä¸ª"å¿«é URL ä¿®å¤"ï¼åæ¥å¨å®å¨æ¥åæçäº§äºæä¸­çå°å®ï¼è¿ä¸ªæ©å±å¼å¾å°½æ©éç¨ââä»éå®ååç­¾å URL å¼å§ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-16 07:49">2026-01-16 07:48</span>&nbsp;
<a href="https://www.cnblogs.com/catchadmin">JaguarJack</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19490082);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19490082', targetLink: 'https://www.cnblogs.com/catchadmin/p/19490082', title: 'å«åæå URL è§£æå¨äºï¼PHP 8.5 URI æ©å±è®© URL å¤çæ´å®å¨ãæ´å¹²å' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ MySQLæ§è½ä¼åï¼ä»åºå±åçå°å®æè½å°çå¨ç»´åº¦æ¹æ¡ ]]></title>
    <link>https://www.cnblogs.com/liuziyi1/p/19489439</link>
    <guid>6ceda45f298be5e4e58d39ad836dd8a8</guid>
    <description>
    <![CDATA[ 
		<h2>
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/liuziyi1/p/19489439" title="åå¸äº 2026-01-15 22:26">
    <span role="heading" aria-level="2">MySQLæ§è½ä¼åï¼ä»åºå±åçå°å®æè½å°çå¨ç»´åº¦æ¹æ¡</span>
    

</a>

		</h2>
		<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>å¨æ°æ®é©±å¨çä¸å¡åºæ¯ä¸­ï¼MySQLä½ä¸ºä¸»æµå¼æºå³ç³»åæ°æ®åºï¼å¶æ§è½ç´æ¥å³å®ç³»ç»ååºéåº¦ãååéä¸è¿ç»´ææ¬ãå°¤å¶å¯¹äºé«å¹¶åãå¤§æ°æ®éçå¹³å°ï¼å¦DeepSeekè¿ç±»AIæå¡åºæ¯ï¼ï¼æ¢æ¥è¯¢ä¸ä¸åçç´¢å¼è®¾è®¡å¯è½å¼åç³»ç»å¡é¡¿çè³éªå´©ãMySQLæ§è½ä¼åå¹¶éé¶æ£çâè°åæ¹SQLâï¼èæ¯åºäºåºå±åççç³»ç»æ§å·¥ç¨ââæ¢è¦ææ¡å¯è½å°çå®ææå·§ï¼æ´è¦çè§£ä¼åèåçæ ¸å¿é»è¾ï¼æè½å®ç°ä»âæ²»æ âå°âæ²»æ¬âççªç ´ãæ¬æå°èååºå±çè®ºä¸å®æç»éªï¼æå»ºâåçè®¤ç¥-é®é¢å®ä½-ä¼åå®æ½-å·¥ç¨ä¿éâçå®æ´ä½ç³»ï¼å©åå¼åèå®ç°MySQLæ§è½çç²¾åæåã</p>
<h1 id="-ä¸åºå±é»è¾mysqlæ§è½çæ ¸å¿æ¯æä¸å¤±è¡¡æ¬è´¨"># ä¸ãåºå±é»è¾ï¼MySQLæ§è½çæ ¸å¿æ¯æä¸å¤±è¡¡æ¬è´¨</h1>
<p>MySQLæ§è½çåºå±æ ¸å¿æ¯âèµæºæ¶èä¸ç»æè®¾è®¡çå¹³è¡¡âï¼æææ¢æ¥è¯¢ä¸æ§è½ç¶é¢ï¼æ¬è´¨é½æ¯å­å¨ç»æãèµæºåéææ§è¡é»è¾åºç°äºå¤±è¡¡ã</p>
<h2 id="-11-å­å¨å¼ææ ¸å¿bæ ä¸ç£çioçåºå±å³è">## 1.1 å­å¨å¼ææ ¸å¿ï¼B+æ ä¸ç£çIOçåºå±å³è</h2>
<p>InnoDBä½ä¸ºMySQLé»è®¤å­å¨å¼æï¼å¶æ ¸å¿å­å¨ç»æä¸ºB+æ ï¼æ§è½ä¼å£ç´æ¥ç±âç£çIOæ¬¡æ°âå³å®ãB+æ çè®¾è®¡ç¹æ§å³å®äºæ¥è¯¢æççä¸éï¼</p>
<ul>
<li>
<p>- ç»æç¹æ§ï¼B+æ ä¸ºå¹³è¡¡æ ï¼å¶å­èç¹å­å¨å¨éæ°æ®ï¼éå¶å­èç¹ä»å­å¨ç´¢å¼é®ä¸æéï¼åé¡µå¤§å°é»è®¤16KBï¼é«åº¦éå¸¸ä¸º1-3å±ï¼é«åº¦3çB+æ å¯å­å¨çº¦2000ä¸è¡æ°æ®ã</p>
</li>
<li>
<p>- IOææ¬ï¼æ¯æ¬¡æ¥è¯¢çIOæ¬¡æ°=B+æ é«åº¦+åè¡¨æ¬¡æ°ï¼éè¦çç´¢å¼åºæ¯ï¼ãå¨è¡¨æ«æééåææå¶å­èç¹ï¼IOæ¬¡æ°é£åè³ç¾ä¸çº§ï¼æ¯æ¢æ¥è¯¢çæ ¸å¿è¯±å ã</p>
</li>
<li>
<p>- ç¼å­ä»·å¼ï¼InnoDBç¼å²æ± ï¼innodb_buffer_poolï¼å¯ç¼å­æ°æ®é¡µä¸ç´¢å¼é¡µï¼å½ä¸­ççæ³å¼éè¶è¿99%ï¼ç¼å­å½ä¸­å¯ç´æ¥é¿åç£çIOï¼å¤§å¹æåæ¥è¯¢éåº¦ã</p>
</li>
</ul>
<h2 id="-12-æ§è½æ ¸å¿ç»´åº¦åå¤§èµæºçæ¶èå¹³è¡¡">## 1.2 æ§è½æ ¸å¿ç»´åº¦ï¼åå¤§èµæºçæ¶èå¹³è¡¡</h2>
<p>MySQLæ§è½ç¶é¢æç»å¯å½ç»ä¸ºCPUãç£çIOãåå­ãéåå¤§èµæºçæ¶èå¤±è¡¡ï¼å¶ä¸­ç£çIOå æ¯æé«ï¼æ¯ä¼åçæ ¸å¿é¶ç¹ï¼</p>
<ul>
<li>
<p>- CPUï¼ç¨äºSQLè§£æãæåºãåç»ãå½æ°è®¡ç®ç­æä½ï¼ä½ææåºä¸å¤æè®¡ç®æå¯¼è´CPUè¿è½½ã</p>
</li>
<li>
<p>- ç£çIOï¼æ°æ®é¡µ/ç´¢å¼é¡µçè¯»åä¸åå¥ï¼å¨è¡¨æ«æãç´¢å¼å¤±ææ¯IOæ¶èæ¿å¢çä¸»è¦åå ã</p>
</li>
<li>
<p>- åå­ï¼ç¼å²æ± ç¼å­æ°æ®é¡µï¼åå­ä¸è¶³ä¼å¯¼è´ç¼å­å½ä¸­çä¸éï¼è¢«è¿«é¢ç¹è¯»åç£çã</p>
</li>
<li>
<p>- éï¼è¡é/è¡¨éå¼åçæ¥è¯¢ç­å¾ï¼å¦æ´æ°æä½é»å¡æ¥è¯¢ãé«å¹¶åä¸çéç«äºï¼ä¼é´æ¥æé¿æ¥è¯¢èæ¶ã</p>
</li>
</ul>
<h2 id="-13-æ¢æ¥è¯¢çæ¬è´¨æ§è¡é»è¾ä¸èµæºæ¶èçåéå¤±è¡¡">## 1.3 æ¢æ¥è¯¢çæ¬è´¨ï¼æ§è¡é»è¾ä¸èµæºæ¶èçåéå¤±è¡¡</h2>
<p>æ¢æ¥è¯¢å¹¶éâæ§è¡æ¶é´é¿âçè¡¨é¢ç°è±¡ï¼èæ¯åºå±æ§è¡é»è¾ä¸èµæºæ¶èçåéé®é¢ï¼ä¸æ¯æ§è¡è®¡åä¸åçï¼å¦å¨è¡¨æ«æãç´¢å¼å¤±æï¼ï¼å¯¼è´IOæ¬¡æ°è¿å¤ï¼äºæ¯èµæºç«äºï¼å¦éç­å¾ãç¼å­å¤±æï¼ï¼å¯¼è´æææ§è¡æ¶é´è¢«æé¿ãä¼åæ¢æ¥è¯¢ï¼æ¬è´¨å°±æ¯ä¼åæ§è¡è®¡åãåå°èµæºæ¶èãåè§£èµæºç«äºã</p>
<h1 id="-äºé®é¢å®ä½ä»æ¢æ¥è¯¢ææå°æ§è¡è®¡åè§£æ"># äºãé®é¢å®ä½ï¼ä»æ¢æ¥è¯¢ææå°æ§è¡è®¡åè§£æ</h1>
<p>ç²¾åå®ä½é®é¢æ¯ä¼åçåæï¼æ ¸å¿ä¾èµâæ¢æ¥è¯¢æ¥å¿ææ+æ§è¡è®¡ååæâï¼å®ç°ä»âåç°é®é¢âå°âå®ä½æ ¹æºâçé­ç¯ã</p>
<h2 id="-21-æ¢æ¥è¯¢æ¥å¿æ§è½ç¶é¢çç¬¬ä¸éææ">## 2.1 æ¢æ¥è¯¢æ¥å¿ï¼æ§è½ç¶é¢çç¬¬ä¸éææ</h2>
<p>æ¢æ¥è¯¢æ¥å¿æ¯è®°å½ä½æSQLçæ ¸å¿å·¥å·ï¼éåçéç½®éå¼ä¸å­å¨è·¯å¾ï¼ç¡®ä¿ç²¾åææå³é®é®é¢SQLã</p>
<h3 id="-211-æ¥å¿éç½®ä¸´æ¶çææ°¸ä¹åºå">### 2.1.1 æ¥å¿éç½®ï¼ä¸´æ¶çæ+æ°¸ä¹åºåï¼</h3>
<p>ä¸´æ¶éç½®ï¼éå¯MySQLåå¤±æï¼éç¨äºå¿«éææ¥ï¼ï¼</p>
<pre><code class="language-sql">-- è®¾ç½®æ¢æ¥è¯¢éå¼ï¼åä½ï¼ç§ï¼çäº§ç¯å¢å»ºè®®0.5-1ç§ï¼å¹³è¡¡çµæåº¦ä¸æ¥å¿éï¼
SET GLOBAL long_query_time = 0.5; 
-- å¼å¯æ¢æ¥è¯¢æ¥å¿
SET GLOBAL slow_query_log = 'ON';
-- æå®æ¥å¿æä»¶è·¯å¾ï¼éç¡®ä¿MySQLæåå¥æéï¼
SET GLOBAL slow_query_log_file = '/var/log/mysql/slow.log';
-- è®°å½æªä½¿ç¨ç´¢å¼çæ¥è¯¢ï¼è¾å©å®ä½ç´¢å¼å¤±æåºæ¯ï¼
SET GLOBAL log_queries_not_using_indexes = 'ON';
</code></pre>
<p>æ°¸ä¹éç½®ï¼ä¿®æ¹my.cnfæä»¶ï¼éå¯åçæï¼éç¨äºçäº§ç¯å¢å¸¸æåçæ§ï¼ï¼</p>
<pre><code class="language-ini">[mysqld]
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 0.5
log_queries_not_using_indexes = 1
</code></pre>
<h3 id="-212-æ¥å¿åæå·¥å·æåæ ¸å¿é®é¢sql">### 2.1.2 æ¥å¿åæå·¥å·ï¼æåæ ¸å¿é®é¢SQL</h3>
<p>æ¢æ¥è¯¢æ¥å¿ééè¿å·¥å·è§£æï¼æè½å¿«éå®ä½é«é¢ãé«èçæ ¸å¿SQLï¼å¸¸ç¨å·¥å·åä¸ºä¸¤ç±»ï¼</p>
<ul>
<li>
<p>- pt-query-digestï¼Percona Toolkitï¼ï¼åæç»´åº¦æå¨é¢ï¼æ¯æè¾åºæ§è¡æ¬¡æ°ãå¹³åèæ¶ãæ«æè¡æ°ãéç­å¾æ¶é´ç­ææ ï¼éåå¤æåºæ¯ï¼ <code>pt-query-digest /var/log/mysql/slow.log &gt; slow_report.txt</code></p>
</li>
<li>
<p>- mysqldumpslowï¼MySQLèªå¸¦å·¥å·ï¼ï¼è½»éä¾¿æ·ï¼éåå¿«éæåTopNæ¢æ¥è¯¢ï¼ <code>-- æåèæ¶æå¤ç10æ¡SELECTè¯­å¥</code> <code>mysqldumpslow -s t -t 10 -g 'select' /var/log/mysql/slow.log</code></p>
</li>
</ul>
<p>åææ¥åééç¹å³æ³¨âæ§è¡æ¬¡æ°å¤+å¹³åèæ¶é¿ââæ«æè¡æ°å¤ââéç­å¾æ¶é´é¿âä¸ç±»SQLï¼è¿ç±»SQLå¯¹æ´ä½æ§è½å½±åæå¤§ï¼ä¼åçº³å¥ä¼åæ¸åã</p>
<h2 id="-22-explainæ§è¡è®¡åè¯»æmysqlçæ§è¡é»è¾">## 2.2 EXPLAINæ§è¡è®¡åï¼è¯»æMySQLçæ§è¡é»è¾</h2>
<p>ææå°æ¢æ¥è¯¢åï¼ééè¿EXPLAINå³é®å­åææ§è¡è®¡åï¼å¤æ­ç´¢å¼æ¯å¦çæãæ¥è¯¢æ¯å¦å­å¨ä½ææä½ï¼æ ¸å¿æ¯è¯»æMySQLçâæ§è¡æè·¯âã</p>
<h3 id="-221-æ ¸å¿å­æ®µè§£è¯»">### 2.2.1 æ ¸å¿å­æ®µè§£è¯»</h3>
<p>æ§è¡<code>EXPLAIN SELECT * FROM orders WHERE user_id = 100 AND status = 'PAID';</code>åï¼éç¹å³æ³¨ä»¥ä¸å­æ®µï¼</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>å­æ®µ</td>
<td>æ ¸å¿æä¹</td>
<td>ä¼åå¤æ­æ å</td>
</tr>
<tr>
<td>type</td>
<td>è®¿é®ç±»åï¼åæ æ¥è¯¢æç</td>
<td>ä»ä¼å°å£ï¼system &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; ALLï¼éé¿åALLï¼å¨è¡¨æ«æï¼</td>
</tr>
<tr>
<td>key</td>
<td>å®éä½¿ç¨çç´¢å¼</td>
<td>NULLè¡¨ç¤ºæªä½¿ç¨ç´¢å¼ï¼éææ¥ç´¢å¼å¤±æåå </td>
</tr>
<tr>
<td>rows</td>
<td>é¢ä¼°æ«æè¡æ°</td>
<td>æ°å¼è¶å¤§ï¼IOæ¶èè¶é«ï¼ééè¿ç´¢å¼ç¼©å°èå´</td>
</tr>
<tr>
<td>Extra</td>
<td>éå æ§è¡ä¿¡æ¯</td>
<td>Using filesort/Using temporaryéä¼åï¼Using indexä¸ºçæ³ç¶æï¼è¦çç´¢å¼ï¼</td>
</tr>
</tbody>
</table>
<h3 id="-222-å³é®å¤æ­é»è¾">### 2.2.2 å³é®å¤æ­é»è¾</h3>
<p>éè¿æ§è¡è®¡åå¯å¿«éå®ä½æ ¸å¿é®é¢ï¼è¥typeä¸ºALLï¼å¨è¡¨æ«æï¼ï¼ä¼åææ¥ç´¢å¼æ¯å¦ç¼ºå¤±æå¤±æï¼è¥Extraåºç°Using filesortï¼è¯´ææåºæªä½¿ç¨ç´¢å¼ï¼éä¼åæåºå­æ®µï¼è¥rowsè¿å¤§äºå®éè¿åè¡æ°ï¼è¯´æç´¢å¼éæ©æ§å·®ï¼éè°æ´ç´¢å¼è®¾è®¡ã</p>
<h1 id="-ä¸æ ¸å¿ä¼åç´¢å¼è®¾è®¡ä¸å¤±æè§é¿çå®ææå"># ä¸ãæ ¸å¿ä¼åï¼ç´¢å¼è®¾è®¡ä¸å¤±æè§é¿çå®ææå</h1>
<p>ç´¢å¼æ¯MySQLæ§è½ä¼åçæ ¸å¿ææ®µï¼å¶æ¬è´¨æ¯âåºäºB+æ çæåºæ°æ®ç»æâï¼ç®çæ¯åå°ç£çIOæ¬¡æ°ãä¼åç´¢å¼éåæ¶å¼é¡¾âè®¾è®¡åçæ§âä¸âé¿åå¤±æâï¼éµå¾ªåºå±é»è¾ä¸å®æååã</p>
<h2 id="-31-ç´¢å¼è®¾è®¡çä¸å¤§æ ¸å¿åå">## 3.1 ç´¢å¼è®¾è®¡çä¸å¤§æ ¸å¿åå</h2>
<p>ç´¢å¼è®¾è®¡å¹¶éâè¶å¤è¶å¥½âï¼èæ¯è¦å¨âæ¥è¯¢æçâä¸âç»´æ¤ææ¬âä¹é´æ¾å°å¹³è¡¡ï¼æ ¸å¿éµå¾ªä¸å¤§ååï¼</p>
<h3 id="-311-éæ©æ§ä¼ååå">### 3.1.1 éæ©æ§ä¼ååå</h3>
<p>ç´¢å¼éæ©æ§=å¯ä¸å¼æ°é/æ»è¡æ°ï¼éæ©æ§è¶é«ï¼ç´¢å¼å®ä½ç²¾åº¦è¶å¼ºï¼IOæ¬¡æ°è¶å°ãè®¾è®¡æ¶éå°é«éæ©æ§å­æ®µï¼å¦ç¨æ·IDãè®¢åå·ï¼æ¾å¨èåç´¢å¼ååï¼ä½éæ©æ§å­æ®µï¼å¦æ§å«ãç¶æï¼éæ©æ§&lt;0.1ï¼å°½éä¸åç¬å»ºç´¢å¼ï¼é¿åä¼åå¨æ¾å¼ä½¿ç¨ã</p>
<h3 id="-312-ä¸æç´¢å¼ååå®ææ ¸å¿">### 3.1.2 ä¸æç´¢å¼ååï¼å®ææ ¸å¿ï¼</h3>
<p>ä¸æç´¢å¼æ¯çæ³çç´¢å¼è®¾è®¡æ åï¼å¯æå¤§ååå°IOä¸è®¡ç®æ¶èï¼</p>
<ul>
<li>
<p>- ä¸æï¼WHEREæ¡ä»¶åçº³å¥ç´¢å¼ï¼ç¼©å°æ«æèå´ï¼</p>
</li>
<li>
<p>- äºæï¼ORDER BY/GROUP BYåçº³å¥ç´¢å¼ï¼å©ç¨ç´¢å¼æåºæ§é¿åæåºï¼Using filesortï¼ï¼</p>
</li>
<li>
<p>- ä¸æï¼SELECTæ¥è¯¢åè¢«ç´¢å¼è¦çï¼é¿ååè¡¨æä½ï¼Extraæ¾ç¤ºUsing indexï¼ã</p>
</li>
</ul>
<p>ç¤ºä¾ï¼æ¥è¯¢<code>SELECT user_id, username FROM users WHERE email = 'user@deepseek.com';</code>ï¼è®¾è®¡è¦çç´¢å¼<code>ALTER TABLE users ADD INDEX idx_email_cover (email, user_id, username);</code>ï¼å¯å®ç°æ åè¡¨ãæ æåºçé«ææ¥è¯¢ã</p>
<h3 id="-313-æå°ç»´æ¤ææ¬åå">### 3.1.3 æå°ç»´æ¤ææ¬åå</h3>
<p>ç´¢å¼ä¼å¢å æå¥ãæ´æ°ãå é¤æä½çç»´æ¤ææ¬ï¼éè°æ´B+æ ç»æï¼ï¼è®¾è®¡æ¶éï¼</p>
<ul>
<li>
<p>- æ§å¶åè¡¨ç´¢å¼æ°å¨5ä¸ªä»¥åï¼é¿ååä½ç´¢å¼ï¼å¦å·²æ(a,b)èåç´¢å¼ï¼åç¬aç´¢å¼ä¸ºåä½ï¼ï¼</p>
</li>
<li>
<p>- å¤§ææ¬ãBlobå­æ®µä¸å»ºç´¢å¼ï¼é¿åç´¢å¼ä½ç§¯è¿å¤§ï¼</p>
</li>
<li>
<p>- èåç´¢å¼éè¦çé«é¢æ¥è¯¢åºæ¯ï¼åå°éå¤ç´¢å¼ã</p>
</li>
</ul>
<h3 id="-314-èåç´¢å¼çå­æ®µé¡ºåºæå·§">### 3.1.4 èåç´¢å¼çå­æ®µé¡ºåºæå·§</h3>
<p>èåç´¢å¼éµå¾ªâæå·¦åç¼ååâï¼æ¬è´¨æ¯åºäºB+æ çæåºå­å¨ç¹æ§ï¼è®¾è®¡æ¶ééµå¾ªï¼</p>
<ul>
<li>
<p>- ç­å¼æ¥è¯¢å­æ®µå¨åï¼èå´æ¥è¯¢å­æ®µå¨åï¼å¦(a,b)èåç´¢å¼ï¼a=1 AND b&gt;10å¯èµ°ç´¢å¼ï¼b&gt;10åä¸å¯ï¼ï¼</p>
</li>
<li>
<p>- é«é¢æ¥è¯¢å­æ®µå¨åï¼ä½é¢å­æ®µå¨åï¼ç¡®ä¿æ´å¤æ¥è¯¢è½å½ä¸­ç´¢å¼åç¼ã</p>
</li>
</ul>
<p>ç¤ºä¾ï¼æ¥è¯¢<code>SELECT * FROM sales WHERE region='Asia' AND category='Tech' AND sale_date BETWEEN '2023-01-01' AND '2023-12-31' ORDER BY revenue DESC;</code>ï¼æä¼èåç´¢å¼ä¸º<code>idx_region_category_date (region, category, sale_date)</code>ã</p>
<h2 id="-32-ç´¢å¼å¤±æçåå¤§å¸ååºæ¯ä¸è§£å³æ¹æ¡">## 3.2 ç´¢å¼å¤±æçåå¤§å¸ååºæ¯ä¸è§£å³æ¹æ¡</h2>
<p>ç´¢å¼å¤±ææ¯æ¢æ¥è¯¢çä¸»è¦è¯±å ï¼æ¬è´¨æ¯ç ´åäºB+æ çæåºæ§æå®ä½è§åï¼ä»¥ä¸æ¯å®æä¸­æå¸¸è§çåºæ¯åä¼åæ¹æ¡ï¼</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>å¤±æåºæ¯</td>
<td>éè¯¯ç¤ºä¾</td>
<td>ä¼åæ¹æ¡</td>
</tr>
<tr>
<td>ç´¢å¼ååä¸è®¡ç®/å½æ°</td>
<td>SELECT * FROM users WHERE YEAR(create_time) = 2023;</td>
<td>SELECT * FROM users WHERE create_time BETWEEN '2023-01-01' AND '2023-12-31';</td>
</tr>
<tr>
<td>éå¼ç±»åè½¬æ¢</td>
<td>SELECT * FROM logs WHERE user_id = '123'ï¼user_idä¸ºINTï¼;</td>
<td>SELECT * FROM logs WHERE user_id = 123ï¼å¹éå­æ®µç±»åï¼;</td>
</tr>
<tr>
<td>LIKEä»¥%å¼å¤´</td>
<td>SELECT * FROM user WHERE userId LIKE '%123';</td>
<td>æ¹ç¨è¦çç´¢å¼æLIKE '123%';</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

</div>
<div class="clear"></div>

		<p class="postfoot">
			posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-15 22:27">2026-01-15 22:26</span>&nbsp;
<a href="https://www.cnblogs.com/liuziyi1">åå­æ¯</a>&nbsp;
éè¯»(<span id="post_view_count">56</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19489439);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19489439', targetLink: 'https://www.cnblogs.com/liuziyi1/p/19489439', title: 'MySQLæ§è½ä¼åï¼ä»åºå±åçå°å®æè½å°çå¨ç»´åº¦æ¹æ¡' })">ä¸¾æ¥</a>

		</p>
	 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ CLAUDE.md å¨æ¹ä½æåï¼æå»ºé«æ AI å¼åä¸ä¸æ ]]></title>
    <link>https://www.cnblogs.com/didispace/p/19489098</link>
    <guid>2705f113ee0b5395fb6dd433a3bec336</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/didispace/p/19489098" title="åå¸äº 2026-01-15 20:09">
    <span role="heading" aria-level="2">CLAUDE.md å¨æ¹ä½æåï¼æå»ºé«æ AI å¼åä¸ä¸æ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>å¦æä½ æ¯ Claude çæ¥å¸¸ç¨æ·ï¼ä½ ä¸å®çæè¿ä¸ªåºæ¯ï¼æ¯æ¬¡å¼å¯ä¸ä¸ªæ°çå¯¹è¯ï¼é½å¿é¡»ä¸åå¶ç¦å°éå¤è®¾ç½®é¡¹ç®èæ¯ãç¼ç è§èåç¹å®çæä»¤ãè¿ä¸ä»èæ¶ï¼ä¹å®¹æåºéãå½ä½ å¿è®°æéæä¸ªå³é®ç»èæ¶ï¼å°±ä¸å¾ä¸è±æ´å¤æ¶é´å»ä¿®å¤é£äºä¸ç¬¦åè§èçä»£ç ã</p>
<p>CLAUDE.md æä»¶æ­£æ¯è§£å³è¿ä¸çç¹çå³é®ãå®å°±å Claude çé¡¹ç®ä¸å±è®°å¿ï¼è®© AI å¨æ¯æ¬¡å¯¹è¯å¼å§åèªå¨å è½½å¹¶è®°ä½ä½ çææåå¥½ãè¿æ¯ä¸ä¸ªç®åèå¼ºå¤§çåè½ï¼ä½å¤§å¤æ°ç¨æ·ä»ä»åçå¨åºç¡å±é¢ã</p>
<p>äºå®ä¸ï¼è¦çæ­£éæ¾ CLAUDE.md çå¨åï¼éè¦ææ¡ä¸äºæ´æ·±å»ãçè³æäºè¿åç´è§çæå·§ãæ¬æå°ä¸ºä½ æ­ç¤ºå¶ä¸­æå³é®çäºä¸ªï¼å¸®å©ä½ å°è¿ä¸ªç®åçéç½®æä»¶ï¼è½¬åä¸ºä¸ä¸ªè½å¤æç»­è¿åçé¡¹ç®ç¥è¯åºã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/626506/202601/626506-20260115200636481-1624630998.png" class="lazyload"></p>
<h2 id="1-ä½ ç-claudemd-åºè¯¥æ¯ä¸ä¸ªæ´»çææ¡£èä¸æ¯ä¸æ¬¡æ§éç½®">1. ä½ ç CLAUDE.md åºè¯¥æ¯ä¸ä¸ªâæ´»çææ¡£âï¼èä¸æ¯âä¸æ¬¡æ§éç½®â</h2>
<p>è®¸å¤äººè®¤ä¸º CLAUDE.md æä»¶åªéå¨é¡¹ç®å¼å§æ¶éç½®ä¸æ¬¡ï¼ç¶åå°±å¯ä»¥ç½®ä¹ä¸çãè¿æ¯ä¸ä¸ªå·¨å¤§çè¯¯åºãæææç CLAUDE.md åºè¯¥éçé¡¹ç®çæ¼è¿èæç»­æ´æ°åä¼åã</p>
<p>æä½³çç»´æ¤æ¹å¼æ¯å¨æ¥å¸¸å·¥ä½ä¸­âææºå°âæå»ºå®ãä¾å¦ï¼å½ Claude ååºäºä¸ä¸ªéè¦çº æ­£çåè®¾ââæ¯å¦å®å»ºè®®ä½¿ç¨ console.log è¿è¡è°è¯ï¼èä½ çå¢éè§èæ¯ä½¿ç¨ç¹å®çæ¥å¿åºââä¸è¦åªæ¯ä¸´æ¶ä¿®æ­£ãç´æ¥åè¯ Claudeï¼âå°âæ»æ¯ä½¿ç¨æ¥å¿åºèä¸æ¯ console.logâè¿æ¡è§åæ·»å å°æç CLAUDE.md æä»¶ä¸­ãâ è¿æ ·ï¼ä½ çä¿®æ­£å°±ä¼æ²æ·ä¸æ¥ï¼å¨æªæ¥çææä¼è¯ä¸­çæãå¼å¾æ³¨æçæ¯ï¼æ©æçæ¬ç Claude æä¸ä¸ª # å¿«æ·é®æ¥æ·»å æä»¤ï¼ä½å¨ 2.0.70 çæ¬åå·²è¢«ç§»é¤ãç®åï¼ç´æ¥è¯·æ± Claude è¿è¡ä¿®æ¹æ¯å®æ¹æ¨èçæä½³å®è·µã</p>
<p>è¿ç§åæ³çä»·å¼å¨äºï¼å®è½å®æ¶ææå¹¶åºåå·¥ä½æµç¨ä¸­çéæ§ç¥è¯ãæ­£å¦ä¸ä¸ªç²¾å¦çæ¯å»æè¯´ï¼</p>
<p>è¿å°±åå¨ä¼è®®ä¸­åç¬è®°ï¼ä¸åçæ¯ï¼è¿äºç¬è®°ççä¼è¢«ä½¿ç¨ã</p>
<p>æ´é«çº§çç»´æ¤æ¹æ³æ¯å°å¶ä¸å¢éåä½æµç¨ç»åãå¨ä»£ç å®¡æ¥ï¼Code Reviewï¼ä¸­åç°çæªè¢«ææ¡£åçè§èï¼æ­£æ¯æ´æ° CLAUDE.md çç»ä½³æ¶æºãä¸ä¸ªç± Boris Cherny åäº«çé«æå·¥ä½æµæ¯ï¼éè¿ GitHub Actionï¼ä½ çè³å¯ä»¥ç´æ¥å¨ PR è¯è®ºä¸­ @claudeï¼è®©å®å°æ°è§èæ·»å å° CLAUDE.md æä»¶ä¸­ãè¿åå»ºäºä¸ä¸ªå¼ºå¤§çåé¦å¾ªç¯ï¼å°å¢éçéä½æºæ§æºæºä¸æ­å°æ²æ·å°è¿ä¸ªæ ¸å¿æä»¶ä¸­ã</p>
<h2 id="2-å°å³æ¯å¤ä¸ä¸ææ¯å®è´µèµæºç²¾ç®è³ä¸">2. å°å³æ¯å¤ï¼ä¸ä¸ææ¯å®è´µèµæºï¼ç²¾ç®è³ä¸</h2>
<p>äººä»¬æ®éè®¤ä¸ºï¼æä¾ç» AI çä¸ä¸æè¶å¤ï¼ç»æå°±è¶å¥½ãç¶èå¨ä½¿ç¨ CLAUDE.md æ¶ï¼è¿ä¸ªç´è§å¯è½æ¯éè¯¯çã</p>
<p>æ ¸å¿è®ºç¹æ¯ï¼âä¸ä¸ææ¯å®è´µçï¼Context is preciousï¼âãCLAUDE.md ä¸­çæ¯ä¸è¡åå®¹ï¼é½å¨ä¸ä½ å½åçå·¥ä½æä»¤ç«äº AI çæ³¨æåãä¸ä¸ªèè¿ãåæ»¡åä½ä¿¡æ¯çæä»¶ï¼åèå¯è½ç¨éææå³é®çæä»¤ï¼å¯¼è´ AI æä¸ä½éç¹ã<br>
å æ­¤ï¼ç²¾ç®è³ä¸ãä¸ä¸ªå¾å¥½çèµ·ç¹æ¯ä½¿ç¨ /init å½ä»¤ï¼å®ä¼æ ¹æ®ä½ çé¡¹ç®ç»æåææ¯æ çæä¸ä¸ªåå§æä»¶ãæçå»ºè®®æ¯ï¼ä»¥æ­¤ä¸ºåºç¡ï¼ç¶åå é¤ææä½ ä¸éè¦çåå®¹ãä»ç°æåå®¹ä¸­å é¤æ¯ä»é¶å¼å§åå»ºè¦å®¹æå¾å¤ã</p>
<p>ä¸è¬å»ºè®®å°æä»¶é¿åº¦ä¿æå¨ 300 è¡ä»¥ä¸ãå½ç¶ï¼è¿å¹¶éç¡¬æ§è§å®ãå¯¹äºä¸äºå·æå¤æçº¦å®æéå¯»å¸¸æ¨¡å¼ç codebaseï¼ä¸ä¸ªæ´é¿ç CLAUDE.md åèè½éè¿é¢åå è½½è¶³å¤çä¸ä¸æï¼ææé²æ­¢ Claude ååºéè¯¯åè®¾ãå³é®å¨äºï¼æä»¶ä¸­çæ¯ä¸è¡é½åºè¯¥æå¶æç¡®çä»·å¼ãæ¯«ä¸çæå°å é¤é£äºæ¾èæè§çåºè¯ï¼ä¾å¦âè¯·ç¼åé«è´¨éä»£ç âï¼ææ²¡æå®éæå¯¼æä¹çâå¡«åâä¿¡æ¯ã</p>
<p>ç²¾ç®ç CLAUDE.md è¿«ä½¿ä½ ä»ç»æèå¹¶åªä¿çæéè¦çæä»¤ãè¿ä¸ä»è½èçå®è´µçä¸ä¸æç©ºé´ï¼æ´è½ç¡®ä¿ AI å¨å¤çä½ çè¯·æ±æ¶ï¼è½å¤æ´åç¡®å°èç¦äºæ ¸å¿è¦æ±ï¼èä¸æ¯å¨å¤§éæ å³ä¿¡æ¯ä¸­è¿·å¤±æ¹åã</p>
<h2 id="3-è¶è¶åä¸ªæä»¶ç¨æ¨¡ååç»æç®¡çå¤ææ§">3. è¶è¶åä¸ªæä»¶ï¼ç¨æ¨¡ååç»æç®¡çå¤ææ§</h2>
<p>è®¸å¤ç¨æ·åªç¥éå¨é¡¹ç®æ ¹ç®å½ä¸åå»ºä¸ä¸ª CLAUDE.md æä»¶ãè¿å¯¹äºå°åé¡¹ç®æ¥è¯´è¶³å¤äºï¼ä½å¯¹äºå¤§åæç»æå¤æçé¡¹ç®ï¼å­å¨çæ´ä¼éãæ´å¼ºå¤§çæ¨¡ååç®¡çæ¹å¼ã</p>
<ul>
<li>@imports è¯­æ³ ä½ å¯ä»¥ä½¿ç¨ @path/to/file è¯­æ³ï¼ä»ä¸» CLAUDE.md æä»¶ä¸­å¼ç¨å¶ä»æä»¶çåå®¹ãè¿è½è®©ä¸»æä»¶ä¿æç®æ´ï¼åæ¶å°è¯¦ç»çè§èæåå°ç¬ç«çææ¡£ä¸­ãä¾å¦ï¼ä½ å¯ä»¥å°å¤æç API è®¾è®¡æ¨¡å¼æ¾å¨ docs/api-patterns.md ä¸­ï¼ç¶åå¨ä¸»æä»¶éç¨ @docs/api-patterns.md å¼ç¨å®ã</li>
<li>.claude/rules/ ç®å½ è¿æ¯ä¸ä¸ªéå¸¸éåå¤§åå¢éçç»æãæææ¾å¨ .claude/rules/ ç®å½ä¸ç .md æä»¶é½ä¼è¢« Claude èªå¨å è½½ï¼æ éæå¨ @importãè¿ä½¿å¾ä¸åé¢åçå¢éå¯ä»¥ç¬ç«ç»´æ¤åèªçè§åæä»¶ï¼ä¾å¦ï¼åç«¯å¢éç»´æ¤ code-style.mdï¼å®å¨å¢éç»´æ¤ security.mdãå¤§å®¶åå¸å¶èï¼ææé¿åäºå¨åä¸ªå¤§æä»¶ä¸­é¢ç¹äº§çåå¹¶å²çªã</li>
<li>å­ç®å½ä¸­ç CLAUDE.md å¯¹äº Monorepoï¼åä¸ä»£ç åºï¼é¡¹ç®ï¼è¿æ¯ä¸ä¸ªç»ä½³çè§£å³æ¹æ¡ãä½ å¯ä»¥å¨é¡¹ç®çç¹å®å­ç®å½ï¼ä¾å¦ api/ æ packages/ui/ï¼ä¸­æ¾ç½® CLAUDE.md æä»¶ãè¿äºæä»¶éå¸¸ç¹æ®ï¼å®ä»¬å¹¶ä¸ä¼å¨ä¼è¯å¯å¨æ¶å è½½ï¼èåªå¨ Claude ä¸»å¨å¤çè¯¥ç¹å®å­ç®å½ä¸­çåå®¹æ¶æä¼è¢«åå«è¿æ¥ãè¿ä½¿å¾ä½ å¯ä»¥ä¸ºé¡¹ç®çä¸åæ¨¡åå®ä¹æªç¶ä¸åçè§èï¼å®ç°çæ­£ç²¾ç»åçä¸ä¸æç®¡çã<br>
â¢ ä¸ªäººéç½® CLAUDE.local.md è¿æä¸ä¸ªå³é®æä»¶ï¼CLAUDE.local.mdãå®ç¨äºå­æ¾é£äºä¸åºæäº¤å°çæ¬æ§å¶ä¸­çä¸ªäººåå¥½ï¼ä¾å¦ä½ ä¹ æ¯çç¼è¾å¨ quirks æåå¥½çä»£ç åä½åº¦ãç±äºè¿æ¯ä¸ªäººä¸å±çï¼è¯·å¡å¿å°å¶æ·»å å° .gitignore æä»¶ä¸­ï¼ä»¥é¿åå°ä¸ªäººéç½®æ³é²ç»æ´ä¸ªå¢éã</li>
</ul>
<h2 id="4-é­é¬¼å¨ç»èä¸­æä»¶åæ¯åºåå¤§å°åç">4. é­é¬¼å¨ç»èä¸­ï¼æä»¶åæ¯åºåå¤§å°åç</h2>
<p>è¿æ¯ä¸ä¸ªæå¶å¾®å°ä½è³å³éè¦çææ¯ç»èï¼ä¹æ¯æå®¹æè¢«å¿½ç¥çé·é±ä¹ä¸ï¼CLAUDE.md è¿ä¸ªæä»¶åæ¯åºåå¤§å°åçã</p>
<p>æ­£ç¡®çæä»¶åå¿é¡»æ¯âCLAUDE.mdâââCLAUDE é¨åä¸ºå¤§åï¼.md æ©å±åä¸ºå°åãå¦æä½ å°å¶å½åä¸º claude.mdãClaude.md æå¶ä»ä»»ä½åä½ï¼Claude çç³»ç»å°æ æ³è¯å«å¹¶å è½½å®ã</p>
<p>è¿ä¸ªç»èä¹æä»¥éè¦ï¼æ¯å ä¸ºå®æ¯ä¸ä¸ªå¸åçâé·é±âï¼gotchaï¼ãæè¶£çæ¯ï¼è¿ä¸ç¹å¨å®æ¹ææ¡£ä¸­å¹¶æªæç¡®è¯´æãææ¯éè¿è¯¢é®å®æ¹ææ¡£ç AI å©æææç»ç¡®è®¤äºè¿ä¸è§åãä¸æ¦åºéï¼ä½ å¯è½ä¼è±è´¹å¤§éæ¶é´ææ¥ä¸ºä»ä¹èªå·±ç²¾å¿ç¼åçæä»¤å®å¨æ²¡æçæï¼æç»æåç°é®é¢åºå¨ä¸ä¸ªç®åçå¤§å°åéè¯¯ä¸ãè¿ä¸ªçä¼¼å¾®ä¸è¶³éçç»èï¼æ°æ°ä½ç°äºä¸ AI é«æåä½æ¶ï¼ç²¾ç¡®éç½®çéè¦æ§ã</p>
<h2 id="5-è®©-ai-ä¼å-aiå®æè¯·-claude-å®¡æ¥èªå·±çè¯´æä¹¦">5. è®© AI ä¼å AIï¼å®æè¯· Claude å®¡æ¥èªå·±çâè¯´æä¹¦â</h2>
<p>è¿æ¯ä¸ä¸ªéå¸¸å·§å¦çâåè®¤ç¥âæå·§ï¼å®æè®© Claude èªå·±æ¥å®¡æ¥åä¼åå®çâè¯´æä¹¦âââCLAUDE.md æä»¶ã</p>
<p>éçæ¶é´çæ¨ç§»ï¼CLAUDE.md ä¸­ä¸å¯é¿åå°ä¼ç§¯ç´¯ä¸äºè¿æ¶ãåä½çè³ç¸äºå²çªçæä»¤ãéè¿ä¸ä¸ªç®åçæç¤ºï¼ä¾å¦âè¯·å®¡æ¥è¿ä¸ª CLAUDE.md æä»¶ï¼å¹¶æåºæ¹è¿å»ºè®®ä»¥ä½¿å¶æ´æ¸æ°ãæ´é«æâï¼ä½ å¯ä»¥å©ç¨ Claude èªèº«çè½åæ¥åç°è¿äºé®é¢ãå®å¯è½ä¼å»ºè®®ä½ åå¹¶éå¤çè§åï¼ææ¾æ¸æ¨¡ç³çè¡¨è¿°ã</p>
<p>å¯¹äºé£äºç»å¯¹ä¸è½è¿åçå³é®è§åï¼ä½ å¯ä»¥ä½¿ç¨å¼ºè°è¯æ¥å¼èµ· Claude çæ³¨æï¼æ¯å¦ IMPORTANT: æ YOU MUSTãè¿è½æé« Claude éµå¾ªè¿äºæä»¤çæ¦çï¼ä½è¯·å¡å¿è°¨æä½¿ç¨ãæ­£å¦ä¸å¥å¤èçå»ºè®®æè¯´ï¼å¦æææä¸è¥¿é½è¢«æ è®°ä¸ºéè¦ï¼é£å°±æ²¡æä»ä¹æ¯éè¦çäºã</p>
<p>è¯ç¶ï¼è¿éè¦ä¸äºç»´æ¤ææ¬ï¼ä½å¶åæ¥æ¯å·¨å¤§çãæ­£å¦æºææè¯´ï¼<br>
è¿å¬èµ·æ¥åæ¯ç»´æ¤å¼éãç¡®å®æ¯ãä½å®æ¯å¨æ¯ä¸ªä¼è¯ä¸­éå¤èªå·±çè¯ï¼æä¿®å¤é£äºå¿½ç¥äºä½ çè§èçä»£ç è¦çäºå¾å¤ã</p>
<p>è¿ä¸ä»ä»æ¯ä¸ç§æä»¶ç»´æ¤ç­ç¥ï¼æ´æ¯ä¸ç§ä¸ AI åä½çæ°èå¼ãæä»¬ä¸åä»ä»æ¯ AI çä½¿ç¨èï¼æ´æ¯å¶æé¿è¿ç¨ä¸­çå¼å¯¼èï¼è®©å·¥å·æ¬èº«åä¸å°èªæå®åçæµç¨ä¸­ï¼å½¢æä¸ä¸ªæç»­æ¹è¿çè¯æ§å¾ªç¯ã</p>
<h2 id="ç»è®º">ç»è®º</h2>
<p>CLAUDE.md è¿ä¸æ­¢ä¸ä¸ªç®åçéç½®æä»¶ãéè¿æ¬æåäº«çäºä¸ªé«çº§æå·§ââå°å¶è§ä¸ºæ´»ææ¡£ãä¿æç²¾ç®ãæ¨¡ååç®¡çãæ³¨æå¤§å°åï¼ä»¥åè®© AI èªæä¼åââä½ å¯ä»¥å°å¶ä»ä¸ä¸ªéæçæä»¤åè¡¨ï¼è½¬åä¸ºä¸ä¸ªå¼ºå¤§çãä¸é¡¹ç®å±åæé¿çå¨æç¥è¯åºã</p>
<p>è¿äºç­ç¥ä»£è¡¨äºä¸ç§æ´æ·±å±æ¬¡çæç»´æ¹å¼ï¼å°ä½ ç AI ä¸ä¸ææ¬èº«è§ä¸ºä¸ä¸ªâä»£ç åºâãå®ä¹éè¦åä»£ç ä¸æ ·è¢«éæãè¢«å®¡æ¥ãè¢«æç»­æ¹è¿ãä½ ç CLAUDE.md å¼å¾ä½ å¦æ­¤å¯¹å¾ãç°å¨ï¼ä¸å¦¨æèä¸ä¸ï¼ä½ ç CLAUDE.md ä¸­æ²æ·äºå¤å°å¢éæºæ§ï¼æè®¸ï¼ç°å¨å°±æ¯å¼å§æå»ºå®çæä½³æ¶æºã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-15 20:10">2026-01-15 20:09</span>&nbsp;
<a href="https://www.cnblogs.com/didispace">ç¨åºç¿DD</a>&nbsp;
éè¯»(<span id="post_view_count">49</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19489098);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19489098', targetLink: 'https://www.cnblogs.com/didispace/p/19489098', title: 'CLAUDE.md å¨æ¹ä½æåï¼æå»ºé«æ AI å¼åä¸ä¸æ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä½¿ç¨vue3. + vite å¼åï¼æå¼æ§å¶å°å¡é¡¿ï¼å³é­æ§å¶å°æµçãæå¼æ§å¶å°æ¶ï¼é¼ æ å¨é¡µé¢ä¸ç§»å¨ãæ­¤æ¶æµè§å¨è¿ç¨çcpuå©ç¨çä¹æä¸åã ]]></title>
    <link>https://www.cnblogs.com/xiaohui666/p/19489060</link>
    <guid>bbc575a78f1e74916727bd5c07f73a33</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xiaohui666/p/19489060" title="åå¸äº 2026-01-15 19:56">
    <span role="heading" aria-level="2">ä½¿ç¨vue3. + vite å¼åï¼æå¼æ§å¶å°å¡é¡¿ï¼å³é­æ§å¶å°æµçãæå¼æ§å¶å°æ¶ï¼é¼ æ å¨é¡µé¢ä¸ç§»å¨ãæ­¤æ¶æµè§å¨è¿ç¨çcpuå©ç¨çä¹æä¸åã</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>ä½¿ç¨vue3. + vite å¼åï¼æå¼æ§å¶å°å¡é¡¿ï¼å³é­æ§å¶å°æµçãæå¼æ§å¶å°æ¶ï¼é¼ æ å¨é¡µé¢ä¸ç§»å¨ãæ­¤æ¶æµè§å¨è¿ç¨çcpuå©ç¨çä¹æä¸åã</p>
<p>&nbsp;</p>
<p>æå¼ä»»å¡ç®¡çå¨æ¥çå° åå¯å¨å°± 300M å·¦å³ï¼æ­¤æ¶é¡µé¢è¿æ­£å¸¸æµçä½¿ç¨</p>
<p><img src="https://img2024.cnblogs.com/blog/1692424/202601/1692424-20260115192758334-1287855783.png" alt="image" loading="lazy"></p>
<p>&nbsp;</p>
<p>å½æå¼æµè§å¨F12æ§å¶å°æ¶ ï¼é¡µé¢å¡é¡¿ï¼åå­å ç¨ç´æ¥å°è¾¾æäººç1547M ,ç¾æä¸å¾å¶è§£</p>
<p><img src="https://img2024.cnblogs.com/blog/1692424/202601/1692424-20260115193120944-1363009300.png" alt="image" loading="lazy"></p>
<p>&nbsp;</p>
<p>æå¼åå­é¢æ¿ï¼æ¥æ¾åå ï¼æ­¤æ¶ç¨äº706M</p>
<p><img src="https://img2024.cnblogs.com/blog/1692424/202601/1692424-20260115193422895-368120997.png" alt="image" loading="lazy"></p>
<p>&nbsp;</p>
<p>ç­éä¸ä¸ï¼åç°æ¯æ ·å¼å¯¼å¥éå¤</p>
<p><img src="https://img2024.cnblogs.com/blog/1692424/202601/1692424-20260115193617511-1308370927.png" alt="image" loading="lazy"></p>
<p>&nbsp;</p>
<p>&nbsp;æ¥çä»£ç æä¸å¤å°æ¹å¼ç¨</p>
<p><img src="https://img2024.cnblogs.com/blog/1692424/202601/1692424-20260115193908039-480362363.png" alt="image" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/1692424/202601/1692424-20260115193912528-202535441.png" alt="image" loading="lazy"></p>
<p>&nbsp;</p>
<p><img src="https://img2024.cnblogs.com/blog/1692424/202601/1692424-20260115193917151-2133524706.png" alt="image" loading="lazy"></p>
<p>&nbsp;</p>
<p>&nbsp;åæ³¨é&nbsp;vite.config.ts éç</p>
<p><img src="https://img2024.cnblogs.com/blog/1692424/202601/1692424-20260115194950450-306480391.png" alt="image" loading="lazy"></p>
<p>&nbsp;</p>
<p>åç°åå­ææ¾ä¸éï¼é®é¢è§£å³</p>
<p><img src="https://img2024.cnblogs.com/blog/1692424/202601/1692424-20260115195104234-699812157.png" alt="image" loading="lazy"></p>
<p>&nbsp;</p>
<p><img src="https://img2024.cnblogs.com/blog/1692424/202601/1692424-20260115195120872-371187655.png" alt="image" loading="lazy"></p>
<p>&nbsp;</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-15 19:56">2026-01-15 19:56</span>&nbsp;
<a href="https://www.cnblogs.com/xiaohui666">å°è¾ã</a>&nbsp;
éè¯»(<span id="post_view_count">61</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19489060);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19489060', targetLink: 'https://www.cnblogs.com/xiaohui666/p/19489060', title: 'ä½¿ç¨vue3. + vite å¼åï¼æå¼æ§å¶å°å¡é¡¿ï¼å³é­æ§å¶å°æµçãæå¼æ§å¶å°æ¶ï¼é¼ æ å¨é¡µé¢ä¸ç§»å¨ãæ­¤æ¶æµè§å¨è¿ç¨çcpuå©ç¨çä¹æä¸åã' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æç¨ stock-sdk æå»ºäºä¸ä¸ªä¸ªäººä¸å±ç A è¡è¡æä»ªè¡¨ç ]]></title>
    <link>https://www.cnblogs.com/chengzp/p/19488966/stock-dashboard</link>
    <guid>1cea99dfc59bff2537aadb1594c332f2</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/chengzp/p/19488966/stock-dashboard" title="åå¸äº 2026-01-15 19:06">
    <span role="heading" aria-level="2">æç¨ stock-sdk æå»ºäºä¸ä¸ªä¸ªäººä¸å±ç A è¡è¡æä»ªè¡¨ç</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/1265396/202601/1265396-20260115190434191-202601803.png" alt="æç¨ stock-sdk æå»ºäºä¸ä¸ªä¸ªäººä¸å±ç A è¡è¡æä»ªè¡¨ç" class="desc_img">
        è¿ç¯åå®¢ä»ç»äºæç¨ stock-sdk æ­å»ºç A è¡è¡ç¥¨çæ¿ stock-dashboardï¼åºäº React + TypeScript + Vite ççº¯åç«¯é¡¹ç®ï¼ä¸ä¾èµåç«¯æå®æ¶èæ¬ï¼ç´æ¥å¨é¡µé¢ä¾§æåè¡æå¹¶å®æå±ç¤ºä¸ç­éãæç« ä»æ°æ®å±å°è£ï¼SDK åä¾ãéè¯ãTTL ç¼å­ãæå¡å±ç»ä¸åºå£ï¼è®²èµ·ï¼åæåè½æè§£æç´¢ãDashboardãç­åå¾ãæ¿å/ä¸ªè¡è¯¦æãèªéãä¿¡å·æ«æä¸è®¾ç½®ç­æ¨¡åãæåéç¹åäº«âä¸æ¥æè¡æ³ï¼å°¾çéè¡ï¼âçå¨å¸åºæ«ææè·¯ï¼åæ¹éæå 5000+ è¡æååºç¡è¿æ»¤ï¼ååæ¹æåæ¶è®¡ç®å¼ºåº¦ææ å¹¶æåºè¾åºåéã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="è¿æ¯ä¸ªå¥">è¿æ¯ä¸ªå¥</h2>
<p>èæ¯æäºå¾ç®åï¼ä½ä¸ºä¸ä¸ªæ¥å¸¸å³æ³¨è¡æçâé­èâï¼ææä¸ä¸ªä¸å¤ªé«æçä¹ æ¯ââåæ¶æå¼æ æ°ä¸ªççè½¯ä»¶åç½é¡µï¼å¨æ··ä¹±ççªå£åæ¢ä¸­è¿·å¤±èªæï¼æç»æ¶è·çå¾å¾åªæç¦èï¼å¤å æµè§å¨é£ä»¤äººçªæ¯çæ ç­¾é¡µå å ãä¸ºäºå½»åºæ²»æè¿ç§ä½æï¼æå³å®å¨ææé ä¸ä¸ªä¸å±å·¥å·ï¼<strong>å¨ä¸ä¸ªé¡µé¢åéæææé«é¢åè½ï¼æ¶µçå®æ¶è¡æãæ¿åå¨æãåæ¶èµ°å¿ãK çº¿åæãèµéæµåä»¥åç­éå¨</strong>ã</p>
<p>è¿å°±è¯çäº <code>stock-dashboard</code>ï¼ä¸ä¸ªå®å¨åºäº React + TypeScript + Vite ææ¯æ çåç«¯å¤§å±ãæææ°æ®ç´æ¥ç± <a href="https://stock-sdk.linkdiary.cn/" target="_blank" rel="noopener nofollow">stock-sdk</a> é©±å¨ï¼è¿æå³çé¡¹ç®å®å¨æå¼äºåç«¯æå¡ï¼ä¸éè¦è¿è¡ä»»ä½ Python å®æ¶ä»»å¡ï¼ä¹ä¸ä¾èµä»ä¹âç¥ç§æåçé«ç«¯æå¡å¨âãçº¯åç«¯ç´è¿æ°æ®æºï¼æè§å³æå¾ï¼ä¸åé½å®æå¾äºäºææ¡ã</p>
<p>ç´æ¥ä¸å¨çº¿æ¼ç¤ºé¾æ¥ï¼<a href="https://chengzuopeng.github.io/stock-dashboard/" target="_blank" rel="noopener nofollow">stock-dashboard</a> ï¼åææç¤ºï¼æ¸é±¼æé´è¯·è°¨æä½¿ç¨ï¼å»ºè®®éåå°çªå£æ¨¡å¼ï¼ã<br>
<img alt="stock-overview" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1265396/202601/1265396-20260115184342860-7509536.png" class="lazyload"></p>
<h2 id="æ ¸å¿è§£å¯æ°æ®å±æ¶æè®¾è®¡">æ ¸å¿è§£å¯ï¼æ°æ®å±æ¶æè®¾è®¡</h2>
<p>ä¸ºäºä¿æä»£ç æ´æ´ï¼æå°ææéå¯¹ <code>stock-sdk</code> çè°ç¨é»è¾é½å°è£å¨äº <code>src/services/sdk.ts</code> ä¸­ã</p>
<p>è¿éä¸»è¦å®æ½äºä¸ä¸ªæ¢å®ç¨åä¸ç«æçå·¥ç¨åç­ç¥ï¼</p>
<ol>
<li>
<p><strong>å¨å±åä¾ä¸èªå¨éè¯æºå¶</strong><br>
éè¿ <code>new StockSDK({ timeout, retry })</code> åå§åå®ä¾ãé¢å¯¹ç½ç»æ³¢å¨ææ¥å£å¶å°æ½é£çæåµï¼SDK åç½®çèªå¨éè¯æºå¶ï¼æ¯ææå¤§ 3 æ¬¡éè¯åææ°éé¿ç®æ³ï¼è½å®ç¾ååºã</p>
</li>
<li>
<p><strong>æºè½åå­ç¼å­ï¼TTL ç­ç¥ï¼</strong><br>
å¯¹äºè¡ä¸ææ¦å¿µåè¡¨è¿ç±»åå¨é¢çæä½çæ°æ®ï¼æ¯ç«å®ä»¬ä¸ä¼å¨å ç§ååçå§åï¼ï¼ç´æ¥ä¸ç¼å­åå°æ æè¯·æ±ï¼èå¯¹äºå®æ¶è¡æï¼åè®¾ç½®äº 2~3 ç§ççå­æï¼TTLï¼ï¼æ¢ä¿è¯äºæ°æ®çæ¶ææ§ï¼åé¿åäºæ æä¹çé«é¢è¯·æ±è½°ç¸æ¥å£ã</p>
</li>
<li>
<p><strong>åå±éç¦»ï¼é¡µé¢ä»å¯¹æ¥æå¡å±</strong><br>
ç¿»é <code>src/pages/**</code> ä¸çä»£ç ï¼ä½ å ä¹æ¾ä¸å° <code>new StockSDK()</code> çèº«å½±ãUI å±åªè´è´£è°ç¨è¯¸å¦ <code>getFullQuotes / getTodayTimeline / getKlineWithIndicators</code> ç­ç»è¿äºæ¬¡å°è£çä¸å¡æ¹æ³ï¼èç±»åå®ä¹åç´æ¥å¤ç¨ <code>stock-sdk</code> çå¯¼åºã</p>
</li>
</ol>
<p>é¡ºä¾¿å±ç¤ºä¸¤æ®µæ ¸å¿ä»£ç éª¨æ¶ï¼åç»­çææåè½æ¨¡åçæå»ºäºæ­¤åºç¡ä¹ä¸ï¼</p>
<pre><code class="language-ts">// src/services/sdk.ts
export const sdk = new StockSDK({ timeout: 30000, retry: { maxRetries: 3, baseDelay: 1000, maxDelay: 10000, backoffMultiplier: 2 } });

export async function getFullQuotes(codes: string[], useCache = true) {
  const key = getCacheKey('getFullQuotes', codes);
  if (useCache) {
    return withCache(key, DEFAULT_TTL.quotes, () =&gt; sdk.getFullQuotes(codes));
  }
  return sdk.getFullQuotes(codes);
}
</code></pre>
<pre><code class="language-ts">// src/services/sdk.ts
export async function getAllAShareQuotes(options?: { batchSize?: number; concurrency?: number; onProgress?: (completed: number, total: number) =&gt; void }) {
  return sdk.getAllAShareQuotes(options);
}
</code></pre>
<hr>
<h2 id="åè½æè§£åæ¨¡åå¦ä½ç©è½¬-stock-sdk-æ°æ®">åè½æè§£ï¼åæ¨¡åå¦ä½ç©è½¬ stock-sdk æ°æ®ï¼</h2>
<p>è·¯ç±éç½®ä½äº <code>src/router/index.tsx</code>ï¼èåä¸ªåè½é¡µé¢åæ¨¡ååå°åå¸å¨ <code>src/pages/*</code> ç®å½ä¸ãæ¥ä¸ä¹å°±æ¯å¤§å®¶æå³å¿çââæâç¨æ·äº¤äºè·¯å¾âæ¥éä¸å¤çã</p>
<h3 id="1-å¨å±æç´¢åå«æå¨ç¿»ä»£ç ççè¦">1) å¨å±æç´¢ï¼åå«æå¨ç¿»ä»£ç ççè¦</h3>
<p>æç´¢æ ç»ä»¶ä½äº <code>src/components/layout/Header.tsx</code>ï¼å¶èåçé­æ³ä»éä¸è¡ä»£ç ï¼</p>
<ul>
<li><code>search(keyword)</code> æ å°å° <code>stock-sdk</code> ç <code>sdk.search(keyword)</code></li>
</ul>
<p>ä¸ºäºä¼åä½éªï¼ææ·»å äº 300ms çè¾å¥é²æå¤çãæç´¢ç»æå®ç¾æ¯æä¸ªè¡ä¸æ¿åçæ··åæ¥è¯¢ï¼ç¹å»å³è¾¾ï¼</p>
<ul>
<li>è¡ä¸æ¿åè·³è½¬è³ï¼<code>/boards/industry/:code</code></li>
<li>æ¦å¿µæ¿åè·³è½¬è³ï¼<code>/boards/concept/:code</code></li>
<li>ä¸ªè¡è¯¦æè·³è½¬è³ï¼<code>/s/:code</code></li>
</ul>
<p>é¡ºæè¿å©ç¨ localStorage å®ç°äºä¸ä¸ªç®åçåå²è®°å½åè½ï¼<code>src/services/storage.ts</code>ï¼ï¼æ¯ç«å¾å¤æ¶åï¼æä»¬å¯»æ¾çä¸æ¯æ°æ çï¼èæ¯æ¨å¤©æ²¡çå®çé£ä¸ªå®ã</p>
<hr>
<h3 id="2-ä»ªè¡¨ç-dashboardè¡ææ¦è§ä¸èªééè§">2) ä»ªè¡¨ç Dashboardï¼è¡ææ¦è§ä¸èªééè§</h3>
<p>å¯¹åºé¡µé¢æä»¶ï¼<code>src/pages/Dashboard/Dashboard.tsx</code>ã</p>
<p>æ°æ®è·åé»è¾éå¸¸ç´ç½ç²æ´ï¼</p>
<ul>
<li>ææ°è¡æï¼è°ç¨ <code>getFullQuotes(MAIN_INDICES)</code> ä¸æ¬¡æ§è·åä¸è¯ãæ·±ææãç§å 50 ç­å³é®ææ°ã</li>
<li>æ¿åæ¦åµï¼å¹¶è¡è°ç¨ <code>getIndustryList()</code> å <code>getConceptList()</code>ã</li>
<li>èªéè¡é¢è§ï¼åä»å­å¨æå¡ <code>src/services/storage.ts</code> è¯»åèªéåè¡¨ï¼åéè¿ <code>getFullQuotes(watchlistCodes.slice(0, 50))</code> æ¹éè·åå 50 åªè¡æçå¿«ç§ã</li>
</ul>
<p>ä¸ºäºä¿è¯æ°æ®çé²æ´»åº¦ï¼éå <code>usePolling</code> Hookï¼<code>src/hooks/usePolling.ts</code>ï¼å®ç°äºæ¯ 5 ç§èªå¨è½®è¯¢ãè´´å¿çæ¯ï¼å½é¡µé¢å¤äºåå°ä¸å¯è§ç¶ææ¶ï¼è½®è¯¢ä¼èªå¨æèµ·ï¼ç»ä¸æµªè´¹ä½ çæµè§å¨èµæºã</p>
<p>é¢å¤æä¸å¥ï¼ç®å Dashboard ä¸çâæ¦åâä¸»è¦å±ç¤ºæ¿åæ°æ®ãå¦ææ³åå¨å¸åºçä¸ªè¡æåï¼ææ¯è·¯å¾å®å¨å¯ä»¥åèåé¢æå°çâä¸æ¥æè¡æ³âï¼ä¹å°±æ¯ç´æ¥å©ç¨ <code>getAllAShareQuotes</code> æ¥å£ã</p>
<hr>
<h3 id="3-å¸åºç­åå¾-heatmapä¸å¾çæèµéæµå">3) å¸åºç­åå¾ Heatmapï¼ä¸å¾çæèµéæµå</h3>
<p><img alt="stock-heatmap" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1265396/202601/1265396-20260115184456436-42415763.png" class="lazyload"></p>
<p>å®ç°æä»¶ä½äº <code>src/pages/Heatmap/Heatmap.tsx</code>ï¼åºå±ä¾èµ ECharts çç©å½¢æ å¾ï¼Treemapï¼ã</p>
<p>æ ¹æ®è§å¯è§è§çä¸åï¼æ°æ®æºä¹åå¼ï¼</p>
<ul>
<li>è¡ä¸è§è§ï¼ç´æ¥ç¨ <code>getIndustryList()</code>ï¼å ä¸ºè¿åçæ°æ®ä¸­å·²ç»åå«äºæ¶¨è·å¹ãæ¢æçåé¢æ¶¨è¡ä¿¡æ¯ã</li>
<li>æ¦å¿µè§è§ï¼åçï¼è°ç¨ <code>getConceptList()</code>ã</li>
<li>èªéè§è§ï¼è·åææèªéä»£ç  <code>getAllWatchlistCodes()</code> åï¼éè¿ <code>getAllQuotesByCodes(codes.slice(0, topK))</code> æ¹éæåã</li>
</ul>
<p>è³äºâå¨å¸åºä¸ªè¡âç­åå¾ï¼ä»£ç é¢çäºæ¥å£ï¼ææªå¼å¯ï¼ï¼å®ç°é»è¾ä¹ä¸å¤æï¼</p>
<ol>
<li>éè¿ <code>getIndustryConstituents(industryCode)</code> è·åç¹å®æ¿åæåè¡ã</li>
<li>ç¨ <code>getAllQuotesByCodes(stockCodes)</code> æè¡ææ°æ®è¡¥é½ã</li>
<li>æåç»è£æ°æ®åç» Treemap ç»ä»¶ã</li>
</ol>
<p>ç­åå¾æå¤§çé­åå¨äºï¼<strong>åå«æ¯ç¥çæ°å­åè¡¨ï¼çº¢ç»¿ç¸é´çè²åè®©ä½ ç¬é´æ´å¯å¸åºå¼ºå¼±ç»æã</strong></p>
<hr>
<h3 id="4-é¾èæ¦-rankingsè§å¯å¸åºé£åæ ">4) é¾èæ¦ Rankingsï¼è§å¯å¸åºé£åæ </h3>
<p><img alt="stock-leaderboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1265396/202601/1265396-20260115184533320-338122596.png" class="lazyload"></p>
<p>é¡µé¢è·¯å¾ï¼<code>src/pages/Rankings/Rankings.tsx</code>ã</p>
<p>å®ç°æ¹å¼å±äºâç®åç²æ´ä¸ææâï¼</p>
<ul>
<li>å¹¶è¡è·å <code>getIndustryList()</code> å <code>getConceptList()</code>ã</li>
<li>åç«¯ç´æ¥æ ¹æ® <code>changePercent</code>ï¼æ¶¨è·å¹ï¼æ <code>turnoverRate</code>ï¼æ¢æçï¼è¿è¡æåºï¼æªå Top 50ã</li>
</ul>
<p>ç®åçæ¦åæ¬è´¨ä¸æ¯âæ¿åæè¡æ¦âãå¦ææªæ¥è¦æ©å±å°å¨å¸åºä¸ªè¡æè¡ï¼ææ¯æ¹æ¡ä¸åæçâéè¡å¨âä¸è´ã</p>
<hr>
<h3 id="5-æ¿åéè§è¿½è¸ªé¢æ¶¨åé">5) æ¿åéè§ï¼è¿½è¸ªé¢æ¶¨åé</h3>
<p>æ¿ååè¡¨é¡µä½äº <code>src/pages/Boards/Boards.tsx</code>ï¼</p>
<ul>
<li><code>getIndustryList()</code> ä¸ <code>getConceptList()</code> ä¸ææ¢­ã</li>
<li>æè°ç Tab åæ¢ï¼ä»ä»æ¯åç«¯å¯¹ä¸åæ°æ®æºæ°ç»çæ¸²æåæ¢ã</li>
<li>å½ç¶ä¹æ¯æææ¿ååç§°æé¢æ¶¨è¡è¿è¡æ£ç´¢ã</li>
</ul>
<p>è¯¦æé¡µè§ <code>src/pages/Boards/BoardDetail.tsx</code>ï¼è¿éå±ç¤ºäº API çç»åæ³è½åï¼æè¡ä¸/æ¦å¿µåæµï¼ï¼</p>
<ul>
<li>åºç¡ä¿¡æ¯ï¼ç´æ¥å¤ç¨åè¡¨æ°æ®ï¼åå°ä¸æ¬¡ç½ç»è¯·æ±ã</li>
<li>æåè¡åè¡¨ï¼è°ç¨ <code>getIndustryConstituents(code)</code> æ <code>getConceptConstituents(code)</code>ã</li>
<li>æ¿åèµ°å¿ï¼æå <code>getIndustryKline</code> æ <code>getConceptKline</code>ã</li>
<li>çå£å¿«ç§ï¼éè¿ <code>getIndustrySpot</code> æ <code>getConceptSpot</code> è·åã</li>
</ul>
<p>ä¸ºäºä¿è¯æµçåº¦ï¼æ¿å K çº¿å¾ç®ååªæªåäºæè¿ 60 æ ¹æ°æ®ï¼é²æ­¢ç¼©æ¾å¾è¡¨æ¶æµè§å¨æ¸²æååè¿å¤§ã</p>
<hr>
<h3 id="6-èªéçæ§-watchliståªçæå¨æç">6) èªéçæ§ Watchlistï¼åªçæå¨æç</h3>
<p>æ ¸å¿é¡µé¢ï¼<code>src/pages/Watchlist/Watchlist.tsx</code>ãææçå¢å æ¹æ¥é»è¾é½å°è£å¨ <code>src/services/storage.ts</code> ä¸­ã</p>
<p>è¡æå·æ°ä¸»è¦ä¾èµï¼</p>
<ul>
<li><code>getAllQuotesByCodes(normalizedActiveCodes)</code></li>
</ul>
<p>ç¹å«æä¸ä¸è¿éçç»èå¤çï¼å¨è¯·æ±åæä¼åéè¿ <code>normalizeStockCode</code>ï¼ä½äº <code>src/utils/format.ts</code>ï¼å¯¹ä»£ç è¿è¡æ ååæ ¼å¼åï¼ææé²æ­¢äº <code>SZ000001</code>ã<code>sz000001</code> å <code>000001</code> è¿ç§âä¸ç å¤å¼âé æçå»éå¤±è´¥ææ°æ®è¯·æ±å¼å¸¸ã</p>
<hr>
<h3 id="7-ä¸ªè¡æ·±åº¦åæ-stockdetailå¨ç»´æ°æ®ä¸è§æ ä½">7) ä¸ªè¡æ·±åº¦åæ StockDetailï¼å¨ç»´æ°æ®ä¸è§æ ä½</h3>
<p><img alt="stock-detail" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1265396/202601/1265396-20260115184557669-1024006702.png" class="lazyload"></p>
<p>é¡µé¢ä½ç½®ï¼<code>src/pages/StockDetail/StockDetail.tsx</code>ãè¿æ¯æ´ä¸ªé¡¹ç®ä¸­æ¿è½½ä¿¡æ¯éæå¤§çé¡µé¢ï¼å ä¸ºå®èåäºæé«å¯åº¦çä¿¡æ¯ã</p>
<p>å®èåäºå¤ç»´åº¦ç API æ°æ®ï¼</p>
<ul>
<li>å®æ¶æ¥ä»·ï¼<code>getFullQuotes([code])</code></li>
<li>å½æ¥åæ¶å¾ï¼1åéçº§ï¼ï¼<code>getTodayTimeline(code)</code></li>
<li>åéçº§ K çº¿ï¼5/15/30/60ï¼ï¼<code>getMinuteKline(code, { period })</code></li>
<li>åå² K çº¿ï¼æ¥/å¨/æï¼åå¤æï¼<code>getKlineWithIndicators(code, { period, adjust: 'qfq', indicators })</code></li>
<li>èµéæµåçæµï¼<code>getFundFlow([code])</code></li>
<li>çå£å¤§åçæ§ï¼<code>getPanelLargeOrder([code])</code></li>
</ul>
<p>æä¸ªäººéå¸¸æ¨å´ <code>getKlineWithIndicators</code> è¿ä¸ªæ¥å£ï¼åªéä¼ å¥ä½ æ³è¦çææ åæ°ï¼å¦ MA, MACD, KDJ, RSI, BOLLç­ï¼ï¼SDK å°±è½æè®¡ç®å¥½çææ æ°æ®è¿å K çº¿ä¸èµ·è¿åãåç«¯åªéè´è´£ç»å¾ï¼å½»åºåå«äºå¨åç«¯æåå¤æææ¯ææ è®¡ç®é»è¾çå©æ¢¦ï¼å°åä»£ç  = å°åº Bug = é¿å½ç¾å²ï¼ã</p>
<p>å¨è¿éï¼è½®è¯¢ç­ç¥ä¹åäºç²¾ç»ååå±ï¼</p>
<ul>
<li>åºç¡è¡æï¼2 ç§/æ¬¡</li>
<li>åæ¶å¾ï¼3 ç§/æ¬¡</li>
<li>èµéæµåï¼10 ç§/æ¬¡</li>
</ul>
<hr>
<h3 id="8-ç­ç¥æ«æå¨-scanneréåäº¤æçåä½éª">8) ç­ç¥æ«æå¨ Scannerï¼éåäº¤æçåä½éª</h3>
<p>é¡µé¢ï¼<code>src/pages/Scanner/Scanner.tsx</code>ã</p>
<p>æ«æé»è¾ç®è¿°å¦ä¸ï¼</p>
<ol>
<li><strong>ç¡®å®è¡ç¥¨æ± </strong>ï¼
<ul>
<li>æ¢å¯ä»¥æ¯ä½ çâèªéè¡åè¡¨âã</li>
<li>ä¹å¯ä»¥æ¯æä¸ªæ¿åçæåè¡ï¼ä¾å¦è°ç¨ <code>getIndustryConstituents('BK0475')</code>ã</li>
</ul>
</li>
<li><strong>æ¹éåæ</strong>ï¼
<ul>
<li>éåæ¯åªè¡ç¥¨ï¼è°ç¨ <code>getKlineWithIndicators</code> è·åå¸¦ææ ç K çº¿æ°æ®ã</li>
</ul>
</li>
<li><strong>ä¿¡å·å¹é</strong>ï¼
<ul>
<li>åç«¯é»è¾å¤æ­æè¿ä¸¤æ ¹ K çº¿æ¯å¦æ»¡è¶³é¢è®¾å½¢æï¼å¦åçº¿éåãMACD éåãRSI è¶ä¹°è¶åç­ï¼ã</li>
</ul>
</li>
</ol>
<p>è½ç¶è¿ä¸ªåè½å¸¦æä¸å®çâå¿éå®æ°âå±æ§ï¼ä½å®ç¡®ç¡®å®å®ææ¨¡ç³çâçæ¶¨æè§âè½¬åä¸ºäºå¯æ§è¡çâè§¦åæ¡ä»¶âã</p>
<hr>
<h3 id="9-ä¸ªæ§åè®¾ç½®-settingsæé é¡ºæçå·¥å·">9) ä¸ªæ§åè®¾ç½® Settingsï¼æé é¡ºæçå·¥å·</h3>
<p><img alt="stock-settings" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1265396/202601/1265396-20260115184611235-287105548.png" class="lazyload"></p>
<p>é¡µé¢ï¼<code>src/pages/Settings/Settings.tsx</code>ã</p>
<p>è¿ä¸ªé¡µé¢å¹¶æ²¡æè°ç¨ä»»ä½ <code>stock-sdk</code> æ¥å£ï¼å®çä½¿å½æ¯å°ä½ çä½¿ç¨åå¥½ï¼å·æ°é¢çãçº¢æ¶¨ç»¿è·éè²ãåç±»ææ çé»è®¤åæ°ç­ï¼æä¹åä¿å­å° localStorageãè¿æ ·ï¼æ è®ºä½æ¶æå¼é¡µé¢ï¼å®é½è¿æ¯é£ä¸ªä½ æçæçæ ·å­ã</p>
<hr>
<h2 id="éå¤´æä¸æ¥æè¡ç­ç¥å°¾çéè¡åç«¯å®ç°çå¨å¸åºæ«æ">éå¤´æï¼ä¸æ¥æè¡ç­ç¥ï¼å°¾çéè¡ï¼ââåç«¯å®ç°çå¨å¸åºæ«æ</h2>
<p><img alt="stock-last" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1265396/202601/1265396-20260115184618983-2095502387.png" class="lazyload"></p>
<p>è¯¥åè½ä½äº <code>src/pages/EndOfDayPicker/EndOfDayPicker.tsx</code>ãæå¨è¿ä¸ªé¡µé¢å®ç°äºä¸å¥ç»å¸çâä¸æ­¥èµ°âéè¡æ¼æï¼å¶æ ¸å¿å¨åæºèªå¼ºå¤§ç <strong><code>getAllAShareQuotes</code></strong> æ¥å£ã</p>
<h3 id="ç¬¬ä¸é¶æ®µå¨é-a-è¡è¡ææå">ç¬¬ä¸é¶æ®µï¼å¨é A è¡è¡ææå</h3>
<pre><code class="language-ts">// src/pages/EndOfDayPicker/EndOfDayPicker.tsx
const quotes = await getAllAShareQuotes({
  batchSize: 500,
  concurrency: 5,
  onProgress: (completed, total) =&gt; setLoadingProgress({ completed, total, stage: 'æ°æ®å è½½ä¸­...' }),
});
</code></pre>
<p>è¿ä¸æ­¥è°ç¨çæ¯ SDK çéç£æ¥å£ï¼</p>
<ul>
<li><code>sdk.getAllAShareQuotes(options?: GetAllAShareQuotesOptions): Promise&lt;FullQuote[]&gt;</code></li>
<li>åæ° <code>batchSize</code> æ§å¶åæ¬¡æ¹å¤§å°ï¼é»è®¤ 500ï¼ï¼<code>concurrency</code> æ§å¶å¹¶åæ°ï¼é»è®¤ 7ï¼ã</li>
</ul>
<p>æéåäºç¸å¯¹ç¨³å¥çç­ç¥ï¼å¹¶åè®¾ä¸º 5ï¼ï¼å¼é¡¾äºæµè§å¨çæ§è½è´è½½åç½ç»ç¨³å®æ§ãéå <code>onProgress</code> åè°ï¼ç¨æ·è½çå°å®æ¶çè¿åº¦æ¡åé¦ï¼ä½éªæµçä¸å¡é¡¿ï¼ä¸ä¼è¯¯ä»¥ä¸ºç½é¡µå¡æ­»ã</p>
<h3 id="ç¬¬äºé¶æ®µåºç¡ææ ç²ç­">ç¬¬äºé¶æ®µï¼åºç¡ææ ç²ç­</h3>
<p>æ¿å°å¨å¸åº 5000+ åªè¡ç¥¨ç <code>FullQuote</code> æ°æ®åï¼æä»¬åè¿è¡ä¸è½®ç²ç­ï¼å­æ®µç´æ¥åèª <code>FullQuote</code>ï¼ï¼</p>
<ul>
<li>æµéå¸å¼ (<code>circulatingMarketCap</code>)</li>
<li>éæ¯ (<code>volumeRatio</code>)</li>
<li>æ¶¨è·å¹ (<code>changePercent</code>)</li>
<li>æ¢æç (<code>turnoverRate</code>)</li>
<li>ST/é£é©è¡è¿æ»¤</li>
</ul>
<p>è¿ä¸æ­¥é»è¾å°è£å¨ <code>filterStocksBasic()</code> ä¸­ï¼éå¸¸è½æç®æ æ± ä» 5000+ ç¼©åå°å ç¾çè³å ååªï¼å¦æä¸ç­è¿ä¸åï¼åç»­æååæ¶æ°æ®ä¼ç´æ¥ææµè§å¨éèµ°ã</p>
<h3 id="ç¬¬ä¸é¶æ®µåæ¶å¾å½¢æç²¾é">ç¬¬ä¸é¶æ®µï¼åæ¶å¾å½¢æç²¾é</h3>
<p>å¯¹äºç²ç­å©ä¸çåéè¡ï¼æä»¬åè¿è¡æ´ç»è´çåæ¶å¾åæï¼</p>
<ul>
<li>è°ç¨ <code>getTodayTimeline(fullCode)</code> æååæ¶æ°æ®ï¼æ³¨ææ¼æ¥ sh/sz/bj åç¼ï¼ã</li>
<li>è®¡ç®æ ¸å¿å¼ºåº¦ææ ï¼<code>timelineAboveAvgRatio</code>ï¼å³ï¼ç°ä»·é«äºåä»·çæ¶é´å æ¯ï¼ç± <code>price</code> å <code>avgPrice</code> å¯¹æ¯å¾åºï¼ã</li>
</ul>
<p>ä¸ºäºé²æ­¢æµè§å¨å´©æºï¼<code>filterWithTimeline()</code> ä¸­æå¨æ§å¶äºåæ¶æ°æ®è¯·æ±çå¹¶åéï¼batchSize = 5ï¼ã<br>
æç»ç»ææ <code>timelineAboveAvgRatio</code> éåºæåï¼å¹¶å¨åè¡¨ä¸­å±ç¤ºè¿·ä½ çåæ¶èµ°å¿å¾ãè¿æ ·ä¸æ¥ï¼å°¾çéè¡çæçç´æ¥èµ·é£ã</p>
<hr>
<h2 id="åå¨æåè°éè¦è¿ä¸ªå·¥å·">åå¨æåï¼è°éè¦è¿ä¸ªå·¥å·ï¼</h2>
<p>å¦æä½ æ¸´ææ¥æä¸ä¸ªâæ¢è½ççãåè½ç­è¡ãè¿è½é¡ºä¾¿ç®¡çèªéâçè½»éçº§çæ¿ï¼åæ¶æå¶ææ¥ç»´æ¤åç«¯æå¡æç¼åå¤æç Python èæ¬ï¼é£ä¹è¿ä¸ªçº¯åç«¯æ¹æ¡ç»å¯¹æ¯ä½ çä¸äºä¹éã<strong>æ ¸å¿æè·¯å°±æ¯å©ç¨ <code>stock-sdk</code> å°å¼ºå¤§çæ°æ®è½åå¼å¥åç«¯ï¼å©ä¸çå°±æ¯åçº¯ç UI ç»è£ä¸é»è¾ç¼æ</strong>ã</p>
<p>æ¬å°å¯å¨éå¸¸ç®åï¼</p>
<pre><code class="language-bash">yarn install
yarn dev
</code></pre>
<p>æåä¸å¾ä¸ä¿å¥å°æéä¸å¥ï¼é¡µé¢åºé¨ç disclaimer âä»ä¾å­¦ä¹ åèï¼ä¸æææèµå»ºè®®âå¹¶éæè®¾ãä»£ç è½å¯èªä¿¡æ²ï¼æèµä»éè°¨æè¡ã</p>
<hr>
<h2 id="ä¼ éé¨">ä¼ éé¨</h2>
<ul>
<li>å¨çº¿çæ¿ï¼ <a href="https://chengzuopeng.github.io/stock-dashboard/" target="_blank" rel="noopener nofollow">https://chengzuopeng.github.io/stock-dashboard/</a></li>
<li>SDK ææ¡£ï¼ <a href="https://stock-sdk.linkdiary.cn/" target="_blank" rel="noopener nofollow">https://stock-sdk.linkdiary.cn/</a></li>
<li>SDK æ¼ç»åºï¼ <a href="https://stock-sdk.linkdiary.cn/playground/" target="_blank" rel="noopener nofollow">https://stock-sdk.linkdiary.cn/playground/</a></li>
</ul>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.004166666666666667" data-date-updated="2026-01-15 19:12">2026-01-15 19:06</span>&nbsp;
<a href="https://www.cnblogs.com/chengzp">ç¨åºç¿çç¨</a>&nbsp;
éè¯»(<span id="post_view_count">130</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19488966);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19488966', targetLink: 'https://www.cnblogs.com/chengzp/p/19488966/stock-dashboard', title: 'æç¨ stock-sdk æå»ºäºä¸ä¸ªä¸ªäººä¸å±ç A è¡è¡æä»ªè¡¨ç' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ AI â JSON â UI ]]></title>
    <link>https://www.cnblogs.com/guangzan/p/19487446</link>
    <guid>50da358b9ff00137851738ca86276a9d</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/guangzan/p/19487446" title="åå¸äº 2026-01-15 15:23">
    <span role="heading" aria-level="2">AI â JSON â UI</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="èæ¯">èæ¯</h2>
<p>è¿å»ä¸¤å¹´ï¼AI çæ UI çå®è·µåºæ¬éä¸­å¨ä¸¤ç§è·¯å¾ä¸ãç¬¬ä¸ç§æ¯ç´æ¥è®©æ¨¡åçæ JSXãHTML æ CSSãè¿æ¡è·¯çº¿çä¼å¿å¨äºèªç±åº¦æé«ï¼æ¨¡åå ä¹ä¸åçº¦æï¼çèµ·æ¥âä»ä¹é½è½åâãä½å¨çå®å·¥ç¨ç¯å¢ä¸­ï¼è¿ç§æ¹å¼å ä¹ä¸å¯æ§ï¼è¾åºç»æä¸ç¨³å®ï¼æ æ³ä¿è¯ç»ä»¶è¾¹çï¼é¾ä»¥åæéä¸å®¡è®¡æ§å¶ï¼çæçä»£ç ç»å¸¸æ æ³ç¼è¯æè¿èå·¥ç¨çº¦å®ï¼æ´éè¦çæ¯ï¼å®ä¸å®éä¸å¡ä¸­çç»ä»¶ä½ç³»åè®¾è®¡ç³»ç»ä¸¥éè±èã</p>
<p>å¦ä¸æ¡è·¯çº¿æ¯ä½ä»£ç æ schema é©±å¨ UIï¼ä¾å¦åºäº JSON Schema æè¡¨å schema çæ¹æ¡ãè¿ç±»æ¹æ¡å¨å·¥ç¨ä¸æ¯å¯æ§çï¼ç»æç¨³å®ãå¯æ ¡éªãå¯å¤ç¨ï¼ä½å®ä»¬æ¬è´¨ä¸æ¯ä¸ºâäººç¼åéç½®âè®¾è®¡çï¼èä¸æ¯ä¸ºâæ¨¡åçæç»æâè®¾è®¡çãschema è¡¨è¾¾è½åæéï¼æ©å±ææ¬é«ï¼å¹¶ä¸ä¸èªç¶è¯­è¨ä¹é´çæ å°å¹¶ä¸èªç¶ï¼Prompt å¾å¾éè¦å¤§éäººå·¥çº¦æã</p>
<p>Vercel ååå¼æºäº json-renderï¼json-render çåºç°ï¼æ¬è´¨ä¸æ¯å¯¹è¿ä¸¤æ¡è·¯çº¿çéæ°ååä¸ç»åãå®å¹¶æ²¡æè¯å¾è®© AI ååç«¯ä»£ç ï¼ä¹æ²¡ææ AI éå¶å¨ä¼ ç»ä½ä»£ç  schema ä¸­ï¼èæ¯å¼å¥äºä¸ä¸ªä¸­é´å±ï¼<strong>JSON UI AST</strong>ãAI åªè½çæè¿ç§ ASTï¼è AST çè½åè¾¹çå®å¨ç±å¼åèå®ä¹ãæ¸²æãç¶æãè¡ä¸ºè§£éå¨é¨çå¨ä¸å¡ä¾§å®æãå¼åèå æ­¤å¯ä»¥å®å¨å°è®©ç¨æ·éè¿èªç¶è¯­è¨çæä»ªè¡¨çãå°é¨ä»¶ææ°æ®è§å¾ï¼èä¸éè¦ææ§è¡æäº¤ç»æ¨¡åã</p>
<p><img src="https://img2024.cnblogs.com/blog/1501373/202601/1501373-20260115152759556-1171653435.gif" alt="iShot_2026-01-15_15.25.26" loading="lazy"></p>
<h2 id="æ´ä½æ¶æjson-render-æ¯ä¸ä¸ª-dsl-è§£éç³»ç»">æ´ä½æ¶æï¼json-render æ¯ä¸ä¸ª DSL è§£éç³»ç»</h2>
<p>ä»æ¶æè§è§çï¼json-render å¹¶ä¸æ¯ä¸ä¸ª UI æ¡æ¶ï¼èæ¯ä¸ä¸ª DSL æ§è¡ç³»ç»ãç³»ç»ç±ä¸å±ææï¼æåºå±æ¯ Catalogï¼ç¨æ¥å£°æâç³»ç»åè®¸ AI ä½¿ç¨åªäº UI è½åâï¼ä¸­é´å±æ¯ JSON UI Treeï¼è¿æ¯ AI çå¯ä¸è¾åºå½¢å¼ï¼æä¸å±æ¯ Rendererï¼ç±ä¸å¡ä¾§å®ç°ï¼ç¨äºè§£é JSON å¹¶æ¸²æçå® UIã</p>
<p>å®ä»¬ä¹é´çå³ç³»å¯ä»¥ç¨ä¸é¢è¿å¼ ç»æå¾æ¥çè§£ï¼</p>
<pre><code>ââââââââââââââ
â   Prompt   â
âââââââ¬âââââââ
      â
      â¼
ââââââââââââââââââââ
â  LLM / AI Model  â
âââââââ¬âââââââââââââ
      â  JSON UI ASTï¼å Catalog ä¸¥æ ¼çº¦æï¼
      â¼
ââââââââââââââââââââ
â     Catalog      â  â è½åç½åå / Schema / Grammar
âââââââ¬âââââââââââââ
      â æ ¡éª + è§£æ
      â¼
ââââââââââââââââââââ
â    Renderer      â  â React / Vue / Native
âââââââ¬âââââââââââââ
      â
      â¼
ââââââââââââââââââââ
â   Real UI View   â
ââââââââââââââââââââ
</code></pre>
<p>å¨è¿ä¸ªæ¨¡åä¸­ï¼AI åªåä¸âç»æçæâï¼ä¸åä¸âæ§è¡âãè¿ä¹æ¯ json-render å¨å·¥ç¨ä¸æç«çæ ¹æ¬åå ã</p>
<h2 id="ä»-catalog-å°-ui">ä» Catalog å° UI</h2>
<h3 id="1-catalogç³»ç»çè½åè¾¹çå®ä¹">1. Catalogï¼ç³»ç»çè½åè¾¹çå®ä¹</h3>
<p>ä¸é¢è¿æ®µä»£ç æ¯æ´ä¸ªç³»ç»ä¸­æéè¦çå¥å£ï¼å®å®ä¹äº AI è½ä½¿ç¨çå¨é¨ UI è½åã</p>
<pre><code class="language-ts">import { createCatalog } from '@json-render/core'
import { z } from 'zod'

export const catalog = createCatalog({
  components: {
    Card: {
      props: z.object({
        title: z.string()
      }),
      hasChildren: true
    },
    Metric: {
      props: z.object({
        label: z.string(),
        valuePath: z.string(),
        format: z.enum(['number', 'currency', 'percent']).optional()
      })
    }
  },
  actions: {
    refresh: {
      params: z.object({})
    }
  }
})
</code></pre>
<p>è¿éæ²¡æä»»ä½ UI ä»£ç ï¼åªæè½åå£°æãprops ä½¿ç¨ Zod å®ä¹ï¼è¿æå³çå®ä¸ä»æ¯ç±»åæç¤ºï¼è¿åå«è¿è¡æ¶æ ¡éªè§åãå¦æä½ å¯¹ Zod æ²¡æäºè§£ï¼å¯ä»¥ççè¿ç¯åæï¼<a href="https://www.cnblogs.com/guangzan/p/19350726" target="_blank">Zodï¼TypeScript ç±»åå®å«ä¸æ°æ®éªè¯</a>ãaction å¹¶ä¸æ¯å½æ°å®ç°ï¼èæ¯ä¸ä¸ªâæå¾å£°æâï¼å®åªæè¿°âå¯ä»¥åçä»ä¹âï¼ä¸æè¿°âæä¹åçâã</p>
<p>Catalog å¨ç³»ç»ä¸­çå°ä½ï¼ç¸å½äºä¸é¨è¯­è¨çè¯­æ³å®ä¹æä»¶ãAI åç»­çæçææ JSONï¼æ¬è´¨ä¸é½å¿é¡»ç¬¦åè¿å¥ grammarã</p>
<h3 id="2-ai-è¾åºç-json-ui-ast">2. AI è¾åºç JSON UI AST</h3>
<p>å½ç¨æ·è¾å¥ç±»ä¼¼âçæä¸ä¸ªæ¶å¥ä»ªè¡¨çâçæç¤ºæ¶ï¼æ¨¡åçæçç»æä¸æ¯ JSXï¼èæ¯ä¸é¢è¿æ ·ç JSONï¼</p>
<pre><code class="language-json">{
  "type": "Card",
  "props": { "title": "Revenue Overview" },
  "children": [
    {
      "type": "Metric",
      "props": {
        "label": "Total Revenue",
        "valuePath": "/metrics/revenue",
        "format": "currency"
      }
    }
  ]
}
</code></pre>
<p>è¿ä¸ª JSON æå ä¸ªéå¸¸å³é®çç¹å¾ãå®ä¸åå«ä»»ä½å½æ°ãä¸åå«æ¡ä»¶è¡¨è¾¾å¼ãä¸åå«æ ·å¼æç¶æé»è¾ãå®åªæ¯ç»æåå°æè¿°âä½¿ç¨åªä¸ªç»ä»¶ï¼ç¨ä»ä¹åæ°ï¼ç»ä»¶ä¹é´å¦ä½åµå¥âãææè½åå®å¨æ¥æºäº Catalogï¼å æ­¤è¿ä¸ª JSON æ¯å¯æ ¡éªãå¯å­å¨ãå¯ diffãå¯å®¡è®¡ãå¯åæ¾çã</p>
<h3 id="3-rendererjson-çè§£éæ§è¡">3. Rendererï¼JSON çè§£éæ§è¡</h3>
<p>å¨ React ä¾§ï¼Renderer æ®æ¼çæ¯è§£éå¨çè§è²ã</p>
<pre><code class="language-tsx">import { Renderer } from '@json-render/react'
import { catalog } from './catalog'

function App() {
  return (
    &lt;Renderer
      catalog={catalog}
      components={{
        Card: ({ title, children }) =&gt; (
          &lt;div className="card"&gt;
            &lt;h2&gt;{title}&lt;/h2&gt;
            {children}
          &lt;/div&gt;
        ),
        Metric: ({ label, value }) =&gt; (
          &lt;div&gt;
            {label}: {value}
          &lt;/div&gt;
        )
      }}
      data={{
        metrics: { revenue: 120000 }
      }}
    /&gt;
  )
}
</code></pre>
<p>Renderer å¹¶ä¸å³å¿ UI é¿ä»ä¹æ ·ï¼å®åªåä¸ä»¶äºï¼æ ¹æ® type æ¾å°å¯¹åºç»ä»¶å®ä¹ï¼æ ¹æ® Catalog æ ¡éª props å childrenï¼æ ¹æ® valuePath ç­è§åå®ææ°æ®æ³¨å¥ã</p>
<h2 id="ä¸ºä»ä¹-json-render-æ¯å¯æ§ç">ä¸ºä»ä¹ json-render æ¯âå¯æ§çâ</h2>
<p>ä¸é¢çåå© AI è½ååæåºäº <code>vercel-labs/json-render</code> ä¸»ä»åºãå¦æä½ å¯¹æ­¤ä¸æå´è¶£ï¼è·³è¿è¿é¨ååå®¹ã</p>
<h3 id="1-createcatalogè½åè¢«å»ç»çèµ·ç¹">1. createCatalogï¼è½åè¢«å»ç»çèµ·ç¹</h3>
<p>æä»¶è·¯å¾ä½äº <code>packages/core/src/create-catalog.ts</code>ãè¿ä¸ªå½æ°çæ ¸å¿ä½ç¨ä¸æ¯âæ³¨åç»ä»¶âï¼èæ¯âå»ç»è½åè¾¹çâã</p>
<p>ç®ååçæ ¸å¿é»è¾å¯ä»¥çè§£ä¸ºï¼</p>
<pre><code class="language-ts">export function createCatalog(definition) {
  return {
    components: definition.components,
    actions: definition.actions,
    validateNode(node) {
      // æ ¡éª type æ¯å¦å­å¨
      // æ ¡éª props æ¯å¦ç¬¦å Zod schema
      // æ ¡éª children æ¯å¦è¢«åè®¸
    }
  }
}
</code></pre>
<p>æ¯ä¸è¡ä»£ç é½å¨æå¡ä¸ä¸ªç®æ ï¼è®© Catalog æä¸ºä¸ä¸ªä¸å¯çªç ´çç½ååãRenderer å AI é½æ æ³ç»è¿å®ãè¿ä¹æ¯ä¸ºä»ä¹ json-render æ Catalog æ¾å¨ core åä¸­ï¼èä¸æ¯ React åä¸­ã</p>
<h3 id="2-schema-æ ¡éªai-è¾åºå¿é¡»åç¼è¯åæ§è¡">2. Schema æ ¡éªï¼AI è¾åºå¿é¡»âåç¼è¯åæ§è¡â</h3>
<p>å¨ JSON Tree è¿å¥ Renderer ä¹åï¼ç³»ç»ä¼éèç¹æ ¡éªãtype æ¯å¦å¨ Catalog ä¸­å£°æï¼props æ¯å¦éè¿ Zod æ ¡éªï¼children æ¯å¦ç¬¦å hasChildren çº¦æï¼action æ¯å¦å­å¨äºç½ååãè¿ä¸è¿ç¨æ¬è´¨ä¸å°±æ¯ä¸æ¬¡ AST æ ¡éªã</p>
<p>è¿æå³ç AI çè¾åºä¸æ¯âè¿è¡æ¶æ¥éâï¼èæ¯âä¸éè¿å³æç»æ§è¡âãå¨ AI UI ç³»ç»ä¸­ï¼è¿æ¯ä¸ä¸ªæå¶å³é®ä½ç»å¸¸è¢«å¿½è§çå·¥ç¨ç¹ã</p>
<h3 id="3-rendererçæ­£çè§£éå¨æ¨¡å">3. Rendererï¼çæ­£çè§£éå¨æ¨¡å</h3>
<p>React Renderer çåé¨é»è¾å¹¶ä¸æ¯ç®åç switch-caseï¼èæ¯ä¸ä¸ªéå½è§£éè¿ç¨ãå®æ ¹æ®èç¹ç type æ¥ Catalogï¼æé  propsï¼è§£æ valuePath æ³¨å¥æ°æ®ï¼ç»å® action handlerï¼ç¶åéå½æ¸²æ childrenã</p>
<p>ä»æ¶æè§åº¦çï¼å®æ´æ¥è¿ä¸ä¸ª JSON AST Interpreterï¼èä¸æ¯æ¨¡æ¿å¼æãè¿ä¹æ¯ json-render å¯ä»¥è·¨ ReactãVueãNative å¤ç¨æ ¸å¿ææ³çåå ã</p>
<h3 id="4-valuepathå»æé¿å-ai-åä¸ç¶æé»è¾">4. valuePathï¼å»æé¿å AI åä¸ç¶æé»è¾</h3>
<p>valuePath ä½¿ç¨å­ç¬¦ä¸²è·¯å¾æè¿°æ°æ®ä¾èµï¼ä¾å¦ï¼</p>
<pre><code class="language-json">"valuePath": "/metrics/revenue"
</code></pre>
<p>è¿æ ·è®¾è®¡çç´æ¥ç»ææ¯ï¼AI ä¸éè¦çè§£ç¶æç»æï¼ä¹ä¸éè¦åä»»ä½ç¶æé»è¾ãRenderer ç»ä¸è´è´£è§£æè·¯å¾ãè¯»åæ°æ®ãè§¦åæ´æ°ãè¿å¨æ¶æä¸å»æåæ­äºâAI ç´æ¥æä½ç¶æâçå¯è½æ§ã</p>
<p>ä¸é¢æ¯ä»åå«æ°å¢åå®¹çè¡¥åç« èï¼éç¹æ¾å¨å¯è½å°æºç å±é¢çæºå¶ï¼é¿åæ¦å¿µåæè¿°ãç¤ºä¾ä»£ç ä¸è§£éååºäº <code>vercel-labs/json-render</code> å½åä»åºç»æä¸å®ç°æè·¯ã</p>
<h2 id="prompt-ä¸-catalog-çèªå¨å¯¹é½">Prompt ä¸ Catalog çèªå¨å¯¹é½</h2>
<p>Prompt ä¸ Catalog çèªå¨å¯¹é½ï¼ä¸æ¯âè° Promptâï¼èæ¯âå¯¼åº Grammarâãjson-render ä¸­ï¼Prompt ä¸ Catalog çå¯¹é½å¹¶ä¸æ¯éè¿äººè Prompt Engineering å®æçï¼èæ¯éè¿ä» Catalog æ´¾çä¸ä»½æºå¨å¯çè§£çè½åæè¿°ï¼å¹¶å°å¶æ³¨å¥å°æ¨¡åä¸ä¸æä¸­ãè¿ä¸ç¹å¨ <code>packages/core</code> ä¸­çè®¾è®¡éå¸¸å³é®ã</p>
<p>å¨ core å±ï¼Catalog æ¬èº«å¹¶ä¸æ¯ä¸ä¸ªç®åçå¯¹è±¡ï¼å®åå«äºå®æ´çç»ä»¶å®ä¹ãprops schema ä»¥å action æè¿°ãè¿äºä¿¡æ¯ä¼è¢«è½¬æ¢ä¸ºä¸ç§âæè¿°æ§ç»æâï¼ç¨äºåè¯æ¨¡åå½åç³»ç»æ¯æç UI grammarã</p>
<p>ç±»ä¼¼è¿æ ·çé»è¾ï¼</p>
<pre><code class="language-ts">export function catalogToPrompt(catalog) {
  return `
You can generate a JSON UI tree.
Available components:
${Object.entries(catalog.components).map(([name, def]) =&gt; `
- ${name}
  props: ${describeSchema(def.props)}
  hasChildren: ${def.hasChildren}
`).join('\n')}

Available actions:
${Object.keys(catalog.actions).join(', ')}

Rules:
- Output must be valid JSON
- Only use listed components
- Follow prop schemas strictly
`
}
</code></pre>
<p>è¿éçå³é®ç¹ä¸å¨äºå­ç¬¦ä¸²æ¬èº«ï¼èå¨äºä¿¡æ¯æ¥æºå®å¨æ¥èª Catalogãæ¢å¥è¯è¯´ï¼Catalog æ¯ single source of truthï¼Prompt åªæ¯å®çä¸ç§åºååè§å¾ãå½å¼åèæ°å¢æä¿®æ¹ç»ä»¶å®ä¹æ¶ï¼Prompt ä¸­åè®¸æ¨¡åä½¿ç¨çè½åä¼èªå¨åçååï¼ä¸å­å¨âä»£ç å Prompt ä¸ä¸è´âçé®é¢ãè¿ä¹æ¯ json-render è½å¤é¿åå¤§éâPrompt èåâçæ ¹æ¬åå ã</p>
<p>ä»æ¨¡åè§è§çï¼å®é¢å¯¹çä¸æ¯ä¸æ®µæ¨¡ç³çèªç¶è¯­è¨è¯´æï¼èæ¯ä¸å¥æ¥è¿ BNF ç UI grammar æè¿°ãæ¨¡åçæ JSON UI Tree çè¿ç¨ï¼æ¬è´¨ä¸ç±»ä¼¼äºå¨ç»å®è¯­æ³çº¦æä¸çæ ASTãè¿ä¹æ¯ä¸ºä»ä¹ json-render è¦ä½¿ç¨ Zod èä¸æ¯ä»é  TypeScript ç±»åãZod schema å¯ä»¥è¢«åæ¶ç¨äºè¿è¡æ¶æ ¡éªå Prompt è¯­ä¹æè¿°ï¼å½¢æé­ç¯ã</p>
<h2 id="streaming-ui-çå®ç°ç»è">Streaming UI çå®ç°ç»è</h2>
<p>æµå¼æå»º ASTï¼èä¸æ¯æµå¼æ¼å­ç¬¦ä¸²ãjson-render ç Streaming UI è½åï¼æ ¸å¿å¹¶ä¸å¨âæ¨¡åæ¯ææµå¼è¾åºâï¼èå¨äº UI çä¸­é´è¡¨ç¤ºæ¯å¯å¢éåå¹¶ç JSON ASTãè¿ä¸ç¹å¨ React åä¸­çå®ç°éå¸¸æ¸æ°ã</p>
<p>å¨ <code>packages/react</code> ä¸­ï¼å¯ä»¥çå°ç±»ä¼¼ <code>useUIStream</code> ç hookï¼å¶æ ¸å¿èè´£æ¯ï¼<br>
ç»´æ¤ä¸æ£µå½å UI Treeï¼å¹¶å¨æ¨¡åæµå¼è¾åºæ¶ä¸æ­åè¿æ£µæ ä¸­åå¹¶æ°èç¹ã</p>
<p>ç®ååçåé¨ç»æå¤§è´å¦ä¸ï¼</p>
<pre><code class="language-ts">// packages/react/src/use-ui-stream.tsï¼æ¦å¿µç»æï¼
export function useUIStream() {
  const [tree, setTree] = useState&lt;UITree | null&gt;(null)

  function onChunk(chunk: string) {
    const partialNode = parseChunkToNode(chunk)
    if (!partialNode) return

    setTree(prevTree =&gt; {
      return mergeTree(prevTree, partialNode)
    })
  }

  return { tree, onChunk }
}
</code></pre>
<p>è¿éæä¸¤ä¸ªéå¸¸å³é®ä½å®¹æè¢«å¿½ç¥çç¹ã</p>
<p><code>parseChunkToNode</code> å¹¶ä¸æ¯ç®åç <code>JSON.parse</code>ãæ¨¡åå¨ streaming æ¨¡å¼ä¸è¾åºçéå¸¸æ¯ä¸å®æ´ JSONï¼å æ­¤ json-render éç¨çæ¯éæ®µè§£æãå»¶è¿æåçç­ç¥ãåªæå½ä¸ä¸ªèç¹å¨ç»æä¸æ¯å®æ´ä¸éè¿ Catalog æ ¡éªæ¶ï¼æä¼è¢«æåä¸ºâå¯åå¹¶èç¹âã<code>mergeTree</code> æ¯ä¸ä¸ªçº¯å½æ°ãå®ä¸ä¾èµå¤é¨ç¶æï¼åªæ ¹æ®å·²æ UI Tree åæ°èç¹çæä¸ä¸æ£µ Treeãè¿ä½¿å¾æ¯ä¸æ¬¡æ´æ°é½æ¯ç¡®å®æ§çï¼ä¹å¤©ç¶éå React çç¶ææ¨¡åã</p>
<p>å¨ Renderer å±ï¼è¿æ£µ Tree ä¼è¢«ç´æ¥ç¨äºéå½æ¸²æï¼</p>
<pre><code class="language-tsx">function RenderNode({ node }) {
  const Component = components[node.type]

  const resolvedProps = resolveProps(node.props)
  const children = node.children?.map(child =&gt;
    &lt;RenderNode key={child.id} node={child} /&gt;
  )

  return &lt;Component {...resolvedProps}&gt;{children}&lt;/Component&gt;
}
</code></pre>
<p>ç±äº Tree å§ç»æ¯âå·²æ ¡éªçåæ³ç»æâï¼Renderer ä¸éè¦å³å¿èç¹æ¯å¦å®æ´ï¼åªéè¦å³å¿âå½åæåªäºèç¹å·²ç»å­å¨âãè¿ä¹æ¯ Streaming UI è½å¨çææªå®ææ¶å°±å®å¨æ¸²æçæ ¹æ¬åå ã</p>
<h2 id="streaming-ä¸-catalog-æ ¡éªå¦ä½ååå·¥ä½">Streaming ä¸ Catalog æ ¡éªå¦ä½ååå·¥ä½</h2>
<p>Streaming UI å¹¶ä¸æ¯ç»è¿æ ¡éªæºå¶çæ·å¾ï¼æ°æ°ç¸åï¼å®ä¾èµæ ¡éªæºå¶æè½æç«ãå¨å®éæµç¨ä¸­ï¼æ¯ä¸ä¸ªåéèç¹å¨è¢«åå¹¶è¿ UI Tree ä¹åï¼é½ä¼ç»è¿ Catalog çæ ¡éªé»è¾ï¼</p>
<pre><code class="language-ts">// packages/core/src/validate-node.tsï¼æ¦å¿µç»æï¼
export function validateNode(node, catalog) {
  const def = catalog.components[node.type]
  if (!def) throw new Error('Unknown component')

  def.props.parse(node.props)

  if (node.children &amp;&amp; !def.hasChildren) {
    throw new Error('Children not allowed')
  }
}
</code></pre>
<p>Streaming æ¨¡å¼ä¸ï¼è¿ä¸ªæ ¡éªåçå¾æ´é¢ç¹ï¼ä½ç²åº¦æ´å°ãç³»ç»å®å¯âææ¶ä¸æ¸²æâï¼ä¹ä¸ä¼æä¸ä¸ªéæ³èç¹äº¤ç» Rendererãè¿ä¿è¯äº UI å¨ä»»ä½æ¶å»é½æ¯ä¸ä¸ªåæ³å­éï¼èä¸æ¯åæååå¾ç¶æã</p>
<p>Prompt ä¸ Catalog çèªå¨å¯¹é½ï¼ç¡®ä¿æ¨¡åâä¸ä¼å¹»æ³ä¸å­å¨çè½åâï¼Streaming UI ç AST çº§å¢éæå»ºï¼ç¡®ä¿ UIâå¯ä»¥å¨ä¸å®æ´æ¶ä»ç¶æ­£ç¡®è¿è¡âãä¸¤èç»åï¼ä½¿ json-render çæ§è¡æ¨¡åæ´æ¥è¿ç¼è¯å¨ä¸è§£éå¨ï¼èä¸æ¯æ¨¡æ¿çæå¨ãä»å·¥ç¨è§è§çï¼è¿æå³çä¸ä¸ªéè¦è½¬åï¼<strong>UI çæä¸åæ¯ä¸æ¬¡æ§ç»æï¼èæ¯ä¸ä¸ªå¯è§å¯ãå¯ä¸­æ­ãå¯åæ»çè¿ç¨ã</strong>è¿ä¹æ¯ json-render è½å¤çæ­£è¿å¥çäº§ç³»ç»ï¼èä¸ä»åçå¨ Demo å±é¢çæ ¹æ¬åå ã</p>
<h2 id="json-render-çæ­£è§£å³äºä»ä¹">json-render çæ­£è§£å³äºä»ä¹</h2>
<p>json-render æ¬èº«å¹¶ä¸æ¯ä¸ç§å¨æ°çææ¯èå¼ã<strong>âç¨åéç»ææè¿° UIï¼åç±è¿è¡æ¶è§£éæ§è¡âè¿ä¸ææ³ï¼å¨åç«¯å·¥ç¨ä¸­æ©å·²åå¤åºç°è¿ã</strong>æ©æç JSON Schema Formãreact-jsonschema-formãFormilyãæ¬è´¨ä¸é½æ¯ç¨ç»æåæ°æ®æè¿°çé¢ï¼åç±æ¸²æå¨çæçå® UIãä½ä»£ç å¹³å°ãæ­å»ºç³»ç»ãéç½®ååå°ï¼å ä¹å¨é¨å»ºç«å¨åä¸é»è¾ä¹ä¸ãå³ä¾¿å¨ AI åºç°ä¹åï¼è¿ç§æ¨¡å¼ä¹å·²ç»éå¸¸æçï¼å·¥ç¨å¸éè¿ schema æè¿°ç»ä»¶ãå±æ§åå¸å±ï¼è¿è¡æ¶è´è´£æ ¡éªä¸æ¸²æï¼ä¸å¡ä¾§åªæä½ç»æèä¸ç´æ¥è§¦ç¢°ä»£ç ãjson-render å¹¶æ²¡æåæè¿ç§æ¨¡å¼ï¼å®ç»§æ¿çæ­£æ¯è¿ä¸æ´æ¡ææ¯èç»ã</p>
<p>json-render çä¸åä¹å¤å¨äºï¼å®é¦æ¬¡æâæ¨¡åçæâä½ä¸ºä¸ç­å¬æ°çº³å¥è®¾è®¡åæãä¼ ç» schema UI åè®¾éç½®ç±äººç¼åï¼å æ­¤æ´å¼ºè°å®æ´æ§ãå¯è¯»æ§åç¼è¾ä½éªï¼è json-render åè®¾ç»æç±æ¨¡åçæï¼å æ­¤æ´å¼ºè°è¯­æ³è¾¹çæ¸æ°ãå¤±è´¥å¯æ¢å¤ãé¨åç»æå¯æ§è¡ï¼ä»¥åä¸ Prompt çèªå¨å¯¹é½è½åãä»è¿ä¸ªè§åº¦çï¼json-render æ´åæ¯âä¸º AI éæ°è®¾è®¡çä¸ä»£ schema UI æ§è¡æ¨¡åâãå®çæ­£è§£å³çé®é¢å¹¶ä¸æ¯âæä¹ç¨ JSON æ¸²æ UIâï¼èæ¯å½ç»ææ¥æºåæä¸å¯é çæ¨¡åæ¶ï¼å·¥ç¨è¾¹çåºè¯¥å¨åªéãå®ç»åºçç­æ¡éå¸¸æç¡®ï¼AI åªè´è´£çæç»æåæå¾ï¼å·¥ç¨å¸è´è´£è½åå®ä¹ãæ§è¡ä¸æ¸²æï¼JSON ä½ä¸ºå¯ä¸ä¸­ä»åçº¦æå±ãè¿ä½¿å¾ AI UI ä¸åæ¯ä¸æ¬¡æ§ Demoï¼èæ¯å¯ä»¥è¿å¥çäº§ç³»ç»çå·¥ç¨è½åãå¨å½åé¶æ®µï¼è¿æ¯å°æ°çæ­£ç«å¨å·¥ç¨ç«åºæè AI UI çæ¹æ¡ä¹ä¸ã</p>
<h2 id="åèèµæ">åèèµæ</h2>
<ul>
<li><a href="https://json-render.dev/" target="_blank" rel="noopener nofollow">json-render.dev</a></li>
<li><a href="https://github.com/vercel-labs/json-render" target="_blank" rel="noopener nofollow">github.com/vercel-labs/json-render</a></li>
<li><a href="https://vercel.com/blog" target="_blank" rel="noopener nofollow">vercel.com/blog</a></li>
<li><a href="https://www.cnblogs.com/guangzan/p/19350726" target="_blank">Zodï¼TypeScript ç±»åå®å«ä¸æ°æ®éªè¯</a></li>
</ul>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.004166666666666667" data-date-updated="2026-01-15 15:29">2026-01-15 15:23</span>&nbsp;
<a href="https://www.cnblogs.com/guangzan">guangzan</a>&nbsp;
éè¯»(<span id="post_view_count">316</span>)&nbsp;
è¯è®º(<span id="post_comment_count">2</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19487446);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19487446', targetLink: 'https://www.cnblogs.com/guangzan/p/19487446', title: 'AI â JSON â UI' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>