<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2025-12-24T01:15:29.360Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ ç¨äºMySQLçINSERT ON DUPLICATE KEY UPDATEï¼æä¹è¿æ¥å¯ä¸ç´¢å¼å²çªéè¯¯ ]]></title>
    <link>https://www.cnblogs.com/youzhibing/p/19388304</link>
    <guid>1ee3290ce7f520e2807586f39e1b6f15</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/youzhibing/p/19388304" title="åå¸äº 2025-12-24 09:00">
    <span role="heading" aria-level="2">ç¨äºMySQLçINSERT ON DUPLICATE KEY UPDATEï¼æä¹è¿æ¥å¯ä¸ç´¢å¼å²çªéè¯¯</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="å¼å¿ä¸å»">å¼å¿ä¸å»</h2>
<p>ä¸å¤©ï¼èå©ç¬å®¹æ»¡é¢çå²å°æé¢å<br>
èå©ï¼ä½ å¨¶æå°åºæ¯å¾æå¥<br>
æï¼ä¾¿å®<br>
èå©ç¬å®¹ç¬é´æ¶å¤±ï¼æ°å¼å¼çéï¼ä½ ä¼ä¸ä¼è¯´è¯ï¼<br>
å¹¶ä¸å¼ºè°ï¼æç¸å½å¹´é£æ¯å¯æä½ ï¼æ²¡è·ä½ å¤è¦<br>
æï¼ä¸æ¯ï¼ä½ ç¸ä¸æ¯è¿ä¹è¯´ç<br>
èå©ï¼é£æä¹è¯´ç<br>
æå¼å§å­¦çèä¸äººçå£å»ï¼ä¸è®¸éï¼ç»ä½ ä¾¿å®ç¹</p>
<div align="center"><img src="https://img2024.cnblogs.com/blog/747662/202512/747662-20251223173616476-1594142117.gif" alt="å¼å¿ä¸å»"></div>
<h2 id="insert-on-duplicate-key-update">INSERT ON DUPLICATE KEY UPDATE</h2>
<p>å³äº <code>INSERT ... ON DUPLICATE KEY UPDATE</code>ï¼ç¸ä¿¡å¤§å®¶é½ææäºè§£ï¼æ¯ <code>MySQL</code> éå¯¹</p>
<blockquote>
<p>ä¸å­å¨åæå¥ï¼å­å¨åæ´æ°</p>
</blockquote>
<p>çä¸ç§æ¹è¨å®ç°ï¼<code>å­ä¸å­å¨</code> è¯¥å¦ä½å¤å®å¢ï¼åºäºè¡¨ç <code>å¯ä¸ç´¢å¼</code> æ <code>ä¸»é®</code></p>
<p>ä¸¾ä¸ªä¾å­ï¼å¦æå <code>a</code> è¢«å£°æä¸º <code>å¯ä¸</code> ä¸è¡¨ä¸­å·²ç»å­å¨ <code>a=1</code> çè®°å½ï¼åä»¥ä¸ä¸¤æ¡è¯­å¥å·æç±»ä¼¼çææ</p>
<pre><code class="language-sql">INSERT INTO t1 (a,b,c) VALUES (1,2,3)
  ON DUPLICATE KEY UPDATE c=c+1;

UPDATE t1 SET c=c+1 WHERE a=1;
</code></pre>
<p>åè®¾æä»¬æè¡¨</p>
<pre><code class="language-sql">CREATE TABLE `tbl_insert_on_update` (
  `id` bigint NOT NULL,
  `name` varchar(255) NOT NULL,
  `uk_column1` varchar(255) NOT NULL,
  `uk_column2` varchar(255) NOT NULL,
  `remark` text,
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=InnoDB
</code></pre>
<p>ä¸å¼å§è¡¨ä¸­æ²¡ææ°æ®ï¼é£ä¹</p>
<pre><code class="language-sql">INSERT tbl_insert_on_update(id, name, uk_column1, uk_column2, remark)
VALUES(1, 'å¼ ä¸', '20050101001', 'ç·ä¸å·', 'é£ä¸æ ·çç·å­')
ON DUPLICATE KEY UPDATE uk_column1='20050101002', uk_column2='ç·äºå·', remark='çé£ä¸æ ·çç·å­';
</code></pre>
<p>çä½ç¨ï¼ç¸ä¿¡å¤§å®¶é½ç¥éï¼ä¸</p>
<pre><code class="language-sql">INSERT tbl_insert_on_update(id, name, uk_column1, uk_column2, remark)
VALUES(1, 'å¼ ä¸', '20050101001', 'ç·ä¸å·', 'é£ä¸æ ·çç·å­');
</code></pre>
<p>ä½ç¨ä¸æ ·ï¼ä¼å¾è¡¨ä¸­æå¥ä¸æ¡æ°çè®°å½ï¼å¦æåæ§è¡ä¸æ¬¡</p>
<pre><code class="language-sql">INSERT tbl_insert_on_update(id, name, uk_column1, uk_column2, remark)
VALUES(1, 'å¼ ä¸', '20050101001', 'ç·ä¸å·', 'é£ä¸æ ·çç·å­')
ON DUPLICATE KEY UPDATE uk_column1='20050101002', uk_column2='ç·äºå·', remark='çé£ä¸æ ·çç·å­';
</code></pre>
<p>å¢ï¼ä¼æ¯æä¹æ ·çç»æï¼ç¸ä¿¡å¤§å®¶é½ç¥é</p>
<div align="center"><img src="https://img2024.cnblogs.com/blog/747662/202512/747662-20251223173615289-1171352990.png" alt="insert_on_update_åæ§è¡ä¸æ¬¡"></div>
<p>ä¸</p>
<pre><code class="language-sql">UPDATE tbl_insert_on_update SET uk_column1='20050101002', uk_column2='ç·äºå·', remark='çé£ä¸æ ·çç·å­' WHERE id = 1;
</code></pre>
<p>çææä¸æ ·ãæä»¬æ¥çåä¸ªç®åè°æ´ï¼æ¿æ <code>name</code></p>
<pre><code class="language-sql">INSERT tbl_insert_on_update(id, uk_column1, uk_column2, remark)
VALUES(1, '20050101001', 'ç·ä¸å·', 'é£ä¸æ ·çç·å­')
ON DUPLICATE KEY UPDATE uk_column1='20050101003', uk_column2='ç·ä¸å·', remark='æ´é£ä¸æ ·çç·å­';
</code></pre>
<p>æèæ¿æ <code>id</code></p>
<pre><code class="language-sql">INSERT tbl_insert_on_update(name, uk_column1, uk_column2, remark)
VALUES('å¼ ä¸', '20050101001', 'ç·ä¸å·', 'é£ä¸æ ·çç·å­')
ON DUPLICATE KEY UPDATE uk_column1='20050101003', uk_column2='ç·ä¸å·', remark='æ´é£ä¸æ ·çç·å­';
</code></pre>
<p>ä¼æ¯æä¹æ ·çä¸ä¸ªç»æï¼ä½ ä»¬å¯ä»¥å¤§èçä¸ä¸ãè¿ä¸¤ä¸ª SQL çæ§è¡ç»ææ¯ä¸æ ·ç</p>
<div align="center"><img src="https://img2024.cnblogs.com/blog/747662/202512/747662-20251223173615313-938765406.png" alt="ç·ä¸æµ©"></div>
<p>æ­¤æ¶ä½ ä»¬æ¯ä¸æ¯æçé®å¢</p>
<blockquote>
<p>ä¸ºä»ä¹æ¿æ <code>name</code> åæ¿æ <code>id</code> ç INSERT ... ON DUPLICATE KEY UPDATE çæ§è¡ç»æä¼æ¯ä¸æ ·çï¼</p>
</blockquote>
<p>è¿ä¸ªé®é¢åæ¾ä¸æ¾ï¼æä»¬åå½å¥å¥³ä¸å·çæ°æ®</p>
<pre><code class="language-sql">INSERT tbl_insert_on_update(id, name, uk_column1, uk_column2, remark)
VALUES(2, 'å©å¿', '20050101001X', 'å¥³ä¸å·', 'è±ä¸æ ·çå¥³å­');
</code></pre>
<p>åè®¾æä»¬è¦ä¿®æ¹å¥³ä¸å·çä¿¡æ¯ï¼åæ¬ <code>å§å</code>ï¼æ¯ä¸æ¯å¯ä»¥è¿ä¹å®ç°</p>
<pre><code class="language-sql">INSERT tbl_insert_on_update(id, name, uk_column1, uk_column2, remark)
VALUES(2, 'å©å¿', '20050101001X', 'å¥³ä¸å·', 'è±ä¸æ ·çå¥³å­')
ON DUPLICATE KEY UPDATE, name='å¼ ä¸', uk_column1='20050101002X', uk_column2='å¥³äºå·', remark='çµçè±ä¸æ ·çå¥³å­';
</code></pre>
<p>æä»ä¹é®é¢åï¼æ§è¡ä¸å°±ç¥éäºå</p>
<div align="center"><img src="https://img2024.cnblogs.com/blog/747662/202512/747662-20251223173615530-841103305.png" alt="å¯ä¸ç´¢å¼å²çª" width="90%"></div>
<p>æ§è¡æ¥éäºï¼æç¤º</p>
<blockquote>
<p>1062 - Duplicate entry 'å¼ ä¸' for key 'tbl_insert_on_update.name'</p>
</blockquote>
<p>è¿ä¸ªéè¯¯ä¿¡æ¯æä»¬æ¯ä¸æ¯å¾çæï¼ä¸å°±æ¯å¯ä¸ç´¢å¼å²çªåï¼é£ä¹é®é¢åæ¥äº</p>
<blockquote>
<p>ç¨äºMySQLçINSERT ON DUPLICATE KEY UPDATEï¼ä¸ºä»ä¹è¿ä¼å¯ä¸ç´¢å¼å²çªï¼</p>
</blockquote>
<h2 id="å¦ä½å¤æ­æ¯å¦å­å¨">å¦ä½å¤æ­æ¯å¦å­å¨</h2>
<p>æä»¬å <code>INSERT ... ON DUPLICATE KEY UPDATE</code> è¯­å¥æ¶ï¼å¹¶æªæå®ç¨åªä¸ª <code>ä¸»é®</code> æè <code>å¯ä¸ç´¢å¼</code> æ¥å¤å®è®°å½æ¯å¦å­å¨</p>
<blockquote>
<p>OracleãSQL ServerãPostgreSQL ç <code>MERGE</code> æç±»ä¼¼ä½ç¨</p>
<pre><code class="language-sql">MERGE INTO TBL_INSERT_ON_UPDATE t
USING (
    SELECT 1 AS ID, 'å¼ ä¸' AS NAME, '20050101001' AS UK_COLUMN1, 'ç·ä¸å·' AS UK_COLUMN2, 'é£ä¸æ ·çç·å­' AS REMARK FROM dual
) s
ON (t.NAME = s.NAME)  -- åºäº NAME å­æ®µå¹é
WHEN MATCHED THEN
    UPDATE SET
        t.ID = s.ID,
        t.UK_COLUMN1 = s.UK_COLUMN1,
        t.UK_COLUMN2 = s.UK_COLUMN2,
        t.REMARK = s.REMARK
WHEN NOT MATCHED THEN
    INSERT (ID, NAME, UK_COLUMN1, UK_COLUMN2, REMARK)
    VALUES (s.ID, s.NAME, s.UK_COLUMN1, s.UK_COLUMN2, s.REMARK);
</code></pre>
<p>å¶ä¸­ç <code>ON</code>  æç¡®æå®å¹éå­æ®µï¼æ ¹æ®åªäºå­æ®µå¤æ­è®°å½æ¯å¦å­å¨ï¼ï¼ä¸è¬æ¯æå® <code>ä¸»é®</code>å­æ®µæ <code>å¯ä¸ç´¢å¼</code>å­æ®µ</p>
</blockquote>
<p>é£ MySQL æ¯å¦ä½å¤å®è®°å½æ¯å¦å­å¨çå¢ï¼æä»¬å¯ä»¥ç¿»éä¸å®æ¹ææ¡£ï¼<a href="https://dev.mysql.com/doc/refman/8.0/en/insert-on-duplicate.html" target="_blank" rel="noopener nofollow">INSERT ... ON DUPLICATE KEY UPDATE Statement</a>ãä¸å¼å¤´æå¦ä¸ä¸æ®µæè¿°</p>
<blockquote>
<p>If you specify an <code>ON DUPLICATE KEY UPDATE</code> clause and a row to be inserted would cause a duplicate value in a <code>UNIQUE</code> index or <code>PRIMARY KEY</code>, an <a href="https://dev.mysql.com/doc/refman/8.0/en/update.html" target="_blank" rel="noopener nofollow"><code>UPDATE</code></a> of the old row occurs</p>
<p>å½æä»¬ä½¿ç¨ <code>ON DUPLICATE KEY UPDATE</code>  å­å¥æ¶ï¼æå¥çè¡å¯¼è´ <code>å¯ä¸</code> ç´¢å¼æè <code>ä¸»é®</code> éå¤æ¶ï¼ä¼æ´æ°æ§çè¡</p>
</blockquote>
<p>éè¿è¿æ®µè¯ï¼æä»¬åªç¥é MySQL æ¯æ ¹æ®å¯ä¸ç´¢å¼æä¸»é®æ¥å¤å®è¡æ¯å¦å­å¨ï¼å¹¶ä¸ç¥é</p>
<ol>
<li>åæ ¹æ®ä¸»é®å¤å®ï¼ä¸å²çªä¹ååæ ¹æ®å¯ä¸ç´¢å¼å¤å®ï¼</li>
<li>æå¤ä¸ªå¯ä¸ç´¢å¼æ¶ï¼è¿äºå¯ä¸ç´¢å¼çå¤å®ä¼åçº§æ¯ææ ·çï¼</li>
</ol>
<p>å®æ¹ææ¡£éé¢å¹¶æªæç¡®è¯´æè¿äºé®é¢ï¼åªæ¯å¨ç»å°¾è¿è¡äºå¦ä¸è¯´æ</p>
<blockquote>
<p>An <a href="https://dev.mysql.com/doc/refman/8.0/en/insert-on-duplicate.html" target="_blank" rel="noopener nofollow"><code>INSERT ... ON DUPLICATE KEY UPDATE</code></a> statement against a table having more than one unique or primary key is also marked as unsafe. (Bug #11765650, Bug #58637)</p>
<p>å½è¡¨ä¸­æå¤ä¸ªå¯ä¸ç´¢å¼æèä¸»é®æ¶ï¼INSERT ... ON DUPLICATE KEY UPDATE è¯­å¥ä¸å®å¨</p>
</blockquote>
<p>ä¸å®å¨ä»£è¡¨æ§è¡ç»æä¸åºå®ï¼ä¼åºç°æä»¬é¢æä¹å¤çç»æ</p>
<h2 id="å·¥ä½åç">å·¥ä½åç</h2>
<p>å¦æè®©ä½ ä»¬æ¥å®ç° <code>ä¸å­å¨åæå¥ï¼å­å¨åæ´æ°</code>ï¼ä½ ä»¬ä¼æä¹å®ç°ï¼</p>
<p>éä¸ªæ¥è¯¢ä¸»é®ä»¥åææå¯ä¸ç´¢å¼ï¼å¤æ­è¯¥è¡æ°æ®æ¯å¦å­å¨ï¼ä¸æ¦å­å¨åæ ¹æ®éå¤çä¸»é®æèå¯ä¸ç´¢å¼è¿è¡ <code>UPDATE</code>ï¼é½ä¸å­å¨åè¿è¡ <code>INSERT</code>ï¼è¿ä¸ä»æ¯ä½ ä»¬æå®¹ææ³å°çå®ç°æ¹å¼ï¼ä¹æ¯ææå®¹ææ³å°çæ¹å¼ã</p>
<p>ä½ MySQL å¹¶æªéç¨è¿ç§æ¹å¼ï¼èæ¯éç¨äºå¦å¤ä¸ç§æ´é«æçæ¹å¼ï¼åå°è¯æå¥ï¼å­å¨å¼æä¼å<strong>ææç¸å³çå¯ä¸ç´¢å¼ï¼åæ¬ä¸»é®ï¼</strong> ä¸­æå¥å¯¹åºçç´¢å¼æ¡ç®ï¼å¦æé½æå¥æåï¼è¯´ææ°æ®è¡ä¸å­å¨ï¼é£ä¹ <code>INSERT</code> æ°æ®è¡ï¼ä¸æ¦å­å¨å¼æå°è¯æå¥æä¸ªå¯ä¸ç´¢å¼æ¶ï¼åç°è¯¥æ°æ®è¡å·²ç»å­å¨ï¼ä¼ç«å³åæ­¢æå¥å¨ä½ï¼å¹¶åMySQLæå¡å±æåº <code>éå¤é®</code> éè¯¯ï¼æå¡å±æ¶å°éå¤é®éè¯¯åï¼å¹¶ä¸ä¼è®©æ´ä¸ªè¯­å¥å¤±è´¥ï¼å ä¸ºä½¿ç¨äº ON DUPLICATE KEY UPDATE å­å¥ï¼ï¼èæ¯è½¬æ¢æ§è¡æ¨¡å¼ï¼ä¼ååæ»ä¹åçæå¥ï¼ç¶åæ ¹æ®éå¤çé£ä¸ªå¯ä¸ç´¢å¼æ¾å°æ°æ®è¡å¯¹åºç <code>æ§è¡</code> æ°æ®ï¼æå <code>UPDATE</code> æ°æ®è¡ï¼æ»ç»ä¸æ¥åä¸æ­¥</p>
<ol>
<li>
<p>å°è¯æå¥</p>
<p>ææå¯ä¸ç´¢å¼ï¼åæ¬ä¸»é®ï¼é½æå¥æåï¼åæå¥æ°æ®è¡ï¼ç¸å½äºå®ææ®éç <code>INSERT</code></p>
<p>ä¸æ¦æä¸ªå¯ä¸ç´¢å¼æå¥å¤±è´¥ï¼åç«å³åæ­¢æå¥ï¼å­å¨å¼æä¼åä¸å±æåºä¸ä¸ª <code>éå¤é®</code> éè¯¯</p>
</li>
<li>
<p>æ¨¡å¼è½¬æ¢</p>
<p>MySQLæå¡å¨æ¶å°éå¤é®åï¼åç°æ§è¡è¯­å¥ä¸­æ <code>ON DUPLICATE KEY UPDATE</code> å­å¥ï¼ä¸ä¼ç´æ¥è®©æ´ä¸ªè¯­å¥å¤±è´¥ï¼èæ¯ååæ»ä¹åçé£é¨åå¯ä¸ç´¢å¼çæå¥ï¼ç¶åæ ¹æ®æå¥å¤±è´¥çå¯ä¸ç´¢å¼æ¾å°å·²ç»å­å¨ç <code>æ§è¡</code></p>
</li>
<li>
<p>æ§è¡æ´æ°</p>
<p>æ ¹æ®æå¥å¤±è´¥çå¯ä¸ç´¢å¼ï¼å¯¹æ§è¡æ§è¡æ´æ°æä½ï¼ç¸å½äºå®ææ®éç <code>UPDATE</code></p>
</li>
</ol>
<p>æ´ä¸ª <code>å°è¯-å¤±è´¥-è½¬æ¢-æ´æ°</code> è¿ç¨æ¶ä¸ä¸ªåå­æä½ï¼é£ä¹å®å¨æåï¼è¦ä¹å®å¨å¤±è´¥ï¼ç¸æ¯äº <code>åæ¥è¯¢åå¤æ­</code> çä¼ ç»å®ç°ï¼è¿ç§å®ç°æ¹å¼æçæ´é«ã</p>
<h2 id="é®é¢ç­ç">é®é¢ç­ç</h2>
<p>åé¢æ¶åå°ä¸¤ä¸ªé®é¢ï¼ç°å¨æä»¬æ¥è§£æä¸</p>
<ol>
<li>
<p>ä¸ºä»ä¹æ¿æ <code>name</code> åæ¿æ <code>id</code> ç INSERT ... ON DUPLICATE KEY UPDATE çæ§è¡ç»æä¼æ¯ä¸æ ·çï¼</p>
<pre><code class="language-sql">-- æ¿æname
INSERT tbl_insert_on_update(id, uk_column1, uk_column2, remark)
VALUES(1, '20050101001', 'ç·ä¸å·', 'é£ä¸æ ·çç·å­')
ON DUPLICATE KEY UPDATE uk_column1='20050101003', uk_column2='ç·ä¸å·', remark='æ´é£ä¸æ ·çç·å­';

-- æ¿æid
INSERT tbl_insert_on_update(name, uk_column1, uk_column2, remark)
VALUES('å¼ ä¸', '20050101001', 'ç·ä¸å·', 'é£ä¸æ ·çç·å­')
ON DUPLICATE KEY UPDATE uk_column1='20050101003', uk_column2='ç·ä¸å·', remark='æ´é£ä¸æ ·çç·å­';
</code></pre>
<p>è¿ä¸ªé®é¢æ¯ä¸æ¯å¾ç®åï¼æä»¬ä¸èµ·æ¥åæä¸</p>
<pre><code class="language-sql">INSERT tbl_insert_on_update(id, uk_column1, uk_column2, remark)
VALUES(1, '20050101001', 'ç·ä¸å·', 'é£ä¸æ ·çç·å­')
ON DUPLICATE KEY UPDATE uk_column1='20050101003', uk_column2='ç·ä¸å·', remark='æ´é£ä¸æ ·çç·å­';
</code></pre>
<p>INSERT çå­æ®µä¸­æ²¡æ <code>name</code>ï¼ä½æ <code>id</code>ï¼å¯æ³èç¥å¤æ­æ°æ®è¡æ¯å¦å­å¨ï¼ç¨å°çæ¯ <code>ä¸»é®</code>ï¼å ä¸º <code>id=1</code> çè®°å½å·²ç»å­å¨ï¼æä»¥æ ¹æ® id å»æ´æ°å¶ä»å­æ®µå¼ï¼é£ä¹æ§è¡ç»æä¸å¦ä¸ SQL ä¸è´</p>
<pre><code class="language-sql">UPDATE tbl_insert_on_update SET uk_column1='20050101003', uk_column2='ç·ä¸å·', remark='æ´é£ä¸æ ·çç·å­' WHERE id = 1;
</code></pre>
<p>åç</p>
<pre><code class="language-sql">INSERT tbl_insert_on_update(name, uk_column1, uk_column2, remark)
VALUES('å¼ ä¸', '20050101001', 'ç·ä¸å·', 'é£ä¸æ ·çç·å­')
ON DUPLICATE KEY UPDATE uk_column1='20050101003', uk_column2='ç·ä¸å·', remark='æ´é£ä¸æ ·çç·å­';
</code></pre>
<p>INSERT çå­æ®µä¸­æ²¡æ <code>id</code>ï¼ä½æ <code>name</code>ï¼å¯æ³èç¥å¤æ­æ°æ®è¡æ¯å¦å­å¨ï¼ç¨å°çæ¯ <code>å¯ä¸ç´¢å¼</code>ï¼å ä¸º <code>name=å¼ ä¸</code> çè®°å½å·²ç»å­å¨ï¼æä»¥æ ¹æ® name å»æ´æ°å¶ä»å­æ®µå¼ï¼é£ä¹æ§è¡ç»æä¸å¦ä¸ SQL ä¸è´</p>
<pre><code class="language-sql">UPDATE tbl_insert_on_update SET uk_column1='20050101003', uk_column2='ç·ä¸å·', remark='æ´é£ä¸æ ·çç·å­' WHERE name = 'å¼ ä¸';
</code></pre>
<p><code>id = 1</code> ä¸ <code>name = 'å¼ ä¸'</code> æåçæ¬æ¥å°±æ¯åä¸è¡æ°æ®ï¼æ´æ°çåä¸åå¼é½ä¸è´ï¼é£ä¹æ§è¡ç»æèªç¶å°±ä¸æ ·äº</p>
</li>
<li>
<p>å­å¨å¤ä¸ªå¯ä¸ç´¢å¼ï¼åå«ä¸»é®ï¼æ¶ï¼å¤æ­æ°æ®è¡æ¯å¦å­å¨ï¼è¿äºå¯ä¸ç´¢å¼çä¼åçº§é¡ºåºæ¯ææ ·çï¼</p>
<p>MySQL å®æ¹ææ¡£å¹¶æªæç¡®è¯´æè¿ä¸ªä¼åçº§é¡ºåºï¼ä½å¨ MySQL çå®ç°ä¸­è¯å®æè¿ä¸ªä¼åçº§é¡ºåºçå®ç°ç®æ³ï¼å¯è½è·çæ¬ãå­å¨å¼ææå³</p>
<p>åºäº <code>8.0.31</code> çæ¬ï¼ç®åæµè¯åºä»¥ä¸ä¼åçº§</p>
<blockquote>
<p>ä¸»é® &gt; å¯ä¸ç´¢å¼</p>
<p>å¯ä¸ç´¢å¼ä¹é´æåå»ºé¡ºåºï¼ååå»ºçä¼åçº§é«</p>
</blockquote>
<p>å®æ¹ææ¡£å·²ç»æç¡®è¯´æï¼å½è¡¨ä¸­æå¤ä¸ªå¯ä¸ç´¢å¼æèä¸»é®æ¶ï¼INSERT ... ON DUPLICATE KEY UPDATE è¯­å¥ä¸å®å¨ï¼æä»¥å¦ä¸çæµè¯ç»æå¹¶ä¸å·å¤ç¡®å®æ§ï¼ä¸è½ä½ä¸ºä½¿ç¨åå</p>
</li>
<li>
<p>ç¨äºMySQLçINSERT ON DUPLICATE KEY UPDATEï¼æä¹è¿æ¥å¯ä¸ç´¢å¼å²çªéè¯¯</p>
<p>MySQLæ¯åºäºå°è¯æå¥çç¬¬ä¸ä¸ªå²çªçå¯ä¸ç´¢å¼æ¥æ§è¡æ´æ°çï¼æ´æ°çå­æ®µå®å¨æå¯è½è§¦åå¶ä»å¯ä¸ç´¢å¼ï¼åæ¬ä¸»é®ï¼å²çª</p>
<p>è¿ä¸ªé®é¢æ ¹æ¬ä¸æç«ï¼</p>
</li>
</ol>
<h2 id="æ»ç»">æ»ç»</h2>
<ol>
<li>
<p>ä¸ç®¡æ¯ MySQLï¼è¿æ¯ OracleãSQL ServerãPostgreSQLï¼éå¯¹ <code>ä¸å­å¨åæå¥ï¼å­å¨åæ´æ°</code> å¤æ­æ°æ®æ¯å¦å­å¨çé»è¾é½æ¯ä¸æ ·çï¼åªæ¯ MySQL ä¸éè¦æ¾ç¤ºæå® <code>å¤å­</code> çå¯ä¸ç´¢å¼ï¼åæ¬ä¸»é®ï¼ï¼ç± MySQL å¼æåé¨èªå¨å®ç°</p>
</li>
<li>
<p>å³äºå¤æ­æ°æ®è¡æ¯å¦å­å¨ï¼å¤ä¸ªå¯ä¸ç´¢å¼çä¼åçº§ï¼çä¼¼è½æµåº MySQL ä¸­çä¼åçº§ï¼ä½å¹¶ä¸å·å¤ç¡®å®æ§ï¼ä¸è½ä½ä¸ºä½¿ç¨åå</p>
<p>ç±»ä¼¼ä¸ç¡®å®çæåºé®é¢è¿æï¼<a href="https://juejin.cn/post/7290017749715632168" target="_blank" rel="noopener nofollow">æè¯å¾æ¯æè¿æ¡ SQL çåºè£¤</a></p>
</li>
<li>
<p>INSERT ... ON DUPLICATE KEY UPDATE ä½¿ç¨è¿ç¨ä¸­æä¸äºéè¦æ³¨æçç¹ï¼éè¦ç»åèªå·±çä¸å¡æ¥åææ¯å¦å¯ä»¥å¿½ç¥è¿äºç¹</p>
<p><a href="https://www.cnblogs.com/youzhibing/p/15248758.html" target="_blank">è®°å½ä¸å­å¨åæå¥ï¼å­å¨åæ´æ° â MySQL çå®ç°æ¹å¼æåªäºï¼</a></p>
</li>
</ol>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-24 09:00">2025-12-24 09:00</span>&nbsp;
<a href="https://www.cnblogs.com/youzhibing">éç³è·¯</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19388304);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19388304', targetLink: 'https://www.cnblogs.com/youzhibing/p/19388304', title: 'ç¨äºMySQLçINSERT ON DUPLICATE KEY UPDATEï¼æä¹è¿æ¥å¯ä¸ç´¢å¼å²çªéè¯¯' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ãé¢è¯é¢ãMySQL ä¸­ä½¿ç¨ç´¢å¼ä¸å®ææåï¼å¦ä½ææ¥ç´¢å¼ææï¼ ]]></title>
    <link>https://www.cnblogs.com/sun-10387834/p/19371499</link>
    <guid>2a983bcd0009cd344c2ae781b8cdde49</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/sun-10387834/p/19371499" title="åå¸äº 2025-12-24 08:42">
    <span role="heading" aria-level="2">ãé¢è¯é¢ãMySQL ä¸­ä½¿ç¨ç´¢å¼ä¸å®ææåï¼å¦ä½ææ¥ç´¢å¼ææï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="-mysql-ç´¢å¼å¤±æç8å¤§é·é±åææ¥æå">ð MySQL ç´¢å¼å¤±æç8å¤§é·é±åææ¥æå</h1>
<h2 id="-ä¸å¥è¯æç½">ð¯ ä¸å¥è¯æç½</h2>
<p><strong>ç´¢å¼ä¸æ¯ä¸è½çï¼ç¨ä¸å¯¹åèæ´æ¢ï¼</strong></p>
<h2 id="-ç´¢å¼å¤±æç8å¤§å¸¸è§åºæ¯">ð« ç´¢å¼å¤±æç8å¤§å¸¸è§åºæ¯</h2>
<h3 id="1-ç´¢å¼åä¸åè®¡ç®æå¸¸è§"><strong>1. ç´¢å¼åä¸åè®¡ç®ï¼æå¸¸è§ï¼</strong></h3>
<pre><code class="language-sql">-- â éè¯¯ï¼å¨ç´¢å¼åä¸è®¡ç®
SELECT * FROM users WHERE YEAR(created_time) = 2024;
SELECT * FROM products WHERE price * 2 &gt; 100;

-- â æ­£ç¡®ï¼æè®¡ç®ç§»å°å³è¾¹
SELECT * FROM users WHERE created_time &gt;= '2024-01-01' AND created_time &lt; '2025-01-01';
SELECT * FROM products WHERE price &gt; 50;
</code></pre>
<p><strong>åå </strong>ï¼æ°æ®åºå¿é¡»å¯¹<strong>æ¯ä¸è¡</strong>é½è®¡ç®æè½æ¯è¾ï¼æ æ³ç¨ç´¢å¼å¿«éå®ä½ã</p>
<h3 id="2-ç´¢å¼åä½¿ç¨å½æ°"><strong>2. ç´¢å¼åä½¿ç¨å½æ°</strong></h3>
<pre><code class="language-sql">-- â éè¯¯ï¼ä½¿ç¨å½æ°åè£¹ç´¢å¼å
SELECT * FROM users WHERE UPPER(name) = 'JOHN';
SELECT * FROM logs WHERE DATE(create_time) = '2024-01-01';

-- â æ­£ç¡®ï¼ä½¿ç¨èå´æ¥è¯¢
SELECT * FROM users WHERE name = 'john';  -- å­å¥æ¶ç»ä¸å°å
SELECT * FROM logs WHERE create_time &gt;= '2024-01-01' AND create_time &lt; '2024-01-02';
</code></pre>
<h3 id="3-æ¨¡ç³æ¥è¯¢å¼å¤´ç¨ééç¬¦"><strong>3. æ¨¡ç³æ¥è¯¢å¼å¤´ç¨ééç¬¦</strong></h3>
<pre><code class="language-sql">-- â éè¯¯ï¼ä»¥ % å¼å¤´
SELECT * FROM users WHERE name LIKE '%å¼ %';  -- å¨è¡¨æ«æ
SELECT * FROM users WHERE name LIKE '%æ';

-- â æ­£ç¡®ï¼ä»¥ç¡®å®å­ç¬¦å¼å¤´
SELECT * FROM users WHERE name LIKE 'å¼ %';   -- å¯ä»¥ä½¿ç¨ç´¢å¼
SELECT * FROM users WHERE name LIKE 'å¼ _æ'; -- _å¹éä¸ä¸ªå­ç¬¦
</code></pre>
<p><strong>çæ´»ç±»æ¯</strong>ï¼</p>
<ul>
<li><code>å¼ %</code> â ç¥éå§å¼ ï¼ç´æ¥ç¿»å°å¼ å§åºå â</li>
<li><code>%å¼ </code> â ä¸ç¥éå§ä»ä¹ï¼åªè½ä¸é¡µé¡µç¿» â</li>
</ul>
<h3 id="4-or-æ¡ä»¶ä½¿ç¨ä¸å½"><strong>4. OR æ¡ä»¶ä½¿ç¨ä¸å½</strong></h3>
<pre><code class="language-sql">-- â éè¯¯ï¼OR æ¡ä»¶ä¸­æçåæ²¡ç´¢å¼
SELECT * FROM users WHERE age = 25 OR salary &gt; 10000;
-- å¦æ salary æ²¡ç´¢å¼ï¼æ´ä¸ªæ¥è¯¢é½æ æ³ç¨ç´¢å¼

-- â æ­£ç¡®ï¼ç¡®ä¿ OR ä¸¤è¾¹é½æç´¢å¼
-- æèåå¼æ¥è¯¢
SELECT * FROM users WHERE age = 25
UNION
SELECT * FROM users WHERE salary &gt; 10000;
</code></pre>
<h3 id="5-ç±»åä¸å¹ééå¼è½¬æ¢"><strong>5. ç±»åä¸å¹éï¼éå¼è½¬æ¢ï¼</strong></h3>
<pre><code class="language-sql">-- â éè¯¯ï¼å­ç¬¦ä¸²åç¨æ°å­æ¥è¯¢
CREATE TABLE users (
    id VARCHAR(20) PRIMARY KEY,  -- å­ç¬¦ä¸²ç±»å
    name VARCHAR(50)
);
SELECT * FROM users WHERE id = 123;  -- å­ç¬¦ä¸²åæ°å­æ¯è¾

-- â æ­£ç¡®ï¼ç±»åä¸è´
SELECT * FROM users WHERE id = '123';
</code></pre>
<p><strong>æµè¯éå¼è½¬æ¢</strong>ï¼</p>
<pre><code class="language-sql">-- æ¥çæ§è¡è®¡å
EXPLAIN SELECT * FROM users WHERE id = 123;
-- æ³¨æç key åæ¯å¦ä¸º NULLï¼æ²¡èµ°ç´¢å¼ï¼
</code></pre>
<h3 id="6-èåç´¢å¼æ²¡ç¨æå·¦å"><strong>6. èåç´¢å¼æ²¡ç¨æå·¦å</strong></h3>
<pre><code class="language-sql">-- ç´¢å¼ï¼idx_abc (a, b, c)

-- â ææï¼ç¨äºæå·¦å
SELECT * FROM table WHERE a = 1;
SELECT * FROM table WHERE a = 1 AND b = 2;
SELECT * FROM table WHERE a = 1 AND b = 2 AND c = 3;

-- â æ æï¼æ²¡ä»æå·¦å¼å§
SELECT * FROM table WHERE b = 2;            -- è·³è¿ a
SELECT * FROM table WHERE c = 3;            -- è·³è¿ a,b
SELECT * FROM table WHERE b = 2 AND c = 3;  -- è·³è¿ a
</code></pre>
<p><strong>è®°å¿æå·§</strong>ï¼å°±åæ¥å­å¸ï¼å¿é¡»ç¥é<strong>ç¬¬ä¸ä¸ªå­æ¯</strong>æè½å¿«éæ¥æ¾ã</p>
<h3 id="7-æ°æ®éå¤ªå°ä¸å¦å¨è¡¨æ«æ"><strong>7. æ°æ®éå¤ªå°ï¼ä¸å¦å¨è¡¨æ«æ</strong></h3>
<pre><code class="language-sql">-- åè®¾è¡¨åªæ 100 è¡æ°æ®
SELECT * FROM small_table WHERE id = 50;

-- æ°æ®åºä¼æ³ï¼èµ°ç´¢å¼è¦æ¥ç´¢å¼æ  + åè¡¨ï¼ä¸å¦ç´æ¥å¨è¡¨æ«ææ´å¿«
</code></pre>
<h3 id="8-ç´¢å¼åéæ©æ§å¤ªä½"><strong>8. ç´¢å¼åéæ©æ§å¤ªä½</strong></h3>
<pre><code class="language-sql">-- æ¯å¦"æ§å«"åï¼åªæ"ç·/å¥³"ä¸¤ç§å¼
CREATE INDEX idx_gender ON users(gender);

SELECT * FROM users WHERE gender = 'ç·';
-- å¯è½å¤±æï¼å ä¸ºè¦è¿åæ¥è¿ä¸åçæ°æ®ï¼ä¸å¦å¨è¡¨æ«æ
</code></pre>
<h2 id="-å¦ä½ææ¥ç´¢å¼å¤±æ">ð å¦ä½ææ¥ç´¢å¼å¤±æï¼</h2>
<h3 id="ç¬¬1æ­¥ç¨-explain-å¿«éè¯æ­"><strong>ç¬¬1æ­¥ï¼ç¨ EXPLAIN å¿«éè¯æ­</strong></h3>
<pre><code class="language-sql">-- å¨æ¥è¯¢åå  EXPLAIN
EXPLAIN SELECT * FROM users WHERE name LIKE '%å¼ %';

-- å³é®çè¿å åï¼
-- 1. type: ALL â å¨è¡¨æ«æï¼æå·®ï¼
-- 2. key: NULL â æ²¡èµ°ç´¢å¼
-- 3. rows: æ°å¼å¾å¤§ â è¦æ«æå¾å¤è¡
-- 4. Extra: Using filesort, Using temporary â æ§è½è­¦å
</code></pre>
<h3 id="ç¬¬2æ­¥çæ-explain-ç»æ"><strong>ç¬¬2æ­¥ï¼çæ EXPLAIN ç»æ</strong></h3>
<pre><code class="language-sql">EXPLAIN SELECT * FROM orders WHERE user_id = 100 AND status = 'paid';

-- çæ³ç»æï¼
+----+-------------+--------+------+---------------+---------+---------+-------------+------+
| id | select_type | table  | type | possible_keys | key     | key_len | rows        | Extra|
+----+-------------+--------+------+---------------+---------+---------+-------------+------+
|  1 | SIMPLE      | orders | ref  | idx_user      | idx_user| 8       | 10          | NULL |
+----+-------------+--------+------+---------------+---------+---------+-------------+------+

-- type ä»å¥½å°å·®ï¼
-- system &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; ALL
-- è³å°è¦å° range çº§å«æåæ ¼
</code></pre>
<h3 id="ç¬¬3æ­¥ä½¿ç¨æ§è½åæå·¥å·"><strong>ç¬¬3æ­¥ï¼ä½¿ç¨æ§è½åæå·¥å·</strong></h3>
<pre><code class="language-sql">-- 1. å¼å¯ profilingï¼æ¥çè¯¦ç»èæ¶ï¼
SET profiling = 1;
SELECT * FROM users WHERE ...;
SHOW PROFILES;
SHOW PROFILE FOR QUERY 1;

-- 2. æ¥çç´¢å¼ä½¿ç¨ç»è®¡
SELECT * FROM sys.schema_index_statistics 
WHERE table_name = 'users';

-- 3. æ¾åºä»æªä½¿ç¨çç´¢å¼ï¼è¯¥å é¤äºï¼ï¼
SELECT * FROM sys.schema_unused_indexes;
</code></pre>
<h3 id="ç¬¬4æ­¥æ¢æ¥è¯¢æ¥å¿åæ"><strong>ç¬¬4æ­¥ï¼æ¢æ¥è¯¢æ¥å¿åæ</strong></h3>
<pre><code class="language-sql">-- 1. å¼å¯æ¢æ¥è¯¢æ¥å¿
SET GLOBAL slow_query_log = 'ON';
SET GLOBAL long_query_time = 2;  -- è¶è¿2ç§è®°å½

-- 2. æ¥çæ¢æ¥è¯¢æ¥å¿ä½ç½®
SHOW VARIABLES LIKE 'slow_query_log_file';

-- 3. ä½¿ç¨å·¥å·åæï¼æ¨èï¼
-- mysqldumpslow æ pt-query-digest
</code></pre>
<h2 id="ï¸-å®æææ¥æ¡ä¾">ð ï¸ å®æææ¥æ¡ä¾</h2>
<h3 id="æ¡ä¾1ä¸ºä»ä¹è¿ä¸ªæ¥è¯¢æ¢"><strong>æ¡ä¾1ï¼ä¸ºä»ä¹è¿ä¸ªæ¥è¯¢æ¢ï¼</strong></h3>
<pre><code class="language-sql">-- åå§æ¥è¯¢ï¼å¾æ¢ï¼
SELECT * FROM orders 
WHERE DATE_FORMAT(create_time, '%Y-%m') = '2024-01'
ORDER BY amount DESC;

-- æ­¥éª¤1ï¼EXPLAINåæ
EXPLAIN SELECT * FROM orders WHERE DATE_FORMAT(create_time, '%Y-%m') = '2024-01';

-- åç°ï¼type=ALL, key=NULLï¼æ²¡èµ°ç´¢å¼ï¼
-- åå ï¼å¯¹ create_time ä½¿ç¨äºå½æ°

-- ä¼åæ¹æ¡ï¼
SELECT * FROM orders 
WHERE create_time &gt;= '2024-01-01' 
  AND create_time &lt; '2024-02-01'
ORDER BY amount DESC;

-- å EXPLAINï¼type=range, key=idx_create_time â
</code></pre>
<h3 id="æ¡ä¾2èåç´¢å¼é®é¢"><strong>æ¡ä¾2ï¼èåç´¢å¼é®é¢</strong></h3>
<pre><code class="language-sql">-- æ¥è¯¢ï¼ç»å¸¸æåå¸åå¹´é¾æç´¢ç¨æ·
SELECT * FROM users WHERE city = 'åäº¬' AND age &gt; 25;

-- ç°æç´¢å¼ï¼idx_age_city (age, city)
-- é®é¢ï¼æå·¦åæ¯ ageï¼ä½æ¥è¯¢åè¿æ»¤ city

-- è§£å³æ¹æ¡ï¼
-- 1. è°æ´æ¥è¯¢é¡ºåºï¼å¦æä¸å¡åè®¸ï¼
SELECT * FROM users WHERE age &gt; 25 AND city = 'åäº¬';

-- 2. æåå»ºæ°ç´¢å¼
CREATE INDEX idx_city_age ON users(city, age);
</code></pre>
<h2 id="-ç´¢å¼ææè¯ä¼°è¡¨">ð ç´¢å¼ææè¯ä¼°è¡¨</h2>
<table>
<thead>
<tr>
<th>æ£æ¥é¡¹</th>
<th>åæ ¼æ å</th>
<th>å¦ä½æ£æ¥</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ç´¢å¼ä½¿ç¨ç</strong></td>
<td>&gt; 90%</td>
<td><code>SHOW STATUS LIKE 'Handler_read%'</code></td>
</tr>
<tr>
<td><strong>æ¥è¯¢ååºæ¶é´</strong></td>
<td>&lt; 100ms</td>
<td>æ¢æ¥è¯¢æ¥å¿</td>
</tr>
<tr>
<td><strong>æ«æè¡æ°</strong></td>
<td>rows &lt; 1000</td>
<td>EXPLAIN ç rows å</td>
</tr>
<tr>
<td><strong>ä¸´æ¶è¡¨ä½¿ç¨</strong></td>
<td>å°½éé¿å</td>
<td>EXPLAIN ç Extra å</td>
</tr>
<tr>
<td><strong>æä»¶æåº</strong></td>
<td>å°½éé¿å</td>
<td>EXPLAIN ç Extra å</td>
</tr>
</tbody>
</table>
<h2 id="-æä½³å®è·µæ¸å">ð¯ æä½³å®è·µæ¸å</h2>
<h3 id="åå»ºç´¢å¼åé®èªå·±"><strong>åå»ºç´¢å¼åé®èªå·±ï¼</strong></h3>
<ol>
<li>â è¿ä¸ªæ¥è¯¢ççéè¦ç´¢å¼åï¼ï¼æ°æ®éå°ä¸éè¦ï¼</li>
<li>â ç´¢å¼åçéæ©æ§é«åï¼ï¼å¯ä¸å¼å¤åï¼ï¼</li>
<li>â ä¼é¢ç¹æ´æ°è¿ä¸ªååï¼ï¼æ´æ°é¢ç¹çåä¸éåå»ºç´¢å¼ï¼</li>
<li>â å·²ç»æç±»ä¼¼çç´¢å¼äºåï¼ï¼é¿åéå¤ç´¢å¼ï¼</li>
</ol>
<h3 id="åå»ºç´¢å¼åè¦æ£æ¥"><strong>åå»ºç´¢å¼åè¦æ£æ¥ï¼</strong></h3>
<pre><code class="language-sql">-- 1. éªè¯ç´¢å¼è¢«ä½¿ç¨
EXPLAIN SELECT ...;

-- 2. çæ§ç´¢å¼å¤§å°
SELECT 
    table_name,
    index_name,
    ROUND(SUM(index_length)/1024/1024, 2) AS 'ç´¢å¼å¤§å°(MB)'
FROM information_schema.TABLES 
WHERE table_schema = 'ä½ çæ°æ®åº'
GROUP BY table_name, index_name;

-- 3. å®ææ¸çæ ç¨ç´¢å¼
-- æ¥çä½¿ç¨é¢çä½çç´¢å¼
SELECT * FROM sys.schema_unused_indexes;
</code></pre>
<h2 id="-ç®åè®°å¿å£è¯">ð¡ ç®åè®°å¿å£è¯</h2>
<p><strong>ç´¢å¼å¤±æå«å¤§åï¼</strong></p>
<ol>
<li>è®¡ç®å½æ°ä¸ç¨æ³</li>
<li>æ¨¡ç³æ¥è¯¢ç¾åå·¦</li>
<li>ç±»åè½¬æ¢éå¼è</li>
<li>OR æ¡ä»¶è¦å¨é²</li>
<li>æå·¦åç¼ä¸è½å¿</li>
<li>æ°æ®éå°å¨è¡¨ç½</li>
<li>éæ©æ§ä½æ¯ç½å¿</li>
<li>ä¸ç­å·&lt;&gt;ä¹å¤å</li>
</ol>
<p><strong>ææ¥åæ­¥æ²ï¼</strong></p>
<ol>
<li><strong>EXPLAIN</strong> çè®¡å</li>
<li><strong>æ¢æ¥å¿</strong> æçå¶</li>
<li><strong>PROFILE</strong> æ¥æç»</li>
<li><strong>ç»è®¡è¡¨</strong> æ¸æ ç¨</li>
</ol>
<p>è®°ä½ï¼<strong>ç´¢å¼å°±åä¹¦çç®å½ï¼ä½ç¿»ç®å½æ¬èº«ä¹éè¦æ¶é´ãå¦æä¹¦åªæ10é¡µï¼ä¸å¦ç´æ¥ç¿»ï¼å¦æç®å½ç¼æä¸åçï¼è¿ä¸å¦ä¸ç¨ï¼</strong></p>

</div>
<div id="MySignature" role="contentinfo">
    
<p>â¤ï¸ å¦æä½ åæ¬¢è¿ç¯æç« ï¼è¯·ç¹èµæ¯æï¼ ð åæ¶æ¬¢è¿å³æ³¨æçåå®¢ï¼è·åæ´å¤ç²¾å½©åå®¹ï¼</p>

<p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/sun-10387834/" target="_blank">ä½ç¥è®©ææ¥å·¡å±±</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/sun-10387834/p/19371499" target="_blank">https://www.cnblogs.com/sun-10387834/p/19371499</a></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-24 08:43">2025-12-24 08:42</span>&nbsp;
<a href="https://www.cnblogs.com/sun-10387834">ä½ç¥è®©ææ¥å·¡å±±</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19371499);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19371499', targetLink: 'https://www.cnblogs.com/sun-10387834/p/19371499', title: 'ãé¢è¯é¢ãMySQL ä¸­ä½¿ç¨ç´¢å¼ä¸å®ææåï¼å¦ä½ææ¥ç´¢å¼ææï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ FastAPIå¿«éä¸æï¼è¯·æ±ä¸ååºçæ ¸å¿ç©æ³ ]]></title>
    <link>https://www.cnblogs.com/ymtianyu/p/19389987</link>
    <guid>a826c3ed7b6ab68dce27ff9aeb23d7bf</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ymtianyu/p/19389987" title="åå¸äº 2025-12-24 08:24">
    <span role="heading" aria-level="2">FastAPIå¿«éä¸æï¼è¯·æ±ä¸ååºçæ ¸å¿ç©æ³</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ¬æè¯¦ç»ä»ç»äºå¦ä½ä½¿ç¨FastAPIæ¡æ¶å¤çWebå¼åä¸­çæ ¸å¿è¯·æ±ä¸ååºãåå®¹æ¶µçè·¯ç±å®ä¹ãGETä¸POSTè¯·æ±æ¹æ³ãæ¥è¯¢åæ°ä¸è·¯å¾åæ°çä½¿ç¨ãè¯·æ±å¤´ä¸ååºå¤´çæä½ãè¡¨åæ°æ®çè§£æä»¥åéå®åçå®ç°ï¼å¹¶æä¾äºå¯ç´æ¥è¿è¡çå®æ´ä»£ç ç¤ºä¾ï¼å¸®å©è¯»èå¿«éææ¡FastAPIçåºç¡åºç¨ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<div style="font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; line-height: 1.6; color: rgba(51, 51, 51, 1); font-size: 16px; padding: 20px 0">
<div style="margin-bottom: 30px">
<p style="font-size: 18px; color: rgba(102, 102, 102, 1)">è¿å¨ä¸ºæå»ºé«æ§è½APIèç¦æ¼ï¼ç¥éåï¼<strong style="color: rgba(186, 55, 42, 1)">FastAPI</strong>æ¡æ¶çæ§è½ä¸<code>NodeJS</code>å<code>Go</code>ç¸å½ï¼åæ¶æä¾æä½³çå¼åä½éªã</p>
</div>
<div style="background-color: rgba(249, 249, 249, 1); border-left: 4px solid rgba(76, 175, 80, 1); padding: 15px 20px; margin: 25px 0; border-radius: 0 4px 4px 0">
<p style="margin: 0; color: rgba(44, 62, 80, 1); font-weight: bold">ð æç« æè¦</p>
<p style="margin: 10px 0 0; color: rgba(85, 85, 85, 1)">æ¬æå¸¦ä½ å¿«éä¸æFastAPIçè¯·æ±ä¸ååºå¤çæ ¸å¿ãä½ å°æ¸æ°å°ææ¡å¦ä½å®ä¹è·¯ç±ãå¤çGET/POSTè¯·æ±ãç©è½¬æ¥è¯¢ä¸è·¯å¾åæ°ãç®¡çè¯·æ±å¤´ä¸ååºå¤´ãè§£æè¡¨åæ°æ®ä»¥åå®ç°é¡µé¢éå®åãææ«éæå¯ç´æ¥è¿è¡çå®æ´ä»£ç ç¤ºä¾ã</p>
<br>
<p style="margin: 0; color: rgba(44, 62, 80, 1); font-weight: bold">ð ä½ å°å­¦å°ï¼</p>
<p style="margin: 5px 0 0; color: rgba(85, 85, 85, 1)">- è·¯ç±ä¸è¯·æ±æ¹æ³çåºç¡å®ä¹<br>- å¦ä½æ¥æ¶æ¥è¯¢åæ°åè·¯å¾åæ°<br>- å¤çPOSTè¯·æ±ä¸JSONæ°æ®<br>- è¯»åè¯·æ±å¤´ä¸è®¾ç½®èªå®ä¹ååºå¤´<br>- è§£æapplication/x-www-form-urlencodedè¡¨åæ°æ®<br>- å®ç°ç®åçéå®åååº</p>
</div>
<h2 style="border-bottom: 2px solid rgba(76, 175, 80, 1); padding-bottom: 10px; margin-top: 40px">â¨ ç®å½</h2>
<p style="color: rgba(85, 85, 85, 1)">- ð£ï¸ ç¬¬ä¸æ­¥ï¼ä»è·¯ç±ä¸è¯·æ±æ¹æ³å¼å§<br>- ð GETè¯·æ±ï¼æ¥è¯¢åæ°ä¸è·¯å¾åæ°<br>- ð¤ POSTè¯·æ±ï¼æ¥æ¶JSONä¸è¡¨åæ°æ®<br>- ð¨ è¯·æ±å¤´ä¸ååºå¤´ï¼ç»èæ§å¶<br>- âªï¸ éå®åï¼è®©è¯·æ±è·³è½¬èµ·æ¥<br>- ð» å®æ´ä»£ç ç¤ºä¾ï¼ä¸ä¸ªè¿·ä½ APIæå¡</p>
<h2 id="route" style="margin-top: 45px; color: rgba(44, 62, 80, 1)">ð£ï¸ ç¬¬ä¸æ­¥ï¼ä»è·¯ç±ä¸è¯·æ±æ¹æ³å¼å§</h2>
<p>å¨FastAPIä¸­ï¼ä¸åä»<code>app</code>å®ä¾åè£é¥°å¨å¼å§ã<code>@app.get()</code>ã<code>@app.post()</code>ç­è£é¥°å¨å®ä¹äºURLè·¯å¾åHTTPæ¹æ³ã</p>
<pre class="language-python highlighter-hljs"><code>from fastapi import FastAPI

app = FastAPI()

# å®ä¹ä¸ä¸ªå¤çæ ¹è·¯å¾GETè¯·æ±çè·¯ç±
@app.get("/")
def read_root():
    return {"message": "Hello, FastAPI World!"}

# å®ä¹ä¸ä¸ªå¤ç'/items'è·¯å¾GETè¯·æ±çè·¯ç±
@app.get("/items/")
def read_items():
    return [{"item_id": 1, "name": "Foo"}]</code></pre>
<p>çï¼å°±è¿ä¹ç®åï¼<strong style="color: rgba(186, 55, 42, 1)">æ¯ä¸ªå½æ°å¯¹åºä¸ä¸ªAPIç«¯ç¹</strong>ï¼è¿åå¼èªå¨è½¬æ¢ä¸ºJSONååºã</p>
<h2 id="get" style="margin-top: 45px; color: rgba(44, 62, 80, 1)">ð GETè¯·æ±ï¼æ¥è¯¢åæ°ä¸è·¯å¾åæ°</h2>
<p>GETè¯·æ±å¸¸ç¨äºè·åæ°æ®ï¼åæ°éå¸¸éè¿URLä¼ éãä¸»è¦æä¸¤ç§æ¹å¼ï¼<strong style="color: rgba(186, 55, 42, 1)">æ¥è¯¢åæ°</strong>å<strong style="color: rgba(186, 55, 42, 1)">è·¯å¾åæ°</strong>ã</p>
<p><strong>æ¥è¯¢åæ°</strong>ï¼è·å¨URLé®å·<code>?</code>åé¢ï¼å¦<code>/items/?skip=0&amp;limit=10</code>ãå¨å½æ°åæ°ä¸­å£°æå³å¯èªå¨è·åã</p>
<pre class="language-python highlighter-hljs"><code>@app.get("/items/")
def read_items(skip: int = 0, limit: int = 10):
    # æ¨¡æä»æ°æ®åºè¯»åæ°æ®
    fake_items = [{"item_id": i} for i in range(skip, skip + limit)]
    return fake_items</code></pre>
<p><strong>è·¯å¾åæ°</strong>ï¼ç´æ¥åµå¨URLè·¯å¾ä¸­ï¼å¦<code>/items/123</code>ãå¨è·¯ç±ä¸­ç¨<code>{}</code>å£°æã</p>
<pre class="language-python highlighter-hljs"><code>@app.get("/items/{item_id}")
def read_item(item_id: int): # ç±»åæ³¨è§£ä¼èªå¨è¿è¡éªè¯åè½¬æ¢
    return {"item_id": item_id, "name": f"Item {item_id}"}</code></pre>
<p>FastAPIç<strong style="color: rgba(186, 55, 42, 1)">ç±»åæç¤º</strong>åè½ä¼å¸®ä½ èªå¨éªè¯åæ°ç±»åï¼å¹¶æä¾æ¼äº®çAPIææ¡£ï¼</p>
<h2 id="post" style="margin-top: 45px; color: rgba(44, 62, 80, 1)">ð¤ POSTè¯·æ±ï¼æ¥æ¶JSONä¸è¡¨åæ°æ®</h2>
<p>POSTè¯·æ±ç¨äºåå»ºææäº¤æ°æ®ãæå¸¸è§çæ¯æ¥æ¶<strong style="color: rgba(186, 55, 42, 1)">JSON</strong>å<strong style="color: rgba(186, 55, 42, 1)">è¡¨å</strong>æ°æ®ã</p>
<p><strong>1. æ¥æ¶JSONæ°æ®</strong>ï¼ä½¿ç¨Pydanticæ¨¡åæ¥å®ä¹æ°æ®ç»æã</p>
<pre class="language-python highlighter-hljs"><code>from pydantic import BaseModel

class Item(BaseModel):
    name: str
    description: str | None = None
    price: float
    tax: float | None = None

@app.post("/items/")
def create_item(item: Item): # å°è¯·æ±ä½å£°æä¸ºItemç±»å
    # å¯ä»¥ç´æ¥ä½¿ç¨itemçå±æ§
    item_dict = item.dict()
    if item.tax:
        total_price = item.price + item.tax
        item_dict.update({"total_price": total_price})
    return item_dict</code></pre>
<p><strong>2. æ¥æ¶è¡¨åæ°æ®</strong>ï¼å½æ°æ®æ¥èªHTMLè¡¨åæ¶ï¼ä½¿ç¨<code>Form</code>ã</p>
<pre class="language-python highlighter-hljs"><code>from fastapi import Form

@app.post("/login/")
def login(username: str = Form(...), password: str = Form(...)):
    # Form(...)è¡¨ç¤ºå¿å¡«å­æ®µ
    return {"username": username, "login_status": "success"}</code></pre>
<p>æ³¨æï¼ä½¿ç¨<code>Form</code>åéè¦åå®è£<code>python-multipart</code>åºã</p>
<h2 id="header" style="margin-top: 45px; color: rgba(44, 62, 80, 1)">ð¨ è¯·æ±å¤´ä¸ååºå¤´ï¼ç»èæ§å¶</h2>
<p>ææ¶ä½ éè¦è¯»åå®¢æ·ç«¯çè¯·æ±å¤´ï¼æèä¸ºååºæ·»å èªå®ä¹å¤´é¨ä¿¡æ¯ã</p>
<p><strong>è¯»åè¯·æ±å¤´</strong>ï¼ä½¿ç¨<code>Header</code>å½æ°ã</p>
<pre class="language-python highlighter-hljs"><code>from fastapi import Header

@app.get("/headers/")
def read_headers(user_agent: str | None = Header(None)):
    return {"User-Agent": user_agent}</code></pre>
<p><strong>è®¾ç½®ååºå¤´</strong>ï¼è¿åä¸ä¸ª<code>Response</code>å¯¹è±¡ï¼æå¨ä¾èµä¸­è®¾ç½®ã</p>
<pre class="language-python highlighter-hljs"><code>from fastapi import Response

@app.get("/custom-header/")
def set_custom_header(response: Response):
    response.headers["X-Custom-Header"] = "MyCustomValue"
    return {"message": "Check the headers!"}</code></pre>
<h2 id="redirect" style="margin-top: 45px; color: rgba(44, 62, 80, 1)">âªï¸ éå®åï¼è®©è¯·æ±è·³è½¬èµ·æ¥</h2>
<p>éå®åå¨Webå¼åä¸­å¾å¸¸è§ï¼æ¯å¦ç»å½åè·³è½¬å°é¦é¡µãä½¿ç¨<code>RedirectResponse</code>å³å¯è½»æ¾å®ç°ã</p>
<pre class="language-python highlighter-hljs"><code>from fastapi.responses import RedirectResponse

@app.get("/old-link/")
def old_link():
    # æ°¸ä¹éå®åå°æ°çURL
    return RedirectResponse(url="/new-link/", status_code=301)

@app.get("/new-link/")
def new_link():
    return {"message": "This is the new endpoint!"}</code></pre>
<h2 id="full-code" style="margin-top: 45px; color: rgba(44, 62, 80, 1)">ð» å®æ´ä»£ç ç¤ºä¾ï¼ä¸ä¸ªè¿·ä½ APIæå¡</h2>
<p>å°ä¸é¢çç¥è¯ç¹æ´åï¼åå»ºä¸ä¸ªç®åçç¬è®°APIãä¿å­ä¸º<code>main.py</code>ï¼ç¶åç¨<code>uvicorn main:app --reload</code>è¿è¡å®ï¼</p>
<pre class="language-python highlighter-hljs"><code>from fastapi import FastAPI, Path, Query, Header, Form, Response
from fastapi.responses import RedirectResponse
from pydantic import BaseModel
from typing import Optional

app = FastAPI(title="è¿·ä½ ç¬è®°API")

# æ°æ®æ¨¡å
class Note(BaseModel):
    title: str
    content: str

# æ¨¡ææ°æ®åº
fake_notes_db = [{"id": 1, "title": "First Note", "content": "Hello!"}]

# é¦é¡µéå®åå°ææ¡£
@app.get("/")
def home():
    return RedirectResponse(url="/docs")

# è·åææç¬è®° (å¸¦æ¥è¯¢åæ°åé¡µ)
@app.get("/notes/")
def get_notes(skip: int = Query(0, ge=0), limit: int = Query(10, le=100)):
    return fake_notes_db[skip : skip + limit]

# æ ¹æ®IDè·åç¹å®ç¬è®° (è·¯å¾åæ°)
@app.get("/notes/{note_id}")
def get_note_by_id(note_id: int = Path(..., title="ç¬è®°ID", gt=0)):
    for note in fake_notes_db:
        if note["id"] == note_id:
            return note
    return {"error": "Note not found"}

# åå»ºæ°ç¬è®° (POST JSON)
@app.post("/notes/")
def create_note(note: Note, response: Response):
    new_id = max([n["id"] for n in fake_notes_db], default=0) + 1
    new_note = {"id": new_id, **note.dict()}
    fake_notes_db.append(new_note)
    response.headers["Location"] = f"/notes/{new_id}"
    response.status_code = 201
    return new_note

# ä¸ä¸ªéè¦User-Agentå¤´çç«¯ç¹
@app.get("/check-agent/")
def check_user_agent(user_agent: Optional[str] = Header(None)):
    return {"received_user_agent": user_agent}

# è¡¨åç»å½ç¤ºä¾
@app.post("/login-form/")
def login_form(username: str = Form(...), password: str = Form(...)):
    # è¿éåºè¯¥æçå®çéªè¯é»è¾
    if username == "admin" and password == "secret":
        return {"message": "Login successful"}
    return {"message": "Invalid credentials"}</code></pre>
<p>å¯å¨åï¼è®¿é® <a style="color: rgba(76, 175, 80, 1); text-decoration: none" href="http://127.0.0.1:8000/docs" rel="noopener nofollow">http://127.0.0.1:8000/docs</a> å³å¯çå°äº¤äºå¼APIææ¡£ï¼å¹¶ç´æ¥æµè¯ææç«¯ç¹ï¼</p>
<hr style="border-top: 1px solid rgba(238, 238, 238, 1); border-right: none; border-bottom: none; border-left: none; margin: 40px 0">
<div style="text-align: center; color: rgba(119, 119, 119, 1); margin-bottom: 40px">
<p>---</p>
<p style="font-size: 15px">åæ¬¢æ¬æï¼ä¸è¦éè¿â¨ï¼ç¹èµðæ¶èâ­å³æ³¨æðï¼ä¸èµ·å­¦ä¹ æ´å¤æç¨çç¥è¯ï¼å®åä½ æçæè½æ ï¼</p>
</div>
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-24 08:24">2025-12-24 08:24</span>&nbsp;
<a href="https://www.cnblogs.com/ymtianyu">æ²å¹½</a>&nbsp;
éè¯»(<span id="post_view_count">18</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19389987);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19389987', targetLink: 'https://www.cnblogs.com/ymtianyu/p/19389987', title: 'FastAPIå¿«éä¸æï¼è¯·æ±ä¸ååºçæ ¸å¿ç©æ³' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ PHP åå­¦èæå åºç¡ç»æä¸å¸¸è§éè¯¯ ]]></title>
    <link>https://www.cnblogs.com/catchadmin/p/19389942</link>
    <guid>e970eca05b42c8ecc0b8fa69d2f0b4de</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/catchadmin/p/19389942" title="åå¸äº 2025-12-24 08:10">
    <span role="heading" aria-level="2">PHP åå­¦èæå åºç¡ç»æä¸å¸¸è§éè¯¯</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="php-åå­¦èæå-åºç¡ç»æä¸å¸¸è§éè¯¯">PHP åå­¦èæå åºç¡ç»æä¸å¸¸è§éè¯¯</h1>
<p>PHP(Hypertext Preprocessor)æ¯ Web å¼åä¸­ä½¿ç¨æå¹¿æ³çèæ¬è¯­è¨ä¹ä¸ãæ è®ºæ¯æå»ºå¨æç½ç«è¿æ¯å¤æåºç¨,PHP éå¸¸é½æ¯æ ¸å¿ãç¶èå¯¹äºåå­¦èæ¥è¯´,å¥é¨ PHP å¯è½æç¹ä»¤äººççãè¯­æ³ç¹æ§ãæä½³å®è·µååç§é·é±æ··æå¨ä¸èµ·,å¾å®¹æè¿·å¤±æ¹åã</p>
<p>çªç¶é´,æè§å¾æå¿è¦è®¨è®ºä¸äºéå¸¸åºç¡ä½å¯¹åæ¥è§¦ PHP çåå­¦èè³å³éè¦çåå®¹ãè®¸å¤æ°æå¼åèå¿½è§äºçè§£åºæ¬ç»æå PHP ä¸­å¸¸è§éè¯¯çéè¦æ§ãè½ç¶è¿äºçèµ·æ¥å¾®ä¸è¶³é,ä½ææ¡è¿äºåºç¡ç¥è¯å°å¸®å©ä½ ç¼åæ´æ´æ´ãæ´é«æçä»£ç ,å¹¶é¿åå¯è½æå®³é¡¹ç®çé®é¢ã</p>
<p>æ¬æå°æ¢è®¨ PHP çåºæ¬ç»æ,å¹¶éç¹ä»ç»åå­¦èæå¸¸ç¯çä¸äºéè¯¯ãæ è®ºä½ æ¯åèµ·æ­¥è¿æ¯æä¸äºç»éª,çè§£è¿äºåºç¡ç¥è¯ä»¥åå¦ä½é¿åéè¯¯,é½å°å¸®å©ä½ ç¼åæ´æ´ãé«æä¸å®å¨ç PHP ä»£ç ã</p>
<p>è®©æä»¬ä»¥ç®åãæ¸æ°ä¸æäºçè§£çæ¹å¼æ¥åè§£è¿äºåå®¹ã</p>
<p><a href="https://catchadmin.com/post/2025-12/php-for-beginners-essential-structure-and-common-mistakes" target="_blank" rel="noopener nofollow">åæé¾æ¥ PHP åå­¦èæå åºç¡ç»æä¸å¸¸è§éè¯¯</a></p>
<h2 id="php-ç»æåºç¡ç¥è¯">PHP ç»æ:åºç¡ç¥è¯</h2>
<p>å¨æ·±å¥å¸¸è§éè¯¯ä¹å,æä»¬åççæ¯ä¸ªåå­¦èé½å¿é¡»çè§£ç PHP åºæ¬ç»æã</p>
<h3 id="php-è¯­æ³">PHP è¯­æ³</h3>
<p>PHP ä»£ç åµå¥å¨ HTML ä¸­ãè¦å¨ç½é¡µä¸­æ§è¡ PHP,æä»¬ç¨ <code>&lt;?php ... ?&gt;</code> æ ç­¾åè£¹ PHP ä»£ç ã</p>
<p>ç¤ºä¾:</p>
<pre><code class="language-php">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;PHP Basics&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Welcome to PHP!&lt;/h1&gt;
    &lt;?php
    echo "Hello, World!";
    ?&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>å¨ä¸é¢çç¤ºä¾ä¸­,PHP å <code>&lt;?php echo "Hello, World!"; ?&gt;</code> å¨ HTML body ä¸­çææ¶æ¯ "Hello, World!"ãçè§£åºæ¬è¯­æ³æ¯ç¼å PHP èæ¬çç¬¬ä¸æ­¥ã</p>
<h3 id="åéåæ°æ®ç±»å">åéåæ°æ®ç±»å</h3>
<p>å¨ PHP ä¸­,åéä»¥ç¾åç¬¦å· <code>$</code> ä¸ºåç¼,åè·åéåãPHP æ¯å¼±ç±»åè¯­è¨,è¿æå³çå£°æåéæ¶ä¸éè¦æå®æ°æ®ç±»åãç±»åå°æ ¹æ®èµå¼èªå¨æ¨æ­ã</p>
<p>ç¤ºä¾:</p>
<pre><code class="language-php">$name = "John";      // String
$age = 30;           // Integer
$height = 5.9;       // Float
$isStudent = true;   // Boolean
</code></pre>
<h3 id="å½æ°">å½æ°</h3>
<p>PHP ä¸­çå½æ°æ¯å¯éç¨çä»£ç åãä½¿ç¨ <code>function</code> å³é®å­å®ä¹å®ä»¬,è¿æå©äºç»ç»åæ¨¡ååä»£ç ã</p>
<p>ç¤ºä¾:</p>
<pre><code class="language-php">&lt;?php
function greet($name) {
    return "Hello, $name!";
}
echo greet("Alice"); // Outputs: Hello, Alice!
?&gt;
</code></pre>
<p>çè§£å¦ä½å®ä¹åä½¿ç¨å½æ°å°å¨ä»£ç åå¾æ´å¤ææ¶ä¸ºä½ èçå¤§éæ¶é´åç²¾åã</p>
<h2 id="åå­¦èå¨-php-ä¸­å¸¸ç¯çéè¯¯">åå­¦èå¨ PHP ä¸­å¸¸ç¯çéè¯¯</h2>
<p>è½ç¶ PHP æ¯ä¸é¨å¼ºå¤§èçµæ´»çè¯­è¨,ä½åå­¦èç»å¸¸ä¼ç¯ä¸äºå¸¸è§éè¯¯ãè®©æä»¬æ·±å¥äºè§£ä¸äºæå¸¸è§çé·é±ä»¥åå¦ä½é¿åå®ä»¬ã</p>
<h3 id="å¿è®°ä½¿ç¨æ­£ç¡®ç-php-æ ç­¾">å¿è®°ä½¿ç¨æ­£ç¡®ç PHP æ ç­¾</h3>
<p>ä¸ä¸ªå¸¸è§éè¯¯æ¯å¿è®°æ­£ç¡®æå¼æå³é­ PHP æ ç­¾ãPHP ä»£ç å¿é¡»å§ç»åå«å¨ <code>&lt;?php ... ?&gt;</code> ä¸­ãå¦æè¿äºæ ç­¾ç¼ºå¤±æä¸æ­£ç¡®,ä»£ç å°æ æ³è¿è¡ã</p>
<p>éè¯¯ç¤ºä¾:</p>
<pre><code class="language-php">&lt;html&gt;
&lt;body&gt;
    echo "Hello, World!"; // Error: no PHP opening tag
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>æ­£ç¡®ç¤ºä¾:</p>
<pre><code class="language-php">&lt;html&gt;
&lt;body&gt;
    &lt;?php echo "Hello, World!"; ?&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="å­ç¬¦ä¸²ä¸­æªè½¬ä¹ç¹æ®å­ç¬¦">å­ç¬¦ä¸²ä¸­æªè½¬ä¹ç¹æ®å­ç¬¦</h3>
<p>å¤çå­ç¬¦ä¸²æ¶,éè¦è½¬ä¹ç¹æ®å­ç¬¦,ç¹å«æ¯å¨å­ç¬¦ä¸²ä¸­ä½¿ç¨å¼å·æ¶ãå¦åä¼å¯¼è´è¯­æ³éè¯¯ã</p>
<p>éè¯¯ç¤ºä¾:</p>
<pre><code class="language-php">$greeting = "He said, "Hello!"";
</code></pre>
<p>æ­£ç¡®ç¤ºä¾:</p>
<pre><code class="language-php">$greeting = "He said, \"Hello!\"";
</code></pre>
<p>æè,å¯ä»¥å¯¹å¤å±å­ç¬¦ä¸²ä½¿ç¨åå¼å·:</p>
<pre><code class="language-php">$greeting = 'He said, "Hello!"';
</code></pre>
<p>è¿ä¸ªå°éè¯¯å¯è½å¯¼è´ä»£ç åºç°æå¤è¡ä¸º,æä»¥å¡å¿æ­£ç¡®å¤çç¹æ®å­ç¬¦ã</p>
<h3 id="ä½¿ç¨éè¯¯çæ¯è¾è¿ç®ç¬¦">ä½¿ç¨éè¯¯çæ¯è¾è¿ç®ç¬¦</h3>
<p>PHP æä¸¤ç§æ¯è¾è¿ç®ç¬¦:<code>=</code> ç¨äºèµå¼,<code>==</code> ç¨äºæ¯è¾ãåå­¦èç»å¸¸æ··æ·è¿ä¸¤è,å¯¼è´æå¤ç»æã</p>
<p>éè¯¯ç¤ºä¾:</p>
<pre><code class="language-php">$age = 30;
if ($age = 25) {  // Mistake: uses assignment, not comparison
    echo "Age is 25";
}
</code></pre>
<p>æ­£ç¡®ç¤ºä¾:</p>
<pre><code class="language-php">$age = 30;
if ($age == 25) {  // Correct: comparison operator
    echo "Age is 25";
}
</code></pre>
<p>å¨ if è¯­å¥ä¸­ä½¿ç¨èµå¼è¿ç®ç¬¦ <code>=</code> ä¼å¯¼è´éè¯¯çæ¡ä»¶å¤æ­ãå§ç»ä½¿ç¨ <code>==</code> è¿è¡æ¯è¾ä»¥é¿åæ­¤ç±»éè¯¯ã</p>
<h3 id="æªä½¿ç¨éå½çç¼©è¿åä»£ç æ ¼å¼">æªä½¿ç¨éå½çç¼©è¿åä»£ç æ ¼å¼</h3>
<p>è½ç¶ PHP ä¸å¼ºå¶ä¸¥æ ¼çç¼©è¿è§å,ä½æªè½æ­£ç¡®æ ¼å¼åä»£ç ä¼ä½¿å¶é¾ä»¥éè¯»åè°è¯,ç¹å«æ¯éçé¡¹ç®çå¢é¿ã</p>
<p>éè¯¯ç¤ºä¾:</p>
<pre><code class="language-php">&lt;?php
    function greet($name){
      if($name=="Alice"){echo "Hello, Alice!";}else{echo "Hello, Guest!";}
    }
?&gt;
</code></pre>
<p>æ­£ç¡®ç¤ºä¾:</p>
<pre><code class="language-php">&lt;?php
function greet($name) {
    if ($name == "Alice") {
        echo "Hello, Alice!";
    } else {
        echo "Hello, Guest!";
    }
}
?&gt;
</code></pre>
<p>æ­£ç¡®æ ¼å¼åçä»£ç ä¸ä»ä»å³ä¹ç¾è§ââå®å¯¹å¯è¯»æ§åå¯ç»´æ¤æ§è³å³éè¦ã</p>
<h3 id="ä¸å½ä½¿ç¨å¨å±åé">ä¸å½ä½¿ç¨å¨å±åé</h3>
<p>å¦æä¸è°¨æä½¿ç¨,å¨å±åéå¯è½å¯¼è´ä¸å¯é¢æµçè¡ä¸ºãéå¸¸æå¥½å¨å½æ°ä¹é´æ¾å¼ä¼ éåé,èä¸æ¯ä¾èµå¨å±ä½ç¨åã</p>
<p>éè¯¯ç¤ºä¾:</p>
<pre><code class="language-php">$counter = 10;
function increaseCounter() {
    $counter++;  // Refers to the global variable
}
increaseCounter();
echo $counter;  // Outputs 11
</code></pre>
<p>æ´å¥½çåæ³:</p>
<pre><code class="language-php">$counter = 10;
function increaseCounter($counter) {
    return $counter + 1;
}
$counter = increaseCounter($counter);
echo $counter;  // Outputs 11
</code></pre>
<p>æ¾å¼ä¼ éåéä½¿ä»£ç æ´å¯é¢æµ,æ´æäºè°è¯ã</p>
<h2 id="ç¼åæ´æ´-php-ä»£ç çæä½³å®è·µ">ç¼åæ´æ´ PHP ä»£ç çæä½³å®è·µ</h2>
<p>ç°å¨æä»¬å·²ç»ä»ç»äºä¸äºå¸¸è§éè¯¯,è®©æä»¬æ¢è®¨ä¸äºè½å¸®å©ä½ ç¼åæ´å¥½ PHP ä»£ç çæä½³å®è·µã</p>
<h3 id="ä½¿ç¨-isset-å-empty-æ£æ¥åé">ä½¿ç¨ isset() å empty() æ£æ¥åé</h3>
<p>å¨è®¿é®åéä¹å,æ£æ¥å®æ¯å¦å·²è®¾ç½®å¾éè¦ãä½¿ç¨ <code>isset()</code> å <code>empty()</code> æå©äºé²æ­¢è®¿é®æªå®ä¹åéæ¶åºéã</p>
<pre><code class="language-php">if (isset($username) &amp;&amp; !empty($username)) {
    echo "Username is set and not empty.";
}
</code></pre>
<p>è¿æå©äºé¿åæå¤éè¯¯,ä½¿ä»£ç æ´å¥å£®ã</p>
<h3 id="å§ç»æ¸çç¨æ·è¾å¥">å§ç»æ¸çç¨æ·è¾å¥</h3>
<p>PHP ç»å¸¸ç¨äºå¤çç¨æ·è¾å¥,ä½æªç»æ£æ¥çè¾å¥å¯è½å¯¼è´å®å¨æ¼æ´,å¦ SQL æ³¨å¥æ XSS æ»å»ãå§ç»æ¸çåéªè¯ç¨æ·è¾å¥ã</p>
<pre><code class="language-php">$username = htmlspecialchars($_POST['username']);
</code></pre>
<p>ä½¿ç¨ <code>htmlspecialchars()</code> ç­å½æ°ææ°æ®åºæ¥è¯¢çé¢å¤çè¯­å¥å¯¹äºç¼åå®å¨ç PHP åºç¨è³å³éè¦ã</p>
<h3 id="ä¿æå½æ°å°èä¸æ³¨">ä¿æå½æ°å°èä¸æ³¨</h3>
<p>çæ³æåµä¸,ä¸ä¸ªå½æ°åºè¯¥æ§è¡ä¸é¡¹ä»»å¡å¹¶åå¥½å®ãä¿æå½æ°å°èä¸æ³¨äºåä¸èè´£,ä½¿ä»£ç æ´æ¨¡ååä¸æ´æäºæµè¯ã</p>
<p>ç¤ºä¾:</p>
<pre><code class="language-php">function fetchUserData($userId) {
    // Fetch user data from database
}
function displayUserProfile($userData) {
    // Display user profile information
}
</code></pre>
<p>éè¿åç¦»å³æ³¨ç¹,æ¯ä¸ªå½æ°é½åå¾æ´æäºçè§£åä¿®æ¹ã</p>
<h2 id="è¿é¶æå·§">è¿é¶æå·§</h2>
<h3 id="ä½¿ç¨å½åç©ºé´">ä½¿ç¨å½åç©ºé´</h3>
<p>éçé¡¹ç®çå¢é¿,å°ä»£ç ç»ç»å°å½åç©ºé´ä¸­ä»¥é¿åå½åå²çªåå¾è¶æ¥è¶éè¦ã</p>
<pre><code class="language-php">namespace MyApp\Controllers;
class UserController {
    public function show() {
        echo "Displaying user profile.";
    }
}
</code></pre>
<p>å½åç©ºé´æå©äºä¿æä»£ç ç»ç»æåº,å¹¶é²æ­¢å½åå²çª,ç¹å«æ¯å¨å¤§åé¡¹ç®ä¸­ã</p>
<h3 id="ä½¿ç¨-composer-è¿è¡ä¾èµç®¡ç">ä½¿ç¨ Composer è¿è¡ä¾èµç®¡ç</h3>
<p>PHP é¡¹ç®éå¸¸ä¾èµå¤é¨åºãComposer æ¯ç®¡çè¿äºä¾èµçæä½³å·¥å·ã</p>
<pre><code class="language-bash">composer require vendor/package
</code></pre>
<p>Composer ç®åäºä¾èµç®¡ç,å¹¶ç¡®ä¿åºå§ç»ä¿æææ°ã</p>
<h2 id="ç»è¯­">ç»è¯­</h2>
<p>ææ¡ PHP éè¦å¯¹å¶ç»æåå¸¸è§é·é±ææå®ççè§£ãéè¿éµå¾ªæä½³å®è·µå¹¶é¿åéè¯¯,ä½ å°é¡ºå©ç¼åæ´æ´ãé«æä¸å®å¨ç PHP ä»£ç ãè½ç¶ PHP ä¸å¼å§å¯è½çèµ·æ¥ä»¤äººçç,ä½æäºæ­£ç¡®çåºç¡,ä½ å¾å¿«å°±è½è½»æ¾æå»ºå¼ºå¤§çåºç¨ã</p>
<p>æ è®ºä½ æ¯åèµ·æ­¥è¿æ¯å¸ææåæè½,è¿äºè§è§£é½å°å¸®å©ä½ æä¸ºæ´èªä¿¡ãæ´æè½åç PHP å¼åèã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-24 08:10">2025-12-24 08:10</span>&nbsp;
<a href="https://www.cnblogs.com/catchadmin">JaguarJack</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19389942);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19389942', targetLink: 'https://www.cnblogs.com/catchadmin/p/19389942', title: 'PHP åå­¦èæå åºç¡ç»æä¸å¸¸è§éè¯¯' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä¸æ¡SQLç´æ¥è·å´©288æ ¸ï¼1.5Tåå­æ°æ®åº ]]></title>
    <link>https://www.cnblogs.com/idealx/p/19389621</link>
    <guid>b45b8ef18097c4aa041e3dc53158f282</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/idealx/p/19389621" title="åå¸äº 2025-12-23 23:48">
    <span role="heading" aria-level="2">ä¸æ¡SQLç´æ¥è·å´©288æ ¸ï¼1.5Tåå­æ°æ®åº</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æè¿éå°ä¸ä¸ªOracleçSQLè¯­å¥å¼åççº¿ä¸æéï¼æ°æ®åºæå¡è¢«éå¯ãä¸»æº288æ ¸ï¼1.5Tä¹æ²¡æä½ã</p>
<pre><code>select  count(*) from dev_db.t1 t1,dev_db.t2 t2 where t1.object_name = t2.object_name or t1.DATA_OBJECT_ID = t2.DATA_OBJECT_ID and t1.OBJECT_ID = 123 and rownum = 1;
--------------------------------------------------------------------------------
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------------
|   0 | SELECT STATEMENT        |      |     1 |    77 |    31M  (1)| 00:20:50 |
|   1 |  SORT AGGREGATE         |      |     1 |    77 |            |          |
|   2 |   COUNT                 |      |       |       |            |          |
|*  3 |    FILTER               |      |       |       |            |          |
|   4 |     MERGE JOIN CARTESIAN|      |  6131M|   439G|    31M  (1)| 00:20:50 |
|   5 |      TABLE ACCESS FULL  | T1   | 78306 |  3135K|   411   (1)| 00:00:01 |
|   6 |      BUFFER SORT        |      | 78307 |  2752K|    31M  (1)| 00:20:50 |
|   7 |       TABLE ACCESS FULL | T2   | 78307 |  2752K|   409   (1)| 00:00:01 |
--------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   3 - filter("T1"."OBJECT_NAME"="T2"."OBJECT_NAME" OR
              "T1"."DATA_OBJECT_ID"="T2"."DATA_OBJECT_ID" AND "T2"."DATA_OBJECT_ID"
              IS NOT NULL AND "T1"."DATA_OBJECT_ID" IS NOT NULL AND
              "T1"."OBJECT_ID"=123 AND ROWNUM=1)
</code></pre>
<p>å¨æ§è¡è®¡åä¸­çå°æ­¥éª¤4äº§çäºç¬å¡å°ç§¯è¿æ¥ï¼ææ¬ç¸å½çé«ï¼è¿ä¸¤ä¸ªè¡¨ä»æ7ä¸è¡æ°æ®ï¼æ§è¡æ¶é´è¶è¿äº5åéã<br>
æ°æ®åºä¸­å³äºNOTãANDãORçé»è¾è¿ç®ä¼åçº§å°±æ¯æè¿ä¸ªé¡ºåºè¿è¡çï¼å¤æ­æ¯å¼åäººåå¤±è¯¯é æçãä¸é¢æ¯ç»è¿ä¼ååçæ§è¡è®¡åã</p>
<pre><code>select  count(*) from dev_db.t1 t1,dev_db.t2 t2 where (t1.object_name = t2.object_name or t1.DATA_OBJECT_ID = t2.DATA_OBJECT_ID) and t1.OBJECT_ID = 123 and rownum = 1;
-----------------------------------------------------------------------------
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |
-----------------------------------------------------------------------------
|   0 | SELECT STATEMENT     |      |     1 |    77 |   822   (1)| 00:00:01 |
|   1 |  SORT AGGREGATE      |      |     1 |    77 |            |          |
|*  2 |   COUNT STOPKEY      |      |       |       |            |          |
|   3 |    NESTED LOOPS      |      |     1 |    77 |   822   (1)| 00:00:01 |
|*  4 |     TABLE ACCESS FULL| T1   |     1 |    41 |   411   (1)| 00:00:01 |
|*  5 |     TABLE ACCESS FULL| T2   |     1 |    36 |   411   (1)| 00:00:01 |
-----------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - filter(ROWNUM=1)
   4 - filter("T1"."OBJECT_ID"=123)
   5 - filter("T1"."OBJECT_NAME"="T2"."OBJECT_NAME" OR
              "T2"."DATA_OBJECT_ID" IS NOT NULL AND
              "T1"."DATA_OBJECT_ID"="T2"."DATA_OBJECT_ID" AND "T1"."DATA_OBJECT_ID"
              IS NOT NULL)
</code></pre>
<p>å¨è¿ä¸ªæ§è¡è®¡åä¸­ï¼t1è¡¨ä½ä¸ºé©±å¨è¡¨ï¼è¿æ»¤æ¡ä»¶æ¯object_id=123,çº¿ä¸è¿ä¸ªæ¡ä»¶æ¯ä¸»é®ï¼å ä¸ºææ²¡æåå»ºè¿ä¸ªä¸»é®ï¼æä»¥æ¯å¨è¡¨æ«æã<br>
t2è¡¨ä½ä¸ºè¢«é©±å¨è¡¨åªå¹éå°äºä¸æ¡æ°æ®ãå ä¸ºSTOPKEYçä¼åï¼å¨åå°ä¸æ¡æ°æ®åSQLåæ­¢ï¼æ éæ«æå¨é¨æ°æ®ï¼å æ­¤æ§è¡æ¶é´éå¸¸ç­ã</p>
<h2 id="æ»ç»">æ»ç»</h2>
<p>æ¬æ¬¡é®é¢åå æ¯å ä¸ºä¸ä¸ªé»è¾è¿ç®çä¼åçº§å¤æ­éè¯¯ï¼ä»¥è³äºæ°æ®åºèµæºè¢«ä½¿ç¨å®å¯¼è´æ°æ®åºèç¹è¢«éå¯ã<br>
å¯¹äºèªå·±æ¿ä¸åçSQLè¯­å¥ï¼æ¥éå®æ¹ææ¡£æ¯ææå¨çåèä¾æ®ã<br>
å¶æ¬¡ï¼å¨æµè¯ç¯å¢å°±ç®åªæå°éæ°æ®ä¹å¯ä»¥çå°æ§è¡è®¡åæ¯å¦åçã<br>
æåï¼ä¸çº¿æ¶SQLè¯­å¥ç»è¿æå³ï¼å¯ä»¥æå¤§éåº¦åå°SQLè¯­å¥å¼åççº¿ä¸æéã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-23 23:48">2025-12-23 23:48</span>&nbsp;
<a href="https://www.cnblogs.com/idealx">ideal_x</a>&nbsp;
éè¯»(<span id="post_view_count">95</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19389621);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19389621', targetLink: 'https://www.cnblogs.com/idealx/p/19389621', title: 'ä¸æ¡SQLç´æ¥è·å´©288æ ¸ï¼1.5Tåå­æ°æ®åº' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Flinkæºç éè¯»ï¼ç¶æç®¡ç ]]></title>
    <link>https://www.cnblogs.com/Jackeyzhe/p/19389264</link>
    <guid>4f7ca851b49f4e4c2d63ce955b59e45d</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Jackeyzhe/p/19389264" title="åå¸äº 2025-12-23 21:44">
    <span role="heading" aria-level="2">Flinkæºç éè¯»ï¼ç¶æç®¡ç</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/1828322/202512/1828322-20251223214418733-1509708883.png" alt="Flinkæºç éè¯»ï¼ç¶æç®¡ç" class="desc_img">
        åé¢æä»¬ä»ç»äº Flink ç¶æçåç±»ååºç¨ãä»å¤©ä»æºç å±é¢åçä¸ä¸ Flink æ¯å¦ä½ç®¡çç¶æçã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>åé¢æä»¬ä»ç»äº Flink ç¶æçåç±»ååºç¨ãä»å¤©ä»æºç å±é¢åçä¸ä¸ Flink æ¯å¦ä½ç®¡çç¶æçã</p>
<h3 id="state-æ¦è¿°">State æ¦è¿°</h3>
<p>å³äº State çè¯¦ç»ä»ç»å¯ä»¥åè <a href="https://jackeyzhe.github.io/2025/08/04/Flink%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E7%8A%B6%E6%80%81%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%BA%94%E7%94%A8/" target="_blank" rel="noopener nofollow">Flinkå­¦ä¹ ç¬è®°ï¼ç¶æç±»åååºç¨</a> å <a href="https://jackeyzhe.github.io/2025/08/24/Flink%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E7%8A%B6%E6%80%81%E5%90%8E%E7%AB%AF/" target="_blank" rel="noopener nofollow">Flinkå­¦ä¹ ç¬è®°ï¼ç¶æåç«¯</a>è¿ä¸¤ç¯æç« ï¼ä¸ºäºæ¹é¢éè¯»ï¼è¿éæä»¬åç®åä»ç»ä¸ä¸ã</p>
<h4 id="state-ä½¿ç¨">State ä½¿ç¨</h4>
<p>State æ¯ Flink åå¤æé»è¾æä¾èµçæ ¸å¿ç»ä»¶ãå®çåç±»å¦ä¸</p>
<p><img alt="State åç±»" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1754928263/Blog/flink/4/%E7%8A%B6%E6%80%81%E5%88%86%E7%B1%BB.png" class="lazyload"></p>
<p>å¸¸è§çæ¯ Keyed State å Operator Stateï¼Keyed State ä½ç¨äº KeyedStream ä¸ï¼Operator State å¯ä»¥ä½ç¨äºææç Operator ä¸ãKeyed State ä½¿ç¨æ¶ï¼éè¦ååå»º StateDescriptorï¼ç¶ååè°ç¨ getState è·åã</p>
<pre><code class="language-java">ValueStateDescriptor&lt;Tuple2&lt;Long, Long&gt;&gt; descriptor =
        new ValueStateDescriptor&lt;&gt;(
                "average",
                TypeInformation.of(new TypeHint&lt;Tuple2&lt;Long, Long&gt;&gt;() {}));
ValueState&lt;Tuple2&lt;Long, Long&gt;&gt; sum = getRuntimeContext().getState(descriptor);
</code></pre>
<p>Opeartor State çè·åæ¹å¼ä¸ Keyed State ç±»ä¼¼ï¼é½éè¦ StateDescriptorãOperator State å¨å®ä¹æ¶éè¦å®ç° CheckpointedFunctionã</p>
<h4 id="state-å­å¨">State å­å¨</h4>
<p>State Backend ç¨æ¥ç®¡ç State å­å¨ï¼æ ¹æ®å­å¨æ ¼å¼åå­å¨ç±»åçç»åï¼å¯ä»¥åä¸ºä¸ç±»ï¼</p>
<ol>
<li>
<p>MemoryStateBackendï¼HashMapStateBackend å JobManagerCheckpointStorage çç»åï¼å³å° State ä»¥ Java å¯¹è±¡çå½¢å¼å­å¨å¨ JobManager åå­ä¸­ã</p>
</li>
<li>
<p>FsStateBackendï¼HashMapStateBackend å FileSystemCheckpointStorage çç»åï¼å° State ä»¥ Java å¯¹è±¡çå½¢å¼å­å¨å¨è¿ç«¯æä»¶ç³»ç»ä¸­ã</p>
</li>
<li>
<p>RocksDBStateBackendï¼EmbeddedRocksDBStateBackend å FileSystemCheckpointStorage çç»åï¼State åºåååå­å¨å¨ RocksDBã</p>
</li>
</ol>
<h3 id="åå»º-state-backend">åå»º State Backend</h3>
<p>åå»º State Backend çå¥å£å¨ StreamTaskï¼StreamTask æ¯ Flink é¨ç½²åè¿è¡å¨ TaskManager çåºæ¬ååã</p>
<p>å¨ StreamTask ç invoke æ¹æ³ä¸­ï¼ä¼åè°ç¨ restoreStateAndGates æ¹æ³å»åå»º State Backendãå®æ´çè°ç¨é¾è·¯å¦ä¸å¾æç¤ºã</p>
<p><img alt="stateBackend" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1764852973/Blog/flink/12/statebackend.png" class="lazyload"></p>
<p>å¨ streamOperatorStateContext æ¹æ³ä¸­ï¼åå«è°ç¨äº keyedStatedBackend å operatorStateBackend æ¥åå»ºä¸¤ç§ State Backendã</p>
<p>æä»¬åæ¥ç keyedStateBackend çé»è¾ã</p>
<pre><code class="language-java">protected &lt;K, R extends Disposable &amp; Closeable&gt; R keyedStatedBackend(
        TypeSerializer&lt;K&gt; keySerializer,
        String operatorIdentifierText,
        PrioritizedOperatorSubtaskState prioritizedOperatorSubtaskStates,
        CloseableRegistry backendCloseableRegistry,
        MetricGroup metricGroup,
        double managedMemoryFraction,
        StateObject.StateObjectSizeStatsCollector statsCollector,
        KeyedStateBackendCreator&lt;K, R&gt; keyedStateBackendCreator)
        throws Exception {

    if (keySerializer == null) {
        return null;
    }

    ......

    final KeyGroupRange keyGroupRange =
            KeyGroupRangeAssignment.computeKeyGroupRangeForOperatorIndex(
                    taskInfo.getMaxNumberOfParallelSubtasks(),
                    taskInfo.getNumberOfParallelSubtasks(),
                    taskInfo.getIndexOfThisSubtask());

    // Now restore processing is included in backend building/constructing process, so we need
    // to make sure
    // each stream constructed in restore could also be closed in case of task cancel, for
    // example the data
    // input stream opened for serDe during restore.
    CloseableRegistry cancelStreamRegistryForRestore = new CloseableRegistry();
    backendCloseableRegistry.registerCloseable(cancelStreamRegistryForRestore);
    BackendRestorerProcedure&lt;R, KeyedStateHandle&gt; backendRestorer =
            new BackendRestorerProcedure&lt;&gt;(
                    (stateHandles) -&gt; {
                        KeyedStateBackendParametersImpl&lt;K&gt; parameters =
                                new KeyedStateBackendParametersImpl&lt;&gt;(...);
                        return keyedStateBackendCreator.create(...),
                                parameters);
                    },
                    backendCloseableRegistry,
                    logDescription);

    try {
        return backendRestorer.createAndRestore(
                prioritizedOperatorSubtaskStates.getPrioritizedManagedKeyedState(),
                statsCollector);
    } finally {
        if (backendCloseableRegistry.unregisterCloseable(cancelStreamRegistryForRestore)) {
            IOUtils.closeQuietly(cancelStreamRegistryForRestore);
        }
    }
}
</code></pre>
<p>è¿éçåå»ºè¿ç¨ä¹æ¯è¾ç®åï¼åæ¯è·å KeyGroupRangeï¼å®è¡¨ç¤ºçæ¯å½å Operator ä¸å¤çç key çèå´ãç¶åå°±æ¯åå»º StateBackend å®ä¾ï¼è¿ééè¿ BackendRestorerProcedure å°è£ç»ä¸çæ¢å¤ãå¼å¸¸å¤çåèµæºæ¸çé»è¾ãoperatorStateBackend æ¹æ³çé»è¾ç¸æ¯è¾æ¥è¯´ï¼åªæ¯å°äº KeyGroupRange çå¤çï¼ç´æ¥åå»º StateBackend å®ä¾ã</p>
<h3 id="åå»ºåä½¿ç¨-state">åå»ºåä½¿ç¨ State</h3>
<h4 id="åå»º-keyedstate">åå»º KeyedState</h4>
<p>KeyedState æ¯éè¿è°ç¨ StreamingRuntimeContext.getState æ¹æ³è·åçãæä»¬åæ¥çå®æ´çè°ç¨æµç¨ã</p>
<p><img alt="getState" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1765164156/Blog/flink/12/getstate.png" class="lazyload"></p>
<p>å¨è°ç¨ getState è¿äºæ¹æ³æ¶ï¼é½ä¼åè°ç¨ keyedStateStore æä¾çæ¹æ³ï¼å®æ¯ Flink æä¾çä¸ä¸ªå°è£ keyedStateBackend çæ¥å£ãè°ç¨æµç¨çæåï¼æ¯è°ç¨ keyedStateBackend ä¸­ç createOrUpdateInternalState æ¹æ³ï¼è¿éæä»¬ä»¥ HeapStateBackend ä¸ºä¾ï¼ã</p>
<pre><code class="language-java">public &lt;N, SV, SEV, S extends State, IS extends S&gt; IS createOrUpdateInternalState(
        @Nonnull TypeSerializer&lt;N&gt; namespaceSerializer,
        @Nonnull StateDescriptor&lt;S, SV&gt; stateDesc,
        @Nonnull StateSnapshotTransformFactory&lt;SEV&gt; snapshotTransformFactory,
        boolean allowFutureMetadataUpdates)
        throws Exception {
    StateTable&lt;K, N, SV&gt; stateTable =
            tryRegisterStateTable(
                    namespaceSerializer,
                    stateDesc,
                    getStateSnapshotTransformFactory(stateDesc, snapshotTransformFactory),
                    allowFutureMetadataUpdates);

    @SuppressWarnings("unchecked")
    IS createdState = (IS) createdKVStates.get(stateDesc.getName());
    if (createdState == null) {
        StateCreateFactory stateCreateFactory = STATE_CREATE_FACTORIES.get(stateDesc.getType());
        if (stateCreateFactory == null) {
            throw new FlinkRuntimeException(stateNotSupportedMessage(stateDesc));
        }
        createdState =
                stateCreateFactory.createState(stateDesc, stateTable, getKeySerializer());
    } else {
        StateUpdateFactory stateUpdateFactory = STATE_UPDATE_FACTORIES.get(stateDesc.getType());
        if (stateUpdateFactory == null) {
            throw new FlinkRuntimeException(stateNotSupportedMessage(stateDesc));
        }
        createdState = stateUpdateFactory.updateState(stateDesc, stateTable, createdState);
    }

    createdKVStates.put(stateDesc.getName(), createdState);
    return createdState;
}


private static final Map&lt;StateDescriptor.Type, StateCreateFactory&gt; STATE_CREATE_FACTORIES =
        Stream.of(
                        Tuple2.of(
                                StateDescriptor.Type.VALUE,
                                (StateCreateFactory) HeapValueState::create),
                        Tuple2.of(
                                StateDescriptor.Type.LIST,
                                (StateCreateFactory) HeapListState::create),
                        Tuple2.of(
                                StateDescriptor.Type.MAP,
                                (StateCreateFactory) HeapMapState::create),
                        Tuple2.of(
                                StateDescriptor.Type.AGGREGATING,
                                (StateCreateFactory) HeapAggregatingState::create),
                        Tuple2.of(
                                StateDescriptor.Type.REDUCING,
                                (StateCreateFactory) HeapReducingState::create))
                .collect(Collectors.toMap(t -&gt; t.f0, t -&gt; t.f1));
</code></pre>
<p>è¿éé¦åæ¯æ³¨åäºä¸ä¸ª StateTableï¼è¿ä¸ªæ¯ State ä¸­ä¸ä¸ªéå¸¸éè¦çæååéï¼å®åé¨æ¯ä¸ä¸ªç±»ä¼¼ Map çç»æï¼ç¨æ¥ä¿å­ key å key çç¶æã</p>
<p>STATE_CREATE_FACTORIES è¿ä¸ªåéä¿å­äºä¸åç±»åç State åå®å¯¹åºçåå»ºæ¹æ³ï¼åç STATE_UPDATE_FACTORIES ä¿å­çæ¯ä¸å State å¯¹åºç æ´æ°æ¹æ³ã</p>
<h4 id="åå»º-operatorstate">åå»º OperatorState</h4>
<p>çå®äº KeyedState çåå»ºè¿ç¨åï¼æä»¬åæ¥çä¸ OperatorState çåå»ºè¿ç¨ã</p>
<p>OperatorState çåå»ºæ¹æ³æ¯éè¿ FunctionInitializationContext åè·åå° OperatorStateStoreï¼å®ä¸ KeyedStateStore ç±»ä¼¼ï¼é½æ¯å¯¹ StateBackend çæ¹æ³è¿è¡äºå°è£ã</p>
<pre><code class="language-java">@Override
public void initializeState(FunctionInitializationContext context) throws Exception {
    ListStateDescriptor&lt;Tuple2&lt;String, Integer&gt;&gt; descriptor =
            new ListStateDescriptor&lt;&gt;(
                    "buffered-elements",
                    TypeInformation.of(new TypeHint&lt;Tuple2&lt;String, Integer&gt;&gt;() {}));

    checkpointedState = context.getOperatorStateStore().getListState(descriptor);

    if (context.isRestored()) {
        for (Tuple2&lt;String, Integer&gt; element : checkpointedState.get()) {
            bufferedElements.add(element);
        }
    }
}
</code></pre>
<p>OperatorStateStore ç getListState æ¹æ³ä¸­ï¼ç´æ¥åå»ºåºäº PartitionableListStateï¼åæ¶ä¹åäºä¸äºç¼å­æä½ã</p>
<pre><code class="language-java">private &lt;S&gt; ListState&lt;S&gt; getListState(
        ListStateDescriptor&lt;S&gt; stateDescriptor, OperatorStateHandle.Mode mode)
        throws StateMigrationException {

    ......
    PartitionableListState&lt;S&gt; partitionableListState =
            (PartitionableListState&lt;S&gt;) registeredOperatorStates.get(name);

    if (null == partitionableListState) {
        // no restored state for the state name; simply create new state holder

        partitionableListState =
                new PartitionableListState&lt;&gt;(
                        new RegisteredOperatorStateBackendMetaInfo&lt;&gt;(
                                name, partitionStateSerializer, mode));

        registeredOperatorStates.put(name, partitionableListState);
    } else {
        ......
    }

    accessedStatesByName.put(name, partitionableListState);
    return partitionableListState;
}
</code></pre>
<p>PartitionableListState åé¨æä¸ä¸ª ArrayList ç¨äºä¿å­æ°æ®ã</p>
<h4 id="ä½¿ç¨-keyedstate">ä½¿ç¨ KeyedState</h4>
<p>äºè§£å® State çåå»ºä¹åï¼æ¥ä¸æ¥å°±æ¯ State çä½¿ç¨äºãæä»¬ä»¥ HeapValueState ä¸ºä¾æ¥çå¦ä½è·å Stateã</p>
<pre><code class="language-java">// HeapValueState ç±»
public V value() {
    final V result = stateTable.get(currentNamespace);

    if (result == null) {
        return getDefaultValue();
    }

    return result;
}
</code></pre>
<p>å¨ HeapValueState ç±»ç value æ¹æ³ä¸­ï¼ç´æ¥è°ç¨ StateTable ç get æ¹æ³ï¼æç»è°ç¨çæ¯ CopyOnWriteStateMap ç get æ¹æ³ï¼è¿ä¸ªæ¹æ³ä¸ HashMap ç get æ¹æ³æ¯è¾ç±»ä¼¼ã</p>
<pre><code class="language-java">public S get(K key, N namespace) {

    final int hash = computeHashForOperationAndDoIncrementalRehash(key, namespace);
    final int requiredVersion = highestRequiredSnapshotVersion;
    final StateMapEntry&lt;K, N, S&gt;[] tab = selectActiveTable(hash);
    int index = hash &amp; (tab.length - 1);

    for (StateMapEntry&lt;K, N, S&gt; e = tab[index]; e != null; e = e.next) {
        final K eKey = e.key;
        final N eNamespace = e.namespace;
        if ((e.hash == hash &amp;&amp; key.equals(eKey) &amp;&amp; namespace.equals(eNamespace))) {

            // copy-on-write check for state
            if (e.stateVersion &lt; requiredVersion) {
                // copy-on-write check for entry
                if (e.entryVersion &lt; requiredVersion) {
                    e = handleChainedEntryCopyOnWrite(tab, hash &amp; (tab.length - 1), e);
                }
                e.stateVersion = stateMapVersion;
                e.state = getStateSerializer().copy(e.state);
            }

            return e.state;
        }
    }

    return null;
}
</code></pre>
<h4 id="ä½¿ç¨-operatorstate">ä½¿ç¨ OperatorState</h4>
<p>OperatorState åºå±ä½¿ç¨çæ¯ PartitionableListStateï¼åé¢ä¹æå°äºï¼å®çåé¨ç¨äºä¸ä¸ª ArrayList æ¥ä¿å­æ°æ®ï¼å¯¹äº OperatorState çåç§æä½ä¹é½æ¯æ¥æä½è¿ä¸ª ArrayListã</p>
<pre><code class="language-java">@Override
public void clear() {
    internalList.clear();
}

@Override
public Iterable&lt;S&gt; get() {
    return internalList;
}

@Override
public void add(S value) {
    Preconditions.checkNotNull(value, "You cannot add null to a ListState.");
    internalList.add(value);
}

@Override
public void update(List&lt;S&gt; values) {
    internalList.clear();

    addAll(values);
}

@Override
public void addAll(List&lt;S&gt; values) {
    Preconditions.checkNotNull(values, "List of values to add cannot be null.");
    if (!values.isEmpty()) {
        for (S value : values) {
            checkNotNull(value, "Any value to add to a list cannot be null.");
            add(value);
        }
    }
}
</code></pre>
<h3 id="æ»ç»">æ»ç»</h3>
<p>æ¬æå¯¹ State çç¸å³ä»£ç è¿è¡äºæ¢³çãåæ¬ StateBackend çåå»ºï¼KeyedState å OperatorState çåå»ºåä½¿ç¨ãState å Checkpoint ä¸¤èéè¦ç»åä½¿ç¨ï¼å æ­¤åé¢æä»¬ä¼åæ¢³ç Checkpoint çç¸å³ä»£ç ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-23 21:45">2025-12-23 21:44</span>&nbsp;
<a href="https://www.cnblogs.com/Jackeyzhe">Jackeyzhe</a>&nbsp;
éè¯»(<span id="post_view_count">41</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19389264);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19389264', targetLink: 'https://www.cnblogs.com/Jackeyzhe/p/19389264', title: 'Flinkæºç éè¯»ï¼ç¶æç®¡ç' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä¸ç¨ Typora ç html å¯¼åºåè½ï¼ææçº¯ HTML5 è½¬æ¢å¨ ]]></title>
    <link>https://www.cnblogs.com/zhally/p/19389248</link>
    <guid>58655b7150a432539f646e50690a7abd</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/zhally/p/19389248" title="åå¸äº 2025-12-23 21:38">
    <span role="heading" aria-level="2">ä¸ç¨ Typora ç html å¯¼åºåè½ï¼ææçº¯ HTML5 è½¬æ¢å¨</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ä¸ç¨-typora-ç-html-å¯¼åºåè½ææçº¯-html5-è½¬æ¢å¨">ä¸ç¨ Typora ç html å¯¼åºåè½ï¼ææçº¯ HTML5 è½¬æ¢å¨</h1>
<p>åå å¤ç¾¤æ 2025.12.23</p>
<h2 id="ä¸ç¼èµ·">ä¸ãç¼èµ·</h2>
<p>ææ¥å¸¸å·¥ä½ä½¿ç¨ Typoraï¼ ä¸æ¬¾å¾å¥½ç Markdown ç¼è¾å¨ãå»ºç½ç«ï¼ååæï¼ç¨ Typora æåºç¨¿ãç¶åå¯¼åºæ html æ ¼å¼æä»¶ï¼æè§å³æå¾ï¼ä¸ä¸ªéæç½ç«å°±æäºï¼</p>
<p>ä¸è¿ï¼Typora èªå¸¦ç HTML å¯¼åºåè½å­å¨æ ¸å¿ç¼ºé·ï¼å¤¹å¸¦ Typora  ç¼è¾å¨ UI åä½ä»£ç ãHTML è¯­ä¹ä¸åè§ãä¾èµéæ ååæ ·å¼ä½ç³»ãå¯¼åºæä»¶ä½ç§¯å¤§ãå¯ç»´æ¤æ§å·®ãåºäºæ­¤ï¼æä»¬ææçº¯HTML5è½¬æ¢å¨ï¼æ ¸å¿ç®æ ï¼</p>
<ol>
<li>åé¤ UI åä½ï¼ä»ä¿ç Markdown åå®¹æ¸²æé»è¾ï¼</li>
<li>çº¯ ES6+ åçå®ç°ï¼æ ç¬¬ä¸æ¹åºä¾èµï¼</li>
<li>ç¬¦åHTML5è¯­ä¹æ åï¼</li>
<li>è¿å Typora çº¯ Markdown åå®¹çæ¸²æé£æ ¼ã</li>
</ol>
<h2 id="äºçº¯-es6-å®ç°æ ç¬¬ä¸æ¹åº">äºãçº¯ ES6+ å®ç°ï¼æ ç¬¬ä¸æ¹åº</h2>
<h3 id="21-æ ¸å¿ä¼å¿">2.1 æ ¸å¿ä¼å¿</h3>
<ul>
<li>è½»éåï¼äº§ç©ä»åå«æ ¸å¿ä¸å¡é»è¾ï¼æ åä½ä¾èµä»£ç ï¼ä½ç§¯è¾ Typora å¯¼åºç¼©å 80% ä»¥ä¸ï¼</li>
<li>å¯æ§æ§ï¼å¨æµç¨ææ§ Markdown è¯­æ³è§£æãHTML éæãæ ·å¼çæï¼</li>
<li>æ ä¾èµé£é©ï¼é¿åç¬¬ä¸æ¹åºçæ¬è¿­ä»£ãå¼å®¹æ§é®é¢ï¼è½¬æ¢å¨é¿æç¨³å®å¯ç¨ã</li>
</ul>
<h3 id="22-es6-æ ¸å¿ç¹æ§åºç¨">2.2 ES6+ æ ¸å¿ç¹æ§åºç¨</h3>
<table>
<thead>
<tr>
<th>ES6+ç¹æ§</th>
<th>åºç¨åºæ¯</th>
<th>ä»·å¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ¨¡ååï¼ES Moduleï¼</td>
<td>æåè§£æãå·¥å·ãå¥å£æ¨¡å</td>
<td>è§£è¦ä»£ç ï¼ä¾¿äºç»´æ¤</td>
</tr>
<tr>
<td>æ¨¡æ¿å­ç¬¦ä¸²</td>
<td>HTML/CSSçæ</td>
<td>æ¿ä»£å­ç¬¦ä¸²æ¼æ¥ï¼æåå¯è¯»æ§</td>
</tr>
<tr>
<td>æ­£åè¡¨è¾¾å¼å¢å¼º</td>
<td>Markdownè§£æãåè§ä¿®å¤</td>
<td>ç²¾åå¹éè¯­æ³ï¼è§£å³ååå¼ç¨å²çª</td>
</tr>
</tbody>
</table>
<h2 id="ä¸æ´ä½æ¶æè®¾è®¡">ä¸ãæ´ä½æ¶æè®¾è®¡</h2>
<h3 id="31-ç®å½ç»æ">3.1 ç®å½ç»æ</h3>
<pre><code>md2html/
âââ index.html        // äº¤äºçé¢ï¼MDè¾å¥ãHTMLé¢è§/å¯¼åºï¼
âââ js/
â   âââ app.js        // å¥å£ï¼DOMæä½ãè½¬æ¢/ä¸è½½é»è¾ï¼
â   âââ utils.js      // å·¥å·å½æ°ï¼æ ¼å¼åãæç¤ºï¼
â   âââ marked.es6.js // MDæ ¸å¿è§£æï¼åè§ä¿®å¤æ ¸å¿ï¼
âââ css/  
    âââ style.css     // è½¬æ¢å¨çé¢æ ·å¼
    âââ concise.css   // ç®æ´çMDæ¸²ææ ·å¼
    âââ typora.css    // Typoraçº¯åå®¹æ¸²ææ ·å¼
</code></pre>
<h3 id="32-æ ¸å¿æµç¨">3.2 æ ¸å¿æµç¨</h3>
<div class="mermaid">flowchart TD
    A[MDè¾å¥] --&gt; B[marked.es6.jsè§£æï¼åè§ä¿®å¤ï¼]
    B --&gt; C[utils.jsæ ¼å¼å]
    C --&gt; D[app.jsçæHTML/ä¸è½½]
    D --&gt; E[é¢è§/å¯¼åºçº¯HTML5æä»¶]
</div><h2 id="åæ ¸å¿ææ¯ç¹">åãæ ¸å¿ææ¯ç¹</h2>
<h3 id="41-åºäºæ­£åç-markdown-è¯­æ³è§£æ">4.1 åºäºæ­£åç Markdown è¯­æ³è§£æ</h3>
<p>æ¾å¼ç¬¬ä¸æ¹åºï¼éè¿ç²¾åçæ­£åè¡¨è¾¾å¼å¹éMarkdownæ ¸å¿è¯­æ³ï¼æ¯å®ç°âçº¯åçâçåºç¡ã</p>
<p>æ ¸å¿æè·¯ä¸ºï¼æâåçº§è¯­æ³ï¼æ é¢ãåè¡¨ãè¡¨æ ¼ï¼â è¡åè¯­æ³ï¼å ç²ãé¾æ¥ãä»£ç ï¼âçé¡ºåºè§£æï¼ç¡®ä¿è¯­æ³åµå¥çæ­£ç¡®æ§ã</p>
<p>ç¤ºä¾ï¼è¡¨æ ¼è¯­æ³è§£ææ­£å</p>
<pre><code class="language-javascript">// è§£æè¡¨æ ¼
const parseTables = (md, options) =&gt; {
    if (!md.includes('|') || md.includes('&lt;table&gt;')) return md;

    const tableRegex = /^(\|.*\|)\n(\|[-:| ]*\|)\n((?:\|.*\|\n?)+)/gm;
    return md.replace(tableRegex, (match, headerLine, separatorLine, bodyLines) =&gt; {
        const alignments = separatorLine.split('|')
            .filter(cell =&gt; cell.trim() !== '')
            .map(cell =&gt; {
                const trimCell = cell.trim();
                return trimCell.startsWith(':') &amp;&amp; trimCell.endsWith(':') ? 'center' :
                       trimCell.startsWith(':') ? 'left' :
                       trimCell.endsWith(':') ? 'right' : 'left';
            });

        const headerCells = headerLine.split('|').filter(cell =&gt; cell.trim() !== '');
        let headerHtml = '&lt;thead&gt;&lt;tr&gt;';
        headerCells.forEach((cell, index) =&gt; {
            const align = alignments[index] || 'left';
            const inlineContent = parseInlineOnly(cell, options);
            headerHtml += `&lt;th class="text-${align}"&gt;${inlineContent}&lt;/th&gt;`;
        });
        headerHtml += '&lt;/tr&gt;&lt;/thead&gt;';

        const bodyRows = bodyLines.split('\n').filter(row =&gt; row.trim() !== '');
        let bodyHtml = '&lt;tbody&gt;';
        bodyRows.forEach(row =&gt; {
            const cells = row.split('|').filter(cell =&gt; cell.trim() !== '');
            bodyHtml += '&lt;tr&gt;';
            cells.forEach((cell, index) =&gt; {
                const align = alignments[index] || 'left';
                const inlineContent = parseInlineOnly(cell, options);
                bodyHtml += `&lt;td class="text-${align}"&gt;${inlineContent}&lt;/td&gt;`;
            });
            bodyHtml += '&lt;/tr&gt;';
        });
        bodyHtml += '&lt;/tbody&gt;';

        return `&lt;table&gt;${headerHtml}${bodyHtml}&lt;/table&gt;`;
    });
};
</code></pre>
<h3 id="42-htmlè¯­ä¹åè§åéæ">4.2 HTMLè¯­ä¹åè§åéæ</h3>
<p>ä¾å¦ï¼Typora å¯¼åºç<code>&lt;ul&gt;/&lt;ol&gt;</code>è¢«<code>&lt;p&gt;</code>åè£¹ï¼æ¢è¡çæç©º<code>&lt;p&gt;</code>æ ç­¾ï¼è¿åHTMLè¯­ä¹è§èã</p>
<p>æ ¸å¿é»è¾ï¼è§£æåè¡¨æ¶ä»çæ<code>&lt;li&gt;</code>å­åç´ ï¼æ®µè½è§£ææé¤åè¡¨æ ç­¾ï¼é¿åè¯¯å¤ã</p>
<pre><code class="language-javascript">// marked.es6.js æ ¸å¿ä¿®å¤ä»£ç 
const parseLists = (md) =&gt; {
    // çæçº¯&lt;li&gt;ï¼ç§»é¤å¤ä½æ¢è¡
    let listItems = md.replace(/^( {0,3})(-|\*|\+)\s+(.*?$)/gm, (_, indent, marker, text) =&gt; {
        const inlineContent = parseInlineOnly(text).replace(/\n+/g, ' ');
        return `${indent}&lt;li&gt;${inlineContent}&lt;/li&gt;`;
    });
    // åè£¹åè¡¨å®¹å¨ï¼æ¸çæ¢è¡å¹²æ°
    return listItems.replace(/((?: {0,3}&lt;li&gt;[\s\S]*?&lt;\/li&gt;\s*)+)/gm, (_, items) =&gt; {
        const cleanItems = items.replace(/\n+/g, '').replace(/&gt;\s+&lt;/g, '&gt;&lt;');
        return /[-*+]/.test(_) ? `&lt;ul&gt;${cleanItems}&lt;/ul&gt;` : `&lt;ol&gt;${cleanItems}&lt;/ol&gt;`;
    });
};

// æ®µè½è§£ææé¤åè¡¨æ ç­¾ï¼é¿åç©º&lt;p&gt;
const parseParagraphs = (md) =&gt; {
    const paraRegex = /^(?!&lt;(ul|ol|li)&gt;)(?!&lt;\/(ul|ol|li)&gt;)([^&lt;\n]+?)(?=\n{2,}|$)/gm;
    return md.replace(paraRegex, (_, __, ___, content) =&gt; {
        const trimmed = content?.trim().replace(/\n+/g, ' ') || '';
        return trimmed ? `&lt;p&gt;${trimmed}&lt;/p&gt;` : '';
    });
};
</code></pre>
<h3 id="43-ä»ä¿ç-typora--åå®¹æ¸²ææ ¸å¿æ ·å¼">4.3 ä»ä¿ç Typora  åå®¹æ¸²ææ ¸å¿æ ·å¼</h3>
<p>Typora å¯¼åºæ ·å¼åå«ç¼è¾å¨ UI è§åï¼åä½ä¸éæ ååï¼äºä»¥å¥ç¦»ãåºäºTyporaåççMarkdownæ¸²æé£æ ¼ï¼æå»ºæ¨¡ååçCSSä½ç³»ï¼</p>
<pre><code class="language-css">/* typora.css æ ¸å¿ä»£ç  */
:root {
    --typora-text-color: #333;
    --typora-heading-color: #2c3e50;
    --typora-code-bg: #f8f8f8;
    --typora-table-border: #ddd;
}
/* æé»æ¨¡å¼éé */
@media (prefers-color-scheme: dark) {
    :root {
        --typora-text-color: #e0e0e0;
        --typora-code-bg: #2d2d2d;
        --typora-table-border: #444;
    }
}
/* åè¡¨åè§ååº */
ul&gt;li, ol&gt;li { margin: 0.4em 0; }
ul&gt;br, ol&gt;br, ul&gt;p, ol&gt;p { display: none; }
/* è¡¨æ ¼å¯¹é½ç±» */
.text-left { text-align: left !important; }
.text-center { text-align: center !important; }
.text-right { text-align: right !important; }
</code></pre>
<h3 id="44-åç-es6-æ¨¡ååæ´å">4.4 åç ES6+ æ¨¡ååæ´å</h3>
<pre><code class="language-javascript">// app.js æ ¸å¿é»è¾
import { parseMarkdown } from './marked.es6.js';
import { formatHtml, showAlert } from './utils.js';

// è½¬æ¢é»è¾
dom.convertBtn.addEventListener('click', () =&gt; {
    const mdContent = dom.mdInput.value.trim();
    if (!mdContent) return showAlert('è¯·è¾å¥Markdownåå®¹');
    
    // æ ¸å¿æµç¨ï¼è§£æï¼åè§ï¼â æ ¼å¼å â é¢è§/å¯¼åº
    const htmlFragment = parseMarkdown(mdContent); // çæå³åè§
    const finalHtml = formatHtml(`&lt;!DOCTYPE html&gt;
&lt;html lang="zh-CN"&gt;
&lt;head&gt;&lt;meta charset="UTF-8"&gt;&lt;link rel="stylesheet" href="./css/typora.css"&gt;&lt;/head&gt;
&lt;body&gt;${htmlFragment}&lt;/body&gt;&lt;/html&gt;`);
    
    dom.preview.innerHTML = htmlFragment;
    dom.htmlCode.value = finalHtml;
    dom.downloadBtn.disabled = false;
});
</code></pre>
<h2 id="äºä½¿ç¨è¯´æ">äºãä½¿ç¨è¯´æ</h2>
<ol>
<li>ææå®ç®å½ç»æå­æ¾æä»¶ï¼ç¡®ä¿<code>js/</code>å<code>css/</code>å­æä»¶å¤¹è·¯å¾æ­£ç¡®ï¼</li>
<li>ç¨æ¯æES6æ¨¡åçæµè§å¨ï¼Chrome/Firefox/Edgeï¼æå¼<code>index.html</code>ï¼</li>
<li>è¾å¥Markdownåå®¹ï¼å¾éâä¿ç Typora åæ ¼å¼âï¼ç¹å»âè½¬æ¢ä¸º HTML5âï¼</li>
<li>é¢è§åºæ¥çææï¼ç¹å»âä¸è½½ HTML æä»¶âè·åç¬¦å HTML5 è§èçæä»¶ã</li>
</ol>
<h2 id="å­æ»ç»">å­ãæ»ç»</h2>
<ol>
<li>æ ¸å¿ä»·å¼ï¼ç²¾åè§£å³ Typora å¯¼åºçç¼è¾å¨UIæ ·å¼åä½çç¹ï¼çæçº¯åå®¹çç¬¦å HTML5 è§èçæä»¶ï¼</li>
<li>ææ¯äº®ç¹ï¼çº¯ ES6+ åçå®ç°ï¼</li>
<li>ä¼å¿ï¼è½»éåãå¯æ§æ§å¼ºãè·¨ç¯å¢å¼å®¹ï¼å¯ç´æ¥é¨ç½²ä½¿ç¨ã</li>
</ol>
<p>æ¬æ¹æ¡æºä»£ç å¼æºï¼æç§ MIT åè®®è®¸å¯ãå°åï¼ <a href="https://github.com/xiaql/md2html5" target="_blank" rel="noopener nofollow">xiaql/md2html5: A typora to pure html5 converter</a></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-23 21:39">2025-12-23 21:38</span>&nbsp;
<a href="https://www.cnblogs.com/zhally">zhally</a>&nbsp;
éè¯»(<span id="post_view_count">47</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19389248);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19389248', targetLink: 'https://www.cnblogs.com/zhally/p/19389248', title: 'ä¸ç¨ Typora ç html å¯¼åºåè½ï¼ææçº¯ HTML5 è½¬æ¢å¨' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æµéæ´ªå³°å²ä¸å®çç§å¯ï¼æ­ç§ç³»ç»è¿è½½ä¿æ¤çæ ¸å¿é²çº¿ ]]></title>
    <link>https://www.cnblogs.com/poemyang/p/19389175</link>
    <guid>9290c5fbceb53775fbac0cc2690c58c1</guid>
    <description>
    <![CDATA[ 
        <h2 class="post-title">
            <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/poemyang/p/19389175" title="åå¸äº 2025-12-23 21:16">
    <span role="heading" aria-level="2">æµéæ´ªå³°å²ä¸å®çç§å¯ï¼æ­ç§ç³»ç»è¿è½½ä¿æ¤çæ ¸å¿é²çº¿</span>
    

</a>

        </h2>
        <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>ç³»ç»æµéå¦æ½®æ±è¬æ¶¨è½ï¼ç¬æ¶çæ´ªå³°å¯è½å°æååºçç³»ç»å²å®ãå¦ä½ç¡®ä¿æ ¸å¿æå¡å¨æéååä¸ä¾ç¶ç¨³å¦ç£ç³ï¼ç­æ¡å¨äºæå»ºä¸å¥åå±ååãå¨æå¼¹æ§çè¿è½½ä¿æ¤æºå¶ãè¿å¹¶éåä¸ææ¯çå ç ï¼èæ¯ä¸é¨èæ±äºé¢å¤ãéç¦»ãè°åº¦ä¸èªæçç³»ç»å·¥ç¨èºæ¯ã<br>
æ¬æå°æ·±å¥åæè¿å¥å¤å±é²æ¤ä½ç³»çæå»ºä¹éï¼ä»æå¤å±çæµéè°åº¦ï¼è´è½½åè¡¡ï¼ï¼å°ç²¾ç»åçè¯·æ±ç®¡æ§ï¼éæµï¼ï¼åå°ä¿éæ ¸å¿ä¸å¡çâä¸¢è½¦ä¿å¸âç­ç¥ï¼éçº§ä¸çæ­ï¼ï¼æç»è¿åæºè½åçèªæè°èï¼èªéåºéæµï¼ãè¿äºæºå¶ç¯ç¯ç¸æ£ï¼å®æ¶èå¨ï¼æ¨å¨ç³»ç»èµæºèå°½åï¼å»ºç«èµ·ä¸éæåºçé²çº¿ï¼ç¡®ä¿å³é®ä¸å¡å¨æµéé£æ´ä¸­ä¾ç¶è½å¤æç»­ç¨³å®å°åé ä»·å¼ã</p>
<p><strong>è¿è½½åå ï¼ä¸ºä»ä¹æä»¬çç³»ç»ä¼å µè½¦ï¼</strong><br>
ç³»ç»è¿è½½ï¼System Overloadï¼ï¼å¦ååå¸äº¤éå¨é«å³°æé·å¥ç«çªï¼å¶æ¬è´¨æ¯è¯·æ±ååä¸å¤çè½åä¹é´å¨æå¹³è¡¡çæç ´ãå¨ç³»ç»è®¾è®¡é¶æ®µï¼éå¨é¢è¯ä¼°å¶å¤çè½åï¼å·ä½æ¶µçæ¯ç§å¤çè½åãè¯·æ±å³°å¼ãå¹³åå¤çæ¶å»¶ç­å³é®ææ ãè¿äºææ ä¸ä»æå©äºé¢ä¼°ç³»ç»çæå¤§å¤çè½åï¼è¿è½ä¸ºç¡®å®æéæºå¨æ°éä»¥åæ¯å¦è¿è¡æ©å®¹æä¾å¯é ä¾æ®ãç¶èï¼å¨å®éè¯ä¼°ä¸­ï¼å¾å¾ä»èç¦äºè¯·æ±éå³°å¼ï¼å´å¿½ç¥äºç³»ç»å¤çè½åçå¨æååãç°å®ä¸­ï¼ç³»ç»çå¤çè½åå¹¶éæå®ä¸åï¼å®ä¼å åé¨æèåå¤é¨ä¾èµèå¨æè¡°åãå®éä¸ï¼ç³»ç»å¤çè½åçéä½åæ ·ä¼å¼åè¿è½½é®é¢ã<br>
ç³»ç»è¿è½½çåå ä¸»è¦å¯å½ä¸ºä¸¤ç±»ï¼ç¡¬ä»¶ç³»ç»æéè½åè¢«çªç ´åè½¯ä»¶ç³»ç»æéè½åè¢«è¶è¶ãç±äºç¡¬ä»¶è½åè¢«è¶è¶çæåµç¸å¯¹è¾å°ï¼å æ­¤æ´åºéç¹å³æ³¨è½¯ä»¶ç³»ç»ï¼åæ¬æä½ç³»ç»ååºç¨è½¯ä»¶ãæä½ç³»ç»è´è´£ç»ä¸è°éä¸ç®¡çç¡¬ä»¶èµæºï¼èåºç¨ç³»ç»åéè¿ç³»ç»è°ç¨ä½¿ç¨è¿äºèµæºãå½èµæºä½¿ç¨è¶åºæä½ç³»ç»çæ¿åéåº¦æ¶ï¼ç³»ç»çæ´ä½å¤çè½åå°æ¥å§éä½ãåºç¨ç³»ç»çç¶é¢éå¸¸è¡¨ç°ä¸ºä»¥ä¸åç§ç±»åï¼ä¸æäºåºç¨ç³»ç»å¯è½åæ¶å­å¨å¤ä¸ªç¶é¢å ç´ ã<br>
â 1ï¼å¤çå¨ç¶é¢ï¼å¯éçè®¡ç®ä»»å¡ï¼å¦å¤æç®æ³ãå è§£å¯ï¼ãé¢ç¹ççº¿ç¨ä¸ä¸æåæ¢ï¼é½ä¼å°å¤çå¨å©ç¨çæ¨å100%ï¼å¯¼è´æ°è¯·æ±æéç­å¾ï¼ååºæ¶é´æ¥å§æé¿ã<br>
2ï¼åå­ç¶é¢ï¼é¢ç¹çåå¾åæ¶ï¼GC Pauseï¼ä¼å»ç»åºç¨ï¼èæä½ç³»ç»å±é¢çåå­äº¤æ¢ï¼Swappingï¼æ´æ¯å°å¤çéåº¦ä»çº³ç§çº§ææ¢è³æ¯«ç§çº§ï¼å¯¹æ§è½é ææ¯ç­æ§æå»ã<br>
â 3ï¼ç½ç»I/Oï¼å¸¦å®½èå°½ãç½ç»å»¶è¿ï¼ææ¯è¿æ¥æ°ï¼å¦æä»¶å¥æï¼è¢«å æ»¡ï¼å¯¼è´æ æ³å»ºç«æ°çè¯·æ±è¿æ¥ã<br>
4ï¼ç£çI/Oï¼å¤§éçæ°æ®åºè¯»åãæ¥å¿è®°å½ãæä»¶æä½ï¼ç¹å«æ¯éæºI/Oï¼ä¼æ¾èéä½ç£çååçï¼ææ¢æ´ä¸ªä¸å¡æµç¨ã</p>
<p><strong>è¿è½½è§£å³ç­ç¥</strong><br>
é¢å¯¹ç³»ç»è¿è½½ï¼è§£å³æè·¯å¯å½ä¸ºä¸¤å¤§æ¹åï¼âå¼æºâä¸âèæµâãâå¼æºâæ¨å¨æåç³»ç»çæ¿è½½ä¸éï¼èâèæµâåæ¯å¨èµæºæéçåæä¸ï¼æºæ§å°ç®¡çåè°åº¦è¿å¥ç³»ç»çè¯·æ±ãä¸ä¸ªæççç³»ç»ï¼å¾å¾æ¯è¿ä¸¤ç§ç­ç¥çææºç»åã<br>
å¼æºç­ç¥æ¯ææåç³»ç»æ¿è½½åãè¿æ¯æç´è§çåºå¯¹æ¹å¼ï¼æ ¸å¿æ¯å¢å ç³»ç»å¯ç¨çç©çæèæèµæºã<br>
1ï¼æ©å®¹ï¼Scalingï¼ï¼ ç´æ¥å¢å ç¡¬ä»¶æå¥ï¼åä¸ºåç´æ©å®¹ï¼åçº§åæºéç½®ï¼åæ°´å¹³æ©å®¹ï¼å¢å æ´å¤æå¡å¨èç¹ï¼ãæ©å®¹è½ç«ç«¿è§å½±å°æåå¤çè½åï¼ä½ææ¬é«æï¼ä¸èµæºç»æä¸éãæ´éè¦çæ¯ï¼å®æ æ³è§£å³ç±è½¯ä»¶è®¾è®¡ç¼ºé·ï¼å¦éç«äºãæ¢æ¥è¯¢ï¼å¼åçç¶é¢ã<br>
2ï¼è´è½½åè¡¡ï¼Load Balancingï¼ï¼ å®æ¯æ°´å¹³æ©å®¹çå¿ç¶æ­æ¡£ãéè¿æºè½çè°åº¦ç®æ³ï¼å°è¯·æ±æµéååå°ååå°åç«¯åä¸ªæå¡èç¹ï¼é¿ååç¹è¿è½½ï¼æå¤§åå©ç¨æ´ä¸ªéç¾¤çå¤çè½åã<br>
èæµç­ç¥æ¯æä¼åè¯·æ±å¤çæµãå½âå¼æºâè¾¾å°æéæä¸ç¬¦åææ¬æçæ¶ï¼âèæµâä¾¿æä¸ºä¿éç³»ç»é§æ§çå³é®ãå®ä¸åè¿½æ±å¤çææè¯·æ±ï¼èæ¯éæ©æ§å°å¤çï¼ç¡®ä¿æ ¸å¿åè½ä¸åå½±åã<br>
1ï¼æµéæ§å¶ï¼Traffic Shapingï¼ï¼ è¿æ¯è¿è½½ä¿æ¤çæ ¸å¿ææ®µï¼éè¿éæµãæéç­æ¹å¼ï¼ä¸»å¨æ§å¶è¿å¥ç³»ç»çè¯·æ±éçï¼é²æ­¢æµéæ´ªå³°ç´æ¥å²å»åç«¯æå¡ãå®åä¸ä¸ªæºè½éé¨ï¼ç¡®ä¿æ°´æµå¹³ç¨³å¯æ§ã<br>
2ï¼æå¡éçº§ï¼Graceful Degradationï¼ï¼ è¿æ¯ä¸ç§âèè½¦ä¿å¸âçæºæ§ãå¨ç³»ç»ååå·¨å¤§æ¶ï¼æç­ç¥å°å³é­æç®åéæ ¸å¿åè½ï¼å¦ååæ¨èãç¨æ·è¯è®ºï¼ï¼å°å®è´µçç³»ç»èµæºéä¸­ç¨äºä¿éæ ¸å¿ä¸å¡æµç¨ï¼å¦ä¸åãæ¯ä»ï¼çç¨³å®ã<br>
å°½ç®¡æ©å®¹åè´è½½åè¡¡æ¯æå»ºé«å¹¶åç³»ç»çåºç¡ï¼ä½å®ä»¬æ´åæ¯æé«äºå ¤åçé«åº¦ãèçæ­£çè¿è½½ä¿æ¤ï¼åæ¯å¨æ´ªæ°´æ¥ä¸´æ¶ï¼å¦ä½ç§å­¦å°æ³æ´ªãå¯¼æµï¼ç¡®ä¿å¤§åæ¬èº«åå¶å®æ¤çæ ¸å¿åºåå®ç¶æ æãè¿æ­£æ¯âèæµâç­ç¥çä»·å¼æå¨ã</p>
<p><strong>è¿è½½ä¿æ¤çæ ¸å¿ä»·å¼</strong><br>
ä¼ ç»ç³»ç»è®¾è®¡ççæ³æ¯æ°¸ä¸å¤±è´¥ï¼ä½è¿å¨çå®å¤æçç³»ç»ä¸çä¸­ä¸åå®éãè¿è½½ä¿æ¤æ¿è®¤å¤±è´¥çå¿ç¶æ§ï¼å¹¶å°è®¾è®¡çç¦ç¹ä»âå¦ä½é¿åå¤±è´¥âè½¬ç§»å°âå½å¤±è´¥åçæ¶ï¼å¦ä½å¯æ§å°ãæé¢è§æ§å°åºå¯¹âãå®ç¨æåºçéçº§åä»£æ åºçå´©æºï¼ç¨å¯é¢æçå±é¨ä¸å¯ç¨æ¢åæ´ä½ç³»ç»çç¨³å®ã<br>
å¨æ²¡æä¿æ¤çæåµä¸ï¼è¿è½½æå³çææè¯·æ±ä¸ååæ¢ï¼æç»ä¸åå¤±è´¥ï¼ç³»ç»é·å¥æ··æ²ãèè¿è½½ä¿æ¤æºå¶ï¼å¦åä¸ä½å·éçè°åº¦åï¼å®æ ¹æ®é¢è®¾çä¼åçº§åè§åï¼å³å®äºåªäºè¯·æ±è¢«ç«å³å¤çï¼åªäºéè¦æéç­å¾ï¼åªäºè¢«ç¤¼è²å°æç»ãè¿ç§æºå¶å°æ··ä¹±çæµéå²å»æ³¢ï¼è½¬åä¸ºä¸ä¸ªæåºçãå¯ç®¡ççä¸å¡å¤çéåã<br>
å¨ç³»ç»é¢ä¸´è¿è½½æ¶ï¼é¦è¦ä»»å¡æ¯å¨æéèµæºæ¡ä»¶ä¸ï¼éè¿ä¼ååä¿æ¤ç­ç¥ï¼ç¡®ä¿ç³»ç»çå³é®åè½è½å¤ç¨³å®è¿è¡ãä¾å¦ï¼å¯å¯¹ç³»ç»çåä¸ªé¨åè¿è¡ä¼åçº§æåºï¼æç¡®åªäºåè½æ¯è³å³éè¦çï¼åªäºåè½å¨å¿è¦æ¶å¯ææ¶å³é­æéçº§ãåæ¶ï¼è®¾å®åççéå¼åè§åï¼ä»¥ä¾¿å¨ç³»ç»è¿è½½æ¶ï¼è½å¤èªå¨ä¸¢å¼è¶åºå¤çè½åçè¯·æ±ã<br>
ä¸åææ¯ç­ç¥é½ä¸ºä¸å¡æå¡ãè¿è½½ä¿æ¤çç»æç®æ ï¼æ¯å¨èµæºæéçè¾¹ç¼ï¼å°æ¯ä¸åè®¡ç®åé½ç¨å¨âååâä¸ï¼ç¡®ä¿æ¯ä»ãä¸åç­æ ¸å¿åè½çéæ é»ãå¯¹ç¨æ·èè¨ï¼ä¸ä¸ªè½æç¡®åç¥âç³»ç»ç¹å¿ï¼è¯·ç¨ååè¯âçç³»ç»ï¼è¿æ¯ä¸ä¸ªæ°¸è¿å¨å è½½ä¸­ãæç»è¶æ¶çç³»ç»æ´å¼å¾ä¿¡èµã</p>
<p><strong>æªå®å¾ç»­</strong></p>
<p><strong>å¾é«å´ä¸ä½ ç¸éï¼å¦æä½ åæ¬¢æ¬æåå®¹ï¼è®°å¾å³æ³¨å¦!!!</strong></p>

</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/poemyang/" target="_blank">poemyang</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/poemyang/p/19389175" target="_blank">https://www.cnblogs.com/poemyang/p/19389175</a></p>
</div>
<div class="clear"></div>

        <p class="postfoot">
            posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-23 21:16">2025-12-23 21:16</span>&nbsp;
<a href="https://www.cnblogs.com/poemyang">poemyang</a>&nbsp;
éè¯»(<span id="post_view_count">54</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19389175);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19389175', targetLink: 'https://www.cnblogs.com/poemyang/p/19389175', title: 'æµéæ´ªå³°å²ä¸å®çç§å¯ï¼æ­ç§ç³»ç»è¿è½½ä¿æ¤çæ ¸å¿é²çº¿' })">ä¸¾æ¥</a>

        </p>
     ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Kafkaå¥é¨å¿ç¥æ¦å¿µââTopicãååºãOffsetãæ¶è´¹ç»çåä½æºå¶ä¸å½±å ]]></title>
    <link>https://www.cnblogs.com/shiyuelp/p/19389157</link>
    <guid>25e522bbeafcc3a94dfbcb00adc2117e</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/shiyuelp/p/19389157" title="åå¸äº 2025-12-23 21:10">
    <span role="heading" aria-level="2">Kafkaå¥é¨å¿ç¥æ¦å¿µââTopicãååºãOffsetãæ¶è´¹ç»çåä½æºå¶ä¸å½±å</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p><strong>åå¨åé¢ï¼æ¬äººç®åå¤äºæ±èä¸­ï¼å¦æåéåæ¨å²ä½ï¼è¯·å ï¼lpshiyue æè°¢</strong></p>
<blockquote>
<p>çè§£Kafkaçæ ¸å¿æ¦å¿µå¦åææ¡åå¸å¼ç³»ç»çéç¨è¯­è¨ï¼è¿äºåºç¡ç»ä»¶çé«æåä½æ­£æ¯Kafkaæµ·éæ°æ®å¤çè½åçæºæ³</p>
</blockquote>
<p>å¨æ¶æ¯éåéåæ¡æ¶ä¸­ï¼Kafkaä»¥å¶é«ååãå¯æ©å±æ¶ææä¸ºå¤§æ°æ®åºæ¯çé¦éãç¶èï¼è¦çæ­£åæ¥Kafkaçæ½åï¼å¿é¡»æ·±å¥çè§£å¶æ ¸å¿æ¦å¿µä¹é´çåä½å³ç³»ãæ¬æå°å¨é¢è§£æTopicãååºãOffsetåæ¶è´¹ç»åå¤§æ ¸å¿æ¦å¿µï¼æ­ç¤ºå®ä»¬å¦ä½å±åæå»ºKafkaçé«æ§è½æ¶æã</p>
<h2 id="1-kafkaæ¶ææ¦è§ä¸è®¾è®¡å²å­¦">1 Kafkaæ¶ææ¦è§ä¸è®¾è®¡å²å­¦</h2>
<h3 id="11-åå±æ¶æä¸æ°æ®æµ">1.1 åå±æ¶æä¸æ°æ®æµ</h3>
<p>Kafkaéç¨<strong>çäº§è-æ¶è´¹è</strong>ç»å¸æ¶æï¼æ´ä½å¯åä¸ºé»è¾ä¸å±ï¼çäº§èå±è´è´£æ¶æ¯åéï¼Brokeréç¾¤å±å¤çæ¶æ¯å­å¨ä¸è·¯ç±ï¼æ¶è´¹èå±å®ç°æ¶æ¯æ¶è´¹ãè¿ç§æ¸æ°çåå±æ¶æä½¿å¾Kafkaè½å¤é«æå¤çæµ·éæ¶æ¯æµã</p>
<p>Kafkaçè®¾è®¡å²å­¦å´ç»<strong>åå¸å¼ãå¯æ©å±åé«åå</strong>å±å¼ãä¸ä¼ ç»æ¶æ¯ç³»ç»ä¸åï¼Kafkaå°æ¶æ¯æä¹åå°ç£çï¼éè¿é¡ºåºI/Oåé¶æ·è´ææ¯å®ç°é«æ§è½ãè¿ç§è®¾è®¡ä½¿Kafkaæ¢è½ä½ä¸ºæ¶æ¯éåï¼åè½ä½ä¸ºå­å¨ç³»ç»ä½¿ç¨ï¼æ¯ææ¶æ¯åæº¯åéå¤æ¶è´¹ã</p>
<h3 id="12-ç©çå­å¨ä¸é»è¾è§å¾çåç¦»">1.2 ç©çå­å¨ä¸é»è¾è§å¾çåç¦»</h3>
<p>Kafkaåæ°æ§å°å®ç°äº<strong>é»è¾Topicä¸ç©çååºçåç¦»</strong>ãTopicä½ä¸ºé»è¾æ¦å¿µï¼æ¹ä¾¿ä¸å¡åç±»ï¼èååºä½ä¸ºç©çæ¦å¿µï¼å®ç°äºæ°æ®çåå¸å¼å­å¨åå¹¶è¡å¤çãè¿ç§åç¦»æ¯Kafkaé«æ©å±æ§çå³é®ï¼åè®¸éç¾¤éè¿å¢å ååºåBrokeræ¥çº¿æ§æ©å±ååéã</p>
<p><strong>ååºæºå¶</strong>å°æ¯ä¸ªTopicååä¸ºå¤ä¸ªæåºçæ¥å¿åºåï¼åå¸å¨ä¸åBrokerä¸ãå½çäº§èåéæ¶æ¯æ¶ï¼å®éä¸æ¯å°æ¶æ¯åå¥ç¹å®Topicçç¹å®ååºï¼æ¶è´¹èä¹æ¯ä»ç¹å®ååºè¯»åæ¶æ¯ãè¿ç§è®¾è®¡æ¢ä¿è¯äºååºåæ¶æ¯é¡ºåºï¼åéè¿å¹¶è¡å¤çæåäºæ´ä½ååéã</p>
<h2 id="2-topicä¸ååºæ°æ®åå¸çæ ¸å¿æºå¶">2 Topicä¸ååºï¼æ°æ®åå¸çæ ¸å¿æºå¶</h2>
<h3 id="21-topicçé»è¾æ½è±¡ä¸ç©çå®ç°">2.1 Topicçé»è¾æ½è±¡ä¸ç©çå®ç°</h3>
<p><strong>Topicæ¯æ¶æ¯çé»è¾å®¹å¨</strong>ï¼ç±»ä¼¼äºæ°æ®åºä¸­çè¡¨ãçäº§èå°æ¶æ¯åéå°æå®Topicï¼æ¶è´¹èä»Topicè®¢éæ¶æ¯ãTopicæ¬èº«ä¸å­å¨æ°æ®ï¼èæ¯éè¿å¶ä¸çååºå®éæ¿è½½æ¶æ¯ã</p>
<p>æ¯ä¸ªTopicç±ä¸ä¸ªæå¤ä¸ª<strong>ååºï¼Partitionï¼</strong> ç»æï¼ååºæ¯Kafkaå¹¶è¡å¤ççåºæ¬åä½ãååºå¨ç©çä¸å¯¹åºç£çä¸çç®å½ï¼å½åè§åä¸º<code>&lt;topic_name&gt;-&lt;partition_id&gt;</code>ãä¾å¦ï¼åä¸º"user_behavior"çTopicè¥æ3ä¸ªååºï¼åå¯¹åºä¸ä¸ªç®å½ï¼user_behavior-0ãuser_behavior-1ãuser_behavior-2ã</p>
<h3 id="22-ååºç­ç¥ä¸æ¶æ¯è·¯ç±">2.2 ååºç­ç¥ä¸æ¶æ¯è·¯ç±</h3>
<p>Kafkaæä¾çµæ´»çååºç­ç¥ï¼å³å®æ¶æ¯å¦ä½è·¯ç±å°ç¹å®ååºã<strong>é»è®¤ååºç­ç¥</strong>åºäºKeyçåå¸å¼ï¼å½æ¶æ¯æå®Keyæ¶ï¼ä½¿ç¨<code>hash(key) % ååºæ°</code>è®¡ç®ç®æ ååºï¼æªæå®Keyæ¶ï¼éç¨è½®è¯¢ç­ç¥åååå¸ã</p>
<pre><code class="language-java">// ååºç­ç¥æ ¸å¿é»è¾ç¤ºä¾
List&lt;PartitionInfo&gt; partitions = cluster.partitionsForTopic(topic);
if (key != null) {
    // æKeyåå¸ååºï¼ä¿è¯åä¸Keyçæ¶æ¯è¿å¥åä¸ååº
    return Math.abs(key.hashCode()) % partitions.size();
} else {
    // è½®è¯¢ç­ç¥ï¼åååå¸
    return nextRoundRobinIndex() % partitions.size();
}
</code></pre>
<p><strong>ååºç­ç¥çéæ©ç´æ¥å½±åæ¶æ¯é¡ºåºæ§åè´è½½åè¡¡</strong>ãæKeyåå¸ååºä¿è¯ç¸åKeyçæ¶æ¯é¡ºåºå¤çï¼éåéè¦ä¿åºçåºæ¯ï¼è½®è¯¢ç­ç¥åæä¾æ´å¥½çè´è½½åè¡¡ï¼éåæ é¡ºåºè¦æ±çåºæ¯ã</p>
<h3 id="23-ååºæ°éçæè¡¡èºæ¯">2.3 ååºæ°éçæè¡¡èºæ¯</h3>
<p>ååºæ°éæ¯Kafkaæ§è½è°ä¼çå³é®åæ°ã<strong>ååºè¿å°</strong>ä¼å¯¼è´æ æ³ååå©ç¨éç¾¤å¹¶è¡è½åï¼<strong>ååºè¿å¤</strong>åå¢å åæ°æ®å¼éåRebalanceææ¬ã</p>
<p>å®è·µç»éªè¡¨æï¼ååºæ°éåºå½ä¸æ¶è´¹èæ°éç¸å¹éï¼ä¸èèæªæ¥æ©å±éæ±ãéå¸¸å»ºè®®åä¸ªBrokerçååºæ»æ°ä¸è¶è¿2000-4000ä¸ªï¼ä»¥é¿åæä»¶å¥æååå­å¼éè¿å¤§ã</p>
<h2 id="3-æ¶è´¹èç»ä¸è´è½½åè¡¡æºå¶">3 æ¶è´¹èç»ä¸è´è½½åè¡¡æºå¶</h2>
<h3 id="31-æ¶è´¹èç»æ¨¡ååå¶ä¼å¿">3.1 æ¶è´¹èç»æ¨¡ååå¶ä¼å¿</h3>
<p><strong>æ¶è´¹èç»ï¼Consumer Groupï¼</strong> æ¯Kafkaå®ç°è´è½½åè¡¡åå®¹éçæ ¸å¿æºå¶ãç»åå¤ä¸ªæ¶è´¹èå®ä¾å±åæ¶è´¹ä¸ä¸ªæå¤ä¸ªTopicï¼æ¯ä¸ªååºå¨åä¸æ¶é´åªè½è¢«ç»åä¸ä¸ªæ¶è´¹èæ¶è´¹ã</p>
<p>æ¶è´¹èç»æ¨¡ååæ¶æ¯æ<strong>åå¸-è®¢é</strong>å<strong>ç¹å¯¹ç¹</strong>ä¸¤ç§æ¶æ¯æ¨¡å¼ï¼å½ä¸ååºç¨ä½¿ç¨ä¸åGroup IDæ¶ï¼å®ç°å¹¿æ­ææï¼å½åä¸åºç¨å¤ä¸ªå®ä¾ä½¿ç¨ç¸åGroup IDæ¶ï¼å®ç°è´è½½åè¡¡ã</p>
<h3 id="32-rebalanceæºå¶ä¸ååºåé">3.2 Rebalanceæºå¶ä¸ååºåé</h3>
<p><strong>Rebalanceæ¯æ¶è´¹èç»çæ ¸å¿åè°æºå¶</strong>ï¼å¨ä»¥ä¸æåµä¸è§¦åï¼æ¶è´¹èå å¥æç¦»å¼ç»ãTopicååºæ°ååãè®¢éTopicååãRebalanceè¿ç¨åæ¬ä¸ä¸ªé¶æ®µï¼</p>
<ol>
<li><strong>Joiné¶æ®µ</strong>ï¼æææ¶è´¹èååè°èæ³¨å</li>
<li><strong>Syncé¶æ®µ</strong>ï¼ç»Leaderè®¡ç®åéæ¹æ¡å¹¶åæ­¥ç»æææå</li>
<li><strong>æ§è¡é¶æ®µ</strong>ï¼æ¶è´¹èå¼å§ä»åéçååºæ¶è´¹</li>
</ol>
<p>Kafkaæä¾å¤ç§<strong>ååºåéç­ç¥</strong>ï¼æ»¡è¶³ä¸ååºæ¯éæ±ï¼</p>
<ul>
<li><strong>Rangeç­ç¥</strong>ï¼é»è®¤ï¼ï¼æTopicç»´åº¦é¡ºåºåéï¼å¯è½å¯¼è´è´è½½ä¸å</li>
<li><strong>RoundRobinç­ç¥</strong>ï¼ææååºè½®è¯¢åéï¼è´è½½æ´åè¡¡</li>
<li><strong>Stickyç­ç¥</strong>ï¼å°½éåå°ååºç§»å¨ï¼åå°Rebalanceå¼é</li>
</ul>
<h3 id="33-æ¶è´¹èä½ç§»ç®¡ç">3.3 æ¶è´¹èä½ç§»ç®¡ç</h3>
<p><strong>Offsetæ¯æ¶è´¹èå¨ååºä¸­çæ¶è´¹ä½ç½®</strong>ï¼æ¯ååºåæ¶æ¯çå¯ä¸æ è¯ãKafkaå°ä½ç§»ä¿¡æ¯å­å¨å¨ç¹æ®ç<code>__consumer_offsets</code> Topicä¸­ï¼é»è®¤50ä¸ªååºï¼éè¿<code>Math.abs(groupId.hashCode()) % 50</code>è®¡ç®å­å¨ä½ç½®ã</p>
<p>ä½ç§»æäº¤æ¹å¼å½±åæ¶æ¯å¤çç<strong>ç²¾ç¡®ä¸æ¬¡æ§</strong>è¯­ä¹ï¼</p>
<ul>
<li><strong>èªå¨æäº¤</strong>ï¼ç®åä½å¯è½éå¤æ¶è´¹æä¸¢å¤±æ¶æ¯</li>
<li><strong>æå¨æäº¤</strong>ï¼æ´ç²¾ç¡®æ§å¶ï¼æ¯æåæ­¥åå¼æ­¥æ¹å¼</li>
</ul>
<h2 id="4-å¯æ¬æºå¶ä¸é«å¯ç¨æ§">4 å¯æ¬æºå¶ä¸é«å¯ç¨æ§</h2>
<h3 id="41-leader-followeræ¶æ">4.1 Leader-Followeræ¶æ</h3>
<p>Kafkaéè¿<strong>å¯æ¬æºå¶</strong>ä¿è¯æ°æ®é«å¯ç¨ãæ¯ä¸ªååºæå¤ä¸ªå¯æ¬ï¼åä¸ºLeaderåFollowerä¸¤ç§è§è²ãLeaderå¤çææè¯»åè¯·æ±ï¼Followerä»Leaderåæ­¥æ°æ®ãå½Leaderå¤±ææ¶ï¼Kafkaä»ISRï¼In-Sync Replicasï¼ä¸­éæ©æ°çLeaderã</p>
<p><strong>ISRæºå¶</strong>ç»´æ¤ä¸Leaderä¿æåæ­¥çå¯æ¬éåãFollowerå¿é¡»å®æåLeaderåéå¿è·³ï¼è¥è¶è¿<code>replica.lag.time.max.ms</code>ï¼é»è®¤10ç§ï¼æªåæ­¥ï¼åè¢«ç§»åºISRãè¿ç§è®¾è®¡æ¢ä¿è¯æ°æ®ä¸è´æ§ï¼åæä¾æéè½¬ç§»è½åã</p>
<h3 id="42-æ°æ®å¯é æ§éç½®">4.2 æ°æ®å¯é æ§éç½®</h3>
<p>çäº§èå¯éè¿<strong>acksåæ°</strong>éç½®æ°æ®å¯é æ§çº§å«ï¼</p>
<ul>
<li><strong>acks=0</strong>ï¼æ ç¡®è®¤ï¼æé«ååä½å¯è½ä¸¢å¤±æ°æ®</li>
<li><strong>acks=1</strong>ï¼Leaderç¡®è®¤ï¼åè¡¡éæ©</li>
<li><strong>acks=all</strong>ï¼ææISRå¯æ¬ç¡®è®¤ï¼æå¯é </li>
</ul>
<p>å¨è¦æ±é«å¯é æ§çåºæ¯ä¸­ï¼å»ºè®®éç½®<code>acks=all</code>å¹¶è®¾ç½®<code>min.insync.replicas</code>ï¼é»è®¤1ï¼ï¼ç¡®ä¿åå¥å¤ä¸ªå¯æ¬åæè¿åæåã</p>
<h2 id="5-æ ¸å¿æ¦å¿µçååæåº">5 æ ¸å¿æ¦å¿µçååæåº</h2>
<h3 id="51-åèåä½çé«æ§è½å¥¥ç§">5.1 åèåä½çé«æ§è½å¥¥ç§</h3>
<p>TopicãååºãOffsetåæ¶è´¹ç»åä¸ªæ¦å¿µç¸äºåä½ï¼å½¢æKafkaé«æ§è½çåºç³ï¼<strong>Topicæä¾é»è¾åç±»ï¼ååºå®ç°å¹¶è¡å¤çï¼Offsetè®°å½æ¶è´¹è¿åº¦ï¼æ¶è´¹ç»ä¿éè´è½½åè¡¡</strong>ã</p>
<p>è¿ç§åä½æºå¶çå®éææä½ç°å¨ï¼<strong>æ¨ªåæ©å±è½å</strong>éè¿å¢å ååºåæ¶è´¹èå®ç°ï¼<strong>å®¹éæ§</strong>éè¿å¯æ¬æºå¶ä¿éï¼<strong>æ¶æ¯é¡ºåºæ§</strong>å¨ååºåå¾å°ä¿è¯ï¼<strong>è´è½½åè¡¡</strong>éè¿æ¶è´¹ç»èªå¨å®ç°ã</p>
<h3 id="52-å®éåºç¨ä¸­çéç½®ç­ç¥">5.2 å®éåºç¨ä¸­çéç½®ç­ç¥</h3>
<p>å¨å®éåºç¨ä¸­ï¼éè¦æ ¹æ®ä¸å¡ç¹ç¹åçéç½®è¿äºæ¦å¿µåæ°ï¼<strong>é«åååºæ¯</strong>å¯å¢å ååºæ°å¹¶ä½¿ç¨è½®è¯¢ç­ç¥ï¼<strong>ä¿åºè¦æ±é«</strong>çåºæ¯åºéç¨Keyåå¸ååºï¼<strong>å®¹éè¦æ±é«</strong>ééç½®å¤å¯æ¬åacks=allã</p>
<p>ä»¥ä¸æ¯ä¸ä¸ªå¸åçµåå¹³å°çKafkaéç½®ç¤ºä¾ï¼</p>
<pre><code class="language-yaml"># è®¢åTopicéç½®
order.topic.partitions: 12        # å¹éæ¶è´¹èæ°é
order.topic.replication: 3        # é«å¯ç¨éç½®
order.consumer.group: order-processors
order.consume.threads: 12         # ä¸ååºæ°å¹é

# æ¥å¿Topicéç½®  
log.topic.partitions: 24          # é«ååéæ±
log.topic.replication: 2           # å¯æ¥åä¸å®æ°æ®ä¸¢å¤±
log.consumer.group: log-analyzers
</code></pre>
<h2 id="6-å®è·µä¸­çå¸¸è§é®é¢ä¸è§£å³æ¹æ¡">6 å®è·µä¸­çå¸¸è§é®é¢ä¸è§£å³æ¹æ¡</h2>
<h3 id="61-æ°æ®å¾æä¸ç­ç¹ååº">6.1 æ°æ®å¾æä¸ç­ç¹ååº</h3>
<p><strong>æ°æ®å¾æ</strong>æ¯å¸¸è§é®é¢ï¼è¡¨ç°ä¸ºé¨åååºè´è½½è¿é«ãè§£å³æ¹æ¡åæ¬ï¼ä½¿ç¨æ´ååçKeyåå¸ãéç¨è½®è¯¢ç­ç¥ãå¢å ååºæ°æå®ç°èªå®ä¹ååºç­ç¥ã</p>
<h3 id="62-rebalanceé£æ´ä¸æ¶è´¹èç¨³å®æ§">6.2 Rebalanceé£æ´ä¸æ¶è´¹èç¨³å®æ§</h3>
<p><strong>é¢ç¹Rebalance</strong>ä¼å¯¼è´æ¶è´¹èé¢ç¹åé¡¿ãä¼åæ¹æ¡åæ¬ï¼è°æ´<code>session.timeout.ms</code>å<code>heartbeat.interval.ms</code>åæ°ãä½¿ç¨Stickyåéç­ç¥ãé¿åæ¶è´¹èé¢ç¹å¯åã</p>
<h3 id="63-ä½ç§»ç®¡ççæä½³å®è·µ">6.3 ä½ç§»ç®¡ççæä½³å®è·µ</h3>
<p>ä½ç§»ç®¡çä¸å½å¯è½å¯¼è´<strong>éå¤æ¶è´¹ææ¶æ¯ä¸¢å¤±</strong>ãå»ºè®®éç¨æå¨æäº¤ä½ç§»ï¼å¨æ¶æ¯å¤çå®æååæ­¥æäº¤ï¼å¹¶å¨æ¶è´¹èéå¯æ¶ä»æ­£ç¡®ä½ç½®å¼å§æ¶è´¹ã</p>
<h2 id="æ»ç»">æ»ç»</h2>
<p>Kafkaçæ ¸å¿æ¦å¿µä½ç³»ææäºä¸ä¸ªå®æ´çé«æ§è½æ¶æ¯å¤ççæç³»ç»ãTopicä¸ååºçåç¦»å®ç°äºé»è¾ä¸ç©ççè§£è¦ï¼æ¶è´¹ç»æºå¶æä¾äºçµæ´»çè´è½½åè¡¡æ¹æ¡ï¼Offsetç®¡çç¡®ä¿äºæ¶æ¯å¤ççå¯é æ§ï¼å¯æ¬æºå¶ä¿éäºç³»ç»çé«å¯ç¨æ§ã</p>
<p>çè§£è¿äºæ¦å¿µä¸ä»æå©äºæ­£ç¡®ä½¿ç¨Kafkaï¼æ´è½ä¸ºåå¸å¼ç³»ç»è®¾è®¡æä¾éè¦å¯ç¤ºã<strong>åå¸å¼ç³»ç»çæ¬è´¨æ¯éè¿åçå®ç°æ©å±ï¼éè¿å¯æ¬å®ç°å®¹éï¼éè¿åè°æºå¶å®ç°ä¸è´æ§</strong>ââè¿æ­£æ¯Kafkaæ¶æææ³çç²¾é«ã</p>
<p>éçä¸å¡è§æ¨¡çå¢é¿ï¼å¯¹è¿äºæ ¸å¿æ¦å¿µçæ·±å¥çè§£å°å¸®å©å¼åèå¨æ§è½ãå¯é æ§åå¤æåº¦ä¹é´æ¾å°æä½³å¹³è¡¡ç¹ï¼æå»ºçæ­£ç¨³å®é«æçæ°æ®å¤çå¹³å°ã</p>
<hr>
<p><strong>ð ä¸ç¯é¢å</strong><br>
ãå¯é æ§ä¸é¡ºåºæ§ä¿éââå¹ç­ãäºå¡ä¸Exactly-onceè¯­ä¹çéç¨è¾¹çãââ æä»¬å°æ·±å¥æ¢è®¨ï¼</p>
<ul>
<li>ð <strong>å¹ç­çäº§åç</strong>ï¼PIDãåºåå·ä¸Brokerå»éæºå¶çååå·¥ä½</li>
<li>â¡ <strong>äºå¡æ¶æ¯æºå¶</strong>ï¼è·¨ååºåå­åå¥ä¸æä¹åä¿è¯çå®ç°è·¯å¾</li>
<li>ð¯ <strong>Exactly-onceè¯­ä¹</strong>ï¼æµå¤çåºæ¯ä¸çç²¾ç¡®ä¸æ¬¡æ§äº¤ä»ä¿é</li>
<li>ð <strong>æ§è½ä¸å¯é æ§æè¡¡</strong>ï¼ä¸åå¯é æ§çº§å«çååéå½±åéååæ</li>
<li>ð¡ï¸ <strong>å®è·µéç½®æå</strong>ï¼çäº§èACKãISRéç½®ä¸æéæ¢å¤çæä½³å®è·µ</li>
</ul>
<p><strong>ç¹å»å³æ³¨ï¼ææ¡Kafkaæ°æ®å¯é æ§çæ ¸å¿ææ¯ï¼</strong></p>
<blockquote>
<p><strong>ä»æ¥è¡å¨å»ºè®®</strong>ï¼</p>
<ol>
<li>å®¡æ¥ç°æKafka Topicçååºéç½®ï¼ç¡®ä¿ä¸æ¶è´¹èæ°éå¹é</li>
<li>è¯ä¼°æ°æ®åå¸æåµï¼è¯å«å¯è½çç­ç¹ååºé®é¢</li>
<li>ä¼åæ¶è´¹èç»éç½®ï¼åå°ä¸å¿è¦çRebalanceæä½</li>
<li>å»ºç«ä½ç§»çæ§æºå¶ï¼ç¡®ä¿æ¶æ¯æ¶è´¹è¿åº¦å¯è§æµ</li>
</ol>
</blockquote>

</div>
<div id="MySignature" role="contentinfo">
    è¿é¶ä¹è·¯ï¼ç¥æ¡æç¥ä½æ¡æä½ï¼æ¬¢è¿å¤§å®¶ä¸èµ·å ï¼±ï¼±ç¾¤å±åè®¨è®ºæé¿ï¼ç¾¤å·ï¼<a href="https://jq.qq.com/?_wv=1027&amp;k=4AiobC0" target="view_window">620095084</a>
<br>
æ¬¢è¿æç´¢å³æ³¨å¾®ä¿¡å¬ä¼å· åºç¡å¨ç¥é ï¼JavaBasis ï¼ç¬¬ä¸æ¶é´éè¯»ææ°æç« 
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-23 21:11">2025-12-23 21:10</span>&nbsp;
<a href="https://www.cnblogs.com/shiyuelp">åæåå</a>&nbsp;
éè¯»(<span id="post_view_count">51</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19389157);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19389157', targetLink: 'https://www.cnblogs.com/shiyuelp/p/19389157', title: 'Kafkaå¥é¨å¿ç¥æ¦å¿µââTopicãååºãOffsetãæ¶è´¹ç»çåä½æºå¶ä¸å½±å' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨åï¼è®¡ç®æºè§è§  ç¬¬ä¸å¨ï¼æ£æµç®æ³ ï¼äºï¼ç®æ æ£æµç®æ³ ]]></title>
    <link>https://www.cnblogs.com/Goblinscholar/p/19389081</link>
    <guid>d861b65450e2a1bf99d423d32b8fb709</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Goblinscholar/p/19389081" title="åå¸äº 2025-12-23 20:53">
    <span role="heading" aria-level="2">å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨åï¼è®¡ç®æºè§è§  ç¬¬ä¸å¨ï¼æ£æµç®æ³ ï¼äºï¼ç®æ æ£æµç®æ³</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æ­¤åç±»ç¨äºè®°å½å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨çå­¦ä¹ ç¬è®°ã<br>
è¯¾ç¨ç¸å³ä¿¡æ¯é¾æ¥å¦ä¸ï¼</p>
<ol>
<li>åè¯¾ç¨è§é¢é¾æ¥ï¼<a href="https://www.bilibili.com/video/BV1FT4y1E74V?buvid=XU762317353676D786954061C192FE625463B&amp;from_spmid=playlist.playlist-detail.0.0&amp;is_story_h5=false&amp;mid=zqernykrmpf7XfIorMR%2FnA%3D%3D&amp;plat_id=116&amp;share_from=ugc&amp;share_medium=android&amp;share_plat=android&amp;share_session_id=ce0bc526-db69-428a-962e-c65ed8c267bc&amp;share_source=COPY&amp;share_tag=s_i&amp;spmid=united.player-video-detail.0.0&amp;timestamp=1713085655&amp;unique_k=DfBgvFW&amp;up_id=8654113&amp;vd_source=e035e9878d32f414b4354b839a4c31a4" target="_blank" rel="noopener nofollow">[åè¯­å­å¹]å´æ©è¾¾æ·±åº¦å­¦ä¹ deeplearning.ai</a></li>
<li>githubè¯¾ç¨èµæï¼å«è¯¾ä»¶ä¸ç¬è®°:<a href="https://github.com/robbertliu/deeplearning.ai-andrewNG" target="_blank" rel="noopener nofollow">å´æ©è¾¾æ·±åº¦å­¦ä¹ æå­¦èµæ</a></li>
<li>è¯¾ç¨éå¥ç»ä¹ ï¼ä¸­è±ï¼ä¸ç­æ¡ï¼<a href="https://blog.csdn.net/u013733326/article/details/79827273" target="_blank" rel="noopener nofollow">å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾åä¹ é¢ä¸ç­æ¡</a></li>
</ol>
<p>æ¬ç¯ä¸ºç¬¬åè¯¾çç¬¬ä¸å¨åå®¹ï¼<a href="https://www.bilibili.com/video/BV1FT4y1E74V?spm_id_from=333.788.videopod.episodes&amp;vd_source=e035e9878d32f414b4354b839a4c31a4&amp;p=132" target="_blank" rel="noopener nofollow">3.3</a>å°<a href="https://www.bilibili.com/video/BV1FT4y1E74V?spm_id_from=333.788.videopod.episodes&amp;vd_source=e035e9878d32f414b4354b839a4c31a4&amp;p=134" target="_blank" rel="noopener nofollow">3.5</a>çåå®¹ã</p>
<hr>
<p>æ¬å¨ä¸ºç¬¬åè¯¾çç¬¬ä¸å¨åå®¹ï¼è¿ä¸è¯¾ææåå®¹çä¸­å¿åªæä¸ä¸ªï¼<strong>è®¡ç®æºè§è§</strong>ãåºç¨å¨æ·±åº¦å­¦ä¹ éï¼å°±æ¯ä¸é¨ç¨æ¥è¿è¡å¾å­¦ä¹ çæ¨¡ååææ¯ï¼æ¯å¨ä¹åå¨è¿æ¥åºç¡ä¸çâç¹åâï¼ä¹æ¯ç¸å³ä¸ä¸éçä¸ä¸ªéè¦ç ç©¶å¤§ç±»ã<br>
<strong>è¿ä¸æ´èè¯¾é½å­å¨å¤§ééè¦åå¤çè§£çåå®¹åæºå¨å­¦ä¹ ãæ°å­¦åºç¡ã</strong> å æ­¤æä¼å°½å¯è½çè¡¥è¶³åºç¡ï¼ç¨æ¯å»åå®ä¾æ¥æ¼ç¤ºæ¯ä¸ªé¨åï¼ä»èå¸®å©çè§£ã<br>
ç¬¬ä¸å¨çåå®¹å°ä»<strong>å¾ååç±»</strong>è¿ä¸æ­¥æå±å°<strong>ç®æ æ£æµï¼Object Detectionï¼</strong> è¿ä¸æ´å·æææ§çè®¡ç®æºè§è§ä»»å¡ã<br>
ä¸åç±»ä»»å¡åªéåç­âå¾ä¸­æä»ä¹âä¸åï¼ç®æ æ£æµéè¦åæ¶è§£å³â <strong>æä»ä¹</strong>âä»¥åâ<strong>å¨ä»ä¹ä½ç½®</strong>âä¸¤ä¸ªé®é¢ï¼å æ­¤å¨æ¨¡åç»æè®¾è®¡ãè®­ç»æ¹å¼åè¯ä»·æ åä¸é½æ´ä¸ºå¤æã<br>
æ¬ç¯çåå®¹å³äºç®æ æ£æµç®æ³ã</p>
<h1 id="1-æ£æµç®æ³10å¯¹çªå£åç±»">1. æ£æµç®æ³1.0ï¼å¯¹çªå£åç±»</h1>
<p>æä»¬ç¥éï¼æ³è¦å®ç°ç®æ æ£æµï¼é¦åå°±è¦å®æ<strong>ç®æ è¯å«</strong>ã<br>
åªæå½æ¨¡åè½å¤åç­â<strong>è¦æ¾ä»ä¹</strong>âåï¼æä»¬ææå¯è½è¿ä¸æ­¥è®©å®åç­â<strong>å®å¨åªé</strong>âã</p>
<p>å¨æ©æï¼äººä»¬å¹¶æ²¡æä¸å¥ä¸é¨ä¸ºâæ£æµâè®¾è®¡çç½ç»ç»æï¼äºæ¯æäººæåºäºè¿æ ·ä¸ç§æ³æ³ï¼<strong>æ¢ç¶åç±»ç½ç»å·²ç»å¾æçï¼é£è½ä¸è½æâæ¾ä½ç½®âè¿ä¸ªé®é¢ï¼è½¬åæä¸å âåç±»é®é¢âï¼</strong></p>
<p>èå®ç°è¿ç§é»è¾çå·ä½åæ³å°±æ¯<strong>æ»å¨çªå£ï¼Sliding Windowï¼</strong>ã<br>
å¨è¿ç§æ¹æ³ä¸­ï¼æä»¬ç¨ä¸ä¸ª<strong>åºå®å¤§å°ççªå£</strong>å¨æ´å¼ å¾åä¸ä»å·¦å°å³ãä»ä¸å°ä¸ä¸æ­<strong>æ»å¨</strong>ï¼æå¾åè£åªæä¸åä¸åçå°åºåã<br>
ç¶åï¼å°æ¯ä¸ä¸ªçªå£é½åç¬éå¥ä¸ä¸ªå·²ç»è®­ç»å¥½ç<strong>å¾ååç±»ç½ç»</strong>ä¸­ï¼å¤æ­è¿ä¸ªçªå£éâææ²¡æç®æ âã<br>
å¦ææä¸ªçªå£è¢«åç±»å¨å¤æ­ä¸ºâæ±½è½¦ââè¡äººâç­ç®æ ç±»å«ï¼é£ä¹æä»¬å°±è®¤ä¸ºï¼<strong>ç®æ å°±åºç°å¨è¿ä¸ªçªå£æå¯¹åºçä½ç½®ä¸ã</strong><br>
å°±åè¿æ ·ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202512/3708248-20251223205038950-257158416.png" alt="image.png" loading="lazy"></p>
<p>ä»æ´ä½ä¸çï¼è¿ç§æ£æµæµç¨å¯ä»¥è¢«çè§£ä¸ºï¼</p>
<ol>
<li>ç¨æ»å¨çªå£ <strong>æä¸¾å¯è½çä½ç½®</strong></li>
<li>ç¨åç±»ç½ç» <strong>å¤æ­æ¯ä¸ªä½ç½®æ¯ä»ä¹</strong></li>
<li>å°è¢«å¤å®ä¸ºç®æ ççªå£ä½ç½®ï¼ä½ä¸ºæç»çæ£æµç»æ</li>
</ol>
<p>ä½æ¾ç¶ï¼å³ä½¿åè®¾åç±»å¨å®å¨åç¡®ï¼è¿ç§ç®æ³ä»æå®çä¸è¶³ä¹å¤ã<br>
å¯¹äºæ»å¨çªå£ï¼æä»¬å¯ä»¥è®¾ç½®å®ç<strong>å°ºå¯¸åæ­¥é¿</strong>æ¥è°æ´å®å¨å¾åä¸­çè¿å¨è½¨è¿¹ï¼è¿ç§åºå®çè®¾ç½®é½ååæ­»æ¿ï¼ä¸åæ¶å¾é¾å¼é¡¾<strong>ä¸åå¤§å°ç®æ çå®æ´è¦ç</strong>ã<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202512/3708248-20251223205039012-1879118197.png" alt="image.png" loading="lazy"></p>
<p>å æ­¤ï¼ä½ ä¼åç°è¿ç§æ£æµæ¹æ³å¶å®æ¯ä¸ç§âåå·§âï¼å®æ¬è´¨ä¸å¹¶æ²¡æâç´æ¥å­¦ä½ç½®âï¼èæ¯éè¿<strong>å¤§éçå±é¨åç±»ç»æ</strong>ï¼é´æ¥æ¼ååºç®æ çä½ç½®ï¼å¨ä¾èµåç¬è®­ç»çåç±»å¨åç¡®ççåæä¸è¿éè¦æå¤§çè®¡ç®éã<br>
äºæ¯ä¸ä¸æ­¥æ¹è¿åºç°äºã</p>
<h1 id="2-æ£æµç®æ³20å¯¹æ´å¹å¾ååºç¨å·ç§¯">2. æ£æµç®æ³2.0ï¼å¯¹æ´å¹å¾ååºç¨å·ç§¯</h1>
<p>ä¸ºäºæ´å¥½å°è¿è¡ç®æ æ£æµï¼é¢å¯¹ 1.0 ä¸­åºç°çæå¤§è®¡ç®éé®é¢ï¼äººä»¬è¿ç¨æ°å­¦é»è¾ï¼åç°äºè¿æ ·ä¸ç§æåµï¼<strong>å½ä¸ºäºæ´ç²¾åçæ£æµèåºç¨æ´å°æ­¥é¿ççªå£æ¶ï¼ç¸é»ççªå£å­å¨å¬å±åºåï¼è®©é¨åè®¡ç®éå¤è¿è¡ã</strong><br>
<img src="https://img2024.cnblogs.com/blog/3708248/202512/3708248-20251223205041096-1719506100.png" alt="image.png" loading="lazy"><br>
èå¦æä¸å¸æåºç°å¬å±åºåï¼é£å°±åè¦å¢å¤§æ­¥é¿è³åå°ºå¯¸åå¤§å°ï¼å°±ååå°äºæ¼æ£å°ç®æ ãå®ä½ä¸ç²¾ç¡®çé®é¢ã<br>
ææ²¡æä¸ç§åæ³ï¼<strong>æ¢è½äº«æå°æ­¥é¿å¸¦æ¥çç²¾ç¡®åº¦ï¼åè½è®©éå¤è®¡ç®çç»æå¤ç¨ä»èååå°è®¡ç®éå¢ï¼</strong><br>
æçåå¼ï¼æçã</p>
<p>å¨ 2014 å¹´ï¼ä¸ç¯åä¸º <a href="https://arxiv.org/pdf/1312.6229" target="_blank" rel="noopener nofollow">OverFeat: Integrated Recognition, Localization and Detection using Convolutional Networks</a> çè®ºæåè¡¨ï¼æåºäºä¸ä¸ªå©ç¨å·ç§¯ç¥ç»ç½ç»åæ¶å®ç°<strong>åç±»ãå®ä½åæ£æµ</strong>çç»ä¸æ¡æ¶ã<br>
èç¸æ¯ 1.0 ç®æ³ï¼2.0 æå¤§çæ¹åå°±æ¯<strong>ä¸åææ¯ä¸ªçªå£è£åºæ¥éè¿ç½ç»ï¼èæ¯ç´æ¥ææ´å¼ å¾åéè¿ç½ç»ï¼è®©å·ç§¯å±èªå¨å®æâæ»å¨ + ç¹å¾æåâçè¿ç¨ï¼ç´æ¥è¾åºå¾ååé¨åçåç±»ç»æã</strong></p>
<p>æä»¬æ¥è¯¦ç»å±å¼è¿ä¸é¨åï¼</p>
<h2 id="21-ä¿®æ¹ç½ç»ç»æéåºè¾åºè¦æ±">2.1 ä¿®æ¹ç½ç»ç»æéåºè¾åºè¦æ±</h2>
<p>æç¡®äºç®æ ä¹åï¼ä½ ä¼åç°ï¼ä¸åäºåæ¬ä½¿ç¨å¨è¿æ¥å±è¾åºä¸ç»´åç±»ç»æï¼ç°å¨æä»¬å¸æ<strong>è®©è¾åºä¸ºä¸ä¸ªäºç»´ç¹å¾å¾ï¼å¾ä¸­æ¯ä¸ä¸ªåç´ å°±ä»£è¡¨ä¸ä¸ªçªå£çåç±»ç»æ</strong>ã<br>
å°±åè¿æ ·ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202512/3708248-20251223205039801-1655184845.png" alt="image.png" loading="lazy"></p>
<p>å æ­¤ï¼ç°å¨æä»¬éè¦ä¿®æ¹ç½ç»ç»æï¼<strong>ä½¿ç¨å·ç§¯å±åä»£åæ¬çå¨è¿æ¥å±ï¼ä¿è¯è¾åºåæ ·ä¸ºç¹å¾å¾</strong>ã<br>
èè¦åçå°å®ç°è¿ä¸é¨åï¼é¦åï¼å°±è¦äºè§£<strong>å¦ä½ç¨å·ç§¯å±ç­æä»£æ¿å¨è¿æ¥å±</strong>ã</p>
<p>åè¯´ç»è®ºï¼<strong>ä½¿ç¨åè¾å¥ç¹å¾å¾å°ºå¯¸ç­å¤§å°çå·ç§¯æ ¸</strong>ã<br>
å°±åè¿æ ·ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202512/3708248-20251223205039223-13958052.png" alt="image.png" loading="lazy"></p>
<p>åå±å¼è¯´è¯´åçï¼<br>
å¨åç±»ç½ç»ä¸­ï¼å½ç¹å¾æåé¨åç»æåï¼è¾å¥å¨è¿æ¥å±çï¼éå¸¸æ¯ä¸ä¸ªå½¢ç¶ä¸º  <span class="math inline">\(H \times W \times C\)</span>  çç¹å¾å¾ã<br>
å¨è¿æ¥å±åçäºæï¼æ¬è´¨ä¸æ¯ï¼  <strong>æè¿æ´ä¸ªç¹å¾å¾âæå¹³âï¼ç¶åä¸ä¸ç»æéåä¸æ¬¡çº¿æ§ç»åï¼è¾åºä¸ä¸ªç»æã</strong><br>
å¦æç¨å¬å¼è¡¨ç¤ºï¼å°±æ¯ï¼</p>
<p></p><div class="math display">\[y = \sum_{i,j,k} w_{i,j,k} \cdot x_{i,j,k} + b
\]</div><p></p><p>æ¢ä¸ä¸ªè§åº¦çï¼è¿ä¸ªè¿ç¨å¶å®éå¸¸åä»ä¹ï¼  ââ<strong>ç¨ä¸ä¸ªåè¾å¥ç¹å¾å¾å°ºå¯¸å®å¨ä¸è´çå·ç§¯æ ¸ï¼å¨ç¹å¾å¾ä¸åä¸æ¬¡å·ç§¯ã</strong><br>
å æ­¤ï¼å½å·ç§¯æ ¸çå°ºå¯¸ç­äºè¾å¥ç¹å¾å¾çç©ºé´å°ºå¯¸æ¶ï¼</p>
<ul>
<li>å·ç§¯æ ¸åªä¼å¨è¾å¥ä¸âæ»å¨âä¸æ¬¡ã</li>
<li>å·ç§¯è¾åºèªç¶å°±æ¯ä¸ä¸ª <span class="math inline">\(1 \times 1\)</span> çç»æã</li>
<li>è¿ä¸ªç»æä¸å¨è¿æ¥å±çè¾åºå¨æ°å­¦å½¢å¼ä¸æ¯<strong>å®å¨ç­ä»·ç</strong>ã</li>
</ul>
<p>å æ­¤å¯ä»¥å¾å°ä¸ä¸ªç´è§çç»è®ºï¼<strong>å¨è¿æ¥å±å¯ä»¥è¢«çä½ä¸ç§ç¹æ®å½¢å¼çå·ç§¯å±ã</strong><br>
ç°å¨ï¼æä»¬å°±äºè§£äºå¦ä½ä¿®æ¹æä»¬åæ¬ä¸ç´ä½¿ç¨çå¨è¿æ¥å±ä½ä¸ºè¾åºå±çç½ç»ç»æï¼ä»èéåºè¾åºä¸ºå¸¦æç©ºé´ç»æçç¹å¾å¾çè¦æ±ã<br>
ç°å¨ï¼å°±æ¥ççï¼è¾å¥æ´å¹å¾åè¿å¥å®ååçç½ç»å¾å°åç±»è¾åºçå·ä½è¿ç¨ã</p>
<h2 id="22-çªå£å¨ç½ç»ä¸­çä¼ æ­">2.2 çªå£å¨ç½ç»ä¸­çä¼ æ­</h2>
<p>æä»¬å°±ç¨è¯¾ç¨éçä¾å­æ¥æ¼ç¤ºä¸ä¸ç½ç»å¦ä½ä¸æ¬¡è¾åºæ´å¹å¾ååä¸ªçªå£çåç±»ç»æï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202512/3708248-20251223205055320-655995691.png" alt="image.png" loading="lazy"></p>
<p>ä½ ä¼åç°ï¼å¾çäºå·ç§¯æä½çç¹æ§ï¼è¾å¥å¾åçå±é¨ç¹å¾æ¬èº«å°±å¨ä¼ æ­ä¸­è¢«ä¸æ­¥æ­¥éä¸­ï¼<strong>ç¬¬ä¸å±ç¹å¾å¾ä¸­çæ¯ä¸ä¸ªåç´ ï¼æ¬èº«å°±å¯¹åºçè¾å¥å¾åä¸­çä¸ä¸ªå°çªå£</strong>ã<br>
èéçç½ç»ä¸æ­å æ·±ï¼å·ç§¯å±ä¸æ­å å ï¼æ¯ä¸ä¸ªç¹å¾ç¹æå¯¹åºçè¾å¥åºåä¸æ­åå¤§ã<br>
æç»ï¼å¨é è¿è¾åºå±çä½ç½®ï¼ç¹å¾å¾ä¸­ç<strong>ä¸ä¸ªä½ç½®</strong>å®éä¸å·²ç»âè¦çâäºè¾å¥å¾åä¸­çä¸ä¸ª<strong>è¾å¤§çªå£åºå</strong>ã<br>
åªä¸è¿ç°å¨çªå£ä¸åç±æä»¬æå¨è£åªï¼èæ¯ç±ç½ç»ç»æ<strong>å³å®</strong>ã</p>
<h2 id="23-æå±ç¹å¾å¾è¾åºçæ ç­¾é®é¢">2.3 æå±ï¼ç¹å¾å¾è¾åºçæ ç­¾é®é¢</h2>
<p>å°è¿éï¼ææ³ä½ å¯è½ä¼æè¿æ ·ä¸ä¸ªé®é¢ï¼<strong>æä»¬è½ç¶æ¹åäºç½ç»ç»æï¼ä½æ¯æä»¬è¿æ¶ä½¿ç¨çè¿æ¯åæ¬åç±»å¨çæ°æ®ï¼å³å¯¹ä¸å¹å¾åçæ ç­¾åªæä¸ä¸ª0æ1æ¥è¡¨ç¤ºå¾åéæ¯å¦å­å¨ç®æ ãç°å¨æä»¬ä¿®æ¹äºè¾åºæ ¼å¼ï¼æ¯å¦éè¦ä¹ä¿®æ¹æ ç­¾ï¼æ¹ä¸ºç»æ¯ä¸ªçªå£ææ ç­¾ï¼</strong><br>
<strong>ç­æ¡æ¯ä¸ç¨ã</strong><br>
ä¸ºä»ä¹ï¼<br>
è½ç¶å¨è®­ç»é¶æ®µï¼ç½ç»æ¥æ¶å°çä»ç¶åªæ¯<strong>å¾åçº§å«çåç±»æ ç­¾</strong>ï¼ä½ç±äºè¾åºå·²ç»è¢«å±å¼ä¸ºä¸ä¸ªå¸¦ç©ºé´ç»æçç¹å¾å¾ï¼è¿ä¸ªæ ç­¾ä¼è¢«<strong>éå¼å°çº¦æå°æ´å¼ ç¹å¾å¾ä¸</strong>ï¼åªè¦æä¸ä¸ªä½ç½®å¯¹åºççªå£è½å¤æ­£ç¡®ååºç®æ ç±»å«ï¼è¿ä¸æ¬¡é¢æµå°±è¢«è®¤ä¸ºæ¯âæåçâã</p>
<p>æ¢å¥è¯è¯´ï¼å·ç§¯åä¹åçåç±»ç½ç»ï¼å¹¶ä¸æ¯å¨å­¦ä¹ âè¿æ´å¼ å¾åæ¯ä¸æ¯ç®æ âï¼èæ¯å¨å­¦ä¹ ï¼<strong>âå¨è¿å¼ å¾åçåªäºä½ç½®ï¼å­å¨ä¸ä¸ªå¯ä»¥è¢«è¯å«ä¸ºç®æ ççªå£âã</strong></p>
<p>æäºæ½è±¡ï¼æä»¬å¯ä»¥æ¥çä¸ä¸ªå·ä½çä¾å­ï¼<br>
åè®¾è®­ç»éä¸­æä¸å¼ å¾çï¼åå®¹æ¯ä¸è¾æ±½è½¦ï¼æ´å¼ å¾åç<strong>å¯ä¸æ ç­¾</strong>å°±æ¯ãcarãã<br>
å½è¿å¼ å¾åè¢«éå¥å·ç§¯ååçç½ç»æ¶ï¼è¾åºçä¸åæ¯ä¸ä¸ªæ éï¼èæ¯ä¸ä¸ª <span class="math inline">\(H' \times W'\)</span> çåç±»ç¹å¾å¾ï¼å¶ä¸­<strong>æ¯ä¸ä¸ªä½ç½®</strong>é½å¯¹åºè¾å¥å¾åä¸­çä¸ä¸ªçªå£ã<br>
å¨åå§è®­ç»é¶æ®µï¼è¿å¼ ç¹å¾å¾ä¸çç»å¤§å¤æ°ä½ç½®ï¼è¾åºçåç±»ç»æå¶å®é½æ¯éè¯¯çï¼</p>
<ul>
<li>æçä½ç½®è¦ççæ¯èæ¯</li>
<li>æçä½ç½®åªè¦çäºæ±½è½¦çä¸é¨å</li>
<li>è¿æçä½ç½®çè³åªåå«å¤©ç©ºæéè·¯</li>
</ul>
<p>ä½è¿å¹¶ä¸ä¼ç ´åè®­ç»è¿ç¨ã<br>
å ä¸ºæ­¤æ¶ç½ç»çç®æ å¹¶ä¸æ¯è¦æ±æ¯ä¸ä¸ªä½ç½®é½é¢æµä¸º carï¼<strong>èæ¯è³å°å­å¨æä¸ä¸ªä½ç½®ï¼å¶å¯¹åºççªå£è½å¤å¯¹ car ç±»å«äº§çè¶³å¤å¼ºçååºã</strong></p>
<p><strong>æ´åç¡®å°è¯´ï¼å¨è®­ç»é¶æ®µï¼å¹¶ä¸æ¯ç´æ¥å°æ´ä¸ª <span class="math inline">\(H' \times W'\)</span> çè¾åºç¹å¾å¾ä¸å¾åçº§æ ç­¾éä½ç½®å¯¹é½è®¡ç®æå¤±ã</strong><br>
ç½ç»éå¸¸ä¼åå¨ç©ºé´ç»´åº¦ä¸è¿è¡ä¸æ¬¡èåæä½ï¼æå¸¸è§çæ¯åæå¤§ååºï¼ï¼å°æ´å¼ ç¹å¾å¾åç¼©ä¸ºä¸ä¸ªæ éé¢æµï¼åä¸å¾åçº§æ ç­¾è®¡ç®åç±»æå¤±ã<br>
è¿ç§è®­ç»æ¹å¼å¯ä»¥è¢«çè§£ä¸ºä¸ç§<strong>å¼±çç£å­¦ä¹ </strong>ï¼<br>
<strong>åªè¦è¾åºç¹å¾å¾ä¸­å­å¨æä¸ä¸ªç©ºé´ä½ç½®ï¼å¯¹ç®æ ç±»å«äº§çäºè¶³å¤å¼ºçååºï¼è¿å¼ å¾åå°±è¢«è®¤ä¸ºé¢æµæ­£ç¡®ã</strong><br>
<img src="https://img2024.cnblogs.com/blog/3708248/202512/3708248-20251223205038766-641170151.png" alt="image.png" loading="lazy"></p>
<p>å¨ååä¼ æ­è¿ç¨ä¸­ï¼æ¢¯åº¦ä¸»è¦ä¼éè¿è¿äºé«ååºä½ç½®åä¼ ï¼ä»èæ¨å¨ç½ç»éæ¸å¼ºåé£äº<strong>ç¡®å®è¦çäºå®æ´ç®æ æå³é®å¤å«åºåçç©ºé´ä½ç½®</strong>ï¼èå¯¹èæ¯åºåçååºèªç¶è¢«åä½ã</p>
<p>æç»ï¼å¨è¾åºç¹å¾å¾ä¸ï¼ä½ ä¼çå°ï¼åªæå°æ°å ä¸ªä½ç½®å¯¹ car ç±»å«äº§çææ¾é«ååºï¼èè¿äºä½ç½®æ°å¥½è½å¨æ±½è½¦æå¨çåºåéè¿ã<br>
æ­¤æ¶ï¼è½ç¶è®­ç»æ ç­¾å§ç»åªæ¯ä¸ä¸ªâå¾åçº§æ ç­¾âï¼ä½ç½ç»å·²ç»<strong>èªå¨å­¦ä¼äºå¨ç©ºé´ç»´åº¦ä¸åºåâåªéå¼å¾ååºâ</strong>ã</p>
<p>äºæ¯æä»¬å°±è§£å³äº 1.0 ç®æ³å¯¼è´çæå¤§è®¡ç®éé®é¢ï¼ä½æ¯è¿æä¸ä¸ªé®é¢ä»ç¶å­å¨ï¼å°±æ¯åºå®å°ºå¯¸ççªå£ä»æ æ³å®ç°å¯¹ç®æ çè¾ç²¾åå®ä½ã<br>
æä¹è§£å³ï¼æ¥çç 3.0 ç®æ³ã</p>
<h1 id="3-æ£æµç®æ³30yolo-ç®æ³">3. æ£æµç®æ³3.0ï¼YOLO ç®æ³</h1>
<p><strong>YOLO ç®æ³æ¯ç®åçæ­£ä¸»æµçç®æ³ä¹ä¸</strong>ï¼ä½ å¯ä»¥å¨ç®åå ä¹ç®æ æ£æµçææé¢åçå°å®çèº«å½±ï¼æ¶è³ä»æ¥ï¼å®ä»å¨ä¸æ­å°æ´æ°ã</p>
<p>è½ç¶å¨ 2.0 ä¸­ï¼çªå£å·²ç»ä¸åç±äººæå·¥æ»å¨ï¼èæ¯ç±ç½ç»ç»æéå¼å³å®ï¼ä½æ¬è´¨å¹¶æ²¡æåï¼<br>
ç½ç»è¾åºçæ¯ï¼ <strong>âè¿ä¸ªçªå£éææ²¡æç®æ â</strong>ï¼èä¸æ¯ï¼<strong>âç®æ å¨åªéãæ¯ä»ä¹ãè¾¹çå¨åªãâ</strong></p>
<p>ä¹å°±æ¯è¯´ï¼2.0 çç½ç»ä¼åè¯ä½ ï¼ âè¿éå¤§æ¦æä¸ª carâï¼ä½ä¸ä¼ç´æ¥åè¯ä½ ï¼âcar çä¸­å¿å¨è¿ï¼å®½é«æ¯å¤å°ãâ<br>
å®çå®ä½åç¡®åº¦é®é¢ä»ç¶å­å¨ä¸ä¸å¯å¿½è§ã<br>
äºæ¯ï¼å¨ 2015 å¹´ï¼ä¸ç¯åä¸º<a href="https://homes.cs.washington.edu/~ali/papers/YOLO.pdf" target="_blank" rel="noopener nofollow">You Only Look Once</a>çè®ºæè¢«åè¡¨ï¼å®çæ ¸å¿è§ç¹å°±æ¯ï¼<strong>è½ä¸è½è®©ç½ç»å«åçº ç»âçªå£âï¼èæ¯ç´æ¥é¢æµç®æ æ¬èº«ï¼</strong></p>
<p>è®ºææ¬èº«è¾ä¸ºå¤æï¼æä»¬æ¥çç YOLO ç¸å¯¹ 1.0ã2.0 æå³é®çæ¹å:<strong>è§èç®æ æ£æµä»»å¡çæ ç­¾</strong>ã</p>
<p>YOLO ç®æ³æ¬èº«ä¸ºç®æ æ£æµä»»å¡æåºäºä¸ç¨çæ ç­¾ï¼æ­£æ¯æä»¬å¨<a href="https://www.cnblogs.com/Goblinscholar/p/19384242" target="_blank">ä¸ä¸ç¯ä¸­</a>ä»ç»çâ<strong>ä½ç½®ä¿¡æ¯</strong>âã<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202512/3708248-20251223205057400-299808113.png" alt="image.png" loading="lazy"></p>
<ol>
<li><span class="math inline">\(p_c\)</span>ï¼è¡¨ç¤º<strong>å½åå¾åä¸­æ¯å¦å­å¨éè¦æ£æµçç®æ </strong>ï¼è¿æ¯ä¸ä¸ªäºå¼åéï¼éå¸¸åå¼ä¸º <span class="math inline">\(0\)</span> æ <span class="math inline">\(1\)</span>ã<br>
å½ <span class="math inline">\(p_c = 1\)</span> æ¶ï¼è¡¨ç¤ºå¾åä¸­ç¡®å®å­å¨ç®æ ï¼æ­¤æ¶åç»­çä½ç½®ä¿¡æ¯åç±»å«ä¿¡æ¯ææ¯âææâçï¼<br>
å½ <span class="math inline">\(p_c = 0\)</span> æ¶ï¼è¡¨ç¤ºå¾åä¸­ä¸å­å¨ç®æ ï¼<strong>å¶ä½åæ°éå¸¸è¢«å¿½ç¥æç½®ä¸º 0ã</strong></li>
<li><span class="math inline">\(b_x,b_y,b_h,b_w\)</span> :è¡¨ç¤ºæ£æµç®æ ç<strong>ä½ç½®ä¿¡æ¯</strong>ã</li>
<li><span class="math inline">\(c_n\)</span>ï¼è¡¨ç¤ºç®æ æå±ç<strong>ç±»å«ä¿¡æ¯</strong>ã<br>
å¨äºåç±»é®é¢ä¸­ï¼å®å¯ä»¥æ¯ä¸ä¸ªæ éï¼<br>
å¨å¤åç±»é®é¢ä¸­ï¼éå¸¸éç¨ <strong>ç¬ç­ç¼ç </strong> çå½¢å¼ï¼ç¨ä¸ä¸ªåéæ¥è¡¨ç¤ºç®æ å±äºåªä¸ç±»ã</li>
</ol>
<p>è§èå¥½æ ç­¾æ¬èº«åï¼æä»¬æ¥ççç®æ³å¦ä½ä½¿ç¨æ ç­¾ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202512/3708248-20251223205038504-641386161.png" alt="image.png" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3708248/202512/3708248-20251223205147720-180508610.png" alt="image.png" loading="lazy"><br>
å æ­¤ï¼ä¸ä¸ªæ ·æ¬å¨ <span class="math inline">\(S \times S\)</span> ç½æ ¼ååä¸ï¼å¶æ ç­¾å¼ éç»´åº¦ä¸ºï¼</p>
<p></p><div class="math display">\[S \times S \times (5 + c_n) 
\]</div><p></p><p>çå°è¿éï¼ä½ å¯è½ä¼çæï¼<strong>ååç½æ ¼çä½ç¨æ¯ä»ä¹ï¼æä»¬æå¼å§è¯´ YOLO é¿å¼äºçªå£åæ¯æä»ä¹ï¼</strong><br>
å«æ¥ï¼å³é®ç¹å°±å¨äºæä»¬ååè§èçæ°æ ç­¾ï¼<span class="math inline">\(b_x,b_y,b_h,b_w\)</span> ã<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202512/3708248-20251223205053651-1469789459.png" alt="image.png" loading="lazy"><br>
ä½ ä¼åç°ï¼éè¿å ä¸ªä½ç½®ä¿¡æ¯åæ°ï¼<strong>æä»¬è½ç¶ååäºç½æ ¼ï¼ä½æ¯ç½æ ¼å´ä¸ä¼åçªå£çæ­¥é¿ä¸æ ·éå¶ç®æ çè¾¹çæ¡ï¼æ¯ä¸ªç½æ ¼ååç¸å½äºä¸ä¸ªé¢æµååæ¥é¢æµä¸­å¿ç¹å¨æ¬ååæ ¼éçç®æ çç±»å«åè¾¹çæ¡ã</strong><br>
ç°å¨ï¼æä»¬å°±å¯ä»¥ç»§ç»­åºç¨ 2.0 ä¸­çç½ç»,è°æ´è¾åºç¹å¾å¾ä¸ºæ°çæ ç­¾ç»´åº¦,å³å¯ä»¥æ­¤è®¡ç®æå¤±å¹¶ååä¼ æ­äºã<br>
ä½ ä¼åç°ï¼YOLO çæ ¸å¿ä¼å¿æ¯ï¼</p>
<ul>
<li>ä¸åæä¸¾çªå£ï¼ä¸åéå¤è®¡ç®ã</li>
<li>æ¯ä¸ªç½æ ¼ååç¬ç«è´è´£é¢æµç®æ ï¼åæ¶è¾åºè¾¹çæ¡åç±»å«ã</li>
<li>è®­ç»æ¶å³å¯ç«¯å°ç«¯ä¼åï¼é¢æµé¶æ®µä¸æ¬¡ååä¼ æ­å®ææ´å¾æ£æµã</li>
</ul>
<p>å¯ä»¥è¯´ï¼YOLO çæåºè®©âæ£æµâçæ­£ä»âåç±»çå»¶ä¼¸âè±ç¦»åºæ¥ï¼æä¸ºè®¡ç®æºè§è§é¢åçæ ¸å¿ä»»å¡ä¹ä¸ï¼å®çåå®¹è¿æå¾å¤ï¼æä»¬éå°åæ¢æ¢å±å¼ã</p>
<h1 id="4æ»ç»">4.æ»ç»</h1>
<table>
<thead>
<tr>
<th>æ¦å¿µ</th>
<th>åç</th>
<th>æ¯å»</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>1.0 æ»å¨çªå£æ£æµ</strong></td>
<td>ä½¿ç¨åºå®å¤§å°çªå£å¨å¾åä¸æ»å¨ï¼å°æ¯ä¸ªçªå£éå¥åç±»ç½ç»å¤æ­æ¯å¦åå«ç®æ ï¼éè¿å±é¨åç±»ç»æé´æ¥æ¼åç®æ ä½ç½®</td>
<td>å°±åç¨æ¾å¤§ééåæ£æ¥æ´å¼ å¾ï¼æ¾å°ç®æ åæ è®°ä½ç½®</td>
</tr>
<tr>
<td><strong>é®é¢</strong></td>
<td>è®¡ç®éå·¨å¤§ï¼æ¯ä¸ªçªå£é½è¦åç¬å¤çï¼å®ä½ç²¾åº¦ä¾èµåç±»ç»ææ¼å</td>
<td>ç¿»éæ´æ¬ä¹¦å¯»æ¾å³é®è¯ï¼æ¯é¡µé½è¦ä»ç»çä¸é</td>
</tr>
<tr>
<td><strong>2.0 å·ç§¯åæ£æµ</strong></td>
<td>å°æ´å¹å¾åéå¥å·ç§¯ç½ç»ï¼å·ç§¯å±èªå¨å®ææ»å¨åç¹å¾æåï¼è¾åºäºç»´ç¹å¾å¾è¡¨ç¤ºåä½ç½®åç±»ç»æï¼å¨è¿æ¥å±å¯è¢«ç­æå·ç§¯æ¿ä»£</td>
<td>ä¸ç¨éé¡µæ£æ¥ï¼èæ¯æ«ææ´æ¬ä¹¦ï¼èªå¨æ è®°åºç°å³é®è¯çåºå</td>
</tr>
<tr>
<td><strong>çªå£å¨ç¹å¾å¾ä¸­ä¼ æ­</strong></td>
<td>éçå·ç§¯å±å å ï¼æ¯ä¸ªç¹å¾å¾ä½ç½®å¯¹åºè¾å¥å¾åçä¸ä¸ªå¤§çªå£åºåï¼è®­ç»é¶æ®µéç¨å¼±çç£ï¼åªéé¨åé«ååºä½ç½®é¢æµæ­£ç¡®å³å¯</td>
<td>å°çªå£ä¿¡æ¯éæ¸æ±èï¼åæ¾å¤§éèªå¨è·è¸ªå³é®åºå</td>
</tr>
<tr>
<td><strong>æ ç­¾è®¾è®¡</strong></td>
<td>è¾åºç¹å¾å¾ä½¿ç¨å¾åçº§æ ç­¾ï¼å·ç§¯ç½ç»èªå¨å­¦ä¼ç©ºé´ä½ç½®ååºï¼æ éå¯¹æ¯ä¸ªçªå£æå·¥æ æ³¨</td>
<td>ç»æ´æ¬ä¹¦ä¸ä¸ªä¸»é¢æ ç­¾ï¼ç½ç»èªå¨æ¾å°ç¸å³ç« è</td>
</tr>
<tr>
<td><strong>3.0 YOLO</strong></td>
<td>ç½ç»ç´æ¥é¢æµæ¯ä¸ªç½æ ¼åååç®æ çç±»å«åè¾¹çæ¡ï¼ç«¯å°ç«¯è®­ç»ï¼ä¸åä¾èµæ»å¨çªå£æéå¤è®¡ç®</td>
<td>æ¯ä¸ªç½æ ¼åä¸ä¸ªå°æ¢åï¼ç´æ¥åè¯ä½ ç®æ å¨è¿éï¼å¹¶ç»åºè½®å»</td>
</tr>
<tr>
<td><strong>YOLO æ ç­¾è§è</strong></td>
<td>æ¯ä¸ªç½æ ¼åå« <span class="math inline">\(p_c\)</span>ï¼æ¯å¦æç®æ ï¼ã<span class="math inline">\(b_x,b_y,b_h,b_w\)</span>ï¼è¾¹çæ¡ä½ç½®ï¼ã<span class="math inline">\(c_n\)</span>ï¼ç±»å«ï¼ï¼è¾åºç»´åº¦ <span class="math inline">\(S \times S \times (5 + c_n)\)</span></td>
<td>æ¯ä¸ªå°æ¢åæºå¸¦å®æ´ä¿¡æ¯å¡çï¼æ¥åç®æ ä½ç½®åç±»å</td>
</tr>
</tbody>
</table>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-23 20:54">2025-12-23 20:53</span>&nbsp;
<a href="https://www.cnblogs.com/Goblinscholar">å¥å¸æå­¦è</a>&nbsp;
éè¯»(<span id="post_view_count">40</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19389081);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19389081', targetLink: 'https://www.cnblogs.com/Goblinscholar/p/19389081', title: 'å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨åï¼è®¡ç®æºè§è§  ç¬¬ä¸å¨ï¼æ£æµç®æ³ ï¼äºï¼ç®æ æ£æµç®æ³' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>