<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-01-13T12:37:29.499Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ ä»Shapefileå°GeoJSONï¼ç¨GDALå®ç°GISç¢éæ°æ®è¯»åä¸ç©ºé´åæ ]]></title>
    <link>https://www.cnblogs.com/charlee44/p/19479143</link>
    <guid>6bcd8da550301ab8407175bad2c0797b</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/charlee44/p/19479143" title="åå¸äº 2026-01-13 20:25">
    <span role="heading" aria-level="2">ä»Shapefileå°GeoJSONï¼ç¨GDALå®ç°GISç¢éæ°æ®è¯»åä¸ç©ºé´åæ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260113202625252-636759511.png" alt="ä»Shapefileå°GeoJSONï¼ç¨GDALå®ç°GISç¢éæ°æ®è¯»åä¸ç©ºé´åæ" class="desc_img">
        éè¿ GDAL/OGR å®ç°äº GIS ç¢éæ°æ®çå®æ´å¤çæµç¨ââä» Shapefile è¯»åãWGS84 å° Web å¢¨å¡æåæ è½¬æ¢ï¼å° GeoJSON åå¥ï¼å¹¶æ¼ç¤ºäºç¹ä¸å¤è¾¹å½¢ææå³ç³»ï¼å¦ Containsï¼çå¤æ­æ¹æ³ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>æ¬æèéèªä½èæ°ä¹¦<a href="https://item.jd.com/14603137.html" target="_blank" rel="noopener nofollow">ãGISåºç¡åçä¸ææ¯å®è·µã</a>ç¬¬4ç« ï¼ç³»ç»è®²è§£ç¢éæ°æ®å¼ååºç¡ï¼æ¶µç OGR/GDAL ä½¿ç¨ãåæ è½¬æ¢ãææå¤æ­ç­å®æåå®¹ã</p>
</blockquote>
<p><img alt="GISåºç¡åçä¸ææ¯å®è·µ" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260109210341528-489326821.png" class="lazyload"></p>
<h2 id="44-ç¢éæ°æ®å¼ååºç¡">4.4 ç¢éæ°æ®å¼ååºç¡</h2>
<p>éè¿ä¹åçä»ç»ï¼ç¸ä¿¡è¯»èå·²ç»å¯¹äºGISçç¢éæ°æ®æäºä¸ä¸ªå¨é¢çè®¤è¯ï¼å°½ç®¡å¯è½ä¸æ¯é£ä¹æ·±å¥ãä½æ¯æ²¡æå³ç³»ï¼æä»¬å¯ä»¥å¨å®éçå¼åè¿ç¨ä¸­å æ·±å¯¹å¶çè®¤è¯ã</p>
<h3 id="441-ç¬¬ä¸æ¹å¼æºåºogrgdal">4.4.1 ç¬¬ä¸æ¹å¼æºåºOGR/GDAL</h3>
<p>å¨ç¬¬3ç« çæ¶åï¼æä»¬å°è¯çåï¼éè¿ç¬¬ä¸æ¹å¼æºåºPROJ/GDALå¾ç®åçå°±å®ç°äºå°çç©ºé´åèç³»ç»çç¸äºè½¬æ¢ãå¨è¿éåæ ·å¦æ­¤ï¼æä»¬å¯ä»¥éè¿GDALçOGRç»ä»¶ï¼è½»æ¾å®ç°GISç¢éæ°æ®çåºç¡å¼åã</p>
<p>OGRæ¾ç»æ¯ä¸ä¸ªç¬ç«çç¢éIOåºï¼è¡¨ç¤ºOpenGIS Simple Features Reference Implementationçææï¼ä½å¶å®OGRä¸å®å¨ç¬¦åOGCçSimple Featureæ åè§èï¼å æ­¤æªè¢«æ¹åä½ä¸ºè¯¥è§èçåèå®ç°ï¼å½ç¶ä¹éå¸¸æ¥è¿è§èäºï¼ãä»GDAL2.0å¼å§ï¼GDALåOGRç»ä»¶è¢«éæå¨ä¸èµ·ã</p>
<p>OGR/GDALæä¾äºéå¸¸å¼ºå¤§çç¢éè¯»åè½åï¼æ¯æå¸é¢ä¸ç»å¤§å¤æ°ç¢éæ°æ®æ ¼å¼ãå¨ç¬¬3ç« æä»¬ä»ç»GDALçæ¶åå°±æå°è¿ï¼GDALæ¯ä¸ä¸ªGISæ°æ®æ½è±¡åºãæè°æ°æ®æ½è±¡ï¼æ¯ææ è®ºæ¯åªä¸ç§å·ä½çç¢éæ°æ®æ ¼å¼ï¼GDALé½ä¼å°å¶æ½è±¡ææ°æ®éå¯¹è±¡ï¼Datasetï¼ï¼ä»èå¯ä»¥æ¯æè¯»åãååºåå¤çæä½ãå¸¸ç¨çç¢éæ°æ®æ ¼å¼å¦ä¸ï¼</p>
<ul>
<li>DXF/DWGï¼åºç¨æå¹¿æ³çå ä½å¾å½¢æ°æ®æ ¼å¼ï¼å¨CADé¢ååç¨çéå¸¸å¤ï¼ä½æ¯ç¼ºç¹æ¯ç¼ºå°å°çä¿¡æ¯ã</li>
<li>ESRI Shapefileï¼GISä¸­æå¸¸è§çç¢éæ°æ®æ ¼å¼ï¼å ä¹ææçåä¸åå¼æºGISè½¯ä»¶é½æ¯æãé¤äºå ä½ä¿¡æ¯ä¹å¤ï¼è¿åå«ç©ºé´ä¿¡æ¯åå±æ§ä¿¡æ¯ã</li>
<li>GeoJSONï¼ä¸ç§éè¿JSONæ¥è¡¨è¿°è¦ç´ çç¢éæ°æ®æ ¼å¼ï¼å èå¾å®¹æè¢«JavaScriptè§£æåå¤çï¼éç¨äºWebç«¯çè½»éååºç¨ã</li>
<li>KMLï¼Googleæåºçä¸ç§åºäºXMLæ åæ¥æè¿°å°çç©ºé´ä¿¡æ¯çæ°æ®æ ¼å¼ï¼åæ¬ç¹ãçº¿ãé¢ãå¤è¾¹å½¢åæ¨¡åç­ï¼ï¼å¹¶ä¸å·²ç»è¢«OGCè®¤å®ä¸ºå¼æ¾å°çä¿¡æ¯ç¼ç æ åã</li>
</ul>
<p>å¨GDALä¸­ï¼å¯¹æ°æ®æ ¼å¼çæ¯æè¢«å°è£æé©±å¨ï¼dirverï¼ï¼åæ¬ä¸è¿°æ ¼å¼å¨åçæ°æ®é©±å¨è¦ä¹ååµå¨GDALä¸­ï¼è¦ä¹éè¿å¦å¤çç¬¬ä¸æ¹åºæ¥æ¯æãå½ç¶è¿äºæä»¬å¯ä»¥ææ¶ä¸ç¨å³å¿ï¼ç´æ¥ä½¿ç¨æ¬ä¹¦Githubä¸»é¡µä»£ç ä»åºä¸­çGDALå³å¯ã</p>
<h3 id="442-ç¢éæ°æ®çè¯»åå¤çååå¥">4.4.2 ç¢éæ°æ®çè¯»åãå¤çååå¥</h3>
<p>äºè§£äºç¬¬ä¸æ¹åºOGR/GDALï¼æ¥ä¸æ¥æä»¬å°±éè¿å¶å®ç°å³äºGISç¢éæ°æ®çåºç¡å¼åãä¸ä¸ªå¾å®¹æçè§£çå¸¸è¯æ¯ï¼åå«GISç¢éæ°æ®å¨åçä»»ä½æ°æ®çæä½é½ç¦»ä¸å¼ä¸ä¸ªè¿ç¨ï¼è¯»åãå¤çååå¥ãå æ­¤ï¼è¿éæä»¬ç»ååé¢ç©ºé´åæ åèè½¬æ¢çå®è·µï¼å®ç°ä¸ä¸ªç®åçå®ä¾ï¼è¯»åä¸ä¸ªé¢çç¢éï¼ç¶åå¯¹å¶è¿è¡ç©ºé´åèçè½¬æ¢ï¼æåéæ°ååºä¸ä¸ªç¢éãå·ä½çå®ç°ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-cpp">#include &lt;ogrsf_frmts.h&gt;

#include &lt;Eigen/Eigen&gt;
#include &lt;iostream&gt;
#include &lt;vector&gt;

using namespace std;
using namespace Eigen;

using Point = Vector3d;
using Line = vector&lt;Point&gt;;
using Polygon = vector&lt;Line&gt;;

vector&lt;Polygon&gt; polygonData;

OGRSpatialReference srcFileSpatialReference;
OGRSpatialReference dstFileSpatialReference;

void OgrRing2Line(OGRLinearRing *ogrLinearRing, Line &amp;line) {
  for (int i = 0; i &lt; ogrLinearRing-&gt;getNumPoints(); i++) {
    line.emplace_back(ogrLinearRing-&gt;getX(i), ogrLinearRing-&gt;getY(i),
                      ogrLinearRing-&gt;getZ(i));
  }
}

void OgrPolygon2Polygon(OGRPolygon *ogrPolygon, Polygon &amp;polygon) {
  //å¤ç¯
  Line line;
  OgrRing2Line(ogrPolygon-&gt;getExteriorRing(), line);
  polygon.push_back(line);

  //åç¯
  for (int ri = 0; ri &lt; ogrPolygon-&gt;getNumInteriorRings(); ri++) {
    Line line;
    OgrRing2Line(ogrPolygon-&gt;getInteriorRing(ri), line);
    polygon.push_back(line);
  }
}

bool ReadShp() {
  string srcFile = getenv("GISBasic");
  srcFile = srcFile + "/../Data/Vector/multipolygons.shp";

  GDALDataset *poDS = (GDALDataset *)GDALOpenEx(srcFile.c_str(), GDAL_OF_VECTOR,
                                                NULL, NULL, NULL);
  if (!poDS) {
    printf("æ æ³è¯»åè¯¥æä»¶ï¼è¯·æ£æ¥æ°æ®æ¯å¦å­å¨é®é¢ï¼");
    return false;
  }

  if (poDS-&gt;GetLayerCount() &lt; 1) {
    printf("è¯¥æä»¶çå±æ°å°äº1ï¼è¯·æ£æ¥æ°æ®æ¯å¦å­å¨é®é¢ï¼");
    return false;
  }

  //åå§æ°æ®ç©ºé´åè
  char *pszWKT = nullptr;
  poDS-&gt;GetLayer(0)-&gt;GetSpatialRef()-&gt;exportToWkt(&amp;pszWKT);
  srcFileSpatialReference.importFromWkt(pszWKT);
  CPLFree(pszWKT);
  pszWKT = nullptr;

  for (int li = 0; li &lt; poDS-&gt;GetLayerCount(); li++) {
    OGRLayer *poLayer = poDS-&gt;GetLayer(li);  //è¯»åå±
    poLayer-&gt;ResetReading();

    //è¾åºå­æ®µå
    OGRFeatureDefn *poFDefn = poLayer-&gt;GetLayerDefn();
    int n = poFDefn-&gt;GetFieldCount();
    for (int iField = 0; iField &lt; n; iField++) {
      OGRFieldDefn *OGRFieldDefn = poFDefn-&gt;GetFieldDefn(iField);
      cout &lt;&lt; OGRFieldDefn-&gt;GetNameRef() &lt;&lt; endl;
    }

    //éåç¹å¾
    OGRFeature *poFeature = nullptr;
    while ((poFeature = poLayer-&gt;GetNextFeature()) != nullptr) {
      OGRGeometry *geometry = poFeature-&gt;GetGeometryRef();
      OGRwkbGeometryType geometryType = geometry-&gt;getGeometryType();

      switch (geometryType) {
        case wkbPolygon:
        case wkbPolygonM:
        case wkbPolygonZM: {
          OGRPolygon *ogrPolygon = dynamic_cast&lt;OGRPolygon *&gt;(geometry);
          if (!ogrPolygon) {
            continue;
          }

          Polygon polygon;
          OgrPolygon2Polygon(ogrPolygon, polygon);
          polygonData.push_back(polygon);

          break;
        }
        case wkbMultiPolygon:
        case wkbMultiPolygonM:
        case wkbMultiPolygonZM: {
          OGRMultiPolygon *ogrMultiPolygon =
              dynamic_cast&lt;OGRMultiPolygon *&gt;(geometry);
          if (!ogrMultiPolygon) {
            continue;
          }

          for (int gi = 0; gi &lt; ogrMultiPolygon-&gt;getNumGeometries(); gi++) {
            OGRPolygon *ogrPolygon =
                dynamic_cast&lt;OGRPolygon *&gt;(ogrMultiPolygon-&gt;getGeometryRef(gi));
            if (!ogrPolygon) {
              continue;
            }

            Polygon polygon;
            OgrPolygon2Polygon(ogrPolygon, polygon);
            polygonData.push_back(polygon);
          }

          break;
        }
        default: {
          printf("æªå¤ççç¹å¾ç±»å\n");
          break;
        }
      }

      //è¾åºæ¯ä¸ªå­æ®µçå¼
      for (int iField = 0; iField &lt; n; iField++) {
        cout &lt;&lt; poFeature-&gt;GetFieldAsString(iField) &lt;&lt; "    ";
      }
      cout &lt;&lt; endl;

      OGRFeature::DestroyFeature(poFeature);
    }
  }

  GDALClose(poDS);
  poDS = nullptr;

  return true;
}

void Convert() {
  dstFileSpatialReference.importFromEPSG(3857);
  dstFileSpatialReference.SetAxisMappingStrategy(OAMS_TRADITIONAL_GIS_ORDER);
  srcFileSpatialReference.SetAxisMappingStrategy(OAMS_TRADITIONAL_GIS_ORDER);

  OGRCoordinateTransformation *src2DstTransformation =
      OGRCreateCoordinateTransformation(&amp;srcFileSpatialReference,
                                        &amp;dstFileSpatialReference);

  if (!src2DstTransformation) {
    return;
  }

  for (auto &amp;polygon : polygonData) {
    for (auto &amp;line : polygon) {
      for (auto &amp;point : line) {
        src2DstTransformation-&gt;Transform(1, point.data(), point.data() + 1,
                                         point.data() + 2);
      }
    }
  }
}

bool CreateField(OGRLayer *poLayer) {
  // å­ç¬¦ä¸²
  OGRFieldDefn oField1("Type", OFTString);
  oField1.SetWidth(8);
  if (poLayer-&gt;CreateField(&amp;oField1) != OGRERR_NONE) {
    printf("Creating Name field failed.\n");
    return false;
  }

  // æµ®ç¹æ°
  OGRFieldDefn oField2("Area", OFTReal);
  oField2.SetPrecision(3);
  if (poLayer-&gt;CreateField(&amp;oField2) != OGRERR_NONE) {
    printf("Creating Name field failed.\n");
    return false;
  }

  // æ´å
  OGRFieldDefn oField3("VertexCount", OFTInteger);
  if (poLayer-&gt;CreateField(&amp;oField3) != OGRERR_NONE) {
    printf("Creating Name field failed.\n");
    return false;
  }

  return true;
}

bool WriteGeoJson() {
  string dstFile = getenv("GISBasic");
  dstFile = dstFile + "/../Data/Out.geoJson";

  //åå»º
  GDALDriver *driver = GetGDALDriverManager()-&gt;GetDriverByName("GeoJSON");
  if (!driver) {
    printf("Get Driver GeoJSON Errorï¼\n");
    return false;
  }

  GDALDataset *dataset =
      driver-&gt;Create(dstFile.c_str(), 0, 0, 0, GDT_Unknown, NULL);
  OGRLayer *poLayer = dataset-&gt;CreateLayer(
      "FirstLayer", &amp;dstFileSpatialReference, wkbPolygon, NULL);

  if (!CreateField(poLayer)) {
    return false;
  }

  //åå»ºç¹å¾
  for (const auto &amp;polygon : polygonData) {
    OGRFeature ogrFeature(poLayer-&gt;GetLayerDefn());

    OGRPolygon ogrPolygon;

    int vertexNum = 0;
    for (const auto &amp;line : polygon) {
      OGRLinearRing ogrRing;
      for (const auto &amp;point : line) {
        ogrRing.addPoint(point.x(), point.y(), point.z());
        vertexNum++;
      }
      ogrPolygon.addRing(&amp;ogrRing);
    }
    ogrFeature.SetGeometry(&amp;ogrPolygon);

    ogrFeature.SetField("Type", "Polygon");
    ogrFeature.SetField("Area", ogrPolygon.get_Area());
    ogrFeature.SetField("VertexCount", vertexNum);

    if (poLayer-&gt;CreateFeature(&amp;ogrFeature) != OGRERR_NONE) {
      printf("Failed to create feature.\n");
      return false;
    }
  }

  //éæ¾
  GDALClose(dataset);
  dataset = nullptr;

  return true;
}

int main() {
  GDALAllRegister();
  CPLSetConfigOption("GDAL_FILENAME_IS_UTF8", "NO");  //æ¯æä¸­æè·¯å¾
  CPLSetConfigOption("SHAPE_ENCODING", "");           //è§£å³ä¸­æä¹±ç é®é¢

  if (!ReadShp()) {
    return 1;
  }

  Convert();

  WriteGeoJson();
}
</code></pre>
<p>å¨è¿éï¼è¯»åçç¢éæ¯ä¸ä¸ªShapefileæä»¶ï¼åå«çé½æ¯å¤è¾¹å½¢çè¦ç´ ï¼ç©ºé´åèä¸ºWGS84å°çåæ ç³»ï¼EPSGï¼4326ï¼ï¼æ¾ç¤ºå¦ä¸å¾4.14æç¤ºï¼</p>
<p><img alt="å¾4.14 å¤çåå¤è¾¹å½¢ç¢éè¦ç´ " loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260113202314711-1548077459.jpg" class="lazyload"></p>
<p>ç»è¿ç©ºé´åèè½¬æ¢åï¼ç©ºé´åèä¸ºWebå¢¨å¡ææå½±åæ ç³»ï¼EPSGï¼3857ï¼ï¼ä¸çæçæ¯ä¸ä¸ªGeoJsonæä»¶ãå¦ä¸å¾4.15æç¤ºï¼å¯ä»¥çå°å¨ç©ºé´åæ åèè½¬æ¢ä¹åå½¢ç¶ä¼¼ä¹âåçªâäºä¸ç¹ï¼è¿æ¯å°å¾æå½±åæ¢çç¹æ§å³å®çï¼åèç¬¬2ç« ä»ç»çç¥è¯ï¼ã</p>
<p><img alt="å¾4.15 å¤çåå¤è¾¹å½¢ç¢éè¦ç´ " loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260113202328946-325091388.jpg" class="lazyload"></p>
<p>è¿æ®µä»£ç çå³é®å¨äºå¦ä¸å ç¹ï¼</p>
<ul>
<li>
<p>è¯»åç¢éæ¶ï¼ç¢éæ°æ®è¢«è¯»åææ°æ®éå¯¹è±¡GDALDatasetï¼GDALDatasetç®¡çå¾å±å¯¹è±¡OGRLayerï¼OGRLayerç®¡çç¹å¾ç±»å¯¹è±¡OGRFeatureï¼OGRFeatureååå«å ä½å¯¹è±¡ç±»OGRGeometryãOGRGeometryæ¯ä¸ä¸ªæ½è±¡ç¶ç±»ï¼ææä¹çæ¯å¶è¡¨è¾¾å·ä½çå ä½å¯¹è±¡çå­ç±»ï¼æ¯å¦OGRPolygonä»£è¡¨å¤è¾¹å½¢å ä½å¯¹è±¡ãOGRPolygonåæ¯ç±1ä¸ªå¤ç¯åå¤ä¸ªåç¯ï¼ç¯çº¿ï¼OGRLinearRingï¼ç»æãç¢éå°±æ¯è¿æ ·ä¸å±å±æ½è±¡ç»åè¡¨è¾¾åºæ¥çã</p>
</li>
<li>
<p>å¨è¿è¡æ°æ®å¤çä¹å°±æ¯ç©ºé´åèè½¬æ¢ä¹åï¼æä»¬æè¯»åçæ°æ®æ¾å°æä»¬èªå·±çæ°æ®å®¹å¨ä¸­ï¼</p>
<pre><code class="language-cpp">using Point = Vector3d;
using Line = vector&lt;Point&gt;;
using Polygon = vector&lt;Line&gt;;

vector&lt;Polygon&gt; polygonData;
</code></pre>
<p>çå®çGISæ°æ®å¤çå¼åè¦æ±æ¯ååä¸åçï¼æä½çå¾å¾ä¸æ¯è¯»åç»ä»¶ï¼è¿éæOGRï¼å®ä¹çæ°æ®ç»æå¯¹è±¡ãæä»¬å¯ä»¥å°å¶è¯»åå¨æèªå®ä¹çæ°æ®ç»æä¸­ï¼ä»¥æ¹ä¾¿æä»¬è¿è¡æ´å éç¨çæä½ï¼æèè¿è¡å¹¶è¡ä¼åãå¨è¿éæä»¬éåäºèªå®ä¹çæ°æ®ç»æå¯¹è±¡ä¸­çé¡¶ç¹ï¼éç¹è¿è¡ç©ºé´åæ åèçè½¬æ¢ãè¿è¡å¶ä»çæ°æ®å¤çä¹æ¯å¦æ­¤ï¼æ ¹æ®èªå·±çéè¦æä½èªå·±çæ°æ®ç»æå®¹å¨ã</p>
</li>
<li>
<p>ååºç¢éæ¶ï¼å°å¤çç»æçèªå®ä¹æ°æ®ç»æå¯¹è±¡æ¢å¤ææ°æ®éå¯¹è±¡GDALDatasetï¼è¯»åç¢éçéæä½ï¼ãå¦å¤ï¼éè¦å³æ³¨çæ¯GDALçæ°æ®é©±å¨GDALDriverï¼å¶æ¯éè¿åç§°æ¥åå»ºå¯¹åºæ ¼å¼çç¢éæä»¶ï¼ä¾å¦è¿éä¼ å¥å°åç§°æ¯GeoJson:</p>
<pre><code class="language-cpp">GDALDriver *driver = GetGDALDriverManager()-&gt;GetDriverByName("GeoJSON");
if (!driver) {
  printf("Get Driver GeoJSON Errorï¼\n");
  return false;
}
</code></pre>
</li>
<li>
<p>ç¢éæ°æ®çå±æ§è¡¨æ°æ®ä¸æ°æ®åºä¸­çè¡¨ç»ææ¯è¾ç±»ä¼¼ï¼æ¯ä¸ªå­æ®µå·æèªå·±çå®ä¹å±æ§ï¼ä¾å¦æ°æ®ç±»åãé¿åº¦ãç²¾åº¦ç­ãå¹¶ä¸ï¼æ¯ä¸ä¸ªç¹å¾é½å¯¹åºäºä¸è¡è®°å½ãå èå±æ§è¡¨çæä½è¿æ¯æºå¤æçï¼å¾å¾ä¸ä¸å¡æä½ç¸å³èãè¿éä»ä»åªæ¯è¾åºæ¾ç¤ºäºè¯»åçå±æ§è¡¨ä¿¡æ¯ï¼åå¥äºèªå·±åå»ºçå­æ®µä¸å¼ãè¯»åååå¥çå±æ§è¡¨æ°æ®å¦ä¸å¾4.16ãå¾4.17æç¤ºï¼</p>
</li>
</ul>
<p><img alt="å¾4.16 è¯»åçå±æ§è¡¨ä¿¡æ¯" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260113202342130-737019255.jpg" class="lazyload"><br>
<img alt="å¾4.17 åå¥çå±æ§è¡¨ä¿¡æ¯" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260113202352772-344125405.jpg" class="lazyload"></p>
<h3 id="443-ç©ºé´ææå³ç³»çå¤æ­">4.4.3 ç©ºé´ææå³ç³»çå¤æ­</h3>
<p>å¯¹ç¢éè¦ç´ è¿è¡ç©ºé´ææå³ç³»çå¤æ­ä¹æ¯GISå¼åä¸­å¸¸ç¨çåè½ãå¨4.3.3èä¸­ä»ç»äºOGCçSimple Featureæ åè§èä¸­ææå³ç³»ï¼OGR/GDALå¯¹å¶åäºå·ä½çå®ç°ãä»»ä½ç»§æ¿äºOGRGeometryçå ä½å¯¹è±¡ç±»ï¼å¦OGRPointãOGRPolygonï¼é½å¯ä»¥è°ç¨æ åä¸­å®ä¹çæ¥å£ï¼äºåè°è¯ï¼ï¼å¤æ­è¯¥å ä½å¯¹è±¡ä¸å¦å¤ä¸ä¸ªå ä½å¯¹è±¡çææå³ç³»ãå¨å¦ä¸å®ä¾ä¸­ï¼å¤æ­äºç©ºé´ä¸­æç¹ä¸æå¤è¾¹å½¢æ¯å¦å­å¨åå«ï¼Containsï¼å³ç³»ï¼</p>
<pre><code class="language-cpp">#include &lt;ogrsf_frmts.h&gt;

#include &lt;iostream&gt;

using namespace std;

int main() {
  OGRLinearRing linearRing;
  linearRing.addPoint(268.28, 784.75);
  linearRing.addPoint(153.98, 600.60);
  linearRing.addPoint(274.63, 336.02);
  linearRing.addPoint(623.88, 401.64);
  linearRing.addPoint(676.80, 634.47);
  linearRing.addPoint(530.75, 822.85);
  linearRing.closeRings();

  OGRPolygon polygon;
  polygon.addRing(&amp;linearRing);

  cout &lt;&lt; "ç¹Aæ¯å¦å¨å¤è¾¹å½¢åï¼";
  OGRPoint pointA(407.98, 579.43);  
  cout &lt;&lt; polygon.Contains(&amp;pointA) &lt;&lt; endl;

  cout &lt;&lt; "ç¹Bæ¯å¦å¨å¤è¾¹å½¢åï¼";
  OGRPoint pointB(678.92, 482.07);  
  cout &lt;&lt; polygon.Contains(&amp;pointB) &lt;&lt; endl;
}
</code></pre>
<p>è¿è¡çç»æå¦ä¸æç¤ºï¼</p>
<pre><code class="language-text">ç¹Aæ¯å¦å¨å¤è¾¹å½¢åï¼1
ç¹Bæ¯å¦å¨å¤è¾¹å½¢åï¼0
</code></pre>
<p>å¨4.3.3èä¸­ä»ç»è¿ï¼åå«(Contains)ä¸åå«(Within)æ¯ä¸å¯¹ç¸åçå³ç³»ãå¨è¿éæä»¬å½ç¶ä¹å¯ä»¥è°ç¨OGRPointçåå«(Within)æ¥å£ï¼ä¼è¿åä¸ä¸è¿°åæ ·çç»æãä¸æ­¢å¦æ­¤ï¼å¶ä»ç©ºé´ææå³ç³»çæ¥å£ä¹æ¯è¿æ ·è°ç¨ï¼è¯»èå¯ä»¥æ ¹æ®èªå·±çéæ±å°è¯ä¸äºï¼è¿éåªæ¯æç å¼çã</p>
<hr>
<p>æ¬æèéèªä½èæ°ä¹¦ãGISåºç¡åçä¸ææ¯å®è·µãç¬¬4ç« ãä¹¦ä¸­ç³»ç»è®²è§£ GIS æ ¸å¿çè®ºä¸å¤è¯­è¨å®æï¼éåå¼åèä¸é«æ ¡å¸çã</p>
<p>ð <strong>éå¥èµæºå¼æº</strong>ï¼<a href="https://github.com/fafa1899/GISBasic" target="_blank" rel="noopener nofollow">GitHub</a> | <a href="https://gitcode.com/charlee44/GISBasic" target="_blank" rel="noopener nofollow">GitCode</a></p>
<p>ð <strong>æ¯ææ­£ç</strong>ï¼<a href="https://item.jd.com/14603137.html" target="_blank" rel="noopener nofollow">äº¬ä¸</a>ï½<a href="https://product.dangdang.com/29988568.html" target="_blank" rel="noopener nofollow">å½å½</a></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.001388888888888889" data-date-updated="2026-01-13 20:27">2026-01-13 20:25</span>&nbsp;
<a href="https://www.cnblogs.com/charlee44">charlee44</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479143);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479143', targetLink: 'https://www.cnblogs.com/charlee44/p/19479143', title: 'ä»Shapefileå°GeoJSONï¼ç¨GDALå®ç°GISç¢éæ°æ®è¯»åä¸ç©ºé´åæ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ çµä½å¨å®ç°çµæºç»å¯¹ä½ç½®æµé-PART-çµä½è®¡-ç»å¯¹ä½ç½® ]]></title>
    <link>https://www.cnblogs.com/SimLab/p/19479117</link>
    <guid>091277d09a043129886cb629c71f75c0</guid>
    <description>
    <![CDATA[ 
        <h2>
            <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/SimLab/p/19479117" title="åå¸äº 2026-01-13 20:11">
    <span role="heading" aria-level="2">çµä½å¨å®ç°çµæºç»å¯¹ä½ç½®æµé-PART-çµä½è®¡-ç»å¯¹ä½ç½®</span>
    

</a>

        </h2>
        <div class="postbody">
            <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="çµä½å¨å®ç°çµæºç»å¯¹ä½ç½®æµé-part-çµä½è®¡-ç»å¯¹ä½ç½®">çµä½å¨å®ç°çµæºç»å¯¹ä½ç½®æµé-PART-çµä½è®¡-ç»å¯¹ä½ç½®</h1>
<blockquote>
<p><strong>å³é®å­</strong>ï¼ç»å¯¹ä½ç½®, çµä½å¨, Vishay Spectrol, 132</p>
</blockquote>
<hr>
<h2 id="ä¸é®é¢åæ">ä¸ãé®é¢åæ</h2>
<p>å¨è¿å¨æ§å¶å®éªä¸­ï¼æä»¬éè¦æµéæè½¬çµæºå¨æéè§åº¦èå´ï¼å¦ 0â90Â°ï¼åæ¥åæå¨ç<strong>ç»å¯¹ä½ç½®</strong>ã</p>
<p>å¸¸è§æ¹æ³ï¼</p>
<ul>
<li>ç»å¯¹ç¼ç å¨æå¢éç¼ç å¨è¾åºæ°å­ä¿¡å·ï¼ç²¾åº¦é«ã</li>
</ul>
<p>ç°åºé®é¢ï¼</p>
<ul>
<li><strong>å®éªç¡¬ä»¶æ¬èº«ä¸æ¯æç»å¯¹ç¼ç å¨éé</strong>ï¼æ æ³ç´æ¥ä½¿ç¨</li>
<li>æå¨è§åº¦æéï¼ä¸éè¦å¨å 360Â°ï¼</li>
<li>ç³»ç»éè¦ç¨³å®ãå¯å®æ¶è·åç»å¯¹ä½ç½®çæ¹æ¡</li>
</ul>
<blockquote>
<p>æ ¸å¿é®é¢ï¼å¦ä½å¨ç¡¬ä»¶ä¸æ¯æç»å¯¹ç¼ç å¨ééçæåµä¸ï¼å®ç°å¯é çç»å¯¹ä½ç½®æµéï¼</p>
</blockquote>
<hr>
<h2 id="äºè§£å³æ¹æ³--å®æ½æ¹æ¡">äºãè§£å³æ¹æ³ / å®æ½æ¹æ¡</h2>
<h3 id="1ï¸â£-ç¡¬ä»¶æ¹æ¡">1ï¸â£ ç¡¬ä»¶æ¹æ¡</h3>
<ul>
<li><strong>çµä½å¨éå</strong>ï¼Vishay Spectrol Model 132ï¼æè½¬è§ 352Â°ï¼</li>
<li><strong>é½¿è½®ä¼ å¨</strong>ï¼çµæºè½´ â é½¿è½® â çµä½å¨æ»å¨è½´
<ul>
<li>çµæºæè½¬è§ â é½¿è½®æ¯ â çµä½å¨æ»å¨è§</li>
<li>ä¿è¯çµä½å¨æ»¡éç¨è¦çå®éªæå¨è§åº¦</li>
</ul>
</li>
<li><strong>ä¾çµä¸çµè·¯è®¾è®¡</strong>ï¼
<ul>
<li>çµä½å¨ä¸¤ç«¯åèªä¸²7.5â¯kÎ© çµé»åå«æ¥å¥ Â±12â¯V ä¾çµ</li>
<li>è¾åºçµåä¸æå¨è§åº¦çº¿æ§æ å°</li>
</ul>
</li>
</ul>
<h3 id="2ï¸â£-ç¤ºæå¾">2ï¸â£ ç¤ºæå¾</h3>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3496115/202601/3496115-20260113201046016-1937574723.png" class="lazyload"></p>
<hr>
<h2 id="ä¸ä½¿ç¨æç¤º">ä¸ãä½¿ç¨æç¤º</h2>
<ul>
<li>å®éªç¡¬ä»¶ä¸æ¯æç»å¯¹ç¼ç å¨ééæ¶ï¼å¯ä½¿ç¨çµä½å¨æ¹æ¡</li>
<li>æå¨è§åº¦æéï¼éå¸¸ 0â90Â°ï¼æ¶ï¼132 åçµä½å¨éé½¿è½®å¯è¦çå¨èå´</li>
<li>çµä½å¨æ«ç«¯é¢çæ­»åºï¼é¿åæºæ¢°ç£¨æ</li>
<li>é½¿è½®æ¯åçè®¾è®¡ï¼ä¿è¯çµä½å¨æ»¡éç¨å¯¹åºå®éªæå¨è§åº¦</li>
<li>è¾åºçµåå¯ç´æ¥ç¨äºééç³»ç»ææ¨¡ææ§å¶å¨</li>
<li>è¥å®éªéè¦æ´å¤§è§åº¦æå¨åæµéï¼å¯èèåçº§çµä½å¨æä½¿ç¨ç»å¯¹ç¼ç å¨</li>
</ul>
<blockquote>
<p>æ»ç»ï¼å¨ç¡¬ä»¶ä¸æ¯æç»å¯¹ç¼ç å¨ééçå®éªç¯å¢ä¸ï¼<strong>132 åçµä½å¨ + é½¿è½®ä¼ å¨ + ä¸²èçµé»ä¾çµ</strong>æ¯ä¸ç§ç¨³å®ãå¯è¡çç»å¯¹ä½ç½®æµéæ¹æ¡ï¼æä½ç®åï¼å®éªéªè¯ç¨³å®ã</p>
</blockquote>
<hr>
<h2 id="åè¯´æ">åãè¯´æ</h2>
<ul>
<li>
<blockquote>
<p>æ¬æé¦åäºãGitHub/Giteeãï¼ä½èï¼KANICï¼ç ç©¶æ¹åä¸º èªå¨åå®éªå¹³å°ãæ§å¶ç®æ³éªè¯ååå®ç©ä»¿çç³»ç»ã</p>
</blockquote>
<p>ç¸å³å®éªæç¨åºå·²æ´çè³ GitHubï¼å¯å¨ GitHub å¹³å°æç´¢ KANIC-lab/KANIC æ¥çã</p>
<p>å¦éè¿ä¸æ­¥è®¨è®ºï¼å¯ç§ä¿¡èç³»ï¼å¹¶æ³¨ææç« ç¼å·ãæç« ç¼å·ä½äºæ é¢æ«å°¾ï¼ä»¥å­æ¯å¼å¤´å¦âEXP-XXXX-XXXâ</p>
</li>
</ul>

</div>
<div class="clear"></div>

        </div>
        <p class="postfoot">
            posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 20:12">2026-01-13 20:11</span>&nbsp;
<a href="https://www.cnblogs.com/SimLab">æ§å¶è¿·æ</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479117);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479117', targetLink: 'https://www.cnblogs.com/SimLab/p/19479117', title: 'çµä½å¨å®ç°çµæºç»å¯¹ä½ç½®æµé-PART-çµä½è®¡-ç»å¯¹ä½ç½®' })">ä¸¾æ¥</a>

        </p>
     ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ [python] åºäºpython-docxåºçWordææ¡£èªå¨å¤çå¨è§£ ]]></title>
    <link>https://www.cnblogs.com/luohenyueji/p/19479110</link>
    <guid>0f733a57a0f84250cb564f286b930e27</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/luohenyueji/p/19479110" title="åå¸äº 2026-01-13 20:08">
    <span role="heading" aria-level="2">[python] åºäºpython-docxåºçWordææ¡£èªå¨å¤çå¨è§£</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>python-docxæ¯ä¸æ¬¾çº¯Pythonå®ç°çç¬¬ä¸æ¹åºï¼ä¸é¨ç¨äºåå»ºåä¿®æ¹Microsoft Wordç.docxæ ¼å¼ææ¡£ãè¯¥åºæ éä¾èµ Microsoft Wordè½¯ä»¶å³å¯è¿è¡ï¼å·å¤ä¼ç§çè·¨å¹³å°ç¹æ§ï¼å¯å¨WindowsãMacãLinuxç­ç³»ç»ä¸ä½¿ç¨ãéè¦æ³¨æçæ¯ï¼python-docxä»å¼å®¹.docx æ ¼å¼ï¼å¯¹åº Word 2007 åä»¥ä¸çæ¬ï¼ï¼ä¸æ¯ææ§çç.doc æ ¼å¼æä»¶ã.docxæ¯åºäºXMLçå¼æ¾åç¼©æ ¼å¼ï¼è.docæ¯äºè¿å¶ç§ææ ¼å¼ï¼åèä½ç§¯æ´å°ãå¼å®¹æ§æ´ä¼ã</p>
<p>python-docxå®æ¹ä»£ç ä»åºè§ï¼<a href="https://github.com/python-openxml/python-docx" target="_blank" rel="noopener nofollow">python-docx</a>ï¼è¯¦ç»ææ¡£è§ï¼<a href="https://python-docx.readthedocs.io/en/latest/" target="_blank" rel="noopener nofollow">python-docx docs</a>ãæªè³æ¬ææ°åæ¶ï¼python-docxçç¨³å®çæ¬ä¸º1.2.0ï¼python-docxå®è£å½ä»¤å¦ä¸ï¼</p>
<blockquote>
<p>pip install python-docx</p>
</blockquote>
<p></p><div class="toc"><div class="toc-container-header">ç®å½</div><ul><li><a href="#1-ä½¿ç¨è¯´æ" rel="noopener nofollow">1 ä½¿ç¨è¯´æ</a><ul><li><a href="#11-å¿«éå¥é¨" rel="noopener nofollow">1.1 å¿«éå¥é¨</a></li><li><a href="#12-python-docxçæ ¸å¿å¯¹è±¡" rel="noopener nofollow">1.2 Python-docxçæ ¸å¿å¯¹è±¡</a><ul><li><a href="#121-documentå¯¹è±¡" rel="noopener nofollow">1.2.1 Documentå¯¹è±¡</a></li><li><a href="#122-tableå¯¹è±¡" rel="noopener nofollow">1.2.2 Tableå¯¹è±¡</a></li><li><a href="#123-ææ¬å¤ç" rel="noopener nofollow">1.2.3 ææ¬å¤ç</a></li><li><a href="#124-sectionså¯¹è±¡" rel="noopener nofollow">1.2.4 Sectionså¯¹è±¡</a></li><li><a href="#125-é¡µçé¡µèå¯¹è±¡" rel="noopener nofollow">1.2.5 é¡µçé¡µèå¯¹è±¡</a></li></ul></li><li><a href="#13-éææ¬åå®¹ç®¡ç" rel="noopener nofollow">1.3 éææ¬åå®¹ç®¡ç</a><ul><li><a href="#131-æ ·å¼ç®¡ç" rel="noopener nofollow">1.3.1 æ ·å¼ç®¡ç</a></li><li><a href="#132-æ¹æ³¨ç®¡ç" rel="noopener nofollow">1.3.2 æ¹æ³¨ç®¡ç</a></li><li><a href="#133-å¾çå¯¹è±¡" rel="noopener nofollow">1.3.3 å¾çå¯¹è±¡</a></li></ul></li><li><a href="#14-ç»¼åç¤ºä¾" rel="noopener nofollow">1.4 ç»¼åç¤ºä¾</a></li></ul></li><li><a href="#2-åè" rel="noopener nofollow">2 åè</a></li></ul></div><p></p>
<h1 id="1-ä½¿ç¨è¯´æ">1 ä½¿ç¨è¯´æ</h1>
<h2 id="11-å¿«éå¥é¨">1.1 å¿«éå¥é¨</h2>
<p>Python-docxä¸­çWordææ¡£åå­å¯¹è±¡æ¨¡åéç¨æ ç¶ç»æåå±æ å°ææ¡£åç´ ï¼ä½¿å¾ç¨åºè½å¤ç²¾åæ§å¶ææ¡£çåå®¹ãæ ¼å¼ä¸å¸å±ãè¯¥æ ç¶ç»æç¤ºæå¦ä¸ï¼</p>
<pre><code class="language-shell">Documentï¼ææ¡£ï¼
âââ Sectionsï¼èï¼
âââ Paragraphsï¼æ®µè½ï¼
â   âââ Runsï¼ææ¬çæ®µï¼
â   âââ InlineShapesï¼åèå½¢ç¶ï¼å¦å¾çï¼
âââ Tablesï¼è¡¨æ ¼ï¼
â   âââ Rowsï¼è¡ï¼
â   â   âââ Cellsï¼ååæ ¼ï¼
â   â       âââ Paragraphsï¼ååæ ¼åçæ®µè½ï¼
âââ Core Propertiesï¼ææ¡£å±æ§ï¼
</code></pre>
<p>åä¸ªå¯¹è±¡ç®ä»å¦ä¸ï¼</p>
<table>
<thead>
<tr>
<th>æ ¸å¿å¯¹è±¡</th>
<th>ä»£è¡¨å«ä¹</th>
<th>å¨ææ¡£æ ä¸­çä½ç½®</th>
<th>ä¸»è¦åè½ä¸è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Document</code></td>
<td>æ´ä¸ªWordææ¡£å¯¹è±¡</td>
<td>æ ¹å¯¹è±¡</td>
<td>ç¨äºæå¼æåå»ºä¸ä¸ª<code>.docx</code>æä»¶</td>
</tr>
<tr>
<td><code>Sections</code></td>
<td>ææ¡£çè</td>
<td><code>Document.sections</code></td>
<td>ç®¡çé¡µé¢è®¾ç½®ï¼å¦é¡µè¾¹è·ãçº¸å¼ æ¹åï¼</td>
</tr>
<tr>
<td><code>Paragraph</code></td>
<td>æ®µè½</td>
<td><code>Document.paragraphs</code>æ<code>Table.cell.paragraphs</code></td>
<td>ææ¡£çåºæ¬ååç±ä¸ä¸ªæå¤ä¸ª<code>Run</code>ç»æï¼å¹¶æ¥æç»ä¸çæ®µè½æ ¼å¼</td>
</tr>
<tr>
<td><code>Run</code></td>
<td>å·æç¸åæ ¼å¼çè¿ç»­ææ¬</td>
<td><code>Paragraph.runs</code></td>
<td>æ ¼å¼æ§å¶çæå°åä½ï¼å¯ä»¥å¯¹<code>Run</code>åç¬è®¾ç½®å­ä½ãå¤§å°ç­å­ç¬¦çº§æ ¼å¼</td>
</tr>
<tr>
<td><code>Table</code></td>
<td>è¡¨æ ¼</td>
<td><code>Document.tables</code></td>
<td>ä»£è¡¨ææ¡£ä¸­çä¸ä¸ªè¡¨æ ¼ï¼ç±è¡ï¼<code>Table.rows</code>ï¼ãåï¼<code>Table.columns</code>ï¼åååæ ¼ï¼<code>Table.cell</code>ï¼ç»æ</td>
</tr>
<tr>
<td><code>Cell</code></td>
<td>è¡¨æ ¼ååæ ¼</td>
<td><code>Table.cell(row,col)</code></td>
<td>æ¯ä¸ª<code>Cell</code>æ¬èº«å¯ä»¥åå«å¤ä¸ª<code>Paragraph</code>ï¼å°±åä¸ä¸ªå¾®ç¼©ææ¡£</td>
</tr>
<tr>
<td><code>InlineShape</code></td>
<td>ååµå½¢ç¶ï¼å¦å¾çï¼</td>
<td><code>Paragraph.add_picture()</code>åå»º</td>
<td>ä»£è¡¨ææ¡£ä¸­ä¸ææ¬å¨åä¸å±çå¾å½¢å¯¹è±¡ï¼æå¸¸ç¨çæ¯å¾ç</td>
</tr>
<tr>
<td><code>Styles</code></td>
<td>æ ·å¼éå</td>
<td><code>Document.styles</code></td>
<td>ç®¡çææ¡£ä¸­å®ä¹çæææ ·å¼ï¼å¦âæ é¢1âãâæ­£æâç­ï¼</td>
</tr>
</tbody>
</table>
<p><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/CSDN/%5Bpython%5D%20%E5%9F%BA%E4%BA%8Epython-docx%E5%BA%93%E7%9A%84Word%E6%96%87%E6%A1%A3%E8%87%AA%E5%8A%A8%E5%A4%84%E7%90%86%E5%85%A8%E8%A7%A3/imgs/1.jpg" alt="" loading="lazy"></p>
<p>ä»¥ä¸ä»£ç ç¤ºä¾æè¿°äºå¦ä½éè¿python-docxåºå¿«éå®ç°ææ¡£çåå»ºï¼å®ææ®µè½ãæ é¢ãè¡¨æ ¼ãå¾çç­åå®¹æ·»å åå­ç¬¦æ®µè½æ ·å¼è®¾ç½®ï¼å¹¶ä¿å­ä¸ºdocxæä»¶ï¼</p>
<pre><code class="language-python"># 1. åå§åææ¡£
from docx import Document
from docx.shared import Inches, Cm

# æ°å»ºç©ºç½ææ¡£ï¼ä¸æ·»å åæ°ï¼é»è®¤æ°å»º
doc = Document()  

# 2. æ·»å æ®µè½
# é»è®¤é½ä¼æåå®¹è¿½å å°ææ¡£çæ«å°¾
doc.add_paragraph("è¿æ¯ææ¡£æ­£ææ®µè½")  # ç´æ¥æ·»å æ®µè½
para = doc.add_paragraph("ä¸»æ®µè½") # è¯¥æ¹æ³è¿åæ°æ®µè½çå¼ç¨å¯¹è±¡
para.insert_paragraph_before("æå¥å¨ä¸»æ®µè½ä¸æ¹çæ®µè½")  # ä¸»æ®µè½çå¼ç¨ä¹åæå¥æ®µè½
para = doc.add_paragraph("æå¥å¨ä¸»æ®µè½ä¸æ¹çæ®µè½") # ä¸»æ®µè½çå¼ç¨ä¹åæå¥æ®µè½

# 3. æ·»å æ é¢ï¼çº§å«1-9ï¼0ä¸ºææ¡£æ é¢ï¼
doc.add_heading("ææ¡£æ»æ é¢", level=0) # ä¸ä»½æ¥åçå°é¢æ é¢
doc.add_heading("ç¬¬ä¸ç«  æ¦è¿°", level=1) # ä¸çº§æ é¢
doc.add_heading("1.1 æ ¸å¿åè½", level=2) # äºçº§æ é¢

# 4. åé¡µç¬¦
doc.add_page_break()  # å¼ºå¶åç»­åå®¹å¦èµ·ä¸é¡µ

# 5. æ·»å è¡¨æ ¼ï¼åºå®è¡+å¨æè¡+æ ·å¼ï¼
# 5.1 åºå®è¡¨æ ¼ï¼2è¡2åï¼
table1 = doc.add_table(rows=2, cols=2)
table1.cell(0, 0).text = "å§å"
table1.cell(0, 1).text = "å¹´é¾"
table1.cell(1, 0).text = "å¼ ä¸"
table1.cell(1, 1).text = "25"

# 5.2 å¨æè¡¨æ ¼ï¼è¡¨å¤´+æ°æ®è¡ï¼
table2 = doc.add_table(rows=1, cols=3)
# å°é¼ æ æ¬åå¨Wordè¡¨æ ¼æ ·å¼åºä¸­çè¡¨æ ¼æ ·å¼ç¼©ç¥å¾ä¸ï¼å³å¯æ¾å°è¡¨æ ¼æ ·å¼åç§°
table2.style = "Light Shading Accent 1"  # åºç¨é¢è®¾æ ·å¼
headers = ["æ°é", "äº§åç¼å·", "æè¿°"]
for i, header in enumerate(headers):
    table2.rows[0].cells[i].text = header
# æ¹éæ·»å æ°æ®
items = [(7, "1024", "æ¯ç»å°ç«"), (3, "2042", "è²æ¯ç²¾çµ"), (1, "1288", "è±ªåé¡¹å")]
for item in items:
    row = table2.add_row().cells
    row[0].text = str(item[0])
    row[1].text = item[1]
    row[2].text = item[2]

# 6. æ·»å å¾çï¼æ¬å°æä»¶+å°ºå¯¸è°æ´ï¼
doc.add_picture("test.png", width=Inches(1.5))  # 1.5è±å¯¸å®½ï¼èªå¨ç­æ¯ç¼©æ¾ï¼
doc.add_picture("test2.jpg", width=Cm(5),height=Cm(1))  # åæ¶æå®å®½é«

# 7. æ®µè½æ ·å¼ï¼é¡¹ç®ç¬¦å·/ç¼å·ï¼
doc.add_paragraph("é¡¹ç®ç¬¦å·åè¡¨é¡¹1", style="ListBullet")
doc.add_paragraph("é¡¹ç®ç¬¦å·åè¡¨é¡¹2", style="ListBullet")
doc.add_paragraph("ç¼å·åè¡¨é¡¹1", style="ListNumber")

# 8. å­ç¬¦æ ¼å¼ï¼ç²ä½/æä½ï¼
para = doc.add_paragraph()
para.add_run("æ®éææ¬ ").bold = False
para.add_run("ç²ä½ææ¬").bold = True
para.add_run(" æ®éææ¬ ").italic = False
para.add_run("æä½ææ¬").italic = True

# 9. å­ç¬¦æ ·å¼ï¼é¢è®¾æ ·å¼ï¼
para2 = doc.add_paragraph("æ®éææ¬ï¼")
para2.add_run("å¸¦å¼ºè°çææ¬", style="Emphasis")  # åºç¨"å¼ºè°"æ ·å¼

# 10. ä¿å­ææ¡£
doc.save("test_output.docx")
</code></pre>
<p>åç»­åå®¹å°å¯¹python-docxçåä¸ªæ ¸å¿å¯¹è±¡è¿è¡å·ä½ä»ç»ã</p>
<h2 id="12-python-docxçæ ¸å¿å¯¹è±¡">1.2 Python-docxçæ ¸å¿å¯¹è±¡</h2>
<h3 id="121-documentå¯¹è±¡">1.2.1 Documentå¯¹è±¡</h3>
<p>Python-docxæ¬è´¨ä¸æ¯ä¸ä¸ªææ¡£ä¿®æ¹å·¥å·ãå³ä½¿åå»ºæ°ææ¡£ï¼å¶åçä¹æ¯åºäºä¸ä¸ªé¢è®¾çç©ºç½æ¨¡æ¿è¿è¡ä¿®æ¹ãå æ­¤ï¼ææ¡£çæ ¼å¼ï¼å¦æ ·å¼ãé¡µçãé¡µèï¼ä¸æ­£æåå®¹æ¯åç¦»å­å¨çï¼å³ä½¿æ¸ç©ºæ¨¡æ¿æå­ä¹ä¸ä¼å é¤æ ¼å¼è®¾å®ãä»¥ä¸ç¤ºä¾å±ç¤ºäºå¦ä½åå»ºææ¡£ææå¼å·²æææ¡£ï¼</p>
<pre><code class="language-python">from docx import Document
from io import BytesIO, StringIO  # ç¨äºç±»æä»¶å¯¹è±¡æä½

"""æ¼ç¤ºpython-docxæä½ææ¡£çæ ¸å¿åè½"""
# ===================== 1. åå»ºæ°ææ¡£å¹¶ä¿å­ =====================
print("1. åå»ºæ°ææ¡£å¹¶ä¿å­...")
# åºäºé»è®¤æ¨¡æ¿åå»ºç©ºææ¡£
new_doc = Document()
new_doc.add_heading('python-docx ææ¡£æä½ç¤ºä¾', level=1)
new_doc.add_paragraph('è¿æ¯éè¿python-docxåå»ºçæ°ææ¡£')
# ä¿å­æ°ææ¡£å°æ¬å°
new_doc.save('æ°å»ºææ¡£.docx')
print("â æ°ææ¡£å·²ä¿å­ä¸ºï¼æ°å»ºææ¡£.docx")

# ===================== 2. æå¼ç°æææ¡£å¹¶ä¿®æ¹ä¿å­ =====================
print("\n2. æå¼ç°æææ¡£å¹¶ä¿®æ¹...")
# æå¼åæåå»ºçææ¡£
existing_doc = Document('æ°å»ºææ¡£.docx')
# åææ¡£è¿½å åå®¹
existing_doc.add_paragraph('è¿æ¯æå¼ç°æææ¡£åè¿½å çåå®¹')
# å¦å­ä¸ºæ°æä»¶ï¼é¿åè¦çåæä»¶ï¼
existing_doc.save('ä¿®æ¹åçææ¡£.docx')
print("â ä¿®æ¹åçææ¡£å·²ä¿å­ä¸ºï¼ä¿®æ¹åçææ¡£.docx")

# ===================== 3. éè¿ç±»æä»¶å¯¹è±¡ï¼BytesIOï¼è¯»åææ¡£ =====================
print("\n3. éè¿ç±»æä»¶å¯¹è±¡æä½ææ¡£...")
# 3.1 è¯»åï¼å°æ¬å°ææ¡£è¯»åå°BytesIOæµä¸­
with open('ä¿®æ¹åçææ¡£.docx', 'rb') as f:  # å¿é¡»ç¨rbï¼äºè¿å¶è¯»ï¼ï¼è·¨å¹³å°å¼å®¹
    doc_stream = BytesIO(f.read())  # ç¨BytesIOèéStringIO

# ä»æµä¸­æå¼ææ¡£
stream_doc = Document(doc_stream)
# è¿½å åå®¹
stream_doc.add_paragraph('è¿æ¯éè¿ç±»æä»¶å¯¹è±¡æ·»å çåå®¹')

# 3.2 ä¿å­ï¼å°ææ¡£ä¿å­å°BytesIOæµä¸­ï¼ä¸è½å°å°æ¬å°æä»¶ï¼
output_stream = BytesIO()
stream_doc.save(output_stream)

# å¯éï¼å°æµä¸­çåå®¹åå¥æ¬å°æä»¶ï¼éªè¯ç»æ
with open('ç±»æä»¶å¯¹è±¡çæçææ¡£.docx', 'wb') as f:
    f.write(output_stream.getvalue())
print("â ç±»æä»¶å¯¹è±¡æä½çææ¡£å·²ä¿å­ä¸ºï¼ç±»æä»¶å¯¹è±¡çæçææ¡£.docx")

# å³é­æµ
doc_stream.close()
output_stream.close()
</code></pre>
<h3 id="122-tableå¯¹è±¡">1.2.2 Tableå¯¹è±¡</h3>
<p>Wordè½¯ä»¶ä¸­çè¡¨æ ¼åè½ç¸å½å¤æï¼è¿å¯¼è´å¨ä½¿ç¨python-docxæä½è¡¨æ ¼æ¶ï¼å¾å¾é¾ä»¥æåæç¡®è¡¨æ ¼çå·ä½åå®¹åç»æï¼å¢å äºå¤ççé¾åº¦ãæ¬èå°ä»ç®åè¡¨æ ¼å°å¤æè¡¨æ ¼æ¥ä»ç»å¦ä½ä½¿ç¨python-docxæä½è¡¨æ ¼ã</p>
<p><strong>è§æ´è¡¨æ ¼</strong></p>
<p>è§æ´è¡¨æ ¼ä¹å°±æ¯ä¸ä¸ªè¡åæ°åºå®ãæ åå¹¶æçç¥ååæ ¼çæ åè¡¨æ ¼ï¼è¿æ¯æåºç¡çè¡¨æ ¼å½¢å¼ãå³ç³»åæ°æ®åºè¡¨åpandasæ°æ®è¡¨é½æ¯è§æ´è¡¨æ ¼çå¸åç¤ºä¾ï¼</p>
<pre><code class="language-shell">+---+---+---+
| a | b | c |
+---+---+---+
| d | e | f |
+---+---+---+
| g | h | i |
+---+---+---+
</code></pre>
<p>éè¿æ§å¶è¡¨æ ¼è¡åæ°å³å¯åå»ºè§æ´è¡¨æ ¼ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.shared import Inches

# åå»ºæ°ææ¡£
doc = Document()

# æ·»å 3è¡2åçè§æ´è¡¨æ ¼
table = doc.add_table(rows=3, cols=2)
table.style = 'Table Grid'  # æ¾ç¤ºè¡¨æ ¼è¾¹æ¡ï¼ä¾¿äºæ¥ç

# å¡«åååæ ¼åå®¹ï¼a-i å¯¹åºç¤ºä¾ä¸­çè§æ´è¡¨æ ¼ï¼
cell_texts = ['a', 'b', 'c', 'd', 'e', 'f']
idx = 0
for row in table.rows:
    for cell in row.cells:
        cell.text = cell_texts[idx]
        idx += 1

# ä¿å­ææ¡£
doc.save('è§æ´è¡¨æ ¼ç¤ºä¾.docx')

# è¯»åå¹¶éªè¯è§æ´è¡¨æ ¼çè¡åæ°ï¼æ¯è¡ååæ ¼æ°ç¸åï¼
print("è§æ´è¡¨æ ¼æ¯è¡çååæ ¼æ°ï¼")
for i, row in enumerate(table.rows):
    print(f"ç¬¬{i+1}è¡ï¼{len(row.cells)}ä¸ªååæ ¼")
</code></pre>
<p><strong>åå¹¶ååæ ¼</strong></p>
<p>å°å¤ä¸ªè¿ç»­çæ¨ªåæçºµåååæ ¼åå¹¶ä¸ºä¸ä¸ªååæ ¼ï¼æ¯å®éä½¿ç¨ä¸­éå¸¸å¸¸è§çæ¹å¼ï¼</p>
<pre><code class="language-shell">+---+---+---+   +---+---+---+
|   a   | b |   |   | b | c |
+---+---+---+   + a +---+---+
| c | d | e |   |   | d | e |
+---+---+---+   +---+---+---+
| f | g | h |   | f | g | h |
+---+---+---+   +---+---+---+
</code></pre>
<p>å®ç°æ¹å¼ä¸ºååå»ºè§æ´è¡¨æ ¼ï¼åéè¿<code>cell.merge()</code>å®ç°ååæ ¼çæ¨ªåæçºµååå¹¶ï¼</p>
<pre><code class="language-python">from docx import Document

doc = Document()
table = doc.add_table(rows=2, cols=3)
table.style = 'Table Grid'

# ç¤ºä¾1ï¼æ¨ªååå¹¶ï¼ç¬¬ä¸è¡ç¬¬ä¸ä¸ªååæ ¼åå¹¶å³ä¾§ååæ ¼ï¼
cell_1_1 = table.cell(0, 0)  # ç¬¬1è¡ç¬¬1åï¼ç´¢å¼ä»0å¼å§ï¼
cell_1_2 = table.cell(0, 1)
cell_1_1.merge(cell_1_2)
cell_1_1.text = 'åå¹¶ååæ ¼ï¼æ¨ªåï¼'

# ç¤ºä¾2ï¼çºµååå¹¶ï¼ç¬¬ä¸ååä¸¤ä¸ªååæ ¼åå¹¶ï¼
cell_1_3 = table.cell(0, 2)
cell_2_3 = table.cell(1, 2)
cell_1_3.merge(cell_2_3)
cell_1_3.text = 'åå¹¶ååæ ¼ï¼çºµåï¼'

# å¡«åå¶ä»ååæ ¼
table.cell(1, 0).text = 'd'
table.cell(1, 1).text = 'e'

# æ¥çåå¹¶åæ¯è¡çååæ ¼æ°
# æ³¨æä»¥ä¸åå®¹è¿åçæ¯åå§è¡¨æ ¼ç»æ
print("åå¹¶ååæ ¼åæ¯è¡çååæ ¼æ°ï¼")
for i, row in enumerate(table.rows):
    print(f"ç¬¬{i+1}è¡ï¼{len(row.cells)}ä¸ªååæ ¼")

doc.save('åå¹¶ååæ ¼ç¤ºä¾.docx')
</code></pre>
<p><strong>éå½è¡¨æ ¼</strong></p>
<p>è¡¨æ ¼å¤ççå¦ä¸ä¸ªå¤æç¹æ¯å¶éå½ç¹æ§ï¼Wordä¸­çè¡¨æ ¼ååæ ¼æ¬èº«å¯ä»¥åå«ä¸ä¸ªæå¤ä¸ªè¡¨æ ¼ãå¯ä»¥éè¿<code>_Cell.tables</code>æ<code>_Cell.iter_inner_content()</code>æ£æµåµå¥è¡¨æ ¼ï¼</p>
<ul>
<li><code>_Cell.tables</code>ï¼ç´æ¥è¿åååæ ¼ååå«çææè¡¨æ ¼ã</li>
<li><code>_Cell.iter_inner_content()</code>ï¼æææ¡£é¡ºåºè¿åååæ ¼åçææåå®¹ï¼åæ¬æ®µè½åè¡¨æ ¼ï¼ï¼ä¿æè¡¨æ ¼ä¸æ®µè½çç¸å¯¹ä½ç½®ä¸åã</li>
</ul>
<p>ç¤ºä¾ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.shared import Inches
from docx.table import Table
from docx.text.paragraph import Paragraph

def generate_nested_table_doc():
    """çæå¸¦åµå¥è¡¨æ ¼çç¤ºä¾Wordææ¡£ï¼ç¤ºä¾æ°æ®ï¼"""
    # 1. åå»ºæ°ææ¡£
    doc = Document()

    # 2. åå»ºå¤å±è¡¨æ ¼ï¼2è¡2åï¼
    outer_table = doc.add_table(rows=2, cols=2)
    outer_table.style = 'Table Grid'  # æ¾ç¤ºè¡¨æ ¼è¾¹æ¡

    # 3. å¡«åå¤å±è¡¨æ ¼çæ®éååæ ¼
    cell_1_1 = outer_table.cell(0, 0)
    cell_1_1.text = "ä¸æ¹ååæ ¼åå«åµå¥è¡¨æ ¼"

    cell_1_2 = outer_table.cell(0, 1)
    cell_1_2.text = "æ®éååæ ¼ï¼æ åµå¥ï¼"

    # 4. å³é®ï¼å¨ (1,0) ååæ ¼ä¸­åµå¥ä¸ä¸ªå­è¡¨æ ¼
    cell_2_1 = outer_table.cell(1, 0)
    # åç»åµå¥è¡¨æ ¼åå ä¸ä¸ªæ®µè½ï¼æ¨¡æçå®ææ¡£çæ··ååå®¹ï¼
    para = cell_2_1.add_paragraph("åµå¥è¡¨æ ¼åçæ®µè½åå®¹ï¼")
    # å¨ååæ ¼ååå»ºåµå¥è¡¨æ ¼ï¼3è¡1åï¼
    inner_table = cell_2_1.add_table(rows=3, cols=1)
    inner_table.style = 'Table Grid'
    # å¡«ååµå¥è¡¨æ ¼
    inner_table.cell(0, 0).text = "åµå¥è¡¨æ ¼-è¡1"
    inner_table.cell(1, 0).text = "åµå¥è¡¨æ ¼-è¡2"
    inner_table.cell(2, 0).text = "åµå¥è¡¨æ ¼-è¡3"
    # åµå¥è¡¨æ ¼ååå ä¸ä¸ªæ®µè½
    cell_2_1.add_paragraph("åµå¥è¡¨æ ¼åçæ®µè½åå®¹")

    # 5. å¡«åå¤å±è¡¨æ ¼æåä¸ä¸ªååæ ¼
    cell_2_2 = outer_table.cell(1, 1)
    cell_2_2.text = "æ®éååæ ¼ï¼æ åµå¥ï¼"

    # 6. ä¿å­ææ¡£ï¼çæç¤ºä¾æ°æ®ï¼
    doc.save("åµå¥è¡¨æ ¼.docx")
    print("=" * 50)
    print("â åµå¥è¡¨æ ¼.docx")
    print("=" * 50)

def traverse_table(table, level=0):
    """
    éå½éåè¡¨æ ¼ï¼å¤çåµå¥è¡¨æ ¼
    :param table: è¦éåçè¡¨æ ¼å¯¹è±¡
    :param level: è¡¨æ ¼åµå¥å±çº§ï¼å¤å±ä¸º0ï¼åå±+1ï¼
    """
    indent = "  " * level  # ç¼©è¿ï¼æ¹ä¾¿åºåå±çº§
    print(f"\n{indent}=== éåãå±çº§{level}ãè¡¨æ ¼ ===")
    
    # éåè¡¨æ ¼çæ¯ä¸è¡
    for row_idx, row in enumerate(table.rows):
        # éåè¡ä¸­çæ¯ä¸ä¸ªååæ ¼
        for col_idx, cell in enumerate(row.cells):
            print(f"\n{indent}ååæ ¼ ({row_idx+1}, {col_idx+1})ï¼")
            
            # --------------------------
            # æ¹æ³1ï¼_Cell.tables - ç´æ¥è·åååæ ¼åçææè¡¨æ ¼
            # --------------------------
            inner_tables = cell.tables
            if inner_tables:
                print(f"{indent}  ð æ£æµå° {len(inner_tables)} ä¸ªåµå¥è¡¨æ ¼ï¼")
                # éå½éåæ¯ä¸ªåµå¥è¡¨æ ¼
                for inner_table in inner_tables:
                    traverse_table(inner_table, level + 1)
            else:
                print(f"{indent}  ð æ åµå¥è¡¨æ ¼")
            
            # --------------------------
            # æ¹æ³2ï¼_Cell.iter_inner_content() - æé¡ºåºè·åååæ ¼åææåå®¹ï¼æ®µè½+è¡¨æ ¼ï¼
            # --------------------------
            print(f"{indent}  ð ååæ ¼åå®æ´åå®¹ï¼æé¡ºåºï¼ï¼")
            for content in cell.iter_inner_content():
                if isinstance(content, Paragraph):
                    # å¤çæ®µè½åå®¹ï¼è¿æ»¤ç©ºæ®µè½ï¼
                    text = content.text.strip()
                    if text:
                        print(f"{indent} [æ®µè½]ï¼{text}")
                elif isinstance(content, Table):
                    # éå°è¡¨æ ¼æ¶çæç¤ºï¼é¿åéå¤éåï¼ä»æ¼ç¤ºä½ç½®ï¼
                    print(f"{indent} [è¡¨æ ¼]ï¼åµå¥è¡¨æ ¼ï¼å±çº§{level+1}ï¼")

def parse_nested_tables():
    """è§£æçæçåµå¥è¡¨æ ¼ææ¡£ï¼æ¼ç¤ºæ ¸å¿æ¹æ³"""
    # 1. æå¼ç¤ºä¾ææ¡£
    doc = Document("åµå¥è¡¨æ ¼.docx")

    # 2. éåææ¡£ä¸­çææå¤å±è¡¨æ ¼
    print("\nå¼å§è§£æåµå¥è¡¨æ ¼ï¼")
    print("-" * 50)
    for table in doc.tables:
        traverse_table(table)

# ä¸»ç¨åºå¥å£
if __name__ == "__main__":
    # çæå¸¦åµå¥è¡¨æ ¼çç¤ºä¾ææ¡£
    generate_nested_table_doc()
    
    # ç¬¬äºæ­¥ï¼è§£æåµå¥è¡¨æ ¼ï¼æ¼ç¤º_Cell.tablesåiter_inner_contentçä½¿ç¨
    parse_nested_tables()
    
    print("\n" + "=" * 50)
    print("â åµå¥è¡¨æ ¼è§£æå®æï¼")
    print("=" * 50)
</code></pre>
<h3 id="123-ææ¬å¤ç">1.2.3 ææ¬å¤ç</h3>
<p>å¨Wordææ¡£ä¸­ï¼åå®¹çç»ç»é»è¾åä¸ºä¸¤ä¸ªä¸»è¦å±çº§ï¼åçº§å¯¹è±¡åè¡åå¯¹è±¡ã</p>
<ul>
<li>åçº§å¯¹è±¡ï¼å¦æ®µè½ãè¡¨æ ¼ï¼æ¯å æ®æ´è¡çå¤§æ¨¡åï¼å¶å®½åº¦ç±é¡µé¢è¾¹è·ãåæ æååæ ¼è¾¹çå³å®ï¼ææ¬ä¼å¨å¶å·¦å³è¾¹çåèªå¨æ¢è¡ã</li>
<li>è¡åå¯¹è±¡åå­å¨äºè¿äºå¤§æ¨¡ååé¨ï¼å¦å ç²çè¯è¯­æå¥å­ï¼æå¸¸è§çè¡¨ç°å½¢å¼æ¯ææ¬çæ®µï¼runsï¼ãä¸ä¸ªæ®µè½å°±æ¯ç±ä¸ä¸ªæå¤ä¸ªææ¬çæ®µç»æçã</li>
</ul>
<p>ç¸åºå°ï¼æ ¼å¼æ§å¶ä¹åä¸ºä¸¤ç±»ï¼</p>
<ul>
<li>åçº§å±æ§ï¼å¦ç¼©è¿ãé´è·ãå¯¹é½æ¹å¼ï¼æ§å¶æ¨¡åå¨é¡µé¢ä¸çå¸å±ä½ç½®ï¼</li>
<li>è¡åå±æ§ï¼å¦å­ä½ãå ç²ãé¢è²ï¼åæ§å¶æ¨¡ååé¨æå­çå·ä½å¤è§ã</li>
</ul>
<p>ä¸é¢éè¿Python-docxçä»£ç ç¤ºä¾ï¼å±ç¤ºè¿ä¸¤ç±»æ ¼å¼çå®éåºç¨ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.shared import Inches, Pt, RGBColor
from docx.enum.text import (
    WD_ALIGN_PARAGRAPH,
    WD_TAB_ALIGNMENT,
    WD_TAB_LEADER,
    WD_UNDERLINE
)
from docx.enum.dml import MSO_THEME_COLOR

# åå»ºä¸ä¸ªæ°ç Word ææ¡£
doc = Document()

# ==================== 1. åçº§æ ¼å¼è®¾ç½®ï¼æ®µè½å¸å±æ§å¶ ====================
# 1.1 æ é¢æ®µè½ï¼å±ä¸­å¯¹é½ãæ®µåé´è·ï¼
title_para = doc.add_paragraph("Python-docx ææ¬æ ¼å¼ç¤ºä¾")
title_format = title_para.paragraph_format  # åçº§æ ¼å¼å¯¹è±¡
title_format.alignment = WD_ALIGN_PARAGRAPH.CENTER  # å±ä¸­å¯¹é½ï¼åçº§å±æ§ï¼
title_format.space_after = Pt(18)  # æ®µåé´è·ï¼åçº§å±æ§ï¼

# 1.2 æ­£ææ®µè½ï¼ç¼©è¿ä¸è¡é´è·ï¼
content_para = doc.add_paragraph("è¿æ¯ä¸ä¸ªå¸¦ç¼©è¿åèªå®ä¹è¡é´è·çæ­£ææ®µè½ã")
content_format = content_para.paragraph_format
content_format.left_indent = Inches(0.5)          # å·¦ç¼©è¿
content_format.first_line_indent = Inches(-0.25)  # æ¬æç¼©è¿
content_format.line_spacing = 1.5                # 1.5åè¡é´è·
content_format.space_before = Pt(12)             # æ®µåé´è·

# 1.3 å¸¦å¶è¡¨ä½çæ®µè½ï¼åçº§å®ä½ï¼
tab_para = doc.add_paragraph("å§å:\tå¼ ä¸\tå¹´é¾:\t25")
tab_format = tab_para.paragraph_format
tab_stops = tab_format.tab_stops
# æ·»å ä¸ä¸ªå¶è¡¨ä½ï¼ä½ç½®ãå¯¹é½æ¹å¼ãåå¯¼ç¬¦ï¼
tab_stops.add_tab_stop(Inches(1.5), WD_TAB_ALIGNMENT.RIGHT, WD_TAB_LEADER.DOTS)
tab_stops.add_tab_stop(Inches(2.5), WD_TAB_ALIGNMENT.LEFT, WD_TAB_LEADER.SPACES)
tab_stops.add_tab_stop(Inches(3.5), WD_TAB_ALIGNMENT.RIGHT, WD_TAB_LEADER.DOTS)

# 1.4 åé¡µæ§å¶ï¼åçº§ä¿æä¸å­¤è¡æ§å¶ï¼
page_para1 = doc.add_paragraph("è¿æ¯ç« èæ é¢ï¼ç¡®ä¿ä¸ä¸ä¸æ®µåé¡µï¼")
page_para1.paragraph_format.keep_with_next = True  # ä¸ä¸æ®µåé¡µ
page_para2 = doc.add_paragraph("è¿æ¯ç« èåå®¹ï¼å¯ç¨äºå­¤è¡æ§å¶ï¼é¿åæ®µè½é¦è¡/æ«è¡åç¬æ¾ç¤ºå¨ä¸é¡µã" * 20)
page_para2.paragraph_format.widow_control = True   # é¿åå­¤è¡

# ==================== 2. è¡åæ ¼å¼è®¾ç½®ï¼æå­å¤è§æ§å¶ ====================
char_para = doc.add_paragraph("å­ç¬¦æ ¼å¼ç¤ºä¾ï¼")

# ç²ä½
bold_run = char_para.add_run("ç²ä½ææ¬")
bold_run.font.bold = True
char_para.add_run(" | ")

# æä½
italic_run = char_para.add_run("æä½ææ¬")
italic_run.font.italic = True
char_para.add_run(" | ")

# ä¸åçº¿ï¼åä¸åçº¿ï¼
underline_run = char_para.add_run("åä¸åçº¿ææ¬")
underline_run.font.underline = WD_UNDERLINE.DOUBLE
char_para.add_run(" | ")

# ä¸åå­å·åé¢è²
color_run = char_para.add_run("16å·çº¢è²ææ¬")
color_run.font.size = Pt(16)               # å­å·
color_run.font.color.rgb = RGBColor(255, 0, 0)  # é¢è²
char_para.add_run(" | ")

# ä¸æ 
sup_run = char_para.add_run("ä¸æ ")
sup_run.font.superscript = True

# ==================== 3. ä¿å­ææ¡£ ====================
doc.save("ææ¬æ ¼å¼ç¤ºä¾.docx")
print("ææ¡£å·²ä¿å­ä¸ºï¼ææ¬æ ¼å¼ç¤ºä¾.docx")
</code></pre>
<h3 id="124-sectionså¯¹è±¡">1.2.4 Sectionså¯¹è±¡</h3>
<p>Wordå¼å¥äºèï¼sectionï¼çæ¦å¿µï¼å®æææ¡£ä¸­å·æç¸åé¡µé¢å¸å±ï¼å¦é¡µè¾¹è·ãçº¸å¼ æ¹åï¼çè¿ç»­é¨åãéè¿åèï¼ç¨æ·å¯ä»¥å¨åä¸ä»½ææ¡£ä¸­æ··åä½¿ç¨ä¸åçå¼ï¼ä¾å¦åæ¶åå«çºµåé¡µé¢åæ¨ªåé¡µé¢ãæ­¤å¤ï¼æ¯ä¸ªèè¿å¯ä»¥ç¬ç«è®¾ç½®å¶é¡µçä¸é¡µèçæ ·å¼ãç»å¤§å¤æ°Wordææ¡£é»è®¤ä»åå«ä¸ä¸ªèï¼éå¸¸ä¹æ éæ´æ¹é¡µé¢å¸å±ãç¶èï¼å½ç¡®å®éè¦å¯¹é¡µé¢å¸å±è¿è¡è°æ´æ¶ï¼çè§£èçåè½ä¸è®¾ç½®æ¹æ³å°±åå¾è³å³éè¦ãä»¥ä¸ç¤ºä¾å±ç¤ºäºå¦ä½ä½¿ç¨python-docxåºåå»ºåå«å¤ä¸ªèãåèæ¥æä¸åé¡µé¢è®¾ç½®çWordææ¡£ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.enum.section import WD_SECTION_START
from docx.enum.section import WD_ORIENT
from docx.shared import Inches

# 1. åå»ºæ°ææ¡£å¹¶æ¥çé»è®¤è
document = Document()
print("åå§ææ¡£çèæ°éï¼", len(document.sections))  # é»è®¤1ä¸ªè

# è·åé»è®¤èå¹¶ä¿®æ¹å¶åºç¡å¸å±ï¼çºµåï¼å¸¸è§è¾¹è·ï¼
default_section = document.sections[0]
# è®¾ç½®é»è®¤èçè¾¹è·ï¼å·¦1.5è±å¯¸ãå³1è±å¯¸ãä¸ä¸å1è±å¯¸
default_section.left_margin = Inches(1.5)
default_section.right_margin = Inches(1)
default_section.top_margin = Inches(1)
default_section.bottom_margin = Inches(1)

# 2. ç»é»è®¤èæ·»å åå®¹ï¼çºµåé¡µé¢åå®¹ï¼
document.add_heading('ç¬¬ä¸èï¼çºµåé¡µé¢åå®¹', level=1)
document.add_paragraph('è¿æ¯é»è®¤èçåå®¹ï¼é¡µé¢ä¸ºçºµåï¼è¾¹è·ï¼å·¦1.5è±å¯¸ãå³1è±å¯¸ã')

# 3. æ·»å æ°èï¼å¥æ°é¡µå¼å§ï¼æ¨ªåå¸å±ï¼
# åå»ºæ°èï¼æå®åèç¬¦ç±»åä¸ºå¥æ°é¡µå¼å§
new_section = document.add_section(WD_SECTION_START.ODD_PAGE)
# ä¿®æ¹æ°èçé¡µé¢æ¹åä¸ºæ¨ªåï¼éåæ¶äº¤æ¢å®½é«ï¼
new_section.orientation = WD_ORIENT.LANDSCAPE
# åäº¤æ¢å®½é«å¼ï¼é¿åé¡µé¢å°ºå¯¸å¼å¸¸
new_width, new_height = new_section.page_height, new_section.page_width
new_section.page_width = new_width
new_section.page_height = new_height
# è®¾ç½®æ°èçè¾¹è·ï¼å·¦å³å1.25è±å¯¸ï¼ä¸ä¸å0.8è±å¯¸
new_section.left_margin = Inches(1.25)
new_section.right_margin = Inches(1.25)
new_section.top_margin = Inches(0.8)
new_section.bottom_margin = Inches(0.8)

# 4. ç»æ°èæ·»å åå®¹ï¼æ¨ªåé¡µé¢åå®¹ï¼
document.add_heading('ç¬¬äºèï¼æ¨ªåé¡µé¢åå®¹', level=1)
document.add_paragraph('è¿æ¯æ°èçåå®¹ï¼é¡µé¢ä¸ºæ¨ªåï¼è¾¹è·ï¼å·¦å³1.25è±å¯¸ãä¸ä¸0.8è±å¯¸ã')

# 5. åæ·»å ä¸ä¸ªæ°èï¼å¶æ°é¡µå¼å§ï¼çºµåå¸å±ï¼
third_section = document.add_section(WD_SECTION_START.EVEN_PAGE)
# æ¢å¤çºµåå¸å±
third_section.orientation = WD_ORIENT.PORTRAIT
third_section.page_width = Inches(8.5)
third_section.page_height = Inches(11)
# è®¾ç½®ç¹æ®è¾¹è·ï¼æ·»å è£è®¢çº¿ï¼
third_section.gutter = Inches(0.2)  # è£è®¢çº¿0.2è±å¯¸
third_section.header_distance = Inches(0.6)  # é¡µçè·ç¦»0.6è±å¯¸

# 6. ç»ç¬¬ä¸ä¸ªèæ·»å åå®¹
document.add_heading('ç¬¬ä¸èï¼å¸¦è£è®¢çº¿ççºµåé¡µé¢', level=1)
document.add_paragraph('è¿ä¸èåå«0.2è±å¯¸çè£è®¢çº¿ï¼é¡µçè·ç¦»é¡µé¢é¡¶é¨0.6è±å¯¸ã')

# 7. éåææèï¼æå°å³é®å±æ§
print("\n=== ææèçå³é®å±æ§ ===")
for idx, section in enumerate(document.sections):
    print(f"\nç¬¬{idx+1}èï¼")
    print(f"  èµ·å§ç±»åï¼{section.start_type}")
    print(f"  é¡µé¢æ¹åï¼{section.orientation}")
    print(f"  å·¦å³è¾¹è·ï¼{section.left_margin/914400:.2f}è±å¯¸ / {section.right_margin/914400:.2f}è±å¯¸")
    print(f"  è£è®¢çº¿ï¼{section.gutter/914400:.2f}è±å¯¸")

# ä¿å­ææ¡£
document.save("å¤èææ¡£ç¤ºä¾.docx")
print("\nææ¡£å·²ä¿å­ä¸ºï¼å¤èææ¡£ç¤ºä¾.docx")
</code></pre>
<h3 id="125-é¡µçé¡µèå¯¹è±¡">1.2.5 é¡µçé¡µèå¯¹è±¡</h3>
<p>é¡µçæ¯ææ¾ç¤ºå¨æ¯ä¸é¡µä¸é¡µè¾¹è·åºåçææ¬ï¼ä¸æ­£æåå®¹ç¸äºç¬ç«ï¼éå¸¸ç¨äºå±ç¤ºææ¡£æ é¢ãä½èãåå»ºæ¥ææé¡µç ç­ä¸ä¸æä¿¡æ¯ãåä¸ææ¡£ä¸­çé¡µçå¨åé¡µé¢é´åºæ¬ä¿æä¸è´ï¼ä»å¨é¨ååå®¹ä¸å¯è½å­å¨ç»å¾®å·®å¼ï¼ä¾å¦ç« èæ é¢æé¡µç çååãé¡µèå¨åè½åç¹æ§ä¸ä¸é¡µçå®å¨ç±»ä¼¼ï¼å¯ä¸çåºå«æ¯é¡µèä½äºé¡µé¢åºé¨ãé¡µèä¸èæ³¨ä¸åï¼èæ³¨å¨åé¡µé¢é´å¹¶ä¸ç»ä¸ãä»¥ä¸æ¯æä½ææ¡£é¡µçé¡µèçç¤ºä¾ä»£ç ï¼</p>
<pre><code class="language-python">from docx import Document

# -------------------------- 1. åå§åææ¡£å¹¶åå»ºåºç¡é¡µç --------------------------
# åå»ºæ°ææ¡£
doc = Document()

# è·åææ¡£çç¬¬ä¸ä¸ªèï¼æ°å»ºææ¡£é»è®¤åªæ1ä¸ªèï¼
section1 = doc.sections[0]
header1 = section1.header

# æ£æ¥åå§ç¶æï¼æ°å»ºææ¡£çé¡µçé»è®¤å³èå°åä¸èé¡µçè®¾ç½®ï¼æ­¤å¤æ åç½®èï¼ææ å®éé¡µçï¼
print(f"åå§é¡µçå³èç¶æ: {header1.is_linked_to_previous}")  # è¾åº: True

# ä¸ºç¬¬ä¸èæ·»å ç®åé¡µçï¼ä»å·¦ä¾§ææ¬ï¼
# ç´æ¥ç¼è¾é¡µççç¬¬ä¸ä¸ªæ®µè½ï¼æ°å»ºé¡µçé»è®¤åå«1ä¸ªç©ºæ®µè½ï¼
para1 = header1.paragraphs[0]
para1.text = "ææ¡£ä¸»æ é¢ - ç¬¬ä¸èé¡µç"
# èªå¨åå»ºç¬ç«é¡µçå®ä¹ï¼å³èç¶æåä¸ºFalse
print(f"æ·»å é¡µçåå³èç¶æ: {header1.is_linked_to_previous}")  # è¾åº: False

# -------------------------- 2. æ·»å å¸¦ååºï¼å·¦/ä¸­/å³ï¼çé¡µç --------------------------
# åæ¸ç©ºç¬¬ä¸èåæé¡µçåå®¹ï¼éæ°è®¾ç½®ååºé¡µç
para1.clear()
# ä½¿ç¨å¶è¡¨ç¬¦\tåéå·¦ãä¸­ãå³ä¸é¨ååå®¹
para1.text = "å·¦ä¾§ï¼ææ¡£åç§°\tå±ä¸­ï¼2026å¹´1æ\tå³ä¾§ï¼é¡µç "
# åºç¨Wordé»è®¤ç"Header"æ ·å¼ï¼ç¡®ä¿å¶è¡¨ä½çæï¼
para1.style = doc.styles["Header"]

# -------------------------- 3. æ·»å æ°èå¹¶è®¾ç½®ç¬ç«é¡µç --------------------------
# åææ¡£æ«å°¾æ·»å æ°èï¼section2ï¼
section2 = doc.add_section()
header2 = section2.header

# åå§ç¶æï¼æ°èçé¡µçé»è®¤å³èå°åä¸èï¼section1ï¼
print(f"ç¬¬äºèåå§å³èç¶æ: {header2.is_linked_to_previous}")  # è¾åº: True
# éªè¯ï¼æ­¤æ¶ç¼è¾header2çåå®¹ä¼ç´æ¥ä¿®æ¹section1çé¡µçï¼ç»§æ¿ç¹æ§ï¼
# ååæ¶å³èï¼åå»ºç¬¬äºèçç¬ç«é¡µç
header2.is_linked_to_previous = False
# ä¸ºç¬¬äºèæ·»å ä¸å±é¡µç
para2 = header2.paragraphs[0]
para2.text = "ç¬¬äºèç¬ç«é¡µç - ä»æ¬èæ¾ç¤º"

# -------------------------- 4. æ·»å é¡µèï¼ä¸é¡µçç¨æ³å®å¨ä¸è´ï¼ --------------------------
# ä¸ºç¬¬ä¸èæ·»å é¡µèï¼åå«é¡µç ï¼
footer1 = doc.sections[0].footer
footer1.is_linked_to_previous = False  # åæ¶å³èï¼åå»ºç¬ç«é¡µè
footer_para1 = footer1.paragraphs[0]
footer_para1.text = "\tç¬¬ {PAGE} é¡µ / å± {NUMPAGES} é¡µ\t"  # å±ä¸­æ¾ç¤ºé¡µç 
footer_para1.style = doc.styles["Footer"]
# ä¸ºç¬¬äºèæ·»å ä¸åçé¡µè
footer2 = doc.sections[1].footer
footer2.is_linked_to_previous = False
footer_para2 = footer2.paragraphs[0]
footer_para2.text = "ç¬¬äºèé¡µè - èç³»äººï¼æµè¯è´¦å·"

# -------------------------- 5. å é¤é¡µçï¼æ¢å¤å³èç¶æï¼ --------------------------
# è¥éå é¤ç¬¬äºèçç¬ç«é¡µçï¼åªéå°å¶å³èç¶æè®¾ä¸ºTrueï¼ä¼æ°¸ä¹å é¤åå®¹ï¼
# æ­¤å¤ä»æ¼ç¤ºï¼æ³¨éæé¿åå½±åæç»ææ
# header2.is_linked_to_previous = True

# -------------------------- 6. ä¿å­ææ¡£ --------------------------
doc.save("é¡µçé¡µèç¤ºä¾.docx")
print("ææ¡£å·²ä¿å­ä¸ºï¼é¡µçé¡µèç¤ºä¾.docx")
</code></pre>
<h2 id="13-éææ¬åå®¹ç®¡ç">1.3 éææ¬åå®¹ç®¡ç</h2>
<h3 id="131-æ ·å¼ç®¡ç">1.3.1 æ ·å¼ç®¡ç</h3>
<p>å¨Wordä¸­ï¼åç½®æ ·å¼ä¼åºç°å¨Wordçé¢çæ ·å¼é¢æ¿ä¸­ï¼ä½ä¸ä¼èªå¨å å¥ææ¡£ä¸­ï¼ç´å°ä½ ç¬¬ä¸æ¬¡ä½¿ç¨å®ãè¿æ ·é¿åäºæä»¶å æææ ·å¼å®ä¹èèè¿ãä¸æ¦ææ ·å¼è¢«ä½¿ç¨ï¼å¶å®ä¹å°±ä¼æ°¸ä¹å å¥ææ¡£ï¼å³ä½¿åæ¥å é¤åºç¨åå®¹ä¹ä¸ä¼æ¶å¤±ãå æ­¤ï¼è¥è¦ç¨python-docxä½¿æ ·å¼çæï¼å¿é¡»å¨åå§ææ¡£ä¸­åå«å¶å®ä¹ï¼å¦åæ ·å¼ä¼éé»å¤±æã<br>
ä»¥ä¸æ¯ä¸ä¸ªç»¼åæ§çç¤ºä¾ï¼å®æ´åäºææ¡£ä¸­æææ ¸å¿çæ ·å¼æä½åè½ï¼åæ¬æ ·å¼çè®¿é®ãåºç¨ãåå»ºãå é¤ï¼ä»¥åå­ç¬¦æ®µè½æ ¼å¼çå®ä¹ç­ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.enum.style import WD_STYLE_TYPE
from docx.shared import Pt, Inches
from docx.enum.text import WD_UNDERLINE

# 1. åå»ºæ°ææ¡£å¹¶è®¿é®æ ·å¼éå
doc = Document()
styles = doc.styles
print(f"åå§æ ·å¼æ°é: {len(styles)}")

# 2. è®¿é®å¹¶ç­éç¹å®ç±»åçæ ·å¼
# ç­éæææ®µè½æ ·å¼å¹¶æå°åç§°
print("\n=== æææ®µè½æ ·å¼ ===")
paragraph_styles = [s for s in styles if s.type == WD_STYLE_TYPE.PARAGRAPH]
for style in paragraph_styles[:5]:  # åªæå°å5ä¸ªé¿åè¾åºè¿é¿
    print(f"- {style.name}")

# 3. åºç¨ç°ææ ·å¼å°æ°æ®µè½
# æ¹å¼1: åå»ºæ¶æå®æ ·å¼åç§°
doc.add_heading("æ ·å¼æä½ç¤ºä¾", level=0)
heading1_para = doc.add_paragraph("è¿æ¯åºç¨ Heading 1 æ ·å¼çæ®µè½", style="Heading 1")
# æ¹å¼2: ååå»ºæ®µè½åèµå¼æ ·å¼å¯¹è±¡
normal_para = doc.add_paragraph()
normal_para.text = "è¿æ¯ååå»ºååºç¨ Normal æ ·å¼çæ®µè½"
normal_para.style = styles["Normal"]

# 4. åå»ºèªå®ä¹æ ·å¼
# 4.1 åå»ºæ®µè½æ ·å¼å¹¶è®¾ç½®åºç¡æ ·å¼ãå­ç¬¦æ ¼å¼ãæ®µè½æ ¼å¼
citation_style = styles.add_style("Citation", WD_STYLE_TYPE.PARAGRAPH)
# è®¾ç½®åºç¡æ ·å¼ï¼ç»§æ¿ Normal æ ·å¼çæ ¼å¼ï¼
citation_style.base_style = styles["Normal"]
# è®¾ç½®å­ç¬¦æ ¼å¼
citation_style.font.name = "å®ä½"
citation_style.font.size = Pt(10)
citation_style.font.italic = True  # æä½
citation_style.font.underline = WD_UNDERLINE.DOT_DASH  # ç¹åçº¿ä¸åçº¿
# è®¾ç½®æ®µè½æ ¼å¼ï¼æ¬æç¼©è¿ãæ®µåé´è·ï¼
citation_style.paragraph_format.left_indent = Inches(0.25)
citation_style.paragraph_format.first_line_indent = Inches(-0.25)
citation_style.paragraph_format.space_before = Pt(6)
# è®¾ç½®åç»­æ®µè½æ ·å¼
citation_style.next_paragraph_style = styles["Normal"]

# åºç¨èªå®ä¹æ ·å¼
citation_para = doc.add_paragraph("è¿æ¯èªå®ä¹ Citation æ ·å¼çå¼ç¨ææ¬", style="Citation")
print(f"\nèªå®ä¹æ ·å¼åºç¨ååç§°: {citation_para.style.name}")

# 5. æ§å¶æ ·å¼å¨ Word ä¸­çæ¾ç¤ºï¼å¿«éæ ·å¼ãä¼åçº§ï¼
body_text_style = styles["Body Text"]
body_text_style.hidden = False
body_text_style.quick_style = True
body_text_style.priority = 1

# 6. å¤çæ½å¨æ ·å¼ï¼Latent Stylesï¼
latent_styles = styles.latent_styles
print(f"\næ½å¨æ ·å¼æ»æ°: {len(latent_styles)}")

# ä¸º List Bullet æ·»å æ½å¨æ ·å¼å®ä¹
if "List Bullet" not in latent_styles:
    latent_list_bullet = latent_styles.add_latent_style("List Bullet")
    latent_list_bullet.hidden = False
    latent_list_bullet.priority = 2
    latent_list_bullet.quick_style = True
print(f"List Bullet æ½å¨æ ·å¼ä¼åçº§: {latent_styles['List Bullet'].priority}")

# 7. å é¤æ ·å¼
print(f"\nå é¤åæ ·å¼æ°é: {len(styles)}")
if "Citation" in styles:
    styles["Citation"].delete()
    print(f"å é¤åæ ·å¼æ°é: {len(styles)}")

# 8. ä¿å­ææ¡£
doc.save("æ ·å¼æä½ç¤ºä¾.docx")
print("\nææ¡£å·²ä¿å­ä¸º: æ ·å¼æä½ç¤ºä¾.docx")
</code></pre>
<h3 id="132-æ¹æ³¨ç®¡ç">1.3.2 æ¹æ³¨ç®¡ç</h3>
<p>Wordæ¯æå¨ææ¡£ä¸­æ·»å æ¹æ³¨ï¼è¿æ¯å®¡éåè½çä¸é¨åï¼éå¸¸ç¨äºä»äººå¨ä¸ä¿®æ¹åæçæåµä¸æä¾åé¦ãWordææ¡£éæä½æ­¥éª¤å¦ä¸ï¼</p>
<ol>
<li>éåææ¬èå´ï¼</li>
<li>ç¹å»å®¡éå·¥å·æ ä¸­çæ°å»ºæ¹æ³¨ï¼</li>
<li>è¾å¥æç²è´´æ¹æ³¨åå®¹ã</li>
</ol>
<p>æ¹æ³¨ä»è½æ·»å è³ææ¡£ä¸»ä½ï¼ä¸å¯æå¥é¡µçãé¡µèæå¶ä»æ¹æ³¨åãWordææ¡£éèæ³¨åå°¾æ³¨ä¸­çè®ºä¸åè®¸æ·»å æ¹æ³¨ï¼ä½å½åpython-docxæä¸æ¯æè¯¥æä½ãæ­¤å¤é«çæ¬Wordæ¯æè§£å³æ¹æ³¨ååå¤æ¹æ³¨åè½ï¼ä½python-docxææªå®ç°ãä»¥ä¸æ¯åå«æ¹æ³¨åå»ºãå¯ææ¬æ¹æ³¨ãåæ°æ®ä¿®æ¹åæ¹æ³¨éåçå®æ´ç¤ºä¾ï¼</p>
<pre><code class="language-python"># å¯¼å¥å¿è¦çåº
from docx import Document
from datetime import datetime, timezone

"""
åå»ºææ¡£å¹¶æ¼ç¤ºæ¹æ³¨çå®æ´æä½æµç¨ï¼
1. åå»ºåºç¡æ¹æ³¨
2. åå»ºå¯ææ¬æ ¼å¼æ¹æ³¨
3. ä¿®æ¹æ¹æ³¨åæ°æ®
4. è®¿é®åéåæææ¹æ³¨
"""
# 1. åå§åææ¡£å¯¹è±¡
doc = Document()
doc.add_heading("Python-docx æ¹æ³¨æ¼ç¤ºææ¡£", level=1)

# 2. ç¤ºä¾1ï¼åå»ºåºç¡ææ¬æ¹æ³¨
para1 = doc.add_paragraph("è¿æ¯ç¬¬ä¸æ®µæµè¯ææ¬ï¼ç¨äºæ·»å åºç¡æ¹æ³¨ã")
# ä¸ºæ´æ®µææ¬æ·»å åºç¡æ¹æ³¨
basic_comment = doc.add_comment(
    runs=para1.runs,  # å³èçææ¬å
    text="åºç¡æ¹æ³¨ï¼è¿æ®µææ¬è¡¨è¿°æ¸æ°ï¼å»ºè®®ä¿çã",  # æ¹æ³¨çº¯ææ¬åå®¹
    author="å¼ ä¸",  # æ¹æ³¨ä½è
    initials="ZS"  # ä½èç¼©å
)
print(f"â åºç¡æ¹æ³¨åå»ºå®æ")
# 3. ç¤ºä¾2ï¼åå»ºå¯ææ¬æ ¼å¼æ¹æ³¨ï¼åå«ç²ä½ãæä½ç­æ ·å¼ï¼
para2 = doc.add_paragraph("è¿æ¯ç¬¬äºæ®µæµè¯ææ¬ï¼ç¨äºæ·»å å¯ææ¬æ¹æ³¨ã")
# åå»ºç©ºåå®¹æ¹æ³¨ï¼åç»­æå¨æ·»å å¯ææ¬ï¼
rich_comment = doc.add_comment(
    runs=para2.runs,
    text="",  # åå§ä¸ºç©ºï¼åç»­æ·»å å¯ææ¬
    author="æå",
    initials="LS"
)
# åæ¹æ³¨ä¸­æ·»å å¯ææ¬åå®¹
cmt_para = rich_comment.paragraphs[0]  # è·åæ¹æ³¨çé»è®¤æ®µè½
cmt_para.add_run("å¯ææ¬æ¹æ³¨ï¼")  # æ®éææ¬
cmt_para.add_run("éç¹å»ºè®®ï¼").bold = True  # ç²ä½ææ¬
cmt_para.add_run("è¿æ®µææ¬éè¦è¡¥åæ¡ä¾ï¼").italic = True  # æä½ææ¬
cmt_para.add_run("å»ºè®®åèè¡ä¸æ åã")  # æ®éææ¬

# 4. ç¤ºä¾3ï¼ä¿®æ¹æ¹æ³¨åæ°æ®ï¼ä½èãç¼©åï¼
basic_comment.author = "å¼ å°ä¸"  # ä¿®æ¹ä½èå
basic_comment.initials = "ZXS"  # ä¿®æ¹ä½èç¼©å
print(f"â åºç¡æ¹æ³¨åæ°æ®å·²æ´æ°ï¼ä½è={basic_comment.author}ï¼ç¼©å={basic_comment.initials}")

# 5. ç¤ºä¾4ï¼è®¿é®åéåæææ¹æ³¨
print("\nð ææ¡£ä¸­æææ¹æ³¨ä¿¡æ¯ï¼")
for idx, comment in enumerate(doc.comments):
    print(f"\næ¹æ³¨ {idx+1}ï¼")
    print(f"  ä½èï¼{comment.author}")
    print(f"  ç¼©åï¼{comment.initials}")
    # æåæ¹æ³¨çå®æ´ææ¬ï¼å¼å®¹å¯ææ¬ï¼
    comment_text = "\n  ".join([para.text for para in comment.paragraphs])
    print(f"  åå®¹ï¼{comment_text}")

# 6. ä¿å­ææ¡£
doc.save("æ¹æ³¨æ¼ç¤ºææ¡£.docx")
print("\nð ææ¡£å·²ä¿å­ä¸ºï¼æ¹æ³¨æ¼ç¤ºææ¡£.docx")
</code></pre>
<h3 id="133-å¾çå¯¹è±¡">1.3.3 å¾çå¯¹è±¡</h3>
<p>Wordææ¡£ä¸­çåå®¹åä¸ºä¸¤ä¸ªå¾å±ï¼ææ¬å±åç»å¾å±ãææ¬å±æä»å·¦å°å³ãèªä¸èä¸çé¡ºåºæåï¼é¡µæ»¡åèªå¨æ¢é¡µãç»å¾å±ä¸­çå¯¹è±¡ç§°ä¸ºå½¢ç¶ï¼å¯èªç±æ¾ç½®ãå¾çæ¯ä¸ç§ç¹æ®å½¢ç¶ï¼å¯ç½®äºææ¬å±æç»å¾å±ãä½äºææ¬å±çå¾çç§°ä¸ºåµå¥å¼å¾çï¼å®å¨æçä¸­è¢«è§ä¸ºä¸ä¸ªå¤§åææ¬å­ç¬¦ï¼è¡é«ä¼èªå¨è°æ´ä»¥å®¹çº³å¾çï¼å¹¶æ¯æç±»ä¼¼ææ¬çæ¢è¡ææãè¥å¨å¶åæ¹æå¥ææ¬ï¼å¾çä¼éä¹ååç§»å¨ãåµå¥å¼å¾çéå¸¸ç¬å ä¸ä¸ªæ®µè½ï¼ä½ä¹å¯ä¸ååææ¬å±å­äºåä¸æ®µè½ä¸­ã</p>
<p>å½åpython-docxåºä»æ¯æåµå¥å¼å¾çãéè¿Document.add_picture()æ¹æ³å¯å°å¾çé»è®¤æ·»å è³ææ¡£æ«å°¾çç¬ç«æ®µè½ä¸­ï¼ä½ç»è¿éå½è®¾ç½®ï¼ä¹è½å®ç°çµæ´»çå¾ææ··æææï¼ç¤ºä¾å¦ä¸ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.shared import Inches, Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH

# 1. åå»ºä¸ä¸ªæ°çWordææ¡£
doc = Document()

# 2. åºç¡ç¨æ³ï¼å¨ææ¡£æ«å°¾æå¥å¾çï¼åç¬å ä¸ä¸ªæ®µè½ï¼
doc.add_heading('1. åºç¡æå¥å¾ç', level=2)
# æ·»å å¾çï¼è®¾ç½®å®½åº¦ä¸º2è±å¯¸ï¼é«åº¦ä¼ææ¯ä¾èªå¨è°æ´ï¼
doc.add_picture('test.png', width=Inches(2))

# 3. è¿é¶ç¨æ³ï¼å¾ææ··æï¼å¾çåææ¬å¨åä¸ä¸ªæ®µè½ï¼
doc.add_heading('2. å¾ææ··æç¤ºä¾', level=2)
# åå»ºä¸ä¸ªæ°æ®µè½
mixed_paragraph = doc.add_paragraph()
# æ·»å ææ¬å°æ®µè½å¼å¤´
mixed_paragraph.add_run('è¿æ¯å¾çå·¦ä¾§çææ¬ï¼')
# å¨æ®µè½ä¸­æå¥å¾çï¼éåç¬æ®µè½ï¼
img_run = mixed_paragraph.add_run()
img_run.add_picture('test.png', width=Inches(1))
# å¨å¾çå³ä¾§æ·»å ææ¬
mixed_paragraph.add_run('è¿æ¯å¾çå³ä¾§çææ¬ã')

# 4. èªå®ä¹å¾çå°ºå¯¸+æ®µè½å¯¹é½
doc.add_heading('3. èªå®ä¹å°ºå¯¸ä¸å¯¹é½', level=2)
align_para = doc.add_paragraph()
align_para.alignment = WD_ALIGN_PARAGRAPH.CENTER  # æ®µè½å±ä¸­å¯¹é½
align_run = align_para.add_run()
# åæ¶è®¾ç½®å®½åº¦åé«åº¦ï¼æ³¨æï¼å¯è½å¯¼è´å¾çåå½¢ï¼
align_run.add_picture('test.png', width=Inches(1.5), height=Inches(1))
align_para.add_run('\nè¿æ¯å±ä¸­æ¾ç¤ºçå¾ç')

# 5. ä¿å­ææ¡£
doc.save('å½¢ç¶å¾çç¤ºä¾.docx')
print("ææ¡£å·²ä¿å­ä¸ºå½¢ç¶å¾çç¤ºä¾.docx")
</code></pre>
<h2 id="14-ç»¼åç¤ºä¾">1.4 ç»¼åç¤ºä¾</h2>
<p>å¨å®éåºç¨ä¸­ï¼python-docxä¸»è¦è¢«ç¨äºææ¡£ä¿®æ¹åèªå¨åçæï¼èéä»å¤´åå»ºææ¡£ãæ¬èå°éè¿ä¸ä¸ªç»¼åç¤ºä¾ï¼å±ç¤ºå¦ä½å¯¹ä¸ä¸ªåå«æ é¢ãæ®µè½ãå¤ç§è¡¨æ ¼ãå¤å¼ å¾çååé¡µç¬¦çå¤é¡µææ¡£è¿è¡éå¯¹æ§ä¿®æ¹ï¼å¹¶æä¾ç¸åºçææ¡£çæä»£ç ã</p>
<p><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/CSDN/%5Bpython%5D%20%E5%9F%BA%E4%BA%8Epython-docx%E5%BA%93%E7%9A%84Word%E6%96%87%E6%A1%A3%E8%87%AA%E5%8A%A8%E5%A4%84%E7%90%86%E5%85%A8%E8%A7%A3/imgs/2.jpg" alt="" loading="lazy"></p>
<p><strong>ææ¡£çæ</strong></p>
<p>ä»¥ä¸ä»£ç çæä¸ä¸ªç¤ºä¾å¤é¡µææ¡£ï¼æ¶µçäºæ¥å¸¸åå¬ä¸­å¸¸è§çææ¡£ç»æï¼</p>
<pre><code class="language-python">from docx import Document
from docx.shared import Inches, Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.enum.table import WD_TABLE_ALIGNMENT
from docx.oxml.ns import qn
import os

def ensure_test_images():
    # ç®åçææµè¯å¾çï¼å¦ææ²¡æçè¯ï¼
    try:
        from PIL import Image
        for i in range(1, 3):
            img_path = f"image{i}.jpg"
            if not os.path.exists(img_path):
                img = Image.new('RGB', (800, 600), color='lightblue')
                img.save(img_path)
        print("æµè¯å¾çå·²åå¤å®æ")
    except ImportError:
        print("è¯·å®è£pillowåºï¼pip install pillow")
        exit(1)

# çæWordææ¡£
def generate_complex_doc():
    # åå»ºæ°ææ¡£
    doc = Document()
    
    # è®¾ç½®ææ¡£é»è®¤å­ä½ï¼è§£å³ä¸­ææ¾ç¤ºé®é¢ï¼
    doc.styles['Normal'].font.name = 'å¾®è½¯éé»'
    doc.styles['Normal']._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
    
    # ========== ç¬¬ä¸é¡µåå®¹ ==========
    # æ é¢
    title = doc.add_heading('XXé¡¹ç®è°ç æ¥å', 0)
    title.alignment = WD_ALIGN_PARAGRAPH.CENTER  # å±ä¸­å¯¹é½
    title_run = title.runs[0]
    title_run.font.size = Pt(24)
    title_run.font.bold = True
    
    # å¯æ é¢/è¯´æ
    sub_para = doc.add_paragraph('æ¥åçææ¶é´ï¼2026å¹´1æ  æ¥åç¼å¶äººï¼æµè¯ç¨æ·')
    sub_para.alignment = WD_ALIGN_PARAGRAPH.RIGHT
    sub_para_run = sub_para.runs[0]
    sub_para_run.font.size = Pt(10)
    
    # æ­£ææ®µè½
    doc.add_heading('ä¸ãé¡¹ç®æ¦è¿°', level=1)
    overview_para = doc.add_paragraph()
    overview_para.add_run('æ¬é¡¹ç®éå¯¹ä¼ä¸æ°å­åè½¬åéæ±ï¼éç¹è§£å³ç°æä¸å¡ç³»ç»æ°æ®å­¤å²ãæµç¨ä¸è§èãå³ç­æçä½ç­æ ¸å¿é®é¢ã').font.size = Pt(12)
    overview_para.add_run('\né¡¹ç®è¦çèå´åæ¬ï¼').font.bold = True
    overview_para.add_run('\n1) çäº§ç®¡çæ¨¡åï¼å®ç°çäº§æµç¨èªå¨åçæ§')
    overview_para.add_run('\n2) éå®ç®¡çæ¨¡åï¼æéå®¢æ·æ°æ®ä¸è®¢åç³»ç»')
    overview_para.add_run('\n3) è´¢å¡ç®¡çæ¨¡åï¼å®ç°è´¢å¡æ°æ®å®æ¶æ±æ»åæ')
    
    # ç¬¬ä¸ä¸ªè¡¨æ ¼ï¼é¡¹ç®åºç¡ä¿¡æ¯è¡¨ï¼2è¡4åï¼
    doc.add_heading('1.1 é¡¹ç®åºç¡ä¿¡æ¯', level=2)
    table1 = doc.add_table(rows=2, cols=4)
    table1.alignment = WD_TABLE_ALIGNMENT.CENTER  # è¡¨æ ¼å±ä¸­
    table1.style = 'Table Grid'  # å¸¦è¾¹æ¡æ ·å¼
    
    # å¡«åè¡¨æ ¼1è¡¨å¤´
    hdr_cells = table1.rows[0].cells
    hdr_cells[0].text = 'é¡¹ç®ç¼å·'
    hdr_cells[1].text = 'é¡¹ç®åç§°'
    hdr_cells[2].text = 'å¯å¨æ¶é´'
    hdr_cells[3].text = 'é¢è®¡å·¥æ'
    
    # å¡«åè¡¨æ ¼1åå®¹
    row_cells = table1.rows[1].cells
    row_cells[0].text = 'XM2026001'
    row_cells[1].text = 'ä¼ä¸æ°å­åè½¬åé¡¹ç®'
    row_cells[2].text = '2026-01-01'
    row_cells[3].text = '12ä¸ªæ'
    
    # è°æ´è¡¨æ ¼1ååæ ¼å­ä½
    for row in table1.rows:
        for cell in row.cells:
            for paragraph in cell.paragraphs:
                for run in paragraph.runs:
                    run.font.size = Pt(10)
                    run.font.name = 'å¾®è½¯éé»'
                    run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
    
    # æå¥ç¬¬ä¸å¼ å¾ç
    doc.add_heading('1.2 é¡¹ç®æ¶æå¾', level=2)
    img1_para = doc.add_paragraph()
    img1_para.alignment = WD_ALIGN_PARAGRAPH.CENTER
    img1_run = img1_para.add_run()
    img1_run.add_picture('image1.jpg', width=Inches(5))  # å¾çå®½åº¦5è±å¯¸
    img1_para.add_run('\nå¾1ï¼é¡¹ç®æ´ä½æ¶æå¾').font.size = Pt(10)
    
    # æå¥åé¡µç¬¦ï¼ç¬¬ä¸é¡µç»æï¼
    doc.add_page_break()
    
    # ========== ç¬¬äºé¡µåå®¹ ==========
    doc.add_heading('äºãé¡¹ç®èµæºéç½®', level=1)
    resource_para = doc.add_paragraph('æ¬é¡¹ç®æéèµæºåæ¬äººåèµæºãç¡¬ä»¶èµæºãè½¯ä»¶èµæºä¸å¤§ç±»ï¼å·ä½éç½®å¦ä¸è¡¨æç¤ºï¼')
    
    # ç¬¬äºä¸ªè¡¨æ ¼ï¼èµæºéç½®è¡¨ï¼5è¡3åï¼
    table2 = doc.add_table(rows=5, cols=3)
    table2.style = 'Table Grid'
    table2.alignment = WD_TABLE_ALIGNMENT.CENTER
    
    # å¡«åè¡¨æ ¼2
    table2_data = [
        ['èµæºç±»å', 'è§æ ¼/æ°é', 'å¤æ³¨'],
        ['äººåèµæº', 'é¡¹ç®ç»ç1äººï¼å¼åå·¥ç¨å¸5äººï¼æµè¯å·¥ç¨å¸2äºº', 'åä¸ºå¨è'],
        ['æå¡å¨', '8æ ¸16Gäºæå¡å¨3å°', 'é¿éäºECS'],
        ['æ°æ®åº', 'MySQL 8.0 ä¸»ä»æ¶æ', 'æ°æ®å®æ¶å¤ä»½'],
        ['è½¯ä»¶ææ', 'PythonãOfficeãå¼åå·¥å·', 'ä¼ä¸çææ']
    ]
    
    for i, row_data in enumerate(table2_data):
        row_cells = table2.rows[i].cells
        for j, cell_text in enumerate(row_data):
            row_cells[j].text = cell_text
            # è®¾ç½®ååæ ¼å­ä½
            for paragraph in row_cells[j].paragraphs:
                for run in paragraph.runs:
                    run.font.size = Pt(10)
                    run.font.name = 'å¾®è½¯éé»'
                    run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
        # è¡¨å¤´å ç²
        if i == 0:
            for cell in table2.rows[i].cells:
                for paragraph in cell.paragraphs:
                    for run in paragraph.runs:
                        run.font.bold = True
    
    # æå¥ç¬¬äºå¼ å¾ç
    doc.add_heading('2.1 èµæºé¨ç½²ç¤ºæå¾', level=2)
    img2_para = doc.add_paragraph()
    img2_para.alignment = WD_ALIGN_PARAGRAPH.CENTER
    img2_run = img2_para.add_run()
    img2_run.add_picture('image2.jpg', width=Inches(5))
    img2_para.add_run('\nå¾2ï¼èµæºé¨ç½²ææå¾').font.size = Pt(10)
    
    # è¡¥åæ®µè½åå®¹
    doc.add_paragraph('èµæºéç½®éµå¾ªãå¤ç¨ä¸é¢çæ©å±ãååï¼ç¡¬ä»¶èµæºå¯æ ¹æ®é¡¹ç®è¿åº¦å¼¹æ§æ©å®¹ï¼äººåèµæºéç¨ãæ ¸å¿+å¤åãæ¨¡å¼ä¿éäº¤ä»è¿åº¦ã')
    
    # æå¥åé¡µç¬¦ï¼ç¬¬äºé¡µç»æï¼
    doc.add_page_break()
    
    # ========== ç¬¬ä¸é¡µåå®¹ ==========
    doc.add_heading('ä¸ãé¡¹ç®é£é©è¯ä¼°', level=1)
    risk_para = doc.add_paragraph('éè¿å¯¹ææ¯ãäººåãææ¬ãè¿åº¦åä¸ªç»´åº¦çè¯ä¼°ï¼è¯å«åºä»¥ä¸æ ¸å¿é£é©ç¹ååºå¯¹æªæ½ï¼')
    
    # ç¬¬ä¸ä¸ªè¡¨æ ¼ï¼é£é©è¯ä¼°è¡¨ï¼4è¡4åï¼
    table3 = doc.add_table(rows=4, cols=4)
    table3.style = 'Table Grid'
    table3.alignment = WD_TABLE_ALIGNMENT.CENTER
    
    table3_data = [
        ['é£é©ç±»å', 'é£é©ç­çº§', 'å½±åèå´', 'åºå¯¹æªæ½'],
        ['ææ¯é£é©', 'ä¸­', 'æ ¸å¿åè½æ¨¡å', 'æåè¿è¡ææ¯é¢ç ï¼å¶å®å¤éæ¹æ¡'],
        ['è¿åº¦é£é©', 'ä½', 'æ´ä½äº¤ä»', 'è®¾ç½®éç¨ç¢èç¹ï¼æ¯å¨è¿åº¦å¤ç'],
        ['ææ¬é£é©', 'ä½', 'é¢ç®ç®¡æ§', 'å»ºç«ææ¬å°è´¦ï¼è¶æ¯æåé¢è­¦']
    ]
    
    for i, row_data in enumerate(table3_data):
        row_cells = table3.rows[i].cells
        for j, cell_text in enumerate(row_data):
            row_cells[j].text = cell_text
            for paragraph in row_cells[j].paragraphs:
                for run in paragraph.runs:
                    run.font.size = Pt(10)
                    run.font.name = 'å¾®è½¯éé»'
                    run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
        if i == 0:
            for cell in table3.rows[i].cells:
                for paragraph in cell.paragraphs:
                    for run in paragraph.runs:
                        run.font.bold = True
    
    # ç»å°¾æ®µè½
    doc.add_paragraph('\nç»¼ä¸æè¿°ï¼æ¬é¡¹ç®æ´ä½å¯æ§ï¼éè¿ç§å­¦çèµæºéç½®åé£é©ç®¡æ§æªæ½ï¼è½å¤ä¿éé¡¹ç®æè®¡åäº¤ä»å¹¶è¾¾å°é¢æç®æ ã')
    
    # ä¿å­ææ¡£
    doc.save('é¡¹ç®æ¥å.docx')
    print("é¡¹ç®æ¥åææ¡£å·²çæ")

if __name__ == '__main__':
    ensure_test_images()  # åå¤æµè¯å¾ç
    generate_complex_doc()
</code></pre>
<p><strong>ææ¡£ä¿®æ¹</strong></p>
<p>ææ¡£ä¿®æ¹ä»£ç éå¯¹ä¸è¿°çæçææ¡£ï¼å®ç°ä»¥ä¸å¸¸è§ä¿®æ¹éæ±ï¼</p>
<ul>
<li>ä¿®æ¹æ é¢åæ®µè½ææ¬</li>
<li>ä¿®æ¹è¡¨æ ¼ä¸­çåå®¹</li>
<li>æ¿æ¢å¾ç</li>
<li>æ·»å æ°çæ®µè½åè¡¨æ ¼</li>
<li>ä¿®æ¹å­ä½æ ·å¼</li>
</ul>
<p>ç¤ºä¾ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.shared import Inches, Pt
from docx.shared import RGBColor
from docx.enum.table import WD_TABLE_ALIGNMENT
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.oxml.ns import qn
import os

# ä¿®æ¹å·²çæçWordææ¡£
def modify_complex_doc(file_path):
    # æå¼å·²çæçææ¡£
    doc = Document(file_path)
    print("å·²æå¼å¾ä¿®æ¹çææ¡£")
    
    # ========== 1. ä¿®æ¹æ é¢ ==========
    # ç¬¬ä¸ä¸ªæ é¢æ¯çº§å«0çæ é¢ï¼ä¸»æ é¢ï¼
    main_title = doc.paragraphs[0]
    main_title.runs[0].text = 'XXä¼ä¸æ°å­åè½¬åé¡¹ç®ç»çæ¥å'  # ä¿®æ¹ä¸»æ é¢ææ¬
    main_title.runs[0].font.color.rgb = RGBColor(0, 0, 255)  # æ é¢æ¹ä¸ºèè²
    main_title.runs[0].font.size = Pt(20)
    main_title.runs[0].font.name = 'å¾®è½¯éé»'
    main_title.runs[0]._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
    main_title.alignment = WD_ALIGN_PARAGRAPH.CENTER
    
    # ========== 2. ä¿®æ¹æ®µè½ææ¬ ==========
    # æ¾å°"é¡¹ç®æ¦è¿°"ä¸çæ®µè½ï¼å¯éè¿ææ¬ç¹å¾å®ä½ï¼
    for para in doc.paragraphs:
        if 'æ¬é¡¹ç®éå¯¹ä¼ä¸æ°å­åè½¬åéæ±' in para.text:
            # æ¸ç©ºåæåå®¹ï¼éæ°åå¥
            para.clear()
            new_run = para.add_run('æ¬é¡¹ç®éå¯¹å¤§åå¶é ä¼ä¸æ°å­åè½¬åéæ±ï¼éç¹è§£å³ç°æä¸å¡ç³»ç»æ°æ®å­¤å²ãæµç¨ä¸è§èãå³ç­æçä½ç­æ ¸å¿é®é¢ã')
            new_run.font.size = Pt(12)
            new_run.font.name = 'å¾®è½¯éé»'
            new_run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
            # è¿½å åå®¹
            para.add_run('\né¡¹ç®åçº§åæ°å¢ï¼')
            para.add_run('\n4) ä¾åºé¾ç®¡çæ¨¡åï¼æéä¸ä¸æ¸¸ä¾åºåæ°æ®')
            break
    
    # ========== 3. ä¿®æ¹è¡¨æ ¼åå®¹å¹¶æ·»å è¡¨æ ¼å ==========
    # è¡¨æ ¼1ï¼é¡¹ç®åºç¡ä¿¡æ¯è¡¨ï¼ç¬¬ä¸ä¸ªè¡¨æ ¼ï¼
    table1 = doc.tables[0]
    # ä¿®æ¹é¡¹ç®ç¼å·
    table1.rows[1].cells[0].text = 'XM2026001-FINAL'
    # ä¿®æ¹é¢è®¡å·¥æ
    table1.rows[1].cells[3].text = '10ä¸ªæ'
    # ç»ä¿®æ¹åçååæ ¼æå­æ çº¢
    for cell in [table1.rows[1].cells[0], table1.rows[1].cells[3]]:
        for para in cell.paragraphs:
            for run in para.runs:
                run.font.color.rgb = RGBColor(255, 0, 0)
                run.font.size = Pt(11)
                run.font.name = 'å¾®è½¯éé»'
                run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
    
    # ä¸ºè¡¨æ ¼1æ·»å è¡¨æ ¼åï¼è¡¨é¢ï¼
    # æ¾å°è¡¨æ ¼1çä½ç½®ï¼å¨è¡¨æ ¼ä¸æ¹æå¥è¡¨å
    table1_elem = table1._element
    table_caption1 = doc.add_paragraph('è¡¨1 é¡¹ç®åºç¡ä¿¡æ¯è¡¨')
    table_caption1.alignment = WD_ALIGN_PARAGRAPH.CENTER  # å±ä¸­å¯¹é½
    table_caption1.paragraph_format.space_before = Pt(0)
    table_caption1.paragraph_format.space_after = Pt(0)
    # è®¾ç½®è¡¨åå­ä½æ ¼å¼
    for run in table_caption1.runs:
        run.font.size = Pt(11)
        run.font.name = 'å¾®è½¯éé»'
        run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
        run.font.bold = True  # å ç²
    # å°è¡¨åæå¥å°è¡¨æ ¼ä¸æ¹
    table1_elem.addprevious(table_caption1._element)
    
    # è¡¨æ ¼2ï¼èµæºéç½®è¡¨ï¼ç¬¬äºä¸ªè¡¨æ ¼ï¼
    table2 = doc.tables[1]
    # ä¿®æ¹æå¡å¨éç½®
    table2.rows[3].cells[1].text = '16æ ¸32Gäºæå¡å¨3å°ï¼åçº§éç½®ï¼'
    # è®¾ç½®è¡¨æ ¼2ååæ ¼å­ä½
    for row in table2.rows:
        for cell in row.cells:
            for para in cell.paragraphs:
                for run in para.runs:
                    run.font.size = Pt(11)
                    run.font.name = 'å¾®è½¯éé»'
                    run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
    
    # ä¸ºè¡¨æ ¼2æ·»å è¡¨æ ¼åï¼è¡¨é¢ï¼
    table2_elem = table2._element
    table_caption2 = doc.add_paragraph('è¡¨2 é¡¹ç®èµæºéç½®è¡¨')
    table_caption2.alignment = WD_ALIGN_PARAGRAPH.CENTER
    for run in table_caption2.runs:
        run.font.size = Pt(11)
        run.font.name = 'å¾®è½¯éé»'
        run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
        run.font.bold = True
    table2_elem.addprevious(table_caption2._element)
    
    # ========== 4. æ¿æ¢å¾çå¹¶è§èå¾å ==========
    # ååå¤ä¸å¼ æ°çæµè¯å¾ç
    from PIL import Image
    new_img_path = 'test.png'
    if not os.path.exists(new_img_path):
        img = Image.new('RGB', (800, 600), color='lightgreen')
        img.save(new_img_path)
    
    # æ¾å°ç¬¬ä¸å¼ å¾çæå¨çæ®µè½ï¼éè¿å¾çç¸å³ç¹å¾ï¼
    img_para_index = -1
    for i, para in enumerate(doc.paragraphs):
        if 'å¾1ï¼é¡¹ç®æ´ä½æ¶æå¾' in para.text or 'graphicData' in str(para._element.xml):
            img_para_index = i
            break
    
    if img_para_index != -1:
        # æ¸ç©ºæ®µè½ä¸­çå¾çåæå­ï¼éæ°æ·»å 
        img_para = doc.paragraphs[img_para_index]
        img_para.clear()
        
        # éæ°æ·»å æ°å¾ç
        img_run = img_para.add_run()
        img_run.add_picture(new_img_path, width=Inches(5))
        
        # æ·»å è§èçå¾åï¼å¾é¢ï¼
        img_caption = img_para.add_run('\nå¾1 é¡¹ç®æ´ä½æ¶æå¾ï¼ç»çï¼')
        img_caption.font.size = Pt(10)
        img_caption.font.name = 'å¾®è½¯éé»'
        img_caption._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
        img_para.alignment = WD_ALIGN_PARAGRAPH.CENTER
    
    # ========== 5. æ·»å æ°åå®¹å¹¶ä¸ºæ°è¡¨æ ¼å è¡¨å ==========
    # å¨ç¬¬ä¸é¡µé£é©è¯ä¼°åæ·»å æ°çæ®µè½åè¡¨æ ¼
    # åæ¾å°é£é©è¯ä¼°æ é¢çä½ç½®ï¼å¨å¶åæ·»å åå®¹
    for i, para in enumerate(doc.paragraphs):
        if 'ä¸ãé¡¹ç®é£é©è¯ä¼°' in para.text:
            # æ·»å æ°çå­æ é¢
            new_sub_heading = doc.add_heading('3.1 é£é©åºå¯¹é¢æ¡', level=2)
            # æå¥å°æå®ä½ç½®
            doc.paragraphs.insert(i+1, new_sub_heading)
            
            # æ·»å æ°æ®µè½
            new_para = doc.add_paragraph('éå¯¹é«ä¼åçº§é£é©ï¼å¶å®ä¸é¡¹åºå¯¹é¢æ¡ï¼åæ¬åºæ¥ååºæµç¨ãå¤ç¨èµæºè°éæ¹æ¡ç­ï¼ç¡®ä¿é£é©åçæ¶å¯å¿«éå¤ç½®ã')
            new_para.alignment = WD_ALIGN_PARAGRAPH.JUSTIFY
            for run in new_para.runs:
                run.font.size = Pt(12)
                run.font.name = 'å¾®è½¯éé»'
                run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
            doc.paragraphs.insert(i+2, new_para)
            
            # æ·»å æ°è¡¨æ ¼ï¼åºæ¥é¢æ¡è¡¨ï¼
            new_table = doc.add_table(rows=2, cols=2)
            new_table.style = 'Table Grid'
            new_table.alignment = WD_TABLE_ALIGNMENT.CENTER
            # å¡«åæ°è¡¨æ ¼
            new_table.rows[0].cells[0].text = 'é£é©ç±»å'
            new_table.rows[0].cells[1].text = 'åºæ¥èç³»äºº'
            new_table.rows[1].cells[0].text = 'ææ¯é£é©'
            new_table.rows[1].cells[1].text = 'å¼ å·¥ 13800138000'
            # è®¾ç½®æ°è¡¨æ ¼å­ä½
            for row in new_table.rows:
                for cell in row.cells:
                    for para_cell in cell.paragraphs:
                        for run in para_cell.runs:
                            run.font.size = Pt(10)
                            run.font.name = 'å¾®è½¯éé»'
                            run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
            
            # ä¸ºæ°è¡¨æ ¼æ·»å è¡¨å
            new_table_caption = doc.add_paragraph('è¡¨3 é£é©åºæ¥èç³»äººè¡¨')
            new_table_caption.alignment = WD_ALIGN_PARAGRAPH.CENTER
            for run in new_table_caption.runs:
                run.font.size = Pt(11)
                run.font.name = 'å¾®è½¯éé»'
                run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
                run.font.bold = True
            
            # æå¥æ°è¡¨æ ¼ååæ°è¡¨æ ¼
            doc.element.body.insert(i+3, new_table_caption._element)
            doc.element.body.insert(i+4, new_table._element)
            break
    
    # ========== ä¿å­ä¿®æ¹åçææ¡£ ==========
    doc.save('é¡¹ç®æ¥å_ä¿®æ¹ç.docx')
    print("ä¿®æ¹åçææ¡£å·²ä¿å­ï¼é¡¹ç®æ¥å_ä¿®æ¹ç.docx")

if __name__ == '__main__':
    # ç¡®ä¿åææ¡£å­å¨
    file_path = 'é¡¹ç®æ¥å.docx'
    if not os.path.exists(file_path):
        print("è¯·åè¿è¡çæä»£ç åå»ºåå§ææ¡£ï¼")
    else:
        modify_complex_doc(file_path)
</code></pre>
<h1 id="2-åè">2 åè</h1>
<ul>
<li><a href="https://github.com/python-openxml/python-docx" target="_blank" rel="noopener nofollow">python-docx</a></li>
<li><a href="https://python-docx.readthedocs.io/en/latest/" target="_blank" rel="noopener nofollow">python-docx docs</a></li>
</ul>

</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/luohenyueji/" target="_blank">è½ççå¯å</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/luohenyueji/p/19479110" target="_blank">https://www.cnblogs.com/luohenyueji/p/19479110</a></p>

<div style="text-align:center">
    <img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/wechat/content/%E5%8A%A0%E6%B2%B9%E9%B8%AD.gif">
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 20:09">2026-01-13 20:08</span>&nbsp;
<a href="https://www.cnblogs.com/luohenyueji">è½ççå¯å</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479110);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479110', targetLink: 'https://www.cnblogs.com/luohenyueji/p/19479110', title: '[python] åºäºpython-docxåºçWordææ¡£èªå¨å¤çå¨è§£' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æç»âæ¼åâï¼ç¨AIæä»¤åå­¦æ¯æç®æµ·çâæ·éå®¢â ]]></title>
    <link>https://www.cnblogs.com/huizhudev/p/19479049</link>
    <guid>097505eb455e8d7c189048174974236e</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/huizhudev/p/19479049" title="åå¸äº 2026-01-13 19:37">
    <span role="heading" aria-level="2">æç»âæ¼åâï¼ç¨AIæä»¤åå­¦æ¯æç®æµ·çâæ·éå®¢â</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3695776/202601/3695776-20260113193709973-1930184772.png" alt="æç»âæ¼åâï¼ç¨AIæä»¤åå­¦æ¯æç®æµ·çâæ·éå®¢â" class="desc_img">
        é¢å¯¹æµ·éæç®ä¸ç¥ææªï¼æ¬æåäº«äºä¸æ¡ä¸ä¸çAIæç®ç»¼è¿°çææä»¤ï¼å©ä½ ä»âä¿¡æ¯æ³¥ç³æµâä¸­é«ææ·éãéè¿ç»æåæ¹å¤åæ·±åº¦å å·¥ï¼è®©AIåå©æå»ºç³»ç»æ§ãæ¹å¤æ§çæç®ç»¼è¿°æ¡æ¶ï¼å®ç°ä»èµæå ç å°å­¦æ¯é´èµçè·¨è¶ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æ ¹æ®ææ°çå­¦æ¯åºçç»è®¡æ°æ®ï¼ä»å¨2025å¹´ï¼å¨çå°±åè¡¨äºè¶è¿600ä¸ç¯å­¦æ¯è®ºæãè¿æå³èä»ä¹ï¼å³ä½¿ä½ æ¯å¤©ä»æ©è¯»å°æï¼ä½ ä¹æ æ³è¯»å®ä½ æå¨é¢åä¸å¨çæ°å¢æç®ã</p>
<p>é¢å¯¹è¿æ»æ»èæ¥çâä¿¡æ¯æ³¥ç³æµâï¼å¤§å¤æ°ç ç©¶èçæç®ç»¼è¿°åå¾åæ¯ä»ä¹ï¼</p>
<p><strong>æç®çå°¸ä½å ç ã</strong></p>
<p>å¼ ä¸è¯´äºAï¼æåè¯´äºBï¼çäºè¯´äºCãæ²¡æä»»ä½è§ç¹ï¼æ²¡æä»»ä½èç»ï¼åªææºæ¢°çç½ååæ¼æ¥ãè¿ç§ç»¼è¿°ï¼åçäººçè¦ï¼ççäººæ´çè¦ãå®ä¸æ¯ç¥è¯çç»æ¶ï¼èæ¯ä¿¡æ¯çç¢å±ã</p>
<p>å¨è¿ä¸ªæ¶ä»£ï¼<strong>âè¯»å¾åå¤åå¿«âå·²ç»ä¸åæ¯æ ¸å¿ç«äºåï¼âæ·å¾åååç âææ¯ã</strong></p>
<p>ä»å¤©ï¼æè¦åäº«ä¸æ¡ç»è¿æ·±åº¦è°è¯ç<strong>ãæç®ç»¼è¿°AIçææä»¤ã</strong>ãå®ä¸æ¯å¸®ä½ âå·æâçä»£åå·¥å·ï¼èæ¯ä¸ä¸ªè£å¤ç²¾è¯ç<strong>âå­¦æ¯æ·éé²â</strong>ãå®è½å¸®ä½ ä»æµ·éæ²ç ¾ä¸­ï¼ç­åºçæ­£çéå­ï¼å¹¶çç¼æå®ç¾çé¥°åã</p>
<p><img alt="æç»âæ¼åâï¼ç¨AIæä»¤åå­¦æ¯æç®æµ·çâæ·éå®¢â" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3695776/202601/3695776-20260113193638991-2044083882.png" class="lazyload"></p>
<h2 id="ï¸-ä»æ¬è¿å·¥è¿åä¸ºé´èµå®¶">âï¸ ä»âæ¬è¿å·¥âè¿åä¸ºâé´èµå®¶â</h2>
<p>å¾å¤äººç¨AIåç»¼è¿°ï¼åªæå®å½æä¸ä¸ªæç´¢å¼æï¼âå¸®ææ¾æ¾å³äºXçæç®âã</p>
<p>è¿ç®ç´æ¯å¤§æå°ç¨ãAIçæ­£çå¼ºé¡¹ï¼å¨äº<strong>æ¨¡å¼è¯å«</strong>å<strong>é»è¾éæ</strong>ã</p>
<p>ä¸ç¯é«æ°´å¹³çæç®ç»¼è¿°ï¼å¿é¡»å·å¤<strong>âä¸æ§â</strong>ï¼</p>
<ol>
<li><strong>ç³»ç»æ§</strong>ï¼çå°æ£®æï¼èä¸åªæ¯æ æ¨ï¼</li>
<li><strong>æ¹å¤æ§</strong>ï¼æ¢äºè¯ä»·ï¼èä¸åªæ¯å¤è¿°ï¼</li>
<li><strong>æ¼è¿æ§</strong>ï¼çå°æ²³æµçæµåï¼èä¸åªæ¯æ°´æ»´ï¼</li>
</ol>
<p>ä¸ºæ­¤ï¼æè®¾è®¡äºè¿æ¡æä»¤ãå®ä¸ä»è¦æ± AI æ»ç»æç®ï¼æ´è¦æ±å®åä¸ä½<strong>ä¸¥èçå®¡ç¨¿äºº</strong>ï¼å»å®¡è§ãå»æ¹å¤ãå»æå»ºçè®ºæ¡æ¶ã</p>
<h3 id="-å¤å¶è¿æ¡æä»¤é¢åä½ çæ·éè£å¤">ð å¤å¶è¿æ¡æä»¤ï¼é¢åä½ çâæ·éè£å¤â</h3>
<p>è¿æ¡æä»¤çæ ¸å¿é»è¾æ¯<strong>âç»æåæ¹å¤â</strong>ãå®å¼ºå¶ AI å¿é¡»æç§<strong>âå¼è¨-åç¨-æ¡æ¶-è¯è¿°-å±æâ</strong>çå­¦æ¯æ åæµç¨è¿è¡è¾åºï¼å¹¶ä¸æç¡®è¦æ±è¿è¡<strong>æ¹å¤æ§åæ</strong>ã</p>
<p>æ è®ºä½ æ¯æ­£å¨ä¸ºå¼é¢æ¥åçæç®ç»¼è¿°å¤´ç§ï¼è¿æ¯éè¦ä¸ºè®ºæå¿«éæ¢³çç ç©¶ç°ç¶ï¼è¿æ¡æä»¤é½è½è®©ä½ äºåååã</p>
<pre><code class="language-markdown"># è§è²å®ä¹
ä½ æ¯ä¸ä½èµæ·±çå­¦æ¯ç ç©¶é¡¾é®ï¼æ¥æè·¨å­¦ç§çç ç©¶èæ¯åä¸°å¯çæç®ç»¼è¿°æ°åç»éªãä½ ç²¾éç³»ç»æ§æç®æ£ç´¢æ¹æ³ãæç®æ¹å¤æ§åææå·§ï¼æé¿è¯å«ç ç©¶é¢åçåå±èç»ãçè®ºæ¼è¿ååæ²¿è¶å¿ãä½ è½å¤å¸®å©ç ç©¶èæå»ºé»è¾æ¸æ°ãè®ºè¯ä¸¥å¯çæç®ç»¼è¿°æ¡æ¶ã

# ä»»å¡æè¿°
è¯·éå¯¹ææä¾çç ç©¶ä¸»é¢ï¼å¸®å©æå®ææç®ç»¼è¿°çæ°åå·¥ä½ãå·ä½åæ¬ï¼æ¢³çè¯¥é¢åçç ç©¶åå±åç¨ãå½çº³ä¸»è¦çè®ºè§ç¹åç ç©¶æµæ´¾ãåæç°æç ç©¶çä¸è¶³ä¸ç©ºç½ãä¸ºåç»­ç ç©¶æææ¹åã

**è¾å¥ä¿¡æ¯**:
- **ç ç©¶ä¸»é¢/é¢å**: [è¯·å¡«åä½ çç ç©¶ä¸»é¢]
- **ç ç©¶é®é¢**: [ä½ å¸æéè¿æç®ç»¼è¿°åç­çæ ¸å¿é®é¢]
- **æç®èå´**: [æ¶é´èå´ãå­¦ç§é¢åãæç®ç±»åç­éå®æ¡ä»¶]
- **ç»¼è¿°ç®ç**: [å­¦ä½è®ºæ/æååè¡¨/é¡¹ç®ç³æ¥/å¶ä»]
- **å­æ°è¦æ±**: [é¢æå­æ°èå´]
- **å·²ææç®**: [å¯éï¼ååºä½ å·²æ¶éçæ ¸å¿æç®]

# è¾åºè¦æ±

## 1. åå®¹ç»æ
è¯·æç§ä»¥ä¸ç»æç»ç»æç®ç»¼è¿°ï¼

- **å¼è¨é¨å**: éè¿°ç»¼è¿°çèæ¯æä¹ãç ç©¶é®é¢ãç»¼è¿°èå´ä¸æ¹æ³
- **ç ç©¶åç¨**: æ¢³çè¯¥é¢åçåå±é¶æ®µåéè¦éç¨ç¢
- **çè®ºæ¡æ¶**: å½çº³ä¸»è¦çè®ºè§è§ååææ¡æ¶
- **ç ç©¶ä¸»é¢åç±»**: æä¸»é¢/æ¹æ³/è§ç¹å¯¹æç®è¿è¡åç±»è¯è¿°
- **ç ç©¶è¿°è¯**: æ¹å¤æ§åæç°æç ç©¶çè´¡ç®ä¸ä¸è¶³
- **ç ç©¶å±æ**: æåºç ç©¶ç©ºç½åæªæ¥æ¹å
- **å°ç»**: æ»ç»æ ¸å¿åç°ï¼å¼åºç ç©¶é®é¢

## 2. è´¨éæ å
- **ç³»ç»æ§**: æç®è¦çå¨é¢ï¼ä¸éæ¼éè¦ç ç©¶ææ
- **æ¹å¤æ§**: ä¸ä»æè¿°æç®ï¼æ´è¦åæè¯ä»·
- **é»è¾æ§**: åé¨åä¹é´é»è¾è¿è´¯ï¼å±æ¬¡åæ
- **åæ²¿æ§**: å³æ³¨è¿5å¹´ææ°ç ç©¶è¿å±
- **å­¦æ¯æ§**: ç¬¦åå­¦æ¯åä½è§èï¼å¼ç¨è§è

## 3. æ ¼å¼è¦æ±
- ä½¿ç¨å­¦æ¯è®ºæçè§èæ ¼å¼
- æä¸»é¢ææ¶é´çº¿ç»ç»åå®¹
- æ¯ä¸ªä¸»è¦è§ç¹éææç®æ¯æ
- ä½¿ç¨è¿æ¸¡å¥è¿æ¥åé¨å
- æä¾åèæç®åè¡¨ï¼æå¼ç¨æ ¼å¼è¦æ±ï¼

## 4. é£æ ¼çº¦æ
- **è¯­è¨é£æ ¼**: å­¦æ¯æ­£å¼ãå®¢è§ä¸¥è°¨
- **è¡¨è¾¾æ¹å¼**: ç¬¬ä¸äººç§°å®¢è§åè¿°
- **ä¸ä¸ç¨åº¦**: æ·±å¥ä¸ä¸ï¼ä½ç°å­¦æ¯æ·±åº¦
- **å¼ç¨æ¹å¼**: éç¨ä½è-å¹´ä»½å¶ææ°å­æ æ³¨å¶

# è´¨éæ£æ¥æ¸å

å¨å®æè¾åºåï¼è¯·èªææ£æ¥ï¼
- [ ] æ¯å¦æ¶µçäºè¯¥é¢åçç»å¸æç®åææ°ç ç©¶
- [ ] æç®åç±»æ¯å¦åçï¼é»è¾æ¯å¦æ¸æ°
- [ ] æ¯å¦è¿è¡äºæ¹å¤æ§åæèéç®åç½å
- [ ] æ¯å¦æç¡®æåºäºç ç©¶ç©ºç½åæªæ¥æ¹å
- [ ] è¯­è¨è¡¨è¾¾æ¯å¦ç¬¦åå­¦æ¯è§è
- [ ] åé¨åä¹é´çè¿æ¸¡æ¯å¦èªç¶æµç
- [ ] æ¯å¦ååºäºæåæåºçç ç©¶é®é¢

# æ³¨æäºé¡¹
- é¿åç®åå ç æç®ï¼è¦æåæåç»¼å
- æ³¨ææç®å¼ç¨çåç¡®æ§åè§èæ§
- ä¿æå®¢è§ä¸­ç«ï¼é¿åä¸»è§èæ­
- å³æ³¨ä¸åè§ç¹ä¹é´çå¯¹è¯åäºè®º
- çªåºç ç©¶é¢åçåå±èç»åæ¼è¿è¶å¿

# è¾åºæ ¼å¼
è¯·ä»¥å­¦æ¯è®ºæçæ ¼å¼è¾åºå®æ´çæç®ç»¼è¿°ï¼åå«æ¸æ°çç« èæ é¢ãè§èçæ®µè½ç»æåå®æ´çåèæç®åè¡¨ã
</code></pre>
<h2 id="-å®ææ¼ç»å½ç»ç»é§æ§éå°ai">ð å®ææ¼ç»ï¼å½âç»ç»é§æ§âéå°AI</h2>
<p>ä¸ºäºéªè¯è¿æâé²å­âå¥½ä¸å¥½ç¨ï¼æä»¬è¾å¥ä¸ä¸ªç®¡çå­¦é¢åçç­é¨è¯é¢ï¼<strong>âç»ç»é§æ§â</strong>ã</p>
<p>è¿éå¸¸æ¯ä¸ä¸ªå®¹æåå¾å¾æ£çæ¦å¿µãä½ AI å¨æä»¤çå¼å¯¼ä¸ï¼è¾åºäºä¸ä»½æå·<strong>ç»æç¾æ</strong>çåç­ï¼</p>
<blockquote>
<p><strong>AI è¾åºçæ®µï¼èéï¼</strong>ï¼</p>
<p><strong>2. ç»ç»é§æ§æ¦å¿µçæ¼è¿ä¸è¾¨æ</strong></p>
<p><strong>2.2 ç»ç»é§æ§çå®ä¹æ¼å</strong></p>
<table>
<thead>
<tr>
<th>å­¦è</th>
<th>å¹´ä»½</th>
<th>å®ä¹</th>
<th>æ ¸å¿ç»´åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>Weick</td>
<td>1993</td>
<td>ä»æå¤ä¸­æ¢å¤çè½å</td>
<td>æ¢å¤å¯¼å</td>
</tr>
<tr>
<td>Sutcliffe &amp; Vogus</td>
<td>2003</td>
<td>ä»éå¢ä¸­ç§¯æè°æ´</td>
<td>éåºå¯¼å</td>
</tr>
</tbody>
</table>
<p><strong>3. ç»ç»é§æ§ççè®ºè§è§</strong><br>
<strong>3.1 èµæºåºç¡è§</strong><br>
ä»RBVè§è§ï¼ç»ç»é§æ§è¢«è§ä¸ºä¸ç§ç¨ç¼ºãæä»·å¼çç»ç»è½å...</p>
<p><strong>3.2 å¨æè½åçè®º</strong><br>
Teeceçå¨æè½åæ¡æ¶ä¸ºçè§£ç»ç»é§æ§çå½¢ææä¾äºéè¦è§è§...</p>
</blockquote>
<p>æ³¨æå°äºåï¼å®æ²¡æåçº¯å°ç½åâææè¯´äºä»ä¹âï¼èæ¯ï¼</p>
<ol>
<li><strong>å»ºç«äºç»´åº¦</strong>ï¼å°æ··ä¹±çå®ä¹ååä¸ºâæ¢å¤å¯¼åâåâéåºå¯¼åâã</li>
<li><strong>å¼å¥äºè§è§</strong>ï¼ç¨âèµæºåºç¡è§âåâå¨æè½åçè®ºâè¿äºæççè®ºæ¥æ¯æè®ºè¿°ã</li>
</ol>
<p>è¿å°±æ¯<strong>âæ·±åº¦å å·¥â</strong>ãå®æåææåæäºåæåï¼ä½ åªéè¦åå ä¸ç¹èªå·±çæ´è§ï¼å°±æ¯ä¸éå¤§é¤ã</p>
<h2 id="-å«è¢«ä¿¡æ¯æ·¹æ²¡åé£ä¸ªæèµçäºº">ð å«è¢«ä¿¡æ¯æ·¹æ²¡ï¼åé£ä¸ªæèµçäºº</h2>
<p>å¨å­¦æ¯ç ç©¶çæµ·æ´éï¼æå¯æçä¸æ¯é£æµªï¼èæ¯<strong>è¿·å¤±æ¹å</strong>ã</p>
<p>è¿å¥æä»¤ï¼æ¬è´¨ä¸æ¯ä¸ä¸ª<strong>âå¯¼èªä»ªâ</strong>ãå®ä¸è½ä»£æ¿ä½ æèï¼ä½å®è½å¸®ä½ å¿«éæ«æ¸è¿·é¾ï¼çæ¸èªéã</p>
<p>å½ä½ ä¸åéè¦ä¸ºâè¿æ®µè¯è¯¥æä¹è¿å°ä¸æ®µè¯âèåææ¶ï¼ä½ å®è´µçèåå°±å¯ä»¥éæ¾åºæ¥ï¼å»æèé£äºçæ­£éè¦çé®é¢ï¼<strong>è¿ä¸ªç°è±¡èåçåºå±é»è¾å°åºæ¯ä»ä¹ï¼</strong></p>
<p>ä»ä»å¤©å¼å§ï¼å«ååé£ä¸ªå¨æµ·æ»©ä¸æ¡è´å£³çäººäºãæ¿èµ·è¿æâæ·éé²âï¼å»ææå±äºä½ çå­¦æ¯å®èå§ã</p>
<p><strong>Copy æä»¤ -&gt; æ¿æ¢ä¸»é¢ -&gt; å¼å¯æ·±åº¦ç ç©¶ã</strong></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 19:37">2026-01-13 19:37</span>&nbsp;
<a href="https://www.cnblogs.com/huizhudev">realhuizhu</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479049);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479049', targetLink: 'https://www.cnblogs.com/huizhudev/p/19479049', title: 'æç»âæ¼åâï¼ç¨AIæä»¤åå­¦æ¯æç®æµ·çâæ·éå®¢â' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ AIå¦ä½å³å®æ¨èè°ï¼GEOåºå±é»è¾ä¸ä¼åç­ç¥ ]]></title>
    <link>https://www.cnblogs.com/aidso/p/19479017</link>
    <guid>bbab8158de69a32d7b3e581cf4989bd3</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/aidso/p/19479017" title="åå¸äº 2026-01-13 19:17">
    <span role="heading" aria-level="2">AIå¦ä½å³å®æ¨èè°ï¼GEOåºå±é»è¾ä¸ä¼åç­ç¥</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ¬æç«è¶³ AI æç´¢æ¶ä»£çæµéæ°è¶å¿ï¼æåºçè§£ AI æ¨èé»è¾æ¯åå¥½ GEO ä¼åçæ ¸å¿åæãæç« æ·±å¥è§£è¯»äº Profound æ¥åç âä¸é¶æ®µå³ç­æ¨¡åâ ä¸ç¾å½ä¸åå¤§å­¦ 2025 å¹´æåºç âå®é¨äººåè§â ä¸¤å¤§çè®ºï¼æ­ç¤ºåº AI ä¼æ âæå¾çè§£ â æ£ç´¢è¯ä¼° â ç­æ¡çæâ çæµç¨ç­éåå®¹ï¼ä¸æ´éçæå¨ãç»æåçä¿¡æ¯æºãç»åå¤´é¨ 3C åçå B2B ä¼ä¸çå®è·µæ¡ä¾ï¼æç« è¯¦è§£äº GEO ä¼åçåä¸æ­¥å³é®å¨ä½ï¼å©ç¨ AIDSO ç±æçæµåçå¨å­å¤§ AI å¹³å°çè¡¨ç°ç°ç¶ãåæ AI å¼ç¨æºä»¥æç¡®ä¼å£å¿ãä»è¯­ä¹ãç»æãå¤æºéªè¯å±é¢ä¼ååå®¹ï¼ä»¥æ­¤å¸®å©åçéé AI å³ç­é»è¾ï¼æåå¨ AI é®ç­ä¸­çæ¨èæéã
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><strong>æè¦</strong>ï¼çè§£AIçæ¨èé»è¾æ¯åå¥½GEOçåæãæ¬ææ·±åº¦è§£æProfoundæ¥åæåºç"ä¸é¶æ®µå³ç­æ¨¡å"åç¾å½ä¸åå¤§å­¦2025å¹´åè¡¨çç ç©¶æåºç"å®é¨äººåè§"ï¼æ­ç¤ºAIå¦ä½ç­éåå¼ç¨åå®¹ãéè¿æå¤´é¨3CåçåB2Bä¼ä¸ççå®æ¡ä¾ï¼è¯¦è§£GEOä¼åçåä¸ä¸ªå³é®æ­¥éª¤ï¼çæµåçç°ç¶ãåæå¼ç¨æºãä¼ååå®¹ç»æãAIDSOç±æçå­å¤§å¹³å°çæµä¸å¼ç¨æºç©¿éè½åï¼å¸®ä½ ç²¾åè¯å«ä¼åç­æ¿ã</p>
<p><img alt="AIå¦ä½å³å®æ¨èè°ï¼GEOåºå±é»è¾ä¸ä¼åç­ç¥" data-src="https://img2024.cnblogs.com/blog/3750837/202601/3750837-20260113185825109-1759118008.png" class="lazyload"></p>
<hr>
<h2 class="heading-2 ace-line old-record-id-LHEPdcOWooisQ5xW6uecsyNqnec">å¼ç¯ï¼çè§£AIç"å¤§è"</h2>
<p>å¦æä½ å·²ç»è¯»å®äºä¸ä¸ç¯<a href="https://www.cnblogs.com/aidso/p/19478968">ãGEOæ¯ä»ä¹ï¼AIæç´¢æ¶ä»£çæµéæ°è§åã</a>ï¼ä½ åºè¯¥æç½äºä¸ä¸ªéçï¼æµéå¥å£æ­£å¨ä»æç´¢å¼æè½¬åAIé®ç­ç³»ç»ãä½æ¥ä¸æ¥æ´å³é®çé®é¢æ¯ï¼<strong>AIå°åºæ¯æä¹å³å®æ¨èè°çï¼</strong></p>
<p>ä¸ºä»ä¹åæ ·æ¯åGEOä¼åï¼æçåç3å¨å°±è½æä¸ºAIçé¦éæ¨èï¼èæçåçæå¥å ä¸ªæå´æ¯«æ èµ·è²ï¼ç­æ¡å°±èå¨AIç"å³ç­é»è¾"éãçè§£äºè¿å¥é»è¾ï¼ä½ å°±ææ¡äºGEOçé¥åï¼ä¸çè§£ï¼ä½ çä¼åå¯è½åªæ¯å¨æµªè´¹èµæºã</p>
<hr>
<h2 class="heading-2 ace-line old-record-id-QClid7YkFocGnMx7z3VcvkACnzI">AIæ¨èçä¸ä¸ªå³ç­é¶æ®µ</h2>
<p>å½ç¨æ·åè±åãDeepSeekæChatGPTæé®æ¶ï¼AIä¸æ¯ç®åå°"æç´¢å³é®è¯+ååºç»æ"ï¼èæ¯ç»åäºä¸ä¸ªå¤æç"çè§£âæ£ç´¢âå¤æ­âçæ"çæºè½è¿ç¨ãæ ¹æ®Profoundåå¸çãAEOæå¨æåã(Profound AEO Authoritative Guide)æåºç"ä¸é¶æ®µå³ç­æ¨¡å"(Three-Stage Decision Model, Profoundæ¥åæåº)ï¼è¿ä¸ªè¿ç¨å¯ä»¥æè§£ä¸ºä¸ä¸ªé¶æ®µã</p>
<h3 class="heading-3 ace-line old-record-id-XQHUd5ndbodPnzxaC4Ock5Ain5d">ç¬¬ä¸é¶æ®µï¼æå¾çè§£</h3>
<p>AIä¸æ¯æºæ¢°å°å¹éå³é®è¯ï¼èæ¯è¦åçè§£ç¨æ·ççå®æå¾ã</p>
<p>ä¸¾ä¸ªä¾å­ï¼å½ç¨æ·é®"åäº¬æåªäºé è°±çGEOæå¡å"æ¶ï¼AIä¼è§£æåºï¼</p>
<ul class="list-bullet1 list-paddingleft-2">
<li>
<p>å°ååå¥½ï¼åäº¬ï¼å¯è½å¸æçº¿ä¸è§é¢ï¼</p>
</li>
<li>
<p>éæ±ç±»åï¼æå¡éè´­ï¼ä¸æ¯äºè§£æ¦å¿µï¼</p>
</li>
<li>
<p>éå«æ åï¼é è°±=æå£ç¢+ææ¡ä¾+æèµè´¨</p>
</li>
</ul>
<p>è¿ä¸é¶æ®µçå³é®æ¯<strong>è¯­ä¹çè§£è½å</strong>ãAIä¼ä¼åæ¨èé£äº"è¯­ä¹æ¸æ°ãç»æå®æ´"çåå®¹æºãå¦æä½ çåå®¹è¡¨è¾¾æ¨¡ç³ãé»è¾è·³è·ï¼AIå¯è½æ ¹æ¬çè§£ä¸äºä½ å¨è¯´ä»ä¹ã</p>
<h3 class="heading-3 ace-line old-record-id-Va0idjWUYoz9h3xWZqecbwEdnlg">ç¬¬äºé¶æ®µï¼ä¿¡æ¯æ£ç´¢ä¸å¯ä¿¡åº¦è¯ä¼°</h3>
<p>AIä»æµ·éåå®¹ä¸­æ£ç´¢ç¸å³ä¿¡æ¯ï¼ä½ä¸æ¯ææä¿¡æ¯é½ä¼è¢«éçº³ãAIä¼è¯ä¼°ï¼</p>
<ul class="list-bullet1 list-paddingleft-2">
<li>
<p><strong>æ¥æºæå¨æ§</strong>ï¼å®ç½ &gt; ç¥ååªä½ &gt; ä¸ªäººåå®¢</p>
</li>
<li>
<p><strong>ç»æåç¨åº¦</strong>ï¼æSchemaæ è®°çåå®¹ &gt; çº¯ææ¬</p>
</li>
<li>
<p><strong>ä¿¡æ¯ä¸è´æ§</strong>ï¼å¤ä¸ªæ¥æºè¯´æ³ä¸è´ &gt; åä¸æ¥æº</p>
</li>
<li>
<p><strong>æ¶ææ§</strong>ï¼ææ°æ´æ°çåå®¹ &gt; è¿æ¶ä¿¡æ¯</p>
</li>
</ul>
<p>è¿ä¸é¶æ®µå³å®äº"è°è½è¿å¥åéæ± "ãå¦æä½ çåå®¹åªå­å¨äºå®ç½ï¼æ²¡æä»»ä½å¤é¨éªè¯ï¼å¦åªä½æ¥éãç¨æ·è¯ä»·ï¼ï¼AIä¼è®¤ä¸ºè¿äºä¿¡æ¯"å¯ä¿¡åº¦ä¸è¶³"ï¼ä»èéä½å¼ç¨æéã</p>
<h3 class="heading-3 ace-line old-record-id-PuYyd6gkWoQWOgxIcqncRtGDnB5">ç¬¬ä¸é¶æ®µï¼ç­æ¡çæä¸ç»ç»</h3>
<p>AIæ ¹æ®æ£ç´¢å°çä¿¡æ¯ï¼çæä¸ä¸ªè¿è´¯ãåç¡®ãææ·±åº¦çç­æ¡ãå¨è¿ä¸ªè¿ç¨ä¸­ï¼AIä¼ä¼åå¼ç¨é£äº"é»è¾æ¸æ°ãæ°æ®ä¸°å¯ãè¡¨è¾¾ä¸ä¸"çåå®¹æºï¼å¹¶å¨ç­æ¡ä¸­æ æ³¨åºå¤ã</p>
<p>è¿ä¸ä¸ªé¶æ®µç¯ç¯ç¸æ£ï¼ä»»ä½ä¸ä¸ªç¯èçç¼ºå¤±é½å¯è½å¯¼è´ä½ çåç"åºå±"ãGEOçæ¬è´¨ï¼å°±æ¯å¨æ¯ä¸ªé¶æ®µé½ç»AIæä¾"æä¼è§£"ã</p>
<p><strong>çå®æ¡ä¾</strong>ï¼æå¤´é¨3Cåçççæµæ°æ®æ¾ç¤ºï¼è½ç¶åçæ´ä½æåçè¶è¿95%ï¼ä½å¨ä¸åå¹³å°çè¡¨ç°å·®å¼å·¨å¤§ââå¨æå¹³å°çæåçä»ä¸º80%å·¦å³ï¼å¦ä¸å¹³å°çæ­£é¢ææå¾åä»60%å·¦å³ãè¿ç§å¹³å°çº§å·®å¼ï¼å¦æä¸éè¿ç³»ç»åçæµï¼å ä¹æ æ³åç°ãAIDSOç±æéè¿å¯¹è±åãDeepSeekãè¾è®¯åå®ãæå¿ä¸è¨ãéä¹åé®ãKimiå­å¤§ä¸»æµAIå¹³å°çå¨è¦ççæµï¼è½å¤å¸®å©åçç²¾åè¯å«æ¯ä¸ªå¹³å°çè¡¨ç°ç­æ¿ï¼ä»èå¶å®å·®å¼åçä¼åç­ç¥ã</p>
<hr>
<h2 class="heading-2 ace-line old-record-id-ZEz5dfe74ov2EKx7t3KctneOnDh">AIç"å®é¨äºº"åè§æ¯ä»ä¹ï¼</h2>
<p>ç¾å½ä¸åå¤§å­¦2025å¹´åè¡¨çç ç©¶ãAIæç´¢ç³»ç»çæ°é»å¼ç¨æ¨¡å¼ã(News Source Citing Patterns in AI Search Systems, ç¾å½ä¸åå¤§å­¦ç ç©¶æåº)æåºäº"å®é¨äºº"ç°è±¡çæ¦å¿µãè¿æçæ¯AIå¨çæç­æ¡æ¶ï¼ä¼å¾åäºå¼ç¨é«æå¨ãç»æåãæäºè§£æçæ°æ®æºï¼èå¿½ç¥é£äº"åå®¹ä¼è´¨ä½è¡¨è¾¾å¤æ"çä¿¡æ¯ã</p>
<p>è¿ç§åè§å¹¶éAIç"bug"ï¼èæ¯å¶è®¾è®¡é»è¾çå¿ç¶ç»æââAIéè¦å¨æ¯«ç§çº§å®ææ£ç´¢åçæï¼å æ­¤ä¼ä¼åéæ©"ä½ææ¬ãé«ç¡®å®æ§"çä¿¡æ¯æºãå·ä½è¡¨ç°ä¸ºï¼<strong>AIæ´å¾åäºå¼ç¨ç¥åæºæçç ç©¶æ¥å &gt; è¡ä¸åªä½çæ·±åº¦æç«  &gt; ä¼ä¸å®ç½çç»æååå®¹ &gt; ä¸ªäººåå®¢çè§ç¹æç« </strong>ã</p>
<p>å³ä½¿ä½ çåå®¹è´¨éæ´é«ï¼ä½å¦æç¼ºä¹æå¨èä¹¦ãç»æåæ è®°æå¤æºéªè¯ï¼AIä¹å¯è½"çä¸è§"ä½ ãæ´å±é©çæ¯ï¼ä¸æ¦AIå½¢æäºå¯¹æä¸ªåçç"è®¤ç¥å®å¿"ï¼å¦"åçA=è¡ä¸ä¸å®¶"ï¼ï¼åæ¥èå¾é¾éè¿åçº¯çåå®¹ä¼åæ¹åè¿ä¸è®¤ç¥ã</p>
<p>è¿æå³çä»ä¹ï¼GEOä¸ä»æ¯åå®¹ä¼åï¼æ´æ¯"è®¤ç¥å·¥ç¨"ãä½ éè¦å¨AIç"å®é¨äºº"æºå¶ä¸­ï¼å»ºç«èªå·±çæå¨æ è¯ï¼å¹¶éè¿å¤æ¸ éãå¤å½¢å¼çåå®¹å¸å±ï¼è®©AIæ æ³å¿½è§ä½ çå­å¨ã</p>
<hr>
<h2 class="heading-2 ace-line old-record-id-VcqZdN9l6okenrxrC2mcSvOGnTc">GEOä¼åçå­ä¸ªå³é®æ­¥éª¤</h2>
<p>çè§£äºAIçå³ç­é»è¾åï¼ä¸ä¸ä¸ªé®é¢æ¯ï¼å·ä½è¯¥æä¹åï¼åºäºå¯¹AIæ¨èæºå¶çæ·±åº¦ç ç©¶ï¼æä»¬æ»ç»åºä¸å¥ç³»ç»åçGEOæ§è¡è·¯å¾ãè¿ä¸ç¯åè®²åä¸æ­¥ï¼çæµãåæãä¼åï¼ï¼åä¸æ­¥ï¼å¸å±ãè¿­ä»£ãè½¬åï¼å°å¨ä¸ä¸ç¯è¯¦ç»å±å¼ã</p>
<h3 class="heading-3 ace-line old-record-id-J0BwdrVcooPL88xnauFcPDttnRb">ç¬¬ä¸æ­¥ï¼çæµåçç°ç¶</h3>
<p><strong>ä¸ºä»ä¹çæµæ¯ç¬¬ä¸æ­¥ï¼</strong></p>
<p>å¾ç®åï¼ä¸ç¥éç°ç¶ï¼å°±æ æ³ä¼åãå°±åæ²»çéè¦åä½æ£ä¸æ ·ï¼GEOçç¬¬ä¸æ­¥æ¯"ç»åçåAIå¥åº·æ£æ¥"ã</p>
<p><strong>å·ä½çæµä»ä¹ï¼</strong></p>
<ol class="list-number1 list-paddingleft-2">
<li>
<p><strong>åçæåç</strong>ï¼å¨AIçåç­ä¸­ï¼ä½ è¢«æå°çé¢çæå¤é«ï¼</p>
</li>
<li>
<p><strong>å¹³åæåæå</strong>ï¼å½AIæ¨èå¤ä¸ªåçæ¶ï¼ä½ éå¸¸æç¬¬å ï¼</p>
</li>
<li>
<p><strong>å¼ç¨æ¥æº</strong>ï¼AIæ¯ä»åªäºç½ç«ãæç« å¼ç¨çä½ çä¿¡æ¯ï¼</p>
</li>
<li>
<p><strong>ææå¾å</strong>ï¼AIå¯¹ä½ çè¯ä»·æ¯æ­£é¢ãä¸­æ§è¿æ¯è´é¢ï¼</p>
</li>
</ol>
<p><strong>å¦ä½çæµï¼</strong></p>
<p>æå¨æµè¯çé®é¢å¨äºï¼ä½ åªè½æµè¯æéçå ä¸ªé®é¢ï¼èä¸æ æ³è¿½è¸ªåå²ååãæ´ç§å­¦çæ¹å¼æ¯ä½¿ç¨ä¸ä¸çGEOçæµå·¥å·ãAIDSOç±æéè¿å¯¹å­å¤§ä¸»æµAIå¹³å°çå¨è¦ççæµï¼è½å¤ç³»ç»åå°æµè¯å¤ä¸ªé®é¢åºæ¯ï¼éåä½ çåçè¡¨ç°ï¼å¹¶çæå¯è§åçè¯æ­æ¥åã</p>
<h3 class="heading-3 ace-line old-record-id-YvuPdsOYZosT4nxcCp6cWW3DnUg">ç¬¬äºæ­¥ï¼åæAIçå¼ç¨æº</h3>
<p><strong>ä¸ºä»ä¹å¼ç¨æºå¦æ­¤éè¦ï¼</strong></p>
<p>å ä¸º<strong>AIå¼ç¨è°ï¼å°±ä¿¡ä»»è°</strong>ãå¦æAIå¨åç­ä¸­å¼ç¨çé½æ¯ä½ ç«åçåå®¹ï¼é£ç¨æ·èªç¶ä¼å¾åäºéæ©ç«åã</p>
<p><strong>å¦ä½åæå¼ç¨æºï¼</strong></p>
<p>å½ä½ éè¿çæµåç°"AIå¾å°æå°ä½ "æ"AIå¯¹ä½ çè¯ä»·ä¸å¤å¥½"æ¶ï¼ä¸ä¸æ­¥å°±æ¯çï¼AIå°åºå¼ç¨äºåªäºåå®¹ï¼è¿äºåå®¹æ¥èªåªäºç½ç«ãæç« ãæ¦åï¼</p>
<p>æB2Bä¼ä¸æå¡åçå¨åæå¼ç¨æºæ¶åç°ï¼ç«åè¢«é¢ç¹å¼ç¨çåå®¹ä¸»è¦æ¥èªï¼</p>
<ul class="list-bullet1 list-paddingleft-2">
<li>
<p>ç¥ä¹çæ·±åº¦è¯æµæç« ï¼å æ¯40%ä»¥ä¸ï¼</p>
</li>
<li>
<p>è¡ä¸åªä½çä¸è®¿æ¥éï¼å æ¯30%å·¦å³ï¼</p>
</li>
<li>
<p>ç¬¬ä¸æ¹æè¡æ¦ï¼å æ¯20%å·¦å³ï¼</p>
</li>
</ul>
<p>åºäºè¿ä¸ªåç°ï¼è¯¥åçè°æ´äºåå®¹ç­ç¥ï¼éç¹å¨ç¥ä¹åå¸ç³»åè¯æµæç« ï¼åæ¶äºåè¡ä¸åªä½çæ¥éæºä¼ã3ä¸ªæåï¼åçæåçä»ä¸è¶³15%æåè³65%ä»¥ä¸ã</p>
<p><strong>AIDSOç±æçå¼ç¨æºç©¿éè½å</strong>ï¼è½å¤å¸®ä½ è¯å«AIå¼ç¨äºåªäºç½ç«åæç« ï¼è®©ä½ æ¸æ¥å°çå°ï¼ç«åçåå®¹ä¼å¿å¨åªéï¼ä½ çåå®¹ç¼ºå£å¨åªéã</p>
<h3 class="heading-3 ace-line old-record-id-MwLPdLe3loPO6lxH6YHcbXD6nzw">ç¬¬ä¸æ­¥ï¼ä¼ååå®¹ç»æ</h3>
<p>çè§£äºAIçåå¥½åï¼ä¸ä¸æ­¥å°±æ¯ä¼åä½ çåå®¹ï¼è®©å®æ´å®¹æè¢«AIçè§£åå¼ç¨ã</p>
<p><strong>ä¸ºä»ä¹ç»æåè¿ä¹éè¦ï¼</strong></p>
<p>AIä¸æ¯äººï¼å®æ æ³"è¯»æ"å¤æçè¡æé»è¾åä¿®è¾ææ³ãAIéè¦çæ¯"æè¯»ãæè§£æ"çåå®¹ãå°±åç»å°å­¦çè®²è¯¾ï¼ä½ å¿é¡»ç¨ç®åæ¸æ°çè¯­è¨ï¼èä¸æ¯é¿ç¯å¤§è®ºã</p>
<p><strong>ä¸ä¸ªä¼åæ¹åï¼</strong></p>
<p><strong>æ¹å1ï¼è¯­ä¹æ¸æ°</strong></p>
<p>ä¸è¦ç»å¼¯å­ï¼ç´æ¥è¯´éç¹ãä¾å¦ï¼</p>
<ul class="list-bullet1 list-paddingleft-2">
<li>
<p>â&nbsp;&nbsp;"æä»¬å¬å¸è´åäºä¸ºå®¢æ·æä¾å¨æ¹ä½ãä¸ç«å¼çæºè½åè§£å³æ¹æ¡..."</p>
</li>
<li>
<p>â&nbsp;&nbsp;"æä»¬æ¯ä¸å®¶ä¸æ³¨ä¼ä¸æ°å­åè½¬åçB2B SaaSæå¡åï¼ä¸»è¦äº§ååæ¬..."</p>
</li>
</ul>
<p><strong>æ¹å2ï¼ç»æåæ è®°</strong></p>
<p>ç»åå®¹å ä¸"æ ç­¾"ï¼è®©AIä¸ç¼å°±è½è¯å«éç¹ãå¸¸ç¨çæ¹æ³åæ¬ï¼</p>
<ul class="list-bullet1 list-paddingleft-2">
<li>
<p>å¨å®ç½æ·»å Schemaæ è®°ï¼ç»ç»ä¿¡æ¯ãäº§åä¿¡æ¯ãè¯ä»·ä¿¡æ¯ï¼</p>
</li>
<li>
<p>ä½¿ç¨FAQç»æï¼é®é¢-ç­æ¡å¯¹ï¼</p>
</li>
<li>
<p>ç¨è¡¨æ ¼ãåè¡¨åç°å³é®ä¿¡æ¯</p>
</li>
</ul>
<p><strong>æ¹å3ï¼å¤æºéªè¯</strong></p>
<p>ä¸è¦åªå¨å®ç½èªè¯´èªè¯ï¼è¦è®©"å«äººä¹è¿ä¹è¯´"ãAIæ´ä¿¡ä»»é£äº"å¤å¤å°è¯"çä¿¡æ¯ãå·ä½åæ³ï¼</p>
<ul class="list-bullet1 list-paddingleft-2">
<li>
<p>å®ç½ï¼åå¸æå¨åå®¹ï¼ç½ç®ä¹¦ãæ¡ä¾ç ç©¶ï¼</p>
</li>
<li>
<p>åªä½ï¼äºåè¡ä¸åªä½çæ¥éåéè®¿</p>
</li>
<li>
<p>ç¨æ·ï¼å¼å¯¼å®¢æ·å¨ç¥ä¹ãå°çº¢ä¹¦ç­å¹³å°åäº«ä½¿ç¨ä½éª</p>
</li>
</ul>
<p><strong>å¿«éè¡å¨å»ºè®®</strong>ï¼å¦æä¸ç¥éä»åªéå¼å§ï¼åä»ä¼åå®ç½çFAQæ¨¡åå¥æãæç¨æ·å¸¸é®ç10-20ä¸ªé®é¢ï¼ç¨æ åç"é®é¢-ç­æ¡"æ ¼å¼æ´çåºæ¥ï¼è¿æ¯AIæå®¹ææååå¼ç¨çåå®¹å½¢å¼ã</p>
<hr>
<h2 class="heading-2 ace-line old-record-id-DMlOdoQXroKZ3lxO7LHcQBGUnVb">æ»ç»ï¼ææ¡AIé»è¾ï¼å°±ææ¡äºGEOçé¥å</h2>
<p>çè§£äºAIçä¸é¶æ®µå³ç­æ¨¡ååå®é¨äººåè§ï¼ä½ å°±æç½äºï¼GEOä¸æ¯é "å å³é®è¯"æ"åå¤§éåå®¹"å°±è½æåçãå®éè¦ä½ çæ­£çè§£AIç"æèæ¹å¼"ï¼å¹¶éå¯¹æ§å°ä¼åæ¯ä¸ä¸ªç¯èã</p>
<p><strong>æ ¸å¿è¦ç¹åé¡¾</strong>ï¼</p>
<ul class="list-bullet1 list-paddingleft-2">
<li>
<p>AIæ¨èåä¸æ­¥ï¼çè§£æå¾ â æ£ç´¢è¯ä¼° â çæç­æ¡</p>
</li>
<li>
<p>AIå­å¨"å®é¨äººåè§"ï¼ä¼åå¼ç¨æå¨ãç»æåãæè§£æçåå®¹</p>
</li>
<li>
<p>GEOä¼åçåä¸æ­¥ï¼çæµç°ç¶ â åæå¼ç¨æº â ä¼åç»æ</p>
</li>
</ul>
<p>çè§£äºåçï¼ä¸ä¸æ­¥å°±æ¯è¯ä¼°ï¼ä½ çä¸å¡æ¯å¦éåç«å³å¯å¨GEOï¼éè¦æå¥å¤å°èµæºï¼å¦ä½å¿«éè§æï¼</p>
<p><strong>ç«å³è¡å¨</strong>ï¼è®¿é®<a href="http://www.aidso.com/" rel="noopener nofollow">www.aidso.com</a>æ³¨åAIDSOç±æï¼è¾å¥ä½ çåçä¿¡æ¯ï¼3åéè·åä½ å¨å­å¤§AIå¹³å°çå®æ´è¡¨ç°æ°æ®åå¼ç¨æºåæï¼ççAIæ¯ä»åªäºåå®¹è®¤è¯ä½ çï¼åªäºå¹³å°æ¯ä½ çç­æ¿ã</p>
<p><strong>ä¸ä¸ç¯é¢å</strong>ï¼<a href="https://www.cnblogs.com/aidso/p/19479017" target="_blank">ãå¦ä½å¼å§GEOï¼è¯ä¼°ãå·¥å·ä¸è¡å¨æåã</a>å°ä¸ºä½ æä¾å®æ´çèªæµæ¸åãé¢ç®åèå5æ­¥å¯å¨è®¡åï¼ç¡®ä¿ä½ çç¬¬ä¸æ­¥ç¨³å¥ææã</p>
<hr>
<h2 class="heading-2 ace-line old-record-id-FYtOdx7mMoWRnMx0RD3cIgg7noh">åèèµæ</h2>
<ol class="list-number1 list-paddingleft-2">
<li>
<p>ä¸­å½åå¡å¹¿ååä¼AIè¥éåºç¨å·¥ä½å§åä¼ãæç¥ç§æéå¢.ã2025å¹´ä¸­å½GEOè¡ä¸åå±æ¥åã. 2025å¹´10æ.</p>
</li>
<li>
<p>Profound.<em>Answer Engine Optimization: The Definitive Guide and Playbook for LLM Visibility</em>ï¼ç­æ¡å¼æä¼åï¼LLMå¯è§æ§æå¨æåä¸å®ææåï¼. 2025.</p>
</li>
<li>
<p>Northeastern University.&nbsp;<em>News Source Citing Patterns in AI Search Systems</em>&nbsp;ï¼AIæç´¢ç³»ç»çæ°é»å¼ç¨æ¨¡å¼ç ç©¶ï¼. arXiv 2507.05301v1. 2025å¹´7æ.</p>
</li>
</ol>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.027777777777777776" data-date-updated="2026-01-13 19:57">2026-01-13 19:17</span>&nbsp;
<a href="https://www.cnblogs.com/aidso">AIDSOç±æ</a>&nbsp;
éè¯»(<span id="post_view_count">6</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479017);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479017', targetLink: 'https://www.cnblogs.com/aidso/p/19479017', title: 'AIå¦ä½å³å®æ¨èè°ï¼GEOåºå±é»è¾ä¸ä¼åç­ç¥' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ç½å¯çæéåå½±å¾è¾Xçè¯ç ]]></title>
    <link>https://www.cnblogs.com/lixingqiu/p/19477584</link>
    <guid>d6187cfc15285f786af030a7ccb92999</guid>
    <description>
    <![CDATA[ 
	<h1 class="postTitle"><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/lixingqiu/p/19477584" title="åå¸äº 2026-01-13 15:05">
    <span role="heading" aria-level="2">ç½å¯çæéåå½±å¾è¾Xçè¯ç</span>
    

</a>
</h1>
	<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>è¿ä¸å¤©ï¼ä¸ºäºå¯»æ¾çµæï¼ç½å¯ (rocket) éªç°å°äºé£å¹èä½ç°çç¾çå¤§èåãä»å¨ "ä¸è±¡å¤§æ¨¡å" çå¸®å©ä¸ï¼æ­£å¨å±å¼æ ç©·çæ³åå.....</p>
<p>çªç¶ï¼ç½å¯æ³ï¼ç¨ 10 è¡ä»¥å C++ ä»£ç è½ç»åºä»ä¹å³ç®ååæè³çå¾æ¡ï¼&nbsp;</p>
<div>æå¯(ç½å¯çæµç§°)å¸­å°èåï¼æå°è½»è½»æ²å»çéèº«æºå¸¦çä¾¿æºç¼ç¨ç»ç«¯ï¼èæµ·éæ»¡æ¯æµ©çå¤ªç©ºçææ²³ä¸æäºãä½ä¸ºç´è¿·äºå¤ªç©ºé¨æ¸¸åé«ç§æåä½çå°å¹´ï¼ä»æ»ç±æå¤ªç©ºéçè§é»è½¬åä¸ºC++ ä»£ç ä½åï¼èä»å¤©ï¼ä»æ³åä¸ä¸ªè½ä»£è¡¨æéå¯¼èªçæç®æ è¯ã&nbsp;</div>
<div>&nbsp;</div>
<div>âæ¢ç¶é»è®¤è§è²æ¯å°ç«ç®­ï¼é£æå°±ä»¥èªå·±çåå­ârocketâæ¥å®ä¹è¿ä¸ªç»å¾è§è²å§ãâ æå¯ç¬çæ²ä¸<code>Sprite rocket;</code>ï¼ç»è¿ä¸ªèæè§è²èµäºäºåèªå·±ä¸æ ·ç âçµé­âãä»é¦åæ³å°äºå¤ªç©ºçæ·±éï¼äºæ¯ç¨<code>rocket.bgcolor("black")</code>å°ç»å¸è°æäºå®å®è¬ççº¯é»èæ¯ï¼åæç»ç¬ç²ç»è®¾ä¸º 50ï¼<code>pensize(50)</code>è½è®©ç»å¶çå¾æ¡æ´éç®ï¼å°±åå¤ªç©ºä¸­çå·¨åå¯¼èªç¯å¡ï¼åå°ç»å¾éåº¦è°è³ 0ï¼åªä¸ºç²¾åæ§å¶æ¯ä¸ç¬çè½¨è¿¹ã</div>
<div>&nbsp;</div>
<div>ä¸ºäºç»åºå¯¹ç§°åæä»ªå¼æçå¾æ¡ï¼æå¯æç»ç¬çè²ç¸è°ä¸º0ï¼å³çº¢è²ï¼ç¶å rocket è§è²å·¦è½¬ 45 åº¦ï¼æ¬ç¬åé 200 æ­¥æ¾åèµ·å§ä½ç½®ï¼åè½ç¬åå¤ç»å¶ã</div>
<div>
<div class="cnblogs_code">
<pre>rocket.pencolor(<span style="color: rgba(128, 0, 128, 1)">0</span>).lt(<span style="color: rgba(128, 0, 128, 1)">45</span>).pu().bk(<span style="color: rgba(128, 0, 128, 1)">200</span>).pd();</pre>
</div>
<p>âæ¥ä¸æ¥ï¼è¯¥ç»è¿ä¸ªå¾æ¡å ä¸å¤ªç©ºæåçæ¸åè´¨æäºãâ æå¯ç¼çä¸äº®ï¼åä¸äºç¬¬ä¸ä¸ªå¾ªç¯ï¼ç¨<code>penshade(i)</code>è®©ç»ç¬é¢è²éçå¾ªç¯éå¸§åæ·±ï¼å°±åææä»å¾®åå°çç¨ççç§è¿ç¨ï¼æ¯åè¿ 1 æ­¥å°±å»¶æ¶ 0.01 ç§ï¼<code>wait(0.01)</code>è½è®©æ¸åæææ´ç»è»ï¼èç¼æ¸æ°å¯è§åå½±çæµè½¬ï¼è¿æ¯ä»ä»å¤ªç©ºè§æµä¸­å¾å°ççµæ ââ å®å®ä¸­çåå½±ååï¼ä»æ¥é½ä¸æ¯ä¸è¹´èå°±çã&nbsp;</p>
</div>
<div>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">for</span>(<span style="color: rgba(0, 0, 255, 1)">int</span> i=<span style="color: rgba(128, 0, 128, 1)">0</span>;i&lt;<span style="color: rgba(128, 0, 128, 1)">400</span>;i++<span style="color: rgba(0, 0, 0, 1)">)
     </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">è®¾å®ç»ç¬é¢è²çæ·±æµåº¦</span>
     rocket.penshade(i).fd(<span style="color: rgba(128, 0, 128, 1)">1</span>).wait(<span style="color: rgba(128, 0, 128, 1)">0.01</span>);</pre>
</div>
<p>ç¬¬ä¸éåè½¨ç»å¶å®æï¼åä¸éç©¿éé»æçæéå°çº¿ãæå¯æ²¡æåä¸ï¼ä»è®©è§è²æ¬ç¬åéå¤ä½ï¼å·¦è½¬ 90 åº¦ååé 200 æ­¥ï¼æ¾åäºå¦ä¸éè½¨çº¿çèµ·å§ç¹ï¼ååä¸äºä¸æ®µä¸æ¨¡ä¸æ ·çå¾ªç¯ãè¿ä¸æ¬¡ï¼ç»ç¬ä¾æ§éçå¾ªç¯æ¸åææï¼å°±åå¤ªç©ºä¸­å¦ä¸éå¯¹åºçå¯¼èªå°çº¿ï¼ä¸ç¬¬ä¸éå½¢æå®ç¾çåå­å¤¹è§ï¼åæäºä»æ¾ç»å¨æ¨¡æå¤ªç©ºé¨æ¸¸æ¶çå°çæéåæ æ è®°ã</p>
</div>
<div>&nbsp;ççå±å¹ä¸ï¼çº¯é»èæ¯ä¸­ä¸¤éæ¸ååè½¨æ¢æ¢æåï¼ä»å¾®åå°æ·±éµï¼ç»è»åæè³ï¼æå¯çè¸ä¸é²åºäºæ»¡æçç¬å®¹ãä»æååä¸<code>rocket.hide().done();</code>ï¼è®©ç»å¾è§è²éèï¼å®æ ¼ä½è¿å¯å®ç¾çæéåå½±å¾è¾ã&nbsp;âè¿ä¸ä»ä»æ¯ä¸å¹ä»£ç å¾æ¡ï¼æ´æ¯ææªæ¥å¤ªç©ºé¨æ¸¸çå¯¼èªæ è®°åãâ æå¯ååèªè¯­ãè¿å¹ç¨å è¡ç®åC++ ä»£ç å®æçä½åï¼åå© C++ ç²¾çµåºçä¾¿æ·æä»¤ï¼æä»å¯¹å¤ªç©ºçç­ç±ãå¯¹é«ç§æçç´è¿·ï¼é½èè¿äºè¿ä¸¤éæ¸ååè½¨éã</div>
<div>&nbsp;</div>
<div>&nbsp;åæ¥ï¼è¿å¹æç®åæè³çå¾æ¡è¢«æå¯åæäºèªå·±å¤ªç©ºé¨æ¸¸æ¨¡æç¨åºçå¯å¨çé¢ï¼æ¯å½ä»æå¼ç¨åºï¼çå°è¿éåå­åå½±ï¼å°±ä¼æ³èµ·å¤§èåä¸é£ä¸ªçªåå¥æ³çååãèè¿ä¹è®©ä»æ´å åä¿¡ï¼ç¨ C++ ä»£ç ä¸ä»è½æé æè¶£çä½åï¼æ´è½æèªå·±é¨æ¸¸å¤ªç©ºçæ¢¦æ³ï¼ä¸ç¹ç¹åæè§¦æå¯åç âé«ç§æç°å®âãæ¥ä¸æ¥ï¼ä»åå¼å§ææï¼è½ä¸è½ç»è¿ä¸ªåå½±å¾è¾å ä¸å¨æéªçææï¼è®©å®æ´åå¤ªç©ºä¸­çæ­£çå¯¼èªç¯å¡å¢ï¼</div>
<div>&nbsp;</div>
<div><strong>ç½å¯çæéåå½±å¾è¾X</strong>çè¯çäºï¼ææä»£ç å¦ä¸æç¤ºï¼</div>
<div>
<div class="cnblogs_code">
<pre>#include <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">sprites.h</span><span style="color: rgba(128, 0, 0, 1)">"</span>  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">åå«C++ç²¾çµåº </span>
Sprite rocket;       <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">å»ºç«è§è²å«rocket </span>

<span style="color: rgba(0, 0, 255, 1)">int</span> main(){        <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">ä¸»åè½å </span>
   rocket.bgcolor(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">black</span><span style="color: rgba(128, 0, 0, 1)">"</span>).speed(<span style="color: rgba(128, 0, 128, 1)">0</span>).pensize(<span style="color: rgba(128, 0, 128, 1)">50</span><span style="color: rgba(0, 0, 0, 1)">);
   rocket.pencolor(</span><span style="color: rgba(128, 0, 128, 1)">0</span>).lt(<span style="color: rgba(128, 0, 128, 1)">45</span>).pu().bk(<span style="color: rgba(128, 0, 128, 1)">200</span><span style="color: rgba(0, 0, 0, 1)">).pd();
   </span><span style="color: rgba(0, 0, 255, 1)">for</span>(<span style="color: rgba(0, 0, 255, 1)">int</span> i=<span style="color: rgba(128, 0, 128, 1)">0</span>;i&lt;<span style="color: rgba(128, 0, 128, 1)">400</span>;i++<span style="color: rgba(0, 0, 0, 1)">)
     </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">è®¾å®ç»ç¬é¢è²çæ·±æµåº¦</span>
     rocket.penshade(i).fd(<span style="color: rgba(128, 0, 128, 1)">1</span>).wait(<span style="color: rgba(128, 0, 128, 1)">0.01</span><span style="color: rgba(0, 0, 0, 1)">);
   rocket.pu().bk(</span><span style="color: rgba(128, 0, 128, 1)">200</span>).lt(<span style="color: rgba(128, 0, 128, 1)">90</span>).bk(<span style="color: rgba(128, 0, 128, 1)">200</span><span style="color: rgba(0, 0, 0, 1)">).pd();
   
   </span><span style="color: rgba(0, 0, 255, 1)">for</span>(<span style="color: rgba(0, 0, 255, 1)">int</span> i=<span style="color: rgba(128, 0, 128, 1)">0</span>;i&lt;<span style="color: rgba(128, 0, 128, 1)">400</span>;i++<span style="color: rgba(0, 0, 0, 1)">)
     </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">è®¾å®ç»ç¬é¢è²çæ·±æµåº¦</span>
     rocket.penshade(i).fd(<span style="color: rgba(128, 0, 128, 1)">1</span>).wait(<span style="color: rgba(128, 0, 128, 1)">0.01</span><span style="color: rgba(0, 0, 0, 1)">);
   
   rocket.hide().done();  
   </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}</span></pre>
</div>
<p><img alt="bandicam 2026-01-12 21-29-28-601.mp4_20260113_114239.036" loading="lazy" data-src="https://img2024.cnblogs.com/blog/523461/202601/523461-20260113150102596-719958892.jpg" class="lazyload"></p>
<p>è§é¢å·²å½ï¼è¯·çå®ä»¬è½»ç§»æ­¥å°æ¬äººæé³pxcodingå»æ¾æ¾ã</p>
</div>
</div>
<div class="clear"></div>

	<div class="postDesc">posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 15:05">2026-01-13 15:05</span>&nbsp;
<a href="https://www.cnblogs.com/lixingqiu">æå´ç</a>&nbsp;
éè¯»(<span id="post_view_count">12</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19477584);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19477584', targetLink: 'https://www.cnblogs.com/lixingqiu/p/19477584', title: 'ç½å¯çæéåå½±å¾è¾Xçè¯ç' })">ä¸¾æ¥</a>
</div>
 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä¸åDjangoæå¡å¨åé¨ç½²æ¹å¼çæ§è½è°ç  ]]></title>
    <link>https://www.cnblogs.com/deali/p/19478389</link>
    <guid>beae971d978be01fae99abef2445736e</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/deali/p/19478389" title="åå¸äº 2026-01-13 17:10">
    <span role="heading" aria-level="2">ä¸åDjangoæå¡å¨åé¨ç½²æ¹å¼çæ§è½è°ç </span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="åè¨">åè¨</h2>
<p>æè¿æè±äºå¾å¤æ¶é´æè¾ DjangoStarterã</p>
<p>ä¸æ¬¡è¯´å°ææå¡å¨æ¢æäº <a href="https://blog.deali.cn/p/granian-django-asgi-server" target="_blank" rel="noopener nofollow">Rust å¼åç Granian</a></p>
<p>è½ç¶æ¯æ Nginx å®¹å¨å»æäºï¼æ¹ä¾¿äºï¼ä½æ§è½è¿æ¯ä¸å¤ªæ»¡æã</p>
<p>ç´¢æ§å¯¹å¤§é¨åè½ç¨çæå¡å¨æ¥æ¿æ¥æ¨ä¸ªå°è¯ï¼åæ¶å¯¹ä»£ç è¿è¡ä¼åã</p>
<p>ç»è¿è¿å å¤©ï¼è±è´¹å¤§éæ¶é´è¿è¡ç¯å¢éç½®ãä»£ç ä¿®æ¹ãæ§è½æµè¯ï¼æåææ»ç»åº DjangoStarter æ¡æ¶æ­éä¸åçæå¡å¨çæ§è½è¡¨ç°ã</p>
<blockquote>
<p>PSï¼ç°å¨ AI çæµè¡è®©å¤§é¨åä»ç»åºç¡çææ¯æç« å¤±å»äºæä¹ï¼æç°å¨åæç« ä¹åºæ¬æ¯å½æç¬è®°å¨ç¨äºï¼èä¸ä¹å°½éé¿ååå¾æ°´çåºç¡ä»ç»ï¼æä¹ä¸å¤§ð</p>
</blockquote>
<p>å¤§å®¶ä¸ç±ççä»£ç åè¯¦ç»æ°æ®é¨åææ¾å¨åºä¸ã</p>
<h2 id="æµè¯ç¯å¢">æµè¯ç¯å¢</h2>
<p>æ¬æ¬¡æµè¯çé¡¹ç®é¨ç½²å¨è¾è®¯äº2C2Gçå°æ°´ç®¡æå¡å¨ä¸ï¼æè§æå¡å¨æ§è½ä¸¥éæç´¯äºåºç¨æ§è½ååð¤£</p>
<p>èä¸æè¿åç°ä¸ä¸ªäºæï¼è¾è®¯äºä¼¼ä¹å·å·æ¸æ¸å¨é«å³°æï¼å¦ä¸åï¼ææå¡å¨æ§è½éä½ï¼ä¸åååæ¨æµè¯çç»ææå¾å¤§å·®å¼ã</p>
<p>æ¬æ¬¡åä¸æµè¯çwsgi/asgiæå¡å¨æ daphne, granian, gunicorn, uwsgi, uvicorn, hypercorn åºæ¬æ¶µçäº python çæçå¤§é¨åæå¡å¨äº~</p>
<p>æ¬æ¬¡ä½¿ç¨ wrk ä½ä¸ºæ§è½æµè¯åè½ï¼æææ¥å£é½ä½¿ç¨ <code>-t4 -c200 -d30s</code> çæµè¯åæ°ã</p>
<h2 id="æ§è½æµè¯ç»è®º">æ§è½æµè¯ç»è®º</h2>
<h3 id="rps-æå">RPS æå</h3>
<table>
<thead>
<tr>
<th>æå</th>
<th>server</th>
<th>req/sec</th>
<th>æ¥å£</th>
</tr>
</thead>
<tbody>
<tr>
<td>ð¥ 1</td>
<td><strong>uWSGI + WSGI</strong></td>
<td><strong>1206</strong></td>
<td>WSGI</td>
</tr>
<tr>
<td>ð¥ 2</td>
<td><strong>Gunicorn + WSGI</strong></td>
<td><strong>740</strong></td>
<td>WSGI</td>
</tr>
<tr>
<td>ð¥ 3</td>
<td>Granian + ASGI</td>
<td>220</td>
<td>ASGI</td>
</tr>
<tr>
<td>4</td>
<td>Daphne + ASGI</td>
<td>190</td>
<td>ASGI</td>
</tr>
<tr>
<td>5</td>
<td>Uvicorn + ASGI</td>
<td>181</td>
<td>ASGI</td>
</tr>
<tr>
<td>6</td>
<td>Hypercorn + ASGI</td>
<td>168</td>
<td>ASGI</td>
</tr>
</tbody>
</table>
<p><strong>ç»è®ºï¼</strong></p>
<ul>
<li>
<p>WSGI æ´ä½è¿å¿«äº ASGI</p>
<p>è¿æ¯é¢æç»æï¼Django çåé¨åçå°±æ¯ WSGIï¼åæ­¥è·¯ç±ä¸éè¦é¢å¤ç async è½¬æ¢ã</p>
</li>
<li>
<p>uWSGI åæ¬¡è¯æèªå·±æ¯ WSGI æ§è½ä¹ç</p>
<p>uWSGI ç C å®ç°ãæçç worker ç®¡çãåå­å©ç¨ä¼åé½è®©å®å¨çº¯ WSGI åºæ¯æ æã</p>
</li>
</ul>
<h3 id="åå­å ç¨å¯¹æ¯">åå­å ç¨å¯¹æ¯</h3>
<table>
<thead>
<tr>
<th>æå</th>
<th>server</th>
<th>åå­</th>
</tr>
</thead>
<tbody>
<tr>
<td>ð¥ 1</td>
<td><strong>uWSGI</strong></td>
<td><strong>58M</strong>ï¼æä½ï¼</td>
</tr>
<tr>
<td>2</td>
<td>Granian</td>
<td>170M</td>
</tr>
<tr>
<td>3</td>
<td>Daphne</td>
<td>175M</td>
</tr>
<tr>
<td>4</td>
<td>Hypercorn</td>
<td>300M</td>
</tr>
<tr>
<td>5</td>
<td>Gunicorn+WSGI</td>
<td>430M</td>
</tr>
<tr>
<td>6</td>
<td>Uvicorn</td>
<td>500Mï¼æé«ï¼</td>
</tr>
</tbody>
</table>
<p><strong>ç»è®º</strong>ï¼</p>
<ul>
<li>uWSGI ä¸ä»æå¿«ï¼è¿æçåå­</li>
<li>Uvicorn åå­æé«ï¼Python å worker overhead ææ¾ï¼</li>
<li>ASGI æå¡å¨æ®éåå­åé«æ¯æ­£å¸¸ç°è±¡</li>
</ul>
<h2 id="æ§è½æµè¯æ°æ®">æ§è½æµè¯æ°æ®</h2>
<p>ä»¥ä¸æ¯è¯¦ç»çæ§è½æµè¯æ°æ®ã</p>
<h3 id="daphne--asgi">daphne + asgi</h3>
<p>æµè¯æ¶åå­å³°å¼å ç¨175Må·¦å³</p>
<pre><code>$ wrk -t4 -c200 -d30s http://127.0.0.1:9875/api/django-starter/monitoring/health
Running 30s test @ http://127.0.0.1:9875/api/django-starter/monitoring/health
  4 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.03s   134.59ms   1.99s    89.71%
    Req/Sec    69.17     64.53   313.00     80.49%
  5737 requests in 30.04s, 2.14MB read
  Socket errors: connect 0, read 0, write 0, timeout 4
Requests/sec:    190.99
Transfer/sec:     72.93KB
</code></pre>
<h3 id="granian--asgi">granian + asgi</h3>
<p>æµè¯æ¶åå­å³°å¼å ç¨170Må·¦å³</p>
<pre><code>$ curl http://127.0.0wrk -t4 -c200 -d30s875/api/django-starter/monitoring/health
Running 30s test @ http://127.0.0.1:9875/api/django-starter/monitoring/health
  4 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   886.48ms   79.27ms   1.26s    85.40%
    Req/Sec    86.07    112.58   490.00     84.05%
  6637 requests in 30.04s, 2.72MB read
Requests/sec:    220.93
Transfer/sec:     92.56KB
</code></pre>
<h3 id="gunicorn--wsgi">gunicorn + wsgi</h3>
<p>æµè¯æ¶åå­å³°å¼å ç¨430Må·¦å³</p>
<pre><code>$ wrk -t4 -c200 -d30s http://127.0.0.1:9875/api/django-starter/monitoring/health
Running 30s test @ http://127.0.0.1:9875/api/django-starter/monitoring/health
  4 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   268.67ms   31.82ms 425.23ms   86.13%
    Req/Sec   187.47    119.54   494.00     56.66%
  22244 requests in 30.03s, 9.52MB read
Requests/sec:    740.60
Transfer/sec:    324.74KB
</code></pre>
<h3 id="uwsgi--wsgi">uwsgi + wsgi</h3>
<p>æµè¯æ¶åå­å³°å¼å ç¨58Må·¦å³</p>
<pre><code>$ wrk -t4 -c200 -d30s http://127.0.0.1:9875/api/django-starter/monitoring/health
Running 30s test @ http://127.0.0.1:9875/api/django-starter/monitoring/health
  4 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   199.52ms  277.85ms   1.97s    87.56%
    Req/Sec   302.89     88.84   575.00     67.33%
  36210 requests in 30.02s, 12.95MB read
  Socket errors: connect 0, read 36216, write 0, timeout 96
Requests/sec:   1206.08
Transfer/sec:    441.68KB
</code></pre>
<h3 id="uvicorn--asgi">uvicorn + asgi</h3>
<p>æµè¯æ¶åå­å³°å¼å ç¨500Må·¦å³</p>
<pre><code>$ wrk -t4 -c200 -d30s http://127.0.0.1:9875/api/django-starter/monitoring/health
Running 30s test @ http://127.0.0.1:9875/api/django-starter/monitoring/health
  4 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.00s   537.23ms   2.00s    59.81%
    Req/Sec    62.04     66.05   460.00     83.03%
  5440 requests in 30.04s, 2.23MB read
  Socket errors: connect 0, read 0, write 0, timeout 369
Requests/sec:    181.07
Transfer/sec:     76.05KB
</code></pre>
<h3 id="hypercorn--asgi">hypercorn + asgi</h3>
<p>æµè¯æ¶åå­å³°å¼å ç¨300Må·¦å³</p>
<pre><code>$ wrk -t4 -c200 -d30s http://127.0.0.1:9875/api/django-starter/monitoring/health
Running 30s test @ http://127.0.0.1:9875/api/django-starter/monitoring/health
  4 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   734.64ms  423.05ms   2.00s    51.70%
    Req/Sec    55.53     52.50   360.00     83.49%
  5064 requests in 30.06s, 2.09MB read
  Socket errors: connect 0, read 0, write 0, timeout 1124
Requests/sec:    168.45
Transfer/sec:     71.24KB
</code></pre>
<h3 id="æ´ç»åçæ§è½æµè¯">æ´ç»åçæ§è½æµè¯</h3>
<p>è®¿é®ä¸ä¸ªææ°æ®åºæ¥è¯¢çæ¥å£ <a href="http://127.0.0.1:9878/api/demo/movie/movie" target="_blank" rel="noopener nofollow">http://127.0.0.1:9878/api/demo/movie/movie</a></p>
<p>ç´æ¥ uwsgi</p>
<pre><code>$ wrk -t4 -c200 -d30s http://127.0.0.1:9875/api/demo/movie/movie
Running 30s test @ http://127.0.0.1:9875/api/demo/movie/movie
  4 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   501.93ms  260.82ms   1.99s    94.20%
    Req/Sec    61.02     39.11   191.00     62.02%
  6726 requests in 30.04s, 15.84MB read
  Socket errors: connect 0, read 6758, write 0, timeout 45
Requests/sec:    223.89
Transfer/sec:    539.82KB
</code></pre>
<p>ç»è¿ caddy åä»£</p>
<pre><code>$ wrk -t4 -c200 -d30s http://127.0.0.1:9878/api/demo/movie/movie
Running 30s test @ http://127.0.0.1:9878/api/demo/movie/movie
  4 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   562.46ms  166.56ms   1.65s    88.77%
    Req/Sec    52.66     21.07   150.00     65.63%
  6299 requests in 30.04s, 15.06MB read
  Socket errors: connect 0, read 0, write 0, timeout 208
  Non-2xx or 3xx responses: 40
Requests/sec:    209.69
Transfer/sec:    513.30KB
</code></pre>
<h2 id="ä»£ç ">ä»£ç </h2>
<p>æ¥ä»ç»ä¸ä»£ç çé¨åã</p>
<p>è¿æ¬¡æ¿æ¥è¿è¡æ§è½æµè¯çä¸»è¦æ¯å¥åº·æ£æ¥åä¸ä¸ªç®åçæ°æ®åºè®¿é®æ¥å£ãæææ¥å£é½æ¯ç¨ django-ninja å¼åçã</p>
<h3 id="æ°æ®åºè®¿é®æ¥å£">æ°æ®åºè®¿é®æ¥å£</h3>
<p>æ¶åå°æ°æ®åºçå°±æ¯è¿ä¸ªæ¥å£</p>
<p>æ¥è¯¢æ°æ®è¿å+åé¡µåè½ï¼éå¸¸ç®å</p>
<pre><code class="language-python">@router.get('/movie', response=List[MovieOut], url_name='demo/movie/list')
@paginate
def list_items(request):
    qs = Movie.objects.all()
    return qs
</code></pre>
<h3 id="å¥åº·æ£æ¥æ¥å£">å¥åº·æ£æ¥æ¥å£</h3>
<p>å¼å¥è¿äºpackage</p>
<pre><code class="language-python">import asyncio
from ninja import Router
from django.db import connections
from django.db.utils import OperationalError
from redis import Redis
from redis.exceptions import RedisError
from redis import asyncio as aioredis
import os
import time
import platform
import subprocess
import anyio
</code></pre>
<p>åççæ¥å£æ¯çº¯åæ­¥çï¼è¿è¦è°ç¨ä¸ä¸ªç³»ç»è¿ç¨å»è·å uptimeï¼è¿ä¸ªæä½ä¸¥éææ¢äºæ´ä¸ªæ¥å£çéåº¦ï¼æè¿æ¬¡éææåæ­¥åå¼æ­¥ä¸¤ç§æ¥å£ã</p>
<p>é¦åæ¯æç®åççæ¬ï¼è¿éé¢å°±å¥ä¹æ²¡æï¼åçº¯è¿å JSONã</p>
<pre><code class="language-python">@router.get('health')
def simple_health_check(request):
    """å¥åº·æ£æ¥ç«¯ç¹ï¼ç¨äºå®¹å¨å¥åº·æ£æ¥åçæ§"""
    response_data = {
        'status': 'healthy',
        'status_code': 200,
    }

    return response_data
</code></pre>
<h3 id="å¼æ­¥æ¥å£">å¼æ­¥æ¥å£</h3>
<p>åæ¥å¼æ­¥æ¥å£ã</p>
<p>å¶å®æå¾å°ç¨å° python çå¼æ­¥åè½ï¼å¯è½è¿ä¹å python å¯¹å¼æ­¥çæ¯ææ¯è¾å·®æå³ç³»ã</p>
<p>ååä¸¤ä¸ªå¼æ­¥æ¹æ³ï¼ç¨æ¥æ£æ¥æ°æ®åºåRedisè¿æ¥ã</p>
<pre><code class="language-python">async def check_db_async():
    """æ°æ®åºæ£æ¥ï¼åæ­¥ ORM â æ¾çº¿ç¨æ± ï¼"""
    try:
        def _check():
            for conn in connections.all():
                conn.cursor()
            return True

        return await anyio.to_thread.run_sync(_check)
    except OperationalError:
        return False


async def check_redis_async():
    """Redis å¼æ­¥æ£æ¥ï¼æ³¨æï¼ç¡®ä¿å³é­å®¢æ·ç«¯ä»¥éæ¾è¿æ¥æ± ï¼"""
    try:
        redis_client = aioredis.Redis(
            host="redis",
            port=6379,
            socket_connect_timeout=1,
            decode_responses=True,
        )
        try:
            ok = await redis_client.ping()
            return bool(ok)
        finally:
            # å³é­å®¢æ·ç«¯åè¿æ¥æ± ï¼é¿åè¿æ¥æ³é²ï¼å¨ç­çå½å¨æçå®¹å¨/è¯·æ±éå¾éè¦ï¼
            try:
                await redis_client.close()
            except Exception:
                pass
            try:
                await redis_client.connection_pool.disconnect()
            except Exception:
                pass
    except Exception:
        return False
</code></pre>
<p>Django ORM ä¸æ¯æå¼æ­¥ï¼æä»¥è¿éç¨ anyio è¿ä¸ªåæ¥ç®åä¸ä¸æä½ï¼æåæ­¥æä½åè£ä¸ä¸åè£æå¼æ­¥è¿è¡ãå®éä¸ç¨ asyncio è¿ä¸ªåºä¹è½åï¼ä¸è¿ anyio æ¹ä¾¿ä¸ç¹ã</p>
<p>å¨ç¨ aioredis æ¶ï¼è¿éæä¸ªåï¼æä¸å¼å§å®è£äº aioredis è¿ä¸ªåï¼ç»æåç°ååæç redis åå²çªäºã</p>
<p>æ¥çææ¡£æåç° <code>from redis import asyncio as aioredis</code> å°±å®äºå¿äºï¼redis åéå·²ç»èªå¸¦äºå¼æ­¥æ¯æã</p>
<p>æ¥çå®ç°å¼æ­¥æ¥å£</p>
<pre><code class="language-python">@router.get('health/async')
async def health_check_async(request):
    """Async æ¨¡å¼å¥åº·æ£æ¥ï¼ASGI ä¼åçï¼"""
    # ä½¿ç¨ asyncio.gather å¹¶åè¿è¡ DB å Redis æ£æ¥
    db_ok, redis_ok = await asyncio.gather(
        check_db_async(),
        check_redis_async(),
    )

    status = "healthy" if db_ok and redis_ok else "unhealthy"
    status_code = 200 if status == "healthy" else 503

    return {
        "status": status,
        "status_code": status_code,
        "checks": {
            "database": "ok" if db_ok else "error",
            "redis": "ok" if redis_ok else "error",
        },
        "system": get_system_info(),
    }
</code></pre>
<h3 id="åæ­¥æ¥å£">åæ­¥æ¥å£</h3>
<p>åæ­¥çå°±ç®åäº</p>
<pre><code class="language-py">@router.get('health/sync')
def health_check_sync(request):
    """åæ­¥çæ¬çå¥åº·æ£æ¥æ¥å£"""

    # --- æ£æ¥æ°æ®åº &amp; Redis ---
    db_ok = check_db_sync()
    redis_ok = check_redis_sync()

    # --- ç³»ç»ä¿¡æ¯ ---
    system_info = {
        "timestamp": time.time(),
        "uptime": get_uptime(),
        "hostname": os.environ.get("HOSTNAME", ""),
        "environment": os.environ.get("ENVIRONMENT", "development"),
        "os": platform.system(),
    }

    # --- ç¶æç  ---
    status = "healthy" if db_ok and redis_ok else "unhealthy"
    status_code = 200 if status == "healthy" else 503

    # --- è¿åæ°æ® ---
    return {
        "status": status,
        "status_code": status_code,
        "checks": {
            "database": "ok" if db_ok else "error",
            "redis": "ok" if redis_ok else "error",
        },
        "system": system_info,
    }
</code></pre>
<h2 id="å°ç»">å°ç»</h2>
<p>ä¼ ç»åºç¨æ èé uwsgi å°±å¯¹äºã</p>
<p>éè¦å¼æ­¥çå¯ä»¥æå¼æ­¥é£é¨ååå²åºæ¥ç¨ granian æè daphne è·ã</p>
<p>å½ç¶è¿ä¹å¢å äºå¤æåº¦ï¼ä½è¿æ¯å¯¹æ§è½ä¼åçæä½³æè¡¡ã</p>
<p>åè¿æ ·å§ï¼å¶å®è¿æ¬¡æ§è½è°ç è¿è®©æå­¦å°å¾å¤ï¼ä¸ä¸ç¯æç« ç»§ç»­åæè¿æ¬¡çæ¶è·ã</p>

</div>
<div id="MySignature" role="contentinfo">
    å¾®ä¿¡å¬ä¼å·ï¼ãç¨åºè®¾è®¡å®éªå®¤ã
ä¸æ³¨äºäºèç½ç­é¨æ°ææ¯æ¢ç´¢ä¸å¢éææ·å¼åå®è·µï¼åæ¬æ¶æè®¾è®¡ãæºå¨å­¦ä¹ ä¸æ°æ®åæç®æ³ãç§»å¨ç«¯å¼åãLinuxãWebååç«¯å¼åç­ï¼æ¬¢è¿ä¸èµ·æ¢è®¨ææ¯ï¼åäº«å­¦ä¹ å®è·µç»éªã
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 17:10">2026-01-13 17:10</span>&nbsp;
<a href="https://www.cnblogs.com/deali">ç¨åºè®¾è®¡å®éªå®¤</a>&nbsp;
éè¯»(<span id="post_view_count">15</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19478389);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19478389', targetLink: 'https://www.cnblogs.com/deali/p/19478389', title: 'ä¸åDjangoæå¡å¨åé¨ç½²æ¹å¼çæ§è½è°ç ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Pythonå¼æ­¥å®å¨æå ]]></title>
    <link>https://www.cnblogs.com/mykai/p/19476272</link>
    <guid>a0c510e3452402e8dcc6a81050bd14ae</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/mykai/p/19476272" title="åå¸äº 2026-01-13 16:31">
    <span role="heading" aria-level="2">Pythonå¼æ­¥å®å¨æå</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>Pythonä¸­å¹¶è¡å¤çå¤ä¸ªä»»å¡ä¸»è¦æ¯é ï¼</p>
<ul>
<li>thread çº¿ç¨</li>
<li>process è¿ç¨</li>
<li>asyncio éåæ­¥</li>
</ul>
<h3 id="process">process</h3>
<p>å°ä¸ä¸ªpy èæ¬æ¾å¥å°åå­ä¸­ï¼ç¨åºå°±åæäº ä¸ä¸ªprocess</p>
<blockquote>
<p>process æ¯ç¨åºè¿è¡çå®ä¾,process æèªå·±çåå­ï¼éä¿¡;ä¸åçprocessä¹é´å½¼æ­¤ç¬ç«</p>
</blockquote>
<p>process éå¸¸åä¸ºäºç§</p>
<ul>
<li>I/Oå¯éåï¼cpuä½¿ç¨çè¾ä½ï¼å¤§éæ¶é´å¨ç­å¾ç½ç»ï¼ç¨æ·è¾å¥è¾åº</li>
<li>CPU å¯éåï¼cpuä½¿ç¨çè¾é«ï¼å¨å¤§éè®¡ç®ï¼æ°æ®åæï¼è§é¢ç¼ç ç­</li>
</ul>
<h3 id="thread-çº¿ç¨">Thread çº¿ç¨</h3>
<blockquote>
<p>çº¿ç¨æ¯Processçæå°åä½ï¼æ¯ä¸ªProcess è³å°æä¸ä¸ªçº¿ç¨ï¼ä¸»çº¿ç¨ï¼ï¼çº¿ç¨å¨åä¸ä¸ªprocessåå±äº«èµæºï¼ä¸ä¸ªçº¿ç¨æä½ä¸å½ï¼ä¼å¯¼è´æ´ä¸ªprocess å´©æºã</p>
</blockquote>
<h3 id="cpu-æ§è¡process--threadçæºå¶">CPU æ§è¡process / threadçæºå¶</h3>
<p>CPU ä¸æ¬¡åªè½æ§è¡ä¸ä¸ªä»»å¡ï¼ä¸ºäºå¤çå¤ä¸ªä»»å¡ï¼æ¢å å¼åæ¢ä»»å¡ã</p>
<p>æ¢å å¼åæ¢:processä¿çå½åç¶æï¼å¼è¾æ°çåå­ç©ºé´ï¼å¢å æ¶èï¼å¨åä¸ä¸ªprocesséï¼thread å±äº«ç©ºé´ï¼æä»¥å¼éæ´å°ã</p>
<blockquote>
<p>å¯¹äºå¤æ ¸CPU ï¼æ¯ä¸ªæ ¸å¿é½è½å¤çä¸åçè¿ç¨ãèçäºå¤§éçåæ¢å¼éã</p>
</blockquote>
<h3 id="python-giléæºå¶">PYTHON GILéæºå¶</h3>
<p>å¨åä¸ä¸ªprocessåï¼GILæ¯ä¸ç§éï¼åè®¸ä»»ä½æ¶ååªæä¸ä¸ªçº¿ç¨æ§å¶ Python è§£éå¨ãå¨I/O ç­å¾åºæ¯ï¼ä¼éæ¾GITéã</p>
<blockquote>
<p>GIL çå­å¨æ¯ä¸ºäºè§£å³ç«æé®é¢ï¼é²æ­¢å¤ä¸ªçº¿ç¨å½¼æ­¤å¤§å®¶ã</p>
</blockquote>
<h3 id="asyncio--å¼æ­¥">asyncio  å¼æ­¥</h3>
<blockquote>
<p>asyncio ä½¿ç¨åä¸çº¿ç¨æ¥å¤çå¤ä¸ªä»»å¡ï¼é¿åäºå¤§éä¸ä¸æåæ¢å¸¦æ¥çå¼é</p>
</blockquote>
<ul>
<li>Coroutines ææ®éå½æ°å®ä¹ä¸ºåç¨å½æ° ä»£è¡¨è¯¥å½æ°å¯ä»¥æå/æ¢å¤</li>
<li>Event loop äºä»¶å¾ªç¯ï¼è´è´£ç®¡çæ§è¡Coroutines</li>
<li>Tasks åç¨å·ä½çå¯¹è±¡ éè¿asyncio.create_task()è°åº¦</li>
<li>await  æååç¨çæ§è¡</li>
</ul>
<blockquote>
<p>åç¨åå»ºä¹åï¼ä¸ä¼èªå¨è°ç¨ãasyncio.runï¼ï¼æ¥è¿è¡</p>
</blockquote>
<p><strong>éå</strong> éè¦å¤§éç­å¾çå°ä»»å¡åºæ¯</p>
<h5 id="asynciocreate_task">asyncio.create_task()</h5>
<p>è®©å½æ°ç«å³è¿å¥éåï¼ä¸æ¯ç«å³æ§è¡ï¼ç­å¾å¶ä»å½æ°äº¤åºæ§å¶æï¼create_task() è§£é¤ç­å¾å³ç³»ï¼æåç¨äº¤ç»äºä»¶å¾ªç¯ç®¡çï¼åªè¦å­å¨ await çè®©åºç¹ï¼å¤ä¸ªä»»å¡å°±å¯ä»¥äº¤åæ¨è¿</p>
<pre><code class="language-py">await a()
await b()

# äº¤å
ta = create_task(a())
tb = create_task(b())
await ta
await tb
</code></pre>
<h5 id="asyncioto_thread">asyncio.to_thread</h5>
<p>asyncio.to_thread è®©åæ­¥é»å¡ä»£ç å¨å¦ä¸ä¸ªçº¿ç¨è¿è¡ï¼ä»èä¿è¯äºä»¶å¾ªç¯çº¿ç¨ä¸è¢«é»å¡ã</p>
<pre><code>async def main():
    print("start")
    asyncio.create_task(
        asyncio.to_thread(fetch_data)
    )
    print("end")

</code></pre>
<table>
<thead>
<tr>
<th>åæ³</th>
<th>å½æ°ä½æ¶æ§è¡</th>
<th>å½ååç¨æ¯å¦ç»§ç»­</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>await to_thread()</code></td>
<td>ç«å³ï¼å¨çº¿ç¨ï¼</td>
<td>å¦ï¼ç­ç»æï¼</td>
</tr>
<tr>
<td><code>create_task(to_thread())</code></td>
<td>ç«å³ï¼å¨çº¿ç¨ï¼</td>
<td>æ¯</td>
</tr>
</tbody>
</table>
<h4 id="æ£æµå¤æ­">æ£æµå¤æ­</h4>
<p>ä½ å¨ async å½æ°éï¼è¦è°ç¨ä¸ä¸ªå½æ° F<br>
â<br>
ââ F æ¯ async åç¨å½æ°ï¼<br>
â   â<br>
â   ââ æ¯<br>
â   â   â<br>
â   â   ââ éè¦ç­ F çç»æï¼<br>
â   â   â   ââ æ¯ â await F()<br>
â   â   â   ââ å¦ â create_task(F())<br>
â   â   â<br>
â   â   ââï¼ç»æï¼<br>
â   â<br>
â   ââ å¦ï¼F æ¯åæ­¥é»å¡å½æ°ï¼<br>
â       â<br>
â       ââ éè¦ç­ F çç»æï¼<br>
â       â   ââ æ¯ â await asyncio.to_thread(F)<br>
â       â   ââ å¦ â create_task(asyncio.to_thread(F))<br>
â       â<br>
â       ââï¼ç»æï¼</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 16:31">2026-01-13 16:31</span>&nbsp;
<a href="https://www.cnblogs.com/mykai">MyKai</a>&nbsp;
éè¯»(<span id="post_view_count">52</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19476272);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19476272', targetLink: 'https://www.cnblogs.com/mykai/p/19476272', title: 'Pythonå¼æ­¥å®å¨æå' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Karmada-ResourceBinding (RB) ç»ä»¶è¯¦è§£ ]]></title>
    <link>https://www.cnblogs.com/Mephostopheles/p/19477095</link>
    <guid>35f97711bacce4e392555658e3c8c12f</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Mephostopheles/p/19477095" title="åå¸äº 2026-01-13 14:26">
    <span role="heading" aria-level="2">Karmada-ResourceBinding (RB) ç»ä»¶è¯¦è§£</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        ResourceBindingï¼RBï¼æ¯ Karmada ä¸­ç¨äºæè¿°èµæºå¦ä½å¨å¤ä¸ªæåéç¾¤ä¸­åå¸åè°åº¦çæ ¸å¿å¯¹è±¡ãæ¬æç»åæºç è¯¦ç»è§£é RB çå®æ´çå½å¨æåå·¥ä½åçã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="resourcebinding-rb-ç»ä»¶è¯¦è§£">ResourceBinding (RB) ç»ä»¶è¯¦è§£</h1>
<h2 id="æ¦è¿°">æ¦è¿°</h2>
<p>ResourceBindingï¼RBï¼æ¯ Karmada ä¸­ç¨äºæè¿°èµæºå¦ä½å¨å¤ä¸ªæåéç¾¤ä¸­åå¸åè°åº¦çæ ¸å¿å¯¹è±¡ãæ¬ææ¡£ç»åæºç è¯¦ç»è§£é RB çå®æ´çå½å¨æåå·¥ä½åçã</p>
<h2 id="é¶æ ¸å¿æ¦å¿µè¯¦è§£">é¶ãæ ¸å¿æ¦å¿µè¯¦è§£</h2>
<p>å¨æ·±å¥çè§£ RB çå·¥ä½åçä¹åï¼æä»¬éè¦åçè§£ Karmada ä¸­çå ä¸ªæ ¸å¿æ¦å¿µã</p>
<h3 id="01-propagationpolicyä¼ æ­ç­ç¥">0.1 PropagationPolicyï¼ä¼ æ­ç­ç¥ï¼</h3>
<p><strong>PropagationPolicy</strong> æ¯ Karmada ä¸­ç¨äºå®ä¹èµæºå¦ä½ä¼ æ­å°æåéç¾¤çç­ç¥å¯¹è±¡ãå®ç±»ä¼¼äº Kubernetes ä¸­ç ReplicaSetï¼ä½å®æ§å¶çæ¯èµæºå¨å¤ä¸ªéç¾¤é´çåå¸ï¼èä¸æ¯ Pod å¨èç¹é´çåå¸ã</p>
<h4 id="å®ä¹">å®ä¹</h4>
<pre><code class="language-52:59:pkg/apis/policy/v1alpha1/propagation_types.go">// PropagationPolicy represents the policy that propagates a group of resources to one or more clusters.
type PropagationPolicy struct {
	metav1.TypeMeta   `json:",inline"`
	metav1.ObjectMeta `json:"metadata,omitempty"`

	// Spec represents the desired behavior of PropagationPolicy.
	// +required
	Spec PropagationSpec `json:"spec"`
}
</code></pre>
<h4 id="propagationspec-ç»æ">PropagationSpec ç»æ</h4>
<pre><code class="language-61:220:pkg/apis/policy/v1alpha1/propagation_types.go">// PropagationSpec represents the desired behavior of PropagationPolicy.
type PropagationSpec struct {
	// ResourceSelectors used to select resources.
	// Nil or empty selector is not allowed and doesn't mean match all kinds
	// of resources for security concerns that sensitive resources(like Secret)
	// might be accidentally propagated.
	// +required
	// +kubebuilder:validation:MinItems=1
	ResourceSelectors []ResourceSelector `json:"resourceSelectors"`

	// Association tells if relevant resources should be selected automatically.
	// e.g. a ConfigMap referred by a Deployment.
	// default false.
	// Deprecated: in favor of PropagateDeps.
	// +optional
	Association bool `json:"association,omitempty"`

	// PropagateDeps tells if relevant resources should be propagated automatically.
	// Take 'Deployment' which referencing 'ConfigMap' and 'Secret' as an example, when 'propagateDeps' is 'true',
	// the referencing resources could be omitted(for saving config effort) from 'resourceSelectors' as they will be
	// propagated along with the Deployment. In addition to the propagating process, the referencing resources will be
	// migrated along with the Deployment in the fail-over scenario.
	//
	// Defaults to false.
	// +optional
	PropagateDeps bool `json:"propagateDeps,omitempty"`

	// Placement represents the rule for select clusters to propagate resources.
	// +optional
	Placement Placement `json:"placement,omitempty"`
</code></pre>
<p><strong>å³é®å­æ®µè¯´æ</strong>ï¼</p>
<ol>
<li>
<p><strong>ResourceSelectors</strong>: èµæºéæ©å¨ï¼ç¨äºéæ©åªäºèµæºéè¦ä¼ æ­</p>
<ul>
<li>å¯ä»¥éè¿ APIVersionãKindãNameãNamespaceãLabelSelector æ¥éæ©èµæº</li>
<li>è³å°éè¦ä¸ä¸ªéæ©å¨ï¼å®å¨èèï¼é²æ­¢ææèµæºè¢«æå¤ä¼ æ­ï¼</li>
</ul>
</li>
<li>
<p><strong>PropagateDeps</strong>: æ¯å¦èªå¨ä¼ æ­ä¾èµèµæº</p>
<ul>
<li>ä¾å¦ï¼Deployment å¼ç¨ç ConfigMap å Secret</li>
<li>è®¾ç½®ä¸º <code>true</code> æ¶ï¼å¯ä»¥çç¥è¿äºä¾èµèµæºçéæ©å¨ï¼å®ä»¬ä¼èªå¨ä¼ æ­</li>
</ul>
</li>
<li>
<p><strong>Placement</strong>: éç¾¤éæ©è§åï¼è¯¦è§ä¸æï¼</p>
</li>
<li>
<p><strong>Priority</strong>: ç­ç¥ä¼åçº§ï¼ç¨äºç­ç¥æ¢å ï¼</p>
</li>
<li>
<p><strong>Failover</strong>: æéè½¬ç§»è¡ä¸ºï¼è¯¦è§ä¸æï¼</p>
</li>
</ol>
<h4 id="resourceselector-ç»æ">ResourceSelector ç»æ</h4>
<pre><code class="language-222:246:pkg/apis/policy/v1alpha1/propagation_types.go">// ResourceSelector the resources will be selected.
type ResourceSelector struct {
	// APIVersion represents the API version of the target resources.
	// +required
	APIVersion string `json:"apiVersion"`

	// Kind represents the Kind of the target resources.
	// +required
	Kind string `json:"kind"`

	// Namespace of the target resource.
	// Default is empty, which means inherit from the parent object scope.
	// +optional
	Namespace string `json:"namespace,omitempty"`

	// Name of the target resource.
	// Default is empty, which means selecting all resources.
	// +optional
	Name string `json:"name,omitempty"`

	// A label query over a set of resources.
	// If name is not empty, labelSelector will be ignored.
	// +optional
	LabelSelector *metav1.LabelSelector `json:"labelSelector,omitempty"`
}
</code></pre>
<h4 id="clusterpropagationpolicy">ClusterPropagationPolicy</h4>
<p><strong>ClusterPropagationPolicy</strong> ä¸ PropagationPolicy åè½ç¸åï¼ä½ä½ç¨åæ¯éç¾¤çº§å«çï¼ç¨äºéç¾¤çº§å«çèµæºï¼å¦ ClusterRoleãClusterRoleBinding ç­ï¼ã</p>
<h3 id="02-placementæ¾ç½®è§å">0.2 Placementï¼æ¾ç½®è§åï¼</h3>
<p><strong>Placement</strong> å®ä¹äºèµæºåºè¯¥è¢«è°åº¦å°åªäºéç¾¤ï¼ä»¥åå¦ä½å¨è¿äºéç¾¤é´åéã</p>
<h4 id="å®ä¹-1">å®ä¹</h4>
<p>Placement åå«ä»¥ä¸ä¸»è¦å­æ®µï¼</p>
<ol>
<li><strong>ClusterAffinity</strong>: éç¾¤äº²åæ§ï¼é¦éåªäºéç¾¤ï¼</li>
<li><strong>ClusterTolerations</strong>: éç¾¤å®¹å¿åº¦ï¼å¯ä»¥è°åº¦å°åªäºéç¾¤ï¼</li>
<li><strong>SpreadConstraints</strong>: åæ£çº¦æï¼å¦ä½å¨ä¸åéç¾¤é´åéï¼</li>
<li><strong>ReplicaScheduling</strong>: å¯æ¬è°åº¦ç­ç¥ï¼å¯æ¬å¦ä½åéå°éç¾¤ï¼</li>
</ol>
<p><strong>ç¤ºä¾</strong>ï¼</p>
<ul>
<li><strong>Duplicated</strong>: ææéç¾¤é½è¿è¡ç¸åçå¯æ¬æ°ï¼å¦ ConfigMapãSecretï¼</li>
<li><strong>Divided</strong>: å¯æ¬ææ¯ä¾åéå°ä¸åéç¾¤ï¼å¦ Deploymentï¼</li>
</ul>
<h3 id="03-resourcebindingèµæºç»å®">0.3 ResourceBindingï¼èµæºç»å®ï¼</h3>
<p><strong>ResourceBindingï¼RBï¼</strong> æ¯ PropagationPolicy åèµæºå¯¹è±¡çç»å®ç»æãå®è®°å½äºï¼</p>
<ol>
<li><strong>èµæºå¼ç¨</strong>: æååå§èµæºå¯¹è±¡ï¼DeploymentãStatefulSet ç­ï¼</li>
<li><strong>å¯æ¬ä¿¡æ¯</strong>: ä»èµæºä¸­æåçå¯æ¬æ°åèµæºéæ±</li>
<li><strong>è°åº¦ç»æ</strong>: ç± Scheduler å¡«åçç®æ éç¾¤åè¡¨</li>
<li><strong>ç­ç¥ä¿¡æ¯</strong>: ä» PropagationPolicy å¤å¶çç­ç¥éç½®</li>
</ol>
<h4 id="resourcebinding-ä¸-propagationpolicy-çå³ç³»">ResourceBinding ä¸ PropagationPolicy çå³ç³»</h4>
<pre><code>ç¨æ·åå»º Deployment + PropagationPolicy
    â
ResourceDetector æ£æµå¹é
    â
åå»º ResourceBindingï¼ç»å® Deployment å PropagationPolicyï¼
    â
Scheduler å¡«å ResourceBinding.Spec.Clustersï¼è°åº¦ç»æï¼
</code></pre>
<p><strong>éè¦</strong>ï¼RB æ¯ç­ç¥åèµæºç<strong>ç»å®</strong>ï¼ä¸ä¸ªèµæºåªä¼è¢«ä¸ä¸ªç­ç¥ç»å®ï¼æä¼åçº§éæ©ï¼ã</p>
<h3 id="04-workå·¥ä½è´è½½">0.4 Workï¼å·¥ä½è´è½½ï¼</h3>
<p><strong>Work</strong> æ¯å®éè¢«åéå°æåéç¾¤çèµæºå¯¹è±¡ãä¸ä¸ª RB å¯ä»¥çæå¤ä¸ª Workï¼æ¯ä¸ªç®æ éç¾¤ä¸ä¸ªï¼ã</p>
<h4 id="å®ä¹-2">å®ä¹</h4>
<pre><code class="language-43:74:pkg/apis/work/v1alpha1/work_types.go">// Work defines a list of resources to be deployed on the member cluster.
type Work struct {
	metav1.TypeMeta   `json:",inline"`
	metav1.ObjectMeta `json:"metadata,omitempty"`

	// Spec represents the desired behavior of Work.
	Spec WorkSpec `json:"spec"`

	// Status represents the status of PropagationStatus.
	// +optional
	Status WorkStatus `json:"status,omitempty"`
}

// WorkSpec defines the desired state of Work.
type WorkSpec struct {
	// Workload represents the manifest workload to be deployed on managed cluster.
	Workload WorkloadTemplate `json:"workload,omitempty"`

	// SuspendDispatching controls whether dispatching should
	// be suspended, nil means not suspend.
	// Note: true means stop propagating to the corresponding member cluster, and
	// does not prevent status collection.
	// +optional
	SuspendDispatching *bool `json:"suspendDispatching,omitempty"`

	// PreserveResourcesOnDeletion controls whether resources should be preserved on the
	// member cluster when the Work object is deleted.
	// If set to true, resources will be preserved on the member cluster.
	// Default is false, which means resources will be deleted along with the Work object.
	// +optional
	PreserveResourcesOnDeletion *bool `json:"preserveResourcesOnDeletion,omitempty"`
}
</code></pre>
<h4 id="work-ä¸-resourcebinding-çå³ç³»">Work ä¸ ResourceBinding çå³ç³»</h4>
<pre><code>ResourceBinding (æ§å¶å¹³é¢)
    â è½¬æ¢ä¸º
Work (æ§è¡ç©ºé´: execution-{cluster-name})
    â ååå°
æåéç¾¤
    â æ§è¡
å®éèµæºï¼DeploymentãService ç­ï¼
</code></pre>
<p><strong>æ§è¡ç©ºé´ï¼Execution Spaceï¼</strong>ï¼æ¯ä¸ªæåéç¾¤é½æä¸ä¸ªå¯¹åºç namespaceï¼æ ¼å¼ä¸º <code>execution-{cluster-name}</code>ï¼ææåéå°è¯¥éç¾¤ç Work é½æ¾å¨è¿ä¸ª namespace ä¸­ã</p>
<h3 id="05-resourceinterpreterèµæºè§£éå¨">0.5 ResourceInterpreterï¼èµæºè§£éå¨ï¼</h3>
<p><strong>ResourceInterpreter</strong> æ¯ Karmada ä¸­ç¨äºè§£éèªå®ä¹èµæºçæ ¸å¿ç»ä»¶ãå®è½å¤çè§£ä¸åç§ç±»çèµæºï¼DeploymentãStatefulSetãèªå®ä¹ CRD ç­ï¼ï¼å¹¶æåå³é®ä¿¡æ¯ã</p>
<h4 id="ä½ç¨">ä½ç¨</h4>
<p>ResourceInterpreter æä¾ä»¥ä¸è½åï¼</p>
<ol>
<li><strong>GetReplicas</strong>: ä»èµæºä¸­æåå¯æ¬æ°åèµæºéæ±ï¼ç¨äº RB åå»ºæ¶çæ§è½ç¶é¢ç¹ï¼</li>
<li><strong>ReviseReplica</strong>: ä¿®æ¹èµæºçå¯æ¬æ°ï¼ç¨äºå°è°åº¦ç»æåºç¨å° Workï¼</li>
<li><strong>Retain</strong>: ä¿çéç¾¤ç¹å®çå­æ®µï¼é²æ­¢è¦çï¼</li>
<li><strong>AggregateStatus</strong>: èåå¤ä¸ªéç¾¤çç¶æ</li>
<li><strong>InterpretHealth</strong>: å¤æ­èµæºæ¯å¦å¥åº·</li>
<li><strong>GetDependencies</strong>: è·åä¾èµèµæº</li>
</ol>
<h4 id="å®ç°å±æ¬¡">å®ç°å±æ¬¡</h4>
<pre><code class="language-42:72:pkg/resourceinterpreter/interpreter.go">// ResourceInterpreter manages both default and customized webhooks to interpret custom resource structure.
type ResourceInterpreter interface {
	// Start initializes the resource interpreter and performs cache synchronization.
	Start(ctx context.Context) (err error)

	// HookEnabled tells if any hook exist for specific resource type and operation.
	HookEnabled(objGVK schema.GroupVersionKind, operationType configv1alpha1.InterpreterOperation) bool

	// GetReplicas returns the desired replicas of the object as well as the requirements of each replica.
	GetReplicas(object *unstructured.Unstructured) (replica int32, replicaRequires *workv1alpha2.ReplicaRequirements, err error)

	// ReviseReplica revises the replica of the given object.
	ReviseReplica(object *unstructured.Unstructured, replica int64) (*unstructured.Unstructured, error)

	// GetComponents extracts the resource requirements for multiple components from the given object.
	// This hook is designed for CRDs with multiple components (e.g., FlinkDeployment), but can
	// also be used for single-component resources like Deployment.
	// If implemented, the controller will use this hook to obtain per-component replica and resource
	// requirements, and will not call GetReplicas.
	// If not implemented, the controller will fall back to GetReplicas for backward compatibility.
	// This hook will only be called when the feature gate 'MultiplePodTemplatesScheduling' is enabled.
	GetComponents(object *unstructured.Unstructured) (components []workv1alpha2.Component, err error)

	// Retain returns the objects that based on the "desired" object but with values retained from the "observed" object.
	Retain(desired *unstructured.Unstructured, observed *unstructured.Unstructured) (retained *unstructured.Unstructured, err error)

	// AggregateStatus returns the objects that based on the 'object' but with status aggregated.
	AggregateStatus(object *unstructured.Unstructured, aggregatedStatusItems []workv1alpha2.AggregatedStatusItem) (*unstructured.Unstructured, error)

	// GetDependencies returns the dependent resources of the given object.
</code></pre>
<h4 id="è§£éå¨ç±»å">è§£éå¨ç±»å</h4>
<p>ResourceInterpreter æåç§å®ç°æ¹å¼ï¼æä¼åçº§ï¼ï¼</p>
<ol>
<li><strong>ConfigurableInterpreter</strong>ï¼æé«ä¼åçº§ï¼ï¼ä½¿ç¨ Lua èæ¬è¿è¡å£°æå¼éç½®</li>
<li><strong>CustomizedInterpreter</strong>ï¼ä½¿ç¨ Webhook è¿è¡èªå®ä¹</li>
<li><strong>ThirdPartyInterpreter</strong>ï¼ç¬¬ä¸æ¹åç½®çè§£éè§å</li>
<li><strong>DefaultInterpreter</strong>ï¼æä½ä¼åçº§ï¼ï¼Karmada åç½®çé»è®¤è§£éå¨</li>
</ol>
<p>è°ç¨é¡ºåºï¼</p>
<pre><code class="language-136:168:pkg/resourceinterpreter/interpreter.go">// GetReplicas returns the desired replicas of the object as well as the requirements of each replica.
func (i *customResourceInterpreterImpl) GetReplicas(object *unstructured.Unstructured) (replica int32, requires *workv1alpha2.ReplicaRequirements, err error) {
	var hookEnabled bool

	replica, requires, hookEnabled, err = i.configurableInterpreter.GetReplicas(object)
	if err != nil {
		return
	}
	if hookEnabled {
		return
	}

	replica, requires, hookEnabled, err = i.customizedInterpreter.GetReplicas(context.TODO(), &amp;request.Attributes{
		Operation: configv1alpha1.InterpreterOperationInterpretReplica,
		Object:    object,
	})
	if err != nil {
		return
	}
	if hookEnabled {
		return
	}
	replica, requires, hookEnabled, err = i.thirdpartyInterpreter.GetReplicas(object)
	if err != nil {
		return
	}
	if hookEnabled {
		return
	}

	replica, requires, err = i.defaultInterpreter.GetReplicas(object)
	return
}
</code></pre>
<h3 id="06-resourcedetectorèµæºæ£æµå¨">0.6 ResourceDetectorï¼èµæºæ£æµå¨ï¼</h3>
<p><strong>ResourceDetector</strong> æ¯ Karmada æ§å¶å¨çä¸é¨åï¼è´è´£ï¼</p>
<ol>
<li><strong>çå¬èµæºåå</strong>ï¼çå¬ Kubernetes èµæºï¼DeploymentãService ç­ï¼çåå»º/æ´æ°/å é¤</li>
<li><strong>å¹éç­ç¥</strong>ï¼ä¸ºèµæºæ¾å°å¹éç PropagationPolicy</li>
<li><strong>åå»º RB</strong>ï¼æ ¹æ®ç­ç¥åå»ºææ´æ° ResourceBinding</li>
<li><strong>ç­ç¥ç®¡ç</strong>ï¼å¤ç PropagationPolicy ççå½å¨æ</li>
</ol>
<h3 id="07-schedulerè°åº¦å¨">0.7 Schedulerï¼è°åº¦å¨ï¼</h3>
<p><strong>Scheduler</strong> æ¯ Karmada çè°åº¦ç»ä»¶ï¼è´è´£ï¼</p>
<ol>
<li><strong>çå¬ RB</strong>ï¼çå¬ ResourceBinding çåå»ºåæ´æ°</li>
<li><strong>éæ©éç¾¤</strong>ï¼æ ¹æ® Placement è§åéæ©åéçæåéç¾¤</li>
<li><strong>åéå¯æ¬</strong>ï¼å°å¯æ¬æç­ç¥åéå°ä¸åéç¾¤</li>
<li><strong>æ´æ° RB</strong>ï¼å°è°åº¦ç»æå¡«åå° <code>ResourceBinding.Spec.Clusters</code></li>
</ol>
<p><strong>éè¦</strong>ï¼Scheduler <strong>åªè´è´£å¡«å <code>Spec.Clusters</code></strong>ï¼ä¸ä¼ä¿®æ¹å¶ä»å­æ®µã</p>
<h3 id="08-æ¦å¿µå³ç³»å¾">0.8 æ¦å¿µå³ç³»å¾</h3>
<pre><code>âââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ
â                   æ§å¶å¹³é¢ï¼Karmadaï¼                      â
â                                                          â
â  âââââââââââââââ      ââââââââââââââââ                â
â  â Deployment  â      âPropagation   â                â
â  â  (èµæºå¯¹è±¡)  â      â  Policy      â                â
â  ââââââââ¬âââââââ      ââââââââ¬ââââââââ                â
â         â                    â                         â
â         ââââââââââ¬ââââââââââââ                         â
â                  â                                     â
â                  â¼                                     â
â         ââââââââââââââââââââ                          â
â         âResourceDetector  â                          â
â         â  (æ£æµå¹¶åå»º)     â                          â
â         ââââââââââ¬ââââââââââ                          â
â                  â                                     â
â                  â¼                                     â
â         ââââââââââââââââââââ                          â
â         âResourceBinding   â                          â
â         â  (ç»å®ç­ç¥åèµæº)  â                          â
â         ââââââââââ¬ââââââââââ                          â
â                  â                                     â
â                  â¼                                     â
â         ââââââââââââââââââââ                          â
â         â   Scheduler      â                          â
â         â  (éæ©ç®æ éç¾¤)   â                          â
â         ââââââââââ¬ââââââââââ                          â
â                  â                                     â
â                  â¼                                     â
â         ââââââââââââââââââââ                          â
â         âResourceBinding   â                          â
â         â (Spec.Clusterså·² â                          â
â         â   è¢«å¡«å)        â                          â
â         ââââââââââ¬ââââââââââ                          â
â                  â                                     â
â                  â¼                                     â
â         ââââââââââââââââââââ                          â
â         â BindingControllerâ                          â
â         â   (è½¬æ¢ä¸ºWork)    â                          â
â         ââââââââââ¬ââââââââââ                          â
â                  â                                     â
ââââââââââââââââââââ¼ââââââââââââââââââââââââââââââââââââââ
                   â
        ââââââââââââ´âââââââââââ
        â                     â
        â¼                     â¼
ââââââââââââââââ      ââââââââââââââââ
â   Work       â      â   Work       â
â(execution-   â      â(execution-   â
â cluster-1)   â      â cluster-2)   â
ââââââââ¬ââââââââ      ââââââââ¬ââââââââ
       â                     â
       ââââââââââââ¬âââââââââââ
                  â
        âââââââââââ´ââââââââââ
        â                   â
        â¼                   â¼
âââââââââââââââ      âââââââââââââââ
âæåéç¾¤1     â      âæåéç¾¤2     â
â             â      â             â
â Deployment  â      â Deployment  â
â  (å®éè¿è¡)  â      â  (å®éè¿è¡)  â
âââââââââââââââ      âââââââââââââââ
</code></pre>
<h2 id="ä¸rb-ççå½å¨æ">ä¸ãRB ççå½å¨æ</h2>
<h3 id="11-æ´ä½æµç¨">1.1 æ´ä½æµç¨</h3>
<pre><code>ç¨æ·åå»ºèµæº + PropagationPolicy
    â
ResourceDetector æ£æµå¹¶åå»º/æ´æ° RB
    â
Scheduler ä¸º RB éæ©ç®æ éç¾¤
    â
ResourceBindingController å° RB è½¬æ¢ä¸º Work
    â
Work è¢«ååå°æåéç¾¤
</code></pre>
<h3 id="12-å³é®ç»ä»¶">1.2 å³é®ç»ä»¶</h3>
<ol>
<li><strong>ResourceDetector</strong> (<code>pkg/detector/detector.go</code>): è´è´£æ£æµèµæºå¹¶åå»º RB</li>
<li><strong>Scheduler</strong> (<code>pkg/scheduler/</code>): ä¸º RB éæ©ç®æ éç¾¤</li>
<li><strong>ResourceBindingController</strong> (<code>pkg/controllers/binding/</code>): å° RB è½¬æ¢ä¸º Work</li>
<li><strong>ResourceInterpreter</strong> (<code>pkg/resourceinterpreter/</code>): è§£éèµæºï¼æåå¯æ¬æ°åèµæºéæ±</li>
</ol>
<h2 id="äºrb-çåå»ºè¿ç¨">äºãRB çåå»ºè¿ç¨</h2>
<h3 id="21-è§¦åæ¡ä»¶">2.1 è§¦åæ¡ä»¶</h3>
<p>å½ç¨æ·åå»ºææ´æ°äºï¼</p>
<ul>
<li><strong>èµæºå¯¹è±¡</strong>ï¼å¦ Deploymentï¼</li>
<li><strong>PropagationPolicy</strong> æ <strong>ClusterPropagationPolicy</strong></li>
</ul>
<p>ResourceDetector ä¼æ£æµå°ååå¹¶è§¦å RB çåå»ºææ´æ°ã</p>
<h3 id="22-åå»ºæµç¨è¯¦è§£">2.2 åå»ºæµç¨è¯¦è§£</h3>
<h4 id="æ­¥éª¤1-æ£æµèµæºåç­ç¥å¹é">æ­¥éª¤1: æ£æµèµæºåç­ç¥å¹é</h4>
<p>å½èµæºå¯¹è±¡åçååæ¶ï¼ResourceDetector ä¼ï¼</p>
<pre><code class="language-796:862:pkg/detector/detector.go">// BuildResourceBinding builds a desired ResourceBinding for object.
func (d *ResourceDetector) BuildResourceBinding(object *unstructured.Unstructured, policySpec *policyv1alpha1.PropagationSpec, policyID string, policyMeta metav1.ObjectMeta, claimFunc func(object metav1.Object, policyId string, objectMeta metav1.ObjectMeta)) (*workv1alpha2.ResourceBinding, error) {
	bindingName := names.GenerateBindingName(object.GetKind(), object.GetName())
	propagationBinding := &amp;workv1alpha2.ResourceBinding{
		ObjectMeta: metav1.ObjectMeta{
			Name:      bindingName,
			Namespace: object.GetNamespace(),
			OwnerReferences: []metav1.OwnerReference{
				*metav1.NewControllerRef(object, object.GroupVersionKind()),
			},
			Finalizers: []string{util.BindingControllerFinalizer},
		},
		Spec: workv1alpha2.ResourceBindingSpec{
			PropagateDeps:               policySpec.PropagateDeps,
			SchedulerName:               policySpec.SchedulerName,
			Placement:                   &amp;policySpec.Placement,
			Failover:                    policySpec.Failover,
			ConflictResolution:          policySpec.ConflictResolution,
			PreserveResourcesOnDeletion: policySpec.PreserveResourcesOnDeletion,
			Resource: workv1alpha2.ObjectReference{
				APIVersion:      object.GetAPIVersion(),
				Kind:            object.GetKind(),
				Namespace:       object.GetNamespace(),
				Name:            object.GetName(),
				UID:             object.GetUID(),
				ResourceVersion: object.GetResourceVersion(),
			},
		},
	}

	if policySpec.Suspension != nil {
		propagationBinding.Spec.Suspension = &amp;workv1alpha2.Suspension{Suspension: *policySpec.Suspension}
	}

	claimFunc(propagationBinding, policyID, policyMeta)

	if err := d.applyReplicaInterpretation(object, &amp;propagationBinding.Spec); err != nil {
		return nil, err
	}

	if features.FeatureGate.Enabled(features.PriorityBasedScheduling) &amp;&amp; policySpec.SchedulePriority != nil {
		// ... å¤çè°åº¦ä¼åçº§
	}

	return propagationBinding, nil
}
</code></pre>
<p><strong>å³é®ç¹</strong>ï¼</p>
<ul>
<li>ä½¿ç¨ <code>names.GenerateBindingName()</code> çæ RB åç§°ï¼æ ¼å¼ï¼<code>{Kind}-{Name}</code>ï¼</li>
<li>è®¾ç½® OwnerReference å»ºç«èµæºå¯¹è±¡å RB çå³è</li>
<li>æ·»å  Finalizer ç¡®ä¿å é¤æ¶æ­£ç¡®æ¸ç</li>
</ul>
<h4 id="æ­¥éª¤2-åºç¨å¯æ¬è§£é">æ­¥éª¤2: åºç¨å¯æ¬è§£é</h4>
<p>è¿æ¯ RB åå»ºä¸­ç<strong>å³é®æ­¥éª¤</strong></p>
<pre><code class="language-1442:1470:pkg/detector/detector.go">// applyReplicaInterpretation handles the logic for interpreting replicas or components from an object.
func (d *ResourceDetector) applyReplicaInterpretation(object *unstructured.Unstructured, spec *workv1alpha2.ResourceBindingSpec) error {
	gvk := object.GroupVersionKind()
	name := object.GetName()

	// Prioritize component interpretation if the feature and GetComponents are enabled.
	if features.FeatureGate.Enabled(features.MultiplePodTemplatesScheduling) &amp;&amp; d.ResourceInterpreter.HookEnabled(gvk, configv1alpha1.InterpreterOperationInterpretComponent) {
		components, err := d.ResourceInterpreter.GetComponents(object)
		if err != nil {
			klog.Errorf("Failed to get components for %s(%s): %v", gvk, name, err)
			return err
		}
		spec.Components = components
		return nil
	}

	// GetReplicas is executed if the MultiplePodTemplatesScheduling feature gate is disabled, or if GetComponents is not implemented.
	if d.ResourceInterpreter.HookEnabled(gvk, configv1alpha1.InterpreterOperationInterpretReplica) {
		replicas, replicaRequirements, err := d.ResourceInterpreter.GetReplicas(object)
		if err != nil {
			klog.Errorf("Failed to customize replicas for %s(%s): %v", gvk, name, err)
			return err
		}
		spec.Replicas = replicas
		spec.ReplicaRequirements = replicaRequirements
	}

	return nil
}
</code></pre>
<p><strong>è°ç¨é¾</strong>ï¼</p>
<pre><code>applyReplicaInterpretation
    â
ResourceInterpreter.GetReplicas(object)
    â
ConfigurableInterpreter.GetReplicas(object)
    â
LuaVM.GetReplicas(object, script) 
    â
LuaVM.RunScript(script, "GetReplicas", 2, object)  â éè¦ä» VM æ± è·åå®ä¾
    â
VM.Pool.Get()  â éç«äºç¹
    â
Lua.DoString(script)  â èæ¬ç¼è¯ç¹
    â
Lua.CallByParam(...)  â æ§è¡ GetReplicas å½æ°
</code></pre>
<h4 id="æ­¥éª¤3-åå»ºææ´æ°-rb">æ­¥éª¤3: åå»ºææ´æ° RB</h4>
<p>ä½¿ç¨ <code>CreateOrUpdate</code> ç¡®ä¿ RB å­å¨ï¼</p>
<pre><code class="language-475:524:pkg/detector/detector.go">	binding, err := d.BuildResourceBinding(object, &amp;policy.Spec, policyID, policy.ObjectMeta, AddPPClaimMetadata)
	if err != nil {
		klog.Errorf("Failed to build resourceBinding for object: %s. error: %v", objectKey, err)
		return err
	}
	bindingCopy := binding.DeepCopy()
	err = retry.RetryOnConflict(retry.DefaultRetry, func() (err error) {
		operationResult, err = controllerutil.CreateOrUpdate(context.TODO(), d.Client, bindingCopy, func() error {
			// If this binding exists and its owner is not the input object, return error and let garbage collector
			// delete this binding and try again later. See https://github.com/karmada-io/karmada/issues/2090.
			if ownerRef := metav1.GetControllerOfNoCopy(bindingCopy); ownerRef != nil &amp;&amp; ownerRef.UID != object.GetUID() {
				return fmt.Errorf("failed to update binding due to different owner reference UID, will " +
					"try again later after binding is garbage collected, see https://github.com/karmada-io/karmada/issues/2090")
			}

			// Just update necessary fields, especially avoid modifying Spec.Clusters which is scheduling result, if already exists.
			bindingCopy.Annotations = util.DedupeAndMergeAnnotations(bindingCopy.Annotations, binding.Annotations)
			bindingCopy.Labels = util.DedupeAndMergeLabels(bindingCopy.Labels, binding.Labels)
			bindingCopy.OwnerReferences = binding.OwnerReferences
			bindingCopy.Spec.Placement = binding.Spec.Placement
			bindingCopy.Spec.Resource = binding.Spec.Resource
			bindingCopy.Spec.ConflictResolution = binding.Spec.ConflictResolution
			if binding.Spec.Suspension != nil {
				if bindingCopy.Spec.Suspension == nil {
					bindingCopy.Spec.Suspension = &amp;workv1alpha2.Suspension{}
				}
				bindingCopy.Spec.Suspension.Suspension = binding.Spec.Suspension.Suspension
			}
			return nil
		})
		if err != nil {
			return err
		}
		return nil
	})
</code></pre>
<p><strong>å³é®ç¹</strong>ï¼</p>
<ul>
<li>ä½¿ç¨ <code>RetryOnConflict</code> å¤çå¹¶åæ´æ°å²çª</li>
<li><strong>ä¸ä¿®æ¹ <code>Spec.Clusters</code></strong>ï¼è¿æ¯è°åº¦å¨çè°åº¦ç»æ</li>
<li>åªæ´æ°ç­ç¥ç¸å³çå­æ®µ</li>
</ul>
<h2 id="ä¸rb-å°-work-çè½¬æ¢">ä¸ãRB å° Work çè½¬æ¢</h2>
<h3 id="31-è½¬æ¢è§¦å">3.1 è½¬æ¢è§¦å</h3>
<p>å½ RB è¢«åå»ºææ´æ°åï¼ResourceBindingController ä¼çå¬ RB çååï¼</p>
<pre><code class="language-110:148:pkg/controllers/binding/binding_controller.go">// syncBinding will sync resourceBinding to Works.
func (c *ResourceBindingController) syncBinding(ctx context.Context, binding *workv1alpha2.ResourceBinding) (controllerruntime.Result, error) {
	if err := c.removeOrphanWorks(ctx, binding); err != nil {
		return controllerruntime.Result{}, err
	}

	needWaitForCleanup, err := c.checkDirectPurgeOrphanWorks(ctx, binding)
	if err != nil {
		return controllerruntime.Result{}, err
	}
	if needWaitForCleanup {
		msg := fmt.Sprintf("There are works in clusters with PurgeMode 'Directly' not deleted for ResourceBinding(%s/%s), skip syncing works",
			binding.Namespace, binding.Name)
		klog.V(4).InfoS(msg, "namespace", binding.GetNamespace(), "binding", binding.GetName())
		return controllerruntime.Result{RequeueAfter: requeueIntervalForDirectlyPurge}, nil
	}

	workload, err := helper.FetchResourceTemplate(ctx, c.DynamicClient, c.InformerManager, c.RESTMapper, binding.Spec.Resource)
	if err != nil {
		if apierrors.IsNotFound(err) {
			// It might happen when the resource template has been removed but the garbage collector hasn't removed
			// the ResourceBinding which dependent on resource template.
			// So, just return without retry(requeue) would save unnecessary loop.
			return controllerruntime.Result{}, nil
		}
		klog.ErrorS(err, "Failed to fetch workload for ResourceBinding", "namespace", binding.GetNamespace(), "binding", binding.GetName())
		return controllerruntime.Result{}, err
	}
	start := time.Now()
	err = ensureWork(ctx, c.Client, c.ResourceInterpreter, workload, c.OverrideManager, binding, apiextensionsv1.NamespaceScoped)
	metrics.ObserveSyncWorkLatency(err, start)
	if err != nil {
		klog.ErrorS(err, "Failed to transform ResourceBinding to works", "namespace", binding.GetNamespace(), "binding", binding.GetName())
		c.EventRecorder.Event(binding, corev1.EventTypeWarning, events.EventReasonSyncWorkFailed, err.Error())
		c.EventRecorder.Event(workload, corev1.EventTypeWarning, events.EventReasonSyncWorkFailed, err.Error())
		return controllerruntime.Result{}, err
	}

	msg := fmt.Sprintf("Sync work of ResourceBinding(%s/%s) successful.",
</code></pre>
<h3 id="32-ensurework-å½æ°è¯¦è§£">3.2 ensureWork å½æ°è¯¦è§£</h3>
<p>è¿æ¯å° RB è½¬æ¢ä¸º Work çæ ¸å¿å½æ°ï¼</p>
<pre><code class="language-50:158:pkg/controllers/binding/common.go">// ensureWork ensure Work to be created or updated.
func ensureWork(
	ctx context.Context, c client.Client, resourceInterpreter resourceinterpreter.ResourceInterpreter, workload *unstructured.Unstructured,
	overrideManager overridemanager.OverrideManager, binding metav1.Object, scope apiextensionsv1.ResourceScope,
) error {
	bindingSpec := getBindingSpec(binding, scope)
	targetClusters := mergeTargetClusters(bindingSpec.Clusters, bindingSpec.RequiredBy)
	var err error
	var errs []error

	var jobCompletions []workv1alpha2.TargetCluster
	if workload.GetKind() == util.JobKind &amp;&amp; needReviseJobCompletions(bindingSpec.Replicas, bindingSpec.Placement) {
		jobCompletions, err = divideReplicasByJobCompletions(workload, targetClusters)
		if err != nil {
			return err
		}
	}

	for i := range targetClusters {
		targetCluster := targetClusters[i]
		clonedWorkload := workload.DeepCopy()

		workNamespace := names.GenerateExecutionSpaceName(targetCluster.Name)

		// When syncing workloads to member clusters, the controller MUST strictly adhere to the scheduling results
		// specified in bindingSpec.Clusters for replica allocation, rather than using the replicas declared in the
		// workload's resource template.
		// This rule applies regardless of whether the workload distribution mode is "Divided" or "Duplicated".
		// Failing to do so could allow workloads to bypass the quota checks performed by the scheduler
		// (especially during scale-up operations) or skip queue validation when scheduling is suspended.
		if bindingSpec.IsWorkload() {
			if resourceInterpreter.HookEnabled(clonedWorkload.GroupVersionKind(), configv1alpha1.InterpreterOperationReviseReplica) {
				clonedWorkload, err = resourceInterpreter.ReviseReplica(clonedWorkload, int64(targetCluster.Replicas))
				if err != nil {
					klog.ErrorS(err, "Failed to revise replica for workload in cluster.", "workloadKind", workload.GetKind(),
						"workloadNamespace", workload.GetNamespace(), "workloadName", workload.GetName(), "cluster", targetCluster.Name)
					errs = append(errs, err)
					continue
				}
			}
		}

		// jobSpec.Completions specifies the desired number of successfully finished pods the job should be run with.
		// When the replica scheduling policy is set to "divided", jobSpec.Completions should also be divided accordingly.
		// The weight assigned to each cluster roughly equals that cluster's jobSpec.Parallelism value. This approach helps
		// balance the execution time of the job across member clusters.
		if len(jobCompletions) &gt; 0 {
			// Set allocated completions for Job only when the '.spec.completions' field not omitted from resource template.
			// For jobs running with a 'work queue' usually leaves '.spec.completions' unset, in that case we skip
			// setting this field as well.
			// Refer to: https://kubernetes.io/docs/concepts/workloads/controllers/job/#parallel-jobs.
			if err = helper.ApplyReplica(clonedWorkload, int64(jobCompletions[i].Replicas), util.CompletionsField); err != nil {
				klog.ErrorS(err, "Failed to apply Completions for workload in cluster.",
					"workloadKind", clonedWorkload.GetKind(), "workloadNamespace", clonedWorkload.GetNamespace(),
					"workloadName", clonedWorkload.GetName(), "cluster", targetCluster.Name)
				errs = append(errs, err)
				continue
			}
		}

		// We should call ApplyOverridePolicies last, as override rules have the highest priority
		cops, ops, err := overrideManager.ApplyOverridePolicies(clonedWorkload, targetCluster.Name)
		if err != nil {
			klog.ErrorS(err, "Failed to apply overrides for workload in cluster.",
				"workloadKind", clonedWorkload.GetKind(), "workloadNamespace", clonedWorkload.GetNamespace(),
				"workloadName", clonedWorkload.GetName(), "cluster", targetCluster.Name)
			errs = append(errs, err)
			continue
		}
		workLabel := mergeLabel(clonedWorkload, binding, scope)

		annotations := mergeAnnotations(clonedWorkload, binding, scope)
		annotations = mergeConflictResolution(clonedWorkload, bindingSpec.ConflictResolution, annotations)
		annotations, err = RecordAppliedOverrides(cops, ops, annotations)
		if err != nil {
			klog.ErrorS(err, "Failed to record appliedOverrides in cluster.", "cluster", targetCluster.Name)
			errs = append(errs, err)
			continue
		}

		if features.FeatureGate.Enabled(features.StatefulFailoverInjection) {
			// we need to figure out if the targetCluster is in the cluster we are going to migrate application to.
			// If yes, we have to inject the preserved label state to the clonedWorkload.
			clonedWorkload = injectReservedLabelState(bindingSpec, targetCluster, clonedWorkload, len(targetClusters))
		}

		workMeta := metav1.ObjectMeta{
			Name:        names.GenerateWorkName(clonedWorkload.GetKind(), clonedWorkload.GetName(), clonedWorkload.GetNamespace()),
			Namespace:   workNamespace,
			Finalizers:  []string{util.ExecutionControllerFinalizer},
			Labels:      workLabel,
			Annotations: annotations,
		}

		if err = ctrlutil.CreateOrUpdateWork(
			ctx,
			c,
			workMeta,
			clonedWorkload,
			ctrlutil.WithSuspendDispatching(shouldSuspendDispatching(bindingSpec.Suspension, targetCluster)),
			ctrlutil.WithPreserveResourcesOnDeletion(ptr.Deref(bindingSpec.PreserveResourcesOnDeletion, false)),
		); err != nil {
			errs = append(errs, err)
			continue
		}
	}

	return errors.NewAggregate(errs)
}
</code></pre>
<p><strong>å³é®æ­¥éª¤</strong>ï¼</p>
<ol>
<li><strong>è·åç®æ éç¾¤åè¡¨</strong>ï¼ä» <code>bindingSpec.Clusters</code> ä¸­è·åè°åº¦ç»æ</li>
<li><strong>ä¸ºæ¯ä¸ªéç¾¤åå»º Work</strong>ï¼
<ul>
<li>åé workload</li>
<li>æ ¹æ®è°åº¦ç»æè°æ´å¯æ¬æ°ï¼<code>ReviseReplica</code>ï¼</li>
<li>åºç¨ OverridePolicies</li>
<li>åå»º Work å¯¹è±¡</li>
</ul>
</li>
</ol>
<h2 id="årb-çæ°æ®ç»æ">åãRB çæ°æ®ç»æ</h2>
<h3 id="41-resourcebindingspec">4.1 ResourceBindingSpec</h3>
<pre><code class="language-go">type ResourceBindingSpec struct {
    // èµæºå¼ç¨
    Resource workv1alpha2.ObjectReference
    
    // å¯æ¬ä¿¡æ¯ï¼ä» ResourceInterpreter è·åï¼
    Replicas *int32
    ReplicaRequirements *ReplicaRequirements
    Components []Component
    
    // è°åº¦ç¸å³
    Placement *Placement
    Clusters []TargetCluster  // è°åº¦ç»æï¼ç± Scheduler å¡«å
    SchedulerName string
    
    // å¶ä»
    PropagateDeps bool
    Failover *FailoverBehavior
    ConflictResolution ConflictResolution
    // ...
}
</code></pre>
<h3 id="42-å³é®å­æ®µè¯´æ">4.2 å³é®å­æ®µè¯´æ</h3>
<ul>
<li><strong>Resource</strong>: æååå§èµæºå¯¹è±¡ï¼DeploymentãStatefulSet ç­ï¼</li>
<li><strong>Replicas/ReplicaRequirements</strong>: ä»èµæºä¸­æåçå¯æ¬æ°åèµæºéæ±</li>
<li><strong>Clusters</strong>: <strong>ç± Scheduler å¡«å</strong>ï¼åå«ç®æ éç¾¤ååéçå¯æ¬æ°</li>
<li><strong>Placement</strong>: è°åº¦ç­ç¥ï¼ä»åªéè°åº¦ï¼</li>
</ul>
<h2 id="äºå³é®æ¦å¿µå¿«éç´¢å¼">äºãå³é®æ¦å¿µå¿«éç´¢å¼</h2>
<h3 id="51-æ ¸å¿èµæºå¯¹è±¡">5.1 æ ¸å¿èµæºå¯¹è±¡</h3>
<table>
<thead>
<tr>
<th>æ¦å¿µ</th>
<th>å®ä¹</th>
<th>ä½ç¨å</th>
<th>å³é®å­æ®µ</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>PropagationPolicy</strong></td>
<td>å®ä¹èµæºå¦ä½ä¼ æ­çç­ç¥</td>
<td>Namespace</td>
<td>ResourceSelectors, Placement, Priority</td>
</tr>
<tr>
<td><strong>ClusterPropagationPolicy</strong></td>
<td>éç¾¤çº§å«çä¼ æ­ç­ç¥</td>
<td>Cluster</td>
<td>å PropagationPolicy</td>
</tr>
<tr>
<td><strong>ResourceBinding</strong></td>
<td>èµæºå¯¹è±¡åç­ç¥çç»å®</td>
<td>Namespace</td>
<td>Resource, Replicas, Clusters</td>
</tr>
<tr>
<td><strong>ClusterResourceBinding</strong></td>
<td>éç¾¤çº§å«çèµæºç»å®</td>
<td>Cluster</td>
<td>å ResourceBinding</td>
</tr>
<tr>
<td><strong>Work</strong></td>
<td>å®éåéå°æåéç¾¤çå·¥ä½è´è½½</td>
<td>Namespace</td>
<td>Workload.Manifests, Status</td>
</tr>
</tbody>
</table>
<h3 id="52-æ ¸å¿ç»ä»¶">5.2 æ ¸å¿ç»ä»¶</h3>
<table>
<thead>
<tr>
<th>ç»ä»¶</th>
<th>èè´£</th>
<th>å³é®æä½</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ResourceDetector</strong></td>
<td>æ£æµèµæºå¹¶åå»º RB</td>
<td>ApplyPolicy, BuildResourceBinding</td>
</tr>
<tr>
<td><strong>Scheduler</strong></td>
<td>ä¸º RB éæ©ç®æ éç¾¤</td>
<td>å¡«å Spec.Clusters</td>
</tr>
<tr>
<td><strong>ResourceBindingController</strong></td>
<td>å° RB è½¬æ¢ä¸º Work</td>
<td>syncBinding, ensureWork</td>
</tr>
<tr>
<td><strong>ResourceInterpreter</strong></td>
<td>è§£éèµæºç»æ</td>
<td>GetReplicas, ReviseReplica</td>
</tr>
<tr>
<td><strong>ExecutionController</strong></td>
<td>å¨æåéç¾¤æ§è¡ Work</td>
<td>syncToClusters</td>
</tr>
</tbody>
</table>
<h3 id="53-å³é®æ°æ®ç»æ">5.3 å³é®æ°æ®ç»æ</h3>
<h4 id="placementæ¾ç½®è§å">Placementï¼æ¾ç½®è§åï¼</h4>
<pre><code class="language-470:524:pkg/apis/policy/v1alpha1/propagation_types.go">type Placement struct {
	// ClusterAffinity represents scheduling restrictions to a certain set of clusters.
	// Note:
	//   1. ClusterAffinity can not co-exist with ClusterAffinities.
	//   2. If both ClusterAffinity and ClusterAffinities are not set, any cluster
	//      can be scheduling candidates.
	// +optional
	ClusterAffinity *ClusterAffinity `json:"clusterAffinity,omitempty"`

	// ClusterAffinities represents scheduling restrictions to multiple cluster
	// groups that indicated by ClusterAffinityTerm.
	//
	// The scheduler will evaluate these groups one by one in the order they
	// appear in the spec, the group that does not satisfy scheduling restrictions
	// will be ignored which means all clusters in this group will not be selected
	// unless it also belongs to the next group(a cluster could belong to multiple
	// groups).
	//
	// If none of the groups satisfy the scheduling restrictions, then scheduling
	// fails, which means no cluster will be selected.
	//
	// Note:
	//   1. ClusterAffinities can not co-exist with ClusterAffinity.
	//   2. If both ClusterAffinity and ClusterAffinities are not set, any cluster
	//      can be scheduling candidates.
	//
	// Potential use case 1:
	// The private clusters in the local data center could be the main group, and
	// the managed clusters provided by cluster providers could be the secondary
	// group. So that the Karmada scheduler would prefer to schedule workloads
	// to the main group and the second group will only be considered in case of
	// the main group does not satisfy restrictions(like, lack of resources).
	//
	// Potential use case 2:
	// For the disaster recovery scenario, the clusters could be organized to
	// primary and backup groups, the workloads would be scheduled to primary
	// clusters firstly, and when primary cluster fails(like data center power off),
	// Karmada scheduler could migrate workloads to the backup clusters.
	//
	// +optional
	ClusterAffinities []ClusterAffinityTerm `json:"clusterAffinities,omitempty"`

	// ClusterTolerations represents the tolerations.
	// +optional
	ClusterTolerations []corev1.Toleration `json:"clusterTolerations,omitempty"`

	// SpreadConstraints represents a list of the scheduling constraints.
	// +optional
	SpreadConstraints []SpreadConstraint `json:"spreadConstraints,omitempty"`

	// ReplicaScheduling represents the scheduling policy on dealing with the number of replicas
	// when propagating resources that have replicas in spec (e.g. deployments, statefulsets) to member clusters.
	// +optional
	ReplicaScheduling *ReplicaSchedulingStrategy `json:"replicaScheduling,omitempty"`
}
</code></pre>
<p><strong>å­æ®µè¯´æ</strong>ï¼</p>
<ul>
<li><strong>ClusterAffinity</strong>: é¦éåªäºéç¾¤ï¼éè¿æ ç­¾ãå­æ®µãéç¾¤åéæ©ï¼</li>
<li><strong>ClusterTolerations</strong>: éç¾¤å®¹å¿åº¦ï¼ç±»ä¼¼ Pod ç Tolerationsï¼</li>
<li><strong>SpreadConstraints</strong>: åæ£çº¦æï¼å¦ï¼æå¤ 3 ä¸ªéç¾¤ï¼æ¯ä¸ªéç¾¤è³å° 1 ä¸ªå¯æ¬ï¼</li>
<li><strong>ReplicaScheduling</strong>: å¯æ¬è°åº¦ç­ç¥ï¼Duplicated æ Dividedï¼</li>
</ul>
<h4 id="resourcebindingspec">ResourceBindingSpec</h4>
<p>RB ç Spec åå«ï¼</p>
<ul>
<li><strong>Resource</strong>: èµæºå¼ç¨ï¼APIVersion, Kind, Name, Namespace, UIDï¼</li>
<li><strong>Replicas</strong>: å¯æ¬æ°ï¼ä» ResourceInterpreter è·åï¼</li>
<li><strong>ReplicaRequirements</strong>: èµæºéæ±ï¼CPUãåå­ç­ï¼</li>
<li><strong>Clusters</strong>: ç®æ éç¾¤åè¡¨ï¼<strong>ç± Scheduler å¡«å</strong>ï¼</li>
<li><strong>Placement</strong>: æ¾ç½®è§åï¼ä» PropagationPolicy å¤å¶ï¼</li>
<li><strong>Failover</strong>: æéè½¬ç§»è¡ä¸º</li>
</ul>
<p><strong>éè¦</strong>ï¼<code>Spec.Clusters</code> æ¯è°åº¦ç»æï¼ResourceDetector å BindingController é½ä¸ä¼ä¿®æ¹å®ã</p>
<h3 id="54-æ§è¡ç©ºé´execution-space">5.4 æ§è¡ç©ºé´ï¼Execution Spaceï¼</h3>
<p>æ¯ä¸ªæåéç¾¤é½æä¸ä¸ªå¯¹åºç namespaceï¼</p>
<ul>
<li><strong>å½åè§å</strong>: <code>execution-{cluster-name}</code></li>
<li><strong>ä½ç¨</strong>: å­æ¾åéå°è¯¥éç¾¤çææ Work</li>
<li><strong>ç¤ºä¾</strong>:
<ul>
<li>éç¾¤ <code>member1</code> â namespace <code>execution-member1</code></li>
<li>éç¾¤ <code>member2</code> â namespace <code>execution-member2</code></li>
</ul>
</li>
</ul>
<h3 id="55-æéè½¬ç§»failover">5.5 æéè½¬ç§»ï¼Failoverï¼</h3>
<p><strong>FailoverBehavior</strong> å®ä¹äºå¨åºç¨æéç¾¤æéæ¶çè¡ä¸ºï¼</p>
<pre><code class="language-328:392:pkg/apis/policy/v1alpha1/propagation_types.go">// FailoverBehavior indicates failover behaviors in case of an application or
// cluster failure.
type FailoverBehavior struct {
	// Application indicates failover behaviors in case of application failure.
	// If this value is nil, failover is disabled.
	// If set, the PropagateDeps should be true so that the dependencies could
	// be migrated along with the application.
	// +optional
	Application *ApplicationFailoverBehavior `json:"application,omitempty"`

	// Cluster indicates failover behaviors in case of cluster failure.
	// If this value is nil, the failover behavior in case of cluster failure
	// will be controlled by the controller's no-execute-taint-eviction-purge-mode
	// parameter.
	// If set, the failover behavior in case of cluster failure will be defined
	// by this value.
	// +optional
	Cluster *ClusterFailoverBehavior `json:"cluster,omitempty"`
}

// ApplicationFailoverBehavior indicates application failover behaviors.
type ApplicationFailoverBehavior struct {
	// DecisionConditions indicates the decision conditions of performing the failover process.
	// Only when all conditions are met can the failover process be performed.
	// Currently, DecisionConditions includes several conditions:
	// - TolerationSeconds (optional)
	// +required
	DecisionConditions DecisionConditions `json:"decisionConditions"`

	// PurgeMode represents how to deal with the legacy applications on the
	// cluster from which the application is migrated.
	// Valid options are "Directly", "Gracefully", "Never", "Immediately"(deprecated),
	// and "Graciously"(deprecated).
	// Defaults to "Gracefully".
	// +kubebuilder:validation:Enum=Directly;Gracefully;Never;Immediately;Graciously
	// +kubebuilder:default=Gracefully
	// +optional
	PurgeMode PurgeMode `json:"purgeMode,omitempty"`
</code></pre>
<p><strong>PurgeMode è¯´æ</strong>ï¼</p>
<ul>
<li><strong>Directly</strong>: ç«å³å é¤æ§éç¾¤ä¸çåºç¨ï¼ç¨äºä¸è½å®¹å¿ä¸¤ä¸ªå®ä¾åæ¶è¿è¡çåºç¨ï¼å¦ Flinkï¼</li>
<li><strong>Gracefully</strong>: ç­å¾æ°éç¾¤ä¸çåºç¨å¥åº·ååå é¤ï¼é»è®¤ï¼</li>
<li><strong>Never</strong>: ä¸å é¤ï¼æå¨æ¸ç</li>
</ul>
<h2 id="å­æ»ç»">å­ãæ»ç»</h2>
<h3 id="61-å³é®æµç¨åé¡¾">6.1 å³é®æµç¨åé¡¾</h3>
<ol>
<li><strong>èµæºåå»º</strong> â ResourceDetector æ£æµ</li>
<li><strong>ç­ç¥å¹é</strong> â æ¾å°å¹éç PropagationPolicy</li>
<li><strong>åå»º RB</strong> â BuildResourceBindingï¼æ§è½ç¶é¢ï¼Lua èæ¬æ§è¡ï¼</li>
<li><strong>è°åº¦</strong> â Scheduler å¡«å Spec.Clusters</li>
<li><strong>è½¬æ¢ Work</strong> â ResourceBindingController å° RB è½¬æ¢ä¸º Work</li>
<li><strong>ååæ§è¡</strong> â Work åéå°æåéç¾¤æ§è¡</li>
</ol>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.03958333333333333" data-date-updated="2026-01-13 15:23">2026-01-13 14:26</span>&nbsp;
<a href="https://www.cnblogs.com/Mephostopheles">Mephostopheles</a>&nbsp;
éè¯»(<span id="post_view_count">29</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19477095);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19477095', targetLink: 'https://www.cnblogs.com/Mephostopheles/p/19477095', title: 'Karmada-ResourceBinding (RB) ç»ä»¶è¯¦è§£' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Anthropic å¦ä½è¯ä¼° AI Agent ]]></title>
    <link>https://www.cnblogs.com/didispace/p/19477137</link>
    <guid>c1cd776368ea5078c0325959df4bed3e</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/didispace/p/19477137" title="åå¸äº 2026-01-13 14:22">
    <span role="heading" aria-level="2">Anthropic å¦ä½è¯ä¼° AI Agent</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="å¼è¨æç ´ç²ç®é£è¡çå¼åå¾ªç¯">å¼è¨ï¼æç ´âç²ç®é£è¡âçå¼åå¾ªç¯</h2>
<p>å¨å¼åAIæºè½ä½çè¿ç¨ä¸­ï¼è®¸å¤å¢éé½ç»åè¿è¿æ ·ççç¹ï¼ä½ ä¿®å¤äºä¸ä¸ªé®é¢ï¼å´å¨ä¸ç»æé´å¼åäºå¦ä¸ä¸ªæ´éè½çé®é¢ãå¦ææ²¡æä¸å¥å¯é çè¯ä¼°ä½ç³»ï¼æ´ä¸ªå¼åè¿ç¨å°±åæ¯å¨âç²ç®é£è¡âï¼å¢éé·å¥è¢«å¨ä¿®å¤çå¾ªç¯ï¼é¾ä»¥èªä¿¡å°åå¸æ°çæ¬ã</p>
<p>ææçè¯ä¼°ï¼evalsï¼æ­£æ¯æç ´è¿ä¸å°å¢çå³é®ãå®è½è®©æºè½ä½å¨è¡ä¸ºä¸çåååæ½å¨é®é¢å¨å½±åç¨æ·ä¹åå°±åå¾æ¸æ°å¯è§ãæ¬æå°ä»Anthropicçæ·±åº¦åäº«ä¸­ï¼æç¼åºäºä¸ªæä»¤äººæè®¶ãæå·å½±ååçæ ¸å¿æè®­ï¼å®ä»¬å°å½»åºæ¹åä½ å¯¹AIæºè½ä½è¯ä¼°ççæ³ã</p>
<h2 id="äºä¸ªå³äºaiæºè½ä½è¯ä¼°çåç´è§æè®­">äºä¸ªå³äºAIæºè½ä½è¯ä¼°çåç´è§æè®­</h2>
<h3 id="æè®­ä¸å«ç­äºä»20ä¸ªå¤±è´¥æ¡ä¾å¼å§æå»ºä½ çè¯ä¼°ä½ç³»">æè®­ä¸ï¼å«ç­äºï¼ä»20ä¸ªå¤±è´¥æ¡ä¾å¼å§æå»ºä½ çè¯ä¼°ä½ç³»</h3>
<p>å¢éå¨é¡¹ç®åæå¸¸å¸¸è®¤ä¸ºæå»ºè¯ä¼°ä½ç³»æ¯ä¸é¡¹å·¨å¤§çâå¼éâï¼ä¼ææ¢äº§åä¸å¸çè¿åº¦ï¼å æ­¤éæ©æ¨è¿ãä»ä»¬è®¤ä¸ºï¼ç­äº§ååè½ç¨³å®ãè§æ¨¡åä¹ååæ¥èèè¯ä¼°ä¹ä¸è¿ã</p>
<p>ç¶èï¼Anthropicçç»éªæ°æ°ç¸åï¼ç­å°æºè½ä½è§æ¨¡ååæå¼å§æå»ºè¯ä¼°ï¼ä½ ä¼éå°æ´å¤§çå°é¾ãæ´éè¦çæ¯ï¼è¯ä¼°çä»·å¼ä¼éçæ¶é´å¤å©å¢é¿ãæ©ææå¥ä¸ä»ä¸ä¼ææ¢ä½ ï¼åèä¼æä¸ºæªæ¥å éè¿­ä»£çå¼æãé£ä¹ï¼è¯¥å¦ä½å¼å§å¢ï¼å¶å®é¨æ§æ¯ä½ æ³è±¡çè¦ä½å¾å¤ï¼</p>
<p>âå®éä¸ï¼ä¸å¥ç±20-50ä¸ªæºèªçå®å¤±è´¥æ¡ä¾çç®åä»»å¡ï¼å°±æ¯ä¸ä¸ªç»ä½³çèµ·ç¹ãâ</p>
<p>è¿ä¸ªè§ç¹ä¹æä»¥éè¦ï¼æ¯å ä¸ºå®å½»åºæç ´äºâè¯ä¼°ä½ç³»å¿é¡»åºå¤§èå®ç¾âçè¯¯åºãè¿ä¸ä»ä»æ¯å³äºé¿åææ¯åºï¼æ´æ¯ä¸ºäºè·å¾å¼åè¿ç¨ä¸­çè½è§åº¦ãç¨ä¸å°ç»çå®çå¤±è´¥æ¡ä¾èµ·æ­¥ï¼å°±ç­äºä¸ºä½ çé©¾é©¶è±å®è£äºç¬¬ä¸æ¹ä»ªè¡¨ï¼è®©ä½ åæ­¢âç²ç®é£è¡âï¼å¼å§ç¨æ°æ®å¯¼èªã</p>
<h3 id="æè®­äºå½ä½ çæºè½ä½å¤±è´¥æ¶å¯è½æ°æ°æ¯å¤©æçä½ç°">æè®­äºï¼å½ä½ çæºè½ä½âå¤±è´¥âæ¶ï¼å¯è½æ°æ°æ¯å¤©æçä½ç°</h3>
<p>æä»¬éå¸¸è®¤ä¸ºï¼è¯ä¼°å¤±è´¥å°±æå³çæºè½ä½ç¯äºéãä½ææ¶ï¼è¿ç§âå¤±è´¥âæ°æ°æ¯å¶åè¶åé åçä½ç°ã</p>
<p>ä»¥Anthropicæå°ç Opus 4.5 æ¨¡åä¸ºä¾ï¼å¨ä¸ä¸ªé¢è®¢èªç­çæµè¯ä»»å¡ä¸­ï¼å®æ²¡æéµå¾ªé¢è®¾çæµç¨ï¼èæ¯éè¿åç°æ¿ç­ä¸­çä¸ä¸ªæ¼æ´ï¼ä¸ºç¨æ·æ¾å°äºä¸ä¸ªæ´å¥½çè§£å³æ¹æ¡ãä»å­é¢ä¸çï¼å®âå¤±è´¥âäºè¿æ¬¡è¯ä¼°ï¼å ä¸ºå®æ²¡ææç§äººç±»è®¾è®¡çæ­»æ¿è·¯å¾æ§è¡ä»»å¡ãä½ä»ç¨æ·çè§åº¦çï¼å®åå¾äºå·¨å¤§çæåã</p>
<p>âå®âå¤±è´¥âäºä¹¦é¢ä¸çè¯ä¼°ï¼ä½å®éä¸ä¸ºç¨æ·æ³åºäºä¸ä¸ªæ´å¥½çè§£å³æ¹æ¡ãâ</p>
<p>è¿ä¸ªä¾å­æ·±å»å°æ­ç¤ºäºéæè¯ä¼°çå±éæ§ãè¿å¹¶éç®åçç¨åºéè¯¯ï¼èæ¯åæ²¿æ¨¡åçä¸ä¸ªå¸åç¹å¾ï¼å®ä»¬çè§£å³é®é¢çè½åï¼å·²ç»å¼å§è¶è¶é£äºåµå¥å¨æ§å¼è¯ä¼°éçãåºäºéæè§åçåè®¾ãä¾èµåµåçè·¯å¾è¯ä¼°æ å¼äºå¦ä¸ç§âç²ç®é£è¡âï¼å ä¸ºå®è®©ä½ å¯¹æ¨¡åèªèº«çå¤©æä¹å¤è§èä¸è§ãå­¦ä¼è¯å«è¿äºâå¤©æè¬âçå¤±è´¥ï¼æè½è®©ä½ çæ­£çæ¸ä½ æè§£éçåæ²¿è½åã</p>
<h3 id="æè®­ä¸è¯ä¼°ç»ç¹èéè¿ç¨">æè®­ä¸ï¼è¯ä¼°ç»ç¹ï¼èéè¿ç¨</h3>
<p>å¨è¯ä¼°æºè½ä½æ¶ï¼ä¸ä¸ªå¸¸è§çéè¯¯æ¯æ£æ¥å®æ¯å¦éµå¾ªäºä¸å¥éå¸¸å·ä½çæ­¥éª¤ï¼æ¯å¦æ¯å¦æç§ç¹å®é¡ºåºè°ç¨äºæäºå·¥å·ãè¿ç§æ¹æ³çä¼¼ä¸¥è°¨ï¼å®åéå¸¸èå¼±ã</p>
<p>Anthropicæåºï¼è¿ç§æ¹æ³âè¿äºåµåï¼ä¼å¯¼è´æµè¯è¿äºèå¼±âï¼å ä¸ºå®ä¼æ©ç½é£äºè¯ä¼°è®¾è®¡èæªæ¾é¢æå°çãåæ ·ææçåæ°æ¹æ³ãä¸ä¸ªæ´ä¼è¶ãæ´å·åç»æ§çåæ³æ¯ï¼è¯ä¼°æºè½ä½æç»äº§åºçææï¼outcomeï¼ï¼èä¸æ¯å®æéåçå·ä½è·¯å¾ï¼pathï¼ã</p>
<p>ä¾å¦ï¼ä¸å¶æ£æ¥ä¸ä¸ªç¼ç æºè½ä½æ¯å¦è°ç¨äºæä¸ªç¹å®çç¼è¾å½æ°ï¼ä¸å¦ç´æ¥è¯ä¼°å®çæçä»£ç æ¯å¦éè¿äºææçååæµè¯ãä¸æ³¨äºè¿ç¨æ¬èº«å°±æ¯ä¸ç§âç²ç®é£è¡âï¼å ä¸ºå®è®©ä½ å¯¹é£äºæ´ä¼è¶ãæªæ¾é¢è§çè§£å³æ¹æ¡è§èä¸è§ãèä¸æ³¨äºæç»ææï¼ææ¯è·å¾æºè½ä½ç©¶ç«ä¸ºç¨æ·å®æäºä»ä¹ççå®è§éãè¿ä¸æè®­å¯¹äºéæ¾AIæºè½ä½çå¨é¨æ½åè³å³éè¦ã</p>
<h3 id="æè®­åä½ çææ å¨è¡¡éä»ä¹ä¸æ¬¡æåè¿æ¯æ¬¡æ¬¡å¯é ">æè®­åï¼ä½ çææ å¨è¡¡éä»ä¹ï¼ä¸æ¬¡æåè¿æ¯æ¬¡æ¬¡å¯é ï¼</h3>
<p>âæä»¬çæºè½ä½æåçæ¯75%ãâ è¿å¥è¯å¬èµ·æ¥ä¸éï¼ä½å®å¯è½éèçå·¨å¤§çè¯¯å¯¼æ§ãä½ éè¦é®ä¸ä¸ªæ´æ·±å±æ¬¡çé®é¢ï¼è¿ä¸ªæåçè¡¡éçæ¯ä»ä¹ï¼æ¯å¤æ¬¡å°è¯ä¸­çä¸æ¬¡æåï¼è¿æ¯æ¯ä¸æ¬¡å°è¯é½å¿é¡»æåï¼è¿éæä¸¤ä¸ªå³é®ææ ï¼pass@k å pass^kã</p>
<ul>
<li>pass@k è¡¡éçæ¯æºè½ä½å¨ k æ¬¡å°è¯ä¸­è³å°æä¸æ¬¡æåçå¯è½æ§ãä½ å¯ä»¥æå®æ¯ä½âå¤æ¬¡å°é¨ï¼åªè¦è¿ä¸ä¸ªçå°±ç®æåâãè¿ä¸ªææ éç¨äºé£äºåªè¦æ¾å°ä¸ä¸ªå¯è¡è§£å°±è¡çåºæ¯ï¼æ¯å¦ä»£ç çææåæææã</li>
<li>pass^k è¡¡éçæ¯æºè½ä½å¨å¨é¨ k æ¬¡å°è¯ä¸­æ¯æ¬¡é½æåçæ¦çãè¿æ´åæ¯âè¦æ±æ¯æ¬¡å°é¨é½å¿é¡»å½ä¸­âãå¯¹äºéè¦é«åº¦å¯é åä¸è´æ§çé¢åå®¢æ·çæºè½ä½æ¥è¯´ï¼è¿ä¸ªææ è³å³éè¦ã</li>
</ul>
<p>è¿ä¸¤ä¸ªææ çå·®å¼å·¨å¤§ãä¾å¦ï¼å¦æä¸ä¸ªæºè½ä½çåæ¬¡æåçï¼pass@1ï¼æ¯75%ï¼é£ä¹å®è¿ç»­æå3æ¬¡çæ¦çï¼pass^3ï¼å°±éª¤éè³42.1875%ï¼çº¦ç­äº42% (0.75 x 0.75 x 0.75)ã</p>
<p>ä¸ºéè¦é«å¯é æ§çé¢åå®¢æ·çæºè½ä½ä½¿ç¨ pass@k ææ ï¼æ¯å¯¼è´ç¨æ·æµå¤±çæ¸©åºãå ä¸º75%çåæ¬¡æåçæ©çäºå¨ä»ä»ä¸æ¬¡äº¤äºä¸­ï¼æ§è½ç¨³å®ççè³ä¸è¶³50%çæ®é·äºå®ãè¿ä¸ä»ä»æ¯ç»è®¡å­¦ä¸çéæ©ï¼æ´æ¯å³å®äº§åå®ä½çæç¥ææ©ãä½ æ¯å¨æé ä¸ä¸ªåææ§çå¤´èé£æ´ä¼ä¼´ï¼åæ¬¡å°è¯æä¸æ¬¡ç»å¦ç¹å­å°±ç®å·¨å¤§æåï¼pass@kï¼ï¼è¿æ¯å¨æå»ºä¸ä¸ªå³é®ä»»å¡åæ¯æå©æï¼ä»»ä½ä½äºè¿ä¹å®ç¾çå¯é æ§é½æ¯ä¸å¯æ¥åçï¼pass^kï¼ï¼ä½ çææ éæ©ï¼å³å®äºä½ çä¼åæ¹åã</p>
<h3 id="æè®­äºä½ æå¼ºå¤§çè¯ä¼°å·¥å·ä¸æ¯ä»£ç èæ¯ä½ çç¼ç">æè®­äºï¼ä½ æå¼ºå¤§çè¯ä¼°å·¥å·ä¸æ¯ä»£ç ï¼èæ¯ä½ çç¼ç</h3>
<p>å¨è¿½æ±èªå¨åçè¿ç¨ä¸­ï¼æä»¬å¾å®¹æè¿åº¦ä¾èµå·å°å°çè¯ä¼°åæ°ãç¶èï¼åæ°å¯è½æ¯éªäººçãä¸ä¸ªè¯¯å¯¼æ§çä½åå¯è½ä¸æ¯å ä¸ºæºè½ä½å¤±è´¥äºï¼èæ¯å ä¸ºè¯ä¼°æ¬èº«å­å¨ç¼ºé·ã</p>
<p>ä¾å¦ï¼Anthropicå¨å¯¹Opus 4.5æ¨¡åè¿è¡CORE-Benchåºåæµè¯æ¶ï¼éè¿äººå·¥å®¡æ¥è®°å½åç°ï¼å¶åæ°ä»æåç42%è·åè³95%ãåå ä½å¨ï¼ä»ä»æ¯ä¿®å¤äºè¯ä¼°ç³»ç»ä¸­çé®é¢ï¼æ¯å¦è¿äºåµåçè¯åæ åï¼å®ä¼å ä¸ºâ96.12âä¸é¢ææ ¼å¼â96.124991â¦âä¸å®å¨å¹éèå¤å®ä¸ºéè¯¯ï¼ãå¦ææ²¡æéè¯»å®æ´çè¯éªè®°å½ï¼transcriptï¼ï¼å¢éä¼éè¯¯å°è®¤ä¸ºæ¨¡åçè½åè¿æ¯å®éæåµè¦å·®ã</p>
<p>âéè¯»è®°å½æ¯éªè¯ä½ çè¯ä¼°æ¯å¦å¨è¡¡éçæ­£éè¦çäºæçæ¹å¼ï¼ä¹æ¯æºè½ä½å¼åçä¸é¡¹å³é®æè½ãâ</p>
<p>ä¿¡ä»»åæ°èä¸å»éè¯»è®°å½ï¼æ¯ç»æçâç²ç®é£è¡âââä»ªè¡¨çæ¾ç¤ºä½ å¨æ¥éä¸å ï¼ä½å®éä¸ä½ å¯è½é£å¾æ¯ä»¥å¾ä»»ä½æ¶åé½é«ï¼åªæ¯ä½ çä»ªè¡¨åäºãèªå¨åå·¥å·åè¯ä½ âæ¯ä»ä¹âï¼åæ°æ¯42%ï¼ï¼ä½åªææ·±å¥å®¡æ¥è®°å½æè½æ­ç¤ºâä¸ºä»ä¹âââä¸æ¯å ä¸ºæ¨¡åä¸è¡ï¼èæ¯å ä¸ºè¯ä¼°æ¬èº«å­å¨ç¼ºé·ã</p>
<h2 id="ç»è®ºå°è¯ä¼°è§ä¸ºæ ¸å¿æç¥èéäºåå¼¥è¡¥">ç»è®ºï¼å°è¯ä¼°è§ä¸ºæ ¸å¿æç¥ï¼èéäºåå¼¥è¡¥</h2>
<p>ææçè¯ä¼°ä¸æ¯å¼åè¿ç¨ä¸­çè´æï¼èæ¯ä¸ç§è½å¤å éå¼åãç¡®ä¿è´¨éçæ ¸å¿æç¥èµäº§ãå®è½å°å¢éæåæ¨¡ç³çâæè§åå·®äºâè½¬åä¸ºäºæ¸æ°ãå¯æä½çè¡¡éææ ã</p>
<p>æåçAIå¢éé½æç½ä¸ä¸ªéçï¼è¯ä¼°ä½ç³»æ¯äº§åä¸å¯æç¼ºçä¸é¨åï¼å¶éè¦æ§ä¸äºäºååæµè¯ä¹äºä¼ ç»è½¯ä»¶ãèä¸ï¼å¨æ¨¡åè½åé£éåå±çæ¶ä»£ï¼ä¸ä¸ªå¼ºå¤§çè¯ä¼°å¥ä»¶å°±æ¯ä½ çæ¤åæ²³ãå®è½è®©ä½ å¨å å¤©åéªè¯å¹¶é¨ç½²æ´åè¿çæ¨¡åï¼èä½ çç«äºå¯¹æå¯è½è¿å¨æ°å¨çæå¨æµè¯ä¸­è¦è¦æ£æã</p>
<p>å¦æä½ çè¯ä¼°ä½ç³»åæ äºä½ æçéçä¸è¥¿ï¼é£ä¹å®æ­£å¨è®²è¿°ä¸ä¸ªå³äºä½ æºè½ä½çæ ¸å¿æäºã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 14:23">2026-01-13 14:22</span>&nbsp;
<a href="https://www.cnblogs.com/didispace">ç¨åºç¿DD</a>&nbsp;
éè¯»(<span id="post_view_count">44</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19477137);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19477137', targetLink: 'https://www.cnblogs.com/didispace/p/19477137', title: 'Anthropic å¦ä½è¯ä¼° AI Agent' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>