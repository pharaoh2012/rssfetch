<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-02-06T04:15:34.871Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ ä»åè°å½æ°å°Promise ]]></title>
    <link>https://www.cnblogs.com/LFeather/p/19583059</link>
    <guid>1359c131e472bccb9c10b337744bddeb</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/LFeather/p/19583059" title="åå¸äº 2026-02-06 10:47">
    <span role="heading" aria-level="2">ä»åè°å½æ°å°Promise</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æè¿å¨é¢è¯ä¸­éå°äºå¾å¤å³äº <code>Promise</code> çé®é¢ï¼å ä¸ºä»¥åçä¸å¡å¨è¯·æ±æ¹é¢å¹¶ä¸å¤æï¼å¤æ°æ¶åé½æ¯å¨ç¨ <code>async/await</code>ï¼å¯¹ <code>Promise</code> ççè§£è¿æ¯æææ¬ ç¼ºï¼æè¿éæ°å­¦ä¹ äºä¸ä¸ <code>Promise</code>ï¼å°½éé¿ååæAPIå¼çæç« ï¼ä¸»è¦è¿æ¯ç»åèªå·±çä¸äºçè§£åæèæ¥æ´çä¸ä¸ã</p>
<h2 id="ä¸ºä»ä¹è¦ä½¿ç¨-promise">ä¸ºä»ä¹è¦ä½¿ç¨ Promise</h2>
<p>ä¼æå¨ç¥ï¼JavaScript çä¸»çº¿ç¨æ¯åçº¿ç¨æ§è¡çï¼ææçåæ­¥ä»£ç é½æ¯å¨ä¸ä¸ªçº¿ç¨ä¸­æ§è¡çï¼å½éå°ä¸äºèæ¶æä½æ¶ï¼æ¯å¦ç½ç»è¯·æ±ãæä»¶è¯»åç­ï¼ï¼å¦æéç¨åæ­¥çæ¹å¼å»å¤çè¿äºæä½ï¼å°±ä¼é»å¡ä¸»çº¿ç¨ï¼å¯¼è´é¡µé¢å¡é¡¿ï¼ç¨æ·ä½éªåå·®ãä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼æä»¬åæäºå¼æ­¥ç¼ç¨ï¼ææ©çå¼æ­¥ç¼ç¨æ¹å¼æ¯åè°å½æ°ï¼Callbackï¼ï¼æä»¬åçä¸ä¸ªç®åçä¾å­ï¼</p>
<pre><code class="language-javascript">function add(getX, getY, finalCallback) {
  var x, y;
  getX(function (xVal) {
    x = xVal;
    if (y !== undefined) {
      finalCallback(x + y);
    }
  });

  getY(function (yVal) {
    y = yVal;
    if (x !== undefined) {
      finalCallback(x + y);
    }
  });
}

function fetchX(xCallback) {
  setTimeout(function () {
    xCallback(2);
  }, 1000);
}

function fetchY(yCallback) {
  setTimeout(function () {
    yCallback(3);
  }, 1000);
}

add(fetchX, fetchY, function (sum) {
  console.log("Sum is: " + sum);
});
</code></pre>
<p><code>fetchX</code> å <code>fetchY</code> æ¯ä¸¤ä¸ªå¼æ­¥å½æ°ï¼åå«æ¨¡æä»æå¡å¨è·åæ°æ®çè¿ç¨ï¼æä»¬è¦è¿è¡ <code>x+y</code> çè®¡ç®ï¼å¦æå®ä»¬ä¸­çä»»ä½ä¸ä¸ªè¿æ²¡æåå¤å¥½ï¼å°±ç­å¾ä¸¤èé½åå¤å¥½ãæä»¬éæ­¥æè§£è¿ä¸ªè¿ç¨ï¼</p>
<ol>
<li>
<p>è°ç¨ <code>add</code> å½æ°ï¼ä¼ å¥ <code>fetchX</code>ã<code>fetchY</code> ååè°å½æ°ã</p>
</li>
<li>
<p>å¨ <code>add</code> å½æ°åé¨ï¼è°ç¨ <code>getX</code>ï¼å³ <code>fetchX</code>ï¼ï¼ä¼ å¥ä¸ä¸ªåè°å½æ°ã</p>
</li>
</ol>
<pre><code class="language-JavaScript">function (xVal) {
  x = xVal;
  if (y !== undefined) {
    finalCallback(x + y);
  }
}
</code></pre>
<ol start="3">
<li>
<p><code>fetchX</code> å¼å§æ§è¡ï¼ç»è¿1ç§éåï¼è°ç¨ä¼ å¥çåè°å½æ°ï¼<code>xCallback</code>ï¼ï¼å° <code>2</code> ä½ä¸ºåæ°ä¼ éè¿å»ã</p>
</li>
<li>
<p>åè°å½æ°æ§è¡ï¼<code>x</code> è¢«èµå¼ä¸º <code>2</code>ï¼ç¶åæ£æ¥ <code>y</code> æ¯å¦å·²ç»åå¤å¥½ï¼å³ <code>y</code> æ¯å¦ä¸ä¸º <code>undefined</code>ï¼ãæ­¤æ¶ <code>y</code> è¿æ²¡æåå¤å¥½ï¼æä»¥ä¸ä¼è°ç¨æç»ç <code>finalCallback</code>ã</p>
</li>
<li>
<p>åæ ·çè¿ç¨åçå¨ <code>getY</code>ï¼å³ <code>fetchY</code>ï¼ä¸ï¼ç»è¿1ç§éåï¼<code>y</code> è¢«èµå¼ä¸º <code>3</code>ï¼ç¶åæ£æ¥ <code>x</code> æ¯å¦å·²ç»åå¤å¥½ãæ­¤æ¶ <code>x</code> å·²ç»åå¤å¥½äºï¼<code>x=2</code>ï¼ï¼æä»¥è°ç¨ <code>finalCallback</code>ï¼è®¡ç®åºæç»çç»æ <code>5</code>ï¼å¹¶æå°åºæ¥ã</p>
</li>
</ol>
<p>ä»è¿ä¸ªä¾å­ä¸­ï¼æä»¬æ¯å¦è½çåºä½¿ç¨åè°å½æ°æ¥å¤çå¼æ­¥æä½å­å¨ä¸äºé®é¢ï¼é¦åï¼ä¹è®¸è¿ä¸ªæè·¯å¾å·§å¦ï¼ä½æ¯ä»£ç å¾å¤æï¼æå¨éæ­¥æè§£åå¾é¾ç´æ¥çè§£è¿ä¸ªè¿ç¨ãå¶æ¬¡ï¼å¦æææ´å¤çå¼æ­¥æä½éè¦å¤çï¼ä»£ç ä¼åå¾æ´å å¤æï¼é¾ä»¥ç»´æ¤ï¼è¿å°±æ¯èåçâåè°å°ç±âé®é¢ã</p>
<p>åæ³æåä¸ç­æ¶ï¼ä½¿ç¨çè¿æ¯ jQueryï¼jQuery ç Ajax è¯·æ±å°±æ¯åºäºåè°å½æ°çï¼ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-javascript">$.ajax({
  url: "https://api.example.com/data",
  method: "GET",
  success: function (data) {
    console.log("Data received:", data);
    $.ajax({
      url: "https://api.example.com/more-data",
      method: "GET",
      success: function (moreData) {
        console.log("More data received:", moreData);
        // ç»§ç»­åµå¥æ´å¤çåè°...
      },
      error: function (err) {
        console.error("Error fetching more data:", err);
      },
    });
  },
  error: function (err) {
    console.error("Error fetching data:", err);
  },
});
</code></pre>
<p>æ¾ç¶ï¼éçåµå¥å±çº§çå¢å ï¼ä»£ç åå¾è¶æ¥è¶é¾ä»¥éè¯»åç»´æ¤ï¼èä¸éè¯¯å¤çä¹åå¾å¤æãæä»¥åæ¶è¿ä¸èçæ é¢ï¼å ä¸ºç¨åè°å½æ°æ¥å¤çå¼æ­¥æä½ç¡®å®å­å¨ä¸äºé®é¢ï¼</p>
<ol>
<li>å¯è¯»æ§å·®ï¼åµå¥çåè°å½æ°ä½¿ä»£ç é¾ä»¥çè§£ã</li>
<li>éè¯¯å¤çå¤æï¼æ¯ä¸ªåè°å½æ°é½éè¦åç¬å¤çéè¯¯ï¼å¯¼è´ä»£ç åé¿ã</li>
<li>æ§å¶æµå°é¾ï¼ç®¡çå¤ä¸ªå¼æ­¥æä½çé¡ºåºåä¾èµå³ç³»åå¾å¤æã</li>
</ol>
<p>ç­è®²å® <code>Promise</code> ä¹åæä»¬çä¸ <code>Promise</code> æ¯å¦è½è§£å³è¿äºé®é¢ã</p>
<h2 id="promise">Promise</h2>
<h3 id="æ¯ä»ä¹">æ¯ä»ä¹</h3>
<p>éä¿çè¯´ï¼æä»¬å¯ä»¥æ <code>Promise</code> çè§£æä¸ä¸ªå¼æ­¥æä½çä»£çï¼å®æ¯å¼æ­¥æä½çè¿åå¼ï¼åæ¬åªæåæ­¥æä½æè½æè¿åå¼ï¼å¼æ­¥æä½åªè½ä½¿ç¨æä»¬ä¸é¢æè¯´çåè°å½æ°åµå¥æ¥è·å¾ç»æã</p>
<blockquote>
<p>å¼æ­¥æ¹æ³ä¸ä¼ç«å³è¿åæç»å¼ï¼èæ¯è¿åä¸ä¸ª <code>Promise</code>ï¼ä»¥ä¾¿å¨å°æ¥çæä¸ªæ¶é´ç¹æä¾è¯¥å¼ã</p>
</blockquote>
<p><code>Promise</code> çåºæ¬ç¨æ³åºè¯¥é½å¾çæäºï¼æä»¬åå»ºä¸ä¸ª <code>Promise</code> çä¾å­ï¼</p>
<pre><code class="language-javascript">// ES6 åç Promise
const asyncTask = new Promise((resolve, reject) =&gt; {
  // æ¨¡æå¼æ­¥æä½ï¼æ¯å¦æ¥å£è¯·æ±ãæä»¶è¯»åï¼
  setTimeout(() =&gt; {
    const success = true;
    if (success) {
      resolve("æä½æå"); // æååè°
    } else {
      reject("æä½å¤±è´¥"); // å¤±è´¥åè°
    }
  }, 1000);
});

// è°ç¨ Promise
asyncTask
  .then((result) =&gt; console.log(result)) // è¾åºï¼æä½æå
  .catch((error) =&gt; console.log(error))
  .finally(() =&gt; console.log("æä½å®æ"));
</code></pre>
<p>å¯ä»¥çå°ï¼æä»¬æå¼æ­¥æä½ <code>setTimeout</code> åè£å¨ <code>Promise</code> ä¸­ï¼ç¶åéè¿ <code>then</code>ã<code>catch</code> å <code>finally</code> æ¥å¤çç»æåéè¯¯ï¼<code>setTimeout</code> å¯ä»¥æ¯ä»»æå¼æ­¥æä½ï¼æ¯å¦ç½ç»è¯·æ±ãæä»¶è¯»åç­ã</p>
<p>éèå¨è¿äº API ä¹ä¸çè¿æä¸ä¸ªåæ°ï¼ä¸ä¸ª <code>Promise</code> å¿ç¶å¤äºä»¥ä¸ä¸ç§ç¶æä¹ä¸ï¼</p>
<ul>
<li><strong><code>Pending</code>ï¼è¿è¡ä¸­ï¼</strong>ï¼åå§ç¶æï¼æ¢ä¸æ¯æåï¼ä¹ä¸æ¯å¤±è´¥ã</li>
<li><strong><code>Fulfilled</code>ï¼å·²æåï¼</strong>ï¼æä½æåå®æã</li>
<li><strong><code>Rejected</code>ï¼å·²å¤±è´¥ï¼</strong>ï¼æä½å¤±è´¥ã</li>
</ul>
<p>è¿ä¸é¨ååå®¹å¯ä»¥åè MDN ç <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener nofollow">Promise - JavaScript | MDN</a>ï¼è®²å¾å¾æ¸æ¥ã</p>
<p><img src="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/promises.png" alt="" loading="lazy"></p>
<p>åèè¿å¼ å¾ï¼<code>Pending</code> ç¶æéåä¸¤ä¸ªç»æï¼<code>Fulfilled</code> å <code>Rejected</code>ï¼è¿ä¸ªè¿ç¨æ¯ååä¸å¯éçï¼ä¸æ¦ç¶ææ¹åï¼å°±ä¼æ°¸ä¹ä¿æè¯¥ç¶æãå½ä»»æä¸ç§æåµåçæ¶ï¼<code>then</code> æ¹æ³æ³¨åçåè°å½æ°å°±ä¼è¢«è°ç¨ï¼å³ä¸åå¤äº"å¾å®"ï¼<code>Pending</code>ï¼ç¶æï¼ç§°ä¹ä¸º"å·²æ²å®"ï¼<code>Settled</code>ï¼ã</p>
<h4 id="rejected">Rejected</h4>
<p>æä»¬åç <code>Rejected</code> çæåµï¼</p>
<pre><code class="language-JavaScript">// catch
const failedTask = new Promise((resolve, reject) =&gt; {
  setTimeout(() =&gt; {
    reject("æä½å¤±è´¥"); // å¤±è´¥åè°
  }, 1000);
});

failedTask
  .then((result) =&gt; console.log(result))
  .catch((error) =&gt; console.log(error)) // è¾åºï¼æä½å¤±è´¥
  .finally(() =&gt; console.log("æä½å®æ"));

// then ç¬¬äºä¸ªåæ°
const anotherFailedTask = new Promise((resolve, reject) =&gt; {
  setTimeout(() =&gt; {
    reject("æä½å¤±è´¥"); // å¤±è´¥åè°
  }, 1000);
});

anotherFailedTask
  .then(
    (result) =&gt; console.log("æåï¼" + result),
    (error) =&gt; console.log("å¤±è´¥ï¼" + error),
  ) // è¾åºï¼æä½å¤±è´¥
  .finally(() =&gt; console.log("æä½å®æ"));
</code></pre>
<p>æä¸¤ç§æ¹å¼å¯ä»¥æè· <code>Promise</code> çæç»ç¶æï¼ä¸ç§æ¯ä½¿ç¨ <code>catch</code> æ¹æ³ï¼å¦ä¸ç§æ¯å°éè¯¯å¤çå½æ°ä½ä¸º <code>then</code> æ¹æ³çç¬¬äºä¸ªåæ°ä¼ å¥ãä¸¤ç§æ¹å¼é½è½ææå°å¤ç <code>Promise</code> çæç»ç¶æï¼å¦æä¸è¿è¡éè¯¯å¤çï¼æªæè·çæç»ä¼å¯¼è´æªå¤çç <code>Promise</code> æç»è­¦åãæ´è¯¦ç»çè¯´ææä»¬åé¢åèï¼è¿éåªçç¨æ³ã</p>
<h4 id="fulfilled">Fulfilled</h4>
<p>å¨æé å¨ <code>Promise(..)</code> ä¸­ï¼æä»¬éå¸¸ç¨ä¸¤ä¸ªåè°å½æ°æ¥è¡¨ç¤ºæååå¤±è´¥çæåµï¼è¿ä¸¤ä¸ªå½æ°çå½åå¹¶ä¸åºå®ï¼éå¸¸æä»¬ä½¿ç¨ <code>resolve</code> å <code>reject</code>ï¼<code>reject</code> å¾æ¸æ¥å°è¡¨ç¤ºå¤±è´¥ï¼å¹¶ä¸ä»£è¡¨ <code>Promise</code> è¿å¥ <code>Rejected</code> ç¶æï¼èæåçåè°å½æ° <code>resolve</code>ï¼å³è®®ï¼ï¼å®è¡¨ç¤º <code>Promise</code> è¿å¥ <code>Fulfilled</code> ç¶æï¼è¿éç¨ ES6 è§èä¸­çåè°å½åæ¥è¯´æï¼</p>
<pre><code class="language-JavaScript">myPromise.then((result) =&gt; onFulfilled, onRejected)
</code></pre>
<h4 id="é¾å¼è°ç¨">é¾å¼è°ç¨</h4>
<p>å¨æå° <code>Promise</code> æ¶ï¼é¾å¼è°ç¨æ¯ä¸ä¸ªéå¸¸éè¦çæ¦å¿µï¼ä¸é¢çä¾å­ä¸­ï¼æä»¬çå° <code>Promise</code> å¯¹è±¡å¯ä»¥è°ç¨ <code>then</code> æ¹æ³ï¼è <code>then</code> æ¹æ³åå¯ä»¥è°ç¨ <code>catch</code> å <code>finally</code> æ¹æ³ï¼å ä¸º <code>then</code> æ¹æ³è¿åçä»ç¶æ¯ä¸ä¸ª <code>Promise</code> å¯¹è±¡ï¼è <code>catch</code> å <code>finally</code> æ¹æ³åå¨åé¨è°ç¨çä¹æ¯ <code>then</code> æ¹æ³ï¼è¿æ ·å®ä»¬å°±å¯ä»¥é¾å¼è°ç¨ã</p>
<pre><code class="language-JavaScript">// Promise.resolveè¿ç§åæ³æä»¬ä¹åè®¨è®º
Promise.resolve('ç¬¬ä¸æ­¥ç»æ')
  .then(res =&gt; {
    console.log(res); // æå°ï¼ç¬¬ä¸æ­¥ç»æ
    // return æ®éå¼ â æ° Promise ç¶æä¸º fulfilled
    return 'ç¬¬äºæ­¥ç»æ';
  })
  .then(res =&gt; {
    console.log(res); // æå°ï¼ç¬¬äºæ­¥ç»æ
    // return æ° Promise â æ° Promise è·éè¯¥ Promise çç¶æ
    return Promise.resolve('ç¬¬ä¸æ­¥ç»æ');
  })
  .then(res =&gt; {
    console.log(res); // æå°ï¼ç¬¬ä¸æ­¥ç»æ
  });
</code></pre>
<p>éè¿ä¾å­å¯ä»¥çå°ï¼é¾å¼è°ç¨å¯ä»¥å°å¤ä¸ªå¼æ­¥æä½ä¸²èèµ·æ¥ï¼æ¯ä¸ª <code>then</code> æ¹æ³å¤çä¸ä¸ä¸ª <code>Promise</code> çç»æï¼è¿å°±è§£å³äºæä»¬æå¼å§æå°çåè°å°ç±é®é¢ï¼ä½¿ä»£ç æ´å æ¸æ°åæäºç»´æ¤ã</p>
<p>è¿ä¸ªä¾å­ä¸­è¿æä¸ä¸ªç»èï¼å¨ <code>then</code> æ¹æ³ä¸­éè¿ <code>return</code> æ¥ä¼ éå¼ï¼å½ä½¿ç¨ <code>return</code> è¿åä¸ä¸ªæ®éå¼æ¶ï¼æ°ç <code>Promise</code> ä¼è¿å¥ <code>Fulfilled</code> ç¶æï¼ä¹å¯ä»¥è¿åä¸ä¸ªæ°ç <code>Promise</code> å¯¹è±¡ï¼è¿æ ·æ°ç <code>Promise</code> ä¼è·éè¯¥ <code>Promise</code> çç¶æãå¼å¾æ³¨æçæ¯ï¼å¦æè¿åçæ¯ä¸ä¸ª <code>thenable</code> å¯¹è±¡ï¼å·æ <code>then</code> æ¹æ³çå¯¹è±¡ï¼ï¼<code>Promise</code> ä¹ä¼ç­å¾è¯¥å¯¹è±¡è§£å³ï¼è¿ä½¿å¾ <code>Promise</code> å¯ä»¥ä¸å¶ä»å®ç°äºç±» <code>Promise</code> æ¥å£çåºè¿è¡äºæä½ã</p>
<p>å¤§ä½ä¸æä»¬äºè§£äº <code>Promise</code> çç¨æ³ï¼æä»¬ç¨ <code>Promise</code> æ¥å®ç°åµå¥å¼æ­¥æä½ï¼</p>
<pre><code class="language-JavaScript">function getFirstData() {
  // è¿åä¸ä¸ª Promiseï¼ç¨ setTimeout æ¨¡æå¼æ­¥
  return new Promise((resolve) =&gt; {
    setTimeout(() =&gt; {
      const data = "ç¬¬ä¸ä¸ªå¼æ­¥æä½çç»æ";
      console.log("Data received:", data);
      // å¼æ­¥æåï¼ä¼ éç»æç»ä¸ä¸ä¸ª .then()
      resolve(data);
    }, 1000);
  });
}

function getSecondData(prevData) {
  return new Promise((resolve) =&gt; {
    setTimeout(() =&gt; {
      const moreData = `ç¬¬äºä¸ªå¼æ­¥æä½çç»æï¼åºäºä¸ä¸æ­¥ï¼${prevData}ï¼`;
      console.log("More data received:", moreData);
      resolve(moreData); // å¯éï¼ç»§ç»­ä¼ éç»æç»åç»­é¾å¼è°ç¨
    }, 1000);
  });
}

// é¾å¼è°ç¨
getFirstData()
  .then((data) =&gt; {
    // ç¬¬ä¸ä¸ªå¼æ­¥æååï¼æ§è¡ç¬¬äºä¸ªå¼æ­¥
    return getSecondData(data);
  })
  .catch((err) =&gt; {
    // ç»ä¸æè·ææå¼æ­¥æä½çéè¯¯
    console.error("å¼æ­¥æä½åºéï¼", err);
  });
</code></pre>
<h3 id="promise-è§£å³äºä»ä¹é®é¢">Promise è§£å³äºä»ä¹é®é¢</h3>
<p>éè¿è¿ä¸ªä¾å­å¯ä»¥çå°ï¼æä»¬ä¸å¼å§æåºçåè°å½æ°çä¸ä¸ªé®é¢å¾å°äºä¸åç¨åº¦çè§£å³ï¼</p>
<ol>
<li><strong>å¯è¯»æ§æå</strong>ï¼éè¿é¾å¼è°ç¨ï¼ä»£ç ç»ææ´å æ¸æ°ï¼æ¯ä¸ªå¼æ­¥æä½é½å¨èªå·±ç <code>then</code> åä¸­å¤çï¼é¿åäºåµå¥åè°çå¤ææ§ã</li>
<li><strong>ç»ä¸éè¯¯å¤ç</strong>ï¼ä½¿ç¨ <code>catch</code> æ¹æ³å¯ä»¥ç»ä¸æè·ææå¼æ­¥æä½çéè¯¯ï¼ç®åäºéè¯¯å¤çé»è¾ã</li>
<li><strong>æ§å¶æµç®å</strong>ï¼éè¿é¾å¼è°ç¨ï¼å¯ä»¥æ´å®¹æå°ç®¡çå¤ä¸ªå¼æ­¥æä½çé¡ºåºåä¾èµå³ç³»ï¼ä½¿ä»£ç æ´æäºçè§£ã</li>
</ol>
<p>è¿éæç¹åä¸ç§ <code>if</code> è¯­å¥çæ¿ä»£åæ³ï¼</p>
<pre><code class="language-JavaScript">if (condition1) {
  // do something
  if (condition2) {
    // do something
    if (condition3) {
      // do something
    }
  }
}

// å¯ä»¥æ¹åä¸ºï¼

if(!condition1) return;
// do something
if(!condition2) return;
// do something
if(!condition3) return;
// do something

</code></pre>
<p>æ¢ä¸ªæè·¯ï¼ä½ç¨ç¸åï¼ä½ä»£ç çå¯è¯»æ§ä¼åé«ï¼ä¸è¿ <code>Promise</code> è¦å¤æå¾å¤ï¼ææ²¡æç´æ¥ä½¿ç¨ä¸å¼å§çåè°å½æ°çæ¬æ¥å¯¹æ¯ï¼å¹¶éåä¸å°ï¼èæ¯æ¶åäºæ°çç¥è¯ç¹ï¼éè¦ç¨å° <code>Promise</code> çä¸äº APIï¼ææç®æ¢ä¸ç§è§åº¦æ¥çè§£ï¼ç¶åæä»¬ååå¤´çè¿ä¸ªå¯¹æ¯ã</p>
<h3 id="promise-ç-api-ä¸åå">Promise ç API ä¸åå</h3>
<p><code>Promise</code> æ¯ ES6ï¼ES2015ï¼å¼å¥çä¸ç§ç¨äºå¤çå¼æ­¥æä½ç<strong>å¯¹è±¡</strong>ï¼æè¿ååäºä¸ç¯å³äºååçæç« ï¼<a href="https://www.cnblogs.com/LFeather/p/19312203" target="_blank">å¯¹äºååãååé¾åç»§æ¿ççè§£</a>ï¼è¿éå°±æ¯æ³ä»åååé¢åå¯¹è±¡çè§åº¦æ¥å æ·±ä¸ä¸çè§£ï¼æä»¬è¿æ¯ç¨åé¢çä¾å­ï¼åæ­¥æè§£ï¼</p>
<pre><code class="language-javascript">// ES6 åç Promise
const asyncTask = new Promise((resolve, reject) =&gt; {
  // æ¨¡æå¼æ­¥æä½ï¼æ¯å¦æ¥å£è¯·æ±ãæä»¶è¯»åï¼
  setTimeout(() =&gt; {
    const success = true;
    if (success) {
      resolve("æä½æå"); // æååè°
    } else {
      reject("æä½å¤±è´¥"); // å¤±è´¥åè°
    }
  }, 1000);
});

// è°ç¨ Promise
asyncTask
  .then((result) =&gt; console.log(result)) // è¾åºï¼æä½æå
  .catch((error) =&gt; console.log(error))
  .finally(() =&gt; console.log("æä½å®æ"));
</code></pre>
<h4 id="æé å½æ°-promise">æé å½æ° Promise()</h4>
<p>åä»æ ¸å¿è¯­å¥è¯´èµ·ï¼ <code>new Promise((resolve, reject) =&gt; { ... })</code> è¿éäºå³ä¸¤ä¸ªæ¦å¿µï¼æé å½æ°å <code>new</code>ã</p>
<p><code>Promise()</code> æ¯ä¸ä¸ªæé å¨ï¼Constructorï¼æèè¯´æé å½æ°ï¼ç¨äºåå»º <code>Promise</code> å¯¹è±¡ã</p>
<p>ä½¿ç¨æé å½æ°çå½¢å¼æ¥åå»ºå¯¹è±¡æå ä¸ªå¥½å¤ï¼</p>
<ol>
<li>
<p><strong>å°è£åå§åé»è¾</strong>ï¼<code>Promise</code> æé å½æ°åé¨å°è£äºåå§å <code>Promise</code> å¯¹è±¡æéçé»è¾ï¼æ¯å¦è®¾ç½®åå§ç¶æï¼<code>pending</code>ï¼ãè®¾ç½®åè°å½æ°ï¼<code>resolve</code> å <code>reject</code>ï¼ã</p>
</li>
<li>
<p><strong>å±äº«æ¹æ³</strong>ï¼éè¿æé å½æ°åå»ºçå¯¹è±¡å®ä¾å¯ä»¥å±äº«ååä¸çæ¹æ³ï¼å¦ <code>then</code>ã<code>catch</code>ã<code>finally</code>ï¼ï¼é¿åæ¯ä¸ªå®ä¾é½åå»ºä¸ä»½ç¸åçæ¹æ³ï¼èçåå­ã</p>
</li>
<li>
<p><strong>ç«å³æ§è¡</strong>ï¼å½æä»¬åå»ºä¸ä¸ªæ°ç <code>Promise</code> å®ä¾æ¶ï¼ä¼ å¥çæ§è¡å¨å½æ°ï¼executor functionï¼ä¼ç«å³æ§è¡ï¼è¿ä½¿å¾æä»¬å¯ä»¥å¨åå»º <code>Promise</code> çåæ¶å¼å§å¼æ­¥æä½ã</p>
</li>
</ol>
<p>è <code>new</code> å³é®å­ç¨äºåå»ºä¸ä¸ªæ°çå¯¹è±¡å®ä¾ï¼å¹¶å°å¶ååé¾æ¥å°æé å½æ°çååå¯¹è±¡ä¸ï¼ä¹å°±æ¯è®©æ°åå»ºçå¯¹è±¡ç»§æ¿æé å½æ°ååä¸çæ¹æ³åå±æ§ï¼ç»åä¸é¢çä¾å­å°±æ¯è¯´æä»¬åå»ºç <code>asyncTask</code> å¯¹è±¡ä¼ç»§æ¿ <code>Promise.prototype</code> ä¸çæ¹æ³ï¼æ¯å¦ <code>then</code>ã<code>catch</code> å <code>finally</code>ï¼è¿ä¹å°±æ¯ä¸ºä»ä¹æä»¬å¯ä»¥å¨ <code>asyncTask</code> ä¸è°ç¨è¿äºæ¹æ³ï¼ä»¥åè¿è¡åé¢æè¯´çé¾å¼è°ç¨ã</p>
<p>è¦æ³¨æçä¸ç¹æ¯ï¼æ§è¡å¨å½æ°çè¿åå¼å¯¹ <code>Promise</code> çå½±åæéï¼å¨ <code>then</code> æ¹æ³ä¸­æä»¬éè¿ <code>return</code> æ¥ä¼ éå¼ï¼ä½å¨æ§è¡å¨å½æ°ä¸­ <code>return</code> è¯­å¥ä»å½±åæ§å¶æµç¨ï¼å¹¶ä¸ä¼ç´æ¥æ¹å <code>Promise</code> çç¶æï¼<code>Promise</code> çç¶æåªè½éè¿è°ç¨ <code>resolve</code> æ <code>reject</code> æ¥æ¹åã</p>
<pre><code class="language-JavaScript">const myPromise = new Promise((resolve, reject) =&gt; {
  // ä¸äºå¼æ­¥æä½
  if (/* æä½æå */) {
    resolve("æåç»æ");
  } else {
    reject("å¤±è´¥åå ");
  }
  return "è¿ä¸ªè¿åå¼ä¸ä¼å½±å Promise çç¶æ";
});
</code></pre>
<h4 id="å¥å-resolve-reject-">å¥å (resolve, reject) =&gt;</h4>
<p>æ¥ä¸æ¥æä»¬çæé å½æ°çå¥å <code>(resolve, reject) =&gt; { ... }</code> ï¼ä¹å°±æ¯æ§è¡å¨å½æ°ï¼executor functionï¼ï¼å®ä¼å¨ <code>Promise</code> å®ä¾åå»ºæ¶ç«å³æ§è¡ï¼è¿ä¸ªä¸é¢è¯´è¿äºãä½¿ç¨ <code>Promise</code> æ¶ï¼æä»¬ä¸ä¼å³æ³¨æ§è¡å¨å½æ°ï¼ä¸»è¦æ¯ä½¿ç¨è¿ä¸ªå½æ°çå¥å <code>resolve</code> å <code>reject</code> ç¨æ¥æ¹å <code>Promise</code> çç¶æã</p>
<pre><code class="language-JavaScript">function executor(resolveFunc, rejectFunc) {
  // éå¸¸ï¼`executor` å½æ°ç¨äºå°è£æäºæ¥ååè°å½æ°ä½ä¸ºåæ°çå¼æ­¥æä½ï¼æ¯å¦ä¸é¢ç `setTimeout` å½æ°
}
</code></pre>
<p>å½è°ç¨ <code>resolve</code> æ <code>reject</code> æ¶ï¼<code>Promise</code> çç¶æä¼ç«å³æ¹åï¼ä» <code>pending</code> åä¸º <code>fulfilled</code> æ <code>rejected</code>ï¼ç¶åæ§è¡åè°å½æ°ï¼è¿ä¸ªåè°å½æ°å°±æ¯æä»¬éè¿ <code>then</code> æ¹æ³æ³¨åçå½æ°ã</p>
<pre><code class="language-JavaScript">const p = new Promise((resolve) =&gt; {
  console.log('1. æ§è¡å¨å½æ°ç«å³æ§è¡');
  resolve('æå');
  console.log('2. resolve è°ç¨å®æï¼åæ­¥ï¼');
});

console.log('3. Promise åå»ºå®æ');

p.then((value) =&gt; {
  console.log('5. then åè°æ§è¡:', value);
});

console.log('4. then æ¹æ³è°ç¨å®æ');

// è¾åºé¡ºåºï¼
// 1. æ§è¡å¨å½æ°ç«å³æ§è¡
// 2. resolve è°ç¨å®æï¼åæ­¥ï¼
// 3. Promise åå»ºå®æ
// 4. then æ¹æ³è°ç¨å®æ
// 5. then åè°æ§è¡: æå
</code></pre>
<p>ä½æä»¬ç¨å° <code>Promise</code> æ¶ä¸»è¦è¿æ¯ç¨äºå¼æ­¥ä»»å¡ï¼<code>then</code> æ¹æ³æ¯å¸åçå¾®ä»»å¡ï¼microtaskï¼ï¼å¦æ <code>then</code> æ¹æ³åæ§è¡ï¼éé¢çåè°å½æ°ä¼è¢«æ¾å¥å¾®ä»»å¡éåï¼ç­å¾å½åå®ä»»å¡æ§è¡å®æ¯ååæ§è¡ã</p>
<p>å¯¹äºæ´ç»è´çæ§è¡é¡ºåºï¼ä¹åæåè¿ä¸ç¯å³äºäºä»¶å¾ªç¯çæç« ï¼åå¥½æ¯ç¨ <code>Promise</code> ä¸¾ä¾ï¼å¯ä»¥åèï¼<a href="https://www.cnblogs.com/LFeather/p/16139014.html" target="_blank">æå³ JavaScript äºä»¶å¾ªç¯çè¥å¹²çé®æ¢ç©¶</a>ã</p>
<p><code>Promise</code> åé¨çå¤§è´é»è¾æ¯è¿æ ·çï¼</p>
<pre><code class="language-JavaScript">// Promise åé¨ç®åå®ç°
class MyPromise {
  constructor(executor) {
    this.state = 'pending';           // ç¶æ
    this.value = undefined;           // ç»æå¼
    this.onFulfilledCallbacks = [];   // â å­å¨ then çæååè°
    this.onRejectedCallbacks = [];    // â å­å¨ then çå¤±è´¥åè°

    const resolve = (value) =&gt; {
      if (this.state === 'pending') {
        this.state = 'fulfilled';
        this.value = value;
        // â å³é®ï¼éååè°éåï¼å°ææåè°å å¥å¾®ä»»å¡
        this.onFulfilledCallbacks.forEach(callback =&gt; {
          queueMicrotask(() =&gt; callback(value));
        });
      }
    };

    const reject = (reason) =&gt; {
      if (this.state === 'pending') {
        this.state = 'rejected';
        this.value = reason;
        this.onRejectedCallbacks.forEach(callback =&gt; {
          queueMicrotask(() =&gt; callback(reason));
        });
      }
    };

    executor(resolve, reject);
  }

  then(onFulfilled, onRejected) {
    // å¦æ Promise è¿æ¯ pendingï¼å°±æåè°å­èµ·æ¥
    if (this.state === 'pending') {
      this.onFulfilledCallbacks.push(onFulfilled);  // â å­å¨åè°
      this.onRejectedCallbacks.push(onRejected);
    }
    // å¦æ Promise å·²ç» fulfilledï¼ç«å³å°åè°å å¥å¾®ä»»å¡
    else if (this.state === 'fulfilled') {
      queueMicrotask(() =&gt; onFulfilled(this.value));
    }
    // å¦æ Promise å·²ç» rejected
    else if (this.state === 'rejected') {
      queueMicrotask(() =&gt; onRejected(this.value));
    }

    return new MyPromise(() =&gt; {}); // ç®åï¼å®éæ´å¤æ
  }
}
</code></pre>
<p>æä»¥ <code>then</code> ä¸­çåè°å½æ°è¢«æ§è¡çåææ¯ <code>resolve</code> æ <code>reject</code> è¢«è°ç¨å¹¶ä¸ <code>then</code> æ¹æ³ä¹è¢«è°ç¨ï¼è¿ä¹æ¯ <code>Promise</code> è½å¤çå¼æ­¥æä½çå³é®ã</p>
<h4 id="éææ¹æ³">éææ¹æ³</h4>
<p>ç®åæä¸ä¸ï¼éææ¹æ³æ¯ç´æ¥æè½½å¨æé å½æ°ä¸çæ¹æ³ï¼èä¸æ¯å®ä¾å¯¹è±¡ä¸ï¼ä»¥åé¢çä¾å­æ¥è¯´ï¼<code>asyncTask</code> æ¯ <code>Promise</code> çä¸ä¸ªå®ä¾å¯¹è±¡ï¼è <code>Promise.all(..)</code> å <code>Promise.resolve(..)</code> è¿ç§åæ¯ <code>Promise</code> æé å½æ°çä¸ä¸ªéææ¹æ³ã</p>
<p>åºäºä¸é¢çç®åä¾å­ï¼<code>Promise</code> å¤§ä½ä¸çç¨æ³æä»¬å·²ç»äºè§£äºï¼ä½è¿æå¾å¤ API æ²¡ææ¶åå°ï¼æä»¬å¯ä»¥éè¿æå° <code>Promise</code> çååæ¥æ¥çï¼</p>
<pre><code class="language-JavaScript">console.log(Promise.prototype);
</code></pre>
<p><img src="https://blog-1252364274.cos.ap-guangzhou.myqcloud.com/20260205173555584.png" alt="" loading="lazy"></p>
<p>æä»¬å¯ä»¥çå° <code>then</code>ã<code>catch</code> å <code>finally</code> æ¹æ³é½å¨ <code>Promise.prototype</code> ä¸ï¼è¿äºæ¹æ³æ¯å®ä¾æ¹æ³ï¼æå³çå®ä»¬å¯ä»¥è¢«ä»»ä½ <code>Promise</code> å®ä¾è°ç¨ã</p>
<p>ç±äºå®å¨æºå¶ï¼ç´æ¥æå° <code>Promise</code> æ¬èº«æ¯çä¸å°åçä»£ç çï¼æä»¬æ¢ä¸ç§æ¹å¼ï¼åªéè¦å¾å°éææ¹æ³åå°±è¡ï¼</p>
<pre><code class="language-JavaScript">console.log(Object.getOwnPropertyNames(Promise));

// è¾åºï¼['length', 'name', 'prototype', 'all', 'allSettled', 'any', 'race', 'resolve', 'reject', 'withResolvers', 'try']
</code></pre>
<p>è¾åºç»æä¸­æççææçä¸çæï¼å ä¸ºæä¹åå¯¹ <code>Promise</code> ä»åçå¨ä¼ç¨çå±é¢ï¼æä»¥æäºæçè³æ¯ç¬¬ä¸æ¬¡ç¥éï¼ä½æ²¡å³ç³»ï¼éè¿åååå¯¹ç§ MDN ææ¡£ï¼éä¸ªå­¦ä¹ ä¸ä¸ã <code>length</code>ã<code>name</code> å <code>prototype</code> æ¯å½æ°å¯¹è±¡çé»è®¤å±æ§ï¼æä»¬ä¸»è¦å³æ³¨å¶ä»çéææ¹æ³ï¼</p>
<ol>
<li><code>Promise.resolve(..)</code> å <code>Promise.reject(..)</code></li>
</ol>
<p>è¿ä¸¤ä¸ªæ¹æ³åºè¯¥æ¯æå¸¸è§çäºï¼ä¸é¢çä¾å­ä¸­ä¹ç¨å°è¿ï¼<code>reject</code> æ¯è¾ç®åï¼è¿åä¸ä¸ªæç»ç¶æç <code>Promise</code> å¯¹è±¡ï¼å¥åå°±æ¯æç»çåå ï¼</p>
<pre><code class="language-JavaScript">const promiseReject = Promise.reject(new Error("å¤±è´¥åå "));
promiseReject.catch((reason) =&gt; {
  console.log(reason.message);
  // Expected output: å¤±è´¥åå 
});

// æè
function resolved(result) {
  console.log("Resolved");
}

function rejected(result) {
  console.log("Rejected:", result);
}

const promiseReject2 = Promise.reject("å¤±è´¥åå ");
promiseReject2.then(resolved, rejected);
</code></pre>
<p><code>resolve</code> æ¹æ³åæ¯è¾å¤æä¸äºï¼å®æä¸¤ç§è¿åå½¢å¼ï¼1. å¦æå¥åæ¯ä¸ä¸ªæ®éå¼ï¼é <code>Promise</code> å¯¹è±¡ï¼ï¼åè¿åä¸ä¸ªä»¥è¯¥å¼ä¸ºç»æçå·²è§£å³ï¼<code>fulfilled</code>ï¼ç¶æç <code>Promise</code> å¯¹è±¡ï¼è¿ä¸ç¹ä¸ <code>reject</code> å¯¹åºï¼2. å¦æå¥åæ¯ä¸ä¸ª <code>Promise</code> å¯¹è±¡ï¼åè¿åè¯¥ <code>Promise</code> å¯¹è±¡æ¬èº«ã</p>
<pre><code class="language-JavaScript">// å¥åæ¯æ®éå¼
const promise1 = Promise.resolve(123);

promise1.then((value) =&gt; {
  console.log(value);
  // Expected output: 123
});

// å¥åæ¯ Promise å¯¹è±¡
const originalPromise = new Promise((resolve) =&gt; {
  setTimeout(() =&gt; {
    resolve("åå§ Promise ç»æ");
  }, 1000);
});

const promise2 = Promise.resolve(originalPromise);
promise2.then((value) =&gt; {
  console.log(value);
  // Expected output: åå§ Promise ç»æ
});
</code></pre>
<ol start="2">
<li><code>Promise.all(..)</code>ã<code>Promise.race(..)</code>ã<code>Promise.allSettled(..)</code> å <code>Promise.any(..)</code></li>
</ol>
<p>è¿åä¸ªæè§å¾å¯ä»¥æ¾ä¸èµ·ä»ç»ï¼å®ä»¬é½æ¯ç¨äºå¤çå¤ä¸ª <code>Promise</code> å¯¹è±¡çéææ¹æ³ï¼å¥åé½æ¯ä¸ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼éå¸¸æ¯æ°ç»ï¼ï¼åå«å¤ä¸ª <code>Promise</code> å¯¹è±¡ï¼è¿åä¸ä¸ªæ°ç <code>Promise</code> å¯¹è±¡ï¼å¶ä»çåºå«ç¨ä¸å¼ è¡¨æ ¼æ¥è¯´æï¼</p>
<table>
<thead>
<tr>
<th>æ¹æ³</th>
<th>æè¿°</th>
<th>è¿åå¼</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Promise.all(..)</code></td>
<td>å¨æåææåï¼ä¸å¤±è´¥å°±å¤±è´¥ã</td>
<td>æåæ¶è¿åä¸ä¸ªåå«ææç»æçæ°ç»ï¼å¤±è´¥æ¶è¿åç¬¬ä¸ä¸ªå¤±è´¥çåå ã</td>
</tr>
<tr>
<td><code>Promise.allSettled(..)</code></td>
<td>ç­ææå®æï¼æ è®ºæè´¥ã</td>
<td>ç»ææ¯ä¸ä¸ªåå«æ¯ä¸ª <code>Promise</code> ç»æç¶æçæ°ç»ã</td>
</tr>
<tr>
<td><code>Promise.any(..)</code></td>
<td>ä¸æåå°±æåï¼å¨å¤±è´¥æå¤±è´¥ã</td>
<td>æåæ¶è¿åç¬¬ä¸ä¸ªæåçç»æï¼å¤±è´¥æ¶è¿åä¸ä¸ª <code>AggregateError</code>ï¼åå«ææå¤±è´¥çåå ã</td>
</tr>
<tr>
<td><code>Promise.race(..)</code></td>
<td>è°åå®æï¼æè´¥åå¯ï¼ï¼å°±ç¨è°çç»æã</td>
<td>ç»ææ¯ç¬¬ä¸ä¸ªè§£å³ææç»ç <code>Promise</code> çç»ææåå ã</td>
</tr>
</tbody>
</table>
<p>å³äº <code>Promise.all(..)</code> çåºç¨ï¼æä»¬æå¼å§çåè°å½æ°å°±æ¯ä¸ä¸ªå¾å¥½çä¾å­ï¼æä»¬å¯ä»¥ç¨å®æ¥éåï¼</p>
<pre><code class="language-JavaScript">function fetchX() {
  return new Promise((resolve) =&gt; {
    setTimeout(() =&gt; {
      resolve(2);
    }, 1000);
  });
}
function fetchY() {
  return new Promise((resolve) =&gt; {
    setTimeout(() =&gt; {
      resolve(3);
    }, 1000);
  });
}

function add() {
  return Promise.all([fetchX(), fetchY()]).then(([x, y]) =&gt; x + y);
}

add().then((sum) =&gt; {
  console.log("Sum is: " + sum); // è¾åºï¼Sum is: 5
});
</code></pre>
<p>å¦ææä¸ä¸ªå¼æ­¥æä½ï¼</p>
<pre><code class="language-JavaScript">function fetchZ() {
  return new Promise((resolve) =&gt; {
    setTimeout(() =&gt; {
      resolve(4);
    }, 1000);
  });
}

function addThree() {
  return Promise.all([fetchX(), fetchY(), fetchZ()]).then(([x, y, z]) =&gt; x + y + z);
}
</code></pre>
<p>MDNä¸ç <code>Promise.allSettled(..)</code> ä¾å­ï¼</p>
<pre><code class="language-JavaScript">Promise.allSettled([
  Promise.resolve(33),
  new Promise((resolve) =&gt; setTimeout(() =&gt; resolve(66), 0)),
  99,
  Promise.reject(new Error("ä¸ä¸ªéè¯¯")),
]).then((values) =&gt; console.log(values));

// [
//   { status: 'fulfilled', value: 33 },
//   { status: 'fulfilled', value: 66 },
//   { status: 'fulfilled', value: 99 },
//   { status: 'rejected', reason: Error: ä¸ä¸ªéè¯¯ }
// ]
</code></pre>
<p>è¿éçè¿åå¼æäºä¸åï¼æ¯ä¸ä¸ªå¯¹è±¡æ°ç»ï¼æ¯ä¸ªå¯¹è±¡è¡¨ç¤ºå¯¹åº <code>Promise</code> çç¶æåç»æã</p>
<p><code>Promise.any(..)</code> çè¿åå¼æ¯ç¬¬ä¸ä¸ªæåçç»æï¼å¦æææ <code>Promise</code> é½å¤±è´¥äºï¼åè¿åä¸ä¸ª <code>AggregateError</code>ï¼å®åå«ææå¤±è´¥çåå ï¼</p>
<pre><code class="language-JavaScript">const promiseA = Promise.reject("å¤±è´¥åå  A");
const promiseB = Promise.reject("å¤±è´¥åå  B");

Promise.any([promiseA, promiseB])
  .then((value) =&gt; {
    console.log(value);
  })
  .catch((error) =&gt; {
    console.log(error);
  });

// è¾åºï¼AggregateError: All promises were rejected
</code></pre>
<p>ä¸å¶ä»ä¸ä¸ªæ¹æ³ä¸åï¼<code>Promise.race(..)</code> è¿åç <code>Promise</code> ç¶æçæ²å®æ»æ¯å¼æ­¥çï¼åé¢çä¸ç§æ¹æ³å¥åç <code>Promise</code> æ°ç»ä¸­æä¸ä¸ªçè³å¤ä¸ªæ¯å·²ç»è§£å³ï¼<code>fulfilled</code>ï¼ææç»ï¼<code>rejected</code>ï¼ç <code>Promise</code> å¯¹è±¡ï¼ç®åæ¥è¯´ï¼åä¸é¢çå¤§é¨åä¾å­ä¸æ ·ï¼æä»¬ä¼ å¥ä¸ä¸ªç¡®å®çå¼èä¸æ¯å¼æ­¥æ¹æ³ï¼ï¼é£ä¹ <code>Promise.all(..)</code>ã<code>Promise.allSettled(..)</code> å <code>Promise.any(..)</code> ä¼ç«å³è¿åç»æï¼è <code>Promise.race(..)</code> çè¿åå¼åæ¯å¼æ­¥çã</p>
<p>MDN éå¯¹æ¯ä¸ªæ¹æ³çè¿åå¼é½æè¯¦ç»çè¯´æï¼æ¯å¦è¯´ <code>Promise.all(..)</code> ï¼å¦æä¼ å¥çåæ°ä¸ºç©ºï¼åå®çç¶æä¼ç«å³åä¸º <strong>å·²è§£å³ï¼<code>fulfilled</code>ï¼</strong> å¦å¤ä¸¤ç§è¿åç¶æåä¸º <strong>å¼æ­¥åç°ï¼asynchronously fulfilledï¼</strong> å <strong>å¼æ­¥æç»ï¼asynchronously rejectedï¼</strong> ï¼è <code>Promise.any(..)</code> åæ¯ç¸åçï¼å¦æä¼ å¥çåæ°ä¸ºç©ºï¼åå®çç¶æä¼ç«å³åä¸º <strong>å·²æç»ï¼<code>rejected</code>ï¼</strong>ï¼å¶ä»æåµé½æ¯å¼æ­¥çã</p>
<p>å <code>Promise.race(..)</code> ä¼ å¥ä¸ä¸ªç©ºçå¯è¿­ä»£å¯¹è±¡ä¼å¯¼è´è¿åç <code>Promise</code> æ°¸è¿å¤äºæèµ·ç¶æï¼<code>pending</code>ï¼ï¼å ä¸ºæ²¡æä»»ä½ <code>Promise</code> å¯ä»¥åç°ææç»ã</p>
<pre><code class="language-JavaScript">const foreverPendingPromise = Promise.race([]);
console.log(foreverPendingPromise);
setTimeout(() =&gt; {
  console.log("å æ ç°å¨ä¸ºç©º");
  console.log(foreverPendingPromise);
});

// æé¡ºåºæå°ï¼
// Promise { &lt;state&gt;: "pending" }
// å æ ç°å¨ä¸ºç©º
// Promise { &lt;state&gt;: "pending" }
</code></pre>
<p><code>Promise.race(..)</code> çå¼æ­¥æ§æä»ä¹æä¹å¢ï¼åè®¾æä»¬æä¸ä¸ªç½ç»è¯·æ±æä½ï¼æä»¬å¸æå¨ä¸å®æ¶é´åè·å¾ååºï¼å¦åå°±æ¾å¼è¯·æ±ï¼è¿æ¶æä»¬å¯ä»¥ä½¿ç¨ <code>Promise.race(..)</code> æ¥å®ç°è¶æ¶æ§å¶ï¼</p>
<pre><code class="language-JavaScript">const data = Promise.race([
  fetch("/api"),
  new Promise((resolve, reject) =&gt; {
    // 5 ç§åæç»
    setTimeout(() =&gt; reject(new Error("è¯·æ±è¶æ¶")), 5000);
  }),
])
  .then((res) =&gt; res.json())
  .catch((err) =&gt; displayError(err));
</code></pre>
<ol start="3">
<li><code>Promise.try()</code></li>
</ol>
<blockquote>
<p><code>Promise.try()</code> éææ¹æ³æ¥åä¸ä¸ªä»»æç±»åçåè°å½æ°ï¼æ è®ºå¶æ¯åæ­¥æå¼æ­¥ï¼è¿åç»æææåºå¼å¸¸ï¼ï¼å¹¶å°å¶ç»æå°è£æä¸ä¸ª <code>Promise</code>ã</p>
</blockquote>
<p>è¿æ¯ä¸ä¸ªæªæ­¢å°ç®åï¼2026å¹´2æï¼ä»å¨ææ¡é¶æ®µç APIï¼å¨ä¸äºç°ä»£æµè§å¨å Node.js ææ°çæ¬ä¸­å·²ç»å¯ä»¥ä½¿ç¨ï¼ä½ç¨ç±»ä¼¼äº <code>async</code> å½æ°ï¼å¯ä»¥å°åæ­¥ä»£ç åå¼æ­¥ä»£ç ç»ä¸å¤çä¸º <code>Promise</code> å¯¹è±¡ï¼</p>
<pre><code class="language-JavaScript">Promise.try(() =&gt; {
  // è¿éå¯ä»¥æ¯åæ­¥ä»£ç 
  const result = synchronousFunction();
  return result;
})
  .then((value) =&gt; {
    console.log("åæ­¥ç»æ:", value);
  })
  .catch((error) =&gt; {
    console.error("éè¯¯:", error);
  });
// ä¹å¯ä»¥æ¯å¼æ­¥ä»£ç 
Promise.try(async () =&gt; {
  const result = await asynchronousFunction();
  return result;
})
  .then((value) =&gt; {
    console.log("å¼æ­¥ç»æ:", value);
  })
  .catch((error) =&gt; {
    console.error("éè¯¯:", error);
  });
</code></pre>
<ol start="4">
<li><code>Promise.withResolvers()</code></li>
</ol>
<blockquote>
<p><code>Promise.withResolvers()</code> éææ¹æ³è¿åä¸ä¸ªå¯¹è±¡ï¼å¶åå«ä¸ä¸ªæ°ç <code>Promise</code> å¯¹è±¡åä¸¤ä¸ªå½æ°ï¼ç¨äºè§£å³ææç»å®ï¼å¯¹åºäºä¼ å¥ç» <code>Promise()</code> æé å½æ°æ§è¡å¨çä¸¤ä¸ªåæ°ã</p>
</blockquote>
<p>å®å®å¨ç­ä»·äºä¸é¢çä»£ç ï¼</p>
<pre><code class="language-JavaScript">let resolve, reject;
const promise = new Promise((res, rej) =&gt; {
  resolve = res;
  reject = rej;
});
</code></pre>
<p>å®çä½ç¨æ¯ç®ååå»ºä¸ä¸ªå¯æ§ç <code>Promise</code> å¯¹è±¡ï¼æä»¬å¯ä»¥å¨å¤é¨è°ç¨ <code>resolve</code> å <code>reject</code> æ¥æ¹å <code>Promise</code> çç¶æï¼</p>
<pre><code class="language-JavaScript">const { promise, resolve, reject } = Promise.withResolvers();
// æ¨¡æå¼æ­¥æä½
setTimeout(() =&gt; {
  const success = true;
  if (success) {
    resolve("æä½æå");
  } else {
    reject("æä½å¤±è´¥");
  }
}, 1000);
promise
  .then((result) =&gt; console.log(result))
  .catch((error) =&gt; console.log(error))
  .finally(() =&gt; console.log("æä½å®æ"));
</code></pre>
<p>è¿ä¸ª API çä½¿ç¨åºæ¯æ¯è¾å°è§ï¼ç®åæè¿ä¸è½å®å¨çè§£å®çä½ç¨ï¼æå´è¶£å¯ä»¥å° MDN ä¸æ¥çã</p>
<h2 id="asyncawait-ä¸-promise">async/await ä¸ Promise</h2>
<p>æå¼å§å°±è¯´å° <code>async/await</code> äºï¼ææ¯åæ¥è§¦å° <code>async/await</code> è¿ç§åæ³çï¼ç¶åæäºè§£å°å®æ¯åºäº <code>Promise</code> çè¯­æ³ç³ï¼ä¸ªäººçè§£æ¥è¯´ï¼<code>async/await</code> è®©å¼æ­¥ä»£ç çèµ·æ¥æ´ååæ­¥ä»£ç ï¼ä¸»è¦æ¯æé«ä»£ç çå¯è¯»æ§åå¯ç»´æ¤æ§ï¼å°±å <code>Promise</code> ä¹äºåè°å½æ°ä¸æ ·ã</p>
<p>å¨ä½¿ç¨ä¸ï¼<code>async/await</code> çäºè®®éä¸­å¨æ¯å¦è¦ä½¿ç¨ <code>try/catch</code> æ¥å¤çéè¯¯ï¼æä¹åçå¤çæ¹å¼æ¯å¨è¯·æ±çå°è£éä½¿ç¨ <code>try/catch</code> æ¥æè·éè¯¯ï¼è°ç¨æ¶æ­£å¸¸ä½¿ç¨ <code>async/await</code> ï¼å¶ä»å°æ¹å¤çå¼æ­¥æä½è¿æ¯ç´æ¥ä½¿ç¨ <code>Promise</code>ãä»¥åå¶å®æ²¡æå¤ªæ·±å¥èèè¿åçæ§çé®é¢ï¼å¨æ°å¬å¸çä»£ç è§èæ¶åç°ä»ä»¬æéå¯¹è¿ä¸ªé®é¢è®¨è®ºè¿ï¼ææè¯å°è¿ä¸ªé®é¢çéè¦æ§ãå³äºè¿ä¸ªé®é¢äºè®®æ¯è¾å¤§ï¼èä¸å³äº <code>async/await</code> å®å¨å¯ä»¥åç¬åä¸ç¯ï¼è¿ç¯ä¸»è¦è¿æ¯éå¯¹ <code>Promise</code> çå­¦ä¹ è®°å½ï¼ååä¸å»ä¹æäºè¶ç¯å¹äºï¼ä¹åå­¦ä¹ æ¶åºè¯¥è¿ä¼åèå°ã</p>
<h2 id="ç¼ºé·">ç¼ºé·</h2>
<p>è¿ä¸ªé¨åå¯¹äºææ¥è¯´è¿æ¯æäºè¶çº²äºï¼ä½ä¹æåèèµæï¼åä¸ä¸ãä½ ä¸ç¥éçJavaScriptãä¸­å·æå°çå ä¸ªç¼ºé·ï¼ä¸è¿è¿äºçº¸è´¨ä¹¦æä¸å®çæ¶ä»£æ§ï¼åå®¹ä»ä¾åèï¼</p>
<ol>
<li><strong>é¡ºåºéè¯¯å¤ç</strong>ï¼ å¦ææå»ºäºä¸ä¸ªæ²¡æéè¯¯å¤çå½æ°çPromiseé¾ï¼é¾ä¸­åç»­ç <code>then</code> ä»ç¶ä¼è¢«æ§è¡ï¼å¯è½å¯¼è´éè¯¯è¢«å¿½ç¥æå¤çä¸å½ã</li>
<li><strong>åä¸å¼</strong>ï¼ <code>Promise</code> åªè½å¤çåä¸å¼çä¼ éï¼æ æ³ç´æ¥å¤çå¤ä¸ªå¼æå¤æçæ°æ®ç»æï¼å¯ä»¥ä¼ éå°è£çå¯¹è±¡ï¼ä½å¦æå¨é¾ä¸­çæ¯ä¸æ­¥é½è¿è¡å°è£åè§£å°ï¼å°±æäºç¬¨éäºï¼ã</li>
<li><strong>åå³è®®</strong>ï¼ <code>Promise</code> ä¸æ¦è¢«è§£å³ï¼<code>fulfilled</code>ï¼ææç»ï¼<code>rejected</code>ï¼ï¼å¶ç¶æå°±ä¸è½åæ¹åï¼æ æ³éæ°è§£å³ææç»ã</li>
<li><strong>æ¯æ§</strong>ï¼ æ¶ä»£æ§çä½ç°ï¼èèå½æ¶çç¯å¢ <code>Promise</code> è¿æªæ®åï¼ç°å¨åºè¯¥å¯ä»¥å¿½ç¥è¿ä¸ç¹äºã</li>
<li><strong>ä¸å¯åæ¶</strong>ï¼ ä¸æ¦åå»ºï¼<code>Promise</code> å°±ä¼ä¸ç´æ§è¡ï¼æ æ³åæ¶æ­£å¨è¿è¡çå¼æ­¥æä½ãè¿ä¸ªä¹æäºæ¶ä»£æ§äºï¼ç°å¨æ <code>AbortController</code> å¯ä»¥éå <code>fetch</code> æ¥å®ç°åæ¶è¯·æ±çåè½ã</li>
<li><strong>æ§è½</strong>ï¼ ç¸è¾äºåè°å½æ°ï¼<code>Promise</code> å¨åå»ºåç®¡çç¶ææ¹é¢æä¸å®çæ§è½å¼éï¼ä½ä¸ªäººè®¤ä¸ºè¿å¨éå¸¸çåºç¨åºæ¯ä¸­å½±åä¸å¤§ã</li>
</ol>
<h2 id="æ»ç»">æ»ç»</h2>
<p>è¯´å®è¯å¨ç¬ä¹åå°±æ¯è§å¾åºè¯¥åä¸ç¯å³äº <code>Promise</code> çï¼ä½å¼å§åä¹ååç°æ²¡ä»ä¹æ¹åï¼ç¸å³èµæä¹æ¯æµ©å¦çæµ·ï¼åè¿ç¯èè´¹äºéå¸¸å¤çæ¶é´ï¼å¼å§ä¸æ­å°æ·±æç»èåæè§ææ ç©·æ å°½çé®é¢ï¼å¥½å¨ç°å¨éè¿ AI è³å°å¯ä»¥æè¿äºé®é¢å¤§è´çæ¸æ¥ï¼"å¤§è´"çè§£è¯´æè¿æå¾å¤åå®¹æ²¡ææ¶åï¼ä¹åå¨é¡¹ç®ä¸­åºè¯¥ä¼æ´å æ³¨æ <code>Promise</code> çåºç¨ï¼ç¶åæãä½ ä¸ç¥éçJavaScriptãçç¸å³åå®¹çå®ç»åä¸ä¸åºè¯¥è¿å¯ä»¥åæ°´ä¸ç¯ã</p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-06 10:48">2026-02-06 10:47</span>&nbsp;
<a href="https://www.cnblogs.com/LFeather">å¤å°½ä¸¶</a>&nbsp;
éè¯»(<span id="post_view_count">48</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19583059);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19583059', targetLink: 'https://www.cnblogs.com/LFeather/p/19583059', title: 'ä»åè°å½æ°å°Promise' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ AIå¼å-python-langchainæ¡æ¶ï¼1-12 è¿åjson-æ ¼å¼è§£æå¨ï¼ ]]></title>
    <link>https://www.cnblogs.com/yclh/p/19583025</link>
    <guid>cf5d3da3849ac076f149b439a749c68a</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/yclh/p/19583025" title="åå¸äº 2026-02-06 10:40">
    <span role="heading" aria-level="2">AIå¼å-python-langchainæ¡æ¶ï¼1-12 è¿åjson-æ ¼å¼è§£æå¨ï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>å³é®ç¹æ¥äºï¼ç°å¨jsonæ ¼å¼æ¯å¼åä¸­æ¯æä¸ºæ®éçæ°æ®æ ¼å¼ï¼å°¤å¶å¨ååç«¯äº¤äºä¸­åºç¨ååå¹¿æ³ï¼å¦ä½è®©å¤§æ¨¡åè¿åçæ°æ®æ¯æ åçjsonæ ¼å¼ï¼</p>
<p>çå¦ä¸ä»£ç ï¼</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">from langchain.prompts import PromptTemplate
from langchain_openai import ChatOpenAI
from langchain_core.output_parsers import JsonOutputParser
from langchain_core.pydantic_v1 import BaseModel, Field
import os


# å®ä¹æ¨æ³è¦çæ°æ®ç»æã
class Book(BaseModel):
    title: str = Field(description="ä¹¦å")
    author: str = Field(description="ä½è")
    description: str = Field(description="ä¹¦çç®ä»")

# Set up a parser + inject instructions into the prompt template.
output_parser = JsonOutputParser(pydantic_object=Book)


format_instructions = output_parser.get_format_instructions()
print('åçæç¤ºè¯')
print(format_instructions)
print('#############')


#æ¹æä¸­ææç¤ºè¯
format_instructions = '''è¾åºåºæ ¼å¼åä¸ºç¬¦åä»¥ä¸ JSON ç»æç JSON å®ä¾ã
JSONç»æ
```
{
'title': 'ä¹¦çæ é¢',
'author': 'ä½è',
'description': 'ä¹¦çç®ä»'
}
```
'''
prompt = PromptTemplate(
    template="{format_instructions}\n{query}\n",
    input_variables=["query"],
    partial_variables={"format_instructions": format_instructions},
)



# åå§åèå¤©æ¨¡åï¼ä½¿ç¨DeepSeek APIï¼
llm = ChatOpenAI(
    api_key=os.getenv("DEEPSEEK_API_KEY"),            # ä»ç¯å¢åéè¯»åAPIå¯é¥
    base_url=os.getenv("BASE_URL"),                   # ä»ç¯å¢åéè¯»åAPIåºç¡URLï¼å¦ https://api.deepseek.comï¼
    model="deepseek-v3:671b",                         # æå®ä½¿ç¨çæ¨¡åçæ¬
    temperature=0.7,                                  # çæéæºæ§æ§å¶ï¼0.7 éä¸­åé æ§
    max_tokens=1024                                   # åæ¬¡ååºæå¤§tokenæ°
)

chain = prompt | llm | output_parser

print('--------------')
# ä»¥åæ¨å¨æç¤ºè¯­è¨æ¨¡åå¡«åæ°æ®ç»æçæ¥è¯¢ã
query = "è¯·ç»æä»ç»2æ¬å­¦ä¹ ä¸­å½åå²çç»å¸ä¹¦ç±"
result = chain.invoke({"query": query})
print(result)

#æµå¼è¾åº
# for s in chain.stream({"query": query}):
#     print(s)
</pre>
</div>
<p>&nbsp;è¾åºï¼</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">åçæç¤ºè¯
The output should be formatted as a JSON instance that conforms to the JSON schema below.

As an example, for the schema {"properties": {"foo": {"title": "Foo", "description": "a list of strings", "type": "array", "items": {"type": "string"}}}, "required": ["foo"]}
the object {"foo": ["bar", "baz"]} is a well-formatted instance of the schema. The object {"properties": {"foo": ["bar", "baz"]}} is not well-formatted.

Here is the output schema:
```
{"properties": {"title": {"title": "Title", "description": "\u4e66\u540d", "type": "string"}, "author": {"title": "Author", "description": "\u4f5c\u8005", "type": "string"}, "description": {"title": "Description", "description": "\u4e66\u7684\u7b80\u4ecb", "type": "string"}}, "required": ["title", "author", "description"]}
```
#############
--------------
[{'title': 'ä¸­å½éå²', 'author': 'åæå', 'description': 'ãä¸­å½éå²ãæ¯åæååççä»£è¡¨ä½ä¹ä¸ï¼ç³»ç»å¨é¢å°ä»ç»äºä¸­å½ä»è¿å¤æ¶ä»£å°è¿ä»£çåå²åå±èç»ãè¯¥ä¹¦åå®¹è¯¦å®ï¼åææ·±å¥ï¼æ¯å­¦ä¹ ä¸­å½åå²çç»å¸å¥é¨ä¹¦ç±ã'}, {'title': 'ä¸ååäºå¹´', 'author': 'é»ä»å®', 'description': 'ãä¸ååäºå¹´ãæ¯é»ä»å®åççç»å¸èä½ï¼ä»¥ææä¸ååäºå¹´ä¸ºåå¥ç¹ï¼éè¿ç»è´å¥å¾®çåå²åæï¼å±ç°äºå½æ¶ç¤¾ä¼çæ¿æ²»ãç»æµåæåç¶åµãè¯¥ä¹¦è§è§ç¬ç¹ï¼æç¬æµçï¼æ·±åè¯»èåç±ã'}]
</pre>
</div>
<p>&nbsp;çè¿ä¸ªè¿åæ°æ®æ¯ä¸æ¯å°±æ¯éè¦çæ åjsonæ ¼å¼</p>
<p>ä¸é¢è¿æ®µä»£ç çæ ¸å¿æ¯éè¿<strong style="color: rgba(0, 0, 0, 1); font: bold 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">å®ä¹æ°æ®ç»æãæå»ºæç¤ºè¯ãè°ç¨å¤§æ¨¡åãè§£æè¾åº</strong>çå®æ´æµç¨ï¼ç²¾åæ§å¶å¤§æ¨¡åè¿åæå®æ ¼å¼ç JSON æ°æ®ã</p>
<p>é¦åéè¿ Pydantic ç <code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; text-align: start; white-space: normal; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">BaseModel</code> å®ä¹ <code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; text-align: start; white-space: normal; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">Book</code> ç±»ï¼æç¡®è¦æ±è¾åºåå« <code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; text-align: start; white-space: normal; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">title</code>ã<code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; text-align: start; white-space: normal; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">author</code>ã<code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; text-align: start; white-space: normal; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">description</code> ä¸ä¸ªå­æ®µåå¯¹åºå«ä¹ï¼ä¸º JSON è¾åºæä¾è§åèæ¬ï¼</p>
<p>æ¥çå©ç¨ <code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; text-align: start; white-space: normal; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">JsonOutputParser</code> ç»å®è¯¥æ°æ®ç»æï¼å³é®ç¹ï¼ï¼æ¢èªå¨çææ ¼å¼æç¤ºè¯ï¼åè½åç»­æ ¡éªå¹¶è§£ææ¨¡åè¾åºï¼åæ¶èªå®ä¹ä¸­ææ ¼å¼æç¤ºè¯å¼ºåå¤§æ¨¡åå¯¹ JSON ç»æççè§£ï¼ç¡®ä¿å­æ®µä¸å®ä¹å®å¨å¹éï¼</p>
<p>åéè¿ <code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; text-align: start; white-space: normal; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">PromptTemplate</code> å°æ ¼å¼è¦æ±ä¸ç¨æ·æ¥è¯¢æ¼æ¥ä¸ºæ ååæç¤ºè¯ï¼æç¡®åç¥å¤§æ¨¡åéè¿åç¬¦åç»æç JSON å®ä¾ï¼</p>
<p>åå§åå¼å®¹ç¬¬ä¸æ¹æ¨¡åç <code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; text-align: start; white-space: normal; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">ChatOpenAI</code> æ¶ï¼å° <code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; text-align: start; white-space: normal; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">temperature</code> è®¾ä¸º 0.7 å¹³è¡¡åé æ§ä¸æ ¼å¼åè§æ§ï¼éä½è¾åºåç¦» JSON ç»æçæ¦çï¼</p>
<p>æåéè¿ LangChain çé¾å¼è°ç¨ï¼<code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; text-align: start; white-space: normal; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">prompt | llm | output_parser</code>ï¼èªå¨åå®æ âæç¤ºè¯æ¼æ¥âæ¨¡åçæâJSON è§£æâ å¨æµç¨ï¼</p>
<p>æç»è¾åºå¯ç´æ¥æä½ç Python å­å¸ï¼å¨ç¨éè¿ç»æçº¦æãæç¤ºè¯å¼å¯¼ãè§£æå¨æ ¡éªä¸éä¿éï¼å®ç°å¤§æ¨¡åç¨³å®è¿ååè§ JSON æ°æ®çæ ¸å¿ç®æ ã</p>
<p>&nbsp;</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-06 10:40">2026-02-06 10:40</span>&nbsp;
<a href="https://www.cnblogs.com/yclh">ä¸ç¬ä½</a>&nbsp;
éè¯»(<span id="post_view_count">20</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19583025);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19583025', targetLink: 'https://www.cnblogs.com/yclh/p/19583025', title: 'AIå¼å-python-langchainæ¡æ¶ï¼1-12 è¿åjson-æ ¼å¼è§£æå¨ï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ååï¼Claude Opus 4.6 å GPT-5.3-Codex åæ¶ç¸åºï¼AI ç¼ç¨è¦åå¤©äº ]]></title>
    <link>https://www.cnblogs.com/yupi/p/19583031</link>
    <guid>1d0c19c3e759a299218d828be00d085a</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/yupi/p/19583031" title="åå¸äº 2026-02-06 10:40">
    <span role="heading" aria-level="2">ååï¼Claude Opus 4.6 å GPT-5.3-Codex åæ¶ç¸åºï¼AI ç¼ç¨è¦åå¤©äº</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/2225420/202602/2225420-20260206102350805-967131892.png" alt="ååï¼Claude Opus 4.6 å GPT-5.3-Codex åæ¶ç¸åºï¼AI ç¼ç¨è¦åå¤©äº" class="desc_img">
        è¿æ¬¡ä¸¤å®¶å·¨å¤´åæ¶åå¸æ°æ¨¡åï¼äºç¸è´´è¸å¼å¤§ï¼å¯¹æä»¬ç¨æ·æ¥è¯´æ¯å¥½äºãå¯ä»¥çå°ï¼è¿ä¸¤ä¸ªæ¨¡åé½å¨å¾ å®ç¨æ¹å çå·ï¼æ¯ççæ³è®©ä½ æ¥å¸¸å·¥ä½ä¸­ç¨å¾ä¸ã
è¿ä¸¤ä¸ªå¤§æ¨¡åä½ ä¼å¦ä½éæ©å¢ï¼
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p class="md-end-block md-heading"><span class="md-plain">å¤§å®¶å¥½ï¼ææ¯ç¨åºåé±¼ç®ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä»å¤©åæ¨ï¼AI ååååç¸äºãAnthropic å OpenAI å ä¹åæ¶åå¸äºèªå®¶çææ°å¤§æ¨¡å ââ Claude Opus 4.6 å GPT-5.3-Codexï¼ä¸­é¨å¯¹çï¼ç«è¯å³åè¶³ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260206092008146.png"><img data-src="https://pic.yupi.icu/1/image-20260206092008146.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">è¿æ¬¡ä¸¤å®¶æ¯çå¾ç¼ç¨åå®éå·¥ä½è½åä¸å·äºï¼ä¸æ¯é£ç§ âè·ååäº 2 ä¸ªç¹â å°±åç¯åå®¢çæ·è¡æ´æ°ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä¸é¢æå¸¦å¤§å®¶å¿«éäºè§£ä¸ä¸ï¼è¿ä¸¤ä¸ªæ¨¡åå°åºæ´æ°äºä»ä¹ï¼å¯¹æä»¬ç¨åºåå AI ç©å®¶æ¥è¯´æä»ä¹ç¨ï¼</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">Claude Opus 4.6ï¼æ´èªæãæ´è½å¹²ãæ´æä¹</span></h2>
<p class="md-end-block md-p"><span class="md-plain">åè¯´ Anthropic è¿è¾¹ãClaude Opus 4.6 æ¯ç®å Claude å®¶ææå¼ºçæ¨¡åï¼ä¹åç¨ Claude Opus 4.5 ç¼ç¨å°±å·²ç»è®©ææè§ âAI åä»£ç æ æä¸è½â äºï¼èè¿æ¬¡ç Opus 4.6 å¨å¤é¡¹è¯ä¼°ä¸­åå¤äºæåè¿æ°´å¹³ï¼åæ¬æºè½ç¼ç ãå¤å­¦ç§æ¨çãç¥è¯å·¥ä½åæºè½æç´¢ç­ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">åçè¿ä¸ªè·åæå°±è´¼æ¿å¨äºï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1770339059467-24cdc13f-957e-4ff8-bee2-7b8625d0c4a6.png"><img data-src="https://pic.yupi.icu/1/1770339059467-24cdc13f-957e-4ff8-bee2-7b8625d0c4a6.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">å®éä¸æåï¼ææç´è§çæåå°±æ¯ï¼<span class="md-pair-s "><strong>å¹²æ´»æ´é è°±äº</strong><span class="md-plain">ã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">å·ä½æ´æ°äºè¿äºï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">1ï¼ç¼ç¨è½åå¤§å¹æåï¼Opus 4.6 è½æ´å¥½å°å¨å¤§åä»£ç åºä¸­å·¥ä½ï¼è°è¯åä»£ç å®¡æ¥è½åå¢å¼ºï¼åå®ä»£ç è¿è½èªå·±æ£æ¥éè¯¯ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">æå®æµäºä¸æ³¢ï¼è®©ä¹åç Opus 4.5 åæ°åºç Opus 4.6 åæ¶å¼åä¸ä¸ªãèåæç´¢å¼æãé¡¹ç®ï¼</span></p>
<pre class="md-fences md-end-block ty-contain-cm modeLoaded"><span>è¯·ä½ å¸®æå¼åä¸ä¸ªèåæç´¢ç½ç«ï¼åå«å®æ´çåç«¯ååç«¯ï¼è½å¤åæ¶ä»å¤ä¸ªä¸åçæç´¢å¼ææç´¢åèåç»æã<br><span>åºè¯¥åå MVP æå°å¯è¡äº§åï¼æ´ä¸ªè¿ç¨ä¸éè¦åæç¡®è®¤ãä¸éè¦ææä¾ API Keyï¼ä½ å¿é¡»ç¡®ä¿åè½æ­£å¸¸å¯ç¨ã</span></span></pre>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260206095821042.png"><img data-src="https://pic.yupi.icu/1/image-20260206095821042.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">å åéåï¼äºèé½å®æäºä»»å¡ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260206100013366.png"><img data-src="https://pic.yupi.icu/1/image-20260206100013366.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½æ¯å¯¹æ¯ä¸ä¸å®éæç´¢ææï¼Opus 4.5 å®è´¥ï¼çå°è¿æå°±æ¾å¿äºï¼ä»¥åæç¨ AI ç¼ç¨ä¼°è®¡ Bug æ´å°äº~</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260206100155670.png"><img data-src="https://pic.yupi.icu/1/image-20260206100155670.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">2ï¼100 ä¸ token ä¸ä¸æçªå£ãOpus ç³»åç¬¬ä¸æ¬¡æ¯æè¿ä¹é¿çä¸ä¸æï¼ç®åæ¥è¯´å°±æ¯ä½ å¯ä»¥ä¸æ¬¡æ§ç»å®ä¸¢ä¸å¤§å æä»¶åä»£ç ï¼å®é½è½è®°ä½å¹¶çè§£ï¼ä¸ä¼åä»¥åé£æ ·èçèçå°±å¤±å¿äºã</span></p>
<p class="md-end-block md-p"><span class="md-plain">è¿ä¹æ¯æææææå¾çç¹æ§ï¼å¤æçååç«¯é¡¹ç®ä¹å¯ä»¥å¨åä¸å¯¹è¯æ¡ä¸­ä¸ææ¢­äºï¼ä¸ç¨æ¥æ¥ååæ»ç»ä¸ä¸æåæ°å¼å¯¹è¯æ¡ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">èµ£ï¼åå¤ååç§ Tokens äºã</span></p>
<p class="md-end-block md-p"><span class="md-plain">3ï¼128k è¾åº tokenãè¾åºé¿åº¦ç¿»åï¼æå³ç Claude å¯ä»¥ä¸æ¬¡æ§çææ´é¿çä»£ç åææ¡£ï¼ä¸ç¨åææå¥½å æ¬¡è¯·æ±äºã</span></p>
<p class="md-end-block md-p"><span class="md-plain">4ï¼èªéåºæèãä»¥åå¼åèåªè½æéå¼å¯æå³é­æ·±åº¦æ¨çï¼ç°å¨ Claude ä¼èªå¨å¤æ­è¿ä¸ªé®é¢éä¸éè¦æ·±åº¦æèãç®åé®é¢ç§åï¼å¤æé®é¢æ¢æ¢æ³ï¼æºè½è°èï¼çæ¶çé±ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">5ï¼ä¸ä¸æåç¼©ãä»¥åè·é¿ä»»å¡çæ¶åï¼AI ç»å¸¸ä¼æå°ä¸ä¸æé¿åº¦çå¤©è±æ¿ãç°å¨ Claude è½èªå¨åç¼©åæ»ç»ä¹åçå¯¹è¯åå®¹ï¼è®©é¿æ¶é´è¿è¡çä»»å¡ä¸ä¼ä¸­éç¿»è½¦ãæ­é 100 ä¸ token ä¸ä¸æï¼ä¸æ¢æ³è±¡æå¤æä¹ï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">6ï¼Claude Code æ¯æå¤æºè½ä½åä½ãä½ å¯ä»¥åæ¶å¯å¨å¤ä¸ª AI Agent å¹¶è¡å·¥ä½ï¼æ¯å¦è®©å ä¸ª Agent åæ¶å®¡æ¥ä»£ç åºçä¸åé¨åï¼æçç´æ¥ç¿»åã</span></p>
<p class="md-end-block md-p"><span class="md-plain">7ï¼Claude in Excel å¤§åçº§ãç°å¨è½å¤çæ´å¤æçé¿æ¶é´ä»»å¡ï¼æ¯ææ°æ®éè§è¡¨ãå¾è¡¨ä¿®æ¹ãæ¡ä»¶æ ¼å¼ãæ°æ®éªè¯ç­ï¼è¿è½ä¸æ¬¡æ§å¤çå¤æ­¥éª¤æä½ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/6984ae18765ce9ada0768cfc_ClaudeExcel-Blog-Hero-Desktop.png"><img data-src="https://pic.yupi.icu/1/6984ae18765ce9ada0768cfc_ClaudeExcel-Blog-Hero-Desktop.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">8ï¼Claude in PowerPoint ä¸çº¿ãè½è¯»åä½ å·²æçæ¨¡æ¿ãå­ä½åæ¯çï¼ä¿æåçé£æ ¼ä¸è´ï¼ç¶åç´æ¥å¸®ä½ çæå®æ´ç PPTã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1770339189972-c3c8b2e7-234b-4089-8b69-d172b523d5d4.png"><img data-src="https://pic.yupi.icu/1/1770339189972-c3c8b2e7-234b-4089-8b69-d172b523d5d4.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">å¤§å®¶å¯¹ Opus 4.6 ä¹æ¯ä¸è´å¥½è¯ï¼ä¸å°æ©ææµè¯çå¬å¸é½è¡¨ç¤º âç¨äºåä¸å»âï¼Cursor å®æ¹è¯´ Opus 4.6 æ¯ä»ä»¬åé¨é¿ä»»å¡æµè¯ä¸­çæå¼ºæ¨¡åï¼Replit è¯´å®çä»»å¡æè§£åå¹¶è¡è§åè½åæäºå·¨å¤§é£è·ã</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">GPT-5.3-Codexï¼OpenAI çç¼ç¨ææé</span></h2>
<p class="md-end-block md-p"><span class="md-plain">åç OpenAI è¿è¾¹ãè¿æ¬¡åå¸ç GPT-5.3-Codexï¼åæ <span class="md-pair-s "><strong>æå¼ºç¼ç¨ Agent</strong><span class="md-plain">ï¼èä¸ä¸åªæ¯åä»£ç ï¼è¿è½åä½ çåäºä¸æ ·è¾¹å¹²æ´»è¾¹åä½ æ²éã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">ç¸æ¯ Claude å®æ¹è¿åå¥½å ä¸ªå¸å­ä»ç»èªå®¶æ°æ¨¡åï¼OpenAI å®æ¹è¿è¾¹åä½è°ä¸å°ãSam Altman äº²èªå¨ X ä¸åè¯ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1770340355704-c9569d19-a5f5-4e46-98c4-b6b75dab01bc-20260206093449865.png"><img data-src="https://pic.yupi.icu/1/1770340355704-c9569d19-a5f5-4e46-98c4-b6b75dab01bc-20260206093449865.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">æ¥ççå·ä½æä»ä¹ï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">1ï¼ç¼ç¨è·åå¨é¢é¢åãSWE-Bench Pro 57% å TerminalBench 2.0 77%ï¼ç¼ç¨ç¸å³åºåé½åäºæ°é«ãå°¤å¶æ¯ OSWorldï¼æµè¯ AI å¨çå®æ¡é¢ç¯å¢ä¸­å®æä»»å¡çè½åï¼ç´æ¥ä»ä¸ä¸ä»£ç 38.2% é£å° 64.7%ï¼è¿ä¸ªæåå¹åº¦ç¸å½ç¸è£ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260206094035858.png"><img data-src="https://pic.yupi.icu/1/image-20260206094035858.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">2ï¼éåº¦æ´å¿«ãæ´çé±ãå®æåæ ·çä»»å¡ï¼token æ¶èéä¸å°ä¸ä¸ä»£ï¼5.2-Codexï¼çä¸åï¼èä¸æ¯ä¸ª token å¤çéåº¦è¿å¿«äº 25%ãåå¿«åçï¼è¿ææ¯å®å®å¨å¨çä½éªæåã</span></p>
<p class="md-end-block md-p"><span class="md-plain">3ï¼è¾¹å¹²æ´»è¾¹æ±æ¥ãä»¥åä½ ä¸¢ä¸ä¸ªä»»å¡ç» AIï¼åªè½å¹²ç­ç»æãç°å¨ GPT-5.3-Codex ä¼å¨å·¥ä½è¿ç¨ä¸­å®æ¶åè¯ä½ å®å¨åä»ä¹ãåå°åªäºï¼ä½ éæ¶å¯ä»¥æå´è°æ´æ¹åï¼å°±åççå¨åä¸ä¸ªåäºåä½ä¸æ ·ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">4ï¼è¶å¼ºçåç«¯å¼åè½åãå®æ¹ç´æ¥å±ç¤ºäºè®©å®åèµè½¦æ¸¸æåæ½æ°´æ¸¸æçææï¼å®æ´åº¦é«å¾ç¦»è°±ï¼æå¤ä¸ªå°å¾ãéå·ç³»ç»åå®æ´çæ¸¸æé»è¾ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260206094133069.png"><img data-src="https://pic.yupi.icu/1/image-20260206094133069.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">çææ®éç½é¡µæ¶ AI ä¹æ´æä½ çæå¾äºï¼é»è®¤å°±è½ç»ä½ ååºåè½æ´ä¸°å¯ãè®¾è®¡æ´åççé¡µé¢ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">5ï¼çµèæä½è½åå¢å¼ºãä¸åªæ¯åä»£ç ï¼å®è¿è½åäººä¸æ ·æä½çµèå®æåç§ä»»å¡ï¼æ¯å¦å PPTãåææ°æ®ãå¤çè¡¨æ ¼ï¼æç¼ç¨ Agent çè¾¹çæ©å±å°äºå¨è½æå·¥ Agentã</span></p>
<p class="md-end-block md-p"><span class="md-plain">6ï¼èªå·±è®­ç»èªå·±ãOpenAI å¢éè¯´ GPT-5.3-Codex æ¯ç¬¬ä¸ä¸ª <span class="md-pair-s "><strong>åä¸äºèªèº«åé </strong><span class="md-plain"> çæ¨¡åãå¢éç¨å®çæ©æçæ¬æ¥è°è¯è®­ç»è¿ç¨ãç®¡çé¨ç½²ãåææµè¯ç»æãä¹å°±æ¯è¯´ï¼AI å¨å é AI èªèº«çè¿åï¼ä»¥åçè¿åéåº¦è¯å®ä¼è¶æ¥è¶å¿«ã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">7ï¼ç½ç»å®å¨è½åå¤§å¹å¢å¼ºãè¿æ¯ç¬¬ä¸ä¸ªè¢« OpenAI å½ç±»ä¸ºé«è½åç½ç»å®å¨æ¨¡åççæ¬ï¼è½ä¸»å¨åç°ä»£ç æ¼æ´ãOpenAI åæ¶æ¿è¯ºæå¥ 1000 ä¸ç¾å API é¢åº¦æ¯æç½ç»é²å¾¡ç ç©¶ã</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">æççæ³</span></h2>
<p class="md-end-block md-p"><span class="md-plain">è¿æ¬¡ä¸¤å®¶å·¨å¤´åæ¶åå¸æ°æ¨¡åï¼äºç¸è´´è¸å¼å¤§ï¼å¯¹æä»¬ç¨æ·æ¥è¯´æ¯å¥½äºãå¯ä»¥çå°ï¼è¿ä¸¤ä¸ªæ¨¡åé½å¨å¾ <span class="md-pair-s "><strong>å®ç¨æ¹å</strong><span class="md-plain"> çå·ï¼æ¯ççæ³è®©ä½ æ¥å¸¸å·¥ä½ä¸­ç¨å¾ä¸ã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">è¿ä¸¤ä¸ªå¤§æ¨¡ååºè¯¥å¦ä½éæ©å¢ï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">ç®åå¯¹æ¯ä¸ä¸ï¼</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">Claude Opus 4.6 æ¯å­è¾¹å½¢æå£«ï¼ç¼ç¨ãåå¬ãç ç©¶æ ·æ ·è¡ï¼ç¹å«æ¯å¨ ExcelãPowerPoint è¿äºåå¬åºæ¯éåäºå¾æ·±çæ´åã</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">GPT-5.3-Codex æç¼ç¨è½åææ»¡ï¼å¨ä»£ç çæãä»»å¡æ§è¡åäººæºåä½ä¸æåºäºå·®å¼åä¼å¿ã</span></p>
</li>
</ul>
<p class="md-end-block md-p"><span class="md-plain">ä¸è¿æä¼°è®¡ç½ç»åä»·æ ¼å°±å·²ç»åéä¸å¤§æ³¢å½åç¨æ·äºï¼å¦æä½ åªæ¯æ¥å¸¸å­¦ä¹ ãæèååå·¥å·ç±»å°é¡¹ç®ï¼ä¹ä¸å¿ç²ç®è¿½æ±å½å¤çå¤§æ¨¡åãå¾å¿« DeepSeek V4 ç­ä¸ç³»åå½äº§å¤§æ¨¡ååºè¯¥å°±è¦åºæ¥äºï¼æå¾ä¸æ³¢~</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">æ´å¤ç¼ç¨å­¦ä¹ èµæº</span></h2>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/course" rel="noopener nofollow"><span class="md-plain">Javaåç«¯ç¨åºåå¿åé¡¹ç®å®ææç¨+æ¯è®¾ç½ç«</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/" rel="noopener nofollow"><span class="md-plain">ç¨åºååè´¹ç¼ç¨å­¦ä¹ äº¤æµç¤¾åºï¼èªå­¦å¿å¤ï¼</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/course/cv" rel="noopener nofollow"><span class="md-plain">ç¨åºåä¿å§çº§æ±èåç®åæåï¼æ¾å·¥ä½å¿å¤ï¼</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.mianshiya.com/" rel="noopener nofollow"><span class="md-plain">ç¨åºååè´¹é¢è¯å·é¢ç½ç«å·¥å·ï¼æ¾å·¥ä½å¿å¤ï¼</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640584449888772098" rel="noopener nofollow"><span class="md-plain">ææ°Javaé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Javaæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640586673306091521" rel="noopener nofollow"><span class="md-plain">ææ°Pythoné¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Pythonæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640586014108303362" rel="noopener nofollow"><span class="md-plain">ææ°åç«¯é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + åç«¯æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640586867363954689" rel="noopener nofollow"><span class="md-plain">ææ°æ°æ®ç»æåç®æ³é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + ç®æ³æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1644279832026075138" rel="noopener nofollow"><span class="md-plain">ææ°C++é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ãC++æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1641797333479903234" rel="noopener nofollow"><span class="md-plain">ææ°æ°æ®åºé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + æ°æ®åºæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640589994284695553" rel="noopener nofollow"><span class="md-plain">ææ°Redisé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Redisæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1641035880439271426" rel="noopener nofollow"><span class="md-plain">ææ°è®¡ç®æºåºç¡å¥é¨å­¦ä¹ è·¯çº¿ + è®¡ç®æºåºç¡æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1641366118197153793" rel="noopener nofollow"><span class="md-plain">ææ°å°ç¨åºå¥é¨å­¦ä¹ è·¯çº¿ + å°ç¨åºå¼åæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="http://sqlmother.yupi.icu/" rel="noopener nofollow"><span class="md-plain">ææ°SQLé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + SQLæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640586295529324545" rel="noopener nofollow"><span class="md-plain">ææ°Linuxé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Linuxæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640588753362108417" rel="noopener nofollow"><span class="md-plain">ææ°Git/GitHubé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Gitæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640587909942099969" rel="noopener nofollow"><span class="md-plain">ææ°æä½ç³»ç»é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + æä½ç³»ç»æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640588119619551233" rel="noopener nofollow"><span class="md-plain">ææ°è®¡ç®æºç½ç»é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + è®¡ç®æºç½ç»æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640588392073150465" rel="noopener nofollow"><span class="md-plain">ææ°è®¾è®¡æ¨¡å¼é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + è®¾è®¡æ¨¡å¼æç¨</span></a></span></p>
</li>
<li class="md-list-item md-focus-container">
<p class="md-end-block md-p md-focus"><span class="md-meta-i-c md-link md-expand"><a href="https://www.code-nav.cn/post/1640648711119892481" rel="noopener nofollow"><span class="md-plain">ææ°è½¯ä»¶å·¥ç¨é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + è½¯ä»¶å·¥ç¨æç¨</span></a></span></p>
</li>
</ul>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-06 10:40">2026-02-06 10:40</span>&nbsp;
<a href="https://www.cnblogs.com/yupi">ç¨åºåé±¼ç®</a>&nbsp;
éè¯»(<span id="post_view_count">180</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19583031);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19583031', targetLink: 'https://www.cnblogs.com/yupi/p/19583031', title: 'ååï¼Claude Opus 4.6 å GPT-5.3-Codex åæ¶ç¸åºï¼AI ç¼ç¨è¦åå¤©äº' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Linuxåæ ¸ä¸­æ¨¡åå®ä¹å®æºå¶è§£æ ]]></title>
    <link>https://www.cnblogs.com/ttkwzyttk/p/19582878</link>
    <guid>91875c46b4824a2be53e458e7c86515b</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ttkwzyttk/p/19582878" title="åå¸äº 2026-02-06 10:10">
    <span role="heading" aria-level="2">Linuxåæ ¸ä¸­æ¨¡åå®ä¹å®æºå¶è§£æ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ¬æè§£æäº Linux åæ ¸ä¸­ç module driver helper macroï¼è®²è§£äº module_platform_driver çå®ç°åçä¸è®¾è®¡ææ³ï¼å±ç¤ºäºå®å¦ä½éè¿ å®æ¼æ¥ãå¯ååæ°ã__init/__exit å module_init/module_exit èªå¨çæé©±å¨æ³¨åä¸æ³¨éæ¨¡æ¿ï¼æ¯åæ ¸é©±å¨å¼åèææ¡æ ååæ³çå®ç¨æåã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>å¨ç¼å Linux è®¾å¤é©±å¨æ¶ï¼å°¤å¶æ¯ platformãI2CãSPI ç­æ»çº¿é©±å¨ï¼æä»¬ç»å¸¸ä¼çå°ç±»ä¼¼ä¸é¢çåæ³ï¼</p>
<pre><code class="language-c">module_platform_driver(my_driver);
</code></pre>
<p>è¿ç±»å®çèµ·æ¥å¾âé­æ³âï¼ä½å®éä¸å®ä»¬åªæ¯ Linux åæ ¸ä¸ºäºåå°æ ·æ¿ä»£ç èæä¾çä¸ç§ <strong>driver helper macro</strong>ï¼æ¬æä¸»è¦è®²è§£è¿ç±»å®çç¨æ³ä¸æºå¶</p>
<h1 id="ä¸ä¼ ç»æ¨¡ååå§åæ¹å¼">ä¸ãä¼ ç»æ¨¡ååå§åæ¹å¼</h1>
<p>è¿éä»¥platformé©±å¨ä¸ºä¾ï¼ä¼ ç»çé©±å¨åæ³éå¸¸æ¯è¿æ ·çï¼</p>
<pre><code class="language-c">static struct platform_driver my_platform_driver = {
    .probe  = my_probe,
    .remove = my_remove,
    .driver = {
        .name = "my_driver",
    },
};

static int __init my_init(void)
{
    return platform_driver_register(&amp;my_platform_driver);
}

static void __exit my_exit(void)
{
    platform_driver_unregister(&amp;my_platform_driver);
}

module_init(my_init);
module_exit(my_exit);
MODULE_LICENSE("GPL");
</code></pre>
<p>è¿æ¯ä¸ä¸ªæ åçé©±å¨æ¨¡æ¿ï¼æé©±å¨çå¥å£initå½æ°ä¸åºå£exitå½æ°ï¼å¹¶éè¿<code>module_init</code>å<code>module_exit</code>æ¥å£å½æ°è¿è¡æ³¨åï¼è¿ç§åæ³çæ ·æ¿ä»£ç é«åº¦éå¤ï¼å ä¹æ¯ä¸ä¸ªplatformé©±å¨é½æ¯ä¸æ¨¡ä¸æ ·çï¼åæ ¸ä¸­å­å¨å¤§éè¿ç§åºå®æ¨¡å¼çä»£ç ï¼éå¸¸éåä½¿ç¨å®æ¥ç®å</p>
<h1 id="äºæ¨¡åå®ä¹å®çå¼å¥">äºãæ¨¡åå®ä¹å®çå¼å¥</h1>
<p>ä¸ºäºè§£å³ä¸è¿°é®é¢ï¼Linux åæ ¸å¼å¥äºä¸ç» <strong>module driver helper macro</strong>ï¼ç¨äºç®åé©±å¨çæ³¨åä¸æ³¨éè¿ç¨ã</p>
<p>ä»¥platformé©±å¨ä¸ºä¾ï¼åæ ¸æä¾äº</p>
<pre><code class="language-c">module_platform_driver(...)
</code></pre>
<p>è½ç¶æ¥å£ççåæ¯å½æ°ï¼ä½æ¯ä»æ¯ç±å®æ¥å®ç°çï¼ä½¿ç¨è¯¥å®ä¹åï¼ä¸é¢çä»£ç å°±å¯ä»¥ç®åä¸ºï¼</p>
<pre><code class="language-c">static struct platform_driver my_platform_driver = {
    .probe  = my_probe,
    .remove = my_remove,
    .driver = {
        .name = "my_driver",
    },
};

module_platform_driver(my_platform_driver);
MODULE_LICENSE("GPL");
</code></pre>
<p>å¯ä»¥çè§ï¼ä½¿ç¨è¯¥å®ä¹åï¼å°±ä¸éè¦åæå<code>__init</code>å<code>__exit</code>æ³¨åä¸æ³¨éæ¥å£å½æ°äºï¼ä¹ä¸éè¦åæ¾å¼è°ç¨<code>platform_driver_register</code>å<code>platform_driver_unregister</code>æ¥å£å½æ°äºï¼ä¸ä¼ ç»åæ³å®å¨ç¸å</p>
<p>å½ç¶è¿ç§åæ³ä¸ä»ä»åªæplatformé©±å¨æï¼åæ ¸ä¸ºä¸åçæ»çº¿é½æä¾äºå¯¹åºçå®å®ä¹</p>
<pre><code class="language-c">module_i2c_driver(my_i2c_driver);
module_spi_driver(my_spi_driver);
module_usb_driver(my_usb_driver);
module_pci_driver(my_pci_driver);
.......
</code></pre>
<p>ä»ä»¬éµå¾ªå®å¨ç¸åçè®¾è®¡ææ³ï¼ä¸ä¸ªæ¨¡åï¼åªæ³¨åä¸ä¸ªé©±å¨ï¼ç¨ä¸è¡å®æå®</p>
<h1 id="ä¸æ¬è´¨è§£æ">ä¸ãæ¬è´¨è§£æ</h1>
<p>è¿éè¿æ¯ä»¥platformé©±å¨ä¸ºä¾ï¼<code>module_platform_driver</code> æ¯ä¸ä¸ªå®å°è£ãæä»¬å¯ä»¥æå¼åæ ¸æºç <code>kernel/include/linux/platform_device.h</code>æ¾å°å¯¹åºçå®ï¼å¦æä¸ºå¶ä»æ»çº¿é©±å¨ï¼éè¦å°å¯¹åºçå¤´æä»¶ä¸­æ¥æ¾ï¼å¦ä¸æç¤º</p>
<pre><code class="language-c">/* module_platform_driver() - Helper macro for drivers that don't do
* anything special in module init/exit. This eliminates a lot of
* boilerplate. Each module may only use this macro once, and
* calling it replaces module_init() and module_exit()
*/

#define module_platform_driver(__platform_driver) \
module_driver(__platform_driver, platform_driver_register, \
platform_driver_unregister)
</code></pre>
<p>å¯ä»¥çè§<code>module_platform_driver</code>å®ä¸­åä½¿ç¨äº<code>module_driver</code>è¿ä¸ªå®å®ä¹ï¼è¿ä¸ªå®å®å¨<code>kernel/include/linux/device/driver.h</code>å¤´æä»¶ä¸­ï¼å®ä¹ä»£ç å¦ä¸</p>
<pre><code class="language-c">/**

* module_driver() - Helper macro for drivers that don't do anything
* special in module init/exit. This eliminates a lot of boilerplate.
* Each module may only use this macro once, and calling it replaces
* module_init() and module_exit().
*
* @__driver: driver name
* @__register: register function for this driver type
* @__unregister: unregister function for this driver type
* @...: Additional arguments to be passed to __register and __unregister.
*
* Use this macro to construct bus specific macros for registering
* drivers, and do not use it on its own.
*/
#define module_driver(__driver, __register, __unregister, ...) \
static int __init __driver##_init(void) \
{ \
return __register(&amp;(__driver) , ##__VA_ARGS__); \
} \
module_init(__driver##_init); \
static void __exit __driver##_exit(void) \
{ \
__unregister(&amp;(__driver) , ##__VA_ARGS__); \
} \

module_exit(__driver##_exit);
</code></pre>
<p>å¨<code>module_driver</code>å®ä¸­å°±å¯ä»¥çè§å¯¹åºçé©±å¨æ³¨åä¸æ³¨éçæ¨¡æ¿äºï¼è¿éä¸»è¦å°±æ¯éè¿å®æ¼æ¥ä»¥åå¯ååæ°å®æ¥å®ç°ï¼è¯»èå¯ä»¥èªè¡å®å±å¼è¿è¡åæï¼ææçæ¨¡åå®<code>platform</code>é©±å¨ã<code>pci</code>é©±å¨ã<code>usb</code>é©±å¨ç­ç­ï¼åºå±é½æ¯è°ç¨äº<code>module_driver</code>è¿è¡å®æ¿æ¢ä¸æ¼æ¥ç»ææåçæ¨¡åæ³¨åæ¨¡æ¿ï¼è¿éå°±ä¸åèµè¿°äº</p>
<h1 id="åä½¿ç¨åºæ¯">åãä½¿ç¨åºæ¯</h1>
<p>å¨ä¸»çº¿åæ ¸ä¸­ï¼è¿ç§åæ³å·²ç»æä¸º<strong>äºå®æ å</strong>ï¼åå ä¸»è¦æï¼</p>
<ul>
<li>*<strong>åå°æ ·æ¿ä»£ç </strong></li>
<li><strong>ç»ä¸é©±å¨é£æ ¼</strong></li>
<li><strong>éä½åºéæ¦ç</strong></li>
<li><strong>ä»£ç å®¡æ¥æ´åå¥½</strong></li>
</ul>
<p>å¯¹äºç»´æ¤èæ¥è¯´ï¼ä¸ç¼çå°<code>module_platform_driver(xxx_driver);</code> å°±è½ç«å»ç¥éè¿æ¯ä¸ä¸ªâæ åç platform æ¨¡åé©±å¨ã</p>
<p>è½ç¶ helper macro å¾æ¹ä¾¿ï¼ä½å¹¶éææåºæ¯é½éåãä¸å»ºè®®ä½¿ç¨çæåµåæ¬ï¼</p>
<ul>
<li>ä¸ä¸ªæ¨¡åä¸­æ³¨å <strong>å¤ä¸ª driver</strong></li>
<li>æ¨¡å init é¶æ®µè¿éè¦åé¢å¤åå§åå·¥ä½ï¼ä½¿ç¨æ¨¡åå®çè¯ï¼å®çåºå±åªè½è°ç¨å¯¹åºç<code>register</code>å<code>unregister</code>å½æ°æ æ³åå¶ä»æä½</li>
<li>å¯¹åå§å/éåºé¡ºåºæç²¾ç»æ§å¶éæ±</li>
</ul>
<p>å¨è¿äºåºæ¯ä¸ï¼æå <code>module_init</code> / <code>module_exit</code> åèæ´æ¸æ°ãæä»¥éè¦å·ä½æåµå·ä½åæ</p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-06 10:11">2026-02-06 10:10</span>&nbsp;
<a href="https://www.cnblogs.com/ttkwzyttk">ttkwzyttk</a>&nbsp;
éè¯»(<span id="post_view_count">6</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19582878);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19582878', targetLink: 'https://www.cnblogs.com/ttkwzyttk/p/19582878', title: 'Linuxåæ ¸ä¸­æ¨¡åå®ä¹å®æºå¶è§£æ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ClawdBot åºåè®°ï¼AI Agent æ­£å¨èµ°åå¤§ä¼ ]]></title>
    <link>https://www.cnblogs.com/bugshare/p/19582865</link>
    <guid>3fdb9776f8cf8dc99a11be50479b561f</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/bugshare/p/19582865" title="åå¸äº 2026-02-06 10:08">
    <span role="heading" aria-level="2">ClawdBot åºåè®°ï¼AI Agent æ­£å¨èµ°åå¤§ä¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>å½åå¤çç¤¾äº¤å¹³å°ä¸ï¼æ è®ºä½ æ¯å¦å³æ³¨ AIï¼æè¿å¤§æ¦çé½å·å°è¿ <strong>ClawdBot / OpenClaw</strong>ãç­ç­å å¤©æ¶é´ï¼è¿ä¸ªé¡¹ç®å¨ GitHub ä¸å·²ç»æ©è·äº <strong>13 ä¸+ Star</strong>ï¼å ªç§°ç°è±¡çº§å¼æºé¡¹ç®ã</p>
<p>å®ä¸ä»åæ¬¡ç¹çäºå¤§ä¼å¯¹ <strong>AI Agent</strong> çç­æï¼ä¹è®©ãè®© AI çæ­£å¸®ä½ å¹²æ´»ãè¿ä»¶äºï¼ä»æå®¢ç©å·éæ­¥èµ°åæ®éç¨æ·ã</p>
<hr>
<h1 id="ç®ä»">ç®ä»</h1>
<h2 id="åå§äºº">åå§äºº</h2>
<p>åæ¥çç ClawdBotï¼ç°å <strong>OpenClaw</strong>ï¼çåå§äºº <strong>Peter Steinberger</strong>ã</p>
<p>ä»æ¯å¥¥å°å©äººï¼æ¯ä¸äº <strong>ç»´ä¹çº³ç§æå¤§å­¦</strong>ï¼æ¯ä¸ä½å¸åçææ¯å¤©æã</p>
<p>å¨å ä¸º OpenClaw è¢«æ´å¤äººçç¥ä¹åï¼Peter å°±å·²ç»æ¯é ä»£ç æååä¸ãå®ç° <strong>èº«å®¶ä¸äº¿æ¬§å</strong>ãæåéä¼çç¨åºåäºãè¿æ¬¡åºå±±ï¼æ´åæ¯ä¸æ¬¡ãææ¯çæ³ä¸»ä¹èãçåå½ã</p>
<p><img alt="steipete.png" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3715916/202602/3715916-20260206095520349-987995217.png" class="lazyload"></p>
<hr>
<h2 id="å½åä¹æä¸åªé¾è¾çèåå²">å½åä¹æï¼ä¸åªé¾è¾çèåå²</h2>
<p>OpenClaw çåå­ï¼å¹¶ä¸æ¯ä¸å¼å§å°±ç¡®å®çï¼åèç»åäºä¸æ®µé¢ææå§æ§çæ¼åè¿ç¨ã</p>
<h3 id="clawd">Clawd</h3>
<p><strong>Clawd</strong> è¯çäº <strong>2025 å¹´ 11 æ</strong>ãä¸åçä¼¼é½å¾å®ç¾ï¼ç´å° <strong>Anthropic çæ³å¡å¢é</strong> éå¸¸ç¤¼è²å°èç³»äºä½èï¼è¯·ä»ãéæ°èèä¸ä¸è¿ä¸ªåå­ãã</p>
<p>åå åï¼å¤§å®¶æç ð</p>
<h3 id="moltbot">Moltbot</h3>
<p>æ¥ä¸æ¥è¯ççæ¯ <strong>Moltbot</strong>ã</p>
<p>è¿ä¸ªåå­æ¯å¨ <strong>åæ¨ 5 ç¹</strong>ï¼ä½èåç¤¾åºæåå¨ Discord ä¸è¿è¡äºä¸åºç¥æ¾æ··ä¹±çå¤´èé£æ´åæ²å®çã</p>
<p>âMoltï¼èç®ï¼âè±¡å¾çæé¿ââå°±åé¾è¾ä¸æ­è±å£³ï¼æç»åææ´å¼ºå¤§çä¸ªä½ãå¯æéå¸¸ç¾å¥½ï¼ä½é®é¢ä¹å¾ææ¾ï¼</p>
<blockquote>
<p>å¬èµ·æ¥æç¹æå£ï¼ä¸å¤ªå¥½å¿µã</p>
</blockquote>
<h3 id="openclawæç»å½¢æ">OpenClawï¼æç»å½¢æï¼</h3>
<p>æç»ï¼é¡¹ç®æ­£å¼æ´åä¸º <strong>OpenClaw</strong>ã</p>
<ul>
<li>åæ æ£ç´¢ç»æï¼â å®å¨</li>
<li>ååï¼â å·²è´­ä¹°</li>
<li>ä»£ç è¿ç§»ï¼â å·²å®æ</li>
</ul>
<p>è¿ä¸ªåå­ä¹æ°å¦å¶åå°æ¦æ¬äºé¡¹ç®çç°ç¶ï¼</p>
<ul>
<li><strong>Open</strong>ï¼å®å¨å¼æºï¼å¯¹ææäººå¼æ¾ï¼ç¤¾åºé©±å¨</li>
<li><strong>Claw</strong>ï¼é¾è¾ä¹çªï¼ä¼ æ¿æåçç²¾ç¥è±¡å¾</li>
</ul>
<hr>
<h2 id="ä»ä¹æ¯-openclaw">ä»ä¹æ¯ OpenClawï¼</h2>
<p>ä¸å¥è¯æ¦æ¬ï¼</p>
<blockquote>
<p><strong>OpenClaw æ¯ä¸ä¸ªè¿è¡å¨ä½ èªå·±çµèä¸çå¼æº AI Agent å¹³å°ã</strong></p>
</blockquote>
<p>å®å¯ä»¥ä¸ä½ æ¥å¸¸ä½¿ç¨çåç§èå¤©å·¥å·æ ç¼éæï¼</p>
<ul>
<li>WhatsApp</li>
<li>Telegram</li>
<li>Discord</li>
<li>Slack</li>
<li>Microsoft Teams</li>
</ul>
<p>æ è®ºä½ èº«å¨ä½å¤ï¼åªè¦è½åæ¶æ¯ï¼å°±è½éæ¶ææ¥ä½ ç AI å©æã</p>
<p>å®ç½ï¼</p>
<p>ð <a href="https://openclaw.ai/" target="_blank" rel="noopener nofollow">https://openclaw.ai/</a></p>
<hr>
<h1 id="å®è£quickstart">å®è£ï¼QuickStartï¼</h1>
<p>ä¸é¢æ¯å®æ¹æä¾çå¿«éä¸ææµç¨ï¼åºæ¬ä¸è·¯åè½¦ + éæ©å³å¯å®æã</p>
<ol>
<li>å¿«éå®è£ <code>curl -fsSL https://openclaw.ai/install.sh | bash</code></li>
<li>æç¤º <em>I understand this is powerful and inherently risky</em> â éæ© <strong>Yes</strong></li>
<li>Onboarding mode â <strong>QuickStart</strong></li>
<li>Model / auth provider â <strong>Z.AI (GLM 4.7)</strong></li>
<li>è¾å¥ <strong>Z.AI API Key</strong></li>
<li>Default model â é»è®¤</li>
<li>Select channel â <strong>WhatsApp (QR link)</strong></li>
<li>WhatsApp phone setup â <strong>This is my personal phone number</strong></li>
<li>è¾å¥ä½ ç <strong>WhatsApp æ³¨åææºå·</strong></li>
<li>Configure skills now? â <strong>Yes</strong></li>
<li>Node manager â <strong>npm</strong></li>
<li>Install missing skill dependencies â <strong>Skip for now</strong></li>
<li>GOOGLE_PLACES_API_KEY â <strong>No</strong></li>
<li>Enable hooks â <strong>Skip for now</strong></li>
<li>Hatch your bot â <strong>Hatch in TUI (recommended)</strong></li>
</ol>
<p><img alt="PixPin_2026-02-01_22-35-27.png" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3715916/202602/3715916-20260206095520117-748411763.png" class="lazyload"></p>
<hr>
<h1 id="openclaw-è½åä»ä¹">OpenClaw è½åä»ä¹ï¼</h1>
<p>ä½ å¯ä»¥æ OpenClaw çè§£ä¸ºï¼</p>
<blockquote>
<p><strong>ä¸ä¸ª 24 å°æ¶å¨çº¿ãå¯é¿æè¿è¡ãè½è®°ä½ä½ ä¹ æ¯çãæ°å­åå·¥ãã</strong></p>
</blockquote>
<p>å®ä¸ä»è½ä¸æ¬¡æ§å®æä»»å¡ï¼è¿å¯ä»¥ï¼</p>
<ul>
<li>æç»­æ§è¡</li>
<li>å®æ¶è§¦å</li>
<li>è®°ä½ä½ çåå¥½</li>
<li>éè¿ææºèå¤©è¿ç¨ææ§ä½ ççµè</li>
</ul>
<h3 id="ä¸äºçå®ä½¿ç¨åºæ¯">ä¸äºçå®ä½¿ç¨åºæ¯</h3>
<ol>
<li>
<p><strong>ä¿¡æ¯æ¶éä¸ç®æ¥</strong></p>
<blockquote>
<p>âæ¥ä¸ä¸ GitHub ä»æ¥ç­æ¦ï¼æ´çæç®æ¥ï¼æ¯å¤©æ©ä¸ 8 ç¹åç»æãâ</p>
</blockquote>
</li>
<li>
<p><strong>èªå¨åä¸è½½</strong></p>
<blockquote>
<p>âå»æå­¦ä¹ ç½ç«ï¼å¸®æä¸è½½ä¸å¥ Python æå­¦è§é¢ãâ</p>
</blockquote>
</li>
<li>
<p><strong>æ¢ç¥¨ / æ¢èµæº</strong><br>
æç½ååäº«ï¼éè¿ OpenClaw æåæ¢å°äºé«éç¥¨ï¼æ¯å¦æååå³äºè¿æ° + ç½ç»ç¯å¢ï¼ã</p>
</li>
<li>
<p><strong>æµè§å¨ä¸ç³»ç»æä½</strong><br>
èªå¨æä½ç½é¡µãè¡¨åå¡«åãæ°æ®æ´çï¼çæ­£åå°ãæ¿ä½ ç¹é¼ æ ãã</p>
</li>
</ol>
<p><img alt="PixPin_2026-02-01_22-50-44.png" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3715916/202602/3715916-20260206095520420-580560453.png" class="lazyload"></p>
<hr>
<h1 id="ä¸å¯å¿½è§çå¼ç«¯">ä¸å¯å¿½è§çå¼ç«¯</h1>
<p>å¨æè³ä¹å¤ï¼OpenClaw ä¹å¹¶éæ²¡æææ¬ã</p>
<ol>
<li>
<p><strong>Token æ¶èæå¤§</strong><br>
å¦æä½ ç¨çæ¯æéä»è´¹æ¨¡åï¼ççä¼âç§é±âï¼å»ºè®®åå°è§æ¨¡å°è¯ã</p>
</li>
<li>
<p><strong>æéè¦æ±éå¸¸é«</strong><br>
å®å ä¹ç­åäºâæçµèäº¤ç» AIâï¼</p>
<blockquote>
<p>çè®ºä¸ï¼å®<strong>ç¡®å®æè½åæ¸ç©ºä½ çæä»¶</strong>ã</p>
</blockquote>
<p>æä»¥ï¼</p>
<ul>
<li>ä¸è¦å¨ä¸»åçäº§ç¯å¢ç´æ¥ä½¿ç¨</li>
<li>ä¸è¦æäºä¸å¿è¦çæé</li>
</ul>
</li>
<li>
<p><strong>å½åç½ç»ç¯å¢æé¨æ§</strong><br>
éè¦ä½ å·å¤ä¸å®çãKeXueä¸ç½ãè½åï¼å¦åä½éªä¼å¤§æææ£ã</p>
</li>
</ol>
<hr>
<h1 id="å¦ä½å¸è½½-openclaw">å¦ä½å¸è½½ OpenClaw</h1>
<p>å¦æä½ åªæ¯å°é²ï¼æèä¸æç®ç»§ç»­ä½¿ç¨ï¼å¯ä»¥æä¸é¢æ­¥éª¤å®æ´å¸è½½ã</p>
<pre><code class="language-bash">openclaw uninstall
# ç©ºæ ¼+ç®­å¤´éæ©å¨é¨
</code></pre>
<p><img alt="PixPin_2026-02-02_09-23-18.png" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3715916/202602/3715916-20260206095520272-104191998.png" class="lazyload"></p>
<pre><code class="language-bash"># å®ä½å®è£è·¯å¾
which openclaw

# å¨å±å¸è½½
npm uninstall -g openclaw
# æ
pnpm remove -g openclaw

# æ¸çéç½®åç¼å­
rm -rf ~/.openclaw
rm -rf ~/.config/openclaw
rm -rf ~/.cache/openclaw

# /Users/ç¨æ·å/.zshrc éçopenclawå é¤ä¸
</code></pre>
<hr>
<h2 id="åå¨æå">åå¨æå</h2>
<p>OpenClaw ççç«ï¼å¹¶ä¸åªæ¯åä¸ä¸ªâå¥½ç©ç AI é¡¹ç®âï¼èæ¯ä¸ä¸ªéå¸¸æ¸æ°çä¿¡å·ï¼</p>
<blockquote>
<p><strong>AI Agent æ­£å¨ä»å®éªå®¤ï¼èµ°åæ®éäººççå®çæ´»ã</strong></p>
</blockquote>
<p>å®æè®¸è¿ä¸å®ç¾ï¼çè³æç¹å±é©ï¼ä½æ¯«æ çé®ââ</p>
<p><strong>æªæ¥ï¼è¶æ¥è¶å¤çå·¥ä½ï¼ççä¼äº¤ç» AI æ¥å®æã</strong></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-06 10:09">2026-02-06 10:08</span>&nbsp;
<a href="https://www.cnblogs.com/bugshare">BugShare</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19582865);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19582865', targetLink: 'https://www.cnblogs.com/bugshare/p/19582865', title: 'ClawdBot åºåè®°ï¼AI Agent æ­£å¨èµ°åå¤§ä¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ QTå¿«éå¼åæ¡æ¶ ]]></title>
    <link>https://www.cnblogs.com/tlink/p/19582758</link>
    <guid>bd6c30ecd243bc1d15be1991aa97f821</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/tlink/p/19582758" title="åå¸äº 2026-02-06 09:49">
    <span role="heading" aria-level="2">QTå¿«éå¼åæ¡æ¶</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        Qt Qtå¼åCMake
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="qtmachinedogåå«éå¤é è½®å­qt-å¿«éå¼åèææ¶">QtMachineDogï¼åå«éå¤é è½®å­ï¼Qt å¿«éå¼åèææ¶</h1>
<p><strong>"ä¸ç®¡å¤å°ç Qt é¡¹ç®ï¼æ»æä¸å çç¢ä½å¿è¦çäºæè¦åã"</strong></p>
<p>ä½ä¸ºä¸ä¸ª Qt å¼åèï¼ä½ æ¯å¦ç»åè¿ï¼</p>
<ul>
<li>æ¯æ¬¡æ°å»ºé¡¹ç®é½è¦éåä¸éæ¥å¿ç³»ç»ï¼</li>
<li>ç¨åºå´©æºåç¨æ·è¯´"ä¸ç¥éåçäºä»ä¹"ï¼èä½ æ ¹æ¬æ¿ä¸å°å æ ï¼</li>
<li>éç½®æä»¶æ£è½å¨åå¤ï¼çæ¬åçº§åéç½®ä¸¢å¤±ï¼</li>
<li>HTTP è¯·æ±å°è£åäºæ æ°æ¬¡ï¼æ¯æ¬¡é½è¦éæ°è§£æ JSONï¼</li>
<li>ç®åçæ°æ® CRUD æä½ï¼å´è¦éåå¤§éæ ·æ¿ä»£ç ï¼</li>
</ul>
<p>è¿äºé®é¢<strong>åå·ä½ä¸å¡æ å³</strong>ï¼å´<strong>æ¯ä¸ªé¡¹ç®é½è¦é¢å¯¹</strong>ãè¿å°±æ¯æå <strong>QtMachineDog</strong> çåå ââ<strong>æéç¨çäºä¸æ¬¡åå¥½ï¼è®©å¼åèä¸æ³¨äºä¸å¡é»è¾</strong>ã</p>
<p>å¼æºå°åï¼<a href="https://gitee.com/Tlink/machine" target="_blank" rel="noopener nofollow">https://gitee.com/Tlink/machine</a></p>
<hr>
<h2 id="ç®åä»ç»">ç®åä»ç»</h2>
<p><strong>QtMachineDog</strong> æ¯ä¸ä¸ªåºäº <strong>CMake</strong> ç Qt å¿«éå¼åæ¡æ¶/èææ¶ãå®ä¸æ¯è¯å¾æ¿ä»£ Qtï¼èæ¯å¡«è¡¥"é¡¹ç®åå§å"å°"ä¸å¡å¼å"ä¹é´çç©ºç½ââ<strong>ä½ ä¸åéè¦ä¸ºæ¯ä¸ªé¡¹ç®å¤å¶ç²è´´åºç¡è®¾æ½ä»£ç </strong>ã</p>
<p>æ ¸å¿å®ä½ï¼<strong>å¼ç®±å³ç¨çé¡¹ç®éª¨æ¶ï¼èéééçº§ä¸å¡æ¡æ¶</strong></p>
<hr>
<h2 id="åè½äº®ç¹å³æ¿å³ç¨">åè½äº®ç¹ï¼å³æ¿å³ç¨ï¼</h2>
<table>
<thead>
<tr>
<th>åè½æ¨¡å</th>
<th>è§£å³çé®é¢</th>
<th>äº®ç¹ç¹æ§</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ð æ¥å¿ç³»ç»</strong></td>
<td>åå« qDebug() æ»¡å¤©é£</td>
<td>åçº§æ¥å¿ãæä»¶è½®è½¬ãå¤çº¿ç¨å®å¨</td>
</tr>
<tr>
<td><strong>ð¥ å¨å±å¼å¸¸å¤ç</strong></td>
<td>å´©æºæ è¿¹å¯å¯»</td>
<td>èªå¨æè·å´©æºä¿¡å·ï¼çæå®æ´å æ æ¥å¿ï¼<strong>åä¹ä¸æç¨æ·è¯´"ç¨åºçªç¶æ²¡äº"</strong></td>
</tr>
<tr>
<td><strong>âï¸ éç½®ä¸­å¿</strong></td>
<td>éç½®ç®¡çæ··ä¹±</td>
<td>å¨å±ç»ä¸çéç½®æä»¶ç®¡çï¼æ¯æçæ¬å¼å®¹ãèªå¨å¤ä»½</td>
</tr>
<tr>
<td><strong>ð¾ æä¹åæ°æ®</strong></td>
<td>æ°æ®å­å¨éå¤é è½®å­</td>
<td>å°è£å¥½çæ¬å°å­å¨æ¹æ¡ï¼ä¸å¡å±ç´æ¥è°ç¨</td>
</tr>
<tr>
<td><strong>ð HTTP æ¨¡å</strong></td>
<td>ç½ç»è¯·æ±ä»£ç åä½</td>
<td>åºäºç°ä»£ Qt ç½ç»æ çè¯·æ±å°è£ï¼èªå¨ JSON è§£æãéè¯¯å¤çãè¶æ¶éè¯</td>
</tr>
<tr>
<td><strong>ðï¸ æ°æ® CRUD æ¨¡æ¿</strong></td>
<td>æ¯æ¬¡é½è¦åå¢å æ¹æ¥</td>
<td><strong>å¯å¤å¶çä¸å¡æ¨¡æ¿</strong>ï¼å¤å¶ç²è´´å³å¯ç¨äºæ°æ¨¡åï¼éµå¾ªç»ä¸è®¾è®¡æ¨¡å¼</td>
</tr>
<tr>
<td><strong>ð·ï¸ çæ¬ç®¡ç</strong></td>
<td>çæ¬å·æ··ä¹±ãèªå¨æ´æ°å°é¾</td>
<td>è¯­ä¹åçæ¬ç®¡çï¼åç½®æ´æ°æ£æ¥æ¥å£</td>
</tr>
<tr>
<td><strong>ð¥ï¸ Self-Host Web æå¡</strong></td>
<td>éè¦ååµ HTTP æå¡</td>
<td>åç½®è½»éçº§ Web Serverï¼å¯ç¨äºæ¬å° API æçæ§é¢æ¿</td>
</tr>
<tr>
<td><strong>ð¨ FontAwesome éæ</strong></td>
<td>å¾æ èµæºç®¡çéº»ç¦</td>
<td>åç½® FontAwesomeï¼æ¯æ<strong>å¨æé¢è²/å¤§å°æ§å¶</strong>ï¼æ éåå¤å¤å¥å¾æ èµæº</td>
</tr>
<tr>
<td><strong>ð å¨æåºç®¡ç</strong></td>
<td>DLL/SO å è½½ç¹ç</td>
<td>ç»ä¸çå¨æé¾æ¥åºå è½½ãç­æææ¯æ</td>
</tr>
<tr>
<td><strong>ð§ CMake ç°ä»£å</strong></td>
<td>è·¨å¹³å°æå»ºå¤´ç¼</td>
<td>å¨ CMake æå»ºï¼æ¯æ Windows/Linux/macOSï¼ç¬¬ä¸æ¹ä¾èµèªå¨æå</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="-è°éè¦è¿ä¸ªé¡¹ç®">ð¡ è°éè¦è¿ä¸ªé¡¹ç®ï¼</h2>
<p>â <strong>ä¸ªäººå¼åè</strong>ï¼å¿«éå¯å¨ Side Projectï¼ä¸ç¨æ¯æ¬¡é½éåºç¡è®¾æ½<br>
â <strong>å°å¢é</strong>ï¼ç»ä¸é¡¹ç®ç»æï¼æ°äººä¸æææ¬éä½ 80%<br>
â <strong>ä¼ä¸é¡¹ç®</strong>ï¼ä½ä¸ºåºç¡èææ¶ï¼ç¡®ä¿ææé¡¹ç®æç»ä¸çæ¥å¿ãå´©æºæ¶éæ åãå¿«éå¼åç¤ºä¾<br>
â <strong>å­¦ä¹ è</strong>ï¼éè¿å®æä»£ç å­¦ä¹  Qt å·¥ç¨åæä½³å®è·µï¼å¼å¸¸å¤çãCMake æ¨¡ååç­ï¼</p>
<hr>
<p>é¡¹ç®ç»æéµå¾ª<strong>æ¨¡ååè®¾è®¡</strong>ï¼ä½ å¯ä»¥ï¼</p>
<ul>
<li><strong>å¨éä½¿ç¨</strong>ï¼ä½ä¸ºå®æ´èææ¶å¯å¨æ°é¡¹ç®</li>
<li><strong>æéæå</strong>ï¼åªæ·è´ä½ éè¦çæ¨¡åï¼å¦åªæ¿ Crash Handler å Loggerï¼å°ç°æé¡¹ç®</li>
</ul>
<hr>
<h2 id="-å ä¸ªå¼å¾åç¬è¯´çäº®ç¹">ð å ä¸ªå¼å¾åç¬è¯´çäº®ç¹</h2>
<h3 id="1-å´©æºå¤çè®©çå­¦-bugç°å½¢">1. å´©æºå¤çï¼è®©"çå­¦ Bug"ç°å½¢</h3>
<p><img alt="å¼å¸¸æè·" loading="lazy" data-src="https://img2024.cnblogs.com/blog/394390/202602/394390-20260206092938711-477324808.png" class="lazyload"></p>
<pre><code class="language-cpp">void ExceptionHandler::setup()
{
    try {
        spdlog::info("Setting up exception handlers...");

        // 1. è®¾ç½® C++ å¼å¸¸å¤ç
        originalTerminateHandler = std::get_terminate();
        std::set_terminate(&amp;ExceptionHandler::terminateHandler);

        // 2. è®¾ç½® Qt æ¶æ¯å¤ç
        originalQtMessageHandler = qInstallMessageHandler(&amp;ExceptionHandler::qtMessageHandler);

        // 3. è®¾ç½®ä¿¡å·å¤ç - å³é®ï¼æè·æ®µéè¯¯ç­
        std::signal(SIGSEGV, ExceptionHandler::signalHandler);  // æ®µéè¯¯
        std::signal(SIGABRT, ExceptionHandler::signalHandler);  // abort()
        std::signal(SIGFPE,  ExceptionHandler::signalHandler);  // æµ®ç¹å¼å¸¸
        std::signal(SIGILL,  ExceptionHandler::signalHandler);  // éæ³æä»¤

        // æ³¨æï¼ä¸è¦æè· SIGTERM å SIGINTï¼è®©ç¨åºå¯ä»¥æ­£å¸¸éåº
        // std::signal(SIGTERM, ExceptionHandler::signalHandler);  // ç»æ­¢ä¿¡å·
        // std::signal(SIGINT,  ExceptionHandler::signalHandler);   // Ctrl+C

        spdlog::info("Exception handlers installed successfully");

    } catch (const std::exception&amp; e) {
        spdlog::error("Failed to install exception handlers: {}", e.what());
    }
}
</code></pre>
<h3 id="2-fontawesomeå­ä½å¾æ éæ©ä¸ä½¿ç¨">2. fontawesomeå­ä½å¾æ éæ©ä¸ä½¿ç¨</h3>
<p><img alt="å¾æ éæ©" loading="lazy" data-src="https://img2024.cnblogs.com/blog/394390/202602/394390-20260206093141475-92359367.png" class="lazyload"></p>
<pre><code class="language-cpp">
    ui-&gt;btnErrorTest-&gt;setIcon(FontManager::ins().icon(0xf06a, {24,24}, QColor(200,0,0)));
    ui-&gt;btnIconChoose-&gt;setIcon(FontManager::ins().icon(0xf2b4, {24,24}, QColor(0,0,255)));
    ui-&gt;btnConfigLoad-&gt;setIcon(FontManager::ins().icon(0xf1de, {24,24}, QColor("#228B22")));
    ui-&gt;btnMylib-&gt;setIcon(FontManager::ins().icon(0xf0e7, {24,24}, QColor(255,0,0)));

</code></pre>
<p><img alt="ScreenShot_2026-02-06_093231_592" loading="lazy" data-src="https://img2024.cnblogs.com/blog/394390/202602/394390-20260206093254099-308842350.png" class="lazyload"></p>
<h3 id="3-crud-æ¨¡æ¿ä¸å¡å¼åçå¤å¶ç²è´´ç¥å¨æ¬ç¨åºä½¿ç¨çæ°æ®åºä¸ºsqlite">3. CRUD æ¨¡æ¿ï¼ä¸å¡å¼åçå¤å¶ç²è´´ç¥å¨ï¼æ¬ç¨åºä½¿ç¨çæ°æ®åºä¸ºsqliteï¼</h3>
<p>é¡¹ç®æä¾äºä¸å¥åºäº Qt Model/View çéç¨æ°æ®æä½æ¨¡æ¿ï¼<strong>å¼åæ°æ¨¡åæ¶ï¼å¤å¶æ¨¡æ¿æä»¶å¤¹ï¼æ¹æ¹ç±»åå°±è½ç¨</strong>ï¼åå«ï¼</p>
<ul>
<li>æ°æ®æ¨¡åå®ä¹</li>
<li>æ°æ®åºæä½æ¥å£</li>
<li>è§å¾ç»å®é»è¾</li>
<li>åºç¡çå¢å æ¹æ¥ UI</li>
</ul>
<p><img alt="æ°æ®å¢å æ¥æ¹" loading="lazy" data-src="https://img2024.cnblogs.com/blog/394390/202602/394390-20260206093339674-1009180056.png" class="lazyload"></p>
<p><img alt="æ°æ®å¢å æ¥æ¹2" loading="lazy" data-src="https://img2024.cnblogs.com/blog/394390/202602/394390-20260206093358121-855410219.png" class="lazyload"></p>
<pre><code>void UserDao::initTable()
{
    QSqlQuery q(DbManager::instance().db());
    q.exec("CREATE TABLE IF NOT EXISTS user("
           "id   INTEGER PRIMARY KEY AUTOINCREMENT,"
           "name TEXT NOT NULL,"
           "username TEXT NOT NULL,"
           "email TEXT NULL,"
           "pwd TEXT NULL,"
           "picpath TEXT NULL,"
           "status  TEXT NOT NULL,"
           "registertime TEXT NULL,"
           "lastlogintime TEXT NULL,"
           "phonenum TEXT NULL,"
           "notes TEXT NULL,"
           "age  INTEGER,"
           "roles INTEGER,"
           "gender INTEGER)");

}

int UserDao::addUser(const User &amp;user)
{
    QSqlQuery q(DbManager::instance().db());
    q.prepare("INSERT INTO user(name,username,email,picpath,status,registertime,lastlogintime,phonenum,age,roles,gender,pwd,notes) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)");
    q.addBindValue(user.name);
    q.addBindValue(user.username);
    q.addBindValue(user.email);
    q.addBindValue(user.picpath);
    q.addBindValue(user.status);
    q.addBindValue(user.registertime);
    q.addBindValue(user.lastlogintime);
    q.addBindValue(user.phonenum);
    q.addBindValue(user.age);
    q.addBindValue(user.roles);
    q.addBindValue(user.gender);
    q.addBindValue(user.pwd);
    q.addBindValue(user.notes);
    if (!q.exec()) {
        qWarning() &lt;&lt; "insert user error:" &lt;&lt; q.lastError().text();
       // spdlog::error("insert user error:"+ q.lastError().text().toStdString());
        return -1;
    }
    return q.lastInsertId().toInt();
}

bool UserDao::deleteUser(int id)
{
    QSqlQuery q(DbManager::instance().db());
    q.prepare("DELETE FROM user WHERE id=?");
    q.addBindValue(id);
    return q.exec();
}
bool UserDao::updateUser(const User &amp;user)
{
    if (user.id &lt;= 0) return false;
    QSqlQuery q(DbManager::instance().db());
    q.prepare("UPDATE user SET name=?,username=?,email=?,picpath=?,status=?,registertime=?,lastlogintime=?,phonenum=?,age=?,roles=?,gender=?,pwd=?,notes=? WHERE id=?");
    q.addBindValue(user.name);
    q.addBindValue(user.username);
    q.addBindValue(user.email);
    q.addBindValue(user.picpath);
    q.addBindValue(user.status);
    q.addBindValue(user.registertime);
    q.addBindValue(user.lastlogintime);
    q.addBindValue(user.phonenum);
    q.addBindValue(user.age);
    q.addBindValue(user.roles);
    q.addBindValue(user.gender);
    q.addBindValue(user.pwd);
    q.addBindValue(user.notes);
    q.addBindValue(user.id);
    return q.exec();
}
</code></pre>
<h3 id="4-selfhost-webæå¡-å¯ååµ-http-æå¡--åç½®è½»éçº§-web-serverå¯ç¨äºæ¬å°-api-æçæ§é¢æ¿">4. SelfHost Webæå¡-å¯ååµ HTTP æå¡ | åç½®è½»éçº§ Web Serverï¼å¯ç¨äºæ¬å° API æçæ§é¢æ¿</h3>
<h2 id="_"><img alt="selfhost_web" loading="lazy" data-src="https://img2024.cnblogs.com/blog/394390/202602/394390-20260206093453322-1637423536.png" class="lazyload"></h2>
<h2 id="-åå¨æå">ð¬ åå¨æå</h2>
<p>QtMachineDog ä¸æ¯ä¸ä¸ªå¤§èå¨çæ¡æ¶ï¼èæ¯ä¸ä¸ª<strong>å¡å®çè§£å³æ¹æ¡</strong>ââè§£å³é£äº<strong>æ¯ä¸ª Qt é¡¹ç®é½ä¼éå°ãå´æ²¡æäººç³»ç»æ´çè¿</strong>çé®é¢ã</p>
<p>å¦æä½ ä¹æ¾ä¸º"åè¦éåæ¥å¿ç³»ç»"èç¦æ¼ï¼ä¸å¦¨è¯è¯è¿ä¸ªæ¡æ¶ã<strong>æéå¤çäºæäº¤ç» MachineDogï¼ä½ ä¸å¿åç¬ä¸æ äºçåè½ã</strong></p>
<hr>
<h2 id="ä¸ä¸æ­¥éæaspnet-coreåå¸åçselfhost">ð§ä¸ä¸æ­¥éæasp.net coreåå¸åçselfhost</h2>
<p>ä½¿ç¨SignalRï¼éè¿apiæ¥æ¥åè®¾å¤çå®æ¶ç¶æï¼å¹¶è½»éçwebè¾åºå°ç½ç»<br>
asp.net coreç¸å³çå¤çæ°æ®api demo<br>
æ¢ä¿è¯äºå·¥ä¸è®¾å¤çç¨³éï¼æ¡é¢ç¨åºï¼ï¼åè½ä½¿æ°æ®æµå¨åå¾è½»çï¼webç¨åºï¼</p>
<h2 id="å¦æå¯¹ä½ æå¸®å©æå¯åè¯·å¸®å¿è½¬åç¹èµstaræ¨çæ¯ææ¯æçæå¤§å¨å">å¦æå¯¹ä½ æå¸®å©æå¯åï¼è¯·å¸®å¿è½¬åç¹èµï¼starï¼æ¨çæ¯ææ¯æçæå¤§å¨å</h2>
<p>å¼æºå°åï¼<a href="https://gitee.com/Tlink/machine" target="_blank" rel="noopener nofollow">https://gitee.com/Tlink/machine</a></p>
<p><strong>#Qt #Qtå¼å #CMake #å¼æºé¡¹ç® #C++ #è·¨å¹³å°å¼å</strong></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.06319444444444444" data-date-updated="2026-02-06 11:20">2026-02-06 09:49</span>&nbsp;
<a href="https://www.cnblogs.com/tlink">Tlink</a>&nbsp;
éè¯»(<span id="post_view_count">108</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19582758);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19582758', targetLink: 'https://www.cnblogs.com/tlink/p/19582758', title: 'QTå¿«éå¼åæ¡æ¶' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ FastAPIå®æï¼ç¨æå è½½ä¸Lifespanä¼éç®¡çéåä¾èµ ]]></title>
    <link>https://www.cnblogs.com/ymtianyu/p/19582659</link>
    <guid>0a24af52e0c55ef962ccabd1873c3831</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ymtianyu/p/19582659" title="åå¸äº 2026-02-06 09:28">
    <span role="heading" aria-level="2">FastAPIå®æï¼ç¨æå è½½ä¸Lifespanä¼éç®¡çéåä¾èµ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ¬æéå¯¹FastAPIåºç¨å¨é¨ç½²æçå¾ç­å¤§æ¨¡åæ¶éå°çå¯å¨æ¢ãèµæºå ç¨é«é®é¢ï¼æ·±å¥åæäºåºç¨å¯å¨ï¼å·å¯å¨ï¼ä¸è¯·æ±å¤çï¼ç­è·¯å¾ï¼çåºå«ãæ ¸å¿ä»ç»äºå©ç¨æå è½½æ¨¡å¼ä¸Lifespanäºä»¶ç®¡çä¸ä¸æï¼å°èæ¶çåå§åæä½ä»å¯å¨è¿ç§»å°é¦æ¬¡è¯·æ±æ¶æè¿è¡å¼æ­¥é¢ç­ï¼ä»èå®ç°æå¡çå¿«éå¯å¨ä¸é«æèµæºå©ç¨ï¼å¹¶æä¾äºè¯¦ç»çä»£ç ç¤ºä¾ä¸é¿åæåã
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<h2>ä½ çFastAPIæå¡ï¼æ¯ä¸æ¯ä¹å¨å¯å¨æ¶"è´éè·æ­¥"ï¼</h2>
<p>ææ²¡æéå°è¿è¿ç§åºæ¯ï¼ä½ å´å²å²å°åå®äºä¸ä¸ªæçå¾AIæå¡çæ¥å£ï¼æ¬å°æµè¯ç¾æ»æ»ãç»æä¸ä¸æå¡å¨ï¼<code style="color: rgba(186, 55, 42, 1)">docker build</code> å®ï¼<code style="color: rgba(186, 55, 42, 1)">docker run</code> çé£ä¸ç¬é´ï¼ä½ æè§ä»¿ä½è¿äºä¸ä¸ªä¸çºªââæå¡æä¹è¿æ²¡èµ·æ¥ï¼</p>
<p>ç¶åçæ¥å¿ï¼å¥½å®¶ä¼ï¼å¡å¨<code style="color: rgba(186, 55, 42, 1)">Loading model...</code> è¿ä¸æ­¥äºãæ¨¡åå¥½å ä¸ªGï¼å è½½æ¢å¦çãæ´ç³çæ¯ï¼ä½ çK8så¥åº·æ£æ¥å¯è½å ä¸ºå¯å¨è¶æ¶ï¼åå¤ææäºè¿å¨"ç­èº«"çPodï¼å¯¼è´æå¡æ°¸è¿æ æ³å°±ç»ªð¯ã</p>
<p>ä»å¤©ï¼å±ä»¬å°±èèæä¹ç»FastAPIæå¡"åè´"ï¼è®©å¯å¨é£å¿«ï¼åæ¶åè½ä¼éå°ç®¡çé£äº"éåæ­¦å¨"ï¼æ¯å¦å¤§æ¨¡åãå¤§æ°æ®è¿æ¥ï¼ãæ ¸å¿å°±ä¿©æ¦å¿µï¼<strong style="color: rgba(186, 55, 42, 1)">æå è½½</strong>å<strong style="color: rgba(186, 55, 42, 1)">Lifespanäºä»¶</strong>ã</p>
<hr style="border: none; height: 1px; background: linear-gradient(90deg, rgba(0, 0, 0, 0), rgba(52, 152, 219, 1), rgba(0, 0, 0, 0)); margin: 20px 0">
<h2>ð¯ åææ¸é®é¢ï¼å¯å¨ vs è¿è¡æ¶</h2>
<p>å±ä»¬å¾ååæ¸ä¸¤ä¸ªé¶æ®µï¼è¿å°±åé¤åå¼ä¸ï¼</p>
<div>
<p>ð¥ <strong>å·å¯å¨ï¼åºç¨å¯å¨ï¼</strong>ï¼ç¸å½äºé¤åç¬¬ä¸å¤©å¼ä¸ãä½ ä¸è½è®©å®¢äººå¨é¨å£ç­å¨å¸æææèé½åä¸éå°è¿æå¼é¨ãæä»¬çç®æ æ¯<strong style="color: rgba(186, 55, 42, 1)">è¶å¿«å¼é¨è¶å¥½</strong>ã</p>
<p>ð³ <strong>ç­è·¯å¾ï¼è¯·æ±å¤çï¼</strong>ï¼å®¢äººç¹ååï¼åå¨å¼å§çèãè¿æ¶åè¿½æ±çæ¯åéèçåºèéåº¦åè´¨éã</p>
</div>
<p>å¾å¤åå¼ï¼åæ¬å½åçæï¼ä¼æå è½½æ¨¡åè¿ç§"å¤è"å·¥ä½ï¼ç´æ¥æå¨å¨å±åééï¼å¨åºç¨å¯å¨æ¶æ§è¡ãç»æå°±æ¯"å¼ä¸"ä»ªå¼å·¨é¿æ æ¯ã</p>
<p>ä½ å¯è½ä¼é®ï¼"é£æä¸ç¨çæ¶åä¸å è½½ï¼ç¨çæ¶ååå è½½ï¼ä¸å°±è¡äºï¼"</p>
<p>Bingoï¼è¿å°±æ¯<strong style="color: rgba(186, 55, 42, 1)">æå è½½ï¼Lazy Loadingï¼</strong>çæ ¸å¿ææ³ï¼æèæ¶åå§åæ¨è¿å°ç¬¬ä¸æ¬¡çæ­£éè¦å®çæ¶åãä½å¨Webæå¡éï¼æä¹ä¼éå°å®ç°å®ï¼å¹¶ä¸ç®¡çå®ççå½å¨æå¢ï¼è¿å°±è½®å°<code style="color: rgba(186, 55, 42, 1)">lifespan</code>åºåºäºã</p>
<h2>ð¤ æ ¸å¿æ­¦å¨ï¼Lifespan äºä»¶ç®¡çå¨</h2>
<p>å¨FastAPIï¼å®éä¸æ¯èåçStarletteï¼ä¸­ï¼<code style="color: rgba(186, 55, 42, 1)">lifespan</code> æ¯ä¸ä¸ªä¸ä¸æç®¡çå¨ï¼å®è®©ä½ è½ç²¾ç¡®æ§å¶åºç¨<strong style="color: rgba(186, 55, 42, 1)">å¯å¨å</strong>å<strong style="color: rgba(186, 55, 42, 1)">å³é­å</strong>è¯¥åä»ä¹ã</p>
<p>å®æ¹ææ¡£å¯è½è®²å¾æç¹æ½è±¡ï¼ææä¸ªæ¯æ¹ï¼å®å°±åæ¯ä½ æå¡ç"ç§äººç®¡å®¶"ãæå¡ä¸çº¿åï¼<code style="color: rgba(186, 55, 42, 1)">startup</code>ï¼ï¼ç®¡å®¶å¸®ä½ é¢ç­æ¸¸æ³³æ± ãæå¼è±å­ç¯ï¼æå¡ä¸çº¿æ¶ï¼<code style="color: rgba(186, 55, 42, 1)">shutdown</code>ï¼ï¼ç®¡å®¶å¸®ä½ å³ç¯ãæ¾ææ³³æ± æ°´ï¼æ¶æ¾å¾å¹²å¹²ååã</p>
<p>éç¹æ¥äºï¼è¿ä¸ª"ç®¡å®¶"åºç°çæ¶é´ç¹ï¼æ¯ä½ æææ¥å£ç<code style="color: rgba(186, 55, 42, 1)">dependencies</code>é½è¦æ©ï¼è¿æå³çä½ å¯ä»¥å¨<code style="color: rgba(186, 55, 42, 1)">lifespan</code>éåå¤å¥½ä¸äº"å·¥å"æè"è¿æ¥æ± "ï¼ä½<strong style="color: rgba(186, 55, 42, 1)">ä¸ä¸å®éè¦ç«å»å è½½ææéåèµæº</strong>ã</p>
<pre class="language-python highlighter-hljs"><code>from contextlib import asynccontextmanager
from fastapi import FastAPI
import asyncio

# è¿æ¯ä¸ä¸ªåç"éåæ¨¡å"
class HeavyModel:
    def __init__(self):
        self.loaded = False
    
    async def load(self):
        print("å¼å§å è½½æ¨¡å...è¿å¯è½éè¦å¾ä¹")
        await asyncio.sleep(5) # æ¨¡æå è½½èæ¶
        self.loaded = True
        print("æ¨¡åå è½½å®æ¯ï¼")
    
    async def predict(self, text: str):
        if not self.loaded:
            await self.load() # æå è½½åçå¨è¿éï¼
        return f"é¢æµç»æ for: {text}"

@asynccontextmanager
async def lifespan(app: FastAPI):
    # Startup: è¿éæä»¬åªåå§å"æ¨¡åå®¹å¨"ï¼ä½ä¸å è½½æ¨¡åæ¬èº«
    print("åºç¨å¯å¨ä¸­...")
    model_container = {"model": HeavyModel()}
    app.state.model = model_container["model"]
    
    yield model_container # è¿éçmodel_containerä¼æ³¨å¥å°è¯·æ±ç`app.state`ä¸­
    
    # Shutdown: æ¸çå·¥ä½ï¼æ¯å¦å³é­æ¨¡åãéæ¾GPUåå­ç­
    print("åºç¨å³é­ä¸­ï¼æ§è¡æ¸ç...")
    app.state.model = None

app = FastAPI(lifespan=lifespan)

@app.get("/generate")
async def generate(prompt: str):
    # é¦æ¬¡è¯·æ±æ¶ï¼æä¼çæ­£è§¦åæ¨¡åå è½½
    result = await app.state.model.predict(prompt)
    return {"result": result}</code></pre>
<p>çä¸é¢ä»£ç ï¼<code style="color: rgba(186, 55, 42, 1)">HeavyModel</code>å¨<code style="color: rgba(186, 55, 42, 1)">lifespan</code>çå¯å¨é¶æ®µåªæ¯è¢«<strong style="color: rgba(186, 55, 42, 1)">å®ä¾å</strong>äºï¼å¹¶æ²¡æè°ç¨èæ¶ç<code style="color: rgba(186, 55, 42, 1)">load()</code>æ¹æ³ãçæ­£çå è½½åçå¨ç¬¬ä¸ä¸ªè¯·æ±è°ç¨<code style="color: rgba(186, 55, 42, 1)">predict</code>æ¶ã</p>
<p><strong style="color: rgba(186, 55, 42, 1)">è¿æ ·åçå¥½å¤æ¯ä»ä¹ï¼</strong></p>
<div>
<p>1ï¸â£ <strong>å¯å¨éåº¦é£èµ·</strong>ï¼ä½ çæå¡å ä¹å¯ä»¥ç§çº§å°±ç»ªï¼éè¿å¥åº·æ£æ¥ã</p>
<p>2ï¸â£ <strong>èµæºæéä½¿ç¨</strong>ï¼å¦ææä¸ªPodä¸ç´æ²¡æ¶å°ç¸å³è¯·æ±ï¼æ¨¡åå°±æ°¸è¿ä¸ä¼å è½½ï¼èçäºå®è´µçGPUåå­ã</p>
<p>3ï¸â£ <strong>çå½å¨æå¯æ§</strong>ï¼ä½ ä¾ç¶å¨<code style="color: rgba(186, 55, 42, 1)">lifespan</code>çææ§ä¹ä¸­ï¼å¯ä»¥å¨å³é­æ¶ä¼éå°éæ¾èµæºã</p>
</div>
<h2>â ï¸ ä½æ¯ï¼å°å¿è¿ä¸ª"å¤©å"</h2>
<p>æå è½½è½å¥½ï¼ä½ç´æ¥ç¨å¨çäº§ç¯å¢ï¼å¯è½ä¼è®©ç¬¬ä¸ä¸ªç¨æ·æä¸º"å¤§å¤ç§"ãæ³è±¡ä¸ä¸ï¼ç¨æ·ç¬¬ä¸æ¬¡è¯·æ±ï¼è¦ç½å±ç­å¾æ¨¡åå è½½çå åç§ï¼ä½éªæå·®ï¼èä¸è¿ä¸ªè¯·æ±å¾å¯è½è¶æ¶ã</p>
<p>æä»¥ï¼æ´ä¼ççäº§çº§å®è·µæ¯ï¼<strong style="color: rgba(186, 55, 42, 1)">æå è½½ + å¼æ­¥é¢ç­</strong>ã</p>
<p>æä»¬å¯ä»¥å¨<code style="color: rgba(186, 55, 42, 1)">lifespan</code>å¯å¨å®æåï¼<strong style="color: rgba(186, 55, 42, 1)">ææå°ãå¼æ­¥å°</strong>å¼å§å è½½æ¨¡åï¼èä¸æ¯é»å¡å¯å¨è¿ç¨ã</p>
<pre class="language-python highlighter-hljs"><code>@asynccontextmanager
async def lifespan(app: FastAPI):
    # Startup
    print("åºç¨å¯å¨ä¸­...")
    model = HeavyModel()
    app.state.model = model

    # **å³é®æå·§ï¼åå»ºä¸ä¸ªåå°ä»»å¡å¼æ­¥é¢ç­**
    async def _warm_up():
        try:
            await model.load()
            print("æ¨¡åé¢ç­å®æï¼")
        except Exception as e:
            print(f"æ¨¡åé¢ç­å¤±è´¥: {e}")

    # ä¸awaitï¼è®©å®åå°è¿è¡
    asyncio.create_task(_warm_up())

    yield
    # Shutdown
    print("åºç¨å³é­ä¸­...")</code></pre>
<p>è¿æ ·ï¼æå¡è½ç«å»å¯å¨å¹¶ååºå¥åº·æ£æ¥ãæ¨¡åå¨åå°é»é»å è½½ï¼å è½½å®æåæçæ­£æä¾é¢æµæå¡ãå¯¹äºå è½½æé´çè¯·æ±ï¼ä½ å¯ä»¥æ ¹æ®ä¸å¡å³å®æ¯è¿åä¸ä¸ª"æå¡é¢ç­ä¸­"çåå¥½æç¤ºï¼è¿æ¯ç¨éåè®©å¶ç­å¾ã</p>
<h2>ð§ æ´å·¥ç¨åçå°è£ä¸æ³¨æäºé¡¹</h2>
<p>å¨å®éé¡¹ç®ä¸­ï¼æä»¬ä¸ä¼æé»è¾å¨å<code style="color: rgba(186, 55, 42, 1)">lifespan</code>ä¸»å½æ°éãæçä¹ æ¯æ¯å°è£ä¸ä¸ª<code style="color: rgba(186, 55, 42, 1)">ModelManager</code>åä¾ç±»ï¼æ¥ç»ä¸ç®¡çå è½½ç¶æãéè¯åå¹¶åå®å¨ã</p>
<p>åè¯´å ä¸ªå®¹æç¿»è½¦çç¹ï¼</p>
<div>
<p>ð¯ <strong>å¹¶åè¯·æ±æ¶çéå¤å è½½</strong>ï¼å¦æç¬¬ä¸ä¸ªè¯·æ±Aè§¦åå è½½æ²¡å®ï¼è¯·æ±Båæ¥äºï¼è¦ç¡®ä¿ä¸ä¼åå§åä¸¤ä¸ªæ¨¡åå®ä¾æåå­æçãè®°å¾ç¨éï¼<code style="color: rgba(186, 55, 42, 1)">asyncio.Lock</code>ï¼æèæ£æ¥ç¶æåéã</p>
<p>ð¯ <strong>å¥åº·æ£æ¥çè®¾è®¡</strong>ï¼ä½ ç<code style="color: rgba(186, 55, 42, 1)">/health</code>ç«¯ç¹åºè¯¥åæ æå¡ççå®ç¶æãå¯ä»¥è®¾è®¡æï¼<code style="color: rgba(186, 55, 42, 1)">{"status": "warming_up"}</code>ï¼<code style="color: rgba(186, 55, 42, 1)">{"status": "ready"}</code>ãè¿æ ·K8sç<code style="color: rgba(186, 55, 42, 1)">readinessProbe</code>å¯ä»¥å¨æ¨¡åå°±ç»ªåæå¯¼å¥æµéã</p>
<p>ð¯ <strong>å³é­æ¶çä¼éç»æ­¢</strong>ï¼å¦ææ¨¡åæ­£å¨æ¨çï¼ç´æ¥å³é­å¯è½ä¼å¯¼è´GPUåå­æ³æ¼ææ°æ®éè¯¯ãå¨<code style="color: rgba(186, 55, 42, 1)">lifespan</code>ç<span style="color: rgba(186, 55, 42, 1)"><code>shutdown</code></span>é¶æ®µï¼æå¥½è®¾ç½®ä¸ä¸ªæ å¿ä½ï¼è®©æ­£å¨å¤ççè¯·æ±å®æï¼å¹¶æç»æ°è¯·æ±ã</p>
</div>
<hr style="border: none; height: 1px; background: linear-gradient(90deg, rgba(0, 0, 0, 0), rgba(52, 152, 219, 1), rgba(0, 0, 0, 0)); margin: 40px 0">
<h3>æåå°å¦ä¸å¥</h3>
<p>ææ¯éåæ²¡æé¶å¼¹ï¼æå è½½åé¢ç­ç­ç¥ä¹è¦æ ¹æ®ä½ çå·ä½åºæ¯æè¡¡ãå¦æä½ çæå¡è¦æ±ç¾åç¾ç¡®å®æ§ï¼æ¯å¦éèé£æ§ï¼ï¼å¯è½å°±éè¦å¨å¯å¨æ¶å¿åå è½½èæ¶ï¼ç¡®ä¿æå¡å®å¨å°±ç»ªãä½å¯¹äºå¤§å¤æ°AIæ¨¡åæå¡ãæ¨èç³»ç»ï¼<strong style="color: rgba(186, 55, 42, 1)">"å¿«éå¯å¨ï¼å¼æ­¥é¢ç­"</strong>ç»å¯¹æ¯æåé¨ç½²ä½éªåèµæºæççç¥å¨ã</p>
<p>å¸æè¿ç¯åäº«ï¼è½è®©ä½ ä¸æ¬¡é¨ç½²"å¤§å®¶ä¼"æ¶ï¼ä¸åæå¿èä¹±ãæ¯ç«ï¼è°ä¸æ³è®©èªå·±çæå¡æ¢è·å¾å¿«ï¼åçèµæºå¢ï¼</p>
<p>å¦æè§å¾æç¨ï¼å«å¿äºæ¶èä¸ä¸ï¼è¯´ä¸å®ä¸æ¬¡é¨ç½²åå°±å¾ç¿»åºæ¥ççãä½ å¨é¨ç½²éåæå¡æ¶è¿è¸©è¿åªäºåï¼æ¬¢è¿å¨è¯è®ºåºèèï¼å±ä»¬ä¸èµ·é¿åï¼</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-06 09:28">2026-02-06 09:28</span>&nbsp;
<a href="https://www.cnblogs.com/ymtianyu">ä¸åç¨åºåªå</a>&nbsp;
éè¯»(<span id="post_view_count">16</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19582659);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19582659', targetLink: 'https://www.cnblogs.com/ymtianyu/p/19582659', title: 'FastAPIå®æï¼ç¨æå è½½ä¸Lifespanä¼éç®¡çéåä¾èµ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æ¦å¿µè§£æï¼æºå¨è§è§å¦ä½èµäºæºå¨âä¸ç»´åç¼âââ3Déå»ºææ¯å¨æ¯æå ]]></title>
    <link>https://www.cnblogs.com/ChenAI-TGF/p/19582574</link>
    <guid>2ade63a921546b9de53d54da1b1b38d6</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ChenAI-TGF/p/19582574" title="åå¸äº 2026-02-06 09:04">
    <span role="heading" aria-level="2">æ¦å¿µè§£æï¼æºå¨è§è§å¦ä½èµäºæºå¨âä¸ç»´åç¼âââ3Déå»ºææ¯å¨æ¯æå</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        å¨äººå·¥æºè½çæµªæ½®ä¸­ï¼å¦æè¯´ä¼ ç»ç2Då¾åè¯å«æ¯è®©æºå¨âè®¤åºâç©ä½ï¼é£ä¹**3Déå»ºï¼3D Reconstructionï¼**åæ¯è®©æºå¨çæ­£âçè§£âç©çä¸çãéè¿æºå¨è§è§å®ç°3Déå»ºï¼æ¯èµäºæºå¨äººãæ äººæºåèªå¨é©¾é©¶æ±½è½¦ç©ºé´æç¥è½åçæ ¸å¿ææ¯ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<hr>
<p>@</p><div class="toc"><div class="toc-container-header">ç®å½</div><ul><li><a href="#åè¨" rel="noopener nofollow">åè¨</a></li><li><a href="#1-ä»ä¹æ¯éè¿æºå¨è§è§å®ç°3déå»º" rel="noopener nofollow">1. ä»ä¹æ¯éè¿æºå¨è§è§å®ç°3Déå»ºï¼</a><ul><li><a href="#å®ä¹" rel="noopener nofollow">å®ä¹</a></li><li><a href="#æ ¸å¿æ¬è´¨ä»2då°3dçéåæå½±" rel="noopener nofollow">æ ¸å¿æ¬è´¨ï¼ä»2Då°3Dçéåæå½±</a></li><li><a href="#å³é®æ¦å¿µ" rel="noopener nofollow">å³é®æ¦å¿µ</a></li></ul></li><li><a href="#2-æææ¼ç¤º3déå»ºçè¿ç¨" rel="noopener nofollow">2. æææ¼ç¤ºï¼3Déå»ºçè¿ç¨</a></li><li><a href="#3-ç®åçä¸»æµæ¹æ³" rel="noopener nofollow">3. ç®åçä¸»æµæ¹æ³</a><ul><li><a href="#ä¸è¢«å¨è§è§passive-vision-ä»ä¾èµç¯å¢å" rel="noopener nofollow">ä¸ãè¢«å¨è§è§ï¼Passive Visionï¼ââ ä»ä¾èµç¯å¢å</a><ul><li><a href="#a--åç®éå»ºmonocular-reconstruction" rel="noopener nofollow">A.  åç®éå»ºï¼Monocular Reconstructionï¼ï¼</a><ul><li><a href="#ä»ä¹æ¯-sfmstructure-from-motion" rel="noopener nofollow">ä»ä¹æ¯ SfMï¼Structure from Motionï¼ï¼</a></li><li><a href="#sfm-çå¨æµç¨æç®æ­¥éª¤ç" rel="noopener nofollow">SfM çå¨æµç¨ï¼æç®æ­¥éª¤çï¼</a></li><li><a href="#1-ç¹å¾æåä¸å¹é-feature-extraction--matching" rel="noopener nofollow">1. ç¹å¾æåä¸å¹é (Feature Extraction &amp; Matching)</a></li><li><a href="#2-è®¡ç®å ä½å³ç³»-estimating-epipolar-geometry" rel="noopener nofollow">2. è®¡ç®å ä½å³ç³» (Estimating Epipolar Geometry)</a></li><li><a href="#3-ä¸è§æµé-triangulation" rel="noopener nofollow">3. ä¸è§æµé (Triangulation)</a></li><li><a href="#4-å¢éå¼éå»º-incremental-reconstruction" rel="noopener nofollow">4. å¢éå¼éå»º (Incremental Reconstruction)</a></li><li><a href="#5-å¨å±ä¼ååææ³å¹³å·®-bundle-adjustment-ba" rel="noopener nofollow">5. å¨å±ä¼åï¼åææ³å¹³å·® (Bundle Adjustment, BA)</a></li><li><a href="#ä¸ºä»ä¹åç®-sfm-æ æ³æç¥ç»å¯¹å°ºåº¦" rel="noopener nofollow">ä¸ºä»ä¹åç® SfM æ æ³æç¥âç»å¯¹å°ºåº¦âï¼</a></li><li><a href="#sfm-çä¸¤ç§ä¸»æµæµæ´¾" rel="noopener nofollow">SfM çä¸¤ç§ä¸»æµæµæ´¾</a></li><li><a href="#åèæä»¶" rel="noopener nofollow">åèæä»¶</a></li></ul></li><li><a href="#b-åç®å¤ç®ç«ä½è§è§stereo-vision" rel="noopener nofollow">B. åç®/å¤ç®ç«ä½è§è§ï¼Stereo Visionï¼ï¼</a><ul><li><a href="#1-æ ¸å¿å®ä¹" rel="noopener nofollow">1. æ ¸å¿å®ä¹</a></li><li><a href="#2-æ ¸å¿æ°å­¦åçä¸è§æµétriangulation" rel="noopener nofollow">2. æ ¸å¿æ°å­¦åçï¼ä¸è§æµéï¼Triangulationï¼</a></li><li><a href="#3-æ åç®æ³æµç¨stereo-pipeline" rel="noopener nofollow">3. æ åç®æ³æµç¨ï¼Stereo Pipelineï¼</a></li><li><a href="#4-åç®è§è§-vs-åç®-sfm-çåºå«" rel="noopener nofollow">4. åç®è§è§ vs. åç® SfM çåºå«</a></li><li><a href="#5-éç¨åºæ¯ä¸å±éæ§" rel="noopener nofollow">5. éç¨åºæ¯ä¸å±éæ§</a></li><li><a href="#6-åèèµæä¸ç»å¸æç®" rel="noopener nofollow">6. åèèµæä¸ç»å¸æç®</a></li></ul></li><li><a href="#c-ç¥ç»è¾å°åºnerf-neural-radiance-fields" rel="noopener nofollow">C. ç¥ç»è¾å°åºï¼NeRF, Neural Radiance Fieldsï¼</a><ul><li><a href="#1-ä»ä¹æ¯-nerf" rel="noopener nofollow">1. ä»ä¹æ¯ NeRFï¼</a></li><li><a href="#2-nerf-çæ ¸å¿åç5d-å½æ°" rel="noopener nofollow">2. NeRF çæ ¸å¿åçï¼5D å½æ°</a></li><li><a href="#3-nerf-çå·¥ä½æµç¨" rel="noopener nofollow">3. NeRF çå·¥ä½æµç¨</a></li><li><a href="#4-ä¸ºä»ä¹-nerf-ææè¿ä¹éæ¼" rel="noopener nofollow">4. ä¸ºä»ä¹ NeRF ææè¿ä¹éæ¼ï¼</a></li><li><a href="#5-å±éæ§ä¸ç®åçç¶é¢" rel="noopener nofollow">5. å±éæ§ä¸ç®åçç¶é¢</a></li><li><a href="#6-è¿åä¹è·¯nerf-çå­å­ä»¬" rel="noopener nofollow">6. è¿åä¹è·¯ï¼NeRF çå­å­ä»¬ï¼</a></li><li><a href="#7-åèæç®" rel="noopener nofollow">7. åèæç®</a></li></ul></li><li><a href="#d-3d-gaussian-splatting-3dgs" rel="noopener nofollow">D. 3D Gaussian Splatting (3DGS)ï¼</a><ul><li><a href="#1-ä»ä¹æ¯-3d-gaussian-splatting-3dgs" rel="noopener nofollow">1. ä»ä¹æ¯ 3D Gaussian Splatting (3DGS)ï¼</a></li><li><a href="#2-æ ¸å¿åç3d-é«æ¯æ¤­çä½çåºå " rel="noopener nofollow">2. æ ¸å¿åçï¼3D é«æ¯æ¤­çä½çâåºå â</a></li><li><a href="#3-å·¥ä½æµç¨ä»ç¹äºå°ç²¾ç¾å»ºæ¨¡" rel="noopener nofollow">3. å·¥ä½æµç¨ï¼ä»ç¹äºå°ç²¾ç¾å»ºæ¨¡</a></li><li><a href="#5-ç®åçç¶é¢ä¸ææ" rel="noopener nofollow">5. ç®åçç¶é¢ä¸ææ</a></li><li><a href="#6-åèæç®" rel="noopener nofollow">6. åèæç®</a></li></ul></li></ul></li><li><a href="#äº-ä¸»å¨è§è§active-vision-èªå¸¦åæº" rel="noopener nofollow">äº. ä¸»å¨è§è§ï¼Active Visionï¼ââ èªå¸¦åæº</a><ul><li><a href="#a-ç»æåææ¯" rel="noopener nofollow">A. ç»æåææ¯</a><ul><li><a href="#å®ä¹-1" rel="noopener nofollow"><strong>å®ä¹ï¼</strong></a></li><li><a href="#2-æ ¸å¿æ°å­¦åçåå½¢çä¸è§æµé" rel="noopener nofollow">2. æ ¸å¿æ°å­¦åçï¼åå½¢çä¸è§æµé</a></li><li><a href="#3-ç¼ç æ¹å¼ç»æåçè¯­è¨" rel="noopener nofollow">3. ç¼ç æ¹å¼ï¼ç»æåçâè¯­è¨â</a></li><li><a href="#4-æ·±åº¦è§£æiphone-faceid-æ¯å¦ä½å·¥ä½ç" rel="noopener nofollow">4. æ·±åº¦è§£æï¼iPhone FaceID æ¯å¦ä½å·¥ä½çï¼</a></li><li><a href="#5-ç»æåçä¼ç¼ºç¹" rel="noopener nofollow">5. ç»æåçä¼ç¼ºç¹</a></li></ul></li><li><a href="#6-åèæç®-1" rel="noopener nofollow">6. åèæç®</a></li><li><a href="#é£è¡æ¶é´æ³tof-time-of-flight" rel="noopener nofollow">é£è¡æ¶é´æ³ï¼ToF, Time of Flightï¼</a><ul><li><a href="#1-ä»ä¹æ¯-tof-é£è¡æ¶é´æ³" rel="noopener nofollow">1. ä»ä¹æ¯ ToF (é£è¡æ¶é´æ³)ï¼</a></li><li><a href="#2-æ ¸å¿æ°å­¦åçæéå¬å¼" rel="noopener nofollow">2. æ ¸å¿æ°å­¦åçï¼æéå¬å¼</a></li><li><a href="#3-tof-çå·¥ä½æµç¨" rel="noopener nofollow">3. ToF çå·¥ä½æµç¨</a></li><li><a href="#4-tof-vs-ç»æåæä»ä¹åºå«" rel="noopener nofollow">4. ToF vs. ç»æåï¼æä»ä¹åºå«ï¼</a></li><li><a href="#5-ç®åçç¶é¢ä¸ææ-1" rel="noopener nofollow">5. ç®åçç¶é¢ä¸ææ</a></li><li><a href="#6-åèæç®-2" rel="noopener nofollow">6. åèæç®</a></li></ul></li></ul></li></ul></li><li><a href="#4-éç¨åºæ¯" rel="noopener nofollow">4. éç¨åºæ¯</a></li><li><a href="#5-ç®åçç¶é¢ä¸é®é¢" rel="noopener nofollow">5. ç®åçç¶é¢ä¸é®é¢</a></li><li><a href="#æ»ç»" rel="noopener nofollow">æ»ç»</a></li><li><a href="#åèæç®" rel="noopener nofollow">åèæç®</a></li></ul></div><p></p>
<h1 id="åè¨">åè¨</h1>
<p>å¨äººå·¥æºè½çæµªæ½®ä¸­ï¼å¦æè¯´ä¼ ç»ç2Då¾åè¯å«æ¯è®©æºå¨âè®¤åºâç©ä½ï¼é£ä¹<strong>3Déå»ºï¼3D Reconstructionï¼</strong>åæ¯è®©æºå¨çæ­£âçè§£âç©çä¸çãéè¿æºå¨è§è§å®ç°3Déå»ºï¼æ¯èµäºæºå¨äººãæ äººæºåèªå¨é©¾é©¶æ±½è½¦ç©ºé´æç¥è½åçæ ¸å¿ææ¯ã</p>
<h1 id="1-ä»ä¹æ¯éè¿æºå¨è§è§å®ç°3déå»º">1. ä»ä¹æ¯éè¿æºå¨è§è§å®ç°3Déå»ºï¼</h1>
<h2 id="å®ä¹">å®ä¹</h2>
<p>éè¿æºå¨è§è§å®ç°ç3Déå»ºï¼æ¯æå©ç¨åå­¦ä¼ æå¨ï¼å¦ç¸æºï¼è·åç2Då¾ååºåï¼ç»åè®¡ç®æºè§è§ç®æ³ï¼æ¢å¤ç©ä½çä¸ç»´å ä½å½¢ç¶ãç©ºé´ä½ç½®ä»¥åè¡¨é¢çº¹ççè¿ç¨ã</p>
<h2 id="æ ¸å¿æ¬è´¨ä»2då°3dçéåæå½±">æ ¸å¿æ¬è´¨ï¼ä»2Då°3Dçéåæå½±</h2>
<p>å¨ç©çä¸çä¸­ï¼3Dç©ä½éè¿ç¸æºçééæåå¨2Dæååä»¶ä¸ï¼è¿æ¯ä¸ä¸ª<strong>éç»´</strong>çè¿ç¨ï¼ä¸¢å¤±äºæ·±åº¦ä¿¡æ¯$Z$ï¼ã3Déå»ºçç®æ å°±æ¯éè¿æ°å­¦æ¨¡ååç®æ³ï¼å°è¿äºä¸¢å¤±çæ·±åº¦ä¿¡æ¯æ¾åæ¥ï¼æåç´ ç¹è¿åå°ä¸ç»´åæ ç³»ï¼$X, Y, Z$ï¼ä¸­ã</p>
<h2 id="å³é®æ¦å¿µ">å³é®æ¦å¿µ</h2>
<ul>
<li><strong>ç¹äºï¼Point Cloudï¼ï¼</strong> éå»ºçç¬¬ä¸æ­¥éå¸¸æ¯çæå¤§éå¸¦æç©ºé´åæ çéæ ·ç¹ã</li>
<li><strong>ä¸è§ååï¼Triangulationï¼ï¼</strong> å©ç¨å ä½å³ç³»ç¡®å®ç¹å¨ç©ºé´ä¸­çä½ç½®ã</li>
<li><strong>æ·±åº¦å¾ï¼Depth Mapï¼ï¼</strong> æ¯ä¸ªåç´ ç¹ä»£è¡¨è·ç¦»ç¸æºè·ç¦»çå¾åã</li>
</ul>
<hr>
<h1 id="2-æææ¼ç¤º3déå»ºçè¿ç¨">2. æææ¼ç¤ºï¼3Déå»ºçè¿ç¨</h1>
<p>æä»¬å¯ä»¥éè¿ä»¥ä¸ä¸ä¸ªé¶æ®µæ¥æ³è±¡éå»ºçè§è§ææï¼</p>
<ol>
<li><strong>ç¨çéå»ºé¶æ®µï¼Sparse Reconstructionï¼ï¼</strong><br>
å±å¹ä¸åºç°é¶æ£çç¹å¾ç¹ï¼çèµ·æ¥åæ¯ä¸ç¾¤ååçè¤ç«è«ææäºç©ä½çè½®å»ãæ­¤æ¶å¯ä»¥çæ¸ç¸æºçè¿å¨è½¨è¿¹ã</li>
<li><strong>ç¨ å¯éå»ºé¶æ®µï¼Dense Reconstructionï¼ï¼</strong><br>
ç¹äºåå¾æå¶å¯éï¼ç©ä½çå½¢ç¶å·²ç»æ¸æ°å¯è¾¨ï¼åæ¯ç±æ æ°ç»å°çæ²ç²å ç èæçéå¡ã</li>
<li><strong>è¡¨é¢ç½æ ¼åä¸çº¹çè´´å¾ï¼Meshing &amp; Texturingï¼ï¼</strong><br>
ç®æ³å¨ç¹ä¸ç¹ä¹é´è¿çº¿å½¢æä¸è§é¢çï¼Meshï¼ï¼å¹¶æç§çä¸çé¢è²âè´´âä¸å»ãæ­¤æ¶ï¼ç©ä½å¨å±å¹ä¸çèµ·æ¥ä¸çå®ç§çæ å¼ï¼ä½ä½ å¯ä»¥æè½¬ãç¼©æ¾å®ã</li>
</ol>
<p><img alt="å¨è¿éæå¥å¾çæè¿°" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3724025/202602/3724025-20260206090341017-340817460.png" class="lazyload"><br>
<strong>æ¦å¿µè§£è¯»ï¼</strong><br>
<strong>1. Meshï¼ç½æ ¼ / ä¸è§ç½æ ¼ï¼</strong><br>
Mesh æ¯ä¸ç»´æ¨¡åç âå ä½éª¨æ¶âï¼å®ç±å¤§éä¸è§å½¢ï¼æå¤è¾¹å½¢ï¼é¢çæ¼æ¥èæï¼åªå®ä¹äºç©ä½çä¸ç»´å½¢ç¶ãè½®å»åç»æï¼å°±åå»ºç­çé¢ç­æ¡æ¶ï¼æ¬èº«æ²¡æé¢è²åçº¹çã<br>
<strong>2. è´´å¾ï¼Texture Mappingï¼</strong><br>
è´´å¾æ¯ä¸å¼ åå«é¢è²ãçº¹çãç»èä¿¡æ¯çäºç»´å¾åï¼æ¯å¦å¢é¢çç ç³çº¹çãçªæ·çç»çè´¨æãå®çä½ç¨æ¯æè¿äºè¡¨é¢ç»è âè´´â å° Mesh çå ä½æ¡æ¶ä¸ã</p>
<hr>
<h1 id="3-ç®åçä¸»æµæ¹æ³">3. ç®åçä¸»æµæ¹æ³</h1>
<p>3Déå»ºçæ¹æ³ä¸»è¦åä¸º<strong>ä¸»å¨è§è§</strong>å<strong>è¢«å¨è§è§</strong>ä¸¤å¤§ç±»ï¼</p>
<h2 id="ä¸è¢«å¨è§è§passive-vision-ä»ä¾èµç¯å¢å">ä¸ãè¢«å¨è§è§ï¼Passive Visionï¼ââ ä»ä¾èµç¯å¢å</h2>
<p>è¿ç±»æ¹æ³ä¸åç©ä½åå°è½éï¼ä»éè¿ææç¯å¢åæåã</p>
<h3 id="a--åç®éå»ºmonocular-reconstruction">A.  åç®éå»ºï¼Monocular Reconstructionï¼ï¼</h3>
<p><strong>åç</strong>ï¼å©ç¨<strong>è¿å¨æ¢å¤ç»æï¼SfM, Structure from Motionï¼</strong>ãéè¿åå°ç¸æºå¨ä¸åä½ç½®ææçå¤å¼ ç§çï¼è®¡ç®ç¸æºä½å§¿ååå¹¶éå»ºåºæ¯ã</p>
<p><strong>é¾ç¹</strong>ï¼ å­å¨<strong>å°ºåº¦ä¸ç¡®å®æ§</strong>ï¼ä¸ç¥éç©ä½å°åºæå¤å¤§ï¼ã</p>
<p>ç®åæ¥è¯´ï¼SfM å°±æ¯éè¿<strong>ç§»å¨çç¸æº</strong>ææçä¸ç³»å<strong>2Då¾å</strong>ï¼æ¥æ¨ç®åºç©ä½ç<strong>3Då½¢ç¶</strong>åç¸æºç<strong>ç©ºé´è½¨è¿¹</strong>ã</p>
<p>ä¸é¢æå°éå¸¸è¯¦ç»å°ä¸ºä½ æè§£ SfM çåçãæ­¥éª¤ä»¥åå®èåçæ°å­¦é»è¾ã</p>
<hr>
<h4 id="ä»ä¹æ¯-sfmstructure-from-motion">ä»ä¹æ¯ SfMï¼Structure from Motionï¼ï¼</h4>
<ul>
<li><strong>Structureï¼ç»æï¼ï¼</strong> æçæ¯è¢«ææç©ä½çä¸ç»´åæ ï¼ç¹äºï¼ã</li>
<li><strong>Motionï¼è¿å¨ï¼ï¼</strong> æçæ¯ç¸æºå¨æææ¯ä¸å¼ ç§çæ¶çä½ç½®ï¼ä½å§¿ï¼Poseï¼ã</li>
<li><strong>Fromï¼éè¿...æ¢å¤ï¼ï¼</strong> å¼ºè°äºå æå³ç³»ã</li>
</ul>
<p><strong>æ ¸å¿ææ³ï¼</strong><br>
æ³è±¡ä½ å´çä¸ä¸ªéåè½¬åæç§ãè½ç¶æ¯å¼ ç§çé½æ¯å¹³é¢çï¼2Dï¼ï¼ä½å½ä½ ä»å·¦è¾¹ç§»å¨å°å³è¾¹æ¶ï¼éåä¸çç¹å¾ç¹ï¼æ¯å¦é¼»å­å°ï¼å¨ç§çéçä½ç½®ä¼åçç§»å¨ãSfM ç®æ³å°±åä½ çå¤§èä¸æ ·ï¼éè¿åæè¿äºç¹ç§»å¨çå¹åº¦ãæ¹ååè§å¾ï¼åè¿æ¥æ¨ç®åºï¼âå¦ï¼åæ¥é¼»å­å°è·ç¦»æè¿ä¹è¿ï¼èæåæåå³ç§»å¨äº 50 åç±³ãâ</p>
<hr>
<h4 id="sfm-çå¨æµç¨æç®æ­¥éª¤ç">SfM çå¨æµç¨ï¼æç®æ­¥éª¤çï¼</h4>
<p>ä¸ä¸ªæ åç SfM ç³»ç»éå¸¸åå«ä»¥ä¸äºä¸ªæ ¸å¿æ­¥éª¤ï¼</p>
<p><img alt="å¨è¿éæå¥å¾çæè¿°" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3724025/202602/3724025-20260206090340598-853557538.png" class="lazyload"></p>
<h4 id="1-ç¹å¾æåä¸å¹é-feature-extraction--matching">1. ç¹å¾æåä¸å¹é (Feature Extraction &amp; Matching)</h4>
<ul>
<li><strong>åä»ä¹ï¼</strong> ç®æ³ä¼å¨æ¯ä¸å¼ ç§çä¸­å¯»æ¾âå°æ âââé£äºæ è®ºåç§æä¹åãè§åº¦æä¹åé½è½è®¤åºæ¥çç¹ï¼éå¸¸ä½¿ç¨ <strong>SIFT</strong> æ <strong>ORB</strong> ç®æ³ï¼ã</li>
<li><strong>ç®çï¼</strong> ç¡®å®ç¬¬ä¸å¼ ç§çéçé£ä¸ªâç¹âåç¬¬äºå¼ ç§çéçåªä¸ªâç¹âæ¯ç©çä¸çä¸­çåä¸ä¸ªä½ç½®ã</li>
<li><strong>ç»æï¼</strong> å¾å°ä¸å éå¯¹å¥½çåç´ ç¹åæ ã</li>
</ul>
<h4 id="2-è®¡ç®å ä½å³ç³»-estimating-epipolar-geometry">2. è®¡ç®å ä½å³ç³» (Estimating Epipolar Geometry)</h4>
<ul>
<li><strong>åä»ä¹ï¼</strong> å©ç¨<strong>å¯¹æå ä½ï¼Epipolar Geometryï¼</strong>çè®ºãéè¿å¹éçç¹å¯¹ï¼è®¡ç®åºä¸¤å¼ ç§çä¹é´çæ°å­¦åæ¢å³ç³»ï¼å³<strong>åºç¡ç©éµï¼Fundamental Matrixï¼</strong>æ<strong>æ¬è´¨ç©éµï¼Essential Matrixï¼</strong>ã</li>
<li><strong>åçï¼</strong> å³ä½¿ä¸ç¥éç©ä½çå½¢ç¶ï¼åªè¦æè¶³å¤çå¹éç¹ï¼æä»¬å°±è½ç®åºç¸æºä»ä½ç½® A å°ä½ç½® B å°åºæè½¬äºå¤å°åº¦ï¼å¹³ç§»äºå¤å°è·ç¦»ã</li>
</ul>
<h4 id="3-ä¸è§æµé-triangulation">3. ä¸è§æµé (Triangulation)</h4>
<ul>
<li><strong>åä»ä¹ï¼</strong> æäºç¸æºçä½å§¿ï¼ç®æ³ä¼ä»ä¸¤ä¸ªç¸æºä¸­å¿ååä¸ä¸ªç¹å¾ç¹åå°ä¸¤æ¡å°çº¿ã</li>
<li><strong>åçï¼</strong> è¿ä¸¤æ¡å°çº¿çäº¤ç¹ï¼å°±æ¯è¯¥ç¹å¾ç¹å¨ä¸ç»´ç©ºé´ä¸­ççå®åæ ï¼$X, Y, Z$ï¼ã</li>
<li><strong>ç»æï¼</strong> çæäºæåçç¨çç¹äºã</li>
</ul>
<h4 id="4-å¢éå¼éå»º-incremental-reconstruction">4. å¢éå¼éå»º (Incremental Reconstruction)</h4>
<ul>
<li><strong>åä»ä¹ï¼</strong> ç®æ³ä¸ä¼ä¸æ¬¡æ§å¤çå ç¾å¼ ç§çï¼èæ¯åä»ä¸¤å¼ å¼å§ï¼éå»ºåºä¸å°é¨åï¼ç¶ååæ¼å¾ä¸æ ·ï¼ä¸æ­å å¥ç¬¬ä¸å¼ ãç¬¬åå¼ ç§çã</li>
<li><strong>è¿ç¨ï¼</strong> æ¯å å¥ä¸å¼ æ°ç§çï¼å°±å©ç¨å·²æç 3D ç¹äºæ¥åæ¨è¿å¼ æ°ç§ççç¸æºä½ç½®ï¼è¿å« <strong>PnP</strong> ç®æ³ï¼ï¼ç¶ååææ°çå°çç¹å å¥ç¹äºã</li>
</ul>
<h4 id="5-å¨å±ä¼ååææ³å¹³å·®-bundle-adjustment-ba">5. å¨å±ä¼åï¼åææ³å¹³å·® (Bundle Adjustment, BA)</h4>
<ul>
<li><strong>è¿æ¯ SfM ççµé­ï¼</strong> éçç§çè¶æ¥è¶å¤ï¼è¯¯å·®ä¼ç´¯ç§¯ï¼ç¹äºä¼âé£âææåå½¢ã</li>
<li><strong>åä»ä¹ï¼</strong> BA æ¯ä¸é¡¹å¤§åä¼åå·¥ç¨ãå®ä¼åæ¶è°æ´<strong>ææç¸æºçä½å§¿</strong>å<strong>ææ 3D ç¹çåæ </strong>ï¼ä½¿å¾æ¯ä¸ä¸ª 3D ç¹æå½±åç§çä¸æ¶ï¼ä¸ç§çéåå§åç´ ç¹çè·ç¦»ï¼<strong>éæå½±è¯¯å·®</strong>ï¼æå°ã<br>
<img alt="å¨è¿éæå¥å¾çæè¿°" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3724025/202602/3724025-20260206090340297-692191271.png" class="lazyload"></li>
</ul>
<hr>
<h4 id="ä¸ºä»ä¹åç®-sfm-æ æ³æç¥ç»å¯¹å°ºåº¦">ä¸ºä»ä¹åç® SfM æ æ³æç¥âç»å¯¹å°ºåº¦âï¼</h4>
<p>è¿æ¯åç®éå»ºæè´å½çå¼±ç¹ï¼ä¹æ¯é¢è¯æå­¦æ¯è®¨è®ºä¸­å¿é®çé®é¢ã</p>
<p><strong>åçï¼</strong><br>
å¨æ°å­¦ä¸ï¼SfM æ¢å¤åºçç©ºé´ç»æå·æ<strong>å°ºåº¦ç­æ¯æ§</strong>ã</p>
<ul>
<li>å¦æä½ ææä¸å¼ æ¡å­ä¸çæ°´æ¯ï¼éå»ºåºæ¥çæ¨¡åå¯è½çèµ·æ¥å¾å®ç¾ã</li>
<li>ä½æ¯ï¼ç®æ³æ æ³åè¾¨è¿æ¯ä¸ä¸ª<strong>çå®çé« 10 åç±³çæ°´æ¯</strong>ï¼è¿æ¯ä¸ä¸ª<strong>é« 10 ç±³çå·¨åæ°´æ¯æ¨¡å</strong>ã</li>
</ul>
<p><strong>åå ï¼</strong><br>
å¨åç®ç¸æºçæ¥ï¼ä¸ä¸ªå¾å°çç©ä½ç¦»ç¸æºå¾è¿ï¼åä¸ä¸ªå·¨å¤§çç©ä½ç¦»ç¸æºå¾è¿ï¼å¨ç§çä¸çåç´ è¡¨ç°æ¯ä¸æ¨¡ä¸æ ·çãé¤éä½ é¢å¤åè¯ç®æ³ä¸ä¸ªåèå¼ï¼æ¯å¦ï¼ç§çéé£ä¸ªç¡¬å¸ç´å¾æ¯ 25mmï¼æèä¸¤ä¸ªç¸æºå¶å®è·ç¦» 10cmï¼ï¼å¦åå®åªè½åè¯ä½ ï¼âA ç¹å° B ç¹çè·ç¦»æ¯ C ç¹å° D ç¹è·ç¦»ç 2 åâï¼èä¸è½åè¯ä½ å°åºæ¯å¤å°ç±³ã</p>
<hr>
<h4 id="sfm-çä¸¤ç§ä¸»æµæµæ´¾">SfM çä¸¤ç§ä¸»æµæµæ´¾</h4>
<ol>
<li>
<p><strong>å¢éå¼ SfM (Incremental SfM)ï¼</strong></p>
<ul>
<li>ä»£è¡¨ä½ï¼<strong>COLMAP</strong>ï¼ç®åå­¦æ¯çåå·¥ä¸çæå¸¸ç¨çå¼æºå·¥å·ï¼ã</li>
<li>ä¼ç¹ï¼éå¸¸é²æ£ï¼ç²¾åº¦é«ã</li>
<li>ç¼ºç¹ï¼æ¢ï¼ç§çå¤äºä¹åä¼åéå¸¸èæ¶ã<br>
<img alt="å¨è¿éæå¥å¾çæè¿°" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3724025/202602/3724025-20260206090340547-336761908.png" class="lazyload"></li>
</ul>
</li>
<li>
<p><strong>å¨å±å¼ SfM (Global SfM)ï¼</strong></p>
<ul>
<li>ä»£è¡¨ä½ï¼<strong>TheiaSfM</strong>ã</li>
<li>ä¼ç¹ï¼éåº¦æå¿«ï¼éåå¤§è§æ¨¡åºæ¯ã</li>
<li>ç¼ºç¹ï¼å¯¹å¼å¸¸å¹éç¹éå¸¸ææï¼å®¹æå´©æºã<br>
<img alt="å¨è¿éæå¥å¾çæè¿°" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3724025/202602/3724025-20260206090340564-408678317.png" class="lazyload"></li>
</ul>
</li>
</ol>
<hr>
<h4 id="åèæä»¶">åèæä»¶</h4>
<p>è¥è¦æ·±å¥ç ç©¶ SfM çåºå±æ°å­¦ï¼ä»¥ä¸æç®æ¯å¿è¯»çï¼</p>
<ol>
<li><strong>Agarwal, S., et al. (2011).</strong> <em>Building Rome in a Day</em>. Communications of the ACM.<br>
(è¿æ¯ SfM åå²ä¸çéç¨ç¢ï¼è¯æäºå©ç¨äºèç½ä¸çæåä¸ä¸å¼ ç§çéå»ºä¸åº§åå¸æ¯å¯è½ç)ã</li>
<li><strong>SchÃ¶nberger, J. L., &amp; Frahm, J. M. (2016).</strong> <em>Structure-from-Motion Revisited</em>. CVPR.<br>
(è¿æ¯ <strong>COLMAP</strong> çæ ¸å¿è®ºæï¼ç®åè¢«å¬è®¤ä¸ºå¢éå¼ SfM çæä¼å®è·µ)ã</li>
<li><strong>Triggs, B., et al. (1999).</strong> <em>Bundle Adjustment â A Modern Synthesis</em>. Vision Algorithms: Theory and Practice.<br>
(æ·±å¥è®²è§£äº SfM ä¸­æå³é®çä¼åç®æ³ BA)ã</li>
<li><strong>Snavely, N., Seitz, S. M., &amp; Szeliski, R. (2006).</strong> <em>Photo Tourism: Exploring image collections in 3D</em>. SIGGRAPH.<br>
(é¦æ¬¡åå¤§ä¼å±ç¤ºäºå¦ä½éè¿éç»æåç§çéè¿è¡ 3D å¯¼èª)ã</li>
<li><strong>Longuet-Higgins, H. C. (1981).</strong> <em>A computer algorithm for reconstructing a scene from two projections</em>. Nature.<br>
(æåºäºèåçå«ç¹ç®æ³ï¼æ¯ SfM å ä½è®¡ç®çåºç³)ã</li>
</ol>
<h3 id="b-åç®å¤ç®ç«ä½è§è§stereo-vision">B. åç®/å¤ç®ç«ä½è§è§ï¼Stereo Visionï¼ï¼</h3>
<p><strong>åç</strong>: æ¨¡æäººç±»åç¼ãéè¿è®¡ç®å·¦å³ä¸¤ä¸ªç¸æºææå¾åç<strong>è§å·®ï¼Disparityï¼</strong>ï¼å©ç¨ä¸è§æµéåçè®¡ç®æ·±åº¦ã</p>
<p>å¦æè¯´ SfMï¼è¿å¨æ¢å¤ç»æï¼æ¯æ¨¡ä»¿äººç±»âè¾¹èµ°è¾¹çâæ¥è®¤ç¥ç©ºé´ï¼é£ä¹<strong>åç®ç«ä½è§è§ï¼Stereo Visionï¼</strong>åæ¯ç´æ¥æ¨¡ä»¿äººç±»ç<strong>åç¼ç»æ</strong>ã</p>
<p>å®æ¯æºå¨è§è§ä¸­æç»å¸ãåºç¨æå¹¿æ³çæ·±åº¦æç¥ææ¯ä¹ä¸ãä¸é¢æä»¬æ·±åº¦æè§£åç®ç«ä½è§è§çåçãæ°å­¦é»è¾ä»¥åå®ç°è¿ç¨ã</p>
<h4 id="1-æ ¸å¿å®ä¹">1. æ ¸å¿å®ä¹</h4>
<p>åç®ç«ä½è§è§æ¯æä½¿ç¨ä¸¤å°æåç¹æ§ç¸åï¼ç¦è·ãåç´ å°ºå¯¸ç­ä¸è´ï¼çç¸æºï¼å®è£å¨åä¸å¹³é¢ä¸ï¼ä¿æä¸å®çæ°´å¹³è·ç¦»ï¼<strong>åºçº¿ï¼Baseline</strong>ï¼ï¼éè¿è®¡ç®å·¦å³å¾åä¸­åä¸ç©ä½åç´ ç¹çç¸å¯¹ä½å§¿å·®å¼ï¼æ¥è·åç©ä½ä¸ç»´ä¿¡æ¯çæ¹æ³ã</p>
<p><strong>ç´è§çè§£ï¼</strong><br>
ä¼¸åºä½ çä¸æ ¹æææ¾å¨ç¼åï¼åé­ä¸å·¦ç¼çï¼åé­ä¸å³ç¼çãä½ ä¼åç°ææç¸å¯¹äºèæ¯çä½ç½®åçäºâè·³å¨âã</p>
<ul>
<li>ææç¦»ç¼çè¶è¿ï¼è·³å¨å¹åº¦ï¼ä½å§¿å·®å¼ï¼è¶å¤§ã</li>
<li>ææç¦»ç¼çè¶è¿ï¼è·³å¨å¹åº¦è¶å°ã</li>
<li>è¿ç§è·³å¨çä½ç§»éï¼å¨è®¡ç®æºè§è§ä¸­è¢«ç§°ä¸º<strong>è§å·®ï¼Disparityï¼</strong>ã</li>
</ul>
<hr>
<h4 id="2-æ ¸å¿æ°å­¦åçä¸è§æµétriangulation">2. æ ¸å¿æ°å­¦åçï¼ä¸è§æµéï¼Triangulationï¼</h4>
<p>åç®è§è§çç²¾é«å¯ä»¥ç¨ä¸ä¸ªæå¶ç®åçå ä½å¬å¼æ¥æ¦æ¬ã</p>
<p>åè®¾ä¸¤å°ç¸æºå®å¨å¹³è¡ï¼ç¦è·ä¸º $f$ï¼ä¸¤ç¸æºä¸­å¿è·ç¦»ï¼åºçº¿ï¼ä¸º $B$ãç©ºé´ä¸­ä¸ç¹ $P$ å¨å·¦ç¸æºæåé¢ä¸çæ¨ªåæ æ¯ $x_L$ï¼å¨å³ç¸æºæåé¢ä¸çæ¨ªåæ æ¯ $x_R$ã</p>
<ol>
<li><strong>è§å·®ï¼Disparityï¼å®ä¹ï¼</strong> $d = x_L - x_R$</li>
<li><strong>æ·±åº¦ï¼Depthï¼è®¡ç®å¬å¼ï¼</strong><br>
$$Z = \frac{f \cdot B}{d}$$</li>
</ol>
<p><strong>è¿ä¸ªå¬å¼åè¯æä»¬ä¸¤ä¸ªå³é®ä¿¡æ¯ï¼</strong></p>
<ul>
<li><strong>åæ¯å³ç³»ï¼</strong> æ·±åº¦ $Z$ ä¸è§å·® $d$ æåæ¯ãè§å·®è¶å¤§ï¼ç©ä½è¶è¿ã</li>
<li><strong>å°ºåº¦ç¡®å®æ§ï¼</strong> ä¸åç® SfM ä¸åï¼ç±äºåºçº¿ $B$ æ¯æåæµéå¥½çç©çå¸¸æ°ï¼æ¯å¦ä¸¤ç¸æºé´è· 6 åç±³ï¼ï¼æä»¥åç®è§è§å¯ä»¥ç´æ¥è®¡ç®åºç©ä½ç<strong>çå®ç©çè·ç¦»</strong>ï¼ç±³ææ¯«ç±³ï¼ï¼ä¸å­å¨å°ºåº¦ä¸ç¡®å®æ§ã</li>
</ul>
<hr>
<h4 id="3-æ åç®æ³æµç¨stereo-pipeline">3. æ åç®æ³æµç¨ï¼Stereo Pipelineï¼</h4>
<p>å®ç°é«è´¨éçåç®éå»ºéå¸¸éè¦ç»è¿ä»¥ä¸åä¸ªä¸¥è°¨çæ­¥éª¤ï¼</p>
<p><strong>ç¬¬ä¸æ­¥ï¼ç¸æºæ å®ï¼Camera Calibrationï¼</strong></p>
<ul>
<li><strong>ç®çï¼</strong> ç¡®å®ç¸æºçååï¼ç¦è·ãä¸­å¿ç¹ï¼åå¤åï¼ä¸¤ç¸æºä¹é´çç²¾ç¡®æè½¬åå¹³ç§»å³ç³»ï¼ã</li>
<li><strong>æä¹ï¼</strong> å¦æç¸æºéå¤´æç¸åï¼æ¯å¦é±¼ç¼ææï¼ï¼æèä¸¤ä¸ªç¸æºæ²¡è£æ­£ï¼åç»­è®¡ç®å¨æ¯éçã</li>
</ul>
<p><strong>ç¬¬äºæ­¥ï¼ç«ä½æ ¡æ­£ï¼Stereo Rectificationï¼ââ æå³é®</strong></p>
<ul>
<li><strong>åä»ä¹ï¼</strong> éè¿æ°å­¦åæ¢ï¼ææææ¶çä¸¤å¼ ç§çå¯¹é½ï¼ä½¿å¾å·¦å³å¾åç<strong>æçº¿ï¼Epipolar Lineï¼å¤äºåä¸æ°´å¹³çº¿ä¸</strong>ã</li>
<li><strong>æä¹ï¼</strong> æ ¡æ­£åï¼å·¦å¾ä¸­çä¸ä¸ªç¹ï¼å¨å³å¾ä¸­ä¸å®è½å¨<strong>åä¸è¡</strong>æ¾å°ãè¿æä¸ä¸ª 2D çæç´¢é®é¢éç»´æäº 1D æç´¢ï¼æå¤§å°æé«äºè¿ç®éåº¦ã</li>
</ul>
<p><strong>ç¬¬ä¸æ­¥ï¼ç«ä½å¹éï¼Stereo Matchingï¼ââ ææ ¸å¿ãæé¾</strong></p>
<ul>
<li><strong>åä»ä¹ï¼</strong> ç®æ³è¦å¨å³å¾çåä¸è¡åç´ éï¼æ¾å°é£ä¸ªåå·¦å¾ç¹âé¿å¾æåâçç¹ã</li>
<li><strong>ä¸»æµç®æ³ï¼</strong>
<ul>
<li><strong>BM (Block Matching)ï¼</strong> å¿«ï¼ä½ç²¾åº¦ä½ï¼è¾¹ç¼ç²ç³ã</li>
<li><strong>SGM (Semi-Global Matching)ï¼</strong> å·¥ä¸ççä¸»æµï¼å¨éåº¦åç²¾åº¦é´åå¾äºæä½³å¹³è¡¡ã</li>
<li><strong>æ·±åº¦å­¦ä¹ æ¹æ³ï¼</strong> å¦ PSMNetï¼å©ç¨ç¥ç»ç½ç»ç´æ¥è¾åºè§å·®å¾ï¼å¨å¤çæ çº¹çåºåè¡¨ç°æ´å¥½ã</li>
</ul>
</li>
</ul>
<p><strong>ç¬¬åæ­¥ï¼è§å·®è½¬æ·±åº¦ï¼Disparity to Depthï¼</strong></p>
<ul>
<li><strong>åä»ä¹ï¼</strong> å©ç¨åé¢æå°çå¬å¼ $Z = (f \cdot B) / d$ï¼å°åç´ çº§çè§å·®å¾è½¬åä¸ºç©çä¸ççæ·±åº¦å¾ã</li>
</ul>
<hr>
<h4 id="4-åç®è§è§-vs-åç®-sfm-çåºå«">4. åç®è§è§ vs. åç® SfM çåºå«</h4>
<table>
<thead>
<tr>
<th style="text-align: left">ç¹æ§</th>
<th style="text-align: left">åç®ç«ä½è§è§ (Stereo)</th>
<th style="text-align: left">åç® SfM</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><strong>ç¸æºæ°é</strong></td>
<td style="text-align: left">2å°æå¤å°</td>
<td style="text-align: left">1å°</td>
</tr>
<tr>
<td style="text-align: left"><strong>ææç¶æ</strong></td>
<td style="text-align: left">å¯ä»¥éæææï¼ç¬é´æåï¼</td>
<td style="text-align: left">å¿é¡»ç§»å¨ç¸æºï¼å¨æææï¼</td>
</tr>
<tr>
<td style="text-align: left"><strong>å°ºåº¦æç¥</strong></td>
<td style="text-align: left">èªå¨è·å¾çå®ç©çå°ºåº¦</td>
<td style="text-align: left">æ æ³è·å¾çå®å°ºåº¦ï¼ä»ææ¯ä¾ï¼</td>
</tr>
<tr>
<td style="text-align: left"><strong>å®æ¶æ§</strong></td>
<td style="text-align: left">é«ï¼éåé¿éãæºå¨äººï¼</td>
<td style="text-align: left">ä½ï¼è®¡ç®éå¤§ï¼éè¿å¨åºåï¼</td>
</tr>
<tr>
<td style="text-align: left"><strong>éç¨èå´</strong></td>
<td style="text-align: left">éåè¿è·ç¦»ãé«ç²¾åº¦æç¥</td>
<td style="text-align: left">éåå¤§åºæ¯ãè¿è·ç¦»å»ºæ¨¡</td>
</tr>
</tbody>
</table>
<hr>
<h4 id="5-éç¨åºæ¯ä¸å±éæ§">5. éç¨åºæ¯ä¸å±éæ§</h4>
<p><strong>éç¨åºæ¯ï¼</strong></p>
<ul>
<li><strong>è½¦è½½è¾å©é©¾é©¶ï¼ADASï¼ï¼</strong> è¯å«åæ¹éç¢ç©è·ç¦»ã</li>
<li><strong>å·¥ä¸æåï¼</strong> æºæ¢°èè¯å«é¶ä»¶ç 3D ä½ç½®ã</li>
<li><strong>æ äººæºé¿éï¼</strong> å®æ¶æç¥å¨å´å¢ä½è·ç¦»ã</li>
</ul>
<p><strong>å±éæ§ï¼</strong></p>
<ol>
<li><strong>ç¯å¢çº¹çä¾èµï¼</strong> å¦æå¢é¢æ¯çº¯ç½è²çï¼ç®æ³æ æ³å¨å³å¾ä¸­æ¾å°å¹éçç¹ï¼å ä¸ºçèµ·æ¥é½ä¸æ ·ï¼ï¼ä¼å¯¼è´æ·±åº¦ä¸¢å¤±ã</li>
<li><strong>åºçº¿éå¶ï¼</strong> æµéè·ç¦»åéäºåºçº¿ $B$ãå¦æè¦æµ 100 ç±³å¤çç©ä½ï¼åºçº¿å¿é¡»è¶³å¤å®½ï¼å¦åè§å·® $d$ å¤ªå°ï¼ä¼å¯¼è´è¯¯å·®å§å¢ã</li>
<li><strong>é®æ¡é®é¢ï¼</strong> å·¦ç¼çå¾å°çå°æ¹ï¼å³ç¼å¯è½è¢«æ¡ä½äºï¼æå½±åºï¼ï¼å¯¼è´æ æ³è®¡ç®ã</li>
</ol>
<hr>
<h4 id="6-åèèµæä¸ç»å¸æç®">6. åèèµæä¸ç»å¸æç®</h4>
<ol>
<li><strong>Scharstein, D., &amp; Szeliski, R. (2002).</strong> <em>A taxonomy and evaluation of dense two-frame stereo correspondence algorithms</em>. International Journal of Computer Vision.<br>
(ç«ä½å¹éé¢åçåºç³è®ºæï¼å®ä¹äºè¯ä¼°æ å)ã</li>
<li><strong>Hirschmuller, H. (2005).</strong> <em>Accurate and efficient stereo processing by semi-global matching and mutual information</em>. CVPR.<br>
(æåºäºèåç <strong>SGM ç®æ³</strong>ï¼è³ä»ä»æ¯è¯¥é¢åçå·¥ä¸æ å)ã</li>
<li><strong>Marr, D., &amp; Poggio, T. (1979).</strong> <em>A computational theory of human stereo vision</em>. Proceedings of the Royal Society of London.<br>
(ä»çç©å­¦åè®¡ç®è§è§è§åº¦è§£éäºäººç±»åç¼å¦ä½æç¥æ·±åº¦)ã</li>
<li><strong>Konolige, K. (1998).</strong> <em>Small Vision Systems: Hardware and Implementation</em>. International Symposium on Robotics Research.<br>
(è®²è§£äºå®æ¶åç®è§è§ç³»ç»çæ©æç¡¬ä»¶å®ç°)ã</li>
<li><strong>Zhang, Z. (2000).</strong> <em>A flexible new technique for camera calibration</em>. IEEE Transactions on Pattern Analysis and Machine Intelligence.<br>
(èåçâå¼ æ°æ å®æ³âï¼åç®ç¸æºæ å®çå¿å¤åºç¡)ã</li>
</ol>
<h3 id="c-ç¥ç»è¾å°åºnerf-neural-radiance-fields">C. ç¥ç»è¾å°åºï¼NeRF, Neural Radiance Fieldsï¼</h3>
<pre><code>*   **åæ²¿ï¼** 2020å¹´åççåæ§ææ¯ãå©ç¨æ·±åº¦å­¦ä¹ å°åºæ¯è¡¨ç¤ºä¸ºä¸ä¸ªè¿ç»­çä½ç§¯åºï¼éè¿ä½æ¸²æææ¯çææå¶é¼çç3Dè§å¾ã
</code></pre>
<p>å¦æè¯´ <strong>SfM</strong> æ¯å¨åâå ä½é¢âï¼<strong>åç®è§è§</strong>æ¯å¨åâç©çé¢âï¼é£ä¹ <strong>NeRFï¼Neural Radiance Fieldsï¼ç¥ç»è¾å°åºï¼</strong> å°±æ¯å¨ç¨âäººå·¥æºè½ç®æ³âè¿è¡ä¸æ¬¡é©å½æ§ç<strong>èºæ¯åä½</strong>ã</p>
<p>NeRF æ¯ 2020 å¹´è®¡ç®æºè§è§é¢åæå·é¢ è¦æ§çææ¯ä¹ä¸ãå®å½»åºæ¹åäºæä»¬å­å¨åè¡¨ç° 3D ä¸ççæ¹å¼ã</p>
<hr>
<h4 id="1-ä»ä¹æ¯-nerf">1. ä»ä¹æ¯ NeRFï¼</h4>
<p><strong>å®ä¹ï¼</strong><br>
NeRF æ¯ä¸ç§å©ç¨<strong>æ·±åº¦ç¥ç»ç½ç»ï¼éå¸¸æ¯å¤å±æç¥æº MLPï¼</strong>æ¥éå¼å°è¡¨ç¤º 3D åºæ¯çææ¯ãå®ä¸å­å¨ç¹äºï¼ä¹ä¸å­å¨ä¸è§é¢çï¼èæ¯å°æ´ä¸ª 3D åºæ¯ç¼ç è¿ä¸ä¸ªç¥ç»ç½ç»ç<strong>æé</strong>éã</p>
<p><strong>æ ¸å¿ç´è§ï¼</strong><br>
æ³è±¡ç©ºé´ä¸­åæ»¡äºâå¸¦é¢è²ççé¾âãå¨æ¯ä¸ä¸ªåæ ç¹ä¸ï¼çé¾é½æç¹å®çé¢è²åæµåº¦ãNeRF çç®æ æ¯è®­ç»ä¸ä¸ª AI å©æï¼å½ä½ é®å®ï¼âå¨åæ  $(x, y, z)$ è¿ä¸ªç¹ï¼ä» $(\theta, \phi)$ è¿ä¸ªè§åº¦çè¿å»æ¯ä»ä¹é¢è²ï¼âå®è½ç«å»è®¡ç®åºç»æã</p>
<hr>
<h4 id="2-nerf-çæ ¸å¿åç5d-å½æ°">2. NeRF çæ ¸å¿åçï¼5D å½æ°</h4>
<p>NeRF å°åºæ¯è¡¨ç¤ºä¸ºä¸ä¸ªè¿ç»­ç <strong>5D å½æ°</strong>ï¼</p>
<ul>
<li><strong>è¾å¥ (5ä¸ªåæ°)ï¼</strong> ç©ºé´ä½ç½® $(x, y, z)$ + è§å¯è§è§ $(\theta, \phi)$ã</li>
<li><strong>è¾åº (4ä¸ªåæ°)ï¼</strong> è¯¥ç¹çé¢è² $RGB$ + è¯¥ç¹çä½ç§¯å¯åº¦ $\sigma$ï¼å³åçº¿éè¿è¿éçé»åï¼ä»£è¡¨ç©ä½æ¯å¦å­å¨ï¼ã<br>
<img alt="å¨è¿éæå¥å¾çæè¿°" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3724025/202602/3724025-20260206090340946-1406476187.png" class="lazyload"></li>
</ul>
<ol>
<li><strong>éå¼è¡¨ç¤ºï¼Implicit Representationï¼ï¼</strong><br>
ä¼ ç»ç 3D æ¨¡ååâä¹é«ç§¯æ¨âï¼ä½ç´ ï¼æâæçº¸âï¼ç½æ ¼ï¼ãNeRF åâä¸æ®µä»£ç âï¼ä½ ç»å®åæ ï¼å®ååºé¢è²ãè¿ä½¿å¾å®è½è¡¨ç°æå¶ç²¾ç»çç»èï¼èä¸éè¦æµ·éçå­å¨ç©ºé´ã</li>
<li><strong>ä½ç½®ç¼ç ï¼Positional Encodingï¼ï¼</strong><br>
è¿æ¯ NeRF è½ç«çå³é®ãç¥ç»ç½ç»å¤©çå¾åäºå­¦ä¹ âå¹³æ»âçä¸è¥¿ï¼å®¹ææå¾ååæ¨¡ç³ãNeRF éè¿æåæ è½¬æ¢æé«é¢æ­£å¼¦/ä½å¼¦æ³¢ï¼å¼ºå¶ç½ç»è®°ä½ç»èï¼å¦ç©ä½çè¾¹ç¼ãç»å°ççº¹çï¼ã</li>
<li><strong>å¯å¾®ä½æ¸²æï¼Differentiable Volume Renderingï¼ï¼</strong><br>
è¿æ¯ NeRF çâæ¸²æå¼æâãå®æ²¿çç¸æºå°åºçä¸æ¡åçº¿è¿è¡éæ ·ï¼æè·¯å¾ä¸ææç¹çé¢è²åå¯åº¦å æç´¯å ï¼æç»å¾å°ä¸ä¸ªåç´ çé¢è²ãå ä¸ºæ´ä¸ªè¿ç¨æ¯<strong>æ°å­¦å¯å¯¼</strong>çï¼æä»¥å¯ä»¥éè¿å¯¹æ¯çæçå¾ååçå®ç§ççå·®å¼ï¼å©ç¨<strong>ååä¼ æ­</strong>æ¥è®­ç»ç½ç»ã</li>
</ol>
<hr>
<h4 id="3-nerf-çå·¥ä½æµç¨">3. NeRF çå·¥ä½æµç¨</h4>
<ol>
<li><strong>åå¤æ°æ®ï¼</strong> ææå åå¼ å°ä¸ç¾å¼ ç©ä½çç§çï¼å¹¶å©ç¨ <strong>SfM (å¦ COLMAP)</strong> ç®åºæ¯å¼ ç§çæææ¶çç²¾ç¡®ç¸æºä½ç½®ã</li>
<li><strong>åçº¿æå°ï¼</strong> å¯¹äºå¾åä¸çæ¯ä¸ªåç´ ï¼ä»ç¸æºä¸­å¿å°åºä¸æ¡ç©¿è¿è¯¥åç´ çåçº¿ã</li>
<li><strong>éæ ·ä¸æ¥è¯¢ï¼</strong> å¨è¿æ¡åçº¿ä¸éæ ·æç¾ä¸åä¸ªç¹ï¼æè¿äºç¹çåæ ä¸¢è¿ç¥ç»ç½ç»éã</li>
<li><strong>åæé¢è²ï¼</strong> ç¥ç»ç½ç»è¾åºè¿äºç¹çé¢è²åå¯åº¦ï¼éè¿ä½æ¸²æå¬å¼æå®ä»¬âæåâæä¸ä¸ªåç´ é¢è²ã</li>
<li><strong>ä¼åæéï¼</strong> æ¯è¾ AI çæçåç´ åç§çéççå®åç´ ãå¦æä¸ä¸æ ·ï¼å°±è°æ´ç¥ç»ç½ç»çåæ°ãéå¤æåä¸ä¸æ¬¡ï¼ç´å°ç½ç»è½å®ç¾é¢æµåºä»»ä½è§åº¦çç»é¢ã</li>
</ol>
<hr>
<h4 id="4-ä¸ºä»ä¹-nerf-ææè¿ä¹éæ¼">4. ä¸ºä»ä¹ NeRF ææè¿ä¹éæ¼ï¼</h4>
<ul>
<li><strong>ç§ççº§ççå®æï¼</strong> å®è½å®ç¾å¤çåæ³½è¡¨é¢ï¼å¦éå±çååï¼ãéæç©ä½ï¼å¦ç»çæ¯ï¼ä»¥åæå¶å¤æçå ä½ç»æï¼å¦å¤´åãæ å¶ï¼ï¼è¿äºé½æ¯ä¼ ç»ç¹äºæ Mesh çå©æ¢¦ã</li>
<li><strong>æ éçåè¾¨çï¼</strong> å ä¸ºæ¯è¿ç»­å½æ°ï¼çè®ºä¸ä½ å¯ä»¥æ éæ¾å¤§åºæ¯ã</li>
<li><strong>è§è§æå¼ï¼</strong> ä½ åªæäº 20 å¼ ç§çï¼ä½ NeRF å¯ä»¥çæç¸æºä»æªç»è¿çä½ç½®çå¹³æ»è§é¢ï¼ææå°±åå¨å¥½è±åçµå½±éç©¿æ¢­ä¸æ ·ã</li>
</ul>
<hr>
<h4 id="5-å±éæ§ä¸ç®åçç¶é¢">5. å±éæ§ä¸ç®åçç¶é¢</h4>
<p>å°½ç®¡æææè³ï¼ä½åç NeRF å­å¨ä»¥ä¸é®é¢ï¼</p>
<ol>
<li><strong>è®­ç»ææ¢ï¼</strong> 2020 å¹´ååºæ¥æ¶ï¼è®­ç»ä¸ä¸ªåºæ¯éè¦å å°æ¶çè³å å¤©ã</li>
<li><strong>æ¸²æï¼æ¨çï¼ææ¢ï¼</strong> çæä¸å¼ å¾éè¦å ç§éï¼æ æ³åå°å®æ¶äºå¨ã</li>
<li><strong>åºæ¯æ¯æ­»æ¿çï¼</strong> åç NeRF åªè½éå»ºéæåºæ¯ï¼å¦æç»é¢éæä¸è¥¿å¨å¨ï¼æèåçº¿åäºï¼æ¨¡åå°±ä¼å´©æºã</li>
<li><strong>éè¦ç¸æºä½å§¿ï¼</strong> å®æå¶ä¾èµ SfM æä¾çç²¾ç¡®åæ ï¼å¦æç§çä½å§¿ç®éäºï¼NeRF åºæ¥çç»æä¼æ¯ä¸å¢æµç³ã</li>
</ol>
<hr>
<h4 id="6-è¿åä¹è·¯nerf-çå­å­ä»¬">6. è¿åä¹è·¯ï¼NeRF çå­å­ä»¬ï¼</h4>
<p>ä¸ºäºè§£å³ä¸è¿°é®é¢ï¼è¯çäºä¸ç³»ååä½ï¼</p>
<ul>
<li><strong>Instant-NGP (NVIDIA)ï¼</strong> å°è®­ç»æ¶é´ä»å°æ¶çº§ç¼©ç­å°äº<strong>ç§çº§</strong>ã</li>
<li><strong>Mip-NeRFï¼</strong> è§£å³äºç©ä½å¨è¿è¿åæ¢æ¶çé¯é½¿é®é¢ã</li>
<li><strong>D-NeRF / NSVFï¼</strong> å°è¯å¤çä¼å¨çç©ä½ï¼å¨æåºæ¯ï¼ã</li>
<li><strong>3D Gaussian Splatting (2023)ï¼</strong> è½ç¶ä¸å®å¨æ¯ NeRFï¼ä½å®å¸åäº NeRF çææ³ï¼å®ç°äº<strong>çæ­£å®æ¶</strong>çé«è´¨éæ¸²æï¼æ¯ç®åæç«çæ¿ä»£æ¹æ¡ã</li>
</ul>
<hr>
<h4 id="7-åèæç®">7. åèæç®</h4>
<ol>
<li><strong>Mildenhall, B., Srinivasan, P. P., Tancik, M., Barron, J. T., Ramamoorthi, R., &amp; Ng, R. (2020).</strong> <em>NeRF: Representing Scenes as Neural Radiance Fields for View Synthesis</em>.<br>
ECCV. (NeRF çå¼å±±ä¹ä½)ã</li>
<li><strong>MÃ¼ller, T., Evans, A., Schied, C., &amp; Keller, A. (2022).</strong> <em>Instant Neural Graphics Primitives with a Multiresolution Hash Encoding</em>. ACM Transactions on Graphics.<br>
(NVIDIA æåºç Instant-NGPï¼è®© NeRF èµ°åå®ç¨å)ã</li>
<li><strong>Barron, J. T., et al. (2021).</strong> <em>Mip-NeRF: A Multiscale Representation for Anti-Aliasing Neural Radiance Fields</em>. ICCV.<br>
(è§£å³äºæé¯é½¿åå¤å°ºåº¦é®é¢)ã</li>
<li><strong>Tancik, M., et al. (2022).</strong> <em>Block-NeRF: Scalable Large Scene Neural View Synthesis</em>. CVPR.<br>
(è¯æäº NeRF å¯ä»¥ç¨æ¥éå»ºæ´ä¸ªåå¸è¡é)ã</li>
<li><strong>Martin-Brualla, R., et al. (2021).</strong> <em>NeRF in the Wild: Neural Radiance Fields for Unconstrained Photo Collections</em>. CVPR.<br>
(è§£å³äºå©ç¨äºèç½ä¹±ä¸å«ç³çç§çè¿è¡éå»ºçé®é¢)ã</li>
</ol>
<h3 id="d-3d-gaussian-splatting-3dgs">D. 3D Gaussian Splatting (3DGS)ï¼</h3>
<p><strong>ææ°ï¼</strong> 2023å¹´åºç°çææ¯ï¼éè¿å¤§é3Dé«æ¯æ¤­çä½æååºæ¯ï¼å®ç°äºæ¯NeRFæ´å¿«çæ¸²æéåº¦åæé«çéå»ºè´¨éã</p>
<p>å¦æè¯´ <strong>NeRF</strong> æ¯ 3D éå»ºé¢åçâæ°å­å¹»è§âï¼é£ä¹ <strong>3D Gaussian Splatting (3DGS)</strong> å°±æ¯å¨ 2023 å¹´æ¨ªç©ºåºä¸çâæ°å­ç»ç¬âã</p>
<p>3DGS çåºç°ç´æ¥è§£å³äº NeRF æ¸²ææ¢ãè®­ç»ä¹çæ ¸å¿çç¹ï¼å° 3D éå»ºæ¨åäº<strong>å®æ¶ãé«ç»è´¨ãå¯äº¤äº</strong>çæ°çºªåã</p>
<hr>
<h4 id="1-ä»ä¹æ¯-3d-gaussian-splatting-3dgs">1. ä»ä¹æ¯ 3D Gaussian Splatting (3DGS)ï¼</h4>
<p><strong>å®ä¹ï¼</strong><br>
3DGS æ¯ä¸ç§åºäº<strong>æ¾å¼è¾å°åºï¼Explicit Radiance Fieldï¼</strong>çåºæ¯è¡¨ç¤ºææ¯ãå®ä¸ä½¿ç¨ç¥ç»ç½ç»æ¥âçâé¢è²ï¼èæ¯ç´æ¥å¨ç©ºé´ä¸­ææ´æ°ç¾ä¸ä¸ªå¸¦æé¢è²ãå½¢ç¶åéæåº¦ç<strong>3D é«æ¯æ¤­çä½ï¼Gaussian Kernelsï¼</strong>ï¼éè¿è¿äºæ¤­çä½çå å æ¥æ¼ååºæ´ä¸ªä¸çã</p>
<p><strong>å½¢è±¡æ¯å»ï¼</strong></p>
<ul>
<li><strong>NeRF</strong> åæ¯ä¸ä¸ªè®°å¿åè¶å¼ºçç»å¸ï¼ä½ é®ä»ç»éæä¸ªåæ æ¯ä»ä¹é¢è²ï¼ä»æ³ä¸ä¸åè¯ä½ ã</li>
<li><strong>3DGS</strong> åæ¯ä¸ä¸ªè´´çº¸å¤§å¸ï¼ä»ç´æ¥å¨éæçç©ºé´éè´´äºæ°ç¾ä¸å¼ åéæçå½©è²è´´çº¸ï¼æ¤­çä½ï¼ï¼ä½ ä»ä»»ä½è§åº¦çè¿å»ï¼è¿äºè´´çº¸å å å¨ä¸èµ·å°±æ¯ä¸å¼ å®ç¾çç§çã</li>
</ul>
<hr>
<h4 id="2-æ ¸å¿åç3d-é«æ¯æ¤­çä½çåºå ">2. æ ¸å¿åçï¼3D é«æ¯æ¤­çä½çâåºå â</h4>
<p>æ¯ä¸ä¸ª 3D é«æ¯æ¤­çä½é½åå«äºä¸ç»æå¶ç²¾ç®çæ°å­¦åæ°ï¼åºå ï¼ï¼</p>
<ol>
<li><strong>ä¸­å¿ä½ç½® (Position, $X, Y, Z$)ï¼</strong> æ¤­çä½å¨åªã</li>
<li><strong>åæ¹å·®ç©éµ (Covariance, $\Sigma$)ï¼</strong> å³å®æ¤­çä½ç<strong>å½¢ç¶åæ¹å</strong>ãä¸ºäºæ¹ä¾¿è®¡ç®ï¼å®è¢«åè§£ä¸ºï¼
<ul>
<li><strong>ç¼©æ¾ (Scaling)ï¼</strong> å®æ¯é¿çãåçè¿æ¯æçã</li>
<li><strong>æè½¬ (Rotation)ï¼</strong> å®æ¯æ¨ªççè¿æ¯æççã</li>
</ul>
</li>
<li><strong>ä¸éæåº¦ (Opacity, $\alpha$)ï¼</strong> è¿ä¸ªæ¤­çä½æå¤éæã</li>
<li><strong>çè°å½æ°é¢è² (Spherical Harmonics, SH)ï¼</strong> è¿æ¯ä¸ç§ç¹æ®çé¢è²è¡¨ç¤ºæ³ãå®ä¸åªæ¯ä¸ä¸ªåä¸é¢è²ï¼èæ¯è®°å½äº<strong>ä»ä¸åæ¹åçè¿ä¸ªç¹æ¶é¢è²çåå</strong>ï¼æ¯å¦éå±çé«åï¼ã</li>
</ol>
<hr>
<h4 id="3-å·¥ä½æµç¨ä»ç¹äºå°ç²¾ç¾å»ºæ¨¡">3. å·¥ä½æµç¨ï¼ä»ç¹äºå°ç²¾ç¾å»ºæ¨¡</h4>
<p><strong>ç¬¬ä¸æ­¥ï¼åå§å (Initialization)</strong><br>
3DGS éå¸¸ä»¥ <strong>SfM (å¦ COLMAP)</strong> äº§ççç¨çç¹äºä½ä¸ºèµ·ç¹ãæ¯ä¸ªç¹è¢«åå§åä¸ºä¸ä¸ªå°ç 3D é«æ¯çã</p>
<p><strong>ç¬¬äºæ­¥ï¼å¯å¾®æå½±ä¸æ¸²æ (Splatting &amp; Rasterization)</strong><br>
è¿æ¯ 3DGS éåº¦æå¿«çç§è¯ã</p>
<ul>
<li>ç®æ³å° 3D çæ¤­çä½å¹³æåï¼æå½±ï¼å° 2D å±å¹ä¸ï¼åæä¸ä¸ªä¸ª 2D æ¤­åã</li>
<li>éç¨<strong>åºäºååï¼Tile-basedï¼çå¿«éåæ åæ¸²æå¨</strong>ãå®å°å±å¹åæè®¸å¤å°æ ¼å­ï¼Tilesï¼ï¼åªæ¸²æå¯¹è¿ä¸ªæ ¼å­æè´¡ç®çæ¤­çä½ãè¿ä¸ç°ä»£æ¾å¡ï¼GPUï¼çå¤çé»è¾å®å¨å¹éã<br>
<img alt="å¨è¿éæå¥å¾çæè¿°" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3724025/202602/3724025-20260206090341298-382707320.png" class="lazyload"></li>
</ul>
<p><strong>ç¬¬ä¸æ­¥ï¼èªéåºå¯åº¦æ§å¶ (Adaptive Density Control)</strong><br>
è¿æ¯ 3DGS çâè¿åâè¿ç¨ãå¨ä¼åè¿ç¨ä¸­ï¼ç®æ³ä¼è§å¯ï¼</p>
<ul>
<li><strong>åé (Clone)ï¼</strong> å¦ææä¸ªå°æ¹å¤ªå¹³æ»ï¼ç¹ä¸å¤ç¨ï¼å°±å¨é£å¤å¶ä¸ä¸ªç¹ã</li>
<li><strong>åè£ (Split)ï¼</strong> å¦ææä¸ªæ¤­çä½å¤ªå¤§ãå¤ªæ¨¡ç³ï¼å°±æå®ææä¸¤ä¸ªå°çã</li>
<li><strong>ä¿®åª (Culling)ï¼</strong> å¦ææä¸ªæ¤­çä½ä¸éæåº¦æä½ï¼åºæ¬çä¸è§ï¼å°±æå®å æã</li>
</ul>
<hr>
<p><strong>ä¸ºä»ä¹ 3DGS è½å¨ 2023 å¹´å¼çææ¯åï¼</strong></p>
<ol>
<li><strong>æ¸²æéåº¦èµ·é£ï¼</strong> NeRF æ¸²æä¸å¼ å¾éè¦å ç§éï¼è 3DGS å¯ä»¥å¨æ®éç GPU ä¸å®ç° <strong>100+ FPS</strong>ï¼æ¯ç§å¸§æ°ï¼çå®æ¶æ¸²æã</li>
<li><strong>è®­ç»æ¶é´æç­ï¼</strong> ä¸ä¸ªä¸­ç­å¤æçåºæ¯ï¼NeRF å¯è½è¦è®­ç»å å°æ¶ï¼3DGS åªéè¦ <strong>5-10 åé</strong>ã</li>
<li><strong>æ¾å¼å­å¨ï¼</strong> å ä¸ºå®æ¯æ°ç¾ä¸ä¸ªç¹ï¼ä½ å¯ä»¥ç´æ¥å¨ 3D è½¯ä»¶éçå°è¿äºç¹ï¼çè³å¯ä»¥æå¨å é¤ãç§»å¨æç¼©æ¾å¶ä¸­çä¸é¨åï¼è¿å¨ NeRF çç¥ç»ç½ç»æééæ¯å ä¹åä¸å°çã</li>
<li><strong>è§è§æææè³ï¼</strong> 3DGS ææç²¾ç»ç»èï¼å¦æ å¶ãæ¯åãèé¾ï¼çè½åæå¼ºï¼ç»é¢è¾¹ç¼æ¯ NeRF æ´å éå©ã</li>
</ol>
<hr>
<h4 id="5-ç®åçç¶é¢ä¸ææ">5. ç®åçç¶é¢ä¸ææ</h4>
<ol>
<li><strong>æ¾å­ååå¤§ (VRAM Intensive)ï¼</strong> æ¸²æè½ç¶å¿«ï¼ä½è¦å¨æ¾å­éå­å¨æ°ç¾ä¸ä¸ªé«æ¯åæ°ï¼éå¸¸åæ¾å­ï¼éå¸¸éè¦ 8GB ä»¥ä¸çæ¾å­æè½æµçè¿è¡å¤§ååºæ¯ï¼ã</li>
<li><strong>å­å¨ç©ºé´å·¨å¤§ï¼</strong> ä¸ä¸ªé«è´¨éåºæ¯çæ¨¡åæä»¶å¯è½é«è¾¾ <strong>æ°ç¾ MB çè³å ä¸ª GB</strong>ï¼è NeRF åªéè¦å  MB çç¥ç»ç½ç»æéã</li>
<li><strong>ä¾èµåå§åï¼</strong> å¦æ SfM åºæ¥çåå§ç¹äºå¤ªå·®ï¼æ¯å¦å¨åæ»å¹³é¢ä¸æ²¡åå°ç¹ï¼ï¼3DGS å¾é¾å­ç©ºçæé«è´¨éçæ¤­çä½ï¼ä¼åºç°ææ¾çâç ´æ´âã</li>
<li><strong>ä¼ªå½± (Artifacts)ï¼</strong> å¨è§è§ååå§çæ¶ï¼ææ¶ä¼çå°æ¤­çä½åâå½©è²éªè±âä¸æ ·æ¼æµ®ã</li>
</ol>
<hr>
<h4 id="6-åèæç®">6. åèæç®</h4>
<ol>
<li><strong>Kerbl, B., Kopanas, G., LeimkÃ¼hler, T., &amp; Drettakis, G. (2023).</strong> <em>3D Gaussian Splatting for Real-Time Radiance Field Rendering</em>. ACM Transactions on Graphics (SIGGRAPH).<br>
(3DGS çå¼å±±é¼»ç¥ï¼ç®åè¯¥é¢åå¼ç¨éæé«çè®ºæ)ã</li>
<li><strong>Zwicker, M., Pfister, H., van Baar, J., &amp; Gross, M. (2001).</strong> <em>Surface Splatting</em>. SIGGRAPH.<br>
(3DGS æ ¸å¿ææ³âSplattingâçæ©æçè®ºæ¥æº)ã</li>
<li><strong>Luan, F., et al. (2024).</strong> <em>GPS-Gaussian: Generalizable Pixel-wise 3D Gaussian Splatting for Real-time Human Novel View Synthesis</em>.<br>
(å° 3DGS åºç¨äºäººä½å¨æå»ºæ¨¡çåæ²¿å·¥ä½)ã</li>
<li><strong>Niedermayr, S., et al. (2023).</strong> <em>Compressed 3D Gaussian Splatting for Highly Accessible Novel View Synthesis</em>.<br>
(éå¯¹ 3DGS å­å¨ä½ç§¯è¿å¤§é®é¢çæ©æä¼åç ç©¶)ã</li>
<li><strong>Chen, Z., et al. (2023).</strong> <em>MCMC-GS: Multi-Scale 3D Gaussian Splatting for Large-Scale Scene Reconstruction</em>.<br>
(éå¯¹å¤§è§æ¨¡åå¸åºæ¯ç 3DGS æ¹è¿ç®æ³)ã</li>
</ol>
<h2 id="äº-ä¸»å¨è§è§active-vision-èªå¸¦åæº">äº. ä¸»å¨è§è§ï¼Active Visionï¼ââ èªå¸¦åæº</h2>
<p>è¿ç±»æ¹æ³éè¿åç©ä½åå°ç¹å®åçº¿æ¥è¾å©æµéã</p>
<ol>
<li><strong>ç»æåï¼Structured Lightï¼ï¼</strong>
<ul>
<li><strong>åçï¼</strong> æå½±ä»ªåç©ä½æå°ç¹å®çåæ å¾æ¡ï¼ç¸æºææè¢«ç©ä½è¡¨é¢ç¸ååçå¾æ¡ï¼éè¿æ°å­¦è®¡ç®å¾åºæ·±åº¦ã</li>
<li><strong>ä»£è¡¨ï¼</strong> iPhoneçåç½®FaceIDã<br>
å¦æè¯´ <strong>SfM</strong> å<strong>åç®è§è§</strong>æ¯å©ç¨âèªç¶çç¼çâå»è§å¯ä¸çï¼é£ä¹<strong>ç»æåï¼Structured Lightï¼</strong>åæ¯ç»æºå¨è£ä¸äºä¸å°âä¸»å¨æµéå°ºâã</li>
</ul>
</li>
</ol>
<p>å®æ¯ç®åé«ç²¾åº¦ 3D æ«æãäººè¸è¯å«ï¼å¦ iPhone FaceIDï¼åå·¥ä¸ç²¾å¯æ£æµé¢åææ ¸å¿çææ¯ã</p>
<hr>
<h3 id="a-ç»æåææ¯">A. ç»æåææ¯</h3>
<h4 id="å®ä¹-1"><strong>å®ä¹ï¼</strong></h4>
<p>ç»æåæ¯ä¸ç§<strong>ä¸»å¨è§è§</strong>æµéææ¯ãå®éè¿æå½±ä»ªåç©ä½è¡¨é¢æå°ç¹å®ç<strong>å·²ç¥å¾æ¡</strong>ï¼å¦æ ¼ç¹ãæ¡çº¹ãç¼ç å¾ï¼ï¼åç±ç¸æºææè¿äºå¾æ¡å¨ç©ä½è¡¨é¢åçç<strong>å ä½ç¸å</strong>ï¼éè¿ä¸è§æµéåçè®¡ç®åºç©ä½çä¸ç»´ç©ºé´åæ ã</p>
<p><strong>å½¢è±¡æ¯å»ï¼</strong><br>
æ³è±¡ä½ å¨é»æä¸­é¢å¯¹ä¸é¢å¹å¸ä¸å¹³çå¢ãä½ æå¼ä¸æ¯æçµç­ï¼æçµç­çåç½©ä¸ç»çæ´é½çæ¹æ ¼ã</p>
<ul>
<li>å¦æå¢æ¯å¹³çï¼ä½ å¨å¢ä¸çå°çæ¹æ ¼ä¹æ¯æ´é½çã</li>
<li>å¦æå¢ä¸æä¸ªåæèå¸èµ·ï¼æ¹æ ¼çº¿å°±ä¼åå¾å¼¯æ²ã</li>
<li>éè¿è§å¯æ¹æ ¼çº¿âå¼¯äºå¤å°âï¼ä½ å°±è½æ¨ç®åºå¢é¢çèµ·ä¼ãè¿å°±æ¯ç»æåã</li>
</ul>
<p><img alt="å¨è¿éæå¥å¾çæè¿°" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3724025/202602/3724025-20260206090340298-1210460548.png" class="lazyload"></p>
<hr>
<h4 id="2-æ ¸å¿æ°å­¦åçåå½¢çä¸è§æµé">2. æ ¸å¿æ°å­¦åçï¼åå½¢çä¸è§æµé</h4>
<p>ç»æåæ¬è´¨ä¸æ¯<strong>åç®è§è§çåç§</strong>ã</p>
<ul>
<li>å¨åç®è§è§ä¸­ï¼æä»¬éè¦ä¸¤ä¸ªç¸æºä»ä¸åè§åº¦çåä¸ä¸ªç¹ã</li>
<li>å¨ç»æåä¸­ï¼æä»¬ç¨ä¸ä¸ª<strong>æå½±ä»ª</strong>æ¿ä»£äºå¶ä¸­ä¸ä¸ªç¸æºã</li>
</ul>
<p><strong>æ°å­¦é»è¾ï¼</strong></p>
<ol>
<li><strong>å·²ç¥æ¡ä»¶ï¼</strong> æå½±ä»ªæå°åºçåæè§åº¦æ¯å·²ç¥çï¼ç¸æºä¸æå½±ä»ªä¹é´çè·ç¦»ï¼åºçº¿ $B$ï¼æ¯åºå®çã</li>
<li><strong>å¯»æ¾å¹éï¼</strong> æå½±ä»ªæåºçæ¯ä¸ä¸ªåç¹ï¼æçº¿æ¡ï¼é½æä¸ä¸ªå¯ä¸çâç¼ç âãç¸æºæå°è¿ä¸ªç¹åï¼ç«å»å°±è½ç¥éå®æ¯ä»æå½±ä»ªçåªä¸ªè§åº¦å°åºæ¥çã</li>
<li><strong>å ä½æ±è§£ï¼</strong> æå½±ä»ªååºçå°çº¿ä¸ç¸æºæ¥æ¶å°çå°çº¿å¨ç©ºé´ä¸­ç¸äº¤ãæ ¹æ®<strong>æ­£å¼¦å®ç</strong>æç®åç<strong>ä¸è§å½æ°</strong>ï¼å³å¯è§£ç®åºè¯¥äº¤ç¹çä¸ç»´åæ  $(X, Y, Z)$ã</li>
</ol>
<hr>
<h4 id="3-ç¼ç æ¹å¼ç»æåçè¯­è¨">3. ç¼ç æ¹å¼ï¼ç»æåçâè¯­è¨â</h4>
<p>ç»æåææ ¸å¿çç«äºåå¨äºå¦ä½è®¾è®¡æå°çâå¾æ¡âãç®åä¸»æµæä¸ç§ï¼</p>
<p><strong>A. ç©ºé´ç¼ç  (Spatial Coding) ââ ä»£è¡¨ï¼iPhone FaceID</strong></p>
<ul>
<li><strong>åæ³ï¼</strong> ä¸æ¬¡æ§æå°ä¸ä¸ªå¤æçæ£æå¾æ¡ï¼ç±»ä¼¼æ»¡å¤©æï¼ã</li>
<li><strong>ç¹ç¹ï¼</strong> åªéææä¸å¼ å¾çå³å¯å®æéå»ºï¼éåº¦æå¿«ï¼éåå¨æç©ä½ï¼å¦äººè¸ï¼ã<br>
<img alt="å¨è¿éæå¥å¾çæè¿°" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3724025/202602/3724025-20260206090341092-1937191911.png" class="lazyload"></li>
</ul>
<p><strong>B. æ¶é´ç¼ç  (Temporal Coding) ââ ä»£è¡¨ï¼å·¥ä¸ 3D æ«æä»ª</strong></p>
<ul>
<li><strong>åæ³ï¼</strong> è¿ç»­æå°å¤å¼ ä¸åé¢ççé»ç½æ¡çº¹ï¼å¦æ ¼é·ç  + æ­£å¼¦æ¡çº¹ï¼ã</li>
<li><strong>ç¹ç¹ï¼</strong> ç²¾åº¦æé«ï¼å¯è¾¾å¾®ç±³çº§ï¼ï¼ä½ç©ä½å¿é¡»ä¿æéæ­¢ï¼å ä¸ºéè¦ææå¤å¼ ç§çã<br>
<img alt="å¨è¿éæå¥å¾çæè¿°" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3724025/202602/3724025-20260206090341051-742264660.png" class="lazyload"></li>
</ul>
<p><strong>C. ç¸ç§»æ³ (Phase Shifting)</strong></p>
<ul>
<li><strong>åæ³ï¼</strong> æå°å¨ææ§çæ­£å¼¦åæ ï¼éè¿åæåæ³¢ç¸ä½çåç§»æ¥æåé«åº¦ä¿¡æ¯ã<br>
<img alt="å¨è¿éæå¥å¾çæè¿°" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3724025/202602/3724025-20260206090340635-1134427730.png" class="lazyload"></li>
</ul>
<hr>
<h4 id="4-æ·±åº¦è§£æiphone-faceid-æ¯å¦ä½å·¥ä½ç">4. æ·±åº¦è§£æï¼iPhone FaceID æ¯å¦ä½å·¥ä½çï¼</h4>
<p>FaceID æ¯ç»æåææ¯å°ååãæ¶è´¹çº§åºç¨çå·å³°ãå®åå«ä¸ä¸ªæ ¸å¿ç»ä»¶ï¼</p>
<ol>
<li><strong>ç¹éµæå½±å¨ (Dot Projector)ï¼</strong> åä½ çè¸é¨æå°è¶è¿ <strong>30,000 ä¸ª</strong>èç¼ä¸å¯è§ççº¢å¤æ£æç¹ã</li>
<li><strong>çº¢å¤æåå¤´ (Infrared Camera)ï¼</strong> è¯»åè¿äºæ£æå¨è¸é¨èµ·ä¼ä¸å½¢æçç¸åå¾åã</li>
<li><strong>æ³åæåºåä»¶ (Flood Illuminator)ï¼</strong> ç¡®ä¿å¨å¨é»ç¯å¢ä¸ä¹è½ç§äº®è¸é¨ï¼ä¾çº¢å¤ç¸æºè¯å«ã</li>
</ol>
<p><strong>ä¸ºä»ä¹å®å®å¨ï¼</strong><br>
å ä¸ºå®ä¸æ¯å¨å¯¹æ¯âç§çâï¼èæ¯å¨å¯¹æ¯ä½ è¸é¨ç<strong>ä¸ç»´å°å½¢å¾</strong>ãç§çæ¯å¹³é¢çï¼æ æ³äº§çç»æåçç¸åææï¼å æ­¤æ æ³æ¬ºéª FaceIDã</p>
<hr>
<h4 id="5-ç»æåçä¼ç¼ºç¹">5. ç»æåçä¼ç¼ºç¹</h4>
<p><strong>ä¼ç¹ï¼</strong></p>
<ol>
<li><strong>æ éç¯å¢çº¹çï¼</strong> å³ä½¿æ¯çº¯ç½è²çå¢ï¼ç»æåä¹è½éå»ºï¼å ä¸ºå®èªå·±æå°äºçº¹çï¼ï¼è¿å¼¥è¡¥äºåç®è§è§çç­æ¿ã</li>
<li><strong>ç²¾åº¦æé«ï¼</strong> å¨è¿è·ç¦»ï¼1ç±³ä»¥åï¼ï¼ç»æåçç²¾åº¦å¯ä»¥è½»æ¾è¾¾å°æ¯«ç±³çè³å¾®ç±³çº§ã</li>
<li><strong>ä¸»å¨è¡¥åï¼</strong> å¨å¨é»çç¯å¢ä¸ä¾ç¶è½å·¥ä½ã</li>
</ol>
<p><strong>ç¼ºç¹ï¼</strong></p>
<ol>
<li><strong>æå¼ºåï¼</strong> å¨å®¤å¤å¼ºåï¼å¦é³åï¼ä¸ï¼æå½±ä»ªçåä¼è¢«é³åæ·¹æ²¡ï¼å¯¼è´å¤±æã</li>
<li><strong>è·ç¦»éå¶ï¼</strong> æå½±ä»ªåçæéï¼éå¸¸åªéç¨äºè¿è·ç¦»ï¼å¦ææºè§£éãæ¡é¢æ«æï¼ã</li>
<li><strong>æè´¨ææï¼</strong> é¢å¯¹éé¢ååç©ä½æå¨é»å¸åç©ä½ï¼æå°çåä¼æ¶å¤±æä¹±å°ï¼å¯¼è´æ æ³æåã</li>
</ol>
<hr>
<h3 id="6-åèæç®-1">6. åèæç®</h3>
<ol>
<li><strong>Geng, J. (2011).</strong> <em>Structured-light 3D surface imaging: a tutorial</em>. Advances in Optics and Photonics.<br>
(æç»å¸çç»æåç»¼è¿°æ§æç¨)ã</li>
<li><strong>Scharstein, D., &amp; Szeliski, R. (2003).</strong> <em>High-accuracy stereo depth maps using structured light</em>. CVPR.<br>
(æ¢è®¨äºå¦ä½å©ç¨ç»æåè·åæé«ç²¾åº¦çæ·±åº¦å¾)ã</li>
<li><strong>Salvi, J., et al. (2004).</strong> <em>Pattern codification strategies in structured light systems</em>. Pattern Recognition.<br>
(è¯¦ç»å¯¹æ¯äºåç§ç¼ç å¾æ¡çä¼å£)ã</li>
<li><strong>Apple Inc.</strong> <em>About Face ID advanced technology</em>. Support Documentation.<br>
(è½ç¶ä¸æ¯å­¦æ¯è®ºæï¼ä½æ­ç¤ºäºæ¶è´¹çº§ç»æåç³»ç»çç¡¬ä»¶æ¶æ)ã</li>
<li><strong>Zuo, C., et al. (2016).</strong> <em>Micro-structured-light 3D surface profiling: A review</em>. Measurement.<br>
(èç¦äºå¾®è§é¢åé«ç²¾åº¦ç»æåæµéçç»¼è¿°)ã</li>
</ol>
<h3 id="é£è¡æ¶é´æ³tof-time-of-flight">é£è¡æ¶é´æ³ï¼ToF, Time of Flightï¼</h3>
<p><strong>åçï¼</strong> åå°çº¢å¤èå²ï¼æµéåçº¿åå°åæ¥çæ¶é´ã<br>
<strong>ä»£è¡¨ï¼</strong> æ¿åé·è¾¾ï¼LiDARï¼ãKinect 2.0ã<br>
å¦æè¯´<strong>ç»æå</strong>æ¯å©ç¨âå ä½ç¸åâæ¥æµéï¼é£ä¹<strong>é£è¡æ¶é´æ³ï¼ToF, Time of Flightï¼</strong>å°±æ¯å©ç¨âç»å¯¹éåº¦âæ¥æµéã</p>
<p>ToF æ¯ç®å 3D æç¥é¢åä¸­éåº¦æå¿«ãå»¶è¿æä½çææ¯ãå®å¹¿æ³åºç¨äºèªå¨é©¾é©¶çæ¿åé·è¾¾ï¼LiDARï¼ãææºåç½®æ·±åº¦æåå¤´ï¼å¦ iPhone ç LiDAR æ«æä»ªï¼ä»¥åæ©æçä½ææ¸¸æè®¾å¤ã</p>
<hr>
<h4 id="1-ä»ä¹æ¯-tof-é£è¡æ¶é´æ³">1. ä»ä¹æ¯ ToF (é£è¡æ¶é´æ³)ï¼</h4>
<p><strong>å®ä¹ï¼</strong><br>
ToF æ¯ä¸ç§éè¿æµéåæ³¢å¨ä¼ æå¨ä¸ç®æ ç©ä½ä¹é´âé£è¡âçæ¶é´ï¼æ¥è®¡ç®ç®æ è·ç¦»çææ¯ãå ä¸ºåçä¼ æ­éåº¦ $c$ æ¯å·²ç¥çå¸¸æ°ï¼åªè¦ç¥éäºæ¶é´ $t$ï¼è·ç¦» $d$ ä¹å°±è¿åèè§£ã</p>
<p><strong>å½¢è±¡æ¯å»ï¼</strong><br>
æ³è±¡ä½ å¯¹çä¸å£æ·±äºå¤§åä¸å£°ï¼ç¶åå¼å§è®¡æ¶ãå½ä½ å¬å°åå£°æ¶ï¼åæ­¢è®¡æ¶ã</p>
<ul>
<li><strong>å£°çº³/é·è¾¾ï¼</strong> å©ç¨å£°æ³¢ææ çº¿çµæ³¢çåå°ã</li>
<li><strong>ToFï¼</strong> å©ç¨åæ³¢ï¼éå¸¸æ¯ 850nm-940nm çè¿çº¢å¤åï¼ãç±äºåéæå¿«ï¼æ¯ç§ 30 ä¸å¬éï¼ï¼ToF è¯çéè¦å·å¤âç®ç§çº§âï¼ä¸äº¿åä¹ä¸ç§ï¼çè®¡æ¶ç²¾åº¦ã</li>
</ul>
<hr>
<h4 id="2-æ ¸å¿æ°å­¦åçæéå¬å¼">2. æ ¸å¿æ°å­¦åçï¼æéå¬å¼</h4>
<p>ToF çåºæ¬åçéå¸¸ç´è§ï¼ä½å®ç°æ¹æ³åä¸ºä¸¤ç§ä¸»è¦æµæ´¾ï¼<strong>dToF</strong> å <strong>iToF</strong>ã</p>
<p><strong>A. dToF (Direct ToFï¼ç´æ¥æµé) ââ ä»£è¡¨ï¼æ¿åé·è¾¾ (LiDAR)</strong><br>
è¿æ¯æç¡¬æ ¸çæ¹å¼ãä¼ æå¨ç´æ¥åå°ä¸ä¸ªæç­çåèå²ï¼å¹¶å¯å¨ä¸ä¸ªè¶é«ç²¾åº¦çâç§è¡¨âï¼è®°å½åå­é£åºå»å¹¶è·³åæ¥çç¡®åæ¶é´ $\Delta t$ã</p>
<ul>
<li><strong>å¬å¼ï¼</strong> $d = \frac{c \cdot \Delta t}{2}$</li>
<li><strong>é¾ç¹ï¼</strong> åéå¤ªå¿«ï¼åèµ° 1 åç±³åªéè¦çº¦ 33 ç®ç§ãè¿å°±è¦æ±ä¼ æå¨ï¼éå¸¸æ¯ SPADï¼ååå­éªå´©äºæç®¡ï¼å·ææå¶ææçååºéåº¦ã</li>
</ul>
<p><strong>B. iToF (Indirect ToFï¼é´æ¥æµé) ââ ä»£è¡¨ï¼Kinect 2.0</strong><br>
ç±äºç²¾ç¡®è®¡æ¶å¤ªé¾ä¸è´µï¼iToF éç¨äºâæ²çº¿æå½âçæ¹æ³ï¼å®åå°çæ¯<strong>è¿ç»­çæ­£å¼¦è°å¶åæ³¢</strong>ï¼éè¿æµéåå°æ³¢ä¸åå°æ³¢ä¹é´ç<strong>ç¸ä½å·®ï¼Phase Shiftï¼</strong>æ¥æ¨ç®æ¶é´ã</p>
<ul>
<li><strong>é»è¾ï¼</strong> ç¸ä½åç§»äºå¤å°åº¦ï¼å°±ä»£è¡¨æ¶é´è¿å»äºå¤ä¹ã</li>
<li><strong>ä¼ç¹ï¼</strong> ç¡¬ä»¶ææ¬è¾ä½ï¼åç´ åè¾¨çå¯ä»¥åå¾å¾é«ï¼ç±»ä¼¼ææºæåå¤´ï¼ã</li>
</ul>
<hr>
<h4 id="3-tof-çå·¥ä½æµç¨">3. ToF çå·¥ä½æµç¨</h4>
<ol>
<li><strong>åå°åå (Emitter)ï¼</strong> ååºç»è¿è°å¶ççº¢å¤æ¿åæèå²ã</li>
<li><strong>åå° (Reflection)ï¼</strong> åçº¿è§¦ç¢°ç©ä½è¡¨é¢ååçå¼¥æ£åå°ã</li>
<li><strong>æ¥æ¶åå (Sensor)ï¼</strong> ä¸ä¸ªç¹æ®ç CMOS å¾åä¼ æå¨ææè¿åçåä¿¡å·ã</li>
<li><strong>å¤çåå (Processor)ï¼</strong>
<ul>
<li>å¯¹äº dToFï¼ç»è®¡åå­å°è¾¾çç´æ¹å¾ï¼ç¡®å®å³°å¼æ¶é´ã</li>
<li>å¯¹äº iToFï¼è®¡ç®æ¯ä¸ªåç´ ç¹ççµè·å·®å¼ï¼è½¬æ¢æç¸ä½ï¼åæ¢ç®ææ·±åº¦å¼ã</li>
</ul>
</li>
<li><strong>è¾åºï¼</strong> çæä¸å¼ <strong>æ·±åº¦å¾ï¼Depth Mapï¼</strong>ï¼æ¯ä¸ªåç´ ä»£è¡¨è¯¥ç¹çç©çè·ç¦»ã</li>
</ol>
<hr>
<h4 id="4-tof-vs-ç»æåæä»ä¹åºå«">4. ToF vs. ç»æåï¼æä»ä¹åºå«ï¼</h4>
<table>
<thead>
<tr>
<th style="text-align: left">ç¹æ§</th>
<th style="text-align: left">ToF (é£è¡æ¶é´æ³)</th>
<th style="text-align: left">ç»æå (Structured Light)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><strong>è®¡ç®é</strong></td>
<td style="text-align: left"><strong>æä½</strong>ï¼ç¡¬ä»¶ç´æ¥è¾åºç»æï¼</td>
<td style="text-align: left"><strong>é«</strong>ï¼éè¦å¤æçå¾åå¯¹æ¯åæï¼</td>
</tr>
<tr>
<td style="text-align: left"><strong>å·¥ä½è·ç¦»</strong></td>
<td style="text-align: left"><strong>è¿</strong>ï¼æ¿åé·è¾¾å¯è¾¾æ°ç¾ç±³ï¼</td>
<td style="text-align: left"><strong>ç­</strong>ï¼éå¸¸ 1 ç±³ä»¥åï¼</td>
</tr>
<tr>
<td style="text-align: left"><strong>æå¹²æ°æ§</strong></td>
<td style="text-align: left">è¾å¼ºï¼å°¤å¶ dToF éåå®¤å¤ï¼</td>
<td style="text-align: left">è¾å¼±ï¼å¼ºåä¸å¾æ¡ä¼è¢«æ·¹æ²¡ï¼</td>
</tr>
<tr>
<td style="text-align: left"><strong>åè¾¨ç</strong></td>
<td style="text-align: left">è¾ä½ï¼éå¸¸æ¯ QVGA çº§ï¼</td>
<td style="text-align: left">è¾é«ï¼å¯ä»¥è¾¾å°ç¾ä¸åç´ ï¼</td>
</tr>
<tr>
<td style="text-align: left"><strong>åºç¨åºæ¯</strong></td>
<td style="text-align: left">æ«å°æºå¨äººãèªå¨é©¾é©¶ãAR å»ºæ¨¡</td>
<td style="text-align: left">ææºé¢é¨è§£éãç²¾å¯æ«æãæ´»ä½æ£æµ</td>
</tr>
</tbody>
</table>
<hr>
<h4 id="5-ç®åçç¶é¢ä¸ææ-1">5. ç®åçç¶é¢ä¸ææ</h4>
<ol>
<li><strong>å¤å¾å¹²æ° (Multi-path Interference)ï¼</strong><br>
å¦æåçº¿å¨å¢è§ç»è¿å¤æ¬¡åå°æåå°ä¼ æå¨ï¼ToF ä¼è¯¯ä»¥ä¸ºç©ä½æ¯å®éæ´è¿ï¼äº§çâæ·±åº¦éå½±âã</li>
<li><strong>é£ç¹æåº (Flying Pixels)ï¼</strong><br>
å¨ç©ä½çè¾¹ç¼ï¼ä¸ä¸ªåç´ å¯è½åæ¶æ¥æ¶å°ç©ä½è¡¨é¢åèæ¯å¢çåå°ä¿¡å·ï¼å¯¼è´è¾¹ç¼åºç°ä¸åè«é¡»æçâé£ç¹âã</li>
<li><strong>ç¯å¢åå¹²æ°ï¼</strong><br>
è½ç¶ iToF å¨å®¤åè¡¨ç°ä¼å¼ï¼ä½å¨å¤ªé³åä¸ï¼çº¢å¤ååªå£°å·¨å¤§ï¼ä¼å¯¼è´ç²¾åº¦å¤§å¹ä¸éï¼dToF éè¿ååå­ææ¯ç¼è§£äºè¿ä¸é®é¢ï¼ã</li>
<li><strong>åèé®é¢ï¼</strong><br>
å ä¸ºè¦ä¸æ­å°ä¸»å¨åå°åï¼ToF ä¼ æå¨éå¸¸æ¯æ®éæåå¤´æ´èçµã</li>
</ol>
<hr>
<h4 id="6-åèæç®-2">6. åèæç®</h4>
<ol>
<li><strong>Hansard, M., Lee, S., Choi, O., &amp; Horaud, R. P. (2012).</strong> <em>Time-of-Flight Cameras: Principles, Methods and Applications</em>. Springer Briefs in Computer Science.<br>
(æç³»ç»è®²è§£ ToF åççç»å¸ä¹¦ç±)ã</li>
<li><strong>Li, L. (2014).</strong> <em>Time-of-flight camera â An introduction</em>. Technical report, Texas Instruments.<br>
(TI åå¸çå®æ¹ææ¯æ¥åï¼æ·±å¥è®²è§£äº iToF ççµå­å­¦å®ç°)ã</li>
<li><strong>Horaud, R., et al. (2016).</strong> <em>An overview of gradient-based 3D reconstruction methods for Time-of-Flight RGB-D cameras</em>. Journal of Mathematical Imaging and Vision.<br>
(æ¢è®¨äºå¦ä½ä¼å ToF çæ·±åº¦å¾è´¨é)ã</li>
<li><strong>Bamji, C. S., et al. (2015).</strong> <em>A 0.13Î¼m CMOS System-on-Chip for a 512Ã424 Time-of-Flight Image Sensor with Multi-Frequency Photo-Demodulation</em>. ISSCC.<br>
(Kinect 2.0 èåè¯ççææ¯ç»èè®ºæ)ã</li>
<li><strong>Niclass, C., et al. (2005).</strong> <em>A CMOS single photon avalanche diode array for 3D imaging</em>. IEEE International Solid-State Circuits Conference.<br>
(dToF æ ¸å¿ç»ä»¶ SPAD ä¼ æå¨çå¥ åºæ§ç ç©¶)ã</li>
</ol>
<hr>
<h1 id="4-éç¨åºæ¯">4. éç¨åºæ¯</h1>
<p>3Déå»ºææ¯å·²ç»æ·±å¥å°åè¡åä¸ï¼</p>
<ul>
<li><strong>å·¥ä¸èªå¨åï¼</strong> é«ç²¾åº¦é¶ä»¶çå°ºå¯¸æ£æµãç¼ºé·æ«æãæºå¨äººæåå¼å¯¼ã</li>
<li><strong>èªå¨é©¾é©¶ä¸æºå¨äººï¼</strong> é¿éãç¯å¢å»ºæ¨¡ï¼SLAMï¼ãé«ç²¾å°å¾å¶ä½ã</li>
<li><strong>æåéäº§ä¿æ¤ï¼</strong> å¯¹å¤å»ºç­ç©ãæç©è¿è¡æ°å­åå»ºæ¨¡ï¼å®ç°æ°¸æä¿å­ã</li>
<li><strong>å»çæåï¼</strong> çç§æ«æå»ºæ¨¡ãææ¯å3Dæ¨¡æã</li>
<li><strong>æ°å­å­ªçä¸åå®å®ï¼</strong> å°ç°å®ä¸ççç©ä½å¿«éå»ºæ¨¡å¹¶å¯¼å¥æ¸¸ææèæç©ºé´ã</li>
<li><strong>çµå­åå¡ï¼</strong> ææºæ«æååå®ç°3Dé¢è§ï¼å¦å®å®¶å®¶å·è¯æï¼ã</li>
</ul>
<hr>
<h1 id="5-ç®åçç¶é¢ä¸é®é¢">5. ç®åçç¶é¢ä¸é®é¢</h1>
<p>å°½ç®¡ææ¯åå±è¿éï¼ä½3Déå»ºä»é¢ä¸´ä»¥ä¸ä¸¥å³»ææï¼</p>
<ol>
<li><strong>å¼±çº¹çä¸éå¤çº¹çï¼</strong><br>
é¢å¯¹æ´ç½çå¢å£ãçº¯è²æ¡é¢æç»çè¡¨é¢ï¼ç®æ³å¾é¾æ¾å°å¯é çç¹å¾å¹éç¹ï¼å¯¼è´éå»ºå¤±è´¥æåºç°âç ´æ´âã</li>
<li><strong>ååä¸éæç©ä½ï¼</strong><br>
éå±è¡¨é¢çé«ååç»ççæå°ä¼è¯¯å¯¼ç¸æºï¼ä½¿ç®æ³è®¡ç®åºéè¯¯çæ·±åº¦ã</li>
<li><strong>è®¡ç®å¤æåº¦ä¸å®æ¶æ§ï¼</strong><br>
é«ç²¾åº¦çç¨ å¯éå»ºéè¦å·¨å¤§çç®åï¼å¨ç§»å¨è®¾å¤æåµå¥å¼å¹³å°ä¸é¾ä»¥å®ç°è¶é«ç²¾åº¦çå®æ¶éå»ºã</li>
<li><strong>é®æ¡é®é¢ï¼</strong><br>
å½ç©ä½çä¸é¨åè¢«æ¡ä½æ¶ï¼ç®æ³éè¦éè¿åéªç¥è¯ï¼AIçæ³ï¼æ¥è¡¥å¨ï¼è¿å¾å¾ä¼å¯¼è´ç²¾åº¦ä¸éã</li>
<li><strong>åç§æææ§ï¼</strong><br>
è¿å¼ºæè¿æçåçº¿é½ä¼ä¸¥éå½±åè¢«å¨è§è§æ¹æ³çç¹å¾æåè´¨éã</li>
</ol>
<hr>
<h1 id="æ»ç»">æ»ç»</h1>
<p>éè¿æºå¨è§è§å®ç°3Déå»ºæ¯è®¡ç®æºè§è§é¢åçâå£æ¯âä¹ä¸ãä»ç»å¸çä¸è§å ä½å°ç°ä»£çæ·±åº¦å­¦ä¹ ï¼NeRF/3DGSï¼ï¼æä»¬æ­£å¤äºä»âæåºå¥½ççç§çâåâæå»ºå®ç¾çæ°å­ä¸çâè·¨è¶çæ¶ä»£ãéçç®åçæååç®æ³çä¼åï¼æªæ¥ç3Déå»ºå°åå¾åæç§ä¸æ ·ç®åä¸ç²¾åã</p>
<hr>
<h1 id="åèæç®">åèæç®</h1>
<p>ä¸ºäºä¿è¯ä¿¡æ¯ççå®æ§ä¸å­¦æ¯ä¸¥è°¨æ§ï¼ä»¥ä¸æ¯æ¬åå®¢åèçæ ¸å¿æç®ä¸ç»å¸ææï¼</p>
<ol>
<li><strong>Hartley, R., &amp; Zisserman, A. (2004).</strong> <em>Multiple View Geometry in Computer Vision</em>. Cambridge University Press.<br>
(è®¡ç®æºè§è§é¢åçå£ç»ï¼è¯¦ç»è®²è§£äºå¤è§å¾å ä½åç¸æºæ¨¡å)ã</li>
<li><strong>Mildenhall, B., et al. (2020).</strong> <em>NeRF: Representing Scenes as Neural Radiance Fields for View Synthesis</em>. ECCV.<br>
(ç¥ç»è¾å°åºå¥ åºä¹ä½)ã</li>
<li><strong>Kerbl, B., et al. (2023).</strong> <em>3D Gaussian Splatting for Real-Time Radiance Field Rendering</em>. ACM Transactions on Graphics.<br>
(å½åæåæ²¿çå®æ¶3Déå»ºç®æ³)ã</li>
<li><strong>Schonberger, J. L., &amp; Frahm, J. M. (2016).</strong> <em>Structure-from-Motion Revisited</em>. CVPR.<br>
(COLMAPç®æ³ççè®ºåºç¡)ã</li>
<li><strong>Newcombe, R. A., et al. (2011).</strong> <em>KinectFusion: Real-time 3D reconstruction and interaction using a moving depth camera</em>. ISMAR.<br>
(ç»æåä¸ToFå®æ¶éå»ºçç»å¸æç®)ã</li>
</ol>
<hr>
<p><strong>ä½èæç¤ºï¼</strong> å¦æä½ å¯¹å·ä½çæä¸ªç®æ³ï¼å¦å¦ä½éç½®COLMAPæå¦ä½è®­ç»NeRFï¼æå´è¶£ï¼æ¬¢è¿å¨è¯è®ºåºçè¨ï¼æå°å¨ä¸ä¸æè¯¦ç»è®²è§£ï¼</p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-06 09:04">2026-02-06 09:04</span>&nbsp;
<a href="https://www.cnblogs.com/ChenAI-TGF">TTGF</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19582574);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19582574', targetLink: 'https://www.cnblogs.com/ChenAI-TGF/p/19582574', title: 'æ¦å¿µè§£æï¼æºå¨è§è§å¦ä½èµäºæºå¨âä¸ç»´åç¼âââ3Déå»ºææ¯å¨æ¯æå' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å«ååªå âç¹ç¹ç¹âï¼AIæµè¯çå­ç§ä¸åç©æ³ï¼éå¸¦Midsceneè¯¦ç»æç¨ï¼ ]]></title>
    <link>https://www.cnblogs.com/jinjiangongzuoshi/p/19582572</link>
    <guid>ef26de0f1aeafbedabe0632be153891d</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/jinjiangongzuoshi/p/19582572" title="åå¸äº 2026-02-06 09:02">
    <span role="heading" aria-level="2">å«ååªå âç¹ç¹ç¹âï¼AIæµè¯çå­ç§ä¸åç©æ³ï¼éå¸¦Midsceneè¯¦ç»æç¨ï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>é¶åºç¡æ°æï¼æå¤§çå­¦ä¹ éç¢æ¯"ææ§æ"ï¼</p>
<p>ä¸ä¸ç¯ï¼æä»¬ä»¥AIç¼ç¨åå¥ï¼æææå¸¦å¤§å®¶å¦ä½å¨10åéåååºç¬¬ä¸ä¸ªåºç¨ï¼å¹¶ä¸å¦ä½å°å®é¨ç½²å°äºèç½ä¸ã</p>
<p>ä¸éè¦ä½ æä»»ä½ç¼ç¨åºç¡ï¼åªè¦ä½ ä¼æå­ãä¼ä¸ç½ï¼å°±è½è·çåãéè¿ç¬¬ä¸ä¸ªé¡¹ç®ï¼å¸®å©å¤§å®¶å»ºç«<code>Vibe Coding</code> çæç»´æ¹å¼ï¼<strong>å³æ³¨ "è¦åä»ä¹" èä¸æ¯ "æä¹å"</strong>ã</p>
<p>ä»å¤©æ¯çåå°è¯çç¬¬äºç¯ï¼æä»¬æ¥èä¸èAIæµè¯ï¼å¸¦å¤§å®¶æåä¸ä¸AIå¨æµè¯é¢åå¸¦æ¥çé­åã</p>
<p>åæ ·ï¼å¨è¿ç¯æç¨ä¸­ï¼æä»¬ä¸èAIæµè¯çç¸å³çè®ºãæ¦æ¶©é¾æçææ¯ï¼èèAIå¨UIèªå¨åæµè¯çä¸äºæ°ç©æ³ãæè·¯ã</p>
<blockquote>
<p>æ¬æä¸ºè¯è¯»ï¼åæåå¸å°ãçå¸.AIè¿åç¤¾ãæç¨ä¸æ ä¸­ï¼ä¼ææ´å è¯¦ç»çAIæµè¯æç¨ï¼éè¯»ä½éªæ´ä½³~</p>
</blockquote>
<h2 id="1ä¼ ç»uiæµè¯å·¥å·æ¯æä¹åèªå¨åç">1ãä¼ ç»UIæµè¯å·¥å·æ¯æä¹åèªå¨åçï¼</h2>
<p>ä¼ ç» UI èªå¨åæµè¯ï¼æ ¸å¿æ¯<strong>éè¿ä»£ç /èæ¬å¯¹é¡µé¢åç´ å âå®ä½ -&gt; æä½ -&gt; æ­è¨â çç¨åºåæ¨¡æ</strong>ï¼æ¬è´¨æ¯ç¨æºå¨æ¿ä»£äººå·¥çæå·¥ç¹å»ãè¾å¥ãæ ¡éªæä½ï¼å®ç°åå½æµè¯ãéå¤åºæ¯æµè¯çèªå¨åæ§è¡ï¼æ´ä½å´ç» âåç´ å®ä½â è¿ä¸ªæ ¸å¿å±å¼ï¼æ­¥éª¤åºå®ä¸å¯¹é¡µé¢ç¨³å®æ§è¦æ±æé«ã</p>
<p>èä¼ ç» UI èªå¨åæµè¯å·¥å·ï¼å¦ SeleniumãAppiumãPlaywrightãRobot Framework ç­ï¼ï¼æ è®ºå¼æºè¿æ¯åç¨ï¼å®ç°æè·¯åºæ¬ä¸è´ï¼å¤§ä½å¯ä»¥åä¸ºå æ­¥ï¼</p>
<h3 id="11-æ­ç¯å¢ä¸å·¥å·éé">1.1 æ­ç¯å¢ä¸å·¥å·éé</h3>
<p>æ ¹æ®è¢«æµåºç¨çç±»åï¼Web ç«¯ / ç§»å¨ç«¯ APP / å°ç¨åºï¼éæ©å¯¹åºå·¥å·ï¼æ¯å¦ï¼</p>
<ul>
<li>Web ç«¯ï¼ä¸è¬é¦éç¨ <code>Selenium/Playwright</code></li>
<li>ç§»å¨ç«¯ç¨ <code>Appium</code>ï¼</li>
<li>ä½ä»£ç å°è£ç¨ <code>Robot Framework</code>ï¼</li>
</ul>
<p>åæ¶æ­å»ºéå¥ç¯å¢ï¼æ¯å¦ Web ç«¯éè¦éç½®æµè§å¨é©±å¨ï¼ChromeDriver/GeckoDriverï¼ãç§»å¨ç«¯éè¦éç½®æ¨¡æå¨/çæº+ADBç¯å¢ï¼åç»å Python/Java/JavaScriptç­å¼åè¯­è¨ï¼æ­å»ºåºç¡çèªå¨åæµè¯æ¡æ¶ã</p>
<h3 id="12-å®ä½é¡µé¢åç´ ">1.2 å®ä½é¡µé¢åç´ </h3>
<p>å·¥å·æ æ³åäººä¸æ · âçâ å°é¡µé¢ä¸çæé®ãè¾å¥æ¡ãä¸ææ¡ï¼åªè½éè¿<strong>é¡µé¢åç´ çå¯ä¸æ è¯</strong>æ¥è¯å«ï¼è¿æ¯ææèªå¨åæä½çåæãæµè¯äººåéè¦éè¿æµè§å¨å¼åèå·¥å·ï¼F12ï¼/APPåç´ æ¢æ¥å·¥å·ï¼UIAutomatorViewerï¼ï¼æååç´ çä¸å±å±æ§ï¼å¸¸ç¨å®ä½æ¹å¼æä¼åçº§æåºï¼</p>
<ul>
<li>
<p>ç²¾åå®ä½ï¼idãnameï¼å¯ä¸å±æ§ï¼ä¼åçº§æé«ï¼æç¨³å®ï¼ï¼</p>
</li>
<li>
<p>éç¨å®ä½ï¼xpathãcss selectorï¼æ¯æè·¯å¾ / å±æ§å¹éï¼ééæ  id/name çåç´ ï¼å¦<code>//input[@placeholder='è¯·è¾å¥è´¦å·']</code>ï¼ï¼</p>
</li>
<li>
<p>ååºå®ä½ï¼class nameãtag nameãlink textï¼æéå¤ï¼ä»ç¨äºæ å¶ä»å±æ§çåºæ¯ï¼ã</p>
</li>
</ul>
<p><strong>æ ¸å¿è¦æ±</strong>ï¼åç´ å¿é¡»æç¨³å®çæ è¯ï¼ä¸æ¦åç´ å±æ§è¢«å¼åä¿®æ¹ï¼å¦ id ä»<code>btn-login</code>æ¹æ<code>btn-login-new</code>ï¼ï¼èæ¬å°±ä¼ âæ¾ä¸å°åç´ âï¼ç´æ¥æ§è¡å¤±è´¥ã</p>
<h3 id="13-å¼åèªå¨åæ§è¡èæ¬">1.3 å¼åèªå¨åæ§è¡èæ¬</h3>
<p>åºäºéå®çè¯­è¨åå·¥å·ï¼ç¼åèæ¬æ¨¡æäººå·¥æä½ï¼æ ¸å¿é»è¾æ¯ <strong>âæä½é¾ + æ ¡éªç¹â</strong>ï¼ä¸»æµæä¸¤ç§å¼åæ¨¡å¼ï¼</p>
<ul>
<li>çº¿æ§èæ¬ï¼ææå·¥æµè¯çæ­¥éª¤ä¾æ¬¡ç¼åï¼å¦ âæå¼æµè§å¨âè¾å¥ç½åâç¹å»è´¦å·è¾å¥æ¡âè¾å¥è´¦å·âç¹å»å¯ç æ¡âè¾å¥å¯ç âç¹å»ç»å½æé®âï¼éåç®åçåæµç¨åºæ¯ï¼</li>
<li>æ¨¡åå/å³é®å­é©±å¨ï¼å°éå¤æä½å°è£æå¬å±æ¨¡åï¼å¦ âç»å½æ¨¡åââéåºæ¨¡åâï¼ï¼ç¨ä¾ç´æ¥è°ç¨æ¨¡åï¼åå°ä»£ç åä½ï¼éåå¤§åé¡¹ç®çæ¹éç¨ä¾å¼åã</li>
</ul>
<p>å¹¶ä¸ï¼å ä¸ºé¡µé¢å è½½ãæ¥å£è¯·æ±ä¼å­å¨å»¶è¿åå¶åæ§ï¼ä¸ºäºç¡®ä¿èæ¬çç¨³å®æ§ï¼èæ¬ä¸­é¤äºä¼åå«<strong>æä½æä»¤</strong>ï¼click/input/clear/selectï¼ç­ï¼å¿é¡»å ç­å¾é¿åå·¥å· âæåæä½â å¯¼è´çå¤±è´¥ââ å®éåéè¦ï¼æ ¹æ®ä¸åçåºæ¯å¼å¥ä¸åçç­å¾æºå¶ï¼å¼ºå¶ç­å¾/æ¾å¼ç­å¾/éå¼ç­å¾ï¼ã</p>
<h3 id="14-æ§è¡æµè¯">1.4 æ§è¡æµè¯</h3>
<p>è¿è¡ç¼åå¥½çèæ¬ï¼å·¥å·ä¼èªå¨é©±å¨æµè§å¨/æ¨¡æå¨ï¼æèæ¬æ­¥éª¤æ§è¡æä½ï¼æ§è¡å°å³é®èç¹æ¶ï¼ä¼éè¿<strong>æ­è¨è¯­å¥</strong>æ ¡éªå®éç»ææ¯å¦ç¬¦åé¢æï¼æ¯å¦ âç»å½åæ¯å¦è·³è½¬å°é¦é¡µââç¹å»æäº¤åæ¯å¦æ¾ç¤ºâæäº¤æåâæç¤ºââåè¡¨æ¯å¦å è½½åºæå®æ°æ®âï¼æ­è¨éè¿åç¨ä¾æåï¼å¤±è´¥åç»æ­¢å¹¶è®°å½éè¯¯ã</p>
<h3 id="15-çææµè¯æ¥åä¸é®é¢ææ¥">1.5 çææµè¯æ¥åä¸é®é¢ææ¥</h3>
<p>æ§è¡å®æåï¼å¯ä»¥æ¯ç±å·¥å·æ¥èªå¨çææ¥åï¼ä¹å¯ä»¥æ¯äººå·¥æ¥æ´çæ¥åã</p>
<p>æµè¯äººåéè¦æ ¹æ®æ¥åæ¥ææ¥é®é¢ï¼å¦åºåæ¯<strong>èæ¬é®é¢</strong>ï¼å®ä½æ¹å¼éè¯¯ï¼ã<strong>é¡µé¢é®é¢</strong>ï¼åç´ å±æ§ä¿®æ¹ï¼è¿æ¯<strong>å·¥å·ç¯å¢é®é¢</strong>ï¼é©±å¨çæ¬ä¸å¼å®¹ï¼ï¼åéå¯¹æ§ä¿®æ¹ã</p>
<h2 id="2-ä¼ ç»uièªå¨åçæ ¸å¿çç¹">2. ä¼ ç»UIèªå¨åçæ ¸å¿çç¹</h2>
<p>æ­£å ä¸ºä¼ ç»UIèªå¨åå·¥å·ï¼ä¸»è¦æ¯ä¾èµ âåºå®åç´ å®ä½â å âæ­»æ¿èæ¬é»è¾âï¼å¯¼è´å¨å¦ä»å¿«ææ·å¼åãé«é¢è¿­ä»£çåºæ¯ä¸­ï¼æ´é²äºè¯¸å¤é¾ä»¥è§£å³çé®é¢ï¼</p>
<ol>
<li>
<p><strong>åç´ å®ä½ä¾èµâç¡¬ç¼ç â</strong>ï¼ä¼ ç»çUIèªå¨åæµè¯å·¥å·ï¼æ¯å¦SeleniumãAppiumãPlaywrightç­ï¼éå¸¸éè¦éè¿IDãClassãXpathç­åºå®çåç´ å±æ§æ¥å®ä½åç´ ï¼ä½åç«¯å¼åå¸¸å éæ±è°æ´ä¿®æ¹DOMç»æï¼æ¯å¦ç»ä»¶åºåçº§ãæ ·å¼ä¼åãå¸å±è°æ´ï¼ï¼å¯¼è´åç´ IDãClassè¿ç±»å±æ§å¯è½ä¼åºç°å¨æååï¼èæ¬ææå ä¸ºè¿äºååï¼å¯¼è´âæ¾ä¸å°åç´ âï¼æ®ç»è®¡ï¼ä¼ä¸çº§é¡¹ç®ä¸­çº¦<code>40%-60%</code>çUIèªå¨åç¨ä¾å¤±è´¥æºäºåç´ å®ä½å¤±æï¼èéçå®åè½ç¼ºé·ã</p>
</li>
<li>
<p><strong>ç»´æ¤ææ¬æé«</strong>ï¼å¼åè¿­ä»£ä¼é¢ç¹ä¿®æ¹é¡µé¢åç´ å±æ§ãè°æ´é¡µé¢å¸å±ï¼æµè¯äººåéè¦åæ­¥ä¿®æ¹ææç¸å³èæ¬çå®ä½æ¹å¼ï¼è¿­ä»£è¶å¿«ï¼ç»´æ¤å·¥ä½éè¶å¤§ï¼çè³åºç° âç»´æ¤èæ¬çæ¶é´è¶è¿å¼åèæ¬çæ¶é´âï¼</p>
</li>
<li>
<p><strong>å¯¹éæ ååç´ æ è½ä¸ºå</strong>ï¼æ æ³è¯å«å¾çãéªè¯ç ãå¨æçæçåç´ ï¼å¦éæº idãå¨æå¼¹çªï¼ï¼éå°è¿ç±»åºæ¯åªè½éè¿äººå·¥ä»å¥æé¢å¤çç ´è§£æ¹æ¡ï¼èªå¨åè¦ççåéï¼</p>
</li>
<li>
<p><strong>å­¦ä¹ é¨æ§ä¸ä½</strong>ï¼éè¦ææ¡å¼åè¯­è¨ï¼Python/Javaï¼ãå·¥å· APIãæ¡æ¶å°è£ï¼éææ¯èæ¯çæµè¯äººåé¾ä»¥ä¸æï¼</p>
</li>
<li>
<p><strong>æ æ³åäººä¸æ · âè®¤ç¥â é¡µé¢</strong>ï¼å·¥å·åªè½è¯å«åç´ å±æ§ï¼æ æ³çè§£é¡µé¢çè¯­ä¹åé»è¾ï¼æ¯å¦ âçº¢è²çæäº¤æé®ââä½äºé¡µé¢åºé¨çåé¡µæ âï¼ä¸æ¦åç´ ä½ç½®ååï¼å³ä½¿å±æ§ä¸åï¼ä¹å¯è½å èæ¬é»è¾é®é¢æ§è¡å¤±è´¥ã</p>
</li>
</ol>
<h2 id="3-aiææ¯å¨uièªå¨åæµè¯çå­ç§ç©æ³">3. AIææ¯å¨UIèªå¨åæµè¯çå­ç§ç©æ³</h2>
<p>éå¯¹ä¸è¿°é®é¢ï¼AI å¨ UI èªå¨åæµè¯ä¸­çåºç¨ï¼å¯ä»¥æå¾å¤ç§ç»åç©æ³ã</p>
<p>æ ¸å¿æ¯éè¿<strong>å¤§è¯­è¨æ¨¡åï¼LLMï¼</strong>ã<strong>è®¡ç®æºè§è§ï¼CVï¼ãèªç¶è¯­è¨å¤çï¼NLPï¼ãæºå¨å­¦ä¹ ï¼MLï¼</strong> ç­ææ¯ï¼è§£å³ä¼ ç»æ¹æ¡ä¸­âåç´ å®ä½é¾ãèæ¬ç»´æ¤ææ¬é«ãè·¨ç«¯å¼å®¹æ§å·®ãäººåä¾èµå¼ºâç­é®é¢ã</p>
<p>æäºAIçèå¥ï¼èªå¨åæµè¯ï¼ä¸åæ¯ä¾èµ âåºå®åç´ å±æ§âï¼èæ¯è®©æµè¯å·¥å·å<strong>äººä¸æ · âçâ é¡µé¢ãâçè§£â é¡µé¢ãâæ¨çâ æä½é»è¾</strong>ã</p>
<p>ä»¥<strong>è®¡ç®æºè§è§ï¼CVï¼</strong>å<strong>èªç¶è¯­è¨å¤çï¼NLPï¼</strong> ä¸ºä»£è¡¨çAIææ¯ä¸ºä¾ï¼å¯ä»¥éè¿âæç¥çé¢åå®¹+çè§£ç¨æ·æå¾âçæ¹å¼ï¼æ¨å¨UIèªå¨åæµè¯ä»âç¡¬ç¼ç è§åé©±å¨âåâè®¤ç¥é©±å¨âè½¬åï¼å¶æ ¸å¿çå¿µå¯æ¦æ¬ä¸ºï¼<strong>è®©æµè¯ç³»ç»åäººç±»ä¸æ ·âçæçé¢ââå¬æéæ±âï¼å¹¶èªä¸»å®ææä½ä¸éªè¯</strong>ã</p>
<h4 id="ç©æ³-1å©ç¨ai-è§è§å®ä½--æ¿ä»£ä¼ ç»åç´ å®ä½">ç©æ³ 1ï¼å©ç¨AI è§è§å®ä½ ââ æ¿ä»£ä¼ ç»åç´ å®ä½</h4>
<p>åºäº<strong>è®¡ç®æºè§è§ï¼CVï¼+ å¾åè¯å«</strong>ææ¯ï¼è®©æµè¯å·¥å·ä¸åä¾èµåç´ ç <code>id/xpath</code> ç­åºå®å±æ§ï¼èæ¯åäººä¸æ ·éè¿ âè§è§ç¹å¾â è¯å«åç´ ï¼æ¯å¦ âé¡µé¢é¡¶é¨çèè²ç»å½æé®ââä¸­é´çç½è²è¾å¥æ¡ï¼å ä½ç¬¦æ¯è¯·è¾å¥ææºå·ââå³ä¸è§ççº¢è²æäº¤æé®âã</p>
<ul>
<li>å®ç°æ¹å¼ï¼æµè¯äººååªéç¨èªç¶è¯­è¨æè¿°åç´ ï¼æç´æ¥å¨é¡µé¢ä¸æ¡éåç´ ï¼ï¼AI ä¼æååç´ çè§è§ç¹å¾ï¼é¢è²ãå½¢ç¶ãä½ç½®ãæå­åå®¹ï¼ï¼çæå¯ä¸çè§è§å®ä½æ è¯ï¼å³ä½¿åç´ å±æ§è¢«ä¿®æ¹ãä½ç½®è¢«è°æ´ï¼åªè¦è§è§ç¹å¾ä¸åï¼å·¥å·å°±è½ç²¾åè¯å«ï¼</li>
<li>ééåºæ¯ï¼é«é¢è¿­ä»£çé¡µé¢ãå¨æçæåç´ çåºæ¯ãæ æ åå±æ§çå°ä¼é¡µé¢ï¼å½»åºè§£å³ä¼ ç»æ¹æ¡ âåç´ å®ä½å¤±æâ çæ ¸å¿çç¹ï¼å¤§å¹éä½èæ¬ç»´æ¤ææ¬ã</li>
</ul>
<h4 id="ç©æ³-2èªç¶è¯­è¨çæèªå¨åç¨ä¾--è®©äººäººé½è½åèªå¨å">ç©æ³ 2ï¼èªç¶è¯­è¨çæèªå¨åç¨ä¾ ââ è®©äººäººé½è½åèªå¨å</h4>
<p>åºäº<strong>å¤§è¯­è¨æ¨¡åï¼LLMï¼</strong>ï¼å®ç° <strong>âèªç¶è¯­è¨æè¿°éæ±âAI èªå¨çæèªå¨åèæ¬ / ç¨ä¾â</strong>ï¼å½»åºéä½èªå¨åçå­¦ä¹ é¨æ§ï¼éææ¯èæ¯çæµè¯äººåãäº§åç»ççè³å¼åï¼é½è½å¿«éå¶ä½èªå¨åç¨ä¾ã</p>
<ul>
<li>å®ç°æ¹å¼ï¼æµè¯äººååªéç¨æ¥å¸¸è¯­è¨æè¿°æµè¯åºæ¯ï¼æ¯å¦ âæå¼ XX ç½ç«ï¼è¾å¥è´¦å· adminãå¯ç  123456ï¼ç¹å»ç»å½ï¼æ ¡éªæ¯å¦è·³è½¬å°é¦é¡µï¼æ¯å¦æ¾ç¤ºç¨æ·å adminâï¼AI ä¼èªå¨è¯å«åºæ¯ä¸­çæä½æ­¥éª¤ãæ ¡éªç¹ï¼ç»åå¯¹åºçæµè¯å·¥å·ï¼Selenium/Playwrightï¼ï¼çæå¯ç´æ¥è¿è¡çèªå¨åèæ¬ï¼è¿è½èªå¨æ·»å ç­å¾æºå¶ãæ­è¨è¯­å¥ï¼</li>
<li>å»¶ä¼¸è½åï¼è¿å¯ä»¥éè¿ âä¸ä¼ æå·¥æµè¯ç¨ä¾ææ¡£âAI æ¹éè§£æçæèªå¨åç¨ä¾âï¼å®ç°ç¨ä¾çæ¹éè½¬åï¼å¤§å¹æåèªå¨åè¦çççè½¬åæçã</li>
</ul>
<h4 id="ç©æ³-3ai-æºè½ç»´æ¤èæ¬--èªå¨åééé¡µé¢åå">ç©æ³ 3ï¼AI æºè½ç»´æ¤èæ¬ ââ èªå¨åééé¡µé¢åå</h4>
<p>è¿æ¯éå¯¹ä¼ ç» âèæ¬ç»´æ¤ææ¬é«â çæ ¸å¿ä¼åï¼åºäº<strong>LLM + è§è§å¯¹æ¯</strong>ææ¯ï¼è®©æµè¯èæ¬å·å¤ âèªæä¿®å¤â è½åï¼é¡µé¢åçååæ¶ï¼AI ä¼èªå¨è¯å«å¹¶ä¿®æ¹èæ¬ï¼æ éäººå·¥ä»å¥ã</p>
<ul>
<li>å®ç°æ¹å¼ 1ï¼èæ¬æ§è¡å¤±è´¥æ¶ï¼AI ä¼èªå¨åæå¤±è´¥åå ï¼å¦ âåç´ å±æ§ä¿®æ¹ââåç´ ä½ç½®ååâï¼ï¼å¯¹æ¯æ°æ§é¡µé¢çåç´ ç¹å¾ï¼èªå¨æ´æ°èæ¬ä¸­çå®ä½æ¹å¼ï¼åéæ°æ§è¡ç¨ä¾ï¼</li>
<li>å®ç°æ¹å¼ 2ï¼å¼åæäº¤ä»£ç åï¼AI ä¼èªå¨å¯¹æ¯è¿­ä»£ååçé¡µé¢å·®å¼ï¼è¯å«åºè¢«ä¿®æ¹çåç´ ï¼æ¹éæ´æ°ææç¸å³çèªå¨åèæ¬ï¼å®ç° âé¡µé¢åï¼èæ¬èªå¨åâã</li>
</ul>
<h4 id="ç©æ³-4ai-é©±å¨çæ¢ç´¢å¼æµè¯--å¨èªå¨è¦çé¡µé¢åºæ¯">ç©æ³ 4ï¼AI é©±å¨çæ¢ç´¢å¼æµè¯ ââ å¨èªå¨è¦çé¡µé¢åºæ¯</h4>
<p>ä¼ ç»èªå¨ååªè½æ§è¡ âé¢è®¾å¥½çèæ¬âï¼è¦ççåºæ¯æéï¼èåºäº<strong>å¤æ¨¡æ AI + å¼ºåå­¦ä¹ </strong>çæ¢ç´¢å¼æµè¯ï¼è®©å·¥å·è½å<strong>èµæ·±æµè¯å·¥ç¨å¸ä¸æ ·ï¼èªä¸»æ¢ç´¢é¡µé¢çææåè½åºæ¯</strong>ï¼èªå¨æ§è¡æä½ãæ ¡éªç»æï¼åç°äººå·¥æµè¯åä¼ ç»èªå¨åå®¹æéæ¼ç BUGã</p>
<ul>
<li>å®ç°æ¹å¼ï¼AI åéè¿è§è§è¯å«åè¯­ä¹çè§£ï¼åæé¡µé¢çææåç´ ï¼æé®ãè¾å¥æ¡ãä¸ææ¡ãé¾æ¥ç­ï¼åä¸å¡é»è¾ï¼çæåççæµè¯è·¯å¾ï¼ç¶åèªä¸»æ§è¡æä½ï¼å¦éæºç¹å»ãè¾å¥ä¸åç±»åçæ°æ®ãè§¦åä¸åçäº¤äºç»åï¼ï¼åæ¶å®æ¶æ ¡éªé¡µé¢çååºç»æï¼å¦æ¯å¦æ¥éãæ¯å¦è·³è½¬å°éè¯¯é¡µé¢ãæ°æ®æ¯å¦æ¾ç¤ºå¼å¸¸ï¼ï¼åç°é®é¢åèªå¨æªå¾ãè®°å½æ¥å¿å¹¶æ è®° BUG ç­çº§ï¼</li>
<li>æ ¸å¿ä»·å¼ï¼éåå¨æ°çæ¬ä¸çº¿åï¼å¿«éåå¨éåºæ¯çæ¢ç´¢å¼æµè¯ï¼è¦çäººå·¥é¾ä»¥èèå°çè¾¹çåºæ¯ãç»ååºæ¯ï¼æåæµè¯çå®æ´æ§ã</li>
</ul>
<h4 id="ç©æ³-5ai-çææµè¯æ°æ®--èªå¨åééåºæ¯é æ°æ®">ç©æ³ 5ï¼AI çææµè¯æ°æ® ââ èªå¨åééåºæ¯é æ°æ®</h4>
<p>ä¼ ç»èªå¨åæµè¯ä¸­ï¼æµè¯æ°æ®ï¼å¦è´¦å·ãææºå·ãèº«ä»½è¯å·ãè®¢åå·ï¼éè¦äººå·¥åå¤æéè¿ä»£ç çæï¼è AI è½æ ¹æ®æµè¯åºæ¯ï¼<strong>æºè½çæè´´åä¸å¡ççå®æµè¯æ°æ®</strong>ï¼è¿è½èªå¨ééè¾¹çå¼ãå¼å¸¸å¼åºæ¯ã</p>
<ul>
<li>å®ç°æ¹å¼ï¼æµè¯äººååªéæè¿°æ°æ®éæ±ï¼æ¯å¦ âçæ 10 ä¸ªææçææºå·ââçæ 5 ä¸ªä¸ç¬¦åæ ¼å¼çèº«ä»½è¯å·ââçæ 3 ä¸ªç¬¦åçµåå¹³å°è§åçè®¢åå·ï¼åå«å­æ¯åæ°å­âï¼AI ä¼èªå¨çæå¯¹åºçæµè¯æ°æ®ï¼è¿è½ç´æ¥å°æ°æ®æ³¨å¥å°èªå¨åèæ¬ä¸­ï¼å®ç° âæ°æ® + èæ¬â çä¸ä½åæ§è¡ã</li>
</ul>
<h4 id="ç©æ³-6å¤æ¨¡æ-ai-æµè¯--è¦çè·¨ç«¯--éæ å-ui-åºæ¯">ç©æ³ 6ï¼å¤æ¨¡æ AI æµè¯ ââ è¦çè·¨ç«¯ / éæ å UI åºæ¯</h4>
<p>ä¼ ç»å·¥å·å¯¹<strong>å¾çãè§é¢ãå°ç¨åºãH5 æ··åé¡µé¢</strong>ç­éæ å UI åºæ¯çè¦ççæä½ï¼èåºäº<strong>å¤æ¨¡æå¤§æ¨¡å</strong>ç AI æµè¯ï¼è½èå âè§è§ãææ¬ãè¯­é³â ç­å¤ç§ä¿¡æ¯ï¼å®ç°è·¨ç«¯ãéæ å UI åºæ¯çèªå¨åæµè¯ã</p>
<ul>
<li>ééåºæ¯ï¼è¯å«é¡µé¢ä¸­çå¾çéªè¯ç å¹¶èªå¨ç ´è§£ãæµè¯å°ç¨åºä¸­çå¾ææ··åæ¨¡åãæµè¯ APP ä¸­çè¯­é³äº¤äºåè½ãæµè¯çµåå¹³å°çååå¾çå±ç¤ºåç¹å»åè½ç­ï¼å½»åºæç ´ä¼ ç» UI èªå¨åçåºæ¯è¦çéå¶ã</li>
</ul>
<p>é¤äºä¸è¿°æå°çå­ç§AIç©æ³å¤ï¼å¶å®è¿æå¾å¤ï¼è¿éå°±ä¸ä¸ä¸åä¸¾äºï¼åé¢å°ä¼å¨ã<strong>çå¸. AIè¿åç¤¾</strong>ãä¸­ï¼éæ­¥åäº«ã</p>
<h2 id="4-aiæµè¯å·¥å·">4. AIæµè¯å·¥å·</h2>
<p>è®²å°è¿éï¼ä½ å¯è½ä¼è¯´ï¼ä¸é¢è¿äºAIæµè¯çç©æ³æ¯ä¸æ¯é½è¿æ¯åçå¨çè®ºå±é¢ï¼å±äºçæ³æµè¯çç¶æå§ï¼ä½ç°å®æ¯ï¼ä½ æè®¸è¿åçå¨âäºâéï¼äºå®æ¯ï¼å·²ç»æå¾å¤åè¾ï¼å©ç¨ä¸é¢çè¿äºAIç©æ³ï¼å·²ç»å¨2åã10åãæåå·¥ä½æè½äºã</p>
<p>è¦å®ç°ä¸è¿°çè¿äºç©æ³ï¼æä¸¤ç§æ¹å¼ï¼</p>
<ul>
<li>èªå·±å©ç¨AIææ¯ï¼èªå·±å¼åï¼èªå·±å®å¶ãï¼çµæ´»åº¦é«ï¼å¯¹ææ¯è¦æ±ä¹é«ï¼</li>
<li>ç¨ç°æçAIæµè¯å·¥å·ãï¼ç¼ºç¹æä»ä¹ï¼ç¨ä»ä¹ï¼ä¼ç¹æ¯å¿«ï¼å¼ç®±å³ç¨ï¼</li>
</ul>
<p>ç®åï¼å¸é¢ä¸çAIæµè¯å·¥å·æå¾å¤ï¼å¨æä¹åå¬ä¼å·ææ¯æ¨æåäº«ä¸­ï¼ä¹ç»å¤§å®¶æ¨èè¿ä¸äºï¼æ¯å¦<code>Testim</code>ã<code>Applitools</code>ã<code>Browser Use</code>ã<code>Midscene</code>ã<code>Playwright MCP</code>ç­ã</p>
<p>å¦ææ¯ä½ æ¯AIé¶åºç¡æ°æï¼æ­¤åï¼ä»æ¥æ²¡ææ¥è§¦è¿AIæµè¯å·¥å·ï¼é£æå¼ºçä½ åä½¿ç¨<code>Midscene</code>ã</p>
<p><code>Midscene</code>ä½ä¸ºAIæµè¯å·¥å·ä¸­çå¸åä»£è¡¨ï¼å®æ´æ¥è¿çå®ç¨æ·æä½è§è§ï¼å¯¹è§è§ååéåºæ§å¼ºï¼åå°äºå¯¹DOMçç»å¯¹ä¾èµï¼ç¸æ¯æäºAIæµè¯å·¥å·æ¥è¯´ï¼å®å¨å®ä½å¨æåç´ æ¶æ´ç¨³å®ï¼å°¤å¶å¨æ¡¥æ¥æ¨¡å¼ä¸ï¼è¿è½å¤ç¨æµè§å¨Cookieï¼é¿åéå¤ç»å½çé®é¢ã</p>
<p>æ¥ä¸æ¥ï¼æå°±ä»¥<code>Midscene</code> ä¸ºä¾ï¼æ¥å¸¦å¤§å®¶æåä¸ä¸Midscen`åUIèªå¨åæµè¯çé­åï¼ä¸éè¦ä½ åä¸è¡ä»£ç ï¼ä¸éè¦ä½ å®ä½åç´ ï¼ä½ åªéè¦æè¿°éæ±ï¼ææ¿ææ¿ï¼ä»»ä½äººé½å¯ä»¥ç¨å®æ¥å¼å±èªå¨åæµè¯ã</p>
<blockquote>
<p>å¶å®çAIæµè¯å·¥å·ï¼åç»­ä¼éæ­¥åäº«å°<strong>çå¸.AI è¿åç¤¾</strong>-&gt;<strong>AIå·¥å·ç¾å®ç®±</strong>å¯¹åºççåä¸­ã</p>
</blockquote>
<h2 id="5-å¸¦ä½ å¿«éä½éª-midscens">5. å¸¦ä½ å¿«éä½éª Midscens</h2>
<p>ç±äºæ¬ç¯æç¨ï¼å¹¶ä¸æ¯ä¸é¨è®²è§£<code>Midscens</code>çç¹æ§ï¼ä¸»è¦æ¯è®©å¤§å®¶æåæåä¸ä¸AIæµè¯æå¸¦æ¥çå®éææã</p>
<p>æä»¥ä¸ä¼ï¼è±å¤ªå¤åå®¹ç¯ç¬¦æ¥ä»ç»<code>Midscens</code>ç¹æ§ï¼å·ä½å³äº<code>Midscens</code>çå·¥å·ä»ç»ï¼åç»­å¨<strong>AIè¿åç¤¾</strong>ä¸­ï¼ä¼æä¸é¨å·¥å·æç¨åäº«ã</p>
<p>ä¸ºäºç§é¡¾æ°æï¼è¿æ¯ç®åç§æ®ä¸ä¸ï¼</p>
<blockquote>
<p>Midscensï¼æ´å·ä½ä¸ç¹çå«æ³ï¼æ¯<code>Midscene.js</code>ï¼ç±å­èè·³å¨çWeb Infraå¢éå¼åï¼ä¸ä¸ªè´è´£å­èåé¨Webåºç¡è®¾æ½æè½æåçå¢éï¼ã</p>
<p>å®ä½ï¼æ¯ä¸æ¬¾ AIé©±å¨çèªå¨åæµè¯å·¥å·ï¼ä¸æ¯å¼æºçã</p>
<p>å®éè¿å¤æ¨¡æå¤§è¯­è¨æ¨¡åï¼LLMï¼å®ç°å¯¹ç¨æ·çé¢çâçè§£âï¼å¹¶èªå¨æ§è¡ç«¯å°ç«¯ï¼e2eï¼æµè¯ä»»å¡ï¼æ ¸å¿ç¹ç¹æ¯è½å¤ç´æ¥è§£æ UI åç´ çè§è§åè¯­ä¹ä¿¡æ¯ï¼æ¨¡æç¨æ·æä½è¡ä¸ºã</p>
</blockquote>
<p><strong>ç®åæ¥è¯´</strong>ï¼<code>Midscene.js</code> æ¯ä¸ä¸ªè®©ä½¿ç¨èï¼ç´æ¥ç¨èªç¶è¯­è¨çæ¹å¼æè¿° UI æä½ï¼ç± AIå¸®ä½ èªå¨å®ä½åç´ ãçæèæ¬ãæ§è¡æµè¯âçæºè½ UI èªå¨åå·¥å·ãäººæéæ±ï¼AIå¸®ä½ èªå¨æ§è¡æµè¯ï¼æ¬è´¨ä¸åAI ç¼ç¨çææ³æ¯ä¸æ ·çã</p>
<p><img src="https://image.kjdaohang.com/PicGo/20260131214243942.png" alt="" loading="lazy"></p>
<p>æ´è¿ä¸æ­¥çä»ç»ï¼æå´è¶£çè¯ï¼å¯ä»¥è®¿é®å®ç<a href="https://midscenejs.com/zh/" target="_blank" rel="noopener nofollow">å®ç½</a>æ¥å­¦ä¹ ï¼<code>https://midscenejs.com/</code></p>
<ul>
<li>å¸®å©ææ¡£ï¼<a href="https://midscenejs.com/zh/introduction" target="_blank" rel="noopener nofollow">https://midscenejs.com/zh/introduction</a></li>
<li>æºç å°åï¼<a href="https://github.com/web-infra-dev/midscene" target="_blank" rel="noopener nofollow">https://github.com/web-infra-dev/midscene</a></li>
</ul>
<p>è¿éï¼å¼å¾åæä¸ç¹çæ¯ï¼<code>Midscene.js</code>è½æåæ¯ä¸ºWebèªå¨åæµè¯èè®¾è®¡çï¼ä½å®ä¹åæ ·æ¯æAndroidãiOSç­å¤ç«¯åºç¨ï¼ä»»æçé¢é½å¯ä»¥ã</p>
<p><img src="https://image.kjdaohang.com/PicGo/20260131214515527.png" alt="" loading="lazy"></p>
<p>è¯´äºï¼è¿ä¹å¤ï¼æ°æè¯¥å¦ä½ä½¿ç¨å¢ï¼æ¦æ¬èµ·æ¥ï¼åå æ­¥ï¼</p>
<h3 id="51-ç¯å¢åå¤">5.1 ç¯å¢åå¤</h3>
<p><code>Midscene.js</code>ï¼æä¾äºå¤ç§éæä½¿ç¨æ¹å¼ï¼</p>
<ul>
<li>æµè§å¨æä»¶</li>
<li>ä¸ PlaywrightçSDKéæï¼ååä¸ºä¸¤ç§ï¼ä¸ç§ç´æ¥ç¨èæ¬æ¹å¼éæåè°ç¨<code>Midscene Agent</code>ï¼å¦å¤ä¸ç§å¨ <code>Playwright</code> çæµè¯ç¨ä¾ä¸­éæ<code>Midscene</code>æ¨¡åï¼</li>
<li>ä¸PuppeteerçSDKéæ (ä¹æä¸¤ç§éææ¹å¼ï¼å¯åèPlaywrightï¼åä¸)</li>
<li>å½ä»¤è¡è°ç¨</li>
<li>APIè°ç¨</li>
</ul>
<p>éè¦æ³¨æï¼ä¸åç«¯ï¼éè¦åå¤çç¯å¢ä¼ææä¸ä¸æ ·ï¼æ°æä¼åæ¨èä»¥<strong>Webç«¯+æµè§å¨æä»¶</strong>ä½¿ç¨æ¹å¼ä¸ºä¸»ï¼éè¿ä½¿ç¨<code>Midscene.js Chrome</code>æä»¶ï¼ä½ å¯ä»¥å¿«éå¨ä»»æç½é¡µä¸ä½éª <code>Midscene</code> çä¸»è¦åè½ï¼èæ éç¼åä»»ä½ä»£ç ã</p>
<p>å¶å®çéææ¹å¼ï¼ä»¥å<code>Android</code>ã<code>iOS</code>ç«¯å¦ä½ä½¿ç¨<code>Midscene</code>ï¼åé¢ä¼æ ¹æ®MVPè¿­ä»£çå®æï¼éæ­¥å¨<code>AI å·¥å·ç¾å®ç®±</code>çååæ´æ°ï¼å¤§å®¶æå´è¶£çè¯ï¼ä¹å¯ä»¥æåæ¥ç<a href="https://midscenejs.com/zh/android-introduction.html" target="_blank" rel="noopener nofollow">å®æ¹å¸®å©ææ¡£</a>ï¼å®æ¹ææ¡£éä¹æä¾äºå¾å¤å®ææ¡ä¾ã</p>
<h3 id="52-å®è£æ¹æ³">5.2 å®è£æ¹æ³</h3>
<p>å¦ææ³éè¿ <code>Midscene.js Chrome</code> æä»¶å¿«éä½éªAIæµè¯çè¯ï¼æä»¬éè¦ååå¾ Chrome æ©å±ååºå®è£ <code>Midscene æ©å±</code></p>
<p><img src="https://image.kjdaohang.com/PicGo/20260201124737578.png" alt="" loading="lazy"></p>
<p>æèç´æ¥å¨<code>github</code>ä¸­ä¸è½½releaeseåç¼©åï¼ç´æ¥æå°chromeæµè§å¨æ©å±ç¨åºé¡µä¸­ï¼å³å¯å®è£</p>
<pre><code>https://github.com/web-infra-dev/midscene/releases
</code></pre>
<p><img src="https://image.kjdaohang.com/PicGo/20260201101301468.png" alt="" loading="lazy"></p>
<p>æä»¶å®è£å®æåï¼å¯å¨æ©å±ï¼å¯è½é»è®¤æå å¨ Chrome æ©å±åè¡¨ä¸­ï¼ï¼ä½ åºè¯¥è½å¨æµè§å¨å³ä¾§çå°åä¸º âMidsceneâ çä¾§è¾¹æ ã</p>
<p><img src="https://image.kjdaohang.com/PicGo/20260201125014786.png" alt="" loading="lazy"></p>
<h3 id="53-aiæ¨¡åéæ©">5.3 AIæ¨¡åéæ©</h3>
<p>å®è£å®<code>Midscene</code>æä»¶ä¹åï¼ä½ è¿æ æ³ç«å³æ­£å¸¸ä½¿ç¨å®æ¥å¼å±èªå¨åæµè¯ï¼å ä¸ºä½ æ­¤æ¶åªæ¯å®è£äºä¸ä¸ªèº¯å£³ï¼è¿æ²¡æææ¥å¤§èï¼èè¿ä¸ªå¤§èï¼å°±æ¯æä»¬å¸¸è¯´ç<strong>å¤§æ¨¡å</strong>ã</p>
<p>è®²å°è¿éï¼å°±ä¸å¾ä¸æä¸å¥ AI å·¥å·çæ ¸å¿æ¬è´¨ï¼<strong>å ä¹ææç AI æµè¯å·¥å·ï¼ä¹è³åç±» AI ç¼ç¨å·¥å·ï¼æ¬è´¨ä¸é½åªæ¯åäºä¸å±é¢åç¨æ·çäº¤äºåºç¨å±å°è£</strong>ï¼å¶æ ¸å¿è½åçå®ç°ï¼åºå±ç»ç©¶éè¦ä¾æç¹å®çå¤§æ¨¡åæ¥é©±å¨ãèä¸æ¬¾ AI æµè¯å·¥å·çå®éä½¿ç¨ææå¥½åï¼ä¹æ­£ä¸å®èåéç¨çå¤§æ¨¡åè½åå¼ºå¼±ãééæ§é«ä½æ¯æ¯ç¸å³ã</p>
<p>èä½¿ç¨ AI å¤§æ¨¡åé©±å¨ UI èªå¨åçæä¸¤ä¸ªå³é®ç¹ï¼è§ååççæä½è·¯å¾ï¼ä»¥ååç¡®æ¾å°éè¦äº¤äºçåç´ ãå¶ä¸­âåç´ å®ä½âè½åçå¼ºå¼±ï¼ä¼ç´æ¥å½±åå°èªå¨åä»»å¡çæåçã</p>
<p>ä¸ºäºå®æåç´ å®ä½å·¥ä½ï¼UI èªå¨åæ¡æ¶ä¸è¬æä¸¤ç§ææ¯è·¯çº¿ï¼</p>
<ul>
<li>åºäº DOM + æªå¾æ æ³¨ï¼æåæåé¡µé¢ç DOM ç»æï¼ç»åæªå¾åå¥½æ æ³¨ï¼è¯·æ¨¡åâæéâå¶ä¸­çåå®¹ã</li>
<li>çº¯è§è§ï¼å©ç¨æ¨¡åçè§è§å®ä½è½åï¼åºäºæªå¾å®æææåæå·¥ä½ï¼å³æ¨¡åæ¶å°çåªæå¾çï¼æ²¡æ DOMï¼ä¹æ²¡ææ æ³¨ä¿¡æ¯ã</li>
</ul>
<h4 id="1-midscene-æ¯æçº¯è§è§åç´ å®ä½">1. Midscene æ¯æçº¯è§è§åç´ å®ä½</h4>
<p><code>Midscene</code> æ©æåæ¶å¼å®¹ãDOM å®ä½ãåãçº¯è§è§ãä¸¤ç§ææ¯è·¯çº¿ã</p>
<p>ä½DOM å®ä½æ¹æ¡çç¨³å®æ§ä¸è¶³ï¼ç»å¸¸ä¼å¨ Canvas åç´ ãCSS background-image ç»å¶çæ§ä»¶ãè·¨å iframe ä¸­çåå®¹ãæ²¡æååè¢«è¾å©ææ¯æ æ³¨çåç´ ç­æåµä¸åºç°å®ä½åå·®ã</p>
<p>ä¸æ­¤åæ¶ï¼éç¨ãçº¯è§è§ãæ¹æ¡ï¼ç¸å¯¹äºDOMå®ä½æ¹æ¡æ¥è¯´ï¼ä¼å¿ææ¾ï¼ä¸»è¦ä½ç°å¨ï¼</p>
<ul>
<li><strong>ææç¨³å®</strong>ï¼å¨ UI æä½è§åãç»ä»¶å®ä½ãçé¢çè§£ç­é¢åçç»¼åè¡¨ç°è¾å¥½ï¼è½å¤å¸®å©ä½¿ç¨èæ´å¿«ä¸æã</li>
<li><strong>éç¨äºä»»æç³»ç»</strong>ï¼èªå¨åæ¡æ¶ä¸åä¾èµ UI æ¸²æçææ¯æ ãæ è®ºæ¯ AndroidãiOSãæ¡é¢åºç¨ï¼è¿æ¯æµè§å¨ä¸­ç canvas æ ç­¾ï¼åªè¦è½è·åæªå¾ï¼Midscene å³å¯å®æäº¤äºæä½ã</li>
<li><strong>æäºç¼å</strong>ï¼æå¼åç±» selector å DOM ä¹åï¼ä½¿ç¨èä¸æ¨¡åçâç£¨åâä¼åå¾æ´ç®åï¼ä¸çææ¸²æææ¯çæ°äººä¹è½å¾å¿«ä¸æã</li>
<li><strong>token éæ¾èä¸é</strong>ï¼ç¸è¾äº DOM æ¹æ¡ï¼è§è§æ¹æ¡ç token ä½¿ç¨éæå¤å¯ä»¥åå° 80%ï¼ææ¬æ´ä½ï¼ä¸æ¬å°è¿è¡éåº¦ä¹åå¾æ´å¿«ã</li>
</ul>
<p>å æ­¤ï¼<strong>ä» 1.0 çæ¬å¼å§ï¼Midscene åªæ¯æçº¯è§è§æ¹æ¡</strong>ï¼å¨UIæä½ä¸åç´ å®ä½æ¹é¢ï¼ä¸åæä¾âæå DOMâçå¼å®¹æ¨¡å¼ã</p>
<h4 id="2-midsceneæ¨èä½¿ç¨çè§è§æ¨¡å">2. Midsceneæ¨èä½¿ç¨çè§è§æ¨¡å</h4>
<p>ä½¿ç¨<code>Midscene</code>ï¼éæ©æ¨¡åæ¶ï¼ä¹æ¯æè®²ç©¶çï¼å¹¶ä¸æ¯éä¾¿æ¾ä¸ªå¤§æ¨¡åé½å¯ä»¥ç¨ï¼å¿é¡»ä½¿ç¨å¤æ¨¡åæ¨¡åï¼ä¹å°±æ¯éè¦æ¯æå¾åè¾å¥ï¼è§è§è½åçæ¨¡åæå¯ä»¥ã</p>
<p>å®æ¹ï¼æ¨èä½¿ç¨ <code>Midscene</code> çé»è®¤æ¨¡åæï¼</p>
<ul>
<li><a href="https://midscenejs.com/zh/model-common-config.html#doubao-seed-model" target="_blank" rel="noopener nofollow">è±å Seed æ¨¡å</a></li>
<li><a href="https://midscenejs.com/zh/model-common-config.html#qwen3-vl" target="_blank" rel="noopener nofollow">åé® Qwen3-VL</a></li>
<li><a href="https://midscenejs.com/zh/model-common-config.html#qwen25-vl" target="_blank" rel="noopener nofollow">åé® Qwen2.5-VL</a></li>
<li><a href="https://midscenejs.com/zh/model-common-config.html#glm-v" target="_blank" rel="noopener nofollow">æºè°± GLM-V</a></li>
<li><a href="https://midscenejs.com/zh/model-common-config.html#auto-glm" target="_blank" rel="noopener nofollow">æºè°± AutoGLM</a></li>
<li><a href="https://midscenejs.com/zh/model-common-config.html#gemini-3-pro" target="_blank" rel="noopener nofollow">Gemini-3-Pro / Gemini-3-Flash</a></li>
<li><a href="https://midscenejs.com/zh/model-common-config.html#ui-tars" target="_blank" rel="noopener nofollow">UI-TARS</a></li>
</ul>
<p>è¿äºæ¨¡åé½å·å¤è¯å¥½çâåç´ å®ä½âè½åï¼ä¸å¨ä»»å¡è§åãçé¢çè§£ç­åºæ¯ä¸ä¹æä¸éçè¡¨ç°ãå¦æä½ ä¸ç¥éä»åªéå¼å§ï¼éç¨ä½ ç¼ä¸æå®¹æè·å¾çæ¨¡åå³å¯ã</p>
<table>
<thead>
<tr>
<th style="text-align: left">æ¨¡åç³»å</th>
<th style="text-align: left">é¨ç½²</th>
<th style="text-align: left">Midscene è¯ä»·</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">è±å Seed æ¨¡å <br><a href="https://midscenejs.com/zh/model-common-config.html#doubao-seed-model" target="_blank" rel="noopener nofollow">å¿«ééç½®</a></td>
<td style="text-align: left">ç«å±±å¼æçæ¬ï¼ <a href="https://www.volcengine.com/docs/82379/1799865" target="_blank" rel="noopener nofollow">Doubao-Seed-1.6-Vision</a></td>
<td style="text-align: left">â­â­â­â­                         UI æä½è§åãå®ä½è½åè¾å¼º éåº¦ç¥æ¢</td>
</tr>
<tr>
<td style="text-align: left">åé® Qwen3-VL<br> <a href="https://midscenejs.com/zh/model-common-config.html#qwen3-vl" target="_blank" rel="noopener nofollow">å¿«ééç½®</a></td>
<td style="text-align: left"><a href="https://help.aliyun.com/zh/model-studio/vision" target="_blank" rel="noopener nofollow">é¿éäº</a> <a href="https://openrouter.ai/qwen" target="_blank" rel="noopener nofollow">OpenRouter</a> <a href="https://ollama.com/library/qwen3-vl" target="_blank" rel="noopener nofollow">Ollama(å¼æº)</a></td>
<td style="text-align: left">â­â­â­â­ <br>å¤æåºæ¯æ­è¨è½åä¸å¤ç¨³å® æ§è½è¶ç¾¤ï¼æä½åç¡® æå¼æºçæ¬ï¼<a href="https://huggingface.co/Qwen" target="_blank" rel="noopener nofollow">HuggingFace</a> / <a href="https://github.com/QwenLM/" target="_blank" rel="noopener nofollow">Github</a>ï¼</td>
</tr>
<tr>
<td style="text-align: left">åé® Qwen2.5-VL <br><a href="https://midscenejs.com/zh/model-common-config.html#qwen25-vl" target="_blank" rel="noopener nofollow">å¿«ééç½®</a></td>
<td style="text-align: left"><a href="https://help.aliyun.com/zh/model-studio/vision" target="_blank" rel="noopener nofollow">é¿éäº</a> <a href="https://openrouter.ai/qwen" target="_blank" rel="noopener nofollow">OpenRouter</a></td>
<td style="text-align: left">â­â­â­ <br>ç»¼åææä¸å¦ Qwen3-VL</td>
</tr>
<tr>
<td style="text-align: left">æºè°± GLM-4.6V <br><a href="https://midscenejs.com/zh/model-common-config.html#glm-v" target="_blank" rel="noopener nofollow">å¿«ééç½®</a></td>
<td style="text-align: left"><a href="https://docs.z.ai/guides/vlm/glm-4.6v" target="_blank" rel="noopener nofollow">Z.AI (Global)</a> <a href="https://docs.bigmodel.cn/cn/guide/models/vlm/glm-4.6v" target="_blank" rel="noopener nofollow">BigModel (CN)</a></td>
<td style="text-align: left">å¨æ°æ¥å¥ï¼æ¬¢è¿ä½éª æ¨¡åæéå¼æº<a href="https://huggingface.co/zai-org/GLM-4.6V" target="_blank" rel="noopener nofollow">HuggingFace</a></td>
</tr>
<tr>
<td style="text-align: left">Gemini-3-Pro / Gemini-3-Flash <br><a href="https://midscenejs.com/zh/model-common-config.html#gemini-3-pro" target="_blank" rel="noopener nofollow">å¿«ééç½®</a></td>
<td style="text-align: left"><a href="https://ai.google.dev/gemini-api/docs/models/gemini" target="_blank" rel="noopener nofollow">Google Cloud</a></td>
<td style="text-align: left">â­â­â­ <br>æ¯æ Gemini-3-Flash ä»·æ ¼é«äºè±åååé®</td>
</tr>
<tr>
<td style="text-align: left">UI-TARS<br> <a href="https://midscenejs.com/zh/model-common-config.html#ui-tars" target="_blank" rel="noopener nofollow">å¿«ééç½®</a></td>
<td style="text-align: left"><a href="https://www.volcengine.com/docs/82379/1536429" target="_blank" rel="noopener nofollow">ç«å±±å¼æ</a></td>
<td style="text-align: left">â­â­ <br>ææ¢ç´¢è½åï¼ä½å¨ä¸ååºæ¯è¡¨ç°å¯è½å·®å¼è¾å¤§ æå¼æºçæ¬ï¼<a href="https://huggingface.co/bytedance-research/UI-TARS-72B-SFT" target="_blank" rel="noopener nofollow">HuggingFace</a> / <a href="https://github.com/bytedance/ui-tars" target="_blank" rel="noopener nofollow">Github</a>ï¼</td>
</tr>
</tbody>
</table>
<p>å¦æä½ å®å¨æ²¡æå¤´ç»ªï¼ææ¨èéæ©<code>åé® Qwen3-VL</code>ææºè°±<code> GLM-4.6V</code>ã</p>
<h3 id="54-æ¨¡åéç½®">5.4 æ¨¡åéç½®</h3>
<h4 id="1-ç³è¯·å¤§æ¨¡åapi-key">1. ç³è¯·å¤§æ¨¡åAPI KEY</h4>
<p>ä»¥<code>åé® Qwen3-VL</code>ä¸ºä¾ã</p>
<p>1ãè®¿é®<code>DashScope</code>ç®¡ç<a href="https://dashscope.console.aliyun.com/" target="_blank" rel="noopener nofollow">æ§å¶å°</a></p>
<pre><code>https://dashscope.console.aliyun.com/
</code></pre>
<p><img src="https://image.kjdaohang.com/PicGo/20260201122300613.png" alt="" loading="lazy"></p>
<p>2ãç¹å»å¼éæå¡ï¼DashScope æ¨¡åæå¡ï¼ï¼è·³è½¬å°é¿éäºç¾ç¼å¹³å°</p>
<p><img src="https://image.kjdaohang.com/PicGo/20260201122342667.png" alt="" loading="lazy"></p>
<p>3ãå¼éä¹åï¼æ°ç¨æ·æ¯ä¸ªæ¨¡åé½ä¼èµé100wçåè´¹ä½éªé¢åº¦</p>
<p><img src="https://image.kjdaohang.com/PicGo/20260201122509525.png" alt="" loading="lazy"></p>
<p>å¨é¿éäºç¾ç¼æ¨¡åå¹¿åºä¸­ï¼å¯ä»¥æ¥çå°æææ¯æçæ¨¡å</p>
<p><img src="https://image.kjdaohang.com/PicGo/20260201122837281.png" alt="" loading="lazy"></p>
<p>æ¯å¦æä»¬è¦éç¨ç<code>qwen3-vl-plus</code>ï¼è¿ä¸ªæ¯éä¹åé®æ¨åºæ¥çæ°çè§è§çè§£æ¨¡åï¼å¦æä½ ä¸æ¸æ¥ï¼ä½ è½ä¸è½ç¨è¿ä¸ªæ¨¡åï¼å¯ä»¥ç¹å»è¿å¥çä¸ä¸è¿ææ²¡æåè´¹é¢åº¦</p>
<p><img src="https://image.kjdaohang.com/PicGo/20260201123211973.png" alt="" loading="lazy"></p>
<p>å¦æåè´¹é¢åº¦ç¨å®äºï¼è¿æ³ç¨ï¼ä¹å¯ä»¥åè±ç¹å°é±ï¼è´­ä¹°å®çtokenå¥é¤ã</p>
<p>4ãéæ©<code>å¯é¥ç®¡ç</code>-&gt;åå»º<code>API KEY</code></p>
<p><img src="https://image.kjdaohang.com/PicGo/20260201123547539.png" alt="" loading="lazy"></p>
<p>å¤å¶<code>API Key</code>ï¼ä¸è¦æ³é²ç»å«äººï¼èªå·±æ¿ä¸ªå°æ¬æ¬è®°ä¸æ¥å°±è¡</p>
<p><img src="https://image.kjdaohang.com/PicGo/20260201123629460.png" alt="" loading="lazy"></p>
<h4 id="2-éç½®ç¯å¢åé">2. éç½®ç¯å¢åé</h4>
<p>æäºAPI Keyä¹åï¼éè¦å°æ¨¡åéç½®åæ°é¡¹æ¾ç½®å¨ç³»ç»ç¯å¢åéä¸­ï¼Midscene ä¼èªå¨è¯»åè¿äºç¯å¢åéã</p>
<p>éç½®ç¯å¢åéå¸¸ç¨çæä¸¤ç§æ¹å¼ï¼</p>
<ul>
<li>å¨ <code>Midscene Chrome</code> æä»¶ä¸­ï¼ä½ ä¹å¯ä»¥ä½¿ç¨è¿ç§ <code>export KEY="value"</code> éç½®æ ¼å¼</li>
</ul>
<pre><code class="language-bash"># æ¿æ¢ä¸ºä½ èªå·±ç API Key
export MIDSCENE_MODEL_BASE_URL="https://dashscope.aliyuncs.com/compatible-mode/v1"
export MIDSCENE_MODEL_API_KEY="sk-abcdefghijklmnopqrstuvwxyz"
export MIDSCENE_MODEL_NAME="qwen3-vl-plus"
export MIDSCENE_MODEL_FAMILY="qwen3-vl"
</code></pre>
<p><img src="https://image.kjdaohang.com/PicGo/20260201125206521.png" alt="" loading="lazy"></p>
<ul>
<li>å¨é¡¹ç®çè¿è¡è·¯å¾ä¸åå»ºä¸ä¸ª <code>.env</code> æä»¶ï¼å¹¶æ·»å ä»¥ä¸åå®¹ï¼Midscene çå½ä»¤è¡å·¥å·é»è®¤ä¼è¯»åè¿ä¸ªæä»¶ãï¼è¯¥ç§æ¹å¼éç¨äºå½ä»¤è¡å·¥å·ï¼</li>
</ul>
<pre><code class="language-BASH">MIDSCENE_MODEL_BASE_URL="https://dashscope.aliyuncs.com/compatible-mode/v1"
MIDSCENE_MODEL_API_KEY="sk-abcdefghijklmnopqrstuvwxyz"
MIDSCENE_MODEL_NAME="qwen3-vl-plus"
MIDSCENE_MODEL_FAMILY="qwen3-vl"
</code></pre>
<blockquote>
<p>è¯·æ³¨æï¼è¿éä¸éè¦å¨æ¯ä¸è¡åæ·»å  <code>export</code>ï¼ä¸åªæ Midscene å½ä»¤è¡å·¥å·ä¼é»è®¤è¯»åè¿ä¸ªæä»¶</p>
</blockquote>
<h3 id="55-å¿«éä½éª">5.5 å¿«éä½éª</h3>
<p>è®²å°è¿éï¼ææçåå¤å·¥ä½ï¼é½å·²ç»åå¥½äºï¼æ³å¿æ­¤æ¶çä½ ï¼å·²ç»è¿«ä¸åå¾ï¼è¦ä½éªä¸ä¸Midsceneäºã</p>
<p>1ãå¨Midsceneè¾å¥æ¡ä¸­ï¼è¾å¥æç¤ºè¯æä»¤ï¼<code>æå¼æµè§å¨ï¼è®¿é®ç¾åº¦é¡µé¢ï¼å¨è¾å¥æ¡ä¸­Pythonï¼ç¹å»æç´¢</code>ï¼éæ©ç¬¬ä¸ä¸ªActionç±»åï¼å¯ä»¥çè§£ï¼è¯¥ç±»åä¼æ ¹æ®ä½ çéæ±èªå¨å¸®ä½ è§åï¼æ§è¡ï¼æç¹ç±»ä¼¼Agentä¸æ ·ã</p>
<p><img src="https://image.kjdaohang.com/PicGo/20260202084359423.png" alt="" loading="lazy"></p>
<p>å ä¸ªå¸¸ç¨çæä½ç±»åï¼</p>
<ul>
<li>Actionï¼AIèªå¨è§åæ§è¡ä»»å¡</li>
<li>Queryï¼å¸¸ç¨äºæåæ°æ®</li>
<li>Assertï¼å¸¸ç¨äºæ­è¨</li>
<li>Tapï¼ç¹å»ï¼ï¼ç¨äºç¹å»æä½</li>
</ul>
<p>2ãå½ç¹å»è¿è¡åï¼Midsceneä¼æ ¹æ®æä»¬çæä»¤æå¾ï¼å¸®æä»¬èªå¨è§åä»»å¡ï¼æ§è¡æä½ï¼æ¯å¦æå¼ç¾åº¦ï¼èªå¨æ¾å°ç¾åº¦é¡µé¢çè¾å¥æ¡ï¼å¹¶è¾å¥Pythonï¼ç¹å»æç´¢ç­çæä½ãææçæ§å¶è¿ç¨ï¼é½ä¸éè¦æä»¬èªå·±åä»£ç ï¼æ¾åç´ å®ä½ï¼ä½ åªéè¦å°ä½ çè¦æ±ç¨èªç¶è¯­è¨æè¿°åºæ¥å°±å¯ä»¥äºã</p>
<p>å·ä½æ§è¡ææï¼å¤§å®¶å¯ä»¥çè¿ä¸ªå¨ç»è§é¢ï¼ä¹å¯èªè¡å¨æ¬å°å°è¯è¿è¡ã</p>
<blockquote>
<p>è¿éé¢æä¸ä¸ªå°åï¼å¦æä½ æå¼çæ¯ä¸ä¸ªç©ºç½é¡µï¼å³å°åæ ä¸ºç©ºæ¶ï¼åéæä»¤æ¶ï¼ä¼æ¥éCannot access a chrome:// URL</p>
</blockquote>
<p><img src="https://image.kjdaohang.com/PicGo/20260201132348598.png" alt="" loading="lazy"></p>
<p>ä¹å°±æå³çï¼å¤§å®¶ç¨Midsceneæµè§å¨æä»¶è¿è¡AIèªå¨åæ¶ï¼è¦ååçå¨æä¸ªé¡µé¢ï¼è³å°è¦ç¡®ä¿å°åæ ä¸è½ä¸ºç©ºï¼è¿ä¸ªæç¹å°é¸¡èãå½ç¶å½±åä¸å¤§ï¼çå®æ¹åç»­ä¼ä¸ä¼ä¼åä¸ä¸å§ã</p>
<p>3ãé¤äºè¿ç§å¸¸è§ç¨æ³ï¼<code>Midscene</code>è¿æ¯ææ¡¥æ¥æ¨¡å¼è¿æ¥ï¼<code>Midscene Chrome</code> æä»¶çæ¡¥æ¥æ¨¡å¼åè®¸ä½ ä½¿ç¨æ¬å°èæ¬æ¥æ§å¶æ¡é¢ç Chromeãèæ¬æ¢è½è¿æ¥æ°æ ç­¾é¡µï¼ä¹å¯ä»¥éçå°å½åæ¿æ´»çæ ç­¾é¡µãè¿ç§æ¹å¼è½å¤ç¨æ¬å°æµè§å¨ç cookiesãæä»¶åé¡µé¢ç¶æï¼ä¸èªå¨åèæ¬åä½å®æä»»å¡ï¼å¨èªå¨åé¢åä¹è¢«ç§°ä½ âman-in-the-loopâã</p>
<p><strong>ä¸ºä»ä¹éè¦æ¡¥æ¥æ¨¡å¼å¢ï¼</strong> å ä¸ºæ­£å¸¸æåµä¸ï¼<code>Midscene</code>æ¯æ¬¡æ§è¡ä»»å¡é½ä¼åæå¼ä¸ä¸ªå¨æ°çæµè§å¨çªå£ï¼ä½å¾å¤åºæ¯ä¸ï¼æä½é¡µé¢é½éè¦è¿è¡ç¨æ·ç»å½è®¤è¯ï¼éè¿æ¡¥æ¥æ¨¡å¼è¿æ¥ï¼å¯ä»¥ç´æ¥å¤ç¨æ¬å°å·²æçCookieåé¡µé¢ç¶æï¼ä¸å¿å¨æ§è¡AIæµè¯ä»»å¡æé´æå·¥æ¥å®æç»å½æä½ã</p>
<p><img src="https://image.kjdaohang.com/PicGo/20260201133546151.png" alt="" loading="lazy"></p>
<p>è¿è¡ä»»å¡åï¼åç¹å» âAllow connectionâ ï¼æ§è¡åä½ ä¼çå°æä»¶ç¶æåä¸º âconnectedâ</p>
<p><img src="https://image.kjdaohang.com/PicGo/20260201133639128.png" alt="" loading="lazy"></p>
<p>è®²å°è¿éï¼ä½ å·²ç»åºæ¬ææ¡äºå¦ä½å©ç¨æä»¶çæ¹å¼æ¥ç®åä½¿ç¨<code>Midscene</code>äºï¼ä½è¿ä¸å¤ã</p>
<h3 id="56-è¿é¶ä½¿ç¨">5.6 è¿é¶ä½¿ç¨</h3>
<p>åé¢æä»¬å·²ç»å­¦ä¹ äºï¼å¦ä½éè¿Chromeæµè§å¨æä»¶çæ¹å¼æ¥ä½¿ç¨Midsceneäºï¼ä½è¿ç§æ¹å¼æ¯è¾é¸¡èï¼ä¸å¤ªéå<strong>è§åå</strong>ã<strong>æä¹å</strong>ã<strong>èµäº§å</strong>ã</p>
<p><strong>æä¹çè§£å¢ï¼</strong></p>
<p>ä½ æ³ï¼æä»¬å©ç¨Midsceneå¼å±èªå¨åæ¶ï¼æ»ä¸è½æ¯æ¬¡å¨æ§è¡èªå¨åæµè¯ä¹åï¼è¿è¦äººå·¥æå¨æå¼æµè§å¨æä»¶ï¼ææä»¤æå·¥åç»å®å§ï¼é£è¿ä¸å«èªå¨åæµè¯ï¼</p>
<p>èªå¨åæµè¯ï¼æèµ·ç çä¸ç¹è¦æ±ï¼åæåªè¦åå¤å¥½äºæµè¯èæ¬æAIæä»¤æç¤ºè¯ï¼åç»­çæææ§è¡å¨ä½ï¼é½åºè¯¥æ¯ä¸éè¦äººä¸ºä»å¥çã</p>
<p>è¿ææ´éè¦çä¸ç¹ï¼æµè§å¨æä»¶çè¿ç§æ¹å¼ï¼æä»¬å¾é¾å¨ä¼ä¸ä¸­ï¼å°ä¸å¡æµè¯ç¨ä¾æä¹åãèµäº§åå¤ç¨èµ·æ¥ã</p>
<p>æä»¥æ¥ä¸æ¥ï¼æåè±ä¸ç¹ç¹æ¶é´ï¼åäº«ä¸ä¸ï¼Midsceneå¦å¤çä¸ç§è¿é¶ç¨æ³ï¼<strong>å½ä»¤è¡+éç½®æä»¶</strong>çæ¹å¼ã</p>
<p>ç®åæ¥è¯´ï¼Midscene å®ä¹äºä¸ç§ YAML æ ¼å¼çèæ¬ï¼å¯ä»¥è®©å¼åèå¿«éç¼åèªå¨åèæ¬ï¼å¹¶æä¾äºå¯¹åºçå½ä»¤è¡å·¥å·æ¥å¿«éæ§è¡è¿äºèæ¬ã</p>
<blockquote>
<p>å¦æè¯´æä»¶çæ¹å¼ï¼åªæ¯ä¸ºäºæä¾ç»ä½¿ç¨èç®åä½éªä¸ä¸ï¼é£<strong>å½ä»¤è¡+éç½®æä»¶</strong>æ¹å¼ï¼å°±æ¯è¾éåä¼ä¸åæ­£å¼ä½¿ç¨äºã</p>
</blockquote>
<h4 id="1-å¦ä½ä¸æ">1. å¦ä½ä¸æ</h4>
<p>1ãå¨å±å®è£ <code>@midscene/cli</code> ï¼æ¨èæ°æä½¿ç¨ï¼ï¼</p>
<pre><code>npm i -g @midscene/cli
</code></pre>
<p>æå¨é¡¹ç®ä¸­æéå®è£</p>
<pre><code>npm i @midscene/cli --save-dev
</code></pre>
<p>2ãæ°å»ºä¸ä¸ªé¡¹ç®ç®å½ï¼å¨ç®å½ä¸ç¼åYAMLéç½®æä»¶ï¼å¯ä»¥çè§£ä¸ºYAMLéç½®æä»¶å°±æ¯midsceneçæµè¯èæ¬ï¼æ¯å¦åå»ºä¸ä¸ªåä¸º <code>bing-search.yaml</code> çæä»¶ï¼</p>
<pre><code class="language-YAML">web:
  url: https://www.bing.com

tasks:
  - name: æç´¢å¤©æ°
    flow:
      - ai: æç´¢ "ä»æ¥å¤©æ°"
      - sleep: 3000
      - aiAssert: ç»ææ¾ç¤ºå¤©æ°ä¿¡æ¯
</code></pre>
<p>3ãå¨é¡¹ç®ç®å½ï¼åå»º.envæä»¶ï¼éç½®AIæ¨¡åé©±å¨çç¯å¢åéä¿¡æ¯</p>
<pre><code class="language-bash">MIDSCENE_MODEL_BASE_URL="https://dashscope.aliyuncs.com/compatible-mode/v1"
# æ¿æ¢æèªå·±çAPI KEY
MIDSCENE_MODEL_API_KEY="sk-abcdefghijklmnopqrstuvwxyz"
MIDSCENE_MODEL_NAME="qwen3-vl-plus"
MIDSCENE_MODEL_FAMILY="qwen3-vl"
</code></pre>
<p>4ãéè¿å½ä»¤è¡æ¥æ§è¡å®ï¼</p>
<pre><code class="language-bash">midscene ./bing-search.yaml
# å¦æå¨é¡¹ç®ä¸­å®è£äº Midscene
npx midscene ./bing-search.yaml
</code></pre>
<p><img src="https://image.kjdaohang.com/PicGo/20260201141958373.png" alt="" loading="lazy"></p>
<p>5ãå¨éç½®æä»¶ä¸­ï¼å¦ææ¶åå°ä¸äºå¨æåéï¼å¯ä»¥éè¿ <code>${variable-name}</code> å¼ç¨ç¯å¢åéæ¥å®ç°ï¼å¦ï¼</p>
<pre><code>topic=weather today
</code></pre>
<pre><code># ...
- ai: å¨è¾å¥æ¡ä¸­è¾å¥ ${topic}
# ...
</code></pre>
<p>6ã<code>@midscene/cli</code> æ¯æä½¿ç¨ééç¬¦å¹éå¤ä¸ªèæ¬æ¥æ¹éæ§è¡èæ¬ï¼è¿ç¸å½äº <code>--files</code> åæ°çç®åã</p>
<pre><code># è¿è¡åä¸ªèæ¬
midscene ./bing-search.yaml

# ä½¿ç¨ééç¬¦æ¨¡å¼è¿è¡ææå¹éçèæ¬
midscene './scripts/**/*.yaml'
</code></pre>
<p>7ãæ§è¡å®æåï¼è¾åºç®å½ä¼åå«ï¼</p>
<ul>
<li><code>--summary</code> æå®ç JSON æ¥åï¼é»è®¤ <code>index.json</code>ï¼ï¼è®°å½ææèæ¬çæ§è¡ç¶æä¸ç»è®¡æ°æ®ã</li>
<li>æ¯ä¸ª YAML æä»¶å¯¹åºçç¬ç«æ§è¡ç»æï¼JSON æ ¼å¼ï¼ã</li>
<li>æ¯ä¸ªèæ¬çæçå¯è§åæ¥åï¼HTML æ ¼å¼ï¼ã</li>
</ul>
<p><img src="https://image.kjdaohang.com/PicGo/20260201142119212.png" alt="" loading="lazy"></p>
<p>8ãé»è®¤æåµä¸èæ¬æ¯å¨æ å¤´æ¨¡å¼ä¸è¿è¡ï¼å¦ææ³æå¼æµè§å¨çªå£ï¼å¯ä»¥å¸¦ä¸<code>Headed</code>åæ°</p>
<pre><code class="language-bash"># è¿è¡å¨ headed æ¨¡å¼
midscene /path/to/yaml --headed

# è¿è¡å¨ headed æ¨¡å¼å¹¶å¨ç»æåä¿ççªå£
midscene /path/to/yaml --keep-window
</code></pre>
<p>9ãå¦æä½ æ³å¨èæ¬ä¸­ï¼ä½¿ç¨æ¡¥æ¥æ¨¡å¼è®© YAML èæ¬é©±å¨ç°æçæ¡é¢æµè§å¨ï¼å¤ç¨ Cookiesãæä»¶æå·²æç¶æãåå®è£ Chrome æ©å±ï¼ç¶åå¨ <code>web</code> éç½®ä¸­å å¥ï¼</p>
<pre><code>web:
  url: https://www.bing.com
+ bridgeMode: newTabWithUrl
</code></pre>
<h4 id="2-å½ä»¤è¡åæ°">2. å½ä»¤è¡åæ°</h4>
<p>å½ä»¤è¡å·¥å·æä¾äºå¤é¡¹åæ°ï¼ç¨äºæ§å¶èæ¬çæ§è¡è¡ä¸ºï¼</p>
<ul>
<li><code>--files &lt;file1&gt; &lt;file2&gt; ...</code>ï¼æå®èæ¬æä»¶åè¡¨ãé»è®¤æé¡ºåºæ§è¡ï¼<code>--concurrent</code> ä¸º <code>1</code>ï¼ï¼å¯éè¿ <code>--concurrent</code> è®¾ç½®å¹¶åæ°éãæ¯æ <a href="https://www.npmjs.com/package/glob" target="_blank" rel="noopener nofollow">glob</a> ééç¬¦è¯­æ³ã</li>
<li><code>--concurrent &lt;number&gt;</code>ï¼è®¾ç½®å¹¶åæ§è¡çæ°éï¼é»è®¤ <code>1</code>ã</li>
<li><code>--continue-on-error</code>ï¼å¯ç¨åï¼å³ä½¿æä¸ªèæ¬å¤±è´¥ä¹ä¼ç»§ç»­æ§è¡åç»­èæ¬ãé»è®¤å³é­ã</li>
<li><code>--share-browser-context</code>ï¼å¨å¤ä¸ªèæ¬ä¹é´å±äº«æµè§å¨ä¸ä¸æï¼Cookiesã<code>localStorage</code> ç­ï¼ï¼éåéè¦è¿ç»­ç»å½æçåºæ¯ãé»è®¤å³é­ã</li>
<li><code>--summary &lt;filename&gt;</code>ï¼æå®çæç JSON æ»ç»æ¥åè·¯å¾ã</li>
<li><code>--headed</code>ï¼å¨å¸¦çé¢çæµè§å¨ä¸­è¿è¡èæ¬ï¼èéé»è®¤çæ å¤´æ¨¡å¼ã</li>
<li><code>--keep-window</code>ï¼èæ¬æ§è¡å®æåä¿ææµè§å¨çªå£ï¼ä¼èªå¨å¼å¯ <code>--headed</code> æ¨¡å¼ã</li>
<li><code>--config &lt;filename&gt;</code>ï¼æå®éç½®æä»¶ï¼æä»¶ä¸­çåæ°ä¼ä½ä¸ºå½ä»¤è¡åæ°çé»è®¤å¼ã</li>
<li><code>--web.userAgent &lt;ua&gt;</code>ï¼è®¾ç½®æµè§å¨ UAï¼è¦çææèæ¬ä¸­ç <code>web.userAgent</code>ã</li>
<li><code>--web.viewportWidth &lt;width&gt;</code>ï¼è®¾ç½®æµè§å¨è§å£å®½åº¦ï¼è¦çææèæ¬ä¸­ç <code>web.viewportWidth</code>ã</li>
<li><code>--web.viewportHeight &lt;height&gt;</code>ï¼è®¾ç½®æµè§å¨è§å£é«åº¦ï¼è¦çææèæ¬ä¸­ç <code>web.viewportHeight</code>ã</li>
<li><code>--android.deviceId &lt;device-id&gt;</code>ï¼è®¾ç½®å®åè®¾å¤ IDï¼è¦çææèæ¬ä¸­ç <code>android.deviceId</code>ã</li>
<li><code>--ios.wdaPort &lt;port&gt;</code>ï¼è®¾ç½® WebDriverAgent ç«¯å£ï¼è¦çææèæ¬ä¸­ç <code>ios.wdaPort</code>ã</li>
<li><code>--ios.wdaHost &lt;host&gt;</code>ï¼è®¾ç½® WebDriverAgent ä¸»æºå°åï¼è¦çææèæ¬ä¸­ç <code>ios.wdaHost</code>ã</li>
<li><code>--dotenv-debug</code>ï¼å¼å¯ dotenv çè°è¯æ¥å¿ï¼é»è®¤å³é­ã</li>
<li><code>--dotenv-override</code>ï¼åè®¸ dotenv è¦çååçå¨å±ç¯å¢åéï¼é»è®¤å³é­ã</li>
</ul>
<p>æ¯å¦ï¼ä½¿ç¨ <code>--files</code> æå®æ§è¡é¡ºåºï¼</p>
<pre><code class="language-bash">midscene --files ./login.yaml ./buy/*.yaml ./checkout.yaml
</code></pre>
<p><code>midscene</code>æ¯æå¹¶åè¿è¡ï¼å¦ä»¥ 4 ä¸ªå¹¶åæ§è¡ææèæ¬ï¼å¹¶å¨åºéæ¶ç»§ç»­è¿è¡ï¼</p>
<pre><code class="language-bash">midscene --files './scripts/**/*.yaml' --concurrent 4 --continue-on-error
</code></pre>
<p>è¿å¯ä»¥æåæ°åå° YAML éç½®æä»¶ä¸­ï¼å¹¶éè¿ <code>--config</code> å¼ç¨ï¼å½ä»¤è¡ä¼ å¥çåæ°ä¼åçº§é«äºéç½®æä»¶ã</p>
<pre><code class="language-bash">files:
  - './scripts/login.yaml'
  - './scripts/search.yaml'
  - './scripts/**/*.yaml'

concurrent: 4
continueOnError: true
shareBrowserContext: true
</code></pre>
<p>è¿è¡æ¹å¼ï¼</p>
<pre><code class="language-bash">midscene --config ./config.yaml
</code></pre>
<p>å¥½äºï¼éè¿å­¦ä¹ Chromeæä»¶åå½ä»¤è¡çè¿ä¸¤ç§æ¹å¼ï¼æç¸ä¿¡ä½ ï¼å·²ç»å¯ä»¥å®å¨è½ä¸ææä½<code>midscene</code>ï¼è¿å¨ç­ä»ä¹ð¤£ï¼èµ¶ç´§ä½éªä¸ä¸AIæµè¯çä¹è¶£å§ã</p>
<blockquote>
<p>é¤äºæä¸­æå°çï¼midsceneè¿æå¾å¤é«çº§çè¿é¶ç©æ³ï¼åé¢ä¼ç»ä¸åäº«å°AIè¿åç¤¾åã</p>
</blockquote>
<h2 id="6-æå¨æå">6. æå¨æå</h2>
<p>å¨çåå°è¯çåï¼ç¹ææéäº<strong>AIç¼ç¨</strong>å<strong>AIæµè¯</strong>ä¸¤ä¸ªåºæ¯ä¸çå°æ¡ä¾ï¼éè¿å¨10åéåå®æç¬¬ä¸ä¸ªAIåºç¨å¹¶ä¸çº¿ï¼ä½éªAIç¼ç¨ï¼Vibe Codingï¼ãAIæµè¯çæ ¸å¿é­åï¼å¸®å©å¤§å®¶å»ºç«å¯¹AIè½åçç´è§è®¤ç¥ãï¼å½ç¶ï¼ç®åä½ æçå°çä¹æåªæ¯AIè½åçå°å±±ä¸è§ï¼</p>
<p>åå½æ é¢ï¼å«ååªåç¹ç¹ç¹çéå¤å³å¨ï¼AI+LLM æµè¯çå¼ºå¤§ï¼æ ¸å¿å°±å¨äºéæäºæµè¯çæ ¸å¿é»è¾ï¼ä¸ç®¡AIææ¯åå±å¦ä½å¼ºå¤§ï¼ä½ææ¯ç»ç©¶è¦åå½äºäººã</p>
<p>èä»¥ <code>Midscene</code> ä¸ºä»£è¡¨ç AI èªå¨åå·¥å·ï¼æ­£å½»åºæ¹åä¼ ç»æµè¯ãä¼ ç»ç¼ç¨çæ¸¸æè§åãå®è®©æµè¯äººåãå¼åäººåä»çº ç» â<strong>æä¹å</strong>â çææ¯ç»èéæ½ç¦»ï¼èç¦äº â<strong>è¦åä»ä¹</strong>â çæ ¸å¿éæ±ï¼çæ­£ä»éå¤ä½æçæå·¥æä½ä¸­è§£æ¾åºæ¥ï¼å°ç²¾åæå¥å°æ´é«ä»·å¼çä¸å¡åºæ¯æ¢ç´¢ãäº§åè´¨éæ·±åº¦æ´å¯ä¸­ï¼èè¿æ°æ°ææ¯ AI+LLM æµè¯ççæ­£é­åã</p>
<p>æçå®è·µè¡¨æï¼ä»åæ­¥ä½¿ç¨Midsceneï¼èæ¬ç¼åæçå°±æåäº3åä»¥ä¸ï¼ç»´æ¤ææ¬å¤§å¹ä¸éï¼éææ¯äººåä¹è½å¿«éä¸æåç¨ä¾ãè¿å·²ä¸ä»æ¯å·¥å·åçº§ï¼æ´æ¯ä¸åºæµè¯çå¿µçè¿åã</p>
<p>å¦æä½ è¿å¨è¦äºUIèªå¨åï¼ä¸å¦¨ä»ä»å¤©å¼å§ï¼</p>
<ul>
<li>å®è£Midsceneæä»¶ï¼ç¨èªç¶è¯­è¨åç¬¬ä¸ä¸ªæµè¯èæ¬ï¼</li>
<li>ä»å°åºæ¯éªè¯ï¼éæ­¥æ©å±å°æ ¸å¿ä¸å¡æµç¨ï¼</li>
<li>å»ºç«å¢éåçæç¤ºè¯åºä¸æä½³å®è·µã</li>
</ul>
<p>AIä¸ä¼åä»£æµè¯å·¥ç¨å¸ï¼ä½ä¼ç¨AIçæµè¯äººï¼å¿å°æ·æ±°é£äºä»åçå¨â<strong>æå·¥+ç¡¬ç¼ç </strong>âæ¶ä»£çå¢éãå¦ææ¨ææ´å¥½çæ³æ³æå®è·µï¼æ¬¢è¿ä¸èµ·æ¢è®¨ï¼ä¹æ¬¢è¿æ¿ç ï¼ð</p>


</div>
<div id="MySignature" role="contentinfo">
    ææ¯æ¹åä¸çï¼
         --çè¯ç»å
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-06 09:03">2026-02-06 09:02</span>&nbsp;
<a href="https://www.cnblogs.com/jinjiangongzuoshi">çå¸</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19582572);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19582572', targetLink: 'https://www.cnblogs.com/jinjiangongzuoshi/p/19582572', title: 'å«ååªå âç¹ç¹ç¹âï¼AIæµè¯çå­ç§ä¸åç©æ³ï¼éå¸¦Midsceneè¯¦ç»æç¨ï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Unsafeé­æ³ç±»æ·±åº¦è§£æï¼Javaåºå±æä½çç»ææå ]]></title>
    <link>https://www.cnblogs.com/sevencoding/p/19559023</link>
    <guid>e23f5d4a4c1e9826fd864f4d56324c60</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/sevencoding/p/19559023" title="åå¸äº 2026-02-06 09:00">
    <span role="heading" aria-level="2">Unsafeé­æ³ç±»æ·±åº¦è§£æï¼Javaåºå±æä½çç»ææå</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="ä»ç»">ä»ç»</h2>
<p>Unsafeæ¯ä½äºsun.miscåä¸çä¸ä¸ªç±»ï¼ä¸»è¦æä¾ä¸äºç¨äºæ§è¡ä½çº§å«ãä¸å®å¨æä½çæ¹æ³ï¼å¦ç´æ¥è®¿é®ç³»ç»åå­èµæºãèªä¸»ç®¡çåå­èµæºç­ï¼è¿äºæ¹æ³å¨æåJavaè¿è¡æçãå¢å¼ºJavaè¯­è¨åºå±èµæºæä½è½åæ¹é¢èµ·å°äºå¾å¤§çä½ç¨ãä½ç±äºUnsafeç±»ä½¿Javaè¯­è¨æ¥æäºç±»ä¼¼Cè¯­è¨æéä¸æ ·æä½åå­ç©ºé´çè½åï¼è¿æ çä¹å¢å äºç¨åºåçç¸å³æéé®é¢çé£é©ãå¨ç¨åºä¸­è¿åº¦ãä¸æ­£ç¡®ä½¿ç¨Unsafeç±»ä¼ä½¿å¾ç¨åºåºéçæ¦çåå¤§ï¼ä½¿å¾Javaè¿ç§å®å¨çè¯­è¨åå¾ä¸åâå®å¨âï¼å æ­¤å¯¹Unsafeçä½¿ç¨ä¸å®è¦æéã</p>
<p>è¿ä¸ªç±»å°½ç®¡éé¢çæ¹æ³é½æ¯ public çï¼ä½æ¯å¹¶æ²¡æåæ³ä½¿ç¨å®ä»¬ï¼JDK API ææ¡£ä¹æ²¡ææä¾ä»»ä½å³äºè¿ä¸ªç±»çæ¹æ³çè§£éãæ»èè¨ä¹ï¼å¯¹äº Unsafe ç±»çä½¿ç¨é½æ¯åéå¶çï¼åªææä¿¡çä»£ç æè½è·å¾è¯¥ç±»çå®ä¾ï¼å½ç¶ JDK åºéé¢çç±»æ¯å¯ä»¥éæä½¿ç¨çã</p>
<p>åæ¥çä¸è¿å¼ å¾ï¼å¯¹UnSafeç±»æ»ä½åè½ï¼</p>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202404251040445.jpg" alt="" loading="lazy"></p>
<p>å¦ä¸å¾æç¤ºï¼Unsafeæä¾çAPIå¤§è´å¯åä¸ºåå­æä½ãCASãClassç¸å³ãå¯¹è±¡æä½ãçº¿ç¨è°åº¦ãç³»ç»ä¿¡æ¯è·åãåå­å±éãæ°ç»æä½ç­å ç±»ï¼ä¸é¢å°å¯¹å¶ç¸å³æ¹æ³ååºç¨åºæ¯è¿è¡è¯¦ç»ä»ç»ã</p>
<h2 id="åå­æä½">åå­æä½</h2>
<h3 id="ä»ç»-1">ä»ç»</h3>
<p>å¦æä½ æ¯ä¸ä¸ªåè¿ C æè C++ çç¨åºåï¼ä¸å®å¯¹åå­æä½ä¸ä¼éçï¼èå¨ Java ä¸­æ¯ä¸åè®¸ç´æ¥å¯¹åå­è¿è¡æä½çï¼å¯¹è±¡åå­çåéååæ¶é½æ¯ç± JVM èªå·±å®ç°çãä½æ¯å¨ <code>Unsafe</code> ä¸­ï¼æä¾çä¸åæ¥å£å¯ä»¥ç´æ¥è¿è¡åå­æä½ï¼</p>
<pre><code class="language-java">//åéæ°çæ¬å°ç©ºé´
public native long allocateMemory(long bytes);
//éæ°è°æ´åå­ç©ºé´çå¤§å°
public native long reallocateMemory(long address, long bytes);
//å°åå­è®¾ç½®ä¸ºæå®å¼
public native void setMemory(Object o, long offset, long bytes, byte value);
//åå­æ·è´
public native void copyMemory(Object srcBase, long srcOffset,Object destBase, long destOffset,long bytes);
//æ¸é¤åå­
public native void freeMemory(long address);
</code></pre>
<p>ä½¿ç¨ä¸é¢çä»£ç è¿è¡æµè¯ï¼</p>
<pre><code class="language-java">private void memoryTest() {
    int size = 4;
    long addr = unsafe.allocateMemory(size);
    long addr3 = unsafe.reallocateMemory(addr, size * 2);
    System.out.println("addr: "+addr);
    System.out.println("addr3: "+addr3);
    try {
        unsafe.setMemory(null,addr ,size,(byte)1);
        for (int i = 0; i &lt; 2; i++) {
            unsafe.copyMemory(null,addr,null,addr3+size*i,4);
        }
        System.out.println(unsafe.getInt(addr));
        System.out.println(unsafe.getLong(addr3));
    }finally {
        unsafe.freeMemory(addr);
        unsafe.freeMemory(addr3);
    }
}
</code></pre>
<p>åçç»æè¾åºï¼</p>
<pre><code class="language-plain">addr: 2433733895744
addr3: 2433733894944
16843009
72340172838076673
</code></pre>
<p>åæä¸ä¸è¿è¡ç»æï¼é¦åä½¿ç¨<code>allocateMemory</code>æ¹æ³ç³è¯· 4 å­èé¿åº¦çåå­ç©ºé´ï¼è°ç¨<code>setMemory</code>æ¹æ³åæ¯ä¸ªå­èåå¥åå®¹ä¸º<code>byte</code>ç±»åç 1ï¼å½ä½¿ç¨ Unsafe è°ç¨<code>getInt</code>æ¹æ³æ¶ï¼å ä¸ºä¸ä¸ª<code>int</code>ååéå  4 ä¸ªå­èï¼ä¼ä¸æ¬¡æ§è¯»å 4 ä¸ªå­èï¼ç»æä¸ä¸ª<code>int</code>çå¼ï¼å¯¹åºçåè¿å¶ç»æä¸º 16843009ã</p>
<p>ä½ å¯ä»¥éè¿ä¸å¾çè§£è¿ä¸ªè¿ç¨ï¼</p>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202406202130396.png" alt="" loading="lazy"></p>
<p>å¨ä»£ç ä¸­è°ç¨<code>reallocateMemory</code>æ¹æ³éæ°åéäºä¸å 8 å­èé¿åº¦çåå­ç©ºé´ï¼éè¿æ¯è¾<code>addr</code>å<code>addr3</code>å¯ä»¥çå°åä¹åç³è¯·çåå­å°åæ¯ä¸åçãå¨ä»£ç ä¸­çç¬¬äºä¸ª for å¾ªç¯éï¼è°ç¨<code>copyMemory</code>æ¹æ³è¿è¡äºä¸¤æ¬¡åå­çæ·è´ï¼æ¯æ¬¡æ·è´åå­å°å<code>addr</code>å¼å§ç 4 ä¸ªå­èï¼åå«æ·è´å°ä»¥<code>addr3</code>å<code>addr3+4</code>å¼å§çåå­ç©ºé´ä¸ï¼</p>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202406202130404.png" alt="" loading="lazy"></p>
<p>æ·è´å®æåï¼ä½¿ç¨<code>getLong</code>æ¹æ³ä¸æ¬¡æ§è¯»å 8 ä¸ªå­èï¼å¾å°<code>long</code>ç±»åçå¼ä¸º 72340172838076673ã</p>
<p>éè¦æ³¨æï¼éè¿è¿ç§æ¹å¼åéçåå­å±äº å å¤åå­ ï¼æ¯æ æ³è¿è¡åå¾åæ¶çï¼éè¦æä»¬æè¿äºåå­å½åä¸ç§èµæºå»æå¨è°ç¨<code>freeMemory</code>æ¹æ³è¿è¡éæ¾ï¼å¦åä¼äº§çåå­æ³æ¼ãéç¨çæä½åå­æ¹å¼æ¯å¨<code>try</code>ä¸­æ§è¡å¯¹åå­çæä½ï¼æç»å¨<code>finally</code>åä¸­è¿è¡åå­çéæ¾ã</p>
<p><strong>ä¸ºä»ä¹è¦ä½¿ç¨å å¤åå­ï¼</strong></p>
<ul>
<li>å¯¹åå¾åæ¶åé¡¿çæ¹åãç±äºå å¤åå­æ¯ç´æ¥åæä½ç³»ç»ç®¡çèä¸æ¯ JVMï¼æä»¥å½æä»¬ä½¿ç¨å å¤åå­æ¶ï¼å³å¯ä¿æè¾å°çå ååå­è§æ¨¡ãä»èå¨ GC æ¶åå°åæ¶åé¡¿å¯¹äºåºç¨çå½±åã</li>
<li>æåç¨åº I/O æä½çæ§è½ãéå¸¸å¨ I/O éä¿¡è¿ç¨ä¸­ï¼ä¼å­å¨å ååå­å°å å¤åå­çæ°æ®æ·è´æä½ï¼å¯¹äºéè¦é¢ç¹è¿è¡åå­é´æ°æ®æ·è´ä¸çå½å¨æè¾ç­çæå­æ°æ®ï¼é½å»ºè®®å­å¨å°å å¤åå­ã</li>
</ul>
<h3 id="å¸ååºç¨">å¸ååºç¨</h3>
<p><code>DirectByteBuffer</code> æ¯ Java ç¨äºå®ç°å å¤åå­çä¸ä¸ªéè¦ç±»ï¼éå¸¸ç¨å¨éä¿¡è¿ç¨ä¸­åç¼å²æ± ï¼å¦å¨ NettyãMINA ç­ NIO æ¡æ¶ä¸­åºç¨å¹¿æ³ã<code>DirectByteBuffer</code> å¯¹äºå å¤åå­çåå»ºãä½¿ç¨ãéæ¯ç­é»è¾åç± Unsafe æä¾çå å¤åå­ API æ¥å®ç°ã</p>
<p>ä¸å¾ä¸º <code>DirectByteBuffer</code> æé å½æ°ï¼åå»º <code>DirectByteBuffer</code> çæ¶åï¼éè¿ <code>Unsafe.allocateMemory</code> åéåå­ã<code>Unsafe.setMemory</code> è¿è¡åå­åå§åï¼èåæå»º <code>Cleaner</code> å¯¹è±¡ç¨äºè·è¸ª <code>DirectByteBuffer</code> å¯¹è±¡çåå¾åæ¶ï¼ä»¥å®ç°å½ <code>DirectByteBuffer</code> è¢«åå¾åæ¶æ¶ï¼åéçå å¤åå­ä¸èµ·è¢«éæ¾ã</p>
<pre><code class="language-java">DirectByteBuffer(int cap) {                   // package-private

    super(-1, 0, cap, cap);
    boolean pa = VM.isDirectMemoryPageAligned();
    int ps = Bits.pageSize();
    long size = Math.max(1L, (long)cap + (pa ? ps : 0));
    Bits.reserveMemory(size, cap);

    long base = 0;
    try {
        // åéåå­å¹¶è¿ååºå°å
        base = unsafe.allocateMemory(size);
    } catch (OutOfMemoryError x) {
        Bits.unreserveMemory(size, cap);
        throw x;
    }
    // åå­åå§å
    unsafe.setMemory(base, size, (byte) 0);
    if (pa &amp;&amp; (base % ps != 0)) {
        // Round up to page boundary
        address = base + ps - (base &amp; (ps - 1));
    } else {
        address = base;
    }
    // è·è¸ª DirectByteBuffer å¯¹è±¡çåå¾åæ¶ï¼ä»¥å®ç°å å¤åå­éæ¾
    cleaner = Cleaner.create(this, new Deallocator(base, size, cap));
    att = null;
}
</code></pre>
<h2 id="åå­å±é">åå­å±é</h2>
<h3 id="ä»ç»-2">ä»ç»</h3>
<p>å¨ä»ç»åå­å±éåï¼éè¦ç¥éç¼è¯å¨å CPU ä¼å¨ä¿è¯ç¨åºè¾åºç»æä¸è´çæåµä¸ï¼ä¼å¯¹ä»£ç è¿è¡éæåºï¼ä»æä»¤ä¼åè§åº¦æåæ§è½ãèæä»¤éæåºå¯è½ä¼å¸¦æ¥ä¸ä¸ªä¸å¥½çç»æï¼å¯¼è´ CPU çé«éç¼å­ååå­ä¸­æ°æ®çä¸ä¸è´ï¼èåå­å±éï¼<code>Memory Barrier</code>ï¼å°±æ¯éè¿é»æ­¢å±éä¸¤è¾¹çæä»¤éæåºä»èé¿åç¼è¯å¨åç¡¬ä»¶çä¸æ­£ç¡®ä¼åæåµã</p>
<p>å¨ç¡¬ä»¶å±é¢ä¸ï¼åå­å±éæ¯ CPU ä¸ºäºé²æ­¢ä»£ç è¿è¡éæåºèæä¾çæä»¤ï¼ä¸åçç¡¬ä»¶å¹³å°ä¸å®ç°åå­å±éçæ¹æ³å¯è½å¹¶ä¸ç¸åãå¨ Java8 ä¸­ï¼å¼å¥äº 3 ä¸ªåå­å±éçå½æ°ï¼å®å±è½äºæä½ç³»ç»åºå±çå·®å¼ï¼åè®¸å¨ä»£ç ä¸­å®ä¹ãå¹¶ç»ä¸ç± JVM æ¥çæåå­å±éæä»¤ï¼æ¥å®ç°åå­å±éçåè½ã</p>
<p><code>Unsafe</code> ä¸­æä¾äºä¸é¢ä¸ä¸ªåå­å±éç¸å³æ¹æ³ï¼</p>
<pre><code class="language-java">//åå­å±éï¼ç¦æ­¢loadæä½éæåºãå±éåçloadæä½ä¸è½è¢«éæåºå°å±éåï¼å±éåçloadæä½ä¸è½è¢«éæåºå°å±éå
public native void loadFence();
//åå­å±éï¼ç¦æ­¢storeæä½éæåºãå±éåçstoreæä½ä¸è½è¢«éæåºå°å±éåï¼å±éåçstoreæä½ä¸è½è¢«éæåºå°å±éå
public native void storeFence();
//åå­å±éï¼ç¦æ­¢loadãstoreæä½éæåº
public native void fullFence();
</code></pre>
<p>åå­å±éå¯ä»¥çåå¯¹åå­éæºè®¿é®çæä½ä¸­çä¸ä¸ªåæ­¥ç¹ï¼ä½¿å¾æ­¤ç¹ä¹åçææè¯»åæä½é½æ§è¡åæå¯ä»¥å¼å§æ§è¡æ­¤ç¹ä¹åçæä½ãä»¥<code>loadFence</code>æ¹æ³ä¸ºä¾ï¼å®ä¼ç¦æ­¢è¯»æä½éæåºï¼ä¿è¯å¨è¿ä¸ªå±éä¹åçææè¯»æä½é½å·²ç»å®æï¼å¹¶ä¸å°ç¼å­æ°æ®è®¾ä¸ºæ æï¼éæ°ä»ä¸»å­ä¸­è¿è¡å è½½ã</p>
<p>çå°è¿ä¼°è®¡å¾å¤å°ä¼ä¼´ä»¬ä¼æ³å°<code>volatile</code>å³é®å­äºï¼å¦æå¨å­æ®µä¸æ·»å äº<code>volatile</code>å³é®å­ï¼å°±è½å¤å®ç°å­æ®µå¨å¤çº¿ç¨ä¸çå¯è§æ§ãåºäºè¯»åå­å±éï¼æä»¬ä¹è½å®ç°ç¸åçåè½ãä¸é¢å®ä¹ä¸ä¸ªçº¿ç¨æ¹æ³ï¼å¨çº¿ç¨ä¸­å»ä¿®æ¹<code>flag</code>æ å¿ä½ï¼æ³¨æè¿éç<code>flag</code>æ¯æ²¡æè¢«<code>volatile</code>ä¿®é¥°çï¼</p>
<pre><code class="language-java">@Getter
class ChangeThread implements Runnable{
    /**volatile**/ boolean flag=false;
    @Override
    public void run() {
        try {
            Thread.sleep(3000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println("subThread change flag to:" + flag);
        flag = true;
    }
}
</code></pre>
<p>å¨ä¸»çº¿ç¨ç<code>while</code>å¾ªç¯ä¸­ï¼å å¥åå­å±éï¼æµè¯æ¯å¦è½å¤æç¥å°<code>flag</code>çä¿®æ¹ååï¼</p>
<pre><code class="language-java">public static void main(String[] args){
    ChangeThread changeThread = new ChangeThread();
    new Thread(changeThread).start();
    while (true) {
        boolean flag = changeThread.isFlag();
        unsafe.loadFence(); //å å¥è¯»åå­å±é
        if (flag){
            System.out.println("detected flag changed");
            break;
        }
    }
    System.out.println("main thread end");
}
</code></pre>
<p>è¿è¡ç»æï¼</p>
<pre><code class="language-plain">subThread change flag to:false
detected flag changed
main thread end
</code></pre>
<p>èå¦æå æä¸é¢ä»£ç ä¸­ç<code>loadFence</code>æ¹æ³ï¼é£ä¹ä¸»çº¿ç¨å°æ æ³æç¥å°<code>flag</code>åççååï¼ä¼ä¸ç´å¨<code>while</code>ä¸­å¾ªç¯ãå¯ä»¥ç¨å¾æ¥è¡¨ç¤ºä¸é¢çè¿ç¨ï¼</p>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202406202130484.png" alt="" loading="lazy"></p>
<p>äºè§£ Java åå­æ¨¡åï¼<code>JMM</code>ï¼çå°ä¼ä¼´ä»¬åºè¯¥æ¸æ¥ï¼è¿è¡ä¸­ççº¿ç¨ä¸æ¯ç´æ¥è¯»åä¸»åå­ä¸­çåéçï¼åªè½æä½èªå·±å·¥ä½åå­ä¸­çåéï¼ç¶ååæ­¥å°ä¸»åå­ä¸­ï¼å¹¶ä¸çº¿ç¨çå·¥ä½åå­æ¯ä¸è½å±äº«çãä¸é¢çå¾ä¸­çæµç¨å°±æ¯å­çº¿ç¨åå©äºä¸»åå­ï¼å°ä¿®æ¹åçç»æåæ­¥ç»äºä¸»çº¿ç¨ï¼è¿èä¿®æ¹ä¸»çº¿ç¨ä¸­çå·¥ä½ç©ºé´ï¼è·³åºå¾ªç¯ã</p>
<h3 id="å¸ååºç¨-1">å¸ååºç¨</h3>
<p>å¨ Java 8 ä¸­å¼å¥äºä¸ç§éçæ°æºå¶ââ<code>StampedLock</code>ï¼å®å¯ä»¥çææ¯è¯»åéçä¸ä¸ªæ¹è¿çæ¬ã<code>StampedLock</code> æä¾äºä¸ç§ä¹è§è¯»éçå®ç°ï¼è¿ç§ä¹è§è¯»éç±»ä¼¼äºæ éçæä½ï¼å®å¨ä¸ä¼é»å¡åçº¿ç¨è·ååéï¼ä»èç¼è§£è¯»å¤åå°æ¶åçº¿ç¨âé¥¥é¥¿âç°è±¡ãç±äº <code>StampedLock</code> æä¾çä¹è§è¯»éä¸é»å¡åçº¿ç¨è·åè¯»éï¼å½çº¿ç¨å±äº«åéä»ä¸»åå­ load å°çº¿ç¨å·¥ä½åå­æ¶ï¼ä¼å­å¨æ°æ®ä¸ä¸è´é®é¢ã</p>
<p>ä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼<code>StampedLock</code> ç <code>validate</code> æ¹æ³ä¼éè¿ <code>Unsafe</code> ç <code>loadFence</code> æ¹æ³å å¥ä¸ä¸ª <code>load</code> åå­å±éã</p>
<pre><code class="language-java">public boolean validate(long stamp) {
   U.loadFence();
   return (stamp &amp; SBITS) == (state &amp; SBITS);
}
</code></pre>
<h2 id="å¯¹è±¡æä½">å¯¹è±¡æä½</h2>
<h3 id="ä»ç»-3">ä»ç»</h3>
<p><strong>ä¾å­</strong></p>
<pre><code class="language-java">import sun.misc.Unsafe;
import java.lang.reflect.Field;

public class Main {

    private int value;

    public static void main(String[] args) throws Exception{
        Unsafe unsafe = reflectGetUnsafe();
        assert unsafe != null;
        long offset = unsafe.objectFieldOffset(Main.class.getDeclaredField("value"));
        Main main = new Main();
        System.out.println("value before putInt: " + main.value);
        unsafe.putInt(main, offset, 42);
        System.out.println("value after putInt: " + main.value);
  System.out.println("value after putInt: " + unsafe.getInt(main, offset));
    }

    private static Unsafe reflectGetUnsafe() {
        try {
            Field field = Unsafe.class.getDeclaredField("theUnsafe");
            field.setAccessible(true);
            return (Unsafe) field.get(null);
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }

}
</code></pre>
<p>è¾åºç»æï¼</p>
<pre><code class="language-plain">value before putInt: 0
value after putInt: 42
value after putInt: 42
</code></pre>
<p><strong>å¯¹è±¡å±æ§</strong></p>
<p>å¯¹è±¡æåå±æ§çåå­åç§»éè·åï¼ä»¥åå­æ®µå±æ§å¼çä¿®æ¹ï¼å¨ä¸é¢çä¾å­ä¸­æä»¬å·²ç»æµè¯è¿äºãé¤äºåé¢ç<code>putInt</code>ã<code>getInt</code>æ¹æ³å¤ï¼Unsafe æä¾äºå¨é¨ 8 ç§åºç¡æ°æ®ç±»åä»¥å<code>Object</code>ç<code>put</code>å<code>get</code>æ¹æ³ï¼å¹¶ä¸ææç<code>put</code>æ¹æ³é½å¯ä»¥è¶è¿è®¿é®æéï¼ç´æ¥ä¿®æ¹åå­ä¸­çæ°æ®ãéè¯» openJDK æºç ä¸­çæ³¨éåç°ï¼åºç¡æ°æ®ç±»åå<code>Object</code>çè¯»åç¨æä¸åï¼åºç¡æ°æ®ç±»åæ¯ç´æ¥æä½çå±æ§å¼ï¼<code>value</code>ï¼ï¼è<code>Object</code>çæä½åæ¯åºäºå¼ç¨å¼ï¼<code>reference value</code>ï¼ãä¸é¢æ¯<code>Object</code>çè¯»åæ¹æ³ï¼</p>
<pre><code class="language-java">//å¨å¯¹è±¡çæå®åç§»å°åè·åä¸ä¸ªå¯¹è±¡å¼ç¨
public native Object getObject(Object o, long offset);
//å¨å¯¹è±¡æå®åç§»å°ååå¥ä¸ä¸ªå¯¹è±¡å¼ç¨
public native void putObject(Object o, long offset, Object x);
</code></pre>
<p>é¤äºå¯¹è±¡å±æ§çæ®éè¯»åå¤ï¼<code>Unsafe</code> è¿æä¾äº <strong>volatile è¯»å</strong>å<strong>æåºåå¥</strong>æ¹æ³ã<code>volatile</code>è¯»åæ¹æ³çè¦çèå´ä¸æ®éè¯»åç¸åï¼åå«äºå¨é¨åºç¡æ°æ®ç±»åå<code>Object</code>ç±»åï¼ä»¥<code>int</code>ç±»åä¸ºä¾ï¼</p>
<pre><code class="language-java">//å¨å¯¹è±¡çæå®åç§»å°åå¤è¯»åä¸ä¸ªintå¼ï¼æ¯ævolatile loadè¯­ä¹
public native int getIntVolatile(Object o, long offset);
//å¨å¯¹è±¡æå®åç§»å°åå¤åå¥ä¸ä¸ªintï¼æ¯ævolatile storeè¯­ä¹
public native void putIntVolatile(Object o, long offset, int x);
</code></pre>
<p>ç¸å¯¹äºæ®éè¯»åæ¥è¯´ï¼<code>volatile</code>è¯»åå·ææ´é«çææ¬ï¼å ä¸ºå®éè¦ä¿è¯å¯è§æ§åæåºæ§ãå¨æ§è¡<code>get</code>æä½æ¶ï¼ä¼å¼ºå¶ä»ä¸»å­ä¸­è·åå±æ§å¼ï¼å¨ä½¿ç¨<code>put</code>æ¹æ³è®¾ç½®å±æ§å¼æ¶ï¼ä¼å¼ºå¶å°å¼æ´æ°å°ä¸»å­ä¸­ï¼ä»èä¿è¯è¿äºåæ´å¯¹å¶ä»çº¿ç¨æ¯å¯è§çã</p>
<p>æåºåå¥çæ¹æ³æä»¥ä¸ä¸ä¸ªï¼</p>
<pre><code class="language-java">public native void putOrderedObject(Object o, long offset, Object x);
public native void putOrderedInt(Object o, long offset, int x);
public native void putOrderedLong(Object o, long offset, long x);
</code></pre>
<p>æåºåå¥çææ¬ç¸å¯¹<code>volatile</code>è¾ä½ï¼å ä¸ºå®åªä¿è¯åå¥æ¶çæåºæ§ï¼èä¸ä¿è¯å¯è§æ§ï¼ä¹å°±æ¯ä¸ä¸ªçº¿ç¨åå¥çå¼ä¸è½ä¿è¯å¶ä»çº¿ç¨ç«å³å¯è§ãä¸ºäºè§£å³è¿éçå·®å¼æ§ï¼éè¦å¯¹åå­å±éçç¥è¯ç¹åè¿ä¸æ­¥è¿è¡è¡¥åï¼é¦åéè¦äºè§£ä¸¤ä¸ªæä»¤çæ¦å¿µï¼</p>
<ul>
<li><code>Load</code>ï¼å°ä¸»åå­ä¸­çæ°æ®æ·è´å°å¤çå¨çç¼å­ä¸­</li>
<li><code>Store</code>ï¼å°å¤çå¨ç¼å­çæ°æ®å·æ°å°ä¸»åå­ä¸­</li>
</ul>
<p>é¡ºåºåå¥ä¸<code>volatile</code>åå¥çå·®å«å¨äºï¼å¨é¡ºåºåæ¶å å¥çåå­å±éç±»åä¸º<code>StoreStore</code>ç±»åï¼èå¨<code>volatile</code>åå¥æ¶å å¥çåå­å±éæ¯<code>StoreLoad</code>ç±»åï¼å¦ä¸å¾æç¤ºï¼</p>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202406202130467.png" alt="" loading="lazy"></p>
<p>å¨æåºåå¥æ¹æ³ä¸­ï¼ä½¿ç¨çæ¯<code>StoreStore</code>å±éï¼è¯¥å±éç¡®ä¿<code>Store1</code>ç«å»å·æ°æ°æ®å°åå­ï¼è¿ä¸æä½åäº<code>Store2</code>ä»¥ååç»­çå­å¨æä»¤æä½ãèå¨<code>volatile</code>åå¥ä¸­ï¼ä½¿ç¨çæ¯<code>StoreLoad</code>å±éï¼è¯¥å±éç¡®ä¿<code>Store1</code>ç«å»å·æ°æ°æ®å°åå­ï¼è¿ä¸æä½åäº<code>Load2</code>ååç»­çè£è½½æä»¤ï¼å¹¶ä¸ï¼<code>StoreLoad</code>å±éä¼ä½¿è¯¥å±éä¹åçææåå­è®¿é®æä»¤ï¼åæ¬å­å¨æä»¤åè®¿é®æä»¤å¨é¨å®æä¹åï¼ææ§è¡è¯¥å±éä¹åçåå­è®¿é®æä»¤ã</p>
<p>ç»¼ä¸æè¿°ï¼å¨ä¸é¢çä¸ç±»åå¥æ¹æ³ä¸­ï¼å¨åå¥æçæ¹é¢ï¼æç§<code>put</code>ã<code>putOrder</code>ã<code>putVolatile</code>çé¡ºåºæçéæ¸éä½ã</p>
<p><strong>å¯¹è±¡å®ä¾å</strong></p>
<p>ä½¿ç¨ <code>Unsafe</code> ç <code>allocateInstance</code> æ¹æ³ï¼åè®¸æä»¬ä½¿ç¨éå¸¸è§çæ¹å¼è¿è¡å¯¹è±¡çå®ä¾åï¼é¦åå®ä¹ä¸ä¸ªå®ä½ç±»ï¼å¹¶ä¸å¨æé å½æ°ä¸­å¯¹å¶æååéè¿è¡èµå¼æä½ï¼</p>
<pre><code class="language-java">@Data
public class A {
    private int b;
    public A(){
        this.b =1;
    }
}
</code></pre>
<p>åå«åºäºæé å½æ°ãåå°ä»¥å <code>Unsafe</code> æ¹æ³çä¸åæ¹å¼åå»ºå¯¹è±¡è¿è¡æ¯è¾ï¼</p>
<pre><code class="language-java">public void objTest() throws Exception{
    A a1=new A();
    System.out.println(a1.getB());
    A a2 = A.class.newInstance();
    System.out.println(a2.getB());
    A a3= (A) unsafe.allocateInstance(A.class);
    System.out.println(a3.getB());
}
</code></pre>
<p>æå°ç»æåå«ä¸º 1ã1ã0ï¼è¯´æéè¿<code>allocateInstance</code>æ¹æ³åå»ºå¯¹è±¡è¿ç¨ä¸­ï¼ä¸ä¼è°ç¨ç±»çæé æ¹æ³ãä½¿ç¨è¿ç§æ¹å¼åå»ºå¯¹è±¡æ¶ï¼åªç¨å°äº<code>Class</code>å¯¹è±¡ï¼æä»¥è¯´å¦ææ³è¦è·³è¿å¯¹è±¡çåå§åé¶æ®µæèè·³è¿æé å¨çå®å¨æ£æ¥ï¼å°±å¯ä»¥ä½¿ç¨è¿ç§æ¹æ³ãå¨ä¸é¢çä¾å­ä¸­ï¼å¦æå° A ç±»çæé å½æ°æ¹ä¸º<code>private</code>ç±»åï¼å°æ æ³éè¿æé å½æ°ååå°åå»ºå¯¹è±¡ï¼å¯ä»¥éè¿æé å½æ°å¯¹è±¡ setAccessible ååå»ºå¯¹è±¡ï¼ï¼ä½<code>allocateInstance</code>æ¹æ³ä»ç¶ææã</p>
<h3 id="å¸ååºç¨-2">å¸ååºç¨</h3>
<ul>
<li><strong>å¸¸è§å¯¹è±¡å®ä¾åæ¹å¼</strong>ï¼æä»¬éå¸¸æç¨å°çåå»ºå¯¹è±¡çæ¹å¼ï¼ä»æ¬è´¨ä¸æ¥è®²ï¼é½æ¯éè¿ new æºå¶æ¥å®ç°å¯¹è±¡çåå»ºãä½æ¯ï¼new æºå¶æä¸ªç¹ç¹å°±æ¯å½ç±»åªæä¾æåçæé å½æ°ä¸æ æ¾ç¤ºå£°ææ åæé å½æ°æ¶ï¼åå¿é¡»ä½¿ç¨æåæé å½æ°è¿è¡å¯¹è±¡æé ï¼èä½¿ç¨æåæé å½æ°æ¶ï¼å¿é¡»ä¼ éç¸åºä¸ªæ°çåæ°æè½å®æå¯¹è±¡å®ä¾åã</li>
<li><strong>éå¸¸è§çå®ä¾åæ¹å¼</strong>ï¼è Unsafe ä¸­æä¾ allocateInstance æ¹æ³ï¼ä»éè¿ Class å¯¹è±¡å°±å¯ä»¥åå»ºæ­¤ç±»çå®ä¾å¯¹è±¡ï¼èä¸ä¸éè¦è°ç¨å¶æé å½æ°ãåå§åä»£ç ãJVM å®å¨æ£æ¥ç­ãå®æå¶ä¿®é¥°ç¬¦æ£æµï¼ä¹å°±æ¯å³ä½¿æé å¨æ¯ private ä¿®é¥°çä¹è½éè¿æ­¤æ¹æ³å®ä¾åï¼åªéæç±»å¯¹è±¡å³å¯åå»ºç¸åºçå¯¹è±¡ãç±äºè¿ç§ç¹æ§ï¼allocateInstance å¨ java.lang.invokeãObjenesisï¼æä¾ç»è¿ç±»æé å¨çå¯¹è±¡çææ¹å¼ï¼ãGsonï¼ååºååæ¶ç¨å°ï¼ä¸­é½æç¸åºçåºç¨ã</li>
</ul>
<h2 id="æ°ç»æä½">æ°ç»æä½</h2>
<h3 id="ä»ç»-4">ä»ç»</h3>
<p><code>arrayBaseOffset</code> ä¸ <code>arrayIndexScale</code> è¿ä¸¤ä¸ªæ¹æ³éåèµ·æ¥ä½¿ç¨ï¼å³å¯å®ä½æ°ç»ä¸­æ¯ä¸ªåç´ å¨åå­ä¸­çä½ç½®ã</p>
<pre><code class="language-java">//è¿åæ°ç»ä¸­ç¬¬ä¸ä¸ªåç´ çåç§»å°å
public native int arrayBaseOffset(Class&lt;?&gt; arrayClass);
//è¿åæ°ç»ä¸­ä¸ä¸ªåç´ å ç¨çå¤§å°
public native int arrayIndexScale(Class&lt;?&gt; arrayClass);
</code></pre>
<h3 id="å¸ååºç¨-3">å¸ååºç¨</h3>
<p>è¿ä¸¤ä¸ªä¸æ°æ®æä½ç¸å³çæ¹æ³ï¼å¨ <code>java.util.concurrent.atomic</code> åä¸ç <code>AtomicIntegerArray</code>ï¼å¯ä»¥å®ç°å¯¹ <code>Integer</code> æ°ç»ä¸­æ¯ä¸ªåç´ çåå­æ§æä½ï¼ä¸­æå¸åçåºç¨ï¼å¦ä¸å¾ <code>AtomicIntegerArray</code> æºç æç¤ºï¼éè¿ <code>Unsafe</code> ç <code>arrayBaseOffset</code>ã<code>arrayIndexScale</code> åå«è·åæ°ç»é¦åç´ çåç§»å°å <code>base</code> ååä¸ªåç´ å¤§å°å å­ <code>scale</code> ãåç»­ç¸å³åå­æ§æä½ï¼åä¾èµäºè¿ä¸¤ä¸ªå¼è¿è¡æ°ç»ä¸­åç´ çå®ä½ï¼å¦ä¸å¾äºæç¤ºç <code>getAndAdd</code> æ¹æ³å³éè¿ <code>checkedByteOffset</code> æ¹æ³è·åææ°ç»åç´ çåç§»å°åï¼èåéè¿ CAS å®ç°åå­æ§æä½ã</p>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202406202130522.png" alt="" loading="lazy"></p>
<h2 id="cas-æä½">CAS æä½</h2>
<h3 id="ä»ç»-5">ä»ç»</h3>
<p>è¿é¨åä¸»è¦ä¸º CAS ç¸å³æä½çæ¹æ³ã</p>
<pre><code class="language-java">/**
  *  CAS
  * @param o         åå«è¦ä¿®æ¹fieldçå¯¹è±¡
  * @param offset    å¯¹è±¡ä¸­æfieldçåç§»é
  * @param expected  ææå¼
  * @param update    æ´æ°å¼
  * @return          true | false
  */
public final native boolean compareAndSwapObject(Object o, long offset,  Object expected, Object update);

public final native boolean compareAndSwapInt(Object o, long offset, int expected,int update);

public final native boolean compareAndSwapLong(Object o, long offset, long expected, long update);
</code></pre>
<p><strong>ä»ä¹æ¯ CAS?</strong> CAS å³æ¯è¾å¹¶æ¿æ¢ï¼Compare And Swap)ï¼æ¯å®ç°å¹¶åç®æ³æ¶å¸¸ç¨å°çä¸ç§ææ¯ãCAS æä½åå«ä¸ä¸ªæä½æ°ââåå­ä½ç½®ãé¢æåå¼åæ°å¼ãæ§è¡ CAS æä½çæ¶åï¼å°åå­ä½ç½®çå¼ä¸é¢æåå¼æ¯è¾ï¼å¦æç¸å¹éï¼é£ä¹å¤çå¨ä¼èªå¨å°è¯¥ä½ç½®å¼æ´æ°ä¸ºæ°å¼ï¼å¦åï¼å¤çå¨ä¸åä»»ä½æä½ãæä»¬é½ç¥éï¼CAS æ¯ä¸æ¡ CPU çåå­æä»¤ï¼cmpxchg æä»¤ï¼ï¼ä¸ä¼é ææè°çæ°æ®ä¸ä¸è´é®é¢ï¼<code>Unsafe</code> æä¾ç CAS æ¹æ³ï¼å¦ <code>compareAndSwapXXX</code>ï¼åºå±å®ç°å³ä¸º CPU æä»¤ <code>cmpxchg</code> ã</p>
<h3 id="å¸ååºç¨-4">å¸ååºç¨</h3>
<p>å¨ JUC åçå¹¶åå·¥å·ç±»ä¸­å¤§éå°ä½¿ç¨äº CAS æä½ï¼åå¨åé¢ä»ç»<code>synchronized</code>å<code>AQS</code>çæç« ä¸­ä¹å¤æ¬¡æå°äº CASï¼å¶ä½ä¸ºä¹è§éå¨å¹¶åå·¥å·ç±»ä¸­å¹¿æ³åæ¥äºä½ç¨ãå¨ <code>Unsafe</code> ç±»ä¸­ï¼æä¾äº<code>compareAndSwapObject</code>ã<code>compareAndSwapInt</code>ã<code>compareAndSwapLong</code>æ¹æ³æ¥å®ç°çå¯¹<code>Object</code>ã<code>int</code>ã<code>long</code>ç±»åç CAS æä½ãä»¥<code>compareAndSwapInt</code>æ¹æ³ä¸ºä¾ï¼</p>
<pre><code class="language-java">public final native boolean compareAndSwapInt(Object o, long offset,int expected,int x);
</code></pre>
<p>åæ°ä¸­<code>o</code>ä¸ºéè¦æ´æ°çå¯¹è±¡ï¼<code>offset</code>æ¯å¯¹è±¡<code>o</code>ä¸­æ´å½¢å­æ®µçåç§»éï¼å¦æè¿ä¸ªå­æ®µçå¼ä¸<code>expected</code>ç¸åï¼åå°å­æ®µçå¼è®¾ä¸º<code>x</code>è¿ä¸ªæ°å¼ï¼å¹¶ä¸æ­¤æ´æ°æ¯ä¸å¯è¢«ä¸­æ­çï¼ä¹å°±æ¯ä¸ä¸ªåå­æä½ãä¸é¢æ¯ä¸ä¸ªä½¿ç¨<code>compareAndSwapInt</code>çä¾å­ï¼</p>
<pre><code class="language-java">private volatile int a;
public static void main(String[] args){
    CasTest casTest=new CasTest();
    new Thread(()-&gt;{
        for (int i = 1; i &lt; 5; i++) {
            casTest.increment(i);
            System.out.print(casTest.a+" ");
        }
    }).start();
    new Thread(()-&gt;{
        for (int i = 5 ; i &lt;10 ; i++) {
            casTest.increment(i);
            System.out.print(casTest.a+" ");
        }
    }).start();
}

private void increment(int x){
    while (true){
        try {
            long fieldOffset = unsafe.objectFieldOffset(CasTest.class.getDeclaredField("a"));
            if (unsafe.compareAndSwapInt(this,fieldOffset,x-1,x))
                break;
        } catch (NoSuchFieldException e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<p>è¿è¡ä»£ç ä¼ä¾æ¬¡è¾åºï¼</p>
<pre><code class="language-plain">1 2 3 4 5 6 7 8 9
</code></pre>
<p>å¨ä¸é¢çä¾å­ä¸­ï¼ä½¿ç¨ä¸¤ä¸ªçº¿ç¨å»ä¿®æ¹<code>int</code>åå±æ§<code>a</code>çå¼ï¼å¹¶ä¸åªæå¨<code>a</code>çå¼ç­äºä¼ å¥çåæ°<code>x</code>åä¸æ¶ï¼æä¼å°<code>a</code>çå¼åä¸º<code>x</code>ï¼ä¹å°±æ¯å®ç°å¯¹<code>a</code>çå ä¸çæä½ãæµç¨å¦ä¸æç¤ºï¼</p>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202406202130526.png" alt="" loading="lazy"></p>
<p>éè¦æ³¨æçæ¯ï¼å¨è°ç¨<code>compareAndSwapInt</code>æ¹æ³åï¼ä¼ç´æ¥è¿å<code>true</code>æ<code>false</code>çä¿®æ¹ç»æï¼å æ­¤éè¦æä»¬å¨ä»£ç ä¸­æå¨æ·»å èªæçé»è¾ãå¨<code>AtomicInteger</code>ç±»çè®¾è®¡ä¸­ï¼ä¹æ¯éç¨äºå°<code>compareAndSwapInt</code>çç»æä½ä¸ºå¾ªç¯æ¡ä»¶ï¼ç´è³ä¿®æ¹æåæéåºæ­»å¾ªç¯çæ¹å¼æ¥å®ç°çåå­æ§çèªå¢æä½ã</p>
<h2 id="çº¿ç¨è°åº¦">çº¿ç¨è°åº¦</h2>
<h3 id="ä»ç»-6">ä»ç»</h3>
<p><code>Unsafe</code> ç±»ä¸­æä¾äº<code>park</code>ã<code>unpark</code>ã<code>monitorEnter</code>ã<code>monitorExit</code>ã<code>tryMonitorEnter</code>æ¹æ³è¿è¡çº¿ç¨è°åº¦ã</p>
<pre><code class="language-java">//åæ¶é»å¡çº¿ç¨
public native void unpark(Object thread);
//é»å¡çº¿ç¨
public native void park(boolean isAbsolute, long time);
//è·å¾å¯¹è±¡éï¼å¯éå¥éï¼
@Deprecated
public native void monitorEnter(Object o);
//éæ¾å¯¹è±¡é
@Deprecated
public native void monitorExit(Object o);
//å°è¯è·åå¯¹è±¡é
@Deprecated
public native boolean tryMonitorEnter(Object o);
</code></pre>
<p>æ¹æ³ <code>park</code>ã<code>unpark</code> å³å¯å®ç°çº¿ç¨çæèµ·ä¸æ¢å¤ï¼å°ä¸ä¸ªçº¿ç¨è¿è¡æèµ·æ¯éè¿ <code>park</code> æ¹æ³å®ç°çï¼è°ç¨ <code>park</code> æ¹æ³åï¼çº¿ç¨å°ä¸ç´é»å¡ç´å°è¶æ¶æèä¸­æ­ç­æ¡ä»¶åºç°ï¼<code>unpark</code> å¯ä»¥ç»æ­¢ä¸ä¸ªæèµ·ççº¿ç¨ï¼ä½¿å¶æ¢å¤æ­£å¸¸ã</p>
<p>æ­¤å¤ï¼<code>Unsafe</code> æºç ä¸­<code>monitor</code>ç¸å³çä¸ä¸ªæ¹æ³å·²ç»è¢«æ è®°ä¸º<code>deprecated</code>ï¼ä¸å»ºè®®è¢«ä½¿ç¨ï¼</p>
<pre><code class="language-java">//è·å¾å¯¹è±¡é
@Deprecated
public native void monitorEnter(Object var1);
//éæ¾å¯¹è±¡é
@Deprecated
public native void monitorExit(Object var1);
//å°è¯è·å¾å¯¹è±¡é
@Deprecated
public native boolean tryMonitorEnter(Object var1);
</code></pre>
<p><code>monitorEnter</code>æ¹æ³ç¨äºè·å¾å¯¹è±¡éï¼<code>monitorExit</code>ç¨äºéæ¾å¯¹è±¡éï¼å¦æå¯¹ä¸ä¸ªæ²¡æè¢«<code>monitorEnter</code>å éçå¯¹è±¡æ§è¡æ­¤æ¹æ³ï¼ä¼æåº<code>IllegalMonitorStateException</code>å¼å¸¸ã<code>tryMonitorEnter</code>æ¹æ³å°è¯è·åå¯¹è±¡éï¼å¦ææååè¿å<code>true</code>ï¼åä¹è¿å<code>false</code>ã</p>
<h3 id="å¸ååºç¨-5">å¸ååºç¨</h3>
<p>Java éååæ­¥å¨æ¡æ¶çæ ¸å¿ç±» <code>AbstractQueuedSynchronizer</code> (AQS)ï¼å°±æ¯éè¿è°ç¨<code>LockSupport.park()</code>å<code>LockSupport.unpark()</code>å®ç°çº¿ç¨çé»å¡åå¤éçï¼è <code>LockSupport</code> ç <code>park</code>ã<code>unpark</code> æ¹æ³å®éæ¯è°ç¨ <code>Unsafe</code> ç <code>park</code>ã<code>unpark</code> æ¹å¼å®ç°çã</p>
<pre><code class="language-java">public static void park(Object blocker) {
    Thread t = Thread.currentThread();
    setBlocker(t, blocker);
    UNSAFE.park(false, 0L);
    setBlocker(t, null);
}
public static void unpark(Thread thread) {
    if (thread != null)
        UNSAFE.unpark(thread);
}
</code></pre>
<p><code>LockSupport</code> ç<code>park</code>æ¹æ³è°ç¨äº <code>Unsafe</code> ç<code>park</code>æ¹æ³æ¥é»å¡å½åçº¿ç¨ï¼æ­¤æ¹æ³å°çº¿ç¨é»å¡åå°±ä¸ä¼ç»§ç»­å¾åæ§è¡ï¼ç´å°æå¶ä»çº¿ç¨è°ç¨<code>unpark</code>æ¹æ³å¤éå½åçº¿ç¨ãä¸é¢çä¾å­å¯¹ <code>Unsafe</code> çè¿ä¸¤ä¸ªæ¹æ³è¿è¡æµè¯ï¼</p>
<pre><code class="language-java">public static void main(String[] args) {
    Thread mainThread = Thread.currentThread();
    new Thread(()-&gt;{
        try {
            TimeUnit.SECONDS.sleep(5);
            System.out.println("subThread try to unpark mainThread");
            unsafe.unpark(mainThread);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }).start();

    System.out.println("park main mainThread");
    unsafe.park(false,0L);
    System.out.println("unpark mainThread success");
}
</code></pre>
<p>ç¨åºè¾åºä¸ºï¼</p>
<pre><code class="language-plain">park main mainThread
subThread try to unpark mainThread
unpark mainThread success
</code></pre>
<p>ç¨åºè¿è¡çæµç¨ä¹æ¯è¾å®¹æçæï¼å­çº¿ç¨å¼å§è¿è¡ååè¿è¡ç¡ç ï¼ç¡®ä¿ä¸»çº¿ç¨è½å¤è°ç¨<code>park</code>æ¹æ³é»å¡èªå·±ï¼å­çº¿ç¨å¨ç¡ç  5 ç§åï¼è°ç¨<code>unpark</code>æ¹æ³å¤éä¸»çº¿ç¨ï¼ä½¿ä¸»çº¿ç¨è½ç»§ç»­åä¸æ§è¡ãæ´ä¸ªæµç¨å¦ä¸å¾æç¤ºï¼</p>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202406202130484.png" alt="" loading="lazy"></p>
<h2 id="class-æä½">Class æä½</h2>
<h3 id="ä»ç»-7">ä»ç»</h3>
<p><code>Unsafe</code> å¯¹<code>Class</code>çç¸å³æä½ä¸»è¦åæ¬ç±»å è½½åéæåéçæä½æ¹æ³ã</p>
<p><strong>éæå±æ§è¯»åç¸å³çæ¹æ³</strong></p>
<pre><code class="language-java">//è·åéæå±æ§çåç§»é
public native long staticFieldOffset(Field f);
//è·åéæå±æ§çå¯¹è±¡æé
public native Object staticFieldBase(Field f);
//å¤æ­ç±»æ¯å¦éè¦åå§åï¼ç¨äºè·åç±»çéæå±æ§åè¿è¡æ£æµï¼
public native boolean shouldBeInitialized(Class&lt;?&gt; c);
</code></pre>
<p>åå»ºä¸ä¸ªåå«éæå±æ§çç±»ï¼è¿è¡æµè¯ï¼</p>
<pre><code class="language-java">@Data
public class User {
    public static String name="Hydra";
    int age;
}
private void staticTest() throws Exception {
    User user=new User();
    // ä¹å¯ä»¥ç¨ä¸é¢çè¯­å¥è§¦åç±»åå§å
    // 1.
    // unsafe.ensureClassInitialized(User.class);
    // 2.
    // System.out.println(User.name);
    System.out.println(unsafe.shouldBeInitialized(User.class));
    Field sexField = User.class.getDeclaredField("name");
    long fieldOffset = unsafe.staticFieldOffset(sexField);
    Object fieldBase = unsafe.staticFieldBase(sexField);
    Object object = unsafe.getObject(fieldBase, fieldOffset);
    System.out.println(object);
}
</code></pre>
<p>è¿è¡ç»æï¼</p>
<pre><code class="language-plain">false
Hydra
</code></pre>
<p>å¨ <code>Unsafe</code> çå¯¹è±¡æä½ä¸­ï¼æä»¬å­¦ä¹ äºéè¿<code>objectFieldOffset</code>æ¹æ³è·åå¯¹è±¡å±æ§åç§»éå¹¶åºäºå®å¯¹åéçå¼è¿è¡å­åï¼ä½æ¯å®ä¸éç¨äºç±»ä¸­çéæå±æ§ï¼è¿æ¶åå°±éè¦ä½¿ç¨<code>staticFieldOffset</code>æ¹æ³ãå¨ä¸é¢çä»£ç ä¸­ï¼åªæå¨è·å<code>Field</code>å¯¹è±¡çè¿ç¨ä¸­ä¾èµå°äº<code>Class</code>ï¼èè·åéæåéçå±æ§æ¶ä¸åä¾èµäº<code>Class</code>ã</p>
<p>å¨ä¸é¢çä»£ç ä¸­é¦ååå»ºä¸ä¸ª<code>User</code>å¯¹è±¡ï¼è¿æ¯å ä¸ºå¦æä¸ä¸ªç±»æ²¡æè¢«åå§åï¼é£ä¹å®çéæå±æ§ä¹ä¸ä¼è¢«åå§åï¼æåè·åçå­æ®µå±æ§å°æ¯<code>null</code>ãæä»¥å¨è·åéæå±æ§åï¼éè¦è°ç¨<code>shouldBeInitialized</code>æ¹æ³ï¼å¤æ­å¨è·ååæ¯å¦éè¦åå§åè¿ä¸ªç±»ãå¦æå é¤åå»º User å¯¹è±¡çè¯­å¥ï¼è¿è¡ç»æä¼åä¸ºï¼</p>
<pre><code class="language-plain">true
null
</code></pre>
<p><strong>ä½¿ç¨<code>defineClass</code>æ¹æ³åè®¸ç¨åºå¨è¿è¡æ¶å¨æå°åå»ºä¸ä¸ªç±»</strong></p>
<pre><code class="language-java">public native Class&lt;?&gt; defineClass(String name, byte[] b, int off, int len, ClassLoader loader,ProtectionDomain protectionDomain);
</code></pre>
<p>å¨å®éä½¿ç¨è¿ç¨ä¸­ï¼å¯ä»¥åªä¼ å¥å­èæ°ç»ãèµ·å§å­èçä¸æ ä»¥åè¯»åçå­èé¿åº¦ï¼é»è®¤æåµä¸ï¼ç±»å è½½å¨ï¼<code>ClassLoader</code>ï¼åä¿æ¤åï¼<code>ProtectionDomain</code>ï¼æ¥æºäºè°ç¨æ­¤æ¹æ³çå®ä¾ãä¸é¢çä¾å­ä¸­å®ç°äºåç¼è¯çæåç class æä»¶çåè½ï¼</p>
<pre><code class="language-java">private static void defineTest() {
    String fileName="F:\\workspace\\unsafe-test\\target\\classes\\com\\cn\\model\\User.class";
    File file = new File(fileName);
    try(FileInputStream fis = new FileInputStream(file)) {
        byte[] content=new byte[(int)file.length()];
        fis.read(content);
        Class clazz = unsafe.defineClass(null, content, 0, content.length, null, null);
        Object o = clazz.newInstance();
        Object age = clazz.getMethod("getAge").invoke(o, null);
        System.out.println(age);
    } catch (Exception e) {
        e.printStackTrace();
    }
}
</code></pre>
<p>å¨ä¸é¢çä»£ç ä¸­ï¼é¦åè¯»åäºä¸ä¸ª<code>class</code>æä»¶å¹¶éè¿æä»¶æµå°å®è½¬åä¸ºå­èæ°ç»ï¼ä¹åä½¿ç¨<code>defineClass</code>æ¹æ³å¨æçåå»ºäºä¸ä¸ªç±»ï¼å¹¶å¨åç»­å®æäºå®çå®ä¾åå·¥ä½ï¼æµç¨å¦ä¸å¾æç¤ºï¼å¹¶ä¸éè¿è¿ç§æ¹å¼åå»ºçç±»ï¼ä¼è·³è¿ JVM çææå®å¨æ£æ¥ã</p>
<p><img src="https://oss.javaguide.cn/github/javaguide/java/basis/unsafe/image-20220717145000710.png" alt="" loading="lazy"></p>
<p>é¤äº<code>defineClass</code>æ¹æ³å¤ï¼Unsafe è¿æä¾äºä¸ä¸ª<code>defineAnonymousClass</code>æ¹æ³ï¼</p>
<pre><code class="language-java">public native Class&lt;?&gt; defineAnonymousClass(Class&lt;?&gt; hostClass, byte[] data, Object[] cpPatches);
</code></pre>
<p>ä½¿ç¨è¯¥æ¹æ³å¯ä»¥ç¨æ¥å¨æçåå»ºä¸ä¸ªå¿åç±»ï¼å¨<code>Lambda</code>è¡¨è¾¾å¼ä¸­å°±æ¯ä½¿ç¨ ASM å¨æçæå­èç ï¼ç¶åå©ç¨è¯¥æ¹æ³å®ä¹å®ç°ç¸åºçå½æ°å¼æ¥å£çå¿åç±»ãå¨ JDK 15 åå¸çæ°ç¹æ§ä¸­ï¼å¨éèç±»ï¼<code>Hidden classes</code>ï¼ä¸æ¡ä¸­ï¼æåºå°å¨æªæ¥ççæ¬ä¸­å¼ç¨ <code>Unsafe</code> ç<code>defineAnonymousClass</code>æ¹æ³ã</p>
<h3 id="å¸ååºç¨-6">å¸ååºç¨</h3>
<p>Lambda è¡¨è¾¾å¼å®ç°éè¦ä¾èµ <code>Unsafe</code> ç <code>defineAnonymousClass</code> æ¹æ³å®ä¹å®ç°ç¸åºçå½æ°å¼æ¥å£çå¿åç±»ã</p>
<h2 id="ç³»ç»ä¿¡æ¯">ç³»ç»ä¿¡æ¯</h2>
<h3 id="ä»ç»-8">ä»ç»</h3>
<p>è¿é¨ååå«ä¸¤ä¸ªè·åç³»ç»ç¸å³ä¿¡æ¯çæ¹æ³ã</p>
<pre><code class="language-java">//è¿åç³»ç»æéçå¤§å°ãè¿åå¼ä¸º4ï¼32ä½ç³»ç»ï¼æ 8ï¼64ä½ç³»ç»ï¼ã
public native int addressSize();
//åå­é¡µçå¤§å°ï¼æ­¤å¼ä¸º2çå¹æ¬¡æ¹ã
public native int pageSize();
</code></pre>
<h3 id="å¸ååºç¨-7">å¸ååºç¨</h3>
<p>è¿ä¸¤ä¸ªæ¹æ³çåºç¨åºæ¯æ¯è¾å°ï¼å¨<code>java.nio.Bits</code>ç±»ä¸­ï¼å¨ä½¿ç¨<code>pageCount</code>è®¡ç®æéçåå­é¡µçæ°éæ¶ï¼è°ç¨äº<code>pageSize</code>æ¹æ³è·ååå­é¡µçå¤§å°ãå¦å¤ï¼å¨ä½¿ç¨<code>copySwapMemory</code>æ¹æ³æ·è´åå­æ¶ï¼è°ç¨äº<code>addressSize</code>æ¹æ³ï¼æ£æµ 32 ä½ç³»ç»çæåµã</p>
<h2 id="unsafeåºå±">Unsafeåºå±</h2>
<p>åççUnsafeçcompareAndSwap æ¹æ³æ¥å®ç°CASæä½ï¼å®æ¯ä¸ä¸ªæ¬å°æ¹æ³ï¼å®ç°ä½äºunsafe.cppä¸­ã</p>
<pre><code class="language-java">UNSAFE_ENTRY(jboolean, Unsafe_CompareAndSwapInt(JNIEnv *env, jobject unsafe, jobject obj, jlong offset, jint e, jint x))
  UnsafeWrapper("Unsafe_CompareAndSwapInt");
  oop p = JNIHandles::resolve(obj);
  jint* addr = (jint *) index_oop_from_field_offset_long(p, offset);
  return (jint)(Atomic::cmpxchg(x, addr, e)) == e;
UNSAFE_END
</code></pre>
<p>å¯ä»¥çå°å®éè¿ Atomic::cmpxchg æ¥å®ç°æ¯è¾åæ¿æ¢æä½ãå¶ä¸­åæ°xæ¯å³å°æ´æ°çå¼ï¼åæ°eæ¯ååå­çå¼ã</p>
<p>å¦ææ¯Linuxçx86ï¼Atomic::cmpxchgæ¹æ³çå®ç°å¦ä¸ï¼</p>
<pre><code class="language-java">inline jint Atomic::cmpxchg (jint exchange_value, volatile jint* dest, jint compare_value) {
  int mp = os::is_MP();
  __asm__ volatile (LOCK_IF_MP(%4) "cmpxchgl %1,(%3)"
                    : "=a" (exchange_value)
                    : "r" (exchange_value), "a" (compare_value), "r" (dest), "r" (mp)
                    : "cc", "memory");
  return exchange_value;
}
</code></pre>
<p>èwindowsçx86çå®ç°å¦ä¸ï¼</p>
<pre><code class="language-java">inline jint Atomic::cmpxchg (jint exchange_value, volatile jint* dest, jint compare_value) {
    int mp = os::isMP(); //å¤æ­æ¯å¦æ¯å¤å¤çå¨
    _asm {
        mov edx, dest
        mov ecx, exchange_value
        mov eax, compare_value
        LOCK_IF_MP(mp)
        cmpxchg dword ptr [edx], ecx
    }
}

// Adding a lock prefix to an instruction on MP machine
// VC++ doesn't like the lock prefix to be on a single line
// so we can't insert a label after the lock prefix.
// By emitting a lock prefix, we can define a label after it.
#define LOCK_IF_MP(mp) __asm cmp mp, 0  \
                       __asm je L0      \
                       __asm _emit 0xF0 \
                       __asm L0:
</code></pre>
<p>å¦ææ¯å¤å¤çå¨ï¼ä¸ºcmpxchgæä»¤æ·»å lockåç¼ãåä¹ï¼å°±çç¥lockåç¼(åå¤çå¨ä¼ä¸éè¦lockåç¼æä¾çåå­å±éææ)ãè¿éçlockåç¼å°±æ¯ä½¿ç¨äºå¤çå¨çæ»çº¿é(ææ°çå¤çå¨é½ä½¿ç¨ç¼å­éä»£æ¿æ»çº¿éæ¥æé«æ§è½)ã</p>
<blockquote>
<p>cmpxchg(void* ptr, int old, int new)ï¼å¦æptråoldçå¼ä¸æ ·ï¼åænewåå°ptråå­ï¼å¦åè¿åptrçå¼ï¼æ´ä¸ªæä½æ¯åå­çãå¨Intelå¹³å°ä¸ï¼ä¼ç¨lock cmpxchgæ¥å®ç°ï¼ä½¿ç¨lockè§¦åç¼å­éï¼è¿æ ·å¦ä¸ä¸ªçº¿ç¨æ³è®¿é®ptrçåå­ï¼å°±ä¼è¢«blockä½ã</p>
</blockquote>


</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªå¨çº¿ç½ç«ï¼sevençèé¸æé¿ä¹è·¯ï¼ä½èï¼sevenï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼www.seven97.top</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-06 09:00">2026-02-06 09:00</span>&nbsp;
<a href="https://www.cnblogs.com/sevencoding">ç¨åºåSeven</a>&nbsp;
éè¯»(<span id="post_view_count">4</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19559023);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19559023', targetLink: 'https://www.cnblogs.com/sevencoding/p/19559023', title: 'Unsafeé­æ³ç±»æ·±åº¦è§£æï¼Javaåºå±æä½çç»ææå' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>