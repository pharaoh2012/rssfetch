<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-01-15T01:16:08.967Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ è§£å¯Promptç³»å68. åå«éè¯è¹¦å­ - éå¡ Transformer çæ¨çèå¼ ]]></title>
    <link>https://www.cnblogs.com/gogoSandy/p/19485562</link>
    <guid>dbed24fb24cd113f1587914b698bf929</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/gogoSandy/p/19485562" title="åå¸äº 2026-01-15 08:52">
    <span role="heading" aria-level="2">è§£å¯Promptç³»å68. åå«éè¯è¹¦å­ - éå¡ Transformer çæ¨çèå¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/1326688/202601/1326688-20260115085201383-1680160121.png" alt="è§£å¯Promptç³»å68. åå«éè¯è¹¦å­ - éå¡ Transformer çæ¨çèå¼" class="desc_img">
        æ¢æèçæ¬è´¨ä¾ç¶æ¯éè¿çææ´å¤çæ¾æ§ Token æ¥æ¢åè®¡ç®æ¶é´ãä¸ºäºæ³å¾æ·±ï¼å¿é¡»è¯´å¾å¤ãè¿ä¸ç« çåç¯è®ºæé½å¨å°è¯ï¼è½å¦å¨ä¸è¾åºåºè¯çæåµä¸ï¼è®©æ¨¡åå¨åé¨âç©ºè½¬âæèï¼ çè³æç ´èªåå½å¨å±è§åï¼
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>Transformer çæ ¸å¿èå¼ä¸ç´æ¯âNext Token Predictionâââåæ¥é¾ä¸æ ·ï¼ä¸ä¸ªè¯ä¸ä¸ªè¯å°å¾åè¹¦ãè½ç¶ OpenAI o1 å DeepSeek-R1 éè¿ Chain of Thought (CoT) å¼å¯äºâæ¢æèâæ¶ä»£ï¼ä½å¶æ¬è´¨ä¾ç¶æ¯éè¿çææ´å¤çæ¾æ§ Token æ¥æ¢åè®¡ç®æ¶é´ã</p>
<p>è¿å°±å¸¦æ¥äºä¸ä¸ªå·¨å¤§çæçæè®ºï¼ä¸ºäºæ³å¾æ·±ï¼å¿é¡»è¯´å¾å¤ãè¿ä¸ç« æä»¬çåç¯æå·ä»£è¡¨æ§çè®ºæï¼Huginn, COCONUT, TRM, TiDARï¼ï¼å®ä»¬ä¸çº¦èåå°è¯å¾æç ´è¿ä¸å±éï¼è½å¦å¨ä¸è¾åºåºè¯çæåµä¸ï¼è®©æ¨¡åå¨åé¨âç©ºè½¬âæèï¼ çè³æç ´èªåå½çæç¼ï¼è¿è¡å¨å±è§åï¼</p>
<h1 id="huginåçå¾ªç¯æèæåæ·±åº¦">Huginï¼åçå¾ªç¯æèæåæ·±åº¦</h1>
<blockquote>
<ul>
<li>Scaling up Test-Time Compute with Latent Reasoning: A Recurrent Depth Approach</li>
</ul>
</blockquote>
<p>è¿ç¯è®ºæçæ ¸å¿å¨äºæç ´å¤§æ¨¡åæ¨çæ¶è®¡ç®éæå®çéå¶ï¼æåºäºä¸ç§å¨âæ·±åº¦âä¸è¿è¡å¾ªç¯çæ¶æï¼ä»èå®ç°äºå¨<strong>éç©ºé´ï¼Latent Spaceï¼</strong>è¿è¡éå½æ¨çã</p>
<h2 id="-æ ¸å¿çç¹åºå®è®¡ç®å¾ä¸å¨æé¾åº¦ççç¾">ð¨ æ ¸å¿çç¹ï¼åºå®è®¡ç®å¾ä¸å¨æé¾åº¦ççç¾</h2>
<p>ä¼ ç»ç LLM ä¸æ¦è®­ç»å®æï¼å¶å±æ°ï¼Depthï¼æ¯åºå®çãè¿æå³çæ è®ºè¾å¥æ¯ç®åçâ1+1âè¿æ¯å¤æçæ°å­¦è¯æï¼æ¨¡åå¨çææ¯ä¸ä¸ª Token æ¶æ¶èç FLOPsæ¯ä¸æ ·ç ãè¿æ¾ç¶ä¸ç¬¦åç´è§ââé¾é¢åºè¯¥éè¦æ´å¤çâæèæ¶é´âãå æ­¤æä»¬æäºCOTåç°å¨çReasoningæ¨¡å¼ã</p>
<ul>
<li>ç°ç¶ï¼ä¸ºäºå¤çé¾é¢ï¼ç°å¨ç CoT ç­ç¥ä¸å¾ä¸å¼ºè¿«æ¨¡åâèªè¨èªè¯­âçæå¤§é Tokenï¼è¿å¯¼è´äºæ¾å­ï¼KV Cacheï¼ççç¸å¼å¢é¿åæ¨çéåº¦ççº¿æ§ä¸éã</li>
<li>ç®æ ï¼è½å¦è®©æ¨¡åå¨åé¨âåä¸æ¥æ³ä¸ä¼å¿âï¼ä½ä¸å ç¨è¾åºå¸¦å®½ï¼</li>
</ul>
<h2 id="ï¸è§£å³æ¹æ¡å¾ªç¯æ·±åº¦æ¶æ">ð ï¸è§£å³æ¹æ¡ï¼å¾ªç¯æ·±åº¦æ¶æ</h2>
<p>Huginn æåºäºä¸ç§ç¹æ®çæ¶æè®¾è®¡ï¼è¯å¾å¨ Transformer ä¸­åçå®ç°âæ¢æèâã<br>
<img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1326688/202601/1326688-20260115085105177-208095282.png" class="lazyload"></p>
<p>å¦ä¸å¾ï¼æ¨¡ååæ¬ä¸ä¸ªé¨å</p>
<ul>
<li>ï¼Pï¼Prelude: ç¸å½äºEncoderå±ï¼è´è´£å° Input Token æ å°ä¸ºéç¶æã</li>
<li>ï¼Rï¼recurrent block: è¿æ¯ä¸ä¸ªå¤å±Transformer Layerï¼ææçæèé½åçå¨è¿éï¼ä½æ¯åä¼ ç»Transformerä¸åçç¹å¨äºï¼è¿ä¸ªæ¨¡åå¯ä»¥å¾ªç¯è¿è¡ä»»ææ¬¡ã</li>
<li>ï¼Cï¼Codaï¼ç¸å½äºè¾åºå¤´ï¼å¯¹æèå®æçéç¶æè¿è¡tokenè§£ç çæã</li>
</ul>
<p><strong>è¿æ¬è´¨ä¸æ¯âå±åæ°å±äº«âçæè´åºç¨</strong>ã æ¨¡åéè¿å¨æå³å® R æ¨¡åå¾ªç¯çæ¬¡æ°ï¼å®ç°äºå¨åæ°éä¸åçæåµä¸ï¼å¨æè°æ´æ¨çæ¶çè®¡ç®æ·±åº¦ãä¸ºäºé²æ­¢æ·±å±å¾ªç¯å¯¼è´çæ¢¯åº¦æ¶å¤±æéå¿ï¼æ¨¡åå¨æ¯ä¸æ­¥å¾ªç¯é½ä¼æ³¨å¥åå§è¾å¥ç Embeddingï¼èµ·å°éç¹ï¼Anchorï¼çä½ç¨ã</p>
<h2 id="-æ·±åº¦æ´å¯">ð¡ æ·±åº¦æ´å¯</h2>
<ol>
<li>
<p><strong>é«ææ¨ç</strong>ï¼éå½æ¨¡åä¸äº§ççº¿æ§å¢é¿çKV-Cacheï¼åªæ¯ä¸æ­æ´æ°éå½åæ°</p>
</li>
<li>
<p><strong>é¾åº¦èªéåº</strong>ï¼å¯ä»¥éè¿æ§å¶éå½çè½®æ°æ¥å¯¹ä¸åé¾åº¦çé®é¢å®ç°èªéåºè®¡ç®ï¼ä¸éè¦å¯¹ææé¾åº¦çé®é¢è¿è¡ç»ä¸çæèæèä¸æè</p>
</li>
<li>
<p><strong>Test Time Scaling</strong>ï¼è®ºæåç°éå½çæ¨¡å¼åæ ·å­å¨Test-time scalingï¼æ´å¤çéå½æ¬¡æ°ä¼å¸¦æ¥æç»­çè¡¨ç°æåã</p>
</li>
</ol>
<h1 id="coconutæå¼è¯­è¨ç¨ç´è§æè">COCONUTï¼æå¼è¯­è¨ï¼ç¨âç´è§âæè</h1>
<blockquote>
<ul>
<li>Metaï¼ Training Large Language Models to Reason in a<br>
Continuous Latent Space</li>
</ul>
</blockquote>
<p>å¦æè¯´ Huginn æ¯å¨æ¶æå±é¢âæå âäºæ·±åº¦ï¼é£ä¹ COCONUTåæ¯å¨æç»´è½½ä½ä¸è¿è¡äºä¸æ¬¡é©å½ãå®è´¨çäºå¤§æ¨¡åæ¨ççä¸ä¸ªåºæ¬åè®¾ï¼ä¸ºä»ä¹æèçè¿ç¨å¿é¡»ç¨äººç±»è¯­è¨ï¼Tokensï¼æ¥è¡¨è¾¾ï¼</p>
<h2 id="æ ¸å¿çç¹è¯­è¨ç©ºé´çå±éæ§">ð¨æ ¸å¿çç¹ï¼è¯­è¨ç©ºé´çå±éæ§</h2>
<p>ç±OpenAI-O1æå¼åºå¹çReasoningæ¶ä»£ï¼å½åçæ¨çè¿ç¨ä¸è¬æ¯<br>
ï¼Hidden State <span class="math inline">\(\rightarrow\)</span> Logits <span class="math inline">\(\rightarrow\)</span> Sampling (Token) <span class="math inline">\(\rightarrow\)</span> Embedding <span class="math inline">\(\rightarrow\)</span> Next Inputã</p>
<p>è¿å°±å¼å¥äºä¸äºå±éæ§</p>
<ul>
<li><strong>ä¿¡æ¯ä¸¢å¤±</strong>ï¼å°é«ç»´è¿ç»­ç Hidden State åç¼©ä¸ºç¦»æ£ç Tokenï¼ä¼ä¸¢å¤±å¤§ééç»æåçâç´è§âä¿¡æ¯ãå°±åä½ èæµ·éæå¤§éä¿¡æ¯ï¼å´å¿é¡»ç¨ä¸å¥è¯è¯´åºæ¥ã</li>
<li><strong>æçä½ä¸</strong>ï¼å½CoT ä¸­åæ¥ç "Let's think step by step", "Therefore" ç­æ æä¹çè¿æ¥è¯ã</li>
<li><strong>çº¿æ§çº¦æ</strong>ï¼è¯­è¨æ¯çº¿æ§çï¼ä½æç»´å¾å¾æ¯åæ£çãç½ç¶çãä¹åå¾å¤parrallelæèçæ¹æ¡é½æ¯ä¸ºäºæç ´è¿ä¸ªçº¦æã</li>
</ul>
<h2 id="ï¸è§£å³æ¹æ¡è¿ç»­æç»´é¾">ð ï¸è§£å³æ¹æ¡ï¼è¿ç»­æç»´é¾</h2>
<p>COCONUT æåºäºä¸ç§Latent Modeãè½ç¶æ¶æä»åºäº Transformerï¼ä½å®æ¹åäºæ°æ®æµè½¬æ¹å¼ï¼</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1326688/202601/1326688-20260115085105194-1917453690.png" class="lazyload"></p>
<ol>
<li><strong>æ¨çæ¨¡å¼ï¼Latent Mode (éæ¨¡å¼)</strong></li>
</ol>
<p>Coconut å¼å¥äºä¸ç§æ°çæ¨çæ¨¡å¼ãæ¨¡åå¯ä»¥å¨Language ModeåLatent Modeä¹é´åæ¢ã</p>
<p>æºå¶ï¼å½æ¨¡åè¿å¥Latent Modeåï¼è¾åº&lt;bot&gt;ç¹æ®å­ç¬¦ï¼ï¼å®ä¸åå° Last Hidden State è§£ç ä¸º Tokenãèæ¯ç´æ¥å°è¿ä¸ª Hidden State ä½ä¸ºä¸ä¸æ­¥ç Input Embedding åç»æ¨¡åã</p>
<p>è¿å°±åæ¯æ¨¡åå¨âèªè¨èªè¯­âï¼ä½æ¯ç¨åªæå®èªå·±å¬å¾æçâèçµæ³¢âï¼åéï¼å¨äº¤æµï¼èä¸æ¯ç¨äººç±»è¯­è¨ãè¿ç§âè¿ç»­æç»´âä¸ç´æç»­å°æ¨¡åè¾åº&lt;eot&gt;ç¹æ®å­ç¬¦ï¼ç¶ååååè¯­è¨æ¨¡å¼è¾åºæç»ç­æ¡ã</p>
<ol start="2">
<li><strong>è®­ç»ç­ç¥ï¼å¤é¶æ®µè¯¾ç¨å­¦ä¹ </strong></li>
</ol>
<p>ä¸ºäºè®©æ¨¡åå­¦ä¼ä½¿ç¨ä¸è¿°çæèåéä¿¡æ¯ï¼è®ºæä½¿ç¨äºæ¸è¿å¼çè®­ç»æ¹æ¡ï¼å¦ä¸å¾</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1326688/202601/1326688-20260115085105334-1938958125.png" class="lazyload"></p>
<ul>
<li>Stage 0ï¼åç¨æ åç CoT æ°æ®è®­ç»æ¨¡åï¼è®©å®å­¦ä¼é»è¾ã</li>
<li>Stage 1 ~ kï¼éæ­¥âæ¦é¤âCoT ä¸­çææ¬ã
<ul>
<li>ä¾å¦ï¼å¨ Stage 1ï¼æ CoT çç¬¬ 1 æ­¥æ¨çææ¬å»æï¼æ¿æ¢ä¸º <span class="math inline">\(c\)</span> ä¸ª Continuous Thoughtsï¼éåéï¼ãæ¨¡åå¿é¡»å­¦ä¼ç¨è¿ <span class="math inline">\(c\)</span> ä¸ªåéæ¥æ¿è½½åæ¬é£å¥è¯çé»è¾ä¿¡æ¯</li>
<li>éçè®­ç»è¿è¡ï¼éæ­¥ææ´å¤çææ¬æ¨çæ­¥éª¤æ¿æ¢ä¸ºéåéã</li>
</ul>
</li>
<li>æç»å½¢æï¼ææçä¸­é´æ¨çææ¬é½è¢«âååâæäºè¿ç»­çéåéï¼æ¨¡ååªè¾åºæç»ç­æ¡ã</li>
</ul>
<h2 id="-æ·±åº¦æ´å¯-1">ð¡ æ·±åº¦æ´å¯</h2>
<ol>
<li><strong>æ ¸å¿è½åæ¶ç°ï¼éå¼ BFS (Implicit Breadth-First Search)</strong></li>
</ol>
<p>è¿æ¯æç²¾å½©çåç°ãç¸æ¯åæCOTæ¯çº¿æ§çï¼åä¸æ¶å»åªè½æ¨çä¸ä¸ªæè·¯ãä½COconutå ä¸ºHidden Stateæ¯é«ç»´è¿ç»­åéï¼æä»¥å®å¯ä»¥å¤äºâå å æâ,å¯ä»¥åæ¶ç¼ç å¤ä¸ªå¯è½çæ¨çè·¯å¾ãéå¼è¿è¡äºå¹¿åº¦æç´¢ã</p>
<ol start="2">
<li><strong>æ¨çæçæå</strong></li>
</ol>
<p>è½ç¶åHuginç¸æ¯ä¾æ§éè¦ä½¿ç¨KV-cacheï¼ä½å ä¸ºè¿ç»­åéçæ°éå¾å¾æ¾èå°äºtokenæ°ï¼æä»¥æ¨çæçä¼ææåï¼åæ¶ä¹å ä¸ºçç¥äºæ¨çtokenéæ ·çæ­¥éª¤ï¼èè¿ä¸æ­¥æåååã</p>
<ol start="3">
<li><strong>è¶è¶äººäºè¯­è¨æç»´å¯åº¦</strong></li>
</ol>
<p>å°¤å¶å¯¹äºä¸äºå¤æå¤è·¯å¾è§åä»»å¡ï¼ä»¥åé¨åéè¦<code>look ahead</code>æ¨ççä»»å¡ï¼å ä¸ºéåéæ¯tokenåå«å¹¿åº¦æ´å¤§çæèä¿¡æ¯ï¼å æ­¤æææææåã</p>
<p>çå°è¿éæä¹æä¸ªæ³æ³ï¼é»è¾ä¸hidden thoughtä¸å®ä¼æ¯tokenæºå¸¦æ´å¤çä¿¡æ¯éï¼ä½æå¤§çé®é¢å°±æ¯æ æ³å¯è§åï¼é£è½å¦æ³ä¸ä¼ï¼è¯´ä¸¤å¥ï¼æ³ä¸ä¼è¯´ä¸¤å¥ï¼ä¹å°±æ¯æhidden thoughtåtoken reasoningéè¿interleaveä¸²èèµ·æ¥ï¼</p>
<h1 id="trm-åæ¹ä»£ç ä¸æ ·è¿­ä»£æ¨ç">TRM: åæ¹ä»£ç ä¸æ ·è¿­ä»£æ¨ç</h1>
<blockquote>
<ul>
<li>Less is More: Recursive Reasoning with Tiny Networks</li>
</ul>
</blockquote>
<p>TRMååé¢çHuginæ¯éå¸¸ç¸ä¼¼çï¼å ä¹é½æ¯èµ°çâå¾ªç¯æç»´è½½ä½âçæè·¯ãä½æ¯TRMå¤äºåæµéå½çè®¾è®¡ï¼æå¾ªç¯è¿ç¨ä¸­çèç¨¿åæç£¨è¿ä¸¤ä¸ªä¸åä¿¡æ¯æåå¼å¤çã</p>
<p>åCOCONUTä¹æç¸ä¼¼ä¹å¤ï¼åªä¸è¿COCONUTæ´åæ¯æ½æè¯å¨æ¶é´è½´ä¸ï¼èªåå½æ¨çï¼çå»¶ä¼¸ï¼èTRMæ¯å¨è´¨éè½´ä¸çä¸æ­è¿­ä»£ä¿®æ­£ã</p>
<h2 id="-æ ¸å¿çç¹èªåå½çè½å­æ æ">ð¨ æ ¸å¿çç¹ï¼èªåå½çâè½å­æ æâ</h2>
<p>Reasoningæå¤§çé®é¢ï¼å°±æ¯åé¢COCONUTæå°çâè½å­æ æâé®é¢ï¼æ³è¦è¿ä¸æ­¥åææèä¿®æ­£ï¼å°±éè¦ç»§ç»­æ¾æ§å»¶ä¼¸ä½ çæèé¾è·¯è¿è¡åæã</p>
<p>è®ºæçç®æ ï¼è½å¦æå»ºä¸ä¸ªæ¨¡åï¼å®çæ¨çè¿ç¨ä¸æ¯âçæä¸ä¸ä¸ªè¯âï¼èæ¯ä¸æ­ä¿®æ­£å½åçç­æ¡ï¼è¿éè¦æ¨¡åå·å¤è¿­ä»£ä¿®æ­£çè½åã</p>
<h2 id="ï¸-è§£å³æ¹æ¡trm-tiny-recursive-model">ð ï¸ è§£å³æ¹æ¡ï¼TRM (Tiny Recursive Model)</h2>
<p>TRM çæ¶æè®¾è®¡éå¸¸ç²¾ç®ï¼å®ç´æ¥åå°äºææ¬è´¨çéå½ç»æï¼å¦ä¸å¾</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1326688/202601/1326688-20260115085105282-1502186343.png" class="lazyload"></p>
<ol>
<li><strong>åæµéå½ç¶æ</strong></li>
</ol>
<p>TRM ç»´æ¤ä¸¤ä¸ªæ ¸å¿ç¶æï¼å¹¶å¨å¾ªç¯ä¸­ä¸æ­æ´æ°å®ä»¬ ï¼</p>
<ul>
<li>Latent (Z)ï¼æ¨çç¶æãè¿åHuginnå¤æ­¥éå½å¾ªç¯çR Blockç±»ä¼¼ï¼é½æ¯æç»´çè½½ä½ï¼å­å¨ä¸æ­æ´æ°çæç»´ä¸ä¸æã</li>
<li>Prediction (Y)ï¼å½åç­æ¡çèç¨¿ãè¿æ¯ TRM æç¬ç¹çå°æ¹ãå®æâå½åçé¢æµç»æâEmbedding ä¹åï¼ä½ä¸ºä¸ä¸è½®çè¾å¥åç»èªå·±ãï¼å¯¹æ¯Huginææä¿¡æ¯é½å¨Rï¼TRMæå·²ç»å½¢æçé¢æµç»æè§£è¦åºæ¥äºï¼</li>
</ul>
<p>æ¨çå¾ªç¯é»è¾ (The Loop)ï¼</p>
<p></p><div class="math display">\[\begin{aligned}
z_{t+1} &amp;= \text{Net}(x, y_t, z_t) \quad \text{// æèï¼åºäºå½åèç¨¿åæç»´ï¼æ´æ°æç»´} \\
y_{t+1} &amp;= \text{Net}(y_t, z_{t+1}) \quad \text{// ä¿®æ¹ï¼åºäºæ°çæç»´ï¼ä¿®æ­£èç¨¿}
\end{aligned}
\]</div><p></p><p>è¿å°±åæä»¬åä»£ç ï¼ååä¸ªå¤§æ¦ (<span class="math inline">\(y_0\)</span>) -&gt; èå­è½¬ä¸ä¸ (<span class="math inline">\(z_1\)</span>) -&gt; æ¹ä¸è¡ä»£ç  (<span class="math inline">\(y_1\)</span>) -&gt; åç°æä¸ª Bug (<span class="math inline">\(z_2\)</span>) -&gt; åæ¹ä¸è¡ (<span class="math inline">\(y_2\)</span>)ã</p>
<ol start="2">
<li><strong>æ¶ææç®ä¸»ä¹</strong></li>
</ol>
<ul>
<li>Tiny Networkï¼æ¨¡ååªæ 2 å± Transformer Layerï¼åæ°éä» 5M - 7M</li>
<li>åæ°å±äº«ï¼åä¸ä¸ªç½ç»ï¼Netï¼å¨æ¯ä¸æ¬¡å¾ªç¯ä¸­è¢«åå¤ä½¿ç¨</li>
<li>å¨éæ¨çæ¨¡å¼ï¼å¹¶éèªåå½æ¨¡åtoken by tokençæ¨çï¼èæ¯æ¯ä¸æ­¥å¾ªç¯é½çæå¨éçYï¼å¹¶ä¸æ¯ä¸æ­¥é½å¯¹å¨éçYè¿è¡ä¿®æ­£</li>
</ul>
<h2 id="-æ·±åº¦æ´å¯-2">ð¡ æ·±åº¦æ´å¯</h2>
<ol>
<li><strong>å¨éçæçæç»´è½¬æ¢</strong>ï¼TRM ççææ¹å¼æ´å Diffusion Modelï¼æ©æ£æ¨¡åï¼ï¼æ¯ä»æ¨¡ç³å°æ¸æ°çè¿ç¨ï¼èä¸æ¯ä»å·¦å°å³çè¿ç¨ãä½è¿åæ ·ä¹çº¦æäºå½åTRMåªè½ç¨äºåºå®é¿åº¦åå®¹çè¾åºã</li>
<li><strong>Deep Supervision</strong>ï¼è®­ç»æ¶ï¼TRM å¹¶ä¸åªå¨æåä¸æ­¥è®¡ç® Lossï¼èæ¯å¯¹æ¯ä¸æ­¥çæçèç¨¿é½è®¡ç® Lossãè¿å¼ºè¿«æ¨¡åå¨ç¬¬ä¸æ­¥å°±ç»åºä¸ä¸ªâå¤§è´æ­£ç¡®âçè§£ï¼ç¶åå¨åç»­æ­¥éª¤ä¸­ç²¾ç»åã</li>
</ol>
<h1 id="tidar">TiDAR</h1>
<blockquote>
<ul>
<li>TiDAR: Think in Diffusion, Talk in Autoregression</li>
</ul>
</blockquote>
<p>è±ä¼è¾¾çè¿ç¯è®ºæï¼åæ¯åTRMæè·¯éå¸¸ç¸åï¼é½æ¯å¨çæé¶æ®µæå¼èªåå½âè¹¦å­âçæ¹æ¡ï¼éç¨å¨å±çæå¹¶ä¸æ­æç£¨çæè·¯ãåªä¸è¿TIDARå¼å¥äºæ©æ£æ¨¡åï¼å¹¶åè®©æ¨¡åå¨åä¸ä¸ª Forward Passï¼ååä¼ æ­ï¼éï¼æ¢ä½ä¸ºâèµ·èèâå¹¶è¡å°æ³ï¼åä½ä¸ºâéªè¯èâèªåå½å°ç¡®è®¤ã</p>
<h2 id="-æ ¸å¿çç¹æ¢è¦è¿è¦çå°å¢">ð¨ æ ¸å¿çç¹ï¼æ¢è¦è¿è¦çå°å¢</h2>
<p>å¨å¤§æ¨¡åæ¨çä¸­ï¼æä»¬ä¸ç´é¢ä¸´ä¸ä¸ªtrade-off</p>
<ul>
<li>ARï¼èªåå½æ¨¡åç±äºç¬¦åè¯­è¨çå æå¾ï¼è´¨éæé«ï¼ä½æ¨çéåº¦æ¢</li>
<li>Diffusionï¼éèªåå½æ¨¡åå¯ä»¥å¹¶è¡çæï¼ååéæé«ä½å¾å¾è´¨éä¸ä½³ï¼å¹¶ä¸è´¨éä¼éççæçtokenä¸ªæ°èæç»­ä¸éã</li>
</ul>
<p>ç°å¨å·²æçä¸äºè§£å³æ¹æ¡ä¾å¦DeepSeekæåºçMTPï¼åæ¶é¢æµå¤ä¸ªtokenï¼ä¹æ¯å¨å°è¯è§£å³ä»¥ä¸çé®é¢ï¼ä½MTPçæ¬è´¨è¿æ¯èªåå½çã</p>
<p>è¿æSpeculative decodingï¼ä½¿ç¨ä¸ä¸ªè½»éçº§çARæ¨¡åå»çæå¤ä¸ªtokençèç¨¿ï¼åç¨å¤§æ¨¡åå¹¶è¡å¯¹èç¨¿çæ¯ä¸ªtokenè¿è¡éªè¯ï¼ä½è¿æ ·å°±éè¦åæ¶é¨ç½²å¤ä¸ªæ¨¡åè¿è¡æ¨çã</p>
<h2 id="ï¸-è§£å³æ¹æ¡-think--talkçåæµåå">ð ï¸ è§£å³æ¹æ¡ï¼ Think + Talkçåæµåå</h2>
<p>TiDAR çæ¨¡åç»æåæ¯å¨speculative Decodingçåºç¡ä¸ï¼æèç¨¿æ¨¡ååéªè¯æ¨¡ååå¹¶å¨äºä¸ä¸ªæ¨¡åç»æéï¼éè¿ç¹æ®æ©ç å®ç°åæ¶æ¨çã</p>
<ol>
<li><strong>Think in Diffusion</strong></li>
</ol>
<p>å¨æ¨çæ¶ï¼TiDAR å¹¶ä¸å GPT é£æ ·ä¸æ¬¡åªé¢æµä¸ä¸ªè¯ãå®ä½¿ç¨ Diffusionçæ¹æ¡ï¼å¨å½åä½ç½®ä¹åçKä¸ªæ§½ä½ä¸ï¼åæ¶çæææåéTokenãè¿ <span class="math inline">\(K\)</span> ä¸ª Token æ¯<strong>å¹¶è¡</strong>çæçãå®å©ç¨äºæ©æ£æ¨¡åçå¨å±è§éã</p>
<ol start="2">
<li><strong>Talk in Autoregression"</strong></li>
</ol>
<p>çæçè¿Kä¸ªåéè¯å¹¶ä¸è½ç´æ¥ä½ä¸ºç­æ¡ï¼å ä¸º Diffusion çé»è¾ä¸è´æ§ä¸å¦ ARãTiDAR å¨åä¸ä¸ªååä¼ æ­ä¸­ï¼å©ç¨ AR çé»è¾å¯¹è¿Kä¸ªåéè¯è¿è¡æç»éæ ·ã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1326688/202601/1326688-20260115085105141-52488943.png" class="lazyload"></p>
<ol start="3">
<li><strong>åæµçæ ¸å¿å®ç°ï¼ç»æåæ³¨æåæ©ç </strong></li>
</ol>
<p>ä¸ºäºå¨ä¸æ¬¡ååæ¨çæ¶ï¼åæ¶å®ç°ä»¥ä¸ä¸¤ç§æ¨çï¼TIDARè®¾è®¡äºä¸ä¸ªç¹æ®çäºç»´MASKï¼å°åºååæäºä¸¤ä¸ªé¨å</p>
<ul>
<li>Diffusion MASKï¼è¿ä¸ªåºåçtokenç´æ¥æ¯å¨è¿æ¥çï¼ä¸ºäºè®©æ¨¡åè½å¤æ ¹æ®ä¸æåæ¶çåºåé¢Kä¸ªè¯</li>
<li>AR MASKï¼è¿ä¸ªåºåæ¯causal MASKï¼å®è´è´£æ ¹æ®ä¸ä¸æååé¢çåºçèç¨¿è¿è¡éå½çæã</li>
</ul>
<p>è¿æ ·å¨ä¸æ¬¡ååæ¨çä¸­ï¼Inpäº¡çKV Cacheä¼åä¸ä¸¤æ¬¡è®¡ç®</p>
<ul>
<li>Input â&gt; Think Mask -&gt; Diffusion Drafts</li>
<li>Input + Diffusion Drafts -&gt; AR Mask -&gt; Final verified Token</li>
</ul>
<ol start="4">
<li><strong>å¤ä»»å¡èåä¼åè®­ç»</strong></li>
</ol>
<p>ä¸ºäºåæ¶è®­ç»DiffusionåARï¼TIDARå¨ä¼ ç»çNSPè®­ç»çåºç¡ä¸è¿è¡äºæ¹è¯ï¼åæ¶è®­ç»ä¸¤ä¸ªloss</p>
<ul>
<li>Diffusion Lossï¼è®­ç»æ¨¡åå¨ç»å®ä¸ä¸æåé¨ååªå£°çæåµä¸ï¼å¹¶è¡éæåºåç»­ <span class="math inline">\(K\)</span> ä¸ªè¯çè½åã</li>
<li>AR Lossï¼æ åçäº¤åçµæå¤±ï¼ç¡®ä¿æ¨¡åçæç»è¾åºç¬¦åè¯­è¨æ¦çåå¸</li>
</ul>
<hr>
<h1 id="æ»ç»æ¨ççæªæ¥æ¯ååçé¿">æ»ç»ï¼æ¨ççæªæ¥æ¯âååçé¿âï¼</h1>
<p>ä»ä»¥ä¸åç¯è®ºæï¼æä»¬ä¸å¦¨çæµä¸åReasoningæ¶ä»£çææ¯æ¼è¿æ¹å</p>
<ol>
<li>ä»Explicitå°Implicitï¼</li>
<li>ä»Linearå°Recurrentï¼</li>
<li>ä»ARå°Hybridï¼</li>
</ol>
<p>æªæ¥çå¤§æ¨¡åï¼æè®¸ä¼åå¾æ´åäººç±»çå¤§èï¼ è¡¨é¢ä¸æ²é»å¯¡è¨ï¼ä½åå¿ææå¶ä¸°å¯ï¼å¹¶ä¸è½å¤åå¤æ¨æ²ï¼æç»ç»åºä¸ä¸ªæ·±æçèçç­æ¡ã</p>
<p>æ³çæ´å¨çå¤§æ¨¡åè®ºæÂ·å¾®è°é¢è®­ç»æ°æ®Â·å¼æºæ¡æ¶Â·AIGCåºç¨ &gt;&gt; <a href="https://github.com/DSXiangLi?tab=repositories" target="_blank" rel="noopener nofollow">DecryPrompt</a></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-15 08:53">2026-01-15 08:52</span>&nbsp;
<a href="https://www.cnblogs.com/gogoSandy">é£é¨ä¸­çå°ä¸</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19485562);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19485562', targetLink: 'https://www.cnblogs.com/gogoSandy/p/19485562', title: 'è§£å¯Promptç³»å68. åå«éè¯è¹¦å­ - éå¡ Transformer çæ¨çèå¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä¸æè·ä¸ªåï¼.NET 10 å¤§æ´æ°è®¡ç®å¯¹éµ Javaï¼ç»æä»¤äººæå¤ ]]></title>
    <link>https://www.cnblogs.com/sdcb/p/19484525/20261113-big-integer-dotnet-10-vs-java</link>
    <guid>9f38dd951b6a47bbb8de5c5c31048521</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/sdcb/p/19484525/20261113-big-integer-dotnet-10-vs-java" title="åå¸äº 2026-01-15 08:50">
    <span role="heading" aria-level="2">ä¸æè·ä¸ªåï¼.NET 10 å¤§æ´æ°è®¡ç®å¯¹éµ Javaï¼ç»æä»¤äººæå¤</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="å¼è¨ä»ç»éªå¼å°æ éå¤§">å¼è¨ï¼ä»âç»éªå¼âå°æ éå¤§</h2>
<p>æå¯¹æ°å¼è®¡ç®çæ§å¿µï¼æ¥èªåä¸­æ¶ä»£çé¾ç¼­ç»çç½å§ãé£æ¶ç©ãä¼å¥ãï¼æè®©æçè¿·çä¸æ¯ææªçè£å¤ï¼èæ¯è§è²é¢æ¿éé£æ¡é¿é¿ç<strong>ç»éªå¼</strong>ãççæ°å­ä¸æ­è·³å¨ãç´¯ç§¯ï¼æç»âå®âä¸å£°åçº§ï¼é£ç§ç®åçæ°å¼é©±å¨æ´ä¸ªä¸çè¿è½¬çæè§ï¼å®å¨å¤ªå¥å¦äºã</p>
<p>å½æ¶èªå­¦ç¼ç¨ï¼ä» G-BASIC éåªæ 16 ä½ç <code>INTEGER</code>ï¼å°ç¬¬ä¸æ¬¡åç° QBASIC <code>LONG</code> è½å­ä¸â20äº¿âæ¶çå´å¥ï¼åå°å¦ä»æä¸ºä¸å .NET ç¨åºåï¼ææ¡çè®ºä¸âæ éå¤§âç <code>System.Numerics.BigInteger</code>ãæå¯¹å¤§æ°çè¿·æä»æªæ¹åï¼åªæ¯çæéä¹èæ¥ï¼</p>
<blockquote>
<p><strong>ä½ä¸º .NET å¼åèï¼ææéç <code>BigInteger</code> å°åºå¤ä¸å¤å¿«ï¼ç¹å«æ¯åéå£ Java ç <code>BigInteger</code> ç¸æ¯ï¼ç©¶ç«è°æ´èä¸ç­¹ï¼</strong></p>
</blockquote>
<p>å°¤å¶æ¯æ¶åé«ç²¾åº¦è®¡ç®ãå¯ç å­¦ç­å³é®é¢åæ¶ï¼è¿ä¸ä»æ¯å¥½å¥ï¼æ´æ¯å³ä¹æ§è½çä¸¥èæ·é®ãä»å¤©ï¼æå°±éè¿ä¸æ¬¡è¯¦å°½çå¯¹æ¯æµè¯ï¼å« .NET 10ãJava 21ä»¥åJava 8ï¼ï¼æ¥ä¸ºå¤§å®¶æ­æç­æ¡ãç»æå¯è½åºä¹ææï¼è¯·å¡å¿çå°æåï¼ææ«è¿æä¸ä¸ªé«æ§è½çâå½©èâã</p>
<hr>
<h2 id="å®éªç®æ ä¸èå´">å®éªç®æ ä¸èå´</h2>
<p>æä»¬å¯¹æ¯è¿ä¸å¥å®ç°ï¼</p>
<ul>
<li><strong>.NET</strong>ï¼<code>System.Numerics.BigInteger</code>ï¼åºäº .NET 10ï¼</li>
<li><strong>Java</strong>ï¼<code>java.math.BigInteger</code>
<ul>
<li><strong>Java 21ï¼ææ°LTSï¼</strong>ï¼ä»£è¡¨æªæ¥è¶å¿</li>
<li><strong>Java 8ï¼å½åå­éæå¤§ï¼</strong>ï¼ä»£è¡¨åºå¤§çç°ç¶</li>
</ul>
</li>
</ul>
<h3 id="æµè¯æä½3ç±»è¦çå¸¸è§å¤§æ°ç­ç¹">æµè¯æä½ï¼3ç±»ï¼è¦çå¸¸è§å¤§æ°ç­ç¹ï¼</h3>
<ol>
<li><strong>ADD_MOD</strong>ï¼<code>(a + b) mod m</code>ï¼å æ³ + åæ¨¡ï¼</li>
<li><strong>MUL_MOD</strong>ï¼<code>(a * b) mod m</code>ï¼ä¹æ³ + åæ¨¡ï¼</li>
<li><strong>MODPOW</strong>ï¼<code>a^e mod m</code>ï¼æ¨¡å¹ï¼å¯ç å­¦ç­åºæ¯çæ§è½ç­ç¹ï¼</li>
</ol>
<h3 id="ä½å®½3æ¡£">ä½å®½ï¼3æ¡£ï¼</h3>
<ul>
<li>256 / 1024 / 4096 bits</li>
</ul>
<h3 id="è®¡æ¶å£å¾å°½éæå¶åªå£°">è®¡æ¶å£å¾ï¼å°½éæå¶åªå£°ï¼</h3>
<ul>
<li><strong>ç­èº«</strong>ï¼é¢ç­ 5 æ¬¡ï¼è®© JITï¼å³æ¶ç¼è¯å¨ï¼åååæ¥ã</li>
<li><strong>æµé</strong>ï¼æ­£å¼è· 11 æ¬¡ï¼åä¸­ä½æ°ï¼é¿ååæ¬¡æå¨å¹²æ°ã</li>
<li><strong>ææ </strong>ï¼<code>nsPerOp</code>ï¼æ¯æ¬¡æä½èæ¶å¤å°çº³ç§ï¼ï¼è¿ä¸ªå¼<strong>è¶å°è¶å¥½</strong>ã</li>
<li><strong>é²ä½å¼</strong>ï¼ç¨ <code>XOR</code> èåæ¯æ¬¡è®¡ç®ç»æï¼é²æ­¢èªæçç¼è¯å¨ææ´ä¸ªå¾ªç¯ä¼åæã</li>
</ul>
<hr>
<h2 id="æµè¯ç¯å¢">æµè¯ç¯å¢</h2>
<blockquote>
<p>è¯´æï¼ä»¥ä¸æ¯å¨åä¸ Linux å®¹å¨åå®æãå®¹å¨æèµæºéå¶ï¼å æ­¤âçå°ç CPU æ ¸æ°/åå­âä¸å®¿ä¸»æºä¸å®å¨ä¸è´ã</p>
</blockquote>
<ul>
<li><strong>OS</strong>ï¼Ubuntu 24.04.3 LTS</li>
<li><strong>CPUï¼å®¿ä¸»æºåå·ï¼</strong>ï¼AMD EPYC 7763 64-Core Processor<br>
<strong>å®¹å¨å¯ç¨æ ¸å¿æ°</strong>ï¼2 æ ¸ï¼åå®¹å¨éå¶ï¼</li>
<li><strong>åå­</strong>ï¼2GBï¼å®¹å¨éå¶ï¼</li>
<li><strong>.NET</strong>
<ul>
<li>SDKï¼10.0.101</li>
<li>Runtimeï¼10.0.1</li>
<li>ç¯å¢åéï¼<code>DOTNET_GCServer=1</code></li>
</ul>
</li>
<li><strong>Java</strong>
<ul>
<li>Java 21ï¼OpenJDK 21.0.9ï¼LTSï¼</li>
<li>Java 8ï¼Temurin(OpenJDK) 1.8.0_472-b08ï¼å¹¿æ³ä½¿ç¨ç 8u ç³»åï¼</li>
<li>JVM åæ°ï¼ä¸¤çæ¬ä¸è´ï¼ï¼
<ul>
<li><code>-Xms1g -Xmx1g</code>ï¼æ Java å åºå®ä¸º 1GBï¼é¿åå å¨ææ©å¼ å¹²æ°ï¼</li>
<li><code>-XX:+UseG1GC</code></li>
<li><code>-XX:+AlwaysPreTouch</code>ï¼å°½éåå°è¿è¡ä¸­é¡µåéæ°å¨ï¼</li>
</ul>
</li>
</ul>
</li>
<li><strong>ä¸è´æ§çº¦æ</strong>
<ul>
<li>Java 8/Java 21 ä½¿ç¨<strong>åä¸ä»½æºç </strong>ï¼ä»ä½¿ç¨ Java 8 è¯­æ³ï¼ï¼å¹¶ä¸ <strong>ç¨ Java 8 ç <code>javac</code> ç¼è¯</strong>ï¼classfile=52.0ï¼ååå«å¨ Java 8 / Java 21 ä¸è¿è¡ï¼ä»èå°½éæå·®å¼å½å å°è¿è¡æ¶/JIT/åºå®ç°ï¼èä¸æ¯ç¼è¯å¨çæå·®å¼ã</li>
</ul>
</li>
</ul>
<hr>
<h2 id="èµåææ²net-biginteger-ççä¸å¬å¹³å">èµåææ²ï¼.NET BigInteger ççâä¸å¬å¹³âåï¼</h2>
<p>æäººå¯è½æ³é®ï¼</p>
<blockquote>
<p>â.NET BigInteger æ¯æ¬¡è¿ç®é½ä¼åå»ºæ°çå¯¹è±¡ï¼ä¸å¯åï¼ï¼ä¸å¬å¹³ãâ</p>
</blockquote>
<p>è¿å¥è¯å¨âå¤§æ°åºæ¯âéåºæ¬æç«ï¼ä½<strong>Java BigInteger åæ ·æ¯ä¸å¯åç±»å</strong>ï¼<code>add/multiply/mod/xor/modPow</code> é½ä¼è¿åæ°å¼ï¼ä¸å¡ä»£ç å±é¢ä½ å¹¶æ²¡æå¬å¼ç in-place API å¯ä»¥å¤ç¨åé¨ç¼å²ã</p>
<p>å æ­¤ï¼å¨æ¬æçâä¸»å¯¹æ¯âï¼.NET vs Javaï¼éï¼åæ¹é½å¨ä¸å¯åèå¼ä¸è¿è¡ï¼è¿ç¹æ¯å¬å¹³çã</p>
<hr>
<h2 id="å®éªä¸net-biginteger-vs-java-21-biginteger">å®éªä¸ï¼.NET BigInteger vs Java 21 BigInteger</h2>
<h3 id="31-å®æ´æºä»£ç ">3.1 å®æ´æºä»£ç </h3>
<h4 id="java-æºç bigintbenchjava">Java æºç ï¼<code>BigIntBench.java</code></h4>
<blockquote>
<p>å¼å®¹ Java 8 è¯­æ³ï¼åä¸ä»½ä»£ç å¨ Java 21 ä¸è¿è¡ã</p>
</blockquote>
<pre><code class="language-java">import java.math.BigInteger;
import java.util.*;

public class BigIntBench {
    // SplitMix64 RNG (deterministic, fast)
    static final class SplitMix64 {
        private long x;
        SplitMix64(long seed) { this.x = seed; }
        long nextLong() {
            long z = (x += 0x9E3779B97F4A7C15L);
            z = (z ^ (z &gt;&gt;&gt; 30)) * 0xBF58476D1CE4E5B9L;
            z = (z ^ (z &gt;&gt;&gt; 27)) * 0x94D049BB133111EBL;
            return z ^ (z &gt;&gt;&gt; 31);
        }
        void nextBytes(byte[] dst) {
            int i = 0;
            while (i &lt; dst.length) {
                long v = nextLong();
                for (int k = 0; k &lt; 8 &amp;&amp; i &lt; dst.length; k++) {
                    dst[i++] = (byte)(v &gt;&gt;&gt; (56 - 8*k)); // big-endian stream
                }
            }
        }
    }

    static BigInteger[] genBigInts(int bitSize, int count, long seed) {
        SplitMix64 rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        BigInteger[] arr = new BigInteger[count];
        byte[] buf = new byte[byteLen];
        int topBit = (bitSize - 1) % 8;
        int keepBits = topBit + 1;
        int firstMask = (keepBits == 8) ? 0xFF : ((1 &lt;&lt; keepBits) - 1);
        byte topMask = (byte)(1 &lt;&lt; topBit);
        for (int i = 0; i &lt; count; i++) {
            rng.nextBytes(buf);
            // Ensure exact bit length:
            // - mask away unused top bits when bitSize is not byte-aligned
            // - set the top bit so the number has the requested bit length
            buf[0] &amp;= (byte)firstMask;
            buf[0] |= topMask;
            arr[i] = new BigInteger(1, buf);
        }
        return arr;
    }

    static BigInteger genModulus(int bitSize, long seed) {
        SplitMix64 rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        byte[] buf = new byte[byteLen];
        rng.nextBytes(buf);
        int topBit = (bitSize - 1) % 8;
        int keepBits = topBit + 1;
        int firstMask = (keepBits == 8) ? 0xFF : ((1 &lt;&lt; keepBits) - 1);
        buf[0] &amp;= (byte)firstMask;
        buf[0] |= (byte)(1 &lt;&lt; topBit);
        buf[buf.length - 1] |= 1; // odd
        return new BigInteger(1, buf);
    }

    enum Op { ADD_MOD, MUL_MOD, MODPOW }

    static final class Result {
        final String lang;
        final int bits;
        final Op op;
        final long ops;
        final double nsPerOp;
        final long checksum;
        Result(String lang, int bits, Op op, long ops, double nsPerOp, long checksum) {
            this.lang = lang; this.bits = bits; this.op = op; this.ops = ops; this.nsPerOp = nsPerOp; this.checksum = checksum;
        }
        String toJson() {
            return String.format(Locale.ROOT,
                    "{\"lang\":\"%s\",\"bits\":%d,\"op\":\"%s\",\"ops\":%d,\"nsPerOp\":%.3f,\"checksum\":%d}",
                    lang, bits, op.name(), ops, nsPerOp, checksum);
        }
    }

    static long runOnce(Op op, BigInteger[] a, BigInteger[] b, BigInteger[] e, BigInteger mod, int outer) {
        BigInteger acc = BigInteger.ZERO;
        int n = a.length;
        switch (op) {
            case ADD_MOD:
                for (int o = 0; o &lt; outer; o++) {
                    for (int i = 0; i &lt; n; i++) {
                        BigInteger r = a[i].add(b[i]).mod(mod);
                        acc = acc.xor(r);
                    }
                }
                break;

            case MUL_MOD:
                for (int o = 0; o &lt; outer; o++) {
                    for (int i = 0; i &lt; n; i++) {
                        BigInteger r = a[i].multiply(b[i]).mod(mod);
                        acc = acc.xor(r);
                    }
                }
                break;

            case MODPOW:
                // here we use a.length as n; e can be same length
                for (int o = 0; o &lt; outer; o++) {
                    for (int i = 0; i &lt; n; i++) {
                        BigInteger r = a[i].modPow(e[i], mod);
                        acc = acc.xor(r);
                    }
                }
                break;

            default:
                throw new IllegalArgumentException("Unknown op: " + op);
        }
        return acc.longValue();
    }

    static Result bench(String lang, int bits, Op op, BigInteger[] a, BigInteger[] b, BigInteger[] e, BigInteger mod, long targetOps, int warmups, int measures) {
        int n = a.length;
        int outer = (int)Math.max(1, targetOps / n);
        long actualOps = (long)n * outer;

        // warmup
        long ck = 0;
        for (int i = 0; i &lt; warmups; i++) {
            ck ^= runOnce(op, a, b, e, mod, outer);
        }

        long[] times = new long[measures];
        for (int i = 0; i &lt; measures; i++) {
            long t0 = System.nanoTime();
            long c = runOnce(op, a, b, e, mod, outer);
            long t1 = System.nanoTime();
            ck ^= c;
            times[i] = (t1 - t0);
        }
        Arrays.sort(times);
        long median = times[times.length / 2];
        double nsPerOp = (double)median / (double)actualOps;
        return new Result(lang, bits, op, actualOps, nsPerOp, ck);
    }

    static void printHuman(List&lt;Result&gt; results) {
        System.out.println("Java BigInteger benchmark");
        System.out.println("java.version=" + System.getProperty("java.version"));
        System.out.println("java.vm.name=" + System.getProperty("java.vm.name"));
        System.out.println();
        System.out.printf(Locale.ROOT, "%-6s %-9s %-12s %-12s\n", "Bits", "Op", "ns/op(med)", "ops/run");
        for (Result r : results) {
            System.out.printf(Locale.ROOT, "%-6d %-9s %-12.3f %-12d\n", r.bits, r.op.name(), r.nsPerOp, r.ops);
        }
        System.out.println();
        System.out.println("checksum=" + results.stream().mapToLong(x -&gt; x.checksum).reduce(0L, (x,y)-&gt;x^y));
    }

    public static void main(String[] args) {
        boolean json = false;
        for (String a : args) if (a.equals("--json")) json = true;

        int warmups = 5;
        int measures = 11;

        int[] bitSizes = new int[]{256, 1024, 4096};
        List&lt;Result&gt; results = new ArrayList&lt;&gt;();

        for (int bits : bitSizes) {
            BigInteger mod = genModulus(bits, 0xA1B2C3D4E5F60708L ^ bits);

            // add/mul datasets
            int nAddMul = 1024;
            BigInteger[] a = genBigInts(bits, nAddMul, 0x1111222233334444L ^ bits);
            BigInteger[] b = genBigInts(bits, nAddMul, 0x9999AAAABBBBCCCCL ^ bits);

            // modpow datasets (smaller)
            int nPow = 256;
            BigInteger[] ap = genBigInts(bits, nPow, 0x13579BDF2468ACE0L ^ bits);
            BigInteger[] ep = genBigInts(Math.min(bits, 512), nPow, 0x0FEDCBA987654321L ^ bits);

            long addOps;
            long mulOps;
            long powOps;
            if (bits == 256) {
                addOps = 2_000_000L;
                mulOps = 500_000L;
                powOps = 8_000L;
            } else if (bits == 1024) {
                addOps = 1_000_000L;
                mulOps = 120_000L;
                powOps = 1_500L;
            } else {
                addOps = 200_000L;
                mulOps = 20_000L;
                powOps = 250L;
            }

            results.add(bench("java", bits, Op.ADD_MOD, a, b, null, mod, addOps, warmups, measures));
            results.add(bench("java", bits, Op.MUL_MOD, a, b, null, mod, mulOps, warmups, measures));
            results.add(bench("java", bits, Op.MODPOW, ap, null, ep, mod, powOps, warmups, measures));
        }

        if (json) {
            for (Result r : results) System.out.println(r.toJson());
        } else {
            printHuman(results);
        }
    }
}
</code></pre>
<h4 id="net-æºç programcsbiginteger-é¨å">.NET æºç ï¼<code>Program.cs</code>ï¼BigInteger é¨åï¼</h4>
<blockquote>
<p>è¿æ¯âä¸»å¯¹æ¯âç¨ç .NET åºåç¨åºã</p>
</blockquote>
<pre><code class="language-csharp">using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Globalization;
using System.Linq;
using System.Numerics;

sealed class SplitMix64
{
    private ulong _x;
    public SplitMix64(ulong seed) =&gt; _x = seed;

    public ulong NextUInt64()
    {
        ulong z = (_x += 0x9E3779B97F4A7C15UL);
        z = (z ^ (z &gt;&gt; 30)) * 0xBF58476D1CE4E5B9UL;
        z = (z ^ (z &gt;&gt; 27)) * 0x94D049BB133111EBUL;
        return z ^ (z &gt;&gt; 31);
    }

    public void NextBytes(byte[] dst)
    {
        int i = 0;
        while (i &lt; dst.Length)
        {
            ulong v = NextUInt64();
            for (int k = 0; k &lt; 8 &amp;&amp; i &lt; dst.Length; k++)
            {
                dst[i++] = (byte)(v &gt;&gt; (56 - 8 * k)); // big-endian stream
            }
        }
    }
}

enum Op { ADD_MOD, MUL_MOD, MODPOW }

record Result(string Lang, int Bits, Op Op, long Ops, double NsPerOp, long Checksum)
{
    public string ToJson() =&gt; string.Create(CultureInfo.InvariantCulture,
        $"{{\"lang\":\"{Lang}\",\"bits\":{Bits},\"op\":\"{Op}\",\"ops\":{Ops},\"nsPerOp\":{NsPerOp:F3},\"checksum\":{Checksum}}}");
}

static class BigIntBench
{
    static BigInteger[] GenBigInts(int bitSize, int count, ulong seed)
    {
        var rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        var arr = new BigInteger[count];
        var buf = new byte[byteLen];
        int topBit = (bitSize - 1) % 8;
        byte topMask = (byte)(1 &lt;&lt; topBit);

        for (int i = 0; i &lt; count; i++)
        {
            rng.NextBytes(buf);
            buf[0] |= topMask;
            // unsigned + big-endian prevents negative
            arr[i] = new BigInteger(buf, isUnsigned: true, isBigEndian: true);
        }
        return arr;
    }

    static BigInteger GenModulus(int bitSize, ulong seed)
    {
        var rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        var buf = new byte[byteLen];
        rng.NextBytes(buf);
        int topBit = (bitSize - 1) % 8;
        buf[0] |= (byte)(1 &lt;&lt; topBit);
        buf[^1] |= 1; // odd
        return new BigInteger(buf, isUnsigned: true, isBigEndian: true);
    }

    static long RunOnce(Op op, BigInteger[] a, BigInteger[] b, BigInteger[] e, BigInteger mod, int outer)
    {
        BigInteger acc = BigInteger.Zero;
        int n = a.Length;

        switch (op)
        {
            case Op.ADD_MOD:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                    {
                        var r = (a[i] + b[i]) % mod;
                        acc ^= r;
                    }
                break;

            case Op.MUL_MOD:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                    {
                        var r = (a[i] * b[i]) % mod;
                        acc ^= r;
                    }
                break;

            case Op.MODPOW:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                    {
                        var r = BigInteger.ModPow(a[i], e[i], mod);
                        acc ^= r;
                    }
                break;
        }

        return (long)(acc &amp; long.MaxValue); // stable checksum
    }

    static Result Bench(string lang, int bits, Op op, BigInteger[] a, BigInteger[] b, BigInteger[] e, BigInteger mod, long targetOps, int warmups, int measures)
    {
        int n = a.Length;
        int outer = (int)Math.Max(1, targetOps / n);
        long actualOps = (long)n * outer;

        long ck = 0;
        for (int i = 0; i &lt; warmups; i++)
            ck ^= RunOnce(op, a, b, e, mod, outer);

        long[] timesNs = new long[measures];
        for (int i = 0; i &lt; measures; i++)
        {
            var sw = Stopwatch.StartNew();
            long c = RunOnce(op, a, b, e, mod, outer);
            sw.Stop();
            ck ^= c;
            // Stopwatch ticks to ns
            timesNs[i] = (long)(sw.ElapsedTicks * (1_000_000_000.0 / Stopwatch.Frequency));
        }

        Array.Sort(timesNs);
        long median = timesNs[timesNs.Length / 2];
        double nsPerOp = (double)median / actualOps;
        return new Result(lang, bits, op, actualOps, nsPerOp, ck);
    }

    static void PrintHuman(List&lt;Result&gt; results)
    {
        Console.WriteLine("C# BigInteger benchmark");
        Console.WriteLine($"dotnet.version={Environment.Version}");
        Console.WriteLine($"os={System.Runtime.InteropServices.RuntimeInformation.OSDescription}");
        Console.WriteLine($"arch={System.Runtime.InteropServices.RuntimeInformation.OSArchitecture}");
        Console.WriteLine();
        Console.WriteLine($"{ "Bits",-6} {"Op",-9} {"ns/op(med)",-12} {"ops/run",-12}");
        foreach (var r in results)
            Console.WriteLine(string.Create(CultureInfo.InvariantCulture, $"{r.Bits,-6} {r.Op,-9} {r.NsPerOp,-12:F3} {r.Ops,-12}"));
        Console.WriteLine();
        long checksum = 0;
        foreach (var r in results) checksum ^= r.Checksum;
        Console.WriteLine($"checksum={checksum}");
    }

    public static int Main(string[] args)
    {
        bool json = args.Any(a =&gt; a == "--json");

        int warmups = 5;
        int measures = 11;
        int[] bitSizes = [256, 1024, 4096];

        var results = new List&lt;Result&gt;();

        foreach (int bits in bitSizes)
        {
            var mod = GenModulus(bits, 0xA1B2C3D4E5F60708UL ^ (uint)bits);

            int nAddMul = 1024;
            var a = GenBigInts(bits, nAddMul, 0x1111222233334444UL ^ (uint)bits);
            var b = GenBigInts(bits, nAddMul, 0x9999AAAABBBBCCCCUL ^ (uint)bits);

            int nPow = 256;
            var ap = GenBigInts(bits, nPow, 0x13579BDF2468ACE0UL ^ (uint)bits);
            var ep = GenBigInts(Math.Min(bits, 512), nPow, 0x0FEDCBA987654321UL ^ (uint)bits);

            long addOps = bits switch { 256 =&gt; 2_000_000L, 1024 =&gt; 1_000_000L, _ =&gt; 200_000L };
            long mulOps = bits switch { 256 =&gt; 500_000L, 1024 =&gt; 120_000L, _ =&gt; 20_000L };
            long powOps = bits switch { 256 =&gt; 8_000L, 1024 =&gt; 1_500L, _ =&gt; 250L };

            results.Add(Bench("csharp", bits, Op.ADD_MOD, a, b, null!, mod, addOps, warmups, measures));
            results.Add(Bench("csharp", bits, Op.MUL_MOD, a, b, null!, mod, mulOps, warmups, measures));
            results.Add(Bench("csharp", bits, Op.MODPOW, ap, null!, ep, mod, powOps, warmups, measures));
        }

        if (json)
        {
            foreach (var r in results) Console.WriteLine(r.ToJson());
        }
        else
        {
            PrintHuman(results);
        }

        return 0;
    }
}
</code></pre>
<h3 id="32-è¿è¡æ¹å¼å¯å¤ç°å½ä»¤">3.2 è¿è¡æ¹å¼ï¼å¯å¤ç°å½ä»¤ï¼</h3>
<pre><code class="language-bash"># Java 21
cd /app/bigintbench/java
javac BigIntBench.java
java -Xms1g -Xmx1g -XX:+UseG1GC -XX:+AlwaysPreTouch BigIntBench --json

# .NET 10
cd /app/bigintbench/csharp
dotnet build -c Release
DOTNET_GCServer=1 dotnet run -c Release -- --json
</code></pre>
<h3 id="33-å®éªä¸åå§è¾åºjsonl">3.3 å®éªä¸åå§è¾åºï¼JSONLï¼</h3>
<h4 id="java-21results_java21jsonl">Java 21ï¼<code>results_java21.jsonl</code></h4>
<pre><code class="language-jsonl">{"lang":"java","bits":256,"op":"ADD_MOD","ops":1999872,"nsPerOp":139.589,"checksum":0}
{"lang":"java","bits":256,"op":"MUL_MOD","ops":499712,"nsPerOp":387.031,"checksum":0}
{"lang":"java","bits":256,"op":"MODPOW","ops":7936,"nsPerOp":17764.884,"checksum":0}
{"lang":"java","bits":1024,"op":"ADD_MOD","ops":999424,"nsPerOp":284.672,"checksum":0}
{"lang":"java","bits":1024,"op":"MUL_MOD","ops":119808,"nsPerOp":3094.540,"checksum":0}
{"lang":"java","bits":1024,"op":"MODPOW","ops":1280,"nsPerOp":264577.852,"checksum":0}
{"lang":"java","bits":4096,"op":"ADD_MOD","ops":199680,"nsPerOp":900.735,"checksum":0}
{"lang":"java","bits":4096,"op":"MUL_MOD","ops":19456,"nsPerOp":32062.554,"checksum":0}
{"lang":"java","bits":4096,"op":"MODPOW","ops":256,"nsPerOp":3422756.113,"checksum":0}
</code></pre>
<h4 id="net-10results_csharpjsonl">.NET 10ï¼<code>results_csharp.jsonl</code></h4>
<pre><code class="language-jsonl">{"lang":"csharp","bits":256,"op":"ADD_MOD","ops":1999872,"nsPerOp":146.261,"checksum":0}
{"lang":"csharp","bits":256,"op":"MUL_MOD","ops":499712,"nsPerOp":560.246,"checksum":0}
{"lang":"csharp","bits":256,"op":"MODPOW","ops":7936,"nsPerOp":169713.608,"checksum":0}
{"lang":"csharp","bits":1024,"op":"ADD_MOD","ops":999424,"nsPerOp":297.335,"checksum":0}
{"lang":"csharp","bits":1024,"op":"MUL_MOD","ops":119808,"nsPerOp":4792.760,"checksum":0}
{"lang":"csharp","bits":1024,"op":"MODPOW","ops":1280,"nsPerOp":1938407.720,"checksum":0}
{"lang":"csharp","bits":4096,"op":"ADD_MOD","ops":199680,"nsPerOp":1280.760,"checksum":0}
{"lang":"csharp","bits":4096,"op":"MUL_MOD","ops":19456,"nsPerOp":36894.568,"checksum":0}
{"lang":"csharp","bits":4096,"op":"MODPOW","ops":256,"nsPerOp":20617970.004,"checksum":0}
</code></pre>
<hr>
<h2 id="å®éªäºå å¥-java-8-çç°ç¶ä¸»æµå¤äºä»ä¹ä½ç½®">å®éªäºï¼å å¥ Java 8 ââçâç°ç¶ä¸»æµâå¤äºä»ä¹ä½ç½®</h2>
<p>è¿ä¸ç»çå³é®ç¹æ¯ï¼<strong>åä¸ä»½ Java æºç ç¨ Java 8 ç¼è¯</strong>ï¼åå«å¨ Java 8 ä¸ Java 21 ä¸è¿è¡ï¼å°½éé¿åâç¼è¯å¨äº§ç©å·®å¼âã</p>
<h3 id="41-è¿è¡æ¹å¼">4.1 è¿è¡æ¹å¼</h3>
<pre><code class="language-bash"># ç¼è¯ï¼Java 8ï¼
/path/to/jdk8/bin/javac BigIntBench.java

# è¿è¡ï¼Java 8ï¼
/path/to/jdk8/bin/java -Xms1g -Xmx1g -XX:+UseG1GC -XX:+AlwaysPreTouch BigIntBench --json

# è¿è¡ï¼Java 21ï¼
java -Xms1g -Xmx1g -XX:+UseG1GC -XX:+AlwaysPreTouch BigIntBench --json
</code></pre>
<h3 id="42-å®éªäºåå§è¾åºjsonl">4.2 å®éªäºåå§è¾åºï¼JSONLï¼</h3>
<h4 id="java-8results_java8jsonl">Java 8ï¼<code>results_java8.jsonl</code></h4>
<pre><code class="language-jsonl">{"lang":"java","bits":256,"op":"ADD_MOD","ops":1999872,"nsPerOp":207.335,"checksum":0}
{"lang":"java","bits":256,"op":"MUL_MOD","ops":499712,"nsPerOp":468.248,"checksum":0}
{"lang":"java","bits":256,"op":"MODPOW","ops":7936,"nsPerOp":17697.113,"checksum":0}
{"lang":"java","bits":1024,"op":"ADD_MOD","ops":999424,"nsPerOp":390.906,"checksum":0}
{"lang":"java","bits":1024,"op":"MUL_MOD","ops":119808,"nsPerOp":3089.474,"checksum":0}
{"lang":"java","bits":1024,"op":"MODPOW","ops":1280,"nsPerOp":277395.652,"checksum":0}
{"lang":"java","bits":4096,"op":"ADD_MOD","ops":199680,"nsPerOp":990.708,"checksum":0}
{"lang":"java","bits":4096,"op":"MUL_MOD","ops":19456,"nsPerOp":30692.214,"checksum":0}
{"lang":"java","bits":4096,"op":"MODPOW","ops":256,"nsPerOp":3468269.539,"checksum":0}
</code></pre>
<hr>
<h2 id="å¯è§åä¸æ»ç»">å¯è§åä¸æ»ç»</h2>
<p>ä»ä¸ä¸ª .NET ç¨åºåçè§è§æ¥çï¼è¿æ¬¡çæµè¯ç»æå¯ä»¥è¯´æ¢å¨æçä¹ä¸­ï¼åæäºåºä¹ææã</p>
<ol>
<li><strong>ADD_MOD (å æ³+åæ¨¡)</strong>: å¨è¿ä¸ªé¡¹ç®ä¸ï¼.NET å Java 21 å ä¹æäºä¸ªå¹³æï¼å·®è·å¾®ä¹å¶å¾®ãå¯ä»¥è¯´ï¼å¨åºç¡çå æ³è¿ç®ä¸ï¼.NET è¡¨ç°å¾ç¸å½ä¸éã<br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260114225530983-1114904260.png" alt="bar_csharp_baseline_add_mod" loading="lazy"></li>
<li><strong>MUL_MOD (ä¹æ³+åæ¨¡)</strong>: ä»è¿éå¼å§ï¼å·®è·åºç°äºã.NET ææ¾æ¢äº Javaï¼æ§è½é¸¿æ²å¼å§åå¾âèç¼å¯è§âã<br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260114225554833-1748112213.png" alt="bar_csharp_baseline_mul_mod" loading="lazy"></li>
<li><strong>MODPOW (æ¨¡å¹)</strong>: è¿æ¯å·®è·æå¤§çå°æ¹ã.NET å¨è¿é¡¹æµè¯ä¸­è¢« Java 21 æå¼äº <strong>6å°9å</strong> çå·®è·ãå¯¹äºä»äºå¯ç å­¦æéè¦å¤§éå¤§æ°è¿ç®çå¼åèæ¥è¯´ï¼è¿æ¯ä¸ä¸ªéå¸¸åºç¼çä¿¡å·ã<br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260114225547260-463566788.png" alt="bar_csharp_baseline_modpow" loading="lazy"></li>
<li><strong>Java 8 vs Java 21</strong>: æ¯«æ çé®ï¼Java 21 å¨ç»å¤§å¤æ°æåµä¸é½æ¯èè¿ç Java 8 è¦å¿«ãä¸è¿æè¶£çæ¯ï¼å¨ <code>MUL_MOD</code> ç 1024 å 4096 ä½æµè¯ä¸­ï¼Java 8 å±ç¶åºç°äºâåè¶âçç°è±¡ãè¿å¯è½æ¯ç±äº JIT ç­ç¥ãç®æ³éæ©çéå¼å·®å¼ï¼ææ¯åçº¯çæµéè¯¯å·®ãè½ç¶è¿ä¸å½±åâJava 21æ´å¿«âçæ»ä½ç»è®ºï¼ä½ä¹æéæä»¬æ§è½æµè¯çå¤ææ§ã</li>
</ol>
<p>æ»èè¨ä¹ï¼è¿æ¬¡å¯¹å³è®©æä»¬æ¸æ¥å°çå°ï¼å¨å¤æçå¤§æ°è¿ç®ä¸ï¼.NET ç <code>BigInteger</code> ç¡®å®è¿æå¾é¿çè·¯è¦èµ°ã</p>
<hr>
<h2 id="one-more-thingå½å¤æ´ç»åº">One More Thingï¼å½âå¤æ´âç»åº</h2>
<p>å¨å¯»æ¾ .NET å¤§æ°æ§è½ä¼åæ¹æ¡çè¿ç¨ä¸­ï¼æä»¬èªç¶è½æ³å°äºä¸çæ æ GMP ââå®æ¯ GNU Multi-Precision Arithmetic Libraryï¼å¾å¤æ°å­¦è½¯ä»¶/å¯ç å­¦å®ç°é½ä¼ç¨å®åé«æ§è½å¤§æ´æ°è¿ç®ã</p>
<p>æç¢°å·§ä¹ä¸ºå®åäºä¸ä¸ª .NET å°è£ï¼<a href="https://github.com/sdcb/Sdcb.Arithmetic" target="_blank" rel="noopener nofollow">Sdcb.Arithmetic</a>ã</p>
<p>ä½å¿é¡»æåå£°æï¼<strong>è®© GMP ä½ä¸ºâå¤æ´âå å¥è¿åºå¯¹æ¯ï¼æ¯âä¸å¬å¹³âç</strong>ãåå å¾ç®åï¼</p>
<ul>
<li><strong>è¯­è¨ä¼å¿</strong>ï¼GMP æ¯åç C/æ±ç¼ï¼è .NET å Java æ¯å¨èææºä¸è¿è¡çæç®¡è¯­è¨ã</li>
<li><strong>åå­ç­ç¥</strong>ï¼GMP é¼å±ä½¿ç¨ <strong>in-place API</strong>ï¼å¯ä»¥ç´æ¥å¨åå°ä¿®æ¹æ°å¼ï¼å¤§å¤§åå°äºåå­åéå GC ååãè .NET å Java ç <code>BigInteger</code> åæ¯ä¸å¯åå¯¹è±¡ã</li>
</ul>
<p>æä»¥ï¼è¿é¨åçç»ææ´åæ¯ä¸ä¸ªâå½©èâï¼å±ç¤ºçæ¯ï¼<strong>å¦æä½ æ¿æå¼å¥åçä¾èµï¼å¹¶æ¹åç¼ç é£æ ¼ï¼.NET çå¤§æ°æ§è½å¯ä»¥è¾¾å°ææ ·çé«åº¦ã</strong></p>
<h3 id="71-å®¢ä¸²å®éªå®æ´æºä»£ç net-biginteger--gmpinteger-ååº">7.1 å®¢ä¸²å®éªå®æ´æºä»£ç ï¼.NET BigInteger + GmpInteger ååºï¼</h3>
<blockquote>
<p>ä¸é¢ä»£ç ä¼åæ¶è¾åºä¸¤å¥ç»æï¼<code>csharp_bigint</code> ä¸ <code>csharp_gmp_inplace</code>ï¼ä»æ¯ JSONLï¼ã</p>
</blockquote>
<p><strong><code>Program.cs</code>ï¼å®¢ä¸²çï¼å®æ´ï¼</strong></p>
<pre><code class="language-csharp">using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Globalization;
using System.Linq;
using System.Numerics;
using Sdcb.Arithmetic.Gmp;

sealed class SplitMix64
{
    private ulong _x;
    public SplitMix64(ulong seed) =&gt; _x = seed;

    public ulong NextUInt64()
    {
        ulong z = (_x += 0x9E3779B97F4A7C15UL);
        z = (z ^ (z &gt;&gt; 30)) * 0xBF58476D1CE4E5B9UL;
        z = (z ^ (z &gt;&gt; 27)) * 0x94D049BB133111EBUL;
        return z ^ (z &gt;&gt; 31);
    }

    public void NextBytes(byte[] dst)
    {
        int i = 0;
        while (i &lt; dst.Length)
        {
            ulong v = NextUInt64();
            for (int k = 0; k &lt; 8 &amp;&amp; i &lt; dst.Length; k++)
                dst[i++] = (byte)(v &gt;&gt; (56 - 8 * k));
        }
    }
}

enum Op { ADD_MOD, MUL_MOD, MODPOW }

record Result(string Impl, int Bits, Op Op, long Ops, double NsPerOp, long Checksum)
{
    public string ToJson() =&gt; string.Create(CultureInfo.InvariantCulture,
        $"{{\"lang\":\"{Impl}\",\"bits\":{Bits},\"op\":\"{Op}\",\"ops\":{Ops},\"nsPerOp\":{NsPerOp:F3},\"checksum\":{Checksum}}}");
}

static class BenchUtil
{
    public static void MaskToBitSize(byte[] buf, int bitSize)
    {
        int topBit = (bitSize - 1) % 8;
        int keepBits = topBit + 1;
        int firstMask = keepBits == 8 ? 0xFF : ((1 &lt;&lt; keepBits) - 1);
        buf[0] &amp;= (byte)firstMask;
        buf[0] |= (byte)(1 &lt;&lt; topBit);
    }

    public static string ToHex(byte[] bytes) =&gt; Convert.ToHexString(bytes);
}

static class BigIntegerBench
{
    public static BigInteger[] Gen(int bitSize, int count, ulong seed)
    {
        var rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        var arr = new BigInteger[count];
        var buf = new byte[byteLen];

        for (int i = 0; i &lt; count; i++)
        {
            rng.NextBytes(buf);
            BenchUtil.MaskToBitSize(buf, bitSize);
            arr[i] = new BigInteger(buf, isUnsigned: true, isBigEndian: true);
        }
        return arr;
    }

    public static BigInteger GenModulus(int bitSize, ulong seed)
    {
        var rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        var buf = new byte[byteLen];
        rng.NextBytes(buf);
        BenchUtil.MaskToBitSize(buf, bitSize);
        buf[^1] |= 1;
        return new BigInteger(buf, isUnsigned: true, isBigEndian: true);
    }

    public static long RunOnce(Op op, BigInteger[] a, BigInteger[] b, BigInteger[] e, BigInteger mod, int outer)
    {
        BigInteger acc = BigInteger.Zero;
        int n = a.Length;

        switch (op)
        {
            case Op.ADD_MOD:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                        acc ^= (a[i] + b[i]) % mod;
                break;

            case Op.MUL_MOD:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                        acc ^= (a[i] * b[i]) % mod;
                break;

            case Op.MODPOW:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                        acc ^= BigInteger.ModPow(a[i], e[i], mod);
                break;
        }

        return (long)(acc &amp; long.MaxValue);
    }
}

static class GmpIntegerBench
{
    public static GmpInteger[] Gen(int bitSize, int count, ulong seed)
    {
        var rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        var arr = new GmpInteger[count];
        var buf = new byte[byteLen];

        for (int i = 0; i &lt; count; i++)
        {
            rng.NextBytes(buf);
            BenchUtil.MaskToBitSize(buf, bitSize);
            arr[i] = GmpInteger.Parse(BenchUtil.ToHex(buf), 16);
        }
        return arr;
    }

    public static GmpInteger GenModulus(int bitSize, ulong seed)
    {
        var rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        var buf = new byte[byteLen];
        rng.NextBytes(buf);
        BenchUtil.MaskToBitSize(buf, bitSize);
        buf[^1] |= 1;
        return GmpInteger.Parse(BenchUtil.ToHex(buf), 16);
    }

    public static long RunOnce(Op op, GmpInteger[] a, GmpInteger[] b, GmpInteger[] e, GmpInteger mod, int outer)
    {
        using var acc = GmpInteger.From(0);
        using var tmp = GmpInteger.From(0);

        int n = a.Length;
        switch (op)
        {
            case Op.ADD_MOD:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                    {
                        GmpInteger.AddInplace(tmp, a[i], b[i]);
                        GmpInteger.ModInplace(tmp, tmp, mod);
                        GmpInteger.BitwiseXorInplace(acc, acc, tmp);
                    }
                break;

            case Op.MUL_MOD:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                    {
                        GmpInteger.MultiplyInplace(tmp, a[i], b[i]);
                        GmpInteger.ModInplace(tmp, tmp, mod);
                        GmpInteger.BitwiseXorInplace(acc, acc, tmp);
                    }
                break;

            case Op.MODPOW:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                    {
                        GmpInteger.PowerModInplace(tmp, a[i], e[i], mod);
                        GmpInteger.BitwiseXorInplace(acc, acc, tmp);
                    }
                break;
        }

        return acc.GetHashCode();
    }

    public static void DisposeAll(GmpInteger[] xs)
    {
        foreach (var x in xs) x.Dispose();
    }
}

static class Runner
{
    static Result BenchBigInteger(int bits, Op op, BigInteger[] a, BigInteger[] b, BigInteger[] e, BigInteger mod, long targetOps, int warmups, int measures)
    {
        int n = a.Length;
        int outer = (int)Math.Max(1, targetOps / n);
        long actualOps = (long)n * outer;

        long ck = 0;
        for (int i = 0; i &lt; warmups; i++) ck ^= BigIntegerBench.RunOnce(op, a, b, e, mod, outer);

        long[] timesNs = new long[measures];
        for (int i = 0; i &lt; measures; i++)
        {
            var sw = Stopwatch.StartNew();
            long c = BigIntegerBench.RunOnce(op, a, b, e, mod, outer);
            sw.Stop();
            ck ^= c;
            timesNs[i] = (long)(sw.ElapsedTicks * (1_000_000_000.0 / Stopwatch.Frequency));
        }
        Array.Sort(timesNs);
        long median = timesNs[timesNs.Length / 2];
        return new Result("csharp_bigint", bits, op, actualOps, (double)median / actualOps, ck);
    }

    static Result BenchGmpInteger(int bits, Op op, GmpInteger[] a, GmpInteger[] b, GmpInteger[] e, GmpInteger mod, long targetOps, int warmups, int measures)
    {
        int n = a.Length;
        int outer = (int)Math.Max(1, targetOps / n);
        long actualOps = (long)n * outer;

        long ck = 0;
        for (int i = 0; i &lt; warmups; i++) ck ^= GmpIntegerBench.RunOnce(op, a, b, e, mod, outer);

        long[] timesNs = new long[measures];
        for (int i = 0; i &lt; measures; i++)
        {
            var sw = Stopwatch.StartNew();
            long c = GmpIntegerBench.RunOnce(op, a, b, e, mod, outer);
            sw.Stop();
            ck ^= c;
            timesNs[i] = (long)(sw.ElapsedTicks * (1_000_000_000.0 / Stopwatch.Frequency));
        }
        Array.Sort(timesNs);
        long median = timesNs[timesNs.Length / 2];
        return new Result("csharp_gmp_inplace", bits, op, actualOps, (double)median / actualOps, ck);
    }

    public static int Run(string[] args)
    {
        bool json = args.Any(a =&gt; a == "--json");

        int warmups = 5;
        int measures = 11;
        int[] bitSizes = [256, 1024, 4096];

        var results = new List&lt;Result&gt;();

        foreach (int bits in bitSizes)
        {
            long addOps = bits switch { 256 =&gt; 2_000_000L, 1024 =&gt; 1_000_000L, _ =&gt; 200_000L };
            long mulOps = bits switch { 256 =&gt; 500_000L, 1024 =&gt; 120_000L, _ =&gt; 20_000L };
            long powOps = bits switch { 256 =&gt; 8_000L, 1024 =&gt; 1_500L, _ =&gt; 250L };

            // BigInteger data
            var modB = BigIntegerBench.GenModulus(bits, 0xA1B2C3D4E5F60708UL ^ (uint)bits);
            var aB = BigIntegerBench.Gen(bits, 1024, 0x1111222233334444UL ^ (uint)bits);
            var bB = BigIntegerBench.Gen(bits, 1024, 0x9999AAAABBBBCCCCUL ^ (uint)bits);
            var apB = BigIntegerBench.Gen(bits, 256, 0x13579BDF2468ACE0UL ^ (uint)bits);
            var epB = BigIntegerBench.Gen(Math.Min(bits, 512), 256, 0x0FEDCBA987654321UL ^ (uint)bits);

            // GmpInteger data (same seeds/bit sizes)
            using var modG = GmpIntegerBench.GenModulus(bits, 0xA1B2C3D4E5F60708UL ^ (uint)bits);
            var aG = GmpIntegerBench.Gen(bits, 1024, 0x1111222233334444UL ^ (uint)bits);
            var bG = GmpIntegerBench.Gen(bits, 1024, 0x9999AAAABBBBCCCCUL ^ (uint)bits);
            var apG = GmpIntegerBench.Gen(bits, 256, 0x13579BDF2468ACE0UL ^ (uint)bits);
            var epG = GmpIntegerBench.Gen(Math.Min(bits, 512), 256, 0x0FEDCBA987654321UL ^ (uint)bits);

            try
            {
                results.Add(BenchBigInteger(bits, Op.ADD_MOD, aB, bB, null!, modB, addOps, warmups, measures));
                results.Add(BenchBigInteger(bits, Op.MUL_MOD, aB, bB, null!, modB, mulOps, warmups, measures));
                results.Add(BenchBigInteger(bits, Op.MODPOW, apB, null!, epB, modB, powOps, warmups, measures));

                results.Add(BenchGmpInteger(bits, Op.ADD_MOD, aG, bG, null!, modG, addOps, warmups, measures));
                results.Add(BenchGmpInteger(bits, Op.MUL_MOD, aG, bG, null!, modG, mulOps, warmups, measures));
                results.Add(BenchGmpInteger(bits, Op.MODPOW, apG, null!, epG, modG, powOps, warmups, measures));
            }
            finally
            {
                GmpIntegerBench.DisposeAll(aG);
                GmpIntegerBench.DisposeAll(bG);
                GmpIntegerBench.DisposeAll(apG);
                GmpIntegerBench.DisposeAll(epG);
            }
        }

        if (json)
        {
            foreach (var r in results) Console.WriteLine(r.ToJson());
        }

        return 0;
    }
}

public static class Program
{
    public static int Main(string[] args) =&gt; Runner.Run(args);
}
</code></pre>
<p><strong><code>gmpbench.csproj</code>ï¼å®¢ä¸²çé¡¹ç®æä»¶ï¼</strong></p>
<pre><code class="language-xml">&lt;Project Sdk="Microsoft.NET.Sdk"&gt;
  &lt;PropertyGroup&gt;
    &lt;OutputType&gt;Exe&lt;/OutputType&gt;
    &lt;TargetFramework&gt;net10.0&lt;/TargetFramework&gt;
    &lt;Nullable&gt;enable&lt;/Nullable&gt;
    &lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include="Sdcb.Arithmetic.Gmp" Version="*" /&gt;
    &lt;PackageReference Include="Sdcb.Arithmetic.Gmp.runtime.linux-x64" Version="*" /&gt;
  &lt;/ItemGroup&gt;
&lt;/Project&gt;
</code></pre>
<h3 id="72-å®¢ä¸²å®éªåå§è¾åºjsonl">7.2 å®¢ä¸²å®éªåå§è¾åºï¼JSONLï¼</h3>
<pre><code class="language-jsonl">{"lang":"csharp_bigint","bits":256,"op":"ADD_MOD","ops":1999872,"nsPerOp":146.261,"checksum":0}
{"lang":"csharp_bigint","bits":256,"op":"MUL_MOD","ops":499712,"nsPerOp":560.246,"checksum":0}
{"lang":"csharp_bigint","bits":256,"op":"MODPOW","ops":7936,"nsPerOp":169713.608,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":256,"op":"ADD_MOD","ops":1999872,"nsPerOp":76.644,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":256,"op":"MUL_MOD","ops":499712,"nsPerOp":114.690,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":256,"op":"MODPOW","ops":7936,"nsPerOp":13931.914,"checksum":0}
{"lang":"csharp_bigint","bits":1024,"op":"ADD_MOD","ops":999424,"nsPerOp":297.335,"checksum":0}
{"lang":"csharp_bigint","bits":1024,"op":"MUL_MOD","ops":119808,"nsPerOp":4792.760,"checksum":0}
{"lang":"csharp_bigint","bits":1024,"op":"MODPOW","ops":1280,"nsPerOp":1938407.720,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":1024,"op":"ADD_MOD","ops":999424,"nsPerOp":97.260,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":1024,"op":"MUL_MOD","ops":119808,"nsPerOp":562.235,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":1024,"op":"MODPOW","ops":1280,"nsPerOp":218715.147,"checksum":0}
{"lang":"csharp_bigint","bits":4096,"op":"ADD_MOD","ops":199680,"nsPerOp":1280.760,"checksum":0}
{"lang":"csharp_bigint","bits":4096,"op":"MUL_MOD","ops":19456,"nsPerOp":36894.568,"checksum":0}
{"lang":"csharp_bigint","bits":4096,"op":"MODPOW","ops":256,"nsPerOp":20617970.004,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":4096,"op":"ADD_MOD","ops":199680,"nsPerOp":179.720,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":4096,"op":"MUL_MOD","ops":19456,"nsPerOp":5431.441,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":4096,"op":"MODPOW","ops":256,"nsPerOp":2662198.492,"checksum":0}
</code></pre>
<h3 id="73-å®¢ä¸²å¯è§åä»¥gmpä¸ºåºå">7.3 å®¢ä¸²å¯è§åï¼ä»¥GMPä¸ºåºåï¼</h3>
<p><img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260114225617406-1423853952.png" alt="bar_gmp_baseline_add_mod" loading="lazy"><br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260114225622152-863625745.png" alt="bar_gmp_baseline_mul_mod" loading="lazy"><br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260114225625327-2119127781.png" alt="bar_gmp_baseline_modpow" loading="lazy"></p>
<hr>
<h2 id="æ»ç»ä¸å±æ">æ»ç»ä¸å±æ</h2>
<p>ä»è¿æ¬¡âç¡¬ç¢°ç¡¬âçå¯¹å³ä¸­ï¼æä»¬å¯ä»¥æ¸æ°å°çå°ï¼å¨åºç¡å æ³ä¸ï¼.NET <code>BigInteger</code> ä¸ Java ä¸åä¼¯ä»²ï¼ä½å¨ä¹æ³ï¼å°¤å¶æ¯<strong>æ¨¡å¹è¿ç®</strong>ï¼å¯¹å¯ç å­¦ç­åºæ¯æå¶éè¦ï¼ä¸ï¼.NET ç®åç¡®å®å­å¨ææ¾çç­æ¿ï¼å¤§å¹è½åäº Javaã</p>
<p>æ¿è®¤ä¸è¶³æ¯æ¹è¿çå¼å§ãå¯¹äºç»å¤§å¤æ°ä¸å¡åºæ¯ï¼åç½®ç <code>BigInteger</code> ä¾ç¶å¤ç¨ä¸æ¹ä¾¿ãä½å¦æä½ çåºç¨å¤äºæ§è½ææåºï¼å¦å å¯ç®æ³ãç§å­¦è®¡ç®ï¼ï¼é£ä¹ä¹è®¸æ¯æ¶åèèä¸äºâéæ­¦å¨âäºã</p>
<p>è¿ä¹æ­£æ¯æå¼åå¹¶ç»´æ¤ <strong><a href="https://github.com/sdcb/Sdcb.Arithmetic" target="_blank" rel="noopener nofollow">Sdcb.Arithmetic</a></strong> çåè¡·ãå®éè¿å°è£ GMP ç­é«æ§è½åçåºï¼ä¸º .NET å¸¦æ¥äº<strong>åå°ä¿®æ¹ï¼in-placeï¼</strong>ä»¥åé«è¾¾æ°åçæ§è½æåï¼å¦æä¸­å®éªæç¤ºï¼ãå¦æä½ å¯¹æ§è½ææè´è¿½æ±ï¼æèæ³çç .NET å¨å¤§æ°è®¡ç®ä¸çæéï¼æ¬¢è¿å» GitHub ç¹ä¸ª Star â­ï¼è¯ä¸è¯è¿ä¸ªåºã</p>
<p>æè°¢éè¯»ï¼å¦æä½ è§å¾è¿ä¸¤ä¸ªè¯­è¨çå¯¹æ¯åææææï¼æèå¯¹ .NET é«æ§è½ç¼ç¨æå´è¶£ï¼æ¬¢è¿å¨è¯è®ºåºçè¨äº¤æµï¼ä¹æ¬¢è¿å å¥æç <strong>.NETéªæä½ QQç¾¤ï¼495782587</strong>ï¼æä»¬ä¸èµ·æ¢ç´¢æ´å¤ææ¯ç¡¬æ ¸ç©æ³ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-15 08:50">2026-01-15 08:50</span>&nbsp;
<a href="https://www.cnblogs.com/sdcb">.NETéªæä½</a>&nbsp;
éè¯»(<span id="post_view_count">117</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19484525);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19484525', targetLink: 'https://www.cnblogs.com/sdcb/p/19484525/20261113-big-integer-dotnet-10-vs-java', title: 'ä¸æè·ä¸ªåï¼.NET 10 å¤§æ´æ°è®¡ç®å¯¹éµ Javaï¼ç»æä»¤äººæå¤' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ãé¢è¯é¢ãä»ä¹æ¯è§å¯èæ¨¡å¼ï¼ä¸è¬ç¨å¨ä»ä¹åºæ¯ï¼ ]]></title>
    <link>https://www.cnblogs.com/sun-10387834/p/19452781</link>
    <guid>f6ee5c930b64c10950131c8e9b89cbf6</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/sun-10387834/p/19452781" title="åå¸äº 2026-01-15 08:38">
    <span role="heading" aria-level="2">ãé¢è¯é¢ãä»ä¹æ¯è§å¯èæ¨¡å¼ï¼ä¸è¬ç¨å¨ä»ä¹åºæ¯ï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="è§å¯èæ¨¡å¼æ¶æ¯ççå«å¦å°åé-">è§å¯èæ¨¡å¼ï¼æ¶æ¯çç"å«å¦å°åé" ð¢</h1>
<h2 id="ä¸ä»ä¹æ¯è§å¯èæ¨¡å¼">ä¸ãä»ä¹æ¯è§å¯èæ¨¡å¼ï¼</h2>
<p>æ³è±¡ä¸ä¸<strong>å¾®ä¿¡ç¾¤è</strong>ï¼</p>
<ul>
<li>ä½ åä¸æ¡æ¶æ¯ï¼åå¸äºä»¶ï¼</li>
<li>ç¾¤éææäººé½æ¶å°äºéç¥ï¼è§å¯èè¢«è§¦åï¼</li>
<li>æäºäººåå¤ï¼æäºäººç¹èµï¼æäºäººæ½æ°´ï¼ä¸åçååºï¼</li>
</ul>
<p>è¿å°±æ¯<strong>è§å¯èæ¨¡å¼</strong>ï¼<strong>ä¸ä¸ªå¯¹è±¡ï¼è¢«è§å¯èï¼çç¶æååï¼ä¼éç¥ææä¾èµå®çå¯¹è±¡ï¼è§å¯èï¼</strong>ã</p>
<h2 id="äºjavaä»£ç ç¤ºä¾ææåºè½¨çæç°åº-">äºãJavaä»£ç ç¤ºä¾ï¼ææåºè½¨çæç°åº ð¬</h2>
<pre><code class="language-java">import java.util.*;

// 1. è§å¯èæ¥å£ï¼åçç¾¤ä¼ï¼
interface GossipObserver {
    void update(String celebrityName, String scandal);
}

// 2. å·ä½è§å¯èï¼ä¸åååºçäºº
class ExcitedFan implements GossipObserver {
    private String name;
    
    public ExcitedFan(String name) {
        this.name = name;
    }
    
    @Override
    public void update(String celebrityName, String scandal) {
        System.out.println(name + "å´å¥å°å°å«ï¼OMGï¼" + celebrityName + "ç«ç¶" + scandal + "ï¼");
        System.out.println("    â ç«å»æå¼å¾®ååå¤åçð\n");
    }
}

class CalmJournalist implements GossipObserver {
    @Override
    public void update(String celebrityName, String scandal) {
        System.out.println("è®°èå·éå°è®°å½ï¼");
        System.out.println("    ãç¬å®¶çæã" + celebrityName + "è¢«æ" + scandal);
        System.out.println("    â å¼å§åæ°é»ç¨¿ð°\n");
    }
}

class IndifferentPerson implements GossipObserver {
    @Override
    public void update(String celebrityName, String scandal) {
        System.out.println("è·¯äººç²ç¥äºä¸ç¼ï¼");
        System.out.println("    " + celebrityName + "ï¼ä¸è®¤è¯ãå³æå±äºð");
        System.out.println("    â ç»§ç»­å·æé³\n");
    }
}

// 3. ä¸»é¢/è¢«è§å¯èæ¥å£ï¼å«å¦ä¸­å¿ï¼
interface GossipSubject {
    void addObserver(GossipObserver observer);  // æ·»å åçç¾¤ä¼
    void removeObserver(GossipObserver observer); // ç§»é¤åçç¾¤ä¼
    void notifyObservers();  // åå¸å«å¦
}

// 4. å·ä½ä¸»é¢ï¼ææå«å¦
class CelebrityScandal implements GossipSubject {
    private String celebrityName;
    private String scandal;
    private List&lt;GossipObserver&gt; observers = new ArrayList&lt;&gt;();
    
    public CelebrityScandal(String name) {
        this.celebrityName = name;
    }
    
    // ææææ°çäºï¼
    public void newScandal(String scandal) {
        this.scandal = scandal;
        System.out.println("â¡â¡â¡ çä»éæå°ï¼" + celebrityName + " " + scandal + "ï¼");
        System.out.println("å«å¦å¼å§ä¼ æ­...\n");
        notifyObservers();  // éç¥ææåçç¾¤ä¼
    }
    
    @Override
    public void addObserver(GossipObserver observer) {
        observers.add(observer);
        System.out.println("ð¥ " + observer.getClass().getSimpleName() + " å å¥äºåçç¾¤");
    }
    
    @Override
    public void removeObserver(GossipObserver observer) {
        observers.remove(observer);
        System.out.println("ð¶ " + observer.getClass().getSimpleName() + " éç¾¤äº");
    }
    
    @Override
    public void notifyObservers() {
        for (GossipObserver observer : observers) {
            observer.update(celebrityName, scandal);
        }
    }
}

// 5. æµè¯ï¼å¨±ä¹åå¤§æä¸æ¼
public class ObserverPatternDemo {
    public static void main(String[] args) {
        System.out.println("========== å¨±ä¹åè§å¯èæ¨¡å¼æ¼ç¤º ==========\n");
        
        // åå»ºå«å¦ä¸­å¿ï¼è¢«è§å¯èï¼
        CelebrityScandal wang = new CelebrityScandal("çæ");
        
        // åå»ºä¸åçåçç¾¤ä¼ï¼è§å¯èï¼
        GossipObserver fan1 = new ExcitedFan("çç­ç²ä¸å°å¼ ");
        GossipObserver fan2 = new ExcitedFan("åçå°å¥³å°æ");
        GossipObserver journalist = new CalmJournalist();
        GossipObserverè·¯äºº = new IndifferentPerson();
        
        // ç¾¤ä¼éç»­å å¥åçç¾¤
        wang.addObserver(fan1);
        wang.addObserver(fan2);
        wang.addObserver(journalist);
        wang.addObserver(è·¯äºº);
        
        System.out.println("\n------- ç¬¬ä¸æ³¢çæ -------");
        // ç¬¬ä¸æ³¢çæ
        wang.newScandal("æ·±å¤ä¸ç¥ç§å¥³å­ååéåº");
        
        System.out.println("\n------- ç²ä¸éç¾¤åç¬¬äºæ³¢çæ -------");
        // å°å¼ éç¾¤äº
        wang.removeObserver(fan1);
        
        // ç¬¬äºæ³¢çæ
        wang.newScandal("è¢«æå°å¨è¶å¸å·åè¯åå");
    }
}
</code></pre>
<p><strong>è¿è¡ç»æï¼</strong></p>
<pre><code>========== å¨±ä¹åè§å¯èæ¨¡å¼æ¼ç¤º ==========

ð¥ ExcitedFan å å¥äºåçç¾¤
ð¥ ExcitedFan å å¥äºåçç¾¤
ð¥ CalmJournalist å å¥äºåçç¾¤
ð¥ IndifferentPerson å å¥äºåçç¾¤

------- ç¬¬ä¸æ³¢çæ -------
â¡â¡â¡ çä»éæå°ï¼çæ æ·±å¤ä¸ç¥ç§å¥³å­ååéåºï¼
å«å¦å¼å§ä¼ æ­...

çç­ç²ä¸å°å¼ å´å¥å°å°å«ï¼OMGï¼çæç«ç¶æ·±å¤ä¸ç¥ç§å¥³å­ååéåºï¼
    â ç«å»æå¼å¾®ååå¤åçð

åçå°å¥³å°æå´å¥å°å°å«ï¼OMGï¼çæç«ç¶æ·±å¤ä¸ç¥ç§å¥³å­ååéåºï¼
    â ç«å»æå¼å¾®ååå¤åçð

è®°èå·éå°è®°å½ï¼
    ãç¬å®¶çæãçæè¢«ææ·±å¤ä¸ç¥ç§å¥³å­ååéåº
    â å¼å§åæ°é»ç¨¿ð°

è·¯äººç²ç¥äºä¸ç¼ï¼
    çæï¼ä¸è®¤è¯ãå³æå±äºð
    â ç»§ç»­å·æé³


------- ç²ä¸éç¾¤åç¬¬äºæ³¢çæ -------
ð¶ ExcitedFan éç¾¤äº
â¡â¡â¡ çä»éæå°ï¼çæ è¢«æå°å¨è¶å¸å·åè¯ååï¼
å«å¦å¼å§ä¼ æ­...

åçå°å¥³å°æå´å¥å°å°å«ï¼OMGï¼çæç«ç¶è¢«æå°å¨è¶å¸å·åè¯ååï¼
    â ç«å»æå¼å¾®ååå¤åçð

è®°èå·éå°è®°å½ï¼
    ãç¬å®¶çæãçæè¢«æè¢«æå°å¨è¶å¸å·åè¯åå
    â å¼å§åæ°é»ç¨¿ð°

è·¯äººç²ç¥äºä¸ç¼ï¼
    çæï¼ä¸è®¤è¯ãå³æå±äºð
    â ç»§ç»­å·æé³
</code></pre>
<h2 id="ä¸è§å¯èæ¨¡å¼çåè¦ç´ ">ä¸ãè§å¯èæ¨¡å¼çåè¦ç´ </h2>
<pre><code class="language-java">// 1ï¸â£ ä¸»é¢ (Subject) - "å«å¦ä¸­å¿"
// è´è´£ï¼ç®¡çè§å¯è + éç¥åå
interface Subject {
    void addObserver(Observer o);
    void removeObserver(Observer o);
    void notifyObservers();
}

// 2ï¸â£ è§å¯è (Observer) - "åçç¾¤ä¼"  
// è´è´£ï¼å®ä¹ååºæ¹å¼
interface Observer {
    void update(Object data);
}

// 3ï¸â£ å·ä½ä¸»é¢ (ConcreteSubject) - "å·ä½ææ"
// è´è´£ï¼ç¶æååæ¶è§¦åéç¥
class ConcreteSubject implements Subject {
    private List&lt;Observer&gt; observers = new ArrayList&lt;&gt;();
    private Object state;  // ç¶æ
    
    public void setState(Object newState) {
        this.state = newState;
        notifyObservers();  // ç¶ææ¹åï¼éç¥ææäººï¼
    }
}

// 4ï¸â£ å·ä½è§å¯è (ConcreteObserver) - "å·ä½ç²ä¸"
// è´è´£ï¼å®ç°å·ä½çååºé»è¾
class ConcreteObserver implements Observer {
    @Override
    public void update(Object data) {
        // å¯¹ç¶æååçååº
    }
}
</code></pre>
<h2 id="åä»ä¹æ¶åç¨è§å¯èæ¨¡å¼">åãä»ä¹æ¶åç¨è§å¯èæ¨¡å¼ï¼</h2>
<h3 id="-éç¨åºæ¯ä¸ä¸ªå­è¦éç¥">ð¯ <strong>éç¨åºæ¯ï¼ä¸ä¸ªå­ï¼è¦éç¥ï¼ï¼</strong></h3>
<ol>
<li>
<p><strong>äºä»¶é©±å¨ç³»ç»</strong> - "æäºåçï¼é©¬ä¸æ¥åï¼"</p>
<pre><code class="language-java">// GUIæé®ç¹å»äºä»¶
button.addActionListener(new ActionListener() {
    @Override
    public void actionPerformed(ActionEvent e) {
        System.out.println("æé®è¢«ç¹äºï¼");
    }
});
</code></pre>
</li>
<li>
<p><strong>æ¶æ¯è®¢éç³»ç»</strong> - "æææ°æ¶æ¯ï¼è®¢éèè¯·æ¥æ¶"</p>
<pre><code class="language-java">// æ°é»è®¢é
newsPublisher.subscribe(user1);
newsPublisher.subscribe(user2);
// æ°æç« åå¸ â ææè®¢éèæ¶å°æ¨é
</code></pre>
</li>
<li>
<p><strong>æ°æ®çæ§ç³»ç»</strong> - "æ°æ®åäºï¼å¿«æ´æ°æ¾ç¤ºï¼"</p>
<pre><code class="language-java">// è¡ç¥¨ä»·æ ¼çæ§
stock.addObserver(new StockDisplay());  // æ¾ç¤ºæ¿
stock.addObserver(new AlertSystem());   // è­¦æ¥ç³»ç»
stock.addObserver(new TraderBot());     // èªå¨äº¤ææºå¨äºº
// è¡ä»·åå¨ â ææè§å¯èç«å³è¡å¨
</code></pre>
</li>
<li>
<p><strong>MVCæ¨¡å¼</strong> - "æ¨¡ååäºï¼è§å¾å¿«å·æ°"</p>
<pre><code class="language-java">// Modelæ°æ®åå
model.setData(newData);  
// â èªå¨éç¥ææå³èçViewæ´æ°çé¢
</code></pre>
</li>
</ol>
<h3 id="-å®éé¡¹ç®ä¸­çä¾å­">ð¦ <strong>å®éé¡¹ç®ä¸­çä¾å­</strong></h3>
<pre><code class="language-java">// çµåè®¢åç¶æéç¥ç³»ç»
class Order {
    private List&lt;OrderObserver&gt; observers = new ArrayList&lt;&gt;();
    private String status;
    
    public void setStatus(String newStatus) {
        this.status = newStatus;
        notifyObservers();
    }
    
    public void addObserver(OrderObserver observer) {
        observers.add(observer);
    }
    
    private void notifyObservers() {
        for (OrderObserver observer : observers) {
            observer.onOrderStatusChanged(this, status);
        }
    }
}

// ä¸åçè§å¯è
class CustomerNotifier implements OrderObserver {
    public void onOrderStatusChanged(Order order, String status) {
        sendSMS("å°æ¬çå®¢æ·ï¼æ¨çè®¢åç¶æå·²æ´æ°ä¸ºï¼" + status);
    }
}

class WarehouseSystem implements OrderObserver {
    public void onOrderStatusChanged(Order order, String status) {
        if ("å·²æ¯ä»".equals(status)) {
            prepareGoods(order);  // åå¤åè´§
        }
    }
}

class AccountingSystem implements OrderObserver {
    public void onOrderStatusChanged(Order order, String status) {
        if ("å·²å®æ".equals(status)) {
            recordRevenue(order);  // è®°å½æ¶å¥
        }
    }
}
</code></pre>
<h2 id="äºè§å¯èæ¨¡å¼çåä½">äºãè§å¯èæ¨¡å¼çåä½</h2>
<h3 id="1-æ¨æ¨¡å-vs-ææ¨¡å">1. <strong>æ¨æ¨¡å vs ææ¨¡å</strong></h3>
<pre><code class="language-java">// æ¨æ¨¡åï¼ææ°æ®ç´æ¥æ¨ç»è§å¯èï¼å¸¸ç¨ï¼
void update(String celebrity, String scandal) {
    // ç´æ¥æ¿å°ææä¿¡æ¯
}

// ææ¨¡åï¼è§å¯èèªå·±ä»ä¸»é¢æåæ°æ®
void update(Subject subject) {
    String scandal = subject.getScandal();  // èªå·±è·åéè¦çæ°æ®
}
</code></pre>
<h3 id="2-javaåç½®æ¯æå·²è¿æ¶ä½è¦ç¥é">2. <strong>Javaåç½®æ¯æï¼å·²è¿æ¶ä½è¦ç¥éï¼</strong></h3>
<pre><code class="language-java">import java.util.Observable;  // ä¸»é¢
import java.util.Observer;    // è§å¯è

// ä½æ³¨æï¼Observableæ¯ç±»ä¸æ¯æ¥å£ï¼Java 9åå·²åºå¼
</code></pre>
<h3 id="3-äºä»¶æ»çº¿event-bus---è§å¯èæ¨¡å¼çåçº§ç">3. <strong>äºä»¶æ»çº¿ï¼Event Busï¼</strong> - è§å¯èæ¨¡å¼çåçº§ç</h3>
<pre><code class="language-java">// æ´çµæ´»çäºä»¶å¤ç
eventBus.register(subscriber);  // æ³¨åè®¢éè
eventBus.post(new OrderEvent());  // åå¸äºä»¶
// ææå¯¹OrderEventæå´è¶£çè®¢éèé½ä¼æ¶å°
</code></pre>
<h2 id="å­è§å¯èæ¨¡å¼çä¼ç¼ºç¹">å­ãè§å¯èæ¨¡å¼çä¼ç¼ºç¹</h2>
<h3 id="-ä¼ç¹">ð <strong>ä¼ç¹</strong></h3>
<ul>
<li><strong>æ¾è¦å</strong>ï¼ä¸»é¢ä¸ç¥éè§å¯èçå·ä½ç»èï¼åªç¥éæ¥å£</li>
<li><strong>å¨ææ·»å </strong>ï¼è¿è¡æ¶å¯ä»¥éæ¶æ·»å /ç§»é¤è§å¯è</li>
<li><strong>ä¸å¯¹å¤éç¥</strong>ï¼ä¸ä¸ªååå¯ä»¥éç¥å¤ä¸ªå¯¹è±¡</li>
<li><strong>ç¬¦åå¼é­åå</strong>ï¼æ°å¢è§å¯èæ éä¿®æ¹ä¸»é¢</li>
</ul>
<h3 id="-ç¼ºç¹">ð <strong>ç¼ºç¹</strong></h3>
<ul>
<li><strong>åå­æ³æ¼é£é©</strong>ï¼å¦æè§å¯èæ²¡æ­£ç¡®ç§»é¤ï¼å¯è½æ æ³è¢«åå¾åæ¶</li>
<li><strong>éç¥é¡ºåºä¸ç¡®å®</strong>ï¼è§å¯èè¢«éç¥çé¡ºåºéå¸¸æ æ³ä¿è¯</li>
<li><strong>æ§è½é®é¢</strong>ï¼è§å¯èå¤ªå¤æ¶ï¼éç¥å¯è½åæ¢</li>
<li><strong>å¾ªç¯ä¾èµ</strong>ï¼è§å¯èä¹é´ç¸äºè§å¯å¯è½å¯¼è´æ­»å¾ªç¯</li>
</ul>
<h3 id="-æ³¨æäºé¡¹">ð¨ <strong>æ³¨æäºé¡¹</strong></h3>
<pre><code class="language-java">// 1. é¿åå¨è§å¯èæ¹æ³ä¸­ä¿®æ¹ä¸»é¢ï¼å¯è½å¯¼è´å¾ªç¯æå¼å¸¸ï¼
@Override
public void update(Subject subject) {
    // â éè¯¯åæ³ï¼å¯è½å¯¼è´éå½è°ç¨
    subject.setState("æ°ç¶æ");  
    
    // â æ­£ç¡®åæ³ï¼åªè¯»åä¸ä¿®æ¹
    String state = subject.getState();
}

// 2. èèå¼æ­¥éç¥ï¼é¿åé»å¡ï¼
class AsyncSubject extends Subject {
    private ExecutorService executor = Executors.newCachedThreadPool();
    
    @Override
    protected void notifyObservers() {
        for (Observer observer : observers) {
            executor.submit(() -&gt; observer.update(data));  // å¼æ­¥æ§è¡
        }
    }
}
</code></pre>
<h2 id="ä¸ä¸å¶ä»æ¨¡å¼çå³ç³»">ä¸ãä¸å¶ä»æ¨¡å¼çå³ç³»</h2>
<table>
<thead>
<tr>
<th>æ¨¡å¼</th>
<th>å³ç³»</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>åå¸-è®¢éæ¨¡å¼</strong></td>
<td>è§å¯èæ¨¡å¼çåçº§çï¼éè¿æ¶æ¯éåè§£è¦</td>
</tr>
<tr>
<td><strong>ä¸­ä»èæ¨¡å¼</strong></td>
<td>é½æ¯å¤çå¯¹è±¡é´éä¿¡ï¼ä½ä¸­ä»èæ¯éä¸­å¼ç®¡ç</td>
</tr>
<tr>
<td><strong>è´£ä»»é¾æ¨¡å¼</strong></td>
<td>é½æ¯ä¼ éäºä»¶ï¼ä½è´£ä»»é¾æ¯é¾å¼å¤ç</td>
</tr>
</tbody>
</table>
<h2 id="å«çæ´»ä¸­çè§å¯èæ¨¡å¼">å«ãçæ´»ä¸­çè§å¯èæ¨¡å¼</h2>
<table>
<thead>
<tr>
<th>åºæ¯</th>
<th>ä¸»é¢</th>
<th>è§å¯è</th>
<th>è§¦åæ¶æº</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>å¾®ä¿¡ç¾¤</strong></td>
<td>ç¾¤ä¸»</td>
<td>ç¾¤æå</td>
<td>æäººåæ¶æ¯</td>
</tr>
<tr>
<td><strong>å¤©æ°é¢æ¥</strong></td>
<td>æ°è±¡å±</td>
<td>ææºAPP/çµè§å°</td>
<td>å¤©æ°æ°æ®æ´æ°</td>
</tr>
<tr>
<td><strong>ç½çº¢ç´æ­</strong></td>
<td>ä¸»æ­</td>
<td>è§ä¼</td>
<td>å¼å§ç´æ­</td>
</tr>
<tr>
<td><strong>GitHubä»åº</strong></td>
<td>ä»£ç ä»åº</td>
<td>Starçç¨æ·</td>
<td>ææ°æäº¤</td>
</tr>
<tr>
<td><strong>çµåææ</strong></td>
<td>åå</td>
<td>æ¶èçç¨æ·</td>
<td>ä»·æ ¼åå</td>
</tr>
</tbody>
</table>
<h2 id="ä¹æ»ç»ä¸å¥è¯è®°ä½">ä¹ãæ»ç»ï¼ä¸å¥è¯è®°ä½</h2>
<p><strong>è§å¯èæ¨¡å¼ = "æææåµï¼é©¬ä¸éç¥å¤§å®¶"</strong></p>
<ul>
<li><strong>ä¸»é¢</strong>ï¼å°±æ¯é£ä¸ª"ææåµçäºº"</li>
<li><strong>è§å¯è</strong>ï¼å°±æ¯"ç­çå¬æ¶æ¯çäºº"</li>
<li><strong>æ ¸å¿ææ³</strong>ï¼<strong>è§£è¦</strong> + <strong>èªå¨éç¥</strong></li>
</ul>
<h3 id="-ä½¿ç¨æ¶æºå¤æ­è¡¨">ð <strong>ä½¿ç¨æ¶æºå¤æ­è¡¨</strong></h3>
<p>é®èªå·±è¿äºé®é¢ï¼</p>
<ol>
<li>â ä¸ä¸ªå¯¹è±¡çç¶æååéè¦éç¥å¶ä»å¯¹è±¡åï¼</li>
<li>â è¢«éç¥çå¯¹è±¡æ°éä¸ç¡®å®æå¯è½åååï¼</li>
<li>â ä¸æ³è®©è¿äºå¯¹è±¡ç´§å¯è¦ååï¼</li>
</ol>
<p>å¦æé½æ¯"æ¯" â ç¨è§å¯èæ¨¡å¼ï¼</p>
<h3 id="-æä½³å®è·µ">ð¯ <strong>æä½³å®è·µ</strong></h3>
<ol>
<li><strong>ä¼åç¨æ¥å£</strong>ï¼ä¸»é¢åè§å¯èé½ç¨æ¥å£å®ä¹</li>
<li><strong>èèçº¿ç¨å®å¨</strong>ï¼å¤çº¿ç¨ç¯å¢ä¸è¦åæ­¥</li>
<li><strong>é¿åè¿åº¦ä½¿ç¨</strong>ï¼ç®åçåè°å¯è½å°±å¤äº</li>
<li><strong>ä½¿ç¨ç°ææ¡æ¶</strong>ï¼Springäºä»¶ãGuava EventBusç­</li>
</ol>
<p>è®°ä½å£è¯ï¼<strong>"ç¶æåï¼åéç¥ï¼è§å¯èï¼èªå¨å¨ï¼æ¾è¦åï¼çè½»æ¾ï¼"</strong> ð</p>

</div>
<div id="MySignature" role="contentinfo">
    
<p>â¤ï¸ å¦æä½ åæ¬¢è¿ç¯æç« ï¼è¯·ç¹èµæ¯æï¼ ð åæ¶æ¬¢è¿å³æ³¨æçåå®¢ï¼è·åæ´å¤ç²¾å½©åå®¹ï¼</p>

<p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/sun-10387834/" target="_blank">ä½ç¥è®©ææ¥å·¡å±±</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/sun-10387834/p/19452781" target="_blank">https://www.cnblogs.com/sun-10387834/p/19452781</a></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-15 08:38">2026-01-15 08:38</span>&nbsp;
<a href="https://www.cnblogs.com/sun-10387834">ä½ç¥è®©ææ¥å·¡å±±</a>&nbsp;
éè¯»(<span id="post_view_count">25</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19452781);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19452781', targetLink: 'https://www.cnblogs.com/sun-10387834/p/19452781', title: 'ãé¢è¯é¢ãä»ä¹æ¯è§å¯èæ¨¡å¼ï¼ä¸è¬ç¨å¨ä»ä¹åºæ¯ï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½ï¼Windows/Linuxï¼ ]]></title>
    <link>https://www.cnblogs.com/tokepson/p/19358930</link>
    <guid>bec0490eaf43fd73090bf6e88fb55e04</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/tokepson/p/19358930" title="åå¸äº 2026-01-15 00:58">
    <span role="heading" aria-level="2">Mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½ï¼Windows/Linuxï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3027557/202601/3027557-20260115005726963-1064528741.png" alt="Mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½ï¼Windows/Linuxï¼" class="desc_img">
        ### Mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½ï¼Windows/Linuxï¼

&gt;åè¨ï¼
åååï¼ï¼ï¼ä¸å¤è¯´äºï¼ç´æ¥çæ­£æå§

### Windows
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h3 id="mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½windowslinux">Mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½ï¼Windows/Linuxï¼</h3>
<blockquote>
<p>åè¨ï¼<br>
åååï¼ï¼ï¼ä¸å¤è¯´äºï¼ç´æ¥çæ­£æå§</p>
</blockquote>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202601/3027557-20260115005731844-1896204594.jpg" alt="20160513024330_39701" loading="lazy"></p>
<h3 id="windows">Windows</h3>
<p><em>ç¸å³æç¨ï¼</em> <a href="https://blog.csdn.net/R_Feynman_/article/details/147523049" target="_blank" rel="noopener nofollow">ç¬¬ä¸éï¼MySQLä¸è½½è¶ç»æç¨ï¼è¯¦ç»å°æ¯ä¸å°æ­¥ï¼</a></p>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216182550108-1208756501.png" alt="image" width="800" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216182516662-1356207044.png" alt="image" width="800" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216182251339-1241286922.png" alt="image" width="800" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216182213741-1061580300.png" alt="image" width="800" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216182006041-375477595.png" alt="image" width="800" loading="lazy"></p>
<p>ï¼æ²¡æå®ï¼æå¾æäºï¼ç­ä¸æ¬¡åç¢°å°åè¡¥ä¸å§ï¼ç´¯äºï¼å°æ¶ååè¡¥åäºMySQLå¸¸ç¨å½ä»¤ï¼ä»¥åä¸äºå¯è½ä¼åºç°çæ¼æ´ââââä¸è¬æ¥è®²æ­£å¸¸å®è£å°±è¡ï¼åªå¨å®¢æ·æºä½¿ç¨Customï¼æå¡å¨ä½¿ç¨ç¨Serverï¼é½å®è£å°±ç¨Fullï¼åé¢åå¡«åç¨æ·åå¯ç å³å¯ï¼å¶ä»æç¨ä¹æåè¯¦ç»è§£éï¼</p>
<hr>
<h3 id="linuxubuntu">Linuxï¼Ubuntuï¼</h3>
<p><em>ç¸å³æç¨ï¼</em> <a href="https://www.cnblogs.com/zhuchunlin/p/18562893" target="_blank">MySQL - ä¸è½½ä¸å®è£éç½®ï¼Linuxï¼</a></p>
<pre><code class="language-bash">sudo apt-get update
</code></pre>
<pre><code class="language-bash">sudo apt-get install -y mysql-server mysql-client
</code></pre>
<pre><code class="language-bash">sudo vi /etc/mysql/mysql.conf.d/mysqld.cnf
</code></pre>
<p>æ¾å°[mysqld]éé¡¹ç»ä¸­çbind-addressï¼ç¶åä½¿ç¨i é®è¿å¥ç¼è¾æ¨¡å¼ï¼å¹¶è¾å¥#æ³¨éæè¯¥è¡ãä¿®æ¹çæç»ç»æå¦ä¸å¾æåä¸è¡æç¤ºã</p>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216184740806-1135866084.png" alt="image" width="800" loading="lazy"></p>
<pre><code class="language-bash">sudo systemctl status mysql #æ¥çmysqlæå¡çç¶æ
</code></pre>
<pre><code class="language-bash">sudo systemctl start mysql #å¯å¨MySQLæå¡
</code></pre>
<pre><code class="language-bash">sudo systemctl stop mysql #åæ­¢MySQLæå¡
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216184846284-1413312583.png" alt="image" width="600" loading="lazy"></p>
<pre><code class="language-bash">sudo vim /etc/mysql/debian.cnf
</code></pre>
<pre><code># MySQLå®¢æ·ç«¯éç½®æä»¶
# åªåå«å®¢æ·ç«¯ç¸å³çéç½®éé¡¹

[client]
# é»è®¤è¿æ¥å°æ¬å°MySQL
host = localhost
user = root
socket = /var/run/mysqld/mysqld.sock

[mysql]
# è®¾ç½®å½ä»¤æç¤ºç¬¦
prompt = (\u@\h) [\d]&gt;\_
# å¯ç¨èªå¨è¡¥å¨
auto-rehash = TRUE
# æ¾ç¤ºåå
column-names = TRUE

[mysqladmin]
[mysqlcheck]
[mysqldump]
[mysqlimport]
[mysqlshow]
[mysqlslap]

</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216185117506-12438712.png" alt="image" width="600" loading="lazy"></p>
<p>ä½¿ç¨æä»¶ä¸­çåå§ç¨æ·ååå¯ç ç»å½mysql</p>
<pre><code class="language-bash">mysql -u debian-sys-maint -p pfdKSjeFFhJtdGkr
</code></pre>
<pre><code class="language-bash">update mysql.user set authentication_string=password('123456') where user='root' and host='localhost';
</code></pre>
<p><strong>éå°çéè¯¯é®é¢</strong></p>
<pre><code># ç¬¬1åéï¼æ£æ¥æå¡ç¶æ
sudo systemctl status mysql
sudo systemctl restart mysql

# ç¬¬2åéï¼ä¿®å¤æä»¶æé
sudo chmod 644 /etc/mysql/debian.cnf

# ç¬¬3åéï¼ç»å½ç³»ç»è´¦æ·
mysql --defaults-extra-file=/etc/mysql/debian.cnf

# ç¬¬4åéï¼éç½®rootå¯ç ï¼å¨MySQLä¸­æ§è¡ï¼
ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';
FLUSH PRIVILEGES;
exit;

# ç¬¬5åéï¼æµè¯ç»å½
mysql -u root -p123456
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216194106977-213894387.png" alt="image" loading="lazy"></p>
<p><strong>æµè¯ææ</strong></p>
<pre><code class="language-bash">SELECT VERSION(), USER(), NOW();
SELECT 1+2*3-4/5;
</code></pre>
<hr>
<h3 id="linuxcentos">Linuxï¼CentOSï¼</h3>
<p><em>ç¸å³æç¨ï¼</em> <a href="https://cloud.tencent.com/developer/article/2372374" target="_blank" rel="noopener nofollow">Linux MySQLä¸è½½å®è£è¯¦ç»æç¨ï¼CentOSçï¼</a></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-15 00:58">2026-01-15 00:58</span>&nbsp;
<a href="https://www.cnblogs.com/tokepson">TokE648</a>&nbsp;
éè¯»(<span id="post_view_count">46</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19358930);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19358930', targetLink: 'https://www.cnblogs.com/tokepson/p/19358930', title: 'Mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½ï¼Windows/Linuxï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ çº¿ç¨æ± ä»¥åHashTable, HashMap, ConcurrentHashMapä¹é´çåºå« ]]></title>
    <link>https://www.cnblogs.com/xi-yongqi/p/19484107</link>
    <guid>fd04ecb768833a2b23ef1b0d0e6b3c59</guid>
    <description>
    <![CDATA[ 
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xi-yongqi/p/19484107" title="åå¸äº 2026-01-15 00:29">
    <span role="heading" aria-level="2">çº¿ç¨æ± ä»¥åHashTable, HashMap, ConcurrentHashMapä¹é´çåºå«</span>
    

</a>

		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h3 id="ä»ä¹æ¯çº¿ç¨æ± ">ä»ä¹æ¯çº¿ç¨æ± </h3>
<h5 id="çº¿ç¨æ± thread-poolæ¯ä¸ç§çº¿ç¨ä½¿ç¨æ¨¡å¼æååå»ºä¸å®æ°éççº¿ç¨å¹¶è¿è¡å¤ç¨ç»ä¸ç®¡ççº¿ç¨çåå»ºéæ¯åè°åº¦ä»è">çº¿ç¨æ± ï¼Thread Poolï¼æ¯ä¸ç§çº¿ç¨ä½¿ç¨æ¨¡å¼ï¼æååå»ºä¸å®æ°éççº¿ç¨å¹¶è¿è¡å¤ç¨ï¼ç»ä¸ç®¡ççº¿ç¨çåå»ºãéæ¯åè°åº¦ï¼ä»èï¼</h5>
<ul>
<li>éä½çº¿ç¨åå»ºåéæ¯çå¼é</li>
<li>æé«ç¨åºååºéåº¦</li>
<li>é²æ­¢çº¿ç¨æ°éå¤±æ§å¯¼è´ç³»ç»èµæºèå°½</li>
</ul>
<h3 id="çº¿ç¨æ± çæ ¸å¿åæ°">çº¿ç¨æ± çæ ¸å¿åæ°</h3>
<ul>
<li>Javaä¸­çº¿ç¨æ± çæ ¸å¿å®ç°ç±»æ¯ ThreadPoolExecutorã</li>
</ul>
<pre><code class="language-java">public ThreadPoolExecutor(
    int corePoolSize,
    int maximumPoolSize,
    long keepAliveTime,
    TimeUnit unit,
    BlockingQueue&lt;Runnable&gt; workQueue,
    ThreadFactory threadFactory,
    RejectedExecutionHandler handler
)
</code></pre>
<ol>
<li>corePoolSizeï¼æ ¸å¿çº¿ç¨æ°ï¼</li>
</ol>
<ul>
<li>çº¿ç¨æ± ä¸­é¿æå­æ´»ççº¿ç¨æ°é</li>
<li>å³ä½¿ç©ºé²ï¼ä¹ä¸ä¼è¢«éæ¯ï¼é¤éè®¾ç½®åè®¸åæ¶ï¼</li>
<li>ä½ç¨ï¼ä¿è¯çº¿ç¨æ± çåºæ¬å¤çè½å</li>
</ul>
<ol start="2">
<li>maximumPoolSizeï¼æå¤§çº¿ç¨æ°ï¼</li>
</ol>
<ul>
<li>çº¿ç¨æ± ä¸­åè®¸å­å¨çæå¤§çº¿ç¨æ°é</li>
<li>å½ä»»å¡å¾å¤ãéåå·²æ»¡æ¶ï¼æä¼åå»ºæ°çº¿ç¨</li>
<li>ä½ç¨ï¼éå¶çº¿ç¨æ°éï¼é²æ­¢èµæºèå°½</li>
</ul>
<ol start="3">
<li>keepAliveTimeï¼ç©ºé²å­æ´»æ¶é´ï¼</li>
</ol>
<ul>
<li>éæ ¸å¿çº¿ç¨ç©ºé²æ¶ï¼æå¤å­æ´»æ¶é´</li>
<li>è¶è¿è¯¥æ¶é´å°è¢«åæ¶</li>
</ul>
<ol start="4">
<li>unitï¼æ¶é´åä½ï¼</li>
</ol>
<ul>
<li>keepAliveTime çæ¶é´åä½</li>
<li>å¦ï¼TimeUnit.SECONDS</li>
</ul>
<ol start="5">
<li>workQueueï¼ä»»å¡éåï¼</li>
</ol>
<ul>
<li>ç¨äºå­æ¾ç­å¾æ§è¡çä»»å¡</li>
<li>å¸¸è§å®ç°ï¼</li>
</ul>
<table>
<thead>
<tr>
<th>éå</th>
<th>ç¹ç¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>LinkedBlockingQueue</td>
<td>æ çéåï¼å¯è½ OOMï¼</td>
</tr>
<tr>
<td>ArrayBlockingQueue</td>
<td>æçéå</td>
</tr>
<tr>
<td>SynchronousQueue</td>
<td>ä¸å­ä»»å¡ï¼ç´æ¥äº¤ç»çº¿ç¨</td>
</tr>
<tr>
<td>DelayQueue</td>
<td>å»¶æ¶ä»»å¡</td>
</tr>
</tbody>
</table>
<ol start="6">
<li>threadFactoryï¼çº¿ç¨å·¥åï¼</li>
</ol>
<ul>
<li>ç¨äºåå»ºçº¿ç¨</li>
<li>å¯èªå®ä¹çº¿ç¨åãä¼åçº§ãæ¯å¦å®æ¤çº¿ç¨</li>
<li>æ¹ä¾¿ææ¥é®é¢ãæ¥å¿å®ä½</li>
</ul>
<ol start="7">
<li>handlerï¼æç»ç­ç¥ï¼</li>
</ol>
<ul>
<li>å½çº¿ç¨æ± çº¿ç¨æ°å·²æ»¡ + éåå·²æ»¡æ¶è§¦åã</li>
</ul>
<table>
<thead>
<tr>
<th>ç­ç¥</th>
<th>è¡ä¸º</th>
</tr>
</thead>
<tbody>
<tr>
<td>AbortPolicy</td>
<td>æå¼å¸¸ï¼é»è®¤ï¼</td>
</tr>
<tr>
<td>CallerRunsPolicy</td>
<td>è°ç¨èèªå·±æ§è¡</td>
</tr>
<tr>
<td>DiscardPolicy</td>
<td>ç´æ¥ä¸¢å¼ä»»å¡</td>
</tr>
<tr>
<td>DiscardOldestPolicy</td>
<td>ä¸¢å¼ææ©ä»»å¡</td>
</tr>
</tbody>
</table>
<h3 id="çº¿ç¨æ± çå·¥ä½æµç¨">çº¿ç¨æ± çå·¥ä½æµç¨</h3>
<ul>
<li>çº¿ç¨æ± å¤çä»»å¡çå®æ´é»è¾å¯æ»ç»ä¸º5ä¸ªæ­¥éª¤:</li>
</ul>
<div class="mermaid">flowchart TD
    A[æäº¤ä»»å¡] --&gt; B{æ ¸å¿çº¿ç¨æ± æ¯å¦æ»¡ï¼}
    B -- å¦ --&gt; C[åå»ºæ ¸å¿çº¿ç¨æ§è¡ä»»å¡]
    B -- æ¯ --&gt; D{ä»»å¡éåæ¯å¦æ»¡ï¼}
    D -- å¦ --&gt; E[ä»»å¡å å¥éåç­å¾]
    D -- æ¯ --&gt; F{çº¿ç¨æ± æ¯å¦è¾¾å°æå¤§çº¿ç¨æ°ï¼}
    F -- å¦ --&gt; G[åå»ºéæ ¸å¿çº¿ç¨æ§è¡ä»»å¡]
    F -- æ¯ --&gt; H[æ§è¡æç»ç­ç¥]
</div><h3 id="executorsåå»ºå¸¸è§çº¿ç¨æ± ">Executorsåå»ºå¸¸è§çº¿ç¨æ± </h3>
<ul>
<li>Javaæä¾äºExecutorså·¥å·ç±»ï¼å¿«éåå»ºçº¿ç¨æ± ï¼ä½çäº§ç¯å¢ä¸æ¨èç´æ¥ä½¿ç¨ï¼ã</li>
</ul>
<ol>
<li>FixedThreadPoolï¼åºå®å¤§å°çº¿ç¨æ± ï¼</li>
</ol>
<pre><code class="language-java">ExecutorService pool = Executors.newFixedThreadPool(5);
</code></pre>
<ul>
<li>ç¹ç¹
<ul>
<li>çº¿ç¨æ°éåºå®</li>
<li>ä½¿ç¨ æ çéå LinkedBlockingQueue</li>
</ul>
</li>
<li>é£é©
<ul>
<li>ä»»å¡è¿å¤å¯è½ OOM(åå­æº¢åº)</li>
</ul>
</li>
<li>éç¨åºæ¯
<ul>
<li>ä»»å¡éç¨³å®</li>
<li>å¹¶åæ°å¯æ§</li>
</ul>
</li>
</ul>
<ol start="2">
<li>SingleThreadExecutorï¼åçº¿ç¨æ± ï¼</li>
</ol>
<pre><code class="language-java">ExecutorService pool = Executors.newSingleThreadExecutor();
</code></pre>
<ul>
<li>ç¹ç¹
<ul>
<li>åªæä¸ä¸ªçº¿ç¨</li>
<li>ä¿è¯ä»»å¡é¡ºåºæ§è¡</li>
</ul>
</li>
<li>é£é©
<ul>
<li>ä»»å¡å ç§¯å¯è½ OOM(åå­æº¢åº)</li>
</ul>
</li>
</ul>
<ol start="3">
<li>CachedThreadPoolï¼ç¼å­çº¿ç¨æ± ï¼</li>
</ol>
<pre><code class="language-java">ExecutorService pool = Executors.newCachedThreadPool();
</code></pre>
<ul>
<li>ç¹ç¹
<ul>
<li>çº¿ç¨æ°ä¸åºå®</li>
<li>ç©ºé²çº¿ç¨ 60s åæ¶</li>
<li>ä½¿ç¨ SynchronousQueue</li>
</ul>
</li>
<li>é£é©
<ul>
<li>çº¿ç¨æ°æ éå¢é¿ï¼å®¹æèå°½CPU</li>
</ul>
</li>
</ul>
<ol start="4">
<li>ScheduledThreadPoolï¼å®æ¶çº¿ç¨æ± ï¼</li>
</ol>
<pre><code class="language-java">ScheduledExecutorService pool = Executors.newScheduledThreadPool(3);
</code></pre>
<ul>
<li>ç¹ç¹:æ¯æå®æ¶ãå¨æä»»å¡</li>
</ul>
<hr>
<h3 id="hashtable-hashmap-concurrenthashmap-ä¹é´çåºå«">HashTable, HashMap, ConcurrentHashMap ä¹é´çåºå«</h3>
<h4 id="ä¸»è¦åºå«">ä¸»è¦åºå«ï¼</h4>
<table>
<thead>
<tr>
<th>å¯¹æ¯ç¹</th>
<th>Hashtable</th>
<th>HashMap</th>
<th>ConcurrentHashMap</th>
</tr>
</thead>
<tbody>
<tr>
<td>çº¿ç¨å®å¨</td>
<td>å®å¨</td>
<td>ä¸å®å¨</td>
<td>å®å¨</td>
</tr>
<tr>
<td>å®ç°æ¹å¼</td>
<td>æ°ç»+é¾è¡¨</td>
<td>æ°ç»+é¾è¡¨+çº¢é»æ  (JDK 1.8)</td>
<td>æ°ç»+é¾è¡¨+çº¢é»æ  + CAS + synchronized</td>
</tr>
<tr>
<td>éçç²åº¦</td>
<td>synchronized æ´è¡¨å é</td>
<td>æ é</td>
<td>åæ®µé/æ¡¶çº§é (éå®å¤´èç¹)</td>
</tr>
<tr>
<td>æ§è½</td>
<td>æå·®</td>
<td>æå¥½</td>
<td>é«å¹¶åä¸æå¥½</td>
</tr>
<tr>
<td>åè®¸ key ä¸º null</td>
<td>ä¸åè®¸</td>
<td>åè®¸ 1 ä¸ª</td>
<td>ä¸åè®¸</td>
</tr>
<tr>
<td>åè®¸ value ä¸º null</td>
<td>ä¸åè®¸</td>
<td>åè®¸</td>
<td>ä¸åè®¸</td>
</tr>
<tr>
<td>æ¯å¦æ¨èä½¿ç¨</td>
<td>ä¸æ¨è</td>
<td>æ¨èï¼åçº¿ç¨ï¼</td>
<td>æ¨èï¼å¹¶åï¼</td>
</tr>
<tr>
<td>æ©å®¹æºå¶</td>
<td>æ´ä½æ©å®¹ï¼æ©å®¹æ¶é»å¡æææä½</td>
<td>æ´ä½æ©å®¹ï¼æ©å®¹æ¶é»å¡æææä½</td>
<td>åæ®µ / åæ¡¶æ©å®¹ï¼ä¸é»å¡å¨é¨æä½</td>
</tr>
</tbody>
</table>

</div>
<div class="clear"></div>

		</div>
		<div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.029166666666666667" data-date-updated="2026-01-15 01:11">2026-01-15 00:29</span>&nbsp;
<a href="https://www.cnblogs.com/xi-yongqi">æä¼æ¿é£å»</a>&nbsp;
éè¯»(<span id="post_view_count">2</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19484107);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19484107', targetLink: 'https://www.cnblogs.com/xi-yongqi/p/19484107', title: 'çº¿ç¨æ± ä»¥åHashTable, HashMap, ConcurrentHashMapä¹é´çåºå«' })">ä¸¾æ¥</a>
</div>
	 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Flinkæºç éè¯»ï¼JobManagerçHAæºå¶ ]]></title>
    <link>https://www.cnblogs.com/Jackeyzhe/p/19484622</link>
    <guid>426abbc2dbe37130daba894a07fe9ee8</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Jackeyzhe/p/19484622" title="åå¸äº 2026-01-14 23:45">
    <span role="heading" aria-level="2">Flinkæºç éè¯»ï¼JobManagerçHAæºå¶</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/1828322/202601/1828322-20260114234320282-1778052120.png" alt="Flinkæºç éè¯»ï¼JobManagerçHAæºå¶" class="desc_img">
        JobManager å¨ Flink éç¾¤ä¸­åæ¥çéè¦çä½ç¨ï¼åæ¬ä»»å¡è°åº¦åèµæºç®¡çç­å·¥ä½ãå¦æ JobManager å®æºï¼é£ä¹æ´ä¸ªéç¾¤çä»»å¡é½å°å¤±è´¥ãä¸ºäºè§£å³ JobManager çåç¹é®é¢ï¼Flink ä¹è®¾è®¡äº HA æºå¶æ¥ä¿éæ´ä¸ªéç¾¤çç¨³å®æ§ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>JobManager å¨ Flink éç¾¤ä¸­åæ¥çéè¦çä½ç¨ï¼åæ¬ä»»å¡è°åº¦åèµæºç®¡çç­å·¥ä½ãå¦æ JobManager å®æºï¼é£ä¹æ´ä¸ªéç¾¤çä»»å¡é½å°å¤±è´¥ãä¸ºäºè§£å³ JobManager çåç¹é®é¢ï¼Flink ä¹è®¾è®¡äº HA æºå¶æ¥ä¿éæ´ä¸ªéç¾¤çç¨³å®æ§ã</p>
<h3 id="åºæ¬æ¦å¿µ">åºæ¬æ¦å¿µ</h3>
<p>å¨ JobManager å¯å¨æ¶ï¼è°ç¨ <code>HighAvailabilityServicesUtils.createHighAvailabilityServices</code> æ¥åå»º HA æå¡ï¼HA ä¾èµçæå¡é½è¢«å°è£å¨ HighAvailabilityServices ä¸­ãå½å Flink åé¨æ¯æä¸¤ç§é«å¯ç¨æ¨¡å¼ï¼åå«æ¯ ZooKeeper å KUBERNETESã</p>
<pre><code class="language-java">case ZOOKEEPER:
    return createZooKeeperHaServices(configuration, executor, fatalErrorHandler);
case KUBERNETES:
    return createCustomHAServices(
            "org.apache.flink.kubernetes.highavailability.KubernetesHaServicesFactory",
            configuration,
            executor);
</code></pre>
<p>HighAvailabilityServices ä¸­æä¾çå³é®ç»ä»¶åæ¬ï¼</p>
<ul>
<li>
<p>LeaderRetrievalServiceï¼æå¡åç°ï¼ç¨äºè·åå½å leader çå°åãç®åç¨å°æå¡åç°çç»ä»¶æ ResourceManagerãDispatcherãJobManagerãClusterRestEndpointã</p>
</li>
<li>
<p>LeaderElectionï¼éä¸¾æå¡ï¼ä»å¤ä¸ªåéèä¸­éåºä¸ä¸ªä½ä¸º leaderãç¨å°éä¸¾æå¡çåæ ·æ¯ ResourceManagerãDispatcherãJobManagerãClusterRestEndpoint è¿åä¸ªã</p>
</li>
<li>
<p>CheckpointRecoveryFactoryï¼Checkpoint æ¢å¤ç»ä»¶çå·¥åç±»ï¼æä¾äºåå»º CompletedCheckpointStore å CheckpointIDCounter çæ¹æ³ãCompletedCheckpointStore æ¯ç¨äºå­å¨å·²å®æç checkpoint çåä¿¡æ¯ï¼CheckpointIDCounter æ¯ç¨äºçæ checkpoint IDã</p>
</li>
<li>
<p>ExecutionPlanStoreï¼ç¨äºå­å¨æ§è¡è®¡åã</p>
</li>
<li>
<p>JobResultStoreï¼ç¨äºå­å¨ä½ä¸ç»æï¼è¿éæä¸¤ç§ç¶æï¼ä¸ç§æ¯ dirtyï¼è¡¨ç¤ºä½ä¸æ²¡æè¢«å®å¨æ¸çï¼å¦ä¸ç§æ¯ cleanï¼è¡¨ç¤ºä½ä¸æ¸çå·¥ä½å·²ç»æ§è¡å®æäºã</p>
</li>
<li>
<p>BlobStoreï¼å­å¨ä½ä¸è¿è¡æé´çä¸äºäºè¿å¶æä»¶ã</p>
</li>
</ul>
<h4 id="éä¸¾æå¡">éä¸¾æå¡</h4>
<p>Flink çéä¸¾æ¯ä¾é  LeaderElection å LeaderContender éåå®æçãLeaderElection æ¯ LeaderElectionService çä»£çæ¥å£ï¼æä¾äºæ³¨ååéèãç¡®è®¤ leader å å¤æ­åéèæ¯å¦æ¯ leader ä¸ä¸ªæ¥å£ãLeaderContender åæ¯ç¨æ¥è¡¨ç¤ºåéèå¯¹è±¡ãå½ä¸ä¸ª LeaderContender å½é leader åï¼LeaderElectionService ä¼ä¸ºå¶çæä¸ä¸ª leaderSessionIdï¼LeaderContender ä¼è°ç¨ confirmLeadershipAsync åå¸èªå·±çå°åãéä¸¾æå¡çå·ä½å®ç°å¨ LeaderElectionDriver æ¥å£ä¸­ã</p>
<h4 id="æå¡åç°">æå¡åç°</h4>
<p>æå¡åç°çä½ç¨æ¯è·ååç»ä»¶ç leader å°åãæå¡åç°ä¾èµ LeaderRetrievalService å LeaderRetrievalListenerãLeaderRetrievalService å¯ä»¥å¯å¨ä¸ä¸ªçå¬ï¼å½ææ°ç leader å½éæ¶ï¼ä¼è°ç¨ LeaderRetrievalListener ç notifyLeaderAddress æ¹æ³ã</p>
<h4 id="ä¿¡æ¯ä¿å­">ä¿¡æ¯ä¿å­</h4>
<p>å½ leader åçåæ¢æ¶ï¼æ°ç leader éè¦è·åå°æ§ leader å­å¨çä¿¡æ¯ï¼è¿å°±éè¦æ§ leader æè¿äºä¿¡æ¯å­å¨ä¸ä¸ªå¬å±çå­å¨ä¸ãå®å¯ä»¥æ¯ ZooKeeper æ Kubernetes çå­å¨ï¼ä¹å¯ä»¥æ¯åå¸å¼æä»¶ç³»ç»çå­å¨ã</p>
<h3 id="åºäº-zookeeper-ç-ha">åºäº ZooKeeper ç HA</h3>
<h4 id="éä¸¾æå¡-1">éä¸¾æå¡</h4>
<p>åé¢æä»¬æå°äºéä¸¾æå¡ä¸»è¦ä¾èµ LeaderElection å LeaderContender éåå®æãæä»¬å°±ä»¥ JobManager ä¸ºä¾ï¼çä¸ä¸æºé ZooKeeper çéä¸¾æµç¨çå·ä½å®ç°ã</p>
<p><img alt="ZKLeaderElection" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1767924499/Blog/flink/20/ZKLeaderElection.png" class="lazyload"></p>
<p>å¾ä¸­ JobMasterServiceLeadershipRunner æ¯ LeaderContender çå®ç°ç±»ãå¨å¯å¨æå¡æ¶ï¼ä¼å LeaderElection æ³¨åèªå·±çä¿¡æ¯ï¼å®éæ§è¡èæ¯ DefaultLeaderElectionServiceãå®ååå»ºäº LeaderElectionDriverï¼ç¶åå° LeaderContender ä¿å­å¨ leaderContenderRegistry ä¸­ãéä¸¾çæ ¸å¿é»è¾å°è£å¨ LeaderElectionDriver ä¸­ã</p>
<p>å¨åå»º LeaderElectionDriver æ¶ï¼ä¼åå»º LeaderLatch å¯¹è±¡å TreeCache å¯¹è±¡ï¼ LeaderLatch å°è£äºä¸ ZooKeeper å³èçåè°ï¼ä¼æ¥æ¶ä¸ä¸ª LeaderElectionDriver ä½ä¸ºçå¬ãTreeCache ä¸»è¦ç¨äºçå¬ ZooKeeper ä¸­ leader èç¹çåæ´ã</p>
<pre><code class="language-java">public ZooKeeperLeaderElectionDriver(
        CuratorFramework curatorFramework, LeaderElectionDriver.Listener leaderElectionListener)
        throws Exception {
    ...
    this.leaderLatch = new LeaderLatch(curatorFramework, ZooKeeperUtils.getLeaderLatchPath());
    this.treeCache =
            ZooKeeperUtils.createTreeCache(
                    curatorFramework,
                    "/",
                    new ZooKeeperLeaderElectionDriver.ConnectionInfoNodeSelector());

    treeCache
            .getListenable()
            .addListener(
                    (client, event) -&gt; {
                        switch (event.getType()) {
                            case NODE_ADDED:
                            case NODE_UPDATED:
                                Preconditions.checkNotNull(
                                        event.getData(),
                                        "The ZooKeeper event data must not be null.");
                                handleChangedLeaderInformation(event.getData());
                                break;
                            case NODE_REMOVED:
                                Preconditions.checkNotNull(
                                        event.getData(),
                                        "The ZooKeeper event data must not be null.");
                                handleRemovedLeaderInformation(event.getData().getPath());
                                break;
                        }
                    });

    leaderLatch.addListener(this);
    ...
    leaderLatch.start();
    treeCache.start();
}
</code></pre>
<p>æä»¬è¿å¥å° LeaderLatch ç start æ¹æ³ãå®çåé¨æ¯å¨ ZooKeeper ä¸åå»º latch-xxx èç¹ãxxx æ¯å½å LeaderLatch ç IDï¼å®ç± ZooKeeper çæï¼ID æå°çå½é Leaderã</p>
<pre><code class="language-java">private void checkLeadership(List&lt;String&gt; children) throws Exception {
    if (this.debugCheckLeaderShipLatch != null) {
        this.debugCheckLeaderShipLatch.await();
    }

    String localOurPath = (String)this.ourPath.get();
    List&lt;String&gt; sortedChildren = LockInternals.getSortedChildren("latch-", sorter, children);
    int ourIndex = localOurPath != null ? sortedChildren.indexOf(ZKPaths.getNodeFromPath(localOurPath)) : -1;
    this.log.debug("checkLeadership with id: {}, ourPath: {}, children: {}", new Object[]{this.id, localOurPath, sortedChildren});
    if (ourIndex &lt; 0) {
        this.log.error("Can't find our node. Resetting. Index: " + ourIndex);
        this.reset();
    } else if (ourIndex == 0) {
        this.lastPathIsLeader.set(localOurPath);
        this.setLeadership(true);
    } else {
        this.setLeadership(false);
        String watchPath = (String)sortedChildren.get(ourIndex - 1);
        Watcher watcher = new Watcher() {
            public void process(WatchedEvent event) {
                if (LeaderLatch.this.state.get() == LeaderLatch.State.STARTED &amp;&amp; event.getType() == EventType.NodeDeleted) {
                    try {
                        LeaderLatch.this.getChildren();
                    } catch (Exception ex) {
                        ThreadUtils.checkInterrupted(ex);
                        LeaderLatch.this.log.error("An error occurred checking the leadership.", ex);
                    }
                }

            }
        };
        BackgroundCallback callback = new BackgroundCallback() {
            public void processResult(CuratorFramework client, CuratorEvent event) throws Exception {
                if (event.getResultCode() == Code.NONODE.intValue()) {
                    LeaderLatch.this.getChildren();
                }

            }
        };
        ((ErrorListenerPathable)((BackgroundPathable)this.client.getData().usingWatcher(watcher)).inBackground(callback)).forPath(ZKPaths.makePath(this.latchPath, watchPath));
    }

}
</code></pre>
<p>å½é Leader åï¼ä¼åè° LeaderElectionDriver ç isLeader æ¹æ³ï¼å¦ææªå½éï¼åç»§ç»­çå¬ latch èç¹çåæ´ãisLeader ä¼ç»§ç»­åè° LeaderElection ç onGrantLeadership æ¹æ³ï¼æ¥çè°ç¨ LeaderContender ç grantLeadershipãè¿æ¶ä¼å¯å¨ JobMaster æå¡ï¼ç¶åè°ç¨ LeaderElection ç confirmLeadershipAsync æ¥ç¡®è®¤å½éæåãç¡®è®¤çè¿ç¨æ¯ç± LeaderElectionDriver æ¥æ§è¡çãä¸»è¦ä½ç¨æ¯æå½å leader çä¿¡æ¯ååå° ZooKeeper ç connection_info èç¹ã</p>
<pre><code class="language-java">public void publishLeaderInformation(String componentId, LeaderInformation leaderInformation) {
    Preconditions.checkState(running.get());

    if (!leaderLatch.hasLeadership()) {
        return;
    }

    final String connectionInformationPath =
            ZooKeeperUtils.generateConnectionInformationPath(componentId);

    LOG.debug(
            "Write leader information {} for component '{}' to {}.",
            leaderInformation,
            componentId,
            ZooKeeperUtils.generateZookeeperPath(
                    curatorFramework.getNamespace(), connectionInformationPath));

    try {
        ZooKeeperUtils.writeLeaderInformationToZooKeeper(
                leaderInformation,
                curatorFramework,
                leaderLatch::hasLeadership,
                connectionInformationPath);
    } catch (Exception e) {
        leaderElectionListener.onError(e);
    }
}
</code></pre>
<h4 id="æå¡åç°-1">æå¡åç°</h4>
<p>æ¢³çå®éä¸¾æå¡çæºç åï¼æä»¬åæ¥çä¸ä¸æå¡åç°çè¿ç¨ãæä»¬ä»¥ TaskManager è·å JobManager ç leader ä¸ºä¾ã</p>
<p><img alt="ZKLeaderRetrieval" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1767929447/Blog/flink/20/ZKLeaderRetrieval.png" class="lazyload"></p>
<p>å½æä»¬å¾ TaskManager æ·»å ä»»å¡æ¶ï¼ä¼è°ç¨ JobLeaderService ç addJob æ¹æ³ãè¿éä¼åè·å LeaderRetrievalï¼ç¶åè°ç¨ start æ¹æ³æ³¨å LeaderRetrievalListener çå¬ï¼å¹¶åå»º LeaderRetrievalDriverãå¨ LeaderRetrievalDriver ä¸­ä¸»è¦æ¯å ZooKeeper æ³¨å connection_info èç¹çåæ´ã</p>
<p>å¦æåçåæ´ï¼ZooKeeper ä¼åè° <code>LeaderRetrievalDriver.retrieveLeaderInformationFromZooKeeper</code> æ¹æ³ãæä»¬ä» ZooKeeper è·åå° leader çå°åå sessionId åï¼å°±åè° <code>LeaderRetrievalService.notifyLeaderAddress</code> æ¹æ³ãæç»è°ç¨å° JobLeaderService ç notifyLeaderAddress æ¹æ³ï¼è¿ä¸ªæ¹æ³ä¸­å°±æ¯æ­å¼ä¸æ§ leader çè¿æ¥ï¼å¢å ä¸æ° leader çè¿æ¥ã</p>
<h4 id="ä¿¡æ¯ä¿å­-1">ä¿¡æ¯ä¿å­</h4>
<p>æåæä»¬åæ¥çä¿¡æ¯ä¿å­ç¸å³çæºç ãå¨ JobManager å®æä¸æ¬¡ Checkpoint æ¶ï¼ä¼æ§è¡ <code>CheckpointCoordinator.completePendingCheckpoint</code> æ¹æ³ï¼è·éè°ç¨é¾è·¯å¯ä»¥æ¾å° <code>ZooKeeperStateHandleStore.addAndLock</code> æ¹æ³ï¼è¿éä¼æç¶æåå¥å°æä»¶ç³»ç»ä¸­ï¼ç¶åææä»¶è·¯å¾ä¿å­å¨ ZooKeeper ä¸­ã</p>
<pre><code class="language-java">public RetrievableStateHandle&lt;T&gt; addAndLock(String pathInZooKeeper, T state)
        throws PossibleInconsistentStateException, Exception {
    checkNotNull(pathInZooKeeper, "Path in ZooKeeper");
    checkNotNull(state, "State");
    final String path = normalizePath(pathInZooKeeper);
    final Optional&lt;Stat&gt; maybeStat = getStat(path);

    if (maybeStat.isPresent()) {
        if (isNotMarkedForDeletion(maybeStat.get())) {
            throw new AlreadyExistException(
                    String.format("ZooKeeper node %s already exists.", path));
        }

        Preconditions.checkState(
                releaseAndTryRemove(path),
                "The state is marked for deletion and, therefore, should be deletable.");
    }

    final RetrievableStateHandle&lt;T&gt; storeHandle = storage.store(state);
    final byte[] serializedStoreHandle = serializeOrDiscard(storeHandle);
    try {
        writeStoreHandleTransactionally(path, serializedStoreHandle);
        return storeHandle;
    } catch (KeeperException.NodeExistsException e) {
        // Transactions are not idempotent in the curator version we're currently using, so it
        // is actually possible that we've re-tried a transaction that has already succeeded.
        // We've ensured that the node hasn't been present prior executing the transaction, so
        // we can assume that this is a result of the retry mechanism.
        return storeHandle;
    } catch (Exception e) {
        if (indicatesPossiblyInconsistentState(e)) {
            throw new PossibleInconsistentStateException(e);
        }
        // In case of any other failure, discard the state and rethrow the exception.
        storeHandle.discardState();
        throw e;
    }
}
</code></pre>
<p>è³æ­¤ï¼åºäº ZooKeeper ç HA é»è¾æä»¬å°±æ¢³çå®äºãä» 1.12 çæ¬å¼å§ï¼Flink è¿æ¯æäº Kubernetes é«å¯ç¨ï¼ä¸é¢æä»¬åæ¥ä¸ä¸å®æ¯å¦ä½å®ç°çã</p>
<h3 id="åºäº-kubernetes-ç-ha">åºäº Kubernetes ç HA</h3>
<h4 id="éä¸¾æå¡-2">éä¸¾æå¡</h4>
<p>éè¿åé¢çå­¦ä¹ ï¼æä»¬å·²ç»äºè§£å°ï¼éä¸¾çä¸»è¦é»è¾æ¯å¨ LeaderElectionDriver ä¸­ï¼å æ­¤ï¼æä»¬ç´æ¥æ¥ç KubernetesLeaderElectionDriver çé»è¾å³å¯ãåå»º KubernetesLeaderElectionDriver æ¶ï¼åå»ºå¹¶å¯å¨äº KubernetesLeaderElectorãè¿ä¸ªç±»ä¼¼äº ZooKeeper é»è¾ä¸­ LeaderLatchï¼ä¼è· Kubernetes åºå±çéä¸¾é»è¾äº¤äºï¼åæ¶æ³¨åçå¬ã</p>
<pre><code class="language-java">public KubernetesLeaderElector(
        NamespacedKubernetesClient kubernetesClient,
        KubernetesLeaderElectionConfiguration leaderConfig,
        LeaderCallbackHandler leaderCallbackHandler,
        ExecutorService executorService) {
    this.kubernetesClient = kubernetesClient;
    this.leaderElectionConfig =
            new LeaderElectionConfigBuilder()
                    .withName(leaderConfig.getConfigMapName())
                    .withLeaseDuration(leaderConfig.getLeaseDuration())
                    .withLock(
                            new ConfigMapLock(
                                    new ObjectMetaBuilder()
                                            .withNamespace(kubernetesClient.getNamespace())
                                            .withName(leaderConfig.getConfigMapName())
                                            // Labels will be used to clean up the ha related
                                            // ConfigMaps.
                                            .withLabels(
                                                    KubernetesUtils.getConfigMapLabels(
                                                            leaderConfig.getClusterId()))
                                            .build(),
                                    leaderConfig.getLockIdentity()))
                    .withRenewDeadline(leaderConfig.getRenewDeadline())
                    .withRetryPeriod(leaderConfig.getRetryPeriod())
                    .withReleaseOnCancel(true)
                    .withLeaderCallbacks(
                            new LeaderCallbacks(
                                    leaderCallbackHandler::isLeader,
                                    leaderCallbackHandler::notLeader,
                                    newLeader -&gt;
                                            LOG.info(
                                                    "New leader elected {} for {}.",
                                                    newLeader,
                                                    leaderConfig.getConfigMapName())))
                    .build();
    this.executorService = executorService;

    LOG.info(
            "Create KubernetesLeaderElector on lock {}.",
            leaderElectionConfig.getLock().describe());
}
</code></pre>
<p>éä¸¾æååï¼ä¼åè° <code>LeaderElectionListener.onGrantLeadership</code> æ¹æ³ãåç»­çè°ç¨é¾è·¯è¿æ¯ä¼è°ç¨å° <code>KubernetesLeaderElectionDriver.publishLeaderInformation</code> æ¹æ³ãè¿ä¸ªæ¹æ³æ¯æ leader ä¿¡æ¯åå° Kubernetes ç configMap ä¸­ã</p>
<pre><code class="language-java">public void publishLeaderInformation(String componentId, LeaderInformation leaderInformation) {
    Preconditions.checkState(running.get());

    try {
        kubeClient
                .checkAndUpdateConfigMap(
                        configMapName,
                        updateConfigMapWithLeaderInformation(componentId, leaderInformation))
                .get();
    } catch (InterruptedException | ExecutionException e) {
        leaderElectionListener.onError(e);
    }

    LOG.debug(
            "Successfully wrote leader information {} for leader {} into the config map {}.",
            leaderInformation,
            componentId,
            configMapName);
}
</code></pre>
<h4 id="æå¡åç°-2">æå¡åç°</h4>
<p>æå¡åç°çé»è¾å¨ KubernetesLeaderRetrievalDriver ç±»ä¸­ï¼å¨åå»ºæ¶ï¼ä¼å°åé¨ç±» ConfigMapCallbackHandlerImpl æ³¨åä¸ºçå¬åè°ç±»ã</p>
<p>å½ configMap ææ°å¢æåæ´åï¼ä¼åè° <code>LeaderRetrievalService.notifyLeaderAddress</code> æ¹æ³ã</p>
<pre><code class="language-java">private class ConfigMapCallbackHandlerImpl
        implements FlinkKubeClient.WatchCallbackHandler&lt;KubernetesConfigMap&gt; {

    @Override
    public void onAdded(List&lt;KubernetesConfigMap&gt; configMaps) {
        // The ConfigMap is created by KubernetesLeaderElectionDriver with
        // empty data. We don't really need to process anything unless the retriever was started
        // after the leader election has already succeeded.
        final KubernetesConfigMap configMap = getOnlyConfigMap(configMaps, configMapName);
        final LeaderInformation leaderInformation = leaderInformationExtractor.apply(configMap);
        if (!leaderInformation.isEmpty()) {
            leaderRetrievalEventHandler.notifyLeaderAddress(leaderInformation);
        }
    }

    @Override
    public void onModified(List&lt;KubernetesConfigMap&gt; configMaps) {
        final KubernetesConfigMap configMap = getOnlyConfigMap(configMaps, configMapName);
        leaderRetrievalEventHandler.notifyLeaderAddress(
                leaderInformationExtractor.apply(configMap));
    }
    ...
}
</code></pre>
<h4 id="ä¿¡æ¯ä¿å­-2">ä¿¡æ¯ä¿å­</h4>
<p>ä¿¡æ¯ä¿å­çé»è¾å ZooKeeper ä¹éå¸¸ç±»ä¼¼ãå³åæ state ä¿å­å¨æä»¶ç³»ç»ï¼ç¶åæå­å¨è·¯å¾åå° Kubernetes åå° configMap ä¸­ãå·ä½å¯ä»¥ç <code>KubernetesStateHandleStore.addAndLock</code> æ¹æ³ã</p>
<h3 id="æ»ç»">æ»ç»</h3>
<p>æ¬ææä»¬ä¸èµ·æ¢³çäº Flink ä¸­ JobManager ç HA æºå¶ç¸å³æºç ãç®å Flink æ¯æ ZooKeeper å Kubernetes ä¸¤ç§å®ç°ãå¨æ¢³çè¿ç¨ä¸­ï¼æä»¬ä»¥ JobManager ä¸ºä¾ï¼å¶ä»å ä¸ªç¨å°é«å¯ç¨çæå¡çéä¸¾é»è¾ä¹æ¯ä¸æ ·çã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-14 23:46">2026-01-14 23:45</span>&nbsp;
<a href="https://www.cnblogs.com/Jackeyzhe">Jackeyzhe</a>&nbsp;
éè¯»(<span id="post_view_count">15</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19484622);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19484622', targetLink: 'https://www.cnblogs.com/Jackeyzhe/p/19484622', title: 'Flinkæºç éè¯»ï¼JobManagerçHAæºå¶' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å°ç½å­¦AIå¼å01ï¼åå»ºç¬¬ä¸ä¸ªç¤ºä¾Agent ]]></title>
    <link>https://www.cnblogs.com/jyzhao/p/19484508/xiao-bai-xueai-kai-fa01-chuang-jian-di-yi-ge-shi-l</link>
    <guid>445f0dafcb9d3942e311ecccb283a175</guid>
    <description>
    <![CDATA[ 
    <a name="top"></a>
    <h2><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/jyzhao/p/19484508/xiao-bai-xueai-kai-fa01-chuang-jian-di-yi-ge-shi-l" title="åå¸äº 2026-01-14 23:43">
    <span role="heading" aria-level="2">å°ç½å­¦AIå¼å01ï¼åå»ºç¬¬ä¸ä¸ªç¤ºä¾Agent</span>
    

</a>
</h2>
    <small>
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-14 23:43">2026-01-14 23:43</span>&nbsp;
<a href="https://www.cnblogs.com/jyzhao">AlfredZhao</a>&nbsp;
éè¯»(<span id="post_view_count">20</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19484508);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19484508', targetLink: 'https://www.cnblogs.com/jyzhao/p/19484508/xiao-bai-xueai-kai-fa01-chuang-jian-di-yi-ge-shi-l', title: 'å°ç½å­¦AIå¼å01ï¼åå»ºç¬¬ä¸ä¸ªç¤ºä¾Agent' })">ä¸¾æ¥</a>
</small>
    <div class="entry">
        <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>å¨ LangChain å¼åä¸­ï¼æä»¬çæ ¸å¿å·¥ä½æ¯å Promptï¼æç¤ºè¯ï¼ã</p>
<p>é¤æ­¤ä¹å¤ï¼è¿éè¦äºè§£ä¸pythonåºç¡ï¼ç®åäºè§£å³å¯ï¼ä¸éè¦ç³»ç»å­¦ä¹ ï¼è¿å°±æ¯AIæ¶ä»£å¯¹ææ¯ç±å¥½èççº¢å©ã</p>
<h2 id="01--æå»ºç¬ç«çpythonç¯å¢">01 | æå»ºç¬ç«çpythonç¯å¢</h2>
<p>ä½¿ç¨minicondaæå»ºç¬ç«çpythonç¯å¢ã</p>
<p>å®æ¹ç½ç«ï¼<a href="https://www.anaconda.com/" target="_blank" rel="noopener nofollow">https://www.anaconda.com/</a></p>
<p>éæ©éåä½ çï¼æè¿éç´æ¥éæ©å¾å½¢åå®è£çMinicondaï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/635610/202601/635610-20260114224646258-840865368.jpg" alt="" loading="lazy"></p>
<p>ä¸è½½åå®è£ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/635610/202601/635610-20260114224646142-163182582.jpg" alt="" loading="lazy"></p>
<p>å³é­å¹¶éæ°æå¼ç»ç«¯ãæ­¤æ¶ä½ ä¼çå°å½ä»¤è¡åé¢å¤äºä¸ª (base)ï¼è¿è¯´æ Conda å·²ç»æ¥ç®¡äºç¯å¢ã</p>
<p>ç¶ååå»º Python 3.12 ä¸å±å­¦ä¹ ç¯å¢ï¼</p>
<pre><code class="language-BASH"># åå»ºç¯å¢å¹¶æå® Python çæ¬
conda create -n lc python=3.12 -y

# æ¿æ´»ç¯å¢
conda activate lc
</code></pre>
<p>Tipsï¼å¦æåå»ºç¯å¢ï¼éå°è®©åææå¡/æ¡æ¬¾ä¹ç±»ï¼ç´æ¥ææç¤ºå½ä»¤æ§è¡åæå³å¯ã</p>
<p>åé¢æµè¯ä¸ååè½çpythonç¨åºè¯å®åä¸äºå¼ç¨åç§ç±»åçåï¼æä»¬ç»ä¸æ¾å° requirements.txt ä¸­ï¼åç»­æ°ç¯å¢ä¹å¯ä»¥ç´æ¥ä¸é®å®è£éè¦å¼å¥çç¸å³åã</p>
<pre><code class="language-BASH">pip install -r requirements.txt
</code></pre>
<p>å®æç»´æ¤requirements.txtæä»¶ï¼</p>
<pre><code class="language-BASH">langchain
langchain-openai
python-dotenv
</code></pre>
<h2 id="02--åå»ºç¬¬ä¸ä¸ªç¤ºä¾agent">02 | åå»ºç¬¬ä¸ä¸ªç¤ºä¾Agent</h2>
<p>è¿éä»¿ç§LangChainå®æ¹ææ¡£ï¼æå»ºä¸ä¸ªç®åçAgentã</p>
<ul>
<li><a href="https://docs.langchain.com/oss/python/langchain/quickstart" target="_blank" rel="noopener nofollow">https://docs.langchain.com/oss/python/langchain/quickstart</a></li>
</ul>
<p>å ä¸ºç¬èææ¶æ²¡æClaudeæ¨¡åå¯ç¨ï¼æä»¥æ¿æ¢ä¸ºå½åçæ¨¡åï¼å¨æä»¬å­¦ä¹ æµè¯é¶æ®µï¼åºæ¬æ¯æ²¡å¥å½±åçã</p>
<p>vi basic.py</p>
<pre><code class="language-python">import os
from dotenv import load_dotenv
from langchain.agents import create_agent
from langchain_openai import ChatOpenAI
from langchain.tools import tool

# å è½½ .env æä»¶ä¸­ç SILICONFLOW_API_KEY
load_dotenv()

# 1. å®ä¹å·¥å·ï¼å¿é¡»è¦åæ¸æ°ç Docstringï¼å½æ°æ³¨éï¼
@tool
def get_weather(city: str) -&gt; str:
    """è·åæå®åå¸çå®æ¶å¤©æ°æåµã"""
    return f"{city} çå¤©æ°æ»æ¯é´é¨è¿è¿ï¼"

# 2. åå§å SiliconFlow æ¨¡å
llm = ChatOpenAI(
    model="deepseek-ai/DeepSeek-V3", 
    api_key=os.getenv("SILICONFLOW_API_KEY"),
    base_url="https://api.siliconflow.cn/v1",
    temperature=0.1
)

# 3. åå»º Agent
agent = create_agent(
    model=llm,
    tools=[get_weather],
    system_prompt="ä½ æ¯ä¸ä¸ªä¹äºå©äººçå¤©æ°å©æã"
)

# 4. è¿è¡
if __name__ == "__main__":
    response = agent.invoke(
        {"messages": [{"role": "user", "content": "åäº¬å¤©æ°æä¹æ ·ï¼"}]}
    )
    # æå°æåä¸æ¡æ¶æ¯ï¼AI çåç­ï¼
    print(response["messages"][-1].content)
</code></pre>
<h2 id="03--å¢å¼ºè¿ä¸ªç¤ºä¾agent">03 | å¢å¼ºè¿ä¸ªç¤ºä¾Agent</h2>
<p>æ±åå¹¶ç¨å¾®æ¹é ä¸å®æ¹çç¤ºä¾ï¼ä½¿å¶éç¨äºæä»¬çæµè¯ç¯å¢ï¼</p>
<p>vi enhance.py</p>
<pre><code class="language-PYTHON">import os
from dataclasses import dataclass
from dotenv import load_dotenv

from langchain_openai import ChatOpenAI
from langchain.agents import create_agent
from langchain.tools import tool, ToolRuntime
from langgraph.checkpoint.memory import InMemorySaver
from langchain.agents.structured_output import ToolStrategy

load_dotenv()

# 1. å®ä¹ç³»ç»æç¤ºè¯ï¼è¦æ± AI åä¸ªâè°é³æ¢âä¸å®¶ï¼
SYSTEM_PROMPT = """ä½ æ¯ä¸ä½ä¸ä¸çèµæ·±å¤©æ°é¢æ¥åï¼è¯´è¯æå¶å¹½é»ï¼ç¹å«åæ¬¢è®²âè°é³æ¢âã

ä½ ææä½¿ç¨ä»¥ä¸ä¸¤ä¸ªå·¥å·ï¼
- get_weather_for_location: è·åç¹å®åå¸çå¤©æ°ã
- get_user_location: è·åå½åç¨æ·çæå¨å°ã

å¦æç¨æ·è¯¢é®å¤©æ°ï¼è¯·å¡å¿ç¡®è®¤å°ç¹ãå¦æç¨æ·è¯´çæ¯âæè¿å¿âæâæè¿éâï¼è¯·è°ç¨ get_user_location è·åä»ä»¬çä½ç½®ã"""

# 2. å®ä¹ä¸ä¸æç»æï¼å­å¨ç¨æ·ä¿¡æ¯ï¼
@dataclass
class Context:
    """èªå®ä¹è¿è¡æ¶ä¸ä¸æã"""
    user_id: str

# 3. å®ä¹å·¥å·
@tool
def get_weather_for_location(city: str) -&gt; str:
    """è·åæå®åå¸çå¤©æ°æåµã"""
    return f"{city} çå¤©æ°æ»æ¯é³åç¿çï¼"

@tool
def get_user_location(runtime: ToolRuntime[Context]) -&gt; str:
    """æ ¹æ®ç¨æ· ID è·åå¶å°çä½ç½®ã"""
    user_id = runtime.context.user_id
    # æ¨¡ææ°æ®åºï¼ç¨æ· 1 å¨åäº¬ï¼å¶ä»å¨ç æµ·
    return "åäº¬" if user_id == "1" else "ç æµ·"

# 4. éç½®ä½ çæ¨¡å (SiliconFlow)
model = ChatOpenAI(
    model="deepseek-ai/DeepSeek-V3",
    api_key=os.getenv("SILICONFLOW_API_KEY"),
    base_url="https://api.siliconflow.cn/v1",
    temperature=0.7  # ç¨å¾®æé«éæºæ§ï¼è®©è°é³æ¢æ´æåæ
)

# 5. å®ä¹ååºæ ¼å¼ï¼æ±åå­æ®µæè¿°ï¼è®© AI æç½å¡«ä»ä¹ï¼
@dataclass
class ResponseFormat:
    """Agent çç»æååå¤æ ¼å¼ã"""
    # å¹½é»çè°é³æ¢åå¤
    punny_response: str
    # ä»»ä½å³äºå¤©æ°çæè¶£ä¿¡æ¯ï¼å¦ææçè¯ï¼
    weather_conditions: str | None = None

# 6. è®¾ç½®è®°å¿å­å¨
checkpointer = InMemorySaver()

# 7. åå»º Agent
agent = create_agent(
    model=model,
    system_prompt=SYSTEM_PROMPT,
    tools=[get_user_location, get_weather_for_location],
    context_schema=Context,
    response_format=ToolStrategy(ResponseFormat),
    checkpointer=checkpointer
)

# --- è¿è¡æµè¯ ---

# è®¾ç½®ä¼è¯ ID
config = {"configurable": {"thread_id": "test_user_001"}}

# ç¬¬ä¸æ¬¡æé®
print("--- ç¬¬ä¸æ¬¡å¯¹è¯ ---")
response = agent.invoke(
    {"messages": [{"role": "user", "content": "å¤é¢å¤©æ°æä¹æ ·ï¼"}]},
    config=config,
    context=Context(user_id="1")
)

# è®¿é®ç»æåç»æ
res = response['structured_response']
print(f"AI: {res.punny_response}")
print(f"è¯¦æ: {res.weather_conditions}")

print("\n--- ç¬¬äºæ¬¡å¯¹è¯ï¼æµè¯è®°å¿ï¼ ---")
# ç¬¬äºæ¬¡æé®
response = agent.invoke(
    {"messages": [{"role": "user", "content": "è°¢è°¢ä½ ï¼æå¨åªéï¼"}]},
    config=config,
    context=Context(user_id="1")
)

res = response['structured_response']
print(f"AI: {res.punny_response}")
</code></pre>
<p>è¿æ®µç¤ºä¾ä»£ç çæ ¸å¿é»è¾æ¯ï¼</p>
<p><strong>ç¬¬ä¸æ¬¡å¯¹è¯ï¼</strong></p>
<p>ç¨æ·é®ï¼âå¤é¢å¤©æ°æä¹æ ·ï¼âï¼æ²¡è¯´å°ç¹ï¼ã<br>
AI æèï¼ç³»ç»æç¤ºè¯åè¯æï¼å¦æå°ç¹ä¸æï¼åå»æ¥ç¨æ·å¨åªã<br>
å¨ä½ï¼AI è°ç¨ get_user_location -&gt; å¾å°âåäº¬â -&gt; è°ç¨ get_weather_for_location -&gt; å¾å°å¤©æ°ã<br>
åå¤ï¼æ ¹æ® ResponseFormat ååºä¸ä¸ªè°é³æ¢ã</p>
<p><strong>ç¬¬äºæ¬¡å¯¹è¯ï¼</strong></p>
<p>ç¨æ·é®ï¼âè°¢è°¢ä½ ï¼æå¨åªéï¼â<br>
AI æèï¼ç±äºæ thread_id å checkpointerï¼AI è®°å¾ä¸ä¸æ¬¡æ¥è¯¢çç»æã<br>
å¨ä½ï¼å®ä¸éè¦åæ¬¡æ¥å·¥å·ï¼ç´æ¥ä»è®°å¿éæåä¿¡æ¯å¹¶åå¤ã</p>
<p>ç¶åæå·¥å°ä»£ç ä¸­ç user_id æ¹ä¸º2ï¼åæ¬¡è¿è¡ï¼å°±ä¼æ ¹æ®å·¥å· <code>get_user_location</code> ä¸­çç¤ºä¾é»è¾ï¼å¾å°å°ç¹ä¸ºâç æµ·âï¼ä¸¤æ¬¡æ§è¡çææåèå¦ä¸ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/635610/202601/635610-20260114224646132-69223909.jpg" alt="" loading="lazy"></p>
<p>è¯¥æ®µç¤ºä¾ä»£ç è½ç¶ç®åï¼ä½å¶å®å·²ç»è½å±ç°åºä¸ä¸ªä¼ä¸çº§ AI æºè½ä½ï¼Agentï¼çç¼©å½±ãå®æ¶µçäºç°ä»£ AI å¼åä¸­ææ ¸å¿çä¸ä¸ªæ¯æ±ï¼å·¥å·è°ç¨ï¼Tool Useï¼ãä¸ä¸æè®°å¿ï¼Memoryï¼ãä»¥åç»æåè¾åºï¼Structured Outputï¼ã</p>

</div>
<div id="MySignature" role="contentinfo">
    <a href="https://www.cnblogs.com/jyzhao/" target="_blank">AlfredZhao</a>Â©çæææãä»Oracleèµ·èªï¼é¢ç¥ç²¾å½©çITææ¯ãã<br>
è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/jyzhao/p/19484508/xiao-bai-xueai-kai-fa01-chuang-jian-di-yi-ge-shi-l" target="_blank">https://www.cnblogs.com/jyzhao/p/19484508/xiao-bai-xueai-kai-fa01-chuang-jian-di-yi-ge-shi-l</a>
<hr>
<div style="text-align:center; margin-top:30px;">
  <p style="font-size:14px;color:#555;">
    ð æè°¢éè¯»ï¼æ¬¢è¿å³æ³¨æçå¬ä¼å· <b>ãèµµéå®ã</b>
  </p>
  <img src="https://images.cnblogs.com/cnblogs_com/jyzhao/824234/o_250208075013_qrcode-zjy.jpg" width="160" style="border:1px solid #ddd;border-radius:8px;">
</div>
</div>
<div class="clear"></div>

        <div class="clear"></div>
        
</div>
    <ul class="postmetadata">
        <vc:categories-tags blog-app="jyzhao" blog-id="186567" post-id="19484508"></vc:categories-tags>
    </ul>
 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Claude Code æä½³å®è·µç 8 æ¡é»éæ³å ]]></title>
    <link>https://www.cnblogs.com/didispace/p/19484090</link>
    <guid>3b877ccb5da5ed512523a6abc76d9854</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/didispace/p/19484090" title="åå¸äº 2026-01-14 19:53">
    <span role="heading" aria-level="2">Claude Code æä½³å®è·µç 8 æ¡é»éæ³å</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>ä¸ºä»ä¹åæ ·æ¯è°ç¨ Claudeï¼æçäººè½ååºå·¥ä¸çº§ä»£ç ï¼èæçäººåªæ¯å¨ä¸æ­å ç§¯âææ¯åºâï¼ ä»å¤©åäº«ä¸ä½æ¥æ 7 å¹´ AmazonãDisney å¤§åç»éªãç°ä»»åä¸å¬å¸ CTO åäº«çå®ææåãä»æ Claude Code å½ä½æ¯æ¥ä¸»åå·¥å·ï¼å¹¶æ»ç»åºäºä¸å¥é«é¶ç©å®¶æåãä»âåæèåæ²å­âçæ¶æéå¾ï¼å°è®© AI ç§æä½ ç CLAUDE.md æ·±åº¦éç½®ï¼å¨æ¯é¿åæåãå¦æä½ æ³è®© AI çæ­£æä¸ºä½ ççäº§åé£è½®ï¼è¿ç¯æç« ç»å¯¹å¼å¾æ¶èåå¤è¯»ï¼</p>
<p><img alt="f02adbeb1a8c005df0134224ed8c0d1b.png" loading="lazy" data-src="https://img2024.cnblogs.com/blog/626506/202601/626506-20260114195205678-715088109.png" class="lazyload"></p>
<p>ä¸é¢æ¯å¯¹è¿ç¯æç« çæ»ç»è§£è¯»ï¼å¦æå¯¹åææå´è¶£ä¹å¯ä»¥æ³è¿éæ¥çï¼<a href="https://x.com/eyad_khrais/status/2010076957938188661" target="_blank" rel="noopener nofollow">ãThe complete claude code tutorial ã</a></p>
<h2 id="æ³åä¸åæèåè¾å¥è®¡åæ¨¡å¼æ¯ä½ æå¼ºå¤§çæ­¦å¨">æ³åä¸ï¼åæèï¼åè¾å¥ï¼è®¡åæ¨¡å¼æ¯ä½ æå¼ºå¤§çæ­¦å¨ã</h2>
<p>å¤§å¤æ°äººè®¤ä¸ºä½¿ç¨AIå·¥å·çç¬¬ä¸æ­¥å°±æ¯ç´æ¥å¼å§è¾å¥æç¤ºè¯ãè¿æ¯ä½ è½ç¯ä¸çæå¤§éè¯¯ä¹ä¸ãçæ­£è³å³éè¦ä¸å¿é¡»ååçç¬¬ä¸æ­¥æ¯ââæèåè®¡åã</p>
<p>æ100%çç»éªè¡¨æï¼ä½¿ç¨âè®¡åæ¨¡å¼âï¼è¿æä¸¤æ¬¡ Shift+Tab é®è¿å¥ï¼å¾å°çè¾åºï¼è¿èäºç´æ¥æ»æ»ä¸ç»å°è¾å¥æ³æ³ãè¿ç§å·®è·æ¯ååæ§çã</p>
<p>å½ç¶ï¼å¯¹äºä¸äºç»éªä¸è¶³çå·¥ç¨å¸æ¥è¯´ï¼è¿å¯è½è¯´èµ·æ¥å®¹æåèµ·æ¥é¾ãå¯¹æ­¤ï¼ææä¸¤æ¡å»ºè®®ï¼</p>
<ol>
<li>å¼å§å­¦ä¹ ã å³ä½¿æ¯æ¬¡åªå­¦ä¸ç¹ï¼ä¹å¿é¡»å¼å§ç§¯ç´¯ãå¦æä½ æ°¸è¿ä¸ææ¡è§åè½åï¼ä½ å°±æ¯å¨ç»èªå·±è®¾ç½®éç¢ã</li>
<li>ä¸AIæ·±åº¦äº¤æµã åClaudeè¿è¡ä¸åºæ·±å¥çãååçå¯¹è¯ãè¯¦ç»æè¿°ä½ æ³æå»ºä»ä¹ï¼è¯¢é®å®å¨ç³»ç»è®¾è®¡ä¸æä»ä¹ä¸åçéæ©ï¼æç»å±åç¡®å®ä¸ä¸ªæ¹æ¡ãä½ åAIåºè¯¥äºç¸æé®ï¼èä¸æ¯åè¡éã</li>
</ol>
<h2 id="æ³åäºclaudemdä¸æ¯ææ¡£èæ¯aiçå¤§è">æ³åäºï¼CLAUDE.mdä¸æ¯ææ¡£ï¼èæ¯AIçå¤§èã</h2>
<p>CLAUDE.mdæ¯ä¸ä¸ªæå¶éè¦ä½å¸¸è¢«è¯¯ç¨çéç½®æä»¶ãå¨ä½ æ¯æ¬¡å¯å¨ä¼è¯æ¶ï¼Claudeé½ä¼é¦åè¯»åå®ãå¤§å¤æ°äººè¦ä¹å®å¨å¿½ç¥å®ï¼è¦ä¹ç¨ä¸äºåå¾ä¿¡æ¯å¡«æ»¡å®ï¼ç»æåèè®©Claudeçè¡¨ç°æ´ç³ã</p>
<p>è¦åå¥½ä¸ä¸ªCLAUDE.mdï¼è¯·éµå¾ªä»¥ä¸åä¸ªå³é®æ³åï¼</p>
<ul>
<li>ä¿æç®ç­ï¼ Claudeä¸æ¬¡åªè½å¯é å°éµå¾ªå¤§çº¦150-200æ¡æä»¤ï¼èç³»ç»æç¤ºæ¬èº«å·²ç»å ç¨äºå¤§çº¦50æ¡ãä½ çæ¯ä¸æ¡æ°æä»¤é½å¨äºå¤ºå®çæ³¨æåãå¦æä½ çCLAUDE.mdåå¾åæ¬å°è¯´ï¼Claudeå°±ä¼å¼å§éæºå¿½ç¥æäºåå®¹ã</li>
<li>ä¸æ³¨äºé¡¹ç®ç¹æ§ï¼ ä¸è¦åè¯å®ä»ä¹æ¯âç»ä»¶âæä»¶å¤¹ï¼å®æ©å°±ç¥éäºãä½ åºè¯¥åè¯å®ä½ é¡¹ç®éé£äºâå¥æªâçä¸è¥¿ï¼æ¯å¦ä½ ç¹æçbashå½ä»¤æå·¥ä½æµç¨ã</li>
<li>è§£éâä¸ºä»ä¹âï¼èä¸ä»æ¯âåä»ä¹âï¼ å½ä½ ç»åºæä»¤èåçåå æ¶ï¼Claudeè½æ´å¥½å°çè§£æå¾å¹¶ååºæ´ä¼çå¤æ­ãåªè¯´âä½¿ç¨TypeScriptä¸¥æ ¼æ¨¡å¼âæ¯å¯ä»¥çï¼ä½è¯´âä½¿ç¨TypeScriptä¸¥æ ¼æ¨¡å¼ï¼å ä¸ºæä»¬æ¾å éå¼anyç±»åå¯¼è´è¿çäº§ç¯å¢çbugâææä¼å¥½å¾å¤ã</li>
<li>æç»­æ´æ°ï¼ CLAUDE.mdåºè¯¥æ¯ä¸ä»½âæ´»ææ¡£âãå½ä½ å·¥ä½æ¶ï¼å¯ä»¥æ # é®å¿«éå°å½åæä»¤æ·»å å°æä»¶ä¸­ãæ¯å½ä½ åç°èªå·±ç¬¬äºæ¬¡çº æ­£Claudeåä¸ä¸ªé®é¢æ¶ï¼è¿å°±æ¯ä¸ä¸ªæç¡®çä¿¡å·ï¼è¿æ¡è§ååºè¯¥è¢«åå¥CLAUDE.mdã</li>
</ul>
<p>ä¸ä¸ªç³ç³ç CLAUDE.md è¯»èµ·æ¥åæ¯ç»æ°åå·¥åçå¥èææ¡£ãèä¸ä¸ªä¼ç§ç CLAUDE.md è¯»èµ·æ¥åæ¯ä½ ä¸ºæå¤©ä¼å¤±å¿çèªå·±çä¸çæ ¸å¿ç¬è®°ã</p>
<h2 id="æ³åä¸200kä¸ä¸ææ¯çèçé·é±å«æè¿å»">æ³åä¸ï¼200kä¸ä¸ææ¯çèçé·é±ï¼å«æè¿å»ã</h2>
<p>è¿æ¯ä¸ä¸ªåç´è§çäºå®ï¼æ¨¡åæ§è½çä¸éè¿å¨ä¸ä¸æçªå£è¢«å®å¨å¡«æ»¡ä¹åå°±å¼å§äºï¼éå¸¸å¨ä½¿ç¨çè¾¾å°20-40%æ¶å°±ä¼åºç°ææ¾çè¡°åã</p>
<p>è¿å°±æ¯ä¸ºä»ä¹ææ¶åå³ä½¿ä½ åç¼©äºä¸ä¸æï¼ä½¿ç¨ /compact å½ä»¤ï¼ï¼Claudeä»ç¶ä¼ç»åºç³ç³çè¾åºãå ä¸ºå¨åç¼©ä¹åï¼æ¨¡åçæ§è½å°±å·²ç»éåäºã</p>
<p>ä»¥ä¸æ¯ææç®¡çä¸ä¸æçå ä¸ªå®ç¨ç­ç¥ï¼</p>
<ul>
<li>ååå¯¹è¯èå´ (Scope your conversations): æ¯ä¸ªåè½æä»»å¡ä½¿ç¨ä¸ä¸ªç¬ç«çå¯¹è¯ãä¸è¦å¨åä¸ä¸ªå¯¹è¯éæ¢æå»ºè®¤è¯ç³»ç»åéææ°æ®åºå±ã</li>
<li>ä½¿ç¨å¤é¨è®°å¿ (Use external memory): å¯¹äºå¤æçä»»å¡ï¼è®©Claudeå°è®¡ååè¿åº¦åå¥å SCRATCHPAD.md è¿æ ·çå¤é¨æä»¶ä¸­ãè¿æ ·ç¬¬äºå¤©ä½ åæ¥æ¶ï¼Claudeå¯ä»¥è¯»åæä»¶ï¼ä»ä¸æ¬¡ä¸­æ­çå°æ¹ç»§ç»­ã</li>
<li>âå¤å¶-ç²è´´âéç½®æ³ (The copy-paste reset): å½ä¸ä¸æåå¾èè¿æ¶ï¼å¤å¶å¯¹è¯ä¸­çå³é®ä¿¡æ¯ï¼è¿è¡ /compact å /clear æ¸ç©ºä¸ä¸æï¼ç¶ååªææéè¦çä¿¡æ¯ç²è´´åæ¥ãä¸ä¸ªæ¸ç½çä¸ä¸æè¿èäºéåçä¸ä¸æã</li>
<li>ææ­æ¸ç©º (Know when to clear): å¦æä¸ä¸ªå¯¹è¯å·²ç»åç¦»äºè½¨éï¼ç´æ¥ç¨ /clear éæ°å¼å§ãè¿å ä¹æ»æ¯æ¯è¯å¾çº æ­£ä¸ä¸ªæ··ä¹±çå¯¹è¯è¦å¥½ã</li>
</ul>
<p>è®°ä½è¿ä¸ªå¿æºæ¨¡åï¼Claudeæ¯æ ç¶æçãé¤äºä½ æç¡®ç»å®çä¸è¥¿ï¼æ¯ä¸ªå¯¹è¯é½æ¯ä»é¶å¼å§ãè¯·æ®æ­¤è§åã</p>
<h2 id="æ³ååæ¶æå³å®ä¸åè§åæ å¯æ¿ä»£">æ³ååï¼æ¶æå³å®ä¸åï¼è§åæ å¯æ¿ä»£ã</h2>
<p>æ¶æè³å³éè¦ï¼å°¤å¶æ¯å¨è½¯ä»¶å·¥ç¨ä¸­ãå¦æä½ ä¸åæèç»æï¼AIçæçä»£ç å°±ä¼æå·¨å¤§çâèªç±åæ¥âç©ºé´ï¼èè¿æ°æ°æ¯é®é¢çæ ¹æºãä½ ä¸è½è·³è¿è§åã</p>
<p>æ¯è¾ä¸ä¸è¿ä¸¤ç§æé®æ¹å¼çå¤©å£¤ä¹å«ï¼æ¨¡ç³çè¯·æ±æ¯âç»æå»ºä¸ä¸ªè®¤è¯ç³»ç»âï¼èä¸ä¸ªç»è¿è§åçãå·ä½çè¯·æ±æ¯âä½¿ç¨ç°æçUseræ¨¡åæå»ºçµå­é®ä»¶/å¯ç è®¤è¯åè½ï¼å°sessionå­å¨å¨Redisä¸­å¹¶è®¾ç½®24å°æ¶è¿æï¼å¹¶æ·»å ä¸­é´ä»¶ä¿æ¤/api/protectedä¸çææè·¯ç±ãâ</p>
<p>åèç»äºAIè¿å¤çèªç±ï¼ç»æå¯è½æ¯æ··ä¹±çãåèç»äºå®ä¸ä¸ªæ¸æ°çèå¾ï¼ç»æä¼ç²¾åå¾å¤ãè±5åéè¿è¡æ¶æè§åï¼å¯ä»¥ä¸ºä½ çä¸åç»­æ°å°æ¶çè°è¯æ¶é´ã</p>
<h2 id="æ³åäºåæ­¢æ±æ¨æ¨¡åç³ç³çè¾åºæºäºä½ ç³ç³çè¾å¥">æ³åäºï¼åæ­¢æ±æ¨æ¨¡åï¼ç³ç³çè¾åºæºäºä½ ç³ç³çè¾å¥ã</h2>
<p>å½å¾å°ä¸çæ³çç»ææ¶ï¼äººä»¬çç¬¬ä¸ååºå¾å¾æ¯æ±æ¨æ¨¡åãä½ç°å®æ¯æ®é·çï¼å«åæªæ¨¡åäºãå¦æä½ ç¨Opus 4.5è¿å¾ä¸å°å¥½ç»æï¼é®é¢åºå¨ä½ èº«ä¸ï¼èä¸æ¯AIãä½ çè¾å¥åæç¤ºæ¹å¼çéäºï¼å¥å·ã</p>
<p>æ³è¦æåè¾åºè´¨éï¼åè¦æåä½ çè¾å¥è´¨éï¼</p>
<ul>
<li>å·ä½è¯´æä½ æ³è¦ä»ä¹ (Be specific about what you want)ï¼ ä½ çæä»¤è¶æ¸æ°ãè¶å·ä½ï¼ç»æå°±è¶å¥½ã</li>
<li>åè¯å®ä¸è¦åä»ä¹ (Tell it what NOT to do)ï¼ Claude 4.5å°¤å¶æè¿åº¦è®¾è®¡çå¾åãå¦æä½ æ³è¦ä¸ä¸ªç®çº¦çæ¹æ¡ï¼å°±æç¡®åè¯å®ï¼âä¿æç®åï¼ä¸è¦æ·»å ææ²¡è¦æ±çæ½è±¡ï¼å¦æå¯è½çè¯ï¼åªç¨ä¸ä¸ªæä»¶ãâ</li>
<li>æä¾âä¸ºä»ä¹âçèæ¯ (Give it context about why)ï¼ åè¯å®âè¿ä¸ªåè½éè¦å¨æ¯ä¸ªè¯·æ±ä¸è¿è¡ï¼æä»¥æ§è½è³å³éè¦âï¼æèâè¿åªæ¯ä¸ä¸ªååï¼ç¨å®å°±æâï¼è¿äºçº¦æä¼å½»åºæ¹åæ¨¡åè§£å³é®é¢çæè·¯ã</li>
</ul>
<p>ä¸ä¸ªä¸å®¶çº§çå·¥ä½æµæ¯ï¼ç¨Opusè¿è¡è§ååæ¶æè®¾è®¡ï¼ç¶ååæ¢å°Sonnetè¿è¡å·ä½å®ç°ã Opusæ´æé¿å¤ææ¨çï¼èSonnetæ´å¿«ãæ´ä¾¿å®ï¼éå¸¸éåæ§è¡æç¡®çä»»å¡ãå½ç¶ï¼å¦æä½ æ¯éè¿APIæéä»è´¹ï¼ç¨Opusåæ¯ä¸è¡ä»£ç ï¼é£ä½ å¯è½å¾èèåæä¸ä¸ªè¾äºã</p>
<p>è®°ä½è¿ä¸ªççï¼å¦æä½ çè¾åºå¾ç³ç³ï¼é£æ¯å ä¸ºä½ çè¾å¥å¾ç³ç³ãæ²¡ææ·å¾å¯èµ°ã</p>
<h2 id="æ³åå­åäºå®éªéç½®å³å®ä½ çä¸é">æ³åå­ï¼åäºå®éªï¼éç½®å³å®ä½ çä¸éã</h2>
<p>Claudeæ¥æä¸ä¸ªæå¶ä¸°å¯çåè½çæç³»ç»ï¼MCPæå¡å¨ãHooksãèªå®ä¹ææ å½ä»¤ãsettings.jsonéç½®ç­ç­ãä½ ä¸éè¦å¨é¨ææ¡ï¼ä½ä½ åºè¯¥å»å°è¯åå®éªã</p>
<ul>
<li>MCP (Model Context Protocol): è®©Claudeè¿æ¥å°å¤é¨æå¡ï¼å¦SlackãGitHubãæ°æ®åºãå¦æä½ åç°èªå·±æ»æ¯å¨å¤å¶ç²è´´ä¿¡æ¯ï¼å¾å¯è½æMCPæå¡å¨è½å¸®ä½ èªå¨åã</li>
<li>Hooks: è®©ä»£ç å¨Claudeä¿®æ¹ååèªå¨è¿è¡ãæ³è®©Prettieræ ¼å¼åæ¯ä¸ªæä»¶ï¼ç¨Hookãæ³å¨æ¯æ¬¡ç¼è¾åè¿è¡ç±»åæ£æ¥ï¼ç¨Hookãè¿è½ç«å³æè·é®é¢ã</li>
<li>èªå®ä¹ææ å½ä»¤: æä½ éå¤ä½¿ç¨çæç¤ºè¯æåæå½ä»¤ãå¨.claude/commandsæä»¶å¤¹éåå»ºmarkdownæä»¶ï¼ç¶åä½ å°±å¯ä»¥ç¨/commandnameæ¥è¿è¡å®ä»¬ã</li>
</ul>
<p>è¿äºæ¨¡åæ¯å¨é½å¨è¿æ­¥ãä¸ä¸ªæåè¡ä¸éçåè½ï¼ç°å¨å¯è½å·²ç»å¯ä»¥äºãä¿æå¥½å¥å¿ï¼ä¸æ­éæ°æµè¯ã</p>
<h2 id="æ³åä¸å½ä½ è¢«å¡ä½æ¶åæ­¢å¼ºæ¨æ¹åæ¹æ³">æ³åä¸ï¼å½ä½ è¢«å¡ä½æ¶ï¼åæ­¢å¼ºæ¨ï¼æ¹åæ¹æ³ã</h2>
<p>ææ¶Claudeä¼é·å¥ä¸ä¸ªå¾ªç¯ï¼å°è¯ãå¤±è´¥ãåå°è¯ãåå¤±è´¥ãå¨è¿ç§æåµä¸ï¼äººçæ¬è½æ¯ç»§ç»­è§£éãæä¾æ´å¤æä»¤ãä½æ´å¥½çåæ³æ¯å½»åºæ¹åä½ çæ¹æ³ã</p>
<ul>
<li>æ¸ç©ºå¯¹è¯ (Clear the conversation)ï¼ ç´¯ç§¯çä¸ä¸æå¯è½æ­£å¨è¿·æå®ï¼ä¸ä¸ªå¨æ°çå¼å§å¯ä»¥è§£å³é®é¢ã</li>
<li>ç®åä»»å¡ (Simplify the task)ï¼ å¦æä¸ä¸ªå¤æä»»å¡è®©Claudeä¸¾æ­¥ç»´è°ï¼æå®åè§£ææ´å°çé¨åãé¡ºä¾¿è¯´ä¸å¥ï¼å¦æClaudeå¤çå¤æä»»å¡å¾ååï¼è¿éå¸¸æå³çä½ çåå§è®¡åå°±ä¸å¤ååã</li>
<li>å±ç¤ºèéåç¥ (Show instead of tell)ï¼ å¦æClaudeä¸ç´æ æ³çè§£ï¼äº²æåä¸ä¸ªæå°åçæ­£ç¡®ç¤ºä¾ï¼ç¶ååè¯å®ï¼âçï¼æç»è¾åºåºè¯¥åè¿æ ·ãç°å¨æè¿ä¸ªæ¨¡å¼åºç¨å°å¶ä»é¨åãâ</li>
<li>éæé®é¢ (Be creative)ï¼ æ¢ä¸ä¸ªè§åº¦æ¥æè¿°ä½ çé®é¢ãææ¶åä½ æåçè¡¨è¿°æ¹å¼å¯è½ä¸ç¬¦åClaudeçâæç»´æ¨¡åâã</li>
</ul>
<p>å¦æä½ åç°èªå·±å·²ç»éå¤è§£éäºä¸éï¼æ¯æ¶åæ¹åç­ç¥äºã</p>
<h2 id="æ³åå«è¶è¶èå¤©æ¨¡å¼æå»ºèªå¨åç³»ç»">æ³åå«ï¼è¶è¶èå¤©æ¨¡å¼ï¼æå»ºèªå¨åç³»ç»ã</h2>
<p>çæ­£ä»Claudeä¸­è·å¾å·¨å¤§ä»·å¼çäººï¼å¹¶ä¸ä»ä»æå®å½ä½ä¸ä¸ªäº¤äºå¼å·¥å·ãä»ä»¬æ­£å¨æå»ºä»¥Claudeä¸ºæ ¸å¿ç»ä»¶çèªå¨åç³»ç»ã</p>
<p>éè¿ -p æ å¿ï¼ä½ å¯ä»¥å¨æ å¤´æ¨¡å¼ï¼headless modeï¼ä¸è¿è¡Claudeãè¿æå³çä½ å¯ä»¥ç¼åèæ¬ï¼å°å®çè¾åºéè¿ç®¡éä¼ éç»å¶ä»å·¥å·ï¼ä¸bashå½ä»¤é¾æ¥ï¼å¹¶å°å¶éæå°èªå¨åå·¥ä½æµä¸­ã</p>
<p>ä¼ä¸æ­£å¨ç¨è¿ç§æ¹å¼å®ç°èªå¨åçä»£ç å®¡æ¥ï¼PR reviewï¼ãæ¯æå·¥åååºãæ¥å¿è®°å½åææ¡£æ´æ°ãææè¿äºé½æ¯å¯è®°å½ãå¯å®¡è®¡çï¼å¹¶ä¸éçæ¶é´çæ¨ç§»ä¸æ­æ¹è¿ã</p>
<p>è¿å°±å½¢æäºä¸ä¸ªå¼ºå¤§çé£è½®æåºï¼Claudeç¯äºä¸ä¸ªéè¯¯ï¼ä½ å®¡æ¥æ¥å¿ï¼ç¶åæ¹è¿CLAUDE.mdæç¸å³å·¥å·ï¼ä¸ä¸æ¬¡Claudeå°±ä¼åå¾æ´å¥½ãè¿ç§æ¹è¿æ¯å¤åå¼çãå¦æä½ åªå¨äº¤äºæ¨¡å¼ä¸ä½¿ç¨Claudeï¼ä½ æ­£å¨éå¤±å®çæ­£çä»·å¼ã</p>
<h2 id="ç»è¯­ä½ çaiä½ çè´£ä»»">ç»è¯­ï¼ä½ çAIï¼ä½ çè´£ä»»</h2>
<p>çæ­£ææ¡åClaudeè¿æ ·çAIå¼åå·¥å·ï¼å³é®å¨äºæç»´æ¨¡å¼çè½¬åââä»ä¸ä¸ªç®åçæä»¤ååºèï¼è½¬åä¸ºä¸ä¸ª meticulous çè§åèãéç½®èåç³»ç»æå»ºèãä½ ä¸æ¯å¨åå®èå¤©ï¼ä½ æ¯å¨ç¼ç¨å®ã</p>
<p>æåï¼çç»ä½ ä¸ä¸ªé®é¢æèï¼ å¦æä½ ä¸æClaudeå½ä½èå¤©æºå¨äººï¼èæ¯çä½ä¸ä¸ªå¯ç¼ç¨çå¢éæåï¼ä½ æåä¼èªå¨åå·¥ä½æµç¨çåªä¸ªé¨åï¼</p>
<p>æ´å¤å³äºAI Codingçåå®¹å¯å³æ³¨æç<a href="https://didispace.com" target="_blank" rel="noopener nofollow">åå®¢</a>è·åæç»­æ´æ°ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-14 19:53">2026-01-14 19:53</span>&nbsp;
<a href="https://www.cnblogs.com/didispace">ç¨åºç¿DD</a>&nbsp;
éè¯»(<span id="post_view_count">95</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19484090);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19484090', targetLink: 'https://www.cnblogs.com/didispace/p/19484090', title: 'Claude Code æä½³å®è·µç 8 æ¡é»éæ³å' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ é«å¾·å°å¾å®ç°å®æ¶è½¨è¿¹å±ç¤º ]]></title>
    <link>https://www.cnblogs.com/lijinhuaboke/p/19457121</link>
    <guid>8488ade48bc039f063c2243a2424896b</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/lijinhuaboke/p/19457121" title="åå¸äº 2026-01-14 14:35">
    <span role="heading" aria-level="2">é«å¾·å°å¾å®ç°å®æ¶è½¨è¿¹å±ç¤º</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="vue3--é«å¾·å°å¾amap-å®ç°å¹³æ»çå®æ¶è½¨è¿¹åæ¾ä¸è¿½è¸ª">Vue3 + é«å¾·å°å¾(AMap) å®ç°å¹³æ»çå®æ¶è½¨è¿¹åæ¾ä¸è¿½è¸ª</h1>
<h2 id="åè¨">åè¨</h2>
<p>å¨ç©èç½ãç©æµçæ§æå®é²è°åº¦ç³»ç»ä¸­ï¼å®æ¶å±ç¤ºè®¾å¤ï¼å¦æ äººæºãè½¦è¾ãæç¯ï¼çç§»å¨è½¨è¿¹æ¯ä¸ä¸ªå¸¸è§éæ±ãå¦æä»ä»æ¯ç®åçæ´æ°æ è®°ç¹ä½ç½®ï¼è§è§ä¸ä¼åºç°âè·³åâç°è±¡ï¼ä½éªå¾ä¸æµçã</p>
<p>æ¬æå°åäº«å¦ä½å¨ <strong>Vue 3</strong> é¡¹ç®ä¸­ï¼å©ç¨ <strong>é«å¾·å°å¾ (AMap) JS API</strong> å®ç°æ¯è¾ä¸æ»çå®æ¶è½¨ææã</p>
<h2 id="æ ¸å¿çç¹">æ ¸å¿çç¹</h2>
<ol>
<li><strong>å¹³æ»ç§»å¨</strong>ï¼ç¹ä½æ´æ°æ¶ï¼Marker éè¦ä»æ§ä½ç½®å¹³æ»è¿æ¸¡å°æ°ä½ç½®ï¼èä¸æ¯ç¬é´è·³è¿å»ã</li>
<li><strong>è½¨è¿¹è·é</strong>ï¼éç Marker çç§»å¨ï¼è½¨è¿¹çº¿ï¼Polylineï¼éè¦å®æ¶âçé¿âï¼ç´§è·å¨ Marker åé¢ã</li>
<li><strong>å¢éæ´æ°</strong>ï¼åç«¯éå¸¸è¿åå®æ´çåå²è·¯å¾æå½åç¶æï¼åç«¯éè¦è®¡ç®åºâæ°å¢çè·¯å¾æ®µâè¿è¡å¨ç»æ­æ¾ã</li>
</ol>
<h2 id="å®ç°é»è¾è§£æ">å®ç°é»è¾è§£æ</h2>
<p>æ ¸å¿æ¯å©ç¨é«å¾·å°å¾ API çè½¨è¿¹åæ¾åè½ãè½ç¶å®æ¹ææ¡£æä¾äºåºç¡çè½¨è¿¹åæ¾ç¤ºä¾ï¼åèï¼<a href="https://lbs.amap.com/demo/javascript-api-v2/example/marker/replaying-historical-running-data" target="_blank" rel="noopener nofollow">è½¨è¿¹åæ¾ç¤ºä¾</a>ï¼ï¼ä½å®æ¹ç¤ºä¾éå¸¸æ¯ä¸æ¬¡æ§å è½½å®æ´è·¯å¾ï¼ä¾å¦ï¼åè·åå®æ´ç»çº¬åº¦æ°ç»ï¼æ¸²æåºæµèè²èæ¯çº¿ï¼åè®©å°è½¦æ²¿çè·¯å¾è·å¹¶ç»åºæµç»¿è²è½¨è¿¹ï¼ã</p>
<p><strong>æä»¬çä¸å¡åºæ¯ä¸å®æ¹ç¤ºä¾çä¸»è¦åºå«å¨äºï¼</strong><br>
æä»¬çè·¯å¾æ°æ®æ¯<strong>å®æ¶å¢éæ´æ°</strong>çãåç«¯å¹¶æ²¡æä¸å¼å§å°±æ¿å°å®æ´çè·¯å¾ï¼èæ¯éè¿ WebSocket æè½®è¯¢å®æ¶è·ååç«¯è¿åçææ°è·¯å¾æ°æ®ãå æ­¤ï¼æä»¬éè¦èªè¡è®¾è®¡é»è¾ï¼è®¡ç®åºæ¯æ¬¡æ´æ°çâå¢éçæ®µâï¼å¹¶è®© Marker å¹³æ»å°èµ°å®è¿ä¸æ®µã</p>
<h3 id="æ ¸å¿æè·¯">æ ¸å¿æè·¯ï¼</h3>
<ol>
<li>
<p><strong>ååç«¯æ°æ®çº¦å®</strong>ï¼</p>
<ul>
<li>çæ³æåµä¸ï¼åç«¯æå¥½ç´æ¥è¿åâå¢éè·¯å¾âï¼å³ä¸ä¸æ¬¡ä½ç½®å°å½åä½ç½®çåæ éåï¼ã</li>
<li>ä½å¨å®éé¡¹ç®ä¸­ï¼æ¯å¦æ¬æ¡ä¾ï¼ï¼åç«¯æ¥å£è¿åçæ¯<strong>å½åæ¶å»çå®æ´ç´¯ç§¯è·¯å¾</strong>ãå æ­¤ï¼åç«¯éè¦èªè¡æ¯å¯¹ç¼å­çâä¸ä¸æ¬¡è·¯å¾âåâææ°è·¯å¾âï¼è®¡ç®åºå¢éé¨åã</li>
</ul>
</li>
<li>
<p><strong>ç¶æç®¡ç (ç¼å­å®ä¾)</strong>ï¼</p>
<ul>
<li>ä½¿ç¨ <code>Map</code> æ°æ®ç»ææ¥ç¼å­æ¯ä¸ªè®¾å¤ï¼å¦æ äººæºãæç¯ï¼ç <code>Marker</code>ï¼å¾æ ï¼å <code>Polyline</code>ï¼è½¨è¿¹çº¿ï¼å®ä¾ã</li>
<li>ç¡®ä¿æ¯ä¸ªè®¾å¤ ID å¯¹åºå¯ä¸çå°å¾å®ä¾ï¼é¿åæ°æ®å·æ°æ¶éå¤åå»ºå¯¼è´åå­æ³æ¼æéªçã</li>
</ul>
</li>
<li>
<p><strong>è®¡ç®å¢éè·¯å¾</strong>ï¼</p>
<ul>
<li>å½æ°æ°æ®å°è¾¾æ¶ï¼éè¿å¯¹æ¯æ°æ§è·¯å¾é¿åº¦ï¼æªååº<strong>æ°å¢çè·¯å¾æ®µ</strong>ã</li>
<li>è¿æ®µæ°å¢è·¯å¾å°±æ¯ Marker æ¥ä¸æ¥éè¦âå¹³æ»ç§»å¨âçè½¨è¿¹ã</li>
</ul>
</li>
<li>
<p><strong>å¹³æ»å¨ç» (<code>moveAlong</code>)</strong>ï¼</p>
<ul>
<li>è°ç¨é«å¾·å°å¾ç <code>marker.moveAlong()</code> æ¹æ³ï¼è®© Marker æ²¿çæ°å¢è·¯å¾å¹³æ»ç§»å¨ï¼èä¸æ¯ç¬é´è·³åã</li>
</ul>
</li>
<li>
<p><strong>å®æ¶ç»å¶è½¨è¿¹ (<code>moving</code> äºä»¶)</strong>ï¼</p>
<ul>
<li>çå¬ Marker ç <code>moving</code> äºä»¶ãå¨ç§»å¨è¿ç¨ä¸­ï¼å®æ¶æ´æ°è½¨è¿¹çº¿ï¼Polylineï¼çè·¯å¾ï¼ä»èå®ç°âè¾¹èµ°è¾¹ç»âçææã</li>
<li><strong>å³é®ç¹</strong>ï¼ä¸ºä»ä¹è¦å¨ <code>moving</code> äºä»¶ä¸­æ´æ°æ»è½¨è¿¹ï¼èä¸æ¯å¨å¨ç»ç»æ (<code>moveend</code>) åæ´æ°ï¼
<ul>
<li>è¿æ¯ä¸ºäºé²æ­¢æ°æ®æ¨éé¢çè¿å¿«ãå¦æç­å°å¨ç»ç»æåæ´æ°ï¼å¯è½ä¼åºç°âæ°çæ°æ®æ¨éæ¥äºï¼ä½ä¸ä¸æ¬¡å¨ç»è¿æ²¡ç»æï¼å¯¼è´è½¨è¿¹æ°æ®ä¸¢å¤±æè¡æ¥ä¸ä¸âçé®é¢ãå¨ <code>moving</code> è¿ç¨ä¸­å®æ¶å° <code>passedPath</code>ï¼å·²èµ°è¿çè·¯å¾ï¼æ¼æ¥å°æ»è½¨è¿¹ä¸­ï¼æ¯æç¨³å¦¥çæ¹å¼ã</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>å¨ç»ç»ææ¸ç</strong>ï¼</p>
<ul>
<li>å¨ç»ç»ææ¶ (<code>moveend</code>)ï¼æ¸çä¸´æ¶ç»å¶çè¾å©çº¿ï¼ç§»é¤çå¬å¨ï¼é²æ­¢åå­æ³æ¼ã</li>
</ul>
</li>
</ol>
<hr>
<h3 id="ä»£ç è¯¦è§£">ä»£ç è¯¦è§£</h3>
<h4 id="1-ç¶æç®¡çä¸åå§å">1. ç¶æç®¡çä¸åå§å</h4>
<p>æä»¬ä½¿ç¨ <code>Map</code> æ¥ç®¡çå°å¾ä¸ç Marker å Polyline å®ä¾ã</p>
<pre><code class="language-javascript">// å­å¨ Marker å®ä¾ (Key: è®¾å¤ID, Value: AMap.Marker)
const uavMarkers = ref(new Map());
// å­å¨è½¨è¿¹çº¿ Polyline å®ä¾ (Key: è®¾å¤ID, Value: AMap.Polyline)
const uavPaths = ref(new Map());
</code></pre>
<h4 id="2-æ ¸å¿å¤çå½æ°-refreshtemppoint">2. æ ¸å¿å¤çå½æ° <code>refreshTempPoint</code></h4>
<p>è¿ä¸ªå½æ°è´è´£å¤çåæ¡è®¾å¤æ°æ®çæ´æ°é»è¾ã</p>
<pre><code class="language-javascript">// å·æ°è®¾å¤ç¹ä½ä¸è½¨è¿¹
// item: åç«¯è¿åçè®¾å¤æ°æ®å¯¹è±¡
// position: å½åææ°çåæ ç¹
// type: æ´æ°ç±»åï¼'init' ä¸ºåå§åï¼å¶ä»ä¸ºå¢éæ´æ°ï¼
const refreshTempPoint = async (item, position, type, marker, tempOverlay, pathOverlay) =&gt; {
  // 1. æ¸çä¸ä¸è½®çä¸´æ¶è¦çç©ï¼å¦ä¸´æ¶è·¯çº¿ãè·ç¦»ææ¬ï¼
  tempOverlay?.clearOverlays();

  if (item.coordinatesLine) {
    const coordinatesLine = JSON.parse(item.coordinatesLine); // è§£æåç«¯è¿åçå®æ´è·¯å¾æ°ç»

    // --- A. åå§åèµ·ç¹ Marker ---
    let tempMarker = tempUavMarkers.value.get(item.id);
    if (!tempMarker) {
      // å¦ææ¯ç¬¬ä¸æ¬¡åºç°ï¼æ¸²æèµ·ç¹
      tempMarker = renderPoint(coordinatesLine[0], item, "", pathOverlay);
      tempUavMarkers.value.set(item.id, tempMarker);
    }

    // --- B. è·åæåå»ºåå²è½¨è¿¹çº¿ (Polyline) ---
    let polyline = uavPaths.value.get(item.id);
    if (!polyline) {
      polyline = trajectoryLine(item, pathOverlay); // åå»ºæ°ççº¿å®ä¾
      uavPaths.value.set(item.id, polyline);
    }

    // è·åå½åå°å¾ä¸å·²æçè·¯å¾ï¼ç¼å­çæ§è·¯å¾ï¼
    const existingPath = polyline.getPath() || [];

    if (type != "init") {
      // --- C. å¢éæ´æ°é»è¾ ---
      
      // 1. è®¡ç®å¢éè·¯å¾ï¼ä»å·²æè·¯å¾çæåä¸ä¸ªç¹å¼å§æªåï¼ç´å°ææ°è·¯å¾çæ«å°¾
      const newPathSegment = coordinatesLine.slice(
        existingPath.length ? existingPath.length - 1 : 0
      );

      // 2. åå»ºä¸æ¡ä¸´æ¶çâéå½¢âçº¿æ®µï¼ç¨äºè¾å©è®¡ç®æå±ç¤ºï¼è§éæ±èå®ï¼
      const newPolyline = trajectoryLine(item, tempOverlay);

      // 3. å¦æææ°å¢è·¯å¾ï¼å¼å§å¨ç»
      if (newPathSegment &amp;&amp; newPathSegment.length &gt; 0) {
        
        // çå¬ç§»å¨è¿ç¨
        marker.on("moving", function (e) {
          // e.passedPath æ¯ Marker å¨å½åå¨ç»çæ®µä¸­å·²ç»èµ°è¿çè·¯å¾
          newPolyline.setPath(e.passedPath);
          
          // [å³é®] å®æ¶å°èµ°è¿çè·¯å¾æ¼æ¥å°åå²æ»è½¨è¿¹ä¸­
          // è¿æ ·å³ä½¿ WebSocket æ¨éé¢çå¾å¿«ï¼ä¹è½ä¿è¯è½¨è¿¹æ°æ®çè¿ç»­æ§
          polyline.setPath([...existingPath, ...e.passedPath]);
        });

        // å¼å§å¹³æ»ç§»å¨
        marker.moveAlong(newPathSegment, {
          duration: 1000,    // å¨ç»æ¶é¿ï¼éæ ¹æ® WebSocket æ¨éé¢çè°æ´
          autoRotation: true, // è½¦å¤´èªå¨å¯¹åè·¯å¾æ¹å
        });

        // çå¬ç§»å¨ç»æ
        marker.on("moveend", function () {
          // å¨ç»ç»æï¼æ¸çä¸´æ¶è¦çç©
          tempOverlay?.clearOverlays();
          
          // æ´æ°è·ç¦»ææ¬ç­ä¿¡æ¯
          if (item.distance) {
            renderText(
              coordinatesLine[Math.ceil(coordinatesLine.length - 2)],
              `${item.distance}ç±³`,
              tempOverlay
            );
          }
          
          // ç§»é¤çå¬å¨ï¼é²æ­¢éå¤ç»å®
          marker.off("moveend");
        });
      } else {
        // å¦ææ²¡ææ°å¢è·¯å¾ï¼ä½ç½®æ²¡åï¼ï¼ä»æ´æ°æå­ä¿¡æ¯
        if (item.distance) {
          renderText(..., `${item.distance}ç±³`, tempOverlay);
        }
      }

    } else {
      // --- D. åå§åé»è¾ ---
      // å¦ææ¯åå§åå è½½ï¼ç´æ¥è®¾ç½®å®æ´è·¯å¾ï¼ä¸è¿è¡å¨ç»åæ¾
      if (item.distance) {
         renderText(..., `${item.distance}ç±³`, tempOverlay);
      }
      polyline.setPath(coordinatesLine);
    }
  } else {
    // --- E. æ è½¨è¿¹æ°æ®æ¶çéçº§å¤ç ---
    // å¦æåç«¯æ²¡æè¿åè·¯å¾æ°æ®ï¼ç´æ¥è·³åå°ææ°ä½ç½®
    marker.setPosition(position);
    
    // æ¸çç¸å³çè½¨è¿¹å®ä¾åç¼å­
    let tempMarker = tempUavMarkers.value.get(item.id);
    if (tempMarker) {
      tempMarker.setMap(null);
      pathOverlay &amp;&amp; pathOverlay.removeOverlay(tempMarker);
      tempUavMarkers.value.delete(item.id);
    }
    
    let polyline = uavPaths.value.get(item.id);
    if (polyline) {
      polyline.setMap(null);
      pathOverlay &amp;&amp; pathOverlay.removeOverlay(polyline);
      uavPaths.value.delete(item.id);
    }
  }
};
</code></pre>
<p>}<br>
};</p>
<pre><code class="language-javascript">
// æ äººæºåæç¯è½¨è¿¹ææ¶
const refreshAirMap = async (type, data) =&gt; {
  const res = await getUavElement();
  // console.log("æ äººæºæ°æ®", res.result);
  res.result.map(async (item) =&gt; {
    // data.map(async (item) =&gt; {
    if (item.type == "1") {
      let position = JSON.parse(item.coordinates);
      // è·åæåå»ºæ äººæºæ è®°
      let marker = uavMarkers.value.get(item.id);
      if (!marker) {
        // åå»ºæ äººæºãæç¯ç¹ä½ã
        marker = renderPoint(position, item, "", overlayGroups.value);
        uavMarkers.value.set(item.id, marker);
      }else{
        
        if (item.elementType == "2") {
          // å·²æç¹ä½ä¸æ¯æç¯ç¹ä½å°±æ´æ°çµé
          marker.setLabel({
            content: `&lt;div class="marker-label-container"&gt;
              &lt;div class="info-name"&gt;${item.name}&lt;/div&gt;
              &lt;div class="icon-placeholder"&gt;&lt;/div&gt;
              ${batteryHtml(item)}
            &lt;/div&gt;`,
            offset: new AMaps.value.Pixel(0, 0),
            direction: "center",
          });
        }
      }

      if (item.elementType == "1") {
        // æ äººæºè½¨è¿¹
        refreshTempPoint(
          item,
          position,
          type,
          marker,
          pathOverlayGroups.value,
          pathsStartPointOverlayGroups.value
        );
      } else if (item.elementType == "2") {
        // æç¯è½¨è¿¹
        refreshTempPoint(
          item,
          position,
          type,
          marker,
          rescuePathsOverlayGroups.value,
          rescueOverlayGroups.value
        );
      }
      // è½¨è¿¹é¨åï¼å¤æ­æ¯å¦æè½¨è¿¹
    }
  });
  // });
};
</code></pre>
<p>è¯´æä¸ä¸å¦ï¼æçé¡¹ç®ä¸­è¿éè¦å®ç°å¶ä»åè½åæ¯æç¯çµéå±ç¤ºï¼ç¹å»æé®å¯éèæ äººæºè½¨è¿¹ï¼ç¹å»æé®å¯éèæç¯è½¨è¿¹ï¼æ äººæºåæç¯è½¨è¿¹èµ·å§ç¹ä¹éè¦å±ç¤ºä¸ä¸ªç¹ä½å¾æ ï¼è½¨è¿¹çº¿ä¸æ¾ç¤ºè·ç¦»ï¼è¿èèäºç¬¬ä¸æ¬¡è¿å¥é¡¹ç®ï¼å¦æ è½¨è¿¹å°±åªæ´æ°ç¹ä½åæ ç­ç­è¿äºï¼æ å³çè½¨è¿¹å±ç¤ºé»è¾çåä½è§ä¼èç·ç¥è¿å°±å¥½ï¼è¿ç¯æç« ä¸»è¦æ¯åäº«ä¸ä¸å®æ¶è½¨è¿¹å®ç°çé»è¾ï¼æè½¨è¿¹ç¸å³é»è¾æ½åºæ¥éæ°åä¸ä»½ä»£ç ï¼æå«éº»ç¦å»å»ã</p>
<h2 id="æ»ç»">æ»ç»</h2>
<p>éè¿ç»å å¢éè·¯å¾è®¡ç®<code>moveAlong</code> è½¨è¿¹åæ¾ ä»¥å <code>moving</code> äºä»¶çå¬ï¼æä»¬å®ç°äºä¸ä¸ªé«æ§è½ä¸è§è§æµççå®æ¶è½¨è¿¹è¿½è¸ªåè½ãè¿ç§æ¹æ¡ç¹å«éåæ äººæºå·¡èªãè½¦è¾å®æ¶å®ä½ç­éè¦é«é¢æ´æ°ä½ç½®çåºæ¯ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.003472222222222222" data-date-updated="2026-01-14 14:40">2026-01-14 14:35</span>&nbsp;
<a href="https://www.cnblogs.com/lijinhuaboke">æ­¤é¢å·®ç£ã</a>&nbsp;
éè¯»(<span id="post_view_count">376</span>)&nbsp;
è¯è®º(<span id="post_comment_count">3</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19457121);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19457121', targetLink: 'https://www.cnblogs.com/lijinhuaboke/p/19457121', title: 'é«å¾·å°å¾å®ç°å®æ¶è½¨è¿¹å±ç¤º' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ `i` å `e` ååå¼åçè¡æ¡ï¼å½ AI çâçº éçâéä¸ NexusContract çâç§å¦éâ ]]></title>
    <link>https://www.cnblogs.com/jieky/p/19481961</link>
    <guid>bf5ee1a0d5dcb0f2779bc7907a128f9b</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/jieky/p/19481961" title="åå¸äº 2026-01-14 14:19">
    <span role="heading" aria-level="2">`i` å `e` ååå¼åçè¡æ¡ï¼å½ AI çâçº éçâéä¸ NexusContract çâç§å¦éâ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        å¨å¯¹æ¥æå¤´é¨æ¯ä»ç½å³æ¶ï¼æé­éäºä¸æ¬¡å®ç¾çâéç»´æå»âãå®æ¹ææ¡£éä¸ä¸ªæ `ei` åæ `ie` çè±è¯­è¯­æ³éè¯¯ï¼éªè¿äº AI çè¯­æ³æ£æ¥ï¼ä¹éªè¿äºæçèç¼ Reviewãæ¬æå°æ¢è®¨ NexusContract å¦ä½éè¿**åæ°æ®éç¦»**æºå¶ï¼å¨æ··ä¹±çéçæ¥å£ä¸ç°ä»£åçæ´æ´ä»£ç ä¹é´å»ºç«ä¸éé²çº¿ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="i-å-e-ååå¼åçè¡æ¡å½-ai-ççº éçéä¸-nexuscontract-çç§å¦é"><code>i</code> å <code>e</code> ååå¼åçè¡æ¡ï¼å½ AI çâçº éçâéä¸ NexusContract çâç§å¦éâ</h1>
<blockquote>
<p><strong>æè¦</strong>ï¼å¨å¯¹æ¥æå¤´é¨æ¯ä»ç½å³æ¶ï¼æé­éäºä¸æ¬¡å®ç¾çâéç»´æå»âãå®æ¹ææ¡£éä¸ä¸ªæ <code>ei</code> åæ <code>ie</code> çè±è¯­è¯­æ³éè¯¯ï¼éªè¿äº AI çè¯­æ³æ£æ¥ï¼ä¹éªè¿äºæçèç¼ Reviewãæ¬æå°æ¢è®¨ NexusContract å¦ä½éè¿<strong>åæ°æ®éç¦»</strong>æºå¶ï¼å¨æ··ä¹±çéçæ¥å£ä¸ç°ä»£åçæ´æ´ä»£ç ä¹é´å»ºç«ä¸éé²çº¿ã</p>
</blockquote>
<h2 id="1-è¯¡å¼ç-parameter_missing">1. è¯¡å¼ç <code>PARAMETER_MISSING</code></h2>
<p>æäºåçå¨ä¸ä¹åï¼æä»¬æ­£å¨éæåé¨çä¸ä¸ªè¿è¡äºå å¹´çèæ§æ¯ä»ç½å³ã</p>
<p>ä¸ºäºæé«éææçï¼æææ§çææ¡£æªå¾åç»äº AIï¼æç¥åå¤§æ¨¡åï¼ï¼è®©å®å¸®æçæç¬¦å NexusContract è§èç C# DTOï¼æ°æ®ä¼ è¾å¯¹è±¡ï¼ãAI çè¡¨ç°å ªç§°å®ç¾ï¼ç¬é´ååºäºç»ææ¸æ°çä»£ç ï¼</p>
<pre><code class="language-csharp">public string ReceiverId { get; set; } // æ¶æ¬¾æ¹ID

</code></pre>
<p>ä»£ç ççæ²¡æ¯çï¼å½åä¹è§èãææ»¡æä¿¡å¿å°å¯å¨æå¡ï¼å¼å§<strong>æ¬å°èè°</strong>ã</p>
<p><strong>ç»æï¼æ¥å£æ­»æ´»ä¸éã</strong></p>
<p>ä¸æ¸¸ç½å³ä¸ç´è¿åå·å°å°çéè¯¯ï¼<code>PARAMETER_MISSING</code>ã</p>
<p>è¿å°±å¾éªé¨äºã<br>
ææäºæ­ç¹ï¼æ°æ®å¨ï¼<br>
æäºåï¼JSON å­æ®µä¹æï¼<br>
æèç¼æ£æ¥äºä¸éï¼<code>ReceiverId</code> æ¼åç»å¯¹æ²¡é®é¢ï¼<br>
æåè®© AI æ£æ¥äºä¸éä»£ç ï¼å®ä¹ä¿¡èªæ¦æ¦å°è¯´æ²¡æè¯­æ³éè¯¯ã</p>
<p><strong>æ´æ´ä¸¤ä¸ªå°æ¶ï¼æå°±å¡å¨è¿ä¸ªè«åå¶å¦çéè¯¯ä¸ï¼çè³å¼å§æçæ¯ä¸æ¯ HTTP åè®®å¤´çé®é¢ï¼æèæ¯ JSON åºåååºç Bugã</strong></p>
<p>ç´å°æå®å¨æ²¡æäºï¼åæ¬¡æå¼é£ä»½ææ¡£ï¼å¼ºè¿«èªå·±ä¸ä¸ªå­æ¯ä¸ä¸ªå­æ¯å°è·æçä»£ç æ¯å¯¹æ¶ï¼ææåç°äºä¸ä¸ªä»¤äººçªæ¯çç»èï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/45234/202601/45234-20260114141433336-590884100.png" alt="image" loading="lazy"></p>
<p><strong>ææ¡£éåçå­æ®µåï¼æ¯ <code>recieverId</code>ã</strong></p>
<p>æ³¨æå°äºåï¼<strong><code>i</code> å <code>e</code> ååäºï¼</strong></p>
<p>æ­£ç¡®çè±è¯­åè¯æ¯ <code>Receiver</code>ï¼c åé¢æ¥ eiï¼ï¼ä½ææ¡£éåæäº <code>Reciever</code>ï¼ieï¼ãè¿ç§âé¿å¾æåâçéè¯¯ï¼æå¶å®¹æåçè§éè§ã</p>
<p>é£ä¸å»æç®ç´æ³æé®çï¼<strong>AI å¤ªâèªæâäºã</strong> å®è¯å«åºè¿æ¯âæ¶æ¬¾æ¹âçææï¼åç°äºè¿ä¸ªè¯­æ³éè¯¯ï¼äºæ¯<strong>å¥½å¿å°å¨çæä»£ç æ¶å¸®ææå®âæ¹å¯¹âäº</strong>ãèæï¼ä½ä¸ºä¸ä¸ªæ­£å¸¸çäººç±»ç¨åºåï¼å¤§èä¹èªå¨è¿æ»¤äºè¿ä¸ªæ¼åéè¯¯ã</p>
<p>å¨éçç³»ç»çéæä¸­ï¼<strong>âåå²çéè¯¯âå¾å¾æ¯âæ­£ç¡®çè¯­æ³âæ´éè¦</strong>ã</p>
<h2 id="2-æ¶æçåå»ä»£ç æ´çä¸è®èç°å®">2. æ¶æçåå»ï¼ä»£ç æ´çä¸è®èç°å®</h2>
<p>é¢å¯¹è¿ç§åºæ¯ï¼ä¼ ç»åæ³éå¸¸æä¸¤ç§ï¼</p>
<ol>
<li><strong>åæµåæ±¡æ´¾ï¼</strong> ç´æ¥æ C# å±æ§åä¹åéã</li>
</ol>
<pre><code class="language-csharp">public string RecieverId { get; set; } // ççå°±é¾åï¼é¼æ­»å¼ºè¿«ç

</code></pre>
<p>è¿æä¸ªå·¨å¤§çéæ£ï¼æ°æ¥çåäºæèåæ¥ç»´æ¤ç AIï¼çå°è¿ä¸ªâéè¯¯æ¼åâï¼å¾æå¯è½ä¼é¡ºææå®âä¿®å¤âææ­£ç¡®ç <code>ReceiverId</code>ï¼ç¶å<strong>ç °ï¼ç³»ç»åæäºã</strong><br>
2. <strong>æå¨æ å°æ´¾ï¼</strong> å¨ä¸å¡ä»£ç éæå¨å <code>json["recieverId"] = request.ReceiverId</code>ã<br>
è¿ä¼å¯¼è´ä¸å¡é»è¾éåæ¥çå¤§éçå­ç¬¦ä¸²ç¡¬ç¼ç ï¼ç»´æ¤ææ¬æé«ã</p>
<p><strong>NexusContract çå²å­¦æ¯ï¼</strong> æä»¬æ¹åä¸äºå¤é¨ä¸ççâæç²âæ¼åï¼ä½æä»¬å¯ä»¥éè¿æ¶æææ®µï¼ä¸è®©è¿äºâèä¸è¥¿âæ±¡ææä»¬çæ ¸å¿ä»£ç ã</p>
<p>æä»¬éç¨äº <strong>[ApiField]</strong> ç¹æ§æ¥å®ç° <strong>ç©çéç¦»</strong>ï¼</p>
<pre><code class="language-csharp">[ApiOperation("payment.gateway.pay", HttpVerb.POST)]
public class PaymentRequest : IApiRequest
{
    // ç»å¯¹æ¹ççï¼å¿é¡»éï¼ï¼æ å°å°é£ä¸ªæ ie ååçèå­æ®µ
    [ApiField("recieverId", IsRequired = true)]
    
    // ç»èªå·±ççï¼å¿é¡»å¯¹ï¼ï¼ä¿æåé¨é¢åè¯­è¨ççº¯æ´æ§
    public string ReceiverId { get; set; }
}

</code></pre>
<p>è¿ä¸ä»æ¯ç®åçéå½åï¼è¿æ¯ <strong>è¯­ä¹è§£è¦ (Semantic Decoupling)</strong>ã</p>
<ul>
<li><strong>å±æ§å (Property):</strong> æå¡äºåé¨é»è¾ï¼ä½¿ç¨ <strong>Ubiquitous Language (éç¨è¯­è¨)</strong>ï¼å¿é¡»æ­£ç¡®ãå¯è¯»ã</li>
<li><strong>ç¹æ§å (Attribute):</strong> æå¡äºå¤é¨å¥çº¦ï¼æ¯å¯¹åå²äºå®ç <strong>å¿«ç§</strong>ï¼å¿é¡»çå®ãåªææ¯éçã</li>
</ul>
<h2 id="3-æ·±åº¦è§£å¯nexuscontractcore-çé»ç">3. æ·±åº¦è§£å¯ï¼NexusContract.Core çé»ç</h2>
<p>è¿æ¶ä½ å¯è½ä¼é®ï¼<em>âå¸é¢ä¸å¾å¤ JSON åºé½æ <code>JsonProperty</code>ï¼è¿æä»ä¹ç¨å¥çï¼â</em></p>
<p>åºå«å¨äº <strong>å¤çæ¶æº</strong> å <strong>ç¡®å®æ§</strong>ã</p>
<p>NexusContract å¨ <strong>ç³»ç»å¯å¨ (Startup)</strong> æ¶ï¼ä¼æ§è¡ä¸ä¸ª <strong>[å³ç­ A-301] åæ°æ®å·å» (Metadata Freezing)</strong> æµç¨ã</p>
<p>è½ç¶æ¡æ¶å¨å¯å¨æ¶æ æ³ç¥éå¤é¨æ¥å£å°åºå« <code>recieverId</code> è¿æ¯ <code>receiverId</code>ï¼é¤éæä»¬æ Schema æä»¶ï¼ï¼ä½å®åäºä¸ä»¶æ´éè¦çäºï¼<strong>ç¡®ç«å¥çº¦çç»å¯¹æå¨</strong>ã</p>
<h3 id="æ ¸å¿ä»£ç å±ç¤º">æ ¸å¿ä»£ç å±ç¤º</h3>
<pre><code class="language-csharp">// Copyright (c) 2026 NexusContract. All rights reserved.

using System.Collections.Concurrent;
using System.Reflection;
using NexusContract.Abstractions.Exceptions;

namespace NexusContract.Core.Reflection
{
    /// &lt;summary&gt;
    /// ãå³ç­ A-301ãNexusContractMetadataRegistryï¼å¥çº¦åæ°æ®æ³¨åè¡¨ï¼
    /// 
    /// æ ¸å¿èè½ï¼
    /// 1. åç°ï¼Discoveryï¼ï¼å¯å¨æ¶æ«æææå¥çº¦ç±»ç Attribute ç»æ
    /// 2. éªè¯ï¼Validationï¼ï¼æ§è¡ ContractValidator ç¡®ä¿åé¨çº¦æï¼å¦ Getter/Setter å®æ´æ§ï¼
    /// 3. å»ç»ï¼Freezingï¼ï¼å°åå°ç»æè½¬ä¸ºä¸å¯åå¯¹è±¡ï¼è¿è¡æé¶åå°æè
    /// &lt;/summary&gt;
    public sealed class NexusContractMetadataRegistry
    {
        // åä¾æ¨¡å¼ï¼ç¡®ä¿å¨å±å¯ä¸æ³¨åè¡¨
        private static readonly Lazy&lt;NexusContractMetadataRegistry&gt; _instance = new(() =&gt; new NexusContractMetadataRegistry());
        public static NexusContractMetadataRegistry Instance =&gt; _instance.Value;

        // ãå³ç­ A-302ãæ ¸å¿å·å»åº
        // Key: å¥çº¦ç±»å, Value: é¢ç¼è¯å¥½çåæ°æ®ï¼åå« Expression Tree å§æï¼
        private readonly ConcurrentDictionary&lt;Type, ContractMetadata&gt; _cache = new();

        private NexusContractMetadataRegistry() { }

        /// &lt;summary&gt;
        /// ãå³ç­ A-308ãå¯å¨æä½æ£ï¼Startup Health Checkï¼
        /// è¿ä¸æ¯ç®åçå è½½ï¼èæ¯ä¸æ¬¡å¨éçâCTæ«æâã
        /// ç¡®ä¿ææå¥çº¦å¨ç©çä¸æ¯åæ³çï¼ä¾å¦é²æ­¢ Attribute éå¤å®ä¹ï¼ã
        /// &lt;/summary&gt;
        public DiagnosticReport Preload(IEnumerable&lt;Type&gt; types)
        {
            var globalReport = new DiagnosticReport();

            foreach (var type in types)
            {
                // 1. éæéªè¯ï¼å­æ®µæ¼åãAttribute å²çªç­ï¼
                var perTypeReport = new DiagnosticReport();
                ContractValidator.Validate(type, perTypeReport);

                // 2. å¦æéªè¯éè¿ï¼æå»ºä¸å¯ååæ°æ®
                if (!perTypeReport.HasErrors)
                {
                    try 
                    {
                        var metadata = BuildMetadata(type, perTypeReport);
                        _cache.TryAdd(type, metadata); // å»ç»å¥åº
                    }
                    catch (Exception ex)
                    {
                        perTypeReport.AddCritical(type.Name, $"Metadata freeze failed: {ex.Message}");
                    }
                }
                globalReport.Merge(perTypeReport);
            }
            return globalReport; // è¿åä½æ£æ¥å
        }

        /// &lt;summary&gt;
        /// æå»ºåæ°æ®æ ¸å¿æµï¼å®¡è®¡ -&gt; ç¼è¯ -&gt; å°è£
        /// &lt;/summary&gt;
        private ContractMetadata BuildMetadata(Type type, DiagnosticReport report)
        {
            // ... (çç¥é¨åä»£ç ) ...

            // ãå³ç­ A-309ãå¯ç¨ Expression Tree é¢ç¼è¯ï¼çæ­£é¶åå°ï¼
            // å°åå°è¯»åè½¬æ¢ä¸ºå¼ºç±»åå§æï¼æ§è½æå 10 å
            var projector = ContractMetadataCompiler.CompileProjector(type, propertyMetadatas);
            var hydrator = ContractMetadataCompiler.CompileHydrator(type, propertyMetadatas);

            return new ContractMetadata(type, opAttr, propertyMetadatas.AsReadOnly(), projector, hydrator);
        }
    }
}

</code></pre>
<h3 id="ææ¯åçè§£è¯»">ææ¯åçè§£è¯»</h3>
<p><strong>ä¸ºä»ä¹è¿å¯¹ææ¥ Bug å¾æç¨ï¼</strong></p>
<p>è½ç¶ <code>PARAMETER_MISSING</code> æ¯å¨è¿è¡æ¶æ¥åºæ¥çï¼ä½ NexusContract çæºå¶ä¿è¯äº<strong>ä¿®å¤çå»ä»·æ§ä¸ç¡®å®æ§</strong>ã</p>
<ol>
<li><strong>Expression Tree é¢ç¼è¯ï¼</strong><br>
ä¸æ¦æä»¬å¨ Attribute éæåå­ä¿®æ­£ä¸º <code>[ApiField("recieverId")]</code>ï¼æ¡æ¶å¨ä¸æ¬¡å¯å¨æ¶ï¼ä¼éè¿ <strong>Expression Tree</strong> æè¿ä¸ªæ å°å³ç³»ç¼è¯æé«æç Delegateã<br>
è¿æå³çï¼å³ä½¿ä¸ºäºå¼å®¹èæ¥å£èå äº Attributeï¼<strong>è¿è¡æ¶æ§è½ä¾ç¶ç­åäºæåä»£ç </strong>ï¼å®å¨æ²¡æåå°çé¢å¤å¼éã</li>
<li><strong>å¥çº¦çæ¾å¼åï¼</strong><br>
è¿ç§åæ³å¼ºè¿«å¼åèå»ç¡®è®¤æ¯ä¸ä¸ªå­æ®µçæ å°å³ç³»ãä»£ç éç <code>[ApiField]</code> å°±åä¸ä¸ªä¸ªè­¦ç¤ºçï¼æ¶å»æéçåæ¥èï¼<strong>âæ³¨æï¼è¿éæä¸ªåï¼å«å¨ï¼â</strong></li>
</ol>
<h2 id="4-ç»è¯­">4. ç»è¯­</h2>
<p>ä»¥åæä»¬æ AI çç¼ä»£ç ï¼å¹»è§ï¼ï¼ç°å¨æä»¬æ AI <strong>ä»£ç åå¾å¤ªå¯¹</strong>ã</p>
<p>é¢å¯¹æèãæé¶è¡ãææ¯ä»é£äºåå å¹´åçâèå¤çº§âæ¥å£ï¼AI è¿ç§æ¿çæ´¥è¯å¸å½æ åçâé«æçâæ ¹æ¬æ°´åä¸æãå®ä¸ç¥é <code>recieverId</code> å¨è¿éä¸æ¯æ¼åéè¯¯ï¼å®æ¯<strong>æ³å¾</strong>ï¼æ¯<strong>ä¸å¯å¨æçå¥çº¦</strong>ã</p>
<p>è¿å°±æ¯ä¸ºä»ä¹æä»¬éè¦ NexusContract ââ <strong>å®åè®¸æä»¬å¨ä»£ç éä¼éå°âæé¹¿ä¸ºé©¬âï¼å¹¶ç¨æåºå±çææ¯ææ®µï¼åæ°æ®å·å»ï¼ï¼å°è¿ä»½âè®èçç°å®âé«æ§è½å°å°è£èµ·æ¥ã</strong></p>
<hr>

</div>
<div id="MySignature" role="contentinfo">
    <p>______________________________________<br>çæ´»ï¼è¦ç¨å£äººçè¸æé¢å¯¹ï¼ç¨ç§å­¦çæ¹æ³æ¯éï¼ <br>&nbsp; &nbsp; &nbsp; &nbsp; ç¨çå¸çå¾¡è³å»èï¼ç¨æ¸æ´çç©ºæ°æ´èºï¼ <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ç¨å°çªçæè§å»ç¡ï¼ç¨å¤ªé³çç­æçæ°´ã<br>______________________________________</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-14 14:20">2026-01-14 14:19</span>&nbsp;
<a href="https://www.cnblogs.com/jieky">æ¶å¤±è</a>&nbsp;
éè¯»(<span id="post_view_count">199</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19481961);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19481961', targetLink: 'https://www.cnblogs.com/jieky/p/19481961', title: '`i` å `e` ååå¼åçè¡æ¡ï¼å½ AI çâçº éçâéä¸ NexusContract çâç§å¦éâ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>