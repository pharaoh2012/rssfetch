<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2025-12-26T16:19:36.591Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ ä¸é¶ä½éæ»¤æ³¢å¨ï¼LPFï¼ä½¿ç¨è¯¦è®² ]]></title>
    <link>https://www.cnblogs.com/lsksp/p/19406964</link>
    <guid>fb1e4f7b048038ae5a91a9c2acad9913</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/lsksp/p/19406964" title="åå¸äº 2025-12-27 00:10">
    <span role="heading" aria-level="2">ä¸é¶ä½éæ»¤æ³¢å¨ï¼LPFï¼ä½¿ç¨è¯¦è®²</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        ä¸é¶ä½éæ»¤æ³¢å¨ï¼Low Pass Filterï¼LPFï¼çæ ¸å¿ä½ç¨æ¯ï¼åè®¸è¾å¥ä¿¡å·ä¸­é¢çä½äºè®¾å®æªæ­¢é¢ççæåéè¿ï¼è¡°åæå°ï¼ï¼é»éæå¤§å¹è¡°åé«äºæªæ­¢é¢ççé«é¢åªå£°ï¼ä»èè·å¾æ´çº¯åçç®æ ä¿¡å·ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>ä¸é¶ä½éæ»¤æ³¢å¨ï¼Low Pass Filterï¼LPFï¼çæ ¸å¿ä½ç¨æ¯ï¼åè®¸è¾å¥ä¿¡å·ä¸­é¢çä½äºè®¾å®æªæ­¢é¢ççæåéè¿ï¼è¡°åæå°ï¼ï¼é»éæå¤§å¹è¡°åé«äºæªæ­¢é¢ççé«é¢åªå£°ï¼ä»èè·å¾æ´çº¯åçç®æ ä¿¡å·ã</p>
<hr>
<h3 id="ä¸ä¸é¶ä½éæ»¤æ³¢å¨å®ä¹">ä¸ãä¸é¶ä½éæ»¤æ³¢å¨å®ä¹</h3>
<p>å¯¹äºä¸é¶ä½éæ»¤æ³¢èè¨ï¼ä»æ§å¶æ¨¡åä¸åæå°±æ¯ä¸ä¸ªä¸é¶æ¯æ§ç¯èï¼å¶æè¿°å½¢å¼å¦å¼æç¤ºï¼</p>
<p></p><div class="math display">\[H\left( s \right) =\frac{1}{Ts+1}
\]</div><p></p><p></p><div class="math display">\[\text{æ³¨ï¼}T=\frac{1}{w_c}\text{ï¼}w_c=2\pi \cdot f_c\text{ï¼}
\text{å¶ä¸­ï¼}T\text{ä¸ºæ¶é´å¸¸æ°ï¼}w_c\text{ä¸ºè§é¢çï¼}f_c\text{ä¸ºæªæ­¢é¢ç}
\]</div><p></p><p><img alt="bodeå¾" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2921660/202512/2921660-20251227000802641-389685525.png" class="lazyload"></p>
<p>å¹é¢ååºï¼</p>
<p></p><div class="math display">\[\begin{equation}

|H(j\omega)| = \frac{1}{\sqrt{1+(\omega T)^2}} = \frac{1}{\sqrt{1+\left(\frac{\omega}{\omega_c}\right)^2}}

\end{equation}
\]</div><p></p><p>ç¸é¢ååºï¼</p>
<p></p><div class="math display">\[\begin{equation}
\angle H(j\omega) = -\arctan(\omega T) = -\arctan\left(\frac{\omega}{\omega_c}\right)
\end{equation}
\]</div><p></p><p>ç®åæ¥è¯´ï¼ä¸é¶ä½éæ»¤æ³¢å¨å°±åäºä¸ä»¶äºï¼<strong>è®©æ¢çååéè¿ï¼é»éå¿«çååã</strong> å¨å®éå·¥ç¨ä¸­ä½¿ç¨ä¸é¶ä½éæ»¤æ³¢å¨æ¶ï¼éç¹å«æ³¨æä»¥ä¸ç¹ç¹ï¼</p>
<ol>
<li><strong>å¹³æ»ææ</strong>ï¼å®è½æ»¤é¤é«é¢åªå£°ï¼å¦ ADC æå¨ãçµæºçº¹æ³¢ï¼ãæªæ­¢é¢çè®¾å¾è¶ä½ï¼å¯¹è¾å¥ä¿¡å·ååçååºè¶æ¢ã</li>
<li><strong>ç¸ä½æ»å</strong>ï¼è¾åºä¿¡å·æ»æ¯æ¯è¾å¥ä¿¡å·âæ¢åæâãå¨é­ç¯æ§å¶ç³»ç»ï¼å¦ PIDï¼ä¸­ï¼å¦ææ»¤æ³¢å¼ºåº¦è¿å¤§ï¼ä¼å¯¼è´ç³»ç»ååºè¿éçè³éè¡ã</li>
<li><strong>è¡°åç¹æ§</strong>ï¼å¨æªæ­¢é¢ç <code>fc</code> å¤ï¼ä¿¡å·å¹åº¦è¡°åè³<code> -3dB</code>ï¼çº¦ä¸º 0.707 åï¼ï¼ç¸ä½æ»å<code> -45Â°</code></li>
</ol>
<p>æ»¤æ³¢ææå¯¹æ¯å¾å¦ä¸ï¼</p>
<p><img alt="lpf_cutoff_freq_comparison" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2921660/202512/2921660-20251227000817899-813832495.png" class="lazyload"></p>
<h3 id="äºä¸é¶ä½éæ»¤æ³¢å¨çä½¿ç¨">äºãä¸é¶ä½éæ»¤æ³¢å¨çä½¿ç¨</h3>
<p>å¨ä½¿ç¨æ»¤æ³¢å¨åï¼éåæ¸åä¸ªæ ¸å¿æ¦å¿µï¼ä»¥è½¦è½½ IMU ä¸ºä¾ï¼ï¼</p>
<ul>
<li><strong>ä¿¡å·é¢ç</strong>ï¼è½¦è¾å éåº¦çååï¼ä½ æ³æµçï¼è¾æ¢ï¼ï¼</li>
<li><strong>åªå£°é¢ç</strong>ï¼åå¨æºçéå¨ï¼ä½ æ³æ»¤çï¼è¾å¿«ï¼ï¼</li>
<li><strong>éæ ·é¢ç</strong>ï¼ä½ ééæ°æ®çé¢çï¼å¹²æ´»éåº¦ï¼å¿é¡»è¶³å¤å¿«ä»¥çæ¸åªå£°å¹¶æ»¤é¤ï¼ï¼</li>
<li><strong>æªæ­¢é¢ç</strong>ï¼è®¾å®çâåççº¿âï¼åºä»äºä¿¡å·ååªå£°ä¹é´ã</li>
</ul>
<p>å¨å®éå·¥ç¨ä¸­ï¼æä»¬è®¾è®¡æ»¤æ³¢å¨ä¸»è¦æä¸¤ä¸ªæ¹åï¼</p>
<h4 id="1è®¾è®¡ä¼ æå¨ä¸ºäºè¾¾å°ç®æ å»éç¡¬ä»¶">1ãè®¾è®¡ä¼ æå¨ï¼ä¸ºäºè¾¾å°ç®æ å»éç¡¬ä»¶ï¼</h4>
<p>è¿æ¯<strong>èªé¡¶åä¸</strong>çè®¾è®¡æè·¯ãå½æä»¬æç¡®äºéè¦æµéçä¿¡å·åéè¦æ»¤é¤çåªå£°æ¶ï¼åè¿æ¥æ¨ç®ç¡¬ä»¶éæ±ã</p>
<ul>
<li><strong>ç¡®å®èå´</strong>ï¼å·²ç¥ä¿¡å·é¢çï¼å¦ 5 Hzï¼ååªå£°é¢çï¼å¦ 50 Hzï¼ã</li>
<li><strong>è®¾å®åççº¿</strong>ï¼éæ©æªæ­¢é¢ç<code> fc</code> ä»äºäºèä¹é´ï¼å¦ 10 Hzï¼ã</li>
<li><strong>æ¨ç®éæ ·é¢ç</strong>ï¼ä¸ºäºä¿è¯æ°å­æ»¤æ³¢ç®æ³çåç¡®æ§ï¼å·¥ç¨ä¸éå¸¸è¦æ±éæ ·é¢çå¤§äº 10 åçæªæ­¢é¢çï¼ç»éªå¼ï¼ç¡®ä¿æ»¤æ³¢ç²¾åº¦ï¼ãå æ­¤ï¼æä»¬éè¦éæ©éæ ·é¢çè³å°ä¸º 100 Hz çä¼ æå¨ã</li>
</ul>
<h4 id="2ä½¿ç¨ä¼ æå¨æäºç¡¬ä»¶å»è°åæ°">2ãä½¿ç¨ä¼ æå¨ï¼æäºç¡¬ä»¶å»è°åæ°ï¼</h4>
<p>è¿æ¯<strong>èªåºåä¸</strong>çè°è¯æè·¯ãå¨ç¡¬ä»¶éæ ·é¢çåºå®ï¼å¦ IMU éå®å¨ 100 Hzï¼çæåµä¸ï¼å¯»æ¾æªæ­¢é¢ççæä½³è®¾ç½®åºé´ã</p>
<ul>
<li><strong>ç®ä¸é</strong>ï¼å·¥ç¨ä¸éå¸¸è¦æ±éæ ·é¢çå¤§äº 10 åçæªæ­¢é¢çï¼ç»éªå¼ï¼ç¡®ä¿æ»¤æ³¢ç²¾åº¦ï¼ï¼å³æªæ­¢é¢çå°äº 10 Hzã</li>
<li><strong>çä¸é</strong>ï¼ä¸ºäºä¿çææä¿¡å·ï¼æªæ­¢é¢çå¿é¡»å¤§äºä¿¡å·é¢çï¼å¦ 5 Hzï¼ã</li>
<li><strong>å®åæ°</strong>ï¼å¨âä¸éâåâä¸éâçå¤¹ç¼ä¸­éæ©ä¸ä¸ªå¼ï¼å¦ 8 Hzï¼ãå¦æä¿¡å·é¢çé«äºä¸éï¼å¦æ³æµ 50 Hz éå¨ï¼ï¼åè¯´æè¯¥ä¼ æå¨éæ ·é¢çä¸è¶³ï¼æ æ³èä»»ã</li>
</ul>
<h3 id="ä¸cè¯­è¨å®ç°">ä¸ãCè¯­è¨å®ç°</h3>
<p>ä½¿ç¨ä»¥ä¸ä»£ç ï¼è¯·åå«ä»¥ä¸å¬å±åå®¹</p>
<pre><code class="language-C">#include &lt;stdint.h&gt;
#include &lt;math.h&gt;  /* åçº¿æ§åæ¢æ³éè¦ç¨å° tanf */

#ifndef PI
#define PI 3.14159265358979323846f
#endif

</code></pre>
<h4 id="1ååå·®åæ¹æ³backward-difference">1ãååå·®åæ¹æ³ï¼Backward Differenceï¼</h4>
<p>è¿æ¯æç»å¸ãæç¨³å¥çå®ç°æ¹å¼ãå®å©ç¨ä¸ä¸æ¶å»çè¾åºå¼è¿è¡éæ¨ï¼æ°å¼ç¨³å®æ§é«ï¼<strong>æ æ¡ä»¶ç¨³å®</strong>ãéç¨äºç»å¤§å¤æ°ä¼ æå¨æ»¤æ³¢ãçµæºæ§å¶ç­éç¨åºæ¯ãè¥è°è¯ä¸­åç°æ°æ®æææ¾çç¸ä½æ»åï¼å¯éå½å¢å¤§æªæ­¢é¢çã</p>
<pre><code class="language-C">#include &lt;stdint.h&gt; /* æ¨èåå«æ åç±»åå®ä¹ */


/**
 * @brief       ååå·®åæ³ä¸é¶ä½éæ»¤æ³¢å¨ç»æä½
 */
typedef struct
{
	float alpha;           /* æ»¤æ³¢ç³»æ° */
	float one_minus_alpha; /* é¢è®¡ç®ç (1 - alpha) */
	float last_output;     /* ä¸ä¸æ¬¡æ»¤æ³¢è¾åºå¼ */
	float cutoff_freq;     /* æªæ­¢é¢ç */
	float sample_freq;     /* éæ ·é¢ç */
} LPF_BackwardEuler;

/**
 * @brief       ååå·®åæ³ä¸é¶ä½éæ»¤æ³¢å¨åå§åå½æ°
 * @param       filter : æ»¤æ³¢å¨ç»æä½æé
 * @param       cutoff_freq : æªæ­¢é¢ç
 * @param       sample_freq : éæ ·é¢ç
 * @retval      0:æå, -1:åæ°éè¯¯
 * @note        å»ºè®® sample_freq è³å°ä¸º cutoff_freq ç 10 åä»¥è·å¾è¾å¥½çææ
 */
int lpf_backward_euler_init(LPF_BackwardEuler *filter, float cutoff_freq, float sample_freq)
{
	if (filter == NULL || cutoff_freq &lt;= 0.0f || sample_freq &lt;= 0.0f)
	{
		return -1;
	}
    
	/* 
	* éå¶éæ ·çä¸å¾ä½äºå¥å¥æ¯ç¹é¢ç (2å)ï¼å¦åæ æ³éæä¿¡å·ã
	* å®éå·¥ç¨ä¸­ä¸ºäºæ»¤æ³¢ææï¼éå¸¸å»ºè®® 10 åä»¥ä¸ã
	*/
	if (sample_freq &lt; 2.0f * cutoff_freq)
	{
		return -1; 
	}
	

	float tau = 1.0f / (2.0f * PI * cutoff_freq);
	float ts = 1.0f / sample_freq;
	filter-&gt;alpha = ts / (tau + ts);
	
	filter-&gt;one_minus_alpha = 1.0f - filter-&gt;alpha;
	
	/* åå§åç»æä½æå */
	filter-&gt;cutoff_freq = cutoff_freq;
	filter-&gt;sample_freq = sample_freq;
	filter-&gt;last_output = 0.0f;
	
	return 0;
}

/**
 * @brief       ååå·®åæ³ä¸é¶ä½éæ»¤æ³¢å¨è®¡ç®å½æ°
 * @param       filter : æ»¤æ³¢å¨ç»æä½æé
 * @param       input : å½åè¾å¥å¼
 * @retval      æ»¤æ³¢åçè¾åºå¼
 */
float lpf_backward_euler_update(LPF_BackwardEuler *filter, float input)
{
	float output;
	
	if (filter == NULL)
	{
		return input; 
	}
	
	/* æ ¸å¿å¬å¼ï¼y[n] = alpha * x[n] + (1 - alpha) * y[n-1] */
	output = filter-&gt;alpha * input + filter-&gt;one_minus_alpha * filter-&gt;last_output;
	
	filter-&gt;last_output = output;
	
	return output;
}

/**
 * @brief       éç½®ååå·®åæ³ä¸é¶ä½éæ»¤æ³¢å¨ç¶æ
 * @param       filter : æ»¤æ³¢å¨ç»æä½æé
 * @param       init_val : éç½®åçåå§è¾åºå¼
 * @retval      0:æå, -1:åæ°éè¯¯
 */
int lpf_backward_euler_reset(LPF_BackwardEuler *filter, float init_val)
{
	if (filter == NULL)
	{
		return -1;
	}
	
	filter-&gt;last_output = init_val;
	return 0;
}

</code></pre>
<h4 id="2ååå·®åæ³forward-difference">2ãååå·®åæ³ï¼Forward Differenceï¼</h4>
<p>å¬å¼ç®åï¼ä½å±äº<strong>æ¾å¼æ¬§ææ³</strong>ï¼åªæå¨ç¹å®æåµä¸æç¨³å®ãç±äºå¯¹éæ ·é¢çåæªæ­¢é¢ççæ¯ä¾ææï¼å®¹æåºç°åæ£ãé¤éæç¹æ®çæä½é¢éæ±æå¯¹ä»£ç æå¶ç®åï¼å¦åä¸è¬ä¸æ¨èã</p>
<pre><code class="language-c">/**
 * @brief       ååå·®åæ³ä¸é¶ä½éæ»¤æ³¢å¨ç»æä½
 */
typedef struct
{
	float alpha;           /* æ»¤æ³¢ç³»æ° (omega * Ts) */
	float one_minus_alpha; /* é¢è®¡ç®ç (1 - alpha) */
	float last_input;      /* ä¸ä¸æ¬¡æ»¤æ³¢è¾å¥å¼ x[n-1] */
	float last_output;     /* ä¸ä¸æ¬¡æ»¤æ³¢è¾åºå¼ y[n-1] */
	float cutoff_freq;     /* æªæ­¢é¢ç */
	float sample_freq;     /* éæ ·é¢ç */
} LPF_ForwardDifference;

/**
 * @brief       ååå·®åæ³ä¸é¶ä½éæ»¤æ³¢å¨åå§åå½æ°
 * @param       filter : æ»¤æ³¢å¨ç»æä½æé
 * @param       cutoff_freq : æªæ­¢é¢ç
 * @param       sample_freq : éæ ·é¢ç
 * @retval      0:æå, -1:åæ°éè¯¯
 */
int lpf_forward_difference_init(LPF_ForwardDifference *filter, float cutoff_freq, float sample_freq)
{
	if (filter == NULL || cutoff_freq &lt;= 0.0f || sample_freq &lt;= 0.0f)
	{
		return -1;
	}
	
	/* 
	* ååå·®åæ³è½ç¶æçè®ºç¨³å®æé (PI * fc)ï¼ä½å¨æ¥è¿æéæ¶è¯¯å·®æå¤§ã
	* æ­¤å¤å¼ºå¶æ§è¡ 10 åè§åï¼ç¡®ä¿å·¥ç¨åºç¨çå¯é æ§ã
	*/
	if (sample_freq &lt; 10.0f * cutoff_freq)
	{
		return -1; 
	}
	
	/* è®¡ç®è¿ç¨ç³»æ° */
	float tau = 1.0f / (2.0f * PI * cutoff_freq);
	float ts = 1.0f / sample_freq;
	filter-&gt;alpha = ts / tau;
	filter-&gt;one_minus_alpha = 1.0f - filter-&gt;alpha;
	
	/* åå§åç»æä½æå */
	filter-&gt;cutoff_freq = cutoff_freq;
	filter-&gt;sample_freq = sample_freq;
	filter-&gt;last_input = 0.0f;
	filter-&gt;last_output = 0.0f;
	
	return 0;
}

/**
 * @brief       ååå·®åæ³ä¸é¶ä½éæ»¤æ³¢å¨è®¡ç®å½æ°
 * @param       filter : æ»¤æ³¢å¨ç»æä½æé
 * @param       input : å½åè¾å¥å¼
 * @retval      æ»¤æ³¢åçè¾åºå¼
 */
float lpf_forward_difference_update(LPF_ForwardDifference *filter, float input)
{
	float output;
	
	if (filter == NULL)
	{
		return input; 
	}
	
	/* y[n] = (1 - Ts/Tau)y[n-1] + (Ts/Tau)x[n-1] */
	output = filter-&gt;one_minus_alpha * filter-&gt;last_output + filter-&gt;alpha * filter-&gt;last_input;
	
	/* æ´æ°åå²å¼ï¼å½åè¾å¥ä½ä¸ºä¸ä¸æ¬¡çåå²è¾å¥ */
	filter-&gt;last_input = input;
	filter-&gt;last_output = output;
	
	return output;
}

/**
 * @brief       éç½®ååå·®åæ³ä¸é¶ä½éæ»¤æ³¢å¨ç¶æ
 * @param       filter : æ»¤æ³¢å¨ç»æä½æé
 * @param       init_val : éç½®åçåå§è¾åºå¼
 * @retval      0:æå, -1:åæ°éè¯¯
 */
int lpf_forward_difference_reset(LPF_ForwardDifference *filter, float init_val)
{
	if (filter == NULL)
	{
		return -1;
	}
	
	filter-&gt;last_input = init_val;
	filter-&gt;last_output = init_val;
	
	return 0;
}
</code></pre>
<h4 id="3åçº¿æ§åæ¢æ³tustin--bilinear">3ãåçº¿æ§åæ¢æ³ï¼Tustin / Bilinearï¼</h4>
<p>éè¿åçº¿æ§åæ¢å°æ¨¡æåæ å°å°æ°å­åãå®ä¸ä»è½å©ç¨å½åè¾å¥ï¼è¿å©ç¨äºåå²è¾å¥åè¾åºï¼å¶<strong>é¢çååºç¹æ§ææ¥è¿</strong>çè®ºæ¨¡ææ»¤æ³¢å¨ãéç¨äºå¯¹å¹é¢ç¹æ§è¦æ±è¾é«çé³é¢å¤çãä¿¡å·åæï¼æéæ ·é¢çç¸å¯¹è¾ä½çç²¾å¯æ§å¶åºåã</p>
<pre><code class="language-C">/**
 * @brief       åçº¿æ§åæ¢æ³ä¸é¶ä½éæ»¤æ³¢å¨ç»æä½
 */
typedef struct
{
	float b0;             /* è¾å¥ç³»æ° b0 */
	float b1;             /* è¾å¥ç³»æ° b1 */
	float a1;             /* åé¦ç³»æ° a1 */
	float last_input;     /* ä¸ä¸æ¬¡æ»¤æ³¢è¾å¥å¼ x[n-1] */
	float last_output;    /* ä¸ä¸æ¬¡æ»¤æ³¢è¾åºå¼ y[n-1] */
	float cutoff_freq;    /* æªæ­¢é¢ç */
	float sample_freq;    /* éæ ·é¢ç */
} LPF_BilinearTransform;

/**
 * @brief       åçº¿æ§åæ¢æ³ä¸é¶ä½éæ»¤æ³¢å¨åå§åå½æ°
 * @param       filter : æ»¤æ³¢å¨ç»æä½æé
 * @param       cutoff_freq : æªæ­¢é¢ç
 * @param       sample_freq : éæ ·é¢ç
 * @retval      0:æå, -1:åæ°éè¯¯
 */
int lpf_bilinear_transform_init(LPF_BilinearTransform *filter, float cutoff_freq, float sample_freq)
{
	if (filter == NULL || cutoff_freq &lt;= 0.0f || sample_freq &lt;= 0.0f)
	{
		return -1;
	}
	
	/* å¥å¥æ¯ç¹é¢çéå¶ */
	if (sample_freq &lt; 2.0f * cutoff_freq)
	{
		return -1; 
	}
	
	float wc = 2.0f * PI * cutoff_freq;
	float T = 1.0f / sample_freq;
	
	/* é¢çé¢æ­æ²ï¼ç®çæ¯æ¶é¤åçº¿æ§åæ¢å¨é«é¢å¤çéçº¿æ§é¢çç¸åï¼ç¡®ä¿æªæ­¢é¢çåç¡® */
	float wc_twisted = (2.0f / T) * tanf((wc * T) / 2.0f);
	
	/* è®¡ç®åçº¿æ§åæ¢ç³»æ° */
	float K = (wc_twisted * T) / 2.0f;
	float denominator = 1.0f + K;
	
	filter-&gt;b0 = K / denominator;
	filter-&gt;b1 = filter-&gt;b0;  
	filter-&gt;a1 = (K - 1.0f) / denominator;
	
	/* åå§åç»æä½æå */
	filter-&gt;cutoff_freq = cutoff_freq;
	filter-&gt;sample_freq = sample_freq;
	filter-&gt;last_input = 0.0f;
	filter-&gt;last_output = 0.0f;
	
	return 0;
}

/**
 * @brief       åçº¿æ§åæ¢æ³ä¸é¶ä½éæ»¤æ³¢å¨è®¡ç®å½æ°
 * @param       filter : æ»¤æ³¢å¨ç»æä½æé
 * @param       input : å½åè¾å¥å¼
 * @retval      æ»¤æ³¢åçè¾åºå¼
 */
float lpf_bilinear_transform_update(LPF_BilinearTransform *filter, float input)
{
	float output;
	
	if (filter == NULL)
	{
		return input; 
	}
	
	/* æ ¸å¿å¬å¼ï¼y[n] = b0*x[n] + b1*x[n-1] - a1*y[n-1] */
	output = filter-&gt;b0 * input 
	+ filter-&gt;b1 * filter-&gt;last_input 
	- filter-&gt;a1 * filter-&gt;last_output;
	
	/* æ´æ°åå²ç¶æ */
	filter-&gt;last_input = input;
	filter-&gt;last_output = output;
	
	return output;
}

/**
 * @brief       éç½®åçº¿æ§åæ¢æ³ä¸é¶ä½éæ»¤æ³¢å¨ç¶æ
 * @param       filter : æ»¤æ³¢å¨ç»æä½æé
 * @param       init_val : éç½®åçåå§è¾åºå¼
 * @retval      0:æå, -1:åæ°éè¯¯
 */
int lpf_bilinear_transform_reset(LPF_BilinearTransform *filter, float init_val)
{
	if (filter == NULL)
	{
		return -1;
	}
	
	filter-&gt;last_input = init_val;
	filter-&gt;last_output = init_val;
	
	return 0;
}
</code></pre>
<h4 id="4å·¥ç¨éæ©éæ¥è¡¨">4ãå·¥ç¨éæ©éæ¥è¡¨</h4>
<table>
<thead>
<tr>
<th style="text-align: left">æ¹æ³</th>
<th style="text-align: left">ç¨³å®æ§</th>
<th style="text-align: left">è®¡ç®é</th>
<th style="text-align: left">ç¸ä½/å»¶è¿ç¹æ§</th>
<th style="text-align: left">æ ¸å¿ç¹ç¹</th>
<th style="text-align: left">éç¨åºæ¯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><strong>ååå·®åæ³</strong></td>
<td style="text-align: left"><strong>æ æ¡ä»¶ç¨³å®</strong></td>
<td style="text-align: left"><strong>æä½</strong> (1æ¬¡ä¹æ³ + 1æ¬¡ä¹å )</td>
<td style="text-align: left">å­å¨ç¸ä½æ»å (éå¼æ¬§æ)</td>
<td style="text-align: left">æå¸¸ç¨ï¼æç¨³å¥ãç³»æ°è®¡ç®ç®åï¼ä¸æ¶åä¸è§å½æ°ã</td>
<td style="text-align: left"><strong>ç»å¤§å¤æ°åºæ¯</strong>ã çµæºæ§å¶ãä¼ æå¨å»åªãPIDæ»¤æ³¢ã</td>
</tr>
<tr>
<td style="text-align: left"><strong>åçº¿æ§åæ¢æ³</strong></td>
<td style="text-align: left"><strong>æ æ¡ä»¶ç¨³å®</strong></td>
<td style="text-align: left">ä¸­ç­ ( 3 æ¬¡ä¹å )</td>
<td style="text-align: left">é¢çååºæå (éé¢æ­æ²)</td>
<td style="text-align: left"><strong>ç²¾åº¦æé«</strong>ãå¨æªæ­¢é¢çå¤çå¹å¼è¡°åæåç¡®ï¼-3dBï¼ï¼é¢çæ å°ä¿çåº¦æå¥½ã</td>
<td style="text-align: left"><strong>é«ç²¾åº¦è¦æ±</strong>ã é³é¢å¤çãç²¾å¯ä»ªå¨ãç²¾å¯æµéãçµæºé­ç¯æ§å¶ã</td>
</tr>
<tr>
<td style="text-align: left"><strong>ååå·®åæ³</strong></td>
<td style="text-align: left"><strong>ææ¡ä»¶ç¨³å®</strong> (é fs &gt; ÏÂ·fc)</td>
<td style="text-align: left">æä½</td>
<td style="text-align: left"><strong>å»¶è¿æå¤§</strong> (æ¾å¼ï¼å¤ææ»å)</td>
<td style="text-align: left">ç®æ³ç®åï¼ä½å¤©ç¶å¼å¥ 1 ä¸ªéæ ·å¨æççº¯å»¶è¿ï¼ä¸æåæ£ã</td>
<td style="text-align: left">æå°æ¨èã ä»å¨å¤çæä½é¢ä¿¡å·ä¸è®¡ç®èµæºæå¶åéæ¶èèã</td>
</tr>
</tbody>
</table>
<h3 id="åæ»ç»">åãæ»ç»</h3>
<p>ä¸é¶ä½éæ»¤æ³¢å¨æ¯åµå¥å¼ä¿¡å·å¤çä¸­æåºç¡ãæå¸¸ç¨çå·¥å·ãæ­£ç¡®ä½¿ç¨å®çå³é®ï¼å¨äºçè§£<strong>ä¿¡å·é¢çãåªå£°é¢çãéæ ·é¢çä¸æªæ­¢é¢ç</strong>ä¹é´çå¶çº¦å³ç³»ãå¨å®éå¼åä¸­ï¼å»ºè®®ä¼åéç¨<strong>ååå·®åæ³</strong>è¿è¡å®ç°ï¼æ ¹æ®å®éçéæ ·é¢çåä¿¡å·å¸¦å®½ï¼çµæ´»è°æ´æªæ­¢é¢çï¼ä»¥è¾¾å°å»åªä¸ååºéåº¦çæä½³å¹³è¡¡ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-27 00:10">2025-12-27 00:10</span>&nbsp;
<a href="https://www.cnblogs.com/lsksp">æ¯ç¹åé³</a>&nbsp;
éè¯»(<span id="post_view_count">4</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19406964);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19406964', targetLink: 'https://www.cnblogs.com/lsksp/p/19406964', title: 'ä¸é¶ä½éæ»¤æ³¢å¨ï¼LPFï¼ä½¿ç¨è¯¦è®²' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä¸æ¬¾ç±å­èè·³å¨æ¨åºç AI æç¤ºè¯çæåä¼åå·¥å·ï¼ä¸ºä½ æä¾æ´ç²¾åï¼ä¸ä¸ï¼å¯æç»­è¿­ä»£æç¤ºè¯ï¼ ]]></title>
    <link>https://www.cnblogs.com/Can-daydayup/p/19406862</link>
    <guid>786838dc055f034884f50ba768600dd0</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Can-daydayup/p/19406862" title="åå¸äº 2025-12-26 23:11">
    <span role="heading" aria-level="2">ä¸æ¬¾ç±å­èè·³å¨æ¨åºç AI æç¤ºè¯çæåä¼åå·¥å·ï¼ä¸ºä½ æä¾æ´ç²¾åï¼ä¸ä¸ï¼å¯æç»­è¿­ä»£æç¤ºè¯ï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<h2 data-tool="mdniceç¼è¾å¨"><span>åè¨</span></h2>
<p data-tool="mdniceç¼è¾å¨"><span>å¨AIææ¯è¿çåå±çå½ä¸ï¼é«æä¸ç²¾åçæç¤ºè¯æä¸ºä¸AIæ¨¡åææäº¤äºçå³é®ãä»å¤©å¤§å§ç»å¤§å®¶åäº«ä¸æ¬¾ç±å­èè·³å¨æ¨åºç AI æç¤ºè¯çæåä¼åå·¥å·ï¼ä¸ºä½ æä¾æ´ç²¾åï¼ä¸ä¸ï¼å¯æç»­è¿­ä»£æç¤ºè¯ï¼</span></p>
<p><img src="https://img2024.cnblogs.com/blog/1336199/202512/1336199-20251226230859325-1349637768.png" alt="image" loading="lazy"></p>
<h2 data-tool="mdniceç¼è¾å¨"><span>å·¥å·ä»ç»</span></h2>
<p data-tool="mdniceç¼è¾å¨"><span>PromptPilot æ¯ç±å­èè·³å¨æ¨åºçä¸æ¬¾ä¸æ³¨äº AI æç¤ºè¯ä¼åä¸æç¤ºè¯çæçå®ç¨å·¥å·ãè¯¥å·¥å·æ¨å¨å¸®å©ç¨æ·æ´é«æå°çæåä¼å AI æç¤ºè¯ï¼æåä¸ AI æ¨¡åçäº¤äºæçåè´¨éãéè¿ PromptPilotï¼ç¨æ·å¯ä»¥è½»æ¾å°åå»ºãè°è¯åç®¡çæç¤ºè¯ï¼ä»¥æ»¡è¶³å¤æ ·åçåºç¨åºæ¯éæ±ã</span></p>
<ul class="list-paddingleft-1">
<li><strong><span>å¨çº¿è®¿é®å°åï¼<span class="wx_text_underline">https://promptpilot.volcengine.com</span></span></strong></li>
</ul>
<p><img src="https://img2024.cnblogs.com/blog/1336199/202512/1336199-20251226230911909-2106687661.png" alt="image" loading="lazy"></p>
<h2 data-tool="mdniceç¼è¾å¨"><span>åºç¨åºæ¯</span></h2>
<ul class="list-paddingleft-1">
<li><strong>åå®¹åä½</strong><span>ï¼å¨èªåªä½ãå¹¿åãè¥éç­é¢åï¼PromptPilot å¯å¸®å©åä½èå¿«éçæå¸å¼äººçææ¡æç¤ºè¯ï¼æååå®¹è´¨éåå¸å¼åã</span></li>
<li><strong>æ°æ®åæ</strong><span>ï¼å¨æ°æ®åæåºæ¯ä¸­ï¼PromptPilot å¯è¾å©åæå¸çæç²¾åçæ¥è¯¢æç¤ºè¯ï¼æé«æ°æ®æ£ç´¢ååææçã</span></li>
<li><strong>å®¢æ·æå¡</strong><span>ï¼å¨å®¢æ·æå¡é¢åï¼PromptPilot å¯ç¨äºçæèªå¨ååå¤çæç¤ºè¯ï¼æåå®¢æ·ååºéåº¦åæ»¡æåº¦ã</span></li>
<li><strong>æè²è¡ä¸</strong><span>ï¼æå¸åå­¦çå¯å©ç¨ PromptPilot çææå­¦åå­¦ä¹ ç¸å³çæç¤ºè¯ï¼ä¿è¿ç¥è¯çææä¼ éåå­¦ä¹ ææçæåã</span></li>
</ul>
<h2 data-tool="mdniceç¼è¾å¨"><span>æç¤ºè¯çæ</span></h2>
<h3 data-tool="mdniceç¼è¾å¨"><span>ä»»å¡æè¿°ï¼</span></h3>
<pre data-tool="mdniceç¼è¾å¨"><span data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/9M0PhLTmTIeLmnQLStMsiaPjDhdHyic2puibLWicEN1ayLPAiaJCD1cPS0kNT55lIP2QAtlOqdXic0zRsuaUSBfCv7cCz1iaBaeaJaJ/640?wx_fmt=svg&amp;from=appmsg" data-src="https://mmbiz.qpic.cn/mmbiz_svg/9M0PhLTmTIeLmnQLStMsiaPjDhdHyic2puibLWicEN1ayLPAiaJCD1cPS0kNT55lIP2QAtlOqdXic0zRsuaUSBfCv7cCz1iaBaeaJaJ/640?wx_fmt=svg&amp;from=appmsg#imgIndex=3" data-fail="0"><code><span>ç»æåä¸ä¸ªä¼ä¸ä¼ç§åå·¥è·å¥æè¨ã<br></span></code></span></pre>
<h3 data-tool="mdniceç¼è¾å¨"><span>çæåç Promptï¼</span></h3>
<p><img src="https://img2024.cnblogs.com/blog/1336199/202512/1336199-20251226230930602-605100114.png" alt="image" loading="lazy"></p>
<p>&nbsp;</p>
<pre data-tool="mdniceç¼è¾å¨"><span data-cacheurl="" data-remoteid="" data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/9M0PhLTmTIeLmnQLStMsiaPjDhdHyic2puibLWicEN1ayLPAiaJCD1cPS0kNT55lIP2QAtlOqdXic0zRsuaUSBfCv7cCz1iaBaeaJaJ/640?wx_fmt=svg&amp;from=appmsg" data-fail="0"><code># è·å¥æè¨åä½æå<br><br>## ä¸ãèº«ä»½è®¾å®<br><span>ä½ æ¯ä¼ä¸è¡æ¿é¨é¨çèµæ·±ææ¡ä¸åï¼è´è´£ä¸ºè·å¥åå·¥æ°åç¬¦åå¬å¸æåçæ­£å¼è·å¥æè¨ãæ ¸å¿èè´£æ¯ï¼ç»ååå·¥å²ä½ç¹æ§ä¸è´¡ç®äº®ç¹ï¼æé ææçæãé»è¾æ¸æ°ãè´´ååºæ¯çåè¨åå®¹ï¼å¸®å©åå·¥å¨é¢å¥ä»ªå¼ä¸å±ç°ä¸ä¸å½¢è±¡ä¸å¢éç²¾ç¥ã<br><br>## äºãåä½åå<br>### å¿åäºé¡¹<br><span>1. å¿é¡»åå«è·å¥åå·¥å§åãæè·å¥é¡¹å¨ç§°ãå¬å¸åç§°<br><span>2. å¿é¡»çªåºåå·¥å²ä½æ ¸å¿èè´£ä¸å³é®è´¡ç®æ°æ®<br><span>3. å¿é¡»ä½ç°å¯¹å¬å¸ãå¢éãå®¶äººçæè°¢å±æ¬¡<br><span>4. å¿é¡»åå«å¯¹æªæ¥å·¥ä½çæ¿è¯ºä¸å±æ<br><br>### çº¦ææ¡ä»¶<br><span>1. ç¦æ­¢ä½¿ç¨å¤¸å¼ ä¸å®çè¡¨è¿°ï¼ææè´¡ç®éåºäºæä¾çäºå®<br><span>2. ç¦æ­¢åºç°ææè¯æ±æä¸å½è¡¨è¿°<br><span>3. ç¦æ­¢éæ¼æå®çæè°¢å¯¹è±¡<br><span>4. ç¦æ­¢è¶è¿è§å®å­æ°éå¶<br><br>## ä¸ãåéè¯´æ<br><span>&lt;åå·¥å§å&gt;{{EMPLOYEE_NAME}}&lt;/åå·¥å§å&gt; - è·å¥åå·¥çå®æ´å§å<br><span>&lt;å¥é¡¹ç±»å&gt;{{AWARD_TYPE}}&lt;/å¥é¡¹ç±»å&gt; - å·ä½è·å¥åç§°ï¼å¦ï¼å¹´åº¦ä¼ç§åå·¥ãå­£åº¦åæ°ä¹æï¼<br><span>&lt;å¬å¸åç§°&gt;{{COMPANY_NAME}}&lt;/å¬å¸åç§°&gt; - åå·¥æå¨ä¼ä¸å¨ç§°<br><span>&lt;å·¥ä½èè´£&gt;{{WORK_DUTIES}}&lt;/å·¥ä½èè´£&gt; - åå·¥æ¥å¸¸å·¥ä½åå®¹æ¦è¿°<br><span>&lt;æ ¸å¿è´¡ç®&gt;{{KEY_CONTRIBUTIONS}}&lt;/æ ¸å¿è´¡ç®&gt; - åå·¥è·å¥çå³é®ä¸ç»©æçªåºè¡¨ç°<br><span>&lt;æè°¢å¯¹è±¡&gt;{{THANKS_OBJECTS}}&lt;/æè°¢å¯¹è±¡&gt; - éè¦ç¹å«è´è°¢çä¸ªäººæå¢é<br><br>## åãåä½æµç¨<br>### ç¬¬ä¸æ­¥ï¼åå®¹æ¶ææ­å»º<br><span>1. å¼åºé®åï¼ç¤¼è²æ§ç§°å¼å¨åºäººå<br><span>2. è·å¥è´è°¢ï¼è¡¨è¾¾è·å¥çè£å¹¸ä¸æ¿å¨å¿æ<br><span>3. å·¥ä½åé¡¾ï¼ç®è¿°å²ä½ä»·å¼ä¸æ ¸å¿è´¡ç®<br><span>4. ææ©ç¯èï¼åå±æ¬¡æè°¢å¬å¸ãå¢éãå®¶äºº<br><span>5. æªæ¥å±æï¼æ¿è¯ºæªæ¥å·¥ä½æ¹åä¸ç®æ <br><br>### ç¬¬äºæ­¥ï¼ç»èå¡«å<br><span>1. å° &lt;åå·¥å§å&gt;{{EMPLOYEE_NAME}}&lt;/åå·¥å§å&gt; èªç¶èå¥å¼åºä¸è½æ¬¾<br><span>2. åç¡®å¼ç¨ &lt;å¥é¡¹ç±»å&gt;{{AWARD_TYPE}}&lt;/å¥é¡¹ç±»å&gt; å¨ç§°<br><span>3. ç»å &lt;å·¥ä½èè´£&gt;{{WORK_DUTIES}}&lt;/å·¥ä½èè´£&gt; è¯´æå²ä½ä»·å¼<br><span>4. ç¨æ°æ®åè¯­è¨åç° &lt;æ ¸å¿è´¡ç®&gt;{{KEY_CONTRIBUTIONS}}&lt;/æ ¸å¿è´¡ç®&gt;<br><span>5. æéè¦æ§æåºæå &lt;æè°¢å¯¹è±¡&gt;{{THANKS_OBJECTS}}&lt;/æè°¢å¯¹è±¡&gt;<br><br>### ç¬¬ä¸æ­¥ï¼é£æ ¼æ¶¦è²<br><span>1. è¯­è¨é£æ ¼ï¼æ­£å¼ä¸­å¸¦ææ¸©åº¦ï¼é¿åè¿äºå£è¯­å<br><span>2. ææè¡¨è¾¾ï¼æ§å¶æç»ªå°ºåº¦ï¼ä¿æä¸ä¸å¾ä½<br><span>3. æ¶é´æ§å¶ï¼æ3åéåè¨é¿åº¦è°æ´åå®¹è¯¦ç¥ï¼çº¦500-600å­ï¼<br><br>## äºãè¾åºè§è<br>### åå®¹ç»æ<br><span>1. æ é¢ï¼[å¥é¡¹åç§°]è·å¥æè¨<br><span>2. ç§°å¼ï¼å°æ¬çåä½é¢å¯¼ãäº²ç±çåäºä»¬ï¼<br><span>3. æ­£æï¼æåä½æµç¨é¡ºåºå±å¼<br><span>4. è½æ¬¾ï¼[åå·¥å§å] [æ¥æ]<br><br>### æ ¼å¼è¦æ±<br><span>1. ä½¿ç¨æ åå®ä½åå·å­ï¼1.5åè¡è·<br><span>2. å³é®è´¡ç®é¨åå ç²æ¾ç¤º<br><span>3. æè°¢å¯¹è±¡åç¬åæ®µ<br><span>4. ç»å°¾é¨åéåå«å¯¹å¬å¸æªæ¥çç¾å¥½ç¥æ¿<br><br>### è´¨éæ å<br><span>1. ç¬¦åå¬å¸æåä»·å¼è§<br><span>2. çªåºä¸ªäººè´¡ç®åæ¶ä½ç°å¢éç²¾ç¥<br><span>3. é¿åç©ºè¯å¥è¯ï¼ç¨å·ä½äºä¾æ¯æ<br><span>4. è¯­è¨æµçï¼é»è¾æ¸æ°ï¼ææçæ<br><br>## å­ãåä½ç¤ºä¾<br><span>ï¼æ­¤å¤çç¥ç¤ºä¾åå®¹ï¼å®éåä½æ¶éæ ¹æ®åéå¡«åï¼<br><br><span>è¯·ä¸¥æ ¼æç§ä»¥ä¸è¦æ±ï¼ç»åæä¾çåéä¿¡æ¯ï¼åä½ä¸ç¯å®æ´çè·å¥æè¨ã<br><br></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></pre>
<h2 data-tool="mdniceç¼è¾å¨"><span>è°è¯ Prompt</span></h2>
<h3 data-tool="mdniceç¼è¾å¨"><span>ææ¬çè§£</span></h3>
<p><img src="https://img2024.cnblogs.com/blog/1336199/202512/1336199-20251226230958750-1911894887.png" alt="image" loading="lazy"></p>
<h3 data-tool="mdniceç¼è¾å¨"><span>è§è§çè§£</span></h3>
<p><img src="https://img2024.cnblogs.com/blog/1336199/202512/1336199-20251226231016417-194421412.png" alt="image" loading="lazy"></p>
<h3 data-tool="mdniceç¼è¾å¨"><span>å¤è½®å¯¹è¯</span></h3>
<p><img src="https://img2024.cnblogs.com/blog/1336199/202512/1336199-20251226231026956-1766318256.png" alt="image" loading="lazy"></p>
<h2 data-tool="mdniceç¼è¾å¨"><span>ä¼å Prompt</span></h2>
<p><img src="https://img2024.cnblogs.com/blog/1336199/202512/1336199-20251226231045050-1953776592.png" alt="image" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/1336199/202512/1336199-20251226231052086-1099494036.png" alt="image" loading="lazy"></p>
</div>
<div id="MySignature" role="contentinfo">
    <blockquote>
<p style="font-family:YouYuan;font-size: 16px;margin: 0 auto 0.01em auto;"><span style="font-size: 17px; ">ä½èåç§°ï¼</span><a href="https://www.cnblogs.com/Can-daydayup/" target="_blank">è¿½éæ¶åè</a></p>
<p style="font-family:YouYuan;font-size: 16px;margin: 0 auto 0.01em auto;"><span style="font-size: 17px; ">ä½èç®ä»ï¼</span>ä¸ä¸ªç­ç±ç¼ç¨ãåäºåäº«ãåæ¬¢å­¦ä¹ ãæ¢ç´¢ãå°è¯æ°äºç©åæ°ææ¯çå¨æ è½¯ä»¶å·¥ç¨å¸ã</p>
<p style="font-family:YouYuan;font-size: 16px;margin: 0 auto 0.01em auto;">
æ¬æçæå½ä½èååå®¢å­å±æï¼æ¬¢è¿è½¬è½½ï¼ä½æªç»ä½èåæå¿é¡»ä¿çæ­¤æ®µå£°æï¼ä¸å¨æç« é¡µé¢ææ¾ä½ç½®ç»åºåæé¾æ¥ï¼å¦åä¿çè¿½ç©¶æ³å¾è´£ä»»çæå©ãå¦æè¯¥ç¯æç« å¯¹æ¨æå¸®å©çè¯ï¼å¯ä»¥ç¹ä¸ä¸å³ä¸è§ç<a onclick="votePost(cb_entryId,'Digg')" href="javascript:void(0)" style="color:red;">ãâ¥æ¨èâ¥ã</a>ï¼å¸æè½å¤æç»­çä¸ºå¤§å®¶å¸¦æ¥å¥½çææ¯æç« ï¼æä¸­å¯è½å­å¨æè¿°ä¸æ­£ç¡®çå°æ¹ï¼æ¬¢è¿ææ­£æè¡¥åï¼ä¸èææ¿ã
</p>
</blockquote>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-26 23:12">2025-12-26 23:11</span>&nbsp;
<a href="https://www.cnblogs.com/Can-daydayup">è¿½éæ¶åè</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19406862);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19406862', targetLink: 'https://www.cnblogs.com/Can-daydayup/p/19406862', title: 'ä¸æ¬¾ç±å­èè·³å¨æ¨åºç AI æç¤ºè¯çæåä¼åå·¥å·ï¼ä¸ºä½ æä¾æ´ç²¾åï¼ä¸ä¸ï¼å¯æç»­è¿­ä»£æç¤ºè¯ï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ go-zero rest æºç å­¦ä¹ ç¬è®° ]]></title>
    <link>https://www.cnblogs.com/xingzheanan/p/19404672</link>
    <guid>ba8de70b2ecc7d66a93bd3cc1704a8d8</guid>
    <description>
    <![CDATA[ 
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xingzheanan/p/19404672" title="åå¸äº 2025-12-26 22:19">
    <span role="heading" aria-level="2">go-zero rest æºç å­¦ä¹ ç¬è®°</span>
    

</a>

		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<hr>
<h1 id="æ¦è¿°">æ¦è¿°</h1>
<p><code>go-zero</code> åºäº <code>net/http</code> æ ååºå®ç°äºä¸å¥ <code>rest</code> web æ¡æ¶ãå¨ä½¿ç¨ <code>goctl</code> å¿«éå¼åçåæ¶ï¼ä¹éè¦äºè§£ <code>go-zero</code> åé¨åäºä»ä¹ãæ¬æç»å <a href="https://zeromicro.github.io/go-zero.dev/docs/component/rest" target="_blank" rel="noopener nofollow">go-zero rest</a>å­¦ä¹ å¶ä¸­çæºç ï¼åå¾åå°ç¥å¶æä»¥ç¶ã</p>
<h1 id="æºç ">æºç </h1>
<h2 id="æµç¨å¾">æµç¨å¾</h2>
<p><img alt="image" width="640" height="650" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1498760/202512/1498760-20251226221705436-349608438.png" class="lazyload"></p>
<p>å¨éè¯»æºç ä¹åï¼åçä¸æµç¨å¾æä¸ªå°è±¡ãä»æµç¨å¾å¤§è´å¯ä»¥çåºæ¥ï¼</p>
<ul>
<li>go-zero ä¼åå»ºè·¯ç±ç»ï¼å¶ä¸­æé¡ºåºæ³¨åäºå ç±» handlerï¼ä¸­é´ä»¶ï¼ï¼æåå¨ business handler å¤çä¸å¡é»è¾ã</li>
</ul>
<p>å¤§è´æä¸ªå°è±¡åå¼å§æºç èµ°è¯»ã</p>
<h2 id="æºç èµ°è¯»">æºç èµ°è¯»</h2>
<p>å¯å¨ api æå¡ï¼</p>
<pre><code class="language-go">func main() {  
    ...
    server := rest.MustNewServer(c.RestConf)  
    defer server.Stop()  
  
    ctx := svc.NewServiceContext(c)  
    handler.RegisterHandlers(server, ctx)  
  
    fmt.Printf("Starting server at %s:%d...\n", c.Host, c.Port)  
    server.Start()  
}
</code></pre>
<p>å¯å¨æå¡ä¸»è¦åäºä¸ä»¶äºï¼</p>
<ul>
<li>åå»ºæå¡ç«¯ server</li>
<li>æ³¨å handler å° server</li>
<li>å¯å¨æå¡ç«¯ server</li>
</ul>
<p>æé¡ºåºä»ç»ã</p>
<h3 id="åå»ºæå¡ç«¯-server">åå»ºæå¡ç«¯ server</h3>
<pre><code class="language-go">func MustNewServer(c RestConf, opts ...RunOption) *Server {  
    // NewServer åå»º server
    server, err := NewServer(c, opts...)  
    if err != nil {  
       logx.Must(err)  
    }  
  
    return server  
}

func NewServer(c RestConf, opts ...RunOption) (*Server, error) {
	// c.SetUp å¯å¨ Prometheusï¼tracing, profiling ç­æå¡
    if err := c.SetUp(); err != nil {  
       return nil, err  
    }  
  
    server := &amp;Server{  
       ngin:   newEngine(c),  
       router: router.NewRouter(),  
    }  
  
    ...
    return server, nil  
}
</code></pre>
<p>åå»º server å®éåå»ºçæ¯ server ç engine å routerã</p>
<p>engine ä¸»è¦ç»æå¦ä¸ï¼</p>
<pre><code class="language-go">type engine struct {  
    // server çéç½®
    conf   RestConf  
    routes []featuredRoutes  // ä¸å¡è·¯ç±
    // è°ç¨é¾
    chain                chain.Chain 
    // ä¸­é´ä»¶ 
    middlewares          []Middleware  
    ...
}

func newEngine(c RestConf) *engine {  
    svr := &amp;engine{  
       conf:    c,  
       timeout: time.Duration(c.Timeout) * time.Millisecond,  
    }
    ...
}
</code></pre>
<p>router ç»æå¦ä¸ï¼</p>
<pre><code class="language-go">func NewRouter() httpx.Router {  
    return &amp;patRouter{  
       trees: make(map[string]*search.Tree),  
    }  
}

type Router interface {  
    http.Handler  
    Handle(method, path string, handler http.Handler) error  
    SetNotFoundHandler(handler http.Handler)  
    SetNotAllowedHandler(handler http.Handler)  
}
</code></pre>
<p><code>patRouter</code> åå«è·¯ç±ä¿¡æ¯ï¼å¶å®ç°äº <code>Router</code> æ¥å£ã</p>
<p>åå»ºäº server åè¿éè¦æ³¨åè·¯ç± handler å° serverï¼è¿æ ·æå¡ç«¯æè½æ ¹æ®è·¯ç±æ¾å°å¯¹åºç handler å¤çã</p>
<h3 id="æ³¨åè·¯ç±-handler">æ³¨åè·¯ç± handler</h3>
<pre><code class="language-go">func RegisterHandlers(server *rest.Server, serverCtx *svc.ServiceContext) {  
    // server.AddRoutes æ³¨åè·¯ç± handler
    server.AddRoutes(  
       []rest.Route{  
          {  
             Method:  http.MethodGet,  
             Path:    "/ping",  
             Handler: pingHandler(serverCtx),  
          },  
       },  
    )
}

func (s *Server) AddRoutes(rs []Route, opts ...RouteOption) {  
    // èªå®ä¹çä¸å¡è·¯ç±å°è¢«å°è£å° featuredRoutes å¯¹è±¡
    r := featuredRoutes{  
       routes: rs,  
    }  
    for _, opt := range opts {  
       opt(&amp;r)  
    }  
    
    // å° featuredRoutes æ·»å å° Server.engine
    s.ngin.addRoutes(r)  
}

func (ng *engine) addRoutes(r featuredRoutes) {  
    ...
    // å®éæ¯å°è·¯ç±ç»æ·»å å° engine.routes ä¸­  
    ng.routes = append(ng.routes, r) 
}
</code></pre>
<p>ä¸å¡è·¯ç±æ³¨åå®ï¼æ¥ä¸æ¥å°è¿å¥å¯å¨ serverï¼è¿æ¯éè¦å³æ³¨çéç¹ã</p>
<h3 id="å¯å¨-server">å¯å¨ server</h3>
<pre><code class="language-go">func (s *Server) Start() {  
    // è°ç¨ Server.engine.start å¯å¨æå¡ç«¯ server
    handleError(s.ngin.start(s.router))  
}

func (ng *engine) start(router httpx.Router, opts ...StartOption) error {     // engine.bindRoutes ç»å®è·¯ç±å° router
    if err := ng.bindRoutes(router); err != nil {  
       return err  
    }  

    ...
    return internal.StartHttps(ng.conf.Host, ng.conf.Port, ng.conf.CertFile,  
       ng.conf.KeyFile, router, opts...)  
}

func (ng *engine) bindRoutes(router httpx.Router) error {  
    // engine.routes 
    for _, fr := range ng.routes {  
       // ç»å® rest.featuredRoutes 
       if err := ng.bindFeaturedRoutes(router, fr, metrics); err != nil { 
          return err  
       }  
    }  
  
    return nil  
}

func (ng *engine) bindFeaturedRoutes(router httpx.Router, fr featuredRoutes, metrics *stat.Metrics) error {  
    ...
    for _, route := range fr.routes {  
       if err := ng.bindRoute(fr, router, metrics, route, verifier); err != nil {  
          return err  
       }  
    }  
  
    return nil  
}

func (ng *engine) bindRoute(fr featuredRoutes, router httpx.Router, metrics *stat.Metrics,  
    route Route, verifier func(chain.Chain) chain.Chain) error {  
    // engine.chainï¼åå§åä¸º nil
    chn := ng.chain  
    if chn == nil {  
       // engine.buildChainWithNativeMiddlewares æ³¨åèªå¸¦ä¸­é´ä»¶å° engine.chain
       chn = ng.buildChainWithNativeMiddlewares(fr, route, metrics)  
    }  
  
    // æ·»å  AuthHandler å° engine.chain ä¸­
    chn = ng.appendAuthHandler(fr, chn, verifier)  
  
    // å°èªå®ä¹ä¸­é´ä»¶æ³¨åå° engine.chain
    for _, middleware := range ng.middlewares {  
       chn = chn.Append(convertMiddleware(middleware))  
    }  
    
    // engine.chain.ThenFunc å° handler ä¸²èæ handler
    handle := chn.ThenFunc(route.Handler)  
  
    return router.Handle(route.Method, route.Path, handle)  
}
</code></pre>
<p>å¯å¨ server çéç¹å¨ <code>engine.bindRoute</code>ã<br>
å¶ä¸­ï¼<code>engine.buildChainWithNativeMiddlewares</code> æ³¨å <code>go-zero</code> èªå¸¦ä¸­é´ä»¶ï¼</p>
<pre><code class="language-go">func (ng *engine) buildChainWithNativeMiddlewares(fr featuredRoutes, route Route,  
    metrics *stat.Metrics) chain.Chain {  
    chn := chain.New()
    ...
    // MaxConns ç¨äºå¹¶åæ§å¶
    if ng.conf.Middlewares.MaxConns {  
        chn = chn.Append(handler.MaxConnsHandler(ng.conf.MaxConns))  
    }  
    if ng.conf.Middlewares.Breaker {  
        chn = chn.Append(handler.BreakerHandler(route.Method, route.Path, metrics))  
    }
    ...
}
</code></pre>
<p>ç±»ä¼¼çï¼èªå®ä¹ä¸­é´ä»¶éè¿ <code>chn.Append(convertMiddleware(middleware))</code> æ³¨åå° <code>engine.chain</code> ä¸­ã</p>
<p>æ¥çè°ç¨ <code>chain.ThenFunc</code> ä¸²èä¸­é´ä»¶æ <code>handler</code>ï¼</p>
<pre><code class="language-go">func (c chain) ThenFunc(fn http.HandlerFunc) http.Handler {  
    ...
    return c.Then(fn)  
}

func (c chain) Then(h http.Handler) http.Handler {  
    if h == nil {  
       h = http.DefaultServeMux  
    }  
  
    // è¿æ®µä»£ç å¾æææï¼å®å°ææä¸­é´ä»¶æé¡ºåºä¸²èèµ·æ¥ç»æä¸ä¸ª handler
    // è°ç¨è¿ä¸ª handler å¤çæ¶ä¼ç»è¿åç»­ä¸ç³»åçä¸­é´ä»¶ï¼æç»å°ä¸å¡ handler å¤ç
    // å·ä½å¯åè https://github.com/zeromicro/go-zero/blob/master/rest/chain/chain.go#L81
    for i := range c.middlewares {  
       h = c.middlewares[len(c.middlewares)-1-i](h)  
    }  
  
    return h  
}
</code></pre>
<p>æåå°è¯¥ handler åè·¯ç±ä¿¡æ¯æ³¨åå° <code>router</code> ä¸­ï¼åç»­æå¡ç«¯æ ¹æ®è¯·æ±å¨ <code>router</code> ä¸­æ¥æ¾å¯¹åºç <code>handler</code> å¤çã</p>
<pre><code class="language-go">func (pr *patRouter) Handle(method, reqPath string, handler http.Handler) error {  
    ...
    
    tree, ok := pr.trees[method]  
    if ok {  
       return tree.Add(cleanPath, handler)  
    }  
  
    tree = search.NewTree()  
    pr.trees[method] = tree  
    return tree.Add(cleanPath, handler)  
}
</code></pre>
<p>è¯¦ç»æµç¨å¦ä¸å¾ï¼</p>
<p><img alt="image" width="661" height="570" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1498760/202512/1498760-20251226221741618-758878849.png" class="lazyload"></p>
<h1 id="å°ç»">å°ç»</h1>
<p>æ¬æä»ç»äº go-zero rest çæºç æ¯æä¹å¤çè¯·æ±çãä»æºç ä¹å¯ä»¥çåºæ¯ä¸ªè¯·æ±èåæ¯ä¸ç³»åä¸­é´ä»¶ handler å¨å¤çï¼å¹¶ä¸ server å¯å¨äº Prometheusï¼Trace ç­æå¡è´è´£çæ§ï¼é¾è·¯è¿½è¸ªç­ï¼ä½¿å¾å¼åå¾®æå¡æ¶åªéè¦å³æ³¨ä¸å¡é»è¾å³å¯ï¼éå¸¸æ¹ä¾¿ã</p>
<h1 id="åèèµæ">åèèµæ</h1>
<ul>
<li><a href="https://zeromicro.github.io/go-zero.dev/docs/component/rest" target="_blank" rel="noopener nofollow">go-zero rest</a></li>
<li><a href="https://refactoringguru.cn/design-patterns/chain-of-responsibility/go/example" target="_blank" rel="noopener nofollow">Go è´£ä»»é¾æ¨¡å¼</a></li>
</ul>
<hr>

</div>
<div id="MySignature" role="contentinfo">
    èå°çäºç©ºè°·ï¼ä¸ä»¥æ äººèä¸è³ã
</div>
<div class="clear"></div>

		</div>
		<div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-26 22:19">2025-12-26 22:19</span>&nbsp;
<a href="https://www.cnblogs.com/xingzheanan">è¡äºTroy</a>&nbsp;
éè¯»(<span id="post_view_count">2</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19404672);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19404672', targetLink: 'https://www.cnblogs.com/xingzheanan/p/19404672', title: 'go-zero rest æºç å­¦ä¹ ç¬è®°' })">ä¸¾æ¥</a>
</div>
	 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä¸ç¯åºäºAWSæå¡æ­å»ºçå¨çæå¡æ¶æ ]]></title>
    <link>https://www.cnblogs.com/linnuo/p/19388428</link>
    <guid>08e16f24d97217658df10e484a69c24a</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/linnuo/p/19388428" title="åå¸äº 2025-12-26 19:37">
    <span role="heading" aria-level="2">ä¸ç¯åºäºAWSæå¡æ­å»ºçå¨çæå¡æ¶æ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>ä¸ãèæ¯</p>
<p>ããå½æä»¬å¨åå¨çä¸å¡æ¶ï¼ä¾å¦ç½ç«/æºå¨/æ¸¸æï¼ä¸ºäºæ¯æå¨çç¨æ·ï¼æä»¬ä¼å¨ä¸åçä½ç½®æ­å»ºèç¹ï¼ä»¥æ»¡è¶³ä¸å¡åè½åååºå®æã</p>
<p>æä»¬ä¼æ­å»ºä¸ä¸ªè¿æ ·çæ¶ææ»¡è¶³åæ­¥çä½¿ç¨ã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1009313/202512/1009313-20251223161146575-2137564282.png" class="lazyload"></p>
<p>&nbsp;ãã</p>
<p>ããè½ç¨æ¯okçäºï¼ä¼æä»ä¹é®é¢å¢ï¼</p>
<p>ãã1ãå ä¸ºæå¡ç¬ç«ï¼ä¸æ¶1ä¸ªSKUéè¦å¤æ¬¡åå¸å°ä¸åçæå¡ã</p>
<p>ãã2ãå ä¸ºååè¿å¤ï¼åå¸æ¶éè¦é¢ç¹çéåºãç»å½åæ¢ä¸åçäºçº§ååï¼éå¸¸ç¹çä¸è¯´ï¼è¿å¯è½ä¼éæ¼ã</p>
<p>ãã3ãåæå¤çæ°æ®ç»è®¡ãæ¥è¡¨ãçæ¿ãè®¾å¤å°å¾ï¼èæ¶è´¹åã</p>
<p>ãã4ãè¿è¿æ¯åèç¹ï¼æªèèé«å¯ç¨çæåµä¸ï¼å¤åºåãå¤èç¹é¨ç½²æå¡å¨å¯¼è´è¿ç»´é¾åº¦å¢å ãè¿å¤çè´¢å¡å¼æ¯ã</p>
<div>
<div>ãã5ãåä¸ªèç¹åç©åçã</div>
<div>&nbsp;</div>
<div>ããæä»ä¹æ¹å¼å¯ä»¥è§£å³è¿äºé®é¢ï¼</div>
<div>ããAWSæå¡ç»ä»¶å¾å¥½æ¯æã</div>
<div>&nbsp;</div>
<div>äºãAWSæ¶æ</div>
<div>ããAWSæä¾äºéå¸¸ä¸°å¯çç»ä»¶ï¼åå ä¸ªå¸¸ç¨çï¼</div>
<div>ãã1ãRoute 53 è´è´£ååè§£ææµéç®¡çå¥åº·æ£æ¥ï¼é«å¯ç¨å¯ä»¥ç¨å°å®ã</div>
<div>ãã2ãVPC èæç§æç½ç»ï¼å¯å°åä¸åºåçæå¡å¨ãæ°æ®åºç½®äºåä¸åç½æ®µï¼æåè®¿é®éåº¦ã</div>
<div>ãã3ãCloudFront CDNå éï¼å¯ä»¥ç»è®¿é®è¯·æ±ãå¯¹è±¡å­å¨å éãå½æ°åè½æå¶å¼ºå¤§ï¼å¯éç½®HTTPãHTTPSçè¯·æ±è·¨åï¼å¯è¯å«å¨çæµéæ¥æºï¼æ ¹æ®æ¥æºååå°ä¸ååºåçèç¹ã</div>
<div>ãã4ãEC2 æå¡å¨ï¼åå«äºè´è½½åè¡¡å¨ELBãç®æ ç»ï¼å¯å®ç°åä¸å°åºçæå¡å¨çè´è½½åè¡¡åé«å¯ç¨ãç»åCloudFrontå¯å°æµéååå°å°±è¿çæå¡ã</div>
<div>ãã5ãAurora and RDS æ°æ®åºï¼Aurora ä½ä¸ºå¨çæ°æ®åºï¼å·²å®ç°ä¸»ä»å¤ä»½ï¼å¯å¨1såå®ç°å¨çæ°æ®åæ­¥ï¼ç»åRoute 53çç­ååå®ç°è¯»ååç¦»ã</div>
<div>ãã6ãS3 å¯¹è±¡å­å¨ï¼OSSå­å¨å¾çãè§é¢ãææ¡£ãé³é¢ç­ã</div>
<div>ãã7ãCertificate Manager å®å¨å­è¯ç®¡çï¼å¯ç³è¯·åç®¡çè¯ä¹¦ã</div>
<div>&nbsp;</div>
<div>ããæ¶æå®æ¯è¿æ ·çã&nbsp;</div>
<div>&nbsp;
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1009313/202512/1009313-20251223171110168-222600570.png" class="lazyload"></p>
<p>&nbsp;</p>
<p>ä¸ãå¹²æ´»ï¼ç®åçä¸ç¬å¸¦è¿</p>
<p>ãã1ãå°å¤é¨ååè§£æå°Route 53ã</p>
<p>ãã2ãå¨Certificate Managerç³è¯·è¯ä¹¦ã</p>
<p>ãã3ãå¨æå®çåºååå»ºVPCåç½ã</p>
<p>ãã4ãè´­ä¹°æå¡å¨åæ°æ®åºæ¶éæ©ä¸é¢çåå»ºçVPCåç½ã</p>
<p>ãã5ãå¨åå»ºAuroraæ°æ®åºæ¶éè¦éç¡®è®¤æä¸ä¸ªåºåä¸ºä¸»éç¾¤ï¼ä¸»éç¾¤ä¸ä¼åå»ºåå¥å¨å®ä¾ãè¯»åå¨å®ä¾ã</p>
<p>ããããååå»ºå¶å®åºåçè¯»åå®ä¾ï¼å¦ä¸å¾ï¼</p>
<p><img alt="f9edbdf666a249221b20525d951cdf3b" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1009313/202512/1009313-20251226182110841-398379187.png" class="lazyload"></p>
<p>&nbsp;ãã</p>
<p>ãã6ãå¨Route 53åå»ºä¸ä¸ªç§æçç­ååï¼ç¨äºæ°æ®åºè¿æ¥ï¼æ éå¨ååä¾åºåè´­ä¹°ãæè¿éç¨&nbsp;db.com</p>
<p><img alt="402ddedc223507ba4f2e187ad161cc2c" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1009313/202512/1009313-20251226182936710-214684981.png" class="lazyload"></p>
<p>&nbsp;ã</p>
<p>ãã7ãå°äºçº§ååæåå°Auroraçåååæåå°Auroraçåå¥å¨å®ä¾çDNSï¼è·¯ç±ç­ç¥ï¼ç®åï¼ï¼</p>
<p>ããããè¯»ååæåå°å¤ä¸ªè¯»åå¨å®ä¾çDNSï¼è·¯ç±ç­ç¥ï¼å»¶è¿ï¼ãæ°æ®åå¥å°ä¸»åºåï¼1såå¯åæ­¥å°ææçä»åº</p>
<p><img alt="fe4075fd22ed2a0e1e2919b9d2e47b5b" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1009313/202512/1009313-20251226183740690-1770250735.png" class="lazyload"></p>
<p>&nbsp;ãã</p>
<p>ãã8ãå¨EC2è´­ä¹°æå¡å¨åï¼æ°å»ºç®æ ç»ï¼å°æå¡å¨æ·»å å°ç®æ ç»ä¸­</p>
</div>
<div>
<p><img alt="b9e98fda4ad55cabc5a3bd5d55ff112f" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1009313/202512/1009313-20251226184018089-1840892184.png" class="lazyload"></p>
<p>&nbsp;ãã</p>
<p>ãã9ãå¨EC2åå»ºè´è½½åè¡¡å¨ï¼è¿éåNLBï¼æå¡å¨ä¹é´ç¨ï¼åELBï¼æå¡å¨åé¨æå¡ä¹é´ç¨ï¼ï¼å±çº§åé¢ç²åº¦ä¸åã</p>
<p>ããããè¿éåå»ºNLBï¼æ·»å è½¬åå°çç®æ ç»å°ä¾¦å¬å¨ï¼æ³¨æéæ©VPCãåå»ºå®å³å¯éè¿DNSè®¿é®ã</p>
<p><img alt="5baa9287044b30796f6ebb020436d6f6" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1009313/202512/1009313-20251226185036451-972314899.png" class="lazyload"></p>
<p>&nbsp;ãã</p>
<p>ãã10ãåå»ºCloudFrontï¼å°éè¦ç»è¿CDNå éçååæ·»å å°å¤ç¨ååï¼æ·»å ç¬¬2æ­¥åå»ºçè¯ä¹¦ï¼æºæ·»å å°è®¿é®ç®æ çDNSãæååCloudFrontä¼åéååã</p>
<p><img alt="aeaa7964-4abc-47f7-965c-b70c4dee3682" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1009313/202512/1009313-20251226190034692-587236478.png" class="lazyload"></p>
<p>&nbsp;</p>
<p>ãã11ãå¨Route 53å°ç»è¿CloudFrontå éçååæåå°CloudFrontåéååä¸ã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1009313/202512/1009313-20251226191104820-176120704.png" class="lazyload"></p>
<p>&nbsp;</p>
<p>ãã12ãå¨Route 53åå»ºNLBçå¥åº·æ£æ¥ï¼æååçæIDã</p>
<p>ãã13ãå¨Route 53æ·»å æéè½¬ç§»ååï¼ç¨äºæå¡åºåä¹é´çé«å¯ç¨ï¼æ éé¢å¤éè´­æå¡å¨</p>
<p><img alt="98eb6d3e-2d4c-4a8f-97f9-6261ccbfc409" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1009313/202512/1009313-20251226192552766-1296828574.png" class="lazyload"></p>
<p>&nbsp;</p>
<p>ãã14ãå¨CloudFrontåå»ºå½æ°ï¼å°è¯·æ±æç§å½å®¶åå°åºååå°ç¸åºçæå¡å¨ã</p>
<p><img alt="5b4907ff50b14eae080e4168c566cd54" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1009313/202512/1009313-20251226193257135-1536316299.png" class="lazyload"></p>
<p>&nbsp;ããä»£ç å¦ä¸ï¼</p>
<div class="cnblogs_code">
<pre>import cf from 'cloudfront'<span style="color: rgba(0, 0, 0, 1)">;

</span><span style="color: rgba(0, 0, 255, 1)">function</span><span style="color: rgba(0, 0, 0, 1)"> handler(event) {
    const request </span>=<span style="color: rgba(0, 0, 0, 1)"> event.request;
    const headers </span>=<span style="color: rgba(0, 0, 0, 1)"> request.headers;
    const country </span>= headers['cloudfront-viewer-country'] &amp;&amp; headers['cloudfront-viewer-country'<span style="color: rgba(0, 0, 0, 1)">].value;
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> List of countries to ALB endpoints</span>
    const countryToContinent =<span style="color: rgba(0, 0, 0, 1)"> {
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> äºå¤ªå°åº (Asia-Pacific) -&gt; Asia</span>
        'AF': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'AM': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'AZ': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BD': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BN': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BT': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CC': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CK': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CX': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GE': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'HK': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'ID': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'IN': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'IO': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'JP': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'KG': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'KH': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'KR': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'KZ': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'LA': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'LK': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MM': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MN': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MO': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MP': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MV': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MY': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'NC': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'NF': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'NP': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'NR': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'NU': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'NZ': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'PH': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'PK': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'PN': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SB': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SG': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TH': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TJ': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TL': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TM': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TO': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TV': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TW': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'UZ': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'VU': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'WF': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'WS': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'YE': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å¤§æ´æ´² (Oceania) - éå¸¸å½ç±»ä¸ºäºå¤ªå°åº</span>
        'AS': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'AU': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'FJ': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'PF': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GU': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'KI': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MH': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'FM': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'PW': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'PG': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TK': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> åææ´² (Antarctica) - éå¸¸åç¬å¤çï¼è¿éææ¶å½å¥äºå¤ª</span>
        'AQ': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BV': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GS': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'HM': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TF': 'Asia'<span style="color: rgba(0, 0, 0, 1)">,
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¬§æ´²ãéæ´²ãä¸­ä¸ -&gt; Europe</span>
        'AL': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'AD': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'AT': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'AX': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BA': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BE': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BG': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BY': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CH': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CY': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CZ': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'DE': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'DK': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'EE': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'ES': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'FI': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'FO': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'FR': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GG': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GI': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GR': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'HR': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'HU': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'IE': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'IM': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'IS': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'IT': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'JE': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'LI': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'LT': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'LU': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'LV': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MC': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MD': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'ME': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MK': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MT': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'NL': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'NO': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'PL': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'PT': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'RO': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'RS': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'RU': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SE': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SI': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SJ': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SK': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SM': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'UA': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'VA': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GB': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'DZ': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'AO': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BJ': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BW': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BF': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BI': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CV': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CM': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CF': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TD': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'KM': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CG': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CD': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CI': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'DJ': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'EG': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GQ': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'ER': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'ET': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GA': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GM': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GH': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GN': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GW': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'KE': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'LS': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'LR': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'LY': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MG': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MW': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'ML': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MR': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MU': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'YT': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MA': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MZ': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'NA': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'NE': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'NG': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'RW': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'RE': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SH': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SN': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SC': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SL': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SO': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'ZA': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SS': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SD': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'ST': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SZ': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TG': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TN': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TZ': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'UG': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'EH': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'ZM': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'ZW': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'AE': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BH': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'IR': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'IQ': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'IL': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'JO': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'KW': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'LB': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'OM': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'PS': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'QA': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SA': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SY': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TR': 'Europe'<span style="color: rgba(0, 0, 0, 1)">,
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ç¾æ´² -&gt; America</span>
        'AI': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'AG': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'AW': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BS': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BB': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BZ': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BM': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BQ': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CA': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'KY': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CR': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CU': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'CW': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'DM': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'DO': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SV': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GD': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GL': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GP': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'GT': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'HT': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'HN': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'JM': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MQ': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MX': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MS': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'NI': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'PA': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'PR': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'BL': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'KN': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'LC': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'MF': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'PM': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'VC': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'SX': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TT': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'TC': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'US': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'UM': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'UY': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'VE': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'VG': 'America'<span style="color: rgba(0, 0, 0, 1)">,
        </span>'VI': 'America'<span style="color: rgba(0, 0, 0, 1)">
    };

    const continentToRegion </span>=<span style="color: rgba(0, 0, 0, 1)"> {
        </span>'Asia': 'asia.autovxxxxxx.com',         <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> äºæ´²æéè½¬ç§»åå</span>
        'Europe': 'europu.autovxxxxxx.com',     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¬§æ´²æéè½¬ç§»åå</span>
        'America': 'america.autovxxxxxxx.com'    <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ç¾æ´²æéè½¬ç§»åå</span>
<span style="color: rgba(0, 0, 0, 1)">    };

    const DEFAULT_REGION </span>= 'NLB-Asia-Singapore-5e42xxxxxxxx4853.elb.ap-southeast-1.amazonaws.com'; <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">æ¹ä¸ºèªå·±çé»è®¤alb åå</span>
    const targetContinent = (country &amp;&amp; countryToContinent[country]) || 'Asia'<span style="color: rgba(0, 0, 0, 1)">;
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> const targetContinent = 'Asia';</span>
    const targetOrigin = (targetContinent &amp;&amp; continentToRegion[targetContinent]) ||<span style="color: rgba(0, 0, 0, 1)"> DEFAULT_REGION;

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æå°ææè¯·æ±å¤´</span>
    console.log("=== ææè¯·æ±å¤´ä¿¡æ¯ ==="<span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">for</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> headerName <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> headers) {
        </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (headers.hasOwnProperty(headerName)) {
            </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> headers å¯¹è±¡çå¼æ¯ä¸ä¸ªåå« 'value' å±æ§çå¯¹è±¡</span>
            <span style="color: rgba(0, 0, 255, 1)">var</span> headerValue =<span style="color: rgba(0, 0, 0, 1)"> headers[headerName].value;
            console.log(headerName </span>+ ": " +<span style="color: rgba(0, 0, 0, 1)"> headerValue);
        }
    }
    console.log(</span>'targetOrigin: ' +<span style="color: rgba(0, 0, 0, 1)"> targetOrigin);

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ä½¿ç¨CloudFront 2.0 APIä¿®æ¹origin</span>
<span style="color: rgba(0, 0, 0, 1)">    cf.updateRequestOrigin({
        </span>"domainName"<span style="color: rgba(0, 0, 0, 1)">: targetOrigin,
        </span>"port": 80<span style="color: rgba(0, 0, 0, 1)">,
        </span>"protocol": 'http'<span style="color: rgba(0, 0, 0, 1)">,
        </span>"timeouts"<span style="color: rgba(0, 0, 0, 1)">: {
            </span>"readTimeout": 30<span style="color: rgba(0, 0, 0, 1)">,
            </span>"connectionTimeout": 5<span style="color: rgba(0, 0, 0, 1)">
        }
    });
    
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ·»å è°è¯ä¿¡æ¯ - ç¡®ä¿å¼æ¯å­ç¬¦ä¸²</span>
    request.headers['x-debug-country'] = { value: String(country || 'unknown'<span style="color: rgba(0, 0, 0, 1)">) };
    request.headers[</span>'x-debug-targetorigin'] =<span style="color: rgba(0, 0, 0, 1)"> { value: String(targetOrigin) };

    </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> request;
}</span></pre>
</div>
<p>ããè§£å³è·¨åé®é¢ï¼å½æ°ä»£ç å¦ä¸ï¼</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">function</span><span style="color: rgba(0, 0, 0, 1)"> handler(event)  {
    </span><span style="color: rgba(0, 0, 255, 1)">var</span> response  =<span style="color: rgba(0, 0, 0, 1)"> event.response;
    </span><span style="color: rgba(0, 0, 255, 1)">var</span> headers  =<span style="color: rgba(0, 0, 0, 1)"> response.headers;

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> If Access-Control-Allow-Origin CORS header is missing, add it.</span>
    <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Since JavaScript doesn't allow for hyphens in variable names, we use the dict["key"] notation.</span>
    <span style="color: rgba(0, 0, 255, 1)">if</span> (!headers['access-control-allow-origin'<span style="color: rgba(0, 0, 0, 1)">]) {
        headers[</span>'access-control-allow-origin'] = {value: "*"<span style="color: rgba(0, 0, 0, 1)">};
        console.log(</span>"Access-Control-Allow-Origin was missing, adding it now."<span style="color: rgba(0, 0, 0, 1)">);
        headers[</span>'access-control-allow-headers'] = {value: "Origin, X-Requested-With, Content-Type, Accept"<span style="color: rgba(0, 0, 0, 1)">};
        headers[</span>'access-control-allow-methods'] = {value: "GET,POST,PUT, OPTIONS"<span style="color: rgba(0, 0, 0, 1)">};
    }

    </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> response;
}</span></pre>
</div>
<p>ãã</p>
<p>ããokï¼å®äºå¿</p>
<p>ãã</p>
<p>&nbsp;</p>
&nbsp;</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-26 19:37">2025-12-26 19:37</span>&nbsp;
<a href="https://www.cnblogs.com/linnuo">ooLeo</a>&nbsp;
éè¯»(<span id="post_view_count">29</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19388428);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19388428', targetLink: 'https://www.cnblogs.com/linnuo/p/19388428', title: 'ä¸ç¯åºäºAWSæå¡æ­å»ºçå¨çæå¡æ¶æ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ é«å¹¶åä¸å¦ä½é²æ­¢ååè¶åï¼ ]]></title>
    <link>https://www.cnblogs.com/12lisu/p/19406444</link>
    <guid>3a3bec279446bb3cde1b65eabb60d582</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/12lisu/p/19406444" title="åå¸äº 2025-12-26 19:21">
    <span role="heading" aria-level="2">é«å¹¶åä¸å¦ä½é²æ­¢ååè¶åï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="åè¨">åè¨</h2>
<p>"å¿«çæä»¬çç§æç³»ç»ï¼åºå­æ¾ç¤º-500äºï¼"</p>
<p>3å¹´åçè¿ä¸ªçµè¯è®©æè®°å¿ç¹æ°ã</p>
<p>å½æ¶æçµåå¤§ä¿ï¼æä»¬èªè®¤ä¸ºå®ç¾çåå¸å¼æ¶æï¼å¨0ç¹æ´ç¬é´è¢«å»ç©¿ã</p>
<p>æ°æ®åºè¿æ¥æ± èå°½ï¼åºå­è¡¨åºç°è´æ°ï¼å®¢æçµè¯è¢«æç...</p>
<p>ä»å¤©è¿ç¯æç« è·å¤§å®¶ä¸èµ·èèååè¶åçé®é¢ï¼å¸æå¯¹ä½ ä¼ææå¸®å©ã</p>
<h2 id="1-ä¸ºä»ä¹ä¼åçè¶å">1 ä¸ºä»ä¹ä¼åçè¶åï¼</h2>
<p>é¦åæä»¬ä¸èµ·ççä¸ºä»ä¹ä¼åéè¶åï¼</p>
<h3 id="11-æ°æ®åºçæåé²çº¿æ¼æ´">1.1 æ°æ®åºç"æåé²çº¿"æ¼æ´</h3>
<p>æä»¬ç¨ä¸é¢çåå­ï¼ç»å¤§å®¶ä»ç»ä¸ä¸ååè¶åæ¯å¦ä½åççã</p>
<pre><code class="language-java">public boolean buy(int goodsId) {
    // 1. æ¥è¯¢åºå­
    int stock = getStockFromDatabase(goodsId);
    if (stock &gt; 0) {
        // 2. æ£ååºå­
        updateStock(goodsId, stock - 1);
        return true;
    }
    return false;
}
</code></pre>
<p>å¨å¹¶ååºæ¯ä¸å¯è½åæä¸å¾è¿æ ·çï¼</p>
<p><img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/f2852491-a472-4fc7-a036-128160583d28.png" class="lazyload"></p>
<p>è¯·æ±1åè¯·æ±2é½å°åºå­æ´æ°æ9ã</p>
<p><strong>æ ¹æ¬åå </strong>ï¼æ°æ®åºçæ¥è¯¢åæ´æ°æä½ï¼ä¸æ¯åå­æ§æ ¡éªï¼å¤ä¸ªäºå¡å¯è½åæ¶éè¿stock&gt;0çæ¡ä»¶æ£æ¥ã</p>
<h3 id="12-è¶åçæ¬è´¨">1.2 è¶åçæ¬è´¨</h3>
<p><strong>ååè¶åçæ¬è´¨æ¯</strong>ï¼å¤ä¸ªè¯·æ±åæ¶ç©¿éç¼å­ï¼åä¸æ¶å»è¯»åå°ç¸ååºå­å¼ï¼æç»å¨æ°æ®åºå±åçè¦çã</p>
<p>å°±å100ä¸ªäººåæ¶çä¸ä¸ä»¶è¡£æï¼é½å»è¯è¡£é´åçäºç¼çå­ï¼åºæ¥æ¶é½è§å¾èªå·±åºè¯¥æ¿å°é£ä»¶è¡£æã</p>
<h2 id="2-é²æ­¢è¶åçæ¹æ¡">2 é²æ­¢è¶åçæ¹æ¡</h2>
<h3 id="21-æ°æ®åºä¹è§é">2.1 æ°æ®åºä¹è§é</h3>
<p>æ°æ®åºä¹è§éçæ ¸å¿åçæ¯éè¿çæ¬å·æ§å¶å¹¶åã</p>
<p>ä¾å¦ä¸é¢è¿æ ·çï¼</p>
<pre><code class="language-sql">UPDATE product 
SET stock = stock -1, version=version+1 
WHERE id=123 AND version=#{currentVersion};
</code></pre>
<p>Javaçå®ç°ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-java">@Transactional
public boolean deductStock(Long productId) {
    Product product = productDao.selectForUpdate(productId);
    if (product.getStock() &lt;= 0) return false;
    
    int affected = productDao.updateWithVersion(
        productId, 
        product.getVersion(),
        product.getStock()-1
    );
    return affected &gt; 0;
}
</code></pre>
<p>åºäºæ°æ®åºä¹è§éæ¹æ¡çæ¶æå¾å¦ä¸ï¼</p>
<p><img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/0b9ea248-6949-441a-b1e4-a29482b392b1.png" class="lazyload"></p>
<p><strong>ä¼ç¼ºç¹åæ</strong>ï¼</p>
<table>
<thead>
<tr>
<th style="text-align: center"><strong>ä¼ç¹</strong></th>
<th style="text-align: center"><strong>ç¼ºç¹</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center">æ éé¢å¤ä¸­é´ä»¶</td>
<td style="text-align: center">é«å¹¶åæ¶DBååå¤§</td>
</tr>
<tr>
<td style="text-align: center">å®ç°ç®å</td>
<td style="text-align: center">å¯è½åºç°å¤§éæ´æ°å¤±è´¥</td>
</tr>
</tbody>
</table>
<p><strong>éç¨åºæ¯</strong>ï¼æ¥è®¢åé1ä¸ä»¥ä¸çä¸­å°ç³»ç»ã</p>
<h3 id="22-redisåå­æä½">2.2 Redisåå­æä½</h3>
<p>Redisåå­æä½çæ ¸å¿åçæ¯ä½¿ç¨ï¼Redis + Luaèæ¬ã</p>
<p>æ ¸å¿ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-java">// Luaèæ¬ä¿è¯åå­æ§
String lua = "if redis.call('get', KEYS &gt;= ARGV[1] then " +
             "return redis.call('decrby', KEYS[1], ARGV " +
             "else return -1 end";

public boolean preDeduct(String itemId, int count) {
    RedisScript&lt;Long&gt; script = new DefaultRedisScript&lt;&gt;(lua, Long.class);
    Long result = redisTemplate.execute(script, 
        Collections.singletonList(itemId), count);
    return result != null &amp;&amp; result &gt;= 0;
}
</code></pre>
<p>è¯¥æ¹æ¡çæ¶æå¾å¦ä¸ï¼</p>
<p><img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/f66162f1-674a-454b-9303-9ad60e5898ac.png" class="lazyload"></p>
<p><strong>æ§è½å¯¹æ¯</strong>ï¼</p>
<ul>
<li>åèç¹QPSï¼æ°æ®åºæ¹æ¡500 vs Redisæ¹æ¡8ä¸</li>
<li>ååºæ¶é´ï¼&lt;1ms vs 50ms+</li>
</ul>
<h3 id="23-åå¸å¼é">2.3 åå¸å¼é</h3>
<p>ç®åæå¸¸ç¨çåå¸å¼éçæ¹æ¡æ¯Redissonã</p>
<p>ä¸é¢æ¯Redissonçå®ç°ï¼</p>
<pre><code class="language-java">RLock lock = redisson.getLock("stock_lock:"+productId);
try {
    if (lock.tryLock(1, 10, TimeUnit.SECONDS)) {
        // æ§è¡åºå­æä½
    }
} finally {
    lock.unlock();
}
</code></pre>
<h4 id="æ³¨æäºé¡¹">æ³¨æäºé¡¹</h4>
<ol>
<li>1.éç²åº¦è¦ç»åå°ååçº§å«</li>
<li>2.å¿é¡»è®¾ç½®ç­å¾æ¶é´åèªå¨éæ¾</li>
<li>3.éåå¼æ­¥éåä½¿ç¨æææ´ä½³</li>
</ol>
<p>è¯¥æ¹æ¡çæ¶æå¾å¦ä¸ï¼</p>
<p><img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/1f137288-3e7f-400a-b8ce-4da506950f46.png" class="lazyload"></p>
<h3 id="24-æ¶æ¯éååå³°">2.4 æ¶æ¯éååå³°</h3>
<p>å¯ä»¥ä½¿ç¨ RocketMQçäºå¡æ¶æ¯ã</p>
<p>æ ¸å¿ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-java">// RocketMQäºå¡æ¶æ¯ç¤ºä¾
TransactionMQProducer producer = new TransactionMQProducer("stock_group");
producer.setExecutor(new TransactionListener() {
    @Override
    public LocalTransactionState executeLocalTransaction(Message msg) {
        // æ£åæ°æ®åºåºå­
        return LocalTransactionState.COMMIT_MESSAGE;
    }
});
</code></pre>
<p>è¯¥æ¹æ¡çæ¶æå¾å¦ä¸ï¼</p>
<p><img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/1fa85ecb-d6d6-48fa-b925-d59bb0ac2835.png" class="lazyload"></p>
<p><strong>ææ¯ææ </strong>ï¼</p>
<ul>
<li>åå³°è½åï¼10ä¸QPS â 2ä¸TPS</li>
<li>è®¢åå¤çå»¶è¿ï¼&lt;1ç§ï¼æ­£å¸¸æ¶æ®µï¼</li>
</ul>
<h3 id="25-é¢æ£åºå­">2.5 é¢æ£åºå­</h3>
<p>é¢æ£åºå­æ¯é²æ­¢ååè¶åçç»ææ¹æ¡ã</p>
<p>æ ¸å¿ç®æ³å¦ä¸ï¼</p>
<pre><code class="language-java">// Guava RateLimiteréæµ
RateLimiter limiter = RateLimiter.create(1000); // æ¯ç§1000ä¸ªä»¤ç

public boolean preDeduct(Long itemId) {
    if (!limiter.tryAcquire()) return false;
    
    // åå¥é¢æ£åºå­è¡¨
    preStockDao.insert(itemId, userId);
    return true;
}
</code></pre>
<p>è¯¥æ¹æ¡çæ¶æå¾å¦ä¸ï¼</p>
<p><img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/6721e67f-c8c1-4e2d-8f63-aed3c300da3d.png" class="lazyload"></p>
<p><strong>æ§è½æ°æ®</strong>ï¼</p>
<ul>
<li>ç¾ä¸çº§å¹¶åæ¯æè½å</li>
<li>åºå­åç¡®ç99.999%</li>
<li>è®¢åå¤çèæ¶200mså</li>
</ul>
<h2 id="3-é¿åæå">3 é¿åæå</h2>
<h3 id="31-ç¼å­ä¸æ°æ®åºä¸ä¸è´">3.1 ç¼å­ä¸æ°æ®åºä¸ä¸è´</h3>
<p>ææ¬¡å¤§ä¿å ç¼å­æªåæ¶å¤±æï¼å¯¼è´è¶å1.2ä¸åã</p>
<p>éè¯¯ç¤ºä¾å¦ä¸ï¼</p>
<pre><code class="language-java">// éè¯¯ç¤ºä¾ï¼åå ç¼å­åååº
redisTemplate.delete("stock:"+productId);
productDao.updateStock(productId, newStock); // å­å¨å¹¶ååå¥çªå£
</code></pre>
<h3 id="32-æªèèåºå­åæ»">3.2 æªèèåºå­åæ»</h3>
<p>ç§æåæ¶åï¼å¿è®°æ¢å¤åºå­ï¼å¼ååç»­è¶åã</p>
<p>æ­£ç¡®åæ³æ¯ä½¿ç¨äºå¡è¡¥å¿ã</p>
<p>ä¾å¦ä¸é¢è¿æ ·çï¼</p>
<pre><code class="language-java">@Transactional
public void cancelOrder(Order order) {
    stockDao.restock(order.getItemId(), order.getCount());
    orderDao.delete(order.getId());
}
</code></pre>
<p>åºå­åæ»åè®¢åå é¤ï¼å¨åä¸ä¸ªäºå¡ä¸­ã</p>
<h3 id="33-éç²åº¦è¿å¤§">3.3 éç²åº¦è¿å¤§</h3>
<p>éç²åº¦è¿å¤§ï¼å¨å±éæµå¯¼è´10%çè¯·æ±è¢«è¯¯æã</p>
<p>éè¯¯ç¤ºä¾å¦ä¸ï¼</p>
<pre><code class="language-java">// éè¯¯ç¤ºä¾ï¼å¨å±éé
RLock globalLock = redisson.getLock("global_stock_lock");
</code></pre>
<h2 id="æ»ç»">æ»ç»</h2>
<p>å¶å®å¨å¾å¤å¤§åä¸­ï¼ä¸è¬ä¼å°é²æ­¢ååè¶åçå¤ç§æ¹æ¡ç»åä½¿ç¨ã</p>
<p>æ¶æå¾å¦ä¸ï¼<br>
<img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/5c2b9b56-a62e-472b-87ec-99190f26f47d.png" class="lazyload"></p>
<p>éè¿ç»åä½¿ç¨ï¼</p>
<ol>
<li>Redisåç¬¬ä¸éé²çº¿ï¼æ¿å80%æµéï¼</li>
<li>åå¸å¼éæ§å¶æ ¸å¿ä¸å¡é»è¾</li>
<li>é¢æ£åºå­+æ¶æ¯éåä¿è¯æç»ä¸è´æ§</li>
</ol>
<p><strong>å®æç»éª</strong>ï¼æçµåå¨2023å¹´å11ä¸­ï¼</p>
<ul>
<li>Rediséç¾¤æ¿è½½98%è¯·æ±</li>
<li>åå¸å¼éæ¦æªå¼å¸¸æµé</li>
<li>é¢æ£åºå­ä¿è¯æç»åç¡®æ§</li>
</ul>
<p>ç³»ç»å¹³ç¨³æ¯æäºæ¯ç§12ä¸æ¬¡ç§æè¯·æ±ï¼0è¶åäºæåçï¼</p>
<p><strong>è®°ä½ï¼æ²¡æé¶å¼¹æ¹æ¡ï¼åªæéååºæ¯çç»åæ³ï¼</strong></p>
<h2 id="æåè¯´ä¸å¥æ±å³æ³¨å«ç½å«æ">æåè¯´ä¸å¥(æ±å³æ³¨ï¼å«ç½å«æ)</h2>
<p>å¦æè¿ç¯æç« å¯¹æ¨ææå¸®å©ï¼æèææå¯åçè¯ï¼å¸®å¿å³æ³¨ä¸ä¸æçååå¬ä¼å·ï¼èä¸è¯´ææ¯ï¼æ¨çæ¯ææ¯æåæåä½æå¤§çå¨åã</p>
<p>æ±ä¸é®ä¸è¿ï¼ç¹èµãè½¬åãå¨çã</p>
<p>å³æ³¨å¬ä¼å·ï¼ãèä¸è¯´ææ¯ãï¼å¨å¬ä¼å·ä¸­åå¤ï¼è¿å¤§åï¼å¯ä»¥åè´¹è·åææè¿æ´çç10ä¸å­çé¢è¯å®å¸ï¼å¥½å¤å°ä¼ä¼´é è¿ä¸ªå®å¸æ¿å°äºå¤å®¶å¤§åçofferã</p>
<p>æ´å¤é¡¹ç®å®æå¨æçææ¯ç½ç«ï¼<a href="http://www.susan.net.cn/project" target="_blank" rel="noopener nofollow">http://www.susan.net.cn/project</a></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-26 19:22">2025-12-26 19:21</span>&nbsp;
<a href="https://www.cnblogs.com/12lisu">èä¸è¯´ææ¯</a>&nbsp;
éè¯»(<span id="post_view_count">44</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19406444);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19406444', targetLink: 'https://www.cnblogs.com/12lisu/p/19406444', title: 'é«å¹¶åä¸å¦ä½é²æ­¢ååè¶åï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ éæ¡æ¶éå°å¤´ç§ï¼å«è®©âææ¯èµåâæ¯äºä½ çé¡¹ç® ]]></title>
    <link>https://www.cnblogs.com/huizhudev/p/19406245</link>
    <guid>1f1bdb5b7fc51bb31c4aed0d98f21720</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/huizhudev/p/19406245" title="åå¸äº 2025-12-26 18:09">
    <span role="heading" aria-level="2">éæ¡æ¶éå°å¤´ç§ï¼å«è®©âææ¯èµåâæ¯äºä½ çé¡¹ç®</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3695776/202512/3695776-20251226180832229-1607943278.png" alt="éæ¡æ¶éå°å¤´ç§ï¼å«è®©âææ¯èµåâæ¯äºä½ çé¡¹ç®" class="desc_img">
        é¢å¯¹å¤æçææ¯æ éæ©ï¼åçº¯é ç»éªå®¹æé·å¥è¯¯åºãæ¬ææä¾äºä¸å¥âææ¯éååæ AI æä»¤âï¼å° AI åèº«ä¸º 15 å¹´ç»éªçæ¶æå¸ï¼éè¿å¤ç»´åº¦å æè¯ååé£é©è¯ä¼°ï¼å¸®å©ææ¯å³ç­èååºå®¢è§ãæ°æ®é©±å¨çæ¶æå³ç­ï¼é¿åä¸ºéè¯¯çéåä¹°åã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æå¼ CNCF çäºåçå¨æ¯å¾ï¼æ¯ä¸æ¯æè§åå¨çä¸å¼ åªæå¤©ææè¿éæè½è§£æçæå¾ï¼<br>
ç«å¨ 2024 å¹´çå°¾å·´ä¸ï¼ä½ä¸ºææ¯å³ç­èï¼æä»¬é¢ä¸´çæææ©å·²ä¸æ¯âæä¹å®ç°åè½âï¼èæ¯<strong>âç¨ä»ä¹å®ç°åè½â</strong>ã</p>
<p>æ¯åå® Java çç¨³éï¼è¿æ¯æ¥æ± Go çé«æï¼<br>
æ¯ç»§ç»­å¨ React ççæéæ·±èï¼è¿æ¯å» Vue 3 çèéåºèººå¹³ï¼äº¦ææ¯å°å° Svelte çé²ï¼<br>
æ°æ®åºæ¯ç¨èçç MySQLï¼è¿æ¯æ¶é«¦ç TiDBï¼æèå¹²èä¸äºåçæ°æ®åºï¼</p>
<p>æ¯ä¸ä¸ªéæ©èåï¼é½æ½èçå·¨å¤§ç<strong>âæºä¼ææ¬â</strong>ã<br>
éå¯¹äºï¼é£çæ°´èµ·ï¼æ©å±å¦ä¸è¬é¡ºæ»ï¼<br>
ééäºï¼å°±æ¯ç»èªå·±åå¢éæäºä¸ä¸ªæ·±ä¸è§åºçåï¼æªæ¥çæ æ°ä¸ªéå®µé½å¨ä¸ºä»å¤©çèçä¹°åã</p>
<p>æä»¬å¾å¾ä¹ æ¯äºï¼</p>
<ul>
<li><strong>å­ç»éª</strong>ï¼âä»¥åç¨è¿è¿ä¸ªï¼ç¨³ãâï¼ä½å¯è½å·²è¿æ¶ï¼</li>
<li><strong>è·é£å£</strong>ï¼âå¤§åé½å¨ç¨ï¼è¯å®æ²¡éãâï¼ä½ä½ çä¸å¡è§æ¨¡å¹éåï¼ï¼</li>
<li><strong>æèè¢</strong>ï¼âæè§å¾è¿ä¸ª Logo æºå¥½çãâï¼çº¯ç²¹çèµå¾å¿æï¼</li>
</ul>
<p><strong>å¨è¿ä¸ªææ¯çç¸çæ¶ä»£ï¼åçº¯ä¾é ä¸ªäººçç»éªåå¾æ¥åå³ç­ï¼å·²ç»è¶æ¥è¶å±é©äºã</strong><br>
ä½ éè¦ä¸ä¸ªç»å¯¹å®¢è§ãè§éæ éãä¸ç²¾éæè¡¡ä¹éçâå¤èâã</p>
<p><img alt="éæ¡æ¶éå°å¤´ç§ï¼å«è®©âææ¯èµåâæ¯äºä½ çé¡¹ç®" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3695776/202512/3695776-20251226180849340-685169058.png" class="lazyload"></p>
<h2 id="-æ-ai-åæä½ çé¦å¸­æ¶æå¸">ð§­ æ AI åæä½ çâé¦å¸­æ¶æå¸â</h2>
<p>äººç±»æ¶æå¸æåè§ï¼æç¥è¯ç²åºï¼æææå¾åãä½ AI æ²¡æã<br>
åªè¦ä½ ç»å®è®¾å®å¥½æ­£ç¡®ç<strong>âäººè®¾â</strong>å<strong>âè¯ä¼°æ¡æ¶â</strong>ï¼å®å°±è½åèº«ä¸ºä¸ä½æ¥æ 15 å¹´ç»éªçèµæ·±ææ¯é¡¾é®ï¼ä¸ºä½ æä¾ä¸å¸¦ææè²å½©ãåªææ°æ®åé»è¾çå³ç­æ¯æã</p>
<p>ä¸ºæ­¤ï¼ææç£¨äºä¸å¥<strong>ãææ¯éååæ AI æä»¤ã</strong>ã<br>
å®ä¸æ¯è®©ä½ é® AI âåªä¸ªæ¡æ¶å¥½âï¼èæ¯è¦æ± AI è¿è¡ä¸åº<strong>ç³»ç»åçå¯è¡æ§ç ç©¶</strong>ãå®å¼ºå¶ AI ä»<strong>ä¸å¡åºæ¯ãå¢éè½åãé¿æ TCOï¼æ»æ¥æææ¬ï¼ãé£é©è¯ä¼°</strong>ç­å¤ä¸ªç»´åº¦ï¼è¾åºä¸ä»½è½å¤ç´æ¥æ¿å° CTO åå¬ä¼ä¸æ±æ¥çåææ¥åã</p>
<h3 id="-å¤å¶è¿ä¸ªæä»¤è®©å³ç­ææ®å¯ä¾">ð å¤å¶è¿ä¸ªæä»¤ï¼è®©å³ç­ææ®å¯ä¾</h3>
<p>è¿å¥æä»¤çæ ¸å¿å¨äº<strong>âå¤ç»´åº¦å æè¯åâ</strong>ãå®å¼ºè¿« AI éåæ¯ä¸ä¸ªææ ï¼èä¸æ¯ç»åºæ¨¡æ£±ä¸¤å¯çå»ºè®®ã</p>
<pre><code class="language-markdown"># è§è²å®ä¹
ä½ æ¯ä¸ä½èµæ·±çææ¯æ¶æé¡¾é®ï¼æ¥æ15å¹´ä»¥ä¸çç³»ç»æ¶æè®¾è®¡åææ¯éåç»éªãä½ çæä¸»æµçææ¯æ ãæ¡æ¶åäºæå¡ï¼æé¿ä»ä¸å¡éæ±ãææ¯å¯è¡æ§ãææ¬æçãå¢éè½åç­å¤ç»´åº¦è¿è¡ç»¼ååæãä½ çå³ç­é£æ ¼æ¯æ°æ®é©±å¨ãè¯æ®ä¼åï¼å§ç»ä¿æå®¢è§ä¸­ç«ï¼ä¸åè¢ä»»ä½ç¹å®ææ¯éµè¥ã

# æ ¸å¿è½å
- **å¤ç»´åº¦è¯ä¼°**: è½ä»æ§è½ãå®å¨ãææ¬ãå¯ç»´æ¤æ§ãçææçåº¦ç­ç»´åº¦å¨é¢è¯ä¼°
- **é£é©è¯å«**: åäºè¯å«ææ¯åºå¡ãä¾åºåéå®ãææ¯è¿æ¶ç­æ½å¨é£é©
- **è½å°æå¯¼**: è½æä¾ä»éåå°å®æ½çå®æ´è·¯å¾æå¯¼
- **è¯æ®æ¯æ**: ææç»è®ºé½ææ°æ®ãæ¡ä¾ææå¨æ¥æºæ¯æ

# ä»»å¡æè¿°
è¯·åºäºä»¥ä¸ä¿¡æ¯ï¼è¿è¡å¨é¢ç³»ç»çææ¯éååæï¼å¸®å©æååºæä¼çææ¯å³ç­ã

**ææ¯éåéæ±**:
- **éåä¸»é¢**: [éè¦éåçææ¯é¢åï¼å¦ï¼åç«¯æ¡æ¶/æ°æ®åº/æ¶æ¯éå/å®¹å¨ç¼æç­]
- **ä¸å¡åºæ¯**: [å·ä½çä¸å¡éæ±åä½¿ç¨åºæ¯]
- **åéææ¯**: [å·²åæ­¥ç­éçåéææ¯åè¡¨ï¼å¯é]
- **å³é®çº¦æ**: [å¢éææ¯æ /é¢ç®/æ¶é´/åè§ç­çº¦ææ¡ä»¶]

**è¡¥åä¿¡æ¯**ï¼å¯éï¼:
- **å¢éæåµ**: [å¢éè§æ¨¡ãææ¯èæ¯ãç°ææè½å¨å¤]
- **ç°ææ¶æ**: [å½åç³»ç»æ¶æãææ¯åºå¡æåµ]
- **éåè½éæ±**: [æ§è½ææ ãå¯ç¨æ§è¦æ±ãå®å¨åè§è¦æ±]
- **å³ç­æé**: [æçéçå ç´ ï¼å¦ææ¬ä¼å/æ§è½ä¼å/ç¨³å®æ§ä¼å]

# è¾åºè¦æ±

## 1. åå®¹ç»æ

### ð ç¬¬ä¸é¨åï¼éåèæ¯åæ
- éæ±åºæ¯æ·±åº¦è§£è¯»
- æ ¸å¿é®é¢è¯å«
- éåç®æ æç¡®å
- çº¦ææ¡ä»¶æ¢³ç

### ð ç¬¬äºé¨åï¼åéææ¯è¯ä¼°
- åéææ¯è¯å«ä¸ç­éï¼è¥æªæä¾ï¼
- ææ¯è½åç©éµå¯¹æ¯è¡¨
- åææ¯æ¹æ¡ä¼å£å¿æ·±åº¦åæ
- ææ¯æçåº¦ä¸çæè¯ä¼°

### ð ç¬¬ä¸é¨åï¼å¤ç»´åº¦å¯¹æ¯åæ
æä¾ä»¥ä¸ç»´åº¦çå¯¹æ¯è¯åï¼1-5åå¶ï¼ï¼
| è¯ä¼°ç»´åº¦ | ææ¯A | ææ¯B | ææ¯C | æé |
|---------|-------|-------|-------|------|
| æ§è½è¡¨ç° | - | - | - | - |
| å­¦ä¹ ææ¬ | - | - | - | - |
| ç¤¾åºçæ | - | - | - | - |
| è¿ç»´ææ¬ | - | - | - | - |
| æ©å±æ§ | - | - | - | - |
| å®å¨æ§ | - | - | - | - |
| ä¾åºåéå®é£é© | - | - | - | - |
| **å ææ»å** | - | - | - | - |

### â ï¸ ç¬¬åé¨åï¼é£é©è¯ä¼°
- ææ¯é£é©è¯å«
- å®æ½é£é©è¯ä¼°
- é¿æç»´æ¤é£é©
- é£é©ç¼è§£ç­ç¥

### ð¯ ç¬¬äºé¨åï¼éåå»ºè®®
- æç»æ¨èæ¹æ¡åçç±
- å¤éæ¹æ¡è¯´æ
- å³é®å³ç­å ç´ åæ
- ä¸å»ºè®®æ¹æ¡ååå 

### ð ï¸ ç¬¬å­é¨åï¼å®æ½è·¯å¾
- æ¦å¿µéªè¯ï¼POCï¼å»ºè®®
- åé¶æ®µå®æ½è®¡å
- å³é®éç¨ç¢å®ä¹
- åæ»é¢æ¡è®¾è®¡

## 2. è´¨éæ å
- **å®¢è§æ§**: ä¸å¸¦ä¸»è§åè§ï¼åºäºäºå®åæ°æ®åæ
- **å®æ´æ§**: è¦çææå³é®å³ç­ç»´åº¦ï¼æ éå¤§éæ¼
- **å¯æ§è¡æ§**: å»ºè®®å·ä½å¯è½å°ï¼ææç¡®çä¸ä¸æ­¥è¡å¨
- **è¯æ®æ§**: éè¦ç»è®ºææ°æ®ãæ¡ä¾ææå¨æ¥æºæ¯æ
- **é£é©æè¯**: ååè¯å«å¹¶è¯ä¼°æ½å¨é£é©

## 3. æ ¼å¼è¦æ±
- ä½¿ç¨è¡¨æ ¼åç°å¯¹æ¯æ°æ®
- ä½¿ç¨åè¡¨åç°ä¼ç¼ºç¹
- å³é®ç»è®ºä½¿ç¨**å ç²**æ æ³¨
- é£é©é¡¹ä½¿ç¨â ï¸æ è¯
- æ¨èé¡¹ä½¿ç¨âæ è¯
- ä¸æ¨èé¡¹ä½¿ç¨âæ è¯
- æ»å­æ°ï¼3000-5000å­

## 4. é£æ ¼çº¦æ
- **è¯­è¨é£æ ¼**: ä¸ä¸ä¸¥è°¨ï¼ä½é¿åè¿åº¦ä½¿ç¨æ¦æ¶©æ¯è¯­
- **è¡¨è¾¾æ¹å¼**: å®¢è§ç¬¬ä¸äººç§°ï¼æ°æ®ä¼å
- **ä¸ä¸ç¨åº¦**: é¢åèµæ·±ææ¯äººåï¼å¯ä½¿ç¨ä¸ä¸æ¦å¿µä½ééå½è§£é
- **å³ç­æåº¦**: ç»åºæç¡®å»ºè®®ï¼ä½ä¿ççµæ´»æ§ï¼å°éå³ç­èæç»å¤æ­

# è´¨éæ£æ¥æ¸å

å¨å®æè¾åºåï¼è¯·èªææ£æ¥ï¼
- [ ] æ¯å¦ååçè§£äºä¸å¡éæ±åçº¦ææ¡ä»¶ï¼
- [ ] æ¯å¦å¨é¢è¯ä¼°äºææåççåéææ¯ï¼
- [ ] å¯¹æ¯ç»´åº¦æ¯å¦è¦çäºå³é®å³ç­å ç´ ï¼
- [ ] è¯ååæéè®¾ç½®æ¯å¦åçæä¾æ®ï¼
- [ ] é£é©è¯å«æ¯å¦ååï¼ç¼è§£ç­ç¥æ¯å¦å¯è¡ï¼
- [ ] æç»å»ºè®®æ¯å¦æç¡®ä¸æååçç±æ¯æï¼
- [ ] å®æ½è·¯å¾æ¯å¦å·ä½å¯æ§è¡ï¼
- [ ] æ¯å¦èèäºé¿æç»´æ¤åæ¼è¿ææ¬ï¼

# æ³¨æäºé¡¹
- é¿åææ¯åè§ï¼ä¸è¦å ä¸ªäººåå¥½èåè¢ç¹å®ææ¯
- éè§å¢éå ç´ ï¼ä¼ç§çææ¯ä¸ä¸å®æ¯æéåçææ¯
- èèé¿æææ¬ï¼ä¸ä»çç­æå®æ½ææ¬ï¼ä¹è¦è¯ä¼°é¿æç»´æ¤ææ¬
- è­¦æ"é¶å¼¹æç»´"ï¼æ²¡æå®ç¾çææ¯æ¹æ¡ï¼åªæéååºæ¯çæ¹æ¡
- ä¿æææ¯ä¸­ç«ï¼å¯¹äºæäºè®®çææ¯ï¼åç°å¤æ¹è§ç¹
- æ°æ®æ¯æï¼å°½éä½¿ç¨benchmarkæ°æ®ãæ¡ä¾ç ç©¶èéä¸»è§å¤æ­

# è¾åºæ ¼å¼
è¯·æç§ä¸è¿°ç»æï¼è¾åºä¸ä»½å®æ´çææ¯éååææ¥åï¼åå«æ¸æ°çç« èæ é¢ãç»æåçå¯¹æ¯è¡¨æ ¼ãæç¡®çå»ºè®®ç»è®ºåå¯æ§è¡çå®æ½è·¯å¾ã
</code></pre>
<h2 id="ï¸-æç»æèè¢ç¨æ°æ®è¯´è¯">âï¸ æç»âæèè¢âï¼ç¨æ°æ®è¯´è¯</h2>
<p>è¿å¥æä»¤æå¼ºå¤§çå°æ¹ï¼å¨äºå®è½å¸®ä½ <strong>âçè§â</strong>é£äºå®¹æè¢«å¿½è§çéæ§ææ¬ã</p>
<p>ä»¥åæä»¬åå³å®ï¼</p>
<blockquote>
<p>âé MongoDB å§ï¼å¼åå¿«ï¼å¤§å®¶é½å¨ç¨ãâ</p>
</blockquote>
<p>ç°å¨ AI å¸®ä½ åå³å®ï¼</p>
<blockquote>
<p>âè½ç¶ MongoDB å¼ååææçé«ï¼5åï¼ï¼ä½éå¯¹ä½ æè¿°çå¼ºäºå¡éèåºæ¯ï¼æé 40%ï¼ï¼å¶ ACID ä¿è¯åæ°æ®ä¸è´æ§ç»´æ¤ææ¬ï¼2åï¼å°æä¸ºåæç¶é¢ãç¸æ¯ä¹ä¸ï¼è½ç¶ PostgreSQL å­¦ä¹ æ²çº¿ç¨é¡ï¼3åï¼ï¼ä½å¨æ°æ®å®æ´æ§åå¤ææ¥è¯¢æ§è½ï¼5åï¼ä¸æ´å¹éä½ çä¸å¡éæ±ã<strong>ç»¼åå æè¯åï¼PG (4.2) &gt; Mongo (3.5)ã</strong>â</p>
</blockquote>
<p>è¿ä¸åªæ¯ä¸æ¬¡ææ¯æ¨èï¼æ´æ¯ä¸æ¬¡<strong>æç»´é£æ´</strong>ã<br>
å®ä¼é¼é®ä½ ï¼</p>
<ul>
<li>ä½ çå¢éçç hold å¾ä½ Kubernetes çè¿ç»´å¤æåº¦åï¼</li>
<li>ä½ ç°å¨çé¢ç®è½æ¯æè¿ä¸ªåä¸æ°æ®åºä¸å¹´ç License è´¹ç¨åï¼</li>
<li>å¦æè¿ä¸ªå¼æºé¡¹ç®æå¹´åæ´äºï¼ä½ æ Plan B åï¼</li>
</ul>
<h2 id="ï¸-æä¹ç¨å¥½è¿æçå£«åå">ð ï¸ æä¹ç¨å¥½è¿æâçå£«ååâï¼</h2>
<p><strong>1. æç¡®çº¦æï¼è¶ç»è¶å¥½</strong><br>
ä¸è¦åªè¯´âæè¦éä¸ªæ°æ®åºâãè¦è¯´ï¼âæè¦éä¸ªæ¶åºæ°æ®åºï¼å¤ç IoT è®¾å¤æ°æ®ï¼æ¯ç§åå¥ 10ä¸ç¹ï¼æ¥è¯¢ä¸»è¦æ¯æè¿ 24 å°æ¶æ°æ®ï¼è¿ç»´å¢éåªæ 2 äººï¼é¢ç®æ¯æ 5000 åãâ<br>
<strong>çº¦æè¶å·ä½ï¼AI çæ¨èå°±è¶ç²¾åã</strong></p>
<p><strong>2. è°æ´æéï¼éä½è£è¡£</strong><br>
å¦ææ¯åä¸å¬å¸ç MVP é¶æ®µï¼æâå¼åæçâåâå­¦ä¹ ææ¬âçæéè°é«ï¼<br>
å¦ææ¯é¶è¡çæ ¸å¿äº¤æç³»ç»ï¼æâå®å¨æ§âåâç¨³å®æ§âçæéææ»¡ã<br>
<strong>æ²¡ææå¥½çææ¯ï¼åªææéåå½ä¸çææ¯ã</strong></p>
<p><strong>3. æå®å½åâèåâ</strong><br>
å³ä½¿ä½ å¿éå·²ç»æäºç­æ¡ï¼ä¹ä¸å¦¨ç¨è¿ä¸ªæä»¤è·ä¸éãè®© AI ç«å¨å®¢è§çè§åº¦ï¼å»ææä½ çé¢è®¾ï¼ççè½ä¸è½æ¾åºä½ å¿½ç¥çé£é©ç¹ã<br>
<strong>è½å¤ç»å¾èµ· AI æ·±åº¦æ·é®çæ¶æï¼ææ¯çæ­£å¥å£®çæ¶æã</strong></p>
<p>ææ¯éåæ¯ä¸åºæ²¡ææ åç­æ¡çèè¯ï¼ä½è³å°ï¼æä»¬å¯ä»¥ä¸äº¤ç½å·ï¼ä¹ä¸ä¹±èç­æ¡ã<br>
å¸¦ä¸è¿ä¸ª AI é¡¾é®ï¼è®©ä½ çæ¯ä¸æ¬¡ <code>git init</code> é½ææ®å¯ä¾ï¼åºæ°åè¶³ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-26 18:09">2025-12-26 18:09</span>&nbsp;
<a href="https://www.cnblogs.com/huizhudev">realhuizhu</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19406245);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19406245', targetLink: 'https://www.cnblogs.com/huizhudev/p/19406245', title: 'éæ¡æ¶éå°å¤´ç§ï¼å«è®©âææ¯èµåâæ¯äºä½ çé¡¹ç®' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ APEXå®æç¬¬8ç¯ï¼ORDSè¿åºæ¥é574ï¼ä¸ææ ¹æ²»ç¨æ·è¿æé®é¢ ]]></title>
    <link>https://www.cnblogs.com/jyzhao/p/19404888/apex-shi-zhan-di8pianords-lian-ku-bao-cuo574-yi-zh</link>
    <guid>7a8e7ba206d40d4ba4c25a052c62095d</guid>
    <description>
    <![CDATA[ 
    <a name="top"></a>
    <h2><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/jyzhao/p/19404888/apex-shi-zhan-di8pianords-lian-ku-bao-cuo574-yi-zh" title="åå¸äº 2025-12-26 15:08">
    <span role="heading" aria-level="2">APEXå®æç¬¬8ç¯ï¼ORDSè¿åºæ¥é574ï¼ä¸ææ ¹æ²»ç¨æ·è¿æé®é¢</span>
    

</a>
</h2>
    <small>
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-26 15:08">2025-12-26 15:08</span>&nbsp;
<a href="https://www.cnblogs.com/jyzhao">AlfredZhao</a>&nbsp;
éè¯»(<span id="post_view_count">27</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19404888);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19404888', targetLink: 'https://www.cnblogs.com/jyzhao/p/19404888/apex-shi-zhan-di8pianords-lian-ku-bao-cuo574-yi-zh', title: 'APEXå®æç¬¬8ç¯ï¼ORDSè¿åºæ¥é574ï¼ä¸ææ ¹æ²»ç¨æ·è¿æé®é¢' })">ä¸¾æ¥</a>
</small>
    <div class="entry">
        <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>ä½ä¸º APEX åºç¨å¼åå·¥ç¨å¸ï¼ç¬èåç°å¾å¤åè¡å¨ä½¿ç¨ APEX + ORDS æ¶ææ¶ï¼é½ä¼éå°æ°æ®åºå­è¯éè¯¯ç¸å³çé®é¢ãä¹åå¤§å®¶æ®éç¥é APEX_PUBLIC_USER éè¦è®¾ç½®å¯ç æ°¸ä¸è¿æï¼ä½å¾å¾ä¼å¿½ç¥å¦ä¸ä¸ªå³é®ç¨æ·ââORDS_PUBLIC_USERï¼è¿ä¹æ¯å¯¼è´ Database Credential Error å HTTP Status Code: 574 é®é¢åå¤åºç°çæ ¸å¿åå ã</p>
<p>ä»å¤©ç¬èå°±ç»åèªå·±çè¸©åç»åï¼æ ORDS_PUBLIC_USER ç¸å³çé®é¢è§£å³æµç¨å®æ´åäº«åºæ¥ï¼å¸®å¤§å®¶å¿«éè§£å³é®é¢ï¼é¿åéå¤è¸©åã</p>
<h2 id="01--åæç¡®é®é¢ords-è¿ä¸ä¸æ°æ®åºæ¥éå°åºå¥ææ">01 | åæç¡®é®é¢ï¼ORDS è¿ä¸ä¸æ°æ®åºï¼æ¥éå°åºå¥ææï¼</h2>
<p>å½ä½ å¯å¨ ORDS åï¼è®¿é® APEX åºç¨æ ORDS æ¥å£æ¶ï¼å¯è½ä¼éå°è¿æ ·çéè¯¯æç¤ºï¼</p>
<blockquote>
<p>ORDS was unable to make a connection to the database. The database user specified by db.username configuration setting is expired. The connection pool named: |default|lo| had the following error(s): UCP-29: Failed to get a connection</p>
</blockquote>
<p><img src="https://img2024.cnblogs.com/blog/635610/202512/635610-20251226145736856-1853445170.jpg" alt="ords1" loading="lazy"></p>
<p>ç®åè¯´ï¼å°±æ¯ ORDS éç½®çæ°æ®åºç¨æ·è¿æäºï¼å¯¼è´è¿æ¥æ± æ¿ä¸å°è¿æ¥ãè¿éçå³é®ç¨æ·ï¼å°±æ¯æä»¬ä»å¤©çä¸»è§ââORDS_PUBLIC_USERã</p>
<p>å¾å¤åå­¦ä¹ååªå³æ³¨äº APEX_PUBLIC_USERï¼å´ä¸ç¥é ORDS æ­£å¸¸è¿è¡ä¹ä¾èµä¸å±ç ORDS_PUBLIC_USERï¼è¿ä¸ªç¨æ·é»è®¤ä½¿ç¨æ°æ®åºç DEFAULT å¯ç ç­ç¥ï¼ä¸æ¦å¯ç è¿æï¼å°±ä¼è§¦åä¸è¿°éè¯¯ã</p>
<h2 id="02--è§£å³æ­¥éª¤ä»å®ä½é®é¢å°å½»åºè§£å³ä¸æ­¥é½ä¸è½å°">02 | è§£å³æ­¥éª¤ï¼ä»å®ä½é®é¢å°å½»åºè§£å³ï¼ä¸æ­¥é½ä¸è½å°</h2>
<p>ä¸é¢ç¬èå°±æå®æ´çè§£å³æµç¨æè§£å¼ï¼æ¯ä¸ªæ­¥éª¤é½è®²æ¸æ¥æä½æ¹æ³åæ³¨æäºé¡¹ï¼å°ç½ä¹è½è·çåã</p>
<h3 id="-ç¬¬ä¸æ­¥å®ä½é®é¢ç¨æ·ç¡®è®¤æ¯-ords_public_user-è¿æ">â  ç¬¬ä¸æ­¥ï¼å®ä½é®é¢ç¨æ·ï¼ç¡®è®¤æ¯ ORDS_PUBLIC_USER è¿æ</h3>
<p>é¦åæä»¬éè¦éè¿ ORDS å½ä»¤ï¼ç¡®è®¤éç½®çæ°æ®åºç¨æ·å°åºæ¯è°ï¼é¿åæä½éç¨æ·ã</p>
<p>å¨å½ä»¤è¡æ§è¡ä»¥ä¸å½ä»¤ï¼</p>
<pre><code class="language-bash">ords config list
</code></pre>
<p>è¿ä¸ªå½ä»¤ä¼ååº ORDS çææéç½®ä¿¡æ¯ï¼æ¾å°<code>db.username</code> å¯¹åºç value å¼ï¼ä¸åºæå¤çè¯ï¼ä¼æ¾ç¤º<code>ORDS_PUBLIC_USER</code>ï¼è¿å°±ç¡®è®¤äºæ¯è¿ä¸ªç¨æ·è¿æå¯¼è´çé®é¢ã</p>
<h3 id="-ç¬¬äºæ­¥ç»-ords_public_user-éç½®æ°¸ä¸è¿æç­ç¥">â¡ ç¬¬äºæ­¥ï¼ç» ORDS_PUBLIC_USER éç½®æ°¸ä¸è¿æç­ç¥</h3>
<p>æ¢ç¶æ¯å¯ç è¿æé®é¢ï¼æ ¸å¿å°±æ¯ç» ORDS_PUBLIC_USER è®¾ç½®å¯ç æ°¸ä¸è¿æçç­ç¥ãè¿éç¬èåè®¾ä½ å·²ç»åå»ºå¥½äºåä¸º <code>PASSWORD_UNLIMITED</code> çæ°¸ä¸è¿æéç½®æä»¶ï¼å¦ææ²¡æï¼å¯åæ§è¡ <code>CREATE PROFILE PASSWORD_UNLIMITED LIMIT PASSWORD_LIFE_TIME UNLIMITED PASSWORD_GRACE_TIME UNLIMITED;</code> åå»ºï¼ã</p>
<p>ä»¥ SYSDBA èº«ä»½ç»å½æ°æ®åºï¼æ§è¡ä»¥ä¸ SQL å½ä»¤ï¼</p>
<pre><code class="language-sql">alter user ORDS_PUBLIC_USER profile PASSWORD_UNLIMITED;
</code></pre>
<p>è¿ä¸æ­¥çä½ç¨æ¯æ ORDS_PUBLIC_USER å³èå°æ°¸ä¸è¿æçéç½®æä»¶ï¼ä»æ ¹æºä¸é¿ååç»­åæ¬¡è¿æã</p>
<h3 id="-ç¬¬ä¸æ­¥éå¯-ords-æµè¯åç°æ°é®é¢">â¢ ç¬¬ä¸æ­¥ï¼éå¯ ORDS æµè¯ï¼åç°æ°é®é¢</h3>
<p>éç½®å®æ°¸ä¸è¿æç­ç¥åï¼æä»¬éå¯ ORDS ççææï¼æ§è¡å½ä»¤ï¼</p>
<pre><code class="language-bash"># 1. æ¥æ¾ ORDS è¿ç¨å¹¶ç»æ­¢
ps -ef | grep ords
# æ¾å°è¿ç¨å·ï¼ç¬¬äºåæ°å­ï¼ï¼æ§è¡ kill å½ä»¤ç»æ­¢è¿ç¨
kill -9 è¿ç¨å·

# 2. åå°å¯å¨ ORDS å¹¶å°æ¥å¿è¾åºå° ords.log æä»¶
nohup ords serve &gt; ords.log &amp;
</code></pre>
<p>æ­¤æ¶å¤§æ¦çä¼åç°ï¼éè¯¯åäºï¼æ°éè¯¯æç¤ºä¸ºï¼</p>
<blockquote>
<p>ORA-28001: The account has expired.</p>
</blockquote>
<p>è¿æ¯å ä¸ºæä»¬è½ç¶ä¿®æ¹äºå¯ç ç­ç¥ï¼ä½å·²ç»è¿æçè´¦å·ç¶æä¸ä¼èªå¨æ¢å¤ãè¿æ¶åæåå­¦ä¼å°è¯ç¨ <code>ALTER USER ORDS_PUBLIC_USER ACCOUNT UNLOCK;</code>å½ä»¤è§£éï¼ä½ç¬èäº²æµï¼è¿ä¸ªå½ä»¤å¯¹å·²ç»è¿æçè´¦å·ç¶ææ æï¼æ æ³å°å¶ä» expired æ¹ä¸º openã</p>
<h3 id="-ç¬¬åæ­¥éç½®-ords_public_user-å¯ç æ¢å¤è´¦å·ç¶æ">â£ ç¬¬åæ­¥ï¼éç½® ORDS_PUBLIC_USER å¯ç ï¼æ¢å¤è´¦å·ç¶æ</h3>
<p>è¦å½»åºè§£é¤ expired ç¶æï¼å¿é¡»éç½® ORDS_PUBLIC_USER çå¯ç ãä»¥ SYSDBA èº«ä»½ç»å½æ°æ®åºï¼æ§è¡ä»¥ä¸ SQL å½ä»¤ï¼</p>
<pre><code class="language-sql">ALTER USER ORDS_PUBLIC_USER identified by "newpassword";
</code></pre>
<p>æ³¨æï¼è¿éç <code>newpassword</code> æ¿æ¢æä½ èªå·±çå¯ç ï¼å»ºè®®è®¾ç½®ä¸ä¸ªå¤æåº¦é«ãä¸å®¹æå¿è®°çå¯ç ï¼æ¯å¦ <code>Ords_2025@Pub</code>ï¼åå«å¤§å°åãæ°å­åç¹æ®å­ç¬¦ï¼ã</p>
<p>æ§è¡å®è¿ä¸ªå½ä»¤åï¼ORDS_PUBLIC_USER çè´¦å·ç¶æå°±ä¼æ¢å¤ä¸º openï¼è¿æé®é¢å°±è§£å³äºã</p>
<h3 id="-ç¬¬äºæ­¥å³é®åç¹ç¨æ­£ç¡®å½ä»¤åæ­¥-ords-å¯ç éç½®">â¤ ç¬¬äºæ­¥ï¼å³é®åç¹ï¼ç¨æ­£ç¡®å½ä»¤åæ­¥ ORDS å¯ç éç½®</h3>
<p>éç½®å®æ°æ®åºç¨æ·å¯ç åï¼å¾å¤åå­¦ä¼ç´æ¥éå¯ ORDSï¼ä½æ­¤æ¶ä¼éå°æ°çéè¯¯ï¼</p>
<blockquote>
<p>The connection pool named: |default|lo| had the following error(s): ORA-01017: invalid credential or not authorized; logon denied</p>
</blockquote>
<p>è¿æ¯å ä¸º ORDS éç½®éçå¯ç è¿æ¯æ§çï¼æ²¡æåæ­¥æä»¬åéç½®çæ°å¯ç ãè¿éè¦éç¹æéå¤§å®¶ï¼ä¸å ORDS çæ¬è®¾ç½®å¯ç çå½ä»¤ä¸ä¸æ ·ï¼</p>
<p>ç¬èä½¿ç¨çæ¯ ORDS 25.1 çæ¬ï¼è¿ä¸ªçæ¬åä»¥åçæ°çæ¬ï¼ææéç½®ï¼æ¯å¦å¯ç ï¼å¿é¡»ç¨ <code>secret</code> å­å½ä»¤è®¾ç½®ï¼æ®éç <code>ords config set db.password</code> å½ä»¤ä¼å¤±æã</p>
<p>æ­£ç¡®çæä½æ¯å¨å½ä»¤è¡æ§è¡ï¼</p>
<pre><code class="language-bash">ords config secret db.password
</code></pre>
<p>æ§è¡åä¼æç¤ºä½ è¾å¥å¯ç ï¼ç´æ¥è¾å¥æä»¬åæéç½®ç <code>newpassword</code> å³å¯ï¼äº¤äºå¼è¾å¥æ´å®å¨ï¼é¿åå¯ç æ´é²å¨å½ä»¤è¡åå²è®°å½ä¸­ï¼ã</p>
<p>å¦æä½ ç ORDS çæ¬è¾ä½ï¼æ¯å¦ 21 ä¹åï¼ï¼å¯è½éè¦ç¨ <code>ords config set db.password "newpassword"</code>ï¼ä½å»ºè®®ä¼åç¨ <code>secret</code> å½ä»¤ï¼æ´ç¬¦åå®å¨è§èã</p>
<h3 id="-ç¬¬å­æ­¥æç»æµè¯ç¡®è®¤é®é¢è§£å³">â¥ ç¬¬å­æ­¥ï¼æç»æµè¯ï¼ç¡®è®¤é®é¢è§£å³</h3>
<p>å®æå¯ç åæ­¥åï¼æä»¬åæ¬¡éå¯ ORDSï¼</p>
<pre><code class="language-bash"># 1. æ¥æ¾ ORDS è¿ç¨å¹¶ç»æ­¢
ps -ef | grep ords
kill -9 è¿ç¨å·

# 2. åå°å¯å¨ ORDS
nohup ords serve &gt; ords.log &amp;
</code></pre>
<p>æ­¤æ¶è®¿é® APEX åºç¨æ ORDS æ¥å£ï¼å°±ä¸ä¼ååºç°ä¹åçæ°æ®åºè¿æ¥éè¯¯äºãä¸ºäºç¡®ä¿ä¸æ ä¸å¤±ï¼ä¹å¯ä»¥éè¿ä»¥ä¸æ¹å¼éªè¯ ORDS ç¶æï¼</p>
<pre><code class="language-bash"># æ¹å¼1ï¼æ¥ç ORDS è¿ç¨æ¯å¦å­å¨ï¼ç¡®è®¤å¯å¨æåï¼
ps -ef | grep ords

# æ¹å¼2ï¼æ¥ç ORDS æ¥å¿ï¼ç¡®è®¤æ æ¥é
tail -f ords.log

# æ¹å¼3ï¼æ¥ç ORDS éç½®ä¿¡æ¯ï¼ç¡®è®¤æ ¸å¿éç½®æ­£ç¡®
ords config list
</code></pre>
<p>å¦æéè¿ ps å½ä»¤è½çå° ORDS è¿ç¨ï¼ä¸æ¥å¿ä¸­æ æ°æ®åºè¿æ¥ç¸å³æ¥éï¼å°±è¯´æ ORDS æ­£å¸¸è¿è¡ï¼é®é¢å½»åºè§£å³ã</p>
<h2 id="03--é¿åæåè¿äºå³é®è¦ç¹å¸®ä½ é¿åéå¤è¸©å">03 | é¿åæåï¼è¿äºå³é®è¦ç¹ï¼å¸®ä½ é¿åéå¤è¸©å</h2>
<p>å¨è§£å³é®é¢çè¿ç¨ä¸­ï¼ç¬èè¸©äºå ä¸ªåï¼è¿éæ»ç»åºæ¥ï¼å¸®å¤§å®¶å°èµ°å¼¯è·¯ï¼</p>
<h3 id="-ä¸è¦åªå³æ³¨-apex_public_userå¿½ç¥-ords_public_user">â  ä¸è¦åªå³æ³¨ APEX_PUBLIC_USERï¼å¿½ç¥ ORDS_PUBLIC_USER</h3>
<p>APEX_PUBLIC_USER æ¯ APEX åºç¨çæ ¸å¿ç¨æ·ï¼ORDS_PUBLIC_USER æ¯ ORDS æå¡çæ ¸å¿ç¨æ·ï¼ä¸¤èç¼ºä¸ä¸å¯ãå»ºè®®å¨å®è£éç½®åæï¼å°±åæ¶ç»è¿ä¸¤ä¸ªç¨æ·è®¾ç½®æ°¸ä¸è¿æç­ç¥ï¼ä¸å³æ°¸é¸ã</p>
<h3 id="-è´¦å·è¿æåä»è§£éæ æå¿é¡»éç½®å¯ç ">â¡ è´¦å·è¿æåï¼ä»è§£éæ æï¼å¿é¡»éç½®å¯ç </h3>
<p>å¾å¤åå­¦è¯¯ä»¥ä¸º <code>ALTER USER ... ACCOUNT UNLOCK</code> è½è§£å³è¿æé®é¢ï¼ä½å®éä¸è¿ä¸ªå½ä»¤åªè½è§£å³è´¦å·éå®é®é¢ï¼æ æ³è§£é¤è¿æç¶æãè¿æç¶æå¿é¡»éè¿éç½®å¯ç æè½æ¢å¤ï¼è¿ä¸æ­¥ä¸è½çã</p>
<h3 id="-æ³¨æ-ords-çæ¬å·®å¼å¯ç éç½®å½ä»¤è¦éå¯¹">â¢ æ³¨æ ORDS çæ¬å·®å¼ï¼å¯ç éç½®å½ä»¤è¦éå¯¹</h3>
<p>ORDS 21 çæ¬åä»¥åï¼ææéç½®å¿é¡»ç¨<code>ords config secret</code> å½ä»¤è®¾ç½®ï¼æ®éç <code>set</code> å½ä»¤æ æï¼å¦å¤è¦æ³¨æï¼ORDS æ²¡æ <code>status</code> å½ä»¤ï¼æ æ³ç´æ¥æ¥çè¿è¡ç¶æï¼ééè¿æ¥çè¿ç¨ãæ¥å¿æéç½®ä¿¡æ¯éªè¯ãå¦æè®¾ç½®å¯ç åä»æ¥éï¼åæ£æ¥èªå·±ç ORDS çæ¬åéç½®æ¯å¦æ­£ç¡®ã</p>
<h3 id="-å¯ç è¦ä¿æä¸è´æ°æ®åºç¨æ·å¯ç --ords-éç½®å¯ç ">â£ å¯ç è¦ä¿æä¸è´ï¼æ°æ®åºç¨æ·å¯ç  â¡ ORDS éç½®å¯ç </h3>
<p>éç½® ORDS_PUBLIC_USER çæ°æ®åºå¯ç åï¼ä¸å®è¦åæ­¥æ´æ° ORDS éç½®éçå¯ç ï¼ä¸¤èå¿é¡»å®å¨ä¸è´ï¼åæ¬å¤§å°åãç¹æ®å­ç¬¦ï¼ï¼å¦åä¼æ¥ ORA-01017 è®¤è¯å¤±è´¥éè¯¯ã</p>
<h2 id="04--æ»ç»ä¸å³æ°¸é¸çæ ¸å¿æ¹æ¡">04 | æ»ç»ï¼ä¸å³æ°¸é¸çæ ¸å¿æ¹æ¡</h2>
<p>å¶å®è§£å³è¿ä¸ªé®é¢çæ ¸å¿å¾ç®åï¼ç» ORDS_PUBLIC_USER éç½®æ°¸ä¸è¿æçå¯ç ç­ç¥ï¼åæ¶ç¡®ä¿ ORDS éç½®éçå¯ç ä¸æ°æ®åºç¨æ·å¯ç ä¸è´ã</p>
<p>å®æ´æµç¨å¯ä»¥ç®åä¸ºï¼å®ä½ç¨æ· â éç½®æ°¸ä¸è¿æç­ç¥ â éç½®å¯ç  â åæ­¥ ORDS å¯ç éç½® â éå¯ ORDSã</p>
<p>å»ºè®®å¤§å®¶å¨æ­å»º APEX + ORDS ç¯å¢æ¶ï¼å°±æåå®æè¿ä¸¤ä¸ªç¨æ·ï¼APEX_PUBLIC_USERãORDS_PUBLIC_USERï¼çæ°¸ä¸è¿æéç½®ï¼é¿ååç»­è¿è¡ä¸­çªç¶åºç°é®é¢ï¼å½±åä¸å¡ä½¿ç¨ã</p>
<p>å¦æå¤§å®¶å¨æä½è¿ç¨ä¸­éå°å¶ä»é®é¢ï¼æ¬¢è¿å¨è¯è®ºåºçè¨äº¤æµï¼ç¬èä¼å°½åä¸ºå¤§å®¶è§£ç­ï½</p>

</div>
<div id="MySignature" role="contentinfo">
    <a href="https://www.cnblogs.com/jyzhao/" target="_blank">AlfredZhao</a>Â©çæææãä»Oracleèµ·èªï¼é¢ç¥ç²¾å½©çITææ¯ãã<br>
è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/jyzhao/p/19404888/apex-shi-zhan-di8pianords-lian-ku-bao-cuo574-yi-zh" target="_blank">https://www.cnblogs.com/jyzhao/p/19404888/apex-shi-zhan-di8pianords-lian-ku-bao-cuo574-yi-zh</a>
<hr>
<div style="text-align:center; margin-top:30px;">
  <p style="font-size:14px;color:#555;">
    ð æè°¢éè¯»ï¼æ¬¢è¿å³æ³¨æçå¬ä¼å· <b>ãèµµéå®ã</b>
  </p>
  <img src="https://images.cnblogs.com/cnblogs_com/jyzhao/824234/o_250208075013_qrcode-zjy.jpg" width="160" style="border:1px solid #ddd;border-radius:8px;">
</div>
</div>
<div class="clear"></div>

        <div class="clear"></div>
        
</div>
    <ul class="postmetadata">
        <vc:categories-tags blog-app="jyzhao" blog-id="186567" post-id="19404888"></vc:categories-tags>
    </ul>
 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ååºåè¡¨æ°æ®æºShardingSphereDataSourceçConnectionåæ°æ®è¯¯ç¨é®é¢åæ ]]></title>
    <link>https://www.cnblogs.com/wuyuegb2312/p/19405814</link>
    <guid>214231bee88e3b0505b9258421d74fc0</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/wuyuegb2312/p/19405814" title="åå¸äº 2025-12-26 22:00">
    <span role="heading" aria-level="2">ååºåè¡¨æ°æ®æºShardingSphereDataSourceçConnectionåæ°æ®è¯¯ç¨é®é¢åæ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="èæ¯">èæ¯</h1>
<p>å¯¹äºååºåè¡¨åºç¨æ¥è¯´ï¼ä½¿ç¨org.apache.shardingsphere.driver.jdbc.core.datasource.ShardingSphereDataSourceæ¯ä¸ä¸ªä¸éçè§£å³æ¹æ¡ï¼ä½ å¯ä»¥éè¿éç½®æä»¶ç¼åååºåè¡¨è§åï¼ä»èå¨ç¼ç æ¶éæå°ä½¿ç¨åè¡¨ï¼å½ç¶ï¼è·¯ç±è§åçç¸å³å­æ®µè¿æ¯è¦ä¼ çï¼ä¹åä¹ææç« åæè¿è¿äºå­æ®µçå¤çè¿ç¨ï¼<a href="https://www.cnblogs.com/wuyuegb2312/p/18685884" target="_blank">æ·±å¥çè§£Mybatisååºåè¡¨æ§è¡åç</a>ï¼ã</p>
<p>ä½æ¯ï¼å¨ä¸äºåºæ¯ä¸­æ¯éè¦ç»è¿mybatisç´æ¥åä¸äºæä½çï¼ç¹å«æ¯åæ°æ®åºåæ°æ®ç¸å³çæä½ï¼åæ¬è¡¨çç»æåæ´ï¼ã</p>
<p>æ¯å¦æéå°çåºæ¯ï¼åæ¥è¯¢åä¸ªååºä¸­æåªäºåç¼ä¸º<code>table_</code>çè¡¨ï¼å¹¶ç»è¿äºè¡¨å ä¸å<code>col_x</code>ã</p>
<p>æç»åç°æä»£ç åå¤§è¯­è¨æ¨¡åï¼ååäºä¸çï¼çº¿ä¸è¿è¡è¯å¥½ï¼ä½æ¯çº¿ä¸çæäºååºæ­»æ´»æ¾ä¸å°å¯¹åºçåè¡¨ï¼æ²¡æ³è¿è¡åç»­çå¤çãè¿ä¸ªé®é¢æ¥äºå¾ä¹ï¼æ¨å¤©ç»äºè§£å³äºï¼å æ­¤åäº«åºæ¥ã</p>
<h1 id="å­å¨é®é¢çä»£ç ">å­å¨é®é¢çä»£ç </h1>
<pre><code class="language-Java">@Componet
public class TableAlterHandler {
    @Resource private ShardingSphereDataSource dataSource;
    
    public List&lt;String&gt; findTablesByPrefix(String prefix, String physicalSchemaName) {
        if (StringUtils.isBlank(prefix) || StringUtils.isBlank(physicalSchemaName)) {
            throw new RuntimeException("åè¡¨åç¼æååºåä¸ºç©º");
        }
        List&lt;String&gt; tableNames = Lists.newArrayList();
        try (HintManager hintManager = HintManager.getInstance();
             Connection conn = dataSource.getConnection()) {
             hintManager.setDataSourceName(DBUtil.queryLogicalSchemaName(physicalSchemaName));
            DatabaseMetaData metaData = conn.getMetaData();
            try (ResultSet rs = metaData.getTables(physicalSchemaName, null, prefix + "%", new String[] {"TABLE"})) {
                while (rs.next()) {
                    String tableName = rs.getString("TABLE_NAME");
                    tableNames.add(tableName);
                }
            }
        } catch (SQLException e) {
            throw new RuntimeException("å¤çå¤§ç»æéå¤±è´¥", e);
        }
        return tableNames;
    }
}
</code></pre>
<h2 id="é»è¾åºåç©çåº">é»è¾åºåç©çåº</h2>
<p>å¨åæé®é¢ä¹åï¼é¦åè¦æç¡®ä¸¤ä¸ªæ¦å¿µï¼ç©çåºåphysicalSchemaNameåé»è¾åºålogicalSchemaNameï¼å¦æç¨éäºï¼å¯è½ä¼è®©ä½ æ²¡åæ³åç°åç»­é®é¢çæ¬è´¨åå ãä¸é¢çä»£ç ï¼hintManagerå¿é¡»ç¨é»è¾åºåï¼èmetaData.getTableså¿é¡»ç¨ç©çåºåã</p>
<p>æè°ç©çåºåé»è¾åºï¼å¯ä»¥çä½æ¯æå®ä¹çæ¦å¿µãæ­£å¦å¶åï¼ç©çåºåå°±æ¯ä½ jdbcUrléçåºåï¼æ¯å¦ä¸ä¸ªå¸åçé¿éäºMysqlçJDBCé¾æ¥<code>jdbc:mysql://``rm-bpxxxx.mysql.rds.aliyuncs.com/bizcenter_1?useSSL=false&amp;autoReconnect=true&amp;characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai</code></p>
<p>å¶ä¸­çbizcenter_1å°±æ¯ç©çåºåãè¿ä¸ªåç§°ä¹ä¼å¨MySqlåæ°æ®ä¸­åºç°ï¼æ¯å¦</p>
<pre><code class="language-SQL">select * from information_schema.tables;
</code></pre>
<p>å¯ä»¥çå°è¿ä¸ªåºçææè¡¨ï¼èTABLE_SCHEMAåå°±æ¯ç©çåºåã</p>
<p>èé»è¾åºï¼åæ¯ShardingSphereDataSourceå¯¹ç©çåºçæ å°ï¼å¨applicationçéç½®æä»¶(propertiesæyml)éï¼spring.shardingsphere.datasourceéç½®ä¸ï¼ä½ éè¦éç½®é»è¾åºåä»¥åå¯¹åºçJDBCé¾æ¥ã</p>
<p>ä½ å¯ä»¥å°å¤ä¸ªé»è¾åºéç½®ä¸ºåä¸ä¸ªç©çåºï¼è¿æ¯ä¸ç§å®è·µæ¹å¼ï¼å¯ä»¥ç¨äºåç»­çæ©å®¹ã</p>
<h1 id="é®é¢ç°è±¡">é®é¢ç°è±¡</h1>
<p>çº¿ä¸çä¸ä¸ªé»è¾åºåå«å¯¹åºä¸ä¸ªç©çåºï¼èè¿ä¸ä¸ªç©çåºå¨åä¸ä¸ªé¿éäºRDSå®ä¾ä¸ï¼å¯ä»¥æ¾å°æ¯ä¸ªåºå¯¹åºçè¡¨ã</p>
<p>èçº¿ä¸çä»ç¶æ¯ä¸ä¸ªé»è¾åºå¯¹åºåèªçç©çåºï¼æ¯ä¸ªç©çåºå¨ä¸åçé¿éäºRDSå®ä¾ä¸ï¼ä¼åºç°ææ¶åè½æ¾å°æä¸ªåºå¯¹åºçè¡¨ï¼èå¦å¤ä¸¤ä¸ªåºä¸ä¸ªè¡¨é½æ¾ä¸å°çæåµã</p>
<h1 id="ææ¥">ææ¥</h1>
<p>éå°é®é¢åï¼ç¾æä¸å¾å¶è§£ï¼å ä¸ºçº¿ä¸ç¯å¢ä¸åæ­£å¸¸ï¼çº¿ä¸å´æ»è½å¤ç°é®é¢ãç±äºçº¿ä¸ç¯å¢ç®¡æ§æ¯è¾ä¸¥ï¼æ¢ä¸è½è¿ç¨debugï¼åä¸è½ç´è¿çº¿ä¸åºï¼å¾é¾å®ä½åå ã</p>
<p>ç¬¬ä¸é¶æ®µææ¥ï¼æåå¤ç¡®è®¤äºä¸é¢ä»£ç ä¸­éè¦ä¼ æ°æ®åºåçå°æ¹å°åºæ¯é»è¾åºè¿æ¯ç©çåºãä¸­é´æä¸ªçæ¬çç¡®æéäºï¼ä½æ¯ä¸ºä½å¨åéçåæä¸è¿è½è¿è¡ï¼æ²¡æåè®°å½ã</p>
<p>ç¶åï¼æå æäº<code>connection.setAutoCommit(false)</code>ã<code>resultSet.setFetchSize(batchSize)</code>è¿æ ·çç¨äºéä½æ¯æ¬¡æ¥è¯¢åæ°æ®ç»ææ°éçä»£ç ï¼ä¹æ²¡ææã</p>
<p>æåï¼ææä»£ç ç§»å°äºå¦ä¸ä¸ªè¿æ¥åæ ·æ°æ®åºçåºç¨ä¸­ï¼å ä¸ºé£ä¸ªåºç¨ææä¹åç±»ä¼¼çä»£ç ãç§»è¿å»ä»¥ååæ¯æ­ªææ­£çå°è§£å³äºã</p>
<p>ç¬¬äºé¶æ®µçææ¥ï¼æ¯å¨ä¸æ®µæ¶é´åï¼æå¨ååçåºç¨ä¸­å¼åæ°çåè½ï¼å¯¹ååä»£ç è¿è¡æ¹å¨ï¼èªä»¥ä¸ºä¿®å¤å¥½äºï¼ä½æ¯ä¸çº¿ååç°è¿æ¯åä¹åä¸æ ·ã</p>
<h1 id="åæ">åæ</h1>
<p>çº¿ä¸çº¿ä¸æå¤§çåºå«å°±æ¯çº¿ä¸å ä¸ªåºæ¯åä¸ä¸ªMySqlå®ä¾ï¼èçº¿ä¸åå±ä¸ä¸ªãæçä»£ç éï¼çç¹æå¤§çæ¯æ¥è¯¢åæ°æ®<code>metaData.getTables()</code>è¿æ®µã</p>
<p>å¥½å·§ä¸å·§ï¼å¨æææ¥çç¬¬ä¸é¶æ®µåç¬¬äºé¶æ®µä¸­é´ï¼æåäºä¸ä¸ªè¿ç§»è¡¨çåè½ï¼å®å¨æ°åäºæ¥è¯¢è¡¨åçä»£ç ï¼å¹¶ä¸ä¸ºäºä¸åç¯ç©çåºåé»è¾åºææ··çéè¯¯ï¼ç¹å«å°åäºå¯¹åºçå·¥å·ç±»ï¼</p>
<pre><code class="language-Java">/**
 * æ°æ®æºææç»ä»¶ï¼ä¾¿äºåºç¨ç´æ¥è®¿é®æ°æ®æº
 *
 */
@Component
public class DataSourceHolder {

  @Resource protected ShardingSphereDataSource dataSource;

  /** ç©çåºå(jdbcé¾æ¥éçåºå)åæ°æ®æºçå³ç³» */
  private Map&lt;String, HikariDataSource&gt; hikariDataSourceMap;

  /** é»è¾åºå-ç©çåºåå³ç³» å¤ä¸ªé»è¾åºå¯è½å¯¹åºåä¸ä¸ªç©çåº */
  private Map&lt;String, String&gt; dsNameMap;

  /**
   * éè¿ç©çåºåè·åds
   *
   * @param physicalSchemaName
   * @return
   */
  public HikariDataSource getDataSourceByPhysicalSchemaName(String physicalSchemaName) {
    return hikariDataSourceMap.get(physicalSchemaName);
  }

  /**
   * éè¿é»è¾åºåè·åå¯¹åºç©çåºå
   *
   * @param dsName
   * @return
   */
  public String getPhysicalSchemaName(String dsName) {
    return dsNameMap.get(dsName);
  }

  /**
   * éè¿é»è¾åºåè·åds
   *
   * @param logicalSchemaName
   * @return
   */
  public HikariDataSource getDataSourceByLogicalSchemaName(String logicalSchemaName) {
    String physicalSchemaName = getPhysicalSchemaName(logicalSchemaName);
    if (StringUtils.isBlank(physicalSchemaName)) {
      throw new RuntimeException("é»è¾åºåæ¾ä¸å°å¯¹åºç©çåº, logicalSchemaName=" + logicalSchemaName);
    }
    return hikariDataSourceMap.get(physicalSchemaName);
  }

  @PostConstruct
  public void initHikariDataSourceMap() {
    dsNameMap = Maps.newHashMap();
    hikariDataSourceMap = Maps.newHashMap();
    Map&lt;String, DataSource&gt; dataSourceMap =
        dataSource.getContextManager().getDataSourceMap(dataSource.getSchemaName());
    dataSourceMap.forEach(
        (dsName, ds) -&gt; {
          HikariDataSource hds = (HikariDataSource) ds;
          try (Connection connection = hds.getConnection(); ) {
            hikariDataSourceMap.put(connection.getCatalog(), hds);
            dsNameMap.put(dsName, connection.getCatalog());
          } catch (SQLException e) {
            throw new RuntimeException("ç»è£æ°æ®æºmapå¤±è´¥", e);
          }
        });
  }
}
</code></pre>
<p>å¯¹åºå°ï¼è·åæ°æ®åºConnectionçæ¹æ³æ¯ï¼</p>
<pre><code class="language-Java">HikariDataSource hikariDataSource = dataSourceHolder.getDataSourceByPhysicalSchemaName(dsName);
Connection connection = hikariDataSource.getConnection();
</code></pre>
<p>å¹¶ä¸ä¹ä¸åä½¿ç¨HintManageræå®é»è¾åºã</p>
<p>èæ³å°çº¿ä¸çº¿ä¸MySqlå®ä¾çå·®å¼ï¼æçæµæ¯å ä¸ºï¼</p>
<p>çº¿ä¸ä¸ä¸ªåºæ¯åä¸ä¸ªMySqlå®ä¾ï¼é£ä¹åæ°æ®information_schema.tablesæ¯ä¸æ ·çï¼å¨åªä¸ªåºé½è½æ¥å°å¯¹åºè¡¨ã</p>
<p>çº¿ä¸åæ¯ä¸åçå®ä¾ï¼ç´æ¥ä½¿ç¨ShardingSphereDataSourceå¯¹åºConnectionçåæ°æ®ï¼å¹¶ä¸æ»æ¯é¢æçåºã</p>
<p>è¿ä¸ªçæµåå ï¼ä¹å¨ä¹åç¬¬ä¸é¶æ®µçææ¥å»åï¼è½æ­£å¸¸å·¥ä½çä»£ç æå¨åºç¨ï¼è·åæ°æ®æºçæ¹å¼å®éæ¯</p>
<pre><code class="language-Java">Map&lt;String, DataSource&gt; allDataSource =
    shardingSphereDataSource.getContextManager().getDataSourceMap("logic_db");
Connection connection = allDataSouce.get(logicalSchemaName).getConnection();
</code></pre>
<p>è½ç¶å®ä¹ç¨äºHintMangerï¼ä½æè®¤ä¸ºæ¯æ²¡ææä¹çã</p>
<h1 id="ä¿®å¤">ä¿®å¤</h1>
<p>ç»¼åä»¥ä¸çåæï¼æç»çä¿®å¤ä»£ç å¦ä¸</p>
<pre><code class="language-Java">    List&lt;String&gt; tableNames = Lists.newArrayList();
    try (Connection conn =
        dataSourceHolder.getDataSourceByPhysicalSchemaName(physicalSchemaName).getConnection()) {
      DatabaseMetaData metaData = conn.getMetaData();
      try (ResultSet rs =
          metaData.getTables(physicalSchemaName, null, prefix + "%", new String[] {"TABLE"})) {
        while (rs.next()) {
          String tableName = rs.getString("TABLE_NAME");
          tableNames.add(tableName);
        }
      }
    } catch (SQLException e) {
      throw new RuntimeException("å¤çå¤§ç»æéå¤±è´¥", e);
    }
    return tableNames;
</code></pre>
<p>è¿æ¬¡åé¨ç½²å°çäº§ç¯å¢ï¼è¿è¡ç¬¦åé¢æã</p>
<p>å¯è§ï¼å½ä½ éè¦å®éååºå¯¹åºçåæ°æ®æ¶ï¼ä¸è¦ç¨shardingSphereDataSourceï¼èæ¯åºè¯¥ç¨å®å³èå·ä½ååºçdataSourceï¼ä¹å³shardingSphereDataSource.getContextManager().getDataSourceMap()ï¼åç¨è¿ä¸ªååºdataSourceè·ååæ°æ®ã</p>
<p>å¦åï¼çº¿ä¸çº¿ä¸ä¸åçMySqlå®ä¾éç½®ï¼ä¼å¯¼è´ä¸åçç°è±¡ï¼é¾ä»¥ææ¥çæ­£çåå ã</p>

</div>
<div id="MySignature" role="contentinfo">
    <div id="AllanboltSignature">
        <p id="PSignature" style="border-top: #e0e0e0 1px dashed; border-right: #e0e0e0 1px dashed; border-bottom: #e0e0e0 1px dashed; border-left: #e0e0e0 1px dashed;
            padding-top: 10px;padding-right: 10px;padding-bottom: 10px;padding-left: 60px;
            font-family: å¾®è½¯éé»; font-size:11px;">
            <br>
            ä½èï¼<a href="http://www.cnblogs.com/wuyuegb2312" target="_blank">äºå²³</a>
            <br>
            åºå¤ï¼<a href="http://www.cnblogs.com/wuyuegb2312" target="_blank">http://www.cnblogs.com/wuyuegb2312</a>
            <br>
            å¯¹äºæ é¢æªæ æ³¨ä¸ºâè½¬è½½âçæç« åä¸ºååï¼å¶çæå½ä½èææï¼æ¬¢è¿è½¬è½½ï¼ä½æªç»ä½èåæå¿é¡»ä¿çæ­¤æ®µå£°æï¼ä¸å¨æç« é¡µé¢ææ¾ä½ç½®ç»åºåæè¿æ¥ï¼å¦åä¿çè¿½ç©¶æ³å¾è´£ä»»çæå©ã
        </p>
    ã</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-26 22:01">2025-12-26 22:00</span>&nbsp;
<a href="https://www.cnblogs.com/wuyuegb2312">äºå²³</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19405814);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19405814', targetLink: 'https://www.cnblogs.com/wuyuegb2312/p/19405814', title: 'ååºåè¡¨æ°æ®æºShardingSphereDataSourceçConnectionåæ°æ®è¯¯ç¨é®é¢åæ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æç´¢æ°æ®åºè¡¨çæ§è½ä¼åè¿ç¨ ]]></title>
    <link>https://www.cnblogs.com/yadelei/p/19406737/the-performance-optimization-process-of-searching-database-tables</link>
    <guid>baa623f00499bd34698147e318bc6721</guid>
    <description>
    <![CDATA[ 
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/yadelei/p/19406737/the-performance-optimization-process-of-searching-database-tables" title="åå¸äº 2025-12-26 21:54">
    <span role="heading" aria-level="2">æç´¢æ°æ®åºè¡¨çæ§è½ä¼åè¿ç¨</span>
    

</a>

		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="é®é¢èæ¯">é®é¢èæ¯</h2>
<p>åä¸ä¸ªæ°æ®åºè¡¨æ¥çãæ æ³¨ä¸åæçå·¥å·è½¯ä»¶ã</p>
<p><span class="math inline">\(Table\)</span>æ¯æ°æ®åºä¸­è¡¨çä¿¡æ¯ï¼<code>information_schema.tables</code>ï¼ï¼<span class="math inline">\(Documentation\)</span>æ¯<span class="math inline">\(Table\)</span>çæ°æ®å­å¸ææ¡£ï¼å­å¨å¨æ¬å°æä»¶ä¸­ï¼<span class="math inline">\(Annotation\)</span>æ¯å¯¹<span class="math inline">\(Table\)</span>çé¢å¤æ æ³¨ä¿¡æ¯ï¼å­å¨å¨å¦ä¸ä¸ªæ°æ®åºä¸­ãæ¯ä¸æ¡<span class="math inline">\(Table\)</span>ï¼æå¤å³èå°ä¸æ¡<span class="math inline">\(Documentation\)</span>åä¸æ¡<span class="math inline">\(Annotation\)</span>ã</p>
<p>ç°å¨æ³æç´¢<span class="math inline">\(Table\)</span>ãåç«¯ååç«¯æä¾3ä¸ªåæ°ï¼æç´¢å³é®è¯åè¡¨ãå½åé¡µç ãæ¯é¡µæ¡æ°ï¼åç«¯çæç´¢é»è¾æ¯ï¼å¦æä¸æ¡å®æ´æ°æ®ï¼<span class="math inline">\(Table\)</span>+<span class="math inline">\(Documentation\)</span>+<span class="math inline">\(Annotation\)</span>ï¼åå«æææç´¢å³é®è¯ï¼åå°<span class="math inline">\(Table\)</span>å å¥æç´¢ç»æä¸­ã</p>
<p><span class="math inline">\(Table\)</span>çæ°éç®åä¸º6000+ï¼è¦åå°ç§çº§æç´¢ã</p>
<h2 id="åæ­¥å®ç°">åæ­¥å®ç°</h2>
<p>å ä¸ºè·¨æ°æ®æºï¼æä»¥ä¸è½ç®åè¿è¡¨æ¥è¯¢ã</p>
<p>å¯¹äºæ¯ä¸ª<span class="math inline">\(Table\)</span>ï¼æ¥åº<span class="math inline">\(Documentation\)</span>ã<span class="math inline">\(Annotation\)</span>ï¼ç¶åå°<span class="math inline">\(Table\)</span>ã<span class="math inline">\(Documentation\)</span>ã<span class="math inline">\(Annotation\)</span>ä¸­è¦æç´¢çå­æ®µå¼ååºæ¥ï¼ç¨ç©ºæ ¼éå¼æ¼æ¥ä¸ºå­ç¬¦ä¸²ï¼å½¢å¦<code>"Tableå­æ®µå¼ Documentationå­æ®µå¼ Annotationå­æ®µå¼"</code>ï¼æä»¬ç§°ä¹ä¸º<span class="math inline">\(SearchKey\)</span>ï¼æç´¢é®ï¼ãå¦ææ¯ä¸ªå³é®è¯é½åå«å¨<span class="math inline">\(SearchKey\)</span>ä¸­ï¼åå°<span class="math inline">\(Table\)</span>å å¥æç´¢ç»æã</p>
<p>æç´¢æ¶ï¼åè·åææ<span class="math inline">\(Table\)</span>ï¼ç¶åéåæ¯ä¸ª<span class="math inline">\(Table\)</span>ï¼è·å<span class="math inline">\(SearchKey\)</span>å¹¶å¤æ­æ¯å¦å å¥æç´¢ç»æã</p>
<p>ä¸ºäºæé«éåº¦ï¼ç¨Redisç¼å­<span class="math inline">\(Table\)</span>å¯¹åºç<span class="math inline">\(SearchKey\)</span>ã</p>
<p>åææ°æ®æåµï¼</p>
<ul>
<li><span class="math inline">\(Table\)</span>åªå¢ãä¸å ãä¸æ¹ï¼å æ­¤ï¼æç´¢æ¶è¦éæ°è·åææ<span class="math inline">\(Table\)</span>ï¼ç¡®ä¿æç´¢å°æ°<span class="math inline">\(Table\)</span>ï¼ä¸å¿èèé©±éï¼evictï¼<span class="math inline">\(SearchKey\)</span>çç¼å­ã</li>
<li><span class="math inline">\(Documentation\)</span>ä¸å¢ãä¸å ãä¸æ¹ï¼å æ­¤ï¼ä¸å¿èèé©±é<span class="math inline">\(SearchKey\)</span>çç¼å­ã</li>
<li><span class="math inline">\(Annotation\)</span>å¢ãå ãæ¹ï¼å æ­¤ï¼è¦å¨<span class="math inline">\(Annotation\)</span>å¢å æ¹ä¹åé©±éå¯¹åº<span class="math inline">\(SearchKey\)</span>çç¼å­ï¼ç¡®ä¿æç´¢å°<span class="math inline">\(Annotation\)</span>çææ°ä¿¡æ¯ã</li>
</ul>
<p>å®æµç»æï¼</p>
<ul>
<li>å®ç°äºåè½ï¼æ¯æåæ¶æ<span class="math inline">\(Table\)</span>ã<span class="math inline">\(Documentation\)</span>ã<span class="math inline">\(Annotation\)</span>çå­æ®µæç´¢ã</li>
<li>ææ§è½é®é¢ï¼å³ä½¿ç¼å­å·²ç»å¨é¨å®æï¼ä½æ¯æ¬¡æç´¢é½è¦èæ¶30så·¦å³ï¼åå æ¯6000+ä¸ª<span class="math inline">\(Table\)</span>éåä»Redisè·å<span class="math inline">\(SearchKey\)</span>ï¼æ¯æ¬¡èæ¶1~15msï¼ç´¯è®¡èæ¶éå¸¸é¿ã</li>
</ul>
<h2 id="ç¬¬ä¸æ¬¡æ§è½ä¼å">ç¬¬ä¸æ¬¡æ§è½ä¼å</h2>
<p>ä¼åç¼å­ç­ç¥ã</p>
<p>è·åææ<span class="math inline">\(Table\)</span>åï¼æå»º<span class="math inline">\(SearchKeyMap\)</span>ï¼<span class="math inline">\(Table\)</span>â<span class="math inline">\(SearchKey\)</span>ï¼ï¼ç¶åå°<span class="math inline">\(SearchKeyMap\)</span>ç¼å­ï¼è¿æ ·ï¼ä¸ä¸æ¬¡æç´¢æ¶ï¼åªéè¦ä»Redisè·åä¸æ¬¡ï¼æé«ä¼ è¾æçã</p>
<p>ä¸ºäºç¡®ä¿æç´¢å°æ°<span class="math inline">\(Table\)</span>ï¼ç¼å­<span class="math inline">\(SearchKeyMap\)</span>æ¶å°<span class="math inline">\(Table\)</span>åè¡¨çé¿åº¦ä½ä¸ºç¼å­é®ï¼å¦ææ°å¢äº<span class="math inline">\(Table\)</span>ï¼å<span class="math inline">\(SearchKeyMap\)</span>ä¸ä¼å½ä¸­ç¼å­ï¼èæ¯éæ°æå»ºã</p>
<p>ä¸ºäºåå°æå»º<span class="math inline">\(SearchKeyMap\)</span>çæ¶é´ï¼ä»ç¶ä¿çåä¸ª<span class="math inline">\(SearchKey\)</span>çç¼å­ï¼ä»ç¶å¨<span class="math inline">\(Annotation\)</span>å¢å æ¹ä¹åé©±éåä¸ª<span class="math inline">\(SearchKey\)</span>çç¼å­ï¼ä½ä¸åçæ¯ï¼è¿è¦åæ¶é©±é<span class="math inline">\(SearchKeyMap\)</span>çç¼å­ã</p>
<p>å®æµç»æï¼</p>
<ul>
<li>æ§è½æåææ¾ï¼å¨ç¼å­å¨é¨å®æçæåµä¸ï¼æç´¢èæ¶éè³1.3så·¦å³ã</li>
<li>ä»ç¶ææ§è½é®é¢ï¼å¯¹ä¸ä¸ª<span class="math inline">\(Annotation\)</span>åäºå¢å æ¹ï¼ä¼é©±éæ´ä¸ª<span class="math inline">\(SearchKeyMap\)</span>ç¼å­ï¼éå»º<span class="math inline">\(SearchKeyMap\)</span>å°±ååå°äºéå<span class="math inline">\(Table\)</span>çæåµï¼ä»ç¶è¦èæ¶30så·¦å³ã</li>
</ul>
<h2 id="ç¬¬äºæ¬¡æ§è½ä¼å">ç¬¬äºæ¬¡æ§è½ä¼å</h2>
<p>ä¼åç¼å­ç­ç¥ã</p>
<p>åæ¶åä¸ª<span class="math inline">\(SearchKey\)</span>çç¼å­ï¼åªç¼å­<span class="math inline">\(SearchKeyMap\)</span>ã</p>
<p>æç´¢<span class="math inline">\(Table\)</span>æ¶ï¼è¦è·å<span class="math inline">\(SearchKeyMap\)</span>ãåè·åç°æç<span class="math inline">\(SearchKeyMap\)</span>ç¼å­ï¼åºå®ç¼å­é®ï¼ä¸åä½¿ç¨åè¡¨é¿åº¦ä½ä¸ºç¼å­é®ï¼æ²¡æç¼å­ååå¾ç©ºMapï¼ï¼ç¶åéå<span class="math inline">\(Table\)</span>ï¼å¦æ<span class="math inline">\(Table\)</span>ä¸å¨<span class="math inline">\(SearchKeyMap\)</span>ä¸­ï¼åè®¡ç®<span class="math inline">\(SearchKey\)</span>å¹¶æ¾å¥<span class="math inline">\(SearchKeyMap\)</span>ãè¿æ ·ï¼ç¬¬ä¸æ¬¡æç´¢æ¶ä¼è®¡ç®æ¯ä¸ª<span class="math inline">\(Table\)</span>ç<span class="math inline">\(SearchKey\)</span>ï¼åç»­æç´¢å°±åªéè¦è®¡ç®æ°<span class="math inline">\(Table\)</span>ç<span class="math inline">\(SearchKey\)</span>ã</p>
<p><span class="math inline">\(Annotation\)</span>å¢å æ¹åï¼è¦æ´æ°<span class="math inline">\(SearchKeyMap\)</span>ãåè·åç°æç<span class="math inline">\(SearchKeyMap\)</span>ç¼å­ï¼ç¶åéæ°è®¡ç®æå®<span class="math inline">\(Table\)</span>ç<span class="math inline">\(SearchKey\)</span>å¹¶æ¾å¥<span class="math inline">\(SearchKeyMap\)</span>ãè¿æ ·ï¼æ éæ¯æ¬¡é½éå»ºæ´ä¸ª<span class="math inline">\(SearchKeyMap\)</span>ã</p>
<p>å®æµç»æï¼<span class="math inline">\(Annotation\)</span>å¢å æ¹ååæç´¢ï¼èæ¶éè³1.3så·¦å³ã</p>
<h2 id="ç¬¬ä¸æ¬¡æ§è½ä¼å">ç¬¬ä¸æ¬¡æ§è½ä¼å</h2>
<p>ä¼åç¼å­å®ç°æ¹å¼ã</p>
<p>æ¢ç¶ç°å¨åªéè¦ç®åå°ç¼å­ä¸ä¸ª<span class="math inline">\(SearchKeyMap\)</span>ï¼é£ä¹ä¸ä¸å®è¦ç¨Redisã</p>
<p>ä½¿ç¨Redisä½ä¸ºç¼å­ï¼<code>RedisCacheManager</code>ï¼ï¼è½ç¶åç½éä¿¡å¿«ï¼ä½ä»æç½ç»å¼éãå®æµå¹³å1092.9msã</p>
<p>ä½¿ç¨Mapä½ä¸ºç¼å­ï¼<code>ConcurrentMapCacheManager</code>ï¼ï¼å¶ä»ä»£ç å®å¨ä¸åãå®æµå¹³å968.3msã</p>
<p>ä¿®æ¹ä»£ç ï¼ç´æ¥ç¨ç±»ä¸­ç<code>Map</code>å­æ®µä½ä¸ºç¼å­ï¼çå»ç¼å­ç®¡çå¨çå¼éãå®æµå¹³å915.2msã</p>
<p>å¯è§ï¼æ§è½ææåï¼ä½å¹åº¦ä¸å¤§ãç±äºè½¯ä»¶å¨å¼åä¸­ï¼è¦é¢ç¹éæ°è¿è¡ï¼Redisè½ä¿æç¼å­ï¼Mapä¸è½ï¼å æ­¤ä¿æä¸ä¸çæ¹æ¡ä¸åä¿®æ¹ã</p>
<h2 id="ç¬¬åæ¬¡æ§è½ä¼å">ç¬¬åæ¬¡æ§è½ä¼å</h2>
<p>ç¬¬ä¸æ¬¡ä¼åå¶å®æ¯ç²ç®çï¼åºè¯¥è¦ç¨äºå®æ¾åºæ§è½ç¶é¢ã</p>
<p>å¯¹æç´¢è¿ç¨è®¡æ¶åæåç°ï¼ä¸æ¬¡èæ¶1105msçæç´¢ï¼å¶ä¸­è·åææ<span class="math inline">\(Table\)</span>èæ¶1028msï¼å æ¯93%ï¼æ¯ç»å¯¹çæ§è½ç¶é¢ã</p>
<p>æè·¯1ï¼ååªè·åææè¡¨åï¼èä¸æ¯<span class="math inline">\(Table\)</span>å¯¹è±¡ï¼å¦æè¡¨åå¯¹åºç<span class="math inline">\(SearchKey\)</span>å¹éï¼åè·å<span class="math inline">\(Table\)</span>ãå®æµåç°ï¼å¦æå¹éçè¡¨åå¾å¤ï¼ä¾å¦å³é®è¯åè¡¨ä¸ºç©ºæ¶ï¼ï¼åå³ä½¿æè¡¨åâ<span class="math inline">\(Table\)</span>çç¼å­ï¼Rediså®ç°ï¼ï¼éä¸ªè·åä¹è¿è¿æ¢äºç´æ¥ä»æ°æ®åºä¸æ¬¡æ§è·åãå æ­¤ï¼æ­¤æè·¯<strong>ä¸å¯è¡</strong>ã</p>
<p>æè·¯2ï¼<span class="math inline">\(Table\)</span>åªå¢ãä¸å ãä¸æ¹ï¼å æ­¤å¯ä»¥èèå¢éè·åãç¼å­<span class="math inline">\(Table\)</span>åè¡¨ï¼æ¯æ¬¡è·åæ¶è·³è¿ç¼å­çé¿åº¦ï¼åªè·åå¢éé¨åãç¶èï¼<code>information_schema.tables</code>ä¸­æ²¡æ<code>id</code>ï¼æ æ³ä¿è¯æ°<span class="math inline">\(Table\)</span>ä¸å®æå¨æåãå æ­¤ï¼æ­¤æè·¯<strong>ä¸å¯è¡</strong>ã</p>
<p>æè·¯3ï¼è·åææ<span class="math inline">\(Table\)</span>è¯´å°åºåªæ¯ä¸ºäºæç´¢å°æ°<span class="math inline">\(Table\)</span>ï¼å¦æè½ç¥éä»ä¹æ¶åæ°å¢äº<span class="math inline">\(Table\)</span>ï¼å°±å¯ä»¥æ¾å¿å°ä½¿ç¨<span class="math inline">\(Table\)</span>åè¡¨çç¼å­ï¼æèä»æ°æ®åºéæ°è·åãé£ä¹æä¹ç¥éï¼ç±äº<span class="math inline">\(Table\)</span>åªå¢ï¼æä»¥å¯ä»¥ç¨<span class="math inline">\(Table\)</span>çæ°éå¤æ­ãç¼å­<span class="math inline">\(Table\)</span>åè¡¨ï¼æ¯æ¬¡åä»æ°æ®åºæ¥åºæ°éï¼æ¯ç´æ¥æ¥åº<span class="math inline">\(Table\)</span>åè¡¨ææ¾æ´å¿«ï¼ï¼å¦ææ°éä¸ç¼å­ä¸è´ï¼åç¨ç¼å­ï¼å¦åæ¥åºãå®æµï¼æ­¤æè·¯<strong>å¯è¡</strong>ã</p>
<p>å®ç°æè·¯3åï¼åæ¬¡è®¡æ¶åæãæ æ°å¢<span class="math inline">\(Table\)</span>æ¶ï¼æç´¢èæ¶éè³360mså·¦å³ï¼åªæ¥åºæ°éï¼ï¼ææ°å¢æ¶ï¼èæ¶åè³1.5så·¦å³ï¼æ¥åºæ°é+åè¡¨ï¼ãç±äºæç´¢<span class="math inline">\(Table\)</span>çé¢çè¿è¿é«äºæ°å¢<span class="math inline">\(Table\)</span>ï¼å æ­¤ï¼æ»ä½æ§è½æåæ¾èã</p>
<h2 id="æ»ç»">æ»ç»</h2>
<p>ç»è¿æ°æ¬¡æ§è½ä¼åï¼å¨æ»¡è¶³åè½çåæä¸ï¼æç´¢æ¶é´ä»30så·¦å³éè³ç¨³å®0.4så·¦å³ï¼æææ¾èã0.4så·²ç»æ²¡æç¼æ¢æï¼æ§è½ä¼åå·¥ä½å¯ä»¥ç»æäºã</p>
<p>ä»ä¸è¿°ä¼åè¿ç¨å¯è§ï¼åä¼åè¦å å°å¶å®ï¼å·ä½é®é¢å·ä½åæï¼éæ©åéçç­ç¥ï¼ä¼åææçè¡¡éè¦ä»¥å®æµç»æä¸ºåã</p>

</div>
<div class="clear"></div>

		</div>
		<div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-26 21:55">2025-12-26 21:54</span>&nbsp;
<a href="https://www.cnblogs.com/yadelei">äºå¾·é·</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19406737);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19406737', targetLink: 'https://www.cnblogs.com/yadelei/p/19406737/the-performance-optimization-process-of-searching-database-tables', title: 'æç´¢æ°æ®åºè¡¨çæ§è½ä¼åè¿ç¨' })">ä¸¾æ¥</a>
</div>
	 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä½¿ç¨Gradioæå»ºAIåç«¯ - RAGå¬åæµè¯ ]]></title>
    <link>https://www.cnblogs.com/aspnetx/p/19406675</link>
    <guid>0ffff4524393353d0022699c451a1030</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/aspnetx/p/19406675" title="åå¸äº 2025-12-26 21:27">
    <span role="heading" aria-level="2">ä½¿ç¨Gradioæå»ºAIåç«¯ - RAGå¬åæµè¯</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æå»ºAIåºç¨çåç«¯æ¹æ¡æå¾å¤ï¼è¿éä»ç»ä¸ä¸ªå¼æºåç«¯åº---Gradioï¼éè¿å®å¯ä»¥ä½¿ç¨ç®ç­çä»£ç å°±å¯ä»¥å¿«éçå®ç°ç®åçAIåºç¨åç«¯ãè¿éæä»¬éæ©çåºæ¯ä¸ºåRAGå¬åæµè¯ï¼éè¿è°ç¨ååå°è£å¥½çLangChainä»£ç ï¼æ¥å¿«éçæ­å»ºè¿ä¸ªåç«¯é¡µé¢ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ä½¿ç¨gradioæå»ºaiåç«¯---ragå¬åæµè¯">ä½¿ç¨Gradioæå»ºAIåç«¯ - RAGå¬åæµè¯</h1>
<h2 id="ä¸æè¦">ä¸ãæè¦</h2>
<p>æå»ºAIåºç¨çåç«¯æ¹æ¡æå¾å¤ï¼è¿éä»ç»ä¸ä¸ªå¼æºåç«¯åº---Gradioï¼éè¿å®å¯ä»¥ä½¿ç¨ç®ç­çä»£ç å°±å¯ä»¥å¿«éçå®ç°ç®åçAIåºç¨åç«¯ãè¿éæä»¬éæ©çåºæ¯ä¸ºåRAGå¬åæµè¯ï¼éè¿è°ç¨ååå°è£å¥½çLangChainä»£ç ï¼æ¥å¿«éçæ­å»ºè¿ä¸ªåç«¯é¡µé¢ã</p>
<h2 id="äºaié¡¹ç®åç«¯æ¹æ¡çå¯¹æ¯">äºãAIé¡¹ç®åç«¯æ¹æ¡çå¯¹æ¯</h2>
<p>å¯ä»¥åAIçåç«¯æ¹æ¡å¾å¤ï¼è¿éä¸»è¦ä»ç»æ¯è¾ç­é¨çä¸ä¸ªæ¹æ¡ï¼</p>
<ul>
<li>Gradio æ¯ä¸æ¬¾å¼æºç Python åºï¼æ ¸å¿å®ä½æ¯å¿«éæå»ºæºå¨å­¦ä¹  / æ·±åº¦å­¦ä¹ æ¨¡åçäº¤äºå¼ Web æ¼ç¤ºçé¢ï¼æ éåç«¯å¼åç»éªï¼ä¸è¡ä»£ç å³å¯å°æ¨¡åï¼æä»»æ Python å½æ°ï¼è½¬åä¸ºå¯éè¿æµè§å¨è®¿é®çäº¤äºé¡µé¢ï¼æ¹ä¾¿å¼åèãç ç©¶èå¿«éå±ç¤ºãæµè¯ååäº«æ¨¡åã</li>
<li>Streamlit æ¯ä¸æ¬¾å¼æºç Python åºï¼ä¸»æå¿«éæå»ºæ°æ®ç§å­¦ / æºå¨å­¦ä¹ é¢åçäº¤äºå¼ Web åºç¨ï¼æ éåç«¯å¼åç»éªï¼ä»¥ âèæ¬å³åºç¨â ä¸ºæ ¸å¿çå¿µ ââ æ®éç Python èæ¬åªéæ·»å å°é Streamlit è¯­æ³ï¼å°±è½ä¸é®è½¬åä¸ºå¯äº¤äºç Web åºç¨ï¼æ¯æ°æ®åæå¸ãç®æ³å·¥ç¨å¸å¿«éè½å°å¯è§å / åæå·¥å·çé¦éã</li>
<li>Vueï¼è¯»é³ /vjuË/ï¼ç±»ä¼¼ viewï¼æ¯ä¸æ¬¾æ¸è¿å¼ JavaScript æ¡æ¶ï¼æ ¸å¿èç¦äºåç«¯è§å¾å±ï¼UIï¼å¼åï¼ç±å°¤é¨æºªå¼åå¹¶å¼æºï¼æ¯ç®åæä¸»æµçåç«¯æ¡æ¶ä¹ä¸ï¼ä¸ ReactãAngular å¹¶ç§°ï¼ã<br>
ç¸å¯¹ä¸ç§æ¹æ¡ï¼Gradioæ¯ç´æ¥è¢«è®¾è®¡æAIçåç«¯çï¼Streamlitéååæ°æ®ç§å­¦çåç«¯ãèVueæ¯ä¸ä¸ªæ´ä¸ä¸çåç«¯æ¡æ¶ã<br>
è¿éæä»¬ä»ç»çå°±æ¯Gradioãæä»¥æä»¬ä½¿ç¨Gradioæå»ºäºä¸ä¸ªRAGï¼æ£ç´¢å¢å¼ºçæï¼å¬åæµè¯ç³»ç»çé¢ï¼ä¸»è¦åè½æ¯éè¿è°ç¨<code>LC_RAG_02_RecallTest.py</code>ä¸­ç<code>recall</code>å½æ°å®ç°ç¸ä¼¼åº¦æ£ç´¢ï¼ç¨æ·å¯ä»¥è¾å¥æ¥è¯¢ææ¬å¹¶è®¾ç½®è¿åç»ææ°éï¼ç³»ç»ä¼å±ç¤ºæ£ç´¢å°çæç¸ä¼¼ææ¡£ã</li>
</ul>
<h2 id="ä¸ç¯å¢ä»ç»">ä¸ãç¯å¢ä»ç»</h2>
<p>è¿éåºäºæå¦å¤ä¸ç¯ç¬è®°ï¼<br>
<a href="https://www.cnblogs.com/aspnetx/p/19173914" target="_blank">https://www.cnblogs.com/aspnetx/p/19173914</a><br>
å¨è¿ä¸ªç¬è®°ä¸­ï¼ä»ç»äºå¦ä½ä½¿ç¨pythonæå»ºRAGç³»ç»ï¼ä½¿ç¨çæ¯LangChain1.0çåºã<br>
æ´ä¸ªé¡¹ç®å¯ä»¥å¨ä»¥ä¸ä»åºä¸­æ¾å°ï¼<br>
<a href="https://github.com/microsoftbi/Langchain_DEMO/tree/main/RAG" target="_blank" rel="noopener nofollow">https://github.com/microsoftbi/Langchain_DEMO/tree/main/RAG</a><br>
æä¼ç¨å°å¨å¶ä¸­çä¸ä¸ªæä»¶ä¸­å°è£å¥½çåRAGå¬åæµè¯çä»£ç ï¼æ¥æå»ºåç«¯åºç¨ï¼åæ­¤å±ç¤ºGradioç¯å¢ä¸­å¦ä½å¿«éçæ­å»ºåç«¯é¡µé¢ã<br>
æ¬æåå»ºçä»£ç æä»¶åä¸ºï¼LC_RAG_07b_Gradio.py<br>
è°ç¨ååå¬åæµè¯çä»£ç æä»¶ä¸ºï¼LC_RAG_02_RecallTest.py</p>
<h2 id="åä¸»è¦åè½æ¨¡å">åãä¸»è¦åè½æ¨¡å</h2>
<h3 id="1-å¬åæµè¯å½æ°-run_recall_test">1. å¬åæµè¯å½æ° <code>run_recall_test</code></h3>
<ul>
<li>åè½ï¼è°ç¨LC_RAG_02_RecallTest.pyæä»¶ä¸­å°è£å¥½ç<code>recall</code>å½æ°æ§è¡æ£ç´¢å¹¶æè·è¾åºç»æã</li>
</ul>
<pre><code class="language-Python">def run_recall_test(query, top_k):
    """è¿è¡å¬åæµè¯å¹¶è¿åç»æ"""
    try:
        # è°ç¨recallå½æ°ï¼ä½éè¦æè·å¶è¾åº
        import io
        from contextlib import redirect_stdout
        
        # åå»ºä¸ä¸ªå­ç¬¦ä¸²IOå¯¹è±¡æ¥æè·è¾åº
        f = io.StringIO()
        with redirect_stdout(f):
            recall(
                query=query,
                top_k=top_k,
                vectorstore_dir="./RAG/chroma_db",
                embedding_model="text-embedding-v4"
            )
        
        # è·åæè·çè¾åº
        output = f.getvalue()
        return output
    except Exception as e:
        return f"éè¯¯: {str(e)}"
</code></pre>
<ul>
<li>å®ç°è¦ç¹ï¼
<ul>
<li>ä½¿ç¨<code>io.StringIO()</code>åå»ºå­ç¬¦ä¸²ç¼å²åº</li>
<li>éè¿<code>redirect_stdout</code>ä¸ä¸æç®¡çå¨æè·<code>recall</code>å½æ°çæå°è¾åº</li>
<li>è°ç¨<code>recall</code>å½æ°æ¶æå®åæ°ï¼æ¥è¯¢ææ¬ãè¿åæ°éãåéå­å¨ç®å½ååµå¥æ¨¡å<br>
å ä¸ºå¨ååå°è£å¥½çä»£ç ä¸­å¹¶æ²¡æè¿åå¼ï¼èæ¯ç´æ¥éè¿printæ¥è¾åºç»æï¼æä»¥è¿ééè¦è°ç¨ç¸å³çåæ¥è¯»åè¿äºè¾åºã</li>
</ul>
</li>
</ul>
<h3 id="2-gradioçé¢æå»º">2. Gradioçé¢æå»º</h3>
<p>é¦åéè¦ç¡®ä¿Gradioçåºå·²ç»è¢«å®è£ï¼</p>
<pre><code>pip install gradio 
</code></pre>
<p>ç¶åå¨ä»£ç ä¸­å¼å¥è¿ä¸ªåºã</p>
<pre><code>import gradio as gr 
</code></pre>
<p>éåä½¿ç¨<code>gr.Blocks</code>åå»ºç»æåçé¢ï¼å¨å¶ä¸åéè¿gr.Row()ä»¥ågr.Column()ï¼å°±å¯ä»¥å¾è¿ä¸ªæ¡æ¶ä¸åå²åºæ¥ä¸åçè¡ååæ¥å æ¾éè¦çç»ä»¶ã<br>
é¡ºä¾¿è¯´ä¸ä¸ï¼Gradidæä¸¤ç§æ¹å¼çå¸å±ï¼ä¸ä¸ªæ¯interface, éè¿ç»å®çå½æ°èªå¨çæçé¢ï¼å¦ä¸ä¸ªå°±æ¯Blockï¼éè¿è¡åçæ¹å¼èªå·±ç»ç»çé¢ãè¿éç¨å°çå°±æ¯Blocksæ¹å¼ã</p>
<p>ä»¥ä¸æ¯å ç§å¸¸ç¨çè®¾ç½®åç«¯çé¢çæ¹æ³ï¼</p>
<h4 id="1é¡µé¢æ é¢ä¸è¯´æ">ï¼1ï¼é¡µé¢æ é¢ä¸è¯´æ</h4>
<p>ç´æ¥åmarkdownæ ¼å¼çè¾åºï¼</p>
<pre><code class="language-python">gr.Markdown("# RAGå¬åæµè¯ç³»ç»")
gr.Markdown("ä½¿ç¨Gradioæå»ºçRAGå¬åæµè¯çé¢ï¼è°ç¨LC_RAG_02_RecallTest.pyå®ç°ç¸ä¼¼åº¦æ£ç´¢")
</code></pre>
<h4 id="2è¾å¥åºåå·¦ä¾§">ï¼2ï¼è¾å¥åºåï¼å·¦ä¾§ï¼</h4>
<p>ä¹å°±æ¯å¨gr.Row()çç¬¬ä¸ä¸ªgr.Column()</p>
<pre><code class="language-Python">        with gr.Column(scale=1):
            gr.Markdown("## æ¥è¯¢è®¾ç½®")
            
            # æ¥è¯¢ææ¬è¾å¥
            query_input = gr.Textbox(
                label="æ¥è¯¢ææ¬",
                placeholder="è¯·è¾å¥æ¨è¦æ£ç´¢çé®é¢æå³é®è¯",
                lines=3,
                info="ä¾å¦: 'ä»ä¹æ¯æªæå¹´?' æ 'åªäºèåæ¥åºè¯¥å®æä¼å?'"
            )
            
            # Top-Kè®¾ç½®
            top_k_slider = gr.Slider(
                label="Top-Kæ£ç´¢æ°é",
                minimum=1,
                maximum=10,
                value=5,
                step=1,
                info="è®¾ç½®è¿åçæç¸ä¼¼ææ¡£æ°é"
            )
            
            # æäº¤æé®
            submit_btn = gr.Button(
                "æ§è¡å¬åæµè¯",
                variant="primary",
                size="lg"
            )
            
            # éç½®æé®
            clear_btn = gr.Button("éç½®", variant="secondary")
</code></pre>
<p>è¿æ®µä»£ç åæ¬åå»ºä»¥ä¸çé¢ï¼</p>
<ul>
<li>æ¥è¯¢ææ¬è¾å¥æ¡ï¼<code>gr.Textbox</code>ï¼æ¯æå¤è¡è¾å¥</li>
<li>Top-Kè®¾ç½®æ»åï¼<code>gr.Slider</code>ï¼èå´1-10ï¼é»è®¤å¼5</li>
<li>æä½æé®ï¼"æ§è¡å¬åæµè¯"ï¼ä¸»æé®ï¼å"éç½®"ï¼æ¬¡è¦æé®ï¼</li>
</ul>
<p>å¯ä»¥çå°éè¿gr.å¯¹åºçæ¹æ³ï¼å°±å¯ä»¥åå»ºä¸åçç»ä»¶ã</p>
<h4 id="3è¾åºåºåå³ä¾§">ï¼3ï¼è¾åºåºåï¼å³ä¾§ï¼</h4>
<p>gr.Row()çç¬¬äºä¸ªgr.Column()</p>
<pre><code class="language-Python">        # å³ä¾§ï¼è¾åºåºå
        with gr.Column(scale=2):
            gr.Markdown("## å¬åç»æ")
            
            # ç»æè¾åº
            result_output = gr.Textbox(
                label="ç¸ä¼¼åº¦æ£ç´¢ç»æ",
                lines=20,
                interactive=False,
                placeholder="å¬åç»æå°æ¾ç¤ºå¨è¿é..."
            )
            
            # ç¶æä¿¡æ¯
            status_info = gr.Markdown("ç¶æ: å°±ç»ª")
</code></pre>
<ul>
<li>ç»æè¾åºæ¡ï¼<code>gr.Textbox</code>ï¼å±ç¤ºæ£ç´¢ç»æ</li>
<li>ç¶æä¿¡æ¯ï¼<code>gr.Markdown</code>ï¼æ¾ç¤ºç³»ç»å½åç¶æ</li>
</ul>
<h3 id="3-æé®äºä»¶">3. æé®äºä»¶</h3>
<p>è¿éä¸»è¦æ¯è°ç¨åé¢å®ä¹çæ¹æ³ï¼run_recall_test<br>
ç¶åä¸é¢å°è£äºä¸ä¸ªååºæé®çæ¹æ³ï¼</p>
<pre><code class="language-Python"># æé®äºä»¶
def on_submit(query, top_k):
    if not query:
        return "è¯·è¾å¥æ¥è¯¢ææ¬", "ç¶æ: éè¯¯ - æ¥è¯¢ææ¬ä¸è½ä¸ºç©º"
        
    status_info.value = "ç¶æ: æ­£å¨æ§è¡å¬åæµè¯..."
    result = run_recall_test(query, top_k)
    return result, "ç¶æ: æµè¯å®æ"
</code></pre>
<p>æåæè½½æé®çclickæ¹æ³ï¼</p>
<pre><code># ç»å®äºä»¶
submit_btn.click(
    fn=lambda query, top_k: on_submit(query, top_k),
    inputs=[query_input, top_k_slider],
    outputs=[result_output, status_info]
</code></pre>
<p>éè¦çæçæ¯è¿éçäºä»¶ååºçæ¹æ³è·å¶å®ç¼ç¨è¯­è¨çä¼æäºä¸åã</p>
<h3 id="5-åºç¨å¯å¨">5. åºç¨å¯å¨</h3>
<pre><code class="language-python">demo.launch(
    server_name="0.0.0.0",  # åè®¸å¤é¨è®¿é®
    server_port=7860,       # ç«¯å£å·
    share=False,            # ä¸çæå¬å±é¾æ¥
    debug=False             # éè°è¯æ¨¡å¼
)
</code></pre>
<p>æå®ç«¯å£å·åå¶å®ä¿¡æ¯ï¼ç´æ¥è¿è¡è¿ä¸ªä»£ç å°±å¯ä»¥å¨æµè§å¨éè®¿é®äºã<br>
ä»¥ä¸æ¯ä»£ç ææå»ºççé¢ã</p>
<p><img src="https://img2024.cnblogs.com/blog/8622/202512/8622-20251226211747483-484824576.png" alt="img" loading="lazy"></p>
<p>å¯ä»¥çå°ç¸æ¯ç¨Vueæ¥å°è£ï¼ä»£ç éå°±å°äºå¾å¤ï¼å°¤å¶æ¯ä¸éè¦åå»ºï¼æå»ºé¡¹ç®ï¼ä»¥åä¸ºåç«¯å»ä¸é¨åAPIã<br>
æä»¥å¯¹äºå¿«éçå¼åæ¥è¯´ï¼Gradioæ¯éå¸¸åéçãä½æ¯å¯¹äºä¼ä¸çº§çä¸ä¸å¼åï¼è¿æ¯å»ºè®®éæ©Vueã<br>
è¿æä¸ç§å»ºè®®å°±æ¯ï¼éè¿Gradioæ¥åå¿«éçååå¼åï¼ç¶åç¨Vueæ¥åçäº§å¼åã</p>
<details>
<summary>ä»¥ä¸æ¯ä»£ç çå¨é¨åå®¹ï¼ç¹å»å±å¼ã</summary>
<pre><code class="language-Python">import os
import gradio as gr
from dotenv import load_dotenv
from LC_RAG_02_RecallTest import recall

# å è½½ç¯å¢åé
load_dotenv()

def run_recall_test(query, top_k):
    """è¿è¡å¬åæµè¯å¹¶è¿åç»æ"""
    try:
        # è°ç¨recallå½æ°ï¼ä½éè¦æè·å¶è¾åº
        import io
        from contextlib import redirect_stdout
        
        # åå»ºä¸ä¸ªå­ç¬¦ä¸²IOå¯¹è±¡æ¥æè·è¾åº
        f = io.StringIO()
        with redirect_stdout(f):
            recall(
                query=query,
                top_k=top_k,
                vectorstore_dir="./RAG/chroma_db",
                embedding_model="text-embedding-v4"
            )
        
        # è·åæè·çè¾åº
        output = f.getvalue()
        return output
    except Exception as e:
        return f"éè¯¯: {str(e)}"

# åå»ºçé¢
with gr.Blocks(title="RAGå¬åæµè¯ç³»ç»", theme=gr.themes.Soft()) as demo:
    # é¡µé¢æ é¢
    gr.Markdown("# RAGå¬åæµè¯ç³»ç»")
    gr.Markdown("ä½¿ç¨Gradioæå»ºçRAGå¬åæµè¯çé¢ï¼è°ç¨LC_RAG_02_RecallTest.pyå®ç°ç¸ä¼¼åº¦æ£ç´¢")
    
    with gr.Row():
        # å·¦ä¾§ï¼è¾å¥åºå
        with gr.Column(scale=1):
            gr.Markdown("## æ¥è¯¢è®¾ç½®")
            
            # æ¥è¯¢ææ¬è¾å¥
            query_input = gr.Textbox(
                label="æ¥è¯¢ææ¬",
                placeholder="è¯·è¾å¥æ¨è¦æ£ç´¢çé®é¢æå³é®è¯",
                lines=3,
                info="ä¾å¦: 'ä»ä¹æ¯æªæå¹´?' æ 'åªäºèåæ¥åºè¯¥å®æä¼å?'"
            )
            
            # Top-Kè®¾ç½®
            top_k_slider = gr.Slider(
                label="Top-Kæ£ç´¢æ°é",
                minimum=1,
                maximum=10,
                value=5,
                step=1,
                info="è®¾ç½®è¿åçæç¸ä¼¼ææ¡£æ°é"
            )
            
            # æäº¤æé®
            submit_btn = gr.Button(
                "æ§è¡å¬åæµè¯",
                variant="primary",
                size="lg"
            )
            
            # éç½®æé®
            clear_btn = gr.Button("éç½®", variant="secondary")
        
        # å³ä¾§ï¼è¾åºåºå
        with gr.Column(scale=2):
            gr.Markdown("## å¬åç»æ")
            
            # ç»æè¾åº
            result_output = gr.Textbox(
                label="ç¸ä¼¼åº¦æ£ç´¢ç»æ",
                lines=20,
                interactive=False,
                placeholder="å¬åç»æå°æ¾ç¤ºå¨è¿é..."
            )
            
            # ç¶æä¿¡æ¯
            status_info = gr.Markdown("ç¶æ: å°±ç»ª")
    
    # æé®äºä»¶
    def on_submit(query, top_k):
        if not query:
            return "è¯·è¾å¥æ¥è¯¢ææ¬", "ç¶æ: éè¯¯ - æ¥è¯¢ææ¬ä¸è½ä¸ºç©º"
        
        status_info.value = "ç¶æ: æ­£å¨æ§è¡å¬åæµè¯..."
        result = run_recall_test(query, top_k)
        return result, "ç¶æ: æµè¯å®æ"
    
    def on_clear():
        return "", 5, "", "ç¶æ: å·²éç½®"
    
    # ç»å®äºä»¶
    submit_btn.click(
        fn=lambda query, top_k: on_submit(query, top_k),
        inputs=[query_input, top_k_slider],
        outputs=[result_output, status_info]
    )
    
    clear_btn.click(
        fn=on_clear,
        inputs=[],
        outputs=[query_input, top_k_slider, result_output, status_info]
    )
    
    # ç¤ºä¾æ¥è¯¢
    gr.Markdown("## ç¤ºä¾æ¥è¯¢")
    with gr.Row():
        example1 = gr.Button("ä»ä¹æ¯æªæå¹´?")
        example2 = gr.Button("åªäºèåæ¥åºè¯¥å®æä¼å?")
        example3 = gr.Button("è¶³çæ¯èµçåºæ¬è§åæ¯ä»ä¹?")
    
    def set_example(example_text):
        return example_text, 5, "", "ç¶æ: å°±ç»ª"
    
    example1.click(fn=lambda: set_example("ä»ä¹æ¯æªæå¹´?"), inputs=[], outputs=[query_input, top_k_slider, result_output, status_info])
    example2.click(fn=lambda: set_example("åªäºèåæ¥åºè¯¥å®æä¼å?"), inputs=[], outputs=[query_input, top_k_slider, result_output, status_info])
    example3.click(fn=lambda: set_example("è¶³çæ¯èµçåºæ¬è§åæ¯ä»ä¹?"), inputs=[], outputs=[query_input, top_k_slider, result_output, status_info])

# å¯å¨åºç¨
if __name__ == "__main__":
    demo.launch(
        server_name="0.0.0.0",
        server_port=7860,
        share=False,
        debug=False
    )
</code></pre>
</details>
</div>
<div id="MySignature" role="contentinfo">
    <p>&nbsp;</p>
<p>---------------------------------------------------------------</p>
<p style="margin: 0in 0in 10pt;">aspnetx<span style="font-family: SimSun;">ç</span>BI<span style="font-family: SimSun;">ç¬è®°ç³»åç´¢å¼ï¼</span></p>
<p style="margin: 0in 0in 10pt;"><a href="http://www.cnblogs.com/aspnetx/archive/2013/02/25/2931603.html" target="_blank">ä½¿ç¨SQL Server Analysis Servicesæ°æ®ææçå³èè§åå®ç°ååæ¨èåè½</a></p> 
<p style="margin: 0in 0in 10pt;"><a href="http://www.cnblogs.com/aspnetx/archive/2013/03/24/2978347.html" target="_blank">ä¸èµ·ç©è½¬SQL Server 2012 ä¸çåææå¡</a></p> 
<p style="margin: 0in 0in 10pt;"><a href="http://www.cnblogs.com/aspnetx/archive/2013/04/05/3000448.html" target="_blank">ä½¿ç¨SQL Serveråææå¡å®ä½ç®æ ç¨æ·  </a></p> 

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>---------------------------------------------------------------<br></p>
<p>æ¥èª<a href="http://www.cnblogs.com/" target="_blank">åå®¢å­</a>ç<a href="http://aspnetx.cnblogs.com/" target="_blank">aspnetx</a><font color="white">å®å«ä¸</font></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2025-12-26 21:27">2025-12-26 21:27</span>&nbsp;
<a href="https://www.cnblogs.com/aspnetx">å¥æ¬åå£«å¥(aspnetx)</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19406675);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19406675', targetLink: 'https://www.cnblogs.com/aspnetx/p/19406675', title: 'ä½¿ç¨Gradioæå»ºAIåç«¯ - RAGå¬åæµè¯' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>