<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-02-02T01:46:31.356Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ ä¸å¨ç­ç¹åé¡¾ï¼1.26-2.1ï¼ ]]></title>
    <link>https://www.cnblogs.com/cmt/p/19562421</link>
    <guid>5155dcdb46cfe99fe7fb891b16848641</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/cmt/p/19562421" title="åå¸äº 2026-02-02 09:03">
    <span role="heading" aria-level="2">ä¸å¨ç­ç¹åé¡¾ï¼1.26-2.1ï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>ç­ç¹éç¬ï¼</p>
<p>Â· <a href="https://www.cnblogs.com/bu-huo/archive/2026/01/27/19537153.html" target="_blank" rel="noopener">Clawdboté¨ç½²æç¨ï¼10åéç½å«Qwenï¼ç»èªå·±æ­ä¸ª7x24å°æ¶AIå©ç</a> (<a href="https://www.cnblogs.com/bu-huo/" target="_blank" rel="noopener">å¼ ä¸æ</a>) <br>Â· <a href="https://www.cnblogs.com/catchadmin/archive/2026/01/28/19545341.html" target="_blank" rel="noopener">Clawdbot å®æ´å¯¹æ¥é£ä¹¦æç¨ ææææ­å»ºä½ çä¸å± AI å©æ</a> (<a href="https://www.cnblogs.com/catchadmin/" target="_blank" rel="noopener">JaguarJack</a>) <br>Â· <a href="https://www.cnblogs.com/philry/archive/2026/01/26/19534679.html" target="_blank" rel="noopener">ç ´é²äºï¼2026å¼å¹´3ä½ç¨åºåæ¥è¿çæ­»ï¼æå¹´è½»26å²ï¼29å²ç·ä¸»ç¦»ä¸æ¶ï¼å¦»å­æ­£æäºè7ä¸ªæâ¦</a> (<a href="https://www.cnblogs.com/philry/" target="_blank" rel="noopener">å¤§èæ2ç¹0</a>) <br>Â· <a href="https://www.cnblogs.com/ChenAI-TGF/archive/2026/01/29/19545952.html" target="_blank" rel="noopener">é¶é¨æ§é¨ç½²æ¬å° AI å©æï¼Clawdbot/Meltbot é¨ç½²æ·±åº¦ä¿å§çº§æç¨</a> (<a href="https://www.cnblogs.com/ChenAI-TGF/" target="_blank" rel="noopener">TTGF</a>) <br>Â· <a href="https://www.cnblogs.com/xueweihan/archive/2026/01/28/19535889.html" target="_blank" rel="noopener">ãHelloGitHubãç¬¬ 118 æ</a> (<a href="https://www.cnblogs.com/xueweihan/" target="_blank" rel="noopener">åå¾®å¯</a>) <br>Â· <a href="https://www.cnblogs.com/zer0Black/archive/2026/01/26/19535695.html" target="_blank" rel="noopener">OpenCodeåoh-my-opencodeå®è£</a> (<a href="https://www.cnblogs.com/zer0Black/" target="_blank" rel="noopener">éæ»çç¨åºäººç</a>) <br>Â· <a href="https://www.cnblogs.com/yupi/archive/2026/01/27/19537546.html" target="_blank" rel="noopener">Agent Skills å»çå¼æç¨ï¼26 å¹´æç« AI ææ¯å°±è¿ï¼</a> (<a href="https://www.cnblogs.com/yupi/" target="_blank" rel="noopener">ç¨åºåé±¼ç®</a>) <br>Â· <a href="https://www.cnblogs.com/xiangcaoacao/archive/2026/01/30/19550609.html" target="_blank" rel="noopener">Moltbotçå®è£è¸©åä¸åä½éª</a> (<a href="https://www.cnblogs.com/xiangcaoacao/" target="_blank" rel="noopener">vanillaé¿è</a>) <br>Â· <a href="https://www.cnblogs.com/Can-daydayup/archive/2026/01/29/19550484.html" target="_blank" rel="noopener">ä¸æ¬¾åºäº .NET Avalonia å¼æºåè´¹ãå¿«éãè·¨å¹³å°çå¾çæ¥çå¨</a> (<a href="https://www.cnblogs.com/Can-daydayup/" target="_blank" rel="noopener">è¿½éæ¶åè</a>) <br>Â· <a href="https://www.cnblogs.com/catchadmin/archive/2026/01/30/19553102.html" target="_blank" rel="noopener">ç®åæç«ç AI å©æ Clawdbot åååæ¹åäº å¹¶ä¸åå¸æ°çæ¬</a> (<a href="https://www.cnblogs.com/catchadmin/" target="_blank" rel="noopener">JaguarJack</a>) <br>Â· <a href="https://www.cnblogs.com/haibindev/archive/2026/01/29/19547739.html" target="_blank" rel="noopener">å½åAIç¼ç¨IDEå¯¹æ¯ï¼äºï¼ï¼ä»é¶æå»ºæ¡é¢åºç¨å®æµ</a> (<a href="https://www.cnblogs.com/haibindev/" target="_blank" rel="noopener">haibindev</a>) <br>Â· <a href="https://www.cnblogs.com/sdcb/archive/2026/01/26/chats-1-10.html" target="_blank" rel="noopener">å¤å» ChatGPT é«çº§æ°æ®åæï¼Sdcb Chats 1.10 éç£åå¸ï¼è½åæExcelãåPPT</a> (<a href="https://www.cnblogs.com/sdcb/" target="_blank" rel="noopener">.NETéªæä½</a>)</p>
<p>ç­ç¹æ°é»ï¼</p>
<p>Â· <a href="https://news.cnblogs.com/n/813590/" target="_blank" rel="noopener">Redisä¹ç¶ï¼æåä»£ç ï¼ééå§é¤éä½ å¾ä¸ä¹</a><br>Â· <a href="https://news.cnblogs.com/n/813609/" target="_blank" rel="noopener">Claudeç»æ²»ä¸åï¼åä¸è¿é¢çº¢è¯ä¸¸ï¼çå·¥ä¹æ¯é¡¶å°ç¨åºå</a><br>Â· <a href="https://news.cnblogs.com/n/813732/" target="_blank" rel="noopener">ã360doc ä¸ªäººå¾ä¹¦é¦ãå®£å¸æ å¿è½¬è®©ï¼åå§äººç§°ä¸ºå¹³å°å¯»æ¾ãæ°å®¶ã</a><br>Â· <a href="https://news.cnblogs.com/n/813688/" target="_blank" rel="noopener">ææ¯ä¾è¡¥åè¿ä¸ç§æ°¨åºé¸ï¼6ä¸ªæè½å¹´è½»1.4å²</a><br>Â· <a href="https://news.cnblogs.com/n/813567/" target="_blank" rel="noopener">Clawdbotä¸å¤ççº¢ï¼é¦ä¸ª0åå·¥å¬å¸è¯çï¼7Ã24hæ°¸ä¸ä¸ç­</a><br>Â· <a href="https://news.cnblogs.com/n/813795/" target="_blank" rel="noopener">å®æ¯ç¥ï¼ä¹æ¯æ¯ï¼Clawdbotæ¹åå·å¥åä¸è¯éªï¼æ´è®©ä½ ççµèâè£¸å¥â</a><br>Â· <a href="https://news.cnblogs.com/n/813844/" target="_blank" rel="noopener">Clawdbotç®åæ²¡æåä¸ä»·å¼ï¼ä½ç»âé¸¡èâçAI PCä»¬ä¸äºä¸è¯¾</a><br>Â· <a href="https://news.cnblogs.com/n/813575/" target="_blank" rel="noopener">ä»å®55åçiPhone 4Sï¼å¨æ¼å¤å¤å½»åºåç</a><br>Â· <a href="https://news.cnblogs.com/n/813679/" target="_blank" rel="noopener">èµ·åº32å²ç¨åºåçæ­»èåå¬å¸ï¼ä¸éåå·¥ä¼¤è®¤å® æ¾ç»39ä¸âå°å£è´¹â</a><br>Â· <a href="https://news.cnblogs.com/n/813772/" target="_blank" rel="noopener">å¿ç«¥æè¡¨å¸åºâå¤§åå¤©â</a><br>Â· <a href="https://news.cnblogs.com/n/813858/" target="_blank" rel="noopener">é©¬æ¯åè¢«æåå¹¶SpaceXåxAIï¼ä¼°å¼1.5ä¸äº¿ç¾åï¼å·¦æç«ç®­å³æAI</a><br>Â· <a href="https://news.cnblogs.com/n/813741/" target="_blank" rel="noopener">å¾å¡10äº¿æ¬§ååèº«ï¼ä¸ºä»ä¹å°ç±³ä¸å®ä¸è½ä¹°ï¼</a></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 09:04">2026-02-02 09:03</span>&nbsp;
<a href="https://www.cnblogs.com/cmt">åå®¢å­å¢é</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19562421);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19562421', targetLink: 'https://www.cnblogs.com/cmt/p/19562421', title: 'ä¸å¨ç­ç¹åé¡¾ï¼1.26-2.1ï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Docusaurus 3.x å° Astro 5.x è¿ç§»å®æï¼å©ç¨ Islands æ¶æå®ç°æ§è½ä¸æå»ºéåº¦åéæå ]]></title>
    <link>https://www.cnblogs.com/newbe36524/p/19562414</link>
    <guid>65e4eae6930a88334b81ee2d1372093c</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/newbe36524/p/19562414" title="åå¸äº 2026-02-02 09:01">
    <span role="heading" aria-level="2">Docusaurus 3.x å° Astro 5.x è¿ç§»å®æï¼å©ç¨ Islands æ¶æå®ç°æ§è½ä¸æå»ºéåº¦åéæå</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ä»-docusaurus-3x-å°-astro-5xhagicode-ç«ç¹è¿ç§»å®æå¤ç">ä» Docusaurus 3.x å° Astro 5.xï¼HagiCode ç«ç¹è¿ç§»å®æå¤ç</h1>
<blockquote>
<p>æ¬æå¤çäºæä»¬å° HagiCode å®æ¹ç½ç«ä» Docusaurus 3.x è¿ç§»è³ Astro 5.x çå¨è¿ç¨ãæä»¬å°æ·±å¥æ¢è®¨å¦ä½éè¿ Astro ç Islands æ¶æè§£å³æ§è½ç¶é¢ï¼åæ¶ä¿çç°æç React ç»ä»¶èµäº§ï¼å®ç°æå»ºéåº¦ä¸å è½½æ§è½çåéæåã</p>
</blockquote>

<h2 id="èæ¯">èæ¯</h2>
<p>2026 å¹´ 1 æï¼æä»¬å¯¹ HagiCode çå®æ¹ç«ç¹è¿è¡äºä¸æ¬¡"å¿èç§»æ¤ææ¯"ââå°æ ¸å¿æ¡æ¶ä» Docusaurus 3.x å¨é¢è¿ç§»è³ Astro 5.xãè¿ä¸æ¯ä¸æ¬¡å²å¨çå¤§éæï¼èæ¯ç»è¿æ·±æçèçææ¯ææ©ã</p>
<p>å¨è¿ç§»åï¼æä»¬çç«ç¹è½ç¶åè½å®åï¼ä½éæ¸æ¾é²åºä¸äº"å¯è´µç"ï¼æå»ºäº§ç©ä½ç§¯èè¿ãJavaScript è´è½½è¿é«ï¼ä¸é¡µé¢å è½½éåº¦å¨å¤æææ¡£é¡µé¢ä¸ä¸å¤çæ³ãä½ä¸ºä¸ä¸ª AI ä»£ç å©æé¡¹ç®ï¼HagiCode éè¦é¢ç¹æ´æ°ææ¡£ååè½ä»ç»ï¼æå»ºæçç´æ¥å½±ååå¸éåº¦ãåæ¶ï¼æä»¬å¸æç«ç¹å¯¹æç´¢å¼æï¼SEOï¼æ´å åå¥½ï¼ä»¥ä¾¿è®©æ´å¤å¼åèåç°è¿ä¸ªé¡¹ç®ã</p>
<p>ä¸ºäºè§£å³è¿äºçç¹ï¼æä»¬åäºä¸ä¸ªå¤§èçå³å®ï¼æ´ä¸ªæå»ºç³»ç»æ¨åéæ¥ï¼è¿ç§»å° Astroãè¿ä¸ªå³å®å¸¦æ¥çååï¼å¯è½æ¯ä½ æ³è±¡çè¿è¦å¤§ââç¨åæä¼å·ä½è¯´ã</p>
<h2 id="å³äº-hagicode">å³äº HagiCode</h2>
<p>æ¬æåäº«çç«ç¹è¿ç§»æ¹æ¡ï¼æ¥èªæä»¬å¨ <a href="https://github.com/HagiCode-org/site" target="_blank" rel="noopener nofollow">HagiCode</a> é¡¹ç®ä¸­çå®è·µç»éªã</p>
<p>HagiCode æ¯ä¸æ¬¾è´åäºæåå¼åæçç AI ä»£ç å©æï¼æä»¬ä¸ä»å³æ³¨æ ¸å¿åè½çè¿­ä»£ï¼åæ ·éè§å¼åèä½éªãè¿æ¬¡ç«ç¹çéæï¼ä¹æ¯ä¸ºäºè®©ç¨æ·å¨æµè§ææ¡£åå®ç½æ¶è½è·å¾æè´çå è½½éåº¦ã</p>
<h2 id="ä¸ºä»ä¹è¦æ¾å¼æçç-docusaurus">ä¸ºä»ä¹è¦æ¾å¼æçç Docusaurusï¼</h2>
<p>å¨ React çæä¸­ï¼Docusaurus ä¸ç´æ¯ææ¡£ç«ç¹ç"æ åç­æ¡"ãå®å¼ç®±å³ç¨ï¼æä»¶ä¸°å¯ï¼ç¤¾åºæ´»è·ãä½æ¯ï¼éç HagiCode åè½çå¢å ï¼æä»¬ä¹æåå°äºå®çå±éæ§ï¼</p>
<ol>
<li><strong>æ§è½ç¶é¢</strong>ï¼Docusaurus æ¬è´¨ä¸æ¯ä¸ä¸ª React SPAï¼åé¡µåºç¨ï¼ãåªæä½ æ¯åçº¯éæé¡µé¢ï¼å®¢æ·ç«¯ä¹éè¦å è½½ React è¿è¡æ¶å¹¶è¿è¡æ°´åï¼è¿å¯¹äºç®åçææ¡£é¡µé¢æ¥è¯´å¤ªéäºã</li>
<li><strong>èµæºä½ç§¯</strong>ï¼å³ä¾¿é¡µé¢åå®¹å¾å°ï¼æååç JS ä½ç§¯ä¹ç¸å¯¹åºå®ï¼è¿å¯¹ç§»å¨ç«¯ç¨æ·åç½ç»è¾å·®çç¯å¢ä¸å¤åå¥½ã</li>
<li><strong>çµæ´»æ§ä¸è¶³</strong>ï¼è½ç¶ä¹è½æ©å±ï¼ä½å¨æå»ºæµç¨çå®å¶ä¸ï¼æä»¬æ¸´ææ¥ææ´åºå±çæ§å¶æã</li>
</ol>
<p>Astro çåºç°æ­£å¥½è§£å³äºè¿äºé®é¢ãå®æä¾äºä¸ä¸ªå¨æ°ç"å²å±¿æ¶æ"ï¼Islands Architectureï¼ï¼é»è®¤æåµä¸ï¼Astro çæé¶ JavaScript çéæ HTMLï¼åªæéè¦äº¤äºçç»ä»¶æä¼"æ¿æ´»"å¹¶å è½½ JSãè¿æå³çæä»¬çç«ç¹å¤§é¨ååå®¹é½æ¯çº¯ HTMLï¼éåº¦æå¿«ã</p>
<h2 id="è¿ç§»æ ¸å¿ç­ç¥æ¶æå¹³æ»è¿æ¸¡">è¿ç§»æ ¸å¿ç­ç¥ï¼æ¶æå¹³æ»è¿æ¸¡</h2>
<p>è¿ç§»ä¸æ¯ç®åçå¤å¶ç²è´´ï¼èæ¯æç»´æ¨¡å¼çè½¬åãæä»¬ä» Docusaurus ç"å¨ React æ¨¡å¼"åæ¢å°äº Astro ç"Core + Islands"æ¨¡å¼ã</p>
<h3 id="1-éç½®ç³»ç»çéæ">1. éç½®ç³»ç»çéæ</h3>
<p>é¦åï¼æä»¬éè¦ä» <code>docusaurus.config.ts</code> è½¬å <code>astro.config.mjs</code>ãè¿ä¸ä»æ¯æä»¶åçååï¼æ´æ¯è·¯ç±åæå»ºé»è¾çéåã</p>
<p>å¨ Docusaurus ä¸­ï¼ä¸åçæä»¶ï¼èå¨ Astro ä¸­ï¼ä¸åçéæãæä»¬éè¦éæ°å®ä¹ç«ç¹çåºç¡è·¯å¾ãæå»ºè¾åºæ¨¡å¼ï¼éæ vs SSRï¼ä»¥åèµæºåç¼©ç­ç¥ã</p>
<p><strong>è¿ç§»åï¼</strong></p>
<pre><code class="language-typescript">// docusaurus.config.ts
export default {
  title: 'HagiCode',
  url: 'https://hagicode.com',
  baseUrl: '/',
  // ... æ´å¤éç½®
};
</code></pre>
<p><strong>è¿ç§»åï¼</strong></p>
<pre><code class="language-javascript">// astro.config.mjs
import { defineConfig } from 'astro/config';
import react from '@astrojs/react';

export default defineConfig({
  integrations: [react()],
  site: 'https://hagicode.com',
  base: '/',
  // éå¯¹éæèµæºçä¼åéç½®
  build: {
    inlineStylesheets: 'auto',
  },
});
</code></pre>
<h3 id="2-react-ç»ä»¶çå»çä¸æ¹é ">2. React ç»ä»¶çå»çä¸æ¹é </h3>
<p>è¿æ¯è¿ç§»ä¸­æå¤´ç¼çé¨åãæä»¬ç°æçç«ç¹æå¾å¤ React ç»ä»¶ï¼æ¯å¦ Tabs ç»ä»¶ãä»£ç é«äº®ãåé¦æé®ç­ï¼ãç´æ¥ææå¤ªå¯æï¼å¨é½ä¿çåä¼å¯¼è´ JS è´è½½è¿éã</p>
<p>HagiCode éç¨äº<strong>æ¸è¿å¼æ°´å</strong>ç­ç¥ï¼</p>
<ul>
<li><strong>çº¯éæç»ä»¶</strong>ï¼å¯¹äºå±ç¤ºååå®¹ï¼å¦é¡µçãé¡µèãçº¯ææ¬ææ¡£ï¼ï¼éåä¸º Astro ç»ä»¶ï¼<code>.astro</code> æä»¶ï¼ï¼å¨æå»ºæ¶ç´æ¥æ¸²æä¸º HTMLã</li>
<li><strong>äº¤äºå¼å²å±¿</strong>ï¼å¯¹äºå¿é¡»ä¿çäº¤äºçç»ä»¶ï¼å¦ä¸»é¢åæ¢å¨ãTabs åæ¢ãä»£ç åå¤å¶æé®ï¼ï¼ä¿ç React å®ç°ï¼å¹¶æ·»å  <code>client:load</code> æ <code>client:visible</code> æä»¤ã</li>
</ul>
<p>ä¾å¦ï¼æä»¬çææ¡£ä¸­å¸¸ç¨ç Tabs ç»ä»¶ï¼</p>
<pre><code class="language-jsx">// src/components/Tabs.jsx
import { useState } from 'react';
import './Tabs.css'; // å¼å¥æ ·å¼

export default function Tabs({ items }) {
  const [activeIndex, setActiveIndex] = useState(0);
  // ... ç¶æé»è¾
  return (
    &lt;div className="tabs-wrapper"&gt;
      {/* æ¸²æé»è¾ */}
    &lt;/div&gt;
  );
}
</code></pre>
<p>å¨ Markdown ä¸­ä½¿ç¨æ¶ï¼æä»¬æç¡®åè¯ Astroï¼"è¿ä¸ªç»ä»¶éè¦ JS"ï¼</p>
<pre><code class="language-markdown">// src/content/docs/example.mdx
import Tabs from '../../components/Tabs.jsx';

&lt;!-- åªå¨ç»ä»¶è¿å¥è§å£æ¶æå è½½ JS --&gt;
&lt;Tabs client:visible items={...} /&gt;
</code></pre>
<p>è¿æ ·ï¼éè§å£åçäº¤äºç»ä»¶ä¸ä¼æ¢å å¸¦å®½ï¼æå¤§å°ä¼åäºé¦å±å è½½éåº¦ã</p>
<h3 id="3-æ ·å¼ç³»ç»çéécss-modules-å°-scoped">3. æ ·å¼ç³»ç»çééï¼CSS Modules å° Scoped</h3>
<p>Docusaurus é»è®¤æ¯æ CSS Modulesï¼è Astro æ¨å´ä½¿ç¨ Scoped CSSï¼éè¿ <code>&lt;style&gt;</code> æ ç­¾ï¼ãä¸¤èçæ ¸å¿ææ³é½æ¯éç¦»æ ·å¼ï¼ä½è¯­æ³ä¸åã</p>
<p>å¨ HagiCode çè¿ç§»ä¸­ï¼æä»¬å°å¤§é¨åå¤æç CSS Modules æè§£ä¸º Astro ç Scoped æ ·å¼ãè¿å¶å®æ¯ä»¶å¥½äºï¼å ä¸ºå¨ <code>.astro</code> æä»¶ä¸­ï¼æ ·å¼åæ¨¡æ¿åå¨åä¸ä¸ªæä»¶éï¼ç»´æ¤èµ·æ¥æ´å ç´è§ã</p>
<p><strong>æ¹é åï¼</strong></p>
<pre><code class="language-css">/* Tabs.module.css */
.wrapper { background: var(--ifm-background-color); }
</code></pre>
<p><strong>æ¹é å (Astro Scoped):</strong></p>
<pre><code class="language-html">&lt;!-- Tabs.astro --&gt;
&lt;div class="tabs-wrapper"&gt;
  &lt;slot /&gt;
&lt;/div&gt;

&lt;style&gt;
  .tabs-wrapper {
    /* ç´æ¥ä½¿ç¨ CSS åéï¼ééä¸»é¢ */
    background: var(--bg-color);
    padding: 1rem;
  }
&lt;/style&gt;
</code></pre>
<p>åæ¶ï¼æä»¬ç»ä¸äºå¨å± CSS åéç³»ç»ï¼å©ç¨ Astro çç¯å¢æç¥è½åï¼ç¡®ä¿æè²æ¨¡å¼å¨ä¸åé¡µé¢é´çåæ¢æ ç¼è¡æ¥ã</p>
<h2 id="å®è·µä¸­çåä¸è§£å³æ¹æ¡">å®è·µä¸­çåä¸è§£å³æ¹æ¡</h2>
<p>å¨ HagiCode çå®éè¿ç§»è¿ç¨ä¸­ï¼æä»¬éå°äºä¸å°åï¼è¿éæå ä¸ªæå¸åçåäº«ä¸ä¸ã</p>
<h3 id="1-è·¯å¾ä¸ç¯å¢åéççç¹">1. è·¯å¾ä¸ç¯å¢åéççç¹</h3>
<p>HagiCode æ¯æå­è·¯å¾é¨ç½²ï¼æ¯å¦é¨ç½²å° GitHub Pages çå­ç®å½ï¼ãå¨ Docusaurus ä¸­ï¼å®èªå¨å¤ç <code>baseUrl</code>ãä½å¨ Astro ä¸­ï¼å¤çå¾çé¾æ¥å API è¯·æ±æ¶ï¼æä»¬éè¦æ´å°å¿ã</p>
<p>æä»¬å¼å¥äºç¯å¢åéæºå¶æ¥ç»ä¸ç®¡çï¼</p>
<pre><code class="language-javascript">// å¨æå»ºèæ¬ä¸­å¤çè·¯å¾
const getBasePath = () =&gt; import.meta.env.VITE_SITE_BASE || '/';
</code></pre>
<p>åè®°ï¼ä¸è¦å¨ä»£ç ä¸­ç¡¬ç¼ç  <code>/</code> å¼å¤´çè·¯å¾ãå¨å¼åç¯å¢åçäº§ç¯å¢ï¼æèéç½®äº <code>base</code> è·¯å¾åï¼è¿ä¼å¯¼è´èµæº 404ã</p>
<h3 id="2-commonjs-èæ¬çå¼å®¹">2. CommonJS èæ¬çå¼å®¹</h3>
<p>æä»¬çæ§ç«ç¹æä¸äº Node.js èæ¬ï¼ç¨äºèªå¨æå Metrics æ°æ®ãæ´æ° sitemap ç­ï¼ï¼å®ä»¬æ¯ç¨ CommonJS (<code>require</code>) åçãAstro åç°ä»£æå»ºå·¥å·å¨é¢æ¥æ± ES Modules (<code>import</code>/<code>export</code>)ã</p>
<p>å¦æä½ ä¹æç±»ä¼¼çèæ¬ï¼è®°å¾æå®ä»¬å¨é¨éæä¸º ES Modulesãè¿æ¯å¤§å¿æè¶ï¼æ©ç¹æ¹äºæ©ç¹çå¿ã</p>
<pre><code class="language-javascript">// æ§æ¹å¼
const fs = require('fs');

// æ°æ¹å¼
import fs from 'fs';
</code></pre>
<h3 id="3-å«å¿äº-seo-ä¸éå®å">3. å«å¿äº SEO ä¸éå®å</h3>
<p>æç´¢å¼æå·²ç»æ¶å½äº HagiCode æ§ç Docusaurus é¡µé¢ãå¦æç´æ¥åå° Astroï¼URL ç»æåçååï¼ä¼å¯¼è´å¤§é 404ï¼æéå¤§è·ã</p>
<p>æä»¬å¨ Astro ä¸­éç½®äºéå®åè§åï¼</p>
<pre><code class="language-javascript">// astro.config.mjs
export default defineConfig({
  redirects: {
    '/docs/old-path': '/docs/new-path',
    // æ¹éæ å°æ§é¾æ¥å°æ°é¾æ¥
  }
});
</code></pre>
<p>æèå¨æå¡å¨éç½®å±é¢å¤çãç¡®ä¿æ§é¾æ¥è½ 301 éå®åå°æ°å°åï¼è¿å¯¹ SEO è³å³éè¦ã</p>
<h2 id="æ»ç»">æ»ç»</h2>
<p>ä» Docusaurus è¿ç§»å° Astroï¼å¯¹ HagiCode æ¥è¯´ï¼ä¸ä»ä»æ¯ä¸æ¬¡æ¡æ¶åçº§ï¼æ´æ¯ä¸æ¬¡å¯¹"æ§è½ä¼å"çå¿µçå®è·µã</p>
<p><strong>æä»¬çæ¶è·ï¼</strong></p>
<ul>
<li><strong>æè´ç Lighthouse åæ°</strong>ï¼è¿ç§»åï¼HagiCode ç«ç¹çæ§è½è¯åè½»æ¾æ¥è¿æ»¡åã</li>
<li><strong>æ´å¿«çæå»ºéåº¦</strong>ï¼Astro çå¢éæå»ºè®©æä»¬ææ¡£æ´æ°çåå¸æ¶é´ç¼©ç­äºä¸åã</li>
<li><strong>ä¿çäºçµæ´»æ§</strong>ï¼éè¿ Islands æ¶æï¼æä»¬æ²¡æçºç²ä»»ä½äº¤äºåè½ï¼ä¾ç¶å¯ä»¥å¨éè¦çå°æ¹ä½¿ç¨ Reactã</li>
</ul>
<p>å¦æä½ ä¹å¨ç»´æ¤ææ¡£åç«ç¹ï¼å¹¶ä¸æ·±åæåä½ç§¯æå è½½éåº¦çå°æ°ï¼ä¸å¦¨è¯è¯ Astroãè½ç¶è¿ç§»è¿ç¨éè¦å¨å¨ææ¯ï¼æ¯å¦æ PCode çåå­æ¹æ HagiCodeï¼æç»ä»¶ä¸ä¸ªä¸ªæè¿æ¥ï¼ï¼ä½æ¢æ¥çæ¯å¦ä¸è¬é¡ºæ»çç¨æ·ä½éªï¼ç»å¯¹å¼å¾ã</p>
<p>æ¬æåäº«çæå»ºç³»ç»ï¼æ­£æ¯æä»¬å¨å¼å HagiCode è¿ç¨ä¸­å®éè¸©åãå®éä¼ååºæ¥çæ¹æ¡ãå¦æä½ è§å¾è¿å¥æ¹æ¡æä»·å¼ï¼è¯´ææä»¬çå·¥ç¨å®åè¿ä¸éââé£ä¹ HagiCode æ¬èº«ä¹å¼å¾å³æ³¨ä¸ä¸ã</p>
<h2 id="åèèµæ">åèèµæ</h2>
<ul>
<li><a href="https://docs.astro.build" target="_blank" rel="noopener nofollow">Astro å®æ¹ææ¡£</a></li>
<li><a href="https://docs.astro.build/en/guides/migrate-to-astro/migrate-from-docusaurus/" target="_blank" rel="noopener nofollow">ä» Docusaurus è¿ç§»æå</a></li>
<li><a href="https://docs.astro.build/en/core-concepts/islands/" target="_blank" rel="noopener nofollow">Islands æ¶æè¯¦è§£</a></li>
<li><strong>HagiCode é¡¹ç®å°å</strong>ï¼<a href="https://github.com/HagiCode-org/site" target="_blank" rel="noopener nofollow">github.com/HagiCode-org/site</a></li>
<li><strong>HagiCode å®ç½</strong>ï¼<a href="https://hagicode-org.github.io/site" target="_blank" rel="noopener nofollow">hagicode-org.github.io/site</a></li>
<li><strong>ä¸é®å®è£ä½éª</strong>ï¼<a href="https://hagicode-org.github.io/site/docs/installation/docker-compose" target="_blank" rel="noopener nofollow">hagicode-org.github.io/site/docs/installation/docker-compose</a></li>
</ul>
<p>å¦ææ¬æå¯¹ä½ æå¸®å©ï¼æ¬¢è¿æ¥ GitHub ç»ä¸ª Starï¼å¬æµå·²ç»å¼å§å¦ï¼</p>
<hr>
<p>æè°¢æ¨çéè¯»,å¦ææ¨è§å¾æ¬ææç¨,å¿«ç¹å»ä¸æ¹ç¹èµæé®ð,è®©æ´å¤çäººçå°æ¬æã</p>
<p>æ¬åå®¹éç¨äººå·¥æºè½è¾å©åä½,ç»æ¬äººå®¡æ ¸,ç¬¦åæ¬äººè§ç¹ä¸ç«åºã</p>
<ul>
<li><strong>æ¬æä½è:</strong> <a href="https://www.newbe.pro" target="_blank" rel="noopener nofollow">newbe36524</a></li>
<li><strong>æ¬æé¾æ¥:</strong> <a href="https://hagicode-org.github.io/site/blog/2026-01-31-migrate-docusaurus-to-astro-with-islands-architecture/" target="_blank" rel="noopener nofollow">https://hagicode-org.github.io/site/blog/2026-01-31-migrate-docusaurus-to-astro-with-islands-architecture/</a></li>
<li><strong>çæå£°æ:</strong> æ¬åå®¢æææç« é¤ç¹å«å£°æå¤,åéç¨ BY-NC-SA è®¸å¯åè®®ãè½¬è½½è¯·æ³¨æåºå¤!</li>
</ul>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 09:02">2026-02-02 09:01</span>&nbsp;
<a href="https://www.cnblogs.com/newbe36524">Newbe36524</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19562414);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19562414', targetLink: 'https://www.cnblogs.com/newbe36524/p/19562414', title: 'Docusaurus 3.x å° Astro 5.x è¿ç§»å®æï¼å©ç¨ Islands æ¶æå®ç°æ§è½ä¸æå»ºéåº¦åéæå' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ çº¿ç¨å¦ä½åæ­¢ï¼çº¿ç¨ä¹é´å¦ä½åä½ï¼çº¿ç¨ä¹é´çå¼å¸¸å¦ä½å¤çï¼ ]]></title>
    <link>https://www.cnblogs.com/sevencoding/p/19557016</link>
    <guid>6a3ef6501da093450ae8eeb80e799426</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/sevencoding/p/19557016" title="åå¸äº 2026-02-02 09:00">
    <span role="heading" aria-level="2">çº¿ç¨å¦ä½åæ­¢ï¼çº¿ç¨ä¹é´å¦ä½åä½ï¼çº¿ç¨ä¹é´çå¼å¸¸å¦ä½å¤çï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="çº¿ç¨åæ­¢">çº¿ç¨åæ­¢</h2>
<h3 id="stopæ¹æ³">stopæ¹æ³</h3>
<p>stop æ¹æ³è½ç¶å¯ä»¥åæ­¢çº¿ç¨ï¼ä½å®å·²ç»æ¯ä¸å»ºè®®ä½¿ç¨çåºå¼æ¹æ³äºï¼è¿ä¸ç¹å¯ä»¥éè¿ Thread ç±»ä¸­çæºç åç°ï¼stop æºç å¦ä¸ï¼</p>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202404251004858.gif" alt="" loading="lazy"></p>
<p>stop æ¹æ³æ¯è¢« @Deprecated ä¿®é¥°çä¸å»ºè®®ä½¿ç¨çè¿ææ¹æ³ï¼å¹¶ä¸å¨æ³¨éçç¬¬ä¸å¥è¯å°±è¯´æäº stop æ¹æ³ä¸ºéå®å¨çæ¹æ³ã</p>
<p>åå å¨äºå®å¨ç»æ­¢ä¸ä¸ªçº¿ç¨æ¶ä¼å¼ºå¶ä¸­æ­çº¿ç¨çæ§è¡ï¼ä¸ç®¡runæ¹æ³æ¯å¦æ§è¡å®äºï¼å¹¶ä¸è¿ä¼éæ¾è¿ä¸ªçº¿ç¨æææçææçéå¯¹è±¡ãè¿ä¸ç°è±¡ä¼è¢«å¶å®å ä¸ºè¯·æ±éèé»å¡ççº¿ç¨çå°ï¼ä½¿ä»ä»¬ç»§ç»­åä¸æ§è¡ãè¿å°±ä¼é ææ°æ®çä¸ä¸è´ã</p>
<p>æ¯å¦é¶è¡è½¬è´¦ï¼ä»Aè´¦æ·åBè´¦æ·è½¬è´¦500åï¼è¿ä¸è¿ç¨åä¸ºä¸æ­¥ï¼ç¬¬ä¸æ­¥æ¯ä»Aè´¦æ·ä¸­åå»500åï¼åå¦å°è¿æ¶çº¿ç¨å°±è¢«stopäºï¼é£ä¹è¿ä¸ªçº¿ç¨å°±ä¼éæ¾å®æåå¾éï¼ç¶åå¶ä»ççº¿ç¨ç»§ç»­æ§è¡ï¼è¿æ ·Aè´¦æ·å°±è«åå¶å¦çå°äº500åèBè´¦æ·ä¹æ²¡ææ¶å°é±ãè¿å°±æ¯stopæ¹æ³çä¸å®å¨æ§ã</p>
<h3 id="è®¾ç½®æ å¿ä½">è®¾ç½®æ å¿ä½</h3>
<p>å¦æçº¿ç¨çrunæ¹æ³ä¸­æ§è¡çæ¯ä¸ä¸ªéå¤æ§è¡çå¾ªç¯ï¼å¯ä»¥æä¾ä¸ä¸ªæ è®°æ¥æ§å¶å¾ªç¯æ¯å¦ç»§ç»­</p>
<pre><code class="language-java">class FlagThread extends Thread {
    // èªå®ä¹ä¸­æ­æ è¯ç¬¦
    public volatile boolean isInterrupt = false;
    @Override
    public void run() {
        // å¦æä¸º true -&gt; ä¸­æ­æ§è¡
        while (!isInterrupt) {
            // ä¸å¡é»è¾å¤ç
        }
    }
}
</code></pre>
<p>ä½èªå®ä¹ä¸­æ­æ è¯ç¬¦çé®é¢å¨äºï¼çº¿ç¨ä¸­æ­çä¸å¤åæ¶ãå ä¸ºçº¿ç¨å¨æ§è¡è¿ç¨ä¸­ï¼æ æ³è°ç¨ while(!isInterrupt) æ¥å¤æ­çº¿ç¨æ¯å¦ä¸ºç»æ­¢ç¶æï¼å®åªè½å¨ä¸ä¸è½®è¿è¡æ¶å¤æ­æ¯å¦è¦ç»æ­¢å½åçº¿ç¨ï¼æä»¥å®ä¸­æ­çº¿ç¨ä¸å¤åæ¶ï¼æ¯å¦ä»¥ä¸ä»£ç ï¼</p>
<pre><code class="language-java">class InterruptFlag {
    // èªå®ä¹çä¸­æ­æ è¯ç¬¦
    private static volatile boolean isInterrupt = false;

    public static void main(String[] args) throws InterruptedException {
        // åå»ºå¯ä¸­æ­ççº¿ç¨å®ä¾
        Thread thread = new Thread(() -&gt; {
            while (!isInterrupt) { // å¦æ isInterrupt=true ååæ­¢çº¿ç¨
                System.out.println("thread æ§è¡æ­¥éª¤1ï¼çº¿ç¨å³å°è¿å¥ä¼ç ç¶æ");
                try {
                    // ä¼ç  1s
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                System.out.println("thread æ§è¡æ­¥éª¤2ï¼çº¿ç¨æ§è¡äºä»»å¡");
            }
        });
        thread.start(); // å¯å¨çº¿ç¨

        // ä¼ç  100msï¼ç­å¾ thread çº¿ç¨è¿è¡èµ·æ¥
        Thread.sleep(100);
        System.out.println("ä¸»çº¿ç¨ï¼è¯å¾ç»æ­¢çº¿ç¨ thread");
        // ä¿®æ¹ä¸­æ­æ è¯ç¬¦ï¼ä¸­æ­çº¿ç¨
        isInterrupt = true;
    }
}
</code></pre>
<p>è¾åºï¼æä»¬ææçæ¯ï¼çº¿ç¨æ§è¡äºæ­¥éª¤ 1 ä¹åï¼æ¶å°ä¸­æ­çº¿ç¨çæä»¤ï¼ç¶åå°±ä¸è¦åæ§è¡æ­¥éª¤ 2 äºï¼ä½ä»ä¸è¿°æ§è¡ç»æå¯ä»¥çåºï¼ä½¿ç¨èªå®ä¹ä¸­æ­æ è¯ç¬¦æ¯æ²¡åæ³å®ç°æä»¬é¢æçç»æçï¼è¿å°±æ¯èªå®ä¹ä¸­æ­æ è¯ç¬¦ï¼ååºä¸å¤åæ¶çé®é¢ã</p>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202404251004853.gif" alt="" loading="lazy"></p>
<h3 id="interruptedä¸­æ­">interruptedä¸­æ­</h3>
<p>è¿ç§æ¹å¼éè¦å¨whileå¾ªç¯ä¸­å¤æ­ä½¿ç¨</p>
<p>ä½¿ç¨ interrupt æ¹æ³å¯ä»¥ç»æ§è¡ä»»å¡ççº¿ç¨ï¼åéä¸ä¸ªä¸­æ­çº¿ç¨çæä»¤ï¼å®å¹¶ä¸ç´æ¥ä¸­æ­çº¿ç¨ï¼èæ¯åéä¸ä¸ªä¸­æ­çº¿ç¨çä¿¡å·ï¼ææ¯å¦æ­£å¨ä¸­æ­çº¿ç¨çä¸»å¨æäº¤ç»ä»£ç ç¼åèãç¸æ¯äºèªå®ä¹ä¸­æ­æ è¯ç¬¦èç¶ï¼å®è½æ´åæ¶çæ¥æ¶å°ä¸­æ­æä»¤ï¼å¦ä¸ä»£ç æç¤ºï¼</p>
<pre><code class="language-java">public static void main(String[] args) throws InterruptedException {
    // åå»ºå¯ä¸­æ­ççº¿ç¨å®ä¾
    Thread thread = new Thread(() -&gt; {
        while (!Thread.currentThread().isInterrupted()) {
            System.out.println("thread æ§è¡æ­¥éª¤1ï¼çº¿ç¨å³å°è¿å¥ä¼ç ç¶æ");
            try {
                // ä¼ç  1s
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                System.out.println("thread çº¿ç¨æ¥æ¶å°ä¸­æ­æä»¤ï¼æ§è¡ä¸­æ­æä½");
                // ä¸­æ­å½åçº¿ç¨çä»»å¡æ§è¡
                break;
            }
            System.out.println("thread æ§è¡æ­¥éª¤2ï¼çº¿ç¨æ§è¡äºä»»å¡");
        }
    });
    thread.start(); // å¯å¨çº¿ç¨

    // ä¼ç  100msï¼ç­å¾ thread çº¿ç¨è¿è¡èµ·æ¥
    Thread.sleep(100);
    System.out.println("ä¸»çº¿ç¨ï¼è¯å¾ç»æ­¢çº¿ç¨ thread");
    // ä¿®æ¹ä¸­æ­æ è¯ç¬¦ï¼ä¸­æ­çº¿ç¨
    thread.interrupt();
}
</code></pre>
<p>è¾åºï¼</p>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202404251004555.gif" alt="" loading="lazy"></p>
<p>ä»ä¸è¿°ç»æå¯ä»¥çåºï¼çº¿ç¨å¨æ¥æ¶å°ä¸­æ­æä»¤ä¹åï¼ç«å³ä¸­æ­äºçº¿ç¨ï¼ç¸æ¯äºä¸ä¸ç§èªå®ä¹ä¸­æ­æ è¯ç¬¦çæ¹æ³æ¥è¯´ï¼å®è½æ´åæ¶çååºä¸­æ­çº¿ç¨æä»¤ã</p>
<h3 id="å©ç¨interruptedexception">å©ç¨interruptedException</h3>
<p>è¿ç§æ¹å¼ ä¸ éè¦å¨whileå¾ªç¯ä¸­å¤æ­ä½¿ç¨</p>
<p>å¦æçº¿ç¨å ä¸ºæ§è¡join()ï¼sleepæèwait()èè¿å¥é»å¡ç¶æï¼æ­¤æ¶æ³è¦åæ­¢å®ï¼å¯ä»¥è°ç¨interrupt()ï¼ç¨åºä¼æåºinterruptedExceptionå¼å¸¸ãå¯ä»¥å©ç¨è¿ä¸ªå¼å¸¸ç»æ­¢çº¿ç¨</p>
<pre><code class="language-java">public void run() {
    System.out.println(this.getName() + "start");
    int i=0;
    //while (!Thread.interrupted()){
    while (!Thread.currentThread().isInterrupted()){
        try {
            Thread.sleep(10000);
        } catch (InterruptedException e) {
            //e.printStackTrace();
            System.out.println("ä¸­æ­çº¿ç¨");
            break;//éè¿è¯å«å°å¼å¸¸æ¥ä¸­æ­
        }
        System.out.println(this.getName() + " "+ i);
        i++;
    }
    System.out.println(this.getName() + "end");
}
</code></pre>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202404251004577.gif" alt="" loading="lazy"></p>
<h3 id="executor-çä¸­æ­æä½">Executor çä¸­æ­æä½</h3>
<p>è°ç¨ Executor ç shutdown() æ¹æ³ä¼ç­å¾çº¿ç¨é½æ§è¡å®æ¯ä¹ååå³é­ï¼ä½æ¯å¦æè°ç¨çæ¯ shutdownNow() æ¹æ³ï¼åç¸å½äºè°ç¨æ¯ä¸ªçº¿ç¨ç interrupt() æ¹æ³ã</p>
<p>ä»¥ä¸ä½¿ç¨ Lambda åå»ºçº¿ç¨ï¼ç¸å½äºåå»ºäºä¸ä¸ªå¿ååé¨çº¿ç¨ã</p>
<pre><code class="language-java">public static void main(String[] args) {
    ExecutorService executorService = Executors.newCachedThreadPool();
    executorService.execute(() -&gt; {
        try {
            Thread.sleep(2000);
            System.out.println("Thread run");
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    });
    executorService.shutdownNow();
    System.out.println("Main run");
}
</code></pre>
<pre><code class="language-java">Main run
java.lang.InterruptedException: sleep interrupted
    at java.lang.Thread.sleep(Native Method)
    at ExecutorInterruptExample.lambda$main$0(ExecutorInterruptExample.java:9)
    at ExecutorInterruptExample$$Lambda$1/1160460865.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
    at java.lang.Thread.run(Thread.java:745)
</code></pre>
<p>å¦æåªæ³ä¸­æ­ Executor ä¸­çä¸ä¸ªçº¿ç¨ï¼å¯ä»¥éè¿ä½¿ç¨ submit() æ¹æ³æ¥æäº¤ä¸ä¸ªçº¿ç¨ï¼å®ä¼è¿åä¸ä¸ª <code>Future&lt;?&gt;</code> å¯¹è±¡ï¼éè¿è°ç¨è¯¥å¯¹è±¡ç cancel(true) æ¹æ³å°±å¯ä»¥ä¸­æ­çº¿ç¨ã</p>
<pre><code class="language-java">Future&lt;?&gt; future = executorService.submit(() -&gt; {
    // ..
});
future.cancel(true);
</code></pre>
<h2 id="çº¿ç¨ä¹é´çåä½">çº¿ç¨ä¹é´çåä½</h2>
<p>å½å¤ä¸ªçº¿ç¨å¯ä»¥ä¸èµ·å·¥ä½å»è§£å³æä¸ªé®é¢æ¶ï¼å¦ææäºé¨åå¿é¡»å¨å¶å®é¨åä¹åå®æï¼é£ä¹å°±éè¦å¯¹çº¿ç¨è¿è¡åè°ã</p>
<h3 id="join">join()</h3>
<h4 id="æ¡ä¾">æ¡ä¾</h4>
<p>å¨çº¿ç¨ä¸­è°ç¨å¦ä¸ä¸ªçº¿ç¨ç join() æ¹æ³ï¼ä¼å°å½åçº¿ç¨æèµ·ï¼èä¸æ¯å¿ç­å¾ï¼ç´å°ç®æ çº¿ç¨ç»æã</p>
<p>å¯¹äºä»¥ä¸ä»£ç ï¼è½ç¶ b çº¿ç¨åå¯å¨ï¼ä½æ¯å ä¸ºå¨ b çº¿ç¨ä¸­è°ç¨äº a çº¿ç¨ç join() æ¹æ³ï¼b çº¿ç¨ä¼ç­å¾ a çº¿ç¨ç»ææç»§ç»­æ§è¡ï¼å æ­¤æåè½å¤ä¿è¯ a çº¿ç¨çè¾åºåäº b çº¿ç¨çè¾åºã</p>
<pre><code class="language-java">public class JoinExample {

    private class A extends Thread {
        @Override
        public void run() {
            System.out.println("A");
        }
    }

    private class B extends Thread {

        private A a;

        B(A a) {
            this.a = a;
        }

        @Override
        public void run() {
            try {
                a.join();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            System.out.println("B");
        }
    }

    public void test() {
        A a = new A();
        B b = new B(a);
        b.start();
        a.start();
    }
}
</code></pre>
<pre><code class="language-java">public static void main(String[] args) {
    JoinExample example = new JoinExample();
    example.test();
}
</code></pre>
<pre><code class="language-java">A
B
</code></pre>
<h4 id="åç">åç</h4>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202404251004601.gif" alt="" loading="lazy"></p>
<pre><code class="language-java">public final synchronized void join(long millis)
throws InterruptedException {
    long base = System.currentTimeMillis();
    long now = 0;

    if (millis &lt; 0) {
        throw new IllegalArgumentException("timeout value is negative");
    }

    if (millis == 0) {
        while (isAlive()) {//æ£æ¥çº¿ç¨æ¯å¦å­æ´»ï¼åªè¦çº¿ç¨è¿æ²¡ç»æï¼ä¸»çº¿ç¨å°±ä¼ä¸ç´é»å¡
            wait(0);//è¿éçwaitè°ç¨çæ¬å°æ¹æ³ã
        }
    } else {//ç­å¾ä¸æ®µæå®çæ¶é´
        while (isAlive()) {
            long delay = millis - now;
            if (delay &lt;= 0) {
                break;
            }
            wait(delay);
            now = System.currentTimeMillis() - base;
        }
    }
}
</code></pre>
<p>ä»æºç æ¥çï¼å®éä¸joinæ¹æ³å°±æ¯è°ç¨äºwaitæ¹æ³æ¥ä½¿å¾çº¿ç¨é»å¡ï¼ä¸ç´å°çº¿ç¨ç»æè¿è¡ãæ³¨æå°ï¼joinæ¹æ³åçsynchronizedä¿®é¥°ç¬¦ï¼å®ç¸å½äºï¼</p>
<pre><code class="language-java">public final void join(long millis){
 synchronized(this){
        //ä»£ç å
    }
}
</code></pre>
<p>ä¹å°±æ¯è¯´å éçå¯¹è±¡å³è°ç¨è¿ä¸ªéççº¿ç¨å¯¹è±¡ï¼å¨main()æ¹æ³ä¸­å³ä¸ºt1ï¼ææè¿ä¸ªéçæ¯ä¸»çº¿ç¨å³main()æ¹æ³ï¼ä¹å°±æ¯è¯´ä»£ç ç¸å½äºå¦ä¸ï¼</p>
<pre><code class="language-java">//t1.join()åçä»£ç 
synchronized (t1) {
 // è°ç¨èçº¿ç¨è¿å¥ t1 ç waitSet ç­å¾, ç´å° t1 è¿è¡ç»æ
 while (t1.isAlive()) {
  t1.wait(0);
 }
}
//t1.join()åçä»£ç 
</code></pre>
<p>ä¹å æ­¤ä¸»çº¿ç¨è¿å¥ç­å¾éåï¼ç´å° t1 çº¿ç¨ç»æã</p>
<blockquote>
<p>è¿éå¯è½ä¼æå¾å¤äººä¼æçæï¼ä¸ºä»ä¹t1.waitäºï¼é»å¡çä¸æ¯t1ï¼èæ¯ä¸»çº¿ç¨ï¼</p>
<p>å®éä¸ï¼å¦æè¦é»å¡t1ï¼é£ä¹å°±åºè¯¥å¨t1çrun æ¹æ³éè¿è¡é»å¡ï¼å¦å¨runæ¹æ³éåwait()ï¼ï¼å½ç¶è¿æsuspendæ¹æ³ï¼è¿å±äºéJavaå±é¢ï¼å¦è¯´ï¼</p>
<p>èè¿éç wait æ¹æ³è¢«è°ç¨ä»¥åï¼æ¯è®©ææéççº¿ç¨è¿å¥ç­å¾éåï¼å³ä¸»çº¿ç¨è°ç¨ï¼å æ­¤ t1 çº¿ç¨å¹¶ä¸ä¼è¢«é»å¡ï¼é»å¡çæ¯ä¸»çº¿ç¨ã</p>
</blockquote>
<p>ä¹å°±æ¯è¯´ï¼joinæ¹æ³æ¯ä¸ä¸ªåæ­¥æ¹æ³ï¼å½ä¸»çº¿ç¨è°ç¨t1.join()æ¹æ³æ¶ï¼ä¸»çº¿ç¨åè·å¾äºt1å¯¹è±¡çéï¼éåè¿å¥æ¹æ³ï¼è°ç¨äºt1å¯¹è±¡çwait()æ¹æ³ï¼ä½¿ä¸»çº¿ç¨è¿å¥äºt1å¯¹è±¡çç­å¾æ± ã</p>
<p>é£ä¹é®é¢å¨äºï¼è¿éåªçå°äºwaitæ¹æ³ï¼å´å¹¶æ²¡æçå°notifyæèæ¯notifyAllæ¹æ³ï¼é£ä¹ä¸»çº¿ç¨å¨é£éè¢«å¤éå¢ï¼</p>
<p>è¿éåèjvmçä»£ç ï¼</p>
<pre><code class="language-java">static void ensure_join(JavaThread* thread) {

 Handle threadObj(thread, thread-&gt;threadObj());

 ObjectLocker lock(threadObj, thread);

 hread-&gt;clear_pending_exception();

 //è¿ä¸å¥ä¸­çTERMINATEDè¡¨ç¤ºè¿æ¯çº¿ç¨ç»æä»¥åè¿è¡ç
 java_lang_Thread::set_thread_status(threadObj(), java_lang_Thread::TERMINATED);

    //è¿éä¼æ¸æ¥nativeçº¿ç¨ï¼isAlive()æ¹æ³ä¼è¿åfalse
    java_lang_Thread::set_thread(threadObj(), NULL);

 //threadå°±æ¯å½åçº¿ç¨ï¼è°ç¨è¿ä¸ªæ¹æ³å¤éç­å¾ççº¿ç¨ã
 lock.notify_all(thread);

 hread-&gt;clear_pending_exception();

}
</code></pre>
<p>å¶å®æ¯jvmèææºä¸­å­å¨æ¹æ³lock.notify_all(thread)ï¼å¨t1çº¿ç¨ç»æä»¥åï¼ä¼è°ç¨è¯¥æ¹æ³ï¼æåå¤éä¸»çº¿ç¨ã</p>
<p>æä»¥ç®åä¸ä¸ï¼æµç¨å³ï¼</p>
<p><img src="https://seven97-blog.oss-cn-hangzhou.aliyuncs.com/imgs/202404251004626.gif" alt="" loading="lazy"></p>
<h3 id="wait-notify-notifyall">wait() notify() notifyAll()</h3>
<p>è°ç¨ wait() ä½¿å¾çº¿ç¨ç­å¾æä¸ªæ¡ä»¶æ»¡è¶³ï¼çº¿ç¨å¨ç­å¾æ¶ä¼è¢«æèµ·ï¼å½å¶ä»çº¿ç¨çè¿è¡ä½¿å¾è¿ä¸ªæ¡ä»¶æ»¡è¶³æ¶ï¼å¶å®çº¿ç¨ä¼è°ç¨ notify() æè notifyAll() æ¥å¤éæèµ·ççº¿ç¨ã</p>
<p>å®ä»¬é½å±äº Object çä¸é¨åï¼èä¸å±äº Threadã</p>
<p>åªè½ç¨å¨åæ­¥æ¹æ³synchronizedæèåæ­¥æ§å¶åä¸­ä½¿ç¨ï¼å¦åä¼å¨è¿è¡æ¶æåº IllegalMonitorStateExeceptionã</p>
<p>ä½¿ç¨ wait() æèµ·æé´ï¼çº¿ç¨ä¼éæ¾éãè¿æ¯å ä¸ºï¼å¦ææ²¡æéæ¾éï¼é£ä¹å¶å®çº¿ç¨å°±æ æ³è¿å¥å¯¹è±¡çåæ­¥æ¹æ³æèåæ­¥æ§å¶åä¸­ï¼é£ä¹å°±æ æ³æ§è¡ notify() æè notifyAll() æ¥å¤éæèµ·ççº¿ç¨ï¼é ææ­»éã</p>
<pre><code class="language-java">public class WaitNotifyExample {
    public synchronized void before() {
        System.out.println("before");
        notifyAll();
    }

    public synchronized void after() {
        try {
            wait();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println("after");
    }
}
</code></pre>
<pre><code class="language-java">public static void main(String[] args) {
    ExecutorService executorService = Executors.newCachedThreadPool();
    WaitNotifyExample example = new WaitNotifyExample();
    executorService.execute(() -&gt; example.after());
    executorService.execute(() -&gt; example.before());
}
</code></pre>
<pre><code class="language-java">before
after
</code></pre>
<p><strong>wait() å sleep() çåºå«</strong></p>
<ul>
<li>
<p>wait() æ¯ Object çæ¹æ³ï¼è sleep() æ¯ Thread çéææ¹æ³ï¼</p>
</li>
<li>
<p>wait() ä¼éæ¾éï¼sleep() ä¸ä¼ã</p>
</li>
</ul>
<h3 id="await-signal-signalall">await() signal() signalAll()</h3>
<p>java.util.concurrent ç±»åºä¸­æä¾äº Condition ç±»æ¥å®ç°çº¿ç¨ä¹é´çåè°ï¼å¯ä»¥å¨ Condition ä¸è°ç¨ await() æ¹æ³ä½¿çº¿ç¨ç­å¾ï¼å¶å®çº¿ç¨è°ç¨ signal() æ signalAll() æ¹æ³å¤éç­å¾ççº¿ç¨ãç¸æ¯äº wait() è¿ç§ç­å¾æ¹å¼ï¼await() å¯ä»¥æå®ç­å¾çæ¡ä»¶ï¼å æ­¤æ´å çµæ´»ã</p>
<p>ä½¿ç¨ Lock æ¥è·åä¸ä¸ª Condition å¯¹è±¡ã</p>
<pre><code class="language-java">public class AwaitSignalExample {
    private Lock lock = new ReentrantLock();
    private Condition condition = lock.newCondition();

    public void before() {
        lock.lock();
        try {
            System.out.println("before");
            condition.signalAll();
        } finally {
            lock.unlock();
        }
    }

    public void after() {
        lock.lock();
        try {
            condition.await();
            System.out.println("after");
        } catch (InterruptedException e) {
            e.printStackTrace();
        } finally {
            lock.unlock();
        }
    }
}
</code></pre>
<pre><code class="language-java">public static void main(String[] args) {
    ExecutorService executorService = Executors.newCachedThreadPool();
    AwaitSignalExample example = new AwaitSignalExample();
    executorService.execute(() -&gt; example.after());
    executorService.execute(() -&gt; example.before());
}
</code></pre>
<pre><code class="language-java">before
after
</code></pre>
<h2 id="çº¿ç¨ä¸­çå¼å¸¸å¤ç">çº¿ç¨ä¸­çå¼å¸¸å¤ç</h2>
<h3 id="runnableä¸­å¼å¸¸å¦ä½è¢«åæ">Runnableä¸­å¼å¸¸å¦ä½è¢«åæ</h3>
<p><code>Runnable</code> æ¥å£ç <code>run()</code> æ¹æ³ä¸åè®¸æåºä»»ä½è¢«æ£æ¥çå¼å¸¸ï¼checked exceptionsï¼ï¼åªè½å¤çææåºè¿è¡æ¶å¼å¸¸ï¼unchecked exceptionsï¼ãå½å¨ <code>run()</code> æ¹æ³ååçå¼å¸¸æ¶ï¼å¦ææ²¡ææ¾å¼å°æè·åå¤çè¿äºå¼å¸¸ï¼å®ä»¬éå¸¸ä¼å¨æ§è¡è¯¥ <code>Runnable</code> ççº¿ç¨ä¸­è¢«âåæâï¼å³å¼å¸¸ä¼å¯¼è´çº¿ç¨ç»æ­¢ï¼ä½ä¸ä¼å½±åå¶ä»çº¿ç¨çæ§è¡ã</p>
<pre><code class="language-java">public void uncaughtException(Thread t, Throwable e) {
   if (parent != null) {
        parent.uncaughtException(t, e);
   } else {
        Thread.UncaughtExceptionHandler ueh =
            Thread.getDefaultUncaughtExceptionHandler();
        if (ueh != null) {
            ueh.uncaughtException(t, e);
        } else if (!(e instanceof ThreadDeath)) {
            System.err.print("Exception in thread \""
                             + t.getName() + "\" ");
            e.printStackTrace(System.err);
        }
    }
}
</code></pre>
<p>è§£å³æ¹æ¡ï¼</p>
<ol>
<li>
<p>å¨runæ¹æ³ä¸­æ¾ç¤ºçæè·å¼å¸¸</p>
<pre><code class="language-java">public void run() {
    try {
        // å¯è½æåºå¼å¸¸çä»£ç 
    } catch (Exception e) {
        // è®°å½æ¥å¿æå¤çå¼å¸¸
        throw new RuntimeException(e);
    }
}
</code></pre>
</li>
<li>
<p>ä¸ºåå»ºççº¿ç¨è®¾ç½®ä¸ä¸ª<code>UncaughtExceptionHandler</code></p>
<pre><code class="language-java">Thread t = new Thread(() -&gt; {
   int i = 1 / 0;
}, "t1");
t.setUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler() {
   @Override
   public void uncaughtException(Thread t, Throwable e) {
        logger.error('---', e);
   }
});
</code></pre>
</li>
<li>
<p>ä½¿ç¨<code>Callable</code>ä»£æ¿<code>Runnable</code>ï¼<code>Callable</code>ç<code>call</code>æ¹æ³åè®¸æåºå¼å¸¸ï¼ç¶åå¯ä»¥éè¿æäº¤ç»<code>ExecutorService</code>è¿åç<code>Future</code>æ¥æè·åå¤çè¿äºå¼å¸¸</p>
<pre><code class="language-java">ExecutorService executor = Executors.newFixedThreadPool(1);
Future&lt;?&gt; future = executor.submit(() -&gt; {
    // å¯è½æåºå¼å¸¸çä»£ç 
});

try {
    future.get(); // è¿éä¼æè·å°Callableä¸­çå¼å¸¸
} catch (ExecutionException e) {
    Throwable cause = e.getCause(); // è·ååå§å¼å¸¸
}
</code></pre>
</li>
</ol>
<h3 id="callableä¸­å¼å¸¸å¦ä½è¢«åæ">Callableä¸­å¼å¸¸å¦ä½è¢«åæ</h3>
<pre><code class="language-java">class MyCallable implements Callable&lt;String&gt; {
    @Override
    public String call() throws Exception {
        System.out.println("===&gt; å¼å§æ§è¡callable");
        int i = 1 / 0; //å¼å¸¸çå°æ¹
        return "callableçç»æ";
    }
}

public class CallableAndRunnableTest {

    public static void main(String[] args) {
        System.out.println(" =========&gt; main start ");
        ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor(3, 5, 1, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(100));
        Future&lt;String&gt; submit = threadPoolExecutor.submit(new MyCallable());
        try {
            TimeUnit.SECONDS.sleep(2);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println(" =========&gt; main end ");
    }
}
</code></pre>
<p>è¿è¡ç»æ</p>
<pre><code class="language-java"> =========&gt; main start 
 ===&gt; å¼å§æ§è¡callable
 =========&gt; main end 
</code></pre>
<p>æºç å¦ä¸ï¼</p>
<pre><code class="language-java">public &lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task) {
    if (task == null) throw new NullPointerException();
    RunnableFuture&lt;T&gt; ftask = newTaskFor(task);
    execute(ftask);
    return ftask;
}

protected &lt;T&gt; RunnableFuture&lt;T&gt; newTaskFor(Callable&lt;T&gt; callable) {
    return new FutureTask&lt;T&gt;(callable);
}
</code></pre>
<p><code>RunableFuture&lt;T&gt;</code> æ¯ä¸ªæ¥å£ï¼ä½æ¯å®ç»§æ¿äºRunnable æ¥å£ ï¼ å®ç°ç±»æ¯ FutureTask ï¼å æ­¤å°±éè¦çä¸ FutureTaskéçrunæ¹æ³ æ¯ä¸æ¯å æé æ¶çCallable æå³ç³»ï¼</p>
<pre><code class="language-java">public void run() {
     // ç¶æä¸å±äºåå§ç¶æçæåµä¸ï¼ä¸è¿è¡åç»­é»è¾å¤ç
     // é£ä¹å°±æ¯run æ¹æ³åªè½æ§è¡ä¸æ¬¡
     if (state != NEW ||
        !UNSAFE.compareAndSwapObject(this, runnerOffset,
                                   null, Thread.currentThread()))
        return;
    try { 
        Callable&lt;V&gt; c = callable;
        if (c != null &amp;&amp; state == NEW) {
            V result;
            // 
            boolean ran;
            try {
                // æ§è¡ Callable éç call æ¹æ³ ï¼å°ç»æå­å¥resultåéä¸­
                result = c.call();
                ran = true;
            } catch (Throwable ex) {
                result = null;
                ran = false;
                 // call æ¹æ³å¼å¸¸ ï¼ è®°å½ä¸å¼å¸¸ç»æ
                setException(ex);
            }
            // call æ¹æ³æ­£å¸¸æ§è¡å®æ¯ ï¼è¿è¡ç»æå­å¨
            if (ran)
                set(result);
        }
    } finally {
        // runner must be non-null until state is settled to
        // prevent concurrent calls to run()
        runner = null;
        // state must be re-read after nulling runner to prevent
        // leaked interrupts
        int s = state;
        if (s &gt;= INTERRUPTING)
            handlePossibleCancellationInterrupt(s);
    }
}
</code></pre>
<p>æ¥ä¸æ¥å°±è¦çï¼å¦æå­å¨æ­£å¸¸ç»æç<code>set(result)</code>æ¹æ³ åå­å¨å¼å¸¸ç»æç <code>setException(ex)</code> æ¹æ³</p>
<pre><code class="language-java">protected void setException(Throwable t) {
    if (UNSAFE.compareAndSwapInt(this, stateOffset, NEW, COMPLETING)) {
        outcome = t;
        UNSAFE.putOrderedInt(this, stateOffset, EXCEPTIONAL); // final state
        finishCompletion();
    }
}

protected void set(V v) {
    if (UNSAFE.compareAndSwapInt(this, stateOffset, NEW, COMPLETING)) {
        outcome = v;
        UNSAFE.putOrderedInt(this, stateOffset, NORMAL); // final state
        finishCompletion();
    }
}
</code></pre>
<p>è¿ä¸¤ä¸ªä»£ç é½åäºä¸ä¸ªæä½ï¼å°±æ¯å°æ­£å¸¸ç»æ<code>result</code> å å¼å¸¸ç»æ <code>exception</code> é½èµå¼ç»äº <code>outcome</code> è¿ä¸ªåé ã</p>
<p>æ¥çåçä¸futureçgetæ¹æ³</p>
<pre><code class="language-java">//è¿éæå¿é¡»çä¸Taskçç»ææ¶çç¶æï¼å¦ææ­£å¸¸ç»æï¼ç¶æä¸º NORMAL ï¼ å¼å¸¸ç»æï¼ç¶æä¸ºEXCEPTIONAL ã çä¸å ä¸ªç¶æçå®ä¹ï¼å¦ä¸ï¼  
private volatile int state;
private static final int NEW          = 0;
private static final int COMPLETING   = 1;
private static final int NORMAL       = 2;
private static final int EXCEPTIONAL  = 3;
private static final int CANCELLED    = 4;
private static final int INTERRUPTING = 5;
private static final int INTERRUPTED  = 6;

/**
* @throws CancellationException {@inheritDoc}
*/
public V get() throws InterruptedException, ExecutionException {
    int s = state;
    // NORMAL(2) ãEXCEPTIONAL(3) é½å¤§äº COMPLETINGï¼1ï¼,æä»¥Taskç»æä¹åï¼ä¸ä¼èµ°è¯¥if
    if (s &lt;= COMPLETING)
         s = awaitDone(false, 0L);
    // éç¹ï¼ è¿åç»æ
    return report(s);
}

private V report(int s) throws ExecutionException {
    // ä¹åæ­£å¸¸ç»ææèå¼å¸¸é½å­æ¾å¨Object outcomme ä¸­äº
    Object x = outcome;
    // æ­£å¸¸è¿å
    if (s == NORMAL)
        return (V)x;
    // EXCEPTIONAL(3) å°äº CANCELLED(4) ï¼æä»¥ä¸ä¼èµ°è¯¥ifåæ¯ï¼ç´æ¥åç»­çthrow æå¼å¸¸çé»è¾
    if (s &gt;= CANCELLED)
        throw new CancellationException();
    // ä¸ç­äºNORMAL ä¸ å¤§äºç­äº CANCELLED  ,  åç»å è°ç¨ report(int s ) ä¹åä¹åäºstate çè¿æ»¤
    //å°è¿ä¸æ­¥ï¼é£åªè½æ¯EXCEPTIONAL(3) 
    throw new ExecutionException((Throwable)x);
}
</code></pre>
<p>å æ­¤å¯ä»¥éè¿getæ¹æ³è·åå°å¼å¸¸ç»æ</p>


</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªå¨çº¿ç½ç«ï¼sevençèé¸æé¿ä¹è·¯ï¼ä½èï¼sevenï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼www.seven97.top</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 09:00">2026-02-02 09:00</span>&nbsp;
<a href="https://www.cnblogs.com/sevencoding">ç¨åºåSeven</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19557016);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19557016', targetLink: 'https://www.cnblogs.com/sevencoding/p/19557016', title: 'çº¿ç¨å¦ä½åæ­¢ï¼çº¿ç¨ä¹é´å¦ä½åä½ï¼çº¿ç¨ä¹é´çå¼å¸¸å¦ä½å¤çï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ PHP ç°å¨å¯ä»¥é¶ææ¬æå»ºåç iOS å Android åºç¨ NativePHP for Mobile v3 åå¸ ]]></title>
    <link>https://www.cnblogs.com/catchadmin/p/19562251</link>
    <guid>13ff9f459cde6fe3c88d4c3c31d5c379</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/catchadmin/p/19562251" title="åå¸äº 2026-02-02 07:50">
    <span role="heading" aria-level="2">PHP ç°å¨å¯ä»¥é¶ææ¬æå»ºåç iOS å Android åºç¨ NativePHP for Mobile v3 åå¸</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="php-ç°å¨å¯ä»¥é¶ææ¬æå»ºåç-ios-å-android-åºç¨-nativephp-for-mobile-v3-åå¸">PHP ç°å¨å¯ä»¥é¶ææ¬æå»ºåç iOS å Android åºç¨ NativePHP for Mobile v3 åå¸</h1>
<p>NativePHP for Mobile ä» v3 çæ¬å¼å§ï¼æ ¸å¿æ¡æ¶éç¨ MIT åè®®åè´¹å¼æºãLaravel/PHP å¼åèç°å¨å¯ä»¥é¶ææ¬æå»ºåç iOS å Android åºç¨ã</p>
<p>å¦æä½¿ç¨ nativePHP å¼åç§»å¨åºç¨çè¯ï¼å¯ä»¥ç<a href="https://nativephp-doc.catchadmin.com" target="_blank" rel="noopener nofollow">nativephp mobile v3 ä¸­æææ¡£</a></p>
<h2 id="æä»¶åæ¶æ">æä»¶åæ¶æ</h2>
<p>v3 çæ¬æå¤§çååæ¯å¼å¥äºæ¨¡ååæä»¶ç³»ç»ãæ­¤åçæ¬ä¸­éæå¨æ ¸å¿åéçåçåè½ï¼ç°å¨è¢«æåæç¬ç«çæä»¶ã</p>
<p>æ¯ä¸ªæä»¶é½æ¯ä¸ä¸ªç¬ç«ç Composer åï¼åå« Swift å Kotlin ä»£ç ãæéæ¸åä»¥ååçä¾èµãå¼åèåªéå®è£å®éç¨å°çæä»¶ï¼è¿äºæä»¶ä¼å¨æå»ºè¿ç¨ä¸­ç´æ¥ç¼è¯è¿åºç¨ã</p>
<p>æä»¶å®è£éå¸¸ç®åï¼éè¿ <code>composer require</code> å®è£ååï¼å¨ <code>NativeServiceProvider</code> ä¸­æ³¨åå³å¯ãåªææ³¨åçæä»¶æä¼è¢«ç¼è¯è¿æç»çäºè¿å¶æä»¶ï¼è¿æ ·å¯ä»¥ä¿æåºç¨ä½ç§¯ç²¾ç®ï¼ä¹æå©äºéè¿åºç¨ååºå®¡æ ¸ã</p>
<h3 id="åå»ºæä»¶">åå»ºæä»¶</h3>
<p>æä»¶æ¬è´¨ä¸å°±æ¯ Composer åï¼åªæ¯å¤äºä¸äºé¢å¤éç½®ãéè¿æ·»å  <code>nativephp.json</code> æä»¶ï¼å¼åèå¯ä»¥å®ä¹ PHP ç±»ãè§å¾æä»¶ãæ¡¥æ¥å½æ°ãåçä¾èµï¼CocoaPodsãSwift PackagesãGradleï¼ãæéå£°æãJavaScript æä»¶ç­ã</p>
<p>NativePHP æ ¸å¿æä¾äºæå»ºé©å­ãçå½å¨æé©å­ãæå¡æä¾èæ³¨åç­æºå¶ï¼è®©æä»¶å¼åä½éªæ´å é¡ºçã</p>
<p>æä»¶å¯ä»¥åå¸å° Packagistï¼ä¹å¯ä»¥ä½ä¸ºé¡¹ç®åé¨ä»£ç ä½¿ç¨ï¼æ éåå¸å°å¬å±ä»åºãè¿æå³çåºç¨ç Laravel ä»£ç åºå¯ä»¥åå«æå»ºåçåºç¨æéçä¸åã</p>
<h2 id="åè´¹æ ¸å¿">åè´¹æ ¸å¿</h2>
<p>æ°æ¶æå°æ ¸å¿åç²¾ç®å°æå°åï¼åºç¨åªéåå«å®éä½¿ç¨çåè½ãè¿è®©åºç¨é»è®¤å°±æ´å°ãæ´é«æï¼ä¹é¿åäºåºç¨ååºå®¡æ ¸æ¶å åå«æªä½¿ç¨åè½èè¢«æçé®é¢ã</p>
<p>NativePHP å¢éå° v3 çæ¬å½åä¸º NativePHP Airï¼å¹¶å°å¶è½¬ä¸º MIT å¼æºåè®®ãv3 ä¹åççæ¬ä»ç¶éµå¾ªåæç Business Source Licenseã</p>
<p>æ ¸å¿æ¡æ¶å¼æºåï¼ç¤¾åºå¯ä»¥åä¸è´¡ç®ï¼å¢éæ¬¢è¿éå¯¹ iOS å Android æ ¸å¿åºç¨ç PRã</p>
<h3 id="åè´¹æä»¶">åè´¹æä»¶</h3>
<p>ä»¥ä¸æä»¶å®å¨åè´¹å¼æºï¼MIT åè®®ï¼ï¼</p>
<ul>
<li><strong>Browser</strong> - æµè§å¨åè½</li>
<li><strong>Camera</strong> - ç¸æºè°ç¨</li>
<li><strong>Device</strong> - è®¾å¤ä¿¡æ¯è·å</li>
<li><strong>Dialog</strong> - åçå¯¹è¯æ¡</li>
<li><strong>File</strong> - æä»¶æä½</li>
<li><strong>Microphone</strong> - éº¦åé£è°ç¨</li>
<li><strong>Network</strong> - ç½ç»ç¶ææ£æµ</li>
<li><strong>Share</strong> - ç³»ç»åäº«åè½</li>
<li><strong>System</strong> - ç³»ç»ä¿¡æ¯</li>
</ul>
<h3 id="ä»è´¹æä»¶">ä»è´¹æä»¶</h3>
<p>ä»¥ä¸åè½éè¦åç¬è´­ä¹°æä»¶ï¼ä¸æ¬¡æ§ä»è´¹ï¼å¯ç¨äºæ éé¡¹ç®ï¼ï¼</p>
<ul>
<li><strong>Biometrics</strong> - çç©è¯å«ï¼Face IDãæçº¹ï¼</li>
<li><strong>Geolocation</strong> - å°çä½ç½®</li>
<li><strong>Push Notifications</strong> - æ¨ééç¥ï¼åºäº Firebaseï¼</li>
<li><strong>Scanner</strong> - æ«æå¨</li>
<li><strong>Secure Storage</strong> - å®å¨å­å¨</li>
</ul>
<h2 id="æä»¶å¸åº">æä»¶å¸åº</h2>
<p>æä»¶å¸åºï¼Plugin Marketplaceï¼å°ææ NativePHP æä»¶éä¸­å±ç¤ºï¼å¼åèå¯ä»¥åç°åè´¹åä»è´¹æä»¶ã</p>
<p>æªæ¥å å¨ï¼å¸åºå°åç¬¬ä¸æ¹å¼åèå¼æ¾ï¼å±æ¶å¼åèå¯ä»¥å¨ nativephp.com ä¸æ¶èªå·±çæä»¶ï¼çè³å¯ä»¥éå®èªå·±å¼åçæä»¶ãä¾å¦ç¸æºæ»¤éæä»¶ãæ¯ä»ç½å³éæãç¤¾äº¤ç»å½åç­ã</p>
<h2 id="jumpå³æ¶è®¾å¤æµè¯">Jumpï¼å³æ¶è®¾å¤æµè¯</h2>
<p>å¨çæºä¸æµè¯åºç¨éå¸¸æ¯ä¸ä¸ªç¼æ¢ä¸ç¹ççè¿ç¨ï¼éè¦å®è£æ° GB çè½¯ä»¶ãæ¨¡æå¨åæ¡æ¶ãèä¸ï¼æ²¡æ Mac å°±æ æ³ä¸º iPhone æå»ºåæµè¯åºç¨ã</p>
<p>Jump æ¹åäºè¿ä¸åã</p>
<p>Jump æ¯ä¸ä¸ªå®è£å¨ææºä¸çåºç¨ï¼æ¯æ Android å iOSï¼ï¼å¯ä»¥å¨çæºä¸æµè¯ NativePHP åºç¨ï¼æ éç¼è¯ä»»ä½ä¸è¥¿ï¼ä¹ä¸éè¦å¼å¯å¼åèæ¨¡å¼ã</p>
<p>åªéè¿è¡ <code>native:jump</code> Artisan å½ä»¤ï¼æå¼ææºä¸ç Jump åºç¨æ«æäºç»´ç ï¼Laravel åºç¨å°±ä¼ç´æ¥å è½½å°è®¾å¤ä¸ï¼è¿æ¥å°æ¬å°å¼åæå¡å¨ã</p>
<pre><code class="language-shell">php artisan native:jump

# æè

./native jump
</code></pre>
<p>NativePHP æå»ºéåº¦å¾å¿«ï¼æ¬å°å¼åç¯å¢çæ¹å¨å ä¹å¯ä»¥å®æ¶åæ å°è®¾å¤ä¸ãæªæ¥è¿è®¡åæ¯æå®æ´ç HMRï¼ç­æ¨¡åæ¿æ¢ï¼ã</p>
<p>Jump åºç¨å®å¨åè´¹ï¼<code>nativephp/mobile</code> v3 å·²åå«è¿è¡ Jump æéçä¸åã</p>
<p>Jump åå«ææå®æ¹ NativePHP æä»¶ï¼åæ¬ä»è´¹æä»¶ï¼ï¼å¼åèå¯ä»¥åè´¹è¯ç¨åå­¦ä¹ ææåè½ãå¯ä¸çéå¶æ¯ Jump æ æ³æµè¯ç¬¬ä¸æ¹æä»¶ã</p>
<h2 id="mimiai-è¾å©ç¼ç ">Mimiï¼AI è¾å©ç¼ç </h2>
<p>Mimiï¼åèªåæ¬§æºæ§ä¹ç¥ Mimirï¼æ¯ NativePHP æä¾ç AI è¾å©ç¼ç åè½ï¼å¯ä»¥è®© AI æ¨¡åå¸®å©ç¼å NativePHP åºç¨ï¼</p>
<ul>
<li>ç´æ¥å¨æµè§å¨ä¸­åå»ºæ°ç NativePHP é¡¹ç®ï¼ç§»å¨ç«¯ä¹å¯ä»¥ï¼</li>
<li>ç¨èªç¶è¯­è¨æè¿°æ³è¦æå»ºçåå®¹ï¼æ¯æè¯­é³è¾å¥</li>
<li>ç´æ¥å¨ Jump ä¸­æµè¯åºç¨</li>
<li>è¿æ¥ GitHub ä»åºï¼ç«å³è·åææåºç¨ä»£ç </li>
</ul>
<p>è¿æ¯ä»æ³æ³å°å¯è¿è¡ç§»å¨åºç¨çæå¿«è·¯å¾ï¼å®å¨åºäº Laravelã</p>
<h2 id="åçº§æå">åçº§æå</h2>
<p>å¦æå·²ç»å®è£äº <code>nativephp/mobile</code>ï¼åçº§å° v3 çæ­¥éª¤å¦ä¸ï¼</p>
<ol>
<li>ä» <code>composer.json</code> ä¸­ç§»é¤ NativePHP ä»åºï¼<code>https://nativephp.composer.sh</code>ï¼</li>
<li>è¿è¡ <code>composer remove nativephp/mobile</code> å¸è½½æ§çæ¬</li>
<li>è¿è¡ <code>composer require nativephp/mobile</code> ä» Packagist å®è£ v3</li>
<li>å®è£åºç¨ä¸­ä½¿ç¨çåè½å¯¹åºçæä»¶</li>
</ol>
<p>é¤äºæ³¨åæ°æä»¶å¤ï¼åºç¨ä»£ç åºæ¬ä¸éè¦ä¿®æ¹ãå®è£æä»¶åå¯ä»¥ä½¿ç¨ä»¥ä¸å½ä»¤æ³¨åï¼</p>
<pre><code class="language-shell">php artisan native:plugin:register vendor/plugin

# æè

./native plugin:register vendor/plugin
</code></pre>
<h2 id="å¿«éå¼å§">å¿«éå¼å§</h2>
<p>NativePHP for Mobile v3 ç°å·²åå¸ãå¨ææºä¸å®è£ Jumpï¼ç¶åå¨å¼åç¯å¢ä¸­è¿è¡ä»¥ä¸å½ä»¤ï¼</p>
<pre><code class="language-shell">laravel new my-mobile-app
cd my-mobile-app
composer require nativephp/mobile
php artisan native:jump
</code></pre>
<p>è¿éé¢æå ä¸ªå°å</p>
<ul>
<li>PHP è¦æ± <code>&gt;=8.3</code></li>
<li>å¨ windows ä¸æµè¯ï¼éè¦åå®è£ <a href="https://www.7-zip.org/" target="_blank" rel="noopener nofollow">7-zip</a></li>
<li>æå¨ IOS ææºæµè¯å¾ï¼ä½¿ç¨ <code>php artisan native:jump</code> ä¹åä¼å¼¹åºä¸ä¸ªäºç»´ç ï¼ç¨ææºä¸ç Jump æ«æå³å¯ãè¿ä¸ª Jump ç®ååªè½å¨ <code>TestFlight</code> ä¸å®è£ï¼æå¼è¿ä¸ª<a href="https://testflight.apple.com/join/RuzFs4rJ" target="_blank" rel="noopener nofollow">å®è£é¾æ¥</a>å³å¯ã</li>
</ul>
<p>å¾å®ç¾ï¼è³å°ä»å®è£ä¸å°æµè¯ææé½å¾å¿«äºãææå¾å¦ä¸ï¼</p>
<p><img alt="Laravel ç°å¨å¯ä»¥é¶ææ¬æå»ºåç iOS å Android åºç¨ NativePHP for Mobile v3 åå¸" loading="lazy" data-src="https://image.catchadmin.com/202602011330904.png" class="lazyload"></p>
<p><a href="https://catchadmin.com/post/2026-02/nativephp-mobile-free" target="_blank" rel="noopener nofollow">åæ PHP ç°å¨å¯ä»¥é¶ææ¬æå»ºåç iOS å Android åºç¨ NativePHP for Mobile v3 åå¸</a></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 07:51">2026-02-02 07:50</span>&nbsp;
<a href="https://www.cnblogs.com/catchadmin">JaguarJack</a>&nbsp;
éè¯»(<span id="post_view_count">39</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19562251);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19562251', targetLink: 'https://www.cnblogs.com/catchadmin/p/19562251', title: 'PHP ç°å¨å¯ä»¥é¶ææ¬æå»ºåç iOS å Android åºç¨ NativePHP for Mobile v3 åå¸' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ .NET AI çæç³»ç»çéæä¸æ¼è¿ï¼Microsoft Agent Framework å¯¹ Semantic Kernel çç»§æ¿ãè¶è¶ä¸æç¥æ´å ]]></title>
    <link>https://www.cnblogs.com/shanyou/p/19562239</link>
    <guid>4cea742e144019b9946eb2cbb0415e0f</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/shanyou/p/19562239" title="åå¸äº 2026-02-02 07:45">
    <span role="heading" aria-level="2">.NET AI çæç³»ç»çéæä¸æ¼è¿ï¼Microsoft Agent Framework å¯¹ Semantic Kernel çç»§æ¿ãè¶è¶ä¸æç¥æ´å</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        éè¿å¯¹ Microsoft Agent Framework çæ·±åº¦è°æ¥å¯ä»¥åç°ï¼.NET AI çæç³»ç»æ­£å¨ç»åä¸åºä»âåè½éæâåâä»£çåçâçèåãå¾®è½¯éè¿æ´å Semantic Kernel çå·¥ç¨åºå ä¸ AutoGen çåæ°çµé­ï¼ä¸ä»æä¾äºä¸ä¸ªæ´å¼ºå¤§çå¼åå·¥å·ï¼æ´æ¯å¨.NET å¹³å°ä¸ç¡®ç«äºä¸å¥å³äº AI ä»£çå¦ä½æèãåä½ãè®°å¿åæ§è¡çæ åã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="1-æºè½è½¯ä»¶å·¥ç¨çèå¼è½¬ç§»ä»åºéæå°åçæ¡æ¶æ¼è¿"><strong>1. æºè½è½¯ä»¶å·¥ç¨çèå¼è½¬ç§»ï¼ä»åºéæå°åçæ¡æ¶æ¼è¿</strong></h2>
<p>å¨çæå¼äººå·¥æºè½ï¼Generative AIï¼ä»åçº¯çææ¬çæåå·å¤èªä¸»è§åä¸æ§è¡è½åçâä»£çåï¼Agenticï¼âç³»ç»è·¨è¶çè¿ç¨ä¸­ï¼.NET çæç³»ç»æ­£å¨ç»åä¸åºèªè¯¥å¹³å°è¯çä»¥æ¥ææ·±å»çæ¶æéæãè¿ç§éæä¸ä»ä½ç°å¨å·¥å·é¾çæ´æ°ä¸ï¼æ´ä½ç°å¨åºå±è®¾è®¡å²å­¦çæ ¹æ¬è½¬åï¼ä»å°äººå·¥æºè½è§ä¸ºä¸ç§âå¤é¨è°ç¨çåºï¼Libraryï¼âï¼æ¼è¿ä¸ºå° AI ä»£çè§ä¸ºä¸ç§âåççä¸ç­å¬æ°ï¼First-class Citizenï¼âè½¯ä»¶ç»ä»¶ ã</p>
<p>åé¡¾è¿å»ä¸¤å¹´çåå±ï¼.NET å¼åèå¨æå»º AI åºç¨æ¶é¿æé¢ä¸´çä¸¥éçå·¥å·é¾ç¢çåé®é¢ãæ©æç±å¾®è½¯æ¨åºç Semantic Kernel è½ç¶å¨ä¼ä¸çº§éæä¸­å æ®äºåæºï¼ä½éçç ç©¶é¢åå¦ AutoGen ç­å¤ä»£çååæ¨¡å¼çå´èµ·ï¼å¼åèä¸å¾ä¸é¢ä¸´å¨âç¨³å®éæâä¸âåæ²¿ç ç©¶âä¹é´çè°é¾éæ©ãè¿ç§ç¢çåå¯¼è´äºæé«çå·¥ç¨ææ¬ï¼ç¸å³è¡ä¸è°æ¥æ¾ç¤ºï¼çº¦æ 50% çå¼åèæ¯å¨å å·¥å·é¾çä¸è¿ç»­æ§å API çä¸ä¸è´æ§èæå¤±è¶è¿ 10 ä¸ªå°æ¶ççäº§åã</p>
<p>ä¸ºäºæ¶é¤è¿ç§ç¢çåï¼å¾®è½¯å¨ 2025 å¹´åºæ­£å¼æ¨åºäº Microsoft Agent Frameworkï¼ä»¥ä¸ç®ç§° MAFï¼ãè¿ä¸ä»ä»æ¯ä¸ä¸ªæ°æ¡æ¶çåå¸ï¼æ´æ¯.NET AI çæç³»ç»çä¸æ¬¡æç¥æ§å¤§ä¸ç»ãå®å° Semantic Kernel çä¼ä¸çº§å·¥ç¨åºåº§ä¸ AutoGen çåæ°æ§å¤ä»£çç¼ææ¨¡å¼è¿è¡äºæ·±åº¦èåï¼æ å¿ç.NET å¹³å°ä¸ç AI ä»£çå¼åå·²ä»âå®éªæ§ååâé¶æ®µæ­£å¼è¿å¥âå·¥ä¸åçäº§âé¶æ®µ ãè¿ç§æ¼è¿èåéèçä¸ä¸ªæç¡®çä¿¡å·ï¼æªæ¥ç AI å¼åå°ä¸åä¾èµäºå­¤ç«çãååç»å®ç SDKï¼èæ¯åºäºä¸ç³»åæ ååçãå¯äºæä½ç BCLï¼åºç±»åºï¼æ©å±ã</p>
<h2 id="2-æ ¸å¿äºç«¯è§£æmicrosoft-agent-framework-æ¯å¦å·²åä»£-semantic-kernel"><strong>2. æ ¸å¿äºç«¯è§£æï¼Microsoft Agent Framework æ¯å¦å·²åä»£ Semantic Kernel</strong></h2>
<p>éå¯¹ä¸çå³äº Microsoft Agent Framework ä¸ Semantic Kernel å³ç³»ççèï¼ç®åçè¯æ®åå®æ¹éè¿°æä¾äºä¸ä¸ªæ¸æ°çç»è®ºï¼<strong>Microsoft Agent Framework æ¯ Semantic Kernel å¨ AI ä»£çæå»ºé¢åçå®æ¹ç»§ä»»èï¼å¶æ¬è´¨ä¸åºè¢«è§ä¸º Semantic Kernel ç 2.0 çæ¬æä»£çæ ¸å¿çæ·±åº¦éæç</strong>ã</p>
<h3 id="21-æ¡æ¶å°ä½çæç¥æ§æ´æ¿"><strong>2.1 æ¡æ¶å°ä½çæç¥æ§æ´æ¿</strong></h3>
<p>å¾®è½¯å®æ¹å·²æç¡®å° Microsoft Agent Framework å®ä¹ä¸ºæå»ºãé¨ç½²åç®¡ç AI ä»£ççç»ä¸ãä¼ä¸çº§å¹³å°ãå¯¹äºå¼åèèè¨ï¼æå³é®çååå¨äº Semantic Kernel åæçå³äºä»£çï¼Agentï¼åå¤ä»£çç¼æï¼Orchestrationï¼çåè½æ¨¡åå·²ç»æ´ä½è¿ç§»å¹¶æ¼è¿å°äº MAF ä¸­ãè½ç¶ Semantic Kernel ä½ä¸ºä¸ä¸ª SDK ä¾ç¶å­å¨ï¼ä½å¶å®ä½å·²ä»âä¸è½ç AI SDKâè½¬åä¸ºæ´ä¾§éäºåºç¡ AI åè½éæåæ§çåºç¨ç»´æ¤çå·¥å·ã</p>
<p>å¨è¿ä¸è½¬åè¿ç¨ä¸­ï¼å¾®è½¯éç¨äºå¸åçè½¯ä»¶çå½å¨ææ´è¿­ç­ç¥ãSemantic Kernel v1.x å·²æ­£å¼è¿å¥ç»´æ¤æ¨¡å¼ãè¿æå³çè½ç¶å¾®è½¯ä»ä¼ç»§ç»­è§£å³ v1.x ä¸­çå³é®æ¼æ´åå®å¨é®é¢ï¼å¹¶ç¡®ä¿ç°æåè½è¾¾å°æ­£å¼åå¸ï¼GAï¼ç¶æï¼ä½æªæ¥çç»å¤§å¤æ°æ°åè½å¼åé½å°éä¸­å¨ Microsoft Agent Framework å¹³å°ä¸ ãè¿ç§âæ°èäº¤æ¿âçæå¿ä¸è¡¨è¿è¡äºè¯¦ç»å¯¹æ¯ï¼</p>
<table>
<thead>
<tr>
<th style="text-align: left">ç»´åº¦</th>
<th style="text-align: left">Semantic Kernel (v1.x)</th>
<th style="text-align: left">Microsoft Agent Framework (MAF)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><strong>æç¥å®ä½</strong></td>
<td style="text-align: left">è½»éçº§ãæ¨¡åä¸å¯ç¥ç AI éæ SDK</td>
<td style="text-align: left">ç»ä¸çãå·¥ä¸çº§ä»£çä¸å¤ä»£çå·¥ä½æµå¹³å°</td>
</tr>
<tr>
<td style="text-align: left"><strong>æ ¸å¿è¡ç»</strong></td>
<td style="text-align: left">ä¼ä¸çº§å·¥ç¨åæ¨¡å¼</td>
<td style="text-align: left">Semantic Kernel ä¼ä¸å°åº + AutoGen ç ç©¶åºå </td>
</tr>
<tr>
<td style="text-align: left"><strong>ç»´æ¤ç¶æ</strong></td>
<td style="text-align: left">ç»´æ¤æ¨¡å¼ï¼è§£å³æ¼æ´ä¸å®å¨æ§ï¼ä¸åå¢å éå¤§åè½</td>
<td style="text-align: left">æ´»è·å¼åï¼ä½ä¸ºå¾®è½¯ AI æç¥çå¯ä¸ä»£çå¼åå¥å£</td>
</tr>
<tr>
<td style="text-align: left"><strong>åºå±æ½è±¡</strong></td>
<td style="text-align: left">æ©æä¸ºèªå®ä¹æ½è±¡ï¼åéæ­¥å MEAI é æ¢</td>
<td style="text-align: left">åçæå»ºå¨ Microsoft.Extensions.AI (MEAI) ä¹ä¸</td>
</tr>
<tr>
<td style="text-align: left"><strong>ä¸»è¦åºç¨åºæ¯</strong></td>
<td style="text-align: left">ç°æä¸å¡ç³»ç»çç®å AI åè½å¢å¼º</td>
<td style="text-align: left">å¤æçãå·å¤ç¶ææç¥åå¤ä»£çååçèªä¸»ç³»ç»</td>
</tr>
</tbody>
</table>
<h3 id="22-ç»´æ¤æ¿è¯ºä¸è¿æ¸¡çªå£"><strong>2.2 ç»´æ¤æ¿è¯ºä¸è¿æ¸¡çªå£</strong></h3>
<p>ä¸ºäºä¿æ¤ä¼ä¸ç¨æ·çæ©ææèµï¼å¾®è½¯æ¿è¯ºå¨ Microsoft Agent Framework ç¦»å¼é¢è§çå¹¶è¿å¥ GA é¶æ®µåï¼ä»å°ä¸º Semantic Kernel v1.x æä¾è³å°ä¸å¹´çæç»­æ¯æãå¯¹äºç°æç Semantic Kernel é¡¹ç®ï¼å¼åèå¹¶ä¸éè¦ç«å³è¿è¡é«é£é©çä»£ç éæï¼ä½å¯¹äºä»»ä½æ°å¯å¨çãæ¨å¨æå»ºå·å¤èªä¸»è¡ä¸ºåå¤æé»è¾ç AI ç³»ç»é¡¹ç®ï¼MAF å·²æä¸ºå¯ä¸çå®æ¹æ¨èè·¯å¾ã</p>
<h2 id="3net-ai-çæç³»ç»çæ ¸å¿æå»ºæ¨¡åä¸ææ°æ¼è¿"><strong>3..NET AI çæç³»ç»çæ ¸å¿æå»ºæ¨¡åä¸ææ°æ¼è¿</strong></h2>
<p>å¨ MAF ä½ä¸ºåºç¨å±æ¡æ¶å´èµ·çèåï¼æ¯.NET åºå±åºç¡è®¾æ½çä¸æ¬¡âéé»é©å½âãå¾®è½¯æ­£å¨éè¿ä¸ç³»å Microsoft.Extensions å½åç©ºé´ä¸çåºï¼å° AI çæ ¸å¿è½åï¼å¦å¯¹è¯ãåéå¤çãæ§è½è®¡ç®ï¼æ ååï¼è¿ä½¿å¾.NET å¼åèè½å¤æè±å¯¹ç¹å® AI åå SDK çä¾èµã</p>
<h3 id="31-microsoftextensionsai-meaiæ ååç-llm-æ¥å¥åè®®"><strong>3.1 Microsoft.Extensions.AI (MEAI)ï¼æ ååç LLM æ¥å¥åè®®</strong></h3>
<p>MEAI çå¼å¥æ¯.NET AI çææ¼è¿ä¸­æå·éç¨ç¢æä¹çäºä»¶ä¹ä¸ãå®å°åæ¬å¨åä¸ªæ¡æ¶ï¼å¦ Semantic KernelãLangChain.NETï¼ä¸­åèªä¸ºæ¿çæ¨¡åäº¤äºåè¯­æååºæ¥ï¼å½¢æäºä¸å¥ç»ä¸ç BCL æ©å±ã</p>
<p>MEAI çæ ¸å¿æ¯ IChatClient æ¥å£ï¼å®ä¸ä»å®ä¹äºå¯¹è¯è¡¥å¨ãæµå¼å¤çåå·¥å·è°ç¨çæ åè·¯å¾ï¼è¿å¼å¥äºå¼ºå¤§çä¸­é´ä»¶ï¼Middlewareï¼æ¨¡å¼ ãéè¿è¿ç§æ¨¡å¼ï¼å¼åèå¯ä»¥è½»æ¾å°å¨è¯·æ±æµæ°´çº¿ä¸­æå¥é¥æµï¼Telemetryï¼ãæ¥å¿ï¼Loggingï¼ãç¼å­ï¼Cachingï¼ä»¥ååå®¹è¿æ»¤ç­æ¨ªåå³æ³¨ç¹ï¼èæ éä¿®æ¹æ ¸å¿ä¸å¡é»è¾ 6ãå¼å¾æ³¨æçæ¯ï¼MEAI å·²ç»è·å¾äºåæ¬ OpenAIãAzure OpenAIãOllama ç­ä¸»æµæä¾åçééå¨æ¯æï¼è¿çæ­£å®ç°äºâç¼åä¸æ¬¡ï¼éå¤è¿è¡âçè·¨æ¨¡åäºæä½æ§ã</p>
<h3 id="32-microsoftextensionsvectordata-mevdç»ä¸çè¯­ä¹å­å¨æ½è±¡"><strong>3.2 Microsoft.Extensions.VectorData (MEVD)ï¼ç»ä¸çè¯­ä¹å­å¨æ½è±¡</strong></h3>
<p>éçæ£ç´¢å¢å¼ºçæï¼RAGï¼æä¸ºä¼ä¸çº§ AI åºç¨çæ éï¼åéæ°æ®åºçéæå¤æåº¦æ¥çå¢å ãMEVD çåºç°æ¨å¨è§£å³åéå­å¨ API çä¸¥éç¢çåé®é¢ã</p>
<p>MEVD å®ä¹äºä¸å¥ç±»ä¼¼äº ORMï¼å¯¹è±¡å³ç³»æ å°ï¼çæ½è±¡ï¼åè®¸å¼åèä½¿ç¨ C# ç¹æ§æ æ³¨ï¼Attributeï¼æ¥å®ä¹æ°æ®æ¨¡åä¸­çåéå±æ§ãä¸»é®åæ°æ®å­æ®µãè¯¥æ¨¡åçæ ¸å¿ä»·å¼å¨äºå®å°âææ¬å°åéçè½¬æ¢âä¸âåéå­å¨ç CRUD æä½âè¿è¡äºè§£è¦ãéè¿ä¸ IEmbeddingGenerator æ¥å£çéåï¼ç³»ç»å¯ä»¥èªå¨å¤çåµå¥åéççæä¸åæ­¥ï¼å¼åèåªéå³æ³¨é«çº§å«çæç´¢æ¥å£ï¼å¦æ··åæç´¢ãå³é®è¯è¿æ»¤ç­ï¼ãä¸è¡¨å±ç¤ºäº MEVD ç®åå¨.NET çæä¸­çä¸»æµééæåµï¼</p>
<table>
<thead>
<tr>
<th style="text-align: left">ééæ°æ®åº</th>
<th style="text-align: left">ç¶æ</th>
<th style="text-align: left">å¼åèæ¶ç</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><strong>Azure AI Search</strong></td>
<td style="text-align: left">GA å®ç°</td>
<td style="text-align: left">ä¼ä¸çº§ãé«å¯ç¨ãéæå®å¨æ§çæç´¢æå¡æ¯æ</td>
</tr>
<tr>
<td style="text-align: left"><strong>Qdrant</strong></td>
<td style="text-align: left">GA å®ç°</td>
<td style="text-align: left">éå¯¹é«æ§è½ãå¤§è§æ¨¡åéæ£ç´¢çä¸ä¸åå¼ææ¯æ</td>
</tr>
<tr>
<td style="text-align: left"><strong>Cosmos DB</strong></td>
<td style="text-align: left">é¢è§/éæ</td>
<td style="text-align: left">å¨ç°æç NoSQL æ°æ®åºä¸­æ ç¼æ©å±è¯­ä¹æç´¢</td>
</tr>
<tr>
<td style="text-align: left"><strong>In-Memory</strong></td>
<td style="text-align: left">é¢è§</td>
<td style="text-align: left">æéçæ¬å°å¼åä¸ååæµè¯ä½éª</td>
</tr>
</tbody>
</table>
<h3 id="33-ç®åä¸æ§è½ä¼åsystemnumericstensors-ççªç ´"><strong>3.3 ç®åä¸æ§è½ä¼åï¼System.Numerics.Tensors ççªç ´</strong></h3>
<p>å¨.NET 9 å.NET 10 ä¸­ï¼å¹³å°å±é¢å¯¹ AI è®¡ç®çåºå±ä¼åè¾¾å°äºæ°çé«åº¦ãSystem.Numerics.Tensors åºå¼å¥äº TensorPrimitivesï¼ä¸ºè·¨ Span çæ°å­¦è¿ç®æä¾äºç¡¬ä»¶çº§å«ç AVX10 å éãè¿ç§ä¼åç´æ¥æåäºå¨.NET ä¸­æ¬å°è¿è¡å°åè¯­è¨æ¨¡åï¼SLMï¼æè¿è¡å¤§è§æ¨¡åéç¸ä¼¼åº¦è®¡ç®çæçãæ­¤å¤ï¼æ°çå®éªæ§ Tensor&lt;T&gt; ç±»åæä¾äºæ´é«æçå¤ç»´æ°æ®æä½è½åï¼å¤§å¹åå°äºå¨ä¸ ONNX Runtime æ ML.NET äº¤äºè¿ç¨ä¸­çåå­æ·è´å¼éã</p>
<h2 id="4-microsoft-agent-framework-çæ¶ææ·±æ½"><strong>4. Microsoft Agent Framework çæ¶ææ·±æ½</strong></h2>
<p>Microsoft Agent Framework çè®¾è®¡ç®æ æ¯è§£å³å¤æ AI ç³»ç»å¨ä»âå®éªå®¤åç ç©¶âè½¬åâçäº§ç¯å¢é¨ç½²âæ¶é¢ä¸´çåå¤§ææï¼äºæä½æ§ãç ç©¶åçäº§çè½¬åæçãå¯æ©å±æ§ä»¥åå¯è§å¯æ§ ã</p>
<h3 id="41-ä»£çæ¨¡åçè¿åaiagent-ä¸-chatclientagent"><strong>4.1 ä»£çæ¨¡åçè¿åï¼AIAgent ä¸ ChatClientAgent</strong></h3>
<p>å¨ MAF æ¶æä¸­ï¼ä»£çè¢«å®ä¹ä¸ºå·å¤æ¨çãè§ååæ§è¡è½åçèªä¸»è½¯ä»¶ç»ä»¶ï¼èä¸ä»ä»æ¯ä¸ä¸ªå°è£äºæç¤ºè¯çå½æ°ãMAF å¼å¥äº AIAgent è¿ä¸æ ¸å¿æ½è±¡ï¼å¶è®¾è®¡ç¸æ¯ Semantic Kernel ç Agent ç±»æ´å æ¨¡ååä¸ä¸åå¼ºä¾èµäº Kernel å¯¹è±¡ã</p>
<p>æå¸¸ç¨çå®ç°ç±»æ¯ ChatClientAgentï¼å®åºäº IChatClient æå»ºï¼è¿æå³çå®å¯ä»¥å©ç¨ä»»ä½ç¬¦å MEAI æ åçæ¨¡å ãè¿ç§è®¾è®¡å¸¦æ¥çä¸ä¸ªå·¨å¤§ä¼å¿æ¯ä»£ççç®åå®ä¹ï¼å¼åèå¯ä»¥éè¿å¯¥å¯¥æ°è¡ä»£ç ï¼ä¸ºä¸ä¸ªä»£çéç½®æä»¤ãå·¥å·éä»¥åç¹å®çä¸­é´ä»¶é»è¾ 4ã</p>
<h3 id="42-è§£å³ai-å¥å¿çagentthread-ä¸æä¹åç¶æç®¡ç"><strong>4.2 è§£å³âAI å¥å¿çâï¼AgentThread ä¸æä¹åç¶æç®¡ç</strong></h3>
<p>ä¼ ç»ç AI èå¤©åºç¨å¾å¾ä¾èµäºæå¤±æ§çå¯¹è¯åå²ç®¡çï¼è¿å¨å¤æçé¿ç¨ä»»å¡ä¸­ä¼å¯¼è´ä¸¥éçä¸ä¸æä¸¢å¤±é®é¢ãMAF éè¿ AgentThread å¯¹è±¡å½»åºè§£å³äºè¿ä¸çç¹ ã</p>
<p>AgentThread ä¸ä»ä»æ¯ä¸ä¸ªæ¶æ¯åè¡¨ï¼å®å°è£äºæ´ä¸ªå¯¹è¯ççå½å¨æåä¸ä¸æç¶æãMAF æ¯æå° AgentThread çç¶æè¿è¡åºååå¹¶æä¹åå°å¤é¨æ°æ®åºï¼å¦ Cosmos DBï¼ä¸­ ãè¿ç§âå¿«ç§ä¸æ¢å¤âæºå¶å·ææå¼ºçå·¥ç¨æä¹ï¼ä¸ä¸ªéè¦èæ¶æ°å°æ¶çè³æ°å¤©çå¤æä¸å¡æµç¨ï¼ä¾å¦è´¢å¡æ¥åçææä¾åºé¾åæï¼ï¼å¯ä»¥å¨æ§è¡è¿ç¨ä¸­éæ¶æèµ·ï¼å¹¶å¨æå¡å¨éå¯æç¯å¢è¿ç§»åä»ç²¾ç¡®çæ­ç¹å¤éæ°æ¿æ´»ã</p>
<h3 id="43-å·¥å·ä¸å½æ°è°ç¨çè§£è¦"><strong>4.3 å·¥å·ä¸å½æ°è°ç¨çè§£è¦</strong></h3>
<p>å¨ Semantic Kernel ä¸­ï¼å½æ°è°ç¨é«åº¦ä¾èµäº [KernelFunction] ç¹æ§åå¤æçæä»¶æ³¨åé»è¾ãMAF æå¤§å°ç®åäºè¿ä¸è¿ç¨ï¼åè®¸å¼åèç´æ¥å°æ åç C# å½æ°ä½ä¸ºä»£çå·¥å·ï¼AIFunctionï¼è¿è¡æ³¨åï¼ä¸æ éå¨ä¸å¡ä»£ç ä¸­æ£å¸æ¡æ¶ç¹å®ç Attributeãè¿ç§æ¹è¿ä¸ä»å¢å¼ºäºä»£ç ççº¯ååº¦ï¼ä¹ä½¿å¾ååæµè¯åæ¨¡åéç¨åå¾æ´å å®¹æã</p>
<h2 id="5-ç¼æçèºæ¯ä»åä¸ä»£çå°å¤ä»£çå·¥ä½æµ"><strong>5. ç¼æçèºæ¯ï¼ä»åä¸ä»£çå°å¤ä»£çå·¥ä½æµ</strong></h2>
<p>éçä»»å¡å¤æåº¦çæåï¼åä¸ä»£çå¾å¾ä¼é¢ä¸´âè®¤ç¥è´è·âè¿éçé®é¢ï¼ç¹å«æ¯å½å·¥å·æ°éè¶è¿ 20 ä¸ªæ¶ï¼æ¨¡åçè§åæåçä¼æ¾èä¸é ãä¸ºæ­¤ï¼MAF å¼å¥äºä¸¤å¥äºè¡¥çç¼ææºå¶ï¼åºäº LLM æ¨ççå¨æä»£çåä½ååºäºä¸å¡é»è¾çç¡®å®æ§å·¥ä½æµã</p>
<h3 id="51-å¤ä»£çåä½æ¨¡å¼-orchestration-patterns"><strong>5.1 å¤ä»£çåä½æ¨¡å¼ (Orchestration Patterns)</strong></h3>
<p>MAF æ·±åº¦æ´åäº AutoGen é¡¹ç®ä¸­æå·åæ°æ§çå¤ä»£çäº¤äºæ¨¡å¼ï¼å¹¶ä¸ºå¶æä¾äºä¼ä¸çº§çå åº 1ã</p>
<table>
<thead>
<tr>
<th style="text-align: left">æ¨¡å¼</th>
<th style="text-align: left">æ ¸å¿é»è¾</th>
<th style="text-align: left">å¸ååºæ¯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><strong>é¡ºåºæ¨¡å¼ (Sequential)</strong></td>
<td style="text-align: left">ä»£çé´å½¢æåºå®çæ¥åé¾è·¯ï¼è¾åºèªå¨è½¬ä¸ºä¸ä¸ç¯èè¾å¥</td>
<td style="text-align: left">åå®¹å®¡æ ¸æµæ°´çº¿ï¼åä½ä»£ç -&gt; è¯­æ³æ£æ¥ä»£ç -&gt; åè§å®¡æ¥ä»£ç</td>
</tr>
<tr>
<td style="text-align: left"><strong>å¹¶åæ¨¡å¼ (Concurrent)</strong></td>
<td style="text-align: left">ä»»å¡è¢«æè§£å¹¶ååç»å¤ä¸ªä¸å®¶ä»£çå¹¶è¡å¤çï¼æåç±æ±æ»ä»£çæ´å 25</td>
<td style="text-align: left">æ³å¾åè§æ§åæï¼å¤ä¸ªä»£çåå«æ£æ¥ä¸åçæ³å¾æ¡æ</td>
</tr>
<tr>
<td style="text-align: left"><strong>ç§»äº¤æ¨¡å¼ (Handoff)</strong></td>
<td style="text-align: left">ä»£çæ ¹æ®å¯¹è¯æå¾ä¸»å¨å°æ§å¶æè½¬äº¤ç»å¦ä¸ä¸ªæ´ä¸ä¸çä»£ç</td>
<td style="text-align: left">å®¢æ·æå¡åæ¨ï¼åçº§ä»£çè¯å«æå¾åè½¬äº¤ç»è´¢å¡æææ¯ä¸å®¶</td>
</tr>
<tr>
<td style="text-align: left"><strong>ç¾¤èæ¨¡å¼ (Group Chat)</strong></td>
<td style="text-align: left">å¨ç®¡çå¨åè°ä¸ï¼å¤ä¸ªä»£çéè¿å¤è½®å¯¹è¯å±åè§£å³å¼æ¾æ§é®é¢</td>
<td style="text-align: left">å¤æçæ¶æè®¾è®¡æå¤´èé£æ´ä»»å¡</td>
</tr>
</tbody>
</table>
<h3 id="52-magentic-oneéç¨å¤ä»£çç³»ç»çå·å³°"><strong>5.2 Magentic-Oneï¼éç¨å¤ä»£çç³»ç»çå·å³°</strong></h3>
<p>Magentic-One æ¯ MAF ä¸­æåç©ç®çç¼ææ¨¡å¼ï¼ä»£è¡¨äºç®åå¾®è½¯å¨å¤ä»£çååé¢åçæé«æ°´å¹³ ãå®éç¨ä¸ç§âä¸»å¯¼è-ä¸å®¶âæ¶æï¼ç±ä¸ä¸ª Magentic ç®¡çå¨ï¼Managerï¼ææ¥ä¸ç»é«åº¦ä¸ä¸åçä»£çï¼å¦ WebSurferï¼è´è´£ç½é¡µæµè§ï¼ãFileSurferï¼è´è´£æä»¶å¤çï¼å Coderï¼è´è´£ä»£ç æ§è¡ï¼ ã</p>
<p>Magentic ç®¡çå¨çç¬ç¹ä¹å¤å¨äºå¶åç¯è§åæºå¶ï¼</p>
<ul>
<li><strong>å¤ç¯ï¼ä»»å¡è´¦æ¬ (Task Ledger)</strong>ãè´è´£ç»´æ¤å¨å±ç®æ ãå·²ç¥äºå®åæ»ä½è§å ã</li>
<li><strong>åç¯ï¼è¿åº¦è´¦æ¬ (Progress Ledger)</strong>ãå¨æ¯ä¸æ­¥æ§è¡åè¿è¡èªæåæï¼è¯ä¼°å½åæ­¥éª¤æ¯å¦æåè¾¾æé¢å®å­ç®æ ï¼å¹¶å¨æè°æ´åç»­è¡å¨ 27ã</li>
</ul>
<p>è¿ç§æ¨¡å¼éå¸¸éåäºé£äºè§£å³æ¹æ¡è·¯å¾æªç¥ãéè¦å¤ååæ¨çåå¤é¨å·¥å·åå¤äº¤äºçå¤æå¼æ¾å¼ä»»å¡ã</p>
<h2 id="6-åºäºå¾çå·¥ä½æµ-workflowsä¼ä¸çº§ç¡®å®æ§çä¿é"><strong>6. åºäºå¾çå·¥ä½æµ (Workflows)ï¼ä¼ä¸çº§ç¡®å®æ§çä¿é</strong></h2>
<p>å¦æè¯´å¤ä»£çç¼æä½ç°äº AI çâçµæ§âï¼é£ä¹ MAF çå·¥ä½æµç³»ç»åä½ç°äºä¼ä¸åºç¨æéçâä¸¥è°¨âãå·¥ä½æµåè®¸å¼åèéè¿å¾å½¢ç»ææ¾å¼å°å®ä¹ä»»å¡æ§è¡è·¯å¾ã</p>
<h3 id="61-å¾å½¢ç¼æä¸ç±»åå®å¨"><strong>6.1 å¾å½¢ç¼æä¸ç±»åå®å¨</strong></h3>
<p>MAF å·¥ä½æµéç¨ Directed Graphï¼æåå¾ï¼æ¨¡åãæ¯ä¸ä¸ªèç¹é½æ¯ä¸ä¸ªæ§è¡å¨ï¼Executorï¼ï¼å¯ä»¥æ¯ä¸ä¸ª AIAgent æèæ¯ä»»ä½èªå®ä¹ç C# é»è¾ï¼èç¹ä¹é´çè¿æ¥åç±è¾¹ç¼ï¼Edgeï¼å®ä¹ã</p>
<p>è¿ç§è®¾è®¡çæ ¸å¿ä¼å¿å¨äºâç±»åå®å¨ï¼Type Safetyï¼âãå¨å·¥ä½æµæ§è¡åï¼æ¡æ¶ä¼éªè¯æ¶æ¯å¨èç¹é´æµå¨çå¥çº¦ä¸è´æ§ï¼ä»èé²æ­¢å¨é¿ç¨ä»»å¡ä¸­åºç°è¿è¡æ¶éè¯¯ ãå¼åèå¯ä»¥ä½¿ç¨ WorkflowBuilder ä»¥å£°æå¼çæ¹å¼æå»ºå¤æçéçº¿æ§é»è¾ï¼åæ¬æ¡ä»¶è·¯ç±ãå¾ªç¯è¿­ä»£åå¼å¸¸å¤çã</p>
<h3 id="62-æ£æ¥ç¹-checkpointing-ä¸é¿æä»»å¡æ¢å¤"><strong>6.2 æ£æ¥ç¹ (Checkpointing) ä¸é¿æä»»å¡æ¢å¤</strong></h3>
<p>å·¥ä½æµç³»ç»æå³é®ççäº§ç¹æ§æ¯æ£æ¥ç¹æºå¶ãå¨æ¯ä¸ä¸ªâè¶çº§æ­¥ï¼Super Stepï¼âè¾¹çï¼æ¡æ¶ä¼èªå¨æè·å½åæææ§è¡å¨çç¶æå¹¶å°å¶æä¹åã</p>
<p>è¿ç§æºå¶å¯¹äºéè¦âäººç±»åä¸ï¼Human-in-the-Loopï¼âçä»»å¡è³å³éè¦ãä¾å¦ï¼å¨ä¸ä¸ªéè´­å®¡æ¹æµç¨ä¸­ï¼ä»£çå¯ä»¥å¤çåæçä¾åºåå¯¹æ¯åé£é©è¯ä¼°ï¼ç¶åå·¥ä½æµå¨âç­å¾è´¢å¡æ»çå®¡æ¹âè¿ä¸èç¹èªå¨è¿å¥ä¼ç ç¶æå¹¶åå»ºæ£æ¥ç¹ãå³ä¾¿å®¡æ¹è¿ç¨æç»­æ°å¤©ï¼ç³»ç»ä¹å¯ä»¥å¨è·å¾æ¹åä¿¡å·åï¼éè¿âéæ°è¡¥æ°´ï¼Rehydrationï¼âä»ç²¾ç¡®çæ£æ¥ç¹å¤ç¬é´æ¢å¤ï¼èæ ééæ°è¿è¡ä¹åçèæ¶æ¨çæ­¥éª¤ ã</p>
<h2 id="7-æ åååè®®ä¸äºæä½æ§mcp-ä¸-a2a"><strong>7. æ åååè®®ä¸äºæä½æ§ï¼MCP ä¸ A2A</strong></h2>
<p>å¾®è½¯å¨ MAF ä¸­å¹¶æ²¡æèµ°å°é­çæçè·¯çº¿ï¼èæ¯æåæ¨å¨æ åçå»ºç«ï¼ä»¥è§£å³ä»£çä¸å¤çç¯å¢ãä»£çä¸ä»£çä¹é´çæ²ééç¢ã</p>
<h3 id="71-æ¨¡åä¸ä¸æåè®®-mcp"><strong>7.1 æ¨¡åä¸ä¸æåè®® (MCP)</strong></h3>
<p>MCP æ¯ MAF ä¸­å¼å¥çä¸ä¸ªåæ¶ä»£çæ åãå®åè®¸ä»£çå¨æå°åç°åè¿æ¥å°å¤é¨å·¥å·æå¡å¨ï¼èæ éä¸ºæ¯ä¸ä¸ª API ç¼åèªå®ä¹é©±å¨ãå¨ MAF ä¸­ï¼ä¸ä¸ªä»£çå¯ä»¥ä½ä¸ºä¸ä¸ª MCP Clientï¼å®æ¶æ¥è¯¢ MCP Server æ´é²çå·¥å·åè¡¨ãèµæºåæç¤ºè¯æ¨¡æ¿ãè¿ç§è§£è¦æå¤§å°å¢å¼ºäºç³»ç»ççµæ´»æ§ï¼ä½¿å¾åä¸ä¸ªä»£çå¯ä»¥å¨ä¸åçä¼ä¸ç¯å¢ä¸­å¿«éåæ¢å¶å¯è°ç¨çèµæºã</p>
<h3 id="72-ä»£çé´åè®®-a2a"><strong>7.2 ä»£çé´åè®® (A2A)</strong></h3>
<p>ä¸ºäºå®ç°è·¨è¿è¡æ¶ãè·¨å°åçå¤ä»£çåä½ï¼MAF å®ç°äº A2A åè®®ãè¯¥åè®®å®ä¹äºä¸å¥æ åçãåºäºæ¶æ¯çéè®¯è§èï¼ä½¿å¾è¿è¡å¨ Azure AI Foundry ä¸ç.NET ä»£çå¯ä»¥ä¸è¿è¡å¨æ¬å°æå¡å¨ä¸ç Python ä»£çè¿è¡æ ç¼å¯¹è¯ ãè¿ç§äºæä½æ§ç¡®ä¿äºä¼ä¸å¯ä»¥å©ç¨ä¸åææ¯æ çä¼å¿ï¼æå»ºèµ·ä¸ä¸ªçæ­£æä¹ä¸çâä»£çç½ç»âã</p>
<h2 id="8-çäº§çº§è§æµä¸æ²»çå¯è§å¯æ§ä¸è´è´£ä»»ç-ai"><strong>8. çäº§çº§è§æµä¸æ²»çï¼å¯è§å¯æ§ä¸è´è´£ä»»ç AI</strong></h2>
<p>å¨ä¼ä¸çº§é¨ç½²ä¸­ï¼AI çâå¯æ§æ§âå¾å¾ä¼äºâåé åâãMAF å¨è®¾è®¡ä¹åå°±å°çæ§åæ²»çæ´åè¿äºè¿è¡æ¶ã</p>
<h3 id="81-åºäº-opentelemetry-çåå¸å¼è¿½è¸ª"><strong>8.1 åºäº OpenTelemetry çåå¸å¼è¿½è¸ª</strong></h3>
<p>MAF åçæ¯æ OpenTelemetryï¼è¿æå³çä»£ççæ¯ä¸æ¬¡æèãæ¯ä¸æ¬¡å·¥å·è°ç¨ä»¥åæ¯ä¸ä¸ª Token çæ¶èï¼é½å¯ä»¥è¢«å®æ¶è®°å½å¹¶ä¼ è¾å° Azure Monitor æ Jaeger ç­è§æµå¹³å° 32ãå¼åèå¯ä»¥ç´è§å°æ¥çâä»£çå¯¹è¯æµå¾âï¼åæç¶é¢ï¼å¹¶å¯¹ç±äºæ¨¡åéæ©ä¸å½ææç¤ºè¯è¿é¿å¯¼è´çææ¬å¼å¸¸è¿è¡å¿«éååº ã</p>
<h3 id="82-è´è´£ä»»ç-ai-ä¸å®å¨é²æ¤"><strong>8.2 è´è´£ä»»ç AI ä¸å®å¨é²æ¤</strong></h3>
<p>ä¸ºäºé²æ­¢ä»£çå¨èªä¸»æ§è¡è¿ç¨ä¸­åºç°âå¹»è§âæè¢«æ¶æå©ç¨ï¼MAF å¼å¥äºå¤é¡¹å®å¨é²æ¤æªæ½ï¼</p>
<ul>
<li><strong>ä»»å¡ä¾ä»æ§çæµ (Task Adherence)</strong>ï¼å®æ¶è¯ä¼°ä»£ççè¾åºæ¯å¦ç¬¦åå¶è®¾å®çåå§æä»¤ï¼é²æ­¢å¶è¢«å¼å¯¼è³æ å³é¢å 3ã</li>
<li><strong>æç¤ºè¯æ¤ç¾ (Prompt Shields)</strong>ï¼å©ç¨ Spotlighting ç­åè¿ææ¯ï¼è¯å«å¹¶æ¦æªæ½å¨çæç¤ºè¯æ³¨å¥æ»å»ï¼ç¡®ä¿æ ¸å¿æä»¤ä¸è¢«ç¯¡æ¹ 3ã</li>
<li><strong>PII éç§æ£æµ</strong>ï¼å¨åéç»å¬æäºæ¨¡åä¹åï¼èªå¨æ«æå¹¶é®çææ¬ä¸­çä¸ªäººèº«ä»½ä¿¡æ¯ï¼ç¡®ä¿æ°æ®åè§ 3ã</li>
</ul>
<h2 id="9net-ai-æ¡æ¶éæ©å³ç­å»ºè®®"><strong>9..NET AI æ¡æ¶éæ©å³ç­å»ºè®®</strong></h2>
<p>é¢å¯¹å¿«éæ¼è¿ççæç³»ç»ï¼ææ¯å³ç­èåºæ ¹æ®é¡¹ç®å·ä½ççå½å¨æåä¸å¡å¤æåº¦è¿è¡éæ©ã</p>
<h3 id="91-å³ç­ç©éµä»ä¹æ¶åéæ©ä»ä¹æ¡æ¶"><strong>9.1 å³ç­ç©éµï¼ä»ä¹æ¶åéæ©ä»ä¹æ¡æ¶ï¼</strong></h3>
<p>ä¸è¡¨æ ¹æ®å½å.NET AI çæçææ°ç¶æï¼ä¸ºå¼åèæä¾äºå·ä½çéæ©å»ºè®®ï¼</p>
<table>
<thead>
<tr>
<th style="text-align: left">éæ±ç¹å¾</th>
<th style="text-align: left">æ¨èéæ©</th>
<th style="text-align: left">çç±</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><strong>æ°å¯å¨çãæ¨å¨æå»ºèªä¸» AI ç³»ç»çé¡¹ç®</strong></td>
<td style="text-align: left"><strong>Microsoft Agent Framework (MAF)</strong></td>
<td style="text-align: left">å®æ¯å®æ¹ç»§ä»»èï¼æ¥ææå¨çå¤ä»£çç¼æåæä¹ååè½ï¼ä»£è¡¨æªæ¥ææ¯æ¹åã</td>
</tr>
<tr>
<td style="text-align: left"><strong>å·²æçãå¤äºç¨³å®è¿è¡æçä¼ä¸çº§ AI å¢å¼ºåºç¨</strong></td>
<td style="text-align: left"><strong>Semantic Kernel (v1.x)</strong></td>
<td style="text-align: left">ä¿æç¨³å®æ§ï¼é¤éæå¤æçå¤ä»£çåä½æé¿ç¨ä»»å¡æ¢å¤éæ±ï¼å¦åä¸å»ºè®®ç«å³éæ ã</td>
</tr>
<tr>
<td style="text-align: left"><strong>ä»éè¿è¡åºç¡èå¤©æç®å RAG åè½å¼å</strong></td>
<td style="text-align: left"><strong>Microsoft.Extensions.AI/VectorData</strong></td>
<td style="text-align: left">ç´æ¥ä½¿ç¨åºå±æ½è±¡å¯è·å¾æä½çæ¡æ¶å¼éåæé«ççµæ´»æ§ã</td>
</tr>
<tr>
<td style="text-align: left"><strong>é«åº¦æºå¯çãéè¦å¯¹ä»£ç compute è¿è¡å®å¨æ§å¶çåºæ¯</strong></td>
<td style="text-align: left"><strong>MAF + Azure Container Apps</strong></td>
<td style="text-align: left">MAF çå®¹å¨åæ¯æåè®¸å¨åæ§ç¯å¢ä¸è¿è¡å¤æçä»£çç¼æä»£ç  1ã</td>
</tr>
<tr>
<td style="text-align: left"><strong>éè¦è·¨è¯­è¨ï¼Python +.NETï¼åä½çå¤æç³»ç»</strong></td>
<td style="text-align: left"><strong>MAF (å©ç¨ A2A åè®®)</strong></td>
<td style="text-align: left">å®æ¯ç®åå¯ä¸æä¾è·¨å¹³å°ãæ ååéä¿¡å¥çº¦çæçæ¡æ¶ ã</td>
</tr>
</tbody>
</table>
<h3 id="92-è¿ç§»è·¯çº¿å¾ä»-semantic-kernel-è½¬å-maf"><strong>9.2 è¿ç§»è·¯çº¿å¾ï¼ä» Semantic Kernel è½¬å MAF</strong></h3>
<p>å¯¹äºå³å®è¿ç§»çå¼åå¢éï¼å»ºè®®éç¨æ¸è¿å¼çç­ç¥ãç±äº MAF ç ChatClientAgent ä¸ Semantic Kernel ç ChatCompletionAgent å¨æ¦å¿µä¸é«åº¦å¥åï¼è¿ç§»çç¬¬ä¸æ­¥éå¸¸æ¯æ´æ¢å½åç©ºé´ï¼å¹¶å©ç¨ Microsoft.Extensions.AI çééå¨æ¥å°è£ç°æçæ¨¡åè¿æ¥ ã</p>
<p>æéè¦çååå¨äºç§»é¤å¯¹å¨å± Kernel å¯¹è±¡çä¾èµï¼è½¬èéç¨ä¾èµæ³¨å¥ï¼DIï¼æ¨¡å¼ç®¡çå·ä½ç IChatClientãæ­¤å¤ï¼å¯¹äºåæ¬ä½¿ç¨å¤æ Plugin ç³»ç»çä»£ç ï¼å¯ä»¥éæ­¥ç®åä¸ºç´æ¥æ³¨å C# å½æ°ï¼å©ç¨ MAF ç AIFunctionFactory å®ç°æ´è½»éçº§çå·¥å·éæ ã</p>
<h2 id="10-æ»ç»ä¸å±æè¿åä»£çåçagent-nativeçæªæ¥"><strong>10. æ»ç»ä¸å±æï¼è¿åä»£çåçï¼Agent-Nativeï¼çæªæ¥</strong></h2>
<p>éè¿å¯¹ Microsoft Agent Framework çæ·±åº¦è°æ¥å¯ä»¥åç°ï¼.NET AI çæç³»ç»æ­£å¨ç»åä¸åºä»âåè½éæâåâä»£çåçâçèåãå¾®è½¯éè¿æ´å Semantic Kernel çå·¥ç¨åºå ä¸ AutoGen çåæ°çµé­ï¼ä¸ä»æä¾äºä¸ä¸ªæ´å¼ºå¤§çå¼åå·¥å·ï¼æ´æ¯å¨.NET å¹³å°ä¸ç¡®ç«äºä¸å¥å³äº AI ä»£çå¦ä½æèãåä½ãè®°å¿åæ§è¡çæ åã</p>
<p>æªæ¥ï¼éç.NET 10 å¯¹å¼ éè®¡ç®çè¿ä¸æ­¥å éï¼ä»¥åæ¨¡åä¸ä¸æåè®®ï¼MCPï¼å¨æ´ä¸ªè½¯ä»¶å·¥ä¸ççæ®åï¼æä»¬å¯ä»¥é¢è§ï¼AI ä»£çå°ä»å­¤ç«çå®éªé¡¹ç®è½¬åä¸ºä¼ä¸ IT æ¶æä¸­ä¸å¯æç¼ºçç»æé¨åãMicrosoft Agent Framework çåºç°ï¼æ­£æ¯ä¸ºè¿ä¸å¤©çå°æ¥æ­å»ºå¥½äºæåå®çå·¥ä¸çº§åºåº§ãå¯¹äºå¹¿å¤§.NET å¼åèèè¨ï¼ç°å¨çä»»å¡æ¯ç§¯ææ¥æ±è¿äºæ ååçæ½è±¡ï¼ä»ç®åçå¯¹è¯é»è¾ä¸­è§£æ¾åºæ¥ï¼å»æå»ºé£äºçæ­£è½å¤çè§£ä¸å¡ç®æ ãèªä¸»ååå¹¶åé å®éä¸å¡ä»·å¼çæºè½ç³»ç» ã</p>
<h4 id="å¼ç¨çæç« "><strong>å¼ç¨çæç« </strong></h4>
<ol>
<li>Introducing Microsoft Agent Framework: The Open-Source Engine for Agentic AI Apps <a href="https://devblogs.microsoft.com/foundry/introducing-microsoft-agent-framework-the-open-source-engine-for-agentic-ai-apps/" target="_blank" rel="noopener nofollow">https://devblogs.microsoft.com/foundry/introducing-microsoft-agent-framework-the-open-source-engine-for-agentic-ai-apps/</a></li>
<li>The .NET GenAI Stack - by Building AI Agents in .NET <a href="https://substack.com/home/post/p-184440125" target="_blank" rel="noopener nofollow">https://substack.com/home/post/p-184440125</a></li>
<li>Introducing Microsoft Agent Framework | Microsoft Azure Blog <a href="https://azure.microsoft.com/en-us/blog/introducing-microsoft-agent-framework/" target="_blank" rel="noopener nofollow">https://azure.microsoft.com/en-us/blog/introducing-microsoft-agent-framework/</a></li>
<li>Microsoft Agent Framework: The production-ready convergence of AutoGen and Semantic Kernel - European AI &amp; Cloud Summit  <a href="https://cloudsummit.eu/blog/microsoft-agent-framework-production-ready-convergence-autogen-semantic-kernel" target="_blank" rel="noopener nofollow">https://cloudsummit.eu/blog/microsoft-agent-framework-production-ready-convergence-autogen-semantic-kernel</a></li>
<li>Finally We have answer between AutoGen and Semantic Kernel â Its Microsoft Agent Framework | by Akshay Kokane | Data Science Collective | Medium <a href="https://medium.com/data-science-collective/finally-we-have-answer-between-autogen-and-semantic-kernel-its-microsoft-agent-framework-071e84e0923b" target="_blank" rel="noopener nofollow">https://medium.com/data-science-collective/finally-we-have-answer-between-autogen-and-semantic-kernel-its-microsoft-agent-framework-071e84e0923b</a></li>
<li>.NET AI Essentials - The Core Building Blocks Explained - .NET Blog <a href="https://devblogs.microsoft.com/dotnet/dotnet-ai-essentials-the-core-building-blocks-explained/" target="_blank" rel="noopener nofollow">https://devblogs.microsoft.com/dotnet/dotnet-ai-essentials-the-core-building-blocks-explained/</a></li>
<li>AI and Vector Data Extensions are now Generally Available (GA) - <a href="https://devblogs.microsoft.com/dotnet/ai-vector-data-dotnet-extensions-ga/" target="_blank" rel="noopener nofollow">https://devblogs.microsoft.com/dotnet/ai-vector-data-dotnet-extensions-ga/</a></li>
<li>Semantic Kernel and Microsoft Agent Framework | Semantic Kernel, <a href="https://devblogs.microsoft.com/semantic-kernel/semantic-kernel-and-microsoft-agent-framework/" target="_blank" rel="noopener nofollow">https://devblogs.microsoft.com/semantic-kernel/semantic-kernel-and-microsoft-agent-framework/</a></li>
<li>.NET + AI ecosystem tools and SDKs - .NET | Microsoft Learn,   <a href="https://learn.microsoft.com/en-us/dotnet/ai/dotnet-ai-ecosystem" target="_blank" rel="noopener nofollow">https://learn.microsoft.com/en-us/dotnet/ai/dotnet-ai-ecosystem</a></li>
<li>Semantic Kernel + AutoGen = Open-Source 'Microsoft Agent Framework' <a href="https://visualstudiomagazine.com/articles/2025/10/01/semantic-kernel-autogen--open-source-microsoft-agent-framework.aspx" target="_blank" rel="noopener nofollow">https://visualstudiomagazine.com/articles/2025/10/01/semantic-kernel-autogen--open-source-microsoft-agent-framework.aspx</a></li>
<li>Semantic Kernel vs AutoGen: Which Microsoft Framework Builds Better AI Agents   <a href="https://www.zenml.io/blog/semantic-kernel-vs-autogen" target="_blank" rel="noopener nofollow">https://www.zenml.io/blog/semantic-kernel-vs-autogen</a></li>
<li>Microsoft.Agents.AI (Agent Framework) | ABP.IO Documentation <a href="https://abp.io/docs/latest/framework/infrastructure/artificial-intelligence/microsoft-agent-framework" target="_blank" rel="noopener nofollow">https://abp.io/docs/latest/framework/infrastructure/artificial-intelligence/microsoft-agent-framework</a></li>
<li>Introduction to Microsoft Agent Framework <a href="https://learn.microsoft.com/en-us/agent-framework/overview/agent-framework-overview" target="_blank" rel="noopener nofollow">https://learn.microsoft.com/en-us/agent-framework/overview/agent-framework-overview</a></li>
<li>Hello Microsoft Agent Framework (Bye Bye AutoGen!)  <a href="https://www.gettingstarted.ai/microsoft-agent-framework-replaces-autogen/" target="_blank" rel="noopener nofollow">https://www.gettingstarted.ai/microsoft-agent-framework-replaces-autogen/</a></li>
<li>Build a .NET AI vector search app -  <a href="https://learn.microsoft.com/en-us/dotnet/ai/quickstarts/build-vector-search-app" target="_blank" rel="noopener nofollow">https://learn.microsoft.com/en-us/dotnet/ai/quickstarts/build-vector-search-app</a></li>
<li>Exploring Microsoft.Extensions.VectorData with Qdrant and Azure AI Search  <a href="https://devblogs.microsoft.com/dotnet/vector-data-qdrant-ai-search-dotnet/" target="_blank" rel="noopener nofollow">https://devblogs.microsoft.com/dotnet/vector-data-qdrant-ai-search-dotnet/</a></li>
<li>Announcing .NET 10 - Microsoft Dev Blogs <a href="https://devblogs.microsoft.com/dotnet/announcing-dotnet-10/" target="_blank" rel="noopener nofollow">https://devblogs.microsoft.com/dotnet/announcing-dotnet-10/</a></li>
<li>Introducing Microsoft Agent Framework (Preview): Making AI Agents Simple for Every Developer <a href="https://devblogs.microsoft.com/dotnet/introducing-microsoft-agent-framework-preview/" target="_blank" rel="noopener nofollow">https://devblogs.microsoft.com/dotnet/introducing-microsoft-agent-framework-preview/</a></li>
<li>Semantic Kernel to Microsoft Agent Framework Migration Guide ..., <a href="https://learn.microsoft.com/en-us/agent-framework/migration-guide/from-semantic-kernel/" target="_blank" rel="noopener nofollow">https://learn.microsoft.com/en-us/agent-framework/migration-guide/from-semantic-kernel/</a></li>
<li>AI Agents with Microsoft Agent Framework and Elsa Workflows  <a href="https://sipkeschoorstra.medium.com/ai-agents-with-microsoft-agent-framework-and-elsa-workflows-4870e33a7134" target="_blank" rel="noopener nofollow">https://sipkeschoorstra.medium.com/ai-agents-with-microsoft-agent-framework-and-elsa-workflows-4870e33a7134</a></li>
<li>4 Game-Changing Features in Microsoftâs New AI Agent Framework-You Need to Know About <a href="https://srinivas-mahakud.medium.com/4-game-changing-features-in-microsofts-new-ai-agent-framework-you-need-to-know-about-e7fbcf4fae72" target="_blank" rel="noopener nofollow">https://srinivas-mahakud.medium.com/4-game-changing-features-in-microsofts-new-ai-agent-framework-you-need-to-know-about-e7fbcf4fae72</a></li>
<li>Building Enterprise-Grade AI Agents with Microsoft's Agent Framework - <a href="https://www.pondhouse-data.com/blog/enterprise-ai-with-microsoft-agent-framework" target="_blank" rel="noopener nofollow">https://www.pondhouse-data.com/blog/enterprise-ai-with-microsoft-agent-framework</a></li>
<li>Build Long-Running AI Agents on Azure App Service with Microsoft Agent Framework <a href="https://techcommunity.microsoft.com/blog/appsonazureblog/build-long-running-ai-agents-on-azure-app-service-with-microsoft-agent-framework/4463159" target="_blank" rel="noopener nofollow">https://techcommunity.microsoft.com/blog/appsonazureblog/build-long-running-ai-agents-on-azure-app-service-with-microsoft-agent-framework/4463159</a></li>
<li>Microsoft Agent Framework (Preview): Build AI Agents in .NET | Syncfusion Blogs, <a href="https://www.syncfusion.com/blogs/post/microsoft-agent-framework-preview-ai" target="_blank" rel="noopener nofollow">https://www.syncfusion.com/blogs/post/microsoft-agent-framework-preview-ai</a></li>
<li>agent-framework-dotnet-mcp 1.0.7 on npm - <a href="http://Libraries.io" target="_blank" rel="noopener nofollow">Libraries.io</a>  <a href="https://libraries.io/npm/agent-framework-dotnet-mcp" target="_blank" rel="noopener nofollow">https://libraries.io/npm/agent-framework-dotnet-mcp</a></li>
<li>Microsoft Agent Framework Workflows Orchestrations - Magentic,  <a href="https://learn.microsoft.com/en-us/agent-framework/user-guide/workflows/orchestrations/magentic" target="_blank" rel="noopener nofollow">https://learn.microsoft.com/en-us/agent-framework/user-guide/workflows/orchestrations/magentic</a></li>
<li>Magentic-One â AutoGen - Microsoft Open Source <a href="https://microsoft.github.io/autogen/stable//user-guide/agentchat-user-guide/magentic-one.html" target="_blank" rel="noopener nofollow">https://microsoft.github.io/autogen/stable//user-guide/agentchat-user-guide/magentic-one.html</a></li>
<li>Exploring Semanti Kernel Magentic Agent Orchestratio <a href="https://medium.com/@sainitesh/exploring-semanti-kernel-magentic-agent-orchestration-146deecc4c41" target="_blank" rel="noopener nofollow">https://medium.com/@sainitesh/exploring-semanti-kernel-magentic-agent-orchestration-146deecc4c41</a></li>
<li>Microsoft Agent Framework Workflows | Microsoft Learn <a href="https://learn.microsoft.com/en-us/agent-framework/user-guide/workflows/overview" target="_blank" rel="noopener nofollow">https://learn.microsoft.com/en-us/agent-framework/user-guide/workflows/overview</a></li>
<li>Checkpointing and Resuming Workflows  <a href="https://learn.microsoft.com/en-us/agent-framework/tutorials/workflows/checkpointing-and-resuming" target="_blank" rel="noopener nofollow">https://learn.microsoft.com/en-us/agent-framework/tutorials/workflows/checkpointing-and-resuming</a></li>
<li>microsoft/agent-framework dotnet-1.0.0-nightly-251001.2  <a href="https://newreleases.io/project/github/microsoft/agent-framework/release/dotnet-1.0.0-nightly-251001.2" target="_blank" rel="noopener nofollow">https://newreleases.io/project/github/microsoft/agent-framework/release/dotnet-1.0.0-nightly-251001.2</a></li>
<li>Microsoft.Agents.AI 1.0.0-preview.251001.3   <a href="https://www.nuget.org/packages/Microsoft.Agents.AI/1.0.0-preview.251001.3" target="_blank" rel="noopener nofollow">https://www.nuget.org/packages/Microsoft.Agents.AI/1.0.0-preview.251001.3</a></li>
<li>Build a Multiple-Agent Workflow Automation Solution by using Microsoft Agent Framework - Azure Architecture Center <a href="https://learn.microsoft.com/en-us/azure/architecture/ai-ml/idea/multiple-agent-workflow-automation" target="_blank" rel="noopener nofollow">https://learn.microsoft.com/en-us/azure/architecture/ai-ml/idea/multiple-agent-workflow-automation</a></li>
<li>Microsoft Agent Framework: Advancing The Agentic DevOps Vision - The Futurum Group <a href="https://futurumgroup.com/insights/microsoft-agent-framework-advancing-the-agentic-devops-vision/" target="_blank" rel="noopener nofollow">https://futurumgroup.com/insights/microsoft-agent-framework-advancing-the-agentic-devops-vision/</a></li>
</ol>


</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬¢è¿å¤§å®¶æ«æä¸é¢äºç»´ç æä¸ºæçå®¢æ·ï¼æ¶ä½ ä¸äº</p>
<img src="https://images.cnblogs.com/cnblogs_com/shanyou/57459/o_220125090408_%E9%82%80%E8%AF%B7%E4%BA%8C%E7%BB%B4%E7%A0%81-258px.jpeg" width="170">
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 07:45">2026-02-02 07:45</span>&nbsp;
<a href="https://www.cnblogs.com/shanyou">å¼ åå</a>&nbsp;
éè¯»(<span id="post_view_count">115</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19562239);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19562239', targetLink: 'https://www.cnblogs.com/shanyou/p/19562239', title: '.NET AI çæç³»ç»çéæä¸æ¼è¿ï¼Microsoft Agent Framework å¯¹ Semantic Kernel çç»§æ¿ãè¶è¶ä¸æç¥æ´å' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Debian 13åºäºkubeadmåcontainerdé¨ç½²åèç¹kubernetes ]]></title>
    <link>https://www.cnblogs.com/XY-Heruo/p/19560948</link>
    <guid>65d06c3c748c74eed7eabaa60a18b86c</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/XY-Heruo/p/19560948" title="åå¸äº 2026-02-01 16:03">
    <span role="heading" aria-level="2">Debian 13åºäºkubeadmåcontainerdé¨ç½²åèç¹kubernetes</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        å¨æ¬å°èææºç¯å¢ä¸­ä½¿ç¨ kubeadm+containerd+harbor+cilium æ­å»º Kubernetes éç¾¤
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="åè¨">åè¨</h2>
<p>å¨æ¬å°èææºç¯å¢ä¸­ä½¿ç¨ kubeadm æ­å»º Kubernetes éç¾¤æ¯å­¦ä¹ åå®éªççæ³éæ©ãèèå°å®éåºç¨åºæ¯ä¸­å¯è½å­å¨çç½ç»éå¶ä»¥åéåæå»ºéæ±ï¼æ¬æè¯¦ç»è®°å½äºå¨å®å¨ç¦»çº¿ç¯å¢ä¸é¨ç½²åèç¹ Kubernetes éç¾¤çå®æ´è¿ç¨ãéè¿éæ Harbor ç§æéåä»åºï¼ææ Kubernetes ç»ä»¶éååä»æ¬å° Harbor å®ä¾æåï¼ç¡®ä¿é¨ç½²è¿ç¨çå¯é æ§åå¯éå¤æ§ã</p>
<p>æ¬æåéç¨äºå¸æå¨åéç½ç»ç¯å¢ä¸­å¿«éæ­å»º Kubernetes å®éªç¯å¢çææ¯äººåï¼æ¶µçäºä»ç³»ç»åå§åå° Cilium ç½ç»æä»¶éç½®çå¨æµç¨ã</p>
<h2 id="ç¯å¢åçæ¬ä¿¡æ¯">ç¯å¢åçæ¬ä¿¡æ¯</h2>
<h3 id="åºç¡ç¯å¢éç½®">åºç¡ç¯å¢éç½®</h3>
<ul>
<li><strong>æä½ç³»ç»</strong>ï¼Debian 13 (ä»£å· "Trixie")</li>
<li><strong>ç¡¬ä»¶è§æ ¼</strong>ï¼4 æ ¸ CPU / 4GB åå­ / 40GB å­å¨ç©ºé´</li>
<li><strong>ç½ç»ææ</strong>ï¼åèç¹é¨ç½²ï¼Control Plane + Worker åä¸ï¼</li>
</ul>
<h3 id="è½¯ä»¶çæ¬æ¸å">è½¯ä»¶çæ¬æ¸å</h3>
<table>
<thead>
<tr>
<th>ç»ä»¶</th>
<th>çæ¬</th>
<th>è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td>Kubernetes</td>
<td>v1.33.7</td>
<td>å®¹å¨ç¼æå¹³å°</td>
</tr>
<tr>
<td>containerd</td>
<td>2.2.1</td>
<td>å®¹å¨è¿è¡æ¶</td>
</tr>
<tr>
<td>runc</td>
<td>1.4.0</td>
<td>OCI è¿è¡æ¶è§èå®ç°</td>
</tr>
<tr>
<td>CNI Plugins</td>
<td>1.9.0</td>
<td>å®¹å¨ç½ç»æ¥å£æä»¶</td>
</tr>
<tr>
<td>Harbor</td>
<td>v2.14.2</td>
<td>ä¼ä¸çº§å®¹å¨éåä»åº</td>
</tr>
<tr>
<td>Cilium</td>
<td>v1.18.6</td>
<td>eBPF é©±å¨çç½ç»åå®å¨è§£å³æ¹æ¡</td>
</tr>
<tr>
<td>Helm</td>
<td>3.19.5</td>
<td>Kubernetes åç®¡çå¨</td>
</tr>
</tbody>
</table>
<h3 id="ç½ç»è§å">ç½ç»è§å</h3>
<table>
<thead>
<tr>
<th>IP å°å</th>
<th>ä¸»æºå</th>
<th>è§è²</th>
</tr>
</thead>
<tbody>
<tr>
<td>192.168.0.22</td>
<td>deb13-k8s-node1</td>
<td>Kubernetes èç¹</td>
</tr>
<tr>
<td>192.168.0.42</td>
<td>deb13-harbor</td>
<td>Harbor éåä»åº</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>æ³¨æ</strong>ï¼æ¬ææ¡£åè®¾ä¸¤å°ä¸»æºä½äºåä¸åç½ç¯å¢ä¸­ï¼ä¸ç½ç»è¿éæ§å·²éªè¯ã</p>
</blockquote>
<h2 id="ç³»ç»åå§å">ç³»ç»åå§å</h2>
<p>å¨å¼å§ Kubernetes ç»ä»¶å®è£ä¹åï¼éè¦å¯¹ç³»ç»è¿è¡å¿è¦çåå§åéç½®ï¼ä»¥æ»¡è¶³ Kubernetes çè¿è¡è¦æ±ã</p>
<h3 id="1-å®è£-ipvs-ç¸å³å·¥å·å">1. å®è£ IPVS ç¸å³å·¥å·å</h3>
<p>IPVSï¼IP Virtual Serverï¼æ¯ Linux åæ ¸çè´è½½åè¡¡å®ç°ï¼Kubernetes å¨ IPVS æ¨¡å¼ä¸è¿è¡ kube-proxy æ¶éè¦ç¸å³å·¥å·æ¯æã</p>
<pre><code class="language-bash"># ä»å¨ Kubernetes èç¹æ§è¡
sudo apt update
sudo apt install -y ipvsadm ipset
</code></pre>
<h3 id="2-éç½®ä¸»æºå">2. éç½®ä¸»æºå</h3>
<p>ä¸ºä¾¿äºç®¡çåè¯å«ï¼å»ºè®®ä¸ºæ¯å°ä¸»æºè®¾ç½®ææä¹çä¸»æºåã</p>
<pre><code class="language-bash"># Harbor æå¡å¨
hostnamectl set-hostname deb13-harbor

# Kubernetes èç¹
hostnamectl set-hostname deb13-k8s-node1
</code></pre>
<h3 id="3-éç½®æ¬å°-dns-è§£æ">3. éç½®æ¬å° DNS è§£æ</h3>
<p>ç¼è¾ <code>/etc/hosts</code> æä»¶ï¼æ·»å ä¸»æºåä¸ IP å°åçæ å°å³ç³»ï¼</p>
<pre><code class="language-bash">cat &gt;&gt; /etc/hosts &lt;&lt; EOF
192.168.0.22 deb13-k8s-node1
192.168.0.42 deb13-harbor
EOF
</code></pre>
<h3 id="4-å è½½å¿è¦çåæ ¸æ¨¡å">4. å è½½å¿è¦çåæ ¸æ¨¡å</h3>
<p>Kubernetes ä¾èµç¹å®çåæ ¸æ¨¡åæ¥æ¯æå®¹å¨ç½ç»åè½ãåå»ºæ¨¡åå è½½éç½®å¹¶ç«å³çæï¼</p>
<pre><code class="language-bash"># åå»ºæ¨¡åå è½½éç½®æä»¶
cat &lt;&lt; EOF &gt; /etc/modules-load.d/containerd.conf
overlay
br_netfilter
EOF

# ç«å³å è½½æ¨¡å
sudo modprobe overlay
sudo modprobe br_netfilter

# éªè¯æ¨¡åå è½½ç¶æ
lsmod | grep -E "(overlay|br_netfilter)"
</code></pre>
<h3 id="5-éç½®ç³»ç»åæ ¸åæ°">5. éç½®ç³»ç»åæ ¸åæ°</h3>
<p>è°æ´åæ ¸åæ°ä»¥ä¼åå®¹å¨è¿è¡ç¯å¢ï¼</p>
<pre><code class="language-bash">cat &gt; /etc/sysctl.d/k8s.conf &lt;&lt; EOF
net.ipv4.ip_forward=1
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
vm.swappiness = 0
EOF

# åºç¨éç½®
sudo sysctl --system
</code></pre>
<blockquote>
<p><strong>éè¦æç¤º</strong>ï¼å¦æç³»ç»å¯ç¨äº swap ååºï¼å¿é¡»å¨ Kubernetes å¯å¨åå°å¶å³é­ï¼å¦å kubelet å°æ æ³æ­£å¸¸å¯å¨ãå¯éè¿ä»¥ä¸å½ä»¤ä¸´æ¶å³é­ï¼</p>
</blockquote>
<pre><code class="language-bash">sudo swapoff -a
# æ°¸ä¹å³é­éæ³¨é /etc/fstab ä¸­ç swap ç¸å³è¡
</code></pre>
<h2 id="harbor-ç§æéåä»åºé¨ç½²">Harbor ç§æéåä»åºé¨ç½²</h2>
<p>Harbor ä½ä¸ºä¼ä¸çº§å®¹å¨éåä»åºï¼ä¸ºç¦»çº¿ç¯å¢ä¸ç Kubernetes é¨ç½²æä¾äºå¯é çéåååè½åã</p>
<h3 id="1-åå¤-harbor-å®è£å">1. åå¤ Harbor å®è£å</h3>
<p>ä» <a href="https://github.com/goharbor/harbor/releases" target="_blank" rel="noopener nofollow">Harbor GitHub Releases</a> é¡µé¢ä¸è½½ç¦»çº¿å®è£åï¼çº¦ 600MBï¼ãå®è£ Harbor åéç¡®ä¿ Docker å Docker Compose å·²æ­£ç¡®å®è£ã</p>
<h3 id="2-çæèªç­¾å-tls-è¯ä¹¦">2. çæèªç­¾å TLS è¯ä¹¦</h3>
<p>ç±äº Harbor å¼ºå¶è¦æ± HTTPS è¿æ¥ï¼æä»¬éè¦ä¸º Harbor æå¡å¨çæèªç­¾åè¯ä¹¦ãåå»ºè¯ä¹¦çæèæ¬ï¼</p>
<pre><code class="language-bash"># åå»ºè¯ä¹¦ç®å½
mkdir -p ~/apps/harbor/certs
cd ~/apps/harbor/certs

# åå»ºè¯ä¹¦çæèæ¬
cat &gt; gen-harbor-crt.sh &lt;&lt; 'EOF'
#!/bin/bash

# --- éç½®åæ° ---
DOMAIN="deb13-harbor"       # Harbor åå
IP="192.168.0.42"           # Harbor æå¡å¨åç½ IP
DAYS=3650                   # æææ 10 å¹´

# 1. çæç§é¥ (æ å¯ç )
openssl genrsa -out harbor.key 2048

# 2. åå»º OpenSSL éç½®æä»¶ä»¥åå« SAN
cat &gt; harbor.conf &lt;&lt; CONF_EOF
[req]
distinguished_name = req_distinguished_name
x509_extensions = v3_req
prompt = no

[req_distinguished_name]
CN = ${DOMAIN}

[v3_req]
keyUsage = critical, digitalSignature, keyEncipherment
extendedKeyUsage = serverAuth
subjectAltName = @alt_names

[alt_names]
DNS.1 = ${DOMAIN}
IP.1 = ${IP}
CONF_EOF

# 3. çæèªç­¾åè¯ä¹¦
openssl req -x509 -nodes -days ${DAYS} -key harbor.key -out harbor.crt -config harbor.conf -extensions v3_req

# 4. éªè¯è¯ä¹¦ï¼æ¥çæ¯å¦æ Subject Alternative Name å­æ®µï¼
echo "--------------------------------------------------"
echo "è¯ä¹¦ä¿¡æ¯éªè¯ï¼"
openssl x509 -in harbor.crt -text -noout | grep -A 1 "Subject Alternative Name"

echo "--------------------------------------------------"
echo "çææåï¼"
echo "æå¡ç«¯ä½¿ç¨: harbor.crt, harbor.key"
echo "å®¢æ·ç«¯ (K8s èç¹) ä½¿ç¨: harbor.crt"
EOF

# æ§è¡è¯ä¹¦çæ
chmod +x gen-harbor-crt.sh
./gen-harbor-crt.sh
</code></pre>
<h3 id="3-éç½®-harbor">3. éç½® Harbor</h3>
<p>ä»æ¨¡æ¿æä»¶å¤å¶å¹¶ä¿®æ¹ Harbor éç½®ï¼</p>
<pre><code class="language-bash"># å¤å¶éç½®æ¨¡æ¿
cp harbor.yml.tmpl harbor.yml

# ä¿®æ¹å³é®éç½®é¡¹
</code></pre>
<p>ä¸»è¦éç½®é¡¹å¦ä¸ï¼</p>
<pre><code class="language-yaml"># Harbor è®¿é®å°å
hostname: 192.168.0.42

# HTTPS éç½®
https:
  port: 443
  certificate: /home/rainux/apps/harbor/certs/harbor.crt
  private_key: /home/rainux/apps/harbor/certs/harbor.key

# ç®¡çåå¯ç ï¼è¯·è®¾ç½®å¼ºå¯ç ï¼
harbor_admin_password: your-harbor-password

# æ°æ®åºå¯ç 
database:
  password: your-db-password

# æ°æ®å­å¨è·¯å¾
data_volume: /home/rainux/apps/harbor/data

# æ¥å¿éç½®
log:
  location: /home/rainux/apps/harbor/logs

# å¯ç¨ææ çæ§
metric:
  enabled: true
  port: 9090
  path: /metrics
</code></pre>
<h3 id="4-å¯å¨-harbor-æå¡">4. å¯å¨ Harbor æå¡</h3>
<pre><code class="language-bash">cd ~/apps/harbor
sudo ./install.sh
</code></pre>
<h3 id="5-åå§å-harbor-é¡¹ç®">5. åå§å Harbor é¡¹ç®</h3>
<p>éè¿ Web çé¢è®¿é® Harborï¼<a href="https://192.168.0.42" target="_blank" rel="noopener nofollow">https://192.168.0.42</a>ï¼ï¼ä½¿ç¨éç½®çç®¡çåå¯ç ç»å½åï¼åå»ºä»¥ä¸ä¸¤ä¸ªå¬å¼é¡¹ç®ï¼</p>
<ul>
<li><code>google_containers</code>ï¼ç¨äºå­å¨ Kubernetes æ ¸å¿ç»ä»¶éå</li>
<li><code>cilium</code>ï¼ç¨äºå­å¨ Cilium ç½ç»æä»¶ç¸å³éå</li>
</ul>
<blockquote>
<p><strong>éç½®æ´æ°è¯´æ</strong>ï¼å¦éä¿®æ¹ Harbor éç½®ï¼å¯æ§è¡ä»¥ä¸å½ä»¤ä½¿éç½®çæï¼</p>
<pre><code class="language-bash">sudo ./prepare
docker-compose down -v
sudo docker-compose up -d
</code></pre>
</blockquote>
<h2 id="containerd-å®¹å¨è¿è¡æ¶éç½®">Containerd å®¹å¨è¿è¡æ¶éç½®</h2>
<p>Containerd ä½ä¸ºè½»éçº§å®¹å¨è¿è¡æ¶ï¼æ¯ Kubernetes æ¨èçè¿è¡æ¶éé¡¹ä¹ä¸ã</p>
<h3 id="1-ä¸è½½å¿è¦ç»ä»¶">1. ä¸è½½å¿è¦ç»ä»¶</h3>
<p>ä»å®æ¹ GitHub ä»åºä¸è½½ä»¥ä¸ç»ä»¶ï¼</p>
<ul>
<li><a href="https://github.com/containerd/containerd/releases" target="_blank" rel="noopener nofollow">containerd</a></li>
<li><a href="https://github.com/opencontainers/runc/releases" target="_blank" rel="noopener nofollow">runc</a></li>
<li><a href="https://github.com/containernetworking/plugins/releases" target="_blank" rel="noopener nofollow">CNI Plugins</a></li>
</ul>
<h3 id="2-å®è£-runc">2. å®è£ runc</h3>
<pre><code class="language-bash"># æ³¨æï¼åæä¸­çæä»¶åå¯è½å­å¨ç¬è¯¯ï¼åºä¸º runc.amd64
chmod +x runc.amd64
sudo mv runc.amd64 /usr/local/bin/runc
</code></pre>
<h3 id="3-å®è£-cni-æä»¶">3. å®è£ CNI æä»¶</h3>
<pre><code class="language-bash">sudo mkdir -p /opt/cni/bin/
sudo tar xf cni-plugins-linux-amd64-v1.9.0.tgz -C /opt/cni/bin/
</code></pre>
<h3 id="4-å®è£-containerd">4. å®è£ containerd</h3>
<pre><code class="language-bash">sudo tar xf containerd-2.2.1-linux-amd64.tar.gz
sudo mv bin/* /usr/local/bin/
</code></pre>
<h3 id="5-éç½®-containerd">5. éç½® containerd</h3>
<p>çæé»è®¤éç½®å¹¶è¿è¡å¿è¦çä¿®æ¹ï¼</p>
<pre><code class="language-bash"># åå»º Harbor è¯ä¹¦ç®å½
sudo mkdir -p /etc/containerd/certs.d/192.168.0.42/

# çæé»è®¤éç½®
sudo containerd config default &gt; /etc/containerd/config.toml

# å¤å¶ Harbor è¯ä¹¦
sudo cp ~/apps/harbor/certs/harbor.crt /etc/containerd/certs.d/192.168.0.42/ca.crt
</code></pre>
<p>å³é®éç½®ä¿®æ¹ï¼</p>
<pre><code class="language-toml"># è®¾ç½® Pod æ²ç®±éåæº
[plugins.'io.containerd.cri.v1.images'.pinned_images]
  sandbox = '192.168.0.42/google_containers/pause:3.10'

# éç½®ç§æéåä»åº
[plugins.'io.containerd.cri.v1.images'.registry]
  config_path = '/etc/containerd/certs.d'

# å¯ç¨ systemd cgroup é©±å¨
[plugins.'io.containerd.cri.v1.runtime'.containerd.runtimes.runc.options]
  SystemdCgroup = true
</code></pre>
<h3 id="6-éç½®-systemd-æå¡">6. éç½® systemd æå¡</h3>
<p>ä» <a href="https://raw.githubusercontent.com/containerd/containerd/main/containerd.service" target="_blank" rel="noopener nofollow">å®æ¹ä»åº</a> è·å service æä»¶ï¼</p>
<pre><code class="language-bash">sudo curl -o /usr/lib/systemd/system/containerd.service https://raw.githubusercontent.com/containerd/containerd/main/containerd.service
</code></pre>
<h3 id="7-å¯å¨-containerd-æå¡">7. å¯å¨ containerd æå¡</h3>
<pre><code class="language-bash">sudo systemctl daemon-reload
sudo systemctl enable --now containerd
</code></pre>
<h2 id="kubernetes-ç»ä»¶é¨ç½²">Kubernetes ç»ä»¶é¨ç½²</h2>
<h3 id="1-å®è£-kubernetes-äºè¿å¶æä»¶">1. å®è£ Kubernetes äºè¿å¶æä»¶</h3>
<p>ä» <a href="https://github.com/kubernetes/kubernetes/releases" target="_blank" rel="noopener nofollow">Kubernetes GitHub Releases</a> ä¸è½½ <code>kubernetes-server-linux-amd64.tar.gz</code>ï¼æåæ ¸å¿ç»ä»¶ï¼</p>
<pre><code class="language-bash"># è§£åå¹¶å®è£æ ¸å¿ç»ä»¶
tar xf kubernetes-server-linux-amd64.tar.gz
sudo cp kubernetes/server/bin/{kubeadm,kubelet,kubectl} /usr/local/bin/

# éªè¯æééååè¡¨
kubeadm config images list --kubernetes-version v1.33.7
</code></pre>
<p>å°ååºçææéåï¼åæ¬ pauseãcorednsãetcd ç­ï¼ä»å®æ¹æºæååéæ°ææ ç­¾å¹¶æ¨éå° Harbor ç <code>google_containers</code> é¡¹ç®ä¸­ã</p>
<h3 id="2-éç½®-kubelet-systemd-æå¡">2. éç½® kubelet systemd æå¡</h3>
<p>åå»ºä¸»æå¡æä»¶ <code>/usr/lib/systemd/system/kubelet.service</code>ï¼</p>
<pre><code class="language-ini">[Unit]
Description=kubelet: The Kubernetes Node Agent
Documentation=https://kubernetes.io/docs/
Wants=network-online.target
After=network-online.target

[Service]
ExecStart=/usr/local/bin/kubelet
Restart=always
StartLimitInterval=0
RestartSec=10

[Install]
WantedBy=multi-user.target
</code></pre>
<h3 id="3-åå»º-kubeadm-éç½®ç®å½">3. åå»º kubeadm éç½®ç®å½</h3>
<pre><code class="language-bash">sudo mkdir -p /usr/lib/systemd/system/kubelet.service.d/
</code></pre>
<h3 id="4-éç½®-kubeadm-drop-in-æä»¶">4. éç½® kubeadm drop-in æä»¶</h3>
<p>åå»º <code>/usr/lib/systemd/system/kubelet.service.d/10-kubeadm.conf</code>ï¼</p>
<pre><code class="language-ini"># Note: This dropin only works with kubeadm and kubelet v1.11+
[Service]
Environment="KUBELET_KUBECONFIG_ARGS=--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf"
Environment="KUBELET_CONFIG_ARGS=--config=/var/lib/kubelet/config.yaml"
# This is a file that "kubeadm init" and "kubeadm join" generates at runtime, populating the KUBELET_KUBEADM_ARGS variable dynamically
EnvironmentFile=-/var/lib/kubelet/kubeadm-flags.env
# This is a file that the user can use for overrides of the kubelet args as a last resort. Preferably, the user should use
# the .NodeRegistration.KubeletExtraArgs object in the configuration files instead. KUBELET_EXTRA_ARGS should be sourced from this file.
EnvironmentFile=-/etc/sysconfig/kubelet
ExecStart=
ExecStart=/usr/local/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_KUBEADM_ARGS $KUBELET_EXTRA_ARGS
</code></pre>
<h3 id="5-å¯å¨-kubelet-æå¡">5. å¯å¨ kubelet æå¡</h3>
<pre><code class="language-bash">sudo systemctl daemon-reload
sudo systemctl enable --now kubelet
</code></pre>
<h2 id="éç¾¤åå§å">éç¾¤åå§å</h2>
<h3 id="1-åå»º-kubeadm-éç½®æä»¶">1. åå»º kubeadm éç½®æä»¶</h3>
<p>åå»º <code>kubeadm-config.yaml</code> éç½®æä»¶ï¼</p>
<pre><code class="language-yaml">apiVersion: kubeadm.k8s.io/v1beta4
kind: ClusterConfiguration
kubernetesVersion: v1.33.7
imageRepository: 192.168.0.42/google_containers  # æåæ¬å° Harbor ä»åº
networking:
  podSubnet: "10.10.0.0/16"   # Cilium é»è®¤ Pod ç½æ®µ
  serviceSubnet: "10.96.0.0/12"
---
apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
cgroupDriver: systemd
imageGCHighThresholdPercent: 70   # ç£çä½¿ç¨çè¶è¿ 70% æ¶å¼å§æ¸çéå
imageGCLowThresholdPercent: 60    # æ¸çè³ç£çä½¿ç¨ç 60% æ¶åæ­¢
---
apiVersion: kubeproxy.config.k8s.io/v1alpha1
kind: KubeProxyConfiguration
mode: "ipvs"  # è½ç¶åç»­ä¼ä½¿ç¨ Cilium æ¿ä»£ kube-proxyï¼ä½åå§åé¶æ®µä»ééç½®
</code></pre>
<h3 id="2-æ§è¡éç¾¤åå§å">2. æ§è¡éç¾¤åå§å</h3>
<pre><code class="language-bash">sudo kubeadm init --config kubeadm-config.yaml --ignore-preflight-errors=ImagePull
</code></pre>
<h3 id="3-æ¸ç-kube-proxyä½¿ç¨-cilium-æ¿ä»£">3. æ¸ç kube-proxyï¼ä½¿ç¨ Cilium æ¿ä»£ï¼</h3>
<p>ç±äºæä»¬å°ä½¿ç¨ Cilium ä½ä¸ºç½ç»è§£å³æ¹æ¡ï¼å¯ä»¥ç§»é¤ kube-proxyï¼</p>
<pre><code class="language-bash"># å é¤ kube-proxy DaemonSet
kubectl delete ds kube-proxy -n kube-system

# å¨ææèç¹æ¸ç iptables è§åæ®ç
sudo kube-proxy --cleanup
</code></pre>
<h3 id="4-éªè¯åå§åç¶æ">4. éªè¯åå§åç¶æ</h3>
<p>åå§åå®æåï¼éç½® kubectl å¹¶æ£æ¥éç¾¤ç¶æï¼</p>
<pre><code class="language-bash"># éç½® kubectl
mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config

# æ£æ¥èç¹ç¶æï¼æ­¤æ¶åºæ¾ç¤º NotReadyï¼å ä¸º CNI å°æªå®è£ï¼
kubectl get nodes
kubectl get namespaces
</code></pre>
<h2 id="cilium-ç½ç»æä»¶é¨ç½²">Cilium ç½ç»æä»¶é¨ç½²</h2>
<p>Cilium åºäº eBPF ææ¯æä¾é«æ§è½çç½ç»ãå®å¨åå¯è§æµæ§åè½ã</p>
<h3 id="1-å®è£-cilium-cli">1. å®è£ cilium-cli</h3>
<p>ä» <a href="https://github.com/cilium/cilium-cli/releases" target="_blank" rel="noopener nofollow">Cilium CLI Releases</a> ä¸è½½å¹¶å®è£å½ä»¤è¡å·¥å·ã</p>
<h3 id="2-åå¤-cilium-éå">2. åå¤ Cilium éå</h3>
<p>å° Cilium æéçéåæ¨éå° Harbor ä»åºï¼</p>
<pre><code class="language-bash">#!/bin/bash

set -euo pipefail

images=(
    cilium/cilium:v1.18.6
    cilium/hubble-relay:v1.18.6
    cilium/hubble-ui-backend:v0.13.3
    cilium/hubble-ui:v0.13.3
    cilium/cilium-envoy:v1.35.9-1767794330-db497dd19e346b39d81d7b5c0dedf6c812bcc5c9
    cilium/certgen:v0.3.1
    cilium/startup-script:1755531540-60ee83e
)

src_registry="quay.io"
target_registry="192.168.0.42"

for image in "${images[@]}"; do
    echo "Processing image: ${image}"
    docker pull "${src_registry}/${image}"
    docker tag "${src_registry}/${image}" "${target_registry}/${image}"
    docker push "${target_registry}/${image}"
done
</code></pre>
<h3 id="3-è·å-helm-chart">3. è·å Helm Chart</h3>
<pre><code class="language-bash">helm repo add cilium https://helm.cilium.io/
helm pull cilium/cilium --version 1.18.6
tar xf cilium-1.18.6.tgz
mv cilium cilium-chart
</code></pre>
<h3 id="4-éç½®-chart-values">4. éç½® Chart Values</h3>
<p>é¦åæ¿æ¢ææéåæºå°åï¼</p>
<pre><code class="language-bash">sed -i 's#quay.io#192.168.0.42#g' ./cilium-chart/values.yaml
</code></pre>
<p>å³é®éç½®é¡¹è°æ´ï¼</p>
<pre><code class="language-yaml"># å¯ç¨ kube-proxy æ¿ä»£æ¨¡å¼
kubeProxyReplacement: true

# æå® Kubernetes API æå¡å¨å°å
k8sServiceHost: "192.168.0.22"
k8sServicePort: 6443

# åèç¹é¨ç½²ï¼operator å¯æ¬æ°è®¾ä¸º 1
operator:
  replicas: 1

# å¯ç¨ Hubble å¯è§æµæ§ç»ä»¶
hubble:
  enabled: true
  relay:
    enabled: true
  ui:
    enabled: true

# éç½® IPAM CIDR èå´
ipam:
  operator:
    clusterPoolIPv4PodCIDRList:
      - "10.10.0.0/16"
</code></pre>
<blockquote>
<p><strong>éå Digest æ³¨æäºé¡¹</strong>ï¼éè¿ docker pull å push çæ¹å¼å¯è½å¯¼è´éå digest åçååãå¦ééåæåå¤±è´¥ï¼å¯å° <code>values.yaml</code> ä¸­ç <code>useDigest</code> è®¾ç½®ä¸º <code>false</code>ã</p>
</blockquote>
<h3 id="5-å®è£-cilium">5. å®è£ Cilium</h3>
<pre><code class="language-bash"># æ§è¡å®è£
cilium install --chart-directory ./cilium-chart

# æ£æ¥å®è£ç¶æ
cilium status

# ç§»é¤ control-plane æ±¡ç¹ä»¥åè®¸ Pod è°åº¦
kubectl taint nodes --all node-role.kubernetes.io/control-plane-
</code></pre>
<h3 id="6-éªè¯éç¾¤ç¶æ">6. éªè¯éç¾¤ç¶æ</h3>
<p>ç­å¾ææ Pod æ­£å¸¸è¿è¡åï¼éªè¯éç¾¤å°±ç»ªç¶æï¼</p>
<pre><code class="language-bash"># æ£æ¥ææå½åç©ºé´ç Pod ç¶æ
kubectl get pods -A

# éªè¯èç¹ç¶æï¼åºæ¾ç¤º Readyï¼
kubectl get nodes

# æ£æ¥ Cilium ç»ä»¶ç¶æ
cilium status --verbose
</code></pre>
<h2 id="æ·»å å·¥ä½èç¹æ©å±é¨ç½²">æ·»å å·¥ä½èç¹ï¼æ©å±é¨ç½²ï¼</h2>
<p>å®æåèç¹éç¾¤é¨ç½²åï¼å¦éæ©å±ä¸ºå¤èç¹éç¾¤ï¼å¯å¨æ°èç¹ä¸æ§è¡ä»¥ä¸æ­¥éª¤ï¼</p>
<p><em>å¨æ°èç¹ä¸éè¦åå®æä¸é¢çç³»ç»åå§åãContainerdéç½®ãkubeç»ä»¶éç½®</em></p>
<h3 id="1-çæèç¹å å¥ä»¤ç">1. çæèç¹å å¥ä»¤ç</h3>
<p>å¨ Control Plane èç¹ä¸çæ 24 å°æ¶ææçå å¥ä»¤çï¼</p>
<pre><code class="language-bash">kubeadm token create --print-join-command
</code></pre>
<p>è¯¥å½ä»¤å°è¾åºç±»ä¼¼ä»¥ä¸æ ¼å¼çå å¥å½ä»¤ï¼</p>
<pre><code class="language-bash">kubeadm join 192.168.0.22:6443 --token &lt;token&gt; --discovery-token-ca-cert-hash sha256:&lt;hash&gt;
</code></pre>
<h3 id="2-å¨æ°èç¹æ§è¡å å¥å½ä»¤">2. å¨æ°èç¹æ§è¡å å¥å½ä»¤</h3>
<p>å¨æ°èç¹ä¸æ§è¡ä¸è¿°å½ä»¤ï¼å¹¶å¿½ç¥éåé¢æ£éè¯¯ï¼</p>
<pre><code class="language-bash">sudo kubeadm join 192.168.0.22:6443 \
  --token &lt;token&gt; \
  --discovery-token-ca-cert-hash sha256:&lt;hash&gt; \
  --ignore-preflight-errors=ImagePull
</code></pre>
<h3 id="3-éªè¯èç¹å å¥ç¶æ">3. éªè¯èç¹å å¥ç¶æ</h3>
<pre><code class="language-bash"># æ£æ¥èç¹åè¡¨
kubectl get nodes

# éªè¯ Cilium ç¶æ
cilium status

# æ¸ç iptables è§åï¼å¦å·²ç¦ç¨ kube-proxyï¼
sudo iptables -F
</code></pre>
<p>Cilium ä¼èªå¨å¨æ°èç¹ä¸é¨ç½²ä»£ç Podï¼ç¡®ä¿ç½ç»è¿éæ§ã</p>
<h2 id="ç§æéåä»åºè®¤è¯éç½®">ç§æéåä»åºè®¤è¯éç½®</h2>
<p>å¯¹äº Harbor ä¸­éå¬å¼é¡¹ç®çéåæåï¼éè¦éç½®ç¸åºçè®¤è¯æºå¶ã</p>
<h3 id="æ¹å¼ä¸pod-çº§å«-imagepullsecretsæ¨è">æ¹å¼ä¸ï¼Pod çº§å« imagePullSecretsï¼æ¨èï¼</h3>
<p>éç¨äºéè¦ç²¾ç»åæ§å¶éåæåæéçåºæ¯ã</p>
<h4 id="1-åå»º-docker-registry-secret">1. åå»º Docker Registry Secret</h4>
<pre><code class="language-bash">kubectl create secret docker-registry harbor-pull-secret \
  --docker-server=192.168.0.42 \
  --docker-username=&lt;your-username&gt; \
  --docker-password=&lt;your-password&gt; \
  --docker-email=&lt;your-email&gt;
</code></pre>
<h4 id="2-å¨-pod-å®ä¹ä¸­å¼ç¨-secret">2. å¨ Pod å®ä¹ä¸­å¼ç¨ Secret</h4>
<pre><code class="language-yaml">apiVersion: v1
kind: Pod
spec:
  containers:
  - name: my-app
    image: 192.168.0.42/private-project/my-image:v1
  imagePullSecrets:
  - name: harbor-pull-secret
</code></pre>
<h3 id="æ¹å¼äºserviceaccount-ç»å®ä¾¿æ·æ¹æ¡">æ¹å¼äºï¼ServiceAccount ç»å®ï¼ä¾¿æ·æ¹æ¡ï¼</h3>
<p>éç¨äºå½åç©ºé´åææ Pod é½éè¦è®¿é®ç§æéåä»åºçåºæ¯ã</p>
<pre><code class="language-bash"># å° Secret ç»å®å° default ServiceAccount
kubectl patch serviceaccount default -p '{"imagePullSecrets": [{"name": "harbor-pull-secret"}]}'
</code></pre>
<p>æ­¤éç½®å°ä½¿è¯¥å½åç©ºé´ä¸æææ°å»ºç Pod èªå¨ç»§æ¿éåæåæéã</p>
<h3 id="æ¹å¼ä¸containerd-å¨å±è®¤è¯å®éªç¯å¢éç¨">æ¹å¼ä¸ï¼Containerd å¨å±è®¤è¯ï¼å®éªç¯å¢éç¨ï¼</h3>
<p>å¨ Containerd å±é¢éç½®å¨å±è®¤è¯ï¼éç¨äºä¸ªäººå®éªç¯å¢ã</p>
<p>ç¼è¾ <code>/etc/containerd/config.toml</code>ï¼</p>
<pre><code class="language-toml">[plugins."io.containerd.grpc.v1.cri".registry.configs."192.168.0.42".auth]
  username = "your-username"
  password = "your-password"
  # æä½¿ç¨ base64 ç¼ç çå­è¯ï¼auth = "base64(username:password)"
</code></pre>
<blockquote>
<p><strong>å®å¨æé</strong>ï¼æ¹å¼ä¸å°å­æ®ææå­å¨å¨éç½®æä»¶ä¸­ï¼ä¸å»ºè®®å¨çäº§ç¯å¢ä¸­ä½¿ç¨ã</p>
</blockquote>
<h2 id="è¡¥å">è¡¥å</h2>
<p>ç¸è¾äºä½¿ç¨äºè¿å¶æ¹å¼é¨ç½²ï¼ç¨kubeadmèµ·ç çå»äºæå¨ç»´æ¤è¯ä¹¦çæä½ï¼åç»­æ·»å èç¹ä¹æ´ç®åäºãæç©ºæ´ä¸ªansibleè®©æ·»å èç¹æ´æ¹ä¾¿ã</p>


</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/XY-Heruo/" target="_blank">è±ééä½ç°</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/XY-Heruo/p/19560948" target="_blank">https://www.cnblogs.com/XY-Heruo/p/19560948</a></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-01 16:03">2026-02-01 16:03</span>&nbsp;
<a href="https://www.cnblogs.com/XY-Heruo">è±ééä½ç°</a>&nbsp;
éè¯»(<span id="post_view_count">51</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19560948);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19560948', targetLink: 'https://www.cnblogs.com/XY-Heruo/p/19560948', title: 'Debian 13åºäºkubeadmåcontainerdé¨ç½²åèç¹kubernetes' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å°SignalRç§»æ¤å°Esp32âè®©å°æºè®¾å¤æ ç¼è¿æ¥.NETåè½æå±MCPæå¡ ]]></title>
    <link>https://www.cnblogs.com/GreenShade/p/19560338</link>
    <guid>900c5995d4f485af3ac2a7a0a58fa091</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/GreenShade/p/19560338" title="åå¸äº 2026-02-01 15:33">
    <span role="heading" aria-level="2">å°SignalRç§»æ¤å°Esp32âè®©å°æºè®¾å¤æ ç¼è¿æ¥.NETåè½æå±MCPæå¡</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="åè¨">åè¨</h2>
<p>è¿æ®µæ¶é´è¿·ä¸äºææEsp32çå°æºèå¤©æºå¨äººï¼ä¹ç¨.NETä¸ºå°æºAIå¼åäºä¸äºMCPè½¬æ¥å¹³å°åMCPæå¡ãå°æºESP32æ¬èº«å°±å·å¤MCPè½åï¼å¯ä»¥è°ç¨æ¬å°MCPå·¥å·åæå¡ç«¯MCPå·¥å·ï¼å¹¶å°ç»æè¿åç»è®¾å¤ï¼è¿ä¸ªåè½ä¸ç´é½æã</p>
<p>å¦æä½ æææEsp32çç¡¬ä»¶ç©å·æç®ï¼å¯ä»¥å³æ³¨æçBç«è´¦å·ï¼ç»¿è«é¿å¹¿ï¼<a href="https://space.bilibili.com/25228512" target="_blank" rel="noopener nofollow">https://space.bilibili.com/25228512</a><br>
å¸¦ä½ ææç©å·ã</p>
<p>å°æºåæ¬è¿å¥æ¶ææä¸ªå±éæ§ï¼<strong>MCPå·¥å·æ§è¡å®ä¹åï¼åªè½åæ­¥è¿åç»ææèéè¿å¼æ­¥é®ä»¶éç¥ï¼è®¾å¤æ æ³è¢«å¨æ¥æ¶æå¡ç«¯çæ¶æ¯</strong>ãæ¯å¦ææ³è®©æå¡ç«¯ä¸»å¨ç»è®¾å¤æ¨éä¸å¼ å¾çãæ­æ¾ä¸æ®µè¯­é³ãæèåéä¸ä¸ªææ¬éç¥ï¼å¨ä¹åçæ¶æä¸æ¯åä¸å°çã</p>
<p>æä»¥æå°±å³å®æ¹é å°æºå®¢æ·ç«¯ï¼éæSignalRå®æ¶éä¿¡æ¡æ¶ãè¿æ¬¡æ¹é çæ ¸å¿ä»·å¼æ¯ï¼<strong>éè¿SignalRæ¶æ¯ééï¼è®©è®¾å¤å¯ä»¥æ¥æ¶åç§ç±»åçæ¶æ¯ï¼å£°é³ãå¾çãææ¬éç¥ï¼ï¼æå¡ç«¯çMCPå·¥å·æ§è¡æååï¼å¯ä»¥æ ¹æ®ç¨æ·IDæ¨éæ°æ®å°å¯¹åºçç¨æ·éé</strong>ã</p>
<p>æ´ä¸ªæ¹é æ¶åSignalR C++å®¢æ·ç«¯çéæãJWT Tokenè®¤è¯ãæ«ç ç»å½ï¼åºäºESP32æ¬å°MCPå·¥å·å®ç°ï¼ãä»¥åæå¡ç«¯æ¶æ¯æ¨éé»è¾ãå®¢æ·ç«¯ä»£ç é½æ¯C++å®ç°çï¼ä¸è¿ç°å¨AIè¾å©ç¼ç¨å¾å¼ºå¤§ï¼å¸®æèçäºå¤§éæ¶é´ã</p>
<p><img src="https://img2024.cnblogs.com/blog/1690009/202602/1690009-20260201121657114-327485878.png" alt="img" loading="lazy"></p>
<h2 id="é®é¢è§£ç­">é®é¢è§£ç­</h2>
<p><strong>Q: ä¸ºä»ä¹éæ©SignalRèä¸æ¯ç´æ¥ç¨WebSocketï¼</strong></p>
<p>A: èµ·åæç¡®å®èèè¿ç´æ¥ç¨WebSocketï¼ä½SignalRæä¾äºå¾å¤å¼ç®±å³ç¨çåè½ï¼</p>
<ul>
<li><strong>Hubæ½è±¡</strong>ï¼æå¡ç«¯å¯ä»¥è½»æ¾å®ç°ç¾¤ç»ç®¡çï¼æç¨æ·IDæ¨éæ¶æ¯ï¼æ¯å¦<code>Clients.Group($"Users:{userId}").SendAsync("Notification", message)</code></li>
<li><strong>æ¶æ¯è·¯ç±</strong>ï¼ä¸éè¦èªå·±åæ¶æ¯ååé»è¾ï¼SignalRçHubæ¹æ³è°ç¨åäºä»¶æ¨éå·²ç»å¾å®åäº</li>
<li><strong>ç±»ååè°ç¨</strong>ï¼ç¸æ¯åå§WebSocketçå­ç¬¦ä¸²æ¶æ¯ï¼SignalRæä¾äºç±»ä¼¼RPCçè°ç¨ä½éªï¼ä»£ç æ´æ¸æ°</li>
</ul>
<p>è½ç¶ESP32æ²¡æç°æçSignalRåºï¼ä½ææ¾å°äºå¾®è½¯å®æ¹çC++ SignalRå®¢æ·ç«¯ï¼åæåï¼ï¼å°å®ä¸ESP32çWebSocketç»ä»¶æ´ååï¼å°±è½ç¨ä¸SignalRçè¿äºç¹æ§äºãè³äºSignalRèªå¸¦çéè¿æºå¶ï¼ææ²¡ç¨ï¼å°æºæèªå·±çå¾ªç¯éè¿é»è¾ï¼æ´å¯æ§ä¸äºã</p>
<p><strong>Q: æ¹é çæ ¸å¿ä»·å¼æ¯ä»ä¹ï¼è§£å³äºä»ä¹é®é¢ï¼</strong></p>
<p>A: æ¹é åï¼ESP32çMCPå·¥å·è°ç¨å®æåï¼åªè½éè¿ä¸¤ç§æ¹å¼éç¥ï¼</p>
<ol>
<li><strong>åæ­¥è¿å</strong>ï¼å·¥å·æ§è¡ç»æç´æ¥è¿åç»è°ç¨æ¹</li>
<li><strong>å¼æ­¥é®ä»¶</strong>ï¼éè¿é®ä»¶åéæ§è¡ç»æ</li>
</ol>
<p>è¿ä¸¤ç§æ¹å¼é½æ æ³æ»¡è¶³å®æ¶æ¨éçéæ±ãæ¯å¦ææ³è®©æå¡ç«¯å¨çå¾å®æåç«å³æ¨éå¾çç»è®¾å¤æ¾ç¤ºï¼æèæ­æ¾ä¸æ®µè¯­é³æç¤ºï¼ä¹åçæ¶æåä¸å°ã</p>
<p>æ¹é åï¼éè¿SignalRå»ºç«äºä¸æ¡<strong>æå¡ç«¯å°è®¾å¤çå®æ¶æ¶æ¯éé</strong>ï¼</p>
<ul>
<li>æå¡ç«¯çMCPå·¥å·æ§è¡æååï¼å¯ä»¥è°ç¨<code>_hubContext.Clients.Group($"Users:{userId}").SendAsync("ShowImage", imageData)</code>å°å¾çæ¨éç»è®¾å¤</li>
<li>è®¾å¤éè¿SignalRçäºä»¶çå¬æ¥æ¶æ¶æ¯ï¼<code>connection-&gt;on("ShowImage", [](const std::vector&lt;signalr::value&gt;&amp; args) { ... })</code></li>
<li>æ¯ææ¨éä»»æç±»åçæ°æ®ï¼ææ¬ãå¾çï¼Base64ï¼ãè¯­é³URLãJSONéç¥ç­</li>
</ul>
<p>è¿ææ¯è¿æ¬¡æ¹é çæ ¸å¿ä»·å¼ï¼<strong>è®©è®¾å¤å·å¤è¢«å¨æ¥æ¶æå¡ç«¯æ¶æ¯çè½å</strong>ï¼èä¸ä»ä»æ¯ä¸»å¨è°ç¨ååæ­¥è¿åã</p>
<p><strong>Q: æ«ç ç»å½æ¯æä¹å®ç°çï¼</strong></p>
<p>A: æ«ç ç»å½åè½æ¯åºäºESP32æ¬å°MCPå·¥å·å®ç°çï¼è¿æ¯å°æºçåºæåè½ï¼æåªæ¯è¿è¡äºæå±ï¼</p>
<ol>
<li>è®¾å¤å¯å¨æ¶æ£æ¥æ¯å¦æJWT Token</li>
<li>å¦ææ²¡æTokenï¼è°ç¨æ¬å°MCPå·¥å·<code>display_qrcode</code>å¨å±å¹ä¸æ¾ç¤ºäºç»´ç </li>
<li>äºç»´ç åå®¹åå«è®¾å¤IDåæå¡ç«¯å°åï¼<code>https://mcp-server.com/device-login?deviceId=xxx</code></li>
<li>ç¨æ·ç¨ææºæ«ç ï¼å®æææã</li>
<li>è®¾å¤è·åTokenåä¿å­å°NVSï¼Non-Volatile Storageï¼ï¼ä¸æ¬¡å¯å¨ç´æ¥ä½¿ç¨</li>
</ol>
<p>è¿æ ·å°±å®ç°äºè®¾å¤çå¿«éè®¤è¯ï¼ç¨æ·ä½éªå¾å¥½ãæ«ç è®¤è¯çæå¡ç«¯æ¯ä½¿ç¨å¼æºçkeycloakåçï¼å¯¹æ¥äºè®¾å¤è®¤è¯ç±»åã</p>
<p><img src="https://img2024.cnblogs.com/blog/1690009/202602/1690009-20260201121907430-924035727.png" alt="img" loading="lazy"></p>
<h2 id="åè¯è§£é">åè¯è§£é</h2>
<h3 id="æ ¸å¿æ¦å¿µ">æ ¸å¿æ¦å¿µ</h3>
<ul>
<li>
<p><strong>SignalR</strong>ï¼å¾®è½¯æä¾çå®æ¶éä¿¡æ¡æ¶ï¼å°è£äºWebSocketãServerâSent Eventsåé¿è½®è¯¢ç­ä¼ è¾æ¹å¼ï¼æ¯æHubæ¨¡åãèªå¨éè¿ä¸æ¶æ¯åºååãéåå®ç°ååãä½å»¶è¿çå®æ¶æ¶æ¯ç³»ç»ãå°å®ç§»æ¤å°åµå¥å¼è®¾å¤æ¶éèèå®¢æ·ç«¯å®ç°çä½ç§¯ãåå­æ¶èä¸çº¿ç¨æ¨¡åã</p>
</li>
<li>
<p><strong>Hubï¼éçº¿å¨ï¼</strong>ï¼SignalRçæ ¸å¿æ½è±¡ï¼ç±»ä¼¼äºMVCä¸­çControllerãæå¡ç«¯éè¿Hubå®ä¹æ¹æ³ä¾å®¢æ·ç«¯è°ç¨ï¼å®¢æ·ç«¯ä¹å¯ä»¥æ³¨åäºä»¶çå¬æå¡ç«¯æ¨éãä¾å¦<code>ChatHub.SendMessage(user, message)</code>å°±æ¯ä¸ä¸ªå¸åçHubæ¹æ³ã</p>
</li>
<li>
<p><strong>MCPï¼Model Context Protocolï¼</strong>ï¼ä¸ç§åºäºJSON-RPC 2.0çåè®®ï¼ç¨äºå®ä¹å®¢æ·ç«¯åæå¡ç«¯ä¹é´çå·¥å·è°ç¨è§èãå¨IoTåºæ¯ä¸­ï¼è®¾å¤å¯ä»¥ä½ä¸ºMCP Serveræ´é²è½åï¼å¦éå¯ãæ¾ç¤ºå¾çï¼ï¼èäºç«¯æå¡ä½ä¸ºMCP Clientè°ç¨è¿äºè½åã</p>
</li>
<li>
<p><strong>JSON-RPC 2.0</strong>ï¼ä¸ç§è½»éçº§çè¿ç¨è¿ç¨è°ç¨åè®®ï¼ä½¿ç¨JSONç¼ç ãMCPåè®®åºäºæ­¤æ åï¼å®ä¹äº<code>initialize</code>ã<code>tools/list</code>ã<code>tools/call</code>ç­æ¹æ³ãæ¯ä¸ªè¯·æ±å¿é¡»åå«<code>jsonrpc: "2.0"</code>ã<code>method</code>ã<code>id</code>å­æ®µã</p>
</li>
</ul>
<h3 id="esp32ç¸å³">ESP32ç¸å³</h3>
<ul>
<li>
<p><strong>FreeRTOS</strong>ï¼ä¸ä¸ªå¼æºãè½»éçº§çå®æ¶æä½ç³»ç»åæ ¸ï¼å¸¸ç¨äºå¾®æ§å¶å¨å¹³å°ï¼å¦ESP32ï¼ãæä¾ä»»å¡è°åº¦ãä¼åçº§ãäºæ¥éãä¿¡å·éãéåãè½¯ä»¶å®æ¶å¨ç­å®æ¶ç¹æ§ï¼ä¾¿äºå¨èµæºåéè®¾å¤ä¸å®ç°å¹¶åä¸ç¡®å®æ§è¡ä¸ºãä½¿ç¨æ¶éæ³¨æå æ å¤§å°ãä¸­æ­å®å¨åä»»å¡ä¼åçº§è®¾è®¡ã</p>
</li>
<li>
<p><strong>ESP32 PSRAM</strong>ï¼ESP32å¯éçå¤é¨ä¼ªéæRAMï¼Pseudo-SRAMï¼ï¼ç¨äºæ©å±è®¾å¤å¯ç¨åå­ï¼å¸¸è§4MB/8MB/16MBï¼ãéåå­æ¾å¤§å¯¹è±¡ãå¾åç¼å­ãç½ç»ç¼å²åå¨æåéæ°æ®ãå¨ESP-IDFä¸­éå¯ç¨å¹¶æ­£ç¡®éç½®ï¼åéæ¶ä¹å¯ä½¿ç¨ä¸åçå åºåï¼å¦<code>heap_caps_malloc(size, MALLOC_CAP_SPIRAM)</code>ï¼æ¥æ§å¶æ¾ç½®ä¸æ§è½ï¼DMAéå¶ã</p>
</li>
<li>
<p><strong>WebSocket</strong>ï¼ä¸ç§åºäºTCPçå¨åå·¥éä¿¡åè®®ï¼éè¿HTTPæ¡æåçº§å»ºç«è¿æ¥ãSignalRé»è®¤ä¼åä½¿ç¨WebSocketä½ä¸ºä¼ è¾å±ï¼å¨ESP32ä¸éè¿<code>esp_websocket_client</code>ç»ä»¶å®ç°ãéè¦æ³¨æçæ¯ESP32çWebSocketå®¢æ·ç«¯ä¸æ¯æèªå¨éè¿ï¼éè¦å¨åºç¨å±å®ç°ã</p>
</li>
</ul>
<h3 id="è®¤è¯ç¸å³">è®¤è¯ç¸å³</h3>
<ul>
<li>
<p><strong>Bearer Token</strong>ï¼ä¸ç§HTTPè®¤è¯æ¹æ¡ï¼å°Tokenæ¾å¨Authorizationå¤´ä¸­ï¼<code>Authorization: Bearer &lt;token&gt;</code>ãå¨SignalRä¸­ï¼éå¸¸å°Tokenä½ä¸ºæ¥è¯¢åæ°ä¼ éï¼<code>/hub?access_token=YOUR_TOKEN</code></p>
</li>
<li>
<p><strong>JWTï¼JSON Web Tokenï¼</strong>ï¼ä¸ç§å¼æ¾æ åï¼RFC 7512ï¼ï¼ç¨äºå¨åæ¹ä¹é´å®å¨å°ä¼ è¾ä¿¡æ¯ãå¨Verdure MCPä¸­ï¼ä½¿ç¨Keycloakç­¾åçJWTè¿è¡ç¨æ·è®¤è¯ï¼Tokenä¸­åå«ç¨æ·IDãè§è²ãè¿ææ¶é´ç­Claimä¿¡æ¯ã</p>
</li>
<li>
<p><strong>API Token</strong>ï¼ä¸ç§ç®åçè®¤è¯æ¹å¼ï¼åç»­è¿æ¥æ¶æºå¸¦æ­¤Tokenéªè¯èº«ä»½ãVerdure MCPåæ¶æ¯æAPI TokenåJWTä¸¤ç§æ¹å¼ã</p>
</li>
</ul>
<p><img src="https://img2024.cnblogs.com/blog/1690009/202602/1690009-20260201152548041-1540521880.png" alt="img" loading="lazy"></p>
<h2 id="æ ¸å¿ææ¯æ¶æ">æ ¸å¿ææ¯æ¶æ</h2>
<p>æ´ä¸ªæ¹é çæ¶æå¯ä»¥ç¨ä¸å¼ å¾è¯´æï¼</p>
<pre><code>ââââââââââââââââââââââââ                          ââââââââââââââââââââââââ
â   .NET MCP Service   â                          â   ESP32 Device       â
â   (Verdure MCP)      âââââââSignalR Hubâââââââââºâ   (å°æºå®¢æ·ç«¯)       â
â                      â                          â                      â
â  ââââââââââââââââââ  â  â  JWT Tokenè®¤è¯         â  ââââââââââââââââââ  â
â  â  DeviceHub.cs  â  ââââââââââââââââââââââââââââ  â  æ«ç ç»å½      â  â
â  â                â  â                          â  â  (æ¬å°MCPå·¥å·) â  â
â  â OnConnected    â  â                          â  ââââââââââââââââââ  â
â  â (éªè¯Token)    â  â                          â          â           â
â  ââââââââââââââââââ  â  â¡ å»ºç«è¿æ¥               â  ââââââââââââââââââ  â
â          â           ââââââââââââââââââââââââââââ  â SignalR Client â  â
â  ââââââââââââââââââ  â                          â  â - connection   â  â
â  â  ç¾¤ç»ç®¡ç      â  â                          â  â - on() events  â  â
â  â Users:{userId} â  â                          â  ââââââââââââââââââ  â
â  ââââââââââââââââââ  â                          â                      â
â          â           â                          â                      â
â  ââââââââââââââââââ  â  â¢ MCPå·¥å·æ§è¡åæ¨é     â  ââââââââââââââââââ  â
â  â  æ¶æ¯æ¨é      â  âââââââââââââââââââââââââââºâ  â æ¶æ¯æ¥æ¶å¤ç   â  â
â  â SendAsync()    â  â  ShowImage(imageData)    â  â - æ¾ç¤ºå¾ç     â  â
â  â                â  â  PlayAudio(audioUrl)     â  â - æ­æ¾è¯­é³     â  â
â  â                â  â  Notification(text)      â  â - æ¾ç¤ºéç¥     â  â
â  ââââââââââââââââââ  â                          â  ââââââââââââââââââ  â
ââââââââââââââââââââââââ                          ââââââââââââââââââââââââ
</code></pre>
<p>å³é®æµç¨ï¼</p>
<ol>
<li><strong>æ«ç ç»å½</strong>ï¼è®¾å¤å¯å¨åï¼å¦ææ²¡æTokenï¼è°ç¨æ¬å°MCPå·¥å·æ¾ç¤ºäºç»´ç ï¼ç¨æ·æ«ç åè·åJWT Token</li>
<li><strong>å»ºç«è¿æ¥</strong>ï¼æºå¸¦JWT Tokenè¿æ¥SignalR Hubï¼æå¡ç«¯éªè¯åå å¥ç¨æ·ç¾¤ç»<code>Users:{userId}</code></li>
<li><strong>æ¶æ¯æ¨é</strong>ï¼æå¡ç«¯MCPå·¥å·æ§è¡å®æåï¼éè¿SignalRå°ç»ææ¨éç»è®¾å¤
<ul>
<li><code>_hubContext.Clients.Group($"Users:{userId}").SendAsync("ShowImage", imageData)</code></li>
<li>è®¾å¤çå¬äºä»¶å¹¶å¤çï¼<code>connection-&gt;on("ShowImage", handler)</code></li>
</ul>
</li>
</ol>
<p>è¿å¥æ¶æçæ ¸å¿ä»·å¼å°±æ¯<strong>è®©æå¡ç«¯å¯ä»¥ä¸»å¨æ¨éæ¶æ¯ç»è®¾å¤</strong>ï¼èä¸ä»ä»æ¯ç­å¾è®¾å¤è½®è¯¢æåæ­¥è¿åã</p>
<h2 id="å¼åç¯å¢åå¤">å¼åç¯å¢åå¤</h2>
<h3 id="esp32å¼åç¯å¢vs-codeæ¹å¼">ESP32å¼åç¯å¢ï¼VS Codeæ¹å¼ï¼</h3>
<p>æç®åçæ¹å¼æ¯ä½¿ç¨VS CodeçESP-IDFæä»¶ï¼</p>
<ol>
<li>
<p><strong>å®è£VS Codeåæä»¶</strong></p>
<ul>
<li>ä¸è½½å®è£ <a href="https://code.visualstudio.com/" target="_blank" rel="noopener nofollow">Visual Studio Code</a></li>
<li>å®è£æ©å±ï¼<code>Espressif IDF</code> (æç´¢ <code>esp-idf</code>)</li>
</ul>
</li>
<li>
<p><strong>éç½®ESP-IDF</strong></p>
<ul>
<li>æ<code>F1</code>æå¼å½ä»¤é¢æ¿ï¼è¾å¥ <code>ESP-IDF: Configure ESP-IDF Extension</code></li>
<li>éæ© <code>Express</code> å¿«ééç½®</li>
<li>éæ©ESP-IDFçæ¬ï¼æ¨èv5.1ææ´é«ï¼</li>
<li>ç­å¾å®è£å®æï¼ä¼èªå¨ä¸è½½å·¥å·é¾ãPythonç¯å¢ç­ï¼</li>
</ul>
</li>
<li>
<p><strong>åå»º/æå¼é¡¹ç®</strong></p>
<ul>
<li><code>F1</code> â <code>ESP-IDF: Show Examples Projects</code></li>
<li>æç´æ¥æå¼ esp-signalr-example é¡¹ç®æä»¶å¤¹</li>
</ul>
</li>
<li>
<p><strong>ç¼è¯åç§å½</strong></p>
<ul>
<li>ç¹å»åºé¨ç¶ææ ç <code>Build</code>ã<code>Flash</code>ã<code>Monitor</code> æé®</li>
<li>ææå¿«æ·é®ï¼<code>Ctrl+E B</code>ï¼ç¼è¯ï¼ã<code>Ctrl+E F</code>ï¼ç§å½ï¼</li>
</ul>
</li>
</ol>
<p>è¿ç§æ¹å¼æ¯å½ä»¤è¡ç®åå¾å¤ï¼éå.NETå¼åèå¿«éä¸æESP32å¼åã</p>
<p><img src="https://img2024.cnblogs.com/blog/1690009/202602/1690009-20260201122055040-2075015821.png" alt="img" loading="lazy"></p>
<h3 id="netå¼åç¯å¢">.NETå¼åç¯å¢</h3>
<p>æå¡ç«¯ä½¿ç¨.NET 10å¼åï¼</p>
<pre><code class="language-bash"># Windows: ä¸è½½å®è£å¨ https://dotnet.microsoft.com/download/dotnet/10.0

# éªè¯å®è£
dotnet --version  # åºè¯¥è¾åº 10.0.x

</code></pre>
<h2 id="æ ¸å¿ä»£ç å®ç°">æ ¸å¿ä»£ç å®ç°</h2>
<p>æ¬ç« èå°ä»£ç åä¸º<strong>ç¤ºä¾ä»£ç </strong>å<strong>å®éæ´åä»£ç </strong>ä¸¤ä¸ªé¨åè¿è¡è®²è§£ï¼</p>
<ul>
<li><strong>ç¤ºä¾ä»£ç </strong>ï¼ç¨äºçè§£æ ¸å¿æ¦å¿µçç®åçæ¬ï¼ä¾¿äºå­¦ä¹ åå¿«éä¸æ</li>
<li><strong>å®éæ´åä»£ç </strong>ï¼çäº§ç¯å¢ä¸­çå®æ´å®ç°ï¼åå«å®åçéè¯¯å¤çãç¶æç®¡çç­</li>
</ul>
<h3 id="å³äºç¤ºä¾ä»åº">å³äºç¤ºä¾ä»åº</h3>
<p>ä¸ºäºå¸®å©å¼åèå¿«éä¸æESP32çSignalRéæï¼æåå»ºäºä¸ä¸ªå®æ´çç¤ºä¾ä»åºï¼</p>
<p><strong>ð ä»åºå°å</strong>ï¼<a href="https://github.com/maker-community/esp-signalr-example" target="_blank" rel="noopener nofollow">https://github.com/maker-community/esp-signalr-example</a></p>
<p><strong>ð¦ ä»åºç»æ</strong>ï¼</p>
<pre><code>esp-signalr-example/
âââ main/                    # ESP32 C++å®¢æ·ç«¯ä»£ç 
â   âââ main.cpp            # ä¸»ç¨åºï¼WiFiè¿æ¥ãSignalRåå§åï¼
â   âââ CMakeLists.txt      # ESP-IDFæå»ºéç½®
âââ signalr-server/         # .NET C# æå¡ç«¯ä»£ç 
â   âââ Program.cs          # ASP.NET Coreæå¡å¨éç½®
â   âââ ChatHub.cs          # SignalR Hubå®ç°
â   âââ signalr-server.csproj
âââ docs/                   # ææ¡£
â   âââ QUICKSTART.md       # 5åéå¿«éå¼å§æå
â   âââ TEST_SERVER_SETUP.md # æµè¯æå¡å¨è¯¦ç»è®¾ç½®
â   âââ TROUBLESHOOTING.md  # å¸¸è§é®é¢ææ¥
âââ README.md               # é¡¹ç®è¯´æ
</code></pre>
<p><strong>â¨ ä¸»è¦ç¹æ§</strong>ï¼</p>
<ol>
<li>
<p><strong>å¼ç®±å³ç¨çæå¡å¨</strong>ï¼</p>
<ul>
<li>åºäºASP.NET CoreåSignalRæå»º</li>
<li>æ¯ææ¶æ¯å¹¿æ­</li>
<li>å®æ´çè¿æ¥ç®¡çåæ¥å¿è¾åº</li>
<li>æä¾RESTful APIç¨äºè®¾å¤æ§å¶</li>
</ul>
</li>
<li>
<p><strong>ç®åçESP32å®¢æ·ç«¯</strong>ï¼</p>
<ul>
<li>ä½¿ç¨Microsoftå®æ¹çC++ SignalRå®¢æ·ç«¯åºç§»æ¤ç</li>
<li>éè¿menuconfigéç½®WiFiåæå¡å¨å°å</li>
<li>æ¼ç¤ºæ¶æ¯åé/æ¥æ¶ãä¼ æå¨æ°æ®ä¸æ¥</li>
<li>æ¸æ°çæ¥å¿è¾åºåéè¯¯å¤ç</li>
</ul>
</li>
</ol>
<p><strong>ð å¿«éå¼å§ç¤ºä¾</strong>ï¼5åéè¿è¡ï¼ï¼</p>
<pre><code class="language-bash"># 1. åéä»åº
git clone https://github.com/maker-community/esp-signalr-example.git
cd esp-signalr-example

# 2. å¯å¨æå¡å¨ï¼éè¦.NET 9.0+ï¼
cd signalr-server
dotnet run --urls "http://+:5000" è¿ä¸ªè¿è¡å¯ä»¥ç¨ipè®¿é®
# æå¡å¨è¿è¡å¨: http://0.0.0.0:5000/chatHub

# 3. éç½®å¹¶ç§å½ESP32
cd ../
idf.py menuconfig
# éç½®WiFi SSIDãå¯ç åæå¡å¨å°å
idf.py build flash monitor
</code></pre>
<p>esp32çéç½®å¦ä¸ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/1690009/202602/1690009-20260201134357961-636085039.png" alt="img" loading="lazy"></p>
<p><strong>ð è¿è¡ææ</strong>ï¼</p>
<p>æå¡å¨è¾åºï¼<br>
<img src="https://img2024.cnblogs.com/blog/1690009/202602/1690009-20260201135020573-402562452.png" alt="img" loading="lazy"></p>
<pre><code>â Client connected: abc123
  IP Address: 192.168.1.100
  Total Connections: 1

[10:30:25] Received from ESP32-Device: Test message #1 from ESP32
[10:30:35] Sensor Update - Temperature: 25.50
</code></pre>
<p>ESP32ä¸²å£è¾åºï¼<br>
<img src="https://img2024.cnblogs.com/blog/1690009/202602/1690009-20260201134940520-565577362.png" alt="img" loading="lazy"></p>
<pre><code>I (3520) SIGNALR_EXAMPLE: âââ Connected to SignalR Hub! âââ
I (3525) SIGNALR_EXAMPLE: ð Notification: Welcome!
I (14640) S
</code></pre>
<p><strong>ð¯ ç¤ºä¾ä»åºçä»·å¼</strong>ï¼</p>
<ul>
<li><strong>å­¦ä¹ è·¯å¾æ¸æ°</strong>ï¼ä»ç®åçè¿æ¥å°å¤æçæ°æ®ä¼ è¾ï¼å¾ªåºæ¸è¿</li>
<li><strong>å¯ç´æ¥è¿è¡</strong>ï¼ä¸éè¦ä¾èµå¤é¨æå¡ï¼æ¬å°å³å¯æµè¯å®æ´æµç¨</li>
<li><strong>ä»£ç æ³¨éè¯¦ç»</strong>ï¼å³é®é¨åé½æä¸­è±ææ³¨éè¯´æ</li>
<li><strong>æäºæ©å±</strong>ï¼åºäºè¿ä¸ªç¤ºä¾å¯ä»¥å¿«éå¼åèªå·±çåºç¨</li>
</ul>
<p>æ¥ä¸æ¥ç 5.1 èå°åºäºè¿ä¸ªç¤ºä¾ä»åºçä»£ç è¿è¡è®²è§£ã</p>
<h3 id="51-ç¤ºä¾ä»£ç æå­¦ç®åç">5.1 ç¤ºä¾ä»£ç ï¼æå­¦ç®åçï¼</h3>
<blockquote>
<p><strong>è¯´æ</strong>ï¼ä»¥ä¸ä»£ç æ¥èªå¼æºç¤ºä¾ä»åº <a href="https://github.com/maker-community/esp-signalr-example" target="_blank" rel="noopener nofollow">esp-signalr-example</a>ï¼ç»è¿ç²¾ç®çªåºæ ¸å¿æ¦å¿µï¼æ¹ä¾¿çè§£SignalRä¸ESP32éæçåºæ¬åçãå®æ´ä»£ç è¯·åèä»åºæºç ã</p>
</blockquote>
<h4 id="511-æå¡ç«¯signalr-hubåºç¡å®ç°">5.1.1 æå¡ç«¯ï¼SignalR Hubåºç¡å®ç°</h4>
<p>è¿æ¯æå¡ç«¯çæ ¸å¿ä»£ç ï¼å®ç°äºè¿æ¥ç®¡çãæ¶æ¯å¹¿æ­åè®¾å¤ç¶æè·è¸ªï¼</p>
<p><strong>ChatHub.cs - Hubæ ¸å¿å®ç°</strong>ï¼</p>
<pre><code class="language-csharp">using Microsoft.AspNetCore.SignalR;

public class ChatHub : Hub
{
    private readonly ILogger&lt;ChatHub&gt; _logger;
    private static int _connectionCount = 0;
    
    // å­å¨è¿æ¥çè®¾å¤ä¿¡æ¯
    private static readonly Dictionary&lt;string, DeviceInfo&gt; _connectedDevices = new();
    private static readonly object _devicesLock = new();

    public ChatHub(ILogger&lt;ChatHub&gt; logger)
    {
        _logger = logger;
    }

    /// &lt;summary&gt;
    /// å¤çæ¥èªESP32çæ¶æ¯
    /// &lt;/summary&gt;
    public async Task SendMessage(string user, string message)
    {
        _logger.LogInformation("[{Time}] Received from {User}: {Message}", 
            DateTime.Now.ToString("HH:mm:ss"), user, message);
        
        // å¹¿æ­å°ææè¿æ¥çå®¢æ·ç«¯
        await Clients.All.SendAsync("ReceiveMessage", user, message);
    }

    /// &lt;summary&gt;
    /// å¤çä¼ æå¨æ°æ®æ´æ°
    /// &lt;/summary&gt;
    public async Task UpdateSensor(string sensorId, double value)
    {
        _logger.LogInformation("[{Time}] Sensor Update - {SensorId}: {Value:F2}", 
            DateTime.Now.ToString("HH:mm:ss"), sensorId, value);
        
        // å¹¿æ­ä¼ æå¨æ°æ®å°ææå®¢æ·ç«¯
        await Clients.All.SendAsync("UpdateSensorData", sensorId, value);
    }

    /// &lt;summary&gt;
    /// å¤çESP32ç¶ææ´æ°
    /// &lt;/summary&gt;
    public async Task UpdateDeviceStatus(string deviceId, string status, int freeHeap)
    {
        _logger.LogInformation("[{Time}] Device Status - {DeviceId}: {Status}, Free Heap: {FreeHeap} bytes", 
            DateTime.Now.ToString("HH:mm:ss"), deviceId, status, freeHeap);
        
        await Clients.All.SendAsync("DeviceStatusUpdate", deviceId, status, freeHeap);
    }

    /// &lt;summary&gt;
    /// å®¢æ·ç«¯è¿æ¥æ¶è§¦å
    /// &lt;/summary&gt;
    public override async Task OnConnectedAsync()
    {
        Interlocked.Increment(ref _connectionCount);
        
        var connectionId = Context.ConnectionId;
        var httpContext = Context.GetHttpContext();
        var ipAddress = httpContext?.Connection.RemoteIpAddress?.ToString();
        var userAgent = httpContext?.Request.Headers["User-Agent"].ToString();
        
        // ä¿å­è®¾å¤ä¿¡æ¯
        lock (_devicesLock)
        {
            _connectedDevices[connectionId] = new DeviceInfo
            {
                ConnectionId = connectionId,
                IpAddress = ipAddress,
                UserAgent = userAgent,
                ConnectedAt = DateTime.UtcNow
            };
        }
        
        _logger.LogInformation("â Client connected: {ConnectionId}", connectionId);
        _logger.LogInformation("  IP Address: {IpAddress}", ipAddress);
        _logger.LogInformation("  Total Connections: {Count}", _connectionCount);
        
        await base.OnConnectedAsync();
        
        // åéæ¬¢è¿æ¶æ¯ï¼ESP32éè¿æ­¤æ¶æ¯ç¡®è®¤è¿æ¥æåï¼
        await Clients.Caller.SendAsync("Notification", 
            "Welcome to SignalR Test Server!");
    }

    /// &lt;summary&gt;
    /// å®¢æ·ç«¯æ­å¼æ¶è§¦å
    /// &lt;/summary&gt;
    public override async Task OnDisconnectedAsync(Exception? exception)
    {
        Interlocked.Decrement(ref _connectionCount);
        
        var connectionId = Context.ConnectionId;
        
        // ç§»é¤è®¾å¤ä¿¡æ¯
        lock (_devicesLock)
        {
            _connectedDevices.Remove(connectionId);
        }
        
        _logger.LogInformation("â Client disconnected: {ConnectionId}", connectionId);
        if (exception != null)
        {
            _logger.LogWarning("  Disconnection reason: {Message}", exception.Message);
        }
        _logger.LogInformation("  Remaining Connections: {Count}", _connectionCount);
        
        await base.OnDisconnectedAsync(exception);
    }
}

/// &lt;summary&gt;
/// è®¾å¤è¿æ¥ä¿¡æ¯
/// &lt;/summary&gt;
public class DeviceInfo
{
    public string ConnectionId { get; set; } = "";
    public string? IpAddress { get; set; }
    public string? UserAgent { get; set; }
    public DateTime ConnectedAt { get; set; }
}
</code></pre>
<p><strong>Program.cs - SignalRæå¡éç½®</strong>ï¼</p>
<pre><code class="language-csharp">var builder = WebApplication.CreateBuilder(args);

// æ·»å SignalRæå¡
builder.Services.AddSignalR(options =&gt;
{
    options.EnableDetailedErrors = true;  // å¼åç¯å¢å¯ç¨
    options.ClientTimeoutInterval = TimeSpan.FromSeconds(30);  // å®¢æ·ç«¯è¶æ¶
    options.KeepAliveInterval = TimeSpan.FromSeconds(15);  // å¿è·³é´é
});

// æ·»å CORSæ¯æï¼åè®¸ESP32è·¨åè¿æ¥ï¼
builder.Services.AddCors(options =&gt;
{
    options.AddDefaultPolicy(policy =&gt;
    {
        policy.AllowAnyOrigin()
              .AllowAnyHeader()
              .AllowAnyMethod();
    });
});

var app = builder.Build();

app.UseCors();
app.MapHub&lt;ChatHub&gt;("/chatHub");

// çå¬ææç½ç»æ¥å£ï¼éè¦ï¼å±åç½åESP32è½è®¿é®ï¼
app.Urls.Add("http://0.0.0.0:5000");

Console.WriteLine("SignalR Server: http://0.0.0.0:5000/chatHub");
app.Run();
</code></pre>
<p><strong>å³é®ç¹è¯´æ</strong>ï¼</p>
<ol>
<li><strong>è¿æ¥ç¡®è®¤æºå¶</strong>ï¼æå¡å¨å¨ <code>OnConnectedAsync</code> ä¸­åé <code>Notification</code> æ¶æ¯ï¼ESP32æ¶å°æ­¤æ¶æ¯æè®¤ä¸ºè¿æ¥æå</li>
<li><strong>æ¶æ¯å¹¿æ­</strong>ï¼ä½¿ç¨ <code>Clients.All.SendAsync()</code> åææè¿æ¥çå®¢æ·ç«¯å¹¿æ­æ¶æ¯</li>
<li><strong>è¿æ¥è·è¸ª</strong>ï¼ä½¿ç¨éæå­å¸ <code>_connectedDevices</code> è·è¸ªææè¿æ¥çè®¾å¤ä¿¡æ¯</li>
</ol>
<h4 id="512-æå¡ç«¯è®¾å¤æ§å¶apiéè¿signalræ¨éæ¶æ¯">5.1.2 æå¡ç«¯ï¼è®¾å¤æ§å¶APIï¼éè¿SignalRæ¨éæ¶æ¯ï¼</h4>
<p>ç¤ºä¾ä»åºæä¾äºå®æ´çè®¾å¤æ§å¶APIï¼æ¼ç¤ºå¦ä½éè¿SignalRåESP32æ¨éåç§ç±»åçæ¶æ¯ï¼</p>
<p><strong>Program.cs - è®¾å¤æ§å¶APIç«¯ç¹</strong>ï¼</p>
<pre><code class="language-csharp">// ============================================================================
// è®¾å¤æ§å¶ API - ç¨äºåè®¾å¤åé CustomMessage
// ============================================================================

// è·åææè¿æ¥çè®¾å¤
app.MapGet("/api/device/connections", () =&gt;
{
    return Results.Ok(ChatHub.ConnectedDevices);
})
.WithName("GetConnections")
.WithDescription("è·åææè¿æ¥çè®¾å¤åè¡¨");

// åééç¥
app.MapPost("/api/device/notification", async (
    NotificationRequest request, 
    IHubContext&lt;ChatHub&gt; hubContext, 
    ILogger&lt;Program&gt; logger) =&gt;
{
    var message = new
    {
        action = "notification",
        title = request.Title ?? "éç¥",
        content = request.Content ?? "",
        emotion = request.Emotion ?? "bell",
        sound = request.Sound ?? "popup"
    };

    await SendCustomMessage(hubContext, logger, request.ConnectionId, message);
    return Results.Ok(new { success = true, message = "Notification sent" });
})
.WithDescription("åééç¥å°è®¾å¤ (sound: popup/success/vibration/exclamation/low_battery/none)");

// åéå¾ç
app.MapPost("/api/device/image", async (
    ImageRequest request, 
    IHubContext&lt;ChatHub&gt; hubContext, 
    ILogger&lt;Program&gt; logger) =&gt;
{
    var message = new
    {
        action = "image",
        url = request.Url
    };

    await SendCustomMessage(hubContext, logger, request.ConnectionId, message);
    return Results.Ok(new { success = true, message = "Image sent" });
})
.WithDescription("åéå¾çURLå°è®¾å¤æ¾ç¤º (æ¯æJPG/PNG, æå¤§1MB)");

// åéé³é¢
app.MapPost("/api/device/audio", async (
    AudioRequest request, 
    IHubContext&lt;ChatHub&gt; hubContext, 
    ILogger&lt;Program&gt; logger) =&gt;
{
    var message = new
    {
        action = "audio",
        url = request.Url
    };

    await SendCustomMessage(hubContext, logger, request.ConnectionId, message);
    return Results.Ok(new { success = true, message = "Audio sent" });
})
.WithDescription("åéé³é¢URLå°è®¾å¤æ­æ¾ (OGGæ ¼å¼, æå¤§512KB)");

// åéå½ä»¤
app.MapPost("/api/device/command", async (
    CommandRequest request, 
    IHubContext&lt;ChatHub&gt; hubContext, 
    ILogger&lt;Program&gt; logger) =&gt;
{
    var message = new
    {
        action = "command",
        command = request.Command
    };

    await SendCustomMessage(hubContext, logger, request.ConnectionId, message);
    return Results.Ok(new { success = true, message = "Command sent" });
})
.WithDescription("åéå½ä»¤å°è®¾å¤ (command: reboot/wake/listen/stop)");

// æ¾ç¤ºäºç»´ç 
app.MapPost("/api/device/qrcode", async (
    QRCodeRequest request, 
    IHubContext&lt;ChatHub&gt; hubContext, 
    ILogger&lt;Program&gt; logger) =&gt;
{
    var message = new
    {
        action = "qrcode",
        content = request.Content,
        title = request.Title ?? "æ«ç "
    };

    await SendCustomMessage(hubContext, logger, request.ConnectionId, message);
    return Results.Ok(new { success = true, message = "QRCode sent" });
})
.WithDescription("æ¾ç¤ºäºç»´ç å°è®¾å¤å±å¹");

// è¾å©æ¹æ³ï¼åé CustomMessage
async Task SendCustomMessage(
    IHubContext&lt;ChatHub&gt; hubContext, 
    ILogger&lt;Program&gt; logger, 
    string? connectionId, 
    object message)
{
    var json = JsonSerializer.Serialize(message);
    logger.LogInformation("ð¤ Sending CustomMessage to {Target}: {Message}", 
        string.IsNullOrEmpty(connectionId) ? "ALL" : connectionId, json);

    if (string.IsNullOrEmpty(connectionId))
    {
        // åéç»ææè¿æ¥çè®¾å¤
        await hubContext.Clients.All.SendAsync("CustomMessage", json);
    }
    else
    {
        // åéç»æå®è¿æ¥
        await hubContext.Clients.Client(connectionId).SendAsync("CustomMessage", json);
    }
}

// ============================================================================
// è¯·æ±æ¨¡å
// ============================================================================

record NotificationRequest
{
    public string? ConnectionId { get; init; }
    public string? Title { get; init; }
    public string Content { get; init; } = "";
    public string? Emotion { get; init; }
    public string? Sound { get; init; }
}

record ImageRequest
{
    public string? ConnectionId { get; init; }
    public string Url { get; init; } = "";
}

record AudioRequest
{
    public string? ConnectionId { get; init; }
    public string Url { get; init; } = "";
}

record CommandRequest
{
    public string? ConnectionId { get; init; }
    public string Command { get; init; } = "";
}

record QRCodeRequest
{
    public string? ConnectionId { get; init; }
    public string Content { get; init; } = "";
    public string? Title { get; init; }
}
</code></pre>
<p><strong>å³é®ç¹è¯´æ</strong>ï¼</p>
<ol>
<li><strong>IHubContextæ³¨å¥</strong>ï¼ä½¿ç¨ <code>IHubContext&lt;ChatHub&gt;</code> å¨éHubç±»ä¸­åéSignalRæ¶æ¯</li>
<li><strong>æ¶æ¯æ ¼å¼</strong>ï¼ä½¿ç¨JSONæ ¼å¼ç <code>CustomMessage</code> äºä»¶ï¼åå« <code>action</code> å­æ®µæ è¯æ¶æ¯ç±»å</li>
<li><strong>å®åæ¨é</strong>ï¼
<ul>
<li><code>Clients.All.SendAsync()</code> - å¹¿æ­ç»ææè¿æ¥çè®¾å¤</li>
<li><code>Clients.Client(connectionId).SendAsync()</code> - åéç»æå®è®¾å¤</li>
<li><code>Clients.Group(groupName).SendAsync()</code> - åéç»ç¾¤ç»ï¼å¦ <code>Users:{userId}</code>ï¼</li>
</ul>
</li>
<li><strong>RESTful APIè®¾è®¡</strong>ï¼æä¾HTTPç«¯ç¹æ§å¶è®¾å¤ï¼ä¾¿äºå¶ä»æå¡è°ç¨</li>
</ol>
<p>æå¡ç«¯çæ¥å£å¾çå¦ä¸å¯ä»¥ç´æ¥æä½æµè¯ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/1690009/202602/1690009-20260201134534230-1496642342.png" alt="img" loading="lazy"></p>
<h4 id="513-å®¢æ·ç«¯esp32è¿æ¥signalrå¹¶æ¥æ¶æ¶æ¯">5.1.3 å®¢æ·ç«¯ï¼ESP32ï¼ï¼è¿æ¥SignalRå¹¶æ¥æ¶æ¶æ¯</h4>
<p>è¿æ¯ESP32ç«¯çæ ¸å¿ä»£ç ï¼æ¼ç¤ºå¦ä½è¿æ¥SignalR Hubå¹¶æ¥æ¶åç§ç±»åçæ¶æ¯ï¼</p>
<p><strong>main.cpp - SignalRè¿æ¥ä¸æ¶æ¯å¤ç</strong>ï¼</p>
<pre><code class="language-cpp">#include &lt;stdio.h&gt;
#include &lt;memory&gt;
#include "freertos/FreeRTOS.h"
#include "freertos/task.h"
#include "esp_system.h"
#include "esp_log.h"
#include "nvs_flash.h"

#include "hub_connection_builder.h"
#include "esp32_websocket_client.h"
#include "esp32_http_client.h"

// =============================================================================
// éç½®é¡¹ï¼éè¿menuconfigè®¾ç½®ï¼
// =============================================================================

#define WIFI_SSID      CONFIG_EXAMPLE_WIFI_SSID
#define WIFI_PASSWORD  CONFIG_EXAMPLE_WIFI_PASSWORD
#define SIGNALR_HUB_URL CONFIG_EXAMPLE_SIGNALR_HUB_URL

static const char* TAG = "SIGNALR_EXAMPLE";

// SignalRè¿æ¥å¯¹è±¡
static std::unique_ptr&lt;signalr::hub_connection&gt; g_connection;
static bool g_is_connected = false;

// =============================================================================
// æ¶æ¯å¤çå¨
// =============================================================================

/**
 * å¤çæå¡å¨åéçæ¶æ¯
 */
static void on_receive_message(const std::vector&lt;signalr::value&gt;&amp; args)
{
    ESP_LOGI(TAG, "==============================================");
    ESP_LOGI(TAG, "ð© Message received from server:");
    
    if (args.size() &gt;= 2) {
        std::string user = args[0].as_string();
        std::string message = args[1].as_string();
        
        ESP_LOGI(TAG, "   From: %s", user.c_str());
        ESP_LOGI(TAG, "   Text: %s", message.c_str());
    } else if (args.size() == 1) {
        ESP_LOGI(TAG, "   Message: %s", args[0].as_string().c_str());
    }
    
    ESP_LOGI(TAG, "==============================================");
}

/**
 * å¤çéç¥æ¶æ¯ï¼è¿æ¥ç¡®è®¤ï¼
 */
static void on_notification(const std::vector&lt;signalr::value&gt;&amp; args)
{
    if (args.empty()) return;
    
    std::string notification = args[0].as_string();
    ESP_LOGI(TAG, "ð Notification: %s", notification.c_str());
    
    // éè¿Notificationæ¶æ¯ç¡®è®¤è¿æ¥æå
    if (!g_is_connected) {
        g_is_connected = true;
        ESP_LOGI(TAG, "==============================================");
        ESP_LOGI(TAG, "âââ Connected to SignalR Hub! âââ");
        ESP_LOGI(TAG, "==============================================");
    }
}

/**
 * å¤çä¼ æå¨æ°æ®æ´æ°
 */
static void on_sensor_update(const std::vector&lt;signalr::value&gt;&amp; args)
{
    if (args.size() &lt; 2) return;
    
    std::string sensor_id = args[0].as_string();
    double value = args[1].as_double();
    
    ESP_LOGI(TAG, "ð Sensor Update: %s = %.2f", sensor_id.c_str(), value);
}

/**
 * å¤çè®¾å¤ç¶ææ´æ°
 */
static void on_device_status(const std::vector&lt;signalr::value&gt;&amp; args)
{
    if (args.size() &lt; 3) return;
    
    std::string device_id = args[0].as_string();
    std::string status = args[1].as_string();
    int free_heap = static_cast&lt;int&gt;(args[2].as_double());
    
    ESP_LOGI(TAG, "ð± Device Status: %s - %s (Free Heap: %d bytes)", 
             device_id.c_str(), status.c_str(), free_heap);
}

// =============================================================================
// SignalRè¿æ¥ç®¡ç
// =============================================================================

/**
 * åå§åSignalRè¿æ¥
 */
static void init_signalr(void)
{
    ESP_LOGI(TAG, "Initializing SignalR connection to: %s", SIGNALR_HUB_URL);

    try {
        // åå»ºhub_connectionï¼ä½¿ç¨make_uniqueï¼
        g_connection = std::make_unique&lt;signalr::hub_connection&gt;(
            signalr::hub_connection_builder::create(SIGNALR_HUB_URL)
                .with_websocket_factory([](const signalr::signalr_client_config&amp; config) {
                    return std::make_shared&lt;signalr::esp32_websocket_client&gt;(config);
                })
                .with_http_client_factory([](const signalr::signalr_client_config&amp; config) {
                    return std::make_shared&lt;signalr::esp32_http_client&gt;(config);
                })
                .with_automatic_reconnect()  // å¯ç¨èªå¨éè¿
                .skip_negotiation(true)      // è·³è¿ååï¼ç´æ¥WebSocket
                .build());

        ESP_LOGI(TAG, "â SignalR connection object created");
        
    } catch (const std::exception&amp; e) {
        ESP_LOGE(TAG, "Failed to create SignalR connection: %s", e.what());
    }
}

/**
 * æ³¨åæ¶æ¯å¤çå¨
 */
static void setup_message_handlers(void)
{
    if (!g_connection) {
        ESP_LOGE(TAG, "Connection not initialized");
        return;
    }

    // æ³¨å "ReceiveMessage" äºä»¶
    g_connection-&gt;on("ReceiveMessage", on_receive_message);
    ESP_LOGI(TAG, "â Registered handler: ReceiveMessage");

    // æ³¨å "Notification" äºä»¶ï¼ç¨äºè¿æ¥ç¡®è®¤ï¼
    g_connection-&gt;on("Notification", on_notification);
    ESP_LOGI(TAG, "â Registered handler: Notification");

    // æ³¨å "UpdateSensorData" äºä»¶
    g_connection-&gt;on("UpdateSensorData", on_sensor_update);
    ESP_LOGI(TAG, "â Registered handler: UpdateSensorData");

    // æ³¨å "DeviceStatusUpdate" äºä»¶
    g_connection-&gt;on("DeviceStatusUpdate", on_device_status);
    ESP_LOGI(TAG, "â Registered handler: DeviceStatusUpdate");
}

/**
 * å¯å¨SignalRè¿æ¥
 */
static void start_signalr_connection(void)
{
    if (!g_connection) {
        ESP_LOGE(TAG, "Connection not initialized");
        return;
    }
    
    ESP_LOGI(TAG, "Starting SignalR connection...");

    try {
        // å¯å¨è¿æ¥ï¼å¼æ­¥ï¼
        g_connection-&gt;start([](std::exception_ptr exception) {
            if (exception) {
                ESP_LOGE(TAG, "Connection failed in callback");
            } else {
                ESP_LOGI(TAG, "Connection started successfully");
            }
        });
        
        ESP_LOGI(TAG, "Waiting for Notification message to confirm connection...");

    } catch (const std::exception&amp; e) {
        ESP_LOGE(TAG, "Exception starting connection: %s", e.what());
    }
}

// =============================================================================
// æµè¯ä»»å¡ï¼å®æåéæ¶æ¯
// =============================================================================

static void signalr_test_task(void* param)
{
    int message_count = 1;
    
    while (true) {
        // ç­å¾10ç§
        vTaskDelay(pdMS_TO_TICKS(10000));
        
        // æ£æ¥è¿æ¥ç¶æ
        if (!g_connection || !g_is_connected) {
            ESP_LOGW(TAG, "Not connected, skipping message send");
            continue;
        }
        
        // åéæ¶æ¯å°æå¡å¨
        std::string message = "Test message #" + std::to_string(message_count++) + " from ESP32";
        
        ESP_LOGI(TAG, "ð¤ Sending message...");
        ESP_LOGI(TAG, "   User: ESP32-Device");
        ESP_LOGI(TAG, "   Message: %s", message.c_str());
        
        try {
            std::vector&lt;signalr::value&gt; args;
            args.push_back(signalr::value("ESP32-Device"));
            args.push_back(signalr::value(message));
            
            // è°ç¨æå¡å¨ç SendMessage æ¹æ³
            g_connection-&gt;invoke("SendMessage", args, 
                [](const signalr::value&amp; result, std::exception_ptr exception) {
                    if (exception) {
                        ESP_LOGE(TAG, "â Failed to send message");
                    } else {
                        ESP_LOGI(TAG, "â Message sent successfully!");
                    }
                });
                
        } catch (const std::exception&amp; e) {
            ESP_LOGE(TAG, "Exception sending message: %s", e.what());
        }
    }
}

// =============================================================================
// ä¸»ç¨åº
// =============================================================================

extern "C" void app_main(void)
{
    ESP_LOGI(TAG, "========================================");
    ESP_LOGI(TAG, " ESP32 SignalR Client Test Example");
    ESP_LOGI(TAG, "========================================");
    
    // 1. åå§åWiFiï¼çç¥WiFiè¿æ¥ä»£ç ï¼åèå®æ´ç¤ºä¾ï¼
    // wifi_init_sta();
    
    // 2. åå§åSignalRè¿æ¥å¯¹è±¡
    ESP_LOGI(TAG, "Step 1: Initializing SignalR...");
    init_signalr();
    
    // 3. æ³¨åæ¶æ¯å¤çå¨
    ESP_LOGI(TAG, "Step 2: Setting up message handlers...");
    setup_message_handlers();
    
    // 4. å¯å¨è¿æ¥
    ESP_LOGI(TAG, "Step 3: Starting connection...");
    start_signalr_connection();
    
    // 5. åå»ºæµè¯ä»»å¡ï¼å®æåéæ¶æ¯ï¼
    ESP_LOGI(TAG, "Step 4: Creating test task...");
    xTaskCreate(signalr_test_task, "signalr_test", 8192, NULL, 5, NULL);
    
    ESP_LOGI(TAG, "Setup complete. Check logs for connection status.");
}
</code></pre>
<p><strong>å³é®ç¹è¯´æ</strong>ï¼</p>
<ol>
<li><strong>è¿æ¥åå»º</strong>ï¼ä½¿ç¨ <code>hub_connection_builder</code> æå»ºè¿æ¥ï¼éç½®WebSocketå®¢æ·ç«¯å·¥å</li>
<li><strong>è·³è¿åå</strong>ï¼<code>skip_negotiation(true)</code> ç´æ¥ä½¿ç¨WebSocketï¼æé«è¿æ¥éåº¦</li>
<li><strong>æ¶æ¯å¤çå¨æ³¨å</strong>ï¼ä½¿ç¨ <code>connection-&gt;on("EventName", handler)</code> æ³¨åäºä»¶çå¬å¨</li>
<li><strong>è¿æ¥ç¡®è®¤</strong>ï¼éè¿æ¥æ¶ <code>Notification</code> æ¶æ¯å¤æ­è¿æ¥æåï¼æå¡å¨å¨ <code>OnConnectedAsync</code> ä¸­åéï¼</li>
<li><strong>è°ç¨æå¡å¨æ¹æ³</strong>ï¼ä½¿ç¨ <code>invoke()</code> è°ç¨Hubæ¹æ³ï¼å¦ <code>SendMessage</code></li>
</ol>
<p><strong>å®æ´è¿è¡æµç¨</strong>ï¼</p>
<pre><code>1. WiFiè¿æ¥æå
   â
2. åå»ºSignalRè¿æ¥å¯¹è±¡
   â
3. æ³¨åæ¶æ¯å¤çå¨ï¼ReceiveMessageãNotificationç­ï¼
   â
4. è°ç¨ connection-&gt;start() å¯å¨è¿æ¥
   â
5. ç­å¾æå¡å¨åé Notification æ¶æ¯
   â
6. æ¶å° Notificationï¼æ è®°è¿æ¥æå
   â
7. å®æè°ç¨ invoke("SendMessage") åéæ¶æ¯
   â
8. æ¥æ¶æå¡å¨å¹¿æ­çæ¶æ¯ï¼è§¦åå¯¹åºå¤çå¨
</code></pre>
<p><strong>ç¤ºä¾è¾åº</strong>ï¼</p>
<pre><code>I (3480) SIGNALR_EXAMPLE: â Registered handler: ReceiveMessage
I (3485) SIGNALR_EXAMPLE: â Registered handler: Notification
I (3490) SIGNALR_EXAMPLE: Starting SignalR connection...
I (4520) SIGNALR_EXAMPLE: ==============================================
I (4520) SIGNALR_EXAMPLE: âââ Connected to SignalR Hub! âââ
I (4525) SIGNALR_EXAMPLE: ==============================================
I (4530) SIGNALR_EXAMPLE: ð Notification: Welcome to SignalR!
I (14530) SIGNALR_EXAMPLE: ð¤ Sending message...
I (14640) SIGNALR_EXAMPLE: â Message sent successfully!
I (14650) SIGNALR_EXAMPLE: ð© Message received from server:
I (14655) SIGNALR_EXAMPLE:    From: ESP32-Device
I (14660) SIGNALR_EXAMPLE:    Text: Test message #1 from ESP32
</code></pre>
<h3 id="52-å®éæ´åä»£ç çäº§ç¯å¢å®æ´å®ç°">5.2 å®éæ´åä»£ç ï¼çäº§ç¯å¢å®æ´å®ç°ï¼</h3>
<blockquote>
<p><strong>è¯´æ</strong>ï¼ä»¥ä¸ä»£ç æ¥èªå°æºAIé¡¹ç®çå®éçäº§ä»£ç ï¼åå«äºå®æ´çéè¯¯å¤çãç¶æç®¡çãJWTè®¤è¯åèªå¨éè¿æºå¶ã</p>
</blockquote>
<p>å®éé¡¹ç®ä»£ç åä¸ºä¸ä¸ªä¸»è¦ä»åºï¼</p>
<h4 id="521-å°æºesp32è®¾å¤ä»£ç ">5.2.1 å°æºESP32è®¾å¤ä»£ç </h4>
<p><strong>ä»åºå°å</strong>ï¼</p>
<ul>
<li>ä¸»ä»åºï¼<a href="https://github.com/maker-community/xiaozhi-esp32" target="_blank" rel="noopener nofollow">https://github.com/maker-community/xiaozhi-esp32</a></li>
<li>SignalRéæåæ¯ï¼<code>signalr</code> å <code>signalr-update-audio</code></li>
<li>å®æ´ç¤ºä¾å·¥ç¨ï¼<a href="https://github.com/maker-community/esp-signalr-example" target="_blank" rel="noopener nofollow">esp-signalr-example</a></li>
</ul>
<blockquote>
<p><strong>æ³¨æ</strong>ï¼SignalRåè½ä¸»è¦å¨ <code>signalr</code> å <code>signalr-update-audio</code> ä¸¤ä¸ªåæ¯ä¸­å®ç°ï¼è¿ä¸¤ä¸ªåæ¯é½æ¯SignalRéæç¸å³çå¼ååæ¯ã</p>
</blockquote>
<p><strong>æ ¸å¿æä»¶</strong>ï¼</p>
<ul>
<li><code>main/signalr_client.cc</code> / <code>main/signalr_client.h</code> - <strong>SignalRå®¢æ·ç«¯æ ¸å¿å®ç°</strong></li>
<li><code>main/application.cc</code> / <code>main/application.h</code> - ä¸»åºç¨ç¨åºé»è¾åç¶æç®¡ç</li>
<li><code>main/protocols/websocket_protocol.cc</code> - WebSocketåè®®å®ç°</li>
<li><code>main/protocols/mqtt_protocol.cc</code> - MQTTåè®®å®ç°</li>
<li><code>main/mcp_server.cc</code> - MCPæå¡å¨å®ç°</li>
</ul>
<p><strong>å®éå®ç°ç¹ç¹</strong>ï¼</p>
<p>ä¸ç¤ºä¾ä»£ç ç¸æ¯,çäº§ç¯å¢å®ç°å¢å äºï¼</p>
<ol>
<li>
<p><strong>å®æ´ççå½å¨æç®¡ç</strong></p>
<ul>
<li>è¿æ¥å»ºç«ãæ­å¼éè¿ãèµæºæ¸ç</li>
<li>è®¾å¤ç¶ææºç®¡çï¼ç©ºé²ãè¿æ¥ä¸­ãçå¬ãè¯´è¯ç­ï¼</li>
</ul>
</li>
<li>
<p><strong>åè®®çæ¬æ¯æ</strong></p>
<ul>
<li>æ¯æWebSocketåMQTTä¸¤ç§ä¼ è¾åè®®</li>
<li>åè®®å±æ½è±¡,æäºæ©å±æ°åè®®</li>
</ul>
</li>
<li>
<p><strong>é³é¢æµå¤ç</strong></p>
<ul>
<li>å®æ¶é³é¢æ°æ®çç¼ç ãä¼ è¾åæ¥æ¶</li>
<li><strong>é³é¢ååä¼ è¾</strong>ï¼éè¦ï¼ï¼- è§£å³å¤§æ°æ®ä¼ è¾å¯¼è´è¿æ¥æ­å¼çé®é¢</li>
<li>æ¯æOpusç¼è§£ç </li>
</ul>
</li>
<li>
<p><strong>MCPå·¥å·éæ</strong></p>
<ul>
<li>å®æ´çMCP Serverå®ç°</li>
<li>å·¥å·æ³¨åãè°ç¨åååºæºå¶</li>
<li>æ¯æå¼æ­¥å·¥å·æ§è¡</li>
</ul>
</li>
<li>
<p><strong>SignalRå®¢æ·ç«¯å°è£</strong></p>
<ul>
<li>å®æ´çè¿æ¥çå½å¨æç®¡ç</li>
<li>JWT Tokenè®¤è¯</li>
<li>èªå¨éè¿æºå¶ï¼ææ°éé¿ï¼</li>
<li>è®¾å¤æ³¨ååå¿è·³ä¿æ</li>
<li>èªå®ä¹æ¶æ¯å¤ç</li>
</ul>
</li>
</ol>
<h5 id="signalrå®¢æ·ç«¯æ ¸å¿å®ç°-signalr_clientcc">SignalRå®¢æ·ç«¯æ ¸å¿å®ç° (signalr_client.cc)</h5>
<p>è¿æ¯æ´ä¸ªSignalRéæçæ ¸å¿ä»£ç ï¼å°è£äºææä¸SignalRéä¿¡ç¸å³çé»è¾ã</p>
<p><strong>å®æ´ä»£ç </strong>ï¼<a href="https://github.com/maker-community/xiaozhi-esp32/blob/signalr-update-audio/main/signalr_client.cc" target="_blank" rel="noopener nofollow">signalr_client.cc</a> ï¼850è¡ï¼</p>
<p><strong>å³é®å®ç°è¦ç¹</strong>ï¼</p>
<p><strong>1. åä¾æ¨¡å¼ç®¡ç</strong> - å¨å±å¯ä¸å®ä¾</p>
<pre><code class="language-cpp">SignalRClient&amp; SignalRClient::GetInstance() {
    static SignalRClient instance;
    return instance;
}
</code></pre>
<p><strong>2. JWT Tokenè®¤è¯</strong> - éè¿Query Stringä¼ é</p>
<pre><code class="language-cpp">bool SignalRClient::Initialize(const std::string&amp; hub_url, const std::string&amp; token) {
    // ð Build URL with token as query parameter (ASP.NET Core SignalR standard method)
    std::string final_hub_url = hub_url;
    if (!token.empty()) {
        ESP_LOGI(TAG, "========== SignalR Token Authentication ==========");
        
        // Remove "Bearer " prefix if present
        std::string token_value = token;
        if (token_value.find("Bearer ") == 0) {
            token_value = token_value.substr(7);
        }
        
        // Append token to URL
        final_hub_url += "?access_token=" + token_value;
    }
    
    // Create hub connection builder
    auto builder = signalr::hub_connection_builder::create(final_hub_url);
    
    // Set WebSocket factory (ä½¿ç¨ESP32çWebSocketå®ç°)
    builder.with_websocket_factory([](const signalr::signalr_client_config&amp; config) {
        auto client = std::make_shared&lt;signalr::esp32_websocket_client&gt;(config);
        return client;
    });
    
    // Skip negotiation (direct WebSocket connection)
    builder.skip_negotiation(true);
    
    // Build connection
    connection_ = std::make_unique&lt;signalr::hub_connection&gt;(builder.build());
}
</code></pre>
<p><strong>3. è¶æ¶åå¿è·³éç½®</strong></p>
<pre><code class="language-cpp">signalr::signalr_client_config cfg;
cfg.set_server_timeout(std::chrono::seconds(60));     // server expects 60s idle
cfg.set_keepalive_interval(std::chrono::seconds(15)); // send ping every 15s
cfg.set_handshake_timeout(std::chrono::seconds(5));   // short handshake timeout

// IMPORTANT: Disable library's auto-reconnect! It has race condition bugs
cfg.enable_auto_reconnect(false);
connection_-&gt;set_client_config(cfg);
</code></pre>
<p><strong>4. è¿æ¥ç¡®è®¤åèªå¨æ³¨å</strong></p>
<pre><code class="language-cpp">// Register Notification handler to confirm connection
connection_-&gt;on("Notification", [this](const std::vector&lt;signalr::value&gt;&amp; args) {
    if (args.empty()) return;
    
    std::string message = args[0].as_string();
    ESP_LOGI(TAG, "ð Notification from server: %s", message.c_str());
    
    if (!connection_confirmed_) {
        connection_confirmed_ = true;
        ESP_LOGI(TAG, "âââ SIGNALR CONNECTION CONFIRMED BY SERVER! âââ");
        
        // ð Auto-register device info after connection confirmed
        std::string mac_address = DeviceInfo::GetMacAddress();
        std::string metadata = DeviceInfo::BuildMetadataJson();
        
        RegisterDevice(mac_address, "", metadata, [](bool success, const std::string&amp; result) {
            if (success) {
                ESP_LOGI(TAG, "â Device auto-registration successful");
            }
        });
    }
});
</code></pre>
<p><strong>5. èªå®ä¹æ¶æ¯å¤ç</strong></p>
<pre><code class="language-cpp">connection_-&gt;on("CustomMessage", [this](const std::vector&lt;signalr::value&gt;&amp; args) {
    if (args.empty()) return;
    
    try {
        std::string json_str = args[0].as_string();
        ESP_LOGI(TAG, "ð¨ Received CustomMessage: %s", json_str.c_str());
        
        auto root = cJSON_Parse(json_str.c_str());
        if (root) {
            if (on_custom_message_) {
                on_custom_message_(root);  // è°ç¨ç¨æ·è®¾ç½®çåè°
            }
            cJSON_Delete(root);
        }
    } catch (const std::exception&amp; e) {
        ESP_LOGE(TAG, "Exception handling CustomMessage: %s", e.what());
    }
});
</code></pre>
<p><strong>6. èªå¨éè¿æºå¶</strong> - ä½¿ç¨PSRAMæ çåå°ä»»å¡</p>
<pre><code class="language-cpp">void SignalRClient::StartReconnectTask() {
    ESP_LOGI(TAG, "Starting SignalR reconnect background task (PSRAM stack)...");
    reconnect_task_running_.store(true, std::memory_order_release);
    
    // Allocate task stack from PSRAM (reusable)
    reconnect_task_stack_ = (StackType_t*)heap_caps_malloc(
        RECONNECT_TASK_STACK_SIZE, MALLOC_CAP_SPIRAM);
    
    // Create task with static allocation (stack in PSRAM)
    reconnect_task_handle_ = xTaskCreateStatic(
        ReconnectTaskEntry, "signalr_reconn",
        RECONNECT_TASK_STACK_SIZE / sizeof(StackType_t),
        this, 2, reconnect_task_stack_, reconnect_task_buffer_
    );
}

void SignalRClient::ReconnectTaskLoop() {
    while (reconnect_task_running_.load(std::memory_order_acquire)) {
        vTaskDelay(pdMS_TO_TICKS(1000));
        
        if (!reconnect_requested_.load() || IsConnected()) {
            continue;
        }
        
        // Apply exponential backoff
        ESP_LOGI(TAG, "Attempting connection (backoff=%dms)...", reconnect_backoff_ms_);
        
        if (Connect() &amp;&amp; IsConnected()) {
            reconnect_backoff_ms_ = 1000;  // Reset backoff on success
        } else {
            vTaskDelay(pdMS_TO_TICKS(reconnect_backoff_ms_));
            reconnect_backoff_ms_ = std::min(reconnect_backoff_ms_ * 2, 
                MAX_RECONNECT_BACKOFF_MS);  // Exponential backoff
        }
    }
}
</code></pre>
<p><strong>7. è®¾å¤æ³¨ååå¿è·³</strong></p>
<pre><code class="language-cpp">void SignalRClient::RegisterDevice(
    const std::string&amp; mac_address,
    const std::string&amp; device_token,
    const std::string&amp; metadata,
    std::function&lt;void(bool, const std::string&amp;)&gt; callback) {
    
    if (!IsConnected()) {
        if (callback) callback(false, "Not connected");
        return;
    }
    
    std::vector&lt;signalr::value&gt; args;
    args.push_back(signalr::value(mac_address));
    args.push_back(signalr::value(device_token));
    args.push_back(signalr::value(metadata));
    
    connection_-&gt;invoke("RegisterDevice", args,
        [callback](const signalr::value&amp; result, std::exception_ptr ex) {
            if (ex) {
                if (callback) callback(false, "Registration failed");
            } else {
                if (callback) callback(true, "Registration sent");
            }
        });
}

void SignalRClient::SendHeartbeat(
    std::function&lt;void(bool, const std::string&amp;)&gt; callback) {
    
    if (!IsConnected()) {
        if (callback) callback(false, "Not connected");
        return;
    }
    
    std::vector&lt;signalr::value&gt; args;
    connection_-&gt;invoke("Heartbeat", args,
        [callback](const signalr::value&amp; result, std::exception_ptr ex) {
            if (!ex) {
                ESP_LOGD(TAG, "ð Heartbeat sent");
                if (callback) callback(true, "Success");
            }
        });
}
</code></pre>
<p><strong>SignalRå®¢æ·ç«¯ç±»å®ä¹</strong> (signalr_client.h):</p>
<pre><code class="language-cpp">class SignalRClient {
public:
    static SignalRClient&amp; GetInstance();
    
    // è¿æ¥ç®¡ç
    bool Initialize(const std::string&amp; hub_url, const std::string&amp; token);
    bool Connect();
    void Disconnect();
    void Reset();
    void RequestReconnect();
    
    // ç¶ææ¥è¯¢
    bool IsInitialized() const;
    bool IsConnecting() const;
    bool IsConnected() const;
    std::string GetConnectionState() const;
    
    // åè°è®¾ç½®
    void OnCustomMessage(std::function&lt;void(const cJSON*)&gt; callback);
    void OnDeviceRegistered(std::function&lt;void(const cJSON*)&gt; callback);
    
    // Hubæ¹æ³è°ç¨
    void RegisterDevice(const std::string&amp; mac_address,
                       const std::string&amp; device_token,
                       const std::string&amp; metadata,
                       std::function&lt;void(bool, const std::string&amp;)&gt; callback);
    void SendHeartbeat(std::function&lt;void(bool, const std::string&amp;)&gt; callback);
    void InvokeHubMethod(const std::string&amp; method_name,
                        const std::string&amp; args_json,
                        std::function&lt;void(bool, const std::string&amp;)&gt; callback);

private:
    SignalRClient();
    ~SignalRClient();
    
    std::unique_ptr&lt;signalr::hub_connection&gt; connection_;
    std::string hub_url_;
    std::string token_;
    bool initialized_ = false;
    bool connection_confirmed_ = false;
    std::atomic&lt;bool&gt; reconnect_requested_{false};
    
    // åè°å½æ°
    std::function&lt;void(const cJSON*)&gt; on_custom_message_;
    std::function&lt;void(const cJSON*)&gt; on_device_registered_;
    
    // éè¿ä»»å¡
    TaskHandle_t reconnect_task_handle_ = nullptr;
    int reconnect_backoff_ms_ = 1000;
};
</code></pre>
<p><strong>ä½¿ç¨ç¤ºä¾</strong>ï¼</p>
<pre><code class="language-cpp">// å¨ä¸»åºç¨ä¸­ä½¿ç¨SignalRå®¢æ·ç«¯
void Application::InitializeSignalR() {
    auto&amp; client = SignalRClient::GetInstance();
    
    // è®¾ç½®æ¶æ¯åè°
    client.OnCustomMessage([this](const cJSON* json) {
        ESP_LOGI(TAG, "Received message from server");
        HandleServerMessage(json);
    });
    
    // åå§åå¹¶è¿æ¥
    std::string hub_url = "wss://your-server.com/devicehub";
    std::string token = GetJwtToken();  // ä»NVSè¯»åææ«ç è·å
    
    if (client.Initialize(hub_url, token)) {
        if (client.Connect()) {
            client.RequestReconnect();  // å¯å¨èªå¨éè¿ä»»å¡
        }
    }
}
</code></pre>
<h5 id="applicationå±éæä»£ç ">Applicationå±éæä»£ç </h5>
<p><strong>æ ¸å¿ä»£ç çæ®µ</strong> (application.cc):</p>
<pre><code class="language-cpp">
void Application::HandleSignalRMessage(const std::string&amp; message) {
    ESP_LOGI(TAG, "Handling SignalR message: %s", message.c_str());
    
    auto root = cJSON_Parse(message.c_str());
    if (!root) {
        ESP_LOGE(TAG, "Failed to parse SignalR message JSON");
        return;
    }
    
    auto display = Board::GetInstance().GetDisplay();
    
    // Check message action/type
    auto action = cJSON_GetObjectItem(root, "action");
    if (cJSON_IsString(action)) {
        if (strcmp(action-&gt;valuestring, "notification") == 0) {
            // Handle notification
            // JSON: {"action":"notification", "title":"æ é¢", "content":"åå®¹", "emotion":"bell", "sound":"popup"}
            auto title = cJSON_GetObjectItem(root, "title");
            auto content = cJSON_GetObjectItem(root, "content");
            auto emotion = cJSON_GetObjectItem(root, "emotion");
            auto sound = cJSON_GetObjectItem(root, "sound");
            
            const char* title_str = cJSON_IsString(title) ? title-&gt;valuestring : Lang::Strings::INFO;
            const char* content_str = cJSON_IsString(content) ? content-&gt;valuestring : "";
            const char* emotion_str = cJSON_IsString(emotion) ? emotion-&gt;valuestring : "bell";
            
            // Select sound based on "sound" field
            std::string_view sound_view = Lang::Sounds::OGG_POPUP;
            if (cJSON_IsString(sound)) {
                if (strcmp(sound-&gt;valuestring, "success") == 0) {
                    sound_view = Lang::Sounds::OGG_SUCCESS;
                } else if (strcmp(sound-&gt;valuestring, "vibration") == 0) {
                    sound_view = Lang::Sounds::OGG_VIBRATION;
                } else if (strcmp(sound-&gt;valuestring, "exclamation") == 0) {
                    sound_view = Lang::Sounds::OGG_EXCLAMATION;
                } else if (strcmp(sound-&gt;valuestring, "low_battery") == 0) {
                    sound_view = Lang::Sounds::OGG_LOW_BATTERY;
                } else if (strcmp(sound-&gt;valuestring, "none") == 0) {
                    sound_view = "";
                }
                // default: popup
            }
            
            Alert(title_str, content_str, emotion_str, sound_view);
            
        } else if (strcmp(action-&gt;valuestring, "command") == 0) {
            // Handle command
            // JSON: {"action":"command", "command":"reboot|wake|listen|stop"}
            auto cmd = cJSON_GetObjectItem(root, "command");
            if (cJSON_IsString(cmd)) {
                if (strcmp(cmd-&gt;valuestring, "reboot") == 0) {
                    Reboot();
                } else if (strcmp(cmd-&gt;valuestring, "wake") == 0) {
                    // Trigger wake word detection
                    xEventGroupSetBits(event_group_, MAIN_EVENT_WAKE_WORD_DETECTED);
                } else if (strcmp(cmd-&gt;valuestring, "listen") == 0) {
                    StartListening();
                } else if (strcmp(cmd-&gt;valuestring, "stop") == 0) {
                    StopListening();
                } else {
                    ESP_LOGW(TAG, "Unknown SignalR command: %s", cmd-&gt;valuestring);
                }
            }
            
        } else if (strcmp(action-&gt;valuestring, "display") == 0) {
            // Display custom content
            // JSON: {"action":"display", "content":"ææ¬åå®¹", "role":"system"}
            auto content = cJSON_GetObjectItem(root, "content");
            auto role = cJSON_GetObjectItem(root, "role");
            const char* role_str = cJSON_IsString(role) ? role-&gt;valuestring : "system";
            if (cJSON_IsString(content)) {
                display-&gt;SetChatMessage(role_str, content-&gt;valuestring);
            }
            
        } else if (strcmp(action-&gt;valuestring, "emotion") == 0) {
            // Change emotion/expression
            // JSON: {"action":"emotion", "emotion":"happy"}
            auto emotion = cJSON_GetObjectItem(root, "emotion");
            if (cJSON_IsString(emotion)) {
                display-&gt;SetEmotion(emotion-&gt;valuestring);
            }
            
        } else if (strcmp(action-&gt;valuestring, "image") == 0) {
            // Display image from URL
            // JSON: {"action":"image", "url":"https://example.com/image.jpg"}
            auto url = cJSON_GetObjectItem(root, "url");
            if (cJSON_IsString(url)) {
                HandleSignalRImageMessage(url-&gt;valuestring);
            } else {
                ESP_LOGW(TAG, "Image action requires 'url' field");
            }
            
        } else if (strcmp(action-&gt;valuestring, "audio") == 0) {
            // Play audio from URL (OGG format)
            // JSON: {"action":"audio", "url":"https://example.com/sound.ogg"}
            auto url = cJSON_GetObjectItem(root, "url");
            if (cJSON_IsString(url)) {
                HandleSignalRAudioMessage(url-&gt;valuestring);
            } else {
                ESP_LOGW(TAG, "Audio action requires 'url' field");
            }
            
        } else if (strcmp(action-&gt;valuestring, "qrcode") == 0) {
            // Show QR code
            // JSON: {"action":"qrcode", "data":"https://...", "title":"æ é¢", "subtitle":"å¯æ é¢"}
            auto data = cJSON_GetObjectItem(root, "data");
            auto title = cJSON_GetObjectItem(root, "title");
            auto subtitle = cJSON_GetObjectItem(root, "subtitle");
            if (cJSON_IsString(data)) {
                const char* title_str = cJSON_IsString(title) ? title-&gt;valuestring : nullptr;
                const char* subtitle_str = cJSON_IsString(subtitle) ? subtitle-&gt;valuestring : nullptr;
                display-&gt;ShowQRCode(data-&gt;valuestring, title_str, subtitle_str);
            } else {
                ESP_LOGW(TAG, "QRCode action requires 'data' field");
            }
            
        } else if (strcmp(action-&gt;valuestring, "hide_qrcode") == 0) {
            // Hide QR code
            // JSON: {"action":"hide_qrcode"}
            display-&gt;HideQRCode();
            
        } else {
            // Default: display as system message
            char* display_str = cJSON_Print(root);
            if (display_str) {
                display-&gt;SetChatMessage("system", display_str);
                cJSON_free(display_str);
            }
        }
    } else {
        // No action specified, display raw message
        char* display_str = cJSON_Print(root);
        if (display_str) {
            display-&gt;SetChatMessage("system", display_str);
            cJSON_free(display_str);
        }
    }
    
    cJSON_Delete(root);
}

</code></pre>
<p><strong>å®æ´çApplicationç±»åè½</strong>ï¼</p>
<ul>
<li>â è®¾å¤ç¶æç®¡ç (ç¶ææº)</li>
<li>â ç½ç»äºä»¶å¤ç (è¿æ¥/æ­å¼)</li>
<li>â é³é¢æå¡éæ (ç¼è§£ç ãæµå¤ç)</li>
<li>â å¤éè¯æ£æµ</li>
<li>â åè®®å±æ½è±¡ (WebSocket/MQTT)</li>
<li>â MCPæ¶æ¯è·¯ç±</li>
<li>â éè¯¯å¤çåæ¢å¤</li>
<li>â èµæºç®¡çåæ¸ç</li>
<li>â çº¿ç¨å®å¨çæ¶æ¯è°åº¦</li>
</ul>
<h4 id="522-mcpæå¡å¨ä»£ç -verdure-mcp">5.2.2 MCPæå¡å¨ä»£ç  (verdure-mcp)</h4>
<p><strong>ä»åºå°å</strong>ï¼<a href="https://github.com/maker-community/verdure-mcp" target="_blank" rel="noopener nofollow">verdure-mcp</a></p>
<p><strong>ç®å½ç»æ</strong>ï¼</p>
<pre><code>src/Verdure.Mcp.Server/
âââ Hubs/
â   âââ DeviceHub.cs          # SignalR Hubå®ç°
âââ Tools/
â   âââ MusicTool.cs          # é³ä¹æ­æ¾æ§å¶
â   âââ EmailTool.cs          # é®ä»¶åé
â   âââ WeatherTool.cs        # å¤©æ°æ¥è¯¢
â   âââ SmartHomeTool.cs      # æºè½å®¶å±æ§å¶
âââ Services/
â   âââ DeviceService.cs      # è®¾å¤ç®¡çæå¡
â   âââ McpExecutor.cs        # MCPå·¥å·æ§è¡å¨
â   âââ TokenService.cs       # JWTä»¤çæå¡
âââ Models/
    âââ DeviceConnection.cs   # è®¾å¤è¿æ¥è®°å½
    âââ DeviceInfo.cs         # è®¾å¤ä¿¡æ¯
    âââ McpToolLog.cs         # å·¥å·è°ç¨æ¥å¿
</code></pre>
<p><strong>DeviceHubå®æ´å®ç°</strong> (Hubs/DeviceHub.cs):</p>
<p>çäº§ç¯å¢çDeviceHubå®éå®ç°ç¹ç¹ï¼</p>
<ul>
<li>â æ°æ®åºæä¹å (Entity Framework Core + PostgreSQL)</li>
<li>â è®¾å¤æ³¨ååç¶æè·è¸ª</li>
<li>â ç¨æ·åè®¾å¤åç»ç®¡ç</li>
<li>â å¿è·³æ£æµ</li>
<li>â åéè®¤è¯ (JWT + API Token)</li>
<li>â å®åçå¼å¸¸å¤çåæ¥å¿</li>
</ul>
<pre><code class="language-csharp">using Microsoft.AspNetCore.SignalR;
using Verdure.Mcp.Infrastructure.Database;
using Verdure.Mcp.Infrastructure.Services;

namespace Verdure.Mcp.Server.Hubs;

/// &lt;summary&gt;
/// è®¾å¤è¿æ¥Hub - å¤çESP32ç­IoTè®¾å¤çSignalRè¿æ¥
/// &lt;/summary&gt;
public class DeviceHub : Hub
{
    private readonly McpDbContext _dbContext;
    private readonly ITokenValidationService _tokenValidationService;
    private readonly ILogger&lt;DeviceHub&gt; _logger;

    public DeviceHub(
        McpDbContext dbContext,
        ITokenValidationService tokenValidationService,
        ILogger&lt;DeviceHub&gt; logger)
    {
        _dbContext = dbContext;
        _tokenValidationService = tokenValidationService;
        _logger = logger;
    }

    /// &lt;summary&gt;
    /// è®¾å¤è¿æ¥ - æ¯æJWTåAPI Tokenåéè®¤è¯
    /// &lt;/summary&gt;
    public override async Task OnConnectedAsync()
    {
        try
        {
            var httpContext = Context.GetHttpContext();
            if (httpContext == null)
            {
                _logger.LogWarning("HttpContext is null");
                Context.Abort();
                return;
            }

            // ä»æ¥è¯¢åæ°è·åtoken
            var token = httpContext.Request.Query["access_token"].ToString();
            if (string.IsNullOrEmpty(token))
            {
                _logger.LogWarning("Connection attempt without token");
                Context.Abort();
                return;
            }

            // éªè¯token - æ¯æJWTåAPI Token
            var validationResult = await _tokenValidationService.ValidateTokenAsync(token);
            if (!validationResult.IsValid)
            {
                _logger.LogWarning("Invalid token: {Reason}", validationResult.FailureReason);
                Context.Abort();
                return;
            }

            var userId = validationResult.UserId;
            if (string.IsNullOrEmpty(userId))
            {
                _logger.LogWarning("Token valid but userId is missing");
                Context.Abort();
                return;
            }

            // å°è¿æ¥å å¥ç¨æ·ç» (æ ¼å¼: Users:{userId})
            await Groups.AddToGroupAsync(Context.ConnectionId, $"Users:{userId}");

            _logger.LogInformation(
                "Device connected: ConnectionId={ConnectionId}, UserId={UserId}",
                Context.ConnectionId, userId);

            // åéæ¬¢è¿éç¥
            await Clients.Caller.SendAsync("Notification", 
                $"Welcome! Connected to Verdure MCP Server at {DateTime.UtcNow:yyyy-MM-dd HH:mm:ss}");

            await base.OnConnectedAsync();
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error in OnConnectedAsync");
            Context.Abort();
        }
    }

    /// &lt;summary&gt;
    /// è®¾å¤æ­å¼è¿æ¥
    /// &lt;/summary&gt;
    public override async Task OnDisconnectedAsync(Exception? exception)
    {
        if (exception != null)
        {
            _logger.LogWarning(exception, 
                "Device disconnected with error: ConnectionId={ConnectionId}",
                Context.ConnectionId);
        }
        else
        {
            _logger.LogInformation(
                "Device disconnected normally: ConnectionId={ConnectionId}",
                Context.ConnectionId);
        }

        await base.OnDisconnectedAsync(exception);
    }

    /// &lt;summary&gt;
    /// è®¾å¤æ³¨å - ä¿å­è®¾å¤MACå°åååæ°æ®
    /// &lt;/summary&gt;
    public async Task RegisterDevice(string macAddress, string deviceToken, string metadata)
    {
        try
        {
            var userId = Context.Items["UserId"]?.ToString();
            if (string.IsNullOrEmpty(userId))
            {
                _logger.LogWarning("RegisterDevice called without userId");
                return;
            }

            _logger.LogInformation(
                "Device registration: UserId={UserId}, MAC={MacAddress}, Metadata={Metadata}",
                userId, macAddress, metadata);

            // å°è®¾å¤å å¥è®¾å¤ç» (æ ¼å¼: Device:{macAddress})
            await Groups.AddToGroupAsync(Context.ConnectionId, $"Device:{macAddress}");

            // ä¿å­è®¾å¤ä¿¡æ¯å°æ°æ®åº
            var existingDevice = await _dbContext.Devices
                .FirstOrDefaultAsync(d =&gt; d.MacAddress == macAddress);

            if (existingDevice != null)
            {
                existingDevice.LastSeenAt = DateTime.UtcNow;
                existingDevice.Metadata = metadata;
                existingDevice.IsOnline = true;
            }
            else
            {
                _dbContext.Devices.Add(new Device
                {
                    MacAddress = macAddress,
                    UserId = userId,
                    Metadata = metadata,
                    IsOnline = true,
                    CreatedAt = DateTime.UtcNow,
                    LastSeenAt = DateTime.UtcNow
                });
            }

            await _dbContext.SaveChangesAsync();

            // ç¡®è®¤æ³¨åæå
            await Clients.Caller.SendAsync("Notification", 
                $"Device registered successfully: {macAddress}");
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error in RegisterDevice");
        }
    }

    /// &lt;summary&gt;
    /// å¿è·³ä¿æ
    /// &lt;/summary&gt;
    public async Task Heartbeat()
    {
        _logger.LogDebug("Heartbeat from ConnectionId={ConnectionId}", Context.ConnectionId);
        
        // æ´æ°æåæ´»è·æ¶é´
        // æ³¨æï¼å®éä»£ç ä¸­å¯ä»¥æ ¹æ®ConnectionIdæ¥æ¾è®¾å¤å¹¶æ´æ°LastSeenAt
        await Task.CompletedTask;
    }
}
</code></pre>
<p><strong>å®éçMCPå·¥å·å®ç°</strong> (ä¸ä½¿ç¨åºç±»):</p>
<p>å¨verdure-mcpä¸­ï¼MCPå·¥å·<strong>ä¸ç»§æ¿ä»»ä½åºç±»</strong>ï¼èæ¯ï¼</p>
<ol>
<li>ä½¿ç¨ <code>[McpServerToolType]</code> ç¹æ§æ è®°</li>
<li>éè¿ä¾èµæ³¨å¥è·å <code>IDevicePushService</code> æå¡</li>
<li>ä½¿ç¨ <code>IDevicePushService</code> çæ¹æ³æ¨éæ¶æ¯ç»è®¾å¤</li>
</ol>
<p><strong>DevicePushServiceæ¥å£</strong> (Infrastructure/Services/DevicePushService.cs):</p>
<pre><code class="language-csharp">namespace Verdure.Mcp.Infrastructure.Services;

/// &lt;summary&gt;
/// è®¾å¤æ¨éæå¡æ¥å£
/// &lt;/summary&gt;
public interface IDevicePushService
{
    /// &lt;summary&gt;
    /// åç¨æ·çææè®¾å¤åéæ¶æ¯
    /// &lt;/summary&gt;
    Task SendToUserAsync(string userId, string method, object message, 
        CancellationToken cancellationToken = default);

    /// &lt;summary&gt;
    /// åæå®è®¾å¤åéæ¶æ¯
    /// &lt;/summary&gt;
    Task SendToDeviceAsync(string deviceId, string method, object message, 
        CancellationToken cancellationToken = default);

    /// &lt;summary&gt;
    /// åéèªå®ä¹æ¶æ¯ (xiaozhiåè®®æ ¼å¼)
    /// &lt;/summary&gt;
    Task SendCustomMessageAsync(string userId, object message, 
        CancellationToken cancellationToken = default);

    /// &lt;summary&gt;
    /// åééç¥æ¶æ¯
    /// &lt;/summary&gt;
    Task SendNotificationAsync(string userId, string notificationMessage, 
        CancellationToken cancellationToken = default);
}
</code></pre>
<p><strong>DevicePushServiceå®ç°</strong> (Server/Services/DevicePushServiceImpl.cs):</p>
<pre><code class="language-csharp">using Microsoft.AspNetCore.SignalR;
using Verdure.Mcp.Server.Hubs;
using Verdure.Mcp.Infrastructure.Services;
using System.Text.Json;

namespace Verdure.Mcp.Server.Services;

public class DevicePushServiceImpl : IDevicePushService
{
    private readonly IHubContext&lt;DeviceHub&gt; _hubContext;
    private readonly ILogger&lt;DevicePushServiceImpl&gt; _logger;

    public DevicePushServiceImpl(
        IHubContext&lt;DeviceHub&gt; hubContext,
        ILogger&lt;DevicePushServiceImpl&gt; logger)
    {
        _hubContext = hubContext;
        _logger = logger;
    }

    public async Task SendToUserAsync(string userId, string method, object message, 
        CancellationToken cancellationToken = default)
    {
        var groupName = $"Users:{userId}";
        await _hubContext.Clients.Group(groupName)
            .SendAsync(method, message, cancellationToken);
        
        _logger.LogInformation("Sent {Method} to user {UserId}", method, userId);
    }

    public async Task SendToDeviceAsync(string deviceId, string method, object message, 
        CancellationToken cancellationToken = default)
    {
        var groupName = $"Device:{deviceId}";
        await _hubContext.Clients.Group(groupName)
            .SendAsync(method, message, cancellationToken);
        
        _logger.LogInformation("Sent {Method} to device {DeviceId}", method, deviceId);
    }

    public async Task SendCustomMessageAsync(string userId, object message, 
        CancellationToken cancellationToken = default)
    {
        var groupName = $"Users:{userId}";
        
        // éè¦ï¼ESP32å®¢æ·ç«¯æææ¥æ¶JSONå­ç¬¦ä¸²ï¼èä¸æ¯å¯¹è±¡
        var jsonString = JsonSerializer.Serialize(message);
        
        await _hubContext.Clients.Group(groupName)
            .SendAsync("CustomMessage", jsonString, cancellationToken);
        
        _logger.LogInformation("Sent CustomMessage to user {UserId}: {Message}", 
            userId, jsonString);
    }

    public async Task SendNotificationAsync(string userId, string notificationMessage, 
        CancellationToken cancellationToken = default)
    {
        var groupName = $"Users:{userId}";
        await _hubContext.Clients.Group(groupName)
            .SendAsync("Notification", notificationMessage, cancellationToken);
        
        _logger.LogInformation("Sent notification to user {UserId}: {Message}", 
            userId, notificationMessage);
    }
}
</code></pre>
<p><strong>é³ä¹æ­æ¾å·¥å·å®éå®ç°</strong> (Tools/MusicTool.cs):</p>
<pre><code class="language-csharp">using System;
using System.ComponentModel;
using System.IO;
using System.Linq;
using System.Threading;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.Http;
using Microsoft.Extensions.Logging;
using Microsoft.Extensions.Options;
using Verdure.Mcp.Server.Settings;
using ModelContextProtocol.Server;
using Verdure.Mcp.Infrastructure.Services;
using Verdure.Mcp.Server.Services;
using Hangfire;

namespace Verdure.Mcp.Server.Tools;

/// &lt;summary&gt;
/// MCP Tool to pick a random audio file from wwwroot and push its URL to device(s).
/// &lt;/summary&gt;
[McpServerToolType]
public class MusicTool
{
    private readonly IHttpContextAccessor _httpContextAccessor;
    private readonly IWebHostEnvironment _env;
    private readonly IDevicePushService _devicePushService;
    private readonly ILogger&lt;MusicTool&gt; _logger;
    private readonly IBackgroundJobClient _backgroundJobClient;
    private readonly ImageStorageSettings _imageStorageSettings;

    public MusicTool(
        IHttpContextAccessor httpContextAccessor,
        IWebHostEnvironment env,
        IDevicePushService devicePushService,
        ILogger&lt;MusicTool&gt; logger,
        IBackgroundJobClient backgroundJobClient,
        IOptions&lt;ImageStorageSettings&gt;? imageSettings = null)
    {
        _httpContextAccessor = httpContextAccessor;
        _env = env;
        _devicePushService = devicePushService;
        _logger = logger;
        _backgroundJobClient = backgroundJobClient;
        _imageStorageSettings = imageSettings?.Value ?? new ImageStorageSettings();
    }

    /// &lt;summary&gt;
    /// Select a random audio file from the `wwwroot/audio` folder and push it to the user
    /// identified by the `X-User-Id` request header.
    /// The pushed message follows the same shape as used in `test-send-message.ps1` (action = "audio", url = "...").
    /// &lt;/summary&gt;
    [McpServerTool(Name = "play_random_music")]
    [Description("Plays a random audio file from wwwroot/audio by pushing an audio message to the user's devices")]
    public async Task&lt;MusicResponse&gt; PlayRandomMusic(CancellationToken cancellationToken = default)
    {
        try
        {
            var httpContext = _httpContextAccessor.HttpContext;
            var effectiveUserId = httpContext?.Request.Headers["X-User-Id"].FirstOrDefault();
            if (string.IsNullOrEmpty(effectiveUserId))
            {
                _logger.LogWarning("No userId provided and X-User-Id header is missing");
                return new MusicResponse { Success = false, Message = "Missing userId or X-User-Id header" };
            }

            var webRoot = _env.WebRootPath ?? _env.ContentRootPath;
            var folder = "audios";
            var audioFolder = Path.Combine(webRoot, folder);

            if (!Directory.Exists(audioFolder))
            {
                _logger.LogWarning("Audio folder does not exist: {AudioFolder}", audioFolder);
                return new MusicResponse { Success = false, Message = $"Audio folder not found: {folder}" };
            }

            // Find audio files (ogg, mp3) and pick a random one
            var files = Directory.GetFiles(audioFolder)
                .Where(f =&gt; f.EndsWith('.' + "ogg") || f.EndsWith('.' + "mp3") || f.EndsWith('.' + "wav"))
                .ToArray();

            if (files.Length == 0)
            {
                _logger.LogWarning("No audio files found in {AudioFolder}", audioFolder);
                return new MusicResponse { Success = false, Message = "No audio files found" };
            }

            var rnd = new Random();
            var chosen = files[rnd.Next(files.Length)];
            var fileName = Path.GetFileName(chosen);

            string url;
            // Prefer configured ImageStorage BaseUrl (keeps image and audio base URL consistent)
            if (!string.IsNullOrWhiteSpace(_imageStorageSettings.BaseUrl))
            {
                var cfgBase = _imageStorageSettings.BaseUrl.TrimEnd('/');
                url = $"{cfgBase}/{folder}/{Uri.EscapeDataString(fileName)}";
            }
            else
            {
                var req = httpContext?.Request;
                var hostBase = req != null ? $"{req.Scheme}://{req.Host.Value}" : string.Empty;
                url = string.IsNullOrEmpty(hostBase)
                    ? $"/{folder}/{Uri.EscapeDataString(fileName)}"
                    : $"{hostBase}/{folder}/{Uri.EscapeDataString(fileName)}";
            }

            var title = Path.GetFileNameWithoutExtension(fileName);

            var message = new
            {
                action = "audio",
                url,
                title
            };

            // Schedule push as a delayed background job so device can play result first.
            try
            {

                var jobDelay = TimeSpan.FromSeconds(5);

                _logger.LogInformation("Scheduling audio push to user {UserId} after {Delay}s: {Url}",
                    effectiveUserId, jobDelay.TotalSeconds, url);

                _backgroundJobClient.Schedule&lt;MusicPushBackgroundJob&gt;(
                    job =&gt; job.ExecuteAsync(effectiveUserId, url, title, CancellationToken.None),
                    jobDelay);

                return new MusicResponse { Success = true, Message = "Audio scheduled", Url = url, FileName = fileName };
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Failed to schedule audio push for user {UserId}", effectiveUserId);
                return new MusicResponse { Success = false, Message = ex.Message };
            }
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Failed to play random music");
            return new MusicResponse { Success = false, Message = ex.Message };
        }
    }
}

public class MusicResponse
{
    public bool Success { get; set; }
    public required string Message { get; set; }
    public string? Url { get; set; }
    public string? FileName { get; set; }
}

</code></pre>
<p><strong>å»¶è¿æ¨éåå°ä»»å¡</strong> (Tools/MusicPushBackgroundJob.cs):</p>
<pre><code class="language-csharp">using Verdure.Mcp.Infrastructure.Services;
using Verdure.Mcp.Server.Services;

namespace Verdure.Mcp.Server.Tools;

/// &lt;summary&gt;
/// Background job to push music/audio messages to user devices after a delay.
/// &lt;/summary&gt;
public class MusicPushBackgroundJob
{
    private readonly IDevicePushService _devicePushService;
    private readonly ILogger&lt;MusicPushBackgroundJob&gt; _logger;

    public MusicPushBackgroundJob(IDevicePushService devicePushService, ILogger&lt;MusicPushBackgroundJob&gt; logger)
    {
        _devicePushService = devicePushService;
        _logger = logger;
    }

    public async Task ExecuteAsync(string userId, string url, string title, CancellationToken cancellationToken)
    {
        _logger.LogInformation("Executing MusicPushBackgroundJob: user={UserId}, url={Url}", userId, url);

        var message = new
        {
            action = "audio",
            url,
            title
        };

        try
        {
            await _devicePushService.SendCustomMessageAsync(userId, message, cancellationToken);
            _logger.LogInformation("Music pushed to user {UserId}", userId);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Failed to push music to user {UserId}", userId);
        }
    }
}

</code></pre>
<h4 id="523-å¾ççæå·¥å·å®ç°ç¤ºä¾">5.2.3 å¾ççæå·¥å·å®ç°ç¤ºä¾</h4>
<p><strong>ä»åºå°å</strong>ï¼<a href="https://github.com/maker-community/verdure-mcp/blob/main/src/Verdure.Mcp.Server/Tools/GenerateImageTool.cs" target="_blank" rel="noopener nofollow">verdure-mcp - GenerateImageTool</a></p>
<p>è¿ä¸ªå·¥å·å±ç¤ºäºå¦ä½çæå¾çå¹¶æ¨éå°è®¾å¤ï¼</p>
<pre><code class="language-csharp">using System.ComponentModel;
using System.Net;
using Hangfire;
using Microsoft.EntityFrameworkCore;
using ModelContextProtocol.Server;
using Verdure.Mcp.Domain.Entities;
using Verdure.Mcp.Domain.Enums;
using Verdure.Mcp.Infrastructure.Data;
using Verdure.Mcp.Infrastructure.Services;
using Verdure.Mcp.Server.Services;

namespace Verdure.Mcp.Server.Tools;

/// &lt;summary&gt;
/// ä½¿ç¨ Azure OpenAI DALL-E çæå¾çç MCP å·¥å·
/// &lt;/summary&gt;
[McpServerToolType]
public class GenerateImageTool
{
    private readonly IImageGenerationService _imageGenerationService;
    private readonly IEmailService _emailService;
    private readonly McpDbContext _dbContext;
    private readonly IBackgroundJobClient _backgroundJobClient;
    private readonly IHttpContextAccessor _httpContextAccessor;
    private readonly IImageStorageService _imageStorageService;
    private readonly IDevicePushService _devicePushService;
    private readonly ILogger&lt;GenerateImageTool&gt; _logger;

    public GenerateImageTool(
        IImageGenerationService imageGenerationService,
        IEmailService emailService,
        McpDbContext dbContext,
        IBackgroundJobClient backgroundJobClient,
        IHttpContextAccessor httpContextAccessor,
        IImageStorageService imageStorageService,
        IDevicePushService devicePushService,
        ILogger&lt;GenerateImageTool&gt; logger)
    {
        _imageGenerationService = imageGenerationService;
        _emailService = emailService;
        _dbContext = dbContext;
        _backgroundJobClient = backgroundJobClient;
        _httpContextAccessor = httpContextAccessor;
        _imageStorageService = imageStorageService;
        _devicePushService = devicePushService;
        _logger = logger;
    }

    /// &lt;summary&gt;
    /// ä½¿ç¨ Azure OpenAI DALL-E æ ¹æ®æç¤ºè¯çæå¾çã
    /// å¦ææä¾é®ç®±å°åï¼ä¼å°çæçå¾çåéå°æå®é®ç®±ã
    /// å¦æè¯·æ±å¤´ä¸­åå«ç¨æ·ä¿¡æ¯ï¼X-User-Email å X-User-Idï¼ï¼ä»»å¡å°å¼æ­¥è¿è¡ã
    /// &lt;/summary&gt;
    /// &lt;param name="prompt"&gt;æè¿°è¦çæå¾ççææ¬æç¤ºè¯&lt;/param&gt;
    /// &lt;param name="size"&gt;å¾çå°ºå¯¸ï¼"1024x1024"ã"1792x1024" æ "1024x1792"ï¼é»è®¤ä¸º "1024x1024"&lt;/param&gt;
    /// &lt;param name="quality"&gt;å¾çè´¨éï¼"standard" æ "hd"ï¼é»è®¤ä¸º "standard"&lt;/param&gt;
    /// &lt;param name="style"&gt;å¾çé£æ ¼ï¼"vivid" æ "natural"ï¼é»è®¤ä¸º "vivid"&lt;/param&gt;
    /// &lt;param name="cancellationToken"&gt;&lt;/param&gt;
    /// &lt;returns&gt;åå«ä»»å¡ä¿¡æ¯åå¾çæ°æ®ç JSON å¯¹è±¡ï¼åæ­¥æ¨¡å¼ä¸ï¼&lt;/returns&gt;
    [McpServerTool(Name = "generate_image")]
    [Description("ä½¿ç¨ DALL-E æ¨¡åï¼æ ¹æ®ææ¬æç¤ºè¯çæå¾çãæ¯æé®ä»¶éç¥åå¼æ­¥å¤çã")]
    public async Task&lt;ImageGenerationResponse&gt; GenerateImage(
        [Description("æè¿°è¦çæå¾ççææ¬æç¤ºè¯")] string prompt,
        [Description("å¾çå°ºå¯¸ï¼'1024x1024'ã'1792x1024' æ '1024x1792'ï¼é»è®¤ä¸º '1024x1024'")] string? size = null,
        [Description("å¾çè´¨éï¼'standard' æ 'hd'ï¼é»è®¤ä¸º 'standard'")] string? quality = null,
        [Description("å¾çé£æ ¼ï¼'vivid' æ 'natural'ï¼é»è®¤ä¸º 'vivid'")] string? style = null,
        CancellationToken cancellationToken = default)
    {
        var httpContext = _httpContextAccessor.HttpContext;
        
        // ä»è¯·æ±å¤´æåé®ç®±å°å (X-User-Email)
        var email = httpContext?.Request.Headers["X-User-Email"].FirstOrDefault();
        
        // ä»è¯·æ±å¤´æåç¨æ· ID (X-User-Id)
        var userId = httpContext?.Request.Headers["X-User-Id"].FirstOrDefault();

        _logger.LogInformation("æ¶å°å¾ççæè¯·æ±ãæç¤ºè¯: {Prompt}, é®ç®±: {Email}, ç¨æ·ID: {UserId}", 
            prompt, email ?? "æ ", userId ?? "æ ");

        // åå»ºä»»å¡è®°å½
        var task = new ImageGenerationTask
        {
            Id = Guid.NewGuid(),
            Prompt = prompt,
            Size = size ?? "1024x1024",
            Quality = quality ?? "standard",
            Style = style ?? "vivid",
            Status = ImageTaskStatus.Pending,
            Email = email,
            UserId = userId,
            CreatedAt = DateTime.UtcNow
        };

        _dbContext.ImageGenerationTasks.Add(task);
        await _dbContext.SaveChangesAsync(cancellationToken);

        // å¦æå­å¨ç¨æ·ä¿¡æ¯ï¼X-User-Email å X-User-Idï¼ï¼ä½¿ç¨ Hangfire å¼æ­¥å¤ç
        if (!string.IsNullOrEmpty(email) &amp;&amp; !string.IsNullOrEmpty(userId))
        {
            _logger.LogInformation("æ£æµå°ç¨æ·ä¿¡æ¯ï¼ä½¿ç¨å¼æ­¥å¤çä»»å¡ {TaskId}", task.Id);
            
            var jobId = _backgroundJobClient.Enqueue&lt;ImageGenerationBackgroundJob&gt;(
                job =&gt; job.ExecuteAsync(task.Id, CancellationToken.None));
            
            task.HangfireJobId = jobId;
            task.Status = ImageTaskStatus.Processing;
            await _dbContext.SaveChangesAsync(cancellationToken);

            return new ImageGenerationResponse
            {
                TaskId = task.Id,
                Status = "å¤çä¸­",
                Message = "å¾ççæä»»å¡å·²å å¥éåãå¦ææ¨æä¾äºé®ç®±å°åï¼ç¨åä¼æ¶å°çæç»æã",
                IsAsync = true
            };
        }
        else
        {
            // åæ­¥å¤ç
            _logger.LogInformation("æªæ£æµå°å®æ´ç¨æ·ä¿¡æ¯ï¼ä½¿ç¨åæ­¥å¤çä»»å¡ {TaskId}", task.Id);
            
            task.Status = ImageTaskStatus.Processing;
            await _dbContext.SaveChangesAsync(cancellationToken);

            try
            {
                var result = await _imageGenerationService.GenerateImageAsync(
                    prompt, size, quality, style, cancellationToken);

                if (result.Success)
                {
                    task.Status = ImageTaskStatus.Completed;
                    task.ImageData = result.ImageBase64;
                    task.CompletedAt = DateTime.UtcNow;
                    task.UpdatedAt = DateTime.UtcNow;

                    // ä¿å­å¾çå°æ¬å°æä»¶ç³»ç»ï¼PNG + JPEGï¼
                    ImageStorageResult? storageResult = null;
                    if (!string.IsNullOrEmpty(result.ImageBase64))
                    {
                        try
                        {
                            storageResult = await _imageStorageService.SaveImageAsync(
                                result.ImageBase64, 
                                task.Id, 
                                cancellationToken);
                            task.ImageUrl = storageResult.PngUrl; // æ°æ®åºä¿å­ PNG URL
                            _logger.LogInformation(
                                "å¾çå·²ä¿å­ - PNG: {PngUrl}, JPEG: {JpegUrl}, åç¼©ç: {CompressionRatio:F1}%",
                                storageResult.PngUrl, storageResult.JpegUrl, storageResult.CompressionRatio);
                        }
                        catch (Exception ex)
                        {
                            _logger.LogError(ex, "ä¿å­å¾çå°æ¬å°å¤±è´¥ï¼ä»»å¡ {TaskId}", task.Id);
                            // å³ä½¿ä¿å­å¤±è´¥ï¼ä»ç¶ç»§ç»­æµç¨
                        }
                    }

                    await _dbContext.SaveChangesAsync(cancellationToken);

                    // å¦ææä¾äºé®ç®±ï¼åéé®ä»¶
                    if (!string.IsNullOrEmpty(email) &amp;&amp; !string.IsNullOrEmpty(result.ImageBase64))
                    {
                        try
                        {
                            var imageBytes = Convert.FromBase64String(result.ImageBase64);
                            var encodedPrompt = WebUtility.HtmlEncode(prompt);
                            var encodedRevisedPrompt = WebUtility.HtmlEncode(result.RevisedPrompt ?? "æ ");
                            await _emailService.SendImageEmailAsync(
                                email,
                                "æ¨çå¾çå·²çæ",
                                $"&lt;h1&gt;æ¨çå¾çå·²æåçæï¼&lt;/h1&gt;&lt;p&gt;æç¤ºè¯ï¼{encodedPrompt}&lt;/p&gt;&lt;p&gt;ä¿®è®¢åçæç¤ºè¯ï¼{encodedRevisedPrompt}&lt;/p&gt;",
                                imageBytes,
                                $"image_{task.Id}.png",
                                cancellationToken);
                            
                            task.EmailSent = true;
                            await _dbContext.SaveChangesAsync(cancellationToken);
                        }
                        catch (Exception ex)
                        {
                            _logger.LogError(ex, "åéé®ä»¶å¤±è´¥ï¼ä»»å¡ {TaskId}", task.Id);
                        }
                    }

                    // å¦ææç¨æ· IDï¼æ¨éå°ç¨æ·è®¾å¤ï¼ä½¿ç¨ JPEG çæ¬ï¼ç¬¦å xiaozhi åè®®ï¼
                    if (!string.IsNullOrEmpty(userId) &amp;&amp; storageResult != null)
                    {
                        try
                        {
                            // 1. ååééç¥æ¶æ¯
                            var notificationMessage = new
                            {
                                action = "notification",
                                title = "å¾ççæå®æ",
                                content = $"æ¨çå¾çå·²çæï¼{prompt.Substring(0, Math.Min(30, prompt.Length))}...",
                                emotion = "happy",
                                sound = "success"
                            };
                            await _devicePushService.SendCustomMessageAsync(userId, notificationMessage, cancellationToken);
                            
                            // 2. ååéå¾çæ¶æ¯ï¼ESP32 ææçæ ¼å¼ - xiaozhi åè®®ï¼
                            var imageMessage = new
                            {
                                action = "image",
                                url = storageResult.JpegUrl,  // ä½¿ç¨ JPEG URLï¼ä½ç§¯å°ï¼
                                // æ©å±ä¿¡æ¯ï¼å¯éï¼ESP32 å¯ä»¥å¿½ç¥ï¼
                                taskId = task.Id.ToString(),
                                pngUrl = storageResult.PngUrl,
                                prompt = prompt,
                                jpegSize = storageResult.JpegSize,
                                timestamp = DateTime.UtcNow
                            };

                            await _devicePushService.SendCustomMessageAsync(userId, imageMessage, cancellationToken);
                            _logger.LogInformation(
                                "å·²æ¨éå¾çå°ç¨æ· {UserId} çè®¾å¤ï¼ä»»å¡ {TaskId}ï¼JPEG URL: {JpegUrl} ({JpegSize} bytes)", 
                                userId, task.Id, storageResult.JpegUrl, storageResult.JpegSize);
                        }
                        catch (Exception ex)
                        {
                            _logger.LogError(ex, "æ¨éæ¶æ¯å°è®¾å¤å¤±è´¥ï¼ç¨æ· {UserId}ï¼ä»»å¡ {TaskId}", userId, task.Id);
                        }
                    }

                    // åæ­¥æ¨¡å¼ï¼è¿å PNG URLï¼å®æ´è´¨éï¼
                    return new ImageGenerationResponse
                    {
                        TaskId = task.Id,
                        Status = "å·²å®æ",
                        Message = "å¾ççææå",
                        ImageUrl = storageResult?.PngUrl ?? result.ImageUrl,
                        RevisedPrompt = result.RevisedPrompt,
                        IsAsync = false
                    };
                }
                else
                {
                    task.Status = ImageTaskStatus.Failed;
                    task.ErrorMessage = result.ErrorMessage;
                    task.UpdatedAt = DateTime.UtcNow;
                    await _dbContext.SaveChangesAsync(cancellationToken);

                    return new ImageGenerationResponse
                    {
                        TaskId = task.Id,
                        Status = "å¤±è´¥",
                        Message = result.ErrorMessage ?? "å¾ççæå¤±è´¥",
                        IsAsync = false
                    };
                }
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "åæ­¥çæå¾çæ¶åºéï¼ä»»å¡ {TaskId}", task.Id);
                
                task.Status = ImageTaskStatus.Failed;
                task.ErrorMessage = ex.Message;
                task.UpdatedAt = DateTime.UtcNow;
                await _dbContext.SaveChangesAsync(cancellationToken);

                return new ImageGenerationResponse
                {
                    TaskId = task.Id,
                    Status = "å¤±è´¥",
                    Message = ex.Message,
                    IsAsync = false
                };
            }
        }
    }

    /// &lt;summary&gt;
    /// è·åå¾ççæä»»å¡çç¶æ
    /// &lt;/summary&gt;
    /// &lt;param name="taskId"&gt;è¦æ¥è¯¢çä»»å¡ ID&lt;/param&gt;
    /// &lt;returns&gt;ä»»å¡ç¶æåç»æï¼å¦æå·²å®æï¼&lt;/returns&gt;
    [McpServerTool(Name = "get_image_task_status")]
    [Description("è·åå¾ççæä»»å¡çç¶æ")]
    public async Task&lt;ImageGenerationResponse&gt; GetImageTaskStatus(
        [Description("è¦æ¥è¯¢çä»»å¡ ID")] string taskId,
        CancellationToken cancellationToken = default)
    {
        if (!Guid.TryParse(taskId, out var id))
        {
            return new ImageGenerationResponse
            {
                Status = "éè¯¯",
                Message = "ä»»å¡ ID æ ¼å¼æ æ"
            };
        }

        var task = await _dbContext.ImageGenerationTasks.FindAsync(new object[] { id }, cancellationToken);
        
        if (task == null)
        {
            return new ImageGenerationResponse
            {
                Status = "éè¯¯",
                Message = "æªæ¾å°ä»»å¡"
            };
        }

        return new ImageGenerationResponse
        {
            TaskId = task.Id,
            Status = task.Status.ToString().ToLowerInvariant(),
            Message = task.ErrorMessage ?? GetStatusMessage(task.Status),
            ImageBase64 = task.ImageData,
            ImageUrl = task.ImageUrl,
            IsAsync = !string.IsNullOrEmpty(task.HangfireJobId)
        };
    }

    private static string GetStatusMessage(ImageTaskStatus status)
    {
        return status switch
        {
            ImageTaskStatus.Pending =&gt; "ä»»å¡ç­å¾ä¸­",
            ImageTaskStatus.Processing =&gt; "ä»»å¡å¤çä¸­",
            ImageTaskStatus.Completed =&gt; "å¾ççææå",
            ImageTaskStatus.Failed =&gt; "å¾ççæå¤±è´¥",
            ImageTaskStatus.Cancelled =&gt; "ä»»å¡å·²åæ¶",
            _ =&gt; "æªç¥ç¶æ"
        };
    }
}

/// &lt;summary&gt;
/// å¾ççæååºæ¨¡å
/// &lt;/summary&gt;
public class ImageGenerationResponse
{
    public Guid? TaskId { get; set; }
    public required string Status { get; set; }
    public string? Message { get; set; }
    public string? ImageBase64 { get; set; }
    public string? ImageUrl { get; set; }
    public string? RevisedPrompt { get; set; }
    public bool IsAsync { get; set; }
}

</code></pre>
<p><strong>å®éé¡¹ç®ç¹ç¹</strong>ï¼</p>
<ol>
<li>
<p><strong>åæ¨¡å¼æ¯æ</strong>ï¼</p>
<ul>
<li>åæ­¥æ¨¡å¼ï¼ç«å³çæå¹¶è¿åç»æ</li>
<li>å¼æ­¥æ¨¡å¼ï¼ä½¿ç¨Hangfireåå°ä»»å¡ï¼å®æåéè¿é®ä»¶éç¥</li>
</ul>
</li>
<li>
<p><strong>å¤æ¸ éæ¨é</strong>ï¼</p>
<ul>
<li>éè¿SignalRæ¨éå°è®¾å¤ï¼CustomMessageï¼</li>
<li>éè¿é®ä»¶åéé¾æ¥</li>
</ul>
</li>
<li>
<p><strong>å¾çå­å¨</strong>ï¼</p>
<ul>
<li>åæ¶ä¿å­PNGåJPEGä¸¤ç§æ ¼å¼</li>
<li>å­å¨å°Azure Blob Storageææ¬å°æä»¶ç³»ç»</li>
</ul>
</li>
<li>
<p><strong>å®æ´çéè¯¯å¤çåæ¥å¿è®°å½</strong></p>
</li>
</ol>
<p><strong>è·åå®æ´ä»£ç </strong>ï¼</p>
<ul>
<li>
<p>ð§ ESP32è®¾å¤ç«¯ (å°æºå®æ´å®ç°):<br>
<a href="https://github.com/maker-community/xiaozhi-esp32" target="_blank" rel="noopener nofollow">https://github.com/maker-community/xiaozhi-esp32</a></p>
<ul>
<li>SignalRéæåæ¯ï¼<code>signalr</code> å <code>signalr-update-audio</code></li>
</ul>
</li>
<li>
<p>ð§ ESP32ç¤ºä¾å·¥ç¨ (åå«å®æ´çSignalRéæç¤ºä¾):<br>
<a href="https://github.com/maker-community/esp-signalr-example" target="_blank" rel="noopener nofollow">https://github.com/maker-community/esp-signalr-example</a></p>
</li>
<li>
<p>ð§ SignalR C++å®¢æ·ç«¯åº:<br>
<a href="https://github.com/maker-community/esp-signalr" target="_blank" rel="noopener nofollow">https://github.com/maker-community/esp-signalr</a><br>
<a href="https://github.com/maker-community/esp-signalr-example" target="_blank" rel="noopener nofollow">https://github.com/maker-community/esp-signalr-example</a></p>
</li>
<li>
<p>ð MCPæå¡å¨ç«¯:<br>
<a href="https://github.com/maker-community/verdure-mcp" target="_blank" rel="noopener nofollow">https://github.com/maker-community/verdure-mcp</a></p>
</li>
</ul>
<h2 id="å®éä½¿ç¨åºæ¯ç¤ºä¾">å®éä½¿ç¨åºæ¯ç¤ºä¾</h2>
<h3 id="åºæ¯1aiçå¾åæ¨éå°è®¾å¤">åºæ¯1ï¼AIçå¾åæ¨éå°è®¾å¤</h3>
<p>ç¨æ·éè¿å°æºå¯¹è¯ï¼"å¸®æçæä¸å¼ ç«åªçå¾ç"</p>
<ol>
<li>å¯¹è¯åéå°.NET MCPæå¡</li>
<li>MCPæå¡è°ç¨APIçæå¾ç</li>
<li>çæå®æåï¼åå°ä»»å¡è°ç¨hubåéæ¶æ¯</li>
<li>æå¡ç«¯éè¿SignalRæ¨éå¾çç»è¯¥ç¨æ·çææè®¾å¤</li>
<li>ESP32è®¾å¤æ¥æ¶å°<code>èªå®ä¹æ¶æ¯</code>äºä»¶ï¼ä¸è½½å¹¶æ¾ç¤ºå¨å±å¹ä¸</li>
</ol>
<h3 id="åºæ¯2æ­æ¾é³ä¹">åºæ¯2ï¼æ­æ¾é³ä¹</h3>
<p>ç¨æ·éè¿è¯­é³è¯´æ³è¦æ­æ¾é³ä¹ï¼mcpè¢«è§¦åï¼éæºéæ©é³ä¹urlæ¨éå°è®¾å¤</p>
<ol>
<li>å¯¹è¯åéå°.NET MCPæå¡</li>
<li>æå¡ç«¯éè¿SignalRæ¨éé³ä¹ç»è¯¥ç¨æ·çææè®¾å¤</li>
<li>ESP32è®¾å¤æ¥æ¶å°<code>èªå®ä¹æ¶æ¯</code>äºä»¶ï¼ä¸è½½å¹¶æ­æ¾è¯­é³</li>
</ol>
<h2 id="åå­ä¼åç»éªåäº«">åå­ä¼åç»éªåäº«</h2>
<blockquote>
<p><strong>è¯´æ</strong>ï¼æ¬ç« èåå®¹å¯¹äºå¨ESP32ä¸è¿è¡SignalRå®¢æ·ç«¯éå¸¸éè¦ï¼è¿äºé½æ¯å®è·µä¸­æ»ç»åºçç»éªã</p>
</blockquote>
<p>å¨ESP32ä¸éæSignalRç¡®å®éå°äºåå­é®é¢ï¼åäº«ä¸äºä¼åç»éªï¼</p>
<h3 id="1-ä½¿ç¨psramå­å¨å¤§å¯¹è±¡">1. ä½¿ç¨PSRAMå­å¨å¤§å¯¹è±¡</h3>
<pre><code class="language-cpp">// ä¸ºå¾çæ°æ®åéPSRAMåå­
void* imageBuffer = heap_caps_malloc(imageSize, MALLOC_CAP_SPIRAM);
if (imageBuffer == NULL) {
    // éçº§å°åé¨RAM
    imageBuffer = malloc(imageSize);
}
</code></pre>
<p>å¨VS Codeçmenuconfigä¸­å¯ç¨PSRAMï¼</p>
<ul>
<li><code>F1</code> â <code>ESP-IDF: SDK Configuration editor</code></li>
<li><code>Component config</code> â <code>ESP32-specific</code> â <code>Support for external, SPI-connected RAM</code></li>
</ul>
<h3 id="2-åå°jsonåºååæ¬¡æ°">2. åå°JSONåºååæ¬¡æ°</h3>
<pre><code class="language-cpp">// éè¯¯åæ³ï¼é¢ç¹åå»º/éæ¯cJSONå¯¹è±¡
for (int i = 0; i &lt; 100; i++) {
    cJSON* root = cJSON_Parse(jsonString);
    // å¤ç...
    cJSON_Delete(root);  // äº§çåå­ç¢ç
}

// æ­£ç¡®åæ³ï¼å¤ç¨å¯¹è±¡
cJSON* root = cJSON_Parse(jsonString);
for (int i = 0; i &lt; 100; i++) {
    // å¤ç...
}
cJSON_Delete(root);
</code></pre>
<h3 id="3-å¢å ä»»å¡æ å¤§å°">3. å¢å ä»»å¡æ å¤§å°</h3>
<p>SignalRçåè°åµå¥è¾æ·±ï¼éè¦å¢å æ ï¼</p>
<p>å¨menuconfigä¸­ï¼<code>Component config</code> â <code>ESP32-specific</code> â <code>Main task stack size</code> â è®¾ç½®ä¸º<code>8192</code></p>
<p>æå¨ä»£ç ä¸­ï¼</p>
<pre><code class="language-cpp">xTaskCreatePinnedToCore(
    signalr_task,
    "signalr",
    8192,  // æ å¤§å°ï¼å­èï¼
    NULL,
    5,     // ä¼åçº§
    NULL,
    1      // CPUæ ¸å¿
);
</code></pre>
<h2 id="æ»ç»ä¸ææ">æ»ç»ä¸ææ</h2>
<p>éè¿è¿æ¬¡SignalRç§»æ¤åéæçå®è·µï¼ææ·±å»ä½ä¼å°ï¼</p>
<ol>
<li>
<p><strong>éå¯¹æ¡æ¶å¾éè¦</strong>ï¼SignalRçç¾¤ç»ç®¡çãæ¶æ¯è·¯ç±ç­ç¹æ§ï¼çå»äºå¤§éåºç¡è®¾æ½ä»£ç ãå¦æä»å¤´æåWebSocketï¼è¿äºåè½å¾è±å å¨æ¶é´ã</p>
</li>
<li>
<p><strong>åå­ç®¡çæ¯åµå¥å¼æ°¸æçä¸»é¢</strong>ï¼ESP32çRAMéå¶è®©æå¯¹æ¯ä¸ä¸ªmallocé½æ ¼å¤å°å¿ãåçä½¿ç¨PSRAMãé¿ååå­ç¢çãåæ¶éæ¾èµæºï¼è¿äºå¨PCä¸ä¸ç¨careçé®é¢ï¼å¨åµå¥å¼ä¸é½æ¯åã</p>
</li>
<li>
<p><strong>AIè¾å©ç¼ç¨çé¦</strong>ï¼è¿æ¬¡é¡¹ç®ä¸­ï¼SignalR C++å®¢æ·ç«¯çç§»æ¤ãæ¶æ¯å¤çç­å¤§éä»£ç é½æ¯åå©AIçæçãè½ç¶çæçä»£ç éè¦è°è¯åä¼åï¼ä½ç¡®å®å¤§å¹æé«äºå¼åæçã</p>
</li>
<li>
<p><strong>æ¶æ¯æ¨éè§£å³å®éé®é¢</strong>ï¼ä¹åMCPå·¥å·åªè½åæ­¥è¿åç»æï¼ç°å¨éè¿SignalRï¼æå¡ç«¯å¯ä»¥ä¸»å¨æ¨éå¾çãè¯­é³ãéç¥ç»è®¾å¤ï¼ç¨æ·ä½éªæåææ¾ã</p>
</li>
<li>
<p><strong>.NETçæçå¼ºå¤§</strong>ï¼SignalRãEF CoreãJWTè®¤è¯â¦â¦å¾®è½¯è¿å¥çæççå¾å®åãä½ä¸º.NETå¼åèï¼è½ç¨çæçææ¯æ å¿«éæ­å»ºçäº§çº§æå¡ã</p>
</li>
</ol>
<p>è¿ä¸ªé¡¹ç®è¿æå¾å¤ä¼åç©ºé´ï¼æ¯å¦ï¼</p>
<ul>
<li>WebSocket Binary Protocolæ¿ä»£JSONåå°å¸¦å®½</li>
<li>å¼å¥Rediså­å¨ç¾¤ç»ä¿¡æ¯ï¼æ¯ææå¡ç«¯æ¨ªåæ©å±</li>
<li>ç»§ç»­å®åä»£ç è´¨éï¼è®©åºè½å¤è¢«æ´å¤çäººå³æ³¨ååä¸ï¼å¸æææ´å¤çäººæ¥å®éä½¿ç¨åä¼åã</li>
</ul>
<p>ä½ä½ä¸ºä¸ä¸ªåæ­¥è½ç¨çæ¹æ¡ï¼å·²ç»è¶³å¤æ¯æå°æºæºå¨äººçåè½æ©å±äºãåç»­æä¼ç»§ç»­å®åè¿å¥æ¶æï¼æ¬¢è¿å¤§å®¶ä¸èµ·æ¢è®¨åè´¡ç®ä»£ç ï¼</p>
<p>å¸æè¿ç¯æç« è½ç»å¤§å®¶å¨.NET IoTå¼åãSignalRå®æ¶éä¿¡æ¹é¢å¸¦æ¥ä¸äºå¯åãå¦ææé®é¢æ¬¢è¿å¨è¯è®ºåºè®¨è®ºï¼è®©æä»¬ä¸èµ·æ¢ç´¢.NETå¨IoTé¢åçæ´å¤å¯è½æ§ï¼</p>
<h2 id="ææesp32å°æºå¨äºº">ææESP32å°æºå¨äºº</h2>
<p>å¦æä½ æææEsp32çç¡¬ä»¶æç®ï¼å¯ä»¥å³æ³¨æçBç«è´¦å·ï¼ç»¿è«é¿å¹¿ï¼<br>
<a href="https://space.bilibili.com/25228512" target="_blank" rel="noopener nofollow">https://space.bilibili.com/25228512</a></p>
<p><img src="https://img2024.cnblogs.com/blog/1690009/202602/1690009-20260201141614219-406532144.png" alt="img" loading="lazy"></p>
<h2 id="é¡¹ç®å°å">é¡¹ç®å°å</h2>
<h3 id="esp32ç¸å³-1">ESP32ç¸å³</h3>
<ul>
<li>
<p><strong>SignalR C++å®¢æ·ç«¯åº</strong>ï¼<br>
<a href="https://github.com/maker-community/esp-signalr" target="_blank" rel="noopener nofollow">https://github.com/maker-community/esp-signalr</a></p>
</li>
<li>
<p><strong>å°æºESP32å®æ´å®ç°</strong> (signalr-update-audioåæ¯):<br>
<a href="https://github.com/maker-community/xiaozhi-esp32" target="_blank" rel="noopener nofollow">https://github.com/maker-community/xiaozhi-esp32</a></p>
</li>
<li>
<p><strong>ESP32 SignalRå®æ´ç¤ºä¾å·¥ç¨</strong> (åå«é³é¢ååãè®¾å¤æ§å¶APIç­):<br>
<a href="https://github.com/maker-community/esp-signalr-example" target="_blank" rel="noopener nofollow">https://github.com/maker-community/esp-signalr-example</a></p>
<ul>
<li><a href="https://github.com/maker-community/esp-signalr-example/tree/main/signalr-server" target="_blank" rel="noopener nofollow">æå¡ç«¯ä»£ç </a></li>
<li><a href="https://github.com/maker-community/esp-signalr-example/tree/main/main" target="_blank" rel="noopener nofollow">å®¢æ·ç«¯ä»£ç </a></li>
</ul>
</li>
</ul>
<h3 id="netæå¡ç«¯">.NETæå¡ç«¯</h3>
<ul>
<li><strong>Verdure MCPæå¡</strong> (åå«å®æ´çHubãToolsãServiceså®ç°):<br>
<a href="https://github.com/maker-community/verdure-mcp" target="_blank" rel="noopener nofollow">https://github.com/maker-community/verdure-mcp</a></li>
<li><strong>å°æºmcpè½¬æ¥å¹³å°</strong>ï¼</li>
<li><a href="https://github.com/maker-community/verdure-mcp-for-xiaozhi" target="_blank" rel="noopener nofollow">https://github.com/maker-community/verdure-mcp-for-xiaozhi</a></li>
</ul>
<h3 id="åèèµæ">åèèµæ</h3>
<ul>
<li><strong>SignalR Client C++ (å¾®è½¯å®æ¹)</strong>:<br>
<a href="https://github.com/aspnet/SignalR-Client-Cpp" target="_blank" rel="noopener nofollow">https://github.com/aspnet/SignalR-Client-Cpp</a></li>
<li><strong>SignalR Client C# nanoframework</strong>:<br>
<a href="https://github.com/nanoframework/nanoFramework.SignalR.Client" target="_blank" rel="noopener nofollow">https://github.com/nanoframework/nanoFramework.SignalR.Client</a></li>
</ul>
<h2 id="åèææ¡£">åèææ¡£</h2>
<ol>
<li><a href="https://docs.microsoft.com/zh-cn/aspnet/core/signalr/" target="_blank" rel="noopener nofollow">ASP.NET Core SignalR å®æ¹ææ¡£</a></li>
<li><a href="https://github.com/dotnet/aspnetcore/blob/main/src/SignalR/docs/specs/HubProtocol.md" target="_blank" rel="noopener nofollow">SignalR Hub åè®®è§è</a></li>
<li><a href="https://docs.espressif.com/projects/esp-idf/zh_CN/latest/esp32/" target="_blank" rel="noopener nofollow">ESP-IDF ç¼ç¨æå</a></li>
<li><a href="https://github.com/espressif/vscode-esp-idf-extension" target="_blank" rel="noopener nofollow">VS Code ESP-IDF æä»¶</a></li>
<li><a href="https://jwt.io/introduction" target="_blank" rel="noopener nofollow">JWT è®¤è¯æä½³å®è·µ</a></li>
<li><a href="https://www.keycloak.org/docs/latest/securing_apps/" target="_blank" rel="noopener nofollow">Keycloak è®¤è¯éææå</a></li>
</ol>
<hr>
<p><em>æ¬æé¦åäºä¸ªäººææ¯åå®¢ï¼è½¬è½½è¯·æ³¨æåºå¤ãå¦æå¯¹.NET IoTå¼åãSignalRå®æ¶éä¿¡æå´è¶£ï¼æ¬¢è¿å³æ³¨æçåå®¢è·åæ´å¤ææ¯åäº«ï¼</em></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-01 15:34">2026-02-01 15:33</span>&nbsp;
<a href="https://www.cnblogs.com/GreenShade">ç»¿è«é¿å¹¿</a>&nbsp;
éè¯»(<span id="post_view_count">81</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19560338);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19560338', targetLink: 'https://www.cnblogs.com/GreenShade/p/19560338', title: 'å°SignalRç§»æ¤å°Esp32âè®©å°æºè®¾å¤æ ç¼è¿æ¥.NETåè½æå±MCPæå¡' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ LLVM Passå¿«éå¥é¨(ä¸)ï¼æå»ºç¼è¯ç¯å¢ ]]></title>
    <link>https://www.cnblogs.com/ClownLMe/p/19560726</link>
    <guid>65616c132f77287edc5dc9311964ff0d</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ClownLMe/p/19560726" title="åå¸äº 2026-02-01 14:36">
    <span role="heading" aria-level="2">LLVM Passå¿«éå¥é¨(ä¸)ï¼æå»ºç¼è¯ç¯å¢</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ç®ä»">ç®ä»</h1>
<p><strong>LLVM</strong> æ¯ä¸ä¸ªç¼è¯æ¡æ¶å·¥å·ï¼æ¯æç¼è¯è¿ç¨æè§£æäºé«åº¦æ ååçç»ä»¶ã</p>
<p><mark><strong>æ¬æç¨æä½¿ç¨çç¯å¢æ¯windows11, vs2022</strong></mark></p>
<h1 id="è®¤è¯llvm">è®¤è¯LLVM</h1>
<p>LLVM ææåçå°æ¹å¨äºå®å®ä¹äºä¸ç§æå¶å®ç¾çä¸­é´è¯­è¨<strong>LLVM IR</strong>ï¼LLVMåä¸ºåç«¯ï¼ä¼åå¨ï¼åç«¯ï¼</p>
<ul>
<li><strong>åç«¯</strong>ï¼è´è´£ææºä»£ç ï¼C/C++ãRustãGoï¼ç¿»è¯æ LLVM IRãæ¯å¦ <code>Clang</code>ã</li>
<li><strong>ä¼åå¨</strong>ï¼è¿æ¯ LLVM ççµé­ãå®åªå¤ç IRï¼ä¸å³å¿æºç æ¯ä»ä¹è¯­è¨ï¼ä¹ä¸å³å¿ç®æ æ¯ä»ä¹æºå¨ãä½ åç <strong>Pass</strong> å°±è¿è¡å¨è¿éã</li>
<li><strong>åç«¯</strong>ï¼è´è´£æä¼ååç IR ç¿»è¯æå·ä½çæºå¨ç ï¼x86ãARMãRISC-Vï¼ãæ¯å¦ <code>LLC</code>ã</li>
</ul>
<p>LLVMçä¸ç«¯æ¶æï¼æä»¬è½å¤å¾æ¹ä¾¿çèªå®ä¹ç¼è¯å¨ï¼<mark><strong>æ¬ç³»ç±»æç¨ä¸»è¦æå­¦ä¼åå¨çpassç¼å</strong></mark></p>
<h1 id="ç¯å¢éç½®">ç¯å¢éç½®</h1>
<h3 id="éè¦åå¤çå·¥å·">éè¦åå¤çå·¥å·</h3>
<ol>
<li><strong>git</strong> : <a href="https://git-scm.com/install/" target="_blank" rel="noopener nofollow">https://git-scm.com/install/</a> æåé¡¹ç®</li>
<li><strong>visual studio</strong> : <a href="https://visualstudio.microsoft.com/zh-hans/" target="_blank" rel="noopener nofollow">https://visualstudio.microsoft.com/zh-hans/</a> éè¦å®è£<code>c/c++æ¡é¢å¼å</code>ç»ä»¶ï¼ç¼è¯ç¯å¢</li>
<li><strong>cmake</strong>ï¼ <a href="https://cmake.org/" target="_blank" rel="noopener nofollow">https://cmake.org/</a> æå»ºé¡¹ç®</li>
<li><strong>ninja</strong> : <a href="https://github.com/ninja-build/ninja" target="_blank" rel="noopener nofollow">https://github.com/ninja-build/ninja</a> å éç¼è¯</li>
</ol>
<h3 id="æållvmå¹¶éç½®">æåLLVMå¹¶éç½®</h3>
<p>è¿éæä¿å­å¨Dç</p>
<pre><code class="language-bash">#åå»ºæä»¶å¤¹
mkdir D:\LLVM 
cd D:\LLVM 
#æåæºç  (åªæåæ ¸å¿ä»åºï¼ä¸éè¦ submoduleï¼ç°å¨ LLVM æ¯ monorepo) 
#è¿ä¸æ­¥æ¯è¾å¤§ï¼ç½ç»ä¸å¥½è¯·ææ¢¯å­ 
git clone --depth=1 https://github.com/llvm/llvm-project.git
#åå»ºæå»ºç®å½
cd llvm-project 
mkdir build 
cd build
</code></pre>
<h3 id="æå»ºå¹¶ç¼è¯">æå»ºå¹¶ç¼è¯</h3>
<p><strong>è¿ééè¦æå¼ååä¸è½½å¥½<code>visual studio</code>çå·¥ä½å°ï¼æè¿éæ¯<code>x64 Native Tools Command Prompt for VS 2022</code></strong><br>
<mark><strong>æ³¨æï¼å¼å§ç¼è¯éè¦é¢ç30-60Gç¡¬çç©ºé´ï¼ç¼è¯éè¦30åéå·¦å³</strong></mark></p>
<pre><code class="language-bash">#å©ç¨cmakeæå»ºé¡¹ç®
cmake -G "Ninja" ^ #ä½¿ç¨ninjaç¼è¯
-DLLVM_ENABLE_PROJECTS="clang" ^ #åªç¼è¯clangèçç©ºé´
-DLLVM_TARGETS_TO_BUILD="X86" ^ #åªç¼è¯x86åç«¯ï¼è¿èçå¤§é¨åç¼è¯æ¶é´ï¼é¤éè¦æarmæèå®å
-DCMAKE_BUILD_TYPE="RelWithDebInfo" ^ #Relaseçæ¬æ æ³è°è¯ï¼debugçæ¬å¤ªå¤§å¤ªæ¢äºï¼è¿ééæ©å¸¦è°è¯ç¬¦å·çrelaseçæ¬
-DLLVM_OPTIMIZED_TABLEGEN=ON ^ 
-DLLVM_ENABLE_ASSERTIONS=ON ^ #å¼å¯ä»£ç æ­è¨ãå½passåéæ¶ï¼ä¼æ¥éèä¸æ¯ç´æ¥å´©æº
../llvm
#ç¼è¯
ninja
</code></pre>
<h3 id="æ·»å ç¯å¢åé">æ·»å ç¯å¢åé</h3>
<p>è¿ä¸æ­¥æ¹ä¾¿ä¹åçä½¿ç¨</p>
<pre><code class="language-bash">#å°ååç¼è¯å¥½çç¯å¢å å¥ç¯å¢åé
D:\LLVM\llvm-project\build\bin
</code></pre>
<h3 id="ç®åéªè¯ç¯å¢">ç®åéªè¯ç¯å¢</h3>
<pre><code class="language-bash">clang --version
opt --version
</code></pre>
<p>ä¸è¬æ¥è¯´ï¼è·çä¸é¢æ­¥éª¤èµ° å¹¶ä¸ ç³»ç»åvsçæ¬ä¸æ ·å°è¿æ¯ä¸ä¼æ¥éçã</p>
<h1 id="éªè¯ç¯å¢">éªè¯ç¯å¢</h1>
<p>ä¸é¢ç¼è¯ä¸ä¸ª<code>test.c</code>æ¥éªè¯ç¯å¢æ¯å¦æ­£å¸¸ã</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

int add(int a, int b) {
&nbsp; &nbsp; return a + b + 5;
}

int main(){
&nbsp; &nbsp; printf("add(1, 2) = %d\n", add(1, 2));
&nbsp; &nbsp; return 0;
}
</code></pre>
<h3 id="ç¼è¯ä»£ç ">ç¼è¯ä»£ç </h3>
<h5 id="c-ç¼è¯ä¸ºllvm-ir">C ç¼è¯ä¸ºLLVM IR</h5>
<pre><code class="language-bash">clang -S -emit-llvm -O0 test.c -o test.ll
</code></pre>
<p>è§å¯IRï¼</p>
<pre><code class="language-c">......
define dso_local i32 @main() #0 {
entry:
&nbsp; %retval = alloca i32, align 4
&nbsp; store i32 0, ptr %retval, align 4
&nbsp; %call = call i32 @add(i32 noundef 1, i32 noundef 2)
&nbsp; %call1 = call i32 (ptr, ...) @printf(ptr noundef @"??_C@_0BA@OMPDDIF@add?$CI1?0?52?$CJ?5?$DN?5?$CFd?6?$AA@", i32 noundef %call)
&nbsp; ret i32 0
}
......
</code></pre>
<h5 id="llvm-ir-ç¼è¯ä¸ºå¯æ§è¡æä»¶">LLVM IR ç¼è¯ä¸ºå¯æ§è¡æä»¶</h5>
<p>ç¼è¯ä¸ºå¯æ§è¡æä»¶å¹¶æ­£å¸¸è¿è¡</p>
<pre><code class="language-bash">clang test.c -o test.exe
</code></pre>
<p><strong>å¦æâ¤åæ¬¢â¤æ¬ç³»åæç¨ï¼å°±ç¹ä¸ªå³æ³¨å§ï¼åç»­ä¸å®ææ´æ°~</strong></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-01 14:36">2026-02-01 14:36</span>&nbsp;
<a href="https://www.cnblogs.com/ClownLMe">ClownLMe</a>&nbsp;
éè¯»(<span id="post_view_count">35</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19560726);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19560726', targetLink: 'https://www.cnblogs.com/ClownLMe/p/19560726', title: 'LLVM Passå¿«éå¥é¨(ä¸)ï¼æå»ºç¼è¯ç¯å¢' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ nginx locationæ²¡å­¦å¥½ï¼æèªå·±åäºä¸æ ]]></title>
    <link>https://www.cnblogs.com/grey-wolf/p/19560342</link>
    <guid>cda2f02dd365364f323d3f7274b8c0fd</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/grey-wolf/p/19560342" title="åå¸äº 2026-02-01 11:28">
    <span role="heading" aria-level="2">nginx locationæ²¡å­¦å¥½ï¼æèªå·±åäºä¸æ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="èæ¯">èæ¯</h1>
<p>åå å¤©å¨é¨ç½²ä¸å¥ç¯å¢çæ¶åï¼æ¶ånginxè¿åï¼å½æ¶ä»¥ä¸ºååéæå®ï¼æ²¡ç¸å¯¹è¿è´¹äºå¥½äºåå¤«ï¼çè³ä»¥ä¸ºæ¯nginxçbugäºã</p>
<p>æåä¸ä¸ªå¾ï¼</p>
<p>æä»¬æä¸ªæ ¡ä¼åä½çé¡¹ç®ï¼ç±äºé¡¹ç®çåä¸æ¹æ¶åå­¦æ ¡å­¦çï¼ç½ç»å æ­¤æ¯åç¬åäºä¸ä¸ªåºåï¼å°±ç¸å½äºä¸ä¸ªç¬ç«ç½æ®µï¼éé¢æå­¦çåå¬pcãlinuxæå¡å¨ç­ç­ãæä»¬è¿æ¬¡ç»éå¼åäºä¸ä¸ªå°çååç«¯åç¦»é¡¹ç®ï¼å¼åå®äºåï¼æå°±åå¤é¨ç½²ã</p>
<p>é¨ç½²çè¯ï¼ææ¯éè¿ç±»ä¼¼äºwindowsè¿ç¨æ¡é¢çæºå¶ï¼å®éæ¯æååçVDIï¼ç¸æ¯äºwindowsè¿ç¨æ¡é¢ï¼åºè¯¥æ¯å¤äºæ´å¤æä»¶è¿åºçç®¡æ§æºå¶ï¼æ¯å¦æ²¡æéçè¯ï¼è¿ç¨ä¸»æºéçæä»¶é»è®¤æ¯æ·è´ä¸åºæ¥çï¼ã</p>
<p>éè¿è¿ç¨æ¡é¢è¿å¥è¿ç¨windowsåï¼å¨éé¢åsshè¿æ¥linuxæå¡å¨ï¼å¨ä¸é¢é¨ç½²nginxãåç«¯åï¼ç±äºæå¡å¨æéï¼ç´æ¥æåç«¯spring bootåä¹æ¯é¨ç½²å¨äºè¿ä¸å°æºå¨ä¸ï¼æ¶æå¦ä¸ã</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260201104040556.png" alt="image-20260201104040556" loading="lazy"></p>
<p>åå¼å§é¨ç½²å®æåï¼åºç¨æå¡å¨ä¸ï¼åè®¾ipä¸º1.1.1.1ï¼çnginxï¼çå¬80ç«¯å£ï¼é£ä¹ï¼å¨è¿ç¨windowsä¸çæµè§å¨ï¼æ¯å¯ä»¥è®¿é®ï¼http://1.1.1.1:80æ¥æå¼ç³»ç»çï¼ä½æ¯ï¼å¨æçåå¬pcä¸ä¸è¡ã</p>
<p>ç±äºè¿ç§ä¸è¬æ¯éè¦ç»é¢å¯¼æ¼ç¤ºçï¼é£èªç¶è¦æ1.1.1.1:80ç«¯å£æ´é²åºæ¥ï¼è®©åå¬pcç½ç»å¯ä»¥è®¿é®ãä¸ºäºå®å¨èµ·è§ï¼è¿ç§ä¸è¬åªå¼æ¾å¿è¦çç«¯å£ï¼å¦ä¸é¢å°±åªå¼æ¾80ç«¯å£ãå°±åæä»¬å¹³æ¶ç³»ç»å¯¹äºèç½ä»å¼æ¾443ç«¯å£ä¸æ ·ã</p>
<h1 id="é®é¢">é®é¢</h1>
<p>ç±äºçæ¬åå¼å§ä¸ç¨³å®ï¼èªç¶æ¯ä¼åç°ä¸äºbugï¼åç°bugå°±éè¦çæ¥å¿ï¼æä»¬è¿è¾¹çæ¥å¿è¿æ¯æ¯è¾åå§çï¼ä¹æ²¡æä»ä¹elkè¿ç±»ãspring bootæå¡çæ¥å¿ï¼å°±å¨ä¸è¿°ç1.1.1.1è¿å°æå¡å¨çç¹å®ç®å½ä¸ï¼æå°±æ³çï¼éè¿80ç«¯å£ï¼nginxéé¢åéä¸ªlocationï¼ælogæ´é²åºæ¥ï¼æ¹ä¾¿ç»ååäºçæ¥å¿ï¼åºè¯¥æ´æ¹ä¾¿ä¸äºã</p>
<p>åå§çnginxéç½®å¦ä¸ï¼å°±ä¸ä¸ªååç«¯åç¦»çéç½®ï¼</p>
<pre><code class="language-shell">server {
    listen 80;
    server_name localhost;
    location / {
        root /usr/local/nginx/html/quantify-trade-platform-frontend/dist;
        index index.html  index.htm;
        try_files $uri $uri/ /index.html;
    }
    location ~ /quantify-trade-platform-admin {
        proxy_pass http://localhost:8093;
   }
}
</code></pre>
<p>æä»¬javaæå¡å¢ï¼æ¥å¿æ¯å¨:</p>
<p>/opt/quantify-trade-platform-admin/quantify-trade-platform-admin-0.1-SNAPSHOT/logs</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260201105400498.png" alt="image-20260201105400498" loading="lazy"></p>
<p>æä»¥ï¼æå°±å äºä¸æ®µéç½®ï¼</p>
<pre><code class="language-shell">    location /mylog/ {
      alias /opt/quantify-trade-platform-admin/quantify-trade-platform-admin-0.1-SNAPSHOT/logs/;
      autoindex on;
    }
</code></pre>
<p>å®æ´å¦ä¸ï¼</p>
<pre><code class="language-shell">    server {
        listen 80;
        server_name localhost;
        location / {
            root /usr/local/nginx/html/quantify-trade-platform-frontend/dist;
            index index.html  index.htm;
            try_files $uri $uri/ /index.html;
        }
        location ~ /quantify-trade-platform-admin {
            proxy_pass http://localhost:8093;
        }
		-- æ°å¢å¦ä¸:
	    location /mylog/ {
	      alias /opt/quantify-trade-platform-admin/quantify-trade-platform-admin-0.1-SNAPSHOT/logs/;
          autoindex on;
        }
   }
</code></pre>
<p>å å¥½åï¼æè¯äºä¸, <a href="http://1.1.1.1/mylog/%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%AD%A3%E5%B8%B8%E8%AE%BF%E9%97%AE%EF%BC%9A%EF%BC%88%E5%AE%9E%E9%99%85%E4%B8%8A%EF%BC%8C%E6%8A%98%E8%85%BE%E8%BF%99%E4%B8%AAautoindex%E8%BF%99%E4%B8%AAlocation%EF%BC%8C%E4%B9%9F%E8%8A%B1%E4%BA%86%E4%B8%8D%E5%B0%91%E6%97%B6%E9%97%B4%EF%BC%8C%E8%A6%81%E4%B8%8D%E8%A6%81%E5%8A%A0/%E4%B9%8B%E7%B1%BB%E7%9A%84%EF%BC%89" target="_blank" rel="noopener nofollow">http://1.1.1.1/mylog/ï¼å¯ä»¥æ­£å¸¸è®¿é®ï¼ï¼å®éä¸ï¼æè¾è¿ä¸ªautoindexè¿ä¸ªlocationï¼ä¹è±äºä¸å°æ¶é´ï¼è¦ä¸è¦å /ä¹ç±»çï¼</a></p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260201105622188.png" alt="image-20260201105622188" loading="lazy"></p>
<p>ä½æ¯å¢ï¼æå¨ç¹å»éé¢çæä»¶çæ¶åï¼åç°æ¥404ï¼</p>
<p><a href="http://1.1.1.1/mylog/quantify-trade-platform-admin.log" target="_blank" rel="noopener nofollow">http://1.1.1.1/mylog/quantify-trade-platform-admin.log</a></p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260201105804252.png" alt="image-20260201105804252" loading="lazy"></p>
<p>è¿ä¸ªé®é¢æææè¾çå¤åï¼æä¸ç´ä»¥ä¸ºæ¯æautoindexè¿åï¼æ¯ä¸æ¯åªééç½®æ²¡å¯¹ï¼å°±è¿ä¸ªå°æ¹ï¼åå¤æè¾ï¼åå¤æè¾ï¼</p>
<pre><code class="language-shell">location /mylog/ {
  alias /opt/quantify-trade-platform-admin/quantify-trade-platform-admin-0.1-SNAPSHOT/logs/;
  autoindex on;
}
</code></pre>
<p>å¿«ä¸ç­çæ¶åï¼æåç°å¦æææadminæ¹æaminãadinï¼å°±æ¼éä¸ä¸¤ä¸ªå­æ¯ï¼å°±è½ä¸è½½ä¸æ¥äºãå½æ¶ä»¥ä¸ºï¼æ¯autoindexè¿ç§éææä»¶æºå¶ï¼ä¼ä¸ä¼æ¯ä¸ºäºå®å¨èèï¼æä»¶åå¹éå°adminè¿ä¸ªå³é®å­å¥çï¼å°±404.</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260201110908710.png" alt="image-20260201110908710" loading="lazy"></p>
<p>ä½åé¢ï¼æælogæ·è´ä¸ä¸ï¼å»æä¸­é´çä¸­åçº¿ï¼ä¹å¯ä»¥ä¸è½½ä¸æ¥ï¼</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260201110108269.png" alt="image-20260201110108269" loading="lazy"></p>
<p>ç¶åç½ä¸ä¸é¡¿ä¹±æï¼ççæ¯ä¸æ¯ä¸­åçº¿å¯¼è´çé®é¢å¥çï¼æèæ¯å ä¸ºå«æadminå³é®å­å¯¼è´çï¼ç»æé½æ²¡æ¥å°æäººéå°è¿ç§é®é¢ã</p>
<p>ä¸é¡¿æç´¢çå¦èï¼ä»¥ä¸ºæ¯nginxçä»ä¹å°bugï¼å½æ¶æè§autoindexè¿ç§éææä»¶æºå¶ï¼å¯è½ç¨çäººå°ï¼æ¯ä¸æ¯æå¥å°bugæ­£å¥½è¢«ææè§äºï¼</p>
<h1 id="æ¬¡æ¥ææ¥">æ¬¡æ¥ææ¥</h1>
<p>ç¬¬äºå¤©æ©ä¸æ¥äºåï¼æ¾äºå°æå¡å¨ï¼æ°æ­å»ºï¼ç»æåç°admin.txtå¯ä»¥æ­£å¸¸ä¸è½½ï¼ä¸ºå¥å¨é£å°æºå¨ä¸å°±ä¸è¡å¢ï¼</p>
<p>ææ³èµ·æ¥straceå½ä»¤ï¼é£å°±ççææ²¡æçº¿ç´¢å§ï¼</p>
<pre><code class="language-shell">strace -p 121920 -s 1000  -t -e trace=network,file,desc,process
</code></pre>
<p>ç»æè¯·æ±http://1.1.1.1/mylog/quantify-trade-platform-admin.log æ¶ï¼åç°ä¿¡æ¯æ¾ç¤ºåºï¼åèµ·äºsocketæä½ï¼è¯·æ±äºspringbootæå¡çç«¯å£ã</p>
<p>å½æ¶å¾å¥æªï¼ç¬¬ä¸æ¬¡è¿æ²¡æ¾å°å¿ä¸ï¼ç¶åå¤æµäºä¸éï¼åç°è¿æ¯è¿æ ·ãç¶åå°±åtcpdumpæäºä¸ªåï¼å¦ï¼è¿ä¸ªæ¥å¿æä»¶çè¯·æ±æä¹è¢«åå°åç«¯æå¡å»äºã</p>
<p>ç¶ååä¸çlocationï¼</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260201111403498.png" alt="image-20260201111403498" loading="lazy"></p>
<p>è¡å§ï¼ä¸çè¯å®æ¯locationä¸­çé£ä¸ª<sub>çé®é¢äºï¼ç±äºæ¥å¿æä»¶ååæä»¬åç«¯æ¥å£çåç¼æ¯ä¸æ ·çï¼æä»¥å¹éå°äºä¸å¾çé£ä¸ªlocationï¼ç¶å</sub>åæ¯æ­£åå¹éï¼è¿åè¿å ä¸ªç¬¦å·ä¸ç´è®°ä¸æ¸æ¥ï¼è¿ä¸æèªå·±åäºï¼</p>
<h1 id="è§£å³æ¹æ³å¦ä½ç¥éurlå¹éä¸äºåªä¸ªlocation">è§£å³æ¹æ³ï¼å¦ä½ç¥éurlå¹éä¸äºåªä¸ªlocation</h1>
<p>åè¿ç¯æç« æ¶ï¼ç½ä¸æç´¢äºä¸ï¼åç°æè¿ä¹ä¸ä¸ªæå·§ï¼</p>
<p><a href="https://stackoverflow.com/questions/12703702/nginx-test-which-location-used-to-process-request#:~:text=If%20you%20just%20want%20to,3%20Comments" target="_blank" rel="noopener nofollow">https://stackoverflow.com/questions/12703702/nginx-test-which-location-used-to-process-request#:~:text=If you just want to,3 Comments</a></p>
<p><a href="https://stackoverflow.com/questions/12703702/nginx-test-which-location-used-to-process-request" target="_blank" rel="noopener nofollow">https://stackoverflow.com/questions/12703702/nginx-test-which-location-used-to-process-request</a></p>
<p>å°±æ¯å¨æ¯ä¸ªlocationä¸­å ä¸ä¸ªè¯­å¥ï¼å¨è¿åçhttp headerä¸­å ä¸ä¸ªï¼</p>
<pre><code class="language-shell">add_header location 1 always;
</code></pre>
<p>æ³¨æï¼è¿éè¦å alwaysï¼ä¸ç¶åæè¿ç§404æåµä¸ï¼ä¸å alwaysæ¯ä¸ä¼æè¿ä¸ªheaderçã</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260201111900000.png" alt="image-20260201111900000" loading="lazy"></p>
<p>å äºalwaysï¼æä¼åä¸é¢è¿æ ·ï¼</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260201112049861.png" alt="image-20260201112049861" loading="lazy"></p>
<p>å¦å¤ï¼ç±äºlocationæ¯ä¸ä¸ªhttpè§èä¸­é¢å®ä¹çheaderï¼å403éå®åéåä½¿ç¨ï¼æä»¬å¯ä»¥æ¢ä¸ªåå­ï¼</p>
<pre><code class="language-shell">    add_header mylocation 2 always;
</code></pre>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260201112228298.png" alt="image-20260201112228298" loading="lazy"></p>
<h1 id="å¢å æ¥å¿">å¢å æ¥å¿</h1>
<p>å¦å¤ä¸ä¸ªæ¹å¼ï¼å°±æ¯ææ¥å¿å¤æä¸ç¹ï¼æè¯è¿ä¸¤ç§ï¼</p>
<h2 id="error_log">error_log</h2>
<pre><code class="language-shell">error_log  logs/my_error.log  info;
</code></pre>
<p><a href="https://nginx.org/en/docs/ngx_core_module.html#error_log" target="_blank" rel="noopener nofollow">https://nginx.org/en/docs/ngx_core_module.html#error_log</a></p>
<p>vim /usr/local/nginx/logs/my_error.log</p>
<p>ä½åç°æ²¡å¥ç¨ï¼è¿æ¯æ²¡æè¯¦ç»æ¥å¿ã</p>
<h2 id="access-log">access log</h2>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260201112452079.png" alt="image-20260201112452079" loading="lazy"></p>
<pre><code class="language-shell">    log_format upstream_time '$remote_addr - $remote_user [$time_local] '
                             '"$request" $status $body_bytes_sent '
                             '"$http_referer" "$http_user_agent"'
                             'rt="$request_time" $upstream_addr uct="$upstream_connect_time" uht="$upstream_header_time" urt="$upstream_response_time"';

    server {
        listen       80;
        server_name  localhost;


        access_log  logs/my.access.log  upstream_time;
</code></pre>
<p>éè¿ä¸é¢è¿ç±»æ¥å¿ï¼ä¹è½å¸®æä»¬çå°ï¼å°åºèµ°å°äºåªä¸ªlocationï¼ååä»£çå°äºåªå°åç«¯æå¡å¨ã</p>
<h2 id="debug-log">debug log</h2>
<p><a href="https://nginx.org/en/docs/debugging_log.html" target="_blank" rel="noopener nofollow">https://nginx.org/en/docs/debugging_log.html</a></p>
<p>è¿ä¸ªè¦å¨ç¼è¯æ¶æå¼ï¼</p>
<pre><code class="language-shell">./configure --with-debug ...
</code></pre>
<p>è¿ä¸ªæå°±æ²¡è¯äºï¼åç»­æç©ºåè¯´ã</p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-01 11:29">2026-02-01 11:28</span>&nbsp;
<a href="https://www.cnblogs.com/grey-wolf">ä¸å½æ¢¦å</a>&nbsp;
éè¯»(<span id="post_view_count">75</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19560342);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19560342', targetLink: 'https://www.cnblogs.com/grey-wolf/p/19560342', title: 'nginx locationæ²¡å­¦å¥½ï¼æèªå·±åäºä¸æ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä»0å°1ï¼å¿«éè®­ç»å¹¶ä½¿ç¨YOLOæ¨¡å ]]></title>
    <link>https://www.cnblogs.com/ClownLMe/p/19559180</link>
    <guid>65df351b854a545c186b8f26d64191cd</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ClownLMe/p/19559180" title="åå¸äº 2026-01-31 21:54">
    <span role="heading" aria-level="2">ä»0å°1ï¼å¿«éè®­ç»å¹¶ä½¿ç¨YOLOæ¨¡å</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ç®ä»">ç®ä»</h1>
<p><strong>YOLO</strong>æ¯ç®åè®¡ç®æºè§è§é¢åæåæ²¿ãåºç¨æå¹¿æ³ç<strong>ç®æ æ£æµ</strong>ç®æ³æ¡æ¶ï¼ä»è½å¿«éè¯å«åºåç®æ ï¼å¹¿æ³åºç¨äºæ¸¸æï¼æ äººé©¾é©¶ï¼å·¥ä¸ç­é¢åã</p>
<p>ä»¥è¯å«èº²é¿æè½æ»åçæ¸¸æçç©ä½å¾çä½ä¸ºä¾å­ã</p>
<h1 id="ä¸ç¯å¢éç½®">ä¸ï¼ç¯å¢éç½®</h1>
<pre><code class="language-bash">pip install ultralytics
</code></pre>
<h1 id="äºåå¤æ°æ®é">äºï¼åå¤æ°æ®é</h1>
<p>è¿ä¸ªæ ¼å¼ç®å½å¦ä¸ï¼</p>
<pre><code class="language-bash">my_dataset/
âââ data.yaml # éç½®æä»¶ï¼å®ä¹è·¯å¾åç±»å«ï¼
âââ train/ #è®­ç»æ°æ®é
â   âââ images/ # è®­ç»å¾ç
â   âââ labels/ # æ æ³¨æä»¶ (.txt)
âââ val/ #éªè¯æ°æ®é
    âââ images/ 
    âââ labels/ 
</code></pre>
<h3 id="datayml">data.yml</h3>
<pre><code class="language-yaml">path: D:\D_MyProject\Ai\game_ai\my_dataset #æ°æ®éè·¯å¾
train: train/images #è®­ç»éå¾çè·¯å¾
val: val/images #éªè¯éå¾çè·¯å¾

nc: 3 #æ è®°ä¸ªæ°
names:  #æ¯ä¸ªæ è®°çåç§°
&nbsp; 0: player
&nbsp; 1: enemy
&nbsp; 2: game_over
</code></pre>
<h3 id="ä¸é¢æ¯ç¨aiçæäºæ°æ®éççæèæ¬">ä¸é¢æ¯ç¨AIçæäºæ°æ®éççæèæ¬</h3>
<p><mark>æ°æ®éå¤ªå¤äºï¼è¿éä¸ºäºæ¼ç¤ºï¼æèå­¦ä¹ ï¼å¯ä»¥ç´æ¥ä½¿ç¨ä¸é¢èæ¬</mark></p>
<pre><code class="language-python">import pygame
import random
import sys
import os
import shutil

# =================éç½®åºå=================
# æ°æ®éæ ¹ç®å½åç§°
DATASET_ROOT = "my_dataset"
# ééæ»æ°é
MAX_IMAGES = 1000
# è®­ç»éå æ¯ (0.8 = 80% è®­ç», 20% éªè¯)
TRAIN_RATIO = 0.8

# ================= 1. ç¯å¢æ¸çä¸ç®å½åå»º =================
print(f"ð æ­£å¨åå§åæ°æ®éç®å½: {DATASET_ROOT} ...")

# å¦æç®å½å·²å­å¨ï¼åå é¤ï¼é²æ­¢æ§æ°æ®æ··å¥ï¼ï¼ç¡®ä¿æ°æ®çº¯å
if os.path.exists(DATASET_ROOT):
    shutil.rmtree(DATASET_ROOT)

# åå»º YOLO æ åç®å½ç»æ
for split in ['train', 'val']:
    os.makedirs(os.path.join(DATASET_ROOT, split, 'images'), exist_ok=True)
    os.makedirs(os.path.join(DATASET_ROOT, split, 'labels'), exist_ok=True)

# ================= 2. èªå¨çæ data.yaml =================
yaml_content = f"""
path: {os.path.abspath(DATASET_ROOT)} # ä½¿ç¨ç»å¯¹è·¯å¾ï¼é²æ­¢æ¥é
train: train/images
val: val/images

nc: 3
names:
  0: player
  1: enemy
  2: game_over
"""
with open(os.path.join(DATASET_ROOT, "data.yaml"), "w", encoding='utf-8') as f:
    f.write(yaml_content)
print("â data.yaml éç½®æä»¶å·²çæã")

# ================= 3. æ¸¸æä¸ééé»è¾ =================
pygame.init()
WIDTH, HEIGHT = 800, 600
# ä½¿ç¨ hidden æ¨¡å¼ææ­£å¸¸æ¨¡å¼åå¯ï¼è¿éç¨æ­£å¸¸æ¨¡å¼æ¹ä¾¿ä½ çå°è¿åº¦
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("Auto Data Generator")
clock = pygame.time.Clock()

font_big = pygame.font.SysFont("monospace", 50)
font_small = pygame.font.SysFont("monospace", 35)

# æ¸¸æç¶æ
player_size, enemy_size = 50, 50
player_x = WIDTH // 2
player_y = HEIGHT - player_size - 10
enemies = []

img_count = 0
GAMEPLAY_LIMIT = int(MAX_IMAGES * 0.9) # 90% æ­£å¸¸æ¸¸æï¼10% Game Over

print(f"ð¸ å¼å§éé {MAX_IMAGES} å¼ å¾ç (èªå¨åå Train/Val)...")

while img_count &lt; MAX_IMAGES:
    # å¤çéåºäºä»¶ï¼é²æ­¢å¡æ­»
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            pygame.quit()
            sys.exit()

    screen.fill((0, 0, 0))
    labels = [] # å­å¨å½åå¸§çæ ç­¾
    dw, dh = 1.0 / WIDTH, 1.0 / HEIGHT # å½ä¸åç³»æ°

    # --- é»è¾åæ¯ï¼æ­£å¸¸æ¸¸æ vs Game Over ---
    if img_count &lt; GAMEPLAY_LIMIT:
        # A. æ­£å¸¸æ¸¸æç»é¢
        # 1. ç©å®¶ç§»å¨
        if random.random() &lt; 0.2: # å¢å ç§»å¨é¢ç
            player_x += random.choice([-15, 15])
            player_x = max(0, min(WIDTH - player_size, player_x))

        # 2. æäººçæä¸ç§»å¨
        if random.randint(0, 20) == 0: # å¢å æäººå¯åº¦
            enemies.append([random.randint(0, WIDTH - enemy_size), 0])
        
        for enemy in enemies: enemy[1] += 15 # å å¿«ä¸è½éåº¦
        enemies = [e for e in enemies if e[1] &lt; HEIGHT]

        # 3. ç»å¶ç©å®¶ (Class 0)
        pygame.draw.rect(screen, (50, 150, 255), (player_x, player_y, player_size, player_size))
        # è®¡ç® YOLO åæ  (class x_center y_center width height)
        px, py = (player_x + player_size/2) * dw, (player_y + player_size/2) * dh
        labels.append(f"0 {px:.6f} {py:.6f} {player_size*dw:.6f} {player_size*dh:.6f}")

        # 4. ç»å¶æäºº (Class 1)
        for e in enemies:
            pygame.draw.rect(screen, (255, 50, 50), (e[0], e[1], enemy_size, enemy_size))
            ex, ey = (e[0] + enemy_size/2) * dw, (e[1] + enemy_size/2) * dh
            labels.append(f"1 {ex:.6f} {ey:.6f} {enemy_size*dw:.6f} {enemy_size*dh:.6f}")

    else:
        # B. Game Over ç»é¢ (Class 2)
        text_surf = font_big.render("GAME OVER", True, (255, 50, 50))
        
        # éæºæå¨ä½ç½®ï¼é²æ­¢è¿æå
        off_x, off_y = random.randint(-50, 50), random.randint(-50, 50)
        text_x = WIDTH // 2 - text_surf.get_width() // 2 + off_x
        text_y = HEIGHT // 2 - 100 + off_y
        screen.blit(text_surf, (text_x, text_y))

        # å¹²æ°é¡¹
        score_surf = font_small.render(f"Score: {random.randint(0,999)}", True, (255,255,255))
        screen.blit(score_surf, (WIDTH//2 - score_surf.get_width()//2, HEIGHT//2 + 50))

        # è®°å½æ ç­¾
        tw, th = text_surf.get_width(), text_surf.get_height()
        tx, ty = (text_x + tw/2) * dw, (text_y + th/2) * dh
        labels.append(f"2 {tx:.6f} {ty:.6f} {tw*dw:.6f} {th*dh:.6f}")

    # ================= 4. ä¿å­é»è¾ (æ ¸å¿ä¿®æ¹) =================
    pygame.display.flip()
    
    # éæ ·çï¼ä¸æ¯æ¯ä¸å¸§é½ä¿å­ï¼é²æ­¢éå¤åº¦è¿é« (è¿éè®¾ä¸º 30% æ¦çä¿å­)
    if random.random() &lt; 0.3:
        # A. å³å®æ¯å» Train è¿æ¯ Val
        split_folder = "train" if random.random() &lt; TRAIN_RATIO else "val"
        
        # B. çææä»¶å
        filename = f"{img_count:06d}"
        img_save_path = os.path.join(DATASET_ROOT, split_folder, "images", f"{filename}.jpg")
        lbl_save_path = os.path.join(DATASET_ROOT, split_folder, "labels", f"{filename}.txt")

        # C. ä¿å­å¾ç
        pygame.image.save(screen, img_save_path)

        # D. ä¿å­æ ç­¾
        with open(lbl_save_path, "w") as f:
            f.write("\n".join(labels))

        img_count += 1
        
        # æå°è¿åº¦æ¡
        print(f"[{split_folder.upper()}] è¿åº¦: {img_count}/{MAX_IMAGES}", end="\r")

    # å éæ¨¡æï¼ä¸è¦åç´åæ­¥ï¼è¶å¿«è¶å¥½
    clock.tick(0) 

pygame.quit()
print(f"\n\nâ¨ å¨é¨å®æï¼æ°æ®éå·²å°±ç»ªï¼{os.path.abspath(DATASET_ROOT)}")
print("ð¡ ä¸ä¸æ­¥ï¼ç´æ¥è¿è¡ model.train(data='my_dataset/data.yaml')")
</code></pre>
<h1 id="ä¸è®­ç»yoloæ¨¡å">ä¸ï¼è®­ç»YOLOæ¨¡å</h1>
<p>å¯ä»¥çå°ï¼ä½¿ç¨<code>ultralytics</code>æ¡æ¶è®­ç»YOLOçä»£ç éå¸¸ç®åï¼åªéè¦å è¡<br>
<mark><strong>æ³¨æï¼è¿éYOLOä¼èªå¨ä¸è½½æ¨¡åå¹¶è®­ç»ï¼ä¸è½½æ¶å¤±è´¥å¯è½éè¦ææ¢¯å­</strong></mark></p>
<pre><code class="language-python">from ultralytics import YOLO

def train_model():
    #å è½½æ¨¡å
    model = YOLO("yolo11n.pt") 

    #å¼å§è®­ç»
    print("å¼å§è®­ç»...")
    results = model.train(
        data="my_dataset/data.yaml", #æ°æ®ééç½®æä»¶
        epochs=30, #è®­ç»è½®æ°
        imgsz=640, #å¾çè¾å¥å°ºå¯¸
        batch=16, #æ¾å­å¤å¤§å¯ä»¥æ¹å¤§ï¼æ¯å¦ 32 æ 64
        device=0, #å¼ºå¶ä½¿ç¨ç¬¬ä¸å¼ æ¾å¡ (éè¦CUDA)
        workers=0, #Windowsä¸è®¾ä¸º0é²æ­¢å¤è¿ç¨æ¥é
        project="dodge_project",#ä¿å­è·¯å¾
        name="ai_model" #è®­ç»è¿è¡åç§°
    )
    print(f"è®­ç»å®æï¼æä½³æ¨¡åä¿å­å¨: {results.save_dir}/weights/best.pt")

if __name__ == "__main__":
    train_model()
</code></pre>
<h1 id="åä½¿ç¨yoloæ¨¡å">åï¼ä½¿ç¨YOLOæ¨¡å</h1>
<pre><code class="language-python">from ultralytics import YOLO

#éç½®è·¯å¾
MODEL_PATH = "dodge_project/ai_model/weights/best.pt" 
PIC_PATH = "my_dataset/val/images/000045.jpg"

#å è½½æ¨¡å
model = YOLO(MODEL_PATH)
print(f"æ¨¡åå è½½æå")

#è¯å«å¾ç
results = model.predict(PIC_PATH, verbose=False, conf=0.4, imgsz=640)
result = results[0]

#è·åä¿¡æ¯å¹¶æå°
for box in result.boxes:
    # è·ååæ  (x1, y1, x2, y2)ãç±»å« ID åç½®ä¿¡åº¦
    x1, y1, x2, y2 = map(int, box.xyxy[0])
    cls_id = int(box.cls[0])
    conf = float(box.conf[0])
    
    # ç±»å«åç§°æ å°
    names = {0: "Player", 1: "Enemy", 2: "Game Over"}
    label = names.get(cls_id, f"Unknown({cls_id})")
    print(f"æ¾å°ç©ä½: [{label:10}] | ç½®ä¿¡åº¦: {conf:.2f} | åæ : ({x1}, {y1}) -&gt; ({x2}, {y2})")

#å±ç¤ºå¾ç
result.show()
</code></pre>
<p><strong>å¦æâ¤åæ¬¢â¤æ¬ç³»åæç¨ï¼å°±ç¹ä¸ªå³æ³¨å§ï¼åç»­ä¸å®ææ´æ°~</strong></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-31 21:55">2026-01-31 21:54</span>&nbsp;
<a href="https://www.cnblogs.com/ClownLMe">ClownLMe</a>&nbsp;
éè¯»(<span id="post_view_count">133</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19559180);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19559180', targetLink: 'https://www.cnblogs.com/ClownLMe/p/19559180', title: 'ä»0å°1ï¼å¿«éè®­ç»å¹¶ä½¿ç¨YOLOæ¨¡å' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>