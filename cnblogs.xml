<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-02-13T20:32:08.090Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ SpringCloud  å¾®æå¡å®ç°ä¸å (Eureka + Hystrix) ]]></title>
    <link>https://www.cnblogs.com/dddy/p/19613850</link>
    <guid>11820b39586bc13d6ec6614e28f67fc8</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/dddy/p/19613850" title="åå¸äº 2026-02-13 23:42">
    <span role="heading" aria-level="2">SpringCloud  å¾®æå¡å®ç°ä¸å (Eureka + Hystrix)</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>2018-1-29</p>
<h1 id="spring">Spring</h1>
<p>[[N_SpringBoot]]</p>
<hr>
<h1 id="å¾®æå¡æ¶æ">å¾®æå¡æ¶æ</h1>
<h2 id="ä»ä¹æ¯å¾®æå¡">ä»ä¹æ¯å¾®æå¡?</h2>
<p>ä¾å¦ä¸ä¸ªååç³»ç», æ ç¨æ·æ¨¡å, äº§åæ¨¡å, è®¢åæ¨¡å, æ¯ä»æ¨¡å, å¨ä¼ ç»çMVCç»æä¸­,<br>
è¿äºé½éä¸­å¨ä¸ä¸ªå¾éçJVMè¿ç¨ä¸­.</p>
<p>è¿æå ä¸ªé®é¢:</p>
<ul>
<li>é¡¹ç®è¿äºèè¿å½å¤§å¤§å°å°çåè½æ¨¡åé½éä¸­å¨åä¸é¡¹ç®çæ¶å, æ´ä¸ªé¡¹ç®å¿ç¶ä¼åå¾èè¿, è®©å¼åèé¾ä»¥ç»´æ¤</li>
<li>èµæºæ æ³éç¦», æ´ä¸ªåä½ç³»ç»çåä¸ªåè½æ¨¡åé½ä¾èµäºåæ ·çæ°æ®åº, åå­ç­èµæº, ä¸æ¦æä¸ªåè½æ¨¡åå¯¹èµæºä½¿ç¨ä¸å½, æ´ä¸ªç³»ç»é½ä¼è¢«æå®</li>
</ul>
<p><strong>è§£å³çé®é¢</strong></p>
<p>ç®èè¨ä¹,å¾®æå¡æ¶æé£æ ¼æ¯ä¸ç§å°åä¸ªåºç¨ç¨åºä½ä¸ºä¸å¥å°åæå¡å¼åçæ¹æ³, æ¯ç§åºç¨ç¨åºé½å¨èªå·±çè¿ç¨ä¸­è¿è¡, å¹¶ä¸è½»éçº§æºå¶(<strong>éå¸¸æ¯HTTPèµæºAPI</strong>)è¿è¡éä¿¡;<br>
è¿äºæå¡æ¯å´ç»ä¸å¡åè½æå»ºç, å¯ä»¥éè¿å¨èªå¨é¨ç½²æºå¶ç¬ç«é¨ç½²;  è¿äºæå¡çéä¸­ç®¡çæå°,<strong>å¯ä»¥ç¨ä¸åçç¼ç¨è¯­è¨ç¼å</strong>, å¹¶ä½¿ç¨ä¸åçæ°æ®å­å¨ææ¯;</p>
<p>æ¬ä¾å¦: æååæ¨¡å, è®¢åæ¨¡åç¬ç«åä¸ºä¸ä¸ªæå¡,åç´æå,å®ä»¬ç´æ¥ä½¿ç¨APIéè®¯, è¿æ ·å³æ¶è®¢åç³»ç»åºé, åªæ¯ä¸è½ä¸è®¢åä¸å½±åååæå¡</p>
<p><img alt="983980-20170501194607023-1194438149" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3723410/202602/3723410-20260213233825686-985949901.png" class="lazyload"></p>
<p><strong>ç¹å¾</strong><br>
å®æ¹çå®ä¹:</p>
<ol>
<li>ä¸äºåçç¬ç«çæå¡å±åç»æç³»ç»</li>
<li>åç¬é¨ç½², è·å¨èªå·±çè¿ç¨ä¸­</li>
<li>æ¯ä¸ªæå¡ä¸ºç¬ç«çä¸å¡å¼å</li>
<li>åå¸å¼ç®¡ç</li>
<li>éå¸¸å¼ºè°éç¦»æ§</li>
</ol>
<p>å¤§æ¦çæ å:</p>
<ol>
<li>åå¸å¼æå¡ç»æçç³»ç»</li>
<li>æç§ä¸å¡, èä¸æ¯ææ¯æ¥ååç»ç»</li>
<li>åæçå½çäº§åèä¸æ¯é¡¹ç®</li>
<li>å¼ºæå¡ä¸ªä½åå¼±éä¿¡ï¼ Smart endpoints and dumb pipes ï¼</li>
<li>èªå¨åè¿ç»´ï¼ DevOps ï¼</li>
<li>é«åº¦å®¹éæ§</li>
<li>å¿«éæ¼ååè¿­ä»£</li>
</ol>
<blockquote>
<p><strong>å¾®æå¡æ¶ææ¯ä¸ä¸ªè½¯ä»¶æ¶æ æä¸ä¸ªåä½åºç¨, æç§ &lt;ä¸å¡è¾¹ç&gt; è¿è¡åç´æåä¸ºæ¯ä¸ªç¬ç«çæå¡åºç¨</strong></p>
</blockquote>
<blockquote>
<p><a href="https://www.cnblogs.com/imyalost/p/6792724.html" target="_blank">å¾®æå¡æ¶æ</a></p>
</blockquote>
<hr>
<h2 id="å®ç°å¼ç³çé®é¢ä¸è§è²">å®ç°å¼ç³çé®é¢ä¸è§è²</h2>
<p>å¾®æå¡æ¶æéè¦çåè½æä½¿ç¨åºæ¯</p>
<ol>
<li>
<p>æä»¬ææ´ä¸ªç³»ç»æ ¹æ®ä¸å¡æåæå ä¸ªå­ç³»ç»(<strong>å¾®æå¡</strong>);</p>
</li>
<li>
<p>æ¯ä¸ªå­ç³»ç»å¯ä»¥é¨ç½²å¤ä¸ªåºç¨, <code>å¤ä¸ªåºç¨ä¹é´ä½¿ç¨è´è½½åè¡¡</code>;</p>
</li>
<li>
<p>éè¦ä¸ä¸ªæå¡<strong>æ³¨åä¸­å¿</strong>, ææçæå¡é½å¨æ³¨åä¸­å¿æ³¨å, è´è½½åè¡¡ä¹æ¯éè¿å¨æ³¨åä¸­å¿æ³¨åçæå¡æ¥ä½¿ç¨ä¸å®ç­ç¥æ¥å®ç°;</p>
</li>
<li>
<p>ææçå®¢æ·ç«¯é½éè¿åä¸ä¸ªç½å³å°åè®¿é®åå°çæå¡, éè¿<strong>è·¯ç±éç½®</strong>, ç½å³æ¥å¤æ­ä¸ä¸ªURLè¯·æ±ç±åªä¸ªæå¡å¤ç; è¯·æ±è½¬åå°æå¡ä¸çæ¶åä¹ä½¿ç¨<strong>è´è½½åè¡¡</strong>;</p>
</li>
<li>
<p>æå¡ä¹é´ææ¶åä¹éè¦ç¸äºè®¿é®; ä¾å¦æä¸ä¸ªç¨æ·æ¨¡å, å¶ä»æå¡å¨å¤çä¸äºä¸å¡çæ¶å, è¦è·åç¨æ·æå¡çç¨æ·æ°æ®;</p>
</li>
<li>
<p>éè¦ä¸ä¸ª<strong>æ­è·¯å¨</strong>, åæ¶å¤çæå¡è°ç¨æ¶çè¶æ¶åéè¯¯, é²æ­¢ç±äºå¶ä¸­ä¸ä¸ªæå¡çé®é¢èå¯¼è´æ´ä½ç³»ç»çç«çª;</p>
</li>
<li>
<p>è¿éè¦ä¸ä¸ª<strong>çæ§</strong>åè½, çæ§æ¯ä¸ªæå¡è°ç¨è±è´¹çæ¶é´ç­;</p>
</li>
</ol>
<br>
<hr>
<h2 id="ä¸ä¸ªzookeeper-å-eureka-æ¯è¾">ä¸ä¸ªZooKeeper å Eureka æ¯è¾</h2>
<p><code>ZooKeeper</code>æ¯ä¸ä¸ªåå¸å¼ç, å¼æ¾æºç çåå¸å¼åºç¨ç¨åºåè°æå¡, æ¯GoogleçChubbyä¸ä¸ªå¼æºçå®ç°, æ¯HadoopåHbaseçéè¦ç»ä»¶; å®æ¯ä¸ä¸ªä¸ºåå¸å¼åºç¨æä¾ä¸è´æ§æå¡çè½¯ä»¶, æä¾çåè½åæ¬: éç½®ç»´æ¤, ååæå¡, åå¸å¼åæ­¥, ç»æå¡ç­;</p>
<p><code>Eureka</code>æ¯Netflixå¼åçæå¡åç°æ¡æ¶, æ¬èº«æ¯ä¸ä¸ªåºäºRESTçæå¡, ä¸»è¦ç¨äºå®ä½è¿è¡å¨AWSåä¸­çä¸­é´å±æå¡, ä»¥è¾¾å°è´è½½åè¡¡åä¸­é´å±æå¡æéè½¬ç§»çç®ç; SpringCloudå°å®éæå¨å¶å­é¡¹ç®spring-cloud-netflixä¸­, ä»¥å®ç°SpringCloudçæå¡åç°åè½;</p>
<p>ZooKeeper å Eureka æ¡æ¶é½å¨SpringCloudä¸­éæå®ä»¬ä½ä¸º<code>æ³¨åä¸­å¿</code>, å®ä»¬ä¸»è¦ä¾§éç¹ä¸å</p>
<ul>
<li>Zoopkeeperä¿è¯CP:<br>
å½åæ³¨åä¸­å¿æ¥è¯¢æå¡åè¡¨æ¶, æä»¬å¯ä»¥å®¹å¿æ³¨åä¸­å¿è¿åçæ¯å åéä»¥åçæ³¨åä¿¡æ¯, ä½æ¯ä¸è½æ¥åæå¡ç´æ¥downæä¸å¯ç¨; ä¹å°±æ¯è¯´, æå¡æ³¨ååè½å¯¹å¯ç¨æ§çè¦æ±è¦é«äºä¸è´æ§; ä½æ¯zkä¼åºç°è¿æ ·çä¸ç§æåµ, å½masterèç¹å ç½è·¯æéä¸å¶ä»èç¹å¤±å»èç³»æ¶, å©ä½çèç¹ä¼éæ°è¿è¡leaderéä¸¾; é®é¢å¨äº, éä¸¾leaderçæ¶é´å¤ªé¿, 30~120s, ä¸éä¸¾æé´æ´ä¸ªzkéç¾¤æ¯é½æ¯ä¸å¯ç¨ç, è¿å°±å¯¼è´å¨éä¸¾æé´æ³¨åæå¡ç«çª, å¨äºé¨ç½²çç¯å¢ä¸, å ç½ç»é®é¢ä½¿å¾zkéç¾¤å¤±å»masterèç¹æ¯è¾å¤§æ¦çä¼åççäº, è½ç¶æå¡è½å¤æç»æ¢å¤, ä½æ¯æ¼«é¿çéä¸¾æ¶é´å¯¼è´çæ³¨åé¿æä¸å¯ç¨æ¯ä¸è½å®¹å¿ç;</li>
</ul>
<blockquote>
<p>ZooKeeperæ¯ä»¥Fast Paxosç®æ³ä¸ºåºç¡ä¿æä¸è´æ§, è¿ä¸ªç®æ³å¯è½ä¼äº§çé®é¢æ¯éè¦ä¸ä¸ªLeaderæ¥ä¿è¯æ°æ®çä¸è´æ§. æä»¥å®å¿é¡»æä¸ä¸ªLeaderèç¹.</p>
</blockquote>
<ul>
<li>Eurekaä¿è¯AP:<br>
Eurekaçæç½äºè¿ä¸ç¹, å æ­¤å¨è®¾è®¡æ¶å°±ä¼åä¿è¯å¯ç¨æ§; Eurekaåä¸ªèç¹é½æ¯å¹³ç­ç, å ä¸ªèç¹ææä¸å½±åæ­£å¸¸èç¹çå·¥ä½, å©ä½çèç¹ä¾ç¶å¯ä»¥æä¾æ³¨ååæ¥è¯¢æå¡; èEurekaçå®¢æ·ç«¯å¨åæä¸ªEurekaæ³¨åæ¶å¦æåç°è¿æ¥å¤±è´¥, åä¼èªå¨åæ¢è³å¶ä»çèç¹, åªè¦æä¸å°Eurekaè¿å¨, å°±è½ä¿è¯æ³¨åæå¡å¯ç¨ï¼ä¿è¯å¯ç¨æ§ï¼, åªä¸è¿æ¥å°çä¿¡æ¯å¯è½ä¸æ¯ææ°çï¼ä¸ä¿è¯ä¸è´æ§ï¼;</li>
</ul>
<br>
<hr>
<h1 id="spring-cloud-å¾®æå¡çå®ç°">Spring Cloud å¾®æå¡çå®ç°</h1>
<p><strong>é¡ºä¾¿è§£å³: å®ç°å¼ç³çé®é¢ä¸è§è²</strong></p>
<p>Spring Cloud æ¯ä¸ç³»åæ¡æ¶çæåºéå, å®å©ç¨ Spring Boot çå¼åä¾¿å©æ§ç®åäºåå¸å¼ç³»ç»çå¼å,<br>
æ¯å¦æå¡åç°, æå¡ç½å³, æå¡è·¯ç±, é¾è·¯è¿½è¸ªç­; Spring Cloud å¹¶ä¸éå¤é è½®å­, èæ¯å°å¸é¢ä¸å¼åå¾æ¯è¾å¥½çæ¨¡åéæè¿å»,<br>
è¿è¡å°è£, ä»èåå°äºåæ¨¡åçå¼åææ¬; æ¢å¥è¯è¯´: Spring Cloud æä¾äºæå»ºåå¸å¼ç³»ç»æéç"å¨å®¶æ¡¶";</p>
<p>åºç¡åå¤</p>
<blockquote>
<p>é¦åçé¦åéè¦ä¸ä¸ªMavené¡¹ç®, ä½ä¸ºç¶æ¨¡å. ä»¥ä¾¿ç®¡ç</p>
</blockquote>
<p>è¯¥ç¶é¡¹ç®ç pom.xmlçå®æ´éç½®</p>
<pre><code class="language-xml">&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
	&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

	&lt;groupId&gt;yang&lt;/groupId&gt;
	&lt;artifactId&gt;spring_cloud_parent&lt;/artifactId&gt;
	&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
	&lt;packaging&gt;pom&lt;/packaging&gt;

	&lt;name&gt;spring cloud parent dome&lt;/name&gt;

	&lt;properties&gt;
  		&lt;spring-cloud.version&gt;Finchley.RELEASE&lt;/spring-cloud.version&gt;
		&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
	&lt;/properties&gt;

	&lt;parent&gt;
		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
		&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
		&lt;version&gt;2.0.5.RELEASE&lt;/version&gt;
		   &lt;relativePath/&gt;
	&lt;/parent&gt;

	&lt;dependencies&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;junit&lt;/groupId&gt;
			&lt;artifactId&gt;junit&lt;/artifactId&gt;
			&lt;scope&gt;test&lt;/scope&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
			&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
			&lt;scope&gt;test&lt;/scope&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
			&lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
			&lt;optional&gt;true&lt;/optional&gt;
		&lt;/dependency&gt;
		
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
			&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
		&lt;/dependency&gt;
	&lt;/dependencies&gt;

    &lt;dependencyManagement&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
                &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;
                &lt;version&gt;${spring-cloud.version}&lt;/version&gt;
                &lt;type&gt;pom&lt;/type&gt;
                &lt;scope&gt;import&lt;/scope&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
    &lt;/dependencyManagement&gt;

&lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

&lt;/project&gt;

</code></pre>
<p><a href="spring_cloud_parent.rar" target="_blank" rel="noopener nofollow">æå</a></p>
<br>
<hr>
<h2 id="1-æ³¨åä¸­å¿å®ç°åºäºeureka">1. æ³¨åä¸­å¿å®ç°(åºäºEureka)</h2>
<p><strong>è¿éä¾¿è§£å³å¼ç³åºæ¥çç¬¬ä¸ä¸ªé®é¢,ææçæå¡é½å¯ä»¥å¨æ³¨åä¸­å¿æ¾å°</strong></p>
<p>eurekaæ¯ä¸ä¸ªé«å¯ç¨çç»ä»¶, å®æ²¡æåç«¯ç¼å­, æ¯ä¸ä¸ªå®ä¾æ³¨åä¹åéè¦åæ³¨åä¸­å¿åéå¿è·³ï¼å æ­¤å¯ä»¥å¨åå­ä¸­å®æï¼,<br>
å¨é»è®¤æåµä¸erureka serverä¹æ¯ä¸ä¸ªeureka client ,å¿é¡»è¦æå®ä¸ä¸ª server;<br>
è§ä¸:application.yml<br>
éè¿eureka.client.registerWithEureka: falseåfetchRegistry: falseæ¥è¡¨æèªå·±æ¯ä¸ä¸ªeureka server.</p>
<h3 id="eureka_server">eureka_server</h3>
<p>å¨è¿é, éç¨Eurekaä½ä¸ºæå¡æ³¨åä¸åç°çç»ä»¶,<br>
å¨spring cloud parent domeåºç¡ä¸åå»ºä¸ä¸ªmavenå­æ¨¡åå·¥ç¨ä½ä¸ºæå¡æ³¨åä¸­å¿, å³ <code>eureka_server</code><br>
å®ä¾èµ<code>spring-cloud-starter-netflix-eureka-server</code> è¿ä¸ª<code>starter</code> æ³¨ægroupIdæ¯ org.springframework.cloud</p>
<pre><code class="language-xml"> &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt;
&lt;/dependency&gt;

</code></pre>
<h4 id="domeä»£ç ">domeä»£ç </h4>
<p><code>@EnableEurekaServer</code>è¡¨é¢å®æ¯ä¸ä¸ª EurekaServer</p>
<pre><code class="language-java">@SpringBootApplication
@EnableEurekaServer
public class Application {

    public static void main(String[] args) {
        new SpringApplicationBuilder(Application.class).web(true).run(args);
    }

}
</code></pre>
<h4 id="applicationyml">application.yml</h4>
<pre><code class="language-yml">server:
  port: 8761
eureka:
  instance:
    hostname: 127.0.0.1
  client:
    registerWithEureka: false  æ¯å¦å°èªå·±æ³¨åå°Eureka Server, é»è®¤ä¸ºtrue; ç±äºå½ååºç¨å°±æ¯Eureka Server, æèè®¾ä¸ºfalse
    fetchRegistry: false  è¡¨ç¤ºæ¯å¦ä»Eureka Severè·åæ³¨åä¿¡æ¯, é»è®¤ä¸ºtrue; å ä¸ºè¿æ¯ä¸ä¸ªåèç¹çEureka Server, ä¸éè¦åæ­¥å¶ä»çEureka Serverèç¹çæ°æ®, æèè®¾ä¸ºfalse
    serviceUrl:
      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/
</code></pre>
<h4 id="æµè¯">æµè¯</h4>
<p>å¯å¨Spring Booté¡¹ç®, è®¿é®: <a href="http://127.0.0.1:8761" target="_blank" rel="noopener nofollow">http://127.0.0.1:8761</a></p>
<p>Instances currently registered with Eureka å¯çå°æ³¨åçæå¡</p>
<p>åèå®æ¹ææ¡£: <a href="https://cloud.spring.io/spring-cloud-static/Finchley.SR2/multi/multi_spring-cloud-eureka-server.html" target="_blank" rel="noopener nofollow">https://cloud.spring.io/spring-cloud-static/Finchley.SR2/multi/multi_spring-cloud-eureka-server.html</a></p>
<br>
<hr>
<h2 id="2-æå¡æä¾èåºäºeureka">2. æå¡æä¾è(åºäºEureka)</h2>
<p><strong>è¿éä¾¿ è§£å³å¼ç³åºæ¥çç¬¬ä¸ä¸ªé®é¢, æå¡, è¿éçeureka_clientå¯æå¤ä¸ªä¸æ­çæ©å±æå¡</strong><br>
å½clientåserveræ³¨åæ¶, å®ä¼æä¾ä¸äºåæ°æ®, ä¾å¦ä¸»æºåç«¯å£, URL, ä¸»é¡µç­; Eureka server ä»æ¯ä¸ªclientå®ä¾æ¥æ¶å¿è·³æ¶æ¯;<br>
å¦æå¿è·³è¶æ¶, åéå¸¸å°è¯¥å®ä¾ä»æ³¨åserverä¸­å é¤;</p>
<h3 id="eureka_client">eureka_client</h3>
<p>åå»ºä¸ä¸ªmavenå­æ¨¡åå·¥ç¨ <code>eureka_client</code><br>
å®ä¾èµ<code>spring-cloud-starter-netflix-eureka-client</code> è¿ä¸ª<code>starter</code> æ³¨ægroupIdæ¯ org.springframework.cloud</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
&lt;/dependency&gt;

</code></pre>
<h4 id="domeä»£ç -1">domeä»£ç </h4>
<p>éè¿æ³¨è§£<code>@EnableEurekaClient</code> è¡¨æèªå·±æ¯ä¸ä¸ªeureka client.</p>
<pre><code class="language-java">@SpringBootApplication
@EnableEurekaClient
@RestController
public class ServiceHiApplication {

    public static void main(String[] args) {
        SpringApplication.run( ServiceHiApplication.class, args );
    }

    @Value("${server.port}")
    String port;

    @RequestMapping("/hi")
    public String home(@RequestParam(value = "name", defaultValue = "NAME") String name) {
        return "hi " + name + " ,i am from port:" + port;
    }

}
</code></pre>
<p>ä»ä»<code>@EnableEurekaClient</code>æ¯ä¸å¤ç,<br>
è¿éè¦å¨éç½®æä»¶ä¸­æ³¨æèªå·±çæå¡æ³¨åä¸­å¿çå°å<code>defaultZone</code><br>
éè¦ææ<code>spring.application.name</code> è¿ä¸ªå¾éè¦, è¿å¨ä»¥åçæå¡ä¸æå¡ä¹é´ç¸äºè°ç¨ä¸è¬é½æ¯æ ¹æ®è¿ä¸ªname ;</p>
<h4 id="applicationyml-1">application.yml</h4>
<pre><code class="language-yml">server:
  port: 8762

spring:
  application:
    name: service-hi

eureka:
  client:
    serviceUrl:
      defaultZone: http://127.0.0.1:8761/eureka/
</code></pre>
<h4 id="æµè¯-1">æµè¯</h4>
<ul>
<li>å¯å¨ eureka_client</li>
<li>åå¯å¨ eureka_server</li>
</ul>
<blockquote>
<p>å¯å¨ Instances currently registered with Eureka çå°<code>eureka_client</code> [SERVICE-HI]å·²è¢«æ³¨å</p>
</blockquote>
<p>åèå®æ¹ææ¡£: <a href="https://cloud.spring.io/spring-cloud-static/Finchley.SR2/multi/multi__service_discovery_eureka_clients.html" target="_blank" rel="noopener nofollow">https://cloud.spring.io/spring-cloud-static/Finchley.SR2/multi/multi__service_discovery_eureka_clients.html</a></p>
<blockquote>
<p><a href="https://www.fangzhipeng.com/springcloud/2018/08/30/sc-f1-eureka/" target="_blank" rel="noopener nofollow">https://www.fangzhipeng.com/springcloud/2018/08/30/sc-f1-eureka/</a></p>
</blockquote>
<br>
<hr>
<h2 id="3-æå¡æ¶è´¹èç¾¤åºäºribbonè´è½½åè¡¡">3. æå¡æ¶è´¹èç¾¤(åºäºribbonè´è½½åè¡¡)</h2>
<p><strong>è¿éä¾¿ è§£å³å¼ç³åºæ¥çç¬¬äºä¸ªé®é¢: æ¯ä¸ªå­ç³»ç»å¯ä»¥é¨ç½²å¤ä¸ªåºç¨, å¤ä¸ªåºç¨ä¹é´ä½¿ç¨è´è½½åè¡¡</strong></p>
<p>Spring Cloud Ribbonæ¯ä¸ä¸ªåºäºHTTPåTCPçå®¢æ·ç«¯è´è½½åè¡¡å·¥å·, å®åºäºNetflix Ribbonå®ç°; éè¿Spring Cloudçå°è£,<br>
å¯ä»¥è®©æä»¬è½»æ¾å°å°é¢åæå¡çRESTæ¨¡çè¯·æ±èªå¨è½¬æ¢æå®¢æ·ç«¯è´è½½åè¡¡çæå¡è°ç¨;</p>
<p>æ´è¯¦ç»ç:</p>
<p><code>Ribbon</code>æ¯Netflixåå¸çå¼æºé¡¹ç®, ä¸»è¦åè½æ¯æä¾å®¢æ·ç«¯çè½¯ä»¶è´è½½åè¡¡ç®æ³, å°Netflixçä¸­é´å±æå¡è¿æ¥å¨ä¸èµ·;<br>
Ribbonå®¢æ·ç«¯ç»ä»¶æä¾ä¸ç³»åå®åçéç½®é¡¹å¦è¿æ¥è¶æ¶, éè¯ç­; ç®åçè¯´,</p>
<p>å°±æ¯å¨éç½®æä»¶ä¸­ååº<code>Load Balancer</code>åé¢ææçæºå¨, Ribbonä¼èªå¨çå¸®å©ä½ åºäºæç§è§åï¼å¦ç®åè½®è¯¢, éæºè¿æ¥ç­ï¼å»è¿æ¥è¿äºæºå¨;<br>
æä»¬ä¹å¾å®¹æä½¿ç¨Ribbonå®ç°èªå®ä¹çè´è½½åè¡¡ç®æ³; ç®åå°è¯´, Ribbonæ¯ä¸ä¸ªå®¢æ·ç«¯è´è½½åè¡¡å¨;<br>
Ribbonå·¥ä½æ¶åä¸ºä¸¤æ­¥:<br>
ç¬¬ä¸æ­¥åéæ© Eureka Server, å®ä¼åéæ©å¨åä¸ä¸ªZoneä¸è´è½½è¾å°çServer;<br>
ç¬¬äºæ­¥åæ ¹æ®ç¨æ·æå®çç­ç¥, å¨ä»Serveråå°çæå¡æ³¨ååè¡¨ä¸­éæ©ä¸ä¸ªå°å;<br>
å¶ä¸­Ribbonæä¾äºå¤ç§ç­ç¥, ä¾å¦è½®è¯¢, éæº, æ ¹æ®ååºæ¶é´å æç­;</p>
<p>åå¤</p>
<ul>
<li>å¯å¨ eureka_server (æ³¨åä¸­å¿)</li>
<li>å¯å¨ eureka_client (æå¡)</li>
<li>æç«¯å£8762 æ¹ä¸ä¸ 8763 åå¯å¨ eureka_client è¿æ ·ä¾¿æäºä¸¤ä¸ªæå¡,ç»æä¸ä¸ªç¾¤</li>
</ul>
<blockquote>
<p>å¯å¨ Instances currently registered with Eureka çå°[SERVICE-HI]å¯ç¨æ°æ¯2</p>
</blockquote>
<h3 id="eureka_client-1">eureka_client</h3>
<p>åå»ºä¸ä¸ªmavenå­æ¨¡åå·¥ç¨ <code>ribbon</code></p>
<ul>
<li>pom.xmlå¤§æ¦ä¸»ä½</li>
</ul>
<pre><code class="language-xml">    &lt;parent&gt;
        &lt;groupId&gt;yang&lt;/groupId&gt;
        &lt;artifactId&gt;spring_cloud_parent&lt;/artifactId&gt;
        &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;

    &lt;artifactId&gt;ribbon&lt;/artifactId&gt;
    &lt;name&gt;ribbon&lt;/name&gt;
    &lt;url&gt;http://maven.apache.org&lt;/url&gt;

    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-starter-netflix-ribbon&lt;/artifactId&gt;
    &lt;/dependency&gt;
</code></pre>
<h4 id="domeä»£ç -2">domeä»£ç </h4>
<p>éè¿æ³¨è§£<code>@EnableEurekaClient</code> è¡¨æå®ä¹æ¯ä¸ä¸ªeurekaclient(æèè¯´eurekaclientç­åäºä¸ä¸ªæå¡?)</p>
<p><code> @Bean</code> ç®¡çä¸ä¸ªbean</p>
<p><code>@LoadBalanced</code>æ³¨è§£è¡¨æè¿ä¸ªrestRemplateå¼å¯è´è½½åè¡¡çåè½;</p>
<pre><code class="language-java">@SpringBootApplication
@EnableEurekaClient
@EnableDiscoveryClient
public class Application {

    public static void main(String[] args) {
        SpringApplication.run( Application.class, args );
    }

    @Bean
    @LoadBalanced
    RestTemplate restTemplate() {
        return new RestTemplate();
    }

}

</code></pre>
<h4 id="applicationyml-2">application.yml</h4>
<p>æå®æ³¨åä¸­å¿å°å, ä»¥åèªå·±çåç§°</p>
<pre><code class="language-yml">eureka:
client:
    serviceUrl:
    defaultZone: http://127.0.0.1:8761/eureka/
server:
port: 8764
spring:
application:
    name: ribbon
</code></pre>
<h4 id="è°ç¨ä»£ç ">è°ç¨ä»£ç </h4>
<p>åå»ºä¸ä¸ªService è°ç¨<code>SERVICE-HI</code>çhi æ¥å£<br>
æ³¨æè¿éurlçSERVICE-HI,å®å¨ribbonä¸­å®ä¼æ ¹æ®æå¡åæ¥éæ©å·ä½çæå¡å®ä¾, æ ¹æ®æå¡å®ä¾å¨è¯·æ±çæ¶åä¼ç¨å·ä½çurlæ¿æ¢ææå¡å</p>
<pre><code class="language-java">@Service
public class HelloService {
    @Autowired
    RestTemplate restTemplate;

        public String hiService(String name) {
            return restTemplate.getForObject("http://SERVICE-HI/hi?name="+name,String.class);
        }
}

</code></pre>
<p>ä¸ä¸ªcontrollerä¸­, è°ç¨HelloService çæ¹æ³</p>
<pre><code class="language-java">@RestController
public class HelloControler {

    @Autowired
    HelloService helloService;

    @GetMapping(value = "/hi")
    public String hi(@RequestParam String name) {
        return helloService.hiService( name );
    }
}

</code></pre>
<p>å¨æ³¨åä¸­å¿é¡µé¢, ä¼çå°ä¸ä¸ªæå¡: <a href="http://127.0.0.1:8761/" target="_blank" rel="noopener nofollow">http://127.0.0.1:8761/</a><br>
<img alt="20190129170623" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3723410/202602/3723410-20260213233920605-462521574.png" class="lazyload"></p>
<p>å¨æµè§å¨ä¸å¤æ¬¡è®¿é®http://127.0.0.1:8764/hi?name=è´è½½åè¡¡, æµè§å¨ä¼äº¤æ¿æ¾ç¤º,è¿è¯´æä¼è½®æµè®¿é®ä¸åçä¸»æº</p>
<p><br><br><br></p>
<p>-<strong>ç®åæ¶æ</strong></p>
<p><img alt="20190129170751" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3723410/202602/3723410-20260213233937477-1356393169.png" class="lazyload"></p>
<ul>
<li>
<p>ä¸ä¸ªæå¡æ³¨åä¸­å¿, eureka server,ç«¯å£ä¸º8761</p>
</li>
<li>
<p>service-hiå·¥ç¨è·äºä¸¤ä¸ªå®ä¾, ç«¯å£åå«ä¸º8762, 8763, åå«åæå¡æ³¨åä¸­å¿æ³¨å</p>
</li>
<li>
<p>sercvice-ribbonç«¯å£ä¸º8764,åæå¡æ³¨åä¸­å¿æ³¨å</p>
</li>
</ul>
<blockquote>
<p>å½sercvice-ribbonéè¿restTemplateè°ç¨service-hiçhiæ¥å£æ¶, å ä¸ºç¨ribbonè¿è¡äºè´è½½åè¡¡, ä¼è½®æµçè°ç¨service-hi: 8762å8763 ä¸¤ä¸ªç«¯å£çhiæ¥å£;</p>
</blockquote>
<blockquote>
<p><a href="https://www.fangzhipeng.com/springcloud/2018/08/30/sc-f2-ribbon/" target="_blank" rel="noopener nofollow">https://www.fangzhipeng.com/springcloud/2018/08/30/sc-f2-ribbon/</a></p>
</blockquote>
<h2 id="4-æ­è·¯å¨åºäºhystrix">4. æ­è·¯å¨(åºäºHystrix)</h2>
<p><strong>è¿éä¾¿ è§£å³å¼ç³åºæ¥çç¬¬å­ä¸ªé®é¢: åæ¶å¤çæå¡è°ç¨æ¶çè¶æ¶åéè¯¯, é²æ­¢ç±äºå¶ä¸­ä¸ä¸ªæå¡çé®é¢èå¯¼è´æ´ä½ç³»ç»çç«çª;</strong></p>
<p>å¨å¾®æå¡æ¶æä¸­, æ ¹æ®ä¸å¡æ¥æåæä¸ä¸ªä¸ªçæå¡, æå¡ä¸æå¡ä¹é´å¯ä»¥ç¸äºè°ç¨ï¼RPCï¼, å¨Spring Cloudå¯ä»¥ç¨RestTemplate+RibbonåFeignæ¥è°ç¨;<br>
ä¸ºäºä¿è¯å¶é«å¯ç¨, åä¸ªæå¡éå¸¸ä¼éç¾¤é¨ç½²; ç±äºç½ç»åå æèèªèº«çåå , æå¡å¹¶ä¸è½ä¿è¯100%å¯ç¨, å¦æåä¸ªæå¡åºç°é®é¢, è°ç¨è¿ä¸ªæå¡å°±ä¼åºç°çº¿ç¨é»å¡,<br>
æ­¤æ¶è¥æå¤§éçè¯·æ±æ¶å¥, Servletå®¹å¨ççº¿ç¨èµæºä¼è¢«æ¶èå®æ¯, å¯¼è´æå¡ç«çª; æå¡ä¸æå¡ä¹é´çä¾èµæ§, æéä¼ä¼ æ­, ä¼å¯¹æ´ä¸ªå¾®æå¡ç³»ç»é æç¾é¾æ§çä¸¥éåæ,<br>
è¿å°±æ¯æå¡æéç"éªå´©"æåº;</p>
<p>Netflixå¼æºäºHystrixç»ä»¶, å®ç°äºæ­è·¯å¨æ¨¡å¼, SpringCloudå¯¹è¿ä¸ç»ä»¶è¿è¡äºæ´å;  å¨å¾®æå¡æ¶æä¸­, ä¸ä¸ªè¯·æ±éè¦è°ç¨å¤ä¸ªæå¡æ¯éå¸¸å¸¸è§</p>
<ul>
<li>
<p>æ­£å¸¸æåµçè°ç¨:<br>
<img alt="8d8d524c312c27d" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3723410/202602/3723410-20260213233954963-604013054.png" class="lazyload"></p>
<p>è¾åºå±çæå¡å¦æåºç°æé, ä¼å¯¼è´è¿éæé; å½å¯¹ç¹å®çæå¡çè°ç¨çä¸å¯ç¨è¾¾å°ä¸ä¸ªéå¼ï¼Hystric æ¯5ç§20æ¬¡ï¼ æ­è·¯å¨å°ä¼è¢«æå¼;</p>
</li>
<li>
<p>å½æä¸ªæå¡downæå<br>
<img alt="1f208d62046f" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3723410/202602/3723410-20260213234006243-236615741.png" class="lazyload"></p>
</li>
</ul>
<p>æ­è·¯æå¼å, å¯ç¨é¿åè¿éæé, fallbackæ¹æ³å¯ä»¥ç´æ¥è¿åä¸ä¸ªåºå®å¼;</p>
<h3 id="æ¹é å®ç°">æ¹é å®ç°</h3>
<p>æ¹é  ribbon é¡¹ç®<br>
é¦åå¨pox.xmlæä»¶ä¸­å å¥<code>spring-cloud-starter-netflix-hystrix</code>ç<code>starter</code> æ³¨ægroupIdæ¯ org.springframework.cloud</p>
<h4 id="æ¹é poxxml">æ¹é pox.xml</h4>
<pre><code class="language-xml">    &lt;!-- æ­è·¯å¨ç»ä»¶ --&gt;
     &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;
    &lt;/dependency&gt;
</code></pre>
<p>å¨ç¨åºçå¯å¨ç±»Application å <code>@EnableHystrix</code>æ³¨è§£å¼å¯Hystrix:</p>
<h4 id="æ¹é å¯å¨ç±»">æ¹é å¯å¨ç±»</h4>
<pre><code class="language-java">@SpringBootApplication
@EnableEurekaClient
@EnableDiscoveryClient
@EnableHystrix
public class Application {

    public static void main(String[] args) {
        SpringApplication.run( Application.class, args );
    }

    @Bean
    @LoadBalanced
    RestTemplate restTemplate() {
        return new RestTemplate();
    }

}

</code></pre>
<h4 id="helloservice">HelloService</h4>
<p>æ¹é HelloServiceç±», å¨hiServiceæ¹æ³ä¸å ä¸<code>@HystrixCommand</code>æ³¨è§£; è¯¥æ³¨è§£å¯¹è¯¥æ¹æ³åå»ºäºçæ­å¨çåè½, å¹¶æå®äº<code>fallbackMethod</code>çæ­æ¹æ³, <code>hiError</code></p>
<pre><code class="language-java">
@Service
public class HelloService {
	 @Autowired
	  RestTemplate restTemplate;
	 
	    @HystrixCommand(fallbackMethod = "hiError")
	    public String hiService(String name) {
	        return restTemplate.getForObject("http://SERVICE-HI/hi?name="+name,String.class);
	    }
	    
	    public String hiError(String name) {
	        return "hi,"+name+", æ±æ­è¯¥æå¡, å·²ç»downæäº :(";
	    }
}

</code></pre>
<h4 id="æµè¯-2">æµè¯</h4>
<ul>
<li>å¯å¨ eureka_server (æ³¨åä¸­å¿)</li>
<li>å¯å¨ eureka_client (æå¡)</li>
<li>å¯å¨ ribbon (è´è½½åè¡¡)</li>
</ul>
<p>è®¿é®è¯¥è´è½½åè¡¡æå¡url:<br>
<a href="http://127.0.0.1:8764/hi?name=%E6%B5%8B%E6%B5%8B%E8%AF%95%E8%AF%95" target="_blank" rel="noopener nofollow">http://127.0.0.1:8764/hi?name=æµæµè¯è¯</a></p>
<p>æ­£å¸¸è¾åº:</p>
<blockquote>
<p>hi æµæµè¯è¯ ,i am from port:8762</p>
</blockquote>
<p>å¦ææeureka_client donw, å°±ä¼è¾åº</p>
<blockquote>
<p>hi,æµæµè¯è¯, æ±æ­è¯¥æå¡, å·²ç»downæäº ð¦</p>
</blockquote>
<h2 id="4-è·¯å¨ç½å³åºäºzuul">4. è·¯å¨ç½å³(åºäºZuul)</h2>
<p><strong>è¿éä¾¿ è§£å³å¼ç³åºæ¥çç¬¬åä¸ªé®é¢: ææçå®¢æ·ç«¯é½éè¿åä¸ä¸ªç½å³å°åè®¿é®åå°çæå¡, éè¿è·¯ç±éç½®, ç½å³æ¥å¤æ­ä¸ä¸ªURLè¯·æ±ç±åªä¸ªæå¡å¤ç;</strong></p>
<p>Zuul çä¸»è¦åè½æ¯è·¯ç±è½¬ååè¿æ»¤å¨; è·¯ç±åè½æ¯å¾®æå¡çä¸é¨å, æ¯å¦ï¼api/userè½¬åå°å°useræå¡,<br>
/api/shopè½¬åå°å°shopæå¡; zuulé»è®¤åRibbonç»åå®ç°äºè´è½½åè¡¡çåè½;</p>
<h3 id="åå»º">åå»º</h3>
<p>åå»ºä¸ä¸ªmavenå­æ¨¡åå·¥ç¨ <code>zuul</code><br>
pom.xml ä¸»ä½ä¾èµ</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-zuul&lt;/artifactId&gt;
&lt;/dependency&gt;

</code></pre>
<h3 id="domeä»£ç -3">domeä»£ç </h3>
<p>éè¿æ³¨è§£<code>@EnableEurekaClient</code> è¡¨æå®ä¹æ¯ä¸ä¸ªeureka client<br>
éè¿æ³¨è§£<code>@EnableZuulProxy</code> å¼å¯zuulçåè½</p>
<pre><code class="language-java">/**
 * è·¯ç±ç½å³
 */
@SpringBootApplication
@EnableZuulProxy
@EnableEurekaClient
@EnableDiscoveryClient
public class Application {

    public static void main(String[] args) {
        SpringApplication.run( Application.class, args );
    }

}

</code></pre>
<h3 id="applicationyml-3">application.yml</h3>
<p>é¦åæå®æå¡æ³¨åä¸­å¿çå°åä¸ºhttp://localhost:8761/eureka/, æå¡çç«¯å£ä¸º8769, æå¡åä¸ºzuul;<br>
ä»¥/api-a/ å¼å¤´çè¯·æ±é½è½¬åç»ribbonæå¡;<br>
ä»¥/api-b/å¼å¤´çè¯·æ±é½è½¬åç»service-hiæå¡;</p>
<pre><code class="language-yml">eureka:
  client:
    serviceUrl:
      defaultZone: http://127.0.0.1:8761/eureka/
server:
  port: 8769
spring:
  application:
    name: zuul
zuul:
  routes:
    api-a:
      path: /api-a/**
      serviceId: RIBBON
    api-b:
      path: /api-b/**
      serviceId: SERVICE-HI

</code></pre>
<h3 id="æµè¯-3">æµè¯</h3>
<p>å¯å¨, æ³¨åä¸­å¿(erureka server) , æå¡åºç¨(erureka client), è´è½½åè¡¡(ribbon), è·¯ç±(zuul)<br>
è®¿é®api-a,api-bé½æ¯ææç, ä½æ¯æè´è½½åè¡¡åæ,api-a å°±æ æäº..<br>
<a href="http://127.0.0.1:8769/api-a/hi?name=ddd" target="_blank" rel="noopener nofollow">http://127.0.0.1:8769/api-a/hi?name=ddd</a><br>
<a href="http://127.0.0.1:8769/api-b/hi?name=ddd" target="_blank" rel="noopener nofollow">http://127.0.0.1:8769/api-b/hi?name=ddd</a></p>
<p>ç½å³ä¸åæ­¢éä¸­API è½¬å, å®è¿å¯å¯ä»¥åä¸ä¸å®å¨è¿æ»¤çåè½... å¾ç ç©¶</p>
<h2 id="5-å¾®æå¡çæ§åºäºspring-boot-admin">5. å¾®æå¡çæ§(åºäºSpring Boot Admin)</h2>
<p>å®æ¹2.1.2 ææ¡£: <a href="http://codecentric.github.io/spring-boot-admin/2.1.2/" target="_blank" rel="noopener nofollow">http://codecentric.github.io/spring-boot-admin/2.1.2/</a></p>
<h3 id="ç«¯ç¹endpoints">ç«¯ç¹(Endpoints)</h3>
<p>Actuator endpoints let you monitor and interact with your application.</p>
<p>æ§è¡å¨ç«¯ç¹, å¯ä»¥è®©ä½ çæ§åºç¨ç¨åºå¹¶ä¸ä¹äº¤äº; (æ¢å¥è¯è¯´, æä¾ä¸ä¸ªå¯ä»¥ä¸ç»ä»¶æå¡äº¤äºçæ¥å£,åæ¬ä½ä¸éäºçæ§, è·å æå¡ç»ä»¶çè¿è¡ä¿¡æ¯)</p>
<p>å®åç½®äºä¸äºç«¯ç¹ è§ææ¡£, Spring Boot Admin çæ§è·åç»ä»¶æå¡çä¿¡æ¯å°±æ¯éè¿è¿äºç«¯ç¹.</p>
<blockquote>
<p>ææ¡£: <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html" target="_blank" rel="noopener nofollow">https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html</a></p>
</blockquote>
<blockquote>
<p><a href="https://blog.csdn.net/liupeifeng3514/article/details/80558414" target="_blank" rel="noopener nofollow">https://blog.csdn.net/liupeifeng3514/article/details/80558414</a></p>
</blockquote>
<h3 id="è¸©åæå">è¸©åæå!!</h3>
<ul>
<li>è¢«çæ§æå¡åºç¨é¡¹ç®æ·»å  <code>spring-boot-starter-actuator</code>!!</li>
</ul>
<pre><code class="language-xml">  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<ul>
<li>ç¶åå¨ <code>application.yml</code> éç½®æ´é²çç«¯ç¹</li>
</ul>
<p>//è¿éç®åç²æ´, æ´é²ææç«¯ç¹</p>
<pre><code class="language-yml">management:
  endpoints:
    web:
      exposure:
        include: "*"  
        exclude: configprops # éç½®ä¿¡æ¯configpropsçç«¯ç¹, æé¤ææ²¡ä»ä¹æä¹, ä¸å½åçæ¬å­å¨BUG. (ä¸ç´æåºservlet aync å¼å¸¸)
  endpoint:
    health:
      show-details: ALWAYS
</code></pre>
<p>ä»¥ä¸åå»º <code>Spring Boot Admin server</code> æå¡åºç¨</p>
<h3 id="åå»º-1">åå»º</h3>
<p>åå»ºä¸ä¸ªmavenå­æ¨¡åå·¥ç¨ ``<br>
pom.xml ä¸»ä½ä¾èµ</p>
<pre><code class="language-xml"> 
 &lt;dependency&gt;
    &lt;groupId&gt;de.codecentric&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-admin-starter-server&lt;/artifactId&gt;
    &lt;version&gt;2.1.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
&lt;/dependency&gt;

  &lt;!-- tag::dependency-eureka[] --&gt;
  &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
      &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;!-- end::dependency-eureka[]  --&gt;

</code></pre>
<h3 id="domeä»£ç -4">domeä»£ç </h3>
<p>éè¿æ³¨è§£<code>@EnableDiscoveryClient</code> spring ä¼ç´æ¥ æ´åå°æ³¨åä¸­å¿(è¿éæ¯eureka, ææä¸é¢çä¾èµæ¯spring-cloud-starter-netflix-eureka-client)<br>
éè¿æ³¨è§£<code>@EnableAdminServer</code> è¡¨æå®æ¯ spring-boot-admin æå¡</p>
<pre><code class="language-java">/**
 * çæ§
 * 
 * @author yangfh
 * 2019å¹´1æ30æ¥
 */
@Configuration
@EnableAutoConfiguration
@EnableDiscoveryClient
@EnableAdminServer
public class SpringBootAdminApplication {
    public static void main(String[] args) {
        SpringApplication.run(SpringBootAdminApplication.class, args);
    }

    @Configuration
    public static class SecurityPermitAllConfig extends WebSecurityConfigurerAdapter {
        @Override
        protected void configure(HttpSecurity http) throws Exception {
          http.authorizeRequests().anyRequest().permitAll()  
               .and().csrf().disable();
        }
    }
}

</code></pre>
<h3 id="applicationyml-4">application.yml</h3>
<pre><code class="language-yml">server:
  port: 8800
spring:
  application:
    name: admin
eureka:
  instance:
    leaseRenewalIntervalInSeconds: 10
    health-check-url-path: /actuator/health
  client:
    serviceUrl:
      defaultZone: http://localhost:8761/eureka/ # æå¡æ³¨åä¸­å¿
management: 
  endpoints:
    web:
      exposure:
        include: '*' #æ´é²ææç«¯ç¹
      exclude: configprops #éç½®ä¿¡æ¯configpropsçç«¯ç¹, æé¤ææ²¡ä»ä¹æä¹, ä¸å½åçæ¬å­å¨BUG.(java.lang.IllegalStateException: Calling [asyncError()])
  endpoint:
      health:
        show-details: ALWAYS

</code></pre>
<h3 id="æµè¯-4">æµè¯</h3>
<p>å¯å¨, æ³¨åä¸­å¿(erureka server) , Spring Boot Adminçæ§(admin)</p>
<p>å¯ä»¥è®¿é®Spring Boot Admin (admin)çå°å: <a href="http://localhost:8800/" target="_blank" rel="noopener nofollow">http://localhost:8800/</a>, å¨æ³¨åä¸­å¿åªæèªå·±, æä»¥åªè½çå°èªå·±çä¸äºä¿¡æ¯</p>
<h3 id="çæ§å¶ä»æå¡åºç¨">çæ§å¶ä»æå¡åºç¨</h3>
<p>å¦æ ç´æ¥å¯å¨ erureka client, å¨Spring Boot Admin æ¯çä¸å°çè¯¥åºç¨çè¯¦ç»ä¿¡æ¯ç, çº¢å</p>
<ul>
<li>æ¹é  erureka client æ·»å  ä¾èµ</li>
</ul>
<pre><code class="language-xml">  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<ul>
<li>application.yml å¼æ¾ç«¯ç¹</li>
</ul>
<pre><code class="language-yml">management:
  endpoints:
    web:
      exposure:
        include: "*"  
  endpoint:
    health:
      show-details: ALWAYS
</code></pre>
<ul>
<li>å¯å¨</li>
</ul>
<p><img alt="20190129170623" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3723410/202602/3723410-20260213233920605-462521574.png" class="lazyload"></p>
<p><a href="spring_cloud_parent.zip" target="_blank" rel="noopener nofollow">yeah~</a></p>
<h3 id="èªå®ä¹ç«¯ç¹">èªå®ä¹ç«¯ç¹</h3>
<p>åªéè¦ä¸ä¸ªæ³¨è§£@endpoint, @ReadOperation, @Selector</p>
<pre><code class="language-java">@Endpoint(id = "customPoint")
@Component
public class StatusEndPoint {
 
	@ReadOperation
	public String getCustom(@Selector String name) {
		return "MyName is ." + name;
	}
 
}
</code></pre>
<p>ä¸ä¸ªèªå®ä¹CPU ç«¯ç¹, å¦å¤ä¸ç§æ¹å¼</p>
<pre><code class="language-java">package net.jk.admin.controller;

import java.lang.management.ManagementFactory;
import java.util.Iterator;
import java.util.List;
import java.util.Optional;

import javax.annotation.PostConstruct;
import javax.management.Attribute;
import javax.management.AttributeList;
import javax.management.MBeanServer;
import javax.management.ObjectName;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import io.micrometer.core.instrument.Gauge;
import io.micrometer.core.instrument.MeterRegistry;

/**
 * 
 * @author yangfh
 * 2019å¹´4æ10æ¥
 */
@Component
public class CpuMetrics {
	private final static String METRICS_NAME = "process.cpu.load";

    @Autowired
    private MeterRegistry meterRegistry;

    @PostConstruct
    public void init() {
        Gauge.builder(METRICS_NAME, this, CpuMetrics::getProcessCpuLoad)
            .baseUnit("%")
            .description("CPU Load")
            .register(meterRegistry);
    }

    public Double getProcessCpuLoad() {
        try {
            MBeanServer mbs = ManagementFactory.getPlatformMBeanServer();
            ObjectName name = ObjectName.getInstance("java.lang:type=OperatingSystem");
            AttributeList list = mbs.getAttributes(name, new String[]{"ProcessCpuLoad"});

            return Optional.ofNullable(list)
                    .map(l -&gt; l.isEmpty() ? null: l)
                    .map(List::iterator)
                    .map(Iterator::next)
                    .map(Attribute.class::cast)
                    .map(Attribute::getValue)
                    .map(Double.class::cast)
                    .orElse(null);

        } catch (Exception ex) {
            return null;
        }
    }
}

</code></pre>
<p>The CPU metrics will then be available at /actuator/metrics/process.cpu.load:</p>
<p><a href="https://stackoverflow.com/questions/37985719/spring-boot-actuator-to-give-cpu-usage/52150306#52150306?newreg=a0e9d98d127247d1b3f275e775bba2f3" target="_blank" rel="noopener nofollow">https://stackoverflow.com/questions/37985719/spring-boot-actuator-to-give-cpu-usage/52150306#52150306?newreg=a0e9d98d127247d1b3f275e775bba2f3</a></p>
<p>åèææ¡£: <a href="http://codecentric.github.io/spring-boot-admin/2.1.2/" target="_blank" rel="noopener nofollow">http://codecentric.github.io/spring-boot-admin/2.1.2/</a><br>
åè2.xé¨åç«¯ç¹: <a href="https://www.baeldung.com/spring-boot-actuators#boot-2x-actuator" target="_blank" rel="noopener nofollow">https://www.baeldung.com/spring-boot-actuators#boot-2x-actuator</a><br>
ç«¯ç¹å®å¨: <a href="https://segmentfault.com/a/1190000015309478?utm_source=tag-newest" target="_blank" rel="noopener nofollow">https://segmentfault.com/a/1190000015309478?utm_source=tag-newest</a></p>
<h2 id="spring-session">Spring-Session</h2>
<p>åå¸å¼Sessionçé®é¢</p>
<blockquote>
<p>éå¹³è¡¡HTTP sessionå¯è½ä¼æä¸ºæ§è½ç¶é¢;<br>
ä¸ºäºå­å¨å¤§éçsession, ä¼éè¦å¾å¤§çå ç©ºé´, è¿ä¼å¯¼è´åå¾æ¶é, ä»èå¯¹æ§è½äº§çè´é¢å½±å;<br>
äºåºç¡è®¾æ½éå¸¸ä¼ç¦æ­¢TCPå¤æ­ï¼multicastï¼, ä½æ¯sessionç®¡çå¨å¸¸å¸¸ä¼ä½¿ç¨è¿ç§æºå¶æ¥åç°åªä¸ä¸ªåºç¨æå¡å¨å®ä¾å å¥æç¦»å¼äºéç¾¤;</p>
</blockquote>
<blockquote>
<p>å æ­¤, æ´ä¸ºé«æçåæ³æ¯å°HTTP sessionç¶æä¿å­å¨ç¬ç«çæ°æ®å­å¨ä¸­, è¿ä¸ªå­å¨ä½äºè¿è¡åºç¨ç¨åºä»£ç çJVMä¹å¤;<br>
ä¾å¦, æä»¬å¯ä»¥å°100ä¸ªTomcatå®ä¾éç½®ä¸ºä½¿ç¨Redisæ¥å­å¨sessionç¶æ, å½Tomcatå®ä¾å¢å æåå°çæ¶å,<br>
Redisä¸­æå­å¨çsessionå¹¶ä¸ä¼åå°å½±å; åæ¶, å ä¸ºRedisæ¯ä½¿ç¨Cè¯­è¨ç¼åç, æä»¥å®å¯ä»¥ä½¿ç¨ä¸ç¾GBçè³TBçº§å«çRAM,<br>
å®ä¸ä¼æ¶åå°åå¾æ¶éçé®é¢;</p>
</blockquote>
<p><a href="https://www.cnblogs.com/river2005/p/6415879.html" target="_blank">https://www.cnblogs.com/river2005/p/6415879.html</a></p>
<p>Spring Sessionè®¤ä¸ºç¬¬ä¸ä¸ªé®é¢, ä¹å°±æ¯å¨é«å¯ç¨å¯æ©å±çéç¾¤ä¸­å­å¨æ°æ®å·²ç»éè¿åç§æ°æ®å­å¨æ¹æ¡å¾å°äºè§£å³, å¦Redis, GemFireä»¥åApache Geodeç­ç­,</p>
<p>å æ­¤, Spring Sessionå®ä¹äºä¸ç»æ åçæ¥å£, å¯ä»¥éè¿å®ç°è¿äºæ¥å£é´æ¥è®¿é®åºå±çæ°æ®å­å¨; Spring Sessionå®ä¹äºå¦ä¸æ ¸å¿æ¥å£: Session, ExpiringSessionä»¥åSessionRepository, éå¯¹ä¸åçæ°æ®å­å¨, å®ä»¬éè¦åå«å®ç°;</p>
<p>org.springframework.session.Sessionæ¥å£å®ä¹äºsessionçåºæ¬åè½, å¦è®¾ç½®åç§»é¤å±æ§; è¿ä¸ªæ¥å£å¹¶ä¸å³å¿åºå±ææ¯, å æ­¤è½å¤æ¯servlet HttpSessionéç¨äºæ´ä¸ºå¹¿æ³çåºæ¯ä¸­;<br>
org.springframework.session.ExpiringSessionæ©å±äºSessionæ¥å£, å®æä¾äºå¤æ­sessionæ¯å¦è¿æçå±æ§; RedisSessionæ¯è¿ä¸ªæ¥å£çä¸ä¸ªæ ·ä¾å®ç°;<br>
org.springframework.session.SessionRepositoryå®ä¹äºåå»º, ä¿å­, å é¤ä»¥åæ£ç´¢sessionçæ¹æ³; å°Sessionå®ä¾çæ­£ä¿å­å°æ°æ®å­å¨çé»è¾æ¯å¨è¿ä¸ªæ¥å£çå®ç°ä¸­ç¼ç å®æç; ä¾å¦, RedisOperationsSessionRepositoryå°±æ¯è¿ä¸ªæ¥å£çä¸ä¸ªå®ç°, å®ä¼å¨Redisä¸­åå»º, å­å¨åå é¤session;</p>
<h3 id="httpsession-with-jdbc-guide"><a href="https://docs.spring.io/spring-session/docs/2.1.5.RELEASE/reference/html5/guides/boot-redis.html" target="_blank" rel="noopener nofollow">HttpSession with JDBC Guide</a></h3>
<p>å¯ç¨redis ç®¡çsession æ³¨æå®ä¾èµä¸ redis æä»¥éè¦éç½® redis ?</p>
<pre><code class="language-xml">&lt;!-- redis 
  redis:
    database: 0
    port: 6379
    pool:
      max-idle: 8
      min-idle: 0
      max-active: 8
      max-wait: -1
    host: 127.0.0.1
    timeout: 5000
    --&gt;
   &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.session&lt;/groupId&gt;
    &lt;artifactId&gt;spring-session-data-redis&lt;/artifactId&gt;
  &lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.session&lt;/groupId&gt;
    &lt;artifactId&gt;spring-session-data-redis&lt;/artifactId&gt;
  &lt;/dependency&gt;
</code></pre>
<p><a href="https://blog.csdn.net/andyliulin/article/details/80850317" target="_blank" rel="noopener nofollow">https://blog.csdn.net/andyliulin/article/details/80850317</a></p>
<h1 id="spring-cloud-oauth20-æ´å">Spring Cloud OAuth2.0 æ´å</h1>
<h2 id="oauth20-æ¦è¦">OAuth2.0 æ¦è¦</h2>
<p>OAuth2 æ¯ä¸ä¸ªå¼æ¾æææ ååè®®, å®åè®¸ç¨æ·è®©ç¬¬ä¸æ¹åºç¨è®¿é®è¯¥ç¨æ·å¨ææå¡çç¹å®ç§æèµæº,<br>
ä½æ¯ä¸æä¾è´¦å·å¯ç ä¿¡æ¯ç»ç¬¬ä¸æ¹åºç¨;</p>
<pre><code>+--------+                               +---------------+
|        |--(A)- Authorization Request -&gt;|   Resource    |
|        |                               |     Owner     |
|        |&lt;-(B)-- Authorization Grant ---|               |
|        |                               +---------------+
|        |
|        |                               +---------------+
|        |--(C)-- Authorization Grant --&gt;| Authorization |
| Client |                               |     Server    |
|        |&lt;-(D)----- Access Token -------|               |
|        |                               +---------------+
|        |
|        |                               +---------------+
|        |--(E)----- Access Token ------&gt;|    Resource   |
|        |                               |     Server    |
|        |&lt;-(F)--- Protected Resource ---|               |
+--------+                               +---------------+

                Figure 1: Abstract Protocol Flow

</code></pre>
<ol>
<li>
<p>èµæºæ¥æèï¼resource ownerï¼: è½ææè®¿é®åä¿æ¤èµæºçä¸ä¸ªå®ä½, å¯ä»¥æ¯ä¸ä¸ªäºº, é£æä»¬ç§°ä¹ä¸ºæç»ç¨æ·<strong>ä¸è¬ä¸ºä¸ªäººç¨æ·</strong>;</p>
</li>
<li>
<p>èµæºæå¡å¨ï¼resource serverï¼: å­å¨åä¿æ¤èµæº, å®¢æ·ç«¯éè¿access tokenè¯·æ±èµæº,<br>
èµæºæå¡å¨ååºåä¿æ¤èµæºç»å®¢æ·ç«¯(<strong>å­å¨å¹¶ååºç»ææéè®¿é®å®¢æ·ç«¯ çæå¡å¨, æ¯å¦ç¨æ·ä¸ä¼ çç§æç¸å</strong>);</p>
</li>
<li>
<p>æææå¡å¨ï¼authorization serverï¼: æåéªè¯èµæºæ¥æèå¹¶è·åææä¹å,<br>
æææå¡å¨é¢åææä»¤çï¼Access Tokenï¼ç»å®¢æ·ç«¯(<strong>è´è´£è®¤è¯å¹¶ææç»å®¢æ·ç«¯</strong>);</p>
</li>
<li>
<p>å®¢æ·ç«¯ï¼clientï¼: ç¬¬ä¸æ¹åºç¨, ä¹å¯ä»¥æ¯å®èªå·±çå®æ¹åºç¨; å¶æ¬èº«ä¸å­å¨èµæº,<br>
èæ¯èµæºæ¥æèææéè¿å, ä½¿ç¨å®çææï¼ææä»¤çï¼è®¿é®åä¿æ¤èµæº, ç¶åå®¢æ·ç«¯æç¸åºçæ°æ®å±ç¤ºåºæ¥/æäº¤å°æå¡å¨;<br>
(<strong>ä¸ä¸ªå¾®æå¡,æèè¯´ä»¥ä¸ä¸ªç¬ç«çåºç¨, æææºæweb..</strong>)</p>
</li>
</ol>
<h2 id="oauth20-æææ¹å¼">OAuth2.0 æææ¹å¼</h2>
<p>å®¢æ·ç«¯å¿é¡»å¾å°ç¨æ·çææï¼authorization grantï¼, æè½è·å¾ä»¤çï¼access tokenï¼;</p>
<p>OAuth 2.0å®ä¹äºåç§æææ¹å¼;</p>
<p>ææç æ¨¡å¼ï¼authorization codeï¼<br>
ç®åæ¨¡å¼ï¼implicitï¼<br>
å¯ç æ¨¡å¼ï¼resource owner password credentialsï¼<br>
å®¢æ·ç«¯æ¨¡å¼ï¼client credentialsï¼</p>
<p>åè: <a href="http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html" target="_blank" rel="noopener nofollow">çè§£OAuth 2.0</a></p>
<p>Spring Security OAuth æ¯å»ºç«å¨ Spring Security çåºç¡ä¹ä¸ OAuth2.0 åè®®å®ç°çä¸ä¸ªç±»åº,<br>
å®æä¾äºæå»º<strong>Authorization****Server, Resource Server</strong> å<strong>Client</strong> ä¸ç§ Spring åºç¨ç¨åºè§è²æéè¦çåè½;</p>
<blockquote>
<p>è³å°ä¾èµ, å½ç¶æ°æ®åºå­å¨å®ç°è¿éè¦Jdbc etc..</p>
</blockquote>
<pre><code class="language-xml">&lt;dependency&gt;
&nbsp;&nbsp; &nbsp;&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
&nbsp;&nbsp; &nbsp;&lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt;
&nbsp;&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h2 id="æææå¡è§è²">æææå¡è§è²</h2>
<p>spring oa2 æä¾ <code>AuthorizationServerConfigurerAdapter</code> éç½®ééå¨ç±», æ¥éç½®æææå¡ç«¯è§è²<br>
éå¸¸çåæ³æ¯ åå»ºä¸ä¸ªéç½®ç±» ç»§æ¿èª<code>AuthorizationServerConfigurerAdapter</code>,</p>
<p>è¿æéè¦<code>@EnableAuthorizationServer</code>æ³¨è§£è¡¨æå®æ¯ä¸ä¸ª oauthæææå¡å¨,</p>
<p>è¿ä¸ªæ³¨è§£å åªé½è¡,åªè¦æ¯éspringç®¡ççbean, å»ºè®®æ¯å å¨è¿ä¸ªéç½®ç±»éé¢,æ¹ä¾¿åç±»</p>
<p>è¯¥æ³¨è§£å¯¼å¥äºä¸¤ä¸ªéç½®ç±»<code>@Import({AuthorizationServerEndpointsConfiguration.class, AuthorizationServerSecurityConfiguration.class})</code>åé¢ç ç©¶..</p>
<p>ç¤ºä¾å¦ä¸:</p>
<pre><code class="language-java">@Configuration
@EnableAuthorizationServer
public class AuthorizationServerConfiguration  extends AuthorizationServerConfigurerAdapter {
  @Override
	public void configure(AuthorizationServerSecurityConfigurer security) throws Exception {
	}

	@Override
	public void configure(ClientDetailsServiceConfigurer clients) throws Exception {
	}

	@Override
	public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {
	}
}
</code></pre>
<p>ç°å¨æ¥ç ç©¶è¿ä¸ä¸ªéç½®:</p>
<h3 id="authorizationserversecurityconfigurer">AuthorizationServerSecurityConfigurer</h3>
<p>AuthorizationServerSecurityConfigurer: ç¨æ¥éç½®ä»¤çç«¯ç¹çå®å¨çº¦æ; ç®åè¯´éç½®å¦ä¸ä»¤çç«¯ç¹çå®å¨è§å</p>
<pre><code class="language-s">/oauth/authorize: ææç«¯ç¹; 
/oauth/token: ä»¤çç«¯ç¹; 
/oauth/confirm_access: ç¨æ·ç¡®è®¤æææäº¤ç«¯ç¹; 
/oauth/error: æææå¡éè¯¯ä¿¡æ¯ç«¯ç¹; 
/oauth/check_token: ç¨äºèµæºæå¡è®¿é®çä»¤çè§£æç«¯ç¹; 
/oauth/token_key: æä¾å¬æå¯åçç«¯ç¹, å¦æä½ ä½¿ç¨JWTä»¤ççè¯; 
</code></pre>
<p>ä¾å¦ <code>security.sslOnly()</code> æ¹æ³éç½®, åªåè®¸httpsè®¿é®è¿äºç«¯ç¹, demoæ²¡å¥å¥½éç½®ç.</p>
<h4 id="demoä»£ç ">demoä»£ç </h4>
<pre><code class="language-java">  /**
    * AuthorizationServerSecurityConfigurer: ç¨æ¥éç½®ä»¤çç«¯ç¹çå®å¨çº¦æ; 
    */
  @Override
  public void configure(AuthorizationServerSecurityConfigurer security) throws Exception {
      security.tokenKeyAccess("permitAll()")
	        	.checkTokenAccess("permitAll()");//åè®¸æ¥å£/oauth/check_token è¢«è°ç¨
      security.allowFormAuthenticationForClients();     //åè®¸è¡¨åè®¤è¯
  }
</code></pre>
<blockquote>
<p>éè¦æ³¨æä¸ä¸ <code>tokenKeyAccess</code>å<code>checkTokenAccess</code> åè®¸è¢«è®¿é®, ä¸ç¶æ æ³æ£æ¥toket(401)</p>
</blockquote>
<h3 id="clientdetailsserviceconfigurer">ClientDetailsServiceConfigurer</h3>
<p><code>ClientDetailsServiceConfigurer</code> å®ä¹éç½®å®¢æ·ç«¯çè¯¦ç»éç½®, æå ä¸ªéè¦çå±æ§å¦ä¸åè¡¨:</p>
<pre><code class="language-s">clientId: ï¼å¿é¡»çï¼ç¨æ¥æ è¯å®¢æ·çId; 
secret: ï¼éè¦å¼å¾ä¿¡ä»»çå®¢æ·ç«¯ï¼å®¢æ·ç«¯å®å¨ç , å¦ææçè¯; 
scope: ç¨æ¥éå¶å®¢æ·ç«¯çè®¿é®èå´, å¦æä¸ºç©ºï¼é»è®¤ï¼çè¯, é£ä¹å®¢æ·ç«¯æ¥æå¨é¨çè®¿é®èå´; 
authorizedGrantTypes: æ­¤å®¢æ·ç«¯å¯ä»¥ä½¿ç¨çææç±»å, é»è®¤ä¸ºç©º; (ææç±»å åèoauth2.0çè§è)
authorities: æ­¤å®¢æ·ç«¯å¯ä»¥ä½¿ç¨çæéï¼åºäºSpring Security authoritiesï¼; 
</code></pre>
<p>å®¢æ·ç«¯è¯¦ç»ä¿¡æ¯å¯ä¿å­å°æ°æ®åº,åéè¿æ°æ®åºåå§å, <code>new JdbcClientDetailsService(dataSource);</code>,<br>
å®éè¦è¡¨<code>oauth_client_details</code> spring oauth2 ææé»è®¤è¡¨åèæ«å°¾<strong>spring OAuth2 é»è®¤çè¡¨ç»æ</strong></p>
<pre><code class="language-sql">create table oauth_client_details (
  client_id VARCHAR(256) PRIMARY KEY,
  resource_ids VARCHAR(256),
  client_secret VARCHAR(256),
  scope VARCHAR(256),
  authorized_grant_types VARCHAR(256),
  web_server_redirect_uri VARCHAR(256),
  authorities VARCHAR(256),
  access_token_validity INTEGER,
  refresh_token_validity INTEGER,
  additional_information VARCHAR(4096),
  autoapprove VARCHAR(256)
);
</code></pre>
<h4 id="demoä»£ç -1">demoä»£ç </h4>
<pre><code class="language-java">  /**
    * ClientDetailsServiceConfigurer
    * å®ä¹å®¢æ·è¯¦ç»ä¿¡æ¯æå¡çéç½®å¨; å®¢æ·ç«¯è¯¦ç»ä¿¡æ¯å¯ä»¥è¢«åå§å, æèæ¨å¯ä»¥ç´æ¥å¼ç¨ä¸ä¸ªç°æçå­å¨; 
    */
  @Override
  public void configure(ClientDetailsServiceConfigurer clients) throws Exception {
    /** å¼ç¨å­å¨å®ç°
      * clients.withClientDetails(clientDetails());
      */
    //dome ä½¿ç¨åå­ ä¸¤ä¸ªå®¢æ·ç«¯ ä¸ä¸ªä½¿ç¨ authorization_code è®¤è¯, ä¸ä¸ªä½¿ç¨password è®¤è¯
    clients.inMemory() 
          .withClient("client_abc") // client_id
          .secret("client_abc_s") // client_secret
          
          /** è¯¥clientåè®¸çææç±»å&lt;br&gt;
            * authorization_code: ææç ç±»å; 
            * implicit: éå¼ææç±»å; 
            * password: èµæºææèï¼å³ç¨æ·ï¼å¯ç ç±»å; 
            * client_credentials: å®¢æ·ç«¯å­æ®ï¼å®¢æ·ç«¯IDä»¥åKeyï¼ç±»å; 
            * refresh_token: éè¿ä»¥ä¸ææè·å¾çå·æ°ä»¤çæ¥è·åæ°çä»¤ç; 
            */
          .authorizedGrantTypes("authorization_code") 
          .scopes("app") // åè®¸çææèå´
    .and()
      .withClient("client_pss")
      .secret("client_pss_c")
      .authorizedGrantTypes("password") 
      .scopes("app"); // åè®¸çææèå´
      
  }
  @Bean
  public ClientDetailsService clientDetails() {
      return new JdbcClientDetailsService(dataSource);
  }
</code></pre>
<h3 id="authorizationserverendpointsconfigurer">AuthorizationServerEndpointsConfigurer</h3>
<p>AuthorizationServerEndpointsConfigurer: ç¨æ¥éç½®ææä»¥åä»¤ççè®¿é®ç«¯ç¹åä»¤çæå¡, æ¯å¦: éç½®ä»¤ççç­¾åä¸å­å¨æ¹å¼</p>
<pre><code class="language-java">  /**
    * AuthorizationServerSecurityConfigurer: ç¨æ¥éç½®ä»¤çç«¯ç¹çå®å¨çº¦æ; 
    */
  @Override
  public void configure(AuthorizationServerSecurityConfigurer security) throws Exception {
      /**
        * æå®toket å­å¨
        * endpoints.tokenStore(redisTokenStore())
        * endpoints.tokenStore(jdbcTokenStore() );
        */
      endpoints.tokenStore(jdbcTokenStore() );
      /**
        * password ç±»åè¿éè¦è®¾ç½® authenticationManager
        */
      endpoints.userDetailsService(userDetailsServiceImpl );
      endpoints.authenticationManager(authenticationManager);

  }
</code></pre>
<blockquote>
<p>éè¦æ³¨æä¸ä¸ <code>tokenKeyAccess</code>å<code>checkTokenAccess</code> åè®¸è¢«è®¿é®, ä¸ç¶æ æ³æ£æ¥toket</p>
</blockquote>
<h4 id="ä»¤çççææ¹å¼">ä»¤çççææ¹å¼</h4>
<p><code>tokenGranter</code>å±æ§å¯¹è±¡,<br>
è¿ä¸ªå±æ§å°±å¾çBäº, å½ä½ è®¾ç½®äºè¿ä¸ªä¸è¥¿ï¼å³ TokenGranter æ¥å£å®ç°ï¼, é£ä¹ææå°ä¼äº¤ç±ä½ æ¥å®å¨ææ§, å¹¶ä¸ä¼å¿½ç¥æä¸é¢çè¿å ä¸ªå±æ§, è¿ä¸ªå±æ§ä¸è¬æ¯ç¨ä½æå±ç¨éç, å³æ åçåç§æææ¨¡å¼å·²ç»æ»¡è¶³ä¸äºä½ çéæ±çæ¶å, æä¼èèä½¿ç¨è¿ä¸ª;</p>
<h4 id="ä»¤ççå­å¨æ¹å¼">ä»¤ççå­å¨æ¹å¼</h4>
<p><code>tokenStore</code>å±æ§å¯¹è±¡,é»è®¤æåµéªè¯çtoketä¼ä¿å­å¨åå­ä¸­, è¿æ ·å½æå¡å¨éå¯æ¯, ä¼å¯¼è´æætoketæ æ;<br>
å¨æ­¤å¯ä»¥éç½® å°toketå­å¨å°æ°æ®åºæèredis</p>
<blockquote>
<p>éç½®ä»£ç </p>
</blockquote>
<pre><code class="language-java">    //endpoints.tokenStore(redisTokenStore())
    endpoints.tokenStore(jdbcTokenStore() );
    /**
    * tokenå­å¨æ°æ®åº
    */
    @Bean
    public JdbcTokenStore jdbcTokenStore(){
        return new JdbcTokenStore(dataSource);
    }
     /**
      *  tokenå­å¨redis
      */
    @Autowired
    private RedisConnectionFactory redisConnectionFactory;
    @Bean
    RedisTokenStore redisTokenStore(){
        return new RedisTokenStore(redisConnectionFactory);
    }
</code></pre>
<blockquote>
<p>JDBC å®éè¦è¡¨<code>oauth_client_details</code> spring oauth2 ææé»è®¤è¡¨åèæ«å°¾<strong>spring OAuth2 é»è®¤çè¡¨ç»æ</strong></p>
</blockquote>
<pre><code class="language-sql">  create table oauth_client_token (
    token_id VARCHAR(256),
    token LONG VARBINARY,
    authentication_id VARCHAR(256) PRIMARY KEY,
    user_name VARCHAR(256),
    client_id VARCHAR(256)
  );
</code></pre>
<h4 id="ä»¤ççè®¿é®ç«¯ç¹">ä»¤ççè®¿é®ç«¯ç¹</h4>
<p>AuthorizationServerEndpointsConfigurer è¿ä¸ªéç½®å¯¹è±¡(AuthorizationServerConfigurer çä¸ä¸ªåè°éç½®é¡¹<br>
æä¸ä¸ªå«å pathMapping() çæ¹æ³ç¨æ¥éç½®ç«¯ç¹URLé¾æ¥, å®æä¸¤ä¸ªåæ°:<br>
ç¬¬ä¸ä¸ªåæ°: String ç±»åç, è¿ä¸ªç«¯ç¹URLçé»è®¤é¾æ¥;<br>
ç¬¬äºä¸ªåæ°: String ç±»åç, ä½ è¦è¿è¡æ¿ä»£çURLé¾æ¥;<br>
ä»¥ä¸çåæ°é½å°ä»¥ "/" å­ç¬¦ä¸ºå¼å§çå­ç¬¦ä¸², æ¡æ¶çé»è®¤URLé¾æ¥å¦ä¸åè¡¨, å¯ä»¥ä½ä¸ºè¿ä¸ª pathMapping() æ¹æ³çç¬¬ä¸ä¸ªåæ°:</p>
<pre><code class="language-s">  /oauth/authorize: ææç«¯ç¹; 
  /oauth/token: ä»¤çç«¯ç¹; 
  /oauth/confirm_access: ç¨æ·ç¡®è®¤æææäº¤ç«¯ç¹; 
  /oauth/error: æææå¡éè¯¯ä¿¡æ¯ç«¯ç¹; 
  /oauth/check_token: ç¨äºèµæºæå¡è®¿é®çä»¤çè§£æç«¯ç¹; 
  /oauth/token_key: æä¾å¬æå¯åçç«¯ç¹, å¦æä½ ä½¿ç¨JWTä»¤ççè¯; 
</code></pre>
<h4 id="passwordè®¤è¯æ¹å¼">passwordè®¤è¯æ¹å¼</h4>
<p>è¯·æ³¨æå¦ææ¯<code>password</code>éªè¯æ¹å¼, é£å¿é¡»è¦å¨æ­¤æ³¨å¥ <code>AuthenticationManager </code> éç½®å¯¹è±¡</p>
<pre><code class="language-java">endpoints.userDetailsService(userDetailsServiceImpl );
endpoints.authenticationManager(authenticationManager);
</code></pre>
<h4 id="å¶ä»å±æ§">å¶ä»å±æ§</h4>
<p><code>authorizationCodeServices</code>: è¿ä¸ªå±æ§æ¯ç¨æ¥è®¾ç½®ææç æå¡çï¼å³ AuthorizationCodeServices çå®ä¾å¯¹è±¡ï¼*<strong>ä¸»è¦ç¨äº "authorization_code" ææç ç±»åæ¨¡å¼</strong></p>
<h3 id="demoä»£ç -2">demoä»£ç </h3>
<pre><code class="language-java">  /**
    * AuthorizationServerEndpointsConfigurer: ç¨æ¥éç½®ææä»¥åä»¤ççè®¿é®ç«¯ç¹åä»¤çæå¡ï¼æ¯å¦: éç½®ä»¤ççç­¾åä¸å­å¨æ¹å¼ï¼
    * 
   **/
  @Override
  public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {
    /**
      * æå®toket å­å¨
      * endpoints.tokenStore(redisTokenStore())
      * endpoints.tokenStore(jdbcTokenStore() );
      */
    endpoints.tokenStore(jdbcTokenStore() );
    /**
      * password ç±»åè¿éè¦è®¾ç½® authenticationManager
      */
    endpoints.userDetailsService(userDetailsServiceImpl );
    endpoints.authenticationManager(authenticationManager);
  }
  /**
    * tokenå­å¨æ°æ®åº
    */
  @Bean
  public JdbcTokenStore jdbcTokenStore(){
      return new JdbcTokenStore(dataSource);
  }
  
  /**
    *  tokenå­å¨redis
    
  @Autowired
  private RedisConnectionFactory redisConnectionFactory;
  @Bean
  RedisTokenStore redisTokenStore(){
      return new RedisTokenStore(redisConnectionFactory);
  }
    */
    

</code></pre>
<h3 id="å¦å¤æææå¡ç«¯çéç½®-spring-security">å¦å¤æææå¡ç«¯çéç½® spring security</h3>
<pre><code class="language-java">@Configuration
@EnableWebSecurity
@EnableGlobalMethodSecurity(prePostEnabled = true)
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {
    //spring Security 5.0 ä¹åå¿é¡»æå®å¯ç å å¯è§å, ä¸ç¶ä¼æ¥é
    @Bean
    public static NoOpPasswordEncoder passwordEncoder() {
        return (NoOpPasswordEncoder) NoOpPasswordEncoder.getInstance();
    }

	@Override
	protected void configure(HttpSecurity http) throws Exception {
//		http
//			.authorizeRequests()
//			.antMatchers("/oauth/**").permitAll()//oauth å¼æ¾çèµæº
//			.anyRequest().authenticated()
//			.and()
//			// è®¾ç½®ç»éé¡µ
//			.formLogin().and().logout().permitAll();
		 http
         .requestMatchers().anyRequest()
         .and()
             .authorizeRequests()
             .antMatchers("/oauth/*").permitAll();//oauth å¼æ¾çèµæº
		// å³é­CSRFè·¨å
		http.csrf().disable();

	}
	
	@Override
  @Bean
  public AuthenticationManager authenticationManagerBean() throws Exception {
      return super.authenticationManagerBean();
  }

}

</code></pre>
<p><code>AuthenticationManager</code> beanä¹æ¯å¨è¿ééç½®</p>
<p><strong>åå¦å¤ <code>UserDetailsService</code> ç®ååæ­»åä»£ç </strong></p>
<pre><code class="language-java">@Service
public class UserDetailsServiceImpl implements UserDetailsService{

	@Override
	public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
		// TODO Auto-generated method stub
		if("admin".equals(username) ) {
			return new UserDetailsImpl("admin","123");
		}
		throw new  UsernameNotFoundException(username);
	}

}

</code></pre>
<h2 id="èµæºæå¡è§è²">èµæºæå¡è§è²</h2>
<p>spring oa2 æä¾ <code>ResourceServerConfiguration</code> éç½®ééå¨ç±», æ¥éç½®èµæºæå¡ç«¯è§è²<br>
éå¸¸çåæ³æ¯ åå»ºä¸ä¸ªéç½®ç±» ç»§æ¿èª<code>ResourceServerConfiguration</code>,</p>
<p>è¿æéè¦<code>@EnableResourceServer</code>æ³¨è§£è¡¨æå®æ¯ä¸ä¸ª oauth èµæºæå¡å¨</p>
<pre><code class="language-java">@Configuration
@EnableResourceServer 
public class ResourceServerConfiguration extends ResourceServerConfigurerAdapter  {
  	@Override
	public void configure(ResourceServerSecurityConfigurer resources) throws Exception {
	}

	@Override
	public void configure(HttpSecurity http) throws Exception {
		http.authorizeRequests().anyRequest().authenticated();
	}
}
</code></pre>
<p>ç°å¨æ¥ç ç©¶è¿ä¸¤ä¸ªéç½®:</p>
<h3 id="resourceserversecurityconfigurer">ResourceServerSecurityConfigurer</h3>
<h4 id="demoä»£ç -3">demoä»£ç </h4>
<p><code>resource_id</code> å³æ¯ææç«¯ <code>ClientDetailsServiceConfigurer</code>éç½®çå®¢æ·ç«¯ID</p>
<pre><code class="language-java">	@Value("${security.oauth2.resource.id}")
	String resource_id;

	@Override
	public void configure(ResourceServerSecurityConfigurer resources) throws Exception {
		  resources.resourceId(resource_id).stateless(true);
	}
</code></pre>
<p>å¨æ­¤æä¸ä¸ <code>ResourceServerSecurityConfigurer</code> ç <code>tokenServices</code> å±æ§, ç¨äºéç½®æææå¡çä¿¡æ¯, éç¨èµæºä¸ææåç¦»</p>
<h3 id="httpsecurity">HttpSecurity</h3>
<h3 id="demoä»£ç -4">demoä»£ç </h3>
<pre><code class="language-JAVA">@Configuration
@EnableResourceServer 
public class ResourceServerConfiguration extends ResourceServerConfigurerAdapter  {
	
	@Value("${security.oauth2.resource.id}")
	String resource_id;
	@Override
	public void configure(ResourceServerSecurityConfigurer resources) throws Exception {
		  resources.resourceId(resource_id).stateless(true);
	}
	@Override
	public void configure(HttpSecurity http) throws Exception {
    	http
	        .antMatcher("/protect/**").authorizeRequests()
	        .anyRequest().permitAll();
          /*
		  http
	        .requestMatchers().anyRequest()
	        .and()
	        .anonymous()
	        .and()
	        .authorizeRequests()
//			.antMatchers("/protect/**").access("#oauth2.hasScope('app') and hasRole('ROLE_USER')")
			.antMatchers("/protect/**").authenticated();
      */
	}
	
}

</code></pre>
<h4 id="permitall-å-anonymous">permitAll å anonymous</h4>
<p><code>permitAll()</code> æ¹æ³æææç»å½åæªç»å½äººåé½å¯ä»¥è®¿é®, è¿ä¸ªä¼ç»è¿ security filter<br>
<code>anonymous()</code> ææäººé½è½è®¿é®, ä½æ¯è¿ä¸ªä¸ä¼ç»è¿  security filter</p>
<h3 id="åä¿æ¤çèµæº">åä¿æ¤çèµæº</h3>
<pre><code class="language-java">@RestController
@RequestMapping("/protect")
public class IndexController {
	
	@RequestMapping("/hi")
	public Map&lt;String,String&gt; getForMap(String uri){
		Map&lt;String, String&gt; ret = new HashMap&lt;String, String&gt;();
		ret.put("hi", "è¿æ¯åä¿æ¤çèµæº");
		return ret;
		
	}
	
}

</code></pre>
<h2 id="æµè¯ææç æ¹å¼">æµè¯ææç æ¹å¼</h2>
<h3 id="å®¢æ·ç«¯è·åææcode">å®¢æ·ç«¯è·åææcode</h3>
<p><strong>Get è®¿é®</strong><br>
<code>127.0.0.1:8802/oauth/authorize?client_id=client_abc&amp;client_secret=client_abc_s&amp;response_type=code&amp;redirect_uri=http://www.baidu.com</code></p>
<p>å¦ææªç»é -&gt; ä¼è¢«<code>WebSecurityConfig</code>çå®å¨è¿æ»¤æ¦æªå°,è·³è½¬å°ç»éçé¢(èµ°ä¸è¬çspring securityæµç¨), -&gt; ç»éæåå -&gt;è·³è½¬ Approval ç¨æ·ææé¡µé¢ -&gt; å¦æç¨æ·åæææ -&gt; å°ä¼éå®åå°<code>http://www.baidu.com/?code=Dwps7B</code> codeæ¯ç¨äºç³è¯·toketçææç </p>
<blockquote>
<p>å¦ææ¥é: <code>User must be authenticated with Spring Security before authorization can be completed.</code></p>
</blockquote>
<p>åå æ¯è¢«spring security æ¦æªäº,<code>WebSecurityConfig</code>ç<code>HttpSecurity</code>éç½®å¼æ¾<code>	.antMatchers("/oauth/**").permitAll()</code> URLå¹¶æ²¡æçæ,<br>
ååå æ¯: è¯¥ä¾,å³æ¯æææå¡å¨,åæ¯èµæºæå¡å¨, <code>ResourceServerConfiguration</code> çéç½®è¿æ»¤å¨(order=3)ä¼åäº<code>WebSecurityConfig</code>@Order(100)</p>
<p><code>HttpSecurity.antMatcher(Stiring ...)</code>//è¿ä¸ªæ¹æ³,<strong>ä»å¨å¹éè¯¥uriæ¶è¿ä¸ªè¿æ»¤å¨æä¼è°ç¨(æèçæ)</strong></p>
<pre><code class="language-java">	@Override
	public void configure(HttpSecurity http) throws Exception {
		http
	        .antMatcher("/protect/**").authorizeRequests()
	        .anyRequest().permitAll();
	}
</code></pre>
<h3 id="æ ¹æ®codeè·åtoket">æ ¹æ®codeè·åtoket</h3>
<p><strong>Post è®¿é®</strong><br>
<code>127.0.0.1:8802/oauth/token?client_id=client_abc&amp;client_secret=client_abc_s&amp;grant_type=authorization_code&amp;redirect_uri=http://www.baidu.com&amp;code=Dwps7B</code></p>
<p>ä»¥postè®¿é®éå code ç³è¯·toket:</p>
<pre><code class="language-json">{
    "access_token": "21bc25aa-2aa0-4f81-a6b6-5733081aa2af",
    "token_type": "bearer",
    "expires_in": 43199,//è¿ææ¶é´
    "scope": "app"
}
</code></pre>
<h3 id="æ ¹æ®toketè®¿é®åä¿æ¤çèµæº">æ ¹æ®toketè®¿é®åä¿æ¤çèµæº</h3>
<p><strong>Get è®¿é®</strong><br>
<code>127.0.0.1:8802/protect/hi?access_token=21bc25aa-2aa0-4f81-a6b6-5733081aa2af</code></p>
<pre><code class="language-json">{
    "hi": "è¿æ¯åä¿æ¤çèµæº"
}
</code></pre>
<p>å¦ææ²¡ætoket,æèéè¯¯toket,<code>ResourceServerConfiguration</code>éç½®å®å¨æ¦æªå°.</p>
<h3 id="æ£æ¥toketæææ§">æ£æ¥toketæææ§</h3>
<p><strong>Get è®¿é®</strong><br>
<code>127.0.0.1:8802/oauth/check_token?token=21bc25aa-2aa0-4f81-a6b6-5733081aa2af</code></p>
<pre><code class="language-json">{
    "active": true,
    "exp": 1558725020,
    "user_name": "admin",
    "client_id": "client_abc",
    "scope": [
        "app"
    ]
}
</code></pre>
<h2 id="èµæºæå¡ä¸æææå¡åç¦»">èµæºæå¡ä¸æææå¡åç¦»</h2>
<p>ä¸èµæºæå¡éç½®æè¿: <code>ResourceServerSecurityConfigurer</code></p>
<blockquote>
<p>å¨æ­¤æä¸ä¸ <code>ResourceServerSecurityConfigurer</code> ç <code>tokenServices</code> å±æ§, ç¨äºéç½®æææå¡çä¿¡æ¯, éç¨èµæºä¸ææåç¦»</p>
</blockquote>
<p>RemoteTokenServices , å®å°åè®¸èµæºæå¡å¨éè¿HTTPè¯·æ±æ¥è§£ç ä»¤çï¼ä¹å°±æ¯æææå¡ç /oauth/check_token ç«¯ç¹ï¼; å¦æä½ çèµæºæå¡æ²¡æå¤ªå¤§çè®¿é®éçè¯, é£ä¹ä½¿ç¨RemoteTokenServices å°ä¼å¾æ¹ä¾¿ï¼ææåä¿æ¤çèµæºè¯·æ±é½å°è¯·æ±ä¸æ¬¡æææå¡ç¨ä»¥æ£éªtokenå¼ï¼, æèä½ å¯ä»¥éè¿ç¼å­æ¥ä¿å­æ¯ä¸ä¸ªtokenéªè¯çç»æ;</p>
<p>æ°å»ºä¸ä¸ª</p>
<pre><code class="language-xml">  &lt;dependency&gt;
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt;
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
  &lt;/dependency&gt;
</code></pre>
<pre><code class="language-java">
/**
 * //èµæºæå¡ 
 * åç¦»
 * @author yangfh
 * 2019å¹´5æ20æ¥
*/
@Configuration
@EnableResourceServer 
public class ResourceServerConfiguration extends ResourceServerConfigurerAdapter  {
	
	String resource_id = "client_abc";
	String resource_s = "client_abc_s";
	
	@Override
	public void configure(ResourceServerSecurityConfigurer resources) throws Exception {
		  resources.resourceId(resource_id).stateless(true);
		  resources.tokenServices(remoteTokenServices());
	}
	@Override
	public void configure(HttpSecurity http) throws Exception {
		http
	        .antMatcher("/protect/**").authorizeRequests()
	        .anyRequest().permitAll();
	}
	@Bean
	 public RemoteTokenServices remoteTokenServices() {
		RemoteTokenServices remoteTokenServices = new RemoteTokenServices();
		remoteTokenServices.setClientId(resource_id);
		remoteTokenServices.setClientSecret(resource_s);
		remoteTokenServices.setCheckTokenEndpointUrl("http://127.0.0.1:8802/oauth/check_token");
		return remoteTokenServices;
	 }
} 

</code></pre>
<pre><code class="language-json">{
    "hi": "è¿æ¯åä¿æ¤çèµæº Oauth2ResServerApplication"
}
</code></pre>
<blockquote>
<p><a href="https://www.cnblogs.com/xingxueliao/p/5911292.html" target="_blank">Spring Cloud OAuth2.0</a><br>
<a href="https://www.cnblogs.com/Irving/p/9343377.html" target="_blank">Spring Cloud å¾®æå¡ä¸­æ­å»º OAuth2.0 è®¤è¯æææå¡</a></p>
</blockquote>
<blockquote>
<p><a href="https://github.com/spring-projects/spring-security-oauth/blob/master/spring-security-oauth2/src/test/resources/schema.sql" target="_blank" rel="noopener nofollow">spring OAuth2 é»è®¤çè¡¨ç»æ</a><br>
<a href="schema.sql" target="_blank" rel="noopener nofollow">spring OAuth2 é»è®¤çè¡¨ç»ææ¬å°æä»¶</a></p>
</blockquote>
<h1 id="è¸©åæåspring-admin">è¸©åæå:(spring admin)</h1>
<h2 id="éç½®context-path-ç«¯ç¹è·¯å¾ä¸å¯¹">éç½®context-path ç«¯ç¹è·¯å¾ä¸å¯¹</h2>
<p>å¦æé¡¹ç®éç½®æ server.servlet.context-path å±æ§, æ³è¦è¢« spring boot admin çæ§, å°±è¦å¨å®¢æ·ç«¯()éç½®adminçä»¥ä¸å±æ§(æå®çæ§ç«¯ç¹uri)</p>
<pre><code class="language-yml"># ä¾ server.servlet.context-path=/iot_video_serve/ # ä¸è½/iot_video_serve é£å°±æ¯ç»å¯¹è·¯å¾,
eureka.instance.leaseRenewalIntervalInSeconds=10
eureka.client.serviceUrl.defaultZone=http://192.168.10.140:8761/eureka/
# eureka.client.serviceUrl.defaultZone=http://127.0.0.1:8761/eureka/
eureka.instance.metadata-map.management.context-path=${server.servlet.context-path}actuator
eureka.instance.health-check-url-path=${server.servlet.context-path}actuator/health
eureka.instance.status-page-url-path=${server.servlet.context-path}actuator/info

</code></pre>
<h2 id="for-linux-boot-admin-æªç¥ä¸»æºå¼å¸¸">for linux boot admin æªç¥ä¸»æºå¼å¸¸</h2>
<p>è®¿é®ç±»ä¼¼<code>http://192.168.10.140:8800/instances/b339b067eaa3/actuator/health</code> å®ä¾çæ§ç«¯ç¹æåºæªç¥ä¸»æºå¼å¸¸,<br>
æ æ³è·åå®ä¾çæ§æ°æ®, åå æ¯linux,è¦ææºå¨å æ å°å°æ¬æº, ä¿®æ¹hosts?åé¢åè¯´!(<a href="https://www.jb51.net/article/134954.htm" target="_blank" rel="noopener nofollow">https://www.jb51.net/article/134954.htm</a>)<br>
åè: <a href="https://www.cnblogs.com/yinjihuan/p/10487835.html" target="_blank">https://www.cnblogs.com/yinjihuan/p/10487835.html</a></p>
<p><strong>è¿æä¸ªéç½® å·¨å</strong></p>
<pre><code class="language-c">//éç½®å¨Eureka æ³¨åä¸­å¿ä»¥IPå°åè®¿é®å®ä¾, å¦åä¼ä»¥`ä¸»æºå:ç«¯å£`è®¿é®,
//è¿ä¼é æadminå®ä¾è¿è¡å¨windownsä¸, å¯ä»¥çæ§windownsä¸è¿è¡çå®ä¾, linux æ¾ç¶ä¸æ¯æ windowså¹³å°çä¸»æºå:ç«¯å£,å±åç½è®¿é®åè®®
eureka.instance.prefer-ip-address=true
</code></pre>
<blockquote>
<p><a href="https://www.cnblogs.com/fangwu/p/8975990.html" target="_blank">https://www.cnblogs.com/fangwu/p/8975990.html</a></p>
</blockquote>
<p>ç®åéç½®</p>
<pre><code class="language-s">####### eureka.client #######
spring.application.name=iot_video_server
spring.cloud.refresh.refreshable=none
spring.devtools.restart.enabled=false

eureka.client.serviceUrl.defaultZone=http://192.168.10.140:8761/eureka/
#eureka.client.serviceUrl.defaultZone=http://127.0.0.1:8761/eureka/
eureka.instance.prefer-ip-address=true
eureka.instance.leaseRenewalIntervalInSeconds=10
eureka.instance.metadata-map.management.context-path=${server.servlet.context-path}actuator
eureka.instance.health-check-url-path=${server.servlet.context-path}actuator/health
eureka.instance.status-page-url-path=${server.servlet.context-path}actuator/info
</code></pre>
<p><a href="https://www.cnblogs.com/liukaifeng/p/10052594.html" target="_blank">SpringCloud Eurekaåæ°éç½®é¡¹è¯¦è§£</a></p>
<p>å¦å¤è¿ææ³¨æä¸éç½® ç«¯ç¹åè®¸è·¨å</p>
<pre><code class="language-java">@Configuration
	public static class SecurityPermitAllConfig extends WebSecurityConfigurerAdapter {
		@Override
		protected void configure(HttpSecurity http) throws Exception {
			http.csrf()
	        .ignoringAntMatchers("/actuator/**"); //ç«¯ç¹url å¿½ç¥ csrf

		}
	}
</code></pre>
<h1 id="è¸©åæåeureka">è¸©åæå:(Eureka)</h1>
<h2 id="èªæä¿æ¤æ¨¡å¼">èªæä¿æ¤æ¨¡å¼</h2>
<p>EMERGENCY! EUREKA MAY BE INCORRECTLY CLAIMING INSTANCES ARE UP WHEN THEY'RE NOT. RENEWALS ARE LESSER THAN THRESHOLD AND HENCE THE INSTANCES ARE NOT BEING EXPIRED JUST TO BE SAFE.</p>
<p>é»è®¤æåµä¸, å¦æEureka Serverå¨ä¸å®æ¶é´åæ²¡ææ¥æ¶å°æä¸ªå¾®æå¡å®ä¾çå¿è·³, Eureka Serverå°ä¼æ³¨éè¯¥å®ä¾ï¼é»è®¤90ç§ï¼;</p>
<p>ä½æ¯å½ç½ç»ååºæéåçæ¶, å¾®æå¡ä¸Eureka Serverä¹é´æ æ³æ­£å¸¸éä¿¡, ä»¥ä¸è¡ä¸ºå¯è½åå¾éå¸¸å±é©äºââå ä¸ºå¾®æå¡æ¬èº«å¶å®æ¯å¥åº·ç, æ­¤æ¶æ¬ä¸åºè¯¥æ³¨éè¿ä¸ªå¾®æå¡;<br>
Eurekaéè¿"<code>èªæä¿æ¤æ¨¡å¼</code>"æ¥è§£å³è¿ä¸ªé®é¢ââå½Eureka Serverèç¹å¨ç­æ¶é´åä¸¢å¤±è¿å¤å®¢æ·ç«¯æ¶ï¼å¯è½åçäºç½ç»ååºæéï¼, é£ä¹è¿ä¸ªèç¹å°±ä¼è¿å¥èªæä¿æ¤æ¨¡å¼; ä¸æ¦è¿å¥è¯¥æ¨¡å¼, Eureka Serverå°±ä¼ä¿æ¤æå¡æ³¨åè¡¨ä¸­çä¿¡æ¯, ä¸åå é¤æå¡æ³¨åè¡¨ä¸­çæ°æ®ï¼ä¹å°±æ¯ä¸ä¼æ³¨éä»»ä½å¾®æå¡ï¼; å½ç½ç»æéæ¢å¤å, è¯¥Eureka Serverèç¹ä¼èªå¨éåºèªæä¿æ¤æ¨¡å¼;</p>
<p>ç»¼ä¸, èªæä¿æ¤æ¨¡å¼æ¯ä¸ç§åºå¯¹ç½ç»å¼å¸¸çå®å¨ä¿æ¤æªæ½; å®çæ¶æå²å­¦æ¯å®å¯åæ¶ä¿çææå¾®æå¡ï¼å¥åº·çå¾®æå¡åä¸å¥åº·çå¾®æå¡é½ä¼ä¿çï¼, ä¹ä¸ç²ç®æ³¨éä»»ä½å¥åº·çå¾®æå¡; ä½¿ç¨èªæä¿æ¤æ¨¡å¼, å¯ä»¥è®©Eurekaéç¾¤æ´å çå¥å£®, ç¨³å®;</p>
<pre><code class="language-yml">
eureka.client.registry-fetch-interval-seconds :è¡¨ç¤ºeureka clienté´éå¤ä¹å»æåæå¡æ³¨åä¿¡æ¯, é»è®¤ä¸º30ç§, å¯¹äºapi-gateway, å¦æè¦è¿éè·åæå¡æ³¨åç¶æ, å¯ä»¥ç¼©å°è¯¥å¼, æ¯å¦5ç§
eureka.server.enable-self-preservation=false #æ¯å¦å¼å¯èªæä¿æ¤æ¨¡å¼, é»è®¤ä¸ºtrue; ä¸è¦å¨çäº§ç¯å¢ä¸­ç¦ç¨
eureka.server.eviction-interval-timer-in-ms=60000 #æ¸çæ æèç¹çæ¶é´é´é, é»è®¤60000æ¯«ç§, å³60ç§
</code></pre>
<blockquote>
<p><a href="https://www.jianshu.com/p/c18d140ad9f6" target="_blank" rel="noopener nofollow">https://www.jianshu.com/p/c18d140ad9f6</a></p>
</blockquote>
<h1 id="éå½-springcloud_å±æ§éç½®">éå½ springcloud_å±æ§éç½®</h1>
<p>Part XIX. Appendix: Compendium of Configuration Properties</p>
<p>[[springcloud_ææéç½®é¡¹_application.properties]]</p>


</div>
<div id="MySignature" role="contentinfo">
    é¢é²èå¹´ç´åï¼ä¿æç»èº«å­¦ä¹ !    ââ <a href="https://www.cnblogs.com/dddy/" target="_blank">daidaidaiyu</a>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-13 23:42">2026-02-13 23:42</span>&nbsp;
<a href="https://www.cnblogs.com/dddy">daidaidaiyu</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19613850);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19613850', targetLink: 'https://www.cnblogs.com/dddy/p/19613850', title: 'SpringCloud  å¾®æå¡å®ç°ä¸å (Eureka + Hystrix)' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ 2026å¹´äºèç½è¡ä¸åå¤§ç­é¨è¯é¢ï¼AIçé£ä¸ææ¯å¹³æçåå­è·¯å£ ]]></title>
    <link>https://www.cnblogs.com/nf01/p/19613794</link>
    <guid>4f4d233cd9fbf5651d01054deb68a372</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/nf01/p/19613794" title="åå¸äº 2026-02-13 23:11">
    <span role="heading" aria-level="2">2026å¹´äºèç½è¡ä¸åå¤§ç­é¨è¯é¢ï¼AIçé£ä¸ææ¯å¹³æçåå­è·¯å£</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="å½å¤§æ¨¡åä»å·¥å·è¿åä¸ºä¼ä¼´æä»¬æ­£ç«å¨äºèç½åå²çè½¬æç¹ä¸">å½å¤§æ¨¡åä»"å·¥å·"è¿åä¸º"ä¼ä¼´"ï¼æä»¬æ­£ç«å¨äºèç½åå²çè½¬æç¹ä¸</h1>
<hr>
<blockquote>
<p><em>åå¨åé¢ï¼2026å¹´çäºèç½è¡ä¸ï¼ç­é¹å¾è®©äººæäºåºæ¥ä¸æãä»AI Agentçå¨é¢çåï¼å°å½äº§å¤§æ¨¡åçç¾å®¶äºé¸£ï¼ä»è§é¢çæççé£çªè¿ï¼å°AIç¡¬ä»¶çæç¶å´èµ·ââè¿å¯è½æ¯è¿åå¹´æ¥ææ¯åé©æå¯éçä¸å¹´ãæ¬æ5000ä½å­ï¼å¸¦ä½ ç³»ç»æ§æ¢³çå½ä¸äºèç½è¡ä¸æç­é¨çè¯é¢ï¼æ¢ç©¶ç­æ½®èåçé»è¾ï¼å¹¶å°è¯åç­ä¸ä¸ªæ ¹æ¬é®é¢ï¼è¿ä¸æ¬¡çææ¯æµªæ½®ï¼ç©¶ç«ä¼ææä»¬å¸¦åä½æ¹ï¼</em></p>
</blockquote>
<hr>
<h2 id="ä¸ai-agentä»åç­é®é¢å°ä»£æ¿æä½">ä¸ãAI Agentï¼ä»"åç­é®é¢"å°"ä»£æ¿æä½"</h2>
<p>å¦æè¦ç¨ä¸ä¸ªè¯æ¥å½¢å®¹2026å¹´äºèç½è¡ä¸çä¸»é¢ï¼<strong>AI Agentï¼æºè½ä½ï¼</strong> ç»å¯¹å½ä¹æ æ§ã</p>
<p>è¿è®°å¾2023å¹´ChatGPTæ¨ªç©ºåºä¸æ¶ï¼æä»¬æå¹äºå®è½"åç­é®é¢"ï¼2024å¹´ï¼æä»¬å¼å§ä¹ æ¯å®è½"çæåå®¹"ï¼èå°äº2026å¹´ï¼è¡ä¸ç¦ç¹å·²ç»å®å¨è½¬åââ<strong>AIè½æ¿æ"å¹²æ´»"äºåï¼</strong></p>
<p>ç­æ¡æ¯ï¼ä¸ä»è½ï¼èä¸æ­£å¨å éæ¸éã</p>
<h3 id="11-ä»ä¹æ¯ai-agentç®åæ¥è¯´">1.1 ä»ä¹æ¯AI Agentï¼ç®åæ¥è¯´</h3>
<p>ä¼ ç»AIå©æï¼æ¯å¦Siriãå°ç±åå­¦ï¼æ¯"ä½ é®ä¸å¥ï¼å®ç­ä¸å¥"çäº¤äºæ¨¡å¼ãèAI Agentåå·å¤äº<strong>è§åãå·¥å·ä½¿ç¨ãè®°å¿åèªä¸»å³ç­</strong>åå¤§è½åãä½ å¯ä»¥ç»å®ä¸ä¸ªç®æ ï¼æ¯å¦"å¸®æè®¢ä¸å¼ ä¸å¨å»ä¸æµ·çæºç¥¨ï¼è¦é çªåº§ä½ï¼ä»·æ ¼å¨1500åä»¥å"ï¼ï¼å®ä¼èªå·±åæéæ±ãæç´¢ä¿¡æ¯ãæ¯è¾éé¡¹ãå®ææä½ââå¨ç¨ä¸éè¦ä½ åå¨æã</p>
<h3 id="12-å·¨å¤´é½å¨å¸å±">1.2 å·¨å¤´é½å¨å¸å±</h3>
<p>2026å¹´åï¼OpenAIåå¸äºGPT-5ï¼å¶æ ¸å¿åç¹å°±æ¯<strong>Agentæ¨¡å¼</strong>çå¨é¢åçº§ãç¨æ·åªéç»åºä¸ä¸ªé«å±æ¬¡æä»¤ï¼GPT-5å°±è½èªä¸»æè§£ä»»å¡ãè°ç¨åç§å·¥å·ï¼æµè§å¨ãææ¡£ãä»£ç ç¼è¯å¨ç­ï¼ãåæ­¥æ§è¡ï¼æç»äº¤ä»å®æ´ç»æã</p>
<blockquote>
<p><em>"æä»¬å¸æè®©AIæä¸ºä½ ç'æ°å­åå·¥'ï¼èä¸ä»ä»æ¯'æ°å­ç¾ç§å¨ä¹¦'ã"</em> ââ OpenAI CEO Sam Altman</p>
</blockquote>
<p>å½åè¿è¾¹ï¼ç¾åº¦ç"æå¿ä¸è¨"ãå­èç"è±å"ãé¿éç"éä¹åé®"é½å¨å¿«éè¿­ä»£Agentè½åãç¾åº¦æ´æ¯å°Agentæ¦å¿µèå¥äºæç´¢åå°å¾äº§åï¼ååºäº"æç´¢å³æå¡"çå£å·ã</p>
<h3 id="13-ä¸ºä»ä¹2026å¹´æ¯agentåå¹´">1.3 ä¸ºä»ä¹2026å¹´æ¯Agentåå¹´ï¼</h3>
<p><strong>ä¸ä¸ªæ¡ä»¶çæçï¼</strong></p>
<ol>
<li><strong>å¤§æ¨¡åè½åè·å</strong>ï¼æ¨çææ¬å¤§å¹ä¸éï¼æ¨¡åååºéåº¦å å¿«ï¼å¤æ¨¡æè½åå¢å¼º</li>
<li><strong>å·¥å·çæå®å</strong>ï¼æµè§å¨èªå¨åãAPIæ¥å£ãæä»¶ç³»ç»æä½ç­åºç¡è®¾æ½æ¥è¶æç</li>
<li><strong>ç¨æ·éæ±è§é</strong>ï¼996æµªæ½®ä¸ everyoneé½å¨å¯»æ¾"æçè§£è¯"ï¼èæ¿ä»¬æ¸´æAIå¸®èªå·±æå·¥</li>
</ol>
<p><strong>ä¸å¥è¯æ»ç»ï¼</strong> 2026å¹´ï¼AIä¸ååªæ¯"åºç­æº"ï¼èæ¯å¼å§çæ­£"å¹²æ´»"äºãè¿ä¸è½¬åçå½±åï¼å¯è½æ¯å½å¹´ç§»å¨äºèç½çè¯çè¿è¦æ·±è¿ã</p>
<hr>
<h2 id="äºå½äº§å¤§æ¨¡åç¾å®¶äºé¸£ä¸æ·æ±°èµå¹¶è¡">äºãå½äº§å¤§æ¨¡åï¼ç¾å®¶äºé¸£ä¸æ·æ±°èµå¹¶è¡</h2>
<h3 id="21-ç¾æ¨¡å¤§æè¿å¥ä¸ååº">2.1 "ç¾æ¨¡å¤§æ"è¿å¥ä¸ååº</h3>
<p>2024å¹´ï¼å½åå¤§æ¨¡åèµéå¯ä»¥ç¨"ç¯ç"æ¥å½¢å®¹ââæ®ä¸å®å¨ç»è®¡ï¼é£ä¸å¹´ååºäºè¶è¿200ä¸ªå¤§æ¨¡åãä½å°äº2026å¹´ï¼å§ææ¥è½¬ç´ä¸ï¼<strong>æ´»ä¸æ¥çä¸è¶è¿20å®¶ï¼å¶ä»çé½æäº"ç®ç°"ã</strong></p>
<p>è¿ä¸æ¯å±è¨è¸å¬ã2025å¹´ä¸åå¹´å¼å§ï¼æèµäººåå¾å¼å¸¸å·éãé£äº"PPTèèµ"ãDemoæ¼äº®ä½è½å°å°é¾çå¬å¸ï¼è¦ä¹è¢«è¿«åå¹¶ï¼è¦ä¹æç¶éåºãå¹¸å­èæä¸¤ç±»ï¼</p>
<ul>
<li><strong>æåºæ¯ç</strong>ï¼å­èï¼è±å+é£ä¹¦ï¼ãé¿éï¼éä¹+ééï¼ãç¾åº¦ï¼æå¿+æç´¢ï¼</li>
<li><strong>æèµéç</strong>ï¼æºè°±AIãMiniMaxãé¶è·æè¾°</li>
</ul>
<h3 id="22-deepseekå¸¦æ¥çå²å»æ³¢">2.2 DeepSeekå¸¦æ¥çå²å»æ³¢</h3>
<p>2025å¹´æ«ï¼ä¸å¹é»é©¬æåºéå´ââ<strong>DeepSeek</strong>ã</p>
<p>è¿ä¸ªç±å½åå¢éæé çå¤§æ¨¡åï¼å¨å¤é¡¹åºåæµè¯ä¸­é¼è¿GPT-4æ°´å¹³ï¼ä½æ¨çææ¬åªæå¯¹æ¹ç1/10ãæ´éè¦çæ¯ï¼DeepSeekéæ©äº<strong>å¼æº</strong>è·¯çº¿ï¼å¼æ¾äºæ¨¡åæéåææ¯æ¥åã</p>
<blockquote>
<p><em>"æä»¬å¸æè®©æ¯ä¸å®¶ä¸­å½å¬å¸é½ç¨å¾èµ·é¡¶çº§AIã"</em> ââ DeepSeekåå§äºº</p>
</blockquote>
<p>æ­¤ä¸¾ç´æ¥ç¹çäºè¡ä¸ä»·æ ¼æãåå¤§ååè¢«è¿«è·è¿ï¼APIè°ç¨ä»·æ ¼ä¸éåéãæäººè¯´DeepSeekæ¯"è¡ä¸å¬æ"ï¼ä¹æäººè¯´å®æ¯"æ®æ åé"ãæ è®ºå¦ä½ï¼<strong>2026å¹´ï¼å¤§æ¨¡åç"å¹³ææ¶ä»£"ççæ¥äºã</strong></p>
<h3 id="23-åºç¨å±çæºä¼å¨åªé">2.3 åºç¨å±çæºä¼å¨åªéï¼</h3>
<p>åºå±æ¨¡åçç«äºè¶äºç½ç­åï¼ä½æèµäººçæ­£å³å¿çï¼æ¯<strong>åºç¨å±</strong>ççåã</p>
<p>ç®åæ¥çï¼è½å°æå¿«çèµéåæ¬ï¼</p>
<ul>
<li><strong>AIåä½/åå¬</strong>ï¼WPS AIãNotion AIãç§å¡åä½ç«</li>
<li><strong>AIç¼ç¨</strong>ï¼CursorãDevinï¼ç¡è°·ææäº§åï¼ãå½ååç§"AIç¨åºå"</li>
<li><strong>AIæè²</strong>ï¼ä½ä¸å¸®AIãç¿è¾å¯¼AIãå°ç¿AI</li>
<li><strong>AIè¥é</strong>ï¼åç§AIçæææ¡ãå¾çãè§é¢çå·¥å·</li>
</ul>
<p><strong>ç»è®ºï¼ä¸å¶å·æ¨¡åï¼ä¸å¦å·åºç¨ã</strong> 2026å¹´ï¼è¿å¥è¯æ­£å¨æä¸ºè¡ä¸å±è¯ã</p>
<hr>
<h2 id="ä¸è§é¢çæsoraä¸åæ¯å¯ä¸ç­æ¡">ä¸ãè§é¢çæï¼Soraä¸åæ¯å¯ä¸ç­æ¡</h2>
<h3 id="31-æå­çæè§é¢è¿å¥å®ç¨é¶æ®µ">3.1 "æå­çæè§é¢"è¿å¥å®ç¨é¶æ®µ</h3>
<p>2024å¹´åï¼OpenAIåå¸Soraï¼æ¼ç¤ºäº60ç§é«æ¸è§é¢çæè½åï¼å¨ä¸çä¸ºä¹éå¨ãä¸¤å¹´åçä»å¤©ï¼Soraæ©å·²ä¸æ¯å¯ä¸éé¡¹ã</p>
<p><strong>å½åç©å®¶éä½ååï¼</strong></p>
<ul>
<li><strong>å¿«æå¯çµ</strong>ï¼ä¸»æ"äººäººå¯ç¨"ï¼çæéåº¦æå¿«ï¼å·²è¿­ä»£å°2.0çæ¬</li>
<li><strong>å­èå³æ¢¦</strong>ï¼èé æé³çæï¼ä¸é®çæç­è§é¢ç´ æ</li>
<li><strong>MiniMax</strong>ï¼å¨é¿è§é¢çææ¹é¢æç¬ç¹ä¼å¿</li>
<li><strong>Runway Gen-3</strong>ï¼ä¾ç¶æ¯å¨çåä½èçé¦éå·¥å·</li>
</ul>
<h3 id="32-è¡ä¸å½±åå½±è§å¶ä½æ­£å¨è¢«éå¡">3.2 è¡ä¸å½±åï¼å½±è§å¶ä½æ­£å¨è¢«éå¡</h3>
<p>è¿å»ï¼ä¸æ¯30ç§çå¹¿åçï¼ä»åæå°æçå¯è½éè¦ä¸å¨ãèè´¹æ°ä¸åãå¦ä»ï¼<strong>ç¨AIçæè§é¢ç´ æ+äººå·¥åæè°æ´ï¼2å°æ¶å°±è½æå®</strong>ï¼ææ¬ä¸è¶³åæ¥ç1/10ã</p>
<p>è¿æå³çä»ä¹ï¼</p>
<ul>
<li><strong>ç­è§é¢åä½è</strong>ï¼åä¹ä¸ç¨ä¸ºç´ æåæï¼AIå¸®ä½ "é "</li>
<li><strong>MCNæºæ</strong>ï¼ä¸äºº+AI = è¿å»ä¸ä¸ªå¢éççäº§å</li>
<li><strong>ä¸­å°å¹¿åå¬å¸</strong>ï¼ç»äºè½ç¨å¾èµ·"å¤§ççº§"ææ</li>
</ul>
<p>å½ç¶ï¼<strong>"AIçæè§é¢"ç®åä»æææ¾ç­æ¿</strong>ï¼</p>
<ul>
<li>ç©çè§å¾ææ¡ä¸åï¼ç©ä½ç©¿æ¨¡ãæ¶²ä½åå½¢ç­é®é¢å¸¸è§ï¼</li>
<li>äººç©ä¸è´æ§é¾ä»¥ç»´æï¼çæå¤éå¤´æ¶è¸ä¼åï¼</li>
<li>çæäºè®®ä¸æ­ï¼è®­ç»æ°æ®æ¥æºé®é¢ï¼</li>
</ul>
<h3 id="33-2026å¹´ä¸ä¸ªäººäººé½æ¯å¯¼æ¼çæ¶ä»£æ­£å¨éä¸´">3.3 2026å¹´ï¼ä¸ä¸ª"äººäººé½æ¯å¯¼æ¼"çæ¶ä»£æ­£å¨éä¸´</h3>
<p>å½ææ¯é¨æ§è¶³å¤ä½ï¼åæå°æä¸ºå¯ä¸çç¨ç¼ºèµæºãè¿å¥è¯è¯´äºåå¹´ï¼ç°å¨ç»äºè¦å®ç°äºã</p>
<hr>
<h2 id="åaiç¡¬ä»¶é¤äºææºåçµèè¿æä»ä¹">åãAIç¡¬ä»¶ï¼é¤äºææºåçµèï¼è¿æä»ä¹ï¼</h2>
<h3 id="41-ai-pinåäºä½æ¹åæ²¡é">4.1 AI Pinï¼åäºï¼ä½æ¹åæ²¡é</h3>
<p>2024å¹´ï¼AI Pinï¼å¦Humane PinãRabbit R1ï¼æ¦å¿µçç«ï¼è¢«è®¤ä¸ºæ¯"æ¿ä»£ææº"çä¸ä¸ä»£ç¡¬ä»¶ãç¶èç°å®å¾æ®é·ï¼<strong>AI Pinå¸åºè¡¨ç°æ¨æ·¡</strong>ï¼åºè´§éè¿ä½äºé¢æã</p>
<p>åå ä¸å¤æï¼<strong>åè½ææºé½è½åï¼åç¬ç¡¬ä»¶æ²¡å¿è¦ï¼äº¤äºä½éªä¸å¤èªç¶ï¼ç»­èªååç­é®é¢ä¸¥éã</strong></p>
<h3 id="42-aiç¼é2026å¹´æ°é£å£">4.2 AIç¼éï¼2026å¹´æ°é£å£ï¼</h3>
<p>ä½èµæ¬æ²¡ææ­»å¿ã2026å¹´ï¼<strong>AIç¼é</strong>æä¸ºæ°ç¦ç¹ã</p>
<p><strong>Metaä¸Ray-Banåä½çAIç¼é</strong>å·²ç»è¿­ä»£å°ç¬¬ä¸ä»£ï¼æ¯æå®æ¶ç¿»è¯ãç©ä½è¯å«ãè¯­é³å©æç­åè½ãæåä¼¯æ ¼æ­è¨ï¼"ç¼éæ¯AIæåéçè½½ä½ï¼å ä¸ºå®ç¦»ç¼çæè¿ãç¦»è³æµæè¿ã"</p>
<p>å½åç©å®¶é»é£èå¨ï¼</p>
<ul>
<li><strong>å°ç±³</strong>ï¼è¢«ææ­£å¨ç åAIç¼éï¼å®ä½"å¹´è½»äººçç¬¬ä¸ä¸ªAIè®¾å¤"</li>
<li><strong>å­è</strong>ï¼éè¿æèµæ¹å¼å¸å±AR/VRç¡¬ä»¶</li>
<li><strong>åä¸º</strong>ï¼Mateç³»ååç»­å¯è½éæAIç¼éåè½</li>
</ul>
<h3 id="43-æºå¨äººä»æ¦å¿µå°ä¸å²">4.3 æºå¨äººï¼ä»"æ¦å¿µ"å°"ä¸å²"</h3>
<p>é¤äºç©¿æ´è®¾å¤ï¼<strong>AIæºå¨äºº</strong>ä¹å¨2026å¹´å éè½å°ã</p>
<ul>
<li><strong>ç¹æ¯æOptimus</strong>ï¼å·²ç»å¨å·¥å"æå·¥"ï¼è¿è¡ç®åè£éå·¥ä½</li>
<li><strong>æ³¢å£«é¡¿å¨åAtlas</strong>ï¼å®£å¸è¿å¥åä¸åé¶æ®µ</li>
<li><strong>å½åä¼å¿éãè¾¾é¼ç§æ</strong>ï¼å¨æå¡æºå¨äººé¢åæç»­çªç ´</li>
</ul>
<blockquote>
<p><em>"æªæ¥åå¹´ï¼æ¯ä¸ªå®¶åº­å¯è½é½ä¼æä¸å°æºå¨äººã"</em> ââ é©¬æ¯åé¢æµ</p>
</blockquote>
<p><strong>ä½è¯·æ³¨æï¼</strong> ç®åè½åç¨çæºå¨äººä¸»è¦è¿æ¯"ä¸ç¨å"ï¼æ«å°çæ«å°ãæ¬è´§çæ¬è´§ï¼ï¼"éç¨å"å®¶åº­æºå¨äººç¦»æä»¬è¿æè·ç¦»ã</p>
<hr>
<h2 id="äºaiçç®¡ä¸æ°æ®å®å¨å½ææ¯è·å¾æ¯æ³å¾å¿«">äºãAIçç®¡ä¸æ°æ®å®å¨ï¼å½ææ¯è·å¾æ¯æ³å¾å¿«</h2>
<h3 id="51-å¨ççç®¡å é">5.1 å¨ççç®¡å é</h3>
<p>2026å¹´ï¼AIçç®¡ä¸åæ¯"çº¸ä¸è°åµ"ã</p>
<ul>
<li><strong>æ¬§çAIæ³æ¡</strong>ï¼2025å¹´æ­£å¼çæï¼å¯¹é«é£é©AIåºç¨å®æ½ä¸¥æ ¼çç®¡</li>
<li><strong>ç¾å½</strong>ï¼åå·åå«ç«æ³ï¼å å·èµ°äºæåæ²¿</li>
<li><strong>ä¸­å½</strong>ï¼ç½ä¿¡ååå¸ãçæå¼AIç®¡çåæ³ãåçº§çï¼å¼ºè°åå®¹æ è¯åçæä¿æ¤</li>
</ul>
<h3 id="52-çææäºææ¼æç">5.2 çææäºææ¼æç</h3>
<p>AIè®­ç»æ°æ®ççæé®é¢ï¼å·²ç»ä»"å­¦æ¯è®¨è®º"åçº§ä¸º"åä¸æäº"ã</p>
<ul>
<li><strong>å¥½è±å vs AIå¬å¸</strong>ï¼å¤èµ·éä½è¯è®¼æ­£å¨è¿è¡ä¸­</li>
<li><strong>æå­å·¥ä½èèç</strong>ï¼è¦æ±AIå¬å¸æ¯ä»ç¨¿é¬</li>
<li><strong>é³ä¹è¡ä¸</strong>ï¼AIçæé³ä¹æ³æ»¥ï¼Spotifyç­å¹³å°è¢«è¦æ±ä¸æ¶</li>
</ul>
<p><strong>ä¸ä¸ªæææçæè®ºï¼</strong></p>
<blockquote>
<p>AIå¬å¸è¯´ï¼"æä»¬ç¨å¬å¼æ°æ®è®­ç»ï¼æ¯åçä½¿ç¨ã"<br>
çææ¹è¯´ï¼"ä½ ç'å¬å¼'æ²¡ç»è¿æåæã"</p>
</blockquote>
<p>è¿åºäºè®ºï¼2026å¹´ä¸ä¼æç­æ¡ï¼ä½ä¸å®ä¼è¶æ¥è¶æ¿çã</p>
<h3 id="53-aiæ±¡æè¢«å¿½è§çå±æº">5.3 "AIæ±¡æ"ï¼è¢«å¿½è§çå±æº</h3>
<p>è¿æä¸ä¸ªè¢«ä½ä¼°çè¯é¢ï¼<strong>AIçæåå®¹çæ±¡æé®é¢</strong>ã</p>
<p>å½äºèç½ä¸AIçæçåå®¹è¶æ¥è¶å¤ï¼<strong>"äººç±»æ°æ®æ¯ç«­"</strong>æ­£å¨æä¸ºæ°çç¦èãå¦ææ¨¡åç»§ç»­ç¨AIçæçæ°æ®è®­ç»ï¼ä¼å¯¼è´"æ¨¡åå´©æº"ï¼model collapseï¼ãå¦ä½åºå"äººç±»æºæ§"å"æºå¨æµæ°´è´¦"ï¼å°æä¸ºå¹³å°åçç®¡æ¹çæ ¸å¿ææã</p>
<hr>
<h2 id="å­ç¤¾äº¤ä¸åå®¹å¹³å°æµééæ°åé">å­ãç¤¾äº¤ä¸åå®¹å¹³å°ï¼æµééæ°åé</h2>
<h3 id="61-ç­è§é¢èµéçç»å±">6.1 ç­è§é¢èµéçç»å±ï¼</h3>
<p>2026å¹´ï¼ç­è§é¢æ±æ¹å·²ç»è¶äºç¨³å®ï¼</p>
<ul>
<li><strong>æé³+TikTok</strong>ï¼å¨çå¶é¸</li>
<li><strong>å¿«æ</strong>ï¼ä¸æ²å¸åºç¨³å¦èç</li>
<li><strong>è§é¢å·</strong>ï¼ä¾æå¾®ä¿¡çææç»­å¢é¿</li>
<li><strong>å°çº¢ä¹¦</strong>ï¼ä»"ç§èç¤¾åº"è¿åä¸º"æç´¢å¥å£"ï¼DAUå±¡åæ°é«</li>
</ul>
<p>æè¶£çæ¯ï¼<strong>"æç´¢"æ­£å¨åå½</strong>ãå¹´è½»äººä¸ååªä¾èµç®æ³æ¨èï¼èæ¯ä¸»å¨å¨å°çº¢ä¹¦ãæé³ä¸"æç­æ¡"ãè¿è®©ç¾åº¦æç¹å°´å°¬ï¼ä¹è®©åå®¹å¹³å°çå°äºæ°çåä¸åç©ºé´ã</p>
<h3 id="62-ç§å¯ç¤¾äº¤åæ¸©">6.2 ç§å¯ç¤¾äº¤åæ¸©</h3>
<p>ä¸æ­¤åæ¶ï¼<strong>ç§å¯ç¤¾äº¤</strong>æ­£å¨å¤å´ã</p>
<ul>
<li><strong>Discord</strong>ï¼ä»æ¸¸æç¤¾åºæ©å±ä¸º"å´è¶£é£å°"</li>
<li><strong>Telegram</strong>ï¼ä»è´¹åè½ä¸çº¿ï¼ç¨æ·ä¸ååå¢</li>
<li><strong>åç§"å°ç¾¤"ç¤¾äº¤</strong>ï¼å¾®ä¿¡ç¾¤ãSlack WorkspaceãDiscordæå¡å¨â¦â¦</li>
</ul>
<p><strong>é»è¾å¾å¥½çè§£ï¼</strong> å¬å±å¹³å°çåªé³å¤ªå¤§äºï¼äººä»¬æ¸´æ"å®éçå°åå­"ã</p>
<h3 id="63-åä½èç»æµ20">6.3 åä½èç»æµ2.0</h3>
<p>"ææå¹³å°é½å¨æ¢åä½è"ââè¿å·²ç»ä¸æ¯æ°é»ï¼ä½2026å¹´çæ°ååæ¯ï¼</p>
<ul>
<li><strong>å¹³å°åææ¯ä¾ä¸è°</strong>ï¼æé³ãBç«çº·çº·"è®©å©"</li>
<li><strong>åä½èä¿é©</strong>åºç°ï¼å¹³å°å¼å§ä¸ºåä½èæä¾å»çãå»èä¿é</li>
<li><strong>AIè¾å©å·¥å·æ®å</strong>ï¼ä¸ä¸ªäººå°±æ¯ä¸æ¯å¢é</li>
</ul>
<p><strong>"äººäººé½æ¯åä½è"çæ¶ä»£ï¼åå®¹ä¾ç»ä¸¥éè¿å©ââæä¹åï¼ç­æ¡åªæä¸ä¸ªï¼å·è´¨éã</strong></p>
<hr>
<h2 id="ä¸èªå¨é©¾é©¶è½å°æ¯é¢æå¿«">ä¸ãèªå¨é©¾é©¶ï¼è½å°æ¯é¢æå¿«</h2>
<h3 id="71-l3çº§èªå¨é©¾é©¶2026å¹´æç">7.1 L3çº§èªå¨é©¾é©¶ï¼2026å¹´æç</h3>
<p>2026å¹´ï¼<strong>L3çº§èªå¨é©¾é©¶</strong>ï¼ææ¡ä»¶èªå¨åï¼å¨ç¹å®è·¯æ®µå¯ä»¥è±æï¼ç»äºå¨ä¸­å½è½å°ï¼</p>
<ul>
<li><strong>åä¸ºé®ç</strong>ï¼ADS 3.0çæ¬æ¨éï¼çé«éNOAå¨å½é</li>
<li><strong>èæ¥NOP+</strong>ï¼åå¸NOAåè½å¼æ¾</li>
<li><strong>å°é¹XNGP</strong>ï¼æç»­è¿­ä»£ï¼ä½éªæ¥è¿"èå¸æº"</li>
</ul>
<p><strong>ä½è¯·æ³¨æï¼</strong> L3ä»ç¶æä¸¥æ ¼çä½¿ç¨æ¡ä»¶ï¼é«éå¬è·¯ãå¿«éè·¯ãå¤©æ°è¯å¥½ç­ï¼ï¼å®å¨"æ äººé©¾é©¶"ï¼L4/L5ï¼è¿è¿ã</p>
<h3 id="72-åä¸åç ´å±">7.2 åä¸åç ´å±</h3>
<p>Robotaxiï¼æ äººåºç§è½¦ï¼ä¹å¨å éï¼</p>
<ul>
<li><strong>ç¾åº¦èåå¿«è·</strong>ï¼å¤ä¸ªåå¸åä¸åè¿è¥</li>
<li><strong>Waymo</strong>ï¼å¨ç¾å½æç»­æ©å¼ </li>
<li><strong>Cruise</strong>ï¼è½ç¶2024å¹´åºäºå®å¨äºæï¼ä½2026å¹´å·²æ¢å¤è¿è¥</li>
</ul>
<p><strong>ä¸ä¸ªæè¶£çç°è±¡ï¼</strong> 2026å¹´å¾å¤äººå¼å§è®¨è®º"è¦ä¸è¦ä¹°è½¦"ãå½Robotaxiè¶³å¤ä¾¿å®ä¸æ¹ä¾¿ï¼å»è½¦çææ¬ï¼åè½¦ãä¿é©ãæ²¹è´¹/çµè´¹ï¼ä¼¼ä¹è¶æ¥è¶ä¸åç®ã</p>
<hr>
<h2 id="å«web3ä¸åºåé¾å·é¨ä½æ²¡æ­»">å«ãWeb3ä¸åºåé¾ï¼å·é¨ä½æ²¡æ­»</h2>
<h3 id="81-æ¯ç¹å¸ä»æ³¡æ²«å°èµäº§">8.1 æ¯ç¹å¸ï¼ä»"æ³¡æ²«"å°"èµäº§"</h3>
<p>2026å¹´ï¼æ¯ç¹å¸ä¾ç¶æ¯æ"åºå"çå å¯èµäº§ãè½ç¶ä»·æ ¼æ³¢å¨å§çï¼ä½<strong>ä¸»æµæºææ¥çº³åº¦æç»­æé«</strong>ï¼</p>
<ul>
<li>è´è±å¾·ãå¯è¾¾ç­ä¼ ç»éèå·¨å¤´ç»§ç»­å¸å±å å¯èµäº§</li>
<li>æ´å¤çETFäº§åä¸çº¿</li>
<li>çè³æå½å®¶ï¼å¦è¨å°ç¦å¤ï¼ææ¯ç¹å¸å®ä¸ºæ³å®è´§å¸</li>
</ul>
<h3 id="82-web3åºç¨ä»å¨æ¢ç´¢">8.2 Web3åºç¨ï¼ä»å¨æ¢ç´¢</h3>
<p>"Web3å»ä¸­å¿åäºèç½"çæ¿æ¯ï¼ç®åæ¥çä¾ç¶é¥è¿ã<strong>DeFiï¼å»ä¸­å¿åéèï¼ãNFTãGameFi</strong> è¿äºæ¦å¿µç»åè¿å±±è½¦è¡æï¼æ³¡æ²«ç ´äºä¸æ¹åä¸æ¹ã</p>
<p>ä½åºå±ææ¯å¨è¿æ­¥ï¼</p>
<ul>
<li><strong>Layer 2è§£å³æ¹æ¡</strong>è®©ä»¥å¤ªåæ´å¿«ãæ´ä¾¿å®</li>
<li><strong>ZKï¼é¶ç¥è¯è¯æï¼</strong> ææ¯å¼å§åºç¨äºéç§è®¡ç®</li>
<li><strong>å»ä¸­å¿åèº«ä»½ï¼DIDï¼</strong> å¨ä¸äºåç´åºæ¯è½å°</li>
</ul>
<p><strong>æ»ç»ï¼Web3ä¸æ¯åäºï¼èæ¯ä»"ææºæ³¡æ²«"åå½"ææ¯åºå»º"ã</strong></p>
<hr>
<h2 id="ä¹è¿ç¨åå¬ä¸åä½å¸¸æåççº¢å©">ä¹ãè¿ç¨åå¬ä¸åä½ï¼å¸¸æåççº¢å©</h2>
<h3 id="91-æ··ååå¬æä¸ºæ é">9.1 æ··ååå¬æä¸ºæ é</h3>
<p>2026å¹´ï¼<strong>"ä¸å¤©åå¬å®¤+ä¸¤å¤©å¨å®¶"</strong> å·²ç»æä¸ºå¤§å¤æ°ç¥è¯å·¥ä½èçå¸¸æã</p>
<ul>
<li><strong>Slackãé£ä¹¦ãéé</strong>ï¼åè½è¶æ¥è¶å¼ºå¤§ï¼ææ¡£ãå®¡æ¹ãä¼è®®ãOKRå¨è¦ç</li>
<li><strong>NotionãConfluence</strong>ï¼ç¥è¯ç®¡çæä¸ºä¼ä¸ç"åºç¡è®¾æ½"</li>
<li><strong>FigmaãMiro</strong>ï¼å¨çº¿åä½å·¥å·è®©"å¼å°è®¾è®¡"æä¸ºå¯è½</li>
</ul>
<h3 id="92-aiåäºæ¥äº">9.2 "AIåäº"æ¥äº</h3>
<p>æ´å³é®çååæ¯ï¼<strong>ä½ çåäºå¯è½ä¸å¨æ¯"äºº"äºã</strong></p>
<ul>
<li><strong>AIä¼è®®çºªè¦</strong>ï¼èªå¨çæä¼è®®æè¦ãå¾åäºé¡¹</li>
<li><strong>AIå¨æ¥</strong>ï¼èªå¨æ±æ»ä½ ä¸å¨çå·¥ä½åå®¹</li>
<li><strong>AIå®¢æ</strong>ï¼7Ã24å°æ¶å¨çº¿ï¼è§£ç­éå¤é®é¢</li>
</ul>
<p><strong>2026å¹´çèåºçå­æ³åï¼</strong> è¦ä¹ä½ ä¼ç¨AIï¼è¦ä¹ä½ è¢«ä¼ç¨AIçäººåä»£ã</p>
<hr>
<h2 id="åäºè®¡ç®ä¸åºç¡è®¾æ½aiæ¶ä»£çåé²äºº">åãäºè®¡ç®ä¸åºç¡è®¾æ½ï¼AIæ¶ä»£ç"åé²äºº"</h2>
<h3 id="101-äºååçaiè½¬å">10.1 äºååç"AIè½¬å"</h3>
<p>AIçåå¸¦æ¥å·¨å¤§çç®åéæ±ï¼äºååèµå¾çæ»¡éµæ»¡ã</p>
<ul>
<li><strong>AWSãAzureãé¿éäº</strong>ï¼AIç®åæä¸ºå¢é¿æå¿«çä¸å¡çº¿</li>
<li><strong>GPUç§èµ</strong>æä¸ºæ°ç­ç¹ï¼A100ãH100æ¾å¡ä¸å¡é¾æ±</li>
<li><strong>è¾¹ç¼è®¡ç®</strong>åæ¸©ï¼AIæ¨çæ­£å¨ä»äºç«¯èµ°åç»ç«¯</li>
</ul>
<h3 id="102-å½äº§æ¿ä»£å é">10.2 "å½äº§æ¿ä»£"å é</h3>
<p>åå°ç¼æ¿æ²»å½±åï¼<strong>å½äº§è¯ç</strong>çéæ±æ´æ¶¨ï¼</p>
<ul>
<li><strong>åä¸ºæè¾</strong>ï¼æç»­è¿­ä»£ï¼é¨ååºæ¯å¯æ¿ä»£è±ä¼è¾¾</li>
<li><strong>å¯æ­¦çºªãæ¯åå¾®</strong>ï¼å½äº§AIè¯çååè·å¾æ´å¤å¸åºæºä¼</li>
<li><strong>ç®åç§èµå¹³å°</strong>ï¼å¸®å©ä¸­å°ä¼ä¸"ç¨å¾èµ·"AI</li>
</ul>
<p><strong>ä¸å¥è¯ï¼AIæ¶ä»£çåºç¡è®¾æ½ï¼æ°¸è¿æ¯"ç¡¬éè´§"ã</strong></p>
<hr>
<h2 id="ç»è¯­ç«å¨æµªæ½®ä¹å·æä»¬å¨ç­å¾ä»ä¹">ç»è¯­ï¼ç«å¨æµªæ½®ä¹å·ï¼æä»¬å¨ç­å¾ä»ä¹ï¼</h2>
<p>åå°è¿éï¼ä½ ä¼åç°2026å¹´çäºèç½è¡ä¸åç°åºä¸ä¸ªæ¸æ°çå¾æ¯ï¼<strong>AIä»"å·¥å·"è¿åä¸º"ä¼ä¼´"ï¼ææ¯åæ°ä»"å°æ°äººçæ¸¸æ"èµ°å"æ®æ æ¶ä»£"ã</strong></p>
<p>ä½ç¹è£ä¹ä¸ï¼ä¹æéå¿§ï¼</p>
<ul>
<li>AIççæãä¼¦çãçç®¡é®é¢æ¥çå°é</li>
<li>æµéçº¢å©è§é¡¶ï¼å¢éç«äºè½¬åå­éåå¼</li>
<li>å¨çç»æµä¸ç¡®å®æ§ä¾ç¶å­å¨ï¼èµæ¬å¸åºè¶äºä¿å®</li>
</ul>
<p><strong>ä½ä¸ºä¸ä¸ªæ®éç¨æ·ãä¸ä¸ªä»ä¸èãä¸ä¸ªå³æ³¨ç§æçäººï¼æä»¬åºè¯¥å¦ä½çå¾è¿ä¸åï¼</strong></p>
<p>æçç­æ¡æ¯ï¼<strong>ä¿æå¥½å¥ï¼ä¿æè­¦æï¼ä¿æè¡å¨ã</strong></p>
<p>ææ¯æµªæ½®ä¸å¯é»æ¡ï¼ä½æ¯ä¸æ¬¡æµªæ½®é½æ¯ä¸æ¬¡éæ°æ´ççæºä¼ãçæ­£å¼é±çä¸æ¯ææ¯æ¬èº«ï¼èæ¯<strong>ç¨ææ¯è§£å³çå®é®é¢çè½å</strong>ã</p>
<blockquote>
<p><em>"æªæ¥å·²ç»å°æ¥ï¼åªæ¯åå¸ä¸åã"</em> ââ ç§å¹»ä½å®¶å¨å»Â·åå¸æ£®</p>
</blockquote>
<hr>
<h2 id="-äºå¨æ¶é´">ð¢ äºå¨æ¶é´</h2>
<p>è¯»å®è¿ç¯æç« ï¼ä½ æå³æ³¨åªä¸ªè¯é¢ï¼</p>
<ul>
<li>A. AI Agentââææå¾"AIå¸®ææå·¥"</li>
<li>B. å½äº§å¤§æ¨¡åââæ³æ¯æå½è´§ä½ä¸ç¥éæä¹é</li>
<li>C. è§é¢çæââæ³è¯è¯å"AIå¯¼æ¼"</li>
<li>D. AIç¡¬ä»¶ââç­å¾ä¸ä¸ª"åæ¶ä»£"çäº§å</li>
<li>E. èªå¨é©¾é©¶ââå³å¿ä»ä¹æ¶åè½çæ­£"è±æ"</li>
<li>F. å¶ä»ââè¯è®ºåºèè</li>
</ul>
<p><strong>ä¹æ¬¢è¿ä½ å¨è¯è®ºåºåäº«ï¼2026å¹´ï¼ä½ ææ³ç¨AIå¸®ä½ åä»ä¹ï¼</strong></p>
<blockquote>
<p><em>å¦æä½ è§å¾è¿ç¯æç« æå¸®å©ï¼æ¬¢è¿ç¹ä¸ªèµãå¨çãè½¬åéç»æåãä½ çæ¯ææ¯ææç»­è¾åºçå¨åã</em></p>
</blockquote>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-13 23:11">2026-02-13 23:11</span>&nbsp;
<a href="https://www.cnblogs.com/nf01">åå¤«è¿ç»´</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19613794);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19613794', targetLink: 'https://www.cnblogs.com/nf01/p/19613794', title: '2026å¹´äºèç½è¡ä¸åå¤§ç­é¨è¯é¢ï¼AIçé£ä¸ææ¯å¹³æçåå­è·¯å£' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Vue3è§£æå­¦ä¹  - handlers æ¨¡å ]]></title>
    <link>https://www.cnblogs.com/aleafshit/p/19613786</link>
    <guid>63d30612fbedd7bf5eeaccd41e9322f8</guid>
    <description>
    <![CDATA[ 
            <div class="postcontent">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æ¬¢è¿å¤§å®¶äº¤æµè®¨è®ºï¼ä¹æ¬¢è¿æåºé®é¢æä¸åè§ç¹ãæ¬æåºäºä¸ªäººå¯¹æºç ççè§£ä¸æ´çï¼é¾åå­å¨åå·®æä¸å®æ´ä¹å¤ï¼å¦æä½ ææ´æ·±å¥çè§è§£æåç°éè¯¯ï¼æå¾ä¸èµ·æ¢è®¨ä¸ä¿®æ­£ã</p>
<hr>
<h1 id="ä¸handlers-çæ ¸å¿è®¾è®¡ç®æ ">ä¸ãhandlers çæ ¸å¿è®¾è®¡ç®æ </h1>
<p>ä¸å¥è¯æ»ç»ï¼</p>
<blockquote>
<p>ä¸åæ°æ®ç»æï¼ç¨ä¸åçä»£çç­ç¥ï¼åå°âæå°æ¦æª + ç²¾ç¡®è§¦åâã</p>
</blockquote>
<p>ååºå¼ç³»ç»æ¬è´¨ä¸æ¯ä¸¤ä»¶äºï¼</p>
<ol>
<li>
<p><strong>ä¾èµæ¶éï¼trackï¼</strong>ï¼è¯»åæ¶è®°å½ä¾èµ</p>
</li>
<li>
<p><strong>å¯ä½ç¨è§¦åï¼triggerï¼</strong>ï¼åå¥æ¶è§¦åæ´æ°</p>
</li>
</ol>
<p>ä½ä¸åç±»åçæ°æ®ï¼</p>
<ul>
<li>
<p>åæ´æ¹å¼ä¸å</p>
</li>
<li>
<p>å¯æ¦æªè½åä¸å</p>
</li>
</ul>
<p>å æ­¤ Vue æä»£çé»è¾ææä¸å¥ï¼</p>
<table>
<thead>
<tr>
<th>ç±»å</th>
<th>åæ´æ¹å¼</th>
<th>Proxy è½å</th>
<th>æ¹æ¡</th>
</tr>
</thead>
<tbody>
<tr>
<td>Object</td>
<td>å±æ§èµå¼</td>
<td>å¯å®æ´æ¦æª</td>
<td>baseHandlers</td>
</tr>
<tr>
<td>Array</td>
<td>å±æ§ + æ¹æ³</td>
<td>æ¹æ³æ æ³ç´æ¥æ¦æª</td>
<td>éåæ°ç»æ¹æ³</td>
</tr>
<tr>
<td>Map/Set</td>
<td>æ¹æ³é©±å¨</td>
<td>åªè½æ¦æª get</td>
<td>è¿åéåæ¹æ³</td>
</tr>
</tbody>
</table>
<p>è¿ä¸æ¯âå¤æâï¼èæ¯å¯¹ JavaScript è¯­ä¹è¾¹ççå·¥ç¨å¦¥åã</p>
<hr>
<h1 id="äºobjectç±»ç»§æ¿ä½ç³»">äºãObjectï¼ç±»ç»§æ¿ä½ç³»</h1>
<p>Object ç handler å¨ <code>baseHandlers.ts</code> ä¸­ï¼éè¿ç±»ç»§æ¿ç»ç»ï¼</p>
<h2 id="1-basereactivehandleræ½è±¡åºç±»">1. BaseReactiveHandlerï¼æ½è±¡åºç±»ï¼</h2>
<p>è¿æ¯ç»ä¸å¥å£ï¼è´è´£ï¼</p>
<ul>
<li>
<p>get æ¦æª</p>
</li>
<li>
<p>ref è§£å</p>
</li>
<li>
<p>æ·±/æµååºå¼éå½</p>
</li>
<li>
<p>ä¾èµæ¶é</p>
</li>
</ul>
<p>æ ¸å¿èè´£ï¼</p>
<pre><code class="language-bash">è®¿é®å±æ§ â track â è¿åååºå¼å¼
</code></pre>
<hr>
<h2 id="2-mutablereactivehandlerå¯åå¯¹è±¡">2. MutableReactiveHandlerï¼å¯åå¯¹è±¡ï¼</h2>
<p>è¿æ¯æå¸¸è§ç reactive çæ¬ï¼</p>
<h3 id="set">set</h3>
<p>è§¦åä¸¤ç§æä½ç±»åï¼</p>
<ul>
<li>
<p>TriggerOpTypes.ADDï¼æ°å¢å±æ§ï¼</p>
</li>
<li>
<p>TriggerOpTypes.SETï¼ä¿®æ¹å·²æå±æ§ï¼</p>
</li>
</ul>
<p>åºå ADD / SET çæä¹å¨äºï¼</p>
<pre><code class="language-bash">æ°å¢å±æ§ â  ä¿®æ¹å±æ§
</code></pre>
<p>æäºä¾èµåªå³å¿ç»æååï¼æ¯å¦ for...inãObject.keysï¼ã</p>
<hr>
<h3 id="deleteproperty">deleteProperty</h3>
<p>è§¦åï¼</p>
<pre><code class="language-bash">TriggerOpTypes.DELETE
</code></pre>
<hr>
<h3 id="has">has</h3>
<p>ç¨äºï¼</p>
<pre><code class="language-bash">key in obj
</code></pre>
<p>ä¾èµæ¶éï¼</p>
<pre><code class="language-bash">TrackOpTypes.HAS
</code></pre>
<hr>
<h3 id="ownkeys">ownKeys</h3>
<p>ç¨äºï¼</p>
<pre><code class="language-bash">for...in / Object.keys / Reflect.ownKeys
</code></pre>
<p>ä¾èµæ¶éï¼</p>
<pre><code class="language-bash">TrackOpTypes.ITERATE
</code></pre>
<p>è¿ä¸æ­¥æ¯å¾å¤äººå¿½ç¥çå³é®ï¼</p>
<blockquote>
<p>éåç»ææ¬èº«ä¹æ¯ä¾èµã</p>
</blockquote>
<hr>
<h2 id="3-readonlyreactivehandleråªè¯»">3. ReadonlyReactiveHandlerï¼åªè¯»ï¼</h2>
<p>åªè¯»çæ¬ç´æ¥é»æ­åæä½ï¼</p>
<ul>
<li>
<p>set â è­¦å + ä¸æ§è¡</p>
</li>
<li>
<p>deleteProperty â è­¦å + ä¸æ§è¡</p>
</li>
</ul>
<p>ä½ <strong>è¯»åä»ç¶ä¼ track</strong>ã</p>
<p>å ä¸ºåªè¯»ä¸ç­äºâæ ä¾èµâã</p>
<hr>
<h1 id="ä¸arrayæ¹æ³éåç­ç¥">ä¸ãArrayï¼æ¹æ³éåç­ç¥</h1>
<p>æ°ç»çé®é¢å¨äºï¼</p>
<blockquote>
<p>å¤§é¨ååæ´ä¸æ¯éè¿å±æ§èµå¼ï¼èæ¯éè¿æ¹æ³ã</p>
</blockquote>
<p>ä¾å¦ï¼</p>
<pre><code class="language-bash">arr.push()
arr.splice()
arr.shift()
</code></pre>
<p>Proxy æ æ³ç´æ¥æ¦æªæ¹æ³è°ç¨ã</p>
<p>Vue3 çæ¹æ¡æ¯ï¼</p>
<blockquote>
<p>å¨ get trap ä¸­è¿åâéåçæ¬âçæ°ç»æ¹æ³ã</p>
</blockquote>
<hr>
<h2 id="arrayinstrumentationsts">arrayInstrumentations.ts</h2>
<p>è¿åâéåçæ¬âçæ¹æ³å¯¹è±¡ã</p>
<p>å½è®¿é®æ°ç»æ¹æ³æ¶ï¼</p>
<pre><code class="language-bash">proxy.push
</code></pre>
<p>BaseReactiveHandler ç get trap ä¼å¤æ­ï¼</p>
<pre><code class="language-bash">æ¯ä¸æ¯æ°ç»ï¼
æ¯ä¸æ¯è¢«éåçæ¹æ³ï¼
</code></pre>
<p>å¦ææ¯ï¼</p>
<p>â è¿åâéåçæ¬âæ¹æ³</p>
<p>è¿äºæ¹æ³åé¨ï¼</p>
<ol>
<li>
<p>åæåä¾èµæ¶éï¼é¿åæ­»å¾ªç¯ï¼</p>
</li>
<li>
<p>è°ç¨åå§æ°ç»æ¹æ³</p>
</li>
<li>
<p>æå¨ trigger</p>
</li>
</ol>
<p>è¿å°±æ¯ï¼</p>
<blockquote>
<p>ç¨å½æ°åè£æ¨¡æâæ¹æ³æ¦æªâã</p>
</blockquote>
<hr>
<h1 id="åmap--setå·¥åå½æ°ä½ç³»">åãMap / Setï¼å·¥åå½æ°ä½ç³»</h1>
<p>éåç±»åæ¯æ°ç»æ´æç«¯ï¼</p>
<blockquote>
<p>ææåæ´é½éè¿æ¹æ³ã</p>
</blockquote>
<pre><code class="language-bash">map.set()
map.delete()
set.add()
</code></pre>
<p>Proxy è½æ¦æªçåªæï¼</p>
<pre><code class="language-bash">get
</code></pre>
<p>å æ­¤ Vue éç¨çº¯å·¥åå½æ°æ¨¡å¼ï¼èä¸æ¯ç±»ç»§æ¿ã</p>
<hr>
<h2 id="1-åªæ¦æª-get">1. åªæ¦æª get</h2>
<p>collectionHandlers çç­ç¥ï¼</p>
<pre><code class="language-bash">get â è¿åéååçæ¹æ³
</code></pre>
<p>åæ°ç»ç±»ä¼¼ï¼ä½æ´å½»åºã</p>
<hr>
<h2 id="2-åç§-handler-ç»å">2. åç§ handler ç»å</h2>
<p>åå»ºå¯¼åº 4 ä¸ªå¨å±ä»£çå¯¹è±¡ï¼</p>
<ol>
<li>
<p>mutableCollectionHandlersï¼æ·±ååºå¼ï¼</p>
</li>
<li>
<p>shallowCollectionHandlersï¼æµååºå¼ï¼</p>
</li>
<li>
<p>readonlyCollectionHandlersï¼åªè¯»ï¼</p>
</li>
<li>
<p>shallowReadonlyCollectionHandlersï¼æµåªè¯»ï¼</p>
</li>
</ol>
<p>è¿äºä¸æ¯æåçï¼èæ¯éè¿ï¼</p>
<pre><code class="language-bash">createInstrumentationsGetter(isReadonly, shallow)
</code></pre>
<p>å¨æçæã</p>
<hr>
<h2 id="3-createinstrumentations-æ ¸å¿å·¥å">3. createInstrumentations æ ¸å¿å·¥å</h2>
<p>è¿ä¸ªå·¥åå½æ°è´è´£ï¼</p>
<ul>
<li>
<p>æé éååç Map/Set æ¹æ³</p>
</li>
<li>
<p>å¨æ¹æ³åé¨è®¿é®åå§å¯¹è±¡</p>
</li>
</ul>
<p>å³é®ç¹ï¼</p>
<pre><code class="language-bash">ReactiveFlags.RAW â æ¿å°åå§æ°æ®
</code></pre>
<p>é¿åä»£çå¥ä»£çå¯¼è´çéå½é®é¢ã</p>
<hr>
<h1 id="äºtrack--trigger-çç²¾ç»æ§å¶">äºãTrack / Trigger çç²¾ç»æ§å¶</h1>
<p>è¿æ¯ Vue 3 ååºå¼ç³»ç»ççµé­æ¹è¿ä¹ä¸ã</p>
<p>è¯»åæä½è¢«åä¸ºï¼</p>
<ul>
<li>
<p>GET</p>
</li>
<li>
<p>HAS</p>
</li>
<li>
<p>ITERATE</p>
</li>
</ul>
<p>åå¥æä½è¢«åä¸ºï¼</p>
<ul>
<li>
<p>SET</p>
</li>
<li>
<p>ADD</p>
</li>
<li>
<p>DELETE</p>
</li>
</ul>
<p>å®ä»¬ä¸æ¯ç®åçä¸å¯¹ä¸å³ç³»ã</p>
<hr>
<h2 id="ç²¾ç¡®è§¦åçæä¹">ç²¾ç¡®è§¦åçæä¹</h2>
<p>å³é®è§åï¼</p>
<blockquote>
<p>å¹¶ä¸æ¯ææåæä½é½åºè¯¥è§¦åææä¾èµã</p>
</blockquote>
<p>ä¾å¦ï¼</p>
<ul>
<li>
<p>GET ä¾èµåªå³å¿ SET</p>
</li>
<li>
<p>ITERATE ä¾èµå³å¿ ADD / DELETE</p>
</li>
<li>
<p>HAS ä¾èµåªå³å¿ key æ¯å¦å­å¨</p>
</li>
</ul>
<p>å¦æä¸åºåï¼</p>
<pre><code class="language-bash">ä»»ä½åæä½ â å¨é¨ effect è§¦å
</code></pre>
<p>è¿ä¼å¯¼è´ï¼</p>
<ul>
<li>
<p>ä¸å¿è¦çéæ¸²æ</p>
</li>
<li>
<p>æ§è½éªå´©</p>
</li>
<li>
<p>å¯ä½ç¨é£æ´</p>
</li>
</ul>
<p>Vue 2 çååºå¼å°±å±äºç²ç²åº¦è§¦åã</p>
<p>Vue 3 ç handlers è®¾è®¡æ¬è´¨æ¯ï¼</p>
<blockquote>
<p>æâè¯»ç±»åâåâåç±»åâå»ºç«æ å°å³ç³»ã</p>
</blockquote>


</div>
<div class="clear"></div>

            </div>
            <div class="itemdesc">
                åè¡¨äº 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-13 23:03">2026-02-13 23:02</span>&nbsp;
<a href="https://www.cnblogs.com/aleafshit">death_ray</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19613786);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19613786', targetLink: 'https://www.cnblogs.com/aleafshit/p/19613786', title: 'Vue3è§£æå­¦ä¹  - handlers æ¨¡å' })">ä¸¾æ¥</a>

            </div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ åå¸å­å­çç¬¬ä¸ä¸ªBç«è§é¢ï¼æåç¥å¤§å®¶æ¥èå¿«ä¹ï¼ ]]></title>
    <link>https://www.cnblogs.com/cmt/p/19613749</link>
    <guid>ac279bb9fd354533ef538d311b4102d3</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/cmt/p/19613749" title="åå¸äº 2026-02-13 22:42">
    <span role="heading" aria-level="2">åå¸å­å­çç¬¬ä¸ä¸ªBç«è§é¢ï¼æåç¥å¤§å®¶æ¥èå¿«ä¹ï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>å­å­å¥é©»Bç«å¦ï¼ä»å¤©åå¸äºç¬¬ä¸ä¸ªè§é¢ï¼æåç¥å¤§å®¶æ¥èå¿«ä¹ï¼æ¬¢è¿å¤§å®¶åå¾Bç«æ§åºï¼</p>
<p><iframe src="https://player.bilibili.com/player.html?isOutside=true&amp;bvid=BV1UVcEzJEUD&amp;p=1&amp;autoplay=0" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" width="668" height="376"></iframe></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-13 22:43">2026-02-13 22:42</span>&nbsp;
<a href="https://www.cnblogs.com/cmt">åå®¢å­å¢é</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19613749);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19613749', targetLink: 'https://www.cnblogs.com/cmt/p/19613749', title: 'åå¸å­å­çç¬¬ä¸ä¸ªBç«è§é¢ï¼æåç¥å¤§å®¶æ¥èå¿«ä¹ï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ãAzure App Serviceã32ä½ Windows App Service æå¤§è½ä½¿ç¨å¤å°åå­ï¼ ]]></title>
    <link>https://www.cnblogs.com/lulight/p/19613358</link>
    <guid>8bbb8e2ef5cc93bff1ec97e99650e503</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/lulight/p/19613358" title="åå¸äº 2026-02-13 19:13">
    <span role="heading" aria-level="2">ãAzure App Serviceã32ä½ Windows App Service æå¤§è½ä½¿ç¨å¤å°åå­ï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="é®é¢æè¿°">é®é¢æè¿°</h2>
<p>å¨ä½¿ç¨ Windows-based Azure Web Appï¼32ä½ï¼æ¶ï¼ç»å¸¸éå°ä»¥ä¸çé®ï¼</p>
<ul>
<li>è¿ç¨åå­ä¸éæ¯å¤å°ï¼</li>
<li>ä¸åæç®¡æ¨¡å¼ä¸å¯ç¨åå­å¦ä½è®¡ç®ï¼</li>
</ul>
<p>æ¬æå°éå¯¹è¿äºé®é¢è¿è¡è¯¦ç»è§£ç­ã<br>
<img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2127802/202602/2127802-20260213191205856-103002667.png" class="lazyload"></p>
<hr>
<h2 id="é®é¢è§£ç­">é®é¢è§£ç­</h2>
<h3 id="ä¸32-ä½ç¨åºæå¤§è½ä½¿ç¨å¤å°åå­">ä¸ã32 ä½ç¨åºæå¤§è½ä½¿ç¨å¤å°åå­ï¼</h3>
<p><strong>çè®ºä¸éçº¦ä¸º 4GB</strong></p>
<p>32 ä½ç¨åºçåå­å°åç± 32 ä¸ªäºè¿å¶ä½ç»æï¼å æ­¤çè®ºä¸å¯ä»¥æ 2Â³Â² = 4,294,967,296 ç§ä¸åçåå­å°åãæ¯ä¸ªåå­å°åæå 1 Byte çç©ºé´ï¼æä»¥ï¼</p>
<blockquote>
<p>32 ä½å°åç©ºé´ = 2Â³Â² Byte (4<em>1024</em>1024*1024 B) â 4GB</p>
</blockquote>
<p><strong>ä¸ºä»ä¹ææ¡£ä¸­æå° 2GBï¼</strong></p>
<p>Windows é»è®¤å° 4GB èæå°åç©ºé´ååä¸ºï¼</p>
<ul>
<li><strong>2GB ç¨æ·æ</strong>ï¼ä¾åºç¨ç¨åºä½¿ç¨</li>
<li><strong>2GB åæ ¸æ</strong>ï¼ä¾æä½ç³»ç»ä½¿ç¨</li>
</ul>
<p>å æ­¤ï¼é»è®¤æåµä¸åè¿ç¨å¯ç¨ç¨æ·æåå­ä¸º <strong>2GB</strong>ãè¿åªæ¯é»è®¤è¡ä¸ºï¼å¹¶é 32 ä½ç¨åºçç»å¯¹ä¸éãå¨æäºæåµä¸ï¼ä¾å¦å¯ç¨ Large Address Aware + ç¹å®ç³»ç»éç½®ï¼ï¼å¯ä»¥è¶è¿ 2GBã</p>
<hr>
<h3 id="äºin-process-ä¸-out-of-process-æ¨¡åå¯¹åå­çå½±å">äºãIn-Process ä¸ Out-Of-Process æ¨¡åå¯¹åå­çå½±å</h3>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2127802/202602/2127802-20260213191223025-396603613.png" class="lazyload"></p>
<h4 id="ä¸¤ç§æç®¡æ¨¡å¼å¯¹æ¯">ä¸¤ç§æç®¡æ¨¡å¼å¯¹æ¯</h4>
<table>
<thead>
<tr>
<th>ç¹æ§</th>
<th>In-Process</th>
<th>Out-of-Process</th>
</tr>
</thead>
<tbody>
<tr>
<td>å®¿ä¸»è¿ç¨</td>
<td><code>w3wp.exe</code>ï¼IIS å·¥ä½è¿ç¨ï¼</td>
<td><code>dotnet.exe</code>ï¼ç¬ç«è¿ç¨ï¼</td>
</tr>
<tr>
<td>è¿ç¨æ°é</td>
<td>åºç¨ä¸ IIS å±äº«åä¸è¿ç¨</td>
<td>åºç¨è¿è¡å¨ç¬ç«è¿ç¨ä¸­</td>
</tr>
<tr>
<td>åå­éç¦»</td>
<td>ä¸ IIS å±äº«åå­ç©ºé´</td>
<td>ç¬ç«åå­ç©ºé´</td>
</tr>
<tr>
<td>æ§è½</td>
<td>æ´é«ï¼æ è¿ç¨é´éä¿¡å¼éï¼</td>
<td>ç¥ä½ï¼ééè¿ HTTP ä»£çï¼</td>
</tr>
</tbody>
</table>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2127802/202602/2127802-20260213191243339-1051852491.png" class="lazyload"></p>
<h4 id="in-process-æ¨¡å¼åå­è¡ä¸º">In-Process æ¨¡å¼åå­è¡ä¸º</h4>
<ul>
<li>åºç¨ä»£ç ç´æ¥è¿è¡å¨ <code>w3wp.exe</code> è¿ç¨ä¸­</li>
<li>åå­ä¸éå <code>w3wp.exe</code> è¿ç¨éå¶ï¼
<ul>
<li>32 ä½ï¼çº¦ <strong>2GB</strong>ï¼Windows ç¨æ·æé»è®¤éå¶ï¼</li>
<li>64 ä½ï¼å Sandbox éå¶</li>
</ul>
</li>
<li><strong>æ³¨æ</strong>ï¼åºç¨åå­ + IIS æ¨¡ååå­ å±åå ç¨è¿ç¨ç©ºé´</li>
</ul>
<h4 id="out-of-process-æ¨¡å¼åå­è¡ä¸º">Out-of-Process æ¨¡å¼åå­è¡ä¸º</h4>
<ul>
<li>åºç¨è¿è¡å¨ç¬ç«ç <code>dotnet.exe</code> è¿ç¨ä¸­</li>
<li>Kestrel ä½ä¸ºè¾¹ç¼æå¡å¨ï¼IIS ä»ä½ä¸ºååä»£ç</li>
<li>åå­ä¸éç¬ç«è®¡ç®ï¼
<ul>
<li>32 ä½ï¼çº¦ <strong>4GB</strong>ï¼å¯å¯»åä¸éï¼</li>
<li>64 ä½ï¼å Sandbox éå¶</li>
</ul>
</li>
</ul>
<h4 id="azure-app-service-sandbox-éå¶">Azure App Service Sandbox éå¶</h4>
<p>å¨ Azure App Service ä¸­ï¼å­å¨ä¸ä¸ªæ ¸å¿éå¶ï¼</p>
<blockquote>
<p><strong>Sandbox éå¶</strong>ï¼è¿ç¨å®éè½è·å¾çæå¤§ç©çåå­ = æºå¨ç©çåå­ Ã 75%</p>
</blockquote>
<table>
<thead>
<tr>
<th>App Service Plan</th>
<th>ç©çåå­</th>
<th>64ä½è¿ç¨å¯ç¨åå­ï¼çº¦ï¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>B1/S1</td>
<td>1.75 GB</td>
<td>~1.3 GB</td>
</tr>
<tr>
<td>B2/S2</td>
<td>3.5 GB</td>
<td>~2.6 GB</td>
</tr>
<tr>
<td>B3/S3</td>
<td>7 GB</td>
<td>~5.25 GB</td>
</tr>
<tr>
<td>P1v2</td>
<td>3.5 GB</td>
<td>~2.6 GB</td>
</tr>
<tr>
<td>P2v2</td>
<td>7 GB</td>
<td>~5.25 GB</td>
</tr>
<tr>
<td>P3v2</td>
<td>14 GB</td>
<td>~10.5 GB</td>
</tr>
</tbody>
</table>
<p><strong>æ»ç»ï¼</strong></p>
<ul>
<li><strong>32 ä½è¿ç¨</strong>ï¼æ°¸è¿æ æ³çªç ´çº¦ 4GB çå¯å¯»åéå¶ï¼åæç®¡æ¨¡å¼å½±åä¸å¤§ï¼</li>
<li><strong>64 ä½è¿ç¨</strong>ï¼ä¼è§¦å Sandbox éå¶ï¼æå¤§çº¦ä¸ºç©çåå­ç 75%ï¼</li>
</ul>
<hr>
<h3 id="ä¸å¤ä¸ªèæç®å½æ¶çåå­è®¡ç®æ¹å¼">ä¸ãå¤ä¸ªèæç®å½æ¶çåå­è®¡ç®æ¹å¼</h3>
<p>å½åä¸ App Service ä¸å­å¨å¤ä¸ªèæç®å½ï¼vdirï¼æ¶ï¼</p>
<h4 id="in-process-æ¨¡å¼">In-Process æ¨¡å¼</h4>
<ul>
<li>ææèæç®å½å±äº«åä¸ä¸ª <code>w3wp.exe</code> è¿ç¨</li>
<li>åå­ä¸éä¸ºè¯¥è¿ç¨çæ»ä¸éï¼32ä½çº¦2GBï¼64ä½åSandboxéå¶ï¼</li>
<li>ååºç¨é´æ åå­éç¦»ï¼ä¸ä¸ªåºç¨åå­æ³æ¼å¯è½å½±åå¶ä»åºç¨</li>
</ul>
<h4 id="out-of-process-æ¨¡å¼">Out-of-Process æ¨¡å¼</h4>
<ul>
<li>æ¯ä¸ªèæç®å½ä¼çæç¬ç«ç <code>dotnet.exe</code> è¿ç¨</li>
<li>æ¯ä¸ªè¿ç¨åç¬è®¡ç®å¯ç¨åå­ä¸éï¼
<ul>
<li>32 ä½ â çº¦ 4GBï¼å®éå¯è½æ´ä½ï¼åå³äºç³»ç»éç½®ï¼</li>
<li>64 ä½ â å Sandbox éå¶ï¼æºå¨åå­ Ã 75%ï¼</li>
</ul>
</li>
<li>å¤ä¸ªç«ç¹å±äº«åä¸å° VM çç©çåå­ï¼è¿ç¨é´ä¼ç¸äºç«äºèµæº</li>
<li><strong>ä¼å¿</strong>ï¼è¿ç¨éç¦»ï¼ä¸ä¸ªåºç¨å´©æºä¸å½±åå¶ä»åºç¨</li>
</ul>
<hr>
<h3 id="åscmkuduè¿ç¨æ¯å¦è®¡å¥æ»åå­">åãSCMï¼Kuduï¼è¿ç¨æ¯å¦è®¡å¥æ»åå­ï¼</h3>
<p><strong>æ¯ç</strong>ãSCM è¿ç¨ä¹è¿è¡å¨åä¸å° VM ä¸ï¼å¶åå­å ç¨ä¼ä¸å¹¶è®¡å¥ App Service Plan çç©çåå­ä½¿ç¨éã</p>
<p><strong>Kudu å¸ååå­å ç¨</strong>ï¼çº¦ 200MB - 500MBï¼è§æä½èå®ï¼</p>
<hr>
<h3 id="äºå¦ä½çæ§-app-service-åå­ä½¿ç¨">äºãå¦ä½çæ§ App Service åå­ä½¿ç¨ï¼</h3>
<h4 id="æ¹æ³ä¸azure-portal-ææ ">æ¹æ³ä¸ï¼Azure Portal ææ </h4>
<p>å¨ Azure Portal ä¸­æ¥ç App Service ç <strong>Metrics</strong>ï¼</p>
<ul>
<li><code>Memory working set</code>ï¼å½åå·¥ä½éåå­</li>
<li><code>Private Bytes</code>ï¼è¿ç¨ç§æåå­</li>
</ul>
<h4 id="æ¹æ³äºkudu-è¿ç¨ç®¡çå¨">æ¹æ³äºï¼Kudu è¿ç¨ç®¡çå¨</h4>
<p>è®¿é® <code>https://&lt;your-app&gt;.scm.chinacloudsites.cn/ProcessExplorer/</code> æ¥çï¼</p>
<ul>
<li>åè¿ç¨çåå­å ç¨è¯¦æ</li>
<li><code>w3wp.exe</code> å <code>dotnet.exe</code> çå®æ¶åå­ç¶æ</li>
</ul>
<h4 id="æ¹æ³ä¸application-insights">æ¹æ³ä¸ï¼Application Insights</h4>
<p>å¯ç¨ Application Insights åï¼å¯çæ§ï¼</p>
<ul>
<li>åå­ä½¿ç¨è¶å¿</li>
<li>åå­å¼å¸¸åè­¦</li>
<li>GC è¡ä¸ºåæ</li>
</ul>
<hr>
<h2 id="æ»ç»">æ»ç»</h2>
<table>
<thead>
<tr>
<th>åºæ¯</th>
<th>åå­ä¸é</th>
</tr>
</thead>
<tbody>
<tr>
<td>32 ä½è¿ç¨ï¼çè®ºï¼</td>
<td>~4GB</td>
</tr>
<tr>
<td>32 ä½è¿ç¨ï¼Windows é»è®¤ï¼</td>
<td>~2GB</td>
</tr>
<tr>
<td>64 ä½è¿ç¨</td>
<td>ç©çåå­ Ã 75%</td>
</tr>
<tr>
<td>In-Processï¼32ä½ï¼</td>
<td>~2GBï¼ä¸IISå±äº«ï¼</td>
</tr>
<tr>
<td>Out-of-Processï¼32ä½ï¼</td>
<td>~4GBï¼ç¬ç«è¿ç¨ï¼</td>
</tr>
</tbody>
</table>
<p><strong>å»ºè®®</strong>ï¼</p>
<ol>
<li>å¦æåºç¨å¯¹åå­éæ±è¾é«ï¼æ¨èä½¿ç¨ <strong>64 ä½</strong> éç½®</li>
<li>å¯¹äºéè¦è¿ç¨éç¦»çåºæ¯ï¼éæ© <strong>Out-of-Process</strong> æ¨¡å¼</li>
<li>å®æçæ§åå­ä½¿ç¨ï¼é¿åè§¦åä¸éå¯¼è´åºç¨å¼å¸¸</li>
</ol>
<hr>
<h2 id="åèèµæ">åèèµæ</h2>
<ul>
<li>
<p>Virtual Address Space (Memory Management) : <a href="https://learn.microsoft.com/en-us/windows/win32/memory/virtual-address-space" target="_blank" rel="noopener nofollow">https://learn.microsoft.com/en-us/windows/win32/memory/virtual-address-space</a></p>
</li>
<li>
<p>.NET GC - Heap hard limit percent : <a href="https://learn.microsoft.com/en-us/dotnet/core/runtime-config/garbage-collector#heap-hard-limit-percent" target="_blank" rel="noopener nofollow">https://learn.microsoft.com/en-us/dotnet/core/runtime-config/garbage-collector#heap-hard-limit-percent</a></p>
</li>
<li>
<p>ASP.NET Core Module (In-Process vs Out-of-Process) : <a href="https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/aspnet-core-module" target="_blank" rel="noopener nofollow">https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/aspnet-core-module</a></p>
</li>
<li>
<p>Azure App Service Sandbox : <a href="https://github.com/projectkudu/kudu/wiki/Azure-Web-App-sandbox" target="_blank" rel="noopener nofollow">https://github.com/projectkudu/kudu/wiki/Azure-Web-App-sandbox</a></p>
</li>
</ul>


</div>
<div id="MySignature" role="contentinfo">
    <div style="background: #1c5f55;height: 36px;width: 618px;padding: 14px 5px 0px 3px;">
  <p style="
    font-weight: bold;
    color: white;
">å½å¨å¤æçç¯å¢ä¸­é¢ä¸´é®é¢ï¼æ ¼ç©ä¹ééï¼æµèéä¹å¾æ¸ï¼å®ä»¥å¨ä¹å¾çã äºä¸­ï¼æ°æ¯å¦æ­¤!</p>
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-13 19:13">2026-02-13 19:13</span>&nbsp;
<a href="https://www.cnblogs.com/lulight">ç¼ç èå¢å¸</a>&nbsp;
éè¯»(<span id="post_view_count">19</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19613358);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19613358', targetLink: 'https://www.cnblogs.com/lulight/p/19613358', title: 'ãAzure App Serviceã32ä½ Windows App Service æå¤§è½ä½¿ç¨å¤å°åå­ï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å°å®¹é32åçæºä¹ä¸bootloaderï¼ææºç§å½çè¦è°æï¼è½ä¸æç´§ä¸ ]]></title>
    <link>https://www.cnblogs.com/pie-o/p/19613316</link>
    <guid>8bbac3cb1a7994d7fd1e910032909f16</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/pie-o/p/19613316" title="åå¸äº 2026-02-13 18:54">
    <span role="heading" aria-level="2">å°å®¹é32åçæºä¹ä¸bootloaderï¼ææºç§å½çè¦è°æï¼è½ä¸æç´§ä¸</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        åºäºè¡¨é©±å¨æé çæä»¶æºå¶ï¼å®ç°åçæºä¸çbootloaderï¼ä¸»è¦æ¯å¯¹éä¿¡ï¼åè®®ä»¥åbootè¿ç¨è¿è¡äºæä»¶åæ¹é 
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>é¦åäº21icè®ºå<br>
<a href="https://bbs.21ic.com/icview-3453440-1-1.html" target="_blank" rel="noopener nofollow">å°å®¹é32åçæºä¹ä¸bootloaderï¼ææºç§å½çè¦è°æï¼è½ä¸æç´§ä¸</a></p>
</blockquote>
<h2 id="åè¨">åè¨</h2>
<p>å¨ç åé¶æ®µéè¦æ´æ°ç¨åºæ¶ï¼ç´æ¥ä½¿ç¨è°è¯å¨è¿è¡ç§å½å³å¯ï¼ä½æ¯å¦ææ³è¦å¯¹ä¸ä¸ªå°è£å¥½çäº§åè¿è¡ç¨åºåçº§æ¶ï¼ä¸è¬é½æ¯æ²¡æå¼åºç§å½æ¥å£çï¼æ­¤æ¶åªæææºä¸éã</p>
<p>å¦æåªæä¸ä¸¤ä¸ªéè¦æ´æ°ï¼é£ä¹æä¹å°±æäºï¼ä½æä¸ç¾ä¸ªå¢ï¼æ­¤æ¶ébootloaderä¸å¯ãæ¬æä¸»æ¨æ¯å¨å°å®¹éç32åçæºä¸è¿è¡å¼åï¼æ¯å¦stm32f103è¯çï¼è¿æ ·çä¸»æ§è¯çèµæºæ¯è¾ç´§å¼ ï¼ä½æ¯å¦æææ¡ä»¶ä¸bootloaderï¼å»ºè®®ä¸å®è¦åçï¼åè½ä¸éè¦å¤æï¼åªéå®ç°æåºæ¬çå¨éæ´æ°å°±è¡ã</p>
<p>å¨è¿åºç¡ä¸ï¼ææ´æ³å®ç°çæ¯ä¸æä»¶å¼çå·¥å·ï¼åæ¬bootæµç¨ãäº¤äºåè®®ãæ°æ®æµä»¥åflashé©±å¨è¿4ä¸ªç¸å³çæä»¶ï¼å½é¢å¯¹å¤ç§åºç¨åºæ¯æ¶ï¼è¿æ ·çæä»¶å¼è®¾è®¡å°æå¤§æé«ä»£ç çå¤ç¨è½åï¼æ¹ä¾¿æ¿æ¢ãæ°å¢ä»¥åå é¤ï¼ä»èæ¹åç¨åºçè¡ä¸ºï¼å¹¶ä¸æ´ä¸ºéè¦çæ¯è¿ç§æ¹åæ²¡æå½±åå°ç¨åºçä¸»ä½æ¡æ¶ã</p>
<p>æ¯å¦ä¸ä¸ªé¡¹ç®ä¸­éè¿CANæ»çº¿è¿è¡æ´æ°ï¼èå¦ä¸ä¸ªé¡¹ç®ä½¿ç¨485ï¼è¿æ¶ååªéè¦æ´æ¢ç¸åºçæä»¶å°±å¯å®ç°åè½çè°æ´ï¼è¿å°±æ¯æè°ç<strong>ç­ç¥åæºå¶åç¦»</strong></p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img3@main/2026/02/12/1770899605218-09025f21-2f03-49b7-8d73-dc0d7fe37199.png" class="lazyload"></p>
<hr>
<h2 id="ææ¯è¦ç¹">ææ¯è¦ç¹</h2>
<h3 id="è¡¨é©±å¨è®¾è®¡">è¡¨é©±å¨è®¾è®¡</h3>
<p>ç½ä¸å³äºè¡¨é©±å¨çä»ç»æå¾å¤ï¼å¹¶ä¸å®ç°èµ·æ¥ä¹æ¯åå¼åæ ·ï¼ä½æ¯æ»ä½èè¨ä½¿ç¨è¿ç§æ¹æ³çæ ¸å¿è¿æ¯æ½è±¡ä¸è¾¨è¯ï¼è¿è¦æ±å¼åèå¿é¡»å¯¹è¦å®ç°çåºç¨æä¸ä¸ªå¨é¢çäºè§£åè®¤ç¥ï¼è¿æ ·æè½ä»æ åºä¸­è¯å«åºæåºçä¸»ä½é¨åï¼èè¿é¨åå¿ç¶æä¸ºç¨åºçæ¡æ¶é¨åï¼æ¯éæçï¼åºå®çï¼èå¶ä½çä¾ææ¡æ¶å­å¨çé¶æ£é¨åï¼å±äºæåçï¼å¯æ¿æ¢çã</p>
<p>è¦åå°ä»¥ä¸è¾¨è¯ååç¦»çæä½ï¼è¿ççéè¦ä¸å°ååºãå¶å®åªè¦æ¶åå°æç§èå¼çä½¿ç¨ï¼é½æå¤æå°çæä¸äºç¶é¢ï¼æç°å¨ä¹æ­£å¨å­¦ä¹ è¿ç§æ¹å¼ï¼å®çé¾ç¹å¨äºæä¹æé è¿äºè¡¨ï¼è¡¨çç»æè¯¥æä¹è®¾è®¡ï¼å¯ä»¥è®¤ä¸ºè¿ä¸ªè¡¨å°±æ¯ä¸ä¸ªç»æåçè§£ç©ºé´ï¼æè°è§£ç©ºé´å°±æ¯å¯¹è¡¨è¿è¡è¾å¥çææååºã</p>
<p>æä»¥ä¸ä¸ªå¥½çè¡¨ï¼å¿ç¶æä¸ä¸ªå¯ä»¥è¦çå¯è½è¾å¥æåµçææååºï¼å½ç¶é¤äºè§£ç©ºé´çç¡®å®å¤ï¼æ±è§£çæ¹æ³ï¼æèè¯´æè¾å¥åæ¢å°è§£ç©ºé´çæ¹æ³ä¹æ¯ä¸å¯ç¼ºå°çï¼è¿äºé½æå¤§èéªå¼åèçè½ååæ°´å¹³ã</p>
<p>ç¸æ¯äºæä¹ååä»£ç çæè·¯ï¼é£é½æ¯ç´æªäºå½çï¼å¹³å¿èè®ºï¼ä»ä»»ä¸ä¸ªå±é¨æ¥çè¿ç§ä»£ç ï¼å®å¨æ¯å¿ä¸­ææææ³çä¸ä¸æ å°ï¼ä¹å°±æ¯å®å¨ææä»¬çæèè¿ç¨è½¬åä¸ºä»£ç ï¼è¿æ ·çä»£ç åºè¯¥æ¯å¾ç¬¦åé»è¾çä¸æ¯åã</p>
<p>ä½æ¯ä»å±é¨ä¸åçç³»ç»çæ´ä½ï¼å°±ä¼åç°å±é¨ççé¢åæ¾æ£ï¼è¿æ ·çä»£ç çæ¯ä¸ªé¨åé½ä¼ç¬¦ååæ¬çé¢æï¼ä½ä¹ä»æ­¤èå·²ï¼ä¸æé¥ååªè½éä¸æéï¼ä½å¯æéä¸æä¸æéã</p>
<h3 id="è¡¨é©±å¨ä¸ç¶ææºç»å">è¡¨é©±å¨ä¸ç¶ææºç»å</h3>
<p>ä¸é¢åªä»ç»äºè¡¨é©±å¨çæ¦å¿µï¼ç°å¨ä»ç»ä¸ç§åºç¨åºæ¯ï¼é£å°±æ¯å®ç°ç¶ææºãæä»¬é½ç¥éå¨ç¨åºä¸­çç¶ææºå°±æ¯éè¿å®ä¹ä¸ç»æéç¶æåå¶è½¬ç§»çè§åæ¥æ§å¶ç³»ç»è¡ä¸ºçæ¨¡åï¼ä¸è¬æ4ä¸ªç»æé¨åï¼ç¶æãäºä»¶ãè½¬æ¢åå¨ä½ï¼é£ä¹è¦æ³åºäºè¡¨é©±å¨å®ç°ç¶ææºï¼å°±éè¦æè¿4ä¸ªé¨åæ·»å å°è¡¨ç»æä¸­ï¼å¦ä¸æç¤ºï¼</p>
<pre><code class="language-c">typedef struct{
	State CurState;
	Event CurEvent;
	void (*Action)(void);
	State NextState;

}TransitionItem_t;
</code></pre>
<p>è¿æ ·åºæ¬çç»æå°±æ¯è¡¨ä¸­æ¯ä¸é¡¹çåå®¹ï¼èä¸ä¸ªè¡¨ä¸­æå¤å°é¡¹ï¼å°±çå¼åèèªå·±æä¹çè§£é®é¢åè§£æé®é¢çäºãä¸¾ä¸ªä¾å­ï¼ç°å¨æä¸ä¸ªæé®åä¸ä¸ªLEDç¯ï¼è¦å®ç°åå»æ¶ï¼LEDç¯å¸¸äº®ï¼å¨å¸¸äº®è¿ç¨ä¸­é¿ææ¶ï¼LEDéªçï¼å¨éªçè¿ç¨ä¸­åå»ï¼LEDå¸¸ç­ã</p>
<p>å¨éå°è¿ç§åºç¨æ¶ï¼ä¸è¦ç´æ¥å¼å§åä»£ç ï¼æ è®ºå¤ç®åï¼ååæä¸ä¸ï¼ç»ä¸ªç¶æå¾ï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img10@main/2026/02/12/1770899944060-d48dc185-cfeb-4121-8f5e-95eb5a259c86.png" class="lazyload"></p>
<p>ç¶åæ ¹æ®ç¶æå¾ï¼å®ä¹ç¶æè¡¨ï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img2@main/2026/02/12/1770899975433-46595b0a-26f9-4e72-8831-a8a4ef13c046.png" class="lazyload"></p>
<p>ä¸é¢è¿ä¸ªç¶æè¡¨å°±å¯ä»¥å®å¨è®¾è®¡å°æä»¬çä»£ç ä¸­ï¼å¦ä¸æç¤ºï¼</p>
<pre><code class="language-c">TransitionItem_t FsmTable[] = {
	{LED_OFFï¼KEY_CLICK,LightUp,LED_ON},
	{LED_ONï¼KEY_LONG,Toggle,LED_TOGGLE},
	{LED_TOGGLEï¼KEY_CLICK,LightOff,LED_OFF}
}
</code></pre>
<p>é£ä¹ç°å¨è¡¨ç»ææäºï¼æèè¯´è§£ç©ºé´æäºï¼æä¹æ±è§£å¢ï¼æç®åçå°±æ¯æ¥è¡¨ï¼å¯¹æ¯ä¸¤ä¸ªåç´ ï¼å½åç¶æä»¥ååççäºä»¶ï¼å¨è¿ä¸ªä¾å­ä¸­å°±æ¯(LED_OFF,KEY_CLICK)ã(LED_ON,KEY_LONG)ä»¥å(LED_TOGGLEï¼KEY_CLICK)ï¼ï¼ææ²¡æç¹åå¤åç¦»æ£å½æ°ï¼å¯ä»¥ç»åçå æ·±å¯¹æ¯çè§£ï¼ã</p>
<p>åªè¦ç¬¦åè¿ä¸ä¸ªå®ä¹å¥½çç»åä¹ä¸ï¼é£ä¹å¿ç¶åçå¨ä½ï¼å¦æä¸å±äºä¸ä¸ªä¹ä¸ï¼é£ä¹ä»ä¹ååºé½æ²¡æï¼ä¹ä¸å½±åç°æç¶æï¼é©±å¨ä»£ç å¦ä¸æç¤ºï¼</p>
<pre><code class="language-c">void RunFsm(TransitionItem_t *fsm,int fsm_size){
	/* å¤æ­æ¯å¦ä¸ºç©ºæé */
	if(fsm){
		for(int i = 0;i&lt;fsm_size;i++){
		/* æ¡ä»¶å¯¹æ¯ */
			if(fsm[i].CurState == GlobalState &amp;&amp; fsm[i].CurEvent == GlobalEvent){
			/* æ§è¡å¨ä½ */
				fsm[i].Action();
				/* æ§è¡ç¶æè½¬ç§» */
				GlobalState = fsm[i].NextState;
			}
		}
	}
}
</code></pre>
<h3 id="bootloaderç®ä»">Bootloaderç®ä»</h3>
<p>Bootloaderæ¯åµå¥å¼ç³»ç»ä¸­ä¸æ®µç¹æ®çå¼å¯¼ç¨åºï¼ç¨äºåºä»¶å è½½ææ´æ°ç­åè½ï¼å¨è¯çåçå¤ä½æ¶é¦åä¼è¿å¥Bootloaderè¿è¡å¼å¯¼ï¼å³å®æ¯å¦æ´æ°æè·³è½¬åºç¨ç¨åºã</p>
<p>å¨è¿éä½¿ç¨çæ¯å°å®¹éçåçæºï¼æä»¥Bootloaderç¨åºå°½éç²¾ç®ï¼è¿æ ·å¯ä»¥ç»åºç¨ç¨åºè®©åºæ´å¤çç©ºé´ï¼ä¸è¬ç®åçåºç¨ä¸æä»¬ä¼è¿è¡ååºï¼åä¸ºBootloaderåºåAppåºï¼å¦ä¸å¾æç¤ºï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img10@main/2026/02/12/1770900126224-c0dd3c1d-2bcf-4a24-87c0-3a72a3bfa5a8.png" class="lazyload"></p>
<p>å¯ä»¥çå°å¤§è´ä¸æç®åçååºæ¹æ¡å°±æ¯è¿æ ·ï¼å¶ä¸­appæææ å¿æ¾å¨äºBootloaderåºæ«å°¾ï¼è¿ä¸ªæ å¿å°±æ¯Bootloaderè¿è¡å¼å¯¼çæ¡ä»¶ã</p>
<p>å¯¹äºåºä»¶åçº§æ¥è¯´ï¼å®éä¸æ¯éè¿Bootloaderå¯¹Appåºåè¿è¡æ¦åå¨ä½ï¼æ°æ®æ¥æºäºå¤é¨ï¼åå®¹å°±æ¯Appå·¥ç¨ç¼è¯åºæ¥çbinæä»¶ï¼å¦æå¨æ²¡æå¶ä»é¢å¤Flashçæ¯æä¸ï¼è¿è¡åçº§çé£é©è¿æ¯è®å¤§çï¼æä»¥éè¦æä¸å®çå®å¨æ ¡éªæªæ½ã</p>
<p>æ»çæ¥è¯´ï¼è¦å®ç°ä¸ä¸ªåºæ¬çBootloaderï¼æµç¨è¿æ¯æ¯è¾ç®åçï¼å¤§è´å¦ä¸å¾æç¤ºï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img10@main/2026/02/12/1770900187703-3a1a3dd4-5f45-4f1c-bdd3-2d2c7a3300a3.png" class="lazyload"></p>
<p>å¯ä»¥çå°ï¼ä¸å¾çæµç¨ä¸­æ¾ç¤ºäºä¸¤ç§å¤ä½æåµï¼å³ä¸çµå¤ä½åè½¯ä»¶å¤ä½ï¼å¶ä¸­è½¯ä»¶å¤ä½æ¯ä»åºç¨ç¨åºä¸­è¿è¡çå¤ä½ï¼æ¯ä¸é¨ä¸ºåºä»¶åçº§è®¾å®çï¼è¡¨ç¤ºå­å¨æ´æ°è¯·æ±ï¼å½ç¶å¯ä»¥éå æ´å¤çä¿¡æ¯ï¼åæ¶è½¯ä»¶å¤ä½æä¸ä¸ªç¹ç¹ï¼å°±æ¯ä¸ä¼æ¹åRAMçæ°æ®ã</p>
<p>ä¸ç®¡åªç§å¤ä½ï¼åªè¦å­å¨æ´æ°è¯·æ±ï¼å°±ä¼ç¬¬ä¸æ¶é´æAppæææ å¿ä½æ¸é¤ï¼è¿æ ·å¦æå¨æ´æ°è¿ç¨ä¸­åçä»»ä½é®é¢ï¼æ å¿ä½é½æ¯æ æçï¼é¿ååçéè¯¯è·³è½¬çé®é¢ï¼åªæå®æå¨é¨çæ´æ°æµç¨ï¼åæ¬æ ¡éªç­æä½åæä¼æ è®°ææã</p>
<p>åæ¶ï¼å¦ææ¯æ­£å¸¸çä¸çµå¤ä½ï¼æèæ´æ°å¤±è´¥åï¼é½ä¼åçå¨Bootloaderä¸­ï¼ç­å¾è¶æ¶ï¼å¤æ­æææ å¿ï¼å³å®æ¯å¦è·³è½¬ã</p>
<h2 id="ç»¼åå®è·µ">ç»¼åå®è·µ</h2>
<p>ç°å¨ç»è¿ä¸é¢çä»ç»ï¼å·²ç»å¤§è´å¯¹æ¶åçææ¯è¦æ±æäºä¸å®çäºè§£ï¼é£ä¹æ¥ä¸æ¥å°±æ¯å¯¹æä»¶å¼çBootloaderè¿è¡è®¾è®¡äºã</p>
<p>æä¸ä¸ªå¾æ ¸å¿çæ¦å¿µï¼å°±æ¯<strong>ç­ç¥ä¸æºå¶åç¦»</strong>ï¼å¯¹åºå°æä»¬çè®¾è®¡ä¸­ï¼æºå¶å°±æ¯Bootloaderåè½ï¼ç­ç¥å°±æ¯å®ç°åè½çæ¹å¼ã</p>
<p>ä¹ä¸çï¼ç­ç¥è¿æ¯è¾å¥½çè§£ï¼æºå¶è¦æä¹çè§£å¢ï¼å¯ä»¥è®¤ä¸ºæ¯ä¸ç§å®¹å¨ãæ¡æ¶ææ¨¡åï¼çè³å°±æ¯ä¸å¥åºåè§åï¼ç­ç¥ååä¸ï¼ä½é½å¿é¡»æ å°å°æºå¶çè§ååä¸­æè½å¨æºå¶çä¸çä¸­å­å¨ã</p>
<p>å½ç¶æ¯ä¸ªäººææ¯ä¸ªäººççè§£ï¼ä¸åççè§£ä¹äº§çä¸åçä»£ç ï¼ç°å¨ä»ç»ä¸ä¸æå¯¹Bootloaderæºå¶ççè§£ï¼åä¸å¾å¤§è´æè¿°ä¸ä¸ï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img10@main/2026/02/12/1770905528629-fa11b63a-71dc-4ea2-a64d-2d155f088834.png" class="lazyload"></p>
<p>ä»ä¸å¾ä¸­å¯ä»¥çå°æ4ä¸ªä¸»è¦çåç´ ï¼ä¹å¯ä»¥çä½èç¹ï¼åæ¬éä¿¡æµç¨ãåè®®äº¤äºæµç¨ãBootæµç¨ä»¥åFlashé©±å¨ï¼å¯ä»¥è®¤ä¸ºè¦å®ç°ä¸ä¸ªæåºç¡çBootloaderå¿é¡»è¦æè¿4ä¸ªåç´ ï¼èè¿äºä¹æ¯æºå¶æåºæçæåï¼ææç­ç¥é½æ¯ä½ç¨å¨è¿4ä¸ªåç´ ä¹ä¸çã</p>
<p>å¶ä¸­ä¸ºä»ä¹Flashä¸å¶ä»3ä¸ªä¸ä¸æ ·ï¼æ¯å ä¸ºå¨å®ç°ä¸­ï¼Flashè¯»åé½æ¯ä¸æ¬¡æ§çï¼å¹¶ä¸ç±Bootæµç¨ç´æ¥æ§å¶ï¼èæµç¨çæ§å¶å°±å¯ä»¥ä½¿ç¨ç¶ææºæ¥å®ç°ï¼æ¬è´¨ä¸æ¥è¯´ï¼ç¶ææºæ¯ä¸ä¸ªç¬ç«çæºå¶ï¼èç°å¨éè¿è¡¨é©±å¨æ¹æ³ï¼å¢å¼ºäºè¿ä¸æºå¶çéç¨æ§åçµæ´»æ§ï¼åªéè¦æ´æ¢ç¶æè¡¨ï¼å°±å¯ä»¥å®ç°ç­ç¥çæ¹åã</p>
<p>é£ä¹ç°å¨å±é¨åç´ é½ä»ç»å®äºï¼è¯¥æä¹å¨ååç´ ä¹é´å»ºç«å³èå¢ï¼å¯ä»¥ææ¶æ¯ãè®¢éåå¸ç­æ¹å¼ï¼ä½æ¯ï¼è¿äºé½å¤§æå°ç¨äºï¼éè¿æ¢³çï¼åç°å®å¨å¯ä»¥ä½¿ç¨é¾å¼éç¥çæ¹å¼æ¥å»ºç«å³ç³»ã</p>
<p>å¨ä¸å¾ä¸­å¯ä»¥çå°æµåä¸­æ è¯ç1.1ã1.2ç­å­æ ·ï¼ç¨ååçº§æ¥æè¿°çè¯å°±æ¯ï¼ç±åçº§<strong>ä¸»å¨éç¥</strong>åçº§è¯¥åä»ä¹ï¼å¦ååçº§ä»ä¹é½ä¸åï¼å½ç¶è¿ä¸ªååçº§å¯ä»¥ä¸æ¯åºå®çååçº§ï¼æ¯ç¸å¯¹çååçº§ï¼å¯ä»¥æ³è±¡ä¸ä¸ç¯å½¢é¾è¡¨ï¼ä»¥ä¸å°±æ¯ææè®¾è®¡çæºå¶åå®¹ï¼å®ççº¦æï¼æèè¯´åºç¨æ¡ä»¶å¯ä»¥å½çº³ä»¥ä¸å ç¹ï¼</p>
<ul>
<li>ååæµæ§ï¼é¾å¼è§¦å</li>
<li>æºå¶ç»æåºå®ï¼éè¯å«æè½¬åç­ç¥ä»¥æ»¡è¶³ç»æè¦æ±</li>
</ul>
<p>ä¸é¢ç»åºå®ç°æºå¶çä¸»è¦ä»£ç ï¼<br>
ç¶ææºçç»æï¼</p>
<pre><code class="language-c">/* ç¶æè¡¨ç»æå®ä¹ */
typedef struct
{
/* ç¶æè¡¨äºä»¶é¡¹ */
&nbsp; &nbsp; uint32_t Event;
/* ç¶æè¡¨ç¶æé¡¹ */
&nbsp; &nbsp; uint32_t State;
/* ç¶æè¡¨å¨ä½é¡¹ */
&nbsp; &nbsp; int (*Action)(uint32_t *event, void *arg);
/* ç¶æè¡¨è½¬ç§»é¡¹ */
&nbsp; &nbsp; uint32_t NextState;

} TransitionItem_t;

typedef struct

/* åºç±»ç¶ææºå®ä¹ */
{
/* ç¶æè¡¨ */
&nbsp; &nbsp; TransitionItem_t *FsmTable;
/* å½åç¶æ */
&nbsp; &nbsp; uint32_t CurState;
/* å½ååçäºä»¶ */
&nbsp; &nbsp; uint32_t CurEvent;
/* ç¶æè¡¨å°ºå¯¸ */
&nbsp; &nbsp; uint32_t FsmSize;

} BaseFsm_t;

</code></pre>
<p>å®ä¹äºç¶æè¡¨çç»æï¼ä»¥ååºç±»ç¶ææºçç»æï¼åºç±»ç¶ææºæä¾ç»4ä¸ªåç´ ä½¿ç¨ï¼å¶æ¬¡æ¯è¿è¡ç¶ææºçé©±å¨ä»£ç ï¼</p>
<pre><code class="language-c">int RunFsm(BaseFsm_t *fsm, void *arg)
{
/* é²æ­¢ç©ºæééè¯¯ */
&nbsp; &nbsp; if (fsm-&gt;FsmTable != NULL)
&nbsp; &nbsp; {

&nbsp; &nbsp; &nbsp; &nbsp; for (uint32_t i = 0; i &lt; fsm-&gt;FsmSize; i++)
&nbsp; &nbsp; &nbsp; &nbsp; {
&nbsp; &nbsp; &nbsp; &nbsp; /* (ç¶æ,äºä»¶)åç»å¯¹æ¯ */
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (fsm-&gt;CurState == fsm-&gt;FsmTable[i].State &amp;&amp; fsm-&gt;CurEvent == fsm-&gt;FsmTable[i].Event)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
				/* é²æ­¢ç©ºæééè¯¯ */
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (fsm-&gt;FsmTable[i].Action != NULL)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* æ§è¡å¨ä½ */
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fsm-&gt;FsmTable[i].Action(&amp;fsm-&gt;CurEvent, arg);
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
				/* ç¶æè½¬ç§» */
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fsm-&gt;CurState = fsm-&gt;FsmTable[i].NextState;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }

&nbsp; &nbsp; &nbsp; &nbsp; }

&nbsp; &nbsp; }
&nbsp; &nbsp; else

&nbsp; &nbsp; {
&nbsp; &nbsp; &nbsp; &nbsp; return -1;
&nbsp; &nbsp; }

&nbsp; &nbsp; return 0;

}
</code></pre>
<p>æ¥ä¸æ¥æ¯éä¿¡æµç¨çç»æè®¾è®¡ï¼</p>
<pre><code class="language-c">/* éä¿¡æµç¨çç»æè®¾è®¡ */
typedef struct
{
&nbsp; &nbsp; struct
&nbsp; &nbsp; {
	&nbsp; &nbsp; /* æµç¨æ§å¶ç¶æè¡¨ */
&nbsp; &nbsp; &nbsp; &nbsp; BaseFsm_t *Fsm;
&nbsp; &nbsp; &nbsp; &nbsp; /* é©±å¨å¨ç±å¤é¨æä¾ ä¸»è¦æ¯æ¯ç§éä¿¡é©±å¨æ¹å¼å·®å¼æ¯è¾å¤§ï¼åä¸å°éç¨ */
&nbsp; &nbsp; &nbsp; &nbsp; void *Driver;
&nbsp; &nbsp; &nbsp; &nbsp; /* ç¨äºéç¥æµç¨è·¯å¾ä¸­ä¸ä¸èç¹ï¼éç¨äºåä¸è·¯å¾ */
&nbsp; &nbsp; &nbsp; &nbsp; void *Linkto;
&nbsp; &nbsp; } PrivateArea;

&nbsp; &nbsp; /* åå§å ä¼ å¥ç¶ææºåé©±å¨å¨ é½ç±ç¨æ·æ ¹æ®æ¡æ¶èªå®ä¹ */
&nbsp; &nbsp; void (*Init)(BaseFsm_t *fsm, void *driver, void *link);
	/* è·åç¶ææº */
&nbsp; &nbsp; BaseFsm_t *(*GetFsm)(void);
	/* è·åéä¿¡é©±å¨å¨ */
&nbsp; &nbsp; void *(*GetDriver)(void);
	/* è·åä¸ä¸èç¹ */
&nbsp; &nbsp; void *(*GetLink)(void);

} DataStreamHandle_t;
</code></pre>
<p>éä¿¡èç¹å¯ä»¥è®¤ä¸ºæ¯æ´ä¸ªæºå¶çè§¦åèç¹ï¼å ä¸ºææçäºä»¶æµé½å¯ä»¥ç±éä¿¡æ¥å¼å¯¼ï¼åæ¬æ éä¿¡é æçè¶æ¶äºä»¶æµï¼ç»§æ¿äºä¸é¢çåºç±»ç¶æè¡¨ï¼æ©å±äºéä¿¡å¿è¦çé©±å¨å¨ï¼è¿æä¸äºæ¹æ³å®ä¹ã</p>
<p>å¶æ¬¡æ¯äº¤äºåè®®æµç¨çç»æå®ä¹ï¼</p>
<pre><code class="language-c">typedef struct
{
&nbsp; &nbsp; struct
&nbsp; &nbsp; {
	&nbsp; &nbsp; /* æµç¨æ§å¶ç¶æè¡¨ */
&nbsp; &nbsp; &nbsp; &nbsp; BaseFsm_t *Fsm;
&nbsp; &nbsp; &nbsp; &nbsp; /* ç¨äºéç¥æµç¨è·¯å¾ä¸­ä¸ä¸èç¹ï¼éç¨äºåä¸è·¯å¾ */
&nbsp; &nbsp; &nbsp; &nbsp; void *Linkto;
&nbsp; &nbsp; &nbsp; &nbsp; /* åè®®ä½ - å°è£ä¸è§£æåè®®ä¸­çæ°æ®æåè®®ç¹å¾ */
&nbsp; &nbsp; &nbsp; &nbsp; void *ProtoBody;
&nbsp; &nbsp; } PrivateArea;
	/* åå§å ä¼ å¥ç¶ææºååè®®ä½ é½ç±ç¨æ·æ ¹æ®æ¡æ¶èªå®ä¹ */
&nbsp; &nbsp; void (*Init)(BaseFsm_t *fsm, void *link, void *data_body);
	/* è·åç¶ææº */
&nbsp; &nbsp; BaseFsm_t *(*GetFsm)(void);
	/* è·ååè®®ä½ */
&nbsp; &nbsp; void *(*GetProtoBody)(void);
	/* è·åä¸ä¸èç¹ */
&nbsp; &nbsp; void *(*GetLink)(void);

} ProtocalHandle_t;
</code></pre>
<p>åæ ·çï¼ç»§æ¿äºåºç±»çç¶æè¡¨ï¼åæ¶æ©å±äºä¸ä¸ªåè®®ä½å±æ§ï¼è¿ä¸ªå±æ§çç»ææ¯èªå®ä¹çï¼ä½ç°åè®®çéå¼ï¼ç¨äºå°è£åè§£ææ°æ®ä½¿ç¨ã</p>
<p>æåå°±æ¯Bootæµç¨çç»æå®ä¹ï¼</p>
<pre><code class="language-c">typedef struct
{
&nbsp; &nbsp; struct
&nbsp; &nbsp; {
	&nbsp; &nbsp; /* æµç¨æ§å¶ç¶æè¡¨ */
&nbsp; &nbsp; &nbsp; &nbsp; BaseFsm_t *Fsm;
		/* flashé©±å¨å¨ */
&nbsp; &nbsp; &nbsp; &nbsp; void *FlashDriver;
		/* ç¨äºéç¥æµç¨è·¯å¾ä¸­ä¸ä¸èç¹ï¼éç¨äºåä¸è·¯å¾ */
&nbsp; &nbsp; &nbsp; &nbsp; void *Linkto;

&nbsp; &nbsp; } PrivateArea;

&nbsp; &nbsp; void (*Init)(BaseFsm_t *fsm, void *link, void *driver);
&nbsp; &nbsp; BaseFsm_t *(*GetFsm)(void);
&nbsp; &nbsp; void *(*GetFlashDriver)(void);
&nbsp; &nbsp; void *(*GetLink)(void);

} BootloaderHandle_t;
</code></pre>
<p>åºæ¬åä¸é¢çç»æå¤§åå°å¼ï¼è³æ­¤æ´ä¸ªæºå¶çç»æå°±å®ä¹å®æäºï¼æ¥ä¸æ¥å°±æ¯æ¡æ¶çæ­å»ºäºã</p>
<p>é¦åï¼ä¸è¬çéä¿¡æ¥æ¶åè½é½ä¼å¨ä¸­æ­ä¸­è¿è¡ï¼å ä¸ºè¿æ ·å®æ¶æ§æé«ï¼è½åæ¶çå¤çæ°æ®ä¿¡æ¯ï¼æä»¥æä»¬çéä¿¡æµç¨çè§¦åå¯ä»¥ç»åæ¥æ¶ä¸­æ­æ¥è¿è¡ï¼ä»¥CANæ¥æ¶ä¸­æ­ä¸¾ä¾ï¼</p>
<pre><code class="language-c">void HAL_CAN_RxFifo0MsgPendingCallback(CAN_HandleTypeDef *hcan)

{
	uint8_t i = 0;
	
&nbsp; if (hcan-&gt;Instance == CAN1)
&nbsp; {

&nbsp; &nbsp; HAL_CAN_GetRxMessage(hcan, CAN_RX_FIFO0, &amp;CANxRxHeader, CANRecvBuf);
&nbsp; &nbsp; if (CANxRxHeader.DLC &gt; 0)
&nbsp; &nbsp; {
&nbsp; &nbsp;  /* ä½ä¸ºè§¦åæ¡ä»¶ */
&nbsp; &nbsp; &nbsp; CanMsgRecved = 1;
&nbsp; &nbsp; }
&nbsp; }
}
</code></pre>
<p>è¿æ ·ï¼éè¿ç¶ææºå°±å¯ä»¥æ§å¶éä¿¡çæµç¨ï¼åæ¶ä¼ å¥éä¿¡ç¨çé©±å¨å¨ï¼å ä¸ºæä»¬è®¾è®¡çæ¶åé½æ¯éç¨<code>void *</code>è¿ç§æ½è±¡æéï¼æä»¥çµæ´»ç¨åº¦å¾é«ãç¶åå°±æ¯åè®®äº¤äºæµç¨åBootæµç¨çä½¿ç¨ï¼è¿äºé½å¯ä»¥æ¾å°ä»¥æä¸æ¶åºä¸ºå¨æè¿è¡çä»£ç åä¸­ï¼</p>
<pre><code class="language-c">&nbsp;while (1)
&nbsp;{
	&nbsp;
	/* 1msæ¶åº */
&nbsp; &nbsp; if (TIMEBASE_HOOK(TimeBaseScope, OPT_TIMEBASE_1MS))
&nbsp; &nbsp; {

&nbsp; &nbsp; &nbsp; TIMEBASE_DROP(TimeBaseScope, OPT_TIMEBASE_1MS);
&nbsp; &nbsp; &nbsp; /* åè·¯å¾æµç¨ï¼æ»æ¯éè¿åçº§ä¸»å¨éç¥åçº§è¯¥åä»ä¹(èªå®ä¹äºä»¶)ï¼åæ¶åçº§ç»§æ¿(ä¼ å¥)åçº§çéäº§(è¾åºåå®¹) */
		/* æ¾å¥ç¶ææºå¨ç´æ¥æ¥æ¶æ°æ®çå°æ¹ */
&nbsp; &nbsp; &nbsp; RunFsm(DataStreamHandle.GetFsm(), DataStreamHandle.GetDriver());
&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; /* åè®®ç¶ææºï¼ä¼ å¥æ°æ®æ¶åæ¥å£çåçæ°æ®å½¢å¼ æ¯å¦canæ¥æå½¢å¼ï¼ä¸²å£å½¢å¼ */
&nbsp; &nbsp; &nbsp; RunFsm(ProtocolHandle.GetFsm(), DataStreamHandle.GetDriver());

&nbsp; &nbsp; &nbsp; /* bootæµç¨ç¶ææº */
&nbsp; &nbsp; &nbsp; RunFsm(BootloaderHandle.GetFsm(), ProtocolHandle.GetDataBody());
&nbsp; &nbsp; }
}
</code></pre>
<p>å ä¸ºéè¿é¾å¼ä¼ éæ¶æ¯éç¥ï¼å¨åè·¯å¾æµç¨ä¸­ï¼æ»æ¯å¯ä»¥éè¿åçº§ä¸»å¨éç¥åçº§è¯¥åä»ä¹(èªå®ä¹äºä»¶)ï¼åæ¶åçº§ç»§æ¿(ä¼ å¥)åçº§çéäº§(è¾åºåå®¹)ã</p>
<p>ä»¥ä¸æ´ä¸ªæºå¶çæ¡æ¶çå®æäºï¼æ¥ä¸æ¥ä¸»è¦å°±æ¯ç­ç¥çå®ä¹äºï¼å¶å®å°±æ¯è¯å«åºèªå®ä¹ç­ç¥ä¸­çäºä»¶ãç¶æä»¥åè½¬ç§»ï¼å¹¶æè¿äºä»¥ç¶æè¡¨çæ¹å¼åç°åºæ¥ã</p>
<p>é¦åç»åºéä¿¡ç¶æå¾ï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img18@main/2026/02/12/1770906022938-81e6d609-e339-4669-b6e2-5c64e91397ae.png" class="lazyload"></p>
<p>éä¿¡æµç¨ä¸­å®ä¹çäºä»¶åç¶æå®å®ä¹ï¼ä»¥åç¶æè¡¨å®ä¹ï¼</p>
<pre><code class="language-c">/* éä¿¡äºä»¶æµèªå®ä¹å® &gt;&gt;&gt;&gt;&gt;&gt; */

/* æ äºä»¶ */
#define E_DATA_NONE 0
/* ææ°æ®è¿å¥ */
#define E_DATA_IN (CAST_U32(0X01) &lt;&lt; 0)
/* æ°æ®è¶æ¶ */
#define E_DATA_TIMEOUT (CAST_U32(0X01) &lt;&lt; 1)
/* æ°æ®æ¥æ¶ç»æ */
#define E_DATA_END (CAST_U32(0X01) &lt;&lt; 2)
/* æ°æ®è¯·æ±åè®®å¤ç å ä¸ºåªæèªå·±ç¥éèªå·±ä»ä¹æåµï¼å½ç¶å¾ä¸»å¨éç¥ */
#define E_DATA_LINK_PTO (CAST_U32(0X01) &lt;&lt; 3)
/* ç­å¾åè®®ç»è¿æ¥æ¶æ¯ */
#define E_DATA_RET_PTO (CAST_U32(0X01) &lt;&lt; 4)
  
/* èªå®ä¹ç¶æå® */

/* ç©ºç¶æ */
#define S_DATA_NONE 0
/* æ¥æ¶ç¶æ */
#define S_DATA_READING (CAST_U32(0X01) &lt;&lt; 0)
/* æ°æ®æ¥æ¶å®æç¶æ */
#define S_DATA_READ_END (CAST_U32(0X01) &lt;&lt; 1)
/* ç­å¾åè®®åé¦ç¶æ */
#define S_DATA_WAIT_PTO (CAST_U32(0X01) &lt;&lt; 2)
/* éä¿¡äºä»¶æµèªå®ä¹å® &lt;&lt;&lt;&lt;&lt;&lt; */

TransitionItem_t DataStreamTable[] = {

&nbsp; &nbsp; {E_DATA_IN, S_DATA_NONE, BufData, S_DATA_READING},
&nbsp; &nbsp; {E_DATA_TIMEOUT, S_DATA_READING, ResetData, S_DATA_NONE},
&nbsp; &nbsp; {E_DATA_END, S_DATA_READING, LinkProto, S_DATA_READ_END},
&nbsp; &nbsp; {E_DATA_LINK_PTO, S_DATA_READ_END, NULL, S_DATA_WAIT_PTO},
&nbsp; &nbsp; {E_DATA_RET_PTO, S_DATA_WAIT_PTO, SendResp, S_DATA_NONE}

};

</code></pre>
<p>å¶æ¬¡æ¯äº¤äºåè®®ç¶æå¾ï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img12@main/2026/02/12/1770906080466-2e9cfd2a-9b8d-42a2-aca0-c9165b2f0137.png" class="lazyload"></p>
<p>å¯¹åºçäºä»¶ãç¶æä»¥åç¶æè¡¨å®ä¹å¦ä¸ï¼</p>
<pre><code class="language-c">/* åè®®æ¶å°éä¿¡çéç¥ */

#define E_PROTO_RECV_DATA (CAST_U32(0X01) &lt;&lt; 0)

/* åè®®è§£æå®æ */

#define E_PROTO_PARSE_OK (CAST_U32(0X01) &lt;&lt; 1)

/* Bootåé¦ */

#define E_PROTO_RET_BOOT (CAST_U32(0X01) &lt;&lt; 2)

/* ç©ºç¶æ */
#define S_PROTO_NONE 0
/* è§£æç¶æ */
#define S_PROTO_PARSE (CAST_U32(0X01) &lt;&lt; 1)
/* ç­å¾Bootåé¦ç¶æ */
#define S_PROTO_WAIT_BOOT (CAST_U32(0X01) &lt;&lt; 2)
/* ç¶æè¡¨å®ä¹ */
TransitionItem_t ProtoTable[] = {

&nbsp; &nbsp; {E_PROTO_RECV_DATA, S_PROTO_NONE, ParseData, S_PROTO_PARSE},
&nbsp; &nbsp; {E_PROTO_PARSE_OK, S_PROTO_PARSE, LinkBoot, S_PROTO_WAIT_BOOT},
&nbsp; &nbsp; {E_PROTO_RET_BOOT, S_PROTO_WAIT_BOOT, RetData, S_PROTO_NONE}

};
</code></pre>
<p>æåæ¯Bootæµç¨çç¶æå¾ï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img18@main/2026/02/12/1770906103814-dfd18f3a-8d7e-40b8-ac60-2269c0fe13ae.png" class="lazyload"></p>
<p>å¯¹åºçäºä»¶ãç¶æä»¥åç¶æè¡¨å®ä¹å¦ä¸ï¼</p>
<pre><code class="language-c">/* Bootæ¶å°åè®®çéç¥ */
#define E_BOOT_RECV_PROTO (CAST_U32(0X01) &lt;&lt; 0)
/* Bootèµ·å§å½ä»¤ */
#define E_BOOT_CMD_START (CAST_U32(0X01) &lt;&lt; 1)
/* Bootæ´æ°å½ä»¤ */
#define E_BOOT_CMD_UPDATE (CAST_U32(0X01) &lt;&lt; 2)
/* Bootç»æå½ä»¤ */
#define E_BOOT_CMD_END (CAST_U32(0X01) &lt;&lt; 3)
/* Bootè·³è½¬å½ä»¤ */
#define E_BOOT_CMD_JUMP (CAST_U32(0X01) &lt;&lt; 4)

#define S_BOOT_NONE 0
/* Bootåå¤ç¶æ */
#define S_BOOT_READY (CAST_U32(0X01) &lt;&lt; 1)
/* Bootæ´æ°ç¶æ */
#define S_BOOT_UPDATE (CAST_U32(0X01) &lt;&lt; 2)
/* Bootç»æç¶æ */
#define S_BOOT_END (CAST_U32(0X01) &lt;&lt; 3)

/* ç¶æè¡¨å®ä¹ */
TransitionItem_t BootTable[] = {
&nbsp; &nbsp; {E_BOOT_RECV_PROTO | E_BOOT_CMD_START, S_BOOT_NONE ResetBoot, S_BOOT_READY},
&nbsp; &nbsp; {E_BOOT_RECV_PROTO | E_BOOT_CMD_UPDATE, S_BOOT_READY, Update, S_BOOT_UPDATE},
&nbsp; &nbsp; {E_BOOT_RECV_PROTO | E_BOOT_CMD_UPDATE, S_BOOT_UPDATE, Update, S_BOOT_UPDATE},
&nbsp; &nbsp; {E_BOOT_RECV_PROTO | E_BOOT_CMD_END, S_BOOT_UPDATE, Check, S_BOOT_END},
&nbsp; &nbsp; {E_BOOT_RECV_PROTO | E_BOOT_CMD_JUMP, S_BOOT_END, JumpApp, S_BOOT_NONE}

};
</code></pre>
<p>å¯ä»¥çå°ç¶æè¡¨ä¸­çäºä»¶é¡¹é½æ¯å¤ç§äºä»¶çç»åï¼å ä¸ºæä»¬çäºä»¶å®å®ä¹æ¯éè¿ç§»ä½æä½è¿è¡çï¼æä»¥æä¾äºç»åäºä»¶çè½åã</p>
<p>è³æ­¤ï¼Bootloaderçæºå¶åç­ç¥é½å¶å®å®æ¯äºï¼è¿éåªæ¼ç¤ºäºæ¯è¾ç®åçç­ç¥åè½ï¼ä½å ä¸ºæºå¶æä¾äºç­ç¥æ´æ¢çè½åï¼æä»¥å®ç°æ´å¤æçåè½åªéè¦å¶å®ç¸åºçç­ç¥ç¶æè¡¨å³å¯ã</p>
<p>å®ç°è¿ä¸ªæºå¶ä¹ç®æ¯ä¸ä¸ªå°è¯ï¼å­¦å°äºå¾å¤ï¼åæ¶å¢ä¹æ¥è§¦å°æ´é«çº§çåå®¹ï¼è¿æå¾è¿ä¸æ­¥æ·±å¥äºè§£ã</p>
<p>å¾®ä¿¡å¬ä¼å·ï¼è½¯è¶´è¶´çå·¥ç¨å¸</p>
<p><img alt="dd83fca0b5541e763cf671018f89542e" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1358160/202602/1358160-20260204094757825-873052770.jpg" class="lazyload"></p>


</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/pie-o/" target="_blank">pie_thn</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/pie-o/p/19613316" target="_blank">https://www.cnblogs.com/pie-o/p/19613316</a></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.034027777777777775" data-date-updated="2026-02-13 19:43">2026-02-13 18:54</span>&nbsp;
<a href="https://www.cnblogs.com/pie-o">pie_thn</a>&nbsp;
éè¯»(<span id="post_view_count">14</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19613316);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19613316', targetLink: 'https://www.cnblogs.com/pie-o/p/19613316', title: 'å°å®¹é32åçæºä¹ä¸bootloaderï¼ææºç§å½çè¦è°æï¼è½ä¸æç´§ä¸' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Volcano v1.14 éç£åå¸ï¼è¿å AI ç»ä¸è°åº¦æ°çºªå ]]></title>
    <link>https://www.cnblogs.com/huaweiyun/p/19612682</link>
    <guid>9fd7af0fb39f5bbf00537e5d0adb6977</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/huaweiyun/p/19612682" title="åå¸äº 2026-02-13 16:35">
    <span role="heading" aria-level="2">Volcano v1.14 éç£åå¸ï¼è¿å AI ç»ä¸è°åº¦æ°çºªå</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>æ¬æåäº«èªåä¸ºäºç¤¾åºã<a href="https://bbs.huaweicloud.com/blogs/474065?utm_source=zhihu&amp;utm_medium=bbs-ex&amp;utm_campaign=other&amp;utm_content=content" target="_blank" rel="noopener nofollow">Volcano v1.14 éç£åå¸ï¼è¿å AI ç»ä¸è°åº¦æ°çºªå</a>ã</p>
<p>åäº¬æ¶é´2026å¹´1æï¼<strong>Volcano</strong>[1] v1.14 æ­£å¼åå¸ãéç AI ä¸å¡å½¢æä»åä¸çç¦»çº¿è®­ç»åå¨çº¿æ¨çãAgent æºè½ä½ç­å¤åååºæ¯å»¶ä¼¸ï¼è°åº¦ç³»ç»é¢ä¸´çåææªæçææã<strong>v1.14</strong>[2] éè¿æ¶æçº§çåæ°ï¼å¨ä¿æå¤§è§æ¨¡æ¹éè®¡ç®ä¼å¿çåæ¶ï¼è¡¥é½äºå¯¹å»¶è¿ææåä¸å¡çè°åº¦ç­æ¿ï¼åç <strong>âAIè®­æ¨ãRLãAgentå¨åºæ¯ç»ä¸è°åº¦å¹³å°â</strong> çç®æ è¿åºäºåå®ä¸æ­¥ã</p>
<p data-tool="mdniceç¼è¾å¨"><img alt="download" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2030258/202602/2030258-20260213163013597-24056382.png" class="lazyload"></p>
<h1 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>çæ¬äº®ç¹</strong></span></span></h1>
<p data-tool="mdniceç¼è¾å¨">v1.14.0 çæ¬å¸¦æ¥ä»¥ä¸éç£æ´æ°ï¼</p>
<p data-tool="mdniceç¼è¾å¨"><strong>ç»ä¸è°åº¦å¹³å°æ¶æ</strong></p>
<ul data-tool="mdniceç¼è¾å¨">
<li>å¤è°åº¦å¨æ¶æåçº§ï¼å¨æèç¹åçæºå¶ (Alpha)</li>
<li>AI Agent å·¥ä½è´è½½æéè°åº¦è½å (Alpha)</li>
</ul>
<p data-tool="mdniceç¼è¾å¨"><strong>ç½ç»æææç¥è°åº¦å¢å¼º</strong></p>
<ul data-tool="mdniceç¼è¾å¨">
<li>HyperNode çº§ Binpack ç­ç¥</li>
<li>SubGroup çº§ç²¾ç»åæææç¥</li>
<li>PodGroup ä¸ SubGroup å¤å±çº§ Gang Scheduling</li>
<li>Volcano Job ååºæ¯æ</li>
</ul>
<p data-tool="mdniceç¼è¾å¨"><strong>æ··é¨è½åå¢å¼º</strong></p>
<ul data-tool="mdniceç¼è¾å¨">
<li>å¨é¢æ¯æéç¨æä½ç³»ç»ï¼UbuntuãCentOS ç­ï¼</li>
<li>Cgroup V2 å¨é¢éé</li>
<li>CPU å¨æåå¶</li>
<li>åºäº Cgroup V2 çåå­ QoS</li>
<li>æ¯æ CPU Burst</li>
<li>æ¯æ systemd driver èªå¨æ£æµ</li>
</ul>
<p data-tool="mdniceç¼è¾å¨"><strong>å¼æç¡¬ä»¶æ¯æ</strong></p>
<ul data-tool="mdniceç¼è¾å¨">
<li>æè¾ vNPU è°åº¦ï¼æ¯æ MindCluster å HAMi æ¨¡å¼ï¼</li>
</ul>
<p data-tool="mdniceç¼è¾å¨"><strong>Volcano Global å¢å¼º</strong></p>
<ul data-tool="mdniceç¼è¾å¨">
<li>HyperJob å¤éç¾¤ä½ä¸èªå¨æå</li>
<li>æ°æ®æç¥å¤éç¾¤è°åº¦</li>
</ul>
<p data-tool="mdniceç¼è¾å¨"><strong>Volcano Dashboard å¢å¼º</strong></p>
<ul data-tool="mdniceç¼è¾å¨">
<li>PodGroup å¨æ¯å¯è§å</li>
<li>Job / Queue å¨çå½å¨æç®¡ç</li>
</ul>
<h2 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>å¤è°åº¦å¨æ¶æåçº§ï¼å¨æèç¹åçæºå¶ (Alpha)</strong></span></span></h2>
<p data-tool="mdniceç¼è¾å¨">éç Volcano æ¿è½½çå·¥ä½è´è½½ç±»åæ¥çä¸°å¯ãè§æ¨¡æç»­æ©å¤§ï¼åä¸è°åº¦å¨æ¶æéæ¸æ¾é²ç¶é¢ãæ¹éè®­ç»ãAI Agentãå¾®æå¡ç­ä¸åç±»åçå·¥ä½è´è½½ï¼å¯¹è°åº¦æ¶å»¶ãèµæºå©ç¨æ¨¡å¼çè¯æ±åä¸ç¸åãåè°åº¦å¨é¾ä»¥å¼é¡¾ï¼èéæèµæºåååä¼é æå©ç¨çä½ä¸ã<br>
æ°å¼å¥ç Sharding Controller æå»ºäºä¸å¥å¯æ©å±çå¤è°åº¦å¨æ¶æï¼è½å¤æ ¹æ®éç¾¤å®æ¶ç¶æï¼ä¸ºæ¯ä¸ªè°åº¦å¨å¨æè®¡ç®åéèç¹æ± ãä¸ä¼ ç»çéæååºä¸åï¼Sharding Controller éç¨å¨æè®¡ç®çæ¹å¼ååèµæºï¼èéå¼ºå¶ç¡¬éç¦»ãè¿ç§çµæ´»æºå¶è®© Volcano çæ­£æä¸º"ä¸ä¸ªå¹³å°è°åº¦ææè´è½½"çç»ä¸è°åº¦å¹³å°ï¼åæ¶ä¿æé«ååãä½æ¶å»¶ã<br>
</p>
<p data-tool="mdniceç¼è¾å¨"><strong>æ ¸å¿è½å</strong>ï¼</p>
<ul data-tool="mdniceç¼è¾å¨">
<li><strong>å¨æåçç­ç¥</strong>ï¼æ¯æå¤ç§ç­ç¥æ¥è®¡ç®å¨æåéèç¹æ± ãå½åçæ¬çåæ¯æåºäº CPU å©ç¨ççåçç­ç¥ï¼å¹¶éç¨äºå¯æ©å±çæ¶æè®¾è®¡ï¼ä»¥ä¾¿æªæ¥è½»æ¾éææ´å¤åçç®æ³ã</li>
<li><strong>èç¹æ± åç®¡ç</strong>ï¼å¼å¥ NodeShard CRDï¼ä¸ºç¹å®è°åº¦å¨ç®¡çä¸å±çå¨æåéèç¹æ± ã</li>
<li><strong>æ¯æå¤§è§æ¨¡éç¾¤</strong>ï¼éè¿å¨å¤ä¸ªè°åº¦å¨ä¹é´çµæ´»åéè´è½½ï¼å¤©ç¶ééå¤§è§æ¨¡éç¾¤åºæ¯ã</li>
<li><strong>å¤è°åº¦å¨åå</strong>ï¼æ¯æå¤ç§è°åº¦å¨ç»åçæ ç¼åä½ãæ è®ºæ¯é¨ç½²å¤ä¸ª Batch Scheduler è¿è¡è´è½½åæï¼è¿æ¯æ··åé¨ç½² Agent Scheduler ä¸ Batch Scheduler ä»¥åºå¯¹ä¸åä¸å¡éæ±ï¼é½è½çµæ´»ééã</li>

</ul>
<p data-tool="mdniceç¼è¾å¨">éç½®ç¤ºä¾ï¼</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;"># Sharding Controller å¯å¨åæ°
--scheduler-configs="volcano:volcano:0.0:0.6:false:2:100,agent-scheduler:agent:0.7:1.0:true:2:100"
--shard-sync-period=60s
--enable-node-event-trigger=true

# åæ°æ ¼å¼: name:type:min_util:max_util:prefer_warmup:min_nodes:max_nodes</pre>
</div>
<p data-tool="mdniceç¼è¾å¨">ç¸å³ PRï¼https://github.com/volcano-sh/volcano/pull/4777<br>
è®¾è®¡ææ¡£ï¼<strong>Sharding Controller Design</strong>[3]<br>
æè°¢ç¤¾åºå¼åèï¼@ssfffss, @Haoran, @qi-min</p>
<h2 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>AI Agent å·¥ä½è´è½½æéè°åº¦ (Alpha)</strong></span></span></h2>
<p data-tool="mdniceç¼è¾å¨">AI Agent ç±»ä¸å¡å¯¹æ¶å»¶æåº¦ææï¼ä»»å¡åå»ºé¢ç¹ä¸çå½å¨æç­ï¼å¯¹è°åº¦å¨çååºéåº¦åååéæåºäºä¸¥èè¦æ±ãåç Volcano Batch Scheduler ä¸ä¸ºæ¹éè®¡ç®è®¾è®¡ï¼æåºå®å¨æå¤ç Podï¼é¾ä»¥æ»¡è¶³ Agent åºæ¯çæ¯«ç§çº§ååºéæ±ã<br>
ä¸ºæé å¼å®¹æ¹éè®¡ç®ä¸å»¶è¿ææåä¸å¡çç»ä¸è°åº¦å¹³å°ï¼v1.14 å¼å¥äºä¸ç¨ç <strong>Agent Scheduler</strong>ãå®éè¿ Sharding Controller ä¸æ¹éè°åº¦å¨ååå·¥ä½ï¼åå¸å¶èåæ ç¼éåï¼çæ­£å®ç°"ä¸ä¸ªå¹³å°ãå¤ç§è´è½½"ã<br>
</p>
<p data-tool="mdniceç¼è¾å¨"><strong>æ ¸å¿è½å</strong>ï¼</p>
<ul data-tool="mdniceç¼è¾å¨">
<li><strong>æéè°åº¦éé</strong>ï¼ä¸ä¸ºå»¶è¿ææåè´è½½ï¼å¦ AI Agentï¼æé çç¬ç«è°åº¦å¨ï¼æä¾æè´ååºéåº¦ã</li>
<li><strong>å¤ Worker å¹¶è¡å¤ç</strong>ï¼éç¨å¤ Worker å¹¶åæ¶è´¹è°åº¦éåçæ¶æï¼å¤§å¹æåè°åº¦ååéã</li>
<li><strong>ä¹è§å¹¶åæ§å¶</strong>ï¼å¼å¥ Conflict-Aware Binder æºå¶ï¼å¨å®éç»å®åé¢åè§£å³å²çªï¼åå°æ ææä½ã</li>
<li><strong>å¢å¼ºåè°åº¦éå</strong>ï¼ä¼åéåæºå¶ï¼æ¯æç´§æ¥ä»»å¡éè¯ï¼ç¡®ä¿å³é®ä»»å¡ä¸é»å¡ã</li>
<li><strong>ç»ä¸å¹³å°èå</strong>ï¼éè¿ Sharding Controller ä¸æ¹éè°åº¦å¨æ ç¼åä½ï¼å±äº«éç¾¤èµæºã</li>

</ul>
<p data-tool="mdniceç¼è¾å¨">ç¸å³ PRï¼</p>
<p data-tool="mdniceç¼è¾å¨">https://github.com/volcano-sh/volcano/pull/4804,<br>
https://github.com/volcano-sh/volcano/pull/4801,<br>
https://github.com/volcano-sh/volcano/pull/4805<br>
è®¾è®¡ææ¡£ï¼<strong>Agent Scheduler Design</strong>[4]<br>
æè°¢ç¤¾åºå¼åèï¼@qi-min, @JesseStutler, @handan-yxh</p>
<h2 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>ç½ç»æææç¥è°åº¦å¢å¼º</strong></span></span></h2>
<p data-tool="mdniceç¼è¾å¨">Volcano v1.14.0 å¯¹ç½ç»æææç¥è°åº¦è¿è¡äºè¿ä¸æ­¥å¢å¼ºï¼æ»¡è¶³åå¸å¼å·¥ä½è´è½½ï¼åæ¬ LLM è®­ç»ãæ¨çãHPC åå¶ä»ç½ç»å¯éååºç¨ï¼æ¥çå¢é¿çéæ±ã<br>
</p>
<p data-tool="mdniceç¼è¾å¨"><strong>æ ¸å¿å¢å¼º</strong>ï¼</p>
<ul data-tool="mdniceç¼è¾å¨">
<li><strong>SubGroup çº§ç²¾ç»åæææç¥</strong>ï¼æ¯æå¨ SubGroup / Partition ç²åº¦è®¾ç½®ç½ç»ææçº¦æï¼è°åº¦é¢ç²åº¦æ´ç²¾ç»ã</li>
<li><strong>çµæ´»çç½ç»å±çº§çº¦æ</strong>ï¼æ°å¢ highestTierNameï¼æ¯ææåç§°æå®åè®¸è·¨è¶çæé«ç½ç»å±çº§ã</li>
<li><strong>å¤å±çº§ Gang Scheduling</strong>ï¼åæ¶æ¯æ PodGroup çº§å«å SubGroup çº§å«ç Gang Schedulingï¼ç¡®ä¿åå¸å¼ä»»å¡çæ´ä½æ§ã</li>
<li><strong>Volcano Job ååº</strong>ï¼æ¯æå° Job æåä¸ºå¤ä¸ªååºï¼Partitionï¼ï¼ä¾¿äºç®¡ç TP/PP/DP ç­å¹¶è¡ç­ç¥ï¼å¹¶ä¼åç½ç»äº²åæ§ã</li>
<li><strong>HyperNode çº§ Binpacking</strong>ï¼å¨ HyperNodeï¼å¦äº¤æ¢æºãæºæ¶ï¼å±çº§è¿è¡èµæºè£ç®±ï¼åå°ç½ç»ç¢çï¼æåéä¿¡æçã</li>

</ul>
<p data-tool="mdniceç¼è¾å¨">éç½®ç¤ºä¾ - Volcano Jobï¼</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;">apiVersion: batch.volcano.sh/v1alpha1
kind: Job
metadata:
name: llm-training-job
spec:
networkTopology:
mode: hard
highestTierAllowed: 2 # æ´ä¸ª Job æå¤è·¨è¶ Tier 2 HyperNode
tasks:
- name: trainer
replicas: 8
partitionPolicy:
totalPartitions: 2 # æåä¸º 2 ä¸ªååº
partitionSize: 4 # æ¯ä¸ªååº 4 ä¸ª Pod
minPartitions: 2 # è³å°éè¦ 2 ä¸ªååº
networkTopology:
mode: hard
highestTierAllowed: 1 # åä¸ªååºå¿é¡»å¨ Tier 1 å
template:
spec:
containers:
- name: trainer
image: training-image:v1
resources:
requests:
nvidia.com/gpu: 8</pre>
</div>
<p data-tool="mdniceç¼è¾å¨">ç¸å³ PRï¼</p>
<p data-tool="mdniceç¼è¾å¨">https://github.com/volcano-sh/volcano/pull/4721,<br>
https://github.com/volcano-sh/volcano/pull/4810,<br>
https://github.com/volcano-sh/volcano/pull/4795,<br>
https://github.com/volcano-sh/volcano/pull/4785,<br>
https://github.com/volcano-sh/volcano/pull/4889</p>
<p data-tool="mdniceç¼è¾å¨">è®¾è®¡ææ¡£ï¼<strong>Network Topology Aware Scheduling</strong>[5]<br>
æè°¢ç¤¾åºå¼åèï¼@ouyangshengjia, @3sunny, @zhaoqi, @wangyang0616, @MondayCha, @Tau721</p>
<h2 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>æ··é¨è½åå¨é¢åçº§ï¼æ¯æéç¨æä½ç³»ç»</strong></span></span></h2>
<p data-tool="mdniceç¼è¾å¨">æ¬æ¬¡åå¸å¯¹ Volcano çæ··é¨è½åè¿è¡äºå¨é¢æ¹è¿ï¼å¶ä¸­ä¸ä¸ªéè¦éç¨ç¢æ¯ï¼Volcano æ··é¨è½å<strong>æ­£å¼æ¯æéç¨æä½ç³»ç»</strong>ï¼UbuntuãCentOS ç­ï¼ï¼ä¸åå±éäº OpenEulerãè¿æå³çæ´å¤ç¨æ·å¯ä»¥ä½¿ç¨ Volcano Agent å®ç°å¨ç¦»çº¿æ··é¨ï¼æåéç¾¤æ´ä½èµæºå©ç¨çã</p>
<h3 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>CPU å¨æåå¶ (CPU Suppression)</strong></span></span></h3>
<p data-tool="mdniceç¼è¾å¨">å¨çº¿ä¸å¡æµééå¸¸å·ææ½®æ±ç¹æ§ãä¸ºäºå¨ä¿éå¨çº¿ä¸å¡ SLA çåæ¶æå¤§åèµæºå©ç¨ï¼ç¦»çº¿ Pod ç CPU éé¢éè¦éå¨çº¿ç¨éå¨æè°æ´ï¼å¨çº¿ç¨éé«æ¶åå¶ç¦»çº¿éé¢ï¼ç¨éåè½æ¶éæ­¥æ¢å¤ï¼å®ç°èªéåºçèµæºåéã</p>
<p data-tool="mdniceç¼è¾å¨">æ ¸å¿è®¾è®¡ï¼</p>
<ul data-tool="mdniceç¼è¾å¨">
<li>æ ¹æ®èç¹å¯åé CPU åå®æ¶ç¨éï¼å¨æè°æ´ BestEffort root cgroup ç CPU éé¢ã</li>
<li>éç¨"çæ§-äºä»¶-å¤ç"æ¶æï¼å¹¶å®æ½ä¿å®æ´æ°ç­ç¥ï¼æææå¶æå¨ã</li>

</ul>
<p data-tool="mdniceç¼è¾å¨">éç½®ç¤ºä¾ï¼</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;">cpuThrottlingConfig:

enable: true

cpuThrottlingThreshold: 80 # BE éé¢ä¸éä¸ºå¯åé CPU ç 80%

cpuJitterLimitPercent: 1 # éé¢ååè¶è¿ 1% æè§¦åæ´æ°
cpuRecoverLimitPercent: 10 # åæ¬¡æ¢å¤ä¸é 10%</pre>
</div>
<h3 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>åå­ QoS (Cgroup V2)</strong></span></span></h3>
<p data-tool="mdniceç¼è¾å¨">åºäº Cgroup V2 å®ç°æ··é¨åºæ¯çåå­éç¦»ãæ°å¢ ColocationConfiguration CRDï¼æ¯æä¸ºæå®å·¥ä½è´è½½éç½®åå­ QoS ç­ç¥ã</p>
<p data-tool="mdniceç¼è¾å¨">æ ¸å¿è½åï¼</p>
<ul data-tool="mdniceç¼è¾å¨">
<li><strong>New API</strong>ï¼éè¿æ ç­¾éæ©å¨å®ä¹åå­éç¦»ç­ç¥ç ColocationConfiguration CRD</li>
<li><strong>å¨æè®¡ç®</strong>ï¼
<ul>
<li>memory.high = pod.limits.memory * highRatio %</li>
<li>memory.low = pod.requests.memory * lowRatio %</li>
<li>memory.min = pod.requests.memory * minRatio %</li>
</ul>
</li>
<li><strong>ç»ä¸æ¥å£</strong>ï¼å¯é æ£æµåæ¯æ Cgroup V2 ç¯å¢</li>
</ul>
<p data-tool="mdniceç¼è¾å¨">ä½¿ç¨ç¤ºä¾ï¼</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;">apiVersion: config.volcano.sh/v1alpha1

kind: ColocationConfiguration

metadata:

name: colo-config1

spec:

selector:

*matchLabels:*

  *app: offline-test*
memoryQos:

*highRatio: 100  \# memory.high \= memory.limits \* 100%*

*lowRatio: 50    \# memory.low \= memory.requests \* 50%*  
*minRatio: 0     \# memory.min \= memory.requests \* 0%*</pre>
</div>
<h3 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>CPU Burst ä¸ Cgroup V2 å¨é¢æ¯æ</strong></span></span></h3>
<p data-tool="mdniceç¼è¾å¨">CPU Burst è½åå·²æ©å±è³éç¨æä½ç³»ç»ãåæ¶ï¼Volcano Agent ç°å·²å¨é¢éé Cgroup V2 ç¯å¢ï¼æ¯æèªå¨æ£æµ Cgroup çæ¬åé©±å¨ç±»åï¼å¦ systemd driverï¼ï¼æ éäººå·¥å¹²é¢å³å¯å¨ç°ä»£ Linux åè¡çä¸æ ç¼è¿è¡ã</p>
<p data-tool="mdniceç¼è¾å¨">ç¸å³ PRï¼</p>
<p data-tool="mdniceç¼è¾å¨">https://github.com/volcano-sh/volcano/pull/4632,</p>
<p data-tool="mdniceç¼è¾å¨">https://github.com/volcano-sh/volcano/pull/4945,</p>
<p data-tool="mdniceç¼è¾å¨">https://github.com/volcano-sh/volcano/pull/4913,</p>
<p data-tool="mdniceç¼è¾å¨">https://github.com/volcano-sh/volcano/pull/4984</p>
<p data-tool="mdniceç¼è¾å¨">è®¾è®¡ææ¡£ï¼<strong>CPU Throttle Design</strong>[6], <strong>Agent Cgroup V2 Adaptation</strong>[7]</p>
<p data-tool="mdniceç¼è¾å¨">æè°¢ç¤¾åºå¼åèï¼@Haibara-Ai97, @JesseStutler, @ouyangshengjia</p>
<h2 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>æè¾ vNPU è°åº¦</strong></span></span></h2>
<p data-tool="mdniceç¼è¾å¨">v1.14 åçéæäºæè¾ vNPUï¼èæ NPUï¼è°åº¦è½åï¼å®ç°æè¾ AI å¤çå¨å¨å¤ä¸ªå·¥ä½è´è½½ä¹é´çé«æç®åå¤ç¨ãæä¾ä¸¤ç§æ¨¡å¼ï¼çµæ´»ééä¸åé¨ç½²åºæ¯ã</p>
<p data-tool="mdniceç¼è¾å¨"><strong>æ¯ææ¨¡å¼</strong>ï¼</p>
<p data-tool="mdniceç¼è¾å¨"><strong>1. MindCluster æ¨¡å¼</strong></p>
<ul data-tool="mdniceç¼è¾å¨">
<li>éæèª Ascend MindCluster è°åº¦æä»¶ï¼https://gitcode.com/Ascend/mind-cluster
<ul>
<li>æ¯ææè¾ 310P ç³»åçå¨æèæå</li>
</ul>
</li>
</ul>
<p data-tool="mdniceç¼è¾å¨"><strong>2. HAMi æ¨¡å¼</strong></p>
<ul data-tool="mdniceç¼è¾å¨">
<li>ç± HAMi ç¤¾åºå¼å
<ul>
<li>åæ¶æ¯ææè¾ 310 å 910 ç³»å</li>
<li>æ¯æå¼ææè¾éç¾¤ï¼910Aã910B2ã910B3ã310Pï¼</li>
</ul>
</li>
</ul>
<p data-tool="mdniceç¼è¾å¨">è°åº¦å¨éç½®ï¼</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;"># MindCluster æ¨¡å¼

- name: deviceshare

arguments:

*deviceshare.AscendMindClusterVNPUEnable: true*
# HAMi æ¨¡å¼

- name: deviceshare

arguments:

*deviceshare.AscendHAMiVNPUEnable: true*  
*deviceshare.SchedulePolicy: binpack  \# æ spread*</pre>
</div>
<p data-tool="mdniceç¼è¾å¨">ç¸å³ PRï¼</p>
<p data-tool="mdniceç¼è¾å¨">https://github.com/volcano-sh/volcano/pull/4656,<br>
https://github.com/volcano-sh/volcano/pull/4717<br>
ä½¿ç¨ææ¡£ï¼<strong>How to Use vNPU</strong>[8]<br>
æè°¢ç¤¾åºå¼åèï¼@JackyTYang, @DSFans2014</p>
<h2 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>Volcano Global å¢å¼º</strong></span></span></h2>
<p data-tool="mdniceç¼è¾å¨">Volcano Global v0.3.0 å¼å¥äºä¸¤ä¸ªéè¦åè½ï¼éè¿åºäºè®¡ç®èµæºåæ°æ®å±é¨æ§çæºè½è°åº¦ï¼æ¾èæ©å±äº Volcano Global å¯¹ AI/ML åå¤§æ°æ®å·¥ä½è´è½½çè½åã</p>
<h3 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>HyperJobï¼å¤éç¾¤ä½ä¸èªå¨æå</strong></span></span></h3>
<p data-tool="mdniceç¼è¾å¨">éç AI è®­ç»å·¥ä½è´è½½è§æ¨¡åå¤ææ§çå¢é¿ï¼ä¼ä¸è¶æ¥è¶é¢ä¸´è·¨å¤ä¸ªå¼æéç¾¤ç®¡çå¤§è§æ¨¡è®­ç»ä½ä¸çææãHyperJob æ¯æå»ºå¨ Volcano Job ä¹ä¸çæ´é«çº§æ½è±¡ãå®ç»åå¤ä¸ª Volcano Job æ¨¡æ¿ï¼å°è®­ç»è½åæ©å±å°åéç¾¤è¾¹çä¹å¤ï¼åæ¶ä¿çæ¯ä¸ªéç¾¤åç°æ Volcano Job çå¨é¨è½åã</p>
<p data-tool="mdniceç¼è¾å¨"><strong>æ ¸å¿è½å</strong>ï¼</p>
<ul data-tool="mdniceç¼è¾å¨">
<li><strong>Karmada æ·±åº¦éæ</strong>ï¼èªå¨çæ PropagationPolicyï¼ç²¾åéç½®éç¾¤äº²åæ§ä¸å¯æ¬è°åº¦ã</li>
<li><strong>ç¶æç»ä¸èå</strong>ï¼å°åéç¾¤å­ä»»å¡ç¶ææ±æ»ä¸ºç»ä¸ç HyperJob ç¶æï¼å¨å±å¯è§æµã</li>
<li><strong>èªå¨èµæºçæ</strong>ï¼æ ¹æ® ReplicatedJob å®ä¹èªå¨åå»º VCJob å PropagationPolicyã</li>

</ul>
<p data-tool="mdniceç¼è¾å¨">HyperJob èµæºç¤ºä¾ï¼è·¨ 2 ä¸ªéç¾¤æåå¤§è§æ¨¡è®­ç»ä½ä¸ï¼å± 256 ä¸ª GPUï¼ï¼</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;">apiVersion: training.volcano.sh/v1alpha1

kind: HyperJob

metadata:

name: llm-training

spec:

replicatedJobs:

- name: trainer

replicas: 2

templateSpec:

  tasks:

  \- name: worker

    replicas: 128

    template:

      spec:

        containers:

        \- name: trainer

          image: training-image:v1

          resources:

            requests:  
              nvidia.com/gpu: 1</pre>
</div>
<h3 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>æ°æ®æç¥è°åº¦</strong></span></span></h3>
<p data-tool="mdniceç¼è¾å¨">å¨ AI è®­ç»åå¤§æ°æ®åæç­é«æ§è½è®¡ç®åºæ¯ä¸­ï¼ä»»å¡æ§è¡ä¸ä»ä¾èµè®¡ç®èµæºï¼è¿ä¸¥éä¾èµæ°æ®èµæºãå¨å¤éç¾¤ç¯å¢ä¸­ï¼è°åº¦å¨å¯è½ä¼å°ä»»å¡åæ´¾å°ä¸æ°æ®æºç©çè·ç¦»è¾è¿çéç¾¤ï¼å¯¼è´è·¨å°åå¸¦å®½ææ¬è¿é«å I/O å»¶è¿è¿é«ã</p>
<p data-tool="mdniceç¼è¾å¨">æ°æ®æç¥è°åº¦æ¡æ¶å¼å¥ <strong>DataDependencyController</strong>ï¼æéäºé»è¾æ°æ®éæ±ä¸ç©çéç¾¤åå¸çå£åãéè¿å¤é¨æä»¶ï¼å¦ Amoroï¼å®æ¶è·åæ°æ®åå¸ä¿¡æ¯ï¼èªå¨å°è°åº¦çº¦ææ³¨å¥ Karmadaï¼å®ç°"è®¡ç®éæ°æ®èå¨"çå¨èªå¨å·¥ä½æµã</p>
<p data-tool="mdniceç¼è¾å¨"><strong>æ ¸å¿è½å</strong>ï¼</p>
<ul data-tool="mdniceç¼è¾å¨">
<li><strong>æä»¶åæ¶æ</strong>ï¼å¯æ©å±æ¯æ AmoroãHiveãS3 ç­å¤ç§æ°æ®ç³»ç»ã</li>
<li><strong>å£°æå¼ API</strong>ï¼DataSourceClaim / DataSource CRDï¼éç¨"å£°æ-ç¼å­"æ¨¡å¼ã</li>
<li><strong>èªå¨äº²åæ³¨å¥</strong>ï¼å°æ°æ®å±é¨æ§è½¬åä¸º ClusterAffinity çº¦æï¼æ³¨å¥ ResourceBindingã</li>
</ul>
<p data-tool="mdniceç¼è¾å¨">è¯¦è§ï¼ <strong>Volcano Global v0.3.0 Release Notes</strong>[9]<br>
æè°¢ç¤¾åºå¼åèï¼@JesseStutler, @fx147, @Monokaix, @zhoujinyu, @anryko, @tanberBro</p>
<h2 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>Volcano Dashboard v0.2.0</strong></span></span></h2>
<p data-tool="mdniceç¼è¾å¨">Volcano Dashboard v0.2.0 å¯¹èµæºç®¡çè½åè¿è¡äºéå¤§å¢å¼ºï¼ä½¿å¾éè¿ Web çé¢ç®¡ç Volcano èµæºæ´å ä¾¿æ·ã<br>
<strong>æ ¸å¿å¢å¼º</strong>ï¼</p>
<ul data-tool="mdniceç¼è¾å¨">
<li><strong>PodGroup å¨æ¯å¯è§å</strong>ï¼è·¨å½åç©ºé´æ¥çãæç´¢ãè¿æ»¤ PodGroupï¼æ¯æ YAML è¯­æ³é«äº®ã</li>
<li><strong>Job çå½å¨æç®¡ç</strong>ï¼ç´æ¥å¨çé¢åå»ºãå é¤ Volcano Jobï¼æä½æ´ä¾¿æ·ã</li>
<li><strong>Queue ç®¡çå¢å¼º</strong>ï¼å¨çº¿ç¼è¾ Queue éé¢ãæéï¼æ¯æ YAML ç´æ¥ä¿®æ¹ã</li>
<li><strong>å®å¨å åº</strong>ï¼é»è®¤éç½® SELinuxãSeccompãé root è¿è¡åç¦æ­¢ææï¼ä¿éçäº§å®å¨ã</li>

</ul>
<p data-tool="mdniceç¼è¾å¨">è¯¦è§ï¼ <strong>Volcano Dashboard v0.2.0 Release Notes</strong>[10]<br>
æè°¢ç¤¾åºå¼åèï¼@vzhou-p, @Shrutim1505, @JesseStutler, @karanBRAVO, @Sayan4444, @jayesh9747, @Alivestars24, @kuldeep, @Monokaix</p>
<h2 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>è°åº¦å¨ç¨³å®æ§ä¸æ§è½æå</strong></span></span></h2>
<p data-tool="mdniceç¼è¾å¨"><strong>Reclaim éæä¸å¢å¼º</strong><br>
å¯¹ Reclaim Action è¿è¡äºå¨é¢éæï¼å¹¶ä¿®å¤äº Capacity Plugin ä¸­çå³é®é»è¾é®é¢ï¼å¤§å¹æåå¤ç§æ·éç¾¤èµæºåæ¶çåç¡®æ§ãç¨³å®æ§åæ§è½ã<br>
ä¸»è¦æ¹è¿ï¼</p>
<ul data-tool="mdniceç¼è¾å¨">
<li><strong>Reclaim Action éæ</strong>ï¼éæäº reclaim å·¥ä½æµï¼æé«ä»£ç å¯è¯»æ§ãå¯ç»´æ¤æ§åæµè¯è¦ççã</li>
<li><strong>å¢å¼ºç Capacity Plugin é»è¾</strong>ï¼ä¿®å¤äº reclaimableFn å preemptiveFnï¼æ­£ç¡®å¤çæ éèµæºå¹¶é²æ­¢éè¯¯çæ¢å å³ç­ã</li>
<li><strong>ç¨³å®æ§æå</strong>ï¼è§£å³äºèµæºè®¡ç®ä¸­çè¾¹ç¼æåµï¼é²æ­¢è°åº¦æ­»å¾ªç¯åè¯¯é©±éã</li>

</ul>
<p data-tool="mdniceç¼è¾å¨">ç¸å³ PRï¼</p>
<p data-tool="mdniceç¼è¾å¨">https://github.com/volcano-sh/volcano/pull/4794,<br>
https://github.com/volcano-sh/volcano/pull/4659,<br>
https://github.com/volcano-sh/volcano/pull/4919<br>
æè°¢ç¤¾åºå¼åèï¼@guoqinwill, @hajnalmt</p>
<h2 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>æ¯æ Kubernetes 1.34</strong></span></span></h2>
<p data-tool="mdniceç¼è¾å¨">Volcano çæ¬ç´§è· Kubernetes ç¤¾åºãv1.14 å·²å¨é¢æ¯æææ°ç Kubernetes v1.34ï¼å¹¶éè¿å®æ´çååæµè¯å E2E æµè¯ä¿éåè½ä¸ç¨³å®æ§ã<br>
ç¸å³ PRï¼https://github.com/volcano-sh/volcano/pull/4704<br>
æè°¢ç¤¾åºå¼åèï¼@suyiiyii, @tunedev</p>
<h1 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>æ»ç»ï¼Volcano v1.14.0 â AI æ¶ä»£çç»ä¸è°åº¦å¹³å°</strong></span></span></h1>
<p data-tool="mdniceç¼è¾å¨">Volcano v1.14 æ¯ä¸ä¸ªéç¨ç¢å¼ççæ¬ãéè¿å¼å¥å¤è°åº¦å¨æ¶æå Agent Schedulerï¼Volcano æ­£å¼è¿å¥ç»ä¸è°åº¦å¹³å°æ°é¶æ®µï¼æ¢è½é«æå¤çæ¹é AI è®­ç»ï¼åè½æ»¡è¶³ AI Agent çæè´æ¶å»¶è¦æ±ãç½ç»æææç¥å¢å¼ºãéç¨æä½ç³»ç»æ··é¨æ¯æãæè¾ vNPU éæï¼è¿ä¸æ­¥å¤¯å®äº Volcano å¨ AI åºç¡è®¾æ½é¢åçé¢åå°ä½ã<br>
åæ¶ï¼Volcano Global v0.3.0 éè¿ HyperJob å®ç°å¤§è§æ¨¡åå¸å¼è®­ç»åæ°æ®æç¥è°åº¦ï¼æ©å±äºå¤éç¾¤è½åãVolcano Dashboard v0.2.0 éè¿å¨é¢çèµæºç®¡çåè½æ¾èæ¹åäºç¨æ·ä½éªã</p>
<p data-tool="mdniceç¼è¾å¨"><strong>ç«å³ä½éª Volcano v1.14ï¼å±å¯ AI æ¶ä»£ç»ä¸è°åº¦æ°ç¯ç« ï¼</strong></p>
<p data-tool="mdniceç¼è¾å¨"><strong>v1.14.0 åå¸å°åï¼</strong>https://github.com/volcano-sh/volcano/releases/tag/v1.14.0<br>
<strong>Volcano Global v0.3.0 åå¸å°åï¼</strong>https://github.com/volcano-sh/volcano-global/releases/tag/v0.3.0<br>
<strong>Volcano Dashboard v0.2.0 åå¸å°åï¼</strong>https://github.com/volcano-sh/dashboard/releases/tag/v0.2.0</p>
<h1 data-tool="mdniceç¼è¾å¨"><span class="prefix"><span class="content"><strong>è´   è°¢</strong></span></span></h1>
<p data-tool="mdniceç¼è¾å¨">Volcano v1.14 çæçæ¬ï¼å« Volcano Global v0.3.0ãDashboard v0.2.0ï¼å±æ 55 ä½ç¤¾åºè´¡ç®èåä¸ãè¡·å¿æè°¢æ¯ä¸ä½è´¡ç®èï¼</p>
<table data-draft-node="block" data-draft-type="table" data-size="normal">
<tbody>
<tr><th>@3sunny</th><th>@3th4novo</th><th>@acsoto</th>
</tr>
<tr>
<td>@Alivestars24</td>
<td>@Aman-Cool</td>
<td>@anryko</td>


</tr>
<tr>
<td>@archlitchi</td>
<td>@dafu-wu</td>
<td>@DSFans2014</td>


</tr>
<tr>
<td>@FAUST-BENCHOU</td>
<td>@fengruotj</td>
<td>@Freshwlnd</td>


</tr>
<tr>
<td>@fx147</td>
<td>@goyalpalak18</td>
<td>@guoqinwill</td>


</tr>
<tr>
<td>@Haibara-Ai97</td>
<td>@hajnalmt</td>
<td>@halcyon-r</td>


</tr>
<tr>
<td>@handan-yxh</td>
<td>@JackyTYang</td>
<td>@jayesh9747</td>


</tr>
<tr>
<td>@JesseStutler</td>
<td>@jiahuat</td>
<td>@karanBRAVO</td>


</tr>
<tr>
<td>@kingeasternsun</td>
<td>@kiritoxkiriko</td>
<td>@kube-gopher</td>


</tr>
<tr>
<td>@kuldeep</td>
<td>@LiZhenCheng9527</td>
<td>@medyagh</td>


</tr>
<tr>
<td>@MondayCha</td>
<td>@Monokaix</td>
<td>@mvinchoo</td>


</tr>
<tr>
<td>@neeraj542</td>
<td>@nitindhiman314e</td>
<td>@ouyangshengjia</td>


</tr>
<tr>
<td>@PersistentJZH</td>
<td>@qi-min</td>
<td>@rhh777</td>


</tr>
<tr>
<td>@ruanwenjun</td>
<td>@RushabhMehta2005</td>
<td>@sailorvii</td>


</tr>
<tr>
<td>@Sayan4444</td>
<td>@Shrutim1505</td>
<td>@ssfffss</td>


</tr>
<tr>
<td>@suyiiyii</td>
<td>@tanberBro</td>
<td>@Tau721</td>


</tr>
<tr>
<td>@vzhou-p</td>
<td>@wangyang0616</td>
<td>@weapons97</td>


</tr>
<tr>
<td>@Wonki4</td>
<td>@zhaoqi612</td>
<td>@zhengchenyu</td>


</tr>
<tr>
<td>@zhoujinyu</td>
<td>@zjj2wry</td>
<td>&nbsp;</td>


</tr>


</tbody>


</table>
<p data-tool="mdniceç¼è¾å¨"><strong>ç¸å³é¾æ¥</strong></p>
<p data-tool="mdniceç¼è¾å¨">[1] Volcano: <em>https://volcano.sh/en/</em><br>
[2] Volcano v1.14.0: <em>https://github.com/volcano-sh/volcano/releases/tag/v1.14.0</em><br>
[3] Sharding Controller Design: <em>https://github.com/volcano-sh/volcano/blob/v1.14.0/docs/design/sharding_controller.md</em><br>
[4] Agent Scheduler Design: <em>https://github.com/volcano-sh/volcano/blob/v1.14.0/docs/design/agent-scheduler.md</em><br>
[5] Network Topology Aware Scheduling: <em>https://github.com/volcano-sh/volcano/blob/v1.14.0/docs/design/Network%20Topology%20Aware%20Scheduling.md</em><br>
[6] CPU Throttle Design: <em>https://github.com/volcano-sh/volcano/blob/v1.14.0/docs/design/cpu-throttle-design.md</em><br>
[7] Agent Cgroup V2 Adaptation: <em>https://github.com/volcano-sh/volcano/blob/v1.14.0/docs/design/agent-cgroup-v2-adaptation.md</em><br>
[8] How to Use vNPU: <em>https://github.com/volcano-sh/volcano/blob/v1.14.0/docs/user-guide/how_to_use_vnpu.md</em><br>
[9] Volcano Global v0.3.0 Release Notes: <em>https://github.com/volcano-sh/volcano-global/releases/tag/v0.3.0</em><br>
[10] Volcano Dashboard v0.2.0 Release Notes: <em>https://github.com/volcano-sh/dashboard/releases/tag/v0.2.0</em></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-13 16:36">2026-02-13 16:35</span>&nbsp;
<a href="https://www.cnblogs.com/huaweiyun">åä¸ºäºå¼åèèç</a>&nbsp;
éè¯»(<span id="post_view_count">57</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19612682);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19612682', targetLink: 'https://www.cnblogs.com/huaweiyun/p/19612682', title: 'Volcano v1.14 éç£åå¸ï¼è¿å AI ç»ä¸è°åº¦æ°çºªå' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ LLVMçæ··æ·ä¹æ(å­)-å­ç¬¦ä¸²å å¯ ]]></title>
    <link>https://www.cnblogs.com/ClownLMe/p/19612575</link>
    <guid>bf84290cda53660299f960c2091a7091</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ClownLMe/p/19612575" title="åå¸äº 2026-02-13 16:11">
    <span role="heading" aria-level="2">LLVMçæ··æ·ä¹æ(å­)-å­ç¬¦ä¸²å å¯</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ç®ä»">ç®ä»</h1>
<p>å¨ä¸ä¸ä¸ªæå­¦ä¸­ï¼å­¦ä¹ äºå¦ä½åä¸ä¸ªLLVM Passç¤ºä¾æ¥è¿è¡æ§å¶æµå¹³å¦åï¼è¿ç¯æç« ï¼æ¥å­¦ä¹ å¦ä½äºå©ç¨LLVMå®ç°å­ç¬¦ä¸²çå å¯ã</p>
<h1 id="æ¡ä¾">æ¡ä¾</h1>
<h3 id="éè¦å å¯çå¯¹è±¡">éè¦å å¯çå¯¹è±¡</h3>
<p>è¿æ¯ä¸ä¸ªç»å¸çcè¯­è¨æ ·ä¾ï¼ç®çæ¯è¾åºå­ç¬¦ä¸²ï¼hello world</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

int main(){
&nbsp; &nbsp; printf("hello world\n");
&nbsp; &nbsp; return 0;
}
</code></pre>
<h3 id="å å¯passç¼å">å å¯passç¼å</h3>
<p>ä¸é¢æ¯å®æ´çpassä»£ç ï¼<br>
<mark><strong>ä»£ç çç®çæ¯ï¼è®©å­ç¬¦ä¸²å¨ç¼è¯çè¿ç¨ä¸­è¿è¡å¼æå å¯ï¼å¹¶ä¸å¨è¿è¡çè¿ç¨ä¸­å¨æè§£å¯ã</strong></mark></p>
<pre><code class="language-cpp">#include "llvm/Passes/PassBuilder.h"
#include "llvm/Passes/PassPlugin.h"
#include "llvm/Support/raw_ostream.h"
#include "llvm/IR/Function.h"
#include "llvm/IR/Instructions.h"
#include "llvm/IR/IRBuilder.h"
#include "llvm/IR/PassManager.h"
#include "llvm/IR/GlobalVariable.h"
#include "llvm/IR/Constants.h"

using namespace llvm;

namespace{
    struct mypass : public PassInfoMixin&lt;mypass&gt;{
        const uint8_t KEY = 0x42;

        Function *createDecryptFunc(Module *M){
            LLVMContext &amp;Ctx = M-&gt;getContext();
            std::vector&lt;Type*&gt; paramTypes = { PointerType::getUnqual(Ctx), Type::getInt32Ty(Ctx) };
            FunctionType *funcType = FunctionType::get(Type::getVoidTy(Ctx),paramTypes,false);

            Function *Func = Function::Create(funcType, GlobalValue::InternalLinkage, "my_decrypt_func", M);

            Argument *ArgData = Func-&gt;getArg(0);
            Argument *ArgLen  = Func-&gt;getArg(1);

            BasicBlock *EntryBB = BasicBlock::Create(Ctx, "entry", Func);
            BasicBlock *LoopCheckBB = BasicBlock::Create(Ctx, "loop_check", Func);
            BasicBlock *LoopBodyBB  = BasicBlock::Create(Ctx, "loop_body", Func);
            BasicBlock *ExitBB      = BasicBlock::Create(Ctx, "exit", Func);

            IRBuilder&lt;&gt; builder(EntryBB);
            builder.CreateBr(LoopCheckBB);
            builder.SetInsertPoint(LoopCheckBB);

            PHINode *LoopVar = builder.CreatePHI(Type::getInt32Ty(Ctx), 2, "i");
            LoopVar-&gt;addIncoming(builder.getInt32(0), EntryBB); 

            Value *Cond = builder.CreateICmpSLT(LoopVar, ArgLen, "cond");
            builder.CreateCondBr(Cond, LoopBodyBB, ExitBB);

            builder.SetInsertPoint(LoopBodyBB);

            Value *Ptr = builder.CreateInBoundsGEP(builder.getInt8Ty(), ArgData, LoopVar);
            Value *ByteVal = builder.CreateLoad(builder.getInt8Ty(), Ptr);
            Value *XorVal = builder.CreateXor(ByteVal, builder.getInt8(KEY));
            builder.CreateStore(XorVal, Ptr);

            Value *NextVar = builder.CreateAdd(LoopVar, builder.getInt32(1));
            LoopVar-&gt;addIncoming(NextVar, LoopBodyBB);

            builder.CreateBr(LoopCheckBB);
            builder.SetInsertPoint(ExitBB);
            builder.CreateRetVoid();

            return Func;
        }
        PreservedAnalyses run(Module &amp;M, ModuleAnalysisManager &amp;AM){
            errs() &lt;&lt; "Running On-Demand String Encryption Pass...\n";
            std::vector&lt;GlobalVariable*&gt; EncryptedGlobals;
            for(GlobalVariable &amp;GV : M.globals()){
                if (!GV.hasInitializer() || !GV.isConstant() || GV.getName().contains("llvm.")) continue;

                Constant *Init = GV.getInitializer();
                ConstantDataArray* DataArray = dyn_cast&lt;ConstantDataArray&gt;(Init);

                if(DataArray &amp;&amp; DataArray-&gt;isString()){
                    StringRef OriginalString = DataArray-&gt;getAsString();

                    if(OriginalString.size() &lt; 2) continue;

                    errs() &lt;&lt; "Encrypting string: " &lt;&lt; OriginalString &lt;&lt; "\n";
                    std::string EncryptedStr = OriginalString.str();
                    for(int i = 0; i &lt; EncryptedStr.size(); i++){
                        EncryptedStr[i] ^= KEY;
                    }

                    Constant *NewInit = ConstantDataArray::getString(M.getContext(), EncryptedStr, false);
                    GV.setInitializer(NewInit);
                    GV.setConstant(false);
                    
                    EncryptedGlobals.push_back(&amp;GV);
                }
            }

            if(EncryptedGlobals.empty()) return PreservedAnalyses::all();

            Function *DecryptFunc = createDecryptFunc(&amp;M);

            for(GlobalVariable *GV : EncryptedGlobals){
                std::vector&lt;Instruction*&gt; user;
                for(User *U: GV-&gt;users()){
                    Instruction* ins = dyn_cast&lt;Instruction&gt;(U);
                    if(ins-&gt;getFunction() == DecryptFunc) continue;
                    user.push_back(ins);
                }
                
                for(Instruction *ins : user){
                    IRBuilder&lt;&gt; builder(ins);
                    ConstantDataArray* DataArray = dyn_cast&lt;ConstantDataArray&gt;(GV-&gt;getInitializer());
                    int len = DataArray-&gt;getNumElements();
                    builder.CreateCall(DecryptFunc, {GV, builder.getInt32(len)});
                }
            }
            return PreservedAnalyses::none();
        }
    };
}

extern "C" LLVM_ATTRIBUTE_WEAK ::llvm::PassPluginLibraryInfo
llvmGetPassPluginInfo(){
    return{
        LLVM_PLUGIN_API_VERSION,
        "mypass",
        "v0.1",
        [](PassBuilder &amp;PB){
            PB.registerPipelineParsingCallback(
                [](StringRef Name, ModulePassManager &amp;MPM, ArrayRef&lt;PassBuilder::PipelineElement&gt;){
                    if(Name == "mypass"){
                        MPM.addPass(mypass());
                        return true;
                    }
                    return false;
                }
            );
        }
    };
}
</code></pre>
<h3 id="ä»£ç è§£é">ä»£ç è§£é</h3>
<p>çå°ä¸é¢çpassä»£ç ï¼æä»¬ä¼æå°å¤´æç®ç©ï¼æ²¡å³ç³»ï¼ä¸é¢æä»¬ä¸æ­¥æ­¥æè§£ã<br>
ä¸é¢çä»£ç åä¸»è¦åä¸ºä¸¤é¨åï¼</p>
<ol>
<li>æå»ºå¼æçè§£å¯å½æ°ï¼<code>createDecryptFunc</code>ï¼</li>
<li>å å¯å­ç¬¦ä¸²ï¼å¹¶ä¸å°ä¸é¢æå»ºçè§£å¯å½æ°æå¥ä»£ç ã</li>
</ol>
<h3 id="cmakeliststxt">CMakeLists.txt</h3>
<p>ç¼è¯å¯ä»¥ç´æ¥ç¨ä¸é¢çcmakeéç½®æä»¶ï¼ç¼è¯è¿ç¨å¨ä¹åæç« è¯¦ç»è®²è§£</p>
<pre><code class="language-python">cmake_minimum_required(VERSION 4.1.1)
project(mypass) 

set(LLVM_DIR "D:/LLVM/llvm-project/build/lib/cmake/llvm")
find_package(LLVM REQUIRED CONFIG)
list(APPEND CMAKE_MODULE_PATH "${LLVM_CMAKE_DIR}")
include(AddLLVM)
include_directories(${LLVM_INCLUDE_DIRS})
add_definitions(${LLVM_DEFINITIONS})
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

add_library(mypass MODULE mypass.cpp)
set_target_properties(mypass PROPERTIES WINDOWS_EXPORT_ALL_SYMBOLS ON) 
target_link_libraries(mypass LLVMCore LLVMSupport)     
target_compile_options(mypass PRIVATE /utf-8)#ç¨ä¸­æ
</code></pre>
<h1 id="ä½¿ç¨ææå±ç¤º">ä½¿ç¨ææå±ç¤º</h1>
<h3 id="ç¼è¯å¹¶æ§è¡">ç¼è¯å¹¶æ§è¡</h3>
<p>å¾çä¸­å¯ä»¥çåºï¼å¯ä»¥æ­£å¸¸è¿è¡<br>
<img alt="å½ä»¤è¿è¡" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2450496/202602/2450496-20260213160118505-594712651.png" class="lazyload"></p>
<h3 id="åç¼è¯æ¥çåºå«">åç¼è¯æ¥çåºå«</h3>
<h4 id="åå§testexe">åå§test.exe</h4>
<p><img alt="å­ç¬¦ä¸²å å¯" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2450496/202602/2450496-20260213160124354-268770369.png" class="lazyload"></p>
<h4 id="å å¯test_optexe">å å¯test_opt.exe</h4>
<p><img alt="åå§" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2450496/202602/2450496-20260213160103496-2047084346.png" class="lazyload"></p>
<p>æ ¹æ®ä¸é¢çå¾çï¼å¯ä»¥çå°ï¼ä¸é¢ä½¿ç¨çpassï¼æåå°HelloWorldå å¯äºã</p>
<p><mark><strong>å¦æâ¤åæ¬¢â¤æ¬ç³»åæç¨ï¼å°±ç¹ä¸ªå³æ³¨å§ï¼åç»­ä¸å®ææ´æ°~</strong></mark></p>


</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/ClownLMe/" target="_blank">ClownLMe</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/ClownLMe/p/19612575" target="_blank">https://www.cnblogs.com/ClownLMe/p/19612575</a></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-13 16:11">2026-02-13 16:11</span>&nbsp;
<a href="https://www.cnblogs.com/ClownLMe">ClownLMe</a>&nbsp;
éè¯»(<span id="post_view_count">40</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19612575);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19612575', targetLink: 'https://www.cnblogs.com/ClownLMe/p/19612575', title: 'LLVMçæ··æ·ä¹æ(å­)-å­ç¬¦ä¸²å å¯' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Admin.NETå¼æºçå¾®æå¡æ¹é è®°å½ ]]></title>
    <link>https://www.cnblogs.com/shiningrise/p/19612443</link>
    <guid>996ff91c48ef758799e000eb0d8c119c</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/shiningrise/p/19612443" title="åå¸äº 2026-02-13 15:44">
    <span role="heading" aria-level="2">Admin.NETå¼æºçå¾®æå¡æ¹é è®°å½</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="adminnetå¼æºçå¾®æå¡æ¹é è®°å½">Admin.NETå¼æºçå¾®æå¡æ¹é è®°å½</h1>
<h2 id="å°adminnetcoreé¡¹ç®æåæä¸¤ä¸ªé¡¹ç®adminnetcommonadminnetcore">å°Admin.NET.Coreé¡¹ç®æåæä¸¤ä¸ªé¡¹ç®ï¼Admin.NET.Commonï¼Admin.NET.Core</h2>
<p>Admin.NET.Commonæ¾åºç¡å·¥å·ç±»</p>
<p>Admin.NET.Coreæ¾æ¡æ¶æ ¸å¿ç±»åº</p>
<h2 id="aspireappapphostä¸­çapphostcséç½®">AspireApp.AppHostä¸­çAppHost.cséç½®ï¼</h2>
<pre><code>using Aspire.Hosting;
using Aspire.Hosting.Dapr;
using AspireApp.AppHost;

var builder = DistributedApplication.CreateBuilder(args);

var postgresQL = builder.AddPostgres("postgresQL")
                        .WithImage("ankane/pgvector")
                        .WithImageTag("latest")
                        .WithLifetime(ContainerLifetime.Persistent)
                        .WithHealthCheck()
                        .WithPgWeb();
var postgres = postgresQL.AddDatabase("postgres");
var postgres2 = postgresQL.AddDatabase("postgres2");

//var redis = builder.AddRedis("redis").WithLifetime(ContainerLifetime.Persistent)
//                    .WithHealthCheck()
//                    .WithRedisCommander();

// ä½¿ç¨ RabbitMQ ä½ä¸º Pub/Sub ç»ä»¶
//var rabbitmq = builder.AddRabbitMQ("rabbitmq")
//                        .WithLifetime(ContainerLifetime.Persistent)
//                        .WithHealthCheck()
//                        .WithManagementPlugin();

// 1. å®ä¹å±äº«ç®å½çç»å¯¹è·¯å¾ï¼å»ºè®®æå admin-net-core çå®éç®å½æç¬ç«ç shared ç®å½ï¼
var uploadPath = Path.GetFullPath("../Admin.NET/Admin.NET.Core/wwwroot/upload");

// ç¡®ä¿ç®å½å­å¨
if (!Directory.Exists(uploadPath))
{
    Directory.CreateDirectory(uploadPath);
}

// Admin.NET.Core ä½¿ç¨ Furion ç Knife4j UIï¼ä¸ä½¿ç¨ Aspire ç Swagger UI
var core = builder.AddProject&lt;Projects.Admin_NET_Core&gt;("admin-net-core")
    .WithReference(postgres)
    .WaitFor(postgres)
    .WithSwaggerUI();

var baseApi = builder.AddProject&lt;Projects.Base&gt;("base")
    .WithReference(postgres2)
    .WithSwaggerUI()
    .WithReference(core)
    .WaitFor(postgres2)
    .WaitFor(core);

var yarp = builder.AddProject&lt;Projects.AspireApp_Yarp&gt;("aspireapp-yarp")
    .WithEndpoint( port: 5008, scheme: "http", name: "yarp-http")    // æå®å¯ä¸åç§°
    .WithEndpoint( port: 7008, scheme: "https", name: "yarp-https") // æå®å¯ä¸åç§°
    .WithReference(core)
    .WithReference(baseApi)
    .WaitFor(core)
    .WaitFor(baseApi);

//var frontend = builder.AddNodeApp(
//       "frontend",
//       scriptPath: "scripts/run-pnpm.cjs",
//       workingDirectory: "../Web",
//       args: new[] { "dev" }
//   )
//   .WithReference(yarp)
//   .WaitFor(yarp);

builder.Build().Run();


</code></pre>
<h2 id="aipç½å³aspireappyarp">AIPç½å³ï¼AspireApp.Yarp</h2>
<p>Program.cs</p>
<pre><code>var builder = WebApplication.CreateBuilder(args);

builder.AddServiceDefaults();
builder.Services.AddReverseProxy()
                .LoadFromConfig(builder.Configuration.GetSection("ReverseProxy"))
                .AddServiceDiscoveryDestinationResolver();

var app = builder.Build();

app.MapDefaultEndpoints();
app.MapReverseProxy();

app.MapGet("/", () =&gt; "Hello World!");

app.Run();

</code></pre>
<p>appsettings.json</p>
<pre><code>{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*",
  "ReverseProxy": {
    "Routes": {
      "core": {
        "ClusterId": "core",
        "Match": {
          "Path": "/core/{**remainder}"
        },
        "Transforms": [
          { "PathRemovePrefix": "/core" },
          { "PathPrefix": "/" },
          { "RequestHeaderOriginalHost": "true" }
        ]
      },
      "base": {
        "ClusterId": "base",
        "Match": {
          "Path": "/base/{**remainder}"
        },
        "Transforms": [
          { "PathRemovePrefix": "/base" },
          { "PathPrefix": "/" },
          { "RequestHeaderOriginalHost": "true" }
        ]
      }
    },
    "Clusters": {
      "core": {
        "Destinations": {
          "base_destination": {
            "Address": "http+https://admin-net-core"
          }
        }
      },
      "base": {
        "Destinations": {
          "base_destination": {
            "Address": "http+https://base"
          }
        }
      }
    }
  }
}
</code></pre>
<h2 id="ä¸å¡é¡¹ç®baseé¡¹ç®è°ç¨æ ¸å¿é¡¹ç®coreé¡¹ç®çæ¹æ³">ä¸å¡é¡¹ç®(baseé¡¹ç®)è°ç¨æ ¸å¿é¡¹ç®(coreé¡¹ç®ï¼çæ¹æ³</h2>
<p>æä»¬ä½¿ç¨Refitæ¥æå¡è°ç¨</p>
<p>å¨baseé¡¹ç®ä¸­çStartup.csä¸­</p>
<pre><code>        // æ³¨å JwtTokenHandler - ç¨äºèªå¨æ·»å  JWT Token å° Refit è¯·æ±
        services.AddTransient&lt;JwtTokenHandler&gt;();
        
        // éç½® Refit å®¢æ·ç«¯å¹¶æ·»å  JWT Token å¤çå¨
        //ç³»ç»éç½®
        services.AddRefitClient&lt;IConfigService&gt;(refitSettings)
               .ConfigureHttpClient(c =&gt; c.BaseAddress = new("https+http://admin-net-core"))
               .AddHttpMessageHandler&lt;JwtTokenHandler&gt;();
        //ç³»ç»èå     
        services.AddRefitClient&lt;IMenuService&gt;(refitSettings)
               .ConfigureHttpClient(c =&gt; c.BaseAddress = new("https+http://admin-net-core"))
               .AddHttpMessageHandler&lt;JwtTokenHandler&gt;();
        //ç»ç»æºæ
        services.AddRefitClient&lt;IOrgService&gt;(refitSettings)
               .ConfigureHttpClient(c =&gt; c.BaseAddress = new("https+http://admin-net-core"))
               .AddHttpMessageHandler&lt;JwtTokenHandler&gt;();
        //æä»¶
        services.AddRefitClient&lt;IFileService&gt;(refitSettings)
               .ConfigureHttpClient(c =&gt; c.BaseAddress = new("https+http://admin-net-core"))
               .AddHttpMessageHandler&lt;JwtTokenHandler&gt;();

        services.AddRefitClient&lt;ITest&gt;(refitSettings)
            .ConfigureHttpClient(c =&gt; c.BaseAddress = new("https+http://apiservice"))
            .AddHttpMessageHandler&lt;JwtTokenHandler&gt;();
</code></pre>
<p>å¶ä¸­æéè¦çæéæ¥å£è°ç¨</p>
<pre><code>using Refit;
using GetAttribute = Refit.GetAttribute;
namespace Base.Rest;

public interface IMenuService
{
    [Get("/api/sysMenu/getOwnBtnPermList")]
    Task&lt;List&lt;string&gt;&gt; GetOwnBtnPermList();

    [Get("/api/sysMenu/getAllBtnPermList")]
    Task&lt;List&lt;string&gt;&gt; GetAllBtnPermList();
}
</code></pre>
<p>ä¿®æ¹baseé¡¹ç®çæééªè¯æ¹æ³JwtHandler.cs</p>
<p>IConfigService  IMenuService å°±æ¯æä»¬å®ä¹çRefitæ¥å£ï¼è¿æ ·ï¼æ¯æ¬¡æééªè¯å°±ä¼è°ç¨coreé¡¹ç®çAPIæ¥å£</p>
<pre><code>using Admin.NET.Core;
using Admin.NET.Core.Service;
using Base.Rest;
using Furion;
using Furion.Authorization;
using Furion.DataEncryption;
using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Http;
using System;
using System.Threading.Tasks;

namespace Admin.NET.Application;

public class JwtHandler : AppAuthorizeHandler
{
    private readonly SysCacheService _sysCacheService = App.GetRequiredService&lt;SysCacheService&gt;();
    private readonly IConfigService _sysConfigService = App.GetRequiredService&lt;IConfigService&gt;();
    private static readonly IMenuService SysMenuService = App.GetRequiredService&lt;IMenuService&gt;();

    /// &lt;summary&gt;
    /// èªå¨å·æ°Token
    /// &lt;/summary&gt;
    /// &lt;param name="context"&gt;&lt;/param&gt;
    /// &lt;param name="httpContext"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    public override async Task HandleAsync(AuthorizationHandlerContext context, DefaultHttpContext httpContext)
    {
        // è¥å½åè´¦å·å­å¨é»ååä¸­åææå¤±è´¥
        if (_sysCacheService.ExistKey($"{CacheConst.KeyBlacklist}{context.User.FindFirst(ClaimConst.UserId)?.Value}"))
        {
            context.Fail();
            context.GetCurrentHttpContext().SignoutToSwagger();
            return;
        }

        var tokenExpire = await _sysConfigService.GetTokenExpire();
        var refreshTokenExpire = await _sysConfigService.GetRefreshTokenExpire();
        if (JWTEncryption.AutoRefreshToken(context, context.GetCurrentHttpContext(), tokenExpire.Result, refreshTokenExpire.Result))
        {
            await AuthorizeHandleAsync(context);
        }
        else
        {
            context.Fail(); // ææå¤±è´¥
            var currentHttpContext = context.GetCurrentHttpContext();
            if (currentHttpContext == null) return;

            // è·³è¿ç±äº SignatureAuthentication å¼åçå¤±è´¥
            if (currentHttpContext.Items.ContainsKey(SignatureAuthenticationDefaults.AuthenticateFailMsgKey)) return;
            currentHttpContext.SignoutToSwagger();
        }
    }

    public override async Task&lt;bool&gt; PipelineAsync(AuthorizationHandlerContext context, DefaultHttpContext httpContext)
    {
        // å·²èªå¨éªè¯ Jwt Token æææ§
        return await CheckAuthorizeAsync(httpContext);
    }

    /// &lt;summary&gt;
    /// æéæ ¡éªæ ¸å¿é»è¾
    /// &lt;/summary&gt;
    /// &lt;param name="httpContext"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    private static async Task&lt;bool&gt; CheckAuthorizeAsync(DefaultHttpContext httpContext)
    {
        // ç»å½æ¨¡å¼å¤æ­PCãAPP
        if (App.User.FindFirst(ClaimConst.LoginMode)?.Value == ((int)LoginModeEnum.APP).ToString())
            return true;

        // æé¤è¶ç®¡
        if (App.User.FindFirst(ClaimConst.AccountType)?.Value == ((int)AccountTypeEnum.SuperAdmin).ToString())
            return true;

        // è·¯ç±åç§°
        var routeName = httpContext.Request.Path.StartsWithSegments("/api")
            ? httpContext.Request.Path.Value![5..].Replace("/", ":")
            : httpContext.Request.Path.Value![1..].Replace("/", ":");

        // è·åç¨æ·æ¥ææé®æééå
        var ownBtnPermList = await SysMenuService.GetOwnBtnPermList();
        if (ownBtnPermList.Exists(u =&gt; routeName.Equals(u, StringComparison.CurrentCultureIgnoreCase)))
            return true;

        // è·åç³»ç»æææé®æééå
        var allBtnPermList = await SysMenuService.GetAllBtnPermList();
        return allBtnPermList.TrueForAll(u =&gt; !routeName.Equals(u, StringComparison.CurrentCultureIgnoreCase));
    }
}
</code></pre>
<h2 id="é¡¹ç®å°å">é¡¹ç®å°å</h2>
<p><a href="https://gitee.com/shiningrise/aspire-app" target="_blank" rel="noopener nofollow">AspireApp: Admin.NETå¾®æå¡ç</a></p>
<p><a href="https://gitee.com/zuohuaijun/Admin.NET" target="_blank" rel="noopener nofollow">Admin.NET: ð¥ð¥ð¥ Admin.NET åºäº .NET8/10 (Furion/SqlSugar) å®ç°çéç¨æéå¼åæ¡æ¶ï¼åç«¯éç¨ Vue3/Element-plusï¼ä»£ç ç®æ´ãææ©å±ãæ´åææ°ææ¯ï¼æ¨¡åæä»¶å¼å¼åï¼ååç«¯åç¦»ï¼å¼ç®±å³ç¨ãéæå¤ç§æ·ãç¼å­ãæ°æ®æ ¡éªãé´æãäºä»¶æ»çº¿ãå¨æAPIãéè®¯ãè¿ç¨è¯·æ±ãä»»å¡è°åº¦ãæå°ç­ä¼å¤é»ç§æãè®©å¼åæ´ç®åãæ´éç¨ãæ´æµè¡ï¼</a></p>


</div>
<div id="MySignature" role="contentinfo">
    æ¬¢è¿åä¸´:<font size="3"><font size="3"><a href="http://shiningrise.cnblogs.com/" target="_blank"><font size="3"><font size="3">http://shiningrise.cnblogs.com</font></font></a><br><br></font></font>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-13 15:44">2026-02-13 15:44</span>&nbsp;
<a href="https://www.cnblogs.com/shiningrise">shiningrise</a>&nbsp;
éè¯»(<span id="post_view_count">143</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19612443);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19612443', targetLink: 'https://www.cnblogs.com/shiningrise/p/19612443', title: 'Admin.NETå¼æºçå¾®æå¡æ¹é è®°å½' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Nano-vLLM-Ascend(æç»­æ´æ°ä¸­) ]]></title>
    <link>https://www.cnblogs.com/linzm14/p/19611415</link>
    <guid>77ceb1205f83ea4bef6298d3e832fb96</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/linzm14/p/19611415" title="åå¸äº 2026-02-13 11:38">
    <span role="heading" aria-level="2">Nano-vLLM-Ascend(æç»­æ´æ°ä¸­)</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="nano-vllm-ascend"><a href="https://github.com/linzm1007/nano-vllm-ascend" target="_blank" rel="noopener nofollow">Nano-vLLM-Ascend</a></h2>
<p>é¡¹ç®é¾æ¥ï¼<a href="https://github.com/linzm1007/nano-vllm-ascend" target="_blank" rel="noopener nofollow">https://github.com/linzm1007/nano-vllm-ascend</a><br>
nano-vllmæ¯githubå¼æºçä¸ä¸ªgpuæ¨çé¡¹ç®ï¼åºäºå¼æºçæ¬å¼çä¸ä¸ªascend npuçæ¬æ¨çå°demoï¼æ¨å¨å¸®å©åå­¦èäºè§£æ¨ççæ´ä½æµç¨ï¼åºå«äºvllmï¼nano-vllmä½éæ´å°ï¼éº»éè½å°äºèä¿±å¨ï¼æ´æå©äºåå­¦èå­¦ä¹ ï¼éå¸¸éåç¨äºç¸å³æ¦å¿µççè§£ã</p>
<h2 id="æ¡æ¶å±æµç¨å¾">æ¡æ¶å±æµç¨å¾</h2>
<p><img alt="nona-vllmæ¡æ¶" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2257481/202512/2257481-20251207210704152-770371883.png" class="lazyload"></p>
<h2 id="æ¨¡åå±æµç¨å¾">æ¨¡åå±æµç¨å¾</h2>
<p><img alt="Qwen3-0.6B" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2257481/202602/2257481-20260213113258305-186035462.png" class="lazyload"></p>
<h2 id="ç¹æ§">ç¹æ§</h2>
<ul>
<li>ð <strong>å¯è¯»ä»£ç åº</strong> - æ ¸å¿çº¦2428è¡Pythonä»£ç çæ¸æ°å®ç°</li>
<li>â¡ <strong>ä¼åå¥ä»¶</strong> - å¼ éå¹¶è¡ãtorchair Ascend IRå¾ç¼è¯åå¾ç¼å­ãèåç®å­ãåç¼ç¼å­ç­</li>
</ul>
<ul>
<li>[â] å¾å®æï¼ç®ååªæ¯æåç®å­, npuå¾æ¨¡å¼å®ç°</li>
<li>[â] æ¯æCPUç¯å¢è¿è¡ï¼<a href="https://github.com/linzm1007/nano-vllm-cpu" target="_blank" rel="noopener nofollow">nano-vllm-cpu ä»£ç ä»åº</a></li>
<li>[â] æ§è½ä¼å</li>
<li>[â³] æ¯ææ¨¡å: Qwen3-0.6BãQwen3-32BãQwen2-0.5BãQwen2.5-0.5BãQwen2.5-0.5B-InstructãLlama-3.2-1B-InstructãQwen3-30B-A3BãQwen3-VL-2B-InstructãMiniCPM4-0.5B</li>
<li>[â] æ¯æä¸ä¸ªmoeæ¨¡å:Qwen3-30B-A3B(ææ¶ä¸æ¯æå¥å¾)</li>
<li>[ð] æ¯æä¸ä¸ªomniæ¨¡å</li>
<li>[â] æ¯æä¸ä¸ªvlæ¨¡å:Qwen3-VL-2B-Instruct(ææ¶ä¸æ¯æå¥å¾)</li>
<li>[â] å®ç°page attention</li>
<li>[ð] å®ç°ä¸ä¸ªèªå®ä¹ç®å­</li>
<li>[ð] æ¯æå¨çº¿æ¨ç</li>
</ul>
<p>torchairæ¥å£åè <a href="https://www.hiascend.com/document/detail/zh/Pytorch/710/modthirdparty/torchairuseguide/torchair_00008.html" target="_blank" rel="noopener nofollow">https://www.hiascend.com/document/detail/zh/Pytorch/710/modthirdparty/torchairuseguide/torchair_00008.html</a><br>
èåç®å­æ¥å£åè <a href="https://www.hiascend.com/document/detail/zh/Pytorch/720/apiref/torchnpuCustomsapi/context/torch_npu-npu_fused_infer_attention_score_v2.md" target="_blank" rel="noopener nofollow">https://www.hiascend.com/document/detail/zh/Pytorch/720/apiref/torchnpuCustomsapi/context/torch_npu-npu_fused_infer_attention_score_v2.md</a><br>
attentionå®ç°åè <a href="https://gitee.com/omniai/omniinfer/blob/master/omni/layers/attention/backend/attention.py" target="_blank" rel="noopener nofollow">https://gitee.com/omniai/omniinfer/blob/master/omni/layers/attention/backend/attention.py</a>  forward_vanillaå½æ°</p>
<h2 id="æ¯æçæ¨¡å">æ¯æçæ¨¡å</h2>
<table>
<thead>
<tr>
<th>æ¶æ</th>
<th>æ¨¡å</th>
<th>ç¤ºä¾ HF æ¨¡å</th>
</tr>
</thead>
<tbody>
<tr>
<td>Qwen3ForCausalLM</td>
<td>Qwen3-0.6B,Qwen3-32B</td>
<td></td>
</tr>
<tr>
<td>Qwen2ForCausalLM</td>
<td>Qwen2-0.5B</td>
<td></td>
</tr>
<tr>
<td>LlamaForCausalLM</td>
<td>Llama-3.2-1B-Instruct</td>
<td></td>
</tr>
<tr>
<td>Qwen3MoeForCausalLM</td>
<td>Qwen3-30B-A3B</td>
<td></td>
</tr>
<tr>
<td>Qwen3VLForConditionalGeneration</td>
<td>Qwen2.5-VL-3B-Instruct</td>
<td></td>
</tr>
<tr>
<td>MiniCPMForCausalLM</td>
<td>MiniCPM4-0.5B</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="ä»£ç è¡æ°">ä»£ç è¡æ°</h2>
<p>ð æ»ä½æ°æ®</p>
<table>
<thead>
<tr>
<th>èå´</th>
<th>æä»¶æ°</th>
<th>æ»è¡æ°</th>
<th>å æ¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>nanovllm å¨é¨</td>
<td>20 ä¸ª</td>
<td>4,652 è¡</td>
<td>100%</td>
</tr>
<tr>
<td>models ç®å½</td>
<td>5 ä¸ª</td>
<td>2,224 è¡</td>
<td>47.8%</td>
</tr>
<tr>
<td>é¤ models å¤</td>
<td>15 ä¸ª</td>
<td>2,428 è¡</td>
<td>52.2%</td>
</tr>
</tbody>
</table>
<h2 id="æ¨çä¼åææ¯å¤§çº²">æ¨çä¼åææ¯å¤§çº²</h2>
<p>ð <strong>å®æ´ææ¯ææ¡£</strong>ï¼<a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/inference_optimization_guide.md" target="_blank" rel="noopener nofollow">LLM æ¨çä¼åææ¯å¤§çº²</a></p>
<p>æ¬ææ¡£æ´çäº LLM æ¨çé¢åç <strong>20 å¤§ç±»å³é®ææ¯</strong>ï¼åä¸º 7 ä¸ªå±æ¬¡ï¼</p>
<h3 id="-æ ¸å¿ææ¯åºç¡å¿å¤">ð¥ æ ¸å¿ææ¯ï¼åºç¡å¿å¤ï¼</h3>
<ul>
<li><strong>KV Cache ç®¡ç</strong>ï¼PageAttentionãPrefix CachingãKV Cache åç¼©</li>
<li><strong>Attention ä¼å</strong>ï¼FlashAttentionãGQA/MQAãç¨çæ³¨æå</li>
<li><strong>æ¹å¤çç­ç¥</strong>ï¼Continuous BatchingãDynamic Batching</li>
</ul>
<h3 id="-æ§è½ä¼åè¿é¶">ð æ§è½ä¼åï¼è¿é¶ï¼</h3>
<ul>
<li><strong>éåææ¯</strong>ï¼INT8/INT4/FP8ãAWQãGPTQãGGUF</li>
<li><strong>ææºéæ ·</strong>ï¼Speculative DecodingãMedusaãLookahead</li>
<li><strong>è§£ç ä¼å</strong>ï¼Parallel DecodingãToken Tree Verification</li>
</ul>
<h3 id="ï¸-ç³»ç»æ¶æ">ðï¸ ç³»ç»æ¶æ</h3>
<ul>
<li><strong>è°åº¦ç­ç¥</strong>ï¼FCFSãSJFãPriority-basedãPreemption</li>
<li><strong>åå­ä¼å</strong>ï¼Memory PoolãSwappingãOffloading</li>
<li><strong>å¹¶è¡ç­ç¥</strong>ï¼Tensor/Pipeline/Expert/Sequence Parallelism</li>
</ul>
<h3 id="-ç¹æ®åºæ¯">ð§  ç¹æ®åºæ¯</h3>
<ul>
<li><strong>é¿ä¸ä¸æ</strong>ï¼RoPE ScalingãStreamingLLMãRing Attention</li>
<li><strong>å¤æ¨¡æ</strong>ï¼Vision-LanguageãAudio-LanguageãUnified Architecture</li>
<li><strong>MoE ä¼å</strong>ï¼Expert RoutingãLoad BalancingãAll-to-All éä¿¡</li>
</ul>
<h3 id="-åºå±ä¼å">â¡ åºå±ä¼å</h3>
<ul>
<li><strong>å¾ç¼è¯</strong>ï¼TorchAirãTensorRT-LLMãTorch.compile</li>
<li><strong>ç®å­èå</strong>ï¼QKV FusionãCustom CUDA/Triton Kernels</li>
<li><strong>éä¿¡ä¼å</strong>ï¼NCCL/HCCLãRDMAãGPUDirect</li>
</ul>
<h3 id="-è¯ä¼°è§æµ">ð è¯ä¼°è§æµ</h3>
<ul>
<li><strong>æ§è½åæ</strong>ï¼Memory/Compute ProfilingãRoofline Analysis</li>
<li><strong>å³é®ææ </strong>ï¼TTFTãTPOTãThroughputãGPU Utilization</li>
</ul>
<h3 id="-åæ²¿è¶å¿">ð® åæ²¿è¶å¿</h3>
<ul>
<li><strong>æ¨¡åæ¶æ</strong>ï¼Mamba/RWKVãMixture of DepthsãRetNet</li>
<li><strong>æå¡å</strong>ï¼Disaggregated ServingãElastic Scaling</li>
<li><strong>æ°å´æ¹å</strong>ï¼æ¨çè¸é¦ãEarly ExitãHardware-Aware NAS</li>
</ul>
<hr>
<h2 id="attention">Attention</h2>
<h3 id="pageattention">PageAttention</h3>
<p><strong>PageAttention</strong> æ¯ vLLM çæ ¸å¿åæ°ææ¯ï¼çµææ¥èªæä½ç³»ç»ç<strong>èæåå­åé¡µæºå¶</strong>ï¼ç¨äºé«æç®¡ç LLM æ¨çä¸­ç KV Cacheã</p>
<h4 id="æ ¸å¿æ¦å¿µ">æ ¸å¿æ¦å¿µ</h4>
<p>ä¼ ç» KV Cache åéæ¹å¼ä¼ä¸ºæ¯ä¸ªåºåé¢åéæå¤§å¯è½é¿åº¦çè¿ç»­åå­ï¼å¯¼è´ä¸¥éçåå­æµªè´¹åç¢çãPageAttention åé´æä½ç³»ç»åé¡µææ³ï¼å° KV Cache ååä¸ºåºå®å¤§å°ç blockï¼æéå¨æåéã</p>
<h4 id="å³é®ææ¯ç¹">å³é®ææ¯ç¹</h4>
<table>
<thead>
<tr>
<th>ææ¯</th>
<th>è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Block ç®¡ç</strong></td>
<td>å° KV Cache ååä¸ºåºå®å¤§å°ç blockï¼å¦ 16/32 tokensï¼ï¼æ¯ä¸ª block ç¬ç«åé</td>
</tr>
<tr>
<td><strong>Block Table</strong></td>
<td>ç±»ä¼¼é¡µè¡¨çæ°æ®ç»æï¼è®°å½é»è¾ token ä½ç½®å°ç©ç block çæ å°å³ç³»</td>
</tr>
<tr>
<td><strong>éè¿ç»­å­å¨</strong></td>
<td>åä¸åºåç KV Cache å¯ä»¥åæ£å¨å¤ä¸ªä¸è¿ç»­ç block ä¸­</td>
</tr>
<tr>
<td><strong>åå­å±äº«</strong></td>
<td>å¹¶è¡è§£ç ï¼å¦ beam searchï¼æ¶å¯å±äº« prompt ç KV cache</td>
</tr>
<tr>
<td><strong>Copy-on-Write</strong></td>
<td>åæ¶å¤å¶æºå¶ï¼ä»å¨éè¦ä¿®æ¹æ¶æå¤å¶ block</td>
</tr>
</tbody>
</table>
<h4 id="åå­ä½¿ç¨å¯¹æ¯">åå­ä½¿ç¨å¯¹æ¯</h4>
<pre><code>ä¼ ç»æ¹å¼ï¼
- åºåé¿åº¦ 1000ï¼æå¤§æ¯æ 4096
- åå­å ç¨ï¼4096 * hidden_size
- æµªè´¹çï¼çº¦ 75%

PageAttentionï¼
- åºåé¿åº¦ 1000ï¼block_size=16
- éè¦ blockï¼1000/16 = 63 ä¸ª
- å®éåéï¼63 * 16 = 1008 tokens
- æµªè´¹çï¼ä» 0.8%
</code></pre>
<h4 id="ä»£ç å®ç°">ä»£ç å®ç°</h4>
<pre><code class="language-python"># nanovllm/layers/attention.py
# Block Table æ å°
block_table = context.block_tables  # æ å°è¡¨

# Slot Mapping - å° token æ å°å° block ä¸­çå·ä½ä½ç½®
# slot_mapping æ ¼å¼ï¼[block_idx, offset_in_block]
context.slot_mapping

# åé¡µå­å¨ KV Cache
torch_npu._npu_reshape_and_cache(
    k, v,
    k_cache.view(num_blocks, block_size, num_kv_heads, head_dim),
    v_cache.view(num_blocks, block_size, num_kv_heads, head_dim),
    slot_mapping.int()
)
</code></pre>
<h4 id="ä¼å¿">ä¼å¿</h4>
<ol>
<li><strong>åå­æç</strong>ï¼æéåéï¼æ åé¨ç¢ç</li>
<li><strong>å¨ææ©å±</strong>ï¼åºåå¢é¿æ¶åªéåéæ° block</li>
<li><strong>åå­å±äº«</strong>ï¼å¤ä¸ªåºåå¯å±äº«ç¸åç prompt KV Cache</li>
<li><strong>é«ååé</strong>ï¼æ¯ææ´å¤§ç batch size</li>
</ol>
<h4 id="è¯¦ç»å¯¹æ¯">è¯¦ç»å¯¹æ¯</h4>
<p>ð <strong>è¯¦ç»ææ¯ææ¡£</strong>ï¼<a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/pageattention_comparison.md" target="_blank" rel="noopener nofollow">HuggingFace Transformers æ©æå®ç°ä¸ PageAttention å¯¹æ¯</a></p>
<p>åå«ï¼</p>
<ul>
<li>æ©æ Transformers ä»£ç å®ç°åæ</li>
<li>åå­æµªè´¹çéåå¯¹æ¯ï¼75% vs 6.25%ï¼</li>
<li>ä¸å batch size ååºåé¿åº¦çè¯¦ç»å¯¹æ¯è¡¨</li>
<li>vLLM è®ºææ°æ®æ¥æºè¯´æ</li>
<li>å®éä»£ç ç¤ºä¾ååºæ¯åæ</li>
</ul>
<hr>
<h3 id="flashattention">FlashAttention</h3>
<p><strong>FlashAttention</strong> æ¯æ¯å¦ç¦å¤§å­¦æåºç <strong>IO æç¥</strong> æ³¨æåä¼åç®æ³ï¼éè¿ååè®¡ç®ååå° HBMï¼é«å¸¦å®½åå­ï¼è®¿é®æ¥æåæ§è½ã</p>
<h4 id="æ ¸å¿é®é¢">æ ¸å¿é®é¢</h4>
<p>æ å Attention å®ç°éè¦å­å¨ä¸­é´ç»æï¼æ³¨æåç©éµï¼å° HBMï¼å¯¼è´ï¼</p>
<ul>
<li><strong>åå­ç¶é¢</strong>ï¼HBM å¸¦å®½è¿ä½äºè®¡ç®éåº¦</li>
<li><strong>O(NÂ²) åå­</strong>ï¼åºåé¿åº¦çå¹³æ¹çº§åå­å¢é¿</li>
<li><strong>å¤æ¬¡æ°æ®æ¬è¿</strong>ï¼QãKãV éè¦å¤æ¬¡è¯»å HBM</li>
</ul>
<h4 id="æ ¸å¿åæ°">æ ¸å¿åæ°</h4>
<table>
<thead>
<tr>
<th>ææ¯</th>
<th>åç</th>
<th>ææ</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Tilingï¼ååï¼</strong></td>
<td>å° QãKãV ååå è½½å°é«é SRAM</td>
<td>åå° HBM è®¿é®æ¬¡æ°</td>
</tr>
<tr>
<td><strong>Online Softmax</strong></td>
<td>æµå¼è®¡ç® softmaxï¼æ éå®æ´æ³¨æåç©éµ</td>
<td>åå­éè³ O(N)</td>
</tr>
<tr>
<td><strong>Recomputation</strong></td>
<td>ååä¼ æ­æ¶éæ°è®¡ç®ä¸­é´å¼</td>
<td>çºç²è®¡ç®æ¢åå­</td>
</tr>
<tr>
<td><strong>Kernel Fusion</strong></td>
<td>å¤ä¸ªæä½èåä¸ºåä¸ª CUDA kernel</td>
<td>åå° kernel å¯å¨å¼é</td>
</tr>
</tbody>
</table>
<h4 id="åå­å±æ¬¡ç»æå¯¹æ¯">åå­å±æ¬¡ç»æå¯¹æ¯</h4>
<pre><code>GPU åå­å±æ¬¡ï¼
âââââââââââââââââââââââââââââââââââââââ
â  HBM (High Bandwidth Memory)        â  â 1.5 TB/sï¼å®¹éå¤§ä½éåº¦æ¢
â  - å®¹éï¼40-80 GB                   â  â æ å Attention å¨æ­¤é¢ç¹è¯»å
â  - å»¶è¿ï¼é«                         â
âââââââââââââââââââââââââââââââââââââââ¤
â  SRAM (Static RAM / Shared Memory)  â  â 19 TB/sï¼å®¹éå°ä½éåº¦å¿«
â  - å®¹éï¼~100 KB per SM             â  â FlashAttention ä¸»è¦å¨æ­¤è®¡ç®
â  - å»¶è¿ï¼æä½                       â
âââââââââââââââââââââââââââââââââââââââ
</code></pre>
<h4 id="è®¡ç®æµç¨å¯¹æ¯">è®¡ç®æµç¨å¯¹æ¯</h4>
<p><strong>æ å Attentionï¼</strong></p>
<pre><code>1. ä» HBM å è½½ Q, K, V
2. è®¡ç® S = QK^T â åå¥ HBM
3. è®¡ç® P = softmax(S) â åå¥ HBM  
4. è®¡ç® O = PV â åå¥ HBM
â å¤æ¬¡ HBM è¯»åï¼åå­å ç¨ O(NÂ²)
</code></pre>
<p><strong>FlashAttentionï¼</strong></p>
<pre><code>1. ååå è½½ Qáµ¢, Kâ±¼, Vâ±¼ å° SRAM
2. å¨ SRAM ä¸­è®¡ç® softmax
3. ç´¯å ç»æå°è¾åº
4. ä¸¢å¼ä¸­é´ç»æï¼éå¤ç´å°å®æ
â ä»é O(N) åå­ï¼å¤§å¹åå° HBM è®¿é®
</code></pre>
<h4 id="ä»£ç å®ç°-1">ä»£ç å®ç°</h4>
<pre><code class="language-python"># nanovllm/layers/attention_ori.py
from flash_attn import (
    flash_attn_varlen_func,      # Prefill é¶æ®µ
    flash_attn_with_kvcache      # Decode é¶æ®µ
)

# Prefill - å¤çåé¿åºåï¼æ¯æ PageAttention
flash_attn_varlen_func(
    q, k, v,
    max_seqlen_q=max_seqlen_q,
    cu_seqlens_q=cu_seqlens_q,    # ç´¯è®¡é¿åº¦æ¯æåé¿
    causal=True,                  # å ææ©ç 
    block_table=block_table       # PageAttention block table
)

# Decode - å token æ¨çï¼å¤ç¨åé¡µ KV Cache
flash_attn_with_kvcache(
    q.unsqueeze(1),               # [batch, 1, num_heads, head_dim]
    k_cache, v_cache,             # åé¡µ KV ç¼å­
    cache_seqlens=context_lens,   # å®éåºåé¿åº¦
    block_table=block_table       # block table æ å°
)
</code></pre>
<h4 id="æ§è½æ¶ç">æ§è½æ¶ç</h4>
<ul>
<li><strong>åå­æç</strong>ï¼ä» O(NÂ²) éè³ O(N)</li>
<li><strong>è®¡ç®éåº¦</strong>ï¼A100 ä¸å¯è¾¾ <strong>2-4 å</strong>å é</li>
<li><strong>åºåé¿åº¦</strong>ï¼æ¯ææ´é¿çä¸ä¸æï¼å¦ 100K+ tokensï¼</li>
</ul>
<hr>
<h3 id="ä¸ç§-attention-å®ç°å¯¹æ¯">ä¸ç§ Attention å®ç°å¯¹æ¯</h3>
<p>æ¬é¡¹ç®åå«ä¸ç§ Attention å®ç°ï¼éç¨äºä¸ååºæ¯ï¼</p>
<table>
<thead>
<tr>
<th>ç¹æ§</th>
<th>attention_ori.py</th>
<th>attention.py</th>
<th>attention_torch_native.py</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>åºå±å®ç°</strong></td>
<td>Flash Attention åº</td>
<td>NPU åçç®å­</td>
<td>PyTorch åç</td>
</tr>
<tr>
<td><strong>éç¨å¹³å°</strong></td>
<td>CUDA GPU</td>
<td>åä¸ºæè¾ NPU</td>
<td>éç¨ï¼CPU/GPUï¼</td>
</tr>
<tr>
<td><strong>æ§è½</strong></td>
<td>â­â­â­â­â­</td>
<td>â­â­â­â­â­</td>
<td>â­â­</td>
</tr>
<tr>
<td><strong>å¯è¯»æ§</strong></td>
<td>â­â­</td>
<td>â­â­</td>
<td>â­â­â­â­â­</td>
</tr>
<tr>
<td><strong>ç¨é</strong></td>
<td>çäº§ç¯å¢ï¼GPUï¼</td>
<td>çäº§ç¯å¢ï¼NPUï¼</td>
<td>å­¦ä¹ è°è¯</td>
</tr>
</tbody>
</table>
<p><strong>éæ©å»ºè®®ï¼</strong></p>
<ul>
<li><strong>çäº§ç¯å¢ï¼GPUï¼</strong>ï¼ä½¿ç¨ <code>attention_ori.py</code>ï¼Flash Attentionï¼</li>
<li><strong>çäº§ç¯å¢ï¼æè¾ NPUï¼</strong>ï¼ä½¿ç¨ <code>attention.py</code>ï¼NPU ç®å­ï¼</li>
<li><strong>å­¦ä¹ /è°è¯</strong>ï¼ä½¿ç¨ <code>attention_torch_native.py</code>ï¼æäºçè§£ï¼</li>
</ul>
<h2 id="ææ¡£ç´¢å¼">ææ¡£ç´¢å¼</h2>
<p>æ¬ç®å½åå«é¡¹ç®åæ¨¡åçè¯¦ç»æµç¨å¾ææ¡£ï¼ä½¿ç¨ Mermaid è¯­æ³ç»å¶ã</p>
<h3 id="engine-æ¨¡åæµç¨å¾">Engine æ¨¡åæµç¨å¾</h3>
<table>
<thead>
<tr>
<th>ææ¡£</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/engine/sequence_flowchart.md" target="_blank" rel="noopener nofollow">docs/engine/sequence_flowchart.md</a></td>
<td>Sequence åºåç¶æç®¡çæµç¨</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/engine/block_manager_flowchart.md" target="_blank" rel="noopener nofollow">docs/engine/block_manager_flowchart.md</a></td>
<td>BlockManager KVç¼å­åç®¡çæµç¨</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/engine/scheduler_flowchart.md" target="_blank" rel="noopener nofollow">docs/engine/scheduler_flowchart.md</a></td>
<td>Scheduler è°åº¦å¨æµç¨</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/engine/model_runner_flowchart.md" target="_blank" rel="noopener nofollow">docs/engine/model_runner_flowchart.md</a></td>
<td>ModelRunner æ¨¡åè¿è¡å¨æµç¨</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/engine/llm_engine_flowchart.md" target="_blank" rel="noopener nofollow">docs/engine/llm_engine_flowchart.md</a></td>
<td>LLMEngine ä¸»å¼ææµç¨</td>
</tr>
</tbody>
</table>
<h3 id="layers-æ¨¡åæµç¨å¾">Layers æ¨¡åæµç¨å¾</h3>
<table>
<thead>
<tr>
<th>ææ¡£</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/linear_flowchart.md" target="_blank" rel="noopener nofollow">docs/layers/linear_flowchart.md</a></td>
<td>çº¿æ§å±ä¸å¼ éå¹¶è¡ç­ç¥</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/attention_torch_native_flowchart.md" target="_blank" rel="noopener nofollow">docs/layers/attention_torch_native_flowchart.md</a></td>
<td>PyTorchåçAttentionå®ç°</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/attention_flowchart.md" target="_blank" rel="noopener nofollow">docs/layers/attention_flowchart.md</a></td>
<td>NPUä¸ç¨Attentionå®ç°</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/attention_ori_flowchart.md" target="_blank" rel="noopener nofollow">docs/layers/attention_ori_flowchart.md</a></td>
<td>Flash Attentionä¼åå®ç°</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/sampler_flowchart.md" target="_blank" rel="noopener nofollow">docs/layers/sampler_flowchart.md</a></td>
<td>éæ ·å¨ï¼æ¸©åº¦éæ ·ï¼</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/rotary_embedding_flowchart.md" target="_blank" rel="noopener nofollow">docs/layers/rotary_embedding_flowchart.md</a></td>
<td>RoPEä½ç½®ç¼ç </td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/layernorm_flowchart.md" target="_blank" rel="noopener nofollow">docs/layers/layernorm_flowchart.md</a></td>
<td>RMSNormå½ä¸åå±</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/embed_head_flowchart.md" target="_blank" rel="noopener nofollow">docs/layers/embed_head_flowchart.md</a></td>
<td>è¯åµå¥ä¸LM Head</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/activation_flowchart.md" target="_blank" rel="noopener nofollow">docs/layers/activation_flowchart.md</a></td>
<td>SwiGLUæ¿æ´»å½æ°</td>
</tr>
</tbody>
</table>
<h3 id="models-æ¨¡åæµç¨å¾">Models æ¨¡åæµç¨å¾</h3>
<table>
<thead>
<tr>
<th>ææ¡£</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/models/llama_flowchart.md" target="_blank" rel="noopener nofollow">docs/models/llama_flowchart.md</a></td>
<td>Llamaæ¨¡åæ¶æ</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/models/qwen3_flowchart.md" target="_blank" rel="noopener nofollow">docs/models/qwen3_flowchart.md</a></td>
<td>Qwen3æ¨¡åæ¶æ</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/models/qwen3_vl_flowchart.md" target="_blank" rel="noopener nofollow">docs/models/qwen3_vl_flowchart.md</a></td>
<td>Qwen3-VLå¤æ¨¡ææ¨¡åæ¶æ</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/models/qwen3_moe_flowchart.md" target="_blank" rel="noopener nofollow">docs/models/qwen3_moe_flowchart.md</a></td>
<td>Qwen3-MoEç¨çä¸å®¶æ¨¡åæ¶æ</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/models/mini_cpm4_flowchart.md" target="_blank" rel="noopener nofollow">docs/models/mini_cpm4_flowchart.md</a></td>
<td>MiniCPM4æ¨¡åæ¶æ</td>
</tr>
<tr>
<td><a href="https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/models/models_map_flowchart.md" target="_blank" rel="noopener nofollow">docs/models/models_map_flowchart.md</a></td>
<td>æ¨¡åæ³¨åæ å°å³ç³»</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="benchæ°æ®">benchæ°æ®</h2>
<p>ä»ä¾åèï¼ç¡¬è½¯æ¡ä»¶ä¸åï¼è·åºçæ°æ®ä¹ä¼æå·®å¼</p>
<h4 id="ä¸åæ¨¡åå¯¹æ¯">ä¸åæ¨¡åå¯¹æ¯</h4>
<table>
<thead>
<tr>
<th>model</th>
<th>Output Tokens</th>
<th>Time (s)</th>
<th>Throughput (tokens/s)</th>
<th>TP</th>
</tr>
</thead>
<tbody>
<tr>
<td>Qwen3-0.6B</td>
<td>143,770</td>
<td>36.82</td>
<td>3904.20</td>
<td>1</td>
</tr>
<tr>
<td>Qwen2-0.5B</td>
<td>143,770</td>
<td>20.71</td>
<td>6940.84</td>
<td>1</td>
</tr>
<tr>
<td>Qwen2.5-0.5B-Instruct</td>
<td>143,770</td>
<td>19.82</td>
<td>7252.67</td>
<td>1</td>
</tr>
<tr>
<td>Llama-3.2-1B-Instruct</td>
<td>143,770</td>
<td>25.45</td>
<td>5648.50</td>
<td>1</td>
</tr>
<tr>
<td>Qwen3-32B</td>
<td>143,770</td>
<td>206.69</td>
<td>695.59</td>
<td>2</td>
</tr>
<tr>
<td>Qwen3-32B</td>
<td>143,770</td>
<td>119.86</td>
<td>1199.50</td>
<td>4</td>
</tr>
</tbody>
</table>
<h4 id="å¶ä»æ¡æ¶å¯¹æ¯2025-12-30">å¶ä»æ¡æ¶å¯¹æ¯(2025-12-30)</h4>
<p>vLLM Nano-vLLM æ°æ®æ¥æº <a href="https://github.com/GeeeekExplorer/nano-vllm" target="_blank" rel="noopener nofollow">https://github.com/GeeeekExplorer/nano-vllm</a></p>
<table>
<thead>
<tr>
<th>Inference Engine</th>
<th>Output Tokens</th>
<th>Time (s)</th>
<th>Throughput (tokens/s)</th>
</tr>
</thead>
<tbody>
<tr>
<td>vLLM</td>
<td>133,966</td>
<td>98.37</td>
<td>1361.84</td>
</tr>
<tr>
<td>Nano-vLLM</td>
<td>133,966</td>
<td>93.41</td>
<td>1434.13</td>
</tr>
<tr>
<td>Nano-vLLM-Ascend python torchåçå®ç°</td>
<td>4805</td>
<td>257.49</td>
<td>18.66</td>
</tr>
<tr>
<td>Nano-vLLM-Ascend èåç®å­+å¾ç¼è¯bs=256</td>
<td>133,966</td>
<td>33.88</td>
<td>3954.20</td>
</tr>
</tbody>
</table>
<h4 id="å¾æ¨¡å¼ä¸åbså¯¹æ¯2025-12-30">å¾æ¨¡å¼ä¸åbså¯¹æ¯(2025-12-30)</h4>
<table>
<thead>
<tr>
<th>Batch Size</th>
<th>Output Tokens</th>
<th>Time (s)</th>
<th>Throughput (tokens/s)</th>
</tr>
</thead>
<tbody>
<tr>
<td>bs=16</td>
<td>133,966</td>
<td>107.23</td>
<td>1249.37</td>
</tr>
<tr>
<td>bs=32</td>
<td>133,966</td>
<td>75.89</td>
<td>1765.35</td>
</tr>
<tr>
<td>bs=48</td>
<td>133,966</td>
<td>64.84</td>
<td>2066.22</td>
</tr>
<tr>
<td>bs=64</td>
<td>133,966</td>
<td>54.06</td>
<td>2478.31</td>
</tr>
<tr>
<td>bs=128</td>
<td>133,966</td>
<td>43.08</td>
<td>3109.56</td>
</tr>
<tr>
<td>bs=256</td>
<td>133,966</td>
<td>33.88</td>
<td>3954.20</td>
</tr>
</tbody>
</table>
<h4 id="åç®å­paddingånon-paddingå¯¹æ¯2025-12-30">åç®å­PaddingåNon-paddingå¯¹æ¯(2025-12-30)</h4>
<p>bs=256</p>
<table>
<thead>
<tr>
<th>Prepare Strategy</th>
<th>Output Tokens</th>
<th>Time (s)</th>
<th>Throughput (tokens/s)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Padding</td>
<td>133,966</td>
<td>158.46</td>
<td>845.41</td>
</tr>
<tr>
<td>Non-padding</td>
<td>133,966</td>
<td>152.14</td>
<td>880.55</td>
</tr>
</tbody>
</table>
<h2 id="ç¯å¢æ­å»ºåèvllm-ascend">ç¯å¢æ­å»ºï¼åèvllm-ascendï¼</h2>
<p><a href="https://docs.vllm.ai/projects/vllm-ascend-cn/zh-cn/latest/quick_start.html" target="_blank" rel="noopener nofollow">https://docs.vllm.ai/projects/vllm-ascend-cn/zh-cn/latest/quick_start.html</a></p>
<p>ubuntu</p>
<pre><code># Update DEVICE according to your device (/dev/davinci[0-7])
export DEVICE=/dev/davinci0
# Update the vllm-ascend image
# Atlas A2:
# export IMAGE=quay.io/ascend/vllm-ascend:v0.14.0rc1
# Atlas A3:
# export IMAGE=quay.io/ascend/vllm-ascend:v0.14.0rc1-a3
export IMAGE=quay.io/ascend/vllm-ascend:v0.14.0rc1
docker run --rm \
--name vllm-ascend \
--shm-size=1g \
--device $DEVICE \
--device /dev/davinci_manager \
--device /dev/devmm_svm \
--device /dev/hisi_hdc \
-v /usr/local/dcmi:/usr/local/dcmi \
-v /usr/local/bin/npu-smi:/usr/local/bin/npu-smi \
-v /usr/local/Ascend/driver/lib64/:/usr/local/Ascend/driver/lib64/ \
-v /usr/local/Ascend/driver/version.info:/usr/local/Ascend/driver/version.info \
-v /etc/ascend_install.info:/etc/ascend_install.info \
-v /root/.cache:/root/.cache \
-p 8000:8000 \
-it $IMAGE bash
# Install curl
apt-get update -y &amp;&amp; apt-get install -y curl
</code></pre>
<h2 id="å®è£ä¾èµ">å®è£ä¾èµ</h2>
<pre><code class="language-bash">pip install .
</code></pre>
<h2 id="æ¨¡åä¸è½½">æ¨¡åä¸è½½</h2>
<pre><code class="language-bash">huggingface-cli download --resume-download Qwen/Qwen3-0.6B \
  --local-dir ~/huggingface/Qwen3-0.6B/ \
  --local-dir-use-symlinks False
</code></pre>
<h2 id="å¿«éå¼å§">å¿«éå¼å§</h2>
<p>è¯·åè§ example.py äºè§£ç¨æ³ãè¯¥ API ä¸ vLLM çæ¥å£åºæ¬ä¸è´ï¼ä»å¨ LLM.generate æ¹æ³ä¸å­å¨ä¸äºç»å¾®å·®å¼ï¼</p>
<pre><code class="language-python">from nanovllm import LLM, SamplingParams
llm = LLM("/YOUR/MODEL/PATH", enforce_eager=True, tensor_parallel_size=1)
sampling_params = SamplingParams(temperature=0.6, max_tokens=256)
prompts = ["Hello, Nano-vLLM."]
outputs = llm.generate(prompts, sampling_params)
outputs[0]["text"]
</code></pre>
<h2 id="exampleè¿è¡ç»æ">exampleè¿è¡ç»æ</h2>
<p><img alt="result-image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2257481/202512/2257481-20251207210731923-1974827089.png" class="lazyload"></p>
<h2 id="benchç¯å¢">benchç¯å¢</h2>
<p>ä»ä¾åè<br>
ascend-dmi -c #æ¥ç</p>
<ul>
<li>ç¡¬ä»¶ç¯å¢âï¼
<ul>
<li>1.æ¾å¡:A3 910C</li>
<li>2.é©±å¨çæ¬:24.1.rc3.10</li>
<li>3.åºä»¶çæ¬:7.5.0.109.220</li>
</ul>
</li>
<li>âè½¯ä»¶ç¯å¢âï¼
<ul>
<li>1.CANNå 8.3.RC1</li>
<li>2.PTAçæ¬ï¼torch-npu 2.5.1.post2+gitd7a85f8ï¼torch 2.5.1</li>
</ul>
</li>
</ul>
<h2 id="benchmark">Benchmark</h2>
<p>See <code>bench.py</code> for benchmark.</p>
<p><strong>Test Configuration:</strong></p>
<ul>
<li>Model: Qwen3-0.6B</li>
<li>Total Requests: 256 sequences</li>
<li>Input Length: Randomly sampled between 100â1024 tokens</li>
<li>Output Length: Randomly sampled between 100â1024 tokens</li>
</ul>
<p><strong>Performance Results:</strong><br>
Nano-vLLM-Ascend å®å¨å¤ªæ¢äºåªè·äº10æ¡seq</p>
<table>
<thead>
<tr>
<th>Inference Engine</th>
<th>Output Tokens</th>
<th>Time (s)</th>
<th>Throughput (tokens/s)</th>
</tr>
</thead>
<tbody>
<tr>
<td>vLLM</td>
<td>133,966</td>
<td>98.37</td>
<td>1361.84</td>
</tr>
<tr>
<td>Nano-vLLM</td>
<td>133,966</td>
<td>93.41</td>
<td>1434.13</td>
</tr>
<tr>
<td>Nano-vLLM-Ascend</td>
<td>4805</td>
<td>257.49</td>
<td>18.66</td>
</tr>
</tbody>
</table>
<h2 id="qwen3-06b-layers">qwen3-0.6B layers</h2>
<pre><code class="language-angular2html">ModuleList(
  (0-27): 28 x Qwen3DecoderLayer(
    (self_attn): Qwen3Attention(
      (qkv_proj): QKVParallelLinear()
      (o_proj): RowParallelLinear()
      (rotary_emb): RotaryEmbedding()
      (attn): Attention()
      (q_norm): RMSNorm()
      (k_norm): RMSNorm()
    )
    (mlp): Qwen3MLP(
      (gate_up_proj): MergedColumnParallelLinear()
      (down_proj): RowParallelLinear()
      (act_fn): SiluAndMul()
    )
    (input_layernorm): RMSNorm()
    (post_attention_layernorm): RMSNorm()
  )
)

</code></pre>


</div>
<div id="MySignature" role="contentinfo">
    èå¤©åç½äºæ¯æ éã
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.03680555555555556" data-date-updated="2026-02-13 12:31">2026-02-13 11:38</span>&nbsp;
<a href="https://www.cnblogs.com/linzm14">linzm14</a>&nbsp;
éè¯»(<span id="post_view_count">58</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19611415);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19611415', targetLink: 'https://www.cnblogs.com/linzm14/p/19611415', title: 'Nano-vLLM-Ascend(æç»­æ´æ°ä¸­)' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>