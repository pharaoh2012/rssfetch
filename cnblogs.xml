<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-01-28T01:18:57.699Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ å©ç¨ Worker Threads ä¼å Vite æå»ºæ§è½çå®æ ]]></title>
    <link>https://www.cnblogs.com/newbe36524/p/19541521</link>
    <guid>d57622837b2aeeebead1cb030e6e6e11</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/newbe36524/p/19541521" title="åå¸äº 2026-01-28 09:05">
    <span role="heading" aria-level="2">å©ç¨ Worker Threads ä¼å Vite æå»ºæ§è½çå®æ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="120ç§å°45ç§å©ç¨-worker-threads-ä¼å-vite-æå»ºæ§è½çå®æ">120ç§å°45ç§ï¼å©ç¨ Worker Threads ä¼å Vite æå»ºæ§è½çå®æ</h1>
<blockquote>
<p>å¨å¤çå¤§ååç«¯é¡¹ç®æ¶ï¼çäº§ç¯å¢çä»£ç æå»ºå¾å¾è®©äººæç¼æ¬²ç©¿ãæ¬æåäº«å¦ä½éè¿ Node.js Worker Threads å° Vite æå»ºä¸­çä»£ç æ··æ·ç¯èèæ¶ä» 120 ç§éä½è³ 45 ç§ï¼å¹¶è¯¦ç»ä»ç» HagiCode é¡¹ç®ä¸­çå®æ½ç»èä¸è¸©åç»éªã</p>
</blockquote>

<h2 id="èæ¯">èæ¯</h2>
<p>å¨æä»¬çåç«¯å·¥ç¨åå®è·µä¸­ï¼éçé¡¹ç®è§æ¨¡çæ©å¤§ï¼æå»ºæçé®é¢éæ¸å¸æ¾ãç¹å«æ¯å¨çäº§ç¯å¢æå»ºæµç¨ä¸­ï¼ä¸ºäºä¿æ¤æºç é»è¾ï¼æä»¬éå¸¸ä¼å¼å¥ JavaScript æ··æ·å·¥å·ï¼å¦ <code>javascript-obfuscator</code>ï¼ãè¿ä¸æ­¥è½ç¶å¿è¦ï¼ä½è®¡ç®éå·¨å¤§ï¼æå¶æ¶è CPU èµæºã</p>
<p>å¨<strong>HagiCode</strong>é¡¹ç®çæ©æå¼åé¶æ®µï¼æä»¬éå°äºä¸ä¸ªéå¸¸æ£æçæ§è½ç¶é¢ï¼çäº§æå»ºæ¶é´éçä»£ç éçå¢å è¿éæ¶åã</p>
<p><strong>å·ä½çç¹å¦ä¸</strong>ï¼</p>
<ul>
<li>åçº¿ç¨ä¸²è¡æ§è¡æ··æ·ä»»å¡ï¼CPU åæ ¸è·æ»¡ï¼å¶ä»æ ¸å¿é²ç½®</li>
<li>æå»ºæ¶é´ä»æåç 30 ç§é£åè³ 110-120 ç§</li>
<li>æ¯æ¬¡ä¿®æ¹ä»£ç åçæå»ºéªè¯æµç¨æå¶æ¼«é¿ï¼ä¸¥éææ¢äºå¼åè¿­ä»£æç</li>
<li>CI/CD æµæ°´çº¿ä¸­ï¼æå»ºç¯èæä¸ºæèæ¶çé¨å</li>
</ul>
<p><strong>ä¸ºä»ä¹ HagiCode ä¼æè¿ä¸ªéæ±ï¼</strong><br>
HagiCode æ¯ä¸æ¬¾ AI é©±å¨çä»£ç æºè½å©æï¼å¶åç«¯æ¶æåå«å¤æçä¸å¡é»è¾å AI äº¤äºæ¨¡åãä¸ºäºç¡®ä¿æ ¸å¿ä»£ç çå®å¨æ§ï¼æä»¬å¨çäº§åå¸æ¶å¼ºå¶å¼å¯äºé«å¼ºåº¦æ··æ·ãé¢å¯¹é¿è¾¾ä¸¤åéçæå»ºç­å¾ï¼æä»¬å³å®å¯¹æå»ºç³»ç»è¿è¡ä¸æ¬¡æ·±åº¦çæ§è½ä¼åã</p>
<h2 id="å³äº-hagicode">å³äº HagiCode</h2>
<blockquote>
<p>æ¢ç¶æå°äºè¿ä¸ªé¡¹ç®ï¼ä¸å¦¨å¤ä»ç»ä¸¤å¥ã</p>
</blockquote>
<p>å¦æä½ å¨å¼åä¸­éå°è¿è¿äºç¦æ¼ï¼</p>
<ul>
<li>å¤é¡¹ç®ãå¤ææ¯æ ï¼æå»ºèæ¬ç»´æ¤ææ¬é«</li>
<li>CI/CD æµæ°´çº¿éç½®ç¹çï¼æ¯æ¬¡æ¹é½è¦æ¥ææ¡£</li>
<li>è·¨å¹³å°å¼å®¹æ§é®é¢å±åºä¸ç©·</li>
<li>æ³è®© AI å¸®å¿åä»£ç ï¼ä½ç°æå·¥å·ä¸å¤æºè½</li>
</ul>
<p>é£ä¹æä»¬æ­£å¨åç <strong>HagiCode</strong> å¯è½ä½ ä¼æå´è¶£ã</p>
<p><strong>HagiCode æ¯ä»ä¹ï¼</strong></p>
<ul>
<li>ä¸æ¬¾ AI é©±å¨çä»£ç æºè½å©æ</li>
<li>æ¯æå¤è¯­è¨ãè·¨å¹³å°çä»£ç çæä¸ä¼å</li>
<li>åç½®æ¸¸æåæºå¶ï¼è®©ç¼ç ä¸åæ¯ç¥</li>
</ul>
<p><strong>ä¸ºä»ä¹å¨è¿éæå®ï¼</strong><br>
æ¬æåäº«ç <strong>JavaScript å¹¶è¡æ··æ·æ¹æ¡</strong>ï¼æ­£æ¯æä»¬å¨å¼å HagiCode è¿ç¨ä¸­å®è·µæ»ç»åºæ¥çãå¦æä½ è§å¾è¿å¥å·¥ç¨åæ¹æ¡æä»·å¼ï¼è¯´ææä»¬çææ¯åå³è¿ä¸éââé£ä¹ HagiCode æ¬èº«ä¹å¼å¾å³æ³¨ä¸ä¸ã</p>
<p><strong>æ³äºè§£æ´å¤ï¼</strong></p>
<ul>
<li>GitHub: <a href="https://github.com/HagiCode-org/site" target="_blank" rel="noopener nofollow">github.com/HagiCode-org/site</a>ï¼æ± Starï¼</li>
<li>å®ç½: <a href="https://hagicode-org.github.io/site" target="_blank" rel="noopener nofollow">hagicode-org.github.io/site</a></li>
<li>è§é¢æ¼ç¤º: <a href="https://www.bilibili.com/video/BV1pirZBuEzq/" target="_blank" rel="noopener nofollow">www.bilibili.com/video/BV1pirZBuEzq/</a>ï¼30 åéå®ææ¼ç¤ºï¼</li>
<li>å®è£æå: <a href="https://hagicode-org.github.io/site/docs/installation/docker-compose" target="_blank" rel="noopener nofollow">hagicode-org.github.io/site/docs/installation/docker-compose</a></li>
<li>å¬æµå·²å¼å§ï¼ç°å¨å®è£å³å¯åä¸å¬æµ</li>
</ul>
<hr>
<h2 id="åæå¯»æ¾æ§è½ç¶é¢ççªç ´å£">åæï¼å¯»æ¾æ§è½ç¶é¢ççªç ´å£</h2>
<p>å¨çæè§£å³æ§è½é®é¢ä¹åï¼æä»¬éè¦åçæ¸æè·¯ï¼ç¡®å®æä¼çææ¯æ¹æ¡ã</p>
<h3 id="æ ¸å¿å³ç­ä¸ºä»ä¹éæ©-worker-threads">æ ¸å¿å³ç­ï¼ä¸ºä»ä¹éæ© Worker Threadsï¼</h3>
<p>Node.js ç¯å¢ä¸å®ç°å¹¶è¡è®¡ç®ä¸»è¦æä¸ç§æ¹æ¡ï¼</p>
<ol>
<li><strong>child_process</strong>ï¼åå»ºç¬ç«çå­è¿ç¨</li>
<li><strong>Web Workers</strong>ï¼ä¸»è¦ç¨äºæµè§å¨ç«¯</li>
<li><strong>worker_threads</strong>ï¼Node.js åçå¤çº¿ç¨æ¯æ</li>
</ol>
<p>ç»è¿å¯¹æ¯åæï¼HagiCode æç»éæ©äº <strong>Worker Threads</strong>ï¼åå å¦ä¸ï¼</p>
<ul>
<li><strong>é¶åºååå¼é</strong>ï¼Worker Threads ä½äºåä¸è¿ç¨ï¼å¯ä»¥éè¿ <code>SharedArrayBuffer</code> æè½¬ç§»æ§å¶æçæ¹å¼å±äº«åå­ï¼é¿åäºè¿ç¨é´éä¿¡çå¤§é¢åºååææ¬ã</li>
<li><strong>åçæ¯æ</strong>ï¼Node.js 12+ çæ¬åç½®æ¯æï¼æ éå¼å¥é¢å¤çéä¾èµã</li>
<li><strong>ä¸ä¸æç»ä¸</strong>ï¼è°è¯åæ¥å¿è®°å½æ¯å­è¿ç¨æ´æ¹ä¾¿ã</li>
</ul>
<h3 id="ä»»å¡ç²åº¦å¦ä½æåæ··æ·ä»»å¡">ä»»å¡ç²åº¦ï¼å¦ä½æåæ··æ·ä»»å¡ï¼</h3>
<p>æ··æ·ä¸ä¸ªå·¨å¤§ç JS Bundle æä»¶å¾é¾å¹¶è¡ï¼å ä¸ºä»£ç æä¾èµå³ç³»ï¼ï¼ä½ Vite çæå»ºäº§ç©æ¯ç±å¤ä¸ª <strong>Chunk</strong> ç»æçãè¿ç»äºæä»¬ä¸ä¸ªå¤©ç¶çå¹¶è¡è¾¹çï¼</p>
<ul>
<li><strong>ç¬ç«æ§</strong>ï¼Vite æååçä¸å Chunk ä¹é´ä¾èµå³ç³»å·²è§£è¦ï¼å¯ä»¥å®å¨å°å¹¶è¡å¤çã</li>
<li><strong>ç²åº¦éä¸­</strong>ï¼éå¸¸é¡¹ç®ä¼æ 10-30 ä¸ª Chunkï¼è¿ä¸ªæ°éçº§éå¸¸éåå¹¶è¡è°åº¦ã</li>
<li><strong>æäºéæ</strong>ï¼Vite æä»¶ç <code>generateBundle</code> é©å­åè®¸æä»¬å¨æä»¶çæåæ¦æªå¹¶å¤çè¿äº Chunkã</li>
</ul>
<h3 id="æ¶æè®¾è®¡">æ¶æè®¾è®¡</h3>
<p>æä»¬è®¾è®¡äºä¸ä¸ªåå«åä¸ªæ ¸å¿ç»ä»¶çå¹¶è¡å¤çç³»ç»ï¼</p>
<ol>
<li><strong>Task Splitter</strong>ï¼éå Vite ç bundle å¯¹è±¡ï¼è¿æ»¤ä¸éè¦æ··æ·çæä»¶ï¼å¦ vendorï¼ï¼çæä»»å¡éåã</li>
<li><strong>Worker Pool Manager</strong>ï¼ç®¡ç Worker ççå½å¨æï¼è´è´£ä»»å¡çååãåæ¶åéè¯¯éè¯ã</li>
<li><strong>Progress Reporter</strong>ï¼å®æ¶è¾åºæå»ºè¿åº¦ï¼æ¶é¤ç¨æ·çç­å¾ç¦èã</li>
<li><strong>ObfuscationWorker</strong>ï¼å®éæ§è¡æ··æ·é»è¾çå·¥ä½çº¿ç¨ã</li>
</ol>
<h2 id="è§£å³å®æç¼ç ä¸å®æ½">è§£å³ï¼å®æç¼ç ä¸å®æ½</h2>
<p>åºäºä¸è¿°åæï¼æä»¬å¼å§å¨æå®ç°è¿å¥å¹¶è¡æ··æ·ç³»ç»ã</p>
<h3 id="1-éç½®-vite-æä»¶">1. éç½® Vite æä»¶</h3>
<p>é¦åï¼æä»¬å¨ <code>vite.config.ts</code> ä¸­éæå¹¶è¡æ··æ·æä»¶ãéç½®éå¸¸ç´è§ï¼åªéæå® Worker æ°éåæ··æ·è§åã</p>
<pre><code class="language-typescript">import { defineConfig } from 'vite'
import { parallelJavascriptObfuscator } from './buildTools/plugin'

export default defineConfig(({ mode }) =&gt; {
  const isProduction = mode === 'production'
  
  return {
    build: {
      rollupOptions: {
        ...(isProduction
          ? {
              plugins: [
                parallelJavascriptObfuscator({
                  enabled: true,
                  // æ ¹æ® CPU æ ¸å¿æ°èªå¨è°æ´ï¼å»ºè®®çåºä¸ä¸ªæ ¸å¿ç»ä¸»çº¿ç¨
                  workerCount: 4, 
                  retryAttempts: 3,
                  fallbackToMainThread: true, // åºéæ¶èªå¨éçº§ä¸ºåçº¿ç¨
                  // è¿æ»¤æ vendor chunkï¼éå¸¸ä¸éè¦æ··æ·ç¬¬ä¸æ¹åº
                  isVendorChunk: (fileName: string) =&gt; fileName.includes('vendor-'),
                  obfuscationConfig: {
                    compact: true,
                    controlFlowFlattening: true,
                    deadCodeInjection: true,
                    disableConsoleOutput: true,
                    // ... æ´å¤æ··æ·éé¡¹
                  },
                }),
              ],
            }
          : {}),
      },
    },
  }
})
</code></pre>
<h3 id="2-å®ç°-worker-é»è¾">2. å®ç° Worker é»è¾</h3>
<p>Worker æ¯æ§è¡ä»»å¡çååãæä»¬éè¦å®ä¹å¥½è¾å¥åè¾åºçæ°æ®ç»æã</p>
<p><strong>æ³¨æ</strong>ï¼è¿éçä»£ç è½ç¶ç®åï¼ä½æå ä¸ªåç¹éè¦æ³¨æãæ¯å¦ <code>parentPort</code> çç©ºå¼æ£æ¥ï¼ä»¥åéè¯¯å¤çãå¨ HagiCode çå®è·µä¸­ï¼æä»¬åç°æäºç¹æ®ç ES6 è¯­æ³å¯è½ä¼å¯¼è´æ··æ·å¨å´©æºï¼æä»¥å ä¸äº <code>try-catch</code> ä¿æ¤ã</p>
<pre><code class="language-typescript">import { parentPort } from 'worker_threads'
import javascriptObfuscator from 'javascript-obfuscator'

export interface ObfuscationTask {
  chunkId: string
  code: string
  config: any
}

export interface ObfuscationResult {
  chunkId: string
  obfuscatedCode: string
  error?: string
}

// çå¬ä¸»çº¿ç¨åæ¥çä»»å¡
if (parentPort) {
  parentPort.on('message', async (task: ObfuscationTask) =&gt; {
    try {
      // æ§è¡æ··æ·
      const obfuscated = javascriptObfuscator.obfuscate(task.code, task.config)
      const result: ObfuscationResult = {
        chunkId: task.chunkId,
        obfuscatedCode: obfuscated.getObfuscatedCode(),
      }
      // å°ç»æååä¸»çº¿ç¨
      parentPort?.postMessage(result)
    } catch (error) {
      // å¤çå¼å¸¸ï¼ç¡®ä¿åä¸ª Worker å´©æºä¸ä¼é»å¡æ´ä¸ªæå»º
      const result: ObfuscationResult = {
        chunkId: task.chunkId,
        obfuscatedCode: '',
        error: error instanceof Error ? error.message : 'Unknown error',
      }
      parentPort?.postMessage(result)
    }
  })
}
</code></pre>
<h3 id="3-worker-æ± ç®¡çå¨">3. Worker æ± ç®¡çå¨</h3>
<p>è¿æ¯æ´ä¸ªæ¹æ¡çæ ¸å¿ãæä»¬éè¦ç»´æ¤ä¸ä¸ªåºå®å¤§å°ç Worker æ± ï¼éç¨ <strong>FIFOï¼åè¿ååºï¼</strong> ç­ç¥è°åº¦ä»»å¡ã</p>
<pre><code class="language-typescript">import { Worker } from 'worker_threads'
import os from 'os'

export class WorkerPool {
  private workers: Worker[] = []
  private taskQueue: Array&lt;{
    task: ObfuscationTask
    resolve: (result: ObfuscationResult) =&gt; void
    reject: (error: Error) =&gt; void
  }&gt; = []
  
  constructor(options: WorkerPoolOptions = {}) {
    // é»è®¤ä¸ºæ ¸å¿æ° - 1ï¼ç»ä¸»çº¿ç¨çä¸ç¹åæ¯çç©ºé´
    const workerCount = options.workerCount ?? Math.max(1, (os.cpus().length || 4) - 1)
    
    for (let i = 0; i &lt; workerCount; i++) {
      this.createWorker()
    }
  }

  private createWorker() {
    const worker = new Worker('./worker.ts')
    
    worker.on('message', (result) =&gt; {
      // ä»»å¡å®æåï¼ä»éåä¸­ååºä¸ä¸ä¸ªä»»å¡
      const nextTask = this.taskQueue.shift()
      if (nextTask) {
        this.dispatchTask(worker, nextTask)
      } else {
        // å¦ææ²¡æå¾å¤çä»»å¡ï¼æ è®° Worker ä¸ºç©ºé²
        this.activeWorkers.delete(worker)
      }
    })
    
    this.workers.push(worker)
  }

  // æäº¤ä»»å¡å°æ± ä¸­
  public runTask(task: ObfuscationTask): Promise&lt;ObfuscationResult&gt; {
    return new Promise((resolve, reject) =&gt; {
      const job = { task, resolve, reject }
      const idleWorker = this.workers.find(w =&gt; !this.activeWorkers.has(w))
      
      if (idleWorker) {
        this.dispatchTask(idleWorker, job)
      } else {
        this.taskQueue.push(job)
      }
    })
  }

  private dispatchTask(worker: Worker, job: any) {
    this.activeWorkers.set(worker, job.task)
    worker.postMessage(job.task)
  }
}
</code></pre>
<h3 id="4-è¿åº¦æ¥å">4. è¿åº¦æ¥å</h3>
<p>ç­å¾æ¯çè¦çï¼å°¤å¶æ¯ä¸ç¥éè¿è¦ç­å¤ä¹ãæä»¬å¢å äºä¸ä¸ªç®åçè¿åº¦æ¥åå¨ï¼å®æ¶åé¦å½åç¶æã</p>
<pre><code class="language-typescript">export class ProgressReporter {
  private completed = 0
  private readonly total: number
  private readonly startTime: number

  constructor(total: number) {
    this.total = total
    this.startTime = Date.now()
  }

  increment(): void {
    this.completed++
    this.report()
  }

  private report(): void {
    const now = Date.now()
    const elapsed = now - this.startTime
    const percentage = (this.completed / this.total) * 100
    
    // ç®åç ETA ä¼°ç®
    const avgTimePerChunk = elapsed / this.completed
    const remaining = (this.total - this.completed) * avgTimePerChunk

    console.log(
      `[Parallel Obfuscation] ${this.completed}/${this.total} chunks completed (${percentage.toFixed(1)}%) | ETA: ${(remaining / 1000).toFixed(1)}s`
    )
  }
}
</code></pre>
<h2 id="å®è·µææä¸è¸©å">å®è·µï¼ææä¸è¸©å</h2>
<p>é¨ç½²è¿å¥æ¹æ¡åï¼HagiCode é¡¹ç®çæå»ºæ§è½æäºç«ç«¿è§å½±çæåã</p>
<h3 id="æ§è½åºåæ°æ®">æ§è½åºåæ°æ®</h3>
<p>æä»¬å¨ä»¥ä¸ç¯å¢è¿è¡äºæµè¯ï¼</p>
<ul>
<li>CPUï¼Intel Core i7-12700K (12 cores / 20 threads)</li>
<li>RAMï¼32GB DDR4</li>
<li>Node.jsï¼v18.17.0</li>
<li>OSï¼Ubuntu 22.04</li>
</ul>
<p><strong>ç»æå¯¹æ¯</strong>ï¼</p>
<ul>
<li><strong>åçº¿ç¨ï¼ä¼ååï¼</strong>ï¼118 ç§</li>
<li><strong>4 Workers</strong>ï¼55 ç§ï¼æå <strong>53%</strong>ï¼</li>
<li><strong>8 Workers</strong>ï¼48 ç§ï¼æå <strong>60%</strong>ï¼</li>
<li><strong>12 Workers</strong>ï¼45 ç§ï¼æå <strong>62%</strong>ï¼</li>
</ul>
<p>å¯ä»¥çåºï¼æ¶çå¹¶ä¸æ¯çº¿æ§çãå½ Worker æ°éè¶è¿ 8 ä¸ªåï¼æåå¹åº¦åå°ãè¿ä¸»è¦åéäºä»»å¡åéçåååº¦ååå­å¸¦å®½ç¶é¢ã</p>
<h3 id="å¸¸è§é®é¢ä¸è§£å³æ¹æ¡">å¸¸è§é®é¢ä¸è§£å³æ¹æ¡</h3>
<p>å¨ HagiCode çå®éä½¿ç¨ä¸­ï¼æä»¬ä¹éå°äºä¸äºåï¼è¿éåäº«ç»å¤§å®¶ï¼</p>
<p><strong>Q1: æå»ºæ¶é´æ²¡æææ¾åå°ï¼åèåæ¢äºï¼</strong></p>
<ul>
<li><strong>åå </strong>ï¼Worker åå»ºæ¬èº«æå¼éï¼æè Worker æ°éè®¾ç½®è¿å¤å¯¼è´ä¸ä¸æåæ¢é¢ç¹ã</li>
<li><strong>è§£å³</strong>ï¼å»ºè®® Worker æ°éè®¾ç½®ä¸º <code>CPU æ ¸å¿æ° - 1</code>ãåæ¶æ£æ¥æ¯å¦æåä¸ª Chunk ç¹å«å¤§ï¼ä¾å¦ &gt; 5MBï¼ï¼è¿ç§"å·¨æ é¸"æä»¶ä¼æä¸ºç­æ¿ï¼å¯ä»¥èèä¼åä»£ç åå²ç­ç¥ã</li>
</ul>
<p><strong>Q2: å¶å°åºç° Worker å´©æºï¼æå»ºå¤±è´¥ï¼</strong></p>
<ul>
<li><strong>åå </strong>ï¼æäºç¹æ®çä»£ç è¯­æ³å¯è½å¯¼è´æ··æ·å¨åé¨æ¥éã</li>
<li><strong>è§£å³</strong>ï¼æä»¬å®ç°äº <strong>èªå¨éçº§æºå¶</strong>ãå½ Worker è¿ç»­å¤±è´¥æ¬¡æ°è¾¾å°éå¼æ¶ï¼æä»¶ä¼èªå¨åéå°åçº¿ç¨æ¨¡å¼ï¼ç¡®ä¿æå»ºä¸ä¸­æ­ãåæ¶è®°å½ä¸éè¯¯çæä»¶åï¼æ¹ä¾¿åç»­éå¯¹æ§ä¿®å¤ã</li>
</ul>
<p><strong>Q3: åå­å ç¨è¿é«ï¼OOMï¼ï¼</strong></p>
<ul>
<li><strong>åå </strong>ï¼æ¯ä¸ª Worker é½éè¦ç¬ç«åå­ç©ºé´æ¥å è½½æ··æ·å¨åè§£æ ASTã</li>
<li><strong>è§£å³</strong>ï¼
<ul>
<li>åå° Worker æ°éã</li>
<li>å¢å  Node.js çåå­éå¶ï¼<code>NODE_OPTIONS="--max-old-space-size=4096" npm run build</code>ã</li>
<li>ç¡®ä¿ä¸å¨ Worker åé¨ææä¸å¿è¦çå¤§å¯¹è±¡å¼ç¨ã</li>
</ul>
</li>
</ul>
<h2 id="æ»ç»">æ»ç»</h2>
<p>éè¿å¼å¥ Node.js Worker Threadsï¼æä»¬æåå° HagiCode é¡¹ç®ççäº§æå»ºæ¶é´ä» 120 ç§éä½å°äº 45 ç§å·¦å³ï¼æå¤§æåäºå¼åä½éªå CI/CD æçã</p>
<p>è¿å¥æ¹æ¡çæ ¸å¿å¨äºï¼</p>
<ol>
<li><strong>åçæåä»»å¡</strong>ï¼å©ç¨ Vite ç Chunk ä½ä¸ºå¹¶è¡ååã</li>
<li><strong>èµæºæ§å¶</strong>ï¼ä½¿ç¨ Worker æ± é¿åèµæºèå°½ã</li>
<li><strong>å®¹éè®¾è®¡</strong>ï¼èªå¨éçº§æºå¶ç¡®ä¿æå»ºç¨³å®æ§ã</li>
</ol>
<p>å¦æä½ ä¹å¨ä¸ºåç«¯æå»ºæçåæï¼æèä½ çé¡¹ç®ä¹å¨åéåº¦ä»£ç å¤çï¼ä¸å¦¨è¯è¯è¿å¥æ¹æ¡ãå½ç¶ï¼æ´æ¨èä½ ç´æ¥å³æ³¨æä»¬ç HagiCode é¡¹ç®ï¼è¿äºå·¥ç¨åçç»èé½å·²ç»éæå¨éé¢äºã</p>
<p>å¦ææ¬æå¯¹ä½ æå¸®å©ï¼æ¬¢è¿æ¥ GitHub ç»ä¸ª Starï¼æèåä¸å¬æµä½éªä¸ä¸ï½</p>
<h2 id="åèèµæ">åèèµæ</h2>
<ul>
<li>Node.js Worker Threads å®æ¹ææ¡£: <a href="https://nodejs.org/api/worker_threads.html" target="_blank" rel="noopener nofollow">nodejs.org/api/worker_threads.html</a></li>
<li>javascript-obfuscator ææ¡£: <a href="https://github.com/javascript-obfuscator/javascript-obfuscator" target="_blank" rel="noopener nofollow">github.com/javascript-obfuscator/javascript-obfuscator</a></li>
<li>Vite æä»¶å¼åæå: <a href="https://vitejs.dev/guide/api-plugin.html" target="_blank" rel="noopener nofollow">vitejs.dev/guide/api-plugin.html</a></li>
<li><strong>HagiCode GitHub</strong>: <a href="https://github.com/HagiCode-org/site" target="_blank" rel="noopener nofollow">github.com/HagiCode-org/site</a></li>
<li><strong>HagiCode å®ç½</strong>: <a href="https://hagicode-org.github.io/site" target="_blank" rel="noopener nofollow">hagicode-org.github.io/site</a></li>
<li><strong>å®è£æå</strong>: <a href="https://hagicode-org.github.io/site/docs/installation/docker-compose" target="_blank" rel="noopener nofollow">hagicode-org.github.io/site/docs/installation/docker-compose</a></li>
</ul>
<hr>
<p>æè°¢æ¨çéè¯»,å¦ææ¨è§å¾æ¬ææç¨,å¿«ç¹å»ä¸æ¹ç¹èµæé®ð,è®©æ´å¤çäººçå°æ¬æã</p>
<p>æ¬åå®¹éç¨äººå·¥æºè½è¾å©åä½,ç»æ¬äººå®¡æ ¸,ç¬¦åæ¬äººè§ç¹ä¸ç«åºã</p>
<ul>
<li><strong>æ¬æä½è:</strong> <a href="https://www.newbe.pro" target="_blank" rel="noopener nofollow">newbe36524</a></li>
<li><strong>æ¬æé¾æ¥:</strong> <a href="https://hagicode-org.github.io/site/blog/2026/01/27/optimizing-vite-build-with-worker-threads" target="_blank" rel="noopener nofollow">https://hagicode-org.github.io/site/blog/2026/01/27/optimizing-vite-build-with-worker-threads</a></li>
<li><strong>çæå£°æ:</strong> æ¬åå®¢æææç« é¤ç¹å«å£°æå¤,åéç¨ BY-NC-SA è®¸å¯åè®®ãè½¬è½½è¯·æ³¨æåºå¤!</li>
</ul>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-28 09:05">2026-01-28 09:05</span>&nbsp;
<a href="https://www.cnblogs.com/newbe36524">Newbe36524</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19541521);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19541521', targetLink: 'https://www.cnblogs.com/newbe36524/p/19541521', title: 'å©ç¨ Worker Threads ä¼å Vite æå»ºæ§è½çå®æ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ FastAPIå¼æ­¥å¤çº¿ç¨ï¼ä»è¸©åå°ç²¾éï¼è§£éé«æ§è½APIçæ­£ç¡®å§¿å¿ ]]></title>
    <link>https://www.cnblogs.com/ymtianyu/p/19541438</link>
    <guid>c5b1e7ac0ee18647f7967048069e73b7</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ymtianyu/p/19541438" title="åå¸äº 2026-01-28 08:39">
    <span role="heading" aria-level="2">FastAPIå¼æ­¥å¤çº¿ç¨ï¼ä»è¸©åå°ç²¾éï¼è§£éé«æ§è½APIçæ­£ç¡®å§¿å¿</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ¬ææ·±å¥æ¢è®¨äºFastAPIå¼æ­¥ï¼async/awaitï¼åå¤çº¿ç¨çæ­£ç¡®ä½¿ç¨åºæ¯ãéè¿åæASGIåçãåºåI/Oå¯éä¸CPUå¯éåä»»å¡ï¼æä¾äºå·ä½çä»£ç ç¤ºä¾åéç½®å»ºè®®ï¼å¹¶åä¸¾äºå¸¸è§çåç¹ï¼å¦é»å¡æä½ãè¿æ¥æ± éç½®ãGILéå¶ï¼ï¼å¸®å©å¼åèåååæ¥FastAPIçé«æ§è½æ½åï¼é¿åè¯¯ç¨å¯¼è´çæ§è½ä¸éã
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>ä½ ææ²¡æéå°è¿è¿ç§æåµï¼<strong style="color: rgba(186, 55, 42, 1)">ææç¨äºFastAPIçasyncï¼åæµæ¶æ§è½å´æ¯«æ æåï¼çè³æ´ç³äºï¼</strong> ð¯</p>
<p>å»å¹´æåäºä¸ä¸ªå®æ¶æ°æ®æ¨éçé¡¹ç®ï¼ä¸çº¿åä¿¡å¿æ»¡æ»¡ï¼ç»æç¬¬ä¸æ³¢æµéæ¶è¿æ¥ï¼æ¥å£ååºæ¶é´ç´æ¥ä»100msé£å°10s+ï¼çæ§æ¥è­¦ç­ä¿¡åé¤å¤å¤çé­ç®ä¸æ ·åä¸ªä¸åãææ¥ååç°ï¼ç½ªé­ç¥¸é¦æ­£æ¯æâæ³å½ç¶âå°ä¹±ç¨<span style="color: rgba(186, 55, 42, 1)"><code>async</code></span>ã</p>
<p>ä»å¤©ï¼æå°±ä»¥è¸©è¿åçèæåèº«ä»½ï¼è·ä½ å¥½å¥½èèFastAPIå¼æ­¥ï¼<span style="color: rgba(186, 55, 42, 1)"><code>async/await</code></span>ï¼åå¤çº¿ç¨é£ç¹äºãè¿ä¸æ¯æç§ä¹¦å¼çç½åï¼èæ¯å¯ä»¥ç´æ¥æä½ä¸çå®æç»éªã</p>
<div class="summary">
<h2>ð æ¬æè½å¸®ä½ è§£å³ä»ä¹ï¼</h2>
<p>1. ææFastAPIå¼æ­¥ï¼<span style="color: rgba(186, 55, 42, 1)"><code>async/await</code></span>ï¼å°åºå¨ä»ä¹åºæ¯ä¸è½çæ­£æåæ§è½ã</p>
<p>2. ææ¡å¨FastAPIä¸­æ­£ç¡®ä½¿ç¨å¤çº¿ç¨å¤çCPUå¯éåä»»å¡çæ¹æ³ã</p>
<p>3. é¿å¼å¸¸è§çåï¼æ¯å¦é»å¡æä½ãæ°æ®åºè¿æ¥æ± èå°½ãGILéå¶ï¼ã</p>
<p>4. è·å¾å¯ç´æ¥å¤ç¨çä»£ç çæ®µåéç½®å»ºè®®ã</p>
</div>
<h2>ð ä¸»è¦åå®¹èç»</h2>
<p>ä¸ãé®é¢ä¸èæ¯ï¼ä¸ºä»ä¹ä½ çasyncå¯è½âåçæâï¼</p>
<p>äºãæ ¸å¿åçï¼<span style="color: rgba(186, 55, 42, 1)"><code>ASGI</code></span>ã<span style="color: rgba(186, 55, 42, 1)"><code>async/await</code></span>ä¸å¤çº¿ç¨çå³ç³»</p>
<p>ä¸ãå®ææ¼ç¤ºï¼I/Oå¯éå vs CPUå¯éåä»»å¡çæ­£ç¡®å¤çå§¿å¿</p>
<p>åãæ³¨æäºé¡¹ä¸è¿é¶æèï¼é£äºå®¹æç¿»è½¦çç¹</p>
<h2>ä¸ãé®é¢ä¸èæ¯ï¼ä¸ºä»ä¹ä½ çasyncå¯è½âåçæâï¼</h2>
<p>å¾å¤äººä»¥ä¸ºï¼åªè¦ç»FastAPIçè·¯ç±å½æ°å ä¸<code class="inline-code">async def</code>ï¼å°±èªå¨è·å¾äºé«å¹¶åè½åãå¶å®ä¸ç¶ãFastAPIåºäºASGIï¼å¼æ­¥æå¡å¨ç½å³æ¥å£ï¼ï¼å®ç¡®å®åè®¸å¼æ­¥å¤çè¯·æ±ãä½<strong style="color: rgba(186, 55, 42, 1)">å¼æ­¥ä¸ç­äºå¤çº¿ç¨ï¼æ´ä¸ç­äºæ§è½æ éæåã</strong></p>
<p>å®çæ ¸å¿æ¯âéé»å¡âï¼å½ä¸ä¸ªè¯·æ±å¨ç­å¾I/Oï¼æ¯å¦æ¥æ°æ®åºãè°å¤é¨APIï¼æ¶ï¼äºä»¶å¾ªç¯ï¼Event Loopï¼ä¼å»å¤çå¶ä»è¯·æ±ï¼èä¸æ¯å¹²ç­çãè¿æå³çï¼å¦æä½ çasyncå½æ°éå¹²çæ¯<strong style="color: rgba(186, 55, 42, 1)">CPUå¯éå</strong>çæ´»å¿ï¼æ¯å¦å¤æçè®¡ç®ãå¾åå¤çï¼ï¼é£å®ä¾ç¶ä¼é»å¡æ´ä¸ªäºä»¶å¾ªç¯ï¼å¶ä»è¯·æ±ç§æ ·æéã</p>
<p>å®æ¹ææ¡£è½ç¶è¯´äºFastAPIæ¯æå¼æ­¥ï¼ä½æ²¡æç¡®åè¯ä½ ï¼<strong style="color: rgba(186, 55, 42, 1)">å¼æ­¥çä¼å¿ä»éäºI/Oå¯éååºæ¯ã</strong> è¿æ¯æç¨çéç½é¶ççº¿ä¸æéæ¢æ¥çæè®­ã</p>
<h2>äºãæ ¸å¿åçï¼ASGIãasync/awaitä¸å¤çº¿ç¨çå³ç³»</h2>
<p>å¥½ï¼å±ä»¬åæ¥çæ¸å ä¸ªå³é®æ¦å¿µï¼</p>
<p>ð¸ <strong>ASGIï¼Asynchronous Server Gateway Interfaceï¼</strong>ï¼è¿æ¯FastAPIçåºå±åè®®ãä½ å¯ä»¥æå®æ³è±¡æä¸ä¸ª<strong style="color: rgba(186, 55, 42, 1)">é«æçé¤åè°åº¦ç³»ç»</strong>ãæå¡åï¼äºä»¶å¾ªç¯ï¼è´è´£æ¥å¾é¡¾å®¢ï¼è¯·æ±ï¼ï¼å¦ææä½é¡¾å®¢ç¹èåéè¦ç­å¨æ¿åèï¼I/Oç­å¾ï¼ï¼æå¡åä¸ä¼å»ç­ï¼èæ¯åå»æ¥å¾å¶ä»é¡¾å®¢ãå¨æ¿åå¥½èä¼éç¥æå¡åï¼æå¡åååæ¥ä¸èãè¿æ ·ï¼ä¸ä¸ªæå¡åå°±è½åæ¶ç§é¡¾å¤æ¡å®¢äººã</p>
<p>ð¸ <strong>async/await</strong>ï¼è¿æ¯Pythonçè¯­æ³ç³ï¼ç¨æ¥å®ä¹åç¨ï¼Coroutineï¼ã<code class="inline-code">async def</code>å£°æä¸ä¸ªå½æ°æ¯âå¯æåçâï¼<code class="inline-code">await</code>è¡¨ç¤ºâå¨è¿éå¯ä»¥æåï¼å»å¹²å«çâã</p>
<p>ð¸ <strong>å¤çº¿ç¨/å¤è¿ç¨</strong>ï¼å½ä½ çä»»å¡ä¸»è¦æ¯<strong style="color: rgba(186, 55, 42, 1)">CPUå¯éå</strong>ï¼æ¯å¦å¤§éæ°å­¦è®¡ç®ï¼æ¶ï¼å¼æ­¥å¸®ä¸ä¸å¿ãè¿æ¶å°±éè¦è¯·åºå¤çº¿ç¨æå¤è¿ç¨ï¼æè®¡ç®ä»»å¡åæå°å¤ä¸ªCPUæ ¸å¿ä¸å»ãFastAPIæ¬èº«ä¸ç´æ¥ç®¡ççº¿ç¨ï¼ä½æä»¬å¯ä»¥å©ç¨Pythonç<code class="inline-code">concurrent.futures</code>æ<code class="inline-code">asyncio.to_thread</code>æ¥å®ç°ã</p>
<p>ç®åæ»ç»ï¼<strong style="color: rgba(186, 55, 42, 1)">I/Oå¯éåç¨asyncï¼CPUå¯éåç¨å¤çº¿ç¨/å¤è¿ç¨ï¼æ··ååä»»å¡ä¸¤èç»åã</strong></p>
<h2>ä¸ãå®ææ¼ç¤ºï¼I/Oå¯éå vs CPUå¯éåä»»å¡çæ­£ç¡®å¤çå§¿å¿</h2>
<p>æ¥ä¸æ¥éç¹æ¥äºï¼æä¹å¨ä»£ç éè½å®ï¼</p>
<h3>åºæ¯1ï¼çº¯I/Oå¯éåï¼æ¨èä½¿ç¨asyncï¼</h3>
<p>æ¯å¦è°ç¨å¤é¨APIãæ¥è¯¢æ°æ®åºãè¿æ¯asyncçä¸»åºã</p>
<div class="code-block">
<pre class="language-python highlighter-hljs"><code>import asyncio
from fastapi import FastAPI
import httpx  # å¼æ­¥HTTPå®¢æ·ç«¯

app = FastAPI()

@app.get("/fetch-data")
async def fetch_data():
    # æ¨¡æå¹¶åè°ç¨ä¸ä¸ªå¤é¨API
    async with httpx.AsyncClient() as client:
        tasks = [
            client.get("https://api.example.com/data1"),
            client.get("https://api.example.com/data2"),
            client.get("https://api.example.com/data3")
        ]
        responses = await asyncio.gather(*tasks)
    return {"results": [r.json() for r in responses]}</code></pre>
</div>
<p class="note">ð¡ è¿éåä¸å«ç¨åæ­¥ç<code class="inline-code">requests</code>åºï¼å¦åä¼é»å¡äºä»¶å¾ªç¯ãå¡å¿ä½¿ç¨<code class="inline-code">httpx</code>æ<code class="inline-code">aiohttp</code>è¿ç§å¼æ­¥å®¢æ·ç«¯ã</p>
<h3>åºæ¯2ï¼CPUå¯éåï¼å¿é¡»ç¨å¤çº¿ç¨/å¤è¿ç¨ï¼</h3>
<p>æ¯å¦å¾åå¤çãæ°æ®åæãè¿æ¶åå°±å¾è¯·åºçº¿ç¨æ± ã</p>
<div class="code-block">
<pre class="language-python highlighter-hljs"><code>from fastapi import FastAPI
from concurrent.futures import ThreadPoolExecutor
import time

app = FastAPI()
executor = ThreadPoolExecutor(max_workers=4)  # æ ¹æ®CPUæ ¸å¿æ°è°æ´

def cpu_intensive_task(n: int):
    """æ¨¡æCPUå¯éåä»»å¡ï¼æ¯å¦å¾åå¤ç"""
    time.sleep(n)  # è¿éç¨sleepæ¨¡æè®¡ç®èæ¶
    return f"Task {n} completed"

@app.get("/process-image")
async def process_image():
    # å°é»å¡å½æ°æäº¤å°çº¿ç¨æ± ï¼é¿åé»å¡äºä»¶å¾ªç¯
    future = executor.submit(cpu_intensive_task, 2)
    result = future.result()
    return {"result": result}</code></pre>
</div>
<p class="note">ð¨ è¿éæä¸ªåï¼çº¿ç¨æ± å¤§å°<code class="inline-code">max_workers</code>ä¸æ¯è¶å¤§è¶å¥½ãè®¾ç½®å¤ªå¤§åèä¼å¢å ä¸ä¸æåæ¢å¼éãä¸è¬å»ºè®®è®¾ç½®ä¸ºCPUæ ¸å¿æ°+1ã</p>
<h3>åºæ¯3ï¼æ··ååï¼async + å¤çº¿ç¨ï¼</h3>
<p>å®éé¡¹ç®ä¸­ï¼å¾å¤ä»»å¡æ¢æ¶åI/Oåæ¶åè®¡ç®ãè¿æ¶å¯ä»¥ç»åä¸¤èã</p>
<div class="code-block">
<pre class="language-python highlighter-hljs"><code>import asyncio
from fastapi import FastAPI
from concurrent.futures import ThreadPoolExecutor
import httpx

app = FastAPI()
executor = ThreadPoolExecutor(max_workers=4)

async def fetch_url(client: httpx.AsyncClient, url: str):
    """å¼æ­¥è·åæ°æ®"""
    response = await client.get(url)
    return response.json()

def heavy_computation(data: dict):
    """æ¨¡æCPUå¯éåè®¡ç®"""
    time.sleep(1)  # æ¨¡æè®¡ç®
    return {"processed": data}

@app.get("/complex-task")
async def complex_task():
    # æ­¥éª¤1ï¼å¹¶åI/Oï¼å¼æ­¥ï¼
    async with httpx.AsyncClient() as client:
        data = await fetch_url(client, "https://api.example.com/data")
    
    # æ­¥éª¤2ï¼CPUè®¡ç®ï¼æå°çº¿ç¨æ± ï¼
    loop = asyncio.get_event_loop()
    result = await loop.run_in_executor(executor, heavy_computation, data)
    
    return result</code></pre>
</div>
<p>å¦æä½ ç¨çæ¯Python 3.9+ï¼è¿å¯ä»¥ç¨<code class="inline-code">asyncio.to_thread</code>è®©ä»£ç æ´ç®æ´ã</p>
<h2>åãæ³¨æäºé¡¹ä¸è¿é¶æèï¼é£äºå®¹æç¿»è½¦çç¹</h2>
<p>åè¯´å ä¸ªå®¹æåºé®é¢çå°æ¹ï¼é½æ¯è¡æ³ªå²ï¼</p>
<p>ð¸ <strong>é»å¡æä½ç»å¯¹ä¸è½æ¾å¨asyncå½æ°é</strong>ï¼æ¯å¦<code class="inline-code">time.sleep()</code>ãåæ­¥çæ°æ®åºé©±å¨ï¼å¦<span style="color: rgba(186, 55, 42, 1)"><code>psycopg2</code></span>ï¼ãåæ­¥çæä»¶è¯»åç­ãè¦ç¨<code class="inline-code">await asyncio.sleep()</code>ãå¼æ­¥é©±å¨ï¼å¦<span style="color: rgba(186, 55, 42, 1)"><code>asyncpg</code></span>ï¼å<code class="inline-code">aiofiles</code>æ¿ä»£ã</p>
<p>ð¸ <strong>æ°æ®åºè¿æ¥æ± éç½®</strong>ï¼å¼æ­¥ç¯å¢ä¸ï¼æ°æ®åºè¿æ¥æ± çå¤§å°éè¦éæ°è¯ä¼°ãæéå°è¿å ä¸ºè¿æ¥æ± å¤ªå°ï¼é«å¹¶åä¸ææè¯·æ±é½å¨ç­è¿æ¥ï¼å¯¼è´æå¡éªå´©çæåµãå»ºè®®æ ¹æ®å®éååæµè¯è°æ´ã</p>
<p>ð¸ <strong>GILï¼å¨å±è§£éå¨éï¼éå¶</strong>ï¼PythonçGILä¼è®©å¤çº¿ç¨å¨çº¯CPUä»»å¡ä¸æçææãå¦æè®¡ç®æå¶å¯éï¼èèç¨<code class="inline-code">multiprocessing</code>å¯å¨å¤è¿ç¨ï¼ä½è¦æ³¨æè¿ç¨é´éä¿¡çææ¬ã</p>
<p>ð¸ <strong>Uvicornéç½®</strong>ï¼çäº§ç¯å¢è¿è¡FastAPIï¼éå¸¸ç¨Uvicornãå»ºè®®è®¾ç½®<code class="inline-code">--workers</code>ï¼è¿ç¨æ°ï¼ä¸ºCPUæ ¸å¿æ°ï¼<code class="inline-code">--loop uvloop</code>ï¼ä½¿ç¨æ´é«æçäºä»¶å¾ªç¯ï¼ãä¾å¦ï¼</p>
<div class="code-block">
<pre class="language-powershell highlighter-hljs"><code>uvicorn main:app --workers 4 --loop uvloop --host 0.0.0.0 --port 8000</code></pre>
</div>
<p>ð¸ <strong>çæ§ä¸æ¥å¿</strong>ï¼å¼æ­¥ç¯å¢ä¸ï¼éè¯¯æ å¯è½ä¸é£ä¹ç´è§ãä¸å®è¦æå¥½æ¥å¿ï¼å°¤å¶æ¯èæ¶æä½ãå¯ä»¥ç¨<code class="inline-code">asyncio.create_task</code>æ¶éå éè¯¯åè°ï¼é¿åä»»å¡éé»å¤±è´¥ã</p>
<div class="highlight">
<p><strong>æåå°å¦ä¸å¥ï¼</strong>ææ¯éåå¥½æ¯éå·¥å·ï¼ä¸æ¯è¶æ°è¶é·å°±å¥½ãFastAPIçå¼æ­¥ç¹æ§æ¯ä¸æå©å¨ï¼ä½ç¨å¯¹äºåºæ¯ææ¯å³é®ãI/Oå¯éåä»»å¡ï¼asyncè½è®©ä½ å¦èæ·»ç¿¼ï¼CPUå¯éåä»»å¡ï¼èèå®å®ç¨å¤çº¿ç¨/å¤è¿ç¨ãæ··åä»»å¡åè¦çµæ´»ç»åã</p>
</div>
<hr>
<p>å¥½äºï¼ä»å¤©å°±èå°è¿éãå¸æè¿ç¯âè¸©åæåâè½å¸®ä½ å°èµ°å¼¯è·¯ãå¦æä½ å¨å®æä¸­éå°å¶ä»è¯¡å¼é®é¢ï¼æ¬¢è¿çè¨äº¤æµãèè§ç©ï¼<strong style="color: rgba(186, 55, 42, 1)">ç¹èµãæ¶èãå³æ³¨</strong>ï¼ä¸æ¬¡éå°æ§è½é®é¢ï¼éæ¶åæ¥ç¿»è¿ç¯ï¼ä¿è¯ä¸è¿·è·¯ï¼</p>
<p>ââ ä½ çèæåï¼ä¸åç¨åºåª ð</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-28 08:40">2026-01-28 08:39</span>&nbsp;
<a href="https://www.cnblogs.com/ymtianyu">ä¸åç¨åºåªå</a>&nbsp;
éè¯»(<span id="post_view_count">36</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19541438);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19541438', targetLink: 'https://www.cnblogs.com/ymtianyu/p/19541438', title: 'FastAPIå¼æ­¥å¤çº¿ç¨ï¼ä»è¸©åå°ç²¾éï¼è§£éé«æ§è½APIçæ­£ç¡®å§¿å¿' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ãHelloGitHubãç¬¬ 118 æ ]]></title>
    <link>https://www.cnblogs.com/xueweihan/p/19535889</link>
    <guid>61bde735121de44624296267598167da</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xueweihan/p/19535889" title="åå¸äº 2026-01-28 08:15">
    <span role="heading" aria-level="2">ãHelloGitHubãç¬¬ 118 æ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>å´è¶£æ¯æå¥½çèå¸ï¼<strong>HelloGitHub</strong> è®©ä½ å¯¹å¼æºæå´è¶£ï¼</p>
</blockquote>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260126232206050-127676097.png" class="lazyload"></p>
<h2 id="ç®ä»">ç®ä»</h2>
<p><strong>HelloGitHub</strong> åäº« GitHub ä¸æè¶£ãå¥é¨çº§çå¼æºé¡¹ç®ã</p>
<blockquote>
<p><a href="https://github.com/521xueweihan/HelloGitHub" target="_blank" rel="noopener nofollow">github.com/521xueweihan/HelloGitHub</a></p>
</blockquote>
<p>è¿éæå®æé¡¹ç®ãå¥é¨æç¨ãé»ç§æãå¼æºä¹¦ç±ãå¤§åå¼æºé¡¹ç®ç­ï¼æ¶µçå¤ç§ç¼ç¨è¯­è¨ PythonãJavaãGoãC/C++ãSwift...è®©ä½ å¨ç­æ¶é´åæåå°å¼æºçé­åï¼ç±ä¸å¼æºï¼</p>
<hr>
<blockquote>
<p>ä»¥ä¸ä¸ºæ¬æåå®¹ï½æ¯æ <strong>28</strong> å·æ´æ°</p>
</blockquote>
<h3 id="c-é¡¹ç®">C é¡¹ç®</h3>
<p>1ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/leo-arch/clifm" target="_blank" rel="noopener nofollow">clifm</a>ï¼çº¯å½ä»¤è¡çæä»¶ç®¡çå¨ãè¿æ¯ä¸æ¬¾ C è¯­è¨åçå½ä»¤è¡æä»¶ç®¡çå·¥å·ï¼ä½¿ç¨èµ·æ¥æ¯ Shell æ´é«æãæ¯ TUI å·¥å·æ´è½»ä¾¿ãå®æ²¡æå¤æçèååå¾å½¢çé¢ï¼ç¨æ·åªéè¾å¥ç®åçå½ä»¤å³å¯å¿«éå®ææä»¶æä½ï¼æ¯ææ¡ç®æ°å­ç´¢å¼ãèªå¨è¡¥å¨ãè¯­æ³é«äº®åæä»¶é¢è§ç­åè½ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454728-1626534610.gif" class="lazyload"></p>
<h3 id="c-é¡¹ç®-1">C# é¡¹ç®</h3>
<p>2ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/umlx5h/LLPlayer" target="_blank" rel="noopener nofollow">LLPlayer</a>ï¼èªå¨çæåè¯­å­å¹çè§é¢æ­æ¾å¨ãè¿æ¯ä¸æ¬¾åºäº C# å¼åç Windows è§é¢æ­æ¾å¨ï¼å¯å®æ¶çæåè¯­å­å¹ãå®éè¿ Whisper è¯­é³è½¬æå­æ¨¡åï¼è½å¤ä¸ºæ å­å¹è§é¢å®æ¶çæå­å¹ï¼å¹¶ç»åä¸ä¸æéè¿å¤§è¯­è¨æ¨¡åæä¾æ´åç¡®çç¿»è¯ï¼æ¯ææ¥å¥ GoogleãDeepLãOpenAI åæ¬å° LLM æå¡ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454833-974952819.jpg" class="lazyload"></p>
<p>3ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/Archeb/opentrace" target="_blank" rel="noopener nofollow">opentrace</a>ï¼è·¨å¹³å°çå¯è§åè·¯ç±è¿½è¸ªå·¥å·ãè¿æ¯ä¸æ¬¾åºäº NextTrace å¼åçå¯è§åè·¯ç±è¿½è¸ªå·¥å·ï¼è½å¤ç´è§å±ç¤ºæ°æ®åä»æ¬å°å°ç®æ æå¡å¨çä¼ è¾è·¯å¾ï¼æ¾ç¤ºæ¯ä¸è·³ç IP å°åãå»¶è¿åå°çä½ç½®ä¿¡æ¯ï¼æ¯æ MTR å®æ¶è¯æ­ãèªå®ä¹ DNS è§£æç­åè½ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454734-381338640.jpg" class="lazyload"></p>
<p>4ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/tixl3d/tixl" target="_blank" rel="noopener nofollow">tixl</a>ï¼å¼æºçå®æ¶å¨æå¾å½¢åä½å·¥å·ãè¿æ¯ä¸æ¬¾åè´¹å¼æºçå®æ¶å¨æå¾å½¢åä½å·¥å·ï¼å¯ç¨äºå¶ä½éé³ä¹ååçè§è§èæ¯åç¹æãå®åç½®åºäºèç¹çç¨åºååå®¹çæï¼PCGï¼åç¼è¾å³é®å¸§å¨ç»ç­åè½ï¼æ¯æ MIDIãOSCãSpout ç­å¤æºè¾å¥ï¼éç¨äº VJ ç°åºè¡¨æ¼ãäº¤äºå¼èºæ¯åä½åå¨æå¾å½¢è®¾è®¡ç­åºæ¯ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003456371-689460079.png" class="lazyload"></p>
<h3 id="c-é¡¹ç®-2">C++ é¡¹ç®</h3>
<p>5ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/allenk/GeminiWatermarkTool" target="_blank" rel="noopener nofollow">GeminiWatermarkTool</a>ï¼Gemini çæå¾çæ°´å°æ¸é¤å·¥å·ãè¿æ¯ä¸æ¬¾ç¨äºç§»é¤ Gemini Nano Banana å Pro çæå¾çå³ä¸è§å¯è§æ°´å°çå·¥å·ï¼ä¸æ¯æéå½¢æ°´å°ï¼SynthIDï¼ãå®è·¨å¹³å°ãæ éèç½ãå¼ç®±å³ç¨ï¼æ¯æèªå¨è¯å«å¾çå°ºå¯¸åæ¹éå¤çç­åè½ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003455007-1727737040.png" class="lazyload"></p>
<p>6ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/dmcke5/Hapticpad" target="_blank" rel="noopener nofollow">Hapticpad</a>ï¼èªå¶å¸¦ååé¦æé®çå®é®çãè¿æ¯ä¸æ¬¾éå¤ååé¦æé®å OLED æ¾ç¤ºå±ç 6 é®å®é®çï¼æ¯æ 256 ä¸ªéç½®æä»¶åæ¢ãä¸ç§æé®æ¨¡å¼åèªå®ä¹ RGB ç¯ç¯ãå¯éè¿ä¿®æ¹ SD å¡ä¸ç XML æä»¶è¿è¡éç½®ï¼æ éå®è£ç¹æ®é©±å¨æå®¢æ·ç«¯å³æå³ç¨ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454892-411314490.png" class="lazyload"></p>
<p>7ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/shanselman/toasty" target="_blank" rel="noopener nofollow">toasty</a>ï¼è½»éçº§ Windows éç¥å½ä»¤è¡å·¥å·ãè¿æ¯ä¸æ¬¾é¶ä¾èµãè½»éçº§ç Windows å¹³å° Toast éç¥å½ä»¤è¡å·¥å·ï¼ä½ç§¯ä» 230KBãå®è½å¤èªå¨æ£æµå¹¶éæ Claude CodeãGemini CLI å GitHub Copilot ç­ä¸»æµ AI å½ä»¤è¡ç¼ç¨å©æï¼å¨ä»»å¡å®ææ¶åéå¸¦å¯¹åºå¾æ çæ¡é¢éç¥ï¼è®©ä½ æ éå®å¨ç»ç«¯åç­å¾ AI ç»æã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454657-2122900595.png" class="lazyload"></p>
<h3 id="go-é¡¹ç®">Go é¡¹ç®</h3>
<p>8ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/maxpert/marmot" target="_blank" rel="noopener nofollow">marmot</a>ï¼è®© SQLite ç§ååå¸å¼æ°æ®åºãè¿æ¯ä¸æ¬¾åºäº Go è¯­è¨å¼åçè½»éçº§åå¸å¼ SQLite ç³»ç»ï¼éè¿æ ä¸»æ¶æå° SQLite è½¬åä¸ºé«å¯ç¨çåå¸å¼æ°æ®åºãå®éç¨ Gossip åè®®è¿è¡éç¾¤ç®¡çåæ°æ®åæ­¥ï¼æ¯ææç»ä¸è´æ§åå¤ç¹åå¥ï¼å¹¶éè¿ CDC å®ç°è¡çº§å¤å¶ï¼å¼å®¹ MySQL åè®®ï¼ç°æç MySQL å®¢æ·ç«¯ååºç¨å¯æ ç¼è¿ç§»è³ SQLite éç¾¤ã</p>
<p>9ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/QuantumNous/new-api" target="_blank" rel="noopener nofollow">new-api</a>ï¼æ°ä¸ä»£ AI æ¨¡åèåç®¡çä¸ååç³»ç»ãè¯¥é¡¹ç®æ¯åºäº One API äºæ¬¡å¼åç AI æ¨¡åæ¥å£ç®¡çä¸ååå¹³å°ãå®å° OpenAlãClaudeãGeminiãDeepSeek ç­å¤ç§ä¸»æµå¤§æ¨¡åä¸ AI æå¡å°è£ä¸ºç»ä¸æ¥å£ï¼å¹¶å¼å®¹ OpenAIãClaudeãGemini ç­å¸¸è§æ¥å£æ ¼å¼ãåæ¶æä¾æ°æ®çæ¿ãæºè½è·¯ç±ååãä»¤çåç»ãæ¨¡åè®¿é®éå¶åå¨çº¿åå¼ç­åè½ï¼éåç¨äºä¼ä¸æä¸ªäººæ­å»º LLM ç»ä¸è°ç¨å¹³å°ãæ¥èª <a href="https://hellogithub.com/user/tbFPfKIDHpc4TzR" target="_blank" rel="noopener nofollow">@Calcium-Ion</a> çåäº«</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454817-155285102.png" class="lazyload"></p>
<p>10ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/likaia/nginxpulse" target="_blank" rel="noopener nofollow">nginxpulse</a>ï¼è½»éçº§ Nginx æ¥å¿å¯è§åå¹³å°ãè¯¥é¡¹ç®æ¯ç¨ GoãVue3 å PostgreSQL æå»ºçè½»éçº§ Nginx æ¥å¿åæåå¯è§åå¹³å°ï¼æ¯æ PV/UV ç»è®¡ãIP å½å±å°åæãå®¢æ·ç«¯è®¾å¤è§£æç­åè½ï¼éåä¸ªäººç«é¿åå°åå¢éä½¿ç¨ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003455028-565450136.png" class="lazyload"></p>
<p>11ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/karol-broda/snitch" target="_blank" rel="noopener nofollow">snitch</a>ï¼æ´åå¥½çç½ç»è¿æ¥æ¥çå¨ãè¯¥é¡¹ç®æ¯ç¨ Go è¯­è¨å¼åçç½ç»è¿æ¥çæ§å½ä»¤è¡å·¥å·ï¼å¯ä½ä¸º ss å netstat çæ¿ä»£åãå®å¼ç®±å³ç¨ãçé¢ç®æ´ç´è§ï¼æ¯æå®æ¶å·æ°ãè¿æ»¤ãæåºãå¯¼åºåæç´¢ TCP/UDP è¿æ¥ç­åè½ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003457811-1666418056.gif" class="lazyload"></p>
<p>12ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/tus/tusd" target="_blank" rel="noopener nofollow">tusd</a>ï¼å¤§æä»¶æ­ç¹ç»­ä¼ çæå¡ç«¯å®ç°ãè¯¥é¡¹ç®æ¯ tus åè®®ï¼åºäº HTTP çæä»¶æ­ç¹ç»­ä¼ åè®®ï¼å®æ¹å¼æºç Go è¯­è¨å®ç°ï¼ä¸ä¸ºè§£å³å¤§æä»¶ä¸ä¼ æä¸­æ­ãéä»å¤´éä¼ çé®é¢èè®¾è®¡ï¼æ¯ææ¬å°ç£çãAWS S3ãGoogle Cloud Storage ç­å¤ç§å­å¨ï¼å¯ä½ä¸ºç¬ç«æå¡æ Go åºä½¿ç¨ãæ¥èª <a href="https://hellogithub.com/user/TJ65FfbQU09PLHM" target="_blank" rel="noopener nofollow">@åç¿å</a> çåäº«</p>
<h3 id="java-é¡¹ç®">Java é¡¹ç®</h3>
<p>13ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/emichael/dslabs" target="_blank" rel="noopener nofollow">dslabs</a>ï¼åå¸å¼ç³»ç»è¯¾ç¨éå¥å®éªæ¡æ¶ãè¯¥é¡¹ç®æ¯åçé¡¿å¤§å­¦ä¸ä¸ºåå¸å¼ç³»ç»æå­¦åå­¦ä¹ èè®¾è®¡ç Java æ¡æ¶ï¼æä¾ç½ç»æ¨¡æãèªå¨åæµè¯åå¯è§åè°è¯ç­åè½ï¼å¸®å©åå­¦èä»é¶å®ç°ä¸ä¸ªå·å¤å®¹éãåçåäºå¡æ§ç KV å­å¨ç³»ç»ï¼å¨å®è·µä¸­ææ¡åå¸å¼åè®®çå®ç°åçã</p>
<p>14ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/tess1o/geopulse" target="_blank" rel="noopener nofollow">geopulse</a>ï¼èªæç®¡çä¸ªäººè¶³è¿¹åæå¹³å°ãè¿æ¯ä¸æ¬¾éç¨ Javaï¼Quarkusï¼å PostGIS æå»ºçä½ç½®è¿½è¸ªååæå¹³å°ï¼å¯ä½ä¸º Google Timeline çå¼æºæ¿ä»£åãå®è¿è¡æ¶å ç¨åå­ä½ï¼40-100MBï¼ï¼æä¾èªå¨è¡ç¨æ£æµãå®æ¶ä½ç½®åäº«ãå¤æºæ°æ®å¯¼å¥ãImmich éæå AI é®ç­å©æç­åè½ï¼æ¯æ Docker å K8s é¨ç½²ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454683-1584213246.png" class="lazyload"></p>
<h3 id="javascript-é¡¹ç®">JavaScript é¡¹ç®</h3>
<p>15ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/ChromeDevTools/chrome-devtools-mcp" target="_blank" rel="noopener nofollow">chrome-devtools-mcp</a>ï¼AI ä¸ Chrome æµè§å¨ä¹é´çæ¡¥æ¢ãè¯¥é¡¹ç®æ¯ Chrome DevTools å¢éå¼æºçå®æ¹ MCP æå¡å®ç°ï¼å° Chrome DevTools çè½åä»¥ MCP å·¥å·çå½¢å¼æä¾ç» AI ç¼ç¨å©æï¼æ¯æèªå¨åæä½ãè°è¯åæ§è½åæã</p>
<pre><code>{
  "mcpServers": {
    "chrome-devtools": {
      "command": "npx",
      "args": ["-y", "chrome-devtools-mcp@latest"]
    }
  }
}
</code></pre>
<p>16ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/MotiaDev/motia" target="_blank" rel="noopener nofollow">motia</a>ï¼ç»ç»åç«¯ç¢çåçæ¡æ¶ãè¿æ¯ä¸æ¬¾ä¸ç«å¼åç«¯æ¡æ¶ï¼éæäº APIãäºä»¶é©±å¨ãå®æ¶ä»»å¡ãå®æ¶æ°æ®æµå AI Agent ç­è½åï¼æ¯æ TypeScriptãPython ç­å¤è¯­è¨æ··åå¼åãå®åç½®ç¶æç®¡çãç»æåæ¥å¿ãç«¯å°ç«¯é¾è·¯è¿½è¸ªä¸å¯è§åè°è¯å¨ï¼æ¯ææµç¨å¾ãæ¥å¿æµåå®æ¶æµè¯ç­åè½ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003455039-1112519135.png" class="lazyload"></p>
<p>17ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/PDFCraftTool/pdfcraft" target="_blank" rel="noopener nofollow">pdfcraft</a>ï¼æ éä¸ä¼ æä»¶ç PDF å¨è½å·¥å·ç®±ãè¿æ¯ä¸æ¬¾åºäº Next.js å WebAssembly æå»ºçå¼æº PDF å·¥å·ç®±ï¼æææä»¶æä½åå¨æ¬å°æµè§å¨åå®æï¼æ éä¸ä¼ å°å¤é¨æå¡å¨ãå®æä¾èç¹å¼ç¼æ PDF æä»¶å¤çå·¥ä½æµï¼æ¯æåå¹¶ãæåãOCRãæ ¼å¼è½¬æ¢ç­ 90 å¤ç§åè½ãæ¥èª <a href="https://hellogithub.com/user/8yYRcxLuSdPJFDv" target="_blank" rel="noopener nofollow">@pccprint</a> çåäº«</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454722-239015095.png" class="lazyload"></p>
<p>18ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/puckeditor/puck" target="_blank" rel="noopener nofollow">puck</a>ï¼React å¯è§åç¼è¾å¨ç»ä»¶ãè¿æ¯ä¸æ¬¾åºäº TypeScript å React æå»ºçå¯è§åç¼è¾å¨ï¼å¯è½»æ¾å°ææ½å¼é¡µé¢æå»ºåè½éæå° Next.jsãRemix ç­ React åºç¨ä¸­ï¼å¹¶å¯ç´æ¥å¤ç¨ç°æ React ç»ä»¶ï¼å°å¶è½¬åä¸ºå¯ææ½çç¼è¾ååã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003455090-1975670394.gif" class="lazyload"></p>
<p>19ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/Rabithua/Rote" target="_blank" rel="noopener nofollow">Rote</a>ï¼çèµ·æ¥ä¸å¤ªä¸æ ·çç¢ç¢å¿µæ¬å­ãè¿æ¯ä¸æ¬¾è¿½æ±æç®åä¼éä½éªçä¸ªäººç¬è®°å¹³å°ï¼éç¨ React å Node.js æå»ºæ¯æ Docker ä¸é®é¨ç½²ï¼æä¾å¼æ¾ç API æ¥å£ï¼æ¹ä¾¿ç¨æ·éè¿å¤ç§æ¹å¼å½å¥æè·åæ°æ®ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454704-434192700.png" class="lazyload"></p>
<h3 id="kotlin-é¡¹ç®">Kotlin é¡¹ç®</h3>
<p>20ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/Turbo1123/roubao" target="_blank" rel="noopener nofollow">roubao</a>ï¼å¼æºç AI ææºèªå¨åå©æãè¿æ¯ä¸æ¬¾å¼æºç Android AI ææºèªå¨åå©æï¼æ éçµèå³å¯è®©ç¨æ·éè¿èªç¶è¯­è¨æä»¤ææ§ææºèªå¨å®æä»»å¡ãå®åºäºè§è§è¯­è¨æ¨¡åè¯å«å±å¹æªå¾ï¼ç»åå§ææ§è¡æ GUI èªå¨åï¼è½å¤å®æå¤æç App äº¤äºä»»å¡ãæ¥èª <a href="https://hellogithub.com/user/TXJgfoRNWa8vmF4" target="_blank" rel="noopener nofollow">@åªæ¯èå­å¤ªå¯å¯</a> çåäº«</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454929-1526892405.jpg" class="lazyload"></p>
<p>21ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/leekleak/traffic-light" target="_blank" rel="noopener nofollow">traffic-light</a>ï¼æç®ç Android æµéçæ§åºç¨ãè¿æ¯ä¸æ¬¾åè´¹å¼æºãä½ç§¯å°ä¸æ å¹¿åç Android ç½ç»æµéçæ§å·¥å·ï¼æ¯æç¶ææ æ¾ç¤ºå®æ¶ç½éãåå²æ°æ®ååºç¨çº§æµéç»è®¡ç­åè½ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454726-1078714301.jpg" class="lazyload"></p>
<h3 id="python-é¡¹ç®">Python é¡¹ç®</h3>
<p>22ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener nofollow">dirsearch</a>ï¼å½ä»¤è¡ Web è·¯å¾æ«æå·¥å·ãè¯¥é¡¹ç®æ¯ç¨ Python å¼åç Web è·¯å¾æ«æå·¥å·ï¼æ¯æå¤çº¿ç¨åå¼æ­¥æ¨¡å¼ï¼å¹¶æä¾å¤ç§æ¥åè¾åºæ ¼å¼ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454654-1640064169.png" class="lazyload"></p>
<p>23ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/keephq/keep" target="_blank" rel="noopener nofollow">keep</a>ï¼æ´æºè½çåè­¦ç®¡çå¹³å°ãè¿æ¯ä¸ä¸ªæºè½åè­¦ç®¡çå AIOps å¹³å°ï¼è¿ç¨ AI ææ¯å®ç°åè­¦å³èååæãå®æä¾äºç»ä¸çæä½çé¢ï¼ä¾¿äºéä¸­ç®¡çåç§åè­¦åäºä»¶ï¼æ¯æåè­¦å»éãè¿æ»¤ãç¸å³æ§åæåèªå¨åå¤çç­åè½ï¼å¯ä¸å¤ç§çæ§å·¥å·ãæ°æ®åºãéä¿¡å¹³å°åäºä»¶ç®¡çå·¥å·éæã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454677-1168137892.png" class="lazyload"></p>
<p>24ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/originalankur/maptoposter" target="_blank" rel="noopener nofollow">maptoposter</a>ï¼æç®çåå¸å°å¾æµ·æ¥çæå¨ãè¯¥é¡¹ç®æ¯ç¨ Python å¼åçåå¸å°å¾æµ·æ¥çæå¨ï¼å¯å°åå¸å°å¾æ°æ®è½¬åä¸ºç¾è§ãæç®é£æ ¼çèºæ¯æµ·æ¥ãå®å©ç¨ OpenStreetMap çæ°æ®ï¼èªå¨ç»å¶æå®åå¸çéè·¯ç½ç»ãæ°´ååå¬å­ï¼æä¾èµåæåãæ°´å¢¨é£æ ¼ç­ 17 ç§ä¸»é¢é£æ ¼å¯ä¾éæ©ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454906-786564804.jpg" class="lazyload"></p>
<p>25ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/elapouya/python-docx-template" target="_blank" rel="noopener nofollow">python-docx-template</a>ï¼Python ç»å Jinja2 çæ Word ææ¡£ãè¯¥é¡¹ç®æ¯ç»å python-docx å Jinja2 åºç Word ææ¡£æ¸²æåºãå®è½å¤å° .docx ææ¡£ä½ä¸ºæ¨¡æ¿ï¼å¨å¶ä¸­åµå¥ Jinja2 è¯­æ³æ ç­¾ï¼èªå¨çææ ¼å¼å¤æç Word ææ¡£ï¼æ¯æå¾çãå¯ææ¬ãé¡µçé¡µèåè¡¨æ ¼ç­ã</p>
<pre><code class="language-python">from docxtpl import DocxTemplate

doc = DocxTemplate("my_word_template.docx")
context = { 'name' : "HelloGitHub" }
doc.render(context)
doc.save("generated_doc.docx")
</code></pre>
<p>26ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/Maxteabag/sqlit" target="_blank" rel="noopener nofollow">sqlit</a>ï¼ç»ç«¯éç SQL æ°æ®åºç®¡çå·¥å·ãè¿æ¯ä¸æ¬¾ç¨ Python å¼åçç»ç«¯ TUI æ°æ®åºå®¢æ·ç«¯ï¼è´åäºæä¸ºæ°æ®åºé¢åç lazygitãå®å¼ç®±å³ç¨ãæä½ç®åï¼æ¯ææ¥è¯¢åå²ãèªå¨è¡¥å¨ãè¯­æ³é«äº®åå¤ç§ä¸»æµæ°æ®åºï¼éåå¼åèå¨æå¾å¯å¨ GUI å®¢æ·ç«¯æ¶å¿«éæ¥è¯¢æ°æ®åºã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454643-1349341335.gif" class="lazyload"></p>
<h3 id="rust-é¡¹ç®">Rust é¡¹ç®</h3>
<p>27ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/lusingander/serie" target="_blank" rel="noopener nofollow">serie</a>ï¼å¯è§åå±ç¤º Git æäº¤åå²çå·¥å·ãè¯¥é¡¹ç®è½å¤å° Git æäº¤åå²ä»¥å¯è§åå¾è¡¨æ¹å¼å±ç¤ºï¼å¯ä½ä¸º git log --graph å½ä»¤çæ¿ä»£åï¼æ¯æçµæ´»æåºãèªå®ä¹å¿«æ·é®åå¤é¨å½ä»¤æ©å±ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003457970-848851686.gif" class="lazyload"></p>
<p>28ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/zensical/zensical" target="_blank" rel="noopener nofollow">zensical</a>ï¼å¼ç®±å³ç¨çéæç½ç«çæå¨ãè¯¥é¡¹ç®æ¯ç± Material for MkDocs å¢éç¨ Rust å Pyhton éåçéæç½ç«çæå¨ï¼å¯åºäº Markdown æä»¶æå»ºåºç¾è§ãä¸ä¸ä¸å·å¤æç´¢åè½çéæææ¡£ç½ç«ãå®å¼ç®±å³ç¨ãå¯èªå®ä¹ï¼å¼å®¹ç°æ Material for MkDocs é¡¹ç®éç½®æ¹ä¾¿è¿ç§»ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454926-45072155.png" class="lazyload"></p>
<h3 id="swift-é¡¹ç®">Swift é¡¹ç®</h3>
<p>29ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/ronitsingh10/FineTune" target="_blank" rel="noopener nofollow">FineTune</a>ï¼è®© macOS æ¥æåºç¨çº§é³éæ§å¶ãè¿æ¯ä¸æ¬¾ Swift å¼åç macOS èåæ é³é¢æ§å¶å·¥å·ï¼æ¯æä¸ºæ¯ä¸ªåºç¨ç¬ç«è°èé³éãè®¾ç½®ä¸åè¾åºè®¾å¤ç­åè½ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003455593-33386008.png" class="lazyload"></p>
<p>30ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/debugtheworldbot/keyStats" target="_blank" rel="noopener nofollow">keyStats</a>ï¼å¼æºçé®é¼ ç»è®¡å·¥å·ãè¿æ¯ä¸æ¬¾è½»éçº§ç macOS/Windows åºç¨ï¼å¨ä¸è®°å½å·ä½è¾å¥åå®¹çåæä¸ï¼éåç¨æ·çè¾å¥è¡ä¸ºï¼æ¯æç»è®¡é®çæ²å»æ¬¡æ°ãé¼ æ ç¹å»æ¬¡æ°ãé¼ æ ç§»å¨åæ»å¨è·ç¦»ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003455032-1917931296.jpg" class="lazyload"></p>
<p>31ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/nguyenphutrong/quotio" target="_blank" rel="noopener nofollow">quotio</a>ï¼macOS åæ¢ AI è´¦å·çå·¥å·ãè¿æ¯ä¸æ¬¾ç¨ Swift å¼åç macOS èåæ å·¥å·ï¼æ¯æç»ä¸ç®¡ç ClaudeãGeminiãOpenAIãQwen ç­ AI æå¡çè´¦å·å API Keyï¼æä¾å®æ¶ Token æ¶èç»è®¡ãèªå¨æéè½¬ç§»å CLI ç¼ç¨å©æèªå¨åéç½®ç­åè½ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003455003-1366280161.png" class="lazyload"></p>
<h3 id="äººå·¥æºè½">äººå·¥æºè½</h3>
<p>32ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/AI-Cultivation/cultivation-world-simulator" target="_blank" rel="noopener nofollow">cultivation-world-simulator</a>ï¼AI é©±å¨çä¿®ä»ä¸çæ¨¡æå¨ãè¿æ¯ä¸æ¬¾åºäº LLM çä¿®ä»æ¨¡æå¨æ¸¸æï¼ä¸åäºä¼ ç» RPGï¼æ¸¸æåç NPC åæ¯ AI æºè½ä½ï¼æç¬ç«çæ§æ ¼ãè®°å¿åè¡ä¸ºé»è¾ï¼èç©å®¶å¨æ¸¸æä¸­æ®æ¼âå¤©éâï¼ä»¥ä¸å¸è§è§è§å¯å¹¶å¹²é¢ AI ä¿®ä»èåä»çè§åï¼è§è¯é¨æ´¾å´è¡°ä¸å¤©éªå´èµ·ãæ¥èª <a href="https://hellogithub.com/user/DogxfCROM1PBL89" target="_blank" rel="noopener nofollow">@4thfever</a> çåäº«</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003456958-1405983350.gif" class="lazyload"></p>
<p>33ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/slopus/happy" target="_blank" rel="noopener nofollow">happy</a>ï¼ç¨ææºææ§ Claude Code å Codexãè¿æ¯ä¸æ¬¾å¯ä»¥è¿ç¨æä½ Claude Code æ Codex çå·¥å·ï¼è®©ä½ éæ¶éå°éè¿ææºæ¥çåè¿ç¨æ§å¶ AI ç¼ç¨å©æï¼æä¾äº iOSãAndroid å Web å®¢æ·ç«¯ãæ¥èª <a href="https://hellogithub.com/user/pwgB6EFlZnvxGku" target="_blank" rel="noopener nofollow">@Jeff Xun</a> çåäº«</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454896-230173489.png" class="lazyload"></p>
<p>34ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/apple/ml-sharp" target="_blank" rel="noopener nofollow">ml-sharp</a>ï¼ä¸å°ä¸ç§çæ 3D åºæ¯ãè¯¥é¡¹ç®æ¯ Apple å¼æºçåç®è§è§åæææ¯çéå¥ä»£ç ï¼è½å¤å¨ç­æ¶é´åæ ¹æ®åå¼ å¾ççæé«è´¨éç 3D åºæ¯ãå®éè¿ç¥ç»ç½ç»ä»åå¼ ç§çä¸­åå½åº 3D é«æ¯åæ°ï¼è¾åºå¯ä¾ 3DGS æ¸²æå¨ä½¿ç¨ç ply æä»¶ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454782-356209845.jpg" class="lazyload"></p>
<p>35ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/inisis/OnnxSlim" target="_blank" rel="noopener nofollow">OnnxSlim</a>ï¼è½»éé«æç ONNX æ¨¡åä¼åå·¥å·ãè¿æ¯ä¸ä¸ªçº¯ Python å®ç°ç ONNX æ¨¡åç²¾ç®ä¸ç»æä¼åå·¥å·ï¼æ éé¢å¤çç¼è¯ä¾èµãå®éè¿åæä¸éåè®¡ç®å¾ï¼èªå¨ç§»é¤åä½èç¹ãæ æåæ¯åå¤ä½åæ°ï¼å¨ä¿è¯æ¨¡åç²¾åº¦ä¸åçåæä¸ï¼åå°æ¨¡åä½ç§¯å¹¶æåæ¨çéåº¦ï¼éç¨äºæ¨¡ååå¸ãæ¨çé¨ç½²åå·¥ç¨ååºæ¯ãæ¥èª <a href="https://hellogithub.com/user/DC9XV2w4dSHy6Qm" target="_blank" rel="noopener nofollow">@Desmond</a> çåäº«</p>
<pre><code class="language-python">import onnx
import onnxslim

model = onnx.load("model.onnx")
slimmed_model = onnxslim.slim(model)

if slimmed_model:
    onnx.save(slimmed_model, "slimmed_model.onnx")
</code></pre>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454729-1758522678.png" class="lazyload"></p>
<p>36ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/MaximeVandegar/Papers-in-100-Lines-of-Code" target="_blank" rel="noopener nofollow">Papers-in-100-Lines-of-Code</a>ï¼ç¾è¡ä»£ç å¤ç°ç»å¸æ·±åº¦å­¦ä¹ è®ºæãè¯¥é¡¹ç®éè¿çº¦ 100 è¡ Python ä»£ç å¤ç°äº 60+ ç¯æ·±åº¦å­¦ä¹ é¢åçç»å¸è®ºæï¼æä¾æç®ãå¯è¿è¡çä»£ç å®ç°ï¼å¸®å©ç ç©¶åãå­¦çåå¼åèå¿«éçè§£ç»å¸è®ºæçæ ¸å¿ææ³åå®ç°ç»èã</p>
<h3 id="å¶å®">å¶å®</h3>
<p>37ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/cavi-au/Consent-O-Matic" target="_blank" rel="noopener nofollow">Consent-O-Matic</a>ï¼åå«ç¦äººç Cookie ææå¼¹çªãè¿æ¯ä¸æ¬¾èªå¨è·³è¿ Cookie ææå¼¹çªçæµè§å¨æä»¶ï¼ç¨æ·åªéå¨æä»¶ä¸­è®¾ç½®ä¸æ¬¡éç§åå¥½ï¼å³å¯èªå¨è¯å«å¹¶è·³è¿åç§ç½ç«ç Cookie å¼¹æ¡ï¼åå»æå¨å¤ç Cookie ææçç¦æ¼ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454639-173168162.png" class="lazyload"></p>
<p>38ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/SteamDeckHomebrew/decky-loader" target="_blank" rel="noopener nofollow">decky-loader</a>ï¼è§£é Steam Deck æ½è½çæä»¶å è½½å¨ãè¯¥é¡¹ç®æ¯ä¸ä¸º Steam Deck è®¾å¤æé çæä»¶å è½½å·¥å·ï¼å¯å¨ SteamOS åççé¢ä¸­æ ç¼å è½½ç¬¬ä¸æ¹åè½æ¨¡åï¼æ¯æçé¢ç¾åãæ§è½ä¼ååå®ç¨å·¥å·ç­æä»¶ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454627-1529740636.png" class="lazyload"></p>
<p>39ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/simonoppowa/OpenNutriTracker" target="_blank" rel="noopener nofollow">OpenNutriTracker</a>ï¼åè´¹å¼æºçé¥®é£æ¥è®°åºç¨ãè¿æ¯ä¸æ¬¾åè´¹å¼æºçç§»å¨ç«¯è¥å»åç­éè¿½è¸ªåºç¨ï¼æ¯ææç§è®°å½æ¯æ¥é¥®é£ãæ«æé£åæ¡å½¢ç å¿«éå½å¥è¥å»ä¿¡æ¯å¹¶å¶å®é¥®é£è®¡åã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/759200/202601/759200-20260127003454906-900906523.png" class="lazyload"></p>
<p>40ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/obra/superpowers" target="_blank" rel="noopener nofollow">superpowers</a>ï¼è®© AI ç¼ç¨å·¥å·ææµç¨å·¥ä½ãè¯¥é¡¹ç®æ¯ä¸ä¸º AI ç¼ç¨æºè½ä½æé çå®æ´è½¯ä»¶å¼åå·¥ä½æµï¼éè¿ç»åæè½ï¼skillsï¼åæä»¤ï¼è®©æºè½ä½ä¸åªæ¯çæä»£ç ï¼èæ¯æç§æµç¨è¿è¡è®¾è®¡ãè§ååå®ç°ã</p>
<p>41ã<a href="https://hellogithub.com/periodical/statistics/click?target=https://github.com/xai-org/x-algorithm" target="_blank" rel="noopener nofollow">x-algorithm</a>ï¼X å¹³å°çä¿¡æ¯æµæ¨èç®æ³ãè¯¥é¡¹ç®æ¯ xAI å®æ¹å¼æºç X å¹³å°ä¿¡æ¯æµï¼For Youï¼æ ¸å¿æ¨èç³»ç»åå³é®ç»ä»¶çææ¯ç»èï¼å±ç¤ºäºå¦ä½æå»ºçäº§çº§ãåºäºå¤§è¯­è¨æ¨¡åæåºçæ¨èå¼æã</p>
<h2 id="æå">æå</h2>
<p>æè°¢åä¸åäº«å¼æºé¡¹ç®çå°ä¼ä¼´ä»¬ï¼æ¬¢è¿æ´å¤çå¼æºç±å¥½èæ¥ HelloGitHub èªè/æ¨èå¼æºé¡¹ç®ãå¦æä½ åç°äº GitHub ä¸æè¶£çé¡¹ç®ï¼å°±<a href="https://hellogithub.com/periodical" target="_blank" rel="noopener nofollow">ç¹å»è¿é</a>åäº«ç»å¤§å®¶ä¼å§ï¼</p>
<p>æ¬ææä½ æå´è¶£çå¼æºé¡¹ç®åï¼å¦ææçè¯å°±çè¨åè¯æå§ï½å¦æè¿æ²¡çè¿ç¾ï¼å¯ä»¥<a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA5MzYyNzQ0MQ==&amp;action=getalbum&amp;album_id=1331197538447310849&amp;scene=173&amp;from_msgid=2247511076&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" target="_blank" rel="noopener nofollow">ç¹å»éè¯»</a>å¾æåå®¹ã</p>
<p>æè°¢æ¨çéè¯»ï¼å¦æè§å¾æ¬æåå®¹è¿ä¸éçè¯ <strong>æ±èµãæ±åäº«</strong> â¤ï¸</p>

</div>
<div id="MySignature" role="contentinfo">
    <div>    
    <p style="border-top: #e0e0e0 1px dashed; border-right: #e0e0e0 1px dashed; border-bottom: #e0e0e0 1px dashed; border-left: #e0e0e0 1px dashed; padding-top: 5px; padding-right: 10px; padding-bottom: 10px; padding-left: 150px; background: url(https://images.cnblogs.com/cnblogs_com/xueweihan/859919/o_200924043112qrcode_for_gh_4fb030b35bb4_258.jpg) #e5f1f4 no-repeat 1% 50%; background-size:130px 130px;font-family: å¾®è½¯éé»; font-size: 13px" id="PSignature">
    <br>
    ä½èï¼<a href="https://github.com/521xueweihan" target="_blank">åå¾®å¯</a>

    <br>
    <strong>æ«æå·¦ä¾§çäºç»´ç å¯ä»¥èç³»å°æ</strong>
    <br>

    <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh"><img alt="ç¥è¯å±äº«è®¸å¯åè®®" style="border-width: 0" src="https://licensebuttons.net/l/by-nc-nd/4.0/88x31.png"></a><br>æ¬ä½åéç¨<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh">ç½²å-éåä¸æ§ä½¿ç¨-ç¦æ­¢æ¼ç» 4.0 å½é </a>è¿è¡è®¸å¯ã
    </p>
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-28 08:16">2026-01-28 08:15</span>&nbsp;
<a href="https://www.cnblogs.com/xueweihan">åå¾®å¯</a>&nbsp;
éè¯»(<span id="post_view_count">174</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19535889);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19535889', targetLink: 'https://www.cnblogs.com/xueweihan/p/19535889', title: 'ãHelloGitHubãç¬¬ 118 æ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬äºå¨ï¼è¯åµå¥ è¯¾åä¹ é¢ä¸ä»£ç å®è·µ ]]></title>
    <link>https://www.cnblogs.com/Goblinscholar/p/19540925</link>
    <guid>60af40c13b9526d7f4e11759f35983a0</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Goblinscholar/p/19540925" title="åå¸äº 2026-01-27 23:25">
    <span role="heading" aria-level="2">å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬äºå¨ï¼è¯åµå¥ è¯¾åä¹ é¢ä¸ä»£ç å®è·µ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æ­¤åç±»ç¨äºè®°å½å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨çå­¦ä¹ ç¬è®°ã<br>
è¯¾ç¨ç¸å³ä¿¡æ¯é¾æ¥å¦ä¸ï¼</p>
<ol>
<li>åè¯¾ç¨è§é¢é¾æ¥ï¼<a href="https://www.bilibili.com/video/BV1FT4y1E74V?buvid=XU762317353676D786954061C192FE625463B&amp;from_spmid=playlist.playlist-detail.0.0&amp;is_story_h5=false&amp;mid=zqernykrmpf7XfIorMR%2FnA%3D%3D&amp;plat_id=116&amp;share_from=ugc&amp;share_medium=android&amp;share_plat=android&amp;share_session_id=ce0bc526-db69-428a-962e-c65ed8c267bc&amp;share_source=COPY&amp;share_tag=s_i&amp;spmid=united.player-video-detail.0.0&amp;timestamp=1713085655&amp;unique_k=DfBgvFW&amp;up_id=8654113&amp;vd_source=e035e9878d32f414b4354b839a4c31a4" target="_blank" rel="noopener nofollow">[åè¯­å­å¹]å´æ©è¾¾æ·±åº¦å­¦ä¹ deeplearning.ai</a></li>
<li>githubè¯¾ç¨èµæï¼å«è¯¾ä»¶ä¸ç¬è®°:<a href="https://github.com/robbertliu/deeplearning.ai-andrewNG" target="_blank" rel="noopener nofollow">å´æ©è¾¾æ·±åº¦å­¦ä¹ æå­¦èµæ</a></li>
<li>è¯¾ç¨éå¥ç»ä¹ ï¼ä¸­è±ï¼ä¸ç­æ¡ï¼<a href="https://blog.csdn.net/u013733326/article/details/79827273" target="_blank" rel="noopener nofollow">å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾åä¹ é¢ä¸ç­æ¡</a></li>
</ol>
<p>æ¬ç¯ä¸ºç¬¬äºè¯¾ç¬¬äºå¨çè¯¾åä¹ é¢åä»£ç å®è·µé¨åã</p>
<hr>
<h1 id="1-çè®ºä¹ é¢">1. çè®ºä¹ é¢</h1>
<p><a href="https://blog.csdn.net/u013733326/article/details/83089164" target="_blank" rel="noopener nofollow">ãä¸­è±ããå´æ©è¾¾è¯¾åæµéªãCourse 5 -åºåæ¨¡å - ç¬¬äºå¨æµéª </a><br>
æ¬å¨ä¹ é¢åæ ·è¾ä¸ºç®åï¼å°±ä¸åå±å¼äºã</p>
<h1 id="2-ä»£ç å®è·µ">2. ä»£ç å®è·µ</h1>
<p><a href="https://blog.csdn.net/u013733326/article/details/83341643" target="_blank" rel="noopener nofollow">è¯åéä¸Emojiçæå¨-CSDNåå®¢</a><br>
å¨æ¬å¨çç¼ç¨ä½ä¸éï¼é¾æ¥éçåä¸»é¤äºç¼ç æ¼ç¤ºå³äºè¯åéçä¸äºåºæ¬åºç¨å¤ï¼ä¸»è¦æ¯å®ç°äºä¸ä¸ªè¡¨æçæå¨ã<br>
å¶åçæ¯éè¿ææ¬åç¸åºçè¡¨ææ ç­¾è¿è¡çç£å­¦ä¹ ï¼æå»ºåç±»æ¨¡åï¼å¨å®æè®­ç»åï¼éè¿å¯¹æ¨¡åè¾åºçä¸æ¸¸å å·¥ï¼å¯ä»¥å®ç°âè¾å¥ææ¬ï¼è¾åºéæè¡¨æçææ¬âçææãæå´è¶£å¯ä»¥è¿å¥äºè§£ã</p>
<p>åæ ·ï¼æä»¬è¿æ¯ä½¿ç¨æçæ¡æ¶æ¥æ¼ç¤ºæ¬å¨çåå®¹ï¼å¾çäº PyTorch å¯¹åºç¡æ¨¡åçå°è£éå¸¸å®åï¼æä»¬å¯ä»¥è¾ç®æ´å°å®ææ¬å¨åå®¹çæ¼ç¤ºï¼ä¸»è¦åå®¹åä¸¾å¦ä¸ï¼</p>
<ol>
<li><strong>å¦ä½å¨ä»£ç ä¸­ä½¿ç¨è¯åµå¥ï¼</strong></li>
<li><strong>ä½¿ç¨è¯åéåä»£ç¬ç­ç¼ç å¯¹å½åå®ä½è¯å«æ¨¡åæ§è½çå½±åã</strong></li>
<li><strong>ä½¿ç¨è¯åéè¿è¡æç»ªåç±»ã</strong></li>
</ol>
<h2 id="21-å¨pytorch-ä¸­ä½¿ç¨è¯åµå¥">2.1 å¨PyTorch ä¸­ä½¿ç¨è¯åµå¥</h2>
<p>å¨ PyTorch è°ç¨è¯åµå¥çæ¹æ³è¢«å°è£å¨æ¨¡åæ¨¡åä¸­ï¼å°±åæä»¬è°ç¨æ¹æ³åå»ºå¨è¿æ¥å±åå·ç§¯å±ä¸æ ·ï¼ç°å¨ï¼æä»¬è¦åçå°±æ¯<strong>åå»ºåµå¥å±</strong>ã</p>
<p>åæ¥åç¬ççåå»ºåµå¥å±çæ¹æ³æ¬èº«ï¼</p>
<pre><code class="language-python">self.embedding = nn.Embedding(  
    num_embeddings=vocab_size,  # è¯å¸å¤§å°
    embedding_dim=embed_dim,    # è¯åéç»´åº¦ï¼æ¢ä¸ä¸ªè¯ç¨å¤å°ç»´çåéè¡¨ç¤ºã
    # ä¸é¢è¿ä¸¤ä¸ªåæ°å°±åå®å¥½äºè¯åµå¥ç©éµçå¤§å°ã
    padding_idx=word_vocab["&lt;PAD&gt;"]  # è·åå¡«åç¬¦ç´¢å¼ï¼åºå®å¶åéä¸º 0 ï¼å¹¶å±è½æ¢¯åº¦è®¡ç®ã 
)
</code></pre>
<p>è¿éæä¸ç¹éè¦å¼ºè°ï¼å¦æä½ å¯¹æä»¬<a href="https://www.cnblogs.com/Goblinscholar/p/19484728" target="_blank">ä¸å¨çå®è·µåå®¹</a>è¿æå°è±¡ï¼ä¼åç°æä»¬å¶å®å·²ç»å¨åé¢çä»£ç äºæ¾å¼å®ä¹äº <code>&lt;PAD&gt;</code> çç´¢å¼ï¼</p>
<pre><code class="language-python">word_vocab["&lt;PAD&gt;"] = 0
</code></pre>
<p>ä¹å°±æ¯è¯´ï¼å¨æ¹æ³çåæ°éï¼æä»¬å¯ä»¥ç´æ¥åæï¼</p>
<pre><code class="language-python">padding_idx= 0
</code></pre>
<p><strong>ä½æ¯ï¼æä»¬åºæ¬ä¸ä¼è¿ä¹åã</strong><br>
è¿å¶å®æ¯ä»£ç è§èéä¸ä¸ªèçå¸¸è°çé®é¢ï¼<strong>é¿åç¡¬ç¼ç </strong>ã<br>
å¨è¿éï¼ä¸æ¦è¯è¡¨æå»ºç­ç¥åçè°æ´ï¼ä¾å¦äº¤æ¢ <code>&lt;PAD&gt;</code> ä¸ <code>&lt;UNK&gt;</code> çç´¢å¼ï¼ï¼åæ°å°±ä¼è¢«éè¯¯ä½¿ç¨ï¼<strong>å´ä¸ä¼è§¦åä»»ä½æ¥é</strong>ï¼æç»å¯¼è´æ¨¡åå¨è®­ç»è¿ç¨ä¸­å­¦å°éè¯¯çè¡¨ç¤ºã<br>
å æ­¤ï¼æä»¬å¨å®è·µä¸­æ´å¾åä½¿ç¨ç»ä¸çåéï¼æ¥æ¾å¼è¡¨è¾¾è¯­ä¹ä¾èµï¼é¿åå¨è°æ´æ¶å¼å¥éè½éè¯¯ã</p>
<p>åå°æ­£é¢ï¼äºè§£äºåµå¥å±æ¹æ³æ¬èº«åï¼ç°å¨å°±æ¥ççå¦ä½å°å¶åºç¨å¨æ¨¡åä¸­ï¼åççæä»¬<strong>ä¸å¨ä½¿ç¨ç¬ç­ç¼ç çæ¨¡åä»£ç ï¼</strong></p>
<pre><code class="language-python">class RNNTagger(nn.Module):  
    def __init__(self, vocab_size, hidden_dim, num_classes,  
                 rnn_type='RNN', bidirectional=False, num_layers=1):  
        super().__init__()  
        self.vocab_size = vocab_size  
        self.bidirectional = bidirectional  
        self.rnn_type = rnn_type.upper()  
  
        input_size = vocab_size  # ç¬ç­ç¼ç è¾å¥ç»´åº¦ = è¯è¡¨å¤§å°  
  
        if self.rnn_type == 'RNN':  
            self.rnn = nn.RNN(input_size, hidden_dim, batch_first=True,  
                              bidirectional=bidirectional, num_layers=num_layers)  
        ......å¶ä»æ¨¡åéæ©
        
        self.fc = nn.Linear(hidden_dim * (2 if bidirectional else 1), num_classes)  
  
    def forward(self, x):   
        x_onehot = torch.nn.functional.one_hot(x, num_classes=self.vocab_size).float() # ä¼ æ­ç¬¬ä¸æ­¥ï¼å°è¾å¥ä»ç´¢å¼è½¬æ¢ä¸ºç¬ç­ç¼ç ã
        out, _ = self.rnn(x_onehot)  
        out = self.fc(out)  
        return out
</code></pre>
<p>èæä½¿ç¨ç¬ç­ç¼ç æ¹ä¸ºä½¿ç¨è¯åéçå·¥ä½éä¹å¹¶ä¸å¤§ï¼æä»¬éè¦ï¼</p>
<ol>
<li><strong>æ°å¢åæ°å®ä¹è¯åéç»´åº¦ã</strong></li>
<li><strong>åå»ºåµå¥å±ã</strong></li>
<li><strong>å¨ä¼ æ­çç¬¬ä¸æ­¥å°ç´¢å¼ä»è½¬æ¢ä¸ºç¬ç­ç¼ç æ¹ä¸ºè¾å¥åµå¥å±æåè¯åéã</strong></li>
</ol>
<p>æ´æ¹å®çä»£ç å¦ä¸ï¼</p>
<pre><code class="language-python">class RNNTagger(nn.Module):  
    def __init__(self, vocab_size, hidden_dim, num_classes,  
                 rnn_type='RNN', bidirectional=False, num_layers=1,  
                 embed_dim=300):  # â æ°å¢ä¸ä¸ªåµå¥ç»´åº¦åæ°  
        super().__init__()  
        self.bidirectional = bidirectional  
        self.rnn_type = rnn_type.upper()  
  
        # æ°å¢ï¼è¯åµå¥å±  
        self.embedding = nn.Embedding(  
            num_embeddings=vocab_size,  
            embedding_dim=embed_dim,  
            padding_idx=word_vocab["&lt;PAD&gt;"]  
        )  
  
        input_size = embed_dim  # â RNN è¾å¥æ¹ä¸º embedding ç»´åº¦  
  
        if self.rnn_type == 'RNN':  
            self.rnn = nn.RNN(input_size, hidden_dim, batch_first=True,  
                              bidirectional=bidirectional, num_layers=num_layers)  
        elif self.rnn_type == 'LSTM':  
            self.rnn = nn.LSTM(input_size, hidden_dim, batch_first=True,  
                               bidirectional=bidirectional, num_layers=num_layers)  
        elif self.rnn_type == 'GRU':  
            self.rnn = nn.GRU(input_size, hidden_dim, batch_first=True,  
                              bidirectional=bidirectional, num_layers=num_layers)  
        else:  
            raise ValueError("rnn_type must be 'RNN','LSTM','GRU'")  
  
        self.fc = nn.Linear(hidden_dim * (2 if bidirectional else 1), num_classes)  
  
    def forward(self, x):  
        x_embed = self.embedding(x) #å¨ä¼ æ­ä¸­é¦åè¾å¥åµå¥å±æåè¯åéã
        out, _ = self.rnn(x_embed)  
        out = self.fc(out)  
        return out
</code></pre>
<p>è¿æ ·ï¼åªéè¦å¨æ¨¡åé¨åå®ææ¹å¨ï¼æä»¬ä¾¿å¯ä»¥ç´æ¥åºç¨ä¸å¨çä»£ç æ¡æ¶ç´æ¥è¿è¡è®­ç»ã<br>
ä¸é¢å°±æ¥ççææï¼</p>
<h2 id="22-ä½¿ç¨è¯åµå¥è¿è¡å½åå®ä½è¯å«">2.2 ä½¿ç¨è¯åµå¥è¿è¡å½åå®ä½è¯å«</h2>
<p>æä»¬åä½¿ç¨<strong>æ®éçåå RNN</strong> æ¥ççææï¼å¤æ¬¡å®éªé¨åç»æå¦ä¸ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260127231952652-728374191.png" alt="image.png" loading="lazy"><br>
å¯ä»¥çåºï¼ç¸æ¯ç¬ç­ç¼ç ï¼è½ç¶å¨ææ ä¸å¹¶æ²¡æææ¾çæåï¼ä½æ¯ä½¿ç¨ 300 ç»´çè¯åé<strong>å®æç¸åçè®­ç»ï¼åªéè¦ç¬ç­ç¼ç è®­ç»ç¨æ¶ççº¦ 65%</strong> ï¼è¿ç§ä¼å¿ä¼éçè¯è¡¨è§æ¨¡å¢å èæ´ææ¾ã<br>
æ¾ç¶ï¼è¯åéé¿åäºç¬ç­ç¼ç åéçæé«ç»´åº¦ä¸æå¶ç¨çç¼ºé·ï¼è¿æ¯å¨è®¡ç®æ§è½ä¸çæå¤§æåã<br>
ç®åæå°ä¸äºè®­ç»åçè¯åéå¦ä¸ï¼ï¼åªæªåäºå 20 ç»´ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260127231746057-63686229.png" alt="image.png" loading="lazy"><br>
ç¶åï¼æä»¬åè¯è¯ä¸å¨ç»¼åè¡¨ç°æå¥½ç GRU ï¼ç»æå¦ä¸ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260127232402014-1527482926.png" alt="image.png" loading="lazy"><br>
è®­ç»ç¨æ¶åæ ·å¾å°äºæå¤§æåï¼ä½æ¯ï¼å¥½ååºç°é®é¢äºï¼<br>
<strong>å¨ä½¿ç¨äºè¯åµå¥åï¼ææè¿å¢å äºè®­ç»è½®æ¬¡ï¼ä½ææ åèä¸å¦ä½¿ç¨ç¬ç­ç¼ç é«</strong>ï¼è¿æ¯ä¸ºä»ä¹ï¼</p>
<p>å®éä¸ï¼<strong>è¯åµå¥å¹¶ä¸å¤©ç¶éç¨äºææ NLP ä»»å¡</strong>ãå¯¹äºå®ä½å½åè¯å«è¿ç±»ä»¥<strong>è¯åæ ç­¾å¼ºå¯¹é½</strong>ä¸ºä¸»çä»»å¡ï¼one-hot è¡¨ç¤ºç±äºå¶<strong>å®å¨åºåè¯èº«ä»½çç¹æ§</strong>ï¼åèå¯è½åå¾æ´å¥½çææã<br>
è¯´ç®åäºï¼ç±äº<strong>å½åå®ä½è¯å«ä»»å¡æ´å³æ³¨âè¿ä¸ªè¯æ¯ä»ä¹âï¼èä¸æ¯âè¯ä¹é´çå³ç³»â</strong>ï¼ä½¿ç¨å®å¨æ­£äº¤çç¬ç­ç¼ç åèè®©çéæ´ææ¾ã<br>
æ¥ç®åçä¸ªä¾å­ï¼</p>
<p>åè®¾<strong>å¨è®­ç»è¯­æä¸­</strong>ï¼<code>Apple</code> å¤§éä»¥ <code>B-ORG</code>ï¼ç»ç»ï¼æ ç­¾åºç°ï¼è <code>Google</code>ã<code>Microsoft</code> ç­è¯å¨è¯åµå¥ç©ºé´ä¸­ä¸ <code>Apple</code> è·ç¦»å¾è¿ï¼è¿æ¯å ä¸ºå®ä»¬å±äº«äºâå¬å¸ââç§æââäº§åâç­ç¸ä¼¼ä¸ä¸æãä½å¨å·ä½å¥å­ä¸­ï¼</p>
<ul>
<li><code>Apple released a new product.</code> â <code>Apple</code> æ¯ <code>ORG</code>ï¼è¹æå¬å¸ï¼</li>
<li><code>I ate an apple after lunch.</code> â <code>apple</code> æ¯ <code>O</code>ï¼é£ç©è¹æï¼</li>
</ul>
<p>å¯¹äº NER æ¥è¯´ï¼å³é®ä¸æ¯âè¿ä¸ªè¯å¨è¯­ä¹ä¸åä»ä¹âï¼èæ¯<strong>å¨å½åä»»å¡æ æ³¨ä½ç³»ä¸ï¼å®å¨è¿ä¸ªä½ç½®å¯¹åºä»ä¹æ ç­¾</strong>ã<br>
èè¯åµå¥ä¼å¼å¥ä¸ç§å¼ºççå½çº³åç½®ï¼<strong>è¯­ä¹ç¸è¿çè¯ï¼å¶è¡¨ç¤ºä¹åºå½ç¸è¿</strong>ãå½æ¨¡åçä¸ä¸æå»ºæ¨¡è½åæéæ¶ï¼è¿ç§ç¸ä¼¼æ§ç»æå¯è½è¢«è¿åº¦å©ç¨ï¼ä½¿<strong>æ¨¡åå¾åäºæ ¹æ®è¯åéçé»è¿å³ç³»ååºå¤æ­ï¼èä¸æ¯ä¸¥æ ¼ä¾èµçç£ä¿¡å·æ¬èº«</strong>ï¼ä»èå¨æäºè¯­å¢ä¸äº§çéè¯¯çå®ä½ç±»åé¢æµã</p>
<p>æ¯å¦è¯åµå¥ä¼å¤©ç¶é¼å±æ¨¡å<strong>å° <code>Apple</code> ä¸å¶ä»ç§æå¬å¸è¯æè¿</strong>ï¼ä»èæ¾å¤§âå¬å¸è¯­ä¹âçå±æ§ï¼èå¦ææ¨¡åè®¾è®¡<strong>å¯¹å¤§å°åä¸ææ</strong>ï¼å¦å¤çé¨åè¯­æéåè®©<strong>æ°´æé´çè·ç¦»æ´è¿</strong>ï¼å°±å¯è½å¯¼è´ <strong>âé¦èå¬å¸âï¼âè èå¬å¸â</strong> ç­éè¯¯è¯å«ã<br>
èå¨ one-hot è¡¨ç¤ºä¸ï¼<code>Apple</code> çè¡¨ç¤ºä¸ä»»ä½å¶ä»è¯å®å¨ç¬ç«ï¼æ¨¡ååªè½ä¾èµçç£ä¿¡å·æ¬èº«å»å­¦ä¹ å®å¨ä¸åä¸ä¸æä¸­ä¸æ ç­¾ä¹é´çå¯¹åºå³ç³»ï¼<strong>åèé¿åäºè¿ç§è¯¯è§£</strong>ã</p>
<p>æ»ç»æ¥è¯´ï¼å¨ä¸è¿è¡è¿ä¸æ­¥ä¸ä¸æå»ºæ¨¡æç»æåçº¦æçæåµä¸ï¼è¯åµå¥ç±äºä¸º<strong>å¤ä¹è¯</strong>æä¾äºå±äº«çè¿ç»­è¡¨ç¤ºï¼å¯è½å¨æäºä»»å¡ä¸­å¼å¥è¯­ä¹æ··æ·ï¼ä»èå½±åæ¨¡åå¯¹å·ä½æ ç­¾çå¤å«ã<br>
è one-hot è¡¨ç¤ºéè¿å¶å®å¨æ­£äº¤çè®¾è®¡ï¼æ¾å¼åºåäºä¸åè¯é¡¹çèº«ä»½ï¼å¨è¯âæ ç­¾å¼ºå¯¹é½çä»»å¡ä¸­åèå¨ä¸å®ç¨åº¦ä¸ç¼è§£è¿ä¸é®é¢ã</p>
<p>ç°å¨ï¼æä»¬å¨è¯åµå¥çå¼ºé¡¹ï¼æç»ªåç±»ä¸åæ¥ççå¶ææï¼</p>
<h2 id="23-ä½¿ç¨è¯åéè¿è¡æç»ªåç±»">2.3 ä½¿ç¨è¯åéè¿è¡æç»ªåç±»</h2>
<p>è¦è¿è¡æ°çä»»å¡ï¼èªç¶é¦åè¦å¼å¥æ°çæ°æ®éï¼è¿éæä»¬ä½¿ç¨æç»ªåç±»ä¸­çç»å¸æ°æ®éï¼<strong>IMDb</strong><br>
IMDb æ°æ®éæ¯ä¸ä¸ªç»å¸ç<strong>äºåç±»</strong>æç»ªåæä»»å¡æ°æ®éï¼å®çè¾å¥æ¯çµå½±è¯è®ºææ¬ï¼è¾åºæ¯æç»ªæ ç­¾ï¼<code>0</code> è¡¨ç¤ºè´é¢ï¼negativeï¼ï¼<code>1</code> è¡¨ç¤ºæ­£é¢ï¼positiveï¼ã<br>
è®­ç»éåæµè¯éååå« 25,000 æ¡è¯è®ºï¼è¯è®ºé¿åº¦ä¸åºå®ï¼ä»å åè¯å°å ç¾è¯ä¸ç­ï¼ææ¬ä¸­åå«æ ç¹ãå¤§å°åãæ°å­ç­åç´ ãæ°æ®ç±»å«å¹³è¡¡ãæ¯è¾éåæä»¬çæ¼ç¤ºã<br>
åæ ·ï¼æä»¬ä½¿ç¨ä¹åä»ç»è¿ç HuggingFace Datasets æ¥ä¸è½½ï¼å®æ´ä»£ç éå¨æåï¼è¿éå±ç¤ºå æ¡æ ·æ¬æ°æ®ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260127231746713-502919155.png" alt="image.png" loading="lazy"><br>
ç°å¨ï¼åæ ·ä½¿ç¨ <strong>åå±åå GRU</strong> æ¥è¿è¡å®éªï¼è®¾ç½®<strong>è¯è¡¨å¤§å°ä¸º 20000ï¼æ¹æ¬¡å¤§å°ä¸º 32</strong>ï¼é¨åè®­ç»ç»æå¦ä¸ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260127231746505-1423343285.png" alt="image.png" loading="lazy"><br>
å¯ä»¥å¨è¾å°çè½®æ¬¡ä¸­ï¼å®ç°è¾å¥½çæåã<br>
èå¨åç­åæ°ä¸ä½¿ç¨ç¬ç­ç¼ç åä¼çåå­ï¼ä»¥æççµèéç½®éè¦å°è¯è¡¨ç¼©å°å° 5000 ä»¥ä¸ï¼å¹¶å°æ¹æ¬¡å¤§å°éè³ 6ï¼æåå¼ºå¯ä»¥è¿è¡ä¸åè½®æ¶é´è¾é¿ï¼è¿æ ·çéç½®å¹¶ä¸ééä¸è¬çä½¿ç¨åºæ¯ï¼å æ­¤å°±ä¸åå±ç¤ºç¬ç­ç¼ç çææäºã</p>
<p><strong>è¯åéå¨è®¡ç®æçä¸å¤§è¯è¡¨éåºæ§ä¸æ¥ææå¤§ä¼å¿</strong>ï¼å¯ä»¥å¨ä¿ææ¨¡åæ§è½çåæ¶ï¼å¤§å¹éä½æ¾å­æ¶èä¸è®­ç»æ¶é´ã<br>
å¦æä½ çèµæºè¶³å¤ï¼å¯ä»¥è¿è¡æ´å¤çå°è¯ççææã</p>
<h1 id="3-éå½">3. éå½</h1>
<h2 id="31-ä½¿ç¨è¯åµå¥è¿è¡æç»ªåç±»-pytorchç">3.1 ä½¿ç¨è¯åµå¥è¿è¡æç»ªåç±» PyTorchç</h2>
<pre><code class="language-python">import torch  
import torch.nn as nn  
from torch.utils.data import DataLoader  
from torch.nn.utils.rnn import pad_sequence  
from datasets import load_dataset  
from collections import Counter  
from sklearn.metrics import accuracy_score, f1_score  
import time  

device = torch.device("cuda" if torch.cuda.is_available() else "cpu")  
dataset = load_dataset("mteb/imdb")  
train_data = dataset['train']  
test_data  = dataset['test']  
   
def build_vocab(dataset, max_vocab_size=5000):  
    counter = Counter()  
    for item in dataset:  
        counter.update(item['text'].split())  
    most_common = counter.most_common(max_vocab_size)  
    word_vocab = {w:i+2 for i,(w,_) in enumerate(most_common)}  
    word_vocab["&lt;PAD&gt;"] = 0  
    word_vocab["&lt;UNK&gt;"] = 1  
    return word_vocab  
  
word_vocab = build_vocab(train_data)  
vocab_size = len(word_vocab)  
  
def encode(item):  
    x = torch.tensor([word_vocab.get(w,1) for w in item['text'].split()], dtype=torch.long)  
    y = torch.tensor(item['label'], dtype=torch.long)  
    return x, y  
  
train_dataset = [encode(item) for item in train_data]  
test_dataset  = [encode(item) for item in test_data]  
  
def collate_fn(batch):  
    xs, ys = zip(*batch)  
    xs_pad = pad_sequence(xs, batch_first=True, padding_value=word_vocab["&lt;PAD&gt;"])  
    ys = torch.tensor(ys, dtype=torch.long)  
    return xs_pad.to(device), ys.to(device)  
  
train_loader = DataLoader(train_dataset, batch_size=6, shuffle=True, collate_fn=collate_fn)  
test_loader  = DataLoader(test_dataset, batch_size=6, shuffle=False, collate_fn=collate_fn)  
  
class GRUSentiment(nn.Module):  
    def __init__(self, vocab_size, hidden_dim, num_classes,  
                 bidirectional=True, embed_dim=300):  
        super().__init__()  
        self.bidirectional = bidirectional  
        self.embedding = nn.Embedding(vocab_size, embed_dim, padding_idx=0)  
        self.rnn = nn.RNN(embed_dim, hidden_dim, batch_first=True,  
                          bidirectional=bidirectional, num_layers=1)  
        self.fc = nn.Linear(hidden_dim * (2 if bidirectional else 1), num_classes)  
  
    def forward(self, x):  
        x = self.embedding(x)           
        out, _ = self.rnn(x)            
        if self.bidirectional:  
            out = torch.cat([out[:, -1, :self.rnn.hidden_size],  
                             out[:, 0, self.rnn.hidden_size:]], dim=1)  
        else:  
            out = out[:, -1, :]  
        out = self.fc(out)  
        return out  

def train_validate(model, train_loader, test_loader, epochs=3, lr=0.001):  
    model.to(device)  
    criterion = nn.CrossEntropyLoss()  
    optimizer = torch.optim.Adam(model.parameters(), lr=lr)  
  
    for epoch in range(epochs):  
        model.train()  
        total_loss = 0  
        total_correct = 0  
        total_tokens = 0  
        start_time = time.time()  
  
        for x_batch, y_batch in train_loader:  
            optimizer.zero_grad()  
            outputs = model(x_batch)  
            loss = criterion(outputs, y_batch)  
            loss.backward()  
            optimizer.step()  
            total_loss += loss.item()  
  
            preds = outputs.argmax(dim=-1)  
            total_correct += (preds == y_batch).sum().item()  
            total_tokens += y_batch.numel()  
  
        train_acc = total_correct / total_tokens  
        avg_loss = total_loss / len(train_loader)  
  
        # éªè¯  
        model.eval()  
        all_preds, all_labels = [], []  
        val_total_correct = 0  
        val_total_tokens = 0  
  
        with torch.no_grad():  
            for x_batch, y_batch in test_loader:  
                outputs = model(x_batch)  
                preds = outputs.argmax(dim=-1)  
                all_preds.extend(preds.cpu().tolist())  
                all_labels.extend(y_batch.cpu().tolist())  
                val_total_correct += (preds == y_batch).sum().item()  
                val_total_tokens += y_batch.numel()  
  
        val_acc = val_total_correct / val_total_tokens  
        val_f1  = f1_score(all_labels, all_preds, average='macro')  
        epoch_time = time.time() - start_time  
  
        print(  
            f"è½®æ¬¡ {epoch+1} | "            f"è®­ç»æå¤±: {avg_loss:.4f} | "            f"è®­ç»åç¡®ç: {train_acc:.4f} | "            f"éªè¯åç¡®ç: {val_acc:.4f} | "            f"éªè¯F1: {val_f1:.4f} | "            f"æ¬è½®èæ¶: {epoch_time:.2f} ç§"  
        )  
  
    print("\nè®­ç»å®æï¼")  
    print(f"æç»éªè¯åç¡®ç: {val_acc:.4f}, F1-macro: {val_f1:.4f}")  
    return model  
  

if __name__ == "__main__":  
    model = GRUSentiment(  
        vocab_size=vocab_size,  
        hidden_dim=128,  
        num_classes=2,  
        bidirectional=True,  
        embed_dim=300  
    )  
    model = train_validate(model, train_loader, test_loader, epochs=10, lr=0.001)
</code></pre>
<h2 id="32-ä½¿ç¨è¯åµå¥è¿è¡æç»ªåç±»-tfç">3.2 ä½¿ç¨è¯åµå¥è¿è¡æç»ªåç±» TFç</h2>
<pre><code class="language-python">import tensorflow as tf  
from tensorflow.keras.preprocessing.sequence import pad_sequences  
from tensorflow.keras.utils import to_categorical  
from datasets import load_dataset  
from collections import Counter  
import numpy as np  
import time  
  
device = "GPU" if tf.config.list_physical_devices('GPU') else "CPU"  
  
  
dataset = load_dataset("mteb/imdb")  
train_data = dataset['train']  
test_data  = dataset['test']  
  
def build_vocab(dataset, max_vocab_size=5000):  
    counter = Counter()  
    for item in dataset:  
        counter.update(item['text'].split())  
    most_common = counter.most_common(max_vocab_size)  
    word_vocab = {w:i+2 for i,(w,_) in enumerate(most_common)}  
    word_vocab["&lt;PAD&gt;"] = 0  
    word_vocab["&lt;UNK&gt;"] = 1  
    return word_vocab  
  
word_vocab = build_vocab(train_data, max_vocab_size=20000)  
vocab_size = len(word_vocab)  
print("è¯è¡¨å¤§å°:", vocab_size)  
  
def encode(item):  
    x = [word_vocab.get(w, 1) for w in item['text'].split()]  
    y = item['label']  
    return x, y  
  
train_encoded = [encode(item) for item in train_data]  
test_encoded  = [encode(item) for item in test_data]  
  
max_len = 200  X_train = pad_sequences([x for x, _ in train_encoded], maxlen=max_len, padding='post', truncating='post')  
y_train = np.array([y for _, y in train_encoded])  
X_test  = pad_sequences([x for x, _ in test_encoded], maxlen=max_len, padding='post', truncating='post')  
y_test  = np.array([y for _, y in test_encoded])  
  
def build_model(vocab_size, embed_dim=300, hidden_dim=128, bidirectional=True, num_classes=2):  
    inputs = tf.keras.Input(shape=(max_len,), dtype=tf.int32)  
    x = tf.keras.layers.Embedding(input_dim=vocab_size, output_dim=embed_dim, mask_zero=True)(inputs)  
    if bidirectional:  
        x = tf.keras.layers.Bidirectional(tf.keras.layers.GRU(hidden_dim))(x)  
    else:  
        x = tf.keras.layers.GRU(hidden_dim)(x)  
    outputs = tf.keras.layers.Dense(num_classes, activation='softmax')(x)  
    model = tf.keras.Model(inputs, outputs)  
    return model  
  
model = build_model(vocab_size=vocab_size, embed_dim=300, hidden_dim=128, bidirectional=True, num_classes=2)  
model.compile(optimizer=tf.keras.optimizers.Adam(0.001),  
              loss='sparse_categorical_crossentropy',  
              metrics=['accuracy'])  
  
model.summary()  
  
start_time = time.time()  
history = model.fit(X_train, y_train, validation_data=(X_test, y_test),  
                    epochs=10, batch_size=32)  
total_time = time.time() - start_time  
print(f"è®­ç»å®æï¼ç¨æ¶ {total_time:.2f} ç§")  
  
y_pred = np.argmax(model.predict(X_test), axis=1)  
from sklearn.metrics import f1_score  
f1 = f1_score(y_test, y_pred, average='macro')  
acc = np.mean(y_pred == y_test)  
print(f"éªè¯åç¡®ç: {acc:.4f}, F1-macro: {f1:.4f}")
</code></pre>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-27 23:25">2026-01-27 23:25</span>&nbsp;
<a href="https://www.cnblogs.com/Goblinscholar">å¥å¸æå­¦è</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19540925);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19540925', targetLink: 'https://www.cnblogs.com/Goblinscholar/p/19540925', title: 'å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬äºå¨ï¼è¯åµå¥ è¯¾åä¹ é¢ä¸ä»£ç å®è·µ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ .NET èæåä½å­å¨åº (VMR)æ¶ææ¼è¿ãåæ­¥æºå¶ä¸ç»ä¸æå»ºç­ç¥ ]]></title>
    <link>https://www.cnblogs.com/shanyou/p/19540873</link>
    <guid>8328bc3cced80c55ebaeb728d5eb093b</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/shanyou/p/19540873" title="åå¸äº 2026-01-27 22:42">
    <span role="heading" aria-level="2">.NET èæåä½å­å¨åº (VMR)æ¶ææ¼è¿ãåæ­¥æºå¶ä¸ç»ä¸æå»ºç­ç¥</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        .NET èæåä½å­å¨åº (VMR) ä»£è¡¨äºå¤§åå¼æºè½¯ä»¶å·¥ç¨é¢åçä¸æ¬¡å¤§èå°è¯ä¸åæ°ãå®å¹¶æªç²ç®ç§æ¬ Google çé­æºåä½æ¨¡å¼ï¼ä¹æ²¡æåºå®ä¼ ç»çå¤ä»åºæ³¥æ½­ï¼èæ¯å¼åäºä¸æ¡âä¸­é´éè·¯â
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="æè¦"><strong>æè¦</strong></h2>
<p>æ¬æå¯¹.NET å¹³å°çæå»ºæ¶æè½¬åè¿è¡äºè¯¦å°½çåæï¼ç¹å«æ¯ä»åå¸å¼å¤å­å¨åºæ¨¡å¼å<strong>èæåä½å­å¨åº (Virtual Monolithic Repository, VMR)</strong> çæç¥è¿ç§»ãéç.NET ä» Windows ä¸ææ¡æ¶æ¼åä¸ºè·¨å¹³å°ãå¼æºçå¼åçæç³»ç»ï¼å¶åºå±çå·¥ç¨å¤ææ§åææ°çº§å¢é¿ãä¼ ç»çä¾èµå¾æå»ºæ¨¡åå¯¼è´äºä¸¥éçâä¸è´æ§å»¶è¿âåç»´æ¤ç¢çåé®é¢ãVMR ä½ä¸ºä¸ç§åæ°çæ··åæ¶ææ¨¡å¼ï¼æ¨å¨éè¿âèæåâææ®µï¼å¨ä¿çåæåäº§åå­å¨åºï¼Product Repositoriesï¼ç¬ç«å¼åçµæ´»æ§çåæ¶ï¼å®ç°åä½å­å¨åºï¼Monorepoï¼æå·å¤çç»ä¸æå»ºãåå­çº§çæ¬æ§å¶åä¾åºé¾å®å¨ä¼å¿ã</p>
<h2 id="1-æ¶æèæ¯ä¸æ¼è¿å¨å"><strong>1. æ¶æèæ¯ä¸æ¼è¿å¨å</strong></h2>
<h3 id="11-ä»åä½å°ç¢çånet-çå¼æºå¾ç¨"><strong>1.1 ä»åä½å°ç¢çåï¼.NET çå¼æºå¾ç¨</strong></h3>
<p>å¨.NET Framework æ¶ä»£ï¼æå»ºç³»ç»ä¸»è¦å´ç» Windows æä½ç³»ç»ç´§å¯éæï¼éç¨ä¼ ç»çå°é­å¼å¼åæ¨¡å¼ãç¶èï¼éç.NET Core çæ¨åºï¼å¾®è½¯å¼å¯äºå½»åºçå¼æºä¸è·¨å¹³å°è½¬åãä¸ºäºéåºå¼æºç¤¾åºçåä½ä¹ æ¯ï¼å¹¶å®ç°ä¸åç»ä»¶ï¼å¦ Runtime, SDK, ASP.NET Core, Roslyn ç¼è¯å¨ç­ï¼çç¬ç«è¿­ä»£ï¼.NET å¢éæåéç¨äºæä¸ºåæ£çå¤å­å¨åºï¼Multi-Repoï¼ç­ç¥1ã</p>
<p>å¨è¿ç§æ¨¡å¼ä¸ï¼.NET å¹³å°è¢«æè§£ä¸ºæ°åçè³ä¸ç¾ä¸ªç¬ç«ç Git å­å¨åºãæ¯ä¸ªå­å¨åºæ¥æç¬ç«çæå»ºç®¡éãçæ¬æ§å¶åå²ååå¸å¨æãè¿ç§æ¶æå¨åææå¤§å°ä¿è¿äºåä¸ªç»ä»¶å¢éçææ·æ§ï¼ä½¿å¾è´è´£ JIT ç¼è¯å¨çå¢éä¸è´è´£ ASP.NET è·¯ç±çå¢éè½å¤äºä¸å¹²æ°å°å¹¶è¡å¼å ã</p>
<h3 id="12-åå¸å¼ä¾èµå¾çç³»ç»æ§å´©æº"><strong>1.2 åå¸å¼ä¾èµå¾çç³»ç»æ§å´©æº</strong></h3>
<p>éç.NET çæç³»ç»çå£®å¤§ï¼è¿ç§å®å¨è§£è¦çæ¶æéæ¸æ´é²åºä¸¥éçç³»ç»æ§ç¼ºé·ï¼ç¹å«æ¯å¨æå»ºæ´ä¸ª.NET SDK äº§åæ¶ãè¿äºå­å¨åºå¹¶éçæ­£ç¬ç«ï¼èæ¯éè¿å¤æçä¾èµå³ç³»ç¸äºè¿æ¥ï¼å½¢æäºä¸ä¸ªåºå¤§ç<strong>æåæ ç¯å¾ (DAG)</strong> 3ã</p>
<h4 id="121-ä¸è´æ§å»¶è¿-coherency-latency"><strong>1.2.1 ä¸è´æ§å»¶è¿ (Coherency Latency)</strong></h4>
<p>å¨åå¸å¼å¾ä¸­ï¼åæ´çä¼ æ­æ¯çº¿æ§çä¸æå¶ç¼æ¢ãä¾å¦ï¼å½ Roslyn ç¼è¯å¨å¢éä¿®å¤äºä¸ä¸ªåºå± Bug å¹¶åå¸æ°çæ¬åï¼è¯¥åæ´å¿é¡»æ²¿çä¾èµé¾éçº§åä¸ä¼ æ­ï¼é¦åæ´æ° Runtimeï¼Runtime æå»ºåå¸åæ´æ° ASP.NET Coreï¼æåæè½å°è¾¾ SDK å Installerãè¿ä¸ªè¿ç¨å¯è½é¿è¾¾æ°å¤©çè³æ°å¨ãå¨æ­¤æé´ï¼å¤äºä¾èµæ ä¸åå±çº§çç»ä»¶å¯è½åºäºä¸åçæ¬çä¸æ¸¸ç»ä»¶æå»ºï¼å¯¼è´æ´ä¸ªäº§åå¨ä»»ææ¶é´ç¹é½å¤äºâéä¸è´æ§âç¶æã</p>
<h4 id="122-é»ç³ä¾èµä¸çæ¬å°ç±"><strong>1.2.2 é»ç³ä¾èµä¸çæ¬å°ç±</strong></h4>
<p>åå¸å¼æ¶ææå¸åçé®é¢æ¯<strong>é»ç³ä¾èµ (Diamond Dependency)</strong>ãåè®¾å­å¨åº A åå­å¨åº B é½ä¾èµäºå­å¨åº C çä¸åçæ¬ï¼èä¸æ¸¸çå­å¨åº D åæ¶ä¾èµäº A å Bãå½ D å°è¯æå»ºæ¶ï¼å°±ä¼éå°çæ¬å²çªï¼NuGet Hellï¼ãè§£å³è¿ç§å²çªéå¸¸éè¦äººå·¥ä»å¥ï¼å¼ºå¶ç»ä¸ä¾èµçæ¬ï¼è¿ä¸ä»èæ¶ï¼è¿å®¹æå¼å¥è¿è¡æ¶éè¯¯ã</p>
<h4 id="123-è·¨æ éæçæ­»é"><strong>1.2.3 è·¨æ éæçæ­»é</strong></h4>
<p>å½å¼åäººåéè¦è¿è¡è·¨è¶å¤ä¸ªææ¯æ çéææ¶ï¼ä¾å¦ï¼å¨ Runtime ä¸­å¼å¥æ° API å¹¶å¨ SDK ä¸­ç«å³ä½¿ç¨ï¼ï¼åå¸å¼æ¶æææäºå·¨å¤§çé»ç¢ãå¼åèå¿é¡»åå¨ Runtime æäº¤ä»£ç ï¼ç­å¾æå»ºåå¸ï¼ç¶åå¨ SDK ä¸­åçº§ä¾èµãè¿ç§âå¤é¶æ®µæäº¤âä¸ä»æçä½ä¸ï¼èä¸ä½¿å¾åå­æ§åæ´åå¾ä¸å¯è½ï¼ä¸¥éé»ç¢äºæ¶æå±é¢çææ¯æ¼è¿ã</p>
<h3 id="13-ç»ä¸æå»º-unified-build-çæç¥è½¬æ"><strong>1.3 ç»ä¸æå»º (Unified Build) çæç¥è½¬æ</strong></h3>
<p>ä¸ºäºè§£å³ä¸è¿°é®é¢ï¼å¾®è½¯æåºäº <strong>ç»ä¸æå»º (Unified Build)</strong> æ¿æ¯ï¼å¶æ ¸å¿ç®æ æ¯è½å¤ä»<strong>åä¸çæºç æäº¤ (Single Commit)</strong> æå»ºåºå®æ´ç.NET SDK äº§åãè¿ä¸ä»æ¯åé¨å·¥ç¨æççéæ±ï¼ä¹æ¯ä¸ºäºæ»¡è¶³ Linux åè¡çï¼å¦ Fedora, Debian, Ubuntuï¼çåè§æ§è¦æ±ãLinux ç¤¾åºæçä¸¥æ ¼çâæºç æå»ºâæ¿ç­ï¼è¦æ±è½¯ä»¶åå¿é¡»è½å¤å¨å¶åºç¡è®¾æ½ä¸ä»æºä»£ç ä»å¤´ç¼è¯ï¼èä¸ä¾èµé¢æå»ºçäºè¿å¶æä»¶ï¼Binary Blobsï¼ã</p>
<p>ä¸ºäºå®ç°è¿ä¸ç®æ ï¼å¿é¡»æç ´ç©çå­å¨åºçè¾¹çï¼å»ºç«ä¸ä¸ªé»è¾ä¸çç»ä¸è§å¾ã<strong>èæåä½å­å¨åº (VMR)</strong> åºè¿èçï¼å®æä¸ºäº Unified Build çç©çè½½ä½åæä½æ ¸å¿ã</p>
<h2 id="2-èæåä½å­å¨åº-vmr-çæ¶æè§£æ"><strong>2. èæåä½å­å¨åº (VMR) çæ¶æè§£æ</strong></h2>
<p>VMR (dotnet/dotnet) å¹¶éä¼ ç»æä¹ä¸çåä½å­å¨åºï¼èæ¯ä¸ç§æ··åæ¶ææ¨¡å¼ãå®å·§å¦å°å¹³è¡¡äºç°æå·¥ç¨æµç¨çæ¯æ§ä¸ç»ä¸æå»ºçéæ±ã</p>
<h3 id="21-å®ä¹-èæ-ä¸-åä½"><strong>2.1 å®ä¹ "èæ" ä¸ "åä½"</strong></h3>
<p>VMR çè®¾è®¡å²å­¦åå«ä¸¤ä¸ªæ ¸å¿ç»´åº¦ï¼</p>
<ul>
<li><strong>åä½æ§ (Monolithic):</strong> ä»æå»ºç³»ç»çè§åº¦çï¼VMR å°±æ¯ä¸ä¸ªæ åçåä½åºãå®åå«äºæå»º.NET SDK æéç<strong>ææ</strong>æºä»£ç ãæå»ºèæ¬ãåºç¡è®¾æ½å®ä¹åæµè¯ç¨ä¾ãå¨è¿ä¸ªå­å¨åºä¸çä»»æä¸ä¸ª Git Commit SHAï¼é½å¯ä¸ä¸å®æ´å°å®ä¹äºè¯¥æ¶å».NET äº§åçå¨è²ã</li>
<li><strong>èææ§ (Virtual):</strong> ä»å¼åå·¥ä½æµçè§åº¦çï¼å®æ¯ä¸ä¸ªâæå½±âæâéåâãåå§çäº§åå­å¨åºï¼å¦ dotnet/runtime, dotnet/sdkï¼ä¾ç¶å­å¨ï¼å¹¶ä¸æ¯å¤§å¤æ°å¼åäººåæ¥å¸¸å·¥ä½çâä¸»æåºâãVMR ä¸­çä»£ç å¹¶éå­ç©ºäº§çï¼èæ¯éè¿èªå¨åæºå¶ä»è¿äºäº§åå­å¨åºåæ­¥èæ¥çãå æ­¤ï¼VMR æ¯åç»ä»¶çèåä½ï¼èéæ¿ä»£å ã</li>
</ul>
<h3 id="22-æä»¶ç³»ç»ä¸å­å¨æ¨¡å"><strong>2.2 æä»¶ç³»ç»ä¸å­å¨æ¨¡å</strong></h3>
<p>VMR çç®å½ç»æç»è¿ç²¾å¿è®¾è®¡ï¼ä»¥æ å°å¹¶æ´åæ¥èªæ°åä¸ªä¸æ¸¸å­å¨åºçåå®¹ã</p>
<ul>
<li><strong>src/ ç®å½ï¼</strong> è¿æ¯ VMR çæ ¸å¿ãæ¯ä¸ªä¸æ¸¸äº§åå­å¨åºçåå®¹è¢«æ å°å° src/ ä¸çä¸ä¸ªå­ç®å½ä¸­ãä¾å¦ï¼dotnet/runtime çæºç è¢«æ¾ç½®å¨ src/runtimeï¼dotnet/aspnetcore è¢«æ¾ç½®å¨ src/aspnetcoreãè¿ç§ç©çä¸çèåä½¿å¾è·¨ç»ä»¶çæç´¢ãéæåæå»ºæä¸ºå¯è½ã</li>
<li><strong>eng/ ç®å½ï¼</strong> åå«å±äº«çå·¥ç¨åºç¡è®¾æ½ï¼ç¹å«æ¯ Arcade å·¥å·éãè¿æ¯.NET å¢ééç¨çæå»ºç³»ç»æ ¸å¿ã</li>
<li><strong>eng/common/ï¼</strong> è¿æ¯ä¸ä¸ªç¹æ®çå¼å¯¼ç®å½ï¼åå«ç¨äºå¯å¨æå»ºè¿ç¨çèæ¬ãè¿äºæä»¶éå¸¸ä» Arcade å­å¨åºåæ­¥èæ¥ï¼ç¨äºç¡®ä¿ææç»ä»¶ä½¿ç¨ä¸è´çæå»ºå·¥å·çæ¬ã</li>
<li><strong>source-manifest.jsonï¼</strong> è¿æ¯ VMR çâæ°æ®åºâæâæ³¨åè¡¨âãç±äº VMR æ¯ç±å¤ä¸ªä¸æ¸¸ä»åºèåèæï¼ç³»ç»å¿é¡»ç²¾ç¡®è®°å½ VMR å½åç¶æå¯¹åºäºä¸æ¸¸ä»åºçåªä¸ª Commit SHAãè¯¥ JSON æä»¶ç»´æ¤äºç»ä»¶åç§°ãè¿ç¨ä»åº URL ä»¥åå½ååæ­¥ç Git Hash çæ å°å³ç³»ï¼æ¯å®ç°åååæ­¥çå³é®åæ°æ®ã</li>
</ul>
<h3 id="23-å­å¨æ¨¡åçç¹æ®å¤ç"><strong>2.3 å­å¨æ¨¡åçç¹æ®å¤ç</strong></h3>
<p>ä¸ºäºéåº.NET çåºå¤§è§æ¨¡åç¹æ®æå»ºéæ±ï¼VMR å¨å­å¨æ¨¡åä¸åäºä¸äºéæ å Git çå¤çï¼</p>
<ul>
<li><strong>å­æ¨¡åå®ä½å (Hard Copy vs Pointers):</strong> ä¸ Git Submodules ä»å­å¨æåå¤é¨ä»åºçæéä¸åï¼VMR å°å­æ¨¡åçä»£ç <strong>ç©çå¤å¶</strong>å¹¶æäº¤å° VMR ç Git æ ä¸­ãè¿æå³ç src/runtime ä¸ä¸ä»ææä»¶ï¼èä¸è¿äºæä»¶æ¯ VMR åå²çä¸é¨åãè¿æ ·åæ¯ä¸ºäºæ¯æç¦»çº¿æå»ºï¼Source Buildï¼ï¼ç¡®ä¿å³ä½¿å¨æ²¡æç½ç»è¿æ¥çç¯å¢ä¸ï¼åªè¦åéäº VMRï¼å°±æ¥æäºæå»ºæéçä¸åä»£ç ã</li>
<li><strong>æä»¶å±è½ä¸è·¯å¾æ å° (Cloaking):</strong> ä¸æ¸¸å­å¨åºä¸­å¯è½åå«ä¸äºä¸éåæ¾å¥ VMR çæä»¶ï¼ä¾å¦å¤§å°ºå¯¸çäºè¿å¶æµè¯æ°æ®ãWindows ä¸ç¨çé­æºç»ä»¶ï¼æèè¿å Linux åè¡çè®¸å¯åè®®çæä»¶ãVMR çåæ­¥æºå¶æ¯æéç½®âå±è½è§åâï¼å¨åæ­¥è¿ç¨ä¸­èªå¨åé¤è¿äºè·¯å¾/æä»¶ãè¿ç±»ä¼¼äº .gitignoreï¼ä½åçå¨åæ­¥é»è¾å±é¢ã</li>
</ul>
<h2 id="3-åæ­¥æºå¶è¯¦è§£maestro-ä¸-darc"><strong>3. åæ­¥æºå¶è¯¦è§£ï¼Maestro ä¸ Darc</strong></h2>
<p>VMR ççå½åå¨äºå¶åæ­¥æºå¶ãå¦ææ²¡æé«æãåç¡®çåæ­¥ï¼VMR å°è¿éä¸ä¸æ¸¸å­å¨åºè±èï¼å¤±å»å¶ä½ä¸ºâçç¸æ¥æºâçä»·å¼ãå¾®è½¯ä¸ºæ­¤æå»ºäºä¸å¥å¤æçä¾èµæµç³»ç»ï¼æ ¸å¿ç»ä»¶åæ¬äºæå¡ <strong>Maestro</strong> åå½ä»¤è¡å·¥å· <strong>Darc</strong>ã</p>
<h3 id="31-åæ­¥æ¶æçæ¼è¿é¶æ®µ"><strong>3.1 åæ­¥æ¶æçæ¼è¿é¶æ®µ</strong></h3>
<p>VMR çåæ­¥æºå¶å¹¶éä¸è¹´èå°±ï¼èæ¯ç»åäºä¸ä¸ªé¶æ®µçè¿­ä»£ ï¼</p>
<ul>
<li><strong>é¶æ®µä¸ï¼Source Build Tarball (æºç æå»ºåç¼©å)</strong><br>
å¨.NET 6 æ¶ä»£ï¼æè°çâåä½âä»ä»æ¯ä¸ä¸ªå·¨å¤§ç Tarball åç¼©åï¼ä¸é¨æä¾ç» Linux åä½ä¼ä¼´ãå®éè¿ä¸ç³»åè¡¥ä¸ï¼Patchesï¼å°åä¸ªä»åºçæºç æ¼åå¨ä¸èµ·ãè¿ç§æ¹å¼ç¼ºä¹çæ¬æ§å¶åå²ï¼è°è¯æå¶å°é¾ï¼è¢«æè¿°ä¸ºâèå¼±ä¸ä¸éæâã</li>
<li><strong>é¶æ®µäºï¼VMR-lite (åååªè¯»éå)</strong><br>
2022 å¹´ 10 æï¼å¾®è½¯å»ºç«äºåªè¯»ç VMRãåæ­¥æ¯ååçï¼ä»äº§åå­å¨åºæµå VMRãè¿è§£å³äºä»£ç å¯è§æ§ååå²è¿½è¸ªé®é¢ï¼ä½ç±äºæ¯ååçï¼å¼åèæ æ³ç´æ¥å¨ VMR ä¸­ä¿®å¤éæéè¯¯ï¼å¿é¡»åå°åä»åºä¿®æ¹ï¼å¯¼è´åé¦å¾ªç¯è¿é¿ã</li>
<li><strong>é¶æ®µä¸ï¼Writable VMR (ååè¯»ååæ­¥)</strong> ä».NET 10 Preview 5 å¼å§ï¼VMR åä¸ºå¯è¯»åãå¼å¥äºâæå¹³åæµ (Flat Flow)âæ¨¡åï¼åè®¸ä»£ç å¨äº§åå­å¨åºå VMR ä¹é´ååæµå¨ãè¿æ å¿ç VMR æ­£å¼æä¸ºçäº§çº§çåºç¡è®¾æ½ã</li>
</ul>
<h3 id="32-æ§å¶å¹³é¢maestro-äº§åæå»ºæå¡"><strong>3.2 æ§å¶å¹³é¢ï¼Maestro (äº§åæå»ºæå¡)</strong></h3>
<p><strong>Maestro</strong>ï¼ä¹è¢«ç§°ä¸ºäº§åæå»ºæå¡ï¼Product Construction Serviceï¼æ¯ç¼ææ´ä¸ª.NET æå»ºçæç³»ç»çâå¤§èâãå®æ¯ä¸ä¸ªè¿è¡å¨ Azure ä¸çå¾®æå¡ï¼è´è´£çå¬å­å¨åºç¶æãè®¡ç®ä¾èµå³ç³»å¹¶è§¦åä»£ç æµã</p>
<p><strong>Maestro çæ ¸å¿èè´£ï¼</strong></p>
<ol>
<li><strong>è®¢éç®¡ç (Subscription Management):</strong> Maestro ç»´æ¤çä¸å¼ åºå¤§çè®¢éå¾ãè®¢éå®ä¹äºâæºä»åºâä¸âç®æ ä»åºâä¹é´çå³ç³»ãä¾å¦ï¼dotnet/runtime ç main åæ¯è®¢éäº dotnet/dotnet (VMR) ç main åæ¯ã</li>
<li><strong>èªå¨ PR åå»º:</strong> å½æºä»åºäº§çæ°çæå»ºæ¶ï¼Maestro ä¼è®¡ç®å·®å¼ï¼å¹¶èªå¨å¨ç®æ ä»åºåå»º Pull Request (PR)ã</li>
<li><strong>å²çªæ£æµ:</strong> å¦æåæ­¥è¿ç¨ä¸­åç°æä»¶å²çªï¼Maestro ä¼æ è®° PR å¹¶éç¥ç¸å³ç»´æ¤èï¼éå¸¸æ¯ @dotnet/product-construction å¢éï¼ã</li>
</ol>
<h3 id="33-å¼åèå·¥å·darc-cli"><strong>3.3 å¼åèå·¥å·ï¼Darc CLI</strong></h3>
<p><strong>Darc</strong> æ¯å¼åèä¸ Maestro æå¡äº¤äºçæ¬å°å½ä»¤è¡æ¥å£ãå®åè®¸å¼åèæ¥çãæ·»å ææ´æ°è®¢éï¼å¹¶å¨æ¬å°æ¨¡æåæ­¥è¿ç¨ã</p>
<p>æ ¸å¿å½ä»¤è§£æ :</p>
<ul>
<li>darc get-subscriptions: ååºå½åä»åºææå®ä»åºçæææ´»è·è®¢éãè¾åºéå¸¸åå«æºä»åº URLãç®æ åæ¯ãæ´æ°é¢çç­ä¿¡æ¯ã</li>
<li>darc add-subscription: åå»ºæ°çä¾èµæµééãä¾å¦ï¼å° dotnet/arcade çæ´æ°æµå dotnet/msbuildã</li>
<li>darc update-subscription: ä¿®æ¹ç°æè®¢éçåæ°ï¼å¦æé¤ç¹å®çèµäº§ï¼Excluded Assetsï¼æè°æ´æ¹å¤çç­ç¥ã</li>
<li>darc vmr forwardflow / backflow: ï¼è½ç¶ææ¡£æªè¯¦ç»å±å¼ï¼ä½æ¨æµå­å¨ï¼ç¨äºå¨æ¬å°è§¦å VMR çæ­£åæåååæ­¥é»è¾ï¼å¸®å©å¼åèéªè¯åæ´ ã</li>
</ul>
<h3 id="34-ä»£ç æµç®æ³-code-flow-algorithm"><strong>3.4 ä»£ç æµç®æ³ (Code Flow Algorithm)</strong></h3>
<p>VMR çåæ­¥éè¿ä¸¤ç§ä¸»è¦çä»£ç æµæ¨¡å¼å®ç°ï¼<strong>æ­£åæµ (Forward Flow)</strong> å <strong>ååæµ (Backflow)</strong>ã</p>
<h4 id="341-æ­£åæµ-forward-flow-äº§ååº---vmr"><strong>3.4.1 æ­£åæµ (Forward Flow): äº§ååº -&gt; VMR</strong></h4>
<p>å½å¼åèå¨ dotnet/runtime åå¹¶äºä¸ä¸ª PR åï¼</p>
<ol>
<li><strong>è§¦å:</strong> Maestro æ£æµå°æå»ºæåã</li>
<li><strong>è¡¥ä¸çæ:</strong> ç³»ç»æ ¹æ® VMR ä¸­è®°å½ç source-manifest.json è·åä¸ä¸æ¬¡åæ­¥ç Commit SHAï¼å¹¶ä¸å½åææ°ç Commit SHA è¿è¡å¯¹æ¯ãä½¿ç¨ git diff --patch --binary çæåå«äºäºè¿å¶å·®å¼çè¡¥ä¸æä»¶ã</li>
<li><strong>è·¯å¾éå:</strong> è¡¥ä¸ä¸­çæä»¶è·¯å¾ä¼è¢«éåï¼å ä¸åç¼ï¼å¦ src/runtime/ï¼ï¼ä»¥å¹é VMR çç®å½ç»æã</li>
<li><strong>åºç¨ä¸æäº¤:</strong> è¡¥ä¸åºç¨å° VMR åæ¯ä¸ï¼å¹¶æ´æ° source-manifest.json ä¸­ç SHA è®°å½ãè¿ä¸ªè¿ç¨æ¯èªå¨åçã</li>
</ol>
<h4 id="342-ååæµ-backflow-vmr---äº§ååº"><strong>3.4.2 ååæµ (Backflow): VMR -&gt; äº§ååº</strong></h4>
<p>å½å¼åèç´æ¥å¨ VMR ä¸­è¿è¡è·¨ç»ä»¶ä¿®æ¹ï¼ä¾å¦åæ¶ä¿®æ¹ Runtime å SDKï¼å¹¶åå¹¶åï¼</p>
<ol>
<li><strong>éåæ å°:</strong> ç³»ç»è¯å«åºåªäºæä»¶å±äºåªä¸ªå­ç»ä»¶ã</li>
<li><strong>åæ¯ä¸ PR:</strong> éå¯¹æ¯ä¸ªåå½±åçäº§åå­å¨åºï¼ç³»ç»ä¼åå»ºä¸ä¸ªåå«æºç åæ´ç PRã</li>
<li><strong>ä¾èµæ´æ°:</strong> å³é®ç¹å¨äºï¼ååæµä¸ä»åå«<strong>æºç </strong>ï¼è¿åå« VMR æå»ºåºç<strong>æ°äºè¿å¶åçæ¬</strong>ãè¿æå³çï¼å½ååæµåå° dotnet/runtime æ¶ï¼è¯¥ä»åºç Version.Details.xml ä¹ä¼è¢«æ´æ°ï¼æå VMR æå»ºåºçææ°ä¾èµãè¿ä¿è¯äºäº§ååºå§ç»åºäºææ°çå¨æ ç¯å¢è¿è¡æå»ºã</li>
</ol>
<h3 id="35-ç¶æè¿½è¸ªä¸é²ç¯è·¯è®¾è®¡"><strong>3.5 ç¶æè¿½è¸ªä¸é²ç¯è·¯è®¾è®¡</strong></h3>
<p>åååæ­¥æå®¹æå¯¼è´çé®é¢æ¯æ­»å¾ªç¯ï¼Ping-Pong Effectï¼ï¼A çåæ´åæ­¥ç» Bï¼B çæå»ºè§¦ååæ­¥å Aãä¸ºäºé²æ­¢è¿ç§æåµï¼.NET å¢ééç¨äºä¸¥æ ¼çç¶æè¿½è¸ªæºå¶ã</p>
<ul>
<li><strong>eng/Version.Details.xml:</strong> å¨äº§ååºä¸­ï¼æ­¤æä»¶è®°å½äºè¯¥ä»åºä¾èµç VMR çæ¬ã</li>
<li><strong>src/source-manifest.json:</strong> å¨ VMR ä¸­ï¼æ­¤æä»¶è®°å½äºåå«çåäº§ååºçæ¬ã</li>
</ul>
<p>åæ­¥é»è¾ä¼æ£æ¥è¿äºåæ°æ®ãå¦æ Maestro åç° VMR ä¸­çåæ´å®éä¸å°±æ¯æºèªäº§ååºæè¿çä¸æ¬¡æäº¤ï¼å®ä¼è¯å«ä¸ºâå·²åæ­¥âï¼ä»èéè¿ç©ºæä½ï¼No-Opï¼åæ­å¾ªç¯ã</p>
<h2 id="4-ç»ä¸æå»º-unified-build-ä¸ä¾åºé¾å®å¨"><strong>4. ç»ä¸æå»º (Unified Build) ä¸ä¾åºé¾å®å¨</strong></h2>
<p>VMR çå»ºç«ä¸ä»ä»æ¯ä¸ºäºæ¹ä¾¿ä»£ç ç®¡çï¼æ´æ¯ <strong>Unified Build</strong> çåºç³ãå®æ¹åäº.NET äº§åçæå»ºèå¼ï¼ä»æ°´å¹³åå±æå»ºè½¬ååç´åçæå»ºã</p>
<h3 id="41-åç´æå»º-vertical-builds"><strong>4.1 åç´æå»º (Vertical Builds)</strong></h3>
<p>å¨æ§çæ¨¡å¼ä¸ï¼æå»ºæ¯æ°´å¹³çï¼åæå»ºææ Runtimeï¼åæå»ºææ ASP.NETãèå¨ VMR ä¸­ï¼æå»ºæ¯<strong>åç´</strong>çã ä¸ä¸ªåç´æå»ºä¼åºäº VMR çåä¸ Commitï¼æç§ä¾èµé¡ºåºï¼Toolset -&gt; Runtime -&gt; ASP.NET -&gt; SDKï¼å¨ä¸æ¬¡æå»ºæµæ°´çº¿ä¸­ä»æºç ç¼è¯åºæ´ä¸ªæ ã</p>
<p><strong>ä¼å¿ï¼</strong></p>
<ul>
<li><strong>æ¶é¤æ¶é´å·®:</strong> ä»»ä½ä»£ç åæ´é½ä¼ç«å³å¨å¨æ èå´åè¿è¡éªè¯ã</li>
<li><strong>ç®ååå¸:</strong> åå¸.NET 10 Preview 1 åªéè¦å¯¹ VMR çç¹å® Commit ææ ç­¾ï¼èä¸éè¦åè°å åä¸ªä»åºç Commit ç»åã</li>
</ul>
<h3 id="42-linux-æºç æå»º-source-build-ä¸åè¡çåè§"><strong>4.2 Linux æºç æå»º (Source Build) ä¸åè¡çåè§</strong></h3>
<p>Linux åè¡çï¼å¦ Fedora, Red Hatï¼å¯¹è½¯ä»¶åæä¸¥æ ¼çâæºç æå»ºâè¦æ±ãä»ä»¬ä¸ä¿¡ä»»ä¸æ¸¸ååæä¾çé¢ç¼è¯äºè¿å¶æä»¶ï¼å ä¸ºè¿äºæä»¶å¯è½åå«åé¨ææªä¿®è¡¥çæ¼æ´ï¼ä¸æ æ³å®¡è®¡ã</p>
<p>VMR éè¿æä¾ä¸ä¸ªèªåå«ç Git ä»åºï¼å®ç¾æ¯æäºè¿ä¸éæ±ï¼</p>
<ol>
<li><strong>ç¦»çº¿è½å:</strong> VMR åå«äºææå¿è¦çæºç ï¼éè¿å®ä½åçå­æ¨¡åï¼ï¼ä¸ä¾èµæå»ºæ¶ç git clone æä½ã</li>
<li><strong>é¢å¶èæ¬:</strong> prep-source-build.sh èæ¬ç¨äºåå¤ç¯å¢ã</li>
<li><strong>å¼ç¨å (Reference Packages):</strong> ä¸ºäºè§£å³å¾ªç¯ä¾èµï¼å¦æå»º C# ç¼è¯å¨éè¦ C# ç¼è¯å¨ï¼ï¼Unified Build å¼å¥äº dotnet/source-build-reference-packagesãè¿äºæ¯ä»åå« API å®ä¹ï¼åæ°æ®ï¼çææ¬æ ¼å¼åï¼å¯ä»¥è½»æå°ä»æºç çæï¼ä½ä¸ºèªä¸¾ï¼Bootstrappingï¼çèµ·ç¹ 5ã</li>
</ol>
<h3 id="43-å¯éç°æå»º-reproducible-builds"><strong>4.3 å¯éç°æå»º (Reproducible Builds)</strong></h3>
<p>ä¾åºé¾å®å¨çæ ¸å¿æ¯<strong>å¯éç°æ§</strong>ãå³ï¼å¨ä¸åç¯å¢ãä¸åæ¶é´ï¼ä½¿ç¨ç¸åçæºç åºå½çææ¯ç¹çº§å®å¨ä¸è´ï¼Bit-for-bit identicalï¼çäºè¿å¶æä»¶ 15ã</p>
<p>VMR æ¶ææå¤§å°ä¿è¿äºè¿ä¸ç¹ï¼</p>
<ul>
<li><strong>è¾å¥ç¡®å®æ§:</strong> åä¸ Commit éå®äºæææºä»£ç è¾å¥ã</li>
<li><strong>ç¯å¢ä¸è´æ§:</strong> eng/common éå®äºæææå»ºå·¥å·é¾çæ¬ã</li>
<li><strong>è·¯å¾è§èå:</strong> ç¼è¯å¨éç½®è¢«è°æ´ä¸ºå¿½ç¥ç»å¯¹è·¯å¾ï¼å¦ /home/user/srcï¼ï¼ä½¿ç¨ç¸å¯¹è·¯å¾æç¡®å®æ§è·¯å¾æ å°ï¼Source Linkï¼ï¼ç¡®ä¿æå»ºäº§ç©ä¸åå«æå»ºæºå¨çåæ°æ® 16ã</li>
</ul>
<p>è¿ä½¿å¾ç¬¬ä¸æ¹ï¼å¦ä¼ä¸å®å¨å¢éææ¿åºæºæï¼å¯ä»¥ç¬ç«éªè¯å¾®è½¯åå¸ç.NET SDK æ¯å¦ççç±å¬å¼çæºç æå»ºèæ¥ï¼ä»èé²æ­¢ç±»ä¼¼ SolarWinds çä¾åºé¾æ»å»ã</p>
<h2 id="5-å¼åèå·¥ä½æµä¸ä½éª"><strong>5. å¼åèå·¥ä½æµä¸ä½éª</strong></h2>
<p>VMR çå¼å¥å¯¹å¼åèçæ¥å¸¸å·¥ä½æµäº§çäºæ·±è¿å½±åï¼å½¢æäºâåå¾ªç¯âä¸âå¤å¾ªç¯âå¹¶å­çå±é¢ã</p>
<h3 id="51-åå¾ªç¯-inner-loopäº§ååºå¼å"><strong>5.1 åå¾ªç¯ (Inner Loop)ï¼äº§ååºå¼å</strong></h3>
<p>å¯¹äºç»å¤§å¤æ°æ¥å¸¸ä»»å¡ï¼å¦ä¿®å¤ System.String ä¸­ç Bugï¼ï¼å¼åèä¾ç¶å·¥ä½å¨ dotnet/runtime ç­ç¬ç«äº§ååºä¸­ã</p>
<ul>
<li><strong>æµç¨:</strong> Fork -&gt; Clone -&gt; Branch -&gt; Commit -&gt; PRã</li>
<li><strong>ä¼å¿:</strong> ä¿æäºè¾å°çä»åºä½ç§¯ï¼ç¸æ¯ VMRï¼ï¼IDE å è½½éåº¦å¿«ï¼æå»ºæ¶é´ç­ã</li>
<li><strong>åæ­¥:</strong> åæ´åå¹¶åï¼å¼åèæ éæå¨æä½ï¼Maestro ä¼èªå¨å°å¶æ­£åæµè½¬å° VMRã</li>
</ul>
<h3 id="52-å¤å¾ªç¯-outer-loopvmr-å¼å"><strong>5.2 å¤å¾ªç¯ (Outer Loop)ï¼VMR å¼å</strong></h3>
<p>å½ä»»å¡æ¶åè·¨ä»åºä¿®æ¹æ¶ï¼å¼åèåæ¢å° VMRã</p>
<ul>
<li><strong>åºæ¯:</strong> ä¿®æ¹ Roslyn ç¼è¯å¨çä¸ä¸ªæ¥å£ï¼å¹¶åæ¶æ´æ° Runtime ä¸­å¯¹è¯¥æ¥å£çè°ç¨ã</li>
<li><strong>æµç¨:</strong> Clone dotnet/dotnet -&gt; ä¿®æ¹ src/roslyn å src/runtime -&gt; æ¬å°å¨éæå»ºéªè¯ -&gt; æäº¤ PR ç» VMRã</li>
<li><strong>ä¼å¿:</strong> åå­æ§æäº¤ï¼ä¸æ¬¡æ§è§£å³ææç ´åæ§åæ´ï¼Breaking Changesï¼ï¼æ éä¸´æ¶ååå¼å®¹ä»£ç  ã</li>
</ul>
<h3 id="53-çç¹ä¸ææ"><strong>5.3 çç¹ä¸ææ</strong></h3>
<p>å°½ç®¡ VMR è§£å³äºæ¶æé®é¢ï¼ä½ä¹ç»å¼åèå¸¦æ¥äºä¸äºâçç¹âï¼</p>
<ol>
<li><strong>ä»åºä½ç§¯:</strong> VMR éå¸¸åºå¤§ï¼Clone å Checkout çæ¶é´æ¾èå¢å ã</li>
<li><strong>æå»ºæ¶é´:</strong> åç´æå»ºæ´ä¸ª.NET æ éè¦æ¶èå¤§éçè®¡ç®èµæºåæ¶é´ï¼æ®éå¼åèçç¬è®°æ¬çµèå¯è½é¾ä»¥éè¿ VMR è¿è¡å¨éè°è¯ã</li>
<li><strong>æéæ§å¶:</strong> å¨å¤ä»åºæ¨¡å¼ä¸ï¼æéå¯ä»¥ç»åï¼å¦åªæç¹å®å¢éè½åå¹¶ Runtime ä»£ç ï¼ãå¨ VMR ä¸­ï¼æéç®¡çåå¾æ´å å¤æï¼éè¦éè¿ CODEOWNERS æä»¶ç²¾ç»æ§å¶ç®å½çº§æéï¼é²æ­¢è¯¯æä½ ã</li>
</ol>
<h2 id="6-æ¶æå¯¹æ¯åæ"><strong>6. æ¶æå¯¹æ¯åæ</strong></h2>
<p>ä¸ºäºæ´æ¸æ°å°å®ä½ VMR çæ¶æå±æ§ï¼æä»¬å°å¶ä¸ä¸çå¶ä»ä¸»æµæ¹æ¡è¿è¡å¯¹æ¯ã</p>
<h3 id="è¡¨-1vmr-ä¸-ä¼ ç»-monorepo-å-git-submodules-çæ·±åº¦å¯¹æ¯"><strong>è¡¨ 1ï¼VMR ä¸ ä¼ ç» Monorepo å Git Submodules çæ·±åº¦å¯¹æ¯</strong></h3>
<table>
<thead>
<tr>
<th style="text-align: left">ç¹æ§</th>
<th style="text-align: left">åå¸å¼å¤ä»åº (Legacy.NET)</th>
<th style="text-align: left">æ å Monorepo (Google/Meta)</th>
<th style="text-align: left">èæåä½åº (.NET VMR)</th>
<th style="text-align: left">Git Submodules æ¹æ¡</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><strong>ä»£ç å­å¨</strong></td>
<td style="text-align: left">ç©çåæ£ï¼é»è¾è¿æ¥</td>
<td style="text-align: left">ç©çéä¸­ï¼åä¸ä»åº</td>
<td style="text-align: left"><strong>ç©çéä¸­ï¼éåï¼ï¼é»è¾åæ£ï¼å¼åï¼</strong></td>
<td style="text-align: left">ç©çåæ£ï¼æéè¿æ¥</td>
</tr>
<tr>
<td style="text-align: left"><strong>çæ¬æ§å¶å·¥å·</strong></td>
<td style="text-align: left">Standard Git</td>
<td style="text-align: left">Custom (Piper, Mononoke) + Virtual FS</td>
<td style="text-align: left">Standard Git (éå¯ç¨é¿è·¯å¾æ¯æ)</td>
<td style="text-align: left">Standard Git</td>
</tr>
<tr>
<td style="text-align: left"><strong>æå»ºä¸è´æ§</strong></td>
<td style="text-align: left">ä½ (å­å¨ä¸è´æ§å»¶è¿)</td>
<td style="text-align: left">æé« (åå­æ§)</td>
<td style="text-align: left"><strong>é« (éè¿ Maestro åæ­¥ä¿é)</strong></td>
<td style="text-align: left">ä½ (ä¾èµæéæ´æ°ï¼æç¢)</td>
</tr>
<tr>
<td style="text-align: left"><strong>ç¦»çº¿æå»ºæ¯æ</strong></td>
<td style="text-align: left">å°é¾ (éæå NuGet å)</td>
<td style="text-align: left">åçæ¯æ</td>
<td style="text-align: left"><strong>åçæ¯æ (ä»£ç å®ä½å)</strong></td>
<td style="text-align: left">ä¸­ç­ (ééå½ Clone)</td>
</tr>
<tr>
<td style="text-align: left"><strong>å¼åç¯å¢ææ¬</strong></td>
<td style="text-align: left">ä½ (ä»é Clone ç¸å³åº)</td>
<td style="text-align: left">é« (éä¸ç¨å·¥å·æ¯æå¤§åº)</td>
<td style="text-align: left"><strong>ä¸­/é« (VMR åºå¤§ï¼ä½å¯éäº§ååº)</strong></td>
<td style="text-align: left">ä½</td>
</tr>
<tr>
<td style="text-align: left"><strong>è·¨ç»ä»¶éæ</strong></td>
<td style="text-align: left">æé¾ (å¤é¶æ®µæäº¤)</td>
<td style="text-align: left">å®¹æ (åå­æäº¤)</td>
<td style="text-align: left"><strong>å®¹æ (å¨ VMR ä¸­åå­æäº¤)</strong></td>
<td style="text-align: left">å°é¾ (éå¤åºåè°)</td>
</tr>
<tr>
<td style="text-align: left"><strong>æä»¶å±è½ (Cloaking)</strong></td>
<td style="text-align: left">ä¸éç¨</td>
<td style="text-align: left">æ¯æ (æå»ºè§åæ§å¶)</td>
<td style="text-align: left"><strong>åçæ¯æ (åæ­¥æ¶è¿æ»¤)</strong></td>
<td style="text-align: left">ä¸æ¯æ (å¨éæå)</td>
</tr>
</tbody>
</table>
<h3 id="61-ä¸-google-æ¨¡å¼çåºå«"><strong>6.1 ä¸ Google æ¨¡å¼çåºå«</strong></h3>
<p>Google å Meta ä½¿ç¨åä¸çå·¨åä»åºï¼Monolithï¼ï¼ææå¼åèç´æ¥å¨å¶ä¸­å·¥ä½ãè¿éè¦æå¶æè´µçå®å¶åºç¡è®¾æ½ï¼å¦èææä»¶ç³»ç» VFS for Git, Piperï¼ãå¾®è½¯å¹¶æªå¼ºå¶.NET ç¤¾åºä½¿ç¨è¿ç§éåè®¾æ½ï¼å ä¸ºå¼æºè´¡ç®èéå¸¸åªä½¿ç¨æ åç Git å®¢æ·ç«¯ãVMR ä½ä¸ºä¸ä¸ªâæå½±âï¼å¼å®¹äºæ å Git å·¥å·é¾ï¼è½ç¶çºç²äºä¸å®çå®æ¶æ§ï¼åæ­¥å»¶è¿ï¼ï¼ä½æ¢åäºå¯¹å¼æºç¤¾åºçåå¥½åº¦ ã</p>
<h3 id="62-ä¸ºä»ä¹ä¸ç´æ¥ä½¿ç¨-git-submodules"><strong>6.2 ä¸ºä»ä¹ä¸ç´æ¥ä½¿ç¨ Git Submodulesï¼</strong></h3>
<p>Git Submodules å¨å¤çå¤§è§æ¨¡é¡¹ç®æ¶éå¸¸èå¼±ãå¦æä¸æ¸¸ä»åºéåäºåå²ï¼Force Pushï¼ï¼å­æ¨¡åæéå°±ä¼å¤±æãæ­¤å¤ï¼Submodules æ æ³å¤çâæä»¶å±è½âéæ±ï¼å³å¨ Linux æå»ºä¸­åé¤ Windows äºè¿å¶æä»¶ï¼ãVMR éè¿ç©çå¤å¶åè¡¥ä¸æºå¶ï¼å½»åºè§£è¦äºå¯¹ä¸æ¸¸ Git åå²çä¾èµï¼å®ç°äºæ´å¥å£®çæ§å¶ã</p>
<h2 id="7-ææå±éæ§ä¸æªæ¥å±æ"><strong>7. ææãå±éæ§ä¸æªæ¥å±æ</strong></h2>
<h3 id="71-åæ¯å¯¹é½ä¸-snapping"><strong>7.1 åæ¯å¯¹é½ä¸ "Snapping"</strong></h3>
<p>ä¸ä¸ªä¸»è¦æææ¯å¦ä½ä¿æ VMR åæ¯ä¸æ°åä¸ªäº§ååºåæ¯çç²¾ç¡®å¯¹é½ãç¹å«æ¯å¨åå¸çªå£æï¼Snapï¼ï¼ææä»åºå¿é¡»å ä¹åæ¶ååº release/x.y åæ¯ãç°å¨ï¼è¿ä¸è¿ç¨ç± VMR ä¸­å¿åé©±å¨ï¼VMR åååæ¯ï¼ç¶åéè¿èªå¨åå·¥å·å¼ºå¶ææä¸æ¸¸äº§ååºååï¼ä»¥é²æ­¢åå²éä½ ã</p>
<h3 id="72-åå¹¶å²çªçå¤ææ§"><strong>7.2 åå¹¶å²çªçå¤ææ§</strong></h3>
<p>éç VMR åä¸ºå¯åï¼åååæ­¥å¸¦æ¥çåå¹¶å²çªä¸å¯é¿åãå¦æä¸ä¸ªæä»¶å¨ VMR ä¸­è¢«ä¿®æ¹ï¼éæï¼ï¼åæ¶å¨äº§ååºä¸­è¢«ä¿®æ¹ï¼Bugä¿®å¤ï¼ï¼åæ­¥ PR å°±ä¼å¤±è´¥ãç®åè¿ä¸»è¦ä¾èµäººå·¥ä»å¥è§£å³ãæªæ¥çæ¹è¿æ¹åå¯è½æ¯å¼å¥æ´æºè½çè¯­ä¹åå¹¶å·¥å·ã</p>
<h3 id="73-åºç¡è®¾æ½ææ¬"><strong>7.3 åºç¡è®¾æ½ææ¬</strong></h3>
<p>è¿è¡ Maestro æå¡åé¢ç¹çåç´æå»ºå¯¹ CI/CD èµæºï¼Azure DevOpsï¼ææäºå·¨å¤§ååãæ¯æ¬¡åæ­¥é½éè¦å¤§éçè®¡ç®èµæºæ¥çæè¡¥ä¸ãåºç¨è¡¥ä¸å¹¶è¿è¡å¨å¥æµè¯ãä¼åæå»ºæçï¼å¦å¢éæå»ºãç¼å­å¤ç¨ï¼æ¯æç»­ä¼åçéç¹ã</p>
<h3 id="74-æªæ¥å±æ"><strong>7.4 æªæ¥å±æ</strong></h3>
<p>å±ææªæ¥ï¼VMR å¯è½ä¼éæ¸ä»âéåâè¿æ¸¡ä¸ºâä¸»æºâãéç Git å¯¹å¤§ä»åºæ¯æçæ¹è¿ï¼å¦ Scalar, Sparse Checkout çæ®åï¼ï¼ä¹è®¸æä¸å¤©å¾®è½¯ä¼å»ºè®®æææ ¸å¿å¼åèç´æ¥å¨ VMR ä¸å·¥ä½ï¼èå°æåçäº§ååºä½ä¸ºåªè¯»éåæä¾ç»åªéå³æ³¨ç¹å®ç»ä»¶çç¤¾åºæåãè¿å°å½»åºåè½¬ç®åçææç»æï¼è¿ä¸æ­¥ç®åæ¶æ ã</p>
<h2 id="ç»è®º"><strong>ç»è®º</strong></h2>
<p>.NET èæåä½å­å¨åº (VMR) ä»£è¡¨äºå¤§åå¼æºè½¯ä»¶å·¥ç¨é¢åçä¸æ¬¡å¤§èå°è¯ä¸åæ°ãå®å¹¶æªç²ç®ç§æ¬ Google çé­æºåä½æ¨¡å¼ï¼ä¹æ²¡æåºå®ä¼ ç»çå¤ä»åºæ³¥æ½­ï¼èæ¯å¼åäºä¸æ¡âä¸­é´éè·¯âã</p>
<p>éè¿ <strong>Maestro</strong> çæºè½ç¼æå <strong>VMR</strong> çç»æåæ å°ï¼å¾®è½¯æåå°å¨ä¸ç ´åç°æå¼åçæçåæä¸ï¼è§£å³äºä¸è´æ§å»¶è¿åä¾åºé¾å®å¨çé¾é¢ãVMR ä¸ä»å®ç°äº Linux åè¡ççåè§æ§è¦æ±ï¼æ´ä¸º.NET å¹³å°æªæ¥çé¿ææ¼è¿æä¾äºåå®çæ¶æåºç¡ãå¯¹äºä»»ä½é¢ä¸´å¾®æå¡ç¢çåæ²»çãè·¨ç»ä»¶åä½å°é¾ä»¥åæå»ºä¸è´æ§ææçå¤§åè½¯ä»¶ç»ç»èè¨ï¼.NET VMR çæ¶æè®¾è®¡é½æä¾äºæå·ä»·å¼çåèèå¼ã</p>

</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬¢è¿å¤§å®¶æ«æä¸é¢äºç»´ç æä¸ºæçå®¢æ·ï¼æ¶ä½ ä¸äº</p>
<img src="https://images.cnblogs.com/cnblogs_com/shanyou/57459/o_220125090408_%E9%82%80%E8%AF%B7%E4%BA%8C%E7%BB%B4%E7%A0%81-258px.jpeg" width="170">
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.004861111111111111" data-date-updated="2026-01-27 22:49">2026-01-27 22:42</span>&nbsp;
<a href="https://www.cnblogs.com/shanyou">å¼ åå</a>&nbsp;
éè¯»(<span id="post_view_count">98</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19540873);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19540873', targetLink: 'https://www.cnblogs.com/shanyou/p/19540873', title: '.NET èæåä½å­å¨åº (VMR)æ¶ææ¼è¿ãåæ­¥æºå¶ä¸ç»ä¸æå»ºç­ç¥' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ AI Agent æ¡æ¶æ¢ç§ï¼æè§£ OpenHandsï¼3ï¼--- å¯å¨ ]]></title>
    <link>https://www.cnblogs.com/rossiXYZ/p/19530105</link>
    <guid>a6beb53f3478766ed5d0aadd409ea96d</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/rossiXYZ/p/19530105" title="åå¸äº 2026-01-27 20:55">
    <span role="heading" aria-level="2">AI Agent æ¡æ¶æ¢ç§ï¼æè§£ OpenHandsï¼3ï¼--- å¯å¨</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ai-agent-æ¡æ¶æ¢ç§æè§£-openhands3----å¯å¨">AI Agent æ¡æ¶æ¢ç§ï¼æè§£ OpenHandsï¼3ï¼--- å¯å¨</h1>
<p></p><div class="toc"><div class="toc-container-header">ç®å½</div><ul><li><a href="#ai-agent-æ¡æ¶æ¢ç§æè§£-openhands3----å¯å¨" rel="noopener nofollow">AI Agent æ¡æ¶æ¢ç§ï¼æè§£ OpenHandsï¼3ï¼--- å¯å¨</a><ul><li><a href="#0x00-æ¦è¦" rel="noopener nofollow">0x00 æ¦è¦</a></li><li><a href="#0x01-èæ¯" rel="noopener nofollow">0x01 èæ¯</a><ul><li><a href="#11-æ»ä½æ¶æ" rel="noopener nofollow">1.1 æ»ä½æ¶æ</a></li><li><a href="#12-åå¥ç¹" rel="noopener nofollow">1.2 åå¥ç¹</a></li></ul></li><li><a href="#0x02-åå§å--run_controller" rel="noopener nofollow">0x02 åå§å @ run_controller</a><ul><li><a href="#21-æ»ä½æµç¨" rel="noopener nofollow">2.1 æ»ä½æµç¨</a></li><li><a href="#22-åå»ºæ³¨åä¸­å¿" rel="noopener nofollow">2.2 åå»ºæ³¨åä¸­å¿</a></li><li><a href="#23-åå»ºagent" rel="noopener nofollow">2.3 åå»ºAgent</a></li><li><a href="#24-æå»ºruntime" rel="noopener nofollow">2.4 æå»ºRuntime</a></li><li><a href="#25-æå»ºmemory--microagent" rel="noopener nofollow">2.5 æå»ºMemory &amp; Microagent</a><ul><li><a href="#251-åå»º-memory" rel="noopener nofollow">2.5.1 åå»º Memory</a></li><li><a href="#252-åå»ºmicroagent" rel="noopener nofollow">2.5.2 åå»ºMicroagent</a></li></ul></li><li><a href="#26-åå»ºmcp" rel="noopener nofollow">2.6 åå»ºMCP</a></li><li><a href="#27-åå»ºcontroller" rel="noopener nofollow">2.7 åå»ºController</a></li><li><a href="#28-åéå¯å¨äºä»¶" rel="noopener nofollow">2.8 åéå¯å¨äºä»¶</a></li><li><a href="#29-è®¢éäºä»¶æµæ³¨åç¨æ·è¾å¥åè°å½æ°" rel="noopener nofollow">2.9 è®¢éäºä»¶æµï¼æ³¨åç¨æ·è¾å¥åè°å½æ°</a></li><li><a href="#210-è¿è¡ä»£ç" rel="noopener nofollow">2.10 è¿è¡ä»£ç</a></li><li><a href="#211-run_controllerå¨é¨ä»£ç " rel="noopener nofollow">2.11 run_controllerå¨é¨ä»£ç </a></li></ul></li><li><a href="#0xff-åè" rel="noopener nofollow">0xFF åè</a></li></ul></li></ul></div><p></p>
<h2 id="0x00-æ¦è¦">0x00 æ¦è¦</h2>
<p>å½åæä¸ä¸ªç³»ç»æ¶ï¼å¯å¨é¨ååç¨æ·å¸åä½¿ç¨åºæ¯æ¯æ¯è¾çæ³çåå¥ç¹ï¼å ä¸ºè¿ä¸¤ä¸ªé¨åå¯ä»¥è¦çç³»ç»å¤§é¨ååè½æ¨¡åï¼å¯ä»¥åæ­¤æ·±å¥æ¶æã</p>
<p>å ä¸ºæ¬ç³»ååé´çæç« è¿å¤ï¼å¯è½å¨åèæç®ä¸­æéæ¼çæç« ï¼å¦ææï¼è¿è¯·å¤§å®¶æåºã</p>
<h2 id="0x01-èæ¯">0x01 èæ¯</h2>
<h3 id="11-æ»ä½æ¶æ">1.1 æ»ä½æ¶æ</h3>
<p>ä»¥ä¸æ¯ OpenHands çæ¶æå¾ï¼è¿æ¯ä¸ä¸ªå¤æçç³»ç»ã</p>
<p><img alt="Openhands-arch" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1850883/202601/1850883-20260120222618900-20852596.jpg" class="lazyload"></p>
<p>æå¼å¤æçææ¯ç»èï¼OpenHands Agent çäº¤äºé»è¾å¯æç¼ä¸º âåå§å - äºä»¶æ³¨å¥ - ååå¤ç - ç­å¾â çæç®æµç¨ï¼æ ¸å¿å´ç» EventStream å®ç°æ¨¡åèå¨ï¼</p>
<ul>
<li>åå§åå°±ç»ªï¼ç¨æ·åå»ºä¼è¯æ¶ï¼ç³»ç»èªå¨å®æ AgentãAgentControllerãRuntimeãMemory ææ ¸å¿æ¨¡åçåå§åï¼ä¸æ¯ä¸ªæ¨¡åé½ä¼èªå¨è®¢é EventStreamï¼ç¡®ä¿è½æè·ç¸å³äºä»¶ï¼</li>
<li>ä»»å¡åèµ·ï¼ç¨æ·åéæ¶æ¯æ¬è´¨æ¯å EventStream ä¸­æ³¨å¥ä¸æ¡äºä»¶ï¼è¿æ¡äºä»¶ä¼è§¦åææè®¢éç¸å³åè°å½æ°çæ¨¡åï¼å¯å¨ååå¤çï¼</li>
<li>å¤æ¨¡åååååºï¼
<ul>
<li>Session æ¨¡åæç»­ä¸æ¥äºä»¶æµä¸­çåç±»ç¶æäºä»¶ï¼ä¿éå¨å±å¯è§æµï¼</li>
<li>è¥ç¨æ·å¼å¯ Security Analyzerï¼è¯¥æ¨¡åä¼éè¿å®å¨åæï¼èªå¨ç¡®è®¤ä½é£é©ä»»å¡ï¼åå°ç¨æ·æå¨å¹²é¢ï¼</li>
<li>AgentController åäºä»¶æµæ³¨å¥ RecallActionï¼Memory æ¨¡åå¤æ­æ¯å¦ä¸ºé¦æ¬¡æ¥æ¶çç¨æ·ä¿¡æ¯ï¼æ®æ­¤è¡¥åç¸å³è®°å¿å¹¶è¿å RecallObservation äºä»¶ï¼</li>
</ul>
</li>
<li>ç¶æåæ­¥ï¼AgentController æ´æ°ä»»å¡å½åç¶æï¼å¹¶å°ç¸å³ä¿¡æ¯ä¼ éç» Agentãå³AgentController è°ç¨ <code>Agent.step</code> æ¹æ³å¤çå½åäºä»¶ï¼çæ Action å¹¶æ³¨å¥äºä»¶æµã</li>
<li>è¡å¨å³ç­ï¼Agent åºäºæ¥æ¶çç¶æä¿¡æ¯ï¼å LLM åèµ·è¯·æ±ï¼çæä¸ä¸æ­¥å·ä½è¡å¨æ¹æ¡ï¼</li>
<li>è¡å¨è¾åºï¼Agent æç¡®è¾åºè¡å¨æä»¤ï¼å¯è½æ¯è¿è¡ç³»ç»å½ä»¤ãè¯»åæä»¶ãè°ç¨å·¥å·ç­å·ä½æä½ï¼</li>
<li>è¡å¨ååï¼è¯¥è¡å¨æä»¤éè¿ EventStream ä¼ éè³ Runtime ç»ä»¶ï¼ç­å¾æ§è¡ï¼</li>
<li>æ§è¡ä¸åé¦ï¼Runtime æ§è¡è¡å¨æä»¤ï¼çæåå«æ§è¡ç»æãéè¯¯ä¿¡æ¯ç­åå®¹çè§å¯ç»æï¼</li>
<li>ç»æåä¼ ï¼è§å¯ç»æéè¿ EventStream åä¼ ç» AgentControllerï¼å®æä¸æ¬¡æ§è¡é­ç¯ï¼</li>
<li>å¾ªç¯æç»æ­¢ï¼AgentController æ ¹æ®è§å¯ç»æå¤æ­ä»»å¡æ¯å¦å®æï¼è¥æªå®æåéå¤ä¸è¿°æµç¨ï¼è¥éååï¼åå§æ´¾ç»å¶ä» Agentï¼ç´è³ä»»å¡ç»æã</li>
</ul>
<h3 id="12-åå¥ç¹">1.2 åå¥ç¹</h3>
<p>ä»¥ä¸æ¯ä¸ä¸ªä¾å­ãæä»¬ç±æ­¤è¿å¥ï¼ççOpenHandså¦ä½å¯å¨ï¼ä¹å¯ä»¥ä»æ­¤å¤ççOpenHandsçåºæ¬é»è¾ã</p>
<pre><code class="language-python">config = load_openhands_config()
action = MessageAction(content="Write a hello world program")
state = await run_controller(config=config, initial_user_action=action)
</code></pre>
<p>ä¸è¿°ä»£ç æ¯ç´æ¥å½ä»¤è¡è°ç¨ run_controllerï¼å æ­¤æä»¬ä»run_controllerå¥æã</p>
<h2 id="0x02-åå§å--run_controller">0x02 åå§å @ run_controller</h2>
<p>run_controller ä½ä¸º OpenHands åç«¯åä¸ªä¼è¯çæ ¸å¿å¥å£åç¨ï¼æ ¸å¿èè´£æ¯ä¾æ®é¢è®¾éç½®å¯å¨è¿è¡æ¶ç¯å¢ãæºè½ä½åå¯¹åºæ§å¶å¨ï¼æ­å»ºèµ·ä»æ¥æ¶ç¨æ·æä»¤å°å¤æ­¥éª¤æ§è¡ä»»å¡ï¼åå°æç»å°ä¼è¯ç¶ææä¹åå­å¨çå®æ´å¤çé¾è·¯ãå¶æ ¸å¿è®¾è®¡äº®ç¹ä½ç°å¨ä¸æ¹é¢ï¼</p>
<ul>
<li>å®ç°ä¼è¯å¨çå½å¨æçä¸ä½åç®¡çï¼éä¸­å®æä¼è¯æ è¯ï¼SIDï¼çæãè¿è¡æ¶è¿æ¥å»ºç«ãä»£ç ä»åºåéãMCP å·¥å·åµå¥åä»»å¡æ§è¡è½¨è¿¹éæ¾ç­å³é®æä½ï¼</li>
<li>æå»ºåéå®å¨ç®¡æ§æºå¶ï¼éè¿è®¾ç½®æå¤§è¿­ä»£æ¬¡æ°ï¼max_iterationsï¼ä¸åä»»å¡æé«é¢ç®ï¼max_budget_per_taskï¼çç¡¬æ§éå¶ï¼ææè§é¿æ éå¾ªç¯æ§è¡ä¸èµæºè´¹ç¨è¶é¢çé£é©ï¼</li>
<li>å¼ºåå¨æµç¨å¯è§æµæ§ï¼åå© EventStream å®ç°äºä»¶å®æ¶ååï¼æ¯æå½ä»¤è¡çé¢ï¼CLIï¼ãåç«¯çé¢ãæ¥å¿ç³»ç»ç­å¤ç«¯åæ­¥è®¢éï¼åæ¶çæå¯åæ¾ãå¯å®¡è®¡ç JSON æ ¼å¼æ§è¡è½¨è¿¹ï¼ä¾¿äºåç»­è¿½æº¯ä¸æ ¸æ¥ã</li>
</ul>
<h3 id="21-æ»ä½æµç¨">2.1 æ»ä½æµç¨</h3>
<p>openhands\core\main.py ç run_controller çæ»ä½æµç¨å¦ä¸ã</p>
<ul>
<li>åå§åç³»ç»ç»ä»¶
<ul>
<li>åå»ºAgentã</li>
<li>åå»ºruntimeååå­ç³»ç»</li>
<li>åå»ºcontrollerã</li>
</ul>
</li>
<li>è¿è¡Agentï¼å·ä½ä¼:
<ul>
<li>ç®¡çä»»å¡æ§è¡æµç¨ã
<ul>
<li>æ¥æ¶åå§ç¨æ·æä½</li>
<li>å¤çäºä»¶æµä¸­çåç§äºä»¶ã</li>
<li>çå¬agentç¶æååï¼ç¹å«æ¯ç­å¾ç¨æ·è¾å¥çç¶æã</li>
</ul>
</li>
<li>å¤çç¨æ·äº¤äºã
<ul>
<li>å½agentéè¦ç¨æ·è¾å¥æ¶ï¼ä¾æ®éç½®è¿è¡èªå¨ååºæèç­å¾çå®ç¨æ·è¾å¥ã</li>
<li>æ¯æmockç¨æ·ååºå½æ°fake_user_response_fnï¼è¿æ ·å¯ä»¥èªå¨åæµè¯ã</li>
</ul>
</li>
<li>ç¶æç®¡çåæä¹åã
<ul>
<li>ä¿å­ä¼è¯ç¶æå°æä»¶ã</li>
<li>è®°å½æ§è¡è½¨è¿¹ï¼è¿æ ·å¯ä»¥åæè°è¯ã</li>
<li>æ¯æè½¨è¿¹éæ¾ã</li>
</ul>
</li>
<li>èµæºç®¡çã
<ul>
<li>ç®¡çMCPéæã</li>
<li>æ§å¶æ§è¡é¢ç®ï¼è¿­ä»£æ¬¡æ°åè´¹ç¨éå¶ï¼</li>
<li>æ­£ç¡®å³é­èµæºã</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>å·ä½æµç¨å¾å¦ä¸ã</p>
<p><img alt="OpenHands-3-1" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1850883/202601/1850883-20260120222632219-391345265.png" class="lazyload"></p>
<p>æä»¬æ¥ä¸æ¥ççå·ä½æµç¨ç»èã</p>
<h3 id="22-åå»ºæ³¨åä¸­å¿">2.2 åå»ºæ³¨åä¸­å¿</h3>
<p>ä¸é¢è¯­å¥ä¼åå»º LLM æ³¨åä¸­å¿ &amp; å¯¹è¯ç»è®¡å®ä¾ã</p>
<pre><code class="language-python">    sid = sid or generate_sid(config)

    llm_registry, conversation_stats, config = create_registry_and_conversation_stats(
        config,
        sid,
        None,
    )
</code></pre>
<p>å·ä½ä»£ç å¦ä¸ï¼å¶åè½æ¯:</p>
<ol>
<li>æ ¹æ®ç¨æ·è®¾ç½®è°æ´åºç¡éç½®</li>
<li>åå§åLLMæ³¨åè¡¨ï¼ç®¡çææLLMå®ä¾ï¼</li>
<li>åå§åæä»¶å­å¨åå¯¹è¯ç»è®¡å¨ï¼è·è¸ªå¯¹è¯æ°æ®ï¼</li>
<li>å»ºç«æ³¨åè¡¨ä¸ç»è®¡å¨çè®¢éå³ç³»</li>
</ol>
<pre><code class="language-python">def create_registry_and_conversation_stats(
    config: OpenHandsConfig,
    sid: str,
    user_id: Optional[str],
    user_settings: Optional[Settings] = None,
) -&gt; tuple[LLMRegistry, ConversationStats, OpenHandsConfig]:
    """
    åå»ºLLMæ³¨åè¡¨ãå¯¹è¯ç»è®¡å®ä¾åç¨æ·éç½®çç»åå½æ°ã
    
    åæ°ï¼
        config: åºç¡éç½®å¯¹è±¡
        sid: ä¼è¯IDï¼ç¨äºæ è¯å½åå¯¹è¯ï¼
        user_id: ç¨æ·IDï¼å¯éï¼ç¨äºç¨æ·çº§æ°æ®è·è¸ªï¼
        user_settings: ç¨æ·èªå®ä¹è®¾ç½®ï¼å¯éï¼ç¨äºè¦çé»è®¤éç½®ï¼
    
    è¿åï¼
        ä¸åç» (LLMæ³¨åè¡¨, å¯¹è¯ç»è®¡å®ä¾, æç»ç¨æ·éç½®)
    """
    # åå§åç¨æ·éç½®ï¼ä¼åä½¿ç¨ç¨æ·è®¾ç½®è¦çé»è®¤éç½®ï¼
    user_config = config
    if user_settings:
        user_config = setup_llm_config(config, user_settings)

    # ç¡®å®ä»£çç±»åï¼ä»ç¨æ·è®¾ç½®æé»è®¤éç½®ä¸­è·åï¼
    agent_cls = user_settings.agent if user_settings else None
    # åå»ºLLMæ³¨åè¡¨ï¼å³èéç½®åä»£çç±»å
    llm_registry = LLMRegistry(user_config, agent_cls)
    
    # åå§åæä»¶å­å¨ï¼ç¨äºæä¹åå¯¹è¯æ°æ®ï¼
    file_store = get_file_store(
        file_store_type=config.file_store,
        file_store_path=config.file_store_path,
        file_store_web_hook_url=config.file_store_web_hook_url,
        file_store_web_hook_headers=config.file_store_web_hook_headers,
        file_store_web_hook_batch=config.file_store_web_hook_batch,
    )
    
    # åå»ºå¯¹è¯ç»è®¡å®ä¾ï¼ç»å®æä»¶å­å¨ãä¼è¯IDåç¨æ·IDï¼
    conversation_stats = ConversationStats(file_store, sid, user_id)
    # è®¢éæ³¨åè¡¨äºä»¶ï¼å½æ°LLMæ³¨åæ¶ï¼èªå¨è®°å½å°å¯¹è¯ç»è®¡ä¸­
    llm_registry.subscribe(conversation_stats.register_llm)
    
    return llm_registry, conversation_stats, user_config
</code></pre>
<h3 id="23-åå»ºagent">2.3 åå»ºAgent</h3>
<p>æ­¤å¤ä¼æ ¹æ®configä¿¡æ¯æ¥åå»ºagentã</p>
<pre><code class="language-python">agent = create_agent(config, llm_registry)
</code></pre>
<p>create_agentä»£ç å¦ä¸ï¼ä»ç¼ºçéç½®å¯ä»¥çå°ï¼é»è®¤çæCodeActAgentã</p>
<pre><code class="language-python">#default_agent = "CodeActAgent"

def create_agent(config: OpenHandsConfig, llm_registry: LLMRegistry) -&gt; Agent:
    agent_cls: type[Agent] = Agent.get_cls(config.default_agent)
    agent_config = config.get_agent_config(config.default_agent)
    # Pass the runtime information from the main config to the agent config
    agent_config.runtime = config.runtime
    config.get_llm_config_from_agent(config.default_agent)
    agent = agent_cls(config=agent_config, llm_registry=llm_registry)
    return agent
</code></pre>
<p>CodeActAgent å®ä¹å¦ä¸ã</p>
<pre><code class="language-python">class CodeActAgent(Agent):
    """
    CodeActAgentï¼æç®ä¸»ä¹çæºè½ä»£çï¼åºäº CodeAct çå¿µå®ç°ã
    æ ¸å¿é»è¾ï¼å°æ¨¡åçè¡å¨ç»ä¸å°âä»£ç æ§è¡âè¿ä¸åä¸è¡å¨ç©ºé´ï¼éè¿ä¼ éâè¡å¨-è§å¯âå¯¹åè¡¨ï¼
    å¼å¯¼æ¨¡åå³ç­ä¸ä¸æ­¥æä½ï¼å¼é¡¾ç®æ´æ§ä¸æ§è¡æ§è½ã

    æ ¸å¿çå¿µï¼æºèªè®ºæï¼https://arxiv.org/abs/2402.01030ï¼ï¼
    æç ´ä¼ ç»ä»£çå¤è¡å¨ç±»åçå¤æè®¾è®¡ï¼ç¨ä»£ç æ§è¡ç»ä¸ææè¡å¨ï¼æ¢ç®åæ¶æåæåæçã

    æ¯ä¸è½®äº¤äºä¸­ï¼ä»£çå¯æ§è¡ä¸¤ç§æä½ï¼
    1. **å¯¹è¯ï¼Converseï¼**ï¼ç¨èªç¶è¯­è¨ä¸äººç±»æ²éï¼ä¾å¦è¯·æ±æ¾æ¸éæ±ãç¡®è®¤æä½ç­ã
    2. **ä»£ç è¡å¨ï¼CodeActï¼**ï¼éè¿æ§è¡ä»£ç å®æä»»å¡ï¼æ¯æä¸¤ç§å½¢å¼ï¼
       - æ§è¡ä»»æææç Linux bash å½ä»¤
       - æ§è¡ä»»æææç Python ä»£ç ï¼éè¿äº¤äºå¼ IPython è§£éå¨æ¨¡æï¼
         å®ééè¿ bash å½ä»¤å®ç°ï¼è¯¦è§æä»¶ç³»ç»è¯´æï¼
    """
    VERSION = '2.2'  # ä»£ççæ¬å·

    # æ²çç¯å¢æéæä»¶ä¾èµï¼æåå§åé¡ºåºæåï¼
    sandbox_plugins: list[PluginRequirement] = [
        # æ³¨æï¼AgentSkillsRequirement éå¨ JupyterRequirement ä¹ååå§å
        # åå ï¼AgentSkillsRequirement æä¾å¤§é Python å·¥å·å½æ°ï¼
        # Jupyter ç¯å¢éè¦ä¾èµè¿äºå½æ°æè½æ­£å¸¸å·¥ä½
        AgentSkillsRequirement(),  # æä¾ä»£çæ ¸å¿æè½å½æ°çæä»¶
        JupyterRequirement(),      # æä¾äº¤äºå¼ Python æ§è¡ç¯å¢çæä»¶
    ]

    def __init__(self, config: AgentConfig, llm_registry: LLMRegistry) -&gt; None:
        """
        åå§å CodeActAgent å®ä¾ã

        åæ°ï¼
            config (AgentConfig)ï¼å½åä»£ççéç½®å¯¹è±¡ï¼åå«æ¨¡åè·¯ç±ãè®°å¿ç­ç¥ç­ï¼
            llm_registry (LLMRegistry)ï¼LLM æ³¨åè¡¨å®ä¾ï¼ç¨äºè·åæé LLM æè·¯ç± LLM
        """
        # è°ç¨ç¶ç±» Agent çåå§åæ¹æ³ï¼å®æåºç¡éç½®ï¼å¦ LLM æ³¨åãæç¤ºè¯ç®¡çå¨åå§åï¼
        super().__init__(config, llm_registry)
        
        self.pending_actions: deque['Action'] = deque()  # å¾æ§è¡çè¡å¨éåï¼åç«¯éåï¼æ¯æé«æè¿åºï¼
        self.reset()  # éç½®ä»£çç¶æï¼åå§åè¡å¨åå²ãè§å¯è®°å½ç­ï¼
        self.tools = self._get_tools()  # è·åä»£çå¯ä½¿ç¨çå·¥å·éï¼ä»æä»¶æéç½®ä¸­æåï¼

        # åå§åå¯¹è¯è®°å¿å®ä¾ï¼å­å¨âè¡å¨-è§å¯âå¯¹ï¼æ¯æè®°å¿åç¼©ãä¸ä¸æç®¡ç
        self.conversation_memory = ConversationMemory(self.config, self.prompt_manager)

        # åå§åä¸ä¸æåç¼©å¨ï¼æ ¹æ®éç½®åå»º Condenser å®ä¾ï¼ç¨äºåç¼©é¿å¯¹è¯åå²
        self.condenser = Condenser.from_config(self.config.condenser, llm_registry)

        # è¦çç¶ç±»ç LLM å®ä¾ï¼å¦éæ¨¡åè·¯ç±ï¼ä¼åä½¿ç¨è·¯ç± LLMï¼æ ¹æ®ä»£çéç½®å¨æéæ©æ¨¡åï¼
        self.llm = self.llm_registry.get_router(self.config)
</code></pre>
<p>å·ä½åè§ä¸å¾ã</p>
<p><img alt="image-20251019171311325" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1850883/202601/1850883-20260120222810318-1947134421.png" class="lazyload"></p>
<p>CodeActAgentçåå§åæµç¨å¾å¦ä¸ã</p>
<p><img alt="Openhands-3-2" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1850883/202601/1850883-20260120222644578-440191047.png" class="lazyload"></p>
<h3 id="24-æå»ºruntime">2.4 æå»ºRuntime</h3>
<p>create_runtime()æå»ºäºAI ä»£çç âä¸å±å·¥ä½é´âRuntimeãå¨OpenHandsç³»ç»ä¸­ï¼Runtimeæ®æ¼çè³å³éè¦çè§è²ï¼å®ä¸ºäººå·¥æºè½ä»£çæä¾äºä¸ä¸ªç¨³å®ä¸å¯æ§çæä½å¹³å°ã</p>
<pre><code class="language-python">    # è¿è¡æ¶åå»ºåä¼èªå¨è¿æ¥å¹¶åééå®çä»£ç ä»åº
    repo_directory = None
    if runtime is None:
        # åå§åä»£ç ä»åºï¼å¦éï¼
        repo_tokens = get_provider_tokens()
        # åå»ºè¿è¡æ¶å®ä¾
        runtime = create_runtime(
            config,
            llm_registry,
            sid=sid,
            headless_mode=headless_mode,
            agent=agent,
            git_provider_tokens=repo_tokens,
        )
        # åæ­¥è°ç¨å¼æ­¥çè¿è¡æ¶è¿æ¥æ¹æ³
        call_async_from_sync(runtime.connect)

        # åå§åä»£ç ä»åºï¼å¦éï¼
        if config.sandbox.selected_repo:
            repo_directory = initialize_repository_for_runtime(
                runtime,
                immutable_provider_tokens=repo_tokens,
                selected_repository=config.sandbox.selected_repo,
            )
            
    # event_stream æ¯  event_stream = EventStream(session_id, file_store)        
    event_stream = runtime.event_stream        
</code></pre>
<p>Runtime ç<code>__init__</code>ä¼æ³¨åEventStreamSubscriber.RUNTIMEã</p>
<pre><code class="language-python">        self.event_stream = event_stream
        if event_stream:
            event_stream.subscribe(
                EventStreamSubscriber.RUNTIME, self.on_event, self.sid
            )
</code></pre>
<p><code>Runtime</code>åªå¤çå¯è¿è¡ç<code>Action</code>äºä»¶ï¼æ§è¡å¨ä½æ¿å°è¾åº<code>Observation</code>åéåäºä»¶æµä¸­</p>
<ul>
<li><code>isinstance(event, MCPAction)</code>æ§è¡MCPè·åç»æ</li>
</ul>
<ul>
<li>å¶ä»runtimeæ¯æçactionåæ§è¡è·åç»æ</li>
</ul>
<h3 id="25-æå»ºmemory--microagent">2.5 æå»ºMemory &amp; Microagent</h3>
<p>æ¥ä¸æ¥åå§åmemoryï¼</p>
<pre><code class="language-python">    # when memory is created, it will load the microagents from the selected repository
    if memory is None:
        memory = create_memory(
            runtime=runtime,
            event_stream=event_stream,
            sid=sid,
            selected_repository=config.sandbox.selected_repo,
            repo_directory=repo_directory,
            conversation_instructions=conversation_instructions,
            working_dir=str(runtime.workspace_root),
        )

</code></pre>
<h4 id="251-åå»º-memory">2.5.1 åå»º Memory</h4>
<p>create_memory å½æ°ä¼åå»ºmemoryã</p>
<pre><code class="language-python">def create_memory(
    runtime: Runtime,
    event_stream: EventStream,
    sid: str,
    selected_repository: str | None = None,
    repo_directory: str | None = None,
    status_callback: Callable | None = None,
    conversation_instructions: str | None = None,
    working_dir: str = DEFAULT_WORKSPACE_MOUNT_PATH_IN_SANDBOX,
) -&gt; Memory:
    """Create a memory for the agent to use.

    Args:
        runtime: The runtime to use.
        event_stream: The event stream it will subscribe to.
        sid: The session id.
        selected_repository: The repository to clone and start with, if any.
        repo_directory: The repository directory, if any.
        status_callback: Optional callback function to handle status updates.
        conversation_instructions: Optional instructions that are passed to the agent
    """
    memory = Memory(
        event_stream=event_stream,
        sid=sid,
        status_callback=status_callback,
    )

    memory.set_conversation_instructions(conversation_instructions)

    if runtime:
        # sets available hosts
        memory.set_runtime_info(runtime, {}, working_dir)

        # loads microagents from repo/.openhands/microagents
        microagents: list[BaseMicroagent] = runtime.get_microagents_from_selected_repo(
            selected_repository
        )
        memory.load_user_workspace_microagents(microagents)

        if selected_repository and repo_directory:
            memory.set_repository_info(selected_repository, repo_directory)

    return memory


</code></pre>
<p>memoryåå§åçæ¶åæä¸ä¸ªevent_streamçè®¢éï¼ä¼æ³¨å EventStreamSubscriber.MEMORYï¼å½æeventçæ¶åMemory ç<code>on_event</code>æ¹æ³ä¼è¢«è°ç¨ã</p>
<pre><code class="language-python">self.event_stream.subscribe(
            EventStreamSubscriber.MEMORY,
            self.on_event,
            self.sid,
        )


</code></pre>
<p><code>Memory</code>åªå¤ç<code>RecallAction</code>ï¼å¯¹äºç¨æ·é¦æ¬¡è¾å¥ä¿¡æ¯åå°ä¸äºé¢å¤çå·¥ä½ç©ºé´ä¸ä¸æä¿¡æ¯æ·»å å°<code>RecallObservation</code>åéåäºä»¶æµä¸­ï¼å¯¹äºå¶ä»éç¨æ·é¦æ¬¡çè¾å¥ä¿¡æ¯åå å¥<code>microagent knowledge(é¢åå¼ºåæç¤ºè¯)</code>å°<code>RecallObservation</code>åéåäºä»¶æµä¸­ã</p>
<h4 id="252-åå»ºmicroagent">2.5.2 åå»ºMicroagent</h4>
<p>create_memoryå½æ°ä¸­ä¼å è½½Microagentã</p>
<pre><code class="language-python">        # loads microagents from repo/.openhands/microagents
        microagents: list[BaseMicroagent] = runtime.get_microagents_from_selected_repo(
            selected_repository
        )
        memory.load_user_workspace_microagents(microagents)

</code></pre>
<p>Microagentæ¯ä¸»ä»£ççâä¸ä¸åä½ä¼ä¼´âã</p>
<p>ä¸ºäºé«æå®æå¤æä»»å¡ï¼éå¸¸éè¦ä¸ä¸çåå·¥åä½ï¼Microagentæ­£æ¯ä¸ºäºè¿ä¸ç®çèè®¾è®¡çâä¸ä¸æ§è¡èâãå½ä¸»ä»£çå¨æ§è¡ä»»å¡æ¶éå°ç¹å®é¢åçç»åå·¥ä½ï¼å®ä¸å¿äº²èªå¤çï¼èæ¯å¯ä»¥å°è¿é¨åä»»å¡âå§æâç»ç¸åºçMicroagentï¼ä»èå©ç¨å¶ä¸ä¸è½åæé«æçååç¡®æ§ã</p>
<p>ä»æ¬è´¨ä¸è®²ï¼Microagentåæ ·åºäºå¤§åè¯­è¨æ¨¡åæå»ºï¼æ¯å¦ï¼å¶ç¬ç¹ä¹å¤å¯ä»¥æ¯å¶åç½®çä¸ä¸æç¤ºè¯ï¼Promptï¼ãè¿äºæç¤ºè¯ä¸­èå¥äºç¹å®é¢åçç¥è¯ååä¸æä½è§èï¼ä¾å¦ï¼ä¸Gitç¸å³çMicroagentï¼å¶æç¤ºè¯ä¼åå«Gitæä½çæ ¸å¿æå·§ä¸æä½³å®è·µï¼è½å¤å¼å¯¼æ¨¡åæ´ç²¾ç¡®å°å¤çä¸Gitç¸å³çä»»å¡ï¼æä¸ºä¸»ä»£çåºå¯¹ç»ååºæ¯çâå¾åå©æâã</p>
<p>BaseMicroagent å®ä¹å¦ä¸ï¼</p>
<pre><code class="language-python">class BaseMicroagent(BaseModel):
    """Base class for all microagents."""

    name: str
    content: str
    metadata: MicroagentMetadata
    source: str  # path to the file
    type: MicroagentType

    PATH_TO_THIRD_PARTY_MICROAGENT_NAME: ClassVar[dict[str, str]] = {
        '.cursorrules': 'cursorrules',
        'agents.md': 'agents',
        'agent.md': 'agents',
    }

</code></pre>
<h3 id="26-åå»ºmcp">2.6 åå»ºMCP</h3>
<p>æ¥ä¸æ¥ä¼åå»ºMCPç¸å³é¨åã</p>
<pre><code class="language-python">    # Add MCP tools to the agent
    if agent.config.enable_mcp:
        # Add OpenHands' MCP server by default
        _, openhands_mcp_stdio_servers = (
            OpenHandsMCPConfigImpl.create_default_mcp_server_config(
                config.mcp_host, config, None
            )
        )
        runtime.config.mcp.stdio_servers.extend(openhands_mcp_stdio_servers)

        await add_mcp_tools_to_agent(agent, runtime, memory)

</code></pre>
<h3 id="27-åå»ºcontroller">2.7 åå»ºController</h3>
<p>æ¥ä¸æ¥ä¼åå»ºAgentControllerã</p>
<p>AgentController æ¯ OpenHands ç³»ç»ä¸­çæ ¸å¿æ§å¶å¨ç»ä»¶ï¼è´è´£ç®¡çä»£çï¼Agentï¼çæ´ä¸ªçå½å¨æåè¡ä¸ºãæ¯ä»£çä¸ç³»ç»å¶ä»ç»ä»¶ä¹é´çæ¡¥æ¢ï¼ç¡®ä¿ä»£çå¯ä»¥å®å¨ææå°æ§è¡ä»»å¡ï¼åæ¶ç®¡çç³»ç»èµæºã</p>
<p><code>AgentController</code>ä½ä¸ºä¸»è¦ç¶æç®¡çæ¨¡åï¼</p>
<ul>
<li>æ ¹æ®<code>Observation</code>äºä»¶è¿è¡ç¶æåæ¢</li>
<li>æ ¹æ®<code>Action</code>è¿è¡ç¶æåæ¢åä»¥ä¸å¤çï¼
<ul>
<li>å¯¹äº<code>MessageAction</code>åé<code>RecallAction</code>å°äºä»¶æµä¸­</li>
<li>å¯¹äº<code>AgentDelegateAction</code>åAgentè·¯ç±ï¼åç»­æºå¶è§£è¯»ä¸­åè¯¦ç»ä»ç»ï¼</li>
</ul>
</li>
<li>æ ¹æ®å½åç<code>event</code>å¤æ­è¿è¡è°ç¨<code>agent.step</code></li>
</ul>
<pre><code class="language-python">    controller, initial_state = create_controller(
        agent, runtime, config, conversation_stats, replay_events=replay_events
    )

</code></pre>
<p>create_controllerä»£ç å¦ä¸ã</p>
<pre><code class="language-python">def create_controller(
    agent: Agent,
    runtime: Runtime,
    config: OpenHandsConfig,
    conversation_stats: ConversationStats,
    headless_mode: bool = True,
    replay_events: list[Event] | None = None,
) -&gt; tuple[AgentController, State | None]:
    event_stream = runtime.event_stream
    initial_state = None
    initial_state = State.restore_from_session(
            event_stream.sid, event_stream.file_store)
    controller = AgentController(
        agent=agent,
        conversation_stats=conversation_stats,
        iteration_delta=config.max_iterations,
        budget_per_task_delta=config.max_budget_per_task,
        agent_to_llm_config=config.get_agent_to_llm_config_map(),
        event_stream=event_stream,
        initial_state=initial_state,
        headless_mode=headless_mode,
        confirmation_mode=config.security.confirmation_mode,
        replay_events=replay_events,
        security_analyzer=runtime.security_analyzer,
    )
    return (controller, initial_state)


</code></pre>
<p>å¨ AgentController ç<code>__init__</code>ä¸­ï¼ä¼æ³¨åEventStreamSubscriber.AGENT_CONTROLLERã</p>
<pre><code class="language-python">        # subscribe to the event stream if this is not a delegate
        if not self.is_delegate:
            self.event_stream.subscribe(
                EventStreamSubscriber.AGENT_CONTROLLER, self.on_event, self.id
            )

</code></pre>
<h3 id="28-åéå¯å¨äºä»¶">2.8 åéå¯å¨äºä»¶</h3>
<p>åéä¸ä¸ªå¯å¨äºä»¶MessageActionã</p>
<pre><code class="language-python">    # start event is a MessageAction with the task, either resumed or new
    if initial_state is not None and initial_state.last_error:
        # we're resuming the previous session
        event_stream.add_event(
            MessageAction(
                content=(
                    "Let's get back on track. If you experienced errors before, do "
                    'NOT resume your task. Ask me about it.'
                ),
            ),
            EventSource.USER,
        )
    else:
        # init with the provided actions
        event_stream.add_event(initial_user_action, EventSource.USER)

</code></pre>
<h3 id="29-è®¢éäºä»¶æµæ³¨åç¨æ·è¾å¥åè°å½æ°">2.9 è®¢éäºä»¶æµï¼æ³¨åç¨æ·è¾å¥åè°å½æ°</h3>
<p>æèªå·±æ³¨åä¸º EventStreamSubscriber.MAINã</p>
<pre><code class="language-python">    def on_event(event: Event) -&gt; None:
        if isinstance(event, AgentStateChangedObservation):
            if event.agent_state == AgentState.AWAITING_USER_INPUT:
                if exit_on_message:
                    message = '/exit'
                elif fake_user_response_fn is None:
                    message = read_input(config.cli_multiline_input)
                else:
                    message = fake_user_response_fn(controller.get_state())
                action = MessageAction(content=message)
                event_stream.add_event(action, EventSource.USER)

    event_stream.subscribe(EventStreamSubscriber.MAIN, on_event, sid)

    end_states = [
        AgentState.FINISHED,
        AgentState.REJECTED,
        AgentState.ERROR,
        AgentState.PAUSED,
        AgentState.STOPPED,
    ]

</code></pre>
<p>å ä¸ªæ¨¡åçåå§åèå¼åºæ¬ä¸è´ï¼å¨<code>__init__</code>å½æ°ä¸­å®ææ¨¡åçåå§ååå¤å·¥ä½ï¼å¹¶ä¸åäºä»¶æµä¸­è®¢éæ¶æ¯å¹¶æ³¨ååèªæ¨¡åçæ¶æ¯å¤çå½æ°ãäºä»¶åè°å½æ°ä¼æ ¹æ®å½åçäºä»¶è¿è¡ç¶ææºçç¶æè½¬ç§»ã</p>
<ul>
<li>Runtime å¨äºä»¶æµä¸­è®¢é EventStreamSubscriber.RUNTIMEï¼äºä»¶åè°å½æ°ä¼å¤çéè¦runtineå¤ççactionï¼æ¯å¦mcp/toolç­ç­ã</li>
<li>Memory å¨äºä»¶æµä¸­è®¢é EventStreamSubscriber.MEMORYãäºä»¶åè°å½æ°æ ¹æ®å½åç<code>event</code>çæä¸ä¸ªå¸¦<code>microagent_knowledge</code>ç<code>Observation</code>å¹¶ä»¥<code>ENVIRONMENT</code>ä½ä¸ºæºæ·»å åäºä»¶æµä¸­ï¼è¿éç<code>microagent_knowledge</code>æ¯ä¸ç§ç¹å®æç¤ºè¯å¢å¼ºçæ¹æ³ã</li>
<li>AgentController å¨äºä»¶æµä¸­è®¢é EventStreamSubscriber.AGENT_CONTROLLERã</li>
<li>run_controller å¨äºä»¶æµä¸­è®¢é EventStreamSubscriber.MAINã</li>
</ul>
<h3 id="210-è¿è¡ä»£ç">2.10 è¿è¡ä»£ç</h3>
<p>è¿è¡ä»£çç´å°è¿å¥ç»æç¶æã</p>
<pre><code class="language-python">    try:
        await run_agent_until_done(controller, runtime, memory, end_states)
    except Exception as e:
        logger.error(f'Exception in main loop: {e}')

    # save session when we're about to close
    if config.file_store is not None and config.file_store != 'memory':
        end_state = controller.get_state()
        # NOTE: the saved state does not include delegates events
        end_state.save_to_session(
            event_stream.sid, event_stream.file_store, event_stream.user_id
        )

    await controller.close(set_stop_state=False)

</code></pre>
<h3 id="211-run_controllerå¨é¨ä»£ç ">2.11 run_controllerå¨é¨ä»£ç </h3>
<p>run_controllerå¨é¨ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-python">async def run_controller(
    config: OpenHandsConfig,
    initial_user_action: Action,
    sid: str | None = None,
    runtime: Runtime | None = None,
    exit_on_message: bool = False,
    fake_user_response_fn: FakeUserResponseFunc | None = None,
    headless_mode: bool = True,
    memory: Memory | None = None,
    conversation_instructions: str | None = None,
) -&gt; State | None:
    """ä¸»åç¨ï¼ç¨äºè¿è¡ä»£çæ§å¶å¨ï¼æ¯æçµæ´»çä»»å¡è¾å¥ã
    ä»å¨éè¿å½ä»¤è¡ç´æ¥å¯å¨ OpenHands åç«¯æ¶ä½¿ç¨ã

    åæ°:
        config: åºç¨éç½®å®ä¾
        initial_user_action: åå«åå§ç¨æ·è¾å¥ç Action å¯¹è±¡
        sid: (å¯é) ä¼è¯ IDãéè¦æç¤ºï¼éå¿è¦è¯·å¿æå¨è®¾ç½®ï¼
             éè¯¯è®¾ç½®å¯è½å¯¼è´ RemoteRuntime åºç°å¼å¸¸è¡ä¸º
        runtime: (å¯é) ä»£çè¿è¡çè¿è¡æ¶ç¯å¢å®ä¾
        exit_on_message: å½ä»£çè¯·æ±ç¨æ·æ¶æ¯æ¶éåºï¼å¯éï¼
        fake_user_response_fn: (å¯é) æ¥æ¶å½åç¶æå¹¶è¿åæ¨¡æç¨æ·ååºçå½æ°
        headless_mode: ä»£çæ¯å¦ä»¥æ å¤´æ¨¡å¼è¿è¡

    è¿å:
        ä»£ççæç»ç¶æï¼è¥åçéè¯¯åè¿å None

    å¼å¸¸:
        AssertionError: è¥ initial_user_action ä¸æ¯ Action å®ä¾
        Exception: æ§è¡è¿ç¨ä¸­å¯è½æåºåç±»å¼å¸¸ï¼åä¼è¢«è®°å½æ¥å¿

    æ³¨æ:
        - ç¶ææä¹åï¼è¥éç½®äº config.file_storeï¼ä»£çç¶æå°å¨ä¼è¯é´ä¿å­
        - æ§è¡è½¨è¿¹ï¼è¥éç½®äº config.trajectories_pathï¼æ§è¡åå²å°ä»¥ JSON æ ¼å¼ä¿å­ç¨äºåæ
        - é¢ç®æ§å¶ï¼æ§è¡å config.max_iterations å config.max_budget_per_task éå¶

    ç¤ºä¾:
        &gt;&gt;&gt; config = load_openhands_config()
        &gt;&gt;&gt; action = MessageAction(content="Write a hello world program")
        &gt;&gt;&gt; state = await run_controller(config=config, initial_user_action=action)
    """
    # è¥æªæä¾ä¼è¯IDï¼åçæä¸ä¸ª
    sid = sid or generate_sid(config)

    # åå»º LLM æ³¨åä¸­å¿ãå¯¹è¯ç»è®¡å®ä¾ï¼å¹¶å¤çéç½®
    llm_registry, conversation_stats, config = create_registry_and_conversation_stats(
        config,
        sid,
        None,
    )

    # åºäºéç½®å LLM æ³¨åä¸­å¿åå»ºä»£çå®ä¾
    agent = create_agent(config, llm_registry)

    # è¿è¡æ¶åå»ºåä¼èªå¨è¿æ¥å¹¶åééå®çä»£ç ä»åº
    repo_directory = None
    if runtime is None:
        # åå§åä»£ç ä»åºï¼å¦éï¼
        repo_tokens = get_provider_tokens()
        # åå»ºè¿è¡æ¶å®ä¾
        runtime = create_runtime(
            config,
            llm_registry,
            sid=sid,
            headless_mode=headless_mode,
            agent=agent,
            git_provider_tokens=repo_tokens,
        )
        # åæ­¥è°ç¨å¼æ­¥çè¿è¡æ¶è¿æ¥æ¹æ³
        call_async_from_sync(runtime.connect)

        # åå§åä»£ç ä»åºï¼å¦éï¼
        if config.sandbox.selected_repo:
            repo_directory = initialize_repository_for_runtime(
                runtime,
                immutable_provider_tokens=repo_tokens,
                selected_repository=config.sandbox.selected_repo,
            )

    # ä»è¿è¡æ¶è·åäºä»¶æµå®ä¾ï¼ç»ä»¶é´éä¿¡æ ¸å¿ï¼
    event_stream = runtime.event_stream

    # è®°å¿ç³»ç»åå»ºåä¼ä»éå®ä»åºå è½½å¾®ä»£ç
    if memory is None:
        # åå»ºè®°å¿ç³»ç»å®ä¾
        memory = create_memory(
            runtime=runtime,
            event_stream=event_stream,
            sid=sid,
            selected_repository=config.sandbox.selected_repo,
            repo_directory=repo_directory,
            conversation_instructions=conversation_instructions,
            working_dir=str(runtime.workspace_root),
        )

    # ä¸ºä»£çæ·»å  MCP å·¥å·ï¼è¥å¯ç¨ï¼
    if agent.config.enable_mcp:
        # é»è®¤æ·»å  OpenHands ç MCP æå¡å¨éç½®
        _, openhands_mcp_stdio_servers = (
            OpenHandsMCPConfigImpl.create_default_mcp_server_config(
                config.mcp_host, config, None
            )
        )
        runtime.config.mcp.stdio_servers.extend(openhands_mcp_stdio_servers)

        # å¼æ­¥å° MCP å·¥å·æ·»å å°ä»£ç
        await add_mcp_tools_to_agent(agent, runtime, memory)

    # å è½½åæ¾äºä»¶ï¼è¥å¯ç¨è½¨è¿¹åæ¾ï¼
    replay_events: list[Event] | None = None
    if config.replay_trajectory_path:
        logger.info('Trajectory replay is enabled')
        # æ­è¨åå§ç¨æ·å¨ä½å¿é¡»æ¯ç©ºå¨ä½ï¼åæ¾åºæ¯ï¼
        assert isinstance(initial_user_action, NullAction)
        # ä»æå®è·¯å¾å è½½åæ¾æ¥å¿ååå§ç¨æ·å¨ä½
        replay_events, initial_user_action = load_replay_log(
            config.replay_trajectory_path
        )

    # åå»ºæ§å¶å¨ååå§ç¶æ
    controller, initial_state = create_controller(
        agent, runtime, config, conversation_stats, replay_events=replay_events
    )

    # æ­è¨åå§ç¨æ·å¨ä½å¿é¡»æ¯ Action å®ä¾ï¼å¦åæåºå¼å¸¸
    assert isinstance(initial_user_action, Action), (
        f'initial user actions must be an Action, got {type(initial_user_action)}'
    )
    # è®°å½è°è¯æ¥å¿ï¼æ§å¶å¨åå§åä¿¡æ¯
    logger.debug(
        f'Agent Controller Initialized: Running agent {agent.name}, model '
        f'{agent.llm.config.model}, with actions: {initial_user_action}'
    )

    # åéå¯å¨äºä»¶ï¼æ¢å¤ä¼è¯ææ°ä¼è¯ï¼
    if initial_state is not None and initial_state.last_error:
        # æ¢å¤ä¹åçä¼è¯ï¼å­å¨åå²éè¯¯ï¼
        event_stream.add_event(
            MessageAction(
                content=(
                    "Let's get back on track. If you experienced errors before, do "
                    'NOT resume your task. Ask me about it.'
                ),
            ),
            EventSource.USER,
        )
    else:
        # æ°ä¼è¯ï¼æ·»å åå§ç¨æ·å¨ä½å°äºä»¶æµ
        event_stream.add_event(initial_user_action, EventSource.USER)

    # å®ä¹äºä»¶åè°å½æ°ï¼å¤çä»£çç­å¾ç¨æ·è¾å¥çåºæ¯
    def on_event(event: Event) -&gt; None:
        # çå¬ä»£çç¶æåæ´äºä»¶
        if isinstance(event, AgentStateChangedObservation):
            # å½ä»£çè¿å¥ç­å¾ç¨æ·è¾å¥ç¶ææ¶
            if event.agent_state == AgentState.AWAITING_USER_INPUT:
                if exit_on_message:
                    # ééåºæ¶åé /exit æä»¤
                    message = '/exit'
                elif fake_user_response_fn is None:
                    # è¯»åçå®ç¨æ·è¾å¥
                    message = read_input(config.cli_multiline_input)
                else:
                    # è°ç¨æ¨¡æç¨æ·ååºå½æ°
                    message = fake_user_response_fn(controller.get_state())
                # åå»ºæ¶æ¯å¨ä½å¹¶æ·»å å°äºä»¶æµ
                action = MessageAction(content=message)
                event_stream.add_event(action, EventSource.USER)

    # è®¢éäºä»¶æµï¼æ³¨å MAIN è®¢éèååè°å½æ°
    event_stream.subscribe(EventStreamSubscriber.MAIN, on_event, sid)

    # å®ä¹ä»£çç»æç¶æåè¡¨
    end_states = [
        AgentState.FINISHED,
        AgentState.REJECTED,
        AgentState.ERROR,
        AgentState.PAUSED,
        AgentState.STOPPED,
    ]

    try:
        # è¿è¡ä»£çç´å°è¿å¥ç»æç¶æ
        await run_agent_until_done(controller, runtime, memory, end_states)
    except Exception as e:
        # è®°å½ä¸»å¾ªç¯å¼å¸¸æ¥å¿
        logger.error(f'Exception in main loop: {e}')

    # å³é­åä¿å­ä¼è¯ï¼è¥éç½®æä»¶å­å¨ï¼
    if config.file_store is not None and config.file_store != 'memory':
        end_state = controller.get_state()
        # æ³¨æï¼ä¿å­çç¶æä¸åå«å§æäºä»¶
        end_state.save_to_session(
            event_stream.sid, event_stream.file_store, event_stream.user_id
        )

    # å³é­æ§å¶å¨ï¼ä¸è®¾ç½®åæ­¢ç¶æï¼
    await controller.close(set_stop_state=False)

    # è·åæ§å¶å¨æç»ç¶æ
    state = controller.get_state()

    # ä¿å­æ§è¡è½¨è¿¹ï¼è¥éç½®ï¼
    if config.save_trajectory_path is not None:
        # è¥è·¯å¾æ¯æä»¶å¤¹ï¼åä»¥ä¼è¯IDä¸ºæä»¶å
        if os.path.isdir(config.save_trajectory_path):
            file_path = os.path.join(config.save_trajectory_path, sid + '.json')
        else:
            file_path = config.save_trajectory_path
        # åå»ºç®å½ï¼å¦éï¼
        os.makedirs(os.path.dirname(file_path), exist_ok=True)
        # è·åæ§è¡è½¨è¿¹åå²
        histories = controller.get_trajectory(config.save_screenshots_in_trajectory)
        # åå¥ JSON æä»¶
        with open(file_path, 'w') as f:  # noqa: ASYNC101
            json.dump(histories, f, indent=4)

    # è¿åæç»ç¶æ
    return state

</code></pre>
<h2 id="0xff-åè">0xFF åè</h2>
<p><a href="https://docs.all-hands.dev/openhands/usage/architecture/backend" target="_blank" rel="noopener nofollow">https://docs.all-hands.dev/openhands/usage/architecture/backend</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/1936485868761257658" target="_blank" rel="noopener nofollow">å½AI Agentä»âç©å·âèµ°åâå·¥å·âï¼æä»¬è¯¥å³æ³¨ä»ä¹ï¼Openhandsæ¶æè§£æãç¬¬äºç¯ï¼Agent ç¸å³æ ¸å¿æ¦å¿µã</a>  <a href="https://www.zhihu.com/people/dreamrenderx" target="_blank" rel="noopener nofollow">åé</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/1936175201323825087" target="_blank" rel="noopener nofollow">å½AI Agentä»âç©å·âèµ°åâå·¥å·âï¼æä»¬è¯¥å³æ³¨ä»ä¹ï¼Openhandsæ¶æè§£æãç¬¬ä¸ç¯ï¼ç³»åå¯¼è¯»ã</a> <a href="https://www.zhihu.com/people/dreamrenderx" target="_blank" rel="noopener nofollow">åé</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/1940436682949244630" target="_blank" rel="noopener nofollow">Coding Agentä¹Openhandsè§£æ(å«ä»£ç )</a>  <a href="https://www.zhihu.com/people/wu-long-ming-cha-56" target="_blank" rel="noopener nofollow">Arrow</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/1940824548485347192" target="_blank" rel="noopener nofollow">OpenHands æºç è§£è¯»</a>  <a href="https://www.zhihu.com/people/xiao-hui-66-72" target="_blank" rel="noopener nofollow">ä¸åè¾</a></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-27 20:56">2026-01-27 20:55</span>&nbsp;
<a href="https://www.cnblogs.com/rossiXYZ">ç½è¥¿çæè</a>&nbsp;
éè¯»(<span id="post_view_count">32</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19530105);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19530105', targetLink: 'https://www.cnblogs.com/rossiXYZ/p/19530105', title: 'AI Agent æ¡æ¶æ¢ç§ï¼æè§£ OpenHandsï¼3ï¼--- å¯å¨' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å¹¶æ¥éåå¶åºç¨ä¸é¢--å¨ç½æè¯¦ç»ç ]]></title>
    <link>https://www.cnblogs.com/hicode002/p/-/union_set</link>
    <guid>978fb3d5c31eaa3901349bf6df4f10b7</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/hicode002/p/-/union_set" title="åå¸äº 2026-01-27 19:57">
    <span role="heading" aria-level="2">å¹¶æ¥éåå¶åºç¨ä¸é¢--å¨ç½æè¯¦ç»ç</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="å¹¶æ¥é">å¹¶æ¥é</h1>
<p>å¹¶æ¥éæ¯ç¨æ¥æ¥æ¾ååå¹¶éåå³ç³»ç<br>
è¿ä¸ªéåå¿é¡»æ¯ä¸äº¤é<br>
æ¯ææ¥æ¾ååå¹¶ä¸¤ç§æä½ï¼ä¿®æ¹åå¯ä»¥æ¯æå é¤åä¸ªåç´ å¹¶åç¦»éåã<br>
ä½¿ç¨å¨æå¼ç¹çº¿æ®µæ è¿å¯ä»¥å®ç°å¯æä¹åå¹¶æ¥é</p>
<p>æ¥èª <a href="https://oi-wiki.org/ds/dsu/" target="_blank" rel="noopener nofollow">https://oi-wiki.org/ds/dsu/</a></p>
<p>å¹¶æ¥éç±»ä¼¼äºæ ï¼æ®éå¹¶æ¥éæ¯æ åçï¼ä½æ¯å æå¹¶æ¥éæ¯å¯ä»¥åå°æåçï¼è¯¦è§NOI2001é£ç©é¾</p>
<h2 id="æ¥æ¾æä½æ¥æ¾ä¸¤ä¸ªåç´ æ¯å¦å¨åä¸éå">æ¥æ¾æä½ï¼æ¥æ¾ä¸¤ä¸ªåç´ æ¯å¦å¨åä¸éå</h2>
<p>åè®¾æä¸ä¸ªéåï¼åç´ æ¯{1,2,3}<br>
è¿æä¸ä¸ªéååç´ æ¯{4,5,6}<br>
ç°å¨æ¥æ¾2å4å¨ä¸å¨åä¸ä¸ªéåï¼åéè¦æä¸¾2æå¨æ4æå¨éåææåç´ ç´å°æ¾å°4æå°æåä¹æ²¡æ4<br>
å¤ªæ¢äºï¼æä¸ä¸ªæ´å¥½çæ¹æ³ï¼å¦ææä»¬éä¾¿éä¸ä¸ªéåä¸­çæä¸ªåç´ ä½ä¸ºè¯¥éåçä»£è¡¨åç´ ï¼<br>
å¶å®è¯¥éåä¸­çåç´ é½æåè¿ä¸ªåç´ <br>
å½æ¥æ¾åç´ æå¨éåæ¶ï¼åªè¦æ¾å°è¿ä¸ªåç´ çæåçåç´ çæé¡¶çº§åç´ å³æ ¹ï¼è¿ä¸ªæ ¹å°±æ¯ä»£è¡¨èç¹<br>
æåå¤æ­è¿ä¸¤ä¸ªåç´ çæ ¹æ¯å¦ç¸åå³å¯<br>
è¿ééå°ä¸ä¸ªé®é¢ï¼å°±æ¯è¿ä¸ªæ ¹åç´ æä¹æ è®°å¢ï¼å¯ä»¥è®©å®ææåçåç´ æ¯èªå·±ï¼è¿æ ·è¯¢é®æ¶åªè¦éå°æååç´ æ¯èªå·±çåç´ ï¼é£ä¹è¯´ææ¾å°æ ¹äºï¼å³å¯åæ­¢<br>
æä»¬æè¿ä¸ªæåçåç´ å«åè¿ä¸ªåç´ çç¶äº²<br>
æ³¨ææ ä¸åªæä¸¤å±ï¼å ä¸ºå¨åå¹¶æä½æ¶éåè¢«åå¹¶ï¼ååä¸¤ä¸ªéåçæ ¹ä¸­æä¸ä¸ªåæäºå­èç¹ï¼æ­¤æ¶å±æ°ä¼å¢å ï¼èè¿ä¸ªä»£è¡¨åç´ æ¯æ´æ£µæ çæ ¹ï¼è¿ä¸ªç¹çç¶äº²åªæ¯å®çåæ¥çéåçæ ¹ï¼å ä¸ºéåå·²ç»åå¹¶ï¼æä»¥å¤æ­ä¸¤ä¸ªåç´ æ¯å¦å¨åä¸éåä¸­æ¶è¦ç¨æ´æ£µæ çæ ¹ï¼å æ­¤è¦éå½å¯»æ¾è¿ä¸ªåç´ çç¶äº²ç´å°åç´ çç¶äº²æ¯èªèº«æ¶åæ­¢å¯»æ¾å¹¶è¿åè¯¥åç´ ãå½ç¶è¿ä¸ªè¿ç¨å¯ä»¥å¾ªç¯è§£å³ï¼åªéè¦å®ä¹ä¸´æ¶åéä¸ºè¯¥åç´ çç¶äº²ï¼ç¶åè¿ä¸ªåéä¸æ­ç­äºè¿ä¸ªåéçç¶äº²ï¼ç´å°å¶ç¶äº²ç­äºèªèº«ä¸ºæ­¢ï¼ç¶åè¿åè¯¥åéå³å¯<br>
ä¸¾ä¾ï¼<br>
åè®¾éå1ä»¥3ä¸ºæ ¹ï¼éå2ä»¥6ä¸ºæ ¹ï¼å<br>
<img src="https://img2024.cnblogs.com/blog/3026852/202601/3026852-20260124162032821-1549875642.png" alt="image" loading="lazy"><br>
2å4çæ ¹åå«æ¯3å6ï¼ä¸ç­ï¼æä»¥ä¸å¨ä¸ä¸ªéå<br>
1å3çæ ¹åå«æ¯3å3ï¼ç¸ç­ï¼æä»¥å¨ä¸ä¸ªéåã</p>
<h2 id="åå¹¶æä½">åå¹¶æä½ï¼</h2>
<p>æä¸¤ä¸ªåç´  æå¨éå åå¹¶ä¸ºä¸ä¸ªéåï¼åå¹¶åä¸¤ä¸ªéåç­åäºå¨ä¸ä¸ªå¤§éåä¸­ï¼æ­¤æ¶ä¸ä¸ªåç´ æå¨éåçæ ¹è¦åæå­èç¹ï¼å¦ä¸ä¸ªä½ä¸ºå¤§éåçæ ¹ã<br>
å¦ä½åå¹¶ï¼<br>
å¾ç®åï¼åæ¥æ¾ä¸¤ä¸ªåç´ çæ ¹ï¼ç¶åæä¸ä¸ªæ ¹çç¶äº²æ¹ä¸ºå¦ä¸ä¸ªæ ¹ï¼è¿æ ·å°±å®æäºåå¹¶ ï¼ä½æ¯å¦æä¸¤ä¸ªåç´ çæ ¹ç¸åè¯´æå¨ä¸ä¸ªéåå°±ç´æ¥è¿åä¸ç¨åå¹¶<br>
ä¾ï¼<br>
ä»¥æ¥æ¾æ¶ä¸ºä¾<br>
åå¹¶åï¼<br>
<img src="https://img2024.cnblogs.com/blog/3026852/202601/3026852-20260124162032821-1549875642.png" alt="image" loading="lazy"><br>
åè®¾æ°æ ¹æ¯6<br>
åå¹¶åï¼<br>
<img src="https://img2024.cnblogs.com/blog/3026852/202601/3026852-20260124162149379-1024618492.png" alt="image" loading="lazy"><br>
åæ¥æ¾2å4ï¼<br>
2çç¶äº²æ¯3ï¼3çç¶äº²æ¯6ï¼6çç¶äº²æ¯6<br>
4çç¶äº²æ¯6<br>
å¨ä¸ä¸ªéå<br>
æ³¨æåå¹¶æ¶è¦æä¸ä¸ªæ ¹ç´æ¥æ¥å°å¦ä¸ä¸ªæ ¹ä¸ï¼èä¸æ¯æ¥å°å­èç¹ä¸ï¼ï¼</p>
<h2 id="è·¯å¾åç¼©">è·¯å¾åç¼©</h2>
<p>å¨æ¥æ¾æ¶æä»¬ä¸å³å¿è¿ä¸ªåç´ çç¶äº²ï¼åªè¦è¿ä¸ªåç´ éè¿æ¾ç¶äº²è½æ¾å°æ ¹å³å¯ï¼æä»¥æ¯æ¬¡æ¥æ¾åææ¥æ¾çè¿æ¡é¾ä¸çåç´ çç¶äº²ç´æ¥æ¹ä¸ºæ ¹ï¼è¿æ ·ä¸å½±åæ¥æ¾ï¼èä¸åå°ä»¥åæ¥æ¾çæ¬¡æ°ï¼åå°æ é«ï¼<br>
éå½æ¶åªè¦è¿åæ¶return fa[x]=find(fa[x])å³å¯ï¼è¿æ ·ä¼éå½å°æåæ¾å°æ ¹æç¶äº²ä»ä¸å¾ä¸åæº¯çæ¹<br>
å¾ªç¯æ³è¦æ¾å°æ ¹ååå¼ä¸ä¸ªå¾ªç¯ï¼åè®©å¾ªç¯åé=å®çç¶äº²ï¼ç¶åæå®çç¶äº²æ¹ä¸ºæ ¹ï¼ç´å° ç¶äº²=ç¶äº² æ¶åæ­¢ï¼å°æ ¹äºï¼ï¼è¿æ¯èªä¸å¾ä¸çã<br>
ä½æ¯ä¸æ¬¡åªè½ä¿è¯è¿æ¡é¾ä¸çï¼ä¸è½æ¯å¨æ é½æ¹å¥½ï¼æä»¥åé¢å é¤åç´ æ¶æ¯è¾éº»ç¦</p>
<h2 id="æç§©åå¹¶å¯åå¼åå¹¶">æç§©åå¹¶ï¼(å¯åå¼åå¹¶ï¼</h2>
<p>å¨åå¹¶æ¶æä»¬è¦å°å¶ä¸­ä¸ä¸ªåç´ æå¨éåçæ ¹åä¸ºå­èç¹ï¼å¦ä¸ä¸ªåä¸ºæ°æ ¹ï¼å¯æ¯åªä¸ä¸ªåä¸ºå­èç¹å¢ï¼<br>
æ¾ç¶å°å°ºå¯¸å°çæ¥å°å°ºå¯¸å¤§çéåä¸æ´å¥½ï¼è¿æ ·æ¥æ¾å¤§çæ¶è¿æ¯é£ä¸ªå¤æåº¦ï¼å¯åä¹è¦è±æ´å¤çæ¶é´ï¼ä½æ¯å°ºå¯¸å°çéåé æå½±åå°ï¼æä»¥è¦æå°ºå¯¸å°çæ¥å°å°ºå¯¸å¤§çéåä¸<br>
ä½æ¯å°ºå¯¸æ¯ä»ä¹å¢ï¼<br>
å°ºå¯¸æ¢å¯ä»¥æ¯ä¸ä¸ªéåçåç´ ä¸ªæ°å³ç¹æ°ï¼ä¹å¯ä»¥æ¯æ çé«åº¦ï¼å®ä»¬ä¼åçæææ¯ç­ä»·ç<br>
å¦æä»¥ç¹æ°ä¸ºå°ºå¯¸ï¼é£ä¹åå¹¶æ¶æç¹æ°å°çæ ¹ç¶äº²ç­äºç¹æ°å¤§çæ ¹ï¼ç¹æ°å¤§çæ ¹çç¹æ°+=ç¹æ°å°çæ ¹çç¹æ°ï¼è¿ä¸ªå«åå¯åå¼åå¹¶ï¼å¶ä»æ°æ®ç»æä¹å¸¸ç¨<br>
å¦æä»¥é«åº¦ä¸ºå°ºå¯¸ï¼é£ä¹åå¹¶æ¶æé«åº¦å°çæ ¹ç¶äº²ç­äºé«åº¦å¤§çæ ¹ï¼ä½æ¯é«åº¦ä¸åï¼ä¸ºä»ä¹ï¼ è¿ä¸ªå«åæç§©åå¹¶ï¼ä¸æ¯å¾å¸¸ç¨<br>
åªè¦açé«åº¦å°äºbï¼å ä¸ºé«åº¦æ¯æ´æ°ï¼æä»¥açé«åº¦æ¯bè³å°å°ä¸ï¼æaæ¥å°bçä¸é¢ï¼æ­¤æ¶è¿ä¸ªé«åº¦ä¸è½è¶è¿b<br>
ä»ä¹æ¶åé«åº¦æ¹åï¼å½aåbé«åº¦ç¸ç­æ¶ï¼å¯ä»¥éä¾¿æ¥ï¼ä½æ¯æ è®ºæä¹æ¥é«åº¦é½å¢å 1<br>
åå¦aæ¥å¨bä¸é¢ï¼é£ä¹bçè¿ä¸ªå­æ çé«åº¦ä¸ºbï¼èbçå¶ä»å­æ ä¸­æå¤§çé«åº¦æ¯b-1ï¼å æ­¤bçé«åº¦åä¸ºb+1!</p>
<h2 id="å¤æåº¦">å¤æåº¦ï¼</h2>
<p><span class="math inline">\(n\)</span>ä¸ªåç´ ï¼<span class="math inline">\(m\)</span>æ¬¡æä½ï¼æ¥æ¾æåå¹¶ï¼<br>
ç©ºé´å¤æåº¦ï¼<br>
ç±äºæ¯ä¸ªåç´ é½æä¸ä¸ªç¶äº²ï¼æä»¥<span class="math inline">\(fa\)</span>æ°ç»å¤§å°æ¯<span class="math inline">\(n\)</span>ï¼æç©ºé´å¤æåº¦<span class="math inline">\(Oï¼nï¼\)</span><br>
æ¶é´å¤æåº¦ï¼<br>
æ¢ä½¿ç¨è·¯å¾åç¼©ï¼åä½¿ç¨æç§©åå¹¶:<br>
æ¯ä¸ªæä½å¹³åæ¶é´å¤æåº¦<span class="math inline">\(O(Î±(n))\)</span><br>
<span class="math inline">\(Î±\)</span>æ¯åé¿åæ¼å½æ°ï¼è¿ä¼¼äºå¸¸æ°</p>
<p>æ»æä½å¹³åå¤æåº¦<span class="math inline">\(O(mÎ±(n))\)</span><br>
åªä½¿ç¨è·¯å¾åç¼©ï¼<br>
æ»æä½å¹³åå¤æåº¦<span class="math inline">\(O(mÎ±(n))\)</span><br>
æ»æä½æåå¤æåº¦<span class="math inline">\(O(m logâ¡n )\)</span><br>
åªä½¿ç¨æç§©åå¹¶ï¼<br>
æ»æä½å¹³åå¤æåº¦<span class="math inline">\(O(m logâ¡n )\)</span></p>
<h2 id="å é¤æä½">å é¤æä½ï¼</h2>
<p>ä¿®æ¹åçå¹¶æ¥éæ¯æåä¸ªåç´ çå é¤<br>
ä½æ¯éè¦æ³¨æçæ¯å é¤ä¸æ¯è¯´å é¤è¿ä¸ªç¹åè¿ä¸ªç¹æè¿çç¹ï¼èæ¯ä»ä»å é¤è¿ä¸ªç¹ï¼å¶ä½ä¸ä»ç¸è¿çç¹ä»ç¶å¨åå¹¶æ¥éä¸­ï¼ä½è¿ä¸ªç¹ç¬ç«æä¸ä¸ªéå<br>
å¨å®ç¾å½¢æçå¹¶æ¥éä¸­ï¼æ¯ä¸ªèç¹çç¶äº²é½æ¯æ ¹ï¼æ­¤æ¶å é¤ä¸ä¸ªèç¹å°±æ¯æè¿ä¸ªèç¹çç¶äº²æ¹ä¸ºèªå·±ï¼è¿æ ·ä¸å½±åå¶ä»èç¹ï¼ä½æ¯å®éä¸è·¯å¾åç¼©åªè½å°è¿æ¡é¾ä¸çèç¹çç¶äº²æ¹ä¸ºæ ¹ï¼æä»¥å®éå¹¶æ¥éå½¢æä¸å¯ä¼°è®¡<br>
<img src="https://img2024.cnblogs.com/blog/3026852/202601/3026852-20260124162414092-577349486.png" alt="image" loading="lazy"><br>
å é¤2å<br>
<img src="https://img2024.cnblogs.com/blog/3026852/202601/3026852-20260124162431589-133329972.png" alt="image" loading="lazy"><br>
é£ä¹æä»¬å¯ä»¥ç¨çå­æ¥ä»£æ¿è¿ä¸ªçæ­£çèç¹å»åå¹¶ï¼èæä»¬çæ­£çæ¯ä¸ä¸ªèç¹é½æåæ¯ä¸ä¸ªçå­<br>
è¯¦ç»ï¼<br>
æ¯ä¸ä¸ªèç¹é½å¯¹åºä¸ä¸ªçå­ï¼æ¯ä¸ªèç¹çç¶äº²èµ·åé½æ¯å¯¹åºçä¸ä¸ªæ°çå­<br>
å½æä»¬åå¹¶éåæ¶ï¼æä»¬åªåå¹¶èç¹æåççå­çæå¨éåï¼ä»ç¶ç¬¦åæç§©åå¹¶<br>
å½æä»¬å é¤æ¶æèç¹çç¶äº²æ¹ä¸ºä¸ä¸ªæ°çï¼ä»æªä½¿ç¨è¿ççå­ï¼åçå­ä¿æç©ºï¼è¿æ ·åæ¥éåçå³ç³»å¯ä»¥éè¿è¿ä¸ªç©ºçå­ä¿ç<br>
å½æä»¬æ¥æ¾æ¶æ¥æ¾èç¹æå¨çå­çæ ¹<br>
ä»ç¶å¯ä»¥ç¨è·¯å¾åç¼©<br>
ä¸æ¦è¿ä¸ªèç¹è¢«å é¤ï¼å°±å°äºæ°çå­ï¼æ­¤æ¶è¿ä¸ªèç¹ååæ¥çéåå¹¶ä¸å¨ä¸ä¸ªéåä¸­ï¼æä»¥å é¤ææ<br>
å é¤çèç¹ååå«çèç¹åå¹¶æ¹åçæ¯å®æ°çå­çéå<br>
ä¸åæ¥éåæ å³<br>
è¿å¯ä»¥æè¿åæä½ï¼å°±æ¯å é¤åæè¿ä¸ªèç¹è¿åå°å®æè¿è¢«å é¤çéåä¸­ï¼æ¾ç¶å¯ä»¥ååå¹¶ ï¼ä½ä¹å¯ä»¥æ°ç»è®°å½æ¯ä¸ªèç¹ä¸ä¸æ¬¡è¢«å é¤ççå­ç¼å·ï¼ç¶åæè¿ä¸ªèç¹çæåæ¹ä¸ºä¸ä¸æ¬¡è¢«å é¤ççå­ç¼å·ï¼è¿æ ·å°±å®å¨è¿åä¸ä¸æ¬¡è¿ä¸ªèç¹çå½¢æï¼ä¸éè¦åå¹¶äº</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
int fa[10006],fa1[90006],t=10007,lasts[10006];	
inline int finds(int x ){
	if(fa1[x]==x)return x;
	return fa1[x]=finds(fa1[x]);
}
inline void inserts(int x,int y){
	int a=finds(x),b=finds(y);
	if(a==b)return;
	fa1[a]=b;
}
inline void deletes(int x){
	lasts[x]=fa[x];
	fa[x]=t;
	++t;
}
inline void restore(int x){
	fa[x]=lasts[x];
}
int main(){
	memset(fa,-1,sizeof fa);
	memset(lasts,0,sizeof lasts);
	for(int i=0;i&lt;90006;++i){
		fa1[i]=i;
	}
	int m;
	cin&gt;&gt;m;
	for(int i=0;i&lt;m;++i){
		char op ;int x,y;
		cin&gt;&gt;op;
		if(op=='U'){
			cin&gt;&gt;x&gt;&gt;y;
			if(fa[x]==-1)fa[x]=x;
			if(fa[y]==-1)fa[y]=y;
			inserts(fa[x],fa[y]);
			
		}else if(op=='F'){
			cin&gt;&gt;x&gt;&gt;y;
			if(fa[x]==-1)fa[x]=x;
			if(fa[y]==-1)fa[y]=y;
			if(finds(fa[x])!=finds(fa[y])){
				cout&lt;&lt;0&lt;&lt;endl;
			}else{
				cout&lt;&lt;1&lt;&lt;endl;
			}
		}else if(op=='D'){
			cin&gt;&gt;x;
			deletes(x);
		}else{
			cin&gt;&gt;x;
			restore(x);
		}
	}
	return 0;
}
</code></pre>
<h2 id="å¸¦æå¹¶æ¥é">å¸¦æå¹¶æ¥éï¼</h2>
<p>æ¬è´¨æ¯å¹¶æ¥éçåéæå±<br>
ææ çædagå¾ï¼æ¯ä¸ªåç´ çæå¼è®°å½çæ¯å®åå®ç¶äº²ä¹é´çè¾¹æï¼ä¸»è¦è®°å½çæ¯ä¸ç§å³ç³»ï¼è¿éæ¯ä¸äºæ®éçæ°å­ï¼ä½å¨å®éé®é¢ä¸­è¾¹æå¾å¾æ¯ä¸äºå³ç³»ï¼æåå¯è½è¿è¦åæ¨¡<br>
ç®çæ¯å©ç¨è·¯å¾åç¼©æ±åºåç´ å°æ ¹èç¹çè¾¹æåï¼ç¶åç»å®ä»»æä¸¤ä¸ªåç´ æ±åºè¿ä¸¤ä¸ªåç´ ä¹é´çæäºå³ç³»ï¼ä¸æ ¹æå³çåå·®ï¼<br>
åè®¾æå¼æ°ç»ä¸º<span class="math inline">\(w\)</span><br>
è·¯å¾åç¼©æ¶å¯ä»¥åéå½æ¾æ ¹å¹¶å­å¨ï¼ç¶åæw[x]+=w[fa[x]]ï¼æåæfa[x]æ¹ææ ¹<br>
å ä¸ºæ¯éå½ï¼æä»¥ä¼åæ¾å°æ ¹ï¼ç¶ååæº¯ååç¼åä¸æ ·å±å±å ï¼ç´å°å å°å½ååç´ ä¸ºæ­¢ï¼æ­¤æ¶w[x]å°±ä¸ºxå°æ ¹èç¹çæå¼åï¼åæ¶è¿æ¡é¾ä¸çåç´ é½ææå¼æ¹äº<br>
ä½æ¯éç¹å¨åå¹¶<br>
åå¹¶ä¸¤ä¸ªåç´ xï¼yæå¨éåï¼å¶ä¸­xï¼yä¸¤ä¸ªåç´ ä¹é´æå¼ä¸ºæåå¼sï¼æxåå¹¶å°yææyåå¹¶å°xï¼<br>
ç±äºxå°yåyå°xåªéè°æ¢é¡ºåºå³å¯ï¼æä»¥åªèèxå°y<br>
åå¦xçæ ¹æ¯pxï¼ï¼yçæ ¹æ¯pyï¼çç¥ä¸­é´çé¾ï¼å ä¸ºè·¯å¾åç¼©æ¶ä¼æ¹ï¼é®é¢å¨äºxå°yçæå¼æç¡®ï¼xå°pxçæå¼æç¡®ï¼yå°pyçæå¼æç¡®ï¼ä½æ¯pxå°pyå°±ä¸ç¥éäº<br>
<img src="https://img2024.cnblogs.com/blog/3026852/202601/3026852-20260124162708674-1940796842.png" alt="image" loading="lazy"><br>
å¯ä»¥è¾å©çº¿æ¥è§£å³<br>
åæ±xå°pyï¼è¿éxå°yåyå°pyç­ä»·äºxå°pyï¼æä»¥xå°pyæå¼ç¨åéå æ³ä¸ºs+v2<br>
åçï¼xå°pyåç­äºv1+pxå°py<br>
æä»¥pxå°py=s+v2-v1<br>
è¿æ¯ä¸ªæ½è±¡é®é¢ï¼è¿éå çæ¯åéï¼èä¸æ¯åéçæ¨¡ï¼å¾æµé¼<br>
ä½æ¯å®éé®é¢å¾å¾è¦åæ¨¡æèæ¯åæ ¹åå¼ä¸ä¸ªæ°ç»ï¼è¯¦è§NOI2002é¶æ²³è±éä¼ è¯´<br>
åºç¡æä½å°±æ¯è¿äºï¼è¿æä¸äºä¾é¢</p>
<h3 id="hdu-3038-how-many-answers-are-wrong">HDU-3038-How Many Answers Are Wrong</h3>
<p>æ¥èª <a href="https://blog.csdn.net/yjr3426619/article/details/82315133" target="_blank" rel="noopener nofollow">https://blog.csdn.net/yjr3426619/article/details/82315133</a></p>
<p>æMä¸ªæ°ï¼ä¸ç¥éå®ä»¬å·ä½çå¼ï¼ä½æ¯ç¥éæä¸¤ä¸ªæ°ä¹é´ï¼åæ¬è¿ä¸¤ä¸ªæ°ï¼çæææ°ä¹åï¼ç°å¨ç»åºNä¸ªè¿æ ·çåºé´åä¿¡æ¯ï¼éè¦å¤æ­æå¤å°ä¸ªè¿æ ·çåºé´åä¸åè¾¹å·²ç¥çåºé´åå­å¨çç¾ãä¾å¦ç»åºåºé´å<span class="math inline">\([1,4]\)</span>ä¸º20ï¼<span class="math inline">\([3,4]\)</span>ä¸º15ï¼åç»åº<span class="math inline">\([1,2]\)</span>ä¸º30ï¼æ¾ç¶è¿ä¸ª<span class="math inline">\([1,2]\)</span>çå¼å°±æé®é¢ï¼å®åºè¯¥ä¸º20-15=5ã<br>
ç±äºä¸ç¥éæ¯å¥åºé´æ¯å¦æ­£ç¡®ï¼æä»¥è¦æ ¹æ®ååçæ­£ç¡®çåºé´æ¥æ¨åºè¿ä¸ªåºé´ï¼å¦ææ¨ä¸åºå°±æ¯å¯¹çï¼å ä¸ºæ¯æ°çï¼å¦ææ¨åºäºï¼è¥é¢ç®ç»çä¸ä¹åçæ­£ç¡®çåºé´æ¨åºçåºé´çå¼ç¸ç­å°±è¯´ææ­£ç¡®ï¼å¯ä»¥å¿½ç¥ï¼è¥ä¸ç¸ç­ï¼åä¸æ­£ç¡®ï¼ä¹å¿½ç¥ï¼çä¸æ­£ç¡®çå¼<br>
æ³¨æä¸ç¸ç­æ¯å¯ä¸çç¾çæ¶åï¼<span class="math inline">\([1,10]=50\)</span>  ,<span class="math inline">\([1,5]=100\)</span>è¿çèµ·æ¥ä¸å¯¹ï¼ä½å®éä¸é¢ç®æ²¡è¯´æ¯ä¸ªæ°æ¯æ­£æ°ï¼æä»¥è¿ä¹æ¯å¯¹çï¼å¯è½<span class="math inline">\([6,10]=-50\)</span><br>
æä»¬æ³å°åºé´çåå¹¶ï¼å¾åå¹¶æ¥é<br>
ä½æ¯è¿æ¯ä¸ªé­åºé´ï¼æ²¡æå¬å±ç¹ï¼æä»¬éè¦åå¼åé­åºé´ï¼ä¸è½å¨å¼åºé´ï¼è¿æ ·<span class="math inline">\([1,4]=(0,5)\)</span>   <span class="math inline">\([3,4]=(2,5)\)</span>   <span class="math inline">\([1,2]=(0,3)\)</span>ï¼æ²¡æå¬å±ç¹<br>
å¸¸è§å·¦é­å³å¼åºé´ï¼è¿æ ·<span class="math inline">\([1,4]=[1,5)\)</span>  <span class="math inline">\([1,2]=[1,3)\)</span>   <span class="math inline">\([3,4]=[3ï¼5)\)</span><br>
å¯ä»¥æ1 3å3 5åæ1 5<br>
æä»¥è¦åæ¹åºé´<br>
ç¶åå°±å¯ä»¥ç¨å¹¶æ¥éäºã<br>
çå¾ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3026852/202601/3026852-20260124163306555-1040943616.png" alt="image" loading="lazy"><br>
è¿ä¸¤ç§é½æ¯å¯¹ç<br>
é½æ¯åéçå æ³<br>
ç¬¬ä¸ç§ä»¥5ä¸ºæ ¹ï¼åå¹¶æ¶å¹¶æ²¡æçæ­£1 3è¿è¾¹åæ±å¼ï¼è¦ æ± 1 3æ¶åªéè¦ç¨1 5çååå»3 5çåå³å¯<br>
ç¬¬äºç§ä»¥1ä¸ºæ ¹ï¼åå¹¶æ¶ç¨å¬å¼s+v2-v1ï¼å ä¸º3æ¯å­¤ç«ç¹ï¼æä»¥v2=0ï¼å³s-v1ï¼è¿å°±ç®åºäº1 3<br>
ç¶åæ±1 3çåç¨1 3çå åå» 1 1çåå³å¯<br>
ç±æ­¤å¯è§è¯¢é®åºé´x yæ¶æ¯sum x  -  sum yè¿æ¯åè¿æ¥å®å¨åå³äºåå¹¶æ¶æxçéåå¹¶å°yè¿æ¯æyçéåå¹¶å°xï¼å¦æx-ãyå°±sum x  -sum y<br>
å¦æy-ãxå°±sum y -sum x<br>
æä»¥ä¸è½å¯åå¼åå¹¶<br>
é£ä¹ä»ä¹æ¶åç®ä¸åºx yçåï¼<br>
å½åºé´ä¸¤ä¸ªç«¯ç¹å¨ä¸ä¸ªéåæ¶è¯´æä¸¤ä¸ªsumå¯ä»¥ç¨åéæ±ï¼èä¸å¨ä¸ä¸ªéåæ¶æ±ä¸åºï¼å ä¸ºä¸¤ä¸ªéåæ²¡æäº¤éï¼ä¸­é´çæ°ä¸ç¥éæ¯å¤å°<br>
å æ­¤ï¼æè·¯å¦ä¸ï¼<br>
è¯»å¥åºé´<br>
åå¹¶ä¸¤ä¸ªåºé´ç«¯ç¹ï¼è¥å¨ä¸ä¸ªéåä¸­æ¶å¬å¼ç®åºåï¼æ¯å¯¹ç»åºçï¼ä¸åæ³è®°å½ä¸æ¥<br>
ä¸å¨ä¸ä¸ªéåæ¶è®¤ä¸ºè¿ä¸ªåæ¯å¯¹çï¼æè¿ä¸¤ä¸ªåå¹¶ï¼ä»¥è¿ä¸ªåä¸ºæå¼<br>
åå¹¶æ¶ç¨åºæ¬åéå¬å¼<br>
è¥x-&gt;yå°±ç¨w(x,y)+wï¼y,py)-w(x,px)<br>
è¥y-&gt;xå°±ç¨w(x,y)+w(x,px)-w(y,py)<br>
pxå°±æ¯xçæ ¹<br>
wå°±æ¯ä¹é´çå<br>
åå§åæwæ°ç»ç½®ä¸º0ï¼å³ä½¿æ¯æ ¹èç¹å°èªèº«ä¹æ»¡è¶³ä¸é¢çå¬å¼<br>
æfaãiã=iä¸è¦ç­äº-1ï¼å®¹æåºé</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
int fa[2000003],v[2000003];
inline int find(int x){
	if(fa[x]==x)return x;
	int k=find(fa[x]);
	v[x]+=v[fa[x]];
	fa[x]=k;
	return k;
}
inline void inserts(int x,int y,int a,int b,int z){
	fa[a]=b;
	v[a]=z+v[y]-v[x];
}
int main(){
	memset(fa,-1,sizeof fa);
	memset(v,0,sizeof v);
	int n,m;
	cin&gt;&gt;n&gt;&gt;m;
	int cnt=0;
	for(int i=0;i&lt;m;++i){
		int x,y,z;
		cin&gt;&gt;x&gt;&gt;y&gt;&gt;z;
		y=y+1;//é­åºé´æ¹æå¼åºé´ 
		if(fa[x]==-1)fa[x]=x;
		if(fa[y]==-1)fa[y]=y;
		int a=find(x),b=find(y);	
		if(a!=b){
			inserts(x,y,a,b,z);
		}else{
			if(v[x]-v[y]!=z)cnt++;
		}
	}
	cout&lt;&lt;cnt&lt;&lt;endl;
	return 0;
}

</code></pre>
<p>å¦ä¸ä¸ªä¾é¢ï¼</p>
<h3 id="hihocoder-1515-åæ°è°æ¥">HihoCoder-1515-åæ°è°æ¥</h3>
<p>æè¿°<br>
å°Hiçå­¦æ ¡æ»å±æNåå­¦çï¼ç¼å·1-Nãå­¦æ ¡ååè¿è¡äºä¸åºå¨æ ¡çå¤è¯ææ°´å¹³æµéªã</p>
<p>å­¦æ ¡æ²¡æå¬å¸æµéªçæç»©ï¼æä»¥å°Hiåªè½å¾å°ä¸äºå°éæ¶æ¯ï¼ä¾å¦Xå·åå­¦çåæ°æ¯Yå·åå­¦çåæ°é«Såã</p>
<p>å°Hiæ³ç¥éå©ç¨è¿äºæ¶æ¯ï¼è½ä¸è½å¤æ­åºæä¸¤ä½åå­¦ä¹é´çåæ°é«ä½ï¼</p>
<p>è¾å¥<br>
ç¬¬ä¸è¡åå«ä¸ä¸ªæ´æ°N, MåQãNè¡¨ç¤ºå­¦çæ»æ°ï¼Mè¡¨ç¤ºå°Hiç¥éæ¶æ¯çæ»æ°ï¼Qè¡¨ç¤ºå°Hiæ³è¯¢é®çæ°éã</p>
<p>ä»¥ä¸Mè¡æ¯è¡ä¸ä¸ªæ´æ°ï¼X, YåSãè¡¨ç¤ºXå·åå­¦çåæ°æ¯Yå·åå­¦çåæ°é«Såã</p>
<p>ä»¥ä¸Qè¡æ¯è¡ä¸¤ä¸ªæ´æ°ï¼XåYãè¡¨ç¤ºå°Hiæ³ç¥éXå·åå­¦çåæ°æ¯Yå·åå­¦çåæ°é«å åã</p>
<p>å¯¹äº50%çæ°æ®ï¼$1 &lt;= N, M, Q &lt;= 1000 $</p>
<p>å¯¹äº100%çæ°æ®ï¼<span class="math inline">\(1 &lt;= N, M, Q&lt;= 100000 1 &lt;= X, Y &lt;= N -1000 &lt;= S &lt;= 1000\)</span></p>
<p>æ°æ®ä¿è¯æ²¡æçç¾ã</p>
<p>è¾åº<br>
å¯¹äºæ¯ä¸ªè¯¢é®ï¼å¦æä¸è½å¤æ­åºXæ¯Yé«å åè¾åº-1ãå¦åè¾åºXæ¯Yé«çåæ°ã</p>
<p>æ ·ä¾è¾å¥</p>
<p>10 5 3<br>
1 2 10<br>
2 3 10<br>
4 5 -10<br>
5 6 -10<br>
2 5 10<br>
1 10<br>
1 5<br>
3 5<br>
æ ·ä¾è¾åº</p>
<p>-1<br>
20<br>
0</p>
<p>åæä¸ä¸ï¼<br>
èèä¼ éæ§ååéæ§<br>
æ¾ç¶æ¯å¾ï¼xæ¯yé«å¯ä»¥x-ãyè¿ä¸æ¡è¾¹ï¼æå¼æ¯xæ¯yé«çåæ°<br>
çå¾ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3026852/202601/3026852-20260124163431046-1074997319.png" alt="image" loading="lazy"><br>
3æ¯2é«3åï¼2æ¯1é«5åï¼æä»¥3æ¯1é«8å<br>
å·æä¼ éæ§</p>
<p>åéåå¹¶ï¼<br>
å¯¹äº1æ¯2é«8å<br>
3æ¯4é«3å<br>
1æ¯3é«3å<br>
å1æ¯4é«6å<br>
å2æ¯4é«-2å<br>
æ³¨æå½xæ¯yä½æ¶å°±æ¯xæ¯yé«yæ¯xé«çåæ°çç¸åæ°<br>
<img src="https://img2024.cnblogs.com/blog/3026852/202601/3026852-20260124163544199-37076875.png" alt="image" loading="lazy"><br>
å·æåéæ§<br>
å æ­¤å¯ä»¥ç¨å¹¶æ¥é<br>
é£ä¹æä¹ç±xå°æ ¹èç¹æå¼åyå°æ ¹èç¹æå¼æ¨åºxæ¯yé«çåå¢?<br>
<img src="https://img2024.cnblogs.com/blog/3026852/202601/3026852-20260124163601865-836423128.png" alt="image" loading="lazy"><br>
å³wãxã-wãyã<br>
ä»ä¹æ¶åæ è§£å¢ï¼<br>
å½xä¸yå¨ä¸ä¸ªå¹¶æ¥éæ¶å¯ä»¥æ ¹æ®æ ¹èç¹æ¥æ±xä¸yçæå¼ï¼å½xä¸yä¸å¨ä¸ä¸ªå¹¶æ¥éæ¶ä¸è½å¾åºxå°yçæå¼ï¼<br>
å¦ï¼<br>
1æ¯2é«3åï¼3æ¯4é«2åï¼æ æ³æ±åº2æ¯3é«çåæ°<br>
wæ°ç»ä»£è¡¨xæ¯xçç¶äº²é«çåæ°<br>
è·¯å¾åç¼©æ¶ç»è®¡åï¼å¾ç¥xå°æ ¹çæå¼<br>
åå¹¶æ¶åæ ·ä¸è½å¯åå¼åå¹¶ï¼è¦æxåå¹¶å°y<br>
åéæ³è®¡ç®åå¹¶åçæå¼<br>
åå¹¶xåyæå¨éå<br>
è¯¢é®æ¶åå¤æ­xä¸yæ¯å¦å¨ä¸ä¸ªå¹¶æ¥éï¼æ¯è¾åºw[x]-w[y]<br>
ä¸æ¯è¾åº-1!</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;

using namespace std;
int fa[100003],v[100003];
inline int find(int x){
	if(fa[x]==x)return x;
	int k=find(fa[x]);
	v[x]+=v[fa[x]];
	return fa[x]=k;
}
inline void inserts(int a,int b,int x,int y,int z){
	fa[a]=b;
	v[a]=z+v[y]-v[x];
}
int main(){
	memset(fa,-1,sizeof fa);
	memset(v,0,sizeof v);
	int n,m,q;
	cin&gt;&gt;n&gt;&gt;m&gt;&gt;q;
	for(int i=0;i&lt;m;++i){
		int x,y,k;
		cin&gt;&gt;x&gt;&gt;y&gt;&gt;k;
		if(fa[x]==-1)fa[x]=x;
		if(fa[y]==-1)fa[y]=y;
		int a=find(x),b=find(y);
		if(a!=b){
			inserts(a,b,x,y,k);
		}
	}
	for(int i=0;i&lt;q;++i){
		int x,y;
		cin&gt;&gt;x&gt;&gt;y;
//		cout&lt;&lt;9;
		if(fa[x]==-1)fa[x]=x;
		if(fa[y]==-1)fa[y]=y;	//è¿éæ³¨æå¯è½xåyè¿æ²¡åºç°è¿ï¼æä»¥è¦æ£éª-1ï¼å ä¸º-1åä¸æ ä¼re 
		int g=find(x),f=find(y);
		if(g!=f){
			cout&lt;&lt;-1&lt;&lt;endl;
		}else{
			cout&lt;&lt;v[x]-v[y]&lt;&lt;endl;
		}
		
	}
	return 0;
}
</code></pre>
<h2 id="ç§ç±»å¹¶æ¥é">ç§ç±»å¹¶æ¥éï¼</h2>
<p>å½æä»¬å¨ç»´æ¤ä¸äºå¤æçä¼ éå³ç³»æ¶ï¼æ®éçå¹¶æ¥éæ æ³æ»¡è¶³éæ±<br>
ç»´æ¤æåçæåæ¯æåï¼æäººçæäººæ¯æåï¼<br>
å¼æ§çå¼æ§æ¯åæ§<br>
<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span> <span class="math inline">\(b\)</span>å<span class="math inline">\(c\)</span> å<span class="math inline">\(c\)</span>å<span class="math inline">\(a\)</span><br>
è¿ç§å·æååä¼ éæ§çå³ç³»æ¶ï¼å¯ä»¥ç¨å æå¹¶æ¥é<br>
å½ç¶å¾å¤æ<br>
äºæ¯æä¸ç§å ç©ºé´æ´å¤§ä½æ¯ç®åçç§ç±»å¹¶æ¥é<br>
æä»¬å¯ä»¥æ ¹æ®å³ç³»çæ°ç®ç¡®å®åºè¦æfaæ°ç»å¼ä¸å®çåæ°<br>
ç¶åæè¿ä¸ªæ°ç»åæå ç±»ï¼ç¨æ¥ç»´æ¤ååä¼ éæ§<br>
æ´è°·P1525 å³æ¼ç½ªç¯</p>
<p>æ¥èª <a href="https://zhuanlan.zhihu.com/p/97813717" target="_blank" rel="noopener nofollow">https://zhuanlan.zhihu.com/p/97813717</a></p>
<p>å¢ä¼<br>
é£ç©é¾<br>
å¼æ§é®é¢<br>
è¿æ¯æç®åç<br>
å ä¸ºåªæç·åå¥³ä¸¤ç§<br>
å½aåbåæ§båcåæ§æ¶aåcåæ§ï¼è¿æ¯åºç¡å¹¶æ¥éçåå¹¶<br>
å½aåbå¼æ§båcå¼æ§æ¶aåcåæ§<br>
å½aåbåæ§båcå¼æ§åaåcå¼æ§<br>
åä¸¤ä¸ªå·æååä¼ éæ§<br>
è¿éæä»¬faå¤å¼ä¸åæ°ç»<br>
æä»¬åå®<span class="math inline">\(a\)</span>å<span class="math inline">\(a+n\)</span>ä¸ºå¼æ§ï¼<span class="math inline">\(n\)</span>æ¯æ­£å¸¸å¼çæ°ç»å¤§å°<br>
æä»¥å½<span class="math inline">\(a\)</span>ä¸º<span class="math inline">\(n-1\)</span>æ¶<span class="math inline">\(a+n=2n-1\)</span>ï¼å æ­¤éè¦å¼ä¸¤åæ°ç»<br>
å½<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>æ¯åæ§æ¶ï¼æä»¬å¯ä»¥åå¹¶<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>æå¨éåï¼å ä¸ºé½æ¯åæ§<br>
è¿å¯ä»¥åå¹¶<span class="math inline">\(a+n\)</span>å<span class="math inline">\(b+n\)</span>æå¨éåï¼å ä¸º<span class="math inline">\(a+n\)</span>æ¯ä¸<span class="math inline">\(a\)</span>å¼æ§çï¼<span class="math inline">\(b+n\)</span>æ¯ä¸<span class="math inline">\(b\)</span>å¼æ§çï¼å½<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>åæ§æ¶ï¼<span class="math inline">\(a\)</span>çå¼æ§å<span class="math inline">\(b\)</span>çå¼æ§æ¯åæ§<br>
è<span class="math inline">\(a+n\)</span>éçææåç´ å¨æ¯ä¸ä¸ªæ§å«<br>
<span class="math inline">\(b+n\)</span>ä¹æ¯<br>
æä»¥å¯ä»¥åå¹¶<br>
å½<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>å¼æ§æ¶<br>
é£ä¹æ<span class="math inline">\(a\)</span>çå¼æ§å<span class="math inline">\(b\)</span>åå¹¶ï¼æ<span class="math inline">\(b\)</span>çå¼æ§å<span class="math inline">\(a\)</span>åå¹¶<br>
å³åå¹¶<span class="math inline">\(a+n,b\)</span>      ;   <span class="math inline">\(b+n,a\)</span><br>
å ä¸º<span class="math inline">\(a\)</span>çå¼æ§è¯å®å<span class="math inline">\(b\)</span>åæ§<br>
<span class="math inline">\(b\)</span>çå¼æ§è¯å®å<span class="math inline">\(a\)</span>åæ§</p>
<p>ä¸ºä»ä¹è¿æ ·å¯ä»¥åå°é£ä¸æ¡ï¼<br>
ç¬¬ä¸æ¡æ¾ç¶æ»¡è¶³<br>
ç¬¬ä¸æ¡<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>åæ§å<span class="math inline">\(a,b\)</span>    <span class="math inline">\(a+n,b+n\)</span>åå«å¨ä¸ä¸ªå¹¶æ¥éï¼<span class="math inline">\(b\)</span>å<span class="math inline">\(c\)</span>å¼æ§å<span class="math inline">\(b+n  ,c\)</span>           <span class="math inline">\(c+n,b\)</span>åå«å¨ä¸ä¸ªå¹¶æ¥éï¼æä»¥<span class="math inline">\(a+n\)</span>å<span class="math inline">\(c\)</span>     <span class="math inline">\(a\)</span>å<span class="math inline">\(c+n\)</span>åå«å¨ä¸ä¸ªå¹¶æ¥éï¼<span class="math inline">\(a\)</span>å<span class="math inline">\(c\)</span>ä¸å¨ä¸ä¸ªå¹¶æ¥éï¼æä»¥<span class="math inline">\(a\)</span>å<span class="math inline">\(c\)</span>æ¯å¼æ§<br>
ç¬¬äºæ¡æ¯è¾å¤æ<br>
<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>æ¯å¼æ§æ¶<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>ä¸å¨ä¸ä¸ªå¹¶æ¥éï¼ä½æ¯<span class="math inline">\(b\)</span>å<span class="math inline">\(a+n\)</span>ï¼ï¼<span class="math inline">\(a\)</span>å<span class="math inline">\(b+n\)</span>åå«é½å¨ä¸ä¸ªå¹¶æ¥é<br>
<span class="math inline">\(b\)</span>å<span class="math inline">\(c\)</span>å¼æ§æ¶<span class="math inline">\(b\)</span>å<span class="math inline">\(c\)</span>ä¸å¨ä¸ä¸ªå¹¶æ¥éï¼ä½æ¯<span class="math inline">\(b\)</span>å<span class="math inline">\(c+n\)</span> ï¼ï¼<span class="math inline">\(c\)</span>å<span class="math inline">\(b+n\)</span>åå«å¨ä¸ä¸ªå¹¶æ¥é<br>
æä»¥<span class="math inline">\(a+n\)</span>å<span class="math inline">\(c+n\)</span>å¨ä¸ä¸ªå¹¶æ¥éï¼ï¼<span class="math inline">\(a\)</span>å<span class="math inline">\(c\)</span>ä¹å¨ä¸ä¸ªå¹¶æ¥é<br>
æä»¥<span class="math inline">\(a+n\)</span>å<span class="math inline">\(c+n\)</span>,,,<span class="math inline">\(a\)</span>,<span class="math inline">\(c\)</span>åå«å¨ä¸ä¸ªå¹¶æ¥é<br>
å³å®ä»¬åå«åæ§<br>
æä»¥ç¬¬äºæ¡æ»¡è¶³</p>
<p>é£ä¹æ¥æ¾æ¶é®<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>åæ§è¿æ¯å¼æ§åªéè¦çï¼<br>
<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>å¨ä¸ä¸ªå¹¶æ¥éæ¶è¯´ææ¯åæ§ï¼<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>ä¸å¨ä¸ä¸ªå¹¶æ¥éæ¶è¥<span class="math inline">\(a\)</span>å<span class="math inline">\(b+n\)</span>åæ§<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>å°±æ¯å¼æ§ï¼å°±ä¸¤ç§æ§å«ï¼<br>
æ³¨æ<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>ä¸å¨ä¸ä¸ªå¹¶æ¥éä¸è½è¯´ææ¯å¼æ§<br>
å ä¸ºå¦1 2åæ§<br>
3 4åæ§<br>
åè¯´2 3åæ§ï¼2å3<br>
ä¸å¨ä¸ä¸ªå¹¶æ¥éä¸­ï¼è2çå¼æ§éåä¸­æ²¡æ3ï¼æä»¥2 3åæ§è¿æ¯å¯¹ç</p>
<p>ä½æ¯åé¢ï¼<br>
æ¯æ¬¡ç»åºä¸¤ä¸ªæè«çå³ç³»ï¼å¼æ§å³ç³»ï¼ï¼ç¶ååç°è¿äºæ¡ä»¶ä¸­æ¯å¦ææè®º</p>
<p>æ¥èª <a href="https://blog.csdn.net/sunmaoxiang/article/details/80959300?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.control" target="_blank" rel="noopener nofollow">https://blog.csdn.net/sunmaoxiang/article/details/80959300?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.control</a></p>
<p>æä»¥è¦å¨æå¤æ­<br>
å½è¾å¥<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>å<br>
è¥<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>æä¸ä¸ªæ²¡æåå§åå°±ååå§åï¼<span class="math inline">\(aï¼bï¼a+nï¼b+n\)</span>ä¸­æ²¡æåå§åçé½è¦åå§åï¼ç¶åæ<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>æç§åé¢çè§ååå¹¶<br>
ç¶åè¿ä¸ªæ°æ®æ¯å¯¹ç</p>
<p>è¥<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>å·²ç»åå§åä¹ä¸è½è¯´æå®ä»¬çå³ç³»å·²ç»ç¡®å®ï¼å¦ä¸é¢çä¾å­ï¼æ­¤æ¶å¤æ­<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>å³ç³»æ¯å¦ä¸è¾å¥çç¸ç¬¦ï¼è¥ç¸ç¬¦å°±æ¯å¯¹çï¼è¥ä¸ç¬¦å°±æ¯ä¸å¯¹çï¼å°±è·³è¿ãè¥ä¸å¨ä¸ä¸ªå¹¶æ¥éä¸­ä¸<span class="math inline">\(a\)</span>çå¼æ§å<span class="math inline">\(b\)</span>ä¹ä¸å¨ä¸ä¸ªå¹¶æ¥éä¸­å³ç³»å°±æªç¡®å®ï¼æ­¤æ¶<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>çå³ç³»ååå¹¶ï¼<span class="math inline">\(a\)</span>å<span class="math inline">\(b\)</span>çå³ç³»æ¯å¯¹ç<br>
è¿æ¶è·¯å¾åç¼©åæç§©åå¹¶é½å¯ä»¥ç¨</p>
<pre><code>#include&lt;iostream&gt; 
#include&lt;cstdio&gt; 
#include&lt;cstring&gt;
using namespace std;
int fa[200002];
inline int find(int x){
	if(fa[x]==x)return x;
	return fa[x]=find(fa[x]);
}
inline void inserts(int x,int y){
	int a=find(x),b=find(y);
	if(a==b)return;
	fa[a]=b;
}
int main(){
	int n,m;
	cin&gt;&gt;n&gt;&gt;m;
	memset(fa,-1,sizeof fa);
	for(int i=0;i&lt;m;++i){
		int x,y;
		cin&gt;&gt;x&gt;&gt;y;
		if(fa[x]==-1)fa[x]=x;
		if(fa[y]==-1)fa[y]=y;
		int a=find(x),b=find(y);
		if(a==b)cout&lt;&lt;"N"&lt;&lt;endl;
		else{
			if(fa[y+n]==-1)fa[y+n]=y+n;//æ³¨æy+n x+nå¯è½æ²¡ç¨è¿ï¼æä»¥è¦ååå§å 
			if(fa[x+n]==-1)fa[x+n]=x+n;
			inserts(x,y+n);
			inserts(x+n,y);
			cout&lt;&lt;"Y"&lt;&lt;endl;
		}
	}
	return 0;
} 
</code></pre>
<p>åç¨å æå¹¶æ¥éåä¸ä¸ï¼<br>
wæ°ç»è®°å½xå°xç¶äº²çå³ç³»ï¼1å¼æ§ 0åæ§ï¼<br>
è·¯å¾åç¼©æ¶æ±åï¼ä½æ¯è¦åæ¨¡2<br>
ä¸ºä»ä¹ï¼<br>
æ1å· 2å· 3å·<br>
æé¾ç¶ï¼ç°å¨æ3è·¯å¾åç¼©ï¼ä½¿å¾wã3ãæ¯1ä¸3çå³ç³»<br>
1ä¸2åæ§ä¸2ä¸3åæ§æ¶ï¼w[1]=0   w[2]=0       w[3]=0      w[3new]=w[1]+w[2]+w[3]=0  0%2=0      æ»¡è¶³1 3åæ§<br>
1ä¸2åæ§ä¸2ä¸3å¼æ§æ¶  w[1]=0  w[2]=0  w[3]=1   w[3new]=w[1]+w[2]+w[3]=1  1%2=1  æ»¡è¶³1 3å¼æ§<br>
1ä¸2å¼æ§ä¸2ä¸3åæ§æ¶w[1]=0  w[2]=1  w[3]=0   w[3new]=w[1]+w[2]+w[3]=1   1%2=1  æ»¡è¶³1 3å¼æ§<br>
1ä¸2å¼æ§ä¸2ä¸3å¼æ§æ¶æéè¦  w[1]=0  w[2]=1  w[3]=1  w[3new]=w[1]+w[2]+w[3]=2  2%2=0   æ»¡è¶³å¼æ§çå¼æ§æ¯åæ§<br>
å¯è§å¨åç¼©æ±åæ¶å¯ä»¥é¡ºä¾¿%2ï¼è¿æ ·æåçå³ç³»æ¯æ­£ç¡®çï¼å®éä¸è¿æ¯åäºä¸¤ç±»ï¼æä»¥%2</p>
<p>ç¶ååå¹¶ï¼åæ ·ä¸è½æç§©åå¹¶<br>
åéæ³<br>
å·æåéæ§ï¼ä½è¦åæ¨¡<br>
<img src="https://img2024.cnblogs.com/blog/3026852/202601/3026852-20260124164323599-1904309385.png" alt="image" loading="lazy"><br>
ç±æ­¤å¯è§ï¼æä»¬æyè¿å°xçåéå¬å¼<span class="math inline">\(w[py]=w(x,y)+w[x]-w[y]+2\)</span>ååæ¨¡2å³å¯ï¼è¿æ ·åå¹¶åpxåpyçå³ç³»æ¯æ­£ç¡®ç<br>
+2æ¯ä¸ºäºé²æ­¢<span class="math inline">\(w[x]\)</span>ä¸<span class="math inline">\(w(x,y)\)</span>é½æ¯ä¸º0ï¼è<span class="math inline">\(w[y]=1\)</span>ï¼ä¼åºç°è´æ°</p>
<p>é£ä¹è¯¢é®å³ç³»æ¶æä¹å¤çï¼<br>
è¯¢é®<span class="math inline">\(x\)</span>å<span class="math inline">\(y\)</span>çå³ç³»<br>
å½<span class="math inline">\(x\)</span>å<span class="math inline">\(y\)</span>å¨ä¸ä¸ªå¹¶æ¥éæ¶å³<span class="math inline">\(x\)</span>å<span class="math inline">\(y\)</span>çå³ç³»ç¡®å®<br>
å½<span class="math inline">\(x\)</span>å<span class="math inline">\(y\)</span>ä¸å¨ä¸ä¸ªå¹¶æ¥éæ¶<span class="math inline">\(x\)</span>å<span class="math inline">\(y\)</span>çå³ç³»ä¸ç¡®å®ï¼ç»åºçè¿ä¸ªå³ç³»æ¯å¯¹çï¼ç¶ååå¹¶<br>
æ³¨æä¸ç§ç±»å¹¶æ¥éä¸åçæ¯ï¼<span class="math inline">\(x\)</span>å<span class="math inline">\(y\)</span>å¨ä¸ä¸ªå¹¶æ¥éå¹¶ä¸è½è¯´æxåyçå³ç³»æ¯åæ§ï¼åªè½è¯´æå®ä»¬ææç¡®çå³ç³»ï¼èåå¼æ§æ¯æ ¹æ®æå¼æ°ç»wæ¥ç¡®å®ç<br>
å½å³ç³»ç¡®å®æ¶<br>
è¥<span class="math inline">\(x\)</span>å<span class="math inline">\(y\)</span>çå±åæ ¹èç¹æ¯<span class="math inline">\(px\)</span>ï¼é£ä¹<span class="math inline">\(x\)</span>å<span class="math inline">\(y\)</span>çå³ç³»å°±æ¯$(w[x]-w[y]+2) \mod 2 $<br>
+2åæ ·é²æ­¢åºç°è´æ°<br>
å¦<span class="math inline">\(x\)</span>å°<span class="math inline">\(px\)</span>æ¯1ï¼yå°pyæ¯1<br>
å<span class="math inline">\(x\)</span>å°<span class="math inline">\(y\)</span>æ¯1-1=0 0%2=0<br>
ç¬¦åè¦æ±<br>
ç¶åå¤æ­ä¸ç»åºçæ¯å¦ç¬¦åå³å¯<br>
æ³¨æåå§åæ¯ä¸ªèç¹çwé½æ¯0ï¼å³æ ¹èç¹åå®èªå·±æ¯åæ§ï¼å¦åä¼é æé®é¢ã<br>
æ³¨æè¿éç»åº<span class="math inline">\(x\)</span> <span class="math inline">\(y\)</span>æ¶æä»¬æ<span class="math inline">\(y\)</span>è¿å<span class="math inline">\(x\)</span></p>
<pre><code>#include&lt;iostream&gt;//xè¿æ¥åy
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
int fa[1006],w[1006];
inline int finds(int x){
	if(fa[x]==x)return x;
	int k=finds(fa[x]);
	w[x]=(w[x]+w[fa[x]])%2;
	return fa[x]=k;
}
inline void inserts(int x ,int y,int a,int b,int z){
	fa[a]=b;
	w[a]=z+w[y]-w[x];
	w[a]=w[a]+2;
	w[a]=w[a]%2;
}
int main(){
	memset(fa,-1,sizeof fa);
	memset(w,0,sizeof w);
	int n,m;
	cin&gt;&gt;n&gt;&gt;m;
	for(int i=0;i&lt;m;++i){
		int x,y;
		cin&gt;&gt;x&gt;&gt;y;
		if(fa[x]==-1)fa[x]=x;
		if(fa[y]==-1)fa[y]=y;
		int a=finds(x),b=finds(y);
		if(a!=b){
			inserts(x,y,a,b,1);
			cout&lt;&lt;"Y"&lt;&lt;endl;
			
		}else{
			if((w[y]-w[x]+2)%2==1){
				cout&lt;&lt;"Y"&lt;&lt;endl;
			}else{
				cout&lt;&lt;"N"&lt;&lt;endl;
			}
		}
	}
	return 0;
}
</code></pre>
<p>ç§ç±»å¹¶æ¥éå¯ä»¥ç»´æ¤æäººçæäººæ¯æåè¿æ ·çå³ç³»ï¼è¿ç§è¯´æ³ä¸å¤åç¡®ï¼è¾ä¸ºæ¬è´¨å°è¯´ï¼ç§ç±»å¹¶æ¥éï¼åæ¬æ®éå¹¶æ¥éï¼ç»´æ¤çæ¯ä¸ç§å¾ªç¯å¯¹ç§°çå³ç³»ã</p>
<p>æ¥èª <a href="https://zhuanlan.zhihu.com/p/97813717" target="_blank" rel="noopener nofollow">https://zhuanlan.zhihu.com/p/97813717</a></p>
<p>è¿æä¸ç±»é®é¢ï¼<br>
æå°æ¯¯</p>
<p>ä¿®å¤å¬è·¯   è´ªå¿<br>
||<br>
è¥æ   è´ªå¿<br>
è¿ä¸¤éé¢ç­ä»·ï¼é½æ¯æå¤§å¼çæå°å<br>
æçå¤§æ   åæ¨</p>
<p>è¿äºé¢é½æ¯äºæç»´é¢ï¼ä¸»è¦æ¯åæ¨åè´ªå¿<br>
æå°æ¯¯æ¯æçå¤§æåä¿®å¤å¬è·¯ç»å</p>
<h2 id="å¹¶æ¥éèéåæ°éç»è®¡">å¹¶æ¥éèéåæ°éç»è®¡</h2>
<p>å³äºå¹¶æ¥éèéåæ°éç»è®¡ï¼é¦åè¦ç¥éåå§ç¶æçèéåä¸ªæ°ï¼ç¶åæ¯ä¸æ¬¡åå¹¶æ¯è¥ä¸å¨ä¸ä¸ªå¹¶æ¥éååå¹¶è½ä½¿èéåæ°éåå°<span class="math inline">\(1\)</span>ï¼è¥å¨ä¸ä¸ªå¹¶æ¥éåæ²¡æè´¡ç®ï¼åå¿åå¸ç»è®¡<br>
è¿æçæ¯ä¸ä¸ªèç¹ååæ¯ç¬ç«çéåæ¶ã<br>
ä½æ¯å¦ææ¯ä¸ä¸ªèç¹ä»ååä¸å­å¨å°åºç°å¹¶è¿è¾¹ï¼èéåçæ°éè¦åç±»è®¨è®º<br>
è¥è¿ä¸ªç¹æ²¡æä»»ä½è¾¹å°è¦åå®ç¸è¿ï¼é£ä¹åºç°åèéåä¸ªæ°åèå ä¸ï¼ï¼è¥è¿ä¸ªèç¹åºç°å¹¶è¿ç¬¬ä¸æ¡è¾¹ï¼åèéåæ°éä¸åï¼å ä¸ºèç¹åºç°ç¸å½äºå¢å äºä¸ä¸ªèéåï¼è¿ä¸æ¡è¾¹åå¹¶åèéååå°äº<span class="math inline">\(1\)</span>ï¼æä»¥ä¸å<br>
è¥è¿ä¸ªèç¹å·²ç»åºç°ä¸è¿çä¸æ¯ç¬¬ä¸æ¡è¾¹ï¼é£ä¹åå¹¶ï¼å½ç¶ä¸å¨ä¸ä¸ªéåæ¶ï¼åèéåæ°éåå°<span class="math inline">\(1\)</span>ï¼å ä¸ºæ­¤æ¶è¿ä¸ªèç¹å·²ç»å¨ä¸ä¸ªéåä¸­äºï¼è¥åä¸å¦ä¸ä¸ªéåè¿è¾¹ï¼å°±ä¼ä½¿å¾éåæ°ç®åå°<span class="math inline">\(1\)</span></p>
<p>å½éå°ææ¯/å½»åºå é¤ï¼è¿çç¹åè¾¹ä¸èµ·å é¤ï¼ç ´åäºéåå³ç³»ï¼æ¶ï¼åºè¯¥åæ¨ï¼å¯»æ±å¨é¨<br>
å é¤åçç¶æï¼ç¶ååçåå¹¶<br>
å½éå°ç§»å¨éååç´ ï¼åç¦»åä¸åç´ ä¸ºç¬ç«éåï¼ä¿æåæ¥éåå³ç³»ï¼åªæ¯é£ä¸ä¸ªåç´ ç©ºäºï¼æ¶ï¼åºè¯¥ç¨çå­æ¥åï¼ï¼å³æºèç¹æåçå­ï¼å¯¹äºåå¹¶ä¸æ¥æ¾é½æ¯æä½çå­ï¼å½ç§»å¨æåç¦»æ¹åæºèç¹æåççå­ï¼å°±å¯ä»¥ä¿çåæ¥éåå³ç³»ï¼ä½æ¯å®ç°æºèç¹çè½¬ç§»æåç¦»ã</p>
<h2 id="å¹¶æ¥éçå¦ä¸ç§åæ³">å¹¶æ¥éçå¦ä¸ç§åæ³</h2>
<p>å°±æ¯è·¯å¾åç¼© å¯åå¼åå¹¶  æ¾ç¶äº² ä½¿ç¨äºä¸ä¸ªæ°ç»å®æ<br>
å½fãiãä¸ºè´æ°æ¶ï¼è¯´æè¿ä¸ªèç¹æ¯æ ¹èç¹ï¼æ­¤æ¶f[i]çå¼æ¯è¿ä¸ªæ ¹èç¹çæ çèç¹ä¸ªæ°çç¸åæ°<br>
å½f[i]ä¸ºæ­£æ°æ¶ï¼f[i]æ¯içç¶äº²<br>
è¿æ ·æ¥æ¾xçæ ¹æ¶ï¼å½f[x]&lt;0æ¶è¿åxï¼æ¯æ ¹èç¹ï¼å¶ä½æåµç§å¸¸è·¯å¾åç¼©return f[x]=find(f[x])<br>
åå¹¶æ¶x yåæ¾æ ¹èç¹ï¼å¦ææ ¹èç¹ä¸åï¼é£ä¹å°±è¿è¡åå¹¶<br>
è®¾xçæ ¹ä¸ºrx<br>
yçæ ¹ä¸ºry<br>
å¦æf[rx]&gt;f[ry]  å°±äº¤æ¢rxåry<br>
è¿æ ·f[rx]ä¸å®&lt;=f[ry]<br>
å³-f[rx]&gt;=-f[ry]<br>
æ­¤æ¶rxçæ çå°ºå¯¸å¤§å°&gt;=ryçæ çå°ºå¯¸å¤§å°<br>
rxåæ ¹<br>
f[rx]+=f[ry]<br>
æ´æ°rxçå°ºå¯¸çç¸åæ°<br>
f[ry]=rx<br>
æ­¤æ¶ryå°±æåäºrxï¼åäºå¿å­<br>
è¿ä¸¤æ­¥é¡ºåºä¸è½éï¼å ä¸ºå¨ç¬¬äºæ­¥ä¹åf[ry]è®°å½çæ¯ryä¸çæ å°ºå¯¸çç¸åæ°ï¼f[rx]+=f[ry]å¯ä»¥æ´æ°å°ºå¯¸ï¼èç¬¬äºæ­¥æ¯å ä¸ºryåäºå¿å­ï¼æä»¥f[ry]æäºryçç¶äº²ï¼å¦æé¢ åï¼é£ä¹f[rx]å°±å¯è½åææ­£æ°ä»èè¯¯è®¤ä¸ºä¸æ¯æ ¹èç¹</p>
<p>çè§£ï¼<br>
å¯¹äºä¸¤ä¸ªéåçæ ¹èç¹rxï¼ry<br>
å®ä»¬çfå·²ç»è®¡ç®å¥½ï¼æ¯å®ä»¬çæ çå°ºå¯¸çç¸åæ°ï¼åå¹¶æ¯éè¿æ¯è¾è¿ä¸ªå°ºå¯¸æ¥å®ç°å¯åå¼ åå¹¶ï¼ç¶ååè®¾rxåæ°æ ¹<br>
é£ä¹rxçå°ºå¯¸ç¸åæ°èªç¶è¦æ´æ°ï¼å ä¸ryçå°ºå¯¸çç¸åæ°ï¼é½æ¯è´æ°ï¼ï¼ç¶åryçfå°±åæäºæåç¶äº²çä½ç¨ï¼ryçç¶äº²æ¯rx<br>
æ¥æ¾æ¶è¥xæ¯æ ¹èç¹ï¼f[x]ä¸ä¸å®=-1ï¼ä¹æå¯è½&lt;-1ï¼ä»£è¡¨çæ¯å°ºå¯¸çç¸åæ°ï¼åæ¶è½è¯´ææ¾å°äºæ ¹èç¹<br>
å½f[x]&gt;0æ¶è¯´æfãxãæ¯xçç¶äº²ï¼è¦ç»§ç»­éå½å¹¶è·¯å¾åç¼©<br>
åå§åæ¶f[]è¦ç½®ä¸º-1ï¼ä»£è¡¨æ¯ä¸ªæ å°ºå¯¸ä¸º1</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
using namespace std;
int f[10006];
inline int finds(const int&amp;x ){
	if(f[x]&lt;0)return x;
	return f[x]=finds(f[x]);
}
inline void unions(const int&amp;x,const int &amp;y){
	int rx=finds(x);
	int ry=finds(y);
	if(rx==ry)return;
	if(f[rx]&gt;f[ry])swap(rx,ry);
	f[rx]+=f[ry];
	f[ry]=rx;
	
}
int main(){
	memset(f,-1,sizeof f);
	int n,m;
	cin&gt;&gt;n&gt;&gt;m;
	for(int i=1;i&lt;=m;++i){
		int opt;
		cin&gt;&gt;opt;
		int x1,y1;
		cin&gt;&gt;x1&gt;&gt;y1;
		if(opt==1){
			unions(x1,y1);
		}else{
			int rx1=finds(x1);
			int ry1=finds(y1);
			if(rx1==ry1)cout&lt;&lt;"Y"&lt;&lt;endl;
			else cout&lt;&lt;"N"&lt;&lt;endl;
		}
	}
	return 0;
}
</code></pre>
<hr>
<h2 id="ä¾é¢è¯¦è§£">ä¾é¢è¯¦è§£</h2>
<h3 id="p1197-jsoi2008æçå¤§æ">P1197 [JSOI2008]æçå¤§æ</h3>
<p><a href="https://www.luogu.com.cn/problem/P1197" target="_blank" rel="noopener nofollow">https://www.luogu.com.cn/problem/P1197</a></p>
<p>ç¹æ®çåæ¨æ³<br>
é®é¢ç­ä»·äº<span class="math inline">\(n\)</span>ä¸ªèç¹<span class="math inline">\(m\)</span>æ¡æ åè¾¹<br>
ç¶åææä¸äºç¹åå®ä»¬ç¸è¿çææè¾¹ï¼æ¯æä¸ä¸ªç¹å°±è¾åºèéåä¸ªæ°<br>
æ´åè¯å®è¶æ¶<br>
æåå¹¶ä¸æ åï¼å¯ä»¥ç¨å¹¶æ¥é<br>
éè¦æ³ä¸ä¸ªç¹æ®çæ¹æ³<br>
æä»¬ä¸æç¹ï¼è¿æ ·å¾å°é¾<br>
æä»¬åçå ç¹<br>
åæé¤äºæææçç¹æå³çææè¾¹ä¹å¤çå©ä¸çè¾¹ç¨å¹¶æ¥éåå¹¶<br>
è¿æ¯ææè¿äºç¹åçç¶æï¼æä¸¾å©ä¸çç¹æ±åºèéåä¸ªæ°<br>
ç¶åä»åå¾åå ç¹ï¼å ä¸ºåé¢çç¹æææ¶åé¢çç¹è¿è¦è¿ç<br>
æ¥ä¸æ¥æ¯å ä¸ä¸ªç¹å°±æå®ä»¬ç¸è¿çè¾¹åå¹¶ä¸ä¸ï¼ç¶ååå¹¶æ¶è¥ä¸¤ä¸ªç¹é½å¨ä¸ä¸ªå¹¶æ¥éååå¹¶è¿ä¸¤ä¸ªç¹å¯¹èéåæ²¡æå½±åï¼è¥ä¸å¨ä¸ä¸ªå¹¶æ¥éé£ä¹åå¹¶ï¼æ³¨æå ä¸ä¸ªèç¹å¯è½åå¹¶å¤æ¡è¾¹å¹¶åå°å¤ä¸ªèéåæ°ç®<br>
ç¶åæè¿ä¸ªåå°åçåéè®°å½ ä¸æ¥éåºè¾åº<br>
æä»¬è¦æææè¦æ§æ¯çç¹æç¸è¿çè¾¹å­èµ·æ¥ï¼ä»¥ä¾¿äºåé¢åæ¨å è¾¹ï¼å¹¶ä¸å©ä¸çè¾¹è¦åå¹¶èµ·æ¥ä½ä¸ºææé½ææ¯åçèéåï¼èéåä¸å®è¦è¾¹åå¹¶è¾¹ç»è®¡ï¼åå¿æååå¸ç»è®¡<br>
æä»¬å¦æåå¸è®°ä¸è¾¹ï¼è¯»ææ¯ç¹æ¶æ¾è¾¹å¤ªé¾äºï¼ä½æä»¬å¯ä»¥åå¸è®°ä¸ææ¯ç¹ï¼åéåè¾¹æ¶æ¾åºææ¯ç¹ç¸è¿çè¾¹ä¼å®¹æï¼åæ¶è¿å¯ä»¥åå¹¶å©ä¸çè¾¹ï¼è¿æ¯åå¸çç¬¬ä¸ä¸ªå¦ç¨<br>
åæ¥<span class="math inline">\(n\)</span>ä¸ªç¹<br>
å»æ<span class="math inline">\(k\)</span>ä¸ªå<span class="math inline">\(n-k\)</span>ä¸ªï¼æ­¤æ¶æ¯åå¹¶ä¸æ¬¡åå°ä¸ä¸ªèéå</p>
<p>æ¥ä¸æ¥åçå ç¹ï¼æç¹æè¿çè¾¹åå¹¶<br>
æ³¨æï¼<br>
ææ¶ä¸æ¡è¾¹çå¦ä¸ä¸ªç¹ä¹æ¯ææ¯ç¹ï¼æ­¤æ¶è¦çååé¡ºåºæ¥å³å®æ¯å¦è¿è¾¹<br>
å½ææ¯ç¹é åæ¶ï¼å®éä¸è¿ä¸ªç¹ç°å¨å·²ç»è¢«ææ¯ï¼ä¸è½åä»è¿è¾¹<br>
å½ææ¯ç¹é åæ¶ï¼è¿ä¸ªç¹å·²ç»æ¢å¤ï¼æä»¥è¦åä»è¿è¾¹<br>
å ä¸ºä»åå¾åï¼æä»¥æ¯æ¢å¤ä¸ä¸ªç¹å°±è¦æ<span class="math inline">\(hash\)</span>æ¹ä¸º<span class="math inline">\(2\)</span>ï¼å³å·²æ¢å¤ï¼æ­¤æ¶å¯ä»¥åä»è¿è¾¹ï¼èéææ¯ç¹è¯å®è¦åä»è¿è¾¹ï¼è<span class="math inline">\(hash\)</span>ä¸º<span class="math inline">\(1\)</span>çè¿å¤äºææ¯ç¶æï¼ä¸è¿è¾¹<br>
ç¶åç®èéåçä¸ªæ°<br>
æ³¨æï¼<br>
è¿éææ¯èç¹ä¸æ¯æè¾¹æ­å¼ï¼èæ¯è¿åç¹ä¸åå é¤ï¼å æ­¤å è¾¹åèéåä¸è½å1</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;vector&gt;
using namespace std;
int fa[400006];
struct edge{
	int a,b;
}edges[200006];
int goal[400006];
int hash1[400006];//hash1æ°ç»è®°å½è¿ä¸ªèç¹ç¶æï¼0ä¸ºä¸æ¯è¦æ§æ¯çèç¹ï¼1ä¸ºå½åå·²æ§æ¯çèç¹ï¼2ä¸ºå½åæªæ§æ¯çèç¹ï¼å³å·²åéåæ¥å°è¿ä¸ªèç¹ï¼
vector&lt;int&gt; edge2[400006];//æ¯ä¸ä¸ªè¦æ§æ¯çèç¹æç¸è¿çè¾¹
int out[400006];//å ä¸ºä»åå¾åå è¾¹ï¼æä»¥è¦éåºè¾åº
int num=0;
inline int finds(int x){
	if(fa[x]==x)return x;
	return fa[x]=finds(fa[x]);
}
inline void inserts(int x,int y,int a,int b){
//	if(a==b)return ;
	fa[a]=b;
}
int main(){
	memset(hash1,0,sizeof hash1);
	for(int i=0;i&lt;400006;++i){
		fa[i]=i;
	}//ä¸è¦memset -1ï¼è¿æ ·åé¢è¦ä¸ä¸ªä¸ªæ¹ï¼è¦æååå§åå¥½
	int n,m;
	cin&gt;&gt;n&gt;&gt;m;
	for(int i=0;i&lt;m;++i){
		int x,y;
		cin&gt;&gt;x&gt;&gt;y;
		edges[i].a =x;//edgeæ°ç»å­è¾¹
		edges[i].b=y;
	}
	int k;
	cin&gt;&gt;k;
	for(int i=0;i&lt;k;++i){
		cin&gt;&gt;goal[i];
		hash1[goal[i]]=1;//åå¸è¡¨å®ä¸º1å ä¸ºè¿ä¸ªç¹æ¯å·²ç»ææ¯äºç
	}
	int lian1=n-k;
	for(int i=0;i&lt;m;++i){
		if(hash1[edges[i].a ]==1){
			edge2[edges[i].a].push_back(edges[i].b );
			 
		}//è¿ä¸¤ä¸ªifè¦å¹¶åä¸è¦elseï¼å ä¸ºä¸¤ä¸ªa bç¹æå¯è½é½æ¯è¦ææ¯çç¹
		if(hash1[edges[i].b ]==1){
			edge2[edges[i].b].push_back(edges[i].a );
			 
		}
		if((!hash1[edges[i].a ])&amp;&amp;(!hash1[edges[i].b ])){
			int root1=finds(edges[i].a ),root2=finds(edges[i].b);//å¦æä¸¤ä¸ªé½ä¸ææ¯ï¼é£ä¹å°±è¦åå¹¶æ¥ç®åºèéå
			if(root1!=root2){//æ ¹èç¹ç¸åæ¶åå¹¶æ²¡æç¨ï¼èéåä¸å
				inserts(edges[i].a,edges[i].b,root1,root2);
				lian1-=1;	
			}
		}
	}
	//cout&lt;&lt;lian1&lt;&lt;endl;
	out[num]=lian1;
	++num;
	for(int i=k-1;i&gt;=0;--i){//è¦ç­äº0ï¼å ä¸ºå¨é¨æ¢å¤åæ¯å¨è¿å¥½çèéåï¼æ¯è¦æ±è¾åºç
		int root1=finds(goal[i] );
		int fl1=1,fl2=1;//fl1æ¯çè¿ä¸ªç¹æ¯å¦å­¤ç«ï¼è¥æ´ä¸ªéåæ²¡æå¯ä»¥è¿çè¾¹è¯´æå®æ¯å­¤ç«çï¼æ­¤æ¶æ¢å¤åèéååèå 1ï¼fl2çè¿ä¸ªç¹æ¯å¦æ¯ç¬¬ä¸æ¬¡è¿è¾¹
		è¥æ¯ï¼è¯´æè¿æ¯æååä¸å­å¨çç¹åä¸ä¸ªéåè¿è¾¹ï¼æ­¤æ¶ä¸æ¦è¿èµ·ä¹åèéåä¸åå°ï¼å ä¸ºååè¿ä¸ªç¹ä¸å­å¨ï¼èç°å¨è¿èµ·ä¹åå°±å­å¨äº
		èè¥ä¸æ¯ç¬¬ä¸æ¬¡è¿è¾¹ï¼é£ä¹è¿ä¸ªç¹å·²ç»å­å¨äºï¼æ­¤æ¶å®ä¸å¶ä»ç¹ææäºéå
		é£ä¹è¿æ¯è¿è¾¹å°±è½å°èéåä¸ªæ°åä¸
		for(int j=0;j&lt;edge2[goal[i]].size();++j){
			if(hash1[edge2[goal[i]][j]]!=1){
				fl1=0;
				
				
				int root2=finds(edge2[goal[i]][j]);
				
				if(root1!=root2){
					
					
					inserts(edge2[goal[i]][j],goal[i],root2,root1);
					if(fl2){
						fl2=0;
						continue;
					}
					lian1-=1;
				}
			}
			
		}
		if(fl1)lian1+=1;
		hash1[goal[i]]=2;
		out[num++]=lian1;
	}
	for(int i=num-1;i&gt;=0;--i){
		cout&lt;&lt;out[i]&lt;&lt;endl;
	}
	return 0;
}
</code></pre>
<h3 id="p1111-ä¿®å¤å¬è·¯">P1111 ä¿®å¤å¬è·¯</h3>
<p><a href="https://www.luogu.com.cn/problem/P1111" target="_blank" rel="noopener nofollow">https://www.luogu.com.cn/problem/P1111</a></p>
<p>è¿æ¯å¹¶æ¥éçè´ªå¿ç®æ³<br>
<span class="math inline">\(n\)</span>ä¸ªèç¹<span class="math inline">\(m\)</span>æ¡æ åè¾¹ï¼ç»å®è¾¹çä¿®å¥½æ¶é´<br>
æ±æå°è½ä½¿<span class="math inline">\(n\)</span>ä¸ªèç¹ç¸äºè¿éçæ¶é´<br>
æ åå¾ï¼è¿è¾¹ç¸å½äºåå¹¶ï¼å¯ä»¥ä½¿ç¨å¹¶æ¥é<br>
å ä¸ºæ¯æå°ãå¯ä»¥èèè´ªå¿ï¼åæè¾¹ææ¶é´ç±å°å°å¤§æåºå¹¶éå<br>
ç¶åä»å°å¼å§éåï¼æ¯éåä¸æ¡è¾¹å°±æè¿ä¸¤ä¸ªèç¹åå¹¶èµ·æ¥ï¼ç¨<span class="math inline">\(size\)</span>æ°ç»è®°å½æ ¹çå°ºå¯¸ï¼å¯åå¼åå¹¶ï¼å¦æè¿ä¸ªæ ¹ç<span class="math inline">\(size\)</span>æ¯<span class="math inline">\(n\)</span>ï¼é£å°±è¯´æææèç¹é½å¨ä¸ä¸ªå¹¶æ¥éä¸­ï¼å°±è¾åºæ­¤æ¶çæ¶é´ï¼å¦åè¥å°æåä¹æ²¡æèéï¼å°±è¾åº<span class="math inline">\(-1\)</span></p>
<p>ä¸ºä»ä¹è´ªå¿æ­£ç¡®?<br>
æä»¬éæ©çæ¶é´æ¯ä»å°å°å¤§ä¸­ååä¿æèéçæ¶é´ï¼åè®¾æå®æèéçæ¶é´æ¯è¿ä¸ªå°çæåµï¼é£ä¹ä¹åéåå°çæ¶é´ä¸­å°±å¿å®æè¿ä¸ªæ¶é´ï¼é£ä¹ç­æ¡å°±ä¼æ´å°ï¼èå¦ææèéæ¶é´æ¯è¿ä¸ªå¤§çè¯é£ä¹è¿ä¸ªæ¶é´ä¸å·²ç»ä¿æèéï¼åå è¾¹ä¹æ²¡æç¨ï¼ä¸å¦è¿ä¸ªæ´å°çæ¶é´<br>
è½ç¶åé¢åå¹¶çæ¶åæä¸äºå¯¹èéæ ç¨çéå¤è¾¹è¢«å ä¸äºï¼ä½è¿å¹¶ä¸å½±åç­æ¡ï¼å ä¸ºæä»¬ä¸æ±åï¼èæ¯æ±ä¸ä¸ªæ»¡è¶³æ¡ä»¶çæå°å¼ï¼æ¶é´æ¯ä¸ç¹ç¹æµéçï¼ä¿®å»ºå¬è·¯æ¯åæ­¥è¿è¡çï¼ä¿®è¿äºæ ç¨çå¬è·¯ä¹æ¶ä¹å¨ä¿®æç¨çå¬è·¯ï¼æä»¥è¿äºéå¤è¾¹å¯¹ç­æ¡æ²¡æå½±å<br>
è¿ä¸ªé¢ä¸<br>
P1396 è¥æ</p>
<p>æ¥èª <a href="https://www.luogu.com.cn/problem/P1396" target="_blank" rel="noopener nofollow">https://www.luogu.com.cn/problem/P1396</a><br>
æç¸ä¼¼ä¹å¤</p>
<h3 id="p1396-è¥æ">P1396 è¥æ</h3>
<p>æ¥èª <a href="https://www.luogu.com.cn/problem/P1396" target="_blank" rel="noopener nofollow">https://www.luogu.com.cn/problem/P1396</a></p>
<p>è¿æ¯ä¸ªéç¹é¢<br>
é¢ç®çæææ¯è¯´æ¾ä¸æ¡ä»<span class="math inline">\(s\)</span>å°<span class="math inline">\(t\)</span>çè·¯å¾ä½¿å¶è¾¹æçæå¤§å¼æ¯æææ¯æ¡<span class="math inline">\(s\)</span>å°<span class="math inline">\(t\)</span>çè·¯å¾ä¸­è¾¹ææå¤§å¼æå°çé£ä¸ª<br>
å°±æ¯è¯´<span class="math inline">\(s\)</span>å°<span class="math inline">\(t\)</span>çææ¡è·¯å¾æå¼æ¯è¿æ¡<span class="math inline">\(s\)</span>å°<span class="math inline">\(t\)</span> è·¯å¾ä¸­è¾¹æçæå¤§å¼<br>
èè¦æ±ä¸æ¡è·¯å¾ä½¿å¶æå¼æå°ï¼è¾åºè¿ä¸ªæå°å¼</p>
<p>èæå°å¼æå¤§æ¯æ<span class="math inline">\(s\)</span>å°<span class="math inline">\(t\)</span>ææ¡è·¯å¾æå¼æ¯è¿æ¡è·¯å¾ä¸­è¾¹æçæå°å¼<br>
è¦æ±1æ¡è·¯å¾ä½¿å¾æå¼æå¤§</p>
<p>ä¹å¯ä»¥æè¾¹æä»å°å°å¤§æåºï¼ä»å°å¼å§åå¹¶ï¼ç´å°åå¥½<span class="math inline">\(s\)</span>å°<span class="math inline">\(t\)</span>èéï¼è¾åºè¿ä¸ªæå¼</p>
<p>ä¸ºä»ä¹æç«å¢ï¼</p>
<p>èèè¿ä¸ªæå¼æ¾ç¶æ¯è¿é<span class="math inline">\(s\)</span>å°<span class="math inline">\(t\)</span>è¾¹æä¸­çæå¤§å¼ï¼ä½å¦ä½ä¿è¯å®æ¯ææè·¯å¾ä¸­æå°çï¼<br>
åè®¾è¿æèéè·¯å¾çæå¤§å¼æ¯è¿ä¸ªè¿å°ï¼é£ä¹è¿æ¡è·¯å¾çææè¾¹æé½æ¯è¿ä¸ªè¿å°ï¼é£ä¹å®ä»¬åºè¯¥å¨è¿ä¸ªçåé¢è®¿é®å°ï¼å¦æåé¢è½ææèéï¼é£ä¹å°±ä¼æ´æ©éæ©ï¼èä¸ä¼éæ©è¿ä¸ªï¼æä»¥æ¯è¿ä¸ªæå°ç</p>
<p>æå°å¼æå¤§å°±åºè¯¥ä»å¤§å°å°æåºåå¹¶å°åå¥½èéä¸ºæ­¢<br>
èè¿ä¸ªæå¼ä¹æ¯å½åè·¯å¾çæå°å¼ã<br>
åè®¾è¿æèéè·¯å¾çæå°å¼æ¯è¿ä¸ªè¿å¤§ï¼é£ä¹è·¯å¾ææè¾¹æé½æ¯è¿ä¸ªå¤§ï¼é£ä¹å®ä»¬å°±ä¼å¨è¿ä¸ªä¹åè®¿é®ï¼è¥è½ææèéå°±ä¼æ´æ©éæ©ï¼å¯æ¯éæ©äºè¿ä¸ªå°±è¯´ææ²¡ææ¯è¿ä¸ªè¿å¤§çè§£</p>
<h3 id="p2330-scoi2005ç¹å¿çé½å¸">P2330 [SCOI2005]ç¹å¿çé½å¸</h3>
<p>æ¥èª <a href="https://www.luogu.com.cn/problem/P2330" target="_blank" rel="noopener nofollow">https://www.luogu.com.cn/problem/P2330</a></p>
<p>æ¹é çéè·¯å°½éå°å°±æ¯è¦åå¥½ä¿æèéä¸è¦ææ ç¨çè¾¹<br>
æä»¥ä»å°å°å¤§æåºåå¹¶æ¶å¦æå½åçä¸¤ä¸ªç¹å·²ç»å¨ä¸ä¸ªå¹¶æ¥éä¸­å°±è¯´æè¿æ¡è¾¹æ ç¨ï¼ä¸è¦ç»è®¡æ°éï¼è·³è¿</p>
<h3 id="p2121-æå°æ¯¯">P2121 æå°æ¯¯</h3>
<p>æ¥èª <a href="https://www.luogu.com.cn/problem/P2121" target="_blank" rel="noopener nofollow">https://www.luogu.com.cn/problem/P2121</a></p>
<p>ä¸è¦æ±èéï¼åªæ¯è¦æ±åçç¹ä¸è½æç¯<br>
æä»¥å°±åæçå¤§æé£æ ·åæææè¾¹ææï¼ç¶åææå¼ä»å¤§å°å°æåº<br>
æ³¨æè¿éç»è®¡åï¼ä»å¤§å°å°éåï¼æå½åä¸¤ä¸ªç¹åå¹¶ï¼å¦æåç°å·²ç»å¨ä¸ä¸ªå¹¶æ¥éå°±è¯´æå·²ç»èéï¼åå è¾¹å°±ä¼å½¢æç¯ï¼å°±ä¸è¦æè¿ä¸ªæå¼å è¿å»</p>
<p>ä¸ç´å å°<span class="math inline">\(k\)</span>ä¸ªçæ­£çå°æ¯¯ï¼ä¸æç¯ï¼ï¼è¾åºå<br>
å ä¸ºè¿æ¯ä»å¤§å°å°æå¤§ç<span class="math inline">\(k\)</span>ä¸ªææ¯é¤å»ä¸äºä¹åæå¤§ç<span class="math inline">\(k\)</span>ä¸ª<br>
æä»¥åæ¯æå¤§ç</p>

</div>
<div id="MySignature" role="contentinfo">
    <p>é»ç²±ä¸æ¢¦ï¼ç»æ¯ä¸ç©º</p>

<p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/hicode002/" target="_blank">hicode002</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/hicode002/p/-/union_set" target="_blank">https://www.cnblogs.com/hicode002/p/-/union_set</a></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.0006944444444444445" data-date-updated="2026-01-27 19:58">2026-01-27 19:57</span>&nbsp;
<a href="https://www.cnblogs.com/hicode002">hicode002</a>&nbsp;
éè¯»(<span id="post_view_count">33</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19526925);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19526925', targetLink: 'https://www.cnblogs.com/hicode002/p/-/union_set', title: 'å¹¶æ¥éåå¶åºç¨ä¸é¢--å¨ç½æè¯¦ç»ç' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ PostgreSQLï¼æ°å¢è¯­å¥ï¼ç¹æ®å¤çï¼ON CONFLICT ... DO (UPDATE SET ...)/(NOTHING) ]]></title>
    <link>https://www.cnblogs.com/kakarotto-chen/p/19538290</link>
    <guid>74a2b412024560ab54351cc21dd59c5d</guid>
    <description>
    <![CDATA[ 
        <h2>
            <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/kakarotto-chen/p/19538290" title="åå¸äº 2026-01-27 15:16">
    <span role="heading" aria-level="2">PostgreSQLï¼æ°å¢è¯­å¥ï¼ç¹æ®å¤çï¼ON CONFLICT ... DO (UPDATE SET ...)/(NOTHING)</span>
    

</a>

        </h2>
        <div class="postbody">
            <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="1æ®éçinsert-into">1ãæ®éçinsert into</h2>
<ul>
<li>å¦æï¼ä¸»é®/å¯ä¸å»ºï¼å­å¨ï¼åä¼æ¥é</li>
<li><mark>æ°éæ±ï¼å°±ç®å²çªä¹ä¸æ¥éï¼ç¨å¶ä»å¤çé»è¾</mark></li>
</ul>
<h2 id="2åºæ¬è¯­æ³insert-into--on-conflict--do-update-set-nothing">2ãåºæ¬è¯­æ³ï¼INSERT INTO ... ON CONFLICT (...) DO (UPDATE SET ...)/(NOTHING)ï¼</h2>
<ul>
<li>è¯­æ³å¾</li>
</ul>
<div class="mermaid">flowchart TD
    A[å¼å§: INSERTåçä¸»é®/å¯ä¸å²çª] --&gt; B{å²çªåçæææ¯?}
    B --&gt;|âä¿çæ§æ°æ®ï¼&lt;br&gt;éé»è·³è¿â| C[ä½¿ç¨ ON CONFLICT DO NOTHING]
    B --&gt;|âç¨æ°æ°æ®æ¿æ¢æä¿®æ¹æ§æ°æ®â| D[ä½¿ç¨ ON CONFLICT DO UPDATE SET]
    
    D --&gt; E{éè¦ç²¾ç»æ§å¶å?}
    E --&gt;|âæ¯ï¼åªæ´æ°é¨åå­æ®µâ| F[å¨SETä¸­ä»æå®ç®æ å­æ®µ]
    E --&gt;|âæ¯ï¼éæ»¡è¶³æ¡ä»¶ææ´æ°â| G[æ·»å WHEREå­å¥]
    E --&gt;|âå¦ï¼å¨éè¦çâ| H[ä½¿ç¨EXCLUDED.*ææå®ææå­æ®µ]
</div><ul>
<li>ð ä¸¤ç§æ ¸å¿å¤çé»è¾<br>
ä¸ºäºæ¹ä¾¿ä½ å¯¹æ¯åçè§£ï¼æå°å®ä»¬æ»ç»å¨ä¸è¡¨ä¸­ï¼</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: left">å¤çé»è¾</th>
<th style="text-align: left">å³é®å­</th>
<th style="text-align: left">æ ¸å¿è¡ä¸ºä¸ç®ç</th>
<th style="text-align: left">ç±»æ¯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><strong>1. éé»æ¾å¼</strong></td>
<td style="text-align: left"><strong><code>DO NOTHING</code></strong></td>
<td style="text-align: left">å¦æå²çªï¼æ°æ®å·²å­å¨ï¼ï¼å°±<strong>ä»ä¹ä¹ä¸å</strong>ï¼éé»å°ä¿çç°ææ°æ®ï¼å¹¶è®©è¯­å¥æåç»æã</td>
<td style="text-align: left"><strong>âæ è§â</strong>ï¼çå°åºéå·²æåæ ·çååï¼å°±å³å®ä¸æ¾äºï¼ç´æ¥ç¦»å¼ã</td>
</tr>
<tr>
<td style="text-align: left"><strong>2. æ´æ°è¦ç</strong></td>
<td style="text-align: left"><strong><code>DO UPDATE SET ...</code></strong></td>
<td style="text-align: left">å¦æå²çªï¼æ°æ®å·²å­å¨ï¼ï¼å°±ç¨<strong>æ°å¼æ´æ°</strong>å·²æçé£æ¡è®°å½ã</td>
<td style="text-align: left"><strong>âç½®æ¢â</strong>ï¼çå°åºéå·²æåæ ·çååï¼å°±ç¨ä½ æéçæ°æ¬¾æ¿æ¢ææ§æ¬¾ã</td>
</tr>
</tbody>
</table>
<ul>
<li>è¯­æ³1ï¼DO UPDATE SET</li>
</ul>
<pre><code class="language-sql">INSERT INTO è¡¨å (å1, å2, ...)
VALUES (å¼1, å¼2, ...)
ON CONFLICT (å²çªå[å¯ä»¥å¤ä¸ª]) 
DO UPDATE SET
    å1 = EXCLUDED.å1,
    å2 = EXCLUDED.å2,
    ...;
</code></pre>
<ul>
<li>è¯­æ³2ï¼DO NOTHING</li>
</ul>
<pre><code class="language-sql">INSERT INTO table_name (column1, column2, ...)
VALUES (value1, value2, ...)
ON CONFLICT (å²çªå[å¯ä»¥å¤ä¸ª])
DO NOTHING;
</code></pre>
<h2 id="3ç¤ºä¾">3ãç¤ºä¾</h2>
<h3 id="31ç®åç¤ºä¾">3.1ãç®åç¤ºä¾</h3>
<pre><code class="language-sql">-- ç¤ºä¾1: DO NOTHING - ç¡®ä¿æ°æ®å¯ä¸ï¼éå¤åå¿½ç¥
-- åºæ¯ï¼æ¶éç¨æ·é®ç®±ï¼åä¸é®ç®±åªè®°å½ç¬¬ä¸æ¬¡åºç°
INSERT INTO user_emails (email, collected_at, source)
VALUES ('alice@example.com', NOW(), 'å®ç½æ½å¥')
ON CONFLICT (email) 
DO NOTHING; -- å¦æé®ç®±å·²å­å¨ï¼åéé»è·³è¿ï¼ä¸æ¥é

-- ç¤ºä¾2: DO UPDATE SET - ç¨ææ°ä¿¡æ¯è¦çæ§è®°å½
-- åºæ¯ï¼æ´æ°ç¨æ·çæåç»å½ç¶æ
INSERT INTO user_sessions (user_id, last_login_ip, last_login_time, login_count)
VALUES (123, '192.168.1.100', NOW(), 1)
ON CONFLICT (user_id) 
DO UPDATE SET
    last_login_ip = EXCLUDED.last_login_ip, -- ä½¿ç¨æ¬æ¬¡å°è¯æå¥çæ°IP
    last_login_time = EXCLUDED.last_login_time, -- æ´æ°æ¶é´
    login_count = user_sessions.login_count + 1; -- å¨åææ¬¡æ°ä¸ç´¯å 
</code></pre>
<h3 id="32on-conflict-å¤åç»åå¯ä¸çº¦æç¤ºä¾">3.2ãON CONFLICT å¤åç»åå¯ä¸çº¦æç¤ºä¾</h3>
<p><strong>åºæ¯è¯´æ</strong><br>
åè®¾æä»¬æä¸ä¸ª<strong>å­¦çéè¯¾è®°å½è¡¨</strong>ï¼è®¾è®¡é»è¾æ¯ï¼</p>
<ul>
<li>åä¸ªå­¦çå¯ä»¥éå¤é¨è¯¾</li>
<li>åé¨è¯¾ç¨å¯ä»¥è¢«å¤ä¸ªå­¦çé</li>
<li>ä½ <strong>ä¸ä¸ªå­¦çä¸è½éå¤éåä¸é¨è¯¾</strong>ï¼å³ <code>(student_id, course_id)</code> ç»åå¿é¡»å¯ä¸ï¼</li>
</ul>
<p><strong>ç¤ºä¾è¡¨ç»æ</strong></p>
<pre><code class="language-sql">CREATE TABLE student_courses (
    -- èªå¢ä¸»é®ï¼ä½ä¸æ¯ä¸å¡å¯ä¸é®
    id SERIAL PRIMARY KEY,
    student_id INT NOT NULL,
    course_id INT NOT NULL,
    selected_at TIMESTAMP DEFAULT NOW(),
    status VARCHAR(20) DEFAULT 'active',

    -- å³é®ï¼ä¸º(student_id, course_id)åå»ºç»åå¯ä¸çº¦æ
    CONSTRAINT unique_student_course UNIQUE (student_id, course_id)
);
</code></pre>
<p><strong>ç¤ºä¾æ°æ®</strong><br>
åè®¾è¡¨ä¸­å·²ææ°æ®ï¼</p>
<table>
<thead>
<tr>
<th>id</th>
<th>student_id</th>
<th>course_id</th>
<th>selected_at</th>
<th>status</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1001</td>
<td>101</td>
<td>2024-01-01</td>
<td>active</td>
</tr>
<tr>
<td>2</td>
<td>1001</td>
<td>102</td>
<td>2024-01-02</td>
<td>active</td>
</tr>
<tr>
<td>3</td>
<td>1002</td>
<td>101</td>
<td>2024-01-03</td>
<td>active</td>
</tr>
</tbody>
</table>
<p><strong>åºæ¯1ï¼å°è¯éå¤éè¯¾ â ä½¿ç¨ DO NOTHING</strong><br>
å­¦ç1001æ³åæ¬¡éæ©è¯¾ç¨101ï¼å·²å­å¨ï¼ï¼æä»¬éé»æç»ï¼</p>
<pre><code class="language-sql">INSERT INTO student_courses (student_id, course_id, selected_at)
VALUES (1001, 101, NOW()) -- (1001,101)ç»åå·²å­å¨ï¼
ON CONFLICT (student_id, course_id) -- æå®ä¸¤åç»åä¸ºå²çªç®æ 
DO NOTHING; -- ä»ä¹é½ä¸åï¼é²æ­¢éå¤éè¯¾

-- ç»æï¼è¯­å¥æ§è¡æåï¼ä½æ²¡ææå¥æ°è¡
-- è¡¨æ°æ®ä¿æä¸å
</code></pre>
<p><strong>åºæ¯2ï¼å°è¯éå¤éè¯¾ â ä½¿ç¨ DO UPDATE SET</strong><br>
å­¦ç1001éå¤éè¯¾101ï¼ä½æä»¬åè®¸æ´æ°éæ©æ¶é´åç¶æï¼</p>
<pre><code class="language-sql">INSERT INTO student_courses (student_id, course_id, selected_at, status)
VALUES (1001, 101, NOW(), 'renewed') -- åæ¬¡å°è¯éæ©å·²éè¯¾ç¨
ON CONFLICT (student_id, course_id) -- æ£æµ(student_id, course_id)ç»åå²çª
DO UPDATE SET
    selected_at = EXCLUDED.selected_at, -- æ´æ°æ¶é´æ³
    status = EXCLUDED.status, -- æ´æ°ç¶æ
    id = student_courses.id -- ä¿æåidä¸åï¼é¿åä¸»é®å²çª
    
RETURNING *; -- è¿åæ´æ°åçè¡

-- ç»æï¼ä¸ä¼åå»ºæ°è¡ï¼èæ¯æ´æ°id=1çè®°å½
-- å°selected_atæ´æ°ä¸ºå½åæ¶é´ï¼statusæ´æ°ä¸º'renewed'
</code></pre>
<p><strong>åºæ¯3ï¼æ··åæåµå¤ç</strong><br>
æ¹éæå¥éè¯¾è®°å½ï¼å¤çåç§å²çªæåµï¼</p>
<pre><code class="language-sql">INSERT INTO student_courses (student_id, course_id, selected_at)
VALUES 
    (1001, 103, NOW()), -- æ°ç»åï¼æå¥æå
    (1001, 101, NOW()), -- å·²å­å¨ç»åï¼è§¦åON CONFLICT
    (1002, 102, NOW())  -- æ°ç»åï¼æå¥æå
ON CONFLICT (student_id, course_id)
DO UPDATE SET
    selected_at = EXCLUDED.selected_at,
    status = 'refreshed'
RETURNING student_id, course_id, selected_at;
</code></pre>
<p><strong>è¾åºç»æå¯è½ï¼</strong></p>
<pre><code> student_id | course_id |       selected_at       
------------+-----------+-------------------------
       1001 |       103 | 2024-06-15 10:30:00.000  -- æ°æå¥
       1001 |       101 | 2024-06-15 10:30:00.000  -- æ´æ°ï¼å²çªå¤çï¼
       1002 |       102 | 2024-06-15 10:30:00.000  -- æ°æå¥
</code></pre>
<h3 id="33å¶ä»å¤åå¯ä¸çº¦æç¤ºä¾">3.3ãå¶ä»å¤åå¯ä¸çº¦æç¤ºä¾</h3>
<p>ç¤ºä¾1ï¼ä¼è®®å®¤é¢è®¢ç³»ç»</p>
<pre><code class="language-sql">-- ç¡®ä¿åä¸ä¼è®®å®¤å¨åä¸æ¶é´æ®µä¸è¢«éå¤é¢è®¢
-- å¯ä¸çº¦æï¼(room_id, date, time_slot)
INSERT INTO room_bookings (room_id, date, time_slot, booker_name)
VALUES (101, '2024-06-20', '09:00-10:00', 'å¼ ä¸')
ON CONFLICT (room_id, date, time_slot)
DO NOTHING; -- æ¶é´æ®µå²çªåç´æ¥æç»
</code></pre>
<p><strong>ç¤ºä¾2ï¼ç¨æ·-äº§åè¯åè¡¨</strong></p>
<pre><code class="language-sql">-- ç¡®ä¿ä¸ä¸ªç¨æ·å¯¹åä¸äº§ååªè½è¯åä¸æ¬¡
-- å¯ä¸çº¦æï¼(user_id, product_id)
INSERT INTO product_ratings (user_id, product_id, rating, review)
VALUES (5001, 3005, 5, 'éå¸¸å¥½ç¨')
ON CONFLICT (user_id, product_id)
DO UPDATE SET
    rating = EXCLUDED.rating,
    review = EXCLUDED.review,
    rated_at = NOW();
</code></pre>
<p><strong>å³é®è¦ç¹æ»ç»</strong></p>
<ol>
<li><strong>è¯­æ³æ ¼å¼</strong>ï¼<code>ON CONFLICT (column1, column2, ...)</code> ç¨æ¬å·åå«å¤ä¸ªå</li>
<li><strong>çº¦æè¦æ±</strong>ï¼è¿äºåå¿é¡»å·²å®ä¹ç»åå¯ä¸çº¦æï¼å¯ä»¥æ¯å¤åä¸»é®æå¤åå¯ä¸çº¦æï¼</li>
<li><strong>å²çªæ£æµ</strong>ï¼åªæå½<strong>æææå®åçå¼é½å®å¨å¹é</strong>æ¶ï¼æè¢«è®¤ä¸ºæ¯å²çª</li>
<li><strong>å¸¸è§åºæ¯</strong>ï¼å¤å¯¹å¤å³ç³»è¡¨ãæ¶é´-èµæºç»åãç¨æ·-å®ä½å³èè¡¨ç­</li>
</ol>
<p>è¿ç§å¤åçº¦æç¹å«éåå¤ç<strong>ä¸å¡å±é¢çç»åå¯ä¸æ§è¦æ±</strong>ï¼èä¸ä»ä»æ¯ææ¯ä¸çä¸»é®å¯ä¸æ§ã</p>
<h2 id="4ç¹æ®åæ°è§£æå²çªåå¯ä»¥å¤ä¸ª">4ãç¹æ®åæ°è§£æï¼å²çªå[å¯ä»¥å¤ä¸ª]</h2>
<ul>
<li>ON CONFLICT åé¢å¿é¡»æå®ä¸ä¸ªï¼å¯ä¸çº¦æï¼ä¸»é®ä¹å¯ä»¥ï¼å­æ®µ
<ul>
<li>å¤ä¸ªå­æ®µå¯ä¸ä¹å¯ä»¥</li>
</ul>
</li>
</ul>
<p><strong>å³é®æºå¶</strong>ï¼</p>
<ul>
<li>
<p><strong>å²çªç®æ </strong>ï¼<code>ON CONFLICT</code> åé¢å¿é¡»æå®ä¸ä¸ª<strong>å¯ä¸çº¦æ</strong>ï¼éå¸¸æ¯ä¸»é®æå¯ä¸ç´¢å¼ãå½æå¥çæ°æ®å¨è¿ä¸ªçº¦æä¸ä¸å·²ææ°æ®å²çªæ¶ï¼å°±ä¼è§¦å <code>UPDATE</code> æä½ã</p>
</li>
<li>
<p><strong>çº¦æè¦æ±ï¼è¿äºåå¿é¡»å·²å®ä¹ç»åå¯ä¸çº¦æï¼å¯ä»¥æ¯å¤åä¸»é®æå¤åå¯ä¸çº¦æï¼</strong></p>
</li>
<li>
<p><strong>EXCLUDED ä¼ªè¡¨</strong>ï¼å¨ <code>DO UPDATE SET</code> å­å¥ä¸­ï¼ä½ å¯ä»¥ä½¿ç¨ <code>EXCLUDED.åå</code> æ¥å¼ç¨<strong>æ¬æ¬¡å°è¯æå¥ä½åçäºå²çªçé£äºå¼</strong>ï¼è¿æ¯å®ç°âç¨æ°å¼è¦çæ§å¼âçå³é®ã</p>
</li>
</ul>
<h2 id="returningåæ°è§ä¸ç¯">RETURNINGåæ°ï¼è§ä¸ç¯</h2>

</div>
<div class="clear"></div>

        </div>
        <p class="postfoot">
            posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-27 15:16">2026-01-27 15:16</span>&nbsp;
<a href="https://www.cnblogs.com/kakarotto-chen">C_C_èå­</a>&nbsp;
éè¯»(<span id="post_view_count">165</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19538290);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19538290', targetLink: 'https://www.cnblogs.com/kakarotto-chen/p/19538290', title: 'PostgreSQLï¼æ°å¢è¯­å¥ï¼ç¹æ®å¤çï¼ON CONFLICT ... DO (UPDATE SET ...)/(NOTHING)' })">ä¸¾æ¥</a>

        </p>
     ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ langchain å¿«éå¥é¨(å­)ï¼å®ç°å¤agentåä½ ]]></title>
    <link>https://www.cnblogs.com/ClownLMe/p/19538384</link>
    <guid>a55fa62c8a99c520f70c892055473189</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ClownLMe/p/19538384" title="åå¸äº 2026-01-27 14:27">
    <span role="heading" aria-level="2">langchain å¿«éå¥é¨(å­)ï¼å®ç°å¤agentåä½</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ç®ä»">ç®ä»</h1>
<p><strong>å¤Agentåä½</strong>è½å¤å°ä¸ä¸ªå¤æçä»»å¡æè§£æä¸ä¸ªä¸ªå­ä»»å¡ç»ä¸é¨çagentï¼è½å¤è§£å³å¤æé®é¢ï¼å®ç°å¤æçaiå·¥ä½æµã</p>
<h1 id="å¤agentåä½">å¤Agentåä½</h1>
<p>ä¸åçAgentï¼æä¸åçè½åï¼æä»¬å¯è½ä¼æåç§å®ééæ±ï¼ä¾å¦ï¼å®æ¶è¯å«è½¦çä½ç½®ï¼Yoloï¼-&gt;è¯å«è½¦çåå®¹ï¼qwen-vlï¼-&gt; LLMç®¡çè®°å½è½¦çä¿¡æ¯ãéè¿å¤Agentåä½çå·¥ä½æµï¼è½å¤å®ç°æç§ç­é¢ï¼èªå¨åªè¾ï¼pptçæç­ä¸ç³»åå¤æé®é¢ã</p>
<p>ä¸é¢ç¨ä¸ä¸ªç®åçæ¡ä¾ï¼æ¥è¯´æã</p>
<h1 id="ç®åçå¤agentåä½">ç®åçå¤Agentåä½</h1>
<h3 id="ç¤ºä¾">ç¤ºä¾</h3>
<p>éæ±ï¼æ¥ä¸ä¸é¿éãè¾è®¯ãç¾åº¦çPEï¼å¹¶è®¡ç®å¹³åå¼ã</p>
<pre><code class="language-python">import os
import operator
from pydantic import BaseModel, Field
from langchain_community.chat_models.tongyi import ChatTongyi
from langchain_core.tools import tool
from langchain_core.messages import HumanMessage, BaseMessage, ToolMessage, SystemMessage
from langchain_core.prompts import ChatPromptTemplate, MessagesPlaceholder
from typing import Annotated, List, Literal, TypedDict
from langgraph.graph import StateGraph, END

os.environ["DASHSCOPE_API_KEY"] = "apikey"
llm = ChatTongyi(model="qwen-plus")

@tool
def web_search(query: str):
    """ç¨äºæ¥æ¾ææ°çè¡ç¥¨æ°æ®ãå¬å¸è´¢æ¥ä¿¡æ¯ã"""
    results = []
    if "é¿é" in query: results.append("é¿éå·´å·´(BABA) PE: 15.5")
    if "è¾è®¯" in query: results.append("è¾è®¯æ§è¡(0700) PE: 18.2")
    if "ç¾åº¦" in query: results.append("ç¾åº¦(BIDU) PE: 11.8")
    
    if not results:
        return "æªæ¾å°æ°æ®"
    return " ; ".join(results)

@tool
def python_calculator(code: str):
    """ç¨äºè®¡ç®ãè¾å¥å¿é¡»æ¯ python ä»£ç ã"""
    try:
        result = eval(code)
        return f"è®¡ç®ç»æ: {result}"
    except Exception as e:
        return f"è®¡ç®éè¯¯: {e}"

def create_agent(state: dict, llm, tools, system_prompt):
    llm_tools = llm.bind_tools(tools)
    
    prompt = [SystemMessage(content=system_prompt)] + state["messages"]
    response = llm_tools.invoke(prompt)

    results = [response]

    for tool_call in response.tool_calls:
        func_name = tool_call["name"]
        args = tool_call["args"]
        call_id = tool_call["id"]
        
        func = next((t for t in tools if t.name == func_name), None)

        if func:
            tool_output = func.invoke(args)
            tool_msg = ToolMessage(
                content=str(tool_output),
                name=func_name,
                tool_call_id=call_id
            )
            results.append(tool_msg)

    return {"messages": results}

class State(TypedDict):
    messages: Annotated[List[BaseMessage], operator.add]
    next: str

def researcher_node(state):
    return create_agent(
        state=state,
        llm=llm,
        tools=[web_search],
        system_prompt="ä½ æ¯ä¸ä¸ªç ç©¶åãåªè´è´£æ¥æ°æ®ï¼æ¾å°æ°æ®åç´æ¥è¾åºåè¯ï¼ä¸éè¦è®¡ç®ã"
    )

def coder_node(state):
    return create_agent(
        state=state,
        llm=llm,
        tools=[python_calculator],
        system_prompt="ä½ æ¯ä¸ä¸ªç¨åºåãæ ¹æ®ä¸é¢ç ç©¶åæ¥å°çæ°æ®ï¼åä»£ç è®¡ç®å¹³åå¼ã"
    )

def finish_node(state):
    return create_agent(
        state=state,
        llm=llm,
        tools=[],
        system_prompt="ä»»å¡å®æï¼ç®ç­çæ»ç»æç»ç»æã"
    )

def supervisor_node(state):
    system_prompt = (
        "ä½ æ¯é¡¹ç®ç»çãæ ¹æ®å¯¹è¯åå²å³å®ä¸ä¸æ­¥äº¤ç»è°ã"
        "æ¥æ°æ®æ¾ Researcherï¼è®¡ç®æ¾ Coderï¼è¯å«å¾çæ¾ Photographerã"
        "å¦æä»»å¡å®æï¼å¿é¡»éæ© FINISHã"
    )

    prompt = ChatPromptTemplate.from_messages([
        ("system", system_prompt),
        MessagesPlaceholder(variable_name="messages"),
        ("system", "æ ¹æ®ä»¥ä¸æåµï¼è¯·ååºéæ©ã"),
    ])

    class RouteResponse(BaseModel):
        next: Literal["Researcher", "Coder", "FINISH"] = Field(
            ..., 
            description="ä¸ä¸æ­¥äº¤ç»è°ï¼å¦æä»»å¡å®æè¯·é FINISH"
        )

    chain = prompt | llm.with_structured_output(RouteResponse)

    response = chain.invoke(state)

    return {"next": response.next}

def init_agent():
    workflow = StateGraph(State)
    workflow.add_node("Researcher", researcher_node)
    workflow.add_node("Coder", coder_node)
    workflow.add_node("Supervisor", supervisor_node)
    workflow.add_node("Finish", finish_node)

    workflow.add_edge("Researcher", "Supervisor")
    workflow.add_edge("Coder", "Supervisor")
    workflow.add_edge("Finish", END)
    workflow.add_conditional_edges(
        "Supervisor",
        lambda state: state["next"],{
        "Researcher": "Researcher",
        "Coder": "Coder",
        "FINISH": "Finish",
    })

    workflow.set_entry_point("Supervisor")

    return workflow.compile()

if __name__ == "__main__":
    agent = init_agent()
    for result in agent.stream({
        "messages": [HumanMessage(content="æ¥ä¸ä¸é¿éãè¾è®¯ãç¾åº¦çPEï¼å¹¶è®¡ç®å¹³åå¼ã")]
        }):
        for key, value in result.items():
            if key == "Supervisor":
                print("[" + key + "] å»å: " + value["next"])
            else:
                print("[" + key + "] åå¤: " + value['messages'][-1].content)

</code></pre>
<h3 id="ä»£ç è§£é">ä»£ç è§£é</h3>
<p>ä»£ç ä¸å±ç¨å°äº4ä¸ªagentï¼</p>
<ol>
<li>agent Researcherï¼å¶æä¸ä¸ªå·¥å·ï¼è´è´£æç´¢æäºåå®¹</li>
<li>agent coderï¼å¶æä¸ä¸ªå·¥å·ï¼è´è´£è¿è¡ç²¾ç¡®è®¡ç®</li>
<li>agent finishï¼å¶æ²¡æå·¥å·ï¼è´è´£æ»ç»åå®¹</li>
<li>agent Supervisorï¼å¶æ²¡æå·¥å·ï¼è´è´£ç®¡çä¸é¢3ä¸ªagentï¼å³å®ä»»å¡çå»å<br>
ä¸é¢æ¡ä¾ä½¿ç¨çæ¯langgraphç»ä»¶ï¼è¿éå°±ä¸è¯¦ç»è®²è§£äºï¼è¯·çä¹åæç« ã</li>
</ol>
<p><strong>ä»£ç æµç¨ï¼</strong> åå§åå·¥å·åº-&gt;åå§åagent-&gt;æå»ºå¾-&gt;è¿è¡</p>
<h3 id="åå§åå·¥å·åº">åå§åå·¥å·åº</h3>
<pre><code class="language-python">@tool
def web_search(query: str):
    """ç¨äºæ¥æ¾ææ°çè¡ç¥¨æ°æ®ãå¬å¸è´¢æ¥ä¿¡æ¯ã"""
    results = []
    if "é¿é" in query: results.append("é¿éå·´å·´(BABA) PE: 15.5")
    if "è¾è®¯" in query: results.append("è¾è®¯æ§è¡(0700) PE: 18.2")
    if "ç¾åº¦" in query: results.append("ç¾åº¦(BIDU) PE: 11.8")
    
    if not results:
        return "æªæ¾å°æ°æ®"
    return " ; ".join(results)

@tool
def python_calculator(code: str):
    """ç¨äºè®¡ç®ãè¾å¥å¿é¡»æ¯ python ä»£ç ã"""
    try:
        result = eval(code)
        return f"è®¡ç®ç»æ: {result}"
    except Exception as e:
        return f"è®¡ç®éè¯¯: {e}"
</code></pre>
<p>è¿éç<code>web_search</code>ä½¿ç¨çæ¯èåçæ¨¡æä¿¡æ¯ï¼ä¸é¢çå·¥å·æè¿°ä¸å¤å®æ´ï¼ä½æ¯è½ç¨ï¼å¦æç¨å®éæ¡ä¾ï¼è¯·æè¿°å®æ´ï¼å·¥å·çæè¿°åèä¹åæç« ã</p>
<h1 id="åå§åagent">åå§åagent</h1>
<h5 id="å¶ä»3ä¸ªagent">å¶ä»3ä¸ªagent</h5>
<pre><code class="language-python">def create_agent(state: dict, llm, tools, system_prompt):
    llm_tools = llm.bind_tools(tools)
    
    prompt = [SystemMessage(content=system_prompt)] + state["messages"]
    response = llm_tools.invoke(prompt)

    results = [response]

    for tool_call in response.tool_calls:
        func_name = tool_call["name"]
        args = tool_call["args"]
        call_id = tool_call["id"]
        
        func = next((t for t in tools if t.name == func_name), None)

        if func:
            tool_output = func.invoke(args)
            tool_msg = ToolMessage(
                content=str(tool_output),
                name=func_name,
                tool_call_id=call_id
            )
            results.append(tool_msg)

def researcher_node(state):
    return create_agent(
        state=state,
        llm=llm,
        tools=[web_search],
        system_prompt="ä½ æ¯ä¸ä¸ªç ç©¶åãåªè´è´£æ¥æ°æ®ï¼æ¾å°æ°æ®åç´æ¥è¾åºåè¯ï¼ä¸éè¦è®¡ç®ã"
    )

def coder_node(state):
    return create_agent(
        state=state,
        llm=llm,
        tools=[python_calculator],
        system_prompt="ä½ æ¯ä¸ä¸ªç¨åºåãæ ¹æ®ä¸é¢ç ç©¶åæ¥å°çæ°æ®ï¼åä»£ç è®¡ç®å¹³åå¼ã"
    )

def finish_node(state):
    return create_agent(
        state=state,
        llm=llm,
        tools=[],
        system_prompt="ä»»å¡å®æï¼ç®ç­çæ»ç»æç»ç»æã"
    )
</code></pre>
<p>æµç¨ç¸å¯¹ç®åï¼<code>create_agent</code>ç»èåé¢æç« å·²ç»è®²è§£ï¼è¿éå°±ä¸åºè¯äºã</p>
<h5 id="ç®¡çagent">ç®¡çagent</h5>
<pre><code class="language-python">def supervisor_node(state):
    system_prompt = (
        "ä½ æ¯é¡¹ç®ç»çãæ ¹æ®å¯¹è¯åå²å³å®ä¸ä¸æ­¥äº¤ç»è°ã"
        "æ¥æ°æ®æ¾ Researcherï¼è®¡ç®æ¾ Coderï¼è¯å«å¾çæ¾ Photographerã"
        "å¦æä»»å¡å®æï¼å¿é¡»éæ© FINISHã"
    )

    prompt = ChatPromptTemplate.from_messages([
        ("system", system_prompt),
        MessagesPlaceholder(variable_name="messages"),
        ("system", "æ ¹æ®ä»¥ä¸æåµï¼è¯·ååºéæ©ã"),
    ])

    class RouteResponse(BaseModel):
        next: Literal["Researcher", "Coder", "FINISH"] = Field(
            ..., 
            description="ä¸ä¸æ­¥äº¤ç»è°ï¼å¦æä»»å¡å®æè¯·é FINISH"
        )

    chain = prompt | llm.with_structured_output(RouteResponse)

    response = chain.invoke(state)

    return {"next": response.next}
</code></pre>
<p>è¿ä¸æ­¥éè¦ç®åè¯´æï¼</p>
<pre><code class="language-python">class RouteResponse(BaseModel):
    next: Literal["Researcher", "Coder", "FINISH"] = Field(
        ..., 
        description="ä¸ä¸æ­¥äº¤ç»è°ï¼å¦æä»»å¡å®æè¯·é FINISH"
    )
chain = prompt | llm.with_structured_output(RouteResponse)
</code></pre>
<ul>
<li>LLMä¸­ç<code>with_structured_output</code>æ¹æ³æ¯langchainæä¾çä¸ä¸ªç»ä»¶ï¼åè½æ¯ï¼éå®LLMçè¾åºæ ¼å¼ï¼è¿åç¸åºæ ¼å¼çå­å¸ã</li>
<li>å®ä¹è¾åºæ ¼å¼éå®çç±»ï¼</li>
</ul>
<ol>
<li>è¯¥ç±»æ¯<code>BaseModel</code>çå­ç±»</li>
<li><code>Literal</code>æ¯éæ©ï¼è¦æ±aiä»<code>"Researcher", "Coder", "FINISH"</code>ä¸éä¸</li>
<li><code>Field</code>æè¿°åéï¼å°½éè¯¦å°½ï¼æè¿°+ä¾å­ï¼å ä¸ºæ¯ç»å¤§æ¨¡åçç</li>
</ol>
<pre><code class="language-python">class classname(BaseModel):
	fieldname: fieldtype = Field(..., description="æè¿°")
</code></pre>
<h3 id="æå»ºå¾éè¦">æå»ºå¾ï¼éè¦ï¼</h3>
<pre><code class="language-python">def init_agent():
    workflow = StateGraph(State)
    workflow.add_node("Researcher", researcher_node)
    workflow.add_node("Coder", coder_node)
    workflow.add_node("Supervisor", supervisor_node)
    workflow.add_node("Finish", finish_node)

    workflow.add_edge("Researcher", "Supervisor")
    workflow.add_edge("Coder", "Supervisor")
    workflow.add_edge("Finish", END)
    workflow.add_conditional_edges(
        "Supervisor",
        lambda state: state["next"],{
        "Researcher": "Researcher",
        "Coder": "Coder",
        "FINISH": "Finish",
    })

    workflow.set_entry_point("Supervisor")

    return workflow.compile()
</code></pre>
<p>è¿ä¸æ­¥ç¸å½äºè¿æ¥å·¥ä½æµï¼æå»ºçæµç¨å¾å¦ä¸ï¼</p>
<pre><code>       +---------------------------+
       |           å¼å§             |
       +-------------+-------------+
                     |
                     v
       +---------------------------+
       |       Supervisor          |&lt;----------------+
       | (éè¿å½åä»»å¡ç¶æï¼è¿ånext) |                 |
       +-------------+-------------+                 |
                     |(æ ¹æ®stateä¸­nextå¤æ­å»å)        |
        _____________|_____________                  |
       /             |             \                 |
      /              |              \                |
     v               v               v               |
+------------+  +------------+  +------------+       |
| Researcher |  |   Coder    |  |   Finish   |       |
|  (Agent)   |  |  (Agent)   |  | (Cleanup)  |       |
+-----+------+  +-----+------+  +-----+------+       |
      |               |               |              |
      |               |               v              |
      |               |         +------------+       |
      +---------------+         |    END     |       |
              |                 +------------+       |
              |                                      |
              +--------------------------------------+
                    (è¿åéæ°éæ©ä¸ä¸ä¸ªagent)
</code></pre>
<p><strong>å¦æâ¤åæ¬¢â¤æ¬ç³»åæç¨ï¼å°±ç¹ä¸ªå³æ³¨å§ï¼åç»­ä¸å®ææ´æ°~</strong></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-27 14:27">2026-01-27 14:27</span>&nbsp;
<a href="https://www.cnblogs.com/ClownLMe">ClownLMe</a>&nbsp;
éè¯»(<span id="post_view_count">158</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19538384);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19538384', targetLink: 'https://www.cnblogs.com/ClownLMe/p/19538384', title: 'langchain å¿«éå¥é¨(å­)ï¼å®ç°å¤agentåä½' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ spring boot3--èªå¨éç½®ä¸æå¨éç½® ]]></title>
    <link>https://www.cnblogs.com/alineverstop/p/19537574</link>
    <guid>9ff822068362e07855fc8610b6b6725e</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/alineverstop/p/19537574" title="åå¸äº 2026-01-27 11:50">
    <span role="heading" aria-level="2">spring boot3--èªå¨éç½®ä¸æå¨éç½®</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="springbootèªå¨éç½®">springbootèªå¨éç½®</h1>
<p>èªå¨éç½®äºå¤§éç»ä»¶ï¼éç½®ä¿¡æ¯å¯ä»¥å¨application.propertiesæä»¶ä¸­ä¿®æ¹ã</p>
<p>å½æ·»å äºç¹å®çStarter POMåï¼springbootä¼æ ¹æ®ç±»è·¯å¾ä¸çjaråæ¥èªå¨éç½®beanï¼æ¯å¦ï¼springbootåç°ç±»è·¯å¾ä¸çMyBatisç¸å³ç±»ï¼springbootä¼èªå¨éç½®MyBatisç¸å³çbeanï¼ã</p>
<p>springbootä½¿ç¨é»è®¤éç½®æ¥è®¾ç½®è¿äºåè½ï¼å¼åäººåä¹å¯ä»¥èªå®ä¹éç½®æ¥è¦çé»è®¤éç½®ã</p>
<h2 id="è¿äºéç½®ä¿¡æ¯å¦ä½çæç">è¿äºéç½®ä¿¡æ¯å¦ä½çæçï¼</h2>
<p>éè¿@ConfigurationPropertiesæ³¨è§£å°éç½®ä¿¡æ¯æ³¨å¥å°ç»ä»¶ä¸­çå±æ§ç±»çãå±æ§ç±»ä¸è¬ä»¥Propertiesç»å°¾ãæ¯å¦tomcatç»ä»¶çServerPropertiesç±»ï¼å°±æ¯å°éç½®ä¿¡æ¯ä¸­serverå¼å¤´çéç½®æ³¨å¥å°å±æ§ä¸­ï¼æ¯å¦server.port=8080ä¼è¢«ç»å®å°å±æ§ä¸­</p>
<pre><code class="language-java">@ConfigurationProperties("server")
public class ServerProperties {
    private @Nullable Integer port;
    private @Nullable InetAddress address;
  .....
}
</code></pre>
<h2 id="èªå¨éç½®æ¯æéå è½½ç">èªå¨éç½®æ¯æéå è½½ç</h2>
<p>springbootæä¾å¾å¤èªå¨éç½®ç±»ï¼è¿äºèªå¨éç½®ä¸æ¯å¨é¨çæï¼å®æ¯æéå è½½çï¼å¯¼å¥äºåªä¸ªå¯å¨å¨ï¼åè¯¥å¯å¨å¨å¯¹åºçéç½®ç±»æä¼è¢«å è½½ã</p>
<p>ä»»ä½å¯å¨å¨é½ä¼å³èä¸ä¸ªå¯å¨å¨ï¼spring-boot-Starterï¼å®æ¯springbootæ¡æ¶ææ ¸å¿çå¯å¨å¨ã</p>
<p>spring-boot-Starteråå³èå¼å¥spring-boot-autoä»figureãææçèªå¨éç½®ç±»é½å¨è¿éã</p>
<p>èªå¨éç½®ç±»ç¨æ¥åå»ºç¸åºçç»ä»¶ã</p>
<h2 id="æéå è½½å¦ä½å®ç°">æéå è½½å¦ä½å®ç°ï¼</h2>
<p>ä½¿ç¨æ¡ä»¶æ³¨è§£å¯ä»¥å®ç°æéå è½½ã</p>
<p>æ¡ä»¶æ³¨è§£åºäºæäºæ¡ä»¶å³å®æ¯å¦åºè¯¥åå»ºä¸ä¸ªbeanãè¿äºæ³¨è§£éå¸¸ç¨å¨èªå¨éç½®ç±»ä¸ï¼ä»¥ç¡®ä¿åªæå¨ç¹å®æ¡ä»¶æ»¡è¶³æ¶æä¼åºç¨ç¸åºçéç½®ã</p>
<p>æ¡ä»¶æ³¨è§£å¯ä»¥ç¨å¨ç±»ä¸ï¼ä¹å¯ä»¥ç¨å¨æ¹æ³ä¸ã</p>
<p>å¸¸è§çæ¡ä»¶æ³¨è§£æï¼</p>
<ul>
<li>@ConditionalOnClass æå®ç±»å­å¨æ¶æåå»ºbean</li>
<li>@ConditionalOnMissingClass æå®ç±»ä¸å­å¨æ¶æåå»ºbean</li>
<li>@ConditionalOnBean å®¹å¨ä¸­å­å¨æå®beanæ¶æåå»ºbean</li>
<li>@ConditionalOnMissingBean å®¹å¨ä¸­ä¸å­å¨æå®beanæ¶æåå»ºbean</li>
<li>@ConditionalOnProperty éç½®æä»¶ä¸­å­å¨æå®å±æ§æ¶ï¼æåå»ºbean</li>
<li>@ConditionalOnResource æå®èµæºå­å¨æ¶æåå»ºbean</li>
<li>@ConditionalOnWebApplication åºç¨ç¨åºæ¯Webåºç¨æ¶æåå»ºbean</li>
<li>@ConditionalOnNotWebApplication åºç¨ç¨åºä¸æ¯Webåºç¨æ¶æåå»ºbean</li>
</ul>
<h2 id="ä¿®æ¹é»è®¤çåæ«æè§å">ä¿®æ¹é»è®¤çåæ«æè§å</h2>
<p>ä¿®æ¹æ«æè§åæ2ç§æ¹å¼ï¼</p>
<p>å¨ä¸»å¥å£ç±»ä¸æ·»å ä»¥ä¸æ³¨è§£çä»»æä¸ä¸ªé½å¯ä»¥ä¿®æ¹åæ«æè§åï¼æ«æcomååå¶å­å­åï¼</p>
<ol>
<li>
<pre><code class="language-java">@ComponentScan("com")
</code></pre>
</li>
<li>
<pre><code class="language-java">@SpringBootApplication(scanBasePackages = "com")
</code></pre>
</li>
</ol>
<h1 id="èªå¨éç½®çå®ç°åç">èªå¨éç½®çå®ç°åç</h1>
<ol>
<li>
<p>ç¨åºä»mainæ¹æ³å¼å§æ§è¡ï¼ä¸»å¥å£ç±»ä¸ä½¿ç¨@SpringBootApplicationè¿è¡æ æ³¨</p>
</li>
<li>
<p>@SpringBootApplicationæ¯å¤åæ³¨è§£ï¼ä»£è¡¨ä»¥ä¸ä¸ä¸ªæ³¨è§£çåè½</p>
<p>a. @SpringBootConfiguration:å®è¢«@Configurationæ æ³¨ãè¡¨æä¸»å¥å£ç±»æ¯ä¸ä¸ªéç½®ç±»ï¼æ­¤æ¶è¯¥éç½®å¼å§å è½½ã</p>
<p>b. @ComponentScan é»è®¤æ«æä¸»å¥å£ç±»æå¨ååå¶å­å­åï¼å æ­¤spring-boot-autoconfigure èªå¨éç½®ç±»æ¯æ æ³å è½½çï¼é£ä¹è¿äºèªå¨éç½®ç±»åæ¯æä¹çæçå¢ï¼</p>
<p>c. <strong>@EnableAutoConfiguration è¯¥æ³¨è§£çä½ç¨å°±æ¯å¯ç¨èªå¨éç½®</strong></p>
</li>
<li>
<p>@EnableAutoConfiguration  è¢«@Import({AutoConfigurationImportSelector.class})æ æ³¨</p>
</li>
</ol>
<p>â        @Import({AutoConfigurationImportSelector.class})çä½ç¨æ¯å°AutoConfigurationImportSelectorä½ä¸ºä¸ä¸ªbeanå è½½å°Iocå®¹å¨ä¸­</p>
<p>â        è¿ä¸ªbeançä½ç¨æ¯ï¼è´è´£æ¶éåéæ©ææç¬¦åæ¡ä»¶çèªå¨éç½®ç±»ã</p>
<h2 id="æ»ç»">æ»ç»</h2>
<ol>
<li>è¿è¡ç¯å¢åå¤é¶æ®µ
<ul>
<li>å¼å¥Webå¯å¨å¨</li>
<li>æç»ä¼ éå¼å¥äºèªå¨éç½®çjarå</li>
<li>èªå¨éç½®çjaråä¸­æ152ä¸ªèªå¨éç½®ç±»ï¼å°æ­¤è¿è¡ç¯å¢åå¤å®æ¯</li>
</ul>
</li>
<li>è¿è¡é¶æ®µ
<ul>
<li>@EnableAutoConfiguration  å¯ç¨èªå¨éç½®ï¼å°152ä¸ªèªå¨éç½®ç±»å¨é¨å è½½å°Iocå®¹å¨ä¸­ãç¶åæ ¹æ®å¼ååºæ¯ç­éåºå¿é¡»å¾èªå¨éç½®ç±»</li>
<li>èªå¨éç½®ç±»å è½½äºå¾å¤ç»ä»¶</li>
<li>æ¯ä¸ªç»ä»¶éè¦çæ°æ®æ¥èªå±æ§ç±»</li>
<li>å±æ§ç±»çå±æ§æ¥èªéç½®æä»¶</li>
</ul>
</li>
</ol>
<p>æ»ä¹ä¸å¥è¯ãå¯¼å¥å¯å¨å¨ï¼ä¿®æ¹éç½®æä»¶ãå°±å¯ä»¥å®æå¯¹åºåè½çå¼åã</p>
<h1 id="springmvcéç½®">springmvcéç½®</h1>
<pre><code class="language-properties"># è®©springbootçéæèµæºå¤çå¤±æ
spring.web.resources.add-mappings=false
# éç½®éæèµæºçè®¿é®URL
spring.mvc.static-path-pattern=/**
#  éæèµæºæä»¶å­å¨ä½ç½®é»è®¤éç½®
spring.web.resources.static-locations=classpath:/META-INF/resources/, classpath:/resources/, classpath:/static/, classpath:/public/

</code></pre>
<p>springbootå¯¹éæèµæºæ¯å¦ä½å¤ççï¼</p>
<p>ä»ä¹æ ·çURL ï¼è®¿é®åªä¸ªä½ç½®ä¸çèµæºæä»¶ï¼</p>
<h2 id="webjars">webjars</h2>
<p>webjarsæ¯ç°å¨ååç«¯åç¦»ä¸­æ¯è¾éè¦çä¸ç§éæèµæºæåæ¹å¼ã</p>
<p>webjarsæ¯ä¸ç§å¸¸ç¨çåç«¯åºï¼å¦jQueryï¼æåæjaråçå½¢å¼ï¼æ¹ä¾¿å¨javaç¨åºä¸­ä½¿ç¨ã</p>
<p>webjarsæä¾äºä¸ç§æ ååçæ¹å¼æ¥ç®¡çåç«¯åºï¼ä½¿å¶æ´å®¹æéæå°javaé¡¹ç®ä¸­ï¼å¹¶ä¸å¯ä»¥å©ç¨Mavençä¾èµç®¡çåè½ã</p>
<pre><code class="language-xml">&lt;!--        webjars,å°åç«¯åºææjarå--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.webjars.npm&lt;/groupId&gt;
            &lt;artifactId&gt;vue&lt;/artifactId&gt;
            &lt;version&gt;3.5.12&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre>
<p>é»è®¤è§åæ¯ï¼å½è¯·æ±è·¯å¾æ¯/wbjars/**,åä¼å»classpath:/MEAT-INF/resources/webjars/æ¾ã</p>
<h2 id="éæèµæºç¼å­å¤ç">éæèµæºç¼å­å¤ç</h2>
<p>éæèµæºç¼å­æ¯ææµè§å¨çç¼å­è¡ä¸ºï¼æµè§å¨å¯ä»¥ç¼å­ï¼jsãCSSãå¾çãå£°é³ãè§é¢ï¼å°æµè§å¨ä¸­ï¼ä¸ä¸æ¬¡ç¨æ·è®¿é®åæ ·çèµæºå°±ç´æ¥ä»ç¼å­ä¸­è·åï¼ä¸åä»æå¡å¨è·åï¼è¿æ ·è½åå°æå¡å¨ååï¼æé«ç¸åºæçã</p>
<p>å¯ä»¥éè¿éç½®æ¥ä¿®æ¹é»è®¤çç¼å­æºå¶ã</p>
<pre><code class="language-properties">ï¼éæèµæºç¼å­è®¾ç½®
ï¼ç¼å­æææè®¾ç½®
spring.web.resources.cache.period=3600
# ç¼å­æ§å¶è®¾ç½®
spring.web.resources.cache.cachecontrol.max-age=20
# æ¯å¦å¯ç¨æåä¸æ¬¡ä¿®æ¹æ¶é´çæ¯å¯¹
spring.web.resources.cache.use-last-modified=true
</code></pre>
<h2 id="éæindexhtmlçæ¯æ">éæindex.htmlçæ¯æ</h2>
<p>springä¼èªå¨å¤çä½äºéæèµæºç®å½ä¸çindex.htmlï¼æä»¶åå¿é¡»æ¯index.htmlï¼ï¼ä½¿å¶æä¸ºåºç¨ç¨åºçä¸»é¡µã</p>
<p>æ³¨æï¼æ­¤æ¶ä¸è½éç½®éæèµæºè®¿é®urlï¼spring.mvc.static-path-patternï¼ï¼å¿é¡»ä½¿ç¨é»è®¤çéç½®</p>
<h2 id="faviconico">favicon.ico</h2>
<p>å°favicon.icoæ¾å¨éæèµæºæ ¹ç®å½ä¸ï¼å°±ä¼èªå¨çæã</p>
<h1 id="spring-bootçwebæå¨éç½®éæèµæºå¤ç">spring bootçwebæå¨éç½®ï¼éæèµæºå¤çï¼</h1>
<h2 id="ç¼åä»£ç çæ¹å¼">ç¼åä»£ç çæ¹å¼</h2>
<h3 id="ç¬¬ä¸ç§æ¹å¼-å®ç°webmvcconfigureræ¥å£">ç¬¬ä¸ç§æ¹å¼ å®ç°WebMvcConfigureræ¥å£</h3>
<pre><code class="language-java">// æ·»å è¿ä¸ªæ³¨è§£åï¼è¡¨ç¤ºä¸åä½¿ç¨springbootæä¾çé»è®¤éç½®
// @EnableWebMvc
@Configuration
public class WebConfig implements WebMvcConfigurer {
    
    // éæèµæºå¤çéè¦éåçæ¹æ³
    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        // ä½¿ç¨æ³¨åå¨registry ç»å® pathPatterns ä»¥åçå®çéæèµæºæä»¶å­å¨è·¯å¾
        registry.addResourceHandler("/abc/**") // éç½®è·¯å¾è®¿é®æ¨¡å¼
                .addResourceLocations("classpath:/static1/", "classpath:/static2/", "classpath:/static3/"); // éç½®éæèµæºè·¯å¾
    }
}
</code></pre>
<h3 id="ç¬¬äºç§æ¹å¼">ç¬¬äºç§æ¹å¼</h3>
<pre><code class="language-java">@Configuration
public class WebConfig2 {

    @Bean
    public WebMvcConfigurer addResourceHandlers() {
        return new WebMvcConfigurer() {
            @Override
            public void addResourceHandlers(ResourceHandlerRegistry registry) {
                registry.addResourceHandler("/abc/**") // éç½®è·¯å¾è®¿é®æ¨¡å¼
                        .addResourceLocations("classpath:/static1/", "classpath:/static2/", "classpath:/static3/"); // éç½®éæèµæºè·¯å¾
            }
        };
    }
}
</code></pre>
<h1 id="webè¯·æ±çè·¯å¾å¹é">webè¯·æ±çè·¯å¾å¹é</h1>
<pre><code class="language-properties"># åç«¯è¯·æ±çurl å¹éå°controllerä¸­çæä¸ªæ¹æ³
# ä½¿ç¨anté£æ ¼çè·¯å¾å¹éè§åï¼é»è®¤å¼æ¯path_pattern_matcher
# path_pattern_matcherå¼å®¹ä¸æ¯æanté£æ ¼
# å¨anté£æ ¼ä¸­** å¯ä»¥åºç°å¨ä»»ä½ä½ç½®ï¼ä½å¨path_pattern_matcheré£æ ¼ä¸­ï¼** åªè½åºç°å¨æ«å°¾
# spring6 ä¸çanté£æ ¼ ** ä¹åªè½åºç°å¨æ«å°¾
spring.mvc.pathmatch.matching-strategy=ant_path_matcher
</code></pre>

</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/alineverstop/" target="_blank">NE_STOP</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/alineverstop/p/19537574" target="_blank">https://www.cnblogs.com/alineverstop/p/19537574</a></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-27 11:50">2026-01-27 11:50</span>&nbsp;
<a href="https://www.cnblogs.com/alineverstop">NE_STOP</a>&nbsp;
éè¯»(<span id="post_view_count">129</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19537574);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19537574', targetLink: 'https://www.cnblogs.com/alineverstop/p/19537574', title: 'spring boot3--èªå¨éç½®ä¸æå¨éç½®' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>