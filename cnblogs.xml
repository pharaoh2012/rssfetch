<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-01-13T16:26:17.536Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ lidar 3d object detection ]]></title>
    <link>https://www.cnblogs.com/DemoFX/p/19479527</link>
    <guid>d16f80557197cde056e89a02c6abb348</guid>
    <description>
    <![CDATA[ 
	<div class="postTitle">
		<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/DemoFX/p/19479527" title="åå¸äº 2026-01-14 00:13">
    <span role="heading" aria-level="2">lidar 3d object detection</span>
    

</a>

	</div>
	    <div id="cnblogs_post_description" style="display: none">
        
        lidarä¸ç»´ç©ä½æ£æµ
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æè¿å¨ç½ä¸å¶ç¶åç°ä¸ä¸ªåä¸ç»´ç©ä½æ£æµçå¼ååOpenPCDet,å ä¸ä¸ç´åå¤å­¦å­¦python,å°±å³å®å¨æä¸æãç½ä¸å·²ç»æä¸å°å¼åçææ¡£ï¼å¨ç¼è¯çè¿ç¨ä¸­ä¹åèäºä¸å°ç½ä¸çèµæï¼ç°å¨åç¹èªå·±çä½ä¼ã<br>
é¦åå®è£python,å ä¸ºç¨çwin7,æä»¥ä¸å¼å§ä½¿ç¨çpython38,è¿å·²ç»æ¯æ¯æwin7çæé«çæ¬äºï¼ç¶åä¸äºpytorch,åæ¶ä¸è½½äºå¶ä»é¡¹ç®ä¾èµçæ¨¡åï¼å¨å®è£spconvçæ¶åéå°ä¸äºé®é¢ï¼æå¨ç½ä¸æ¥çæ¯è¦ä½¿ç¨spconv-cu102æ¯æcudaï¼èä¸spconvåçæ¬cummçcudaå·è¦ä¸è´ï¼ä½æ¯è¿æ¯åºç°DLLæ¾ä¸å°çé®é¢ï¼å¨ç½ä¸ä¹çå°æäººéå°ç±»ä¼¼çæåµï¼ä½æ²¡æè§£å³æ¹æ¡ï¼æåæå°è¯æ´æ¢å°python37ï¼é®é¢æå¾å°è§£å³ã<br>
SharedArrayä¹æ¯é¡¹ç®ä¾èµçä¸ä¸ªåï¼ä½å¹¶æ²¡æç¸åºçå®è£æä»¶ï¼æåå¨githubä¸æ¾äºä¸ªSharedNumpyArrayçé¡¹ç®æ¿æ¢ã<br>
ç¼è¯éè¦è³å°vs2017çæ¯æï¼è½ç¶å¼ååå¹¶æ²¡æä½¿ç¨ä»ä¹å¤ªé«çº§çC++åè½ï¼ä½æ¯å ä¸ºä½¿ç¨çpytorch,å¯¹äºç¼è¯å¨æè¦æ±ï¼èªå·±ç¨çæ¯vs2015,ç¼è¯ä¸ç´æ¥éï¼å¨ç½ä¸çå°ä¹æ¯ä½¿ç¨vs2015çç¼è¯å¨åæ ·æ æ³ä½¿ç¨ï¼æåå ä¸ºçµèç¡¬çç©ºé´ä¸å¤äºï¼åªè½è£ä¸ªvsBuildToolsï¼ç¼è¯å°±okäºã<br>
ä¸é¢åä¸¾ä¸äºå¼åä¸­éå°çé®é¢ã</p>
<p>1.pcdet\ops\iou3d_nms\src/iou3d_nms.cpp(163): error C2131: expression did not evaluate to a constant<br>
pcdet\ops\iou3d_nms\src/iou3d_nms.cpp(213): error C2131: expression did not evaluate to a constant<br>
constæ°ç»ä½¿ç¨çé®é¢ï¼å¥½åå¾å¤é¡¹ç®ç¼è¯é½æè¿ä¸ªé®é¢ï¼åºè¯¥æ¯å¨linuxä¸ç¼è¯æ²¡é®é¢ï¼ä½æ¯å¨windowsä¸ä¼åºé®é¢.è§£å³æ¹æ¡æ¯ä½¿ç¨vectorä»£æ¿æ°ç»å°±å¯ä»¥äºã<br>
2.pcdet\ops\iou3d_nms\src\iou3d_nms_kernel.cu(77): error: identifier "EPS" is undefined in device code<br>
ç¨å®å®ä¹ä»£æ¿åéå£°æå°±å¯ä»¥äºã<br>
3.iou3d_nms_kernel.obj : error LNK2005: "int __cdecl check_rect_cross(struct Point const &amp;,struct Point const &amp;,struct Point const &amp;,struct Point const &amp;)" (?check_rect_cross@@YAHAEBUPoint@@000@Z) already defined in iou3d_cpu.obj<br>
å½æ°éåï¼æ¹äºå°±è¡äºã<br>
4.iou3d_nms.obj : error LNK2001: unresolved external symbol "public: long * __cdecl at::TensorBase::data_ptr<long>(void)const " (??$data_ptr@J@TensorBase@at@@QEBAPEAJXZ)<br>
è¿ä¸ªbugæ¯è¾ç¥å¥ï¼å¨ç½ä¸æ¾å¾è§£å³æ¹æ¡ï¼å¢å #include cstdint,ælongæ¿æ¢æint64_t,unsigned long longæ¿æ¢æuint64_té®é¢å¾å°è§£å³ã<br>
5.Searching for spconv-cu102<br>
Reading <a href="https://pypi.org/simple/spconv-cu102/" target="_blank" rel="noopener nofollow">https://pypi.org/simple/spconv-cu102/</a><br>
Scanning index of all packages (this may take a while)<br>
Reading <a href="https://pypi.org/simple/" target="_blank" rel="noopener nofollow">https://pypi.org/simple/</a><br>
è¿ä¸ªæ¯é¡¹ç®ä¾èµï¼ä¸å¼å§ç¨çcuda102ççæ¬ï¼åæ¥æ¢æäºcuda113.<br>
6.ImportError:cannot import name 'getgrouplist' from os<br>
è¿ä¸ªæ¯ä½¿ç¨äºwindowsæ²¡æçå½æ°ï¼æçåªæ¯å¼ç¨æ²¡æä½¿ç¨ï¼æä»£ç æ³¨éæå°±okäºã</long></p>
<p>python demo.py --cfg_file .\pv_rcnn.yaml --data_path 000000.bin --ckpt .\weight/pv_rcnn_8369.pth<br>
æåè¿è¡demo,æ´ä¸ªæµè¯ç¨çdatasetæåå Gï¼ä¸è½½å¤ªæ¢ä¹å¤ªå å°æ¹ï¼æä»githubä¸æ¾çä¸è½½åï¼åªæ50Må·¦å³ã<br>
æåæ¾ä¸ä¸å¼ è¿è¡çææå¾ã</p>
<p><img alt="demo" width="475" height="332" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3730441/202601/3730441-20260114000659783-254276455.jpg" class="lazyload"></p>

</div>
<div class="clear"></div>

	<div class="postDesc">posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-14 00:13">2026-01-14 00:13</span>&nbsp;
<a href="https://www.cnblogs.com/DemoFX">demofx</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479527);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479527', targetLink: 'https://www.cnblogs.com/DemoFX/p/19479527', title: 'lidar 3d object detection' })">ä¸¾æ¥</a>
</div>
 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ LangChainãLangFlowãLangGraphï¼ä¸æè®²æ¸ä¸å¤§ LLM æ¡æ¶çå®ä½ä¸å·®å¼ ]]></title>
    <link>https://www.cnblogs.com/jyzhao/p/19479470/langchainlangflowlanggraph-yi-wen-jiang-qing-san-d</link>
    <guid>88c9b78cc1ca2c9bde876d7c031b53cb</guid>
    <description>
    <![CDATA[ 
    <a name="top"></a>
    <h2><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/jyzhao/p/19479470/langchainlangflowlanggraph-yi-wen-jiang-qing-san-d" title="åå¸äº 2026-01-13 23:25">
    <span role="heading" aria-level="2">LangChainãLangFlowãLangGraphï¼ä¸æè®²æ¸ä¸å¤§ LLM æ¡æ¶çå®ä½ä¸å·®å¼</span>
    

</a>
</h2>
    <small>
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 23:25">2026-01-13 23:25</span>&nbsp;
<a href="https://www.cnblogs.com/jyzhao">AlfredZhao</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479470);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479470', targetLink: 'https://www.cnblogs.com/jyzhao/p/19479470/langchainlangflowlanggraph-yi-wen-jiang-qing-san-d', title: 'LangChainãLangFlowãLangGraphï¼ä¸æè®²æ¸ä¸å¤§ LLM æ¡æ¶çå®ä½ä¸å·®å¼' })">ä¸¾æ¥</a>
</small>
    <div class="entry">
        <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>éçå¤§æ¨¡åï¼LLMï¼è¿å¥å·¥ç¨åè½å°é¶æ®µï¼<strong>âå¦ä½ææ¨¡ååæçæ­£å¯ç¨çåºç¨â</strong> æäºå¾å¤ä»ä¸èç»ä¸å¼çé®é¢ã<br>
å´ç»è¿ä¸ªç®æ ï¼ç¤¾åºééæ¸å½¢æäºä¸æ¹æççå¼æºæ¡æ¶ï¼å¶ä¸­è¢«è®¨è®ºæå¤çå°±æ¯ <strong>LangChainãLangFlowãLangGraph</strong>ã</p>
<p>å®ä»¬åå­ç¸ä¼¼ï¼ä½<strong>è§£å³çé®é¢å¹¶ä¸ç¸å</strong>ãæ¬æç¬èå°åºäºå®æ¹ææ¡£ä¸å¼æºå®è·µï¼ä»<strong>å®ä½ãè½åãä½¿ç¨åºæ¯åå·®å¼</strong>å ä¸ªè§åº¦ï¼å¸®ä½ ä¸æ¬¡æ§çæ¸ã</p>
<hr>
<h2 id="01--langchainllm-åºç¨çåºç¡è®¾æ½å±">01 | LangChainï¼LLM åºç¨çâåºç¡è®¾æ½å±â</h2>
<h3 id="-langchain-æ¯ä»ä¹">â  LangChain æ¯ä»ä¹ï¼</h3>
<p>LangChain æ¯ä¸ä¸ª<strong>ç¨äºæå»º LLM åºç¨çéç¨æ¡æ¶</strong>ï¼æ ¸å¿ç®æ åªæä¸å¥è¯ï¼</p>
<blockquote>
<p>æãå¤§æ¨¡å + å¤é¨å·¥å· + æ°æ®æº + Promptãç³»ç»åå°ç»ç»èµ·æ¥ã</p>
</blockquote>
<p>å®å¹¶ä¸æ¯ä¸ä¸ªâäº§åâï¼èæ¯ä¸å¥ <strong>å¼åèå¼åç»ä»¶åº</strong>ã</p>
<hr>
<h3 id="-langchain-è§£å³ä»ä¹é®é¢">â¡ LangChain è§£å³ä»ä¹é®é¢ï¼</h3>
<p>å¨æ²¡æ LangChain ä¹åï¼å¼åèéå¸¸éè¦èªå·±å¤çï¼</p>
<ul>
<li>Prompt æ¼æ¥</li>
<li>æ¨¡åè°ç¨</li>
<li>ä¸ä¸æç®¡ç</li>
<li>å·¥å·è°ç¨ï¼SQLãæç´¢ãAPIï¼</li>
<li>RAGï¼æ£ç´¢å¢å¼ºçæï¼</li>
</ul>
<p>LangChain æè¿äºæ½è±¡æäºæ åç»ä»¶ï¼ä¾å¦ï¼</p>
<ul>
<li>LLM / ChatModel</li>
<li>PromptTemplate</li>
<li>Chain</li>
<li>Tool / Agent</li>
<li>Memory</li>
</ul>
<hr>
<h3 id="-å¸ååºç¨åºæ¯">â¢ å¸ååºç¨åºæ¯</h3>
<ul>
<li>RAG é®ç­ç³»ç»</li>
<li>NL2SQL</li>
<li>AI å©æ / Copilot</li>
<li>å·¥å·å Agent</li>
</ul>
<p><strong>ä¸å¥è¯æ»ç»</strong>ï¼<br>
<strong>LangChain = å LLM åºç¨çâåç«¯å¼åæ¡æ¶â</strong></p>
<hr>
<h2 id="02--langflowlangchain-çå¯è§åä½ä»£ç å¥å£">02 | LangFlowï¼LangChain çå¯è§åâä½ä»£ç å¥å£â</h2>
<h3 id="-langflow-æ¯ä»ä¹">â  LangFlow æ¯ä»ä¹ï¼</h3>
<p>LangFlow æ¯ä¸ä¸ª <strong>åºäº LangChain çå¯è§åç¼æå·¥å·</strong>ã</p>
<p>ä½ å¯ä»¥çè§£ä¸ºï¼</p>
<blockquote>
<p>ç¨âææ½æµç¨å¾âçæ¹å¼æ¥æ­ LangChain åºç¨ã</p>
</blockquote>
<p>å®æ¬è´¨ä¸æ¯ï¼</p>
<ul>
<li>åç«¯å¯è§å</li>
<li>åç«¯ä»ç¶è¿è¡ LangChain é»è¾</li>
</ul>
<hr>
<h3 id="-langflow-çæ ¸å¿ä»·å¼">â¡ LangFlow çæ ¸å¿ä»·å¼</h3>
<p>LangFlow å¹¶æ²¡æå¼å¥æ°çæ¨¡åè½åï¼å®çä¼å¿å¨äºï¼</p>
<ul>
<li><strong>éä½å­¦ä¹ é¨æ§</strong></li>
<li>å¿«éååéªè¯</li>
<li>Prompt / Chain å¯è§åè°è¯</li>
</ul>
<p>å¯¹ä¸çæ Python æåæ¥è§¦ LLM çäººéå¸¸åå¥½ã</p>
<hr>
<h3 id="-å¸ååºç¨åºæ¯-1">â¢ å¸ååºç¨åºæ¯</h3>
<ul>
<li>äº§åç»ç / å¨è¯¢é¡¾é®å Demo</li>
<li>Prompt è°ä¼ä¸æµç¨éªè¯</li>
<li>æå­¦ä¸åäº«æ¼ç¤º</li>
<li>å°å PoC é¡¹ç®</li>
</ul>
<p><strong>ä¸å¥è¯æ»ç»</strong>ï¼<br>
<strong>LangFlow = LangChain çâå¯è§åæä½å°â</strong></p>
<hr>
<h2 id="03--langgraphä¸ºå¤æ-agent-èççç¶ææºæ¡æ¶">03 | LangGraphï¼ä¸ºå¤æ Agent èççâç¶ææºæ¡æ¶â</h2>
<h3 id="-langgraph-æ¯ä»ä¹">â  LangGraph æ¯ä»ä¹ï¼</h3>
<p>LangGraph æ¯ LangChain å®æ¹æ¨åºçä¸ä¸ª<strong>æ°æ¡æ¶</strong>ï¼ä¸é¨è§£å³ä¸ä¸ªé®é¢ï¼</p>
<blockquote>
<p>å½ Agent é»è¾åå¤æï¼Chain å·²ç»ä¸å¤ç¨äºï¼æä¹åï¼</p>
</blockquote>
<p>LangGraph å¼å¥çæ¯ï¼</p>
<ul>
<li><strong>Graphï¼å¾ï¼</strong></li>
<li><strong>Stateï¼ç¶æï¼</strong></li>
<li><strong>èç¹ + è¾¹ + å¾ªç¯</strong></li>
</ul>
<p>æ¬è´¨ä¸æ¯ï¼<br>
<strong>æ LLM Agent å½æä¸ä¸ªâæç¶æçå·¥ä½æµ/ç¶ææºâæ¥å»ºæ¨¡</strong>ã</p>
<hr>
<h3 id="-langgraph-ä¸ºä»ä¹åºç°">â¡ LangGraph ä¸ºä»ä¹åºç°ï¼</h3>
<p>å¨çå®é¡¹ç®ä¸­ï¼Agent å¾å¾éè¦ï¼</p>
<ul>
<li>å¤è½®å³ç­</li>
<li>æ¡ä»¶åæ¯</li>
<li>åé / éè¯</li>
<li>äººå·¥ä»å¥ï¼Human-in-the-loopï¼</li>
</ul>
<p>è¿äºç¨ä¼ ç» Chain éå¸¸å«æ­ï¼è LangGraph å¤©ç¶æ¯æï¼</p>
<ul>
<li>å¾ªç¯</li>
<li>åæ¯</li>
<li>å¹¶è¡</li>
<li>å¯æ¢å¤æ§è¡</li>
</ul>
<hr>
<h3 id="-å¸ååºç¨åºæ¯-2">â¢ å¸ååºç¨åºæ¯</h3>
<ul>
<li>å¤ Agent åä½ç³»ç»</li>
<li>å¤æä¸å¡æµç¨èªå¨å</li>
<li>é¿ä»»å¡ AI å©æ</li>
<li>éè¦âå¯æ§è¡ä¸ºâçæºè½ä½</li>
</ul>
<p><strong>ä¸å¥è¯æ»ç»</strong>ï¼<br>
<strong>LangGraph = é¢åå¤æ Agent çâæµç¨ä¸ç¶ææ§å¶å±â</strong></p>
<hr>
<h2 id="04--ä¸èæ ¸å¿å·®å¼ä¸å¾è¯»æ">04 | ä¸èæ ¸å¿å·®å¼ä¸å¾è¯»æ</h2>
<table>
<thead>
<tr>
<th>ç»´åº¦</th>
<th>LangChain</th>
<th>LangFlow</th>
<th>LangGraph</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ ¸å¿å®ä½</td>
<td>LLM åºç¨æ¡æ¶</td>
<td>å¯è§åç¼æå·¥å·</td>
<td>Agent ç¶ææºæ¡æ¶</td>
</tr>
<tr>
<td>æ½è±¡æ¨¡å</td>
<td>Chain / Agent</td>
<td>Flow</td>
<td>Graph / State</td>
</tr>
<tr>
<td>ä½¿ç¨æ¹å¼</td>
<td>åä»£ç </td>
<td>ææµç¨</td>
<td>åå¾ç»æä»£ç </td>
</tr>
<tr>
<td>éåäººç¾¤</td>
<td>å·¥ç¨å¸</td>
<td>åå­¦è / äº§å</td>
<td>é«çº§å·¥ç¨å¸</td>
</tr>
<tr>
<td>å¤æé»è¾</td>
<td>ä¸è¬</td>
<td>ä¸è¬</td>
<td>éå¸¸å¼º</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="05--åºè¯¥å¦ä½éæ©">05 | åºè¯¥å¦ä½éæ©ï¼</h2>
<p>ç¬èç»ä½ ä¸ä¸ª<strong>ä¸è¸©åçéæ©å»ºè®®</strong>ï¼</p>
<ul>
<li><strong>æ³ç³»ç»å LLM åºç¨</strong> â åå­¦ <strong>LangChain</strong></li>
<li><strong>æ³å¿«éåº Demo / å­¦æ¦å¿µ</strong> â ç¨ <strong>LangFlow</strong></li>
<li><strong>Agent é»è¾å¼å§åå¤æ</strong> â ä¸ <strong>LangGraph</strong></li>
</ul>
<p>ç°å®é¡¹ç®ä¸­ï¼<strong>ä¸èæ¯å¯ä»¥ç»åä½¿ç¨ç</strong>ï¼</p>
<blockquote>
<p>LangFlow ç»æµç¨ â LangChain è½ä»£ç  â LangGraph æ§å¤ææ§å¶</p>
</blockquote>
<hr>
<h2 id="06--åå¨æå">06 | åå¨æå</h2>
<p>LangChain çæçæ¼è¿ï¼æ¬è´¨ä¸åæ äºä¸ä»¶äºï¼</p>
<blockquote>
<p>LLM åºç¨ï¼æ­£å¨ä»âPrompt å·¥ç¨âï¼èµ°åçæ­£çè½¯ä»¶å·¥ç¨ã</p>
</blockquote>
<p>çè§£è¿ä¸èçè¾¹çï¼æ¯æ­»è®° API æ´éè¦ã<br>
å¦æä½ æ­£å¨å <strong>RAGãNL2SQLãAI Agent</strong>ï¼è¿å¥è®¤ç¥å ä¹æ¯ç»ä¸å¼çåºç¡ã</p>
<p>å¸æè¿ç¯æç« ï¼è½å¸®ä½ å°èµ°ä¸äºå¼¯è·¯ã</p>

</div>
<div id="MySignature" role="contentinfo">
    <a href="https://www.cnblogs.com/jyzhao/" target="_blank">AlfredZhao</a>Â©çæææãä»Oracleèµ·èªï¼é¢ç¥ç²¾å½©çITææ¯ãã<br>
è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/jyzhao/p/19479470/langchainlangflowlanggraph-yi-wen-jiang-qing-san-d" target="_blank">https://www.cnblogs.com/jyzhao/p/19479470/langchainlangflowlanggraph-yi-wen-jiang-qing-san-d</a>
<hr>
<div style="text-align:center; margin-top:30px;">
  <p style="font-size:14px;color:#555;">
    ð æè°¢éè¯»ï¼æ¬¢è¿å³æ³¨æçå¬ä¼å· <b>ãèµµéå®ã</b>
  </p>
  <img src="https://images.cnblogs.com/cnblogs_com/jyzhao/824234/o_250208075013_qrcode-zjy.jpg" width="160" style="border:1px solid #ddd;border-radius:8px;">
</div>
</div>
<div class="clear"></div>

        <div class="clear"></div>
        
</div>
    <ul class="postmetadata">
        <vc:categories-tags blog-app="jyzhao" blog-id="186567" post-id="19479470"></vc:categories-tags>
    </ul>
 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æµèç®æ³ç«èµä¸­ç»´æ¤ä¸­ä½æ°çå°æå·§ ]]></title>
    <link>https://www.cnblogs.com/GroundhogKing/p/19479345</link>
    <guid>78576c713959f1fba2ffcc2d440488b6</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/GroundhogKing/p/19479345" title="åå¸äº 2026-01-13 23:13">
    <span role="heading" aria-level="2">æµèç®æ³ç«èµä¸­ç»´æ¤ä¸­ä½æ°çå°æå·§</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>é¦åæ¥çæåæ­çµå¤æ ¡çä¸éé¢ç®ï¼</p>
<hr>
<p>å¯¹äºä¸ä¸ªé¿åº¦ä¸º <span class="math inline">\(L\)</span>(<span class="math inline">\(L\)</span>ä¸ºå¥æ°) çæ°ç» <span class="math inline">\(a\)</span>ï¼å®ä¹å®çä¸­ä½æ° <span class="math inline">\(median(a)\)</span> ä¸º <span class="math inline">\(a\)</span> ä¸­ç¬¬ <span class="math inline">\(\frac{L+1}{2}\)</span> å¤§çæ°ãç°å¨ç»ä½ ä¸ä¸ªé¿åº¦ä¸º <span class="math inline">\(n\)</span> çæåï¼å¯¹äºæ¯å¯¹æ»¡è¶³ <span class="math inline">\(1\leq i \leq j \leq n\)</span> ä¸ <span class="math inline">\(j-i \equiv 0 (mod 2)\)</span> ç <span class="math inline">\((i,j)\)</span>ï¼ä½ éè¦è®¡ç® <span class="math inline">\(i*j*median(p[i,j])\)</span>ãè¾åºææå¼çåã</p>
<p>å¤æµæ° <span class="math inline">\(T \leq 20\)</span>ï¼æåé¿åº¦ <span class="math inline">\(n \leq 2000\)</span>ã</p>
<hr>
<p>å¯¹äºè¿éé¢ï¼é¦åæ³å°çæ¯æä¸¾ææ <span class="math inline">\([i,j]\)</span>ï¼éè¿æ°æ®ç»æ(å¯¹é¡¶å ç­)ç»´æ¤ä¸­ä½æ°ãç±äºè¿äºæ¹æ³é½å¸¦logï¼å¹¶ä¸æ¬é¢å¤æµæ°æ®ä¸ä¿è¯ <span class="math inline">\(n\)</span> çæ»åãå æ­¤å¤æåº¦ <span class="math inline">\(O(n^2lognT)\)</span>ï¼æ æ³éè¿æ¬é¢ã</p>
<p>æ¢ä¸ªæè·¯ï¼æä¸¾åºé´ä¸è¡ï¼å°±è®¡ç®æ¯ä¸ªä½ç½®çè´¡ç®ãæ³æ³ä¸ä¸ªä½ç½®è½æä¸ºä¸ä¸ªåºé´çä¸­ä½æ°ï¼éè¦æ»¡è¶³ä»ä¹æ¡ä»¶ï¼è¯¥åºé´ä¸­å¤§äºå®åå°äºå®çæ°çæ°éç¸ç­ã</p>
<p>ä¸ä¸ªå¾ç»å¸çå¤çå°±æ¯ï¼å°å°äº <span class="math inline">\(x\)</span> çæ°èµ-1ï¼å°å¤§äº <span class="math inline">\(x\)</span> çæ°èµ1ï¼æä»¬å¯¹è¿ä¸ªæ°ç»ååç¼åï¼è®°ä½ <span class="math inline">\(pre\)</span>ãäºæ¯é®é¢å°±è½¬æ¢ä¸ºï¼å¨ <span class="math inline">\(x\)</span> çå·¦è¾¹æ¾å° <span class="math inline">\(pre_i\)</span>ï¼å¨ <span class="math inline">\(x\)</span> çå³è¾¹æ¾å° <span class="math inline">\(pre_j\)</span>ï¼ä½¿å¾ <span class="math inline">\(pre_i = pre_j\)</span>ãé£ä¹ <span class="math inline">\(pre_j - pre_i = 0\)</span>ï¼è¿å°±æå³çï¼åºé´ <span class="math inline">\([l+1,r]\)</span> ä¸­å¤§äº <span class="math inline">\(x\)</span> åå°äº <span class="math inline">\(x\)</span> çæ°çæ°éç¸ç­ã</p>
<p>å¯¹äºæ¯ä¸ªæ°å¤çä¸æ¬¡è¿æ ·çåç¼åæ°ç»æ¯ <span class="math inline">\(O(n)\)</span> çï¼å æ­¤å¯ä»¥å¨ <span class="math inline">\(O(n^2T)\)</span> çæ¶é´ä¸éè¿æ¬é¢ã</p>
<p><strong>Code:</strong></p>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;vector&gt;
using namespace std;

using ll = long long;

void solve()
{
    int n;
    cin &gt;&gt; n;
    vector&lt;int&gt; a(n+10);
    for (int i = 1 ; i &lt;= n ; i++) cin &gt;&gt; a[i];

    ll ans = 0;
    for (int i = 1 ; i &lt;= n ; i++) //æä¸¾ä¸­ä½æ°
    {
        vector&lt;int&gt; pre(n+10);
        vector&lt;int&gt; t(2*n+10); //æ¡¶,å ä¸ºä¼åºç°è´æ°ï¼è¦å¸¦nçåç§»
        t[n]++;
        for (int j = 1 ; j &lt;= n ; j++)
        {
            pre[j] = pre[j-1];
            if (a[j] &gt; a[i]) pre[j]++;
            else if (a[j] &lt; a[i]) pre[j]--;

            if (j &lt; i) t[pre[j]+n] += j + 1;
            else ans += (ll)a[i] * t[pre[j]+n] * j;
        }
    }

    cout &lt;&lt; ans &lt;&lt; endl;
}

int main()
{
    ios::sync_with_stdio(false);
    cin.tie(0);
    cout.tie(0);

    int T;
    cin &gt;&gt; T;
    while (T--) solve();

    return 0;
}
</code></pre>
<p>åºäºæ¬é¢ï¼å¯ä»¥å½çº³ä¸ä¸ªç»´æ¤ä¸­ä½æ°çå°æå·§ï¼éè¿ç»å¤§äº <span class="math inline">\(x\)</span> å å°äº <span class="math inline">\(x\)</span> çæ°åå«èµå¼ï¼å¹¶æ±åç¼åï¼å°±å¯ä»¥ææ±ä¸­ä½æ°é®é¢ï¼è½¬åæç»´æ¤åç¼åä¹å·®ä¸º0ã</p>
<p>ä»¥ä¸ååä¸ªæå±ï¼åºå <span class="math inline">\(a\)</span> çä¸­ä½æ° <span class="math inline">\(median(a) \ge v\)</span>ï¼å½ä¸ä»å½ <span class="math inline">\(a\)</span> ä¸­ <span class="math inline">\(cnt_{a_i \geq v} \geq cnt_{a_i &lt; v}\)</span>ï¼å¼ä¸­æ¯å¦åç­å·åå³äºé¢ç®æä¹å®ä¹ä¸­ä½æ°ï¼ãä¹å°±æ¯è¯´ï¼<span class="math inline">\(median(a) \geq v\)</span> çåè¦æ¡ä»¶æ¯ <span class="math inline">\(a\)</span> ä¸­ <span class="math inline">\(\geq v\)</span> çæ°çæ°éå¤äºæç­äº <span class="math inline">\(&lt; v\)</span> çæ°çæ°éãè¿ä¸ªå¼å­æ¯è¾å¥½çè§£ï¼è¿éä¸åè¯æã</p>
<p>è¿ä¸ªå¼å­ç»æä»¬æä¾äºä¸ç§äºåçæè·¯ã</p>
<p>çä¸é¢è¿éé¢<a href="https://codeforces.com/contest/2128/problem/E1" target="_blank" rel="noopener nofollow">Submedians (Easy Version)</a>ï¼</p>
<hr>
<p>å¯¹äºé¿åº¦ä¸º <span class="math inline">\(m\)</span> çæ°ç» <span class="math inline">\(b\)</span>ï¼æ´æ° <span class="math inline">\(v\)</span> æ¯ <span class="math inline">\(b\)</span> çä¸­ä½æ°ï¼å½ä¸ä»å½ï¼</p>
<ul>
<li><span class="math inline">\(v\)</span> è³å°å¤§äºç­äºæ°ç»ä¸­ <span class="math inline">\(\lceil \frac{m}{2} \rceil\)</span> ä¸ªåç´ ï¼å¹¶ä¸</li>
<li><span class="math inline">\(v\)</span> è³å°å°äºç­äºæ°ç»ä¸­ <span class="math inline">\(\lceil \frac{m}{2} \rceil\)</span> ä¸ªåç´ ã</li>
</ul>
<p>ç°å¨ç»å®ä¸ä¸ªæ´æ° <span class="math inline">\(k\)</span> åä¸ä¸ªç± <span class="math inline">\(1\)</span> å° <span class="math inline">\(n\)</span> ä¹é´çæ´æ°ææçæ°ç» <span class="math inline">\(a_1, \ldots, a_n\)</span>ã</p>
<p>å¦æå­å¨è³å°ä¸å¯¹ä¸æ  <span class="math inline">\((l, r)\)</span> æ»¡è¶³ï¼</p>
<ul>
<li><span class="math inline">\(1 \leq l \leq r \leq n\)</span>ï¼</li>
<li><span class="math inline">\(r - l + 1 \geq k\)</span>ï¼</li>
<li><span class="math inline">\(v\)</span> æ¯å­æ°ç» <span class="math inline">\([a_l, \ldots, a_r]\)</span> çä¸­ä½æ°ï¼</li>
</ul>
<p>åç§° <span class="math inline">\(1\)</span> å° <span class="math inline">\(n\)</span> ä¹é´çæ´æ° <span class="math inline">\(v\)</span> æ¯ä¸ä¸ªå­ä¸­ä½æ°ã</p>
<p>å¯ä»¥è¯æï¼è³å°å­å¨ä¸ä¸ªå­ä¸­ä½æ°ãè¯·ä½ æ¾åºæå¤§çå­ä¸­ä½æ° <span class="math inline">\(v_{\max}\)</span>ï¼ä»¥åä»»æä¸ç»å¯¹åºçä¸æ å¯¹ <span class="math inline">\((l, r)\)</span>ã</p>
<hr>
<p>èèäºåï¼å½ <span class="math inline">\(v\)</span> è¶å¤§ï¼<span class="math inline">\(cnt_{a_i\geq v}\)</span> è¶å°ï¼åä¹ <span class="math inline">\(cnt_{a_i &lt; v}\)</span> è¶å¤§ï¼å æ­¤è¶å¤§çæ°è¶ä¸å¯è½ä½ä¸ºä¸­ä½æ°ã</p>
<p>åæ ·å° <span class="math inline">\(\geq v\)</span> çæ°èµ1ï¼<span class="math inline">\(&lt; v\)</span> çæ°èµ-1ï¼ååç¼åç»´æ¤å³å¯ã</p>
<p><strong>Code:</strong></p>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;vector&gt;
using namespace std;

void solve()
{
    int n,k;
    cin &gt;&gt; n &gt;&gt; k;
    vector&lt;int&gt; a(n+10);
    for (int i = 1 ; i &lt;= n ; i++) cin &gt;&gt; a[i];

    int ansl, ansr;
    auto check = [&amp;](int mid)
    {
        vector&lt;int&gt; sum(n+10);
        for (int i = 1 ; i &lt;= n ; i++)
        {
            sum[i] = sum[i-1];
            if (a[i] &gt;= mid) sum[i]++;
            else sum[i]--;
        }

        int minn = 2e9;
        int l;
        for (int i = k ; i &lt;= n ; i++)
        {
            if (sum[i-k] &lt; minn)
            {
                minn = sum[i-k];
                l = i - k + 1;
            }
            if (sum[i]-minn &gt;= 0)
            {
                ansl = l;
                ansr = i;
                return true;
            }
        }

        return false;
    };

    int l = 0;
    int r = n + 1;
    while (l+1 != r)
    {
        int mid = (l+r) &gt;&gt; 1;
        if (check(mid)) l = mid;
        else r = mid;
    }

    check(l);
    cout &lt;&lt; l &lt;&lt; " " &lt;&lt; ansl &lt;&lt; " " &lt;&lt; ansr &lt;&lt; endl;
}

int main()
{
    ios::sync_with_stdio(false);
    cin.tie(0);
    cout.tie(0);

    int T;
    cin &gt;&gt; T;
    while (T--) solve();

    return 0;
}
</code></pre>
<p>ä¸éä¸ä¸é¢å ä¹ä¸æ ·çé¢ç®<a href="https://codeforces.com/contest/1486/problem/D" target="_blank" rel="noopener nofollow">Max Median</a>ï¼</p>
<p>é¢ç®å¾ç­ï¼è¿éä¸åé¢ææ¦è¿°ãéè¦æ³¨æçæ¯ï¼ç±äºæ¬é¢å®ä¹ä¸­ä½æ°ä¸ºç¬¬ <span class="math inline">\(\lfloor \frac{L+1}{2} \rfloor\)</span> å¤§çæ°ï¼å æ­¤æ¬é¢ <span class="math inline">\(median(a) \geq v\)</span> çæ¡ä»¶ä¸ºï¼<span class="math inline">\(cnt_{a_i \geq v} &gt; cnt_{a_i &lt; v}\)</span>ã</p>
<p><strong>Code:</strong></p>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;vector&gt;
using namespace std;

void solve()
{
    int n,k;
    cin &gt;&gt; n &gt;&gt; k;
    vector&lt;int&gt; a(n+10);
    for (int i = 1 ; i &lt;= n ; i++) cin &gt;&gt; a[i];

    int ansl, ansr;
    auto check = [&amp;](int mid)
    {
        vector&lt;int&gt; sum(n+10);
        for (int i = 1 ; i &lt;= n ; i++)
        {
            sum[i] = sum[i-1];
            if (a[i] &gt;= mid) sum[i]++;
            else sum[i]--;
        }

        int minn = 2e9;
        int l;
        for (int i = k ; i &lt;= n ; i++)
        {
            if (sum[i-k] &lt; minn)
            {
                minn = sum[i-k];
                l = i - k + 1;
            }
            if (sum[i]-minn &gt; 0)
            {
                ansl = l;
                ansr = i;
                return true;
            }
        }

        return false;
    };

    int l = 0;
    int r = n + 1;
    while (l+1 != r)
    {
        int mid = (l+r) &gt;&gt; 1;
        if (check(mid)) l = mid;
        else r = mid;
    }

    check(l);
    cout &lt;&lt; l &lt;&lt; endl;
}

int main()
{
    ios::sync_with_stdio(false);
    cin.tie(0);
    cout.tie(0);

    int T = 1;
    while (T--) solve();

    return 0;
}
</code></pre>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 23:13">2026-01-13 23:13</span>&nbsp;
<a href="https://www.cnblogs.com/GroundhogKing">GroundhogKing</a>&nbsp;
éè¯»(<span id="post_view_count">1</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479345);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479345', targetLink: 'https://www.cnblogs.com/GroundhogKing/p/19479345', title: 'æµèç®æ³ç«èµä¸­ç»´æ¤ä¸­ä½æ°çå°æå·§' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å½æ¡å½¢å¾éä¸æåæ ï¼å¾åä¸åå½¢æ¡å½¢å¾çè§è§é©å½ ]]></title>
    <link>https://www.cnblogs.com/wang_yb/p/19479454</link>
    <guid>3df46e653b4c65413fc3368a038ee851</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/wang_yb/p/19479454" title="åå¸äº 2026-01-13 23:10">
    <span role="heading" aria-level="2">å½æ¡å½¢å¾éä¸æåæ ï¼å¾åä¸åå½¢æ¡å½¢å¾çè§è§é©å½</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æ³è±¡ä¸ä¸ï¼ä½ æ­£ç«å¨ä¸ä¸ªåå½¢å¹¿åºçä¸­å¿ï¼å¨å´ååæåç12æ ¹é«åº¦ä¸åçç¯æ±ï¼è¿å°±æ¯<strong>å¾åæ¡å½¢å¾</strong>å¸¦ç»æä»¬çè§è§ä½éªã</p>
<p>å¨æ°æ®å¯è§åé¢åï¼æä»¬å¸¸å¸¸æ»¡è¶³äºä¼ ç»çç´è§åæ ç³»æ¡å½¢å¾ï¼ä½å½æ°æ®å·æå¨ææ§ææ¯è¾æ§æ¶ï¼<strong>å¾åæ¡å½¢å¾</strong>å<strong>åå½¢æ¡å½¢å¾</strong>ä¸ºæä»¬æå¼äºæ°çå¯è½æ§ã</p>
<h1 id="1-è®¾è®¡åç">1. è®¾è®¡åç</h1>
<p>è¿ä¸¤ç§å¾è¡¨æä¼ ç»ç<strong>ç¬å¡å°åæ ç³»</strong>æ¢æ<strong>æåæ ç³»</strong>ï¼è§åº¦è¡¨ç¤ºç±»å«ï¼åå¾æè§åº¦é¿åº¦è¡¨ç¤ºæ°å¼ã</p>
<h2 id="11-å¾åæ¡å½¢å¾">1.1. å¾åæ¡å½¢å¾</h2>
<p><strong>å¾åæ¡å½¢å¾</strong>æ¬è´¨ä¸æ¯å°ä¼ ç»æ¡å½¢å¾çç´è§åæ ç³»è½¬æ¢ä¸ºæåæ ç³»ã</p>
<p>å¨æåæ ç³»ä¸­ï¼æ¯ä¸ªæ°æ®ç¹ä¸åç±<code>(x, y)</code>å®ä½ï¼èæ¯ç±<strong>(è§åº¦, åå¾)</strong>ç¡®å®ï¼æ¡å½¢çé«åº¦ï¼æé¿åº¦ï¼ç±åå¾å¼è¡¨ç¤ºï¼èæ¡å½¢çæååæ²¿çåå¨æ¹åã</p>

<p><img src="https://img2024.cnblogs.com/blog/83005/202601/83005-20260113230907077-321355021.png" alt="" loading="lazy"></p>
<p><strong>è®¾è®¡çµæ</strong>ï¼å¦åéè¡¨çæéæé·è¾¾çæ«æçº¿ï¼å¾åæ¡å½¢å¾åé´äºèªç¶çåäººå·¥å¶åä¸­å¸¸è§çåå½¢å¸å±ï¼å©ç¨äºäººç±»å¯¹è§åº¦åå¯¹ç§°æ§çå¤©ç¶æç¥è½åã</p>
<h2 id="12-åå½¢æ¡å½¢å¾">1.2. åå½¢æ¡å½¢å¾</h2>
<p><strong>åå½¢æ¡å½¢å¾</strong>æ¯å¾åæ¡å½¢å¾çä¸ç§ç¹æ®å½¢å¼ï¼å®åºå®äºèµ·ç¹åç»ç¹ï¼ä½¿æææ¡å½¢é½å¨åä¸åå¨ä¸å¼å§ï¼åªå¨åå¾æ¹åä¸å»¶ä¼¸ã</p>
<p>è¿ç§è®¾è®¡è§£å³äºå®å¨å¾åå¸å±å¯è½å¯¼è´ç<strong>æ°æ®æ¯è¾å°é¾</strong>é®é¢ï¼å ä¸ºæææ¡å½¢çåºåçº¿æ¯ä¸è´çã</p>

<p><img src="https://img2024.cnblogs.com/blog/83005/202601/83005-20260113230907250-2040360098.png" alt="" loading="lazy"></p>
<p><strong>è®¾è®¡æ¯å»</strong>ï¼æ³è±¡ä¸ç»è·³é«è¿å¨åï¼ä»ä»¬é½ä»åä¸é«åº¦èµ·è·³ï¼åªæ¯è·³è·çé«åº¦ä¸åââåå½¢æ¡å½¢å¾å°±æ¯è¿æ ·å¬å¹³ç"ç«æåº"ã</p>
<h1 id="2-åºç¨ç¤ºä¾">2. åºç¨ç¤ºä¾</h1>
<p>ä¸é¢éè¿ç¤ºä¾æ¥æ¼ç¤ºè¿ä¸¤ç§å¾å¨å®éåºæ¯ä¸­çåºç¨ã</p>
<h2 id="21-å¾åæ¡å½¢å¾">2.1. å¾åæ¡å½¢å¾</h2>
<pre><code class="language-python"># --- 1. æé æµè¯æ°æ® ---
# åè®¾æä»¬æ³æ¯è¾ä¸å¹´ä¸­æ¯ä¸ªæçå¹³åéæ°´é
æä»½ = [
    "ä¸æ",
    "äºæ",
    "ä¸æ",
    "åæ",
    "äºæ",
    "å­æ",
    "ä¸æ",
    "å«æ",
    "ä¹æ",
    "åæ",
    "åä¸æ",
    "åäºæ",
]
# çææ¨¡æçéæ°´éæ°æ® (åä½: mm)
np.random.seed(42)  # ä¸ºäºç»æå¯å¤ç°
éæ°´é = np.random.uniform(30, 150, size=len(æä»½))  # éæºçæ30-150mmçæ°æ®

# --- 2. åå»ºå¾å½¢ ---
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 7), facecolor="white")

# --- 2.1 ç»å¶ä¼ ç»æ¡å½¢å¾ ---
# ... çç¥ ...

# --- 2.2 ç»å¶å¾åæ¡å½¢å¾ ---
# è®¡ç®æ¯ä¸ªæ¡å½¢çè§åº¦ä½ç½®
# ... çç¥ ...

# ä½¿ç¨æåæ å­å¾
ax2 = plt.subplot(122, projection="polar")
# å³é®ï¼è®¾ç½® 'bottom' åæ°ä¸º inner_radiusï¼è¿æ ·æ¡å½¢å°±ä» inner_radius å¼å§ç»ï¼é¿åº¦ä¸º radii
bars = ax2.bar(
    theta,
    radii,
    width=0.4,
    bottom=inner_radius,
    color="lightcoral",
    edgecolor="darkred",
    alpha=0.7,
)

# æ·»å æ°å¼æ ç­¾ (å¨æ¡å½¢åé¨ï¼é è¿å¤ä¾§)
for angle, radius, month in zip(theta, radii, æä»½):
    ax2.text(
        angle,
        inner_radius + radius / 2,
        f"{radius:.1f}",
        ha="center",
        va="center",
        fontsize=8,
        color="black",
    )

# æ·»å æä»½æ è®° (å¨æ¡å½¢å¤é¨)
# ... çç¥ ...

# --- 3. æ¾ç¤ºå¾å½¢ ---
plt.tight_layout()
plt.show()
</code></pre>
<p>è¿æ®µä»£ç é¦åçæäºæ¨¡æçæåº¦éæ°´éæ°æ®ï¼ç¶åå¨åä¸ä¸ªå¾å½¢çªå£ä¸­åå»ºäºä¸¤ä¸ªå­å¾ã</p>
<p>å·¦ä¾§æ¯ä½¿ç¨ <code>plt.bar</code> åå»ºçä¼ ç»æ¡å½¢å¾ï¼å³ä¾§æ¯ä½¿ç¨ <code>plt.subplot(..., projection='polar')</code> å <code>ax.bar</code> åå»ºçå¾åæ¡å½¢å¾ã</p>
<p><strong>å¾åæ¡å½¢å¾</strong>å©ç¨äºæåæ ç³»ï¼å°ç±»å«ï¼æä»½ï¼åå¸å¨åå¨ä¸ï¼å°æ°å¼ï¼éæ°´éï¼æ å°å°å¾åé¿åº¦ä¸ã</p>

<p><img src="https://img2024.cnblogs.com/blog/83005/202601/83005-20260113230907232-60855079.png" alt="" loading="lazy"></p>
<p><strong>å¾åæ¡å½¢å¾</strong>æ¯ä¸ç§å¨æåæ ç³»ä¸ç»å¶çå¾è¡¨ï¼å¯ä»¥æä¾æ¯ä¼ ç»æ¡å½¢å¾æ´å·è§è§å¸å¼åçæ¿ä»£æ¹æ¡ãå®éè¿å¼§é¿æ¥è¡¨ç¤ºæ°å¼ï¼å¹¶ä¸å¯ä»¥ææå°å©ç¨ç©ºé´ï¼å°¤å¶æ¯å¨å¤çç±»å«è¾å¤æéè¦å¼ºè°å¨ææ§æ¨¡å¼ï¼ä¾å¦ææä»½æå­£åº¦åç»çæ°æ®ï¼æ¶ã</p>
<h2 id="22-åå½¢æ¡å½¢å¾">2.2. åå½¢æ¡å½¢å¾</h2>
<pre><code class="language-python">from matplotlib import cm
from math import log10

labels = list("ABCDEFG")
data = [21, 57, 88, 14, 76, 91, 26]
# ... çç¥ ...

#create colors along a chosen colormap
colors = [cm.terrain(i / n) for i in range(n)]

#create figure, axis
fig, ax = plt.subplots()

#create rings of donut chart
for i in range(n):
    current_outer_radius = r - i * w
    innerring, _ = ax.pie([m - data[i], data[i]], 
                          radius = current_outer_radius, 
                          startangle = 90, 
                          colors = ["white", colors[i]])

    # æ·»å æ ç­¾
    # ... çç¥ ...

plt.show()
</code></pre>

<p><img src="https://img2024.cnblogs.com/blog/83005/202601/83005-20260113230907034-1742470964.png" alt="" loading="lazy"></p>
<p><strong>åå½¢æ¡å½¢å¾</strong>ä»åä¸åºåçº¿å¼å§ï¼é¿åäº<strong>å¾åæ¡å½¢å¾</strong>ä¸­ä¸åè§åº¦èµ·å§ç¹ä¸åçé®é¢ï¼æ´å ä¾¿äºæ¯è¾ã</p>
<h1 id="3-æ»ç»">3. æ»ç»</h1>
<p><strong>å¾åæ¡å½¢å¾</strong>å<strong>åå½¢æ¡å½¢å¾</strong>ä»£è¡¨äºæ°æ®å¯è§åä»çº¯åè½ååè½ç¾å­¦å¹³è¡¡çæ¼è¿ã</p>
<p>å®ä»¬ä¸æ¯è¦å®å¨åä»£ä¼ ç»æ¡å½¢å¾ï¼èæ¯ä¸ºæä»¬æä¾äºæ´å¤è§è§åäºçå·¥å·ã</p>
<p>å°±åä¸ä½çç»çå¨å¸æ¥æå¤ç§åå·ä¸æ ·ï¼ä¼ç§çæ°æ®åæå¸ä¹åºè¯¥ææ¡å¤ç§å¯è§åææ¯ï¼æ ¹æ®æ°æ®ç¹æ§åæ²éç®æ éæ©æåéç"åå·"ã</p>
<p>å½ä½ çæ°æ®è®²è¿°çå¨ææ§çæäºï¼æéè¦å¨æéç©ºé´åè¿è¡å¤ç»´åº¦æ¯è¾æ¶ï¼ä¸å¦¨å°è¯è¿äºåå½¢å¯è§åæ¹æ³ãå®ä»¬ä¸ä»è½æ´ææå°ä¼ è¾¾ä¿¡æ¯ï¼è¿è½ä¸ºä½ çæ¥åæä»ªè¡¨æ¿å¢æ·»ç¬ç¹çè§è§é­åã</p>
<p>æå¥½çå¯è§åä¸æ¯æå¤æçï¼èæ¯æè½æ¸æ°ä¼ è¾¾æ°æ®æäºçã</p>
<p><strong>å¾å</strong>å<strong>åå½¢æ¡å½¢å¾</strong>æ­£æ¯è¿æ ·ä¸ç§å·¥å·ï¼å¨ä¼ ç»ä¸ç°ä»£ä¹é´ï¼å¨åè½ä¸ç¾å­¦ä¹é´ï¼æ¾å°äºä¼éçå¹³è¡¡ç¹ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 23:10">2026-01-13 23:10</span>&nbsp;
<a href="https://www.cnblogs.com/wang_yb">wang_yb</a>&nbsp;
éè¯»(<span id="post_view_count">3</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479454);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479454', targetLink: 'https://www.cnblogs.com/wang_yb/p/19479454', title: 'å½æ¡å½¢å¾éä¸æåæ ï¼å¾åä¸åå½¢æ¡å½¢å¾çè§è§é©å½' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Spring çè¥¿è¥¿å¼æ¯ä¹ç³ï¼çè§£ BeanFactoryãFactoryBean ä¸ ObjectFactory ]]></title>
    <link>https://www.cnblogs.com/xzqcsj/p/19479429</link>
    <guid>5f42092059049f38cc1030daeae31568</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xzqcsj/p/19479429" title="åå¸äº 2026-01-13 22:46">
    <span role="heading" aria-level="2">Spring çè¥¿è¥¿å¼æ¯ä¹ç³ï¼çè§£ BeanFactoryãFactoryBean ä¸ ObjectFactory</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3703499/202601/3703499-20260113224556329-1020363253.png" alt="Spring çè¥¿è¥¿å¼æ¯ä¹ç³ï¼çè§£ BeanFactoryãFactoryBean ä¸ ObjectFactory" class="desc_img">
        ä»å¤©ï¼ä»£ç åæ¥éäºãæèä¹è®¸æ¯æ¨å¤©ï¼æä¸æ¸æ¥ã
ä¸ç®¡ææ ·ï¼Spring å®¹å¨æåºäºä¸ä¸ª BeanCreationExceptionãä¸ºäºè§£å³å®ï¼æè¢«è¿«æ½å¥æ¡æ¶çæ·±å¤ï¼å»æ³¨è§é£äºå¹³æ¶è¢« @Autowired æ©ççé½¿è½®ã
å¨ Spring çä¸çéï¼å­å¨çä¸ç§å¿ç¶çå¤ææ§ãè¿ç§å¤ææ§å¹¶éè®¾è®¡èçæ¶è¶£å³ï¼èæ¯ä¸ºäºå¨ä¸ä¸ªéæçè¯­è¨ä¸­æå»ºå¨æä¸çæä»åºçä»£ä»·ã
å¨è¿ä¸ªåºå¤§çæºå¨ä¸­ï¼æä¸ä¸ªåå­æå¶ç¸ä¼¼çæ¦å¿µç»å¸¸è¢«æ··æ·ï¼BeanFactoryãFactoryBean å ObjectFactoryãè¿å¹¶ä¸æ¯å½åçè´«ç ï¼èæ¯å®ä»¬å¨æ¬è´¨ä¸ç¡®å®å­å¨çå¾®å¦ççº ç¼ ã
ä»å¤©ï¼æä»¬å¥ç¦»æé£äºè±å¨çæ¯å»åæ ç¨çç³è¡£ï¼ç¨ä¸ç§å·éçãè¿ä¹è§£åå­¦çè§è§ï¼å»å®¡è§è¿ä¸ä¸ªæ¦å¿µçæ¬è´¨ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>ä»å¤©ï¼ä»£ç åæ¥éäºãæèä¹è®¸æ¯æ¨å¤©ï¼æä¸æ¸æ¥ã<br>
ä¸ç®¡ææ ·ï¼Spring å®¹å¨æåºäºä¸ä¸ª <code>BeanCreationException</code>ãä¸ºäºè§£å³å®ï¼æè¢«è¿«æ½å¥æ¡æ¶çæ·±å¤ï¼å»æ³¨è§é£äºå¹³æ¶è¢« <code>@Autowired</code> æ©ççé½¿è½®ã</p>
<p>å¨ Spring çä¸çéï¼å­å¨çä¸ç§å¿ç¶çå¤ææ§ãè¿ç§å¤ææ§å¹¶éè®¾è®¡èçæ¶è¶£å³ï¼èæ¯ä¸ºäºå¨ä¸ä¸ªéæçè¯­è¨ä¸­æå»ºå¨æä¸çæä»åºçä»£ä»·ã</p>
<p>å¨è¿ä¸ªåºå¤§çæºå¨ä¸­ï¼æä¸ä¸ªåå­æå¶ç¸ä¼¼çæ¦å¿µç»å¸¸è¢«æ··æ·ï¼<code>BeanFactory</code>ã<code>FactoryBean</code> å <code>ObjectFactory</code>ãè¿å¹¶ä¸æ¯å½åçè´«ç ï¼èæ¯å®ä»¬å¨æ¬è´¨ä¸ç¡®å®å­å¨çå¾®å¦ççº ç¼ ã</p>
<p>ä»å¤©ï¼æä»¬å¥ç¦»æé£äºè±å¨çæ¯å»åæ ç¨çç³è¡£ï¼ç¨ä¸ç§å·éçãè¿ä¹è§£åå­¦çè§è§ï¼å»å®¡è§è¿ä¸ä¸ªæ¦å¿µçæ¬è´¨ã</p>
<hr>
<h2 id="ä¸beanfactoryå­å¨çå®¹å¨">ä¸ãBeanFactoryï¼å­å¨çå®¹å¨</h2>
<p><strong>è®©æä»¬é¦åçº æ­£ä¸ä¸ªè§å¿µï¼BeanFactory åä¸ºå·¥åï¼ä½å¶æ¬è´¨æ¯å®¹å¨ï¼Containerï¼ã</strong></p>
<p>å½æä»¬è°è®º Spring å®¹å¨æ¶ï¼æä»¬å®éä¸æ¯å¨è°è®º <code>BeanFactory</code>ãå®æ¯ Spring IoC å®¹å¨çæ ¹æ¥å£ï¼æ¯æ´ä¸ªä¸ççç©çæ³åã</p>
<h3 id="11-å¯ä¸çèè´£">1.1 å¯ä¸çèè´£</h3>
<p>å®çå®ä¹æå¶åå¶ãå®ä¸å³å¿ä¸å¡é»è¾ï¼åªå³å¿ä¸ä»¶äºï¼<strong>ç®¡çå¯¹è±¡ççå½å¨æ</strong>ã</p>
<pre><code class="language-java">public interface BeanFactory {
    Object getBean(String name) throws BeansException;
    &lt;T&gt; T getBean(String name, Class&lt;T&gt; requiredType);
    boolean containsBean(String name);
    // ...
}
</code></pre>
<p>å½ä½ å¯å¨ä¸ä¸ª Spring Boot åºç¨æ¶ï¼<code>ApplicationContext</code> å°±åä¸ä¸ªåæ»¡æ´»åçåå¸ï¼è <code>BeanFactory</code> åæ¯æ¯æè¿åº§åå¸çå°ä¸ç®¡ç½ãææç BeanDefinitionï¼å³äº Bean åºè¯¥å¦ä½åå»ºçèå¾ï¼é½æ³¨åå¨è¿éã</p>
<h3 id="12-æ®é·çç°å®">1.2 æ®é·çç°å®</h3>
<p>å¨å¤§å¤æ°æåµä¸ï¼ä½ ä¸éè¦ç´æ¥ä¸ <code>BeanFactory</code> å¯¹è¯ãå ä¸º <code>ApplicationContext</code> å·²ç»ä¸ºä½ å°è£å¥½äºä¸åã<br>
ä½å½ä½ è¯å¾çè§£ä¸ºä»ä¹ä½ ç Bean æ²¡æè¢«æ­£ç¡®åå§åï¼æèä¸ºä»ä¹ä½ çå¾ªç¯ä¾èµå¤±ææ¶ï¼ä½ å°±å¿é¡»æè¯å°ï¼<strong>ä½ ææç Beanï¼é½åªæ¯ <code>BeanFactory</code> ä¸­ç entriesï¼æ¡ç®ï¼ã</strong></p>
<p>å®æ¯ä¸ä¸ªå·¨å¤§ç <code>Map&lt;String, BeanDefinition&gt;</code> å <code>Map&lt;String, Object&gt;</code> çç®¡çèãå®å·é·æ æï¼åªæç§å®ä¹çè§åï¼Scope, Lazy, Dependenceï¼æ¥å®ä¾åå¯¹è±¡ã</p>
<hr>
<h2 id="äºfactorybeanå¿è¦çæ¬ºéª">äºãFactoryBeanï¼å¿è¦çæ¬ºéª</h2>
<p>å¦æè¯´ <code>BeanFactory</code> æ¯å®è§è§åçå¶å®èï¼é£ä¹ <code>FactoryBean</code> å°±æ¯å¾®è§è§åç<strong>æ½è¡è</strong>ã</p>
<h3 id="21-éæè¯­è¨çå°å¢">2.1 éæè¯­è¨çå°å¢</h3>
<p>æ³è±¡è¿æ ·ä¸ä¸ªåºæ¯ï¼<strong>ä½ éè¦æ³¨å¥ä¸ä¸ªæ¥å£çå®ç°ï¼ä½è¿ä¸ªå®ç°ç±»å¹¶ä¸å­å¨äºä»£ç ä¸­ï¼å®æ¯éè¿å¨æä»£çå¨è¿è¡æ¶çæçã</strong><br>
è¿å¨ RPC æ¡æ¶ï¼å¦ DubboãFeignï¼å ORM æ¡æ¶ï¼å¦ MyBatisï¼ä¸­æå¶å¸¸è§ã</p>
<p>ä½ æ æ³éè¿ç®åç <code>&lt;bean class="..."&gt;</code> æ <code>@Component</code> æ¥æè¿°ä¸ä¸ªâä¸å­å¨çç±»âã<br>
è¿æ¶åï¼ä½ éè¦ä¸ä¸ªä¸­é´äººãè¿ä¸ªä¸­é´äººè¡¨é¢ä¸æ¯ä¸ä¸ªæ®éç Beanï¼ä½å®éä¸ï¼å®æ¯ä¸ä¸ªå·¥åã</p>
<h3 id="22-ä¼ªè£çèºæ¯ä»¥-mybatis-ä¸ºä¾">2.2 ä¼ªè£çèºæ¯ï¼ä»¥ MyBatis ä¸ºä¾</h3>
<p>ä¸ºä»ä¹ä½ åªéè¦åä¸ä¸ª <code>UserMapper</code> æ¥å£ï¼å°±è½ç´æ¥ <code>@Autowired</code> ä½¿ç¨ï¼<br>
å ä¸º Spring å®¹å¨éæ³¨åçé£ä¸ª "userMapper" Beanï¼æ ¹æ¬ä¸æ¯ä½ çæ¥å£å®ç°ï¼èæ¯ä¸ä¸ª <code>MapperFactoryBean</code>ã</p>
<pre><code class="language-java">// ç®åçé»è¾ç¤ºæ
public class MapperFactoryBean&lt;T&gt; implements FactoryBean&lt;T&gt; {
    
    private Class&lt;T&gt; mapperInterface;

    @Override
    public T getObject() throws Exception {
        // å¾éè·è¿ï¼æç»è¿éåçäºé­æ³ï¼éè¿ JDK å¨æä»£ççææ¥å£çå®
        return (T) Proxy.newProxyInstance(
            mapperInterface.getClassLoader(), 
            new Class[] { mapperInterface }, 
            new MapperProxy&lt;&gt;()
        );
    }

    @Override
    public Class&lt;?&gt; getObjectType() {
        return mapperInterface;
    }

    @Override
    public boolean isSingleton() {
        return true;
    }
}
</code></pre>
<h3 id="23-è¿éççç¸">2.3 è¿éççç¸</h3>
<p>å½å®¹å¨è°ç¨ <code>getBean("userMapper")</code> æ¶ï¼å®åç°è¿æ¯ä¸ä¸ª <code>FactoryBean</code>ãäºæ¯ï¼å®ä¸ä¼è¿å <code>FactoryBean</code> å®ä¾æ¬èº«ï¼èæ¯é»é»å°è°ç¨ <code>getObject()</code>ï¼å¹¶è¿åé£ä¸ªä»£çå¯¹è±¡ã</p>
<p>è¿å°±æ¯æ¬ºéªã<strong>ä½ ä»¥ä¸ºä½ æ¿å°äºä¸ä¸ª Beanï¼å¶å®ä½ æ¿å°çæ¯ Bean çäº§çäº§åã</strong></p>
<p>å¦æä½ æ¸´æçå°çç¸ï¼çå°é£ä¸ªæçºµåå¡çå¹åé»æï¼ä½ éè¦å¨ Bean åç§°åå ä¸ <code>&amp;</code>ï¼</p>
<pre><code class="language-java">// è·åçæ¯ MapperProxy ä»£çå¯¹è±¡
Object product = context.getBean("userMapper"); 

// è·åçæ¯ FactoryBean å·¥åæ¬èº«
Object factory = context.getBean("&amp;userMapper");
</code></pre>
<hr>
<h2 id="ä¸objectfactoryæ¶é´çå»¶è¿">ä¸ãObjectFactoryï¼æ¶é´çå»¶è¿</h2>
<p><code>BeanFactory</code> è´è´£ææ§ç©ºé´ï¼å®¹å¨ï¼ï¼<code>FactoryBean</code> è´è´£ææ§æé ï¼é»è¾ï¼ï¼è <code>ObjectFactory</code> åæ¯ä¸ºäºææ§<strong>æ¶é´</strong>ã</p>
<h3 id="31-å¾ªç¯çæ­»ç»">3.1 å¾ªç¯çæ­»ç»</h3>
<p>å¨ Spring çä¸çéï¼æä¸ä¸ªç»å¸çèè°¬ï¼A éè¦ Bï¼B éè¦ Aã<br>
å¦ææ¯æé å¨æ³¨å¥ï¼åªéå¦ç¶æ¿è®¤å¤±è´¥ãä½å¦ææ¯ Setter æ³¨å¥ï¼Spring è¯å¾æ½æè¿ç§æ­»ç»ã</p>
<p>å¨ A åå»ºçè¿ç¨ä¸­ï¼éè¦æ³¨å¥ BãB åå»ºæ¶ï¼åéè¦æ³¨å¥ Aã<br>
æ­¤æ¶ A è¿å¨åå»ºä¸­ï¼å°ä¸æ¯ä¸ä¸ªå®æ´ç Beanãæä¹åï¼<br>
Spring å¼å¥äºä¸çº§ç¼å­çæ¦å¿µãèç¬¬ä¸çº§ç¼å­ï¼å­æ¾çå°±æ¯ä¸ä¸ª <code>ObjectFactory</code>ã</p>
<h3 id="32-åè°çæ¬è´¨">3.2 åè°çæ¬è´¨</h3>
<p><code>ObjectFactory</code> å¨æºç ä¸­ç®åå¾ä»¤äººåæï¼</p>
<pre><code class="language-java">@FunctionalInterface
public interface ObjectFactory&lt;T&gt; {
    T getObject() throws BeansException;
}
</code></pre>
<p>å®åªæ¯ä¸ä¸ª<strong>å½æ°å¼æ¥å£</strong>ï¼ä¸ä¸ªåè°ã<br>
å®å­å¨çæä¹å¨äºï¼<strong>æç°å¨ä¸æ³è¦è¿ä¸ªå¯¹è±¡ï¼ä½ææ³è¦ä¸ä¸ªâå¨æªæ¥æä¸ªæ¶å»è½è·åè¿ä¸ªå¯¹è±¡âçè½åã</strong></p>
<p>å¨å¾ªç¯ä¾èµä¸­ï¼Spring æåæ´é²äºä¸ä¸ª <code>ObjectFactory</code>ï¼</p>
<pre><code class="language-java">addSingletonFactory(beanName, () -&gt; getEarlyBeanReference(beanName, mbd, bean));
</code></pre>
<p>å½ B éè¦ A æ¶ï¼å®éè¿è¿ä¸ª <code>ObjectFactory</code> æ¿å°äº A çæ©æå¼ç¨ï¼Early Referenceï¼ãå°½ç®¡ A è¿æ²¡å®å¨åå§åå¥½ï¼ä½ B å·²ç»å¯ä»¥ææå®çå¼ç¨äºãæ­»ç»è§£å¼äºã</p>
<h3 id="33-ä½ç¨åçéä½">3.3 ä½ç¨åçéä½</h3>
<p>å¦ä¸ä¸ªåºæ¯æ¯ï¼ä¸ä¸ªåä¾ï¼Singletonï¼ç Service éè¦ä½¿ç¨ä¸ä¸ª ååï¼Prototypeï¼ç Beanã<br>
å¦æä½ ç´æ¥ <code>@Autowired</code>ï¼ååç Bean åªæå¨ Service åå»ºæ¶è¢«æ³¨å¥ä¸æ¬¡ï¼ä¹åä¹å°±æ¯æ°¸è¿åä¸ä¸ªå¯¹è±¡äºãè¿è¿èäºååçåè¡·ã</p>
<p>å¦ä½è§£å³ï¼ä½¿ç¨ <code>ObjectFactory</code> å»¶è¿è·åã</p>
<pre><code class="language-java">@Service
public class ReportService {
    
    @Autowired
    private ObjectFactory&lt;ReportBuilder&gt; builderFactory;

    public void generate() {
        // æ¯æ¬¡è°ç¨ getObject()ï¼å®¹å¨é½ä¼åå»ºä¸ä¸ªå¨æ°ç ReportBuilder
        ReportBuilder builder = builderFactory.getObject();
        builder.build();
    }
}
</code></pre>
<p>å¨è¿éï¼<strong><code>ObjectFactory</code> å°±åæ¯ä¸ä¸ªéå¾å®¹å¨çå¥æï¼è®©ä½ éæ¶å¯ä»¥ä¼¸æè¿å»æ¿ä¸ä¸ªæ°çå¯¹è±¡ï¼èä¸æ¯å®çéæ§çç¼å­ã</strong></p>
<hr>
<h2 id="åå®¡å¤ä¸è£å³">åãå®¡å¤ä¸è£å³</h2>
<p>è®©æä»¬å¨æåï¼ç¨æå®¢è§çè¡¨æ ¼æ¥å®¡å¤è¿ä¸èçåºå«ãè¿ä¸æ¯ä¸ºäºèè¯µï¼èæ¯ä¸ºäºçæ¸æ··ä¹±ã</p>
<table>
<thead>
<tr>
<th style="text-align: left">ç»´åº¦</th>
<th style="text-align: left">BeanFactory</th>
<th style="text-align: left">FactoryBean</th>
<th style="text-align: left">ObjectFactory</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><strong>å­å¨å½¢å¼</strong></td>
<td style="text-align: left"><strong>å®¹å¨</strong> (Container)</td>
<td style="text-align: left"><strong>Bean</strong> (Component)</td>
<td style="text-align: left"><strong>æ¥å£</strong> (Interface/Callback)</td>
</tr>
<tr>
<td style="text-align: left"><strong>åºå±é»è¾</strong></td>
<td style="text-align: left"><code>ApplicationContext</code> çç¶çº§æ¥å£ / <strong>å®è§å·¥å</strong></td>
<td style="text-align: left">å®ç°äº <code>FactoryBean</code> æ¥å£çç±» / <strong>å¾®è§å·¥å</strong></td>
<td style="text-align: left">å½æ°å¼æ¥å£ / <strong>å»¶è¿åè°</strong></td>
</tr>
<tr>
<td style="text-align: left"><strong>æ ¸å¿èè´£</strong></td>
<td style="text-align: left">ç®¡çææ Bean ççå½å¨æ</td>
<td style="text-align: left">æ­¤ Bean è´è´£<strong>çäº§</strong>å¦ä¸ä¸ªå¤æç Bean</td>
<td style="text-align: left">å°è£å¯¹è±¡çåå»ºè¿ç¨ï¼æä¾<strong>å»¶è¿</strong>è·åè½å</td>
</tr>
<tr>
<td style="text-align: left"><strong>è·åæ¹å¼</strong></td>
<td style="text-align: left"><code>ApplicationContext</code> æ¯å®çè¶é</td>
<td style="text-align: left"><code>getBean("name")</code> æ¿äº§å<br><code>getBean("&amp;name")</code> æ¿å·¥å</td>
<td style="text-align: left">æ³¨å¥ <code>ObjectFactory&lt;T&gt;</code> åè°ç¨ <code>getObject()</code></td>
</tr>
<tr>
<td style="text-align: left"><strong>çå®åºæ¯</strong></td>
<td style="text-align: left">Spring æ¡æ¶çåºç³</td>
<td style="text-align: left">Mybatis <code>MapperFactoryBean</code>, <code>ProxyFactoryBean</code></td>
<td style="text-align: left">è§£å³å¾ªç¯ä¾èµ(ä¸çº§ç¼å­), Scope(ååæ¨¡å¼)éé</td>
</tr>
</tbody>
</table>
<h2 id="äºç»è¯­">äºãç»è¯­</h2>
<p>å¨ä»£ç çèåä¸ï¼æä»¬éè¿æå»ºæ½è±¡æ¥å¯¹ææ··ä¹±ã</p>
<ul>
<li><strong>BeanFactory</strong> æ¯æä»¬èä¸çå¤§å°ã<strong>å®è¢«ç§°ä¸ºå·¥åï¼ä½å®å®éæ¯å­è²ä¸ç©çåå£¤ï¼å®¹å¨ï¼ã</strong></li>
<li><strong>FactoryBean</strong> æ¯æä»¬æä¸­çç²¾å¯æºåºã<strong>å®æ¯ä¸ä¸ªç¹æ®ç Beanï¼å­å¨çç®çå´æ¯ä¸ºäºå¶é å¦ä¸ä¸ª Beanã</strong></li>
<li><strong>ObjectFactory</strong> æ¯æä»¬é¢ççæ¶é´è¶åã<strong>å®åªæ¯ä¸ä¸ªåçº¯çæ¥å£ï¼ä¸ºäºåºå¯¹å¾ªç¯ä¸æªæ¥çä¸ç¡®å®æ§ã</strong></li>
</ul>
<p>çè§£å®ä»¬ï¼å¹¶ä¸æ¯ä¸ºäºéè¿é¢è¯ï¼èæ¯ä¸ºäºå¨ä¸ä¸æ¬¡æåºå¼å¸¸æ¶ï¼ä½ è½å·éå°åè§å æ ä¿¡æ¯ï¼ç¥éæºå¨çåªä¸ªé½¿è½®åçäºéä½ã</p>
<p>æ¢ç¶æä»¬éæ©äºä¸æºå¨å±èï¼å°±å¿é¡»çè§£æºå¨çé»è¾ãè¿æè®¸å°±æ¯ä½ä¸ºå¼åèçè¥¿è¥¿å¼æ¯å¼å½è¿ââ<strong>æä»¬éè¦ä¸æ¬¡åä¸æ¬¡å°å°å·¨ç³æ¨åå±±é¡¶ï¼ä»¥æ­¤è¯ææä»¬å¯¹è¿ä¸ªåºå¤§ç³»ç»çææ§</strong>ã</p>
<blockquote>
<p><strong>æ¬æéè¿ AI æ¶¦è²ï¼å ç¼ªé£æ ¼ï¼ï¼è¯å¾ä»¥ä¸ç§å·éãå®¢è§çè³å­å¨ä¸»ä¹çè§è§ï¼å»è§£æè¿äºå¨æ¥å¸¸ Coding ä¸­è¢«æä»¬ä¹ ä»¥ä¸ºå¸¸çæ¦å¿µãå¸æè¿ç§ç¬ç¹çåäºé£æ ¼ï¼è½è®©ä½ å¯¹è¿äºæ¯ç¥çææ¯æ¦å¿µææ´æ·±å»çâå­å¨æâã</strong></p>
</blockquote>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 22:47">2026-01-13 22:46</span>&nbsp;
<a href="https://www.cnblogs.com/xzqcsj">ä¸æäºº</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479429);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479429', targetLink: 'https://www.cnblogs.com/xzqcsj/p/19479429', title: 'Spring çè¥¿è¥¿å¼æ¯ä¹ç³ï¼çè§£ BeanFactoryãFactoryBean ä¸ ObjectFactory' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬ä¸å¨ï¼å¾ªç¯ç¥ç»ç½ç» ï¼ä¸ï¼åå RNN ä¸æ·±å± RNN ]]></title>
    <link>https://www.cnblogs.com/Goblinscholar/p/19479253</link>
    <guid>837c20fdbd1f629c1bd95d615a2a784e</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Goblinscholar/p/19479253" title="åå¸äº 2026-01-13 22:37">
    <span role="heading" aria-level="2">å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬ä¸å¨ï¼å¾ªç¯ç¥ç»ç½ç» ï¼ä¸ï¼åå RNN ä¸æ·±å± RNN</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æ­¤åç±»ç¨äºè®°å½å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨çå­¦ä¹ ç¬è®°ã<br>
è¯¾ç¨ç¸å³ä¿¡æ¯é¾æ¥å¦ä¸ï¼</p>
<ol>
<li>åè¯¾ç¨è§é¢é¾æ¥ï¼<a href="https://www.bilibili.com/video/BV1FT4y1E74V?buvid=XU762317353676D786954061C192FE625463B&amp;from_spmid=playlist.playlist-detail.0.0&amp;is_story_h5=false&amp;mid=zqernykrmpf7XfIorMR%2FnA%3D%3D&amp;plat_id=116&amp;share_from=ugc&amp;share_medium=android&amp;share_plat=android&amp;share_session_id=ce0bc526-db69-428a-962e-c65ed8c267bc&amp;share_source=COPY&amp;share_tag=s_i&amp;spmid=united.player-video-detail.0.0&amp;timestamp=1713085655&amp;unique_k=DfBgvFW&amp;up_id=8654113&amp;vd_source=e035e9878d32f414b4354b839a4c31a4" target="_blank" rel="noopener nofollow">[åè¯­å­å¹]å´æ©è¾¾æ·±åº¦å­¦ä¹ deeplearning.ai</a></li>
<li>githubè¯¾ç¨èµæï¼å«è¯¾ä»¶ä¸ç¬è®°:<a href="https://github.com/robbertliu/deeplearning.ai-andrewNG" target="_blank" rel="noopener nofollow">å´æ©è¾¾æ·±åº¦å­¦ä¹ æå­¦èµæ</a></li>
<li>è¯¾ç¨éå¥ç»ä¹ ï¼ä¸­è±ï¼ä¸ç­æ¡ï¼<a href="https://blog.csdn.net/u013733326/article/details/79827273" target="_blank" rel="noopener nofollow">å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾åä¹ é¢ä¸ç­æ¡</a></li>
</ol>
<p>æ¬ç¯ä¸ºç¬¬äºè¯¾çç¬¬ä¸å¨åå®¹ï¼<a href="https://www.bilibili.com/video/BV1FT4y1E74V?spm_id_from=333.788.videopod.episodes&amp;vd_source=e035e9878d32f414b4354b839a4c31a4&amp;p=161" target="_blank" rel="noopener nofollow">1.11</a>å°<a href="https://www.bilibili.com/video/BV1FT4y1E74V?spm_id_from=333.788.videopod.episodes&amp;vd_source=e035e9878d32f414b4354b839a4c31a4&amp;p=162" target="_blank" rel="noopener nofollow">1.12</a>çåå®¹ï¼åæ¶ä¹æ¯æ¬å¨çè®ºé¨åçæåä¸ç¯ã</p>
<hr>
<p>æ¬å¨ä¸ºç¬¬äºè¯¾çç¬¬ä¸å¨åå®¹ï¼ä¸ CV ç¸å¯¹åºçï¼è¿ä¸è¯¾ææåå®¹çä¸­å¿åªæä¸ä¸ªï¼<strong>èªç¶è¯­è¨å¤çï¼Natural Language Processingï¼NLPï¼</strong>ã<br>
åºç¨å¨æ·±åº¦å­¦ä¹ éï¼å®æ¯ä¸é¨ç¨æ¥è¿è¡<strong>ææ¬ä¸åºåä¿¡æ¯å»ºæ¨¡</strong>çæ¨¡ååææ¯ï¼æ¬è´¨ä¸æ¯å¨å¨è¿æ¥ç½ç»ä¸ç»è®¡è¯­è¨æ¨¡ååºç¡ä¸çä¸æ¬¡âç»æåç¹åâï¼ä¹æ¯äººå·¥æºè½ä¸­<strong>æè´´è¿äººç±»æç»´è¡¨è¾¾æ¹å¼</strong>çéè¦ç ç©¶æ¹åä¹ä¸ã<br>
<strong>è¿ä¸æ´èè¯¾åæ ·æ¶åå¤§ééè¦åå¤æ¶åçåå®¹ï¼æ¨ªè·¨æºå¨å­¦ä¹ ãæ¦çç»è®¡ãçº¿æ§ä»£æ°ä»¥åè¯­è¨å­¦ç´è§ã</strong><br>
è¯­è¨ä¸åå¾åé£æ ·âç´è§å¯è§âï¼æ´å¤æ¯æ½è±¡ç¬¦å·ä¸ä¸ä¸æå³ç³»çç»åï¼å æ­¤<strong>çè§£é¨æ§åèæ´é«</strong>ã<br>
å æ­¤ï¼æåæ ·ä¼å°½éè¡¥è¶³å¿è¦çèæ¯ç¥è¯ï¼å°½å¯è½ç¨æ¯å»åå®ä¾éä½çè§£é¾åº¦ã<br>
æ¬ç¯çåå®¹å³äº<strong>åå RNN ä¸æ·±å± RNN</strong>ï¼æ¯å¯¹åºç¡ RNN ç»æçä¸äºè¡¥åã</p>
<h1 id="1-åå-rnnbidirectional-rnn">1. åå RNNï¼Bidirectional RNNï¼</h1>
<p>å¨åé¢å¯¹ <strong><a href="https://www.cnblogs.com/Goblinscholar/p/19449622" target="_blank">RNN</a>ã<a href="https://www.cnblogs.com/Goblinscholar/p/19463351" target="_blank">GRU</a> ä¸ <a href="https://www.cnblogs.com/Goblinscholar/p/19474433" target="_blank">LSTM</a></strong> çè®¨è®ºä¸­ï¼æä»¬å§ç»é»è®¤äºä¸ä¸ªåæï¼<strong>åºååªè½æ²¿æ¶é´è½´ååå±å¼ï¼æ¨¡åå¨å½åæ¶å»åªè½å©ç¨å·²ç»åºç°çåå²ä¿¡æ¯ã</strong></p>
<p>è¿ç§è®¾å®å¨ä¸äºç®åä»»å¡ä¸­æ¯åççï¼ä½å¨å¤§é<strong>åºåçè§£ä¸æ æ³¨ä»»å¡</strong>ä¸­ï¼å´éèçä¸ä¸ªç»ææ§éå¶ï¼  <strong>å½åæ¶å»çè¯­ä¹æç¶æï¼å¾å¾åæ¶ä¾èµäºè¿å»åæªæ¥çä¸ä¸æä¿¡æ¯ã</strong><br>
ä¸¾ä¸ªè¯¾ç¨éçä¾å­ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260113211513804-150472822.png" alt="image.png" loading="lazy"><br>
äºæ¯ï¼é®é¢åºç°äºï¼<strong>å¦ææªæ¥ä¿¡æ¯ææ¯å¤å®å½åç¶æçéè¦ä¾æ®ï¼è¯¥æä¹åï¼</strong></p>
<p>æ­£æ¯å¨è¿æ ·çèæ¯ä¸ï¼<strong>åå RNNï¼Bidirectional Recurrent Neural Networksï¼</strong> è¢«æåºã<br>
æ©å¨ <strong>1997 å¹´</strong>ï¼<strong><a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=650093" target="_blank" rel="noopener nofollow">Bidirectional Recurrent Neural Networks</a></strong> è¿ç¯è®ºæä¸­å°±æåºï¼å¯¹äºåºåæ æ³¨ä¸æ´ä½çè§£ä»»å¡ï¼ä»ä¾èµè¿å»ä¸ä¸æä¼é æä¿¡æ¯å©ç¨ä¸çåå¤©ä¸è¶³ï¼å æ­¤æå¿è¦å¨æ¨¡åç»æå±é¢<strong>åæ¶å»ºæ¨¡æ­£åä¸ååçæ¶é´ä¾èµå³ç³»</strong>ã</p>
<p>éè¦å¼ºè°çæ¯ï¼åå RNN å¹¶ä¸æ¯ä¸ç§æ°çå¾ªç¯ååè®¾è®¡ã<br>
å®å¹¶ä¸æ¹å RNNãLSTM æ GRU åé¨çè®¡ç®å½¢å¼ï¼èæ¯éè¿å¨æ¶é´ç»´åº¦ä¸å¼å¥<strong>ååä¸ååä¸¤æ¡ç¬ç«çç¶æä¼ æ­é¾è·¯</strong>ï¼ä½¿æ¨¡åå¨æ¯ä¸ä¸ªæ¶é´æ­¥é½è½å¤èå<strong>åå²ä¸æªæ¥çä¸ä¸æä¿¡æ¯</strong>ã</p>
<p>ä¹æ­£å ä¸ºè¿ç§âç»æç¬ç«äºååâçç¹æ§ï¼åå RNN å¯ä»¥èªç¶å°ä¸ LSTMãGRU ç»åï¼å½¢æ <strong>Bi-LSTMãBi-GRU</strong>ï¼æä¸ºæåä¸ä¸æå»ºæ¨¡è½åçæ åéç½®ã</p>
<p>å®çå®ç°é»è¾å¹¶ä¸å¤æï¼è¿éå¼ç¨ä¸å¼ æ¯è¾æ¸æ°ææçä¼ æ­å¾ï¼ï¼<a href="https://medium.com/@fraidoonomarzai99/bidirectional-rnn-in-depth-1efd32c3cf46" target="_blank" rel="noopener nofollow">åºå¤</a>ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260113211514563-1603287401.png" alt="image.png" loading="lazy"><br>
è¿æ ·ï¼ä½ å°±ä¼åç°ï¼åä¸åºåè¢« <strong>æ­£åï¼èè²ï¼</strong> å <strong>ååï¼ç»¿è²ï¼</strong> ä¸¤æ¡ RNN åæ¶å»ºæ¨¡ï¼æ¯ä¸ªæ¶é´æ­¥ <span class="math inline">\(t\)</span> é½è½âçå°âæ­£åçåå²ä¸ä¸æåååçæªæ¥ä¸ä¸æï¼æç»è¾åº <span class="math inline">\(\hat y^{\langle t\rangle}\)</span> ç±ä¸¤ä¸ªæ¹åçä¿¡æ¯å±åå³å®ã</p>
<p></p><div class="math display">\[h^{(t)}
=
\operatorname{concat}\!\left(
\overrightarrow{{h}^{(t)}},
\overleftarrow{{h}^{(t)}}
\right)
\quad \text{or} \quad
\overrightarrow{{h}^{(t)}} + \overleftarrow{{h}^{(t)}}
\]</div><p></p><p>å¨å®è·µä¸­ï¼åå RNN æ´å¸¸éç¨<strong>æ¼æ¥æ¹å¼</strong>ä¿çæ¥èªä¸¤ä¸ªæ¶é´æ¹åçå®æ´ä¿¡æ¯ï¼è<strong>éåç´ ç¸å </strong>åæ¯ä¸ç§æ´ç´§åãä½è¡¨è¾¾è½ååéçæä¸­éæ©ã</p>
<p>æåï¼åæä¸ªæ¯æ¹ï¼æåºåæ¯ä½ä¸åº§<strong>è¦å»ºçæ¡¥</strong>ï¼åå RNN å°±åæ¯ä¸¤éå·¥äººä»ä¸¤ä¾§åæ¶æ½å·¥å¹¶ä¸æ­äº¤æµè¿åº¦ï¼ç¡®ä¿ç²¾åï¼ä½åæ¶ï¼æ½å·¥éä¼ç¿»åï¼æ´ä½ææ¬ä¹éä¹ä¸åã<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260113211553645-1826290875.png" alt="image.png" loading="lazy"></p>
<h1 id="2-æ·±å±-rnn">2. æ·±å± RNN</h1>
<p>æ·±å± RNN çæ¦å¿µåæ ·ä¸é¾çè§£ã<br>
å¨æå¼å§å¼å¥ <strong><a href="https://www.cnblogs.com/Goblinscholar/p/19449622" target="_blank">å¾ªç¯ç¥ç»ç½ç»</a></strong> æ¶ï¼æä»¬è¯´æè¿ï¼é»è®¤ä½¿ç¨<strong>åå± RNN</strong> æ¥è¿è¡æ¼ç¤ºï¼<br>
å¨æ¯ä¸ä¸ªæ¶é´æ­¥ <span class="math inline">\(t\)</span>ï¼è¾å¥ <span class="math inline">\(x^{(t)}\)</span> ç»è¿ä¸æ¬¡å¾ªç¯è®¡ç®ï¼å¾å°å¯¹åºçéèç¶æ <span class="math inline">\(a^{(t)}\)</span>ï¼å¹¶æ²¿æ¶é´è½´ä¸æ­ä¼ éã</p>
<p>ä½ä»æ¨¡åè¡¨è¾¾è½åçè§åº¦æ¥çï¼è¿ç§ç»æå­å¨éå¶ï¼<strong>æ¯ä¸ªæ¶é´æ­¥åé¨ï¼åªè¿è¡äºä¸æ¬¡éçº¿æ§åæ¢ã</strong><br>
è¿æå³çï¼æ è®ºåºåæ¬èº«æå¤å¤æï¼å¨âåä¸æ¶å»âå¯¹è¾å¥ä¿¡æ¯çå¤çæ·±åº¦é½æ¯æéçã<br>
å°è¿éï¼å°±åä¹åçå¨è¿æ¥ãå·ç§¯ç½ç»ç¸éäºï¼<br>
<strong>å¦ææä»¬å¸ææ¨¡åå¨æ¯ä¸ä¸ªæ¶é´æ­¥ä¸ï¼ä¹å·å¤ç±»ä¼¼æ·±åº¦åé¦ç½ç»ãå·ç§¯ç½ç»é£æ ·çå±çº§è¡¨è¾¾è½åï¼è¯¥æä¹åï¼</strong><br>
ç­æ¡èªç¶å°±æ¯ï¼<strong>å¨æ¶é´ç»´åº¦ä¹å¤ï¼åå¼å¥å±çº§ç»´åº¦ã</strong></p>
<p>å¨æ·±å± RNN ä¸­ï¼å¾ªç¯ç»æä¸ååªæä¸å±ï¼èæ¯<strong>å¨åä¸æ¶é´æ­¥ä¸å å å¤å± RNN åå</strong>ã<br>
å®çä¼ æ­å¾æ¯è¿æ ·çï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260113211513339-2004923823.png" alt="image.png" loading="lazy"><br>
å³äºæ·±åº¦çé»è¾åä¹åé½æ¯ç¸åçï¼æ·±å± RNN éè¿å¨åä¸æ¶é´æ­¥ä¸çå å ï¼è®©æ¨¡åå¯ä»¥è¿è¡æ´å¤æçéçº¿æ§åæ¢ï¼<strong>å¢å¼ºäºå¶è¡¨è¾¾è½å</strong>ãä½åæ ·ä¹ä¼å¢å è®¡ç®ææ¬ï¼<strong>å¸¦æ¥æ¢¯åº¦é®é¢ä¸è¿æåé£é©</strong>ï¼è¿äºé½æ¯æä»¬çèçå¸¸è°äºã</p>
<p>äºæ­¤åæ¶ï¼ååå RNN ç±»ä¼¼ï¼<strong>æ·±å±ç»æåæ ·ç¬ç«äºå·ä½çå¾ªç¯ååè®¾è®¡</strong>ã  èä¸å¨å·¥ç¨å®è·µä¸­ï¼<strong>æ·±åº¦ãæ¹åæ§åé¨æ§æºå¶å¾å¾æ¯å¯ä»¥åæ¶å å ç</strong>ï¼ä¾å¦ï¼</p>
<ul>
<li>å¤å± Bi-LSTM</li>
<li>å¤å± Bi-GRU</li>
</ul>
<p>æä»¬æåä¸ªç»ä»¶ç»åæåæ°ï¼ä¾¿å½¢æäºæ·±åº¦å­¦ä¹  NLP ä¸­çº·ç¹å¤æçè¯¸å¤æ¨¡åã</p>
<p>æåï¼å¦æç»§ç»­æ²¿ç¨åé¢çæ¯å»ï¼<br>
<strong>åå RNN</strong> åæ¯ä»æ¡¥çä¸¤ç«¯åæ¶æ½å·¥ã<br>
é£ä¹ <strong>æ·±å± RNN</strong> æ´åæ¯ï¼ æ¯ä¸ä¸ªæ½å·¥ç¹ä¸ï¼ä¸åªæ¯éºä¸å±è·¯é¢ï¼èæ¯<strong>ä¸å±å±æå°åºãå ç»æãåéºè¡¨å±ã</strong> è¿æ ·ç»ææ´ç¨³ãè¡¨è¾¾æ´å¼ºï¼ä½æ½å·¥æµç¨æ´å¤æï¼ææ¬åè®­ç»é¾åº¦ä¹éä¹ä¸åã<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260113211517590-653078512.png" alt="image.png" loading="lazy"></p>
<h1 id="3æ»ç»">3.æ»ç»</h1>
<table>
<thead>
<tr>
<th>æ¦å¿µ</th>
<th>åç</th>
<th>æ¯å»</th>
</tr>
</thead>
<tbody>
<tr>
<td>åå RNNï¼Bidirectional RNNï¼</td>
<td>å¨æ¶é´ç»´åº¦ä¸å¼å¥<strong>æ­£ååååä¸¤æ¡ç¬ç«ç¶æé¾è·¯</strong>ï¼æ¯ä¸ªæ¶é´æ­¥åæ¶å©ç¨è¿å»åæªæ¥ä¸ä¸æä¿¡æ¯ãéç¨äºåºåæ æ³¨ä¸æ´ä½çè§£ä»»å¡ãå¯ä»¥ä¸ RNN/LSTM/GRU ç»åï¼å½¢æ Bi-RNNãBi-LSTMãBi-GRUã</td>
<td>åºåæ¯ä½æ¡¥ï¼ä¸¤éå·¥äººä»ä¸¤ç«¯åæ¶æ½å·¥å¹¶äº¤æµè¿åº¦ï¼ç¡®ä¿ç²¾åï¼ä½æ½å·¥éä¼ç¿»åï¼ææ¬å¢å ã</td>
</tr>
<tr>
<td>æ·±å± RNNï¼Deep RNNï¼</td>
<td>å¨åä¸æ¶é´æ­¥ä¸<strong>å å å¤å± RNN åå</strong>ï¼å¢å æ¯ä¸ªæ¶é´æ­¥åé¨çéçº¿æ§è¡¨è¾¾è½åï¼ä»èå¢å¼ºæ¨¡åçè¡¨ç¤ºè½åãå¯ä¸é¨æ§æºå¶åååç»æå å ï¼å½¢æå¤å± Bi-LSTMãBi-GRU ç­ã</td>
<td>æ¯ä¸ªæ½å·¥ç¹ä¸ä¸æ¯åªéºä¸å±è·¯é¢ï¼èæ¯<strong>ä¸å±å±æå°åºãå ç»æãåéºè¡¨å±</strong>ï¼ç»ææ´ç¨³ãè¡¨è¾¾æ´å¼ºï¼ä½æ½å·¥æµç¨å¤æï¼ææ¬åè®­ç»é¾åº¦å¢å ã</td>
</tr>
</tbody>
</table>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 22:37">2026-01-13 22:37</span>&nbsp;
<a href="https://www.cnblogs.com/Goblinscholar">å¥å¸æå­¦è</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479253);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479253', targetLink: 'https://www.cnblogs.com/Goblinscholar/p/19479253', title: 'å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬ä¸å¨ï¼å¾ªç¯ç¥ç»ç½ç» ï¼ä¸ï¼åå RNN ä¸æ·±å± RNN' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ synchronizedå³é®å­ç¸å³ ]]></title>
    <link>https://www.cnblogs.com/xi-yongqi/p/19479394</link>
    <guid>478f0dee31a30b459b4667c9d97a16b7</guid>
    <description>
    <![CDATA[ 
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xi-yongqi/p/19479394" title="åå¸äº 2026-01-13 22:24">
    <span role="heading" aria-level="2">synchronizedå³é®å­ç¸å³</span>
    

</a>

		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h5 id="synchronizedæ¯javaä¸­ç¨äºè§£å³å¹¶åé®é¢çæ ¸å¿å³é®å­å®éè¿ç¡®ä¿å¤ä¸ªçº¿ç¨å¯¹å±äº«èµæºçäºæ¥è®¿é®æ¥é¿åçº¿ç¨å®å¨é®é¢å¦ç«ææ¡ä»¶æ°æ®ä¸ä¸è´ç­">synchronizedæ¯Javaä¸­ç¨äºè§£å³å¹¶åé®é¢çæ ¸å¿å³é®å­ï¼å®éè¿ç¡®ä¿å¤ä¸ªçº¿ç¨å¯¹å±äº«èµæºçäºæ¥è®¿é®ï¼æ¥é¿åçº¿ç¨å®å¨é®é¢ï¼å¦ç«ææ¡ä»¶ãæ°æ®ä¸ä¸è´ç­ï¼ã</h5>
<h4 id="synchronizedçæ ¸å¿ç¹æ§">synchronizedçæ ¸å¿ç¹æ§</h4>
<ul>
<li>åå­æ§ï¼Atomicityï¼ï¼ç¡®ä¿ä¸ä¸ªæå¤ä¸ªæä½è¦ä¹å¨é¨æ§è¡æåï¼è¦ä¹å¨é¨æ§è¡å¤±è´¥ãå¨synchronizedä»£ç åä¸­çä»£ç æ¯ä¸å¯ä¸­æ­çï¼åä¸æ¶å»åªæä¸ä¸ªçº¿ç¨è½æ§è¡ã</li>
<li>å¯è§æ§ï¼Visibilityï¼ï¼ä¿è¯ä¸ä¸ªçº¿ç¨å¯¹å±äº«åéçä¿®æ¹ï¼å¯¹äºå¶ä»åç»­è¿å¥åæ­¥ä»£ç åççº¿ç¨æ¯å¯è§çãå½çº¿ç¨éæ¾éæ¶ï¼ä¼å°ç§æåå­ä¸­çåéå¼å·æ°åä¸»åå­ã</li>
<li>æåºæ§ï¼Orderingï¼ï¼è½ç¶ç¼è¯å¨åå¤çå¨ä¸ºäºä¼åä¼è¿è¡æä»¤éæï¼ä½synchronizedå¯ä»¥ä¿è¯å¤çº¿ç¨ç¨åºå¨é»è¾ä¸çæ§è¡é¡ºåºï¼å³âåæ­¥ååçä»£ç å¨æ§è¡ä¸å·æååé¡ºåºâã</li>
<li>å¯éå¥æ§ï¼å¯éå¥æ§æ¯æä¸ä¸ªçº¿ç¨å·²ç»è·åå°æä¸ªéåï¼åæ¬¡è¯·æ±è¯¥éæ¶å¯ä»¥ç´æ¥è·åï¼æ ééæ°ç«äºãsynchronizedæ¯å¯éå¥éï¼å¶åé¨éè¿è®¡æ°å¨è®°å½éçæææ¬¡æ°ï¼åå§ä¸º0ï¼è·åéæ¶å 1ï¼éæ¾éæ¶å1ï¼è®¡æ°å¨ä¸º0æ¶éæè¢«çæ­£éæ¾ï¼ãè¿ä¸ç¹æ§é¿åäºçº¿ç¨å¨éå½è°ç¨åæ­¥æ¹æ³/ä»£ç åæ¶åºç°æ­»éãä¾å¦ï¼ä¸ä¸ªåæ­¥æ¹æ³Aè°ç¨å¦ä¸ä¸ªåæ­¥æ¹æ³Bï¼ä¸¤èéå¯¹è±¡ç¸åï¼ï¼çº¿ç¨è·åAçéåï¼è°ç¨Bæ¶å¯ç´æ¥è·åéã</li>
</ul>
<h4 id="synchronizedçä½¿ç¨æ¹å¼">synchronizedçä½¿ç¨æ¹å¼</h4>
<h5 id="synchronizedçä½¿ç¨çµæ´»å¯ä¿®é¥°ä¸åçä»£ç ç»ææ ¸å¿æ¯æç¡®éå¯¹è±¡çº¿ç¨ç«äºçæ¯éå¯¹è±¡åªæè·åå°éå¯¹è±¡ççº¿ç¨æè½æ§è¡åæ­¥ä»£ç å¸¸è§ä½¿ç¨æ¹å¼æ3ç§">synchronizedçä½¿ç¨çµæ´»ï¼å¯ä¿®é¥°ä¸åçä»£ç ç»æï¼æ ¸å¿æ¯æç¡®âéå¯¹è±¡âââçº¿ç¨ç«äºçæ¯éå¯¹è±¡ï¼åªæè·åå°éå¯¹è±¡ççº¿ç¨æè½æ§è¡åæ­¥ä»£ç ï¼å¸¸è§ä½¿ç¨æ¹å¼æ3ç§ã</h5>
<ol>
<li>ä¿®é¥°å®ä¾æ¹æ³ï¼å¯¹è±¡éï¼ï¼è¯­æ³ï¼<code>public synchronized void methodName() { ... }</code></li>
</ol>
<ul>
<li>éå¯¹è±¡ï¼å½åç±»çå®ä¾å¯¹è±¡ï¼thisï¼ã</li>
<li>ç¹ç¹ï¼ä¸åå®ä¾å¯¹è±¡çéç¸äºç¬ç«ï¼å³å¤ä¸ªçº¿ç¨è®¿é®åä¸ä¸ªå®ä¾çåæ­¥å®ä¾æ¹æ³æ¶ä¼ç«äºéï¼è®¿é®ä¸åå®ä¾çåæ­¥å®ä¾æ¹æ³æ¶ï¼å éå¯¹è±¡ä¸åï¼ä¸ä¼ç«äºã</li>
<li>ç¤ºä¾ï¼åä¸Userå®ä¾çadd()æ¹æ³è¢«å¤çº¿ç¨è°ç¨æ¶äºæ¥ï¼ä¸åUserå®ä¾çadd()æ¹æ³å¯å¹¶è¡æ§è¡ã</li>
</ul>
<ol start="2">
<li>ä¿®é¥°éææ¹æ³ï¼ç±»éï¼è¯­æ³ï¼<code>public static synchronized void methodName() { ... }</code></li>
</ol>
<ul>
<li>éå¯¹è±¡ï¼å½åç±»çClasså¯¹è±¡ï¼æ¯ä¸ªç±»å¨JVMä¸­åªæä¸ä¸ªClasså¯¹è±¡ï¼æ¯å¨å±å¯ä¸çï¼ã</li>
<li>ç¹ç¹ï¼ç±»éæ¯å¨å±éï¼æ è®ºåå»ºå¤å°ä¸ªç±»çå®ä¾ï¼ææçº¿ç¨è®¿é®è¯¥ç±»çåæ­¥éææ¹æ³æ¶ï¼é½ä¼ç«äºåä¸ä¸ªClasså¯¹è±¡éã</li>
<li>æ³¨æï¼ç±»éä¸å¯¹è±¡éç¸äºç¬ç«ï¼å³åæ­¥éææ¹æ³ååæ­¥å®ä¾æ¹æ³çéå¯¹è±¡ä¸åï¼çº¿ç¨è®¿é®æ¶ä¸ä¼ç«äºã</li>
</ul>
<ol start="3">
<li>ä¿®é¥°ä»£ç åï¼èªå®ä¹éå¯¹è±¡ï¼ï¼è¯­æ³ï¼<code>synchronized (éå¯¹è±¡) { ... åæ­¥ä»£ç  ... }</code></li>
</ol>
<ul>
<li>éå¯¹è±¡ï¼å¯èªå®ä¹ï¼æ¯æä¸¤ç§ç±»åï¼â  å®ä¾å¯¹è±¡ï¼thisæå¶ä»å®ä¾ï¼ï¼â¡ Classå¯¹è±¡ï¼ç±»å.classï¼ã</li>
<li>ç¹ç¹ï¼ç²åº¦æç»ï¼å¯ç²¾åæ§å¶éè¦åæ­¥çä»£ç çæ®µï¼èéæ´ä¸ªæ¹æ³ï¼ï¼åå°éç«äºï¼æé«ç¨åºæ§è½ã</li>
<li>å¸¸è§åºæ¯ï¼
<ul>
<li>éå½åå®ä¾ï¼<code>synchronized (this) { ... }</code>ï¼ææä¸ä¿®é¥°å®ä¾æ¹æ³ä¸è´ï¼ä½ä»åæ­¥ä»£ç ååçé»è¾ã</li>
<li>éClasså¯¹è±¡ï¼<code>synchronized (User.class) { ... }</code>ï¼ææä¸ä¿®é¥°éææ¹æ³ä¸è´ã</li>
<li>éèªå®ä¹å¯¹è±¡ï¼<code>private Object lock = new Object(); synchronized (lock) { ... }</code>ï¼éè¿ç¬ç«çéå¯¹è±¡ï¼é¿åä¸å¶ä»åæ­¥é»è¾ç«äºéï¼çµæ´»æ§æé«ã</li>
</ul>
</li>
</ul>
<h4 id="synchronizedçéæºå¶">synchronizedçéæºå¶</h4>
<ul>
<li>Java 6åä»¥åå¯¹synchronizedè¿è¡äºå¤§å¹ä¼åï¼å¼å¥äºâååéãè½»éçº§éãééçº§éâä¸ç§éç¶æï¼ç®çæ¯æ ¹æ®çº¿ç¨ç«äºçæ¿çç¨åº¦å¨æåæ¢éç¶æï¼å¹³è¡¡æ§è½ä¸çº¿ç¨å®å¨ãéæºå¶çæ ¸å¿æ¯âå¯¹è±¡å¤´âââJavaå¯¹è±¡å¨åå­ä¸­çå¸å±åæ¬å¯¹è±¡å¤´ãå®ä¾æ°æ®ãå¯¹é½å¡«åï¼å¶ä¸­å¯¹è±¡å¤´å­å¨äºéçç¶æä¿¡æ¯ï¼Mark Wordï¼ãç±»åæ°æ®æéç­ã</li>
<li>ä¸ç§éç¶æçä¼åçº§ï¼æ é &lt; ååé &lt; è½»éçº§é &lt; ééçº§éï¼éççº¿ç¨ç«äºçå å§ï¼éä¼ä»ä½çº§å«åé«çº§å«åçº§ï¼ä¸åçº§è¿ç¨ä¸å¯éï¼ä¸æ¦åçº§ä¸ºééçº§éï¼æ æ³åéä¸ºè½»éçº§éæååéï¼ã
<ul>
<li>æ éï¼No Lockï¼ï¼åå§ç¶æã</li>
<li>ååéï¼Biased Lockï¼ï¼å½åªæä¸ä¸ªçº¿ç¨è®¿é®åæ­¥åæ¶ï¼ç´æ¥å¨å¯¹è±¡å¤´è®°å½çº¿ç¨IDï¼ä¸æ¬¡è¯¥çº¿ç¨è¿å¥æ¶æ éCASæä½ï¼æ§è½æé«ã</li>
<li>è½»éçº§éï¼Lightweight Lockï¼ï¼å½åºç°ç«äºï¼ä½ç«äºä¸æ¿çæ¶ï¼éè¿CASèªææ¥å°è¯è·åéï¼é¿åçº¿ç¨é»å¡ã</li>
<li>ééçº§éï¼Heavyweight Lockï¼ï¼å½èªæè¶è¿ä¸å®æ¬¡æ°æç«äºéå¸¸æ¿çæ¶ï¼åçº§ä¸ºééçº§éãæ­¤æ¶æªè·åå°éççº¿ç¨ä¼è¿å¥é»å¡ï¼Blockedï¼ç¶æï¼äº¤ç»æä½ç³»ç»ç®¡çã</li>
</ul>
</li>
</ul>
<h5 id="éä¼åè¡¥å">éä¼åè¡¥å</h5>
<ul>
<li><strong>éæ¶é¤</strong>ï¼JVMçå³æ¶ç¼è¯å¨ï¼JITï¼å¨è¿è¡æ¶ï¼ä¼å¯¹ä¸äºâä¸å¯è½å­å¨ç«äºçéâè¿è¡æ¶é¤ãä¾å¦ï¼å±é¨åéä½ä¸ºéå¯¹è±¡ï¼æ¯ä¸ªçº¿ç¨é½æç¬ç«çå±é¨åéï¼æ å±äº«ï¼ï¼JVMä¼ç´æ¥å é¤è¯¥synchronizedä¿®é¥°ï¼é¿åä¸å¿è¦çéå¼éã</li>
<li><strong>éç²å</strong>ï¼å½å¤ä¸ªè¿ç»­çsynchronizedä»£ç åä½¿ç¨åä¸ä¸ªéå¯¹è±¡æ¶ï¼JVMä¼å°è¿äºä»£ç ååå¹¶ä¸ºä¸ä¸ªå¤§çåæ­¥ä»£ç åï¼åå°éçè·å/éæ¾æ¬¡æ°ï¼æ¯æ¬¡è·å/éæ¾éé½æå¼éï¼ãä¾å¦ï¼å¾ªç¯åå¤æ¬¡è°ç¨åæ­¥æ¹æ³ï¼JVMå¯è½å°éç²åå°å¾ªç¯å¤é¨ã</li>
</ul>
<hr>
<h4 id="cas-compare-and-swapæ¯è¾å¹¶äº¤æ¢-æ¯å¹¶åç¼ç¨ä¸­å®ç°åå­æä½çæ ¸å¿ç®æ³æ¯ä¸ç§ä¹è§éçå®ç°ç­ç¥">CAS (Compare And Swapï¼æ¯è¾å¹¶äº¤æ¢) æ¯å¹¶åç¼ç¨ä¸­å®ç°åå­æä½çæ ¸å¿ç®æ³ï¼æ¯ä¸ç§ä¹è§éçå®ç°ç­ç¥ã</h4>
<ol>
<li>CASçå·¥ä½åçï¼åå«ä¸ä¸ªæ ¸å¿åæ°ï¼</li>
</ol>
<ul>
<li>åå­å°å V (Memory Location)ï¼åéå¨åå­ä¸­çå®éå¼ã</li>
<li>ææå¼ A (Expected Value)ï¼çº¿ç¨è®¤ä¸ºè¯¥åéå½ååºè¯¥æ¯ä»ä¹å¼ã</li>
<li>æ°å¼ B (New Value)ï¼çº¿ç¨æ³è¦æ´æ°æçå¼ã</li>
<li>æ§è¡é»è¾ï¼å½ä¸ä»å½åå­å°å V çå¼ç­äºææå¼ A æ¶ï¼å¤çå¨æä¼å° V çå¼æ´æ°ä¸º Bãå¦åï¼è¯´æè¯¥åéå·²è¢«å¶ä»çº¿ç¨ä¿®æ¹ï¼å½åçº¿ç¨ä»ä¹é½ä¸åï¼éå¸¸ä¼è¿å¥èªæï¼æ­»å¾ªç¯éè¯ï¼ã</li>
</ul>
<ol start="2">
<li>CASçä¼ç¼ºç¹<br>
<strong>ä¼ç¹ï¼</strong></li>
</ol>
<ul>
<li>éé»å¡æ§ï¼CAS æ¯ä¸ç§éé»å¡ç®æ³ï¼Non-blockingï¼ï¼å®ä¸éè¦å synchronized é£æ ·æèµ·åæ¢å¤çº¿ç¨ã</li>
<li>æ§è½é«ï¼å¨ä½ãä¸­åº¦ç«äºçæåµä¸ï¼ç±äºåå°äºçº¿ç¨ä¸ä¸æåæ¢çå¼éï¼æçè¿é«äºééçº§éã<br>
<strong>ç¼ºç¹ï¼</strong></li>
<li>å¾ªç¯æ¶é´é¿ï¼èªæå¼éï¼ï¼å¦æé«å¹¶åä¸ç«äºæ¿çï¼CAS ä¼é¢ç¹å¤±è´¥å¹¶ä¸æ­èªæï¼è¿ä¼ç» CPU å¸¦æ¥å·¨å¤§çè®¡ç®ååã</li>
<li>åªè½ä¿è¯ä¸ä¸ªå±äº«åéçåå­æä½ï¼å¯¹äºå¤ä¸ªåéçæä½ï¼ä»éä½¿ç¨ synchronized æ ReentrantLockã</li>
<li>ABA é®é¢ï¼æç»å¸çç¼ºç¹ï¼ã</li>
</ul>
<ol start="3">
<li>ä»ä¹æ¯ ABA é®é¢ï¼</li>
</ol>
<ul>
<li>å¦æåéåå§å¼ä¸ºAï¼å¨çº¿ç¨1åå¤ä¿®æ¹å®çè¿ç¨ä¸­ï¼çº¿ç¨2å¿«éå°å°å¶æ¹æäºBï¼ç¶ååæ¹åäºAã ç°è±¡ï¼çº¿ç¨1è§å¯å°å¼ä¾ç¶æ¯Aï¼è®¤ä¸ºå®æ²¡åè¿ï¼äºæ¯CASæåã é£é©ï¼è½ç¶æ°å¼æ²¡åï¼ä½åéçç¶æï¼æå¯¹è±¡åé¨çå±æ§ï¼å¯è½å·²ç»åçäºååï¼å¯¼è´é»è¾éè¯¯ã</li>
<li>Javaæä¾äºAtomicStampedReferenceç±»ï¼éè¿å¼å¥çæ¬å·ï¼Stampï¼æ¥è§£å³ï¼ æ¯æ¬¡åéæ´æ°æ¶ï¼ä¸ä»æ´æ°å¼ï¼è¿å¢å ä¸ä¸ªçæ¬å·ãåªæå¼åçæ¬å·é½ä¸è´ï¼CASæä¼æåã</li>
<li>è¿å¯ä»¥è®¾ç½®æ¶é´æ³æ¥è§£å³ã</li>
</ul>
<ol start="4">
<li>CAS å¨Javaä¸­çå®ç°</li>
</ol>
<ul>
<li>å¨Javaä¸­ï¼CASä¸»è¦ç± sun.misc.Unsafe ç±»æä¾æ¯æãè¯¥ç±»ä¸­çæ¹æ³ï¼å¦ compareAndSwapIntï¼æ¯ native çï¼ç´æ¥è°ç¨ç¡¬ä»¶åºå±çæä»¤ã</li>
</ul>
<hr>
<h4 id="reentrantlockå¯éå¥é">ReentrantLockï¼å¯éå¥éï¼</h4>
<ul>
<li>ReentrantLockæ¯ Java java.util.concurrent.locks åä¸çå¯éå¥éå®ç°ï¼åºäº AQSï¼æ½è±¡éååæ­¥å¨ï¼æå»ºï¼æ¯ synchronized ç âå¢å¼ºçâââ æ¢ä¿çäº synchronized çå¯éå¥ç¹æ§ï¼åæä¾äºæ´çµæ´»çåæ­¥æ§å¶è½åã</li>
</ul>
<h5 id="ä¸¤èå¯¹æ¯">ä¸¤èå¯¹æ¯:</h5>
<table>
<thead>
<tr>
<th>ç¹æ§</th>
<th>synchronized</th>
<th>ReentrantLock</th>
</tr>
</thead>
<tbody>
<tr>
<td>å®ç°å±é¢</td>
<td>JVM å±é¢ï¼å³é®å­ï¼ï¼ç± C++ å®ç°</td>
<td>JDK å±é¢ï¼APIï¼ï¼ç± Java ç¼åï¼åºäº AQSï¼</td>
</tr>
<tr>
<td>éçéæ¾</td>
<td>èªå¨éæ¾ï¼ä»£ç æ§è¡å®æå¼å¸¸åï¼</td>
<td>æå¨éæ¾ï¼å¿é¡»å¨ finally ä¸­è°ç¨ unlock()ï¼</td>
</tr>
<tr>
<td>çµæ´»æ§</td>
<td>ä½ï¼ä¸å¯ä¸­æ­ï¼æ è¶æ¶æºå¶ï¼</td>
<td>é«ï¼æ¯æå°è¯è·åãè¶æ¶è·åãå¯ä¸­æ­è·åï¼</td>
</tr>
<tr>
<td>å¬å¹³æ§</td>
<td>åªæ¯æéå¬å¹³é</td>
<td>æ¯æå¬å¹³éä¸éå¬å¹³éï¼é»è®¤éå¬å¹³ï¼</td>
</tr>
<tr>
<td>ç­å¾éå</td>
<td>åªè½å³è 1 ä¸ª ç­å¾éåï¼wait/notifyï¼</td>
<td>å¯ä»¥ç»å® å¤ä¸ª Conditionï¼ç²¾ç»åå¤éï¼</td>
</tr>
</tbody>
</table>
<h5 id="reentrantlockçç¹æé«çº§åè½">ReentrantLockçç¹æé«çº§åè½</h5>
<ol>
<li>ååºä¸­æ­ (lockInterruptibly)</li>
</ol>
<ul>
<li>synchronizedä¸æ¦è¿å¥é»å¡ç­å¾ï¼é¤éæ¿å°éï¼å¦åæ æ³è¢«ä¸­æ­ãèReentrantLockåè®¸çº¿ç¨å¨ç­å¾éçè¿ç¨ä¸­ååºThread.interrupt()ï¼ä»èé¿åæ­»ç­ã</li>
</ul>
<ol start="2">
<li>è¶æ¶æºå¶ (tryLock)</li>
</ol>
<ul>
<li>çº¿ç¨å¯ä»¥å°è¯è·åéï¼å¦æéè¢«å ç¨ï¼ç«å³è¿å false æèç­å¾ä¸æ®µæ¶é´åè¿åï¼èä¸æ¯ä¸ç´é»å¡ãè¿å¨é¢é²æ­»éæ¶éå¸¸æç¨ã</li>
</ul>
<ol start="3">
<li>å¬å¹³é (Fairness)</li>
</ol>
<ul>
<li>å¬å¹³éï¼æç§çº¿ç¨è¯·æ±éçé¡ºåºåéï¼åå°åå¾ã</li>
<li>éå¬å¹³éï¼é»è®¤ï¼ï¼åè®¸âæéâãå¦ææ°æ¥ççº¿ç¨æ­£å¥½ç¢°å°ééæ¾ï¼å®å¯ä»¥ç´æ¥æ¢å ï¼æ§è½éå¸¸æ¯å¬å¹³éé«ã</li>
</ul>
<ol start="4">
<li>å¤ä¸ª Condition å¯¹è±¡</li>
</ol>
<ul>
<li>éè¿lock.newCondition()ï¼ä½ å¯ä»¥åå»ºå¤ä¸ªç­å¾éãä¾å¦å¨é»å¡éåä¸­ï¼å¯ä»¥å®ä¹ notFull å notEmpty ä¸¤ä¸ªæ¡ä»¶ï¼å®ç°æ¯ notifyAll æ´ç²¾åççº¿ç¨å¤éã</li>
</ul>
<h5 id="åºæ¬ä½¿ç¨ç¤ºä¾">åºæ¬ä½¿ç¨ç¤ºä¾ï¼</h5>
<pre><code class="language-java">import java.util.concurrent.locks.ReentrantLock;

public class ReentrantLockDemo {
    // åå»ºéå¬å¹³éï¼é»è®¤ï¼ï¼è¥éå¬å¹³éï¼new ReentrantLock(true)
    private static final ReentrantLock lock = new ReentrantLock();

    public static void doTask() {
        // 1. æ®éè·åéï¼ä¸å¯ä¸­æ­ï¼
        lock.lock();
        try {
            // ä¸´çåºä»£ç ï¼çº¿ç¨å®å¨ï¼
            System.out.println(Thread.currentThread().getName() + " æ§è¡ä»»å¡");
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        } finally {
            // å¿é¡»å¨finallyä¸­éæ¾éï¼å¦åéæ°¸è¿æ æ³éæ¾
            lock.unlock();
        }
    }

    // è¶æ¶è·åéç¤ºä¾
    public static void tryLockWithTimeout() {
        try {
            // å°è¯å¨2ç§åè·åéï¼è·åæåè¿åtrueï¼å¤±è´¥è¿åfalse
            if (lock.tryLock(2, java.util.concurrent.TimeUnit.SECONDS)) {
                try {
                    System.out.println(Thread.currentThread().getName() + " è¶æ¶è·åéæå");
                } finally {
                    lock.unlock();
                }
            } else {
                System.out.println(Thread.currentThread().getName() + " è¶æ¶è·åéå¤±è´¥");
            }
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }

    public static void main(String[] args) {
        // æµè¯æ®éè·åé
        new Thread(ReentrantLockDemo::doTask, "çº¿ç¨1").start();
        new Thread(ReentrantLockDemo::doTask, "çº¿ç¨2").start();
        
        // æµè¯è¶æ¶è·åé
        new Thread(ReentrantLockDemo::tryLockWithTimeout, "çº¿ç¨3").start();
    }
}
</code></pre>

</div>
<div class="clear"></div>

		</div>
		<div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 22:24">2026-01-13 22:24</span>&nbsp;
<a href="https://www.cnblogs.com/xi-yongqi">æä¼æ¿é£å»</a>&nbsp;
éè¯»(<span id="post_view_count">4</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479394);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479394', targetLink: 'https://www.cnblogs.com/xi-yongqi/p/19479394', title: 'synchronizedå³é®å­ç¸å³' })">ä¸¾æ¥</a>
</div>
	 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä»Shapefileå°GeoJSONï¼ç¨GDALå®ç°GISç¢éæ°æ®è¯»åä¸ç©ºé´åæ ]]></title>
    <link>https://www.cnblogs.com/charlee44/p/19479143</link>
    <guid>6bcd8da550301ab8407175bad2c0797b</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/charlee44/p/19479143" title="åå¸äº 2026-01-13 20:25">
    <span role="heading" aria-level="2">ä»Shapefileå°GeoJSONï¼ç¨GDALå®ç°GISç¢éæ°æ®è¯»åä¸ç©ºé´åæ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260113202625252-636759511.png" alt="ä»Shapefileå°GeoJSONï¼ç¨GDALå®ç°GISç¢éæ°æ®è¯»åä¸ç©ºé´åæ" class="desc_img">
        éè¿ GDAL/OGR å®ç°äº GIS ç¢éæ°æ®çå®æ´å¤çæµç¨ââä» Shapefile è¯»åãWGS84 å° Web å¢¨å¡æåæ è½¬æ¢ï¼å° GeoJSON åå¥ï¼å¹¶æ¼ç¤ºäºç¹ä¸å¤è¾¹å½¢ææå³ç³»ï¼å¦ Containsï¼çå¤æ­æ¹æ³ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>æ¬æèéèªä½èæ°ä¹¦<a href="https://item.jd.com/14603137.html" target="_blank" rel="noopener nofollow">ãGISåºç¡åçä¸ææ¯å®è·µã</a>ç¬¬4ç« ï¼ç³»ç»è®²è§£ç¢éæ°æ®å¼ååºç¡ï¼æ¶µç OGR/GDAL ä½¿ç¨ãåæ è½¬æ¢ãææå¤æ­ç­å®æåå®¹ã</p>
</blockquote>
<p><img alt="GISåºç¡åçä¸ææ¯å®è·µ" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260109210341528-489326821.png" class="lazyload"></p>
<h2 id="44-ç¢éæ°æ®å¼ååºç¡">4.4 ç¢éæ°æ®å¼ååºç¡</h2>
<p>éè¿ä¹åçä»ç»ï¼ç¸ä¿¡è¯»èå·²ç»å¯¹äºGISçç¢éæ°æ®æäºä¸ä¸ªå¨é¢çè®¤è¯ï¼å°½ç®¡å¯è½ä¸æ¯é£ä¹æ·±å¥ãä½æ¯æ²¡æå³ç³»ï¼æä»¬å¯ä»¥å¨å®éçå¼åè¿ç¨ä¸­å æ·±å¯¹å¶çè®¤è¯ã</p>
<h3 id="441-ç¬¬ä¸æ¹å¼æºåºogrgdal">4.4.1 ç¬¬ä¸æ¹å¼æºåºOGR/GDAL</h3>
<p>å¨ç¬¬3ç« çæ¶åï¼æä»¬å°è¯çåï¼éè¿ç¬¬ä¸æ¹å¼æºåºPROJ/GDALå¾ç®åçå°±å®ç°äºå°çç©ºé´åèç³»ç»çç¸äºè½¬æ¢ãå¨è¿éåæ ·å¦æ­¤ï¼æä»¬å¯ä»¥éè¿GDALçOGRç»ä»¶ï¼è½»æ¾å®ç°GISç¢éæ°æ®çåºç¡å¼åã</p>
<p>OGRæ¾ç»æ¯ä¸ä¸ªç¬ç«çç¢éIOåºï¼è¡¨ç¤ºOpenGIS Simple Features Reference Implementationçææï¼ä½å¶å®OGRä¸å®å¨ç¬¦åOGCçSimple Featureæ åè§èï¼å æ­¤æªè¢«æ¹åä½ä¸ºè¯¥è§èçåèå®ç°ï¼å½ç¶ä¹éå¸¸æ¥è¿è§èäºï¼ãä»GDAL2.0å¼å§ï¼GDALåOGRç»ä»¶è¢«éæå¨ä¸èµ·ã</p>
<p>OGR/GDALæä¾äºéå¸¸å¼ºå¤§çç¢éè¯»åè½åï¼æ¯æå¸é¢ä¸ç»å¤§å¤æ°ç¢éæ°æ®æ ¼å¼ãå¨ç¬¬3ç« æä»¬ä»ç»GDALçæ¶åå°±æå°è¿ï¼GDALæ¯ä¸ä¸ªGISæ°æ®æ½è±¡åºãæè°æ°æ®æ½è±¡ï¼æ¯ææ è®ºæ¯åªä¸ç§å·ä½çç¢éæ°æ®æ ¼å¼ï¼GDALé½ä¼å°å¶æ½è±¡ææ°æ®éå¯¹è±¡ï¼Datasetï¼ï¼ä»èå¯ä»¥æ¯æè¯»åãååºåå¤çæä½ãå¸¸ç¨çç¢éæ°æ®æ ¼å¼å¦ä¸ï¼</p>
<ul>
<li>DXF/DWGï¼åºç¨æå¹¿æ³çå ä½å¾å½¢æ°æ®æ ¼å¼ï¼å¨CADé¢ååç¨çéå¸¸å¤ï¼ä½æ¯ç¼ºç¹æ¯ç¼ºå°å°çä¿¡æ¯ã</li>
<li>ESRI Shapefileï¼GISä¸­æå¸¸è§çç¢éæ°æ®æ ¼å¼ï¼å ä¹ææçåä¸åå¼æºGISè½¯ä»¶é½æ¯æãé¤äºå ä½ä¿¡æ¯ä¹å¤ï¼è¿åå«ç©ºé´ä¿¡æ¯åå±æ§ä¿¡æ¯ã</li>
<li>GeoJSONï¼ä¸ç§éè¿JSONæ¥è¡¨è¿°è¦ç´ çç¢éæ°æ®æ ¼å¼ï¼å èå¾å®¹æè¢«JavaScriptè§£æåå¤çï¼éç¨äºWebç«¯çè½»éååºç¨ã</li>
<li>KMLï¼Googleæåºçä¸ç§åºäºXMLæ åæ¥æè¿°å°çç©ºé´ä¿¡æ¯çæ°æ®æ ¼å¼ï¼åæ¬ç¹ãçº¿ãé¢ãå¤è¾¹å½¢åæ¨¡åç­ï¼ï¼å¹¶ä¸å·²ç»è¢«OGCè®¤å®ä¸ºå¼æ¾å°çä¿¡æ¯ç¼ç æ åã</li>
</ul>
<p>å¨GDALä¸­ï¼å¯¹æ°æ®æ ¼å¼çæ¯æè¢«å°è£æé©±å¨ï¼dirverï¼ï¼åæ¬ä¸è¿°æ ¼å¼å¨åçæ°æ®é©±å¨è¦ä¹ååµå¨GDALä¸­ï¼è¦ä¹éè¿å¦å¤çç¬¬ä¸æ¹åºæ¥æ¯æãå½ç¶è¿äºæä»¬å¯ä»¥ææ¶ä¸ç¨å³å¿ï¼ç´æ¥ä½¿ç¨æ¬ä¹¦Githubä¸»é¡µä»£ç ä»åºä¸­çGDALå³å¯ã</p>
<h3 id="442-ç¢éæ°æ®çè¯»åå¤çååå¥">4.4.2 ç¢éæ°æ®çè¯»åãå¤çååå¥</h3>
<p>äºè§£äºç¬¬ä¸æ¹åºOGR/GDALï¼æ¥ä¸æ¥æä»¬å°±éè¿å¶å®ç°å³äºGISç¢éæ°æ®çåºç¡å¼åãä¸ä¸ªå¾å®¹æçè§£çå¸¸è¯æ¯ï¼åå«GISç¢éæ°æ®å¨åçä»»ä½æ°æ®çæä½é½ç¦»ä¸å¼ä¸ä¸ªè¿ç¨ï¼è¯»åãå¤çååå¥ãå æ­¤ï¼è¿éæä»¬ç»ååé¢ç©ºé´åæ åèè½¬æ¢çå®è·µï¼å®ç°ä¸ä¸ªç®åçå®ä¾ï¼è¯»åä¸ä¸ªé¢çç¢éï¼ç¶åå¯¹å¶è¿è¡ç©ºé´åèçè½¬æ¢ï¼æåéæ°ååºä¸ä¸ªç¢éãå·ä½çå®ç°ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-cpp">#include &lt;ogrsf_frmts.h&gt;

#include &lt;Eigen/Eigen&gt;
#include &lt;iostream&gt;
#include &lt;vector&gt;

using namespace std;
using namespace Eigen;

using Point = Vector3d;
using Line = vector&lt;Point&gt;;
using Polygon = vector&lt;Line&gt;;

vector&lt;Polygon&gt; polygonData;

OGRSpatialReference srcFileSpatialReference;
OGRSpatialReference dstFileSpatialReference;

void OgrRing2Line(OGRLinearRing *ogrLinearRing, Line &amp;line) {
  for (int i = 0; i &lt; ogrLinearRing-&gt;getNumPoints(); i++) {
    line.emplace_back(ogrLinearRing-&gt;getX(i), ogrLinearRing-&gt;getY(i),
                      ogrLinearRing-&gt;getZ(i));
  }
}

void OgrPolygon2Polygon(OGRPolygon *ogrPolygon, Polygon &amp;polygon) {
  //å¤ç¯
  Line line;
  OgrRing2Line(ogrPolygon-&gt;getExteriorRing(), line);
  polygon.push_back(line);

  //åç¯
  for (int ri = 0; ri &lt; ogrPolygon-&gt;getNumInteriorRings(); ri++) {
    Line line;
    OgrRing2Line(ogrPolygon-&gt;getInteriorRing(ri), line);
    polygon.push_back(line);
  }
}

bool ReadShp() {
  string srcFile = getenv("GISBasic");
  srcFile = srcFile + "/../Data/Vector/multipolygons.shp";

  GDALDataset *poDS = (GDALDataset *)GDALOpenEx(srcFile.c_str(), GDAL_OF_VECTOR,
                                                NULL, NULL, NULL);
  if (!poDS) {
    printf("æ æ³è¯»åè¯¥æä»¶ï¼è¯·æ£æ¥æ°æ®æ¯å¦å­å¨é®é¢ï¼");
    return false;
  }

  if (poDS-&gt;GetLayerCount() &lt; 1) {
    printf("è¯¥æä»¶çå±æ°å°äº1ï¼è¯·æ£æ¥æ°æ®æ¯å¦å­å¨é®é¢ï¼");
    return false;
  }

  //åå§æ°æ®ç©ºé´åè
  char *pszWKT = nullptr;
  poDS-&gt;GetLayer(0)-&gt;GetSpatialRef()-&gt;exportToWkt(&amp;pszWKT);
  srcFileSpatialReference.importFromWkt(pszWKT);
  CPLFree(pszWKT);
  pszWKT = nullptr;

  for (int li = 0; li &lt; poDS-&gt;GetLayerCount(); li++) {
    OGRLayer *poLayer = poDS-&gt;GetLayer(li);  //è¯»åå±
    poLayer-&gt;ResetReading();

    //è¾åºå­æ®µå
    OGRFeatureDefn *poFDefn = poLayer-&gt;GetLayerDefn();
    int n = poFDefn-&gt;GetFieldCount();
    for (int iField = 0; iField &lt; n; iField++) {
      OGRFieldDefn *OGRFieldDefn = poFDefn-&gt;GetFieldDefn(iField);
      cout &lt;&lt; OGRFieldDefn-&gt;GetNameRef() &lt;&lt; endl;
    }

    //éåç¹å¾
    OGRFeature *poFeature = nullptr;
    while ((poFeature = poLayer-&gt;GetNextFeature()) != nullptr) {
      OGRGeometry *geometry = poFeature-&gt;GetGeometryRef();
      OGRwkbGeometryType geometryType = geometry-&gt;getGeometryType();

      switch (geometryType) {
        case wkbPolygon:
        case wkbPolygonM:
        case wkbPolygonZM: {
          OGRPolygon *ogrPolygon = dynamic_cast&lt;OGRPolygon *&gt;(geometry);
          if (!ogrPolygon) {
            continue;
          }

          Polygon polygon;
          OgrPolygon2Polygon(ogrPolygon, polygon);
          polygonData.push_back(polygon);

          break;
        }
        case wkbMultiPolygon:
        case wkbMultiPolygonM:
        case wkbMultiPolygonZM: {
          OGRMultiPolygon *ogrMultiPolygon =
              dynamic_cast&lt;OGRMultiPolygon *&gt;(geometry);
          if (!ogrMultiPolygon) {
            continue;
          }

          for (int gi = 0; gi &lt; ogrMultiPolygon-&gt;getNumGeometries(); gi++) {
            OGRPolygon *ogrPolygon =
                dynamic_cast&lt;OGRPolygon *&gt;(ogrMultiPolygon-&gt;getGeometryRef(gi));
            if (!ogrPolygon) {
              continue;
            }

            Polygon polygon;
            OgrPolygon2Polygon(ogrPolygon, polygon);
            polygonData.push_back(polygon);
          }

          break;
        }
        default: {
          printf("æªå¤ççç¹å¾ç±»å\n");
          break;
        }
      }

      //è¾åºæ¯ä¸ªå­æ®µçå¼
      for (int iField = 0; iField &lt; n; iField++) {
        cout &lt;&lt; poFeature-&gt;GetFieldAsString(iField) &lt;&lt; "    ";
      }
      cout &lt;&lt; endl;

      OGRFeature::DestroyFeature(poFeature);
    }
  }

  GDALClose(poDS);
  poDS = nullptr;

  return true;
}

void Convert() {
  dstFileSpatialReference.importFromEPSG(3857);
  dstFileSpatialReference.SetAxisMappingStrategy(OAMS_TRADITIONAL_GIS_ORDER);
  srcFileSpatialReference.SetAxisMappingStrategy(OAMS_TRADITIONAL_GIS_ORDER);

  OGRCoordinateTransformation *src2DstTransformation =
      OGRCreateCoordinateTransformation(&amp;srcFileSpatialReference,
                                        &amp;dstFileSpatialReference);

  if (!src2DstTransformation) {
    return;
  }

  for (auto &amp;polygon : polygonData) {
    for (auto &amp;line : polygon) {
      for (auto &amp;point : line) {
        src2DstTransformation-&gt;Transform(1, point.data(), point.data() + 1,
                                         point.data() + 2);
      }
    }
  }
}

bool CreateField(OGRLayer *poLayer) {
  // å­ç¬¦ä¸²
  OGRFieldDefn oField1("Type", OFTString);
  oField1.SetWidth(8);
  if (poLayer-&gt;CreateField(&amp;oField1) != OGRERR_NONE) {
    printf("Creating Name field failed.\n");
    return false;
  }

  // æµ®ç¹æ°
  OGRFieldDefn oField2("Area", OFTReal);
  oField2.SetPrecision(3);
  if (poLayer-&gt;CreateField(&amp;oField2) != OGRERR_NONE) {
    printf("Creating Name field failed.\n");
    return false;
  }

  // æ´å
  OGRFieldDefn oField3("VertexCount", OFTInteger);
  if (poLayer-&gt;CreateField(&amp;oField3) != OGRERR_NONE) {
    printf("Creating Name field failed.\n");
    return false;
  }

  return true;
}

bool WriteGeoJson() {
  string dstFile = getenv("GISBasic");
  dstFile = dstFile + "/../Data/Out.geoJson";

  //åå»º
  GDALDriver *driver = GetGDALDriverManager()-&gt;GetDriverByName("GeoJSON");
  if (!driver) {
    printf("Get Driver GeoJSON Errorï¼\n");
    return false;
  }

  GDALDataset *dataset =
      driver-&gt;Create(dstFile.c_str(), 0, 0, 0, GDT_Unknown, NULL);
  OGRLayer *poLayer = dataset-&gt;CreateLayer(
      "FirstLayer", &amp;dstFileSpatialReference, wkbPolygon, NULL);

  if (!CreateField(poLayer)) {
    return false;
  }

  //åå»ºç¹å¾
  for (const auto &amp;polygon : polygonData) {
    OGRFeature ogrFeature(poLayer-&gt;GetLayerDefn());

    OGRPolygon ogrPolygon;

    int vertexNum = 0;
    for (const auto &amp;line : polygon) {
      OGRLinearRing ogrRing;
      for (const auto &amp;point : line) {
        ogrRing.addPoint(point.x(), point.y(), point.z());
        vertexNum++;
      }
      ogrPolygon.addRing(&amp;ogrRing);
    }
    ogrFeature.SetGeometry(&amp;ogrPolygon);

    ogrFeature.SetField("Type", "Polygon");
    ogrFeature.SetField("Area", ogrPolygon.get_Area());
    ogrFeature.SetField("VertexCount", vertexNum);

    if (poLayer-&gt;CreateFeature(&amp;ogrFeature) != OGRERR_NONE) {
      printf("Failed to create feature.\n");
      return false;
    }
  }

  //éæ¾
  GDALClose(dataset);
  dataset = nullptr;

  return true;
}

int main() {
  GDALAllRegister();
  CPLSetConfigOption("GDAL_FILENAME_IS_UTF8", "NO");  //æ¯æä¸­æè·¯å¾
  CPLSetConfigOption("SHAPE_ENCODING", "");           //è§£å³ä¸­æä¹±ç é®é¢

  if (!ReadShp()) {
    return 1;
  }

  Convert();

  WriteGeoJson();
}
</code></pre>
<p>å¨è¿éï¼è¯»åçç¢éæ¯ä¸ä¸ªShapefileæä»¶ï¼åå«çé½æ¯å¤è¾¹å½¢çè¦ç´ ï¼ç©ºé´åèä¸ºWGS84å°çåæ ç³»ï¼EPSGï¼4326ï¼ï¼æ¾ç¤ºå¦ä¸å¾4.14æç¤ºï¼</p>
<p><img alt="å¾4.14 å¤çåå¤è¾¹å½¢ç¢éè¦ç´ " loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260113202314711-1548077459.jpg" class="lazyload"></p>
<p>ç»è¿ç©ºé´åèè½¬æ¢åï¼ç©ºé´åèä¸ºWebå¢¨å¡ææå½±åæ ç³»ï¼EPSGï¼3857ï¼ï¼ä¸çæçæ¯ä¸ä¸ªGeoJsonæä»¶ãå¦ä¸å¾4.15æç¤ºï¼å¯ä»¥çå°å¨ç©ºé´åæ åèè½¬æ¢ä¹åå½¢ç¶ä¼¼ä¹âåçªâäºä¸ç¹ï¼è¿æ¯å°å¾æå½±åæ¢çç¹æ§å³å®çï¼åèç¬¬2ç« ä»ç»çç¥è¯ï¼ã</p>
<p><img alt="å¾4.15 å¤çåå¤è¾¹å½¢ç¢éè¦ç´ " loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260113202328946-325091388.jpg" class="lazyload"></p>
<p>è¿æ®µä»£ç çå³é®å¨äºå¦ä¸å ç¹ï¼</p>
<ul>
<li>
<p>è¯»åç¢éæ¶ï¼ç¢éæ°æ®è¢«è¯»åææ°æ®éå¯¹è±¡GDALDatasetï¼GDALDatasetç®¡çå¾å±å¯¹è±¡OGRLayerï¼OGRLayerç®¡çç¹å¾ç±»å¯¹è±¡OGRFeatureï¼OGRFeatureååå«å ä½å¯¹è±¡ç±»OGRGeometryãOGRGeometryæ¯ä¸ä¸ªæ½è±¡ç¶ç±»ï¼ææä¹çæ¯å¶è¡¨è¾¾å·ä½çå ä½å¯¹è±¡çå­ç±»ï¼æ¯å¦OGRPolygonä»£è¡¨å¤è¾¹å½¢å ä½å¯¹è±¡ãOGRPolygonåæ¯ç±1ä¸ªå¤ç¯åå¤ä¸ªåç¯ï¼ç¯çº¿ï¼OGRLinearRingï¼ç»æãç¢éå°±æ¯è¿æ ·ä¸å±å±æ½è±¡ç»åè¡¨è¾¾åºæ¥çã</p>
</li>
<li>
<p>å¨è¿è¡æ°æ®å¤çä¹å°±æ¯ç©ºé´åèè½¬æ¢ä¹åï¼æä»¬æè¯»åçæ°æ®æ¾å°æä»¬èªå·±çæ°æ®å®¹å¨ä¸­ï¼</p>
<pre><code class="language-cpp">using Point = Vector3d;
using Line = vector&lt;Point&gt;;
using Polygon = vector&lt;Line&gt;;

vector&lt;Polygon&gt; polygonData;
</code></pre>
<p>çå®çGISæ°æ®å¤çå¼åè¦æ±æ¯ååä¸åçï¼æä½çå¾å¾ä¸æ¯è¯»åç»ä»¶ï¼è¿éæOGRï¼å®ä¹çæ°æ®ç»æå¯¹è±¡ãæä»¬å¯ä»¥å°å¶è¯»åå¨æèªå®ä¹çæ°æ®ç»æä¸­ï¼ä»¥æ¹ä¾¿æä»¬è¿è¡æ´å éç¨çæä½ï¼æèè¿è¡å¹¶è¡ä¼åãå¨è¿éæä»¬éåäºèªå®ä¹çæ°æ®ç»æå¯¹è±¡ä¸­çé¡¶ç¹ï¼éç¹è¿è¡ç©ºé´åæ åèçè½¬æ¢ãè¿è¡å¶ä»çæ°æ®å¤çä¹æ¯å¦æ­¤ï¼æ ¹æ®èªå·±çéè¦æä½èªå·±çæ°æ®ç»æå®¹å¨ã</p>
</li>
<li>
<p>ååºç¢éæ¶ï¼å°å¤çç»æçèªå®ä¹æ°æ®ç»æå¯¹è±¡æ¢å¤ææ°æ®éå¯¹è±¡GDALDatasetï¼è¯»åç¢éçéæä½ï¼ãå¦å¤ï¼éè¦å³æ³¨çæ¯GDALçæ°æ®é©±å¨GDALDriverï¼å¶æ¯éè¿åç§°æ¥åå»ºå¯¹åºæ ¼å¼çç¢éæä»¶ï¼ä¾å¦è¿éä¼ å¥å°åç§°æ¯GeoJson:</p>
<pre><code class="language-cpp">GDALDriver *driver = GetGDALDriverManager()-&gt;GetDriverByName("GeoJSON");
if (!driver) {
  printf("Get Driver GeoJSON Errorï¼\n");
  return false;
}
</code></pre>
</li>
<li>
<p>ç¢éæ°æ®çå±æ§è¡¨æ°æ®ä¸æ°æ®åºä¸­çè¡¨ç»ææ¯è¾ç±»ä¼¼ï¼æ¯ä¸ªå­æ®µå·æèªå·±çå®ä¹å±æ§ï¼ä¾å¦æ°æ®ç±»åãé¿åº¦ãç²¾åº¦ç­ãå¹¶ä¸ï¼æ¯ä¸ä¸ªç¹å¾é½å¯¹åºäºä¸è¡è®°å½ãå èå±æ§è¡¨çæä½è¿æ¯æºå¤æçï¼å¾å¾ä¸ä¸å¡æä½ç¸å³èãè¿éä»ä»åªæ¯è¾åºæ¾ç¤ºäºè¯»åçå±æ§è¡¨ä¿¡æ¯ï¼åå¥äºèªå·±åå»ºçå­æ®µä¸å¼ãè¯»åååå¥çå±æ§è¡¨æ°æ®å¦ä¸å¾4.16ãå¾4.17æç¤ºï¼</p>
</li>
</ul>
<p><img alt="å¾4.16 è¯»åçå±æ§è¡¨ä¿¡æ¯" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260113202342130-737019255.jpg" class="lazyload"><br>
<img alt="å¾4.17 åå¥çå±æ§è¡¨ä¿¡æ¯" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260113202352772-344125405.jpg" class="lazyload"></p>
<h3 id="443-ç©ºé´ææå³ç³»çå¤æ­">4.4.3 ç©ºé´ææå³ç³»çå¤æ­</h3>
<p>å¯¹ç¢éè¦ç´ è¿è¡ç©ºé´ææå³ç³»çå¤æ­ä¹æ¯GISå¼åä¸­å¸¸ç¨çåè½ãå¨4.3.3èä¸­ä»ç»äºOGCçSimple Featureæ åè§èä¸­ææå³ç³»ï¼OGR/GDALå¯¹å¶åäºå·ä½çå®ç°ãä»»ä½ç»§æ¿äºOGRGeometryçå ä½å¯¹è±¡ç±»ï¼å¦OGRPointãOGRPolygonï¼é½å¯ä»¥è°ç¨æ åä¸­å®ä¹çæ¥å£ï¼äºåè°è¯ï¼ï¼å¤æ­è¯¥å ä½å¯¹è±¡ä¸å¦å¤ä¸ä¸ªå ä½å¯¹è±¡çææå³ç³»ãå¨å¦ä¸å®ä¾ä¸­ï¼å¤æ­äºç©ºé´ä¸­æç¹ä¸æå¤è¾¹å½¢æ¯å¦å­å¨åå«ï¼Containsï¼å³ç³»ï¼</p>
<pre><code class="language-cpp">#include &lt;ogrsf_frmts.h&gt;

#include &lt;iostream&gt;

using namespace std;

int main() {
  OGRLinearRing linearRing;
  linearRing.addPoint(268.28, 784.75);
  linearRing.addPoint(153.98, 600.60);
  linearRing.addPoint(274.63, 336.02);
  linearRing.addPoint(623.88, 401.64);
  linearRing.addPoint(676.80, 634.47);
  linearRing.addPoint(530.75, 822.85);
  linearRing.closeRings();

  OGRPolygon polygon;
  polygon.addRing(&amp;linearRing);

  cout &lt;&lt; "ç¹Aæ¯å¦å¨å¤è¾¹å½¢åï¼";
  OGRPoint pointA(407.98, 579.43);  
  cout &lt;&lt; polygon.Contains(&amp;pointA) &lt;&lt; endl;

  cout &lt;&lt; "ç¹Bæ¯å¦å¨å¤è¾¹å½¢åï¼";
  OGRPoint pointB(678.92, 482.07);  
  cout &lt;&lt; polygon.Contains(&amp;pointB) &lt;&lt; endl;
}
</code></pre>
<p>è¿è¡çç»æå¦ä¸æç¤ºï¼</p>
<pre><code class="language-text">ç¹Aæ¯å¦å¨å¤è¾¹å½¢åï¼1
ç¹Bæ¯å¦å¨å¤è¾¹å½¢åï¼0
</code></pre>
<p>å¨4.3.3èä¸­ä»ç»è¿ï¼åå«(Contains)ä¸åå«(Within)æ¯ä¸å¯¹ç¸åçå³ç³»ãå¨è¿éæä»¬å½ç¶ä¹å¯ä»¥è°ç¨OGRPointçåå«(Within)æ¥å£ï¼ä¼è¿åä¸ä¸è¿°åæ ·çç»æãä¸æ­¢å¦æ­¤ï¼å¶ä»ç©ºé´ææå³ç³»çæ¥å£ä¹æ¯è¿æ ·è°ç¨ï¼è¯»èå¯ä»¥æ ¹æ®èªå·±çéæ±å°è¯ä¸äºï¼è¿éåªæ¯æç å¼çã</p>
<hr>
<p>æ¬æèéèªä½èæ°ä¹¦ãGISåºç¡åçä¸ææ¯å®è·µãç¬¬4ç« ãä¹¦ä¸­ç³»ç»è®²è§£ GIS æ ¸å¿çè®ºä¸å¤è¯­è¨å®æï¼éåå¼åèä¸é«æ ¡å¸çã</p>
<p>ð <strong>éå¥èµæºå¼æº</strong>ï¼<a href="https://github.com/fafa1899/GISBasic" target="_blank" rel="noopener nofollow">GitHub</a> | <a href="https://gitcode.com/charlee44/GISBasic" target="_blank" rel="noopener nofollow">GitCode</a></p>
<p>ð <strong>æ¯ææ­£ç</strong>ï¼<a href="https://item.jd.com/14603137.html" target="_blank" rel="noopener nofollow">äº¬ä¸</a>ï½<a href="https://product.dangdang.com/29988568.html" target="_blank" rel="noopener nofollow">å½å½</a></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.001388888888888889" data-date-updated="2026-01-13 20:27">2026-01-13 20:25</span>&nbsp;
<a href="https://www.cnblogs.com/charlee44">charlee44</a>&nbsp;
éè¯»(<span id="post_view_count">13</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479143);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479143', targetLink: 'https://www.cnblogs.com/charlee44/p/19479143', title: 'ä»Shapefileå°GeoJSONï¼ç¨GDALå®ç°GISç¢éæ°æ®è¯»åä¸ç©ºé´åæ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ çµä½å¨å®ç°çµæºç»å¯¹ä½ç½®æµé-PART-çµä½è®¡-ç»å¯¹ä½ç½® ]]></title>
    <link>https://www.cnblogs.com/SimLab/p/19479117</link>
    <guid>091277d09a043129886cb629c71f75c0</guid>
    <description>
    <![CDATA[ 
        <h2>
            <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/SimLab/p/19479117" title="åå¸äº 2026-01-13 20:11">
    <span role="heading" aria-level="2">çµä½å¨å®ç°çµæºç»å¯¹ä½ç½®æµé-PART-çµä½è®¡-ç»å¯¹ä½ç½®</span>
    

</a>

        </h2>
        <div class="postbody">
            <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="çµä½å¨å®ç°çµæºç»å¯¹ä½ç½®æµé-part-çµä½è®¡-ç»å¯¹ä½ç½®">çµä½å¨å®ç°çµæºç»å¯¹ä½ç½®æµé-PART-çµä½è®¡-ç»å¯¹ä½ç½®</h1>
<blockquote>
<p><strong>å³é®å­</strong>ï¼ç»å¯¹ä½ç½®, çµä½å¨, Vishay Spectrol, 132</p>
</blockquote>
<hr>
<h2 id="ä¸é®é¢åæ">ä¸ãé®é¢åæ</h2>
<p>å¨è¿å¨æ§å¶å®éªä¸­ï¼æä»¬éè¦æµéæè½¬çµæºå¨æéè§åº¦èå´ï¼å¦ 0â90Â°ï¼åæ¥åæå¨ç<strong>ç»å¯¹ä½ç½®</strong>ã</p>
<p>å¸¸è§æ¹æ³ï¼</p>
<ul>
<li>ç»å¯¹ç¼ç å¨æå¢éç¼ç å¨è¾åºæ°å­ä¿¡å·ï¼ç²¾åº¦é«ã</li>
</ul>
<p>ç°åºé®é¢ï¼</p>
<ul>
<li><strong>å®éªç¡¬ä»¶æ¬èº«ä¸æ¯æç»å¯¹ç¼ç å¨éé</strong>ï¼æ æ³ç´æ¥ä½¿ç¨</li>
<li>æå¨è§åº¦æéï¼ä¸éè¦å¨å 360Â°ï¼</li>
<li>ç³»ç»éè¦ç¨³å®ãå¯å®æ¶è·åç»å¯¹ä½ç½®çæ¹æ¡</li>
</ul>
<blockquote>
<p>æ ¸å¿é®é¢ï¼å¦ä½å¨ç¡¬ä»¶ä¸æ¯æç»å¯¹ç¼ç å¨ééçæåµä¸ï¼å®ç°å¯é çç»å¯¹ä½ç½®æµéï¼</p>
</blockquote>
<hr>
<h2 id="äºè§£å³æ¹æ³--å®æ½æ¹æ¡">äºãè§£å³æ¹æ³ / å®æ½æ¹æ¡</h2>
<h3 id="1ï¸â£-ç¡¬ä»¶æ¹æ¡">1ï¸â£ ç¡¬ä»¶æ¹æ¡</h3>
<ul>
<li><strong>çµä½å¨éå</strong>ï¼Vishay Spectrol Model 132ï¼æè½¬è§ 352Â°ï¼</li>
<li><strong>é½¿è½®ä¼ å¨</strong>ï¼çµæºè½´ â é½¿è½® â çµä½å¨æ»å¨è½´
<ul>
<li>çµæºæè½¬è§ â é½¿è½®æ¯ â çµä½å¨æ»å¨è§</li>
<li>ä¿è¯çµä½å¨æ»¡éç¨è¦çå®éªæå¨è§åº¦</li>
</ul>
</li>
<li><strong>ä¾çµä¸çµè·¯è®¾è®¡</strong>ï¼
<ul>
<li>çµä½å¨ä¸¤ç«¯åèªä¸²7.5â¯kÎ© çµé»åå«æ¥å¥ Â±12â¯V ä¾çµ</li>
<li>è¾åºçµåä¸æå¨è§åº¦çº¿æ§æ å°</li>
</ul>
</li>
</ul>
<h3 id="2ï¸â£-ç¤ºæå¾">2ï¸â£ ç¤ºæå¾</h3>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3496115/202601/3496115-20260113201046016-1937574723.png" class="lazyload"></p>
<hr>
<h2 id="ä¸ä½¿ç¨æç¤º">ä¸ãä½¿ç¨æç¤º</h2>
<ul>
<li>å®éªç¡¬ä»¶ä¸æ¯æç»å¯¹ç¼ç å¨ééæ¶ï¼å¯ä½¿ç¨çµä½å¨æ¹æ¡</li>
<li>æå¨è§åº¦æéï¼éå¸¸ 0â90Â°ï¼æ¶ï¼132 åçµä½å¨éé½¿è½®å¯è¦çå¨èå´</li>
<li>çµä½å¨æ«ç«¯é¢çæ­»åºï¼é¿åæºæ¢°ç£¨æ</li>
<li>é½¿è½®æ¯åçè®¾è®¡ï¼ä¿è¯çµä½å¨æ»¡éç¨å¯¹åºå®éªæå¨è§åº¦</li>
<li>è¾åºçµåå¯ç´æ¥ç¨äºééç³»ç»ææ¨¡ææ§å¶å¨</li>
<li>è¥å®éªéè¦æ´å¤§è§åº¦æå¨åæµéï¼å¯èèåçº§çµä½å¨æä½¿ç¨ç»å¯¹ç¼ç å¨</li>
</ul>
<blockquote>
<p>æ»ç»ï¼å¨ç¡¬ä»¶ä¸æ¯æç»å¯¹ç¼ç å¨ééçå®éªç¯å¢ä¸ï¼<strong>132 åçµä½å¨ + é½¿è½®ä¼ å¨ + ä¸²èçµé»ä¾çµ</strong>æ¯ä¸ç§ç¨³å®ãå¯è¡çç»å¯¹ä½ç½®æµéæ¹æ¡ï¼æä½ç®åï¼å®éªéªè¯ç¨³å®ã</p>
</blockquote>
<hr>
<h2 id="åè¯´æ">åãè¯´æ</h2>
<ul>
<li>
<blockquote>
<p>æ¬æé¦åäºãGitHub/Giteeãï¼ä½èï¼KANICï¼ç ç©¶æ¹åä¸º èªå¨åå®éªå¹³å°ãæ§å¶ç®æ³éªè¯ååå®ç©ä»¿çç³»ç»ã</p>
</blockquote>
<p>ç¸å³å®éªæç¨åºå·²æ´çè³ GitHubï¼å¯å¨ GitHub å¹³å°æç´¢ KANIC-lab/KANIC æ¥çã</p>
<p>å¦éè¿ä¸æ­¥è®¨è®ºï¼å¯ç§ä¿¡èç³»ï¼å¹¶æ³¨ææç« ç¼å·ãæç« ç¼å·ä½äºæ é¢æ«å°¾ï¼ä»¥å­æ¯å¼å¤´å¦âEXP-XXXX-XXXâ</p>
</li>
</ul>

</div>
<div class="clear"></div>

        </div>
        <p class="postfoot">
            posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 20:12">2026-01-13 20:11</span>&nbsp;
<a href="https://www.cnblogs.com/SimLab">æ§å¶è¿·æ</a>&nbsp;
éè¯»(<span id="post_view_count">9</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479117);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479117', targetLink: 'https://www.cnblogs.com/SimLab/p/19479117', title: 'çµä½å¨å®ç°çµæºç»å¯¹ä½ç½®æµé-PART-çµä½è®¡-ç»å¯¹ä½ç½®' })">ä¸¾æ¥</a>

        </p>
     ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ [python] åºäºpython-docxåºçWordææ¡£èªå¨å¤çå¨è§£ ]]></title>
    <link>https://www.cnblogs.com/luohenyueji/p/19479110</link>
    <guid>0f733a57a0f84250cb564f286b930e27</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/luohenyueji/p/19479110" title="åå¸äº 2026-01-13 20:08">
    <span role="heading" aria-level="2">[python] åºäºpython-docxåºçWordææ¡£èªå¨å¤çå¨è§£</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>python-docxæ¯ä¸æ¬¾çº¯Pythonå®ç°çç¬¬ä¸æ¹åºï¼ä¸é¨ç¨äºåå»ºåä¿®æ¹Microsoft Wordç.docxæ ¼å¼ææ¡£ãè¯¥åºæ éä¾èµ Microsoft Wordè½¯ä»¶å³å¯è¿è¡ï¼å·å¤ä¼ç§çè·¨å¹³å°ç¹æ§ï¼å¯å¨WindowsãMacãLinuxç­ç³»ç»ä¸ä½¿ç¨ãéè¦æ³¨æçæ¯ï¼python-docxä»å¼å®¹.docx æ ¼å¼ï¼å¯¹åº Word 2007 åä»¥ä¸çæ¬ï¼ï¼ä¸æ¯ææ§çç.doc æ ¼å¼æä»¶ã.docxæ¯åºäºXMLçå¼æ¾åç¼©æ ¼å¼ï¼è.docæ¯äºè¿å¶ç§ææ ¼å¼ï¼åèä½ç§¯æ´å°ãå¼å®¹æ§æ´ä¼ã</p>
<p>python-docxå®æ¹ä»£ç ä»åºè§ï¼<a href="https://github.com/python-openxml/python-docx" target="_blank" rel="noopener nofollow">python-docx</a>ï¼è¯¦ç»ææ¡£è§ï¼<a href="https://python-docx.readthedocs.io/en/latest/" target="_blank" rel="noopener nofollow">python-docx docs</a>ãæªè³æ¬ææ°åæ¶ï¼python-docxçç¨³å®çæ¬ä¸º1.2.0ï¼python-docxå®è£å½ä»¤å¦ä¸ï¼</p>
<blockquote>
<p>pip install python-docx</p>
</blockquote>
<p></p><div class="toc"><div class="toc-container-header">ç®å½</div><ul><li><a href="#1-ä½¿ç¨è¯´æ" rel="noopener nofollow">1 ä½¿ç¨è¯´æ</a><ul><li><a href="#11-å¿«éå¥é¨" rel="noopener nofollow">1.1 å¿«éå¥é¨</a></li><li><a href="#12-python-docxçæ ¸å¿å¯¹è±¡" rel="noopener nofollow">1.2 Python-docxçæ ¸å¿å¯¹è±¡</a><ul><li><a href="#121-documentå¯¹è±¡" rel="noopener nofollow">1.2.1 Documentå¯¹è±¡</a></li><li><a href="#122-tableå¯¹è±¡" rel="noopener nofollow">1.2.2 Tableå¯¹è±¡</a></li><li><a href="#123-ææ¬å¤ç" rel="noopener nofollow">1.2.3 ææ¬å¤ç</a></li><li><a href="#124-sectionså¯¹è±¡" rel="noopener nofollow">1.2.4 Sectionså¯¹è±¡</a></li><li><a href="#125-é¡µçé¡µèå¯¹è±¡" rel="noopener nofollow">1.2.5 é¡µçé¡µèå¯¹è±¡</a></li></ul></li><li><a href="#13-éææ¬åå®¹ç®¡ç" rel="noopener nofollow">1.3 éææ¬åå®¹ç®¡ç</a><ul><li><a href="#131-æ ·å¼ç®¡ç" rel="noopener nofollow">1.3.1 æ ·å¼ç®¡ç</a></li><li><a href="#132-æ¹æ³¨ç®¡ç" rel="noopener nofollow">1.3.2 æ¹æ³¨ç®¡ç</a></li><li><a href="#133-å¾çå¯¹è±¡" rel="noopener nofollow">1.3.3 å¾çå¯¹è±¡</a></li></ul></li><li><a href="#14-ç»¼åç¤ºä¾" rel="noopener nofollow">1.4 ç»¼åç¤ºä¾</a></li></ul></li><li><a href="#2-åè" rel="noopener nofollow">2 åè</a></li></ul></div><p></p>
<h1 id="1-ä½¿ç¨è¯´æ">1 ä½¿ç¨è¯´æ</h1>
<h2 id="11-å¿«éå¥é¨">1.1 å¿«éå¥é¨</h2>
<p>Python-docxä¸­çWordææ¡£åå­å¯¹è±¡æ¨¡åéç¨æ ç¶ç»æåå±æ å°ææ¡£åç´ ï¼ä½¿å¾ç¨åºè½å¤ç²¾åæ§å¶ææ¡£çåå®¹ãæ ¼å¼ä¸å¸å±ãè¯¥æ ç¶ç»æç¤ºæå¦ä¸ï¼</p>
<pre><code class="language-shell">Documentï¼ææ¡£ï¼
âââ Sectionsï¼èï¼
âââ Paragraphsï¼æ®µè½ï¼
â   âââ Runsï¼ææ¬çæ®µï¼
â   âââ InlineShapesï¼åèå½¢ç¶ï¼å¦å¾çï¼
âââ Tablesï¼è¡¨æ ¼ï¼
â   âââ Rowsï¼è¡ï¼
â   â   âââ Cellsï¼ååæ ¼ï¼
â   â       âââ Paragraphsï¼ååæ ¼åçæ®µè½ï¼
âââ Core Propertiesï¼ææ¡£å±æ§ï¼
</code></pre>
<p>åä¸ªå¯¹è±¡ç®ä»å¦ä¸ï¼</p>
<table>
<thead>
<tr>
<th>æ ¸å¿å¯¹è±¡</th>
<th>ä»£è¡¨å«ä¹</th>
<th>å¨ææ¡£æ ä¸­çä½ç½®</th>
<th>ä¸»è¦åè½ä¸è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Document</code></td>
<td>æ´ä¸ªWordææ¡£å¯¹è±¡</td>
<td>æ ¹å¯¹è±¡</td>
<td>ç¨äºæå¼æåå»ºä¸ä¸ª<code>.docx</code>æä»¶</td>
</tr>
<tr>
<td><code>Sections</code></td>
<td>ææ¡£çè</td>
<td><code>Document.sections</code></td>
<td>ç®¡çé¡µé¢è®¾ç½®ï¼å¦é¡µè¾¹è·ãçº¸å¼ æ¹åï¼</td>
</tr>
<tr>
<td><code>Paragraph</code></td>
<td>æ®µè½</td>
<td><code>Document.paragraphs</code>æ<code>Table.cell.paragraphs</code></td>
<td>ææ¡£çåºæ¬ååç±ä¸ä¸ªæå¤ä¸ª<code>Run</code>ç»æï¼å¹¶æ¥æç»ä¸çæ®µè½æ ¼å¼</td>
</tr>
<tr>
<td><code>Run</code></td>
<td>å·æç¸åæ ¼å¼çè¿ç»­ææ¬</td>
<td><code>Paragraph.runs</code></td>
<td>æ ¼å¼æ§å¶çæå°åä½ï¼å¯ä»¥å¯¹<code>Run</code>åç¬è®¾ç½®å­ä½ãå¤§å°ç­å­ç¬¦çº§æ ¼å¼</td>
</tr>
<tr>
<td><code>Table</code></td>
<td>è¡¨æ ¼</td>
<td><code>Document.tables</code></td>
<td>ä»£è¡¨ææ¡£ä¸­çä¸ä¸ªè¡¨æ ¼ï¼ç±è¡ï¼<code>Table.rows</code>ï¼ãåï¼<code>Table.columns</code>ï¼åååæ ¼ï¼<code>Table.cell</code>ï¼ç»æ</td>
</tr>
<tr>
<td><code>Cell</code></td>
<td>è¡¨æ ¼ååæ ¼</td>
<td><code>Table.cell(row,col)</code></td>
<td>æ¯ä¸ª<code>Cell</code>æ¬èº«å¯ä»¥åå«å¤ä¸ª<code>Paragraph</code>ï¼å°±åä¸ä¸ªå¾®ç¼©ææ¡£</td>
</tr>
<tr>
<td><code>InlineShape</code></td>
<td>ååµå½¢ç¶ï¼å¦å¾çï¼</td>
<td><code>Paragraph.add_picture()</code>åå»º</td>
<td>ä»£è¡¨ææ¡£ä¸­ä¸ææ¬å¨åä¸å±çå¾å½¢å¯¹è±¡ï¼æå¸¸ç¨çæ¯å¾ç</td>
</tr>
<tr>
<td><code>Styles</code></td>
<td>æ ·å¼éå</td>
<td><code>Document.styles</code></td>
<td>ç®¡çææ¡£ä¸­å®ä¹çæææ ·å¼ï¼å¦âæ é¢1âãâæ­£æâç­ï¼</td>
</tr>
</tbody>
</table>
<p><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/CSDN/%5Bpython%5D%20%E5%9F%BA%E4%BA%8Epython-docx%E5%BA%93%E7%9A%84Word%E6%96%87%E6%A1%A3%E8%87%AA%E5%8A%A8%E5%A4%84%E7%90%86%E5%85%A8%E8%A7%A3/imgs/1.jpg" alt="" loading="lazy"></p>
<p>ä»¥ä¸ä»£ç ç¤ºä¾æè¿°äºå¦ä½éè¿python-docxåºå¿«éå®ç°ææ¡£çåå»ºï¼å®ææ®µè½ãæ é¢ãè¡¨æ ¼ãå¾çç­åå®¹æ·»å åå­ç¬¦æ®µè½æ ·å¼è®¾ç½®ï¼å¹¶ä¿å­ä¸ºdocxæä»¶ï¼</p>
<pre><code class="language-python"># 1. åå§åææ¡£
from docx import Document
from docx.shared import Inches, Cm

# æ°å»ºç©ºç½ææ¡£ï¼ä¸æ·»å åæ°ï¼é»è®¤æ°å»º
doc = Document()  

# 2. æ·»å æ®µè½
# é»è®¤é½ä¼æåå®¹è¿½å å°ææ¡£çæ«å°¾
doc.add_paragraph("è¿æ¯ææ¡£æ­£ææ®µè½")  # ç´æ¥æ·»å æ®µè½
para = doc.add_paragraph("ä¸»æ®µè½") # è¯¥æ¹æ³è¿åæ°æ®µè½çå¼ç¨å¯¹è±¡
para.insert_paragraph_before("æå¥å¨ä¸»æ®µè½ä¸æ¹çæ®µè½")  # ä¸»æ®µè½çå¼ç¨ä¹åæå¥æ®µè½
para = doc.add_paragraph("æå¥å¨ä¸»æ®µè½ä¸æ¹çæ®µè½") # ä¸»æ®µè½çå¼ç¨ä¹åæå¥æ®µè½

# 3. æ·»å æ é¢ï¼çº§å«1-9ï¼0ä¸ºææ¡£æ é¢ï¼
doc.add_heading("ææ¡£æ»æ é¢", level=0) # ä¸ä»½æ¥åçå°é¢æ é¢
doc.add_heading("ç¬¬ä¸ç«  æ¦è¿°", level=1) # ä¸çº§æ é¢
doc.add_heading("1.1 æ ¸å¿åè½", level=2) # äºçº§æ é¢

# 4. åé¡µç¬¦
doc.add_page_break()  # å¼ºå¶åç»­åå®¹å¦èµ·ä¸é¡µ

# 5. æ·»å è¡¨æ ¼ï¼åºå®è¡+å¨æè¡+æ ·å¼ï¼
# 5.1 åºå®è¡¨æ ¼ï¼2è¡2åï¼
table1 = doc.add_table(rows=2, cols=2)
table1.cell(0, 0).text = "å§å"
table1.cell(0, 1).text = "å¹´é¾"
table1.cell(1, 0).text = "å¼ ä¸"
table1.cell(1, 1).text = "25"

# 5.2 å¨æè¡¨æ ¼ï¼è¡¨å¤´+æ°æ®è¡ï¼
table2 = doc.add_table(rows=1, cols=3)
# å°é¼ æ æ¬åå¨Wordè¡¨æ ¼æ ·å¼åºä¸­çè¡¨æ ¼æ ·å¼ç¼©ç¥å¾ä¸ï¼å³å¯æ¾å°è¡¨æ ¼æ ·å¼åç§°
table2.style = "Light Shading Accent 1"  # åºç¨é¢è®¾æ ·å¼
headers = ["æ°é", "äº§åç¼å·", "æè¿°"]
for i, header in enumerate(headers):
    table2.rows[0].cells[i].text = header
# æ¹éæ·»å æ°æ®
items = [(7, "1024", "æ¯ç»å°ç«"), (3, "2042", "è²æ¯ç²¾çµ"), (1, "1288", "è±ªåé¡¹å")]
for item in items:
    row = table2.add_row().cells
    row[0].text = str(item[0])
    row[1].text = item[1]
    row[2].text = item[2]

# 6. æ·»å å¾çï¼æ¬å°æä»¶+å°ºå¯¸è°æ´ï¼
doc.add_picture("test.png", width=Inches(1.5))  # 1.5è±å¯¸å®½ï¼èªå¨ç­æ¯ç¼©æ¾ï¼
doc.add_picture("test2.jpg", width=Cm(5),height=Cm(1))  # åæ¶æå®å®½é«

# 7. æ®µè½æ ·å¼ï¼é¡¹ç®ç¬¦å·/ç¼å·ï¼
doc.add_paragraph("é¡¹ç®ç¬¦å·åè¡¨é¡¹1", style="ListBullet")
doc.add_paragraph("é¡¹ç®ç¬¦å·åè¡¨é¡¹2", style="ListBullet")
doc.add_paragraph("ç¼å·åè¡¨é¡¹1", style="ListNumber")

# 8. å­ç¬¦æ ¼å¼ï¼ç²ä½/æä½ï¼
para = doc.add_paragraph()
para.add_run("æ®éææ¬ ").bold = False
para.add_run("ç²ä½ææ¬").bold = True
para.add_run(" æ®éææ¬ ").italic = False
para.add_run("æä½ææ¬").italic = True

# 9. å­ç¬¦æ ·å¼ï¼é¢è®¾æ ·å¼ï¼
para2 = doc.add_paragraph("æ®éææ¬ï¼")
para2.add_run("å¸¦å¼ºè°çææ¬", style="Emphasis")  # åºç¨"å¼ºè°"æ ·å¼

# 10. ä¿å­ææ¡£
doc.save("test_output.docx")
</code></pre>
<p>åç»­åå®¹å°å¯¹python-docxçåä¸ªæ ¸å¿å¯¹è±¡è¿è¡å·ä½ä»ç»ã</p>
<h2 id="12-python-docxçæ ¸å¿å¯¹è±¡">1.2 Python-docxçæ ¸å¿å¯¹è±¡</h2>
<h3 id="121-documentå¯¹è±¡">1.2.1 Documentå¯¹è±¡</h3>
<p>Python-docxæ¬è´¨ä¸æ¯ä¸ä¸ªææ¡£ä¿®æ¹å·¥å·ãå³ä½¿åå»ºæ°ææ¡£ï¼å¶åçä¹æ¯åºäºä¸ä¸ªé¢è®¾çç©ºç½æ¨¡æ¿è¿è¡ä¿®æ¹ãå æ­¤ï¼ææ¡£çæ ¼å¼ï¼å¦æ ·å¼ãé¡µçãé¡µèï¼ä¸æ­£æåå®¹æ¯åç¦»å­å¨çï¼å³ä½¿æ¸ç©ºæ¨¡æ¿æå­ä¹ä¸ä¼å é¤æ ¼å¼è®¾å®ãä»¥ä¸ç¤ºä¾å±ç¤ºäºå¦ä½åå»ºææ¡£ææå¼å·²æææ¡£ï¼</p>
<pre><code class="language-python">from docx import Document
from io import BytesIO, StringIO  # ç¨äºç±»æä»¶å¯¹è±¡æä½

"""æ¼ç¤ºpython-docxæä½ææ¡£çæ ¸å¿åè½"""
# ===================== 1. åå»ºæ°ææ¡£å¹¶ä¿å­ =====================
print("1. åå»ºæ°ææ¡£å¹¶ä¿å­...")
# åºäºé»è®¤æ¨¡æ¿åå»ºç©ºææ¡£
new_doc = Document()
new_doc.add_heading('python-docx ææ¡£æä½ç¤ºä¾', level=1)
new_doc.add_paragraph('è¿æ¯éè¿python-docxåå»ºçæ°ææ¡£')
# ä¿å­æ°ææ¡£å°æ¬å°
new_doc.save('æ°å»ºææ¡£.docx')
print("â æ°ææ¡£å·²ä¿å­ä¸ºï¼æ°å»ºææ¡£.docx")

# ===================== 2. æå¼ç°æææ¡£å¹¶ä¿®æ¹ä¿å­ =====================
print("\n2. æå¼ç°æææ¡£å¹¶ä¿®æ¹...")
# æå¼åæåå»ºçææ¡£
existing_doc = Document('æ°å»ºææ¡£.docx')
# åææ¡£è¿½å åå®¹
existing_doc.add_paragraph('è¿æ¯æå¼ç°æææ¡£åè¿½å çåå®¹')
# å¦å­ä¸ºæ°æä»¶ï¼é¿åè¦çåæä»¶ï¼
existing_doc.save('ä¿®æ¹åçææ¡£.docx')
print("â ä¿®æ¹åçææ¡£å·²ä¿å­ä¸ºï¼ä¿®æ¹åçææ¡£.docx")

# ===================== 3. éè¿ç±»æä»¶å¯¹è±¡ï¼BytesIOï¼è¯»åææ¡£ =====================
print("\n3. éè¿ç±»æä»¶å¯¹è±¡æä½ææ¡£...")
# 3.1 è¯»åï¼å°æ¬å°ææ¡£è¯»åå°BytesIOæµä¸­
with open('ä¿®æ¹åçææ¡£.docx', 'rb') as f:  # å¿é¡»ç¨rbï¼äºè¿å¶è¯»ï¼ï¼è·¨å¹³å°å¼å®¹
    doc_stream = BytesIO(f.read())  # ç¨BytesIOèéStringIO

# ä»æµä¸­æå¼ææ¡£
stream_doc = Document(doc_stream)
# è¿½å åå®¹
stream_doc.add_paragraph('è¿æ¯éè¿ç±»æä»¶å¯¹è±¡æ·»å çåå®¹')

# 3.2 ä¿å­ï¼å°ææ¡£ä¿å­å°BytesIOæµä¸­ï¼ä¸è½å°å°æ¬å°æä»¶ï¼
output_stream = BytesIO()
stream_doc.save(output_stream)

# å¯éï¼å°æµä¸­çåå®¹åå¥æ¬å°æä»¶ï¼éªè¯ç»æ
with open('ç±»æä»¶å¯¹è±¡çæçææ¡£.docx', 'wb') as f:
    f.write(output_stream.getvalue())
print("â ç±»æä»¶å¯¹è±¡æä½çææ¡£å·²ä¿å­ä¸ºï¼ç±»æä»¶å¯¹è±¡çæçææ¡£.docx")

# å³é­æµ
doc_stream.close()
output_stream.close()
</code></pre>
<h3 id="122-tableå¯¹è±¡">1.2.2 Tableå¯¹è±¡</h3>
<p>Wordè½¯ä»¶ä¸­çè¡¨æ ¼åè½ç¸å½å¤æï¼è¿å¯¼è´å¨ä½¿ç¨python-docxæä½è¡¨æ ¼æ¶ï¼å¾å¾é¾ä»¥æåæç¡®è¡¨æ ¼çå·ä½åå®¹åç»æï¼å¢å äºå¤ççé¾åº¦ãæ¬èå°ä»ç®åè¡¨æ ¼å°å¤æè¡¨æ ¼æ¥ä»ç»å¦ä½ä½¿ç¨python-docxæä½è¡¨æ ¼ã</p>
<p><strong>è§æ´è¡¨æ ¼</strong></p>
<p>è§æ´è¡¨æ ¼ä¹å°±æ¯ä¸ä¸ªè¡åæ°åºå®ãæ åå¹¶æçç¥ååæ ¼çæ åè¡¨æ ¼ï¼è¿æ¯æåºç¡çè¡¨æ ¼å½¢å¼ãå³ç³»åæ°æ®åºè¡¨åpandasæ°æ®è¡¨é½æ¯è§æ´è¡¨æ ¼çå¸åç¤ºä¾ï¼</p>
<pre><code class="language-shell">+---+---+---+
| a | b | c |
+---+---+---+
| d | e | f |
+---+---+---+
| g | h | i |
+---+---+---+
</code></pre>
<p>éè¿æ§å¶è¡¨æ ¼è¡åæ°å³å¯åå»ºè§æ´è¡¨æ ¼ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.shared import Inches

# åå»ºæ°ææ¡£
doc = Document()

# æ·»å 3è¡2åçè§æ´è¡¨æ ¼
table = doc.add_table(rows=3, cols=2)
table.style = 'Table Grid'  # æ¾ç¤ºè¡¨æ ¼è¾¹æ¡ï¼ä¾¿äºæ¥ç

# å¡«åååæ ¼åå®¹ï¼a-i å¯¹åºç¤ºä¾ä¸­çè§æ´è¡¨æ ¼ï¼
cell_texts = ['a', 'b', 'c', 'd', 'e', 'f']
idx = 0
for row in table.rows:
    for cell in row.cells:
        cell.text = cell_texts[idx]
        idx += 1

# ä¿å­ææ¡£
doc.save('è§æ´è¡¨æ ¼ç¤ºä¾.docx')

# è¯»åå¹¶éªè¯è§æ´è¡¨æ ¼çè¡åæ°ï¼æ¯è¡ååæ ¼æ°ç¸åï¼
print("è§æ´è¡¨æ ¼æ¯è¡çååæ ¼æ°ï¼")
for i, row in enumerate(table.rows):
    print(f"ç¬¬{i+1}è¡ï¼{len(row.cells)}ä¸ªååæ ¼")
</code></pre>
<p><strong>åå¹¶ååæ ¼</strong></p>
<p>å°å¤ä¸ªè¿ç»­çæ¨ªåæçºµåååæ ¼åå¹¶ä¸ºä¸ä¸ªååæ ¼ï¼æ¯å®éä½¿ç¨ä¸­éå¸¸å¸¸è§çæ¹å¼ï¼</p>
<pre><code class="language-shell">+---+---+---+   +---+---+---+
|   a   | b |   |   | b | c |
+---+---+---+   + a +---+---+
| c | d | e |   |   | d | e |
+---+---+---+   +---+---+---+
| f | g | h |   | f | g | h |
+---+---+---+   +---+---+---+
</code></pre>
<p>å®ç°æ¹å¼ä¸ºååå»ºè§æ´è¡¨æ ¼ï¼åéè¿<code>cell.merge()</code>å®ç°ååæ ¼çæ¨ªåæçºµååå¹¶ï¼</p>
<pre><code class="language-python">from docx import Document

doc = Document()
table = doc.add_table(rows=2, cols=3)
table.style = 'Table Grid'

# ç¤ºä¾1ï¼æ¨ªååå¹¶ï¼ç¬¬ä¸è¡ç¬¬ä¸ä¸ªååæ ¼åå¹¶å³ä¾§ååæ ¼ï¼
cell_1_1 = table.cell(0, 0)  # ç¬¬1è¡ç¬¬1åï¼ç´¢å¼ä»0å¼å§ï¼
cell_1_2 = table.cell(0, 1)
cell_1_1.merge(cell_1_2)
cell_1_1.text = 'åå¹¶ååæ ¼ï¼æ¨ªåï¼'

# ç¤ºä¾2ï¼çºµååå¹¶ï¼ç¬¬ä¸ååä¸¤ä¸ªååæ ¼åå¹¶ï¼
cell_1_3 = table.cell(0, 2)
cell_2_3 = table.cell(1, 2)
cell_1_3.merge(cell_2_3)
cell_1_3.text = 'åå¹¶ååæ ¼ï¼çºµåï¼'

# å¡«åå¶ä»ååæ ¼
table.cell(1, 0).text = 'd'
table.cell(1, 1).text = 'e'

# æ¥çåå¹¶åæ¯è¡çååæ ¼æ°
# æ³¨æä»¥ä¸åå®¹è¿åçæ¯åå§è¡¨æ ¼ç»æ
print("åå¹¶ååæ ¼åæ¯è¡çååæ ¼æ°ï¼")
for i, row in enumerate(table.rows):
    print(f"ç¬¬{i+1}è¡ï¼{len(row.cells)}ä¸ªååæ ¼")

doc.save('åå¹¶ååæ ¼ç¤ºä¾.docx')
</code></pre>
<p><strong>éå½è¡¨æ ¼</strong></p>
<p>è¡¨æ ¼å¤ççå¦ä¸ä¸ªå¤æç¹æ¯å¶éå½ç¹æ§ï¼Wordä¸­çè¡¨æ ¼ååæ ¼æ¬èº«å¯ä»¥åå«ä¸ä¸ªæå¤ä¸ªè¡¨æ ¼ãå¯ä»¥éè¿<code>_Cell.tables</code>æ<code>_Cell.iter_inner_content()</code>æ£æµåµå¥è¡¨æ ¼ï¼</p>
<ul>
<li><code>_Cell.tables</code>ï¼ç´æ¥è¿åååæ ¼ååå«çææè¡¨æ ¼ã</li>
<li><code>_Cell.iter_inner_content()</code>ï¼æææ¡£é¡ºåºè¿åååæ ¼åçææåå®¹ï¼åæ¬æ®µè½åè¡¨æ ¼ï¼ï¼ä¿æè¡¨æ ¼ä¸æ®µè½çç¸å¯¹ä½ç½®ä¸åã</li>
</ul>
<p>ç¤ºä¾ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.shared import Inches
from docx.table import Table
from docx.text.paragraph import Paragraph

def generate_nested_table_doc():
    """çæå¸¦åµå¥è¡¨æ ¼çç¤ºä¾Wordææ¡£ï¼ç¤ºä¾æ°æ®ï¼"""
    # 1. åå»ºæ°ææ¡£
    doc = Document()

    # 2. åå»ºå¤å±è¡¨æ ¼ï¼2è¡2åï¼
    outer_table = doc.add_table(rows=2, cols=2)
    outer_table.style = 'Table Grid'  # æ¾ç¤ºè¡¨æ ¼è¾¹æ¡

    # 3. å¡«åå¤å±è¡¨æ ¼çæ®éååæ ¼
    cell_1_1 = outer_table.cell(0, 0)
    cell_1_1.text = "ä¸æ¹ååæ ¼åå«åµå¥è¡¨æ ¼"

    cell_1_2 = outer_table.cell(0, 1)
    cell_1_2.text = "æ®éååæ ¼ï¼æ åµå¥ï¼"

    # 4. å³é®ï¼å¨ (1,0) ååæ ¼ä¸­åµå¥ä¸ä¸ªå­è¡¨æ ¼
    cell_2_1 = outer_table.cell(1, 0)
    # åç»åµå¥è¡¨æ ¼åå ä¸ä¸ªæ®µè½ï¼æ¨¡æçå®ææ¡£çæ··ååå®¹ï¼
    para = cell_2_1.add_paragraph("åµå¥è¡¨æ ¼åçæ®µè½åå®¹ï¼")
    # å¨ååæ ¼ååå»ºåµå¥è¡¨æ ¼ï¼3è¡1åï¼
    inner_table = cell_2_1.add_table(rows=3, cols=1)
    inner_table.style = 'Table Grid'
    # å¡«ååµå¥è¡¨æ ¼
    inner_table.cell(0, 0).text = "åµå¥è¡¨æ ¼-è¡1"
    inner_table.cell(1, 0).text = "åµå¥è¡¨æ ¼-è¡2"
    inner_table.cell(2, 0).text = "åµå¥è¡¨æ ¼-è¡3"
    # åµå¥è¡¨æ ¼ååå ä¸ä¸ªæ®µè½
    cell_2_1.add_paragraph("åµå¥è¡¨æ ¼åçæ®µè½åå®¹")

    # 5. å¡«åå¤å±è¡¨æ ¼æåä¸ä¸ªååæ ¼
    cell_2_2 = outer_table.cell(1, 1)
    cell_2_2.text = "æ®éååæ ¼ï¼æ åµå¥ï¼"

    # 6. ä¿å­ææ¡£ï¼çæç¤ºä¾æ°æ®ï¼
    doc.save("åµå¥è¡¨æ ¼.docx")
    print("=" * 50)
    print("â åµå¥è¡¨æ ¼.docx")
    print("=" * 50)

def traverse_table(table, level=0):
    """
    éå½éåè¡¨æ ¼ï¼å¤çåµå¥è¡¨æ ¼
    :param table: è¦éåçè¡¨æ ¼å¯¹è±¡
    :param level: è¡¨æ ¼åµå¥å±çº§ï¼å¤å±ä¸º0ï¼åå±+1ï¼
    """
    indent = "  " * level  # ç¼©è¿ï¼æ¹ä¾¿åºåå±çº§
    print(f"\n{indent}=== éåãå±çº§{level}ãè¡¨æ ¼ ===")
    
    # éåè¡¨æ ¼çæ¯ä¸è¡
    for row_idx, row in enumerate(table.rows):
        # éåè¡ä¸­çæ¯ä¸ä¸ªååæ ¼
        for col_idx, cell in enumerate(row.cells):
            print(f"\n{indent}ååæ ¼ ({row_idx+1}, {col_idx+1})ï¼")
            
            # --------------------------
            # æ¹æ³1ï¼_Cell.tables - ç´æ¥è·åååæ ¼åçææè¡¨æ ¼
            # --------------------------
            inner_tables = cell.tables
            if inner_tables:
                print(f"{indent}  ð æ£æµå° {len(inner_tables)} ä¸ªåµå¥è¡¨æ ¼ï¼")
                # éå½éåæ¯ä¸ªåµå¥è¡¨æ ¼
                for inner_table in inner_tables:
                    traverse_table(inner_table, level + 1)
            else:
                print(f"{indent}  ð æ åµå¥è¡¨æ ¼")
            
            # --------------------------
            # æ¹æ³2ï¼_Cell.iter_inner_content() - æé¡ºåºè·åååæ ¼åææåå®¹ï¼æ®µè½+è¡¨æ ¼ï¼
            # --------------------------
            print(f"{indent}  ð ååæ ¼åå®æ´åå®¹ï¼æé¡ºåºï¼ï¼")
            for content in cell.iter_inner_content():
                if isinstance(content, Paragraph):
                    # å¤çæ®µè½åå®¹ï¼è¿æ»¤ç©ºæ®µè½ï¼
                    text = content.text.strip()
                    if text:
                        print(f"{indent} [æ®µè½]ï¼{text}")
                elif isinstance(content, Table):
                    # éå°è¡¨æ ¼æ¶çæç¤ºï¼é¿åéå¤éåï¼ä»æ¼ç¤ºä½ç½®ï¼
                    print(f"{indent} [è¡¨æ ¼]ï¼åµå¥è¡¨æ ¼ï¼å±çº§{level+1}ï¼")

def parse_nested_tables():
    """è§£æçæçåµå¥è¡¨æ ¼ææ¡£ï¼æ¼ç¤ºæ ¸å¿æ¹æ³"""
    # 1. æå¼ç¤ºä¾ææ¡£
    doc = Document("åµå¥è¡¨æ ¼.docx")

    # 2. éåææ¡£ä¸­çææå¤å±è¡¨æ ¼
    print("\nå¼å§è§£æåµå¥è¡¨æ ¼ï¼")
    print("-" * 50)
    for table in doc.tables:
        traverse_table(table)

# ä¸»ç¨åºå¥å£
if __name__ == "__main__":
    # çæå¸¦åµå¥è¡¨æ ¼çç¤ºä¾ææ¡£
    generate_nested_table_doc()
    
    # ç¬¬äºæ­¥ï¼è§£æåµå¥è¡¨æ ¼ï¼æ¼ç¤º_Cell.tablesåiter_inner_contentçä½¿ç¨
    parse_nested_tables()
    
    print("\n" + "=" * 50)
    print("â åµå¥è¡¨æ ¼è§£æå®æï¼")
    print("=" * 50)
</code></pre>
<h3 id="123-ææ¬å¤ç">1.2.3 ææ¬å¤ç</h3>
<p>å¨Wordææ¡£ä¸­ï¼åå®¹çç»ç»é»è¾åä¸ºä¸¤ä¸ªä¸»è¦å±çº§ï¼åçº§å¯¹è±¡åè¡åå¯¹è±¡ã</p>
<ul>
<li>åçº§å¯¹è±¡ï¼å¦æ®µè½ãè¡¨æ ¼ï¼æ¯å æ®æ´è¡çå¤§æ¨¡åï¼å¶å®½åº¦ç±é¡µé¢è¾¹è·ãåæ æååæ ¼è¾¹çå³å®ï¼ææ¬ä¼å¨å¶å·¦å³è¾¹çåèªå¨æ¢è¡ã</li>
<li>è¡åå¯¹è±¡åå­å¨äºè¿äºå¤§æ¨¡ååé¨ï¼å¦å ç²çè¯è¯­æå¥å­ï¼æå¸¸è§çè¡¨ç°å½¢å¼æ¯ææ¬çæ®µï¼runsï¼ãä¸ä¸ªæ®µè½å°±æ¯ç±ä¸ä¸ªæå¤ä¸ªææ¬çæ®µç»æçã</li>
</ul>
<p>ç¸åºå°ï¼æ ¼å¼æ§å¶ä¹åä¸ºä¸¤ç±»ï¼</p>
<ul>
<li>åçº§å±æ§ï¼å¦ç¼©è¿ãé´è·ãå¯¹é½æ¹å¼ï¼æ§å¶æ¨¡åå¨é¡µé¢ä¸çå¸å±ä½ç½®ï¼</li>
<li>è¡åå±æ§ï¼å¦å­ä½ãå ç²ãé¢è²ï¼åæ§å¶æ¨¡ååé¨æå­çå·ä½å¤è§ã</li>
</ul>
<p>ä¸é¢éè¿Python-docxçä»£ç ç¤ºä¾ï¼å±ç¤ºè¿ä¸¤ç±»æ ¼å¼çå®éåºç¨ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.shared import Inches, Pt, RGBColor
from docx.enum.text import (
    WD_ALIGN_PARAGRAPH,
    WD_TAB_ALIGNMENT,
    WD_TAB_LEADER,
    WD_UNDERLINE
)
from docx.enum.dml import MSO_THEME_COLOR

# åå»ºä¸ä¸ªæ°ç Word ææ¡£
doc = Document()

# ==================== 1. åçº§æ ¼å¼è®¾ç½®ï¼æ®µè½å¸å±æ§å¶ ====================
# 1.1 æ é¢æ®µè½ï¼å±ä¸­å¯¹é½ãæ®µåé´è·ï¼
title_para = doc.add_paragraph("Python-docx ææ¬æ ¼å¼ç¤ºä¾")
title_format = title_para.paragraph_format  # åçº§æ ¼å¼å¯¹è±¡
title_format.alignment = WD_ALIGN_PARAGRAPH.CENTER  # å±ä¸­å¯¹é½ï¼åçº§å±æ§ï¼
title_format.space_after = Pt(18)  # æ®µåé´è·ï¼åçº§å±æ§ï¼

# 1.2 æ­£ææ®µè½ï¼ç¼©è¿ä¸è¡é´è·ï¼
content_para = doc.add_paragraph("è¿æ¯ä¸ä¸ªå¸¦ç¼©è¿åèªå®ä¹è¡é´è·çæ­£ææ®µè½ã")
content_format = content_para.paragraph_format
content_format.left_indent = Inches(0.5)          # å·¦ç¼©è¿
content_format.first_line_indent = Inches(-0.25)  # æ¬æç¼©è¿
content_format.line_spacing = 1.5                # 1.5åè¡é´è·
content_format.space_before = Pt(12)             # æ®µåé´è·

# 1.3 å¸¦å¶è¡¨ä½çæ®µè½ï¼åçº§å®ä½ï¼
tab_para = doc.add_paragraph("å§å:\tå¼ ä¸\tå¹´é¾:\t25")
tab_format = tab_para.paragraph_format
tab_stops = tab_format.tab_stops
# æ·»å ä¸ä¸ªå¶è¡¨ä½ï¼ä½ç½®ãå¯¹é½æ¹å¼ãåå¯¼ç¬¦ï¼
tab_stops.add_tab_stop(Inches(1.5), WD_TAB_ALIGNMENT.RIGHT, WD_TAB_LEADER.DOTS)
tab_stops.add_tab_stop(Inches(2.5), WD_TAB_ALIGNMENT.LEFT, WD_TAB_LEADER.SPACES)
tab_stops.add_tab_stop(Inches(3.5), WD_TAB_ALIGNMENT.RIGHT, WD_TAB_LEADER.DOTS)

# 1.4 åé¡µæ§å¶ï¼åçº§ä¿æä¸å­¤è¡æ§å¶ï¼
page_para1 = doc.add_paragraph("è¿æ¯ç« èæ é¢ï¼ç¡®ä¿ä¸ä¸ä¸æ®µåé¡µï¼")
page_para1.paragraph_format.keep_with_next = True  # ä¸ä¸æ®µåé¡µ
page_para2 = doc.add_paragraph("è¿æ¯ç« èåå®¹ï¼å¯ç¨äºå­¤è¡æ§å¶ï¼é¿åæ®µè½é¦è¡/æ«è¡åç¬æ¾ç¤ºå¨ä¸é¡µã" * 20)
page_para2.paragraph_format.widow_control = True   # é¿åå­¤è¡

# ==================== 2. è¡åæ ¼å¼è®¾ç½®ï¼æå­å¤è§æ§å¶ ====================
char_para = doc.add_paragraph("å­ç¬¦æ ¼å¼ç¤ºä¾ï¼")

# ç²ä½
bold_run = char_para.add_run("ç²ä½ææ¬")
bold_run.font.bold = True
char_para.add_run(" | ")

# æä½
italic_run = char_para.add_run("æä½ææ¬")
italic_run.font.italic = True
char_para.add_run(" | ")

# ä¸åçº¿ï¼åä¸åçº¿ï¼
underline_run = char_para.add_run("åä¸åçº¿ææ¬")
underline_run.font.underline = WD_UNDERLINE.DOUBLE
char_para.add_run(" | ")

# ä¸åå­å·åé¢è²
color_run = char_para.add_run("16å·çº¢è²ææ¬")
color_run.font.size = Pt(16)               # å­å·
color_run.font.color.rgb = RGBColor(255, 0, 0)  # é¢è²
char_para.add_run(" | ")

# ä¸æ 
sup_run = char_para.add_run("ä¸æ ")
sup_run.font.superscript = True

# ==================== 3. ä¿å­ææ¡£ ====================
doc.save("ææ¬æ ¼å¼ç¤ºä¾.docx")
print("ææ¡£å·²ä¿å­ä¸ºï¼ææ¬æ ¼å¼ç¤ºä¾.docx")
</code></pre>
<h3 id="124-sectionså¯¹è±¡">1.2.4 Sectionså¯¹è±¡</h3>
<p>Wordå¼å¥äºèï¼sectionï¼çæ¦å¿µï¼å®æææ¡£ä¸­å·æç¸åé¡µé¢å¸å±ï¼å¦é¡µè¾¹è·ãçº¸å¼ æ¹åï¼çè¿ç»­é¨åãéè¿åèï¼ç¨æ·å¯ä»¥å¨åä¸ä»½ææ¡£ä¸­æ··åä½¿ç¨ä¸åçå¼ï¼ä¾å¦åæ¶åå«çºµåé¡µé¢åæ¨ªåé¡µé¢ãæ­¤å¤ï¼æ¯ä¸ªèè¿å¯ä»¥ç¬ç«è®¾ç½®å¶é¡µçä¸é¡µèçæ ·å¼ãç»å¤§å¤æ°Wordææ¡£é»è®¤ä»åå«ä¸ä¸ªèï¼éå¸¸ä¹æ éæ´æ¹é¡µé¢å¸å±ãç¶èï¼å½ç¡®å®éè¦å¯¹é¡µé¢å¸å±è¿è¡è°æ´æ¶ï¼çè§£èçåè½ä¸è®¾ç½®æ¹æ³å°±åå¾è³å³éè¦ãä»¥ä¸ç¤ºä¾å±ç¤ºäºå¦ä½ä½¿ç¨python-docxåºåå»ºåå«å¤ä¸ªèãåèæ¥æä¸åé¡µé¢è®¾ç½®çWordææ¡£ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.enum.section import WD_SECTION_START
from docx.enum.section import WD_ORIENT
from docx.shared import Inches

# 1. åå»ºæ°ææ¡£å¹¶æ¥çé»è®¤è
document = Document()
print("åå§ææ¡£çèæ°éï¼", len(document.sections))  # é»è®¤1ä¸ªè

# è·åé»è®¤èå¹¶ä¿®æ¹å¶åºç¡å¸å±ï¼çºµåï¼å¸¸è§è¾¹è·ï¼
default_section = document.sections[0]
# è®¾ç½®é»è®¤èçè¾¹è·ï¼å·¦1.5è±å¯¸ãå³1è±å¯¸ãä¸ä¸å1è±å¯¸
default_section.left_margin = Inches(1.5)
default_section.right_margin = Inches(1)
default_section.top_margin = Inches(1)
default_section.bottom_margin = Inches(1)

# 2. ç»é»è®¤èæ·»å åå®¹ï¼çºµåé¡µé¢åå®¹ï¼
document.add_heading('ç¬¬ä¸èï¼çºµåé¡µé¢åå®¹', level=1)
document.add_paragraph('è¿æ¯é»è®¤èçåå®¹ï¼é¡µé¢ä¸ºçºµåï¼è¾¹è·ï¼å·¦1.5è±å¯¸ãå³1è±å¯¸ã')

# 3. æ·»å æ°èï¼å¥æ°é¡µå¼å§ï¼æ¨ªåå¸å±ï¼
# åå»ºæ°èï¼æå®åèç¬¦ç±»åä¸ºå¥æ°é¡µå¼å§
new_section = document.add_section(WD_SECTION_START.ODD_PAGE)
# ä¿®æ¹æ°èçé¡µé¢æ¹åä¸ºæ¨ªåï¼éåæ¶äº¤æ¢å®½é«ï¼
new_section.orientation = WD_ORIENT.LANDSCAPE
# åäº¤æ¢å®½é«å¼ï¼é¿åé¡µé¢å°ºå¯¸å¼å¸¸
new_width, new_height = new_section.page_height, new_section.page_width
new_section.page_width = new_width
new_section.page_height = new_height
# è®¾ç½®æ°èçè¾¹è·ï¼å·¦å³å1.25è±å¯¸ï¼ä¸ä¸å0.8è±å¯¸
new_section.left_margin = Inches(1.25)
new_section.right_margin = Inches(1.25)
new_section.top_margin = Inches(0.8)
new_section.bottom_margin = Inches(0.8)

# 4. ç»æ°èæ·»å åå®¹ï¼æ¨ªåé¡µé¢åå®¹ï¼
document.add_heading('ç¬¬äºèï¼æ¨ªåé¡µé¢åå®¹', level=1)
document.add_paragraph('è¿æ¯æ°èçåå®¹ï¼é¡µé¢ä¸ºæ¨ªåï¼è¾¹è·ï¼å·¦å³1.25è±å¯¸ãä¸ä¸0.8è±å¯¸ã')

# 5. åæ·»å ä¸ä¸ªæ°èï¼å¶æ°é¡µå¼å§ï¼çºµåå¸å±ï¼
third_section = document.add_section(WD_SECTION_START.EVEN_PAGE)
# æ¢å¤çºµåå¸å±
third_section.orientation = WD_ORIENT.PORTRAIT
third_section.page_width = Inches(8.5)
third_section.page_height = Inches(11)
# è®¾ç½®ç¹æ®è¾¹è·ï¼æ·»å è£è®¢çº¿ï¼
third_section.gutter = Inches(0.2)  # è£è®¢çº¿0.2è±å¯¸
third_section.header_distance = Inches(0.6)  # é¡µçè·ç¦»0.6è±å¯¸

# 6. ç»ç¬¬ä¸ä¸ªèæ·»å åå®¹
document.add_heading('ç¬¬ä¸èï¼å¸¦è£è®¢çº¿ççºµåé¡µé¢', level=1)
document.add_paragraph('è¿ä¸èåå«0.2è±å¯¸çè£è®¢çº¿ï¼é¡µçè·ç¦»é¡µé¢é¡¶é¨0.6è±å¯¸ã')

# 7. éåææèï¼æå°å³é®å±æ§
print("\n=== ææèçå³é®å±æ§ ===")
for idx, section in enumerate(document.sections):
    print(f"\nç¬¬{idx+1}èï¼")
    print(f"  èµ·å§ç±»åï¼{section.start_type}")
    print(f"  é¡µé¢æ¹åï¼{section.orientation}")
    print(f"  å·¦å³è¾¹è·ï¼{section.left_margin/914400:.2f}è±å¯¸ / {section.right_margin/914400:.2f}è±å¯¸")
    print(f"  è£è®¢çº¿ï¼{section.gutter/914400:.2f}è±å¯¸")

# ä¿å­ææ¡£
document.save("å¤èææ¡£ç¤ºä¾.docx")
print("\nææ¡£å·²ä¿å­ä¸ºï¼å¤èææ¡£ç¤ºä¾.docx")
</code></pre>
<h3 id="125-é¡µçé¡µèå¯¹è±¡">1.2.5 é¡µçé¡µèå¯¹è±¡</h3>
<p>é¡µçæ¯ææ¾ç¤ºå¨æ¯ä¸é¡µä¸é¡µè¾¹è·åºåçææ¬ï¼ä¸æ­£æåå®¹ç¸äºç¬ç«ï¼éå¸¸ç¨äºå±ç¤ºææ¡£æ é¢ãä½èãåå»ºæ¥ææé¡µç ç­ä¸ä¸æä¿¡æ¯ãåä¸ææ¡£ä¸­çé¡µçå¨åé¡µé¢é´åºæ¬ä¿æä¸è´ï¼ä»å¨é¨ååå®¹ä¸å¯è½å­å¨ç»å¾®å·®å¼ï¼ä¾å¦ç« èæ é¢æé¡µç çååãé¡µèå¨åè½åç¹æ§ä¸ä¸é¡µçå®å¨ç±»ä¼¼ï¼å¯ä¸çåºå«æ¯é¡µèä½äºé¡µé¢åºé¨ãé¡µèä¸èæ³¨ä¸åï¼èæ³¨å¨åé¡µé¢é´å¹¶ä¸ç»ä¸ãä»¥ä¸æ¯æä½ææ¡£é¡µçé¡µèçç¤ºä¾ä»£ç ï¼</p>
<pre><code class="language-python">from docx import Document

# -------------------------- 1. åå§åææ¡£å¹¶åå»ºåºç¡é¡µç --------------------------
# åå»ºæ°ææ¡£
doc = Document()

# è·åææ¡£çç¬¬ä¸ä¸ªèï¼æ°å»ºææ¡£é»è®¤åªæ1ä¸ªèï¼
section1 = doc.sections[0]
header1 = section1.header

# æ£æ¥åå§ç¶æï¼æ°å»ºææ¡£çé¡µçé»è®¤å³èå°åä¸èé¡µçè®¾ç½®ï¼æ­¤å¤æ åç½®èï¼ææ å®éé¡µçï¼
print(f"åå§é¡µçå³èç¶æ: {header1.is_linked_to_previous}")  # è¾åº: True

# ä¸ºç¬¬ä¸èæ·»å ç®åé¡µçï¼ä»å·¦ä¾§ææ¬ï¼
# ç´æ¥ç¼è¾é¡µççç¬¬ä¸ä¸ªæ®µè½ï¼æ°å»ºé¡µçé»è®¤åå«1ä¸ªç©ºæ®µè½ï¼
para1 = header1.paragraphs[0]
para1.text = "ææ¡£ä¸»æ é¢ - ç¬¬ä¸èé¡µç"
# èªå¨åå»ºç¬ç«é¡µçå®ä¹ï¼å³èç¶æåä¸ºFalse
print(f"æ·»å é¡µçåå³èç¶æ: {header1.is_linked_to_previous}")  # è¾åº: False

# -------------------------- 2. æ·»å å¸¦ååºï¼å·¦/ä¸­/å³ï¼çé¡µç --------------------------
# åæ¸ç©ºç¬¬ä¸èåæé¡µçåå®¹ï¼éæ°è®¾ç½®ååºé¡µç
para1.clear()
# ä½¿ç¨å¶è¡¨ç¬¦\tåéå·¦ãä¸­ãå³ä¸é¨ååå®¹
para1.text = "å·¦ä¾§ï¼ææ¡£åç§°\tå±ä¸­ï¼2026å¹´1æ\tå³ä¾§ï¼é¡µç "
# åºç¨Wordé»è®¤ç"Header"æ ·å¼ï¼ç¡®ä¿å¶è¡¨ä½çæï¼
para1.style = doc.styles["Header"]

# -------------------------- 3. æ·»å æ°èå¹¶è®¾ç½®ç¬ç«é¡µç --------------------------
# åææ¡£æ«å°¾æ·»å æ°èï¼section2ï¼
section2 = doc.add_section()
header2 = section2.header

# åå§ç¶æï¼æ°èçé¡µçé»è®¤å³èå°åä¸èï¼section1ï¼
print(f"ç¬¬äºèåå§å³èç¶æ: {header2.is_linked_to_previous}")  # è¾åº: True
# éªè¯ï¼æ­¤æ¶ç¼è¾header2çåå®¹ä¼ç´æ¥ä¿®æ¹section1çé¡µçï¼ç»§æ¿ç¹æ§ï¼
# ååæ¶å³èï¼åå»ºç¬¬äºèçç¬ç«é¡µç
header2.is_linked_to_previous = False
# ä¸ºç¬¬äºèæ·»å ä¸å±é¡µç
para2 = header2.paragraphs[0]
para2.text = "ç¬¬äºèç¬ç«é¡µç - ä»æ¬èæ¾ç¤º"

# -------------------------- 4. æ·»å é¡µèï¼ä¸é¡µçç¨æ³å®å¨ä¸è´ï¼ --------------------------
# ä¸ºç¬¬ä¸èæ·»å é¡µèï¼åå«é¡µç ï¼
footer1 = doc.sections[0].footer
footer1.is_linked_to_previous = False  # åæ¶å³èï¼åå»ºç¬ç«é¡µè
footer_para1 = footer1.paragraphs[0]
footer_para1.text = "\tç¬¬ {PAGE} é¡µ / å± {NUMPAGES} é¡µ\t"  # å±ä¸­æ¾ç¤ºé¡µç 
footer_para1.style = doc.styles["Footer"]
# ä¸ºç¬¬äºèæ·»å ä¸åçé¡µè
footer2 = doc.sections[1].footer
footer2.is_linked_to_previous = False
footer_para2 = footer2.paragraphs[0]
footer_para2.text = "ç¬¬äºèé¡µè - èç³»äººï¼æµè¯è´¦å·"

# -------------------------- 5. å é¤é¡µçï¼æ¢å¤å³èç¶æï¼ --------------------------
# è¥éå é¤ç¬¬äºèçç¬ç«é¡µçï¼åªéå°å¶å³èç¶æè®¾ä¸ºTrueï¼ä¼æ°¸ä¹å é¤åå®¹ï¼
# æ­¤å¤ä»æ¼ç¤ºï¼æ³¨éæé¿åå½±åæç»ææ
# header2.is_linked_to_previous = True

# -------------------------- 6. ä¿å­ææ¡£ --------------------------
doc.save("é¡µçé¡µèç¤ºä¾.docx")
print("ææ¡£å·²ä¿å­ä¸ºï¼é¡µçé¡µèç¤ºä¾.docx")
</code></pre>
<h2 id="13-éææ¬åå®¹ç®¡ç">1.3 éææ¬åå®¹ç®¡ç</h2>
<h3 id="131-æ ·å¼ç®¡ç">1.3.1 æ ·å¼ç®¡ç</h3>
<p>å¨Wordä¸­ï¼åç½®æ ·å¼ä¼åºç°å¨Wordçé¢çæ ·å¼é¢æ¿ä¸­ï¼ä½ä¸ä¼èªå¨å å¥ææ¡£ä¸­ï¼ç´å°ä½ ç¬¬ä¸æ¬¡ä½¿ç¨å®ãè¿æ ·é¿åäºæä»¶å æææ ·å¼å®ä¹èèè¿ãä¸æ¦ææ ·å¼è¢«ä½¿ç¨ï¼å¶å®ä¹å°±ä¼æ°¸ä¹å å¥ææ¡£ï¼å³ä½¿åæ¥å é¤åºç¨åå®¹ä¹ä¸ä¼æ¶å¤±ãå æ­¤ï¼è¥è¦ç¨python-docxä½¿æ ·å¼çæï¼å¿é¡»å¨åå§ææ¡£ä¸­åå«å¶å®ä¹ï¼å¦åæ ·å¼ä¼éé»å¤±æã<br>
ä»¥ä¸æ¯ä¸ä¸ªç»¼åæ§çç¤ºä¾ï¼å®æ´åäºææ¡£ä¸­æææ ¸å¿çæ ·å¼æä½åè½ï¼åæ¬æ ·å¼çè®¿é®ãåºç¨ãåå»ºãå é¤ï¼ä»¥åå­ç¬¦æ®µè½æ ¼å¼çå®ä¹ç­ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.enum.style import WD_STYLE_TYPE
from docx.shared import Pt, Inches
from docx.enum.text import WD_UNDERLINE

# 1. åå»ºæ°ææ¡£å¹¶è®¿é®æ ·å¼éå
doc = Document()
styles = doc.styles
print(f"åå§æ ·å¼æ°é: {len(styles)}")

# 2. è®¿é®å¹¶ç­éç¹å®ç±»åçæ ·å¼
# ç­éæææ®µè½æ ·å¼å¹¶æå°åç§°
print("\n=== æææ®µè½æ ·å¼ ===")
paragraph_styles = [s for s in styles if s.type == WD_STYLE_TYPE.PARAGRAPH]
for style in paragraph_styles[:5]:  # åªæå°å5ä¸ªé¿åè¾åºè¿é¿
    print(f"- {style.name}")

# 3. åºç¨ç°ææ ·å¼å°æ°æ®µè½
# æ¹å¼1: åå»ºæ¶æå®æ ·å¼åç§°
doc.add_heading("æ ·å¼æä½ç¤ºä¾", level=0)
heading1_para = doc.add_paragraph("è¿æ¯åºç¨ Heading 1 æ ·å¼çæ®µè½", style="Heading 1")
# æ¹å¼2: ååå»ºæ®µè½åèµå¼æ ·å¼å¯¹è±¡
normal_para = doc.add_paragraph()
normal_para.text = "è¿æ¯ååå»ºååºç¨ Normal æ ·å¼çæ®µè½"
normal_para.style = styles["Normal"]

# 4. åå»ºèªå®ä¹æ ·å¼
# 4.1 åå»ºæ®µè½æ ·å¼å¹¶è®¾ç½®åºç¡æ ·å¼ãå­ç¬¦æ ¼å¼ãæ®µè½æ ¼å¼
citation_style = styles.add_style("Citation", WD_STYLE_TYPE.PARAGRAPH)
# è®¾ç½®åºç¡æ ·å¼ï¼ç»§æ¿ Normal æ ·å¼çæ ¼å¼ï¼
citation_style.base_style = styles["Normal"]
# è®¾ç½®å­ç¬¦æ ¼å¼
citation_style.font.name = "å®ä½"
citation_style.font.size = Pt(10)
citation_style.font.italic = True  # æä½
citation_style.font.underline = WD_UNDERLINE.DOT_DASH  # ç¹åçº¿ä¸åçº¿
# è®¾ç½®æ®µè½æ ¼å¼ï¼æ¬æç¼©è¿ãæ®µåé´è·ï¼
citation_style.paragraph_format.left_indent = Inches(0.25)
citation_style.paragraph_format.first_line_indent = Inches(-0.25)
citation_style.paragraph_format.space_before = Pt(6)
# è®¾ç½®åç»­æ®µè½æ ·å¼
citation_style.next_paragraph_style = styles["Normal"]

# åºç¨èªå®ä¹æ ·å¼
citation_para = doc.add_paragraph("è¿æ¯èªå®ä¹ Citation æ ·å¼çå¼ç¨ææ¬", style="Citation")
print(f"\nèªå®ä¹æ ·å¼åºç¨ååç§°: {citation_para.style.name}")

# 5. æ§å¶æ ·å¼å¨ Word ä¸­çæ¾ç¤ºï¼å¿«éæ ·å¼ãä¼åçº§ï¼
body_text_style = styles["Body Text"]
body_text_style.hidden = False
body_text_style.quick_style = True
body_text_style.priority = 1

# 6. å¤çæ½å¨æ ·å¼ï¼Latent Stylesï¼
latent_styles = styles.latent_styles
print(f"\næ½å¨æ ·å¼æ»æ°: {len(latent_styles)}")

# ä¸º List Bullet æ·»å æ½å¨æ ·å¼å®ä¹
if "List Bullet" not in latent_styles:
    latent_list_bullet = latent_styles.add_latent_style("List Bullet")
    latent_list_bullet.hidden = False
    latent_list_bullet.priority = 2
    latent_list_bullet.quick_style = True
print(f"List Bullet æ½å¨æ ·å¼ä¼åçº§: {latent_styles['List Bullet'].priority}")

# 7. å é¤æ ·å¼
print(f"\nå é¤åæ ·å¼æ°é: {len(styles)}")
if "Citation" in styles:
    styles["Citation"].delete()
    print(f"å é¤åæ ·å¼æ°é: {len(styles)}")

# 8. ä¿å­ææ¡£
doc.save("æ ·å¼æä½ç¤ºä¾.docx")
print("\nææ¡£å·²ä¿å­ä¸º: æ ·å¼æä½ç¤ºä¾.docx")
</code></pre>
<h3 id="132-æ¹æ³¨ç®¡ç">1.3.2 æ¹æ³¨ç®¡ç</h3>
<p>Wordæ¯æå¨ææ¡£ä¸­æ·»å æ¹æ³¨ï¼è¿æ¯å®¡éåè½çä¸é¨åï¼éå¸¸ç¨äºä»äººå¨ä¸ä¿®æ¹åæçæåµä¸æä¾åé¦ãWordææ¡£éæä½æ­¥éª¤å¦ä¸ï¼</p>
<ol>
<li>éåææ¬èå´ï¼</li>
<li>ç¹å»å®¡éå·¥å·æ ä¸­çæ°å»ºæ¹æ³¨ï¼</li>
<li>è¾å¥æç²è´´æ¹æ³¨åå®¹ã</li>
</ol>
<p>æ¹æ³¨ä»è½æ·»å è³ææ¡£ä¸»ä½ï¼ä¸å¯æå¥é¡µçãé¡µèæå¶ä»æ¹æ³¨åãWordææ¡£éèæ³¨åå°¾æ³¨ä¸­çè®ºä¸åè®¸æ·»å æ¹æ³¨ï¼ä½å½åpython-docxæä¸æ¯æè¯¥æä½ãæ­¤å¤é«çæ¬Wordæ¯æè§£å³æ¹æ³¨ååå¤æ¹æ³¨åè½ï¼ä½python-docxææªå®ç°ãä»¥ä¸æ¯åå«æ¹æ³¨åå»ºãå¯ææ¬æ¹æ³¨ãåæ°æ®ä¿®æ¹åæ¹æ³¨éåçå®æ´ç¤ºä¾ï¼</p>
<pre><code class="language-python"># å¯¼å¥å¿è¦çåº
from docx import Document
from datetime import datetime, timezone

"""
åå»ºææ¡£å¹¶æ¼ç¤ºæ¹æ³¨çå®æ´æä½æµç¨ï¼
1. åå»ºåºç¡æ¹æ³¨
2. åå»ºå¯ææ¬æ ¼å¼æ¹æ³¨
3. ä¿®æ¹æ¹æ³¨åæ°æ®
4. è®¿é®åéåæææ¹æ³¨
"""
# 1. åå§åææ¡£å¯¹è±¡
doc = Document()
doc.add_heading("Python-docx æ¹æ³¨æ¼ç¤ºææ¡£", level=1)

# 2. ç¤ºä¾1ï¼åå»ºåºç¡ææ¬æ¹æ³¨
para1 = doc.add_paragraph("è¿æ¯ç¬¬ä¸æ®µæµè¯ææ¬ï¼ç¨äºæ·»å åºç¡æ¹æ³¨ã")
# ä¸ºæ´æ®µææ¬æ·»å åºç¡æ¹æ³¨
basic_comment = doc.add_comment(
    runs=para1.runs,  # å³èçææ¬å
    text="åºç¡æ¹æ³¨ï¼è¿æ®µææ¬è¡¨è¿°æ¸æ°ï¼å»ºè®®ä¿çã",  # æ¹æ³¨çº¯ææ¬åå®¹
    author="å¼ ä¸",  # æ¹æ³¨ä½è
    initials="ZS"  # ä½èç¼©å
)
print(f"â åºç¡æ¹æ³¨åå»ºå®æ")
# 3. ç¤ºä¾2ï¼åå»ºå¯ææ¬æ ¼å¼æ¹æ³¨ï¼åå«ç²ä½ãæä½ç­æ ·å¼ï¼
para2 = doc.add_paragraph("è¿æ¯ç¬¬äºæ®µæµè¯ææ¬ï¼ç¨äºæ·»å å¯ææ¬æ¹æ³¨ã")
# åå»ºç©ºåå®¹æ¹æ³¨ï¼åç»­æå¨æ·»å å¯ææ¬ï¼
rich_comment = doc.add_comment(
    runs=para2.runs,
    text="",  # åå§ä¸ºç©ºï¼åç»­æ·»å å¯ææ¬
    author="æå",
    initials="LS"
)
# åæ¹æ³¨ä¸­æ·»å å¯ææ¬åå®¹
cmt_para = rich_comment.paragraphs[0]  # è·åæ¹æ³¨çé»è®¤æ®µè½
cmt_para.add_run("å¯ææ¬æ¹æ³¨ï¼")  # æ®éææ¬
cmt_para.add_run("éç¹å»ºè®®ï¼").bold = True  # ç²ä½ææ¬
cmt_para.add_run("è¿æ®µææ¬éè¦è¡¥åæ¡ä¾ï¼").italic = True  # æä½ææ¬
cmt_para.add_run("å»ºè®®åèè¡ä¸æ åã")  # æ®éææ¬

# 4. ç¤ºä¾3ï¼ä¿®æ¹æ¹æ³¨åæ°æ®ï¼ä½èãç¼©åï¼
basic_comment.author = "å¼ å°ä¸"  # ä¿®æ¹ä½èå
basic_comment.initials = "ZXS"  # ä¿®æ¹ä½èç¼©å
print(f"â åºç¡æ¹æ³¨åæ°æ®å·²æ´æ°ï¼ä½è={basic_comment.author}ï¼ç¼©å={basic_comment.initials}")

# 5. ç¤ºä¾4ï¼è®¿é®åéåæææ¹æ³¨
print("\nð ææ¡£ä¸­æææ¹æ³¨ä¿¡æ¯ï¼")
for idx, comment in enumerate(doc.comments):
    print(f"\næ¹æ³¨ {idx+1}ï¼")
    print(f"  ä½èï¼{comment.author}")
    print(f"  ç¼©åï¼{comment.initials}")
    # æåæ¹æ³¨çå®æ´ææ¬ï¼å¼å®¹å¯ææ¬ï¼
    comment_text = "\n  ".join([para.text for para in comment.paragraphs])
    print(f"  åå®¹ï¼{comment_text}")

# 6. ä¿å­ææ¡£
doc.save("æ¹æ³¨æ¼ç¤ºææ¡£.docx")
print("\nð ææ¡£å·²ä¿å­ä¸ºï¼æ¹æ³¨æ¼ç¤ºææ¡£.docx")
</code></pre>
<h3 id="133-å¾çå¯¹è±¡">1.3.3 å¾çå¯¹è±¡</h3>
<p>Wordææ¡£ä¸­çåå®¹åä¸ºä¸¤ä¸ªå¾å±ï¼ææ¬å±åç»å¾å±ãææ¬å±æä»å·¦å°å³ãèªä¸èä¸çé¡ºåºæåï¼é¡µæ»¡åèªå¨æ¢é¡µãç»å¾å±ä¸­çå¯¹è±¡ç§°ä¸ºå½¢ç¶ï¼å¯èªç±æ¾ç½®ãå¾çæ¯ä¸ç§ç¹æ®å½¢ç¶ï¼å¯ç½®äºææ¬å±æç»å¾å±ãä½äºææ¬å±çå¾çç§°ä¸ºåµå¥å¼å¾çï¼å®å¨æçä¸­è¢«è§ä¸ºä¸ä¸ªå¤§åææ¬å­ç¬¦ï¼è¡é«ä¼èªå¨è°æ´ä»¥å®¹çº³å¾çï¼å¹¶æ¯æç±»ä¼¼ææ¬çæ¢è¡ææãè¥å¨å¶åæ¹æå¥ææ¬ï¼å¾çä¼éä¹ååç§»å¨ãåµå¥å¼å¾çéå¸¸ç¬å ä¸ä¸ªæ®µè½ï¼ä½ä¹å¯ä¸ååææ¬å±å­äºåä¸æ®µè½ä¸­ã</p>
<p>å½åpython-docxåºä»æ¯æåµå¥å¼å¾çãéè¿Document.add_picture()æ¹æ³å¯å°å¾çé»è®¤æ·»å è³ææ¡£æ«å°¾çç¬ç«æ®µè½ä¸­ï¼ä½ç»è¿éå½è®¾ç½®ï¼ä¹è½å®ç°çµæ´»çå¾ææ··æææï¼ç¤ºä¾å¦ä¸ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.shared import Inches, Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH

# 1. åå»ºä¸ä¸ªæ°çWordææ¡£
doc = Document()

# 2. åºç¡ç¨æ³ï¼å¨ææ¡£æ«å°¾æå¥å¾çï¼åç¬å ä¸ä¸ªæ®µè½ï¼
doc.add_heading('1. åºç¡æå¥å¾ç', level=2)
# æ·»å å¾çï¼è®¾ç½®å®½åº¦ä¸º2è±å¯¸ï¼é«åº¦ä¼ææ¯ä¾èªå¨è°æ´ï¼
doc.add_picture('test.png', width=Inches(2))

# 3. è¿é¶ç¨æ³ï¼å¾ææ··æï¼å¾çåææ¬å¨åä¸ä¸ªæ®µè½ï¼
doc.add_heading('2. å¾ææ··æç¤ºä¾', level=2)
# åå»ºä¸ä¸ªæ°æ®µè½
mixed_paragraph = doc.add_paragraph()
# æ·»å ææ¬å°æ®µè½å¼å¤´
mixed_paragraph.add_run('è¿æ¯å¾çå·¦ä¾§çææ¬ï¼')
# å¨æ®µè½ä¸­æå¥å¾çï¼éåç¬æ®µè½ï¼
img_run = mixed_paragraph.add_run()
img_run.add_picture('test.png', width=Inches(1))
# å¨å¾çå³ä¾§æ·»å ææ¬
mixed_paragraph.add_run('è¿æ¯å¾çå³ä¾§çææ¬ã')

# 4. èªå®ä¹å¾çå°ºå¯¸+æ®µè½å¯¹é½
doc.add_heading('3. èªå®ä¹å°ºå¯¸ä¸å¯¹é½', level=2)
align_para = doc.add_paragraph()
align_para.alignment = WD_ALIGN_PARAGRAPH.CENTER  # æ®µè½å±ä¸­å¯¹é½
align_run = align_para.add_run()
# åæ¶è®¾ç½®å®½åº¦åé«åº¦ï¼æ³¨æï¼å¯è½å¯¼è´å¾çåå½¢ï¼
align_run.add_picture('test.png', width=Inches(1.5), height=Inches(1))
align_para.add_run('\nè¿æ¯å±ä¸­æ¾ç¤ºçå¾ç')

# 5. ä¿å­ææ¡£
doc.save('å½¢ç¶å¾çç¤ºä¾.docx')
print("ææ¡£å·²ä¿å­ä¸ºå½¢ç¶å¾çç¤ºä¾.docx")
</code></pre>
<h2 id="14-ç»¼åç¤ºä¾">1.4 ç»¼åç¤ºä¾</h2>
<p>å¨å®éåºç¨ä¸­ï¼python-docxä¸»è¦è¢«ç¨äºææ¡£ä¿®æ¹åèªå¨åçæï¼èéä»å¤´åå»ºææ¡£ãæ¬èå°éè¿ä¸ä¸ªç»¼åç¤ºä¾ï¼å±ç¤ºå¦ä½å¯¹ä¸ä¸ªåå«æ é¢ãæ®µè½ãå¤ç§è¡¨æ ¼ãå¤å¼ å¾çååé¡µç¬¦çå¤é¡µææ¡£è¿è¡éå¯¹æ§ä¿®æ¹ï¼å¹¶æä¾ç¸åºçææ¡£çæä»£ç ã</p>
<p><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/CSDN/%5Bpython%5D%20%E5%9F%BA%E4%BA%8Epython-docx%E5%BA%93%E7%9A%84Word%E6%96%87%E6%A1%A3%E8%87%AA%E5%8A%A8%E5%A4%84%E7%90%86%E5%85%A8%E8%A7%A3/imgs/2.jpg" alt="" loading="lazy"></p>
<p><strong>ææ¡£çæ</strong></p>
<p>ä»¥ä¸ä»£ç çæä¸ä¸ªç¤ºä¾å¤é¡µææ¡£ï¼æ¶µçäºæ¥å¸¸åå¬ä¸­å¸¸è§çææ¡£ç»æï¼</p>
<pre><code class="language-python">from docx import Document
from docx.shared import Inches, Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.enum.table import WD_TABLE_ALIGNMENT
from docx.oxml.ns import qn
import os

def ensure_test_images():
    # ç®åçææµè¯å¾çï¼å¦ææ²¡æçè¯ï¼
    try:
        from PIL import Image
        for i in range(1, 3):
            img_path = f"image{i}.jpg"
            if not os.path.exists(img_path):
                img = Image.new('RGB', (800, 600), color='lightblue')
                img.save(img_path)
        print("æµè¯å¾çå·²åå¤å®æ")
    except ImportError:
        print("è¯·å®è£pillowåºï¼pip install pillow")
        exit(1)

# çæWordææ¡£
def generate_complex_doc():
    # åå»ºæ°ææ¡£
    doc = Document()
    
    # è®¾ç½®ææ¡£é»è®¤å­ä½ï¼è§£å³ä¸­ææ¾ç¤ºé®é¢ï¼
    doc.styles['Normal'].font.name = 'å¾®è½¯éé»'
    doc.styles['Normal']._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
    
    # ========== ç¬¬ä¸é¡µåå®¹ ==========
    # æ é¢
    title = doc.add_heading('XXé¡¹ç®è°ç æ¥å', 0)
    title.alignment = WD_ALIGN_PARAGRAPH.CENTER  # å±ä¸­å¯¹é½
    title_run = title.runs[0]
    title_run.font.size = Pt(24)
    title_run.font.bold = True
    
    # å¯æ é¢/è¯´æ
    sub_para = doc.add_paragraph('æ¥åçææ¶é´ï¼2026å¹´1æ  æ¥åç¼å¶äººï¼æµè¯ç¨æ·')
    sub_para.alignment = WD_ALIGN_PARAGRAPH.RIGHT
    sub_para_run = sub_para.runs[0]
    sub_para_run.font.size = Pt(10)
    
    # æ­£ææ®µè½
    doc.add_heading('ä¸ãé¡¹ç®æ¦è¿°', level=1)
    overview_para = doc.add_paragraph()
    overview_para.add_run('æ¬é¡¹ç®éå¯¹ä¼ä¸æ°å­åè½¬åéæ±ï¼éç¹è§£å³ç°æä¸å¡ç³»ç»æ°æ®å­¤å²ãæµç¨ä¸è§èãå³ç­æçä½ç­æ ¸å¿é®é¢ã').font.size = Pt(12)
    overview_para.add_run('\né¡¹ç®è¦çèå´åæ¬ï¼').font.bold = True
    overview_para.add_run('\n1) çäº§ç®¡çæ¨¡åï¼å®ç°çäº§æµç¨èªå¨åçæ§')
    overview_para.add_run('\n2) éå®ç®¡çæ¨¡åï¼æéå®¢æ·æ°æ®ä¸è®¢åç³»ç»')
    overview_para.add_run('\n3) è´¢å¡ç®¡çæ¨¡åï¼å®ç°è´¢å¡æ°æ®å®æ¶æ±æ»åæ')
    
    # ç¬¬ä¸ä¸ªè¡¨æ ¼ï¼é¡¹ç®åºç¡ä¿¡æ¯è¡¨ï¼2è¡4åï¼
    doc.add_heading('1.1 é¡¹ç®åºç¡ä¿¡æ¯', level=2)
    table1 = doc.add_table(rows=2, cols=4)
    table1.alignment = WD_TABLE_ALIGNMENT.CENTER  # è¡¨æ ¼å±ä¸­
    table1.style = 'Table Grid'  # å¸¦è¾¹æ¡æ ·å¼
    
    # å¡«åè¡¨æ ¼1è¡¨å¤´
    hdr_cells = table1.rows[0].cells
    hdr_cells[0].text = 'é¡¹ç®ç¼å·'
    hdr_cells[1].text = 'é¡¹ç®åç§°'
    hdr_cells[2].text = 'å¯å¨æ¶é´'
    hdr_cells[3].text = 'é¢è®¡å·¥æ'
    
    # å¡«åè¡¨æ ¼1åå®¹
    row_cells = table1.rows[1].cells
    row_cells[0].text = 'XM2026001'
    row_cells[1].text = 'ä¼ä¸æ°å­åè½¬åé¡¹ç®'
    row_cells[2].text = '2026-01-01'
    row_cells[3].text = '12ä¸ªæ'
    
    # è°æ´è¡¨æ ¼1ååæ ¼å­ä½
    for row in table1.rows:
        for cell in row.cells:
            for paragraph in cell.paragraphs:
                for run in paragraph.runs:
                    run.font.size = Pt(10)
                    run.font.name = 'å¾®è½¯éé»'
                    run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
    
    # æå¥ç¬¬ä¸å¼ å¾ç
    doc.add_heading('1.2 é¡¹ç®æ¶æå¾', level=2)
    img1_para = doc.add_paragraph()
    img1_para.alignment = WD_ALIGN_PARAGRAPH.CENTER
    img1_run = img1_para.add_run()
    img1_run.add_picture('image1.jpg', width=Inches(5))  # å¾çå®½åº¦5è±å¯¸
    img1_para.add_run('\nå¾1ï¼é¡¹ç®æ´ä½æ¶æå¾').font.size = Pt(10)
    
    # æå¥åé¡µç¬¦ï¼ç¬¬ä¸é¡µç»æï¼
    doc.add_page_break()
    
    # ========== ç¬¬äºé¡µåå®¹ ==========
    doc.add_heading('äºãé¡¹ç®èµæºéç½®', level=1)
    resource_para = doc.add_paragraph('æ¬é¡¹ç®æéèµæºåæ¬äººåèµæºãç¡¬ä»¶èµæºãè½¯ä»¶èµæºä¸å¤§ç±»ï¼å·ä½éç½®å¦ä¸è¡¨æç¤ºï¼')
    
    # ç¬¬äºä¸ªè¡¨æ ¼ï¼èµæºéç½®è¡¨ï¼5è¡3åï¼
    table2 = doc.add_table(rows=5, cols=3)
    table2.style = 'Table Grid'
    table2.alignment = WD_TABLE_ALIGNMENT.CENTER
    
    # å¡«åè¡¨æ ¼2
    table2_data = [
        ['èµæºç±»å', 'è§æ ¼/æ°é', 'å¤æ³¨'],
        ['äººåèµæº', 'é¡¹ç®ç»ç1äººï¼å¼åå·¥ç¨å¸5äººï¼æµè¯å·¥ç¨å¸2äºº', 'åä¸ºå¨è'],
        ['æå¡å¨', '8æ ¸16Gäºæå¡å¨3å°', 'é¿éäºECS'],
        ['æ°æ®åº', 'MySQL 8.0 ä¸»ä»æ¶æ', 'æ°æ®å®æ¶å¤ä»½'],
        ['è½¯ä»¶ææ', 'PythonãOfficeãå¼åå·¥å·', 'ä¼ä¸çææ']
    ]
    
    for i, row_data in enumerate(table2_data):
        row_cells = table2.rows[i].cells
        for j, cell_text in enumerate(row_data):
            row_cells[j].text = cell_text
            # è®¾ç½®ååæ ¼å­ä½
            for paragraph in row_cells[j].paragraphs:
                for run in paragraph.runs:
                    run.font.size = Pt(10)
                    run.font.name = 'å¾®è½¯éé»'
                    run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
        # è¡¨å¤´å ç²
        if i == 0:
            for cell in table2.rows[i].cells:
                for paragraph in cell.paragraphs:
                    for run in paragraph.runs:
                        run.font.bold = True
    
    # æå¥ç¬¬äºå¼ å¾ç
    doc.add_heading('2.1 èµæºé¨ç½²ç¤ºæå¾', level=2)
    img2_para = doc.add_paragraph()
    img2_para.alignment = WD_ALIGN_PARAGRAPH.CENTER
    img2_run = img2_para.add_run()
    img2_run.add_picture('image2.jpg', width=Inches(5))
    img2_para.add_run('\nå¾2ï¼èµæºé¨ç½²ææå¾').font.size = Pt(10)
    
    # è¡¥åæ®µè½åå®¹
    doc.add_paragraph('èµæºéç½®éµå¾ªãå¤ç¨ä¸é¢çæ©å±ãååï¼ç¡¬ä»¶èµæºå¯æ ¹æ®é¡¹ç®è¿åº¦å¼¹æ§æ©å®¹ï¼äººåèµæºéç¨ãæ ¸å¿+å¤åãæ¨¡å¼ä¿éäº¤ä»è¿åº¦ã')
    
    # æå¥åé¡µç¬¦ï¼ç¬¬äºé¡µç»æï¼
    doc.add_page_break()
    
    # ========== ç¬¬ä¸é¡µåå®¹ ==========
    doc.add_heading('ä¸ãé¡¹ç®é£é©è¯ä¼°', level=1)
    risk_para = doc.add_paragraph('éè¿å¯¹ææ¯ãäººåãææ¬ãè¿åº¦åä¸ªç»´åº¦çè¯ä¼°ï¼è¯å«åºä»¥ä¸æ ¸å¿é£é©ç¹ååºå¯¹æªæ½ï¼')
    
    # ç¬¬ä¸ä¸ªè¡¨æ ¼ï¼é£é©è¯ä¼°è¡¨ï¼4è¡4åï¼
    table3 = doc.add_table(rows=4, cols=4)
    table3.style = 'Table Grid'
    table3.alignment = WD_TABLE_ALIGNMENT.CENTER
    
    table3_data = [
        ['é£é©ç±»å', 'é£é©ç­çº§', 'å½±åèå´', 'åºå¯¹æªæ½'],
        ['ææ¯é£é©', 'ä¸­', 'æ ¸å¿åè½æ¨¡å', 'æåè¿è¡ææ¯é¢ç ï¼å¶å®å¤éæ¹æ¡'],
        ['è¿åº¦é£é©', 'ä½', 'æ´ä½äº¤ä»', 'è®¾ç½®éç¨ç¢èç¹ï¼æ¯å¨è¿åº¦å¤ç'],
        ['ææ¬é£é©', 'ä½', 'é¢ç®ç®¡æ§', 'å»ºç«ææ¬å°è´¦ï¼è¶æ¯æåé¢è­¦']
    ]
    
    for i, row_data in enumerate(table3_data):
        row_cells = table3.rows[i].cells
        for j, cell_text in enumerate(row_data):
            row_cells[j].text = cell_text
            for paragraph in row_cells[j].paragraphs:
                for run in paragraph.runs:
                    run.font.size = Pt(10)
                    run.font.name = 'å¾®è½¯éé»'
                    run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
        if i == 0:
            for cell in table3.rows[i].cells:
                for paragraph in cell.paragraphs:
                    for run in paragraph.runs:
                        run.font.bold = True
    
    # ç»å°¾æ®µè½
    doc.add_paragraph('\nç»¼ä¸æè¿°ï¼æ¬é¡¹ç®æ´ä½å¯æ§ï¼éè¿ç§å­¦çèµæºéç½®åé£é©ç®¡æ§æªæ½ï¼è½å¤ä¿éé¡¹ç®æè®¡åäº¤ä»å¹¶è¾¾å°é¢æç®æ ã')
    
    # ä¿å­ææ¡£
    doc.save('é¡¹ç®æ¥å.docx')
    print("é¡¹ç®æ¥åææ¡£å·²çæ")

if __name__ == '__main__':
    ensure_test_images()  # åå¤æµè¯å¾ç
    generate_complex_doc()
</code></pre>
<p><strong>ææ¡£ä¿®æ¹</strong></p>
<p>ææ¡£ä¿®æ¹ä»£ç éå¯¹ä¸è¿°çæçææ¡£ï¼å®ç°ä»¥ä¸å¸¸è§ä¿®æ¹éæ±ï¼</p>
<ul>
<li>ä¿®æ¹æ é¢åæ®µè½ææ¬</li>
<li>ä¿®æ¹è¡¨æ ¼ä¸­çåå®¹</li>
<li>æ¿æ¢å¾ç</li>
<li>æ·»å æ°çæ®µè½åè¡¨æ ¼</li>
<li>ä¿®æ¹å­ä½æ ·å¼</li>
</ul>
<p>ç¤ºä¾ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-python">from docx import Document
from docx.shared import Inches, Pt
from docx.shared import RGBColor
from docx.enum.table import WD_TABLE_ALIGNMENT
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.oxml.ns import qn
import os

# ä¿®æ¹å·²çæçWordææ¡£
def modify_complex_doc(file_path):
    # æå¼å·²çæçææ¡£
    doc = Document(file_path)
    print("å·²æå¼å¾ä¿®æ¹çææ¡£")
    
    # ========== 1. ä¿®æ¹æ é¢ ==========
    # ç¬¬ä¸ä¸ªæ é¢æ¯çº§å«0çæ é¢ï¼ä¸»æ é¢ï¼
    main_title = doc.paragraphs[0]
    main_title.runs[0].text = 'XXä¼ä¸æ°å­åè½¬åé¡¹ç®ç»çæ¥å'  # ä¿®æ¹ä¸»æ é¢ææ¬
    main_title.runs[0].font.color.rgb = RGBColor(0, 0, 255)  # æ é¢æ¹ä¸ºèè²
    main_title.runs[0].font.size = Pt(20)
    main_title.runs[0].font.name = 'å¾®è½¯éé»'
    main_title.runs[0]._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
    main_title.alignment = WD_ALIGN_PARAGRAPH.CENTER
    
    # ========== 2. ä¿®æ¹æ®µè½ææ¬ ==========
    # æ¾å°"é¡¹ç®æ¦è¿°"ä¸çæ®µè½ï¼å¯éè¿ææ¬ç¹å¾å®ä½ï¼
    for para in doc.paragraphs:
        if 'æ¬é¡¹ç®éå¯¹ä¼ä¸æ°å­åè½¬åéæ±' in para.text:
            # æ¸ç©ºåæåå®¹ï¼éæ°åå¥
            para.clear()
            new_run = para.add_run('æ¬é¡¹ç®éå¯¹å¤§åå¶é ä¼ä¸æ°å­åè½¬åéæ±ï¼éç¹è§£å³ç°æä¸å¡ç³»ç»æ°æ®å­¤å²ãæµç¨ä¸è§èãå³ç­æçä½ç­æ ¸å¿é®é¢ã')
            new_run.font.size = Pt(12)
            new_run.font.name = 'å¾®è½¯éé»'
            new_run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
            # è¿½å åå®¹
            para.add_run('\né¡¹ç®åçº§åæ°å¢ï¼')
            para.add_run('\n4) ä¾åºé¾ç®¡çæ¨¡åï¼æéä¸ä¸æ¸¸ä¾åºåæ°æ®')
            break
    
    # ========== 3. ä¿®æ¹è¡¨æ ¼åå®¹å¹¶æ·»å è¡¨æ ¼å ==========
    # è¡¨æ ¼1ï¼é¡¹ç®åºç¡ä¿¡æ¯è¡¨ï¼ç¬¬ä¸ä¸ªè¡¨æ ¼ï¼
    table1 = doc.tables[0]
    # ä¿®æ¹é¡¹ç®ç¼å·
    table1.rows[1].cells[0].text = 'XM2026001-FINAL'
    # ä¿®æ¹é¢è®¡å·¥æ
    table1.rows[1].cells[3].text = '10ä¸ªæ'
    # ç»ä¿®æ¹åçååæ ¼æå­æ çº¢
    for cell in [table1.rows[1].cells[0], table1.rows[1].cells[3]]:
        for para in cell.paragraphs:
            for run in para.runs:
                run.font.color.rgb = RGBColor(255, 0, 0)
                run.font.size = Pt(11)
                run.font.name = 'å¾®è½¯éé»'
                run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
    
    # ä¸ºè¡¨æ ¼1æ·»å è¡¨æ ¼åï¼è¡¨é¢ï¼
    # æ¾å°è¡¨æ ¼1çä½ç½®ï¼å¨è¡¨æ ¼ä¸æ¹æå¥è¡¨å
    table1_elem = table1._element
    table_caption1 = doc.add_paragraph('è¡¨1 é¡¹ç®åºç¡ä¿¡æ¯è¡¨')
    table_caption1.alignment = WD_ALIGN_PARAGRAPH.CENTER  # å±ä¸­å¯¹é½
    table_caption1.paragraph_format.space_before = Pt(0)
    table_caption1.paragraph_format.space_after = Pt(0)
    # è®¾ç½®è¡¨åå­ä½æ ¼å¼
    for run in table_caption1.runs:
        run.font.size = Pt(11)
        run.font.name = 'å¾®è½¯éé»'
        run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
        run.font.bold = True  # å ç²
    # å°è¡¨åæå¥å°è¡¨æ ¼ä¸æ¹
    table1_elem.addprevious(table_caption1._element)
    
    # è¡¨æ ¼2ï¼èµæºéç½®è¡¨ï¼ç¬¬äºä¸ªè¡¨æ ¼ï¼
    table2 = doc.tables[1]
    # ä¿®æ¹æå¡å¨éç½®
    table2.rows[3].cells[1].text = '16æ ¸32Gäºæå¡å¨3å°ï¼åçº§éç½®ï¼'
    # è®¾ç½®è¡¨æ ¼2ååæ ¼å­ä½
    for row in table2.rows:
        for cell in row.cells:
            for para in cell.paragraphs:
                for run in para.runs:
                    run.font.size = Pt(11)
                    run.font.name = 'å¾®è½¯éé»'
                    run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
    
    # ä¸ºè¡¨æ ¼2æ·»å è¡¨æ ¼åï¼è¡¨é¢ï¼
    table2_elem = table2._element
    table_caption2 = doc.add_paragraph('è¡¨2 é¡¹ç®èµæºéç½®è¡¨')
    table_caption2.alignment = WD_ALIGN_PARAGRAPH.CENTER
    for run in table_caption2.runs:
        run.font.size = Pt(11)
        run.font.name = 'å¾®è½¯éé»'
        run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
        run.font.bold = True
    table2_elem.addprevious(table_caption2._element)
    
    # ========== 4. æ¿æ¢å¾çå¹¶è§èå¾å ==========
    # ååå¤ä¸å¼ æ°çæµè¯å¾ç
    from PIL import Image
    new_img_path = 'test.png'
    if not os.path.exists(new_img_path):
        img = Image.new('RGB', (800, 600), color='lightgreen')
        img.save(new_img_path)
    
    # æ¾å°ç¬¬ä¸å¼ å¾çæå¨çæ®µè½ï¼éè¿å¾çç¸å³ç¹å¾ï¼
    img_para_index = -1
    for i, para in enumerate(doc.paragraphs):
        if 'å¾1ï¼é¡¹ç®æ´ä½æ¶æå¾' in para.text or 'graphicData' in str(para._element.xml):
            img_para_index = i
            break
    
    if img_para_index != -1:
        # æ¸ç©ºæ®µè½ä¸­çå¾çåæå­ï¼éæ°æ·»å 
        img_para = doc.paragraphs[img_para_index]
        img_para.clear()
        
        # éæ°æ·»å æ°å¾ç
        img_run = img_para.add_run()
        img_run.add_picture(new_img_path, width=Inches(5))
        
        # æ·»å è§èçå¾åï¼å¾é¢ï¼
        img_caption = img_para.add_run('\nå¾1 é¡¹ç®æ´ä½æ¶æå¾ï¼ç»çï¼')
        img_caption.font.size = Pt(10)
        img_caption.font.name = 'å¾®è½¯éé»'
        img_caption._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
        img_para.alignment = WD_ALIGN_PARAGRAPH.CENTER
    
    # ========== 5. æ·»å æ°åå®¹å¹¶ä¸ºæ°è¡¨æ ¼å è¡¨å ==========
    # å¨ç¬¬ä¸é¡µé£é©è¯ä¼°åæ·»å æ°çæ®µè½åè¡¨æ ¼
    # åæ¾å°é£é©è¯ä¼°æ é¢çä½ç½®ï¼å¨å¶åæ·»å åå®¹
    for i, para in enumerate(doc.paragraphs):
        if 'ä¸ãé¡¹ç®é£é©è¯ä¼°' in para.text:
            # æ·»å æ°çå­æ é¢
            new_sub_heading = doc.add_heading('3.1 é£é©åºå¯¹é¢æ¡', level=2)
            # æå¥å°æå®ä½ç½®
            doc.paragraphs.insert(i+1, new_sub_heading)
            
            # æ·»å æ°æ®µè½
            new_para = doc.add_paragraph('éå¯¹é«ä¼åçº§é£é©ï¼å¶å®ä¸é¡¹åºå¯¹é¢æ¡ï¼åæ¬åºæ¥ååºæµç¨ãå¤ç¨èµæºè°éæ¹æ¡ç­ï¼ç¡®ä¿é£é©åçæ¶å¯å¿«éå¤ç½®ã')
            new_para.alignment = WD_ALIGN_PARAGRAPH.JUSTIFY
            for run in new_para.runs:
                run.font.size = Pt(12)
                run.font.name = 'å¾®è½¯éé»'
                run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
            doc.paragraphs.insert(i+2, new_para)
            
            # æ·»å æ°è¡¨æ ¼ï¼åºæ¥é¢æ¡è¡¨ï¼
            new_table = doc.add_table(rows=2, cols=2)
            new_table.style = 'Table Grid'
            new_table.alignment = WD_TABLE_ALIGNMENT.CENTER
            # å¡«åæ°è¡¨æ ¼
            new_table.rows[0].cells[0].text = 'é£é©ç±»å'
            new_table.rows[0].cells[1].text = 'åºæ¥èç³»äºº'
            new_table.rows[1].cells[0].text = 'ææ¯é£é©'
            new_table.rows[1].cells[1].text = 'å¼ å·¥ 13800138000'
            # è®¾ç½®æ°è¡¨æ ¼å­ä½
            for row in new_table.rows:
                for cell in row.cells:
                    for para_cell in cell.paragraphs:
                        for run in para_cell.runs:
                            run.font.size = Pt(10)
                            run.font.name = 'å¾®è½¯éé»'
                            run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
            
            # ä¸ºæ°è¡¨æ ¼æ·»å è¡¨å
            new_table_caption = doc.add_paragraph('è¡¨3 é£é©åºæ¥èç³»äººè¡¨')
            new_table_caption.alignment = WD_ALIGN_PARAGRAPH.CENTER
            for run in new_table_caption.runs:
                run.font.size = Pt(11)
                run.font.name = 'å¾®è½¯éé»'
                run._element.rPr.rFonts.set(qn('w:eastAsia'), 'å¾®è½¯éé»')
                run.font.bold = True
            
            # æå¥æ°è¡¨æ ¼ååæ°è¡¨æ ¼
            doc.element.body.insert(i+3, new_table_caption._element)
            doc.element.body.insert(i+4, new_table._element)
            break
    
    # ========== ä¿å­ä¿®æ¹åçææ¡£ ==========
    doc.save('é¡¹ç®æ¥å_ä¿®æ¹ç.docx')
    print("ä¿®æ¹åçææ¡£å·²ä¿å­ï¼é¡¹ç®æ¥å_ä¿®æ¹ç.docx")

if __name__ == '__main__':
    # ç¡®ä¿åææ¡£å­å¨
    file_path = 'é¡¹ç®æ¥å.docx'
    if not os.path.exists(file_path):
        print("è¯·åè¿è¡çæä»£ç åå»ºåå§ææ¡£ï¼")
    else:
        modify_complex_doc(file_path)
</code></pre>
<h1 id="2-åè">2 åè</h1>
<ul>
<li><a href="https://github.com/python-openxml/python-docx" target="_blank" rel="noopener nofollow">python-docx</a></li>
<li><a href="https://python-docx.readthedocs.io/en/latest/" target="_blank" rel="noopener nofollow">python-docx docs</a></li>
</ul>

</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/luohenyueji/" target="_blank">è½ççå¯å</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/luohenyueji/p/19479110" target="_blank">https://www.cnblogs.com/luohenyueji/p/19479110</a></p>

<div style="text-align:center">
    <img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/wechat/content/%E5%8A%A0%E6%B2%B9%E9%B8%AD.gif">
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-13 20:09">2026-01-13 20:08</span>&nbsp;
<a href="https://www.cnblogs.com/luohenyueji">è½ççå¯å</a>&nbsp;
éè¯»(<span id="post_view_count">11</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19479110);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19479110', targetLink: 'https://www.cnblogs.com/luohenyueji/p/19479110', title: '[python] åºäºpython-docxåºçWordææ¡£èªå¨å¤çå¨è§£' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>