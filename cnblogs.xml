<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-02-04T20:29:32.632Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ [å¤§æ¨¡åå®æ 03é¢å¤] äºç«¯ç¼ä¸¹æ¿ 2ï¼Kaggle ä¸ææå ]]></title>
    <link>https://www.cnblogs.com/algieba/p/19576331</link>
    <guid>0183d382db088ace3e48d3c01bc18286</guid>
    <description>
    <![CDATA[ 
		<div class="postcontent">
			    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3169973/202602/3169973-20260204195327324-384345256.png" alt="[å¤§æ¨¡åå®æ 03é¢å¤] äºç«¯ç¼ä¸¹æ¿ 2ï¼Kaggle ä¸ææå" class="desc_img">
        Colab é¢åº¦ç¨å®äºï¼Kaggle å¸¦çä¸¤å¼  T4 æ¾å¡æ¥äºï¼æ¬æè¯¦è§£ Kaggle è´¦å·ææºéªè¯ãå¼å¯ Internet èç½ãéç½®å T4 GPU ç¯å¢ï¼ä»¥åå¦ä½å©ç¨ Kaggle ç¹æç Dataset æºå¶æä¹åä¿å­ HuggingFace æ¨¡åã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="å¤§æ¨¡åå®æ-03é¢å¤-äºç«¯ç¼ä¸¹æ¿-2kaggle-ä¸ææå">[å¤§æ¨¡åå®æ 03é¢å¤] äºç«¯ç¼ä¸¹æ¿ 2ï¼Kaggle ä¸ææå</h1>
<blockquote>
<p><strong>æ ¸å¿æè¦ (TL;DR)</strong></p>
<ul>
<li><strong>çç¹</strong>ï¼Colab åè´¹é¢åº¦èå°½ï¼æèåå¼  T4 æ¾å­ï¼16GBï¼æ æ³æ»¡è¶³æ´å¤§åæ°æ¨¡åçå¾®è°éæ±ã</li>
<li><strong>æ¹æ¡</strong>ï¼å©ç¨ <strong>Kaggle</strong> æä¾ç <strong>æ¯å¨ 30 å°æ¶åè´¹åè·¯ T4 GPU (T4 x2)</strong> ç®åã</li>
<li><strong>æå·§</strong>ï¼éè¿ <strong>ææºå·éªè¯</strong> è§£éèç½æéï¼å©ç¨ <strong>Kaggle Datasets</strong> å®ç°æ¨¡åçæä¹åå­å¨ã</li>
<li><strong>ç®æ </strong>ï¼ä½ä¸º Colab çå¼ºåæ¿è¡¥ï¼çè³ä¸ä½ï¼ï¼æ­å»ºå¤ç¨äºç«¯ç¼ä¸¹ç¯å¢ã</li>
</ul>
</blockquote>
<h2 id="åè¨">åè¨</h2>
<p>ä¸ä¸ç¯ä¸­ï¼æ¬æ¥æ³ç´æ¥åå°Google Colabçå¤§æ¨¡åæ¨çèæ¬ï¼è®©åä½åäººä»¬æåä¸ä¸å¨å¨åæ°7Bæ¨¡åçè½åï¼ä½æ¯æè¾äºå¾ä¹ï¼Colabè¯»driverèæ¯å¤±è´¥ï¼å½ææ³ç´æ¥ä¸è½½å°äºç«¯ä¸»æºèä¸æ¯driverçæ¶åï¼GPUçé¢åº¦å·²ç»èå°½ãç´¢æ§ä»å¤©å¨Kaggleçè¿ç¯åæä¸­æ¥è®²ï¼åºè¯¥ä¹åä¹ä¸»è¦ç¨Kaggleæ¥è¿è¡äºç«¯å¼åï¼æ¯ç«Colabé¢åº¦å°ï¼è¿å¾ç¯çï¼é¿æ¶é´ä¸çä¼æ­æè¿æ¥ã</p>
<p>å¥½ï¼æä»¬æ¥åä»ç»ä¸ä¸ä»å¤©çä¸»è§ï¼Google æä¸çå¦ä¸ä¸ªç¥å¨ï¼<a href="https://www.kaggle.com/" target="_blank" rel="noopener nofollow"><strong>Kaggle</strong></a>ãColabå¦æè¯´å¶æ¬èå°±æ¯æ¨¡åè®­ç»ï¼é£<strong>Kaggle</strong>æ¬èº«å¶å®æ¯ä¸ä¸ªæ°æ®ç§å­¦çç«èµå¹³å°ï¼æ¯ç«æ¯æ°æ®ç§å­¦ç«èµåï¼é£èªç¶å¾éè¦ç®åèµæºï¼<strong>Kaggle</strong>ä¸ºäºæ¹ä¾¿ï¼ä¹åæ¥äºè°·æ­å¤§åäººçä¼è¯åè´¨ï¼åè´¹æä¾äºå¤§æ¹çè®¡ç®èµæºãè·Colabå¯¹æ¯èµ·æ¥ï¼Kaggleçä¼å¿å°±æ¯ï¼æ´ç¨³å®ï¼æ´æ¹ä¾¿ï¼èµæºç»çé¢åº¦æ´å¤ã</p>
<h2 id="1-kaggle-notebooks-æ ¸å¿æ¦å¿µ">1. Kaggle Notebooks æ ¸å¿æ¦å¿µ</h2>
<p>Kaggle çæ ¸å¿ç¼ç¨ç¯å¢å« <strong>Kernels (ç°å¨ç»ç§° Notebooks)</strong>,ä¸ç¨å®³æï¼è¯¶ï¼å®å°±æ¯æä»¬æ¨å¿åè®¤è¯ççäºº<strong>äºç«¯æå¡å¨ç</strong>ç<strong>Jupyter Notebook</strong>,ä½æ¯åColabä¸å¤ªç¸åçæ¯Kaggleçæä»¶ç»æï¼å®ææ¾å¾åºåäºè¾å¥åºåï¼è¾åºåºåï¼æå­åºå, è¿æ¯ä¹æä»¬åä¸æå®¹ææµçå°æ¹:</p>
<ul>
<li><strong>Input (<code>/kaggle/input</code>)</strong>ï¼<strong>åªè¯»åºå</strong>ãè¿éå­æ¾ä½ ä¸ä¼ çæ°æ®éææè½½çæ¨¡åãè¯»åéåº¦æå¿«ï¼ä½æ æ³åå¥ã</li>
<li><strong>Output (<code>/kaggle/working</code>)</strong>ï¼<strong>å¯è¯»ååºå</strong>ãè¿æ¯ä½ çä¸»å·¥ä½åºï¼ä»£ç è¿è¡ç»æãä¸è½½çæ¨¡åå¿é¡»å­å¨è¿éãä½æ³¨æï¼éå¯ Session åï¼è¿éçåå®¹å¦æä¸ä¿å­ä¸º Dataset ä¹ä¼æ¶å¤±ã</li>
<li><strong>Temp (<code>/kaggle/temp</code>)</strong>ï¼<strong>ä¸´æ¶æå­åº</strong>ãç©ºé´è¾å¤§ï¼åªæå½åä¼è¯ææï¼ï¼éåä¸è½½è§£åä¸´æ¶çå¤§æä»¶ã</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/kaggle_input_working_temp.png" alt="Kaggle notebook æä»¶ç³»ç»ç»æå¾ï¼å±ç¤º input/working/temp çåºå«çæªå¾" loading="lazy"></p>
<h2 id="2-å¿«éä¸ææ³¨åä¸è§£é">2. å¿«éä¸æï¼æ³¨åä¸âè§£éâ</h2>
<h3 id="21-æ³¨åä¸å³é®éªè¯-å¿å">2.1 æ³¨åä¸å³é®éªè¯ (å¿å)</h3>
<p>æä»¬æ°ç¨æ·ç»å½åå»ºnotebookåä¼åç°ï¼æä»¬æ²¡æç¡¬ä»¶å éè®¾å¤å¯éã<br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/no_gpu.png" alt="æ°ç¨æ·çacceleratoré¨åæ¯ç°è²çæªå¾" loading="lazy"><br>
æ ¹æ¬åå å°±æ¯å±ä»¬æ²¡æè¿è¡ææºéªè¯ï¼åååï¼å¯ä»¥çè§£ï¼æ¯ç«æ¬èº«kaggleå°±ä¸ç¨ç»å¡ï¼å ä¸ææºéªè¯å¯è½ä¼æç»æä¸å¤§é¨åè®¡ç®èµæºæ»¥ç¨ã</p>
<ol>
<li>è®¿é® <a href="https://www.kaggle.com/" target="_blank" rel="noopener nofollow">Kaggle å®ç½</a> å¹¶æ³¨åè´¦å·ã</li>
<li><strong>å³é®æ­¥éª¤</strong>ï¼ç¹å»å³ä¸è§å¤´å -&gt; <strong>Settings</strong>ã</li>
<li>æ¾å° <strong>Phone Verification</strong>ï¼ææºéªè¯ï¼ã<strong>å¿é¡»å®æè¿ä¸æ­¥</strong>ï¼å¦åæ æ³å¼å¯ GPU å Internetï¼èç½ï¼åè½ã<br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/phone_verification.png" alt="Kaggle è´¦æ·è®¾ç½®é¡µé¢çæªå¾ï¼é«äº® Phone Verification åºå" loading="lazy"></li>
</ol>
<p>è®¤è¯å®æ¯å°±å¯ä»¥ä½¿ç¨GPUèµæºäº<br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/gpu_access.png" alt="å½è®¤è¯äºææºå·ä¹åæ¾ç¤ºacceleratorä¸­æå¯ç¨çGPUèµæºçæªå¾" loading="lazy"><br>
å¦æç»§ç»­åäº<strong>Identity verification</strong>ä¹åï¼å¯ä»¥ä½¿ç¨TPUèµæºï¼ä¸è¿æä»¬ææ¶ç¨ä¸å°ï¼ç®åçGPUèµæºå·²ç»å¤å±ä»¬å¤§ç©ä¸åºäºã</p>
<h3 id="22-åå»ºç¬è®°æ¬">2.2 åå»ºç¬è®°æ¬</h3>
<ol>
<li>ç¹å»å·¦ä¾§èåæ ç <strong>Create</strong> -&gt; <strong>New Notebook</strong>ã</li>
<li>è¿å¥ç¼è¾å¨çé¢ï¼ä½ ä¼åç°çé¢å¸å±æ¯ Colab æ´å ç´§åä¸åè½ååºæç¡®ã<br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/the_whole_UI.png" alt="kaggleçç¼è¾å¨é¡µé¢å¸å±çæªå¾" loading="lazy"></li>
</ol>
<h3 id="23-çé¢å¸å±éè§">2.3 çé¢å¸å±éè§</h3>
<ul>
<li><strong>å·¥ä½åº</strong>ï¼ä½äºå³ä¾§ï¼æ¾ç¤ºäºInput-&gt;æä»¬çæè½½èµæºï¼ä¸ä¼ çæ°æ®éåæ¨¡åç­ç­ï¼Output-&gt;æä»¬è¾åºçç»æèµæºãnotebookåå®¹éè§,ä»¥åä¸é¢çsession optionsç¯å¢å¿«æ·éç½®ç­ç­<br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/workspace.png" alt="ç¼è¾å¨å³ä¾§çå·¥ä½åºï¼åå«Inputåºåoutputåºçæªå¾" loading="lazy"><br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/session_options.png" alt="ç¼è¾å¨å³ä¾§å·¥ä½åºå©ä½é¨åï¼æ¥ç­session optionsçæªå¾" loading="lazy"></li>
<li><strong>å¿«æ·æä½æ </strong>ï¼ å¨ä»£ç åºä¸æ¹ï¼åColabå·®å«ä¸å¤§ï¼å¯ä»¥å¿«éè¿è¡ï¼æå¥ååæ ¼ï¼å¤å¶ç²è´´ç­ç­<br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/quick_action.png" alt="å¨ç¼è¾å¨ä¸æ¹çå¿«æ·æä½æ çæªå¾" loading="lazy"></li>
<li><strong>ä»£ç åº</strong>ï¼åColabä¸æ ·, æ åç Jupyter ååæ ¼ã</li>
</ul>
<p>æ³¨æï¼</p>
<ol>
<li>åColabä¸ä¸æ ·çæ¯ï¼Kaggleçæä»¶åæ²¡æåç¼ï¼ä¸ç¨å ipynbåç¼</li>
<li>å±ä»¬çç¡¬ä»¶å éï¼GPU/TPUè®¡ç®èµæºï¼è¢«æ¾å°äºé¡¶é¨èåæ ç<strong>Settings</strong>ä¸­ç<strong>accelerator</strong>ä¸­äº</li>
<li>åColabä¸åï¼å ä¸ºKaggleæ¯ä¸ºç«èµæå¡ï¼å¾å¤ç«èµæ¯è¦æ±æ¨¡åä¸èç½çï¼æä»¥æä»¬å¨è®­ç»æ¨¡åçæ¶åï¼éè¦æå¨å¼å¯ç½ç»ï¼ä¹å¨é¡¶é¨èåæ ç<strong>Settings</strong>ä¸­ï¼ç¹å»<strong>Turn On Internet</strong>æå¼å³å¯èç½ä¸è½½æ¨¡åæèæ°æ®éã<br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/settings.png" alt="Kaggle NotebookçSettingsä¸æèåï¼åå«ç¡¬ä»¶å éè®¾å¤åå¼å¯èç½éé¡¹çæªå¾" loading="lazy"></li>
<li>å¯é¥ç®¡çè¢«æ¾å°äºé¡¶é¨èåæ ç<strong>Add-ons</strong>ä¸äº<br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/add-on.png" alt="Kaggle NotebookçAdd-onä¸æ¥èåï¼åå«å¯é¥ç®¡çéé¡¹çæªå¾" loading="lazy"></li>
</ol>
<h2 id="3-ç¯å¢éç½®å¼å¯åæ¾å¡ä¸èç½">3. ç¯å¢éç½®ï¼å¼å¯åæ¾å¡ä¸èç½</h2>
<p>Kaggle é»è®¤ç¯å¢æ¯ <strong>CPU</strong> ä¸ <strong>æ­ç½</strong> çãæä»¬éè¦æå¨âè§£é¤å°å°âã</p>
<h3 id="31-å¼å¯èç½-internet-on">3.1 å¼å¯èç½ (Internet On)</h3>
<p>å¯ä»¥æç§åæè¯´çå¨é¡¶é¨èåæ æå¼ï¼ä¹å¯ä»¥å¨å³ä¾§è¾¹æ ç <strong>Session Options</strong> ä¸­ï¼æ¾å° <strong>Internet</strong> éé¡¹ãå°å¼å³æ¨å° <strong>On</strong>ã<br>
<em>æ³¨æï¼å¦ææ²¡æææºéªè¯ï¼æ­¤éé¡¹ä¸ºç°è²ä¸å¯ç¨ã</em></p>
<h3 id="32-å¼å¯-gpu-å é-t4-x2">3.2 å¼å¯ GPU å é (T4 x2)</h3>
<ol>
<li>
<p>å¨å³ä¾§è¾¹æ æ¾å° <strong>Accelerator</strong>ã</p>
</li>
<li>
<p>ä¸æéæ© <strong>GPU T4 x2</strong>ã</p>
<ul>
<li><strong>GPU T4 x2</strong>ï¼ä¸¤å¼ æ¾å¡ï¼çº¦ 30GB æ¾å­ï¼éåå¤§æ¨¡åæ¨çåå¾®è°ã</li>
<li><strong>GPU P100</strong>ï¼åå¼ æ§æ¶æå¡ï¼è½ç¶éåº¦å¿«ä½æ¾å­ä» 16GBï¼éå¸¸ä¸æ¨èã</li>
</ul>
</li>
<li>
<p>å¼å¯åï¼é¡¶é¨ä¼æ¾ç¤º <strong>Session Storage</strong> å <strong>GPU Quota</strong>ï¼æ¯å¨ 30 å°æ¶é¢åº¦ï¼éå¸¸å¨å­å·æ°ï¼ã<br>
ç¹å»èªå·±çå¤´åï¼å¯ä»¥çè§èªå·±çé¢åº¦<strong>GPU Quata</strong><br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/GPU_Quata.png" alt="ç¹å»èªå·±çå¤´åï¼å¯ä»¥çè§èªå·±çé¢åº¦çæªå¾" loading="lazy"></p>
</li>
</ol>
<h3 id="33-éªè¯åå¡ç¯å¢">3.3 éªè¯åå¡ç¯å¢</h3>
<p>è¾å¥å¹¶è¿è¡ä»¥ä¸ä»£ç ï¼ç¡®è®¤æä»¬æ¯å¦ççæ¥æäºä¸¤å¼ æ¾å¡ï¼</p>
<pre><code class="language-python">!nvidia-smi
</code></pre>
<p>ä½ åºå½è½çå° <strong>ä¸¤å¼ </strong> Tesla T4 æ¾å¡çåè¡¨ (GPU 0 å GPU 1)ã<br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/nvidia-smi.png" alt="nvidia-smiçè¿è¡ç»æï¼æ¾ç¤ºä¸¤å¼ Tesla T4å¡" loading="lazy"></p>
<h2 id="4-å®æä¸è½½å¹¶è¿è¡å¤§æ¨¡å">4. å®æï¼ä¸è½½å¹¶è¿è¡å¤§æ¨¡å</h2>
<p>å¨ Kaggle ä¸ä½¿ç¨æ¨¡åä¸»è¦æä¸¤ç§âæµæ´¾âï¼<strong>ä»£ç ä¸è½½æ´¾</strong> å <strong>åçæè½½æ´¾</strong>ã</p>
<h3 id="æ¹å¼ä¸å©ç¨-huggingface-cli-ä¸è½½-å·¥ç¨åæ¨è">æ¹å¼ä¸ï¼å©ç¨ HuggingFace CLI ä¸è½½ (å·¥ç¨åæ¨è)</h3>
<p>è¿ç§æ¹å¼æçµæ´»ï¼éåéè¦ç²¾ç¡®æ§å¶æ¨¡åçæ¬çæåµãç±äº Kaggle æ²¡æ Google Driveï¼æä»¬å°æ¨¡åä¸è½½å° <code>/kaggle/working/</code> ç®å½ã</p>
<p><strong>æ­¥éª¤ 1ï¼å®è£ä¸éç½®</strong></p>
<pre><code class="language-python"># Kaggle é¢è£åºå¾å¤ï¼ä½ transformers çæ¬å¯è½æ»åï¼å»ºè®®æ´æ°
!pip install -U transformers huggingface_hub accelerate bitsandbytes
</code></pre>
<p>ç¹å»é¡¶é¨èå <strong>Add-ons</strong> -&gt; <strong>Secrets</strong>ï¼æ·»å  <code>HF_TOKEN</code>ï¼ä½ ç HuggingFace è®¿é®ä»¤çï¼ã</p>
<p><strong>æ­¥éª¤ 2ï¼ä¸è½½èæ¬</strong></p>
<pre><code class="language-python">import os
from huggingface_hub import login, snapshot_download
from kaggle_secrets import UserSecretsClient

# 1. ç»å½ (èªå¨è¯»å Secrets)
user_secrets = UserSecretsClient()
hf_token = user_secrets.get_secret("HF_TOKEN")
login(token=hf_token)

# 2. å®ä¹ä¸è½½è·¯å¾ (æ³¨æï¼å¿é¡»å¨ /kaggle/working ä¸)
model_dir = "/kaggle/working/model_cache"
os.makedirs(model_dir, exist_ok=True)

# 3. ä¸è½½æ¨¡å
model_id = "Qwen/Qwen2.5-7B-Instruct"
print(f"å¼å§ä¸è½½ {model_id} ...")

# Kaggle å»ºè®®ä¸è½½å®æä»¶ (local_dir_use_symlinks=False)
snapshot_download(
    repo_id=model_id,
    local_dir=model_dir,
    local_dir_use_symlinks=False,
    token=hf_token
)

print("ä¸è½½å®æï¼")
</code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/download_model.png" alt="ä¸è½½å®æçç»ææªå¾" loading="lazy"></p>
<h3 id="æ¹å¼äºadd-input-kaggle-åçæ¹å¼">æ¹å¼äºï¼Add Input (Kaggle åçæ¹å¼)</h3>
<p>è¿æ¯ Kaggle æå¼ºå¤§çåè½ãä½ å¯ä»¥ç´æ¥å¨ç½é¡µç«¯æç´¢ç°æçæ¨¡åï¼åæè½½ U çä¸æ ·æè½½è¿æ¥ï¼<strong>ä¸æ¶èä¸è½½æµéåæ¶é´</strong>ã</p>
<ol>
<li>ç¹å»å³ä¾§è¾¹æ ç <strong>Add Input</strong>ã</li>
<li>éæ© <strong>Models</strong> æ ç­¾é¡µã</li>
<li>æç´¢ <code>Qwen2.5</code>ã</li>
<li>ç¹å» <strong>+</strong> å·æ·»å ã<br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/qwen_downloading.png" alt="Kaggle Add Input æç´¢æ¨¡åçå¼¹çªæªå¾" loading="lazy"></li>
<li>éæ©FRAMEWORKéæ©<strong>Transformers</strong>æ¶æ, VARIATIONéæ©<strong>7b-instruct</strong>, ä¹åçåæä¼è·åä½åäººè§£éè¿äºåæ°çå·®å«<br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/qwen2_5_params.png" alt="ä¸è½½Qwen2.5æ¨¡åéè¦å¡«åçæ¶æååæ°ç¤ºææªå¾" loading="lazy"></li>
<li>æ¨¡åä¼ç´æ¥åºç°å¨ <code>/kaggle/input/</code> ç®å½ä¸ï¼åªè¯»ï¼ï¼è·¯å¾éå¸¸é¿å¾å <code>/kaggle/input/qwen2.5/transformers/7b-instruct/1</code>ã</li>
</ol>
<h2 id="5-å è½½æ¨¡åä¸åå¡æ¨ç">5. å è½½æ¨¡åä¸åå¡æ¨ç</h2>
<p>æ¥æåå¡ T4 åï¼å è½½æ¨¡åæ¶æä¸ä¸ªå³é®åæ°ï¼<code>device_map="auto"</code>ãå®ä¼èªå¨å°æ¨¡åååå°ä¸¤å¼ æ¾å¡ä¸ï¼ä»èè®©æä»¬è½è¿è¡æ´å¤§çæ¨¡åã</p>
<pre><code class="language-python">import torch
from transformers import AutoTokenizer, AutoModelForCausalLM

# è·¯å¾æ ¹æ®ä½ çä¸è½½æ¹å¼è°æ´
# æ¹å¼ä¸è·¯å¾: "/kaggle/working/model_cache"
# æ¹å¼äºè·¯å¾: "/kaggle/input/qwen2.5/transformers/7b-instruct/1/" (å·ä½å¯ä»¥è¿è¡é»è®¤åå»ºçç¬¬ä¸ä¸ªååæ ¼ï¼æ¥çinputç®å½ç»æ,å°è½çè§config.jsonçç®å½å³å¯)
model_path = "/kaggle/working/model_cache"

print("æ­£å¨å è½½æ¨¡å (åå¡æ¨¡å¼)...")

tokenizer = AutoTokenizer.from_pretrained(model_path, trust_remote_code=True)

# å³é®ï¼device_map="auto" ä¼èªå¨å©ç¨ä¸¤å¼  T4
model = AutoModelForCausalLM.from_pretrained(
    model_path,
    device_map="auto",
    torch_dtype=torch.float16,
    trust_remote_code=True
)

print(f"æ¨¡åå è½½æåï¼æ¾å­åå¸: {model.hf_device_map}")

# æµè¯å¯¹è¯
prompt = "ä½ å¥½ï¼è¯·ç¨ä¸å¥è¯å½¢å®¹ Kaggle çå T4 æ¾å¡æå¤é¦ï¼"
messages = [{"role": "user", "content": prompt}]
text = tokenizer.apply_chat_template(messages, tokenize=False, add_generation_prompt=True)
inputs = tokenizer([text], return_tensors="pt").to(model.device)

with torch.no_grad():
    generated_ids = model.generate(**inputs, max_new_tokens=200)

response = tokenizer.batch_decode(generated_ids, skip_special_tokens=True)[0]
print(f"Qwen: {response.split('assistant')[-1].strip()}")
</code></pre>
<h2 id="6-è¿é¶å¦ä½æä¹åä¿å­save-version">6. è¿é¶ï¼å¦ä½æä¹åä¿å­ï¼(Save Version)</h2>
<p>Kaggle æ²¡æ Google Driveï¼é£æä¹ä¿å­ä¸è½½å¥½çæ¨¡åæè®­ç»ç»æå¢ï¼</p>
<p><strong>ç­æ¡ï¼æ Output åæ Datasetã</strong></p>
<ol>
<li>å½ä½ çä»£ç è¿è¡å®æ¯ï¼æ¨¡åä¿å­å¨ <code>/kaggle/working</code> åã</li>
<li>ç¹å»å³ä¸è§ç <strong>Save Version</strong> æé®ã</li>
<li>éæ© <strong>Save &amp; Run All</strong> (éæ°è·ä¸é),å¿é¡»ç­å°ä¸æ¹å¼¹åºçä¿å­ä»»å¡å®æã<br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/job_running_done.png" alt="ä¿å­ä»»å¡å®æçæªå¾" loading="lazy"></li>
<li>ä¿å­æååï¼ä½ å¯ä»¥å»ä¸»é¡µç<strong>Your Work</strong>ç¹å»åæçNotebook,è¿å¥<strong>Output</strong> æ ç­¾é¡µéï¼ç¹å»æå³è¾¹çOutputçä¸ä¸ªç¹ï¼ç¶åç¹å» <strong>New Dataset</strong>ã<br>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-2-online-environment-kaggle/new_data.png" alt="å¨Outputæ ç­¾é¡µçNew Datasetç¤ºæå¾" loading="lazy"></li>
<li>è¿æ ·ï¼æä»¬åæçæ¨¡åå°±åæäºä¸ä¸ªå¯ä»¥å¨å¶ä» Notebook éç´æ¥ <strong>Add Input</strong> çæ°æ®éäºï¼</li>
</ol>
<p><strong>PS:é¤å¼èªè®­ç»çç¹æ®æ¨¡ååä¸äºå¨Inputæ¾ä¸å°çæ¨¡åï¼æå¥½é½ç´æ¥ä½¿ç¨Inputå¯¼å¥æ´ä¸ºå¿«æ·</strong></p>
<h2 id="7-å¸¸è§é®é¢-qa">7. å¸¸è§é®é¢ (Q&amp;A)</h2>
<p><strong>Q: Colab å Kaggle æè¯¥éè°ï¼</strong><br>
<strong>A:</strong></p>
<ul>
<li><strong>Colab</strong>: éåå¿«éå®éªãæè½½ Google Drive æ¹ä¾¿ãä½ T4 åªæä¸å¼ ï¼ä¸æè¿å°å·è¾ä¸¥ã</li>
<li><strong>Kaggle</strong>: éåéè¦å¤§æ¾å­ï¼T4 x2ï¼çä»»å¡ãç¯å¢æ´ç¨³å®ï¼ä¸æ 30 å°æ¶/å¨çæç¡®é¢åº¦ï¼ä¸ç¨æå¿ç¨å°ä¸åè¢«è¸¢ä¸çº¿ã</li>
</ul>
<p><strong>Q: ä¸ºä»ä¹æçä»£ç æ¥é <code>Internet connection is closed</code>ï¼</strong><br>
<strong>A:</strong> è¿æ¯ä¸ä¸ªç»å¸éè¯¯ãè¯·æ£æ¥å³ä¾§è¾¹æ ç <strong>Internet</strong> å¼å³æ¯å¦ä¸º Onãå¦æå¼å³æ¯ç°è²çï¼è¯·æ£æ¥æ¯å¦å®æäºè´¦å·ç <strong>ææºå·éªè¯</strong>ã</p>
<p><strong>Q: <code>/kaggle/working</code> éçæä»¶éå¯åè¿æåï¼</strong><br>
<strong>A:</strong> æ²¡æäºãKaggle ç Session ä¹æ¯ä¸´æ¶çãå¦æéè¦æä¹åï¼è¯·å¡å¿ä½¿ç¨ <strong>Save Version</strong> åè½å°å¶ä¿å­ä¸º Datasetï¼æèå¨ä»£ç æåå ä¸æ®µä¸ä¼ å° HuggingFace Hub çä»£ç ã</p>
<hr>
<p><strong>æ¬æä½èï¼</strong> Algieba<br>
<strong>æ¬æé¾æ¥ï¼</strong> <a href="https://blog.algieba12.cn/llm02-2-online-environment-kaggle/" target="_blank" rel="noopener nofollow">https://blog.algieba12.cn/llm02-2-online-environment-kaggle/</a><br>
<strong>çæå£°æï¼</strong> æ¬åå®¢æææç« é¤ç¹å«å£°æå¤ï¼åéç¨ BY-NC-SA è®¸å¯åè®®ãè½¬è½½è¯·æ³¨æåºå¤ï¼</p>
<pre><code>
</code></pre>


</div>
<div class="clear"></div>

		</div>
		<div class="itemdesc">
			åè¡¨äº 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-04 19:54">2026-02-04 19:53</span>&nbsp;
<a href="https://www.cnblogs.com/algieba">é¿å°çä»£ç å±</a>&nbsp;
éè¯»(<span id="post_view_count">7</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19576331);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19576331', targetLink: 'https://www.cnblogs.com/algieba/p/19576331', title: '[å¤§æ¨¡åå®æ 03é¢å¤] äºç«¯ç¼ä¸¹æ¿ 2ï¼Kaggle ä¸ææå' })">ä¸¾æ¥</a>

		</div>
	 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ V8å¼æ ç²¾åæ¼«æ¸¸æå--Ignitionç¯(ä¸) æä»¤ æ å¸§ æ§½ä½ è°ç¨çº¦å® åå­å¸å± åºç¡åå®¹ ]]></title>
    <link>https://www.cnblogs.com/f20171110/p/19576264</link>
    <guid>8dae7275559ff858e0e2a36c397f609a</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/f20171110/p/19576264" title="åå¸äº 2026-02-04 19:19">
    <span role="heading" aria-level="2">V8å¼æ ç²¾åæ¼«æ¸¸æå--Ignitionç¯(ä¸) æä»¤ æ å¸§ æ§½ä½ è°ç¨çº¦å® åå­å¸å± åºç¡åå®¹</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        è¿æ¯ç¬¬äºç¯çä¸åé¨åï¼æä»¬ä¸»è¦å­¦ä¹ ignition V8çè§£éå¨çä¸äºåºç¡ååç½®ç¥è¯ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="äº-ignitionè§£éå¨ä¸">äº. Ignitionè§£éå¨(ä¸)</h1>
<p>è¿æ¯ç¬¬äºç¯çä¸åé¨åï¼æä»¬ä¸»è¦å­¦ä¹ ignition V8çè§£éå¨çä¸äºåºç¡ååç½®ç¥è¯ã</p>
<p>è¿é¨ååå®¹ï¼ä¸»è¦æ¯ä»¥äºè§£ä¸ºä¸»ï¼æä»¥å¨å­¦ä¹ çæ¶åï¼é¤äºç¬¬ä¸ç¯ä¸­è¯´ç æäºç»èåäºçç¥  æäºè¾¹çæåµåäºç®åè¡¨è¿°ä»¥å¤ï¼ä¹ä¸éè¦è¿å¤çæ·±å¥ã è¯»å®äºå°±å¥½ã ç®çå°±æ¯å¯¹äºignitionè§£éå¨çä¸ä¸ªç¥é­ã</p>
<p>å½ç¶ï¼æå´è¶£çæåä¹å¯ä»¥è®¤çéè¯»ï¼æ¬æåå®¹ä¾æ§ä¿æä¸å®çæ·±åº¦ï¼ä¾æ§æ¯åæ±é«åç¡®æ§ï¼ç¬¦åè§èï¼è´´åå®ç°ã ä½éæ³¨æçæ¯ï¼ä¸ºäºæç« çå¯è¯»æ§ï¼æå¯è½<strong>å¨åé¢</strong>ä»åç®åçéä¿çæè¿°ï¼<strong>å¨åé¢</strong>åäºè¯¦ç»çè®²è§£æè¿°ï¼æä»¥ï¼å¯è½çæåµä¸ï¼è¯·å°½ééè¯»å¨æã</p>
<p>éè¿ä¸ä¸ç¯çè§£æï¼æä»¬æéå·²ç»æ¿å°äºä¸ä»½å®æ´çASTæ½è±¡è¯­æ³æ ã ä½æ¯å¯¹äºcpuæ¥è¯´ï¼å®åªè®¤æä»¤ã</p>
<p>å¨æ©æçæ¬ç V8 ä¸­ï¼JavaScript ä»£ç å¨è§£æå®æåï¼ä¼ç´æ¥è¢«ç¼è¯ææ¬æºæºå¨ç æ§è¡ãè¿ç§æ¹å¼è¿è¡å¾å¾å¿«ï¼ä½æºå¨ç ä½ç§¯éå¸¸æ¯è¾å¤§ï¼ä¹ä¸å¤çµæ´»ã</p>
<p>å¨åæ¥ï¼ç´å°ç°å¨ï¼V8ä¸åç´æ¥çæåºå¤§å¤æçæºå¨ç ï¼èæ¯çæäºä¸ç§éå¸¸ç´§å å°å·§çä¸­é´ä»£ç ï¼å°±æ¯ å­èç  bytecodeã</p>
<p>ä½æ¯cpuä¹ä¸è®¤è¯å­èç ï¼V8ä½¿ç¨ ignition æ¨¡æäºä¸ä¸ªå¯ä»¥è¿è¡å­èç çç¯å¢ï¼ç¸å½äºä¸ä¸ªæå¶è½»éçèææºã</p>
<h2 id="1--ignitionæ¯ä»ä¹">1 . ignitionæ¯ä»ä¹</h2>
<p>Ignition æ¯ V8 å¼æéç<strong>å­èç è§£éå¨</strong>ï¼å®æ JavaScript ç AST ç¼æç´§åçå­èç ï¼ç¶åå¨èææºéè§£éæ§è¡ï¼åæ¶æ¶éåç§ä¿¡æ¯ï¼ä¾ä¼åå¨çææ´å¿«çæºå¨ç ã</p>
<p>ignitionçå·¥ä½  æä¸»è¦æ¯ä¸é¢ä¸ä¸ªï¼</p>
<p><strong>ç¿»è¯</strong>ï¼æ AST ç¿»è¯æå­èç ã</p>
<p><strong>æ§è¡</strong>ï¼å¨ä¸ä¸ªèæçå¯å­å¨æºéæ§è¡è¿äºå­èç ã</p>
<p><strong>æ¶éææ¥</strong>ï¼å¨æ§è¡è¿ç¨ä¸­ï¼å·å·è®°å½ç±»åä¿¡æ¯ï¼ä¸ºåç»­çä¼åååå¤ã</p>
<p>Ignition å¨è½¯ä»¶å±é¢æ¨¡æäºä¸å¥  <strong>ç±» CPU</strong> çå·¥ä½æ¨¡å¼ï¼<br>
å®ä¸æ¯åªç¨æ ï¼ä¹ä¸æ¯çº¯å¯å­å¨æºï¼èæ¯éç¨â<strong>èæå¯å­å¨ + ç´¯å å¨ï¼Accumulatorï¼</strong>âçæ¨¡å¼ã</p>
<p>è¿éçå¯å­å¨å¹¶ä¸æ¯ CPU éçç¡¬ä»¶å¯å­å¨ï¼èæ¯å½æ°æ å¸§éçä¸äºæ§½ä½ï¼slotsï¼ï¼åªæ¯æå®æ½è±¡æå¯å­å¨æ¥ä½¿ç¨ï¼çèµ·æ¥æ´å CPU å·¥ä½æ¹å¼ï¼ä½ææ¬éå¸¸ä½ã</p>
<p>Ignition è¿è®¾è®¡äºä¸ä¸ª<strong>è§£éå¨ç¬å çç´¯å å¨ acc</strong>ãå¤§å¤æ°è¿ç®çä¸­é´ç»æé½ä¼ä¸´æ¶å­æ¾å¨ acc éï¼è¿æ ·æä»¤åªéè¦æºå¸¦ä¸ä¸ªåæ°ï¼å°±ä¸ç¨å¨é¨ååºææçç®çå¯å­å¨ï¼å­èç å°±ä¼åå¾éå¸¸ç­å°ã</p>
<p>å½ä¸ä¸ªå½æ°å¼å§æ§è¡æ¶ï¼Ignition ä¼å¨åå­ç æ  (Stack) ä¸ååºä¸åå°çï¼ è·èµ·æ¥çæ¶åï¼æ¬è´¨ä¸å°±æ¯å¨é£åæ åå­ä¸ï¼ä¸åå°ææ°æ®ä»ä¸ä¸ªä½ç½®æ¬å°å¦ä¸ä¸ªä½ç½®ï¼è®¡ç®ï¼ç¶ååæ¬åå¦ä¸ä¸ªä½ç½®ï¼å°±æ¯è¿æ ·æ¬æ¥æ¬å»ãignitionæä½çå¹¶ä¸æ¯çæ­£çcpuåçå¯å­å¨ï¼å®æä½çæ¯åå­ä½ç½®/æ§½ä½ã</p>
<h2 id="2--å ä¸ªç®åçæä»¤">2 . å ä¸ªç®åçæä»¤</h2>
<p>ignitionå°±åä¸ä¸ªå¤å³å¹²æ´»çèå¸åï¼ä»æä¸ä¸ªéèº«è°åï¼ä»ä¸ç®¡å¹²ä»ä¹æ´»ï¼ä¸ç®¡éè¦ç¨ä»ä¹å·¥å·ï¼é½æ¯ä¼åç¨éèº«è°åéçä¸è¥¿ï¼ å¹²å®æ´»å¾å°çç»æï¼ä¹é¡ºæå¡åèªå·±çéèº«è°åéã</p>
<p><strong>èå¸åæä¸ªéèº«è°åï¼ ä¸ç®¡å¹²ä»ä¹ï¼é½ä¼åä½¿ç¨éèº«è°åã</strong></p>
<p><strong>ææ¾åç§ææçåææ¶ï¼ä¸æ ¼ä¸æ ¼çï¼ r0 ï¼r1ï¼r2.ãããç¼çå·ï¼ä¸é¢ææ»¡äºåææã</strong></p>
<p>å¥½äºï¼è¿å°±æ¯ignitionçæ¶æãå°±æ¯è¿ä¹ç®åã</p>
<p>è¿ä¸ªéèº«è°åï¼å°±æ¯èå¸åæéè¦çä¸è¥¿äºãå¸åå·æå¨é å®äºã</p>
<p>åå¦æ²¡æè¿ä¸ªéèº«åï¼æ³è±¡ä¸ä¸ï¼èæ¿ä¸è¾¾æä»¤éå¸¸å°å¦éº»ç¦ï¼</p>
<p>æ r1åææ¶ çä¸è¥¿ å r2åææ¶ çä¸è¥¿æ¿ä¸æ¥ï¼æ¼è£å¥½ï¼ç¶ååæ¾å r3åææ¶ å»</p>
<p>(ç±»ä¼¼äºæä»¤ï¼ADD r1, r2, r3)</p>
<p>â     èèå¸åæäºéèº«åï¼å°±ç®åäºï¼èæ¿åªéè¦åä¸å£°ï¼</p>
<p>âå»æ r2 åææ¶çä¸è¥¿æ¼è¿æ¥ï¼â</p>
<p>(æä»¤ï¼Add r2)</p>
<p>èæ¿å®å¨ä¸éè¦åºè¯âè·è°æ¼âï¼é»è®¤è·åéçä¸è¥¿æ¼ï¼ï¼ä¹ä¸éè¦åºè¯âæ¼å®æ¾åªâï¼é»è®¤æ¼å®è¿æ¾å¨åéï¼ã</p>
<p>è¿å°±æ¯ Ignition çæ ¸å¿èçç§ç±ãéè¿å¼ºè¡è§å®âéèº«åä¼åâï¼æ¯ä¸æ¡æä»¤é½è½çæå¥½å ä¸ªåæ°çä½ç½®ãæåä¸ä¸è¡ä»£ç è·ä¸æ¥ï¼çä¸çåå­å°±æ¯ä¸ä¸ªå¤©ææ°å­ã</p>
<p>è¿ä¸ªèå¸åç<strong>éèº«å å°±æ¯ç´¯å å¨</strong>ï¼åææ¶ å°±æ¯åå­ä½ç½®/æ§½ä½</p>
<ul>
<li>
<p><code>Lda</code> (Load Accumulator) ---Lda æ¯ä¸ªåç¼ï¼å®éä½¿ç¨æ¶ï¼åé¢å¯è·å¾å¤åæ³çæ°æ®æ¥æºï¼æ¯å¦ LdaSmi<code>ã</code>LdaConstant<code>ã</code>LdaUndefinedãLdar ç­ç­ããã</p>
<p>è¿æ¯ä½¿ç¨æé«é¢çæä»¤ï¼å ä¸ºææçæ´» é½å¾å¨éèº«åéå¹²ï¼æä»¥ç¬¬ä¸æ­¥ï¼åºæ¬ä¸é½æ¯æä¸è¥¿è£è¿åéã</p>
<ul>
<li><strong>æä»¤</strong>ï¼<code>Ldar r1</code> (Load Accumulator from Register r1)</li>
<li><strong>å¨ä½</strong>ï¼èå¸åèµ°å° r1 åææ¶ï¼æé£éçæææ¿ä¸æ¥ï¼<strong>å¡è¿éèº«åé</strong>ã</li>
<li><strong>ç¶æ</strong>ï¼æ­¤æ¶ï¼éèº«åéçä¸è¥¿ = r1 çä¸è¥¿ã</li>
<li>Ldar è¿ä¸ªæä»¤  å¾å¥½è®°å¿ï¼ldæ¯è£è½½ï¼aæ¯ç´¯å å¨ï¼ræ¯å¯å­å¨ï¼ldarå°±æ¯è£è½½ç´¯å å¨fromå¯å­å¨ï¼  <strong>æå¯å­å¨çåå®¹è£è¿ç´¯å å¨</strong>ã</li>
<li>Ldar r1  å°±æ¯æå¯å­å¨r1éçä¸è¥¿ è£è¿ç´¯å å¨ã</li>
<li>èå¸åær1çåæè£è¿éèº«åéã</li>
</ul>
</li>
<li>
<p><code>Star</code> (Store Accumulator)</p>
<p>æ´»å¹²å®äºï¼ç»ææ»ä¸è½ä¸ç´çå¨åéï¼å¾è¾åºå°æ¹å¹²ä¸ä¸ç¥¨ï¼æèæç»æå­èµ·æ¥ã</p>
<ul>
<li><strong>æä»¤</strong>ï¼<code>Star r2</code> (Store Accumulator to Register r2)</li>
<li><strong>å¨ä½</strong>ï¼èå¸åæ<strong>éèº«åé</strong>ååå å·¥å¥½çæåæåºæ¥ï¼æ¾å° r2 åææ¶ä¸å»ã</li>
<li><strong>ç¶æ</strong>ï¼æ­¤æ¶ï¼r2 åææ¶çä¸è¥¿ = éèº«åéçä¸è¥¿ã</li>
<li>star è¿ä¸ªæä»¤ï¼ä¹å¾å¥½è®°å¿ï¼stæ¯å¨å­ï¼aæ¯ç´¯å å¨ï¼ræ¯å¯å­å¨ï¼starå°±æ¯å­å¨ç´¯å å¨éçä¸è¥¿å°å¯å­å¨ã</li>
</ul>
</li>
<li>
<p><code>Add</code> / <code>Sub</code> ...</p>
<p>è¿æ¯çæ­£çå³é®æ­¥éª¤ã</p>
<ul>
<li><strong>æä»¤</strong>ï¼<code>Add r0</code></li>
<li><strong>å¨ä½</strong>ï¼èå¸åèµ°å° r0 åææ¶ï¼æ¿ä¸ªä¸è¥¿ï¼ç´æ¥è·<strong>éèº«åé</strong>åæ¬çä¸è¥¿è¿è¡åä½ï¼ç¸å ï¼ã</li>
<li><strong>ç¶æ</strong>ï¼éèº«åéçä¸è¥¿ = ååéçå¼ + r0 çå¼ã</li>
<li><strong>éç¹</strong>ï¼æ³¨æ <strong>ç»æä¾ç¶çå¨åé</strong>ï¼èå¸åå¹¶æ²¡ææ¥çå»å¨å­ç»æã</li>
</ul>
<p>æä»¤é½å¾ç®åï¼<strong>ld</strong>  <em>load</em>ï¼<strong>st</strong>  <em>store</em>ï¼<strong>a</strong>  <em>accumulator</em>ï¼<strong>r</strong>  <em>register</em></p>
<p>ç±»ä¼¼ç  ldglobal  stglobal ldarg0  ldcurrentcontext  ä¹é½å·®ä¸å¤ï¼</p>
<p>åºæ¬ä¸é½æ¯  å¨ä½+å¯¹è±¡  çæ¨¡å¼ã</p>
<p>å¦å¤éè¦æ³¨æçæ¯ï¼ç´¯å å¨ Accumulator éå¸¸ä¼åä½ accãè½ç¶å®å«âç´¯å å¨âï¼ä½åä¸ä¸è¦çè§£æå®åªè½åå æ³è¿ç®ã<strong>ä»æ¬è´¨ä¸è®²ï¼acc å°±æ¯è§£éå¨éå¯ä¸çâéç¨ä¸´æ¶å¯å­å¨â</strong>ï¼å½åè¿æ¡å­èç è¦å¤ççå¼ï¼æèè¿ç®åçä¸­é´ç»æï¼å ä¹é½ä¼ææ¶æ¾å¨è¿éã</p>
<p>acc éå¯ä»¥è£ä»»ä½ JavaScript çå¼ï¼æ¯å¦å¸¸éãå°æ´æ°ãå­ç¬¦ä¸²ãå¯¹è±¡å¼ç¨ã<code>undefined</code> ç­ãä¹æä»¥è¦è®¾è®¡è¿ä¹ä¸ä¸ªâç»ä¸çä¸´æ¶ä½ç½®âï¼å°±æ¯ä¸ºäºè®©å¤§å¤æ°å­èç åªéè¦åæâå¦ä¸ä¸ªåä¸è¿ç®çå¯¹è±¡æ¯è°âï¼èä¸ç¨æ¯æ¬¡é½é¢å¤å£°æå¤ä¸ªå¯å­å¨åæ°ï¼ä»è<strong>è®©å­èç æ´ç­ãæ´è§æ´ï¼ä¹è®©è§£éå¨å®ç°æ´ç®å</strong>ã</p>
</li>
</ul>
<pre><code>  Ldar r1   ; acc = r1
  Add r0    ; acc = acc + r0
  Star r2   ; r2 = acc
  
  ç´¯å å¨accçååã    æ¯ä¸æ¯éå¸¸ç®åã
</code></pre>
<h2 id="3--æ å¸§åæ§½ä½">3 . æ å¸§åæ§½ä½</h2>
<p>å¨ç¬¬ä¸é¨åè§£æç¯é  æä»¬ä¹æå°è¿ æ§½ä½ è¿ä¸ªæ¯è¯­ï¼ ä¸é¢åæå°äºï¼é£ä¹ï¼æ§½ä½å°åºæ¯ä»ä¹å¢ï¼</p>
<p><strong>æ§½ä½ï¼slotï¼å°±æ¯æ å¸§éä¸æ ¼ä¸æ ¼åºå®å¤§å°çâå­å¨ååâæâæ ¼å­âï¼ç¨äºæç´¢å¼å­æ¾å½æ°çåæ°ãå±é¨åéãä¸´æ¶å¼ãä»¥åå¶å®åæ°æ®ã</strong> å®ä¸ä»æ¯âä½ç½®âï¼è¿éå«äºå¤§å°ãç±»åï¼éå¸¸æ¯æé/Tagged å¼ï¼ãå°åè®¡ç®è§ååçå½å¨æè¯­ä¹ã</p>
<p>åå­å¯å¯»åçæå°åä½æ¯ 8bit å³ä¸å­èï¼ è½ç¶æå°ä½¿ç¨åä½æ¯8bit å³ä¸å­èãä½æ¯ï¼å ä¸ºéè¦å­èå¯¹é½ å æºå¨æéå¤§å°çè¦æ±ï¼æä»¥ å¨32ä½ç³»ç»ä¸ï¼  éè¦4å­èè¡¨ç¤ºæéï¼ 64ä½ç³»ç»ä¸  éè¦8å­èè¡¨ç¤ºæéã æ¯ä¸ªæ§½ä½çå¤§å°ï¼ä¹æ¯æç§æä½ç³»ç»æºå¨æéçå¤§å°æ¥ååçã å³   64ä½ç³»ç»ï¼ä¸ä¸ªæ§½ä½  å  8ä¸ªå­è ã åªæè¿æ ·ï¼<strong>64ä½ç³»ç»</strong>ä½¿ç¨æéå¯»åæ¶ï¼8å­èï¼å³64bitï¼æè½å¤è£å¾ä¸ä¸ä¸ªæéã</p>
<p>æä»¥ï¼æ¯ä¸ªæ§½ä½ï¼slotï¼å  8ä¸ªå­èå¤§å°ã</p>
<p>å½å½æ°å¼å§æ§è¡æ¶ï¼è¿è¡æ¶runtimeå¨æ ä¸ä¸ºå®åéä¸æ®µè¿ç»­åå­ä½ä¸º<strong>æ å¸§</strong>ãå¨ Ignition ä¸­ï¼æ å¸§å¤§è´åä¸ºä¸é¨åï¼<strong>åæ°åº</strong>ã<strong>åºå®å¤´é¨</strong>ï¼  <strong>å·¥ä½åº</strong> ãæ å¸§éçæ¯ä¸ªâæ ¼å­âç§°ä¸º<strong>æ§½ä½ï¼slotï¼</strong>ï¼æç´¢å¼å­æ¾å±é¨åéåä¸´æ¶å¼ï¼æ§½ä½çå¤§å°éå¸¸ç­äºæºå¨æéå¤§å°ï¼ <strong>64 ä½</strong>ä¸ä¸º 8 å­èã</p>
<p><strong>ç¹å«æ³¨æ</strong>ï¼åé¢æä»¬ä¸è¬å¹¶æ²¡ææç¡®çåºåæ å¸§éæ§½ä½åå­æ®µï¼ç°å¨æç¡®ä¸ä¸ï¼æä»¬<strong>ä»ä»æ¯æå·¥ä½åºä¸­</strong>æç´¢å¼çæ ¼å­ï¼<code>r0, r1, r2â¦</code>ï¼ç§°ä¸º<strong>æ§½ä½ï¼frame slotsï¼</strong>ãåºå®å¤´é¨éçå­æ®µï¼è¿åå°åãsaved FPãContextãBytecodeArray ç­ï¼æä»¬<strong>ä¸</strong>æå®ä»¬ç§°ä¸ºæ§½ä½ï¼åæ°ä¸è¬ç§°ä¸º argument slotsï¼<code>a0,a1</code>ï¼æåç¬æè¿°ã</p>
<p>ä¸¥æ ¼ä» V8 åå­è§è§æ¥çï¼æ å¸§ä¸­çæ¯ä¸ä¸ª 8 å­èå­å¨ååï¼æ è®ºæ¯ Contextãè¿åå°åè¿æ¯å±é¨åéï¼å¨æºç ä¸­é½ç»ç§°ä¸º <strong>Slot</strong>ã</p>
<p>ä½å¨è§£éå¨å­èç çè¯­å¥ç¯å¢ä¸­ï¼ä¸ºäº<strong>åºååè½</strong>ï¼</p>
<ul>
<li>æä»¬å°åºå®ä½ç½®ãç¨éåä¸çåºåç§°ä¸º <strong>âåºå®å¤´é¨å­æ®µâ</strong>ï¼å¦ Function, Contextï¼ã</li>
<li>æä»¬å°ç¨äºå­å¨å±é¨åéåä¸´æ¶ç»æãéè¿ç´¢å¼å¨æè®¿é®çåºåç¹ç§°ä¸º <strong>âå¯å­å¨æ§½ä½â</strong> æ <strong>âå±é¨åéæ§½ä½â</strong> æç®ç§°ä¸º <strong>æ§½ä½</strong> ã</li>
<li><strong>ææ¶åå¯è½ä¼ææ··ç¨ï¼å°æ ä¸æå­æ®µä¹ç§°ä¸ºæ§½ä½ï¼ä»è§èä»v8æºç ä¸æ¥è¯´ï¼å®å¨æ²¡æéè¯¯ï¼åªæ¯å ä¸ºæææèåå¿«äºï¼æ²¡ææç§æä»¬éå¸¸çæåè½åºåççº¦å®ç§°å¼ã</strong></li>
<li>å½ç¶ï¼ä½ å¯ä»¥æç§èªå·±çææ¿ï¼åºåæèä¸åºåï¼<strong>é½æ¯æ­£ç¡®ç</strong>ãåææ¯  ä½ è¦ç¥éè§å¯çè§è§çä¸åã</li>
</ul>
<p>ä¸é¢æä»¬è¯¦ç»ä»ç»ä¸ä¸æ å¸§çç»æã</p>
<p>æ ççé¿é¡ºåºï¼æ¯<strong>ä»é«å°åå°ä½å°å</strong>ï¼å³å¥æ æ©çå¨é«å°åï¼ æåå¥æ çå¤äºæ é¡¶ å¨ä½å°åã</p>
<p>æä»¬é¦åä»ç»ä¸ªæ¯è¯­ï¼Tagged Pointer</p>
<blockquote>
<h4 id="tagged-pointer--æ ç­¾æé">Tagged Pointer  æ ç­¾æé</h4>
<p>64ä½ç³»ç»ä¸­ï¼æ¯ä¸ªæ§½ä½é½æ¯ 8 å­èï¼64 ä½ï¼ï¼V8 å¨è¿éé¢å­æ°æ®æ¶ï¼ä½¿ç¨äºä¸ä¸ªç¼ç æå·§ï¼å«å <strong>Tagged Pointer (å¸¦æ ç­¾çæé)</strong>ã</p>
<p>å¨éæè¯­è¨ç«ï¼æ¯å¦ C++ è¿ç§éæè¯­è¨ï¼ç¼è¯å¨ç¥éåéæ¯ <code>int</code> è¿æ¯ <code>Object*</code>ãä½å¨ JavaScript ä¸­ï¼ç±»åæ¯å¨æçãå¦æ V8 ä¸ºæ¯ä¸ªåéé¢å¤å­ä¸ä¸ªâç±»åå­æ®µâï¼åå­æ¶èä¼ç¿»åã V8 çåæ³æ¯ï¼<strong>æç±»åä¿¡æ¯ç´æ¥ç¼ç è¿è¿ 64 ä½æ°æ®æ¬èº«ã</strong></p>
<p><strong>æ¹æ³å°±æ¯å¤ç¨âå¯¹é½çä¸çä½ä½â</strong> å¨ 64 ä½å¹³å°ä¸ï¼åå­å°åéå¸¸æ¯ <strong>8 å­èå¯¹é½</strong> çãåæ³å°åçäºè¿å¶å½¢å¼ï¼<strong>æä½çå ä½éå¸¸é½æ¯ 0</strong>ã V8 å°±æ¯ä½¿ç¨äºè¿äºé²ç½®çä½ä½ï¼ç¨æ¥æä¸ç±»åæ ç­¾Tagã</p>
<p><strong>Tagged Value çåç±»ï¼</strong> V8 ææ§½ä½éçæºå¨å­ç»ç§°ä¸º <strong>Tagged Value</strong>ï¼æ ¹æ®ä½ä½æ ç­¾ä¸åï¼åä¸ºä¸¤ç±»ï¼</p>
<p><strong>Smi (Small Integerï¼æ ç­¾ç«å³é)</strong></p>
<ul>
<li><strong>ç¹å¾</strong>ï¼æä½ä½éå¸¸ä¸º <code>0</code>ã</li>
<li><strong>å«ä¹</strong>ï¼è¿ <strong>ä¸æ¯</strong> æéï¼è¿ 64 ä½æ°æ®æ¬èº«å°±å­çä¸ä¸ªæ´æ°ã</li>
<li><strong>ä¼å¿</strong>ï¼æ´æ°ç´æ¥ä½å¨æ ä¸ï¼ä¸éè¦å»å éç³è¯·åå­ï¼éåº¦æå¿«ã</li>
<li><strong>è¿å</strong>ï¼ä½¿ç¨æ¶ï¼éè¿<strong>å³ç§» (Shift)</strong> è¿ç®å»ææ ç­¾ï¼å°±è½å¾å°æ´æ°å¼ã</li>
</ul>
<p><strong>Tagged Pointer (å å¯¹è±¡å¼ç¨)</strong></p>
<ul>
<li><strong>ç¹å¾</strong>ï¼æä½ä½éå¸¸ä¸º <code>1</code>ã</li>
<li><strong>å«ä¹</strong>ï¼è¿æ¯ä¸ä¸ªæåå åå­ä¸­å¯¹è±¡ï¼HeapObjectï¼ç <strong>å¼ºå¼ç¨</strong>ã</li>
<li><strong>æ³¨æ</strong>ï¼å®ä¸è½ç´æ¥å½åç©çå°åç¨ã</li>
<li><strong>è¿å</strong>ï¼ä½¿ç¨æ¶ï¼å¿é¡»éè¿<strong>ä½æ©ç  (Mask)</strong> è¿ç®å»ææ ç­¾ï¼Untagï¼ï¼è¿åæçº¯åçåå­å°åï¼æè½å»è®¿é®å éçå¯¹è±¡ã</li>
</ul>
<p>è¿æ ·ä½¿ç¨Tagä»¥åï¼ Tagged value å°±åç»æ°æ®ç©¿äºä¸ä»¶âé©¬ç²âãIgnition çä¸ç¼é©¬ç²ï¼æ ç­¾ä½ï¼ï¼å°±ç¥éæ¯æ´æ°è¿æ¯å¯¹è±¡ãè½ç¶ä½¿ç¨åå¿é¡»âè±é©¬ç²âï¼Untagï¼ï¼ä½è¿å¸¦æ¥çæ§è½æåååå­èçæ¯å·¨å¤§çã</p>
<p>å¦å¤éè¦æ³¨æï¼ä½¿ç¨tagæ è®°ï¼  è½ç´æ¥å¤å®çç±»åéåå¾å°ï¼ä¸»è¦æ¯ Smi æHeapObjectï¼ï¼æ´ç»çç±»åï¼éè¦è¯»åå¯¹è±¡å¤´æ¥è·åã</p>
</blockquote>
<p>é£ä¹ ï¼æ å¸§çç»ææ¯ææ ·çå¢ï¼å®çç»æå¦ä¸ï¼</p>
<ul>
<li>
<p>ç¬¬ä¸å±  åæ°åº Arguments</p>
<p>å½è°ç¨ä¸ä¸ªå½æ°æ¶ï¼è°ç¨èCalleréè¦ç»å®ä¼ å®åï¼åæ¶è¿æä¸ªéå½¢åæ°thisï¼è¿äºåå®¹ï¼é½å¨æ å¸§çç¬¬ä¸å±åæ°åºã</p>
<ul>
<li><strong>Receiver (this)</strong>ï¼
<ul>
<li>è¿æ¯ä¸ªéå½¢åæ°ãå½ä½ å <code>obj.func()</code> æ¶ï¼<code>obj</code> å°±æ¯ Receiverãå®æ¯åæ°åè¡¨éçéå½¢èå¤§å¥ã</li>
</ul>
</li>
<li><strong>Arguments (<code>a0</code>, <code>a1</code>...)</strong>ï¼
<ul>
<li>è¿å°±æ¯ <code>function foo(x, y)</code> éç <code>x</code> å <code>y</code>ã</li>
<li>Ignition ç»å®ä»¬ç¼çå·æ¯ <code>a0</code>, <code>a1</code>...</li>
<li>è¦æ³¨æçæ¯ï¼è¿éç <code>a</code> ä»£è¡¨ Argumentï¼ä¸è¦å Accumulator ææ··äºã</li>
</ul>
</li>
</ul>
</li>
<li>
<p>ç¬¬äºå±  åºå®å¤´é¨  Fixed header / fixed frame part</p>
<p>è¿æ¯æ´ä¸ªæ å¸§ä¸­æéè¦ãæå³é®çåºåã</p>
<p>æ¢ç¶ Ignition æ¯ä¸ªè½¯ä»¶æ¨¡æç CPUï¼é£ CPU è¿è¡æ¶éè¦çé£äºç¶æ  æ¯å¦âæç°å¨è¿è¡å°åªä¸è¡äºï¼âãâæçç¯å¢æ¯è°ï¼â  ãããç­ç­ä¿¡æ¯ï¼ é½æ¯å­å¨åªçï¼</p>
<p>æ²¡éï¼å°±å­å¨è¿å¿ï¼åºå®å¤´é¨ã</p>
<p>æ¯ä¸ªå½æ°æ å¸§çä¸­é´ï¼é½å¤¹çè¿ä¹ä¸åé·æä¸å¨çåºåï¼ä¿å­çç»´æèææºè¿è¡ç<strong>åæ°æ®</strong></p>
<p>å®éé¢çä¸»è¦åå®¹ï¼</p>
<ol>
<li>
<p><strong>Return Address (è¿åå°å)</strong>ï¼</p>
<ul>
<li><em>ä½ç¨</em>ï¼ç­è¿ä¸ªå½æ°æ§è¡å®ï¼åºå±è°ç¨æ å°±ä¼æ ¹æ®è¿ä¸ªè¿åå°åï¼è·³åè°ç¨å¤ç»§ç»­æ§è¡ã</li>
<li>è¿éè°æ³¨æï¼è¿åå°åï¼ æ¯æ§å¶æµï¼æ¯è¿åçåºè¯¥å°ä»£ç çåªä¸ªä½ç½®å»ç»§ç»­æ§è¡ã</li>
</ul>
</li>
<li>
<p><strong>Caller's Frame Pointer (ä¸ä¸å±æ å¸§æé)</strong>ï¼</p>
<ul>
<li>
<p><em>ä½ç¨</em>ï¼é¾è¡¨æéãå½åå½æ°æ§è¡å®ãè°ç¨èçæ å¸§å¨åªéï¼</p>
</li>
<li>
<p>è¿æ ·ä¾æ§è¦æ³¨æï¼è¿ä¸ªæéï¼æçæ¯æ°æ®ï¼ä¸ä¸ªå­æ®µè¿åå°åï¼æ¯æ§å¶æµçè¿åï¼è¿é</p>
</li>
<li>
<p>çä¸å±æ å¸§æéï¼æ¯æ§å¶æµè¿åä»¥åï¼ç»§ç»­æ§è¡ï¼ åºè¯¥ä»åªéå»æ¾åéï¼è¿åçæ¯é£ä¸ª</p>
</li>
<li>
<p>æ å¸§ï¼å¯ä»¥çè§£ä¸ºæ°æ®ã</p>
</li>
<li>
<p>å¨çè§£ä¸ï¼è¿å¯ä»¥å¤§è´è®¤ä¸ºï¼</p>
</li>
<li>
<p>è¿åå°åæ¯ç­è¿ä¸ªå½æ°æ§è¡å®ï¼è¦åå°åªä¸è¡ç»§ç»­æ§è¡ä»£ç ï¼ä¹å°±æ¯<strong>æ§å¶æµ</strong>è¯¥è·³ååªéãè¿æ¯æ¶é´ä¸çè¿å ï¼ä»£ç ç»§ç»­ä»åªéè·ã</p>
<p>ä¸ä¸å±æ å¸§æéæ¯è°ç¨æçé£ä¸ªå½æ°ï¼å®çæ å¸§ä»åªéå¼å§ï¼<br>
è¿æ¯ç©ºé´ä¸çè¿å ï¼è¦å»åªä¸ååå­éç»§ç»­è®¿é®å±é¨åéåä½ç¨åæ°æ®ã</p>
</li>
</ul>
</li>
<li>
<p><strong>Context (ä¸ä¸ææé)</strong></p>
<ul>
<li>
<p><em>è¿æ¯ä»ä¹</em>ï¼å®æå <strong>å åå­ (Heap)</strong> ä¸­ä¸ä¸ªå«å <code>Context</code> çå¯¹è±¡ã</p>
</li>
<li>
<p>ä¸ºä»ä¹è¦å®ï¼</p>
<p>å¦æå½æ°éç¨å°çåéæ¯èªå·±ç let aï¼ç´æ¥å»æ ä¸æ¾ï¼r0ï¼ã</p>
<p>ä½å¦æç¨å°äºé­ååéï¼å¤å±å½æ°çåéï¼ï¼Ignition å¿é¡»æ¿çè¿ä¸ª Context æéï¼å»å éçä¸ä¸æé¾è¡¨ä¸ä¸å±å±æ¾ã</p>
</li>
<li>
<p><em>å°ä½</em>ï¼å®æ¯è¿æ¥ <strong>âæ ä¸çï¼ä¸´æ¶æ°æ®ï¼â</strong> å <strong>âå ä¸çï¼æä¹æ°æ®ï¼â</strong> çå¯ä¸æ¡¥æ¢ã</p>
</li>
<li>
<p>è¿ä¸ªæ¦å¿µéå¸¸éè¦ï¼å¼å¾æä»¬æ·±å¥äºè§£ãå¦å¤æä¸å¥ï¼è½ç¶è¯´  è¿æ´ä¸ªé¨åé½å¯ä»¥äºè§£ä¸ºä¸»ï¼ä½æ¯å¦æè®¤çå­¦ä¹ ï¼è½å¤ææ¡ï¼è¿æ¯æå¾å¤§çç¨å¤ãæ¯å¦è¿ä¸ªæ å¸§ï¼å¯¹äºjså¼åè¿æ¯å¾éè¦çã</p>
</li>
<li>
<p>ä¸é¢æä¸ªä¸ä¸å±æ å¸§æéï¼è¿éåæä¸ªä¸ä¸ææéï¼æä¹æ­£ç¡®èæ·±å¥ççè§£ä»ä»¬å¢ï¼</p>
</li>
<li>
<p>**ä¸ä¸å±æ å¸§æéæ¯âå¨æè°ç¨é¾â **</p>
<ul>
<li><strong>åç­çé®é¢ï¼</strong> âææ¯è¢«è°è°ç¨çï¼â</li>
<li><strong>æååªéï¼</strong> æå<strong>æ ï¼Stackï¼</strong>ä¸çä¸ä¸çº§æ å¸§ã</li>
<li><strong>ä½ç¨ï¼</strong> å½æ°æ§è¡å®ï¼returnï¼åï¼åºå±ä¼æ ¹æ®è¿åå°åè·³åè°ç¨èç»§ç»­æ§è¡ï¼èä¸ä¸å±æ å¸§æéåç¨æ¥æ¢å¤è°ç¨èçæ å¸§å¸å±ï¼ç¨äºç»§ç»­è®¿é®å®çå±é¨åéç­æ°æ®ã</li>
</ul>
<p>**Context æ¯âéæä½ç¨åé¾â **</p>
<ul>
<li><strong>åç­çé®é¢ï¼</strong> âææ¯è¢«å®ä¹å¨åªéçï¼â</li>
<li><strong>æååªéï¼</strong> æå<strong>å ï¼Heapï¼</strong>ä¸ç Context å¯¹è±¡ã</li>
<li><strong>ä½ç¨ï¼</strong> å®æ¯<strong>æ°æ®æµ</strong>çæ¥æ¾è·¯çº¿ãå½å½æ°è®¿é®ä¸ä¸ªä¸å¨èªå·±åé¨çåéï¼èªç±åéï¼æ¶ï¼V8 ä¼é¡ºçè¿æ¡é¾å»æ¥æ¾ã</li>
</ul>
</li>
<li>
<p>çè§£çå³é®ç¹</p>
</li>
<li>
<p><strong>ä¸ä¸å±æ å¸§æåçæ¯æ åå­</strong>ï¼æ å¸§æ¯ä¸´æ¶çï¼å½æ°ä¸è¿åï¼æ å¸§å°±éæ¯äºã</p>
<p><strong>Context æåçæ¯å åå­</strong>ï¼è¿æ¯ä¸ºäºå®ç° JavaScript ç<strong>é­å</strong>ç¹æ§ã</p>
</li>
</ul>
</li>
<li>
<p><strong>Function / Frame Marker (å½æ°/å¸§ç±»åæ è®°)</strong>ï¼</p>
<ul>
<li>
<p>è¿ä¸ªå­æ®µç<strong>ä½ç½®</strong>å¨<code>[FP - 16]</code>  <strong>è¯·æ³¨æ</strong>  è¿éçåç§»å¼ 16 ä»æ¯<strong>ç¤ºæ</strong>ã  è¿ç§è¡¨ç¤ºæ¹æ³ï¼åé¢ä¼è¯¦ç»ä»ç»ã</p>
</li>
<li>
<p>è¿æ¯ä¸ä¸ªå·æ<strong>å¤ææ§ (Polymorphic)</strong> çå³é®æ§½ä½ãå®ç¨äºå½åæ å¸§çèº«ä»½è¯å«ãV8 å¼æå©ç¨è¿ä¸ªæ§½ä½æ¥åºåå½åæ å¸§æ¯å±äºæ åç JavaScript å½æ°è°ç¨ï¼è¿æ¯å±äºå¼æåé¨ç C++ è°ç¨ã</p>
</li>
<li>
<p>V8 çæ éåå¨ï¼Stack Walkerï¼å¨æ«æå æ æ¶ï¼ä¾å¦è¿è¡ GC æ è®°ãçæéè¯¯å æ æåä¼åæ¶ï¼ï¼ä¼è¯»åè¯¥æ§½ä½çå¼ï¼å¹¶æ ¹æ® <strong>æéæ è®°ä½ (Tag Bit)</strong> è¿è¡å¤æ­ï¼</p>
<ul>
<li><strong>å¦ææ¯å¯¹è±¡æéï¼Heap Objectï¼</strong>ï¼å¤å®ä¸º <strong>Interpreted Frame</strong>ï¼è§£éå¨å¸§ï¼ã</li>
<li><strong>å¦ææ¯å°æ´æ°ï¼Smiï¼</strong>ï¼å¤å®ä¸º <strong>Internal Frame</strong>ï¼åé¨å¸§ï¼ã</li>
</ul>
</li>
<li>
<p>å·æä¸¤ç§å¯è½çç¶æï¼</p>
</li>
<li>
<p>ç¶æ Aï¼å­æ¾ <code>JSFunction</code> (Closure)</p>
<ul>
<li><strong>åºæ¯</strong>ï¼å½æ§è¡å¸¸è§ JavaScript ä»£ç æ¶ã</li>
<li><strong>åå®¹</strong>ï¼æåå½åæ­£å¨æ§è¡çå½æ°å¯¹è±¡ï¼é­åï¼çæéã</li>
<li><strong>ä½ç¨</strong>ï¼
<ol>
<li>ä½ä¸º<strong>èµæºå¥å£</strong>ï¼è§£éå¨éè¿å®è®¿é® <code>SharedFunctionInfo</code>ï¼è·åå­èç ï¼å <code>FeedbackVector</code>ï¼è·åä¼ååé¦ï¼ã</li>
<li>è¿æ¥<strong>å ä¸æ </strong>ï¼ä¿æå¯¹å ä¸å½æ°å¯¹è±¡çå¼ºå¼ç¨ï¼é²æ­¢è¢« GC åæ¶ã</li>
</ol>
</li>
</ul>
<p><strong>ç¶æ Bï¼å­æ¾ <code>StackFrame::Type</code> (Marker)</strong></p>
<ul>
<li><strong>åºæ¯</strong>ï¼å½æ§è¡ V8 åé¨ä»£ç ï¼å¦ <code>EntryFrame</code>, <code>ConstructFrame</code>, <code>BuiltinFrame</code>ï¼æ¶ã</li>
<li><strong>åå®¹</strong>ï¼ä¸ä¸ªæä¸¾å¼ï¼Smiï¼ï¼æ è¯å·ä½çå¸§ç±»åã</li>
<li><strong>ä½ç¨</strong>ï¼
<ol>
<li><strong>è·¯æ ä½ç¨</strong>ï¼åè¯æ éåå¨å¦ä½è§£æå½åå¸§çå¶ä½é¨åï¼ä¸åç±»åçåé¨å¸§ï¼å¸å±å¯è½ä¸åï¼ã</li>
<li><strong>è¾¹ççå®</strong>ï¼æ è®° JS ä»£ç ä¸ C++ ä»£ç çè½¬æ¢è¾¹ç</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Bytecode Array (å­èç æ°ç»æé)</strong>ï¼</p>
<ul>
<li>
<p><strong>è¿ä¸ªå­æ®µçä½ç½®ï¼</strong> <code>[FP - 24]</code>   ä¾æ§è¯·æ³¨æï¼åç§»å¼ 24 ä»æ¯ç¤ºæã</p>
</li>
<li>
<p><strong>è¿ä¸ªå­æ®µçåå®¹ï¼</strong> ä¸ä¸ªæåå åå­ä¸­ <code>BytecodeArray</code> å¯¹è±¡ç <strong>Tagged Pointer</strong>ã</p>
</li>
<li>
<p><strong>å®ä¹ï¼</strong> å®æ¯è§£éå¨ Ignition çæ­£âè¯»åâåâæ§è¡âçæä»¤åºåæºå¤´ã</p>
</li>
<li>
<p>è¿ä¸ªå­æ®µæ¯ä¸ä¸ªæéï¼æåå ï¼Heapï¼ä¸çä¸ä¸ª<code>BytecodeArray</code> å¯¹è±¡ã</p>
<p>ä¹æä»¥å« <code>Array</code>ï¼æ¯å ä¸ºå®ç<strong>ä¸»ä½é¨å</strong>ç¡®å®æ¯ä¸ä¸²è¿ç»­çãåé¿çå­èåºåã</p>
<p>å¨ V8 çåºå± C++ å®ä¹ä¸­ï¼å¡æ¯ç¬¦å <strong>âå®é¿å¤´é¨ + åé¿å°¾é¨â</strong> ç»æçå¯¹è±¡ï¼éå¸¸é½ä»¥æ­¤å½åã</p>
<ul>
<li><strong>æ®éå¯¹è±¡ (<code>JSObject</code>)</strong>ï¼å¤§å°éå¸¸æ¯åºå®çï¼æèç± Map æè¿°ï¼ã</li>
<li><strong>æ°ç»ç±»å¯¹è±¡ (<code>FixedArray</code>, <code>ByteArray</code>)</strong>ï¼
<ol>
<li>å®æ¯<strong>åé¿</strong>çï¼å¨åéæ¶å³å®å¤§å°ï¼ã</li>
<li>å®ç<strong>ä¸»è¦åå®¹</strong>æ¯å¯ä»¥éè¿ç´¢å¼ï¼Indexï¼è®¿é®çåºåã</li>
</ol>
</li>
</ul>
<p>ä¹æä»¥å« <code>BytecodeArray</code> æ¯ä¸ºäºå¼ºè°å®ç<strong>å­å¨å½¢æ</strong>æ¯çº¿æ§çå­èåºåã</p>
</li>
</ul>
</li>
<li>
<p><strong>Bytecode Offset (å­èç åç§»é / PC)</strong>ï¼</p>
<ul>
<li><em>ä½ç¨</em>ï¼<strong>ç¨åºè®¡æ°å¨</strong>ãè®°å½å½åæ§è¡å°ç¬¬å æ¡æä»¤äºã</li>
<li><strong>ä½ç½®ï¼</strong> <code>[FP - 32]</code> (å³ <code>StandardFrameConstants::kBytecodeOffset</code>)  ï¼åç§»å¼32ï¼ä»ä¸ºç¤ºæï¼å¹¶éç¡®å®å¼ã</li>
<li><strong>å½¢å¼ï¼</strong> <strong>Smi (å°æ´æ°)</strong>ã</li>
<li><strong>å«ä¹ï¼</strong> å®è®°å½äºå½åæ§è¡å°äº <code>BytecodeArray</code> ä¸­ç<strong>ç¬¬å ä¸ªå­è</strong>ã</li>
<li><em>ç»è</em>ï¼å¨æ­£å¸¸è§£éæ§è¡æé´ï¼PC ç¶æå¸¸é©»å¨<strong>çå®çç©çå¯å­å¨</strong>ï¼å¨ä¹ä¸­ä¸åçåå¨ï¼åªæå¨éè¦å¤é¨å¯è§ææ¢å¤æ¶ï¼GC/ä¸­æ­/æ­ç¹/åä¼å/è¿å¥ runtime ç­ï¼ï¼è§£éå¨ä¼æå¯å­å¨çå¼ååæ å¸§ BytecodeOffset å­æ®µï¼ãæ¢å¤æ¶ä¼æå®åè£åç©çå¯å­å¨ã</li>
</ul>
</li>
</ol>
</li>
<li>
<p>ç¬¬ä¸å±   å·¥ä½åº  Work Area / Virtual Registers</p>
<p>è¿æ¯æ å¸§ä¸­ä½äºåºå®å¤´é¨åé¢ãåä½å°åå»¶ä¼¸çåºåã</p>
<p>Ignition å°è¿æ®µè¿ç»­çåå­æ§½ä½ï¼ç»å®ä»¬ç¼ä¸å·ï¼<code>r0</code>, <code>r1</code>, <code>r2</code>...</p>
<p>è½ç¶å®ä»¬å¨ç©çä¸åªæ¯è¿ç»­ç 8 å­èåå­æ ¼å­ï¼ä½å¨é»è¾ä¸ï¼å®ä»¬éå¸¸ååæäºä¸ç§æªç¶ä¸åçç¨éã</p>
<h4 id="1-æ¾å¼å±é¨åé-explicit-locals">1. æ¾å¼å±é¨åé (Explicit Locals)</h4>
<p>è¿æ¯æå¥½çè§£çé¨åãå®ä»¬ç´æ¥å¯¹åºä½ å¨ JavaScript ä»£ç ä¸­å£°æçå±é¨åéã</p>
<p>çæå¨ï¼BytecodeGeneratorï¼ä¼æç§ç¹å®ç®æ³ï¼éå¸¸ä¸å£°æé¡ºåºç¸å³ï¼ä¸ºè¿äºåéåéæ§½ä½ã</p>
<ul>
<li>ç¤ºä¾</li>
</ul>
<p>function demo() {<br>
var name = 'v8';  // ç¼è¯å¨å³å®ï¼åéç» r0<br>
let age = 10;     // ç¼è¯å¨å³å®ï¼åéç» r1<br>
}</p>
<p>å½ä»£ç æ§è¡å°è¿éæ¶ï¼<code>r0</code> æ§½ä½éå°±å¡«å¥äº <code>"v8"</code> çæéï¼<code>r1</code> æ§½ä½éå¡«å¥äº <code>10</code> ç Smi å¼ã</p>
<ul>
<li>
<p><strong>å³é®ç¹ï¼ä½ç¨ååæ (Scope Analysis)</strong></p>
<p><strong>è¦æ³¨æ</strong>  å¹¶ä¸æ¯ä½ åçææå±é¨åéé½è½ä½å¨è¿ä¸ªâæ ä¸çå·¥ä½åºâã</p>
<p>å¨çæå­èç ä¹åï¼V8 ä¼åè¿è¡ä¸æ¬¡ <strong>ä½ç¨ååæ</strong>ã</p>
<ul>
<li><strong>å¤æ­æ å</strong>ï¼å¦æä¸ä¸ªåéè¢«åé¨å½æ°ï¼é­åï¼<strong>æè· (Captured)</strong> äºï¼å®å°±ä¸è½ä½å¨æ ä¸</li>
<li><strong>åå </strong>ï¼æ å¸§çå½æ¯æéçï¼å½æ°æ§è¡å®å°±éæ¯äºãä½é­åå¯è½å¨å½æ°æ§è¡å®åè¿éè¦è®¿é®è¿ä¸ªåéã</li>
<li><strong>ç»æ</strong>ï¼è¢«æè·çåéä¼è¢«è¯·å°å åå­ç <strong>Context å¯¹è±¡</strong> ä¸­ã</li>
<li><strong>ç»è®º</strong>ï¼æä»¥ï¼è½å®ç¨³ä½å¨ <code>r0, r1</code> éçï¼é½æ¯èº«å®¶æ¸ç½çã<strong>æªè¢«æè·</strong>çå±é¨åéã</li>
</ul>
</li>
</ul>
<h4 id="2-éå¼ä¸´æ¶åé-implicit-temporaries">2. éå¼ä¸´æ¶åé (Implicit Temporaries)</h4>
<p>è¿æ¯å¨æºä»£ç éå®å¨çä¸å°ï¼ä½æºå¨æ§è¡æ¶å¿é¡»å­å¨çåéãè¿ä¹æ¯ <strong>å¯å­å¨åé (Register Allocation)</strong> ç®æ³å¤§æ¾èº«æçå°æ¹ã</p>
<ul>
<li>
<p><strong>ä¸ºä»ä¹è¦ä¸´æ¶åéï¼</strong></p>
<p>æ³è±¡ä¸ä¸è®¡ç® <code>var x = a + b + c;</code></p>
<p>Ignition çç´¯å å¨ï¼èå¸åçéèº«åï¼åªæä¸ä¸ªã</p>
<ol>
<li>åæ <code>a</code> æ¿è¿åï¼æ <code>b</code> å è¿æ¥ãåéç°å¨æ¯ <code>(a+b)</code>ã</li>
<li>ä¸ä¸æ­¥è¦å  <code>c</code>ãæä»¤è¦æ± <code>Add c</code>ã</li>
<li><strong>åçå²çª</strong>ï¼å¦æ <code>c</code> çè·åè¿ç¨å¾å¤æï¼æ¯å¦ <code>c</code> æ¯ä¸ªå½æ°è°ç¨ <code>getC()</code>ï¼ï¼é£ä¹å¨æ§è¡ <code>getC()</code> çè¿ç¨ä¸­ï¼ç´¯å å¨ä¼è¢«åå¤ä½¿ç¨ãè¦çã</li>
<li><strong>å¦ä½è§£å³</strong>ï¼å¿é¡»åæ <code>(a+b)</code> çç»ææ¾ä¸ªæ ¼å­ <strong>æå­ Spill</strong> èµ·æ¥ã</li>
</ol>
</li>
<li>
<p><strong>ç©çå­å¨</strong>ï¼</p>
<p>Ignition ä¼å¨å±é¨åéåé¢ï¼ååºä¸äºæ ¼å­ä½ä¸º <strong>ä¸´æ¶å¯å­å¨</strong>ã</p>
<p>è¿äºæ ¼å­å°±åèå¸åæè¾¹çâå°é»æ¿âã</p>
<ul>
<li><strong>å¤ç¨æ§</strong>ï¼è¿è¡ä»£ç ç®å®äºï¼è¿å¼ âå°é»æ¿âæ¦å¹²åï¼ç«å»ç»ä¸ä¸è¡ä»£ç å¤ç¨ãæä»¥å³ä½¿ä»£ç å¾é¿ï¼åªè¦ä¸åæ¶éè¿å¤§éä¸­é´ç»æï¼Frame Size ä¹ä¸ä¼å¾å¤§ã</li>
</ul>
</li>
</ul>
<h4 id="3-ç¥ç§çæ´-the-hole">3. ç¥ç§çæ´ (The Hole)</h4>
<p>è¿æ¯ ES6 å¼å¥ <code>let/const</code> åï¼V8 å¨åºå±å®ç° <strong>TDZ (ææ¶æ§æ­»åº)</strong> çæç¡¬æ ¸ææ®µã</p>
<p>å¨ç¬¬ä¸é¨åè§£æç¯ä¸­ï¼æä»¬å·²ç»è¯¦ç»å­¦ä¹ äºè¿ä¸ª ä¼å¹å¨å­çè­¦å«theholeï¼å¿è®°äºçæåï¼å¯ä»¥å¤ä¹ ä¸ä¸ç¬¬ä¸ç¯ä¸­çç¸å³åå®¹ãè¿éæä»¬ç¥å¾®çåè®²ä¸ä¸ã</p>
<p>å¨æ å¸§ååè¢«åå»ºï¼ä½ä»£ç è¿æ²¡æ§è¡å° <code>let a = ...</code> è¿ä¸è¡æ¶ï¼<code>rX</code> æ§½ä½éæ¾çæ¯ä»ä¹ï¼</p>
<ul>
<li>
<p><strong>å¯¹äº <code>var</code></strong>ï¼</p>
<p>V8 ä¼æå¯¹åºçæ§½ä½åå§åä¸º <code>undefined</code>ãæä»¥å¨èµå¼åè®¿é®å®ï¼æ¿å°çå°±æ¯ <code>undefined</code>ï¼åéæåï¼ã</p>
</li>
<li>
<p><strong>å¯¹äº <code>let / const</code></strong>ï¼</p>
<p>V8 ä¼æå¯¹åºçæ§½ä½å¡«å¥ä¸ä¸ªç¹æ®ç <strong>ä¼å¹å¨å­çè­¦å«</strong>ï¼å¨åé¨è¢«ç§°ä¸º <strong><code>The Hole</code></strong>ã</p>
</li>
<li>
<p><strong>æ§è¡æ¶çæ£æ¥æºå¶</strong>ï¼</p>
<p>Ignition å¨æ§è¡è¯»ååéçæä»¤ï¼å¦ <code>LdaRep</code>ï¼æ¶ï¼åç½®äºä¸æ®µå°é»è¾ï¼</p>
<p>// ä¼ªä»£ç <br>
value = load(r1);<br>
if (value == The_Hole_Value) {<br>
throw ReferenceError("Cannot access before initialization");<br>
}</p>
<p>TDZ å¹¶ä¸é¾çè§£ï¼å®å¨ç©çå±é¢ä¸ï¼å°±æ¯ä¸ä¸ªæ§½ä½éæ¾ç <code>The Hole</code>ï¼èè§£éå¨å¨è¯»åæ¶ä¸ä»è¯»æ°æ®ï¼è¿é¡ºæåäºä¸æ¬¡å®å¨æ£æ¥ï¼å¦ææ¸å°çæ¯è­¦å«ï¼å¨å­å°±åã</p>
</li>
</ul>
<h4 id="4-å¯»åæºå¶å¦ä½æ¾å°-r5">4. å¯»åæºå¶ï¼å¦ä½æ¾å° <code>r5</code>ï¼</h4>
<p>å·¥ä½åºåªæ¯ä¸æ®µè¿ç»­çåå­ï¼Ignition æä¹ç¥é <code>r5</code> å¨åªï¼</p>
<p>è¿å°±è¦ç¨å°æ±ç¼éç <strong>åºåå¯»å</strong> äºã</p>
<ul>
<li>
<p><strong>åºåç¹</strong>ï¼<strong>FP (Frame Pointer)</strong>ï¼æååºå®å¤´é¨çç¹å®ä½ç½®ã</p>
</li>
<li>
<p>ææåå¯è½ä¼æçé®äºï¼åé¢è¯´æ å¸§æ3é¨åï¼ç¬¬ä¸é¨åæ¯åæ°åºï¼å¯æ¯ä¸ºä»ä¹FPåºåç¹æååºå®å¤´é¨ ï¼èä¸æ¯æååæ°é¨åã</p>
</li>
<li>
<p>åæ°ç©ºé´æ¯<strong>è°ç¨è</strong>çåºåï¼å æ­¤å¨è¯­ä¹ä¸å®å±äºcaller çé¨å ï¼èä¸æ¯ callee ç¨æ¥åéæ¬å°åé/ä¸´æ¶ç workspaceãFP ä½ä¸ºè¢«è°ç¨èçæ å¸§åºåç¹ï¼éå¸¸æ¯ä¸åæ¬åæ°åºçã</p>
</li>
<li>
<p><strong>è®¡ç®å¬å¼</strong>ï¼</p>
<p>ç±äºæ æ¯åä½å°åå¢é¿çï¼æä»¥å¯å­å¨çå°åæ¯ FP åå»ä¸ä¸ªåç§»éã</p>
<p>Address(rn) = FP - fixed_header_size - (n * slot_size)</p>
<p>å¶ä¸­ <code>fixed_header_size</code> æ¯åºå®å¤´é¨çå­èé¿åº¦ï¼<code>slot_size</code> éå¸¸ç­äºæºå¨æéå¤§å°ï¼å¨ 64 ä½ç³»ç»ä¸å¸¸ä¸º 8 å­èï¼</p>
</li>
<li>
<p><strong>ç¤ºä¾ï¼</strong></p>
<ul>
<li><code>FP</code> æåè¿éã</li>
<li>å¾ä¸èµ° 8 å­è... æ¯ <code>Context</code> <code>[FP-8]</code>ã</li>
<li>åå¾ä¸... æ¯ <code>Function</code> <code>[FP-16]</code>ã</li>
<li>åå¾ä¸... æ¯ <code>BytecodeArray</code> <code>[FP-24]</code>ã</li>
<li>åå¾ä¸... æ¯ <code>BytecodeOffset</code> <code>[FP-32]</code>ã<strong>(åºå®å¤´é¨ç»æ)</strong></li>
<li><strong>åå¾ä¸... ç»äºå°äºå·¥ä½åºç r0</strong> <code>[FP-40]</code>ã</li>
<li><code>r0</code> åå¾ä¸ 8 å­èæ¯ <code>r1</code>ã</li>
</ul>
<p>æä»¥ï¼å­èç éçç®åæä»¤ <code>Ldar r5</code>ï¼ç¿»è¯å°åºå± CPU å¨ä½ï¼å°±æ¯å»è¯»æ´æ·±å¤çåå­å°åã</p>
</li>
</ul>
</li>
</ul>
<h2 id="4--è°ç¨çº¦å®ååå­å¸å±">4 . è°ç¨çº¦å®ååå­å¸å±</h2>
<p>éè¿åé¢çå­¦ä¹ ï¼æä»¬å·²ç»å¤§è´äºè§£äºæ å¸§çåå®¹ï¼ç°å¨æä»¬å°±éè¦å¨èå­ä¸­å»ºç«èµ·å¨æçæ å¸§æ¨¡åã</p>
<ul>
<li>
<p>å»ºç«æä»¬èªå·±çå¿æºæ¨¡åï¼åå­çæ³è±¡å¾</p>
<p>é£ä¹ æä»¬æä¹æ³è±¡åå­å¢ï¼ æ¢¯å­ï¼é«è¸å¥äºçæ¢¯å­ï¼ä¸æ ¼ä¸æ ¼çä»£è¡¨åå­ååã</p>
<p><strong>å°é¢ï¼æåºä¸ï¼</strong>ï¼æ¯ <strong>é«å°å</strong>ï¼æ¯å¦ <code>0xFF...</code>ï¼ãå¯¹äºæ å¸§æ¥è®²ï¼è¿æ¯ç¨³åºçå°åºã</p>
<p><strong>å¤©ç©ºï¼å¾ä¸çï¼</strong>ï¼æ¯ <strong>ä½å°å</strong>ï¼æ¯å¦ <code>0x00...</code>ï¼ãè¿æ¯å»¶ä¼¸ç©ºé´ã</p>
<p>æåºä¸æ¯é«å°åï¼è¶å¾ä¸ï¼å°åè¶ä½ã</p>
<p>ææåå¯è½ä¼é®ï¼âä¹¦ä¸æè V8 æºç æ³¨ééï¼éå¸¸é½æ¯ç»âé«å°åå¨ä¸ï¼ä½å°åå¨ä¸âï¼æ æ¯âåä¸çé¿âçï¼ä¸ºä»ä¹æä»¬è¦åçæ¥ï¼â</p>
<p>è¿å¶å®æ¯ä¸ºäºè´´å<strong>ç´è§</strong>ã å¦æä½ ä½¿ç¨è¿ OllyDbgãx64dbg æ IDA ç­è°è¯å·¥å·ï¼ä½ ä¼åç°å®ä»¬çåå­è§å¾éå¸¸æ¯è¿æ ·çï¼</p>
<ul>
<li><strong>ä¸é¢</strong> æ¾ç¤ºçæ¯ <strong>ä½å°å</strong>ã</li>
<li><strong>ä¸é¢</strong> æ¾ç¤ºçæ¯ <strong>é«å°å</strong>ã</li>
</ul>
<p><strong>è¿ç§è§è§çå¥½å¤æå¶ç´è§ï¼</strong></p>
<ul>
<li><strong>å¥æ  Push</strong>ï¼å°±åçæ¥¼ä¸æ ·ï¼å¨ç°æçæ¥¼é¡¶ä¸ï¼<strong>å¾ä¸</strong> åçä¸å±ï¼å°ååä½/åå°ï¼ã</li>
<li><strong>åºæ  Pop</strong>ï¼å°±åææ¥¼ä¸æ ·ï¼ææä¸é¢çä¸å±ææï¼å°åååé«/åå¤§ï¼ã</li>
<li><strong>æ åº</strong>ï¼å¨æä¸é¢ï¼é«å°åï¼ï¼éå¸¸å­æ¾çè°ç¨èçç¯å¢ï¼å¨ä¸ä¸ªæ å¸§ä¸­ï¼å¾å°åå¨ã</li>
<li><strong>æ é¡¶</strong>ï¼å¨æä¸é¢ï¼ä½å°åï¼ï¼æ°æ®é¢ç¹è¿è¿åºåºåºæ å¥æ ï¼åå¨å§çã</li>
</ul>
<p>æä»¥ï¼ä¸ºäºçè§£èµ·æ¥æ´é¡ºçï¼å»ºè®®æä»¬å¨èæµ·ä¸­å»ºç«çæ¨¡åå¦ä¸ï¼</p>
<ul>
<li><strong>é«å°åå¨ä¸</strong>ï¼å°åºï¼ã</li>
<li><strong>ä½å°åå¨ä¸</strong>ï¼å¤©ç©ºï¼ã</li>
<li><strong>æ å¸§ççé¿æ¹å</strong>ï¼ä»ä¸å¾ä¸ï¼<strong>åä½å°åçé¿</strong>ã</li>
</ul>
</li>
<li>
<p>æéååå­åå</p>
<p><strong>æå°å»åº¦ï¼å­è (Byte)</strong> å¨è®¡ç®æºéï¼<strong>8 bit (1å­è)</strong> æ¯åå­å¯å¯»åçæå°åä½ã</p>
<p><strong>å®éæ­¥é¿ï¼</strong>    è½ç¶å»åº¦æ¯æ å­è ç»çï¼ä½å¨ 64 ä½ç³»ç»éï¼Ignition è¿ä¸ªèå¸åæå¾å¤§ã ä»å¹²æ´»æ¶ï¼<strong>ä¸ä¼åå­¦åå¥é£æ ·æçå°è±æå»æ 1 ä¸ªå­èã</strong>   ä»<strong>æ¯ä¸æ¬¡ä¼¸æï¼é½è¦æèµ° 8 ä¸ªå­è</strong>ï¼64 bitï¼ãè¿ 8 ä¸ªå­èåèµ·æ¥ï¼æææäºä¸ä¸ªå®æ´ç <strong>æ§½ä½ (Slot)</strong>ã</p>
<p><strong>åå­å¯¹é½ï¼</strong> æ¯ä¸æ¬¡é½è¦æä½ 8 ä¸ªå­èï¼æä»¥ï¼ææä½çå°åï¼é½æ¯8çåæ°ï¼</p>
<p>0  8  16  24 ãããï¼è¿äºæ°å­ä»ä»æ¯ç¤ºæå°åæ¯8çåæ°ï¼</p>
<p>è¿å°±æ¯ <strong>åå­å¯¹é½</strong>ã</p>
<p><strong>æ³¨æï¼</strong> è¿å¹¶ä¸ä»£è¡¨å°å <code>1, 2, 3...7</code> æ¯âç©ºé²âæèâæ²¡ç¨âçã å½ä½ åå°å <code>0</code> åå¥ä¸ä¸ª 64 ä½æéæèæ°æ®æ¶ï¼è¿ä¸ªæéææ°æ®ç¨64bitçåºå¤§çèº«èº¯<strong>å¡«æ»¡</strong>äºä» <code>0</code> å° <code>7</code> çææç©ºé´ã åªä¸è¿ï¼å½æä»¬æ³<strong>æ¾å°</strong>è¿ä¸ªæ°æ®æ¶ï¼æä»¬åªå¨è¿ä¸ªæ°æ®ç<strong>å¤´é¨ï¼é¦å°åï¼</strong> æ¾èµ·ã</p>
<p><strong>å°å 0</strong>ï¼æ¯ç¬¬ä¸ä¸ªæ§½ä½ç<strong>é¨å£</strong>ã<strong>å°å 8</strong>ï¼æ¯ç¬¬äºä¸ªæ§½ä½ç<strong>é¨å£</strong>ã</p>
<p>è¿å°±è§£éäºæä»¬å¨åé¢åå®¹ä¸­æå°ç <strong>Tagged Pointer</strong> åçï¼ å ä¸ºå°ååªå¨ <code>0, 8, 16</code> è¿äº <code>8</code> çåæ°ä¸ï¼æä»¥è¿äºå°åçäºè¿å¶è¡¨ç¤ºï¼<strong>æå 3 ä½éå¸¸æ¯ 0</strong>ã V8 ä¹æ¯çåäºè¿ä¸ç¹ï¼ææ¢æè¿ 3 ä½æªä½ä»ç¨ï¼å­ç±»å Tagï¼ã</p>
<p><strong>æé</strong>   å¦ä½çè§£ï¼</p>
<p>æéå°±æ¯å°åï¼ä¹æä»¥è¯´æ¯æé èä¸æ¯ç´æ¥è¯´å°åï¼æ¯å ä¸º æéæ¶ç´§äºå°åçæ¦å¿µã</p>
<p>âå°åâæ¯ç©çå±é¢çå®¢è§å­å¨ï¼èâæéâæ¯è½¯ä»¶å±é¢çä¸»è§å®ä¹ãæéå¯¹å°åå·ææ¶ç´§åçº¦æä½ç¨ã</p>
<p>åç¡®çè¯´  <strong>æéæ¯å¯¹å°åæ¦å¿µçä¸æ¬¡âæ¶ç´§âåâèµäºè¯­ä¹â</strong>ã</p>
<ul>
<li>
<p><strong>å°å</strong></p>
</li>
<li>
<p><strong>æ¬è´¨</strong>ï¼å®åªæ¯ä¸ä¸ªå·å°å°çæ°å­ç¼å·ï¼æ¯å¦ <code>0x0000FFFF</code>ï¼ã</p>
</li>
<li>
<p><strong>ç¼ºé·</strong>ï¼å®æ²¡æä»»ä½çº¦æãç»ä½ ä¸ä¸ªå°åï¼ä½ æ ¹æ¬ä¸ç¥éé£éä½çæ¯ä»ä¹ã</p>
<ul>
<li>æ¯ 4 ä¸ªå­èçæ´æ°ï¼</li>
<li>è¿æ¯ 1 ä¸ªå­èçå­ç¬¦ï¼</li>
<li>æèæ¯ä¸æ®µå¯æ§è¡çä»£ç ï¼</li>
<li>çè³å¯è½æ¯ä¸ä¸ªæ æçåå¾å¼ï¼</li>
</ul>
</li>
<li>
<p><strong>ç¶æ</strong>ï¼å¦æä½ åªæ¿å°äºä¸ä¸ªå°åï¼ä½ é¢å¯¹çæ¯æªç¥çãæ··ä¹±çåå­ç©ºé´ã</p>
</li>
<li>
<p>**æé **</p>
</li>
<li>
<p><strong>æ¬è´¨</strong>ï¼<strong>æé = å°å + ç±»åçº¦æï¼è§£éæ¹å¼ï¼</strong>ã</p>
</li>
<li>
<p><strong>æ¶ç´§çæ¦å¿µ</strong>ï¼</p>
<p>å½æä»¬å®ä¹ä¸ä¸ªæéï¼æ¯å¦ C++ éç <code>int* p</code> æ V8 éç <code>Tagged Pointer</code>ï¼æ¶ï¼æä»¬å®éä¸æ¯<strong>æ¶ç´§</strong>äºå¯¹é£ä¸ªåå­å°åçæä½æéåçè§£æ¹å¼ã</p>
<ul>
<li>å®åè¯ CPUï¼âå«ä¹±çäºï¼è¿ä¸ªå°åéå­çä¸å®æ¯ <strong>å¯¹è±¡</strong>ï¼èä¸æ¯æ´æ°ãâ</li>
<li>å®åè¯ç¼è¯å¨ï¼âå½ä½ å»è¯»è¿ä¸ªå°åæ¶ï¼è¯·æç§ <strong>8 å­è</strong> ä¸ºåä½å»è¯»ï¼ä¸è¦åªè¯» 1 ä¸ªå­èãâ</li>
</ul>
</li>
</ul>
<p>å¨ V8 ç Ignition ä¸­ï¼è¿ç§âæ¶ç´§âä½ç°å¾æ´å¨é¢ï¼</p>
<ol>
<li>
<p><strong>æ ç­¾ (Tagging)</strong>ï¼</p>
<p>V8 çæéï¼Tagged Pointerï¼å©ç¨æä½ä½ï¼Tag Bitï¼å¼ºè¡è§å®äºè¯­ä¹ã</p>
<ul>
<li>å¦ææåä¸ä½æ¯ <code>0</code>ï¼<strong>æ¶ç´§ä¸ºâç«å³æ°â</strong>ï¼Smiï¼ãä¸éè¦å»åå­éæ¾ï¼å®èªå·±å°±æ¯å¼ã</li>
<li>å¦ææåä¸ä½æ¯ <code>1</code>ï¼<strong>æ¶ç´§ä¸ºâå æéâ</strong>ï¼HeapObjectï¼ãå¿é¡»å»å éæ¾ã</li>
</ul>
</li>
<li>
<p><strong>éèç±» (Map/Hidden Class)</strong>ï¼</p>
<p>å½ä½ é¡ºç V8 çæéæ¾å°å éçå¯¹è±¡æ¶ï¼å¯¹è±¡çç¬¬ä¸ä¸ªå±æ§éå¸¸æ¯ <strong>Map</strong>ï¼éèç±»ï¼ã</p>
<p>è¿å®éä¸æ¯è¿ä¸æ­¥çâæ¶ç´§âï¼</p>
<ul>
<li>âè¿ä¸ªå°åä¸ä»æ¯ä¸ªå¯¹è±¡ï¼èä¸å®æ¯ä¸ä¸ª <strong>æ°ç»</strong>ï¼é¿åº¦æ¯ 10ï¼åç´ ç±»åæ¯...âã</li>
</ul>
</li>
</ol>
<p>æåéè¦æ³¨æï¼è¶å¾åºå±ï¼æ¯å¦å°äºæ±ç¼  å°äºä»£ç è°è¯ ï¼å¯¹äºæéåå°åçåºåï¼å°±è¶è¶è¿äºæ ï¼å¾å¤æ¶åï¼é½æ¯æ··çå«çï¼åºæ¬ä¸é½æ¯ä½¿ç¨æéå°±æ¯å°å è¿ä¸ªæ¬è´¨æ¦å¿µäºãå ä¸ºçº¦æå·²ç»å¥ç¦»ï¼åªå©æ¬è´¨äºã</p>
<p><strong>è°ç¨çº¦å®</strong></p>
<p>æä»¬å¨åé¢å­¦ä¹ äºæ å¸§çç©çç»æï¼åæ°å¨é«å°åï¼è¿åå°åå¨ä¸­é´ï¼åéå¨ä½å°åã</p>
<p>è¿æ¶åï¼æ ä¸­çåçæåååºç°äºï¼ä¸ºä»ä¹è¦è¿ä¹æ¾ï¼æåè¿æ¥æ¾ä¸è¡å  ææ··çæ¾ä¸è¡åï¼</p>
<p>è¿å°±å¼åºäºä¸ä¸ªéè¦çæ¦å¿µ è°ç¨çº¦å®ã</p>
<ul>
<li>
<p>ç®åæ¥è¯´ï¼è°ç¨çº¦å®å°±æ¯ <strong>è°ç¨è (Caller)</strong> å <strong>è¢«è°ç¨è (Callee)</strong> ä¹é´è¾¾æçä¸ä»½ <strong>âåè®®â</strong> æ <strong>âååâ</strong>ã</p>
<p>æ³è±¡ä¸ä¸ä¸¤ä¸ªäººå¨ç©ççï¼</p>
<ul>
<li>
<p><strong>Caller</strong> è¯´ï¼âæä¼æçæå°<strong>ä½ çå·¦æè¾¹</strong>ãâ</p>
</li>
<li>
<p><strong>Callee</strong> è¯´ï¼âå¥½çï¼æä¼è·å°<strong>å·¦æè¾¹</strong>å»æ¥çãâ</p>
<p>è¿å°±æ¯çº¦å®ãå¦æ Caller æåå·¦è¾¹ï¼è Callee è·å»å³è¾¹æ¥ï¼çå°±æäºï¼ç¨åºå´©æºï¼ã</p>
</li>
</ul>
</li>
</ul>
<p>å¨ V8 éï¼è¿ä»½ åè®®/åå è§å®äºä¸ä¸ªææ ¸å¿çé®é¢ï¼</p>
<ol>
<li><strong>åæ°æ¾åªï¼</strong> (ä¼ éæ¹å¼)
<ul>
<li>æ¯æ¾å¨ CPU å¯å­å¨éï¼è¿æ¯åå°æ åå­éï¼</li>
<li>å¦ææ¯åæ ï¼æ¯ä»å·¦å¾å³åï¼è¿æ¯ä»å³å¾å·¦åï¼</li>
</ul>
</li>
<li><strong>ç»ææ¾åªï¼</strong> (è¿åæ¹å¼)
<ul>
<li>å½æ°ç®å®äºï¼ç»ææ¾å¨åªä¸ªå¯å­å¨éå¸¦åå»ï¼ï¼éå¸¸æ¯ç´¯å å¨/raxï¼ã</li>
</ul>
</li>
<li><strong>è°æ¥ææ«å«çï¼</strong> (å æ å¹³è¡¡)
<ul>
<li>åæ°å ç¨çæ ç©ºé´ï¼æ¯ Caller è´è´£åæ¶ï¼è¿æ¯ Callee è´è´£åæ¶ï¼</li>
</ul>
</li>
</ol>
<p><strong>V8çç¹æ®ä¹å¤ï¼åå¾åæ¶</strong></p>
<p>å¨c / c++ ä¸­ï¼ æ åçº¦å®éå¸¸ä¼ä¼åæåå ä¸ªåæ°æ¾å¨ <strong>ç©çå¯å­å¨</strong> éä¼ éï¼è¿æ ·éåº¦ä¼è¾¾å°æè´ã</p>
<p>ä½æ¯å¨V8ç Ignition è§£éå¨éï¼æä»¬çå°åæ°å ä¹é½æ¯ä¹å·§çæåå¨æ ä¸ãè¿æ¯ä¸ºä»ä¹ï¼</p>
<p>å ä¸º V8 æä¸ä¸ªå¹½çµæå« ï¼è¿å°±æ¯ <strong>åå¾åæ¶å¨ (GC)</strong>ã</p>
<ul>
<li><strong>GC çå¨å¹´æ ä¼</strong>ï¼GC éè¦æ¶å»æ«æåå­ï¼ççåªäºå¯¹è±¡è¿æ´»çï¼ææéæåå®ï¼ã</li>
<li><strong>å¯å­å¨æ æ³è·è¸ª</strong>ï¼å¦æåæ°æ£è½å¨åç§ç©çå¯å­å¨éï¼è¿å°±å¾é¾è¿½è¸ªã</li>
<li><strong>V8 çæä¸­æé</strong>ï¼<strong>ç¡®ä¿æ ä¸æä¸ä»½âå¯æ«æâçå¤ä»½ã</strong></li>
</ul>
<p>å³ä½¿æäºåæ°æ¯éè¿å¯å­å¨ä¼ è¿æ¥çï¼ä¸ºäºæ¹ä¾¿ GC æ¸ç¾èä¸²å¼çæ«æï¼V8 éå¸¸ä¹ä¼ä¿è¯è¿äºåæ°å¨æ ä¸æä¸ä¸ªç¡®å®çä½ç½®ï¼æèæå¯å­å¨çå¼âæåâå°æ ä¸ï¼ãè®°å¾åé¢è¯´PCçæ¶åï¼æè¿ä¸æ¬¡ã</p>
<p>so  è¿å°±å½¢æäºæä»¬å¨æ å¸§å¾ä¸­çå°çé£æ ·,åæ°å¨åå­éè¿ç»­æåï¼GC æ«èµ·æ¥éå¸¸èæã</p>
<p><strong>åè¯´æ å¸§çåå­å¸å±</strong></p>
<p>å¨åé¢æä»¬è®²æ å¸§çç»ææ¶ï¼ä»é«å°åå°ä½å°åï¼ä¾æ¬¡æ¯  åæ°åº--åºå®å¤´é¨åº--å·¥ä½åºï¼ä½æ¯</p>
<p>å¯¹äºæ å¸§çåçåå­æ®µçææèï¼å¹¶æ²¡æè¯¦ç»çè¯´æã ç°å¨æä»¬æäºè¶³å¤çéºå«ï¼å¯ä»¥è¯¦ç»äºè§£äºã</p>
<p>æä»¬éè¦æ<strong>æ¶é´é¡ºåº</strong>èµ°ä¸éæµç¨ã</p>
<p>è¿å¯¹äºçè§£ FPï¼æ å¸§æéï¼è¿ä¸ªâçç¢âè³å³éè¦ã</p>
<p><strong>ç¬¬ä¸é¶æ®µï¼è°ç¨èåå¤å·¥ä½</strong></p>
<p>è°ç¨èå¨æ§è¡ <code>CALL</code> æä»¤ä¹åï¼éè¦ååå¤å¥½è´¡åï¼</p>
<ol>
<li>
<p><strong>Push åæ°</strong>ï¼è°ç¨èæåæ°ï¼Receiver, a0, a1...ï¼æé¡ºåºåå¥æ ã</p>
<ul>
<li><em>(è¿æ¯ Caller åæ¨çåå­ï¼å±äº Caller çæ å¸§èå´ï¼ä½ä¾ Callee ä½¿ç¨)</em></li>
</ul>
</li>
<li>
<p><strong>æ§è¡ CALL æä»¤</strong>ï¼CPU èªå¨å° <strong>è¿åå°å (Return Address)</strong> åå¥æ é¡¶ï¼å¹¶è·³è½¬å° Callee çä»£ç å¤ã</p>
<ul>
<li><em>(æ­¤æ¶ï¼FP æéä¾ç¶æå Caller çèåºåç¹)</em></li>
</ul>
</li>
</ol>
<p><strong>ç¬¬äºé¶æ®µï¼è¢«è°ç¨èæ¥æ</strong></p>
<p>æ§å¶ææ¥å°äº Ignitionï¼è¢«è°ç¨èï¼æä¸­ï¼å®è¿é¨åç<strong>å¤´ç­å¤§äº</strong>å°±æ¯å»ºç«èªå·±çå®é¨ï¼æ å¸§ï¼ï¼</p>
<ol>
<li><strong>Push Caller's FP</strong>ï¼Ignition åçç¬¬ä¸ä»¶äºï¼å°±æ¯ææ§ç FPï¼ä¸ä¸å±çåºåç¹ï¼åå¥æ ä¸­ä¿å­èµ·æ¥ã
<ul>
<li><em>(è¿ä¸æ­¥å½¢æäº Saved FPï¼ä¹å°±æ¯æ å¸§ä¸­é´çé£ä¸ªè¿æ¥ç¹)</em></li>
</ul>
</li>
<li><strong>Set New FP</strong>ï¼Ignition æå½åçæ é¡¶æé (SP) èµå¼ç» FPã
<ul>
<li><em>(ä»æ­¤ï¼FP æåäº Saved FPãæ°çæ å¸§åºåç¹æ­£å¼å»ºç«)</em></li>
</ul>
</li>
<li><strong>Push Fixed Header</strong>ï¼æ¥çï¼Ignition ä¾æ¬¡åå¥ ContextãFunctionãBytecodeArrayãBytecodeOffset ç­åºå®å­æ®µã</li>
<li><strong>Allocate Locals</strong>ï¼æåï¼æ ¹æ® Frame Sizeï¼ä¸æ¬¡æ§ææ é¡¶æé (SP) å¾ä¸ç§»ï¼ä¸ºå±é¨åéï¼r0, r1...ï¼çåºç©ºé´ï¼å¹¶åå§åä¸º <code>undefined</code> æ <code>The Hole</code>ã</li>
</ol>
<h3 id="_"></h3>
<p>æäºè¿ä¸ªæµç¨ï¼æä»¬åçâæ·å£å½å±âå°±éå¸¸æ¸æ°äºï¼</p>
<ul>
<li>
<p><strong>FP åå¶ä¸æ¹ (åæ°ãè¿åå°å)</strong>ï¼ è½ç¶ç©çä¸å FP è¿å¨ä¸èµ·ï¼ä½å®ä»¬æ¯ <strong>Caller</strong> å¨ç¬¬ä¸é¶æ®µçä¸çâéäº§âã</p>
<ul>
<li>åæ°æ¯ Caller å¸¦æ¥çã</li>
<li>è¿åå°åæ¯ Caller å¸¦æ¥çã</li>
<li>Saved FP æ¯ Callee ä¸ºäºä¿æ¤ Caller èå­çã</li>
</ul>
</li>
<li>
<p><strong>FP ä¸æ¹ (åºå®å¤´é¨ãå·¥ä½åº)</strong>ï¼ è¿æ¯ <strong>Callee</strong> å¨ç¬¬äºé¶æ®µäº²æåå»ºçâèµäº§âã</p>
<ul>
<li>Context æ¯ Callee æ¾æ¥çã</li>
<li>å±é¨åéæ¯ Callee åéçã</li>
</ul>
</li>
</ul>
<p>è¿æ ·ï¼æä»¬åæ¥çæ å¸§çç»æï¼çè§£ä¸çé»è¾å°±å®å¨é­ç¯äºï¼ <strong>Caller ç»èµæºï¼åæ°ï¼ --- ç¡¬ä»¶ç»éè·¯ï¼è¿åå°åï¼ ---  Callee å»ºå°åºï¼ä¿å­æ§FPï¼ ---  Callee å»ºæ¿å­ï¼å¤´é¨ååéï¼ã</strong></p>
<p><strong>FPååç§»é</strong></p>
<p>å¨åé¢æä»¬å­¦ä¹ æ å¸§çåºå®å¤´é¨ä¸­çå­æ®µæ¶ï¼æä»¬ä½¿ç¨äº FPå åç§»å¼ çè¡¨ç¤ºæ¹å¼ã</p>
<p>ç±ç¢ç£¨çæåè¯å®ä¼æçé®ï¼<strong>ä¸ºä»ä¹ææä¸è¥¿é½è¦ç¯ç FP çï¼ä¸ºä»ä¹æ¯è¿äºç¹å®çæ°å­ï¼FP éé¢å°åºè£äºä»ä¹ï¼</strong></p>
<ol>
<li><strong>ä¸ºä»ä¹é FP (Frame Pointer) ååºåï¼</strong></li>
</ol>
<p>ä½ å¯è½ä¼é®ï¼âæ é¡¶æé <strong>SP (Stack Pointer)</strong> ä¹æ¯ä¸ªæéï¼èä¸å®å°±å¨æ é¡¶ï¼ä¸ºä»ä¹ä¸ç¨ SP æ¥æ¾æ°æ®ï¼éè¦ä¸é¨ç»´æ¤ä¸ä¸ª FP å¢ï¼â</p>
<p><strong>åå å°±æ¯ï¼SP æ¯âå¨âçï¼FP æ¯âéâçã</strong></p>
<ul>
<li>
<p><strong>SP çå¨å¦è±å</strong>ï¼</p>
<p>å¨å½æ°æ§è¡è¿ç¨ä¸­ï¼Ignition å¯è½ä¼é¢ç¹å°å¥æ ãåºæ ï¼æ¯å¦åå¥ä¸´æ¶åéãåå¤å­å½æ°åæ°ï¼ã</p>
<p>è¿å°±å¯¼è´ SP çä½ç½®ä¸ç´å¨åã</p>
<p>å¦æç¨ SP ååºåï¼å½ä½ æ¾ <code>åé a</code> æ¶ï¼ä¸ä¸è¡ä»£ç å¯è½æ¯ <code>[SP + 8]</code>ï¼ä¸ä¸è¡ä»£ç å ä¸ºåäºä¸ªä¸´æ¶å¼ï¼å°±åæ <code>[SP + 16]</code> äºãç¼è¯å¨è®¡ç®èµ·æ¥ä¼ç¯æã</p>
</li>
<li>
<p><strong>FP çéå¦ç«çª</strong>ï¼</p>
<p>ä¸æ¦æ å¸§å»ºç«å®æ¯ï¼Prologue ç»æï¼ï¼å¨æ´ä¸ªå½æ°æ§è¡æé´ï¼<strong>FP æéå°±æ¯éå¨æ å¸§çåºå®ä½ç½®ï¼Saved FP é£ä¸ªæ§½ä½ï¼ï¼é·æä¸å¨ã</strong></p>
<p>æ­¤æ¶ï¼æä»¬ä»¥ FP ä¸ºåç¹ï¼åä¸ä¸çï¼</p>
<p><strong>å¾ä¸çï¼åå°åº/é«å°åï¼</strong>ï¼ä¸ç®¡æ é¡¶æä¹åï¼åæ° <code>a0</code> æ°¸è¿å¨ FP <strong>å¾ä¸æ°</strong> ç¬¬ 2 æ ¼çä½ç½®ï¼åç§»éæ¯æ­£æ°ï¼å¦ <code>FP + 16</code>ï¼ã</p>
<p><strong>å¾ä¸çï¼åå¤©ç©º/ä½å°åï¼</strong>ï¼ä¸ç®¡æ é¡¶æä¹åï¼åé <code>r0</code> æ°¸è¿å¨ FP <strong>å¾ä¸æ°</strong> ç¬¬ 5 æ ¼çä½ç½®ï¼åç§»éæ¯è´æ°ï¼å¦ <code>FP - 40</code>ï¼ã</p>
</li>
</ul>
<p><strong>æä»¥</strong>ï¼FP æä¾äºä¸ä¸ª<strong>éæçãç»å¯¹ç</strong>åèåæ ç³»ã</p>
<ol start="2">
<li>**FPåå°åååå®¹ **</li>
</ol>
<p>è¿æ¯åæ¥è§¦çæåï¼çè§£æ å¸§é¾è¡¨æå®¹æè¿·ç³çå°æ¹ã</p>
<p>æä»¬è¦åºåä¸ä¸ªæ¦å¿µï¼</p>
<ul>
<li><strong>FP å¯å­å¨</strong>ï¼</li>
</ul>
<p>å¯ä»¥ç®åçè§£ä¸ºï¼è¿æ¯ CPU éçä¸ä¸ªç©çé¨ä»¶ï¼æ Ignition çèææéï¼ã</p>
<ul>
<li><strong>FP ä¸­çåå®¹</strong>ï¼</li>
</ul>
<p>FPä¸­çåå®¹å°±æ¯ ä¸ä¸ªåå­å°åã</p>
<p>è¿ä¸ªåå­å°åæ¯ä¸ªæéï¼æåå½åæ å¸§ä¸­çä¸ä¸ªå­æ®µï¼</p>
<p>åæ¶ï¼è¿ä¸ªåå­å°å/æéï¼ä¹æ¯å½åæ å¸§ç <strong>âé¶ç¹â</strong>ãå³ <code>Offset = 0</code>ã</p>
<ul>
<li><strong>FP æåçåå­å°åéå­çåå®¹</strong>ï¼</li>
</ul>
<p>é£ä¹ è¿ä¸ªæ å¸§ä¸­çå­æ®µï¼éé¢çåå®¹æ¯ä»ä¹ï¼</p>
<p><strong>ç­æ¡æ¯ï¼Caller's FP (è°ç¨èç FP)ã</strong></p>
<p>å³ï¼ä¸ä¸å±æ å¸§çåºåå°åã</p>
<p><strong>è¿åæ¶ä¹æ¯âæ åæº¯âçåçï¼</strong></p>
<ul>
<li>å½å FP æå <code>Saved FP</code>ã</li>
<li><code>Saved FP</code> éå­ç <code>ä¸ä¸å± FP</code>ã</li>
<li><code>ä¸ä¸å± FP</code> éå­ç <code>ä¸ä¸å± FP</code>ã</li>
<li>...</li>
<li>è¿å°±å½¢æäºä¸æ¡<strong>é¾è¡¨</strong>ãè°è¯å¨ï¼Debuggerï¼å°±æ¯é¡ºçè¿æ¡é¾å­ï¼ä¸å±å±å¾ä¸ç¬ï¼ææå°åºäºå®æ´çè°ç¨æ ã</li>
</ul>
<ol start="3">
<li><strong>åç§»é (Offset) æ¯æä¹ç¡®å®çï¼</strong></li>
</ol>
<p>ææäº FP æ¯é¶ç¹ï¼é£ä¹ï¼å¯¹äºåæ°ååéçå¯»åï¼å°±éå¸¸å®¹æçè§£äºã</p>
<p>è®©æä»¬ç«å¨ FP è¿ä¸ªé¶ç¹ï¼å¼å§å·¡è§ï¼</p>
<p><strong>A. å¾ä¸çï¼Caller çä¸çéäº§ (å ä¸ºæä»¬ä½¿ç¨é«å°åå¨ä¸ï¼ä½å°åå¨ä¸çæ¨¡å¼)</strong></p>
<p>è¿éæ¯å°å <strong>å¢å </strong> çæ¹åï¼Offset æ¯ <strong>æ­£æ° +</strong>ï¼ï¼å ä¸ºæä»¬å¨å¾é«å°åèµ°ã</p>
<ul>
<li><strong>Offset     +0 (<code>[FP + 0]</code>)</strong>ï¼ å°±æ¯èä¸ãè¿éå­çæ¯ <strong>Saved FP</strong>ã</li>
<li><strong>Offset     +8 (<code>[FP + 8]</code>)</strong>ï¼ <strong>å¾ä¸</strong> èµ° 1 æ ¼ã è¿éæ¯ <strong>Return Address</strong>ã <em>(ä¸ºä»ä¹æ¯ +8ï¼å ä¸ºå¾é«å°åèµ°äº 8 å­èã)</em></li>
<li><strong>Offset     +16 (<code>[FP + 16]</code>)</strong>ï¼ <strong>åå¾ä¸</strong> èµ° 1 æ ¼ã è¿éæ¯ <strong>Receiver (this)</strong>ã <em>(æ³¨ï¼è¿æ¯é·æä¸å¨çä¸åº§ï¼ç¦» FP æè¿çåæ°ã)</em></li>
<li><strong>Offset     +24 (<code>[FP + 24]</code>)</strong>ï¼ <strong>åå¾ä¸</strong> èµ° 1 æ ¼ã è¿éæ¯ <strong>ç¬¬ä¸ä¸ªæ¾å¼åæ° (Arguments a0)</strong>ã <em>(æ³¨ï¼å¦æææ´å¤åæ° a1, a2... ä¼ç»§ç»­å¾ä¸æå¨ +32, +40...)</em></li>
</ul>
<p><strong>B. å¾ä¸çï¼Callee èªå·±çèµäº§ (ä½å°ååº)</strong></p>
<p>å³äºåç§»éçå·ä½å¼ï¼å¨åé¢ï¼ç¹å«è¯´ææ¯ç¨äº  <strong>ç¤ºæ</strong>  ï¼  V8æºç ä¸­çåç§»å¦ä¸ï¼ææ¶å¯ä»¥ä½ä¸ºç¡®å®å¼ï¼ä½æ¯ä»¥åå¾æ<strong>å¯è½ä¼æ´æ¹</strong>ã</p>
<blockquote>
<p><strong>FP (åºå)</strong></p>
<p><strong>[FP - 8]</strong>: <code>StandardFrameConstants::kContextOffset</code> -&gt; <strong>Context</strong></p>
<p><strong>[FP - 16]</strong>: <code>StandardFrameConstants::kFunctionOffset</code> -&gt; <strong>Function</strong></p>
<p><strong>[FP - 24]</strong>: <code>InterpretedFrameConstants::kBytecodeArrayFromFp</code> -&gt; <strong>BytecodeArray</strong> (è§£éå¨ç¹æ)</p>
<p><strong>[FP - 32]</strong>: <code>InterpretedFrameConstants::kBytecodeOffsetFromFp</code> -&gt; <strong>BytecodeOffset (PC)</strong></p>
<p><strong>[FP - 40]</strong>: <code>InterpretedFrameConstants::kRegisterFileFromFp</code> -&gt; <strong>r0 (Register 0)</strong> (å·¥ä½åºèµ·ç¹)</p>
</blockquote>
<p>è¿éä¹éè¦å ä¸ä¸ªéå®ï¼</p>
<p><strong>å¨ 64 ä½ç³»ç»ä¸ï¼Ignition è§£éå¨æ å¸§çåºå®å¤´é¨å¸å±éå¸¸å¦ä¸ï¼</strong></p>
<p>è¿éæ¯å°å <strong>åå°</strong> çæ¹åï¼Offset æ¯ <strong>è´æ° -</strong>ï¼ï¼å ä¸ºæä»¬å¨å¾ä½å°åï¼æ é¡¶ï¼æ¹åç¬ã</p>
<ul>
<li><strong>Offset     -8 (<code>[FP - 8]</code>)</strong>ï¼ <strong>å¾ä¸</strong> ç¬ 1 æ ¼ã è¿éæ¯ <strong>Context</strong>ã <em>(ä¸ºä»ä¹æ¯è´æ°ï¼å ä¸ºç¦»å¤©ç©ºæ´è¿äºï¼å°ååå°äºã)</em></li>
<li><strong>Offset    -16 (<code>[FP - 16]</code>)</strong>ï¼ <strong>åå¾ä¸</strong> ç¬ 1 æ ¼ã è¿éæ¯ <strong>Function</strong>ã</li>
<li><strong>Offset    -24 (<code>[FP - 24]</code>)</strong>ï¼ <strong>åå¾ä¸</strong> ç¬ 1 æ ¼ã è¿éæ¯ <strong>BytecodeArray</strong>ã</li>
<li><strong>Offset    -32 (<code>[FP - 32]</code>)</strong>ï¼ <strong>åå¾ä¸</strong> ç¬ 1 æ ¼ã è¿éæ¯ <strong>BytecodeOffset (PC)</strong>ã <em>(æ³¨ï¼å°è¿éï¼åºå®å¤´é¨ç»æ)</em></li>
<li><strong>Offset     -40 (<code>[FP - 40]</code>)</strong>ï¼ <strong>åå¾ä¸</strong> ç¬ 1 æ ¼ã ç»äºå°äº <strong>å·¥ä½åº</strong>ãè¿éæ¯ <strong>r0</strong>ã</li>
</ul>
</li>
</ul>
<hr>
<p>ignitionè§£éå¨çç¬¬ä¸é¨åï¼å·²ç»å®æäºï¼åé¢å°æ¯ignitionç¯çç¬¬äºé¨åBytecodeGeneratorã</p>
<p>æ¬æ³æ§å¶ç¯å¹ï¼ä½æ¯ä¾æ§æ¯å°äºä¸ä¸ä¸åå¤å­ï¼è¿é¨ååå®¹ï¼é¾åº¦ä¸å¤§ï¼æ·±åº¦ä¸æ·±ï¼ä¸»è¦é½æ¯ä¸äºåç½®ååºç¡ç¥è¯ãæå´è¶£çæåï¼å¤è¯»å éï¼é½å¯ä»¥çè§£çã æè§å¾  èµ·ç æ¯è§£æç¯å®¹æçè§£å¤äºã</p>
<p>æ¬æé¦åäºï¼ <a href="https://juejin.cn/user/565561530002222/posts" target="_blank" rel="noopener nofollow">æéç¤¾åº</a></p>
<p>åæ­¥åè¡¨äºï¼ <a href="https://blog.csdn.net/f20171110?type=blog" target="_blank" rel="noopener nofollow">csdn</a></p>
<p><a href="https://www.cnblogs.com/f20171110" target="_blank">åå®¢å­</a></p>
<p><strong>ç å­è½ä¸æ ç¥è¯èç»çæ¢³çæ´æ¯ä¸æ ï¼ä½æ¯ç¥è¯çä¼ æ­æ´éè¦ï¼</strong></p>
<p><strong>æ¬¢è¿è½¬è½½ï¼è¯·ä¿æå¨æå®æ´ã</strong></p>
<p><strong>è°¢ç»çæ®µæå½ã</strong></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-04 19:19">2026-02-04 19:19</span>&nbsp;
<a href="https://www.cnblogs.com/f20171110">ç¨æ·æ°</a>&nbsp;
éè¯»(<span id="post_view_count">3</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19576264);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19576264', targetLink: 'https://www.cnblogs.com/f20171110/p/19576264', title: 'V8å¼æ ç²¾åæ¼«æ¸¸æå--Ignitionç¯(ä¸) æä»¤ æ å¸§ æ§½ä½ è°ç¨çº¦å® åå­å¸å± åºç¡åå®¹' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ LLVM Passå¿«éå¥é¨(å)ï¼ä»£ç ææ¡© ]]></title>
    <link>https://www.cnblogs.com/ClownLMe/p/19575719</link>
    <guid>7b29632e2a98bce4814cd7b604ea715d</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ClownLMe/p/19575719" title="åå¸äº 2026-02-04 17:49">
    <span role="heading" aria-level="2">LLVM Passå¿«éå¥é¨(å)ï¼ä»£ç ææ¡©</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        ä»0å°1ï¼å¿«éå¥é¨ LLVM pass ç¼å
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ä»£ç ææ¡©">ä»£ç ææ¡©</h1>
<p>é¡¹ç®éæ±ï¼å¨å½æ°è¿è¡æ¶æå°åºè¿è¡çå½æ°å</p>
<h1 id="é¡¹ç®ç®å½å¦ä¸">é¡¹ç®ç®å½å¦ä¸</h1>
<pre><code>/MyProject
âââ CMakeLists.txt # CMake éç½®æä»¶
âââ build/ #æå»ºç®å½
â   âââ test.c #æµè¯ç¼è¯ä»£ç 
âââ mypass3.cpp # pass é¡¹ç®ä»£ç 
</code></pre>
<h3 id="ä¸æµè¯ä»£ç ç¤ºä¾">ä¸ï¼æµè¯ä»£ç ç¤ºä¾</h3>
<p><strong>test.c</strong></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

void func_A() {
    int a = 1;
}

void func_B() {
    func_A();
}

int main() {
    printf("hello world!\n");
    func_A();
    func_B();
    return 0;
}
</code></pre>
<h3 id="äºç¼åpass">äºï¼ç¼åPass</h3>
<p><mark>å¶ä»çåºå®çæ¨¡æ¿ä¹åæç« æ³¨éæï¼è¿éæåªæ³¨éå½åé¡¹ç®éè¦çé¨å</mark><br>
<strong>ä»£ç æµç¨ï¼</strong> éåæä»¤å¹¶å¹é<code>ADD</code>æä»¤-&gt;æ¿æ¢ä¸º<code>sub</code>æä»¤</p>
<pre><code class="language-cpp">#include "llvm/IR/PassManager.h"
#include "llvm/Passes/PassBuilder.h"
#include "llvm/Passes/PassPlugin.h"
#include "llvm/Support/raw_ostream.h"
#include "llvm/IR/Function.h"
#include "llvm/IR/BasicBlock.h"
#include "llvm/IR/Instruction.h"
#include "llvm/IR/Instructions.h"
#include "llvm/IR/IRBuilder.h" 

using namespace llvm;

namespace {

struct mypass3 : public PassInfoMixin&lt;mypass3&gt; {
    
    PreservedAnalyses run(Function &amp;F, FunctionAnalysisManager &amp;) {
        //è¿æ»¤å½æ°
        //è¿æ»¤æprintfåprintfæå³çå½æ°ï¼é²æ­¢å¨printfä¸­æå¥printfé æéå½ï¼æ­»å¾ªç¯ï¼
        if(F.isDeclaration() || F.getName().starts_with("_") || F.getName().contains("printf")){
            return PreservedAnalyses::all();
        }
        errs() &lt;&lt; "handle func:" &lt;&lt; F.getName() &lt;&lt; "\n";
		
		//è·åæ¨¡å
        Module *M = F.getParent();
        //è·åæ¨¡åä¸ä¸æ
        //ä¸ä¸æä¸­åå«äºæ°æ®çç±»å
        LLVMContext &amp;Ctx = M-&gt;getContext();
        
        //ä¸é¢æ¯åå»ºå½æ°ï¼ç±»æ¯javaåå°ï¼æèfridaçhook
        //å®ä¹printfçåæ°ç±»åï¼ç¸å½äºå½æ°æ¬å·ä¸­çåå®¹ï¼è¿éçPointerTypeæ¯æéç±»å
        std::vector&lt;Type*&gt; printfArgs = {PointerType::getUnqual(Ctx)};
		//å®ä¹å½æ°ç±»åï¼è¿éç¸å½äºå®ä¹ï¼int (void*, ...)
        FunctionType *printfType = FunctionType::get(
            Type::getInt32Ty(Ctx),//å½æ°è¿åå¼ç±»å
            printfArgs,//å½æ°çåæ°ç±»å(vector)
            true//æ¯å¦æ¯å¯ååæ°
        );
		//å¦æprintfå­å¨åå¼ç¨ï¼å¦æä¸å­å¨ï¼ååå»ºä¸ä¸ªæ°çprintf
        FunctionCallee printfFunc = M-&gt;getOrInsertFunction("printf", printfType);
		
		//ä¸é¢æ¯æå¥å½æ°
		//å°ä¿®æ¹çä½ç½®å®ä½å°è¦ææ¡©å½æ°çå¤´é¨
        IRBuilder&lt;&gt; builder(&amp;F.getEntryBlock().front());
        //å£°æå¨å±åéï¼è¿éæ¯è¦ä¼ ç»printfçæ ¼å¼åå­ç¬¦ä¸²ï¼
        Value* formatStr = builder.CreateGlobalStringPtr("&gt;&gt; enter function %s &lt;&lt;\n", "my_format");
        //å£°æå¨å±åéï¼è¿éå®ä¹äºå½æ°åç§°çå­ç¬¦ä¸²åé
        Value* funcName = builder.CreateGlobalStringPtr(F.getName(), "my_func_name");
        //å°ä¸é¢å®ä¹çå®éåæ°ä¼ å¥
        std::vector&lt;Value*&gt; printfArgsVec = {formatStr, funcName};
        //åå»ºå½æ°è°ç¨
        builder.CreateCall(printfFunc, printfArgsVec);
        
        return PreservedAnalyses::none();
    }
};

} 

extern "C" LLVM_ATTRIBUTE_WEAK ::llvm::PassPluginLibraryInfo
llvmGetPassPluginInfo() {
    return {
        LLVM_PLUGIN_API_VERSION,
        "mypass3",
        "v0.1",
        [](PassBuilder &amp;PB) {
            PB.registerPipelineParsingCallback(
                [](StringRef Name, FunctionPassManager &amp;FPM,
                   ArrayRef&lt;PassBuilder::PipelineElement&gt;) {
                    if (Name == "mypass3") {
                        FPM.addPass(mypass3());
                        return true;
                    }
                    return false;
                });
        }};
}
</code></pre>
<h3 id="ä¸passçæå»º">ä¸ï¼Passçæå»º</h3>
<p><mark><strong>ä¸é¢å¼ç¨çæ¯ä¹åæç« çåå®¹</strong></mark><br>
æå»ºLLVM Passéè¦å<code>CMakeLists.txt</code>æå»ºå£°æ</p>
<h5 id="1-éç½®cmakeéç½®æä»¶">1. éç½®CMakeéç½®æä»¶</h5>
<p><strong>CMakeLists.txt</strong><br>
ä¸é¢ç<code>cmake</code>éç½®å¯ä»¥ç´æ¥æ¿å»ç¨ï¼æå·²ç»æ æ³¨å¥½éè¦ä¿®æ¹çä½ç½®</p>
<pre><code class="language-python">#cmake çæ¬ï¼å¯éè¿ cmake --version å¤æ­
cmake_minimum_required(VERSION 4.1.1) #----&gt;ä¿®æ¹ cmakeçæ¬å·
#é¡¹ç®åå­
project(mypass3) #----&gt;ä¿®æ¹ é¡¹ç®åç§°

#å¯¼å¥é¡¹ç®ç LLVM cmake éç½®æä»¶è·¯å¾(å¦ææ ¹æ®æä¹åæç« å®è£è¿éå°±ç¸å)
set(LLVM_DIR "D:/LLVM/llvm-project/build/lib/cmake/llvm")#----&gt;ä¿®æ¹ llvm cmakeéç½®è·¯å¾
#å¯»æ¾ LLVM çåæä»¶
#REQUIRED æ¾ä¸å° LLVM ååæ­¢æå»º
#å¼ºå¶ä½¿ç¨ LLVM å®è£æ¶çæçéç½®æä»¶è¿è¡å®ä½
find_package(LLVM REQUIRED CONFIG)
#å° LLVM ç CMake æ¨¡åè·¯å¾æ·»å å°å½å CMake æç´¢è·¯å¾ä¸­ï¼ä»¥ä¾¿åç»­ä½¿ç¨ include(AddLLVM)ã
list(APPEND CMAKE_MODULE_PATH "${LLVM_CMAKE_DIR}")

#å¼å¥ LLVM æä¾çä¸ç¨ CMake å®
include(AddLLVM)
#å° LLVM çå¤´æä»¶ç®å½ï¼å¦ llvm/IR/Function.hï¼å å¥ç¼è¯å¨çæç´¢è·¯å¾
include_directories(${LLVM_INCLUDE_DIRS})
#å¯¼å¥ LLVM ç¼è¯æ¶ä½¿ç¨çå®å®ä¹
add_definitions(${LLVM_DEFINITIONS})
#è®¾ç½® C++ æ åä¸º C++17ã(è¿éå¦æä¸ç¨17ç¼è¯ä¼æ¥é)
set(CMAKE_CXX_STANDARD 17)
#å¼ºå¶è¦æ±å¿é¡»æ¯æ C++17ï¼å¦æç¼è¯å¨ä¸æ¯æåå¤±è´¥ã
set(CMAKE_CXX_STANDARD_REQUIRED ON)

#åå»ºä¸ä¸ªæ¨¡ååçåº(.dll)
add_library(mypass3 MODULE mypass3.cpp) #----&gt;ä¿®æ¹ é¡¹ç®åç§°ï¼æä»¶å
#windowsä¸ç¨ä¼æ¥éï¼å¯¼åºç¬¦å·
#LLVM Pass éè¦æ´é²ä¸äºç¹å®çå¥å£ç¹ï¼å¦ getAnalysisUsageï¼ç» opt å·¥å·è°ç¨ã
set_target_properties(mypass3 PROPERTIES WINDOWS_EXPORT_ALL_SYMBOLS ON) #----&gt;ä¿®æ¹ é¡¹ç®åç§°
# æå®è¯¥ Pass éè¦é¾æ¥ç LLVM æ ¸å¿ç»ä»¶ã 
# LLVMCore: æä¾ IRãFunctionãModule ç­æ ¸å¿ç±»ã 
# LLVMSupport: æä¾åç§è¾å©å·¥å·ç±»ï¼å¦ errs() è¾åºï¼ã
target_link_libraries(mypass3 LLVMCore LLVMSupport) #----&gt;ä¿®æ¹ é¡¹ç®åç§°ï¼æä»¶å  
# ä¸ºè¯¥ç®æ è®¾ç½®ç¹å®çç¼è¯å¨éé¡¹ã 
# /utf-8: åè¯ MSVC ç¼è¯å¨ä½¿ç¨ UTF-8 ç¼ç å¤çæºä»£ç ï¼é²æ­¢ä¸­ææ³¨éå¼èµ·çä¹±ç æç¼è¯éè¯¯ã  
target_compile_options(mypass3 PRIVATE /utf-8)#----&gt;ä¿®æ¹ é¡¹ç®åç§°ï¼æä»¶å
</code></pre>
<h5 id="2ç¼è¯å¹¶æå»ºpass">2.ç¼è¯å¹¶æå»ºPass</h5>
<p><strong>æå¼visual studio<code>çå·¥ä½å°ï¼æè¿éæ¯</code>x64 Native Tools Command Prompt for VS 2022`</strong></p>
<p>è¿å°<code>build</code>ç®å½</p>
<pre><code class="language-bash">#æå»ºé¡¹ç®
#å¶ä¸­-DCMAKE_BUILD_TYPE=RelWithDebInfoä¸éä¼æ¥éï¼ç±äºæä¹åç¼è¯çæ¯å¸¦ç¬¦å·çrelaseçæ¬
cmake -G "Ninja"  -DCMAKE_BUILD_TYPE=RelWithDebInfo ..
#ç¼è¯
ninja
</code></pre>
<p>æååºç°ä¸é¢æç¤ºï¼å³ä¸ºç¼è¯æå</p>
<pre><code class="language-bash">[2/2] Linking CXX shared module mypass3.dll
</code></pre>
<h3 id="åä½¿ç¨ææ¡©passå¯¹æºç è¿è¡ææ¡©">åï¼ä½¿ç¨ææ¡©Passå¯¹æºç è¿è¡ææ¡©</h3>
<p>è¿å°<code>build</code>ç®å½</p>
<pre><code class="language-bash">#æ.cæä»¶ç¼è¯ä¸º.ll
#-O1 ä½¿ç¨O1ä¼åï¼è¿éæå°è¯-O0ä¸ä¼åï¼ä¼å¯¼è´æçpassæ æ³åºç¨ï¼
#-Xclang -disable-llvm-passes ä¸ä½¿ç¨é»è®¤çpassä¼å
clang -S -emit-llvm -O1 -Xclang -disable-llvm-passes test.c -S -o test.ll

#ä½¿ç¨pass
opt -load-pass-plugin=mypass3.dll -passes=mypass3  test.ll -S -o test_opt.ll

#ç¼è¯ä½¿ç¨passåçexe
clang test_opt.ll -o test_opt.exe
#ç¼è¯ä½¿ç¨passåçexe
clang test.ll -o test.exe
</code></pre>
<p><strong>è¾åºç»æ</strong><br>
<code>è¿è¡test.exe</code>ï¼<strong>ä¸ä½¿ç¨</strong>passï¼è¾åºç»æå¦ä¸ï¼</p>
<pre><code>hello world!
</code></pre>
<p><code>è¿è¡test_opt.exe</code>ï¼<strong>ä½¿ç¨</strong>passåï¼è¾åºç»æå¦ä¸ï¼</p>
<pre><code>&gt;&gt; enter function main &lt;&lt;
hello world!
&gt;&gt; enter function func_A &lt;&lt;
&gt;&gt; enter function func_B &lt;&lt;
&gt;&gt; enter function func_A &lt;&lt;
</code></pre>
<p><strong>æä»¬æåå¨æä»¬è°ç¨å½æ°ä¹åææ¡©ï¼æå°åºè°ç¨çå½æ°</strong></p>
<p><strong>å¦æâ¤åæ¬¢â¤æ¬ç³»åæç¨ï¼å°±ç¹ä¸ªå³æ³¨å§ï¼åç»­ä¸å®ææ´æ°~</strong></p>


</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/ClownLMe/" target="_blank">ClownLMe</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/ClownLMe/p/19575719" target="_blank">https://www.cnblogs.com/ClownLMe/p/19575719</a></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.004166666666666667" data-date-updated="2026-02-04 17:55">2026-02-04 17:49</span>&nbsp;
<a href="https://www.cnblogs.com/ClownLMe">ClownLMe</a>&nbsp;
éè¯»(<span id="post_view_count">12</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19575719);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19575719', targetLink: 'https://www.cnblogs.com/ClownLMe/p/19575719', title: 'LLVM Passå¿«éå¥é¨(å)ï¼ä»£ç ææ¡©' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ é¸¿èåºç¨å¼åUIåºç¡ç¬¬äºèï¼é¸¿èåºç¨ç¨åºæ¡æ¶æ ¸å¿è§£æä¸å®æ ]]></title>
    <link>https://www.cnblogs.com/san-xiu/p/19575201</link>
    <guid>7726aaf5f2a8c9e25099652324dffb06</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/san-xiu/p/19575201" title="åå¸äº 2026-02-04 16:36">
    <span role="heading" aria-level="2">é¸¿èåºç¨å¼åUIåºç¡ç¬¬äºèï¼é¸¿èåºç¨ç¨åºæ¡æ¶æ ¸å¿è§£æä¸å®æ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="å­¦ä¹ ç®æ ">å­¦ä¹ ç®æ </h2>
<ol>
<li>å»ºç«é¸¿èåºç¨âå®è§-å¾®è§âå®æ´è®¤ç¥ï¼æç¡®åºç¨ãåºç¨ç¨åºåãHAP/HSPãç»ä»¶ãé¡µé¢çå±çº§å³ç³»ï¼çè§£ Stage æ¨¡åç¼è¯æä¸è¿è¡ææ¦å¿µçå¯¹åºé»è¾ï¼</li>
<li>æ¸æ°åºå Stage æ¨¡åä¸ FA æ¨¡åçæ ¸å¿å·®å¼ï¼çè§£ Stage æ¨¡åå¨èµæºå©ç¨ãéç½®ç®¡çãè·¨ç«¯ééç­å®éå¼ååºæ¯ä¸­çæ ¸å¿ä¼å¿ï¼</li>
<li>ææ¡ Stage æ¨¡åè¿ç¨/çº¿ç¨ç®¡çæºå¶ï¼çè§£ UIAbility ä¸ ExtensionAbility ççº¿ç¨éç¦»ç¹æ§ï¼ä»¥åå¤çº¿ç¨å¼åçæ ¸å¿æè·¯ï¼</li>
<li>çç»ææ¡ UIAbility å¨ module.json5 ä¸­çæ ¸å¿éç½®é¡¹åè§åï¼ç²¾åå®ä½ Stage å·¥ç¨æ ¸å¿æä»¶å¹¶çæ¸ä¾èµé¾è·¯ï¼</li>
<li>è½ç¬ç«å®æåºç¨åç§°/å¾æ ä¿®æ¹ãUIAbility éç½®è°æ´ãé¡µé¢å è½½è·¯å¾åæ¢ç­å®æï¼ç»åå·¥ç¨ç¼è¯æºå¶éªè¯ææå¹¶ææ¥åºç¡éç½®ä¸ç¼è¯éè¯¯ã</li>
</ol>
<p>ä¸ä¸èæä»¬ææ¡äºåºç¨éç½®ç­¾åçæºè°è¯ï¼æ¬èå¼å§ä»âåºç¨æ´ä½æ¶æâåå¥ï¼èç¦ Stage æ¨¡åæ ¸å¿äº¤äºç»ä»¶ UIAbility æ ¸å¿è½åå±å¼ï¼ç»åå·¥ç¨ç¼è¯æºå¶ï¼å¸®å©æå»ºé¸¿èåºç¨å¼ååºç¡è®¤ç¥ä½ç³»ï¼ä¸ºåç»­åºç¨çå½å¨æãContext ä¸ä¸æãè¿ç¨éä¿¡ç­è¿é¶åå®¹å­¦ä¹ æä¸åºç¡ã</p>
<h2 id="ä¸åé¡¾é¸¿èç³»ç»æ¶æ">ä¸ãåé¡¾é¸¿èç³»ç»æ¶æ</h2>
<p>é¸¿èç³»ç»éç¨åå±æ¶æï¼å±åå±ï¼å¼åèæ ¸å¿å·¥ä½éä¸­å¨é¡¶å±ä¸¤å±ï¼</p>
<ol>
<li><strong>åºç¨å±</strong>ï¼é¢åç¨æ·çåºç¨è½½ä½ï¼åå«ä¸¤ç§å½¢æ
<ul>
<li>åçåºç¨ï¼åºäº ArkTS å¼åï¼æ§è½æä¼ï¼è½æ·±åº¦è°ç¨åå¸å¼è½åï¼æ¯é¸¿èçææ ¸å¿ï¼</li>
<li>åæå¡ï¼åå®è£ãè½»éä¾¿æ·ï¼éåé«é¢æ¬¡ãä½çå­åºæ¯ï¼å¦æ«ç æ¯ä»ï¼ï¼</li>
</ul>
</li>
<li><strong>æ¡æ¶å±</strong>ï¼å¼åèç¦å¨æ¡æ¶å±ï¼æä¾ ArkUI ç»ä»¶ãç¶æç®¡çãè·¯ç±/å¯¼èªè·³è½¬ç­æ ¸å¿è½åï¼åç»­ç»ä»¶å¼åãå¸å±è®¾è®¡åä¾èµæ­¤å±ï¼</li>
<li><strong>ç³»ç»æå¡å±</strong>ï¼å°è£åå¸å¼è½åãè®¾å¤ç®¡çç­åºç¡æå¡ï¼å¼åèéè¿ API è°ç¨å³å¯ï¼æ éå³æ³¨åºå±å®ç°ï¼</li>
<li><strong>åæ ¸å±</strong>ï¼è´è´£è¿ç¨è°åº¦ãåå­ç®¡çç­åºå±æä½ï¼å¼åèæ éæ·±å¥æ¥è§¦ã</li>
</ol>
<p><strong>å¾ 1ï¼é¸¿èç³»ç»æ¶æå¾</strong> - å±ç¤ºåå±æ¶æå±çº§å³ç³»ï¼æ æ³¨å¼åèæ ¸å¿å³æ³¨çåºç¨å±ä¸æ¡æ¶å±ã</p>
<p><img alt="é¸¿èç³»ç»æ¶ææå­¦çæ¬" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3730991/202601/3730991-20260102093207059-982384169.png" class="lazyload"></p>
<blockquote>
<p>HarmonyOS 5.0 å¼å§å½»åºå®æ Linux åæ ¸åå®åå¼æ¾æºä»£ç é¡¹ç®ï¼AOSPï¼çå¨é¢æ¿æ¢ï¼éç¨çº¯é¸¿èåæ ¸ï¼HarmonyOS Kernelï¼ï¼å®ç°å¨æ èªç ãæ¬é¶æ®µææåå®¹ååºäºé¸¿è 5.0~6.0 çæ¬è¿è¡åºç¨å¼åè®²è§£ã</p>
</blockquote>
<h2 id="äºç¨åºæ¡æ¶æå¡ability-kit">äºãç¨åºæ¡æ¶æå¡ï¼Ability Kitï¼</h2>
<h3 id="ä¸æ ¸å¿å®ä¹">ï¼ä¸ï¼æ ¸å¿å®ä¹</h3>
<p>Ability Kitï¼ç¨åºæ¡æ¶æå¡ï¼æ¯é¸¿èç³»ç»ä¸ºåºç¨æä¾çæ ¸å¿è¿è¡æ¶åºç¡æ¡æ¶ï¼æ½è±¡æç¼åºç¨å¼åæéæ ¸å¿è½åï¼æä¾æ ååç»ä»¶ä½ç³»åè¿è¡æºå¶ã<strong>æ ¸å¿ä»·å¼æ¯è®©å¼åèåºäºç»ä¸æ¨¡åå¼ååºç¨ï¼åæ¶ä¿éåºç¨å¨å¤è®¾å¤ãå¤åºæ¯ä¸çå¼å®¹æ§ä¸æ§è½</strong>ã</p>
<h3 id="äºæ ¸å¿è½åä¸ä½¿ç¨åºæ¯">ï¼äºï¼æ ¸å¿è½åä¸ä½¿ç¨åºæ¯</h3>
<table>
<thead>
<tr>
<th>è½åèå´</th>
<th>å·ä½åå®¹</th>
<th>å¸åä½¿ç¨åºæ¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>çå½å¨æä¸è¿ç¨ç®¡ç</td>
<td>åºç¨/ç»ä»¶è¿ç¨åå»ºéæ¯ãçå½å¨æè°åº¦</td>
<td>å¤ Module åºç¨å¼åï¼HAP/HSP åå·¥å®ç°åè½</td>
</tr>
<tr>
<td>ç»ä»¶äº¤äºè½å</td>
<td>ç»ä»¶é´/åºç¨é´è·³è½¬ãè·¨è®¾å¤æµè½¬</td>
<td>åå¬åºç¨åå¯å¨è§é¢ä¼è®®ç»ä»¶ãè´­ç©åºç¨è·³è½¬æ¯ä»åºç¨ãè§é¢è·¨è®¾å¤æµè½¬</td>
</tr>
<tr>
<td>åºç¡æ¯æè½å</td>
<td>ä¸ä¸æç¯å¢ãç³»ç»äºä»¶çå¬ãå¯å¨æ¡æ¶ãæå¾æ¡æ¶ç­</td>
<td>åºç¨å¿«æ·æ¹å¼éç½®ãç¨åºè®¿é®æ§å¶ãå¯ç èªå¨å¡«å</td>
</tr>
</tbody>
</table>
<h3 id="ä¸æ ¸å¿ç¹å¾">ï¼ä¸ï¼æ ¸å¿ç¹å¾</h3>
<ol>
<li><strong>æ ååå¼åèå¼</strong>ï¼æ½è±¡åºç¨å¼åéç¨è½åï¼æä¾ç»ä¸çç»ä»¶ä½ç³»ãçå½å¨æè§åï¼éä½è·¨è®¾å¤/è·¨çæ¬ééææ¬ï¼</li>
<li><strong>é«æèµæºè°åº¦</strong>ï¼ç»ä¸ç®¡çåºç¨è¿ç¨/çº¿ç¨ï¼ä¼åç»ä»¶å¯å¨ãåå­å ç¨ç­æ§è½ææ ï¼</li>
<li><strong>ç³»ç»è½åå°è£</strong>ï¼åç½®æå¾æ¡æ¶ãå¯å¨æ¡æ¶ãæµè½¬è½åç­ï¼æ éå¼åèæå¨å¯¹æ¥åºå±ç³»ç» APIï¼</li>
<li><strong>å¤åºæ¯æ¯æ</strong>ï¼éè¿ ExtensionAbility è¦çå¤ä»½ãè¾å¥æ³ãå¡çç­æ  UI/è½» UI åºæ¯ï¼å¹³è¡¡åè½æ©å±ä¸ç³»ç»ç®¡æ§ã</li>
</ol>
<h3 id="åæ ¸å¿å³è">ï¼åï¼æ ¸å¿å³è</h3>
<ul>
<li><strong>ArkUI</strong>ï¼UIAbility ç»ä»¶ä¸­å¯ä½¿ç¨ ArkUI çç»ä»¶ãäºä»¶ãå¨æãç¶æç®¡çç­è½åå®ç°çé¢å¼åï¼</li>
<li><strong>ArkTS</strong>ï¼æä¾è¯­è¨è¿è¡æ¶è½åï¼æ¯æ Ability Kit çä»£ç æ§è¡ï¼</li>
<li><strong>Hvigor</strong>ï¼é¸¿èå®æ¹æå»ºå·¥å·ï¼ä¸º Ability Kit ç¸å³ç»ä»¶ä¸éç½®æä¾ç¼è¯æå»ºè½åï¼å®ç°ä»£ç ä¸éç½®çå·¥ç¨åè½å°ã</li>
</ul>
<h2 id="ä¸é¸¿èåºç¨æ¨¡å">ä¸ãé¸¿èåºç¨æ¨¡å</h2>
<h3 id="ä¸æ ¸å¿å®ä¹ä¸ææè¦ç´ ">ï¼ä¸ï¼æ ¸å¿å®ä¹ä¸ææè¦ç´ </h3>
<p>åºç¨æ¨¡åæ¯ Ability Kit å¯¹åºç¨å¼åè½åçæ½è±¡å°è£ï¼å®ä¹åºç¨çç»ä»¶ä½ç³»ãè¿è¡æºå¶ãéç½®è§èç­æ ¸å¿è§åï¼æ ¸å¿ææè¦ç´ å¦ä¸ï¼</p>
<table>
<thead>
<tr>
<th>ææè¦ç´ </th>
<th>æ ¸å¿ä½ç¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>åºç¨ç»ä»¶</td>
<td>åºç¨è¿è¡å¥å£ï¼éè¿çå½å¨æåè°æç¥ç¶æåå</td>
</tr>
<tr>
<td>è¿ç¨/çº¿ç¨æ¨¡å</td>
<td>å®ä¹è¿ç¨/çº¿ç¨çåå»ºãéæ¯åéä¿¡æ¹å¼</td>
</tr>
<tr>
<td>ä»»å¡ç®¡çæ¨¡å</td>
<td>å®ä¹ä»»å¡åå»ºãéæ¯åä¸ç»ä»¶çå³èï¼ä»ç³»ç»åºç¨ï¼</td>
</tr>
<tr>
<td>åºç¨éç½®æä»¶</td>
<td>å­å¨åºç¨/ç»ä»¶éç½®ãæéç­ä¿¡æ¯ï¼ä¾ç¼è¯/è¿è¡é¶æ®µä½¿ç¨</td>
</tr>
</tbody>
</table>
<h3 id="äºæ¼è¿åç¨fa-æ¨¡å--stage-æ¨¡å">ï¼äºï¼æ¼è¿åç¨ï¼FA æ¨¡å â Stage æ¨¡å</h3>
<table>
<thead>
<tr>
<th>æ¨¡åç±»å</th>
<th>ééçæ¬</th>
<th>æ ¸å¿ç¶æ</th>
<th>å®æ¹å¼åä¼å¿</th>
</tr>
</thead>
<tbody>
<tr>
<td>FA æ¨¡å</td>
<td>API 7~8</td>
<td>å·²åæ­¢æ´æ°</td>
<td>-</td>
</tr>
<tr>
<td>Stage æ¨¡å</td>
<td>API 9+</td>
<td>ä¸»æ¨ä¸é¿ææ¼è¿</td>
<td>1. ç»ä»¶èè´£æ¸æ°ï¼å¼åæçæ´é«ï¼2. èµæºå ç¨æ´ä½ï¼å¯å¨éåº¦æ´å¿«ï¼3. è·¨ç«¯ééæ´ä¾¿æ·ï¼4. ç³»ç»è½åéææ´ç®åï¼5. ç¼è¯åå±è®¾è®¡ï¼æ¯ææ¨¡åæéç¼è¯ï¼æåå¼åæç</td>
</tr>
</tbody>
</table>
<h3 id="ä¸fa-æ¨¡åä¸-stage-æ¨¡åæ ¸å¿å·®å¼">ï¼ä¸ï¼FA æ¨¡åä¸ Stage æ¨¡åæ ¸å¿å·®å¼</h3>
<table>
<thead>
<tr>
<th>å¯¹æ¯ç»´åº¦</th>
<th>FA æ¨¡å</th>
<th>Stage æ¨¡å</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç»ä»¶ä½ç³»</td>
<td>Page/Service/DataAbilityï¼å¿åå¯¹è±¡ï¼</td>
<td>UIAbility+ExtensionAbilityï¼ç±»ç»§æ¿ï¼</td>
</tr>
<tr>
<td>å¼ææºå¶</td>
<td>æ¯ä¸ªç»ä»¶ç¬äº« ArkTS å¼æå®ä¾</td>
<td>ææç»ä»¶å±äº«ä¸ä¸ª ArkTS å¼æå®ä¾</td>
</tr>
<tr>
<td>è¿ç¨æ¨¡å</td>
<td>ä¸»è¿ç¨+æ¸²æè¿ç¨</td>
<td>ä¸»è¿ç¨+å¯éç½®ç¬ç«è¿ç¨ï¼ExtensionAbilityæ¯æè¿ç¨èªå®ä¹ï¼</td>
</tr>
<tr>
<td>çº¿ç¨æ¨¡å</td>
<td>å¼æå®ä¾å¨éä¸»çº¿ç¨åå»ºï¼ä¸æ¯æè¿ç¨åå¯¹è±¡å±äº«</td>
<td>å¼æå®ä¾å¨ä¸»çº¿ç¨åå»ºï¼æ¯æè¿ç¨åå¯¹è±¡å±äº«</td>
</tr>
<tr>
<td>éç½®æä»¶</td>
<td>åä¸ config.jsonï¼æ··ç¼å¨å±/æ¨¡åéç½®ï¼</td>
<td>app.json5ï¼åºç¨çº§ï¼+ module.json5ï¼æ¨¡åçº§ï¼</td>
</tr>
<tr>
<td>ç¼è¯æºå¶</td>
<td>æ´ä½å·¥ç¨ç¼è¯ï¼ä¿®æ¹å±é¨ééæ°ç¼è¯å¨é¨</td>
<td>åå±ç¼è¯ï¼æ¯ææ¨¡å/å¨å±ç¼è¯ï¼æéç¼è¯ä¿®æ¹é¨åï¼æçæ´é«</td>
</tr>
</tbody>
</table>
<h3 id="åstage-æ¨¡åæ ¸å¿æ¶æä¸ç»æ">ï¼åï¼Stage æ¨¡åæ ¸å¿æ¶æä¸ç»æ</h3>
<h4 id="1-stage-æ¨¡åæ ¸å¿æ¶æå¾">1. Stage æ¨¡åæ ¸å¿æ¶æå¾</h4>
<p><strong>å¾ 2ï¼Stage æ¨¡åç¼è¯æ-è¿è¡ææ¶æå¾</strong> - å·¦ä¾§ä¸ºè¿è¡ææ¦å¿µï¼åºç¨å®ä¾åæµç¨ï¼ï¼å³ä¾§ä¸ºç¼è¯ææ¦å¿µï¼å¼åæåæµç¨ï¼ï¼å±ç¤ºâæ¨¡åâç»ä»¶âé¡µé¢âçæåä¸å®ä¾åå¯¹åºå³ç³»ã</p>
<p><img alt="Stageæ¨¡åå¼åæ¦è¿°" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3730991/202602/3730991-20260204163601834-1982599659.png" class="lazyload"></p>
<h4 id="2-æ ¸å¿ç»æåå">2. æ ¸å¿ç»æåå</h4>
<ol>
<li><strong>AbilityStage</strong>ï¼å¯éå®ç°ï¼è¥ä¸å®ç°ï¼ç³»ç»é»è®¤åå»ºï¼ï¼Entry/Feature ç±»å HAP çè¿è¡æ¶è½½ä½ï¼<strong>ä¸ä¸ª HAP å¯¹åºä¸ä¸ª AbilityStage å®ä¾</strong>ï¼è´è´£ HAP çåå§åãç»ä»¶åå»ºååãæ¨¡åçº§çå½å¨æç®¡çï¼</li>
<li><strong>UIAbility</strong>ï¼å¸¦ UI çæ ¸å¿äº¤äºç»ä»¶ï¼éè¿ WindowStage ç®¡ççªå£ï¼å®ç°ç¨æ·äº¤äºï¼</li>
<li><strong>ExtensionAbility</strong>ï¼é¢åç¹å®åºæ¯çæ©å±ç»ä»¶ï¼å¦ EntryBackupAbilityãInputMethodExtensionAbilityï¼ï¼æ¯ UIAbility çæ©å±ï¼ç¨äºæ çé¢çåå°è½åï¼å¦å¤ä»½ãè¾å¥æ³ï¼ï¼</li>
<li><strong>WindowStage</strong>ï¼ä¸ UIAbility å®ä¾ç»å®ççªå£ç®¡çå¨ï¼è´è´£çªå£åå»ºãéæ¯ï¼ä¸º ArkUI æä¾ç»å¶åºåï¼</li>
<li><strong>Context</strong>ï¼æ´¾çç±»ï¼ApplicationContext/AbilityStageContext/UIAbilityContextï¼ä¸ºä¸åå±çº§æä¾è¿è¡æèµæºè°ç¨ãæéç®¡çç­è½åï¼</li>
<li><strong>ä¸çº§çå½å¨æ</strong>ï¼Applicationï¼åºç¨çº§ï¼â AbilityStageï¼æ¨¡åçº§ï¼â UIAbility/ExtensionAbilityï¼ç»ä»¶çº§ï¼ï¼ç± Ability Kit ç»ä¸è°åº¦ï¼å®ç°èµæºç²¾ç»åç®¡çã</li>
</ol>
<h4 id="3-æ ¸å¿å±çº§å³ç³»è¯´æ">3. æ ¸å¿å±çº§å³ç³»è¯´æ</h4>
<ol>
<li>å±çº§å³èï¼Applicationï¼åºç¨å¨å±ï¼â AbilityStageï¼HAP æ¨¡åï¼â UIAbility/ExtensionAbilityï¼ç»ä»¶ï¼ï¼ä¾æ¬¡ä¾èµåå»ºï¼</li>
<li>ææå³ç³»ï¼UIAbilityâWindowStageâWindowâArkUI Pageï¼ä¸åå±çº§åææå¯¹åº Contextï¼</li>
<li>å¯¹åºå³ç³»ï¼Application â Bundleï¼AbilityStage â HAPï¼1:1 ç»å®ï¼ã</li>
</ol>
<pre><code># ç¼è¯æï¼å¼å/æåï¼
åºç¨ç¨åºåï¼Bundleï¼ â æ¨¡åï¼HAP/HSPï¼ â ç»ä»¶ï¼UIAbility/ExtensionAbilityï¼ â é¡µé¢ï¼Pageï¼

# è¿è¡æï¼å®è£/å¯å¨ï¼
Applicationï¼åºç¨å¨å±å®ä¾ï¼ â AbilityStageï¼HAP æ¨¡åå®ä¾ï¼ â ç»ä»¶å®ä¾ â é¡µé¢æ¸²æ
</code></pre>
<h3 id="äºstage-æ¨¡åå¼åä¸è¿è¡å¨æµç¨">ï¼äºï¼Stage æ¨¡åå¼åä¸è¿è¡å¨æµç¨</h3>
<h4 id="1-å¼åé¶æ®µ">1. å¼åé¶æ®µ</h4>
<p>å¼åèåºäº Stage æ¨¡åå®æåºç¨åè½å¼åä¸éç½®ï¼æ ¸å¿å·¥ä½åæ¬ï¼</p>
<ul>
<li><strong>åºç¨ç»ä»¶å¼å</strong>ï¼éè¿ UIAbility ç»ä»¶å¼åå¸¦çé¢çç¨æ·äº¤äºæ¨¡åï¼å¦åºç¨ä¸»çé¢ï¼ï¼éè¿ ExtensionAbility ç­ç»ä»¶å¼ååç±»æ©å±åè½æ¨¡åï¼</li>
<li><strong>æ¨¡åè§£è¦è®¾è®¡</strong>ï¼ä¸ºåå°ä¸ååè½æ¨¡åé´çä¾èµåè¦åï¼å¯å° UIAbility ååç±» ExtensionAbility çå®ç°åå«æ¾å¨ä¸åç HAP åä¸­ï¼åæ¶å°ä¸¤èå±åä¾èµçéç¨åè½æ¾å¨ HSP åä¸­ï¼</li>
<li><strong>éç½®æä»¶ç¼å</strong>ï¼å¨ app.json5 ä¸­éç½®åºç¨åç§°ãçæ¬å·ãåºç¨å¾æ ç­å¨å±ä¿¡æ¯ï¼å¨ module.json5 ä¸­éç½®å¯¹åº HAP åä¸çç»ä»¶æ¸åãç»ä»¶æéãè¿ç¨å½å±ç­æ¨¡åçº§ä¿¡æ¯ï¼éç½®ä¿¡æ¯ä¼å¨åºç¨ç¼è¯ãå®è£æ¶è¢«ç³»ç»è§£æï¼ä¾¿äºç³»ç»åå¶ä»æ¨¡åè¯å«ãäº¤äºã</li>
</ul>
<h4 id="2-è¿è¡é¶æ®µ">2. è¿è¡é¶æ®µ</h4>
<p>å½åºç¨å®è£å°è®¾å¤è¿è¡æ¶ï¼ç³»ç»éè¿ä¸å¥åºç¨è¿ç¨åçº¿ç¨çç®¡çæºå¶ï¼ç¡®ä¿åè½çæåºè¿è¡ï¼</p>
<ul>
<li>è¿ç¨æ¯åºç¨è¿è¡çåºç¡ååï¼è´è´£èµæºåéåéç¦»ï¼</li>
<li>çº¿ç¨æ¯è¿ç¨åçæ§è¡ååï¼è´è´£å·ä½ä»£ç é»è¾çæ§è¡ï¼</li>
<li>Ability Kit ç»ä¸ç®¡æ§è¿ç¨/çº¿ç¨çåå»ºãéæ¯åè°åº¦ï¼ä¿éåºç¨ç¨³å®è¿è¡ã</li>
</ul>
<h4 id="3-è¿ç¨æ¨¡å">3. è¿ç¨æ¨¡å</h4>
<ul>
<li>åºç¡è§åï¼UIAbility ç»ä»¶é»è®¤è¿è¡å¨åºç¨ä¸»è¿ç¨ä¸­ï¼ ExtensionAbility ç»ä»¶<strong>è¿ç¨è¡ä¸ºå¯éç½®</strong>ï¼å¯éè¿<code>module.json5</code>ä¸­ç<code>process</code>å­æ®µè¿è¡éç½®ï¼</li>
<li>éç½®æ¹å¼ï¼å¨ ExtensionAbility ç»ä»¶çéç½®èç¹ä¸­æ·»å <code>process</code>å­æ®µï¼å¼ä»¥<code>:</code>å¼å¤´è¡¨ç¤ºéç½®ä¸ºç¬ç«è¿ç¨è¿è¡ï¼æªéç½®åé»è®¤ä¸ UIAbility åè¿ç¨è¿è¡ï¼</li>
<li>éä¿¡è§åï¼ExtensionAbility ä¸ UIAbility åè¿ç¨æ¶ä¸ºçº¿ç¨éç¦»ç¶æï¼æ°æ®åèµæºä¸ç´æ¥äºéï¼ç¬ç«è¿ç¨æ¶ééè¿è·¨è¿ç¨éä¿¡æºå¶å®ç°æ°æ®äº¤äºï¼</li>
<li>æ ¸å¿ä»·å¼ï¼è¿ç¨å¯éç½®æ§å¼é¡¾äºåºç¨æ§è½åç¨³å®æ§ââè½»éæ©å±ç»ä»¶ä¸ä¸»è¿ç¨å±äº«èµæºï¼åå°è¿ç¨å¼éï¼æ ¸å¿/é«éç¦»æ§æ©å±ç»ä»¶ç¬ç«è¿ç¨è¿è¡ï¼é¿ååä¸ç»ä»¶å¼å¸¸å½±åæ´ä¸ªåºç¨ã</li>
</ul>
<h4 id="4-ç»ä»¶éä¿¡æºå¶">4. ç»ä»¶éä¿¡æºå¶</h4>
<p>é¸¿èæä¾å¤å¥éä¿¡æºå¶ï¼ééä¸åç»ä»¶ç±»åãä¸åè¿ç¨å½å±çéä¿¡åºæ¯ï¼æ ¸å¿åç±»å¦ä¸ï¼</p>
<ul>
<li><strong>è¿ç¨åéä¿¡</strong>ï¼éç¨äºåä¸è¿ç¨åç UIAbility ä¸ ExtensionAbilityãUIAbility ä¸é¡µé¢é´ï¼ä¼åä½¿ç¨<strong>EventHub</strong>ï¼è½»éé«æãæ éå¤æéç½®ï¼</li>
<li><strong>è·¨è¿ç¨éä¿¡</strong>ï¼éç¨äºè·¨åºç¨ãç¬ç«è¿ç¨ç HAP ä¹é´ãç¬ç«è¿ç¨ ExtensionAbility ä¸ UIAbility ä¹é´ï¼ä½¿ç¨<strong>IPC</strong>åºç¡éä¿¡æºå¶ï¼</li>
<li><strong>ExtensionAbility ä¸å±éä¿¡</strong>ï¼ä¸åç±»åç ExtensionAbility æä¾ä¸å±éä¿¡æ¥å£ï¼ééèªèº«ä¸å¡åºæ¯ï¼æ ¸å¿æ¥å£å¦ä¸ï¼
<ul>
<li>ServiceExtensionAbilityï¼éè¿<code>connectServiceExtensionAbility()</code>å»ºç«è¿æ¥ï¼å®ç°ä¸»ä»ç»ä»¶çååéä¿¡ï¼</li>
<li>DataShareExtensionAbilityï¼éè¿<code>createDataShareHelper()</code>åå»ºå©æå®ä¾ï¼å®ç°æ°æ®çå¢å æ¹æ¥å±äº«ã</li>
</ul>
</li>
</ul>
<blockquote>
<p>çº¯ ArkTS åè¿ç¨åºç¨ï¼ä¼åä½¿ç¨ EventHub å®ç°ç»ä»¶/çº¿ç¨é´éä¿¡ï¼æ¶åç¬ç«è¿ç¨æè·¨åºç¨äº¤äºæ¶ï¼æ ¹æ®ç»ä»¶ç±»åéæ©å¯¹åºä¸å±éä¿¡æ¥å£æåºç¡ IPC æºå¶ã</p>
</blockquote>
<h4 id="5-çº¿ç¨æ¨¡å">5. çº¿ç¨æ¨¡å</h4>
<ul>
<li>åºç¡æ¯æï¼Stage æ¨¡åæä¾ workerãtaskpool ç­æºå¶æ¯æåºç¨å¤çº¿ç¨å¼ååºæ¯ï¼</li>
<li>å¼åå»ºè®®ï¼åºç¨è¥æå¤æçèæ¶é»è¾ï¼å¦å¤§æ°æ®å¤çãç½ç»è¯·æ±ãå¤æè®¡ç®ï¼ï¼å»ºè®®éè¿åå»º worker çº¿ç¨çæ¹å¼å¤çï¼é¿åé»å¡ä¸»çº¿ç¨ï¼UI çº¿ç¨ï¼ï¼ä¿éåºç¨çé¢æµçæ§ï¼</li>
<li>çº¿ç¨éç¦»ï¼æ è®º ExtensionAbility ä¸ UIAbility åè¿ç¨è¿æ¯ç¬ç«è¿ç¨ï¼å¶åé¨åä¸ºçº¿ç¨éç¦»è®¾è®¡ï¼èæ¶é»è¾åéæ¾å¨å­çº¿ç¨æ§è¡ï¼ä¸å¯ç´æ¥å¨ç»ä»¶ä¸»çº¿ç¨å¤çã</li>
</ul>
<h3 id="å­stage-æ¨¡åå¼åæµç¨">ï¼å­ï¼Stage æ¨¡åå¼åæµç¨</h3>
<table>
<thead>
<tr>
<th>æ ¸å¿ä»»å¡</th>
<th>å³é®åå®¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>åºç¨ç»ä»¶å¼å</td>
<td>å¼å UIAbility/ExtensionAbilityï¼æåè½æåå°ä¸å HAPï¼éç¨è½åæ½ç¦»å° HSP</td>
</tr>
<tr>
<td>è¿ç¨/çº¿ç¨æ¨¡åéé</td>
<td>åºäºä¸å¡éæ±éç½® ExtensionAbility è¿ç¨å½å±ï¼èæ¶é»è¾éè¿ worker å¤çï¼éµå¾ªçº¿ç¨éç¦»è§å</td>
</tr>
<tr>
<td>éç½®æä»¶ç¼å</td>
<td>éç½® app.json5ï¼å¨å±ï¼/module.json5ï¼æ¨¡åï¼çåºç¨/ç»ä»¶/è¿ç¨ä¿¡æ¯ï¼ä¿è¯è·¯å¾ä¸è¯­æ³åè§</td>
</tr>
<tr>
<td>éä¿¡æºå¶å®ç°</td>
<td>æè¿ç¨å½å±åç»ä»¶ç±»åéæ© EventHubãä¸å±æ¥å£æ IPC å®ç°éä¿¡</td>
</tr>
<tr>
<td>ææéªè¯</td>
<td>åºäºæ¨¡åç¼è¯éªè¯å±é¨ä¿®æ¹ææï¼å¨å±ç¼è¯çæå®æ´åºç¨å</td>
</tr>
</tbody>
</table>
<h2 id="åé¸¿èåºç¨ç»æç»æ">åãé¸¿èåºç¨ç»æç»æ</h2>
<h3 id="ä¸åºç¨ç¨åºåbundle">ï¼ä¸ï¼åºç¨ç¨åºåï¼Bundleï¼</h3>
<ul>
<li>å®ä¹ï¼é¸¿èåºç¨ååãå®è£çæå°åä½ï¼åç¼<code>.app</code>ï¼ï¼ç±å¨å±ç¼è¯æ´åææ HAP/HSP æ¨¡åç¼è¯äº§ç©çæï¼</li>
<li>ææï¼Entry HAPï¼å¿éï¼åºç¨å¯å¨å¥å£ï¼ãFeature HAPï¼å¯éï¼æ©å±åè½ï¼ãHSPï¼å¯éï¼ä»£ç /èµæºå±äº«ï¼ï¼</li>
<li>å¤åæºå¶ï¼1 ä¸ª Bundle å¯åå«å¤ä¸ª HAPï¼Entry HAP æå¤ 1 ä¸ªï¼Feature HAP ä¸éï¼ï¼HAP ä¹é´éè¿ HSP å±äº«ä»£ç /èµæºï¼åæ¨¡åå¯ç¬ç«ç¼è¯ï¼æç»æ´åè³ Bundleã</li>
</ul>
<h3 id="äºæ¨¡åhaphsp">ï¼äºï¼æ¨¡åï¼HAP/HSPï¼</h3>
<table>
<thead>
<tr>
<th>æ¨¡åç±»å</th>
<th>æ ¸å¿ä½ç¨</th>
<th>å³é®ç¹å¾</th>
<th>è¿è¡æå³èå®ä¾</th>
<th>å¸åä½¿ç¨åºæ¯</th>
<th>ç¼è¯ç¹æ§</th>
</tr>
</thead>
<tbody>
<tr>
<td>Entry HAP</td>
<td>åºç¨ä¸»æ¨¡åï¼æä¾å¯å¨å¥å£</td>
<td>å¿éï¼åå«ä¸» UIAbilityï¼å¯åç¬å®è£è¿è¡</td>
<td>å¯¹åº 1 ä¸ª AbilityStage å®ä¾</td>
<td>åºç¨ä¸»çé¢ãæ ¸å¿äº¤äºåè½</td>
<td>å¯ç¬ç«ç¼è¯ä¸º HAP åï¼æ¯æåç¬è¿è¡éªè¯</td>
</tr>
<tr>
<td>Feature HAP</td>
<td>æ©å±åè½æ¨¡å</td>
<td>å¯éï¼ä¾èµ Entry HAP è¿è¡ï¼æ¯ææéå è½½</td>
<td>å¯¹åº 1 ä¸ª AbilityStage å®ä¾</td>
<td>å¤ä»½ãè¾å¥æ³ç­æ©å±åè½</td>
<td>å¯ç¬ç«ç¼è¯ï¼éç»å Entry HAP è¿è¡</td>
</tr>
<tr>
<td>HSP</td>
<td>ä»£ç /èµæºå±äº«å</td>
<td>å¯éï¼æ ç¬ç«è¿è¡ç»ä»¶ï¼ä»ç¨äºæ¨¡åé´å¤ç¨</td>
<td>æ å¯¹åºç AbilityStage å®ä¾</td>
<td>éç¨å·¥å·ç±»ãå¸¸éå®ä¹ãå¬å±èµæº</td>
<td>ç¼è¯ä¸ºå±äº«åï¼è¢«å¶ä» HAP ä¾èµè°ç¨</td>
</tr>
</tbody>
</table>
<blockquote>
<p>å³äºåçç±»åä»¥åä½¿ç¨åå»ºæ¹æ³ï¼æä»¬ä¼å¨é¡¹ç®é¶æ®µå­¦ä¹ ææ¡ã</p>
</blockquote>
<h3 id="ä¸æ ¸å¿ç»ä»¶stage-æ¨¡åä¸¤ç±»ç»ä»¶">ï¼ä¸ï¼æ ¸å¿ç»ä»¶ï¼Stage æ¨¡åä¸¤ç±»ç»ä»¶ï¼</h3>
<table>
<thead>
<tr>
<th>ç»ä»¶ç±»å</th>
<th>æ ¸å¿ä½ç¨</th>
<th>äº¤äºæ¹å¼</th>
<th>å¼åæ¹å¼</th>
<th>è¿ç¨é»è®¤éç½®</th>
<th>ç»åç±»å/ç¤ºä¾æä»¶</th>
</tr>
</thead>
<tbody>
<tr>
<td>UIAbility</td>
<td>åºç¨å¥å£+çªå£ç®¡çï¼å®ç°ç¨æ·äº¤äº</td>
<td>æ¡é¢å¯å¨ãå¯è§åäº¤äº</td>
<td>é¢åå¯¹è±¡å¼åï¼ç±»ç»§æ¿ï¼</td>
<td>åºç¨ä¸»è¿ç¨</td>
<td>EntryAbility.etsï¼åºç¨ä¸»çé¢ï¼</td>
</tr>
<tr>
<td>ExtensionAbility</td>
<td>å¤ä»½/è¾å¥æ³ç­æ  UI/è½» UI åºæ¯</td>
<td>ç³»ç»/äºä»¶è§¦å</td>
<td>é¢åå¯¹è±¡å¼åï¼æ´¾çç±»å®ç°ï¼</td>
<td>åºç¨ä¸»è¿ç¨</td>
<td>EntryBackupAbility.etsï¼å¤ä»½ï¼ãDataShareExtensionAbility.etsï¼æ°æ®å±äº«ï¼</td>
</tr>
</tbody>
</table>
<h2 id="äºå·¥ç¨ç»æ">äºãå·¥ç¨ç»æ</h2>
<p>å»¶ç¨ä¸ä¸èåå»ºçé¡¹ç®<code>FirstApplication</code>ï¼åºäºé¸¿è 5.0 API 12 + DevEco Studio 6.0+ï¼ï¼å·¥ç¨æ ¸å¿ç»æå¦ä¸ï¼å¶ä¸­<code>build</code>ç®å½ä¸ºç¼è¯åèªå¨çæï¼<code>build-profile.json5</code>å<code>hvigorfile.ts</code>ä¸ºé¸¿è Hvigor æå»ºå·¥å·çæ ¸å¿ç¼è¯éç½®æä»¶ï¼å®ç°å·¥ç¨ä¸æ¨¡åçåå±ç¼è¯ç®¡çï¼</p>
<pre><code>FirstApplication                    
âââ AppScope/                # åºç¨å¨å±éç½®ç®å½
â   âââ resources/           # åºç¨å¨å±èµæºç®å½
â   â   âââ base/            # å¨å±åºç¡èµæºç®å½
â   â   â   âââ element/     # å¨å±å­ç¬¦ä¸²ãé¢è²ç­éç½®
â   â   â   â   âââ string.json
â   â   â   âââ media/       # å¨å±åªä½èµæºï¼å±å å¾æ éç½®ãååºå¾æ ï¼
â   â   â   â   âââ app_icon.png // èªå®ä¹çåºç¨å¾æ 
â   â   â   â   âââ background.png
â   â   â   â   âââ foreground.png
â   â   â   â   âââ layered_image.json
â   â   â   âââ profile/     # å¨å±éç½®æä»¶ï¼å¦é¡µé¢è·¯ç±ãå¤ä»½éç½®ç­ï¼
â   âââ app.json5            # å¨å±éç½®æä»¶ï¼ååãçæ¬ãå¾æ ãåç§°ç­ï¼ä¾å¨å±ç¼è¯è§£æï¼
âââ entry/                   # Entry HAPä¸»æ¨¡åï¼æ ¸å¿å¼åç®å½ï¼
â   âââ build/               # æ¨¡åç¼è¯äº§ç©ç®å½ï¼ç¼è¯åèªå¨çæï¼å­æ¾entryæ¨¡åHAPåï¼
â   âââ src/
â   â   âââ main/            # entryæ¨¡åæ ¸å¿æºç ç®å½
â   â   â   âââ ets/         # ArkTSä»£ç ç®å½
â   â   â   â   âââ entryability/ # UIAbilityæ ¸å¿ç»ä»¶ç®å½
â   â   â   â   â   âââ EntryAbility.ets
â   â   â   â   âââ entrybackupability/ # å¤ä»½æ©å±ç»ä»¶ç®å½
â   â   â   â   â   âââ EntryBackupAbility.ets
â   â   â   â   âââ pages/   # é¡µé¢ç®å½
â   â   â   â       âââ Index.ets
â   â   â   â       âââ Home.ets
â   â   â   âââ resources/   # æ¨¡åçº§éæèµæºç®å½ï¼ç¼è¯æ¶èªå¨æåä¼åï¼
â   â   â   â   âââ base/    # åºç¡èµæºç®å½ï¼é»è®¤ä¸»é¢ï¼
â   â   â   â   â   âââ element/ # æ¨¡åçº§åç´ éç½®
â   â   â   â   â   âââ media/   # æ¨¡åçº§åªä½èµæº
â   â   â   â   â   â   âââ background.png
â   â   â   â   â   â   âââ foreground.png
â   â   â   â   â   â   âââ startIcon.png // é»è®¤ççªå£å¾æ 
â   â   â   â   â   â   âââ layered_image.json
â   â   â   â   âââ dark/    # æ·±è²æ¨¡å¼èµæºç®å½
â   â   â   â   âââ rawfile/ # åçæä»¶ç®å½ï¼æ éç¼è¯çéææä»¶ï¼
â   â   â   âââ module.json5 # Entry HAPæ¨¡åéç½®æä»¶ï¼ç»ä»¶ãæéãè¿ç¨ç­ï¼ä¾æ¨¡åç¼è¯è§£æï¼
â   âââ mock/                # æ¨¡ææ°æ®ç®å½ï¼æµè¯ç¨ï¼
â   âââ ohosTest/            # OpenHarmonyæµè¯ç®å½
â   âââ test/                # æ¬å°æµè¯ç®å½
â   âââ .gitignore           # Gitå¿½ç¥æä»¶éç½®
â   âââ build-profile.json5  # æ¨¡åç¼è¯éç½®æä»¶ï¼æå®SDKçæ¬ãç­¾åå³èç­ç¼è¯è§åï¼
â   âââ hvigorfile.ts        # æ¨¡åç¼è¯èæ¬ï¼Hvigoræå»ºå·¥å·æ¨¡åçº§æ§è¡å¥å£ï¼
âââ build/                   # å·¥ç¨å¨å±ç¼è¯äº§ç©ç®å½ï¼ç¼è¯åèªå¨çæï¼å­æ¾å¨å±æ´åçHAP/APPåï¼
âââ build-profile.json5      # å·¥ç¨å¨å±ç¼è¯éç½®æä»¶ï¼ç»ä¸ç®¡çæææ¨¡åç¼è¯è§åãç¼è¯æ¨¡å¼ï¼
âââ hvigorfile.ts            # å·¥ç¨å¨å±ç¼è¯èæ¬ï¼Hvigoræå»ºå·¥å·å¨å±æ§è¡å¥å£ï¼è§¦åæææ¨¡åç¼è¯ï¼
âââ oh-package.json5         # ohpmä¾èµéç½®æä»¶ï¼ç¼è¯åèªå¨è§£æä¸è½½ä¾èµï¼
âââ oh-package-lock.json5    # ohpmä¾èµçæ¬éå®æä»¶
</code></pre>
<blockquote>
<p>è¯´æï¼é¸¿èå·¥ç¨åºäº<strong>Hvigor</strong>ï¼é¸¿èå®æ¹èªç æå»ºå·¥å·ï¼å®ç°ç¼è¯ï¼éç¨<strong>æéç¼è¯</strong>ååï¼ä»ä¿®æ¹è¿çæ¨¡å/æä»¶ä¼éæ°ç¼è¯ï¼æªä¿®æ¹é¨åå¤ç¨åæç¼è¯äº§ç©ï¼æåå¼åæçï¼<code>build</code>ç®å½å é¤åå¯éè¿éæ°ç¼è¯çæï¼ä¸å½±åå·¥ç¨æºç ã</p>
</blockquote>
<h2 id="å­uiability-æ ¸å¿å®æ">å­ãUIAbility æ ¸å¿å®æ</h2>
<h3 id="ä¸æ ¸å¿å®ä½">ï¼ä¸ï¼æ ¸å¿å®ä½</h3>
<ol>
<li><strong>åºç¨å¥å£</strong>ï¼ç¨æ·ç¹å»åºç¨å¾æ åï¼ç³»ç»é¦ååå»ºå¹¶å¯å¨ UIAbility å®ä¾ï¼</li>
<li><strong>çªå£ç®¡çè½½ä½</strong>ï¼æ¯ä¸ª UIAbility å®ä¾å¯å¨åä¼åå»ºä¸ä¸ª WindowStageï¼çªå£ç®¡çå¨ï¼ï¼è´è´£çªå£çåå»ºãéæ¯ï¼å¹¶<strong>éè¿ WindowStage å è½½ ArkUI é¡µé¢</strong>ï¼</li>
<li><strong>å®ä¾æ¨¡å¼</strong>ï¼æ¯æåå®ä¾ãå¤å®ä¾ãæå®å®ä¾ç­éç½®ï¼éè¿ module.json5 ç<code>launchType</code>å­æ®µï¼ï¼æ»¡è¶³ä¸åä¸å¡åºæ¯éæ±ï¼</li>
<li><strong>ç¼è¯å³è</strong>ï¼UIAbility çç±»åãæä»¶è·¯å¾éä¸ module.json5 ä¸­<code>name</code>ã<code>srcEntry</code>éç½®å®å¨ä¸è´ï¼å¦åä¼å¯¼è´æ¨¡åç¼è¯å¤±è´¥ï¼æ æ³çæ HAP åï¼</li>
<li><strong>æéæ ¸å¿</strong>ï¼ä½ä¸ºåºç¨æ ¸å¿äº¤äºç»ä»¶ï¼UIAbility æ¯åºç¨æéç³è¯·åæ ¡éªçæ ¸å¿è½½ä½ï¼åå°å¯å¨å¶ä»ç»ä»¶éä¾èµä¸å±ç³»ç»æéã</li>
</ol>
<h3 id="äºæ ¸å¿éç½®">ï¼äºï¼æ ¸å¿éç½®</h3>
<h4 id="1-æ¨¡åçº§éç½®modulejson5">1. æ¨¡åçº§éç½®ï¼module.json5ï¼</h4>
<pre><code class="language-json">{
  "module": {
    "name": "entry", // æ¨¡ååç§°
    "type": "entry", // æ¨¡åç±»åï¼entry/feature/har/hsp
    "description": "$string:module_desc", // æ¨¡åæè¿°
    "mainElement": "EntryAbility", // é»è®¤å¯å¨ç»ä»¶
    "deviceTypes": [ // æ¯æçè®¾å¤ç±»å
      "phone"
    ],
    "deliveryWithInstall": true, // æ¯å¦éåºç¨å®è£äº¤ä»
    "installationFree": false, // æ¯å¦åå®è£
    "pages": "$profile:main_pages", // é¡µé¢è·¯ç±éç½®
    "abilities": [ // UIAbilityç»ä»¶éç½®
      {
        "name": "EntryAbility", // ç»ä»¶åç§°ï¼ä¸ä»£ç ç±»åä¸è´ï¼ç¼è¯æ ¡éªå³é®ï¼
        "srcEntry": "./src/main/ets/entryability/EntryAbility.ets", // å¥å£è·¯å¾ï¼å¿é¡»./å¼å¤´ï¼ç¼è¯æ ¡éªå³é®ï¼
        "description": "$string:EntryAbility_desc", // ç»ä»¶æè¿°
        "icon": "$media:layered_image", // ç»ä»¶å¾æ ï¼æ¨¡åçº§ï¼ä¸éåçæåµä¸ä¼åçæï¼
        "label": "$string:EntryAbility_label", // ç»ä»¶æ¾ç¤ºåç§°ï¼æ¨¡åçº§ï¼ä¼åçº§æ´é«ï¼
        "startWindowIcon": "$media:startIcon", // å¯å¨çªå£å¾æ 
        "startWindowBackground": "$color:start_window_background", // å¯å¨çªå£èæ¯
        "exported": true, // æ¯å¦åè®¸è·¨åºç¨è°ç¨
        "launchType": "singleton", // é»è®¤çå¯å¨æ¨¡å¼ï¼å¯ä»¥ä¸å
        "skills": [ // æ¡é¢å¾æ å¿éï¼ç¼ºå°åæ¡é¢æ åºç¨å¾æ 
          {
            "entities": [
              "entity.system.home" // æ¡é¢å¥å£æ è¯
            ],
            "actions": [
              "ohos.want.action.home" // æ¡é¢å¯å¨å¨ä½
            ]
          }
        ]
      }
    ],
    "extensionAbilities": [ // æ©å±ç»ä»¶éç½®
      {
        "name": "EntryBackupAbility", // å¤ä»½æ©å±ç»ä»¶åç§°
        "srcEntry": "./src/main/ets/entrybackupability/EntryBackupAbility.ets", 
        "type": "backup", // æ©å±ç±»åï¼backup/dataShare/inputMethodç­ï¼
        "exported": false, // ä»åé¨ä½¿ç¨
        "metadata": [ // æ©å±åæ°æ®
          {
            "name": "ohos.extension.backup", // åæ°æ®åç§°
            "resource": "$profile:backup_config" // åæ°æ®éç½®æä»¶
          }
        ]
      }
    ]
  }
}
</code></pre>
<h4 id="2-éç½®å³é®è§å">2. éç½®å³é®è§å</h4>
<ul>
<li><code>mainElement</code>ï¼Entry HAP å¿é¡»éç½®ä¸º UIAbilityï¼Feature HAP æ é»è®¤å¯å¨ç»ä»¶ï¼</li>
<li><code>name</code>ï¼ç»ä»¶åç§°å¿é¡»ä¸ä»£ç ä¸­å¯¼åºçç±»åä¸è´ï¼ä¸å¯éæä¿®æ¹ï¼ç¼è¯æ¶ä¼ä¸¥æ ¼æ ¡éªï¼</li>
<li><code>srcEntry</code>ï¼è·¯å¾éä»¥<code>./</code>å¼å¤´ï¼ä¸¥æ ¼å¹éæä»¶çç®å½/æä»¶åï¼åºåå¤§å°åï¼ï¼è·¯å¾éè¯¯ä¼ç´æ¥å¯¼è´ç¼è¯å¤±è´¥ï¼</li>
<li><code>exported</code>ï¼è·¨åºç¨è°ç¨çç»ä»¶éè®¾ä¸º trueï¼ä»åé¨ä½¿ç¨çç»ä»¶è®¾ä¸º false å³å¯ï¼</li>
<li><code>skills</code>ï¼ä» UIAbility ééç½®ï¼æ¡é¢å¾æ å±ç¤ºï¼ï¼ExtensionAbility æ ééç½®ï¼ç¼ºå¤±æéç½®ä¸å¨åæ¡é¢æ å¾æ ï¼ç¹å»å¾æ è¿å¥åºç¨è¯¦æé¡µï¼</li>
<li><code>type</code>ï¼ExtensionAbility å¿éå­æ®µï¼éä¸æ©å±ç±»åå¹éï¼å¦ backupãdataShareãinputMethod ç­ï¼ï¼</li>
<li><code>process</code>ï¼ExtensionAbility å¯ééç½®å­æ®µï¼ç¨äºè®¾ç½®è¿ç¨å½å±ï¼å¼ä»¥<code>:</code>å¼å¤´è¡¨ç¤ºç¬ç«è¿ç¨ï¼æªéç½®åé»è®¤ä¸ä¸»è¿ç¨åè¿ç¨ï¼</li>
<li>JSON è¯­æ³ï¼ç¦æ­¢æ«å°¾å¤ä½éå·ï¼éç½®é¡¹ãæä»¶/ç®å½åç§°ååºåå¤§å°åï¼è¯­æ³éè¯¯ä¼å¯¼è´ç¼è¯è§£æå¤±è´¥ã</li>
</ul>
<h4 id="3-å¨å±éç½®appjson5">3. å¨å±éç½®ï¼app.json5ï¼</h4>
<pre><code class="language-json">{
  "app": {
    "bundleName": "com.sanxiu.firstapp",
    "vendor": "example",
    "versionCode": 1000000,
    "versionName": "1.0.0",
    "icon": "$media:layered_image", // å¨å±åºç¨å¾æ 
    "label": "$string:app_name" // å¨å±åºç¨åç§°
  }
}
</code></pre>
<h4 id="4-å±å å¾æ éç½®layered_imagejson">4. å±å å¾æ éç½®ï¼layered_image.jsonï¼</h4>
<p><strong>è·¯å¾</strong>ï¼</p>
<ul>
<li>å¨å±ï¼AppScope/resources/base/media/layered_image.json</li>
<li>æ¨¡åçº§ï¼entry/src/main/resources/base/media/layered_image.json</li>
</ul>
<pre><code class="language-json">{
  "layered-image": {
    "background": "$media:background",
    "foreground": "$media:foreground"
  }
}
</code></pre>
<p><strong>æ ¸å¿è§å</strong>ï¼</p>
<ul>
<li>èµæºè¦çï¼ç¼è¯æ AppScope åæ¨¡ååéåèµæºï¼AppScope èµæºä¼åçº§æ´é«ï¼</li>
<li>æ¨¡åçº§ icon çæåæï¼UIAbility ç <code>skills</code> å­æ®µå¿é¡»åå«<code>entity.system.home</code>å<code>ohos.want.action.home</code>ï¼å¤ Ability æ¶å<code>mainElement</code>å¯¹åºéç½®ï¼</li>
<li>å¾æ å°ºå¯¸è§èï¼é¸¿èå±å å¾æ æ¨èåºç¡å°ºå¯¸ï¼foreground/background åä¸º<strong>1024Ã1024</strong>ï¼png æ ¼å¼ï¼éæèæ¯ï¼ï¼ç¼è¯æ¶ç³»ç»ä¼èªå¨ééä¸åè®¾å¤çå¾æ å°ºå¯¸ï¼æ éæå¨å¶ä½å¤å°ºå¯¸çæ¬ã</li>
</ul>
<h4 id="5-é¡µé¢è·¯ç±éç½®main_pagesjson">5. é¡µé¢è·¯ç±éç½®ï¼main_pages.jsonï¼</h4>
<p>éè¿ <code>New -&gt; Page -&gt; Empty Page</code> åå»ºçé¡µé¢ä¼èªå¨å¯¼å¥<code>main_pages.json</code>ï¼å¶ä»æ¹æ³åå»ºçé¡µé¢éè¦æå¨ç®¡çè·¯ç±éç½®ã</p>
<pre><code class="language-json">{
  "src": [
    "pages/Index",
    "pages/Home" // æ°å¢Homeé¡µé¢è·¯å¾
  ]
}
</code></pre>
<h3 id="ä¸é¡µé¢å è½½æ ¸å¿é»è¾entryabilityets">ï¼ä¸ï¼é¡µé¢å è½½æ ¸å¿é»è¾ï¼EntryAbility.etsï¼</h3>
<pre><code class="language-typescript">import UIAbility from '@ohos.app.ability.UIAbility';
import window from '@ohos.window';
import hilog from '@ohos.hilog';
import { AbilityConstant, Want } from '@kit.AbilityKit';
import { BusinessError } from '@ohos.base'; 

const DOMAIN: number = 0x0000;
const TAG: string = 'EntryAbility';

export default class EntryAbility extends UIAbility {
  // ç»ä»¶åå»ºæ¶è§¦åï¼å¯åå§åèµæº
  onCreate(want: Want, launchParam: AbilityConstant.LaunchParam): void {
    hilog.info(DOMAIN, TAG, 'EntryAbility onCreate called');
  }

  // ç»ä»¶éæ¯æ¶è§¦åï¼å¯éæ¾èµæº
  onDestroy() {
    hilog.info(DOMAIN, TAG, 'EntryAbility onDestroy called');
  }

  // çªå£åå»ºåè§¦åï¼ä»æ­¤å¤å¯å è½½é¡µé¢
  onWindowStageCreate(windowStage: window.WindowStage): void {
    hilog.info(DOMAIN, TAG, '--- onWindowStageCreate è§¦åï¼å è½½é¡µé¢ï¼---');
    // å è½½é¡µé¢
    windowStage.loadContent('pages/Index', (err) =&gt; {
      if (err.code) {
        hilog.error(DOMAIN, TAG, `é¡µé¢å è½½å¤±è´¥ï¼code=${err.code}, message=${err.message}`);
        return;
      }
      hilog.info(DOMAIN, TAG, 'Indexé¡µé¢å è½½æå');
    });
  }

  onWindowStageDestroy(): void {
    // Main window is destroyed, release UI related resources
    hilog.info(DOMAIN, TAG, '%{public}s', 'ä¸»çªå£å³å°éæ¯ï¼éæ¾UIç¸å³èµæº');
  }

  onForeground(): void {
    // Ability has brought to foreground
    hilog.info(DOMAIN, TAG, '%{public}s', 'åºç¨åæ¢è³åå°ï¼æ¢å¤ä¸å¡é»è¾');
  }

  onBackground(): void {
    // Ability has back to background
    hilog.info(DOMAIN, TAG, '%{public}s', 'åºç¨åæ¢è³åå°ï¼æåä¸å¡é»è¾ï¼ä¸å¯å¯å¨å¶ä»ç»ä»¶');
  }
}
</code></pre>
<h4 id="é¡µé¢å è½½è§å">é¡µé¢å è½½è§å</h4>
<ol>
<li>ä»è½éè¿<code>WindowStage.loadContent()</code>å è½½é¡µé¢ï¼</li>
<li>è¯¥æ¹æ³ä»å¯å¨<code>onWindowStageCreate</code>çå½å¨æä¸­è°ç¨ï¼</li>
<li>è·¯å¾éä¸¥æ ¼éµå¾ªâæ .etsåç¼ãåºåå¤§å°åãåºäºpagesæ ¹ç®å½çç¸å¯¹è·¯å¾âï¼ä¸éä¸<code>main_pages.json</code>ä¸­æ³¨åçè·¯å¾å®å¨ä¸è´ï¼å¦åç¼è¯éè¿ä½è¿è¡æ¶é¡µé¢å è½½å¤±è´¥ï¼</li>
<li>é¡µé¢æä»¶å½åãè·¯å¾éè¯¯ä¼å¯¼è´ç¼è¯æ¶èµæºæåå¤±è´¥ï¼æè¿è¡æ¶é¡µé¢ç©ºç½ã</li>
</ol>
<h3 id="åèªå®ä¹é¦é¡µå¼å">ï¼åï¼èªå®ä¹é¦é¡µå¼å</h3>
<h4 id="æ­¥éª¤-1åå»º-home-é¡µé¢pageshomeets">æ­¥éª¤ 1ï¼åå»º Home é¡µé¢ï¼pages/Home.etsï¼</h4>
<pre><code class="language-typescript">@Entry
@Component
struct Home {
  build() {
    Column({ space: 20 }) {
      Text('æçStageåºç¨é¦é¡µ')
        .fontSize(30)
        .fontWeight(FontWeight.Bold);
    }
    .width('100%')
    .height('100%')
    .justifyContent(FlexAlign.Center);
  }
}
</code></pre>
<h4 id="æ­¥éª¤-2æ³¨å-home-é¡µé¢å°è·¯ç±éç½®main_pagesjson">æ­¥éª¤ 2ï¼æ³¨å Home é¡µé¢å°è·¯ç±éç½®ï¼main_pages.jsonï¼</h4>
<p>æå¼è·¯å¾ï¼<code>entry/src/main/resources/base/profile/main_pages.json</code>ï¼å¨<code>src</code>æ°ç»ä¸­æ°å¢ Home é¡µé¢è·¯å¾ï¼ç¡®ä¿ä¸å®éæä»¶è·¯å¾ä¸è´ï¼</p>
<pre><code class="language-json">{
  "src": [
    "pages/Index",
    "pages/Home" // å¿é¡»æ³¨åï¼å¦åè¿è¡æ¶é¡µé¢å è½½å¤±è´¥
  ]
}
</code></pre>
<h4 id="æ­¥éª¤-3ä¿®æ¹é¡µé¢å è½½è·¯å¾entryabilityets">æ­¥éª¤ 3ï¼ä¿®æ¹é¡µé¢å è½½è·¯å¾ï¼EntryAbility.etsï¼</h4>
<p>å°<code>windowStage.loadContent('pages/Index', ...)</code>ä¿®æ¹ä¸ºï¼</p>
<pre><code class="language-typescript">// å è½½é¡µé¢
windowStage.loadContent('pages/Home').then(()=&gt;{
  hilog.info(DOMAIN, TAG, 'Homeé¡µé¢å è½½æå');
}).catch((err: BusinessError)=&gt;{
  hilog.error(DOMAIN, TAG, `é¡µé¢å è½½å¤±è´¥ï¼code=${err.code}, message=${err.message}`);
})
</code></pre>
<h4 id="ææéªè¯">ææéªè¯</h4>
<p><img alt="ä¿®æ¹å è½½é¡µé¢.png" loading="lazy" data-src="./%E8%B5%84%E6%BA%90%E5%9B%BE%E7%89%87/%E4%BF%AE%E6%94%B9%E5%8A%A0%E8%BD%BD%E9%A1%B5%E9%9D%A2.png" class="lazyload"></p>
<ol>
<li><strong>åºç¨åéªè¯</strong>ï¼æ­£å¸¸å±ç¤º<code>æçStageåºç¨é¦é¡µ</code>ï¼æ ç©ºç½ãæ æ¥éï¼</li>
<li><strong>æ¥å¿ç«¯éªè¯</strong>ï¼Logcat ä¸­ç­é<code>TAG:EntryAbility</code>ï¼å¯çå°âHomeé¡µé¢å è½½æåâç¸å³æ¥å¿ã</li>
</ol>
<h3 id="äºéç½®åºç¨åç§°åå¾æ ">ï¼äºï¼éç½®åºç¨åç§°åå¾æ </h3>
<h4 id="1-å±å å¾æ æ¹æ¡-æ¨¡åçº§éç½®">1. å±å å¾æ æ¹æ¡-æ¨¡åçº§éç½®</h4>
<p>é»è®¤å·¥ç¨ä¸­ï¼å¨å±åºç¨å¾æ ãæ¨¡åçº§å¾æ ãlayered-image åååèæ¯å¾çå½ååä¸è´ã<br>
è¥éè®©æ¨¡åçº§åºç¨å¾æ çæï¼éå é¤<strong>AppScope/resources/base/media/</strong> ç®å½ä¸ç layered-image ç¸å³æä»¶ï¼å«<code>layered_image.json</code>ã<code>background.png</code>ã<code>foreground.png</code>ï¼ï¼é¿åå¨å±éåèµæºè¦çï¼ä¸æ¨èï¼ã</p>
<p><strong>æ¨èæ¹æ¡</strong>ï¼ç¡®ä¿èµæºä¸éåï¼ä½¿ç¨èªå®ä¹å¾æ åç§°ï¼åæ¶ä¿è¯<code>module.json5</code> ä¸­éç½®äº<code>skills</code>å­æ®µï¼æ¡é¢å¾æ æ­£å¸¸æ¾ç¤ºåæï¼ï¼</p>
<ul>
<li>ç¡®è®¤ entry æ¨¡å<code>layered_image.json</code>éç½®ï¼è·¯å¾ï¼entry/src/main/resources/base/media/layered_image.jsonï¼ï¼</li>
<li>ç¡®ä¿ module.json5 ä¸­ UIAbility éç½®<code>"icon": "$media:layered_image"</code>ã</li>
</ul>
<h4 id="2-å±å å¾æ æ¹æ¡-å¨å±çº§éç½®">2. å±å å¾æ æ¹æ¡-å¨å±çº§éç½®</h4>
<p>ç´æ¥å°åºç¨å¾æ å¾çå½åä¸º<code>foreground</code>ï¼æèªå®ä¹ layered_image.json ä¸­<code>foreground</code>çèµæºå¼ç¨ä¸º<code>"foreground": "$media:app_icon"</code>ï¼</p>
<ol>
<li>éç½® AppScope ä¸<code>layered_image.json</code>ï¼è·¯å¾ï¼AppScope/resources/base/media/layered_image.jsonï¼ï¼</li>
<li>å¨<code>AppScope/app.json5</code>ä¸­éç½®å¨å±å¾æ ï¼<code>"icon": "$media:layered_image"</code>ã</li>
</ol>
<h4 id="3-åºç¨åç§°éç½®">3. åºç¨åç§°éç½®</h4>
<p>åºç¨åç§°çéç½®ä¼åçº§ï¼<strong>æ¨¡åçº§å« &gt; å¨å±çº§å«</strong>ãè¥éè®©å¨å±èµæºéç½®çåºç¨åç§°çæï¼éå¨ module.json5 ä¸­æ³¨é/å é¤ UIAbility ç label éç½®ï¼<code>"label": "$string:EntryAbility_label"</code>ã</p>
<ul>
<li>åç§°ä¿®æ¹åéæ£æ¥<code>string.json</code>ä¸­å¯¹åºå­ç¬¦æ¯å¦å­å¨ï¼å­ç¬¦ç¼ºå¤±ä¼å¯¼è´ç¼è¯æ¶èµæºè§£æéè¯¯ï¼</li>
<li>éç½®å®æåæ§è¡æ¨¡åç¼è¯ï¼éªè¯æ¡é¢åºç¨åç§°æ¯å¦æ´æ°ï¼</li>
<li>å¨å±åç§°è·¯å¾ï¼<code>AppScope/resources/base/element/string.json</code><pre><code class="language-json">{
  "string": [
    {
      "name": "app_name",
      "value": "ç¬¬ä¸ä¸ªåºç¨"
    }
  ]
}
</code></pre>
</li>
</ul>
<h4 id="è¿è¡éªè¯">è¿è¡éªè¯</h4>
<p>å°åºç¨è¿è¡è³çæº/æ¨¡æå¨ï¼æ¡é¢ç«¯åºç¨åç§°æ¾ç¤ºä¸º<code>ç¬¬ä¸ä¸ªåºç¨</code>ï¼å¾æ ä¸ºå¨å±éç½®çå±å æ ·å¼ã</p>
<p><img alt="ä¿®æ¹åºç¨åç§°åå¾æ " loading="lazy" data-src="https://img2024.cnblogs.com/blog/3730991/202602/3730991-20260204163027740-1003594037.png" class="lazyload"></p>
<h2 id="ä¸æ¸çæå»ºhapappå">ä¸ãæ¸çãæå»ºHAP/APPå</h2>
<p>é¸¿èå·¥ç¨åºäºHvigoræå»ºå·¥å·å®ç°æ¨¡åçº§ç¼è¯åå¨å±çº§æå»ºï¼<strong>é¡¶é¨èåæ Build</strong>ä¸ºæ ¸å¿æä½å¥å£ï¼è¦çãæ¸ç-ç¼è¯-æå»º-åå¸ãå¨æµç¨ï¼ä»¥ä¸ä¸ºç²¾åå®æåå·¥å·è¯´æï¼</p>
<h3 id="1-æ¸çæä½">1. æ¸çæä½</h3>
<ul>
<li>æä½ï¼é¡¶é¨èåæ <code>Build &gt; Clean Project</code></li>
<li>åè½ï¼å é¤å¨å·¥ç¨ææç¼è¯ç¸å³æä»¶ï¼ç¼å­ãä¸´æ¶äº§ç©ãå·²çæçåæä»¶ç­ï¼ï¼ä»ä¿çæºç ãéç½®åèµæºæä»¶</li>
<li>ä½ç¨ï¼è§£å³ç¼è¯å¼å¸¸ãç¼å­å²çªãéç½®ä¿®æ¹ä¸çæç­é®é¢ï¼æ¸çå®ææ§å¶å°æ¾ç¤º<code>BUILD SUCCESSFUL</code></li>
</ul>
<h3 id="2-æ¨¡åç¼è¯">2. æ¨¡åç¼è¯</h3>
<p>éç¨äºä¿®æ¹entryæ¨¡ååå¿«ééªè¯å±é¨ææï¼ä»çæåæ¨¡åHAPåï¼</p>
<ol>
<li>æä½ï¼éä¸­<code>entry</code>æä»¶ï¼ç¹å»é¡¶é¨èåæ <code>Build &gt; Make Module 'entry'</code></li>
<li>ç»æï¼æ§å¶å°æ¾ç¤º<code>BUILD SUCCESSFUL</code>å³ä¸ºæåï¼HAPåå­æ¾äº<code>entry/build/outputs/hap/</code></li>
<li>ä½ç¨ï¼å¿«ééªè¯entryæ¨¡åä»£ç /éç½®ä¿®æ¹ææ</li>
</ol>
<p><img alt="ç¼è¯entryæ¨¡å_20260203211239_98_1340" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3730991/202602/3730991-20260204163108603-2034847660.png" class="lazyload"></p>
<h3 id="3-æå»ºå®æ´åºç¨åç¨äºå®è£ååä¸æ¶">3. æå»ºå®æ´åºç¨åï¼ç¨äºå®è£/åå/ä¸æ¶ï¼</h3>
<p>éç¨äºçæº/æ¨¡æå¨é¨ç½²ãåºç¨åå¸ä¸æ¶ï¼æ´åå¨æ¨¡åçæå®æ´.appåï¼</p>
<ol>
<li>æä½ï¼é¡¶é¨èåæ <code>Build &gt; Build Hap(s)/APP(s) &gt; Build App(s)</code></li>
<li>ç»æï¼æ§å¶å°æ¾ç¤º<code>BUILD SUCCESSFUL</code>å³ä¸ºæåï¼.appåå­æ¾äº<code>build/outputs/app/</code>ï¼ä¸»æ¨¡åentryæåäº§åº.hapå</li>
<li>ä½ç¨ï¼çæå¯é¨ç½²/åå¸çå®æ´Bundleåºç¨å</li>
</ol>
<p><img alt="æå»ºåºç¨ç¨åºå_20260203211834_100_1340" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3730991/202602/3730991-20260204163158358-263756083.png" class="lazyload"></p>
<h3 id="4-buildèåæ ¸å¿å·¥å·éé¡¹å¨è§£">4. Buildèåæ ¸å¿å·¥å·éé¡¹å¨è§£</h3>
<table>
<thead>
<tr>
<th>éé¡¹åç§°</th>
<th>æ ¸å¿ä½ç¨</th>
<th>å¸åä½¿ç¨åºæ¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>Make Module 'entry'</td>
<td>ç¼è¯entryæ¨¡åï¼çæåæ¨¡åHAPå</td>
<td>éªè¯entryæ¨¡åå±é¨ä¿®æ¹ææ</td>
</tr>
<tr>
<td>Build Hap(s)/APP(s)</td>
<td>Build Hap(s)ï¼ç¼è¯å/å¤æ¨¡åçæHAPåï¼Build App(s)ï¼æ´åå¨æ¨¡åçæ.appå</td>
<td>å±é¨è°è¯ç¨Hap(s)ï¼é¨ç½²/åå¸ç¨App(s)</td>
</tr>
<tr>
<td>Generate Build Profile 'entry'</td>
<td>çæentryæ¨¡åä¸å±ç¼è¯éç½®æä»¶</td>
<td>èªå®ä¹entryæ¨¡åç¼è¯è§å</td>
</tr>
<tr>
<td>Clean Project</td>
<td>å é¤å¨å·¥ç¨ææç¼è¯æä»¶ï¼å½»åºæ¸çç¼å­</td>
<td>ç¼è¯å¼å¸¸ãç¼å­å²çªãéç½®ä¿®æ¹ä¸çæ</td>
</tr>
<tr>
<td>Rebuild Project</td>
<td>åæ§è¡Clean Projectï¼åå¨å·¥ç¨éæ°ç¼è¯</td>
<td>æ¸çåä»ç¼è¯å¤±è´¥ãå·¥ç¨é¿ææªç¼è¯</td>
</tr>
<tr>
<td>Generate Key and CSR</td>
<td>çæ.p12å¯é¥+CSRæä»¶ï¼ç¨äºç³è¯·å®æ¹åå¸ç­¾å</td>
<td>åºç¨æ­£å¼åå¸ä¸æ¶</td>
</tr>
<tr>
<td>Upload Product</td>
<td>å°æ­£å¼ç.appåä¸ä¼ è³åä¸ºåºç¨å¸åºåå°</td>
<td>åºç¨æäº¤ä¸æ¶æå®¡</td>
</tr>
<tr>
<td>Build Analyzer</td>
<td>åææå»ºèæ¶ãèµæºå ç¨ï¼å®ä½æå»ºå¤±è´¥åå </td>
<td>æå»ºéåº¦æ¢ãææ¥æå»ºå¤±è´¥é®é¢</td>
</tr>
</tbody>
</table>
<h2 id="å«ä»£ç ä»åº">å«ãä»£ç ä»åº</h2>
<ul>
<li>å·¥ç¨åç§°ï¼FirstApplication</li>
<li>ä»åºå°åï¼<a href="https://gitee.com/HarmonyOS-UI-Basics/harmony-os-ui-basics.git" target="_blank" rel="noopener nofollow">https://gitee.com/HarmonyOS-UI-Basics/harmony-os-ui-basics.git</a></li>
</ul>
<h2 id="ä¹ä¸èé¢å">ä¹ãä¸èé¢å</h2>
<p>ä¸ä¸èå°æ·±å¥å­¦ä¹  UIAbility çå½å¨æå¨è§£æï¼æ ¸å¿åå®¹åæ¬ï¼</p>
<ol>
<li>UIAbility å¨çå½å¨ææ ¸å¿æ¹æ³çè§¦åæ¶æºãæ ¸å¿ä½ç¨åæ§è¡æ¬¡æ°çº¦æï¼</li>
<li>WindowStage äºä»¶ä½ç³»ä¸çå½å¨æçèå¨é»è¾ï¼ææ¡çªå£ç¶æï¼è·ç¦/å¤±ç¦ãåå°/åå°ï¼çåæ³çå¬æ¹å¼ï¼</li>
<li><code>onDestroy</code> æ¹æ³çç¹æ®è§¦åè§åï¼API 13+ä¸é®æ¸çãè°è¯æ¨¡å¼ãæå¨è°ç¨APIç­ä¸ååºæ¯ï¼ï¼</li>
<li>é¡µé¢ä»è½å¨ <code>onWindowStageCreate</code> å è½½çåºå±åå åçå½å¨æç¸å³å¼åé¿åè¦ç¹ï¼</li>
<li>å®æéªè¯å¯å¨/ååå°åæ¢/å³é­ç­åºæ¯ä¸ççå½å¨ææ§è¡é¡ºåºï¼ææ¡å³é®æ°æ®çå®å¨ä¿å­ç­ç¥ã</li>
</ol>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.00625" data-date-updated="2026-02-04 16:45">2026-02-04 16:36</span>&nbsp;
<a href="https://www.cnblogs.com/san-xiu">é¸¿è-æ£ä¿®</a>&nbsp;
éè¯»(<span id="post_view_count">61</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19575201);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19575201', targetLink: 'https://www.cnblogs.com/san-xiu/p/19575201', title: 'é¸¿èåºç¨å¼åUIåºç¡ç¬¬äºèï¼é¸¿èåºç¨ç¨åºæ¡æ¶æ ¸å¿è§£æä¸å®æ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Apache SeaTunnel ZetaãFlinkãSpark æä¹éï¼åºå±åç + å®æå¯¹æ¯ä¸æ¬¡è®²é ]]></title>
    <link>https://www.cnblogs.com/seatunnel/p/19575007</link>
    <guid>9d1165f7352369d3464c98b4224558bf</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/seatunnel/p/19575007" title="åå¸äº 2026-02-04 16:05">
    <span role="heading" aria-level="2">Apache SeaTunnel ZetaãFlinkãSpark æä¹éï¼åºå±åç + å®æå¯¹æ¯ä¸æ¬¡è®²é</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ¬ææ¡£å°æ·±å¥è§£æ Apache SeaTunnel æ¯æçä¸å¤§æ§è¡å¼æï¼Zeta (SeaTunnel Engine)ãFlink å Sparkãæä»¬å°ä»æ¶æè®¾è®¡ãæ ¸å¿ç¹æ§ãä¼ç¼ºç¹å¯¹æ¯ä»¥åä½¿ç¨æ¹æ³ç­å¤ä¸ªç»´åº¦è¿è¡è¯¦ç»è®²è§£ï¼å¸®å©ä½ æ ¹æ®ä¸å¡éæ±éæ©æåéçå¼æã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p><img alt="å¯¹æ¯" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3195851/202602/3195851-20260204160419017-1851955102.png" class="lazyload"></p>
<p>æ¬ææ¡£å°æ·±å¥è§£æ Apache SeaTunnel æ¯æçä¸å¤§æ§è¡å¼æï¼<strong>Zeta (SeaTunnel Engine)</strong>ã<strong>Flink</strong> å <strong>Spark</strong>ãæä»¬å°ä»æ¶æè®¾è®¡ãæ ¸å¿ç¹æ§ãä¼ç¼ºç¹å¯¹æ¯ä»¥åä½¿ç¨æ¹æ³ç­å¤ä¸ªç»´åº¦è¿è¡è¯¦ç»è®²è§£ï¼å¸®å©ä½ æ ¹æ®ä¸å¡éæ±éæ©æåéçå¼æã</p>
<h2 id="1-å¼ææ¦è§">1. å¼ææ¦è§</h2>
<p>SeaTunnel çæ¶æè®¾è®¡éç¨äº <strong>API ä¸æ§è¡å¼æè§£è¦</strong> çç­ç¥ãè¿æå³çåä¸å¥æ°æ®åæ­¥é»è¾ï¼Configï¼å¯ä»¥æ ç¼è¿è¡å¨ä¸åçå¼æä¸ã</p>
<ul>
<li><strong>Zeta Engine</strong>: SeaTunnel ç¤¾åºä¸é¨ä¸ºæ°æ®éæåºæ¯èªç çæ°ä¸ä»£å¼æï¼ä¸æ³¨äºé«æ§è½ãä½å»¶è¿çæ°æ®åæ­¥ã</li>
<li><strong>Flink Engine</strong>: å©ç¨ Flink å¼ºå¤§çæµå¤çè½åï¼éåå·²æ¥æ Flink éç¾¤çç¨æ·ã</li>
<li><strong>Spark Engine</strong>: å©ç¨ Spark å¼ºå¤§çæ¹å¤çè½åï¼éåç¦»çº¿å¤§è§æ¨¡æ°æ®å¤çåºæ¯ã</li>
</ul>
<h2 id="2-zeta-å¼ææ ¸å¿æ¨è">2. Zeta å¼æââæ ¸å¿æ¨è</h2>
<p>Zeta æ¯ç®å SeaTunnel ç¤¾åºä¸»æ¨çé»è®¤å¼æãå®æ¨å¨è§£å³ Flink/Spark å¨ç®åæ°æ®åæ­¥åºæ¯ä¸âèµæºæ¶èå¤§ãé¨ç½²è¿ç»´éâçé®é¢ã</p>
<h3 id="21-æ ¸å¿æ¶æ">2.1 æ ¸å¿æ¶æ</h3>
<p>Zeta éç¨æ ä¸­å¿åï¼Decentralizedï¼æ Master-Slave æ¶æï¼åå³äºé¨ç½²æ¨¡å¼ï¼ï¼ä¸»è¦åå«ä»¥ä¸ç»ä»¶ï¼</p>
<ul>
<li><strong>Coordinator (Master)</strong>:
<ul>
<li><strong>ä½ä¸è§£æ</strong>: å°é»è¾ DAG (Logical DAG) è½¬æ¢ä¸ºç©ç DAG (Physical DAG)ã</li>
<li><strong>èµæºè°åº¦</strong>: ç®¡ç Slotï¼å Worker åéä»»å¡ã</li>
<li><strong>Checkpoint Coordinator</strong>: è´è´£è§¦åååè°åå¸å¼å¿«ç§ï¼åºäº Chandy-Lamport ç®æ³ï¼ï¼ä¿éæ°æ®ä¸è´æ§ã</li>
</ul>
</li>
<li><strong>Worker (Slave)</strong>:
<ul>
<li><strong>Task Execution</strong>: è¿è¡ Source, Transform, Sink ä»»å¡ã</li>
<li><strong>Data Transport</strong>: è´è´£èç¹é´çæ°æ®ä¼ è¾ã</li>
</ul>
</li>
<li><strong>ResourceManager</strong>: æ¯æ Standalone, YARN, Kubernetes ç­å¤ç§èµæºç®¡çæ¨¡å¼ã</li>
</ul>
<p><img alt="SeaTunnel Engine" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3195851/202602/3195851-20260204160419144-538520599.png" class="lazyload"></p>
<h3 id="22-å³é®ç¹æ§">2.2 å³é®ç¹æ§</h3>
<ol>
<li><strong>Pipeline çº§å®¹é (Pipeline-level Fault Tolerance)</strong>:
<ul>
<li>ä¸åäº Flink çâå¨å¾éå¯âï¼Zeta å¯ä»¥åªéå¯å¤±è´¥ç Pipelineï¼ä¾å¦å¤è¡¨åæ­¥ä¸­ï¼è¡¨ A å¤±è´¥ä¸å½±åè¡¨ Bï¼ã</li>
</ul>
</li>
<li><strong>å¢éå¿«ç§ (Incremental Checkpoint)</strong>:
<ul>
<li>æ¯æé«é¢ Checkpointï¼æå°åæ°æ®ä¸¢å¤±é£é©ï¼åæ¶å¯¹æ§è½å½±åæå°ã</li>
</ul>
</li>
<li><strong>å¨ææ©ç¼©å®¹ (Dynamic Scaling)</strong>:
<ul>
<li>æ¯æå¨ä½ä¸è¿è¡æ¶å¨æå¢å æåå° Worker èç¹ï¼æ ééå¯ä½ä¸ã</li>
</ul>
</li>
<li><strong>Schema Evolution (è¡¨ç»æåæ´)</strong>:
<ul>
<li>åçæ¯æ DDL åæ´åæ­¥ï¼å¦ Add Columnï¼ï¼è¿å¯¹ CDC åºæ¯è³å³éè¦ã</li>
</ul>
</li>
</ol>
<h3 id="23-ä½¿ç¨æå">2.3 ä½¿ç¨æå</h3>
<p>Zeta å¼æéå¸¸åå«å¨ SeaTunnel çäºè¿å¶åä¸­ï¼å¼ç®±å³ç¨ã</p>
<p><strong>å¯å¨å½ä»¤ (Local æ¨¡å¼ - å¼åæµè¯):</strong></p>
<pre><code class="language-bash">./bin/seatunnel.sh --config ./config/your_job.conf -e local
</code></pre>
<p><strong>å¯å¨å½ä»¤ (Cluster æ¨¡å¼ - çäº§ç¯å¢):</strong></p>
<ol>
<li>å¯å¨ Server (Master/Worker):<pre><code class="language-bash">./bin/seatunnel-cluster.sh -d
</code></pre>
</li>
<li>æäº¤ä»»å¡å°éç¾¤:<pre><code class="language-bash">./bin/seatunnel.sh --config ./config/your_job.conf -e cluster
</code></pre>
</li>
</ol>
<h2 id="3-flink-å¼æ">3. Flink å¼æ</h2>
<p><img alt="flink-1_highres" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3195851/202602/3195851-20260204160419170-1840939353.png" class="lazyload"></p>
<p>SeaTunnel éè¿ç¿»è¯å±ï¼Translation Layerï¼å°åé¨ç Source/Sink API ééä¸º Flink ç <code>SourceFunction</code> / <code>SinkFunction</code> (æ Flink æ°ç Source/Sink API)ã</p>
<h3 id="31-æ¶æåç">3.1 æ¶æåç</h3>
<ul>
<li><strong>Translation</strong>: SeaTunnel å¨ Client ç«¯å° Config è§£æå¹¶ç¿»è¯æ Flink JobGraphã</li>
<li><strong>Execution</strong>: æäº¤ç» Flink Cluster æ§è¡ãæ­¤æ¶ï¼SeaTunnel ä»»å¡å°±æ¯ä¸ä¸ªæ åç Flink ä»»å¡ã</li>
<li><strong>State Backend</strong>: ä¾èµ Flink ç Checkpoint æºå¶ï¼RocksDB/FsStateBackendï¼ç®¡çç¶æã</li>
</ul>
<h3 id="32-ä¼ç¼ºç¹">3.2 ä¼ç¼ºç¹</h3>
<ul>
<li><strong>ä¼ç¹</strong>: çææçï¼è¿ç»´å·¥å·ä¸°å¯ï¼éåå¤æçæµå¼è®¡ç®+åæ­¥åºæ¯ã</li>
<li><strong>ç¼ºç¹</strong>: çæ¬è¦åä¸¥éï¼ééé Flink 1.13-1.18 ç­ä¸åçæ¬ï¼ï¼å¯¹äºçº¯åæ­¥ä»»å¡æ¾å¾è¿éã</li>
</ul>
<h3 id="33-ä½¿ç¨æå">3.3 ä½¿ç¨æå</h3>
<p>éè¦ä¸è½½å¯¹åºç <code>seatunnel-flink-starter</code> jar åï¼å¹¶ç¡®ä¿ Flink ç¯å¢å·²åå¤å¥½ã</p>
<p><strong>å¯å¨å½ä»¤ (Flink 1.13+):</strong></p>
<pre><code class="language-bash">./bin/start-seatunnel-flink-13-connector-v2.sh \
    --config ./config/your_job.conf \
    --run-mode run # æ run-application
</code></pre>
<p><em>(æ³¨æï¼ä¸å Flink çæ¬èæ¬åç§°ç¥æä¸åï¼å¦ <code>flink-15</code>, <code>flink-18</code>)</em></p>
<h2 id="4-spark-å¼æ">4. Spark å¼æ</h2>
<p><img alt="spark" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3195851/202602/3195851-20260204160419002-731834434.png" class="lazyload"></p>
<p>ç±»ä¼¼äº Flinkï¼SeaTunnel å° Source/Sink ééä¸º Spark ç <code>DataSource V2</code> APIã</p>
<h3 id="41-æ¶æåç">4.1 æ¶æåç</h3>
<ul>
<li><strong>Batch</strong>: ä½¿ç¨ Spark RDD / DataFrame API æ§è¡ç¦»çº¿æ¹å¤çã</li>
<li><strong>Streaming</strong>: ä½¿ç¨ Spark Streaming (Micro-batch) æ§è¡æµå¼å¤çã</li>
</ul>
<h3 id="42-ä¼ç¼ºç¹">4.2 ä¼ç¼ºç¹</h3>
<ul>
<li><strong>ä¼ç¹</strong>: æ¹å¤çæ§è½å¼ºå¤§ï¼å¨å¤§è§æ¨¡ç¦»çº¿æ°æ®æ¸æ´/ETL åºæ¯è¡¨ç°ä¼å¼ã</li>
<li><strong>ç¼ºç¹</strong>: æµå¤çåºäºå¾®æ¹ï¼Micro-batchï¼ï¼å»¶è¿éå¸¸é«äº Flink/Zetaï¼èµæºè°åº¦è¾æ¢ã</li>
</ul>
<h3 id="43-ä½¿ç¨æå">4.3 ä½¿ç¨æå</h3>
<p>éè¦ä¸è½½å¯¹åºç <code>seatunnel-spark-starter</code> jar åã</p>
<p><strong>å¯å¨å½ä»¤ (Spark 3.x):</strong></p>
<pre><code class="language-bash">./bin/start-seatunnel-spark-3-connector-v2.sh \
    --config ./config/your_job.conf \
    --master local[4] # æ yarn, k8s
</code></pre>
<h2 id="5-ä¸å¤§å¼æå¨æ¹ä½å¯¹æ¯">5. ä¸å¤§å¼æå¨æ¹ä½å¯¹æ¯</h2>
<table>
<thead>
<tr>
<th style="text-align: left">ç¹æ§</th>
<th style="text-align: left">Zeta (SeaTunnel Engine)</th>
<th style="text-align: left">Flink Engine</th>
<th style="text-align: left">Spark Engine</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><strong>å®ä½</strong></td>
<td style="text-align: left"><strong>æ°æ®åæ­¥ä¸ç¨</strong></td>
<td style="text-align: left">éç¨æµæ¹è®¡ç®</td>
<td style="text-align: left">éç¨æ¹æµè®¡ç®</td>
</tr>
<tr>
<td style="text-align: left"><strong>éç¨åºæ¯</strong></td>
<td style="text-align: left">æµ·éæ°æ®éæãCDC å®æ¶åæ­¥ãå¤è¡¨æ´åºåæ­¥</td>
<td style="text-align: left">å¤ææµå¼è®¡ç® + åæ­¥</td>
<td style="text-align: left">å¤§è§æ¨¡ç¦»çº¿æ¸æ´ãETL</td>
</tr>
<tr>
<td style="text-align: left"><strong>é¨ç½²å¤æåº¦</strong></td>
<td style="text-align: left"><strong>ä½</strong> (åç½®ï¼å¼ç®±å³ç¨)</td>
<td style="text-align: left">ä¸­ (éç»´æ¤ Flink éç¾¤)</td>
<td style="text-align: left">ä¸­ (éç»´æ¤ Spark éç¾¤)</td>
</tr>
<tr>
<td style="text-align: left"><strong>èµæºæ¶è</strong></td>
<td style="text-align: left"><strong>ä½</strong> (éå¯¹åæ­¥ä¼åï¼æ å¤ä½å¼é)</td>
<td style="text-align: left">ä¸­/é«</td>
<td style="text-align: left">ä¸­/é«</td>
</tr>
<tr>
<td style="text-align: left"><strong>å»¶è¿</strong></td>
<td style="text-align: left"><strong>ä½</strong> (å®æ¶æµ)</td>
<td style="text-align: left">ä½ (å®æ¶æµ)</td>
<td style="text-align: left">ä¸­ (å¾®æ¹)</td>
</tr>
<tr>
<td style="text-align: left"><strong>å®¹éç²åº¦</strong></td>
<td style="text-align: left"><strong>Pipeline çº§</strong> (å±é¨éå¯)</td>
<td style="text-align: left">Job çº§ (å¨å±éå¯)</td>
<td style="text-align: left">Stage/Task çº§</td>
</tr>
<tr>
<td style="text-align: left"><strong>CDC æ¯æ</strong></td>
<td style="text-align: left"><strong>å®ç¾</strong> (æ¯æ Schema Evolution)</td>
<td style="text-align: left">è¯å¥½</td>
<td style="text-align: left">ä¸è¬</td>
</tr>
<tr>
<td style="text-align: left"><strong>å¤çæ¬éé</strong></td>
<td style="text-align: left">æ ééé (èªå¸¦)</td>
<td style="text-align: left">éä¸¥æ ¼å¹é Flink çæ¬</td>
<td style="text-align: left">éä¸¥æ ¼å¹é Spark çæ¬</td>
</tr>
</tbody>
</table>
<h2 id="6-å¦ä½éæ©">6. å¦ä½éæ©ï¼</h2>
<ol>
<li>
<p><strong>å¦æä½ æ¯æ°é¡¹ç®ï¼æèä¸»è¦éæ±æ¯æ°æ®åæ­¥ (Data Integration)</strong>:</p>
<ul>
<li>ð <strong>é¦é Zeta å¼æ</strong>ãå®æè½»éãæ§è½æå¥½ï¼ä¸å¯¹ CDC åå¤è¡¨åæ­¥æç¹æ®ä¼åã</li>
</ul>
</li>
<li>
<p><strong>å¦æä½ å·²ç»æç°æç Flink/Spark éç¾¤ï¼ä¸è¿ç»´å¢éä¸æ³ç»´æ¤æ°å¼æ</strong>:</p>
<ul>
<li>ð éæ© <strong>Flink</strong> æ <strong>Spark</strong> å¼æï¼å¤ç¨ç°æåºç¡è®¾æ½ã</li>
</ul>
</li>
<li>
<p><strong>å¦æä½ çä»»å¡åå«æå¶å¤æçèªå®ä¹è®¡ç®é»è¾ (Complex Computation)</strong>:</p>
<ul>
<li>ð ä¼åèè <strong>Flink</strong> (æµ) æ <strong>Spark</strong> (æ¹)ï¼å©ç¨å¶ä¸°å¯çç®å­çæãä½ä¹å¯ä»¥èè <strong>Zeta + SQL Transform</strong> æ»¡è¶³å¤§é¨åéæ±ã</li>
</ul>
</li>
</ol>
<h2 id="7-æ°æå¥é¨æå">7. æ°æå¥é¨æå</h2>
<p>å¦æä½ æ¯ç¬¬ä¸æ¬¡æ¥è§¦ SeaTunnelï¼è¯·æç§ä»¥ä¸æ­¥éª¤å¿«éä½éª Zeta å¼æçå¼ºå¤§åè½ã</p>
<h3 id="71-ç¯å¢åå¤">7.1 ç¯å¢åå¤</h3>
<p>ç¡®ä¿ä½ çæºå¨ä¸å®è£äº Java 8 æ Java 11ã</p>
<pre><code class="language-bash">java -version
</code></pre>
<h3 id="72-ä¸è½½ä¸å®è£">7.2 ä¸è½½ä¸å®è£</h3>
<ol>
<li><strong>ä¸è½½</strong>: ä» <a href="https://seatunnel.apache.org/download" target="_blank" rel="noopener nofollow">Apache SeaTunnel å®ç½</a> ä¸è½½ææ°çæ¬çäºè¿å¶å (<code>apache-seatunnel-x.x.x-bin.tar.gz</code>)ã</li>
<li><strong>è§£å</strong>:<pre><code class="language-bash">tar -zxvf apache-seatunnel-*.tar.gz
cd apache-seatunnel-*
</code></pre>
</li>
</ol>
<h3 id="73-å®è£-connector-æä»¶-éè¦">7.3 å®è£ Connector æä»¶ (éè¦!)</h3>
<p><strong>è¿æ¯æ°ææå®¹æå¿½ç¥çä¸æ­¥</strong>ãé»è®¤åä¸åå«ææ Connectorï¼ä½ éè¦è¿è¡èæ¬èªå¨ä¸è½½ã</p>
<pre><code class="language-bash"># èªå¨å®è£ plugin_config éç½®æä»¶ä¸­å®ä¹çæææä»¶
sh bin/install-plugin.sh
</code></pre>
<h3 id="74-å¿«éè¿è¡ç¬¬ä¸ä¸ªä»»å¡">7.4 å¿«éè¿è¡ç¬¬ä¸ä¸ªä»»å¡</h3>
<p>åå»ºä¸ä¸ªç®åçéç½®æä»¶ <code>config/quick_start.conf</code>ï¼å°æ°æ®ä» Fake æºçæå¹¶æå°å°æ§å¶å°ï¼</p>
<pre><code class="language-hocon">env {
  execution.parallelism = 1
  job.mode = "BATCH"
}

source {
  FakeSource {
    result_table_name = "fake"
    row.num = 100
    schema = {
      fields {
        name = "string"
        age = "int"
      }
    }
  }
}

transform {
  # ç®åç SQL å¤ç
  Sql {
    source_table_name = "fake"
    result_table_name = "sql_result"
    query = "select name, age from fake where age &gt; 50"
  }
}

sink {
  Console {
    source_table_name = "sql_result"
  }
}
</code></pre>
<p><strong>è¿è¡ä»»å¡ (Local æ¨¡å¼)</strong>:</p>
<pre><code class="language-bash">./bin/seatunnel.sh --config ./config/quick_start.conf -e local
</code></pre>
<p>å¦æçå°æ§å¶å°è¾åºäºæ°æ®è¡¨æ ¼ï¼æ­åä½ ï¼ä½ å·²ç»æåææ¡äº SeaTunnel çåºæ¬ç¨æ³ï¼</p>
<h2 id="8-zeta-å¼æåçæ·±åº¦å­¦ä¹ è·¯å¾">8. Zeta å¼æåçæ·±åº¦å­¦ä¹ è·¯å¾</h2>
<p>å¦æä½ å¸ææ·±å¥äºè§£ Zeta å¼æçåé¨è¿ä½æºå¶ï¼æèæ³åä¸ç¤¾åºè´¡ç®ï¼å¯ä»¥æç§ä»¥ä¸è·¯å¾è¿è¡æºç éè¯»åè°è¯ã</p>
<h3 id="81-æ ¸å¿æ¨¡åæ¦è§">8.1 æ ¸å¿æ¨¡åæ¦è§</h3>
<p>Zeta å¼æçä»£ç ä¸»è¦éä¸­å¨ <code>seatunnel-engine</code> æ¨¡åä¸ï¼</p>
<ul>
<li><strong>seatunnel-engine-core</strong>: å®ä¹äºæ ¸å¿æ°æ®ç»æï¼å¦ <code>Job</code>, <code>Task</code>ï¼åéä¿¡åè®®ã</li>
<li><strong>seatunnel-engine-server</strong>: åå«äº Coordinator å Worker çå·ä½å®ç°é»è¾ã</li>
<li><strong>seatunnel-engine-client</strong>: å®¢æ·ç«¯æäº¤é»è¾ã</li>
</ul>
<h3 id="82-æºç éè¯»æ¨èè·¯å¾">8.2 æºç éè¯»æ¨èè·¯å¾</h3>
<h4 id="1-ä½ä¸æäº¤ä¸è§£æ-coordinator-ä¾§">1. ä½ä¸æäº¤ä¸è§£æ (Coordinator ä¾§)</h4>
<p>ä» <code>JobMaster</code> ç±»å¼å§ï¼äºè§£ä½ä¸æ¯å¦ä½è¢«æ¥æ¶ååå§åçã</p>
<ul>
<li><strong>å¥å£</strong>: <code>org.apache.seatunnel.engine.server.master.JobMaster</code></li>
<li><strong>é»è¾</strong>: å³æ³¨ <code>init</code> å <code>run</code> æ¹æ³ï¼äºè§£ <code>LogicalDag</code> å° <code>PhysicalPlan</code> çè½¬æ¢è¿ç¨ã</li>
</ul>
<h4 id="2-ä»»å¡æ§è¡-worker-ä¾§">2. ä»»å¡æ§è¡ (Worker ä¾§)</h4>
<p>äºè§£ Task æ¯å¦ä½è¢«è°åº¦åæ§è¡çã</p>
<ul>
<li><strong>æå¡å¥å£</strong>: <a href="seatunnel-engine/seatunnel-engine-server/src/main/java/org/apache/seatunnel/engine/server/TaskExecutionService.java" target="_blank" rel="noopener nofollow">TaskExecutionService.java</a>
<ul>
<li>è¯¥ç±»è´è´£ç®¡ç Worker èç¹ä¸çææ TaskGroupã</li>
</ul>
</li>
<li><strong>æ§è¡ä¸ä¸æ</strong>: <code>org.apache.seatunnel.engine.server.execution.TaskExecutionContext</code></li>
</ul>
<h4 id="3-checkpoint-æºå¶-æ ¸å¿é¾ç¹">3. Checkpoint æºå¶ (æ ¸å¿é¾ç¹)</h4>
<p>Zeta çå¿«ç§æºå¶æ¯ä¿è¯æ°æ®ä¸è´æ§çå³é®ã</p>
<ul>
<li><strong>åè°å¨</strong>: <a href="seatunnel-engine/seatunnel-engine-server/src/main/java/org/apache/seatunnel/engine/server/checkpoint/CheckpointCoordinator.java" target="_blank" rel="noopener nofollow">CheckpointCoordinator.java</a>
<ul>
<li>éç¹éè¯» <code>triggerCheckpoint</code> æ¹æ³ï¼äºè§£ Barrier æ¯å¦ä½ååçã</li>
</ul>
</li>
<li><strong>è®¡å</strong>: <a href="seatunnel-engine/seatunnel-engine-server/src/main/java/org/apache/seatunnel/engine/server/checkpoint/CheckpointPlan.java" target="_blank" rel="noopener nofollow">CheckpointPlan.java</a>
<ul>
<li>äºè§£ Checkpoint æ¶åçä»»å¡èå´æ¯å¦ä½è®¡ç®çã</li>
</ul>
</li>
</ul>
<h3 id="83-è°è¯æå·§">8.3 è°è¯æå·§</h3>
<ol>
<li><strong>ä¿®æ¹æ¥å¿çº§å«</strong>: å¨ <code>config/log4j2.properties</code> ä¸­ï¼å° <code>org.apache.seatunnel</code> ççº§å«è°æ´ä¸º <code>DEBUG</code>ï¼å¯ä»¥çå°è¯¦ç»ç RPC éä¿¡åç¶æåæ´æ¥å¿ã</li>
<li><strong>æ¬å°è°è¯</strong>: å¨ IDE ä¸­ç´æ¥è¿è¡ <code>org.apache.seatunnel.core.starter.seatunnel.SeaTunnelStarter</code> ç±»ï¼ä¼ å¥ <code>-c config/your_job.conf -e local</code> åæ°ï¼å³å¯æ­ç¹è°è¯æ´ä¸ªæµç¨ã</li>
</ol>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-04 16:05">2026-02-04 16:05</span>&nbsp;
<a href="https://www.cnblogs.com/seatunnel">ApacheSeaTunnel</a>&nbsp;
éè¯»(<span id="post_view_count">70</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19575007);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19575007', targetLink: 'https://www.cnblogs.com/seatunnel/p/19575007', title: 'Apache SeaTunnel ZetaãFlinkãSpark æä¹éï¼åºå±åç + å®æå¯¹æ¯ä¸æ¬¡è®²é' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä»é¶å¼å§å­¦Flinkï¼ç¶æç®¡çä¸å®¹éæºå¶ ]]></title>
    <link>https://www.cnblogs.com/daimajiangxin/p/19574902</link>
    <guid>06a586ef75a282bf2888b91b1befe913</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/daimajiangxin/p/19574902" title="åå¸äº 2026-02-04 15:48">
    <span role="heading" aria-level="2">ä»é¶å¼å§å­¦Flinkï¼ç¶æç®¡çä¸å®¹éæºå¶</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3365149/202602/3365149-20260204154757186-1959035735.png" alt="ä»é¶å¼å§å­¦Flinkï¼ç¶æç®¡çä¸å®¹éæºå¶" class="desc_img">
        æ¬ææ·±å¥è§£æ Apache Flink çæ ¸å¿ç¹æ§ââç¶æç®¡çï¼State Managementï¼ä¸å®¹éæºå¶ï¼Fault Toleranceï¼ï¼æ¶µçç¶æç±»åãState Backend éæ©ãCheckpoint åçåéç½®ãä»¥å Savepoint ççäº§å®è·µã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æµå¼è®¡ç®ä»»å¡éå¸¸éè¦ 7x24 å°æ¶é¿æè¿è¡ï¼é¢å¯¹ç½ç»æå¨ãæºå¨æéæä»£ç  Bugï¼å¦ä½ä¿è¯ä»»å¡ä¸æï¼æèæäºä¹åè½èªå¨æ¢å¤ä¸æ°æ®ä¸ä¸¢ãä¸éï¼è¿æ­£æ¯ Flink å¼ä»¥ä¸ºå²çèµæ¬ï¼<strong>å¼ºå¤§çç¶æç®¡ç</strong>ä¸<strong>åºäº Checkpoint çå®¹éæºå¶</strong>ã</p>
<p>æ¬æå°å¸¦ä½ æ·±å¥çè§£ Flink æ¯å¦ä½âè®°å¿âæ°æ®çï¼ä»¥åå®æ¯å¦ä½å¨æéåçæ¶âæ¶ååæµâæ¢å¤ç°åºçã</p>
<h2 id="ä¸ä»ä¹æ¯ç¶æstate">ä¸ãä»ä¹æ¯ç¶æï¼Stateï¼</h2>
<p>å¨æµè®¡ç®ä¸­ï¼æ°æ®æ¯ä¸æ¡æ¡æµè¿çãå¦æå¤çä¸æ¡æ°æ®æ¶ï¼éè¦ä¾èµ<strong>ä¹å</strong>çæ°æ®ï¼ä¾å¦ï¼è®¡ç®è¿å»ä¸å°æ¶çæ»åãå»éãæ¨¡å¼å¹éï¼ï¼é£ä¹è¿äºâä¹åçæ°æ®âæâä¸­é´è®¡ç®ç»æâå°±æ¯<strong>ç¶æ</strong>ã</p>
<h3 id="1-ç¶æçåç±»">1. ç¶æçåç±»</h3>
<p>Flink çç¶æåä¸ºä¸¤å¤§ç±»ï¼<strong>Managed Stateï¼æç®¡ç¶æï¼</strong> å <strong>Raw Stateï¼åçç¶æï¼</strong>ãæä»¬æ¥å¸¸å¼å 99% ä½¿ç¨çæ¯æç®¡ç¶æï¼ç± Flink è¿è¡æ¶èªå¨ç®¡çåå­ãåºåååæéæ¢å¤ã</p>
<p>Managed State åç»åä¸ºï¼</p>
<ul>
<li><strong>Keyed Stateï¼é®æ§ç¶æï¼</strong>
<ul>
<li>åªè½å¨ <code>KeyedStream</code>ï¼å³ <code>keyBy</code> ä¹åï¼ä¸ä½¿ç¨ã</li>
<li>ç¶ææ¯è· Key ç»å®çãFlink ä¸ºæ¯ä¸ª Key ç»´æ¤ä¸ä»½ç¬ç«çç¶æå®ä¾ã</li>
<li>å¸¸ç¨ç±»åï¼<code>ValueState</code>ã<code>ListState</code>ã<code>MapState</code>ã<code>ReducingState</code>ã<code>AggregatingState</code>ã</li>
</ul>
</li>
<li><strong>Operator Stateï¼ç®å­ç¶æï¼</strong>
<ul>
<li>ç»å®å°ç®å­å¹¶è¡å®ä¾ï¼SubTaskï¼ï¼ä¸ Key æ å³ã</li>
<li>å¸¸ç¨äº Source Connectorï¼è®°å½è¯»åç Offsetï¼æ Sink Connectorï¼äºå¡æ§å¶ï¼ã</li>
<li>å¸¸ç¨æ¥å£ï¼<code>ListState</code>ã<code>UnionListState</code>ã<code>BroadcastState</code>ã</li>
</ul>
</li>
</ul>
<h2 id="äºç¶æåç«¯state-backends">äºãç¶æåç«¯ï¼State Backendsï¼</h2>
<p>ç¶æå­å¨åªéï¼æ¯åå­è¿æ¯ç£çï¼è¿ç± <strong>State Backend</strong> å³å®ãå¨ Flink 1.13 ä¹åï¼éç½®æ¹å¼ç®åä¸ºä»¥ä¸ä¸¤ç§ä¸»è¦æ¨¡å¼ï¼</p>
<h3 id="1-hashmapstatebackend-åºäºåå­">1. HashMapStateBackend (åºäºåå­)</h3>
<ul>
<li><strong>å­å¨ä½ç½®</strong>ï¼Java å åå­ï¼Heapï¼ã</li>
<li><strong>ç¹ç¹</strong>ï¼è¯»åéåº¦æå¿«ï¼å¯¹è±¡ç´æ¥è®¿é®ï¼æ åºååå¼éï¼ã</li>
<li><strong>éç¨åºæ¯</strong>ï¼ç¶æè¾å°ï¼ä¾å¦ä»ä»æ¯ç®åç Count æå»éï¼ï¼å¯¹å»¶è¿æå¶ææçåºæ¯ã</li>
<li><strong>ç¼ºç¹</strong>ï¼åéäº JVM å å¤§å°ï¼å®¹æ GCï¼ç¶æè¿å¤§æ¶å¯è½ OOMã</li>
</ul>
<h3 id="2-embeddedrocksdbstatebackend-åºäºç£ç">2. EmbeddedRocksDBStateBackend (åºäºç£ç)</h3>
<ul>
<li><strong>å­å¨ä½ç½®</strong>ï¼TaskManager æ¬å°ç£çï¼åºäº RocksDB æ°æ®åºï¼ï¼åå­ä¸­åªä½ä¸ºç¼å­ï¼Off-heapï¼ã</li>
<li><strong>ç¹ç¹</strong>ï¼æ¯æè¶å¤§ç¶æï¼TB çº§å«ï¼ï¼ä¸å JVM å éå¶ã</li>
<li><strong>éç¨åºæ¯</strong>ï¼è¶å¤§çªå£ãè¶é¿å¨æçèåãæµ·é Key çå»éã</li>
<li><strong>ç¼ºç¹</strong>ï¼éè¦åºåå/ååºååï¼è¯»åæ§è½ç¥ä½äºåå­çï¼éè¦è°ä¼ RocksDB åæ°ã</li>
</ul>
<h3 id="3-éç½®ç¤ºä¾">3. éç½®ç¤ºä¾</h3>
<pre><code class="language-java">StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();

// è®¾ç½®ç¶æåç«¯ä¸º RocksDB
env.setStateBackend(new EmbeddedRocksDBStateBackend());

// éå Checkpoint å­å¨è·¯å¾ï¼å­å¨å¨æ¬å°æä»¶ç³»ç»ï¼
env.getCheckpointConfig().setCheckpointStorage("file:///tmp/flink/checkpoints");
</code></pre>
<h2 id="ä¸å®¹éæ ¸å¿checkpoint">ä¸ãå®¹éæ ¸å¿ï¼Checkpoint</h2>
<p>Checkpointï¼æ£æ¥ç¹ï¼æ¯ Flink å®¹éæºå¶ççµé­ãå®æ¯ä¸ä¸ª<strong>å¨å±ä¸è´æ§å¿«ç§</strong>ï¼å®æå°ææç®å­çç¶ææä¹åå°è¿ç¨å­å¨ï¼å¦ HDFSï¼ã</p>
<h3 id="1-æ ¸å¿åçbarrier-å¯¹é½">1. æ ¸å¿åçï¼Barrier å¯¹é½</h3>
<p>Flink ä½¿ç¨ <strong>Chandy-Lamport ç®æ³</strong> çåä½ã</p>
<ol>
<li><strong>Barrier æ³¨å¥</strong>ï¼JobManager å Source åé Checkpoint Barrierã</li>
<li><strong>Barrier æµå¨</strong>ï¼Barrier åæ®éæ°æ®ä¸æ ·å¨æµä¸­ä¼ è¾ã</li>
<li><strong>å¯¹é½ï¼Alignmentï¼</strong>ï¼å½ç®å­æå¤ä¸ªè¾å¥æµæ¶ï¼å¿é¡»ç­å¾æææµç Barrier å°é½ï¼æè½è¿è¡ Snapshotãè¿ä¿è¯äºç¶æçä¸è´æ§ï¼å³ Exactly-Onceï¼ã</li>
<li><strong>å¼æ­¥å¿«ç§</strong>ï¼ç®å­å°ç¶æåå¥è¿ç¨å­å¨ï¼å¼æ­¥è¿ç¨ï¼ï¼ä¸é»å¡æ°æ®å¤çã</li>
<li><strong>ç¡®è®¤å®æ</strong>ï¼ææç®å­é½å®æå¿«ç§åï¼JobManager ç¡®è®¤ Checkpoint æåã</li>
</ol>
<h3 id="2-checkpoint-éç½®å®æ">2. Checkpoint éç½®å®æ</h3>
<p>é»è®¤æåµä¸ Checkpoint æ¯å³é­çï¼çäº§ç¯å¢<strong>å¿é¡»å¼å¯</strong>ã</p>
<pre><code class="language-java">// 1. å¼å¯ Checkpointï¼æ¯ 5000ms è§¦åä¸æ¬¡
env.enableCheckpointing(5000);

// 2. è®¾ç½® Checkpoint æ¨¡å¼ï¼é»è®¤ EXACTLY_ONCEï¼ä¹å¯ä»¥è®¾ä¸º AT_LEAST_ONCEï¼
env.getCheckpointConfig().setCheckpointingMode(CheckpointingMode.EXACTLY_ONCE);

// 3. è®¾ç½®ä¸¤æ¬¡ Checkpoint ä¹é´çæå°é´éï¼é²æ­¢é¢ç¹ Checkpoint å¯¼è´æ§è½ä¸éï¼
env.getCheckpointConfig().setMinPauseBetweenCheckpoints(1000);

// 4. Checkpoint è¶æ¶æ¶é´ï¼é»è®¤ 10åéï¼
env.getCheckpointConfig().setCheckpointTimeout(60000);

// 5. åè®¸åæ¶è¿è¡ç Checkpoint æ°éï¼éå¸¸è®¾ä¸º 1ï¼
env.getCheckpointConfig().setMaxConcurrentCheckpoints(1);

// 6. å¼å¯ä½ä¸åæ¶æ¶ä¿ç Checkpointï¼éå¸¸éè¦ï¼å¦å Cancel ä»»å¡ä¼å é¤ Checkpointï¼
env.getCheckpointConfig().setExternalizedCheckpointCleanup(
    CheckpointConfig.ExternalizedCheckpointCleanup.RETAIN_ON_CANCELLATION
);

// 7. å®¹å¿ Checkpoint å¤±è´¥æ¬¡æ°ï¼é»è®¤ 0ï¼å³ Checkpoint å¤±è´¥ä¼å¯¼è´ä»»å¡éå¯ï¼
env.getCheckpointConfig().setTolerableCheckpointFailureNumber(3);
</code></pre>
<h2 id="åsavepointæå¨çè¶çº§-checkpoint">åãSavepointï¼æå¨çè¶çº§ Checkpoint</h2>
<p>è½ç¶ Checkpoint å Savepoint çèµ·æ¥å¾åï¼é½æ¯å¿«ç§ï¼ï¼ä½å®ä»¬çå®ä½å®å¨ä¸åï¼</p>
<table>
<thead>
<tr>
<th style="text-align: left">ç¹æ§</th>
<th style="text-align: left">Checkpoint</th>
<th style="text-align: left">Savepoint</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><strong>è§¦åæ¹å¼</strong></td>
<td style="text-align: left">Flink å®æ¶èªå¨è§¦å</td>
<td style="text-align: left">ç¨æ·æå¨å½ä»¤è§¦å</td>
</tr>
<tr>
<td style="text-align: left"><strong>ä¸»è¦ç®ç</strong></td>
<td style="text-align: left"><strong>æéæ¢å¤</strong>ï¼Failoverï¼</td>
<td style="text-align: left"><strong>è¿ç»´æä½</strong>ï¼åçº§ãæ©å®¹ãè¿ç§»ï¼</td>
</tr>
<tr>
<td style="text-align: left"><strong>å­å¨æ ¼å¼</strong></td>
<td style="text-align: left">å¢éå­å¨ï¼ä¾èµ StateBackend ä¼åï¼</td>
<td style="text-align: left">æ åæ ¼å¼ï¼å¨éå­å¨ï¼å¯è·¨çæ¬ï¼</td>
</tr>
<tr>
<td style="text-align: left"><strong>çå½å¨æ</strong></td>
<td style="text-align: left">éä½ä¸çå½å¨æç®¡çï¼é¤éè®¾ç½®ä¿çï¼</td>
<td style="text-align: left">ç¨æ·èªè¡ç®¡çï¼å é¤éæå¨ï¼</td>
</tr>
</tbody>
</table>
<h3 id="å¸¸ç¨å½ä»¤">å¸¸ç¨å½ä»¤</h3>
<pre><code class="language-bash"># è§¦å Savepoint
bin/flink savepoint &lt;jobId&gt; [targetDirectory]

# ä» Savepoint éå¯ä½ä¸ (æè Checkpoint)
bin/flink run -s &lt;savepointPath&gt; ...
</code></pre>
<h2 id="äºéå¯ç­ç¥restart-strategies">äºãéå¯ç­ç¥ï¼Restart Strategiesï¼</h2>
<p>å½ä»»å¡åçæéï¼Exceptionï¼æ¶ï¼Flink ä¼å°è¯æ ¹æ®éç½®çç­ç¥èªå¨éå¯ã</p>
<pre><code class="language-java">// 1. åºå®å»¶è¿éå¯ï¼å°è¯ 3 æ¬¡ï¼æ¯æ¬¡é´é 10ç§ï¼
env.setRestartStrategy(RestartStrategies.fixedDelayRestart(
    3, 
    Duration.ofSeconds(10)
));

// 2. å¤±è´¥çéå¯ï¼å¨ 5 åéåå¤±è´¥è¶è¿ 3 æ¬¡ååæ­¢ï¼å¦åæ¯æ¬¡é´é 10ç§éå¯ï¼
env.setRestartStrategy(RestartStrategies.failureRateRestart(
    3, 
    Duration.ofMinutes(5), 
    Duration.ofSeconds(10)
));

// 3. æ éå¯ï¼ç´æ¥å¤±è´¥ï¼
env.setRestartStrategy(RestartStrategies.noRestart());
</code></pre>
<h2 id="å­æ»ç»">å­ãæ»ç»</h2>
<ul>
<li><strong>State</strong> æ¯ Flink å®ç°å¤æé»è¾çè®°å¿ã</li>
<li><strong>State Backend</strong> å³å®äºè®°å¿å­åªéï¼åå­å¿«ä½å°ï¼RocksDB å¤§ä½éåºååï¼ã</li>
<li><strong>Checkpoint</strong> æ¯èªå¨åçå®æå¤ä»½ï¼ä¿è¯æéæ¢å¤åçæ°æ®ä¸è´æ§ã</li>
<li><strong>Savepoint</strong> æ¯æå¨çé«çº§å¤ä»½ï¼ç¨äºçæ¬åçº§ååºç¨è¿ç§»ã</li>
</ul>
<p>ææ¡äºç¶æä¸å®¹éï¼ä½ ç Flink ä»»å¡æç®çæ­£å·å¤äºâçäº§çº§âçå¥å£®æ§ãä¸ä¸ç¯ï¼æä»¬å°æ¢è®¨ Flink SQLï¼ççå¦ä½ç¨ SQL è§£å³ 80% çæµè®¡ç®éæ±ã</p>
<hr>
<p>åææ¥èªï¼<a href="http://blog.daimajiangxin.com.cn" target="_blank" rel="noopener nofollow">http://blog.daimajiangxin.com.cn</a></p>
<p>æºç å°åï¼<a href="https://gitee.com/daimajiangxin/flink-learning" target="_blank" rel="noopener nofollow">https://gitee.com/daimajiangxin/flink-learning</a></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-04 15:48">2026-02-04 15:48</span>&nbsp;
<a href="https://www.cnblogs.com/daimajiangxin">ä»£ç å å¿</a>&nbsp;
éè¯»(<span id="post_view_count">90</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19574902);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19574902', targetLink: 'https://www.cnblogs.com/daimajiangxin/p/19574902', title: 'ä»é¶å¼å§å­¦Flinkï¼ç¶æç®¡çä¸å®¹éæºå¶' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ istioæµéååå®æï¼ä»éç½®å°è¸©åå¨è§£æ ]]></title>
    <link>https://www.cnblogs.com/MrVolleyball/p/19574573</link>
    <guid>451c8628331c5e774d19b296da6097bb</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/MrVolleyball/p/19574573" title="åå¸äº 2026-02-04 15:04">
    <span role="heading" aria-level="2">istioæµéååå®æï¼ä»éç½®å°è¸©åå¨è§£æ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ¬æéè¿ä¸ä¸ªçå®ç Istio æµéååæ¡ä¾ï¼ç³»ç»æ¢³çææ¯ä¾ãæ Headerãæ URL åç¼ç­å¸¸è§è·¯ç±æ¹å¼ï¼å¹¶éç¹åæ Host ä¸å¹éå¯¼è´æµéå¤±æçæ ¹å ãç»å Nginx ä¸ Sidecar å±å­åºæ¯ï¼è¯¦ç»è¯´æéä¸éãç°åº¦ãèç»¿å A/B æµè¯å¨ Istio ä¸­çè½å°æ¹å¼ï¼éåæ­£å¨æå³å°å¼å¥ Istio çå·¥ç¨å®è·µåè
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="åè¨">åè¨</h2>
<p>ä¸ä¸å°èï¼istioæåçå®è£ï¼å¹¶ä¸è¿è§£å³äºå¸¸è§ç426çé®é¢ï¼æ¬èåå®¹ä¸»è¦æ¢è®¨ä¸ä¸istioå³äºæµéè½¬åçé®é¢</p>
<h2 id="ææ¯ä¾åå">ææ¯ä¾åå</h2>
<h4 id="éç½®">éç½®</h4>
<p>éè¦åå»ºä¸ä¸ªbackend-v1ï¼å®ä¸backendçselectoré½æ¯<code>app: backend</code>ï¼backend-v1é¨ç½²å®æä¹åï¼å®ä¼ç«å³åèµ°50%çæµéï¼ä¸ºäºæµè¯istioæµæ§ï¼æä»¬éè¦å¨ä¸æ¹åä»»ä½éç½®çæåµä¸å®ç°9:1åæµï¼ä¹å°±æ¯90%è¿å¥åbackendï¼10%è¿å¥æ°çbackend-v1</p>
<p><img alt="watermarked-istio_functions_1" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1416773/202602/1416773-20260204145415887-549258054.png" class="lazyload"></p>
<ul>
<li>
<p>æ è®°2ä¸ªdeploymentï¼è¿½å æ ç­¾ï¼backendä¸º<code>version: v0</code>ï¼backend-v1ä¸º<code>version: v1</code></p>
<pre><code>kubectl patch deployment backend -p '{"spec":{"template":{"metadata":{"labels":{"version":"v0"}}}}}'
kubectl patch deployment backend-v1 -p '{"spec":{"template":{"metadata":{"labels":{"version":"v1"}}}}}'
</code></pre>
</li>
<li>
<p>åå»ºistioèµæºï¼DestinationRuleï¼è¯¥èµæºä¸»è¦ç¨æ¥æ è®°istioè¦å¾åªä¸ªå°æ¹è½¬å</p>
<pre><code>apiVersion: networking.istio.io/v1
kind: DestinationRule
metadata:
  name: backend-dr
  namespace: default
spec:
  host: backend-service
  subsets:
  - labels:
      version: v0
    name: v0
  - labels:
      version: v1
    name: v1

</code></pre>
</li>
<li>
<p>åå»ºistioèµæºï¼VirtualServiceï¼è¯¥èµæºç¨æ¥ç¡®å®è½¬åçæé</p>
<pre><code>apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: backend-vs
  namespace: default
spec:
  hosts:
  - backend-service
  http:
  - route:
    - destination:
        host: backend-service
        subset: v0
      weight: 90
    - destination:
        host: backend-service
        subset: v1
      weight: 10
</code></pre>
</li>
</ul>
<h4 id="è°è¯">è°è¯</h4>
<ul>
<li>
<p>æµè¯å½ä»¤ï¼ <code>for i in {1..10}; do curl -s 10.22.12.178:30785/test &gt; /dev/null ; done</code></p>
</li>
<li>
<p>ç»å½å°k8sçistio-proxyæ§å¶å°æ¥çï¼ <code>kubectl logs -f -l app=backend -c istio-proxy</code></p>
<pre><code>[2026-01-28T08:24:55.670Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.55:10000 duration=0ms route=default
[2026-01-28T08:24:55.687Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.55:10000 duration=0ms route=default
[2026-01-28T08:24:55.706Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.53:10000 duration=0ms route=default
[2026-01-28T08:24:55.741Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.53:10000 duration=1ms route=default
[2026-01-28T08:24:55.751Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.53:10000 duration=0ms route=default
[2026-01-28T08:24:55.759Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.53:10000 duration=0ms route=default
[2026-01-28T08:24:55.696Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.55:10000 duration=0ms route=default
[2026-01-28T08:24:55.716Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.55:10000 duration=0ms route=default
[2026-01-28T08:24:55.725Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.55:10000 duration=0ms route=default
[2026-01-28T08:24:55.734Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.55:10000 duration=0ms route=default

</code></pre>
<pre><code>â¶ kubectl get pod -owide
NAME                          READY   STATUS    RESTARTS   AGE     IP            NODE     NOMINATED NODE   READINESS GATES
backend-86b958bdc-5zjgn       2/2     Running   0          21m     10.244.0.53   wilson   &lt;none&gt;           &lt;none&gt;
backend-v1-75ccff86dc-sl6bt   2/2     Running   0          119s    10.244.0.55   wilson   &lt;none&gt;           &lt;none&gt;
nginx-test-7d87875694-8vsrp   2/2     Running   0          30m     10.244.0.61   wilson   &lt;none&gt;           &lt;none&gt;
</code></pre>
</li>
<li>
<p>ææ¾ä¸å¯¹ï¼10.244.0.55ä¸10.244.0.53çæ¯ä¾å¹¶æ²¡æåç°9:1ï¼è½¬åå°backendè¦backend-v1è¿æ¯5:5</p>
</li>
</ul>
<h4 id="ä¿®å¤">ä¿®å¤</h4>
<p>å¯ä»¥ç´æ¥ä¿®æ¹nginxçéç½®</p>
<pre><code>server {
    listen       80;
    listen  [::]:80;
    server_name  localhost;

    location /test {
        proxy_http_version 1.1;
        # proxy_set_header Host $host; # åéç½®
        proxy_set_header Host backend-service.default.svc.cluster.local; # æ°éç½®
        proxy_pass http://backend-service:10000;
    }
}
</code></pre>
<p>éå¯ä¹ååæ¬¡æµè¯ï¼</p>
<pre><code>[2026-01-28T08:30:59.968Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.53:10000 duration=0ms route=default
[2026-01-28T08:30:59.988Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.53:10000 duration=1ms route=default
[2026-01-28T08:31:00.027Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.53:10000 duration=1ms route=default
[2026-01-28T08:31:00.037Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.53:10000 duration=0ms route=default
[2026-01-28T08:31:00.048Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.53:10000 duration=0ms route=default
[2026-01-28T08:31:00.056Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.53:10000 duration=0ms route=default
[2026-01-28T08:31:00.008Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.55:10000 duration=0ms route=default
[2026-01-28T08:31:00.066Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.53:10000 duration=0ms route=default
[2026-01-28T08:31:00.074Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.53:10000 duration=0ms route=default
[2026-01-28T08:31:00.083Z] "GET /test HTTP/1.1" 200 - upstream=10.244.0.53:10000 duration=0ms route=default
</code></pre>
<p>å·²ç»çæäºï¼è¿æ¬¡åªæ1æ¬¡10.244.0.55:10000</p>
<h4 id="çé®">çé®</h4>
<p>æä½å¤§å¥è¯´äºï¼å¦æè¿æ ·éç½®çï¼ææ¾å½±åäºä¸å¡ï¼</p>
<ul>
<li>nginxçéç½®è¢«ä¿®æ¹äº</li>
<li>ææçhostè¢«åæ­»äºï¼é½æäºï¼backend-service.default.svc.cluster.localï¼èåç«¯ä¸å¡æ¯éè¦æå®¢æ·ç«¯çhostå¸¦å¥è¿å»çï¼æ¹äºä¹ååç«¯ä¸å¡æ¶å°ä¸¥éå½±å</li>
</ul>
<p>ç¡®å®ï¼åºå®hostå±äºç²æ´ç®åçåæ³ï¼è¿ææ´å æåçè§£å³æ¹æ³ï¼è°æ´VirtualServiceï¼æ·»å hosts</p>
<pre><code>apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: backend-vs
  namespace: default
spec:
  hosts:
  - backend-service
  - api.wilsontest.com # æ°å¢
  http:
  - route:
    - destination:
        host: backend-service
        subset: v0
      weight: 90
    - destination:
        host: backend-service
        subset: v1
      weight: 10
</code></pre>
<p>å®¢æ·ç«¯è®¿é®çæ¶åå¿é¡»å¸¦ä¸è¯¥ååï¼ <code>for i in {1..10}; do curl -s -H 'host: api.wilsontest.com' 10.22.12.178:30785/test &gt; /dev/null ; done</code></p>
<p>è¿æ ·ä¹å¯ä»¥è§£å³é®é¢ï¼ä¸è¿åç¹ä¹æ¥äºï¼å¹´ä¹å¤±ä¿®ï¼ä»æ æ°åäººç»§æ¿çç¥ä¼ ä»£ç ï¼å°±éè¦å¥½å¥½çæ¢³çå°åºæåªäºhostæ¥è®¿é®ï¼å¦åæ¼æhostçè¯ï¼å°±ä¼åºç°éç½®é®é¢ã-_-!</p>
<p>åæ¬¡å¸æ¾äºistioä¹ä¸­ï¼hostæ¯éå¸¸éå¸¸éè¦çï¼Istio çè·¯ç±å³ç­ãService çå¹éå®å¨ä¾èµ Host å¤´</p>
<ul>
<li>Istio ç VirtualService æ¬è´¨ä¸æ¯ä¸ä¸ªâå¢å¼ºçâçè·¯ç±å¨ãå¦æåç°è¯·æ±ç Host æ¯ backend-serviceï¼å°±æ 90:10 åéã</li>
<li>ä¹åçéç½®æ¯$hostï¼ç±äºå®¢æ·ç«¯æ²¡æä¼ è¾hostï¼å½è¯·æ±ç»è¿ Nginx ç Sidecaræ¶ï¼å®ä¼æ£æ¥Hostï¼åç°ä¸ºç©ºãç±äºè·¯ç±è¡¨éæ²¡æå¯¹åºçè®°å½ ï¼sidecarå¹¶ä¸è®¤è¯ï¼ææ®é K8s æµéå¤ç</li>
</ul>
<h2 id="æheaderåå">æheaderåå</h2>
<pre><code>apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: backend-vs
  namespace: default
spec:
  hosts:
  - backend-service
  - api.wilsontest.com
  http:
  - match:
    - headers:
        hellotest:
          exact: "true"
    route:
    - destination:
        host: backend-service
        subset: v1
  - route:
    - destination:
        host: backend-service
        subset: v0
</code></pre>
<p><code>curl -s -H 'host: api.wilsontest.com' -H 'hellotest: true' 10.22.12.178:30785/test</code>ãåªæheaderéé¢å¹éäº<code>hellotest: true</code>æä¼å»v1ï¼å¦åå¨é¨å»v0</p>
<h2 id="æåç¼åå">æåç¼åå</h2>
<pre><code>apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: backend-vs
  namespace: default
spec:
  hosts:
  - backend-service
  - api.wilsontest.com
  http:
  - match:
    - uri:
        prefix: /test/v1
    route:
    - destination:
        host: backend-service
        subset: v1
  - route:
    - destination:
        host: backend-service
        subset: v0
</code></pre>
<p>å¸¦æ/test/v1åç¼çé½ä¼å»æ°çæ¬v1ï¼æ»¡è¶³ä¸äºæ¡ä»¶é½ä¼èµ°é»è®¤ççæ¬v0</p>
<h2 id="urlæ¹å">urlæ¹å</h2>
<pre><code>apiVersion: networking.istio.io/v1
kind: VirtualService
metadata:
  name: backend-vs
  namespace: default
spec:
  hosts:
  - backend-service
  - api.wilsontest.com
  http:
  - match:
    - uri:
        prefix: /test/v1
    route:
    - destination:
        host: backend-service
        subset: v1
  - match:
    - uri:
        prefix: /test/v2
    rewrite:
      uri: /test
    route:
    - destination:
        host: backend-service
        subset: v0
  - route:
    - destination:
        host: backend-service
        subset: v0

</code></pre>
<p>å¦ææ¯/test/v1ï¼å°±è®¿é®v1çæ¬ï¼/test/v2éåæ/testå¹¶ä¸è®¿é®v0çæ¬ï¼å¶ä½çé»è®¤é½ä¼èµ°v0çæ¬</p>
<h2 id="èç»¿éä¸éç°åº¦abæµè¯">èç»¿ãéä¸éãç°åº¦ãA/Bæµè¯</h2>
<p>å³äºæµéåæµçåç§æä½ï¼å¤§é¨åé½éä¸­å¨ä»¥ä¸åºæ¯ï¼</p>
<ul>
<li>èç»¿ï¼å®ç°ç¬é´åæ¢ä¸é¶å®æºåæ»ï¼æ¶é¤åå¸æé´çä¸­é´ç¶æ</li>
<li>éä¸éï¼åç¿å·¥ç¨éä¸éæ¢æµæ¯æ°ä¸æ ·ï¼åè®©ä¸å°é¨åç¨æ·ï¼å¦1%~5%ï¼è®¿é®æ°çæ¬ï¼è§å¯ç³»ç»ææ ï¼å¦éè¯¯çãå»¶è¿ï¼ï¼è¥æ é®é¢åéæ­¥æ©å¤§èå´</li>
<li>ç°åº¦ï¼å°ç¨æ·ç¾¤ä½ææ¯ä¾æç¹å®è§åï¼å¦å°åãè®¾å¤ï¼éæ­¥åæ¢å°æ°çæ¬ï¼ä¾å¦10%â30%â100%ï¼ï¼æç»­è§å¯åé¦</li>
<li>A/Bï¼åæ¶åéæºåç»çç¨æ·å±ç¤ºä¸åçæ¬ï¼Aç»ç¨æ§çï¼Bç»ç¨æ°çï¼ï¼éè¿ç»è®¡ææ ï¼å¦ç¹å»çãè½¬åçï¼å¤æ­åªä¸ªçæ¬æ´ä¼</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>èç»¿åå¸</th>
<th>éä¸éåå¸</th>
<th>ç°åº¦åå¸</th>
<th>A/Bæµè¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä¸»è¦ç®æ </td>
<td>é¶åæºãç¬æ¶åæ»</td>
<td>ç¨çå®æµéå¿«éåç°ææ¯é£é©</td>
<td>å¹³ç¨³ãå¯æ§å°éæ­¥æ¿æ¢ææç¨æ·</td>
<td>éªè¯ä¸åçæ¬çä¸å¡ææ</td>
</tr>
<tr>
<td>æµéè·¯ç±</td>
<td>å¨éåæ¢ï¼100%â0%ï¼</td>
<td>æå°æ¯ä¾å¼æµï¼å¦1%-5%ï¼</td>
<td>ææ¯ä¾åé¶æ®µæ©å¤§ï¼10%â50%â100%ï¼</td>
<td>æè§å/éæºåéï¼å¦50%/50%ï¼</td>
</tr>
<tr>
<td>å³æ³¨éç¹</td>
<td>ç³»ç»å¯ç¨æ§ä¸åæ»éåº¦</td>
<td>ç³»ç»ç¨³å®æ§ææ ï¼éè¯¯çãå»¶è¿ï¼</td>
<td>åå¸è¿ç¨å¹³ç¨³æ§ä¸ç»¼ååé¦</td>
<td>ä¸å¡ææ ï¼è½¬åçãçå­çï¼</td>
</tr>
<tr>
<td>æéèµæº</td>
<td>ä¸¤å¥å®æ´ç¯å¢ï¼ææ¬é«</td>
<td>ä¸å¥ç¯å¢ï¼æ°çæ¬å®ä¾è¾å°</td>
<td>ä¸å¥ç¯å¢ï¼æ°æ§çæ¬å®ä¾å±å­</td>
<td>ä¸å¥æå¤å¥ç¯å¢ï¼å¹¶è¡è¿è¡å¤ä¸ªçæ¬</td>
</tr>
<tr>
<td>ç¨æ·éæ©</td>
<td>å¨ä½ç¨æ·åæ¶åæ¢</td>
<td>å°é¨åç¨æ·éæºææåºç¡è®¾æ½éæ©</td>
<td>ç¨æ·ææ¯ä¾æå±æ§éæ­¥è¿ç§»</td>
<td>ç¨æ·éæºåç»ææå±æ§å®ååé</td>
</tr>
<tr>
<td>æç»­æ¶é´</td>
<td>æç­ï¼åæ¢å¨å åéåï¼</td>
<td>ç­ï¼å å°æ¶å°ä¸å¤©ï¼</td>
<td>ä¸­é¿ï¼å å¤©å°æ°å¨ï¼</td>
<td>é¿ï¼æ°å¨å°æ°æï¼</td>
</tr>
<tr>
<td>å¸ååºæ¯</td>
<td>å³é®ä¸å¡å¤§çæ¬åçº§ãåºç¡è®¾æ½æ´æ¢</td>
<td>åç«¯æå¡ãä¸­é´ä»¶ãæ°æ®åºåæ´</td>
<td>åç«¯åè½ãç¨æ·çé¢æ´æ°</td>
<td>UIè®¾è®¡ãææ¡ãç®æ³ç­ç¥ãå®ä»·ä¼å</td>
</tr>
</tbody>
</table>
<h2 id="èç³»æ">èç³»æ</h2>
<ul>
<li>èç³»æï¼åæ·±å¥çäº¤æµ</li>
</ul>
<p><img alt="" width="500" height="200" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1416773/202411/1416773-20241121135740959-1907948957.png#" class="lazyload"></p>
<hr>
<p>è³æ­¤ï¼æ¬æç»æ<br>
å¨ä¸æçå­¦æµï¼æææ±¤æ¼æ°´çï¼è¯·åä½ä¸åèµæ...</p>


</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/MrVolleyball/" target="_blank">itæçå</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/MrVolleyball/p/19574573" target="_blank">https://www.cnblogs.com/MrVolleyball/p/19574573</a></p>
<div>æ¬æçæå½ä½èååå®¢å­å±æï¼æ¬¢è¿è½¬è½½ï¼ä½æªç»ä½èåæå¿é¡»å¨æç« é¡µé¢ç»åºåæè¿æ¥ï¼å¦åä¿çè¿½ç©¶æ³å¾è´£ä»»çæå©ã </div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-04 15:04">2026-02-04 15:04</span>&nbsp;
<a href="https://www.cnblogs.com/MrVolleyball">itæçå</a>&nbsp;
éè¯»(<span id="post_view_count">91</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19574573);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19574573', targetLink: 'https://www.cnblogs.com/MrVolleyball/p/19574573', title: 'istioæµéååå®æï¼ä»éç½®å°è¸©åå¨è§£æ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä½ æå¤å°æ¬¡å¯¹çè®¾è®¡ç¨¿è¯´"æè§ä¸å¯¹ï¼ä½è¯´ä¸ä¸æ¥"ï¼ ]]></title>
    <link>https://www.cnblogs.com/huizhudev/p/19576907</link>
    <guid>c48b077810f41773c97066dcc67fc28c</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/huizhudev/p/19576907" title="åå¸äº 2026-02-05 01:57">
    <span role="heading" aria-level="2">ä½ æå¤å°æ¬¡å¯¹çè®¾è®¡ç¨¿è¯´"æè§ä¸å¯¹ï¼ä½è¯´ä¸ä¸æ¥"ï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3695776/202602/3695776-20260205015703204-495254137.png" alt="ä½ æå¤å°æ¬¡å¯¹çè®¾è®¡ç¨¿è¯´&amp;quot;æè§ä¸å¯¹ï¼ä½è¯´ä¸ä¸æ¥&amp;quot;ï¼" class="desc_img">
        é¢å¯¹åçè®¾è®¡çç¦èï¼å¤§å¤æ°äººä¸ç¥éè¯¥å¦ä½åç¡®æè¿°éæ±ãè¿æ¡LOGOè®¾è®¡AIæä»¤éè¿8ä¸ªé®é¢å¼å¯¼ä¸ä¸æèï¼å°å¤æçåä½è¿ç¨ç»æåä¸º"å¡«ç©ºé¢"ï¼è®©æ®éäººä¹è½è·å¾ä¸ä¸çº§çåçè®¾è®¡æ¹æ¡ï¼å¤§å¹éä½ä¸è®¾è®¡å¸çæ²éææ¬ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="ç¬¬ä¸ä¸ªé®é¢ä½ çåçè§è§äººæ ¼åè£å">ç¬¬ä¸ä¸ªé®é¢ï¼ä½ çåçè§è§"äººæ ¼åè£"åï¼</h2>
<p>åçä¸ç¨çæ¯èè²æ¸åï¼å®ç½å´æ¯æ©è²ç¹ç¼ï¼PPTéçLogoæ¯åè§çï¼ä½æµ·æ¥ä¸çåæ¯ç´è§çã</p>
<p>ä½ ççè¿äºä¸è¥¿ï¼æ»è§å¾åªéä¸å¯¹å²ï¼åè¯´ä¸ä¸æ¥ã</p>
<h2 id="ç¬¬äºä¸ªé®é¢æ°é¡¹ç®å¯å¨ä½ çç¬¬ä¸ååºæ¯ä»ä¹">ç¬¬äºä¸ªé®é¢ï¼æ°é¡¹ç®å¯å¨ï¼ä½ çç¬¬ä¸ååºæ¯ä»ä¹ï¼</h2>
<p>æå¼è®¾è®¡ç½ç«å·ä¸¤å°æ¶çµæï¼æ¾5å®¶è®¾è®¡å¬å¸æ¯ä»·æ ¼ï¼è¿æ¯ç´æ¥å¥ä¸ªç°ææ¨¡æ¿æ¹æ¹å­ï¼</p>
<h2 id="ç¬¬ä¸ä¸ªé®é¢å½è®¾è®¡å¸é®ä½ è¦ä»ä¹é£æ ¼ä½ çç­æ¡æ¯ä»ä¹">ç¬¬ä¸ä¸ªé®é¢ï¼å½è®¾è®¡å¸é®ä½ "è¦ä»ä¹é£æ ¼"ï¼ä½ çç­æ¡æ¯ä»ä¹ï¼</h2>
<p>"è¦å¤§æ°"ï¼"è¦é«çº§"ï¼"è¦ç®çº¦ä½æç§ææ"ï¼</p>
<p>è¿äºè¯ï¼è®¾è®¡å¸å¬è¿å»çé½æ¯åºè¯ã</p>
<p><img alt="ä½ æå¤å°æ¬¡å¯¹çè®¾è®¡ç¨¿è¯´&quot;æè§ä¸å¯¹ï¼ä½è¯´ä¸ä¸æ¥&quot;ï¼" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3695776/202602/3695776-20260205015618740-17980853.png" class="lazyload"></p>
<p>è¿ä¸ä¸ªé®é¢èåï¼æ¯ä¸ä¸ªæ´æ®é·ççç¸ï¼<strong>å¤§å¤æ°äººä¸æåçè®¾è®¡ï¼ä½é½å¨ç¡¬çå¤´ç®ååçå³ç­ã</strong></p>
<p>åä¸å¬å¸çåå§äººãå¸åºé¨çåçç»çãèªç±èä¸èãçè³åªæ¯æ³ç»èªå·±æä¸ªä¸ªäººIPçæ®éäººââå¤§å®¶é½å¨åä¸ä¸ªåéï¼<strong>è§è§è¡¨è¾¾çç¦è</strong>ã</p>
<p>ä½ å¾æ¸æ¥ï¼ä¸ä¸ªå¥½çLOGOè½è®©ç¨æ·å¨0.5ç§åè®°ä½ä½ ãä¸ä¸ªä¸ä¸çè§è§ç³»ç»è½è®©ä½ çåçå¨äººç¾¤ä¸­è±é¢èåºã</p>
<p>ä½ä½ æ²¡æå åä¸é¢ç®è¯·4Aå¬å¸ï¼ä¹ä¸æè®¾è®¡æ¯è¯­ï¼æ´å«è¯´ç¥éä»ä¹æ¯"è´ç©ºé´"ã"è²å½©å¿çå­¦"ã"é»éæ¯ä¾"ã</p>
<p>äºæ¯ä½ åªè½ç¢°è¿æ°ãè¿æ°å¥½éå°é è°±çè®¾è®¡å¸ï¼è¿æ°ä¸å¥½ââå¤§æ¦çå°±æ¯é£ç§æ¹äº10çè¿æ¯"æè§ä¸å¯¹"çå©æ¢¦ã</p>
<p>ä½ä»å¤©ææ³åäº«ä¸ä¸ªå¯è½æ¹åä½ æ¸¸æè§åçæ¹æ³ã</p>
<p>ä¸æ¯æä½ å­¦è®¾è®¡ï¼ä¹ä¸æ¯ç»ä½ æ¨èè®¾è®¡å¸ã</p>
<p>èæ¯æä½ å¦ä½ç¨AIï¼è®©ä¸ä¸çè®¾è®¡æç»´ä¸ºä½ å·¥ä½ã</p>
<hr>
<h2 id="è®¾è®¡å¸èå­éçå°å¾">è®¾è®¡å¸èå­éç"å°å¾"</h2>
<p>åè¯´ä¸ªæäºã</p>
<p>ä¸ä¸ªæï¼æåä¸ä½æ10å¹´ç»éªçåçè®¾è®¡å¸èå¤©ãæé®ä»ï¼"å½å®¢æ·è·ä½ è¯´'è¦å¤§æ°'çæ¶åï¼ä½ èå­éå¨æ³ä»ä¹ï¼"</p>
<p>ä»ç¬äºï¼"å¦æåªå¬è¿ä¸å¥ï¼æä»ä¹é½ä¸ä¼åãæä¼åé®è¿8ä¸ªé®é¢ï¼"</p>
<ol>
<li>ä½ çç®æ ç¨æ·æ¯è°ï¼å¹´é¾ãæ§å«ãèä¸ãæ¶å¥ãå®¡ç¾åå¥½ï¼</li>
<li>ä½ çè¡ä¸å±æ§æ¯ä»ä¹ï¼ç§æãé¤é¥®ãéèãæè²ï¼</li>
<li>ä½ çåçå®ä½æ¯é«ç«¯ãä¸­ç«¯è¿æ¯å¤§ä¼ï¼</li>
<li>ä½ æ³ä¼ éçæ ¸å¿ä»·å¼æ¯ä»ä¹ï¼ä¿¡ä»»ãåæ°ãäº²åãä¸ä¸ï¼</li>
<li>ä½ çç«äºå¯¹ææ¯è°ï¼ä»ä»¬ç¨äºä»ä¹é£æ ¼ï¼</li>
<li>ä½ æä»ä¹ç¬ç¹çæååºå æå°åç¹è²ï¼</li>
<li>ä½ æåºå®çåçè²åï¼æèè®¨åçé¢è²ï¼</li>
<li>è¿ä¸ªLOGOä¸»è¦ç¨å¨ä»ä¹åºæ¯ï¼APPå¾æ ãé¨åºæçãäº§ååè£ï¼</li>
</ol>
<p>"åªææè¿äºä¿¡æ¯é½æ¶éé½äºï¼ææè½å¼å§æ³è®¾è®¡ã"</p>
<p>è¿8ä¸ªé®é¢ï¼å°±æ¯è®¾è®¡å¸èå­éç"å°å¾"ãæ²¡æè¿å¼ å°å¾ï¼ä»ä»¬ä¼å¨åä½çè¿·å®«éåå°æè½¬ã</p>
<p>èæ®éäººååçè®¾è®¡æ¶ï¼å ä¹ä»æ¥ä¸é®è¿äºé®é¢ââå ä¸ºæä»¬æ ¹æ¬ä¸ç¥éè¦é®ã</p>
<p>äºæ¯æ²éå°±åæäºçè°æ¸¸æãè®¾è®¡å¸çä½ è¦ä»ä¹ï¼ä½ çè®¾è®¡å¸å¬æäºä»ä¹ãå¤§å®¶é½å¨é»æä¸­æ¸ç´¢ï¼æåç»æå¯æ³èç¥ã</p>
<p>ä½ç°å¨ï¼è¿ä¸ª"å°å¾"æäºæ°çä¸»äººã</p>
<hr>
<h2 id="ï¸-ä¸æ¡æä»¤æ10å¹´è®¾è®¡ç»éªæåä¸è½½">ðºï¸ ä¸æ¡æä»¤ï¼æ10å¹´è®¾è®¡ç»éª"æåä¸è½½"</h2>
<p>ä¸é¢è¿æ¡æä»¤ï¼æ¯æè§è¿æå®æ´çLOGOè®¾è®¡AIæç¤ºè¯ä¹ä¸ã</p>
<p>å®æèµæ·±åçè®¾è®¡å¸çåä½æµç¨ââä»åçåæå°åæäº§åºââå¨é¨ç»æåãæ ååãä½ ä¸éè¦æè®¾è®¡æ¯è¯­ï¼åªéè¦åç­8ä¸ªåºç¡é®é¢ï¼AIå°±è½å¸®ä½ äº§åºä¸ä¸çº§çLOGOè®¾è®¡æ¹æ¡ã</p>
<pre><code class="language-markdown"># è§è²å®ä¹
ä½ æ¯ä¸ä½èµæ·±çåçè§è§è®¾è®¡å¸ï¼æ¥æ10å¹´ä»¥ä¸çLOGOè®¾è®¡ç»éªãä½ ç²¾éåçè¯å«ç³»ç»è®¾è®¡ï¼æé¿å°åççå¿µè½¬åä¸ºç®æ´æåçè§è§ç¬¦å·ãä½ æ·±è°è®¾è®¡å¿çå­¦åçï¼çæä¸åè¡ä¸çè®¾è®¡è§èåæµè¡è¶å¿ãä½ çä½åæ¾æå¡äºå¤å®¶ç¥åä¼ä¸ååä¸å¬å¸ï¼è½å¤ç²¾åææ¡åçè°æ§ï¼åé åºå¼å·èºæ¯æ§ååä¸ä»·å¼çLOGOä½åã

# ä»»å¡æè¿°
æ ¹æ®ç¨æ·æä¾çåçä¿¡æ¯ï¼åä½åºä¸ä¸ãç¬ç¹ãæäºè¯å«çLOGOè®¾è®¡åææ¹æ¡ãLOGOåºè¯¥è½å¤åç¡®ä¼ è¾¾åçæ ¸å¿çå¿µï¼å·æå¼ºççè§è§å²å»ååè®°å¿ç¹ï¼åæ¶ç¬¦åè¡ä¸ç¹å¾åç®æ åä¼å®¡ç¾ã

**è¾å¥ä¿¡æ¯**:
- **åçåç§°**: [åçåç§°]
- **åçè¡ä¸**: [æå±è¡ä¸]
- **åçå®ä½**: [é«ç«¯/ä¸­ç«¯/å¤§ä¼ãå¹´è½»/æçãä¸ä¸/äº²æ°ç­]
- **æ ¸å¿çå¿µ/ä»·å¼è§**: [åçæ³è¦ä¼ è¾¾çæ ¸å¿ä¿¡æ¯]
- **ç®æ åä¼**: [ä¸»è¦æå¡çäººç¾¤ç¹å¾]
- **é£æ ¼åå¥½**ï¼å¯éï¼: [å¦ï¼ç®çº¦ç°ä»£ãå¤å¤ç»å¸ãç§ææãæèºæç»ç­]
- **åçé¢è²**ï¼å¯éï¼: [å·²æåçè²æææä½¿ç¨çé¢è²]
- **ç«äºå¯¹æ**ï¼å¯éï¼: [ä¸»è¦ç«åæåèåç]
- **è®¾è®¡åå¥½**ï¼å¯éï¼: [å¾å½¢ç±»ãæå­ç±»ãå¾æç»åç­]

# è¾åºè¦æ±

## 1. åå®¹ç»æ

### ç¬¬ä¸é¨åï¼åçåæä¸è®¾è®¡å®ä½
- åçæ ¸å¿çå¿µæè§£
- ç®æ åä¼å®¡ç¾ç¹å¾åæ
- è¡ä¸è®¾è®¡é£æ ¼è¶å¿
- è®¾è®¡å³é®è¯æç¼ï¼3-5ä¸ªï¼

### ç¬¬äºé¨åï¼åææ¹æ¡å±ç¤ºï¼æä¾3-5ä¸ªä¸åæ¹åï¼
æ¯ä¸ªæ¹æ¡åå«ï¼
- **æ¹æ¡åç§°**: ç®æ´çæ¹æ¡æ é¢
- **è®¾è®¡çå¿µ**: è¯¦ç»éè¿°åææ¥æºåè®¾è®¡æè·¯
- **è§è§æè¿°**: è¯¦ç»æè¿°LOGOçå¾å½¢åç´ ãæææ¹å¼
- **è²å½©æ¹æ¡**: ä¸»è²ãè¾å©è²çè²å½©ä»£ç åæ­éè¯´æ
- **å­ä½å»ºè®®**: æ¨èçå­ä½é£æ ¼åå·ä½å­ä½åç§°
- **åºç¨åºæ¯**: éåçåºç¨åºæ¯ç¤ºä¾ï¼åçãç½ç«ãåè£ç­ï¼
- **ä¼å¿åæ**: è¯¥æ¹æ¡çç¬ç¹ä¼å¿åéç¨æ§

### ç¬¬ä¸é¨åï¼è®¾è®¡å»¶å±å»ºè®®
- åçè¾å©å¾å½¢è®¾è®¡å»ºè®®
- LOGOå¨ä¸åèæ¯ä¸çåä½ï¼æ·±è²/æµè²èæ¯ï¼
- æ å¿ä¸åçåç§°çç»åæ¹å¼
- æ å¿ç¦ç¨è§èè¯´æ

## 2. è´¨éæ å
- **ç¬ç¹æ§**: åææ°é¢ï¼é¿åä¸å¸åºä¸ç°æLOGOé·å
- **ç®æ´æ§**: è§è§åç´ ç²¾ç¼ï¼æäºè¯å«åè®°å¿
- **ä¸ä¸æ§**: ç¬¦åè®¾è®¡ç¾å­¦ååï¼å·æåä¸ä»·å¼
- **éåºæ§**: è½å¤éåºä¸åå°ºå¯¸ååªä»çå±ç¤ºéæ±
- **å¯å»¶å±æ§**: ä¸ºåçVIç³»ç»å»¶å±çæè¶³å¤ç©ºé´

## 3. æ ¼å¼è¦æ±
- ä½¿ç¨æ¸æ°çå±çº§æ é¢
- æ¯ä¸ªæ¹æ¡ä½¿ç¨åéçº¿åºå
- è²å½©ä»£ç ä½¿ç¨HEXæ ¼å¼ï¼å¦ #FF5733ï¼
- æ¹æ¡æè¿°ä½¿ç¨æ®µè½å½¢å¼ï¼æ¯æ®µä¸è¶è¿3è¡
- æ»å­æ°æ§å¶å¨800-1500å­

## 4. é£æ ¼çº¦æ
- **è¯­è¨é£æ ¼**: ä¸ä¸ä½ä¸æ¦æ¶©ï¼å¼é¡¾è®¾è®¡æ¯è¯­åéä¿ææ
- **è¡¨è¾¾æ¹å¼**: å®¢è§æè¿°ä¸ºä¸»ï¼éå½èå¥åæçµæ
- **ä¸ä¸ç¨åº¦**: æ·±å¥ä¸ä¸ä½è½è¢«éä¸ä¸äººå£«çè§£

# è´¨éæ£æ¥æ¸å

å¨å®æè¾åºå,è¯·èªææ£æ¥:
- [ ] æ¯å¦åæäºåçæ ¸å¿çå¿µåç®æ åä¼
- [ ] æ¯å¦æä¾äºè³å°3ä¸ªä¸åé£æ ¼çè®¾è®¡æ¹æ¡
- [ ] æ¯ä¸ªæ¹æ¡æ¯å¦åå«å®æ´çè®¾è®¡æè¿°åè²å½©è¯´æ
- [ ] è²å½©ä»£ç æ¯å¦ä½¿ç¨äºæ­£ç¡®çHEXæ ¼å¼
- [ ] æ¯å¦æä¾äºå­ä½å»ºè®®ååºç¨åºæ¯ç¤ºä¾
- [ ] è®¾è®¡æè·¯æ¯å¦æ¸æ°ä¸æè¯´æå
- [ ] æ¯å¦èèäºLOGOçå®éåºç¨åºæ¯

# æ³¨æäºé¡¹
- é¿åæä¾è¿äºå¤æçå¾å½¢æè¿°ï¼ç¡®ä¿æè¿°è½å¤è¢«AIå¾åçæå·¥å·çè§£
- ä¸è¦ç´æ¥å¤å¶ç¥ååççè®¾è®¡åç´ 
- æ³¨æé¢è²æ­éçä¸ä¸æ§ï¼èèè²å½©å¿çå­¦åç
- å­ä½å»ºè®®è¦å¼é¡¾ç¾è§æ§åæè¯»æ§
- æ¯ä¸ªæ¹æ¡è¦ææç¡®çå·®å¼åï¼é¿åé£æ ¼éå¤
- æ³¨æåçæååç´ çæ°å½è¿ç¨

# è¾åºæ ¼å¼
è¯·æç§ä»¥ä¸ç»æè¾åºï¼

---
**ãLOGOåæè®¾è®¡æ¹æ¡ã**

**åç**: [åçåç§°]
**è¡ä¸**: [è¡ä¸ç±»å«]

---

## ð¯ åçåæä¸å®ä½
[åçæ ¸å¿çå¿µãç®æ åä¼ãè®¾è®¡å³é®è¯åæ]

---

## ð¡ åææ¹æ¡å±ç¤º

### æ¹æ¡ä¸ï¼[æ¹æ¡åç§°]
**è®¾è®¡çå¿µ**
[è¯¦ç»æè¿°åææ¥æº]

**è§è§æè¿°**
[è¯¦ç»æè¿°LOGOçè§è§ææ]

**è²å½©æ¹æ¡**
- ä¸»è²: #[HEXä»£ç ] [è²å½©è¯´æ]
- è¾å©è²: #[HEXä»£ç ] [è²å½©è¯´æ]

**å­ä½å»ºè®®**
[æ¨èå­ä½é£æ ¼åå·ä½åç§°]

**åºç¨åºæ¯**
[åä¸¾éç¨çåºç¨åºæ¯]

**ä¼å¿åæ**
[è¯´æè¯¥æ¹æ¡çä¼å¿]

---

### æ¹æ¡äºï¼[æ¹æ¡åç§°]
[éå¤ä¸è¿°ç»æ]

---

### æ¹æ¡ä¸ï¼[æ¹æ¡åç§°]
[éå¤ä¸è¿°ç»æ]

---

## ð¨ è®¾è®¡å»¶å±å»ºè®®
[åçè§è§å»¶å±å»ºè®®]
</code></pre>
<hr>
<h2 id="-çå®å¯¹è¯ä»è¦å¤§æ°å°ä¸ä¸æ¹æ¡">ð¬ çå®å¯¹è¯ï¼ä»"è¦å¤§æ°"å°ä¸ä¸æ¹æ¡</h2>
<p>è®©æç»ä½ çä¸ä¸ªçå®çå¯¹è¯ï¼æåä¸ä¸è¿ç§è½¬åçé­åã</p>
<p><strong>Beforeï¼å¸¸è§æ²éæ¹å¼ï¼</strong>ï¼</p>
<blockquote>
<p><strong>åå§äºº</strong>ï¼å¸®æè®¾è®¡ä¸ªLOGOï¼è¦å¤§æ°ï¼è¦æç§ææï¼è¦é«ç«¯ã</p>
<p><strong>è®¾è®¡å¸</strong>ï¼......è½å·ä½ç¹åï¼</p>
<p><strong>åå§äºº</strong>ï¼å°±åé£ç§...å¯...ä½ æçï¼å°±æ¯é£ç§ä¸çå°±å¾åå®³çæè§ã</p>
</blockquote>
<p>3ä¸ªæåï¼æ¹äº8çï¼åæ¹é½ä¸å¼å¿ã</p>
<p><strong>Afterï¼ç¨AIæä»¤ï¼</strong>ï¼</p>
<p>åå§äººåè±5åéå¡«åä¿¡æ¯ï¼</p>
<blockquote>
<p><strong>åçåç§°</strong>: æäºæºæ±<br>
<strong>åçè¡ä¸</strong>: ä¼ä¸çº§SaaSè½¯ä»¶<br>
<strong>åçå®ä½</strong>: ä¸ä¸ãå¯é ãåæ°<br>
<strong>æ ¸å¿çå¿µ</strong>: ç¨AIèµè½ä¼ä¸æ°å­åè½¬å<br>
<strong>ç®æ åä¼</strong>: 30-50å²ä¼ä¸å³ç­èãITè´è´£äºº<br>
<strong>é£æ ¼åå¥½</strong>: ç®çº¦ç°ä»£ãç§ææãç¨³é<br>
<strong>åçé¢è²</strong>: å¸æç¨èè²ç³»ï¼ä»£è¡¨ä¸ä¸åä¿¡ä»»</p>
</blockquote>
<p>ç¶åæè¿äºä¿¡æ¯ä¸¢ç»DeepSeekï¼æä»»ä½å½äº§AIï¼ã</p>
<p>30ç§åï¼AIè¾åºäº3ä¸ªå®æ´çè®¾è®¡æ¹æ¡ï¼æ¯ä¸ªé½åå«ï¼</p>
<ul>
<li>è®¾è®¡çå¿µï¼ä¸ºä»ä¹è¿ä¹è®¾è®¡ï¼</li>
<li>è§è§æè¿°ï¼å·ä½é¿ä»ä¹æ ·ï¼</li>
<li>è²å½©æ¹æ¡ï¼ç²¾ç¡®çHEXè²å¼ï¼</li>
<li>å­ä½å»ºè®®ï¼å·ä½å­ä½åç§°ï¼</li>
<li>åºç¨åºæ¯ï¼éååªéç¨ï¼</li>
<li>ä¼å¿åæï¼è¿ä¸ªæ¹æ¡å¥½å¨åªéï¼</li>
</ul>
<p>åå§äººéäºæåæ¬¢çæ¹æ¡äºï¼ç¶åæè¿æ®µæè¿°åç»è®¾è®¡å¸ï¼</p>
<blockquote>
<p>"ä½ å¥½ï¼è¿æ¯ææ³è¦çæ¹åï¼äºæµä¸è¯ççæ½è±¡èåï¼ç¨æ¸åèä½ç°ç§ææï¼å­ä½ç¨ææºé»ä½..."</p>
</blockquote>
<p>è®¾è®¡å¸ä¸çå°±æï¼ç¬¬ä¸çèå¾å°±éè¿äº80%ã</p>
<p>æ´ä¸ªæµç¨ä»3ä¸ªæã8è½®ä¿®æ¹ï¼åæäº3å¤©ã1æ¬¡æ²éã</p>
<p>è¿ä¸æ¯å¤¸å¼ ï¼è¿æ¯çå®åççæçæåã</p>
<hr>
<h2 id="-è¿å¥æä»¤å¸®ä½ è§£å³ä»ä¹">ð¯ è¿å¥æä»¤å¸®ä½ è§£å³ä»ä¹ï¼</h2>
<p>è®©æç¨æ´ç´ç½çè¯è¯´ï¼</p>
<p><strong>é®é¢1ï¼ä½ ä¸ç¥éè¯¥æä¹æè¿°ä½ æ³è¦çè®¾è®¡</strong></p>
<p>AIæä»¤ä¼å¼å¯¼ä½ åç­8ä¸ªå·ä½é®é¢ãåç­å®è¿äºé®é¢ï¼ä½ å®éä¸å·²ç»å®æäº"åçå®ä½"çæèè¿ç¨ã</p>
<p><strong>é®é¢2ï¼ä½ ä¸ç¥éä»ä¹æ ·çè®¾è®¡æ¯"å¯¹ç"</strong></p>
<p>AIä¼åºäºåçå®ä½ç»åº3-5ä¸ªä¸åæ¹åçä¸ä¸æ¹æ¡ãä½ åªéè¦å¨å·²ç»"å¯¹"çæ¹æ¡ééæé¡ºç¼çä¸ä¸ªã</p>
<p><strong>é®é¢3ï¼ä½ åè®¾è®¡å¸çæ²éææ¬å¤ªé«</strong></p>
<p>ç¨AIè¾åºçæ¹æ¡ä½ä¸ºæ²éåªä»ï¼è®¾è®¡å¸ä¸éè¦çä½ æ³è¦ä»ä¹ï¼ä½ ä¹ä¸éè¦çè®¾è®¡å¸å¬æäºæ²¡æã</p>
<p><strong>é®é¢4ï¼ä½ æ²¡æé¢ç®è¯·ä¸ä¸å¢é</strong></p>
<p>AIè¾åºçæ¹æ¡è½ç¶ä¸è½ç´æ¥ç¨ï¼ä½å®ç»äºä½ ä¸ä¸ª"æ­£ç¡®ç­æ¡"çåèãä½ å¯ä»¥æ¿çè¿ä¸ªæ¹æ¡å»æ¾æ´ä¾¿å®çè®¾è®¡å¸ï¼æèç¨AIç»å¾å·¥å·ç´æ¥çæåç¨¿ã</p>
<p>ç®åè¯´ï¼<strong>å®æè®¾è®¡å³ç­çé¨æ§ï¼ä»"ä¸ä¸ç¥è¯"éå°äº"å¡«ç©ºé¢"ã</strong></p>
<hr>
<h2 id="-ç°å¨å°±è¯è¯">ð ç°å¨å°±è¯è¯</h2>
<p>ä¸ç®¡ä½ ç°å¨ææ²¡æåçé¡¹ç®ï¼é½å¯ä»¥ç¨è¿æ¡æä»¤åä¸ªç»ä¹ ã</p>
<p>éä¾¿æ³ä¸ä¸ªåè®¾çåçï¼</p>
<ul>
<li>æ³å¼ä¸å®¶åå¡åºï¼è¯è¯è®¾è®¡ä¸ªLOGO</li>
<li>æ³åä¸ªä¸ªäººåå®¢ï¼è¯è¯è®¾è®¡ä¸ªLOGO</li>
<li>çè³åªæ¯æ³ç»ä½ çå¾®ä¿¡å°å·è®¾è®¡ä¸ªå¤´åï¼</li>
</ul>
<p>åç­é£8ä¸ªé®é¢ï¼æç»æä¸¢ç»AIã</p>
<p>ä½ ä¼åç°ï¼åæ¬ç¥ç§çè®¾è®¡è¿ç¨ï¼åæ¥å¯ä»¥è¢«æè§£å¾è¿ä¹æ¸æ°ã</p>
<p>ç¶åï¼ä¸æ¬¡å½ä½ ççéè¦ååçå³ç­æ¶ï¼ä½ å°±ä¸ä¼åå¯¹çè®¾è®¡å¸è¯´"è¦å¤§æ°"äºã</p>
<p>ä½ ä¼è¯´ï¼"æçåçå®ä½æ¯...ç®æ ç¨æ·æ¯...æä»¥æå¸æè®¾è®¡è½ä½ç°..."</p>
<p>è¿ææ¯åçå³ç­è¯¥æçæ ·å­ã</p>
<p><strong>å«è®©"æè§ä¸å¯¹"æä¸ºä½ åçåå±çéç¢ãç¨AIï¼è®©ä¸ä¸çè®¾è®¡æç»´ä¸ºä½ å·¥ä½ã</strong></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-05 01:57">2026-02-05 01:57</span>&nbsp;
<a href="https://www.cnblogs.com/huizhudev">realhuizhu</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19576907);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19576907', targetLink: 'https://www.cnblogs.com/huizhudev/p/19576907', title: 'ä½ æå¤å°æ¬¡å¯¹çè®¾è®¡ç¨¿è¯´&amp;quot;æè§ä¸å¯¹ï¼ä½è¯´ä¸ä¸æ¥&amp;quot;ï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æ¥å£èªå¨åæµè¯æ¥å ]]></title>
    <link>https://www.cnblogs.com/xi-yongqi/p/19571986</link>
    <guid>e908296723934edd3ad9387e2a0fc9fb</guid>
    <description>
    <![CDATA[ 
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xi-yongqi/p/19571986" title="åå¸äº 2026-02-04 23:08">
    <span role="heading" aria-level="2">æ¥å£èªå¨åæµè¯æ¥å</span>
    

</a>

		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h4 id="åè¿°">åè¿°ï¼</h4>
<ul>
<li>åå®¢ç³»ç»ä¸»è¦åæ¬ç»å½æ¥å£ãåè¡¨æ¥å£ãåå®¢è¯¦ææ¥å£ãç¨æ·è®¤è¯æ¥å£ãç¼è¾æ¥å£ãä½èä¿¡æ¯æ¥å£ãéè¿å¼åèå·¥å·æåç¸å³url,ä½¿ç¨èå¾è®¾è®¡åºç¸å³æµè¯æ ·ä¾ï¼å¯¹è¯¥ç³»ç»è¿è¡æ¥å£æµè¯ã</li>
</ul>
<h4 id="èå¾">èå¾</h4>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3672332/202602/3672332-20260203204452529-1941544377.png" class="lazyload"></p>
<h4 id="æµè¯ç¯å¢">æµè¯ç¯å¢</h4>
<ul>
<li>ææ¯æ ï¼pytestæ¡æ¶ãrequestæ¨¡åãPyYAMLæ¨¡åãjsonSchemaæ¨¡åãallure-pytestæ¨¡åãloggingæ¨¡å</li>
<li>éæå¼åç¯å¢ï¼pycharm</li>
</ul>
<h4 id="ç¼åæµè¯ä»£ç ">ç¼åæµè¯ä»£ç </h4>
<ol>
<li>æ ¹æ®ä¸é¢çèå¾ï¼éå¯¹æ¯ä¸ä¸ªæ¥å£ç¼åç¸åºçæµè¯ä»£ç ã</li>
<li>ç»ä¸å°è£å¬å±å±æ§ï¼æé«ä»£ç çå¤ç¨æ§ã</li>
<li>ä¸ºäºå¨æµè¯è¿ç¨ä¸­è½å¤åç¡®åç°éè¯¯ï¼å¨utilsä¸­å å¥æ¥å¿æ¨¡åï¼æ¹ä¾¿ç´æ¥å®ä½ã</li>
<li>ä½¿ç¨yamlæ°æ®ç®¡çå·¥å·ï¼å®ç°æµè¯æ°æ®ä¸ä»£ç åç¦»ï¼ä¾¿äºæ°æ®ç®¡çåç»´æ¤ã</li>
<li>éè¿JSON Schemaéªè¯ååºæ ¼å¼,ç¡®ä¿è¿åæ°æ®çç»ææ­£ç¡®æ§ã</li>
</ol>
<h4 id="ä»£ç ç»æå±ç¤º">ä»£ç ç»æå±ç¤º</h4>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3672332/202602/3672332-20260203212456564-284031686.png" class="lazyload"></p>
<ul>
<li><a href="https://gitee.com/xylophone-queen/write-with-python/tree/dev/" target="_blank" rel="noopener nofollow">ä»£ç å°å</a></li>
</ul>
<h5 id="å¬å±ç±»---utils">å¬å±ç±»---utils</h5>
<ol>
<li>request_util.py:å°requestsåºçåè½è¿è¡äºæ¬¡å°è£ï¼æä¾ç»ä¸çæ¥å£è°ç¨æ¹å¼;éè¿å¨å±åéhostç»ä¸ç®¡çè¢«æµç³»ç»çåºå°åã</li>
<li>yaml_util.py:æä¾å¯¹YAMLæ ¼å¼æµè¯æ°æ®æä»¶çè¯»åæä½,åè®¸æµè¯è¿ç¨ä¸­å¨æåå¥åè¯»åæ°æ®ã</li>
<li>logger_util.py:å¤å±æ¬¡æ¥å¿è¾åº,å°ä¸åçº§å«çæ¥å¿åå¼å­å¨ï¼ä¾¿äºå®ä½éè¯¯ã</li>
</ol>
<h5 id="ç»éé¡µé¢---test_loginpy">ç»éé¡µé¢---test_login.py</h5>
<ul>
<li>ä½¿ç¨@pytest.mark.order(1)ç¡®ä¿ç»å½æµè¯æåæ§è¡ï¼æåç»å½æ¯è¿è¡å¶ä»é¡µé¢æ¥å£æµè¯çåºç¡ã</li>
<li>ä½¿ç¨@pytest.mark.parametrizeï¼ç»åèå¾ä¸é¢çç¨ä¾ï¼è®¾ç½®ä¸åçæ¡ä»¶è¿è¡ç»å½æµè¯ã
<ul>
<li>è¦çäºåç§å¼å¸¸ç»å½åºæ¯</li>
<li>æ°å¢æµè¯åºæ¯åªéæ·»å æ°çåæ°ç»å</li>
<li>éè¿ä¸æ¬¡å®ä¹ï¼å¤æ¬¡æ§è¡åå°éå¤ä»£ç </li>
</ul>
</li>
</ul>
<h5 id="åè¡¨é¡µ---test_listpy">åè¡¨é¡µ---test_list.py</h5>
<ul>
<li>éªè¯åå®¢åè¡¨æ¥å£çæ­£å¸¸åè½,ç¡®ä¿APIæé¢æè¿ååå®¢æ°æ®</li>
<li>éªè¯APIçè®¤è¯æææºå¶,ç¡®ä¿æªè®¤è¯ç¨æ·æ æ³è®¿é®åä¿æ¤èµæº</li>
<li>ä»ååºä¸­æåå³é®æ°æ®ä¾åç»­æµè¯ä½¿ç¨,å®ç°æµè¯é´çæ°æ®ä¼ é</li>
</ul>
<h5 id="è¯¦æé¡µ---test_detailpy">è¯¦æé¡µ---test_detail.py</h5>
<ul>
<li>éªè¯åå®¢è¯¦ææ¥å£çæ­£å¸¸åè½ï¼ç¡®ä¿APIæé¢æè¿ååå®¢è¯¦ç»ä¿¡æ¯</li>
<li>ä½¿ç¨@pytest.mark.parametrizeï¼å®ç°äºå¼å¸¸åºæ¯è¦ç</li>
<li>ä»YAMLæä»¶è¯»åç»å½æ¶çæçtokenï¼ç¡®ä¿æµè¯å¨å·²è®¤è¯ç¶æä¸æ§è¡</li>
</ul>
<h5 id="ç¨æ·è®¤è¯æ¥å£---test_getauthorinfopy">ç¨æ·è®¤è¯æ¥å£---test_getAuthorInfo.py</h5>
<ul>
<li>è¡¥åäºåå®¢ä¸ä½èä¿¡æ¯å³èçåè½éªè¯ï¼å®åäºç¨æ·ä¿¡æ¯è·åçæµè¯è¦çï¼æä¾äºä½èä¿¡æ¯æ¥è¯¢çä¸é¡¹æµè¯</li>
<li>test_getAuthorInfoéªè¯å¨æ¥æåæ³ token åææ blogId æ¶ï¼æ¥å£è½è¿åæ­£ç¡®çæ°æ®</li>
<li>éè¿ @pytest.mark.parametrize è¿è¡äºç­ä»·ç±»ä¸è¾¹çå¼åæï¼æµè¯äºç©ºå¼ãè´æ°ãä¸­æå­ç¬¦ãè¶é¿æ°å­ç­å¼å¸¸è¾å¥</li>
</ul>
<h5 id="ç¼è¾æ¥å£---test_addpy">ç¼è¾æ¥å£---test_add.py</h5>
<ul>
<li>éªè¯åå®¢æ·»å åè½çå®æ´æ§åæ­£ç¡®æ§ï¼ç¡®ä¿ç¨æ·è½å¤æååå»ºæ°åå®¢</li>
<li>éè¿åæ°åæµè¯è¦çåç§è¾¹çæ¡ä»¶ï¼ç¡®ä¿ç³»ç»å¯¹å¼å¸¸è¾å¥çæ­£ç¡®å¤ç</li>
<li>éªè¯å¯ææ¬åå®¹ï¼é¾æ¥ãå¾çç­ï¼çæ­£ç¡®å¤çï¼ç¡®ä¿ç³»ç»å¯¹åç§åå®¹æ ¼å¼çæ¯æ</li>
<li>éªè¯æ é¢ååå®¹ä¸è½ä¸ºç©ºçä¸å¡è§åï¼ç¡®ä¿æ°æ®éªè¯é»è¾çæ­£ç¡®æ§</li>
</ul>
<h5 id="ç¨æ·ä¿¡æ¯æ¥å£---test_getuserinfopy">ç¨æ·ä¿¡æ¯æ¥å£---test_getUserInfo.py</h5>
<ul>
<li>éªè¯ç¨æ·ä¿¡æ¯è·ååè½çå®æ´æ§åæ­£ç¡®æ§,ç¡®ä¿ç¨æ·è½å¤æåè·åèªå·±çè´¦æ·ä¿¡æ¯</li>
<li>éªè¯APIçè®¤è¯æææºå¶,ç¡®ä¿æªè®¤è¯ç¨æ·æ æ³è®¿é®ç¨æ·ä¿¡æ¯</li>
<li>éªè¯ç¨æ·ä¿¡æ¯è·åçä¸å¡è§å,ç¡®ä¿æ°æ®éªè¯é»è¾çæ­£ç¡®æ§</li>
</ul>
<h4 id="æµè¯ç»æå±ç¤º">æµè¯ç»æå±ç¤º</h4>
<ul>
<li>éç½®å¥½pytest.iniæä»¶éç½®ï¼è¾åºè¯¦ç»æµè¯ç»æ<br>
<img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3672332/202602/3672332-20260204162029520-89785627.png" class="lazyload"></li>
<li>ä½¿ç¨allureå¨ç»ç«¯çæå¯è§åæµè¯æ¥å
<ul>
<li>å½ä»¤ï¼<code>allure generate .\allure-results\ -o .\allure-reports --clean</code><br>
<img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3672332/202602/3672332-20260204163140342-734298673.png" class="lazyload"><br>
<img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3672332/202602/3672332-20260204163256597-1092778562.png" class="lazyload"></li>
</ul>
</li>
<li>å¯ä»¥çå°32ä¸ªæµè¯ç¨ä¾å¨é¨éè¿ï¼éè¿çç¾åç¾ã</li>
</ul>
<h4 id="å°ç»">å°ç»</h4>
<ul>
<li>è¿è¡æµè¯æ¶éè¦å³æ³¨ä»£ç æ§è¡çé¡ºåºï¼ä½¿ç¨pytest-orderç¬¬ä¸â½æä»¶ï¼æ§å¶æµè¯ç¨ä¾çæ§â¾é¡ºåºã
<ul>
<li>å¨test_login.pyä¸­ä½¿ç¨@pytest.mark.order(1)---&gt;è®¿é®ä»»ä½æ¥å£é½åºè¯¥åè¿è¡ç»å½ï¼ç¡®ä¿ä¿¡æ¯çéç§æ§ã</li>
</ul>
</li>
<li>ä½¿ç¨jsonschemaå¯¹è¿åçæ°æ®æ ¼å¼è¿è¡æ ¡éªï¼æé«æµè¯çæçåè´¨éã</li>
<li>æµè¯é¶æ®µä¿®æ¹pytest.iniçéç½®ä¸º<code>[pytest] addopts = -vs</code>ï¼è¾åºå·ä½çæµè¯ç»æå°ç»ç«¯ï¼ä¾¿äºæµè¯äººåå¿«éå®ä½æµè¯ä¸­åºç°çé®é¢ã</li>
<li>å®ææµè¯åä¿®æ¹éç½®ä¸º<code>[pytest] addopts = -vs --alluredir allure-results</code>ï¼å¹¶éåå½ä»¤<code>allure generate .\allure-results\ -o .\allure-reports --clean</code>è¾åºæµè¯æ¥åã</li>
<li>ä½¿ç¨ç®åçYAMLæä»¶å­å¨å³é®æ°æ®ï¼éè¿read_yamlåwrite_yamlå½æ°ç»ä¸ç®¡çæ°æ®å­åï¼å¨æµè¯å¼å§åæ¸ç©ºYAMLæä»¶é²æ­¢æ°æ®æ±¡æã</li>
<li>å¨ç¼åæä¸ªæµè¯æ¥å£çç¸å³ä»£ç åï¼å¯ä»¥ä½¿ç¨postmané¢æµï¼ç¡®ä¿æ¥å£å°åçåç¡®æ§ã</li>
<li>ä½¿ç¨@pytest.mark.parametrize è¿è¡åæ°åæµè¯ï¼æå¤§å°åå°ä»£ç åä½ï¼å®ç°âæµè¯æ°æ®âä¸âæµè¯é»è¾âçåç¦»ã</li>
</ul>


</div>
<div class="clear"></div>

		</div>
		<div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-04 23:09">2026-02-04 23:08</span>&nbsp;
<a href="https://www.cnblogs.com/xi-yongqi">æä¼æ¿é£å»</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19571986);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19571986', targetLink: 'https://www.cnblogs.com/xi-yongqi/p/19571986', title: 'æ¥å£èªå¨åæµè¯æ¥å' })">ä¸¾æ¥</a>
</div>
	 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ MAFå¿«éå¥é¨ï¼14ï¼å¿«ééæA2A Agent ]]></title>
    <link>https://www.cnblogs.com/edisontalk/p/-/quick-start-on-maf-chatper14</link>
    <guid>c51d4191ecabc21d80bf6650d1fe84f8</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/edisontalk/p/-/quick-start-on-maf-chatper14" title="åå¸äº 2026-02-04 22:17">
    <span role="heading" aria-level="2">MAFå¿«éå¥é¨ï¼14ï¼å¿«ééæA2A Agent</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/381412/202602/381412-20260204221255430-336185513.png" alt="MAFå¿«éå¥é¨ï¼14ï¼å¿«ééæA2A Agent" class="desc_img">
        A2A å³ Agent-to-Agentï¼ç¿»è¯è¿æ¥å°±æ¯âæºè½ä»£çä¹é´çåè®®âï¼æä»¬å¯ä»¥çè§£ä¸ºå®å°±æ¯ä¸ä¸ªå¤§æ¨¡åAgentä»¬ç¨æ¥âèå¤©âçâéç¨è¯­è¨âãæ¬æä»ç»äºMAFä¸­éæA2A Agentçæ ¸å¿æä½ï¼å°A2A Agentè½¬æ¢ä¸ºAIFunctionå·¥å·ï¼ç¶åç±ä¸»Agentèªä¸»éæ©è°ç¨ä¸ä¸ªæå¤ä¸ªA2A Agentè·åä¿¡æ¯æ´ååæç»çæåç­ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>å¤§å®¶å¥½ï¼ææ¯Edisonã</p>
<p>æè¿æä¸ç´å¨è·çå£æ°çã<a class="normal_text_link mp_article_text_link" href="https://mp.weixin.qq.com/s?__biz=MzA4NzQzNTg4Ng==&amp;mid=2651744458&amp;idx=1&amp;sn=139f7584e81aeecd0945133bdc2b4791&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2" rel="noopener nofollow">.NET+AIæºè½ä½å¼åè¿é¶</a>ãè¯¾ç¨å­¦ä¹ MAFå¼åå¤æºè½ä½å·¥ä½æµï¼æå¼ºçæ¨èä½ ä¹ä¸è½¦è·æä¸èµ·åºåï¼</p>
<p><a class="normal_text_link mp_article_text_link" href="https://www.cnblogs.com/edisontalk/p/-/quick-start-on-maf-chatper13" target="_blank" data-itemshowtype="0" data-linktype="2"><span>ä¸ä¸ç¯</span></a><span>ï¼æä»¬å­¦ä¹ äºMAFä¸­å¸¸è§çå¤æºè½ä½ç¼ææ¨¡å¼<span>ãæ¬ç¯ï¼æä»¬æ¥äºè§£ä¸å¨MAFä¸­å¦ä½å¿«ééæA2A (Agent to Agent)ã</span></span></p>
<h1>1 A2Aåè®®ä»ç»</h1>
<p>å¨ä¹åçç³»åæç« ä¸­æä»¬å¶å®å·²ç»ä»ç»è¿A2Aåè®®äºï¼è¿éæä»¬å¿«éæ¸©ä¹ ä¸ä¸ãA2A å³ Agent-to-Agentï¼ç¿»è¯è¿æ¥å°±æ¯âæºè½ä»£çä¹é´çåè®®âï¼æä»¬å¯ä»¥çè§£ä¸ºå®å°±æ¯ä¸ä¸ªå¤§æ¨¡åAgentä»¬ç¨æ¥âèå¤©âçâéç¨è¯­è¨âã</p>
<p><img src="https://img2024.cnblogs.com/blog/381412/202602/381412-20260204220340896-177118451.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>A2Aå®ä¹äºä¸å¥æ¸æ°ãæ åçæ²éæ¹å¼ï¼è®©Agentä»¬å¯ä»¥é¡ºçå°äº¤æµï¼è®©ä¸åå¹³å°åæ¡æ¶ä¸çAgenté½è½å¤è¯´âåä¸ç§è¯âï¼å®ç°æ éç¢çä¿¡æ¯äº¤æ¢ååä½ã</p>
<p>æ´å¤å³äºA2Aåè®®çåå®¹ï¼</p>
<ul>
<li><strong data-pm-slice="0 0 []"><strong data-pm-slice="0 0 []"><span><a class="normal_text_link mp_article_text_link" href="https://www.cnblogs.com/edisontalk/p/-/quick-start-agent-to-agent-part01" target="_blank" data-itemshowtype="0" data-linktype="2"><span>å¤Agentåä½å¥é¨ï¼åºäºA2Aåè®®çAgentéä¿¡ï¼ä¸ï¼</span></a></span></strong></strong></li>
<li><strong data-pm-slice="0 0 []"><strong data-pm-slice="0 0 []"><span><a class="normal_text_link mp_article_text_link" href="https://www.cnblogs.com/edisontalk/p/-/quick-start-agent-to-agent-part02" target="_blank" data-itemshowtype="0" data-linktype="2"><span>å¤Agentåä½å¥é¨ï¼åºäºA2Aåè®®çAgentéä¿¡ï¼ä¸­ï¼</span></a></span></strong></strong></li>
</ul>
<h1><strong><span>2 å°A2A Agentå°è£ä¸ºTool<strong><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;letter-spacing: 0.578px;text-align: left;margin: 8px;&quot;,&quot;data-pm-slice&quot;:&quot;6 3 []&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;para&quot;,{&quot;tagName&quot;:&quot;p&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;outline: 0px;visibility: visible;line-height: 1.75em;margin-top: 16px;margin-bottom: 16px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;span&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;color: rgb(0, 179, 139);font-family: \&quot;PingFang SC\&quot;, \&quot;Lantinghei SC\&quot;, \&quot;Microsoft Yahei\&quot;, \&quot;Hiragino Sans GB\&quot;, \&quot;Microsoft Sans Serif\&quot;, \&quot;WenQuanYi Micro Hei\&quot;, Helvetica, sans-serif;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;span&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;letter-spacing: 0.544px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><br></span></strong></span></strong></h1>
<p>å¨MAFéæA2A Agentï¼æä¸»è¦çæä½å°±æ¯ï¼<strong>å°A2A Agentå°è£ä¸ºä¸ä¸ªTool</strong>ï¼è¿ä¸ªToolå¯¹åºå°MAFä¸­å°±æ¯ä¸ä¸ª<strong>AIFunction</strong>å¯¹è±¡ã</p>
<p>åé¢æä»¬æå°å¯ä»¥å°MCPæå¡ä¹å°è£ä¸ºä¸ä¸ªToolï¼AIFunctionï¼è®©Agentè°ç¨ï¼è¿éA2A Agentä¹æ¯ä¸æ ·çéçã</p>
<p>è¿æ ·åçå¥½å¤æ¯ï¼<strong>è®©MAFä¸­çAgentåè°ç¨æ¬å°å½æ°ä¸æ ·è°ç¨è¿ç¨A2A Agent&nbsp;æ MCP Server</strong>ã</p>
<p>ä¸é¢çä»£ç å±ç¤ºäºå¨MAFä¸­å°A2A Cardè½¬æ¢ä¸ºAgentï¼ç¶ååå°Agentè½¬æ¢ä¸ºAIFunctionï¼</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 0, 1)">......
</span><span style="color: rgba(0, 0, 255, 1)">var</span> functionTools = <span style="color: rgba(0, 0, 255, 1)">new</span> List&lt;AIFunction&gt;<span style="color: rgba(0, 0, 0, 1)">();
</span><span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> endpoint <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> agentEndpoints)
{
    </span><span style="color: rgba(0, 0, 255, 1)">var</span> resolver = <span style="color: rgba(0, 0, 255, 1)">new</span> A2ACardResolver(<span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> Uri(endpoint));
    </span><span style="color: rgba(0, 0, 255, 1)">var</span> card = <span style="color: rgba(0, 0, 255, 1)">await</span><span style="color: rgba(0, 0, 0, 1)"> resolver.GetAgentCardAsync();
    </span><span style="color: rgba(0, 0, 255, 1)">var</span> agent = card.AsAIAgent(); <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Convert A2A Agent to AIAgent instance</span>
<span style="color: rgba(0, 0, 0, 1)">
    functionTools.AddRange(AgentFunctionHelper.CreateFunctionTools(agent, card));
}
......</span></pre>
</div>
<p>ä¸é¢æ¯AgentFunctionHelperç±»çä»£ç å®ç°ï¼</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> AgentFunctionHelper
{
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> IEnumerable&lt;AIFunction&gt;<span style="color: rgba(0, 0, 0, 1)"> CreateFunctionTools(AIAgent a2aAgent, AgentCard agentCard)
    {
        </span><span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> skill <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> agentCard.Skills)
        {
            AIFunctionFactoryOptions options </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)">()
            {
                Name </span>=<span style="color: rgba(0, 0, 0, 1)"> Sanitize(skill.Id),
                Description </span>= $$<span style="color: rgba(128, 0, 0, 1)">"""
</span><span style="color: rgba(0, 0, 0, 1)">                {
                    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">description</span><span style="color: rgba(128, 0, 0, 1)">"</span>: <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">{{skill.Description}}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
                    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">tags</span><span style="color: rgba(128, 0, 0, 1)">"</span>: <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">[{{string.Join(</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">, skill.Tags ?? [])}}]</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
                    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">examples</span><span style="color: rgba(128, 0, 0, 1)">"</span>: <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">[{{string.Join(</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">, skill.Examples ?? [])}}]</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
                    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">inputModes</span><span style="color: rgba(128, 0, 0, 1)">"</span>: <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">[{{string.Join(</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">, skill.InputModes ?? [])}}]</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
                    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">outputModes</span><span style="color: rgba(128, 0, 0, 1)">"</span>: <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">[{{string.Join(</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">, skill.OutputModes ?? [])}}]</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
                }
                </span><span style="color: rgba(128, 0, 0, 1)">"""</span><span style="color: rgba(128, 0, 0, 1)">,</span>
<span style="color: rgba(0, 0, 0, 1)">            };

            </span><span style="color: rgba(0, 0, 255, 1)">yield</span> <span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> AIFunctionFactory.Create(RunAgentAsync, options);
        }

        </span><span style="color: rgba(0, 0, 255, 1)">async</span> Task&lt;<span style="color: rgba(0, 0, 255, 1)">string</span>&gt; RunAgentAsync(<span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)"> input, CancellationToken cancellationToken)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">var</span> response = <span style="color: rgba(0, 0, 255, 1)">await</span> a2aAgent.RunAsync(input, cancellationToken: cancellationToken).ConfigureAwait(<span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">);

            </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> response.Text;
        }
    }

    </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">readonly</span> Regex InvalidNameCharsRegex = <span style="color: rgba(0, 0, 255, 1)">new</span> Regex(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">[^0-9A-Za-z]+</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">, RegexOptions.Compiled);

    </span><span style="color: rgba(0, 0, 255, 1)">public</span> staticstringSanitize(<span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)"> name)
    {
        </span><span style="color: rgba(0, 0, 255, 1)">return</span> InvalidNameCharsRegex.Replace(name, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">_</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    }
}</span></pre>
</div>
<p>å¶ä¸­çCreateFunctionToolsæ¹æ³å®ç°äºå°A2A Agentçææå¬å¼æè½è½¬æ¢ä¸ºAIFunctionå·¥å·ã</p>
<p><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;p&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;-webkit-tap-highlight-color: rgba(0, 0, 0, 0); margin: 8px; padding: 0px; outline: 0px; max-width: 100%; clear: both; min-height: 1em; color: rgba(0, 0, 0, 0.9); font-family: \&quot;PingFang SC\&quot;, system-ui, -apple-system, BlinkMacSystemFont, \&quot;Helvetica Neue\&quot;, \&quot;Hiragino Sans GB\&quot;, \&quot;Microsoft YaHei UI\&quot;, \&quot;Microsoft YaHei\&quot;, Arial, sans-serif; font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.578px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; line-height: 1.75em; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;-webkit-tap-highlight-color: rgba(0, 0, 0, 0); margin-right: 0px; margin-left: 0px; padding: 0px; outline: 0px; max-width: 100%; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]">èSanitizeæ¹æ³åå®ç°äºå½æ°åç§°çè§èåï¼å ä¸ºAIFunctionçåç§°å¿é¡»ç¬¦åä¸å®è§èï¼ä»éå­æ¯ãæ°å­åä¸åçº¿ï¼ï¼å æ­¤éè¦ä¸»å¨å¯¹æè½åç§°è¿è¡è§èåã</span></p>
<h1><strong><strong><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;p&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;-webkit-tap-highlight-color: rgba(0, 0, 0, 0); margin: 8px; padding: 0px; outline: 0px; max-width: 100%; clear: both; min-height: 1em; color: rgba(0, 0, 0, 0.9); font-family: \&quot;PingFang SC\&quot;, system-ui, -apple-system, BlinkMacSystemFont, \&quot;Helvetica Neue\&quot;, \&quot;Hiragino Sans GB\&quot;, \&quot;Microsoft YaHei UI\&quot;, \&quot;Microsoft YaHei\&quot;, Arial, sans-serif; font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.578px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; line-height: 1.75em; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;-webkit-tap-highlight-color: rgba(0, 0, 0, 0); margin-right: 0px; margin-left: 0px; padding: 0px; outline: 0px; max-width: 100%; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><span>3 å®æ´éæç¤ºä¾</span></span></strong></strong></h1>
<p><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);margin: 8px;padding: 0px;outline: 0px;max-width: 100%;clear: both;min-height: 1em;color: rgba(0, 0, 0, 0.9);font-family: \&quot;PingFang SC\&quot;, system-ui, -apple-system, BlinkMacSystemFont, \&quot;Helvetica Neue\&quot;, \&quot;Hiragino Sans GB\&quot;, \&quot;Microsoft YaHei UI\&quot;, \&quot;Microsoft YaHei\&quot;, Arial, sans-serif;font-size: 17px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: 0.578px;orphans: 2;text-align: left;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;background-color: rgb(255, 255, 255);text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;line-height: 1.75em;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;&quot;,&quot;data-pm-slice&quot;:&quot;0 0 []&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]">è¿æ¬¡æä»¬è¿æ¯ä½¿ç¨ä¸æ¬¡æç« ä¸­çæ¡ä¾ï¼å³ä¸ä¸ªææ¸¸å©æï¼å®å¯ä»¥éè¿A2Aåè®®è°ç¨å¤ä¸ªAgentçæè½ã</span></p>
<p><img src="https://img2024.cnblogs.com/blog/381412/202602/381412-20260204220618986-812169228.png" alt="image" width="912" height="550" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p data-pm-slice="0 0 []"><span><span>æä»¬éè¦åå»ºåä¸ª.NETé¡¹ç®ï¼å¶ä¸­ï¼</span></span></p>
<ul class="list-paddingleft-1">
<li>
<p><span><span>1ä¸ª.NETæ§å¶å°é¡¹ç®ï¼ä¸»å©æ</span></span></p>
</li>
<li>
<p><span><span>3ä¸ªASP.NET Webé¡¹ç®ï¼å¤©æ°æºè½ä½ãéåºæºè½ä½ãè·¯çº¿æºè½ä½</span></span></p>
</li>
</ul>
<p><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);margin: 8px;padding: 0px;outline: 0px;max-width: 100%;clear: both;min-height: 1em;color: rgba(0, 0, 0, 0.9);font-family: \&quot;PingFang SC\&quot;, system-ui, -apple-system, BlinkMacSystemFont, \&quot;Helvetica Neue\&quot;, \&quot;Hiragino Sans GB\&quot;, \&quot;Microsoft YaHei UI\&quot;, \&quot;Microsoft YaHei\&quot;, Arial, sans-serif;font-size: 17px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: 0.578px;orphans: 2;text-align: left;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;background-color: rgb(255, 255, 255);text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;line-height: 1.75em;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;&quot;,&quot;data-pm-slice&quot;:&quot;0 0 []&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]">å¨VSä¸­çé¡¹ç®ç»æå¦ä¸ï¼</span></p>
<p><img src="https://img2024.cnblogs.com/blog/381412/202602/381412-20260204220634044-600923620.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>æ¬æ¬¡æ¡ä¾æä»¬å¸æå®ç°ä¸»å©æå¯ä»¥åç­ç¨æ·å³äºä¸åä¸»é¢ï¼æ¯ç¹ï¼éåºï¼å¤©æ°ï¼çé®é¢ï¼å®å¯ä»¥æ ¹æ®é®é¢èªä¸»éæ©éè¦è°ç¨ä¸ä¸ªæå¤ä¸ªAgentå»è·åå¿è¦çä¿¡æ¯åè¿è¡æ´åä¼ååååå¤ç¨æ·ã</p>
<h3><span><span>3.1 å¤©æ°Agent</span></span></h3>
<p data-pm-slice="0 0 []"><span><span>æ·»å NuGetåï¼åç»­A2A Agenté¡¹ç®é½éè¦å®è£æ­¤åï¼ä¸åèµè¿°ï¼</span></span></p>
<div class="cnblogs_code">
<pre>A2A.AspNetCore</pre>
</div>
<p>åå»ºä¸ä¸ª WeatherAgentç±»ï¼å®ä¹å¶è½å å AgentCardï¼è¿éæä»¬éè¦å¬å¼ä¸ä¸ªAgentSkillå³å¤©æ°æ¥è¯¢çè½åï¼</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> WeatherAgent
{
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> Attach(ITaskManager taskManager)
    {
        taskManager.OnMessageReceived </span>=<span style="color: rgba(0, 0, 0, 1)"> QueryWeatherAsync;
        taskManager.OnAgentCardQuery </span>=<span style="color: rgba(0, 0, 0, 1)"> GetAgentCardAsync;
    }

    </span><span style="color: rgba(0, 0, 255, 1)">private</span> Task&lt;A2AResponse&gt;<span style="color: rgba(0, 0, 0, 1)"> QueryWeatherAsync(MessageSendParams messageSendParams, CancellationToken cancellationToken)
    {
        </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (cancellationToken.IsCancellationRequested)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">return</span> Task.FromCanceled&lt;A2AResponse&gt;<span style="color: rgba(0, 0, 0, 1)">(cancellationToken);
        }

        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Process the message</span>
        <span style="color: rgba(0, 0, 255, 1)">var</span> messageText = messageSendParams.Message.Parts.OfType&lt;TextPart&gt;<span style="color: rgba(0, 0, 0, 1)">().First().Text;

        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Create and return an artifact</span>
        <span style="color: rgba(0, 0, 255, 1)">var</span> message = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> AgentMessage()
        {
            Role </span>=<span style="color: rgba(0, 0, 0, 1)"> MessageRole.Agent,
            MessageId </span>=<span style="color: rgba(0, 0, 0, 1)"> Guid.NewGuid().ToString(),
            ContextId </span>=<span style="color: rgba(0, 0, 0, 1)"> messageSendParams.Message.ContextId,
            Parts </span>= [<span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> TextPart() {
                Text </span>= $<span style="color: rgba(128, 0, 0, 1)">"""
</span>                    ð¤ï¸ **å¤©æ°æ¥è¯¢ç»æ**<span style="color: rgba(0, 0, 0, 1)">

                    æ¥è¯¢æ¶é´ï¼{DateTime.Now:yyyy</span>-MM-<span style="color: rgba(0, 0, 0, 1)">dd HH:mm}

                    </span>**åäº¬å¤©æ°**
                    - ä»æ¥ï¼æ´è½¬å¤äºï¼æ°æ¸© -<span style="color: rgba(128, 0, 128, 1)">2</span>Â°C ~ <span style="color: rgba(128, 0, 128, 1)">8</span><span style="color: rgba(0, 0, 0, 1)">Â°C
                    </span>- ææ¥ï¼å¤äºï¼æ°æ¸© <span style="color: rgba(128, 0, 128, 1)">0</span>Â°C ~ <span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">Â°C
                    </span>- åæ¥ï¼é´ï¼æ°æ¸© <span style="color: rgba(128, 0, 128, 1)">2</span>Â°C ~ <span style="color: rgba(128, 0, 128, 1)">9</span><span style="color: rgba(0, 0, 0, 1)">Â°C

                    </span>**ä¸æµ·å¤©æ°**
                    - ä»æ¥ï¼å¤äºï¼æ°æ¸© <span style="color: rgba(128, 0, 128, 1)">5</span>Â°C ~ <span style="color: rgba(128, 0, 128, 1)">12</span><span style="color: rgba(0, 0, 0, 1)">Â°C
                    </span>- ææ¥ï¼å°é¨ï¼æ°æ¸© <span style="color: rgba(128, 0, 128, 1)">6</span>Â°C ~ <span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">Â°C
                    </span>- åæ¥ï¼é´è½¬æ´ï¼æ°æ¸© <span style="color: rgba(128, 0, 128, 1)">4</span>Â°C ~ <span style="color: rgba(128, 0, 128, 1)">11</span><span style="color: rgba(0, 0, 0, 1)">Â°C

                    ð ç©¿è¡£å»ºè®®ï¼åäº¬è¾å·ï¼å»ºè®®ç©¿ç¾½ç»æï¼ä¸æµ·æ¸©åï¼å»ºè®®ç©¿å¤¹åå¤å¥ï¼å¸¦å¥½é¨å·ã
                    </span><span style="color: rgba(128, 0, 0, 1)">"""
</span><span style="color: rgba(0, 0, 0, 1)">            }]
        };

        </span><span style="color: rgba(0, 0, 255, 1)">return</span> Task.FromResult&lt;A2AResponse&gt;<span style="color: rgba(0, 0, 0, 1)">(message);
    }

    </span><span style="color: rgba(0, 0, 255, 1)">private</span> Task&lt;AgentCard&gt; GetAgentCardAsync(<span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)"> agentUrl, CancellationToken cancellationToken)
    {
        </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (cancellationToken.IsCancellationRequested)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">return</span> Task.FromCanceled&lt;AgentCard&gt;<span style="color: rgba(0, 0, 0, 1)">(cancellationToken);
        }

        </span><span style="color: rgba(0, 0, 255, 1)">var</span> capabilities = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> AgentCapabilities()
        {
            Streaming </span>= <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">,
            PushNotifications </span>= <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">,
        };

        </span><span style="color: rgba(0, 0, 255, 1)">return</span> Task.FromResult(<span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> AgentCard()
        {
            Name </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">weather agent</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
            Description </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">weather information agent</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
            Url </span>=<span style="color: rgba(0, 0, 0, 1)"> agentUrl,
            Version </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">1.0.0</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
            DefaultInputModes </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">text</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
            DefaultOutputModes </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">text</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
            Capabilities </span>=<span style="color: rgba(0, 0, 0, 1)"> capabilities,
            Skills </span>=<span style="color: rgba(0, 0, 0, 1)"> [
                </span><span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> AgentSkill
                {
                    Id </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">weather-query</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
                    Name </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¤©æ°æ¥è¯¢</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
                    Description </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æ¥è¯¢æå®åå¸çå¤©æ°é¢æ¥ï¼åæ¬æ¸©åº¦ãéæ°´æ¦çãç©¿è¡£å»ºè®®ç­</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
                    Tags </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">weather</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">forecast</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">climate</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
                    Examples </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ä¸æµ·æå¤©å¤©æ°æä¹æ ·</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æé½è¿å¨çå¤©æ°é¢æ¥</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æ­å·ä¸é¨å</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
                    InputModes </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">text</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
                    OutputModes </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">text</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">]
                }],
        });
    }
}</span></pre>
</div>
<p>è¿éè¯´æä¸ä¸ï¼è¿éä¸ºäºæ¹ä¾¿æ¯ç´æ¥è¿åäºä¸ä¸ªåºå®çå¤©æ°ä¿¡æ¯è¾åºåå®¹ï¼ä½å¨å®éåºç¨ä¸­å¾å¾éè¦è¿è¡å·ä½ç<strong>ä¸å¡é»è¾å¤ç</strong>&nbsp;æ&nbsp;<strong>è°ç¨å¤§æ¨¡å</strong>è¿è¡å¤çã</p>
<p>ä¸é¢çå ä¸ªAgentä¹æ¯ç±»ä¼¼çæåµï¼å°±ä¸åèµè¿°ã<span data-pm-slice="0 0 []">ç¶åï¼å¨Program.csä¸­è¿è¡æ³¨åï¼å®æç«¯å£æ å°ï¼</span></p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> A2A;
</span><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> A2A.AspNetCore;
</span><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> WeatherAgentServer;

</span><span style="color: rgba(0, 0, 255, 1)">var</span> builder =<span style="color: rgba(0, 0, 0, 1)"> WebApplication.CreateBuilder(args);
</span><span style="color: rgba(0, 0, 255, 1)">var</span> app =<span style="color: rgba(0, 0, 0, 1)"> builder.Build();

</span><span style="color: rgba(0, 0, 255, 1)">var</span> taskManager = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> TaskManager();
</span><span style="color: rgba(0, 0, 255, 1)">var</span> agent = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> WeatherAgent();
agent.Attach(taskManager);
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Add JSON-RPC endpoint for A2A</span>
app.MapA2A(taskManager, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">/weather</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Add well-known agent card endpoint for A2A</span>
app.MapWellKnownAgentCard(taskManager, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">/weather</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Add HTTP endpoint for A2A</span>
app.MapHttpA2A(taskManager, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">/weather</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

app.Run();</span></pre>
</div>
<h3><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;p&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;outline: 0px;visibility: visible;line-height: 1.75em;margin-top: 16px;margin-bottom: 16px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><span>3.2 éåºAgent</span></span></h3>
<p><span data-pm-slice="0 0 []">åå»ºä¸ä¸ªHotelAgentç±»ï¼å®ä¹å¶è½å å AgentCardï¼</span></p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> HotelAgent
{
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> Attach(ITaskManager taskManager)
    {
        taskManager.OnMessageReceived </span>=<span style="color: rgba(0, 0, 0, 1)"> QueryHotelsAsync;
        taskManager.OnAgentCardQuery </span>=<span style="color: rgba(0, 0, 0, 1)"> GetAgentCardAsync;
    }

    </span><span style="color: rgba(0, 0, 255, 1)">private</span> Task&lt;A2AResponse&gt;<span style="color: rgba(0, 0, 0, 1)"> QueryHotelsAsync(MessageSendParams messageSendParams, CancellationToken cancellationToken)
    {
        </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (cancellationToken.IsCancellationRequested)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">return</span> Task.FromCanceled&lt;A2AResponse&gt;<span style="color: rgba(0, 0, 0, 1)">(cancellationToken);
        }

        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Process the message</span>
        <span style="color: rgba(0, 0, 255, 1)">var</span> messageText = messageSendParams.Message.Parts.OfType&lt;TextPart&gt;<span style="color: rgba(0, 0, 0, 1)">().First().Text;

        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Create and return an artifact</span>
        <span style="color: rgba(0, 0, 255, 1)">var</span> message = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> AgentMessage()
        {
            Role </span>=<span style="color: rgba(0, 0, 0, 1)"> MessageRole.Agent,
            MessageId </span>=<span style="color: rgba(0, 0, 0, 1)"> Guid.NewGuid().ToString(),
            ContextId </span>=<span style="color: rgba(0, 0, 0, 1)"> messageSendParams.Message.ContextId,
            Parts </span>= [<span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> TextPart() {
                Text </span>= $<span style="color: rgba(128, 0, 0, 1)">"""
</span>                    ð¨ **éåºæ¨è**<span style="color: rgba(0, 0, 0, 1)">

                    æ ¹æ®æ¨çéæ±ï¼ä¸ºæ¨æ¨èä»¥ä¸éåºï¼

                    </span>**è±ªåå â­â­â­â­â­**
                    <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">. ä¸æµ·å¤æ»©åå°éå¤«éåº
                       </span>-<span style="color: rgba(0, 0, 0, 1)"> ð å¤æ»©æ ¸å¿ä½ç½®ï¼æ±æ¯æ¿
                       </span>- ð° Â¥<span style="color: rgba(128, 0, 128, 1)">2</span>,<span style="color: rgba(128, 0, 128, 1)">500</span>/<span style="color: rgba(0, 0, 0, 1)">æèµ·
                       </span>- â­ è¯å <span style="color: rgba(128, 0, 128, 1)">4.9</span>/<span style="color: rgba(128, 0, 128, 1)">5.0</span>

                    **èéå â­â­â­â­**
                    <span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">. ä¸æµ·éå®é¦æ ¼éæå¤§éåº
                       </span>-<span style="color: rgba(0, 0, 0, 1)"> ð éå®å¯ºååï¼äº¤éä¾¿å©
                       </span>- ð° Â¥<span style="color: rgba(128, 0, 128, 1)">1</span>,<span style="color: rgba(128, 0, 128, 1)">200</span>/<span style="color: rgba(0, 0, 0, 1)">æèµ·
                       </span>- â­ è¯å <span style="color: rgba(128, 0, 128, 1)">4.7</span>/<span style="color: rgba(128, 0, 128, 1)">5.0</span>

                    **ç»æµå â­â­â­**
                    <span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">. å¨å­£éåºï¼ä¸æµ·åäº¬è·¯åºï¼
                       </span>-<span style="color: rgba(0, 0, 0, 1)"> ð åäº¬è·¯æ­¥è¡è¡æ
                       </span>- ð° Â¥<span style="color: rgba(128, 0, 128, 1)">380</span>/<span style="color: rgba(0, 0, 0, 1)">æèµ·
                       </span>- â­ è¯å <span style="color: rgba(128, 0, 128, 1)">4.5</span>/<span style="color: rgba(128, 0, 128, 1)">5.0</span><span style="color: rgba(0, 0, 0, 1)">

                    ð¡ æç¤ºï¼å»ºè®®æåé¢è®¢ï¼å¨æ«åèåæ¥ä»·æ ¼å¯è½ä¸æ¶¨ </span><span style="color: rgba(128, 0, 128, 1)">20</span>-<span style="color: rgba(128, 0, 128, 1)">50</span>%<span style="color: rgba(0, 0, 0, 1)">ã
                    </span><span style="color: rgba(128, 0, 0, 1)">"""
</span><span style="color: rgba(0, 0, 0, 1)">            }]
        };

        </span><span style="color: rgba(0, 0, 255, 1)">return</span> Task.FromResult&lt;A2AResponse&gt;<span style="color: rgba(0, 0, 0, 1)">(message);
    }

    </span><span style="color: rgba(0, 0, 255, 1)">private</span> Task&lt;AgentCard&gt; GetAgentCardAsync(<span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)"> agentUrl, CancellationToken cancellationToken)
    {
        </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (cancellationToken.IsCancellationRequested)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">return</span> Task.FromCanceled&lt;AgentCard&gt;<span style="color: rgba(0, 0, 0, 1)">(cancellationToken);
        }

        </span><span style="color: rgba(0, 0, 255, 1)">var</span> capabilities = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> AgentCapabilities()
        {
            Streaming </span>= <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">,
            PushNotifications </span>= <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">,
        };

        </span><span style="color: rgba(0, 0, 255, 1)">return</span> Task.FromResult(<span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> AgentCard()
        {
            Name </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">hotel-a2a-agent</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
            Description </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">hotel information agent</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
            Url </span>=<span style="color: rgba(0, 0, 0, 1)"> agentUrl,
            Version </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">1.0.0</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
            DefaultInputModes </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">text</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
            DefaultOutputModes </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">text</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
            Capabilities </span>=<span style="color: rgba(0, 0, 0, 1)"> capabilities,
            Skills </span>=<span style="color: rgba(0, 0, 0, 1)"> [
                </span><span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> AgentSkill
                {
                    Id </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">hotel-recommendation</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
                    Name </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">éåºæ¨è</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
                    Description </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æ ¹æ®ç®çå°åé¢ç®æ¨èåéçéåºï¼åæ¬è±ªååãèéåãç»æµå</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
                    Tags </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">hotel</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">accommodation</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">booking</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">travel</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
                    Examples </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æ¨èä¸æµ·çéåº</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ä¸æµ·å¤æ»©éè¿æä»ä¹å¥½éåº</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">é¢ç®500ä»¥åçåäº¬éåº</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
                    InputModes </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">text</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
                    OutputModes </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">text</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">]
                }
                ],
        });
    }
}</span></pre>
</div>
<p>åæ ·ï¼è¯·åèå¤©æ°Agentå®æProgram.csä¸­çæ³¨åã</p>
<h3 data-pm-slice="2 3 []"><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;p&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;outline: 0px;visibility: visible;line-height: 1.75em;margin-top: 16px;margin-bottom: 16px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><span>3.3 æ¯ç¹Agent</span></span></h3>
<p><span data-pm-slice="0 0 []">åå»ºä¸ä¸ªPlanAgentç±»ï¼å®ä¹å¶è½å å AgentCardï¼</span></p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> PlanAgent
{
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> Attach(ITaskManager taskManager)
    {
        taskManager.OnMessageReceived </span>=<span style="color: rgba(0, 0, 0, 1)"> QueryPlansAsync;
        taskManager.OnAgentCardQuery </span>=<span style="color: rgba(0, 0, 0, 1)"> GetAgentCardAsync;
    }

    </span><span style="color: rgba(0, 0, 255, 1)">private</span> Task&lt;A2AResponse&gt;<span style="color: rgba(0, 0, 0, 1)"> QueryPlansAsync(MessageSendParams messageSendParams, CancellationToken cancellationToken)
    {
        </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (cancellationToken.IsCancellationRequested)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">return</span> Task.FromCanceled&lt;A2AResponse&gt;<span style="color: rgba(0, 0, 0, 1)">(cancellationToken);
        }

        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Process the message</span>
        <span style="color: rgba(0, 0, 255, 1)">var</span> messageText = messageSendParams.Message.Parts.OfType&lt;TextPart&gt;<span style="color: rgba(0, 0, 0, 1)">().First().Text;

        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Create and return an artifact</span>
        <span style="color: rgba(0, 0, 255, 1)">var</span> message = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> AgentMessage()
        {
            Role </span>=<span style="color: rgba(0, 0, 0, 1)"> MessageRole.Agent,
            MessageId </span>=<span style="color: rgba(0, 0, 0, 1)"> Guid.NewGuid().ToString(),
            ContextId </span>=<span style="color: rgba(0, 0, 0, 1)"> messageSendParams.Message.ContextId,
            Parts </span>= [<span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> TextPart() {
                Text </span>= $<span style="color: rgba(128, 0, 0, 1)">"""
</span>                    ð¡ **æ¯ç¹æ¨è**<span style="color: rgba(0, 0, 0, 1)">

                    ä¸ºæ¨æ¨èä¸æµ·å¿æ¸¸æ¯ç¹ï¼

                    </span>**åå²æåç±»**
                    <span style="color: rgba(128, 0, 128, 1)">1</span>. ðï¸ å¤æ»© -<span style="color: rgba(0, 0, 0, 1)"> æ¬£èµä¸å½å»ºç­åè§ç¾¤
                    </span><span style="color: rgba(128, 0, 128, 1)">2</span>. ð¯ è±«å­ -<span style="color: rgba(0, 0, 0, 1)"> æ±åå¤å¸å­æä»£è¡¨
                    </span><span style="color: rgba(128, 0, 128, 1)">3</span>. ð åéåº -<span style="color: rgba(0, 0, 0, 1)"> åå°å°éä¸æµ·å°å

                    </span>**ç°ä»£é½å¸ç±»**
                    <span style="color: rgba(128, 0, 128, 1)">4</span>. ð¼ ä¸æ¹æç å¡ -<span style="color: rgba(0, 0, 0, 1)"> ä¸æµ·å°æ ï¼ä¿¯ç°æµ¦æ±ä¸¤å²¸
                    </span><span style="color: rgba(128, 0, 128, 1)">5</span>. ð éå®¶å´ -<span style="color: rgba(0, 0, 0, 1)"> éèä¸­å¿ï¼ä¸æµ·ä¹å·
                    </span><span style="color: rgba(128, 0, 128, 1)">6</span>. ðï¸ åäº¬è·¯æ­¥è¡è¡ -<span style="color: rgba(0, 0, 0, 1)"> è´­ç©å¤©å 

                    </span>**æèºä¼é²ç±»**
                    <span style="color: rgba(128, 0, 128, 1)">7</span>. ð¨ ç°å­å -<span style="color: rgba(0, 0, 0, 1)"> æèºå°åºèéå°
                    </span><span style="color: rgba(128, 0, 128, 1)">8</span>. ð æ­¦åº·è·¯ -<span style="color: rgba(0, 0, 0, 1)"> æ¢§æ¡æ ä¸çæ³å¼é£æ
                    </span><span style="color: rgba(128, 0, 128, 1)">9</span>. ð³ ä¸çºªå¬å­ -<span style="color: rgba(0, 0, 0, 1)"> åå¸ç»¿èºï¼äº²å­æ¸¸é¦é

                    ð å»ºè®®æ¸¸ç©æ¶é´ï¼</span><span style="color: rgba(128, 0, 128, 1)">3</span>-<span style="color: rgba(128, 0, 128, 1)">4</span><span style="color: rgba(0, 0, 0, 1)"> å¤©å¯è¦çä¸»è¦æ¯ç¹
                    </span><span style="color: rgba(128, 0, 0, 1)">"""
</span><span style="color: rgba(0, 0, 0, 1)">            }]
        };

        </span><span style="color: rgba(0, 0, 255, 1)">return</span> Task.FromResult&lt;A2AResponse&gt;<span style="color: rgba(0, 0, 0, 1)">(message);
    }

    </span><span style="color: rgba(0, 0, 255, 1)">private</span> Task&lt;AgentCard&gt; GetAgentCardAsync(<span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)"> agentUrl, CancellationToken cancellationToken)
    {
        </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (cancellationToken.IsCancellationRequested)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">return</span> Task.FromCanceled&lt;AgentCard&gt;<span style="color: rgba(0, 0, 0, 1)">(cancellationToken);
        }

        </span><span style="color: rgba(0, 0, 255, 1)">var</span> capabilities = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> AgentCapabilities()
        {
            Streaming </span>= <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">,
            PushNotifications </span>= <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">,
        };

        </span><span style="color: rgba(0, 0, 255, 1)">return</span> Task.FromResult(<span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> AgentCard()
        {
            Name </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">plan agent</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
            Description </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">travel plan &amp; attraction agent</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
            Url </span>=<span style="color: rgba(0, 0, 0, 1)"> agentUrl,
            Version </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">1.0.0</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
            DefaultInputModes </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">text</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
            DefaultOutputModes </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">text</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
            Capabilities </span>=<span style="color: rgba(0, 0, 0, 1)"> capabilities,
            Skills </span>=<span style="color: rgba(0, 0, 0, 1)"> [
                </span><span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> AgentSkill
                {
                    Id </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">attraction-recommendation</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
                    Name </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æ¯ç¹æ¨è</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
                    Description </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æ¨èç®çå°çç­é¨æ¯ç¹åæ¸¸ç©è·¯çº¿ï¼åæ¬åå²æåãç°ä»£é½å¸ãæèºä¼é²ç­ç±»å</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
                    Tags </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">attraction</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">sightseeing</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">tourism</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">travel</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
                    Examples </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ä¸æµ·æä»ä¹å¥½ç©ç</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">åäº¬å¿å»çæ¯ç¹</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æ­å·è¥¿æ¹æä¹ç©</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
                    InputModes </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">text</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">],
                    OutputModes </span>= [<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">text</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">]
                }
                ],
        });
    }
}</span></pre>
</div>
<p>åæ ·ï¼è¯·åèå¤©æ°Agentå®æProgram.csä¸­çæ³¨åã</p>
<h3 data-pm-slice="2 3 []"><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;p&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;outline: 0px;visibility: visible;line-height: 1.75em;margin-top: 16px;margin-bottom: 16px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><span>3.4 ä¸»å©æ</span></span></h3>
<p><span data-pm-slice="0 0 []"><span><span>è¿éæä»¬æä¸å½åä¸ºTravelPlannerClientï¼å¨è¯¥é¡¹ç®ä¸­æä»¬éè¦ç¨å°<span>MAF<span>ï¼å æ­¤æä»¬åå®è£ä¸ä¸ç¸å³NuGetåï¼</span></span></span></span></span></p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 0, 1)">Microsoft.Extensions.AI.OpenAI
Microsoft.Agents.AI.A2A
Microsoft.Agents.AI.Abstractions
Microsoft.Extensions.AI.Abstractions</span></pre>
</div>
<p>é¦åï¼åå»ºä¸ä¸ªChatClientä¾ä¸»å©æä½¿ç¨ï¼</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> chatClient = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenAIClient(
        </span><span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> ApiKeyCredential(openAIProvider.ApiKey),
        </span><span style="color: rgba(0, 0, 255, 1)">new</span> OpenAIClientOptions { Endpoint = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> Uri(openAIProvider.Endpoint) })
    .GetChatClient(openAIProvider.ModelId)
    .AsIChatClient();</span></pre>
</div>
<p>å¶æ¬¡ï¼å°è¿ç¨A2A Agentsè½¬æ¢ä¸ºAIFunction Toolsï¼</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> agentEndpoints = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)">[]
{
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">https://localhost:7021/a2a</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> hotel agent </span>
    <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">https://localhost:7011/a2a</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> weather agent</span>
    <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">https://localhost:7031/a2a</span><span style="color: rgba(128, 0, 0, 1)">"</span> <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> plan agent</span>
<span style="color: rgba(0, 0, 0, 1)">};

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Collecting all AI Tools</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> functionTools = <span style="color: rgba(0, 0, 255, 1)">new</span> List&lt;AIFunction&gt;<span style="color: rgba(0, 0, 0, 1)">();
</span><span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> endpoint <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> agentEndpoints)
{
    </span><span style="color: rgba(0, 0, 255, 1)">var</span> resolver = <span style="color: rgba(0, 0, 255, 1)">new</span> A2ACardResolver(<span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> Uri(endpoint));
    </span><span style="color: rgba(0, 0, 255, 1)">var</span> card = <span style="color: rgba(0, 0, 255, 1)">await</span><span style="color: rgba(0, 0, 0, 1)"> resolver.GetAgentCardAsync();
    </span><span style="color: rgba(0, 0, 255, 1)">var</span> agent = card.AsAIAgent(); <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Convert A2A Agent to AIAgent instance</span>
<span style="color: rgba(0, 0, 0, 1)">
    functionTools.AddRange(AgentFunctionHelper.CreateFunctionTools(agent, card));
}</span></pre>
</div>
<p>ç¶åï¼åå»ºä¸ä¸ªå¯ä»¥è°ç¨A2A Agentsçä¸»Agentï¼è¿ä¸æ­¥æ¯æ ¸å¿æå¨ï¼</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> mainAgent = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> ChatClientAgent(
    chatClient: chatClient,
    instructions: </span><span style="color: rgba(128, 0, 0, 1)">"""
</span><span style="color: rgba(0, 0, 0, 1)">    ä½ æ¯ä¸ä¸ªæºè½æè¡è§åå©æãä½ å¯ä»¥å©ç¨å¯ç¨çå·¥å·æ¥å¸®å©ç¨æ·å®æä»»å¡ã
    å½ç¨æ·è¯¢é®æ¶ï¼è¯·ä½¿ç¨åéçå·¥å·è·åä¿¡æ¯ï¼ç¶ååå¤ç¨æ·ã
    </span><span style="color: rgba(128, 0, 0, 1)">"""</span><span style="color: rgba(128, 0, 0, 1)">,</span>
<span style="color: rgba(0, 0, 0, 1)">    tools: [.. functionTools]
   );</span></pre>
</div>
<p>æåï¼æä»¬å¯ä»¥åä¸æµè¯ï¼</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ç¨æ·è¯·æ± - æµè¯ä¸åçæè½è°ç¨</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> userRequests = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)">[]
{
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æ¥è¯¢ä¸ä¸ä¸æµ·çå¤©æ°æåµ</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æ¨èä¸ä¸ä¸æµ·çéåº</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¸®æè§åä¸ä¸ä»æ¥ä¸æµ·çä¸æ¥æ¸¸æ¯ç¹ï¼å¹¶åè¯æè¯¥å¦ä½ç©¿è¡£æ</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
};

</span><span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> userRequest <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> userRequests)
{
    Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ââââââââââââââââââââââââââââââââââââââââ</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ð¤ ç¨æ·è¯·æ±: {userRequest}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ââââââââââââââââââââââââââââââââââââââââ</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ§è¡ Agent</span>
    Console.WriteLine(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">â±ï¸ ä¸» Agent å¤çä¸­...</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">var</span> response = <span style="color: rgba(0, 0, 255, 1)">await</span><span style="color: rgba(0, 0, 0, 1)"> mainAgent.RunAsync(userRequest);
    Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ð¬ åç­:\n{response.Text}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    Console.WriteLine();
}</span></pre>
</div>
<p>ç°å¨ï¼æä»¬æ¥ççæµè¯ç»æï¼</p>
<p><strong><strong><strong data-pm-slice="0 0 []"><span><span>case1ï¼<span><span>æ¥è¯¢ä¸ä¸ä¸æµ·çå¤©æ°æåµï¼<strong><strong><strong data-pm-slice="0 0 []"><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;text-transform: none;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;text-align: left;line-height: 1.75em;margin-bottom: 8px;margin-top: 8px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;color: rgba(0, 0, 0, 0.9);font-family: \&quot;PingFang SC\&quot;, system-ui, -apple-system, BlinkMacSystemFont, \&quot;Helvetica Neue\&quot;, \&quot;Hiragino Sans GB\&quot;, \&quot;Microsoft YaHei UI\&quot;, \&quot;Microsoft YaHei\&quot;, Arial, sans-serif;font-size: 17px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;letter-spacing: 0.578px;orphans: 2;text-align: left;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;background-color: rgb(255, 255, 255);text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;visibility: visible;&quot;,&quot;data-pm-slice&quot;:&quot;0 0 []&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><span>ç®åä»»å¡</span></span></strong></strong></strong><span><span>ï¼</span></span></span></span></span></span></strong></strong></strong></p>
<p><img src="https://img2024.cnblogs.com/blog/381412/202602/381412-20260204221026757-365275321.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>å¯ä»¥çå°ï¼ä¸»å©æéè¿è°ç¨å¤©æ°Agentè·åå¤©æ°ä¿¡æ¯å®æäºåç­ã</p>
<p data-pm-slice="0 0 []"><span><span><strong><strong data-pm-slice="2 2 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;text-transform: none;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;text-align: left;line-height: 1.75em;margin-bottom: 8px;margin-top: 8px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><span><span>case2ï¼<span>æ¨èä¸æµ·çéåºï¼ç®åä»»å¡ï¼</span></span></span></strong></strong></span></span></p>
<p><img src="https://img2024.cnblogs.com/blog/381412/202602/381412-20260204221108758-778672394.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p data-pm-slice="0 0 []">&nbsp;</p>
<p data-pm-slice="0 0 []"><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;text-transform: none;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;text-align: left;line-height: 1.75em;margin-bottom: 8px;margin-top: 8px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;color: rgba(0, 0, 0, 0.9);font-family: \&quot;PingFang SC\&quot;, system-ui, -apple-system, BlinkMacSystemFont, \&quot;Helvetica Neue\&quot;, \&quot;Hiragino Sans GB\&quot;, \&quot;Microsoft YaHei UI\&quot;, \&quot;Microsoft YaHei\&quot;, Arial, sans-serif;font-size: 17px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;letter-spacing: 0.578px;orphans: 2;text-align: left;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;background-color: rgb(255, 255, 255);text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;visibility: visible;&quot;,&quot;data-pm-slice&quot;:&quot;0 0 []&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]">å¯ä»¥çå°ï¼ä¸»å©æéè¿è°ç¨éåºAgentè·åéåºä¿¡æ¯å®æäºåç­</span></p>
<p data-pm-slice="0 0 []"><strong><strong><strong data-pm-slice="0 0 []"><strong><strong data-pm-slice="2 2 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;text-transform: none;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;text-align: left;line-height: 1.75em;margin-bottom: 8px;margin-top: 8px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><span><span>case3ï¼å¸®æè§åä¸ä¸ä»æ¥ä¸æµ·çä¸æ¥æ¸¸æ¯ç¹ï¼å¹¶åè¯æè¯¥å¦ä½ç©¿è¡£æ<span><span>ï¼å¤æä»»å¡ï¼</span></span></span></span></strong></strong></strong></strong></strong></p>
<p><img src="https://img2024.cnblogs.com/blog/381412/202602/381412-20260204221128267-114288133.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p data-pm-slice="0 0 []">å¯ä»¥çå°ï¼ä¸»å©æè°ç¨äºå¤ä¸ªAgentï¼æ¯ç¹Agent å å¤©æ°Agentï¼è·åä¿¡æ¯ï¼è¿å¨æ­¤ä¹ä¸è¿è¡äºæ´åä¼åï¼æåè¾åºäºå®åçåå¤ã</p>
<h1 data-pm-slice="0 0 []">4 å°ç»</h1>
<p data-pm-slice="0 0 []">æ¬æä»ç»äºMAFä¸­éæA2A Agentçæ ¸å¿æä½ï¼å°A2A Agentè½¬æ¢ä¸ºAIFunctionå·¥å·ï¼ç¶åç±ä¸»Agentèªä¸»éæ©è°ç¨æç»çæåç­ï¼å¸ææ¬æçæ¡ä¾å¯¹ä½ ææå¸®å©ã</p>
<h1>ç¤ºä¾æºç </h1>
<p>GitHub:&nbsp;<a href="https://github.com/EdisonTalk/MAFD" target="_blank" rel="noopener nofollow">https://github.com/EdisonTalk/MAFD</a></p>
<h1>åèèµæ</h1>
<p><span data-pm-slice="0 0 []"><span>å£æ°ï¼ã<a href="https://www.cnblogs.com/sheng-jie/p/19200934" target="_blank">.NET + AI æºè½ä½å¼åè¿é¶</a>ãï¼æ¨èææ°ï¼âââââï¼</span></span></p>
<p><span data-pm-slice="0 0 []"><span>Microsoft Learnï¼<span>ã<a href="https://learn.microsoft.com/en-us/agent-framework/overview/agent-framework-overview?wt.mc_id=MVP_397012" target="_blank" rel="noopener nofollow">Agent Framework Tutorials</a>ã</span></span></span></p>
<div><span data-pm-slice="0 0 []"><span>&nbsp;</span></span></div>
<p style="text-align: center"><img src="https://images.cnblogs.com/cnblogs_com/edisonchou/1647700/o_200902144330EdisonTalk-Footer.jpg" alt="" style="width: 65%; border: 1px solid rgba(221, 221, 221, 1); border-radius: 3px; box-shadow: 0 4px 8px rgba(3, 27, 78, 0.12)"></p>
<div id="Copyright">
<p>ä½èï¼<span style="text-decoration: underline">ç±è¿ªç</span></p>
<p>åºå¤ï¼<a title="from" href="https://edisontalk.cnblogs.com" target="_blank">https://edisontalk.cnblogs.com</a></p>
<p>æ¬æçæå½ä½èååå®¢å­å±æï¼æ¬¢è¿è½¬è½½ï¼ä½æªç»ä½èåæå¿é¡»ä¿çæ­¤æ®µå£°æï¼ä¸å¨æç« é¡µé¢ææ¾ä½ç½®ç»åºåæé¾æ¥ã</p>
</div>

</div>
<div id="MySignature" role="contentinfo">
    <div align="center"><a href="https://weibo.com/u/2068032061?s=6uyXnP" target="_blank"><img border="0" src="http://service.t.sina.com.cn/widget/qmd/2068032061/d643d182/10.png"></a></div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-04 22:17">2026-02-04 22:17</span>&nbsp;
<a href="https://www.cnblogs.com/edisontalk">EdisonZhou</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19576617);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19576617', targetLink: 'https://www.cnblogs.com/edisontalk/p/-/quick-start-on-maf-chatper14', title: 'MAFå¿«éå¥é¨ï¼14ï¼å¿«ééæA2A Agent' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>