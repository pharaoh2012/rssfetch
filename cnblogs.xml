<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-02-21T01:27:45.152Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ ãæ¬å°è®¯ãC++çç°âç¥ç§ä»£ç âï¼ä¸è¡æä»¤å¤éæ²ç¡çæ°å­¦ä¹ç¾ ]]></title>
    <link>https://www.cnblogs.com/lixingqiu/p/19627496</link>
    <guid>537810bf82be5afca23450c5e27df302</guid>
    <description>
    <![CDATA[ 
	<h1 class="postTitle"><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/lixingqiu/p/19627496" title="åå¸äº 2026-02-21 08:34">
    <span role="heading" aria-level="2">ãæ¬å°è®¯ãC++çç°âç¥ç§ä»£ç âï¼ä¸è¡æä»¤å¤éæ²ç¡çæ°å­¦ä¹ç¾</span>
    

</a>
</h1>
	<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<img alt="2026-02-21_081653" loading="lazy" data-src="https://img2024.cnblogs.com/blog/523461/202602/523461-20260221081740482-361727466.png" class="lazyload">
<p><span data-cke-copybin-start="1"><span data-cke-copybin-start="1">â</span></span></p>
<p>æ³¨æï¼ä»¥ä¸è®°èä¸æ¥éçº¯å±èæï¼ä½C++ç²¾çµåºåå®çæ¡ä¾ä¸æé³å·éè§é¢å´æ¯çå®å­å¨çã</p>
<h2>ï¼æ¬å°è®°è 2026å¹´2æ21æ¥ æ¥éï¼<br>
æè®°èæ¥éï¼ä¸ä¸ªç¥ç§çâç²¾çµåºâè¿æ¥âæ¶ç°âå¨æé³ãä¼ è¯´ä½èç¨è¿ä¸ªç²¾çµåºåäºå ç¾ä¸ªä½åï¼æäºä½åå·²å½æè§é¢è¿è¡å±ç¤ºï¼ç¬é´å¨ç¨åºååå­åæ°å­¦ç±å¥½èä¸­å¼åäºâå°éâã</h2>
<p><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;p&quot;,&quot;attributes&quot;:{&quot;class&quot;:&quot;MsoNormal&quot;,&quot;style&quot;:&quot;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;span&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;font-size:12.0pt; font-family:å®ä½; mso-bidi-font-family:å®ä½; mso-font-kerning:0pt;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]">è¦çæé³</span>è§é¢å¨è¿éï¼<span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="5" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" title="https://v.douyin.com/IEr8F2q2oic/" href="https://v.douyin.com/IEr8F2q2oic/" data-cke-enter-mode="2" data-cke-saved-href="https://v.douyin.com/IEr8F2q2oic/" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fv.douyin.com%2FIEr8F2q2oic%2F%22%2C%22text%22%3A%22https%3A%2F%2Fv.douyin.com%2FIEr8F2q2oic%2F%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.4.5%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DPBP8%22%2C%22id%22%3A%22z6CELa-1771632732570%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.5/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=PBP8" data-link-title="https://v.douyin.com/IEr8F2q2oic/" data-widget="csdnlink" rel="noopener nofollow">https://v.douyin.com/IEr8F2q2oic/</a></span></p>
<p>è®°èå¨ä¸æ®µæ¶é¿ä»10ç§çè§é¢ä¸­çå°ï¼æ æ°æ¡ç¿ ç»¿è²ä¸é¶ç½è²ççº¿æ¡ï¼å¦åè¢«èµäºäºçå½çä¸å¸¦ï¼å¨çº¯é»çèç©ºä¸­äº¤ç»ãæè½¬ãç»½æ¾ãå®ä»¬æ¶èå¦DNAåèºæè¬ç²¾å¯ç¼ ç»ï¼æ¶èå¦é£é¸æ¯ç¿è¬èå±çµå¨ãä»¤äººéæçæ¯ï¼è¿å¹¶éåºèªä¸ä¸çå¾å½¢è®¾è®¡è½¯ä»¶ï¼ä¹ä¸æ¯PythonæJavaScriptçæ°ä½ï¼èæ¯ç±å¤èèä¸¥è°¨çC++è¯­è¨ï¼éè¿ä¸ä¸ªåä¸ºsprites.hçâç²¾çµåºâå®æ¶æ¸²æèæã</p>
<h2>âæ ¼å­è¡«âç¨åºåçéè¢­ï¼ä»æ¯ç¥ä»£ç å°è§è§èºæ¯</h2>
<p>âä»¥åæä»¬æC++ï¼å­¦çé¢å¯¹çæ¯é»åºç½å­çæ§å¶å°ï¼è¾åºä¸ª'Hello World'é½è¦åå¤©ãâä¸ä½ä¸æ¿éé²å§åçèµæ·±è®¡ç®æºæå¸å¨æ¥åæ¬å°è®°èéè®¿æ¶æå¹éï¼âä½è¿ä¸ªâç²¾çµåºâçåºç°ï¼å½»åºæç ´äºC++âæ¯ç¥ãé¾å­¦ãåªè½ååç«¯âçå»æ¿å°è±¡ãâ<br>
è®°èæ·±å¥ç ç©¶äºæµåºçæ ¸å¿ä»£ç ï¼åç°å¶ç®æ´ç¨åº¦ä»¤äººåèãä¼ ç»çC++å¾å½¢ç¼ç¨å¾å¾éè¦éç½®å¤æçOpenGLç¯å¢ãå¤çæ¦æ¶©ççªå£æ¶æ¯å¾ªç¯ï¼å¨è¾æ°ç¾è¡ä»£ç æè½ç»åºä¸ä¸ªåãèå¨âç²¾çµåºâçå æä¸ï¼ä¸ååå¾åæ­ç§¯æ¨ä¸æ ·ç®åï¼</p>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="ä»£ç æ®µ" data-cke-filter="off" data-cke-widget-id="4" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22classes%22%3Anull%2C%22lang%22%3A%22cpp%22%2C%22code%22%3A%22%23include%20%5C%22sprites.h%5C%22%20%20%2F%2F%20%E4%BB%BF%E4%BD%9B%E4%B8%80%E5%8F%A5%E5%92%92%E8%AF%AD%EF%BC%8C%E6%89%93%E5%BC%80%E4%BA%86%E5%9B%BE%E5%BD%A2%E4%B8%96%E7%95%8C%E7%9A%84%E5%A4%A7%E9%97%A8%5CnScreen%20s%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%B1%8F%E5%B9%95%E5%AF%B9%E8%B1%A1%EF%BC%8C%E5%91%BC%E4%B9%8B%E5%8D%B3%E6%9D%A5%5CnSprite%20r%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E7%94%BB%E7%AC%94%E8%A7%92%E8%89%B2%EF%BC%8C%E5%90%AC%E5%80%99%E5%B7%AE%E9%81%A3%22%7D" data-cke-widget-keep-attr="0" data-widget="codeSnippet"><code class="hljs language-cpp"><span class="hljs-meta">#<span class="hljs-keyword">include <span class="hljs-string">"sprites.h"  <span class="hljs-comment">// ä»¿ä½ä¸å¥åè¯­ï¼æå¼äºå¾å½¢ä¸ççå¤§é¨
Screen s;             <span class="hljs-comment">// å±å¹å¯¹è±¡ï¼å¼ä¹å³æ¥
Sprite r;             <span class="hljs-comment">// ç»ç¬è§è²ï¼å¬åå·®é£</span></span></span></span></span></span></code></pre>
<span class="cke_reset cke_widget_drag_handler_container"><img width="15" height="15" class="cke_reset cke_widget_drag_handler lazyload" title="ç¹å»å¹¶ææ½ä»¥ç§»å¨" data-cke-widget-drag-handler="1" data-src="https://img2024.cnblogs.com/blog/523461/202602/523461-20260220164341919-1115310452.gif"></span></div>
<p>ä»ä»ä¸è¡ä»£ç ï¼ä¸ä¸ªå¾å½¢åçé¢å°±å·²åå¤å°±ç»ªãè¿ç§âé¾å¼è°ç¨âçåæ³ââå¦<code>s.bgcolor("black").tracer(0)</code>ââè¢«ä¸åä¸å®¶ç§°ä¸ºâè®©C++è¯´äººè¯âçé©å½æ§è®¾è®¡ã</p>
<h2><strong>æ°å­¦å¬å¼çâèè¹ç¼æâ</strong></h2>
<p>è§é¢ä¸­é£ä»¤äººç¼è±ç¼­ä¹±çå¨æææï¼èåå¶å®æ¯ä¸¥è°¨æ°å­¦å¬å¼ççæ¬¢ãä»£ç ä¸­ç<code>draw_curver</code>å½æ°ï¼å®éä¸æ¯å¨ææ¥ä¸¤ä¸ªä¸åé¢ççæ­£å¼¦æ³¢è¿è¡ä¸åºæ¢æèã</p>
<p><code>float x = A * sin(30*t + 3);</code> ä¸ <code>float y = k*A * sin(10*t);</code>ï¼è¿ä¸¤è¡ä»£ç åå«æ§å¶äºXè½´åYè½´çæ³¢å¨ãèå¨<code>rotate_point</code>å½æ°ä¸­ï¼æ­£å¼¦ä¸ä½å¼¦çç²¾å¯è®¡ç®ï¼è®©æ¯ä¸ä¸ªåæ ç¹é½å¨ç©ºé´ä¸­å®æäºåä¸½çè½¬èº«ã</p>
<p>âè¿ä¸ä»ä»æ¯ç¼ç¨ï¼è¿æ¯æ°å­¦çå¯è§åèºæ¯ãâä¸ä½æ°å­¦ç³»ææå¨è§çè§é¢åè¯ä»·éï¼âä½èéè¿<code>rotate_angle += 0.02</code>è¿æ ·ç®åçç´¯å ï¼å°±è®©éæçå¬å¼âæ´»âäºè¿æ¥ï¼åæäºæµå¨çè§è§çå®´ãâ</p>
<h2><strong>æè²ççæ°å® ï¼è®©åæé£ä¸ä¼å¿</strong></h2>
<p>æ®æï¼è¿ä¸ªâç²¾çµåºâæå¤§çä»·å¼å¨äºæå¤§å°éä½äºC++ç¼ç¨çé¨æ§ãå®å±è½äºåºå±å¤æçå¾å½¢æ¸²ææºå¶ï¼è®©ä½¿ç¨èåªéå³æ³¨é»è¾ä¸åæã</p>
<p>å¨ä»£ç ç<code>main</code>å½æ°ä¸­ï¼ä¸ä¸ªç®æ´ç<code>while(s.exitonclick())</code>å¾ªç¯ï¼å°±æå»ºèµ·äºä¸ä¸ªå®æ´çå¨ç»å¼æãæ¸å±ãç»å¶ãå·æ°ãå»¶æ¶ï¼ä¸æ°åµæãè¿æå³çï¼å³ä½¿æ¯ç¼ç¨åå­¦èï¼ä¹è½å¨ç¬¬ä¸è¯¾å°±ååºå±äºèªå·±çå¨ç»ä½åï¼èä¸æ¯å¯¹çæ§å¶å°ååã</p>
<p>ç®åï¼å³äºè¿ä¸ªâç²¾çµåºâçä¸è½½æ¹å¼åå®æ´ææ¡£ä»å¨ææ¯ç¤¾åºä¸­ç¯ä¼ ãæè¯è®ºå®¶é¢æµï¼è¿å¯è½ä¼å¼åä¸åºC++æå­¦æ³çé©æ°ââä»æ­¤ï¼C++ä¸ååªæ¯å·¥ç¨å¸æä¸­çé¤å­ï¼æ´æ¯èºæ¯å®¶æä¸­çç»ç¬ã</p>
<p>æªè³åç¨¿æ¶ï¼è®°èåæ¬¡è§çé£æ®µè§é¢ï¼é£äºç»¿è²ççº¿æ¡ä¾ç¶å¨å±å¹ä¸ä¸ç¥ç²å¦å°æè½¬çï¼ä»¿ä½å¨æ å£°å°è¯è¯´çï¼<strong>ä»£ç ï¼åæ¥å¯ä»¥å¦æ­¤æ§æã</strong></p>
<p><strong>ç¨åºææä»£ç å¨æ­¤ï¼</strong></p>
<p><span data-cke-copybin-start="1"><span data-cke-copybin-end="1">â</span></span></p>
<div class="cnblogs_code">
<pre>#include <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">sprites.h</span><span style="color: rgba(128, 0, 0, 1)">"</span>  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">åå«C++ç²¾çµåº </span>
Screen s;      <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">å»ºç«å±å¹å¯¹è±¡å«s</span>
Sprite r;      <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">å»ºç«è§è²å«r

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æè½¬å½æ°ï¼è¾å¥åå§åæ åæè½¬è§åº¦ï¼è¿åæè½¬åçåæ </span>
<span style="color: rgba(0, 0, 255, 1)">void</span> rotate_point(<span style="color: rgba(0, 0, 255, 1)">float</span>&amp; x, <span style="color: rgba(0, 0, 255, 1)">float</span>&amp; y, <span style="color: rgba(0, 0, 255, 1)">float</span><span style="color: rgba(0, 0, 0, 1)"> angle) {
    </span><span style="color: rgba(0, 0, 255, 1)">float</span> cos_a = cos(angle);  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è§åº¦çä½å¼¦å¼</span>
    <span style="color: rgba(0, 0, 255, 1)">float</span> sin_a = sin(angle);  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è§åº¦çæ­£å¼¦å¼
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ä¿å­åå§åæ ï¼é¿åè®¡ç®æ¶è¦çï¼</span>
    <span style="color: rgba(0, 0, 255, 1)">float</span> x_original =<span style="color: rgba(0, 0, 0, 1)"> x;
    </span><span style="color: rgba(0, 0, 255, 1)">float</span> y_original =<span style="color: rgba(0, 0, 0, 1)"> y;
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> åºç¨æè½¬åæ¢å¬å¼</span>
    x = x_original * cos_a - y_original *<span style="color: rgba(0, 0, 0, 1)"> sin_a;
    y </span>= x_original * sin_a + y_original *<span style="color: rgba(0, 0, 0, 1)"> cos_a;
}

</span><span style="color: rgba(0, 0, 255, 1)">void</span> draw_curver(<span style="color: rgba(0, 0, 255, 1)">float</span> k, <span style="color: rgba(0, 0, 255, 1)">float</span><span style="color: rgba(0, 0, 0, 1)"> rotate_angle){    
   </span><span style="color: rgba(0, 0, 255, 1)">for</span>(<span style="color: rgba(0, 0, 255, 1)">int</span> A=<span style="color: rgba(128, 0, 128, 1)">0</span>;A&lt;=<span style="color: rgba(128, 0, 128, 1)">100</span>;A+=<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">){       
       </span><span style="color: rgba(0, 0, 255, 1)">float</span> t=-<span style="color: rgba(128, 0, 128, 1)">2.0</span><span style="color: rgba(0, 0, 0, 1)">;      
       </span><span style="color: rgba(0, 0, 255, 1)">while</span>(t&lt;=<span style="color: rgba(128, 0, 128, 1)">2.0</span><span style="color: rgba(0, 0, 0, 1)">){
          </span><span style="color: rgba(0, 0, 255, 1)">float</span> x = A * sin(<span style="color: rgba(128, 0, 128, 1)">30</span>*t + <span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">);
          </span><span style="color: rgba(0, 0, 255, 1)">float</span> y = k*A * sin(<span style="color: rgba(128, 0, 128, 1)">10</span>*<span style="color: rgba(0, 0, 0, 1)">t);          
          </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å¯¹æ¯ä¸ªç¹è¿è¡æè½¬åæ¢</span>
<span style="color: rgba(0, 0, 0, 1)">          rotate_point(x, y, rotate_angle);          
          r.penshade(x</span>+y).go(y,x);    <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">.dot(1);</span>
          <span style="color: rgba(0, 0, 255, 1)">if</span>(!<span style="color: rgba(0, 0, 0, 1)">r.isdown())r.pendown();
          t </span>= t + <span style="color: rgba(128, 0, 128, 1)">0.01</span><span style="color: rgba(0, 0, 0, 1)">;                  
       }    
       r.penup();  
    }
}

</span><span style="color: rgba(0, 0, 255, 1)">int</span> main(){        <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">ä¸»åè½å </span>
   s.bgcolor(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">black</span><span style="color: rgba(128, 0, 0, 1)">"</span>).tracer(<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
   r.speed(</span><span style="color: rgba(128, 0, 128, 1)">0</span>).color(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">lime</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">).pu().hide();
   </span><span style="color: rgba(0, 0, 255, 1)">float</span> k=<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
   </span><span style="color: rgba(0, 0, 255, 1)">float</span> rotate_angle = <span style="color: rgba(128, 0, 128, 1)">0</span>;  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">æè½¬è§åº¦åéï¼åå§ä¸º0</span>
   <span style="color: rgba(0, 0, 255, 1)">while</span>(s.exitonclick()){  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">åå»çªå£æé®è¿åå®¶falseï¼æä»¥whileå¾ªç¯ç»æ</span>
      s.clear();            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">æ¸é¤ææç»çä¸è¥¿
      </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ä¼ å¥æè½¬è§åº¦ï¼è®©æ¬æ¬¡ç»å¶çææç¹é½æè½¬</span>
      draw_curver(<span style="color: rgba(128, 0, 128, 1)">3</span>*<span style="color: rgba(0, 0, 0, 1)">sin(k), rotate_angle);
      s.update().wait(</span><span style="color: rgba(128, 0, 128, 1)">0.01</span>);   <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">å·æ°å¹¶ç­å¾0.01ç§ï¼åºå®å¸§ç</span>
      k = k + <span style="color: rgba(128, 0, 128, 1)">0.01</span><span style="color: rgba(0, 0, 0, 1)">;
      rotate_angle </span>+= <span style="color: rgba(128, 0, 128, 1)">0.02</span>;  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ§å¶æè½¬éåº¦ï¼å¼è¶å¤§è½¬å¾è¶å¿«ï¼</span>
<span style="color: rgba(0, 0, 0, 1)">   }    
   </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span>;    <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">è¿å0</span>
}</pre>
</div>
<p>&nbsp;</p>

</div>
<div class="clear"></div>

	<div class="postDesc">posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-21 08:35">2026-02-21 08:34</span>&nbsp;
<a href="https://www.cnblogs.com/lixingqiu">æå´ç</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19627496);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19627496', targetLink: 'https://www.cnblogs.com/lixingqiu/p/19627496', title: 'ãæ¬å°è®¯ãC++çç°âç¥ç§ä»£ç âï¼ä¸è¡æä»¤å¤éæ²ç¡çæ°å­¦ä¹ç¾' })">ä¸¾æ¥</a>
</div>
 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æ¨¡æéç«ç®æ³ ]]></title>
    <link>https://www.cnblogs.com/PaperPlaneFly/p/19626799</link>
    <guid>044d6b7c4716bcb5b1b33ef6890a5c68</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/PaperPlaneFly/p/19626799" title="åå¸äº 2026-02-20 20:14">
    <span role="heading" aria-level="2">æ¨¡æéç«ç®æ³</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220201320618-591678279.png" alt="æ¨¡æéç«ç®æ³" class="desc_img">
        æ¨¡æéç«ç®æ³ææ©çææ³ç±**Metropolis **ç­ï¼** **1953** **ï¼æåºï¼** **1983** **å¹´** **Kirkpatrick** **ç­å°å¶åºç¨äºç»åä¼åã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="æ¨¡æéç«ç®æ³">æ¨¡æéç«ç®æ³</h1>
<p>â    <strong>æ¨¡æéç«ç®æ³ææ©çææ³ç±</strong>Metropolis <strong>ç­ï¼</strong> <strong>1953</strong> <strong>ï¼æåºï¼</strong> <strong>1983</strong> <strong>å¹´</strong> <strong>Kirkpatrick</strong> <strong>ç­å°å¶åºç¨äºç»åä¼åã</strong></p>
<p><strong>ç®æ³çç®ç</strong>ï¼</p>
<p><strong>åæä¼åè¿ç¨é·å¥å±é¨æå°ï¼</strong></p>
<p><strong>åæåå¼ä¾èµæ§ã</strong></p>
<h2 id="ç©çéç«è¿ç¨">ç©çéç«è¿ç¨</h2>
<p>å¨ç©çå­¦ä¸­ï¼<strong>éç«</strong>æ¯å°éå±å ç­å°æé«æ¸©åº¦ï¼ç¶åè®©å¶<strong>æå¶ç¼æ¢</strong>å°å·å´çè¿ç¨ã</p>
<ul>
<li><strong>é«æ¸©ç¶æ</strong>ï¼åå­è¿å¨å§çï¼å¤äºæ åºç¶æï¼é«è½éï¼ã</li>
<li><strong>ç­æ¸©è¿ç¨</strong>  <strong>å¯¹äºä¸ç¯å¢æ¢ç­èæ¸©åº¦ä¸åçå°é­ç³»ç»ï¼ç³»ç»ç¶æçèªåååæ»æ¯æèªç±è½åå°çæ¹åè¿è¡ï¼å½èªç±è½è¾¾å°æå°æ¶ï¼ç³»ç»è¾¾å°å¹³è¡¡æï¼</strong></li>
<li><strong>ç¼æ¢å·å´</strong>ï¼åå­éæ¸æ¾å°æç¨³å®çä½ç½®ï¼å½¢ææ´é½çæ¶ä½ç»æã</li>
<li><strong>æç»ç¶æ</strong>ï¼ç³»ç»ç<strong>åè½æä½</strong>ï¼å¨å±æä¼ï¼ã</li>
</ul>
<p>å¦æå·å´å¾å¤ªå¿«ï¼<strong>æ·¬ç«</strong>ï¼Quenchingï¼ï¼åå­æ¥ä¸åè°æ´ä½ç½®å°±è¢«âå»ç»âå¨æä¹±çç¶æï¼ç³»ç»å¤äºäºç¨³æï¼å±é¨æä¼ï¼åè½è¾é«ï¼ææèï¼ã</p>
<p>æ¸©åº¦è¶ä½ï¼ç©ä½çè½éç¶æè¶ä½ï¼å°è¾¾è¶³å¤çä½ç¹æ¶ï¼æ¶²ä½å¼å§å·åä¸ç»æ¶ï¼å¨ç»æ¶ç¶ææ¶ï¼ç³»ç»çè½éç¶ææä½ãç¼æ¢éæ¸©ï¼éç«æ¶ï¼å¯è¾¾å°æä½è½éç¶æï¼ä½å¦æå¿«ééæ¸©ï¼æ·¬ç«ï¼ä¼å¯¼è´ä¸æ¯æä½è½æçéæ¶å½¢ã</p>
<h2 id="boltzmannæ¦çåå¸"><strong>Boltzmann</strong>æ¦çåå¸</h2>
<p>å¨æ¸©åº¦Tï¼åå­åçå¨ç¶æræ»¡è¶³Boltzmannæ¦çåå¸</p>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200000416-839968077.png" alt="image" loading="lazy"></p>
<p><img src="https://ts3.tc.mm.bing.net/th/id/OIP-C.F28T_kCjs5-MqGcOpdgA9wHaE1?rs=1&amp;pid=ImgDetMain&amp;o=7&amp;rm=3" alt="ç§å­¦ç½âç§å­¦å²-ç©çå­¦ç¼å¹´å²-80ç»å°å¹æ¼åå¸å¾ - å¼ å»¶å¹´çåæ" loading="lazy"></p>
<p>å¨åä¸ä¸ªæ¸©åº¦Tï¼éå®ä¸¤ä¸ªè½éE1&lt;E2ï¼æ</p>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200026317-2005365913.png" alt="image" loading="lazy"></p>
<p><strong>ï¼</strong>1<strong>ï¼å¨åä¸ä¸ªæ¸©åº¦ï¼åå­åçå¨è½éå°ç¶æçæ¦çå¤§äºåçå¨è½éå¤§ç¶æçæ¦ç</strong></p>
<p><strong>ï¼</strong>2<strong>ï¼æ¸©åº¦è¶é«ï¼ä¸åè½éç¶æå¯¹åºçæ¦çç¸å·®è¶å°ï¼æ¸©åº¦è¶³å¤é«æ¶ï¼åç¶æå¯¹åºæ¦çåºæ¬ç¸åã</strong></p>
<p><strong>ï¼</strong>3<strong>ï¼éçæ¸©åº¦çä¸éï¼è½éæä½ç¶æå¯¹åºæ¦çè¶æ¥è¶å¤§ï¼æ¸©åº¦è¶äº</strong>0<strong>æ¶ï¼å¶ç¶æè¶äº</strong>1</p>
<h2 id="metropolisåå"><strong>Metropolis</strong>åå</h2>
<p><strong>ä»¥æ¦çæ¥åæ°ç¶æ</strong></p>
<p>åè®¾å½åç¶æä¸º xï¼è½éä¸º E(x)ã</p>
<p>æä»¬éæºçæäºä¸ä¸ªé»åæ°è§£ x'ï¼è½éä¸º E(x')ã</p>
<p>å®ä¹è½éå·®ä¸ºï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200221455-1081080706.png" alt="image" loading="lazy"></p>
<p>ç®åæ¥è¯´ï¼å®çæ ¸å¿æ°å­¦ææ³æ¯ï¼<strong>ä»¥ä¸å®çæ¦çæ¥åä¸ä¸ªâæ´å·®âçè§£ï¼ä»èè·³åºå±é¨æä¼é·é±ï¼æç»è¶åå¨å±æä¼ã</strong></p>
<h4 id="æåµ-aæ°è§£æ´å¥½-Î´e0">æåµ Aï¼æ°è§£æ´å¥½ (Î<em>E</em>&lt;0)</h4>
<p>å¦ææ°è§£çè½éæ´ä½ï¼æ¯å¦å¨ä¸å±±ï¼ï¼æä»¬<strong>100% æ¥å</strong>è¿ä¸ªæ°è§£ã</p>
<p><em>P</em>(accept)=1</p>
<p>è¿å¯¹åºäºè´ªå¿ç®æ³ï¼Gradient Descentï¼çé¨åã</p>
<h4 id="æåµ-bæ°è§£æ´å·®-Î´e0">æåµ Bï¼æ°è§£æ´å·® (Î<em>E</em>&gt;0)</h4>
<p>å¦ææ°è§£çè½éæ´é«ï¼æ¯å¦è¦ç¬å¡ï¼åæ¹åï¼ï¼æä»¬<strong>ä¸æ¯ç´æ¥æç»</strong>ï¼èæ¯<strong>ä»¥ä¸å®çæ¦çæ¥åå®</strong>ãè¿ä¸ªæ¦ç <em>P</em> æä» <strong>ç»å°å¹æ¼åå¸ (Boltzmann Distribution)</strong>ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200357347-1971444950.png" alt="image" loading="lazy"></p>
<ul>
<li>
<p>Î<em>E</em>ï¼è½éå·®ï¼è¯å®ä¸ºæ­£ï¼ã</p>
</li>
<li>
<p><em>T</em>ï¼å½åçæ¸©åº¦ã</p>
</li>
<li>
<p><em>k</em>ï¼ç©çä¸­çç»å°å¹æ¼å¸¸æ°ï¼å¨ç®æ³ä¸­éå¸¸è®¾ä¸º 1ï¼ã</p>
</li>
</ul>
<h4 id="1-æ¸©åº¦-t-æé«æ¶-æ¢ç´¢é¶æ®µ">(1) æ¸©åº¦ T æé«æ¶ (æ¢ç´¢é¶æ®µ)</h4>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200411620-1794628474.png" alt="image" loading="lazy"></p>
<p>æ¥åæ¦çæ¥è¿ 100%ãåªææ°è§£æ¯æ§è§£å·®å¾å¤ï¼ç®æ³ä¹ä¼æ¥åã</p>
<p>ç®æ³å¨æç´¢ç©ºé´ä¸­<strong>éæºæ¸¸èµ° (Random Walk)</strong>ï¼åä¸ªéæ±ãè¿ä¿è¯äºå®è½ç¿»è¶æé«çå±±å³°ï¼ä»æ·±åéè·³åºæ¥ï¼éåæ´ä¸ªç©ºé´ã</p>
<h4 id="2-æ¸©åº¦-t-éä½æ¶-è¿æ¸¡é¶æ®µ">(2) æ¸©åº¦ T éä½æ¶ (è¿æ¸¡é¶æ®µ)</h4>
<p>éç T åå°ï¼åæ¯åå°ï¼ææ°é¨ååæè¾å¤§çè´æ°ã<br>
<img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200433875-1909155565.png" alt="image" loading="lazy"></p>
<p>å¦æDelta E å¾å¤§ï¼è§£åå·®å¾å¤ï¼ï¼æ¦ç P<span class="math inline">\(å°±ä¼å¾å°ï¼å¦æ \Delta E\)</span>å¾å°ï¼åªå·®ä¸ç¹ç¹ï¼ï¼æ¦ç P$è¿æ¯è¾å¤§ã</p>
<p>ç®æ³å¼å§åå¾æåãå®ä»ç¶åè®¸è·³åºæµåï¼å±é¨æä¼ï¼ï¼ä½ä¸åæ¥åé£äºå¤ªç¦»è°±çå·®è§£ã</p>
<h4 id="3-æ¸©åº¦-t-æä½æ¶-æ¶æé¶æ®µ">(3) æ¸©åº¦ T æä½æ¶ (æ¶æé¶æ®µ)</h4>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200452308-1356373863.png" alt="image" loading="lazy"></p>
<p>æ¥åæ´å·®è§£çæ¦çå ä¹ä¸º 0ã</p>
<p>ç®æ³éåä¸º<strong>è´ªå¿ç®æ³ (Hill Climbing)</strong>ãå®åªæ¥åå¥½è§£ï¼ä¸åç¬å¡ãè¿æ¶åå®åºè¯¥å·²ç»è½å¥äºå¨å±æä¼</p>
<h2 id="éæ¸©ç³»æ°">éæ¸©ç³»æ°</h2>
<p>å¨æ¯ä¸ä¸ªåºå®çæ¸©åº¦ Tä¸ï¼ç®æ³è¿è¡å¤æ¬¡è¿­ä»£ãè¿å®éä¸æ¯å¨çæä¸ä¸ªé©¬å°å¯å¤«é¾ã å¦æè¿­ä»£æ¬¡æ°è¶³å¤å¤ï¼ç³»ç»ä¼è¾¾å°æä»ç»å°å¹æ¼åå¸<strong>ç­å¹³è¡¡åå¸ (Stationary Distribution)</strong>ã</p>
<p>å½ Tç¼æ¢ä¸éæ¶ï¼æ¦çåå¸å¾ä¼åå¾è¶æ¥è¶å°ï¼Peakedï¼ï¼å¤§é¨åæ¦çå¯åº¦ä¼éä¸­å¨å¨å±æå°å¼çéè¿ã</p>
<p>å¼å¥å·å´ç³»æ°ï¼</p>
<p><strong>æ°å­¦ä¸çæä¼éæ¸© (å¯¹æ°å·å´)</strong>ï¼ Geman å¨ 1984 å¹´è¯æï¼å¦æéæ¸©éåº¦è¶³å¤æ¢ï¼æ»¡è¶³ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200507935-837856176.png" alt="image" loading="lazy"></p>
<p>é£ä¹æ¨¡æéç«ä»¥<strong>æ¦ç 1 æ¶æå°å¨å±æä¼è§£</strong>ã <em>ç¼ºç¹</em>ï¼è¿ä¸ªéåº¦å¤ªæ¢äºï¼æ¢å°å®éä¸æ æ³ä½¿ç¨ï¼å¯è½éè¦å ç¾å¹´ï¼ã</p>
<p><strong>å·¥ç¨ä¸çéæ¸© (ææ°å·å´)</strong>ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200518474-1965198914.png" alt="image" loading="lazy"></p>
<p>è¿æ¯å¯¹æ¶æéåº¦åæ±è§£è´¨éçæè¡·ãè½ç¶çè®ºä¸ä¸ä¿è¯ 100% æ¾å°å¨å±æä¼ï¼ä½å¨æéæ¶é´åè½æ¾å°âè¶³å¤å¥½âçè§£ã</p>
<h2 id="rosenbrock-å½æ°éªè¯">Rosenbrock å½æ°éªè¯</h2>
<p>N ç»´ Rosenbrock å½æ°çéå¸¸å®ä¹å¦ä¸ï¼</p>
<p></p><div class="math display">\[f(\mathbf{x}) = \sum_{i=1}^{N-1} [100 (x_{i+1} - x_i^2)^2 + (1 - x_i)^2]
\]</div><p></p><p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200541507-1548156741.png" alt="image" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3540252/202602/3540252-20260220200605031-939946155.png" alt="image" loading="lazy"></p>
<h2 id="cåºä»£ç å¦ä¸">c++åºä»£ç å¦ä¸</h2>
<p>sa.hpp</p>
<pre><code>#ifndef SA_SA_HPP
#define SA_SA_HPP


#include "params.hpp"
#include "policies.hpp"
#include "detail/solver.hpp"

namespace sa {


    /**
     * @brief æ¨¡æéç«éç¨æ±è§£å½æ°
     * * @tparam State ç¶æç±»å (èªå¨æ¨å¯¼)
     * @tparam EnergyFunc è½éå½æ°ç±»å (èªå¨æ¨å¯¼)
     * @tparam NeighborFunc é»åå½æ°ç±»å (å¯é)
     * @tparam CoolingPolicy éæ¸©ç­ç¥ (å¯é)
     * @tparam ConstraintPolicy çº¦æç­ç¥ (å¯é)
     * * @param initial_state åå§ç¶æå¼
     * @param energy_func è½éå½æ°å¥æ
     * @param params ç®æ³åæ°éç½®
     * @param neighbor é»åçæå¨å®ä¾
     * @param cooling éæ¸©å¨å®ä¾
     * @param constraint çº¦æå¨å®ä¾
     * @return std::pair&lt;State, double&gt; {æä¼ç¶æ, æä¼è½éå¼}
     */
    template&lt;
            typename State,
            typename EnergyFunc,
            typename NeighborFunc = DefaultNeighbor&lt;State&gt;,
            typename CoolingPolicy = ExponentialCooling,
            typename ConstraintPolicy = std::nullptr_t
    &gt;
    auto solve(
            const State&amp; initial_state,
            EnergyFunc energy_func,
            Params params = Params{},
            NeighborFunc neighbor = NeighborFunc{},
            CoolingPolicy cooling = CoolingPolicy{},
            ConstraintPolicy constraint = ConstraintPolicy{}
    ) {
        using AcceptancePolicy = MetropolisAcceptance;

        detail::Solver&lt;State, EnergyFunc, NeighborFunc, CoolingPolicy, AcceptancePolicy, ConstraintPolicy&gt;
                solver(params, energy_func, neighbor, cooling, AcceptancePolicy{}, constraint);

        return solver.solve(initial_state);
    }

} // namespace sa

#endif // SA_SA_HPP
</code></pre>
<p>policies.hpp</p>
<pre><code>#ifndef SA_POLICIES_HPP
#define SA_POLICIES_HPP

#include "params.hpp"
#include "detail/traits.hpp"

#include &lt;cmath&gt;
#include &lt;random&gt;
#include &lt;algorithm&gt;
#include &lt;stdexcept&gt;
#include &lt;vector&gt;

namespace sa {

    // é»è®¤éæ¸©ç­ç¥
    struct ExponentialCooling {
        inline double operator()(double T, const Params&amp; p) const noexcept {
            return T * p.alpha;
        }
    };


    // é»è®¤æ¥åç­ç¥ (Metropolis åå)
    struct MetropolisAcceptance {
        template&lt;typename RNG&gt;
        bool operator()(double delta_E,
                        double T,
                        RNG&amp; rng,
                        std::uniform_real_distribution&lt;double&gt;&amp; dist) const
        {
            if (delta_E &lt; 0.0) return true;
            return std::exp(-delta_E / T) &gt; dist(rng);
        }
    };


    // é»è®¤è¿ç»­é»åçæç­ç¥
    template&lt;typename State&gt;
    struct DefaultNeighbor {
        double sigma = 1.0;

        State operator()(const State&amp; current,
                         double T,
                         std::mt19937&amp; rng) const
        {
            if constexpr (std::is_arithmetic_v&lt;State&gt;) {
                std::normal_distribution&lt;double&gt; dist(0.0, sigma * T);
                return static_cast&lt;State&gt;(current + dist(rng));
            }
            else if constexpr (detail::is_std_vector_v&lt;State&gt;) {
                using ValueType = typename State::value_type;
                static_assert(std::is_arithmetic_v&lt;ValueType&gt;,
                              "vector value type must be arithmetic");

                std::normal_distribution&lt;double&gt; dist(0.0, sigma * T);
                State candidate = current;
                for (auto&amp; v : candidate)
                    v = static_cast&lt;ValueType&gt;(v + dist(rng));
                return candidate;
            }
            else {
                static_assert(sizeof(State) == 0, "No default neighbor for this State type");
                return current;
            }
        }
    };


    // ç¦»æ£ç¿»è½¬é»åç­ç¥ (éå¯¹ vector&lt;bool&gt; æ vector&lt;int&gt;)
    template&lt;typename State&gt;
    struct DiscreteFlipNeighbor {
        State operator()(const State&amp; current,
                         double T,
                         std::mt19937&amp; rng) const
        {
            static_assert(detail::is_std_vector_v&lt;State&gt;, "DiscreteFlipNeighbor requires std::vector");
            using ValueType = typename State::value_type;

            static_assert(
                    std::is_same_v&lt;ValueType, int&gt; || std::is_same_v&lt;ValueType, bool&gt;,
                    "DiscreteFlipNeighbor requires vector&lt;int&gt; or vector&lt;bool&gt;"
            );

            State candidate = current;
            std::uniform_int_distribution&lt;std::size_t&gt; dist(0, candidate.size() - 1);
            std::size_t idx = dist(rng);

            if constexpr (std::is_same_v&lt;ValueType, bool&gt;)
                candidate[idx] = !candidate[idx];
            else
                candidate[idx] = 1 - candidate[idx];

            return candidate;
        }
    };


    // è¾¹ççº¦æç­ç¥ (Box Constraint)
    template&lt;typename State&gt;
    class BoxConstraintPolicy {
    public:
        using ValueType = std::conditional_t&lt;
                std::is_arithmetic_v&lt;State&gt;,
                State,
                typename State::value_type&gt;;

        BoxConstraintPolicy(ValueType lower, ValueType upper)
                : lower_(lower), upper_(upper) {}

        void apply(State&amp; state) const noexcept {
            if constexpr (std::is_arithmetic_v&lt;State&gt;) {
                state = std::clamp(state, lower_, upper_);
            }
            else {
                for (auto&amp; v : state)
                    v = std::clamp(v, lower_, upper_);
            }
        }

    private:
        ValueType lower_;
        ValueType upper_;
    };

} // namespace sa

#endif // SA_POLICIES_HPP
</code></pre>
<p>params.hpp</p>
<pre><code>//
// Created by 31007 on 2026/2/12.
//

#ifndef MATH_TYPES_HPP
#define MATH_TYPES_HPP
#include &lt;cstddef&gt;
#include &lt;cstdint&gt;
namespace sa {
    struct Params {
        double      initial_temp     = 100.0;       // åå§æ¸©åº¦
        double      final_temp       = 1e-6;        // ç»æ­¢æ¸©åº¦
        double      alpha            = 0.98;        // éæ¸©ç³»æ°
        std::size_t iter_per_temp    = 100;         // æ¯ä¸ªæ¸©åº¦ä¸çè¿­ä»£æ¬¡æ°
        std::size_t max_total_iters  = 1'000'000;   // æå¤§æ»è¿­ä»£æ¬¡æ° (é²æ­¢æ­»å¾ªç¯)
        std::uint32_t seed           = 0;           // éæºç§å­ (0è¡¨ç¤ºéæº)
    };

} // namespace sa
#endif //MATH_TYPES_HPP
</code></pre>
<p>solver.hpp</p>
<pre><code>#ifndef SA_DETAIL_SOLVER_HPP
#define SA_DETAIL_SOLVER_HPP

#include "../params.hpp"
#include &lt;random&gt;
#include &lt;utility&gt;
#include &lt;stdexcept&gt;

namespace sa::detail {

    template&lt;
            typename State,
            typename EnergyFunc,
            typename NeighborFunc,
            typename CoolingPolicy,
            typename AcceptancePolicy,
            typename ConstraintPolicy
    &gt;
    class Solver {
    public:
        Solver(Params params,
               EnergyFunc energy,
               NeighborFunc neighbor,
               CoolingPolicy cooling,
               AcceptancePolicy acceptance,
               ConstraintPolicy constraint)
                : params_(params),
                  energy_(energy),
                  neighbor_(neighbor),
                  cooling_(cooling),
                  acceptance_(acceptance),
                  constraint_(constraint),
                  dist_(0.0, 1.0)
        {
            validate_params();

            if (params_.seed == 0) {
                std::random_device rd;
                rng_ = std::mt19937(rd());
            } else {
                rng_ = std::mt19937(params_.seed);
            }
        }

        std::pair&lt;State, double&gt; solve(const State&amp; initial_state) {
            State current = initial_state;
            double current_energy = energy_(current);

            State best = current;
            double best_energy = current_energy;

            double T = params_.initial_temp;
            std::size_t total_iters = 0;

            while (T &gt; params_.final_temp &amp;&amp; total_iters &lt; params_.max_total_iters) {
                for (std::size_t i = 0;
                     i &lt; params_.iter_per_temp &amp;&amp; total_iters &lt; params_.max_total_iters;
                     ++i, ++total_iters)
                {
                    State candidate = neighbor_(current, T, rng_);

                    // ç¼è¯æå¤æ­æ¯å¦å­å¨çº¦æç­ç¥
                    if constexpr (!std::is_same_v&lt;ConstraintPolicy, std::nullptr_t&gt;) {
                        constraint_.apply(candidate);
                    }

                    double candidate_energy = energy_(candidate);
                    double delta = candidate_energy - current_energy;

                    if (acceptance_(delta, T, rng_, dist_)) {
                        current = std::move(candidate);
                        current_energy = candidate_energy;

                        if (current_energy &lt; best_energy) {
                            best = current;
                            best_energy = current_energy;
                        }
                    }
                }
                T = cooling_(T, params_);
            }

            return {std::move(best), best_energy};
        }

    private:
        void validate_params() {
            if (params_.initial_temp &lt;= 0.0) throw std::invalid_argument("initial_temp must be &gt; 0");
            if (params_.final_temp &lt;= 0.0) throw std::invalid_argument("final_temp must be &gt; 0");
            if (params_.alpha &lt;= 0.0 || params_.alpha &gt;= 1.0) throw std::invalid_argument("alpha must be in (0,1)");
            if (params_.iter_per_temp == 0) throw std::invalid_argument("iter_per_temp must be &gt; 0");
        }

        Params params_;
        EnergyFunc energy_;
        NeighborFunc neighbor_;
        CoolingPolicy cooling_;
        AcceptancePolicy acceptance_;
        ConstraintPolicy constraint_;

        std::mt19937 rng_;
        std::uniform_real_distribution&lt;double&gt; dist_;
    };

} // namespace sa::detail

#endif // SA_DETAIL_SOLVER_HPP
</code></pre>
<p>traits.hpp</p>
<pre><code>#ifndef SA_DETAIL_TRAITS_HPP
#define SA_DETAIL_TRAITS_HPP

#include &lt;vector&gt;
#include &lt;type_traits&gt;

namespace sa::detail {

    // ç±»åèåï¼å¤æ­æ¯å¦ä¸º std::vector

    template&lt;typename T&gt;
    struct is_std_vector : std::false_type {};

    template&lt;typename T, typename Alloc&gt;
    struct is_std_vector&lt;std::vector&lt;T, Alloc&gt;&gt; : std::true_type {};

    template&lt;typename T&gt;
    inline constexpr bool is_std_vector_v = is_std_vector&lt;T&gt;::value;

} // namespace sa::detail

#endif // SA_DETAIL_TRAITS_HPP
</code></pre>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.008333333333333333" data-date-updated="2026-02-20 20:26">2026-02-20 20:14</span>&nbsp;
<a href="https://www.cnblogs.com/PaperPlaneFly">çº¸é£æºä½ç©ºé£è¡</a>&nbsp;
éè¯»(<span id="post_view_count">56</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19626799);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19626799', targetLink: 'https://www.cnblogs.com/PaperPlaneFly/p/19626799', title: 'æ¨¡æéç«ç®æ³' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ 9ãPipedInputStreamåPipedOutputStreamçæºç åæåä½¿ç¨æ¹æ³è¯¦ç»åæ ]]></title>
    <link>https://www.cnblogs.com/Carey-ccl/p/19625392</link>
    <guid>363a1c6157b9a2786d34ff60a8043376</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Carey-ccl/p/19625392" title="åå¸äº 2026-02-19 22:07">
    <span role="heading" aria-level="2">9ãPipedInputStreamåPipedOutputStreamçæºç åæåä½¿ç¨æ¹æ³è¯¦ç»åæ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>ââå¨å¤çº¿ç¨ç¼ç¨ä¸­ï¼çº¿ç¨é´çæ°æ®äº¤æ¢æ¯ä¸ä¸ªå¸¸è§éæ±ãJava IOåä¸­çPipedInputStreamåPipedOutputStreamæä¾äºä¸ç§é«æççº¿ç¨é´éä¿¡æºå¶ï¼åè®¸ä¸æ¹ï¼å¤ä¸ªï¼çº¿ç¨åPipedOutputStreamåå¥æ°æ®ï¼å¦ä¸æ¹ï¼å¤ä¸ªï¼çº¿ç¨ä»PipedInputStreamè¯»åæ°æ®ã<br>
ââä½æ¯ï¼åä¸æ¹ï¼å¤ä¸ªï¼çº¿ç¨ç¸äºä¹é´ä¼å­å¨ç«äºï¼æ¯å¦ï¼åä¸æ¹åPipedOutputStreamåå¥æ°æ®ççº¿ç¨ä¼å­å¨ç«äºï¼åä¸æ¹ä»PipedInputStreamè¯»åæ°æ®ççº¿ç¨ä¹ä¼å­å¨ç«äºãå æ­¤PipedInputStreamåPipedOutputStreamä¸­ççº¿ç¨å®å¨éè¦éè¿synchronizedå³é®å­åwait()/notifyAll()æºå¶å®ç°ãä¸å»ºè®®å¨ä¸ä¸ªçº¿ç¨ä¸­åæ¶ä½¿ç¨PipedInputStreamåPipedOutputStreamï¼å ä¸ºè¿æ ·å¯è½ä¼å¯¼è´è¿ä¸ªçº¿ç¨é·å¥æ­»éç¶æã<br>
ââPipedInputStreamåPipedOutputStreamä¹é´çéä¿¡æ¬è´¨ä¸æ¯ä¸ä¸ªçäº§è-æ¶è´¹èæ¨¡åï¼å¶ä¸­PipedOutputStreamä½ä¸ºçäº§èï¼PipedInputStreamä½ä¸ºæ¶è´¹èãä¸¤èéè¿ä¸ä¸ªå¾ªç¯ç¼å²åºï¼byte[]æ°ç»ï¼è¿è¡æ°æ®äº¤æ¢ï¼PipedOutputStreamå°æ°æ®ç¼å­å¨PipedInputStreamçæ°ç»å½ä¸­ï¼ç­å¾PipedInputStreamçè¯»åã<br>
ââPipedInputStreamåPipedOutputStreamçUMLå³ç³»å¾ï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215754596-156220550.png" class="lazyload"></p>
<h4 id="ä¸pipedoutputstreamçäº§èæºç åpipedinputstreamæ¶è´¹èä¸­çç¼å²åºbyteæ°ç»åå¥å­èæ°æ®çè¾åºstreamçäº§è">ä¸ãPipedOutputStreamï¼çäº§èï¼æºç ââåPipedInputStreamï¼æ¶è´¹èï¼ä¸­çç¼å²åºï¼byte[]æ°ç»ï¼åå¥å­èæ°æ®çè¾åºStreamï¼çäº§èï¼</h4>
<pre><code>package java.io;

import java.io.*;

public
class PipedOutputStream extends OutputStream {
    //ä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼
    private PipedInputStream sink;
    
    //æé å½æ°
    public PipedOutputStream(PipedInputStream snk)  throws IOException {
        connect(snk);//è°ç¨connect()å½æ°ï¼æ¥æ¹åPipedInputStream ï¼æ¶è´¹èï¼ä¸­ä¸äºåéçå¼
    }
    
    //æé å½æ°
    public PipedOutputStream() {
    }
    
    //çº¿ç¨åæ­¥å½æ°ï¼ç¨æ¥æ¹åå°è¦å³èçPipedInputStream ï¼æ¶è´¹èï¼ä¸­ä¸äºåéçå¼
    public synchronized void connect(PipedInputStream snk) throws IOException {
        if (snk == null) {
            throw new NullPointerException();//å¦æå°è¦å³èçPipedInputStream ï¼æ¶è´¹èï¼ä¸ºnullï¼æåºNullPointerException
        } else if (sink != null || snk.connected) {
            //å¦æä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼!=nullæèå°è¦å³èçPipedInputStream ï¼æ¶è´¹èï¼çboolean connectedåéä¸ºtrueï¼åæåºIOException
            throw new IOException("Already connected");
        }
        sink = snk;//å°è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ä¸è¿ä¸ªPipedInputStream ï¼æ¶è´¹èï¼ç¸å³è
        snk.in = -1;//æ¹åPipedInputStream ï¼æ¶è´¹èï¼ä¸­çåéint in=-1
        snk.out = 0;//æ¹åPipedInputStream ï¼æ¶è´¹èï¼ä¸­çåéint out=0
        snk.connected = true;//æ¹åPipedInputStream ï¼æ¶è´¹èï¼ä¸­çåéboolean connected=true
    }
    
    //åä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼çç¼å²åºï¼byte[]æ°ç»ï¼åå¥1ä¸ªå­è
    public void write(int b)  throws IOException {
        if (sink == null) {
             //å¦æä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼== nullï¼æåºIOException
            throw new IOException("Pipe not connected");
        }
        sink.receive(b);//æç»è°ç¨çæ¯è¿ä¸ªç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼çreceive(int b)å½æ°
    }
    
    //åä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼çç¼å²åºï¼byte[]æ°ç»ï¼åå¥byte[]æ°ç»bç[off,off+len)ï¼å·¦é­å³å¼ï¼ä¸åæ¬off+lenï¼ç´¢å¼ä½ç½®çå­è
    public void write(byte b[], int off, int len) throws IOException {
        if (sink == null) {
            //å¦æä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼== nullï¼æåºIOException
            throw new IOException("Pipe not connected");
        } else if (b == null) {
            throw new NullPointerException();//å¦æbyte[]æ°ç»b==nullï¼æåºä¸ä¸ªNullPointerException
        } else if ((off &lt; 0) || (off &gt; b.length) || (len &lt; 0) ||
                   ((off + len) &gt; b.length) || ((off + len) &lt; 0)) {//byte[]æ°ç»bç[off,off+len)ï¼å·¦é­å³å¼ï¼ç´¢å¼ä½ç½®æ¯å¦æè¶ççæ£æ¥
            throw new IndexOutOfBoundsException();//è¶ççè¯ï¼æåºä¸ä¸ªIndexOutOfBoundsException
        } else if (len == 0) {
            return;//å¦ælen==0ï¼ç»ææ¬æ¬¡å½æ°è°ç¨
        }
        sink.receive(b, off, len);//æç»è°ç¨çæ¯è¿ä¸ªç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼çreceive(byte b[], int off, int len)å½æ°
    }
    
    //çº¿ç¨åæ­¥å½æ°ï¼ä½¿ç¨notifyAll()å½æ°å¤éææä¸è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ç¸å³èç PipedInputStream ï¼æ¶è´¹èï¼çº¿ç¨ï¼è¿ä¸ªæ¶è´¹èå¯ä»¥ç»å®1~å¤ä¸ªçº¿ç¨ï¼
    public synchronized void flush() throws IOException {
        if (sink != null) {
            synchronized (sink) {
                sink.notifyAll();
            }
        }
    }
    //å³é­è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ï¼è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ä¸è½ååä¸å®ç¸å³èçPipedInputStreamï¼æ¶è´¹èï¼ä¸­çç¼å²åºï¼byte[]æ°ç»ï¼åå¥å­èæ°æ®
    public void close()  throws IOException {
        if (sink != null) {
            sink.receivedLast();
        }
    }
}
</code></pre>
<h4 id="äºpipedinputstreamæ¶è´¹èæºç ä»èªå·±çç¼å²åºbyteæ°ç»è¯»åå­èæ°æ®çè¾å¥streamæ¶è´¹è">äºãPipedInputStreamï¼æ¶è´¹èï¼æºç ââä»èªå·±çç¼å²åºï¼byte[]æ°ç»ï¼è¯»åå­èæ°æ®çè¾å¥Streamï¼æ¶è´¹èï¼</h4>
<pre><code>package java.io;

public class PipedInputStream extends InputStream {
    //æ è®°ç¬¦ï¼trueè¡¨ç¤ºä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼å·²ç»å³é­ï¼åä¹ï¼åä¹
    boolean closedByWriter = false;
    //æ è®°ç¬¦ï¼trueè¡¨ç¤ºå½åè¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼å·²ç»å³é­äºï¼åä¹ï¼åä¹
    volatile boolean closedByReader = false;
    //æ è®°ç¬¦ï¼trueè¡¨ç¤ºä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼å·²ç»ææäºè¿ä¸ªPipedInputStream ï¼æ¶è´¹èï¼å¯¹è±¡ï¼æèå«å·²ç»è¿æ¥ä¸äºï¼ï¼åä¹ï¼åä¹
    boolean connected = false;

    Thread readSide;//å½åæ¶è´¹ççº¿ç¨
    Thread writeSide;//å½åçäº§èççº¿ç¨
    
    //é»è®¤çPipedInputStream ï¼æ¶è´¹èï¼çç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦
    private static final int DEFAULT_PIPE_SIZE = 1024;

    //PipedInputStream ï¼æ¶è´¹èï¼çç¼å²åºï¼byte[]æ°ç»ï¼
    protected byte buffer[];
    //ç¼å²åºï¼byte[]æ°ç»ï¼çåæé
    protected int in = -1;
    //ç¼å²åºï¼byte[]æ°ç»ï¼çè¯»æé
    protected int out = 0;
    //æé å½æ°
    public PipedInputStream(PipedOutputStream src) throws IOException {
        this(src, DEFAULT_PIPE_SIZE);//ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ä½¿ç¨é»è®¤å¼1024
    }

    //æé å½æ°
    public PipedInputStream(PipedOutputStream src, int pipeSize)
            throws IOException {
         initPipe(pipeSize);//ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ä½¿ç¨æå®çé¿åº¦
         //æç»è¿æ¯è°ç¨PipedOutputStreamï¼çäº§èï¼çconnect()å½æ°ï¼å¹¶æèªèº«å¯¹è±¡thisä¼ éè¿å»ï¼ç¶åå¨PipedOutputStreamï¼çäº§èï¼çconnect()å½æ°ä¸­ï¼æ¹åèªå·±ç3ä¸ªåéint in=-1ãint out=0ãboolean connected=true
         connect(src);
    }
    
    //æé å½æ°ï¼ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ä½¿ç¨é»è®¤å¼1024
    public PipedInputStream() {
        initPipe(DEFAULT_PIPE_SIZE);
    }

    //æé å½æ°ï¼ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ä½¿ç¨æå®çé¿åº¦
    public PipedInputStream(int pipeSize) {
        initPipe(pipeSize);
    }
    
    //åå§åç¼å²åºï¼byte[]æ°ç»ï¼
    private void initPipe(int pipeSize) {
         if (pipeSize &lt;= 0) {
            throw new IllegalArgumentException("Pipe Size &lt;= 0");
         }
         buffer = new byte[pipeSize];
    }

    public void connect(PipedOutputStream src) throws IOException {
        src.connect(this); //æç»è¿æ¯è°ç¨PipedOutputStreamï¼çäº§èï¼çconnect()å½æ°ï¼å¹¶æèªèº«å¯¹è±¡thisä¼ éè¿å»ï¼ç¶åå¨PipedOutputStreamï¼çäº§èï¼çconnect()å½æ°ä¸­ï¼æ¹åèªå·±ç3ä¸ªåéint in=-1ãint out=0ãboolean connected=true
    }
    
    //çº¿ç¨åæ­¥å½æ°ï¼è¯¥å½æ°åªè¢«PipedOutputStreamï¼çäº§èï¼çwrite(int b)å½æ°è°ç¨
    protected synchronized void receive(int b) throws IOException {
        checkStateForReceive();//æ£æ¥PipedInputStream ï¼æ¶è´¹èï¼çç¶æ
        writeSide = Thread.currentThread();//å½åæ§è¡è¯¥å½æ°ççº¿ç¨ï¼å°±æ¯çäº§èçº¿ç¨
        if (in == out)
            //å¦æç¼å²åºï¼byte[]æ°ç»ï¼çè¯»æé==ç¼å²åºï¼byte[]æ°ç»ï¼çåæéï¼å¤éæææ¶è´¹èçº¿ç¨ï¼èªå·±è¿ä¸ªçäº§èçº¿ç¨è°ç¨wait(1000)å½æ°
            awaitSpace();
        if (in &lt; 0) {//ç¼å²åºï¼byte[]æ°ç»ï¼çåæé&lt;0æ¶ï¼è®¾ç½®ç¼å²åºï¼byte[]æ°ç»ï¼çåæé=0ï¼ç¼å²åºï¼byte[]æ°ç»ï¼çè¯»æé=0
            in = 0;
            out = 0;
        }
        buffer[in++] = (byte)(b &amp; 0xFF);//åç¼å²åºçåæéä½ç½®åå¥1ä¸ªå­è
        if (in &gt;= buffer.length) {
            in = 0;//å¦æç¼å²åºæ»¡äºï¼è®¾ç½®ç¼å²åºçåæé=0
        }
    }

    //çº¿ç¨åæ­¥å½æ°ï¼è¯¥å½æ°åªè¢«PipedOutputStreamï¼çäº§èï¼çwrite(byte b[], int off, int len)å½æ°è°ç¨
    synchronized void receive(byte b[], int off, int len)  throws IOException {
        checkStateForReceive();//æ£æ¥PipedInputStream ï¼æ¶è´¹èï¼çç¶æ
        writeSide = Thread.currentThread();//å½åæ§è¡è¯¥å½æ°ççº¿ç¨ï¼å°±æ¯çäº§èçº¿ç¨
        int bytesToTransfer = len;//çäº§èçº¿ç¨è¦åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ»é
        while (bytesToTransfer &gt; 0) {
            if (in == out)
                //å¦æç¼å²åºï¼byte[]æ°ç»ï¼çè¯»æé==ç¼å²åºï¼byte[]æ°ç»ï¼çåæéï¼å¤éæææ¶è´¹èçº¿ç¨ï¼èªå·±è¿ä¸ªçäº§èçº¿ç¨è°ç¨wait(1000)å½æ°
                awaitSpace();
            int nextTransferAmount = 0;//æ¬æ¬¡çäº§èçº¿ç¨è¦åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°é
            if (out &lt; in) {
                //å¦æç¼å²åºçè¯»æé&lt;ç¼å²åºçåæéï¼æ¬æ¬¡è¦åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°é=ç¼å²åºçé¿åº¦-ç¼å²åºçåæé
                nextTransferAmount = buffer.length - in;
            } else if (in &lt; out) {
                if (in == -1) {
                    in = out = 0;
                    //å¦æç¼å²åºçè¯»æéï¼outï¼&gt; ç¼å²åºçåæéï¼inï¼å¹¶ä¸ç¼å²åºçåæéï¼inï¼=-1ï¼åè®¾ç½®ç¼å²åºçè¯»ï¼outï¼ãåï¼inï¼æé=0ï¼æ¬æ¬¡è¦åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°é=ç¼å²åºçé¿åº¦
                    nextTransferAmount = buffer.length - in;
                } else {
                    //å¦æç¼å²åºçè¯»æéï¼outï¼&gt; ç¼å²åºçåæéï¼inï¼å¹¶ä¸ç¼å²åºçåæéï¼inï¼=-1ï¼æ¬æ¬¡è¦åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°é=è¯»æéï¼outï¼-åæéï¼inï¼
                    nextTransferAmount = out - in;
                }
            }
            //æ¬æ¬¡çäº§èçº¿ç¨è¦åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°éæå¤ä¸ºlenï¼ä¸æ¬¡ä¸ºlen-æ¬æ¬¡åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°éï¼ä¹å°±æ¯æ¯æ¬¡åå¥çåºäºlenä¸ªå­èå¾ªç¯éåä¸ä¸æ¬¡åå¥ç
            if (nextTransferAmount &gt; bytesToTransfer)
                nextTransferAmount = bytesToTransfer;
            assert(nextTransferAmount &gt; 0);
            System.arraycopy(b, off, buffer, in, nextTransferAmount);//åç¼å²åºï¼byte[]æ°ç»ï¼ç[in,in+nextTransferAmount)ç´¢å¼ä½ç½®åå¥byte[]æ°ç»bä¸­[off,off+nextTransferAmount)ç´¢å¼ä½ç½®çå­èï¼é½æ¯å·¦é­å³å¼ã
            bytesToTransfer -= nextTransferAmount;//æ¯ä¸æ¬¡é½åºäºlenä¸ªå­èå¾ªç¯éåæ¬æ¬¡åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°énextTransferAmount
            off += nextTransferAmount;//å°ä¸æ¬¡è¦ä»byte[]æ°ç»bä¸­åå­èçèµ·å§ç´¢å¼çä½ç½®ï¼åç§»éï¼+æ¬æ¬¡åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°énextTransferAmount
            in += nextTransferAmount;//å°ç¼å²åºçåæéï¼inï¼+æ¬æ¬¡åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå­èæ°énextTransferAmount
            if (in &gt;= buffer.length) {
                in = 0;//å¦æç¼å²åºçåæéï¼inï¼&gt; ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ï¼è®¾ç½®ç¼å²åºçåæéï¼inï¼=0
            }
        }
    }

    //æ£æ¥PipedInputStream ï¼æ¶è´¹èï¼çç¶æ
    private void checkStateForReceive() throws IOException {
        if (!connected) {
            throw new IOException("Pipe not connected");
        } else if (closedByWriter || closedByReader) {
            throw new IOException("Pipe closed");
        } else if (readSide != null &amp;&amp; !readSide.isAlive()) {
            throw new IOException("Read end dead");
        }
    }
    
    //å¦æç¼å²åºï¼byte[]æ°ç»ï¼çè¯»æé==ç¼å²åºï¼byte[]æ°ç»ï¼çåæéï¼å¤éæææ¶è´¹èçº¿ç¨ï¼èªå·±è¿ä¸ªçäº§èçº¿ç¨è°ç¨wait(1000)å½æ°
    private void awaitSpace() throws IOException {
        while (in == out) {
            checkStateForReceive();

            /* full: kick any waiting readers */
            notifyAll();
            try {
                wait(1000);
            } catch (InterruptedException ex) {
                throw new java.io.InterruptedIOException();
            }
        }
    }
    //å³é­ä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼
    synchronized void receivedLast() {
        closedByWriter = true;
        notifyAll();//å¤éæææ¶è´¹èçº¿ç¨
    }
    //çº¿ç¨åæ­¥å½æ°ï¼æ¶è´¹èçº¿ç¨æ¯æ¬¡ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å1ä¸ªå­è
    public synchronized int read()  throws IOException {
        if (!connected) {//æ£æ¥æ è®°ç¬¦connectedï¼å¦æä¸ºfalseï¼æåºIOException
            throw new IOException("Pipe not connected");
        } else if (closedByReader) {//æ£æ¥æ è®°ç¬¦closedByReaderï¼å¦æä¸ºtrueï¼æåºIOException
            throw new IOException("Pipe closed");
        } else if (writeSide != null &amp;&amp; !writeSide.isAlive()
                   &amp;&amp; !closedByWriter &amp;&amp; (in &lt; 0)) {
           //æ£æ¥å½åè¿ä¸ªPipedInputStream ï¼æ¶è´¹èï¼å¯¹è±¡ä¸­å¼ç¨ççäº§èçº¿ç¨åçäº§èçº¿ç¨çç¶æï¼å¦æåæ è®°ç¬¦closedByWriterè¿æç¼å²åºï¼byte[]æ°ç»ï¼çåæéï¼inï¼ä¸è½å¯¹åºçè¯ï¼æåºä¸ä¸ªIOException
            throw new IOException("Write end dead");
        }

        readSide = Thread.currentThread();//å½åæ§è¡è¯¥å½æ°ççº¿ç¨ï¼å°±æ¯æ¶è´¹èçº¿ç¨
        int trials = 2;//è¿æ¯ä¸ä¸ªå¤æ¬¡æ£æµçç­ç¥åéï¼é²æ­¢çäº§èçº¿ç¨æ²¡æå³é­äºä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼æ¶ä¾¿æåºIOException
        //in=-1çæåµæç§ï¼
        //â ãçäº§èçº¿ç¨è¿æ²¡æåç¼å²åºï¼byte[]æ°ç»ï¼ä¸­åä»»ä½å­è
        //â¡ãæ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å®å­èï¼byteï¼æ°æ®ä»¥åè¯»æéï¼outï¼=åæéï¼inï¼ï¼é£ä¹ï¼å½åæ¶è´¹èçº¿ç¨ä¼è®¾ç½®åæéï¼inï¼=-1
        //â¢ãæ¶è´¹èçº¿ç¨æ§è¡PipedInputStream çclose()å½æ°åï¼å³é­äºè¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼
        while (in &lt; 0) {
            if (closedByWriter) {
                /* closed by writer, return EOF */
                return -1;
            }
            if ((writeSide != null) &amp;&amp; (!writeSide.isAlive()) &amp;&amp; (--trials &lt; 0)) {
                //å¤ä¸ªæ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»çæ¶åï¼å¹¶ä¸åä¸ä¸ªæ¶è´¹èçº¿ç¨å·²ç»æç¼å²åºï¼byte[]æ°ç»ï¼ä¸­åå¥çå­èè¯»å®äºï¼å¹¶ä¸åä¸ä¸ªçº¿ç¨è®¾ç½®äºåæéï¼inï¼=-1ï¼çäº§èçº¿ç¨ä¹å³é­äºä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼æ¶ï¼æåºä¸ä¸ªIOException
                throw new IOException("Pipe broken");
            }
            /* might be a writer waiting */
            notifyAll();//æ­¤å¤çç®çæ¯ä¸ºäºå¤éææçäº§èçº¿ç¨
            try {
                wait(1000);
            } catch (InterruptedException ex) {
                throw new java.io.InterruptedIOException();
            }
        }
        int ret = buffer[out++] &amp; 0xFF;//è·åç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æéï¼outï¼ç´¢å¼ä½ç½®çå­è,å¹¶ä¸å°è¯»æéï¼outï¼+1
        if (out &gt;= buffer.length) {
            out = 0;//å¦æè¯»æéï¼outï¼&gt;=ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ï¼è®¾ç½®è¯»æéï¼outï¼=0
        }
        if (in == out) {
            /* now empty */
            in = -1;//å¦ææ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å®å­èï¼byteï¼æ°æ®ä»¥åè¯»æéï¼outï¼=åæéï¼inï¼ï¼é£ä¹ï¼å½åæ¶è´¹èçº¿ç¨ä¼è®¾ç½®åæéï¼inï¼=-1
        }

        return ret;
    }

    //çº¿ç¨åæ­¥å½æ°ï¼å¦æç¼å²åºï¼byte[]æ°ç»ï¼ä¸­æè¶³å¤å¤çå­èçè¯ï¼æ°é&gt;lenï¼ï¼æ¶è´¹èçº¿ç¨æ¯æ¬¡ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»ålenä¸ªå­èæ¾å°byte[]æ°ç»bç[off, off+len)ç´¢å¼ä½ç½®ï¼å·¦é­å³å¼ï¼ä¸åæ¬off+lenï¼
    //å¦æç¼å²åºï¼byte[]æ°ç»ï¼ä¸­å­èçæ°é&lt;lenä¸ªï¼æ¯å¦æinï¼åæéï¼-outï¼è¯»æéï¼ä¸ªï¼ï¼æ¶è´¹èçº¿ç¨æ¯æ¬¡ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»åï¼in-outï¼ä¸ªå­èæ¾å°byte[]æ°ç»bç[off, off+in-out)ç´¢å¼ä½ç½®ï¼å·¦é­å³å¼ï¼ä¸åæ¬off+in-outï¼
    public synchronized int read(byte b[], int off, int len)  throws IOException {
        if (b == null) {
            throw new NullPointerException();
        } else if (off &lt; 0 || len &lt; 0 || len &gt; b.length - off) {//byte[]æ°ç»bç[off,off+len)ï¼å·¦é­å³å¼ï¼ç´¢å¼ä½ç½®æ¯å¦æè¶ççæ£æ¥
            throw new IndexOutOfBoundsException();//è¶ççè¯ï¼æåºä¸ä¸ªIndexOutOfBoundsException
        } else if (len == 0) {
            return 0;//å¦ælen==0ï¼è¿å0
        }

        /* possibly wait on the first character */
        int c = read();//åè°ç¨read()å½æ°è¯æ¢æ§ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»1ä¸ªå­è
        if (c &lt; 0) {
            return -1;//å¦æè¯æ¢æ§çä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­é½è¯»ä¸å°1ä¸ªå­èï¼è¿å-1
        }
        b[off] = (byte) c;//æè¯æ¢æ§ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°çç¬¬1ä¸ªå­èæ¾å°byte[]æ°ç»bçoffç´¢å¼ä½ç½®
        int rlen = 1;//ç´¯è®¡ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°çææå­èæ°é
        while ((in &gt;= 0) &amp;&amp; (len &gt; 1)) {

            int available;//æ¬æ¬¡æ§è¡System.arraycopy()å½æ°å¯ä»¥ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°byte[]æ°ç»bä¸­çå­èæ°é

            if (in &gt; out) {
                available = Math.min((buffer.length - out), (in - out));
            } else {
                available = buffer.length - out;
            }

            // A byte is read beforehand outside the loop
            if (available &gt; (len - 1)) {//åæè¯æ¢æ§ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°çç¬¬1ä¸ªå­è
                available = len - 1;
            }
            System.arraycopy(buffer, out, b, off + rlen, available);
            out += available;//è¯»æéï¼outï¼+System.arraycopy()å½æ°ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°byte[]æ°ç»bä¸­çå­èæ°é
            rlen += available;//ç´¯è®¡ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°çææå­èæ°é + System.arraycopy()å½æ°ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°byte[]æ°ç»bä¸­çå­èæ°é
            len -= available;//len - System.arraycopy()å½æ°ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°byte[]æ°ç»bä¸­çå­èæ°é

            if (out &gt;= buffer.length) {
                out = 0;//å¦æè¯»æéï¼outï¼&gt;=ç¼å²åºï¼byte[]æ°ç»ï¼çé¿åº¦ï¼è®¾ç½®è¯»æéï¼outï¼=0
            }
            if (in == out) {
                /* now empty */
                in = -1;//å¦ææ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å®å­èï¼byteï¼æ°æ®ä»¥åè¯»æéï¼outï¼=åæéï¼inï¼ï¼é£ä¹ï¼å½åæ¶è´¹èçº¿ç¨ä¼è®¾ç½®åæéï¼inï¼=-1
            }
        }
        return rlen;//è¿åç´¯è®¡ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»å°çææå­èæ°é
    }
    
    //çº¿ç¨åæ­¥å½æ°ï¼è¿åç¼å²åºï¼byte[]æ°ç»ï¼ä¸­å¯ä»¥è¢«æ¶è´¹èçº¿ç¨è¯»åçå­èæ°é
    public synchronized int available() throws IOException {
        if(in &lt; 0)
            return 0;
        else if(in == out)
            return buffer.length;
        else if (in &gt; out)
            return in - out;
        else
            return in + buffer.length - out;
    }
    
    //å³é­è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ï¼å¶å®å°±æ¯è®¾ç½®æ è®°ç¬¦closedByReader=trueï¼ è®¾ç½®åæéï¼inï¼=-1
    public void close()  throws IOException {
        closedByReader = true;
        synchronized (this) {
            in = -1;
        }
    }
}
</code></pre>
<h4 id="ä¸1ä¸ªçº¿ç¨åpipedoutputstreamçäº§èåå­èæ°æ®1ä¸ªçº¿ç¨ä»pipedinputstreamæ¶è´¹èè¯»åå­èæ°æ®çè¿ç¨">ä¸ã1ä¸ªçº¿ç¨åPipedOutputStreamï¼çäº§èï¼åå­èæ°æ®ï¼1ä¸ªçº¿ç¨ä»PipedInputStreamï¼æ¶è´¹èï¼è¯»åå­èæ°æ®çè¿ç¨</h4>
<h5 id="31éå¾ªç¯ç´æ¥ååéå¾ªç¯ç´æ¥è¯»">3.1ãéå¾ªç¯ç´æ¥ååéå¾ªç¯ç´æ¥è¯»</h5>
<pre><code>package com.chelong.StreamAndReader;

import java.io.IOException;
import java.io.PipedInputStream;
import java.io.PipedOutputStream;

public class PipedTest {
   public static void main(String[] args) throws IOException {
      final PipedOutputStream output = new PipedOutputStream();
      final PipedInputStream input = new PipedInputStream(output);
      Thread thread1 = new Thread(new Runnable() {
         @Override
         public void run() {
            try {
               output.write("Hello world, pipe!".getBytes());//write()å½æ°æ¯é»å¡ç
            } catch (IOException e) {
            }
         }
      });

      Thread thread2 = new Thread(new Runnable() {
         @Override
         public void run() {
            try {
               int data = -1;
               while ((data = input.read()) != -1) {//read()å½æ°æ¯é»å¡ç
                  System.out.print((char) data);
               }
            } catch (IOException e) {
            }
         }
      });

      thread1.start();
      thread2.start();
   }
}
</code></pre>
<p>ç¨åºè¿è¡ç»æï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212445827-714738061.png" class="lazyload"></p>
<p>ââmainçº¿ç¨æé PipedOutputStreamï¼çäº§èï¼åPipedInputStreamï¼æ¶è´¹èï¼çè¿ç¨å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212510743-1554062823.png" class="lazyload"></p>
<p>ââåPipedOutputStreamï¼çäº§èï¼åå­èæ°æ®ççäº§èçº¿ç¨çæ§è¡è¿ç¨å¦ä¸ï¼</p>
<p><img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212544914-451659960.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212555287-1090346414.png" class="lazyload"></p>
<p>ââä»PipedInputStreamï¼æ¶è´¹èï¼è¯»åå­èæ°æ®çæ¶è´¹èçº¿ç¨çæ§è¡è¿ç¨å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212607497-1898462647.png" class="lazyload"></p>
<h6 id="311éå¾ªç¯ç´æ¥ååéå¾ªç¯ç´æ¥è¯»æ¶1ä¸ªçäº§èçº¿ç¨å1ä¸ªæ¶è´¹èçº¿ç¨å¤çæ°æ®çè¿ç¨">3.1.1ãéå¾ªç¯ç´æ¥ååéå¾ªç¯ç´æ¥è¯»æ¶1ä¸ªçäº§èçº¿ç¨å1ä¸ªæ¶è´¹èçº¿ç¨å¤çæ°æ®çè¿ç¨</h6>
<p>ââJava è¯­è¨å®ä¹äº 6 ç§çº¿ç¨ç¶æ, å¨ä»»æä¸ä¸ªæ¶é´ç¹, ä¸ä¸ªçº¿ç¨åªè½æä¸åªæå¶ä¸­çä¸ç§ç¶æ, è¿ 6 ç§ç¶æåå«å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212638111-71943307.png" class="lazyload"></p>
<p>è¿ 6 ç§çº¿ç¨ç¶æçç®åä»ç»ï¼å¦ä¸æç¤º<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212705389-2145559667.png" class="lazyload"></p>
<p>ââJVMè¿è¡æ¶åå­ç»æä¸»è¦åå«äºäºä¸ªé¨åï¼ç¨åºè®¡æ°å¨ ï¼PCå¯å­å¨ï¼ã JVMæ ãNativeæ¹æ³æ ãå ã æ¹æ³åºãå¦ä¸å¾æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212726158-604379458.png" class="lazyload"></p>
<p>å¾ä¸­çº¢è²é¨åæ¯çº¿ç¨ç§æåºåï¼è¿å¥è¿ä¸ªåºåçæ°æ®ä¸ä¼åºç°çº¿ç¨ç«äºçå³ç³»ãèç»¿è²åºåä¸­çæ°æ®åè¢«ææçº¿ç¨å±äº«ï¼å¶ä¸­Javaå ä¸­å­æ¾çæ¯å¤§éå¯¹è±¡ï¼æ¹æ³åºä¸­å­æ¾classä¿¡æ¯ãå¸¸éãéæåéç­æ°æ®ã<br>
ââæ¯ä¸ªçº¿ç¨ççº¿ç¨æ ä¸­ä¼å­æ¾å½æ°ï¼æ¹æ³ï¼çæè¿°ç¬¦ï¼æåï¼æ¬å°ï¼åéç­ï¼å½æ°ï¼æ¹æ³ï¼å¨çº¿ç¨æ ä¸­ä¼éè¿åæ åå¼¹æ æ¥æ§è¡ï¼é¤äº8ç§ï¼byteãshortãintãlongãfloatãdoubleãbooleanãcharï¼åºæ¬çæ°æ®ç±»åå­å¨å¨çº¿ç¨æ ä¸­ä»¥å¤ï¼å¶ä½çå¼ç¨æ°æ®ç±»åï¼å¯¹è±¡ï¼é½å­å¨å¨å ä¸­ï¼ç¶åéè¿å¼ç¨å°å ä¸­çå¯¹è±¡åçº¿ç¨æ ä¸­çåéå³èèµ·æ¥ï¼ä¹å¯ä»¥å«çº¿ç¨æ ä¸­çå¼ç¨æåå ä¸­çå¯¹è±¡ï¼ã<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212846610-2137279183.png" class="lazyload"></p>
<p>é£ä¹ï¼å½ä½¿ç¨èæ§è¡3.1ä¸­çä»£ç æ¶ï¼1ä¸ªçäº§èçº¿ç¨å1ä¸ªæ¶è´¹èçº¿ç¨å¤çæ°æ®çè¿ç¨å¦ä¸ï¼<br>
â ãmainçº¿ç¨åå§åä¸ä¸ªç¼å²åºï¼byte[]æ°ç»ï¼ï¼é¿åº¦ä¸º1024ï¼é»è®¤å¼ï¼ï¼ç¶åçäº§èçº¿ç¨éè¿ä¸æ­çåæ æ¥å®æå½æ°ä¹é´çè°ç¨ï¼æç»æ§è¡PipedInputStream.class::receive(byte b[], int off, int len)å½æ°æ¥å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼è¿è¡å¡«åï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212906698-848464368.png" class="lazyload"></p>
<p>â¡ãå½çäº§èçº¿ç¨å¡«åå®ç¼å²åºä¹åï¼åæéåéint in=17ï¼è¯»æéåéint out=0ï¼Thread writeSide = å½åè¿ä¸ªçäº§èçº¿ç¨ï¼Threadï¼å¯¹è±¡ï¼çäº§èçº¿ç¨ä¼æèªå·±çº¿ç¨æ ä¸­ä¿®æ¹çåéæç»å·æ°å°å ä¸­PipedInputStreamå¯¹è±¡ä¸­ï¼ä»¥ç¡®ä¿å¶å®æ¶è´¹èçº¿ç¨ççº¿ç¨æ ä»å ä¸­è¯»åè¿3ä¸ªåéæ¶ï¼è¿3ä¸ªåéå·²ç»ä¸ºä¿®æ¹åçå¼ï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212918513-1084660758.png" class="lazyload"></p>
<p>â¢ãæ¶è´¹èçº¿ç¨è¯»ç¼å²åºï¼byte[]æ°ç»ï¼çè¿ç¨ä¸­ä¼ä¸æ­å°æ§è¡out++ï¼è¯»æéï¼ä»¥è¯»åç¼å²åºï¼byte[]æ°ç»ï¼ä¸­çå¯ç¨å­èå¹¶è¿åï¼ç´å°outï¼è¯»æéï¼==inï¼åæéï¼ï¼ä¿®æ¹inï¼åæéï¼=-1ï¼å¹¶ä¸æ¯æ¬¡åæ­¥æ§è¡PipedInputStream.class::read()å½æ°æ¶ï¼é½ä¼æ´æ°Thread readSide = å½åè¿ä¸ªæ¶è´¹èçº¿ç¨ï¼Threadï¼å¯¹è±¡ï¼æ¶è´¹èçº¿ç¨ä¹ä¼æèªå·±çº¿ç¨æ ä¸­ä¿®æ¹çåéæç»å·æ°å°å ä¸­PipedInputStreamå¯¹è±¡ä¸­ï¼ä»¥ç¡®ä¿å¶å®æ¶è´¹èçº¿ç¨ççº¿ç¨æ ä»å ä¸­è¯»åè¿3ä¸ªåéæ¶ï¼è¿3ä¸ªåéå·²ç»ä¸ºä¿®æ¹åçå¼ï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212929105-1277795762.png" class="lazyload"></p>
<p>â£ãæ´æ°inï¼åæéï¼=-1åï¼æ¶è´¹èçº¿ç¨åæ¬¡åæ­¥æ§è¡PipedInputStream.class::read()å½æ°æ¶ï¼å¦æPipedInputStream::boolean closedByWriteråéä¸ºtrueï¼åä¼è¿å-1</p>
<h5 id="32å éå¾ªç¯ååéå éå¾ªç¯è¯»å°byteæ°ç»bä¸­åå¤ç">3.2ãå éå¾ªç¯ååéå éå¾ªç¯è¯»å°byte[]æ°ç»bä¸­åå¤ç</h5>
<pre><code>package com.chelong.pipe;
import java.io.IOException;
import java.io.PipedInputStream;
import java.io.PipedOutputStream;

public class PipeForTransferInThread {
   public static void main(String[] args) throws IOException, InterruptedException {
      final PipedOutputStream output = new PipedOutputStream();
      final PipedInputStream input = new PipedInputStream(output);
      //çäº§èçº¿ç¨
      Thread producer = new Thread(new Runnable() {
         @Override
         public void run() {
            for (int i = 0; i &lt; 3; i++) {
               synchronized (input) {
                  try {
//                    input.wait();
                     output.write("Hello world, pipe!".getBytes());
                     input.wait();//éæ¾éå¹¶æ éç­å¾ï¼ç´å°æ¶è´¹èçº¿ç¨consumer æ§è¡notifyAll()å½æ°æ¥å¤éå½åé»å¡
                  } catch (Exception e) {
                     e.printStackTrace();
                  }
               }
            }
         }
      },"çäº§èçº¿ç¨");
      
      //æ¶è´¹èçº¿ç¨
      Thread consumer = new Thread(new Runnable() {
         @Override
         public void run() {
            try {
               byte[] b = new byte[1024];//1KB
               int readBytes = -1;
               long lastTime = System.currentTimeMillis();
               while ((readBytes = input.read(b, 0, b.length)) != -1) {
                  long curTime = System.currentTimeMillis();
                  System.out.print(Thread.currentThread().getName()+"æ¬æ¬¡è¯»åè±è´¹æ¶é´ï¼" + (curTime - lastTime) + "msï¼è¯»å°çæ°æ®æ¯ï¼");
                  lastTime = curTime;
                  for (int i = 0; i &lt; readBytes; i++) {
                     System.out.print((char) b[i]);//æ¨¡æå¤çå­èæ°æ®
                  }
                  System.out.println();
               }
            } catch (IOException e) {
               e.printStackTrace();
            }
         }
      },"æ¶è´¹èçº¿ç¨");
      producer.start();//çäº§èçº¿ç¨å¯å¨
      consumer.start();//æ¶è´¹èçº¿ç¨å¯å¨
   }
}
</code></pre>
<p>ç¨åºè¿è¡ç»æï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219212957175-20935426.png" class="lazyload"></p>
<p>ââmainçº¿ç¨æé PipedOutputStreamï¼çäº§èï¼åPipedInputStreamï¼æ¶è´¹èï¼çè¿ç¨å¯ä»¥åè3.1ï¼<br>
ââåPipedOutputStreamï¼çäº§èï¼åå­èæ°æ®ççäº§èçº¿ç¨çæ§è¡è¿ç¨å¯ä»¥åè3.1ï¼<br>
ââä»PipedInputStreamï¼æ¶è´¹èï¼è¯»åå­èæ°æ®çæ¶è´¹èçº¿ç¨çæ§è¡è¿ç¨å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213038694-175651231.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213049017-456869541.png" class="lazyload"></p>
<h6 id="321å éå¾ªç¯ååéå éå¾ªç¯è¯»å°byteæ°ç»bä¸­åå¤çæ¶1ä¸ªçäº§èçº¿ç¨å1ä¸ªæ¶è´¹èçº¿ç¨å¤çæ°æ®çè¿ç¨">3.2.1ãå éå¾ªç¯ååéå éå¾ªç¯è¯»å°byte[]æ°ç»bä¸­åå¤çæ¶1ä¸ªçäº§èçº¿ç¨å1ä¸ªæ¶è´¹èçº¿ç¨å¤çæ°æ®çè¿ç¨</h6>
<p>ââæ é¢3.2ä¸­çä»£ç çæ´ä¸ªæ§è¡è¿ç¨å¦ä¸ï¼<br>
â ãmainçº¿ç¨åå§åä¸ä¸ªç¼å²åºï¼byte[]æ°ç»ï¼ï¼é¿åº¦ä¸º1024ï¼é»è®¤å¼ï¼ï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213118666-370990115.png" class="lazyload"></p>
<p>â¡ãç¶åçäº§èçº¿ç¨éè¿ä¸æ­çåæ æ¥å®æå½æ°ä¹é´çè°ç¨ï¼æç»æ§è¡PipedInputStream.class::receive(byte b[], int off, int len)å½æ°æ¥å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼è¿è¡å¡«åï¼å¹¶ä¸åå¨èªå·±ççº¿ç¨æ ä¸­æ´æ°inï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼writeSide=å½åè¿ä¸ªçäº§èçº¿ç¨ï¼Threadï¼å¯¹è±¡ å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213206234-855863118.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213228794-600203709.png" class="lazyload"></p>
<p>å½çäº§èçº¿ç¨å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼å¡«åå®æä¹åï¼åæ§è¡æ é¢3.2ä¸­çä»£ç </p>
<pre><code>input.wait();
</code></pre>
<p>è¿è¡ä»£ç ä¼éæ¾éå¹¶è®©çäº§èçº¿ç¨è¿å¥æ éç­å¾ï¼ç´å°æ¶è´¹èçº¿ç¨consumeræ§è¡notifyAll()å½æ°æ¥å¤éå½åè¿ä¸ªçäº§èçº¿ç¨ãå¨è¿ä¹åï¼çäº§èçº¿ç¨ä¼å°èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼writeSide=å½åè¿ä¸ªçäº§èçº¿ç¨ï¼è¿3ä¸ªåéæ´æ°å°ä¸»åå­ï¼ä¹å°±æ¯å ï¼ä¸­çPipedInputStreamå¯¹è±¡ä¸­ã<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213330975-716788447.png" class="lazyload"></p>
<p>â¢ãæ¶è´¹èçº¿ç¨è¯»ç¼å²åºï¼byte[]æ°ç»ï¼çè¿ç¨ä¹æ¯éè¿ä¸æ­çåæ æ¥å®æå½æ°ä¹é´çè°ç¨ï¼æç»æ§è¡PipedInputStream::read()å½æ°ï¼è¯æ¢æ§çè¯»å1ä¸ªå­èï¼åPipedInputStream::read(byte b[], int off, int len)å½æ°ï¼è¯»åå©ä½å¶å®çå­èï¼å°æ­¥éª¤â¡ä¸­çäº§èçº¿ç¨åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­ç17ä¸ªå­èè¯»ååºæ¥<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213355658-1832149818.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213408524-331963725.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213419622-364653237.png" class="lazyload"></p>
<blockquote>
<p>éè¨ï¼æç»æ¶è´¹èçº¿ç¨ä¹ä¼å°èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼= -1ï¼outï¼è¯»æéï¼= 17ï¼writeSide=å½åè¿ä¸ªæ¶è´¹èçº¿ç¨ï¼è¿3ä¸ªåéæ´æ°å°ä¸»åå­ï¼ä¹å°±æ¯å ï¼ä¸­çPipedInputStreamå¯¹è±¡ä¸­ã</p>
</blockquote>
<p>å æ­¤ï¼æ¬æ¬¡æ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æ°æ®çè¿ç¨ä¸­æ²¡ææ§è¡read()å½æ°ä¸­çwait(1000)è¿ä¸è¡ä»£ç ï¼å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214247483-2022355589.png" class="lazyload"></p>
<p>æä»¥ï¼æ¬æ¬¡æ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»åæ°æ®å°æ¶è´¹èçº¿ç¨ä¸­èªå·±åå»ºçbyte[]æ°ç»ä¸­æ¶ï¼åªè±è´¹äº0msï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214258804-1015500725.png" class="lazyload"></p>
<p>æ¥ä¸æ¥ï¼å½æ¶è´¹èçº¿ç¨å°æ­¥éª¤â¡ä¸­çäº§èçº¿ç¨åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­ç17ä¸ªå­èè¯»ååºæ¥ä»¥åï¼éè¿System.arraycopy()å½æ°å¤å¶å°äºæ¶è´¹èçº¿ç¨ä¸­èªå·±åå»ºçbyte[]æ°ç»ä¸­ï¼ï¼æ¶è´¹èçº¿ç¨ä¼éåä»ç¼å²åºè¯»å°çè¿ä¸ªbyte[]æ°ç»ï¼æ¥å¤çè¿äºæ°æ®ï¼å¦ä¸æç¤ºï¼æ é¢3.2ä¸­çä»£ç çæ®µï¼ï¼</p>
<pre><code>                   //æ é¢3.2ä¸­çä»£ç çæ®µ
                   for (int i = 0; i &lt; readBytes; i++) {
                     System.out.print((char) b[i]);//æ¨¡æå¤çå­èæ°æ®
                  }
</code></pre>
<p>ç¶åï¼å½æ¶è´¹èçº¿ç¨åæ¬¡æ§è¡</p>
<pre><code>//æ é¢3.2ä¸­çä»£ç çæ®µ
input.read(b, 0, b.length)
</code></pre>
<p>ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æ°æ®å°èªå·±åå»ºçbyte[]æ°ç»ä¸­æ¶ï¼ç±äºæ­¤æ¶inï¼åæéï¼=-1ï¼å¹¶ä¸å½ä¸å¾ä¸­çå¶å®5ä¸ªæ¡ä»¶é½ä¸æç«æ¶ï¼å¤éæ§è¡äº</p>
<pre><code>input.wait()
</code></pre>
<p>ççäº§èçº¿ç¨ï¼ç¶åå½åè¿ä¸ªæ­£å¨ä»ç¼å²åº(byteæ°ç»)ä¸­è¯»æ°æ®çæ¶è´¹èçº¿ç¨æ§è¡wait 1000ms ï¼å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214349541-777000844.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214404547-1644993049.png" class="lazyload"></p>
<p>â£ãå½çäº§èçº¿ç¨è¢«æ¶è´¹èçº¿ç¨æ§è¡ç</p>
<pre><code>notifyAll();
</code></pre>
<p>å¤éä¹åï¼ä¼åæ¬¡éè¿ä¸æ­çåæ æ¥å®æå½æ°ä¹é´çè°ç¨ï¼åæ¬¡æ§è¡PipedInputStream.class::receive(byte b[], int off, int len)å½æ°æ¥å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼è¿è¡å¡«åï¼å¹¶ä¸åå¨èªå·±ççº¿ç¨æ ä¸­åæ´æ°inï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼writeSide=å½åè¿ä¸ªçäº§èçº¿ç¨ï¼Threadï¼å¯¹è±¡ å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213206234-855863118.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214506624-944592756.png" class="lazyload"></p>
<p>å½çäº§èçº¿ç¨å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼å¡«åå®æä¹åï¼åæ§è¡æ é¢3.2ä¸­çä»£ç </p>
<pre><code>input.wait();
</code></pre>
<p>è¿è¡ä»£ç ä¼éæ¾éå¹¶è®©çäº§èçº¿ç¨è¿å¥æ éç­å¾ï¼ç´å°æ¶è´¹èçº¿ç¨consumeræ§è¡notifyAll()å½æ°æ¥å¤éå½åè¿ä¸ªçäº§èçº¿ç¨ãå¨è¿ä¹åï¼çäº§èçº¿ç¨ä¼å°èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼writeSide=å½åè¿ä¸ªçäº§èçº¿ç¨ï¼è¿3ä¸ªåéæ´æ°å°ä¸»åå­ï¼ä¹å°±æ¯å ï¼ä¸­çPipedInputStreamå¯¹è±¡ä¸­ãå¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214533848-1664801751.png" class="lazyload"></p>
<p>â¤ãæ¶è´¹èçº¿ç¨å¨ç¬¬â¢æ­¥æ§è¡äº</p>
<pre><code>wait(1000);
</code></pre>
<p>å¨ç­å¾äº1000msä¹åï¼æ¶è´¹èçº¿ç¨ä¼èªå¨å¤éç»§ç»­æ§è¡ï¼æ­¤æ¶èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼= -1ï¼outï¼è¯»æéï¼= 17å·²ç»è¢«ç¬¬â£æ­¥ä¸­ççäº§èçº¿ç¨ä¿®æ¹ä¸ºinï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼çäº§èçº¿ç¨ä¸ä¼ç´æ¥ä¿®æ¹æ¶è´¹èçº¿ç¨æ ä¸­çåéï¼çäº§èçº¿ç¨ä¼åå°èªå·±çº¿ç¨æ ä¸­inï¼åæéï¼ï¼outï¼è¯»æéï¼åéçå¼ä¿®æ¹å°ä¸»åå­ä¸­ï¼ç¶åæ¶è´¹èçº¿ç¨ä¼èªå·±å°ä¸»åå­ä¸­çè¿2ä¸ªåéå¼å·æ°å°æ¶è´¹èèªå·±ççº¿ç¨æ ä¸­ï¼ï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214556548-1757854590.png" class="lazyload"></p>
<p>ç¶åæ§è¡PipedInputStream::read()å½æ°ï¼è¯æ¢æ§çè¯»å1ä¸ªå­èï¼åPipedInputStream::read(byte b[], int off, int len)å½æ°ï¼è¯»åå©ä½å¶å®çå­èï¼å°æ­¥éª¤â£ä¸­çäº§èçº¿ç¨åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­ç17ä¸ªå­èè¯»ååºæ¥<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213355658-1832149818.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213408524-331963725.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214634067-1884703899.png" class="lazyload"></p>
<blockquote>
<p>éè¨ï¼æç»æ¶è´¹èçº¿ç¨ä¹ä¼å°èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼= -1ï¼outï¼è¯»æéï¼= 17ï¼writeSide=å½åè¿ä¸ªæ¶è´¹èçº¿ç¨ï¼è¿3ä¸ªåéæ´æ°å°ä¸»åå­ï¼ä¹å°±æ¯å ï¼ä¸­çPipedInputStreamå¯¹è±¡ä¸­ã</p>
</blockquote>
<p>ç±äºï¼æ¬æ¬¡æ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æ°æ®çè¿ç¨æ¯ä»æ­¥éª¤â¢ä¸­èªå¨å¤éç»§ç»­æ§è¡çï¼æä»¥ï¼æ¬æ¬¡æ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»åæ°æ®å°æ¶è´¹èçº¿ç¨ä¸­èªå·±åå»ºçbyte[]æ°ç»ä¸­æ¶ï¼è±è´¹äº1015msï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214751875-1048696201.png" class="lazyload"></p>
<p>æ¥ä¸æ¥ï¼å½æ¶è´¹èçº¿ç¨å°æ­¥éª¤â£ä¸­çäº§èçº¿ç¨åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­ç17ä¸ªå­èè¯»ååºæ¥ä»¥åï¼éè¿System.arraycopy()å½æ°å¤å¶å°äºæ¶è´¹èçº¿ç¨ä¸­èªå·±åå»ºçbyte[]æ°ç»ä¸­ï¼ï¼æ¶è´¹èçº¿ç¨ä¼éåä»ç¼å²åºè¯»å°çè¿ä¸ªbyte[]æ°ç»ï¼æ¥å¤çè¿äºæ°æ®ï¼å¦ä¸æç¤ºï¼æ é¢3.2ä¸­çä»£ç çæ®µï¼ï¼</p>
<pre><code>                   //æ é¢3.2ä¸­çä»£ç çæ®µ
                   for (int i = 0; i &lt; readBytes; i++) {
                     System.out.print((char) b[i]);//æ¨¡æå¤çå­èæ°æ®
                  }
</code></pre>
<p>ç¶åï¼å½æ¶è´¹èçº¿ç¨åæ¬¡æ§è¡</p>
<pre><code>//æ é¢3.2ä¸­çä»£ç çæ®µ
input.read(b, 0, b.length)
</code></pre>
<p>ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æ°æ®å°èªå·±åå»ºçbyte[]æ°ç»ä¸­æ¶ï¼ç±äºæ­¤æ¶inï¼åæéï¼=-1ï¼å¹¶ä¸å½ä¸å¾ä¸­çå¶å®5ä¸ªæ¡ä»¶é½ä¸æç«æ¶ï¼å¤éæ§è¡äº</p>
<pre><code>input.wait()
</code></pre>
<p>ççäº§èçº¿ç¨ï¼ç¶åå½åè¿ä¸ªæ­£å¨ä»ç¼å²åº(byte[]æ°ç»)ä¸­è¯»æ°æ®çæ¶è´¹èçº¿ç¨æ§è¡wait 1000ms ï¼å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214349541-777000844.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214404547-1644993049.png" class="lazyload"></p>
<p>â¥ãå½çäº§èçº¿ç¨è¢«æ¶è´¹èçº¿ç¨æ§è¡ç</p>
<pre><code>notifyAll();
</code></pre>
<p>å¤éä¹åï¼ä¼åæ¬¡éè¿ä¸æ­çåæ æ¥å®æå½æ°ä¹é´çè°ç¨ï¼åæ¬¡æ§è¡PipedInputStream.class::receive(byte b[], int off, int len)å½æ°æ¥å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼è¿è¡å¡«åï¼å¹¶ä¸åå¨èªå·±ççº¿ç¨æ ä¸­åæ´æ°inï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼writeSide=å½åè¿ä¸ªçäº§èçº¿ç¨ï¼Threadï¼å¯¹è±¡ å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213206234-855863118.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214506624-944592756.png" class="lazyload"></p>
<p>å½çäº§èçº¿ç¨å¯¹ç¼å²åºï¼byte[]æ°ç»ï¼å¡«åå®æä¹åï¼åæ§è¡æ é¢3.2ä¸­çä»£ç </p>
<pre><code>input.wait();
</code></pre>
<p>è¿è¡ä»£ç ä¼éæ¾éå¹¶è®©çäº§èçº¿ç¨è¿å¥æ éç­å¾ï¼ç´å°æ¶è´¹èçº¿ç¨consumeræ§è¡notifyAll()å½æ°æ¥å¤éå½åè¿ä¸ªçäº§èçº¿ç¨ãå¨è¿ä¹åï¼çäº§èçº¿ç¨ä¼å°èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼writeSide=å½åè¿ä¸ªçäº§èçº¿ç¨ï¼è¿3ä¸ªåéæ´æ°å°ä¸»åå­ï¼ä¹å°±æ¯å ï¼ä¸­çPipedInputStreamå¯¹è±¡ä¸­ãå¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214533848-1664801751.png" class="lazyload"></p>
<p>â¦ãæ¶è´¹èçº¿ç¨å¨ç¬¬â¤æ­¥æ§è¡äº</p>
<pre><code>wait(1000);
</code></pre>
<p>å¨ç­å¾äº1000msä¹åï¼æ¶è´¹èçº¿ç¨ä¼èªå¨å¤éç»§ç»­æ§è¡ï¼æ­¤æ¶èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼= -1ï¼outï¼è¯»æéï¼= 17å·²ç»è¢«ç¬¬â¥æ­¥ä¸­ççäº§èçº¿ç¨ä¿®æ¹ä¸ºinï¼åæéï¼=17ï¼outï¼è¯»æéï¼=0ï¼çäº§èçº¿ç¨ä¸ä¼ç´æ¥ä¿®æ¹æ¶è´¹èçº¿ç¨æ ä¸­çåéï¼çäº§èçº¿ç¨ä¼åå°èªå·±çº¿ç¨æ ä¸­inï¼åæéï¼ï¼outï¼è¯»æéï¼åéçå¼ä¿®æ¹å°ä¸»åå­ä¸­ï¼ç¶åæ¶è´¹èçº¿ç¨ä¼èªå·±å°ä¸»åå­ä¸­çè¿2ä¸ªåéå¼å·æ°å°æ¶è´¹èèªå·±ççº¿ç¨æ ä¸­ï¼ï¼ç¶åæ§è¡PipedInputStream::read()å½æ°ï¼è¯æ¢æ§çè¯»å1ä¸ªå­èï¼åPipedInputStream::read(byte b[], int off, int len)å½æ°ï¼è¯»åå©ä½å¶å®çå­èï¼å°æ­¥éª¤â¥ä¸­çäº§èçº¿ç¨åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­ç17ä¸ªå­èè¯»ååºæ¥<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213355658-1832149818.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219213408524-331963725.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214634067-1884703899.png" class="lazyload"></p>
<blockquote>
<p>éè¨ï¼æç»æ¶è´¹èçº¿ç¨ä¹ä¼å°èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼= -1ï¼outï¼è¯»æéï¼= 17ï¼writeSide=å½åè¿ä¸ªæ¶è´¹èçº¿ç¨ï¼è¿3ä¸ªåéæ´æ°å°ä¸»åå­ï¼ä¹å°±æ¯å ï¼ä¸­çPipedInputStreamå¯¹è±¡ä¸­ã</p>
</blockquote>
<p>ç±äºï¼æ¬æ¬¡æ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æ°æ®çè¿ç¨æ¯ä»æ­¥éª¤â¤ä¸­èªå¨å¤éç»§ç»­æ§è¡çï¼æä»¥ï¼æ¬æ¬¡æ¶è´¹èçº¿ç¨ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»åæ°æ®å°æ¶è´¹èçº¿ç¨ä¸­èªå·±åå»ºçbyte[]æ°ç»ä¸­æ¶ï¼è±è´¹äº1017msï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215231062-1134536045.png" class="lazyload"></p>
<p>æ¥ä¸æ¥ï¼å½æ¶è´¹èçº¿ç¨å°æ­¥éª¤â¥ä¸­çäº§èçº¿ç¨åå¥å°ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­ç17ä¸ªå­èè¯»ååºæ¥ä»¥åï¼éè¿System.arraycopy()å½æ°å¤å¶å°äºæ¶è´¹èçº¿ç¨ä¸­èªå·±åå»ºçbyte[]æ°ç»ä¸­ï¼ï¼æ¶è´¹èçº¿ç¨ä¼éåä»ç¼å²åºè¯»å°çè¿ä¸ªbyte[]æ°ç»ï¼æ¥å¤çè¿äºæ°æ®ï¼å¦ä¸æç¤ºï¼æ é¢3.2ä¸­çä»£ç çæ®µï¼ï¼</p>
<pre><code>                   //æ é¢3.2ä¸­çä»£ç çæ®µ
                   for (int i = 0; i &lt; readBytes; i++) {
                     System.out.print((char) b[i]);//æ¨¡æå¤çå­èæ°æ®
                  }
</code></pre>
<p>ç¶åï¼å½æ¶è´¹èçº¿ç¨åæ¬¡æ§è¡</p>
<pre><code>//æ é¢3.2ä¸­çä»£ç çæ®µ
input.read(b, 0, b.length)
</code></pre>
<p>ä»ç¼å²åºï¼byte[]æ°ç»ï¼ä¸­è¯»æ°æ®å°èªå·±åå»ºçbyte[]æ°ç»ä¸­æ¶ï¼ç±äºæ­¤æ¶inï¼åæéï¼=-1ï¼å¹¶ä¸å½ä¸å¾ä¸­çå¶å®5ä¸ªæ¡ä»¶é½ä¸æç«æ¶ï¼å¤éæ§è¡äº</p>
<pre><code>input.wait()
</code></pre>
<p>ççäº§èçº¿ç¨ï¼ç¶åå½åè¿ä¸ªæ­£å¨ä»ç¼å²åº(byte[]æ°ç»)ä¸­è¯»æ°æ®çæ¶è´¹èçº¿ç¨æ§è¡wait 1000ms ï¼å¦ä¸ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214349541-777000844.png" class="lazyload"><br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219214404547-1644993049.png" class="lazyload"></p>
<p>â§ãå½çäº§èçº¿ç¨è¢«æ¶è´¹èçº¿ç¨æ§è¡ç</p>
<pre><code>notifyAll();
</code></pre>
<p>å¤éä¹åï¼ä¼è·³åºforå¾ªç¯ï¼ç»æçäº§èçº¿ç¨ççå½å¨æï¼ä¹åï¼è¯¥çº¿ç¨å¯¹è±¡ä¼è¢«æä½ç³»ç»åæ¶ã<br>
â¨ãæ¶è´¹èçº¿ç¨å¨ç¬¬â¦æ­¥æ§è¡äº</p>
<pre><code>wait(1000);
</code></pre>
<p>å¨ç­å¾äº1000msä¹åï¼æ¶è´¹èçº¿ç¨ä¼èªå¨å¤éç»§ç»­æ§è¡ï¼æ­¤æ¶èªå·±çº¿ç¨æ ä¸­çinï¼åæéï¼= -1ï¼outï¼è¯»æéï¼= 17ï¼å¹¶ä¸ä»</p>
<pre><code>wait(1000);
</code></pre>
<p>çä»£ç ä¹åï¼ç»§ç»­æ§è¡ï¼æ§è¡è¿ç¨å¦ä¸ï¼ä»ä¸å¾çç´«è²æµç¨ç»§ç»­æ§è¡ï¼ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215457614-1446643501.png" class="lazyload"></p>
<p>å¨æ§è¡äº2ä¸ªå¾ªç¯åï¼ç´å°int trials = 0æ¶ï¼æ§è¡å°å¤æ­(writeSide != null) &amp;&amp; (!writeSide.isAlive()) &amp;&amp; (--trials &lt; 0)è¿ä¸ªæ¡ä»¶æ¶å°±ä¼ä¸ºtrueï¼ä¸å¾ççº¢è²æµç¨ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215508348-1020804433.png" class="lazyload"></p>
<p>ç¶åï¼æåºäºä¸ä¸ªIOException("Pipe broken")ï¼å æ­¤ï¼å¯ä»¥å¾åºint trialsåéçå«ä¹ï¼è¿ä¸ªåéæ¯ä¸ä¸ªå¤æ¬¡æ£æµçç­ç¥åéï¼å½çäº§èçº¿ç¨æ²¡æå³é­äºä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼æ¶ï¼å¹¶ä¸writeSideåéæåçå½åçäº§èçº¿ç¨å·²ç»è¢«æä½ç³»ç»åæ¶æ¶ï¼æ­¤æ¶å½åçäº§èçº¿ç¨å¯¹è±¡çisAlive()å½æ°ä¼è¿åfalseï¼ï¼æ¶è´¹èçº¿ç¨ä¼æåº1ä¸ªIOException("Pipe broken")ï¼å¹¶ç»æwhileå¾ªç¯ï¼è¿èç»ææ¶è´¹èçº¿ç¨ççå½å¨æãä¹åï¼è¯¥çº¿ç¨å¯¹è±¡ä¹ä¼è¢«æä½ç³»ç»åæ¶ãå¦ä¸å¾æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215557745-511787897.png" class="lazyload"></p>
<h6 id="322ææ ·é²æ­¢321ä¸­ç¬¬æ­¥ççäº§èçº¿ç¨æåºioexceptionpipe-broken">3.2.2ãææ ·é²æ­¢3.2.1ä¸­ç¬¬â¨æ­¥ççäº§èçº¿ç¨æåºIOException("Pipe broken")</h6>
<p>ââåé¡¾3.2.1ä¸­ç¬¬â¨æ­¥ä¸­çæ¶è´¹èçº¿ç¨æåºIOException("Pipe broken")çäº§çè¿ç¨ï¼å½æ§è¡å°å¤æ­(writeSide != null) &amp;&amp; (!writeSide.isAlive()) &amp;&amp; (--trials &lt; 0)è¿ä¸ªæ¡ä»¶æ¶å°±ä¼ä¸ºtrueï¼ä¸å¾ççº¢è²æµç¨ï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215508348-1020804433.png" class="lazyload"></p>
<p>é£ä¹ï¼ä½¿ç¨èå°±å¯ä»¥å°ä¸å¾ä¸­çº¢è²æµç¨çåä¸æ­¥åætrueå³å¯ï¼å¦ä¸ä»£ç æç¤ºï¼åªä¿®æ¹äºçäº§èçº¿ç¨ä¸­çä»£ç ï¼æ¶è´¹èçº¿ç¨ä¸­çä»£ç æ²¡æååï¼ï¼</p>
<pre><code>package com.chelong.pipe;
import java.io.IOException;
import java.io.PipedInputStream;
import java.io.PipedOutputStream;
   public static void main(String[] args) throws IOException, InterruptedException {
      final PipedOutputStream output = new PipedOutputStream();
      final PipedInputStream input = new PipedInputStream(output);
      //çäº§èçº¿ç¨
      Thread producer = new Thread(new Runnable() {
         @Override
         public void run() {
            try {
               for (int i = 0; i &lt; 3; i++) {
                  synchronized (input) {
//                    input.wait();
                     output.write("Hello world, pipe!".getBytes());
                     input.wait();//éæ¾éå¹¶æ éç­å¾ï¼ç´å°æ¶è´¹èçº¿ç¨thread2æ§è¡notifyAll()å½æ°æ¥å¤éå½åé»å¡
                  }
               }
            } catch (Exception e) {
               e.printStackTrace();
            } finally {
               try {
                  if (output != null) output.close();//è°ç¨close()å½æ°å³é­çäº§èå¯¹è±¡
               } catch (IOException e) {
                  e.printStackTrace();
               }
            }
         }
      }, "çäº§èçº¿ç¨");

      //æ¶è´¹èçº¿ç¨
      Thread consumer = new Thread(new Runnable() {
         @Override
         public void run() {
            try {
               byte[] b = new byte[1024];//1KB
               int readBytes = -1;
               long lastTime = System.currentTimeMillis();
               while ((readBytes = input.read(b, 0, b.length)) != -1) {
                  long curTime = System.currentTimeMillis();
                  System.out.print(Thread.currentThread().getName() + "æ¬æ¬¡è¯»åè±è´¹æ¶é´ï¼" + (curTime - lastTime) + "msï¼è¯»å°çæ°æ®æ¯ï¼");
                  lastTime = curTime;
                  for (int i = 0; i &lt; readBytes; i++) {
                     System.out.print((char) b[i]);//æ¨¡æå¤çå­èæ°æ®
                  }
                  System.out.println();
               }
            } catch (IOException e) {
               e.printStackTrace();
            }
         }
      }, "æ¶è´¹èçº¿ç¨");
      producer.start();//çäº§èçº¿ç¨å¯å¨
      consumer.start();//æ¶è´¹èçº¿ç¨å¯å¨
   }
}
</code></pre>
<p>ç¨åºè¿è¡ç»æï¼å¦ä¸æç¤ºï¼<br>
<img alt="clipboard" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2485827/202602/2485827-20260219215642548-1984110125.png" class="lazyload"></p>
<p>ââéè¿PipedOutputStream.class::close()çæºç å¯ä»¥çå°è¿æ ·ä¿®æ¹åæ¶è´¹èçº¿ç¨ä¸åæåºIOException("Pipe broken")åå ï¼<br>
PipedOutputStream.classï¼çäº§èç±»ï¼çæºç </p>
<pre><code>package java.io;

import java.io.*;

public
class PipedOutputStream extends OutputStream {
    ...çç¥é¨åä»£ç ...
    //å³é­è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ï¼è¿ä¸ªPipedOutputStreamï¼çäº§èï¼ä¸è½ååä¸å®ç¸å³èçPipedInputStreamï¼æ¶è´¹èï¼ä¸­çç¼å²åºï¼byte[]æ°ç»ï¼åå¥å­èæ°æ®
    public void close()  throws IOException {
        if (sink != null) {
            sink.receivedLast();//è°ç¨PipedInputStream.class::receivedLast()å½æ°
        }
    }
}
</code></pre>
<p>PipedInputStream .classï¼æ¶è´¹èç±»ï¼çæºç </p>
<pre><code>package java.io;

public class PipedInputStream extends InputStream {
    //æ è®°ç¬¦ï¼trueè¡¨ç¤ºä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼å·²ç»å³é­ï¼åä¹ï¼åä¹
    boolean closedByWriter = false;
    ...çç¥é¨åä»£ç ...
    //å³é­ä¸è¿ä¸ª PipedInputStream ï¼æ¶è´¹èï¼ç¸å³èçPipedOutputStreamï¼çäº§èï¼
    synchronized void receivedLast() {
        closedByWriter = true;//å³é­åæ¶è´¹èåä»ç¼å²åºï¼byte[]ï¼æ°ç»ä¸­è¯»åå­èæ°æ®æ¶ï¼ä¼è¿å-1ï¼ä¸ä¼æåºIOExceptionäº
        notifyAll();//å¤éæææ¶è´¹èçº¿ç¨
    }
    ...çç¥é¨åä»£ç ...
</code></pre>
<h4 id="åå¤ä¸ªçº¿ç¨åpipedoutputstreamçäº§èåå­èæ°æ®å¤ä¸ªçº¿ç¨ä»pipedinputstreamæ¶è´¹èè¯»åå­èæ°æ®çè¿ç¨">åãå¤ä¸ªçº¿ç¨åPipedOutputStreamï¼çäº§èï¼åå­èæ°æ®ï¼å¤ä¸ªçº¿ç¨ä»PipedInputStreamï¼æ¶è´¹èï¼è¯»åå­èæ°æ®çè¿ç¨</h4>
<p>ââç¥ï¼å¾è¡¥åï¼</p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-19 22:08">2026-02-19 22:07</span>&nbsp;
<a href="https://www.cnblogs.com/Carey-ccl">Carey_ccl</a>&nbsp;
éè¯»(<span id="post_view_count">55</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19625392);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19625392', targetLink: 'https://www.cnblogs.com/Carey-ccl/p/19625392', title: '9ãPipedInputStreamåPipedOutputStreamçæºç åæåä½¿ç¨æ¹æ³è¯¦ç»åæ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ 2023å¹´çµèµå½èµç»å ]]></title>
    <link>https://www.cnblogs.com/badboy02/p/19623709</link>
    <guid>a21e9f8d7b8393aa8d45fdd62c943c13</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/badboy02/p/19623709" title="åå¸äº 2026-02-19 14:06">
    <span role="heading" aria-level="2">2023å¹´çµèµå½èµç»å</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3763221/202602/3763221-20260219000428689-1446099918.png" alt="2023å¹´çµèµå½èµç»å" class="desc_img">
        2023å¹´å¨å½å¤§å­¦ççµå­è®¾è®¡ç«èµç»åï¼Dé¢ä¿¡å·é¢ï¼å½èµäºç­å¥ã
ä¸äºæ¯èµç»ååç»éªæå·§
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>--- markdownæè¿°<br>
title: çµèµ2023å½èµDé¢æ¯èµç»å<br>
date: 2023/8/15 11:52:25<br>
cover: true<br>
mathjax: false<br>
summary: æ¯èµè¿ç¨åä¸äºåå¤å·¥ä½çç¢ç¢å¿µ<br>
categories: Note<br>
tags:</p>
<ul>
<li>çµèµ</li>
<li>ä¿¡å·</li>
</ul>
<hr>
<h2 id="è¡¥æ¡£å£°æ">è¡¥æ¡£å£°æ</h2>
<p>ç±äºæçåå®¢æå¡å¨åå¤æ¡å°æï¼æä»¥éæ©è½¬ç§»å°åå®¢å­å¹³å°æ¥è¿è¡ä¿å­åè®°å½ãä»¥åä¹æå¯è½ä¼å¨ä¸é¢ä¸å®ææ´æ°ä¸äºææ¯ç±»åå®¢ã</p>
<h2 id="åå¨åé¢">åå¨åé¢</h2>
<p>ðªçªç¶æè¯å°èªå·±å·²ç»8ä¸ªææ²¡æ´æ°åå®¢äºï¼è¿æ®µæ¶é´å¶å®ä¹æ²¡éä¸å¥å¤ªå¤æçäºï¼å¤§æ¦å°±æ¯ä¸äºæ²æ·ä¹ç±»çï¼å³å®äºä¹åçå­¦ä¸å»åï¼æ¨åäºæ¬æ ¡çç ç©¶çãè¿ä¸æ­¥è®¤è¯äºä¸ç¾¤æªæ¥å¿åéåççåé¨ï¼æ¿æç½ç©å¡å°è¾¾æ·éä¹æ¯åçå½ä¹æ³ªï¼ç ç å°æ²»æäºä¸éµå­ççµå­é³ç¿ï¼ä»¥åå¼å§å¥èº«ï¼å­çï¼ã<br>
å½ç¶ï¼çµèµä»ä¹çä¹æ¯æå¨åå¤çï¼ç±äºå¢éå¶ä»ä¸¤ä¸ªé½æ¯ç¡¬ä»¶ä½¬ï¼ä»ä»¬æ¿åçç»æ¿ä¸çæ¥è°è¯çæ°´æ·±ç«ç­ï¼æåªéè¦å®å®ééçåä»£ç å°±è¶³å¤äºï¼ç¬ï¼ï¼æ¯å¤©å®éªå®¤ä¸ä¸ç­ï¼æèªå·±çé¨åæå®ï¼ç¶åå»å¥èº«æ¿é»ç¼ä¸ä¼ï¼åæ¥ç¾ç¾å ä¸ªé¤æ´ä¸ªæ¾¡ï¼ç¶åæææºå»ç¡è§ï¼ä¹ç®æ¯æç§æä¹ä¸çå¹³éççæ´»ï¼æ±ä¹ä¸å¾ãæ¯ç«å½åå³å®æçµèµè¯´å°åºä¹åªæ¯ä¸ºäºæåèªå·±ï¼æ¢ç´¢ä¸ä¸çµå­ä¸ççå¥¥å¦ï¼è¿ä¹ä¹èµ°è¿æ¥ä¹æ¯éå¨åæï¼ä¹å¸ææåè½æä¸ä¸ªå¥½ç»æã<br>
æªæ­¢å°ååå®¢çæ¶åï¼æä»¬ç»çæç»©çèµä»¥çä¸å¹¶åç¬¬ä¸åºçº¿ï¼ç»¼åæµè¯åºè¯¥ä¹è½è¿çº¿ï¼å±±ä¸å¤§å­¦å½æµå¤æµä¸åºæå¤çè¯ï¼åºè¯¥æ¯å½äºä»¥ä¸ã</p>
<p>è¿ç¯åå®¢ä¼åä¸ºä¸ä¸ä¸¤é¨åï¼ä¸ç¯ä¸»è¦æ¯æ¯èµçè¿ç¨åä¸äºåç½®çåå¤(æ²¡æè¥å»çç¢ç¢å¿µ)ï¼ä¸ç¯ä¸»è¦æ¯ä¸äºç®æ³å·ä½çå®ç°(ä¸äºææ¥ä¹ä¸ççµæºä¸å¨ï¼å¤§ä½¬è½»é¤)ã</p>
<h2 id="æ¯èµè¿ç¨">æ¯èµè¿ç¨</h2>
<ol>
<li>åå¤é¶æ®µ</li>
</ol>
<p>æä»¬éä¼ä¸ç´ä»¥æ¥è®­ç»çæ¯ä»ªè¡¨åé«é¢é¢ï¼ä¸å¼å§ä¾§éFPGAé«éä¿¡å·ééåæ°å­åå¤çè¿ä¸åï¼ä½æ¯åé¢éæ¸æè¯å°ï¼å¯¹äºçµèµçææ èå´åå¥½åä¹ä¸éè¦è¿ä¹é«çé¢çï¼é«è½½æ³¢å¸¦æ¥çé«éæ ·çé®é¢å¯ä»¥éè¿ä¸æ··é¢ç¼è§£ï¼èé«é¢ç´éå¸¦æ¥æ¯çFIRæ»¤æ³¢å¨çèµæºæ¶èæåå¢å ï¼ä»¥åæ°å­åå¤çå¸¦æ¥çèµæºå ç¨åéååªå£°é®é¢ã</p>
<p><img alt="ZYNQ7100å¹³å°" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/ZYNQ7100%E5%B9%B3%E5%8F%B0.webp" class="lazyload"><br>
è¿æ¯æä»¬åå¤çZYNQ7100çå¹³å°ï¼å¯ä»¥å¤æ¥é«éADDAï¼æ¿è½½DDR3.<br>
ä½æ¯å§ï¼ZYNQå¹³å°çç»¼åéåº¦ååºåé¾åº¦ä»¥åVerilogä»£ç çéªè¯é¾åº¦ï¼å¨åç§å¿äºçç«èµéï¼å¦ææ²¡æé¿æçè®­ç»ååå¤ï¼å¨æ¯èµé£åå¤©çæ¥ä¸å¤´å»åï¼ææä¼ç¿»è½¦ã</p>
<p>äºæ¯å¨è®­ç»åæåéåSTM32H743çåçæºå¹³å°ï¼ä¾§éæ¨¡åå å åçå¥å£®æ§åä»£ç çå¯å¤ç¨æ§ã</p>
<p>ä»è®­ç»å¼å§ï¼ðªå°±ææè¯å°æä¸äºç®æ³ï¼å°¤å¶æ¯FFTåæè¿ä¸åï¼åæäºç¬ç«çå½æ°å»è¿è¡ä¸äºåæ°çåæï¼ç¶åæå¶ä»çåæ¯å±å¹æ¾ç¤ºï¼æé®è¾å¥ï¼å¤è®¾é©±å¨ï¼é½å°è£æä¸»å¾ªç¯ä¸­çå½æ°ï¼ç¨åæ°åæ å¿ä½å»æ§å¶ãä¸å¾ä¸è¯´å¨çµèµçä¿¡å·åæé¢ä¸­è¿æ¯ä¸ç§å¾å¥½ç¨çä»£ç æ¶æã</p>
<p><img alt="Mainå½æ°æªå¾" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/Main%E5%87%BD%E6%95%B0%E6%88%AA%E5%9B%BE.webp" class="lazyload"></p>
<p>æ¬æ¬¡ä»£ç çç»ç»ç»æï¼å¯ä»¥æ¸æ¥ççå°ï¼æ¯é¦åè¿è¡ADCééï¼FFTè®¡ç®ï¼ç¶åå°åæ°ä¼ å¥Judge_ModeTypeå½æ°è®¡ç®åºè°å¶ç±»åï¼ç¶åè¿å¥ç¸åºçé¨åå»è¿è¡åæåæ¾ç¤ºã</p>
<p>2.æ­£å¼å¼å§</p>
<p>æ¯èµçé£å å¤©ï¼ç¬¬ä¸å¤©ä¸å8ç¹éåä¸æ¿å°é¢ç®åºæ¬ä¸å°±ç¡®å®äºæ¯Dé¢ï¼ç¶åå°±å¼å§ç»ç³»ç»æ¡å¾ï¼æ¾æ¨¡åï¼æ­ç³»ç»ã<br>
ðªæ¯ä¹ç¹éå°çå®éªå®¤ãç¶åä¸çé¢ï¼å¦è±ï¼MaåMfï¼ è¿ä¸æ¯èæååï¼å»å¹´çèµè¿ä¸¤ä½ééçº§ï¼ç¹å«æ¯Mfï¼è®©æ æ°éä¼å¹ç¾½èå½ã<br>
å¶å¥å¦çå¤å¼åè«åå¶å¦çç®ä¸åé®é¢ï¼é¾å°äºä¸å¤§æ¹çµèµå£¬ã<br>
ä¸è¿ç®æ³æ¹é¢ðªæ©æåºå¯¹ï¼å·ä½è¯·çåæåæã<br>
éåææ··é¢æ¨¡åå¼å¥½ï¼ç¡®å®å¥½ä¸­é¢é¢çåï¼ææ··é¢åçä¿¡å·éå¥ADCæ¨¡åï¼æ­¤æ¶ðªè¿è¡äºç®åçæµè¯ï¼ç¡®å®äºADCéæ ·çã<br>
ç¶åå°±å¼å§äºç®æ³çç¼åãå¨ç¬¬ä¸å¤©çä¸­åå°±æMaçè®¡ç®æå®äºï¼ç²¾åº¦è¯¯å·®å¤§æ¦å¨0.05å·¦å³ã<br>
ç¶åä¸åæMfçç®æ³ä¹åºæ¬è°è¯æ­£ç¡®äºï¼ç²¾åº¦è¯¯å·®å¨0.2å·¦å³ï¼æå°éçå¤å¼é®é¢ï¼è¿æ¶åæ¶é´å·²ç»æ¯ç¬¬ä¸å¤©æä¸ç8ç¹ï¼ðªè¿è¡äºç¬¬ä¸æ¬¡å¤ä»½ãï¼æ¶å¸¸å¤ä»½çæ¯å¥½ä¹ æ¯ï¼<br>
<img alt="å¤ä»½æªå¾" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/%E5%A4%87%E4%BB%BD%E6%88%AA%E5%9B%BE.webp" class="lazyload"><br>
è¿æ¯å·¥ç¨çå æ¬¡å¤ä»½å¾ï¼å¯ä»¥çå°ä»7æ17æ¥ç¡®å®äºåºæ¬å¹³å°ä¹åï¼å°±æ¯å å¤©ä¸å¤ä»½ï¼å¨æ¯èµé£å å¤©æ´æ¯ä¸å¤©å¤ä»½å æ¬¡ã<br>
ä¸ºä»ä¹æ²¡æä½¿ç¨gitä¹ç±»ççæ¬æ§å¶å·¥å·å¢ï¼å ä¸ºæä¸ä¼ï¼å¶å®æ¯æå¾å»ºä»åº+æ²¡æ¾å°åéçæç®¡å¹³å°ï¼githubè¿ä¸ä¸ï¼giteeä¸æ³ç¨ï¼<br>
ç¶åå°±æ¯ASKï¼FSKï¼PSKçå¤å«ãè§£è°ä»¥åFSKçhåæ°è®¡ç®é®é¢ï¼æ»çè¯´æ¥ï¼è¿ä¸ªè±è´¹äºðªä¸çªåå¤«ï¼ä¹ç®æ¯ææ ¸å¿çä»£ç é¨åã<br>
ç¬¬äºå¤©çä¸­åå®æäºæ¨¡æè°å¶åæ°å­è°å¶ä¸¤å¤§ç±»çåæ­¥å¤æ­ï¼ä¸åè¿ä¸æ­¥å®æäºæ¨¡æçAMï¼FMï¼CWçè¿ä¸æ­¥å¤æ­ï¼ä»¥åæ°å­çASKï¼FSKï¼PSKçè¿ä¸æ­¥å¤æ­åè§£è°ã(åå®çä¸å¤©)<br>
<img alt="PSKè§£è°" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/PSK%E8%A7%A3%E8%B0%83.webp" class="lazyload"><br>
ç¬¬äºå¤©æä¸åå¯å®¤çæ¶åðªå¨åéåé²æ¯çæ¶åçªç¶æ³å°äºFSKçhåæ°è®¡ç®æ¹æ³ï¼ç¶åå¨å°æ¬æ¬ä¸è®°äºä¸æ¥ã<br>
ç¬¬ä¸å¤©ï¼ðªä¸å°å®éªå®¤å°±å¼å§çæéªè¯èªå·±çæ³æ³ï¼åç°å®å¨å¯ä»¥ï¼ç´æ¥èæ¹èµ·é£ã<br>
ç¶åä¸åçæ¶é´å°±æ¯å å¥å°é¢å¼å³åæ»¤æ³¢å¨ï¼æ¾å¤§å¨ç­åä»¶ï¼å®æäºç³»ç»çæ´ä½çº§èåæåè§£è°æ³¢å½¢çå®æ¶åæ¢ã<br>
ç¬¬ä¸å¤©çæä¸å¶å®æ´ä¸ªç³»ç»å·²ç»çº§èå¹¶ä¸æµè¯å¥½äºã<br>
æåä¸å¤©å°±æ¯ä¸äºé¦ä¸æ·»è±çåè½ï¼æ¯å¦å®æ¶é¢è°±æ¾ç¤ºåQPSKçå¤æ­ä»¥åé«é¢è½½æ³¢ä¸çè§£è°ä»¥åååº¦çä¿®æ­£ï¼å¨ä¸åä¸ç¹å·¦å³å®æäºæåçæµè¯åå°ç®±ã<br>
<img alt="å°ç®±" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/%E5%B0%81%E7%AE%B1.webp" class="lazyload"><br>
æ»çæ¥è¯´è¿å å¤©çæµç¨è¿æ¯ç¨³æç¨³æï¼éæ­¥æ¨è¿çãæä»¬å¢éä¸ç´ä»¥æ¥éåçä¹å¾ä¸éï¼æçè´¼é«ï¼æååç°åºæ¥çææå°±æ¯çµèµè¿ä¸å¤©æ¯å¤©æä¸11ç¹é½åå¯å®¤ç¡è§äºï¼ç¬¬äºå¤©9ç¹åå°å®éªå®¤ï¼ä¹è¿è½å®æææçåºç¡åæé«ææ å¹¶ååº3é¡¹å¶ä»ææ ãä¸ç¥ä¸è§ä¸­å®æäºæä»¬å¢éåå¼å§æ¥è§¦çµèµçæ¶çä¸ä¸ªç©ç¬-å¸æä»¥åè½ä¸ç¬å¤å°±æå®çµèµã<br>
<img alt="äº¤ä½å" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/%E4%BA%A4%E4%BD%9C%E5%93%81.webp" class="lazyload"><br>
ä½ä¸ºä¸éä¸»ï¼åå¤äº¤ä½åä¹æ¯å¾åççç½¢ã</p>
<p>3.çèµæµè¯</p>
<p>å°ç®±åçç¬¬äºå¤©å°±æ¯çæµäºï¼æ»çæ¥è¯´è¿æ¯è®é¡ºå©çï¼ææåè½é½æ¼ç¤ºåºæ¥äºï¼æµè¯è¡¨çææ ä¹æ²¡æå¾é¾çç¹ã<br>
æµå®ç´æ¥åæååºå»å¿«ä¹ååï¼ç­å¾ç»¼åæµè¯ååã</p>
<p>4.ç»¼åæµè¯<br>
ç±äºðªçè®ºä¸æ¯çº¯è½¯ä»¶éå(å¶å®ðªä¹ä¼ç»æ¿å­åçæ¿å­ï¼è¿å°±æ¯EEerçç´ å»)ï¼ç»¼åæµè¯çç¡¬ä»¶å¤§ä¸å½ç¶å°±äº¤ç»æçä¸¤ä½å¤§ç¹éåäºï¼ðªåªéè¦å¨æè¾¹åä¸ªæ¥åç®ä¸ªåæ°å°±å¥½ã<br>
å¨åå¤ç¡¬ä»¶æµè¯å¨ä»¶ï¼æä»¬æµè¯äºåç§555çµè·¯ï¼äºæç®¡æ£æ³¢ï¼å¾®åç§¯åå¨ï¼å æ³å¨ï¼å¸¦éæ»¤æ³¢å¨ççµè·¯å¾ã<br>
ç»¼åæµè¯é£å¤©ï¼ä¸è¿ç°åºï¼åç°é¢ç®ç«ç¶æ¯æ¨¡æè®¡ç®å¨ï¼ç¨æ¥è§£ä¸ä¸ªå¾®åæ¹ç¨ã<br>
ä¸è¿ç¨å åæï¼å°±ä¼åç°å¶æ¬è´¨æ¯ææ°æ¡¥æ­£å¼¦åçå¨ï¼ä¸è§æ³¢åçå¨ï¼ä¸¤ä¸ªç§¯åå¨ï¼ä¸ä¸ªå¾®åå¨ï¼ä¸ä¸ªå æ³å¨çç»åã<br>
è¿ä¸éé¢çæ¯ä¸é¡¹åç¬æåºæ¥é½å¾ç®åï¼ä½æ¯å¨å½æ¶æ¶é´æ¯è¾ç´§ä¿çæåµä¸ï¼æä»¬è½ç¶æçµè·¯å¨é¨çº§èåºæ¥äºï¼ä½æ¯å¨é¶ç¶æçæ¶åï¼å¹¶æ²¡æåè®¡ç®çé£æ ·ï¼äº§çä¸ä¸ª33Hzçèªæ¿æ³¢å½¢ã<br>
ä¹è®¸æ¯ä¸­é´çæé¡¹RCå¸¸æ°æ²¡æéç½®æ­£ç¡®ï¼ä¹è®¸æ¯æä¸æ®µæªä¿®æ­£ç¸å·®ï¼ä¹è®¸æ¯æä¸æ®µçåç½®éè¦æ¶é¤ï¼æ»æ¯é¶ç¶æçæ¶åå°±æ¯å¦¹æåºæ³¢å½¢ã<br>
è¯´å°æ¨¡æè®¡ç®çµè·¯ï¼å¶å®è¿æ¯ä¸ªå±å¼æ¥è®²æéå¸¸å¤å¯ä»¥è®²çè¯é¢ï¼æ³è¿ä¸æ­¥ç ç©¶çåå­¦å¯ä»¥ç§»æ­¥CNPPå¤§ä½¬çæ¨¡æè®¡ç® <a href="https://hackaday.io/project/191142-analog-lorenz-attractor-computer/details" target="_blank" rel="noopener nofollow">https://hackaday.io/project/191142-analog-lorenz-attractor-computer/details</a><br>
æä»¬ä¹å°±åæ­¢äºåé¢çè¾å¥æ¿å±ãéå¾æ¯èµæ¶é´ç»æï¼æ¯ç«è¿åªæ¯ä¸ä¸ªè¾¾æ æµè¯ï¼å°±ä¸åè¿å»åè¿ä¸æ­¥çåé©äºã</p>
<p>æä¸è¯´ä¸ä¸­åå­¦æ ¡æä¾çé¥­èè¿å¯ä»¥ï¼èåæåè±ç§çèï¼æ¨è³çèï¼æ°´ç®è¾ï¼è¿æé¸å¥¶åæ°´æï¼æTMåååã</p>
<p>4.å½èµè¯æµ</p>
<p>ç­ðªç©åæ¥æ´æ°</p>
<h2 id="é¢ç®åæ">é¢ç®åæ</h2>
<p><img alt="é¢ç®æè¿°1" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B01.webp" class="lazyload"></p>
<p><img alt="é¢ç®æè¿°2" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B02.webp" class="lazyload"></p>
<p><strong>é¢ç®åæï¼*çæ°éä¸ºéè¦ç¨åº¦ï¼</strong></p>
<ul>
<li>é¢ç®çè¾å¥ä¿¡å·æ100mvï¼å±äºä¸ä¸ªæ¯è¾å¤§çä¿¡å·ï¼ä»ä¿¡å·æºç´åºï¼éè¿SMAçº¿è¾å¥ï¼<strong>ä¿¡åªæ¯éå¸¸é«ï¼ä¸éè¦èèä¿¡å·å¨æ çº¿ä¼ è¾è¿ç¨ä¸­è¢«å¹²æ°åå¤å¾æåºç­é®é¢</strong></li>
<li>è½½æ³¢é¢ç2MHzï¼è¯´å®è¯ï¼æ¯ä¸ä¸ªæ¯è¾å¾®å¦çé¢çï¼åå¥½è¶è¿äºå¸é¢ä¸åçæºåç½®ADCçæå¤§éæ ·é¢çï¼ä½æ¯å¯¹äºFPGAå¤æç50Må·¦å³çé«éADCæ¥è¯´(AD9225:æ²¡éæ­£æ¯å¨ä¸)ï¼åçä¸å»æ¯ä¸ä¸ªå¾åéçé¢çãæä»¥ä½¿ç¨åçæºçç»ä¸è¬ä¼<strong>éæ©ä¸æ··é¢</strong>ï¼èä½¿ç¨FPGAçç»å¦æéæ©ç´éï¼ç»è¿æä»¬å½æ¶çåæï¼å¯è½ä¼éå°ä¸äºé®é¢é®é¢ï¼æ¯å¦FFTåé¢çåè¾¨çä¸å¤ï¼FIRèµæºæ¶èå¤§å¸¦æ¥çç»¼åæ¢ï¼æ°å­ä¸æ··é¢ç¸ä½ä¸å¯¹é½é æçå¤±çåè¯¯å·®(æ´å«æVivadoçFFTçIPæ ¸è¦æ³ç¨å¥½å¶å®å¹¶ä¸å®¹æï¼å®ç¹FFTå¾å®¹æäº§çå¾å¤§çèå¥è¯¯å·®)ãè¯å®æFPGAä½¬è½æ³å°è§é¿æèè§£å³çåæ³ãä½æ¯åéä¸æä»¬å½æ¶ç¥è¯çè§£çç¨åº¦ï¼æä»¬è¿æ¯éæ©äºåçæºå¹³å°ãæä»¥ä»è¿ä¹å¯ä»¥çåºçµèµçåºé¢å¹¶ä¸ä¸å³å°è¦æ±å¥½çå¨ä»¶ï¼èæ´å¤çæ¯<strong>å å°å¶å®éæ©æ¹æ¡</strong></li>
<li><strong>è¦è®¡ç®è°å¹åº¦Maï¼è¿å°±è¦æ±è·å¾è°å¶åä¿¡å·çé¢è°±ï¼ä¹å°±æ¯è¦åFFT</strong>ãè¿å°±è¦æ±ADCçéæ ·é¢çè½å¤é«äºä¸­å¿é¢ç¹+æå¤§é¢åä¹åçä¸¤åãå½ç¶ï¼å®éä¸ä¸ºäºé¢è°±çå¯è¯»æ§åé¢çç²¾ç¡®åº¦çèéï¼ä¸è¬éæ©4è³6åçéæ ·é¢ç*</li>
<li>è¦è®¡ç®è°é¢åº¦Mfåæå¤§é¢åÎfï¼åä¸ï¼è¿æ¶åå°ä¸äºç®æ³ç<strong>å¤å¼é®é¢</strong>ï¼å¨åé¢è¯¦ç»è®¨è®º</li>
<li>è¦è¿è¡æ¨¡æè°å¶çè§£è°ï¼å¯ä»¥åéè¿æ··é¢**æä¿¡å·æ··å°10.7Mé«ä¸­é¢ï¼ä½¿ç¨ADL5511 ï¼NE564ç­è¯çè¿è¡è§£è°</li>
<li>è¦è¯å«ASKï¼FSKï¼PSKç­è°å¶æ¹å¼ï¼è¿å°±è¦æ±<strong>æå®ä»¬çé¢è°±å·®å¼æååºæ¥å¹¶åå¥½ç¹å¾åºåï¼ä»¥åå¯¹äºæäºéå¸¸ç¸ä¼¼æåµä¸å¼å¥å¤éå¤æ­ç»´åº¦æ¥è¿è¡åºå</strong> ã</li>
<li>è¦éè¿é¢è°±è¿è¡FSKçhåæ°çè®¡ç®ï¼å¶å®å¨åçæºéåæ¯å¾é¾çï¼ä½æ¯æä»¬å¯ä»¥<strong>éè¿FMåFSKçç¸ä¼¼æ§ï¼æ¥è¿è¡ä¸äºåå·§çæä½</strong>ï¼è¿ä¸ªåé¢è¯¦ç»è®¨è®º**</li>
<li>è¦è¯å«å¾è°å¶æ³¢çé¢çï¼å¶å®å°±æ¯<strong>è®¡ç®è°å¶åæ³¢å½¢çFFTç¸é»é¢ç¹ä¹é´çé´é</strong>ï¼è¿ä¸ç¹æ¯ç±è°å¶çæ§è´¨æå¯¼è´çï¼ææè°å¶æ¹å¼é½è½éè¿è¿ç§æ¹å¼å¤æ­å¾è°å¶æ³¢çé¢ç*</li>
<li>è¦è¿è¡æ°å­è°å¶æ³¢å½¢çè§£è°ï¼<strong>è¦ç»åä¸åè°å¶æ¹å¼çç¹ç¹ï¼æ··åä½¿ç¨æ¨¡ææ¨¡ååæ°å­åå¤å³çæ¹å¼æ¥è¿è¡è§£è°</strong>ï¼æ¯å¦ASKä½¿ç¨çæ¯åéè¿æ¨¡æAD8310æ£æ³¢åéè¿ç´æµéé«ä½æ¥å¤æ­0ï¼1æ³¢å½¢ãFSKä½¿ç¨äºæ°å­FIRæé¢çè½¬åä¸ºåç»çååï¼è¿è¡0ï¼1çå¤å³ãèPSKä½¿ç¨äºåæ°å­åä¸æ··é¢åFIRçæ¹å¼ï¼æç¸ä½çè·³åå¯¼è´çç¸ä¹åçåç»ååéè¿æ»¤æ³¢å¨æ£åº</li>
<li>è¦ç»¼åä¸è¿°çè¯å«åè®¡ç®ï¼é<strong>è¿æ¨¡æå¼å³å°è§£è°ç»æéè¿ä¸ä¸ªééæ¾ç¤º</strong>å¨ç¤ºæ³¢å¨ä¸ï¼å¹¶éè¿AGCç­ææ®µï¼ä¿è¯çµåå¤§äº1Vpp*</li>
</ul>
<h2 id="ç³»ç»æ¶æ">ç³»ç»æ¶æ</h2>
<p><img alt="ç³»ç»æ¶æ" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84.webp" class="lazyload"></p>
<p>æ¬ç³»ç»ç¡¬ä»¶æ¡å¾å¦å¾æç¤ºï¼ä¹ä¸çéå¸¸å¤æ(å®éä¸ä¹ç¡®å®å¾å¤æï¼æåæ°äºä¸ä¸ï¼ä½åä¸ä¸å±æ26åæ¿å­)ãå«æ¥ï¼è®©æä»¬æ¢æ¢æ¥ï¼ä¸æ­¥æ­¥åæï¼<br>
ç±äºè¾å¥ä¿¡å·çå³°å³°å¼æ¯100mVï¼æ¢ç®ä¸ä¸ä¹å°±æ¯-16dbmï¼æä»¥é¦åç»è¿24dBå¢ççä½åªæ¾ERA-3SMè¿è¡æ¾å¤§ã<br>
æ­¤æ¶çä¿¡å·å¹åº¦æ8dbmï¼ä¹å°±æ¯å³°å³°å¼1.5Vppï¼æ­£å¥½éååé¢çåç§å¨ä»¶ççµåèå´ã<br>
ç¶åå°ä¿¡å·éè¿ååå¨ï¼åæ¶æ··é¢å°50kHzä¸­é¢å10.7MHzä¸­é¢ãè¿æ¯ä¸ºäºä¸è·¯ç¨æ¥åæï¼ä¸è·¯ç¨æ¥æ¨¡æè§£è°ã<br>
50kHz çä¸­é¢ä¿¡å·ï¼ç»è¿æ»¤æ³¢ãæ¾å¤§åçµå¹³æ¬ç§»åï¼ä¸è·¯ç»è¿ADS8688åä¸ºæ°å­ä¿¡å·éå¥åçæºãå¦ä¸è·¯ç»è¿æ£æ³¢å¨ AD8310 åæ»¤æ³¢å¨ UAF42 åæ£åº ASK çç´æµï¼å¹¶éç»åçæºè¿ä¸æ­¥å®æ ASK ä¿¡å·çå®æ¶æ½å¤ã<br>
10.7MHz çä¸­é¢ä¿¡å·ç»è¿é¶ç·æ»¤æ³¢å¨ãæ¾å¤§å¨åå°é¢å¼å³åï¼åå«è¿è¡åºäº ADL5511 ç AM åç»æ£æ³¢è§£è°ååºäº NE564 çFM è§£è°.<br>
æåéè¿ MCU æ§å¶çæ¨¡æå¼å³TMUX1109ï¼å°è§£è°ç»æéç»ç¤ºæ³¢å¨æ¾ç¤ºãå¨åçæºåï¼éè¿å¯¹ 50kHz çä¸­é¢ä¿¡å·çé¢è°±åæï¼å¾å°è°å¶ä¿¡å·ç±»ååè°å¶åæ°ï¼<br>
ä»¥åFSKåPSKçè§£è°ç»æçè¾åºï¼å¹¶æ§å¶å¶ä»æ¨¡åå®ææåç»æçæ±æ»è¾åºï¼ä»¥åæ§å¶æ¶²æ¶å±æ¾ç¤ºè¯å«ç»æååæ°ã</p>
<h2 id="ä¸äºåå¤å·¥ä½åå°å¯å·§">ä¸äºåå¤å·¥ä½åå°å¯å·§</h2>
<h3 id="çµåådbmçæ¢ç®">çµåådbmçæ¢ç®</h3>
<p>å¨å°é¢çµè·¯ä¸­ï¼ä¸ºäºè¡¨ç¤ºæ¯è¾å°ççµåï¼ä¸è¬éç¨å¯¹æ°å½¢å¼ï¼å¶ä¸­dbmæ¯ä¸ä¸ªå¸¸ç¨çåä½ï¼å®æ¯å¨æä¸é»æå¹éç³»ç»ä¸ï¼åçç¸å¯¹äº1mWçæ¯å¼ï¼èç±äºå·²ç»å°é¢çµè·¯é»æä¸è¬æ¯50æ¬§å§ï¼æä»¥ç¸å½äºä¹ç¥éäºçµåã<br>
ä¸è¿ç±äºåççè®¡ç®è¿æ¶åå°æ³¢å½¢çææå¼å¥çï¼æ¹æ³¢1ï¼æ­£å¼¦0.707ï¼ä¸è§æ³¢0.57ï¼å®éä¸­ä¸è¬ä¸ä¼èªå·±å»ç®ï¼é½æ¯ä½¿ç¨è¿ç§å¨çº¿è®¡ç®å¨ã<br>
å¯ä»¥è®°å¿ä¸ä¸ä¸äºå¸¸è§çå¼</p>
<table>
<thead>
<tr>
<th>æ­£å¼¦æ³¢</th>
<th>50æ¬§å§é»æä¸</th>
</tr>
</thead>
<tbody>
<tr>
<td>-116dbm</td>
<td>1uVpp</td>
</tr>
<tr>
<td>-56dbm</td>
<td>1mVpp</td>
</tr>
<tr>
<td>-36dbm</td>
<td>10mVpp</td>
</tr>
<tr>
<td>-16dbm</td>
<td>100mVpp</td>
</tr>
<tr>
<td>0dbm</td>
<td>632mVpp</td>
</tr>
<tr>
<td>4dbm</td>
<td>1Vpp</td>
</tr>
<tr>
<td>14dbm</td>
<td>3.3Vpp</td>
</tr>
</tbody>
</table>
<p>å®ç¨å°å·¥å· çµåådbmçæ¢ç®<br>
<a href="https://www.analog.com/cn/design-center/interactive-design-tools/dbconvert.html" target="_blank" rel="noopener nofollow">https://www.analog.com/cn/design-center/interactive-design-tools/dbconvert.html</a></p>
<p><img alt="ADIçµåæ¢ç®å·¥å·" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/ADI%E7%94%B5%E5%8E%8B%E6%8D%A2%E7%AE%97%E5%B7%A5%E5%85%B7.webp" class="lazyload"><br>
æ³¨æè¿éçVPeakæ¯å³°å¼ï¼æ¢ç®æå³°å³°å¼çè¯è¦ä¹ä»¥2</p>
<h3 id="adcçä¸äºåå¤å·¥ä½">ADCçä¸äºåå¤å·¥ä½</h3>
<p><img alt="ADS8688æå" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/ADS8688%E6%89%8B%E5%86%8C.webp" class="lazyload"></p>
<h4 id="adcéå">ADCéå</h4>
<p>æä»¬æ¬æ¬¡ä½¿ç¨çæ¯ADS8688Aä½ä¸ºç³»ç»çADCï¼å®æ¯ä¸ä¸ª16bitï¼500KSPSéæ ·ççSARåADCã<br>
å®çç¹ç¹æåææ§è¾å¥ï¼å¯éç½®å¨æèå´ï¼åé¨åºåï¼å«ééMUXéæ ·ï¼è¯¯å·®åæ¼ç§»é½å¾ä½ï¼å¯¹äºæ¬é¢æ¥è¯´è¯å®æ¯å¤ç¨çã<br>
æä»¬ç¨å®ä¸»è¦è¿æ¯çä¸äºå®æ¯æåææ§è¾å¥åå¯åå¨æèå´è¿ä¸ç¹ï¼è¿æ ·å°±ä¸ç¨èªå·±ååçº§çæ¬ç§»åæ¾å¤§ã<br>
èä¸èªå¸¦è¿åä¿æ¤ï¼æ¯è¾èé ã<br>
PS.æä»¬çSTM32H743å¹³å°çåç½®ADCï¼å¨ææ¬¡æµè¯çæ¶åï¼å¯¹åé¢å¤§å¹å¼ä¿¡å·éæ ·åFFTåï¼å¶äºæ¬¡è°æ³¢å¼ä¼å¤§çè¶åºå¸¸çï¼çè®ºä¸æ¥è¯´æ¯ä¸ä¼æè¿ä¹å¤§çã<br>
æçåç½®SARç§¯åçµè·¯è¢«è¿åæ©æ¦äºð<br>
æä»¥æ¢ç¨äºè¿ä¸ªå¤ç½®çADCï¼ä»¥åå¯ä»¥å¼ä¸ç¯æç« è®²ä¸ä¸ADCçåç§åæ°ï¼ä»¥åè¿ç§å¤±çæ¯æä¹æ¥çï¼æ­¤æ¶å°±è¦è¯·åºå¦ä¸ä½å°ä¿¡å·é¢åçexpertï¼FloydFishð<br>
å¯ä»¥ç§»æ­¥<a href="https://www.emoe.xyz/opamp-noise-analyze/" target="_blank" rel="noopener nofollow">https://www.emoe.xyz/opamp-noise-analyze/</a> ï¼ä»¥åç¸å³çå°ä¿¡å·æµéã</p>
<p>é©±å¨ä»£ç <br>
è¿ä¸ªçé©±å¨æå·²ç»æåå¥½äºï¼ä¸è½½ä¸æ¥æ¹ä¸ä¸ç®¡èç´æ¥ç¨å°±å¯ä»¥äº <a href="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/ADS8688_Driver.zip" target="_blank" rel="noopener nofollow">https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/ADS8688_Driver.zip</a><br>
<strong>ADCçé©±å¨è¦æ³¨æçä¸¤ç¹æ¯ï¼ä¸æ¯è¿ä¸ªADCçæ°æ®Latchåååºæ¯æ ¹æ®SPIçéçæ¥ç</strong><br>
æä»¥ä¸ºäºæ§å¶éæ ·éçï¼éè¦èªå·±æ§å¶å¶ä¸­çIOæä½åçDelayå½æ°ï¼ç»è¿æµè¯ï¼å¨ARMCC6ç¼è¯å¨ï¼O2æ°´å¹³çä¼åä¸ï¼ä½¿ç¨volatileåæ°ï¼ä¸é¢è¿ç§delayæ¹æ³ä¾ç¶å¯ä»¥è¾¾å°å»¶æ¶ææã</p>
<p><img alt="Delayçå®ç°" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/Delay%E7%9A%84%E5%AE%9E%E7%8E%B0.webp" class="lazyload"></p>
<p><img alt="ADS8688çéæ ·å½æ°" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/ADS8688%E7%9A%84%E9%87%87%E6%A0%B7%E5%87%BD%E6%95%B0.webp" class="lazyload"><br>
äºæ¯éæ ·çæ¶åéè¦å³é­ä¸­æ­ååºï¼å ä¸ºæä»¬ä¸å¸æéæ ·çæ¶åå®æ¶å¨ä¸­æ­ä»ä¹çæéæ ·æä½ææ°äºã</p>
<p>è¿éçéæ ·çæ ¹æ®å®æµå¤§æ¦å¨250Kå·¦å³ï¼è¾¾ä¸å°å®æ¹çæ ç§°ç500Kãåºè¯¥æ¯å·²ç»è¾¾å°äºè½¯ä»¶SPIçIOéåº¦ä¸éäºï¼250kSPS*16bit = 4Mbitçéåº¦äºã</p>
<p>å¦æè¦æ´å¿«ä¸ç¹ï¼å¯ä»¥ä½¿ç¨ç¡¬ä»¶SPI+DMAçæ¹å¼ï¼ä½æ¯æ¯èµå½åï¼å°±ä¸æè¾è±æ´»äºï¼è½ç¨å°±å¥½ã</p>
<p>å¦å¤ä¸ç¹æ¯STM32çH7ç³»åçè½¯SPIçä¼æçä¸ä¸ªæ¯çï¼å¨CubeMXä¸­éè¦æè¿äºä¸ªç®¡è(CLK,MISO,MOSI,CS)çæå¤§é¢çè®¾ç½®æLowï¼å¦åå¦æè®¾ç½®ä¸ºHighä¹ç±»çã</p>
<p>è¾å¤§çé©±å¨çµæµä¼é æä¿¡å·çè¿å²åæ¯éï¼é æè¯»åºçæ°æ®ææ¶æ¯å¯¹çï¼ææ¶è¯»åºçä¼æ¯å¨1æèå¨0ã</p>
<p>è¿ä¸ç¹ææ¯å¨è°è¯RDA5820çæ¶ååç°çï¼ä¹åç¨STM32U5é©±å¨RDA5820æ¯æ­£å¸¸çï¼åæ ·çä»£ç å¨H7ä¸å°±ä¼ææ¶æ­£ç¡®ææ¶ä¸è½è¯»åºãåæ¥å¨æèä¿¡å·å®æ´æ§é¾è·¯çæ¶åæäºæ°çæ³æ³ã</p>
<p>æä¸ªäººççæ³æ¯ï¼å¯è½ç±äºæ¯H7çé©±å¨çµæµè½åæ¯è¾å¼ºï¼IOç¿»è½¬çä¸åæ²¿ç¸æ¯F1ï¼F7è¿äºè¦é¡å³­å¾å¤ï¼èæ°å­ä¿¡å·é¾è·¯æ¯éè¿ä¸æ®µæ¯è¾é¿çXH2.54çº¿æ¥å°äºå¤é¨çæ¨¡åä¸ï¼<br>
æ ¹æ®ä¼ è¾çº¿æ¨¡åçæ¨è®ºï¼å½ä¼ è¾çº¿é¿åº¦å1/6ä¸åæ²¿æ³¢é¿å¯ä»¥ç¸æ¯ææ¶ï¼å°±æå¯è½é æä¿¡å·å®æ´æ§é®é¢ã<br>
æä»¥è¿æ¶IOé©±åºæ¥çæ°å­æ³¢å½¢ä¼æè¿å²åæ¯éç­ä¿¡å·å®æ´æ§é®é¢ä¹æ¯å¯ä»¥çè§£çã</p>
<p>éªè¯ADCééæ¶åï¼ä¸è¬ä¼ä¸²å£æå°æ³¢å½¢ï¼åä½¿ç¨SerialPlotæ¥çï¼æ¯ä¸æ¯åçè®ºç¬¦åï¼æ¯å¦ä¸å¾å°±æ¯ASKæ³¢å½¢çéæ ·ç»æã</p>
<p><img alt="ASKçééå°çæ³¢å½¢" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/ASK%E7%9A%84%E9%87%87%E9%9B%86%E5%88%B0%E7%9A%84%E6%B3%A2%E5%BD%A2.webp" class="lazyload"></p>
<h3 id="fftçåå¤å·¥ä½">FFTçåå¤å·¥ä½</h3>
<ul>
<li>ä½¿ç¨Cmsis DSPåºï¼å¨Keilçåç®¡çéé¢å¾éå³å¯ï¼ææ°çæ¬æçªå½æ°çéè¦ä»å®ç½ä¸ä¸è½½ï¼æä¹æè§æç¹ä¼¼æ¾ç¸è¯ï¼æå»å¹´æåå¥½åä¹åè¿ï¼</li>
</ul>
<p><img alt="Keilæ·»å Pack" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/Keil%E6%B7%BB%E5%8A%A0Pack.webp" class="lazyload"></p>
<ul>
<li>
<p>å¨Keilçè®¾ç½®éé¢ï¼å å¥ARM_MATH_CM7, ARM_MATH_LOOPUNROLLè¿ä¸¤æ¡å®å®ä¹ï¼åé¢æ¯Cortexçæ¬ï¼éè¦æ¯MCUçåæ ¸çæ¬ï¼å¯ä»¥æ¯CM1ï¼CM4ï¼CM7,åé¢çæ¯æ§å¶æ°å­¦èå¥çï¼ä¸è¬æ¥è¯´ä¸ç¨å¨ã<br>
<img alt="keilçç¼è¯è®¾ç½®" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/keil%E7%9A%84%E8%AE%BE%E7%BD%AE.webp" class="lazyload"></p>
</li>
<li>
<p>ç¶åå¨includeçå°æ¹å å¥ #include "arm_math.h"   å  #include "arm_const_structs.h"ï¼ç¶åå¼è¾ä¸ä¸ªfftçå¨å±æ°ç»ï¼å°±å¯ä»¥æå¿«çè°ç¨å¦ã</p>
</li>
<li>
<p><strong>FFTçè°ç¨</strong>**</p>
</li>
</ul>
<pre><code class="language-C">/* ADCéæ ·å¹¶åFFT ç»ææ¾å¨å¨å±æ°ç»fft_outputbufä¸­ */
/* åFFT ç»ææ¾å¨å¨å±æ°ç»fft_outputbufä¸­ ä¸æ¬¡4096ä¸ªç¹ */
void FFT(unsigned short *ADC_Buffer, unsigned int SampleRate, unsigned int len, int debug, int serialplot)
{
    for(int i=0;i&lt;Sampling_CNT;i++)
    Global_ADC_Value[i] = ADC_Buffer[i]*3.3/4096;   // å°éæ ·ç»æè½¬åå°0-3.3V
    
    for(int i=0;i &lt; FFT_LENGTH;i++)   
    {
    fft_inputbuf[i*2] = Global_ADC_Value[i];  // ææåè¦æ±çå®é¨èé¨äº¤æ¿çæ¹æ³å¡«åæ°ç»
    fft_inputbuf[2*i +1] = 0;
    }

    arm_cfft_f32(&amp;arm_cfft_sR_f32_len4096,fft_inputbuf,0,1); // æ§è¡FFTåæ¢ï¼arm_cfft_sR_f32_len4096ä¸ºå®ï¼å®ä¹æè½¬å å­
    arm_cmplx_mag_f32(fft_inputbuf,fft_outputbuf,FFT_LENGTH);    // æè¿ç®ç»æå¤æ°æ±æ¨¡å¾å¹å¼

    /* Debugæå°åº */
    
    if(debug == 1)
     for(int i=0;i &lt; FFT_LENGTH/2;i++)       // æ¯å¦æå°FFTæ¯ä¸ªé¢ç¹çå¹å¼ä¿¡æ¯
       printf("%d  %.3lf KHz Mag %.3f\n", i,SampleRate*1.0/len*i, fft_outputbuf[i] );
    
    if(serialplot == 1)
     for(int i=0;i &lt; FFT_LENGTH;i++)       //  æ¯å¦æå°fftç»æå°å°SerialPlot
        printf("%.3f\n", fft_outputbuf[i]);

}
</code></pre>
<p>åå®FFTåï¼æä»¬ä¸è¬ä¼éè¿SerialPlotè½¯ä»¶æ¥æ¥çFFTçç»æååçè®ºä¼°è®¡æ¯å¦ç¬¦åã<br>
ä¸å¾æ¯1KHzè½½æ³¢ï¼3KHzé¢åçFMé¢è°±çå®æµå¾<br>
<img alt="FMçé¢è°±" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/FM%E7%9A%84%E9%A2%91%E8%B0%B1.webp" class="lazyload"></p>
<h3 id="ä»£ç ç»ç»çæè·¯">ä»£ç ç»ç»çæè·¯</h3>
<p>è¿é¢æ¯ä¸ä¸ªç»å¸çæµé-åæ-æ¾ç¤ºçé¢ç®ï¼æä»¥éç¨çæè·¯å°±æ¯åééï¼å¤æ­è°å¶ç±»ååï¼è¿ä¸æ­¥å»å¯¹åºçé¨åè¿è¡è¿ä¸æ­¥çåæåæ¾ç¤ºã<br>
ç±äºFFTåæåç»çåæ°å¼ä¸æ­¢ä¸ä¸ªï¼æä»¥ä½¿ç¨äºå½æ°ä¼ å°åçåæ³ã<br>
<img alt="å½æ°ä¼ ååæ°" loading="lazy" data-src="https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/%E5%87%BD%E6%95%B0%E4%BC%A0%E5%8F%82%E5%8F%82%E6%95%B0.webp" class="lazyload"><br>
èä¸ç±äºKeilæ²¡ææ¯è¾æ¹ä¾¿çä»£ç è¡¥å¨åå¿«æ·æç¤ºåè½ï¼å¦æææçç®æ³é½å¨mainä¸­å®ç°ï¼ä¼å¯¼è´ä»£ç å®ç°é£ä¸æ®µå°ä¸é¢çmainå½æ°çéè°ç¨æ®µï¼æä¸æ®µéå¸¸é¿çè·ç¦»ï¼æä»¥æä¸ªäººçå»ºè®®æ¯æä¸äºæ´åºç¡çç®æ³ä»£ç å¦å¤å°è£å°ä¸ä¸ªAlgorithmæä»¶éã<br>
<img alt="Algorithm.cæªå¾" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3763221/202602/3763221-20260218235902267-1012071203.png" class="lazyload"></p>
<h3 id="ä¸èé¢åé¸½äºå®éä¸å ä¸ºç¥ç§èµå¶çåå æä»¬æ²¡æå»å°æ¯èµç°åºä½æ¯è¿æ¯å½èµäºç­å¥å°±ä¸ç®ä¸äº">ä¸èé¢åï¼é¸½äºï¼å®éä¸å ä¸ºç¥ç§èµå¶çåå ï¼æä»¬æ²¡æå»å°æ¯èµç°åºï¼ä½æ¯è¿æ¯å½èµäºç­å¥ï¼å°±ä¸ç®ä¸äºï¼</h3>
<ul>
<li>æ¨¡æè°å¶åæ°å­è°å¶ä¸¤ä¸ªå¤§ç±»çåºå(ä¸­å¿è½½é¢ä¸ç¸é»é¢ç¹ä¹é´çè·ç¦»)</li>
<li>ä¸ç§æ¨¡æè°å¶çåºå(CW, AM, FM)</li>
<li>ä¸ç§æ°å­è°å¶çåºå(ASK, FSK, PSK)</li>
<li>åç§è°å¶è½½æ³¢é¢ççè®¡ç®(é¢è°±æè¿ç¸é»è°±çº¿çè·ç¦»)</li>
<li>AMè°å¶çMaçè®¡ç®(å¯»å³°ç®æ³)</li>
<li>FMè°å¶çMfçè®¡ç®(åºäºæ¨¡å¼å¹éçææ³)</li>
<li>FSKè°å¶çhåæ°çè®¡ç®(åºäºåFMçç¸ä¼¼å¸¦æ¥çæ¨¡å¼å¤ç¨)</li>
<li>ASKçæ½å¤(åºäºç´æµéçå®æ¶æ½å¤)</li>
<li>FSKçæ½å¤(ä¸¤è·¯FIRåçæ½å¤)</li>
<li>PSKçæ½å¤(æ»¡è¶³ç¹å®é¢ççç¸ä½çªåç¹æ½å¤æ³)</li>
</ul>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-19 14:06">2026-02-19 14:06</span>&nbsp;
<a href="https://www.cnblogs.com/badboy02">Badboy02</a>&nbsp;
éè¯»(<span id="post_view_count">104</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19623709);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19623709', targetLink: 'https://www.cnblogs.com/badboy02/p/19623709', title: '2023å¹´çµèµå½èµç»å' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä»é¶å¼å§å­¦Flinkï¼å®æ¶æ°ä»ä¸ç»´è¡¨æ¶æJoinå®æ ]]></title>
    <link>https://www.cnblogs.com/daimajiangxin/p/19624638</link>
    <guid>41253f1acb12bd5ee6d2d264e45b0e31</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/daimajiangxin/p/19624638" title="åå¸äº 2026-02-19 12:58">
    <span role="heading" aria-level="2">ä»é¶å¼å§å­¦Flinkï¼å®æ¶æ°ä»ä¸ç»´è¡¨æ¶æJoinå®æ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3365149/202602/3365149-20260219125729266-340455730.png" alt="ä»é¶å¼å§å­¦Flinkï¼å®æ¶æ°ä»ä¸ç»´è¡¨æ¶æJoinå®æ" class="desc_img">
        ä»¥çµåè®¢åå®æ¶æ°ä»ä¸ºä¾ï¼æ¼ç¤ºå¦ä½å¨ Flink SQL ä¸­éè¿ç»´è¡¨æ¶æ Join å°äºå®æµä¸ç»´åº¦æ°æ®å³èï¼æå»ºå¸¦ç¨æ·å±æ§çæç»å®½è¡¨ï¼å¹¶ç»å Kafka ä¸ MySQL ç¯å¢å®æä¸å¥å¯è½å°çå®æ¶æ°ä»å¥é¨å®è·µã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>å¨åä¸ç¯ <a href="https://mp.weixin.qq.com/s/kLxoo6mHi49HvrrmaOdTsA" target="_blank" rel="noopener nofollow">ãFlink åæµ JOIN å®æè¯¦è§£ã</a> ä¸­ï¼æä»¬ç¨ãè®¢åæµ + æ¯ä»æµãææäºäºå®åæµä¹é´çæ¶é´å³èã</p>
<p>ä½å¨çå®çå®æ¶æ°ä»é¡¹ç®éï¼åæäºå®æµè¿ä¸å¤ï¼ä¸å¡åå­¦æ´å³å¿çæ¯ï¼</p>
<ul>
<li>ä¸åç¨æ·æ¯æ°å®¢è¿æ¯èå®¢</li>
<li>ç¨æ·å½åçç­çº§ãåå¸ãæ¸ é</li>
<li>ååæå±åç±»ãç±»ç®å±çº§</li>
</ul>
<p>è¿äºä¿¡æ¯éå¸¸å­æ¾å¨ <strong>ç»´åº¦è¡¨</strong>ï¼ç»´è¡¨ï¼ä¸­ï¼ä¾å¦ MySQL ç <code>dim_user</code>ã<code>dim_product</code> ç­ãæä»¬å¸æå¨å®æ¶è®¡ç®æ¶ï¼è½æãäºå®æµãåãç»´è¡¨ãå¨æ¶é´ç»´åº¦ä¸æ­£ç¡®å°å³èèµ·æ¥ï¼æå»ºä¸å¼ å¸¦æå®æ´ä¸å¡å±æ§ç<strong>æç»å®½è¡¨</strong>ã</p>
<p>è¿å°±æ¯ <strong>ç»´è¡¨æ¶æ Joinï¼Temporal Table Joinï¼</strong> è¦è§£å³çé®é¢ã</p>
<p>æ¬ææä»¬å°±ä»¥ãè®¢åäºå®æµ + ç¨æ·ç»´è¡¨ãä¸ºä¾ï¼å®æä¸ä¸ªä» Kafka å° MySQL çç®æå®æ¶æ°ä» Demoï¼å¹¶éç¹çè§£ Flink SQL ä¸­ç»´è¡¨æ¶æ Join çè¯­æ³åæ³¨æäºé¡¹ã</p>
<h2 id="ä¸ä¸å¡åºæ¯ä¸æ°ä»ç®æ ">ä¸ãä¸å¡åºæ¯ä¸æ°ä»ç®æ </h2>
<p>è®¾æ³ä¸ä¸ªç®åççµåä¸å¡åºæ¯ï¼</p>
<ul>
<li>Kafka ä¸­æå®æ¶åå¥ç <code>orders</code> è®¢åäºå®æµ</li>
<li>MySQL ä¸­ç»´æ¤ä¸å¼  <code>dim_user</code> ç¨æ·ç»´è¡¨ï¼åå«ç¨æ·ç­çº§ãæå±åå¸ãæ³¨åæ¸ éç­ä¿¡æ¯</li>
</ul>
<p>æä»¬æ³è¦å¨ Flink ä¸­æå»ºä¸å¼ ã<strong>è®¢åæç»å®½è¡¨</strong>ãï¼å­æ®µå¤§è´åæ¬ï¼</p>
<ul>
<li>è®¢åä¿¡æ¯ï¼è®¢åå·ãä¸åç¨æ·ãä¸åéé¢ãä¸åæ¶é´</li>
<li>ç¨æ·å±æ§ï¼ç¨æ·æµç§°ãç­çº§ãåå¸ãæ³¨åæ¸ é</li>
</ul>
<p>å¹¶ä¸è¦æ±ï¼</p>
<ul>
<li>å½æä»¬åç 10 åéåçææ¡è®¢åæ¶ï¼çå°çæ¯ <strong>å½æ¶</strong> ç¨æ·çç­çº§ååå¸ï¼èä¸æ¯è¢«åç»­åæ´âå²æâçææ°å¼</li>
</ul>
<p>è¿æ­£æ¯ <strong>æ¶æ Join</strong> åãå®æ¶æ°ä»ãçå³é®ï¼<strong>æäºä»¶åçæ¶å»åæ¾ç»´åº¦è§å¾</strong>ã</p>
<h2 id="äºç¯å¢åæä¸ä¾èµåå¤">äºãç¯å¢åæä¸ä¾èµåå¤</h2>
<h3 id="1-åºç¡ç»ä»¶">1. åºç¡ç»ä»¶</h3>
<p>æ¬ç¯é»è®¤ä½ å·²ç»å®æåå ç¯ä¸­çç¯å¢åå¤ï¼</p>
<ul>
<li>Flink 1.20.1ï¼WSL2 Ubuntu ä¸é¨ç½²ï¼</li>
<li>Kafka éç¾¤å·²å¯å¨ï¼ä¸è½æ­£å¸¸åå¥ / è¯»å Topic</li>
<li>Flink SQL Client å¯ä»¥æ­£å¸¸è¿æ¥éç¾¤</li>
</ul>
<p>å¨æ­¤åºç¡ä¸ï¼æä»¬è¿éè¦ï¼</p>
<ul>
<li>ä¸å¥å¯è®¿é®ç MySQLï¼æ¬å°æè¿ç¨åå¯ï¼</li>
<li>Flink ç JDBC Connector JAR å</li>
</ul>
<h3 id="2-å®è£-flink-jdbc-connector">2. å®è£ Flink JDBC Connector</h3>
<p>å Kafka ä¸æ ·ï¼JDBC è¿æ¥å¨ä¹éè¦ä»¥ JAR åå½¢å¼æ¾å° Flink ç <code>lib</code> ç®å½ä¸­ã</p>
<p>ä»¥ Flink 1.20.x å¯¹åºç <code>flink-connector-jdbc</code> ä¸ºä¾ï¼</p>
<ol>
<li>
<p>ç¡®è®¤ Flink å®è£ç®å½ï¼åè®¾ä¸º <code>/opt/flink</code>ï¼ï¼</p>
<pre><code class="language-bash">export FLINK_HOME=/opt/flink
</code></pre>
</li>
<li>
<p>ä¸è½½ JDBC Connector JAR å° Flink ç <code>lib</code> ç®å½ï¼</p>
<pre><code class="language-bash">cd $FLINK_HOME/lib
wget https://repo1.maven.org/maven2/org/apache/flink/flink-connector-jdbc/3.3.0-1.20/flink-connector-jdbc-3.3.0-1.20.jar
</code></pre>
</li>
<li>
<p>å¦æä½ ä½¿ç¨çæ¯ç¬ç«éç¾¤æè¿ç¨éç¾¤ï¼éè¦éå¯ Flink éç¾¤ï¼è®©æ° JAR å¨ JobManager/TaskManager ä¸çæï¼</p>
<pre><code class="language-bash">cd $FLINK_HOME
bin/stop-cluster.sh
bin/start-cluster.sh
</code></pre>
</li>
<li>
<p>éå¯ Flink SQL Clientï¼ä½¿ç¨æ° Connectorï¼</p>
<pre><code class="language-bash">cd $FLINK_HOME
bin/sql-client.sh
</code></pre>
</li>
</ol>
<p>å¦æä½ å¨ Windows + WSL2 ä¸é¨ç½²ï¼åªéå¨ WSL2 åæ§è¡ä¸è¿°å½ä»¤å³å¯ï¼æèæå¨ä¸è½½ JAR åæ·è´å° <code>lib</code> ç®å½ï¼æ­¥éª¤å®å¨ä¸è´ã</p>
<h2 id="ä¸åå¤-mysql-ç¨æ·ç»´åº¦è¡¨-dim_user">ä¸ãåå¤ MySQL ç¨æ·ç»´åº¦è¡¨ dim_user</h2>
<p>é¦åå¨ MySQL ä¸­åå¤ä¸å¼ ç®åçç¨æ·ç»´åº¦è¡¨ï¼ç¨æ¥å­ç¨æ·çåºç¡å±æ§ã</p>
<p>å¨ MySQL ä¸­æ§è¡ï¼</p>
<pre><code class="language-sql">CREATE DATABASE IF NOT EXISTS realtime_dwh;
USE realtime_dwh;

CREATE TABLE dim_user (
  user_id      VARCHAR(32)  PRIMARY KEY,
  user_name    VARCHAR(64),
  user_level   VARCHAR(16),
  city         VARCHAR(64),
  register_time DATETIME
);

INSERT INTO dim_user (user_id, user_name, user_level, city, register_time) VALUES
('u_1', 'å¼ ä¸', 'VIP1', 'åäº¬', '2025-12-01 10:00:00'),
('u_2', 'æå', 'VIP2', 'ä¸æµ·', '2025-12-05 11:00:00'),
('u_3', 'çäº', 'VIP1', 'å¹¿å·', '2025-12-10 12:00:00');
</code></pre>
<p>ä¸ºäºæ¼ç¤ºãæ¶æãææï¼ä½ å¯ä»¥å¨åç»­å®éªä¸­æå¨æ´æ°æä¸ªç¨æ·çç­çº§æåå¸ï¼ä¾å¦ï¼</p>
<pre><code class="language-sql">UPDATE dim_user
SET user_level = 'VIP3'
WHERE user_id = 'u_2';
</code></pre>
<p>è¿æ ·æä»¬å¨ Flink éåæ¶æ Join æ¶ï¼å°±è½è§å¯âåæ´ååâçåºå«ã</p>
<h2 id="åå¨-flink-ä¸­æ³¨åäºå®æµä¸ç»´è¡¨">åãå¨ Flink ä¸­æ³¨åäºå®æµä¸ç»´è¡¨</h2>
<p>æ¥ä¸æ¥åå° Flink SQL Clientï¼æ Kafka ä¸­çè®¢åäºå®æµå MySQL ä¸­çç»´è¡¨é½æ³¨åæ Flink è¡¨ã</p>
<h3 id="1-kafka-è®¢åäºå®è¡¨-orders">1. Kafka è®¢åäºå®è¡¨ orders</h3>
<p>åä¸ä¸ç¯åæµ JOIN ç±»ä¼¼ï¼æä»¬åè®¾ Kafka ä¸­æä¸ä¸ª <code>orders</code> Topicï¼åå¥è®¢åäºå®æ°æ®ã</p>
<p>å¨ Flink SQL Client ä¸­æ§è¡ï¼</p>
<pre><code class="language-sql">CREATE TABLE orders (
  order_id     STRING,
  user_id      STRING,
  order_amount DECIMAL(10, 2),
  order_time   TIMESTAMP_LTZ(3),
  WATERMARK FOR order_time AS order_time - INTERVAL '5' SECOND,
  proc_time AS PROCTIME()
) WITH (
  'connector' = 'kafka',
  'topic' = 'orders',
  'properties.bootstrap.servers' = '127.0.0.1:9092',
  'properties.group.id' = 'flink-orders-dim',
  'scan.startup.mode' = 'earliest-offset',
  'format' = 'json',
  'json.timestamp-format.standard' = 'ISO-8601'
);
</code></pre>
<p>ä½ å¯ä»¥æ²¿ç¨ä¸ä¸ç¯ä¸­ Kafka é æ°çæ¹å¼ï¼ç¨ <code>kafka-console-producer.sh</code> åé JSON è®¢åæ°æ®ï¼åªéè¦ä¿è¯å­æ®µåä¸è´ã</p>
<h3 id="2-mysql-ç¨æ·ç»´è¡¨-dim_userjdbc-lookup-è¡¨">2. MySQL ç¨æ·ç»´è¡¨ dim_userï¼JDBC Lookup è¡¨ï¼</h3>
<p>ç¶åæåæå¨ MySQL ä¸­å»ºå¥½ç <code>dim_user</code> æ³¨åä¸º Flink ç JDBC è¡¨ï¼</p>
<pre><code class="language-sql">CREATE TABLE dim_user (
  user_id       STRING,
  user_name     STRING,
  user_level    STRING,
  city          STRING,
  register_time TIMESTAMP(3),
  PRIMARY KEY (user_id) NOT ENFORCED
) WITH (
  'connector' = 'jdbc',
  'url' = 'jdbc:mysql://127.0.0.1:3306/realtime_dwh',
  'table-name' = 'dim_user',
  'driver' = 'com.mysql.cj.jdbc.Driver',
  'username' = 'root',
  'password' = '1qaz@WSX'
);
</code></pre>
<p>æ³¨æå ç¹ï¼</p>
<ul>
<li><code>PRIMARY KEY (user_id) NOT ENFORCED</code> åè¯ Flink è¿æ¯ä¸å¼ ä»¥ <code>user_id</code> ä¸ºä¸»é®çè¡¨ï¼æ¯åæ¶æ Join çåæ</li>
<li>è¿éä½¿ç¨çæ¯å¸åç JDBC Lookup æ¨¡å¼ï¼Flink ä¼å¨ Join æ¶æéå» MySQL æ¥ç»´åº¦ä¿¡æ¯</li>
</ul>
<p>å¨çäº§ç¯å¢ä¸­ï¼ä½ å¯ä»¥æ MySQL ä½ä¸ºç»´åº¦å­å¨ï¼æèéè¿ CDC æç»´è¡¨åæ´åæ­¥å° Kafkaï¼æé æ changelog æµï¼è¿äºé½å¯ä»¥å Temporal Join ç»åä½¿ç¨ã</p>
<h2 id="äºç»´è¡¨æ¶æ-joinæè®¢åæä¸ç¨æ·ç»´åº¦">äºãç»´è¡¨æ¶æ Joinï¼æè®¢åæä¸ç¨æ·ç»´åº¦</h2>
<p>æäºè®¢åäºå®è¡¨ <code>orders</code> åç»´åº¦è¡¨ <code>dim_user</code>ï¼å°±å¯ä»¥éè¿æ¶æ Join æ¥æå»ºè®¢åæç»å®½è¡¨ã</p>
<h3 id="1-åºç¡æ¶æ-join-è¯­æ³">1. åºç¡æ¶æ Join è¯­æ³</h3>
<p>Flink SQL ä¸­ç Temporal Table Join å¯¹äº JDBC è¿ç±» <strong>å¤é¨ç»´è¡¨</strong>ï¼éå¸¸éç¨ãå¤çæ¶é´ï¼Processing Timeï¼ãè¯­ä¹æ¥å Lookup Joinï¼å¸ååæ³å¦ä¸ï¼</p>
<pre><code class="language-sql">SELECT
  o.order_id,
  o.user_id,
  d.user_name,
  d.user_level,
  d.city,
  o.order_amount,
  o.order_time
FROM orders AS o
LEFT JOIN dim_user FOR SYSTEM_TIME AS OF o.proc_time AS d
ON o.user_id = d.user_id;
</code></pre>
<p><img alt="FlinkJoin" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3365149/202602/3365149-20260219125508288-1508486548.png" class="lazyload"><br>
è¿éæå ä¸ªå³é®ç¹ï¼</p>
<ul>
<li><code>proc_time AS PROCTIME()</code> æ¯å¨ <code>orders</code> ä¸å®ä¹çå¤çæ¶é´å­æ®µ</li>
<li><code>FOR SYSTEM_TIME AS OF o.proc_time</code> è¡¨ç¤ºâä»¥ Flink å¤çè¿æ¡è®¢åè®°å½çå½åæ¶é´ï¼å»æ¥ç»´è¡¨çä¸ä¸ªå¿«ç§âï¼è¿æ¯ JDBC Lookup æ¯æçå¸åç¨æ³</li>
<li>Join æ¡ä»¶ä¾ç¶æ¯ <code>user_id</code> ç­å¼å³è</li>
<li>ä½¿ç¨ <code>LEFT JOIN</code> å¯ä»¥ä¿çæ¾ä¸å°ç»´åº¦çè®¢åï¼å¹¶ç¨ç©ºå¼æ¥è¡¨ç¤ºâç»´åº¦ç¼ºå¤±â</li>
</ul>
<p>å¨ SQL Client ä¸­æ§è¡è¿æ®µæ¥è¯¢ï¼ä¼çå°å®æ¶æµå¼å·æ°çç»æï¼æ¯ä¸è¡è®¢åé½å¸¦ä¸äºå¯¹åºçç¨æ·å±æ§ã</p>
<h3 id="2-éªè¯æ¶æææä¿®æ¹ç»´è¡¨åè§å¯-join">2. éªè¯æ¶æææï¼ä¿®æ¹ç»´è¡¨åè§å¯ Join</h3>
<p>ä¸ºäºéªè¯è¿æ¯âæ¶æ Joinâèä¸æ¯âå§ç»æ¥ææ°ç»´åº¦âï¼å¯ä»¥æä¸é¢æ­¥éª¤æä½ï¼</p>
<ol>
<li>
<p>åå¾ Kafka ç <code>orders</code> Topic åå¥å æ¡è®¢åæ°æ®ï¼ä¾å¦ç¨æ· <code>u_2</code> ä¸åçè®°å½</p>
</li>
<li>
<p>è§å¯ Flink SQL ä¸­ Join åçç»æï¼æ­¤æ¶ <code>u_2</code> çç­çº§æ¯ <code>VIP2</code></p>
</li>
<li>
<p>åå° MySQLï¼æ§è¡ï¼</p>
<pre><code class="language-sql">UPDATE dim_user
SET user_level = 'VIP3'
WHERE user_id = 'u_2';
</code></pre>
</li>
<li>
<p>ååå¥ä¸æ¹æ°çè®¢åï¼ä»ç¶æ¯ç¨æ· <code>u_2</code></p>
</li>
</ol>
<pre><code class="language-bash">bin/kafka-console-producer.sh --bootstrap-server 127.0.0.1:9092 --topic orders
</code></pre>
<p>å¨å½ä»¤è¡ä¸­è¾å¥ä¸æ¡ JSON æ°æ®ï¼æåè½¦åéä¸æ¡ï¼ï¼</p>
<pre><code class="language-json">{"order_id":"o_3","user_id":"u_2","order_amount":200.00,"order_time":"2026-02-19T14:42:00Z"}
</code></pre>
<p><img alt="FlinkJoin" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3365149/202602/3365149-20260219125508267-1292715641.png" class="lazyload"><br>
è¿æ¶ä½ ä¼çå°ï¼</p>
<ul>
<li>åæ´åçè®¢åï¼ç»´åº¦å­æ®µä»ç¶æ¾ç¤º <code>VIP2</code></li>
<li>åæ´åçè®¢åï¼ç»´åº¦å­æ®µåæäº <code>VIP3</code></li>
</ul>
<p>è¿å°±è¯´æ Flink çæ¶æ Join ç¡®å®æ¯âæè®¢ååçæ¶å»å»åæ¾ç»´åº¦è§å¾âçï¼èä¸æ¯ç®åæ¥å½åææ°å¼ã</p>
<h2 id="å­æç»æåå-kafka-æ-mysqlå½¢æå®æ¶æ°ä»æç»å±">å­ãæç»æåå Kafka æ MySQLï¼å½¢æå®æ¶æ°ä»æç»å±</h2>
<p>å¨çå®é¡¹ç®ä¸­ï¼æä»¬ä¸ä¼åªå¨ SQL Client é <code>SELECT</code> ä¸ä¸å°±ç»æï¼èæ¯è¦æ Join åçè®¢åæç»å®½è¡¨ï¼ååå°ä¸æ¸¸å­å¨ï¼å½¢æå®æ¶æ°ä»çä¸ä¸ªå±çº§ã</p>
<p>ä¾å¦ï¼å¯ä»¥æç»æåå Kafkaï¼ä½ä¸º DWD å±çè®¢åå®½è¡¨ï¼</p>
<pre><code class="language-sql">CREATE TABLE dwd_order_user_wide (
  order_id     STRING,
  user_id      STRING,
  user_name    STRING,
  user_level   STRING,
  city         STRING,
  order_amount DECIMAL(10, 2),
  order_time   TIMESTAMP_LTZ(3),
  WATERMARK FOR order_time AS order_time - INTERVAL '5' SECOND
) WITH (
  'connector' = 'kafka',
  'topic' = 'dwd_order_user_wide',
  'properties.bootstrap.servers' = '127.0.0.1:9092',
  'properties.group.id' = 'flink-dwd-order-wide',
  'scan.startup.mode' = 'earliest-offset',
  'format' = 'json',
  'json.timestamp-format.standard' = 'ISO-8601'
);

INSERT INTO dwd_order_user_wide
SELECT
  o.order_id,
  o.user_id,
  d.user_name,
  d.user_level,
  d.city,
  o.order_amount,
  o.order_time
FROM orders AS o
LEFT JOIN dim_user FOR SYSTEM_TIME AS OF o.proc_time AS d
ON o.user_id = d.user_id;
</code></pre>
<p>è¿æ ·ï¼ä¸æ¸¸çå®æ¶åºç¨æ BI æ¥è¯¢å°±å¯ä»¥ç´æ¥è®¢é <code>dwd_order_user_wide</code> è¿ä¸ª Topicï¼æ¿å°å·²ç»æå¥½ç¨æ·æ ç­¾çè®¢åæç»æ°æ®ã</p>
<p>ä½ ä¹å¯ä»¥æç»æåæ­¥å° MySQLãClickHouse ç­åæåæ°æ®åºä¸­ï¼æå»ºå®æ¶æç»è¡¨ï¼ä¸ºæ¥è¡¨åå¯è§åæä¾æ°æ®ã</p>
<h2 id="ä¸å°ç»ä¸ä¸ä¸æ­¥å»ºè®®">ä¸ãå°ç»ä¸ä¸ä¸æ­¥å»ºè®®</h2>
<p>éè¿è¿ç¯æç« ï¼æä»¬å®æäºè¿æ ·ä¸ä»¶äºï¼</p>
<ul>
<li>å¨ Kafka ä¸­ç»´æ¤è®¢åäºå®æµ <code>orders</code></li>
<li>å¨ MySQL ä¸­ç»´æ¤ç¨æ·ç»´åº¦è¡¨ <code>dim_user</code></li>
<li>ä½¿ç¨ Flink SQL ç JDBC Connector æ MySQL æ³¨åä¸ºç»´è¡¨</li>
<li>å©ç¨ <code>FOR SYSTEM_TIME AS OF</code> è¯­æ³åç»´è¡¨æ¶æ Join</li>
<li>å° Join ç»æåå Kafkaï¼å½¢æå®æ¶æ°ä»ä¸­çä¸å¼ è®¢åæç»å®½è¡¨</li>
</ul>
<p>è¿èåæå ä¸ªéå¸¸éè¦çå®æ¶æ°ä»è®¾è®¡çå¿µï¼</p>
<ul>
<li>äºå®æµæ¯ä¸æ­è¿½å çäºä»¶åºåï¼ç»´è¡¨æ¯ç¸å¯¹ç¼æ¢åæ´çä¸å¡è§å¾</li>
<li>æ¶æ Join è®©ä½ è½å¤âæäºä»¶åççæ¶é´ç¹âï¼åçå½æ¶çç»´åº¦å¿«ç§</li>
<li>å®æ¶æ°ä»ç DWD å±ï¼å¾å¾å°±æ¯ãäºå®è¡¨ + å¤ä¸ªç»´è¡¨æ¶æ Joinãåå½¢æçæç»å®½è¡¨</li>
</ul>
<p>å¨åç»­çæç« ä¸­ï¼æä»¬å¯ä»¥ç»§ç»­æ²¿çè¿ä¸ªæ¹åæ·±å¥ï¼</p>
<ul>
<li>å¨ä¸ä¸ªä»»å¡éåæ¶å³èå¤å¼ ç»´è¡¨ï¼æå»ºæ´å®½çæç»è¡¨</li>
<li>å¼å¥ CDCï¼æç»´è¡¨åæ´å®æ¶åæ­¥å° Kafkaï¼åå¨ Flink ä¸­æå»º changelog ç»´è¡¨</li>
<li>æå®æ¶æ°ä»çæç»å±ãæ±æ»å±ï¼DWSï¼ãææ ä¸»é¢å±ï¼ADSï¼ä¸²èµ·æ¥ï¼åä¸ä¸ªç«¯å°ç«¯çå®æ¶æ°ä»å°é¡¹ç®</li>
</ul>
<p>å¦æä½ å·²ç»è·éäºæ¬æç Demoï¼ä¸å¦¨è¯çèªå·±è®¾è®¡ä¸å¼ ååç»´è¡¨ <code>dim_product</code>ï¼åç»è®¢åæä¸åååç±»ç»´åº¦ï¼ä½éªä¸ä¸âäºå® + å¤ç»´è¡¨æ¶æ Joinâå¨ Flink SQL éçå®æ´å³éã</p>
<hr>
<p><a href="http://blog.daimajiangxin.com.cn" target="_blank" rel="noopener nofollow">åææ¥èª:http://blog.daimajiangxin.com.cn</a></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.04027777777777778" data-date-updated="2026-02-19 13:56">2026-02-19 12:58</span>&nbsp;
<a href="https://www.cnblogs.com/daimajiangxin">ä»£ç å å¿</a>&nbsp;
éè¯»(<span id="post_view_count">81</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19624638);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19624638', targetLink: 'https://www.cnblogs.com/daimajiangxin/p/19624638', title: 'ä»é¶å¼å§å­¦Flinkï¼å®æ¶æ°ä»ä¸ç»´è¡¨æ¶æJoinå®æ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ èµäº AI Agent âæ éç»­èªâï¼è¯­ä¹ä¿æ¤åä¸ä¸æåç¼©ææ¯è§£æ ]]></title>
    <link>https://www.cnblogs.com/noear/p/19624614</link>
    <guid>6da46199617d5b2ddb442ec7cc90316e</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/noear/p/19624614" title="åå¸äº 2026-02-19 12:21">
    <span role="heading" aria-level="2">èµäº AI Agent âæ éç»­èªâï¼è¯­ä¹ä¿æ¤åä¸ä¸æåç¼©ææ¯è§£æ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        Solon AIæ¡æ¶çSummarizationInterceptoråæ°æ§å°è§£å³äºAIé¿å¯¹è¯ä¸­ç"ä¸ä¸æçªå£çç¸"é®é¢ãè¿å¥æºè½è®°å¿ç®¡çç³»ç»éè¿åæ­¥ç­ç¥ï¼éå®æ ¸å¿ä»»å¡æä»¤ãç¡®ä¿è¡å¨-ç»æå®æ´æ§ãä¿æè¯­ä¹è¿è´¯æ§ãæ·»å ç³»ç»æç¤ºï¼å®ç°äºä¼éçè®°å¿åç¼©ãå¶éç¨æä»¶å¼è®¾è®¡ï¼æ¯æå±çº§åç¼©ãå³é®ä¿¡æ¯æåååéåºå½æ¡£ç­ç­ç¥ç»åï¼è®©AIæ¢è½è®°ä½æ ¸å¿ç®æ ï¼åè½å¤çè¶é¿ä»»å¡ãè¿ç§"æé»è¾å°éå¿"æºå¶ï¼ææé¿åäºä¼ ç»ç²æ´è£åªå¯¼è´çé»è¾æ··ä¹±ï¼ä¸ºAIå¤çå¤æä»»å¡æä¾äº"æ éç»­èª"
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æ³è±¡ä¸ä¸ï¼ä½ æ­£å¨ææ¥ä¸ä¸ªè¶çº§èªæçAIå©æï¼æä»¬ç§°ä¹ä¸ºAgentï¼å¸®ä½ å®æä¸é¡¹å¤æä»»å¡ï¼æ¯å¦ç­åä¸æ¬¡è·¨å½æè¡ãä¸å¼å§ï¼å®è®°å¾ä½ çææè¦æ±ï¼æ³å»åªäºå½å®¶ãé¢ç®å¤å°ãåæ¬¢ä»ä¹ç±»åçéåºãä½éçä»»å¡çè¿è¡ï¼å®éè¦æ¥è¯¢èªç­ãæ¯è¾éåºãæ¥çå¤©æ°â¦â¦æ¯ä¸æ¬¡æ¥è¯¢åæèé½ä¼å¢å å®çâè®°å¿è´æâã</p>
<p>å¦æå®âè®°æ§âä¸å¥½ï¼èå°ä¸åå°±ä¼å¿äºæå¼å§çè¦æ±ï¼æèé·å¥æ··ä¹±çé»è¾ä¸­ï¼è¿å°±æ¯å¼åèå¸¸è¯´çâä¸ä¸æçªå£çç¸âé®é¢ã</p>
<p>Solon AI æ¡æ¶éæä¸ä¸ªç§å¯æ­¦å¨ââ<code>SummarizationInterceptor</code>ï¼æºè½è®°å¿åç¼©å¨ï¼ï¼å®è½è®©AIå©æåäººä¸æ ·ï¼<strong>æ¢ä¸ä¼å¿è®°åå¿ï¼åè½è½»è£ä¸éµï¼å®ç°çæ­£çâæ éç»­èªâ</strong>ãå®ä¸æ¯ç®åç²æ´å°âæ­çâï¼èæ¯ä¸å¥ä¼éçâè®°å¿ç®¡çå¤§å¸âã</p>
<h3 id="1ä¸ºä»ä¹ä¸è½ç®åç²æ´å°æ­ç">1ãä¸ºä»ä¹ä¸è½ç®åç²æ´å°âæ­çâï¼</h3>
<p>å¤çé¿å¯¹è¯ï¼æç´æ¥çæ³æ³æ¯ï¼å¯¹è¯å¤ªé¿ï¼é£å°±å æåé¢ä¸åå§ï¼ä½è¿ç§âæ´åè£åªâå¯¹AIæ¥è¯´ï¼ä¼å¸¦æ¥ä¸¤ä¸ªè´å½ä¼¤ï¼</p>
<ul>
<li><strong>å¿æ¬ï¼å¤±å»åå¿ï¼ï¼</strong> AI Agent æå¼å¤´çç³»ç»è®¾å®åä½ äº¤ç»å®çç¬¬ä¸ä¸ªä»»å¡ï¼å¦æè¢«å æï¼å®å°±ä¼åæ å¤´èèä¸æ ·ï¼å®å¨ä¸ç¥éèªå·±è¦å¹²åäºã</li>
<li><strong>æ­çï¼é»è¾æ­å±ï¼ï¼</strong> AI Agent çå·¥ä½æ¨¡å¼éå¸¸æ¯âæè -&gt; è¡å¨ -&gt; è§å¯ç»æâï¼ReActï¼ãå¦æä½ æ°å¥½æå®çæä¸ªâè¡å¨âåå¯¹åºçâè§å¯ç»æâç»ææ£äºï¼å®çå°ç»æå´ä¸ç¥éä¸ºä»ä¹ä¼æè¿ä¸ªç»æï¼é»è¾ç¬é´æ··ä¹±ï¼çè³é·å¥æ­»å¾ªç¯ï¼æ æ³èªæã</li>
</ul>
<p>æä»¥ï¼å¿è®°ä¹æ¯ä¸é¨èºæ¯ï¼éè¦æç­ç¥å°å¿è®°ã</p>
<h3 id="2æºè½è®°å¿åç¼©å¨æ¯å¦ä½å·¥ä½ç">2ãæºè½è®°å¿åç¼©å¨æ¯å¦ä½å·¥ä½çï¼</h3>
<p><code>SummarizationInterceptor</code> å°±åä¸ä¸ªèªæçå¾ä¹¦ç®¡çåï¼å®ä¸ä¼éæä¸¢å¼ä¹¦ç±ï¼èæ¯æç§ä¸å¥ç²¾å¯çæµç¨æ¥æ´çä¹¦æ¶ãå®çå·¥ä½åä¸ºåæ­¥ï¼</p>
<h4 id="ç¬¬ä¸æ­¥éæ­»åå¿éç¹éå®">ç¬¬ä¸æ­¥ï¼éæ­»âåå¿âï¼éç¹éå®ï¼</h4>
<p>æ è®ºåé¢çå¯¹è¯æå¤é¿ï¼ç®¡çåé½ä¼ç¬¬ä¸æ¶é´æ¾å°ä¸¤æ ·ä¸è¥¿å¹¶æ°¸ä¹ä¿çï¼</p>
<ul>
<li><strong>ä»»å¡æä»¤ï¼</strong> ä½ ç¬¬ä¸æ¬¡ç»AIå¸ç½®çä»»å¡ï¼UserMessageï¼ï¼è¿æ¯å®çâåå¿âã</li>
<li><strong>åºæ¬å®åï¼</strong> AIçç³»ç»è®¾å®ï¼SystemMessageï¼ï¼è¿æ¯å®çâè¡ä¸ºååâã</li>
</ul>
<p>è¿ä¸¤æ ·ä¸è¥¿è¢«ç¢ç¢éå®ï¼ç¡®ä¿AIæ°¸ä¸è¿·å¤±æ¹åã</p>
<h4 id="ç¬¬äºæ­¥ç¦æ­¢æ­çåå­å¯¹é½">ç¬¬äºæ­¥ï¼ç¦æ­¢âæ­çâï¼åå­å¯¹é½ï¼</h4>
<p>è¿æ¯æ´ä¸ªæºå¶ææ ¸å¿çâé»ç§æâãå½ç®¡çåå³å®è¦æ¸çä¸é¨åæ§åå®¹æ¶ï¼ä»ä¸ä¼ç´æ¥å¨æãä»ä¼ä»ç»æ£æ¥ï¼ç¡®ä¿æ°¸è¿ä¸ä¼æ <strong>âè¡å¨â</strong> å <strong>âç»æâ</strong> è¿å¯¹âè¿ä½å©´å¿âç»ææ£ã</p>
<ul>
<li><strong>æºè½æ£æ¥ï¼</strong> å¦æåç°åå¤æ¸ççèµ·ç¹æ­£å¥½è½å¨ä¸ä¸ªâè§å¯ç»æâï¼<code>ToolMessage</code>ï¼æèä¸ä¸ªâè¡å¨æä»¤âï¼<code>AssistantMessage</code>ï¼ä¸ï¼ç®¡çåä¼ç«å»ææ¸çèµ·ç¹ååæªï¼ç´å°ç¡®ä¿æ¯ä¸å¯¹âè¡å¨-ç»æâé½å®æ´å°ä¿çä¸æ¥ã</li>
</ul>
<h4 id="ç¬¬ä¸æ­¥è®©è®°å¿æ´è¿è´¯è¯­ä¹è¡¥é½">ç¬¬ä¸æ­¥ï¼è®©è®°å¿æ´è¿è´¯ï¼è¯­ä¹è¡¥é½ï¼</h4>
<p>ä¸ºäºè®©ä½ åAIçå¯¹è¯è¯»èµ·æ¥æ´éé¡ºï¼ç®¡çåè¿ä¼åå¤åä¸æ­¥âäººæå³âçæ£æ¥ãå¦ææ¸çåçç¬¬ä¸æ¡è®°å½æ¯ä¸ä¸ªâè¡å¨ç»æâï¼ç®¡çåä¼ççå®åé¢æ¯ä¸æ¯ç´§è·çä¸æ¡AIçâæèè¿ç¨âï¼Thoughtï¼ãå¦ææ¯ï¼ä»ä¼æè¿æ¡âæèâä¹ä¸å¹¶çä¸ãè¿æ ·ä¸æ¥ï¼AIçå°çåå²æ°¸è¿æ¯ä»ä¸ä¸ªæèçæ®µå¼å§çï¼çè§£èµ·æ¥æ´èªç¶ã</p>
<h4 id="ç¬¬åæ­¥è´´ä¸ªä¾¿å©è´´æéæ­è£æç¥">ç¬¬åæ­¥ï¼è´´ä¸ªâä¾¿å©è´´âæéï¼æ­è£æç¥ï¼</h4>
<p>å¨æ°¸ä¹ä¿å­çâåå¿âååç¼©åçâæè¿è®°å¿âä¹é´ï¼ç®¡çåä¼è´´ä¸ä¸å¼ éç®ç <strong>âå°è´´å£«â</strong>ï¼</p>
<pre><code>--- [ç³»ç»æç¤ºï¼ä¸­é´é¨ååå²å¯¹è¯å·²ä¼ååç¼©ï¼è¯·æ ¹æ®å½åè®¡ååå©ä½åå²ç»§ç»­ä»»å¡...] ---
</code></pre>
<p>è¿å¼ âå°è´´å£«âéå¸¸éè¦ï¼å®ç¨AIè½çè§£çè¯­è¨åè¯å®ï¼âå«æå¿ï¼ä¸­é´æäºç»èæå¸®ä½ ç²¾ç®äºï¼ä½ ä¸æ³¨ç¼åçä»»å¡åæ ¸å¿ç®æ å°±å¥½ãâè¿è½ææé²æ­¢AIå ä¸ºè®°å¿æ­å±èäº§çå°æåå¹»è§ã</p>
<h3 id="3å¦ä½å®ç°æ éç»­èª">3ãå¦ä½å®ç°âæ éç»­èªâï¼</h3>
<p>éè¿è¿å¥âè®°å¿ç®¡çæ¯âï¼SummarizationInterceptor æAIçåå­åæäºä¸ä¸ªå¨æçâæ°éä»£è°¢ç³»ç»âï¼</p>
<ul>
<li><strong>åå­æå®ï¼</strong> æ è®ºAIè¿è¡äº10æ­¥è¿æ¯1000æ­¥ï¼å®ä¸æ¬¡âæèâæéè¦å¤ççä¿¡æ¯éï¼Tokenæ°ï¼å§ç»ç»´æå¨ä¸ä¸ªå®å¨çèå´åã</li>
<li><strong>é»è¾æ¸æ°ï¼</strong> å ä¸ºâåå­å¯¹é½âæºå¶ï¼AIçå°çæ¯ä¸æ®µè®°å¿é½æ¯å®æ´çâæè-è¡å¨-åé¦âé­ç¯ï¼é»è¾é¾æ¡éå¸¸ç¨³åºã</li>
<li><strong>ç®æ æ°¸å­ï¼</strong> âç³»ç»è®¾å®âåâç¨æ·ä»»å¡âè¿ä¸¤å¤§æ ¸å¿ç®æ æ°¸è¿å¨çº¿ï¼AIæ°¸è¿ä¸ä¼å¿è®°âææ¯è°âåâæè¦å»åªâã</li>
</ul>
<h3 id="4æ´å¼ºå¤§çç»åæä»¶å¼çè®°å¿ç­ç¥">4ãæ´å¼ºå¤§çç»åï¼æä»¶å¼çè®°å¿ç­ç¥</h3>
<p>è¿ä¸ªâè®°å¿ç®¡çå¨âæå¦çå°æ¹å¨äºï¼å®éç¨äº <strong>ç­ç¥æ¨¡å¼</strong>ï¼å°±åææºå¯ä»¥å®è£ä¸åçAPPæ¥æ©å±åè½ä¸æ ·ï¼ä½ å¯ä»¥ç»å®æ¥å¥ä¸åçâè®°å¿å¤çæä»¶âãæ¡æ¶å·²ç»ä¸ºæä»¬åå¤äºå æ¬¾å¼ºå¤§çæä»¶ï¼</p>
<ul>
<li><strong>å±çº§åç¼©å¨ï¼</strong> å®ä¼åæ»éªçä¸æ ·ï¼ææ§çè®°å¿æè¦åæ°çå¯¹è¯åå²ä¸æ­èåãåç¼©ï¼çæä¸ä¸ªå§ç»æ´æ°çâå¨å±è¿åº¦æè¦âï¼è®©è®°å¿åæ´è±ä¸æ ·å±å±åè£¹ï¼æ°¸ä¸ä¸¢å¤±æ ¸å¿ã</li>
<li><strong>å³é®ä¿¡æ¯æåå¨ï¼</strong> å®åä¸ä¸ªä¿¡æ¯å®¡è®¡åï¼åªä»å¯¹è¯ä¸­æåææ ¸å¿çâå¹²è´§âï¼æ¯å¦ç¨æ·è¦æ±ãè·åå°çæ°æ®ãå·²ç»å¤±è´¥çå°è¯ç­ï¼è¿æ»¤æé£äºå°å¦çæèè¿ç¨ã</li>
<li><strong>åéåºè®°å¿å¸ï¼</strong> å®ä¼å°è¢«æ¸ççè¯¦ç»å¯¹è¯âå½æ¡£âå°ä¸ä¸ªå·¨å¤§çç¥è¯åºéï¼åéæ°æ®åºï¼ãå½AIéè¦åå¿æä¸ªç»èæ¶ï¼å¯ä»¥éè¿ä¸ä¸ªä¸é¨çâå¬ååå²âå·¥å·ï¼åç¨æç´¢å¼æä¸æ ·æå®æ¾åæ¥ã</li>
</ul>
<p>ä½ å¯ä»¥æè¿äºæä»¶ç»åèµ·æ¥ä½¿ç¨ï¼æ¯å¦åå½æ¡£ï¼åæçº¯ï¼æååç¼©ï¼æé ä¸ä¸ªæéåä½ AIå©æçè®°å¿ç®¡çæ¹æ¡ã</p>
<p>åºç¨ç¤ºä¾ï¼</p>
<pre><code class="language-java">import org.noear.solon.ai.agent.react.ReActAgent;
import org.noear.solon.ai.agent.react.intercept.SummarizationInterceptor;
import org.noear.solon.ai.agent.react.intercept.summarize.*;
import org.noear.solon.ai.agent.session.InMemoryAgentSession;
import org.noear.solon.ai.chat.ChatModel;

CompositeSummarizationStrategy compositeStrategy = new CompositeSummarizationStrategy();
compositeStrategy.addStrategy(new KeyInfoExtractionStrategy(chatModel));
compositeStrategy.addStrategy(new HierarchicalSummarizationStrategy(chatModel));
SummarizationInterceptor summarizationInterceptor = new SummarizationInterceptor(12, compositeStrategy);

ReActAgent agent = ReActAgent.of(chatModel)
        .defaultInterceptorAdd(summarizationInterceptor)
        .build();
</code></pre>
<h3 id="5æ»ç»">5ãæ»ç»</h3>
<p><code>SummarizationInterceptor</code> çè®¾è®¡å²å­¦æ¯ï¼<strong>æå°ä¸¥å°è£åªï¼æé»è¾å°éå¿</strong>ã</p>
<p>å®ä¸ä»ä»æ¯ä¸ä¸ªèçè®¡ç®èµæºçå·¥å·ï¼æ´æ¯AIè½å¤ä¿æé»è¾è¿è´¯ãå¤çè¶é¿å¤æä»»å¡çâæ¤èªèâãæäºå®ï¼å¼åèå¯ä»¥æ¾å¿å°è®©AIå©æå»å¤çé£äºéè¦å ä¸ªå°æ¶çè³å å¤©æè½å®æçãçæ­£å¤æåæºè½åçå·¥ä½ï¼èä¸ç¨æå¿å®ä¼ä¸­éâå¤±å¿âæâç²¾ç¥éä¹±âã</p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-19 12:22">2026-02-19 12:21</span>&nbsp;
<a href="https://www.cnblogs.com/noear">å¸¦åºçåæ¤</a>&nbsp;
éè¯»(<span id="post_view_count">77</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19624614);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19624614', targetLink: 'https://www.cnblogs.com/noear/p/19624614', title: 'èµäº AI Agent âæ éç»­èªâï¼è¯­ä¹ä¿æ¤åä¸ä¸æåç¼©ææ¯è§£æ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ [æè§£LangChainæ§è¡å¼æ]æä¹åç¶æçæå ]]></title>
    <link>https://www.cnblogs.com/jaydenai/p/19623976/read-state</link>
    <guid>6b8626fc8800928767c63ff7e2d3671c</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/jaydenai/p/19623976/read-state" title="åå¸äº 2026-02-19 07:58">
    <span role="heading" aria-level="2">[æè§£LangChainæ§è¡å¼æ]æä¹åç¶æçæå</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        åé¢ä»¥`åå¥`çè§åº¦ä»ç»äºBaseCheckpointSaverç`put/aput`å`put_writes/aput_writes`æ¹æ³,å®ä»¬åå«å®ç°äºåºäºCheckpointåPending Writeçæä¹åãå¯¹äºä¸ä¸ªå·²ç»å®æçSuperstepæ¥è¯´ï¼å¯¹åº Checkpointå°±ä»£è¡¨äºå®çç¶æï¼ä½æ¯å¯¹äºä¸ä¸ªå ä¸­æ­å°æªå®æçSuperstepï¼æä¸ªæ¶å»çç¶æç±ä¸ä¸SuperstepçCheckpointåå½åSuperstepçææPending Writeæ¥æè¿°ãå¦æççéè¦æ¢å¤å°ä¸­æ­æ¶çç¶æï¼éè¦å¨Checkpointåºåç¶æåºç¡ä¸æåºéæ¾ææçPending Writeï¼å®éä¸åªéè¦éæ¾ä»£è¡¨æåæ§è¡ä»»å¡çPending Writeï¼å°±å¯ä»¥äºã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>åé¢ä»¥<code>åå¥</code>çè§åº¦ä»ç»äºBaseCheckpointSaverç<code>put/aput</code>å<code>put_writes/aput_writes</code>æ¹æ³,å®ä»¬åå«å®ç°äºåºäºCheckpointåPending Writeçæä¹åãå¯¹äºä¸ä¸ªå·²ç»å®æçSuperstepæ¥è¯´ï¼å¯¹åº Checkpointå°±ä»£è¡¨äºå®çç¶æï¼ä½æ¯å¯¹äºä¸ä¸ªå ä¸­æ­å°æªå®æçSuperstepï¼æä¸ªæ¶å»çç¶æç±ä¸ä¸SuperstepçCheckpointåå½åSuperstepçææPending Writeæ¥æè¿°ãå¦æççéè¦æ¢å¤å°ä¸­æ­æ¶çç¶æï¼éè¦å¨Checkpointåºåç¶æåºç¡ä¸æåºéæ¾ææçPending Writeï¼å®éä¸åªéè¦éæ¾ä»£è¡¨æåæ§è¡ä»»å¡çPending Writeï¼å°±å¯ä»¥äºã</p>
<h2 id="1-è¯»åcheckpointåpinding-write">1. è¯»åCheckpointåPinding Write</h2>
<p>å¦ä¸è¿ä¸ª<code>CheckpointTuple</code>ç¨æ¥è¡¨ç¤ºCheckpointåPending Writeçç»åä½ãé¤äºè¿ä¸¤ä¸ªæ ¸å¿æåï¼å®è¿åæ¬å½åçæ§è¡éç½®ï¼configåparent_configï¼ååæ°æ®ãå·ä½çPending Writeç±Task IDãChannelåç§°ååå¥æ°ç»ç»æçä¸åç»PendingWriteè¡¨ç¤ºã</p>
<pre><code class="language-python">class CheckpointTuple(NamedTuple):
    config: RunnableConfig
    checkpoint: Checkpoint
    metadata: CheckpointMetadata
    parent_config: RunnableConfig | None = None
    pending_writes: list[PendingWrite] | None = None
PendingWrite = tuple[str, str, Any]
</code></pre>
<p>BaseCheckpointSaveræä¾äºç¨äºè¯»åCheckpointTupleç<code>get_tuple/aget_tuple</code>æ¹æ³ãä½ä¸ºåæ°çRunnableConfigå¯¹è±¡éè¦æä¾Thread IDï¼å¿éï¼åCheckpoint å½åç©ºé´ï¼å¯éï¼ãå¦ææ²¡ææä¾Checkpoint IDï¼æ¹æ³ä¼è¿åæç»çç¶æï¼å¦æå°æªå®æï¼å¾å°çCheckpointTupleåç»å¯è½åå«Pending Writeãå¦ææä¾äºCheckpoint ID, åªæå¨æ­¤IDå¯¹åºææ°çCheckpointä¸åä¸Superstepå°æªå®æï¼è¿åçCheckpointTupleåç»ææå¯è½åå«Pending Writeãå¯¹äºå®ç°å¨BaseCheckpointSaverä¸­çå¦ä¸ç»æ¹æ³<code>get/aget</code>ï¼ä¼å¨åé¨è°ç¨<code>get_tuple/aget_tuple</code>æ¹æ³ï¼å¹¶è¿åCheckpointTupleåç»å°è£çCheckpointå¯¹è±¡ã</p>
<pre><code class="language-python">class BaseCheckpointSaver(Generic[V]):    
    def get(self, config: RunnableConfig) -&gt; Checkpoint | None
    async def aget(self, config: RunnableConfig) -&gt; Checkpoint | None

    def get_tuple(self, config: RunnableConfig) -&gt; CheckpointTuple | None
    async def aget_tuple(self, config: RunnableConfig) -&gt; CheckpointTuple | None

    def list(
        self,
        config: RunnableConfig | None,
        *,
        filter: dict[str, Any] | None = None,
        before: RunnableConfig | None = None,
        limit: int | None = None,
    ) -&gt; Iterator[CheckpointTuple]:
    async def alist(
        self,
        config: RunnableConfig | None,
        *,
        filter: dict[str, Any] | None = None,
        before: RunnableConfig | None = None,
        limit: int | None = None,
    ) -&gt; AsyncIterator[CheckpointTuple]
</code></pre>
<p>å¯¹äºInMemorySaveræ¥è¯´ï¼å®çget_tuple/aget_tupleæ¹æ³ä¼ä»RunnableConfigéç½®ä¸­æåThread IDåCheckpointå½åç©ºé´ï¼å¦ææå®äºCheckpoint IDï¼å®ä»¬ä¼å©ç¨è¿ä¸ä¸ªå¼ä»storageåblobså­å¸ä¸­æåç¸åºæ°æ®ç»æè¿åçCheckpointTupleå¯¹è±¡ãå¦ææ²¡ææå®Checkpoint IDï¼å°±éæ©æè¿çé£ä¸ä¸ªCheckpointçIDã</p>
<p>BaseCheckpointSaverçalistæ¹æ³ä¼ååºå¹¶æ£ç´¢ä¸æå®æ¡ä»¶å¹éçææCheckpointTupleï¼è¿äºåç»ææäºä¸æ®µ âåå²â ãè¯¥æ¹æ³ä¸»è¦ç¨äºä¼è¯ç®¡çãå®¡è®¡åå²è½¨è¿¹ä»¥åç¶æåæº¯ï¼å®å·æå¦ä¸çåæ°ï¼</p>
<ul>
<li>configï¼å¦æRunnableConfigå¦ææä¾äºThread IDï¼è¯¥æ¹æ³å°ä»è¿åè¯¥ç¹å®çº¿ç¨ä¸çCheckpointãå¦æä¸æä¾ï¼å¨æäºå®ç°ä¸­ä¼ååºææçº¿ç¨çææ°Checkpointï¼åå³äºå·ä½çå®ç°é»è¾ï¼ã</li>
<li>filterï¼æä¾åºäºåæ°æ®çè¿æ»¤åè½ï¼ä¾å¦ {"status": "completedâ} ï¼è¿å¨éè¦ç­éç¹å®ä¸å¡ç¶æçCheckpointæ¶éå¸¸æç¨ã</li>
<li>beforeï¼ä»¥RunnableConfigå¯¹è±¡çå½¢å¼æä¾Checkpoint IDï¼è¿åå¨æ­¤ ä¹ååå»ºçè®°å½ãè¿å¯¹äºå®ç° âæ¶é´æè¡â åè½è³å³éè¦ï¼åè®¸ä½ æ¥çå¾æ§è¡åå²ä¸­çæ§çæ¬ã</li>
<li>limitï¼ç¨äºéå¶è¿åæ°æ®çæ°éã</li>
</ul>
<p>æä»¬éè¿å¦ä¸çå®ä¾æ¼ç¤ºæ¥è¿ä¸æ­¥äºè§£æä¹åãæä»¬æå»ºäºä¸ä¸ªç±fooãbar1åbar2è¿ä¸ä¸ªNodeç»æçPregelï¼å¯å¨çæ¶åå©ç¨è¾å¥éå¯¹ééfooçåå¥é©±å¨æ§è¡èç¹fooï¼åèå®æååå¥éébaré©±å¨èç¹bar1åbar2å¹¶è¡æ§è¡ãä¸ä¸ªNodeçå¤çå½æ°é½æ¯handleï¼å®ä¼å°ä¼ å¥çNodeåç§°åå¥ä¸ä¸ªBinaryOperatorAggregateç±»åChannelï¼nodesï¼ï¼ç±æ­¤ç¡®å®æåæ§è¡çNodeãå¦æè°ç¨handleå½æ°å°interruptåæ°æå®ä¸ºTrueï¼å®ä¼éè¿æåºä¸ä¸ªGraphInterruptå¼å¸¸æ¨¡æä¸ä¸ªä¸­æ­ãå¨æä»¬çæ¼ç¤ºå®ä¾ä¸­ï¼èç¹fooåbar2ä¼æ§è¡æåï¼ä¸­æ­ä¼åçå¨èç¹bar1ä¸ã</p>
<pre><code class="language-python">from langgraph.pregel import Pregel, NodeBuilder
from langgraph.channels import LastValue, BinaryOperatorAggregate
from langgraph.checkpoint.memory import InMemorySaver
from langgraph.errors import GraphInterrupt
import operator, json

def handle(node_name: str, interrupt: bool = False) -&gt; list[str]:
    if interrupt:
        raise GraphInterrupt("manual interrupt")
    return [node_name]

foo = (
    NodeBuilder()
    .subscribe_to("foo")
    .do(lambda _: handle("foo"))
    .write_to(nodes=lambda x: x, bar=lambda _: "triggered by foo")
)

bar1 = (
    NodeBuilder()
    .subscribe_to("bar")
    .do(lambda _: handle("bar1", interrupt=True))
    .write_to("nodes")
)

bar2 = (
    NodeBuilder()
    .subscribe_to("bar")
    .do(lambda _: handle("bar2", interrupt=False))
    .write_to("nodes")
)

app = Pregel(
    nodes={"foo": foo, "bar1": bar1, "bar2": bar2},
    channels={
        "foo": LastValue(str),
        "bar": LastValue(str),
        "nodes": BinaryOperatorAggregate(list, operator.add),
    },
    checkpointer=InMemorySaver(),
    input_channels=["foo"],
    output_channels=["nodes"],
)
config = {"configurable": {"thread_id": "123"}}
result = app.invoke({"foo": "triggered by user"}, config=config)
assert result["nodes"] == ["foo", "bar2"]

(config, checkpoint, metadata, parent_config, pending_writes) = (
    app.checkpointer.get_tuple(config)
)
print(f"config:\n{json.dumps(config, indent=4)}")
print(f"checkpoint:\n{json.dumps(checkpoint, indent=4)}")
print(f"metadata:\n{json.dumps(metadata, indent=4)}")
print(f"parent_config:\n{json.dumps(parent_config, indent=4)}")
print(f"pending_writes:\n{json.dumps(pending_writes, indent=4)}")
</code></pre>
<p>æä»¬ä¸ºåå»ºçPregelå¯¹è±¡æä¾äºä¸ä¸ªInMemorySaverä½ä¸ºå®çCheckpointerï¼å¹¶å¨è°ç¨æ¶å©ç¨æä¾çRunnableConfigè®¾ç½®äºThread IDãç±äºæä»¬å°éénodesä½ä¸ºè¾åºï¼æä»¥è°ç¨ç»æä¼åæ ä¸ä¸ªNodeçæ§è¡ç¶æï¼åªæèç¹fooåbar2æåæ§è¡ï¼ãæä»¬éåä¼ å¥ç¸åçéç½®è°ç¨Checkpointerçget_tupleæ¹æ³ï¼å¹¶å°å¾å°çCheckpointTupleåç»è¿è¡æåè¾åºã</p>
<pre><code class="language-json">config:
{
    "configurable": {
        "thread_id": "123",
        "checkpoint_ns": "",
        "checkpoint_id": "1f0f5200-24f1-6382-8000-bde4e02ab92b"
    }
}
checkpoint:
{
    "v": 4,
    "ts": "2026-01-19T10:17:07.498064+00:00",
    "id": "1f0f5200-24f1-6382-8000-bde4e02ab92b",
    "channel_versions": {
        "foo": "00000000000000000000000000000001.0.06769883673554666",
        "nodes": "00000000000000000000000000000002.0.3174924500871408",
        "bar": "00000000000000000000000000000002.0.3174924500871408"
    },
    "versions_seen": {
        "__input__": {},
        "foo": {
            "foo": "00000000000000000000000000000001.0.06769883673554666"
        }
    },
    "updated_channels": [
        "bar",
        "nodes"
    ],
    "channel_values": {
        "foo": "triggered by user",
        "nodes": [
            "foo"
        ],
        "bar": "triggered by foo"
    }
}
metadata:
{
    "source": "loop",
    "step": 0,
    "parents": {}
}
parent_config:
{
    "configurable": {
        "thread_id": "123",
        "checkpoint_ns": "",
        "checkpoint_id": "1f0f5200-24ee-671f-bfff-2e9f3ca91778"
    }
}
pending_writes:
[
    [
        "30b17cb1-76f1-3c5a-0d32-33f544fcabdf",
        "nodes",
        [
            "bar2"
        ]
    ],
    [
        "e126d089-c354-0ac8-bb9e-b12bbe3f20b8",
        "__interrupt__",
        "manual interrupt"
    ]
]
</code></pre>
<p>æ´ä¸ªæ§è¡è¿ç¨æ¶åä¸ä¸ªSuperstepï¼ä¼åå»ºä¸¤ä¸ªCheckpointãç¬¬ä¸ä¸ªCheckpointçåå»ºåçå¨è°ç¨invokeæ¹æ³çæ¶åï¼æ­¤æ¶æä¾çè¾å¥è¢«åå¥Channelï¼é¦æ¹å¾æ§è¡çNodeï¼fooï¼åå¤å°±ç»ªï¼æ­¤æ¶åå»ºçCheckpoint è®°å½äº <code>æ¥æ¶å°äºåå§ä»»å¡ï¼ä½å°æªå¼å§æ§è¡ä»»ä½Node</code> çç¶æãæ­¤æ¶å¯¹åºçSuperstepåºå·ä¸º-1ï¼è¾åºç»æçparent_configé¨åæä¾äºæ­¤CheckpointçIDã</p>
<p>ç¬¬äºä¸ªCheckpointæ¯ä¸ºåºå·ä¸º0çSuperstepåå»ºçï¼æ­¤æ¶èç¹fooæåæ§è¡ï¼æ§è¡ç»ææç»è¢«è¾å¥ç®æ Channelï¼åå»ºçCheckpointåæ çå°±æ¯çç¶æï¼configé¨åæä¾äºæ­¤CheckpointçIDãä¸é¢çè¾åºè¿æä¾äºè¿ä¸ªCheckpointçæ¶é´æ³ãChannelççæ¬åå¼ãæ¶åNodeçå¯è§Channelï¼fåçæ¬ï¼ä»¥åæ¶åæ´æ°çChannelåè¡¨ã</p>
<p>ç±äºæåä¸ä¸ªSuperstepï¼åºå·ä¸º1ï¼æ²¡æå®å¨ç»æï¼å®ä»¬ä¼å©ç¨å¯¹åºçPending Writeæ¥æè¿°ãä¸é¢è¾åºçç¬¬ä¸ä¸ªPending Writeè¡¨ç¤ºæåæ§è¡çèç¹baréå¯¹éénodesçåå¥ï¼ç¬¬äºä¸ªéå¯¹ç¹æ®ç³»ç»Channel <code>__interrupt__</code>çåå¥å¾ææ¾å°±æ¯å ä¸ºèç¹bar1çä¸­æ­å¯¼è´ã</p>
<h2 id="2-è¯»åç¶æå¿«ç§">2. è¯»åç¶æå¿«ç§</h2>
<p>BaseCheckpointSaveræä¾äºget_tuple/aget_tupleæ¹æ³ä»¥Checkpoint_Tupleçå½¢å¼è¿åææ°æèåºäºè¿å»æ¶é´ç¹çç¶æãå¯¹äºCheckpointTupleè¿ä¸ªäºåç»ï¼é¤äºCheckpointåPendingWriteåè¡¨ï¼è¿åæ¬Checkpointçåæ°æ®åç¸å³éç½®ãè¿ä¸ªåç»ä¸»è¦ç±æ§è¡å¼æåé¨ä½¿ç¨çï¼éå¯¹æç»å¼åèæ¥è¯´å¯è¯»æ§å·®ç¹ï¼æä»¥Pregelç±»å®ä¹äºå¦ä¸æç¤ºç<code>get_state/aget_state</code>æ¹æ³ï¼å®ä»¬æä¾çStateSnapshotç±»åæ´å·å¯è¯»æ§ã</p>
<pre><code class="language-python">class Pregel(
    PregelProtocol[StateT, ContextT, InputT, OutputT],
    Generic[StateT, ContextT, InputT, OutputT]): 

    def get_state(
        self, config: RunnableConfig, *, subgraphs: bool = False
    ) -&gt; StateSnapshot
    async def aget_state(
        self, config: RunnableConfig, *, subgraphs: bool = False
    ) -&gt; StateSnapshot

    def get_state_history(
        self,
        config: RunnableConfig,
        *,
        filter: dict[str, Any] | None = None,
        before: RunnableConfig | None = None,
        limit: int | None = None,
    ) -&gt; Iterator[StateSnapshot]
    async def aget_state_history(
        self,
        config: RunnableConfig,
        *,
        filter: dict[str, Any] | None = None,
        before: RunnableConfig | None = None,
        limit: int | None = None,
    ) -&gt; AsyncIterator[StateSnapshot]
</code></pre>
<p>å½æä»¬è°ç¨Pregelå¯¹è±¡ç<code>get_state/aget_state</code>æ¹æ³çæ¶åï¼å®ä¼å°æå®çRunnableConfigå¯¹è±¡ä½ä¸ºåæ°è°ç¨Checkpointerç<code>get_tuple/aget_tuple</code>æ¹æ³ï¼å¹¶å©ç¨è¿åçCheckpoint_Tupleåç»çæStateSnapshotå¯¹è±¡ãStateSnapshotç<code>values</code>å­æ®µæä¾çå¼æ¥æºäºCheckpointå¯¹è±¡çchannel_valueså­æ®µï¼å®ç<code>metadata</code>å­æ®µè¡¨ç¤ºçCheckpointMetadata ç´æ¥æ¥æºäºCheckpoint_Tupleçååå­æ®µï¼è<code>config</code>å<code>parent_config</code>è¿åçRunnableConfigåæ¯ç±Checkpoint_Tupleååå­æ®µäºåæ°æ®åå¹¶èæãè¡¨ç¤ºå¿«ç§åå»ºæ¶é´ç<code>created_at</code>å¯¹åºäºCheckpoint_Tupleè¡¨ç¤ºæ¶é´æ³çtså­æ®µï¼èinterruptsè¿åçInterruptåè¡¨æ¯æ ¹æ®ä¸­æ­ç±»åçPendingWriteæå»ºçã</p>
<pre><code class="language-python">class StateSnapshot(NamedTuple):
    values: dict[str, Any] | Any
    next: tuple[str, ...]
    config: RunnableConfig
    metadata: CheckpointMetadata | None
    created_at: str | None
    parent_config: RunnableConfig | None
    tasks: tuple[PregelTask, ...]
    interrupts: tuple[Interrupt, ...]

class PregelTask(NamedTuple):
    id: str
    name: str
    path: tuple[str | int | tuple, ...]
    error: Exception | None = None
    interrupts: tuple[Interrupt, ...] = ()
    state: None | RunnableConfig | StateSnapshot = None
    result: Any | None = None
</code></pre>
<p>StateSnapshotç<code>tasks</code>å­æ®µè¿åä¸ç»PregelTaskå¯¹è±¡ï¼å®ä»¬è¡¨ç¤ºæ ¹æ®Checkpointåå»ºçå¾æ§è¡ä»»å¡ï¼<code>next</code>å­æ®µä»¥åç»çå½¢å¼è¿åè¿äºä»»å¡çNodeåç§°ãå¯¹äºææ°çCheckpointï¼è¥ä¸ä¸ä¸ªSuperstepå°æªå®æï¼PregelTaskçä¿¡æ¯è¿ä¼å©ç¨å¯¹åºçPending Writeè¿ä¸æ­¥å®åãæä»¬å¯ä»¥å©ç¨PregelTaskå¯¹è±¡å¾å°æ¯ä¸ªä»»å¡çIDãNodeåç§°ãæ§è¡è·¯å¾ãæåºçå¼å¸¸åä¸­æ­ï¼æ ¹æ®å¼å¸¸åä¸­æ­ç±»åçPendingWriteåå»ºï¼ï¼è<code>state</code>å<code>result</code>åå«æ¿è½½è¿ä»»å¡çç¶æåè¾åºç»æãå¦ææ´ä¸ªæ§è¡æµç¨ç»æï¼èªç¶å°±æ²¡ææè°åç»­ä»»å¡çè¯´æ³ï¼æ­¤æ¶StateSnapshotçtaskså­æ®µä¸ºç©ºã</p>
<p>é¤äºè¿åä¸ä¸ªå·ä½çç¶æå¿«ç§ï¼Pregelç±»è¿å®ä¹äº<code>get_state_history/aget_state_history</code>ï¼å®ä»¬çåæ°åè¡¨ä¸BaseCheckpointSaverç<code>list/alist</code>æ¹æ³å®å¨ä¸è´ãå½è¿ä¸¤ä¸ªæ¹æ³è¢«è°ç¨çæ¶åï¼Pregelä¼è°ç¨Checkpointerç<code>list/alist</code>æ¹æ³ï¼å¹¶å°å¾å°Checkpoint_Tupleåç»è½¬æ¢æStateSnapshotå¯¹è±¡ã<code>get_state_history/aget_state_history</code>æ¹æ³è¿åçè¿­ä»£å¨ä»¥æ¶é´éåºçæ¹å¼è¿åå¯¹åºçç¶æå¿«ç§ã</p>
<p>å¦ä¸è¿ä¸ªç¨åºæ¼ç¤ºäºä¸ä¸ªå·ä½çPregelå¯¹è±¡çåå²ç±åªäºå¿«ç§ç»æï¼æ¯ä¸ªå¿«ç§ååæ å½æ¶çç¶æãæä»¬æå»ºçPregelå¯¹è±¡ç±åä¸ªNodeç»æï¼è°ç¨æ¶æå®ééfooä¼é©±å¨æ§è¡èç¹fooï¼å®æ§è¡ç»æååå¥éébaré©±å¨bar1ãbar2åbar3å¹¶è¡æ§è¡ãé¤äºbar1è½å¤é¡ºå©æ§è¡å¤ï¼æä»¬ä¸ºbar2è®¾ç½®äºä¸ä¸ªä¸­æ­ï¼è®©bar3æåºå¼å¸¸ã</p>
<pre><code class="language-python">from langgraph.channels import LastValue
from langgraph.pregel import Pregel, NodeBuilder
from langgraph.checkpoint.memory import  InMemorySaver
from langgraph.types import interrupt
    
def handle(node_name: str, halt : bool, raise_error: bool) -&gt; None:
    if halt:
        _ = interrupt(f"Manually be interrupted at {node_name}")
    if raise_error:
        raise Exception(f"Manually raised error at {node_name}")

foo = (NodeBuilder()
       .subscribe_to("foo", read=False)
       .do(lambda _: handle("foo", halt=False, raise_error=False))
       .write_to(bar = lambda _:None))
bar1 = (NodeBuilder()
        .subscribe_to("bar", read=False)
        .do(lambda _: handle("bar1", halt=False, raise_error=False)))
bar2 = (NodeBuilder()
        .subscribe_to("bar", read=False)
        .do(lambda _: handle("bar2", halt=True, raise_error=False)))
bar3 = (NodeBuilder()
        .subscribe_to("bar", read=False)
        .do(lambda _: handle("bar3", halt=False, raise_error=True)))
app = Pregel(
    nodes={
        "foo": foo,
        "bar1": bar1,
        "bar2": bar2,
        "bar3": bar3
    },
    channels={
        "foo": LastValue(str),
        "bar": LastValue(str),
    },
    input_channels=["foo"],
    output_channels=[],
    checkpointer= InMemorySaver())
config = {"configurable": {"thread_id": "123"}}

try:
    app.invoke(input={"foo": "begin"},config=config)
except Exception as e:
    pass

for snapshot in app.get_state_history(config):
    print(f"""
values: {snapshot.values}
next: {snapshot.next}
interrupts: {snapshot.interrupts}   
tasks:""")
    for task in snapshot.tasks:
        print(f"""  id: {task.id}
    name: {task.name}
    path: {task.path}
    error: {task.error} 
    interrupts: {task.interrupts}
    state: {task.state}
    result: {task.result}""")
</code></pre>
<p>å¨å®æäºéå¯¹Pregelå¯¹è±¡çè°ç¨åï¼æä»¬éç¨ç¸åçéç½®è°ç¨å®ç<code>get_state_history</code>æ¹æ³å¾å°å®æ´çåå²ï¼å¹¶å°æ¿è½½åå²çæ®µçStateSnapshotä¿¡æ¯æå°åºæ¥ãæ´ä¸ªè¿ç¨æ¶åä¸ä¸ªSuperstepï¼åä¸¤ä¸ªæåå®æçSuperstepä¼æä¾ä¸¤ä¸ªCheckpointï¼ç¬¬ä¸ä¸ªå°æªå®æçSuperstepåªæä¾éå¯¹ä¸ä¸ªNodeä»»å¡çPending Writeã</p>
<pre><code class="language-json">values: {'start': 'begin', 'bar': None}
next: ('bar1', 'bar2', 'bar3')
interrupts: (Interrupt(value='Manually be interrupted at bar2', 
    id='26f309d618c42ff31d2b3404369232e4'),)
tasks:
  id: dbb24ec5-f1ba-f845-7351-54e88f34db0f
    name: bar1
    path: ('__pregel_pull', 'bar1')
    error: None
    interrupts: ()
    state: None
    result: {}
  id: 794fffda-2e6c-0685-0d44-3ed6c57ca366
    name: bar2
    path: ('__pregel_pull', 'bar2')
    error: None
    interrupts: (Interrupt(value='Manually be interrupted at bar2', 
        id='26f309d618c42ff31d2b3404369232e4'),)
    state: None
    result: None
  id: 1055ec55-49dc-0629-86b5-661a2614f349
    name: bar3
    path: ('__pregel_pull', 'bar3')
    error: Exception('Manually raised error at bar3')
    interrupts: ()
    state: None
    result: None

values: {'start': 'begin'}
next: ('foo',)
interrupts: ()
tasks:
  id: 88904475-3edc-733a-d84d-98aa6d3f5e80
    name: foo
    path: ('__pregel_pull', 'foo')
    error: None
    interrupts: ()
    state: None
    result: {'bar': None}
</code></pre>
<h2 id="3ä»»å¡è·¯å¾">3.ä»»å¡è·¯å¾</h2>
<p>è¿è®°å¾æä»¬åé¢è¯´ä¸ªä»»å¡çä¸¤ç§åå»ºæ¹å¼ï¼ä¸ç§æ¯ç«å¨Nodeçè§åº¦ï¼éè¿æ¥çè®¢éChannelçæ´æ°ç¶æç¡®å®æ¯å¦åºè¯¥æ§è¡ï¼æä»¬ç§°è¿ç§ä»»å¡åå»ºæ¨¡å¼ä¸º<code>Pullæ¨¡å¼</code>ãä¸ä¹ç¸å¯¹çåæ¯<code>Pushæ¨¡å¼</code>ï¼Nodeå©ç¨åå¥<code>__pregel_tasks</code>è¿ä¸ªç¹æ®ChannelçSendå¯¹è±¡å³å®åç»­æ§è¡çNodeï¼æ§è¡å¼æä¼ä»æ­¤Channelè¯»åSendå¯¹è±¡çæ¥åå»ºå¯¹åºçä»»å¡ãä»»å¡è·¯å¾çç¬¬ä¸é¨åéå¸¸å°±åæ äºä»»å¡çé©±å¨æ¨¡å¼ï¼å¯¹åºçå¼ä¸º<code>__pregel_pull</code>å<code>__pregel_push</code>ã</p>
<p>ç±äºåé¢æ¼ç¤ºçé½æ¯åºäºChannelè®¢éé©±å¨çä»»å¡ï¼æä»¥è·¯å¾éç¨(â__pregel_pullâ,{node})çå½¢å¼ãå¦ä¸çç¨åºæ¼ç¤ºâPushä»»å¡âçè·¯å¾ï¼æä»¬æå»ºçPregelç±åä¸ªNodeï¼fooãbar1ãbar2åbar3ï¼ç»æï¼èç¹fooçå¤çå½æ°æç»ä¼çæä¸ä¸ªéå¯¹å¶ä»NodeçSendå¯¹è±¡ï¼å¹¶åå¥â__pregel_tasksâChannelä»¥é©±å¨å®ä»¬å¹¶è¡æ§è¡ã</p>
<pre><code class="language-python">from langgraph.pregel import Pregel, NodeBuilder
from langgraph.channels import LastValue
from langgraph.pregel._read import PregelNode
from langgraph.pregel._write import ChannelWrite, ChannelWriteTupleEntry
from langgraph.types import Send
from langgraph.checkpoint.memory import InMemorySaver

entry = ChannelWriteTupleEntry(lambda args: [("__pregel_tasks", args)])
writer = ChannelWrite(writes=[entry])
foo: PregelNode = (
    NodeBuilder()
    .subscribe_to("foo")
    .do(lambda _: [Send(node=node, arg="foo") for node in ["bar1", "bar2", "bar3"]])
).build()
foo.writers.append(writer)

bars = {name: NodeBuilder() for name in ["bar1", "bar2", "bar3"]}

app = Pregel(
    nodes={"foo": foo, **bars},
    channels={
        "foo": LastValue(None),
    },
    input_channels=["foo"],
    output_channels=[],
    checkpointer=InMemorySaver(),
)

config = {"configurable": {"thread_id": "123"}}
result = app.invoke(input={"foo": None}, config=config, interrupt_before="bar2")
snapshot = app.get_state(config)
for task in snapshot.tasks:
    print(f"{task.name}:{task.path}")
</code></pre>
<p>ä¸ºäºè½çå°ä¸ä¸ªä»»å¡ï¼æä»¬å¨å¨æåä¸ä¸ªSuperstepä¸­äº§çä¸ä¸ªä¸­æ­ï¼ä¸ºæ­¤æä»¬å¨è°ç¨çæ¶åéè¿æå®<code>interrupt_before</code>åæ°å¨æ§è¡èç¹bar2åä¸­æ­ãæä»¬éåè°ç¨Pregelçget_stateæ¹æ³å¾å°æè¿°æç»ç¶æçStateSnapshotï¼å¹¶è¾åºææä»»å¡çæ§è¡è·¯å¾ãä»å¦ä¸çè¾åºå¯ä»¥çåºï¼ç±äºæ¯ä¸ä¸ªåºäºPushæ¨¡å¼çä»»å¡ï¼æä»¥ç»æè·¯å¾çç¬¬ä¸ä¸ªé¨ååå®¹ä¸º <code>__pregel_push</code> ãæ¯ä¸ªä»»å¡ç± <code>__pregel_tasks</code> ChannelçSendå¯¹è±¡æå»ºèæï¼ç¬¬äºé¨åçæ°ç»ä»£è¡¨å¯¹åºçSendå¯¹è±¡å¨Channelä¸­çç´¢å¼ãç±äºæ´ä¸ªç¨åºåªæå¯ä¸çPregelå¯¹è±¡ï¼ä¸è®¾ç½®å­å¾è°ç¨ï¼æä»¥ç¬¬ä¸é¨åè¿åFalseã</p>
<pre><code>bar1:('__pregel_push', 0, False)
bar2:('__pregel_push', 1, False)
bar3:('__pregel_push', 2, False)
</code></pre>
<h2 id="4ç¶æåµå¥">4.ç¶æåµå¥</h2>
<p>è¿éæä»¬æå¿è¦æä¸ä¸PregelTaskç±»ç<code>state</code>å­æ®µãä»ç»åºçå®ä¹å¯ä»¥çåºï¼å®å¯ä»¥è¿åä¸ä¸ªRunnableConfigéç½®ï¼ä¹å¯ä»¥è¿åä¸ä¸ªStateSnapshotå¯¹è±¡ãå¦æä»»å¡æ¶åå­å¾çè°ç¨ï¼å¹¶ä¸å¨è°ç¨get_state/aget_stateæ¹æ³æ¶å°subgraphsåæ°è®¾ç½®ä¸ºTrueï¼å®çstateå­æ®µå°±ä¼è¿åä¸ä¸ªæè¿°å­å¾å½åç¶æç<code>StateSnapshot</code>å¯¹è±¡ãåå©äºåæ æ§è¡é¾è·¯åè°ç¨é¡ºåºçCheckpointå½åç©ºé´ï¼å°±å¯ä»¥å½¢æçåµå¥å±æ¬¡ç»æï¼state =&gt;task=&gt;stateï¼ä½¿æä»¬å¯ä»¥å¯ä»¥çå°ä¸ä¸ªä»»å¡å®æ´çè°ç¨é¾æ¡ã</p>
<p><img alt="Alternative Text" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3765958/202602/3765958-20260219075836401-630441833.png" class="lazyload"></p>
<p>ä»¥å¦ä¸è¿ä¸ªéªè¯ç¨åºä¸ºä¾ãæä»¬æå»ºäºä¸¤ä¸ªå·æåä¸NodeçPregelå¯¹è±¡appåsub_graphï¼åèçèç¹main_nodeä»¥å­å¾è°ç¨çæ¹å¼è°ç¨sub_graphï¼åèçNodeå½åä¸º âsub_nodeâãä¸ºäºå¨StateSnapshotä¸­å°ä»»å¡ä¿çä¸æ¥ï¼æä»¬å¨ä¸¤ä¸ªNodeä¸­å¼å¥äºä¸­æ­ã</p>
<pre><code class="language-python">from langgraph.pregel import Pregel, NodeBuilder
from langgraph.channels import LastValue
from langgraph.checkpoint.memory import InMemorySaver
from langgraph.types import interrupt
from typing import Any
from langgraph.types import StateSnapshot

sub_node = (NodeBuilder()
    .subscribe_to("start")
    .do(lambda _: interrupt("manual interrupt"))
)
sub_graph = Pregel(
    nodes={"sub_node": sub_node},
    channels={"start": LastValue(str)},
    input_channels=["start"],
    output_channels=[],
)

def handle(args: dict[str, Any]) -&gt; None:
    sub_graph.invoke(input={"start": "begin"})
    interrupt("main graph interrupt")

main_node = NodeBuilder().subscribe_to("start").do(handle)
app = Pregel(
    nodes={"main_node": main_node},
    channels={"start": LastValue(str)},
    input_channels=["start"],
    output_channels=[],
    checkpointer=InMemorySaver())

config = {"configurable": {"thread_id": "123"}}
app.invoke(input={"start": "begin"}, config=config)
snapshot = app.get_state(config, subgraphs=True)

indent = -1
def print_snapshot(snapshot: StateSnapshot) -&gt; None:
    global indent
    indent += 1
    config = snapshot.config["configurable"]
    print(f"{'  ' * indent}checkpoint_ns: {config.get('checkpoint_ns', None)}")
    for task in snapshot.tasks:
        print(f"{'  ' * indent}task: {task.name}:{task.id}")
        if sub_snapshot := task.state:
            print_snapshot(sub_snapshot)

print_snapshot(snapshot)
</code></pre>
<p>å¨å®æè°ç¨åï¼æä»¬è°ç¨ä½ä¸ºä¸»å¾çPregelå¯¹è±¡ç<code>get_state</code>æ¹æ³ï¼å¹¶å°åæ°subgraphsè®¾ç½®ä¸ºTrueãæä»¬è°ç¨print_snapshotå½æ°è¾åºStateSnapshotæä¾çCheckpointå½åç©ºé´åä»»å¡çåç§°ä¸IDãå¦ææè¿°ä»»å¡çPregelTaskå¯¹è±¡çstateå­æ®µä¹æ¯ä¸ä¸ªStateSnapshotå¯¹è±¡ï¼é£ä¹ç»§ç»­éå½è°ç¨æ­¤å½æ°ãä»å¦ä¸çè¾åºå¯ä»¥çåºï¼ä½ä¸ºå­å¾çPregelå°å½åä»»å¡çåç§°åIDçç»åä½ä¸ºCheckpointå½åç©ºé´ï¼è¿æ ·çç»æç¡®ä¿äº âä¸»å¾â æ¢å¤çæ¶åè½å¤ç²¾åå°å è½½ âå­å¾â çç¶æã</p>
<pre><code>checkpoint_ns: 
task: main_node:9f7c900b-0d56-927c-17fb-5d519cc85678
    checkpoint_ns: main_node:9f7c900b-0d56-927c-17fb-5d519cc85678
    task: sub_node:a483bfb8-bcc6-92b3-2f64-9f9e9f4fe158
</code></pre>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-19 07:59">2026-02-19 07:58</span>&nbsp;
<a href="https://www.cnblogs.com/jaydenai">JaydenAI</a>&nbsp;
éè¯»(<span id="post_view_count">54</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19623976);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19623976', targetLink: 'https://www.cnblogs.com/jaydenai/p/19623976/read-state', title: '[æè§£LangChainæ§è¡å¼æ]æä¹åç¶æçæå' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ AI å­¦ä¹ ç¬è®°ï¼Agent çåºç¡åºç¨ ]]></title>
    <link>https://www.cnblogs.com/owlman/p/19623216</link>
    <guid>3ab4031921348db14bb19443c10ebff8</guid>
    <description>
    <![CDATA[ 
        <h2 class="post-title">
            <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/owlman/p/19623216" title="åå¸äº 2026-02-18 16:09">
    <span role="heading" aria-level="2">AI å­¦ä¹ ç¬è®°ï¼Agent çåºç¡åºç¨</span>
    

</a>

        </h2>
        <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>[!NOTE] ç¬è®°è¯´æ</p>
<p>è¿ç¯ç¬è®°å¯¹åºçæ¯ã[[å³äº AI çå­¦ä¹ è·¯çº¿å¾]]ãä¸æä¸­æè§åçç¬¬åä¸ªå­¦ä¹ é¶æ®µãå¶ä¸­è®°å½äºæå­¦ä¹  AI Agent çå·¥ä½åçï¼å¹¶å°å¶åºç¨äºå®éå·¥ä½åºæ¯çå¨è¿ç¨ï¼ä»¥åå¨è¯¥è¿ç¨ä¸­æè·å¾çå¿å¾ä½ä¼ãåæ ·çï¼è¿äºåå®¹ä¹å°æä¸ºæ AI ç³»åç¬è®°çä¸é¨åï¼è¢«å­å¨å¨æ¬äºº Github ä¸ç<a href="https://github.com/owlman/CS_StudyNotes" target="_blank" rel="noopener nofollow">è®¡ç®æºå­¦ä¹ ç¬è®°åº</a>ä¸­ï¼å¹¶äºä»¥é¿æç»´æ¤ã</p>
</blockquote>
<h2 id="ai-agent-ç®ä»">AI Agent ç®ä»</h2>
<p>å¨çè§£äº LLM å¨çäº§ç¯å¢ä¸­ææ®æ¼çè§è²ä¹åï¼åå­¦èä»¬æ¥ä¸æ¥è¦æèçé®é¢æ¯ï¼å¦ä½è®©å®åä¸å°èªå·±çå®éå·¥ä½ä¸­ï¼å°ç®åä¸ºæ­¢ï¼æªè³ 2026 å¹´ 2 æï¼ï¼è¿ä¸ªé®é¢æå·å¯è¡æ§çè§£å³æ¹æ¡æ¯ï¼æå»ºå¹¶ä½¿ç¨ AI Agentã</p>
<h3 id="ä¸ºä»ä¹éè¦-ai-agent">ä¸ºä»ä¹éè¦ AI Agent</h3>
<p>å¨æ©æï¼å¤§å¤æ°ç¨æ·æ¯éè¿ Web ç«¯æç§»å¨ç«¯çå³æ¶éä¿¡åºç¨ï¼ä¸»è¦ä»¥ææ¬èå¤©çæ¹å¼æ¥ä½¿ç¨ LLM çï¼ä¾å¦ ChatGPTãè±åç­ï¼ãè¿ç±»åºç¨æ¬è´¨ä¸æ¯åºäº HTTP API æå»ºçäººæºäº¤äºçé¢ï¼å¶ä¸»è¦äº¤äºæ¨¡å¼æ¯âè¾å¥ææ¬âçæææ¬âçå¾è¿è¿ç¨ãæä»¬ä¹åå¨ã[[LLM çé¨ç½²ä¸æµè¯]]ãä¸æä¸­åºäº PyTest æ¡æ¶ç¼åçæµè¯ç¨ä¾ï¼å®éä¸æ¨¡æçå°±æ¯è¿ç§äº¤äºæ¨¡å¼ã</p>
<p>å°½ç®¡ï¼è¿ç±»åºç¨æå¤§å°éä½äº LLM çä½¿ç¨é¨æ§ï¼ä½¿å¶æä¸ºäºä¸ç§è½æ åæ®éç¨æ·çæºè½é®ç­å·¥å·ï¼ä½ AI æè½å¸¦æ¥ççäº§åä¹å¨å¾å¤§ç¨åº¦ä¸è¢«å±éå¨äºè¿ç§å³æ¶éä¿¡å¼çäº¤äºæ¨¡å¼ä¸­ãå ä¸ºå¨è¿ç§äº¤äºæ¨¡å¼ä¸ï¼LLM åªè½æ ¹æ®ç¨æ·å½åçè¾å¥æ¥çæææ¬ç»æï¼æ æ³ä¸»å¨è®¿é®æ¬å°ç¯å¢ãè°ç¨ç³»ç»èµæºææ§è¡å®éä»»å¡ãæ´éè¦çæ¯ï¼LLM å¨è¿ç§æ¨¡å¼ä¸å¹¶ä¸å¤äºä¸ä¸ªæç»­è¿è¡çæ§å¶ç»æä¹ä¸­ï¼å®åªå¨æ¶å°è¯·æ±æ¶ååºä¸æ¬¡æ§ååºï¼æ æ³è´è´£å·ä½çå·¥ä½æµç¨ä¸ç¶æç®¡çã</p>
<p>è¯æ³ä¸ä¸ï¼å¦æ LLM å·²ç»å·å¤äºå¤æçä»»å¡è§åä¸æ§è¡è½åï¼æä»¬å´æå®éå¶å¨èå¤©çªå£ä¸­ï¼è¿å²ä¸æ¯å¤ªæµªè´¹äºï¼æ­£æ¯ä¸ºäºé¿åè¿ç§æµªè´¹ï¼å¹¶èµäº LLM å¨ç¹å®ç¯å¢ä¸­âæ§è¡æä½âçè½åï¼AI çç ç©¶èä»¬éæ°å®¡è§äº AI Agent è¿ä¸å¨ 20 ä¸çºª 80-90 å¹´ä»£å°±å·²ç»å½¢æä½ç³»çæ¦å¿µï¼å¹¶å¨å·¥ç¨å®è·µé¢åç»äºå®å¨æ°çå®ç°å½¢å¼ã</p>
<p>å³äº AI Agent è¿ä¸ªæ¦å¿µï¼è¯»èå¯ä»¥åèæä¹åå¨ã[[å³äº AI çå­¦ä¹ è·¯çº¿å¾]]ãä¸­æ¨èçãäººå·¥æºè½ï¼ç°ä»£æ¹æ³ãä¸ä¹¦ç»åºçå®ä¹ï¼åæå¦ä¸ï¼</p>
<blockquote>
<p>An agent is anything that can perceive its environment through sensors and act upon that environment through actuators.</p>
<p>ç¿»è¯è¿æ¥å°±æ¯ï¼</p>
<p>ä»»ä½è½å¤éè¿ä¼ æå¨æç¥ç¯å¢ï¼å¹¶éè¿æ§è¡å¨å¯¹ç¯å¢äº§çå½±åçå®ä½ï¼é½å¯ä»¥ç§°ä¸º Agentã</p>
</blockquote>
<p>è¿ä¸ªå®ä¹æä¸ºäºåæ¥ææ AI Agent åºç¨ççè®ºåºç¡ãç±æ­¤ä¹å¯ä»¥çåºï¼AI Agent çæ ¸å¿åè½å¹¶ä¸æ¯æå LLM æ¬èº«çæºè½æ°´å¹³ï¼èæ¯èµäºå®ä¸å¤é¨ç³»ç»äº¤äºçè½åï¼ä½¿å¶è½å¤åä¸å°çå®çå·¥ä½æµç¨ä¹ä¸­ãä»æ¬è´¨ä¸æ¥è¯´ï¼è¿å¶å®æ¯ AI åºç¨å¨å®¢æ·ç«¯æ¹é¢çä¸æ¬¡è§è²è½¬åï¼å®ç°å¨ä»åçº¯çç­é¢å·¥å·è¢«è½¬åæäºä¸ä¸ªå¯ä»¥åä¸ä»»å¡æ§è¡çç³»ç»ç»ä»¶ãå¨ç¹å®çåºç¨åºæ¯ä¸­ï¼è¿ç§æ¶æä¸çè½¬åä¸ºå·¥ä½æµç¨çèªå¨åæä¾äºå¯è¡çå·¥ç¨è·¯å¾ã</p>
<h3 id="ai-agent-çå·¥ä½åç">AI Agent çå·¥ä½åç</h3>
<p>ä¸é¢ï¼è®©æä»¬æ¥äºè§£ä¸ä¸ AI Agent å·ä½æ¯æä¹å·¥ä½çãå¨ä¼ ç»èå¤©å¼ç AI åºç¨ä¸­ï¼æä»¬å¯ä»¥å°å¶åºæ¬çæ§è¡æ¨¡å¼ç®åæ¦æ¬ä¸ºï¼</p>
<blockquote>
<p>ç¨æ·è¾å¥ â æ¨¡åæ¨ç â è¾åºç»æ â ç»æ</p>
</blockquote>
<p>è¿ç§æ§è¡æ¨¡å¼æ¬è´¨ä¸æ¯ä¸æ¬¡æ§çè¯·æ±âååºï¼request-responseï¼ç»æãå³å¨è¿ç§æ§è¡æ¨¡å¼ä¸ï¼LLM ä¼å¨æ¥æ¶å°ç¨æ·è¾å¥åçæææ¬ï¼ç¶åå°±ç«å³éåºå½åå·¥ä½æµç¨ï¼ä¸ååä¸åç»­ç¶æç®¡çäºãAI Agent ä¸è¿ç±»åºç¨çæ ¸å¿å·®å¼å°±å¨äºï¼å®å¨æ§è¡æ¨¡å¼ä¸­å¼å¥äºä¸ä¸ªå¯æç»­è¿è¡çæ§å¶å¾ªç¯ï¼control loopï¼ãè¿ç§å¾ªç¯ç»æå° LLM ä»è¢«å¨æ¥æ¶ç¨æ·è¾å¥çææ¬çæå¨ï¼è½¬åæäºç¨äºé©±å¨æ´ä¸ªç¨åºæ§è¡ç»æçå³ç­ç»ä»¶ãæ¢è¨ä¹ï¼Agent çå­å¨å° AI åºç¨çåºæ¬æ§è¡æ¨¡å¼ä»âè¯·æ±âååºâè½¬åæäºä¸é¢è¿æ ·ä¸ä¸ªâæç¥âå³ç­âæ§è¡âçå¾ªç¯ç»æï¼</p>
<blockquote>
<p>æç¥ç¯å¢ â çæå³ç­ â æ§è¡å¨ä½ â æ´æ°ç¯å¢ç¶æ â åæ¬¡æç¥</p>
</blockquote>
<p>è¿ä¸ªå¾ªç¯ç»æä¼æç»­è¿è¡ä¸å»ï¼ç´å°ä»»å¡å®æææ»¡è¶³ç»æ­¢æ¡ä»¶ãä»è¯¥æ§è¡æ¨¡å¼å¯ä»¥çåºï¼ä¸ä¸ªå¸åç AI Agent åºç¨éå¸¸åå«ä»¥ä¸å ä¸ªæ ¸å¿ç»ä»¶ï¼</p>
<ul>
<li><strong>LLM</strong>ï¼è¯¥ç»ä»¶è´è´£çè§£å½åä»»å¡ç®æ ãåæä¸ä¸æç¶æå¹¶çæä¸ä¸æ­¥è¡å¨å³ç­ï¼ä¸è´è´£ç´æ¥æ§è¡å¤é¨æä½ï¼</li>
<li><strong>å·¥å·æ¥å£</strong>ï¼è¯¥ç»ä»¶è´è´£å° LLM çæçç»æåæä»¤è½¬æ¢ä¸ºå®éå¯æ§è¡çæä½ï¼ä¾å¦ï¼è°ç¨ APIãè®¿é®æ°æ®åºãè¯»åæä»¶ãæ§è¡ç³»ç»å½ä»¤ãè§¦åå¤é¨æå¡ç­ãå®ä»¬éå¸¸ç±å¼åèå®ä¹ï¼å¹¶éè¿å½æ°è°ç¨ææä»¶æºå¶æ´é²ç»æ¨¡åï¼</li>
<li><strong>ç¶æç®¡ç</strong>ï¼è¯¥ç»ä»¶è´è´£ç»´æ¤ä»»å¡çä¸­é´ç¶æï¼ä¾å¦ï¼å½åä»»å¡è¿åº¦ãå·²æ§è¡æ­¥éª¤ãå¤é¨ç¯å¢ååãåå²å³ç­è®°å½ç­ãè¿äºç¶æéå¸¸ä¼è¢«å­å¨å¨åå­åéãæ°æ®åºãåéå­å¨ãæä»¶ç³»ç»ç­ä»è´¨ä¸­ï¼å¦æç¼ºä¹ææçç¶æç®¡çæºå¶ï¼æä»¬å°±é¾ä»¥æå»ºä¸ä¸ªçæ­£ç Agent åºç¨ï¼</li>
<li><strong>æ§å¶å¨</strong>ï¼è¯¥ç»ä»¶è´è´£é©±å¨å¾ªç¯ãå¤æ­æ¯å¦ç»§ç»­æ§è¡ãè§£ææ¨¡åè¾åºãè°ç¨å¯¹åºå·¥å·ãå¤çå¼å¸¸ä¸å¤±è´¥éè¯ãä»æ¶æè§åº¦æ¥çï¼æ§å¶å¨å¯è¢«è§ä¸º Agent ç³»ç»çâéª¨æ¶âï¼è LLM åªæ¯å¶ä¸­çå³ç­æ¨¡åã</li>
</ul>
<p>åºäºä»¥ä¸æ ¸å¿ç»ä»¶ï¼æä»¬å°±å¯ä»¥ç®åå°å½çº³åºä¸ä¸ª Agent åºç¨çå·¥ä½æµç¨ï¼å¶ä¸»è¦æ­¥éª¤å¦ä¸ï¼</p>
<ol>
<li>æ¥æ¶ä»»å¡ç®æ </li>
<li>å°ç®æ ä¸å½åç¶æè¾å¥ LLM</li>
<li>LLM è¾åºä¸ä¸æ­¥è¡å¨è®¡åï¼éå¸¸ä¸ºç»æåæ ¼å¼ï¼</li>
<li>æ§å¶å¨è§£æè¾åº</li>
<li>è°ç¨ç¸åºå·¥å·æ§è¡</li>
<li>æ´æ°ç¶æ</li>
<li>å¤æ­æ¯å¦å®æä»»å¡</li>
<li>è¥æªå®æï¼åè¿å¥ä¸ä¸è½®å¾ªç¯</li>
</ol>
<p>ä»å·¥ç¨è§åº¦æ¥çï¼AI Agent æ¯ä¸ç§æ°çç³»ç»æ¶ææ¨¡å¼ï¼å®éè¿æç»­è¿è¡çæ§å¶å¾ªç¯ï¼ä½¿æ¨¡åè½å¤åä¸çå®ä»»å¡çæ§è¡è¿ç¨ï¼èä¸ä»ä»æ¯çæææ¬ç»æã</p>
<h2 id="ai-agent-çä½¿ç¨æ¹æ³">AI Agent çä½¿ç¨æ¹æ³</h2>
<p>å¨äºè§£äºä½¿ç¨ AI Agent çå¿è¦æ§åå¶å·¥ä½åçä¹åï¼æ¥ä¸æ¥å°±å¯ä»¥æ­£å¼å¼å§ç ç©¶å¦ä½å°å®è¿ç¨å°èªå·±çæ¥å¸¸å·¥ä½ä¸­äºãèå½æä»¬è¦è®¨è®º AI Agent å¨å®éå·¥ä½ä¸­çä½¿ç¨æ¹æ³æ¶ï¼é¦åéè¦åç­çé®é¢æ¯âå®è¿è¡å¨åªéãç±è°æ§å¶ãæ¿æä»ä¹è´£ä»»âãä¸åçè¿è¡å½¢æï¼å³å®äºå®å¨å·¥ç¨ç³»ç»ä¸­çè§è²è¾¹çãä¸é¢ï¼è®©æä»¬æç§"è¿è¡å¨åªé"è¿ä¸ªç»´åº¦åä¸ç±»æ¥ä»ç» AI Agent çä½¿ç¨æ¹æ³ï¼ä»¥åå®ä»¬å¨è¿äºåºç¨åºæ¯ä¸­ææ¿æçä»»å¡è§è²ã</p>
<h3 id="å½ä»¤è¡å·¥å·å-agent">å½ä»¤è¡å·¥å·å Agent</h3>
<p>å¯¹äºå¤§å¤æ°å¼åèèè¨ï¼ä»¥å½ä»¤è¡å·¥å·çå½¢å¼ä½¿ç¨ AI Agent æ¯ä¸ç§æ´ç¬¦åå·¥ç¨ç´è§çæ¹å¼ãå®è¿è¡å¨çæçç»ç«¯ç¯å¢ä¸­ï¼å¯ä»¥ç´æ¥è®¿é®æä»¶ç³»ç»ä¸ç³»ç»å½ä»¤ï¼å æ­¤çèµ·æ¥ç±»ä¼¼äºèªå¨åèæ¬ãå½ç¶äºï¼ä¸ä¼ ç»èæ¬ä¸åçæ¯ï¼AI Agent çåé¨å³ç­è·¯å¾å¹¶éé¢åç¼åï¼èæ¯ç± LLM å¨å¾ªç¯ç»æä¸­å¨æçæãè¿ç±» AI Agent åºç¨çå¸åä»£è¡¨æ¯ <a href="https://github.com/anthropics/claude-code" target="_blank" rel="noopener nofollow">Claude Code</a>ï¼ç®ååç±»çä¸»æµåºç¨è¿åæ¬ <a href="https://github.com/anomalyco/opencode" target="_blank" rel="noopener nofollow">OpenCode</a>ã<a href="https://github.com/openai/codex" target="_blank" rel="noopener nofollow">Codex CLI</a>ã<a href="https://github.com/google-gemini/gemini-cli" target="_blank" rel="noopener nofollow">Gemini CLI</a>ã<a href="https://github.com/iflow-ai/iflow-cli" target="_blank" rel="noopener nofollow">iFlow CLI</a> ç­ãä¸é¢ï¼æä»¬é¦åè¦åçå°±æ¯ï¼åå°è¿äºå·¥å·å®è£å°èªå·±æå¨çæä½ç³»ç»ä¸­ã</p>
<h4 id="å®è£ä¸éç½®">å®è£ä¸éç½®</h4>
<p>å½ä»¤è¡å·¥å·å Agent çå®è£æ¹å¼å¶å®æ¯éå¸¸ç®åçãå ä¸ºï¼è½ç¶å®ä»¬åèªéå¯¹ MacOS/Linux/Windows ç³»ç»æä¾äºä¸åç bash/powershell å®è£èæ¬ï¼æèåºäº homeberw/pacman/scoop ç­éå¯¹ä¸åæä½ç³»ç»å¹³å°çåç®¡çå¨å®è£å½ä»¤ï¼ä½åºæ¬é½æä¾äºåºäº NPM è¿ä¸åç®¡çå¨çè·¨å¹³å°å®è£æ¹å¼ãæä»¥ï¼è¯»èå¨å¤§å¤æ°æåµä¸é½å¯ä»¥æç§ä»¥ä¸æ­¥éª¤æ¥å®è£å¹¶ä½¿ç¨è¿äºå·¥å·ï¼</p>
<ol>
<li>
<p>ç¡®ä¿èªå·±æå¨çæä½ç³»ç»ä¸­å·²ç»å®è£äºçæ¬å¨ 20.0.0 ä¹ä¸ç Node.js è¿è¡ç¯å¢ï¼å¶ä¸­èªå¸¦äº NPM åç®¡çå¨ï¼</p>
</li>
<li>
<p>å¨ç®¡çåæéä¸æ§è¡<code>npm install -g &lt;agent-name&gt;@&lt;version&gt;</code>å½ä»¤ï¼å¨è¿éï¼<code>&lt;agent-name&gt;</code>å¯ä»¥éè¿æ¥è¯¢ç¸å³å·¥å·çå®æ¹ç½ç«æ¥è·å¾ï¼è<code>&lt;version&gt;</code>åé¤äºå¯ä»¥æ¯æä»¬å¨å·¥å·å®ç½ä¸­æ¥å°çå·ä½çæ¬å·ä¹å¤ï¼ä¹å¯ä»¥ç¨<code>latest</code>æ¥è¡¨ç¤ºææ°çæ¬ãä¾å¦ï¼å¦ææä»¬éè¦å®è£ææ°çæ¬ç OpenCodeï¼å°±åªéè¦å¨å½ä»¤è¡ç»ç«¯ä¸­ä½¿ç¨ç®¡çåæéæ§è¡<code>npm install -g opencode@latest</code>å½ä»¤å³å¯ã</p>
</li>
</ol>
<p>å¨å®è£å®æä¹åï¼æä»¬å°±å¯ä»¥ç¨ CLI å TUI ä¸¤ç§æ¹å¼æ¥ä½¿ç¨è¿ç§å½ä»¤è¡å·¥å·åç Agent äºãå¶ä¸­ï¼TUI çæ¹å¼å·²ç»è¢«å¤§å®¶æçç¥ï¼å®å®éä¸å°±æ¯ä¸ä¸ªåºäºå½ä»¤è¡çé¢çäº¤äºå¼ç¨åºï¼è¿ä½æ¹å¼ç±»ä¼¼äº Python Shell æ Node.js REPLï¼æ¥æå±äºèªå·±çç¬ç«çº¿ç¨ãä¾å¦å¨å®è£å® OpenCode ä¹åï¼æä»¬åªéè¦ç´æ¥å¨å½ä»¤è¡ç»ç«¯ä¸­è¾å¥<code>opencode</code>å½ä»¤ï¼å¦ææ³å»¶ç»­ä¹åä¸ OpenCode çä¼è¯ï¼è¿å¨è¯¥å½ä»¤åé¢å ä¸ä¸ä¸ª<code>--continue</code>æ<code>-c</code>åæ°ï¼ï¼å°±å¯ä»¥å¯å¨å®ç TUI çé¢äºï¼å·ä½å¦å¾ 1 æç¤ºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160322816-1525296787.png" class="lazyload"></p>
<p><strong>å¾ 1</strong>ï¼OpenCode TUI çé¢</p>
<p>å¨åæ¬¡è¿å¥ä¸æ¬¡çé¢æ¶ï¼æä»¬å¯ä»¥å¯¹èªå·±ä½¿ç¨ç AI Agent è¿è¡ä¸äºåºæ¬çéç½®ï¼è¿äºå·¥å·çéç½®æ¹å¼åºæ¬ä¸æ¯å¤§åå°å¼çãä¸è¬æ¥è¯´ï¼æä»¬ä¼åä½¿ç¨<code>/model</code>å½ä»¤è®¾ç½®ä»¥ä¸èªå·±é»è®¤è¦ä½¿ç¨ç LLMï¼ä¾å¦æ¨å¨å¾ 2 ä¸­æçå°çå°±æ¯ OpenCode ç LLM éæ©çé¢ï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160253302-210062309.png" class="lazyload"></p>
<p><strong>å¾ 2</strong>ï¼OpenCode LLM éæ©çé¢</p>
<p>éå¸¸æåµä¸ï¼å¨éæ© LLM ä¹åï¼è¿äº AI Agent ä¼è¦æ±æä»¬æä¾ä¸ä¸ª API Keyï¼ç¨äºå¨è°ç¨ LLM æ¶è¿è¡èº«ä»½éªè¯ãè¿ä¸ª API key å¯ä»¥éè¿ç»å½æä»¬å¨ç¸åº LLM å®ç½çä¸ªäººè´¦æ·æ¥è·å¾ãä¾å¦ï¼æå¨è¿ééæ©ä½¿ç¨çæ¯æºæ®ç GLM æ¨¡åï¼å°±éè¦ç»å½å°<a href="https://bigmodel.cn/" target="_blank" rel="noopener nofollow">æºæ® AI çå®ç½</a>ï¼å¹¶ä¸º OpenCode åå»ºä¸ä¸ªä¸å±ç API Keyï¼å¦å¾ 3 æç¤ºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160222119-632981045.png" class="lazyload"></p>
<p><strong>å¾ 3</strong>ï¼åå»ºæºæ® AI ç API Key</p>
<p>æ¥ä¸æ¥ï¼æä»¬å°±åªéè¦å°ä¸è¿° API Key å¤å¶å° OpenCode æç¤ºè¾å¥ key çä½ç½®ï¼å¹¶éæ©å·ä½è¦ä½¿ç¨ç GLM çæ¬å¹¶ç¡®è®¤å³å¯ãå®æè¿äºéç½®ä¹åï¼æä»¬å°±å¯ä»¥éè¿ä¸ä¸ª AI Agent ççâHello Worldâæµè¯æ¥ç¡®è®¤å®æ¯å¦å·²ç»å¯ä»¥æ­£å¸¸å·¥ä½äºï¼å¦å¾ 4 æç¤ºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160150344-1916655373.png" class="lazyload"></p>
<p><strong>å¾ 4</strong>ï¼OpenCode Hello World æµè¯</p>
<p>å¦æ AI Agent è¿åäºç±»ä¼¼ä¸é¢è¿æ ·çä¿¡æ¯ï¼å°±æå³çæä»¬å·²ç»å¯ä»¥å¼å§ä½¿ç¨å®è¿è¡å®éçå·¥ä½äºãé¤æ­¤ä¹å¤ï¼å¦ææä»¬è¿æ³å¯¹ AI Agent è¿è¡ä¸äºæ´å¤æçéç½®ï¼ä¾å¦å¼ºå¶å®åªç¨ä¸­ææ¥æ¾ç¤ºæèè¿ç¨ï¼ä»¥ååç­çåå®¹ï¼ä¹å¯ä»¥éæ©å¨èªå·±çç¨æ·ç®å½ä¸ä¸ºå¶åå»ºä¸ä¸ªå¨å±çæç¤ºè¯æä»¶ãä»¥ OpenCode ä¸ºä¾ï¼å¶å·ä½æ­¥éª¤å¦ä¸ï¼</p>
<ol>
<li>
<p>æ ¹æ®èªå·±æå¨çæä½ç³»ç»ä¸º OpenCode åå»ºä¸ä¸ªå¨å±éç½®ç®å½ãå¨é»è®¤æåµä¸ï¼è¯¥ç®å½çè·¯å¾åºè¯¥ä¸º<code>~/.config/opencode</code>ï¼å¶ä¸­<code>~</code>è¡¨ç¤ºæä»¬çç¨æ·ç®å½ã</p>
</li>
<li>
<p>å¨è¯¥ç®å½ä¸åå»ºä¸ä¸ªåä¸º<code>AGENTS.md</code>çæç¤ºè¯æä»¶ï¼å¹¶å¨å¶ä¸­è¾å¥ä»¥ä¸åå®¹ï¼</p>
<pre><code class="language-markdown"># Agent éç½®

## è¯­è¨è®¾ç½®
- **é»è®¤è¯­è¨**: ä¸­æ
- **å¼ºå¶ä½¿ç¨ä¸­æ**: æ¯

## æä»¤
- ææåç­å¿é¡»ä½¿ç¨ä¸­æ
- æææèè¿ç¨ä¹æ¾ç¤ºä¸­æ
- é¤éç¨æ·æç¡®è¦æ±ä½¿ç¨å¶ä»è¯­è¨æé®ï¼å¦åä¿æä¸­æåç­
</code></pre>
</li>
</ol>
<p>å½ç¶äºï¼æä»¬æ´å¤æ¶åä¼å¸æä¸è¿°æç¤ºè¯æä»¶åªéå¯¹å½åé¡¹ç®ææï¼è¿å¯ä»¥è¿è¡æ´å¤ä¸ªæ§åçéç½®ãä¸ºæ­¤ï¼æä»¬ä¹å¯ä»¥éæ©å¨è¯¥é¡¹ç®çæ ¹ç®å½ä¸æå¼ OpenCode TUIï¼ç¶åå¨å¶ä¸­éè¿æ§è¡<code>/init</code>å½ä»¤æ¥åå»ºä¸ä¸ªéå¯¹å½åé¡¹ç®ç<code>AGENTS.md</code>æä»¶ï¼å¹¶å°ä¸è¿°åå®¹å¤å¶å°è¯¥æä»¶ä¸­å³å¯ï¼è¯¥å½ä»¤çå·ä½ææå¦å¾ 5 æç¤ºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160119508-1547442074.png" class="lazyload"></p>
<p><strong>å¾ 5</strong>ï¼OpenCode çé¡¹ç®åå§åå½ä»¤</p>
<p>è³äºå¶ä» AI Agentï¼è½ç¶ä¼å¨å¨å±éç½®ç®å½ä¸æç¤ºè¯æä»¶ä¸æåèªçåç§°ï¼ä½åºç¨çå·¥ä½æµ/æºå¶åºæ¬æ¯å¤§åå°å¼çï¼ç¨æ·åªéç®åæ¥è¯¢ä¸ä¸å®ä»¬çå®æ¹ææ¡£ï¼å°±å¯ä»¥è½»æ¾åå°ä¸¾ä¸åä¸çï¼ä¾å¦éè¿å¿«éæ¥è¯¢ Claude Code çå®æ¹ææ¡£ï¼ç«å³å°±ä¼ç¥éå®çå¨å±æç¤ºè¯æä»¶è·¯å¾ä¸º<code>~/.claude/claude.md</code>ã</p>
<blockquote>
<p>é¡ºä¾¿è¯´ä¸å¥é¢å¤è¯ï¼è½ç¶ Claude Code å¨åæ¹é¢é½ä¸º AI Agent åºç¨å»ºç«äºæ¥è¿äºæ åçå·¥ä½æµ/æºå¶ï¼ä½èèå°å¶å®æ¹çæäºåæ³ä¼ç»ä¸­æç¨æ·å¸¦æ¥è¯¸å¤æ²¡å¿è¦çé¢å¤éç½®ï¼æå¨æ¥ä¸æ¥è¿æ¯ä¼ä»¥ OpenCode ä¸ºä¾è¿è¡è¯´æãå¦æè¯»èæ³åå®äºè§£ Claude Code çæäºå·ä½ç¨æ³ï¼ä¹å¯åèæ¬æå¨âåèèµæâä¸èä¸­æä¾çè§é¢æç¨ï¼ãClaude Code æç¨ãã</p>
</blockquote>
<h4 id="åºæ¬æä½æ¹å¼">åºæ¬æä½æ¹å¼</h4>
<p>ä¸é¢ï¼è®©æä»¬æ¥å·ä½ä»ç»ä¸ä¸å½ä»¤è¡å·¥å·å Agent çåºæ¬æä½æ¹å¼ï¼æ­£å¦ä¹åæè¯´ï¼è¿ç±»å½ä»¤è¡å·¥å·éå¸¸æ CLI å TUI ä¸¤ç§ä½¿ç¨æ¹å¼ï¼TUI ä¼åç¬æå¼ä¸ä¸ªå·¥ä½çº¿ç¨æ¥æ§è¡äº¤äºå¼æä½ï¼éå¸¸ç¨äºæ§è¡ä¸äºéè¦ä½¿ç¨å¤è½®æç¤ºè¯äº¤äºï¼å¹¶ç¡®è®¤åå®¹çå¤æä»»å¡ãå æ­¤ï¼è¿äº Agent åºç¨ç TUI å¾å¾è³å°ä¼æä¾âè®¡åï¼planï¼âåâæå»ºï¼buildï¼âä¸¤ä¸ªæ¨¡å¼ï¼ä¸ªå« Agent è¿ä¼æä¾âèªå¨ï¼autoï¼âä¹ç±»çç¬¬ä¸ç§æ¨¡å¼ï¼æèå¨æ¨¡å¼åç§°ä¸å­å¨å·®å¼ï¼ä½å¶å¨åºæ¬ä½¿ç¨é»è¾ä¸æ¯ä¸è´çï¼ï¼å¶ä¸­ï¼âè®¡åâæ¨¡å¼éå¸¸æ²¡ææ§è¡å¤é¨å½ä»¤çæéï¼ä¸»è¦ç¨äºä¸ LLM æ§è¡å¤è½®äº¤äºï¼å¹¶ç¡®è®¤æä¸æä»»å¡çè§£å³æ¹æ¡ãä¾å¦å¨ä¹åå±ç¤ºç OpenCode TUI ä¸­ï¼è¯»èå¯ä»¥å¨å¶è¾å¥æ¡çä¸æ¹çå°ï¼å®é»è®¤å¤äºâæå»ºâæ¨¡å¼ãç°å¨ï¼æä»¬å¯ä»¥éè¿è¾å¥<code>&lt;tab&gt;</code>é®æ¥å°å¶åæ¢å°âè®¡åâæ¨¡å¼ï¼ç¶ååè¯çè®©å®æ§è¡âä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ª hello world ç¨åºâçæä½ï¼å°±ä¼å¾å°ç±»ä¼¼å¾ 5 çè¾åºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160040673-1077571178.png" class="lazyload"></p>
<p><strong>å¾ 6</strong>ï¼OpenCode çè®¡åæ¨¡å¼</p>
<p>æ­£å¦è¯»èæè§ï¼ç°å¨ OpenCode TUI è¾å¥æ¡ä¸é¢æç¤ºå¶å½åå¤äºâè®¡åâæ¨¡å¼ï¼å¹¶ä¸åè¯ç¨æ·èªå·±å½åä¸è½ç¼è¾æä»¶åæ§è¡ç¨åºï¼ç¶åå¼å§ä¸ç¨æ·è®¨è®ºä»»å¡çå·ä½è§£å³æ¹æ¡ãèå½æä»¬åæ¢å°âæå»ºâæ¨¡å¼æ¶ï¼OpenCode å°±ä¼ç´æ¥æ§è¡è¿ä¸ªè§£å³æ¹æ¡ï¼å¹¶è¾åºç±»ä¼¼å¾ 7 çç»æï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160004275-1878144736.png" class="lazyload"></p>
<p><strong>å¾ 7</strong>ï¼OpenCode çæå»ºæ¨¡å¼</p>
<p>å½ç¶äºï¼å°±ä¸é¢è¿ç§ä»éä¸å¥ç®ç­çæç¤ºè¯å°±å¯ä»¥å®æçä»»å¡èè¨ï¼æä»¬å®éä¸æ´éåä½¿ç¨ CLI çæ¹å¼æ¥æ§è¡ãè¿ç§æ¹å¼åè®¸æä»¬å¨ bash/powershell è¿ç±»å½ä»¤è¡ç»ç«¯ç¨åºæå¨çå½åçº¿ç¨ä¸­ç´æ¥æ§è¡ AI Agentï¼å¹¶è¾åºç»æãä¾å¦ï¼å¦ææä»¬æ³ä½¿ç¨ OpenCode CLI çæ¹å¼æ¥ç¼åå¹¶æ§è¡ä¸é¢é£ä¸ª Python ç¨åºï¼å¯ä»¥ç´æ¥å¨å½ä»¤è¡ç»ç«¯ä¸­è¾å¥<code>opencode run "ä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ª hello world ç¨åº"</code>å½ä»¤ï¼å¹¶å¾å°ç±»ä¼¼å¾ 8 çè¾åºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218155937910-1298759938.png" class="lazyload"></p>
<p><strong>å¾ 8</strong>ï¼OpenCode ç CLI æ¨¡å¼</p>
<p>å¦è¯»èæè§ï¼ä¸è¿°å½ä»¤ç´æ¥å¨ powershell æå¨çå½åçº¿ç¨ä¸­è¾åºäº OpenCode çæ§è¡ç»æãè¿æ ·åçå¥½å¤ï¼é¤äºé¿åå ä¸äºç®åçä»»å¡åå¤å¯å¨åå³é­ OpenCode TUI ä¹å¤ï¼å¨å¿è¦æåµä¸è¿å¯ä»¥ä½¿ç¨ Shell/Python è¿æ ·çèæ¬è¯­è¨æ¥å®ç°å¯¹ AI Agent åºç¨çæ¹éè°ç¨ï¼ä¾å¦ï¼å¦ææä»¬æ³ä½¿ç¨ Python èæ¬æ¹éè°ç¨ OpenCode CLI æ¥æ§è¡ 5 ä¸ªä¸åçä»»å¡ï¼å°±å¯ä»¥åä¸é¢è¿æ ·ç¼åä¸ä¸ªç®åç Python èæ¬ï¼</p>
<pre><code class="language-python">import subprocess

tasks = [
    "ä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ª hello world ç¨åº",
    "ä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ªè®¡ç®ææ³¢é£å¥æ°åçç¨åº",
    "ä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ªè®¡ç®é¶ä¹çç¨åº",
    "ä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ªè®¡ç®ç´ æ°çç¨åº",
    "ä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ªè®¡ç®åææ°çç¨åº",
]

for task in tasks:
    try:
        result = subprocess.run(
            ["opencode", "run", task],
            capture_output=True,
            text=True,
            check=True,
            timeout=120
        )
        print(f"ä»»å¡æå: {task}")
        print(result.stdout)
    except subprocess.CalledProcessError as e:
        print(f"ä»»å¡å¤±è´¥: {task}")
        print(e.stderr)
    except subprocess.TimeoutExpired:
        print(f"ä»»å¡è¶æ¶: {task}")
</code></pre>
<p>é¤äº<code>opencode run</code>å½ä»¤ä¹å¤ï¼æä»¬è¿å¯ä»¥éè¿æ§è¡<code>opencode -h</code>å½ä»¤æ¥æ¥çå¶ä»å¯ç¨ CLI æ¹å¼æ§è¡ç OpenCode æä½ï¼å¦å¾ 9 æç¤ºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218155909459-1029247200.png" class="lazyload"></p>
<p><strong>å¾ 9</strong>ï¼OpenCode ç CLI å¸®å©ä¿¡æ¯</p>
<p>è½ç¶ï¼ä¸é¢è¿ç§å¤æ¬¡è°ç¨<code>opencode run</code>å½ä»¤çåæ³ï¼å¨æäºç¹å®çæåµä¸å¹¶ä¸æ¯æä½³çä»»å¡ç¼ææ¹å¼ãä¾å¦å¨æäºæ¶åï¼åå°ææçéæ±åå¥ä¸ä¸ª Markdown ææ¡£ä¸­ï¼åå°å¶ä½ä¸ºæç¤ºè¯ä¸æ¬¡æ§åç» AI Agent å¯è½ä¼æ¯ä¸ç§æ´åéçåæ³ãä½æ¯ï¼æä»¬å¯ä»¥åºäºè¿ä¸æè·¯åå±åºè®¸å¤æ´å¤æç AI Agent å·¥ä½æµï¼ä¾å¦å©ç¨é¨ç½²å¨æå¡ç«¯ç Agent æ¥æä½è¿äºå½ä»¤è¡å·¥å·åç Agentãä¸é¢ï¼å°±è®©æä»¬åºäº OpenClaw è¿ä¸å¯é¨ç½²æå¡åç AI Agent æ¥äºè§£ä¸ä¸è¿ä¸å·¥ä½æµçå·ä½å®ç°æ¹å¼ã</p>
<h3 id="å¯é¨ç½²æå¡å-agent">å¯é¨ç½²æå¡å Agent</h3>
<p>å¦ææä»¬å°å½ä»¤è¡å·¥å·åç AI Agent è§ä¸ºä¸ç§å¢å¼ºåçèªå¨åå·¥å·ï¼é£ä¹ä»¥ OpenClaw ä¸ºä»£è¡¨çãå¯å¨æå¡ç«¯é¨ç½²ç AI Agent åå°±æ¯ä¸ç§ç³»ç»çº§æ§è¡ååï¼äºèçå·®å¼ä¸»è¦å¨äºè¿è¡å½¢æä¸ç³»ç»è¾¹çãå·ä½æ¥è¯´å°±æ¯ï¼å½ä»¤è¡å·¥å·å Agent çè¿è¡æ¹å¼éå¸¸æ¯ï¼</p>
<ul>
<li>è¢«ç¨æ·è§¦å</li>
<li>æ§è¡ä¸è½®æå¤è½®ä»»å¡</li>
<li>è¾åºç»æ</li>
<li>éåºè¿ç¨</li>
</ul>
<p>èå¯é¨ç½²æå¡å Agent åå·æä»¥ä¸å®å¨ä¸åçç¹å¾ï¼</p>
<ul>
<li>å¸¸é©»è¿è¡</li>
<li>éè¿ HTTP / RPC / WebSocket ç­æ¹å¼å¯¹å¤æä¾è½å</li>
<li>æç»­ç»´æ¤ä¼è¯ç¶æ</li>
<li>æ¯æå¤ç¨æ·å¹¶åè®¿é®</li>
<li>å¯ä»¥è¢«å¶ä»ç³»ç»è°ç¨</li>
</ul>
<p>å¨è¿ç§å½¢æä¸ï¼Agent å°±ä¸åæ¯ä¸ä¸ªåè½ç±»ä¼¼äºèªå¨åèæ¬çå¢å¼ºåå·¥å·äºï¼å®æä¸ºäºå¸¸é©»å¨æä½ç³»ç»ä¸­çä¸ä¸ªæå¡ç»ä»¶ãå·ä½æ¥è¯´ï¼å¦æä»ç¨åºæ¶æçè§åº¦æ¥çï¼è¿ä¸¤ç§ Agent çå·®å«ä¸»è¦ä½ç°å¨ä»¥ä¸å ä¸ªæ¹é¢ï¼</p>
<ol>
<li>
<p>çå½å¨æç®¡çï¼å½ä»¤è¡å·¥å·å Agent ççå½å¨æéå¸¸æ¯ä¸æ¬¡æ§çï¼æ§è¡å®æå³éæ¯ï¼èå¯é¨ç½²æå¡å Agent åå·æé¿çå½å¨æï¼éè¦èèå¥åº·æ£æ¥ãæ¥å¿ç®¡çãå¼å¸¸æ¢å¤æºå¶ã</p>
</li>
<li>
<p>ä¼è¯ä¸ç¶æç®¡çï¼å½ä»¤è¡å·¥å·å Agent çç¶æéå¸¸ä¹æ¯ä¸æ¬¡æ§çï¼èå¯é¨ç½²æå¡å Agent åéè¦ç»´æ¤ä¼è¯ç¶æï¼è¿æå³çå®éè¦æ¯æç¨æ·çº§ä¼è¯éç¦»ãé¿æä¸ä¸æå­å¨ãè®°å¿æºå¶ï¼Memoryï¼ä»¥åå¤é¨æ°æ®åºæ¯æã</p>
</li>
<li>
<p>å¤ Agent ç¼æè½åï¼ä¸æ¦ Agent ä»¥ç³»ç»æå¡ç»ä»¶çå½¢å¼å­å¨ï¼å®å°±å¯ä»¥è°ç¨å¶ä» Agentï¼è¢«å¶ä» Agent è°ç¨ï¼åä¸æ´å¤æçä»»å¡é¾ãä¾å¦åè¿æ ·ï¼</p>
<pre><code class="language-plaintext">ç¨æ·è¯·æ±
â
è°åº¦ Agent
â
åæ Agent â ä»£ç çæ Agent â æµè¯ Agent
â
ç»ææ±æ»
</code></pre>
<p>è¿ç§æ§è¡ç»ææ¾ç¶å·²ç»ä¸åæ¯åçº¯çå·¥å·è°ç¨ï¼å®å³æ³¨çå®éä¸å·²ç»æ¯ä»»å¡çç¼æä¸è°åº¦äºãè¿ä¹å°±æå³çï¼æä»¬éè¦å¨æå¡åç Agent ä¸­å¼å¥ä»»å¡éåãæ¶æ¯éåãå¼æ­¥ä»»å¡è°åº¦ç³»ç»ç­æºå¶ã</p>
</li>
</ol>
<p>ä¸é¢ï¼è®©æä»¬ä»¥ OpenClaw ä¸ºä¾æ¥å·ä½ä»ç»ä¸ä¸ä½¿ç¨è¿ç§æå¡å Agent çä¸äºåºæ¬å·¥ä½æµãåè®¾ï¼æä»¬ç°å¨æ³ä½¿ç¨ OpenClaw ææ¥ OpenCode æ¥å®æä¸ä¸ªç®åçç½ç«éæä»»å¡ï¼éå¸¸éè¦æç§ä»¥ä¸æ­¥éª¤æ¥å®æã</p>
<h4 id="æ­¥éª¤-1å®è£å¹¶éç½®ä¸ä¸ª-openclaw-æå¡">æ­¥éª¤ 1ï¼å®è£å¹¶éç½®ä¸ä¸ª OpenClaw æå¡</h4>
<p>æ­£å¦ä¹åæè¯´ï¼OpenClaw æ¬è´¨ä¸æ¯ä¸ä¸ªç³»ç»æå¡ï¼è¿æå³çåä¸äºè¦èµäºå®è¾å¤§çæä½æéï¼åºäºå®å¨æ¹é¢çèèï¼æä¸ªäººä¸å»ºè®®ç¨æ·å°å¶å®è£å¨èªå·±æ¥å¸¸çå·¥ä½è®¾å¤ä¸ãå¦å¤ï¼å¦ææ³æå¤§éåº¦å°åæ¥ OpenClaw çåè½ï¼æå¥½è¦è½è®©å®é¿æ¶é´æç»­è¿è¡ï¼å¹¶æ§è¡ä¸å®ç¨åº¦çå®éè®¾å¤ç®¡çè½åãå æ­¤ï¼æä»¬å¨å®è£ OpenClaw æ¶éå¸¸éè¦æ§è¡çæä½å¦ä¸ï¼</p>
<ul>
<li>
<p>éç½®å¥½ä¸å°å¯ä¸æä»¬æ¥å¸¸å·¥ä½è®¾å¤ç¸è¿éçç¬ç«è®¡ç®æºï¼å¦æä»ç¨äºå­¦ä¹ ç®çï¼ä¹å¯ä»¥æ¯ä¸å°èææºï¼ï¼å¹¶å¨å¶ä¸­å®è£å¥½æä½ç³»ç»ä¸ Node.js 22.x ä»¥ä¸çæ¬çè¿è¡ç¯å¢ã</p>
</li>
<li>
<p>å¨è¿å°ç¬ç«è®¡ç®æºä¸æå¼å½ä»¤è¡ç»ç«¯ï¼å¹¶æ§è¡<code>npm install -g openclaw@latest</code>å½ä»¤æ¥å®è£ OpenClawãå½ç¶äºï¼è¿æ¯ä½¿ç¨è·¨å¹³å°çæ¹å¼ãå¦æè¯»èä¸æ³ä½¿ç¨ NPMï¼ä¹å¯ä»¥éè¿ç´æ¥æ§è¡ bash/powershell çå®è£èæ¬æ¥å®æè¿ä¸ªæä½ï¼ç¸å³å½ä»¤å¦ä¸ï¼</p>
<pre><code class="language-bash"># MacOS/Linux ç³»ç»ä¸ä½¿ç¨ bash èæ¬å®è£ï¼
curl -fsSL https://openclaw.ai/install.sh | bash
# Windows ç³»ç»ä¸ä½¿ç¨ powershell èæ¬å®è£ï¼
iwr -useb https://openclaw.ai/install.ps1 | iex
</code></pre>
</li>
<li>
<p>å¾å®è£å®æä¹åï¼ç»§ç»­æ§è¡<code>openclaw onboard --install-daemon</code>å½ä»¤æ¥å¯å¨æ°æå®è£åå¯¼ï¼å¦å¾ 10 æç¤ºï¼ï¼è¿ä¸æ­¥å®è£ OpenClaw çæå¡ç«¯ç»ä»¶ï¼ä¾å¦é£ä¹¦æºå¨äººãWhatsApp æºå¨äººç­ï¼ï¼å³äºè¿æ¹é¢çåå®¹ï¼è¯»èå¯åèæ¬æå¨âåèèµæâä¸èä¸­æä¾çè§é¢æç¨ï¼ãOpenClaw +é£ä¹¦çå·¥å·æµæ­å»ºè¿ç¨ãã</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218155800997-2144742020.png" class="lazyload"></p>
<p><strong>å¾ 10</strong>ï¼OpenClaw çå®è£åå¯¼</p>
</li>
<li>
<p>å¨éç½®å®ç¸å³æå¡ç«¯ç»ä»¶ä¹åï¼æä»¬è¿éè¦éè¿æ§è¡å¦ä¸å½ä»¤æ¥éç½® OpenClaw ç Gateway ç½å³ï¼</p>
<pre><code class="language-bash">openclaw channels login
openclaw gateway --port 18789
</code></pre>
<p>å¨è¿éï¼<code>--port</code>åæ°ç¨äºæå® OpenClaw Gateway ççå¬ç«¯å£ï¼å¦æè¯»èå¸æä½¿ç¨é»è®¤ç 18789 ç«¯å£ï¼åå¯ä»¥çç¥è¯¥åæ°ã</p>
</li>
<li>
<p>å¾ Gateway å¯å¨ä¹åï¼æä»¬å°±å¯ä»¥ä½¿ç¨æµè§å¨æå¼<code>http://localhost:18789</code>æ¥è®¿é® OpenClaw ç Web ç«¯äºï¼å¦ææä»¬è½çå°å¦å¾ 11 æç¤ºççé¢ï¼å°±è¯´æ OpenClaw å·²ç»æåå®è£å¹¶å®æäºåæ­¥çéç½®å·¥ä½ã</p>
  
<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218155717170-227815528.png" class="lazyload"></p>
<p><strong>å¾ 11</strong>ï¼OpenClaw ç Web ç«¯</p>
</li>
</ul>
<h4 id="æ­¥éª¤-2éç½®-openclaw-è°ç¨-opencode-çæ¹å¼">æ­¥éª¤ 2ï¼éç½® OpenClaw è°ç¨ OpenCode çæ¹å¼</h4>
<p>æªæ­¢å°ç®åä¸ºæ­¢ï¼æä»¬ä¸»è¦æ<strong>ä¸¤ç§æ¹å¼</strong>å¯ä»¥è®© OpenClaw ä½¿ç¨ OpenCode æ¥è¿æ¥ LLM å¹¶æ§è¡æå®çä»»å¡ãå¦æç¨æ·å·²è´­ä¹°äº OpenCode çå®æ¹æ¨¡åæå¡ï¼å³ OpenCode Zenï¼ï¼å¯ä»¥éæ©ç´æ¥ä½¿ç¨ OpenClaw èªå¸¦ç Zen æä»¶æ¥è°ç¨ OpenCodeï¼è¿ç§æ¹å¼çå·ä½æä½å¦ä¸ï¼</p>
<ul>
<li>
<p>åè·åå° OpenCode Zen ç API Keyï¼ç¶åéè¿æ§è¡å¦ä¸å½ä»¤ä¹ä¸ï¼å°å¶æ·»å å° OpenClaw çéç½®ä¸­ï¼</p>
<pre><code class="language-bash"># ä½¿ç¨äº¤äºå¼å½ä»¤ï¼è¿éè¦æ ¹æ®è¯¥å½ä»¤çæç¤ºè¾å¥ä½ ç API Key
openclaw onboard --auth-choice opencode-zen
# æéäº¤äºå¼å½ä»¤ï¼ç´æ¥å° API Key ä½ä¸ºåæ°ä¼ å¥
openclaw onboard --opencode-zen-api-key "&lt;ä½ ç API Key&gt;"
</code></pre>
</li>
<li>
<p>å¦æéè¦çè¯ï¼è¿å¯ä»¥éè¿æ§è¡å¦ä¸å½ä»¤æ¥è®¾ç½®èªå·±è¦ä½¿ç¨çé»è®¤æ¨¡åï¼</p>
<pre><code class="language-bash">openclaw config set agents.defaults.model.primary "opencode/claude-opus-4-6"
</code></pre>
</li>
</ul>
<p>å½ç¶äºï¼éæ©ä¸è¿°æ¹å¼éè¦ç¨æ·ä¸è®¡è¾æéè®¡è´¹æå¸¦æ¥çå¼éãå¦ææä»¬æ³ä½¿ç¨åè´¹ç LLM çè¯ï¼è­¬å¦  kimi-k2.5-freeï¼ï¼ä¹å¯ä»¥éè¿ç» OpenClaw å®è£ <code>opencode-to-openai</code>è¿æ ·çç¬¬ä¸æ¹æä»¶æ¥å®ç°ãè¿ç¬¬äºç§æ¹å¼çå·ä½æä½å¦ä¸ï¼</p>
<ul>
<li>
<p>å®è£<code>opencode-to-openai</code>æä»¶ï¼è¿éè¦éè¿æ§è¡å¦ä¸å½ä»¤æ¥å®æï¼</p>
<pre><code class="language-bash">git clone https://github.com/dxxzst/opencode-to-openai
cd opencode-to-openai
openclaw plugins install .
</code></pre>
</li>
<li>
<p>å®è£å®æåï¼éè¦æ§è¡å¦ä¸å½ä»¤æ¥éå¯ OpenClawï¼å¹¶ç¡®ä¿æä»¶å·²å¯ç¨ï¼</p>
<pre><code class="language-bash">openclaw gateway restart
</code></pre>
<p>å¨è¿éï¼å¦ææä»¬å¨ OpenClaw ä¸­å¯ç¨äºæä»¶ç½ååï¼å°±è¿éè¦éè¿æ§è¡å¦ä¸å½ä»¤å°è¯¥å å¥è¯¥ç½ååï¼</p>
<pre><code class="language-bash">openclaw config get plugins.allow --json
# åè®¾è¿å ["a","b"]

openclaw config set plugins.allow '["a","b","opencode-to-openai"]' --json
openclaw gateway restart
</code></pre>
</li>
<li>
<p>åæ­¥æ¨¡åå¹¶è®¤è¯ LLM æå¡ï¼è¿éè¦éè¿æ§è¡å¦ä¸å½ä»¤æ¥å®æï¼</p>
<pre><code class="language-bash">openclaw models auth login --provider opencode-to-openai --method local
</code></pre>
<p>å¦æä½ æ³é¡ºä¾¿è®¾ç½®é»è®¤æ¨¡åï¼</p>
<pre><code class="language-bash">openclaw models auth login --provider opencode-to-openai --method local --set-default
</code></pre>
</li>
<li>
<p>éæ©æ¨¡åï¼è¿éè¦éè¿æ§è¡å¦ä¸å½ä»¤æ¥å®æï¼</p>
<pre><code class="language-bash">openclaw models set opencode-to-openai/opencode/kimi-k2.5-free
</code></pre>
<p>å¨è¿éï¼å¦ææå¿å¯¹ LLM çè¯·æ±ä¼è¢«å¡ä½ï¼ä¹å¯ä»¥ç¨<code>useIsolatedHome=false</code>è¿ä¸ªæä»¶éç½®è®© OpenCode ä½¿ç¨çå® HOMEï¼å·ä½éç½®å½ä»¤å¦ä¸ï¼</p>
<pre><code class="language-bash">openclaw config set plugins.opencode-to-openai.useIsolatedHome false
</code></pre>
</li>
</ul>
<h4 id="æ­¥éª¤-3ä¸-openclaw-è¿è¡å¯¹è¯">æ­¥éª¤ 3ï¼ä¸ OpenClaw è¿è¡å¯¹è¯</h4>
<p>å¦æä¸è¿°æä½ä¸åé¡ºå©ï¼æä»¬å°±å¯ä»¥å¨æ­¥éª¤ 1 ä¸­éç½®å¥½ç Web ç«¯æé£ä¹¦ä¹ç±»çåºç¨ä¸­æå¼ä¸ OpenClaw çå¯¹è¯çªå£ï¼éè¿åéæç¤ºè¯æ¥è°åº¦ OpenCode å®æç¸å³ä»»å¡äºï¼å¦å¾ 12 æç¤ºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218155645024-1895778692.png" class="lazyload"></p>
<p><strong>å¾ 12</strong>ï¼ä¸ OpenClaw çå¯¹è¯çªå£</p>
<p>å½ç¶äºï¼å¦ææ³è®©æç¤ºè¯åæ¥å°æå¤§çä½ç¨ï¼å¹¶å¨çäº§ç¯å¢ä¸­å®éä½¿ç¨ OpenClaw/OpenCode æ¥å®æå·ä½çé¡¹ç®ä»»å¡ï¼æä»¬è¿éè¦åéç½®ä¸ä¸ OpenClaw/OpenCode ææ¥å¥ç MCP æå¡å Agent Skills æºå¶äºãå³äºè¿é¨åçåå®¹ï¼æå°ä¼å¨ã[[Agent çè¿é¶åºç¨]]ãè¿ä¸ç¯ç¬è®°ä¸­è¿è¡è¯¦ç»ä»ç»ã</p>
<h2 id="ç»æè¯­">ç»æè¯­</h2>
<p>å¨å®æäºå¯¹ AI Agent çå­¦ä¹ ä¸å®è·µä¹åï¼ææä¸ºææ¾çä½ä¼ä¹ä¸æ¯ï¼Agent å¹¶æ²¡æè®©ç³»ç»åå¾æ´ç®åï¼åèè®©ç³»ç»çè¾¹çåå¾æ´å æ¸æ°ãä¸ä¼ ç»çèªå¨åèæ¬æå·¥å·ä¸åï¼Agent å¹¶ä¸æ¯ä¸ç»åºå®è§åçéåï¼èæ¯ä¸ä¸ªåºäºè¯­è¨æ¨¡åè¿è¡ä»»å¡çè§£ãè§åä¸æ§è¡çç³»ç»ç»ä»¶ãè¿æå³çï¼å¨å¾å¤åºæ¯ä¸ï¼å®æåçå¹¶ä¸æ¯âæé¢æè¿è¡âï¼èæ¯âå°½åå®æä»»å¡âã</p>
<p>æ­£å å¦æ­¤ï¼Agent çå¼å¥å¹¶æ²¡æåå¼±äººç±»å¨ç³»ç»ä¸­çä½ç¨ï¼åèå¯¹äººçå¤æ­è½åæåºäºæ´é«è¦æ±ï¼<br>
æä»¬éè¦è½å¤çè§£ Agent å¨åä»ä¹ãä¸ºä»ä¹è¿ä¹åï¼ä»¥åå¨ä»ä¹æåµä¸åºè¯¥ä»å¥ãä¿®æ­£çè³ä¸­æ­¢å®çè¡ä¸ºãä»è¿ä¸ªè§åº¦æ¥çï¼å­¦ä¹ åä½¿ç¨ AI Agentï¼å¹¶ä¸æå³çææ§å¶æå®å¨äº¤ç» AIï¼èæ¯å­¦ä¼å¦ä½å¨ä¸ä¸ªç± AI åä¸æ§è¡çç³»ç»ä¸­ï¼éæ°å®ä½äººçèè´£ä¸è¾¹çãè¿ä¹æ­£æ¯æ¬å­¦ä¹ é¶æ®µçæ ¸å¿ç®æ ã</p>
<h2 id="åèèµæ">åèèµæ</h2>
<ul>
<li>
<p>å®æ¹ææ¡£ï¼</p>
<ul>
<li><a href="https://code.claude.com/docs/zh-CN/overview?utm_source=copilot.com" target="_blank" rel="noopener nofollow">Claude Code å®æ¹ææ¡£</a></li>
<li><a href="https://opencode.doczh.com/docs/" target="_blank" rel="noopener nofollow">OpenCode å®æ¹ææ¡£</a></li>
<li><a href="https://claude.com/blog/extending-claude-capabilities-with-skills-mcp-servers" target="_blank" rel="noopener nofollow">åºäº Agent skills å MCP æå¡çååå·¥ä½æµ</a></li>
<li><a href="https://docs.openclaw.ai/zh-CN" target="_blank" rel="noopener nofollow">OpenClaw å®æ¹ææ¡£</a></li>
</ul>
</li>
<li>
<p>è§é¢æç¨ï¼</p>
<ul>
<li>Claude Code æç¨ï¼<a href="https://www.youtube.com/watch?v=AT4b9kLtQCQ" target="_blank" rel="noopener nofollow">YouTube é¾æ¥</a> / <a href="https://www.bilibili.com/video/BV14rzQB9EJj" target="_blank" rel="noopener nofollow">Bilibili é¾æ¥</a></li>
<li>OpenClaw +é£ä¹¦çå·¥å·æµæ­å»ºè¿ç¨ï¼<a href="https://www.youtube.com/watch?v=giv63OtX720" target="_blank" rel="noopener nofollow">YouTube é¾æ¥</a> / <a href="https://www.bilibili.com/video/BV1rvcpzDEsH" target="_blank" rel="noopener nofollow">Bilibili é¾æ¥</a></li>
</ul>
</li>
</ul>


</div>
<div class="clear"></div>

        <p class="postfoot">
            posted on 
<span id="post-date" data-last-update-days="0.03680555555555556" data-date-updated="2026-02-18 17:02">2026-02-18 16:09</span>&nbsp;
<a href="https://www.cnblogs.com/owlman">åæ°</a>&nbsp;
éè¯»(<span id="post_view_count">276</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19623216);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19623216', targetLink: 'https://www.cnblogs.com/owlman/p/19623216', title: 'AI å­¦ä¹ ç¬è®°ï¼Agent çåºç¡åºç¨' })">ä¸¾æ¥</a>

        </p>
     ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä»æç¿æ¨é©¬å¥ä¾µå° Docker Rootless å åºï¼æçæå¡å¨å®å¨å¤ç ]]></title>
    <link>https://www.cnblogs.com/deali/p/19626849</link>
    <guid>bad83b26ce1d20632b52ac7719ac2f40</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/deali/p/19626849" title="åå¸äº 2026-02-20 20:45">
    <span role="heading" aria-level="2">ä»æç¿æ¨é©¬å¥ä¾µå° Docker Rootless å åºï¼æçæå¡å¨å®å¨å¤ç</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="åè¨">åè¨</h2>
<p>æè¿æè¿ç»­å å°æå¡å¨è¢«æäºæç¿æ¨é©¬ï¼CPUãå¸¦å®½ãç£ç IO è¢«ææ»¡ï¼æå¡å¨ç´æ¥å¡æ­»æ æ³è¿æ¥ã</p>
<p>ææ¥ååç°ï¼æ ¸å¿è¯±å æ¯ Docker æéè¿é« + æå¡æ¼æ´æ´é²ï¼å¯¼è´æ»å»èéè¿å®¹å¨çªç ´æéæ§å¶ã</p>
<p><img src="https://blog.deali.cn/media/blog/cec878553480eb4f/1097027d157aa49e.jpg" alt="" loading="lazy"></p>
<blockquote>
<p>PSï¼æ¬æ¥æ³åä¸ç¯æç« ä»ç»ææ¥è¿ç¨çï¼ä¸è¿è¿æ¯å«éº»ç¦æ²¡åï¼æ¾å¨æ¬æä¸èµ·è®²å§~</p>
</blockquote>
<p>éè£ç³»ç»åï¼æå¨é¨ç½² Docker æ¶æ³¨æå°å®æ¹æç¤ºç Rootlessï¼æ æ ¹ï¼æ¨¡å¼ ââ è¿ä¸æ¨¡å¼è½ä»æ ¹æ¬ä¸éä½å®¹å¨éé¸é£é©ï¼éæ·±å¥ç ç©¶å¹¶è½å°éç½®ï¼ç°å°å®æ´è¿ç¨æ´çåäº«ï¼å¸æè½å¸®å°åæ ·å³æ³¨ Docker å®å¨çå¼åèã</p>
<h2 id="rootless-æ¨¡å¼æ¯ä»ä¹">Rootless æ¨¡å¼æ¯ä»ä¹</h2>
<p>æ®éæåµä¸ï¼Docker å®æ¤è¿ç¨ï¼dockerdï¼æ¯ç¨ <code>root</code> æéè¿è¡çï¼åªæä½ ç¨æ®éç¨æ·æ§è¡ <code>docker run</code>ï¼åºå±è¿æ¯ root æéï¼è¿æå®å¨é£é©ï¼æ¯å¦å®¹å¨éé¸å¯è½æ¿å°ä¸»æº rootï¼ã</p>
<p>Rootless æ¨¡å¼è®© Docker å®æ¤è¿ç¨ä»¥<strong>æ®éç¨æ·æé</strong>è¿è¡ï¼åªæå®¹å¨åºé®é¢ï¼ä¹æ æ³è·åä¸»æºç root æéï¼å®å¨æ§å¤§å¹æåã</p>
<p>æå¥½å¤èªç¶æä»£ä»·ï¼rootless çä»£ä»·æ¯éç½®å¤æï¼ä¸é¨ååè½åéï¼æ¯å¦æ æ³ç«¯å£æ å° &lt; 1024ï¼ã</p>
<p>ä¸è¿æ²¡å³ç³»ï¼è¿äºä¹å¯ä»¥éè¿éç½®è§£å³ãåä»å®è£å¼å§å§ã</p>
<h2 id="å®è£docker">å®è£docker</h2>
<p>æ¬æ¥å®è£æ¯å¾ç®åçï¼ä¸è¿å ä¸ªå®è¯­ï¼å¨å½åç½ç»ç¯å¢ï¼é£å°±éå¸¸å¤æäºã</p>
<p>æ¬æä»ç»æç®åçå®è£æ¹å¼ï¼ä½¿ç¨dockerå®æ¹èæ¬+æ¸åéåã</p>
<pre><code class="language-bash">export DOWNLOAD_URL="https://mirrors.tuna.tsinghua.edu.cn/docker-ce"
# å¦æ¨ä½¿ç¨ curl
curl -fsSL https://ghfast.top/https://raw.githubusercontent.com/docker/docker-install/master/install.sh | sh
# å¦æ¨ä½¿ç¨ wget
wget -O- https://ghfast.top/https://raw.githubusercontent.com/docker/docker-install/master/install.sh | sh
</code></pre>
<p>æ³¨æ <code>raw.githubusercontent.com</code> è¿ä¸ªååä¹æ¯æ æ³è®¿é®çï¼å¯ä»¥ä½¿ç¨ ghproxy æ¥å éã</p>
<h2 id="å®è£å®ææç¤º">å®è£å®ææç¤º</h2>
<p>å®è£å®æä¼æä¸ä¸ªæç¤ºï¼è¿ä¹æ¯å¼å¯ Rootless æ¨¡å¼çå³é®å¥å£ï¼</p>
<pre><code class="language-bash">================================================================================

To run Docker as a non-privileged user, consider setting up the
Docker daemon in rootless mode for your user:

    dockerd-rootless-setuptool.sh install

Visit https://docs.docker.com/go/rootless/ to learn about rootless mode.


To run the Docker daemon as a fully privileged service, but granting non-root
users access, refer to https://docs.docker.com/go/daemon-access/

WARNING: Access to the remote API on a privileged Docker daemon is equivalent
         to root access on the host. Refer to the 'Docker daemon attack surface'
         documentation for details: https://docs.docker.com/go/attack-surface/

================================================================================
</code></pre>
<p>æå°±æ¯å¨è¿éå¼å§ä½¿ç¨ rootless æ¨¡å¼çã</p>
<p>æç¤ºæ ¸å¿è§£è¯»ï¼</p>
<ol>
<li>æ¨èéè¿<code>dockerd-rootless-setuptool.sh install</code>å¼å¯ Rootless æ¨¡å¼ï¼è®©æ®éç¨æ·æ  root æéè¿è¡ Dockerï¼</li>
<li>è¥åæ root æéè¿è¡ Dockerï¼å¯åèææ¡£ç»æ®éç¨æ·ææï¼å¦å å¥ docker ç»ï¼ï¼ä½é£é©æ´é«ï¼</li>
<li>éç¹è­¦åï¼æ´é² Docker è¿ç¨ APIï¼å¦ 2375 ç«¯å£ï¼= ç´æ¥å¼æ¾ä¸»æº root æéï¼è¿æ¯æå¡å¨è¢«å¥ä¾µçé«é¢è¯±å ï¼</li>
</ol>
<h2 id="å®è£å¿è¦ä¾èµ">å®è£å¿è¦ä¾èµ</h2>
<p>æç´æ¥è¿è¡ <code>dockerd-rootless-setuptool.sh install</code> çæ¶åï¼æç¤ºè¦ç¼ºä¹ä¾èµ</p>
<pre><code class="language-bash">$ dockerd-rootless-setuptool.sh install
[ERROR] Missing system requirements. Run the following commands to
[ERROR] install the requirements and run this tool again.

########## BEGIN ##########
sudo sh -eux &lt;&lt;EOF
# Install newuidmap &amp; newgidmap binaries
apt-get install -y uidmap
EOF
########## END ##########
</code></pre>
<p>è¾å¥æç¤ºçè¿è¡å½ä»¤ï¼</p>
<pre><code class="language-bash">sudo sh -eux &lt;&lt;EOF
# Install newuidmap &amp; newgidmap binaries
apt-get install -y uidmap
EOF
</code></pre>
<p>å®è£å®æåï¼åæ¬¡æ§è¡ <code>dockerd-rootless-setuptool.sh install</code></p>
<p>ä»¥åæä½ docker æå¡ï¼è¦å ä¸ <code>--user</code></p>
<pre><code class="language-bash">systemctl --user start docker.service
</code></pre>
<h2 id="éç½®">éç½®</h2>
<p>rootless æ¨¡å¼ä¸ï¼</p>
<ul>
<li>ææ Docker å½ä»¤é½è¦å¨<strong>å®è£ Rootless çæ®éç¨æ·</strong>ä¸æ§è¡ï¼ä¸è¦ç¨ rootï¼ï¼</li>
<li>å¦æéå¯æå¡å¨å Docker æ²¡èªå¨å¯å¨ï¼æ§è¡ï¼<code>systemctl --user enable --now docker</code>ï¼</li>
<li>æ°æ®å¤ä»½è¦æ¾ <code>~/.local/share/docker</code> ç®å½ï¼èé <code>/var/lib/docker</code>ï¼ã</li>
</ul>
<h3 id="éåå éå¨">éåå éå¨</h3>
<p>é»è®¤æåµä¸ï¼Rootless Docker çéç½®æä»¶å­æ¾å¨å½åç¨æ·ç <strong>XDG éç½®ç®å½</strong> ä¸ï¼è·¯å¾æ¯ï¼<code>~/.config/docker/daemon.json</code></p>
<pre><code class="language-bash"># ååå»ºç®å½ï¼å¦æä¸å­å¨ï¼
mkdir -p ~/.config/docker

# ç¼è¾éç½®æä»¶ï¼ç¨ nano æ vim é½å¯ä»¥ï¼
nano ~/.config/docker/daemon.json
</code></pre>
<p>éç½®å éå¨</p>
<pre><code class="language-json">{
  "registry-mirrors": ["https://ä½ çé¿éäºéåå éå°å.mirror.aliyuncs.com"],
  "log-driver": "json-file",
  "log-opts": {
    "max-size": "100m",
    "max-file": "3"
  }
}
</code></pre>
<p>æ³¨æï¼ä¹åå¤§é¨åç¨³å®å¥½ç¨çå éå¨é½åæ­¢æå¡äºï¼ç°å¨å°±æ²¡æ³æ¨èå¥ï¼å¤§å®¶åå­æ¬äºå§ã</p>
<h3 id="è§£å³-æ æ³ç»å®-1-1023-ç«¯å£-çé®é¢">è§£å³ âæ æ³ç»å® 1-1023 ç«¯å£â çé®é¢</h3>
<p>éè¦ç»å½åç¨æ· âç»å®ä½ç«¯å£â çæéï¼</p>
<pre><code class="language-bash"># ç»å½åç¨æ·ææç»å® 1-1023 ç«¯å£ï¼ä»å¯¹å½åä¼è¯çæï¼
sudo sysctl net.ipv4.ip_unprivileged_port_start=0

# æ°¸ä¹çæï¼éå¯åä¹ææï¼
echo "net.ipv4.ip_unprivileged_port_start=0" | sudo tee -a /etc/sysctl.conf
sudo sysctl -p  # ç«å³çæ
</code></pre>
<p>æ§è¡åï¼ä½ å°±è½æ­£å¸¸æ å° 80ã443 ç­ç«¯å£äºã</p>
<h3 id="éå¯çæ">éå¯çæ</h3>
<p>Rootless æ¨¡å¼ç Docker éå¯å½ä»¤åç³»ç»çº§ä¸åï¼æ§è¡ï¼</p>
<pre><code class="language-bash"># éå¯å½åç¨æ·ç Docker æå¡
systemctl --user restart docker

# éªè¯éç½®æ¯å¦çæ
docker info
# è½å¨ "Registry Mirrors" é¨åçå°ä½ éç½®çéåå éå°åå°±æ¯æåç
</code></pre>
<p>æ­£å¸¸è¾åºç¤ºä¾ï¼</p>
<pre><code class="language-plaintext">Rootless: true
Registry Mirrors:
 https://ä½ çé¿éäºéåå éå°å.mirror.aliyuncs.com/
</code></pre>
<h3 id="rootless-æ¨¡å¼ä¸æ¯æçéç½®é¡¹">Rootless æ¨¡å¼ä¸æ¯æçéç½®é¡¹</h3>
<p>é¨åç³»ç»çº§éç½®å¨ Rootless ä¸æ æï¼å ä¸ºæ²¡æ root æéï¼ï¼æ¯å¦ï¼</p>
<ul>
<li><code>iptables: false</code>ï¼ç½ç»è§åç± slirp4netns ç®¡çï¼èé iptablesï¼ï¼</li>
<li><code>storage-driver: overlay2</code>ï¼é»è®¤å·²å¯ç¨ï¼æ éæå¨éç½®ï¼ï¼</li>
<li>è¿ç¨ API ç¸å³éç½®ï¼å¦ <code>hosts: ["tcp://0.0.0.0:2375"]</code>ï¼Rootless ä¸ä¸å»ºè®®å¼å¯ï¼ã</li>
<li>ä»»ä½æ¶åç³»ç»çº§ç®å½ï¼å¦<code>/var/run/docker.sock</code>ï¼çéç½®ã</li>
</ul>
<h2 id="volumeé®é¢">volumeé®é¢</h2>
<p>åæ¢å° rootless ä¹åï¼æè¿åç°äº swag ç config æ æ³è¯»åäºã</p>
<p>swag ç compose.yaml éç½®æ¯è¿æ ·ï¼</p>
<pre><code class="language-yaml">services:
  swag:
    image: linuxserver/swag
    container_name: swag
    cap_add:
      - NET_ADMIN
    environment:
      - PUID=1000
      - PGID=1000
    volumes:
      - ./config:/config
</code></pre>
<p><strong>rootless Docker éï¼å®¹å¨åç UID=1000 â  å®¿ä¸»æºç UID=1000</strong></p>
<p>æä»¥ <strong>SWAG å¨å®¹å¨é chown äº <code>/config</code>ï¼å®¿ä¸»æºçå°çæ¯ä¸ä¸ªâæ å°åçéç UIDï¼100999ï¼â</strong></p>
<h3 id="è§£å³æ¹æ³">è§£å³æ¹æ³</h3>
<p>rootless å®æ¹æ¨èä½¿ç¨å½åå·ï¼ä½æè¦ç»å¸¸ä¿®æ¹ config éçæä»¶ï¼è¿ä¸ªè¯å®ä¸ç°å®ã</p>
<p>é£ä¹è¿æä¸ä¸ªæ¹æ³ï¼ä½¿ç¨ ACL æ¾è¡ã</p>
<p>åå®è£ç¸å³å·¥å·ï¼</p>
<pre><code class="language-bash">sudo apt update
sudo apt install -y acl
</code></pre>
<p>å¨ swag ç®å½ä¸æ§è¡</p>
<pre><code class="language-bash">setfacl -m u:ecs-user:rwx config
setfacl -R -m u:ecs-user:rwx config
setfacl -d -m u:ecs-user:rwx config
</code></pre>
<p>éªè¯ï¼</p>
<pre><code class="language-bash">getfacl config | sed -n '1,20p'
</code></pre>
<p>çå°ç±»ä¼¼ï¼</p>
<pre><code>user::rwx
user:ecs-user:rwx
group::r-x
mask::rwx
other::r-x
</code></pre>
<h2 id="å°ç»">å°ç»</h2>
<p>Rootless æ¨¡å¼è½æ¯æ®é Docker éç½®ç¨ç¹çï¼ä½è½ä»æ ¹æ¬ä¸éä½å®¹å¨éé¸é£é©ï¼å°¤å¶éåå¯¹å¤æä¾æå¡ççäº§æå¡å¨ãæ ¸å¿æ»ç»ï¼</p>
<ol>
<li>å®è£ï¼ç»åæ¸åéåæºè§£å³å½åä¸è½½é®é¢ï¼ä¼åç¨æ®éç¨æ·å®è£ Rootless æ¨¡å¼ï¼</li>
<li>æéï¼ç¦æ­¢æ´é² Docker è¿ç¨ APIï¼ç»æ®éç¨æ·ææä½ç«¯å£ç»å®æéå³å¯æ»¡è¶³æ¥å¸¸ä½¿ç¨ï¼</li>
<li>éç½®ï¼ç¢è®° Rootless æ¨¡å¼çéç½®æä»¶ãæ°æ®ç®å½åå¨ç¨æ·ç®å½ä¸ï¼ä¸ç³»ç»çº§ Docker åºåå¼ï¼</li>
<li>å®å¨ï¼å³ä¾¿å¼å¯ Rootlessï¼è¿è¡å®¹å¨æ¶ä»éæ³¨ææå¡å®å¨ï¼å¦ Redis å å¯ç ãå®å¨ç»éå¶ç«¯å£è®¿é®ï¼ã</li>
</ol>
<p>æ­¤æ¬¡è¸©åè®©ææ·±å»æè¯å°ï¼æå¡å¨å®å¨æ å°äºï¼åªææ¯ Docker è¿æ ·çåºç¡å·¥å·ï¼ä¹éä»æéå±é¢åå¥½æå°åç®¡æ§ï¼æè½é¿åè¢«æç¿æ¨é©¬ç­æ¶æç¨åºè¶èèå¥ã</p>


</div>
<div id="MySignature" role="contentinfo">
    å¾®ä¿¡å¬ä¼å·ï¼ãç¨åºè®¾è®¡å®éªå®¤ã
ä¸æ³¨äºäºèç½ç­é¨æ°ææ¯æ¢ç´¢ä¸å¢éææ·å¼åå®è·µï¼åæ¬æ¶æè®¾è®¡ãæºå¨å­¦ä¹ ä¸æ°æ®åæç®æ³ãç§»å¨ç«¯å¼åãLinuxãWebååç«¯å¼åç­ï¼æ¬¢è¿ä¸èµ·æ¢è®¨ææ¯ï¼åäº«å­¦ä¹ å®è·µç»éªã
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-20 20:46">2026-02-20 20:45</span>&nbsp;
<a href="https://www.cnblogs.com/deali">ç¨åºè®¾è®¡å®éªå®¤</a>&nbsp;
éè¯»(<span id="post_view_count">19</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19626849);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19626849', targetLink: 'https://www.cnblogs.com/deali/p/19626849', title: 'ä»æç¿æ¨é©¬å¥ä¾µå° Docker Rootless å åºï¼æçæå¡å¨å®å¨å¤ç' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ææææä½ ä½¿ç¨vscodeå¼åstm32ï¼ ]]></title>
    <link>https://www.cnblogs.com/chenyouyuan/p/19626759</link>
    <guid>c28d5d93a9836afb6e876ed9ea253a63</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/chenyouyuan/p/19626759" title="åå¸äº 2026-02-20 19:31">
    <span role="heading" aria-level="2">ææææä½ ä½¿ç¨vscodeå¼åstm32ï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        å·²ç»2026å¹´äºï¼ä½ æ¯å¦è¿å¨ä½¿ç¨å¤èçkeil5çè°è¯å¢ï¼æ¯å¦è¿å¨ä¸ºkeil5å¤å¶ç²è´´ä»£ç å°èå¤©å¼aiåç²è´´åæ¥èç¦æ¼å¢ï¼å¿«å¿«å å¥vscodeå¼åstm32çå¤§é¨éæ¥ååè£çè¿åå§ï¼
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="å¼åå·¥å·éç½®ç¯è¿æ¥æ°æ¶ä»£--ä½¿ç¨vscodeå¼åstm32">å¼åå·¥å·éç½®ç¯ï¼è¿æ¥æ°æ¶ä»£--ä½¿ç¨vscodeå¼åstm32</h1>
<blockquote>
<p>å·²ç»2026å¹´äºï¼ä½ æ¯å¦è¿å¨ä½¿ç¨å¤èçkeil5çè°è¯å¢ï¼æ¯å¦è¿å¨ä¸ºkeil5å¤å¶ç²è´´ä»£ç å°èå¤©å¼aiåç²è´´åæ¥èç¦æ¼å¢ï¼å¿«å¿«å å¥vscodeå¼åstm32çå¤§é¨éæ¥ååè£çè¿åå§ï¼</p>
</blockquote>
<p></p><div class="toc"><div class="toc-container-header">ç®å½</div><ul><li><a href="#å¼åå·¥å·éç½®ç¯è¿æ¥æ°æ¶ä»£--ä½¿ç¨vscodeå¼åstm32" rel="noopener nofollow">å¼åå·¥å·éç½®ç¯ï¼è¿æ¥æ°æ¶ä»£--ä½¿ç¨vscodeå¼åstm32</a><ul><li><a href="#åè¨" rel="noopener nofollow">åè¨</a></li><li><a href="#ææä¾èµçè½¯ä»¶ç¾åº¦ç½çé¾æ¥ä»¥åéå¥bç«æææè®²è§£è§é¢" rel="noopener nofollow">ææä¾èµçè½¯ä»¶ç¾åº¦ç½çé¾æ¥ä»¥åéå¥bç«æææè®²è§£è§é¢</a></li><li><a href="#ä¸ä¸è½½cubemxä»¥åå¯¹åºstm32çhalåº" rel="noopener nofollow">ä¸ãä¸è½½cubemxä»¥åå¯¹åºstm32çhalåº</a></li><li><a href="#äºä¸è½½vscodeä»¥åæä»¶" rel="noopener nofollow">äºãä¸è½½vscodeä»¥åæä»¶</a><ul><li><a href="#stm32-for-vscode" rel="noopener nofollow">stm32 for vscode</a></li><li><a href="#makefiel" rel="noopener nofollow">makefiel</a></li></ul></li><li><a href="#ä¸stlinké©±å¨å®è£" rel="noopener nofollow">ä¸ãstlinké©±å¨å®è£</a></li><li><a href="#å-éç½®å¼åç¯å¢" rel="noopener nofollow">åã éç½®å¼åç¯å¢</a><ul><li><a href="#éç½®ç¯å¢åé" rel="noopener nofollow">éç½®ç¯å¢åé</a></li><li><a href="#å³äºlaunchjsonæä»¶" rel="noopener nofollow">å³äºlaunch.jsonæä»¶</a></li><li><a href="#å³äºtasksjsonæä»¶" rel="noopener nofollow">å³äºtasks.jsonæä»¶</a></li></ul></li><li><a href="#å¼å§è°è¯" rel="noopener nofollow">å¼å§è°è¯</a><ul><li><a href="#stm32-svdæä»¶" rel="noopener nofollow">stm32 svdæä»¶</a></li></ul></li></ul></li></ul></div><p></p>
<p>æ¬ç¯æç« ä¸»è¦åèæ¹åå¤§å­¦robomasterè·é¹¿æéççµæ§å¼æºé¨å</p>
<p><a href="https://gitee.com/hnuyuelurm/basic_framework/blob/master/.Doc/VSCode+Ozone%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95.md" target="_blank" rel="noopener nofollow">.Doc/VSCode+Ozoneä½¿ç¨æ¹æ³.md Â· HNUYueLuRM/basic_framework - Gitee.com</a></p>
<h2 id="åè¨">åè¨</h2>
<p>æ¬ç¯æç« ä¸»è¦ä½¿ç¨vscode + cubemxå¹³æ¿keil5ï¼å®ç°å¿«éå¼åãå®æ¶å¯è§ååéï¼å¨å±ï¼ãå¯ä»¥æ¥çå¯å­å¨åå®¹ãcopilotè¾å©å¼å....</p>
<p>æ¯æstlinkï¼jlinkï¼daplinkè°è¯å¨ï¼ææ¶æ²¡ææ¾å°çº¯é vscodeçå®æ¶å¯è§ååæ°æ³¢å½¢å¾åè½çæä»¶</p>
<p>å¦æå¤§å®¶è¿æå¶ä»å¥½ç¨çæ¹æ¡æ¬¢è¿è®¨è®ºå¢~</p>
<h2 id="ææä¾èµçè½¯ä»¶ç¾åº¦ç½çé¾æ¥ä»¥åéå¥bç«æææè®²è§£è§é¢">ææä¾èµçè½¯ä»¶ç¾åº¦ç½çé¾æ¥ä»¥åéå¥bç«æææè®²è§£è§é¢</h2>
<p>å¯è½ç½ç»åå å¯¼è´ä¸äºå®è£æ æ³å®æï¼æä»¥è¿è¾¹æä¾æç¨å°çææåï¼æ ¹æ®éè¦å®è£å³å¯<br>
éè¿ç½çåäº«çæä»¶ï¼all_in_one.zip<br>
é¾æ¥: <a href="https://pan.baidu.com/s/12brC2bPmu9wWa2h-VgIZmg?pwd=9xah" target="_blank" rel="noopener nofollow">https://pan.baidu.com/s/12brC2bPmu9wWa2h-VgIZmg?pwd=9xah</a> æåç : 9xah<br>
--æ¥èªç¾åº¦ç½çè¶çº§ä¼åv3çåäº«<br>
bç«è§é¢é¾æ¥<br>
<a href="https://www.bilibili.com/video/BV1ZMfGBrEFy/?vd_source=f553a12b04c16a678ddc0064cc04563c" target="_blank" rel="noopener nofollow">https://www.bilibili.com/video/BV1ZMfGBrEFy/?vd_source=f553a12b04c16a678ddc0064cc04563c</a></p>
<h2 id="ä¸ä¸è½½cubemxä»¥åå¯¹åºstm32çhalåº">ä¸ãä¸è½½cubemxä»¥åå¯¹åºstm32çhalåº</h2>
<p>cubemxå®ç½(éè¦ç®åçæ³¨åå³å¯)ï¼</p>
<p><a href="https://www.st.com/en/development-tools/stm32cubemx.html#get-software" target="_blank" rel="noopener nofollow">https://www.st.com/en/development-tools/stm32cubemx.html#get-software</a></p>
<p>ä¸è½½å®æä¹åç¹å»</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220181610339.png" alt="" loading="lazy"></p>
<p>ç´æ¥å¨æç´¢æ æç´¢ä½ ä½¿ç¨çstm32çåå·ï¼ä»¥f103ä½ä¸ºä¾å­</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220181746320.png" alt="image-20260220181746320" loading="lazy"></p>
<p>åå»è¦éæ©çæ¿å­å³å¯è¿å¥</p>
<p>å¶ä½è¯¦ç»çéç½®å¯ä»¥åèå¶ä»æç¨</p>
<p>ä¸»è¦æ³¨æçæ¯ï¼</p>
<p>sysçéç½®è¦éç½®æswæ¨¡å¼ï¼ä¸ç¶ä¼åªè½ç§å½ä¸æ¬¡</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220181938762.png" alt="image-20260220181938762" loading="lazy"></p>
<p>å¯¼åºè¿è¾¹éæ©makefile</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220182046638.png" alt="image-20260220182046638" loading="lazy"></p>
<h2 id="äºä¸è½½vscodeä»¥åæä»¶">äºãä¸è½½vscodeä»¥åæä»¶</h2>
<p>vscodeå®ç½ï¼</p>
<p><a href="https://www.st.com/en/development-tools/stm32cubemx.html#get-software" target="_blank" rel="noopener nofollow">https://www.st.com/en/development-tools/stm32cubemx.html#get-software</a></p>
<p>éè¦å®è£çvscdoeæä»¶ï¼</p>
<p>ç¹å»vscodeå·¦ä¾§çè¿ä¸ªå¾æ </p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220174816604.png" alt="image-20260220174816604" loading="lazy"></p>
<h3 id="stm32-for-vscode">stm32 for vscode</h3>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220160002646.png" alt="image-20260220160002646" loading="lazy"></p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220155925565.png" alt="image-20260220155925565" loading="lazy"></p>
<p>ç¹å»install build tools</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220175156853.png" alt="image-20260220175156853" loading="lazy"></p>
<p>åºç°å¦ä¸é¡µé¢å³ä»£è¡¨å®è£æåï¼å¤§çº¦5~15åéï¼</p>
<p>å¦æç½ç»ä¸å¥½å£è¯­åæ¢ææºç­ç¹åæ¬¡å°è¯</p>
<p>è¿ä¸è¡å°±ç´æ¥ä½¿ç¨æçç¾åº¦ç½çåäº«çzipåç¼©åï¼å»ºè®®æ¾å°dçï¼å¦ææçè¯ï¼</p>
<h3 id="makefiel">makefiel</h3>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220155854381.png" alt="image-20260220155854381" loading="lazy"></p>
<h2 id="ä¸stlinké©±å¨å®è£">ä¸ãstlinké©±å¨å®è£</h2>
<p>å¦æä½ ä¹åæ²¡æä½¿ç¨è¿stlinkï¼è¯·æ ¹æ®å¦ä¸é¾æ¥å®æstlinké©±å¨çå®è£</p>
<p><a href="https://www.st.com.cn/zh/development-tools/stsw-link009.html" target="_blank" rel="noopener nofollow">STSW-LINK009 | Software - ææ³åå¯¼ä½</a><br>
æ ¹æ®èªå·±ççµèéç½®åå»ä»¥ä¸ä¸¤ä¸ªexeä¸­çä¸ä¸ª</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220184946316.png" alt="image-20260220184946316" loading="lazy"></p>
<h2 id="å-éç½®å¼åç¯å¢">åã éç½®å¼åç¯å¢</h2>
<h3 id="éç½®ç¯å¢åé">éç½®ç¯å¢åé</h3>
<ol>
<li>
<p>å¨vscodeæ¾å°æå·¦è¾¹çåä¸ªæ¹åå¾æ ï¼è¿éæ¯æä»¬å®è£æå±çå°æ¹</p>
<p>ç¹å»ä¹åæ¾å°stm32 for vscode</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220174706404.png" alt="image-20260220174706404" loading="lazy"></p>
</li>
<li>
<p>æå¼è¯¦æé¡µé¢--&gt;ç¹å»å³ä¸è§èè²çç¼å­æå­ï¼æå¼ç¼å­æä»¶å¤¹</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220175025884.png" alt="image-20260220175025884" loading="lazy"></p>
<p>ç¼å­æä»¶å¤¹å¦ä¸</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220175310991.png" alt="image-20260220175310991" loading="lazy"></p>
</li>
<li>
<p>è¿å¥@å¼å¤´çæä»¶å¤¹,å¦ä¸ï¼æä»¬ä¸ºäºæ¹ä¾¿ï¼æè¯¥æä»¶å¤¹ä¸é¢ææçä¸è¥¿è¿ç§»å°Dçï¼å¦ææçè¯ï¼ï¼å¨Dçç®å½ä¸æ°å»ºä¸ä¸ªæä»¶å¤¹å«stm32toolsï¼ææä»¶å¨é¨æ¾è¿å»</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220175354956.png" alt="image-20260220175354956" loading="lazy"></p>
<p>è¿ç§»è·¯å¾å¦ä¸å¾ï¼å ä¸ºè¿ä¸ªæ¼ç¤ºçæºå¨æ²¡æådçï¼æå°±æ¾å°cçäºï¼</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220175533984.png" alt="image-20260220175533984" loading="lazy"></p>
</li>
<li>
<p>æ¥ä¸æ¥æä¸winé®ï¼å¨æç´¢æ æç´¢ç¯å¢</p>
<p>ç¹å»ç¼è¾ç³»ç»ç¯å¢åé</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220174138545.png" alt="" loading="lazy"></p>
<p>ç¹å»æä¸é¢çç¯å¢åéï¼Nï¼</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220174230783.png" alt="image-20260220174230783" loading="lazy"></p>
<p>åå»path</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220174323481.png" alt="image-20260220174323481" loading="lazy"></p>
<p>ç¹å»å³è¾¹çæ°å»ºå³å¯æ°å»ºåéï¼ctrl+vç²è´´ä¸ä¸ªbinçè·¯å¾ï¼å¦ä¸å¾ï¼æ ¹æ®èªå·±çæä»¶ä½ç½®æ¥</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220174405199.png" alt="image-20260220174405199" loading="lazy"></p>
</li>
</ol>
<p>éç½®å®æä¹åwin + r</p>
<p>å¨å¼¹åºççªå£è¾å¥cmdï¼åè½¦</p>
<p>ç²è´´å¦ä¸æä»¤è¿è¡</p>
<pre><code class="language-cmd">arm-none-eabi-gcc -v
</code></pre>
<p>å¦æåºç°ç±»ä¼¼ä¸å¾è¾åºï¼å°±ä»£è¡¨æå</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220180204385.png" alt="image-20260220180204385" loading="lazy"></p>
<ol start="5">
<li>
<p>æå¼vscode è¿å¥å°é¡¹ç®æä»¶å¤¹ï¼åé¢åå»ºçcubemxé¡¹ç®æä»¶å¤¹ï¼</p>
</li>
<li>
<p>ctrl + ï¼æå¼è®¾ç½®ï¼æç´¢stm32 for vscode<br>
<img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220184204803.png" alt="image-20260220184204803" loading="lazy"><br>
ç¹å»å¨settings.jsonä¸­ç¼è¾,å®åå¦ä¸è·¯å¾</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220184315477.png" alt="image-20260220184315477" loading="lazy"><br>
settings.json(æ ¹æ®èªå·±çè·¯å¾éç½®)</p>
<pre><code class="language-json">{
    "stm32-for-vscode.openOCDPath": "C:\\stm32tools\\openocd\\0.12.0-7.1\\.content\\bin\\openocd.EXE",
    "stm32-for-vscode.makePath": "C:\\stm32tools\\windows-build-tools\\4.4.1-3.1\\.content\\bin\\make.EXE",
    "stm32-for-vscode.armToolchainPath": "C:\\stm32tools\\arm-none-eabi-gcc\\14.2.1-1.1.1\\.content\\bin",
    "makefile.configureOnOpen": true,
    "cortex-debug.stm32cubeprogrammer": "",
    "cortex-debug.openocdPath": "C:\\stm32tools\\openocd\\0.12.0-7.1\\.content\\bin\\openocd.EXE",
    "cortex-debug.armToolchainPath": "C:\\stm32tools\\arm-none-eabi-gcc\\14.2.1-1.1.1\\.content\\bin",
}
</code></pre>
</li>
<li>
<p>ctrl + ~</p>
<p>å¨ç»ç«¯è¾å¥make -j12 æµè¯ççè½å¦æåç¼è¯,å¦ä¸å¾å³ä»£è¡¨æåç¼è¯</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220182335492.png" alt="image-20260220182335492" loading="lazy"></p>
</li>
</ol>
<h3 id="å³äºlaunchjsonæä»¶">å³äºlaunch.jsonæä»¶</h3>
<p>å¨å·¦è¾¹æ æ¾å°è¿ä¸ªå¾æ </p>
<p><img alt="" loading="lazy"></p>
<p>ç¹å»ä¸ä¸éé¢çåå»ºlaunchæä»¶</p>
<p>å°±å¯ä»¥å¨ç®å½ç.vscodeæä»¶å¤¹ä¸æ¾å°</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220160146084.png" alt="image-20260220160146084" loading="lazy"></p>
<p>æä»¬ç´æ¥å¤å¶ä¸é¢æä¿®æ¹å¥½çstlinkçä»£ç ï¼daplinkãjlinkæ¹å¤§å¼æºçgiteeä»åºå·²ç»æä¾ï¼</p>
<pre><code class="language-json">{
    // å¯å¨è°è¯çå¿«æ·é®æ¯F5
    "version": "0.2.0",
    "configurations": [
        // ä½¿ç¨dap-link(å¦æ çº¿è°è¯å¨æ¶çåèéç½®)
        {
            "name": "STlink",
            "cwd": "${workspaceRoot}",
            "executable": "${workspaceRoot}\\build\\first.elf", // è¦ä¸è½½å°è°è¯å¨çæä»¶,è±æ¬å·ä¸­çæ¯vscodeä¸¤ä¸ªé¢å®ä¹çåæ°
            "request": "launch",
            "type": "cortex-debug",
            //ä½¿ç¨J-link GDB Serveræ¶å¿é¡»;å¶ä»GBD Serveræ¶å¯éï¼æå¯è½å¸®å©èªå¨éæ©SVDæä»¶ï¼
            //æ¯æçè®¾å¤è§ https://www.segger.com/downloads/supported-devices.php
            //svdæä»¶ï¼æè¿ä¸ªæä»¶æè½æ¥çå¯å­å¨çå¼ï¼æ¯ä¸ªåçæºé½ä¸åãå¯ä»¥å¨ä»¥ä¸å°åæ¾å°https://github.com/modm-io/cmsis-svd-stm32 
            //è¯¥é¡¹ç®çæ ¹ç®å½å·²ç»æä¾äºCåå¼åæ¿ä½¿ç¨çå¤è®¾svdæä»¶
            "svdFile": "./STM32F103.svd",
            "servertype": "openocd", //ä½¿ç¨çGDB Server
            "configFiles": [
                "openocd_stlink.cfg", // éç½®æä»¶å·²ç»å¨æ ¹ç®å½æä¾,è¥è¦ä¿®æ¹ä»¥æ­¤ç±»æ¨,openocdçè·¯å¾ä¸çshare/scriptsä¸­æåç§åå¥½çéç½®æä»¶
            ],
            "runToEntryPoint": "main", // è°è¯æ¶å¨mainå½æ°å¥å£åä¸
            "preLaunchTask": "build task",//åè¿è¡Buildä»»å¡ç¼è¯é¡¹ç®,åæ¶æ³¨éå³å¯ä½¿ç¨
            "liveWatch": {
                "enabled": true,
                "samplesPerSecond": 4
            }
        },
      
    ],
}
</code></pre>
<p>éç½®å®æä¹åå¨vscodeçå·¦ä¾§debugå¾æ å³å¯çå°æ´æ¹éç½®çstlinkçéç½®<br>
<img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220184555431.png" alt="image-20260220184555431" loading="lazy"></p>
<h3 id="å³äºtasksjsonæä»¶">å³äºtasks.jsonæä»¶</h3>
<p>ä½ç½®ä¸launchæä»¶ä¸æ ·ï¼æ²¡æå°±æ°å»ºä¸ä¸ª</p>
<pre><code class="language-json">{
    // See https://go.microsoft.com/fwlink/?LinkId=733558
    "version": "2.0.0",
    "tasks": [
        {
            "label": "build task",         // ä»»å¡æ ç­¾
            "type": "shell",               // ä»»å¡ç±»å,å ä¸ºè¦è°ç¨mingw32-make,æ¯å¨ç»ç«¯(CMD)éè¿è¡ç,æä»¥æ¯shellä»»å¡
            "command": "make -j24",// ä»»å¡å½ä»¤,çº¿ç¨æ°å¯ä»¥æ ¹æ®èªå·±ççµèä¿®æ¹,å»ºè®®ä¸cpuæ ¸æ°ç¸å
            "problemMatcher": [],          
            "group": {
                "kind": "build",
                "isDefault": true
            }
        },
        {
            "label": "download dap",
            "type": "shell",               // å¦æå¸æå¨ä¸è½½åç¼è¯,å¯ä»¥æcommandæ¢æä¸é¢çå½ä»¤
            "command":"make -j24 ; make download_dap", // "mingw32-make -j24 ; mingw32-make download_dap",
            "group": {                     // å¦ææ²¡æä¿®æ¹ä»£ç ,ç¼è¯ä»»å¡ä¸ä¼æ¶èæ¶é´,å æ­¤æ¨èä½¿ç¨ä¸é¢çæ¿æ¢.
                "kind": "build",
                "isDefault": false,
            },
        },
        {
            "label": "download jlink", // è¦ä½¿ç¨æ­¤ä»»å¡,éæ·»å jlinkçç¯å¢åé
            "type": "shell",
            "command":"make -j24 ; make download_jlink", // "mingw32-make -j24 ; mingw32-make download_jlink"
            "group": {
                "kind": "build",
                "isDefault": false,
            }
        },
        {
            "label": "log",
            "type": "shell",
            "command":"JlinkRTTClient",
            "args": [],
            "problemMatcher": [],
            // "dependsOn":[
            //     "build task", // å¯ä»¥æ·»å å¤ä¸ª.
            // ]
            // è¥ä½¿ç¨daplink,åå°logä»»å¡è®¾ç½®ä¸ºä¾èµäºjlink launchä»»å¡,ä¿è¯jlink launchä»»å¡åäºlogä»»å¡æ§è¡
        }
    ]
}
</code></pre>
<h2 id="å¼å§è°è¯">å¼å§è°è¯</h2>
<p>å°æ­¤éç½®åºå½å·²ç»å®æäºï¼æ¥å¥½stlinkï¼è¿æ¥å¥½stm32åå°±å¯ä»¥æå¿«çè°è¯å¦ï¼ç¹å»ç»¿è²çä¸è§å½¢å¼å§ç¼è¯å¹¶ç§å½å°åçæº<br>
<img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220184555431.png" alt="image-20260220184555431" loading="lazy"></p>
<p>ç­å¾ä¸ä¼åï¼å°±ä¼åºç°ä¸å¾æç¤ºçè°è¯çé¢<br>
<img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220185452486.png" alt="image-20260220185452486" loading="lazy"><br>
å¨å·¦ä¾§å°±æ¯è°è¯å¸¸ç¨çä¸äºå·¥å·<br>
<img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220185552784.png" alt="image-20260220185552784" loading="lazy"></p>
<p>cortex live watchå¯ä»¥å®æ¶æ¥çå¨å±åéçå¼ï¼åªéè¦ç¹å»å å·<br>
<img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220185701085.png" alt="image-20260220185701085" loading="lazy"></p>
<p>ç²è´´éè¦æ¥ççåéåç§°</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220185726335.png" alt="image-20260220185726335" loading="lazy"></p>
<p>å°±å¯ä»¥å®æ¶æ¥çå°åéçå¼å¦</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220185758953.png" alt="image-20260220185758953" loading="lazy"></p>
<p>ä»å·¦å°å³ ç¬¬ä¸ä¸ªæ¯éç½®resetï¼æåï¼éè¿ç¨ï¼åæ­¥ï¼åæ­¥è·³åºï¼éæ°å¼å§è°è¯ï¼éåº</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220185836594.png" alt="image-20260220185836594" loading="lazy"></p>
<p>XPERIPHERALSå¿é¡»éç½®ä¸é¢çsvdæä»¶æè½å¤çå°å¯å­å¨åé¨çå¼</p>
<p><img src="http://tuchuang-cyy.oss-cn-beijing.aliyuncs.com/img/image-20260220190044929.png" alt="image-20260220190044929" loading="lazy"></p>
<p>ä½ ä¹å¯ä»¥ä¼éçä½¿ç¨copilotå·¥å·æ´å¿«éçå¼åstm32å¦</p>
<h3 id="stm32-svdæä»¶">stm32 svdæä»¶</h3>
<p>stmç³»åsvdä»åºï¼</p>
<p><a href="https://github.com/modm-io/cmsis-svd-stm32" target="_blank" rel="noopener nofollow">modm-io/cmsis-svd-stm32: CMSIS SVD files for all STM32 devices</a></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.004166666666666667" data-date-updated="2026-02-20 19:37">2026-02-20 19:31</span>&nbsp;
<a href="https://www.cnblogs.com/chenyouyuan">ChenYY~</a>&nbsp;
éè¯»(<span id="post_view_count">42</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19626759);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19626759', targetLink: 'https://www.cnblogs.com/chenyouyuan/p/19626759', title: 'ææææä½ ä½¿ç¨vscodeå¼åstm32ï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>