<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-02-02T08:38:33.319Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ ãé¢è¯é¢ãMySQL ä¸­ count(*)ãcount(1) å count(å­æ®µå) æä»ä¹åºå«ï¼ ]]></title>
    <link>https://www.cnblogs.com/sun-10387834/p/19452600</link>
    <guid>8623fe991e88bdfb40376c9d2b25dacc</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/sun-10387834/p/19452600" title="åå¸äº 2026-02-02 16:25">
    <span role="heading" aria-level="2">ãé¢è¯é¢ãMySQL ä¸­ count(*)ãcount(1) å count(å­æ®µå) æä»ä¹åºå«ï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="mysql-ä¸­ç-count-ä¸åå¼æçå¤§æ¯æ¼">MySQL ä¸­ç count ä¸åå¼ï¼æçå¤§æ¯æ¼ï¼ð</h1>
<h2 id="ä¸å¿«éç»è®ºåçç»è®ºåçåæ">ä¸ãå¿«éç»è®ºï¼åçç»è®ºåçåæï¼</h2>
<table>
<thead>
<tr>
<th>æ¹å¼</th>
<th>ä½ç¨</th>
<th>æç</th>
<th>ä¸å¥è¯æ»ç»</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>count(*)</code></td>
<td><strong>ç»è®¡ææè¡æ°</strong></td>
<td>â­â­â­â­ <strong>æé«</strong></td>
<td>ææ¯ä¸ä¸çï¼æä¸ºç»è®¡èç</td>
</tr>
<tr>
<td><code>count(1)</code></td>
<td>ç»è®¡ææè¡æ°</td>
<td>â­â­â­â­ åæ ·é«æ</td>
<td>ææ¯ count(*) çé©¬ç²åå¼</td>
</tr>
<tr>
<td><code>count(åå)</code></td>
<td>ç»è®¡è¯¥å<strong>é NULL</strong> çè¡æ°</td>
<td>â­â­â­ è¾æ¢</td>
<td>ææåï¼æåªæ°éç©ºå¼</td>
</tr>
</tbody>
</table>
<p><strong>ç»è®ºï¼ç¨ <code>count(*)</code> å°±å¯¹äºï¼</strong> â</p>
<h2 id="äºä»£ç ç¤ºä¾äº²æµä¸åå¼çå·®å«">äºãä»£ç ç¤ºä¾ï¼äº²æµä¸åå¼çå·®å«</h2>
<h3 id="åå¤æµè¯æ°æ®">åå¤æµè¯æ°æ®</h3>
<pre><code class="language-sql">-- åå»ºæµè¯è¡¨
CREATE TABLE user_test (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50),
    age INT,
    email VARCHAR(100)
);

-- æå¥æµè¯æ°æ®ï¼æææå¥ä¸äºNULLå¼ï¼
INSERT INTO user_test (name, age, email) VALUES
('å¼ ä¸', 25, 'zhangsan@example.com'),
('æå', NULL, NULL),
('çäº', 30, 'wangwu@example.com'),
(NULL, 28, 'unknown@example.com'),
('èµµå­', 35, NULL);
</code></pre>
<h3 id="æµè¯æ¥è¯¢">æµè¯æ¥è¯¢</h3>
<pre><code class="language-sql">-- æ¥çè¡¨ä¸­çæ°æ®
SELECT * FROM user_test;
/*
+----+--------+------+--------------------+
| id | name   | age  | email              |
+----+--------+------+--------------------+
|  1 | å¼ ä¸   |   25 | zhangsan@example...|
|  2 | æå   | NULL | NULL               |
|  3 | çäº   |   30 | wangwu@example.com |
|  4 | NULL   |   28 | unknown@example.com|
|  5 | èµµå­   |   35 | NULL               |
+----+--------+------+--------------------+
*/

-- æµè¯1ï¼count(*) ç»è®¡ææè¡æ°
SELECT count(*) FROM user_test;  -- ç»æï¼5 â
-- ç¿»è¯ï¼"èæ¿ï¼ææå¤å°è¡æ°æ®ï¼å¨é½è¦ï¼"

-- æµè¯2ï¼count(1) ç»è®¡ææè¡æ°  
SELECT count(1) FROM user_test;  -- ç»æï¼5 â
-- ç¿»è¯ï¼"èæ¿ï¼ä½ ç»æä¸ªåºå®å¼1ï¼ææ°æå¤å°ä¸ª1"

-- æµè¯3ï¼count(åå) ç»è®¡éNULLçè¡æ°
SELECT count(name) FROM user_test;  -- ç»æï¼4 âï¼NULLçé£è¡æ²¡ç®ï¼
SELECT count(age) FROM user_test;   -- ç»æï¼4 âï¼NULLçé£è¡æ²¡ç®ï¼
SELECT count(email) FROM user_test; -- ç»æï¼3 âï¼ä¸¤ä¸ªNULLé½æ²¡ç®ï¼
-- ç¿»è¯ï¼"æåªæ°æèº«ä»½è¯çäººï¼é»æ·ä¸ç®"
</code></pre>
<h2 id="ä¸æ·±å¥åæå®ä»¬å°åºæå¥ä¸å">ä¸ãæ·±å¥åæï¼å®ä»¬å°åºæå¥ä¸åï¼</h2>
<h3 id="1-è¯­ä¹åºå«æéè¦çåºå«">1. <strong>è¯­ä¹åºå«ï¼æéè¦çåºå«ï¼ï¼</strong></h3>
<pre><code class="language-sql">-- count(*) æ¯ SQL æ ååæ³
-- ææï¼ç»æè¿ä¸ªè¡¨æå¤å°è¡æ°æ®
-- ç¸å½äºï¼"è¿ä¸ªä¼è®®å®¤æå¤å°ä¸ªåº§ä½ï¼"

-- count(1) æ¯ count(*) çä¸ç§åæ³
-- ææï¼ç»è®¡æå¤å°ä¸ª1
-- ç¸å½äºï¼"ç»æ¯ä¸ªåº§ä½åä¸ªè¹æï¼æåæ°è¹æ"

-- count(åå) æ¯ç»è®¡è¯¥åéNULLå¼çæ°é
-- ææï¼è¿ä¸ªä¼è®®å®¤æå¤å°äººå¸¦äºææº
-- ç¸å½äºï¼"æ£æ¥æ¯ä¸ªåº§ä½ï¼å¦ææäººå¸¦äºææºå°±è®¡æ°"
</code></pre>
<h3 id="2-æ§è½åºå«ç¥è¯ä¸ç°å®">2. <strong>æ§è½åºå«ï¼ç¥è¯ä¸ç°å®ï¼</strong></h3>
<h4 id="ä¼ è¯´ä¸­çè¯¯è§£">ä¼ è¯´ä¸­çè¯¯è§£ï¼</h4>
<blockquote>
<p>"count(1) æ¯ count(*) å¿«" â<br>
"count(ä¸»é®) æå¿«" â</p>
</blockquote>
<h4 id="ç°å®çç¸">ç°å®çç¸ï¼</h4>
<p><strong>MySQL 5.7 åä»¥åçæ¬</strong>ï¼</p>
<ul>
<li><code>count(*)</code> å <code>count(1)</code> æ§è½<strong>å®å¨ç¸å</strong></li>
<li>MySQL ä¼åå¨ä¼æå®ä»¬å½ä½ä¸åäº</li>
</ul>
<p><strong>æ¥çæ§è¡è®¡åè¯æ</strong>ï¼</p>
<pre><code class="language-sql">EXPLAIN SELECT count(*) FROM user_test;
EXPLAIN SELECT count(1) FROM user_test;
EXPLAIN SELECT count(id) FROM user_test;
-- ä½ ä¼çå°ï¼åä¸¤ä¸ªçæ§è¡è®¡åå®å¨ä¸æ ·ï¼
</code></pre>
<p><strong>æ§è½æåº</strong>ï¼ä¸è¬æåµï¼ï¼</p>
<ol>
<li><code>count(*)</code> â <code>count(1)</code> â­â­â­â­â­</li>
<li><code>count(ä¸»é®å)</code> â­â­â­â­</li>
<li><code>count(éä¸»é®æç´¢å¼å)</code> â­â­â­</li>
<li><code>count(éä¸»é®æ ç´¢å¼å)</code> â­â­</li>
</ol>
<p><strong>ä¸ºä»ä¹ <code>count(åå)</code> å¯è½æ´æ¢ï¼</strong></p>
<pre><code class="language-sql">-- åè®¾ email åæç´¢å¼
SELECT count(email) FROM user_test;
/*
MySQL éè¦ï¼
1. è¯»åç´¢å¼ï¼å¦æè¯¥åæç´¢å¼ï¼
2. æ£æ¥æ¯ä¸ªå¼æ¯å¦ä¸º NULL
3. åªè®¡æ°é NULL ç

å¦æ email åæ²¡æç´¢å¼ï¼
1. è¯»åæ´è¡æ°æ®ï¼æ¯ count(*) è¯»çæ´å¤ï¼
2. æ£æ¥ email æ¯å¦ä¸º NULL
3. åªè®¡æ°é NULL ç
*/
</code></pre>
<h3 id="3-ç¹æ®æåµåæ">3. <strong>ç¹æ®æåµåæ</strong></h3>
<pre><code class="language-sql">-- æåµ1ï¼ææåé½ä¸åè®¸NULL
CREATE TABLE user_not_null (
    id INT PRIMARY KEY NOT NULL,
    name VARCHAR(50) NOT NULL
);
-- è¿æ¶åï¼count(*) = count(id) = count(name)

-- æåµ2ï¼ç©ºè¡¨ vs NULLå¼
CREATE TABLE empty_table (id INT);
SELECT count(*) FROM empty_table;    -- ç»æï¼0
SELECT count(id) FROM empty_table;   -- ç»æï¼0

INSERT INTO empty_table VALUES (NULL);
SELECT count(*) FROM empty_table;    -- ç»æï¼1
SELECT count(id) FROM empty_table;   -- ç»æï¼0 â
</code></pre>
<h2 id="åå®éå·¥ä½ä¸­çéæ©æå">åãå®éå·¥ä½ä¸­çéæ©æå</h2>
<h3 id="-åºæ¯1ç»è®¡æ»è¡æ°">ð¯ <strong>åºæ¯1ï¼ç»è®¡æ»è¡æ°</strong></h3>
<pre><code class="language-sql">-- â æ­£ç¡®åæ³
SELECT count(*) FROM orders;

-- â éè¯¯åæ³
SELECT count(order_id) FROM orders;  -- ä¸ä¸æNULLå¢ï¼
SELECT count(1) FROM orders;         -- è½ç¨ï¼ä½ä¸æ¯æ å
</code></pre>
<h3 id="-åºæ¯2ç»è®¡æææ°æ®æ°é">ð¯ <strong>åºæ¯2ï¼ç»è®¡æææ°æ®æ°é</strong></h3>
<pre><code class="language-sql">-- ç»è®¡æå¤å°ç¨æ·å¡«åäºé®ç®±
SELECT count(email) FROM users;  -- â è¿ä¸ªåºæ¯å°±è¯¥ç¨ count(åå)

-- ç»è®¡å·²å®æè®¢åæ°éï¼åè®¾ status=2 æ¯å·²å®æï¼
SELECT count(*) FROM orders WHERE status = 2;  -- â
</code></pre>
<h3 id="-åºæ¯3ç»è®¡ééå¤å¼">ð¯ <strong>åºæ¯3ï¼ç»è®¡ééå¤å¼</strong></h3>
<pre><code class="language-sql">-- ç»è®¡æå¤å°ä¸ªä¸åçåå¸
SELECT count(DISTINCT city) FROM users;  -- â count + DISTINCT

-- ç»è®¡æå¤å°ä¸ªåå¸ï¼æé¤ NULL
SELECT count(DISTINCT city) FROM users;  -- DISTINCT ä¼èªå¨æé¤ NULL
</code></pre>
<h2 id="äºæ§è½ä¼åæå·§">äºãæ§è½ä¼åæå·§</h2>
<h3 id="1-å¤§è¡¨ä¼åæ¹æ¡">1. <strong>å¤§è¡¨ä¼åæ¹æ¡</strong></h3>
<pre><code class="language-sql">-- æ¹æ¡1ï¼ä½¿ç¨è¿ä¼¼å¼ï¼éç¨äºç»è®¡æ¦è§ï¼
SELECT TABLE_ROWS 
FROM information_schema.TABLES 
WHERE TABLE_SCHEMA = 'your_db' AND TABLE_NAME = 'big_table';

-- æ¹æ¡2ï¼åé¡µæ»æ°ç¼å­ï¼éç¨äºåè¡¨é¡µï¼
-- ç¬¬ä¸æ¬¡æ¥è¯¢æ¶ç¼å­æ»æ°ï¼åé¢å®æ¶æ´æ°

-- æ¹æ¡3ï¼ä½¿ç¨æ±æ»è¡¨
CREATE TABLE stats_daily (
    date DATE PRIMARY KEY,
    user_count INT,
    order_count INT
);
</code></pre>
<h3 id="2-ç´¢å¼ä¼å">2. <strong>ç´¢å¼ä¼å</strong></h3>
<pre><code class="language-sql">-- ä¸º count(åå) åå»ºç´¢å¼
CREATE INDEX idx_email ON users(email);

-- ä½æ³¨æï¼count(*) ä¸ä¸å®éè¦ç´¢å¼ï¼InnoDBæä¼å
</code></pre>
<h2 id="å­æè¶£æ¯å»å¸®ä½ è®°å¿">å­ãæè¶£æ¯å»å¸®ä½ è®°å¿</h2>
<h3 id="-æ±å ¡åºæéæ¯å»">ð <strong>æ±å ¡åºæéæ¯å»</strong></h3>
<pre><code class="language-sql">-- æ10ä¸ªäººå¨æéä¹°æ±å ¡

count(*) = "éåéæ10ä¸ªäºº" â
count(1) = "æç»æ¯äººåä¸ªå·ç çï¼æ°æ10ä¸ªç" â  
count(ç°é) = "åªæ8ä¸ªäººå¸¦äºç°é" â
count(ä¼åå¡) = "åªæ5ä¸ªäººæä¼åå¡" â
</code></pre>
<h3 id="-æå®¤ç¹åæ¯å»">ð« <strong>æå®¤ç¹åæ¯å»</strong></h3>
<pre><code class="language-sql">-- æå®¤éæ50ä¸ªåº§ä½

count(*) = "æå®¤æ50ä¸ªåº§ä½" â
count(1) = "æå¨æ¯ä¸ªåº§ä½æ¾æ¬ä¹¦ï¼æåæ°æ50æ¬" â
count(å­¦ç) = "ä»å¤©æ¥äº45ä¸ªå­¦çä¸è¯¾" âï¼ç©ºåº§ä½ä¸ç®ï¼
</code></pre>
<h2 id="ä¸æ»ç»ä¸æä½³å®è·µ">ä¸ãæ»ç»ä¸æä½³å®è·µ</h2>
<h3 id="-æç»å»ºè®®">ð <strong>æç»å»ºè®®</strong></h3>
<ol>
<li>
<p><strong>ç»è®¡æ»è¡æ°ï¼ä¸å¾ç¨ <code>count(*)</code></strong></p>
<ul>
<li>è¿æ¯ SQL æ ååæ³</li>
<li>æ§è½æä¼ï¼MySQLæä¸é¨ä¼åï¼</li>
<li>è¯­ä¹ææç¡®</li>
</ul>
</li>
<li>
<p><strong>ç»è®¡æåé NULL æ°éï¼ç¨ <code>count(åå)</code></strong></p>
<ul>
<li>è¿æ¯å®çæ¬èå·¥ä½</li>
<li>ä¸è¦ç¨å®ç»è®¡æ»è¡æ°</li>
</ul>
</li>
<li>
<p><strong>å³äº <code>count(1)</code></strong></p>
<ul>
<li>æ§è½ä¸ <code>count(*)</code> ä¸æ ·</li>
<li>ä½ä¸å¤"æ å"ï¼åæ¹è¨</li>
<li>å»ºè®®ç»ä¸ç¨ <code>count(*)</code></li>
</ul>
</li>
<li>
<p><strong>æ§è½å³é®ç¹</strong></p>
<ul>
<li>å¤§è¡¨é¿åé¢ç¹ count</li>
<li>èèä½¿ç¨ç¼å­ææ±æ»è¡¨</li>
<li>ä¸º count(åå) çåå ç´¢å¼</li>
</ul>
</li>
</ol>
<h3 id="-ä¸å¼ å¾çæ">ð <strong>ä¸å¼ å¾çæ</strong></h3>
<pre><code>count(*)       -&gt; æ»æ° -&gt; æå¿« -&gt; æ¨èä½¿ç¨
    â
count(1)       -&gt; æ»æ° -&gt; ä¸æ ·å¿« -&gt; å¯ç¨ä½ä¸æ å
    â
count(ä¸»é®)    -&gt; æ»æ° -&gt; æ¬¡å¿« -&gt; ä¸»é®éNULLæ¶å¯ç¨
    â
count(ç´¢å¼å)  -&gt; éNULLæ° -&gt; è¾æ¢ -&gt; æç´¢å¼æ¶å¯ç¨
    â  
count(æ®éå)  -&gt; éNULLæ° -&gt; ææ¢ -&gt; è°¨æä½¿ç¨
</code></pre>
<p>è®°ä½å£è¯ï¼<strong>"æ°æ»æ°ï¼ç¨æå·ï¼æ°éç©ºï¼ååå¥½ï¼æ°å­1ï¼è½é«æï¼ä¸æ¯æ åå«å½å®"</strong> ð¯</p>


</div>
<div id="MySignature" role="contentinfo">
    
<p>â¤ï¸ å¦æä½ åæ¬¢è¿ç¯æç« ï¼è¯·ç¹èµæ¯æï¼ ð åæ¶æ¬¢è¿å³æ³¨æçåå®¢ï¼è·åæ´å¤ç²¾å½©åå®¹ï¼</p>

<p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/sun-10387834/" target="_blank">ä½ç¥è®©ææ¥å·¡å±±</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/sun-10387834/p/19452600" target="_blank">https://www.cnblogs.com/sun-10387834/p/19452600</a></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 16:25">2026-02-02 16:25</span>&nbsp;
<a href="https://www.cnblogs.com/sun-10387834">ä½ç¥è®©ææ¥å·¡å±±</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19452600);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19452600', targetLink: 'https://www.cnblogs.com/sun-10387834/p/19452600', title: 'ãé¢è¯é¢ãMySQL ä¸­ count(*)ãcount(1) å count(å­æ®µå) æä»ä¹åºå«ï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ MWGAè®©åäº¿è¡ä»£ç å¨Webç«¯âå¤æ´»âï¼ ]]></title>
    <link>https://www.cnblogs.com/xdesigner/p/19565029</link>
    <guid>96613893f5a475bf08ba98d662373bb9</guid>
    <description>
    <![CDATA[ 
		<h2>
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xdesigner/p/19565029" title="åå¸äº 2026-02-02 16:09">
    <span role="heading" aria-level="2">MWGAè®©åäº¿è¡ä»£ç å¨Webç«¯âå¤æ´»âï¼</span>
    

</a>

		</h2>
		<div class="postText">    <div id="cnblogs_post_description" style="display: none">
        
        åäº¬é½æä¿¡æ¯ç åç MWGAââä¸æ¬¾è½å¤å¸®å©ä¼ä¸åå¼åèå°ä½¿ç¨GDI+ç»å¾çå¤æçä¼ ç»Winformsç¨åºå¿«éãä½ææ¬è¿ç§»å°Blazor WASMå¹³å°çè¿ç§»å·¥å·ï¼å®æç ´äºWinformsç¨åºé¾ä»¥è·¨å¹³å°ãééæ§å·®çå°å¢ï¼ä»éæä½ä¿®æ¹éï¼éå¸¸ä¸è¶è¿10%ï¼å°±è½å°ä¼ ç»Winformsç¨åºæ ç¼è½¬ä¸ºå¯ç½é¡µå è½½çBlazor WASMçæ¬ã
è¿æå³çï¼ä¼ä¸æ ééåä¸å¡é»è¾ï¼æ éå­¦ä¹ å¨æ°åç«¯æ¡æ¶ï¼æ´æ éæåé¢å¤çåç«¯å¼åäººåââä¸å¥ä»£ç ï¼åæ¶ç¼è¯ä¸º.exeä¸.wasmï¼åç«¯è¿è¡ï¼ä½éªä¸è´ï¼ä¸ºä¼ä¸èçå¤§éå¼åææ¬ä¸æ¶é´ï¼å°¤å¶ééå»çç­å¯¹ä¿¡åæè¿«åéæ±çè¡ä¸ï¼
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">ç¹å¤§åè®¯ï¼åäº¬é½æä¿¡æ¯ç åç&nbsp;MWGAââä¸æ¬¾è½å¤å¸®å©ä¼ä¸åå¼åèå°ä½¿ç¨GDI+ç»å¾çå¤æçä¼ ç»Winformsç¨åºå¿«éãä½ææ¬è¿ç§»å°Blazor WASMå¹³å°çè¿ç§»å·¥å·ï¼å®æç ´äºWinformsç¨åºé¾ä»¥è·¨å¹³å°ãééæ§å·®çå°å¢ï¼ä»éæä½ä¿®æ¹éï¼éå¸¸ä¸è¶è¿10%ï¼å°±è½å°ä¼ ç»Winformsç¨åºæ ç¼è½¬ä¸ºå¯ç½é¡µå è½½çBlazor WASMçæ¬ã</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">è¿æå³çï¼ä¼ä¸æ ééåä¸å¡é»è¾ï¼æ éå­¦ä¹ å¨æ°åç«¯æ¡æ¶ï¼æ´æ éæåé¢å¤çåç«¯å¼åäººåââä¸å¥ä»£ç ï¼åæ¶ç¼è¯ä¸º.exeä¸.wasmï¼åç«¯è¿è¡ï¼ä½éªä¸è´ï¼ä¸ºä¼ä¸èçå¤§éå¼åææ¬ä¸æ¶é´ï¼å°¤å¶ééå»çç­å¯¹ä¿¡åæè¿«åéæ±çè¡ä¸ï¼</span></p>
<h1><strong class="135brush" data-brushtype="text"><strong>ä¸ã</strong></strong><strong class="135brush" data-brushtype="text"><strong>æä½ä¿®æ¹ï¼æé«è¿å</strong></strong></h1>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">éè¿MWGAï¼åæ¬åªè½å¨Windowsæ¡é¢è¿è¡çWinformsç¨åºï¼æ ééåï¼å³å¯è½¬åä¸ºéè¿æµè§å¨è®¿é®çWebAssemblyåºç¨ãä»¥ä¸ä¸ºä¸ä¸ªæ¡ä¾å±ç¤ºï¼</span></p>
<span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>æ¡ä¾ä¸ï¼ç»å¸æ«é·æ¸¸æï¼2500è¡ä»£ç ï¼</strong></span>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><em>å¾1ï¼winfromç</em></span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><em>æ«é·æ¯ä¸ä¸ªç»å¸çWindowsæ¸¸æç¨åºï¼è¿æ¯ä¸ä¸ª10å¹´ååçWinformsç¨åºï¼åå«çº¦2500è¡C#ä»£ç ä»¥åè¥å¹²å¾çèµæºæä»¶</em></span></p>
<p><img src="https://img2024.cnblogs.com/blog/12406/202601/12406-20260119115236297-958633113.png" alt="æ«é·æ¸¸æ" loading="lazy"></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><em>å¾2ï¼è½¬æ¢å</em></span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><em>æä»¬å¯¹æ§ä»£ç ä¿®æ¹äºä¸è¶è¿50è¡(å æ¯2%)å°±è®©åä¸å¥ä»£ç å¯ä»¥æ éä¿®æ¹å³å¯ç¼è¯æ .exe å.wasmæä»¶ã</em></span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><img src="https://img2024.cnblogs.com/blog/12406/202601/12406-20260119115330834-395365830.png" alt="å¾ç2" loading="lazy"></span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">ç»¼ä¸</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>ï¼1ï¼åé¡¹ç®ï¼</strong>10å¹´åç¼åçWinformsæ«é·æ¸¸æï¼ä¾èµGDI+è¿è¡çé¢ç»å¶ã</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>ï¼2ï¼è¿ç§»è¿ç¨ï¼</strong>ä½¿ç¨MWGAå¯¼å¥é¡¹ç®ï¼ä»ä¿®æ¹çº¦50è¡ä»£ç ï¼å æ¯2%ï¼ï¼ä¸»è¦ä½¿ç¨&nbsp;#if&nbsp; MWGA&nbsp;æ¡ä»¶ç¼è¯ï¼å°é¨ååæ­¥æ¹æ³æ¹ä¸ºå¼æ­¥ééã</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>ï¼3ï¼ç»æï¼</strong>åä¸å¥ä»£ç æ éæ¹å¨ç»å¾é»è¾ï¼ç´æ¥ç¼è¯ä¸º.wasmæä»¶ï¼å¨ChromeãFirefoxãSafariç­æµè§å¨ä¸­å®ç¾è¿è¡ï¼çé¢ä¸äº¤äºä¸åçä¸è´ï¼</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">è¥æ²¡æMWGAï¼ç¨æ·è¿éä»åç«¯éåæ´ä¸ªæ¸¸æï¼èæ¶èåï¼ææ¬é«ãèç°å¨ï¼åå¼åäººåå¯ç´æ¥å¨Winformsé¡¹ç®ä¸ç»§ç»­è¿­ä»£ï¼åæ­¥çæç½é¡µçï¼</span></p>
<p>&nbsp;</p>
<span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>æ¡ä¾äºï¼æºè½è®¡ç®å¨ï¼460è¡ä»£ç ï¼</strong></span>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><em>å¾3ï¼winfromç</em></span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><em>è¿æ¯ä¸ä¸ªWinform.NETçè®¡ç®å¨ç¨åºï¼åå«460è¡C#ä»£ç </em></span></p>
<p><span style="font-size: 16px"><em><img src="https://img2024.cnblogs.com/blog/12406/202601/12406-20260119115427518-107951139.png" alt="è®¡ç®å¨" loading="lazy"></em></span></p>
<p><span style="font-size: 16px"><em>å¾4ï¼è½¬æ¢å</em></span></p>
<p><span style="font-size: 16px"><em>ä»£ç æªåä»»ä½ä¿®æ¹ï¼åå©MWGAï¼å®å¨Blazor WASMä¸­è¿è¡çé¢å¦ä¸å¾æç¤ºã</em></span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><img src="https://img2024.cnblogs.com/blog/12406/202601/12406-20260119115505304-749089367.png" alt="å¾ç4" loading="lazy"></span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">ç»¼ä¸</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>ï¼1ï¼åé¡¹ç®ï¼</strong>Winformsè®¡ç®å¨ï¼æ¯æçªä½ææ½èªéåºå¸å±ã</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>ï¼2ï¼è¿ç§»è¿ç¨ï¼</strong>ä»£ç é¶ä¿®æ¹ï¼ç´æ¥éè¿MWGAè¿ç§»è³Blazor WASMã</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>ï¼3ï¼ç»æï¼</strong>å¨æµè§å¨ä¸­è¿è¡ï¼çªä½å¤§å°è°æ´ãæé®èªéåºå¸å±ç­è¡ä¸ºå®å¨ä¿çï¼ç¨æ·ä½éªæ æè¿ç§»ï¼</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">&nbsp;</span></p>
<span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>æ¡ä¾ä¸ï¼æ¶é´è½´äº§åï¼1%ä»£ç ä¿®æ¹éï¼</strong></span>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">æ¶é´è½´äº§åæ¯åäº¬é½æå¬å¸çä¸ä¸ªWinFormsè½¯ä»¶äº§åï¼ç°å·²å¼æºï¼è¿æ¯ä¸ä¸ªé¢åå»é¢çä¸ä¸è½¯ä»¶äº§åã</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong><img src="https://img2024.cnblogs.com/blog/12406/202602/12406-20260202160302680-1041140241.png" alt="å¾ç5" loading="lazy"></strong></span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>åé¡¹ç®ï¼</strong>è¿æ¯ä¸ä¸ª7ä¸è¡ä»£ç çWinFormså»çç»å¾è½¯ä»¶ï¼éåº¦ä¾èµWindowsçGDI+å¾å½¢åºã</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>è¿ç§»è¿ç¨ï¼</strong>åå©MWGAæ¡æ¶ï¼éè¿æ·»å æå°éï¼çº¦1%ï¼çå¼æ­¥ééä»£ç ï¼ä½¿åä¸å¥ä»£ç è½åæ¶ç¼è¯ä¸ºæ¡é¢ç¨åºåWebAssemblyåºç¨ã</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>è¿ç§»ç»æï¼</strong>è¯¥è½¯ä»¶æåå¨æµè§å¨ä¸­åæ ·è¿è¡ï¼è¯æäºæ ééåå³å¯å°å¤æC#æ¡é¢è½¯ä»¶ä½ææ¬è¿ç§»è³Webå¹³å°ã</span></p>
<p><strong class="135brush" data-brushtype="text"><strong><img src="https://img2024.cnblogs.com/blog/12406/202602/12406-20260202160321078-1847393760.jpg" alt="å¾ç6" loading="lazy"></strong></strong></p>
<h1><strong class="135brush" data-brushtype="text"><strong>äºãå¹¿æ³éé</strong></strong></h1>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">MWGAå¨é¢å¼å®¹å¤å¹³å°æä½ç³»ç»ï¼åæ¬Windows 7/10/11ãLinuxãAndroidãmacOSä»¥åç»ä¿¡UOSãéºéºãæ¹å¾·ç­å½äº§ä¿¡åç³»ç»ãåºç¨å®å¨åºäºæµè§å¨è¿è¡ï¼ä¸ä¾èµç¹å®Windowsçæ¬ï¼ä¹æ éå®è£ç¬ç«å®¢æ·ç«¯ãè½¬æ¢åçåºç¨å¯ç´æ¥é¨ç½²äºæ åWebæå¡å¨ï¼ç¨æ·éè¿Chromeï¼v95+ï¼ãEdgeãFirefoxï¼v133+ï¼ãSafariç­ä¸»æµæµè§å¨å³å¯è®¿é®ï¼æ éæ´æ¢ç¡¬ä»¶æåçº§ç³»ç»ï¼è½»æ¾å®ç°åºç¨ç°ä»£åä¸åè§åã</span></p>
<p><strong><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">ï¼1ï¼å¨Windows 7ä¸­è¿è¡çé¢å¦ä¸ï¼</span></strong></p>
<p><strong><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><img src="https://img2024.cnblogs.com/blog/12406/202602/12406-20260202160401296-9140087.jpg" alt="å¾ç7" loading="lazy"></span></strong></p>
<p>&nbsp;</p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>ï¼2ï¼å¨è°·æ­æµè§å¨ä¸­è¿è¡çææå¦ä¸ï¼</strong></span></p>
<p><strong><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><img src="https://img2024.cnblogs.com/blog/12406/202602/12406-20260202160426956-315964826.jpg" alt="å¾ç8" loading="lazy"></span></strong></p>
<p>&nbsp;</p>
<p><strong><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">ï¼3ï¼å¨Firefoxä¸­è¿è¡çææï¼</span></strong></p>
<p><strong><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><img src="https://img2024.cnblogs.com/blog/12406/202602/12406-20260202160758522-570347954.jpg" alt="å¾ç9" loading="lazy"></span></strong></p>
<p>&nbsp;</p>
<p><strong><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">ï¼4ï¼å¨è¹æç³»ç»ä¸­è¿è¡çææï¼</span></strong></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong><img src="https://img2024.cnblogs.com/blog/12406/202602/12406-20260202160815014-1508511479.jpg" alt="å¾ç10" loading="lazy"></strong></span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>ï¼5ï¼å¨è¹æpadä¸­è¿è¡çææï¼</strong></span></p>
<p><img src="https://bexp.135editor.com/files/users/1658/16581196/202602/XIfaemfq_Q74w.jpg?auth_key=1770566399-0-0-85b73e984965158d622f0244d80518dc" alt="å¾ç11.jpg"></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>ï¼6ï¼å¨åä¸ºpadä¸­è¿è¡çææï¼</strong></span></p>
<p><img src="https://bexp.135editor.com/files/users/1658/16581196/202602/RFUdjSbk_GMNP.jpg?auth_key=1770566399-0-0-086fb31ad63bdcef31fbcf8017898bcd" alt="å¾ç12.jpg"></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>ï¼7ï¼å¨è¹æææºç«¯è¿è¡ææå¦ä¸ï¼</strong></span></p>
<p><img src="https://bexp.135editor.com/files/users/1658/16581196/202602/yH2Z4tOe_K8re.png?auth_key=1770566399-0-0-9319348da9ee7e23d623be43400fcbb6" alt="å¾ç13.png"></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>ï¼8ï¼å¨å®åææºç«¯è¿è¡ææå¦ä¸ï¼</strong></span></p>
<p><img src="https://bexp.135editor.com/files/users/1658/16581196/202602/HfAKpuk9_92EL.jpg?auth_key=1770566399-0-0-36fcf28439eb68eb75956bd8f7c11587&amp;x-bce-process=image/crop,x_0,y_0,w_394,h_337" alt="å¾ç14.jpg"></p>
<p><img src="https://bexp.135editor.com/files/users/1658/16581196/202602/LSFhnIMh_zEkM.jpg?auth_key=1770566399-0-0-13d14553adfd143ec49f771e0423d178" alt="å¾ç15.jpg"></p>
<h1>&nbsp;ä¸ã<strong class="135brush" data-brushtype="text"><strong>è½¬ååçä¼å¿ï¼ä¸ºä»ä¹éæ©MWGAï¼</strong></strong></h1>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>1ãè¿ç§»æçé«ï¼</strong>å¯¼å¥å³æ¸²æï¼ééå¿«ï¼ä»WinFormså°Webä»éæ°å°æ¶</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>2ãä»£ç æ¹å¨å°ï¼</strong>å¹³åä¿®æ¹éï¼10%ï¼å¤§éä¸å¡é»è¾ä¸ç»å¾ä»£ç å¯ç´æ¥å¤ç¨</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>3ãææ¯é¨æ§ä½ï¼</strong>æ éBlazoræåç«¯ç»éªï¼WinFormså¼åäººåç´æ¥ä¸æ</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>4ãææ¬æä½ï¼</strong>çå»éåäººåãå­¦ä¹ ææ¬ä¸é¿æç»´æ¤ææ¬</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>5ãæ¯æGDI+ç»å¾ï¼</strong>ç³»ç»ç»å¾ä»£ç æ ééæï¼ç´æ¥è¿ç§»è³Canvasæ¸²æ</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px"><strong>6ãè·¨å¹³å°è¿è¡ï¼</strong>æ¯æWindowsãLinuxãAndroidåä¸»æµå½äº§ç³»ç»</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">å¯¹äºä¼ä¸èè¨ï¼å°Winformsåºç¨éåä¸ºWebçéå¸¸æå³çä»é¶å¼å§ãé«æçææ¬ä¸æ¼«é¿çå¨æãMWGAçåºç°ï¼å½»åºæ¹åäºè¿ä¸å±é¢ãä¼ä¸æ éæèä¸é¨çåç«¯å¼åå¢éï¼æ éåºå¼ç»è¿å¤å¹´ç§¯ç´¯çä¸å¡é»è¾ä»£ç ãåªéå¨åæWinformsé¡¹ç®åºç¡ä¸ï¼éè¿MWGAè¿è¡è½¬æ¢ï¼å³å¯åæ­¥è·å¾Webçæ¬ãæªæ¥åè½è¿­ä»£ï¼ä¹åªéå¨Winformsé¡¹ç®ä¸­ä¿®æ¹ä¸æ¬¡ï¼ä¾¿è½åæ­¥è³Webç«¯ï¼æå¤§éä½äºç»´æ¤ææ¬ååç«¯ä¸ä¸è´çé£é©ã</span></p>
<h1>&nbsp;åã<strong class="135brush" data-brushtype="text"><strong>ç«å³ä½éª</strong></strong></h1>
<p>M<span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">WGAç°å·²å¼æ¾ä¸è½½ä¸è¯ç¨ï¼æ¬¢è¿è®¿é®æä»¬çGitHubä¸»é¡µè·åæ¼ç¤ºé¡¹ç®ä¸ä½¿ç¨æåï¼</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">ð ä¸è½½å°åï¼<a href="https://github.com/dcsoft-yyf/MWGA" target="_blank" rel="noopener nofollow">https://github.com/dcsoft-yyf/MWGA</a></span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">ð§ èç³»æä»¬ï¼<a href="mailto:28348092@qq.com" rel="noopener nofollow">28348092@qq.com</a></span></p>
<p>&nbsp;</p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;; font-size: 16px">è¿ç§»ååä»£ç éå¯¹æ¯å¾ï¼å¾ç¤ºä¸ºç¤ºä¾ï¼å®éä¿®æ¹éä¾é¡¹ç®å¤æåº¦èå®ï¼ï¼</span></p>
<p><strong class="135brush" data-brushtype="text"><img src="https://img2024.cnblogs.com/blog/12406/202602/12406-20260202160902626-1390836694.png" alt="å¾ç16" loading="lazy"></strong></p>
<p><strong class="135brush" data-brushtype="text">END</strong></p>
<p><img src="https://bexp.135editor.com/files/users/1658/16581196/202602/7rG2PuJH_shWu.jpg?auth_key=1770566399-0-0-5bf797861484c19f5b5976bcb153f14d" width="145" height="145" data-ratio="1" data-w="344"></p>
<p><strong class="135brush" data-brushtype="text">æ«ç å³æ³¨</strong></p>
<p><span class="135brush" data-brushtype="text">åäº¬é½æä¿¡æ¯</span></p>
<p><span class="135brush" data-brushtype="text">ä¸èµ·å±åç¾å¥½æªæ¥</span></p>

</div>
<div class="clear"></div>
</div>
		<p class="postfoot">
			posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 16:09">2026-02-02 16:09</span>&nbsp;
<a href="https://www.cnblogs.com/xdesigner">è¢æ°¸ç¦ çµå­çåï¼å»çä¿¡æ¯å</a>&nbsp;
éè¯»(<span id="post_view_count">26</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19565029);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19565029', targetLink: 'https://www.cnblogs.com/xdesigner/p/19565029', title: 'MWGAè®©åäº¿è¡ä»£ç å¨Webç«¯âå¤æ´»âï¼' })">ä¸¾æ¥</a>

		</p>
	 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ LLVM Passå¿«éå¥é¨(äº)ï¼è¿è¡ç¬¬ä¸ä¸ªpass ]]></title>
    <link>https://www.cnblogs.com/ClownLMe/p/19564658</link>
    <guid>a088b9405f63dc0c9af5134a182f8de0</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ClownLMe/p/19564658" title="åå¸äº 2026-02-02 15:17">
    <span role="heading" aria-level="2">LLVM Passå¿«éå¥é¨(äº)ï¼è¿è¡ç¬¬ä¸ä¸ªpass</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="è®¤è¯passå±çº§ç»æ">è®¤è¯Passå±çº§ç»æ</h1>
<p><strong>Pass</strong>èå´ä»ä¸å°ä¸ä¸å±åä¸º5ä¸ªå±çº§ï¼</p>
<ul>
<li><strong>æ¨¡åå±çº§</strong>ï¼åä¸ª<code>.ll</code>æ<code>.bc</code>æä»¶</li>
<li><strong>è°ç¨å¾å±çº§</strong>ï¼å½æ°è°ç¨çå³ç³»ã</li>
<li><strong>å½æ°å±çº§</strong>ï¼åä¸ªå½æ°ã</li>
<li><strong>åºæ¬åå±çº§</strong>ï¼åä¸ªä»£ç åãä¾å¦Cè¯­è¨ä¸­<code>{}</code>æ¬èµ·æ¥çæå°ä»£ç ã</li>
<li><strong>æä»¤å±çº§</strong>ï¼åä¸ªIRæä»¤ã</li>
</ul>
<p><mark><strong>æ³¨æï¼ä¸é¢ä»£ç æå¥½ä¸è¦ç¨ä¸­æï¼ä½¿ç¨èµ·æ¥éå¸¸éº»ç¦ï¼æ§å¶å°ï¼ç¼è¯ï¼ç®æ æä»¶çç¼ç ä¸åä¼é æä¹±ç ã</strong></mark></p>
<h1 id="é¡¹ç®ç®å½å¦ä¸">é¡¹ç®ç®å½å¦ä¸</h1>
<pre><code>/MyProject
âââ CMakeLists.txt # CMake éç½®æä»¶
âââ build/ #æå»ºç®å½
â   âââ test.c #æµè¯ç¼è¯ä»£ç 
âââ mypass1.cpp # pass é¡¹ç®ä»£ç 
</code></pre>
<h3 id="ä¸æµè¯ä»£ç ç¤ºä¾">ä¸ï¼æµè¯ä»£ç ç¤ºä¾</h3>
<p><strong>test.c</strong></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

void secret_function() {
&nbsp; &nbsp; printf("I am secret\n");
}

int main() {
&nbsp; &nbsp; secret_function();
&nbsp; &nbsp; return 0;
}
</code></pre>
<h3 id="äºpassç¼å">äºï¼Passç¼å</h3>
<p>é¡¹ç®æè¿°ï¼éè¿è§£æä¸é¢ä»£ç çIRï¼å°ä¸é¢ä»£ç ä¸­çå½æ°åæå°åºæ¥ã<br>
<strong>mypass1.cpp</strong></p>
<pre><code class="language-c">#include "llvm/IR/PassManager.h"
#include "llvm/Passes/PassBuilder.h"
#include "llvm/Passes/PassPlugin.h"
#include "llvm/Support/raw_ostream.h"

using namespace llvm;

// è¿ä¸ªç»æä½åºæ¬æ¯åºå®æ¨¡æ¿
namespace {
    struct mypass1 : public PassInfoMixin&lt;mypass1&gt; {
	    //å½æ°åè°ï¼æ¯æ¬¡éå°å½æ°æ¶è°ç¨ï¼è¿éæéè½½ï¼å­å¨å¤ç§å¥å£æ¹å¼ï¼å¯ä»¥ä»¥æ¨¡åä¸ºå¥å£ï¼
        PreservedAnalyses run(Function &amp;F, FunctionAnalysisManager &amp;) {
	        //è¿éæ¯ä¸»è¦çé»è¾ä»£ç ï¼æä»¬ä¸»è¦å­¦ä¹ çä»£ç å¨è¿
	        
	        //æå°åºå½åå½æ°çåå­
            errs() &lt;&lt; "Found Function: " &lt;&lt; F.getName() &lt;&lt; "\n";
            
            //åªè¯»æ¶è¿åï¼PreservedAnalyses::all()
            //å­å¨ä¿®æ¹æ¶ï¼PreservedAnalyses::none()
            return PreservedAnalyses::all();
        }
    };

}

//ä¸é¢åºæ¬ä¸æ¯åºå®çæ¨¡æ¿ï¼æ¯ä¸ªpassæ²¡ä»ä¹ååï¼å¯ä»¥ç´æ¥å¤å¶ç²è´´ï¼æèèçã
//ç´æ¥ä½¿ç¨éè¦ä¿®æ¹çæ¯ä¸é¢ç&lt;æ¨¡ååç§°ï¼çæ¬å·ï¼è°ç¨åæ°ï¼åè°ç¨çpassç»æä½&gt;
extern "C" LLVM_ATTRIBUTE_WEAK::llvm::PassPluginLibraryInfo
llvmGetPassPluginInfo() {
    return {
        LLVM_PLUGIN_API_VERSION,//çæ¬ä¿¡æ¯
        "mypass1",//æ¨¡åä¿¡æ¯ï¼èªå®ä¹
        "v0.1",//çæ¬å·ï¼èªå®ä¹
        [](PassBuilder &amp;PB) {
            PB.registerPipelineParsingCallback(
                [](StringRef Name, FunctionPassManager &amp;FPM,
                   ArrayRef&lt;PassBuilder::PipelineElement&gt;) {
                    if (Name == "mypass1") {//è°ç¨åæ°
                        FPM.addPass(mypass1());//ä¸é¢passç»æä½
                        return true;
                    }
                    return false;
                }
            );
        }
    };
}
</code></pre>
<h3 id="ä¸passçæå»º">ä¸ï¼Passçæå»º</h3>
<p>æå»ºLLVM Passéè¦å<code>CMakeLists.txt</code>æå»ºå£°æ</p>
<h5 id="1-éç½®cmakeéç½®æä»¶">1. éç½®CMakeéç½®æä»¶</h5>
<p><strong>CMakeLists.txt</strong><br>
ä¸é¢ç<code>cmake</code>éç½®å¯ä»¥ç´æ¥æ¿å»ç¨ï¼æå·²ç»æ æ³¨å¥½éè¦ä¿®æ¹çä½ç½®</p>
<pre><code class="language-python">#cmake çæ¬ï¼å¯éè¿ cmake --version å¤æ­
cmake_minimum_required(VERSION 4.1.1) #----&gt;ä¿®æ¹ cmakeçæ¬å·
#é¡¹ç®åå­
project(mypass1) #----&gt;ä¿®æ¹ é¡¹ç®åç§°

#å¯¼å¥é¡¹ç®ç LLVM cmake éç½®æä»¶è·¯å¾(å¦ææ ¹æ®æä¹åæç« å®è£è¿éå°±ç¸å)
set(LLVM_DIR "D:/LLVM/llvm-project/build/lib/cmake/llvm")#----&gt;ä¿®æ¹ llvm cmakeéç½®è·¯å¾
#å¯»æ¾ LLVM çåæä»¶
#REQUIRED æ¾ä¸å° LLVM ååæ­¢æå»º
#å¼ºå¶ä½¿ç¨ LLVM å®è£æ¶çæçéç½®æä»¶è¿è¡å®ä½
find_package(LLVM REQUIRED CONFIG)
#å° LLVM ç CMake æ¨¡åè·¯å¾æ·»å å°å½å CMake æç´¢è·¯å¾ä¸­ï¼ä»¥ä¾¿åç»­ä½¿ç¨ include(AddLLVM)ã
list(APPEND CMAKE_MODULE_PATH "${LLVM_CMAKE_DIR}")

#å¼å¥ LLVM æä¾çä¸ç¨ CMake å®
include(AddLLVM)
#å° LLVM çå¤´æä»¶ç®å½ï¼å¦ llvm/IR/Function.hï¼å å¥ç¼è¯å¨çæç´¢è·¯å¾
include_directories(${LLVM_INCLUDE_DIRS})
#å¯¼å¥ LLVM ç¼è¯æ¶ä½¿ç¨çå®å®ä¹
add_definitions(${LLVM_DEFINITIONS})
#è®¾ç½® C++ æ åä¸º C++17ã(è¿éå¦æä¸ç¨17ç¼è¯ä¼æ¥é)
set(CMAKE_CXX_STANDARD 17)
#å¼ºå¶è¦æ±å¿é¡»æ¯æ C++17ï¼å¦æç¼è¯å¨ä¸æ¯æåå¤±è´¥ã
set(CMAKE_CXX_STANDARD_REQUIRED ON)

#åå»ºä¸ä¸ªæ¨¡ååçåº(.dll)
add_library(mypass8 MODULE mypass8.cpp) #----&gt;ä¿®æ¹ é¡¹ç®åç§°ï¼æä»¶å
#windowsä¸ç¨ä¼æ¥éï¼å¯¼åºç¬¦å·
#LLVM Pass éè¦æ´é²ä¸äºç¹å®çå¥å£ç¹ï¼å¦ getAnalysisUsageï¼ç» opt å·¥å·è°ç¨ã
set_target_properties(mypass8 PROPERTIES WINDOWS_EXPORT_ALL_SYMBOLS ON) #----&gt;ä¿®æ¹ é¡¹ç®åç§°
# æå®è¯¥ Pass éè¦é¾æ¥ç LLVM æ ¸å¿ç»ä»¶ã 
# LLVMCore: æä¾ IRãFunctionãModule ç­æ ¸å¿ç±»ã 
# LLVMSupport: æä¾åç§è¾å©å·¥å·ç±»ï¼å¦ errs() è¾åºï¼ã
target_link_libraries(mypass8 LLVMCore LLVMSupport) #----&gt;ä¿®æ¹ é¡¹ç®åç§°ï¼æä»¶å  
# ä¸ºè¯¥ç®æ è®¾ç½®ç¹å®çç¼è¯å¨éé¡¹ã 
# /utf-8: åè¯ MSVC ç¼è¯å¨ä½¿ç¨ UTF-8 ç¼ç å¤çæºä»£ç ï¼é²æ­¢ä¸­ææ³¨éå¼èµ·çä¹±ç æç¼è¯éè¯¯ã  
target_compile_options(mypass8 PRIVATE /utf-8)#----&gt;ä¿®æ¹ é¡¹ç®åç§°ï¼æä»¶å
</code></pre>
<h5 id="2ç¼è¯å¹¶æå»ºpass">2.ç¼è¯å¹¶æå»ºPass</h5>
<p><strong>æå¼visual studio<code>çå·¥ä½å°ï¼æè¿éæ¯</code>x64 Native Tools Command Prompt for VS 2022`</strong></p>
<p>è¿å°<code>build</code>ç®å½</p>
<pre><code class="language-bash">#æå»ºé¡¹ç®
#å¶ä¸­-DCMAKE_BUILD_TYPE=RelWithDebInfoä¸éä¼æ¥éï¼ç±äºæä¹åç¼è¯çæ¯å¸¦ç¬¦å·çrelaseçæ¬
cmake -G "Ninja"  -DCMAKE_BUILD_TYPE=RelWithDebInfo ..
#ç¼è¯
ninja
</code></pre>
<p>æååºç°ä¸é¢æç¤ºï¼å³ä¸ºç¼è¯æå</p>
<pre><code class="language-bash">[2/2] Linking CXX shared module mypass1.dll
</code></pre>
<h3 id="åä½¿ç¨ä½ ç¬¬ä¸ä¸ªpass">åï¼ä½¿ç¨ä½ ç¬¬ä¸ä¸ªPass</h3>
<p>è¿å°<code>build</code>ç®å½</p>
<pre><code class="language-bash">#æ.cæä»¶ç¼è¯ä¸º.ll
#-O1 ä½¿ç¨O1ä¼åï¼è¿éæå°è¯-O0ä¸ä¼åï¼ä¼å¯¼è´æçpassæ æ³åºç¨ï¼
#-Xclang -disable-llvm-passes ä¸ä½¿ç¨é»è®¤çpassä¼å
clang -S -emit-llvm -O1 -Xclang -disable-llvm-passes test.c -S -o test.ll

#ä½¿ç¨pass
opt -load-pass-plugin=mypass1.dll -passes=mypass1  test.ll -S -o test_opt.ll
</code></pre>
<p><strong>è¾åºç»æ</strong></p>
<pre><code class="language-bash">Found Function: sprintf
Found Function: vsprintf
Found Function: _snprintf
Found Function: _vsnprintf
Found Function: secret_function
Found Function: printf
Found Function: main
Found Function: _vsprintf_l
Found Function: _vsnprintf_l
Found Function: __local_stdio_printf_options
Found Function: _vfprintf_l
</code></pre>
<p><strong>å¦æâ¤åæ¬¢â¤æ¬ç³»åæç¨ï¼å°±ç¹ä¸ªå³æ³¨å§ï¼åç»­ä¸å®ææ´æ°~</strong></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 15:17">2026-02-02 15:17</span>&nbsp;
<a href="https://www.cnblogs.com/ClownLMe">ClownLMe</a>&nbsp;
éè¯»(<span id="post_view_count">26</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19564658);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19564658', targetLink: 'https://www.cnblogs.com/ClownLMe/p/19564658', title: 'LLVM Passå¿«éå¥é¨(äº)ï¼è¿è¡ç¬¬ä¸ä¸ªpass' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ MySQL 5.6 2000 ä¸è¡é«é¢è¯»åè¡¨æ°å¢å­æ®µå®æï¼ä»æ¢æ§è¡å°æ éè½å°å¨è§£æ ]]></title>
    <link>https://www.cnblogs.com/xxhxs-21/p/19564624</link>
    <guid>0f98b7c5fb32dd79832894cba6e45ceb</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xxhxs-21/p/19564624" title="åå¸äº 2026-02-02 15:13">
    <span role="heading" aria-level="2">MySQL 5.6 2000 ä¸è¡é«é¢è¯»åè¡¨æ°å¢å­æ®µå®æï¼ä»æ¢æ§è¡å°æ éè½å°å¨è§£æ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/1869035/202602/1869035-20260202151226843-1773744596.png" alt="MySQL 5.6 2000 ä¸è¡é«é¢è¯»åè¡¨æ°å¢å­æ®µå®æï¼ä»æ¢æ§è¡å°æ éè½å°å¨è§£æ" class="desc_img">
        MySQL 5.6 2000 ä¸è¡é«é¢è¯»åè¡¨æ°å¢å­æ®µå®æï¼ä»æ¢æ§è¡å°æ éè½å°å¨è§£æ
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<h2><span style="font-family: &quot;Microsoft YaHei&quot;">ä¸ãèæ¯ä¸é®é¢ç¼èµ·</span></h2>
<p><span style="font-family: &quot;Microsoft YaHei&quot;">MySQL 5.6.51 çæ¬ä¸ 2000 ä¸è¡æ ¸å¿ä¸å¡è¡¨å¼å±æ°å¢å­æ®µæä½ï¼éæ±ä¸ºæ°å¢<code></code><code>BIGINT(19) NOT NULL DEFAULT 0 COMMENT 'æ³¨é'</code>ï¼å ä¸å¡å®ééè¦å­å¨å¤§æ°å¼å³èå­æ®µï¼ã</span></p>
<p><span style="font-family: &quot;Microsoft YaHei&quot;">è¡¨çæ ¸å¿ç¹æ§ä¸ºJava å¤çº¿ç¨å¯éè¯»åï¼ä¸å¡è¯·æ±æç»­é«é¢ï¼åå§æ§è¡åç<code>ALTER TABLE</code>è¯­å¥æ¶åºç°ä¸¤å¤§æ ¸å¿é®é¢ï¼</span></p>
<ol>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">72 ä¸è¡æµè¯è¡¨æ§è¡èæ¶ 203 ç§ï¼çº¿æ§æ¨ç® 2000 ä¸è¡è¡¨èæ¶è¶ 1.5 å°æ¶ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">çäº§æ§è¡æ¶è§¦åè¡¨éãæ¥è¯¢å¤±æï¼ä¸¥éå½±åä¸å¡æ­£å¸¸è¿è¡ã</span></li>
</ol>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">æ¬æ¬¡å®æçæ ¸å¿ææéä¸­å¨ï¼MySQL 5.6 çæ¬æªæ¯æé«çæ¬çè¡¨ç»æåæ°æ®åå°ä¿®æ¹ä¼åãå¤§è¡¨å¨éæ°æ®æ·è´ç IO èµæºå ç¨ãé«é¢è¯»ååºæ¯ä¸çèµæºç«äºãMDL éç­å¾å¯¼è´çéè¡¨é£é©ï¼ééè¿éå¯¹æ§æ¹æ¡å®ç°æ éãæ ä¸å¡æç¥ãé«æçå­æ®µæ°å¢ã</span></div>
<h2><span style="font-family: &quot;Microsoft YaHei&quot;">äºãæ ¸å¿é®é¢æ ¹æºåæ</span></h2>
<h3><span style="font-family: &quot;Microsoft YaHei&quot;">2.1 MySQL 5.6 Online DDL çåå¤©å±é</span></h3>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">MySQL 5.6 è½å¼å¥ InnoDB Online DDL ç¹æ§ï¼è§£å³äºä¼ ç» DDL éè¡¨é»å¡ä¸å¡çé®é¢ï¼ä½æªæ¯æé«çæ¬ï¼5.7/8.0ï¼çåæ°æ®åå°ä¿®æ¹ä¼åââ æ°å¢ä»»ä½ç±»åå­æ®µåéå¨è¡¨æ·è´æ°æ®ï¼èæ·è´è¿ç¨ä¼å ç¨å¤§éç£ç IOï¼è¿æ¯å¤§è¡¨ DDL æ§è¡æ¢çæ ¸å¿æ ¹æºãå°¤å¶å¯¹äº 2000 ä¸è¡è¡¨ï¼å¨è¡¨æ·è´ç IO å¼éæä¸ºæ§è½ç¶é¢ï¼72 ä¸è¡å°è¡¨æµè¯èæ¶ 203 ç§çæ ¸å¿åå ä¹å¨äºæ­¤ã</span></div>
<div>
<h3><span style="font-family: &quot;Microsoft YaHei&quot;">2.2&nbsp;æ¾å¼é»è®¤å¼å¯¹ DDL çä¼åä½ç¨</span></h3>
</div>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">MySQL 5.6 å¯¹åçæ°å¼ç±»åï¼TINYINT/INT/BIGINTï¼+ ç®åå¸¸éé»è®¤å¼ï¼å¦ 0ï¼ç DDL æä½æè½»éçº§ä¼åï¼æ é»è®¤å¼æ¶éå¨è¡¨æ·è´ + éè¡åå§åå­æ®µå¼ï¼èæ¾å¼æå®é»è®¤å¼åä¼ä¼åä¸ºå¨è¡¨æ·è´ + æ¹éèµå¼é»è®¤å¼ï¼åå° 60% ä»¥ä¸ç IO å¼éï¼ä¸è¯¥ä¼åå¯¹æ°å¼ç±»åçééæ§è¿ä¼äº VARCHAR ç±»åï¼BIGINT æ¯ VARCHAR çæ§è¡æçæ´é«ãèµæºå ç¨æ´ä½ï¼ã</span></div>
<div>
<h3><span style="font-family: &quot;Microsoft YaHei&quot;">2.3&nbsp;éè¡¨ççæ­£åå¶ï¼MDL éç­å¾ä¸é¿äºå¡é»å¡</span></h3>
</div>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">æ§è¡<code>ALTER TABLE</code>æ¶åºç°çè¡¨éãæ¥è¯¢å¤±æï¼å¹¶é DDL æ¬èº«éè¡¨ï¼èæ¯ MySQL 5.6 ç MDLï¼åæ°æ®éï¼æºå¶å¯¼è´ï¼</span><ol>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">DDL æ§è¡åéè·åè¡¨çMDL æä»éï¼X éï¼ï¼èæ®éè¯»åæä½ä¼ææMDL å±äº«éï¼S éï¼ï¼X éä¸ä»»ä½éäºæ¥ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">è¥æ§è¡ DDL æ¶è¡¨ä¸å­å¨æªæäº¤é¿äºå¡ãæ¢æ¥è¯¢ãç©ºé²é¿è¿æ¥ï¼ææ S éæªéæ¾ï¼ï¼DDL ä¼è¿å¥<code>Waiting for table metadata lock</code>ç¶æï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">MySQL 5.6 ç MDL éç­å¾ä¸ºé»å¡å¼ä¸æ è¶æ¶æºå¶ï¼åç»­ææè¯»åè¯·æ±ï¼åæ¬æ°ç SELECTï¼é½ä¼æéé»å¡ï¼è¡¨ç°ä¸º âè¡¨è¢«éãæ¥è¯¢å¤±æâã</span></li>
</ol>
<h3><span style="font-family: &quot;Microsoft YaHei&quot;">2.4&nbsp;èæ¶éçº¿æ§çæ ¸å¿åå </span></h3>
<p><span style="font-family: &quot;Microsoft YaHei&quot;">72 ä¸è¡è¡¨ 203 ç§çæµè¯ç»ææ æ³çº¿æ§æ¨ç® 2000 ä¸è¡è¡¨èæ¶ï¼å  MySQL 5.6 æ§è¡ä¼ååç DDL æ¶ï¼åä½è¡èæ¶ä¼éæ°æ®éå¢å¤§èéä½ï¼</span></p>
<ol>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">å¤§è¡¨æ¯ææ¹éåæ·è´ï¼è½åååæ¥ç£çè¿ç»­ IO ä¼å¿ï¼åå°å¯»éæ¶é´ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">å¤§è¡¨å¤çè¿ç¨ä¸­InnoDB ç¼å²æ± ç¼å­å½ä¸­çæ´é«ï¼åå°ç©ç IO æ¬¡æ°ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">å°è¡¨æ°æ®åæ£ï¼å­å¨é¨åéæº IOï¼è°åº¦å IO å¼éç¸å¯¹æ´é«ã</span></li>
</ol>
<h2><span style="font-family: &quot;Microsoft YaHei&quot;">ä¸ãéé MySQL 5.6 çæä¼ DDL è¯­å¥</span></h2>
<p><span style="font-family: &quot;Microsoft YaHei&quot;">éå¯¹ 2000 ä¸è¡è¡¨ãBIGINT ç±»åãé»è®¤å¼ 0 çéæ±ï¼ç»å MySQL 5.6 çä¼åç¹æ§ï¼ç¡®å®æä¼ DDL è¯­å¥ï¼æ¾å¼æå®ææå±æ§ä»¥æå¤§åè§¦åä¼åï¼</span></p>
<div class="cnblogs_code">
<pre><span style="font-family: &quot;Microsoft YaHei&quot;"><span style="color: rgba(0, 0, 255, 1)">ALTER</span> <span style="color: rgba(0, 0, 255, 1)">TABLE</span><span style="color: rgba(0, 0, 0, 1)"> è¡¨å 
</span><span style="color: rgba(0, 0, 255, 1)">ADD</span> <span style="color: rgba(0, 0, 255, 1)">COLUMN</span> å­æ®µå <span style="color: rgba(0, 0, 255, 1)">BIGINT</span>(<span style="color: rgba(128, 0, 0, 1); font-weight: bold">19</span>) <span style="color: rgba(128, 128, 128, 1)">NOT</span> <span style="color: rgba(0, 0, 255, 1)">NULL</span> <span style="color: rgba(0, 0, 255, 1)">DEFAULT</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">0</span> COMMENT <span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">æ³¨é</span><span style="color: rgba(255, 0, 0, 1)">'</span>;</span></pre>
</div>
<p><span style="font-family: &quot;Microsoft YaHei&quot;">è¯­å¥å³é®å±æ§è¯´æ</span></p>
<ol>
<li><span style="font-family: &quot;Microsoft YaHei&quot;"><code>BIGINT(19)</code>ï¼åçæ°å¼ç±»åï¼åå¼èå´è¦çè¶å¤§æ´æ°ï¼-9223372036854775808~9223372036854775807ï¼ï¼19 ä¸ºæ¾ç¤ºå®½åº¦ï¼å¹éæç¬¦å·æå¤§ä½æ°ï¼ä¸éå¶å®éåå¼ï¼ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;"><code>NOT NULL DEFAULT 0</code>ï¼æ ¸å¿ä¼åç¹ï¼ç®åå¸¸éé»è®¤å¼è§¦å MySQL 5.6 æ¹éèµå¼ä¼åï¼éç©ºè®¾ç½®é¿å NULL å¼ï¼ç®åä¸å¡ä»£ç ç©ºå¼å¤æ­ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">æ¾å¼æ³¨éï¼æåè¡¨ç»æå¯è¯»æ§ï¼ä¾¿äºåç»­ç»´æ¤ã</span></li>
</ol>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">è¥éæ°å¢ VARCHAR ç±»åå­æ®µï¼éæ¾å¼æå®<code>DEFAULT ''</code>è§¦åä¼åï¼</span></div>
<div>
<div class="cnblogs_code">
<pre><span style="font-family: &quot;Microsoft YaHei&quot;"><span style="color: rgba(0, 0, 255, 1)">ALTER</span> <span style="color: rgba(0, 0, 255, 1)">TABLE</span><span style="color: rgba(0, 0, 0, 1)"> è¡¨å
</span><span style="color: rgba(0, 0, 255, 1)">ADD</span> <span style="color: rgba(0, 0, 255, 1)">COLUMN</span> å­æ®µå <span style="color: rgba(0, 0, 255, 1)">VARCHAR</span>(<span style="color: rgba(128, 0, 0, 1); font-weight: bold">50</span>) <span style="color: rgba(0, 0, 255, 1)">DEFAULT</span> <span style="color: rgba(255, 0, 0, 1)">''</span> COMMENT <span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">æ³¨é</span><span style="color: rgba(255, 0, 0, 1)">'</span>;</span></pre>
</div>
</div>
<h2><span style="font-family: &quot;Microsoft YaHei&quot;">åãçäº§ç¯å¢æ éè½å°å¨æµç¨æ¹æ¡</span></h2>
<h3><span style="font-family: &quot;Microsoft YaHei&quot;">4.1 æ§è¡ååå¤ï¼æ¸éæº + ä½å³°æ + åæ°è°ä¼ï¼æ ¸å¿é¿åï¼</span></h3>
<h4><span style="font-family: &quot;Microsoft YaHei&quot;">4.1.1 éæ©æè´ä½å³°ææ§è¡</span></h4>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">å»ºè®®ï¼ä¼åéæ©åæ¨ 2:00-4:00ï¼æå¶ä»ä¸å¡ä½å³°æï¼åå°æ´»è·äºå¡ï¼éä½ MDL éç­å¾æ¦çã</span></div>
<h4><span style="font-family: &quot;Microsoft YaHei&quot;">4.1.2 å¼ºå¶æ¸çéæºï¼å¿åï¼é¿å MDL éç­å¾ï¼</span></h4>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">æ§è¡ DDL åè¸¢æç©ºé²é¿è¿æ¥ãç»æ­¢é¿äºå¡ / æ¢æ¥è¯¢ï¼éæ¾æææªæäº¤ç S éï¼</span></div>
<div>
<div class="cnblogs_code">
<pre><span style="font-family: &quot;Microsoft YaHei&quot;"><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> 1. ä¸´æ¶ç¼©ç­é¿è¿æ¥è¶æ¶æ¶é´ï¼è¸¢æç©ºé²è¿æ¥</span>
<span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL wait_timeout <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">10</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL interactive_timeout <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">10</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 0, 255, 1)">SELECT</span> SLEEP(<span style="color: rgba(128, 0, 0, 1); font-weight: bold">15</span>); <span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> ç­å¾15ç§è®©è¿æ¥èªå¨æ­å¼</span><span style="color: rgba(0, 128, 128, 1)">
--</span><span style="color: rgba(0, 128, 128, 1)"> 2. æ¢å¤é¿è¿æ¥è¶æ¶é»è®¤å¼ï¼8å°æ¶ï¼</span>
<span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL wait_timeout <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">28800</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL interactive_timeout <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">28800</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> 3. ä¸»å¨ç»æ­¢ç®æ è¡¨ä¸çæ¢æ¥è¯¢/é¿äºå¡ï¼æ¿æ¢åºåãè¡¨åï¼</span>
<span style="color: rgba(0, 0, 255, 1)">SELECT</span> CONCAT(<span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">KILL </span><span style="color: rgba(255, 0, 0, 1)">'</span>, id, <span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">) 
</span><span style="color: rgba(0, 0, 255, 1)">FROM</span><span style="color: rgba(0, 0, 0, 1)"> INFORMATION_SCHEMA.PROCESSLIST 
</span><span style="color: rgba(0, 0, 255, 1)">WHERE</span> db <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">æ°æ®åºå</span><span style="color: rgba(255, 0, 0, 1)">'</span> 
  <span style="color: rgba(128, 128, 128, 1)">AND</span> info <span style="color: rgba(128, 128, 128, 1)">LIKE</span> <span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">%è¡¨å%</span><span style="color: rgba(255, 0, 0, 1)">'</span> 
  <span style="color: rgba(128, 128, 128, 1)">AND</span> Time <span style="color: rgba(128, 128, 128, 1)">&gt;</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">30</span> 
  <span style="color: rgba(128, 128, 128, 1)">AND</span> Command <span style="color: rgba(128, 128, 128, 1)">IN</span> (<span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">Query</span><span style="color: rgba(255, 0, 0, 1)">'</span>, <span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">Sleep</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> æ§è¡ä¸è¿°æ¥è¯¢çæçKILLè¯­å¥ï¼éæ¾Sé</span></span></pre>
</div>
</div>
<h4><span style="font-family: &quot;Microsoft YaHei&quot;">4.1.3 ä¸´æ¶ MySQL åæ°è°ä¼ï¼æé + åå°èµæºç«äºï¼</span></h4>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">å¯éï¼å¨æè°æ´åæ°ï¼æ ééå¯ï¼DDL å®æåæ¢å¤ï¼æ ¸å¿ä¼å DDL æ§è¡æçå IO å©ç¨çï¼</span></div>
<div>
<div class="cnblogs_code">
<pre><span style="font-family: &quot;Microsoft YaHei&quot;"><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> è°å¤§DDLä¸ç¨ç¼å²åºï¼æåæ¹éæ·è´æçï¼é»è®¤1Mï¼è°è³16Mï¼</span>
<span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL innodb_ddl_buffer_size <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">16</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(128, 0, 0, 1); font-weight: bold">1024</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(128, 0, 0, 1); font-weight: bold">1024</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> åå°åæä½IOå¼éï¼é¿åæ°çé¿äºå¡</span>
<span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL innodb_flush_log_at_trx_commit <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">2</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> è°å¤§è¯»åç¼å²åºï¼ç¼è§£ç¼å­ç«äº</span>
<span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL innodb_read_buffer_size <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">16</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(128, 0, 0, 1); font-weight: bold">1024</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(128, 0, 0, 1); font-weight: bold">1024</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL innodb_write_buffer_size <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">8</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(128, 0, 0, 1); font-weight: bold">1024</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(128, 0, 0, 1); font-weight: bold">1024</span>;</span></pre>
</div>
</div>
<h3><span style="font-family: &quot;Microsoft YaHei&quot;">4.2 æ§è¡ä¸­ï¼å®æ¶çæ§ + ç¶æå¤æ­ + èµæºç®¡æ§</span></h3>
<h4><span style="font-family: &quot;Microsoft YaHei&quot;">4.2.1 æ ¸å¿ç¶æå¤æ­ï¼ç¡®è®¤ MDL éè·åæåï¼</span></h4>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">éè¿<code>SHOW FULL PROCESSLIST;</code>æ¥ç DDL è¿ç¨ç¶æï¼è±ç¦»éè¡¨é£é©æçæ ¸å¿æ å¿ï¼</span></div>
<ul>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">é£é©ç¶æï¼<code>State = Waiting for table metadata lock</code>ï¼æªè·å MDL éï¼é»å¡åç»­ææè¯»åï¼ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">æ­£å¸¸ç¶æï¼<code>State = executing</code> æ <code>State = copying to tmp table</code>ï¼MDL éå·²æåè·åï¼DDL æ éæ§è¡ä¸­ï¼äºèä¸º MySQL 5.6 å½åå·®å¼ï¼ç­ææ éï¼ã</span></li>
</ul>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">ç²¾åè¿æ»¤ DDL è¿ç¨çæ¥è¯¢è¯­å¥ï¼é¿åç¿»æ¾ï¼ï¼</span></div>
<div>
<div class="cnblogs_code">
<pre><span style="font-family: &quot;Microsoft YaHei&quot;"><span style="color: rgba(0, 0, 255, 1)">SELECT</span><span style="color: rgba(0, 0, 0, 1)"> id, command, state, info, time 
</span><span style="color: rgba(0, 0, 255, 1)">FROM</span><span style="color: rgba(0, 0, 0, 1)"> INFORMATION_SCHEMA.PROCESSLIST 
</span><span style="color: rgba(0, 0, 255, 1)">WHERE</span> info <span style="color: rgba(128, 128, 128, 1)">LIKE</span> <span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">%è¡¨å%</span><span style="color: rgba(255, 0, 0, 1)">'</span> 
  <span style="color: rgba(128, 128, 128, 1)">AND</span> command <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">ALTER TABLE</span><span style="color: rgba(255, 0, 0, 1)">'</span>;</span></pre>
</div>
</div>
<h4><span style="font-family: &quot;Microsoft YaHei&quot;">4.2.2 å®æ¶èµæºçæ§</span></h4>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">æ éæç»­ç¯å®ï¼1 åéæ¥ç 1 æ¬¡æ ¸å¿ææ ï¼é¿åèµæºèå°½ï¼</span></div>
<div>
<div class="cnblogs_code">
<pre><span style="font-family: &quot;Microsoft YaHei&quot;"><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> çæ§ç£çIOï¼æ ¸å¿ï¼%utilä¸ºå³é®ææ ï¼æ§å¶å¨â¤80%ï¼</span>
iostat -x 1
<span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> çæ§MySQLçCPU/åå­å ç¨</span>
top -p `pidof mysqld`</span></pre>
</div>
<div class="cnblogs_code">
<pre><span style="font-family: &quot;Microsoft YaHei&quot;"><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> æ¥çInnoDB DDLæ§è¡ç¶æï¼ç¡®è®¤å¢éæ¥å¿åæ­¥æ­£å¸¸</span>
SHOW ENGINE INNODB STATUS\G;</span></pre>
</div>
</div>
<h4><span style="font-family: &quot;Microsoft YaHei&quot;">4.2.3 è¯»åéçªå¢çåºå¯¹æ¹æ¡</span></h4>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">å¯éï¼è¥æ§è¡æé´ä¸å¡è¯»åéå¢å ï¼IO å©ç¨ç &gt; 90%ï¼ï¼æ éä¸­æ­ DDLï¼ä¸­æ­ä¼å¯¼è´ä¹åçå·¥ä½ç½è´¹ï¼ï¼éè¿è½»éæä½ç¼è§£èµæºç«äºï¼</span></div>
<div>
<div class="cnblogs_code">
<pre><span style="font-family: &quot;Microsoft YaHei&quot;"><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> ä¸´æ¶å³é­èªéåºå·æ°ï¼åå°åå°IO</span>
<span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL innodb_adaptive_flushing <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(0, 0, 255, 1)">OFF</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> è¥ä¸å¡æ¯æï¼ä¸´æ¶å¨æéæµï¼Javaä¸å¡ä¾§å¼å³ï¼ï¼å°QPSéå¶å¨æ¥å¸¸60%-70%</span></span></pre>
</div>
</div>
<h3><span style="font-family: &quot;Microsoft YaHei&quot;">4.3 æ§è¡åï¼æ¢å¤éç½® + å¨ç»´åº¦éªè¯ï¼å¿åï¼</span></h3>
<h4><span style="font-family: &quot;Microsoft YaHei&quot;">4.3.1 æ¢å¤ MySQL é»è®¤éç½®</span></h4>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">å°ä¸´æ¶è°æ´çåæ°æ¢å¤é»è®¤ï¼ä¿è¯æ°æ®åºé¿æè¿è¡çæ§è½åæ°æ®å®å¨æ§ï¼</span></div>
<div>
<div class="cnblogs_code">
<pre><span style="font-family: &quot;Microsoft YaHei&quot;"><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> æ¢å¤DDLç¼å²åº</span>
<span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL innodb_ddl_buffer_size <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">1</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(128, 0, 0, 1); font-weight: bold">1024</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(128, 0, 0, 1); font-weight: bold">1024</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> æ¢å¤æ¥å¿å·çå®å¨çº§å«ï¼ä¿è¯å®æºä¸ä¸¢æ°æ®ï¼æ ¸å¿ï¼</span>
<span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL innodb_flush_log_at_trx_commit <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">1</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> æ¢å¤è¯»åç¼å²åº</span>
<span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL innodb_read_buffer_size <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">1</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(128, 0, 0, 1); font-weight: bold">1024</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(128, 0, 0, 1); font-weight: bold">1024</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL innodb_write_buffer_size <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(128, 0, 0, 1); font-weight: bold">8</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(128, 0, 0, 1); font-weight: bold">1024</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> æ¢å¤èªéåºå·æ°</span>
<span style="color: rgba(0, 0, 255, 1)">SET</span> GLOBAL innodb_adaptive_flushing <span style="color: rgba(128, 128, 128, 1)">=</span> <span style="color: rgba(0, 0, 255, 1)">ON</span>;</span></pre>
</div>
</div>
<h4><span style="font-family: &quot;Microsoft YaHei&quot;">4.3.2 DDL æ§è¡æåçå¨ç»´åº¦éªè¯</span></h4>
<p><span style="font-family: &quot;Microsoft YaHei&quot;">è¡¨ç»æéªè¯ï¼ç¡®è®¤æ°å­æ®µå±æ§å®å¨ç¬¦åé¢æ</span></p>
<div>
<div class="cnblogs_code">
<pre><span style="font-family: &quot;Microsoft YaHei&quot;"><span style="color: rgba(0, 0, 255, 1)">DESC</span> è¡¨å; <span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> å¿«éæ¥çå­æ®µå±æ§</span>
SHOW <span style="color: rgba(0, 0, 255, 1)">CREATE</span> <span style="color: rgba(0, 0, 255, 1)">TABLE</span> è¡¨å; <span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> ç²¾åç¡®è®¤å®æ´å®ä¹</span></span></pre>
</div>
</div>
<p><span style="font-family: &quot;Microsoft YaHei&quot;">æ°æ®éªè¯ï¼ç¡®è®¤æ°å­æ®µé»è®¤å¼èµå¼æ­£å¸¸ï¼æ ç©ºå¼</span></p>
<div>
<div class="cnblogs_code">
<pre><span style="font-family: &quot;Microsoft YaHei&quot;"><span style="color: rgba(0, 0, 255, 1)">SELECT</span> id, æ°å¢å­æ®µå <span style="color: rgba(0, 0, 255, 1)">FROM</span> è¡¨åLIMIT <span style="color: rgba(128, 0, 0, 1); font-weight: bold">20</span>; <span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> éæºæ¥è¯¢é»è®¤å¼</span>
<span style="color: rgba(0, 0, 255, 1)">SELECT</span> <span style="color: rgba(255, 0, 255, 1)">COUNT</span>(<span style="color: rgba(128, 128, 128, 1)">*</span>) <span style="color: rgba(0, 0, 255, 1)">FROM</span> è¡¨å <span style="color: rgba(0, 0, 255, 1)">WHERE</span> æ°å¢å­æ®µå <span style="color: rgba(0, 0, 255, 1)">IS</span> <span style="color: rgba(128, 128, 128, 1)">NOT</span> <span style="color: rgba(0, 0, 255, 1)">NULL</span>; <span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> å¨ééªè¯éç©º</span></span></pre>
</div>
</div>
<p><span style="font-family: &quot;Microsoft YaHei&quot;">è¯»åéªè¯ï¼æ¨¡æä¸å¡æä½ï¼ç¡®è®¤è¯»åæ­£å¸¸</span></p>
<div>
<div class="cnblogs_code">
<pre><span style="font-family: &quot;Microsoft YaHei&quot;"><span style="color: rgba(0, 0, 255, 1)">UPDATE</span> è¡¨å <span style="color: rgba(0, 0, 255, 1)">SET</span> æ°å¢å­æ®µå<span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(128, 0, 0, 1); font-weight: bold">2</span> <span style="color: rgba(0, 0, 255, 1)">WHERE</span> id<span style="color: rgba(128, 128, 128, 1)">=</span>xxx; <span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> æ¨¡ææ´æ°</span>
<span style="color: rgba(0, 0, 255, 1)">INSERT</span> <span style="color: rgba(0, 0, 255, 1)">INTO</span> è¡¨å (id, æ°å¢å­æ®µå) <span style="color: rgba(0, 0, 255, 1)">VALUES</span> (xxx, <span style="color: rgba(128, 0, 0, 1); font-weight: bold">3</span>); <span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)"> æ¨¡ææå¥</span></span></pre>
</div>
</div>
<p><span style="font-family: &quot;Microsoft YaHei&quot;">ä¸å¡éªè¯ï¼è§å¯ Java å¤çº¿ç¨ä¸å¡æ¥å¿ï¼ç¡®è®¤æ è¶æ¶ãæ¥éãäºå¡åæ»ç­å¼å¸¸ã</span></p>
<h2><span style="font-family: &quot;Microsoft YaHei&quot;">äºãå³é®é®é¢ä¸è§£å³æ¹æ¡æ±æ»</span></h2>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">&nbsp;</span></div>
<div>
<div>
<table>
<thead>
<tr><th><span style="font-family: &quot;Microsoft YaHei&quot;">æ ¸å¿é®é¢</span></th><th><span style="font-family: &quot;Microsoft YaHei&quot;">è§£å³æ¹æ¡</span></th><th><span style="font-family: &quot;Microsoft YaHei&quot;">å³é®è¦ç¹</span></th></tr>
</thead>
<tbody>
<tr>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">DDL æ§è¡æ¢ï¼å¨è¡¨æ·è´ï¼</span></td>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">æ¾å¼æå®ç®åé»è®¤å¼ï¼è§¦å MySQL 5.6 æ¹éèµå¼ä¼å</span></td>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">æ°å¼ç±»åä¼åææä¼äº VARCHARï¼BIGINT (19) DEFAULT 0 æä¼</span></td>
</tr>
<tr>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">çº¿æ§æ¨ç®èæ¶åå·®å¤§</span></td>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">æ éæ¨ç®ï¼2000 ä¸è¡è¡¨ SSD ç£ç 5-8 åéï¼æºæ¢°ç¡¬ç 12-18 åé</span></td>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">å¤§è¡¨æ¹éæ·è´ãç¼å­å½ä¸­çé«ãè¿ç»­ IO ä¼å¿éä½åä½è¡èæ¶</span></td>
</tr>
<tr>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">MDL éç­å¾å¯¼è´éè¡¨</span></td>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">ä½å³°ææ§è¡ + æ¸çéæºï¼è¸¢é¿è¿æ¥ãç»æ­¢é¿äºå¡ï¼</span></td>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">æ§è¡åå¿åï¼é¿å DDL è¿å¥ Waiting for table metadata lock ç¶æ</span></td>
</tr>
<tr>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">é«é¢è¯»ååºæ¯èµæºç«äº</span></td>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">ä¸´æ¶åæ°è°ä¼ + è½»ééæµï¼å¯éï¼</span></td>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">ä»å¼å IO/CPU ç«äºï¼æ éè¡¨é£é©ï¼ä¸å¡å»¶è¿è½»å¾®æ³¢å¨</span></td>
</tr>
<tr>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">æ§è¡æé´è¯»åéçªå¢</span></td>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">çæ§èµæºææ  + ä¸´æ¶éä½ IO å·çé¢ç</span></td>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">æ éä¸­æ­ DDLï¼MySQL ä¼èªå¨ééèµæºï¼ä¼åä¿éä¸å¡</span></td>
</tr>
<tr>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">DDL ç¶æå¤æ­å°é¾</span></td>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">éè¿ SHOW FULL PROCESSLIST æ¥ç State å</span></td>
<td><span style="font-family: &quot;Microsoft YaHei&quot;">executing/copying to tmp table ä¸ºæ­£å¸¸æ éç¶æ</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">&nbsp;</span></div>
<h2><span style="font-family: &quot;Microsoft YaHei&quot;">å­ãé¿åæåï¼ç»å¯¹ç¦æ­¢çæä½</span></h2>
<ol>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">ç¦æ­¢å¨ä¸å¡é«å³°æ / ä¸­å³°ææ§è¡ DDLï¼å³ä½¿åäºè°ä¼ï¼é«å³°æ IO å·²æ¥è¿ç¶é¢ï¼ä¼å¯¼è´ä¸å¡å»¶è¿å¤§å¹å¢å ï¼è§¦åè¶æ¶éè¯ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">ç¦æ­¢æ°å¢ âéç©ºæ é»è®¤å¼â å­æ®µï¼MySQL 5.6 ä¼å¨è¡¨éè¡åå§åï¼2000 ä¸è¡è¡¨èæ¶æ°å°æ¶ï¼ä¸å ç¨å¤§éèµæºï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">ç¦æ­¢ DDL ç­å¾ MDL éæ¶æ å¨äºè¡·ï¼MySQL 5.6 MDL éæ è¶æ¶ï¼éæå¨ç»æ­¢æéè¿ç¨ï¼å¦åä¼æ éé»å¡åç»­æææä½ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">ç¦æ­¢ä¿®æ¹ MySQL åæ°åä¸æ¢å¤ï¼å°¤å¶æ¯<code>innodb_flush_log_at_trx_commit=2</code>ï¼ä¼éä½æ°æ®æä¹æ§ï¼å®æºå¯è½ä¸¢å¤±æ°æ®ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">ç¦æ­¢å¨ DDL æ§è¡ä¸­æå¨ä¸­æ­è¿ç¨ï¼ä¸­æ­ä¼å¯¼è´ä¹åçæ·è´å·¥ä½ç½è´¹ï¼éæ°æ§è¡éåæ¬¡è·å MDL éï¼èæ¶ç¿»åï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">ç¦æ­¢å¿½ç¥è¡¨ç»æéªè¯ï¼DDL è¿ç¨æ¶å¤±åï¼å¿é¡»éè¿ DESC/SHOW CREATE TABLE ç¡®è®¤å­æ®µå±æ§ï¼é¿åå®ä¹ç¼ºå¤±ã</span></li>
</ol>
<h2><span style="font-family: &quot;Microsoft YaHei&quot;">ä¸ãå»¶ä¼¸ä¼åï¼é¿æè§£å³æ¹æ¡</span></h2>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">æ¬æ¬¡å®æä¸º MySQL 5.6 ç¯å¢çä¸´æ¶æä¼è§£ï¼è¥ä¸å¡ä¾§åè®¸ï¼åçº§è³ MySQL 5.7/8.0æ¯å¤çå¤§è¡¨ DDL çç»ææ¹æ¡ï¼</span></div>
<ol>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">é«çæ¬æ¯æè¡¨ç»æåæ°æ®åå°ä¿®æ¹ï¼æ°å¢æ°å¼ç±»å / VARCHAR ç±»åï¼åè®¸ç©º / ç®åé»è®¤å¼ï¼å­æ®µæ¶ï¼ä»ä¿®æ¹åæ°æ®ï¼æ éå¨è¡¨æ·è´ï¼2000 ä¸è¡è¡¨èæ¶æ¯«ç§çº§ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">MDL éæºå¶ä¼åï¼æ¯æéè¶æ¶ãæéæºå¶ä¼åï¼åå°éè¡¨æ¦çï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">æ´ä½æ§è½æåï¼æ¥è¯¢ä¼åãå¹¶åæ§å¶ãéæºå¶åä¼äº 5.6ï¼é«é¢è¯»åè¡¨çæ´ä½æ§è½æå 30%-50%ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">çææ´å®åï¼æ¯æ JSON ç±»åãçªå£å½æ°ãå¹¶è¡å¤å¶ç­æ°ç¹æ§ï¼æ»¡è¶³ä¸å¡åç»­åå±éæ±ã</span></li>
</ol>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">åçº§æ³¨æäºé¡¹ï¼åçº§åå¨éå¤ä»½æ°æ®åºï¼éæ©ä½å³°ææ§è¡ï¼ä¸»ä»åæ¢å¯å®ç°ä¸å¡æ æç¥åçº§ï¼5.7/8.0 ä¸ 5.6 å¼å®¹æ§æé«ï¼æ®éä¸å¡ä»£ç æ éä¿®æ¹ã</span></div>
<h2><span style="font-family: &quot;Microsoft YaHei&quot;">å«ãæ»ç»</span></h2>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">æ¬æ¬¡ MySQL 5.6 2000 ä¸è¡é«é¢è¯»åè¡¨æ°å¢å­æ®µçå®æï¼æ ¸å¿å´ç» **âå©ç¨çæ¬ç¹æ§åä¼åãè§é¿ MDL éæºå¶åãå¹³è¡¡èµæºç«äºä¸ä¸å¡ç¨³å®æ§âå±å¼ï¼æç»å®ç°äºæ éãæ ä¸å¡æç¥ãé«æ ** çè½å°ï¼æ ¸å¿ç»è®ºå¦ä¸ï¼</span></div>
<ol>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">MySQL 5.6 è½æ é«çæ¬çåæ°æ®åå°ä¿®æ¹ä¼åï¼ä½éè¿æ¾å¼æå®ç®åé»è®¤å¼ï¼å¯å¤§å¹éä½ DDL æ§è¡æ¶é´ï¼æ¯ 2000 ä¸è¡è¡¨çæä¼ä¸´æ¶æ¹æ¡ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">éè¡¨çæ ¸å¿æ ¹æºå¹¶é DDL æ¬èº«ï¼èæ¯MDL éç­å¾ + é¿äºå¡é»å¡ï¼æ§è¡åæ¸çéæºæ¯é¿åå³é®ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">Online DDL çæ éç¹æ§ä»å­å¨äºMDL éè·åæååï¼executing/copying to tmp table ç¶æï¼ï¼æ­¤é¶æ®µè±ç¦»éè¡¨é£é©ï¼åç»­ä»å­å¨èµæºç«äºï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">é«é¢è¯»ååºæ¯ä¸æ§è¡ DDLï¼æ éæåä¸å¡ï¼ä»éä½å³°ææ§è¡ + ä¸´æ¶åæ°è°ä¼ï¼ä¸å¡å»¶è¿ä»ä¸ºæ¯«ç§çº§âåæ¯«ç§çº§ï¼å®å¨æ æç¥ï¼</span></li>
<li><span style="font-family: &quot;Microsoft YaHei&quot;">æææä½åä¸º MySQL åç½®å½ä»¤ + å¨æåæ°è°æ´ï¼æ éå®è£é¢å¤å·¥å·ï¼ééçäº§ç¯å¢ç´§æ¥ææ¥åæ¥å¸¸å®æã</span></li>
</ol>
<div><span style="font-family: &quot;Microsoft YaHei&quot;">æ¬æ¬¡å®æçæ¹æ¡å¯å¤ç¨äº MySQL 5.6 ç¯å¢ä¸ææå¤§è¡¨ï¼åä¸çº§ï¼çæ®éå­æ®µæ°å¢æä½ï¼ä¸ºåçæ¬ãååºæ¯çæ°æ®åºè¿ç»´æä¾å¯è½å°çåèã</span></div>
</div>

</div>
<div id="MySignature" role="contentinfo">
    <div style="border: 2px solid yellow;">
<p style="font-weight:bold;">  æ¶é´ä»ä¿ï¼å¦æéè¯¯æ¬¢è¿æåºï¼æ¬¢è¿å¨è¯è®ºåºè®¨è®ºï¼å¦å¯¹æ¨æå¸®å©è¿è¯·ç¹ä¸ªæ¨èãå³æ³¨æ¯æä¸ä¸</p>
<p style="font-weight:bold;">  ä½èï¼<a href="http://www.cnblogs.com/xxhxs-21/" target="_blank">åå®¢å­ - åå¹´ææ¯</a></p>
<p style="font-weight:bold;">  åºå¤ï¼<a href="http://www.cnblogs.com/xxhxs-21/" target="_blank">http://www.cnblogs.com/xxhxs-21/</a></p>
<p>  æ¬æçæå½ä½èååå®¢å­å±æï¼æ¬¢è¿è½¬è½½ï¼ä½æªç»ä½èåæå¿é¡»å¨æç« é¡µé¢ç»åºåæé¾æ¥ï¼å¦åä¿çè¿½ç©¶æ³å¾è´£ä»»çæå©ã</p>
<p>  è¥åå®¹æä¾µç¯æ¨æççå°æ¹ï¼è¯·å¬åæ å¤èç³»æ¬äººï¼æ¬äººå®ç§¯æéåå¤çè§£å³ã</p>
</div>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 15:14">2026-02-02 15:13</span>&nbsp;
<a href="https://www.cnblogs.com/xxhxs-21">åå¹´ææ¯</a>&nbsp;
éè¯»(<span id="post_view_count">41</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19564624);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19564624', targetLink: 'https://www.cnblogs.com/xxhxs-21/p/19564624', title: 'MySQL 5.6 2000 ä¸è¡é«é¢è¯»åè¡¨æ°å¢å­æ®µå®æï¼ä»æ¢æ§è¡å°æ éè½å°å¨è§£æ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ spring6-å¤ç§ç±»åçæ³¨å¥æ¹å¼ ]]></title>
    <link>https://www.cnblogs.com/alineverstop/p/19563560</link>
    <guid>835b5405e02d81c28ecf7a2e559e8305</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/alineverstop/p/19563560" title="åå¸äº 2026-02-02 12:12">
    <span role="heading" aria-level="2">spring6-å¤ç§ç±»åçæ³¨å¥æ¹å¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ocpåå">OCPåå</h1>
<p>ocpæå¼é­ååï¼å¯¹æ©å±å¼æ¾ï¼å¯¹ä¿®æ¹å³é­ãæ¯ä¸å¤§ååä¸­æåºæ¬çä¸ä¸ªååã</p>
<h1 id="ä¾èµåç½®åådip">ä¾èµåç½®ååï¼DIPï¼</h1>
<h2 id="ä»ä¹æ¯ä¾èµåç½®åå">ä»ä¹æ¯ä¾èµåç½®åå</h2>
<p>æ ¸å¿æ¯é¢åæ¥å£ç¼ç¨ãé¢åæ½è±¡ç¼ç¨ï¼ ä¸æ¯é¢åå·ä½ç¼ç¨ã</p>
<h2 id="ä¾èµåç½®ååçç®ç">ä¾èµåç½®ååçç®ç</h2>
<p>éä½è¦ååº¦ï¼æé«æ©å±å</p>
<h1 id="ä»ä¹æ¯æ§å¶åè½¬">ä»ä¹æ¯æ§å¶åè½¬</h1>
<p>æ§å¶åè½¬ï¼Iocï¼Inversion of Controllï¼ï¼ä¸ç§ç¼ç¨ææ³ãè®¾è®¡æ¨¡å¼ãä¸ºäºéä½ç¨åºè¦ååº¦</p>
<p>åè½¬æä¸¤ç¹ï¼</p>
<ol>
<li>ä¸å¨ç¨åºä¸­éç¨ç¡¬ç¼ç çæ¹å¼newå¯¹è±¡ï¼æåå»ºå¯¹è±¡äº¤ç»å«äººï¼UserService userService = new UserServiceImplForMysql()ï¼ã</li>
<li>ä¸å¨ç¨åºä¸­éç¨ç¡¬ç¼ç çæ¹å¼ç»´æ¤å¯¹è±¡å³ç³»ã</li>
</ol>
<h1 id="springæ¡æ¶">springæ¡æ¶</h1>
<p>springå®ç°äºIocï¼å æ­¤å¯ä»¥åå»ºåç»´æ¤å¯¹è±¡è§çå³ç³»ã</p>
<p>æ§å¶åè½¬å®ç°æ¹å¼ä¸»è¦æ <strong>ä¾èµæ³¨å¥ï¼Dependency Injection DIï¼</strong></p>
<p>ä¾èµæ³¨å¥çæ¹å¼æä»¥ä¸æ¹å¼ï¼</p>
<ol>
<li>Setæ³¨å¥ï¼æ§è¡Setæ¹æ³èµå¼ï¼</li>
<li>æé æ¹æ³æ³¨å¥ï¼æ§è¡æé æ¹æ³èµå¼ï¼</li>
</ol>
<h2 id="ä¾èµæ³¨å¥ä¸­çä¾èµæ³¨å¥çå«ä¹">ä¾èµæ³¨å¥ä¸­çâä¾èµâãâæ³¨å¥âçå«ä¹</h2>
<p>ä¾èµï¼Aå¯¹è±¡åBå¯¹è±¡çå³ç³»</p>
<p>æ³¨å¥ï¼æ¯ä¸ç§ææ®µï¼éè¿è¿ç§ææ®µè®©AåBäº§çå³ç³»ã</p>
<p>ä¾èµæ³¨å¥çå®ç°æ¹å¼æï¼setæ³¨å¥åæé æ¹æ³æ³¨å¥ã</p>
<h3 id="setæ³¨å¥">setæ³¨å¥</h3>
<ol>
<li>éç½®æä»¶éç½®bean</li>
</ol>
<pre><code class="language-xml">&lt;!--    éç½®dao--&gt;
    &lt;bean id="userDao" class="com.ali.dao.UserDao"&gt;
    &lt;/bean&gt;
&lt;!--    éç½®Service--&gt;
    &lt;bean id="userService" class="com.ali.service.UserService"&gt;
        &lt;!--æ³¨å¥daoï¼è¿éçnameæ¯ setæ¹æ³åå»æsetå­ç¬¦åå©ä¸çåè¯é¦å­æ¯å°å--&gt;
&lt;!--        refåé¢æå®è¦æ³¨å¥çbeançid--&gt;
        &lt;property name="userDao" ref="userDao"/&gt;
    &lt;/bean&gt;
</code></pre>
<ol start="2">
<li>å¨ç±»ä¸­åsetæ¹æ³</li>
</ol>
<pre><code class="language-java">package com.ali.service;

import com.ali.dao.UserDao;

public class UserService {

    private UserDao userDao;

    // setæ³¨å¥éè¦æä¾ä¸ä¸ªsetæ¹æ³ï¼æ¹æ³åä»¥setå¼å¤´ï¼springå®¹å¨è°ç¨è¿ä¸ªsetæ¹æ³æ³¨å¥UserDao
        public void setUserDao(UserDao userDao) {
        this.userDao = userDao;
    }

    public void saveUser(){
        userDao.insertUser();
    }
}
</code></pre>
<p>è¿æ ·å³å¯æ³¨å¥æåã</p>
<h4 id="æ³¨å¥å¤é¨bean">æ³¨å¥å¤é¨bean</h4>
<pre><code class="language-xml">&lt;!--    å£°æbean--&gt;
    &lt;bean id="orderDao" class="com.ali.dao.OrderDao" /&gt;

    &lt;bean id="orderService" class="com.ali.service.OrderService"&gt;
&lt;!--    ä½¿ç¨ref æ¥    æ³¨å¥å¤é¨bean--&gt;
        &lt;property name="orderDao" ref="orderDao"/&gt;
    &lt;/bean&gt;
</code></pre>
<h4 id="æ³¨å¥åé¨bean">æ³¨å¥åé¨bean</h4>
<pre><code class="language-xml">    &lt;bean id="orderService2" class="com.ali.service.OrderService"&gt;
      &lt;property name="orderDao"&gt;
&lt;!--          å¨propertyæ ç­¾ä¸­ä½¿ç¨åµå¥beanï¼è¿å°±æ¯åé¨bean--&gt;
          &lt;bean class="com.ali.dao.OrderDao" &gt;&lt;/bean&gt;
      &lt;/property&gt;
    &lt;/bean&gt;
</code></pre>
<h4 id="æ³¨å¥ç®åç±»å">æ³¨å¥ç®åç±»å</h4>
<pre><code class="language-xml">&lt;!--    æ³¨å¥ç®åç±»åå±æ§--&gt;
&lt;bean id="userBean" class="com.ali.bean.User"&gt;
&lt;!--    ç®åç±»åèµå¼ä½¿ç¨valueå±æ§--&gt;
    &lt;property name="name" value="å¼ ä¸"&gt;&lt;/property&gt;
    &lt;property name="age" value="30"&gt;&lt;/property&gt;
    &lt;property name="password" value="123456"&gt;&lt;/property&gt;
    &lt;/bean&gt;
</code></pre>
<p>å®éå¼åä¸­ï¼ä¸è¬ä¸ä¼å§Dateç±»åå½ä½ç®åç±»åï¼ä¼ä½¿ç¨refæ¥æ³¨å¥Dateç±»å</p>
<h4 id="çº§èå±æ§èµå¼">çº§èå±æ§èµå¼</h4>
<pre><code class="language-xml">&lt;!--     ä½¿ç¨çº§èå±æ§èµå¼ï¼ç»studentBeançclazzå±æ§èµå¼å¿é¡»æsetãgetæ¹æ³--&gt;
&lt;!--        åéç½®clazz  åéç½®clazz.name--&gt;
    &lt;bean id="studentBean" class="com.ali.bean.Student"&gt;
        &lt;property name="name" value="æå"&gt;&lt;/property&gt;
        &lt;property name="clazz" ref="clazzBean"&gt;&lt;/property&gt;
        &lt;!--çº§èå±æ§èµå¼ï¼ç»studentBeançclazzå±æ§èµå¼
        è¿éçclazzæ¯Studentç±»ä¸­çå±æ§å
        clazz å¿é¡»æsetãgetæ¹æ³--&gt;
        &lt;property name="clazz.name" value="é«ä¸äºç­"&gt;&lt;/property&gt;
    &lt;/bean&gt;
    &lt;bean id="clazzBean" class="com.ali.bean.Clazz"&gt;
    &lt;/bean&gt;
</code></pre>
<h4 id="æ³¨å¥æ°ç»">æ³¨å¥æ°ç»</h4>
<pre><code class="language-xml">   &lt;!--    æ³¨å¥ç®åç±»åå±æ§--&gt;
&lt;bean id="userBean1" class="com.ali.bean.User"&gt;
&lt;!--    ç®åç±»åèµå¼ä½¿ç¨valueå±æ§--&gt;
    &lt;property name="name" value="å¼ ä¸"&gt;&lt;/property&gt;
    &lt;property name="age" value="30"&gt;&lt;/property&gt;
    &lt;property name="password" value="123456"&gt;&lt;/property&gt;
    &lt;/bean&gt;
    &lt;bean id="userBean2" class="com.ali.bean.User"&gt;
        &lt;!--    ç®åç±»åèµå¼ä½¿ç¨valueå±æ§--&gt;
        &lt;property name="name" value="å¼ ä¸"&gt;&lt;/property&gt;
        &lt;property name="age" value="30"&gt;&lt;/property&gt;
        &lt;property name="password" value="123456"&gt;&lt;/property&gt;
    &lt;/bean&gt;
    &lt;bean id="userBean3" class="com.ali.bean.User"&gt;
        &lt;!--    ç®åç±»åèµå¼ä½¿ç¨valueå±æ§--&gt;
        &lt;property name="name" value="å¼ ä¸"&gt;&lt;/property&gt;
        &lt;property name="age" value="30"&gt;&lt;/property&gt;
        &lt;property name="password" value="123456"&gt;&lt;/property&gt;
    &lt;/bean&gt;
   
   &lt;bean id="qdyBean" class="com.ali.bean.QDY"&gt;
&lt;!--        aihaoå±æ§æ¯ä¸ä¸ªå­ç¬¦ä¸²æ°ç»--&gt;
        &lt;property name="aihao"&gt;
            &lt;array&gt;
                &lt;value&gt;å&lt;/value&gt;
                &lt;value&gt;å&lt;/value&gt;
            &lt;/array&gt;
        &lt;/property&gt;
&lt;!--        friendsæ¯ä¸ä¸ªUserå¯¹è±¡æ°ç»--&gt;
        &lt;property name="friends"&gt;
            &lt;array&gt;
                &lt;ref bean="userBean1"&gt;&lt;/ref&gt;
                &lt;ref bean="userBean2"&gt;&lt;/ref&gt;
                &lt;ref bean="userBean3"&gt;&lt;/ref&gt;
            &lt;/array&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
</code></pre>
<h4 id="æ³¨å¥liståsetç±»å">æ³¨å¥ListåSetç±»å</h4>
<pre><code class="language-xml">    &lt;bean id="personBean" class="com.ali.bean.Person"&gt;
&lt;!--        namesæ¯ List&lt;String&gt; ç±»å--&gt;
        &lt;property name="names"&gt;
            &lt;list&gt;
                &lt;value&gt;å¼ ä¸&lt;/value&gt;
                &lt;value&gt;éæ¯&lt;/value&gt;
                &lt;value&gt;è©¹å§æ&lt;/value&gt;
            &lt;/list&gt;
        &lt;/property&gt;
&lt;!--        address æ¯ Set&lt;String&gt;   ç±»å--&gt;
        &lt;property name="address"&gt;
            &lt;set&gt;
                &lt;value&gt;åäº¬&lt;/value&gt;
                &lt;value&gt;ä¸æµ·&lt;/value&gt;
                &lt;value&gt;å¹¿å·&lt;/value&gt;
            &lt;/set&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
</code></pre>
<h4 id="æ³¨å¥mapéå">æ³¨å¥Mapéå</h4>
<pre><code class="language-xml">&lt;!--      phone æ¯ä¸ä¸ªMap&lt;Integer, String&gt;ç±»å
      å¦ækeyæ¯ç®åç±»åï¼å¯ä»¥ç´æ¥ä½¿ç¨entryæ ç­¾çkeyå±æ§èµå¼
      å¦ækeyæ¯å¤æç±»åï¼å¯ä»¥ä½¿ç¨
      &lt;entry key-ref="keyBean" value-ref="valueBean"&gt;&lt;/entry&gt;
      valueåç--&gt;
      &lt;property name="phone"&gt;
          &lt;map&gt;
              &lt;entry key="1" value="13800138000"&gt;&lt;/entry&gt;
              &lt;entry key="2" value="13900139000"&gt;&lt;/entry&gt;
              &lt;entry key="3" value="13700137000"&gt;&lt;/entry&gt;
          &lt;/map&gt;
      &lt;/property&gt;
</code></pre>
<h4 id="æ³¨å¥propertiesç±»å">æ³¨å¥Propertiesç±»å</h4>
<pre><code class="language-xml">&lt;!--        Properties çkey åvalueåªè½æ¯å­ç¬¦ä¸²ç±»å--&gt;
        &lt;property name="properties"&gt;
            &lt;props&gt;
                &lt;prop key="k1"&gt;v1&lt;/prop&gt;
                &lt;prop key="k2"&gt;v2&lt;/prop&gt;
                &lt;prop key="k3"&gt;v3&lt;/prop&gt;
            &lt;/props&gt;
        &lt;/property&gt;
</code></pre>
<h4 id="æ³¨å¥nullåç©ºå­ç¬¦ä¸²">æ³¨å¥nullåç©ºå­ç¬¦ä¸²</h4>
<pre><code class="language-xml">&lt;!--        ä»¥ä¸æ¯æå¨æ³¨å¥null--&gt;
        &lt;property name="name" &gt;
            &lt;null&gt;&lt;/null&gt;
        &lt;/property&gt;
        &lt;!--        ä¸ç»å±æ§æ³¨å¥ï¼å±æ§çé»è®¤å¼æ¯null--&gt;
&lt;!--        &lt;property name="name" value="tom"&gt;&lt;/property&gt;--&gt;
&lt;!--       æ³¨å¥ç©ºå­ç¬¦ä¸²æ¹å¼ä¸ --&gt;
        &lt;property name="name" value=""&gt;&lt;/property&gt;
&lt;!--        æ³¨å¥ç©ºå­ç¬¦ä¸²æ¹å¼äº --&gt;
        &lt;property name="name" &gt;
            &lt;value&gt;&lt;/value&gt;
        &lt;/property&gt;
        &lt;property name="age" value=â31â&gt;&lt;/property&gt;
</code></pre>
<h4 id="æ³¨å¥ç¹æ®å­ç¬¦ä¸²">æ³¨å¥ç¹æ®å­ç¬¦ä¸²</h4>
<pre><code class="language-xml"> &lt;bean id="mathBean" class="com.ali.bean.MathBean"&gt;
        &lt;!--     ç¬¬ä¸ç§ï¼ä½¿ç¨å®ä½ç¬¦å·ä»£æ¿ç¹æ®ç¬¦å·    2&lt;3 --&gt;
&lt;!--        &lt;property name="result" value="2 &amp;lt; 3"&gt;&lt;/property&gt;--&gt;
        &lt;!--     ç¬¬äºç§ï¼ä½¿ç¨&lt;![CDATA[]]&gt; è¿éé¢çåå®¹ä¸ä¼è¢«xmlè§£æ    2&lt;3 --&gt;
        &lt;property name="result"&gt;
&lt;!--            åªè½ä½¿ç¨valueæ ç­¾--&gt;
            &lt;value&gt;&lt;![CDATA[2&lt;3]]&gt;&lt;/value&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
</code></pre>
<h3 id="æé æ³¨å¥">æé æ³¨å¥</h3>
<ol>
<li>éç½®æä»¶éç½®bean</li>
</ol>
<pre><code class="language-xml">    &lt;bean id="userDaoBean" class="com.ali.dao.UserDao"&gt;
    &lt;/bean&gt;
&lt;!--     æé æ³¨å¥--&gt;
    &lt;bean class="com.ali.service.CustomerService" id="customerService"&gt;
&lt;!--        æå®æé æ¹æ³çç¬¬ä¸ä¸ªåæ°ï¼ä¸æ æ¯0--&gt;
        &lt;constructor-arg index="0" ref="userDaoBean"&gt;&lt;/constructor-arg&gt;
        &lt;!--        æ ¹æ®åæ°åæ³¨å¥--&gt;
        &lt;constructor-arg name="userDao" ref="userDaoBeanâ&gt;&lt;/constructor-arg&gt;
    &lt;/bean&gt;
</code></pre>
<ol start="2">
<li>å¨ç±»ä¸­åæé æ¹æ³</li>
</ol>
<pre><code class="language-java">public class CustomerService {

    private UserDao userDao;

    public CustomerService(UserDao userDao) {
        this.userDao = userDao;
    }

    public  void save(){
        userDao.insertUser();
    }
}
</code></pre>
<h3 id="på½åç©ºé´æ³¨å¥ç®åsetæ³¨å¥">på½åç©ºé´æ³¨å¥ï¼ç®åsetæ³¨å¥ï¼</h3>
<pre><code class="language-xml">&lt;!--  på½åç©ºé´æ³¨å¥åºå±è¿æ¯setæ³¨å¥ï¼ç±»ä¸­çå±æ§å¿é¡»æsetæ¹æ³ï¼ï¼åªä¸è¿på½åç©ºé´æ³¨å¥è®©springéç½®æ´å ç®å
  1.å¨springéç½®æä»¶å¤´é¨æ·»å på½åç©ºé´ã  xmlns:p="http://www.springframework.org/schema/p"
  2.ä½¿ç¨på½åç©ºé´æ³¨å¥å±æ§ï¼è¯­æ³ï¼p:å±æ§å="å±æ§å¼"  p:å±æ§å-ref="å¼ç¨ç±»åå±æ§å¼"--&gt;
  &lt;bean id="dogBean" class="com.ali.bean.Dog" p:age="22" p:name="å¼ ä¸" p:birthday-ref="birthdayBean"/&gt;

  &lt;bean id="birthdayBean" class="java.util.Date" /&gt;
</code></pre>
<h3 id="cå½åç©ºé´æ³¨å¥ç®åæé æ³¨å¥">cå½åç©ºé´æ³¨å¥ï¼ç®åæé æ³¨å¥ï¼</h3>
<pre><code class="language-xml">&lt;!--  cå½åç©ºé´æ³¨å¥åºå±è¿æ¯æé å¨æ³¨å¥ï¼ç±»ä¸­å¿é¡»æå¯¹åºçæé å¨ï¼ï¼åªä¸è¿cå½åç©ºé´æ³¨å¥è®©springéç½®æ´å ç®å
  1.å¨springéç½®æä»¶å¤´é¨æ·»å cå½åç©ºé´ã  xmlns:c="http://www.springframework.org/schema/c"
  2.ä½¿ç¨cå½åç©ºé´æ³¨å¥å±æ§ï¼è¯­æ³ï¼c:å±æ§å="å±æ§å¼"  c:å±æ§å-ref="å¼ç¨ç±»åå±æ§å¼"
  c:_0 ä¸æ æ¹å¼   c:name  åæ°åæ¹å¼--&gt;
&lt;bean id="peopleBean" class="com.ali.bean.People" c:name="åªåª" c:age="3" c:sex="true"/&gt;
</code></pre>
<h3 id="åºäºxmlçèªå¨è£ébyname">åºäºxmlçèªå¨è£ébyName</h3>
<pre><code class="language-xml">&lt;!--        èªå¨è£éï¼byNameã ä¹æ¯åºäºsetç--&gt;
&lt;!--    æ ¹æ®åå­èªå¨è£éï¼å¶ä¸­OrderDaoæ¯OrderServiceéé¢çä¸ä¸ªå±æ§ãå¿é¡»æsetæ¹æ³--&gt;
    &lt;bean id="orderServiceBean" class="com.ali.service.OrderService" autowire="byName"&gt;&lt;/bean&gt;

&lt;!--    è¿ä¸ªid å¿é¡»æ¯OrderServiceä¸­setæ¹æ³å»æâsetâåé¦å­æ¯å°å--&gt;
    &lt;bean id="orderDao" class="com.ali.dao.OrderDao"&gt;&lt;/bean&gt;
</code></pre>
<h3 id="åºäºxmlçèªå¨è£ébytype">åºäºxmlçèªå¨è£ébyType</h3>
<pre><code class="language-xml">&lt;!--     æ ¹æ®ç±»åèªå¨è£éï¼èªå¨è£éæ¯åºäºsetæ¹æ³ç
         æ ¹æ®ç±»åè¿è¡èªå¨è£éæ¶ï¼éç½®æä»¶ä¸­æä¸ªç±»åçå®ä¾åªè½æä¸ä¸ª
         --&gt;
    &lt;bean class="com.ali.dao.VipDao"&gt;&lt;/bean&gt;
    &lt;bean class="com.ali.dao.UserDao"&gt;&lt;/bean&gt;
&lt;!--    CustomerServiceç±»éé¢VipDaoåUserDaoå±æ§ï¼è¿2ä¸ªå±æ§å¿é¡»æsetæ¹æ³æè½èªå¨æ³¨å¥ä¸é¢2ä¸ªbean--&gt;
    &lt;bean id="customerServiceBean" class="com.ali.service.CustomerService" autowire="byType"&gt;&lt;/bean&gt;

&lt;/beans&gt;
</code></pre>
<h3 id="å¼å¥å¤é¨çå±æ§éç½®æä»¶">å¼å¥å¤é¨çå±æ§éç½®æä»¶</h3>
<pre><code class="language-xml">   &lt;!-- å¼å¥å¤é¨çpropertiesæä»¶
     ç¬¬ä¸æ­¥ï¼å¼å¥contextå½åç©ºé´ xmlns:context="http://www.springframework.org/schema/context"
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
     ç¬¬äºæ­¥ï¼ä½¿ç¨&lt;context:property-placeholder&gt;æ ç­¾å¼å¥å¤é¨çpropertiesæä»¶,é»è®¤ä»ç±»çæ ¹è·¯å¾ä¸å è½½
     --&gt;
    &lt;context:property-placeholder location="classpath:jdbc.properties"/&gt;

    &lt;bean id="mydataSource" class="com.ali.bean.MyDataSource"&gt;
        &lt;!-- ä½¿ç¨${}å ä½ç¬¦å¼ç¨å¤é¨propertiesæä»¶ä¸­çå±æ§å¼ è¿4ä¸ªå±æ§å¿é¡»æsetæ¹æ³--&gt;
        &lt;property name="driver" value="${jdbc.diverClass}"/&gt;
        &lt;property name="url" value="${jdbc.url}"/&gt;
        &lt;property name="username" value="${jdbc.username}"/&gt;
        &lt;property name="password" value="${jdbc.password}"/&gt;
    &lt;/bean&gt;
</code></pre>
<p>jdbc.propertiesæä»¶</p>
<pre><code class="language-properties">jdbc.diverClass=com.mysql.cj.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/spring6db?useSSL=false&amp;server
jdbc.username=root
jdbc.password=123456
</code></pre>
<h1 id="springæä¹å®ä¾åå¯¹è±¡">springæä¹å®ä¾åå¯¹è±¡ï¼</h1>
<p>é»è®¤æåµä¸springéè¿åå°æºå¶ï¼è°ç¨ç±»çæ åæ°æé æ¹æ³å®ä¾åå¯¹è±¡</p>
<p>æåå»ºå¥½çå¯¹è±¡å­å¨å°Mapç»æä¸­ã</p>
<p>å½æå¤ä¸ªéç½®æä»¶æ¶ï¼å¯è¯»åå¤ä¸ªéç½®æä»¶</p>
<pre><code class="language-java">ApplicationContext context = new ClassPathXmlApplicationContext("spring.xml","spring-dao.xml");
</code></pre>
<p>å¯ä»¥å¨éç½®æä»¶ä¸­æ³¨å¥jdkèªå¸¦çç±»ï¼åªè¦è¿ä¸ªç±»ææ åæ°æé æ¹æ³å°±è¡ã</p>
<p>getBeanï¼ï¼æ¶ï¼Beançidä¸å­å¨æ¶ä¼æ¥é</p>
<h2 id="ä»ç±»è·¯å¾ä¹å¤çè·¯å¾è·åxmléç½®æä»¶">ä»ç±»è·¯å¾ä¹å¤çè·¯å¾è·åxmléç½®æä»¶</h2>
<pre><code class="language-java">// è¯»åç±»è·¯å¾ä¹å¤çéç½®æä»¶
ApplicationContext context = new FileSystemXmlApplicationContext("D:/applicationContext.xml");
Object user=  context.getBean("user"); // è·åspringå®¹å¨ä¸­çå¯¹è±¡
</code></pre>
<p>ApplicationContextçè¶çº§ç¶æ¥å£æ¯BeanFactoryã</p>
<p>BeanFactoryæ¯Iocå®¹å¨çé¡¶çº§æ¥å£ã</p>
<p>springçIocå®¹å¨åºå±ä½¿ç¨äºå·¥åæ¨¡å¼ã</p>
<h1 id="å¯ç¨log4j2">å¯ç¨Log4j2</h1>
<p>spring5ä¹åæ¯æLog4j2æ¡æ¶ã</p>
<ol>
<li>å¼å¥ä¾èµ</li>
</ol>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
    &lt;artifactId&gt;log4j-slf4j2-impl&lt;/artifactId&gt;
    &lt;version&gt;2.19.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
    &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;
    &lt;version&gt;2.19.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<ol>
<li>ç¼åéç½®æä»¶ï¼æä»¶åå¿é¡»æ¯log4j2.xmlï¼æ¾å¨ç±»æ ¹è·¯å¾ä¸</li>
</ol>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;configuration&gt;

    &lt;loggers&gt;
        &lt;!--
            levelæå®æ¥å¿çº§å«ï¼ä»ä½å°é«çä¼åçº§ï¼
                ALL &lt; TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATAL &lt; OFF
        --&gt;
        &lt;root level="DEBUG"&gt;
            &lt;appender-ref ref="spring6log"/&gt;
        &lt;/root&gt;
    &lt;/loggers&gt;

    &lt;appenders&gt;
        &lt;!--è¾åºæ¥å¿ä¿¡æ¯å°æ§å¶å°--&gt;
        &lt;console name="spring6log" target="SYSTEM_OUT"&gt;
            &lt;!--æ§å¶æ¥å¿è¾åºçæ ¼å¼--&gt;
            &lt;PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss SSS} [%t] %-3level %logger{1024} - %msg%n"/&gt;
        &lt;/console&gt;
    &lt;/appenders&gt;

&lt;/configuration&gt;
</code></pre>
<ol>
<li>ä½¿ç¨æ¥å¿æ¡æ¶ ï¼å¨SpringTest01ç±»ä¸­ä½¿ç¨å¦ä¸ä»£ç </li>
</ol>
<pre><code class="language-java">Logger logger = LoggerFactory.getLogger(SpringTest01.class);
logger.info("æ¥å¿ä¿¡æ¯");
</code></pre>


</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/alineverstop/" target="_blank">NE_STOP</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/alineverstop/p/19563560" target="_blank">https://www.cnblogs.com/alineverstop/p/19563560</a></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 12:12">2026-02-02 12:12</span>&nbsp;
<a href="https://www.cnblogs.com/alineverstop">NE_STOP</a>&nbsp;
éè¯»(<span id="post_view_count">8</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19563560);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19563560', targetLink: 'https://www.cnblogs.com/alineverstop/p/19563560', title: 'spring6-å¤ç§ç±»åçæ³¨å¥æ¹å¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å¤©ç¿¼äºå¨é¢ä¸çº¿Moltbotï¼éè¿äºä¸»æºãAIäºçµèãæ¯å£¤åºç¨æç®¡ä¸é®å¼å¯AIå©æä½éªï¼ ]]></title>
    <link>https://www.cnblogs.com/developer-tianyiyun/p/19563414</link>
    <guid>93c3adf9e05afe9b090ca4a3a853add9</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/developer-tianyiyun/p/19563414" title="åå¸äº 2026-02-02 11:41">
    <span role="heading" aria-level="2">å¤©ç¿¼äºå¨é¢ä¸çº¿Moltbotï¼éè¿äºä¸»æºãAIäºçµèãæ¯å£¤åºç¨æç®¡ä¸é®å¼å¯AIå©æä½éªï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p align="left">å¨äººå·¥æºè½ä»ææ¯æ¼ç¤ºèµ°åè§æ¨¡ååä¸åºç¨çå³é®æ¶æï¼ä¸ä¸ªæ ¸å¿æææ¯å¦ä½å°æå®¢åå±çåæ°è½¬åä¸ºä¼ä¸çº§å¯ç¨çç¨³å¥çäº§åãè¿æï¼å¨æµ·å¤å¼åèç¤¾åºå¼åç°è±¡çº§å³æ³¨çå¼æºAIæºè½ä½Moltbotï¼åClawdbotï¼ï¼å±ç¤ºäºä¸ªäººAIå©ççå¨æ°å¯è½æ§ã</p>
<p align="left">è¿æ¥ï¼å¤©ç¿¼äºå®£å¸å¨é¢ä¸çº¿Moltbotï¼ä¸ºç¨æ·æä¾â7Ã24å°æ¶å¨çº¿çAIå©æâå©åä¼ä¸åä¸ªäººä½é¨æ§ãé«æçå°æ¥æ±AIçäº§åã</p>
<p align="left">æ®æï¼Moltbotæ­¤åå¨æµ·å¤å·²ç§¯ç´¯è¶é«äººæ°ï¼å¶å¨Githubææ°è¶6ä¸ï¼æ¶èæ°çªç ´7200ï¼æç´¢ææ°å¿«éæåå¹¶è¶è¶Claude Codeï¼æä¸ºç¡è°·æå®¢åè¿½æ§çç¦ç¹å·¥å·ï¼è¢«ä¸å°å¼åèç§°ä¸ºâè½çæ­£åäºçAIâãä¸åäºæ®éèå¤©æºå¨äººï¼Moltbotä»¥âææ ¹å·¥ä½æµãä¸»å¨è§£é¾é¢âä¸ºæ ¸å¿å®ä½ï¼å¯æ¥å¥ClaudeãGPTç³»åç­å¤ç§ä¸»æµLLMï¼éåå®¶ææ¯ä¹é¿ï¼è½»æ¾éæäºiMessageãQQãé£ä¹¦ãééç­å¸¸ç¨å¹³å°ï¼å®ç°éæ¶éå°è°ç¨ã</p>
<p>å¨å¤©ç¿¼äºå¹³å°ï¼ç¨æ·å¯éè¿å¤ç§æ¹å¼ä¾¿æ·é¨ç½²Moltbotï¼äº«åä¼ä¸çº§çé«å¯ç¨ä¿éä¸æç®æä½ä½éªãæ éNode.jsãDockerç¥è¯ï¼ä¹æ éæå¿æå¡å¨è¿ç»´ï¼å¤©ç¿¼äºæä¾åå®çç®ååºåº§ï¼ç¡®ä¿äºç«¯æå¡ç¨³å®å¯é ãç®åå¼¹æ§æ©å±ï¼å®ç°æç»­ååºï¼ä¸æçº¿ãæ¯ææéä»è´¹æ¨¡å¼ï¼ç¨æ·ä»ä¸ºå®éæ¶èçèµæºä¹°åï¼æ éé¢åæå¥ç¡¬ä»¶ææ¬ï¼æå¤§éä½äºä½¿ç¨é¨æ§ä¸èµæºæµªè´¹ã</p>
<p align="center"><img alt="" data-src="https://img2024.cnblogs.com/blog/2764337/202602/2764337-20260202113941306-728258389.png" class="lazyload">&nbsp;</p>
<p><strong>éç½®å®æåï¼ç¨æ·è¿å¯å°è¯å¶ä»åºæ¯ï¼è§£éæ´å¤ç©æ³ã</strong>ä¾å¦<strong>æç´¢æ¡é¢åæä»¶å¹¶æ»ç»ï¼å®ç°é«æåå¬ï¼</strong>Moltbotå¯éåäºçµèåç¸å³æä»¶ï¼é«æè¾åºåå«æä»¶åç§°ãç±»åãæ ¸å¿æè¦ãå³é®æ°æ®çç»æåæ»ç»åå®¹ï¼æ éç¨æ·åä¸ä¸ªä¸ªæ¾æä»¶ï¼å¿«éææ¡æä»¶æ ¸å¿ä¿¡æ¯ã</p>
<p align="left">&nbsp;<img alt="" data-src="https://img2024.cnblogs.com/blog/2764337/202602/2764337-20260202113941153-1815608363.png" class="lazyload"></p>
<p>Moltbotè¿å¯ä»¥èªå¨æå¼æµè§å¨è®¿é®æ·å®ãæç´¢å³é®è¯ï¼è¿æ»¤å¹¿ååæ è´§ååï¼æç»è¾åºåå«åååç§°ãå®ä»·ãåºéºãé¾æ¥çåè¡¨ï¼æ¹ä¾¿ç¨æ·å¿«ééæ©ï¼å®ç°æºè½è´­ç©ã</p>
<p align="left">&nbsp;<img alt="" data-src="https://img2024.cnblogs.com/blog/2764337/202602/2764337-20260202113941155-695063280.png" class="lazyload"></p>
<p>ä¾æäºåºç¡è®¾æ½çåå®åºåº§ï¼Moltbotå¨æ¹ä½èµè½åå¬å¨åºæ¯ï¼7Ã24å°æ¶å¼¹æ§äºä¸»æºä¿éAIå©ææ°¸ä¸ç¦»çº¿ï¼Moltbotå¤©ç¿¼AIäºçµèå°äºç«¯AIè½åèå¥å·¥ä½æµï¼å¾®ä¿¡ãWPSãé£ä¹¦ãééãQQç­å¸¸ç¨åå¬è½¯ä»¶ä¸é®å¯¼å¥ãæ ç¼è¡æ¥ï¼é¶é¨ç½²é¶å­¦ä¹ ï¼æºè½åå¬é«æç´è¾¾ï¼è®©æçæ¶å»å¨çº¿ã</p>
<p>éçç±»ä¼¼Moltbotç­å¼æºé¡¹ç®ä¸äºæå¡çæ·±åº¦ç»åï¼ä»¥åå½åååæ¨åºæ´å¤âæ¬ååãå®å¨å¯æ§âçä¼ä¸çº§Agentäº§åï¼AIæ­£å éè½¬åä¸ºåè¡åä¸è§¦æå¯åçæ°è´¨çäº§åãå¤©ç¿¼äºæ­¤æ¬¡éæMoltbotï¼æ­£æ¯äºååä½ä¸ºAIåºç¨âå©æ¨å¨âä¸âç¨³å®å¨âè§è²çä¸æ¬¡å·ä½å®è·µï¼ä¸ºAIæºè½ä½çè§æ¨¡åãè§èååºç¨æä¾äºæ°çèæ¬ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 11:42">2026-02-02 11:41</span>&nbsp;
<a href="https://www.cnblogs.com/developer-tianyiyun">å¤©ç¿¼äºå¼åèç¤¾åº</a>&nbsp;
éè¯»(<span id="post_view_count">22</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19563414);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19563414', targetLink: 'https://www.cnblogs.com/developer-tianyiyun/p/19563414', title: 'å¤©ç¿¼äºå¨é¢ä¸çº¿Moltbotï¼éè¿äºä¸»æºãAIäºçµèãæ¯å£¤åºç¨æç®¡ä¸é®å¼å¯AIå©æä½éªï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æ­å¼ C#ä¸­çå¼æ­¥/ç­å¾ï¼éèç¶ææº ]]></title>
    <link>https://www.cnblogs.com/powertoolsteam/p/19563347</link>
    <guid>68aec35739ac02c773785297846fae7c</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/powertoolsteam/p/19563347" title="åå¸äº 2026-02-02 11:28">
    <span role="heading" aria-level="2">æ­å¼ C#ä¸­çå¼æ­¥/ç­å¾ï¼éèç¶ææº</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="å¼è¨">å¼è¨</h2>
<p>ä½ä¸º.NETå¼åèï¼æä»¬æ¯å¤©é½å¨ä½¿ç¨asyncåawaitå³é®å­æ¥ç¼åå¼æ­¥ä»£ç ãè¿äºå³é®å­è®©å¼æ­¥ä»£ç çèµ·æ¥ååæ­¥ä»£ç ä¸æ ·ç´è§æè¯»ï¼åæ¶é¿åäºåè°å°ç±çé®é¢ãä½ä½ æ¯å¦å¥½å¥è¿ï¼å½C#ç¼è¯å¨éå°asyncæ¹æ³æ¶ï¼åºå±ç©¶ç«åçäºä»ä¹é­æ³ï¼æ¬æå°åºäºå¾®è½¯å®æ¹ææ¡£ï¼æ·±å¥åæasync/awaitèåçç§å¯ââç¼è¯å¨çæçç¶ææºæºå¶ã</p>
<h2 id="æ­£æ">æ­£æ</h2>
<h3 id="å¼æ­¥ç­å¾è§£å³äºä»ä¹é®é¢">å¼æ­¥/ç­å¾è§£å³äºä»ä¹é®é¢ï¼</h3>
<p>å¨ä¼ ç»åæ­¥I/Oæä½ä¸­ï¼å¦æä»¶è¯»åæWeb APIè°ç¨ï¼ï¼è°ç¨çº¿ç¨ä¼è¢«é»å¡ç´å°æä½å®æãè¿å¨UIåºç¨ä¸­ä¼å¯¼è´çé¢å»ç»ï¼å¨æå¡å¨åºç¨ä¸­åé æçº¿ç¨èµæºçæµªè´¹ãasync/awaitéè¿éé»å¡çå¼æ­¥æä½è§£å³äºè¿äºé®é¢ï¼åæ¶ä¿æäºä»£ç ççº¿æ§ç»æåå¯è¯»æ§ã</p>
<h3 id="ç¼è¯å¨çè½¬æ¢ä»æ¹æ³å°ç¶ææº">ç¼è¯å¨çè½¬æ¢ï¼ä»æ¹æ³å°ç¶ææº</h3>
<p>å½ä½ ç¨asyncæ è®°ä¸ä¸ªæ¹æ³æ¶ï¼C#ç¼è¯å¨å¹¶ä¸ä¼ç´æ¥æ§è¡ä½ çä»£ç ãç¸åï¼å®ä¼å°è¯¥æ¹æ³éåä¸ºä¸ä¸ªç¶ææºç»æä½ãè¿ä¸ªç»æä½å®ç°äºIAsyncStateMachineæ¥å£ï¼åå«ä»¥ä¸å³é®é¨åï¼</p>
<ul>
<li>å½åç¶æï¼æ´æ°ï¼è¡¨ç¤ºæ§è¡æåçä½ç½®ï¼</li>
<li>æè·çå±é¨åéååæ°ï¼æåä¸ºå­æ®µä»¥ä¾¿å¨awaitä¹é´ä¿æç¶æï¼</li>
<li>æ¹æ³æå»ºå¨ï¼å¦AsyncTaskMethodBuilderç¨äºTaskè¿åï¼</li>
</ul>
<p>åå§æ¹æ³è¢«è½¬æ¢ä¸ºä¸ä¸ªå­æ ¹(stub)æ¹æ³ï¼å®å¨æ ä¸åå»ºç¶ææºå®ä¾ï¼åå§åå¹¶å¯å¨å®ãèä½ çä¸»è¦ä»£ç é»è¾åè¢«ç§»å¨å°ç¶ææºçMoveNext()æ¹æ³ä¸­ï¼éè¿ç¶æå¼åswitchè¯­å¥å®ç°æ§è¡ç¹çè·³è½¬ã</p>
<p>ç¹å«éè¦çæ¯ï¼å¦æå¼æ­¥æ¹æ³åæ­¥å®æï¼ææç­å¾çæä½å·²ç»å®æï¼ï¼ç¶ææºå°ä¿çå¨æ ä¸ï¼ä¸ä¼åçå åéãåªæå½çæ­£çawaitæåæ§è¡æ¶ï¼ç»æä½æä¼è¢«è£ç®±å°å ä¸­ã</p>
<h3 id="ä¸ä¸ªç®åç¤ºä¾">ä¸ä¸ªç®åç¤ºä¾</h3>
<p>èèä»¥ä¸å¼æ­¥æ¹æ³ï¼</p>
<pre><code class="language-csharp">public async Task&lt;int&gt; DownloadDataAsync(string url)
{
    using var client = new HttpClient();
    string data = await client.GetStringAsync(url);
    return data.Length;
}
</code></pre>
<p>å¨ç¼è¯æ¶ï¼ç¼è¯å¨ä¼å°è¯¥æ¹æ³éåä¸ºç¶ææºç»æä½ï¼å¹¶çæä¸ä¸ªå­æ ¹æ¹æ³æ¿æ¢åå§æ¹æ³ç­¾åãæ¹æ³ä½è¢«æåå¹¶ç§»å¥ç¶ææºçMoveNext()æ¹æ³ä¸­ï¼æç¶æç»ç»ã</p>
<p>è¿è¡æ¶è°ç¨æµç¨ï¼</p>
<ol>
<li>çæçå­æ ¹åå»ºç¶ææºå®ä¾ï¼åå§å¨æ ä¸ï¼</li>
<li>åå§åç¶ææºï¼ç¶æè®¾ä¸º-1ï¼æè·å¿è¦åæ°/å±é¨åéï¼</li>
<li>è°ç¨MoveNext()å¼å§æ§è¡</li>
</ol>
<p>å¨MoveNext()åé¨ï¼</p>
<ul>
<li>æ§è¡ä»å½åç¶æå¼å§ï¼ç´å°éå°await</li>
<li>å¦æç­å¾çä»»å¡å·²å®æï¼ç»§ç»­åæ­¥æ§è¡ï¼å¿«éè·¯å¾ï¼æ å åéï¼</li>
<li>å¦æä»»å¡æªå®æï¼æ³¨åç»§ç»­åè°ï¼ç«å³è¿åæ§å¶ï¼éé»å¡ï¼ï¼å¹¶æåæ§è¡</li>
<li>ä»»å¡å®æåï¼ç»§ç»­åè°ä¼åæ¬¡è°ç¨MoveNext()ï¼ä»awaitç¹æ¢å¤æ§è¡</li>
</ul>
<h3 id="ç¼è¯å¨çæçç¶ææº">ç¼è¯å¨çæçç¶ææº</h3>
<p>ä»¥ä¸æ¯ç¼è¯å¨çæçç¶ææºç®åä¼ªä»£ç ï¼åºäºReleaseæ¨¡å¼ä¸çåç¼è¯ç»æï¼ï¼</p>
<pre><code class="language-csharp">private struct &lt;DownloadDataAsync&gt;d__1 : IAsyncStateMachine
{
    public int &lt;&gt;1__state;                      // ç¶æï¼-1=å¼å§ï¼0=ç­å¾ä¸­ï¼-2=å®æ
    public AsyncTaskMethodBuilder&lt;int&gt; &lt;&gt;t__builder;
    public string url;                          // æè·çåæ°
    private string &lt;data&gt;5__2;                  // æåçå±é¨åé
    private HttpClient &lt;client&gt;5__3;            // usingåéä¹è¢«æå

    private void MoveNext()
    {
        int num = this.&lt;&gt;1__state;
        try
        {
            if (num == -1)                          // åå§æ§è¡
            {
                this.&lt;client&gt;5__3 = new HttpClient();
                Task&lt;string&gt; getTask = this.&lt;client&gt;5__3.GetStringAsync(this.url);

                var awaiter = getTask.GetAwaiter();
                if (!awaiter.IsCompleted)
                {
                    this.&lt;&gt;1__state = 0;            // æ è®°ä¸ºç­å¾ä¸­
                    this.&lt;&gt;t__builder.AwaitUnsafeOnCompleted(ref awaiter, ref this);
                    return;                         // å¨æ­¤æå - ç»§ç»­åè°ç¨åè°ç¨MoveNext
                }

                // å·²å®ææ¶çå¿«éè·¯å¾
                this.&lt;data&gt;5__2 = awaiter.GetResult();
            }
            else                                    // num == 0 â awaitåæ¢å¤
            {
                this.&lt;data&gt;5__2 = /* awaiter.GetResult()é»è¾ */;
            }

            // awaitä¹åçä»£ç 
            int result = this.&lt;data&gt;5__2.Length;

            // æ¸ç
            this.&lt;client&gt;5__3?.Dispose();

            // è®¾ç½®æç»ç»æ
            this.&lt;&gt;1__state = -2;
            this.&lt;&gt;t__builder.SetResult(result);
        }
        catch (Exception exception)
        {
            this.&lt;&gt;1__state = -2;
            this.&lt;&gt;t__builder.SetException(exception);
        }
    }

    void IAsyncStateMachine.MoveNext() =&gt; MoveNext();
    // SetStateMachine(...)ä¸ºç®æ´çç¥
}
</code></pre>
<p>åå§æ¹æ³è¢«è½¬æ¢ä¸ºç±»ä¼¼è¿æ ·çå­æ ¹ï¼</p>
<pre><code class="language-csharp">public Task&lt;int&gt; DownloadDataAsync(string url)
{
    var stateMachine = new &lt;DownloadDataAsync&gt;d__1();
    stateMachine.&lt;&gt;t__builder = AsyncTaskMethodBuilder&lt;int&gt;.Create();
    stateMachine.url = url;
    stateMachine.&lt;&gt;1__state = -1;
    stateMachine.&lt;&gt;t__builder.Start(ref stateMachine);
    return stateMachine.&lt;&gt;t__builder.Task;
}
</code></pre>
<h3 id="çè§£ç¶ææºçéè¦æ§">çè§£ç¶ææºçéè¦æ§</h3>
<p>çè§£ç¶ææºçå·¥ä½æºå¶æå©äºæä»¬ï¼</p>
<ol>
<li>è®¤è¯åæ­¥å®ææ¶çé¶åéå¿«éè·¯å¾</li>
<li>çè§£ä¸ºä»ä¹å±é¨åééè¦è¢«æè·ï¼å®ä»¬æä¸ºç»æä½çå­æ®µä»¥ä¾¿å¨æååæ¢å¤ç¶ææ¶ä½¿ç¨ï¼</li>
<li>ææ¡æ­£ç¡®çæ§è½ç¹å¾ï¼å½æä½æ­£ç¡®æ¶å¼éæå°ï¼</li>
</ol>
<p>æ­£å¦å¾®è½¯ææ¡£æè¿°ï¼"ç¼è¯å¨ä¼æä½ çç¨åºè½¬åä¸ºç¶ææºãè¯¥æé ä¼è¿½è¸ªä»£ç ä¸­çåç§æä½åç¶æï¼æ¯å¦å½ä»£ç è¾¾å°ç­å¾è¡¨è¾¾å¼æ¶æ¾å¼æ§è¡ï¼ä»¥åå¨åå°ä½ä¸å®ææ¶æ¢å¤æ§è¡ã"</p>
<h2 id="ç»è®º">ç»è®º</h2>
<p>async/awaitä¸ä»ä»æ¯è®©å¼æ­¥ä»£ç æ´ç®æ´çè¯­æ³ç³ï¼å¶èåæ¯ç¼è¯å¨å°é¡ºåºé»è¾è½¬æ¢ä¸ºé«æç¶ææºçå¤æè¿ç¨ãéè¿æ·±å¥çè§£è¿ä¸æºå¶ï¼æä»¬å¯ä»¥ï¼</p>
<ul>
<li>ç¼åæ´é«æçå¼æ­¥ä»£ç </li>
<li>é¿åå¸¸è§çæ§è½é·é±</li>
<li>æ´å¥½å°è°è¯å¼æ­¥ç¨åº</li>
</ul>
<p>ä¸æ¬¡ä½¿ç¨async/awaitæ¶ï¼è¯·è®°ä½ï¼ä½ æ­£å¨å©ç¨C#ç¼è¯å¨çå¼ºå¤§é­æ³ï¼å°çä¼¼ç®åçé¡ºåºä»£ç è½¬æ¢ä¸ºé«æçç¶ææºå®ç°ãè¿ç§çè§£å°å¸®å©ä½ æä¸ºæ´ä¼ç§ç.NETå¼åèã</p>


</div>
<div id="MySignature" role="contentinfo">
    <hr>
<br>
<p style="font-size: 16px; font-family: å¾®è½¯éé», é»ä½, Arial; color: #000">æ¬ææ¯ç±è¡èåææ¯å¼åå¢éåå¸ï¼è½¬è½½è¯·æ³¨æåºå¤ï¼<a href="https://www.grapecity.com.cn/" target="_blank">è¡èåå®ç½</a></p>
<!--p style="font-size: 16px; font-family: å¾®è½¯éé», é»ä½, Arial; color: #000">äºè§£ä¼ä¸çº§ä½ä»£ç å¼åå¹³å°ï¼è¯·åå¾<a href="https://www.grapecity.com.cn/solutions/huozige" target="_blank">æ´»å­æ ¼</a>
</p><p style="font-size: 16px; font-family: å¾®è½¯éé», é»ä½, Arial; color: #000">äºè§£å¯åµå¥æ¨ç³»ç»çå¨çº¿ Excelï¼è¯·åå¾<a href="https://www.grapecity.com.cn/developer/spreadjs" target="_blank">SpreadJSçº¯åç«¯è¡¨æ ¼æ§ä»¶</a></p>
<p style="font-size: 16px; font-family: å¾®è½¯éé», é»ä½, Arial; color: #000">äºè§£åµå¥å¼çåä¸æºè½åæ¥è¡¨è½¯ä»¶ï¼è¯·åå¾<a href="https://www.grapecity.com.cn/solutions/wyn" target="_blank">Wyn Enterprise
</a></p-->

<br>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 11:29">2026-02-02 11:28</span>&nbsp;
<a href="https://www.cnblogs.com/powertoolsteam">è¡èåææ¯å¢é</a>&nbsp;
éè¯»(<span id="post_view_count">39</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19563347);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19563347', targetLink: 'https://www.cnblogs.com/powertoolsteam/p/19563347', title: 'æ­å¼ C#ä¸­çå¼æ­¥/ç­å¾ï¼éèç¶ææº' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å¨ Cloudflare å¹³å°ä¸æå»ºåç´å¾®åç«¯ ]]></title>
    <link>https://www.cnblogs.com/didispace/p/19563285</link>
    <guid>5219275cd812a32c6e4b89258671eaf4</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/didispace/p/19563285" title="åå¸äº 2026-02-02 11:21">
    <span role="heading" aria-level="2">å¨ Cloudflare å¹³å°ä¸æå»ºåç´å¾®åç«¯</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æ³è±¡ä¸ä¸ï¼ä½ æ­£å¨å¼åä¸ä¸ªå¤§åWebåºç¨ãè¥éå¢éæ³è¦ç¨Astroæå»ºä»ä»¬çé¡µé¢ä»¥è·å¾æä½³çSEOææï¼èäº§åå¢éå´åæè¦ç¨Reactæ¥æå»ºåè½ä¸°å¯çåå°ç®¡çç³»ç»ãæ´ç³ç³çæ¯ï¼æ¯æ¬¡åå¸æ°çæ¬æ¶ï¼åå ä¸ªå¢éçä»£ç é½éè¦ä¸èµ·æåãä¸èµ·æµè¯ãä¸èµ·ä¸çº¿ââåªè¦å¶ä¸­ä¸ä¸ªå¢éå¼å¥äºä¸ä¸ªbugï¼æ´ä¸ªåå¸å°±è¦åæ»ãè¿ç§"ä¸è£ä¿±è£ãä¸æä¿±æ"çè¦åæ¹å¼ï¼æ¯ä¸æ¯è®©ä½ æå°æ æ¯å¤´ç¼ï¼</p>
<p>æèï¼ä½ çå¬å¸ååæ¶è´­äºä¸ä¸ªåä¸å¬å¸ï¼ä»ä»¬çäº§åæ¯ç¨Vueåçï¼èä½ ä»¬çä¸»ç«æ¯ç¨Reactåçãä½ æ³æä»ä»¬çåè½æ´åè¿æ¥ï¼ä½åä¸å¸ææä¸¤ä¸ªå®å¨ä¸åçä»£ç åºå¼ºè¡æ··å¨ä¸èµ·ã</p>
<p>è¿äºé½æ¯ç°ä»£Webå¼åä¸­çå®å­å¨çé¾é¢ãä¼ ç»çå¾®åç«¯æ¶æéå¸¸æ¯"æ°´å¹³"çââåä¸ä¸ªé¡µé¢ä¸çä¸åç»ä»¶æ¥èªä¸åçæå¡ãä½å¦ææä¸ç§æ¹å¼ï¼è½è®©æ¯ä¸ªå¢éå®å¨ç¬ç«å°å¼åãé¨ç½²åç»´æ¤èªå·±çåè½æ¨¡åï¼èç¨æ·å´æè§å¨ä½¿ç¨ä¸ä¸ªæ ç¼çãç»ä¸çåºç¨å¢ï¼</p>
<p>è¿å°±æ¯åç´å¾®åç«¯ï¼Vertical Microfrontendsï¼è¦è§£å³çé®é¢ãç°å¨ï¼Cloudflareæ¨åºäºä¸æ¬¾å¨æ°çWorkeræ¨¡æ¿ï¼è®©è¿ç§æ¶æåå¾åææªæçç®åã</p>
<h2 id="ä»ä¹æ¯åç´å¾®åç«¯">ä»ä¹æ¯åç´å¾®åç«¯ï¼</h2>
<p>åç´å¾®åç«¯æ¯ä¸ç§æ¶ææ¨¡å¼ï¼åä¸ªç¬ç«å¢éæ¥æåºç¨ç¨åºåè½çå®æ´åçï¼ä»ç¨æ·çé¢ä¸ç´å°åºå±çCI/CDæµæ°´çº¿ãè¿äºåçéè¿ååä¸çè·¯å¾æ¥å®ä¹ï¼ä½ å¯ä»¥å°åä¸ªç¬ç«çWorkerä¸ç¹å®è·¯å¾å³èèµ·æ¥ï¼</p>
<pre><code class="language-text">/      = è¥éç½ç«
/docs  = ææ¡£
/blog  = åå®¢
/dash  = ä»ªè¡¨ç
</code></pre>
<p>æä»¬è¿å¯ä»¥è¿ä¸æ­¥ç»åï¼å¨æ´ç»ç²åº¦çå­è·¯å¾ä¸å³èä¸åçWorkerãæ¯å¦å¨ä»ªè¡¨çä¸­ï¼ä½ å¯è½éè¿åç§åè½æäº§åæ¥ååURLè·¯å¾çæ·±åº¦ï¼ä¾å¦ <code>/dash/product-a</code>ï¼ï¼å¨ä¸¤ä¸ªäº§åä¹é´å¯¼èªå¯è½æå³çä¸¤ä¸ªå®å¨ä¸åçä»£ç åºã</p>
<p>ç°å¨æäºåç´å¾®åç«¯ï¼æä»¬è¿å¯ä»¥è¿æ ·è®¾è®¡ï¼</p>
<pre><code class="language-text">/dash/product-a  = WorkerA
/dash/product-b  = WorkerB
</code></pre>
<p>ä¸é¢çæ¯ä¸ªè·¯å¾é½æ¯ç¬ç«çåç«¯é¡¹ç®ï¼å®ä»¬ä¹é´æ²¡æä»»ä½å±äº«ä»£ç ã<code>product-a</code> å <code>product-b</code> è·¯ç±æ å°å°åå«é¨ç½²çåç«¯åºç¨ï¼å®ä»¬æèªå·±çæ¡æ¶ãåºãCI/CDæµæ°´çº¿ï¼ç±åèªçå¢éå®ä¹åæ¥æã</p>
<p>ä½ å¯ä»¥ç«¯å°ç«¯å°æ¥æèªå·±çä»£ç ãä½ç°å¨æä»¬éè¦æ¾å°ä¸ç§æ¹æ³å°è¿äºç¬ç«çé¡¹ç®ç¼åå¨ä¸èµ·ï¼æ´éè¦çæ¯ï¼è®©å®ä»¬æè§åæ¯ä¸ä¸ªç»ä¸çä½éªã</p>
<p>Cloudflareèªå·±ä¹å¨ç»åè¿ä¸ªçç¹ï¼å ä¸ºä»ªè¡¨çæè®¸å¤ç¬ç«çå¢éè´è´£åèªçäº§åãå¢éå¿é¡»é¢å¯¹ä¸ä¸ªäºå®ï¼å¨ä»ä»¬æ§å¶èå´ä¹å¤æåçæ´æ¹ä¼å½±åç¨æ·å¯¹å¶äº§åçä½éªã</p>
<p>å¨åé¨ï¼æä»¬ç°å¨å¯¹èªå·±çä»ªè¡¨çä¹éç¨äºç±»ä¼¼çç­ç¥ãå½ç¨æ·ä»æ ¸å¿ä»ªè¡¨çå¯¼èªå°æä»¬çZeroTrustäº§åæ¶ï¼å®éä¸å®ä»¬æ¯ä¸¤ä¸ªå®å¨ç¬ç«çé¡¹ç®ï¼ç¨æ·åªæ¯éè¿è·¯å¾ <code>/:accountId/one</code> è¢«è·¯ç±å°é£ä¸ªé¡¹ç®ã</p>
<h2 id="è§è§ä¸çç»ä¸ä½éª">è§è§ä¸çç»ä¸ä½éª</h2>
<p>å°è¿äºç¬ç«é¡¹ç®ç¼åå¨ä¸èµ·ï¼è®©å®ä»¬æè§åä¸ä¸ªç»ä¸çä½éªï¼å¹¶æ²¡æä½ æ³è±¡çé£ä¹å°é¾ï¼åªéè¦å è¡CSSé­æ³ãæä»¬ç»å¯¹ä¸å¸æåççäºææ¯å°æä»¬çå®ç°ç»èååé¨å³ç­æ³é²ç»ç¨æ·ãå¦ææä»¬æ æ³è®©è¿ä¸ªç¨æ·ä½éªæè§åä¸ä¸ªç»ä¸çåç«¯ï¼é£æä»¬å°±å¯¹ç¨æ·ç¯ä¸äºä¸¥éçéè¯¯ã</p>
<p>è¦å®ç°è¿ç§å·§å¦çææ³ï¼è®©æä»¬åäºè§£ä¸ä¸è§å¾è¿æ¸¡åææ¡£é¢å è½½æ¯å¦ä½åæ¥ä½ç¨çã</p>
<h3 id="è§å¾è¿æ¸¡">è§å¾è¿æ¸¡</h3>
<p>å½æä»¬æ³è¦å¨ä¸¤ä¸ªä¸åé¡µé¢ä¹é´æ ç¼å¯¼èªï¼åæ¶è®©æç»ç¨æ·æè§æµçæ¶ï¼è§å¾è¿æ¸¡éå¸¸æç¨ãå¨é¡µé¢ä¸å®ä¹ç¹å®çDOMåç´ ï¼è®©å®ä»¬ä¸ç´ä¿çå°ä¸ä¸é¡µå¯è§ï¼å¹¶å®ä¹ä»»ä½ååçå¤çæ¹å¼ï¼è¿æä¸ºäºå¤é¡µåºç¨çå¼ºå¤§ç¼åå·¥å·ã</p>
<p>ç¶èï¼å¨æäºæåµä¸ï¼è®©åä¸ªåç´å¾®åç«¯æè§ä¸åä¹æ¯å®å¨å¯ä»¥æ¥åçãæ¯å¦æä»¬çè¥éç½ç«ãææ¡£åä»ªè¡¨çï¼å®ä»¬åèªé½æç¬ç¹çå®ä¹ãç¨æ·ä¸ä¼ææè¿ä¸èå¨å¯¼èªæ¶é½æè§ç»ä¸ãä½æ¯â¦â¦å¦æä½ å³å®å¨åä¸ªä½éªä¸­å¼å¥åç´åçï¼ä¾å¦ <code>/dash/product-a</code> å <code>/dash/product-b</code>ï¼ï¼é£ä¹ç¨æ·ç»å¯¹ä¸åºè¯¥ç¥éå®ä»¬åºå±æ¯ä¸¤ä¸ªä¸åçä»åº/Worker/é¡¹ç®ã</p>
<p>å¥½äºï¼è¯´å¾å¤å¤äºââè®©æä»¬å¼å§å¨æå§ãæè¯´è¿è®©ä¸¤ä¸ªç¬ç«çé¡¹ç®å¯¹ç¨æ·æ¥è¯´æè§åæ¯ä¸ä¸ªæ¯ä½ææ¬çï¼å¦æä½ è¿æ²¡æå¬è¯´è¿CSSè§å¾è¿æ¸¡ï¼é£ä¹æ¥ä¸æ¥æè¦è®©ä½ å¤§å¼ç¼çäºã</p>
<p>å¦ææåè¯ä½ ï¼ä½ å¯ä»¥å¨åé¡µåºç¨ï¼SPAï¼æå¤é¡µåºç¨ï¼MPAï¼çä¸åè§å¾ä¹é´åå»ºå¨ç»è¿æ¸¡ï¼è®©å®ä»¬æè§åæ¯ä¸ä¸ªæ´ä½ï¼å¨æ·»å ä»»ä½è§å¾è¿æ¸¡ä¹åï¼å¦ææä»¬å¯¼èªå±äºä¸¤ä¸ªä¸åWorkerçé¡µé¢ï¼ä¸­é´å è½½ç¶æä¼æ¯æµè§å¨ä¸­çç½è²ç©ºç½å±å¹ï¼æç»­å ç¾æ¯«ç§ï¼ç´å°ä¸ä¸é¡µå¼å§æ¸²æãé¡µé¢ä¸ä¼æè§ç»ä¸ï¼å½ç¶ä¹ä¸ä¼ååé¡µåºç¨ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/626506/202602/626506-20260202112120453-1896817171.png" class="lazyload"></p>
<p>å¦æå¸æåç´ ä¿çï¼èä¸æ¯çå°ç½è²ç©ºç½é¡µï¼æä»¬å¯ä»¥éè¿å®ä¹CSSè§å¾è¿æ¸¡æ¥å®ç°ãéè¿ä¸é¢çä»£ç ï¼æä»¬åè¯å½åææ¡£é¡µé¢ï¼å½è§å¾è¿æ¸¡äºä»¶å³å°åçæ¶ï¼å°<code>nav</code> DOMåç´ ä¿çå¨å±å¹ä¸ï¼å¦æç°æé¡µé¢åç®æ é¡µé¢ä¹é´å­å¨ä»»ä½å¤è§å·®å¼ï¼æä»¬å°ä½¿ç¨<code>ease-in-out</code>è¿æ¸¡æ¥å¨ç»å±ç¤ºã</p>
<p>çªç¶ä¹é´ï¼ä¸¤ä¸ªä¸åçWorkeræè§å°±åä¸ä¸ªäºã</p>
<pre><code class="language-css">@supports (view-transition-name: none) {
  ::view-transition-old(root),
  ::view-transition-new(root) {
    animation-duration: 0.3s;
    animation-timing-function: ease-in-out;
  }
  nav { view-transition-name: navigation; }
}
</code></pre>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/626506/202602/626506-20260202112120588-651263314.png" class="lazyload"></p>
<h3 id="é¢å è½½">é¢å è½½</h3>
<p>å¨ä¸¤ä¸ªé¡µé¢ä¹é´è¿æ¸¡è®©å®"çèµ·æ¥"æ ç¼ââæä»¬è¿å¸æå®"æè§"åå®¢æ·ç«¯SPAä¸æ ·å³æ¶ãè½ç¶ç®åFirefoxåSafariä¸æ¯æSpeculation Rulesï¼ä½Chrome/Edge/Operaç¡®å®æ¯æè¿ä¸ªè¾æ°çAPIãSpeculation Rules APIæ¨å¨æé«æªæ¥å¯¼èªçæ§è½ï¼ç¹å«æ¯å¯¹äºææ¡£URLï¼è®©å¤é¡µåºç¨æè§æ´ååé¡µåºç¨ã</p>
<p>åè§£æä»£ç ï¼æä»¬éè¦å®ä¹ä¸ä¸ªç¹å®æ ¼å¼çèæ¬è§åï¼åè¯æ¯æçæµè§å¨å¦ä½é¢åä¸æä»¬Webåºç¨ç¨åºè¿æ¥çå¶ä»åç´åçââå¯è½éè¿æäºå±äº«å¯¼èªé¾æ¥ã</p>
<pre><code class="language-html">&lt;script type="speculationrules"&gt;
  {
    "prefetch": [
      {
        "urls": ["https://product-a.com", "https://product-b.com"],
        "requires": ["anonymous-client-ip-when-cross-origin"],
        "referrer_policy": "no-referrer"
      }
    ]
  }
&lt;/script&gt;
</code></pre>
<p>æäºè¿äºï¼æä»¬çåºç¨ç¨åºä¼é¢åå¶ä»å¾®åç«¯å¹¶å°å®ä»¬ä¿çå¨åå­ç¼å­ä¸­ï¼æä»¥å¦ææä»¬å¯¼èªå°é£äºé¡µé¢ï¼ä¼æè§å ä¹æ¯å³æ¶çã</p>
<p>å¯¹äºææ¾å¯åºåçåç´åçï¼è¥éãææ¡£ãä»ªè¡¨çï¼ï¼ä½ å¯è½ä¸éè¦è¿æ ·åï¼å ä¸ºç¨æ·å¨å®ä»¬ä¹é´å¯¼èªæ¶ä¼é¢ææè½»å¾®çå è½½ãç¶èï¼å½åç´åçå®ä¹å¨ç¹å®å¯è§ä½éªåæ¶ï¼ä¾å¦å¨ä»ªè¡¨çé¡µé¢ä¸­ï¼ï¼å¼ºçå»ºè®®ä½¿ç¨ã</p>
<p>éè¿è§å¾è¿æ¸¡åæ¨æµè§åï¼æä»¬è½å¤å°å®å¨ä¸åçä»£ç ä»åºèç³»å¨ä¸èµ·ï¼æè§å°±åå®ä»¬æ¥èªåé¡µåºç¨ä¸æ ·ãå¦æä½ é®æï¼è¿å¤ªç¥å¥äºã</p>
<h2 id="é¶éç½®è¯·æ±è·¯ç±">é¶éç½®è¯·æ±è·¯ç±</h2>
<p>ç°å¨æä»¬éè¦ä¸ç§æºå¶æ¥æç®¡å¤ä¸ªåºç¨ç¨åºï¼ä»¥åä¸ç§å¨è¯·æ±æµå¥æ¶å°å®ä»¬ç¼åå¨ä¸èµ·çæ¹æ³ãå®ä¹ä¸ä¸ªCloudflare Workerä½ä¸º"è·¯ç±å¨"ï¼åè®¸å¨è¾¹ç¼çåä¸ªé»è¾ç¹å¤çç½ç»è¯·æ±ï¼ç¶åå°å®ä»¬è½¬åç»è´è´£è¯¥URLè·¯å¾çåç´å¾®åç«¯ãèä¸æä»¬å¯ä»¥å°åä¸ªååæ å°å°è¯¥è·¯ç±å¨Workerï¼å¶ä½çå°±"æ­£å¸¸å·¥ä½"äºã</p>
<h3 id="æå¡ç»å®">æå¡ç»å®</h3>
<p>å¦æä½ è¿æ²¡ææ¢ç´¢è¿Cloudflare Workeræå¡ç»å®ï¼é£ä¹å¼å¾è±ç¹æ¶é´äºè§£ä¸ä¸ã</p>
<p>æå¡ç»å®åè®¸ä¸ä¸ªWorkerè°ç¨å¦ä¸ä¸ªWorkerï¼èæ éç»è¿å¬å¼å¯è®¿é®çURLãæå¡ç»å®åè®¸Worker Aè°ç¨Worker Bä¸çæ¹æ³ï¼æå°è¯·æ±ä»Worker Aè½¬åå°Workerãè¿ä¸æ­¥åè§£ï¼è·¯ç±å¨Workerå¯ä»¥è°ç¨å·²å®ä¹çæ¯ä¸ªåç´å¾®åç«¯Workerï¼ä¾å¦è¥éãææ¡£ãä»ªè¡¨çï¼ï¼åè®¾å®ä»¬é½æ¯Cloudflare Workersã</p>
<p>è¿ä¸ºä»ä¹éè¦ï¼è¿æ­£æ¯å°è¿äºåç´åç"ç¼å"å¨ä¸èµ·çæºå¶ãæä»¬å°å¨ä¸ä¸èæ·±å¥æ¢è®¨è¯·æ±è·¯ç±å¦ä½å¤çæµéåå²ãä½è¦å®ä¹è¿äºå¾®åç«¯ä¸­çæ¯ä¸ä¸ªï¼æä»¬éè¦æ´æ°è·¯ç±å¨Workerçwranglerå®ä¹ï¼è¿æ ·å®å°±ç¥éåè®¸è°ç¨åªäºåç«¯ã</p>
<pre><code class="language-json">{
  "$schema": "./node_modules/wrangler/config-schema.json",
  "name": "router",
  "main": "./src/router.js",
  "services": [
    {
      "binding": "HOME",
      "service": "worker_marketing"
    },
    {
      "binding": "DOCS",
      "service": "worker_docs"
    },
    {
      "binding": "DASH",
      "service": "worker_dash"
    }
  ]
}
</code></pre>
<p>ä¸é¢çç¤ºä¾å®ä¹å¨æä»¬çè·¯ç±å¨Workerä¸­ï¼ç¶ååè¯æä»¬è¢«åè®¸åä¸ä¸ªç¬ç«çé¢å¤Workerï¼è¥éãææ¡£åä»ªè¡¨çï¼ååºè¯·æ±ãæäºæéå°±è¿ä¹ç®åï¼ä½è®©æä»¬æ·±å¥ç ç©¶ä¸äºæ´å¤æçé»è¾ï¼åæ¬è¯·æ±è·¯ç±åHTMLéåç½ç»ååºã</p>
<h3 id="è¯·æ±è·¯ç±">è¯·æ±è·¯ç±</h3>
<p>äºè§£äºå¨éè¦æ¶å¯ä»¥è°ç¨çåç§å¶ä»Workerä¹åï¼ç°å¨æä»¬éè¦ä¸äºé»è¾æ¥ç¡®å®ä½æ¶å°ç½ç»è¯·æ±å®åå°åªéãç±äºè·¯ç±å¨Workerè¢«åéå°æä»¬çèªå®ä¹ååï¼ææä¼ å¥çè¯·æ±é¦åå¨ç½ç»è¾¹ç¼å°è¾¾å®ãç¶åå®ç¡®å®åªä¸ªWorkeråºè¯¥å¤çè¯·æ±ï¼å¹¶ç®¡çç»æååºã</p>
<p>ç¬¬ä¸æ­¥æ¯å°URLè·¯å¾æ å°å°å³èçWorkerãå½æ¶å°æä¸ªè¯·æ±URLæ¶ï¼æä»¬éè¦ç¥éå®éè¦è¢«è½¬åå°åªéãæä»¬éè¿å®ä¹è§åæ¥å®ç°è¿ä¸ç¹ãè½ç¶æä»¬æ¯æééç¬¦è·¯ç±ãå¨æè·¯å¾ååæ°çº¦æï¼ä½æä»¬å°ä¸æ³¨äºåºç¡ââå­é¢è·¯å¾åç¼ââå ä¸ºå®æ´æ¸æ¥å°è¯´æäºè¦ç¹ã</p>
<p>å¨è¿ä¸ªä¾å­ä¸­ï¼æä»¬æä¸ä¸ªå¾®åç«¯ï¼</p>
<pre><code class="language-text">/      = è¥é
/docs  = ææ¡£
/dash  = ä»ªè¡¨ç
</code></pre>
<p>ä¸é¢çæ¯ä¸ªè·¯å¾é½éè¦æ å°å°ä¸ä¸ªå®éçWorkerï¼åè§ä¸é¢ç« èä¸­çwrangleræå¡å®ä¹ï¼ãå¯¹äºæä»¬çè·¯ç±å¨Workerï¼æä»¬å®ä¹ä¸ä¸ªé¢å¤çåéï¼åå«ä»¥ä¸æ°æ®ï¼è¿æ ·æä»¬å°±ç¥éåªäºè·¯å¾åºè¯¥æ å°å°åªäºæå¡ç»å®ãç°å¨æä»¬ç¥éå½è¯·æ±è¿æ¥æ¶åºè¯¥å°ç¨æ·è·¯ç±å°åªéï¼å®ä¹ä¸ä¸ªåä¸ºROUTESçwrangleråéï¼åå®¹å¦ä¸ï¼</p>
<pre><code class="language-json">{
  "routes": [
    {"binding": "HOME", "path": "/"},
    {"binding": "DOCS", "path": "/docs"},
    {"binding": "DASH", "path": "/dash"}
  ]
}
</code></pre>
<p>è®©æä»¬è®¾æ³ä¸ä¸ªç¨æ·è®¿é®æä»¬ç½ç«çè·¯å¾ <code>/docs/installation</code>ãå¨åºå±ï¼åççæåµæ¯è¯·æ±é¦åå°è¾¾æä»¬çè·¯ç±å¨Workerï¼å®è´è´£äºè§£ä»ä¹URLè·¯å¾æ å°å°åªä¸ªç¬ç«çWorkerãå®çè§£ <code>/docs</code> è·¯å¾åç¼æ å°å°æä»¬ç <code>DOCS</code> æå¡ç»å®ï¼åç§æä»¬çwrangleræä»¶æåæä»¬ç <code>worker_docs</code> é¡¹ç®ãæä»¬çè·¯ç±å¨Workerç¥é <code>/docs</code> è¢«å®ä¹ä¸ºåç´å¾®åç«¯è·¯ç±ï¼ä»è·¯å¾ä¸­ç§»é¤ <code>/docs</code> åç¼ï¼å°è¯·æ±è½¬åç»æä»¬ç <code>worker_docs</code> Workeræ¥å¤çè¯·æ±ï¼ç¶åæç»è¿åæä»¬å¾å°çä»»ä½ååºã</p>
<p>ä¸ºä»ä¹è¦å é¤ <code>/docs</code> è·¯å¾å¢ï¼è¿æ¯ä¸ä¸ªå®ç°ç»èçéæ©ï¼ç®çæ¯å½Workeréè¿è·¯ç±å¨Workerè®¿é®æ¶ï¼å®å¯ä»¥æ¸çURLæ¥å¤çè¯·æ±ï¼å°±åå®æ¯ä»è·¯ç±å¨Workerå¤é¨è°ç¨çä¸æ ·ãåä»»ä½Cloudflare Workerä¸æ ·ï¼æä»¬ç <code>worker_docs</code> æå¡å¯è½æèªå·±çç¬ç«URLå¯ä»¥è®¿é®ãæä»¬å³å®å¸æè¯¥æå¡URLç»§ç»­ç¬ç«å·¥ä½ãå½å®éå å°æä»¬çæ°è·¯ç±å¨Workeræ¶ï¼å®ä¼èªå¨å¤çç§»é¤åç¼ï¼è¿æ ·æå¡å°±å¯ä»¥ä»èªå·±å®ä¹çURLæéè¿æä»¬çè·¯ç±å¨Workerè®¿é®â¦â¦ä»»ä½å°æ¹é½å¯ä»¥ï¼æ æè°ã</p>
<h3 id="htmlrewriter">HTMLRewriter</h3>
<p>ç¨URLè·¯å¾åå²æä»¬çåç§åç«¯æå¡ï¼ä¾å¦ <code>/docs</code> æ <code>/dash</code>ï¼è®©æä»¬å¾å®¹æè½¬åè¯·æ±ï¼ä½å½æä»¬çååºåå«ä¸ç¥éå®è¢«éè¿è·¯å¾ç»ä»¶ååä»£ççHTMLæ¶â¦â¦å¯ï¼è¿å°±ä¼åºé®é¢ã</p>
<p>åè®¾æä»¬çææ¡£ç½ç«å¨ååºä¸­æä¸ä¸ªå¾çæ ç­¾ <code>&lt;img src="./logo.png" /&gt;</code>ãå¦ææä»¬çç¨æ·æ­£å¨è®¿é®é¡µé¢ <code>https://website.com/docs/</code>ï¼é£ä¹å è½½ <code>logo.png</code> æä»¶å¯è½ä¼å¤±è´¥ï¼å ä¸ºæä»¬ç <code>/docs</code> è·¯å¾åªæ¯ç±æä»¬çè·¯ç±å¨Workeräººä¸ºå®ä¹çã</p>
<p>åªæå½æä»¬çæå¡éè¿è·¯ç±å¨Workerè®¿é®æ¶ï¼æä»¬æéè¦å¯¹ä¸äºç»å¯¹è·¯å¾è¿è¡HTMLéåï¼è¿æ ·æä»¬è¿åçæµè§å¨ååºæè½å¼ç¨ææçèµæºãå®éä¸åççæ¯ï¼å½è¯·æ±éè¿æä»¬çè·¯ç±å¨Workeræ¶ï¼æä»¬å°è¯·æ±ä¼ éç»æ­£ç¡®çæå¡ç»å®ï¼å¹¶ä»ä¸­æ¥æ¶ååºãå¨å°å¶ä¼ åå®¢æ·ç«¯ä¹åï¼æä»¬ææºä¼éåDOMââæä»¥å¨çå°ç»å¯¹è·¯å¾çå°æ¹ï¼æä»¬ç»§ç»­ç¨ä»£çè·¯å¾é¢åå¡«åå®ãä»¥åæä»¬çHTMLè¿åçå¾çæ ç­¾æ¯ <code>&lt;img src="./logo.png" /&gt;</code>ï¼ç°å¨æä»¬ä¿®æ¹ä¸ºå¨è¿åå®¢æ·ç«¯æµè§å¨ä¹å <code>&lt;img src="./docs/logo.png" /&gt;</code>ã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/626506/202602/626506-20260202112120582-1933264349.png" class="lazyload"></p>
<p>è®©æä»¬åå°CSSè§å¾è¿æ¸¡åææ¡£é¢å è½½çé­æ³ãæä»¬å½ç¶å¯ä»¥æé£æ®µä»£ç æå¨æ¾å°æä»¬çé¡¹ç®ä¸­å¹¶è®©å®å·¥ä½ï¼ä½è¿ä¸ªè·¯ç±å¨Workerä¹ä¼ä½¿ç¨HTMLRewriterèªå¨ä¸ºæä»¬å¤çè¿äºé»è¾ã</p>
<p>å¨ä½ çè·¯ç±å¨Worker <code>ROUTES</code> åéä¸­ï¼å¦æä½ å¨æ ¹çº§å«è®¾ç½® <code>smoothTransitions</code> ä¸º <code>true</code>ï¼é£ä¹CSSè¿æ¸¡è§å¾ä»£ç ä¼èªå¨æ·»å ãæ­¤å¤ï¼å¦æä½ å¨è·¯ç±ä¸­è®¾ç½® <code>preload</code> é®ä¸º <code>true</code>ï¼é£ä¹è¯¥è·¯ç±çæ¨æµè§åèæ¬ä»£ç ä¹ä¼èªå¨æ·»å ã</p>
<p>ä¸é¢æ¯ä¸¤èç»åä½¿ç¨çç¤ºä¾ï¼</p>
<pre><code class="language-json">{
  "smoothTransitions": true,
  "routes": [
    {"binding": "APP1", "path": "/app1", "preload": true},
    {"binding": "APP2", "path": "/app2", "preload": true}
  ]
}
</code></pre>
<h2 id="å¼å§ä½¿ç¨">å¼å§ä½¿ç¨</h2>
<p>ä½ ä»å¤©å°±å¯ä»¥å¼å§ä½¿ç¨åç´å¾®åç«¯æ¨¡æ¿æå»ºäºã</p>
<p>è®¿é®Cloudflareä»ªè¡¨ççé¾æ¥ï¼æèè¿å¥"Workers &amp; Pages"å¹¶ç¹å»"åå»ºåºç¨ç¨åº"æé®å¼å§ãä»é£éï¼ç¹å»"éæ©æ¨¡æ¿"ç¶å"åå»ºå¾®åç«¯"ï¼ä½ å°±å¯ä»¥å¼å§éç½®ä½ çè®¾ç½®äºã</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/626506/202602/626506-20260202112120449-70817179.png" class="lazyload"></p>
<p>æ´å¤ä½¿ç¨æåï¼å¯ä»¥ç¹å»<a href="https://developers.cloudflare.com/workers/framework-guides/web-apps/microfrontends" target="_blank" rel="noopener nofollow">æ¥çææ¡£</a> ï¼å¦ææ¨å¯¹åç§äºåçæ¶æçåå®¹æå´è¶£ï¼ä¹å¯ä»¥<a href="https://didispace.com" target="_blank" rel="noopener nofollow">å³æ³¨æçåå®¢ï¼ç¨åºç¿DD</a>ï¼ç¬¬ä¸æ¶é´è·å¾å¹²è´§æ´æ°ã</p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 11:22">2026-02-02 11:21</span>&nbsp;
<a href="https://www.cnblogs.com/didispace">ç¨åºç¿DD</a>&nbsp;
éè¯»(<span id="post_view_count">23</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19563285);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19563285', targetLink: 'https://www.cnblogs.com/didispace/p/19563285', title: 'å¨ Cloudflare å¹³å°ä¸æå»ºåç´å¾®åç«¯' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ AIå¼å-python-langchainæ¡æ¶ï¼1-8-2 ç¼å­æºå¶ââéªè¯ç¼å­çææï¼ ]]></title>
    <link>https://www.cnblogs.com/yclh/p/19563034</link>
    <guid>b32528b3b8d399c3d8463641b3eb7362</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/yclh/p/19563034" title="åå¸äº 2026-02-02 10:51">
    <span role="heading" aria-level="2">AIå¼å-python-langchainæ¡æ¶ï¼1-8-2 ç¼å­æºå¶ââéªè¯ç¼å­çææï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>ããå¨AIåºç¨ä¸­ï¼ç¼å­æºå¶çç»æµä»·å¼ä¸ä»èçTokenææ¬ï¼è¿è½æ¶é¤ç¨æ·ç­å¾ç¦èãæåç³»ç»ååéãä¿éæå¡ç¨³å®æ§ââè¿ææ¯ä¼ä¸çº§åºç¨ççæ­£çç¹ã<br>ããå½ç¨æ·æåºä¸ä¸ªå¸¸è§é®é¢æ¶ï¼é¦æ¬¡è°ç¨å¤§æ¨¡åéè¦ç»åç½ç»ä¼ è¾ãæéç­å¾ãæ¨¡åæ¨çç­å®æ´é¾è·¯ï¼ååºæ¶é´éå¸¸å¨1è³3ç§ãè¿ä¸ªæ¶é¿å·²è¶è¿äººç±»å¯¹âæµçäº¤äºâçå¿çéå¼ï¼200æ¯«ç§ï¼ï¼ç¨æ·ä¼ææ¾æç¥å°âå¡é¡¿âåâç­å¾ç¦èâãèå¯ç¨ç¼å­åï¼ç¸åé®é¢çåç»­è¯·æ±ç´æ¥ä»æ¬å°æ°æ®åºè¯»åç»æï¼ååºæ¶é´éª¤éè³10æ¯«ç§ä»¥åââè¿ç§âæ æç§åâçä½éªï¼è®©ç¨æ·æè§ç³»ç»å§ç»å¨çº¿ãååºè¿æ·ï¼æå¤§æåäºäº§åä¸ä¸åº¦åä¿¡ä»»æã</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;ä¸é¢ççè¿æ®µä»£ç ï¼å°±è½æ¸æ°çä½ç°ä½¿ç¨ç¼å­åè½æåçç¨æ·ä½éªãï¼åä¸ä¸ªé®é¢é®å¤§æ¨¡åä¸æ¬¡ï¼ç¬¬ä¸æ¬¡æ²¡æç¼å­ï¼åä¸¤æ¬¡æç¼å­ï¼</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">import os
import time
from langchain_community.cache import SQLiteCache
from langchain_openai import ChatOpenAI
from langchain.globals import set_llm_cache, get_llm_cache

# ========== 1. æ¸çæ§ç¼å­ï¼ç¡®ä¿æ¼ç¤ºçº¯åï¼==========
CACHE_DB = "langchain_demo.db"
if os.path.exists(CACHE_DB):
    os.remove(CACHE_DB)
    print(f" å·²æ¸çæ§ç¼å­: {CACHE_DB}")

# ========== 2. å¯ç¨ç¼å­ ==========
set_llm_cache(SQLiteCache(database_path=CACHE_DB))
print(f" ç¼å­å·²å¯ç¨: {get_llm_cache()}\n")

# ========== 3. éç½® LLM ==========
llm = ChatOpenAI(
    api_key=os.getenv("DEEPSEEK_API_KEY"),
    base_url=os.getenv("DEEP_URL"),  # Deepseek ç API åºç¡å°å
    model="deepseek-v3:671b",  # Deepseek å¯¹è¯æ¨¡åï¼å¯éï¼deepseek-chat-pro ç­é«çº§æ¨¡åï¼
    temperature=0.7,  # æ¸©åº¦åæ°ï¼0-1ï¼è¶ä½è¶ç¨³å®ï¼
    max_tokens=1024  # æå¤§çæ tokens
)


# ========== 4. æ ¸å¿æ¼ç¤ºå½æ° ==========
def demonstrate_cache_effect(query: str, repeat: int = 3):
    """
    æ¼ç¤ºç¼å­ææï¼é¦æ¬¡è°ç¨ï¼æ¢ï¼ vs åç»­è°ç¨ï¼å¿«ï¼

    Args:
        query: è¦æé®çé®é¢
        repeat: éå¤è°ç¨æ¬¡æ°ï¼ç¬¬1æ¬¡æªç¼å­ï¼åç»­åºå½ä¸­ç¼å­ï¼
    """
    print("=" * 60)
    print(f" æµè¯é®é¢: \"{query}\"")
    print(f" å°éå¤è°ç¨ {repeat} æ¬¡ï¼ç¬¬1æ¬¡æ ç¼å­ï¼åç»­åºå½ä¸­ç¼å­ï¼")
    print("=" * 60 + "\n")

    durations = []

    for i in range(repeat):
        print(f"\n[ç¬¬ {i + 1} æ¬¡è°ç¨]")
        start = time.perf_counter()  # é«ç²¾åº¦è®¡æ¶

        # å³é®ï¼ä½¿ç¨å®å¨ç¸åçè¾å¥è§¦åç¼å­
        response = llm.invoke(query)

        duration = (time.perf_counter() - start) * 1000  # è½¬ä¸ºæ¯«ç§
        durations.append(duration)

        # å¤æ­æ¯å¦å½ä¸­ç¼å­ï¼éè¿èæ¶éå¼ç²ç¥å¤æ­ï¼
        is_cached = i &gt; 0   # é¦æ¬¡éå¸¸ &gt;500msï¼ç¼å­éå¸¸ &lt;50ms

        if i &gt; 0:
            print('ç¼å­å½ä¸­,èæ¶ï¼'+str(duration))
        else:
            print('çå®è¯·æ±,èæ¶ï¼'+str(duration))
        print(f" åç­: {response.content[:60]}...")



# ========== 5. æ§è¡æ¼ç¤º ==========
if __name__ == "__main__":
    # æµè¯æ åé®é¢ï¼ç¡®ä¿å®å¨ç¸åçå­ç¬¦ä¸²ï¼
    demonstrate_cache_effect("å¤ªé³ç³»åªä¸ªè¡ææå¤§ï¼", repeat=3)
</pre>
</div>
<p>&nbsp;è¿è¡ç»æï¼</p>
<p>&nbsp;<br>&nbsp;å·²æ¸çæ§ç¼å­: langchain_demo.db<br>&nbsp;ç¼å­å·²å¯ç¨: &lt;langchain_community.cache.SQLiteCache object at 0x000001D668B50410&gt;<br><br>============================================================<br>&nbsp;æµè¯é®é¢: "å¤ªé³ç³»åªä¸ªè¡ææå¤§ï¼"<br>&nbsp;å°éå¤è°ç¨ 3 æ¬¡ï¼ç¬¬1æ¬¡æ ç¼å­ï¼åç»­åºå½ä¸­ç¼å­ï¼<br>============================================================<br><br><br>[ç¬¬ 1 æ¬¡è°ç¨]<br>çå®è¯·æ±,èæ¶ï¼17445.118000000093<br>&nbsp;åç­: å¤ªé³ç³»ä¸­æå¤§çè¡ææ¯**æ¨æ**ãä»¥ä¸æ¯å³äºæ¨æçä¸äºå³é®ä¿¡æ¯ï¼<br><br>### æ¨æçåºæ¬ç¹å¾ï¼<br>1. **ä½ç§¯ä¸è´¨é** ...<br><br>[ç¬¬ 2 æ¬¡è°ç¨]<br>ç¼å­å½ä¸­,èæ¶ï¼410.93799999998737<br>&nbsp;åç­: å¤ªé³ç³»ä¸­æå¤§çè¡ææ¯**æ¨æ**ãä»¥ä¸æ¯å³äºæ¨æçä¸äºå³é®ä¿¡æ¯ï¼<br><br>### æ¨æçåºæ¬ç¹å¾ï¼<br>1. **ä½ç§¯ä¸è´¨é** ...<br><br>[ç¬¬ 3 æ¬¡è°ç¨]<br>ç¼å­å½ä¸­,èæ¶ï¼1.475199999731558<br>&nbsp;åç­: å¤ªé³ç³»ä¸­æå¤§çè¡ææ¯**æ¨æ**ãä»¥ä¸æ¯å³äºæ¨æçä¸äºå³é®ä¿¡æ¯ï¼<br><br>### æ¨æçåºæ¬ç¹å¾ï¼<br>1. **ä½ç§¯ä¸è´¨é** ...<br><br>&nbsp;<br>ç»è®ºï¼ä»æ¶é´æ¶èä¸çï¼ç¼å­å½ä¸­å ä½åæ°çç¼©ç­äºç¨æ·ç­å¾æ¶é´ï¼æåäºç¨æ·çä½¿ç¨ä½éªã</p>
<p>&nbsp;</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.0006944444444444445" data-date-updated="2026-02-02 10:52">2026-02-02 10:51</span>&nbsp;
<a href="https://www.cnblogs.com/yclh">ä¸ç¬ä½</a>&nbsp;
éè¯»(<span id="post_view_count">7</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19563034);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19563034', targetLink: 'https://www.cnblogs.com/yclh/p/19563034', title: 'AIå¼å-python-langchainæ¡æ¶ï¼1-8-2 ç¼å­æºå¶ââéªè¯ç¼å­çææï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ FastAPIé¨ç½²ä¸­é´ä»¶å®æï¼ä»CORSå°èªå®ä¹ï¼è®©ä½ çAPIæ´å¥å£® ]]></title>
    <link>https://www.cnblogs.com/ymtianyu/p/19562887</link>
    <guid>1ed5005e0b6510bc3a3db7180595c879</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ymtianyu/p/19562887" title="åå¸äº 2026-02-02 10:32">
    <span role="heading" aria-level="2">FastAPIé¨ç½²ä¸­é´ä»¶å®æï¼ä»CORSå°èªå®ä¹ï¼è®©ä½ çAPIæ´å¥å£®</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ¬ææ·±å¥æµåºå°è®²è§£äºFastAPIä¸­é´ä»¶çæ ¸å¿æ¦å¿µä¸å®æåºç¨ãä»è§£å³æå¸¸è§çCORSè·¨åé®é¢å¥æï¼éæ­¥æ¼ç¤ºå¦ä½ç¼åèªå®ä¹ä¸­é´ä»¶ï¼å¦æ¥å¿è®°å½ï¼ï¼å¹¶éç¹åæäºå¤ä¸ªä¸­é´ä»¶çæ§è¡é¡ºåºè¿ä¸å³é®é¾ç¹ãåæ¶ï¼å¯¹æ¯äºHTTPä¸­é´ä»¶ä¸ASGIä¸­é´ä»¶çåºå«ä¸éç¨åºæ¯ï¼æååäº«äºä½èå¨å®éå¼åä¸­æ»ç»çè¸©åç»éªä¸æä½³å®è·µï¼å¸®å©ä½ æå»ºæ´å¥å£®ãæç»´æ¤çWebåºç¨ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><em>æ¬ææè¦ï¼ä½ æ¯å¦ä¸ºFastAPIåºç¨çè·¨åè¯·æ±ï¼CORSï¼å¤´ç¼è¿ï¼æèæ³ç»ææè¯·æ±ç»ä¸å ç¹âæâå´ä¸ç¥ä»ä½ä¸æï¼æ¬æéè¿å®ææ¼ç¤ºFastAPIä¸­é´ä»¶çä½¿ç¨ï¼æ¶µçCORSå¤çãèªå®ä¹ä¸­é´ä»¶ç¼åãå¤ä¸ªä¸­é´ä»¶æ§è¡é¡ºåºç­æ ¸å¿åå®¹ï¼å¸®ä½ æå»ºæ´å®å¨ãé«æçWebåºç¨ã</em></p>
<hr style="border: none; height: 1px; background: linear-gradient(90deg, rgba(0, 0, 0, 0), rgba(52, 152, 219, 1), rgba(0, 0, 0, 0)); margin: 20px 0">
<p>ä½ çFastAPIåºç¨å¨æ¬å°è·å¾é£çæ°´èµ·ï¼ä¸é¨ç½²ä¸çº¿ï¼åç«¯åå­¦å°±ç«æ¥ç«çå°æ¾ä½ ï¼âèå¤§ï¼æ¥å£è·¨åäºï¼æ¥éï¼â ð¨</p>
<p>æèï¼ä½ çªç¶æ¥å°éæ±ï¼<strong style="color: rgba(186, 55, 42, 1)">âææè¯·æ±é½è¦è®°å½æ¥å¿ï¼æææ¥å£è¿è¦é¢å¤æ ¡éªä¸ä¸ªèªå®ä¹Headerãâ</strong> é¾ä¸æè¦ç»æ¯ä¸ªè·¯ç±é½å ä¸éä»£ç ï¼</p>
<p>å«æï¼è¿å°±æ¯ä»å¤©è¦èçâä¸­é´ä»¶âï¼Middlewareï¼è¦è§£å³çç»å¸é®é¢ãå®å°±åä½ APIçâååç»çâï¼ææè¯·æ±åååºé½å¾åç»è¿å®æï¼éªèº«ä»½ãè®°æ¥å¿ãå¤çè·¨åâ¦â¦å¦¥å¦¥çã</p>
<h2>ð¯ ä¸ãä¸­é´ä»¶æ¯å¥ï¼å±ç¨âé¤åâæä¸ªæ¯æ¹</h2>
<p>æ³è±¡ä¸ä¸ï¼ä½ çFastAPIåºç¨æ¯ä¸ªé«çº§é¤åã</p>
<div>
<p>ð é¡¾å®¢ï¼å®¢æ·ç«¯è¯·æ±ï¼æ¥å°é¨å£ã</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;- <strong style="color: rgba(186, 55, 42, 1)">è¿å®¾ï¼CORSä¸­é´ä»¶ï¼</strong>ï¼åçä½ æ¯ä¸æ¯ä»åè®¸çè¡åºï¼ååï¼æ¥çï¼ä¸æ¯å°±ç´æ¥åéï¼è¿åCORSéè¯¯ï¼ã</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;- <strong style="color: rgba(186, 55, 42, 1)">é¢ä½åï¼æ¥å¿ä¸­é´ä»¶ï¼</strong>ï¼è®°ä¸é¡¾å®¢å ç¹æ¥çãå ä¸ªäººã</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;- <strong style="color: rgba(186, 55, 42, 1)">å®æ£ï¼è®¤è¯ä¸­é´ä»¶ï¼</strong>ï¼æ£æ¥ä½ ææ²¡æé¢çº¦ç ï¼Tokenï¼ã</p>
<p>ð ä¹åï¼é¡¾å®¢æè½è§å°<strong style="color: rgba(186, 55, 42, 1)">çæ­£çå¨å¸ï¼ä½ çè·¯å¾æä½å½æ°ï¼</strong>ç¹èåé¥­ï¼å¤çä¸å¡é»è¾ï¼ã</p>
<p>ð åå®ç¦»å¼æ¶ï¼è¿å¾ç»è¿<strong style="color: rgba(186, 55, 42, 1)">ä¼ èåï¼ååºå¤çä¸­é´ä»¶ï¼</strong>ï¼å¯è½ç»æåçè´´ä¸ªæ ç­¾ï¼æ·»å ååºå¤´ï¼ã</p>
</div>
<p>è¿ä¸ç³»åç«å¨âæ ¸å¿ä¸å¡âååçæå¡äººåï¼å°±æ¯ä¸­é´ä»¶ã<strong style="color: rgba(186, 55, 42, 1)">å®çæ ¸å¿ä»·å¼å¨äºï¼å¨å±å¤çãä¸å¡æ ä¾µå¥ã</strong></p>
<p>å®æ¹ææ¡£è®²å¾æ¯è¾æ£ï¼å±ä»¬ä»å¤©å°±æè¿åç¡¬éª¨å¤´åéï¼ç´æ¥ä¸ä»£ç ã</p>
<h2>ð§ äºãæ ¸å¿ï¼æä¹ç¨ï¼ä»æå¸¸ç¨çCORSå¼å§</h2>
<p>å¥½ï¼å±ä»¬åæ¥è§£å³å¼å¤´çâè·¨åâé®é¢ãè¿æ¯99%çWebåºç¨é½ä¼éå°çã</p>
<pre class="language-python highlighter-hljs"><code>from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware

app = FastAPI()

# 1. éç½®åè®¸çæºãæ¹æ³ãè¯·æ±å¤´
origins = [
    "http://localhost:3000",  # ä½ çåç«¯å¼åå°å
    "https://your-production-site.com",
]

# 2. æ·»å ä¸­é´ä»¶
app.add_middleware(
    CORSMiddleware,
    allow_origins=origins,  # åè®¸çæºåè¡¨ï¼ä¹å¯ä»¥ç¨ ["*"] æ¾è¡ææï¼ä¸å®å¨ï¼ï¼
    allow_credentials=True, # åè®¸æºå¸¦Cookie
    allow_methods=["*"],    # åè®¸æææ¹æ³ (GET, POST, ç­)
    allow_headers=["*"],    # åè®¸ææè¯·æ±å¤´
)

@app.get("/")
async def main():
    return {"message": "Hello World"}</code></pre>
<p><strong style="color: rgba(186, 55, 42, 1)">è¿éåä¸å«å­¦æå½åå·æï¼å¾çäºç´æ¥ä¸ `allow_origins=["*"]`</strong>ï¼è¿å¨çäº§ç¯å¢æ¯å®å¨å¤§å¿ï¼ç¸å½äºé¤åå¤§é¨æå¼ï¼è°é½è½è¿ãçº¿ä¸å¡å¿æç¡®æå®åç«¯ååï¼</p>
<h2>ð§ª ä¸ãå¨æï¼åä¸ä¸ªèªå·±çä¸­é´ä»¶</h2>
<p>æ¥ä¸æ¥éç¹æ¥äºï¼èªå®ä¹ä¸­é´ä»¶ãæ¯å¦ï¼æä»¬è¦ç»æ¯ä¸ªè¯·æ±è®°æ¥å¿ï¼å¹¶è®¡ç®å¤çèæ¶ã</p>
<pre class="language-python highlighter-hljs"><code>import time
from fastapi import FastAPI, Request
app = FastAPI()

@app.middleware("http") # è¿æ¯å³é®è£é¥°å¨
async def log_request_time(request: Request, call_next):
    # 1. è¯·æ±è¿æ¥æ¶
    # è¿éæä»¬ä½¿ç¨ time.perf_counter() èä¸æ¯ time.time()ï¼å ä¸ºå®å¯¹äºè¿äºç¨ä¾å¯è½æ´ç²¾ç¡®
    start_time = time.perf_counter()
    path = request.url.path
    method = request.method
    print(f"ð æ¶å°è¯·æ±: {method} {path}")

    # 2. æè¯·æ±äº¤ç»ä¸ä¸ä¸ªå¤çç¯èï¼å¯è½æ¯å¶ä»ä¸­é´ä»¶ï¼æèæ¯æç»çè·¯ç±ï¼
    response = await call_next(request)

    # 3. ååºè¿åå
    process_time = time.perf_counter() - start_time
    response.headers["X-Process-Time"] = str(process_time) # å¯ä»¥å¾ååºå¤´å ä¸è¥¿
    print(f"â è¯·æ±å®æ: {method} {path}, èæ¶: {process_time:.4f}ç§")
    return response

@app.get("/test")
async def test():
    return {"message": "ok"}</code></pre>
<p>è®¿é® <code style="color: rgba(186, 55, 42, 1)">/test</code>ï¼ççæ§å¶å°ï¼æ¯ä¸æ¯æ¥å¿åååºå¤´é½æäºï¼è¿å°±æ¯ä¸ä¸ªæåºç¡çHTTPä¸­é´ä»¶ã</p>
<p><strong style="color: rgba(186, 55, 42, 1)">åéç¹ï¼</strong> ä¸­é´ä»¶å½æ°æ¥æ¶ä¸ä¸ª <code style="color: rgba(186, 55, 42, 1)">call_next</code>ï¼å®å°±åæ¥åæ£ï¼ä½ å¿é¡»è°ç¨å®ï¼<code style="color: rgba(186, 55, 42, 1)">await call_next(request)</code>ï¼ï¼è¯·æ±æè½ç»§ç»­å¾åèµ°ãä½ å¨å®åé¢ååé¢åçä»£ç ï¼å°±åå«å¯¹åºäºâè¯·æ±å¤çâåâååºå¤çâä¸¤ä¸ªé¶æ®µã</p>
<h2>ð åãçµé­æ·é®ï¼å¤ä¸ªä¸­é´ä»¶ï¼è°åè°åï¼</h2>
<p>ä½ æ¯ä¸æ¯ä»¥ä¸ºå å®å°±å®äºäºï¼<strong style="color: rgba(186, 55, 42, 1)">å¤ä¸ªä¸­é´ä»¶çæ§è¡é¡ºåºæ¯è¶çº§æéç¹ï¼</strong></p>
<p>æ³è±¡ä¸ä¸ï¼ä½ æ¢å äºCORSä¸­é´ä»¶ï¼åå äºä¸é¢çæ¥å¿ä¸­é´ä»¶ï¼è¿å äºä¸ä¸ªè®¤è¯ä¸­é´ä»¶ãå®ä»¬æä¹æéï¼</p>
<p><strong style="color: rgba(186, 55, 42, 1)">ç»è®ºï¼æç§æ·»å ç<span style="text-decoration: underline; font-size: 16px">ç¸åé¡ºåº</span>æ§è¡âè¯·æ±é¶æ®µâï¼åæç§æ·»å ç<span style="text-decoration: underline; font-size: 16px">æ­£åº</span>æ§è¡âååºé¶æ®µâã</strong> åæ´è±ä¸æ ·ï¼ä¸å±å±è¿å»ï¼åä¸å±å±åºæ¥ã</p>
<pre class="language-python highlighter-hljs"><code>app = FastAPI()

# åè®¾æä»¬æé¡ºåºæ·»å ä¸ä¸ªä¸­é´ä»¶
app.add_middleware(MiddlewareC) # ç¬¬ä¸ä¸ªæ·»å 
app.add_middleware(MiddlewareB) # ç¬¬äºä¸ªæ·»å 
app.middleware("http")(middleware_a) # ç¬¬ä¸ä¸ªæ·»å ï¼è£é¥°å¨åæ³ï¼

# å®éæ§è¡é¡ºåºï¼è¯·æ±é¶æ®µï¼ï¼
# 1. middleware_a çè¯·æ±å¤çä»£ç 
# 2. MiddlewareB çè¯·æ±å¤çä»£ç 
# 3. MiddlewareC çè¯·æ±å¤çä»£ç 
# --- å°è¾¾è·¯ç±å½æ° ---
# 4. MiddlewareC çååºå¤çä»£ç 
# 5. MiddlewareB çååºå¤çä»£ç 
# 6. middleware_a çååºå¤çä»£ç 
# --- ååºè¿åç»å®¢æ·ç«¯ ---</code></pre>
<p>å®æ¹ææ¡£è½ç¶è¯´äºæ¯âè£é¥°å¨é¡ºåºâï¼ä½ç¨ <code style="color: rgba(186, 55, 42, 1)">app.add_middleware()</code> æ·»å æ¶æ´å®¹æè¿·ç³ãè®°ä¸ä½å°±èä¸è¿ä¸ªå£è¯ï¼<strong style="color: rgba(186, 55, 42, 1)">âåæ¥å±ä¸ï¼è¯·æ±ï¼ï¼åè·¯è¿åï¼ååºï¼âã</strong> è®¾è®¡æ¶ï¼è¦æä¾èµå³ç³»æ³æ¸æ¥ï¼æ¯å¦è®¤è¯åºè¯¥æ¾å¨é âéâå±ï¼åæ·»å ï¼ï¼æ¥å¿å¯ä»¥æ¾å¨æâå¤âå±ï¼åæ·»å ï¼ã</p>
<h2>ð äºãè¿é¶ï¼æ´åºå±çASGIä¸­é´ä»¶</h2>
<p>åè¯´ä¸ªå®¹æç¿»è½¦çç¹ãä¸é¢æä»¬ç¨ <code style="color: rgba(186, 55, 42, 1)">@app.middleware("http")</code> å«HTTPä¸­é´ä»¶ï¼æ¯FastAPIå°è£å¥½çãè¿æä¸ç§æ´åºå±ãæ´å¼ºå¤§çå«<strong style="color: rgba(186, 55, 42, 1)">ASGIä¸­é´ä»¶</strong>ã</p>
<p>å®åHTTPä¸­é´ä»¶å¥åºå«ï¼å¥½æ¯ä¸ä¸ªæ¯é«çº§é¤åçåºå®æµç¨ï¼HTTPï¼ï¼å¦ä¸ä¸ªæ¯åå¨çåå­æä½ï¼ASGIï¼ï¼è½å¤çWebSocketç­æ´å¤åè®®ã</p>
<p>æä¹ç¨ï¼éå¸¸ä½ éè¦ä¸ä¸ªç¬¬ä¸æ¹åºï¼æ¯å¦ <code style="color: rgba(186, 55, 42, 1)">starlette-context</code> æ¥å¨è¯·æ±ä¸­ä¼ éå¨å±æ°æ®ï¼æèèªå·±å°è£ï¼FastAPIå¨<span style="color: rgba(186, 55, 42, 1)"><code>fastapi.middleware</code></span>ä¸­æä¾äºå ä¸ªä¸­é´ä»¶ï¼ä»ä»æ¯ä¸ºäºæ¹ä¾¿å¼åèï¼ä½å¤§å¤æ°å¯ç¨çä¸­é´ä»¶ç´æ¥æ¥èªStarletteï¼ï¼</p>
<pre class="language-python highlighter-hljs"><code>from fastapi import FastAPI
from starlette.middleware.base import BaseHTTPMiddleware

class CustomHeaderMiddleware(BaseHTTPMiddleware):
    async def dispatch(self, request, call_next):
        response = await call_next(request)
        response.headers["X-Custom-Header"] = "MyValue"
        return response

app = FastAPI()
app.add_middleware(CustomHeaderMiddleware) # è¿éæ·»å çå°±æ¯ASGIä¸­é´ä»¶</code></pre>
<p><strong style="color: rgba(186, 55, 42, 1)">æ³¨æï¼</strong> <code style="color: rgba(186, 55, 42, 1)">BaseHTTPMiddleware</code> ä½¿ç¨ç®åï¼ä½å®æ¹æç¤ºå¯è½æè½»å¾®æ§è½æèï¼å ä¸ºæ¯ä¸ªè¯·æ±é½ä¼åå»ºæ°çç±»å®ä¾ãå¯¹äºè¶é«å¹¶ååºæ¯ï¼ç¨ä¹åçå½æ°å¼ <code style="color: rgba(186, 55, 42, 1)">@app.middleware("http")</code> æç´æ¥åçº¯ASGIä¸­é´ä»¶æ¯æ´ä¼è§£ã</p>
<h2>ð å­ãæçè¸©åç»éªä¸æä½³å®è·µ</h2>
<p>æåå°å¦å å¥ï¼é½æ¯å®æä¸­æ»ç»çè¡æ³ªæè®­ï¼</p>
<div>
<p>1ï¸â£ <strong style="color: rgba(186, 55, 42, 1)">ååºå¼ä¸­é´ä»¶è¦å°å¿ï¼</strong> å¦æä½ æ³å¨ä¸­é´ä»¶éè¯»åååºçbodyï¼æ¯å¦åå¨å±ååºä½æ ¼å¼åï¼éè¦åæå®è¯»åºæ¥ï¼<code style="color: rgba(186, 55, 42, 1)">body = await response.body()</code>ï¼ï¼ä½è¿ä¼è®©ååºä½å¨åå­ä¸­å¤å­ä¸ä»½ãå¯¹äºå¤§æä»¶æµååºï¼æç¨ï¼</p>
<p>2ï¸â£ <strong style="color: rgba(186, 55, 42, 1)">å¼å¸¸å¤çè¦è¦çï¼</strong> ä¸­é´ä»¶éç <code style="color: rgba(186, 55, 42, 1)">call_next</code> å¯è½ä¼æåºå¼å¸¸ï¼è®°å¾ç¨ <code style="color: rgba(186, 55, 42, 1)">try...except</code> åä½ï¼å¹¶è¿åä¸ä¸ªåççéè¯¯ååºï¼èä¸æ¯è®©æå¡å´©æã</p>
<p>3ï¸â£ <strong style="color: rgba(186, 55, 42, 1)">åºåä¸­é´ä»¶åä¾èµæ³¨å¥ï¼</strong> åè®¤è¯è¿ç§ï¼æ¯ä¸ªè·¯ç±å¯è½è¦æ±ä¸åï¼æçéè¦ç»å½ï¼æçä¸éè¦ï¼ï¼ç¨ä¾èµæ³¨å¥ï¼<code style="color: rgba(186, 55, 42, 1)">Depends</code>ï¼æ´çµæ´»ãä¸­é´ä»¶æ´éåå<strong style="color: rgba(186, 55, 42, 1)">å¨å±çãæ å·®å¼ç</strong>å¤çï¼æ¯å¦CORSãå¨å±æ¥å¿ãGZipåç¼©ã</p>
</div>
<p>å·¥å·çéæ©ï¼å¥½æ¯éèºä¸åï¼ä¸æ¯æè´µçå°±å¥½ï¼èæ¯<strong style="color: rgba(186, 55, 42, 1)">âåéâ</strong>æå¥½ãå¯¹äºå¤§é¨åä¸å¡åºæ¯ï¼HTTPä¸­é´ä»¶+ä¾èµæ³¨å¥çç»åï¼å·²ç»è½è§£å³99%çé®é¢äºã</p>
<hr style="border: none; height: 1px; background: linear-gradient(90deg, rgba(0, 0, 0, 0), rgba(52, 152, 219, 1), rgba(0, 0, 0, 0)); margin: 40px 0">
<p>å¥½äºï¼å³äºFastAPIä¸­é´ä»¶çå®æç»éªï¼ä»å¤©å°±åèå°è¿ãä¸­é´ä»¶å°±åä½ åºç¨çâåºç¡è®¾æ½âï¼æ­å»ºå¥½äºï¼åé¢åä¸å¡ä»£ç æè½å®å¿ãçå¿ã</p>
<p><strong style="color: rgba(186, 55, 42, 1)">èè§ç©ï¼ä»£ç çæ®µé½è·è¿ï¼æ¾å¿åèã</strong> å¦æä½ å¨éç½®ä¸­é´ä»¶æ¶è¿éå°äºå¶ä»å¦é­é¬¼æªï¼æ¬¢è¿çè¨ï¼å±ä»¬ä¸èµ·éå¦é¤é­ã</p>
<p>è§å¾æç¨çè¯ï¼<strong style="color: rgba(186, 55, 42, 1)">ç¹èµãæ¶èãå³æ³¨</strong>ä¸è¿ä¸ä¸åï¼ä½ çæ¯ææ¯æç¬å¤åå¹²è´§çæå¤§å¨åãä¸æå±ä»¬å¯ä»¥èèFastAPIçä¾èµæ³¨å¥æä¹ç©åºè±ï¼æèé¨ç½²ä¸çº¿çé£äºåãåè§ï¼ð©ð»</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-02 10:32">2026-02-02 10:32</span>&nbsp;
<a href="https://www.cnblogs.com/ymtianyu">ä¸åç¨åºåªå</a>&nbsp;
éè¯»(<span id="post_view_count">17</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19562887);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19562887', targetLink: 'https://www.cnblogs.com/ymtianyu/p/19562887', title: 'FastAPIé¨ç½²ä¸­é´ä»¶å®æï¼ä»CORSå°èªå®ä¹ï¼è®©ä½ çAPIæ´å¥å£®' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>