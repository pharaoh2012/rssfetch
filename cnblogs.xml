<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-01-22T16:29:48.474Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ åéå¾ï¼æ°æ®å¯¹æ¯çä¼éä¹é ]]></title>
    <link>https://www.cnblogs.com/wang_yb/p/19519312</link>
    <guid>fd131a545e989fe424738d3db16fe073</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/wang_yb/p/19519312" title="åå¸äº 2026-01-22 23:23">
    <span role="heading" aria-level="2">åéå¾ï¼æ°æ®å¯¹æ¯çä¼éä¹é</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>ç®æ´ççº¿æ¡è¿æ¥ä¸¤ä¸ªæ°æ®ç¹ï¼å°±ååéçä¸¤ç«¯ï¼å¨å¯¹æ¯åæä¸­å±ç°åºä»¤äººæè³çæ¸æ°åº¦ã</p>
</blockquote>
<p>å¨å¹³æ¶çæ°æ®åæé¡¹ç®ä¸­ï¼æç»å¸¸ä¼éå°æ¯è¾ä¸¤ä¸ªç¸å³æ°æ®éçååæåµã</p>
<p>è¿æ¶ï¼ä¼ ç»çåæ³æ¯ä½¿ç¨å ç§¯æ¡å½¢å¾æç°ç¶æ¡å½¢å¾ï¼ä½å®ä»¬å­å¨ä¸ä¸ª<strong>å±åé®é¢</strong>ï¼å½æä»¬éè¦ç²¾ç¡®è¿½è¸ªæ¯ä¸ªé¡¹ç®å¨ä¸¤ä¸ªæ¶é´ç¹æä¸¤ç§æ¡ä»¶ä¸çååæ¶ï¼è¿äºå¾è¡¨ä¼è®©æä»¬çç¼çå¨æ¡å½¢ä¹é´æ¥åè·³è·ï¼é¾ä»¥ç´è§ææ¡ååçå¹åº¦åæ¹åã</p>
<p>ä»å¤©ï¼æè¦åå¤§å®¶æ¨èä¸ç§æ´ä¼éçæ¿ä»£æ¹æ¡--<strong>åéå¾</strong>ã</p>
<h1 id="1-åéå¾æ¯ä»ä¹">1. åéå¾æ¯ä»ä¹ï¼</h1>
<p><strong>åéå¾</strong>ï¼<code>Dumbbell Plot</code>ï¼ï¼ææ¶ä¹ç§°ä¸º<strong>DNAå¾</strong>æ<strong>æ éå¾</strong>ï¼æ¯ä¸ç§ç¨äºæ¯è¾ä¸¤ä¸ªç¸å³æ°æ®ç¹çå¯è§åå¾è¡¨ã</p>
<p>å®æºäºäººä»¬å¯¹æ´æææ°æ®æ¯è¾æ¹å¼çæç»­æ¢ç´¢ã</p>
<p>å¨ä¼ ç»çæ¶é´åºåæ¯è¾ä¸­ï¼æä»¬éå¸¸ä½¿ç¨ä¸¤æ¡æçº¿ï¼ä½å½éè¦æ¯è¾çé¡¹ç®è¾å¤æ¶ï¼æçº¿å¾ä¼åå¾æ··ä¹±ã<strong>åéå¾</strong>éè¿å°æ¯è¾ç¦ç¹æ¾å¨æ¯ä¸ªé¡¹ç®çä¸¤ä¸ªç¶æä¸ï¼è§£å³äºå¤é¡¹ç®å¯¹æ¯æ¶çè§è§æ··ä¹±é®é¢ã</p>
<p>å®ç<strong>åºæ¬ç»æ</strong>å¾ç®åï¼</p>
<ul>
<li>æ¯ä¸ªè§å¯åä½ï¼å¦äº§åãå°åºãæ¶é´æ®µï¼å¯¹åºä¸¤ä¸ªæ°æ®ç¹</li>
<li>è¿ä¸¤ä¸ªæ°æ®ç¹ç±ä¸æ¡ç´çº¿ï¼æçº¿æ®µï¼è¿æ¥</li>
<li>æ´ä¸ªå¾å½¢çèµ·æ¥åä¸ææåéï¼å èå¾å</li>
</ul>
<h1 id="2-å®ç°åç">2. å®ç°åç</h1>
<p><strong>åéå¾</strong>çæ ¸å¿è®¾è®¡çå¿µæ¯<strong>æå°åè®¤ç¥è´è·</strong>ã</p>
<p>å½æä»¬éè¦æ¯è¾AåBæ¶ï¼æç´æ¥çæ¹å¼å°±æ¯æå®ä»¬æ¾å¨ä¸èµ·ï¼ç¨ä¸æ¡çº¿è¿æ¥ï¼ç¶åè§å¯è¿æ¡çº¿çé¿åº¦ï¼å·®å¼å¤§å°ï¼åæ¹åï¼åªä¸ªæ´å¤§ï¼ã</p>
<p>å¨<code>matplotlib</code>ä¸­åå»º<strong>åéå¾</strong>ï¼æä»¬ä¸»è¦ä½¿ç¨ä»¥ä¸åç´ ï¼</p>
<ul>
<li><strong>æ£ç¹å¾</strong>ï¼è¡¨ç¤ºä¸¤ä¸ªæ°æ®ç¹</li>
<li><strong>ç´çº¿æ®µ</strong>ï¼è¿æ¥ä¸¤ä¸ªç¸å³ç¹</li>
<li><strong>é¢è²ç¼ç </strong>ï¼éå¸¸ç¨ä¸åé¢è²åºåååç¶ææä¸åç»å«</li>
<li><strong>æ ç­¾ç³»ç»</strong>ï¼æ¸æ°æ è¯æ¯ä¸ªè§å¯åä½</li>
</ul>
<h1 id="3-å®æç¤ºä¾">3. å®æç¤ºä¾</h1>
<p>æ¥ä¸æ¥ï¼æä»¬ççåéå¾å¨å®éåºæ¯ä¸­çæ¾ç¤ºææã</p>
<p>åè®¾æä»¬æ¯ä¸å®¶çµåå¬å¸çæ°æ®åæå¸ï¼éè¦æ¯è¾8ä¸ªä¸»è¦äº§åç±»å«å¨2022å¹´å2023å¹´çéå®é¢ååã</p>
<p>ï¼å®æ´çä»£ç å¨æç« æ«å°¾æä¾ä¸è½½å°åï¼æä¸­åªæªåé¨åä»£ç ï¼</p>
<p>ååå»ºä¸äºæµè¯æ°æ®ï¼</p>
<pre><code class="language-python"># ç¤ºä¾æ°æ®ï¼8ä¸ªäº§åç±»å«å¨2022å¹´å2023å¹´çéå®é¢ï¼åä½ï¼ä¸åï¼
categories = [
    "çµå­äº§å",
    "æè£éå¸½",
    "å®¶å±ç¨å",
    "ç¾å¦æ¤è¤",
    "å¾ä¹¦é³å",
    "è¿å¨æ·å¤",
    "é£åé¥®æ",
    "æ¯å©´ç¨å",
]
sales_2022 = [85, 92, 78, 65, 45, 60, 88, 72]
sales_2023 = [95, 87, 85, 78, 52, 73, 95, 80]
</code></pre>
<p>ç¶åï¼æä»¬ç»å¶ä¼ ç»çç°ç¶æ¡å½¢å¾ååéå¾æ¥å¯¹æ¯ä¸ä¸ææï¼</p>
<pre><code class="language-python"># åå»ºå­å¾ï¼å¯¹æ¯ä¸¤ç§å¯è§åæ¹æ³
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 8))

# ç°ç¶æ¡å½¢å¾
x = np.arange(len(categories))

bars1 = ax1.bar(x - width/2, sales_2022, width, label='2022å¹´', color='#4C72B0', alpha=0.8)
bars2 = ax1.bar(x + width/2, sales_2023, width, label='2023å¹´', color='#DD8452', alpha=0.8)

# å¨æ¯ä¸ªæ¡å½¢ä¸æ·»å æ°å¼æ ç­¾
# çç¥ ...

# åéå¾
# è®¾ç½®yè½´ä½ç½®ï¼æ¯ä¸ªç±»å«çåç´ä½ç½®ï¼
y_pos = np.arange(len(categories))

# ç»å¶è¿æ¥çº¿
for i, (y2022, y2023) in enumerate(zip(sales_2022, sales_2023)):
    # ç¡®å®çº¿é¢è²ï¼å¢é¿ä¸ºç»¿è²ï¼ä¸éä¸ºçº¢è²
    line_color = '#55A868' if y2023 &gt; y2022 else '#C44E52'
    ax2.plot([y2022, y2023], [i, i], color=line_color, linewidth=2.5, alpha=0.7, zorder=1)

# ç»å¶æ°æ®ç¹
ax2.scatter(sales_2022, y_pos, s=120, color='#4C72B0', alpha=0.9, label='2022å¹´', zorder=2, edgecolors='white', linewidth=2)
ax2.scatter(sales_2023, y_pos, s=120, color='#DD8452', alpha=0.9, label='2023å¹´', zorder=2, edgecolors='white', linewidth=2)

# çç¥ ...

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://img2024.cnblogs.com/blog/83005/202601/83005-20260122232220614-1554024714.png" alt="" loading="lazy"></p>
<p>éè¿ä¸é¢çå¯¹æ¯ï¼æä»¬å¯ä»¥æ¸æ°å°çå°<strong>åéå¾</strong>çä¼å¿ï¼</p>
<ul>
<li><strong>ååä¸ç®äºç¶</strong>ï¼è¿æ¥çº¿çé¿åº¦ç´è§è¡¨ç¤ºååå¹åº¦ï¼æ¹åè¡¨ç¤ºå¢é¿æä¸é</li>
<li><strong>åå°è§è§è·³è·</strong>ï¼ç¼çä¸éè¦å¨æ¡å½¢é´æ¥åç§»å¨ï¼èæ¯æ²¿çæ°´å¹³çº¿èªç¶è¿½è¸ª</li>
<li><strong>çªåºæ¯è¾éç¹</strong>ï¼ä¸æ³¨äºæ¯ä¸ªé¡¹ç®çä¸¤ä¸ªç¶æå¯¹æ¯ï¼èéç»å¯¹æ°å¼</li>
</ul>
<p>è¿ä¸æ­¥ï¼æä»¬è¿å¯ä»¥ç»<strong>åéå¾</strong>æåºï¼æç§å¢é¿<strong>ç±å¿«å°æ¢</strong>ç»åä¸ªåç±»æåºï¼è¿æ ·èªç¶å½¢æä»"ä¸éææ¾è"å°"å¢é¿ææ¾è"çè¿ç»­è°±ï¼æ¨¡å¼èªå¨æ¾ç°ï¼æ éå»æå¯»æ¾ã</p>
<p>æ¯å¦ä¸é¢ç<strong>åéå¾</strong>ä¸­ï¼ãæè£éå¸½ãè¿ä¸ªåç±»å¶å®éå®é¢æ¯ä¸éçï¼æ··å¨ä¸å åéä¸­ä¸å®¹æçåºæ¥å§ï¼</p>
<pre><code class="language-python"># åå»ºæåºåçåéå¾
fig, ax = plt.subplots(figsize=(10, 8))

# æååå¹åº¦æåº
sorted_indices = np.argsort(
    [sales_2023[i] - sales_2022[i] for i in range(len(categories))]
)
sorted_categories = [categories[i] for i in sorted_indices]
sorted_2022 = [sales_2022[i] for i in sorted_indices]
sorted_2023 = [sales_2023[i] for i in sorted_indices]

# ç»å¶è¿æ¥çº¿
# çç¥ ...

# ç»å¶æ°æ®ç¹
# çç¥ ...

# æ·»å ååç®­å¤´æ æ³¨
# çç¥ ...

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://img2024.cnblogs.com/blog/83005/202601/83005-20260122232220694-18227431.png" alt="" loading="lazy"></p>
<p>è¿æ ·æ¹é åï¼ç±ä¸å°ä¸çåéï¼è¶æ¥è¶ç­ï¼ä¹å°±æ¯å¢é¿è¶æ¥è¶æ¢ï¼ï¼æåºé¨çé£ä¸ªæ¯<strong>è´å¢é¿</strong>ï¼ç¨äº<strong>çº¢è²</strong>æ¥æ æ³¨ã</p>
<h1 id="4-æ»ç»">4. æ»ç»</h1>
<p>æ°æ®å¯è§åçæ ¸å¿ç®æ æ¯<strong>ææä¼ è¾¾ä¿¡æ¯</strong>ãå½æä»¬éè¦å¼ºè°ååãæ¯è¾ä¸¤ä¸ªç¸å³ç¶ææ¶ï¼<strong>åéå¾</strong>æä¾äºä¸ç§ç®æ´èå¼ºå¤§çè§£å³æ¹æ¡ã</p>
<p>å°±åéæ©åéçå·¥å·å®æå·¥ä½ä¸æ ·ï¼å¨é¢å¯¹æ°æ®æ¯è¾ä»»å¡æ¶ï¼æä»¬åºè¯¥æ ¹æ®å·ä½éæ±éæ©æåéçå¯è§åå½¢å¼ï¼</p>
<ul>
<li>å½éè¦æ¯è¾å¤ä¸ªé¡¹ç®çä¸¤ä¸ªç¶ææ¶ï¼éæ©<strong>åéå¾</strong></li>
<li>å½éè¦å±ç¤ºåä¸ªé¡¹ç®çå¤ä¸ªç»æé¨åæ¶ï¼éæ©<strong>å ç§¯æ¡å½¢å¾</strong></li>
<li>å½éè¦æ¯è¾å¤ä¸ªé¡¹ç®çå¤ä¸ªç±»å«æ¶ï¼éæ©<strong>ç°ç¶æ¡å½¢å¾</strong></li>
</ul>
<p>æå¥½çå¯è§åä¸æ¯æå¤æçï¼èæ¯è½è®©è§ä¼å¨æç­æ¶é´åçè§£æå¤ä¿¡æ¯çé£ä¸ªã</p>
<p><strong>åéå¾</strong>æ­£æ¯è¿æ ·ä¸ç§é«æçå·¥å·ï¼å®ç¨æç®åççº¿æ¡è¿æ¥ï¼è®²è¿°äºæ°æ®ä¸çä¸­æå¨äººçååæäºã</p>
<p>ä¸æ¬¡åæ¥åæ¶ï¼ä¸å¦¨è¯çæé£å¼ æ¥æ¤çç°ç¶æ¡å½¢å¾æ¢æ<strong>åéå¾</strong>ï¼ç¸ä¿¡ä½ çè§ä¼ä¼æå¹ï¼âåï¼è¿å¼ å¾åå¾çä¸ä¸ï¼â</p>
<p>å®æ´ä»£ç ï¼<a href="https://url11.ctfile.com/f/45455611-8608730361-d698e0?p=6872" target="_blank" rel="noopener nofollow">åéå¾.ipynb</a> (è®¿é®å¯ç : 6872)</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-22 23:23">2026-01-22 23:23</span>&nbsp;
<a href="https://www.cnblogs.com/wang_yb">wang_yb</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19519312);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19519312', targetLink: 'https://www.cnblogs.com/wang_yb/p/19519312', title: 'åéå¾ï¼æ°æ®å¯¹æ¯çä¼éä¹é' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Langchain å¿«éå¥é¨(ä¸) ]]></title>
    <link>https://www.cnblogs.com/ClownLMe/p/19519224</link>
    <guid>e3ca9e874ef51f59f43ff0fba37b0937</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ClownLMe/p/19519224" title="åå¸äº 2026-01-22 22:51">
    <span role="heading" aria-level="2">Langchain å¿«éå¥é¨(ä¸)</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ç®ä»">ç®ä»</h1>
<p>langchainä¸é¨ç¨äºæå»ºLLMå¤§è¯­è¨æ¨¡åï¼å¶ä¸­æä¾äºå¤§éçpromptæ¨¡æ¿ï¼åç»ä»¶ï¼éè¿chain(é¾)çæ¹å¼å°æµç¨è¿æ¥èµ·æ¥ï¼æä½ç®åï¼å¼åä¾¿æ·ã</p>
<h1 id="ç¯å¢éç½®">ç¯å¢éç½®</h1>
<p><strong>å®è£langchainæ¡æ¶</strong></p>
<pre><code class="language-bash">pip install langchain langchain-community
</code></pre>
<p>å¶ä¸­langchainå¯ä»¥æä¾äºåç§å¤§æ¨¡åè¯­è¨åºéæ©ï¼ï¼è¿éåªåä¸¾å ä¸ªï¼ä¾å¦ï¼</p>
<pre><code class="language-bash">#chatgpt
pip install langchain-openai
#hugging face
pip install langchain-huggingface
#åé®
pip install langchain-qwq
</code></pre>
<h1 id="1-è®©æ¨¡åè·èµ·æ¥">1. è®©æ¨¡åè·èµ·æ¥</h1>
<p>å¦ä½è®©ä½ llmè·èµ·æ¥ï¼è¿éç¨çæ¯åé®ï¼æ¥æ¼ç¤º</p>
<h3 id="æ¡ä¾">æ¡ä¾</h3>
<pre><code class="language-python">import os
from langchain_community.chat_models.tongyi import ChatTongyi
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser

#è¿éæ¯ä½ çåé®apikey
os.environ["DASHSCOPE_API_KEY"] = "apikey"

model = ChatTongyi(model="qwen-plus")

prompt = ChatPromptTemplate.from_messages([
&nbsp; &nbsp; ("system", "ä½ æ¯ä¸ä¸ªç²¾é{topic}çèµæ·±ææ¯ä¸å®¶ã"),
&nbsp; &nbsp; ("user", "è¯·ç¨ä¸å¥è¯è§£éä¸ä¸ä»ä¹æ¯{concept}ã")
])

output_parser = StrOutputParser()

chain = prompt | model | output_parser

#ææ¬è¾åº
response = chain.invoke({"topic": "Python", "concept": "åè¡¨"})
print(response)

#åå²
print("="*30)

#æµå¼è¾åº
for chunk in chain.stream({"topic": "äººå·¥æºè½", "concept": "ç¥ç»ç½ç»"}):
&nbsp; &nbsp; print(chunk, end="", flush=True)
</code></pre>
<h3 id="ä»£ç è§£é">ä»£ç è§£é</h3>
<p>æ´ä¸ªä»£ç çæµç¨å¦ä¸ï¼<br>
<strong>åå»ºæ¨¡å-&gt;æå»ºæç¤ºè¯-&gt;æå»ºchainé¾-&gt;ä½¿ç¨å¤§æ¨¡å</strong></p>
<h5 id="åå»ºæ¨¡å">åå»ºæ¨¡å</h5>
<p><mark>è¿ä¸æ­¥ç¨ä¸åçæ¨¡åå¯è½ä¼ä¸å</mark><br>
è¿éå©ç¨langchainçåé®åºåå»ºæ¨¡åï¼å¯è½ä¼ä¸å</p>
<pre><code class="language-python">model = ChatTongyi(model="qwen-plus")

#ä¾å¦ç¨chatgpt
llm = init_chat_model("gpt-4o", model_provider="openai")
</code></pre>
<h5 id="æå»ºæç¤ºè¯">æå»ºæç¤ºè¯</h5>
<p>è¿ä¸æ­¥æå»ºå©ç¨äºlangchainåºæä¾æç¤ºè¯æ¨¡æ¿ï¼<br>
å¶ä¸­ç¨<code>{}</code>éèµ·æ¥çå¨è°ç¨æ¶å¯ä»¥å¨æç¨å­å¸æ¿æ¢</p>
<pre><code class="language-python">prompt = ChatPromptTemplate.from_messages([
&nbsp; &nbsp; ("system", "ä½ æ¯ä¸ä¸ªç²¾é{topic}çèµæ·±ææ¯ä¸å®¶ã"),
&nbsp; &nbsp; ("user", "è¯·ç¨ä¸å¥è¯è§£éä¸ä¸ä»ä¹æ¯{concept}ã")
])
</code></pre>
<p>åä¸ªè§è²åè½å¦ä¸ï¼</p>
<table>
<thead>
<tr>
<th><strong>è§è²åç§° (Role)</strong></th>
<th><strong>å¯¹åºçç±»</strong></th>
<th><strong>ä½ç¨è¯´æ</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>system</strong></td>
<td><code>SystemMessage</code></td>
<td><strong>ç³»ç»æç¤ºè¯</strong>ãç¨äºè®¾å® AI çâäººæ ¼âãä¸ä¸èæ¯ãè¡ä¸ºååæçº¦ææ¡ä»¶ãå®éå¸¸ä¼åçº§æé«ï¼å³å®äºåç»­å¯¹è¯çåºè°ã</td>
</tr>
<tr>
<td><strong>user</strong></td>
<td><code>HumanMessage</code></td>
<td><strong>ç¨æ·æ¶æ¯</strong>ãä»£è¡¨äººç±»åéçåå®¹ãè¿æ¯æ¨¡åéè¦ç´æ¥åç­æå¤ççé®é¢ã</td>
</tr>
<tr>
<td><strong>ai</strong></td>
<td><code>AIMessage</code></td>
<td><strong>AI æ¶æ¯</strong>ãä»£è¡¨æ¨¡åä¹åçåå¤ãå¨æå»ºå¤è½®å¯¹è¯ï¼å¸¦è®°å¿ï¼æ¶ï¼éè¦ææ¨¡åä¹åçåå¤ä¼ åå»ã</td>
</tr>
</tbody>
</table>
<h5 id="æå»ºchainé¾">æå»ºchainé¾</h5>
<p><mark>è¿ä¸ªæ¯langchainççµé­ï¼è¿éç®åè¯´æï¼åé¢ä¼åæ´è¯¦ç»çæå­¦æç« </mark><br>
chainé¾çè¿è¡æµç¨å¦ä¸ï¼<br>
<strong>å°è¾å¥å¡«åprompt-&gt;å°å®æ´promptåç»LLM-&gt;ç´æ¥è§£æè¿åææ¬</strong></p>
<p><code>StrOutputParser()</code>è¿ä¸ªæ¯langchainæä¾çææ¬è§£æå¨ï¼ç¨äºå°ä¸é¢çç»æè§£æä¸ºææ¬</p>
<pre><code class="language-python">output_parser = StrOutputParser()
chain = prompt | model | output_parser
</code></pre>
<h5 id="ä½¿ç¨å¤§æ¨¡å">ä½¿ç¨å¤§æ¨¡å</h5>
<p>è¿éæä¸¤ç§æ¹å¼ï¼</p>
<ol>
<li>ç´æ¥è¾åºå®æ´çææ¬</li>
</ol>
<pre><code class="language-python">response = chain.invoke({"topic": "Python", "concept": "åè¡¨"})
print(response)
</code></pre>
<ol start="2">
<li>æµææ¬è¾åºï¼æå­æºï¼</li>
</ol>
<pre><code class="language-python">for chunk in chain.stream({"topic": "äººå·¥æºè½", "concept": "ç¥ç»ç½ç»"}):
&nbsp; &nbsp; print(chunk, end="", flush=True)
</code></pre>
<p><strong>å¦æâ¤åæ¬¢â¤æ¬ç³»åæç¨ï¼å°±ç¹ä¸ªå³æ³¨å§ï¼åç»­ä¸å®ææ´æ°~</strong></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-22 22:51">2026-01-22 22:51</span>&nbsp;
<a href="https://www.cnblogs.com/ClownLMe">ClownLMe</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19519224);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19519224', targetLink: 'https://www.cnblogs.com/ClownLMe/p/19519224', title: 'Langchain å¿«éå¥é¨(ä¸)' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Nginxå¤æå¡éæèµæºè·¯å¾å²çªè§£å³æ¹æ¡ ]]></title>
    <link>https://www.cnblogs.com/yudaxia/p/19519201</link>
    <guid>e791cf70b8de2c369059d47946957645</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/yudaxia/p/19519201" title="åå¸äº 2026-01-22 22:34">
    <span role="heading" aria-level="2">Nginxå¤æå¡éæèµæºè·¯å¾å²çªè§£å³æ¹æ¡</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>å¨ä½¿ç¨Nginxååä»£çå¤ä¸ªFlaskåºç¨æ¶ï¼éå°äºä¸ä¸ªæ£æçé®é¢ï¼ä¸åæå¡çéæèµæºï¼CSS/JSï¼ä¼äºç¸å¹²æ°ãæ¬æè®°å½äºé®é¢çåæè¿ç¨åè§£å³æ¹æ¡ã</p>
<p><strong>å³é®è¯</strong>ï¼Nginxååä»£çãFlaskéæèµæºãlocationå¹éãproxy_pass</p>
</blockquote>
<h2 id="é®é¢æè¿°">é®é¢æè¿°</h2>
<p>å¨Nginxååä»£çå¤ä¸ªFlaskæå¡æ¶ï¼ä¸åæå¡çéæèµæºè·¯å¾ä¼åçå²çªï¼å¯¼è´æå¡Açé¡µé¢å è½½äºæå¡BçCSS/JSæä»¶ï¼æèæ¾ä¸å°éæèµæºè¿å404éè¯¯ã</p>
<h3 id="é®é¢åºæ¯">é®é¢åºæ¯</h3>
<h4 id="é¨ç½²æ¶æ">é¨ç½²æ¶æ</h4>
<pre><code>åå: mathcoding.top
âââ ä¸»æå¡ (ç«¯å£5000) â è·¯å¾åç¼: /
âââ éæµæå¡ (ç«¯å£5001) â è·¯å¾åç¼: /numberLimit
</code></pre>
<h4 id="åå§nginxéç½®">åå§Nginxéç½®</h4>
<pre><code class="language-nginx"># éæµæå¡
location /numberLimit {
&nbsp; &nbsp; proxy_pass http://127.0.0.1:5001/;
&nbsp; &nbsp; proxy_set_header Host $host;
&nbsp; &nbsp; proxy_set_header X-Real-IP $remote_addr;
&nbsp; &nbsp; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
&nbsp; &nbsp; proxy_set_header X-Forwarded-Proto $scheme;
}
# ä¸»æå¡ï¼ååºè§åï¼
location / {
&nbsp; &nbsp; proxy_pass http://127.0.0.1:5000;
&nbsp; &nbsp; proxy_set_header Host $host;
&nbsp; &nbsp; proxy_set_header X-Real-IP $remote_addr;
&nbsp; &nbsp; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
&nbsp; &nbsp; proxy_set_header X-Forwarded-Proto $scheme;
}
</code></pre>
<h4 id="flaskæ¨¡æ¿ä»£ç ">Flaskæ¨¡æ¿ä»£ç </h4>
<pre><code class="language-html">&lt;!-- 5001ç«¯å£çéæµæå¡çæ¨¡æ¿ --&gt;
&lt;link rel="stylesheet" href="{{url_for('static', filename='css/style.css')}}" /&gt;
</code></pre>
<h3 id="éè¯¯è¡¨ç°è¯¦è§£">éè¯¯è¡¨ç°è¯¦è§£</h3>
<p><strong>ææè¡ä¸º</strong>ï¼</p>
<ol>
<li>è®¿é® <code>https://mathcoding.top/numberLimit/</code> å è½½éæµæå¡çé¡µé¢</li>
<li>é¡µé¢ä¸­çCSSé¾æ¥åºè¯¥è¯·æ±éæµæå¡(5001ç«¯å£)çéæèµæº</li>
<li>æµè§å¨åºè¯¥è½æ­£ç¡®è·åå°éæµæå¡ç <code>static/css/style.css</code> æä»¶<br>
<strong>å®éè¡ä¸º</strong>ï¼</li>
<li>è®¿é® <code>https://mathcoding.top/numberLimit/</code> â æ­£ç¡®å è½½é¡µé¢HTML</li>
<li>Flaskç <code>url_for('static')</code> çæè·¯å¾ï¼<code>/static/css/style.css</code></li>
<li>æµè§å¨åèµ·è¯·æ±ï¼<code>https://mathcoding.top/static/css/style.css</code></li>
<li>Nginxå¹éå° <code>location /</code>ï¼å ä¸º <code>/static/...</code> å¹éä¸å° <code>/numberLimit</code>ï¼</li>
<li>è¯·æ±è¢«è½¬åå°ä¸»æå¡5000ç«¯å£ â <strong>éè¯¯çæå¡ï¼</strong></li>
<li>ç»æï¼å è½½äºä¸»æå¡çCSSï¼æ ·å¼éè¯¯ï¼æè¿å404ï¼ä¸»æå¡æ²¡æè¿ä¸ªæä»¶ï¼</li>
</ol>
<h3 id="é®é¢çè§è§è¡¨ç°">é®é¢çè§è§è¡¨ç°</h3>
<p>æå¼æµè§å¨å¼åèå·¥å·Networkæ ç­¾ä¼çå°ï¼</p>
<pre><code>è¯·æ±URL: https://mathcoding.top/static/css/style.css
ç¶æç : 200 æ 404
æ¥æºé¡µé¢: https://mathcoding.top/numberLimit/
é®é¢: è¿ä¸ªCSSæä»¶æ¥èª5000ç«¯å£çä¸»æå¡ï¼ä¸æ¯5001ç«¯å£çéæµæå¡
</code></pre>
<p>é¡µé¢è¡¨ç°ï¼</p>
<ul>
<li>CSSæ ·å¼ä¸æ­£ç¡®æå®å¨æ²¡ææ ·å¼</li>
<li>æ§å¶å°å¯è½åºç°MIMEç±»åéè¯¯</li>
<li>å¦æä¸»æå¡æ²¡æååæä»¶ï¼åæ¾ç¤º404éè¯¯</li>
</ul>
<h2 id="é®é¢æ ¹æº">é®é¢æ ¹æº</h2>
<h3 id="åºå±åç">åºå±åç</h3>
<ol>
<li><strong>Flask URLçææºå¶</strong>ï¼<code>url_for('static')</code> çæçæ¯ç»å¯¹è·¯å¾ï¼é»è®¤ä¸º <code>/static/...</code>ï¼ä¸åå«æå¡çæè½½åç¼</li>
<li><strong>Nginx locationå¹éè§å</strong>ï¼éç¨æé¿åç¼å¹éï¼<code>/static/...</code> ä¸å¹é <code>/numberLimit</code>ï¼å æ­¤è¢« <code>location /</code> æè·</li>
<li><strong>è·¯å¾å½åç©ºé´å²çª</strong>ï¼å¤ä¸ªæå¡å±äº«åä¸ä¸ªURLè·¯å¾ç©ºé´ï¼é½ä½¿ç¨ <code>/static/...</code> ä½ä¸ºéæèµæºè·¯å¾</li>
</ol>
<h3 id="è¯·æ±æµç¨åæ">è¯·æ±æµç¨åæ</h3>
<pre><code>Flaskæ¸²ææ¨¡æ¿
&nbsp; &nbsp; â
url_for('static', filename='css/style.css')
&nbsp; &nbsp; â
çæHTML: &lt;link href="/static/css/style.css"&gt;
&nbsp; &nbsp; â
æµè§å¨è§£æHTMLå¹¶åèµ·è¯·æ±: GET /static/css/style.css
&nbsp; &nbsp; â
Nginxå¹éè§å:
&nbsp; - /numberLimit? ä¸å¹é (è¯·æ±è·¯å¾æ¯/static/..., ä¸æ¯/numberLimit/...)
&nbsp; - /? å¹é! (æé¿åç¼å¹éçååºè§å)
&nbsp; &nbsp; â
proxy_passè½¬åå°: http://127.0.0.1:5000/static/css/style.css
&nbsp; &nbsp; â
éè¯¯: 5001æå¡çéæèµæºè¢«éè¯¯å°è·¯ç±å°5000æå¡
</code></pre>
<h3 id="ä¸ºä»ä¹flaskä¸çæ-numberlimitstatic">ä¸ºä»ä¹Flaskä¸çæ <code>/numberLimit/static/...</code>ï¼</h3>
<p>Flaskåºç¨æ¬èº«ä¸ç¥éå®è¢«é¨ç½²å¨ä»ä¹è·¯å¾ä¸ãä»Flaskçè§è§ï¼</p>
<ul>
<li>å®æ¶å°çè¯·æ±è·¯å¾æ¯ <code>/</code>ï¼å ä¸º <code>proxy_pass http://127.0.0.1:5001/</code> æ«å°¾æææ ï¼ä¼å¥ç¦»åç¼ï¼</li>
<li>å®è®¤ä¸ºèªå·±çæ ¹è·¯å¾å°±æ¯ <code>/</code></li>
<li>æä»¥ <code>url_for('static')</code> çæ <code>/static/...</code> èä¸æ¯ <code>/numberLimit/static/...</code><br>
è¿å°±æ¯ä¸ºä»ä¹éè¦å¨Flaskç«¯éç½® <code>static_url_path</code>ï¼æèå¨Nginxç«¯åè·¯å¾éåã</li>
</ul>
<h2 id="è§£å³æ¹æ¡">è§£å³æ¹æ¡</h2>
<h3 id="æ¹æ¡éæ©ç¬ç«éæèµæºè·¯å¾åç¼">æ¹æ¡éæ©ï¼ç¬ç«éæèµæºè·¯å¾åç¼</h3>
<p>ä¸ºæ¯ä¸ªæå¡éç½®ç¬ç«çéæèµæºURLåç¼ï¼é¿åè·¯å¾å²çªãè¿ç§æ¹æ¡ï¼</p>
<ul>
<li>æå¡ä»£ç æ¹å¨æå°ï¼åªæ¹ä¸ä¸ªéç½®åæ°ï¼</li>
<li>ä¸éè¦å¤æçURLéåè§å</li>
<li>æäºçè§£åç»´æ¤</li>
<li>ç¬¦åå¾®æå¡çå½åç©ºé´éç¦»åå</li>
</ul>
<h3 id="flaskéç½®">Flaskéç½®</h3>
<pre><code class="language-python"># è®¾ç½®ç¬ç«çéæèµæºURLè·¯å¾
app = Flask(__name__, static_url_path="/numberLimit-static")
</code></pre>
<p><strong>åæ°è¯´æ</strong>ï¼</p>
<ul>
<li><code>static_url_path</code>: æ§å¶URLçæï¼å½±å <code>url_for('static')</code> çè¾åº</li>
<li><code>static_folder</code>: æ§å¶æä»¶ç³»ç»è·¯å¾ï¼é»è®¤ä¸º'static'ï¼ä¸éè¦æ¹ï¼<br>
<strong>ææ</strong>ï¼</li>
</ul>
<pre><code class="language-python"># ä¿®æ¹å
url_for('static', filename='css/style.css') &nbsp;# â /static/css/style.css
# ä¿®æ¹å
url_for('static', filename='css/style.css') &nbsp;# â /numberLimit-static/css/style.css
</code></pre>
<h3 id="nginxéç½®">Nginxéç½®</h3>
<pre><code class="language-nginx"># éæèµæºlocationï¼ä¼åçº§é«ï¼æ¾å¨åé¢ï¼
location /numberLimit-static/ {
&nbsp; &nbsp; proxy_pass http://127.0.0.1:5001/numberLimit-static/;
&nbsp; &nbsp; proxy_set_header Host $host;
&nbsp; &nbsp; proxy_set_header X-Real-IP $remote_addr;
&nbsp; &nbsp; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
&nbsp; &nbsp; proxy_set_header X-Forwarded-Proto $scheme;
}
# æå¡ä¸»è·¯å¾
location /numberLimit {
&nbsp; &nbsp; proxy_pass http://127.0.0.1:5001/;
&nbsp; &nbsp; proxy_set_header Host $host;
&nbsp; &nbsp; proxy_set_header X-Real-IP $remote_addr;
&nbsp; &nbsp; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
&nbsp; &nbsp; proxy_set_header X-Forwarded-Proto $scheme;
}
# ä¸»æå¡ï¼æ¾å¨æåï¼
location / {
&nbsp; &nbsp; proxy_pass http://127.0.0.1:5000;
&nbsp; &nbsp; proxy_set_header Host $host;
&nbsp; &nbsp; proxy_set_header X-Real-IP $remote_addr;
&nbsp; &nbsp; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
&nbsp; &nbsp; proxy_set_header X-Forwarded-Proto $scheme;
}
</code></pre>
<h3 id="å·¥ä½æµç¨">å·¥ä½æµç¨</h3>
<pre><code>Flaskæ¸²ææ¨¡æ¿
&nbsp; &nbsp; â
url_for('static', filename='css/style.css')
&nbsp; &nbsp; â
çæHTML: &lt;link href="/numberLimit-static/css/style.css"&gt;
&nbsp; &nbsp; â
æµè§å¨è¯·æ±: GET https://mathcoding.top/numberLimit-static/css/style.css
&nbsp; &nbsp; â
Nginxå¹éè§å:
&nbsp; - /numberLimit-static/? å¹é! (æé¿åç¼å¹é)
&nbsp; &nbsp; â
proxy_passè½¬å: http://127.0.0.1:5001/numberLimit-static/css/style.css
&nbsp; &nbsp; â
Flaskå¤ç:
&nbsp; - è·¯ç± /numberLimit-static/* ç± static_url_path å¤ç
&nbsp; - æ å°å°æä»¶ç³»ç»: static/css/style.css
&nbsp; &nbsp; â
è¿åæ­£ç¡®çCSSæä»¶ â
</code></pre>
<h2 id="å³é®ææ¯ç»è">å³é®ææ¯ç»è</h2>
<h3 id="proxy_passå°¾ææ çä½ç¨">proxy_passå°¾ææ çä½ç¨</h3>
<pre><code class="language-nginx"># â æ­£ç¡®ï¼å¸¦å°¾ææ ï¼è¿è¡è·¯å¾æ¿æ¢
proxy_pass http://127.0.0.1:5001/numberLimit-static/;
# è¯·æ± /numberLimit-static/css/style.css
# è½¬å http://127.0.0.1:5001/numberLimit-static/css/style.css
# â éè¯¯ï¼ä¸å¸¦å°¾ææ ï¼æ¼æ¥å®æ´è·¯å¾
proxy_pass http://127.0.0.1:5001/numberLimit-static;
# è¯·æ± /numberLimit-static/css/style.css
# è½¬å http://127.0.0.1:5001/numberLimit-static/numberLimit-static/css/style.css
</code></pre>
<p><strong>åç</strong>ï¼</p>
<ul>
<li>æå°¾ææ ï¼Nginxä¼ç¨ <code>proxy_pass</code> çè·¯å¾<strong>æ¿æ¢</strong> <code>location</code> å¹éçé¨å</li>
<li>æ å°¾ææ ï¼Nginxä¼ç´æ¥<strong>æ¼æ¥</strong>å®æ´çè¯·æ±URI</li>
</ul>
<h3 id="locationå¹éä¼åçº§">locationå¹éä¼åçº§</h3>
<p>Nginxçlocationå¹éè§åï¼æä¼åçº§ä»é«å°ä½ï¼ï¼</p>
<ol>
<li>ç²¾ç¡®å¹é <code>location = /path</code></li>
<li>æ­£åå¹é <code>location ~ /pattern</code> æ <code>location ~* /pattern</code></li>
<li>åç¼å¹éï¼æé¿ä¼åï¼<code>location /path</code><br>
å¨æ¬æ¹æ¡ä¸­ï¼</li>
</ol>
<ul>
<li><code>/numberLimit-static/</code> é¿åº¦19ï¼æ¯ <code>/</code> æ´å·ä½ï¼ä¼åå¹é</li>
<li><code>/numberLimit</code> é¿åº¦13ï¼æ¯ <code>/</code> æ´å·ä½ï¼ä¼åå¹é</li>
<li><code>/</code> é¿åº¦1ï¼ä½ä¸ºååºï¼å¹éææå¶ä»è¯·æ±<br>
<strong>éªè¯æ¹æ³</strong>ï¼</li>
</ul>
<pre><code class="language-bash"># æµè¯Nginxéç½®
nginx -t
# æ¥çå®éå¹éçlocationï¼éè¦å¼å¯debugæ¥å¿ï¼
tail -f /var/log/nginx/error.log | grep location
</code></pre>
<h2 id="æ´å¥½çé¿ææ¹æ¡å­åå">æ´å¥½çé¿ææ¹æ¡ï¼å­åå</h2>
<p>å½åç <code>static_url_path</code> æ¹æ¡æ¯è·¯å¾åç¼é¨ç½²ä¸çæå®ä¹è®¡ã<strong>æä½³å®è·µæ¯ä¸ºæ¯ä¸ªæå¡åéç¬ç«çå­åå</strong>ï¼è¿æ ·å¯ä»¥ä»æ ¹æ¬ä¸è§£å³è·¯å¾å²çªé®é¢ã</p>
<h3 id="å­ååæ¹æ¡ç¤ºä¾">å­ååæ¹æ¡ç¤ºä¾</h3>
<pre><code class="language-nginx"># éæµæå¡ - ç¬ç«å­åå
server {
&nbsp; &nbsp; server_name numberlimit.mathcoding.top;
&nbsp; &nbsp;
&nbsp; &nbsp; location / {
&nbsp; &nbsp; &nbsp; &nbsp; proxy_pass http://127.0.0.1:5001;
&nbsp; &nbsp; &nbsp; &nbsp; # proxyéç½®...
&nbsp; &nbsp; }
}
# ä¸»æå¡
server {
&nbsp; &nbsp; server_name mathcoding.top www.mathcoding.top;
&nbsp; &nbsp;
&nbsp; &nbsp; location / {
&nbsp; &nbsp; &nbsp; &nbsp; proxy_pass http://127.0.0.1:5000;
&nbsp; &nbsp; &nbsp; &nbsp; # proxyéç½®...
&nbsp; &nbsp; }
}
</code></pre>
<p>Flaskæ¢å¤é»è®¤éç½®ï¼</p>
<pre><code class="language-python">app = Flask(__name__) &nbsp;# æ éè®¾ç½®static_url_path
</code></pre>
<p><strong>ä¼å¿</strong>ï¼</p>
<ul>
<li>æ¯ä¸ªæå¡æå®å¨ç¬ç«çURLè·¯å¾ç©ºé´</li>
<li>æ éä»»ä½ç¹æ®çéæèµæºéç½®</li>
<li>æ´ç¬¦åå¾®æå¡æ¶æçå¿µ</li>
<li>ä¾¿äºæå¡ç¬ç«æ©å±åè¿ç§»</li>
</ul>
<h2 id="æ»ç»">æ»ç»</h2>
<h3 id="é®é¢æ¬è´¨">é®é¢æ¬è´¨</h3>
<p>å¤ä¸ªæå¡å±äº«åä¸ä¸ªURLè·¯å¾ç©ºé´ï¼Flaskçæçéæèµæºè·¯å¾æ¯ç»å¯¹è·¯å¾ï¼<code>/static/...</code>ï¼ï¼å¯¼è´ä¸åæå¡çéæèµæºè¢«è·¯ç±å°éè¯¯çåç«¯æå¡ã</p>
<h3 id="è§£å³æ¹æ¡æ ¸å¿">è§£å³æ¹æ¡æ ¸å¿</h3>
<p>ä¸ºæ¯ä¸ªæå¡åéç¬ç«çéæèµæºURLåç¼ï¼éè¿Flaskç <code>static_url_path</code> åæ°éåNginxçlocationè·¯ç±å®ç°è·¯å¾éç¦»ã</p>
<h3 id="å³é®éç½®">å³é®éç½®</h3>
<ol>
<li><strong>Flaskä¾§</strong>ï¼<code>app = Flask(__name__, static_url_path="/æå¡å-static")</code></li>
<li><strong>Nginxä¾§</strong>ï¼æ·»å å¯¹åºç <code>location /æå¡å-static/</code> è§å</li>
<li><strong>æ³¨æç¹</strong>ï¼<code>proxy_pass</code> æ«å°¾çææ ä¼å½±åè·¯å¾è½¬æ¢</li>
</ol>
<h3 id="éç¨åºæ¯">éç¨åºæ¯</h3>
<ul>
<li>å¤ä¸ªWebåºç¨å±äº«ä¸ä¸ªåå</li>
<li>ä½¿ç¨è·¯å¾åç¼åºåä¸åæå¡ï¼å¦ <code>/app1</code>ã<code>/app2</code>ï¼</li>
<li>éè¦å¿«éé¨ç½²ï¼ææ¶æ æ³ä½¿ç¨å­åå</li>
</ul>
<h3 id="é¿æå»ºè®®">é¿æå»ºè®®</h3>
<p>å½ä¸å¡ç¨³å®åï¼å»ºè®®è¿ç§»å°å­ååæ¹æ¡ï¼å¦ <code>app1.example.com</code>ã<code>app2.example.com</code>ï¼ï¼ä»æ¶æä¸å½»åºè§£å³è·¯å¾å²çªé®é¢ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-22 22:35">2026-01-22 22:34</span>&nbsp;
<a href="https://www.cnblogs.com/yudaxia">yupenglei</a>&nbsp;
éè¯»(<span id="post_view_count">3</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19519201);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19519201', targetLink: 'https://www.cnblogs.com/yudaxia/p/19519201', title: 'Nginxå¤æå¡éæèµæºè·¯å¾å²çªè§£å³æ¹æ¡' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬äºå¨ï¼è¯åµå¥ï¼åï¼åå± softmax åè´éæ · ]]></title>
    <link>https://www.cnblogs.com/Goblinscholar/p/19519181</link>
    <guid>119c6b7f09787c341bfd1464d0b7b0ee</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Goblinscholar/p/19519181" title="åå¸äº 2026-01-22 22:28">
    <span role="heading" aria-level="2">å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬äºå¨ï¼è¯åµå¥ï¼åï¼åå± softmax åè´éæ ·</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æ­¤åç±»ç¨äºè®°å½å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨çå­¦ä¹ ç¬è®°ã<br>
è¯¾ç¨ç¸å³ä¿¡æ¯é¾æ¥å¦ä¸ï¼</p>
<ol>
<li>åè¯¾ç¨è§é¢é¾æ¥ï¼<a href="https://www.bilibili.com/video/BV1FT4y1E74V?buvid=XU762317353676D786954061C192FE625463B&amp;from_spmid=playlist.playlist-detail.0.0&amp;is_story_h5=false&amp;mid=zqernykrmpf7XfIorMR%2FnA%3D%3D&amp;plat_id=116&amp;share_from=ugc&amp;share_medium=android&amp;share_plat=android&amp;share_session_id=ce0bc526-db69-428a-962e-c65ed8c267bc&amp;share_source=COPY&amp;share_tag=s_i&amp;spmid=united.player-video-detail.0.0&amp;timestamp=1713085655&amp;unique_k=DfBgvFW&amp;up_id=8654113&amp;vd_source=e035e9878d32f414b4354b839a4c31a4" target="_blank" rel="noopener nofollow">[åè¯­å­å¹]å´æ©è¾¾æ·±åº¦å­¦ä¹ deeplearning.ai</a></li>
<li>githubè¯¾ç¨èµæï¼å«è¯¾ä»¶ä¸ç¬è®°:<a href="https://github.com/robbertliu/deeplearning.ai-andrewNG" target="_blank" rel="noopener nofollow">å´æ©è¾¾æ·±åº¦å­¦ä¹ æå­¦èµæ</a></li>
<li>è¯¾ç¨éå¥ç»ä¹ ï¼ä¸­è±ï¼ä¸ç­æ¡ï¼<a href="https://blog.csdn.net/u013733326/article/details/79827273" target="_blank" rel="noopener nofollow">å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾åä¹ é¢ä¸ç­æ¡</a></li>
</ol>
<p>æ¬ç¯ä¸ºç¬¬äºè¯¾çç¬¬äºå¨åå®¹ï¼<a href="https://www.bilibili.com/video/BV1FT4y1E74V?spm_id_from=333.788.videopod.episodes&amp;vd_source=e035e9878d32f414b4354b839a4c31a4&amp;p=169" target="_blank" rel="noopener nofollow">2.7</a>çåå®¹ä»¥åä¸äºç¸å³ç¥è¯çè¡¥åã</p>
<hr>
<p>æ¬å¨ä¸ºç¬¬äºè¯¾çç¬¬äºå¨åå®¹ï¼ä¸ CV ç¸å¯¹åºçï¼è¿ä¸è¯¾ææåå®¹çä¸­å¿åªæä¸ä¸ªï¼<strong>èªç¶è¯­è¨å¤çï¼Natural Language Processingï¼NLPï¼</strong>ã<br>
åºç¨å¨æ·±åº¦å­¦ä¹ éï¼å®æ¯ä¸é¨ç¨æ¥è¿è¡<strong>ææ¬ä¸åºåä¿¡æ¯å»ºæ¨¡</strong>çæ¨¡ååææ¯ï¼æ¬è´¨ä¸æ¯å¨å¨è¿æ¥ç½ç»ä¸ç»è®¡è¯­è¨æ¨¡ååºç¡ä¸çä¸æ¬¡âç»æåç¹åâï¼ä¹æ¯äººå·¥æºè½ä¸­<strong>æè´´è¿äººç±»æç»´è¡¨è¾¾æ¹å¼</strong>çéè¦ç ç©¶æ¹åä¹ä¸ã<br>
<strong>è¿ä¸æ´èè¯¾åæ ·æ¶åå¤§ééè¦åå¤æ¶åçåå®¹ï¼æ¨ªè·¨æºå¨å­¦ä¹ ãæ¦çç»è®¡ãçº¿æ§ä»£æ°ä»¥åè¯­è¨å­¦ç´è§ã</strong><br>
è¯­è¨ä¸åå¾åé£æ ·âç´è§å¯è§âï¼æ´å¤æ¯æ½è±¡ç¬¦å·ä¸ä¸ä¸æå³ç³»çç»åï¼å æ­¤<strong>çè§£é¨æ§åèæ´é«</strong>ã<br>
å æ­¤ï¼æåæ ·ä¼å°½éè¡¥è¶³å¿è¦çèæ¯ç¥è¯ï¼å°½å¯è½ç¨æ¯å»åå®ä¾éä½çè§£é¾åº¦ã<br>
æ¬å¨çåå®¹å³äºè¯åµå¥ï¼æ¯ä¸ç§<strong>ç¸å¯¹äºç¬ç­ç¼ç ï¼æ´è½ä¿çè¯­ä¹ä¿¡æ¯çææ¬ç¼ç æ¹å¼</strong>ãéè¿è¯åµå¥ï¼æ¨¡åä¸ååªæ¯âè®°ä½âè¯æ¬èº«ï¼èæ¯è½å¤<strong>åºäºè¯­ä¹å³ç³»è¿è¡æ³å</strong>ï¼å¨ä¸å®ç¨åº¦ä¸å®ç°ç±»ä¼¼â<strong>ä¸¾ä¸åä¸</strong>âçææãè¯åµå¥æ¯ NLP é¢åä¸­æéè¦çåºç¡ææ¯ä¹ä¸ã</p>
<p>æ¬ç¯çåå®¹å³äº<strong>åå± softmax åè´éæ ·</strong>ï¼æ¯ç¨æ¥æåè¯åµå¥æ¨¡åè®­ç»æçï¼èçè®¡ç®å¼éçææ¯ã</p>
<h1 id="1-åå±-softmax">1. åå± softmax</h1>
<p>å¨ä¸ä¸ç¯ä»ç» <a href="https://www.cnblogs.com/Goblinscholar/p/19504549" target="_blank">Word2Vec</a> çæ¶åï¼æä»¬é»è®¤ä½¿ç¨çæ¯<strong>æ å softmax</strong> æ¥è®¡ç®è¾åºå±çæ¦çåå¸ãä½å¦æç¨å¾®åä¸æ¥ä»ç»æ³ä¸æ³ï¼å°±ä¼ç«å»æè¯å°ä¸ä¸ªé®é¢ï¼<strong>å¨å¤§è¯è¡¨åºæ¯ä¸ï¼æ å softmax å ä¹æ¯ä¸å¯ç¨çã</strong></p>
<p>ä¸é¢æä»¬åç¹æ¥å±å¼æ å softmax å¨è¯åµå¥ä¸­çå±éååå± softmax çææ³ï¼</p>
<h2 id="11-æ å-softmax-çè®¡ç®å¼é">1.1 æ å softmax çè®¡ç®å¼é</h2>
<p>å¨ä¹åçç¤ºä¾ä¸­ï¼æä»¬åå¤å¼ºè°è¿ä¸ç¹ï¼<strong>è¾åºå±çç¥ç»åä¸ªæ°ä¸è¯å¸å¤§å°å®å¨ä¸è´</strong>ã<br>
è¿æ¯å ä¸ºï¼å¨ Word2Vec çå»ºæ¨¡è§è§ä¸ï¼é¢æµè¿ç¨æ¬è´¨ä¸å¯ä»¥è¢«çä½ä¸ä¸ª<strong>åæ ç­¾åç±»é®é¢</strong>ï¼</p>
<ul>
<li>ç®æ è¯å¯¹åºâæ­£ç¡®ç±»å«â</li>
<li>è¯è¡¨ä¸­å¶ä½ææè¯é½å¯¹åºâéè¯¯ç±»å«â</li>
</ul>
<p>å æ­¤ï¼æä»¬éè¦éè¿ softmax å°æ¨¡åè¾åºæ å°ä¸ºä¸ä¸ª<strong>å¯¹æ´ä¸ªè¯è¡¨çæ¦çåå¸</strong>ï¼å¹¶å¨ååä¼ æ­é¶æ®µä¸æ­<strong>å¼ºåæ­£ç¡®é¢æµãæå¶éè¯¯é¢æµ</strong>ã</p>
<p>ä»å»ºæ¨¡é»è¾ä¸çï¼è¿ä¸è¿ç¨æ¯å®å¨åççï¼ä½çæ­£çé®é¢ï¼å¹¶ä¸åºå¨âå¯¹ä¸å¯¹âï¼èæ¯âè½ä¸è½å®ç°âã</p>
<p>æä»¬ç¥éï¼å¨ NLP ä»»å¡ä¸­ï¼å¦æå¸ææ¨¡åå·å¤æ´å¼ºçæ³åè½åï¼ç¬¬ä¸æ­¥å¾å¾å°±æ¯<strong>æ©å¤§è¯­æè§æ¨¡</strong>ï¼è¿èæå»ºæ´å¤§çè¯å¸ã<br>
èå½æä»¬å¸ææ¨¡åå¨ç°å®åºæ¯ä¸­âçæ­£å¥½ç¨âæ¶ï¼å¶æ§è½ææ å¾å¾éè¦ä¸æ­é¼è¿ï¼çè³å°è¯è¶è¶æä»¬ä¹åä»ç»è¿ç<a href="https://www.cnblogs.com/Goblinscholar/p/19274215" target="_blank">è´å¶æ¯æä¼éè¯¯ç</a>ã<br>
å¨è¿ä¸ªæä¹ä¸ï¼è¯å¸è§æ¨¡å¹¶ä¸æ¯ä¸ä¸ªå¯æå¯æ çå·¥ç¨åæ°ï¼èæ¯æ¨¡åè½åç<strong>ç¡¬ä¸é</strong>ã</p>
<p>ä¸ä¸ªç´è§çç±»æ¯å°±æ¯ï¼<strong>äººç±»çå¤§èç©¶ç«âè®°ä½âäºå¤å°è¯ï¼</strong> æ¾ç¶ï¼è¿ç»ä¸æ¯ä¸ä¸ªå¯ä»¥ç¨âå åâæâå ä¸âæ¥æè¿°çæ°éçº§ã</p>
<p>é®é¢ä¹æ­£æ¯å¨è¿éå¼å§æ¾ç°çï¼å¯¹äºä¸æ¬¡æ å softmax è®¡ç®èè¨ï¼å¦æè¯è¡¨å¤§å°ä¸º <span class="math inline">\(|V|\)</span>ï¼é£ä¹æ¨¡åå¨è¾åºå±éè¦å®æçæä½åæ¬ï¼</p>
<ol>
<li>å¯¹ <strong><span class="math inline">\(|V|\)</span> ä¸ªè¯åé</strong> åå«è®¡ç®åç§¯ã</li>
<li>å¯¹ <strong><span class="math inline">\(|V|\)</span> ä¸ªå¾å</strong> è¿è¡ææ°è¿ç®ã</li>
<li>å¯¹ææç»ææ±åå¹¶å®æå½ä¸åã</li>
</ol>
<p>å¶è®¡ç®å½¢å¼å¯ä»¥åæï¼</p>
<p></p><div class="math display">\[P(w_o \mid w_c)=

\frac{\exp(\mathbf{u}_{w_o}^\top \mathbf{v}_{w_c})}  
{\sum_{w \in V} \exp(\mathbf{u}_w^\top \mathbf{v}_{w_c})}  
\]</div><p></p><p>æ³¨æï¼è¿éçç¥äº softmax è¾åºå±çåç½®é¡¹ï¼å¨ Word2Vec çå®éå»ºæ¨¡ä¸å®ç°ä¸­ï¼è¯¥åç½®å¯¹è¯åéè¯­ä¹ç»æçå½±åéå¸¸å¯ä»¥å¿½ç¥ï¼è¿æ¯å¾ç®åçéçï¼<strong>æä»¬éè¦å»ç»åéé´çè·ç¦»å³ç³»ï¼èåç½®å¸¦æ¥çæ´ä½å¹³ç§»æ¾ç¶æ¯æ²¡ææä¹çã</strong></p>
<p>åå°æ­£é¢ï¼ä¹å°±æ¯è¯´ï¼<strong>åªææä»¬åªå³å¿ä¸ä¸ªç®æ è¯çæ¦ç</strong>ï¼ æ¨¡åä»ç¶å¿é¡»å¯¹<strong>æ´ä¸ªè¯è¡¨ä¸­çææè¯</strong>åè®¡ç®ä¸éæåã</p>
<p>å æ­¤ï¼æ¯ä¸ä¸ªè®­ç»æ ·æ¬å¨è¾åºå±ç<strong>è®¡ç®å¤æåº¦é½æ¯ï¼<span class="math inline">\(O(|V|)\)</span>ã</strong><br>
å½ <span class="math inline">\(|V|\)</span> åªæå åæ¶ï¼è¿ä¸ªä»£ä»·å°å¯æ¥åï¼ä½ä¸æ¦è¯å¸è§æ¨¡è¾¾å°å åä¸ãçè³ä¸ç¾ä¸çº§å«ï¼è¿ä¸æ­¥è®¡ç®å°±ä¼è¿éæä¸ºè®­ç»è¿ç¨ä¸­çä¸»è¦ç¶é¢ã<br>
æ¢å¥è¯è¯´ï¼<strong>æ å softmax çè®¡ç®ææ¬ä¸è¯è¡¨è§æ¨¡çº¿æ§ç¸å³</strong>ï¼è¿ä¸æ§è´¨å¨å¤§è¯è¡¨åºæ¯ä¸æ¯æ æ³åé¿çã<br>
ç¨æä»¬ä¹åçåå®¹æ¥ç±»æ¯ä¸ä¸ï¼<strong>ä½ è§è¿å ç¾ä¸ç±»å«çåç±»æ¨¡ååï¼</strong><br>
ä¹æ­£æ¯å¨è¿æ ·çèæ¯ä¸ï¼æä»¬ä¸å¾ä¸æèæ°çé®é¢ï¼ <strong>å¯ä¸å¯ä»¥å¨ä¸æ¾å¼éåæ´ä¸ªè¯è¡¨çåæä¸ï¼å®æå¯¹ç®æ è¯çææå»ºæ¨¡ï¼</strong><br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260122222725445-514225875.png" alt="image.png" loading="lazy"><br>
äºæ¯ï¼Word2Vec æåºäºç¬¬ä¸ç§å éç­ç¥ï¼<strong>åå± softmax</strong>ã</p>
<h2 id="12-åå¤«æ¼æ ">1.2 åå¤«æ¼æ </h2>
<p>åå¤«æ¼æ¯å¶å®æ¯æ°æ®ç»æéçåå®¹ï¼æä»¬ççå®å¨åå±softmaxä¸­å®ç°çææã</p>
<p>åå¤«æ¼æ ææ©è¢«ç¨äº<strong>æ ææ°æ®åç¼©</strong>ï¼å¶æ ¸å¿ææ³å¯ä»¥æ¦æ¬ä¸ºä¸å¥è¯ï¼<strong>åºç°é¢çè¶é«çç¬¦å·ï¼ç¼ç è¶ç­ï¼åºç°é¢çè¶ä½çç¬¦å·ï¼ç¼ç è¶é¿ã</strong> éè¿è¿ç§æ¹å¼ï¼<strong>é«é¢ç¬¦å·æ¥ææ´ç­çè·¯å¾é¿åº¦</strong>ï¼ä»èå¨æ´ä½æä¹ä¸æå°åç¼ç çææé¿åº¦ã</p>
<p>å¨ åå±softmax ä¸­ï¼å¹¶æ²¡æä½¿ç¨å¶åç¼©ç¼ç çé»è¾ï¼èæ¯éç¹å©ç¨åå¤«æ¼æ ä¸­<strong>é«é¢ç¬¦å·æ¥ææ´ç­çè·¯å¾é¿åº¦</strong>çç¹ç¹æ¥ç»ç»è¯è¡¨å¹¶ä¼åä¼ æ­é»è¾ï¼å®çè¿ç¨å¦ä¸ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260122222708870-226555105.png" alt="image.png" loading="lazy"></p>
<p>åå·ä½æ¥è¯´ï¼Word2Vec çåå± softmax å°è¯è¡¨ç»ç»æåå¤«æ¼æ çæ­¥éª¤å¦ä¸ï¼</p>
<ol>
<li><strong>ç»è®¡è¯é¢</strong>ï¼é¦åå¯¹è¯­æåºä¸­çæ¯ä¸ªè¯è®¡ç®åºç°é¢çï¼é¢çè¶é«çè¯è¡¨ç¤ºè¶å¸¸è§ï¼ä¹å°±è¶å¯è½å¨è®­ç»ä¸­è¢«è®¿é®å¤æ¬¡ã</li>
<li><strong>æå»ºåå¤«æ¼æ </strong>ï¼
<ul>
<li>å°æ¯ä¸ªè¯ä½ä¸ºå¶å­èç¹ï¼èç¹æé = è¯é¢ï¼</li>
<li>ä»æå°æéçä¸¤ä¸ªèç¹å¼å§åå¹¶ï¼çææ°çç¶èç¹ï¼æéä¸ºå­èç¹æéä¹åï¼</li>
<li>éå¤æ­¤è¿ç¨ï¼ç´å°åªå©ä¸æ ¹èç¹ã<br>
éè¿è¿ç§æ¹å¼ï¼é«é¢è¯èªç¶é è¿æ ¹èç¹ï¼ä½é¢è¯é è¿å¶å­ï¼ä»èä¿è¯<strong>é¢ç¹è®¿é®çè¯è·¯å¾ç­</strong>ã</li>
</ul>
</li>
<li><strong>è·¯å¾ä½ä¸ºæ¦çè®¡ç®åºå</strong>ï¼
<ul>
<li>æ¯æ¡ä»æ ¹å°å¶å­çè·¯å¾å¯¹åºä¸æ¬¡æ¦çè®¡ç®çåºåï¼æ¯ä¸ªèç¹ä¸çéæ©å¯ä»¥çä½ä¸æ¬¡äºåç±»ï¼æ¯å¦æ²¿å·¦/å³åæ¯èµ°ï¼ã</li>
<li>ç®æ è¯çæ¦ç = è·¯å¾ä¸ææäºåç±»æ¦ççä¹ç§¯ã</li>
</ul>
</li>
<li><strong>éä½è®­ç»å¼é</strong>ï¼
<ul>
<li>é«é¢è¯è·¯å¾ç­ â æ´æ°æ¢¯åº¦çèç¹å° â æ¯æ¬¡è®­ç»æ ·æ¬è®¡ç®éå°ã</li>
<li>ä½é¢è¯è·¯å¾é¿ â è½ç¶èç¹å¤ï¼ä½è®­ç»ä¸­åºç°é¢çä½ï¼å¯¹æ´ä½è®­ç»å¼éå½±åå°ã</li>
<li>æ´ä½èè¨ï¼<strong>å¹³åè®¡ç®å¤æåº¦ä» <span class="math inline">\(O(|V|)\)</span> éå° <span class="math inline">\(O(\log |V|)\)</span></strong>ï¼æå¤§æåäºå¤§è¯è¡¨åºæ¯ä¸çè®­ç»æçã</li>
</ul>
</li>
</ol>
<p>åªçå°è¿éï¼å¯è½è¿æ¯æäºæ¨¡ç³ï¼æä»¬ä»¥ CBOW ä¸ºä¾ï¼æ¥ççä½¿ç¨åå± softmax çæ´ä½ç½ç»ç»æåä¼ æ­è¿ç¨ã</p>
<h2 id="13--cbow-ä¸­çåå±-softmax">1.3  CBOW ä¸­çåå± softmax</h2>
<p><img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260122222724875-338795043.png" alt="image.png" loading="lazy"><br>
è¿æ ·ï¼æç»æææ¯ï¼ä¸<strong>ä¸ªåæ¬åå«å ç¾ä¸ç±»å«çè¾åºé®é¢ï¼è¢«åè§£æäºä¸ç³»åäºåç±»é®é¢ã</strong><br>
å¨æ¯æ¬¡è®­ç»æ¶ï¼ç½ç»åªéæ´æ°ç®æ è¯è·¯å¾ä¸çç¸å³èç¹åæ°ï¼èä¸å¿è§¦åæ´ä¸ªè¾åºå±ï¼ä»èå¤§å¹èçè®¡ç®å¼éã<br>
åæ¶ï¼ç±äºåå¤«æ¼æ å¤©ç¶æç§è¯é¢ç»ç»ï¼é«é¢è¯ä½äºé è¿æ ¹èç¹çè·¯å¾ä¸ï¼ä½¿å¾è¿äºè¯çæ´æ°è·¯å¾æ´ç­ãè®¿é®æ´å¿«ãè¿ä¸ä»å éäºé«é¢è¯çå­¦ä¹ ï¼ä¹è®©æ´ä½è®­ç»è¿ç¨æ´å é«æã</p>
<p>è¿ä¾¿æ¯åå± softmax çåçï¼å¦æä»å®éåºç¨ä¸æ¥è¯´ï¼ä½ ä¹å¯ä»¥å«å®âå å  sigmoidâï¼è CBOW ä¾¿å¸¸å¸¸ååå± softmax  æ­éä½¿ç¨ã</p>
<p>ä¸é¢æä»¬ä¾¿æ¥ççå¦ä¸ç§å éç­ç¥ï¼è´éæ ·ã</p>
<h1 id="2-è´éæ ·negative-sampling">2. è´éæ ·ï¼Negative Samplingï¼</h1>
<p>å¦æè¯´åå± softmax æ¯ä¸ç§<strong>ç»æå±é¢çå é</strong>ï¼é£ä¹è´éæ ·æ´åæ¯ä¸ç§<strong>ä»ç®æ å½æ°å±é¢âæ¹é®é¢âçæ¹æ³</strong>ã<br>
å®çåºåç¹éå¸¸ç´æ¥ï¼<strong>æä»¬ççæå¿è¦å¨è®­ç»æ¶åºåâç®æ è¯âåâææéç®æ è¯âåï¼</strong><br>
ç­æ¡æ¯ï¼<strong>ä¸éè¦</strong>ã<br>
ç¸è¾äºåå± softmaxï¼è´éæ ·çææ³æ´å æ´ç´ ãå®ç°ä¹æ´å ç®åãå¨å®éå·¥ç¨ä¸­ï¼å®å ä¹å¯ä»¥çä½æ¯ <strong>Skip-gram çé»è®¤æ­æ¡£</strong>ï¼ä¹æ¯ Word2Vec æå¸¸è¢«ä½¿ç¨çè®­ç»æ¹å¼ä¹ä¸ã</p>
<p>è´éæ ·çæ ¸å¿ææ³å¯ä»¥æ¦æ¬ä¸ºä¸å¥è¯ï¼<strong>åªæéå°éè´æ ·æ¬è¿è¡è®­ç»ï¼èééåæ´ä¸ªè¯è¡¨</strong>ãæ¢å¥è¯è¯´ï¼æä»¬åªå³å¿âæ­£ç¡®è¯ + ä¸äºéæºæéçéè¯¯è¯âï¼å¶ä»çå¨ä½è¯ä¸åä¸è®¡ç®ã<br>
è¿æ ·ï¼è®¡ç®éä» <span class="math inline">\(O(|V|)\)</span> ç´æ¥éå°äº <span class="math inline">\(O(k)\)</span>ï¼å¶ä¸­ <span class="math inline">\(k\)</span> æ¯è´æ ·æ¬çæ°éï¼éå¸¸ <span class="math inline">\(5 \sim 20\)</span>ï¼ã</p>
<p>æä»¬ä»¥ Skip-gram ä¸ºä¾æ¥æ¼ç¤ºè´éæ ·çåçï¼</p>
<h2 id="21-ç¡®å®æ­£è´æ ·æ¬">2.1 ç¡®å®æ­£è´æ ·æ¬</h2>
<p>ä½¿ç¨è´éæ ·çç¬¬ä¸æ­¥æ¯ç¡®å®æ­£è´æ ·æ¬ï¼è¿ä¸è¿ç¨åæ ·å®¹æçè§£ï¼æ¥ççï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260122222401494-1883957489.png" alt="image.png" loading="lazy"><br>
å¶ä¸­ï¼</p>
<ul>
<li><strong>æ­£æ ·æ¬</strong>ï¼ç±çå®è¯­æä¸­åºç°çä¸ä¸æè¯ææï¼</li>
<li><strong>è´æ ·æ¬</strong>ï¼ä»è¯è¡¨ä¸­éæºæ½åï¼ä½å¹¶ä¸åºç°å¨å½åä¸ä¸æä¸­çè¯ã</li>
<li></li>
</ul>
<p>è¿éå±å¼ä¸ç¹ï¼å¯¹äºè´æ ·æ¬çéæ ·ï¼æä»¬å¸¸å¸¸ä½¿ç¨ä¸é¢è¿ä¸ªå¬å¼ï¼</p>
<p></p><div class="math display">\[P(w) \propto U(w)^{3/4}
\]</div><p></p><ul>
<li><span class="math inline">\(P(w)\)</span>ï¼è¡¨ç¤º<strong>å¨è´éæ ·ä¸­æ½å°è¯ <span class="math inline">\(w\)</span> çæ¦ç</strong>ã</li>
<li><span class="math inline">\(U(w)\)</span>ï¼è¡¨ç¤ºè¯ <span class="math inline">\(w\)</span> å¨æ´ä¸ªè¯­æåºä¸­ç<strong>åºç°é¢ç</strong>ã</li>
<li><span class="math inline">\(\propto\)</span>ï¼è¡¨ç¤ºâ<strong>ä¸â¦â¦ææ­£æ¯</strong>âï¼æææ¯æä»¬åæè¿ä¸ªè§åç»æ¯ä¸ªè¯ä¸ä¸ªæéï¼åå½ä¸åææ¦çã</li>
</ul>
<p>è¯­è¨æè¿°å°±æ¯ï¼åç®æ¯ä¸ªè¯çè¯é¢çååä¹ä¸æ¬¡æ¹ï¼ç¶åæå®ä»¬é¤ä»¥ææè¯çè¯é¢çååä¹ä¸æ¬¡æ¹ ä¹åï¼å°±å¾å°æç»æ½æ ·æ¦ç <span class="math inline">\(P(w)\)</span>ï¼</p>
<p></p><div class="math display">\[P(w) = \frac{U(w)^{3/4}}{\sum_{w' \in V} U(w')^{3/4}}  
\]</div><p></p><p>è¿ä¸ªå¬å¼å®éä¸åçæ¯è¿æ ·çå·¥ä½ï¼</p>
<ol>
<li>å¯¹é«é¢è¯åäº<strong>éæ</strong>ï¼æ¯åå§è¯é¢ä½ä¸äºï¼ï¼åå°å®ä»¬å¨è´æ ·æ¬ä¸­åºç°çæ¦çã</li>
<li>å¯¹ä½é¢è¯åäº<strong>ç¸å¯¹æå</strong>ï¼æ¯ç´æ¥æè¯é¢é«ä¸äºï¼ï¼è®©å®ä»¬ææºä¼è¢«éæ ·å°ã</li>
</ol>
<p>è¿ç§éæ ·ç­ç¥å¨å®è·µä¸­è¢«è¯æå¯ä»¥æé«è¯åéè®­ç»çç¨³å®æ§åè¯­ä¹è¡¨è¾¾è½åã<br>
å®æäºæ°æ®åå¤åï¼ç°å¨ï¼å°±æ¥çç Skip-gram  ä¸­çè´éæ ·ã</p>
<h2 id="22-skip-gram-ä¸­çè´éæ ·">2.2 Skip-gram ä¸­çè´éæ ·</h2>
<p>å¨ Skip-gram + è´éæ · æ¡æ¶ä¸ï¼ä¸æ¬¡è®­ç»çä¼ æ­è¿ç¨å¯ä»¥æ¦æ¬ä¸ºä¸å¾æç¤ºï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260122222708411-1201982967.png" alt="image.png" loading="lazy"></p>
<p>è¿ç§æè·¯å¶å®å¾å®¹æçè§£ï¼<strong>å¨ä¸æ¬¡ä¼ æ­ä¸­ï¼æä¸åä¸æ¬¡æ´æ°è¾åºå±çææåæ°ï¼èæ¯åªè®¡ç®ææåæéå¥½çä¸äºæ ·æ¬ï¼åªæ´æ°å®ä»¬ç¸å³çåæ°ï¼æ¥èçè®¡ç®å¼éï¼å©ä¸çç­ä¸æ¬¡éä¸­åæ´æ°ã</strong></p>
<p>æç»ï¼æ¨¡åä»æ´æ°æ­£æ ·æ¬å <span class="math inline">\(k\)</span> ä¸ªè´æ ·æ¬å¯¹åºçè¾åºå±åæ°ä»¥åè¾å¥è¯åéï¼å¶ä½è¯çåéå®å¨ä¸åä¸æ´æ°ï¼ä»èèçäºå¤§éè®¡ç®ï¼å®ç° <span class="math inline">\(O(k)\)</span> çå¤æåº¦ï¼è¿å°äº <span class="math inline">\(O(|V|)\)</span>ã<br>
è¿ç§âåªæ´æ°è¢«éä¸­åæ°âçè®­ç»æ¹å¼ï¼ä½¿å¾<strong>è´éæ ·å¨å¤§è§æ¨¡è¯­æä¸è¶å¤§è¯è¡¨åºæ¯ä¸ï¼å·å¤æé«çè®¡ç®æçã</strong></p>
<p>ä½ ä¼åç°ï¼è´éæ ·ååå± softmax çä¸ç¹å±åé»è¾å°±æ¯<strong>æä¸æ¬¡å¤åç±»ææäºå¤æ¬¡äºåç±»</strong>ï¼è¿åæ ·æ¯æä»¬å¯ä»¥å­¦ä¹ çä¼åæè·¯ã</p>
<h1 id="3æ»ç»">3.æ»ç»</h1>
<table>
<thead>
<tr>
<th>æ¦å¿µ</th>
<th>åç</th>
<th>æ¯å»</th>
</tr>
</thead>
<tbody>
<tr>
<td>softmaxå¤§è¯è¡¨ç¶é¢</td>
<td>softmax çè®¡ç®ä¸ååä¼ æ­é½å¿é¡»éåæ´ä¸ªè¯è¡¨ï¼è¯è¡¨è¶å¤§ï¼è®­ç»è¶æ¢ï¼æä¸ºä¸»è¦æ§è½ç¶é¢</td>
<td>å¨é®è·¯æ¶ï¼å¿é¡»<strong>é®å®å¨å½ææå±æ°</strong></td>
</tr>
<tr>
<td>åå± softmax</td>
<td>ç¨åå¤«æ¼æ å°å¤åç±»é®é¢ææ<strong>ä¸æ¡ä»æ ¹å°å¶çäºåç±»å³ç­è·¯å¾</strong>ï¼ç®æ è¯æ¦çç­äºè·¯å¾ä¸åäºåç±»æ¦ççä¹ç§¯</td>
<td>å¨<strong>æ¯ä¸ªè·¯å£éæ©æ¹å</strong>ï¼èä¸æ¯ä¸æ¬¡é®éææäººã</td>
</tr>
<tr>
<td>åå± softmax +CBOW</td>
<td>æ¯æ¬¡è®­ç»åªæ´æ°ç®æ è¯è·¯å¾ä¸çèç¹åæ°ï¼å¶ä½è¯å®å¨ä¸åä¸è®¡ç®</td>
<td>åªç»´ä¿®<strong>ä½ çæ­£ç»è¿çè·¯å£</strong>ï¼èä¸æ¯éä¿®æ´åº§åå¸ã</td>
</tr>
<tr>
<td>è´éæ ·ï¼Negative Samplingï¼</td>
<td>ä¸åé¼æ¨¡ååºåâç®æ è¯ vs å¨è¯è¡¨âï¼èæ¯åºåâç®æ è¯ vs å°éåªå£°è¯âï¼å¤æåº¦ä¸º <span class="math inline">\(O(k)\)</span></td>
<td>ä¸ç¨è®¤æ¸ææéçäººï¼åªè¦ç¡®è®¤<strong>æååå åè·¯äºº</strong></td>
</tr>
<tr>
<td>æ­£è´æ ·æ¬æé </td>
<td>æ­£æ ·æ¬æ¥èªçå®ä¸ä¸æï¼è´æ ·æ¬ä»è¯è¡¨éæºæ½åä½ä¸å¨ä¸ä¸æä¸­</td>
<td>çæå vs <strong>éæºææ¥çåçäºº</strong></td>
</tr>
<tr>
<td><span class="math inline">\(U(w)^{3/4}\)</span> éæ ·åå¸</td>
<td>å¯¹é«é¢è¯éæãå¯¹ä½é¢è¯ç¸å¯¹æåï¼ä½¿è´æ ·æ¬æ´æä¿¡æ¯é</td>
<td>ç­é¨ææ<strong>å°åºç°ç¹</strong>ï¼è·¯äºº<strong>å¤ç»ç¹éå¤´</strong></td>
</tr>
<tr>
<td>Skip-gram + è´éæ ·</td>
<td>æ¯æ¬¡ä»æ´æ°ä¸­å¿è¯ãæ­£æ ·æ¬è¯å <span class="math inline">\(k\)</span> ä¸ªè´æ ·æ¬çåéï¼å¶ä½åæ°ä¸å¨</td>
<td>åªè®­ç»<strong>è¢«ç¹åçå ä¸ªäºº</strong>ï¼å¶ä»äººä¸æ¬¡åè¯´</td>
</tr>
</tbody>
</table>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-22 22:28">2026-01-22 22:28</span>&nbsp;
<a href="https://www.cnblogs.com/Goblinscholar">å¥å¸æå­¦è</a>&nbsp;
éè¯»(<span id="post_view_count">6</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19519181);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19519181', targetLink: 'https://www.cnblogs.com/Goblinscholar/p/19519181', title: 'å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬äºå¨ï¼è¯åµå¥ï¼åï¼åå± softmax åè´éæ ·' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ AIå¼å-python-langchainæ¡æ¶ï¼1-4å¨æå°æ ·æ¬æç¤ºï¼ ]]></title>
    <link>https://www.cnblogs.com/yclh/p/19518845</link>
    <guid>2a4e1d8cadf02304eaf0c4618c790d81</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/yclh/p/19518845" title="åå¸äº 2026-01-22 19:31">
    <span role="heading" aria-level="2">AIå¼å-python-langchainæ¡æ¶ï¼1-4å¨æå°æ ·æ¬æç¤ºï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p class="qwen-markdown-paragraph" data-spm-anchor-id="a2ty_o01.29997173.0.i91.70db5171ppHPis"><span class="qwen-markdown-text">è¿ä¸ªä»£ç çæ ¸å¿åè½æ¯ï¼<strong class="qwen-markdown-strong"><span class="qwen-markdown-text">åºäºè¾å¥è¯çé¿åº¦å¨æéæ©åä¹è¯ç¤ºä¾ï¼å¹¶è°ç¨å¤§æ¨¡åçæåä¹è¯</span></strong><span class="qwen-markdown-text">ï¼ä½ç°äº <strong class="qwen-markdown-strong"><span class="qwen-markdown-text" data-spm-anchor-id="a2ty_o01.29997173.0.i90.70db5171ppHPis">âå¨æå°æ ·æ¬æç¤ºï¼Dynamic Few-Shot Promptingï¼â</span></strong><span class="qwen-markdown-text"> ä¸ <strong class="qwen-markdown-strong"><span class="qwen-markdown-text">âä¸ä¸æé¿åº¦æç¥çç¤ºä¾éæ©â</span></strong><span class="qwen-markdown-text"> çè½åã</span></span></span></span></p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">from langchain.prompts import FewShotPromptTemplate, PromptTemplate
from langchain.prompts.example_selector import LengthBasedExampleSelector
from langchain_core.output_parsers import StrOutputParser
from langchain_openai import ChatOpenAI
import os
from dotenv import load_dotenv


# å®ä¹åä¹è¯ä»»å¡çç¤ºä¾æ°æ®éï¼few-shot examplesï¼
# æ¯ä¸ªç¤ºä¾åå«ä¸ä¸ªè¾å¥è¯ï¼inputï¼åå¯¹åºçåä¹è¯ï¼outputï¼
examples = [
    {"input": "å¼å¿", "output": "ä¼¤å¿"},
    {"input": "é«", "output": "ç®"},
    {"input": "ç²¾ååæ²", "output": "æ²¡ç²¾æé"},
    {"input": "ç²", "output": "ç»"},
]

# å®ä¹åä¸ªç¤ºä¾çæ ¼å¼æ¨¡æ¿
# ä½¿ç¨ {input} å {output} ä½ä¸ºå ä½ç¬¦ï¼ç¨äºåç»­å¡«åå·ä½å¼
example_prompt = PromptTemplate(
    input_variables=["input", "output"],  # å£°ææ¨¡æ¿ä¸­ä½¿ç¨çåéå
    template="Input: {input}\nOutput: {output}",  # ç¤ºä¾çææ¬æ ¼å¼
)

# åå»ºä¸ä¸ªåºäºé¿åº¦çç¤ºä¾éæ©å¨ï¼LengthBasedExampleSelectorï¼
# ä½ç¨ï¼æ ¹æ®è¾å¥æç¤ºçæ»é¿åº¦å¨æéæ©æåéçç¤ºä¾æ°éï¼é¿åè¶åºæ¨¡åä¸ä¸æéå¶
example_selector = LengthBasedExampleSelector(
    examples=examples,  # æä¾ææåéç¤ºä¾
    example_prompt=example_prompt,  # ç¨äºæ ¼å¼åæ¯ä¸ªç¤ºä¾çæ¨¡æ¿
    max_length=25,  # è®¾å®æ´ä¸ª promptï¼å«åç¼ãç¤ºä¾ãåç¼ï¼çæå¤§ token é¿åº¦ï¼æ­¤å¤ä¸ºå­ç¬¦æ°è¿ä¼¼ï¼
    # æ³¨æï¼LengthBasedExampleSelector é»è®¤ä½¿ç¨ len(text) è®¡ç®é¿åº¦ï¼éç²¾ç¡® token æ°ï¼ï¼éç¨äºç®ååºæ¯
)

# æå»ºå¨æå°æ ·æ¬æç¤ºæ¨¡æ¿ï¼FewShotPromptTemplateï¼
# å®ä¼æ ¹æ®è¾å¥åå®¹çé¿åº¦ï¼èªå¨ä» examples ä¸­éæ©åéæ°éçç¤ºä¾æå¥å° prompt ä¸­
dynamic_prompt = FewShotPromptTemplate(
    example_selector=example_selector,  # ä½¿ç¨ä¸é¢å®ä¹çå¨æéæ©å¨ï¼èéåºå®ç¤ºä¾åè¡¨ï¼
    example_prompt=example_prompt,      # åä¸ªç¤ºä¾çæ ¼å¼
    prefix="ç»åºæ¯ä¸ªè¾å¥çåä¹è¯",       # æç¤ºçå¼å¤´é¨åï¼ä»»å¡æä»¤ï¼
    suffix="Input: {adjective}\nOutput:",  # æç¤ºçç»å°¾é¨åï¼åå«å¾é¢æµçè¾å¥å ä½ç¬¦
    input_variables=["adjective"],      # å£°ææç»ç¨æ·è¾å¥çåéåï¼ä¸ suffix ä¸­ç {adjective} å¯¹åºï¼
)

# === æµè¯ 1ï¼è¾å¥è¾ç­ï¼åºéæ©å¤ä¸ªç¤ºä¾ ===
print("ãæµè¯1ãè¾å¥è¾ç­ï¼éæ©å¤ä¸ªç¤ºä¾ï¼")
print(dynamic_prompt.format(adjective="big"))

print('------------')

# === æµè¯ 2ï¼è¾å¥å¾é¿ï¼åºåªéæ©å°éæä¸ä¸ªç¤ºä¾ä»¥æ§å¶æ»é¿åº¦ ===
long_string = "big and huge and massive and large and gigantic and tall and much much much much much bigger than everything else"
print("ãæµè¯2ãè¾å¥å¾é¿ï¼ä»éæ©ä¸ä¸ªç¤ºä¾ï¼")
print(dynamic_prompt.format(adjective=long_string))

print('------------')

# === æµè¯ 3ï¼å¨ææ·»å æ°ç¤ºä¾ ===
# åç¤ºä¾éæ©å¨ä¸­æ°å¢ä¸ä¸ªç¤ºä¾ï¼"è" -&gt; "ç¦"ï¼
new_example = {"input": "è", "output": "ç¦"}
dynamic_prompt.example_selector.add_example(new_example)
print("ãæµè¯3ãæ·»å æ°ç¤ºä¾åï¼æ¥è¯¢'ç­æ'ï¼")
print(dynamic_prompt.format(adjective="ç­æ"))

print('------------')

# === éç½®å¹¶è°ç¨ DeepSeek å¤§è¯­è¨æ¨¡å ===

llm = ChatOpenAI(
    api_key=os.getenv("DEEPSEEK_API_KEY"),
    base_url=os.getenv("DEEP_URL"),  # Deepseek ç API åºç¡å°å
    model="deepseek-v3:671b",  # Deepseek å¯¹è¯æ¨¡åï¼å¯éï¼deepseek-chat-pro ç­é«çº§æ¨¡åï¼
    temperature=0.7,  # æ¸©åº¦åæ°ï¼0-1ï¼è¶ä½è¶ç¨³å®ï¼
    max_tokens=1024  # æå¤§çæ tokens
)

# åå»ºå­ç¬¦ä¸²è¾åºè§£æå¨ï¼ç¨äºå°æ¨¡åè¿åç AIMessage è½¬æ¢ä¸ºçº¯ææ¬
output_parser = StrOutputParser()

# æå»ºå¤çé¾ï¼Chainï¼ï¼prompt â LLM â output parser
# ä½¿ç¨ LangChain çç®¡éæä½ç¬¦ `|` è¿æ¥åç»ä»¶
chain = dynamic_prompt | llm | output_parser

# è°ç¨é¾ï¼ä¼ å¥è¾å¥åé {"adjective": "ç­æ"}
# æ³¨æï¼chain.invoke() åé¨å·²åå« llm è°ç¨å output_parser è§£æï¼æ éåæå¨è°ç¨ output_parser
message = chain.invoke({"adjective": "ç­æ"})

# â ï¸ æ³¨æï¼ä¸ä¸è¡ `chain.invoke()` å·²ç»è¿åäºå­ç¬¦ä¸²ï¼å ä¸ºæåæ¯ StrOutputParserï¼
# æä»¥ä¸é¢è¿è¡æ¯å¤ä½çï¼çè³ä¼å¯¼è´éè¯¯ï¼å ä¸º message å·²æ¯ strï¼ä¸è½åæ¬¡ invokeï¼
# result = output_parser.invoke(message)  # â éè¯¯ï¼message æ¯ strï¼ä¸æ¯ AIMessage

# æ­£ç¡®åæ³ï¼ç´æ¥ä½¿ç¨ message ä½ä¸ºç»æ
result = message

print('###############')
print("ãæ¨¡åè¾åºã")
print(result)
</pre>
</div>
<h1 style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">è¾åºç»æï¼</h1>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">ãæµè¯1ãè¾å¥è¾ç­ï¼éæ©å¤ä¸ªç¤ºä¾ï¼
ç»åºæ¯ä¸ªè¾å¥çåä¹è¯

Input: å¼å¿
Output: ä¼¤å¿

Input: é«
Output: ç®

Input: ç²¾ååæ²
Output: æ²¡ç²¾æé

Input: ç²
Output: ç»

Input: big
Output:
------------
ãæµè¯2ãè¾å¥å¾é¿ï¼ä»éæ©ä¸ä¸ªç¤ºä¾ï¼
ç»åºæ¯ä¸ªè¾å¥çåä¹è¯

Input: å¼å¿
Output: ä¼¤å¿

Input: big and huge and massive and large and gigantic and tall and much much much much much bigger than everything else
Output:
------------
ãæµè¯3ãæ·»å æ°ç¤ºä¾åï¼æ¥è¯¢'ç­æ'ï¼
ç»åºæ¯ä¸ªè¾å¥çåä¹è¯

Input: å¼å¿
Output: ä¼¤å¿

Input: é«
Output: ç®

Input: ç²¾ååæ²
Output: æ²¡ç²¾æé

Input: ç²
Output: ç»

Input: è
Output: ç¦

Input: ç­æ
Output:
------------
###############
ãæ¨¡åè¾åºã
å·æ·¡
</pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1 style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</h1>
<h1 style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">æ ¸å¿è¦ç¹æ»ç»</h1>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">è¿æ®µä»£ç æ¯åºäº LangChain æ¡æ¶å¯¹æ¥ DeepSeek å¤§æ¨¡åï¼å®ç°ãå¨æå°æ ·æ¬ï¼Few-Shotï¼åä¹è¯çæãçå®æ´æ¡ä¾ï¼æ ¸å¿è§£å³ãåºå®ç¤ºä¾æè¶åºæ¨¡åä¸ä¸æé¿åº¦ãçé®é¢ï¼éè¿å¨æç¤ºä¾éæ©å¨ééä¸åé¿åº¦è¾å¥ï¼åæ¶ç»å LangChain é¾å¼è°ç¨ç®åæ¨¡åè°ç¨æµç¨ï¼åæç¡®æ´ä½å®ä½ï¼åæè§£æ ¸å¿éç¹ï¼</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
<h2 style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">ä¸ãæ´ä½æµç¨æ¦è§ï¼æ ¸å¿é»è¾é¾ï¼</h2>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">ä»£ç éµå¾ª LangChain ãç¤ºä¾åå¤ â å¨ææç¤ºæå»º â æ¨¡åè°ç¨ â ç»æè§£æãçå°æ ·æ¬å­¦ä¹ ç»å¸æµç¨ï¼æ´ä½å¯æ¦æ¬ä¸ºï¼</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: flex; flex: 0 1 auto; flex-direction: column; padding: 0; margin: 8px 0 0; background: none">
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none" dir="ltr">
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">
<pre><code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px Consolas, Monaco, Andale Mono, Ubuntu Mono, monospace; text-align: start; white-space: pre; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">1. å®ä¹åä¹è¯ä»»å¡çåºå®ç¤ºä¾æ°æ®éï¼ä¸ºæ¨¡åæä¾åèæ¡ä¾
2. éç½®åºäºé¿åº¦çç¤ºä¾éæ©å¨ï¼æ ¹æ®è¾å¥ææ¬é¿åº¦å¨æç­éç¤ºä¾æ°é
3. æå»ºå¨æå°æ ·æ¬æç¤ºæ¨¡æ¿ï¼èªå¨ééè¾å¥é¿åº¦çæåè§ Prompt
4. åå§å DeepSeek æ¨¡åå®¢æ·ç«¯ï¼éç½®æ ¸å¿è°ç¨åæ°
5. æå»ºãæç¤ºæ¨¡æ¿ â å¤§æ¨¡å â è¾åºè§£æãçé¾å¼è°ç¨æµç¨
6. è°ç¨é¾æ¡å®æåä¹è¯çæï¼å¹¶è¾åºçº¯ææ¬ç»æ
</code></pre>
</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
</div>
</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
<h2 style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">äºãæ ¸å¿éç¹æè§£ï¼å¿ææ¡ï¼</h2>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
<h3 style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">1. å°æ ·æ¬æç¤ºï¼Few-Shot Promptï¼æ ¸å¿ç»ä»¶</h3>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">è¿æ¯å®ç°ãæ¨¡ååèç¤ºä¾çæç»æãçåºç¡ï¼ä¹æ¯ LangChain æç¤ºå·¥ç¨çæ ¸å¿ç¨æ³ï¼</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp; &nbsp;<code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px Consolas, Monaco, Andale Mono, Ubuntu Mono, monospace; text-align: start; white-space: pre; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">- ç¤ºä¾æ°æ®éï¼examplesï¼ï¼ä»¥é®å¼å¯¹å½¢å¼å­å¨ãè¾å¥-è¾åºãç¤ºä¾ï¼ä¸ºæ¨¡åæä¾ä»»å¡åèï¼å¦"å¼å¿"â"ä¼¤å¿"ï¼ï¼</code></div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none"><code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px Consolas, Monaco, Andale Mono, Ubuntu Mono, monospace; text-align: start; white-space: pre; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none"> - åç¤ºä¾æ¨¡æ¿ï¼example_promptï¼ï¼å®ä¹åä¸ªç¤ºä¾çææ¬æ ¼å¼ï¼Input/Output åºå®æ ·å¼ï¼ï¼ç»ä¸ç¤ºä¾å±ç¤ºå½¢å¼ï¼</code></div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: flex; flex: 0 1 auto; flex-direction: column; padding: 0; margin: 8px 0 0; background: none">
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none" dir="ltr">
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">
<pre><code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px Consolas, Monaco, Andale Mono, Ubuntu Mono, monospace; text-align: start; white-space: pre; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">- å¨æå°æ ·æ¬æ¨¡æ¿ï¼FewShotPromptTemplateï¼ï¼æ´åç¤ºä¾éæ©å¨ãåç¤ºä¾æ¨¡æ¿ãåç¼/åç¼ï¼çææç»åç»æ¨¡åçå®æ´ Promptï¼
  - prefixï¼ä»»å¡æä»¤ï¼"ç»åºæ¯ä¸ªè¾å¥çåä¹è¯"ï¼ï¼æç¡®æ¨¡åè¦æ§è¡çä»»å¡ï¼
  - suffixï¼å¾å¡«åçç¨æ·è¾å¥å ä½ç¬¦ï¼æ¿æ¥å¨æè¾å¥åå®¹ã
</code></pre>
</div>
</div>
</div>
<h3 style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">2. å¨æç¤ºä¾éæ©å¨ï¼LengthBasedExampleSelectorï¼</h3>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">è¿æ¯ä»£ç çæ ¸å¿äº®ç¹ï¼è§£å³ãåºå®ç¤ºä¾æ°éæè¶ä¸ä¸æé¿åº¦ãçé®é¢ï¼</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: flex; flex: 0 1 auto; flex-direction: column; padding: 0; margin: 8px 0 0; background: none">
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none" dir="ltr">
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">
<pre><code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px Consolas, Monaco, Andale Mono, Ubuntu Mono, monospace; text-align: start; white-space: pre; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">æ ¸å¿ä½ç¨ï¼æ ¹æ®è¾å¥ææ¬çé¿åº¦ï¼èªå¨è®¡ç®å¹¶éæ©åéæ°éçç¤ºä¾ï¼è¾å¥è¶é¿ï¼éçç¤ºä¾è¶å°ï¼ï¼é¿å Prompt æ»é¿åº¦è¶åºæ¨¡åä¸ä¸æéå¶ï¼
å³é®åæ°ï¼
  - examplesï¼åéç¤ºä¾åè¡¨ï¼
  - example_promptï¼ç¤ºä¾æ ¼å¼åæ¨¡æ¿ï¼ç¨äºè®¡ç®åç¤ºä¾é¿åº¦ï¼ï¼
  - max_lengthï¼Prompt åè®¸çæå¤§é¿åº¦ï¼æ­¤å¤ä¸ºå­ç¬¦æ°è¿ä¼¼å¼ï¼ã
</code></pre>
</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
</div>
</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
<h3 style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">3. LangChain é¾å¼è°ç¨ï¼| æä½ç¬¦ï¼</h3>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">ç®åå¤ç»ä»¶åä½æµç¨ï¼æ¯ LangChain æ ¸å¿è®¾è®¡çå¿µï¼</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: flex; flex: 0 1 auto; flex-direction: column; padding: 0; margin: 8px 0 0; background: none">
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none" dir="ltr">
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">
<pre><code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px Consolas, Monaco, Andale Mono, Ubuntu Mono, monospace; text-align: start; white-space: pre; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">- é¾æ¡ææï¼dynamic_promptï¼çæ Promptï¼ | llmï¼è°ç¨æ¨¡åï¼ | output_parserï¼è§£æç»æï¼ï¼
- æ ¸å¿ä¼å¿ï¼æ éæå¨åæ­¥è°ç¨ï¼åæ ¼å¼å Promptãåè°ç¨æ¨¡åãæåè§£æç»æï¼ï¼ä¸è¡ä»£ç å®æå¨æµç¨ï¼
- è°ç¨æ¹å¼ï¼chain.invoke({"adjective": "ç­æ"}) ä¼ å¥è¾å¥åéï¼ç´æ¥è¿åè§£æåççº¯ææ¬ç»æã
</code></pre>
</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
</div>
</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
<h3 style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">4. è¾åºè§£æå¨ï¼StrOutputParserï¼</h3>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">&nbsp;</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">è§£å³ãæ¨¡åè¿å AIMessage å¯¹è±¡âæåçº¯ææ¬ãçé®é¢ï¼</div>
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: flex; flex: 0 1 auto; flex-direction: column; padding: 0; margin: 8px 0 0; background: none">
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none" dir="ltr">
<div style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; text-align: start; white-space: normal; display: block; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">
<pre><code style="color: rgba(0, 0, 0, 1); font: 400 16px / 24px Consolas, Monaco, Andale Mono, Ubuntu Mono, monospace; text-align: start; white-space: pre; display: inline; flex: 0 1 auto; flex-direction: row; padding: 0; margin: 0; background: none">æ ¸å¿ä½ç¨ï¼å° LangChain æ¨¡åè¿åç AIMessage ç±»åï¼å« content/metadata ç­å­æ®µï¼è½¬æ¢ä¸ºçº¯å­ç¬¦ä¸²ï¼ç®åç»æä½¿ç¨ï¼
å³é®æ³¨æç¹ï¼é¾å¼è°ç¨ä¸­å·²åå«è§£ææ­¥éª¤ï¼æ éæå¨åæ¬¡è°ç¨ output_parser.invoke()ï¼å¦åä¼æ¥éï¼ã</code></pre>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.0006944444444444445" data-date-updated="2026-01-22 19:32">2026-01-22 19:31</span>&nbsp;
<a href="https://www.cnblogs.com/yclh">ä¸ç¬ä½</a>&nbsp;
éè¯»(<span id="post_view_count">25</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19518845);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19518845', targetLink: 'https://www.cnblogs.com/yclh/p/19518845', title: 'AIå¼å-python-langchainæ¡æ¶ï¼1-4å¨æå°æ ·æ¬æç¤ºï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ç©è½¬ ZooKeeper ]]></title>
    <link>https://www.cnblogs.com/Marktowin/p/19518265</link>
    <guid>f299e6a6760750710f6ce57bdde1dc1a</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Marktowin/p/19518265" title="åå¸äº 2026-01-22 17:22">
    <span role="heading" aria-level="2">ç©è½¬ ZooKeeper</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p dir="auto">Apache ZooKeeper æ¯ä¸ä¸ªå¼æºçåå¸å¼åè°æå¡ï¼ç¨äºåå¸å¼ç³»ç»ä¸­ç»´æ¤éç½®ä¿¡æ¯ãå½åãæä¾åå¸å¼åæ­¥åç»æå¡ãä¸é¢æ ¹æ®æ¨çè¦æ±ï¼è¯¦ç»è¯´æ ZooKeeper çäº§çåå ãæåä½¿ç¨ãææ°çä½¿ç¨ãä¸åçæ¬çæ´æ°ç¹ãå®ç°åçãé¨ç½²åä½¿ç¨ãåå®¹åºäºå®æ¹ææ¡£åå¯é æ¥æºæ´çï¼å¹¶åå« Java ä»£ç çæ®µç¤ºä¾ï¼ZooKeeper ä¸»è¦ä½¿ç¨ Java APIï¼ã</p>
<p dir="auto">&nbsp;</p>
<h3 dir="auto">1. äº§çåå </h3>
<p dir="auto">ZooKeeper çäº§çæ¯ä¸ºäºè§£å³åå¸å¼ç³»ç»ä¸­åè°çå¤æé®é¢ãå¨å¤§è§æ¨¡åå¸å¼ç³»ç»ä¸­ï¼å¤ä¸ªèç¹éè¦åè°éç½®ãç¶æåæ­¥ãé¢å¯¼èéä¸¾ç­ä»»å¡ï¼ä½èªè¡å®ç°è¿äºåè½å®¹æå¼å¥éè¯¯ï¼å¦ç«äºæ¡ä»¶ï¼race conditionsï¼åæ­»éï¼deadlockï¼ãZooKeeper å Google ç Chubby lock service å¯åï¼ç± Yahoo! Research å¢éå¼åï¼ç¨äºç®åè¿äºåè°ä»»å¡ãå®æä¾äºä¸ä¸ªå¯é çãé«æ§è½çåè°åæ ¸ï¼è®©åºç¨ç¨åºå¼åèä¸æ³¨äºä¸å¡é»è¾ï¼èééæ°åæåå¸å¼åè°æºå¶ãæåæ¯ä¸ºäºç®¡ç Yahoo! çå¤§æ°æ®éç¾¤èåå»ºï¼å°ç¶æå­å¨å¨æ¬å°æ¥å¿æä»¶ä¸­ï¼ç¡®ä¿é«å¯ç¨æ§åä¸è´æ§ã</p>
<p dir="auto">&nbsp;</p>
<h3 dir="auto">2. æ©æä½¿ç¨</h3>
<p dir="auto">ZooKeeper æåå¨ Yahoo! åé¨ç¨äºå·¥ä¸çº§åºç¨ï¼åæ¬ï¼</p>
<ul dir="auto">
<li><strong>Yahoo! Message Broker</strong>ï¼åè°åæéæ¢å¤æå¡ï¼ç¨äºç®¡çæ°åä¸ªä¸»é¢çå¯æ©å±åå¸-è®¢éç³»ç»ã</li>
<li><strong>Yahoo! Crawler ç Fetching Service</strong>ï¼ç¨äºæéæ¢å¤ï¼ç¡®ä¿ç¬è«ä»»å¡çå¯é æ§è¡ã</li>
<li><strong>Yahoo! å¹¿åç³»ç»</strong>ï¼æä¾å¯é çæå¡åè°ï¼å¦å½åæå¡ãéç½®ç®¡çåæ°æ®åæ­¥ã å¸åæ©æç¨ä¾åæ¬å½åæå¡ï¼ç±»ä¼¼ DNSï¼ãéç½®ç®¡çï¼éä¸­å­å¨éç½®ï¼ãæ°æ®åæ­¥ï¼éæºå¶ï¼ãé¢å¯¼èéä¸¾ï¼éä¸»ï¼åæ¶æ¯éåãZooKeeper è¢«è®¾è®¡ä¸ºè¯»ä¸»å¯¼åï¼è¯»åæ¯çº¦ 10:1ï¼ï¼éç¨äºè¿è¡å¨æ°åå°æºå¨ä¸çåå¸å¼ç¯å¢ã</li>
</ul>
<p>&nbsp;</p>
<h3 dir="auto">3. å½åä½¿ç¨</h3>
<p dir="auto">å¦ä»ï¼ZooKeeper å¹¿æ³ç¨äºå¤§æ°æ®ååå¸å¼ç³»ç»ä¸­ï¼ä½ä¸ºåè°åæ ¸ãå¸¸è§ç¨ä¾åæ¬ï¼</p>
<ul dir="auto">
<li><strong>éç½®ç®¡ç</strong>ï¼éä¸­å­å¨åæ´æ°åå¸å¼åºç¨çéç½®ï¼å¦ Apache Kafka ç¨äºå­å¨æ¶è´¹èåç§»éï¼ç´å° 4.0 çæ¬ï¼ã</li>
<li><strong>é¢å¯¼èéä¸¾</strong>ï¼å¨éç¾¤ä¸­éä¸¾ä¸»èç¹ï¼å¦ Apache HBase ç¨äºåºååéåä¸»æéè½¬ç§»ï¼ã</li>
<li><strong>åå¸å¼é</strong>ï¼å®ç°äºæ¥è®¿é®ï¼å¦ Apache Accumulo ç¨äºæ åç¹æéæ¶æï¼ã</li>
<li><strong>ç»æåç®¡ç</strong>ï¼è·è¸ªèç¹å å¥/ç¦»å¼ï¼å¦ Apache Druid ç¨äºéç¾¤ç¶æç®¡çï¼ã</li>
<li><strong>å¶ä»</strong>ï¼ç¨äº Apache HadoopãHDFSãSolrãKafkaï¼æ©æçæ¬ï¼ãPulsar ç­ãææ°è¶å¿åæ¬åå°å¯¹ ZooKeeper çä¾èµï¼å¦ Pulsar éè¿ PIP-45 å¼å¥å¯ææåæ°æ®æ¡æ¶ï¼åè®¸æ  ZooKeeper è¿è¡ï¼ï¼ä½å¨ä¼ ç»ç³»ç»ä¸­ä»ä¸å¯æç¼ºãç°ä»£åºç¨å¼ºè°å¶å¨äºç¯å¢ä¸­çé«å¯ç¨æ§ï¼å¦å¨ Kubernetes ä¸­åè°å¾®æå¡ã</li>
</ul>
<p>&nbsp;</p>
<h3 dir="auto">4. ä¸åçæ¬</h3>
<p dir="auto">ZooKeeper ççæ¬æ¼è¿èç¦äºæ§è½ãå®å¨ãå¼å®¹æ§åæ°åè½ãä»¥ä¸è¡¨æ ¼æ»ç»ä» 3.4.x å¼å§çä¸»è¦çæ¬æ´æ°ï¼åºäºå®æ¹åå¸ç¬è®°ï¼å½åç¨³å®ç 3.8.xï¼å½åç 3.9.xï¼ãEoLï¼End-of-Lifeï¼çæ¬ä¸åæ¥æ¶ç¤¾åºæ¯æã</p>
<table>
<thead>
<tr><th data-col-size="sm">çæ¬ç³»å</th><th data-col-size="md">é¦æ¬¡åå¸æ¥æ</th><th data-col-size="md">EoL æ¥æ</th><th data-col-size="xl">ä¸»è¦æ´æ°ç¹</th></tr>
</thead>
<tbody>
<tr>
<td data-col-size="sm"><strong>3.4.x</strong></td>
<td data-col-size="md">2011 å¹´</td>
<td data-col-size="md">2016 å¹´</td>
<td data-col-size="xl">åºç¡ç¨³å®çï¼æ¯æåºæ¬ APIãå¤å¶æ¨¡å¼ï¼æ§è½ä¼åï¼ç¨äº Hadoop å­é¡¹ç®ã</td>
</tr>
<tr>
<td data-col-size="sm"><strong>3.5.x</strong></td>
<td data-col-size="md">2019 å¹´ 5 æ (3.5.5 ä½ä¸ºç¨³å®ç)</td>
<td data-col-size="md">2022 å¹´ 6 æ</td>
<td data-col-size="xl">æ·»å å¨æééç½®ãæ¬å°ä¼è¯ãå®¹å¨/TTL èç¹ãSSL æ¯æåå­å¹¿æ­åè®®ãå¯ç§»é¤çè§å¨ãå¤çº¿ç¨æäº¤å¤çå¨ãåçº§ Netty 4.1ãMaven æå»ºï¼æå° JDK 1.8ï¼ä¿®å¤ CVE åå¼å®¹æ§é®é¢ã</td>
</tr>
<tr>
<td data-col-size="sm"><strong>3.6.x</strong></td>
<td data-col-size="md">2020 å¹´ 3 æ</td>
<td data-col-size="md">2022 å¹´ 12 æ</td>
<td data-col-size="xl">æ§è½åå®å¨æ¹è¿ï¼æ° APIï¼å¦æ°¸ä¹éå½çè§ï¼ï¼ç§»é¤ Log4j1ï¼ä½¿ç¨ reload4jï¼ä¿®å¤ CVEãå¿«ç§å SASL é®é¢ï¼å®¢æ·ç«¯å¼å®¹ 3.5.x æå¡å¨ã</td>
</tr>
<tr>
<td data-col-size="sm"><strong>3.7.x</strong></td>
<td data-col-size="md">2021 å¹´ 3 æ</td>
<td data-col-size="md">2024 å¹´ 2 æ</td>
<td data-col-size="xl">æ° APIï¼å¦å¯å¨æå¡å¨ãwhoamiï¼ï¼éé¢å¼ºå¶ï¼ä¸»æºåè§èåï¼BCKFS å¯é¥/ä¿¡ä»»å­å¨ï¼å¿éè®¤è¯æ¹æ¡ï¼å¤ SASL superUsersï¼å¿«éè·è¸ªèæµè¯·æ±ï¼å®å¨ææ ï¼C/Perl SASL æ¯æï¼zkSnapshotComparer å·¥å·ï¼YCSB åºåæµè¯è¯´æï¼ä¿®å¤ 64+ ä¸ªé®é¢ï¼åæ¬ CVEã</td>
</tr>
<tr>
<td data-col-size="sm"><strong>3.8.x</strong> (å½åç¨³å®)</td>
<td data-col-size="md">2022 å¹´ 3 æ</td>
<td data-col-size="md">-</td>
<td data-col-size="xl">æ¥å¿æ¡æ¶è¿ç§»å° LogBackï¼ä»æä»¶è¯»åå¯é¥/ä¿¡ä»»å­å¨å¯ç ï¼æ¢å¤ OSGI æ¯æï¼åå° Prometheus ææ æ§è½å½±åï¼JDK17 æ¯æï¼ç¬¬ä¸æ¹ä¾èµæ´æ°ä¿®å¤ææ CVEï¼ä¿®å¤åæ­¥ãC å®¢æ·ç«¯æµè¯ç­é®é¢ã</td>
</tr>
<tr>
<td data-col-size="sm"><strong>3.9.x</strong> (å½å)</td>
<td data-col-size="md">2023 å¹´ 8 æ</td>
<td data-col-size="md">-</td>
<td data-col-size="xl">ç®¡çåæå¡å¨ APIï¼å¿«ç§åæ°æ®æµåºï¼ï¼éä¿¡ Zxid è§¦å WatchEventï¼TLS å¨æå è½½å®¢æ·ç«¯ä¿¡ä»»/å¯é¥å­å¨ï¼Netty-TcNative OpenSSL æ¯æï¼SSL æ¯æ Zktreeutilï¼æ¹è¿ syncRequestProcessor æ§è½ï¼ç¬¬ä¸æ¹ä¾èµæ´æ°ä¿®å¤ CVEã</td>
</tr>
</tbody>
</table>
<p dir="auto">å¼å®¹æ§ï¼3.5.x+ å®¢æ·ç«¯å¼å®¹ 3.9.x æå¡å¨ï¼3.9.x å®¢æ·ç«¯å¼å®¹ 3.5-3.8.x æå¡å¨ï¼ä¸ä½¿ç¨æ° APIï¼ã</p>
<p dir="auto">&nbsp;</p>
<h3 dir="auto">5. å®ç°åç</h3>
<p dir="auto">ZooKeeper çæ ¸å¿æ¯æä¾ä¸ä¸ªç®åãé«å¯é çåå¸å¼åè°æå¡ãå¶æ¶æåºäºå®¢æ·ç«¯-æå¡å¨æ¨¡åï¼ä½¿ç¨ ZABï¼ZooKeeper Atomic Broadcastï¼åè®®ï¼ç±»ä¼¼äº Paxosï¼å®ç°ä¸è´æ§ã</p>
<ul dir="auto">
<li><strong>æ¶æç»ä»¶</strong>ï¼
<ul dir="auto">
<li><strong>Ensembleï¼éç¾¤ï¼</strong>ï¼ç±å¥æ°ä¸ªæå¡å¨ç»æï¼æå° 3 ä¸ªï¼ï¼ç¡®ä¿å¤æ°æ´¾ï¼quorumï¼å¯ç¨ãåæ¬ Leaderï¼é¢å¯¼èï¼å¤çåæä½ï¼ãFollowerï¼è¿½éèï¼å¤çè¯»æä½å¹¶è½¬ååå° Leaderï¼å Observerï¼è§å¯èï¼åªå¤çè¯»ï¼ä¸åä¸éä¸¾/æç¥¨ï¼æé«è¯»æ§è½ï¼ã</li>
<li><strong>æ°æ®æ¨¡å</strong>ï¼åå±å½åç©ºé´ï¼åæä»¶ç³»ç»ï¼znodesï¼èç¹ï¼å¯å­å¨æ°æ®åå­èç¹ï¼ãæ¯ææä¹èç¹ï¼persistentï¼åä¸´æ¶èç¹ï¼ephemeralï¼ä¼è¯ç»æå é¤ï¼ãæ°æ®å¨åå­ä¸­å­å¨ï¼é«æ§è½ï¼ï¼å¹¶æä¹åå°æ¥å¿åå¿«ç§ã</li>
<li><strong>ä¸è´æ§ä¿è¯</strong>ï¼é¡ºåºä¸è´æ§ï¼æ´æ°æåéé¡ºåºåºç¨ï¼ãåå­æ§ï¼æ´æ°å¨æåæå¨å¤±è´¥ï¼ãåä¸ç³»ç»æ åï¼å®¢æ·ç«¯æ è®ºè¿æ¥åªä¸ªæå¡å¨ï¼çå°ç¸åè§å¾ï¼ãå¯é æ§ï¼æ´æ°æä¹åï¼ãåæ¶æ§ï¼è§å¾å¨çéåæ´æ°ï¼ã</li>
<li><strong>å·¥ä½æµç¨</strong>ï¼å®¢æ·ç«¯è¿æ¥ä»»ææå¡å¨ãåè¯·æ±è½¬åå° Leaderï¼éè¿ ZAB å¹¿æ­å° Followerï¼éå¤æ°åæï¼ãè¯»è¯·æ±æ¬å°å¤çãä½¿ç¨çè§ï¼watchesï¼éç¥ååï¼ä¸æ¬¡æ§è§¦åï¼æ°çæ¯ææ°¸ä¹éå½çè§ï¼ãä¼è¯ï¼sessionsï¼éè¿å¿è·³ç»´æ¤ï¼æ­è¿èªå¨éè¿ã</li>
<li><strong>é¢å¯¼èéä¸¾</strong>ï¼ä½¿ç¨å¿«é Paxos åä½ï¼å´©æºæ¶å¿«ééä¸¾æ° Leaderï¼&lt;200msï¼ã</li>
<li><strong>æ§è½åç</strong>ï¼åå­éå + äºå¡æ¥å¿ï¼è¯»ä¸»å¯¼ä¼åï¼åå­æ¶æ¯åè®®é²æ­¢å¯æ¬åæ­§ã</li>
</ul>
</li>
</ul>
<p dir="auto">ZooKeeper éç¨äºè¯»å¤åå°åºæ¯ï¼æä¾ç®å APIï¼å¦ createãdeleteãgetãsetï¼ã</p>
<p dir="auto">&nbsp;</p>
<h3 dir="auto">6. æ¡ä¾ï¼éä¸¾leaderæ§è¡ä»»å¡ï¼</h3>
<p dir="auto">å¨åå¸å¼ç³»ç»ä¸­ï¼ZooKeeperï¼ZKï¼å¸¸ç¨äºåè°éç¾¤ä¸­çèç¹ï¼ç¡®ä¿é«å¯ç¨æ§åä¸è´æ§ãä¸é¢æç»åºä¸ä¸ªè¯¦ç»çä¾å­ï¼ä¸ä¸ªç®åç <strong>åå¸å¼ä»»å¡è°åº¦æå¡</strong>ï¼é¨ç½²å¨éç¾¤ä¸­ï¼ä½¿ç¨ ZooKeeper å®ç° <strong>é¢å¯¼èéä¸¾ï¼Leader Electionï¼</strong>ãè¿ä¸ªæå¡æ¨¡æä¸ä¸ªå®æ¶ä»»å¡ï¼å¦æ°æ®å¤ä»½ï¼ï¼ä½åªæä¸ä¸ªèç¹ï¼Leaderï¼æ§è¡ä»»å¡ï¼å¶ä»èç¹ï¼Followerï¼å¾å½ãå¦æ Leader å®æºï¼Follower ä¼èªå¨éä¸¾æ° Leaderã</p>
<p dir="auto"><strong>ä¸ä¸ª 3 èç¹éç¾¤çåå¸å¼ä»»å¡è°åº¦æå¡</strong></p>
<ul dir="auto">
<li>3 å°æå¡å¨ï¼ç©çæºæèææºï¼ï¼node1ãnode2ãnode3</li>
<li>æ¯ä¸ªèç¹è¿è¡ä¸ä¸ªç¸åç Java JAR å</li>
<li>ä½¿ç¨ ZooKeeper å®ç°<strong>é¢å¯¼èéä¸¾</strong>ï¼åªæä¸ä¸ªèç¹æä¸º Leader æ§è¡å®æ¶ä»»å¡ï¼å¶ä»èç¹ä½ä¸º Follower å¾å½</li>
<li>Leader å®æºåï¼èªå¨å¿«ééä¸¾æ° Leader</li>
</ul>
<p dir="auto"><strong>ç¯å¢åå¤ï¼3 å°æå¡å¨ï¼</strong></p>
<table>
<thead>
<tr><th data-col-size="md">ä¸»æºå</th><th data-col-size="md">IP</th><th data-col-size="xl">è§è²</th><th data-col-size="lg">è¯´æ</th></tr>
</thead>
<tbody>
<tr>
<td data-col-size="md">node1</td>
<td data-col-size="md">192.168.1.101</td>
<td data-col-size="xl">ZooKeeper + Java æå¡</td>
<td data-col-size="lg">ZooKeeper myid=1</td>
</tr>
<tr>
<td data-col-size="md">node2</td>
<td data-col-size="md">192.168.1.102</td>
<td data-col-size="xl">ZooKeeper + Java æå¡</td>
<td data-col-size="lg">ZooKeeper myid=2</td>
</tr>
<tr>
<td data-col-size="md">node3</td>
<td data-col-size="md">192.168.1.103</td>
<td data-col-size="xl">ZooKeeper + Java æå¡</td>
<td data-col-size="lg">ZooKeeper myid=3</td>
</tr>
</tbody>
</table>
<p dir="auto"><strong>ææèç¹å®è£ Java</strong></p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 0, 1)">sudo apt update
sudo apt install openjdk</span>-11-jdk  # Ubuntu/<span style="color: rgba(0, 0, 0, 1)">Debian# æ CentOS
sudo yum install java</span>-11-openjdk-devel</pre>
</div>
<p dir="auto"><strong>ææèç¹å®è£ ZooKeeper éç¾¤</strong></p>
<div class="cnblogs_code">
<pre>wget https:<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">downloads.apache.org/zookeeper/zookeeper-3.8.4/apache-zookeeper-3.8.4-bin.tar.gz</span>
tar -zxvf apache-zookeeper-3.8.4-<span style="color: rgba(0, 0, 0, 1)">bin.tar.gz
sudo mv apache</span>-zookeeper-3.8.4-bin /opt/<span style="color: rgba(0, 0, 0, 1)">zookeeper
cd </span>/opt/zookeeper</pre>
</div>
<p dir="auto"><strong>éç½® conf/zoo.cfgï¼ææèç¹é½ç¸åï¼</strong></p>
<div class="cnblogs_code">
<pre>cp conf/zoo_sample.cfg conf/<span style="color: rgba(0, 0, 0, 1)">zoo.cfg
vi conf</span>/zoo.cfg</pre>
</div>
<p><strong>åå®¹å¦ä¸</strong></p>
<div class="cnblogs_code">
<pre>tickTime=2000<span style="color: rgba(0, 0, 0, 1)">
initLimit</span>=10<span style="color: rgba(0, 0, 0, 1)">
syncLimit</span>=5<span style="color: rgba(0, 0, 0, 1)">
dataDir</span>=/var/lib/<span style="color: rgba(0, 0, 0, 1)">zookeeper
clientPort</span>=2181<span style="color: rgba(0, 0, 0, 1)">
# éç¾¤æå¡å¨åè¡¨
server.</span>1=192.168.1.101:2888:3888<span style="color: rgba(0, 0, 0, 1)">
server.</span>2=192.168.1.102:2888:3888<span style="color: rgba(0, 0, 0, 1)">
server.</span>3=192.168.1.103:2888:3888</pre>
</div>
<p dir="auto"><strong>åå»ºæ°æ®ç®å½å¹¶è®¾ç½® myidï¼æ¯ä¸ªèç¹ä¸åï¼ï¼</strong></p>
<div class="cnblogs_code">
<pre>sudo mkdir -p /var/lib/<span style="color: rgba(0, 0, 0, 1)">zookeeper
sudo chown </span>-R $USER:$USER /var/lib/zookeeper</pre>
</div>
<p>ããnode1:</p>
<div class="cnblogs_code">
<pre>echo "1" &gt; /var/lib/zookeeper/myid</pre>
</div>
<p>ããnode2:</p>
<div class="cnblogs_code">
<pre>echo "2" &gt; /var/lib/zookeeper/myid</pre>
</div>
<p>ããnode3:</p>
<div class="cnblogs_code">
<pre>echo "3" &gt; /var/lib/zookeeper/myid</pre>
</div>
<p dir="auto"><strong>å¯å¨ ZooKeeperï¼ææèç¹ï¼ï¼</strong></p>
<div class="cnblogs_code">
<pre>/opt/zookeeper/bin/zkServer.sh start</pre>
</div>
<p dir="auto"><strong>éªè¯éç¾¤ç¶æï¼</strong></p>
<div class="cnblogs_code">
<pre>/opt/zookeeper/bin/zkServer.sh status</pre>
</div>
<p dir="auto">åºè¯¥çå°ä¸ä¸ª Leader åä¸¤ä¸ª Followerã</p>
<p dir="auto">&nbsp;<strong>JAVAä»£ç </strong></p>
<p dir="auto">LeaderElection.javaï¼é¢å¯¼èéä¸¾æ ¸å¿ï¼ï¼å¤çè¿æ¥ ZooKeeperãåå»ºèç¹ãçè§åååéä¸¾é»è¾ã</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">package</span><span style="color: rgba(0, 0, 0, 1)"> com.example;

</span><span style="color: rgba(0, 0, 255, 1)">import</span> org.apache.zookeeper.*<span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> org.apache.zookeeper.data.Stat;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> org.slf4j.Logger;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> org.slf4j.LoggerFactory;

</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> java.io.IOException;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> java.util.Collections;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> java.util.List;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> java.util.concurrent.CountDownLatch;

</span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">class</span> LeaderElection <span style="color: rgba(0, 0, 255, 1)">implements</span><span style="color: rgba(0, 0, 0, 1)"> Watcher {
    </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">final</span> Logger logger = LoggerFactory.getLogger(LeaderElection.<span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)">);

    </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> ZooKeeper zk;
    </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> String zkConnectString;
    </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> sessionTimeout;
    </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> String electionPath;
    </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> String nodeId;
    </span><span style="color: rgba(0, 0, 255, 1)">private</span> String currentZnodePath;  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å½åèç¹çè·¯å¾ï¼å¦ /election/node-0000000001</span>
    <span style="color: rgba(0, 0, 255, 1)">private</span> CountDownLatch connectedLatch = <span style="color: rgba(0, 0, 255, 1)">new</span> CountDownLatch(1<span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">private</span> TaskService taskService;  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ä»»å¡æå¡å¼ç¨</span>

    <span style="color: rgba(0, 0, 255, 1)">public</span> LeaderElection(String zkConnectString, <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> sessionTimeout, String electionPath, String nodeId, TaskService taskService) {
        </span><span style="color: rgba(0, 0, 255, 1)">this</span>.zkConnectString =<span style="color: rgba(0, 0, 0, 1)"> zkConnectString;
        </span><span style="color: rgba(0, 0, 255, 1)">this</span>.sessionTimeout =<span style="color: rgba(0, 0, 0, 1)"> sessionTimeout;
        </span><span style="color: rgba(0, 0, 255, 1)">this</span>.electionPath =<span style="color: rgba(0, 0, 0, 1)"> electionPath;
        </span><span style="color: rgba(0, 0, 255, 1)">this</span>.nodeId =<span style="color: rgba(0, 0, 0, 1)"> nodeId;
        </span><span style="color: rgba(0, 0, 255, 1)">this</span>.taskService =<span style="color: rgba(0, 0, 0, 1)"> taskService;
    }

    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">void</span> connect() <span style="color: rgba(0, 0, 255, 1)">throws</span><span style="color: rgba(0, 0, 0, 1)"> IOException, InterruptedException {
        zk </span>= <span style="color: rgba(0, 0, 255, 1)">new</span> ZooKeeper(zkConnectString, sessionTimeout, <span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">);
        connectedLatch.await();  </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ç­å¾è¿æ¥æå</span>
<span style="color: rgba(0, 0, 0, 1)">    }

    @Override
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> process(WatchedEvent event) {
        </span><span style="color: rgba(0, 0, 255, 1)">if</span> (event.getState() ==<span style="color: rgba(0, 0, 0, 1)"> Event.KeeperState.SyncConnected) {
            connectedLatch.countDown();
        } </span><span style="color: rgba(0, 0, 255, 1)">else</span> <span style="color: rgba(0, 0, 255, 1)">if</span> (event.getType() ==<span style="color: rgba(0, 0, 0, 1)"> Event.EventType.NodeDeleted) {
            </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> åä¸ä¸ªèç¹å é¤ï¼éæ°æ£æ¥æ¯å¦æä¸º Leader</span>
            <span style="color: rgba(0, 0, 255, 1)">try</span><span style="color: rgba(0, 0, 0, 1)"> {
                checkIfLeader();
            } </span><span style="color: rgba(0, 0, 255, 1)">catch</span> (KeeperException |<span style="color: rgba(0, 0, 0, 1)"> InterruptedException e) {
                logger.error(</span>"Error checking leader"<span style="color: rgba(0, 0, 0, 1)">, e);
            }
        }
    }

    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">void</span> participateInElection() <span style="color: rgba(0, 0, 255, 1)">throws</span><span style="color: rgba(0, 0, 0, 1)"> KeeperException, InterruptedException {
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ç¡®ä¿éä¸¾è·¯å¾å­å¨ï¼æä¹èç¹ï¼</span>
        Stat stat = zk.exists(electionPath, <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">if</span> (stat == <span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">) {
            zk.create(electionPath, </span><span style="color: rgba(0, 0, 255, 1)">new</span> <span style="color: rgba(0, 0, 255, 1)">byte</span>[0<span style="color: rgba(0, 0, 0, 1)">], ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT);
        }

        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> åå»ºä¸´æ¶é¡ºåºèç¹</span>
        currentZnodePath = zk.create(electionPath + "/" + nodeId + "-", <span style="color: rgba(0, 0, 255, 1)">new</span> <span style="color: rgba(0, 0, 255, 1)">byte</span>[0<span style="color: rgba(0, 0, 0, 1)">], ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL_SEQUENTIAL);
        logger.info(</span>"Created znode: {}"<span style="color: rgba(0, 0, 0, 1)">, currentZnodePath);

        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ£æ¥æ¯å¦æ¯ Leader</span>
<span style="color: rgba(0, 0, 0, 1)">        checkIfLeader();
    }

    </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> checkIfLeader() <span style="color: rgba(0, 0, 255, 1)">throws</span><span style="color: rgba(0, 0, 0, 1)"> KeeperException, InterruptedException {
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è·åææå­èç¹ï¼æåºå·æåº</span>
        List&lt;String&gt; children = zk.getChildren(electionPath, <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">);
        Collections.sort(children);

        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å½åèç¹æ¯åºå·æå°çï¼å°±æ¯ Leader</span>
        String smallestChild = children.get(0<span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (currentZnodePath.endsWith(smallestChild)) {
            logger.info(</span>"I am the Leader: {}"<span style="color: rgba(0, 0, 0, 1)">, currentZnodePath);
            taskService.startTask();  </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å¼å§æ§è¡ä»»å¡</span>
        } <span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)"> {
            </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> çè§åä¸ä¸ªèç¹</span>
            <span style="color: rgba(0, 0, 255, 1)">int</span> myIndex = children.indexOf(currentZnodePath.substring(electionPath.length() + 1<span style="color: rgba(0, 0, 0, 1)">));
            String previousChild </span>= children.get(myIndex - 1<span style="color: rgba(0, 0, 0, 1)">);
            zk.exists(electionPath </span>+ "/" + previousChild, <span style="color: rgba(0, 0, 255, 1)">this</span>);  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è®¾ç½®çè§</span>
            logger.info("I am Follower, watching: {}"<span style="color: rgba(0, 0, 0, 1)">, previousChild);
            taskService.stopTask();  </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> åæ­¢ä»»å¡ï¼å¦æä¹åæ¯ Leaderï¼</span>
<span style="color: rgba(0, 0, 0, 1)">        }
    }

    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">void</span> close() <span style="color: rgba(0, 0, 255, 1)">throws</span><span style="color: rgba(0, 0, 0, 1)"> InterruptedException {
        zk.close();
    }
}</span></pre>
</div>
<p dir="auto">TaskService.javaï¼ä»»å¡æ§è¡æå¡ï¼ï¼æ¨¡æä¸ä¸ªå®æ¶ä»»å¡ãåªæ Leader æ§è¡ã</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">package</span><span style="color: rgba(0, 0, 0, 1)"> com.example;

</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> org.slf4j.Logger;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> org.slf4j.LoggerFactory;

</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> java.util.concurrent.Executors;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> java.util.concurrent.ScheduledExecutorService;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> java.util.concurrent.TimeUnit;

</span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> TaskService {
    </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">final</span> Logger logger = LoggerFactory.getLogger(TaskService.<span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">private</span><span style="color: rgba(0, 0, 0, 1)"> ScheduledExecutorService executor;
    </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">boolean</span> isRunning = <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">;

    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> startTask() {
        </span><span style="color: rgba(0, 0, 255, 1)">if</span> (!<span style="color: rgba(0, 0, 0, 1)">isRunning) {
            executor </span>=<span style="color: rgba(0, 0, 0, 1)"> Executors.newSingleThreadScheduledExecutor();
            executor.scheduleAtFixedRate(() </span>-&gt;<span style="color: rgba(0, 0, 0, 1)"> {
                logger.info(</span>"Executing task: Backup database...");  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¨¡æä»»å¡</span>
            }, 0, 60, TimeUnit.SECONDS);  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¯åéæ§è¡</span>
            isRunning = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">;
        }
    }

    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> stopTask() {
        </span><span style="color: rgba(0, 0, 255, 1)">if</span> (isRunning &amp;&amp; executor != <span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">) {
            executor.shutdown();
            isRunning </span>= <span style="color: rgba(0, 0, 255, 1)">false</span><span style="color: rgba(0, 0, 0, 1)">;
            logger.info(</span>"Stopped task"<span style="color: rgba(0, 0, 0, 1)">);
        }
    }
}</span></pre>
</div>
<p dir="auto">App.javaï¼ä¸»å¥å£ï¼</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">package</span><span style="color: rgba(0, 0, 0, 1)"> com.example;

</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> java.io.IOException;
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> java.util.Properties;

</span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> App {
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">void</span> main(String[] args) <span style="color: rgba(0, 0, 255, 1)">throws</span><span style="color: rgba(0, 0, 0, 1)"> IOException, InterruptedException, Exception {
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å è½½éç½®ï¼å®éå¯ä½¿ç¨ Spring æç¯å¢åéï¼</span>
        Properties props = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> Properties();
        props.load(App.</span><span style="color: rgba(0, 0, 255, 1)">class</span>.getClassLoader().getResourceAsStream("application.properties"<span style="color: rgba(0, 0, 0, 1)">));

        String zkConnect </span>= props.getProperty("zk.connectString"<span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">int</span> sessionTimeout = Integer.parseInt(props.getProperty("zk.sessionTimeout"<span style="color: rgba(0, 0, 0, 1)">));
        String electionPath </span>= props.getProperty("election.path"<span style="color: rgba(0, 0, 0, 1)">);
        String nodeId </span>= props.getProperty("node.id");  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¯ä¸ªå®ä¾ä¸å</span>
<span style="color: rgba(0, 0, 0, 1)">
        TaskService taskService </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> TaskService();
        LeaderElection election </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> LeaderElection(zkConnect, sessionTimeout, electionPath, nodeId, taskService);

        election.connect();
        election.participateInElection();

        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ä¿æè¿è¡ï¼çäº§ä¸­ç¨ Spring Boot æ while(true)ï¼</span>
<span style="color: rgba(0, 0, 0, 1)">        Thread.sleep(Long.MAX_VALUE);

        election.close();
    }
}</span></pre>
</div>
<p dir="auto">application.properties</p>
<div class="cnblogs_code">
<pre>zk.connectString=192.168.1.101:2181,192.168.1.102:2181,192.168.1.103:2181<span style="color: rgba(0, 0, 0, 1)">
zk.sessionTimeout</span>=5000<span style="color: rgba(0, 0, 0, 1)">
zk.connectionTimeout</span>=3000<span style="color: rgba(0, 0, 0, 1)">
election.path</span>=/<span style="color: rgba(0, 0, 0, 1)">election
# æ¯ä¸ªèç¹æå¨è®¾ç½®ä¸åç node.id
# node1: node</span>-1<span style="color: rgba(0, 0, 0, 1)">
# node2: node</span>-2<span style="color: rgba(0, 0, 0, 1)">
# node3: node</span>-3<span style="color: rgba(0, 0, 0, 1)">
node.id</span>=node-1   # å¯å¨æ¶æ ¹æ®èç¹ä¿®æ¹</pre>
</div>
<p>é¡¹ç®å¤§åé¨ç½²å°ä¸å°æå¡å¨æå®ç®å½ä¸ï¼/home/userï¼ã</p>
<p dir="auto">å¨æ¯å°æå¡å¨ä¸åå»ºå¯å¨èæ¬ï¼ nohup + èæ¬ï¼</p>
<div class="cnblogs_code">
<pre>cd /home/<span style="color: rgba(0, 0, 0, 1)">user

</span>#<span style="color: rgba(0, 0, 0, 1)"> åå»ºå¯å¨èæ¬ start.shï¼node1 ç¤ºä¾ï¼
cat </span>&gt; start.sh &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(128, 0, 0, 1)">EOF</span><span style="color: rgba(128, 0, 0, 1)">'</span>
#!/bin/<span style="color: rgba(0, 0, 0, 1)">bash

</span>#<span style="color: rgba(0, 0, 0, 1)"> èç¹ IDï¼æ¯ä¸ªæå¡å¨ä¸åï¼
NODE_ID</span>=<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">node-1</span><span style="color: rgba(128, 0, 0, 1)">"</span>   # node2 æ¹ä¸º node-<span style="color: rgba(128, 0, 128, 1)">2</span>ï¼node3 æ¹ä¸º node-<span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">

nohup java </span>-<span style="color: rgba(0, 0, 0, 1)">jar \
  </span>-Dnode.id=<span style="color: rgba(0, 0, 0, 1)">${NODE_ID} \
  distributed</span>-task-service-<span style="color: rgba(128, 0, 128, 1)">1.0</span>-<span style="color: rgba(0, 0, 0, 1)">SNAPSHOT.jar \
  </span>&gt; service.log <span style="color: rgba(128, 0, 128, 1)">2</span>&gt;&amp;<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)"> &amp;

echo </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Started with node.id=${NODE_ID}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
EOF

chmod </span>+x start.sh</pre>
</div>
<p dir="auto">æ¯å°æå¡å¨å¯å¨æå¡</p>
<div class="cnblogs_code">
<pre>./start.sh</pre>
</div>
<p>æ¥å¿æ¥ç</p>
<div class="cnblogs_code">
<pre>tail -f service.log</pre>
</div>
<p dir="auto">å¯ä»¥çå°ç±»ä¼¼è¾åºï¼</p>
<ul dir="auto">
<li>ä¸ä¸ªèç¹ä¼æå°ï¼I am the Leader: /election/node-1-0000000001</li>
<li>å¦å¤ä¸¤ä¸ªèç¹ï¼I am Follower, watching: node-?-0000000000</li>
</ul>
<p dir="auto">åªæ Leader ä¼æ¯åéæå°ï¼Executing task: Backup database...</p>
<h4 dir="auto">æµè¯æéè½¬ç§»</h4>
<p>æ¥çå½å Leaderï¼åè®¾æ¯ node1ï¼ï¼</p>
<div class="cnblogs_code">
<pre>tail -f /home/user/service.log | grep <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">I am the Leader</span><span style="color: rgba(128, 0, 0, 1)">"</span></pre>
</div>
<p dir="auto">ææ Leader è¿ç¨ï¼node1ï¼ï¼</p>
<div class="cnblogs_code">
<pre>ps -<span style="color: rgba(0, 0, 0, 1)">ef | grep java
kill </span>-<span style="color: rgba(128, 0, 128, 1)">9</span> &lt;pid&gt;</pre>
</div>
<p>è§å¯å¶ä»èç¹æ¥å¿ï¼</p>
<ul dir="auto">
<li>å ç¾æ¯«ç§åï¼å¶ä¸­ä¸ä¸ª Follower ä¼æä¸ºæ° Leaderï¼å¹¶å¼å§æ§è¡ä»»å¡ã</li>
<li>åæ¥ç Follower ç»§ç»­çè§æ° Leaderã</li>
</ul>
<h3 dir="auto">æ»ç»</h3>
<ul dir="auto">
<li><strong>æä½æµç¨</strong>ï¼3 å°æºå¨ â å®è£ ZK â å¤å¶ JAR â ä¿®æ¹ node.id â å¯å¨èæ¬</li>
<li><strong>é«å¯ç¨</strong>ï¼ZooKeeper ä¿è¯é¢å¯¼èéä¸¾å¿«éãå¯é </li>
<li><strong>å¯æ©å±</strong>ï¼æ³å æ´å¤èç¹ï¼åªéå¤å¶ JAR + ä¿®æ¹ node.id + å¯å¨å³å¯</li>
</ul>
<p dir="auto">&nbsp;</p>
<p>&nbsp;</p>
<p dir="auto">&nbsp;</p>
<p dir="auto">&nbsp;</p>
<p dir="auto">&nbsp;</p>
<p dir="auto">&nbsp;</p>
<p dir="auto">&nbsp;</p>
<p dir="auto">&nbsp;</p>
<p>&nbsp;</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.005555555555555556" data-date-updated="2026-01-22 17:30">2026-01-22 17:22</span>&nbsp;
<a href="https://www.cnblogs.com/Marktowin">Marktowin</a>&nbsp;
éè¯»(<span id="post_view_count">5</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19518265);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19518265', targetLink: 'https://www.cnblogs.com/Marktowin/p/19518265', title: 'ç©è½¬ ZooKeeper' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å¤çº¿ç¨çè¿12ç§ç¨éï¼99%çäººä¸ç¥éï¼ ]]></title>
    <link>https://www.cnblogs.com/12lisu/p/19517803</link>
    <guid>f0e9d65c65c2001a634ab27b34a2bac4</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/12lisu/p/19517803" title="åå¸äº 2026-01-22 16:09">
    <span role="heading" aria-level="2">å¤çº¿ç¨çè¿12ç§ç¨éï¼99%çäººä¸ç¥éï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="åè¨">åè¨</h2>
<p>å¹¶åç¼ç¨æ¯ä¸é¡¹éå¸¸éè¦çææ¯ï¼æ è®ºå¨é¢è¯ï¼è¿æ¯å·¥ä½ä¸­åºç°çé¢çéå¸¸é«ã</p>
<p>ä¹åæåè¡¨çä¸ç¯ã<a href="https://mp.weixin.qq.com/s?__biz=MzkwNjMwMTgzMQ==&amp;mid=2247492962&amp;idx=1&amp;sn=17ed1d2ed950b4e9160218b296d19d4e&amp;chksm=c0e83d8af79fb49cc72fcafc8ed62822263106e54675ea8406a2e3daadb44e25364275af9082&amp;token=245805875&amp;lang=zh_CN#rd" target="_blank" rel="noopener nofollow">èèå¹¶åç¼ç¨ç10ä¸ªå</a>ãï¼å¨å¨ç½å¹¿åå¥½è¯ãè¯´æäºè¿ç±»æç« è¿æ¯æ¯è¾æä»·å¼çï¼æ¥ä¸æ¥ï¼æç®ç»§ç»­èèå¹¶åç¼ç¨è¿ä¸ªè¯é¢ã</p>
<p>å¹¶åç¼ç¨è¯´ç½äºå°±æ¯å¤çº¿ç¨ç¼ç¨ï¼ä½å¤çº¿ç¨ä¸å®æ¯åçº¿ç¨æçæ´é«ï¼</p>
<p>ç­ï¼ä¸ä¸å®ï¼è¦çå·ä½ä¸å¡åºæ¯ã</p>
<p>æ¯ç«å¦æä½¿ç¨äºå¤çº¿ç¨ï¼é£ä¹çº¿ç¨ä¹é´çç«äºåæ¢å cpuèµæºï¼çº¿ç¨çä¸ä¸æåæ¢ï¼ä¹æ¯ç¸å¯¹æ¥è¯´æ¯è¾èæ¶çæä½ã</p>
<p>ä¸é¢è¿å ä¸ªé®é¢å¨é¢è¯ä¸­ï¼ä½ å¿å®éå°è¿ï¼</p>
<ol>
<li>ä½ å¨åªæ¥ä¸å¡åºæ¯ä¸­ä½¿ç¨è¿å¤çº¿ç¨ï¼</li>
<li>æä¹ç¨çï¼</li>
<li>è¸©è¿åªäºåï¼</li>
</ol>
<p>ä»å¤©èèæä¹åå¨é¡¹ç®ä¸­ç¨å¹¶åç¼ç¨ç12ç§ä¸å¡åºæ¯ï¼ç»æéè¦çæåä¸ä¸ªåèã</p>
<p><img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/2e33944c-a648-4515-9595-470ababba0f6.png" class="lazyload"></p>
<h2 id="1-ç®åå®æ¶ä»»å¡">1. ç®åå®æ¶ä»»å¡</h2>
<p>åä½äº²ç±çæåï¼ä½ æ²¡çéï¼<code>Thread</code>ç±»ççè½åå®æ¶ä»»å¡ãå¦æä½ çè¿ä¸äº<code>å®æ¶ä»»å¡æ¡æ¶</code>çæºç ï¼ä½ æåä¼åç°ï¼å®ä»¬çåºå±ä¹ä¼ä½¿ç¨Threadç±»ã</p>
<p>å®ç°è¿ç§å®æ¶ä»»å¡çå·ä½ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-java">public static void init() {
    new Thread(() -&gt; {
        while (true) {
            try {
                System.out.println("ä¸è½½æä»¶");
                Thread.sleep(1000 * 60 * 5);
            } catch (Exception e) {
                log.error(e);
            }
        }
    }).start();
}
</code></pre>
<p>ä½¿ç¨Threadç±»å¯ä»¥åæç®åçå®æ¶ä»»å¡ï¼å¨runæ¹æ³ä¸­æä¸ªwhileçæ­»å¾ªç¯ï¼å½ç¶è¿æå¶ä»æ¹å¼ï¼ï¼æ§è¡æä»¬èªå·±çä»»å¡ãæä¸ªéè¦ç¹å«æ³¨æçå°æ¹æ¯ï¼éè¦ç¨<code>try...catch</code>æè·å¼å¸¸ï¼å¦åå¦æåºç°å¼å¸¸ï¼å°±ç´æ¥éåºå¾ªç¯ï¼ä¸æ¬¡å°æ æ³ç»§ç»­æ§è¡äºã</p>
<p>ä½è¿ç§æ¹å¼åçå®æ¶ä»»å¡ï¼åªè½å¨ææ§æ§è¡ï¼ä¸è½æ¯æå®æ¶å¨æä¸ªæ¶é´ç¹æ§è¡ã</p>
<p>ç¹å«æéä¸ä¸ï¼è¯¥çº¿ç¨å»ºè®®å®ä¹æ<code>å®æ¤çº¿ç¨</code>ï¼å¯ä»¥éè¿<code>setDaemon</code>æ¹æ³è®¾ç½®ï¼è®©å®å¨åå°é»é»æ§è¡å°±å¥½ã</p>
<p>ä½¿ç¨åºæ¯ï¼æ¯å¦é¡¹ç®ä¸­ææ¶éè¦æ¯é5åéå»<code>ä¸è½½æä¸ªæä»¶</code>ï¼æèæ¯é10åéå»è¯»åæ¨¡æ¿æä»¶<code>çæéæhtmlé¡µé¢</code>ç­ç­ï¼ä¸äºç®åçå¨ææ§ä»»å¡åºæ¯ã</p>
<p>ä½¿ç¨<code>Thread</code>ç±»åå®æ¶ä»»å¡çä¼ç¼ºç¹ï¼</p>
<ul>
<li>
<p>ä¼ç¹ï¼è¿ç§å®æ¶ä»»å¡éå¸¸ç®åï¼å­¦ä¹ ææ¬ä½ï¼å®¹æå¥æï¼å¯¹äºé£äºç®åçå¨ææ§ä»»å¡ï¼æ¯ä¸ªä¸éçéæ©ã</p>
</li>
<li>
<p>ç¼ºç¹ï¼ä¸æ¯ææå®æä¸ªæ¶é´ç¹æ§è¡ä»»å¡ï¼ä¸æ¯æå»¶è¿æ§è¡ç­æä½ï¼åè½è¿äºåä¸ï¼æ æ³åºå¯¹ä¸äºè¾ä¸ºå¤æçåºæ¯ã</p>
</li>
</ul>
<h2 id="2çå¬å¨">2.çå¬å¨</h2>
<p>ææ¶åï¼æä»¬éè¦åä¸ªçå¬å¨ï¼å»çå¬æäºæ°æ®çååã</p>
<p>æ¯å¦ï¼æä»¬å¨ä½¿ç¨<code>canal</code>çæ¶åï¼éè¦çå¬<code>binlog</code>çååï¼è½å¤åæ¶ææ°æ®åºä¸­çæ°æ®ï¼åæ­¥å°å¦å¤ä¸ä¸ªä¸å¡æ°æ®åºä¸­ã</p>
<p><img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/3f4eb738-e6a7-4c56-bf88-192eb18b3e57.png" class="lazyload"><br>
å¦æç´æ¥åä¸ä¸ªçå¬å¨å»çå¬æ°æ®å°±å¤ªæ²¡ææäºï¼æä»¬æ³å®ç°è¿æ ·ä¸ä¸ªåè½ï¼å¨éç½®ä¸­å¿æä¸ªå¼å³ï¼éç½®çå¬å¨æ¯å¦å¼å¯ï¼å¦æå¼å¯äºä½¿ç¨åçº¿ç¨å¼æ­¥æ§è¡ã</p>
<p>ä¸»è¦ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-java">@Service
public CanalService {
    private volatile boolean running = false;
    private Thread thread;

    @Autowired
    private CanalConnector canalConnector;
    
    public void handle() {
        //è¿æ¥canal
        while(running) {
           //ä¸å¡å¤ç
        }
    }
    
    public void start() {
       thread = new Thread(this::handle, "name");
       running = true;
       thread.start();
    }
    
    public void stop() {
       if(!running) {
          return;
       }
       running = false;
    }
}
</code></pre>
<p>å¨startæ¹æ³ä¸­å¼å¯äºä¸ä¸ªçº¿ç¨ï¼å¨è¯¥çº¿ç¨ä¸­å¼æ­¥æ§è¡handleæ¹æ³çå·ä½ä»»å¡ãç¶åéè¿è°ç¨stopæ¹æ³ï¼å¯ä»¥åæ­¢è¯¥çº¿ç¨ã</p>
<p>å¶ä¸­ï¼ä½¿ç¨<code>volatile</code>å³é®å­æ§å¶çrunningåéä½ä¸ºå¼å³ï¼å®å¯ä»¥æ§å¶çº¿ç¨ä¸­çç¶æã</p>
<p>æ¥ä¸æ¥ï¼æä¸ªæ¯è¾å³é®çç¹æ¯ï¼å¦ä½éè¿éç½®ä¸­å¿çéç½®ï¼æ§å¶è¿ä¸ªå¼å³å¢ï¼</p>
<p>ä»¥<code>apollo</code>éç½®ä¸ºä¾ï¼æä»¬å¨éç½®ä¸­å¿çåå°ï¼ä¿®æ¹éç½®ä¹åï¼èªå¨è·åææ°éç½®çæ ¸å¿ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-java">public class CanalConfig {
    @Autowired
    private CanalService canalService;

    @ApolloConfigChangeListener
    public void change(ConfigChangeEvent event) {
        String value = event.getChange("test.canal.enable").getNewValue();
        if(BooleanUtils.toBoolean(value)) {
            canalService.start();
        } else {
            canalService.stop();
        }
    }
}
</code></pre>
<p>éè¿<code>apollo</code>ç<code>ApolloConfigChangeListener</code>æ³¨è§£ï¼å¯ä»¥çå¬éç½®åæ°çååã</p>
<p>å¦æ<code>test.canal.enable</code>å¼å³éç½®çtrueï¼åè°ç¨canalServiceç±»çstartæ¹æ³å¼å¯canalæ°æ®åæ­¥åè½ãå¦æå¼å³éç½®çfalseï¼åè°ç¨canalServiceç±»çstopæ¹æ³ï¼èªå¨åæ­¢canalæ°æ®åæ­¥åè½ã</p>
<h2 id="3æ¶éæ¥å¿">3.æ¶éæ¥å¿</h2>
<p>å¨æäºé«å¹¶åçåºæ¯ä¸­ï¼æä»¬éè¦æ¶éé¨åç¨æ·çæ¥å¿ï¼æ¯å¦ï¼ç¨æ·ç»å½çæ¥å¿ï¼ï¼åå°æ°æ®åºä¸­ï¼ä»¥ä¾¿äºååæã</p>
<p>ä½ç±äºé¡¹ç®ä¸­ï¼è¿æ²¡æå¼å¥æ¶æ¯ä¸­é´ä»¶ï¼æ¯å¦ï¼<code>kafka</code>ã<code>rocketmq</code>ç­ã</p>
<p>å¦æç´æ¥å°æ¥å¿åæ­¥åå¥æ°æ®åºï¼å¯è½ä¼å½±åæ¥å£æ§è½ã</p>
<p>æä»¥ï¼å¤§å®¶å¾èªç¶æ³å°äºå¼æ­¥å¤çã</p>
<p>å®ç°è¿ä¸ªéæ±æç®åçåæ³æ¯ï¼å¼å¯ä¸ä¸ªçº¿ç¨ï¼å¼æ­¥åå¥æ°æ®å°æ°æ®åºå³å¯ã</p>
<p>è¿æ ·åï¼å¯ä»¥æ¯å¯ä»¥ã</p>
<p>ä½å¦æç¨æ·ç»å½æä½çèæ¶ï¼æ¯å¼æ­¥åå¥æ°æ®åºçæ¶é´è¦å°å¾å¤ãè¿æ ·å¯¼è´çç»ææ¯ï¼çäº§æ¥å¿çéåº¦ï¼æ¯æ¶è´¹æ¥å¿çéåº¦è¦å¿«å¾å¤ï¼æç»çæ§è½ç¶é¢å¨æ¶è´¹ç«¯ã</p>
<p>å¶å®ï¼è¿ææ´ä¼éçå¤çæ¹å¼ï¼è½è¯´æ²¡æä½¿ç¨æ¶æ¯ä¸­é´ä»¶ï¼ä½åç¨äºå®çææ³ã</p>
<p>è¿å¥è®°å½ç»å½æ¥å¿çåè½ï¼åä¸ºï¼æ¥å¿çäº§ç«¯ãæ¥å¿å­å¨ç«¯åæ¥å¿æ¶è´¹ç«¯ã</p>
<p>å¦ä¸å¾æç¤ºï¼<br>
<img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/8efc20b3-36ca-4a20-b688-f1a5a981ee6a.png" class="lazyload"></p>
<p>åå®ä¹äºä¸ä¸ªé»å¡éåã</p>
<pre><code class="language-java">@Component
public class LoginLogQueue {
    private static final int QUEUE_MAX_SIZE    = 1000;

    private BlockingQueueblockingQueue queue = new LinkedBlockingQueue&lt;&gt;(QUEUE_MAX_SIZE);

    //çææ¶æ¯
    public boolean push(LoginLog loginLog) {
        return this.queue.add(loginLog);
    } 

    //æ¶è´¹æ¶æ¯
    public LoginLog poll() {
        LoginLog loginLog = null;
        try {
            loginLog = this.queue.take();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        return result;
    }
}
</code></pre>
<p>ç¶åå®ä¹äºä¸ä¸ªæ¥å¿ççäº§èã</p>
<pre><code class="language-java">@Service
public class LoginSerivce {
    
    @Autowired
    private LoginLogQueue loginLogQueue;

    public int login(UserInfo userInfo) {
        //ä¸å¡å¤ç
        LoginLog loginLog = convert(userInfo);
        loginLogQueue.push(loginLog);
    }  
}
</code></pre>
<p>æ¥ä¸æ¥ï¼å®ä¹äºæ¥å¿çæ¶è´¹èã</p>
<pre><code class="language-java">@Service
public class LoginInfoConsumer {
    @Autowired
    private LoginLogQueue queue;

    @PostConstruct
    public voit init {
       new Thread(() -&gt; {
          while (true) {
              LoginLog loginLog = queue.take();
              //åå¥æ°æ®åº
          }
        }).start();
    }
}
</code></pre>
<p>å½ç¶ï¼è¿ä¸ªä¾å­ä¸­ä½¿ç¨åçº¿ç¨æ¥æ¶ç»å½æ¥å¿ï¼ä¸ºäºæåæ§è½ï¼ä¹å¯ä»¥ä½¿ç¨çº¿ç¨æ± æ¥å¤çä¸å¡é»è¾ï¼æ¯å¦ï¼åå¥æ°æ®åºï¼ç­ã</p>
<h2 id="4excelå¯¼å¥">4.excelå¯¼å¥</h2>
<p>æä»¬å¯è½ä¼ç»å¸¸æ¶å°è¿è¥åå­¦æè¿æ¥çexcelæ°æ®å¯¼å¥éæ±ï¼æ¯å¦ï¼å°æä¸å¤§ç±»ä¸çææå­ç±»ä¸æ¬¡æ§å¯¼å¥ç³»ç»ï¼æèå¯¼å¥ä¸æ¹æ°çä¾åºåæ°æ®ç­ç­ã</p>
<p>æä»¬ä»¥å¯¼å¥ä¾åºåæ°æ®ä¸ºä¾ï¼å®ææ¶åçä¸å¡æµç¨å¾é¿ï¼æ¯å¦ï¼</p>
<ol>
<li>è°ç¨å¤©ç¼æ¥æ¥å£æ ¡éªä¼ä¸åç§°åç»ä¸ç¤¾ä¼ä¿¡ç¨ä»£ç ã</li>
<li>åå¥ä¾åºååºæ¬è¡¨</li>
<li>åå¥ç»ç»è¡¨</li>
<li>ç»ä¾åºåèªå¨åå»ºä¸ä¸ªç¨æ·</li>
<li>ç»è¯¥ç¨æ·åéæé</li>
<li>èªå®ä¹åå</li>
<li>åç«åéç¥</li>
</ol>
<p>ç­ç­ã</p>
<p>å¦æå¨ç¨åºä¸­ï¼è§£æå®excelï¼è¯»åäºæææ°æ®ä¹åãç¨åçº¿ç¨ä¸æ¡æ¡å¤çä¸å¡é»è¾ï¼å¯è½èæ¶ä¼éå¸¸é¿ã</p>
<p>ä¸ºäºæåexcelæ°æ®å¯¼å¥æçï¼éå¸¸æå¿è¦ä½¿ç¨å¤çº¿ç¨æ¥å¤çã</p>
<p>å½ç¶å¨javaä¸­å®ç°å¤çº¿ç¨çææ®µæå¾å¤ç§ï¼ä¸é¢éç¹èèjava8ä¸­æç®åçå®ç°æ¹å¼ï¼<code>parallelStream</code>ã</p>
<p>ä¼ªä»£ç å¦ä¸ï¼</p>
<pre><code class="language-java">supplierList.parallelStream().forEach(x -&gt; importSupplier(x));
</code></pre>
<p><code>parallelStream</code>æ¯ä¸ä¸ªå¹¶è¡æ§è¡çæµï¼å®é»è®¤éè¿<code>ForkJoinPool</code>å®ç°çï¼è½æé«ä½ çå¤çº¿ç¨ä»»å¡çéåº¦ã</p>
<p><code>ForkJoinPool</code>å¤ççè¿ç¨ä¼åèæ²»ä¹ï¼å®çæ ¸å¿ææ³æ¯ï¼<code>å°ä¸ä¸ªå¤§ä»»å¡ååæå¤ä¸ªå°ä»»å¡</code>ãæ¯ä¸ªå°ä»»å¡é½è½åç¬æ§è¡ï¼æåå®ä¼ææç¨ä»»å¡çæ§è¡ç»æè¿è¡æ±æ»ã</p>
<p>ä¸é¢ç¨ä¸å¼ å¾ç®åä»ç»ä¸ä¸ForkJoinPoolçåçï¼<br>
<img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/bd3bda9c-c078-40e9-860e-30a92d63e6e0.png" class="lazyload"></p>
<p>å½ç¶é¤äºexcelå¯¼å¥ä¹å¤ï¼è¿æç±»ä¼¼çè¯»åææ¬æä»¶ï¼ä¹å¯ä»¥ç¨ç±»ä¼¼çæ¹æ³å¤çã</p>
<blockquote>
<p>æ¸©é¦¨çæéä¸ä¸ï¼å¦æä¸æ¬¡æ§å¯¼å¥çæ°æ®éå¸¸å¤ï¼ç¨å¤çº¿ç¨å¤çï¼å¯è½ä¼ä½¿ç³»ç»çcpuä½¿ç¨çé£åï¼éè¦ç¹å«å³æ³¨ã</p>
</blockquote>
<h2 id="5æ¥è¯¢æ¥å£">5.æ¥è¯¢æ¥å£</h2>
<p>å¾å¤æ¶åï¼æä»¬éè¦å¨æä¸ªæ¥è¯¢æ¥å£ä¸­ï¼è°ç¨å¶ä»æå¡çæ¥å£ï¼ç»åæ°æ®ä¹åï¼ä¸èµ·è¿åã</p>
<p>æ¯å¦æè¿æ ·çä¸å¡åºæ¯ï¼</p>
<p>å¨ç¨æ·ä¿¡æ¯æ¥è¯¢æ¥å£ä¸­éè¦è¿åï¼ç¨æ·åç§°ãæ§å«ãç­çº§ãå¤´åãç§¯åãæé¿å¼ç­ä¿¡æ¯ã</p>
<p>èç¨æ·åç§°ãæ§å«ãç­çº§ãå¤´åå¨ç¨æ·æå¡ä¸­ï¼ç§¯åå¨ç§¯åæå¡ä¸­ï¼æé¿å¼å¨æé¿å¼æå¡ä¸­ãä¸ºäºæ±æ»è¿äºæ°æ®ç»ä¸è¿åï¼éè¦å¦å¤æä¾ä¸ä¸ªå¯¹å¤æ¥å£æå¡ã</p>
<p>äºæ¯ï¼ç¨æ·ä¿¡æ¯æ¥è¯¢æ¥å£éè¦è°ç¨ç¨æ·æ¥è¯¢æ¥å£ãç§¯åæ¥è¯¢æ¥å£ å æé¿å¼æ¥è¯¢æ¥å£ï¼ç¶åæ±æ»æ°æ®ç»ä¸è¿åã</p>
<p>è°ç¨è¿ç¨å¦ä¸å¾æç¤ºï¼<br>
<img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/8d49a8dc-89e5-4fd1-8a4e-3be393c80790.png" class="lazyload"></p>
<p>è°ç¨è¿ç¨æ¥å£æ»èæ¶ 530ms = 200ms + 150ms + 180ms</p>
<p>æ¾ç¶è¿ç§ä¸²è¡è°ç¨è¿ç¨æ¥å£æ§è½æ¯éå¸¸ä¸å¥½çï¼è°ç¨è¿ç¨æ¥å£æ»çèæ¶ä¸ºææçè¿ç¨æ¥å£èæ¶ä¹åã</p>
<p>é£ä¹å¦ä½ä¼åè¿ç¨æ¥å£æ§è½å¢ï¼</p>
<p>æ¢ç¶ä¸²è¡è°ç¨å¤ä¸ªè¿ç¨æ¥å£æ§è½å¾å·®ï¼ä¸ºä»ä¹ä¸æ¹æå¹¶è¡å¢ï¼</p>
<p>å¦ä¸å¾æç¤ºï¼<br>
<img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/0720b188-bc39-4651-a7da-f79cbfcf0012.png" class="lazyload"></p>
<p>è°ç¨è¿ç¨æ¥å£æ»èæ¶ 200ms = 200msï¼å³èæ¶æé¿çé£æ¬¡è¿ç¨æ¥å£è°ç¨ï¼</p>
<p>å¨java8ä¹åå¯ä»¥éè¿å®ç°<code>Callable</code>æ¥å£ï¼è·åçº¿ç¨è¿åç»æã</p>
<p>java8ä»¥åéè¿<code>CompleteFuture</code>ç±»å®ç°è¯¥åè½ãæä»¬è¿éä»¥CompleteFutureä¸ºä¾ï¼</p>
<pre><code class="language-java">public UserInfo getUserInfo(Long id) throws InterruptedException, ExecutionException {
    final UserInfo userInfo = new UserInfo();
    CompletableFuture userFuture = CompletableFuture.supplyAsync(() -&gt; {
        getRemoteUserAndFill(id, userInfo);
        return Boolean.TRUE;
    }, executor);

    CompletableFuture bonusFuture = CompletableFuture.supplyAsync(() -&gt; {
        getRemoteBonusAndFill(id, userInfo);
        return Boolean.TRUE;
    }, executor);

    CompletableFuture growthFuture = CompletableFuture.supplyAsync(() -&gt; {
        getRemoteGrowthAndFill(id, userInfo);
        return Boolean.TRUE;
    }, executor);
    CompletableFuture.allOf(userFuture, bonusFuture, growthFuture).join();

    userFuture.get();
    bonusFuture.get();
    growthFuture.get();
    return userInfo;
}
</code></pre>
<p>æ¸©é¦¨æéä¸ä¸ï¼è¿ä¸¤ç§æ¹å¼å«å¿äºä½¿ç¨<code>çº¿ç¨æ± </code>ãç¤ºä¾ä¸­æç¨å°äº<code>executor</code>ï¼è¡¨ç¤ºèªå®ä¹ççº¿ç¨æ± ï¼ä¸ºäºé²æ­¢é«å¹¶ååºæ¯ä¸ï¼åºç°çº¿ç¨è¿å¤çé®é¢ã</p>
<h2 id="6è·åç¨æ·ä¸ä¸æ">6.è·åç¨æ·ä¸ä¸æ</h2>
<p>ä¸ç¥éä½ å¨é¡¹ç®å¼åæ¶ï¼ææ²¡æéå°è¿è¿æ ·çéæ±ï¼ç¨æ·ç»å½ä¹åï¼å¨ææçè¯·æ±æ¥å£ä¸­ï¼éè¿æä¸ªå¬å±æ¹æ³ï¼å°±è½è·åå°å½åç»å½ç¨æ·çä¿¡æ¯ï¼</p>
<p>è·åçç¨æ·ä¸ä¸æï¼æä»¬ä»¥<code>CurrentUser</code>ä¸ºä¾ã</p>
<p><code>CurrentUser</code>åé¨åå«äºä¸ä¸ª<code>ThreadLocal</code>å¯¹è±¡ï¼å®è´è´£ä¿å­å½åçº¿ç¨çç¨æ·ä¸ä¸æä¿¡æ¯ãå½ç¶ä¸ºäºä¿è¯å¨çº¿ç¨æ± ä¸­ï¼ä¹è½ä»ç¨æ·ä¸ä¸æä¸­è·åå°æ­£ç¡®çç¨æ·ä¿¡æ¯ï¼è¿éç¨äºé¿éç<code>TransmittableThreadLocal</code>ãä¼ªä»£ç å¦ä¸ï¼</p>
<pre><code class="language-java">@Data
public class CurrentUser {
    private static final TransmittableThreadLocal&lt;CurrentUser&gt; THREA_LOCAL = new TransmittableThreadLocal&lt;&gt;();
    
    private String id;
    private String userName;
    private String password;
    private String phone;
    ...
    
    public statis void set(CurrentUser user) {
      THREA_LOCAL.set(user);
    }
    
    public static void getCurrent() {
      return THREA_LOCAL.get();
    }
}
</code></pre>
<p>è¿éä¸ºä»ä¹ç¨äºé¿éçTransmittableThreadLocalï¼èä¸æ¯æ®éçThreadLocalå¢ï¼å¨çº¿ç¨æ± ä¸­ï¼ç±äºçº¿ç¨ä¼è¢«å¤æ¬¡å¤ç¨ï¼å¯¼è´ä»æ®éçThreadLocalä¸­æ æ³è·åæ­£ç¡®çç¨æ·ä¿¡æ¯ãç¶çº¿ç¨ä¸­çåæ°ï¼æ²¡æ³ä¼ éç»å­çº¿ç¨ï¼èTransmittableThreadLocalå¾å¥½è§£å³äºè¿ä¸ªé®é¢ã</p>
<p>ç¶åå¨é¡¹ç®ä¸­å®ä¹ä¸ä¸ªå¨å±çspring mvcæ¦æªå¨ï¼ä¸é¨è®¾ç½®ç¨æ·ä¸ä¸æå°ThreadLocalä¸­ãä¼ªä»£ç å¦ä¸ï¼</p>
<pre><code class="language-java">public class UserInterceptor extends HandlerInterceptorAdapter {
   
   @Override  
   public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
      CurrentUser user = getUser(request);
      if(Objects.nonNull(user)) {
         CurrentUser.set(user);
      }
   } 
}
</code></pre>
<p>ç¨æ·å¨è¯·æ±æä»¬æ¥å£æ¶ï¼ä¼åè§¦åè¯¥æ¦æªå¨ï¼å®ä¼æ ¹æ®ç¨æ·cookieä¸­çtokenï¼è°ç¨è°ç¨æ¥å£è·åredisä¸­çç¨æ·ä¿¡æ¯ãå¦æè½è·åå°ï¼è¯´æç¨æ·å·²ç»ç»å½ï¼åæç¨æ·ä¿¡æ¯è®¾ç½®å°CurrentUserç±»çThreadLocalä¸­ã</p>
<p>æ¥ä¸æ¥ï¼å¨apiæå¡çä¸å±ï¼å³businesså±çæ¹æ³ä¸­ï¼å°±è½è½»æ¾éè¿CurrentUser.getCurrent();æ¹æ³è·åå°æ³è¦çç¨æ·ä¸ä¸æä¿¡æ¯äºã<br>
<img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/d8bedf76-b533-4a97-80e3-69b522b9a494.png" class="lazyload"></p>
<p>è¿å¥ç¨æ·ä½ç³»çæ³æ³æ¯å¾goodçï¼ä½æ·±å¥ä½¿ç¨åï¼åç°äºä¸ä¸ªå°ææ²ï¼</p>
<p>apiæå¡åmqæ¶è´¹èæå¡é½å¼ç¨äºbusinesså±ï¼businesså±ä¸­çæ¹æ³ä¸¤ä¸ªæå¡é½è½ç´æ¥è°ç¨ã</p>
<p>æä»¬é½ç¥éå¨apiæå¡ä¸­ç¨æ·æ¯éè¦ç»å½çï¼èmqæ¶è´¹èæå¡åä¸éè¦ç»å½ã<br>
<img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/c789bc18-d93d-4688-80ef-53521c01b09e.png" class="lazyload"></p>
<p>å¦æbusinessä¸­çæä¸ªæ¹æ³åå¼å§æ¯ç»apiå¼åçï¼å¨æ¹æ³æ·±å¤ä½¿ç¨äºCurrentUser.getCurrent();è·åç¨æ·ä¸ä¸æãä½åæ¥ï¼æä½æ°æ¥çå¸å¥å¨mqæ¶è´¹èä¸­ä¹è°ç¨äºé£ä¸ªæ¹æ³ï¼å¹¶æªåè§è¿ä¸ªå°æºå³ï¼å°±ä¼ä¸­æï¼åºç°æ¾ä¸å°ç¨æ·ä¸ä¸æçé®é¢ã<br>
<img alt="" loading="lazy" data-src="https://files.mdnice.com/user/5303/43d5c955-f5e9-4c2e-886a-7d3877ee8a3c.png" class="lazyload"></p>
<p>æä»¥æå½æ¶çç¬¬ä¸ä¸ªæ³æ³æ¯ï¼ä»£ç æ²¡åå¼å®¹å¤çï¼å ä¸ºä¹åè¿ç±»é®é¢å¶å°ä¼åçä¸æ¬¡ã</p>
<p>æ³è¦è§£å³è¿ä¸ªé®é¢ï¼å¶å®ä¹å¾ç®åãåªéåå¤æ­ä¸ä¸è½å¦ä»CurrentUserä¸­è·åç¨æ·ä¿¡æ¯ï¼å¦æä¸è½ï¼ååéç½®çç³»ç»ç¨æ·ä¿¡æ¯ãä¼ªä»£ç å¦ä¸ï¼</p>
<pre><code class="language-java">@Autowired
private BusinessConfig businessConfig;

CurrentUser user = CurrentUser.getCurrent();
if(Objects.nonNull(user)) {
   entity.setUserId(user.getUserId());
   entity.setUserName(user.getUserName());
} else {
   entity.setUserId(businessConfig.getDefaultUserId());
   entity.setUserName(businessConfig.getDefaultUserName());
}
</code></pre>
<p>è¿ç§ç®åæ å¬å®³çä»£ç ï¼å¦æåªæ¯å¨ä¸ä¸¤ä¸ªå°æ¹å è¿OKã</p>
<p>æ­¤å¤ï¼ä¼æå¨ç¥ï¼<code>SimpleDateFormat</code>å¨java8ä»¥åï¼æ¯ç¨æ¥å¤çæ¶é´çå·¥å·ç±»ï¼å®æ¯éçº¿ç¨å®å¨çãä¹å°±æ¯è¯´ï¼ç¨è¯¥æ¹æ³è§£ææ¥æä¼æçº¿ç¨å®å¨é®é¢ã</p>
<p>ä¸ºäºé¿åçº¿ç¨å®å¨é®é¢çåºç°ï¼æä»¬å¯ä»¥æSimpleDateFormatå¯¹è±¡å®ä¹æ<code>å±é¨åé</code>ãä½å¦æä½ ä¸å®è¦æå®å®ä¹æéæåéï¼å¯ä»¥ä½¿ç¨ThreadLocalä¿å­æ¥æï¼ä¹è½è§£å³çº¿ç¨å®å¨é®é¢ã</p>
<h2 id="8-ä¼ éåæ°">8. ä¼ éåæ°</h2>
<p>ä¹åè§è¿æäºåäºåä»£ç æ¶ï¼ä¸ä¸ªéå¸¸æè¶£çç¨æ³ï¼å³ï¼ä½¿ç¨<code>MDC</code>ä¼ éåæ°ã</p>
<p>MDCæ¯ä»ä¹ï¼</p>
<p><code>MDC</code>æ¯<code>org.slf4j</code>åä¸çä¸ä¸ªç±»ï¼å®çå¨ç§°æ¯<code>Mapped Diagnostic Context</code>ï¼æä»¬å¯ä»¥è®¤ä¸ºå®æ¯ä¸ä¸ªçº¿ç¨å®å¨çå­æ¾è¯æ­æ¥å¿çå®¹å¨ã</p>
<p><code>MDC</code>çåºå±æ¯ç¨äº<code>ThreadLocal</code>æ¥ä¿å­æ°æ®çã</p>
<p>ä¾å¦ç°å¨æè¿æ ·ä¸ç§åºæ¯ï¼æä»¬ä½¿ç¨<code>RestTemplate</code>è°ç¨è¿ç¨æ¥å£æ¶ï¼ææ¶éè¦å¨<code>header</code>ä¸­ä¼ éä¿¡æ¯ï¼æ¯å¦ï¼traceIdï¼sourceç­ï¼ä¾¿äºå¨æ¥è¯¢æ¥å¿æ¶è½å¤ä¸²èä¸æ¬¡å®æ´çè¯·æ±é¾è·¯ï¼å¿«éå®ä½é®é¢ã</p>
<p>è¿ç§ä¸å¡åºæ¯å°±è½éè¿<code>ClientHttpRequestInterceptor</code>æ¥å£å®ç°ï¼å·ä½åæ³å¦ä¸ï¼</p>
<p>ç¬¬ä¸æ­¥ï¼å®ä¹ä¸ä¸ªLogFilteræ¦æªæææ¥å£è¯·æ±ï¼å¨MDCä¸­è®¾ç½®traceIdï¼</p>
<pre><code class="language-java">public class LogFilter implements Filter {
    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        MdcUtil.add(UUID.randomUUID().toString());
        System.out.println("è®°å½è¯·æ±æ¥å¿");
        chain.doFilter(request, response);
        System.out.println("è®°å½ååºæ¥å¿");
    }

    @Override
    public void destroy() {
    }
}
</code></pre>
<p>ç¬¬äºæ­¥ï¼å®ç°<code>ClientHttpRequestInterceptor</code>æ¥å£ï¼MDCä¸­è·åå½åè¯·æ±çtraceIdï¼ç¶åè®¾ç½®å°headerä¸­ï¼</p>
<pre><code class="language-java">public class RestTemplateInterceptor implements ClientHttpRequestInterceptor {

    @Override
    public ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException {
        request.getHeaders().set("traceId", MdcUtil.get());
        return execution.execute(request, body);
    }
}
</code></pre>
<p>ç¬¬ä¸æ­¥ï¼å®ä¹éç½®ç±»ï¼éç½®ä¸é¢å®ä¹çRestTemplateInterceptorç±»ï¼</p>
<pre><code class="language-java">@Configuration
public class RestTemplateConfiguration {

    @Bean
    public RestTemplate restTemplate() {
        RestTemplate restTemplate = new RestTemplate();
        restTemplate.setInterceptors(Collections.singletonList(restTemplateInterceptor()));
        return restTemplate;
    }

    @Bean
    public RestTemplateInterceptor restTemplateInterceptor() {
        return new RestTemplateInterceptor();
    }
}
</code></pre>
<p>å¶ä¸­MdcUtilå¶å®æ¯å©ç¨MDCå·¥å·å¨<code>ThreadLocal</code>ä¸­å­å¨åè·åtraceId</p>
<pre><code class="language-java">public class MdcUtil {

    private static final String TRACE_ID = "TRACE_ID";

    public static String get() {
        return MDC.get(TRACE_ID);
    }

    public static void add(String value) {
        MDC.put(TRACE_ID, value);
    }
}
</code></pre>
<p>å½ç¶ï¼è¿ä¸ªä¾å­ä¸­æ²¡ææ¼ç¤ºMdcUtilç±»çaddæ¹æ³å·ä½è°çå°æ¹ï¼æä»¬å¯ä»¥å¨<code>filter</code>ä¸­æ§è¡æ¥å£æ¹æ³ä¹åï¼çætraceIdï¼è°ç¨MdcUtilç±»çaddæ¹æ³æ·»å å°MDCä¸­ï¼ç¶åå¨åä¸ä¸ªè¯·æ±çå¶ä»å°æ¹å°±è½éè¿MdcUtilç±»çgetæ¹æ³è·åå°è¯¥traceIdã</p>
<p>è½ä½¿ç¨MDCä¿å­traceIdç­åæ°çæ ¹æ¬åå æ¯ï¼ç¨æ·è¯·æ±å°åºç¨æå¡å¨ï¼<code>Tomcat</code>ä¼ä»çº¿ç¨æ± ä¸­åéä¸ä¸ªçº¿ç¨å»å¤çè¯¥è¯·æ±ã</p>
<p>é£ä¹è¯¥è¯·æ±çæ´ä¸ªè¿ç¨ä¸­ï¼ä¿å­å°<code>MDC</code>ç<code>ThreadLocal</code>ä¸­çåæ°ï¼ä¹æ¯è¯¥çº¿ç¨ç¬äº«çï¼æä»¥ä¸ä¼æçº¿ç¨å®å¨é®é¢ã</p>
<h2 id="9-æ¨¡æé«å¹¶å">9. æ¨¡æé«å¹¶å</h2>
<p>ææ¶åæä»¬åçæ¥å£ï¼å¨ä½å¹¶åçåºæ¯ä¸ï¼ä¸ç¹é®é¢é½æ²¡æã</p>
<p>ä½å¦æä¸æ¦åºç°é«å¹¶åè°ç¨ï¼è¯¥æ¥å£å¯è½ä¼åºç°ä¸äºææ³ä¸å°çé®é¢ã</p>
<p>ä¸ºäºé²æ­¢ç±»ä¼¼çäºæåçï¼ä¸è¬å¨é¡¹ç®ä¸çº¿åï¼æä»¬éå¸¸æå¿è¦å¯¹æ¥å£åä¸ä¸<code>ååæµè¯</code>ã</p>
<p>å½ç¶ï¼ç°å¨å·²ç»ææ¯è¾æççååæµè¯å·¥å·ï¼æ¯å¦ï¼<code>Jmeter</code>ã<code>LoadRunner</code>ç­ã</p>
<p>å¦æä½ è§å¾ä¸è½½åæµå·¥å·æ¯è¾éº»ç¦ï¼ä¹å¯ä»¥æåä¸ä¸ªç®åçæ¨¡æå¹¶åæä½çå·¥å·ï¼ç¨<code>CountDownLatch</code>å°±è½å®ç°ï¼ä¾å¦ï¼</p>
<pre><code class="language-java">public static void concurrenceTest() {
    /**
     * æ¨¡æé«å¹¶åæåµä»£ç 
     */
    final AtomicInteger atomicInteger = new AtomicInteger(0);
    final CountDownLatch countDownLatch = new CountDownLatch(1000); // ç¸å½äºè®¡æ°å¨ï¼å½ææé½åå¤å¥½äºï¼åä¸èµ·æ§è¡ï¼æ¨¡ä»¿å¤å¹¶åï¼ä¿è¯å¹¶åé
    final CountDownLatch countDownLatch2 = new CountDownLatch(1000); // ä¿è¯ææçº¿ç¨æ§è¡å®äºåæå°atomicIntegerçå¼
    ExecutorService executorService = Executors.newFixedThreadPool(10);
    try {
        for (int i = 0; i &lt; 1000; i++) {
            executorService.submit(new Runnable() {
                @Override
                public void run() {
                    try {
                        countDownLatch.await(); //ä¸ç´é»å¡å½åçº¿ç¨ï¼ç´å°è®¡æ¶å¨çå¼ä¸º0,ä¿è¯åæ¶å¹¶å
                    } catch (InterruptedException e) {
                        log.error(e.getMessage(),e);
                    }
                    //æ¯ä¸ªçº¿ç¨å¢å 1000æ¬¡ï¼æ¯æ¬¡å 1
                    for (int j = 0; j &lt; 1000; j++) {
                        atomicInteger.incrementAndGet();
                    }
                    countDownLatch2.countDown();
                }
            });
            countDownLatch.countDown();
        }

        countDownLatch2.await();// ä¿è¯ææçº¿ç¨æ§è¡å®
        executorService.shutdown();
    } catch (Exception e){
        log.error(e.getMessage(),e);
    }
}
</code></pre>
<h2 id="10-å¤çmqæ¶æ¯">10. å¤çmqæ¶æ¯</h2>
<p>å¨é«å¹¶åçåºæ¯ä¸­ï¼æ¶æ¯ç§¯åé®é¢ï¼å¯ä»¥è¯´å¦å½±éå½¢ï¼ççæ²¡åæ³ä»æ ¹æ¬ä¸è§£å³ãè¡¨é¢ä¸çï¼å·²ç»è§£å³äºï¼ä½åé¢ä¸ç¥éä»ä¹æ¶åï¼å°±ä¼ååºä¸æ¬¡ï¼æ¯å¦è¿æ¬¡ï¼</p>
<p>æå¤©ä¸åï¼äº§åè¿æ¥è¯´ï¼æå ä¸ªåæ·æè¯è¿æ¥äºï¼ä»ä»¬è¯´èåæå»¶è¿ï¼å¿«æ¥ä¸ä¸åå ã</p>
<p>è¿æ¬¡é®é¢åºç°å¾æç¹å¥æªã</p>
<p>ä¸ºä»ä¹è¿ä¹è¯´ï¼</p>
<p>é¦åè¿ä¸ªæ¶é´ç¹å°±æç¹å¥æªï¼å¹³å¸¸åºé®é¢ï¼ä¸é½æ¯ä¸­åæèæä¸ç¨é¤é«å³°æåï¼æä¹è¿æ¬¡é®é¢åºç°å¨ä¸åï¼</p>
<p>æ ¹æ®ä»¥å¾ç§¯ç´¯çç»éªï¼æç´æ¥çäº<code>kafka</code>ç<code>topic</code>çæ°æ®ï¼æç¶ä¸é¢æ¶æ¯æç§¯åï¼ä½è¿æ¬¡æ¯ä¸ª<code>partition</code>é½ç§¯åäºåå ä¸çæ¶æ¯æ²¡ææ¶è´¹ï¼æ¯ä»¥å¾å åçæ¶æ¯æ°éå¢å äºå ç¾åãè¿æ¬¡æ¶æ¯ç§¯åå¾æä¸å¯»å¸¸ã</p>
<p>æèµ¶ç´§æ¥æå¡çæ§ççæ¶è´¹èæäºæ²¡ï¼è¿å¥½æ²¡æãåæ¥æå¡æ¥å¿æ²¡æåç°å¼å¸¸ãè¿æ¶ææç¹è¿·è«ï¼ç¢°è¿æ°é®äºé®è®¢åç»ä¸ååçäºä»ä¹äºææ²¡ï¼ä»ä»¬è¯´ä¸åæä¸ªä¿éæ´»å¨ï¼è·äºä¸ä¸ª<code>JOB</code>æ¹éæ´æ°è¿æäºåæ·çè®¢åä¿¡æ¯ã</p>
<p>è¿æ¶ï¼æä¸ä¸å­å¦æ¢¦åéï¼æ¯ä»ä»¬å¨JOBä¸­æ¹éåæ¶æ¯å¯¼è´çé®é¢ãæä¹æ²¡æéç¥æä»¬å¢ï¼å®å¨å¤ªåäºã</p>
<p>è½è¯´ç¥éé®é¢çåå äºï¼åæ¯ç¼åç§¯åçè¿åå ä¸çæ¶æ¯è¯¥å¦ä½å¤çå¢ï¼</p>
<p>æ­¤æ¶ï¼å¦æç´æ¥è°å¤§<code>partition</code>æ°éæ¯ä¸è¡çï¼åå²æ¶æ¯å·²ç»å­å¨å°<code>4</code>ä¸ªåºå®çpartitionï¼åªææ°å¢çæ¶æ¯æä¼å°æ°çpartitionãæä»¬éç¹éè¦å¤ççæ¯å·²æçpartitionã</p>
<p>ç´æ¥å æå¡èç¹ä¹ä¸è¡ï¼å ä¸º<code>kafka</code>åè®¸åç»çå¤ä¸ª<code>partition</code>è¢«ä¸ä¸ª<code>consumer</code>æ¶è´¹ï¼ä½ä¸åè®¸ä¸ä¸ªpartitionè¢«åç»çå¤ä¸ªconsumeræ¶è´¹ï¼å¯è½ä¼é æèµæºæµªè´¹ã</p>
<p>çæ¥åªæç¨<code>å¤çº¿ç¨</code>å¤çäºã</p>
<p>ä¸ºäºç´§æ¥è§£å³é®é¢ï¼ææ¹æäºç¨çº¿ç¨æ± å¤çæ¶æ¯ï¼æ ¸å¿çº¿ç¨åæå¤§çº¿ç¨æ°é½éç½®æäº<code>50</code>ã</p>
<p>å¤§è´ç¨æ³å¦ä¸ï¼</p>
<ol>
<li>åå®ä¹ä¸ä¸ªçº¿ç¨æ± ï¼</li>
</ol>
<pre><code class="language-java">@Configuration
public class ThreadPoolConfig {

    @Value("${thread.pool.corePoolSize:5}")
    private int corePoolSize;

    @Value("${thread.pool.maxPoolSize:10}")
    private int maxPoolSize;

    @Value("${thread.pool.queueCapacity:200}")
    private int queueCapacity;

    @Value("${thread.pool.keepAliveSeconds:30}")
    private int keepAliveSeconds;

    @Value("${thread.pool.threadNamePrefix:ASYNC_}")
    private String threadNamePrefix;

    @Bean("messageExecutor")
    public Executor messageExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(corePoolSize);
        executor.setMaxPoolSize(maxPoolSize);
        executor.setQueueCapacity(queueCapacity);
        executor.setKeepAliveSeconds(keepAliveSeconds);
        executor.setThreadNamePrefix(threadNamePrefix);
        executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());
        executor.initialize();
        return executor;
    }
}
</code></pre>
<ol start="2">
<li>åå®ä¹ä¸ä¸ªæ¶æ¯çconsumerï¼</li>
</ol>
<pre><code class="language-java">@Service
public class MyConsumerService {
    @Autowired
    private Executor messageExecutor;
    
    @KafkaListener(id="test",topics={"topic-test"})
    public void listen(String message){
        System.out.println("æ¶å°æ¶æ¯ï¼" + message);
        messageExecutor.submit(new MyWork(message);
    }
}
</code></pre>
<ol start="3">
<li>å¨å®ä¹çRunableå®ç°ç±»ä¸­å¤çä¸å¡é»è¾ï¼</li>
</ol>
<pre><code class="language-java">public class MyWork implements Runnable {
    private String message;
    
    public MyWork(String message) {
       this.message = message;
    }

    @Override
    public void run() {
        System.out.println(message);
    }
}
</code></pre>
<p>æç¶ï¼è°æ´ä¹åæ¶æ¯ç§¯åæ°éç¡®å®ä¸éçéå¸¸å¿«ï¼å¤§çº¦åå°æ¶åï¼ç§¯åçæ¶æ¯å°±éå¸¸é¡ºå©çå¤çå®äºã</p>
<p>ä½æ­¤æ¶æä¸ªæ´ä¸¥éçé®é¢åºç°ï¼ææ¶å°äºæ¥è­¦é®ä»¶ï¼æä¸¤ä¸ªè®¢åç³»ç»çèç¹downæºäºããã</p>
<p>æ´è¯¦ç»åå®¹ï¼è¯·ççæçå¦ä¸ç¯æç« ã<a href="https://mp.weixin.qq.com/s?__biz=MzkwNjMwMTgzMQ==&amp;mid=2247490289&amp;idx=1&amp;sn=bc311da9f4a4d3f48ee5dc207bf31a8b&amp;chksm=c0ebc219f79c4b0fc711116723b9df3a5531cda32f0f5d00f065910aa552af6ff03b3f1528fc&amp;token=751314179&amp;lang=zh_CN&amp;scene=21#wechat_redirect" target="_blank" rel="noopener nofollow">æç¨kafkaä¸¤å¹´è¸©è¿çä¸äºéæ¯å¯»å¸¸çå</a>ã</p>
<h2 id="11-ç»è®¡æ°é">11. ç»è®¡æ°é</h2>
<p>å¨å¤çº¿ç¨çåºæ¯ä¸­ï¼ææ¶åéè¦ç»è®¡æ°éï¼æ¯å¦ï¼ç¨å¤çº¿ç¨å¯¼å¥ä¾åºåæ°æ®æ¶ï¼ç»è®¡å¯¼å¥æåçä¾åºåæ°æå¤å°ã</p>
<p>å¦æè¿æ¶åç¨count++ç»è®¡æ¬¡æ°ï¼æç»çç»æå¯è½ä¼ä¸åãå ä¸ºcount++å¹¶éåå­æä½ï¼å¦æå¤ä¸ªçº¿ç¨åæ¶æ§è¡è¯¥æä½ï¼åç»è®¡çæ¬¡æ°ï¼å¯è½ä¼åºç°å¼å¸¸ã</p>
<p>ä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼å°±éè¦ä½¿ç¨<code>concurent</code>ç<code>atomic</code>åä¸é¢çç±»ï¼æ¯å¦ï¼<code>AtomicInteger</code>ã<code>AtomicLong</code>ç­ã</p>
<pre><code class="language-java">@Servcie
public class ImportSupplierService {
  private static AtomicInteger count = new AtomicInteger(0);

  public int importSupplier(List&lt;SupplierInfo&gt; supplierList) {
       if(CollectionUtils.isEmpty(supplierList)) {
           return 0;
       }

       supplierList.parallelStream().forEach(x -&gt; {
           try {
             importSupplier(x);
             count.addAndGet(1);
           } catch(Exception e) {
              log.error(e.getMessage(),e);
           }
       );

      return count.get();
  }    
}
</code></pre>
<p><code>AtomicInteger</code>çåºå±è¯´ç½äºä½¿ç¨<code>èªæé</code>+<code>CAS</code>ã</p>
<pre><code class="language-java">public final int incrementAndGet() {
    for (;;) {
        int current = get();
        int next = current + 1;
        if (compareAndSet(current, next))
            return next;
    }
}
</code></pre>
<p><code>èªæé</code>è¯´ç½äºå°±æ¯ä¸ä¸ª<code>æ­»å¾ªç¯</code>ã</p>
<p>è<code>CAS</code>æ¯<code>æ¯è¾</code>å<code>äº¤æ¢</code>çææã</p>
<p>å®çå®ç°é»è¾æ¯ï¼å°åå­ä½ç½®å¤ç<code>æ§å¼</code>ä¸<code>é¢æå¼</code>è¿è¡æ¯è¾ï¼è¥ç¸ç­ï¼åå°åå­ä½ç½®å¤çå¼æ¿æ¢ä¸º<code>æ°å¼</code>ãè¥ä¸ç¸ç­ï¼åä¸åä»»ä½æä½ã</p>
<h2 id="12-å»¶è¿å®æ¶ä»»å¡">12. å»¶è¿å®æ¶ä»»å¡</h2>
<p>æä»¬ç»å¸¸æå»¶è¿å¤çæ°æ®çéæ±ï¼æ¯å¦ï¼å¦æç¨æ·ä¸ååï¼è¶è¿30åéè¿æªå®ææ¯ä»ï¼åç³»ç»èªå¨å°è¯¥è®¢ååæ¶ã</p>
<p>è¿ééæ±å°±å¯ä»¥ä½¿ç¨<code>å»¶è¿å®æ¶ä»»å¡</code>å®ç°ã</p>
<p><code>ScheduledExecutorService</code>æ¯<code>JDK1.5+</code>çæ¬å¼è¿çå®æ¶ä»»å¡ï¼è¯¥ç±»ä½äº<code>java.util.concurrent</code>å¹¶ååä¸ã</p>
<p>ScheduledExecutorServiceæ¯åºäºå¤çº¿ç¨çï¼è®¾è®¡çåè¡·æ¯ä¸ºäºè§£å³<code>Timer</code>åçº¿ç¨æ§è¡ï¼å¤ä¸ªä»»å¡ä¹é´ä¼äºç¸å½±åçé®é¢ã</p>
<p>å®ä¸»è¦åå«4ä¸ªæ¹æ³ï¼</p>
<ul>
<li>schedule(Runnable command,long delay,TimeUnit unit)ï¼å¸¦å»¶è¿æ¶é´çè°åº¦ï¼åªæ§è¡ä¸æ¬¡ï¼è°åº¦ä¹åå¯éè¿Future.get()é»å¡ç´è³ä»»å¡æ§è¡å®æ¯ã</li>
<li>schedule(Callable<v> callable,long delay,TimeUnit unit)ï¼å¸¦å»¶è¿æ¶é´çè°åº¦ï¼åªæ§è¡ä¸æ¬¡ï¼è°åº¦ä¹åå¯éè¿Future.get()é»å¡ç´è³ä»»å¡æ§è¡å®æ¯ï¼å¹¶ä¸å¯ä»¥è·åæ§è¡ç»æã</v></li>
<li>scheduleAtFixedRateï¼è¡¨ç¤ºä»¥åºå®é¢çæ§è¡çä»»å¡ï¼å¦æå½åä»»å¡èæ¶è¾å¤ï¼è¶è¿å®æ¶å¨æperiodï¼åå½åä»»å¡ç»æåä¼ç«å³æ§è¡ã</li>
<li>scheduleWithFixedDelayï¼è¡¨ç¤ºä»¥åºå®å»¶æ¶æ§è¡ä»»å¡ï¼å»¶æ¶æ¯ç¸å¯¹å½åä»»å¡ç»æä¸ºèµ·ç¹è®¡ç®å¼å§æ¶é´ã</li>
</ul>
<p>å®ç°è¿ç§å®æ¶ä»»å¡çå·ä½ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-java">public class ScheduleExecutorTest {

    public static void main(String[] args) {
        ScheduledExecutorService scheduledExecutorService = Executors.newScheduledThreadPool(5);
        scheduledExecutorService.scheduleAtFixedRate(() -&gt; {
            System.out.println("doSomething");
        },1000,1000, TimeUnit.MILLISECONDS);
    }
}
</code></pre>
<p>è°ç¨<code>ScheduledExecutorService</code>ç±»ç<code>scheduleAtFixedRate</code>æ¹æ³å®ç°å¨ææ§ä»»å¡ï¼æ¯é1ç§éæ§è¡ä¸æ¬¡ï¼æ¯æ¬¡å»¶è¿1ç§åæ§è¡ã</p>
<p>è¿ç§å®æ¶ä»»å¡æ¯é¿éå·´å·´å¼åèè§èä¸­ç¨æ¥æ¿ä»£<code>Timer</code>ç±»çæ¹æ¡ï¼å¯¹äºå¤çº¿ç¨æ§è¡å¨ææ§ä»»å¡ï¼æ¯ä¸ªä¸éçéæ©ã</p>
<p>ä½¿ç¨<code>ScheduledExecutorService</code>ç±»åå»¶è¿å®æ¶ä»»å¡çä¼ç¼ºç¹ï¼</p>
<ul>
<li>
<p>ä¼ç¹ï¼åºäºå¤çº¿ç¨çå®æ¶ä»»å¡ï¼å¤ä¸ªä»»å¡ä¹é´ä¸ä¼ç¸å³å½±åï¼æ¯æå¨ææ§çæ§è¡ä»»å¡ï¼å¹¶ä¸å¸¦å»¶è¿åè½ã</p>
</li>
<li>
<p>ç¼ºç¹ï¼ä¸æ¯æä¸äºè¾å¤æçå®æ¶è§åã</p>
</li>
</ul>
<p>å½ç¶ï¼ä½ ä¹å¯ä»¥ä½¿ç¨åå¸å¼å®æ¶ä»»å¡ï¼æ¯å¦ï¼xxl-jobæèelastic-jobç­ç­ã</p>
<p>å¶å®ï¼å¨å®éå·¥ä½ä¸­æä½¿ç¨å¤çº¿ç¨çåºæ¯è¿è¿ä¸åªè¿12ç§ï¼å¨è¿éåªæ¯æç å¼çï¼ä»ç»äºä¸äºæè®¤ä¸ºæ¯è¾å¸¸è§çä¸å¡åºæ¯ã</p>
<p>æ­¤å¤ï¼å¦æä½ å¯¹å¹¶åç¼ç¨ä¸­çä¸äºåï¼æ¯è¾æå´è¶£çè¯ï¼å¯ä»¥ççæçå¦ä¸ä¸ªæç« ã<a href="https://mp.weixin.qq.com/s?__biz=MzkwNjMwMTgzMQ==&amp;mid=2247492962&amp;idx=1&amp;sn=17ed1d2ed950b4e9160218b296d19d4e&amp;chksm=c0e83d8af79fb49cc72fcafc8ed62822263106e54675ea8406a2e3daadb44e25364275af9082&amp;token=245805875&amp;lang=zh_CN#rd" target="_blank" rel="noopener nofollow">èèå¹¶åç¼ç¨ç10ä¸ªå</a>ãï¼éé¢åçéå¸¸è¯¦ç»ã</p>
<h2 id="æåè¯´ä¸å¥æ±å³æ³¨å«ç½å«æ">æåè¯´ä¸å¥(æ±å³æ³¨ï¼å«ç½å«æ)</h2>
<p>å¦æè¿ç¯æç« å¯¹æ¨ææå¸®å©ï¼æèææå¯åçè¯ï¼å¸®å¿å³æ³¨ä¸ä¸æçååå¬ä¼å·ï¼èä¸è¯´ææ¯ï¼æ¨çæ¯ææ¯æåæåä½æå¤§çå¨åã</p>
<p>æ±ä¸é®ä¸è¿ï¼ç¹èµãè½¬åãå¨çã</p>
<p>å³æ³¨å¬ä¼å·ï¼ãèä¸è¯´ææ¯ãï¼å¨å¬ä¼å·ä¸­åå¤ï¼è¿å¤§åï¼å¯ä»¥åè´¹è·åææè¿æ´çç10ä¸å­çé¢è¯å®å¸ï¼å¥½å¤å°ä¼ä¼´é è¿ä¸ªå®å¸æ¿å°äºå¤å®¶å¤§åçofferã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-22 16:09">2026-01-22 16:09</span>&nbsp;
<a href="https://www.cnblogs.com/12lisu">èä¸è¯´ææ¯</a>&nbsp;
éè¯»(<span id="post_view_count">150</span>)&nbsp;
è¯è®º(<span id="post_comment_count">2</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19517803);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19517803', targetLink: 'https://www.cnblogs.com/12lisu/p/19517803', title: 'å¤çº¿ç¨çè¿12ç§ç¨éï¼99%çäººä¸ç¥éï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ SEALå¨åæå å¯BFVæ¹æ¡å¥é¨è¯¦è§£ ]]></title>
    <link>https://www.cnblogs.com/zhaoweiwei/p/19510487/bfv</link>
    <guid>5df73e2cabdcf50c9deafcd0340c8dcb</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/zhaoweiwei/p/19510487/bfv" title="åå¸äº 2026-01-22 15:50">
    <span role="heading" aria-level="2">SEALå¨åæå å¯BFVæ¹æ¡å¥é¨è¯¦è§£</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ¬æä»ç»å¾®è½¯çå¼æºå¨åæé¡¹ç®SEALä¸­BFVæ¹æ¡çç¸å³æ°å­¦çè®ºåºç¡ï¼ä»¥åç¸åºå è§£å¯çä¸»è¦æµç¨ï¼æåç®åå°ä»ç»äºSEALæºç çç¼è¯è¿ç¨åç®ååºç¨ç¤ºä¾ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>Microsoft SEALï¼Simple Encrypted Arithmetic Libraryï¼æ¯å¾®è½¯å¼æºçè½»éçº§ãé«æ§è½å¨åæå å¯ï¼FHEï¼åºï¼ä¸ä¸ºæ´æ°/æµ®ç¹æ°çå¯æè¿ç®è®¾è®¡ï¼æ¯æBFVãCKKSãBGVç­ä¸»æµFHEæ¹æ¡ï¼å¹¿æ³åºç¨äºéç§è®¡ç®ãèé¦å­¦ä¹ ãæ°æ®å å¯ç­åºæ¯ï¼æºç ï¼<a href="https://github.com/microsoft/SEAL" target="_blank" rel="noopener nofollow">https://github.com/microsoft/SEAL</a>ã</p>
<h1>1 æ°å­¦åºç¡</h1>
<h2>1.1 å¤é¡¹å¼ç¯</h2>
<p>SEALä½¿ç¨çåºç¡ç¯æ¯ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260121153443048-88951557.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p align="left">BFVçææè¿ç®é½å¨è¿ä¸ªå¤é¡¹å¼ç¯ä¸­è¿è¡ï¼ç¬¦å·å«ä¹å¦ä¸ï¼</p>
<p align="left">Z<sub>q</sub>ï¼ç³»æ°åï¼å³å¤é¡¹å¼çææç³»æ°é½åèªâæ¨¡qçæ´æ°éåâï¼qç§°ä¸ºç³»æ°æ¨¡æ°ï¼ä¸ä¸ªå¤§ç´ æ°æå¤ä¸ªç´ æ°çä¹ç§¯ï¼ï¼å³å®å¯æçåªå£°å®¹å¿åº¦åè¿ç®æ·±åº¦ã</p>
<p align="left">x<sup>N</sup>+1ï¼å¤é¡¹å¼æ¨¡ï¼è¦æ±Næ¯2çæ´æ°å¹ï¼å¦4096ã8192ï¼ï¼æ»¡è¶³x<sup>N</sup>â¡-1 (mod x<sup>N</sup>+1)ï¼è¿æå³çææå¤é¡¹å¼çæ¬¡æ°é½ä¸ä¼è¶è¿N-1ï¼è¶è¿çé¡¹å¯éè¿x<sup>N</sup> = -1éæ¬¡ï¼ã</p>
<p align="left">R<sub>q</sub>åç´ å½¢å¼ï¼ä»»æåç´ æ¯ä¸ä¸ªæ¬¡æ°â¤ N - 1çå¤é¡¹å¼ï¼å½¢å¦ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260121154506434-1453063209.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>&nbsp;</p>
<h2>1.2 ææç©ºé´</h2>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260121155707555-629451098.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>ææï¼å¾å å¯çæ´æ°ï¼ä¼è¢«ç¼ç ä¸ºR<sub>t</sub>ä¸­çå¤é¡¹å¼ï¼tæ»¡è¶³tâ¡1 (mod 2N)ï¼è¿æ¯æ¹éå å¯çç¡¬æ§è¦æ±ï¼ææå¨è¿è¡å å¯åè¦è¿è¡ç¼ç ï¼æä¸¤ç§ç¼ç æ¹å¼ï¼</p>
<p><strong>åæ´æ°ç¼ç </strong>ï¼å°åä¸ªæ´æ°mç¼ç ä¸ºå¸¸æ°å¤é¡¹å¼f(x)=mï¼å³ææé«æ¬¡é¡¹ç³»æ°ä¸º0ã</p>
<p><strong>æ¹éç¼ç </strong>ï¼å°Nä¸ªå°æ´æ°[m<sub>0</sub>,m<sub>1</sub>,...,m<sub>N-1</sub>]ç´æ¥åä¸ºå¤é¡¹å¼çç³»æ°ï¼ç¼ç ä¸ºï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260121160312132-985918846.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<h2>1.3 RLWEé®é¢</h2>
<p align="left">BFVçå®å¨æ§åºäºRLWEé®é¢ï¼Ring Learning With Errorsï¼çè®¡ç®å°é¾æ§ï¼ç®åæè¿°ä¸ºï¼</p>
<p align="left">ç»å®å¤é¡¹å¼R<sub>q</sub>ï¼éæ©ä¸ä¸ªç§å¯å¤é¡¹å¼s(x)âR<sub>q</sub>ï¼ç³»æ°ä¸º0/1çç­å¤é¡¹å¼ï¼ï¼ä»¥åå¤§éçâåªå£°å¤é¡¹å¼å¯¹âï¼a<sub>i</sub>(x), b<sub>i</sub>(x)ï¼ï¼å¶ä¸­a<sub>i</sub>(x)æ¯éæºçæçï¼b<sub>i</sub>(x)=-a<sub>i</sub>(x)s(x)+e<sub>i</sub>(x) (mod q)æ¯éè¿ç§å¯å¤é¡¹å¼s(x)è®¡ç®å¾å°çâååºå¤é¡¹å¼âï¼å å¥åªå£°e<sub>i</sub>(x)æ¯ä¸ºäºè®©b<sub>i</sub>(x)çèµ·æ¥åä¸ä¸ªå®å¨éæºçå¤é¡¹å¼ï¼ä»èéès(x)çå­å¨ï¼èå¨è®¡ç®ä¸æ æ³ä»è¿äºå¤é¡¹å¼å¯¹ä¸­æ¢å¤åºç§å¯å¤é¡¹å¼s(x)ãå¯¹äºb<sub>i</sub>(x)å¶çææ¶æ¯ä¸é¨åçä½ç¨å¦ä¸ï¼</p>
<p align="left">a<sub>i</sub>(x)ï¼ä»å¤é¡¹å¼ç¯R<sub>q</sub>ä¸­ååéæºçæçå¤é¡¹å¼ï¼ç¸å½äºâå¬å±è¾å¥âï¼å¯ä»¥å¬å¼ã</p>
<p align="left">s(x)ï¼ç§å¯å¤é¡¹å¼ï¼ç³»æ°ä»ä¸º0æ1ï¼ï¼æ¯æ´ä¸ªRLWEé®é¢çæ ¸å¿ï¼å¿é¡»ä¸¥æ ¼ä¿å¯ã</p>
<p align="left">e<sub>i</sub>(x)ï¼å°ç³»æ°åªå£°å¤é¡¹å¼ï¼ç³»æ°ä»ä¸º-1ã0ã1ï¼ï¼æ¯âéèç§å¯âçå³é®ã</p>
<p align="left">b<sub>i</sub>(x)ï¼ç±a<sub>i</sub>(x)s(x)å ä¸åªå£°å¾å°çç»æï¼ä¸ai(x)ä¸èµ·ææå¬å¼çâå¤é¡¹å¼å¯¹âã</p>
<p align="left">å¦ææ²¡æåªå£°e<sub>i</sub>(x)ï¼å³e<sub>i</sub>(x)=0ï¼é£ä¹b<sub>i</sub>(x)=-a<sub>i</sub>(x)s(x) (mod q)ï¼æ­¤æ¶æ»å»èå¯ä»¥éè¿å¤ç»(a<sub>i</sub>(x), b<sub>i</sub>(x))æå»ºçº¿æ§æ¹ç¨ç»ï¼ç´æ¥è§£å¯åºç§å¯å¤é¡¹å¼s(x)ï¼è¿å°±å®å¨å¤±å»äºå®å¨æ§ãèå å¥å°åªå£°e<sub>i</sub>(x)åï¼</p>
<p align="left">b<sub>i</sub>(x)ä¸åæ¯a<sub>i</sub>(x)s(x)çç²¾ç¡®ç»æï¼èæ¯ä¸ä¸ªâè¿ä¼¼å¼âï¼</p>
<p align="left">è¿ä¸ªè¿ä¼¼å¼çè¯¯å·®è¢«æ§å¶å¨å¾å°çèå´åï¼ç±e<sub>i</sub>(x)çç³»æ°å¤§å°å³å®ï¼ï¼</p>
<p align="left">ä»è®¡ç®è§åº¦ï¼ç®åæ²¡æä»»ä½ç®æ³ï¼åæ¬éå­ç®æ³ï¼è½é«æå°ä»è¿äºå¸¦åªå£°çè¿ä¼¼ç»æä¸­æ¢å¤åºs(x)ï¼è¿æ­£æ¯RLWEé®é¢çâè®¡ç®å°é¾æ§âæ¥æºï¼ä¹æ¯BFVéååéå­ç§å¯åºæ¯çåå ã</p>
<h2>1.4 ç¼©æ¾å å­</h2>
<p>å¨BFVåæå å¯æ¹æ¡ä¸­ï¼ç¼©æ¾å å­ï¼Scaling Factorï¼æ¯è¿æ¥ææç©ºé´ï¼Z<sub>t</sub>ï¼åå¯æç©ºé´ï¼Z<sub>q</sub>ï¼çæ ¸å¿ç³»æ°ï¼æ¬è´¨æ¯ä¸ºäºè®©ææå¤é¡¹å¼è½âééâç³»æ°æ¨¡æ°qçèå´ï¼åæ¶ä¿è¯è§£å¯æ¶å¯ä»¥ç²¾ç¡®è¿åææãBFVçæææ¨¡æ°tè¿å°äºç³»æ°æ¨¡æ°qï¼t&lt;&lt;q)ï¼æ¯å¦t=65537ï¼q=2<sup>60</sup>éçº§ã</p>
<p>ææå¤é¡¹å¼m(x)âR<sub>t</sub>çç³»æ°èå´æ¯[0, t-1]ï¼èå¯æå¤é¡¹å¼c(x)âR<sub>q</sub>çç³»æ°èå´æ¯[0, q-1]ï¼å¦æç´æ¥å°ææm(x)æ¾å¥å¯æå¬å¼ï¼ç±äºtå¤ªå°ï¼ææä¿¡æ¯ä¼è¢«åªå£°åæ©ç å®å¨æ·¹æ²¡ï¼æ æ³è§£å¯ãå æ­¤éè¦ä¸ä¸ªç¼©æ¾å å­ï¼å°ææç³»æ°æ¾å¤§å°qçéçº§ï¼ååä¸å¯æè®¡ç®ãç¼©æ¾å å­è´¯ç©¿å å¯åè§£å¯ä¸¤ä¸ªæ ¸å¿æ­¥éª¤ï¼æ¯ææåå¯æçâæ¡¥æ¢âã</p>
<p>ï¼1ï¼å å¯æ¶ï¼æææ¾å¤§</p>
<p>å¨å å¯æ­¥éª¤ä¸­ï¼ææå¤é¡¹å¼m(x)ä¸ä¼ç´æ¥ä»£å¥å¯æå¬å¼ï¼èæ¯åä¹äºç¼©æ¾å å­Îï¼åæ¾å¥å°å¬å¼ï¼</p>
<p>&nbsp;</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260122103147623-1899019256.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>ä½ç¨ï¼å°ææç³»æ°ä»[0, t-1]æ¾å¤§å°[0,&nbsp;Î*(t-1)]ï¼è¿ä¸ªèå´å¨qçéçº§åï¼è½é¿åææè¢«åªå£°è¦çã</p>
<p>ï¼2ï¼è§£å¯æ¶ï¼ææç¼©å°</p>
<p>è§£å¯çæ ¸å¿æ­¥éª¤æ¯åè®¡ç®èåå¤é¡¹å¼D(ct)ï¼ä»£å¥å å¯å¬å¼åå¯å¾ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260122103532065-202805649.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>æ­¤æ¶éè¦ååç¼©æ¾æ¥è¿åææï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260122103637412-765250880.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>æ¦æ¬æ¥è¯´ï¼ç¼©æ¾å å­ä¸ä¼ç´æ¥åä¸è¿ç®ï¼ä½ä¼é´æ¥å½±ååªå£°çå¢é¿éåº¦ï¼</p>
<p align="left">1) å æ³è¿ç®ï¼å¯æå æ³æ¯ç³»æ°ç´æ¥ç¸å ï¼åªå£°çº¿æ§å å ï¼ç¼©æ¾å å­ä¸å½±ååªå£°å¢é¿ï¼</p>
<p align="left">2) ä¹æ³è¿ç®ï¼å¯æä¹æ³æ¯å¤é¡¹å¼ä¹æ³ï¼åªå£°ä¼å¹³æ¹å¢é¿ï¼èç¼©æ¾å å­Îè¶å¤§ï¼åªå£°çè§æ¨¡ä¹ä¼è¶å¤§ï¼å¯¼è´è¿ç®æ·±åº¦éä½ã</p>
<p align="left">å æ­¤ï¼å¨åæ°éç½®æ¶ï¼éè¦å¨âææèå´ï¼tå¤§å°ï¼âåâè¿ç®æ·±åº¦ï¼qå¤§å°ï¼âä¹é´åæè¡¡ï¼</p>
<p align="left">è¥tå¢å¤§âÎåå°âåªå£°å®¹å¿åº¦æåâè¿ç®æ·±åº¦å¢å ï¼</p>
<p align="left">è¥tåå°âÎå¢å¤§âåªå£°å®¹å¿åº¦éä½âè¿ç®æ·±åº¦åå°ã</p>
<p align="left">æä»¥tä¸Îæåæ¯ï¼éæ ¹æ®ä¸å¡éæ±å¹³è¡¡ææèå´åè¿ç®æ·±åº¦ã</p>
<h1>2 BFVæ ¸å¿æµç¨</h1>
<h2>2.1 åæ°éç½®</h2>
<p>åæ°éç½®å³å®æ¹æ¡çæ§è½ä¸å®å¨æ§ï¼BFVæ ¸å¿åæ°æ4ä¸ªï¼éä¸¥æ ¼æ»¡è¶³æ°å­¦çº¦æï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260121155055832-1091265286.png" alt="image" width="798" height="249" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>åæ°çº¦æï¼éæ»¡è¶³q&gt;t*(2N)<sup>d</sup>*Bï¼dæ¯ç®æ è¿ç®æ·±åº¦ï¼Bæ¯åªå£°ä¸éï¼ï¼å¦åè¿ç®è¿ç¨ä¸­åªå£°ä¼âçç¸âå¯¼è´è§£å¯å¤±è´¥ã</p>
<h2>2.2 å¯é¥çæ</h2>
<p>åºäºRLWEé®é¢çæç§é¥ãå¬é¥ãéçº¿æ§åå¯é¥3ä¸­å¯é¥ï¼æ ¸å¿æ¯æé å«åªå£°çå¤é¡¹å¼å¯¹ã</p>
<p>ï¼1ï¼ç§é¥ï¼skï¼</p>
<p>éæºçæä¸ä¸ªç­å¤é¡¹å¼s(x)âR<sub>q</sub>ï¼ç³»æ°ä»ä¸º0æ1ï¼å¦s(x) = 1 + x<sup>2</sup> + x<sup>5</sup>ï¼ï¼ç§é¥å°±æ¯s(x)ã</p>
<p>ï¼2ï¼å¬é¥ï¼pkï¼</p>
<p>éæºçæå¤é¡¹å¼a(x)âR<sub>q</sub>ï¼çæå°å¸æ°åªå£°å¤é¡¹å¼e(x)âR<sub>q</sub>ï¼è®¡ç®b(x) = -a(x)s(x) + e(x) (mod q)ï¼å¬é¥æ¯å¤é¡¹å¼å¯¹pk = (b(x), a(x))ï¼å¯å¬å¼ä¼ æ­ãè¿éçåªå£°e(x)è®©æ»å»èæ æ³ä»å¬é¥å¯¹ä¸­æ¢å¤ç§é¥s(x)ï¼ç®çæ¯è§£å³âå¬é¥æ¬èº«çå®å¨æ§âã</p>
<p>ï¼3ï¼éçº¿æ§åå¯é¥ï¼rlkï¼</p>
<p>å¯æä¹æ³ä¼å¯¼è´å¯æä»â2é¡¹å¤é¡¹å¼âè¨èä¸ºâ3é¡¹å¤é¡¹å¼âï¼åç»­è¿ç®æçéª¤éãéçº¿æ§åå¯é¥ç¨äºå°è¨èåçå¯æåç¼©å2é¡¹ï¼çæé»è¾ä¸å¬é¥ç±»ä¼¼ï¼æ¬è´¨æ¯ä¸ç»æ©å±çRLWEå¤é¡¹å¼å¯¹ã</p>
<h2>2.3 å å¯</h2>
<p>å°ææå¤é¡¹å¼è½¬ä¸ºå¯æå¤é¡¹å¼ï¼BFVçå¯ææ¯R<sub>q</sub>ä¸­ç2é¡¹å¤é¡¹å¼å¯¹ct = (c<sub>0</sub>(x), c<sub>1</sub>(x))ï¼å å¯è¿ç¨åä¸¤æ­¥ï¼</p>
<p>ï¼1ï¼ææç¼ç ï¼å°æ´æ°ææmç¼ç ä¸ºææå¤é¡¹å¼m(x)âR<sub>t</sub>ï¼</p>
<p>ï¼2ï¼æ·»å åªå£°ä¸æ··æ·ï¼</p>
<p>éæºçæä¸¤ä¸ªå°åªå£°å¤é¡¹å¼e<sub>0</sub>(x),e<sub>1</sub>(x)âR<sub>q</sub>ï¼éæºçæä¸ä¸ªâæ©ç å¤é¡¹å¼âu(x)âR<sub>q</sub>ï¼ç³»æ°ä¸º0/1ï¼ï¼è®¡ç®å¯æï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260122101343624-1971179879.png" alt="image" width="506" height="72" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>æ ¸å¿è®¾è®¡ï¼å¯æä¸­åå«ææä¿¡æ¯m(x)ï¼ä½è¢«åªå£°e<sub>0</sub>/e<sub>1</sub>åæ©ç u(x)æ··æ·ï¼åªæç§é¥è½å»é¤æ··æ·ååªå£°ãè¯¥æ­¥éª¤ä¸­çæ©ç å¤é¡¹å¼u(x)ååªå£°å¤é¡¹å¼e<sub>0</sub>(x),e<sub>1</sub>(x)æ¯ä¸¤å¥ç¬ç«çå®å¨æºå¶ï¼å®ä»¬è§£å³çæ¯å®å¨ä¸åçé®é¢ï¼ä¸è½äºç¸æ¿ä»£ï¼å¦ä¸å¾ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260122145538684-995418377.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>u(x)éè¿éæºç¼©æ¾å®ç°å¬é¥åææé´çéåºå®çº¿æ§å³ç³»ï¼åªå£°éè¿âè¿ä¼¼âè¿ä¸æ­¥æç ´å®ä»¬ä¹é´ç²¾ç¡®çä»£æ°å³ç³»ï¼ä½¿å¾æ»å»èæ æ³ä»è¿ä¼¼å¼ä¸­è¿åç²¾ç¡®ææã</p>
<h2>2.4 åæè¿ç®</h2>
<p>è¿æ­¥çæ ¸å¿æ¯ï¼å¯æè¿ç®=å¤é¡¹å¼ç¯è¿ç®ï¼BFVæ¯æç§å¯&amp;å¯æï¼Ct&amp;Ctï¼åå¯æ&amp;ææï¼Ct&amp;Ptï¼çå åä¹è¿ç®ï¼ææè¿ç®é½å¨å¤é¡¹å¼ç¯R<sub>q</sub>ä¸­è¿è¡ï¼ä¸æ éå¯é¥ã</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260122102234951-828568152.png" alt="image" width="925" height="252" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>è¿ç®åçå¯æä»ç¶æ¯åæ³çRLWEå¯æï¼å¯ç»§ç»­åä¸åç»­è¿ç®ââè¿å°±æ¯ãåææ§ãçä½ç°ã</p>
<h2>2.5 è§£å¯</h2>
<p>è§£å¯æ¯å å¯çéè¿ç®ï¼æ ¸å¿æ¯å»é¤åªå£°ãè¿åææå¤é¡¹å¼ï¼æ­¥éª¤å¦ä¸ï¼</p>
<p>ï¼1ï¼å¯æèå</p>
<p>ç¨ç§é¥s(x)è®¡ç®èåå¤é¡¹å¼ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260122102616840-333286614.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>ä»£å¥å å¯å¬å¼å¯æ¨å¯¼ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260122102653366-486423113.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>ï¼2ï¼åªå£°å»é¤</p>
<p>ç±äºæ»åªå£°e<sub>total</sub>&lt;q/(2t)ï¼å¯éè¿âèå¥+æ¨¡è¿ç®âè¿åææï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260122102808245-1880527419.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto">ï¼3ï¼ææè§£ç </p>
<p>å°è§£å¯åçå¤é¡¹å¼m(x)è½¬æ¢åæ´æ°ï¼åæ´æ°åå¸¸æ°é¡¹ï¼æ¹éå å¯åææç³»æ°ï¼ã</p>
<p>è§£å¯æåæ¡ä»¶ï¼æ»åªå£°e<sub>total</sub>&lt;q/(2t)ï¼è¥è¿ç®æ¬¡æ°è¿å¤å¯¼è´åªå£°çç¸ï¼èå¥åæ æ³è¿åææï¼åä¼è§£å¯å¤±è´¥ââè¿æ¯BFVâå±æ¬¡æ§âçæ¬è´¨ï¼è¿ç®æ·±åº¦æéã</p>
<h2>2.6 pythonç¤ºä¾</h2>
<p>ä»¥ä¸æ¯ä¸ä¸ªå®æ´çpythonç¤ºä¾ç¨åºï¼</p>
<div class="cnblogs_code"><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" id="code_img_closed_09b97ffc-eef3-46ba-bb50-d1e4cf620627" class="code_img_closed"><img src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" id="code_img_opened_09b97ffc-eef3-46ba-bb50-d1e4cf620627" class="code_img_opened" style="display: none">
<div id="cnblogs_code_open_09b97ffc-eef3-46ba-bb50-d1e4cf620627" class="cnblogs_code_hide">
<pre><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> numpy as np
</span><span style="color: rgba(0, 0, 255, 1)">import</span><span style="color: rgba(0, 0, 0, 1)"> random

</span><span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> PolynomialRing:
    </span><span style="color: rgba(0, 0, 255, 1)">def</span> <span style="color: rgba(128, 0, 128, 1)">__init__</span><span style="color: rgba(0, 0, 0, 1)">(self, n, modulus):
        self.n </span>=<span style="color: rgba(0, 0, 0, 1)"> n
        self.modulus </span>=<span style="color: rgba(0, 0, 0, 1)"> modulus
        self.phi </span>= np.zeros(n + 1, dtype=<span style="color: rgba(0, 0, 0, 1)">int)
        self.phi[0] </span>= 1<span style="color: rgba(0, 0, 0, 1)">
        self.phi[n] </span>= 1

    <span style="color: rgba(0, 0, 255, 1)">def</span><span style="color: rgba(0, 0, 0, 1)"> poly_add(self, a, b):
        result </span>= np.zeros(self.n, dtype=<span style="color: rgba(0, 0, 0, 1)">int)
        </span><span style="color: rgba(0, 0, 255, 1)">for</span> i <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> range(self.n):
            result[i] </span>= (a[i] + b[i]) %<span style="color: rgba(0, 0, 0, 1)"> self.modulus
        </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> result

    </span><span style="color: rgba(0, 0, 255, 1)">def</span><span style="color: rgba(0, 0, 0, 1)"> poly_mul(self, a, b):
        result </span>= np.zeros(2 * self.n - 1, dtype=<span style="color: rgba(0, 0, 0, 1)">int)
        </span><span style="color: rgba(0, 0, 255, 1)">for</span> i <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> range(self.n):
            </span><span style="color: rgba(0, 0, 255, 1)">for</span> j <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> range(self.n):
                result[i </span>+ j] = (result[i + j] + a[i] * b[j]) %<span style="color: rgba(0, 0, 0, 1)"> self.modulus
        </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> self.poly_mod(result)

    </span><span style="color: rgba(0, 0, 255, 1)">def</span><span style="color: rgba(0, 0, 0, 1)"> poly_mod(self, poly):
        result </span>=<span style="color: rgba(0, 0, 0, 1)"> poly.copy()
        </span><span style="color: rgba(0, 0, 255, 1)">for</span> i <span style="color: rgba(0, 0, 255, 1)">in</span> range(len(result) - 1, self.n - 1, -1<span style="color: rgba(0, 0, 0, 1)">):
            </span><span style="color: rgba(0, 0, 255, 1)">if</span> result[i] !=<span style="color: rgba(0, 0, 0, 1)"> 0:
                coeff </span>=<span style="color: rgba(0, 0, 0, 1)"> result[i]
                result[i] </span>=<span style="color: rgba(0, 0, 0, 1)"> 0
                idx </span>= i -<span style="color: rgba(0, 0, 0, 1)"> self.n
                </span><span style="color: rgba(0, 0, 255, 1)">if</span> idx &lt;<span style="color: rgba(0, 0, 0, 1)"> len(result):
                    result[idx] </span>= (result[idx] - coeff) %<span style="color: rgba(0, 0, 0, 1)"> self.modulus
        result </span>=<span style="color: rgba(0, 0, 0, 1)"> result[:self.n]
        </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> result

    </span><span style="color: rgba(0, 0, 255, 1)">def</span><span style="color: rgba(0, 0, 0, 1)"> poly_sub(self, a, b):
        result </span>= np.zeros(self.n, dtype=<span style="color: rgba(0, 0, 0, 1)">int)
        </span><span style="color: rgba(0, 0, 255, 1)">for</span> i <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> range(self.n):
            result[i] </span>= (a[i] - b[i]) %<span style="color: rgba(0, 0, 0, 1)"> self.modulus
        </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> result

    </span><span style="color: rgba(0, 0, 255, 1)">def</span><span style="color: rgba(0, 0, 0, 1)"> poly_scale(self, a, scalar):
        result </span>= np.zeros(self.n, dtype=<span style="color: rgba(0, 0, 0, 1)">int)
        </span><span style="color: rgba(0, 0, 255, 1)">for</span> i <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> range(self.n):
            result[i] </span>= (a[i] * scalar) %<span style="color: rgba(0, 0, 0, 1)"> self.modulus
        </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> result

    </span><span style="color: rgba(0, 0, 255, 1)">def</span><span style="color: rgba(0, 0, 0, 1)"> random_poly(self):
        </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> np.random.randint(0, self.modulus, self.n)

    </span><span style="color: rgba(0, 0, 255, 1)">def</span><span style="color: rgba(0, 0, 0, 1)"> binary_poly(self):
        </span><span style="color: rgba(0, 0, 255, 1)">return</span> np.random.randint(0, 2<span style="color: rgba(0, 0, 0, 1)">, self.n)

    </span><span style="color: rgba(0, 0, 255, 1)">def</span> small_poly(self, bound=3<span style="color: rgba(0, 0, 0, 1)">):
        </span><span style="color: rgba(0, 0, 255, 1)">return</span> np.random.randint(-bound, bound + 1<span style="color: rgba(0, 0, 0, 1)">, self.n)

</span><span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> BFV:
    </span><span style="color: rgba(0, 0, 255, 1)">def</span> <span style="color: rgba(128, 0, 128, 1)">__init__</span>(self, n=256, q=1048576, t=256<span style="color: rgba(0, 0, 0, 1)">):
        self.n </span>=<span style="color: rgba(0, 0, 0, 1)"> n
        self.q </span>=<span style="color: rgba(0, 0, 0, 1)"> q
        self.t </span>=<span style="color: rgba(0, 0, 0, 1)"> t
        self.ring </span>=<span style="color: rgba(0, 0, 0, 1)"> PolynomialRing(n, q)
        self.plaintext_ring </span>=<span style="color: rgba(0, 0, 0, 1)"> PolynomialRing(n, t)
        self.delta </span>= q //<span style="color: rgba(0, 0, 0, 1)"> t

    </span><span style="color: rgba(0, 0, 255, 1)">def</span><span style="color: rgba(0, 0, 0, 1)"> keygen(self):
        </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> äº§çå¯é¥</span>
        s =<span style="color: rgba(0, 0, 0, 1)"> self.ring.binary_poly()
        </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> ææå¤é¡¹å¼</span>
        a =<span style="color: rgba(0, 0, 0, 1)"> self.ring.random_poly()
        </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> éæºå¤é¡¹å¼</span>
        e =<span style="color: rgba(0, 0, 0, 1)"> self.ring.small_poly()
        a_s </span>=<span style="color: rgba(0, 0, 0, 1)"> self.ring.poly_mul(a, s)
        </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> ååºå¤é¡¹å¼</span>
        pk0 =<span style="color: rgba(0, 0, 0, 1)"> self.ring.poly_sub(e, a_s)
        </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> å¬é¥</span>
        pk =<span style="color: rgba(0, 0, 0, 1)"> [pk0, a]
        sk </span>=<span style="color: rgba(0, 0, 0, 1)"> s
        </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> pk, sk

    </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> ç¼ç ææ</span>
    <span style="color: rgba(0, 0, 255, 1)">def</span><span style="color: rgba(0, 0, 0, 1)"> encode(self, message):
        </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> isinstance(message, int):
            </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> åæ´æ°ç¼ç </span>
            m = np.zeros(self.n, dtype=<span style="color: rgba(0, 0, 0, 1)">int)
            m[0] </span>= message %<span style="color: rgba(0, 0, 0, 1)"> self.t
        </span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">:
            </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> æ¹éç¼ç </span>
            m = np.array(message, dtype=int) %<span style="color: rgba(0, 0, 0, 1)"> self.t
        </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> m

    </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> ä½¿ç¨å¬é¥å å¯</span>
    <span style="color: rgba(0, 0, 255, 1)">def</span><span style="color: rgba(0, 0, 0, 1)"> encrypt(self, pk, message):
        </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> å¯¹ææè¿è¡ç¼ç </span>
        m =<span style="color: rgba(0, 0, 0, 1)"> self.encode(message)
        </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> å¯¹ææç¼ç ç»æè¿è¡æ¾å¤§</span>
        m_scaled =<span style="color: rgba(0, 0, 0, 1)"> self.ring.poly_scale(m, self.delta)
        </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)">print("m_scaled: {}".format(m_scaled))</span>
        
        <span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> çææ©ç å¤é¡¹å¼</span>
        u =<span style="color: rgba(0, 0, 0, 1)"> self.ring.binary_poly()
        </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> äº§çä¸¤ä¸ªå°åªå£°å¤é¡¹å¼</span>
        e1 =<span style="color: rgba(0, 0, 0, 1)"> self.ring.small_poly()
        e2 </span>=<span style="color: rgba(0, 0, 0, 1)"> self.ring.small_poly()
        
        pk0_u </span>=<span style="color: rgba(0, 0, 0, 1)"> self.ring.poly_mul(pk[0], u)
        pk1_u </span>= self.ring.poly_mul(pk[1<span style="color: rgba(0, 0, 0, 1)">], u)
        
        </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> çæå¯æc0</span>
        c0 =<span style="color: rgba(0, 0, 0, 1)"> self.ring.poly_add(pk0_u, e1)
        c0 </span>=<span style="color: rgba(0, 0, 0, 1)"> self.ring.poly_add(c0, m_scaled)
        </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> çæå¯æc1</span>
        c1 =<span style="color: rgba(0, 0, 0, 1)"> self.ring.poly_add(pk1_u, e2)
        
        </span><span style="color: rgba(0, 128, 0, 1)">#</span><span style="color: rgba(0, 128, 0, 1)"> è¿åå¯æ</span>
        <span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> [c0, c1]

    </span><span style="color: rgba(0, 0, 255, 1)">def</span><span style="color: rgba(0, 0, 0, 1)"> decrypt(self, sk, ciphertext):
        c0, c1 </span>=<span style="color: rgba(0, 0, 0, 1)"> ciphertext
        s_c1 </span>=<span style="color: rgba(0, 0, 0, 1)"> self.ring.poly_mul(sk, c1)
        decrypted </span>=<span style="color: rgba(0, 0, 0, 1)"> self.ring.poly_add(c0, s_c1)
        
        result </span>= np.zeros(self.n, dtype=<span style="color: rgba(0, 0, 0, 1)">int)
        </span><span style="color: rgba(0, 0, 255, 1)">for</span> i <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> range(self.n):
            result[i] </span>= round(decrypted[i] * self.t / self.q) %<span style="color: rgba(0, 0, 0, 1)"> self.t
        
        </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> result

    </span><span style="color: rgba(0, 0, 255, 1)">def</span><span style="color: rgba(0, 0, 0, 1)"> add(self, c1, c2):
        c0 </span>=<span style="color: rgba(0, 0, 0, 1)"> self.ring.poly_add(c1[0], c2[0])
        c1 </span>= self.ring.poly_add(c1[1], c2[1<span style="color: rgba(0, 0, 0, 1)">])
        </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> [c0, c1]

</span><span style="color: rgba(0, 0, 255, 1)">def</span><span style="color: rgba(0, 0, 0, 1)"> main():
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">=== BFV åæå å¯æ¹æ¡æ¼ç¤º ===\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    
    bfv </span>= BFV(n=256, q=1048576, t=256<span style="color: rgba(0, 0, 0, 1)">)
    
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">åæ°è®¾ç½®:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  å¤é¡¹å¼æ¬¡æ° n = {bfv.n}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  å¯ææ¨¡æ° q = {bfv.q}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  æææ¨¡æ° t = {bfv.t}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  ç¼©æ¾å å­ Î = {bfv.delta}\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    
    pk, sk </span>=<span style="color: rgba(0, 0, 0, 1)"> bfv.keygen()
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¯é¥çæå®æ</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ç§é¥ s å5ä¸ªç³»æ°: {sk[:5]}...\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span><span style="color: rgba(0, 0, 0, 1)">(sk)
    
    m1 </span>= 42<span style="color: rgba(0, 0, 0, 1)">
    m2 </span>= 17
    <span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ææ m1 = {m1}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ææ m2 = {m2}\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    
    c1 </span>=<span style="color: rgba(0, 0, 0, 1)"> bfv.encrypt(pk, m1)
    c2 </span>=<span style="color: rgba(0, 0, 0, 1)"> bfv.encrypt(pk, m2)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å å¯å®æ</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¯æ c1[0] å5ä¸ªç³»æ°: {c1[0][:5]}...</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¯æ c1[1] å5ä¸ªç³»æ°: {c1[1][:5]}...\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¯æc1 {}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">.format(c1))
    
    d1 </span>=<span style="color: rgba(0, 0, 0, 1)"> bfv.decrypt(sk, c1)
    d2 </span>=<span style="color: rgba(0, 0, 0, 1)"> bfv.decrypt(sk, c2)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">è§£å¯å®æ</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">è§£å¯ç»æ d1 = {d1[0]}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">è§£å¯ç»æ d2 = {d2[0]}\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">=== åæå æ³æ¼ç¤º ===</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    c_sum </span>=<span style="color: rgba(0, 0, 0, 1)"> bfv.add(c1, c2)
    d_sum </span>=<span style="color: rgba(0, 0, 0, 1)"> bfv.decrypt(sk, c_sum)
    expected_sum </span>= (m1 + m2) %<span style="color: rgba(0, 0, 0, 1)"> bfv.t
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¯æåæå æ³: c1 + c2</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">è§£å¯ç»æ: {d_sum[0]}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ææç»æ: {expected_sum}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">éªè¯: {'æå' if d_sum[0] == expected_sum else 'å¤±è´¥'}\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">=== å¤é¡¹å¼æææ¼ç¤º ===</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    m_poly </span>= np.array([1, 2, 3, 4, 5] + [0] * 251, dtype=<span style="color: rgba(0, 0, 0, 1)">int)
    c_poly </span>=<span style="color: rgba(0, 0, 0, 1)"> bfv.encrypt(pk, m_poly)
    d_poly </span>=<span style="color: rgba(0, 0, 0, 1)"> bfv.decrypt(sk, c_poly)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¤é¡¹å¼ææå5ä¸ªç³»æ°: {m_poly[:5]}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">è§£å¯ç»æå5ä¸ªç³»æ°: {d_poly[:5]}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)
    </span><span style="color: rgba(0, 0, 255, 1)">print</span>(f<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">éªè¯: {'æå' if np.array_equal(d_poly[:5], m_poly[:5]) else 'å¤±è´¥'}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)

</span><span style="color: rgba(0, 0, 255, 1)">if</span> <span style="color: rgba(128, 0, 128, 1)">__name__</span> == <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">__main__</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">:
    main()</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<h1>3 SEALä½¿ç¨</h1>
<h2>3.1 æºç ç¼è¯</h2>
<p>è¿éä»ç®åä»ç»ä¸Windowsä¸ä½¿ç¨VS2022ç¯å¢è¿è¡ç¼è¯ï¼ä¸è½½æºç å¹¶å®è£cmakeï¼è¿è¡VS2022å®è£èåä¸çâDeveloper Command Prompt for VS 2022âå½ä»¤è¡ï¼æ§è¡å½ä»¤è¿è¡éç½®ï¼</p>
<div class="cnblogs_code">
<pre>cmake -S . -B build -G <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Visual Studio 17 2022</span><span style="color: rgba(128, 0, 0, 1)">"</span> -A x64 -DCMAKE_INSTALL_PREFIX=./<span style="color: rgba(0, 0, 255, 1)">out</span></pre>
</div>
<p>è¿éç¼è¯çæ¯64ä½çæ¬ï¼å¹¶å°å®è£ç®å½è®¾ç½®ä¸ºå½åç®å½ä¸çoutæä»¶å¤¹ï¼éç½®å®æååæ§è¡ä»¥ä¸å½ä»¤è¿è¡ç¼è¯</p>
<div class="cnblogs_code">
<pre>cmake --build build --<span style="color: rgba(0, 0, 0, 1)">config Release    #ç¼è¯Releaseçæ¬
cmake </span>--build build --config Debug      #ç¼è¯Debugçæ¬</pre>
</div>
<p>ç¼è¯å®æåä¼çæseal-4.1.libåºæä»¶ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260122113702648-1311816022.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>ç¶åæ§è¡ä»¥ä¸å½ä»¤è¿è¡å®è£ï¼</p>
<div class="cnblogs_code">
<pre>cmake --install build</pre>
</div>
<p>outä¸includeä¸­æ¯å¤´æä»¶ï¼libä¸­æ¯éæåºæä»¶ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260122114032047-1402497300.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<h2>3.2 ç¤ºä¾ç¨åº</h2>
<p>ä½¿ç¨VS2022åå»ºç©ºé¡¹ç®ï¼å¹¶æ·»å demo.cppæä»¶ï¼åå®¹å¦ä¸ï¼</p>
<div class="cnblogs_code"><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" id="code_img_closed_1771d7b9-7319-4893-9ce5-5347e3e25b4a" class="code_img_closed"><img src="https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" id="code_img_opened_1771d7b9-7319-4893-9ce5-5347e3e25b4a" class="code_img_opened" style="display: none">
<div id="cnblogs_code_open_1771d7b9-7319-4893-9ce5-5347e3e25b4a" class="cnblogs_code_hide">
<pre><span style="color: rgba(0, 128, 128, 1)"> 1</span> #include &lt;iostream&gt;
<span style="color: rgba(0, 128, 128, 1)"> 2</span> #include &lt;SEAL/SEAL.h&gt;
<span style="color: rgba(0, 128, 128, 1)"> 3</span> 
<span style="color: rgba(0, 128, 128, 1)"> 4</span> <span style="color: rgba(0, 0, 255, 1)">using</span> <span style="color: rgba(0, 0, 255, 1)">namespace</span><span style="color: rgba(0, 0, 0, 1)"> std;
</span><span style="color: rgba(0, 128, 128, 1)"> 5</span> <span style="color: rgba(0, 0, 255, 1)">using</span> <span style="color: rgba(0, 0, 255, 1)">namespace</span><span style="color: rgba(0, 0, 0, 1)"> seal;
</span><span style="color: rgba(0, 128, 128, 1)"> 6</span> 
<span style="color: rgba(0, 128, 128, 1)"> 7</span> <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> main() {
</span><span style="color: rgba(0, 128, 128, 1)"> 8</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ­¥éª¤ 1ï¼éç½®å å¯åæ°ï¼BFV æ¹æ¡ï¼</span>
<span style="color: rgba(0, 128, 128, 1)"> 9</span> <span style="color: rgba(0, 0, 0, 1)">    EncryptionParameters parms(scheme_type::bfv);
</span><span style="color: rgba(0, 128, 128, 1)">10</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å¤é¡¹å¼æ¨¡æ°ï¼4096ï¼2çå¹æ¬¡ï¼</span>
<span style="color: rgba(0, 128, 128, 1)">11</span>     size_t poly_modulus_degree = <span style="color: rgba(128, 0, 128, 1)">4096</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)">12</span> <span style="color: rgba(0, 0, 0, 1)">    parms.set_poly_modulus_degree(poly_modulus_degree);
</span><span style="color: rgba(0, 128, 128, 1)">13</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æææ¨¡æ°ï¼æ¯ææ¹éè¿ç®ï¼åå¼èå´ 2^20</span>
<span style="color: rgba(0, 128, 128, 1)">14</span>     parms.set_plain_modulus(PlainModulus::Batching(poly_modulus_degree, <span style="color: rgba(128, 0, 128, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">));
</span><span style="color: rgba(0, 128, 128, 1)">15</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ç³»æ°æ¨¡æ°ï¼ä½¿ç¨ BFV é»è®¤åæ°</span>
<span style="color: rgba(0, 128, 128, 1)">16</span> <span style="color: rgba(0, 0, 0, 1)">    parms.set_coeff_modulus(CoeffModulus::BFVDefault(poly_modulus_degree));
</span><span style="color: rgba(0, 128, 128, 1)">17</span> 
<span style="color: rgba(0, 128, 128, 1)">18</span>     cout &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æææ¨¡æ° t = </span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt; parms.plain_modulus().value() &lt;&lt;<span style="color: rgba(0, 0, 0, 1)"> endl;
</span><span style="color: rgba(0, 128, 128, 1)">19</span>     cout &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æææ¨¡æ° t æ¯ç¹æ° = </span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt; parms.plain_modulus().bit_count() &lt;&lt;<span style="color: rgba(0, 0, 0, 1)"> endl;
</span><span style="color: rgba(0, 128, 128, 1)">20</span>     cout &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">t mod 2N = </span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt; (parms.plain_modulus().value() % (<span style="color: rgba(128, 0, 128, 1)">2</span> * poly_modulus_degree)) &lt;&lt;<span style="color: rgba(0, 0, 0, 1)"> endl;
</span><span style="color: rgba(0, 128, 128, 1)">21</span> 
<span style="color: rgba(0, 128, 128, 1)">22</span>     vector&lt;Modulus&gt; coeff_mods =<span style="color: rgba(0, 0, 0, 1)"> CoeffModulus::BFVDefault(poly_modulus_degree);
</span><span style="color: rgba(0, 128, 128, 1)">23</span> 
<span style="color: rgba(0, 128, 128, 1)">24</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> 3. ç³»æ°æ¨¡æ° qï¼å¤ç´ æ°ä¹ç§¯ï¼</span>
<span style="color: rgba(0, 128, 128, 1)">25</span>     cout &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">\nç³»æ°æ¨¡æ° q çææï¼ç´ æ°åè¡¨ï¼ï¼</span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt;<span style="color: rgba(0, 0, 0, 1)"> endl;
</span><span style="color: rgba(0, 128, 128, 1)">26</span>     <span style="color: rgba(0, 0, 255, 1)">int</span> total_bits = <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)">27</span>     <span style="color: rgba(0, 0, 255, 1)">for</span> (size_t i = <span style="color: rgba(128, 0, 128, 1)">0</span>; i &lt; coeff_mods.size(); i++<span style="color: rgba(0, 0, 0, 1)">) {
</span><span style="color: rgba(0, 128, 128, 1)">28</span>         cout &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ç¬¬</span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt; i + <span style="color: rgba(128, 0, 128, 1)">1</span> &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ä¸ªç´ æ°ï¼</span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt;<span style="color: rgba(0, 0, 0, 1)"> coeff_mods[i].value()
</span><span style="color: rgba(0, 128, 128, 1)">29</span>             &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ï¼æ¯ç¹æ°ï¼</span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt; coeff_mods[i].bit_count() &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ï¼</span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt;<span style="color: rgba(0, 0, 0, 1)"> endl;
</span><span style="color: rgba(0, 128, 128, 1)">30</span>         total_bits +=<span style="color: rgba(0, 0, 0, 1)"> coeff_mods[i].bit_count();
</span><span style="color: rgba(0, 128, 128, 1)">31</span> <span style="color: rgba(0, 0, 0, 1)">    }
</span><span style="color: rgba(0, 128, 128, 1)">32</span>     cout &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ç³»æ°æ¨¡æ°æ»æ¯ç¹æ° = </span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt; total_bits &lt;&lt;<span style="color: rgba(0, 0, 0, 1)"> endl;
</span><span style="color: rgba(0, 128, 128, 1)">33</span> 
<span style="color: rgba(0, 128, 128, 1)">34</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ­¥éª¤ 2ï¼åå»ºå å¯ä¸ä¸æï¼éªè¯åæ°åæ³æ§</span>
<span style="color: rgba(0, 128, 128, 1)">35</span> <span style="color: rgba(0, 0, 0, 1)">    SEALContext context(parms);
</span><span style="color: rgba(0, 128, 128, 1)">36</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æå°ä¸ä¸æä¿¡æ¯ï¼å¯éï¼æ¥çåæ°éç½®ï¼</span>
<span style="color: rgba(0, 128, 128, 1)">37</span>     cout &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Context created successfully, scheme type: BFV</span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt;<span style="color: rgba(0, 0, 0, 1)"> endl;
</span><span style="color: rgba(0, 128, 128, 1)">38</span> 
<span style="color: rgba(0, 128, 128, 1)">39</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ­¥éª¤ 3ï¼çæå¯é¥ï¼éé SEAL 4.1 APIï¼æ ¸å¿ä¿®æ¹é¨åï¼</span>
<span style="color: rgba(0, 128, 128, 1)">40</span> <span style="color: rgba(0, 0, 0, 1)">    KeyGenerator keygen(context);
</span><span style="color: rgba(0, 128, 128, 1)">41</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> 4.1 çæ¬ï¼éè¿ create_public_key() çæå¬é¥ï¼æ¿ä»£å public_key()ï¼</span>
<span style="color: rgba(0, 128, 128, 1)">42</span> <span style="color: rgba(0, 0, 0, 1)">    PublicKey public_key;
</span><span style="color: rgba(0, 128, 128, 1)">43</span> <span style="color: rgba(0, 0, 0, 1)">    keygen.create_public_key(public_key);
</span><span style="color: rgba(0, 128, 128, 1)">44</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> 4.1 çæ¬ï¼ç´æ¥éè¿æåå½æ°è·åç§é¥ï¼è¯¥æ¥å£æªåæ´ï¼</span>
<span style="color: rgba(0, 128, 128, 1)">45</span>     SecretKey secret_key =<span style="color: rgba(0, 0, 0, 1)"> keygen.secret_key();
</span><span style="color: rgba(0, 128, 128, 1)">46</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> 4.1 çæ¬ï¼éè¿ create_relin_keys() çæè¯ä¼°å¯é¥ï¼æ¿ä»£å relin_keys()ï¼</span>
<span style="color: rgba(0, 128, 128, 1)">47</span> <span style="color: rgba(0, 0, 0, 1)">    RelinKeys relin_keys;
</span><span style="color: rgba(0, 128, 128, 1)">48</span> <span style="color: rgba(0, 0, 0, 1)">    keygen.create_relin_keys(relin_keys);
</span><span style="color: rgba(0, 128, 128, 1)">49</span> 
<span style="color: rgba(0, 128, 128, 1)">50</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ­¥éª¤ 4ï¼åå§åå å¯å¨ãè§£å¯å¨ãè¯ä¼°å¨</span>
<span style="color: rgba(0, 128, 128, 1)">51</span> <span style="color: rgba(0, 0, 0, 1)">    Encryptor encryptor(context, public_key);
</span><span style="color: rgba(0, 128, 128, 1)">52</span> <span style="color: rgba(0, 0, 0, 1)">    Decryptor decryptor(context, secret_key);
</span><span style="color: rgba(0, 128, 128, 1)">53</span> <span style="color: rgba(0, 0, 0, 1)">    Evaluator evaluator(context);
</span><span style="color: rgba(0, 128, 128, 1)">54</span> 
<span style="color: rgba(0, 128, 128, 1)">55</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ­¥éª¤ 5ï¼ææåå¤ï¼ä¸¤ä¸ªæ´æ°ï¼</span>
<span style="color: rgba(0, 128, 128, 1)">56</span>     Plaintext plain1(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">123</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">57</span>     Plaintext plain2(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">456</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 128, 1)">58</span>     cout &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Original plaintext 1: </span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt; plain1.to_string() &lt;&lt;<span style="color: rgba(0, 0, 0, 1)"> endl;
</span><span style="color: rgba(0, 128, 128, 1)">59</span>     cout &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Original plaintext 2: </span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt; plain2.to_string() &lt;&lt;<span style="color: rgba(0, 0, 0, 1)"> endl;
</span><span style="color: rgba(0, 128, 128, 1)">60</span> 
<span style="color: rgba(0, 128, 128, 1)">61</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ­¥éª¤ 6ï¼å å¯ææä¸ºå¯æ</span>
<span style="color: rgba(0, 128, 128, 1)">62</span> <span style="color: rgba(0, 0, 0, 1)">    Ciphertext cipher1, cipher2;
</span><span style="color: rgba(0, 128, 128, 1)">63</span> <span style="color: rgba(0, 0, 0, 1)">    encryptor.encrypt(plain1, cipher1);
</span><span style="color: rgba(0, 128, 128, 1)">64</span> <span style="color: rgba(0, 0, 0, 1)">    encryptor.encrypt(plain2, cipher2);
</span><span style="color: rgba(0, 128, 128, 1)">65</span>     cout &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Plaintext encrypted to ciphertext successfully</span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt;<span style="color: rgba(0, 0, 0, 1)"> endl;
</span><span style="color: rgba(0, 128, 128, 1)">66</span> 
<span style="color: rgba(0, 128, 128, 1)">67</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ­¥éª¤ 7ï¼å¯æåæè¿ç®ï¼å æ³ + ä¹æ³ï¼
</span><span style="color: rgba(0, 128, 128, 1)">68</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å¯æå æ³</span>
<span style="color: rgba(0, 128, 128, 1)">69</span> <span style="color: rgba(0, 0, 0, 1)">    Ciphertext cipher_add;
</span><span style="color: rgba(0, 128, 128, 1)">70</span> <span style="color: rgba(0, 0, 0, 1)">    evaluator.add(cipher1, cipher2, cipher_add);
</span><span style="color: rgba(0, 128, 128, 1)">71</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å¯æä¹æ³ + éçº¿æ§åï¼åå°å¯æå¤§å°ï¼</span>
<span style="color: rgba(0, 128, 128, 1)">72</span> <span style="color: rgba(0, 0, 0, 1)">    Ciphertext cipher_mult;
</span><span style="color: rgba(0, 128, 128, 1)">73</span> <span style="color: rgba(0, 0, 0, 1)">    evaluator.multiply(cipher1, cipher2, cipher_mult);
</span><span style="color: rgba(0, 128, 128, 1)">74</span> <span style="color: rgba(0, 0, 0, 1)">    evaluator.relinearize_inplace(cipher_mult, relin_keys);
</span><span style="color: rgba(0, 128, 128, 1)">75</span> 
<span style="color: rgba(0, 128, 128, 1)">76</span>     <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ­¥éª¤ 8ï¼è§£å¯å¯æï¼éªè¯ç»æ</span>
<span style="color: rgba(0, 128, 128, 1)">77</span> <span style="color: rgba(0, 0, 0, 1)">    Plaintext plain_add, plain_mult;
</span><span style="color: rgba(0, 128, 128, 1)">78</span> <span style="color: rgba(0, 0, 0, 1)">    decryptor.decrypt(cipher_add, plain_add);
</span><span style="color: rgba(0, 128, 128, 1)">79</span> <span style="color: rgba(0, 0, 0, 1)">    decryptor.decrypt(cipher_mult, plain_mult);
</span><span style="color: rgba(0, 128, 128, 1)">80</span>     cout &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Ciphertext add result: </span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt; plain_add.to_string() &lt;&lt;<span style="color: rgba(0, 0, 0, 1)"> endl;
</span><span style="color: rgba(0, 128, 128, 1)">81</span>     cout &lt;&lt; <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Ciphertext multiply result: </span><span style="color: rgba(128, 0, 0, 1)">"</span> &lt;&lt; plain_mult.to_string() &lt;&lt;<span style="color: rgba(0, 0, 0, 1)"> endl;
</span><span style="color: rgba(0, 128, 128, 1)">82</span>     
<span style="color: rgba(0, 128, 128, 1)">83</span>     <span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 128, 128, 1)">84</span> }</pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>å°ä¹é´äº§ççoutæä»¶å¤¹ä¸çincludeålibæ·è´å°é¡¹ç®æä»¶å¤¹ä¸ï¼éç½®é¡¹ç®çC/C++ç¼è¯åå«å¤´æä»¶è·¯å¾ï¼åºæä»¶è·¯å¾ä»¥åè¾å¥åºï¼å³å¯è¿è¡ç¼è¯ã</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260122114406545-2054417852.png" alt="image" width="593" height="434" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>ç¼è¯å®æåè¿è¡ç¨åºï¼è¾åºå¦ä¸ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/465567/202601/465567-20260122114732024-1409765149.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>å¨è¯¥ç¤ºä¾ç¨åºä¸­ï¼å¤é¡¹å¼æ¨¡æ°Næ¯4096ï¼æææ¨¡æ°tæ¯1032193ï¼ä½å®½ä¸º20bitsï¼ç³»æ°æ¨¡æ°qæ¯3ä¸ªç´ æ°çä¹ç§¯68719403009*68719230977*137438822401=0x1ffff4400622fecd904df7f92001ï¼ä½å®½æ¯109bitsï¼ç¤ºä¾ä¸­æ¼ç¤ºäº0x123å0x456çå æ³åä¹æ³è¿è¡ï¼å¯è§å å¯è¿ç®åçè§£å¯ç»æåæªå å¯è¿ç®çç»æå®å¨ä¸è´ã</p>
<p>&nbsp;</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.008333333333333333" data-date-updated="2026-01-22 16:02">2026-01-22 15:50</span>&nbsp;
<a href="https://www.cnblogs.com/zhaoweiwei">weiwei22844</a>&nbsp;
éè¯»(<span id="post_view_count">11</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19510487);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19510487', targetLink: 'https://www.cnblogs.com/zhaoweiwei/p/19510487/bfv', title: 'SEALå¨åæå å¯BFVæ¹æ¡å¥é¨è¯¦è§£' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æçâPythonæµ·é¾âè¯çäºä¸æéèå­µåºçå´æ¯ç²¾çµ ]]></title>
    <link>https://www.cnblogs.com/lixingqiu/p/19516100</link>
    <guid>d0489042c049b1f1955d55c9a4aede30</guid>
    <description>
    <![CDATA[ 
	<h1 class="postTitle"><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/lixingqiu/p/19516100" title="åå¸äº 2026-01-22 11:17">
    <span role="heading" aria-level="2">æçâPythonæµ·é¾âè¯çäºä¸æéèå­µåºçå´æ¯ç²¾çµ</span>
    

</a>
</h1>
	<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>æ¶ååæº¯å°2010å¹´ï¼é£æ¯ä¸ä¸ªåæ»¡æ¢ç´¢ä¸æ±ç¥çå¹´ä»½ãå¨æ­¤ä¹åï¼ææ²æµ¸äºä½¿ç¨Visual Basicè¯­è¨å¼å3Då°æ¸¸æï¼é£ç§å¨ä»£ç çä¸çéåé åºå¥å¦èæåºæ¯çæè§ï¼è®©æä¹æ­¤ä¸ç²ãå½æ¶ï¼æèªè®¤ä¸ºBasicå·²ç»æ¯ç¸å½ç®åçè®¡ç®æºè¯­è¨äºï¼ç¶èï¼åå¿æ·±å¤å´å§ç»æä¸ªçé®ï¼æ¯å¦å­å¨ä¸ç§æ¯Basicæ´éåå°å¿ç¼ç¨çä¸ç¨è®¡ç®æºè¯­è¨å¢ï¼</p>
<p>å¸¦çè¿ä¸ªçé®ï¼æå¼å§å¨ç½ç»ä¸å¹¿æ³æå¯»ãåå¤«ä¸è´æå¿äººï¼æç»äºåç°äºScratch 1.4çãè¿åªæ¥èªç¾å½éº»ççå·¥çâå°ç«åªâï¼ç¬é´å¸å¼äºæçç®åï¼ä»æ­¤æä¾¿æ·±æ·±ç±ä¸äºå®ã2013å¹´ï¼ææ£çå¯¹å°å¿ç¼ç¨æè²çç­æï¼æå¼è®¾äºå°å¿ç¼ç¨å¹è®­ç­ãå°äº2015å¹´ï¼æåå°Pythonçº³å¥æå­¦ä½ç³»ï¼å¸æè½ä¸ºå­¦çä»¬å¸¦æ¥æ´ä¸°å¯çç¼ç¨ä½éªãç»è¿å å¹´çæå­¦å®è·µï¼å°2018å¹´æ¶ï¼æå·²ç»èªå·±ç¼åäºè¾å¤çéå°å¹´Pythonæå­¦èµæã</p>
<p>å¨è¿ä¸ªè¿ç¨ä¸­ï¼æéæ¸åç°Pythonçå°æµ·é¾åè½å­å¨ä¸å®çå±éæ§ãä¸ºäºæ·±å¥æ¢ç©¶å¶åçï¼ææå¼äºå®çturtle.pyæºä»£ç æä»¶ï¼ä»ç»ç ç©¶å¶ä¸­çå¥¥ç§ãä»2019å¹´å¼å§ï¼æåºäºPython turtleæ¨¡åï¼è¸ä¸äºå¼åPythonç²¾çµæ¨¡åçå¾ç¨ãPythonç²¾çµæ¨¡åçæ ¸å¿æ¯è®¾è®¡äºä¸ä¸ªåä¸ºSpriteçç±»ï¼è¿ä¸åæ°å¤§å¤§å¢å äºæµ·é¾çåè½ï¼ä¾å¦å®ç°äºåç´ çº§å«çç¢°ææ£æµç­ãå¦ä»ï¼ææäººé½å¯ä»¥éè¿ç®åçå½ä»¤âpip install spritesâæ¥å®è£å¹¶ä½¿ç¨è¿ä¸ªå¼ºå¤§çPythonç²¾çµæ¨¡åã</p>
<p>è¿å å¹´ï¼æå°ä¸»è¦ç²¾åæå¥å°ä¿¡æ¯å­¦å¥¥èµçæå­¦ä¸­ãæ¯æ¥é½å¨âè¦æå¥æ³âåç§é¾é¢ï¼åæ±ä¸ºå­¦çæ¾å°æ´ææçå­¦ä¹ æ¹æ³ã2025å¹´8æï¼æåç­ç»æï¼æåå¼å§æèä¸ä¸ªæ°çé®é¢ï¼å¦æC++çå¥é¨æå­¦è½å¤åPython turtleä¸æ ·ç®åææï¼é£æ çä¼ç»ä¸­å½ææå°å¹´å¸¦æ¥ç¦é³ã</p>
<p>ä¸ºäºå®ç°è¿ä¸ªç®æ ï¼æå¨GitHubä¸å¹¿æ³å¯»æ¾åäººçç ç©¶ææï¼ä¸è½½äºè®¸å¤ç¨Cè¯­è¨æèC++å¼åçç±»turtleåºãå¶ä¸­ï¼æå°çç«C++åºéèªå¸¦çCè¯­è¨æµ·é¾ä½å¾ï¼è¿æGoCç­ç¸å³åºãæè¿ç¹æè´­ä¹°äºç¸å³ä¹¦ç±ï¼åå¤ææä¸­å°å­¦çï¼çè³ä¹°äºä¸æ¬å°å¿3ç»´C++ç¼ç¨ä¹¦ãç¶èï¼ç»è¿æ·±å¥ç ç©¶åå¯¹æ¯ï¼ææç»å¹¶æ²¡æéæ©ä½¿ç¨å®ä»¬ï¼è¿èåæçå¤æ¹é¢çåå ã</p>
<p>å°±æ¿å°çç«C++åºéèªå¸¦çCè¯­è¨æµ·é¾ä½å¾æ¥è¯´ï¼å¶ä½èæ¾ç¶æ²¡æPythonå°å¿ç¼ç¨æè²çç»åãææ¾å°è¯èç³»ä½èï¼å¸æä»è½å°éé¢çå½ä»¤æ¹æç±»ä¼¼Python turtleçé£æ ¼ï¼ä½èèå°ä¸è½æ»æ¯éº»ç¦ä»äººï¼åæ¥ä¹å°±æ²¡æåç»§ç»­èç³»ãèGoCè¿ä¸ªåºï¼éé¢çå½ä»¤ä¹æ²¡ææ¿æ¥èªPython turtleãä¸ºäºæ¹ä¾¿å¿ç«¥è¾å¥å­ç¬¦ï¼å®å°å½ä»¤è®¾è®¡æä¸ä¸ªå­ç¬¦æä¸¤ä¸ªå­ç¬¦ï¼æ¯å¦pen.oæèpen.ooä¹ç±»çãå¶å½ä»¤ç¸å¯¹è¾å°ï¼åè½ä¹ä¸å¤ä¸°å¯ï¼èä¸ä¸»è¦æ¯å¨çº¿ä½¿ç¨ï¼ä½èè³ä»ä¼¼ä¹é½æ²¡æå¼åèªå·±çç¼è¾å¨ãä»¥åæä½¿ç¨è¿å®çç¦»çº¿çï¼è¿éè¦åå©notepad++ãä»æ¬è´¨ä¸è®²ï¼å®æ´åæ¯ä¸ºä¸æ»ä¿¡æ¯å­¦å¥¥èµè®¾è®¡çåç½®è¯¾ç¨å·¥å·ãç½ä¸æäººå»ºè®®ä¸ãäºå¹´çº§çå­¦çå°±å¼å§å­¦ä¹ GoCï¼ä½å¦æä¸æç®ä¸æ»ä¿¡å¥¥èµï¼å¶å®å¯ä»¥ä¸å¿å­¦ä¹ ãä¸ºä»ä¹å¢ï¼</p>
<p>ä»å¤§èåè²çè§åº¦æ¥çï¼ä¸ãäºå¹´çº§çå­¦çï¼ä»ä»¬çå¤§èå°å¤äºåè²é¶æ®µãç§å­¦ç ç©¶è¡¨æï¼è¿ä¸ªé¶æ®µçå­©å­ï¼å¤§èçåé¢å¶ç®è´¨å°æªå®å¨æçï¼æ½è±¡æç»´è½åç¸å¯¹è¾å¼±ãè½ç¶æäºå­©å­å¯è½å¨æ©æå°±å±ç°åºäºè¾å¼ºçå­¦ä¹ è½ååå¤©èµï¼å¦ææç»ç¼åç¬å°ï¼è½è¯å«åºè¿äºèå­ï¼è®©ä»ä»¬å°è¯å­¦ä¹ GoCä¹æªå°ä¸å¯ãä½ç°å®æåµæ¯ï¼ä¸å¯è½æ¯ä¸ªå°å­¦çé½å¾å»ä¸æ»ä¿¡æ¯å­¦å¥¥èµï¼æ¯ç«ä¿¡å¥¥èµçç«äºååæ¿çï¼å®å°±æ¯å­¦é¸ä»¬çæåºãèä¸ï¼å¯¹äºæ®éå­¦çèè¨ï¼ä»ä»¬çå°å¿ç¼ç¨å­¦ä¹ ç»ååºè¯¥æ¯ä¸°å¯å¤å½©çï¼ä¸åºå±éäºC++ç¼ç¨ãå ä¸ºå­¦ä¹ ç¼ç¨çæ¬è´¨å¹¶éä»ä»ææ¡æç§è®¡ç®æºè¯­è¨ï¼èæ¯å¹å»é»è¾æç»´ãåé åç­å¤æ¹é¢çè½åãæäºäººå¤§èåè²ç¸å¯¹è¿ç¼ä¸äºï¼å¦æç¡¬è¦ä»ä»¬å¨ä½å¹´çº§å°±å¼å§å­¦ä¹ C++ï¼å¾å¯è½ä¼éå¾å¶åï¼å°±æ¯æèå©é¿ãæ ¹æ®ç¥ç»ç§å­¦çç ç©¶ï¼å¿ç«¥å¨ä¸­ä½å¹´çº§é¶æ®µï¼å½¢è±¡æç»´æ´ä¸ºæ´»è·ï¼æ­¤æ¶å­¦ä¹ å¾å½¢åç¼ç¨æ´å ç¬¦åä»ä»¬çè®¤ç¥åå±è§å¾ãç­å°ä»ä»¬å¹´é¾ç¨å¤§ï¼å¿æºæ´å æçï¼åå»å­¦ä¹ C++ä¹ä¸è¿ãå¤§èéè¦å¾å°å¤æ¹é¢çåºæ¿ï¼æè½å¾å°ååçé»ç¼ååå±ãå°±åä¸é¢ç§å­ï¼éè¦å¨éå®çç¯å¢ä¸­ï¼ç»åä¸åçå»åæ»å»ï¼æè½èå£®æé¿ãæç»ï¼æäºå­¦çå°äºé«ä¸­é¶æ®µï¼éçå¤§èçè¿ä¸æ­¥åè²åç¥è¯çç§¯ç´¯ï¼ä¼çªç¶å¼çªï¼å¨å­¦ä¹ ç¼ç¨ç­æ¹é¢åå¾æ´å¤§çè¿æ­¥ã</p>
<p>é£ä¹ï¼é¢å¯¹ç»å¤§å¤æ°çæ®éå­¦çç¾¤ä½ï¼ä»ä»¬çå­¦ä¹ è·¯å¾éå¸¸æ¯ä¸ãäºå¹´çº§å­¦ä¹ å¾å½¢åç¼ç¨ï¼ä¸ãåå¹´çº§å­¦ä¹ Pythonç¼ç¨ï¼å°äºä¸å®é¶æ®µååå­¦ä¹ C++ç¼ç¨ãå¨è¿ç§æåµä¸ï¼æ¯å¦å­å¨ä¸ç§éå¯¹æ®éå­¦çï¼è½å¤å®ç¾è¡æ¥è¿ä¸è¯¾ç¨ä½ç³»çC++è¯¾ç¨å¢ï¼æ®æäºè§£ï¼è¿æ ·çè¯¾ç¨ç¸å¯¹æ¯è¾å°ï¼å³ä¾¿æï¼å¯è½ä¹ä¸å¬å¼æèéè¦æ¶è´¹ãæ¯ç«ä¸­å½å°åå¹¿éï¼å¾å¤äºææä¹é¾ä»¥å¨é¢ç¥æãä½ä¸ç®¡ææ ·ï¼æå³å®èªå·±å¨æ°å¼åä¸ä¸ªï¼æ­£æè°âéçªé¶çªä¸å¦èªå·±èçªâã</p>
<p>å¨å¼åè¿ç¨ä¸­ï¼é¦åé¢ä¸´çå°±æ¯éæ©åéçåºæ¥ä½ä¸ºåºç¡ãå¦æè®©æçC++åºåºäºOpenGLï¼è½ç¶å¯è¡ï¼ä½æéè¦åè±è´¹å¤§éæ¶é´å»å­¦ä¹ å®ï¼è¿å¯¹äºææ¥è¯´ï¼å­¦ä¹ ææ¬è¿é«ãäºæ¯ï¼ææ¾å°äºæ¾ç»ç¨è¿çeasyXï¼å¹¶ç¨å®å¼ååºäºåå½¢åºãç¶èï¼å¨ä½¿ç¨è¿ç¨ä¸­ï¼æåç°å¾å¤åºå±çä¸è¥¿ææ æ³ææ§ï¼æ å¥ä¹ä¸åªè½æ¾å¼ãæ¥çï¼æååç°äºraylibï¼å®åºäºSDL2ï¼æ¥å£ä¼å¤ï¼å°è£å¾è¾ä¸ºå¤æãéåï¼ææ³¨æå°äºSFMLï¼è¿æ¯ä¸ä¸ªå¾ä¸éçåºï¼ä½èèå°å®å·²ç»å°è£äºå¾å¤åå®¹ï¼ææ³è¦ææ¡æ´å¤åºå±ææ¯ï¼æç»è¿æ¯å¼ç¨äºå®ãæåï¼æéæ©äºå·¥ä¸çº§å«çSDL2åºãè¿ä¸ªåºåè½ç¸å¯¹è¾å°ï¼ä½ä¹æå³çæèªå·±çå¼åèªç±åº¦æ´å¤§ï¼å¯¹åºå±çææ§åæ´å¼ºã</p>
<p>æä»¥ï¼ç°å¨ççæ¬æ¯åºäºSDL2åºå¼åçãæåï¼æå°å¶å½åä¸ºC++ Spritesåºï¼åæ¥åæ­£å¼å½åä¸ºC++ç²¾çµåºãå¨å¼åè¿ç¨ä¸­ï¼æä¸æ­å°è¿è¡ä¿®æ¹åè°è¯ï¼åªä¸ºè®©æ®éç¨æ·è½å¤æ´å¥½å°ä¸æä½¿ç¨ãä¸ºäºè®©è¿ä¸ªåºæ´å å®åï¼æè¿ä¸­éå¼åäºpxC++ç¼è¾å¨ï¼è¿æ¯ä¸é¨ä¸ºC++ç²¾çµåºéèº«æé çç¼è¾å¨ãåæ¶ï¼æè¿å¼åäºDevC++5.11åçº§åï¼ä½¿DevC++5.11è½å¤æ¯æC++ç²¾çµåºï¼ä»èè®©å®æ´å¥½å°èå¥å°ä¸»æµçä¸­å°å­¦çC++æå­¦çæä¸­ã</p>
<p>ç°å¨çC++ç²¾çµåºï¼æ¯è¾å®ç¾å°ç»§æ¿äºPython turtleçè¡èãä¸ä»å¦æ­¤ï¼æè¿éå¯¹Python turtleå­å¨çä¸è¶³ä¹å¤è¿è¡äºæ¹è¿ä¸ä¼åãä¾å¦ï¼æç²¾å¿è®¾è®¡äºfillå½ä»¤ï¼è§è²éè¿ä½¿ç¨fillå½ä»¤ï¼å°±å¯ä»¥å¨å°é­åºåè¿è¡æ´ªæ°´å¡«åãå¨è®¾å®ç»ç¬é¢è²æ¹é¢ï¼ä¸ä»è½å¤è®©è§è²çç»ç¬é¢è²å½ä»¤æ¥åå­ç¬¦ä¸²ä½ä¸ºåæ°ï¼è¿è½æ¥å1ä¸ªæ´æ°æå¤ä¸ªæ´æ°ä½ä¸ºåæ°ãè¿æ¯å ä¸ºæå¯¹pencolorå½ä»¤è¿è¡äºå¤æ¬¡éè½½ï¼ä½¿å¶å·ææ´é«ççµæ´»æ§åèªç±åº¦ã</p>
<p>æ­¤å¤ï¼æè¿ä¸ºè§è²çç»ç¬å¢æ·»äºè®¸å¤å®ç¨çæ¹æ³ãæ¯å¦ï¼è®¾è®¡äºè®¾å®é´å½±åº¦çpenshadeæ¹æ³ï¼ä»¥åè®¾å®é¢è²é¥±ååº¦çpensatæ¹æ³åè®¾å®é¢è²æåº¦çpenvalueæ¹æ³ãåæ¥åè¿ä¸æ­¥è®¾è®¡äºç´æ¥è®¾å®é¢è²çHueãSaturationåValueçpenhsvæ¹æ³ï¼è¿æä¿®æ¹é¢è²éæåº¦çpenalphaæ¹æ³ãä¸ä»å¦æ­¤ï¼è¿ä¸ºè§è²è®¾è®¡äºè´å¡å°æ²çº¿ä¸æ ·æ¡æ²çº¿ç­æ¹æ³ãè¿äºç²¾å¿è®¾è®¡çè®¾å®ï¼å¯¹äºå®¡ç¾è½åå¼ºçç¾æ¯çæ¥è¯´ï¼æ çæä¾äºæå¤§çä¾¿å©ï¼ä½¿ä»ä»¬è½å¤æ´å è½»æ¾å°åä½åºå·æèºæ¯ææçå¾å½¢ã</p>
<p>ç°å¨æä»¬æçå°çâC++ç²¾çµåºâï¼æ¬è´¨ä¸æ¯åºäºlogoè®¡ç®æºè¯­è¨ç¼ç¨æè²çå¿µå¨C++ä¸ççå»¶ä¼¸å¹¶ææè¶è¶ãå®åé´äºPython turtleç®æ´çAPIï¼å¹¶éå¯¹æè²åºæ¯è¿è¡äºæ·±å¥ä¼åãè¿æ ·ä¸æ¥ï¼å­¦çä»¬å°±è½å¤å¨ä¸ä¸ªæ´å¼ºå¤§ãæ´æ¥è¿å·¥ä¸æ åçè¯­è¨ç¯å¢ä¸­ï¼ååä½éªå°âæµ·é¾ä½å¾âçä¹è¶£ä¸æºæ§ãæä»¬å¯ä»¥æPython turtleåC++ç²¾çµåºæ¯ä½æ¯äº²åå¼ï¼æ è®ºåå­¦ä¹ åªä¸ä¸ªï¼åå»å­¦ä¹ å¦ä¸ä¸ªï¼é½ä¼æä¸ç§âä¼¼æ¾ç¸è¯çå½æ¥âççææï¼è¿å°±æ¯æè°çâååèµè½âãå ä¸ºç¼ç¨çä¸çå¨åºå±æ¬æ¥å°±æ¯ç¸éçï¼å½ææå®ä»¬çå¤è§ä¹è®¾è®¡å¾ç¸ä¼¼çæ¶åï¼è¯·ä¸è¦æå°æè®¶ï¼</p>
<p>æ´å¼å¾ä¸æçæ¯ï¼ç±äºC++ç²¾çµåºæ¯åºäºSDL2åºè¿è¡å¼åçï¼å®è¿è½å¤å®ç¾èå¥SDL2åºçå½ä»¤ï¼ä¸ºå­¦çæä¾æ´æ·±å¥çç¼ç¨å­¦ä¹ æºä¼ãæ³è±¡ä¸ä¸ï¼SDL2åºå¨åè¡åä¸ä¸­çå¹¿æ³åºç¨åºæ¯ï¼C++ç²¾çµåºæ çä¸ºå­¦ççæªæ¥å­¦ä¹ åèä¸åå±èµäºäºå¶ä»ç±»C++ turtleåºæ æ³æ¯æçä¼å¿ã</p>
<p>&nbsp;</p>
</div>
<div class="clear"></div>

	<div class="postDesc">posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-22 11:17">2026-01-22 11:17</span>&nbsp;
<a href="https://www.cnblogs.com/lixingqiu">æå´ç</a>&nbsp;
éè¯»(<span id="post_view_count">257</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19516100);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19516100', targetLink: 'https://www.cnblogs.com/lixingqiu/p/19516100', title: 'æçâPythonæµ·é¾âè¯çäºä¸æéèå­µåºçå´æ¯ç²¾çµ' })">ä¸¾æ¥</a>
</div>
 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Claude Code æ¯æéç£æ©å± Skills ââ ç¨ææ° API æå»ºæ´é è°±ç AI é¡¹ç® ]]></title>
    <link>https://www.cnblogs.com/bugshare/p/19515937</link>
    <guid>cba4901b0065383586452ba3d9d62293</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/bugshare/p/19515937" title="åå¸äº 2026-01-22 10:55">
    <span role="heading" aria-level="2">Claude Code æ¯æéç£æ©å± Skills ââ ç¨ææ° API æå»ºæ´é è°±ç AI é¡¹ç®</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>å¨ä¸ä¸ç¯ã<strong>Claude Code Ã æºè°± BigModel å®æéææå</strong>ãä¸­ï¼æä»¬å·²ç»å®æäºä¸æ¬¡å®æ´çé¡¹ç®å®æãé¡¹ç®<strong>å¯ä»¥æ­£å¸¸è¿è¡</strong>ï¼ä½å¨åç»­ä»£ç  Review æ¶ï¼ä¸ä¸ªé®é¢éæ¸æ´é²åºæ¥ï¼</p>
<blockquote>
<p><strong>çæçä»£ç è½ç¶è½è·ï¼ä½å¤§é API åç¨æ³å·²ç»è¿æ¶ï¼ä¸ææ°å®æ¹ææ¡£å­å¨ææ¾åå·®ã</strong></p>
</blockquote>
<p>è¿å¨ AI è¾å©å¼åä¸­å¶å®éå¸¸å¸¸è§ââæ¨¡åçè®­ç»æ°æ®æ´æ°éåº¦ï¼å¾å¾èµ¶ä¸ä¸æ¡æ¶å SDK çè¿­ä»£éåº¦ã</p>
<p>æ­£å·§è¿æ¶ï¼ä¸ä½æååææ¨èäº <strong>Anthropic ææ°åå¸ç Agent Skills</strong>ï¼éè¿ <em>plugins</em> çæ¹å¼ï¼è®© Claude å¨çæä»£ç æ¶ <strong>å¨æè¯»åææ°å®æ¹ææ¡£åå·¥å·è½å</strong>ï¼ä»èæ¾èéä½âåå¾åï¼ä½è·ä¸éâçæ¦çã</p>
<p>æ¬æå°±æ¯è¿æ¬¡æ¢ç´¢çå®æ´è®°å½ã</p>
<hr>
<h1 id="ä¸agent-skills-æ¯ä»ä¹">ä¸ãAgent Skills æ¯ä»ä¹ï¼</h1>
<p>å®æ¹ä»åºå°åï¼</p>
<blockquote>
<p><a href="https://github.com/anthropics/skills" target="_blank" rel="noopener nofollow">https://github.com/anthropics/skills</a></p>
</blockquote>
<p><strong>Agent Skills</strong> å¯ä»¥çè§£ä¸ºï¼</p>
<blockquote>
<p>ä¸å¥å¯ææçâè½åæ¨¡åâï¼ç¨äºæä¼ Claude <strong>å¦ä½ç¨æ­£ç¡®çæ¹æ³ãææ°çå·¥å·ãå¯éå¤çæµç¨</strong> æ¥å®æç¹å®ä»»å¡ã</p>
</blockquote>
<p>å¨ææ¯å±é¢ä¸ï¼</p>
<ul>
<li>
<p>æ¯ä¸ª Skill æ¬è´¨ä¸æ¯ä¸ä¸ªæä»¶å¤¹</p>
</li>
<li>
<p>åé¨åå«ï¼</p>
<ul>
<li>æä»¤ï¼instructionsï¼</li>
<li>èæ¬ï¼scriptsï¼</li>
<li>èµæºæä»¶ï¼resourcesï¼</li>
</ul>
</li>
<li>
<p>Claude Code ä¼å¨è¿è¡æ¶å¨æå è½½è¿äº Skills</p>
</li>
</ul>
<h2 id="å®è½è§£å³ä»ä¹é®é¢">å®è½è§£å³ä»ä¹é®é¢ï¼</h2>
<p>Agent Skills çæ ¸å¿ä»·å¼å¨äº <strong>âéä½å¹»è§ + æé«ä¸è´æ§â</strong>ï¼å¸ååºç¨åºæ¯åæ¬ï¼</p>
<ul>
<li>æå¬å¸/å¢éçç¼ç è§èçæä»£ç </li>
<li>æææ°å®æ¹ææ¡£è°ç¨ APIï¼èä¸æ¯é æ¨¡åè®°å¿ï¼</li>
<li>æ§è¡åºå®çå·¥ç¨åæµç¨ï¼åå§åé¡¹ç®ãçæç®å½ç»æãé¨ç½²èæ¬ç­ï¼</li>
<li>èªå¨åä¸ªäººæç»ç»çº§ä»»å¡</li>
</ul>
<p>ç®åæ¥è¯´ï¼</p>
<blockquote>
<p><strong>Skills ä¸æ¯è®©æ¨¡åæ´èªæï¼èæ¯è®©æ¨¡åæ´âå®è§ç©âã</strong></p>
</blockquote>
<hr>
<h1 id="äºå¨-claude-code-ä¸­å®è£-agent-skills">äºãå¨ Claude Code ä¸­å®è£ Agent Skills</h1>
<p>å¨ Claude Code å½ä»¤è¡ä¸­æ§è¡ï¼</p>
<pre><code class="language-bash">/plugin marketplace add anthropics/skills
</code></pre>
<p>å®è£å®æåï¼ä½ å°±å·²ç»å·å¤äºä½¿ç¨å®æ¹ Skills çè½åã</p>
<blockquote>
<p>è¿ä¸æ­¥ç¸å½äºä¸º Claude Code æå¼äºâå®æ¹å¢å¼ºæ¨¡å¼âã</p>
</blockquote>
<p><img alt="PixPin_2026-01-22_10-07-25.png" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3715916/202601/3715916-20260122104737596-1387531556.png" class="lazyload"></p>
<hr>
<h1 id="ä¸å®è£-context7-æä»¶å³é®æ­¥éª¤">ä¸ãå®è£ context7 æä»¶ï¼å³é®æ­¥éª¤ï¼</h1>
<p>æ¥ä¸æ¥æ¯æ¬æçéç¹ï¼<strong>context7</strong>ã</p>
<h2 id="1ï¸â£-æå¼æä»¶ç®¡ç">1ï¸â£ æå¼æä»¶ç®¡ç</h2>
<p>å¨ Claude Code ä¸­è¾å¥ï¼</p>
<pre><code class="language-shell">/plugins
</code></pre>
<p>ç¶åä½¿ç¨é®ç â¡ï¸ è¿å¥ <strong>Discover</strong>ã</p>
<h2 id="2ï¸â£-æç´¢å¹¶å®è£-context7">2ï¸â£ æç´¢å¹¶å®è£ context7</h2>
<p>å¨æç´¢æ¡ä¸­è¾å¥ <code>context7</code>ï¼å®æå®è£ã</p>
<blockquote>
<p>context7 æ¬è´¨ä¸æ¯ä¸ä¸ª MCPï¼Model Context Protocolï¼æä»¶ï¼<br>
è½è®© Claude <strong>ç´æ¥åèå¹¶å¯¹é½ææ°çå®æ¹ææ¡£åå®¹</strong>ã</p>
</blockquote>
<p><img alt="PixPin_2026-01-22_10-09-22.png" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3715916/202601/3715916-20260122104737593-1570344568.png" class="lazyload"></p>
<hr>
<h1 id="åä½¿ç¨-context7-çæé¡¹ç®ä»£ç ">åãä½¿ç¨ context7 çæé¡¹ç®ä»£ç </h1>
<p>å®è£å®æåï¼å°±å¯ä»¥å¨ Prompt ä¸­æ¾å¼å£°æä½¿ç¨ <code>context7</code>ã</p>
<h2 id="ç¤ºä¾-prompt">ç¤ºä¾ Prompt</h2>
<pre><code class="language-markdown">---
name: context7
description: ä½¿ç¨ Context7ï¼åºäºæ¡æ¶ææ°çå®æ¹ææ¡£
---

# context7

## æå
å·²ä½¿ç¨ä»¥ä¸ææ¯æ çæä¼ä¸çº§é¡¹ç®ï¼
- ä½¿ç¨ Context7ï¼åºäºææ°çå®æ¹ææ¡£
- FastAPI 0.128.0ï¼å¸¦ Token è®¤è¯
  - ä½¿ç¨ sqlite çæ token
  - ä¸ä½¿ç¨ JWTï¼ä»å Token æ ¡éª
- langchain 1.2.6ï¼ä½¿ç¨ create_agent
- langchain-ollama 1.0.1
  - modelï¼qwen3-vl:32b
  - embeddingï¼qwen3-embedding:8b
- langgraph 1.0.6
- Milvusï¼pymilvusï¼2.6.6
- langfuse 3.12.0
</code></pre>
<p>éè¿è¿ç§æ¹å¼ï¼ä½ æ¯å¨<strong>æç¡®åè¯ Claude</strong>ï¼</p>
<blockquote>
<p>ä¸è¦é âå°è±¡âåä»£ç ï¼èæ¯<strong>ä»¥å½åå®æ¹ææ¡£ä¸ºå</strong>ã</p>
</blockquote>
<p><img alt="PixPin_2026-01-22_10-29-45.png" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3715916/202601/3715916-20260122104737572-1611726017.png" class="lazyload"></p>
<hr>
<h1 id="äºå®éä½éªä¸é®é¢åæ">äºãå®éä½éªä¸é®é¢åæ</h1>
<h2 id="çå®ç»è®ºåªæä¸å¥è¯">çå®ç»è®ºåªæä¸å¥è¯ï¼</h2>
<blockquote>
<p><strong>ææææ¾æåï¼ä½ä¾ç¶ä¸è½âä¸æ¬¡çæç´æ¥å¯ç¨âã</strong></p>
</blockquote>
<h2 id="ä¼ç¹">ä¼ç¹</h2>
<ul>
<li>API ä½¿ç¨ææ¾æ´æ¥è¿ææ°ææ¡£</li>
<li>è¿æ¶åæ°ãåºå¼æ¹æ³æ¾èåå°</li>
<li>å·¥ç¨ç»ææ´åçï¼æè·¯æ´ååâçå®é¡¹ç®â</li>
</ul>
<h2 id="ä»ç¶å­å¨çé®é¢">ä»ç¶å­å¨çé®é¢</h2>
<ul>
<li>å¤æææ¯æ ç»åï¼LangChain + LangGraph + Milvus + Langfuseï¼</li>
<li>ä»ç¶éè¦ <strong>å¤è½®è°è¯æè½å®å¨è·é</strong></li>
<li>æäºè¾¹çç¨æ³ä¾ç¶å­å¨åå·®</li>
</ul>
<h2 id="æçå¤æ­">æçå¤æ­</h2>
<blockquote>
<p><strong>å¹¶ä¸æ¯ context7 ä¸è¡ï¼èæ¯æ¨¡åçæéåº¦ï¼ä¾ç¶è½åäºæ¡æ¶æ¼è¿éåº¦ã</strong></p>
</blockquote>
<p>context7 åå°çæ¯ï¼</p>
<ul>
<li>è®© Claude <em>çå¾å°</em> ææ°ææ¡£</li>
<li>ä½æç»âæä¹æ¼èµ·æ¥âï¼ä»ç¶ä¾èµæ¨¡åæ¬èº«çæ¨çä¸ä»£ç è½å</li>
</ul>
<hr>
<h1 id="å­æ»ç»">å­ãæ»ç»</h1>
<p>å¦æä½ æ­£å¨ä½¿ç¨ Claude Code ååå·¥ç¨åãåä¼ä¸çº§çé¡¹ç®å¼åï¼æçå»ºè®®æ¯ï¼</p>
<p>â <strong>ä¸å®è¦ä¸ Agent Skills</strong></p>
<p>â <strong>è½ç¨ context7 å°±ç¨ context7</strong></p>
<p>â ä¸è¦åå®å¨ç¸ä¿¡âæ¨¡åè®°å¿éç APIâ</p>
<p>ä½åæ¶ä¹è¦æä¸ä¸ªæ¸éè®¤ç¥ï¼</p>
<blockquote>
<p><strong>AI è¾å©å¼å = æ´å¿«çèµ·ç¹ï¼èä¸æ¯åè°è¯çç»ç¹ã</strong></p>
</blockquote>
<p>å¨å½åé¶æ®µï¼æçæ³çæ¨¡å¼ä¾ç¶æ¯ï¼</p>
<blockquote>
<p><strong>AI çæ + äººç±» Review + å¤è½®ä¿®æ­£</strong></p>
</blockquote>
<p>åç»­æä¹ä¼ç»§ç»­è®°å½ Claude Code + MCP + å¤æ¨¡ååä½ çå®è·µç»éªï¼æ¬¢è¿å³æ³¨ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-22 10:56">2026-01-22 10:55</span>&nbsp;
<a href="https://www.cnblogs.com/bugshare">BugShare</a>&nbsp;
éè¯»(<span id="post_view_count">239</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19515937);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19515937', targetLink: 'https://www.cnblogs.com/bugshare/p/19515937', title: 'Claude Code æ¯æéç£æ©å± Skills ââ ç¨ææ° API æå»ºæ´é è°±ç AI é¡¹ç®' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>