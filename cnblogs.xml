<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-01-20T20:41:33.554Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ ä¸ºä»ä¹ IO æµéå¸¸åªè½è¢«è¯»åä¸æ¬¡ ]]></title>
    <link>https://www.cnblogs.com/yanshajiuzhou/p/19508716</link>
    <guid>8d3025a7d271c46f648b13878349879c</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/yanshajiuzhou/p/19508716" title="åå¸äº 2026-01-20 20:22">
    <span role="heading" aria-level="2">ä¸ºä»ä¹ IO æµéå¸¸åªè½è¢«è¯»åä¸æ¬¡</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        IO æµåªè½è¯»åä¸æ¬¡ï¼æ¯ ç²¾å¿è®¾è®¡çï¼è´´åæä½ç³»ç»æä»¶ / ç½ç» IO ç "é¡ºåºæ¶è´¹"&nbsp;ç¹æ§ï¼ä¿æååºå±ç³»ç»çä¸è´æ§ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>ä»å¤©æä»¬æ¥ä¸èµ·æ¢è®¨ä¸&nbsp;ä¸ºä»ä¹<strong> IO æµ</strong>éå¸¸åªè½è¢«è¯»åä¸æ¬¡ï¼</p>
<p>æä¸ºä»ä¹ä¼ååºè¿ä¸ªçé®å¢ï¼æ¯å ä¸ºæç ç©¶Webå¼åä¸­çä¸ä¸ªé®é¢æ¶ï¼HTTPè¯·æ±ä½å¨ <strong>Filterï¼è¿æ»¤å¨ï¼</strong>å¤è¢«è¯»åäºä¹åï¼å¨ Controllerï¼æ§å¶å±ï¼å°±è¯»ä¸å°å¼äºï¼ä½¿ç¨ @RequestBody çæ¶åã</p>
<p>æ è®ºæ¯å­èæµï¼InputStream / OutputStreamï¼è¿æ¯å­ç¬¦æµï¼Reader / Writerï¼ï¼ææåºäºæµçè¯»åæä½é½ä¼ç»´æ¤ä¸ä¸ª <strong>"ä½ç½®æé"</strong>ã</p>
<ul>
<li>åå§ç¶æä¸ï¼æéæåæµçèµ·å§ä½ç½®<strong>ï¼position = 0ï¼</strong>ï¼</li>
<li>æ¯æ¬¡è°ç¨ <strong>read() / read(byte[]) / read(char[])</strong> ç­è¯»åæ¹æ³æ¶ï¼æéä¼ååç§»å¨å¯¹åºå­èæ°ï¼</li>
<li>å½æéç§»å¨å°æµçæ«å°¾ï¼æ²¡ææ´å¤æ°æ®ï¼ï¼read() æ¹æ³ä¼è¿å <strong>-1</strong>ï¼è¡¨ç¤ºæµè¯»åå®æ¯ï¼</li>
<li>æéç§»å¨åä¸ä¼èªå¨åéï¼ä¹æ æ³ååç§»å¨ï¼é¤éæµæ¾å¼æ¯æéç½®ï¼ï¼å æ­¤åæ¬¡è¯»ååªè½å¾å° <strong>-1</strong>ã</li>
</ul>
<p><strong>ç±»æ¯</strong>ï¼<strong>IO æµ</strong>çè¯»åè¿ç¨ï¼å°±åç¨ <strong>ç£å¸¦æ­æ¾å¨å¬ç£å¸¦</strong> ââ ç£å¤´ï¼å¯¹åºæµçä½ç½®æéï¼ä»ç£å¸¦å¼å¤´ï¼æé 0ï¼å¼å§ç§»å¨ï¼æ¯è¯»ä¸ä¸ªå­è / å­ç¬¦ï¼ç£å¤´å°±å¾åèµ°ä¸æ­¥ï¼å½ç£å¤´èµ°å°ç£å¸¦æ«å°¾ï¼åç»§ç»­æ­æ¾ï¼è¯»åï¼å°±åªè½å¬å° "æ²æ²å£°"ï¼æµè¿å <strong>-1</strong>ï¼ï¼å¹¶ä¸ç£å¤´ä¸ä¼èªå¨åå°å¼å¤´ã</p>
<p>å½ç¶ï¼<strong>ä¸æ¯æææµé½åªè½è¯»ä¸æ¬¡</strong>ï¼<strong>åºäºåå­çæµ</strong>ï¼å¦ <strong>ByteArrayInputStream / CharArrayReader</strong>ï¼æ¯æéç½®æéï¼å ä¸ºå®ä»¬çæ°æ®æºæ¯åå­ä¸­çæ°ç»ï¼<strong>æ°æ®ä¸ä¼æ¶å¤±</strong>ï¼ï¼å¯ä»¥éè¿ <strong>mark()</strong> å <strong>reset()&nbsp;</strong>æ¹æ³å°æé <strong>æ¢å¤</strong> å°æ è®°ä½ç½®ã</p>
<p>éè¦æ³¨æï¼</p>
<ul>
<li>è°ç¨ <strong>reset()&nbsp;</strong>åå¿é¡»åè°ç¨ <strong>mark(int readlimit)</strong>ï¼</li>
<li>ä¸æ¯æææµé½æ¯æ <strong>mark() / reset()</strong>ï¼å¯ä»¥éè¿ <strong>inputStream.markSupported()</strong> æ¥è¿è¡å¤æ­ã</li>
</ul>
<p><strong>ä½¿ç¨ mark() å reset() æ¹æ³ï¼</strong></p>
<pre class="language-java highlighter-hljs"><code>// ä»éç¨äºæ¯æmarkçæµ
public void processWithMark(InputStream input) throws IOException {
    if (!input.markSupported()) {
        throw new IOException("Mark not supported");
    }
    
    // æ è®°å½åä½ç½®ï¼åæ°100è¡¨ç¤ºæå¤å¯åé100å­è
    input.mark(100);
    
    // ç¬¬ä¸æ¬¡è¯»å
    byte[] firstRead = new byte[50];
    input.read(firstRead);
    System.out.println("First read: " + new String(firstRead));
    
    // éç½®å°æ è®°ä½ç½®
    input.reset();
    
    // ç¬¬äºæ¬¡è¯»åï¼ç¸ååå®¹ï¼
    byte[] secondRead = new byte[50];
    input.read(secondRead);
    System.out.println("Second read: " + new String(secondRead));
}</code></pre>
<p>ä½¿ç¨ <strong>åè£ç±»</strong> è§£å³ä¸ææä»¬æå°ç&nbsp;<strong>HTTPè¯·æ±ä½å¤æ¬¡è¯»å </strong>çé®é¢ï¼</p>
<pre class="language-java highlighter-hljs"><code>public class MyRequestWrapper extends HttpServletRequestWrapper {
    private final byte[] body; // ç¼å­è¯·æ±ä½çå­èæ°ç»

    public MyRequestWrapper(HttpServletRequest request) throws IOException {
        super(request);
        // å³é®æ­¥éª¤ï¼å¨æé æ¶ä¸æ¬¡æ§è¯»åå¹¶å­å¨åå§è¯·æ±æµ
        body = StreamUtils.copyToByteArray(request.getInputStream());
    }

    // æä¾ä¸ä¸ªä¾¿æ·æ¹æ³ï¼ç¨äºå¨è¿æ»¤å¨ä¸­è·åè¯·æ±ä½åå®¹ï¼ä¾å¦è®°å½æ¥å¿ï¼
    // ä½¿ç¨æ¶ï¼ç´æ¥è°ç¨ getBodyString() å³å¯
    public String getBodyString() throws UnsupportedEncodingException {
        return new String(body, this.getCharacterEncoding());
    }

    @Override
    public ServletInputStream getInputStream() throws IOException {
        // æ¯æ¬¡è°ç¨é½è¿åä¸ä¸ªåºäºç¼å­æ°æ®çæ°æµ
        ByteArrayInputStream bais = new ByteArrayInputStream(body);
        return new ServletInputStream() {
            @Override
            public int read() {
                return bais.read();
            }

            @Override
            public boolean isFinished() {
                return bais.available() == 0;
            }

            @Override
            public boolean isReady() {
                return true;
            }

            @Override
            public void setReadListener(ReadListener readListener) {
                // æ éå®ç°
            }
        };
    }

    @Override
    public BufferedReader getReader() throws IOException {
        return new BufferedReader(new InputStreamReader(this.getInputStream(), this.getCharacterEncoding()));
    }
}</code></pre>
<p>ç¶åå¨ <strong>è¿æ»¤å¨</strong> å¤åè£è¯·æ±ï¼</p>
<pre class="language-java highlighter-hljs"><code>@Slf4j
@Configuration
public class RequestCachingFilterConfig {

    @Bean
    public FilterRegistrationBean requestCachingFilter() {
        FilterRegistrationBean registrationBean = new FilterRegistrationBean();

        // æ ¸å¿ï¼åå»ºè¿æ»¤å¨ï¼åè£è¯·æ±ä¸º ContentCachingRequestWrapper
        registrationBean.setFilter(new OncePerRequestFilter() {
            @Override
            protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)
                    throws ServletException, IOException {
                // 1. ä»åè£ HTTP è¯·æ±ï¼æé¤ WebSocket ç­ï¼
                if (request instanceof HttpServletRequest &amp;&amp; !(request instanceof ContentCachingRequestWrapper)) {
                    log.info("==========è¿å¥requestCachingFilter========");
                    // 2. åè£è¯·æ±ï¼èªå¨ç¼å­è¯·æ±ä½ï¼
                    MyRequestWrapper wrappedRequest = new MyRequestWrapper(request);
                    filterChain.doFilter(wrappedRequest, response); // ä¼ éåè£åçè¯·æ±
                } else {
                    filterChain.doFilter(request, response); // æ éåè£ï¼ç´æ¥æ¾è¡
                }
            }
        });

        // 3. éç½®æ¦æªææè¯·æ±ï¼å¯æ ¹æ®éæ±è°æ´ URL æ¨¡å¼ï¼
        registrationBean.addUrlPatterns("/*");
        registrationBean.setOrder(1); // ä¼åçº§æé«ï¼ç¡®ä¿åäºå¶ä»è¿æ»¤å¨æ§è¡
        registrationBean.setName("requestCachingFilter");
        return registrationBean;
    }
}</code></pre>
<p><strong>IO æµ</strong>åªè½è¯»åä¸æ¬¡ï¼æ¯ <strong>ç²¾å¿è®¾è®¡ç</strong>ï¼è´´åæä½ç³»ç»æä»¶ / ç½ç» IO ç <strong>"é¡ºåºæ¶è´¹"</strong>&nbsp;ç¹æ§ï¼ä¿æååºå±ç³»ç»çä¸è´æ§ã</p>
<p style="text-align: right"><span style="color: rgba(53, 152, 219, 1)">å¤å¨å½¢å¼è¶ç®åçä¸è¥¿ï¼æºæ§å«éè¶é«ï¼å ä¸ºå®å·²ç»ä¸åä¾èµå½¢å¼ï¼å¿é¡»ä¾é æºæ§ã-- çæ²ä¹æ´²</span></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-20 20:23">2026-01-20 20:22</span>&nbsp;
<a href="https://www.cnblogs.com/yanshajiuzhou">çæ²ä¹æ´²</a>&nbsp;
éè¯»(<span id="post_view_count">6</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19508716);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19508716', targetLink: 'https://www.cnblogs.com/yanshajiuzhou/p/19508716', title: 'ä¸ºä»ä¹ IO æµéå¸¸åªè½è¢«è¯»åä¸æ¬¡' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ åå« throw exceptionï¼ä¸ºä»ä¹ Result<T> ææ¯ä¸å¡é»è¾çæ­£ç¡®éæ© ]]></title>
    <link>https://www.cnblogs.com/diamondhusky/p/19508626</link>
    <guid>5b146f83f56da1052f4440a052407726</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/diamondhusky/p/19508626" title="åå¸äº 2026-01-20 19:40">
    <span role="heading" aria-level="2">åå« throw exceptionï¼ä¸ºä»ä¹ Result&lt;T&gt; ææ¯ä¸å¡é»è¾çæ­£ç¡®éæ©</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p></p><div class="toc"><div class="toc-container-header">ç®å½</div><ul><li><a href="#å¼è¨ä¸ä¸ªæ®éå­å¨çåå³é" rel="noopener nofollow">å¼è¨ï¼ä¸ä¸ªæ®éå­å¨çâåå³éâ</a></li><li><a href="#ä¸å¼å¸¸çåç½ª--æä»¬ä¸ç´å¨æ»¥ç¨å®" rel="noopener nofollow">ä¸ãå¼å¸¸çâåç½ªâ ââ æä»¬ä¸ç´å¨æ»¥ç¨å®</a><ul><li><a href="#11-å¼å¸¸çæ¬è´¨æ¯ä»ä¹" rel="noopener nofollow">1.1 å¼å¸¸çæ¬è´¨æ¯ä»ä¹ï¼</a></li><li><a href="#12-ä¸å¡é»è¾--å¼å¸¸æåµ" rel="noopener nofollow">1.2 ä¸å¡é»è¾ â  å¼å¸¸æåµ</a></li></ul></li><li><a href="#äºresultä¸å¡é»è¾çä¼ééçº§" rel="noopener nofollow">äºãResult<t>ââä¸å¡é»è¾ç"ä¼ééçº§"</t></a><ul><li><a href="#21-ä»ä¹æ¯result" rel="noopener nofollow">2.1 ä»ä¹æ¯Result<t>ï¼</t></a></li><li><a href="#22-å¦ä½æ­£ç¡®ä½¿ç¨result" rel="noopener nofollow">2.2 å¦ä½æ­£ç¡®ä½¿ç¨Result<t>ï¼</t></a></li></ul></li><li><a href="#ä¸æ§è½å¯¹å³--å è¿ç¢¾åçæ§è½å·®è·" rel="noopener nofollow">ä¸ãæ§è½å¯¹å³ ââ å è¿ç¢¾åçæ§è½å·®è·</a><ul><li><a href="#31-é¨åæµè¯ä»£ç " rel="noopener nofollow">3.1 é¨åæµè¯ä»£ç </a></li><li><a href="#32-æµè¯ç»æè§¦ç®æå¿" rel="noopener nofollow">3.2 æµè¯ç»æï¼è§¦ç®æå¿</a></li><li><a href="#33-å¹¶ååºæ¯ä¸æ§è½å·®è·ä¾æ§ä¸å¿ç´è§" rel="noopener nofollow">3.3 å¹¶ååºæ¯ä¸ï¼æ§è½å·®è·ä¾æ§ä¸å¿ç´è§</a></li></ul></li><li><a href="#åä¸ºä»ä¹å¼å¸¸å¨ä¸å¡åºæ¯ä¸å¦æ­¤æè´µ" rel="noopener nofollow">åãä¸ºä»ä¹å¼å¸¸å¨ä¸å¡åºæ¯ä¸å¦æ­¤"æè´µ"ï¼</a><ul><li><a href="#41-clrå¼å¸¸æºå¶çåºå±åç" rel="noopener nofollow">4.1 CLRå¼å¸¸æºå¶çåºå±åç</a><ul><li><a href="#411-å¼å¸¸å¯¹è±¡çæé è¿ç¨" rel="noopener nofollow">4.1.1 å¼å¸¸å¯¹è±¡çæé è¿ç¨</a></li><li><a href="#412-å æ è·è¸ªççå®ä»£ä»·" rel="noopener nofollow">4.1.2 å æ è·è¸ªççå®ä»£ä»·</a></li><li><a href="#413-jitåaotç¼è¯å¯¹å¼å¸¸çå½±å" rel="noopener nofollow">4.1.3 JITåAOTç¼è¯å¯¹å¼å¸¸çå½±å</a></li></ul></li><li><a href="#42-å¼å¸¸å¤ççåå­åéç»è" rel="noopener nofollow">4.2 å¼å¸¸å¤ççåå­åéç»è</a><ul><li><a href="#421-å¼å¸¸å¯¹è±¡çåå­å¸å±" rel="noopener nofollow">4.2.1 å¼å¸¸å¯¹è±¡çåå­å¸å±</a></li><li><a href="#422-gcçå½±å" rel="noopener nofollow">4.2.2 GCçå½±å</a></li></ul></li><li><a href="#43-cpuçº§å«çæ§è½å½±å" rel="noopener nofollow">4.3 CPUçº§å«çæ§è½å½±å</a><ul><li><a href="#431-ç°ä»£cpuçå¼å¸¸å¤çå¼é" rel="noopener nofollow">4.3.1 ç°ä»£CPUçå¼å¸¸å¤çå¼é</a></li><li><a href="#432-å¯¹æ¯æ­£å¸¸è¿ååå¼å¸¸è¿å" rel="noopener nofollow">4.3.2 å¯¹æ¯æ­£å¸¸è¿ååå¼å¸¸è¿å</a></li></ul></li><li><a href="#44-å¯¹æ¯å¶ä»ç¼ç¨è¯­è¨" rel="noopener nofollow">4.4 å¯¹æ¯å¶ä»ç¼ç¨è¯­è¨</a><ul><li><a href="#441-javaçå¼å¸¸æºå¶" rel="noopener nofollow">4.4.1 Javaçå¼å¸¸æºå¶</a></li><li><a href="#442-goçéè¯¯å¤çå²å­¦" rel="noopener nofollow">4.4.2 Goçéè¯¯å¤çå²å­¦</a></li><li><a href="#443-rustçresultç±»å" rel="noopener nofollow">4.4.3 RustçResultç±»å</a></li><li><a href="#444-cçéè¯¯å¤ç" rel="noopener nofollow">4.4.4 C++çéè¯¯å¤ç</a></li></ul></li><li><a href="#45-net-coreçæ¹è¿åå±é" rel="noopener nofollow">4.5 .NET Coreçæ¹è¿åå±é</a></li></ul></li><li><a href="#äºresultçè¿é¶ä¼å¿" rel="noopener nofollow">äºãResult<t>çè¿é¶ä¼å¿</t></a><ul><li><a href="#51-ä¸°å¯çéè¯¯ä¿¡æ¯" rel="noopener nofollow">5.1 ä¸°å¯çéè¯¯ä¿¡æ¯</a></li><li><a href="#52-å½æ°å¼ç¼ç¨æ¯æ" rel="noopener nofollow">5.2 å½æ°å¼ç¼ç¨æ¯æ</a></li><li><a href="#53-æ´å¥½çapiè®¾è®¡" rel="noopener nofollow">5.3 æ´å¥½çAPIè®¾è®¡</a></li></ul></li><li><a href="#å­-resultæ¨¡å¼çä¸äºå¼ç«¯" rel="noopener nofollow">å­ã Result<t>æ¨¡å¼çä¸äºå¼ç«¯</t></a><ul><li><a href="#61-ifå°ç±é®é¢æ¡ä»¶å¤æ­æ³æ»¥" rel="noopener nofollow">6.1 "ifå°ç±"é®é¢ï¼æ¡ä»¶å¤æ­æ³æ»¥ï¼</a></li><li><a href="#62-å¼ç±»åstructvs-å¼ç¨ç±»åclassçä¸¤é¾éæ©" rel="noopener nofollow">6.2 å¼ç±»åï¼structï¼vs å¼ç¨ç±»åï¼classï¼çä¸¤é¾éæ©</a></li><li><a href="#63-å¼æ­¥ç¼ç¨çå¤ææ§" rel="noopener nofollow">6.3 å¼æ­¥ç¼ç¨çå¤ææ§</a></li><li><a href="#64-ç±»åç³»ç»åé¿" rel="noopener nofollow">6.4 ç±»åç³»ç»åé¿</a></li><li><a href="#65-å¶ä»é®é¢" rel="noopener nofollow">6.5 å¶ä»é®é¢</a></li></ul></li><li><a href="#ä¸å¸¸è§é®é¢ä¸ç­ç" rel="noopener nofollow">ä¸ãå¸¸è§é®é¢ä¸ç­ç</a></li><li><a href="#å«æ»ç»" rel="noopener nofollow">å«ãæ»ç»</a></li></ul></div><p></p>
<h1 id="å¼è¨ä¸ä¸ªæ®éå­å¨çåå³é">å¼è¨ï¼ä¸ä¸ªæ®éå­å¨çâåå³éâ</h1>
<p>å¦æä½ å¨C#é¡¹ç®ä¸­çå°è¿æ ·çä»£ç ï¼ä¸å®ä¸ä¼æå°éçï¼</p>
<pre><code class="language-csharp">public User Login(string username, string password)
{
    var user = FindUser(username);
    if (user == null)
        throw new Exception("ç¨æ·ä¸å­å¨");  // â çæçæ¨¡å¼
    
    if (!VerifyPassword(user, password))
        throw new Exception("å¯ç éè¯¯");    // â å¦ä¸ä¸ªçæçæ¨¡å¼
    
    return user;
}
</code></pre>
<p>è¿ç§ä½¿ç¨å¼å¸¸æ¥å¤çä¸å¡é»è¾çåæ³ï¼å ä¹æäºC#å¼åçâæ åèå¼âã<br>
å¯æ¯ï¼<strong>ä»æ¥å¦æ­¤ï¼ä¾¿æ¯å¯¹çä¹ï¼</strong></p>
<h1 id="ä¸å¼å¸¸çåç½ª--æä»¬ä¸ç´å¨æ»¥ç¨å®">ä¸ãå¼å¸¸çâåç½ªâ ââ æä»¬ä¸ç´å¨æ»¥ç¨å®</h1>
<h2 id="11-å¼å¸¸çæ¬è´¨æ¯ä»ä¹">1.1 å¼å¸¸çæ¬è´¨æ¯ä»ä¹ï¼</h2>
<p>é¦åï¼æä»¬è¦æç½C#è¯­è¨éçå¼å¸¸ï¼Exceptionï¼çè®¾è®¡åè¡·ï¼</p>
<pre><code class="language-csharp">// è¿äºææ¯å¼å¸¸çæ­£çä½¿ç¨åºæ¯ï¼
public void ReadFile(string path)
{
    if (string.IsNullOrEmpty(path))
        throw new ArgumentNullException(nameof(path));  // â åæ°æ£æ¥
    
    if (!File.Exists(path))
        throw new FileNotFoundException($"æä»¶ä¸å­å¨: {path}");  // â ç³»ç»éè¯¯
    
    // å°è¯è¯»åæä»¶ï¼å¯è½æåºIOExceptionç­
    var content = File.ReadAllText(path);
}
</code></pre>
<p>å¼å¸¸æ¯ä¸ºçæ­£ç"å¼å¸¸æåµ"è®¾è®¡çï¼æ¯å¦ï¼</p>
<ul>
<li>ç³»ç»èµæºä¸å¯ç¨ï¼æä»¶ä¸å­å¨ãæ°æ®åºè¿æ¥å¤±è´¥ï¼</li>
<li>ç¨åºç¶æå¼å¸¸ï¼ç©ºæéãæ°ç»è¶çï¼</li>
<li>åæ°éªè¯å¤±è´¥ï¼åç½®æ¡ä»¶ä¸æ»¡è¶³ï¼</li>
</ul>
<h2 id="12-ä¸å¡é»è¾--å¼å¸¸æåµ">1.2 ä¸å¡é»è¾ â  å¼å¸¸æåµ</h2>
<p>ä¸å¡éè¯¯ï¼ç¨æ·ä¸å­å¨ãå¯ç éè¯¯ãä½é¢ä¸è¶³ï¼æ¯<strong>å¯é¢è§çæ­£å¸¸ä¸å¡æµç¨</strong>ï¼èä¸æ¯å¼å¸¸æåµã<br>
æä¸å¡éè¯¯ç¨å¼å¸¸å¤çï¼å°±åï¼</p>
<ul>
<li>ç¨"å°éè­¦æ¥"æ¥å¤ç"å®¶éæ²¡ç±³äº"</li>
<li>ç¨"æ¶é²è½¦"æ¥è¿é"å¿«éåè£¹"</li>
<li>ç¨"ææ¯å®¤"æ¥å¤ç"æååç§"</li>
</ul>
<p>è¿æ¯å¯¹å¼å¸¸æºå¶çä¸¥éæ»¥ç¨ï¼</p>
<h1 id="äºresultä¸å¡é»è¾çä¼ééçº§">äºãResult<t>ââä¸å¡é»è¾ç"ä¼ééçº§"</t></h1>
<h2 id="21-ä»ä¹æ¯result">2.1 ä»ä¹æ¯Result<t>ï¼</t></h2>
<p>ä¸ä¸ªç®åï¼å·å¤åºæ¬åè½çResultç±»å¦ä¸ï¼</p>
<pre><code class="language-csharp">public class Result&lt;T&gt;
{
    public bool Success { get; }
    public T? Value { get; }
    public string? Error { get; }
    
    private Result(T value) { Success = true; Value = value; Error = null; }
    private Result(string error) { Success = false; Value = default; Error = error; }
    
    public static Result&lt;T&gt; Ok(T value) =&gt; new(value);
    public static Result&lt;T&gt; Fail(string error) =&gt; new(error);
}
</code></pre>
<h2 id="22-å¦ä½æ­£ç¡®ä½¿ç¨result">2.2 å¦ä½æ­£ç¡®ä½¿ç¨Result<t>ï¼</t></h2>
<pre><code class="language-csharp">public Result&lt;User&gt; Login(string username, string password)
{
    if (string.IsNullOrEmpty(username))
        return Result&lt;User&gt;.Fail("ç¨æ·åä¸è½ä¸ºç©º");  // â æç¡®è¿åä¸å¡éè¯¯
    
    if (string.IsNullOrEmpty(password))
        return Result&lt;User&gt;.Fail("å¯ç ä¸è½ä¸ºç©º");    // â æç¡®è¿åä¸å¡éè¯¯
    
    var user = FindUser(username);
    if (user == null)
        return Result&lt;User&gt;.Fail("ç¨æ·ä¸å­å¨");      // â æç¡®è¿åä¸å¡éè¯¯
    
    if (!VerifyPassword(user, password))
        return Result&lt;User&gt;.Fail("å¯ç éè¯¯");        // â æç¡®è¿åä¸å¡éè¯¯
    
    return Result&lt;User&gt;.Ok(user);                   // â æç¡®è¿åæå
}
</code></pre>
<h1 id="ä¸æ§è½å¯¹å³--å è¿ç¢¾åçæ§è½å·®è·">ä¸ãæ§è½å¯¹å³ ââ å è¿ç¢¾åçæ§è½å·®è·</h1>
<h2 id="31-é¨åæµè¯ä»£ç ">3.1 é¨åæµè¯ä»£ç </h2>
<p>é¡¹ç®ç¯å¢ï¼</p>
<pre><code>&lt;Project Sdk="Microsoft.NET.Sdk"&gt;
	&lt;PropertyGroup&gt;
		&lt;OutputType&gt;Exe&lt;/OutputType&gt;
		&lt;TargetFramework&gt;net8.0&lt;/TargetFramework&gt;
		&lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;
		&lt;Nullable&gt;enable&lt;/Nullable&gt;
		&lt;LangVersion&gt;latest&lt;/LangVersion&gt;
	&lt;/PropertyGroup&gt;
&lt;/Project&gt;
</code></pre>
<p>é¨åæµè¯ä»£ç ï¼</p>
<pre><code class="language-csharp"> public class LoginService
 {
     private readonly Dictionary&lt;string, User&gt; _users = new()
     {
         ["valid_user"] = new User { Id = 1, Username = "valid_user" }
     };

    
     public User LoginWithException(string username, string password)
     {
         if (!_users.TryGetValue(username, out var user))
             throw new BusinessException("ç¨æ·ä¸å­å¨");

         if (password != "correct_password")
             throw new BusinessException("å¯ç éè¯¯");

         return user;
     }

    
     public Result&lt;User&gt; LoginWithResult(string username, string password)
     {
         if (!_users.TryGetValue(username, out var user))
             return Result&lt;User&gt;.Fail("ç¨æ·ä¸å­å¨");

         if (password != "correct_password")
             return Result&lt;User&gt;.Fail("å¯ç éè¯¯");

         return Result&lt;User&gt;.Ok(user);
     }
 }
</code></pre>
<pre><code class="language-csharp">public class PerformanceTester
{
    private readonly LoginService _service = new();
    private readonly Random _random = new(42);

    public void RunAllTests(int iterations = 1000000)
    {
        Console.WriteLine($"æ§è½å¯¹æ¯æµè¯ - è¿­ä»£æ¬¡æ°: {iterations:N0}");
        Console.WriteLine("=".PadRight(60, '='));

        // æµè¯1ï¼æåè·¯å¾ï¼æ­£å¸¸æåµï¼
        TestSuccessPath(iterations);

        // æµè¯2ï¼å¤±è´¥è·¯å¾ï¼éè¯¯æåµï¼
        TestErrorPath(iterations);

        // æµè¯3ï¼æ··åè·¯å¾ï¼30%æåçï¼
        TestMixedPath(iterations, 0.3);
    }

    private void TestSuccessPath(int iterations)
    {
        Console.WriteLine("\næµè¯1ï¼æåè·¯å¾ï¼100%æåï¼");

        // å¼å¸¸æ¹å¼
        var exceptionTime = Measure(() =&gt;
        {
            try
            {
                _service.LoginWithException("valid_user", "correct_password");
            }
            catch
            {
                // ä¸åºè¯¥åç
            }
        }, iterations, "å¼å¸¸æ¹å¼");

        // Resultæ¹å¼
        var resultTime = Measure(() =&gt;
        {
            var result = _service.LoginWithResult("valid_user", "correct_password");
            if (!result.Success)
            {
                // ä¸åºè¯¥åç
            }
        }, iterations, "Resultæ¹å¼");

        PrintComparison(exceptionTime, resultTime);
    }

    private void TestErrorPath(int iterations)
    {
        Console.WriteLine("\næµè¯2ï¼å¤±è´¥è·¯å¾ï¼100%å¤±è´¥ï¼");

        // å¼å¸¸æ¹å¼
        var exceptionTime = Measure(() =&gt;
        {
            try
            {
                _service.LoginWithException("invalid_user", "wrong_password");
            }
            catch (BusinessException)
            {
                // é¢æå¼å¸¸
            }
        }, iterations, "å¼å¸¸æ¹å¼");

        // Resultæ¹å¼
        var resultTime = Measure(() =&gt;
        {
            var result = _service.LoginWithResult("invalid_user", "wrong_password");
            if (result.Success)
            {
                // ä¸åºè¯¥åç
            }
        }, iterations, "Resultæ¹å¼");

        PrintComparison(exceptionTime, resultTime);
    }

    private void TestMixedPath(int iterations, double successRate)
    {
        Console.WriteLine($"\næµè¯3ï¼æ··åè·¯å¾ï¼{successRate:P0}æåçï¼");

        // åå¤æµè¯æ°æ®
        var testData = new (string user, string pwd, bool shouldSucceed)[iterations];
        for (int i = 0; i &lt; iterations; i++)
        {
            testData[i] = _random.NextDouble() &lt; successRate
                ? ("valid_user", "correct_password", true)   // æå
                : ("invalid_user", "wrong_password", false); // å¤±è´¥
        }

        // å¼å¸¸æ¹å¼
        var exceptionTime = MeasureMixed(testData, true, "å¼å¸¸æ¹å¼");

        // Resultæ¹å¼
        var resultTime = MeasureMixed(testData, false, "Resultæ¹å¼");

        PrintComparison(exceptionTime, resultTime);
    }

    private static long Measure(Action action, int iterations, string testName)
    {
        // é¢ç­
        for (int i = 0; i &lt; 1000; i++) action();

        GC.Collect();
        GC.WaitForPendingFinalizers();
        GC.Collect();

        var sw = Stopwatch.StartNew();
        for (int i = 0; i &lt; iterations; i++)
        {
            action();
        }
        sw.Stop();

        var opsPerSecond = iterations / (sw.ElapsedMilliseconds / 1000.0);
        Console.WriteLine($"  {testName}: {sw.ElapsedMilliseconds,8}ms ({opsPerSecond,12:N0} ops/s)");

        return sw.ElapsedMilliseconds;
    }

    private long MeasureMixed(
        (string user, string pwd, bool shouldSucceed)[] testData,
        bool useException,
        string testName)
    {
        // é¢ç­
        for (int i = 0; i &lt; Math.Min(1000, testData.Length); i++)
        {
            var (user, pwd, _) = testData[i];
            if (useException)
            {
                try
                {
                    _service.LoginWithException(user, pwd);
                }
                catch { }
            }
            else
            {
                _service.LoginWithResult(user, pwd);
            }
        }

        GC.Collect();
        GC.WaitForPendingFinalizers();
        GC.Collect();

        var sw = Stopwatch.StartNew();

        if (useException)
        {
            for (int i = 0; i &lt; testData.Length; i++)
            {
                var (user, pwd, _) = testData[i];
                try
                {
                    _service.LoginWithException(user, pwd);
                }
                catch { }
            }
        }
        else
        {
            for (int i = 0; i &lt; testData.Length; i++)
            {
                var (user, pwd, _) = testData[i];
                _service.LoginWithResult(user, pwd);
            }
        }

        sw.Stop();

        var opsPerSecond = testData.Length / (sw.ElapsedMilliseconds / 1000.0);
        Console.WriteLine($"  {testName}: {sw.ElapsedMilliseconds,8}ms ({opsPerSecond,12:N0} ops/s)");

        return sw.ElapsedMilliseconds;
    }

    private static void PrintComparison(long exceptionTime, long resultTime)
    {
        var speedup = exceptionTime / (double)resultTime;
        var improvement = (exceptionTime - resultTime) * 100.0 / exceptionTime;

        if (speedup &gt; 1)
        {
            Console.WriteLine($"Resultæ¯Exceptionå¿« {speedup:F1}xï¼æ§è½æå {improvement:F1}%");
        }
        else
        {
            Console.WriteLine($"å·®å¼ä¸å¤§: {speedup:F2}x");
        }
    }
}
</code></pre>
<h2 id="32-æµè¯ç»æè§¦ç®æå¿">3.2 æµè¯ç»æï¼è§¦ç®æå¿</h2>
<p>åä¸å¾ï¼çæµè¯ç»æ(<strong>åºäºRELEASEæ¨¡å¼ç¼è¯</strong>)ï¼</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1553709/202601/1553709-20260120175226554-1542544296.png" class="lazyload"></p>
<h2 id="33-å¹¶ååºæ¯ä¸æ§è½å·®è·ä¾æ§ä¸å¿ç´è§">3.3 å¹¶ååºæ¯ä¸ï¼æ§è½å·®è·ä¾æ§ä¸å¿ç´è§</h2>
<p>å¹¶åæµè¯æ ¸å¿ä»£ç ï¼</p>
<pre><code class="language-csharp">/// &lt;summary&gt;
/// // å¹¶åæµè¯ç»æç±»
/// &lt;/summary&gt;
public class ConcurrentTestResult
{
    public int Concurrency { get; set; }
    public long ExceptionTime { get; set; }
    public long ResultTime { get; set; }
    public double ExceptionOpsPerSecond { get; set; }
    public double ResultOpsPerSecond { get; set; }
}


/// &lt;summary&gt;
/// å¹¶åæµè¯å¨
/// &lt;/summary&gt;
public class ConcurrentPerformanceTester
{
    private readonly LoginService _service = new();
    private readonly Random _random = new(42);

    private readonly double _errorRate = 0.3;


    public async Task RunConcurrentTests(int totalIterations = 1000000)
    {
        Console.WriteLine("\nå¹¶åæ§è½æµè¯ - æ»è¿­ä»£æ¬¡æ°: {0:N0} - éè¯¯çï¼{1:P0}", totalIterations, _errorRate);
        Console.WriteLine("=".PadRight(60, '='));

        var concurrencyLevels = new[] { 4, 8, 16, 32, 64, 128, 256 };

        foreach (var concurrency in concurrencyLevels)
        {
            Console.WriteLine($"\nå¹¶åæ°: {concurrency}");

            // é¢ç­
            await Warmup(concurrency);

            // å¼å¸¸æ¹å¼å¹¶åæµè¯ï¼30%éè¯¯çæ¨¡æçå®åºæ¯ï¼
            var exceptionTime = await RunConcurrentExceptionTest(
                concurrency,
                totalIterations,
                errorRate: _errorRate
            );

            // Resultæ¹å¼å¹¶åæµè¯
            var resultTime = await RunConcurrentResultTest(
                concurrency,
                totalIterations,
                errorRate: _errorRate
            );

            var exceptionOps = totalIterations / (exceptionTime / 1000.0);
            var resultOps = totalIterations / (resultTime / 1000.0);
            var speedup = exceptionTime / (double)resultTime;

            Console.WriteLine($"  å¼å¸¸: {exceptionTime,5}ms ({exceptionOps,8:N0} ops/s)");
            Console.WriteLine($"  Result: {resultTime,5}ms ({resultOps,8:N0} ops/s)");
            Console.WriteLine($"  Resultå¿« {speedup:F1}x");
        }
    }

    /// &lt;summary&gt;
    /// å¹¶åå¼å¸¸æµè¯
    /// &lt;/summary&gt;
    /// &lt;param name="concurrency"&gt;&lt;/param&gt;
    /// &lt;param name="totalIterations"&gt;&lt;/param&gt;
    /// &lt;param name="errorRate"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    private async Task&lt;long&gt; RunConcurrentExceptionTest(
        int concurrency,
        int totalIterations,
        double errorRate)
    {
        var iterationsPerTask = totalIterations / concurrency;
        var tasks = new Task[concurrency];

        var sw = Stopwatch.StartNew();

        for (int i = 0; i &lt; concurrency; i++)
        {
            // æ¯ä¸ªä»»å¡ä½¿ç¨èªå·±çéæºå®ä¾ï¼é¿åç«äº
            var taskRandom = new Random(_random.Next());
            tasks[i] = Task.Run(() =&gt;
            {
                for (int j = 0; j &lt; iterationsPerTask; j++)
                {
                    // ä¸ºæ¯æ¬¡è¿­ä»£çææµè¯æ°æ®ï¼é¿åç´¢å¼é®é¢
                    var (user, pwd) = GenerateTestDataForIteration(taskRandom, errorRate);
                    try
                    {
                        _service.LoginWithException(user, pwd);
                    }
                    catch (BusinessException)
                    {
                        // é¢æå¼å¸¸
                    }
                }
            });
        }

        await Task.WhenAll(tasks);
        sw.Stop();

        return sw.ElapsedMilliseconds;
    }

    /// &lt;summary&gt;
    /// å¹¶åResultæµè¯
    /// &lt;/summary&gt;
    /// &lt;param name="concurrency"&gt;&lt;/param&gt;
    /// &lt;param name="totalIterations"&gt;&lt;/param&gt;
    /// &lt;param name="errorRate"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    private async Task&lt;long&gt; RunConcurrentResultTest(
        int concurrency,
        int totalIterations,
        double errorRate)
    {
        var iterationsPerTask = totalIterations / concurrency;
        var tasks = new Task[concurrency];

        var sw = Stopwatch.StartNew();

        for (int i = 0; i &lt; concurrency; i++)
        {
            var taskRandom = new Random(_random.Next());
            tasks[i] = Task.Run(() =&gt;
            {
                for (int j = 0; j &lt; iterationsPerTask; j++)
                {
                    var (user, pwd) = GenerateTestDataForIteration(taskRandom, errorRate);
                    var result = _service.LoginWithResult(user, pwd);
                    // ä¸éè¦é¢å¤å¤çï¼Resultå·²ç»åå«äºæå/å¤±è´¥ç¶æ
                }
            });
        }

        await Task.WhenAll(tasks);
        sw.Stop();

        return sw.ElapsedMilliseconds;
    }

    /// &lt;summary&gt;
    /// ä¸ºåæ¬¡è¿­ä»£çææµè¯æ°æ®
    /// &lt;/summary&gt;
    /// &lt;param name="random"&gt;&lt;/param&gt;
    /// &lt;param name="errorRate"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    private static (string user, string pwd) GenerateTestDataForIteration(Random random, double errorRate)
    {
        if (random.NextDouble() &gt; errorRate)
        {
            // æåæ¡ä¾
            return ("valid_user", "correct_password");
        }
        else
        {
            // å¤±è´¥æ¡ä¾ - éæºéæ©å¤±è´¥ç±»å
            if (random.Next(2) == 0)
                return ("invalid_user", "any_password");  // ç¨æ·ä¸å­å¨
            else
                return ("valid_user", "wrong_password");   // å¯ç éè¯¯
        }
    }

    /// &lt;summary&gt;
    /// é¢ç­
    /// &lt;/summary&gt;
    /// &lt;param name="concurrency"&gt;&lt;/param&gt;
    /// &lt;param name="errorRate"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    private async Task Warmup(int concurrency, double errorRate = 0.3)
    {
        var warmupTasks = new Task[Math.Min(concurrency, 4)];

        for (int i = 0; i &lt; warmupTasks.Length; i++)
        {
            warmupTasks[i] = Task.Run(() =&gt;
            {
                var taskRandom = new Random(_random.Next());
                for (int j = 0; j &lt; 100; j++)
                {
                    var (user, pwd) = GenerateTestDataForIteration(taskRandom, errorRate);
                    try
                    {
                        _service.LoginWithException(user, pwd);
                    }
                    catch { }

                    _service.LoginWithResult(user, pwd);
                }
            });
        }

        await Task.WhenAll(warmupTasks);
        GC.Collect();
        GC.WaitForPendingFinalizers();
        GC.Collect();
    }
}
</code></pre>
<p>å¹¶åæµè¯ç»æï¼<br>
<img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1553709/202601/1553709-20260120180104863-50492398.png" class="lazyload"></p>
<p>ä¸è¿°æµè¯å¯è½å¹¶ä¸ä¸¥è°¨åæå¨ï¼ä½æ¯æ´é²åºæ¥çé®é¢è¿æ¯éå¸¸ææ¾çï¼</p>
<ul>
<li>å¨100%å¤±è´¥åºæ¯ä¸ï¼Resultæ¯Exceptionå¿«äºå·®ä¸å¤200å</li>
<li>æ¥è¿å®éä¸å¡åºæ¯ç30%éè¯¯çæåµä¸ï¼Resultæ¯Exceptionä¹å¿«äº160å¤å</li>
<li>å¹¶ååºæ¯ä¸ï¼æ§è½å·®è·ä¹ææ¥è¿ç¾å</li>
</ul>
<h1 id="åä¸ºä»ä¹å¼å¸¸å¨ä¸å¡åºæ¯ä¸å¦æ­¤æè´µ">åãä¸ºä»ä¹å¼å¸¸å¨ä¸å¡åºæ¯ä¸å¦æ­¤"æè´µ"ï¼</h1>
<h2 id="41-clrå¼å¸¸æºå¶çåºå±åç">4.1 CLRå¼å¸¸æºå¶çåºå±åç</h2>
<h3 id="411-å¼å¸¸å¯¹è±¡çæé è¿ç¨">4.1.1 å¼å¸¸å¯¹è±¡çæé è¿ç¨</h3>
<p>å½æä»¬å¨C#ä¸­æåºå¼å¸¸æ¶ï¼çä¼¼ç®åçä¸è¡ä»£ç ï¼èåå´åçäºå¤§éå¤æçæä½ï¼</p>
<pre><code class="language-csharp">throw new BusinessException("ç¨æ·ä¸å­å¨");
</code></pre>
<p>è¿ä¸ªæä½çå®éæ§è¡æµç¨å¦ä¸ï¼</p>
<pre><code class="language-csharp">// ä¼ªä»£ç å±ç¤ºå¼å¸¸æé çå®éå¼é
public static Exception CreateException(string message)
{
    // 1. å åéï¼å¼å¸¸å¯¹è±¡æ¬èº«ï¼è³å°40-64å­èï¼
    var exception = RuntimeHelpers.AllocateException(typeof(BusinessException));
    
    // 2. å­æ®µåå§åï¼è°ç¨æé å½æ°é¾ï¼
    exception._message = message;  // å­ç¬¦ä¸²åé
    exception._stackTrace = null;
    exception._innerException = null;
    exception._helpURL = null;
    exception._source = null;
    
    // 3. æè·è°ç¨å æ ï¼ææè´µçé¨åï¼ï¼
    exception.CaptureStackTrace();
    
    return exception;
}

private void CaptureStackTrace()
{
    // 4. è·åå½åçº¿ç¨çè°ç¨å æ 
    var frames = new StackFrame[64];  // åéæ°ç»
    var frameCount = StackTraceHelper.CaptureStackTrace(
        frames, 0,  // èµ·å§ä½ç½®
        false,      // æ¯å¦éè¦æä»¶ä¿¡æ¯
        null);      // å¼å¸¸å¯¹è±¡æ¬èº«
    
    // 5. æ ¼å¼åæå­ç¬¦ä¸²ï¼å¯è½æ¶åå¤§éå­ç¬¦ä¸²æä½ï¼
    this._stackTrace = FormatStackTrace(frames, frameCount);
}
</code></pre>
<h3 id="412-å æ è·è¸ªççå®ä»£ä»·">4.1.2 å æ è·è¸ªççå®ä»£ä»·</h3>
<p>è®©æä»¬æ·±å¥çç<code>CaptureStackTrace</code>å°åºåäºä»ä¹ï¼</p>
<pre><code class="language-csharp">// Windowsä¸çå®éå®ç°ï¼ç®åï¼
internal static unsafe int CaptureStackTrace(
    StackFrame[] frames, 
    int startIndex,
    bool needFileInfo,
    Exception exception)
{
    // 1. è°ç¨ç³»ç»APIè·åå½åçº¿ç¨çä¸ä¸æ
    CONTEXT context;
    RtlCaptureContext(&amp;context);
    
    // 2. éåè°ç¨å æ ï¼æ§è½ææï¼ï¼
    STACKFRAME64 stackFrame = new STACKFRAME64();
    while (StackWalk64(
        IMAGE_FILE_MACHINE_AMD64,
        GetCurrentProcess(),
        GetCurrentThread(),
        &amp;stackFrame,
        &amp;context,
        null,
        SymFunctionTableAccess64,
        SymGetModuleBase64,
        null))
    {
        // 3. è§£ææ¯ä¸ªæ å¸§çä¿¡æ¯
        frames[frameCount++] = new StackFrame(
            stackFrame.AddrPC.Offset,
            needFileInfo ? GetSourceInfo(stackFrame) : null);
        
        if (frameCount &gt;= frames.Length) break;
    }
    
    return frameCount;
}
</code></pre>
<p>å³é®ç¹ï¼</p>
<ul>
<li>æ¯ä¸ªthrowæä½é½è¦éåæ´ä¸ªè°ç¨å æ </li>
<li>å æ éåæ¶åå¤ä¸ªç³»ç»è°ç¨ååå­è®¿é®</li>
<li>éè¦å°åå­å°åè§£æä¸ºæ¹æ³åãæä»¶åãè¡å·ç­</li>
<li>å¨Releaseæ¨¡å¼ä¸ï¼JITä¼åå¯è½ä¼å½±åå æ ä¿¡æ¯</li>
</ul>
<h3 id="413-jitåaotç¼è¯å¯¹å¼å¸¸çå½±å">4.1.3 JITåAOTç¼è¯å¯¹å¼å¸¸çå½±å</h3>
<pre><code class="language-csharp">// èèä»¥ä¸ä»£ç 
public int Process(int value)
{
    try
    {
        return ProcessValue(value);  // å¯è½æåºå¼å¸¸
    }
    catch (Exception)
    {
        return -1;
    }
}

// JITç¼è¯å¨éè¦çæï¼
// 1. æ­£å¸¸æ§è¡è·¯å¾çä»£ç 
// 2. å¼å¸¸å¤çè¡¨ï¼EHè¡¨ï¼
// 3. å æ å±å¼ä»£ç 
// 4. finallyåæ§è¡é»è¾ï¼å¦ææï¼
</code></pre>
<p>EHè¡¨çç»æï¼</p>
<pre><code>Method Exception Handling Table:
Start   Length  Handler Type    Class           Filter
0x0000  0x0020  0x0030  CLAUSE  Exception       null
</code></pre>
<p>æ¯ä¸ªtry-catchåé½ä¼å¨æ¹æ³çåæ°æ®ä¸­æ·»å EHè¡¨æ¡ç®ï¼å¢å æ¹æ³å¤§å°åå è½½æ¶é´ã</p>
<h2 id="42-å¼å¸¸å¤ççåå­åéç»è">4.2 å¼å¸¸å¤ççåå­åéç»è</h2>
<h3 id="421-å¼å¸¸å¯¹è±¡çåå­å¸å±">4.2.1 å¼å¸¸å¯¹è±¡çåå­å¸å±</h3>
<pre><code class="language-csharp">// Exceptionç±»çç®ååå­å¸å±
class Exception
{
    // å¯¹è±¡å¤´ï¼8-16å­èï¼
    MethodTable* _methodTable;  // 8å­è
    // åæ­¥åç´¢å¼ï¼å¯éï¼
    
    // å®ä¾å­æ®µ
    string _message;           // 8å­èï¼å¼ç¨ï¼
    IDictionary _data;         // 8å­èï¼éå¸¸ä¸ºnullï¼
    Exception _innerException; // 8å­è
    string _helpURL;          // 8å­è
    string _source;           // 8å­è
    string _stackTrace;       // 8å­èï¼å­ç¬¦ä¸²ï¼å®éåéæ´å¤§ï¼
    object _stackTraceString; // 8å­èï¼å¯è½ä¸åæ ¼å¼ï¼
    object _remoteStackTrace; // 8å­è
    int _remoteStackIndex;    // 4å­è
    int _HResult;             // 4å­è
    
    // æ»å±ï¼è³å°80å­èï¼64ä½ç³»ç»ï¼
    // å ä¸å­ç¬¦ä¸²åå®¹ï¼å¯è½æ°ç¾å°æ°åå­è
}
</code></pre>
<h3 id="422-gcçå½±å">4.2.2 GCçå½±å</h3>
<pre><code class="language-csharp">// é«é¢æåºå¼å¸¸ä¼æ¾èå½±åGC
public void TestExceptionGC()
{
    var list = new List&lt;Exception&gt;();
    
    for (int i = 0; i &lt; 10000; i++)
    {
        try
        {
            throw new Exception($"Error {i}");
        }
        catch (Exception ex)
        {
            list.Add(ex);  // å¤§éå¯¹è±¡è¿å¥ç¬¬0ä»£å 
        }
    }
}

</code></pre>
<p>ä¸è¿°ä»£ç ä¼å¯¼è´:</p>
<ul>
<li>è§¦åé¢ç¹çGen0 GC</li>
<li>å¦æexè¢«é¿æ¶é´å¼ç¨ï¼å¯è½è¿å¥Gen1/Gen2</li>
<li>å¢å GCæåæ¶é´</li>
<li>éä½ç¼å­å±é¨æ§</li>
</ul>
<h2 id="43-cpuçº§å«çæ§è½å½±å">4.3 CPUçº§å«çæ§è½å½±å</h2>
<h3 id="431-ç°ä»£cpuçå¼å¸¸å¤çå¼é">4.3.1 ç°ä»£CPUçå¼å¸¸å¤çå¼é</h3>
<pre><code class="language-assembly">; x64æ±ç¼å±é¢çå¼å¸¸å¤ç
; æ­£å¸¸è·¯å¾ï¼
process_value:
    mov eax, [rcx]      ; å è½½å¼
    add eax, 100        ; è®¡ç®
    ret                 ; è¿å
    
; å¼å¸¸è·¯å¾ï¼
throw_exception:
    ; 1. ä¿å­ææå¯å­å¨å°å æ 
    push rbx
    push rbp
    push r12
    push r13
    push r14
    push r15
    sub rsp, 28h        ; åéå æ ç©ºé´
    
    ; 2. è°ç¨å¼å¸¸æé å½æ°
    call Exception..ctor
    
    ; 3. è®¾ç½®SEHï¼ç»æåå¼å¸¸å¤çï¼
    mov [rsp+20h], rcx  ; ä¿å­å¼å¸¸å¯¹è±¡
    call __CxxThrowException@8
    
    ; 4. æ¸çå æ 
    add rsp, 28h
    pop r15
    pop r14
    pop r13
    pop r12
    pop rbp
    pop rbx
</code></pre>
<p>CPUå±é¢çé®é¢:</p>
<ul>
<li><strong>åæ¯é¢æµå¤±è´¥</strong>ï¼å¼å¸¸è·¯å¾å¾å°æ§è¡ï¼CPUåæ¯é¢æµå¨é¾ä»¥ä¼å</li>
<li><strong>ç¼å­å¤±æ</strong>ï¼å¼å¸¸å¤çä»£ç éå¸¸ä¸å¨æä»¤ç¼å­ä¸­</li>
<li><strong>æµæ°´çº¿åé¡¿</strong>ï¼å¼å¸¸å¤çéè¦ä¿å­/æ¢å¤å¤§éå¯å­å¨ç¶æ</li>
<li><strong>åå­è®¿é®æ¨¡å¼å·®</strong>ï¼EHè¡¨æ¥æ¾å¯¼è´éæºåå­è®¿é®</li>
</ul>
<h3 id="432-å¯¹æ¯æ­£å¸¸è¿ååå¼å¸¸è¿å">4.3.2 å¯¹æ¯æ­£å¸¸è¿ååå¼å¸¸è¿å</h3>
<pre><code class="language-csharp">// Result&lt;T&gt;çæ­£å¸¸è¿åè·¯å¾
return Result&lt;User&gt;.Fail("ç¨æ·ä¸å­å¨");
// æ±ç¼ï¼
; 1. æé Resultå¯¹è±¡ï¼å¯è½å¨æ ä¸ï¼
; 2. è®¾ç½®Success=false
; 3. è®¾ç½®Errorå­æ®µ
; 4. è¿åï¼æ®éretæä»¤ï¼

// å¼å¸¸è¿åè·¯å¾
throw new BusinessException("ç¨æ·ä¸å­å¨");
// æ±ç¼ï¼
; 1. å åéå¼å¸¸å¯¹è±¡
; 2. æè·å æ è·è¸ª
; 3. è®¾ç½®SEHå¸§
; 4. è°ç¨kernel32!RaiseException
; 5. å æ å±å¼
; 6. æ¥æ¾catchå
; 7. æ§è¡catchåä»£ç 
</code></pre>
<h2 id="44-å¯¹æ¯å¶ä»ç¼ç¨è¯­è¨">4.4 å¯¹æ¯å¶ä»ç¼ç¨è¯­è¨</h2>
<h3 id="441-javaçå¼å¸¸æºå¶">4.4.1 Javaçå¼å¸¸æºå¶</h3>
<pre><code class="language-java">// Javaçå¼å¸¸ä½¿ç¨çèµ·æ¥åC#ç¸ä¼¼
public User login(String username, String password) 
    throws UserNotFoundException, InvalidPasswordException
{
    User user = findUser(username);
    if (user == null) {
        throw new UserNotFoundException("ç¨æ·ä¸å­å¨");
    }
    if (!verifyPassword(user, password)) {
        throw new InvalidPasswordException("å¯ç éè¯¯");
    }
    return user;
}
</code></pre>
<p>Javaå¼å¸¸çç¹ç¹ï¼<br>
1.æ£æ¥åå¼å¸¸ï¼Checked Exceptionï¼ï¼å¼ºå¶å¤çæå£°æ<br>
2.æ§è½å¼éä¸C#ç±»ä¼¼ï¼åæ ·éè¦æè·å æ è·è¸ª<br>
3.JVMçä¼åï¼HotSpot JVMææ´æççå¼å¸¸ä¼å:</p>
<ul>
<li>åèç¼å­ï¼Inline Cacheï¼</li>
<li>æ ä¸æ¿æ¢ï¼On-Stack Replacementï¼</li>
<li>ä½ä¸å¡å¼å¸¸ä»ç¶æè´µ</li>
</ul>
<p><strong>éè¦åºå«ï¼</strong></p>
<pre><code class="language-java">// Java 14+å¼å¥äºRecordsï¼ä½å¼å¸¸å¼éä¾æ§
public record Result&lt;T&gt;(T value, String error) {
    public boolean isSuccess() { return error == null; }
}

// Javaç¤¾åºä¹å¨è½¬åResultæ¨¡å¼ï¼ç¹å«æ¯ååºå¼ç¼ç¨
public Mono&lt;User&gt; login(String username, String password) {
    return Mono.fromCallable(() -&gt; findUser(username))
        .switchIfEmpty(Mono.error(new UserNotFoundException()))
        .filter(user -&gt; verifyPassword(user, password))
        .switchIfEmpty(Mono.error(new InvalidPasswordException()));
}
</code></pre>
<h3 id="442-goçéè¯¯å¤çå²å­¦">4.4.2 Goçéè¯¯å¤çå²å­¦</h3>
<pre><code class="language-go">// Goçéè¯¯å¤çï¼æ¾å¼è¿åéè¯¯
func Login(username, password string) (*User, error) {
    user, err := findUser(username)
    if err != nil {
        return nil, fmt.Errorf("æ¥æ¾ç¨æ·å¤±è´¥: %w", err)
    }
    
    if !verifyPassword(user, password) {
        return nil, errors.New("å¯ç éè¯¯")
    }
    
    return user, nil
}

// è°ç¨æ¹å¿é¡»æ¾å¼å¤çéè¯¯
user, err := Login("test", "123")
if err != nil {
    // å¤çéè¯¯
    switch {
    case strings.Contains(err.Error(), "å¯ç éè¯¯"):
        // ç¹å®å¤ç
    default:
        // éç¨å¤ç
    }
}
</code></pre>
<p>Goçè®¾è®¡éæ©ï¼</p>
<ul>
<li><strong>æ²¡æå¼å¸¸æºå¶</strong>ï¼åªæéè¯¯è¿åå¼</li>
<li><strong>éè¯¯æ¯å¼ï¼errors are valuesï¼</strong>ï¼å¯ä»¥åæ®éå¼ä¸æ ·ä¼ é</li>
<li><strong>å¼ºå¶æ¾å¼å¤ç</strong>ï¼æ æ³å¿½ç¥éè¯¯ï¼é¤éä½¿ç¨_ï¼</li>
<li><strong>é¶ææ¬æ½è±¡</strong>ï¼éè¯¯å¤çå ä¹æ²¡æè¿è¡æ¶å¼é</li>
</ul>
<p>Goçéè¯¯æ§è½ä¼å¿:</p>
<pre><code class="language-go">// Goçerrors.Newå®éä¸å¾ç®å
func New(text string) error {
    return &amp;errorString{text}
}

type errorString struct {
    s string
}

func (e *errorString) Error() string {
    return e.s
}

// æ²¡æå æ è·è¸ªï¼æ²¡æå¤ææé 
// åªæ¯ä¸ä¸ªåå«å­ç¬¦ä¸²çç»æä½
</code></pre>
<h3 id="443-rustçresultç±»å">4.4.3 RustçResultç±»å</h3>
<pre><code class="language-rust">// Rustçéè¯¯å¤çï¼åºäºæä¸¾çResult
fn login(username: &amp;str, password: &amp;str) -&gt; Result&lt;User, LoginError&gt; {
    let user = find_user(username)?;  // ?æä½ç¬¦èªå¨ä¼ æ­éè¯¯
    
    if !verify_password(&amp;user, password) {
        return Err(LoginError::InvalidPassword);
    }
    
    Ok(user)
}

// éè¯¯ç±»åå®ä¹
#[derive(Debug)]
enum LoginError {
    UserNotFound,
    InvalidPassword,
    DatabaseError(DbError),
}

// ä½¿ç¨matchå¤ç
match login("test", "123") {
    Ok(user) =&gt; println!("æ¬¢è¿ {}", user.name),
    Err(LoginError::UserNotFound) =&gt; println!("ç¨æ·ä¸å­å¨"),
    Err(LoginError::InvalidPassword) =&gt; println!("å¯ç éè¯¯"),
    Err(e) =&gt; println!("å¶ä»éè¯¯: {:?}", e),
}
</code></pre>
<p>Rustçè®¾è®¡ç¹ç¹:</p>
<ul>
<li>é¶ææ¬æ½è±¡ï¼Resultå¨è¿è¡æ¶éå¸¸æ¯æ®éæä¸¾</li>
<li>æ¨¡å¼å¹éï¼ç¼è¯å¨ç¡®ä¿æææåµé½è¢«å¤ç</li>
<li>éè¯¯ä¼ æ­è¿ç®ç¬¦ï¼?ï¼ï¼ç®åéè¯¯ä¼ æ­</li>
<li>ä¸°å¯çéè¯¯åºï¼anyhowãthiserrorç­</li>
</ul>
<p>Rustçæ§è½ä¼å¿ï¼</p>
<pre><code>ç¼è¯åçResultéå¸¸ä¼åä¸ºï¼
1.æåï¼å­å¨User
2.å¤±è´¥ï¼å­å¨éè¯¯ç ï¼éå¸¸æ¯æ´æ°ï¼
3.æ²¡æå åéï¼æ²¡æèå½æ°è°ç¨
</code></pre>
<h3 id="444-cçéè¯¯å¤ç">4.4.4 C++çéè¯¯å¤ç</h3>
<pre><code class="language-cpp">// C++çå¤ç§éè¯¯å¤çæ¹å¼

// 1. å¼å¸¸ï¼ç±»ä¼¼C#/Javaï¼
User login(const std::string&amp; username, const std::string&amp; password) {
    auto user = find_user(username);
    if (!user) {
        throw UserNotFoundException("ç¨æ·ä¸å­å¨");
    }
    if (!verify_password(*user, password)) {
        throw InvalidPasswordException("å¯ç éè¯¯");
    }
    return *user;
}

// 2. éè¯¯ç ï¼ä¼ ç»æ¹å¼ï¼
int login(const std::string&amp; username, 
          const std::string&amp; password,
          User&amp; out_user) {
    User user;
    int err = find_user(username, user);
    if (err != 0) return err;
    
    if (!verify_password(user, password)) {
        return ERROR_INVALID_PASSWORD;
    }
    
    out_user = user;
    return 0;  // æå
}

// 3. std::expectedï¼C++23ï¼
std::expected&lt;User, Error&gt; login(const std::string&amp; username,
                                 const std::string&amp; password) {
    auto user = find_user(username);
    if (!user) {
        return std::unexpected(Error::UserNotFound);
    }
    if (!verify_password(*user, password)) {
        return std::unexpected(Error::InvalidPassword);
    }
    return *user;
}
</code></pre>
<p>C++çéæ©ï¼</p>
<ul>
<li>æ¸¸æååµå¥å¼ï¼éå¸¸ç¦ç¨å¼å¸¸ï¼ä½¿ç¨éè¯¯ç </li>
<li>æ§è½ææåºç¨ï¼é¿åå¼å¸¸ï¼å ä¸ºé¶å¼éåå</li>
<li>ç°ä»£C++ï¼å¾åäºstd::expectedç­ç±»åå®å¨æ¹æ¡</li>
</ul>
<h2 id="45-net-coreçæ¹è¿åå±é">4.5 .NET Coreçæ¹è¿åå±é</h2>
<p>.Net 8.0çæ¬ï¼å®æ¹å¢ééå¯¹å¼å¸¸å¤çè¿åè¿è¡äºå¤§å¹çä¼åï¼åæ¬é¢åéå¼å¸¸å¯¹è±¡ï¼PREallocated Exceptionï¼ãå»¶è¿å æ è·è¸ªçæï¼Lazy Stack Traceï¼ãå æ è·è¸ªç¼å­åå¤ç¨ãæ°çå æ è·è¸ªç®æ³ç­å¤ç§ææ®µï¼åæ¶ä¹å¯¹JITåRunTimeè¿è¡äºéå¯¹æ§ä¼åãä½æ¯ç®åæ¥çï¼ä¾æ§è¿æå¾å¤§çæåç©ºé´ã<br>
è¯¦æè¯·è§å®æ¹å¢éçåå®¢ï¼<a href="https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-8/#exception-handling" target="_blank" rel="noopener nofollow">https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-8/#exception-handling</a></p>
<pre><code class="language-csharp">// .NET 8.0 å¯¹åæ°å¼å¸¸çç¹æ®ä¼å
public void ValidateUser(string username, int age)
{
    // è¿äºè°ç¨å¨ .NET 8.0 ä¸­éå¸¸é«æ
    ArgumentNullException.ThrowIfNull(username);
    ArgumentOutOfRangeException.ThrowIfNegative(age);
    ArgumentException.ThrowIfNullOrEmpty(username);
    
    // ä½æ³¨æï¼ä¸å¡å¼å¸¸ä¸å¨æ­¤ä¼åèå´åï¼
    if (!IsValidUsername(username))
        throw new BusinessException("æ æç¨æ·å"); // ä»£ä»·ä»ç¶æè´µ
}
</code></pre>
<h1 id="äºresultçè¿é¶ä¼å¿">äºãResult<t>çè¿é¶ä¼å¿</t></h1>
<h2 id="51-ä¸°å¯çéè¯¯ä¿¡æ¯">5.1 ä¸°å¯çéè¯¯ä¿¡æ¯</h2>
<pre><code class="language-csharp">public class Result&lt;T&gt;
{
    public bool Success { get; }
    public T? Value { get; }
    public string ErrorCode { get; }    // éè¯¯ä»£ç 
    public string ErrorMessage { get; } // éè¯¯æ¶æ¯
    public Dictionary&lt;string, object&gt; Metadata { get; } // éå ä¿¡æ¯
}

// ä½¿ç¨ï¼
var result = Login("test", "wrong");
if (!result.Success)
{
    switch (result.ErrorCode)
    {
        case "USER_NOT_FOUND":
            // ç¨æ·ä¸å­å¨ï¼è·³è½¬æ³¨åé¡µé¢
            break;
        case "INVALID_PASSWORD":
            // å¯ç éè¯¯ï¼æ¾ç¤ºæç¤º
            break;
        case "ACCOUNT_LOCKED":
            // è´¦æ·éå®ï¼æ¾ç¤ºéå®æ¶é´
            var lockTime = result.Metadata["LockUntil"];
            break;
    }
}
</code></pre>
<h2 id="52-å½æ°å¼ç¼ç¨æ¯æ">5.2 å½æ°å¼ç¼ç¨æ¯æ</h2>
<pre><code class="language-csharp">// Map - è½¬æ¢æåçå¼
var userResult = GetUser(123);
var userName = userResult.Map(user =&gt; user.Name.ToUpper());

// Bind - é¾å¼æä½
var orderResult = GetUser(123)
    .Bind(user =&gt; GetOrder(user.CurrentOrderId))
    .Bind(order =&gt; ValidateOrder(order));

// Match - æ¨¡å¼å¹é
var message = loginResult.Match(
    success: user =&gt; $"æ¬¢è¿åæ¥ï¼{user.Name}!",
    failure: error =&gt; $"ç»å½å¤±è´¥: {error.Message}"
);
</code></pre>
<h2 id="53-æ´å¥½çapiè®¾è®¡">5.3 æ´å¥½çAPIè®¾è®¡</h2>
<pre><code class="language-csharp">// Web APIä¸­çä½¿ç¨
[HttpPost("login")]
public IActionResult Login([FromBody] LoginRequest request)
{
    var result = _authService.Login(request);
    
    return result.Match&lt;IActionResult&gt;(
        success: user =&gt; Ok(new { success = true, user }),
        failure: error =&gt; BadRequest(new { 
            success = false, 
            errorCode = error.Code,
            message = error.Message 
        })
    );
}

// å®¢æ·ç«¯è·å¾æ¸æ°çååºï¼
// æå: { success: true, user: { ... } }
// å¤±è´¥: { success: false, errorCode: "INVALID_PASSWORD", message: "å¯ç éè¯¯" }
</code></pre>
<h1 id="å­-resultæ¨¡å¼çä¸äºå¼ç«¯">å­ã Result<t>æ¨¡å¼çä¸äºå¼ç«¯</t></h1>
<h2 id="61-ifå°ç±é®é¢æ¡ä»¶å¤æ­æ³æ»¥">6.1 "ifå°ç±"é®é¢ï¼æ¡ä»¶å¤æ­æ³æ»¥ï¼</h2>
<p>æå¸¸è¢«è¯ççé®é¢ï¼å°±æ¯ä»£ç ä¸­åæ¥å¤§éç if (!result.Success) æ£æ¥ã</p>
<pre><code class="language-csharp">// "ifå°ç±"çå¸åä¾å­
public Result&lt;Order&gt; ProcessOrder(int userId, OrderRequest request)
{
    var userResult = GetUser(userId);
    if (!userResult.Success)
        return Result&lt;Order&gt;.Fail(userResult.Error);
    
    var validationResult = ValidateOrder(request);
    if (!validationResult.Success)
        return Result&lt;Order&gt;.Fail(validationResult.Error);
    
    var inventoryResult = CheckInventory(request.Items);
    if (!inventoryResult.Success)  
        return Result&lt;Order&gt;.Fail(inventoryResult.Error);
    
    var paymentResult = ProcessPayment(userResult.Value, request);
    if (!paymentResult.Success)
        return Result&lt;Order&gt;.Fail(paymentResult.Error);
    
    // ... æ´å¤æ£æ¥
}
</code></pre>
<p>è¿ä¸ªé®é¢ï¼ä½¿ç¨å½æ°å¼ç¼ç¨ææ³å¯ä»¥å·§å¦è§£å³ï¼è¿ä¸åJAVAåççå¿æºä¸éçã</p>
<pre><code class="language-csharp">// ä½¿ç¨ Railway-Oriented Programming
public Result&lt;Order&gt; ProcessOrder(int userId, OrderRequest request)
{
    return GetUser(userId)
        .Bind(user =&gt; ValidateOrder(request)
            .Bind(validated =&gt; CheckInventory(request.Items)
                .Bind(inventory =&gt; ProcessPayment(user, request)
                    .Map(payment =&gt; CreateOrder(user, validated, payment)))));
}

// æèä½¿ç¨æ©å±æ¹æ³
public Result&lt;Order&gt; ProcessOrder(int userId, OrderRequest request)
{
    return GetUser(userId)
        .Then(user =&gt; ValidateOrder(request))
        .Then(validated =&gt; CheckInventory(request.Items))
        .Then(inventory =&gt; ProcessPayment(user, request))
        .Map(payment =&gt; CreateOrder(user, validated, payment));
}
</code></pre>
<h2 id="62-å¼ç±»åstructvs-å¼ç¨ç±»åclassçä¸¤é¾éæ©">6.2 å¼ç±»åï¼structï¼vs å¼ç¨ç±»åï¼classï¼çä¸¤é¾éæ©</h2>
<pre><code class="language-csharp">public readonly struct Result&lt;T&gt;  // å¼ç±»å
{
    private readonly T? _value;
    private readonly string? _error;
    
    // é®é¢1ï¼Tæ¯å¼ç¨ç±»åæ¶ï¼structå­å¨çæ¯å¼ç¨
    // é®é¢2ï¼structå¤å¶å¼éï¼å¦æTæ¯å¤§å¯¹è±¡ï¼
    // é®é¢3ï¼è£ç®±/æç®±å¼é
    // é®é¢4ï¼ä¸è½ä¸ºnullï¼éè¦é¢å¤ç¶ææ è®°
}

public class Result&lt;T&gt;  // å¼ç¨ç±»å
{
    // é®é¢ï¼æ¯ä¸ªResulté½æ¯å åéï¼å¢å GCåå
    // å³ä½¿æåæåµä¹è¦åéå¯¹è±¡
}

</code></pre>
<p>æä¸­æ¹æ¡ï¼éå¯¹å¼ç±»ååå¼ç¨ç±»ååå«ä¼åï¼éå¯¹éç¨çResultå¯¹è±¡è¿è¡ç¼å­åå¤ç¨ã</p>
<pre><code class="language-csharp">/// &lt;summary&gt;
/// ç»æåºç±»
/// &lt;/summary&gt;
/// &lt;typeparam name="T"&gt;&lt;/typeparam&gt;
public abstract class Result&lt;T&gt;
{
    /// &lt;summary&gt;
    /// æ¯å¦æå
    /// &lt;/summary&gt;
    public abstract bool IsSuccess { get; }
    /// &lt;summary&gt;
    /// å·ä½è¿åå¼ï¼æåæ¶ææï¼
    /// &lt;/summary&gt;
    public abstract T? Value { get; }
    /// &lt;summary&gt;
    /// éè¯¯ç 
    /// &lt;/summary&gt;
    public abstract string? ErrorCode { get; }
    /// &lt;summary&gt;
    /// éè¯¯ä¿¡æ¯
    /// &lt;/summary&gt;
    public abstract string? ErrorMessage { get; }
  
    // ç¼å­åä¾æåï¼ä»éå¯¹ default(T)ï¼
    private static readonly ConcurrentDictionary&lt;Type, Result&lt;T&gt;&gt; _successCache = new();
    //åªæ errorCode ç¼å­ï¼é¿åæ message æ éå¢é¿ï¼
    private static readonly ConcurrentDictionary&lt;string, Result&lt;T&gt;&gt; _errorCache = new();  
} 

/// &lt;summary&gt;
/// ä»ç¨äºæ§è½å³é®è·¯å¾ï¼ä¸å­å¨å¤§å¯¹è±¡
/// &lt;/summary&gt;
/// &lt;typeparam name="T"&gt;&lt;/typeparam&gt;
public readonly ref struct ValueResult&lt;T&gt; where T : struct
{
  //çç¥
}

 /// &lt;summary&gt;
 /// å¼ç¨ç±»åç»æï¼ä»ç¨äºæ§è½å³é®è·¯å¾
 /// &lt;/summary&gt;
 /// &lt;typeparam name="T"&gt;&lt;/typeparam&gt;
 public readonly ref struct RefResult&lt;T&gt; where T : class
{
 //çç¥
}
</code></pre>
<h2 id="63-å¼æ­¥ç¼ç¨çå¤ææ§">6.3 å¼æ­¥ç¼ç¨çå¤ææ§</h2>
<p>å¨å¼æ­¥ç¼ç¨ä¸­ï¼å¯è½æ¯ä¸ªå¼æ­¥æä½é½éè¦å¤çResultï¼è¿ä¹å¤§å¤§å¢å äºä»£ç å¤æåº¦ï¼å¶å®ä¹å±äºä¸é¢è¯´çâif å°ç±âèç´ã</p>
<pre><code class="language-csharp">public async Task&lt;Result&lt;User&gt;&gt; LoginAsync(string username, string password)
{
    // æ¯ä¸ªå¼æ­¥æä½é½éè¦å¤çResult
    var userResult = await FindUserAsync(username);
    if (!userResult.Success)
        return Result&lt;User&gt;.Fail(userResult.Error);
    
    var validationResult = await ValidatePasswordAsync(userResult.Value, password);
    if (!validationResult.Success)
        return Result&lt;User&gt;.Fail(validationResult.Error);
    
    return Result&lt;User&gt;.Ok(userResult.Value);
}

// å¯¹æ¯å¼å¸¸çæ¬ï¼
public async Task&lt;User&gt; LoginAsync(string username, string password)
{
    var user = await FindUserAsync(username);  // æå¼å¸¸åç´æ¥ä¸­æ­åç»­é»è¾
    await ValidatePasswordAsync(user, password); // æå¼å¸¸åç´æ¥ä¸­æ­åç»­é»è¾
    return user;
}
</code></pre>
<h2 id="64-ç±»åç³»ç»åé¿">6.4 ç±»åç³»ç»åé¿</h2>
<p>æ¯ä¸ä¸ªæ¥å£æ¹æ³é½è¦åè£¹Result,åå ä¸å¼æ­¥çTask,åé¡µè¯·æ±ç»ææ¨¡åPagedResultï¼åå ä¸ç¹å¶ä»ä¸è¥¿ï¼å°±ä¼åºç°ä»¤äººå¤´ç®åéº»çæ³ååæ°çç¸&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;ã<br>
ä¸é¢çä»£ç ï¼æ¯é¡¹ç®éé¢ççå®ä»£ç </p>
<pre><code class="language-csharp">     /// &lt;summary&gt;
    /// åå·¥ä¸å¡æå¡æ¥å£
    /// &lt;/summary&gt;
    public interface IEmployeeService
    {
        Task&lt;Result&lt;long&gt;&gt; CreateAsync(CreateEmployeeDto dto);
        Task&lt;Result&lt;EmployeeDto&gt;&gt; GetByIdAsync(long id);
        Task&lt;Result&gt; UpdateAsync(UpdateEmployeeDto dto);
        Task&lt;Result&gt; DeleteAsync(long id);
        Task&lt;Result&lt;PagedResult&lt;EmployeeDto&gt;&gt;&gt; GetPageListAsync(EmployeePageListDto dto);
        Task&lt;Result&lt;List&lt;EmployeeDto&gt;&gt;&gt; GetListAsync(string? keyword = null);
        Task&lt;Result&lt;Dictionary&lt;string,long&gt;&gt;&gt; GetEmployeeAliases(List&lt;long&gt;? employeeIds = null, bool includeShowName = true);
    }
</code></pre>
<h2 id="65-å¶ä»é®é¢">6.5 å¶ä»é®é¢</h2>
<p>å½ç¶ï¼è¿ç§æ¨¡å¼è¿æä¸äºå¶ä»çé®é¢ï¼æ¯å¦å¢éæåçæ¥ååº¦ï¼å¢éå­¦ä¹ ææ¬ï¼ä¸ç°æä»£ç /çæçå¼å®¹æ§ï¼ä¸ç¬¬ä¸æ¹åçå¼å®¹æ§ç­ï¼è¿éå°±ä¸ä¸ä¸è¯´æäºã</p>
<h1 id="ä¸å¸¸è§é®é¢ä¸ç­ç">ä¸ãå¸¸è§é®é¢ä¸ç­ç</h1>
<p><strong>Qï¼å¼å¸¸ä¸æ¯æ´æ¹ä¾¿åï¼ä¸è¡ä»£ç å°±è½ä¸­æ­æµç¨</strong><br>
Aï¼æ¹ä¾¿ä¸ç­äºæ­£ç¡®ãgotoè¯­å¥ä¹å¾"æ¹ä¾¿"ï¼ä½ç°ä»£ç¼ç¨ä¸­æä»¬é¿åä½¿ç¨å®ãå¼å¸¸å¨ä¸å¡é»è¾ä¸­å°±æ¯"è¿ç¨goto"ï¼ç ´åäºä»£ç çå¯è¯»æ§åå¯ç»´æ¤æ§ã</p>
<p><strong>Qï¼Result<t>éè¦æ´å¤çifå¤æ­ï¼ä»£ç æ´åé¿</t></strong></p>
<pre><code class="language-csharp">// ç®æ´çå¤çæ¹å¼
var result = Login("test", "123");
if (!result.Success) return result;

// æèä½¿ç¨æ¨¡å¼å¹é
var message = result switch
{
    { Success: true, Value: var user } =&gt; $"æ¬¢è¿ {user.Name}",
    { Error: var error } =&gt; $"éè¯¯: {error}",
    _ =&gt; "æªç¥ç¶æ"
};
</code></pre>
<p><strong>Qï¼æä»¬çé¡¹ç®å¾å°ï¼æ§è½å½±åä¸å¤§</strong><br>
A:å³ä½¿ä¸èèæ§è½ï¼ä»ä»£ç è´¨éåç»´æ¤æ§è§åº¦ï¼Result<t>ä¹æ¯æ´å¥½çéæ©ãå¥½çä¹ æ¯åºè¯¥ä»é¡¹ç®åæå°±å¼å§å¹å»ã</t></p>
<h1 id="å«æ»ç»">å«ãæ»ç»</h1>
<p>Result<t> ä¸æ¯é¶å¼¹ï¼å®æå®éç¨çåºæ¯ï¼ä¹æç¸åºçä¸äºå¼ç«¯ãéæ©çå³é®ä¸å¨äºåªä¸ª"æ´å¥½"ï¼èå¨äºåªä¸ª"æ´éå"å½åçåºæ¯åçº¦æãææºçå·¥ç¨å¸ä¼æ ¹æ®å·ä½æåµååºå¹³è¡¡çéæ©ã<br>
éåä½¿ç¨ Result<t> çåºæ¯ï¼</t></t></p>
<ul>
<li>é«é¢å¤±è´¥çæ ¡éªé»è¾ï¼è¡¨åéªè¯ãä¸å¡è§åæ£æ¥ï¼</li>
<li>éè¦æç¡®éè¯¯åç±»çä¸å¡æµç¨</li>
<li>APIè¾¹çï¼éè¦ç»æåéè¯¯ååºï¼</li>
<li>ä¸å¤é¨ç³»ç»äº¤äºï¼éè¦å¤çåç§å¤±è´¥æ¨¡å¼ï¼</li>
<li>éè¦ç»åçå¤æä¸å¡é»è¾</li>
</ul>
<p>ä»ç¶éåä½¿ç¨å¼å¸¸çåºæ¯ï¼</p>
<ul>
<li>çæ­£çç³»ç»æéï¼åå­ä¸è¶³ãæ°æ®åºå´©æºï¼</li>
<li>ç¨åºç¶æå¼å¸¸ï¼ç©ºå¼ç¨ãç´¢å¼è¶çï¼</li>
<li>ä¸æ»¡è¶³åç½®æ¡ä»¶ï¼æ æåæ°ï¼</li>
<li>å¼åé¶æ®µçæ­è¨æ£æ¥</li>
<li>æä½å¤±è´¥ççæä½</li>
</ul>
<p>å³é®å»ºè®®ï¼</p>
<ul>
<li>ä¸è¦å¨çæ¿æ¢ï¼Resultåå¼å¸¸åæéç¨åºæ¯</li>
<li>åå±è®¾è®¡ï¼ä¸åæ¶æå±ä½¿ç¨ä¸åç­ç¥</li>
<li>å¢éå±è¯ï¼å»ºç«æç¡®çè§èåè¾¹ç</li>
<li>æ¸è¿éç¨ï¼ä»æ ¸å¿ä¸å¡å¼å§ï¼éæ­¥æ©å±</li>
<li>çæ§åé¦ï¼éè¿æ¥å¿åçæ§éªè¯éæ©</li>
</ul>
<p>æç»ååï¼</p>
<ul>
<li>å¼å¸¸ï¼ç¨äº"ä¸åºè¯¥åç"çäºæ</li>
<li>Resultï¼ç¨äº"å¯è½åçä½éè¦å¤ç"çäºæ</li>
</ul>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.002777777777777778" data-date-updated="2026-01-20 19:44">2026-01-20 19:40</span>&nbsp;
<a href="https://www.cnblogs.com/diamondhusky">åèåå£«å¥</a>&nbsp;
éè¯»(<span id="post_view_count">82</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19508626);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19508626', targetLink: 'https://www.cnblogs.com/diamondhusky/p/19508626', title: 'åå« throw exceptionï¼ä¸ºä»ä¹ Result&amp;lt;T&amp;gt; ææ¯ä¸å¡é»è¾çæ­£ç¡®éæ©' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å¹²è´§æ»¡æ»¡ï¼Redis åå¸å¼éå¿é¿ç 8 å¤§é®é¢åè§£å³æ¹æ¡ ]]></title>
    <link>https://www.cnblogs.com/sun-10387834/p/19493006</link>
    <guid>436793609d4e4f231f04487dd8708f85</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/sun-10387834/p/19493006" title="åå¸äº 2026-01-20 19:23">
    <span role="heading" aria-level="2">å¹²è´§æ»¡æ»¡ï¼Redis åå¸å¼éå¿é¿ç 8 å¤§é®é¢åè§£å³æ¹æ¡</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>å¨åå¸å¼ç³»ç»ä¸­ï¼Redis åå¸å¼éè½è½é«æè§£å³è·¨æå¡å¹¶åå²çªï¼ä½å®éè½å°æ¶ç¨ä¸æ³¨æå°±ä¼è¸©åââå°å°æ°æ®ä¸ä¸è´ï¼å¤§å°æå¡éªå´©ï¼è¿äºé®é¢å¤æºäºå¯¹ Redis ç¹æ§ãåå¸å¼åºæ¯å¤ææ§çèèä¸å¨ãä¹åå¼åçµååºå­åè®¢åç³»ç»æ¶ï¼å°±å å¿½è§äºéè¿æãèè£ç­é®é¢ï¼åååºç°è¿è¶åãéå¤±æç­æéãä»å¤©ç»åçäº§å®æç»éªï¼æ¢³ç Redis å®ç°åå¸å¼éæ¶ææéå°ç 8 å¤§é®é¢ï¼éä¸æè§£æå ãè¡¨ç°åæ ¹æ²»æ¹æ¡ï¼å¸®å¤§å®¶é¿å¼è¿äºâéå½¢ç¸å¼¹âã</p>
<p>åæç¡®åæï¼åå¸å¼éçæ ¸å¿æ¯âäºæ¥æ§âï¼ä½å¨åå¸å¼ç¯å¢ä¸ï¼ç½ç»å»¶è¿ãæå¡å®æºãRedis éç¾¤åæ­¥å»¶è¿ç­å ç´ ï¼é½ä¼ç ´åéçç¨³å®æ§ãææé®é¢çæ¬è´¨ï¼è¦ä¹æ¯âåå­æ§ç¼ºå¤±âï¼è¦ä¹æ¯âé«å¯ç¨èèä¸è¶³âï¼è¦ä¹æ¯âä¸å¡ä¸éæºå¶ä¸å¹éâã</p>
<h2 id="ä¸æ ¸å¿é®é¢åè§£å³æ¹æ¡æè¸©åé¢çæåº">ä¸ãæ ¸å¿é®é¢åè§£å³æ¹æ¡ï¼æè¸©åé¢çæåºï¼</h2>
<h3 id="é®é¢-1è¯¯å ä»äººææéæåºç¡ä¹ææç¯çæ¼æ´">é®é¢ 1ï¼è¯¯å ä»äººææéââæåºç¡ä¹ææç¯çæ¼æ´</h3>
<p><strong>æå </strong>ï¼éæ¾éæ¶æªåèº«ä»½æ ¡éªï¼ç´æ¥æ§è¡ DEL å½ä»¤å é¤é®ãå¸ååºæ¯ï¼æå¡ A ææéåï¼ä¸å¡é»è¾èæ¶è¶è¿éè¿ææ¶é´ï¼éè¢«èªå¨éæ¾ï¼æå¡ B è¶æºå éæåï¼æ­¤æ¶æå¡ A æ§è¡å®ä¸å¡ï¼ç´æ¥ DEL éå°±ä¼è¯¯å æå¡ B ææçéï¼å¯¼è´äºæ¥æ§å¤±æã</p>
<p><strong>è¡¨ç°</strong>ï¼å¤ä¸ªæå¡å®ä¾åæ¶ææåä¸æéï¼æä½åä¸èµæºï¼åºç°æ°æ®ä¸ä¸è´ï¼å¦è¶åãéå¤è®¢åï¼ã</p>
<p><strong>è§£å³æ¹æ¡</strong>ï¼å éæ¶å­å¥å¨å±å¯ä¸çéæºå¼ï¼å¦ UUID+çº¿ç¨ IDï¼ä½ä¸º valueï¼éæ¾éååéªè¯ value æ¯å¦ä¸èªèº«ææä¸è´ï¼ä¸è´æéæ¾ãå³é®æ¯ç¨ Lua èæ¬ä¿è¯âéªè¯+å é¤âçåå­æ§ï¼é¿åéªè¯åéè¿æè¢«ä»äººææã</p>
<pre><code class="language-lua">-- å®å¨éæ¾éç Lua èæ¬
if redis.call('get', KEYS[1]) == ARGV[1] then
    return redis.call('del', KEYS[1])
else
    return 0
end
</code></pre>
<p>æ³¨æï¼ä¸¥ç¦æåâéªè¯âåâå é¤âä¸ºä¸¤æ­¥æä½ï¼å¦åä»å­å¨å¹¶åæ¼æ´ã</p>
<h3 id="é®é¢-2éè¿ææåéæ¾ä¸å¡æªåå®éå·²å¤±æ">é®é¢ 2ï¼éè¿ææåéæ¾ââä¸å¡æªåå®éå·²å¤±æ</h3>
<p><strong>æå </strong>ï¼éçè¿ææ¶é´è®¾ç½®è¿ç­ï¼èä¸å¡é»è¾æ§è¡èæ¶è¿é¿ï¼å¯¼è´éå¨ä¸å¡å®æåå°±èªå¨è¿æéæ¾ï¼å¶ä»æå¡å¯è¶æºå éï¼å¼åå¹¶åå²çªãæ¯å¦éè®¾ä¸º 30 ç§è¿æï¼ä½æ°æ®åºå¤ææ¥è¯¢ãç¬¬ä¸æ¹æ¥å£è°ç¨èæ¶ 40 ç§ï¼å°±ä¼åºç°éæåå¤±æã</p>
<p><strong>è¡¨ç°</strong>ï¼ä¸å¡æ§è¡ä¸­éè¢«éæ¾ï¼å¤ä¸ªæå¡åæ¶æä½èµæºï¼åºç°æ°æ®éè¯¯ï¼ä¸é®é¢å·æéæºæ§ï¼åå³äºä¸å¡èæ¶æ¯å¦è¶è¿è¿ææ¶é´ï¼ã</p>
<p><strong>è§£å³æ¹æ¡</strong>ï¼å¼å¥âéç»­çº¦ï¼Watch Dogï¼âæºå¶ãæå¡æåå éåï¼å¯å¨åå°å®æ¤çº¿ç¨ï¼æ¯ééè¿ææ¶é´ç 1/3 ï¼å¦ 10 ç§ï¼æ£æ¥éæ¯å¦ä»è¢«èªèº«ææï¼è¥ææåå»¶é¿éçè¿ææ¶é´ï¼éç½®ä¸º 30 ç§ï¼ï¼ç´å°ä¸å¡å®æä¸»å¨éæ¾éã</p>
<p>å®éå¼åä¸­æ éæå¨å®ç°ï¼Redisson æ¡æ¶åç½® Watch Dog æºå¶ï¼å éåèªå¨ç»­çº¦ï¼å½»åºè§£å³éæåéæ¾é®é¢ã</p>
<h3 id="é®é¢-3redis-åç¹æééæå¡æ´ä½ä¸å¯ç¨">é®é¢ 3ï¼Redis åç¹æéââéæå¡æ´ä½ä¸å¯ç¨</h3>
<p><strong>æå </strong>ï¼Redis éç¨åç¹é¨ç½²ï¼å½ Redis æå¡å®æºï¼å¦è¿ç¨å´©æºãæå¡å¨æ­çµï¼ï¼ææåå¸å¼éçå éãéæ¾æä½é½ä¼å¤±è´¥ï¼å¯¼è´åå¸å¼ç³»ç»çå¹¶åæ§å¶æºå¶å´©æºï¼æ æ³æ­£å¸¸å¤çèµæºç«äºã</p>
<p><strong>è¡¨ç°</strong>ï¼ææä¾èµåå¸å¼éçä¸å¡æ¥å£æ¥éï¼æ æ³æ§è¡ï¼å¦åºå­æ£åãè®¢ååå»ºæ¥å£ï¼ï¼çè³å¼åæå¡éªå´©ã</p>
<p><strong>è§£å³æ¹æ¡</strong>ï¼éç¨ Redis é«å¯ç¨éç¾¤é¨ç½²ï¼ä¸¤ç§ä¸»æµæ¹æ¡æééæ©ï¼</p>
<ol>
<li>
<p><strong>ä¸»ä»å¤å¶ + å¨åµæ¨¡å¼</strong>ï¼é¨ç½² 1 ä¸»å¤ä» Redis éç¾¤ï¼å¨åµå®æ¶çæ§ä¸»èç¹ç¶æï¼ä¸»èç¹å®æºæ¶èªå¨å°ä»èç¹åæ¢ä¸ºä¸»èç¹ï¼ä¿è¯ Redis æå¡è¿ç»­æ§ãç¼ºç¹æ¯å­å¨âèè£âé£é©ï¼ä¸»ä»æ°æ®åæ­¥å»¶è¿å¯¼è´éä¸¢å¤±ï¼ï¼éåå¯¹ä¸è´æ§è¦æ±ä¸è¬çåºæ¯ã</p>
</li>
<li>
<p><strong>Redlock ç®æ³</strong>ï¼åè³å° 3 ä¸ªç¬ç«ç Redis ä¸»èç¹åèµ·å éè¯·æ±ï¼ä»å½è¶è¿åæ°èç¹å éæåï¼ä¸æ»èæ¶ä¸è¶è¿è¶æ¶æ¶é´ï¼æç®å éæåãå³ä½¿é¨åèç¹å®æºï¼åªè¦å¤æ°èç¹æ­£å¸¸ï¼éæå¡å°±å¯ç¨ï¼å½»åºé¿ååç¹æéåèè£é®é¢ï¼éåé«ä¸è´æ§åºæ¯ãRedisson å·²åç½® Redlock å®ç°ï¼å¼ç®±å³ç¨ï¼ä»¥ä¸æ¯å®æ´å®æéç½®ä¸ä»£ç ï¼</p>
</li>
</ol>
<h4 id="1-å¤ç»ç¬ç«-redis-èç¹éç½®yml">1. å¤ç»ç¬ç« Redis èç¹éç½®ï¼YMLï¼</h4>
<p>Redlock è¦æ±èç¹ç©çç¬ç«ï¼é¿ååä¸æºæ¿æéçµè¿å¤ç»èç¹ï¼ï¼æ¯ç»èç¹å¯åç¬é¨ç½²ä¸»ä»+å¨åµæåå¯ç¨æ§ï¼3 ç»èç¹å®æ´éç½®å¦ä¸ï¼</p>
<pre><code class="language-yaml">spring:
  redis:
    # Redlock ä¸ç¨å¤ç»ç¬ç«èç¹éç½®
    redlock:
      # ç¬¬ä¸ç»èç¹ï¼å¯é¨ç½²ä¸»ä»+å¨åµï¼
      node1:
        host: 192.168.1.101
        port: 6379
        password: 123456
        database: 0
        timeout: 5000  # è¿æ¥è¶æ¶æ¶é´ï¼æ¯«ç§ï¼
      # ç¬¬äºç»èç¹ï¼ç¬ç«æå¡å¨ï¼ä¸ç¬¬ä¸ç»æ å³èï¼
      node2:
        host: 192.168.1.102
        port: 6379
        password: 123456
        database: 0
        timeout: 5000
      # ç¬¬ä¸ç»èç¹ï¼ç¬ç«æå¡å¨ï¼å»ºè®®è·¨æºæ¿ï¼
      node3:
        host: 192.168.1.103
        port: 6379
        password: 123456
        database: 0
        timeout: 5000
</code></pre>
<h4 id="2-redisson-å®¢æ·ç«¯éç½®å¤èç¹å®ä¾å">2. Redisson å®¢æ·ç«¯éç½®ï¼å¤èç¹å®ä¾åï¼</h4>
<p>éè¿éç½®ç±»è¯»å YML ä¿¡æ¯ï¼åå»ºå¯¹åº RedissonClient å®ä¾ï¼ä¿è¯æ¯ç»èç¹ç¬ç«è¿æ¥ï¼</p>
<pre><code class="language-java">@Configuration
public class RedissonRedlockConfig {

    // ç¬¬ä¸ç» Redlock èç¹å®¢æ·ç«¯
    @Bean(name = "redlockClient1")
    public RedissonClient redlockClient1(
            @Value("${spring.redis.redlock.node1.host}") String host,
            @Value("${spring.redis.redlock.node1.port}") int port,
            @Value("${spring.redis.redlock.node1.password}") String password,
            @Value("${spring.redis.redlock.node1.database}") int database,
            @Value("${spring.redis.redlock.node1.timeout}") int timeout) {
        Config config = new Config();
        // åèç¹æ¨¡å¼ï¼è¥ä¸ºéç¾¤ï¼å¯æ¹ç¨ useSentinelServers éç½®å¨åµï¼
        config.useSingleServer()
                .setAddress("redis://" + host + ":" + port)
                .setPassword(password)
                .setDatabase(database)
                .setTimeout(timeout);
        return Redisson.create(config);
    }

    // ç¬¬äºç» Redlock èç¹å®¢æ·ç«¯
    @Bean(name = "redlockClient2")
    public RedissonClient redlockClient2(
            @Value("${spring.redis.redlock.node2.host}") String host,
            @Value("${spring.redis.redlock.node2.port}") int port,
            @Value("${spring.redis.redlock.node2.password}") String password,
            @Value("${spring.redis.redlock.node2.database}") int database,
            @Value("${spring.redis.redlock.node2.timeout}") int timeout) {
        Config config = new Config();
        config.useSingleServer()
                .setAddress("redis://" + host + ":" + port)
                .setPassword(password)
                .setDatabase(database)
                .setTimeout(timeout);
        return Redisson.create(config);
    }

    // ç¬¬ä¸ç» Redlock èç¹å®¢æ·ç«¯
    @Bean(name = "redlockClient3")
    public RedissonClient redlockClient3(
            @Value("${spring.redis.redlock.node3.host}") String host,
            @Value("${spring.redis.redlock.node3.port}") int port,
            @Value("${spring.redis.redlock.node3.password}") String password,
            @Value("${spring.redis.redlock.node3.database}") int database,
            @Value("${spring.redis.redlock.node3.timeout}") int timeout) {
        Config config = new Config();
        config.useSingleServer()
                .setAddress("redis://" + host + ":" + port)
                .setPassword(password)
                .setDatabase(database)
                .setTimeout(timeout);
        return Redisson.create(config);
    }
}
</code></pre>
<h4 id="3-redlock-å ééæ¾éä¸å¡ä»£ç ">3. Redlock å é/éæ¾éä¸å¡ä»£ç </h4>
<p>éè¿ RedissonRedLock ç»åå¤èç¹éï¼èªå¨è§¦åæç¥¨é»è¾ï¼å¼å®¹æ®ééç¨æ³ï¼åç½® Watch Dog ç»­çº¦ï¼</p>
<pre><code class="language-java">@Service
public class StockService {

    @Autowired
    @Qualifier("redlockClient1")
    private RedissonClient redlockClient1;

    @Autowired
    @Qualifier("redlockClient2")
    private RedissonClient redlockClient2;

    @Autowired
    @Qualifier("redlockClient3")
    private RedissonClient redlockClient3;

    @Autowired
    private StockMapper stockMapper;

    public void deductStock(Long productId) {
        // 1. çæç»ä¸éKeyï¼è·åå¤èç¹éå¯¹è±¡
        String lockKey = "lock:stock:" + productId;
        RLock lock1 = redlockClient1.getLock(lockKey);
        RLock lock2 = redlockClient2.getLock(lockKey);
        RLock lock3 = redlockClient3.getLock(lockKey);

        // 2. ç»åä¸ºRedlockéï¼è§¦åå¤èç¹æç¥¨
        RedissonRedLock redLock = new RedissonRedLock(lock1, lock2, lock3);

        try {
            // 3. å éï¼1ç§åç­å¾èç¹ååºï¼éè¿ææ¶é´30ç§ï¼åç½®ç»­çº¦ï¼
            boolean locked = redLock.tryLock(1000, 30000, TimeUnit.MILLISECONDS);
            if (locked) {
                // 4. æ ¸å¿ä¸å¡ï¼åºå­æ£åï¼ä»ä¿çéåå¿è¦æä½ï¼
                Stock stock = stockMapper.selectById(productId);
                if (stock != null &amp;&amp; stock.getCount() &gt; 0) {
                    stock.setCount(stock.getCount() - 1);
                    stockMapper.updateById(stock);
                }
            } else {
                // å éå¤±è´¥ååº
                throw new RuntimeException("ç³»ç»ç¹å¿ï¼è¯·ç¨ååè¯");
            }
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
            throw new RuntimeException("æä½è¢«ä¸­æ­ï¼è¯·éè¯");
        } finally {
            // 5. å®å¨éæ¾éï¼ä»å½åçº¿ç¨ææéæ¶æ§è¡
            if (redLock.isHeldByCurrentThread()) {
                redLock.unlock();
            }
        }
    }
}
</code></pre>
<p>å³é®è¯´æï¼â  å¤ç»èç¹éç©çéç¦»ï¼è·¨æºæ¿é¨ç½²å¯æåå®¹éï¼â¡ 3 ç»èç¹æå¤åè®¸ 1 ç»æéï¼è¶è¿åæ°èç¹å éæåå³çæï¼â¢ éæ¾éæ¶èªå¨åæ­¥æ¸çææèç¹éæ°æ®ï¼æ éæå¨åè°ã</p>
<h3 id="é®é¢-4éæ æ³éå¥åµå¥ä¸å¡æ­»é">é®é¢ 4ï¼éæ æ³éå¥ââåµå¥ä¸å¡æ­»é</h3>
<p><strong>æå </strong>ï¼åºç¡å®ç°çéä¸æ¯æéå¥ï¼å³åä¸æå¡çåä¸çº¿ç¨å¨ææéçæåµä¸ï¼åæ¬¡è¯·æ±å åä¸æéä¼å¤±è´¥ãå¸ååºæ¯ï¼æå¡ A å éåï¼æ§è¡çæ¹æ³ä¸­åè°ç¨äºå¦ä¸ä¸ªéè¦å åä¸æéçæ¹æ³ï¼ç¬¬äºæ¬¡å éå¤±è´¥ï¼å¯¼è´çº¿ç¨é»å¡ï¼å¼åæ­»éã</p>
<p><strong>è¡¨ç°</strong>ï¼ä¸å¡çº¿ç¨é»å¡ï¼æ¥å£è¶æ¶æ ååºï¼ææ¥ååç°æ¯åä¸çº¿ç¨éå¤å éè¢«æã</p>
<p><strong>è§£å³æ¹æ¡</strong>ï¼å®ç°å¯éå¥éæºå¶ãéç value å­å¨âå¯ä¸æ è¯ + éå¥æ¬¡æ°âï¼ç¬¬ä¸æ¬¡å éæ¶å­å¥æ è¯åæ¬¡æ° 1ï¼åä¸çº¿ç¨åæ¬¡å éæ¶ï¼éªè¯æ è¯ä¸è´ï¼å°æ¬¡æ°å  1ï¼éæ¾éæ¶ï¼æ¬¡æ°å 1ï¼ç´å°æ¬¡æ°ä¸º 0 æå é¤é®å½»åºéæ¾éã</p>
<p>æå¨å®ç°é»è¾å¤æï¼æ¨èä½¿ç¨ Redisson ç RLock æ¥å£ï¼å¤©ç¶æ¯æå¯éå¥ï¼ç¨æ³ä¸æ¬å° synchronized éä¸è´ï¼æ éé¢å¤å¼åã</p>
<h3 id="é®é¢-5ä¸»ä»åæ¢éä¸¢å¤±èè£éç¾¤ç¯å¢ä¸çéå½¢å">é®é¢ 5ï¼ä¸»ä»åæ¢éä¸¢å¤±ï¼èè£ï¼ââéç¾¤ç¯å¢ä¸çéå½¢å</h3>
<p><strong>æå </strong>ï¼Redis ä¸»ä»éç¾¤ä¸­ï¼ä¸»èç¹å­å¨éæ°æ®åï¼å°æªåæ­¥å°ä»èç¹å°±å®æºï¼å¨åµå°ä»èç¹åæ¢ä¸ºä¸»èç¹ï¼æ°ä¸»èç¹æ è¯¥éæ°æ®ï¼å¶ä»æå¡å¯éæ°å éï¼å¯¼è´åéå¤±æï¼åºç°å¤ä¸ªæå¡ææéçæåµãè¿æ¯ä¸»ä» + å¨åµæ¨¡å¼çåºæé£é©ã</p>
<p><strong>è¡¨ç°</strong>ï¼ä¸»ä»åæ¢åï¼åææéçæå¡ä»å¨æ§è¡ä¸å¡ï¼æ°æå¡å´è½å éæåï¼å¼åæ°æ®å²çªï¼ä¸é®é¢é¾ä»¥å¤ç°ï¼ä»åçå¨ä¸»ä»åæ¢ç¬é´ï¼ã</p>
<p><strong>è§£å³æ¹æ¡</strong>ï¼</p>
<ul>
<li>
<p>ä½ä¸è´æ§åºæ¯ï¼å¼å¯ Redis ä¸»ä»åæ­¥çâæä¹å + ç­å¾åæ­¥ç¡®è®¤âï¼ä¸»èç¹åå¥éæ°æ®åï¼ç­å¾è³å° 1 ä¸ªä»èç¹åæ­¥å®æåè¿åå éæåï¼éä½éä¸¢å¤±æ¦çï¼ä»æ æ³å®å¨é¿åï¼ã</p>
</li>
<li>
<p>é«ä¸è´æ§åºæ¯ï¼æ¾å¼ä¸»ä» + å¨åµæ¨¡å¼ï¼æ¹ç¨ Redlock ç®æ³ï¼éè¿å¤ä¸»èç¹æç¥¨æºå¶ï¼ä»æ ¹æºä¸è§£å³èè£å¯¼è´çéä¸¢å¤±é®é¢ã</p>
</li>
</ul>
<h3 id="é®é¢-6å éå¤±è´¥æ éè¯ç­ç¥ä¸å¡å¶åå¤±è´¥">é®é¢ 6ï¼å éå¤±è´¥æ éè¯ç­ç¥ââä¸å¡å¶åå¤±è´¥</h3>
<p><strong>æå </strong>ï¼å éæ¶ä»å°è¯ä¸æ¬¡ï¼è¥å ç½ç»æ³¢å¨ãRedis ä¸´æ¶ç¹å¿å¯¼è´å éå¤±è´¥ï¼ç´æ¥æåºå¼å¸¸ï¼å¯¼è´ä¸å¡æ§è¡å¤±è´¥ãåå¸å¼ç¯å¢ä¸­ï¼ç½ç»æå¨ãRedis ç¬æ¶ååå¤§æ¯å¸¸è§æåµï¼æ éè¯ç­ç¥ä¼æ¾å¤§è¿ç±»é®é¢çå½±åã</p>
<p><strong>è¡¨ç°</strong>ï¼é¨åç¨æ·æä½å¤±è´¥ï¼å¦æäº¤è®¢åæç¤ºâç³»ç»ç¹å¿âï¼ï¼éè¯åå¯æåï¼é®é¢å·æéæºæ§ã</p>
<p><strong>è§£å³æ¹æ¡</strong>ï¼å®ç°å¸¦éå¶çéè¯æºå¶ï¼å éå¤±è´¥åï¼é´éä¸å®æ¶é´ï¼å¦ 100msï¼éè¯ï¼åæ¶è®¾ç½®æå¤§éè¯æ¬¡æ°ï¼å¦ 3 æ¬¡ï¼åæ»è¶æ¶æ¶é´ï¼å¦ 1 ç§ï¼ï¼é¿åæ ééè¯å¯¼è´ Redis ååè¿å¤§ï¼ä¹è½æåå éæåçã</p>
<pre><code class="language-java">// å¸¦éè¯çå éé»è¾ï¼Spring Data Redis ç¤ºä¾ï¼
public boolean lockWithRetry(String key, String value, long expireMs, int maxRetry, long retryIntervalMs) {
    for (int i = 0; i &lt; maxRetry; i++) {
        Boolean result = redisTemplate.opsForValue().setIfAbsent(key, value, expireMs, TimeUnit.MILLISECONDS);
        if (Boolean.TRUE.equals(result)) {
            return true;
        }
        try {
            Thread.sleep(retryIntervalMs);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
            return false;
        }
    }
    return false;
}
</code></pre>
<h3 id="é®é¢-7é¿æ¶é´ææéç³»ç»å¹¶åééª¤é">é®é¢ 7ï¼é¿æ¶é´ææéââç³»ç»å¹¶åééª¤é</h3>
<p><strong>æå </strong>ï¼å¨éçèå´åæ§è¡èæ¶æä½ï¼å¦å¤ææ°æ®åºæ¥è¯¢ãç¬¬ä¸æ¹æ¥å£è°ç¨ãå¤§éæ°æ®å¤çï¼ï¼å¯¼è´éæææ¶é´è¿é¿ï¼å¶ä»æå¡è¯·æ±è¯¥éæ¶è¢«é¿æ¶é´é»å¡ï¼ç³»ç»ååéå¤§å¹ä¸éã</p>
<p><strong>è¡¨ç°</strong>ï¼ä¾èµè¯¥éçæ¥å£ååºæ¶é´åé¿ï¼å¹¶åéä¸ä¸å»ï¼çæ§æ¾ç¤ºå¤§éçº¿ç¨é»å¡å¨å éç¯èã</p>
<p><strong>è§£å³æ¹æ¡</strong>ï¼</p>
<ul>
<li>
<p>ç²¾ç®éåä¸å¡ï¼ä»å°âèµæºç«äºæ ¸å¿é»è¾âï¼å¦åºå­æ£åãè®¢åç¶æä¿®æ¹ï¼æ¾å¥éåï¼éæ ¸å¿é»è¾ï¼å¦æ¥å¿è®°å½ãæ¶æ¯æ¨éï¼ç§»è³éå¤æ§è¡ã</p>
</li>
<li>
<p>å¼æ­¥åå¤çï¼è¥éåå¿é¡»æ§è¡èæ¶æä½ï¼å°å¶å¼æ­¥åï¼å¦ç¨çº¿ç¨æ± ãæ¶æ¯éåï¼ï¼ç¼©ç­éæææ¶é´ã</p>
</li>
<li>
<p>è®¾ç½®éææè¶æ¶é¢è­¦ï¼éè¿çæ§å·¥å·ç»è®¡éæææ¶é´ï¼è¶è¿éå¼ï¼å¦ 20 ç§ï¼æ¶åè­¦ï¼åæ¶ææ¥èæ¶ä¸å¡ã</p>
</li>
</ul>
<h3 id="é®é¢-8é-key-è®¾è®¡ä¸å½éç²åº¦é®é¢å¼åå¹¶åç¶é¢">é®é¢ 8ï¼é key è®¾è®¡ä¸å½ââéç²åº¦é®é¢å¼åå¹¶åç¶é¢</h3>
<p><strong>æå </strong>ï¼é key ç²åº¦å¤ªç²ï¼å¦ç¨âlock:stockâä½ä¸ºææååçåºå­éï¼ï¼å¯¼è´ææååçåºå­æä½é½äºæ¥ï¼å³ä½¿æä½ä¸åååï¼ä¹éæéç­å¾ééæ¾ï¼å½»åºä¸§å¤±åå¸å¼ç³»ç»çå¹¶åä¼å¿ã</p>
<p><strong>è¡¨ç°</strong>ï¼ç³»ç»å¹¶åéæä½ï¼ä¸åååçåºå­æ£åè¯·æ±ä¸²è¡æ§è¡ï¼æ¥å£ååéè¿ä½äºé¢æã</p>
<p><strong>è§£å³æ¹æ¡</strong>ï¼ç²¾ç»åè®¾è®¡é keyï¼æå·ä½èµæºæ è¯æåéãæ¯å¦åºå­éï¼ç¨âlock:stock:1001âï¼1001 ä¸ºåå IDï¼ä½ä¸ºé keyï¼ä»å¯¹åä¸ååçåºå­æä½äºæ¥ï¼ä¸åååå¯å¹¶è¡å¤çï¼å¤§å¹æåå¹¶åéã</p>
<p>å»¶ä¼¸ï¼é«å¹¶ååºæ¯ä¸ï¼å¯è¿ä¸æ­¥ç¨âåæ®µéâæåèµæºï¼å¦å°åå ID åå¸å° 10 ä¸ªåæ®µï¼é key ä¸ºâlock:stock:segment:1âï¼ï¼åä¸åæ®µäºæ¥ï¼ä¸ååæ®µå¹¶è¡ï¼è¿ä¸æ­¥æåå¹¶åè½åã</p>
<h3 id="é®é¢-9ç½ç»ååºå¯¼è´éç¶æä¸ä¸è´æç«¯åºæ¯ä¸çéæ£">é®é¢ 9ï¼ç½ç»ååºå¯¼è´éç¶æä¸ä¸è´ââæç«¯åºæ¯ä¸çéæ£</h3>
<p><strong>æå </strong>ï¼åå¸å¼ç¯å¢ä¸­åºç°ç½ç»ååºï¼ææéçæå¡ä¸ Redis éç¾¤éç¦»ï¼æ æ³ä¸»å¨éæ¾éï¼ä¹æ æ³æ¥æ¶éç»­çº¦ä¿¡å·ï¼éè¿æåï¼å¶ä»æå¡å éæåï¼ç½ç»æ¢å¤åï¼åææéçæå¡è¯¯ä»¥ä¸ºéä»ææï¼ç»§ç»­æä½èµæºï¼å¯¼è´æ°æ®å²çªã</p>
<p><strong>è¡¨ç°</strong>ï¼æç«¯ç½ç»å¼å¸¸åï¼åºç°æ°æ®ä¸ä¸è´ï¼ä¸é®é¢é¾ä»¥ææ¥ï¼ä¸ç½ç»ååºæ¶é´ãéè¿ææ¶é´å¼ºç¸å³ï¼ã</p>
<p><strong>è§£å³æ¹æ¡</strong>ï¼</p>
<ul>
<li>
<p>å¼å¥ä¸å¡æ ¡éªæºå¶ï¼æä½èµæºåï¼åæ¬¡æ ¡éªèµæºç¶æï¼å¦æ£ååºå­åï¼æ£æ¥åºå­æ¯å¦ä¸é¢æä¸è´ï¼ï¼é¿ååºäºè¿æéçæ ææä½ã</p>
</li>
<li>
<p>ç¼©ç­éè¿ææ¶é´ï¼ç»å Watch Dog æºå¶ï¼å°åºç¡è¿ææ¶é´è®¾ç­ï¼å¦ 10 ç§ï¼ï¼åå°ç½ç»ååºå¯¼è´çéç¶æä¸ä¸è´çªå£ã</p>
</li>
<li>
<p>ä½¿ç¨ Redlock ç®æ³ï¼å¤ä¸»èç¹æç¥¨æºå¶ï¼å¯éä½ç½ç»ååºå¯¹éç¶æçå½±åï¼æåä¸è´æ§ã</p>
</li>
</ul>
<h2 id="äºçäº§é¿åæ»ç»">äºãçäº§é¿åæ»ç»</h2>
<p>Redis åå¸å¼éçé®é¢ï¼å¤§å¤ä¸æ¯ Redis æ¬èº«çç¼ºé·ï¼èæ¯å¯¹åå¸å¼åºæ¯çå¤ææ§èèä¸è¶³ãç»åå®æç»éªï¼æ»ç» 3 ä¸ªæ ¸å¿é¿åååï¼</p>
<ol>
<li>
<p>ä¼åä½¿ç¨æçæ¡æ¶ï¼æ¾å¼æå¨å®ç°åå¸å¼éï¼Redisson å·²å°è£è§£å³ä¸è¿°ææé®é¢ï¼å¼ç®±å³ç¨ï¼ç¨³å®æ§è¿é«äºèªå®ä¹å®ç°ã</p>
</li>
<li>
<p>å¹éä¸å¡åºæ¯éåï¼é«ä¸è´æ§ãé«å¯ç¨åºæ¯ç¨ Redlock ç®æ³ï¼ä¸è¬åºæ¯ç¨ä¸»ä» + å¨åµæ¨¡å¼ï¼æ ¹æ®å¹¶åéè®¾è®¡éç²åº¦ï¼ç²¾ç»å/åæ®µéï¼ã</p>
</li>
<li>
<p>å®åçæ§ä¸ååºï¼çæ§éæææ¶é´ãå éæåçãRedis éç¾¤ç¶æï¼è®¾ç½®åè­¦éå¼ï¼å éå¤±è´¥ãéè¿æç­åºæ¯ï¼éæä¸å¡ååºç­ç¥ï¼éè¯ãè¿ååå¥½æç¤ºãéåç¼å­ï¼ã</p>
</li>
</ol>
<p>æ»ä¹ï¼Redis åå¸å¼éçæ ¸å¿æ¯âå¼é¡¾äºæ¥æ§ä¸é«å¯ç¨âï¼é¿å¼ä¸è¿°é®é¢åï¼æè½çæ­£æä¸ºåå¸å¼ç³»ç»è§£å³å¹¶åå²çªçå©å¨ï¼èéç³»ç»çæ°ç¶é¢ã</p>

</div>
<div id="MySignature" role="contentinfo">
    
<p>â¤ï¸ å¦æä½ åæ¬¢è¿ç¯æç« ï¼è¯·ç¹èµæ¯æï¼ ð åæ¶æ¬¢è¿å³æ³¨æçåå®¢ï¼è·åæ´å¤ç²¾å½©åå®¹ï¼</p>

<p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/sun-10387834/" target="_blank">ä½ç¥è®©ææ¥å·¡å±±</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/sun-10387834/p/19493006" target="_blank">https://www.cnblogs.com/sun-10387834/p/19493006</a></p>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-20 19:24">2026-01-20 19:23</span>&nbsp;
<a href="https://www.cnblogs.com/sun-10387834">ä½ç¥è®©ææ¥å·¡å±±</a>&nbsp;
éè¯»(<span id="post_view_count">7</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19493006);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19493006', targetLink: 'https://www.cnblogs.com/sun-10387834/p/19493006', title: 'å¹²è´§æ»¡æ»¡ï¼Redis åå¸å¼éå¿é¿ç 8 å¤§é®é¢åè§£å³æ¹æ¡' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ åä¸ºäºåå¸CodeArts Doerä»£ç æºè½ä½ä¸ªäººçï¼ä¸é®å¼å¯ä½ çç¼ç èªå¨é©¾é©¶æ¨¡å¼ ]]></title>
    <link>https://www.cnblogs.com/huaweiyun/p/19508288</link>
    <guid>6f2339ae6a62e712ab5ac97d24c28bf9</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/huaweiyun/p/19508288" title="åå¸äº 2026-01-20 18:34">
    <span role="heading" aria-level="2">åä¸ºäºåå¸CodeArts Doerä»£ç æºè½ä½ä¸ªäººçï¼ä¸é®å¼å¯ä½ çç¼ç èªå¨é©¾é©¶æ¨¡å¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<div style="text-align: left" align="center">2026å¹´1æ16æ¥ï¼åä¸ºäºæ­£å¼åå¸CodeArts Doerä»£ç æºè½ä½ãè¿æ¬¾æ·±åº¦èåAIåçè½åçæºè½ç¼ç äº§åï¼éæäºAI IDEãCode AgentãCodebaseä»£ç ä»æ·±åº¦çè§£ç­æ ¸å¿è½åï¼æ´æç åéæ±ãç²¾éç¼ç ãåç¨ç¾å¨ï¼ä¸ºå¼åèå¸¦æ¥çæ°ç åä½éªã</div>
<div style="text-align: left">&nbsp;<img alt="" data-src="https://img2024.cnblogs.com/blog/2030258/202601/2030258-20260120183417566-1436339979.png" class="lazyload"></div>
<p>æ¬æ¬¡åå¸çä¸å¤§æ°åç¹æ§ï¼ AI IDEãCode AgentãCodebase</p>
<p><strong>AI IDE</strong><strong>ï¼åçæºè½ï¼çæ°å¼åä½éª</strong></p>
<p>AI IDEä»¥AIåçä¸ºèµ·ç¹ï¼å°ç¼ç è½åä¸æºè½ä½æ·±åº¦èåï¼ä¸ºå¼åèå¸¦æ¥æ´èªç¶çå¼åå·¥ä½æµï¼ä»éæ±æè¿°å°ä»»å¡æè§£ï¼ä»æ¥å£è®¾è®¡å°ä»£ç è½å°ï¼å¨IDEåå³å¯å®æé­ç¯ãåæ¶ï¼AI IDEåç½®ä¸å®¶æè½ä¸ç²¾éå·¥å·ï¼å½¢æâäºº+AI+å·¥å·âçååå¼åå¹³å°ï¼å¼åèä¸æ³¨ä¸å¡å¤æ­ä¸å³é®å³ç­ï¼AI IDEè´è´£é«é¢ãéå¤ãæéæ¼çå·¥ç¨åå·¥ä½ï¼è®©ä½éªä»âå¤å¼çªå£æ¾å·¥å·âåçº§ä¸ºâå¨ä¸ä¸ªå·¥ä½å°éå®æäº¤ä»âã</p>
<p>&nbsp;<img alt="" data-src="https://img2024.cnblogs.com/blog/2030258/202601/2030258-20260120183416252-348731928.png" class="lazyload"></p>
<p><strong>Code Agent</strong><strong>ï¼å·¦æç¼ç èªç±ï¼å³æè§èé«æ</strong></p>
<p>CodeArts Doerä»£ç æºè½ä½æä¾ä¸¤ç§é¢åä¸åé¶æ®µä¸è¯æ±çå¼åæ¨¡å¼ï¼</p>
<p>æ¢ç´¢æ¨¡å¼ï¼æ´å¼ºè°äººæºååä¸åé åãä½ å¯ä»¥ç¨èªç¶è¯­è¨æè¿°éæ±ç®æ ï¼è®©CodeArts Doerä»£ç æºè½ä½ä¸ºä½ è§åå¹¶åè§£é¡¹ç®ä»»å¡ï¼çæé¡¹ç®çº§ä»£ç ãè¿è¡Agentç¥è¯å¢å¼ºãä»£ç ç»­åï¼å¹¶å¨å¤è½®å¯¹è¯ä¸­æç»­è¿­ä»£ï¼æâæ³æ³âå¿«éæ¨è¿å°âå¯è¿è¡âã</p>
<p>è§èæ¨¡å¼ï¼æ´å¼ºè°è´¨éãå®å¨ä¸ä¸è´æ§ãè§èé©±å¨å¼åï¼è®©ä»£ç éµä»æ åæµç¨çæãå¨çæä¸ä¿®æ¹ä»£ç è¿ç¨ä¸­å¯¹é½è§èï¼æåä»£ç çå¯è¯»æ§ãå¯ç»´æ¤æ§ï¼åæ¶å¨å³é®ç¹è¿è¡å®å¨ä¸è´¨éæ ¡éªï¼å¸®å©å¢éæâå¿«âå»ºç«å¨âç¨³âçåºç¡ä¸ã</p>
<p><img alt="" data-src="https://img2024.cnblogs.com/blog/2030258/202601/2030258-20260120183416252-348731928.png" class="lazyload"></p>
<p><strong>Codebase</strong><strong>ï¼ä»£ç ä»æ·±åº¦çè§£ï¼ææä½ çAIç¼ç ä¸å®¶</strong></p>
<p>çæ­£éç¨äºçäº§ç¯å¢çAIç¼ç ï¼å³é®å¨äºâçè§£ä½ çé¡¹ç®âãCodebaseæ¯æç¾ä¸è¡çº§ä»£ç ç´¢å¼ãç¥è¯å¾è°±æå»ºãææ¡£çæä¸æ¼ååå²ç¥è¯æ²æ·ï¼åç¡®çè§£ä»£ç ä»ç»æãä¾èµå³ç³»ä¸ä¸å¡è¾¹çï¼åèº«æä¸ä½ä¸å±çä»£ç ç¥è¯ä¸å®¶ï¼å¸®å©æ°æåå¿«éä¸æãèæåå¿«éå®ä½ãåæ¶ï¼åç¡®æ£ç´¢è½åè®©AIæ´å¿«æ¾å°ä½ çæ­£éè¦çå½æ°ãæ¥å£ä¸å®ç°ç»èï¼åå°âçä¼¼æ­£ç¡®ãå®åä¸ééâççæåå®¹ï¼è®©æ¯ä¸æ¬¡å»ºè®®é½æ´è´´è¿é¡¹ç®ç°å®ã</p>
<p>&nbsp;<img alt="" data-src="https://img2024.cnblogs.com/blog/2030258/202601/2030258-20260120183417231-1140323952.png" class="lazyload"></p>
<p><strong>å¤ç§ç¨æ·åºæ¯ï¼è®©ç åä»âäººåä¸»å¯¼âèµ°åâäººæºå±åâ</strong></p>
<p>CodeArts Doerä»£ç æºè½ä½å·²å¨é¡¹ç®çº§ä»£ç çæãAgentç¥è¯å¢å¼ºãä»£ç ç»­åãç åç¥è¯é®ç­ãååæµè¯çæç­åºæ¯å®ç°å¼åèæçæåï¼åæ¶ä¹æ¯æä¸°å¯å·¥å·çæï¼å©åé«æå¼åä¸ä¸ªæ§åå®å¶ã</p>
<p>ç®åï¼CodeArts Doerä»£ç æºè½ä½ä¸ªäººçå·²ç»æ­£å¼åå¸ï¼é¢åå¹¿å¤§å¼åèå¼æ¾åè´¹ä½éªãè®©AIçæ­£èµ°è¿å·¥ç¨ãèµ°è¿æµç¨ãèµ°è¿äº¤ä»ââä»ä»å¤©èµ·ï¼å¼å¯ä½ çç¼ç èªå¨é©¾é©¶æ¨¡å¼ã</p>
<p>ä½éªCodeArts Doerä»£ç æºè½ä½ï¼<a href="https://developer.huaweicloud.com/signup/78745481cafb4d79bf62096f6770c72e?channelCode=hcdg" target="_blank" rel="noopener nofollow">https://developer.huaweicloud.com/signup/78745481cafb4d79bf62096f6770c72e?channelCode=hcdg</a></p>
<p>&nbsp;</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-20 18:34">2026-01-20 18:34</span>&nbsp;
<a href="https://www.cnblogs.com/huaweiyun">åä¸ºäºå¼åèèç</a>&nbsp;
éè¯»(<span id="post_view_count">22</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19508288);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19508288', targetLink: 'https://www.cnblogs.com/huaweiyun/p/19508288', title: 'åä¸ºäºåå¸CodeArts Doerä»£ç æºè½ä½ä¸ªäººçï¼ä¸é®å¼å¯ä½ çç¼ç èªå¨é©¾é©¶æ¨¡å¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ è¿é¶æåï¼BrowserUse + Agentrun Sandbox æä½³å®è·µæå ]]></title>
    <link>https://www.cnblogs.com/Serverless/p/19507367</link>
    <guid>653a53287200fff87edeaef7ad5b608b</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Serverless/p/19507367" title="åå¸äº 2026-01-20 16:12">
    <span role="heading" aria-level="2">è¿é¶æåï¼BrowserUse + Agentrun Sandbox æä½³å®è·µæå</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p><strong>æç¤º</strong>: æ¬ææ¯AgentRun Browser Sandbox å¿«éä¸æå®è·µæåçå§å¦¹ç¯,ä¸æ³¨äºé«çº§éææ¹æ¡ãçäº§ç¯å¢çæä½³å®è·µãæ§è½ä¼ååé¨ç½²ç­ç¥ãå¦ææ¨è¿æ²¡æå®æåºç¡å­¦ä¹ ,è¯·åéè¯»<a href="https://mp.weixin.qq.com/s/2LjN6LxymuZNlWUR-nhrEg" target="_blank" rel="noopener nofollow">ãå¿«éä¸æï¼LangChain + AgentRun æµè§å¨æ²ç®±æç®éææåã</a>ã</p>
</blockquote>
<h2 id="åè¨">åè¨</h2>
<p>å¨å®æäº Browser Sandbox çåºç¡éæä¹åï¼æ¬æå°ä»ç»é«çº§éææ¹æ¡ï¼å¦ BrowserUse æ¡æ¶ï¼ä»¥åçäº§ç¯å¢é¨ç½²éè¦èèçå ç´ ï¼å¦ä½ç®¡ç Sandbox çå½å¨æï¼å¦ä½ä¼åæ§è½åææ¬ï¼å¦ä½ä¿è¯ç³»ç»çå®å¨æ§åå¯è§æµæ§ï¼æ¬æå°ä¸ºæ¨æä¾å¨é¢çé«çº§åºç¨åçäº§ç¯å¢æä½³å®è·µæåã</p>
<h2 id="åºäº-browseruse-éæ-browser-sandbox">åºäº BrowserUse éæ Browser Sandbox</h2>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2123714/202601/2123714-20260120161152867-1802574501.png" class="lazyload"></p>
<p>&lt;æææªå¾&gt;</p>
<p>BrowserUse æ¯ä¸ä¸ªä¸é¨ä¸º AI Agent è®¾è®¡çæµè§å¨èªå¨åæ¡æ¶,æ¯æè§è§çè§£åæºè½å³ç­ãéè¿ AgentRun Browser Sandboxï¼æ¨å¯ä»¥è®© BrowserUse å¨äºç«¯è¿è¡,äº«å Serverless æ¶æçä¼å¿ã</p>
<h3 id="browseruse-æ¶ææ¦è§">BrowserUse æ¶ææ¦è§</h3>
<p>ä¸å¾å±ç¤ºäº BrowserUse ä¸ Browser Sandbox çéææ¶æï¼</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2123714/202601/2123714-20260120161152818-592122718.png" class="lazyload"></p>
<p><strong>æ¶æç¹ç¹ï¼</strong></p>
<ol>
<li><strong>æºè½å³ç­å¾ªç¯</strong>ï¼Agent éè¿ LLM åæé¡µé¢æªå¾,åºäºè§è§çè§£çææä½æä»¤ï¼æ§è¡æä½åç»§ç»­å¾ªç¯ï¼ç´å°ä»»å¡å®æ</li>
<li><strong>æ å¤´æµè§å¨æ§å¶</strong>ï¼éè¿ CDP åè®®è¿ç¨æ§å¶äºç«¯æµè§å¨ï¼Playwright ä½ä¸ºåºå±é©±å¨ï¼æææä½å¨äºç«¯æ§è¡</li>
<li><strong>å®æ¶å¯è§å</strong>ï¼VNC æä¾å®æ¶ç»é¢çæ§,æ¹ä¾¿è°è¯åéªè¯ Agent è¡ä¸º</li>
</ol>
<h3 id="å¿«éå¼å§">å¿«éå¼å§</h3>
<h4 id="å®è£ä¾èµ">å®è£ä¾èµ</h4>
<pre><code class="language-bash">pip install browser-use python-dotenv agentrun-sdk[playwright,server]
</code></pre>
<p>ä¸»è¦ä¾èµè¯´æï¼</p>
<ul>
<li><code>browser-use</code>: BrowserUse æ ¸å¿åº,æ¯æå¤æ¨¡æ LLM</li>
<li><code>agentrun-sdk[playwright,server]</code>: AgentRun SDKï¼ç¨äºåå»º Sandbox</li>
<li><code>python-dotenv</code>: ç¯å¢åéç®¡ç</li>
</ul>
<h4 id="éç½®ç¯å¢åé">éç½®ç¯å¢åé</h4>
<p>åå»º <code>.env</code> æä»¶ï¼</p>
<pre><code class="language-bash"># DashScope API Keyï¼ç¨äº Qwen æ¨¡åï¼
DASHSCOPE_API_KEY=sk-your-dashscope-api-key

# AgentRun è®¤è¯ä¿¡æ¯
AGENTRUN_ACCOUNT_ID=your-account-id
ALIBABA_CLOUD_ACCESS_KEY_ID=your-access-key-id
ALIBABA_CLOUD_ACCESS_KEY_SECRET=your-access-key-secret

# Browser Sandbox æ¨¡æ¿åç§°
BROWSER_TEMPLATE_NAME=sandbox-browser-demo
</code></pre>
<h4 id="åå»º-sandbox-å¹¶ä½¿ç¨-browseruse">åå»º Sandbox å¹¶ä½¿ç¨ BrowserUse</h4>
<pre><code class="language-python">import asyncio
import os
from agentrun.sandbox import Sandbox, TemplateType
from browser_use import Agent, BrowserSession, ChatOpenAI
from browser_use.browser import BrowserProfile
from dotenv import load_dotenv

load_dotenv()

async def main():
    # åå»º Browser Sandbox
    sandbox = Sandbox.create(
        template_type=TemplateType.BROWSER,
        template_name=os.getenv("BROWSER_TEMPLATE_NAME"),
        sandbox_idle_timeout_seconds=3000
    )
    
    # éç½® Qwen å¤æ¨¡ææ¨¡å
    llm = ChatOpenAI(
        model='qwen-vl-max',
        api_key=os.getenv("DASHSCOPE_API_KEY"),
        base_url="https://dashscope.aliyuncs.com/compatible-mode/v1"
    )
    
    # åå»ºæµè§å¨ä¼è¯
    browser_session = BrowserSession(
        cdp_url=sandbox.get_cdp_url(),
        browser_profile=BrowserProfile(
            headless=False,
            timeout=3000000,
            keep_alive=True
        )
    )
    
    # åå»º Agent å¹¶æ§è¡ä»»å¡
    agent = Agent(
        task="è®¿é®é¿éäºå®ç½å¹¶æ»ç»ä¸»è¦äº§ååç±»",
        llm=llm,
        browser_session=browser_session,
        use_vision=True
    )
    
    result = await agent.run()
    
    print(f"ä»»å¡ç»æ: {result.final_result()}")
    
    # æ¸çèµæº
    await browser_session.stop()
    sandbox.delete()

if __name__ == "__main__":
    asyncio.run(main())
</code></pre>
<h3 id="browseruse-é«çº§éç½®">BrowserUse é«çº§éç½®</h3>
<h4 id="èªå®ä¹æµè§å¨è¡ä¸º">èªå®ä¹æµè§å¨è¡ä¸º</h4>
<pre><code class="language-python">browser_profile = BrowserProfile(
    timeout=3000000,             # è¶æ¶æ¶é´ï¼æ¯«ç§ï¼
    keep_alive=True,             # ä¿æä¼è¯æ´»è·
)
</code></pre>
<h4 id="å¤æ­¥éª¤ä»»å¡ç¼æ">å¤æ­¥éª¤ä»»å¡ç¼æ</h4>
<pre><code class="language-python">async def complex_task():
    """å¤æçå¤æ­¥éª¤ä»»å¡"""
    sandbox = Sandbox.create(
        template_type=TemplateType.BROWSER,
        template_name=os.getenv("BROWSER_TEMPLATE_NAME"),
        sandbox_idle_timeout_seconds=3000
    )
    
    llm = ChatOpenAI(
        model='qwen-vl-max',
        api_key=os.getenv("DASHSCOPE_API_KEY"),
        base_url="https://dashscope.aliyuncs.com/compatible-mode/v1"
    )
    
    browser_session = BrowserSession(
        cdp_url=sandbox.cdp_url,
        browser_profile=BrowserProfile(keep_alive=True)
    )
    
    # ä»»å¡ 1ï¼ä¿¡æ¯æ¶é
    agent1 = Agent(
        task="è®¿é®é¿éäºå®ç½ï¼æ¶éäº§ååç±»ä¿¡æ¯",
        llm=llm,
        browser_session=browser_session,
        use_vision=True
    )
    result1 = await agent1.run()
    
    # ä»»å¡ 2ï¼åºäºç¬¬ä¸æ­¥ç»æç»§ç»­æä½
    agent2 = Agent(
        task=f"åºäºä»¥ä¸ä¿¡æ¯ï¼{result1.final_result()}ï¼è®¿é®æ¯ä¸ªäº§ååç±»å¹¶æåå³é®ç¹æ§",
        llm=llm,
        browser_session=browser_session,
        use_vision=True
    )
    result2 = await agent2.run()
    
    # æ¸çèµæº
    await browser_session.stop()
    sandbox.delete()
    
    return result2.final_result()
</code></pre>
<h4 id="éæ-vnc-å®æ¶çæ§">éæ VNC å®æ¶çæ§</h4>
<pre><code class="language-python">import webbrowser
import urllib.parse

async def run_with_vnc_monitoring():
    """è¿è¡ BrowserUse å¹¶å¯ç¨ VNC çæ§"""
    sandbox = Sandbox.create(
        template_type=TemplateType.BROWSER,
        template_name=os.getenv("BROWSER_TEMPLATE_NAME"),
        sandbox_idle_timeout_seconds=3000
    )
    
    # è·å VNC URL å¹¶æå¼æ¥çå¨
    vnc_url = sandbox.get_vnc_url(),
    if vnc_url:
        # ä¿®å¤ VNC URL è·¯å¾
        if vnc_url.endswith('/vnc'):
            vnc_url = vnc_url[:-4] + '/ws/livestream'
        
        # å¨æµè§å¨ä¸­æå¼ VNC æ¥çå¨
        encoded_url = urllib.parse.quote(vnc_url, safe='')
        viewer_url = f"file://path/to/vnc-viewer.html?url={encoded_url}"
        webbrowser.open(viewer_url)
        print(f"VNC æ¥çå¨å·²æå¼ï¼å¯å®æ¶çæ§æµè§å¨æä½")
    
    # åå»ºå¹¶è¿è¡ Agent
    llm = ChatOpenAI(
        model='qwen-vl-max',
        api_key=os.getenv("DASHSCOPE_API_KEY"),
        base_url="https://dashscope.aliyuncs.com/compatible-mode/v1"
    )
    
    browser_session = BrowserSession(
        cdp_url=sandbox.get_cdp_url(),
        browser_profile=BrowserProfile(headless=False, keep_alive=True)
    )
    
    agent = Agent(
        task="è®¿é®æ·å®é¦é¡µå¹¶æç´¢åå",
        llm=llm,
        browser_session=browser_session,
        use_vision=True
    )
    
    result = await agent.run()
    
    # æ¸çèµæº
    await browser_session.stop()
    sandbox.delete()
    
    return result.final_result()
</code></pre>
<h3 id="browseruse-æä½³å®è·µ">BrowserUse æä½³å®è·µ</h3>
<ol>
<li><strong>å¯ç¨è§è§çè§£</strong>ï¼å¯¹äºå¤æé¡µé¢ï¼ä½¿ç¨ <code>use_vision=True</code> è®© LLM åæé¡µé¢æªå¾</li>
<li><strong>ä¿æä¼è¯æ´»è·</strong>ï¼ä½¿ç¨ <code>keep_alive=True</code> é¿åé¢ç¹éå»ºè¿æ¥</li>
<li><strong>åçè®¾ç½®è¶æ¶</strong>ï¼æ ¹æ®ä»»å¡å¤æåº¦è°æ´ <code>timeout</code> åæ°</li>
<li><strong>å¤ç¨ BrowserSession</strong>ï¼å¯¹äºå¤æ­¥éª¤ä»»å¡ï¼å¤ç¨åä¸ä¸ª BrowserSession æé«æç</li>
<li><strong>ç»å VNC è°è¯</strong>ï¼å¼åé¶æ®µå¯ç¨ VNC å®æ¶æ¥ç Agent è¡ä¸º</li>
</ol>
<h3 id="è·åå®æ´ç¤ºä¾ä»£ç ">è·åå®æ´ç¤ºä¾ä»£ç </h3>
<p>æ¬æä¸­çææç¤ºä¾ä»£ç é½å¯ä»¥å¨ä»¥ä¸ä»åºä¸­æ¾å°ï¼</p>
<pre><code class="language-bash"># åéç¤ºä¾ä»£ç ä»åº
git clone https://github.com/devsapp/agentrun-sandbox-demos.git

# è¿å¥é¡¹ç®ç®å½
cd agentrun-browseruse-wth-sandbox-demo

# å®è£ä¾èµï¼æ³¨æéè¦å®è£ server æ©å±ï¼
pip install -r requirements.txt
</code></pre>
<h4 id="éç½®ç¯å¢åé-1">éç½®ç¯å¢åé</h4>
<pre><code class="language-bash"># å¤å¶ç¯å¢åéæ¨¡æ¿
cp env.example .env

# ç¼è¾ .env æä»¶ï¼å¡«å¥æ¨çéç½®ä¿¡æ¯
# å¿ééç½®é¡¹ï¼
# - DASHSCOPE_API_KEY: DashScope API Keyï¼ç¨äº Qwen æ¨¡åï¼
# - AGENTRUN_ACCOUNT_ID: AgentRun è´¦å· ID
# - ALIBABA_CLOUD_ACCESS_KEY_ID: é¿éäºè®¿é®å¯é¥ ID
# - ALIBABA_CLOUD_ACCESS_KEY_SECRET: é¿éäºè®¿é®å¯é¥ Secret
# - BROWSER_TEMPLATE_NAME: Browser Sandbox æ¨¡æ¿åç§°
</code></pre>
<h4 id="è¿è¡ç¤ºä¾ä¸¤æ­¥è¿è¡è®¾è®¡">è¿è¡ç¤ºä¾ï¼ä¸¤æ­¥è¿è¡è®¾è®¡ï¼</h4>
<p>æ¬é¡¹ç®éç¨<strong>æå¡å¨-å®¢æ·ç«¯</strong>çæ¶æè®¾è®¡ï¼éè¦åä¸¤æ­¥è¿è¡ï¼</p>
<p><strong>ç¬¬ä¸æ­¥ï¼å¯å¨ VNC æ¥çå¨æå¡</strong></p>
<pre><code class="language-bash"># å¨ç»ç«¯ 1 ä¸­å¯å¨ VNC Web æå¡å¨
python main.py

# æå¡å¯å¨åä¼æ¾ç¤ºï¼
# VNC æ¥çå¨æå¡å·²å¯å¨: http://localhost:8000
# è®¿é® http://localhost:8000 å¯ä»¥å®æ¶æ¥çæµè§å¨æä½
</code></pre>
<p><code>main.py</code> çä½ç¨ï¼</p>
<ul>
<li>å¯å¨æ¬å° Web æå¡å¨ï¼æä¾ VNC å®æ¶æ¥ççé¢</li>
<li>æä¾ WebSocket ä»£çï¼è¿æ¥ AgentRun Sandbox ç VNC æå¡</li>
<li>åè®¸æ¨å¨æµè§å¨ä¸­å®æ¶çæ§ Agent çæä½è¿ç¨</li>
</ul>
<p><strong>ç¬¬äºæ­¥ï¼è¿è¡ BrowserUse ç¤ºä¾</strong></p>
<pre><code class="language-bash"># å¨ç»ç«¯ 2 ä¸­è¿è¡ç¤ºä¾ä»£ç 
python examples/01_browseruse_basic.py

# è¿è¡é«çº§ç¤ºä¾
python examples/02_browseruse_advanced.py
</code></pre>
<p><strong>ä¸ºä»ä¹éè¦ä¸¤æ­¥è¿è¡ï¼</strong></p>
<ol>
<li><strong>å®æ¶çæ§</strong>ï¼main.py æä¾ VNC æ¥çå¨ï¼å¯ä»¥å®æ¶çå° Agent å¨æµè§å¨ä¸­çæä½</li>
<li><strong>è°è¯åå¥½</strong>ï¼éè¿å¯è§åçé¢ï¼æ´å®¹æçè§£ Agent çå³ç­è¿ç¨åè¡ä¸º</li>
<li><strong>æå¡è§£è¦</strong>ï¼VNC æå¡åä¸å¡é»è¾åç¦»ï¼å¯ä»¥åæ¶è¿è¡å¤ä¸ªç¤ºä¾èå±ç¨åä¸ä¸ªæ¥çå¨</li>
</ol>
<p><strong>è¿è¡æµç¨å¾ï¼</strong></p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2123714/202601/2123714-20260120161152812-1325245902.png" class="lazyload"></p>
<p><strong>ä»åºåå®¹åæ¬ï¼</strong></p>
<ul>
<li><code>main.py</code>: VNC Web æå¡å¨ï¼ç¨äºå®æ¶çæ§</li>
<li><code>examples/01_browseruse_basic.py</code>: åºç¡éæç¤ºä¾</li>
<li><code>examples/02_browseruse_advanced.py</code>: é«çº§éç½®ç¤ºä¾</li>
<li><code>examples/sandbox_manager.py</code>: Sandbox çå½å¨æç®¡ç</li>
<li><code>vncviewer/</code>: VNC æ¥çå¨åç«¯ååç«¯ä»£ç </li>
<li>å®æ´çç¯å¢éç½®åæä½³å®è·µä»£ç </li>
</ul>
<hr>
<h2 id="sandbox-çå½å¨æç®¡çæä½³å®è·µ">Sandbox çå½å¨æç®¡çæä½³å®è·µ</h2>
<h3 id="ä¸ç§ç®¡çæ¨¡å¼">ä¸ç§ç®¡çæ¨¡å¼</h3>
<p>æ ¹æ®ä¸åçåºç¨åºæ¯,æä»¬æ¨èä¸ç§ Sandbox ç®¡çæ¨¡å¼ï¼</p>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2123714/202601/2123714-20260120161152792-1428609621.png" class="lazyload"></p>
<p><strong>æ¹æ¡å¯¹æ¯ï¼</strong></p>
<table>
<thead>
<tr>
<th>ç®¡çæ¨¡å¼</th>
<th>ä¼ç¹</th>
<th>ç¼ºç¹</th>
<th>éç¨åºæ¯</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>åä¾æ¨¡å¼</strong></td>
<td>â¢ èµæºå¤ç¨   â¢ ååºå¿«   â¢ ç®åæç¨</td>
<td>â¢ ç¶ææ±¡æé£é©   â¢ ä¸éåå¹¶å</td>
<td>å¼åè°è¯   å¤è½®å¯¹è¯   ä¸ªäººåºç¨</td>
</tr>
<tr>
<td><strong>è¯·æ±çº§å«</strong></td>
<td>â¢ ç¯å¢éç¦»   â¢ ç¶æç¬ç«   â¢ å®å¨æ§é«</td>
<td>â¢ åå»ºå¼éå¤§   â¢ ææ¬è¾é«</td>
<td>ä¸æ¬¡æ§ä»»å¡   é«å®å¨éæ±   æ ç¶ææå¡</td>
</tr>
<tr>
<td><strong>è¿æ¥æ± </strong></td>
<td>â¢ å¹¶åè½åå¼º   â¢ èµæºå©ç¨çé«   â¢ æ§è½ç¨³å®</td>
<td>â¢ å®ç°å¤æ   â¢ éè¦çæ§</td>
<td>çäº§ç¯å¢   é«å¹¶åæå¡   ä¼ä¸åºç¨</td>
</tr>
</tbody>
</table>
<h3 id="åä¾æ¨¡å¼å®ç°">åä¾æ¨¡å¼å®ç°</h3>
<p>éåå¼åè°è¯åå¤è½®å¯¹è¯åºæ¯ï¼</p>
<pre><code class="language-python">class SandboxManager:
    """åä¾æ¨¡å¼ Sandbox ç®¡çå¨"""
    _instance = None
    _sandbox = None
    
    def __new__(cls):
        if cls._instance is None:
            cls._instance = super().__new__(cls)
        return cls._instance
    
    def get_or_create(self):
        """è·åæåå»º Sandbox"""
        if self._sandbox is None:
            self._sandbox = Sandbox.create(
                template_type=TemplateType.BROWSER,
                template_name=os.getenv("BROWSER_TEMPLATE_NAME"),
                sandbox_idle_timeout_seconds=3000
            )
        return self._sandbox
    
    def destroy(self):
        """éæ¯ Sandbox"""
        if self._sandbox:
            self._sandbox.delete()
            self._sandbox = None

# ä½¿ç¨
manager = SandboxManager()
sandbox = manager.get_or_create()  # é¦æ¬¡åå»º
sandbox = manager.get_or_create()  # å¤ç¨ç°æå®ä¾
</code></pre>
<h3 id="è¿æ¥æ± æ¨¡å¼å®ç°">è¿æ¥æ± æ¨¡å¼å®ç°</h3>
<p>éåé«å¹¶åçäº§ç¯å¢ï¼</p>
<pre><code class="language-python">from queue import Queue
from threading import Lock

class SandboxPool:
    """Sandbox è¿æ¥æ± """
    
    def __init__(self, pool_size=5, max_idle_time=300):
        self.pool_size = pool_size
        self.max_idle_time = max_idle_time
        self.pool = Queue(maxsize=pool_size)
        self.lock = Lock()
        self._initialize_pool()
    
    def _initialize_pool(self):
        """åå§åè¿æ¥æ± """
        for _ in range(self.pool_size):
            sandbox = self._create_sandbox()
            self.pool.put(sandbox)
    
    def _create_sandbox(self):
        """åå»º Sandbox å®ä¾"""
        return Sandbox.create(
            template_type=TemplateType.BROWSER,
            template_name=os.getenv("BROWSER_TEMPLATE_NAME"),
            sandbox_idle_timeout_seconds=self.max_idle_time
        )
    
    def acquire(self, timeout=30):
        """è·å Sandbox å®ä¾"""
        try:
            sandbox = self.pool.get(timeout=timeout)
            if not self._is_alive(sandbox):
                sandbox = self._create_sandbox()
            return sandbox
        except:
            raise RuntimeError("è·å Sandbox è¶æ¶")
    
    def release(self, sandbox):
        """å½è¿ Sandbox å®ä¾"""
        if self._is_alive(sandbox):
            self.pool.put(sandbox)
        else:
            new_sandbox = self._create_sandbox()
            self.pool.put(new_sandbox)
    
    def _is_alive(self, sandbox):
        """æ£æ¥ Sandbox æ¯å¦å­æ´»"""
        try:
            return hasattr(sandbox, 'sandbox_id')
        except:
            return False

# ä½¿ç¨
pool = SandboxPool(pool_size=5)

sandbox = pool.acquire()
try:
    # ä½¿ç¨ sandbox æ§è¡ä»»å¡
    pass
finally:
    pool.release(sandbox)
</code></pre>
<h3 id="ä¼è¯ç¶æç®¡ç">ä¼è¯ç¶æç®¡ç</h3>
<p>æ¯æå¤ç¨æ·å¤ä¼è¯åºæ¯ï¼</p>
<pre><code class="language-python">import time

class SessionManager:
    """ä¼è¯ç¶æç®¡ç"""
    
    def __init__(self):
        self.sessions = {}  # session_id -&gt; sandbox
    
    def create_session(self, session_id: str):
        """åå»ºä¼è¯"""
        if session_id not in self.sessions:
            sandbox = Sandbox.create(
                template_type=TemplateType.BROWSER,
                template_name=os.getenv("BROWSER_TEMPLATE_NAME"),
                sandbox_idle_timeout_seconds=1800
            )
            self.sessions[session_id] = {
                'sandbox': sandbox,
                'created_at': time.time(),
                'last_used': time.time()
            }
        return self.sessions[session_id]['sandbox']
    
    def get_session(self, session_id: str):
        """è·åä¼è¯"""
        if session_id in self.sessions:
            session = self.sessions[session_id]
            session['last_used'] = time.time()
            return session['sandbox']
        return None
    
    def cleanup_expired_sessions(self, max_idle_time=1800):
        """æ¸çè¿æä¼è¯"""
        current_time = time.time()
        expired_sessions = []
        
        for session_id, session in self.sessions.items():
            if current_time - session['last_used'] &gt; max_idle_time:
                expired_sessions.append(session_id)
        
        for session_id in expired_sessions:
            self.destroy_session(session_id)
    
    def destroy_session(self, session_id: str):
        """éæ¯ä¼è¯"""
        if session_id in self.sessions:
            self.sessions[session_id]['sandbox'].delete()
            del self.sessions[session_id]
</code></pre>
<h2 id="æ§è½ä¼å">æ§è½ä¼å</h2>
<h3 id="è¶æ¶æ¶é´éç½®">è¶æ¶æ¶é´éç½®</h3>
<p>åçè®¾ç½®è¶æ¶æ¶é´æ¯å¹³è¡¡æ§è½åææ¬çå³é®ï¼</p>
<pre><code class="language-python"># å¼åç¯å¢ï¼è°è¯ç¨ï¼
sandbox = Sandbox.create(
    template_name="dev-template",
    sandbox_idle_timeout_seconds=7200  # 2 å°æ¶
)

# çäº§ç¯å¢ï¼åæ¬¡ä»»å¡ï¼
sandbox = Sandbox.create(
    template_name="prod-template",
    sandbox_idle_timeout_seconds=300  # 5 åé
)

# é¿æ¶é´ä»»å¡
sandbox = Sandbox.create(
    template_name="long-task-template",
    sandbox_idle_timeout_seconds=10800  # 3 å°æ¶
)
</code></pre>
<p><strong>è¶æ¶ç­ç¥æ¨èï¼</strong></p>
<table>
<thead>
<tr>
<th>åºæ¯</th>
<th>æ¨èè¶æ¶</th>
<th>è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td>å¼åè°è¯</td>
<td>1-2 å°æ¶</td>
<td>æ¹ä¾¿è°è¯,é¿åé¢ç¹éå»º</td>
</tr>
<tr>
<td>ç®åä»»å¡</td>
<td>5-10 åé</td>
<td>åé¡µæä½,å¿«éå®æ</td>
</tr>
<tr>
<td>å¤æä»»å¡</td>
<td>30-60 åé</td>
<td>å¤æ­¥éª¤æµç¨,éè¦æ¶é´</td>
</tr>
<tr>
<td>åå°æå¡</td>
<td>2-4 å°æ¶</td>
<td>é¿æè¿è¡,å®æå·æ°</td>
</tr>
</tbody>
</table>
<h3 id="sandbox-å¤ç¨ç­ç¥">Sandbox å¤ç¨ç­ç¥</h3>
<pre><code class="language-python">class SmartSandboxManager:
    """æºè½ Sandbox å¤ç¨ç®¡çå¨"""
    
    def __init__(self):
        self.sandboxes = {}  # key -&gt; sandbox
        self.usage_count = {}  # key -&gt; count
    
    def get_sandbox(self, user_id: str, session_id: str):
        """è·åæåå»º Sandboxï¼æ¯æå¤ç¨ï¼"""
        key = f"{user_id}:{session_id}"
        
        if key not in self.sandboxes:
            self.sandboxes[key] = Sandbox.create(
                template_type=TemplateType.BROWSER,
                template_name=os.getenv("BROWSER_TEMPLATE_NAME"),
                sandbox_idle_timeout_seconds=1800
            )
            self.usage_count[key] = 0
        
        self.usage_count[key] += 1
        return self.sandboxes[key]
    
    def should_recreate(self, key: str, max_reuse=50):
        """å¤æ­æ¯å¦éè¦éå»ºï¼é²æ­¢ç¶æç´¯ç§¯ï¼"""
        return self.usage_count.get(key, 0) &gt;= max_reuse
    
    def recreate_if_needed(self, key: str):
        """æééå»º Sandbox"""
        if self.should_recreate(key):
            if key in self.sandboxes:
                self.sandboxes[key].delete()
                del self.sandboxes[key]
                self.usage_count[key] = 0
</code></pre>
<h3 id="éè¯¯å¤çåéè¯æºå¶">éè¯¯å¤çåéè¯æºå¶</h3>
<p>ä½¿ç¨ tenacity åºå®ç°æºè½éè¯ï¼</p>
<pre><code class="language-python">from tenacity import retry, stop_after_attempt, wait_exponential, retry_if_exception_type

class SandboxError(Exception):
    """Sandbox æä½å¼å¸¸"""
    pass

@retry(
    retry=retry_if_exception_type(SandboxError),
    stop=stop_after_attempt(3),
    wait=wait_exponential(multiplier=1, min=2, max=10)
)
def execute_with_retry(sandbox, operation):
    """å¸¦éè¯çæä½æ§è¡"""
    try:
        return operation(sandbox)
    except ConnectionError:
        raise SandboxError("è¿æ¥å¤±è´¥")
    except TimeoutError:
        raise SandboxError("æä½è¶æ¶")
    except Exception as e:
        print(f"æä½å¤±è´¥: {e}")
        raise SandboxError(f"æä½å¤±è´¥: {e}")

# ä½¿ç¨ç¤ºä¾
def navigate_page(sandbox):
    with sync_playwright() as p:
        browser = p.chromium.connect_over_cdp(sandbox.cdp_url)
        page = browser.contexts[0].pages[0]
        page.goto("https://example.com", timeout=30000)
        return page.title()

result = execute_with_retry(sandbox, navigate_page)
</code></pre>
<h2 id="å®å¨æ§æä½³å®è·µ">å®å¨æ§æä½³å®è·µ</h2>
<h3 id="ç¯å¢åéä¿æ¤">ç¯å¢åéä¿æ¤</h3>
<pre><code class="language-python">import os
from dotenv import load_dotenv

load_dotenv()

# éªè¯å¿éçç¯å¢åé
required_vars = ["DASHSCOPE_API_KEY", "AGENTRUN_ACCOUNT_ID"]
missing_vars = [var for var in required_vars if not os.getenv(var)]
if missing_vars:
    raise ValueError(f"ç¼ºå°å¿éçç¯å¢åé: {', '.join(missing_vars)}")

# ææä¿¡æ¯ä¸è¦ç¡¬ç¼ç 
API_KEY = os.getenv("DASHSCOPE_API_KEY")
ACCESS_KEY_ID = os.getenv("ALIBABA_CLOUD_ACCESS_KEY_ID")
ACCESS_KEY_SECRET = os.getenv("ALIBABA_CLOUD_ACCESS_KEY_SECRET")
</code></pre>
<h3 id="url-ç½åå">URL ç½åå</h3>
<pre><code class="language-python">ALLOWED_DOMAINS = [
    'example.com',
    'aliyun.com',
    'alibaba.com'
]

def is_url_allowed(url: str) -&gt; bool:
    """æ£æ¥ URL æ¯å¦å¨ç½ååä¸­"""
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    return any(allowed in domain for allowed in ALLOWED_DOMAINS)

def safe_navigate(page, url: str):
    """å®å¨å¯¼èª"""
    if not is_url_allowed(url):
        raise ValueError(f"URL ä¸å¨ç½ååä¸­: {url}")
    page.goto(url)
</code></pre>
<h3 id="æ¥å¿è±æ">æ¥å¿è±æ</h3>
<pre><code class="language-python">import re

def sanitize_log(log_text: str) -&gt; str:
    """æ¥å¿è±æ"""
    # è±æ API Key
    log_text = re.sub(r'sk-[a-zA-Z0-9]{20,}', 'sk-***', log_text)
    # è±æ Access Key
    log_text = re.sub(r'LTAI[a-zA-Z0-9]{12,}', 'LTAI***', log_text)
    # è±æå¯ç 
    log_text = re.sub(r'password["\s:=]+[^"\s,}]+', 'password: ***', log_text, flags=re.IGNORECASE)
    return log_text

# ä½¿ç¨
print(sanitize_log(f"ä½¿ç¨ API Key: {API_KEY}"))
</code></pre>
<h2 id="å¯è§æµæ§ä¸çæ§">å¯è§æµæ§ä¸çæ§</h2>
<h3 id="æ¥å¿è®°å½æä½³å®è·µ">æ¥å¿è®°å½æä½³å®è·µ</h3>
<pre><code class="language-python">import logging
from datetime import datetime

# éç½®æ¥å¿
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler(f'sandbox_{datetime.now().strftime("%Y%m%d")}.log'),
        logging.StreamHandler()
    ]
)

logger = logging.getLogger(__name__)

class MonitoredSandboxManager:
    """å¸¦çæ§ç Sandbox ç®¡çå¨"""
    
    def create_sandbox(self, **kwargs):
        """åå»º Sandboxï¼å¸¦æ¥å¿ï¼"""
        start_time = time.time()
        logger.info(f"å¼å§åå»º Sandbox: {kwargs}")
        
        try:
            sandbox = Sandbox.create(**kwargs)
            duration = time.time() - start_time
            logger.info(f"Sandbox åå»ºæå: {sandbox.sandbox_id}, èæ¶: {duration:.2f}s")
            return sandbox
        except Exception as e:
            duration = time.time() - start_time
            logger.error(f"Sandbox åå»ºå¤±è´¥: {e}, èæ¶: {duration:.2f}s")
            raise
    
    def execute_task(self, sandbox, task_name: str, operation):
        """æ§è¡ä»»å¡ï¼å¸¦æ¥å¿ï¼"""
        start_time = time.time()
        logger.info(f"å¼å§æ§è¡ä»»å¡: {task_name}, Sandbox: {sandbox.sandbox_id}")
        
        try:
            result = operation(sandbox)
            duration = time.time() - start_time
            logger.info(f"ä»»å¡æ§è¡æå: {task_name}, èæ¶: {duration:.2f}s")
            return result
        except Exception as e:
            duration = time.time() - start_time
            logger.error(f"ä»»å¡æ§è¡å¤±è´¥: {task_name}, éè¯¯: {e}, èæ¶: {duration:.2f}s")
            raise
</code></pre>
<h3 id="ææ æ¶é">ææ æ¶é</h3>
<pre><code class="language-python">from dataclasses import dataclass
from typing import Dict, List
import json

@dataclass
class SandboxMetrics:
    """Sandbox ææ """
    sandbox_id: str
    create_time: float
    destroy_time: float = None
    total_requests: int = 0
    failed_requests: int = 0
    total_duration: float = 0.0

class MetricsCollector:
    """ææ æ¶éå¨"""
    
    def __init__(self):
        self.metrics: Dict[str, SandboxMetrics] = {}
    
    def record_creation(self, sandbox_id: str):
        """è®°å½åå»º"""
        self.metrics[sandbox_id] = SandboxMetrics(
            sandbox_id=sandbox_id,
            create_time=time.time()
        )
    
    def record_request(self, sandbox_id: str, duration: float, success: bool):
        """è®°å½è¯·æ±"""
        if sandbox_id in self.metrics:
            metric = self.metrics[sandbox_id]
            metric.total_requests += 1
            metric.total_duration += duration
            if not success:
                metric.failed_requests += 1
    
    def record_destruction(self, sandbox_id: str):
        """è®°å½éæ¯"""
        if sandbox_id in self.metrics:
            self.metrics[sandbox_id].destroy_time = time.time()
    
    def export_metrics(self, filepath: str):
        """å¯¼åºææ """
        metrics_data = [
            {
                'sandbox_id': m.sandbox_id,
                'create_time': m.create_time,
                'destroy_time': m.destroy_time,
                'total_requests': m.total_requests,
                'failed_requests': m.failed_requests,
                'success_rate': (m.total_requests - m.failed_requests) / m.total_requests if m.total_requests &gt; 0 else 0,
                'avg_duration': m.total_duration / m.total_requests if m.total_requests &gt; 0 else 0,
                'lifetime': m.destroy_time - m.create_time if m.destroy_time else time.time() - m.create_time
            }
            for m in self.metrics.values()
        ]
        
        with open(filepath, 'w') as f:
            json.dump(metrics_data, f, indent=2)

# ä½¿ç¨
collector = MetricsCollector()
collector.record_creation(sandbox.sandbox_id)
# ... æ§è¡ä»»å¡ ...
collector.export_metrics('metrics.json')
</code></pre>
<h2 id="ææ¬ä¼å">ææ¬ä¼å</h2>
<h3 id="æéåå»ºä¸éæ¯">æéåå»ºä¸éæ¯</h3>
<pre><code class="language-python">class CostOptimizedManager:
    """ææ¬ä¼åçç®¡çå¨"""
    
    def __init__(self, idle_threshold=300):
        self.idle_threshold = idle_threshold
        self.sandboxes = {}
        self.last_used = {}
    
    def get_sandbox(self, key: str):
        """è·å Sandboxï¼æå è½½ï¼"""
        if key not in self.sandboxes:
            self.sandboxes[key] = Sandbox.create(
                template_type=TemplateType.BROWSER,
                template_name=os.getenv("BROWSER_TEMPLATE_NAME"),
                sandbox_idle_timeout_seconds=self.idle_threshold
            )
        
        self.last_used[key] = time.time()
        return self.sandboxes[key]
    
    def cleanup_idle(self):
        """æ¸çé²ç½® Sandbox"""
        current_time = time.time()
        to_remove = []
        
        for key, last_time in self.last_used.items():
            if current_time - last_time &gt; self.idle_threshold:
                to_remove.append(key)
        
        for key in to_remove:
            if key in self.sandboxes:
                self.sandboxes[key].delete()
                del self.sandboxes[key]
                del self.last_used[key]
                logger.info(f"æ¸çé²ç½® Sandbox: {key}")
</code></pre>
<h3 id="æ¹éä»»å¡å¤ç">æ¹éä»»å¡å¤ç</h3>
<pre><code class="language-python">async def batch_process_tasks(tasks: List[str], pool_size: int = 5):
    """æ¹éå¤çä»»å¡ï¼å¤ç¨ Sandboxï¼"""
    pool = SandboxPool(pool_size=pool_size)
    results = []
    
    for task in tasks:
        sandbox = pool.acquire()
        try:
            # å¤çä»»å¡
            result = await process_task(sandbox, task)
            results.append(result)
        finally:
            pool.release(sandbox)
    
    return results
</code></pre>
<h2 id="çäº§ç¯å¢é¨ç½²">çäº§ç¯å¢é¨ç½²</h2>
<h3 id="ç¯å¢éç½®">ç¯å¢éç½®</h3>
<p><strong>å¼åç¯å¢ (.env.dev)</strong>ï¼</p>
<pre><code class="language-bash"># å¼åç¯å¢éç½®
BROWSER_TEMPLATE_NAME=dev-browser-template
SANDBOX_IDLE_TIMEOUT=7200
POOL_SIZE=2
LOG_LEVEL=DEBUG
</code></pre>
<p><strong>çäº§ç¯å¢ (.env.prod)</strong>ï¼</p>
<pre><code class="language-bash"># çäº§ç¯å¢éç½®
BROWSER_TEMPLATE_NAME=prod-browser-template
SANDBOX_IDLE_TIMEOUT=300
POOL_SIZE=10
LOG_LEVEL=INFO
ENABLE_METRICS=true
METRICS_EXPORT_INTERVAL=300
</code></pre>
<h3 id="é«å¯ç¨æ¶æ">é«å¯ç¨æ¶æ</h3>
<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2123714/202601/2123714-20260120161152830-801036086.png" class="lazyload"></p>
<h3 id="å¥åº·æ£æ¥">å¥åº·æ£æ¥</h3>
<pre><code class="language-python">from flask import Flask, jsonify

app = Flask(__name__)
manager = SandboxManager()

@app.route('/health')
def health_check():
    """å¥åº·æ£æ¥ç«¯ç¹"""
    try:
        # æ£æ¥ Sandbox æ¯å¦å¯ç¨
        sandbox = manager.get_or_create()
        
        # ç®åçå¥åº·æ£æ¥
        is_healthy = hasattr(sandbox, 'sandbox_id')
        
        if is_healthy:
            return jsonify({
                'status': 'healthy',
                'sandbox_id': sandbox.sandbox_id,
                'timestamp': time.time()
            }), 200
        else:
            return jsonify({
                'status': 'unhealthy',
                'error': 'Sandbox not available'
            }), 503
    except Exception as e:
        return jsonify({
            'status': 'unhealthy',
            'error': str(e)
        }), 503

@app.route('/metrics')
def metrics():
    """ææ ç«¯ç¹"""
    collector = MetricsCollector()
    # è¿åå½åææ 
    return jsonify({
        'total_sandboxes': len(collector.metrics),
        'timestamp': time.time()
    })
</code></pre>
<h2 id="æéææ¥ä¸å¸¸è§é®é¢">æéææ¥ä¸å¸¸è§é®é¢</h2>
<h3 id="è¿æ¥é®é¢">è¿æ¥é®é¢</h3>
<p><strong>é®é¢</strong>ï¼æ æ³è¿æ¥å° Sandbox</p>
<p><strong>ææ¥æ­¥éª¤</strong>ï¼</p>
<pre><code class="language-python">def diagnose_connection(sandbox):
    """è¯æ­è¿æ¥é®é¢"""
    print(f"1. æ£æ¥ Sandbox ID: {sandbox.sandbox_id}")
    print(f"2. æ£æ¥ CDP URL: {sandbox.cdp_url}")
    
    # æµè¯ CDP è¿æ¥
    try:
        with sync_playwright() as p:
            browser = p.chromium.connect_over_cdp(sandbox.cdp_url)
            print("â CDP è¿æ¥æå")
            browser.close()
    except Exception as e:
        print(f"â CDP è¿æ¥å¤±è´¥: {e}")
    
    # æµè¯ VNC è¿æ¥
    print(f"3. VNC URL: {sandbox.vnc_url}")
    print("æç¤º: å¯ä»¥å¨æµè§å¨ä¸­æå¼ VNC URL æµè¯è¿æ¥")
</code></pre>
<h3 id="è¶æ¶é®é¢">è¶æ¶é®é¢</h3>
<p><strong>é®é¢</strong>ï¼ä»»å¡æ§è¡è¶æ¶</p>
<p><strong>è§£å³æ¹æ¡</strong>ï¼</p>
<pre><code class="language-python">def handle_timeout(sandbox, operation, max_retries=3):
    """å¤çè¶æ¶ï¼å¸¦éè¯ï¼"""
    for attempt in range(max_retries):
        try:
            return operation(sandbox, timeout=30000)
        except TimeoutError:
            logger.warning(f"ä»»å¡è¶æ¶ï¼å°è¯ {attempt + 1}/{max_retries}ï¼")
            if attempt == max_retries - 1:
                # æåä¸æ¬¡å°è¯å¤±è´¥ï¼éå»º Sandbox
                logger.error("å¤æ¬¡è¶æ¶ï¼éå»º Sandbox")
                sandbox.delete()
                sandbox = Sandbox.create(
                    template_type=TemplateType.BROWSER,
                    template_name=os.getenv("BROWSER_TEMPLATE_NAME")
                )
                return operation(sandbox, timeout=60000)
</code></pre>
<h3 id="æ§è½é®é¢">æ§è½é®é¢</h3>
<p><strong>é®é¢</strong>ï¼ååºéåº¦æ¢</p>
<p><strong>ä¼åå»ºè®®</strong>ï¼</p>
<ol>
<li><strong>ä½¿ç¨è¿æ¥æ± </strong>ï¼é¢ååå»ºå¤ä¸ª Sandbox å®ä¾</li>
<li><strong>å¯ç¨ keep_alive</strong>ï¼ä¿ææµè§å¨ä¼è¯ï¼é¿åéå¤å»ºç«è¿æ¥</li>
<li><strong>åçè®¾ç½®è¶æ¶</strong>ï¼æ ¹æ®ä»»å¡å¤æåº¦è°æ´è¶æ¶æ¶é´</li>
<li><strong>å¹¶åæ§å¶</strong>ï¼éå¶å¹¶åè¯·æ±æ°ï¼é¿åèµæºç«äº</li>
</ol>
<pre><code class="language-python"># æ§è½ä¼åéç½®ç¤ºä¾
browser_session = BrowserSession(
    cdp_url=sandbox.cdp_url,
    browser_profile=BrowserProfile(
        timeout=30000,          # 30ç§è¶æ¶
        keep_alive=True,        # ä¿æè¿æ¥
        disable_security=False  # ä¿æå®å¨æ£æ¥
    )
)
</code></pre>
<h3 id="éè¯¯ç åè">éè¯¯ç åè</h3>
<table>
<thead>
<tr>
<th>éè¯¯ç </th>
<th>è¯´æ</th>
<th>è§£å³æ¹æ¡</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ConnectionError</code></td>
<td>è¿æ¥å¤±è´¥</td>
<td>æ£æ¥ç½ç»è¿æ¥ï¼éªè¯ CDP URL</td>
</tr>
<tr>
<td><code>TimeoutError</code></td>
<td>æä½è¶æ¶</td>
<td>å¢å è¶æ¶æ¶é´ï¼æ£æ¥ä»»å¡å¤æåº¦</td>
</tr>
<tr>
<td><code>AuthenticationError</code></td>
<td>è®¤è¯å¤±è´¥</td>
<td>éªè¯ API Key åè®¿é®å¯é¥</td>
</tr>
<tr>
<td><code>ResourceExhausted</code></td>
<td>èµæºä¸è¶³</td>
<td>åå°å¹¶åæ°ï¼å¢å èµæºéé¢</td>
</tr>
<tr>
<td><code>InvalidArgument</code></td>
<td>åæ°éè¯¯</td>
<td>æ£æ¥åæ°æ ¼å¼åæææ§</td>
</tr>
</tbody>
</table>
<h2 id="æ»ç»">æ»ç»</h2>
<p>éè¿æ¬æåï¼æ¨å·²ç»ææ¡äºï¼</p>
<ol>
<li><strong>BrowserUse éæ</strong>ï¼å¦ä½ä½¿ç¨ BrowserUse æ¡æ¶å®ç°æºè½æµè§å¨èªå¨å</li>
<li><strong>çå½å¨æç®¡ç</strong>ï¼ä¸ç§ Sandbox ç®¡çæ¨¡å¼çéæ©åå®ç°</li>
<li><strong>æ§è½ä¼å</strong>ï¼è¶æ¶éç½®ãå¤ç¨ç­ç¥ãéè¯¯éè¯æºå¶</li>
<li><strong>å®å¨å®è·µ</strong>ï¼ç¯å¢åéä¿æ¤ãURL ç½ååãæ¥å¿è±æ</li>
<li><strong>å¯è§æµæ§</strong>ï¼æ¥å¿è®°å½ãææ æ¶éãçæ§åè­¦</li>
<li><strong>ææ¬ä¼å</strong>ï¼æéåå»ºãé²ç½®æ¸çãæ¹éå¤ç</li>
<li><strong>çäº§é¨ç½²</strong>ï¼é«å¯ç¨æ¶æãå¥åº·æ£æ¥ãæéææ¥</li>
</ol>
<h2 id="ç«å³ä½éªå½æ°è®¡ç®-agentrun">ç«å³ä½éªå½æ°è®¡ç® AgentRun</h2>
<p>å½æ°è®¡ç® AgentRun çæ ä»£ç å°é«ä»£ç æ¼è¿è½åï¼ç°å·²å¼æ¾ä½éªï¼</p>
<ol>
<li><strong>å¿«éåå»º</strong>ï¼è®¿é®æ§å¶å°ï¼<a href="https://functionai.console.aliyun.com/cn-hangzhou/agent/explore" target="_blank" rel="noopener nofollow">https://functionai.console.aliyun.com/cn-hangzhou/agent/explore</a>ï¼ï¼60ç§åå»ºä½ çç¬¬ä¸ä¸ª Agent</li>
<li><strong>æ·±åº¦å®å¶</strong>ï¼å½éè¦æ´å¤æåè½æ¶ï¼ä¸é®è½¬æ¢ä¸ºé«ä»£ç </li>
<li><strong>æç»­æ¼è¿</strong>ï¼å©ç¨å½æ°è®¡ç® AgentRun çåºç¡è®¾æ½è½åï¼æç»­ä¼åä½ ç Agent</li>
</ol>
<p>ä»æ³æ³å°ä¸çº¿ï¼ä»ååå°çäº§ï¼å½æ°è®¡ç® AgentRun å§ç»æ¯ä½ æå¥½çä¼ä¼´ã<strong>æ¬¢è¿å å¥âå½æ°è®¡ç® AgentRun å®¢æ·ç¾¤âï¼ééç¾¤å·ï¼<em>134570017218</em>ã</strong></p>
<h2 id="å¿«éäºè§£å½æ°è®¡ç®-agentrun">å¿«éäºè§£å½æ°è®¡ç® AgentRun</h2>
<p><strong>ä¸å¥è¯ä»ç»ï¼</strong><a href="https://www.aliyun.com/product/fc/agentrun" target="_blank" rel="noopener nofollow">å½æ°è®¡ç® AgentRun</a> æ¯ä¸ä¸ªä»¥é«ä»£ç ä¸ºæ ¸å¿çä¸ç«å¼ Agentic AI åºç¡è®¾æ½å¹³å°ãç§æçæå¼æ¾åçµæ´»ç»è£ççå¿µï¼ä¸ºä¼ä¸çº§ Agent åºç¨æä¾ä»å¼åãé¨ç½²å°è¿ç»´çå¨çå½å¨æç®¡çã</p>

<p><img alt="" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2123714/202601/2123714-20260120161152854-681277385.png" class="lazyload"></p>
<p>å½æ°è®¡ç® AgentRun æ¶æå¾</p>
<p>AgentRun è¿è¡æ¶åºäºé¿éäºå½æ°è®¡ç® FC æå»ºï¼ç»§æ¿äº Serverless è®¡ç®æè´å¼¹æ§ãæéä»è´¹ãé¶è¿ç»´çæ ¸å¿ä¼å¿ãéè¿æ·±åº¦éæ AgentScopeãLangChainãRAGFlowãMem0 ç­ä¸»æµå¼æºçæãå½æ°è®¡ç® AgentRun å° Serverless çæè´å¼¹æ§ãé¶è¿ç»´åæéä»è´¹çç¹æ§ä¸ AI åçåºç¨åºæ¯æ·±åº¦èåï¼å©åä¼ä¸å®ç°ææ¬ä¸æççæè´ä¼åï¼<strong>å¹³å TCO éä½ 60%</strong>ã</p>
<p><strong>è®©å¼åèåªéä¸æ³¨äº Agent çä¸å¡é»è¾åæ°ï¼æ éå³å¿åºå±åºç¡è®¾æ½ï¼è®© Agentic AI çæ­£è¿å¥ä¼ä¸çäº§ç¯å¢ã</strong></p>
<p><strong>æ¨èéè¯»ï¼</strong></p>
<ul>
<li>éè¯»<a href="https://yuque.alibaba-inc.com/agentrun/dxnn5p/rcpbigg7gthpa2u4" target="_blank" rel="noopener nofollow">ãå¿«éä¸æï¼LangChain + AgentRun æµè§å¨æ²ç®±æç®éææåã</a>å¤ä¹ åºç¡éæå LangChain éæ</li>
<li>æ¥ç<a href="https://docs.agent.run" target="_blank" rel="noopener nofollow">å®æ¹ææ¡£</a>äºè§£æ´å¤ AgentRun åè½</li>
<li>è®¿é®<a href="https://github.com/devsapp/agentrun-sandbox-demos" target="_blank" rel="noopener nofollow">ç¤ºä¾ä»£ç ä»åº</a> è·ååèä»£ç </li>
</ul>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-20 16:12">2026-01-20 16:12</span>&nbsp;
<a href="https://www.cnblogs.com/Serverless">Serverlessç¤¾åº</a>&nbsp;
éè¯»(<span id="post_view_count">75</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19507367);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19507367', targetLink: 'https://www.cnblogs.com/Serverless/p/19507367', title: 'è¿é¶æåï¼BrowserUse + Agentrun Sandbox æä½³å®è·µæå' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ åºäºspringbootç³»ç»ï¼å¦ä½è·è¸ªä¼è¯è¿æï¼æµè§å¨ä¼è¯æ è¯æ¯å¦æ¶å°æ­£å¸¸ååºï¼å­å¨ï¼å¹¶å¨åç»­è¯·æ±ä¿ææºå¸¦ ]]></title>
    <link>https://www.cnblogs.com/liuyangjava/p/19507022</link>
    <guid>7f8c91d0c36076fedcd26591f3cdf142</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/liuyangjava/p/19507022" title="åå¸äº 2026-01-20 15:22">
    <span role="heading" aria-level="2">åºäºspringbootç³»ç»ï¼å¦ä½è·è¸ªä¼è¯è¿æï¼æµè§å¨ä¼è¯æ è¯æ¯å¦æ¶å°æ­£å¸¸ååºï¼å­å¨ï¼å¹¶å¨åç»­è¯·æ±ä¿ææºå¸¦</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>ä»å¤©æä»¬åäº«ä¸ä¸ªé¡¹ç®å¼åä¸­çåºç°æä½æä¸ªä¸å¡æ¶åï¼<span style="color: rgba(224, 62, 45, 1); font-size: 18px"><strong>åºç°éªé</strong></span>çç»å¸é®é¢ï¼éå¯¹èæ§çSpring MVCç³»ç»ï¼è¦ç³»ç»æ§å°è·è¸ªä¼è¯ï¼Sessionï¼çå½å¨æåCookieçæºå¸¦æåµï¼æä»¬éè¦ä¸å¥æ¸æ°çãä»æµè§å¨å°æå¡å¨çææ¥æ¹æ¡ãä»¥ä¸æ¯è¯¦ç»çè·è¸ªæ­¥éª¤åæ¹æ³ã</p>
<p>å½ç¶è¿ä¸ªææ¥æ­¥éª¤åæ¹æ³ï¼ä¹éååºæ¬SpringBootå¼åçç³»ç»ï¼ä½æ¯æå¡ç«¯çææ¥éè¦å¤§å®¶æ ¹æ®å®éæåµä¿®æ¹åç«¯ææ¥æ¥å¿ãæ¦æªå¨ç­æ¹æ³</p>
<h3>æ´ä½ææ¥æè·¯</h3>
<p>æä»¬çç®æ æ¯éªè¯ä»¥ä¸ä¸ä¸ªç¯èæ¯å¦æ­£å¸¸ï¼</p>
<ol class="ybc-ol-component ybc-ol-component_1">
<li class="ybc-li-component ybc-li-component_ol">
<p><strong>ç»å½æåæ¶</strong>ï¼æå¡å¨æ¯å¦æ­£ç¡®çæäºSessionå¹¶è¿åäºåå«æ­£ç¡® <code class="hyc-common-markdown__code__inline">JSESSIONID</code>çCookieç»æµè§å¨ã</p>
</li>
<li class="ybc-li-component ybc-li-component_ol">
<p><strong>æµè§å¨ç«¯</strong>ï¼æµè§å¨æ¯å¦æåæ¥æ¶å¹¶å­å¨äºè¯¥Cookieã</p>
</li>
<li class="ybc-li-component ybc-li-component_ol">
<p><strong>åç»­è¯·æ±</strong>ï¼æµè§å¨å¨æ§è¡æ¥è¯¢ç­æä½æ¶ï¼æ¯å¦å§ç»å¨è¯·æ±å¤´ä¸­æºå¸¦äºè¿ä¸ªCookieã</p>
</li>
</ol>
<h3>ç¬¬ä¸æ­¥ï¼æµè§å¨ç«¯è·è¸ªï¼å®¢æ·ç«¯éªè¯ï¼</h3>
<p>è¿æ¯æç´æ¥ãæå®¹ææä½çç¬¬ä¸æ­¥ï¼å¯ä»¥ç±å¼åæè¿ç»´äººåå¨é®é¢çµèä¸è¿è¡ã</p>
<p>ä¸ãè·è¸ªä¼è¯æ è¯ï¼Cookieï¼çæ¥æ¶ä¸å­å¨</p>
<ol class="ybc-ol-component ybc-ol-component_1">
<li class="ybc-li-component ybc-li-component_ol">
<p><strong>å¼å¯æµè§å¨å¼åèå·¥å·</strong>ï¼ä½¿ç¨åºç°é®é¢çæµè§å¨ï¼å¦å¥å®ä¿¡ãChromeï¼ï¼æ <code class="hyc-common-markdown__code__inline">F12</code>æå¼å¼åèå·¥å·ã</p>
</li>
<li class="ybc-li-component ybc-li-component_ol">
<p><strong>åæ¢å°Network/ç½ç»é¢æ¿</strong>ï¼å¾é <strong><code class="hyc-common-markdown__code__inline">Preserve log</code>(ä¿çæ¥å¿)</strong>â å¤éæ¡ï¼é²æ­¢é¡µé¢è·³è½¬æ¶æ¥å¿è¢«æ¸ç©ºã</p>
</li>
<li class="ybc-li-component ybc-li-component_ol">
<p><strong>æ¸ç©ºCookieï¼å¯éï¼ä¸ºäºçº¯åçæµè¯ï¼</strong>ï¼å¨å¼åèå·¥å·ç <code class="hyc-common-markdown__code__inline">Application</code>ï¼åºç¨ï¼æ <code class="hyc-common-markdown__code__inline">Storage</code>ï¼å­å¨ï¼æ ç­¾é¡µä¸ï¼æ¾å° <code class="hyc-common-markdown__code__inline">Cookies</code>ï¼éä¸­å½åç³»ç»å°åçCookieï¼å°å¶å é¤ãè¿å¯ä»¥æ¨¡æä¸æ¬¡å¨æ°çç»å½ã</p>
</li>
<li class="ybc-li-component ybc-li-component_ol">
<p><strong>æ§è¡ç»å½</strong>ï¼</p>
<ul class="ybc-ul-component">
<li class="ybc-li-component ybc-li-component_ul">
<p>å¨å°åæ è¾å¥ç³»ç»åèç¹å°åï¼å¦ <code class="hyc-common-markdown__code__inline">http://10.15.9.106/...</code>ï¼è¿è¡ç»å½ã</p>
</li>
<li class="ybc-li-component ybc-li-component_ul">
<p>å¨Networké¢æ¿ä¸­ï¼æ¾å°ç»å½è¯·æ±ï¼éå¸¸æ¯ <code class="hyc-common-markdown__code__inline">login</code>æ <code class="hyc-common-markdown__code__inline">j_spring_security_check</code>ä¹ç±»çPOSTè¯·æ±ï¼ã</p>
</li>
<li class="ybc-li-component ybc-li-component_ul">
<p><strong>éç¹æ¥çç»å½è¯·æ±çååº</strong>ï¼</p>
<ul class="ybc-ul-component">
<li class="ybc-li-component ybc-li-component_ul">
<p>ç¹å»è¿ä¸ªç»å½è¯·æ±ï¼æ¥ç <code class="hyc-common-markdown__code__inline">Response Headers</code>ï¼ååºå¤´ï¼ã</p>
</li>
<li class="ybc-li-component ybc-li-component_ul">
<p>ä½ åºè¯¥è½çå°ä¸ä¸ª <code class="hyc-common-markdown__code__inline">Set-Cookie</code>å¤´ï¼åå®¹ç±»ä¼¼äº <code class="hyc-common-markdown__code__inline">JSESSIONID=ABCD1234...; Path=/; HttpOnly</code>ã</p>
</li>
<li class="ybc-li-component ybc-li-component_ul">
<p><strong>è®°å½ä¸è¿ä¸ª <code class="hyc-common-markdown__code__inline">JSESSIONID</code>çå¼</strong>ã</p>
</li>
</ul>
</li>
</ul>
</li>
<li class="ybc-li-component ybc-li-component_ol">
<p><strong>éªè¯Cookieå­å¨</strong>ï¼</p>
<ul class="ybc-ul-component">
<li class="ybc-li-component ybc-li-component_ul">
<p>åæ¢å° <code class="hyc-common-markdown__code__inline">Application/åºç¨</code>æ ç­¾é¡µã</p>
</li>
<li class="ybc-li-component ybc-li-component_ul">
<p>å¨å·¦ä¾§æ¾å° <code class="hyc-common-markdown__code__inline">Cookies</code>-&gt; <code class="hyc-common-markdown__code__inline">http://10.15.9.106</code>ã</p>
</li>
<li class="ybc-li-component ybc-li-component_ul">
<p>æ£æ¥æ¯å¦å­å¨ä¸ä¸ªåä¸º <code class="hyc-common-markdown__code__inline">JSESSIONID</code>çCookieï¼å¶å¼æ¯å¦ä¸åæå¨ååºå¤´ä¸­çå°çä¸è´ã</p>
</li>
</ul>
</li>
</ol>
<p><strong>è³æ­¤ï¼æä»¬éªè¯äºç¯è1å2ã<span style="color: rgba(224, 62, 45, 1)">å¦æè¿éå°±åºé®é¢ï¼é£ä¹æ ¹æºå¨æå¡å¨ååºææµè§å¨å®å¨ç­ç¥ä¸</span>ã</strong></p>
<p>äºãè·è¸ªåç»­è¯·æ±çCookieæºå¸¦æåµ</p>
<ol class="ybc-ol-component ybc-ol-component_1">
<li class="ybc-li-component ybc-li-component_ol">
<p><strong>è¿è¡æ­£å¸¸æä½</strong>ï¼ç»å½æååï¼å¨ç³»ç»åè¿è¡ä¸äºä¸ä¼è§¦åéªéçç®åæä½ï¼æ¯å¦ç¹å»èåã</p>
</li>
<li class="ybc-li-component ybc-li-component_ol">
<p><strong>è§å¯è¯·æ±</strong>ï¼å¨Networké¢æ¿ä¸­ï¼è§å¯è¿äºæä½è§¦åçAjaxæé¡µé¢è¯·æ±ã</p>
</li>
<li class="ybc-li-component ybc-li-component_ol">
<p><strong>æ£æ¥è¯·æ±å¤´</strong>ï¼éæºç¹å»å ä¸ªåç»­è¯·æ±ï¼æ¥çå®ä»¬ç <code class="hyc-common-markdown__code__inline">Request Headers</code>ï¼è¯·æ±å¤´ï¼ã</p>
<ul class="ybc-ul-component">
<li class="ybc-li-component ybc-li-component_ul">
<p>å¿é¡»æ¾å°ä¸ä¸ª <code class="hyc-common-markdown__code__inline">Cookie:</code>å¤´ï¼å¶åå®¹åºåå« <code class="hyc-common-markdown__code__inline">JSESSIONID=ABCD1234...</code>ï¼å³ç»å½æ¶è®¾ç½®çé£ä¸ªå¼ï¼ã</p>
</li>
<li class="ybc-li-component ybc-li-component_ul">
<p><strong>ç¡®ä¿æ¯ä¸ªè¯·æ±é½æºå¸¦äºè¿ä¸ªCookie</strong>ã</p>
</li>
</ul>
</li>
<li class="ybc-li-component ybc-li-component_ol">
<p><strong>è§¦åéªéï¼å³é®æ­¥éª¤ï¼</strong>ï¼</p>
<ul class="ybc-ul-component">
<li class="ybc-li-component ybc-li-component_ul">
<p>è¿è¡é£ä¸ª<strong>å·²ç¥ä¼å¼åéªéçæ¥è¯¢æä½</strong>ã</p>
</li>
<li class="ybc-li-component ybc-li-component_ul">
<p><strong>å¯åè§å¯Networké¢æ¿</strong>ï¼å¨ç¹å»âæ¥è¯¢âæé®åï¼ç¬é´ååºçè¯·æ±ã</p>
</li>
<li class="ybc-li-component ybc-li-component_ul">
<p><strong>éç¹æ£æ¥è§¦åéªéçé£ä¸ªç¹å®æ¥è¯¢è¯·æ±</strong>ï¼</p>
<ul class="ybc-ul-component">
<li class="ybc-li-component ybc-li-component_ul">
<p><strong>æåµAï¼æ­£å¸¸ï¼</strong>ï¼è¯¥è¯·æ±ç <code class="hyc-common-markdown__code__inline">Request Headers</code>éæ­£å¸¸æºå¸¦äº <code class="hyc-common-markdown__code__inline">JSESSIONID</code>ï¼ä½æå¡å¨è¿åäºä¸ä¸ª <code class="hyc-common-markdown__code__inline">302 Found</code>ç¶æç ï¼Locationæåç»å½é¡µï¼æèç´æ¥è¿åäºç»å½é¡µçHTMLï¼ç¶æç 200ï¼ã<strong>è¿è¯´æé®é¢åºå¨æå¡å¨ç«¯ï¼æå¡å¨ä¸»å¨åºå¼äºä¼è¯ã</strong></p>
</li>
<li class="ybc-li-component ybc-li-component_ul">
<p><strong>æåµBï¼å¼å¸¸ï¼</strong>ï¼è¯¥è¯·æ±ç <code class="hyc-common-markdown__code__inline">Request Headers</code>é<strong>æ²¡æ</strong>â <code class="hyc-common-markdown__code__inline">Cookie</code>å¤´ï¼æè <code class="hyc-common-markdown__code__inline">JSESSIONID</code>çå¼åæäºç©ºãéè¯¯æä¸ä¸ªæ°çå¼ã<strong>è¿è¯´æé®é¢åºå¨æµè§å¨ç«¯ï¼Cookieå¨åéåä¸¢å¤±äºã</strong></p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><span style="font-size: 16px"><strong>ç¬¬äºæ­¥ï¼æå¡å¨ç«¯è·è¸ªï¼ä»£ç ä¸æ¥å¿å±é¢ï¼</strong></span></p>
<p>å¦ææµè§å¨ç«¯è·è¸ªæåäºâæåµAâï¼Cookieæºå¸¦æ­£å¸¸ï¼ä½æå¡å¨è¿åç»å½é¡µï¼ï¼é£ä¹é®é¢æ ¹å å¨æå¡å¨åé¨ã</p>
<p>ä¸ãå¯ç¨è¯¦ç»æ¥å¿è®°å½ï¼æææçæ¹æ³ï¼</p>
<p>å¦æè¿ä¸ªèç³»ç»å¯è½æ¥å¿ä¸å¨ï¼æä»¬éè¦ä¸´æ¶å¢å ä¼è¯è·è¸ªæ¥å¿ã</p>
<p><strong>1.å¨<code class="hyc-common-markdown__code__inline">web.xml</code>ä¸­éç½®Sessionçå¬å¨</strong>ï¼</p>
<p>åå»ºä¸ä¸ªç±»ï¼å®ç° <code class="hyc-common-markdown__code__inline">HttpSessionListener</code>å <code class="hyc-common-markdown__code__inline">HttpSessionAttributeListener</code>æ¥å£ï¼å¹¶é¨ç½²å°çäº§ç¯å¢ãè¿ä¸ªç±»å¯ä»¥è®°å½Sessionçåå»ºãéæ¯åå±æ§ååã</p>
<pre class="language-java highlighter-hljs"><code>import javax.servlet.http.HttpSessionEvent;
import javax.servlet.http.HttpSessionAttributeListener;
import javax.servlet.http.HttpSessionBindingEvent;
import java.util.logging.Logger; // æä½¿ç¨Log4jãSlf4j

public class SessionDebugListener implements HttpSessionListener, HttpSessionAttributeListener {

    private static final Logger logger = Logger.getLogger(SessionDebugListener.class.getName());

    @Override
    public void sessionCreated(HttpSessionEvent se) {
        logger.info("ï¼ï¼ï¼ Sessionè¢«åå»º: ID=" + se.getSession().getId() + "ï¼ æ¶é´=" + new java.util.Date());
    }

    @Override
    public void sessionDestroyed(HttpSessionEvent se) {
        // è¿æ¯æå³é®çä¿¡æ¯ï¼ä¼è¯ä½æ¶ãä¸ºä½è¢«éæ¯ï¼
        logger.info("ï¼ï¼ï¼ Sessionè¢«éæ¯: ID=" + se.getSession().getId() + "ï¼ æ¶é´=" + new java.util.Date() + "ã æåè®¿é®æ¶é´: " + new java.util.Date(se.getSession().getLastAccessedTime()));
        // å¯ä»¥å¨è¿éæå°å æ ä¿¡æ¯ï¼çæ¯åªä¸ªçº¿ç¨è§¦åäºéæ¯
        Thread.dumpStack();
    }

    @Override
    public void attributeAdded(HttpSessionBindingEvent event) {
        if ("user".equals(event.getName())) { // çå¬ç¨æ·ç»å½å±æ§
            logger.info("ï¼ï¼ï¼ ç¨æ·ç»å½æåï¼Userå¯¹è±¡è¢«å­å¥Sessionã SessionID=" + event.getSession().getId() + ", User=" + event.getValue());
        }
    }

    @Override
    public void attributeRemoved(HttpSessionBindingEvent event) {
        if ("user".equals(event.getName())) { // çå¬ç¨æ·ç»åºå±æ§
            logger.info("ï¼ï¼ï¼ ç¨æ·ç»åºï¼Userå¯¹è±¡ä»Sessionç§»é¤ã SessionID=" + event.getSession().getId());
        }
    }
}</code></pre>
<p>å¨ <code class="hyc-common-markdown__code__inline">web.xml</code>ä¸­æ³¨åï¼</p>
<pre class="language-xml highlighter-hljs"><code>&lt;listener&gt;
    &lt;listener-class&gt;com.yourcompany.SessionDebugListener&lt;/listener-class&gt;
&lt;/listener&gt;</code></pre>
<p><strong>2.å¨è¿æ»¤å¨ä¸­è®°å½è¯·æ±</strong>ï¼</p>
<p>å¨ä¸ä¸ªå¨å±çFilterä¸­ï¼å¦æå·²æï¼åä¿®æ¹å®ï¼ï¼è®°å½æ¯ä¸ªè¯·æ±çSessionç¶æã</p>
<pre class="language-java highlighter-hljs"><code>public class SessionTrackingFilter implements Filter {
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        HttpServletRequest req = (HttpServletRequest) request;
        HttpServletResponse res = (HttpServletResponse) response;

        String sessionId = req.getRequestedSessionId();
        boolean sessionValid = req.isRequestedSessionIdValid();

        logger.info("è¯·æ±è¿å¥: URI=" + req.getRequestURI() + 
                   ", SessionID=" + sessionId + 
                   ", Sessionæ¯å¦ææ=" + sessionValid);

        chain.doFilter(request, response);

        // è¯·æ±å¤çåï¼åæ¬¡æ£æ¥Sessionç¶æ
        sessionValid = req.isRequestedSessionIdValid();
        logger.info("è¯·æ±ç¦»å¼: URI=" + req.getRequestURI() + 
                   ", Sessionæ¯å¦ææ=" + sessionValid);
    }
}</code></pre>
<p>é¨ç½²è¿äºçå¬å¨åè¿æ»¤å¨åï¼éç°éªéé®é¢ãç¶åç«å³æ¥çæå¡å¨æ¥å¿ï¼å¯»æ¾ <code class="hyc-common-markdown__code__inline">ï¼ï¼ï¼ Sessionè¢«éæ¯</code>è¿æ¡å³é®æ¥å¿ãå®ä¼åè¯ä½ Sessionè¢«éæ¯çç²¾ç¡®æ¶é´ï¼ç»åå æ ä¿¡æ¯ï¼å°±è½å®ä½å°æ¯åªä¸ªä»£ç è·¯å¾æéç½®è§¦åäºéæ¯ã</p>
<p>äºãåææå¡å¨çº¿ç¨æ </p>
<p>å¦ææçæ¯<strong>ä¼è¯éè¶æ¶</strong>ï¼éè¦å¨éªéåçæ¶ï¼ç«å»è·åæå¡å¨ççº¿ç¨å æ å¿«ç§ï¼<code class="hyc-common-markdown__code__inline">jstack &lt;pid&gt;</code>ï¼ãåæå¿«ç§ï¼çæ¯å¦æçº¿ç¨é¿æ¶é´ææSessionéï¼ç¶æä¸º <code class="hyc-common-markdown__code__inline">RUNNABLE</code>ä¸æ­£å¨æ§è¡æ¥è¯¢SQLï¼ï¼èå¶ä»çº¿ç¨å¨ç­å¾è¿ä¸ªéï¼ç¶æä¸º <code class="hyc-common-markdown__code__inline">BLOCKED</code>ï¼ã</p>
<h3>æ»ç»ï¼è·è¸ªæµç¨ä¸è§è¡¨</h3>
<div class="hyc-common-markdown__table-wrapper" data-has-scroll="true">
<table>
<thead>
<tr>
<th>
<p>æ­¥éª¤</p>
</th>
<th>
<p>è·è¸ªç¹</p>
</th>
<th>
<p>æ¹æ³</p>
</th>
<th>
<p>ææç»æ</p>
</th>
<th>
<p>å¼å¸¸ç»æä¸å«ä¹</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><strong>1</strong>â</p>
</td>
<td>
<p><strong>æµè§å¨æ¥æ¶Cookie</strong>â</p>
</td>
<td>
<p>F12 -&gt; Network -&gt; æ¥çç»å½è¯·æ±ç <code class="hyc-common-markdown__code__inline">Set-Cookie</code>ååºå¤´</p>
</td>
<td>
<p>æ¶å°æ­£ç¡®ç <code class="hyc-common-markdown__code__inline">JSESSIONID</code></p>
</td>
<td>
<p>æªæ¶å°ï¼æå¡å¨ååºé®é¢</p>
</td>
</tr>
<tr>
<td>
<p><strong>2</strong>â</p>
</td>
<td>
<p><strong>æµè§å¨å­å¨Cookie</strong>â</p>
</td>
<td>
<p>F12 -&gt; Application -&gt; Cookies</p>
</td>
<td>
<p>å­å¨äºæ­£ç¡®ç <code class="hyc-common-markdown__code__inline">JSESSIONID</code></p>
</td>
<td>
<p>æªå­å¨ï¼æµè§å¨å®å¨ç­ç¥é»æ­¢</p>
</td>
</tr>
<tr>
<td>
<p><strong>3</strong>â</p>
</td>
<td>
<p><strong>åç»­è¯·æ±æºå¸¦Cookie</strong>â</p>
</td>
<td>
<p>F12 -&gt; Network -&gt; æ¥çæ¥è¯¢è¯·æ±ç <code class="hyc-common-markdown__code__inline">Cookie</code>è¯·æ±å¤´</p>
</td>
<td>
<p>æºå¸¦äºç»å½æ¶ç <code class="hyc-common-markdown__code__inline">JSESSIONID</code></p>
</td>
<td>
<p>æªæºå¸¦/å¼éè¯¯ï¼æµè§å¨ç«¯Cookieä¸¢å¤±</p>
</td>
</tr>
<tr>
<td>
<p><strong>4</strong>â</p>
</td>
<td>
<p><strong>æå¡å¨å¤çè¯·æ±</strong>â</p>
</td>
<td>
<p>æ¥çæå¡å¨æ¥å¿/çå¬å¨æ¥å¿</p>
</td>
<td>
<p>Sessionææï¼è¯·æ±æ­£å¸¸å¤ç</p>
</td>
<td>
<p>æ¥å¿æ¾ç¤ºSessionè¢«éæ¯ï¼æå¡å¨ç«¯ä¸»å¨åºå¼ä¼è¯</p>
</td>
</tr>
<tr>
<td>
<p><strong>5</strong>â</p>
</td>
<td>
<p><strong>æå¡å¨å¹¶åæåµ</strong>â</p>
</td>
<td>
<p>åæçº¿ç¨å æ å¿«ç§ (<code class="hyc-common-markdown__code__inline">jstack</code>)</p>
</td>
<td>
<p>æ é¿æ¶é´éç­å¾</p>
</td>
<td>
<p>æçº¿ç¨å ç­å¾Sessionéèé»å¡ï¼ä¼è¯éè¶æ¶é®é¢</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>è¯·æç§è¿ä¸ªæµç¨è¿è¡æä½ï¼å¾å¤§æ¦çè½ç´æ¥å®ä½å°é®é¢åççå·ä½ç¯èãåä»<strong>æµè§å¨ç«¯è·è¸ª</strong>å¼å§ï¼è¿éå¸¸è½ç»åºæç´æ¥ççº¿ç´¢ã</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-20 15:22">2026-01-20 15:22</span>&nbsp;
<a href="https://www.cnblogs.com/liuyangjava">å­å¢¨èå¸</a>&nbsp;
éè¯»(<span id="post_view_count">113</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19507022);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19507022', targetLink: 'https://www.cnblogs.com/liuyangjava/p/19507022', title: 'åºäºspringbootç³»ç»ï¼å¦ä½è·è¸ªä¼è¯è¿æï¼æµè§å¨ä¼è¯æ è¯æ¯å¦æ¶å°æ­£å¸¸ååºï¼å­å¨ï¼å¹¶å¨åç»­è¯·æ±ä¿ææºå¸¦' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Docker åçº§å VS Code æ¬å°è°è¯ AWS Lambda æ¥ãRunning AWS SAM projects locally requires Dockerãçé£äºåä¸ææ¥æè·¯ ]]></title>
    <link>https://www.cnblogs.com/wanghaiwei/p/19505845</link>
    <guid>38e867841b1fb5353da44bffc0034dab</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/wanghaiwei/p/19505845" title="åå¸äº 2026-01-20 11:48">
    <span role="heading" aria-level="2">Docker åçº§å VS Code æ¬å°è°è¯ AWS Lambda æ¥ãRunning AWS SAM projects locally requires Dockerãçé£äºåä¸ææ¥æè·¯</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="ä¸é®é¢åºæ¯æè¿°">ä¸ãé®é¢åºæ¯æè¿°</h2>
<ul>
<li>
<p>å¨ VS Code ä¸­ä½¿ç¨ AWS Toolkit æ¬å°è°è¯ Lambdaï¼åºäº AWS SAM é¡¹ç®ï¼æ¶ï¼ç¹å»æ¬å°è¿è¡/è°è¯ï¼åºç°æç¤ºï¼<br>
âRunning AWS SAM projects locally requires Docker. Have you got it installed and running?â</p>
</li>
<li>
<p>å®éæåµæ¯ï¼æ¬å°å·²ç»å®è£å¹¶è¿è¡ Docker Desktopï¼ä½¿ç¨å½ä»¤è¡æ§è¡&nbsp;<code>docker ps</code>ã<code>docker info</code>&nbsp;ç­é½æ­£å¸¸ï¼å®¹å¨ç¯å¢å¯ç¨ã[<a href="https://stackoverflow.com/questions/50791354/running-aws-sam-projects-locally-get-error" target="_blank" rel="noopener nofollow">stackoverflow</a>]â</p>
</li>
<li>
<p>æ¢å¥è¯è¯´ï¼<strong>Docker ææå¨è·ï¼ä½ VS Code + SAM CLI åæè¯´âæ¾ä¸å° Dockerâ</strong>ã[<a href="https://stackoverflow.com/questions/50791354/running-aws-sam-projects-locally-get-error" target="_blank" rel="noopener nofollow">stackoverflow</a>]â</p>
</li>
</ul>
<hr>
<h2 id="äºæç»ç¡®è®¤çæ ¹å ä½ è¿æ¬¡éå°ç">äºãæç»ç¡®è®¤çæ ¹å ï¼ä½ è¿æ¬¡éå°çï¼</h2>
<ul>
<li>
<p>ä½ æ¾å°çæç»åå æ¯ï¼<strong>å¨åçº§ Docker Desktop ä¹åï¼æ¬å°ç AWS SAM CLI ä»¥åå³ç³»ç´§å¯ç AWS å·¥å·é¾ï¼å¦ VS Code æä»¶ï¼çæ¬æ²¡æåæ­¥åçº§ï¼å¯¼è´ä¸æ° Docker çæ¬ç API/è¡ä¸ºä¸å¼å®¹</strong>ã[<a href="https://stackoverflow.com/questions/50791354/running-aws-sam-projects-locally-get-error" target="_blank" rel="noopener nofollow">stackoverflow</a>]â</p>
</li>
<li>
<p>åçº§ AWS SAM CLI å AWS ç¸å³æä»¶å°ææ°çæ¬åï¼éè¯¯æç¤ºæ¶å¤±ï¼æ¬å°è°è¯æ¢å¤æ­£å¸¸ã[<a href="https://stackoverflow.com/questions/50791354/running-aws-sam-projects-locally-get-error" target="_blank" rel="noopener nofollow">stackoverflow</a>]</p>
</li>
<li>
<p>åçº§æ¹æ³ï¼è·çå®æ¹ææ¡£éæ°ä¸è½½å®è£åï¼ä¼èªå¨åçº§ï¼<a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/install-sam-cli.html#install-sam-cli-instructions%E2%80%8B" target="_blank" rel="noopener nofollow">https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/install-sam-cli.html#install-sam-cli-instructionsâ</a></p>
</li>
</ul>
<p>è¿ä¸ç¹å¯ä»¥ä½ä¸ºä½ åäº«éçâä¸»çº¿æäºââââéå½¢ççæ¬å¼å®¹é®é¢âã</p>
<hr>
<h2 id="ä¸å¯è½çåå æ»è§å¯ç¨ä½åäº«ä¸­ç-checklist">ä¸ãå¯è½çåå æ»è§ï¼å¯ç¨ä½åäº«ä¸­ç checklistï¼</h2>
<p>ä½ å¯ä»¥æâä»æåºç¡å°åé«çº§âçé¡ºåºä»ç»ï¼å¸®å©å¬ä¼å½¢æææ¥æè·¯ã</p>
<h3 id="31-docker-æ¬èº«ççæ²¡è£--æ²¡å¯å¨">3.1 Docker æ¬èº«ççæ²¡è£ / æ²¡å¯å¨</h3>
<p>è½ç¶çèµ·æ¥å¾åºç¡ï¼ä½å¨å¢ééç»å¸¸æ¯æçå®çæåµï¼å¯ä»¥ç®è¦æä¸ä¸ã[<a href="https://stackoverflow.com/questions/50791354/running-aws-sam-projects-locally-get-error" target="_blank" rel="noopener nofollow">stackoverflow</a>]â</p>
<ul>
<li>
<p>æªå®è£ Docker Desktop æå¶ä» Docker å¼æã</p>
</li>
<li>
<p>Docker Desktop å·²å®è£ï¼ä½å½åæ²¡æå¯å¨ï¼æçå¾æ è¿å¨ starting / æª running ç¶æï¼ã</p>
</li>
<li>
<p>å¨ VS Code éæç»ç«¯ä¸­è¿è¡&nbsp;<code>docker ps</code>&nbsp;æ¥âCannot connect to the Docker daemonâç­éè¯¯ã</p>
</li>
</ul>
<p><strong>å®ä½æ¹å¼</strong></p>
<ul>
<li>
<p>æå¼ VS Code éæç»ç«¯ï¼æ§è¡&nbsp;<code>docker ps</code>ã<code>docker info</code>ã</p>
</li>
<li>
<p>å¦æè¿éé½å¤±è´¥ï¼åºæ¬ä¼åæ£æ¥ Docker å®è£åå¯å¨ç¶æã[<a href="https://stackoverflow.com/questions/50791354/running-aws-sam-projects-locally-get-error" target="_blank" rel="noopener nofollow">stackoverflow</a>]â</p>
</li>
</ul>
<hr>
<h3 id="32-vs-code-æå¨ç¯å¢ä¸-docker-ä¸å¨åä¸ä¸ªä¸ç">3.2 VS Code æå¨ç¯å¢ä¸ Docker ä¸å¨åä¸ä¸ªâä¸çâ</h3>
<p>è¿æ¯ç¬¬äºç±»å¾å¸¸è§çé®é¢ï¼<strong>ä½ å¨ A ç»ç«¯éè½ç¨ Dockerï¼ä½ VS Code ä½¿ç¨çæ¯ B ç¯å¢</strong>ã[<a href="https://stackoverflow.com/questions/50791354/running-aws-sam-projects-locally-get-error" target="_blank" rel="noopener nofollow">stackoverflow</a>]â</p>
<p>å¸åæå½¢ï¼</p>
<ul>
<li>
<p>å¨ Windows ä¸ç¨ WSL æå¼å·¥ç¨ï¼è Docker Desktop åªå¨ Windows ç¯å¢å¯è§ï¼VS Code çè°è¯å¨ WSL éè·ï¼WSL åæ²¡æå¯ç¨ç Docker socketã</p>
</li>
<li>
<p>ä½¿ç¨ Dev Container / Remote-SSH / Remote-WSL ç­è¿ç¨å¼åæ¨¡å¼ï¼ä½å®¹å¨/è¿ç¨ç¯å¢åé¨æ²¡æ Docker ææ²¡ææ å° Docker socketã</p>
</li>
<li>
<p>æå¨å¼ç»ç«¯æ¶ç¨çæ¯ä¸ä¸ª shell profileï¼è®¾ç½®äºä¸äºåéæ aliasï¼è VS Code éæç»ç«¯æ²¡æå è½½åæ ·çéç½®ã</p>
</li>
</ul>
<p><strong>å®ä½æ¹å¼</strong></p>
<ul>
<li>
<p>ä¸å¾å¨ VS Code éæç»ç«¯ä¸­æ§è¡ï¼<code>docker ps</code>ã<code>sam local invoke</code>ï¼çè¾åºåæ®éç»ç«¯æ¯å¦ä¸è´ã</p>
</li>
<li>
<p>å¦ææ®éç»ç«¯ OKï¼VS Code éå¤±è´¥ï¼å°±å¯ä»¥è®²ï¼<br>
âé®é¢å¨äº VS Code è¿è¡ SAM CLI çç¯å¢ï¼ä¸æå¹³æ¶ç¨çç»ç«¯ç¯å¢ä¸ä¸æ ·ãâ[<a href="https://stackoverflow.com/questions/50791354/running-aws-sam-projects-locally-get-error" target="_blank" rel="noopener nofollow">stackoverflow</a>]â</p>
</li>
</ul>
<hr>
<h3 id="33-docker_host--docker-context-éç½®æ-sam-å¸¦å">3.3 DOCKER_HOST / Docker context éç½®æ SAM âå¸¦åâ</h3>
<p>å½ä½¿ç¨è¿è¿ç¨ DockerãColimaãRancher Desktop ç­å·¥å·æ¶ï¼å¾å®¹æçä¸æ§ç&nbsp;<code>DOCKER_HOST</code>&nbsp;ç¯å¢åéæéé»è®¤ Docker contextã[<a href="https://stackoverflow.com/questions/50791354/running-aws-sam-projects-locally-get-error" target="_blank" rel="noopener nofollow">stackoverflow</a>]â</p>
<p><strong>å¸åé®é¢</strong></p>
<ul>
<li>
<p><code>DOCKER_HOST</code>&nbsp;æåä¸ä¸ªå·²ç»ä¸å­å¨æä¸å¯è¾¾çè¿ç¨ Dockerã</p>
</li>
<li>
<p>å½å Docker context æ¯æä¸ªè¿ç¨/å®éªç¯å¢ï¼èä¸æ¯æ¬å° Desktopã</p>
</li>
<li>
<p>ç¨&nbsp;<code>docker ps</code>&nbsp;å¯è½è¿æ¾ç¤ºå¾æ­£å¸¸ï¼ä½å®éè¿çæ¯æä¸ªå¥æªç hostã</p>
</li>
</ul>
<p><strong>ææ¥ä¸ä¿®å¤</strong></p>
<ul>
<li>
<p>å¨ VS Code éæç»ç«¯ä¸­æ¥çç¯å¢åéï¼</p>
<ul>
<li>
<p>Linux/macOS:&nbsp;<code>env | grep DOCKER_HOST</code></p>
</li>
<li>
<p>PowerShell:&nbsp;<code>Get-ChildItem Env:DOCKER_HOST</code></p>
</li>
</ul>
</li>
<li>
<p>å¦ææå¼ï¼å¯ä»¥å°è¯ä¸´æ¶&nbsp;<code>unset</code>&nbsp;/&nbsp;<code>Remove-Item Env:DOCKER_HOST</code>ï¼åè¯ä¸æ¬¡æ¬å°è°è¯ã</p>
</li>
<li>
<p>æ¥ç Docker contextï¼<code>docker context ls</code>ï¼ç¡®è®¤å½å active ç context æ¯å¦æ¯é¢æçæ¬å°ç¯å¢ã</p>
</li>
<li>
<p>è¥é®é¢è§£å³ï¼å¯ä»¥å¨åäº«ä¸­å¼ºè°ï¼<br>
âéå° Docker ææå¨è·å´è¢«è®¤ä¸ºâä¸å¯ç¨âæ¶ï¼è®°å¾æ£æ¥ DOCKER_HOST å docker contextãâ[<a href="https://stackoverflow.com/questions/50791354/running-aws-sam-projects-locally-get-error" target="_blank" rel="noopener nofollow">stackoverflow</a>]â</p>
</li>
</ul>
<hr>
<h3 id="34-docker-çæ¬åçº§åsam-cli--å·¥å·é¾çæ¬å¤ªæ§ä½ çå®éæ¡ä¾">3.4 Docker çæ¬åçº§åï¼SAM CLI / å·¥å·é¾çæ¬å¤ªæ§ï¼ä½ çå®éæ¡ä¾ï¼</h3>
<p>è¿æ¯ä½ è¿æ¬¡éå°çæ ¸å¿åå ï¼ä¹éå¸¸éåéç¹è®²è§£ã[<a href="https://stackoverflow.com/questions/50791354/running-aws-sam-projects-locally-get-error" target="_blank" rel="noopener nofollow">stackoverflow</a>]â</p>
<p><strong>ç°è±¡</strong></p>
<ul>
<li>
<p>Docker Desktop åçº§å°æ°çæ¬ä¹åï¼<code>docker ps</code>&nbsp;ç­å½ä»¤é½æ­£å¸¸ã</p>
</li>
<li>
<p>ä½éè¿ VS Codeï¼AWS Toolkitï¼ç¹å»æ¬å°è¿è¡ Lambdaï¼æç¤ºä»ç¶æ¯ âRunning AWS SAM projects locally requires Dockerâ¦âã</p>
</li>
<li>
<p>æå¨å¨ç»ç«¯æ§è¡&nbsp;<code>sam local invoke</code>&nbsp;æ&nbsp;<code>sam local start-api</code>&nbsp;å¯è½ä¹ä¼æ¥ç±»ä¼¼âDocker ä¸å¯è¾¾âæ API ç¸å³çéè¯¯ã</p>
</li>
</ul>
<p><strong>åå </strong></p>
<ul>
<li>
<p>èçæ¬ç AWS SAM CLI åé¨ä¾èµç Docker å®¢æ·ç«¯åºï¼å¯¹æ° Docker API ææäºè¡ä¸ºä¸å¼å®¹ã</p>
</li>
<li>
<p>VS Code ç AWS Toolkit ä¹æå¯¹ SAM CLI æ Docker ççæ¬è¦æ±ï¼å¦æå¤ªæ§ï¼æ£æµé»è¾ä¼å¤±è´¥ã</p>
</li>
<li>
<p>ç»æå°±æ¯ï¼<strong>Docker å®éå¯ç¨ï¼ä½å¥åº·æ£æ¥é¶æ®µå°±âæäºâï¼äºæ¯åç«¯ç»ä¸æåºâéè¦å®è£ Dockerâè¿ç§è¯¯å¯¼æ§çéè¯¯ä¿¡æ¯</strong>ã[<a href="https://stackoverflow.com/questions/50791354/running-aws-sam-projects-locally-get-error" target="_blank" rel="noopener nofollow">stackoverflow</a>]â</p>
</li>
</ul>
<p><strong>è§£å³æ¹å¼</strong></p>
<ul>
<li>
<p>åçº§ AWS SAM CLI å°ææ°ç¨³å®çæ¬ã</p>
</li>
<li>
<p>åçº§ VS Code ä¸­ç AWS Toolkitï¼ä»¥åå¦æéè¦ç AWS CLI ç­ä¾èµï¼ã</p>
</li>
<li>
<p>åçº§ååæ¬¡å°è¯æ¬å°è¿è¡ Lambdaï¼é®é¢æ¶å¤±ã</p>
</li>
</ul>
<p>è¿ä¸æ®µå¯ä»¥ä½ä¸ºä½ åäº«éâçæ­£è¸©åâçé¨åï¼å¼ºè°âDocker åçº§åå«å¿äºåçº§ SAM / å·¥å·é¾âã</p>
<hr>
<h2 id="åæ¨èçææ¥é¡ºåºå¯ä»¥ç´æ¥æå±çä¸å¼ -slide">åãæ¨èçææ¥é¡ºåºï¼å¯ä»¥ç´æ¥æå±çä¸å¼  slideï¼</h2>
<p>ä½ å¯ä»¥æ´çæä¸ä¸ªâæéææ¥æµç¨âï¼</p>
<ol>
<li>
<p><strong>ç¡®è®¤ Docker ççå¨ VS Code ç¯å¢éå¯ç¨</strong></p>
<ul>
<li>å¨ VS Code éæç»ç«¯æ§è¡&nbsp;<code>docker ps</code>ã<code>docker info</code>ã</li>
</ul>
</li>
<li>
<p><strong>æ£æ¥ç¯å¢æ¯å¦ä¸è´</strong></p>
<ul>
<li>
<p>æ¯å¦å¨ WSL / Dev Container / è¿ç¨ç¯å¢ä¸­ï¼</p>
</li>
<li>
<p>è¿äºç¯å¢éæ¯å¦ä¹å®è£/æ å°äº Dockerï¼</p>
</li>
</ul>
</li>
<li>
<p><strong>æ£æ¥ DOCKER_HOST å Docker context</strong></p>
<ul>
<li>ç§»é¤å¯çç&nbsp;<code>DOCKER_HOST</code>ï¼ç¡®è®¤å½å context æ­£ç¡®ã</li>
</ul>
</li>
<li>
<p><strong>æ£æ¥çæ¬å¼å®¹</strong></p>
<ul>
<li>
<p>Docker Desktop æ¯å¦ååçº§ï¼</p>
</li>
<li>
<p><code>sam --version</code>&nbsp;æ¯å¦å¾èï¼</p>
</li>
<li>
<p>åçº§ AWS SAM CLIãAWS Toolkit ç­å·¥å·å°ææ°çæ¬ã</p>
</li>
</ul>
</li>
<li>
<p><strong>åæ¬¡ä» VS Code ä¸­åèµ·æ¬å°è°è¯</strong></p>
<ul>
<li>éªè¯é®é¢æ¯å¦è§£å³ã</li>
</ul>
</li>
</ol>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-20 11:48">2026-01-20 11:48</span>&nbsp;
<a href="https://www.cnblogs.com/wanghaiwei">æ¸¸å­¦è</a>&nbsp;
éè¯»(<span id="post_view_count">78</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19505845);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19505845', targetLink: 'https://www.cnblogs.com/wanghaiwei/p/19505845', title: 'Docker åçº§å VS Code æ¬å°è°è¯ AWS Lambda æ¥ãRunning AWS SAM projects locally requires Dockerãçé£äºåä¸ææ¥æè·¯' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Python å­¦ä¹ ç¬è®°ï¼åºç¡è¯­æ³å­¦ä¹  ]]></title>
    <link>https://www.cnblogs.com/owlman/p/19505712</link>
    <guid>2d5fe5419c623a1ab876b346857cc2dc</guid>
    <description>
    <![CDATA[ 
        <h2 class="post-title">
            <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/owlman/p/19505712" title="åå¸äº 2026-01-20 11:34">
    <span role="heading" aria-level="2">Python å­¦ä¹ ç¬è®°ï¼åºç¡è¯­æ³å­¦ä¹ </span>
    

</a>

        </h2>
        <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>[!NOTE] ç¬è®°è¯´æ</p>
<p>æ ¹æ®ä¹åå¨ã[[å³äºPythonçå­¦ä¹ |Python å­¦ä¹ è·¯ç³»ç»å¾è§å]]ãä¸æä¸­çè§åï¼è¿ç¯ç¬è®°ä¸­å°ä¼å·ä½è®°å½æå¨å­¦ä¹  Python çåºç¡è¯­æ³è§åè¿ç¨ä¸­çä¸äºå¿å¾ä½ä¼ä¸ç¼ç¨ç»ä¹ ï¼å®ä»¬å°ä¸»è¦èç¦äºä»¥ä¸è®®é¢ï¼</p>
<ul>
<li>äºè§£å¨ Python ä»£ç ä¸­ä¼åºç°çæ³¨éãåéãæä½ç¬¦ä»¥åè¡¨è¾¾å¼ç­åºæ¬åç´ ï¼</li>
<li>äºè§£ Python çåç½®æ°æ®ç±»åãèªå®ä¹ç±»åä»¥åå®ä»¬å¯æ§è¡çç¸å³æä½ï¼</li>
<li>äºè§£å¦ä½å¨ Python ä¸­ä½¿ç¨å½æ°ãå¯¹è±¡ä»¥åæ¨¡åæ¥å®ç°é¢åè¿ç¨/å¯¹è±¡çç¼ç¨ï¼</li>
</ul>
</blockquote>
<p>èªãThe C Programming Languageãè¿æ¬å¨ç¼ç¨è¯­è¨é¢åä¸­è¢«èªä¸ºâå£ç»âçç»å¸ææé®ä¸ä»¥æ¥ï¼å¨å½ä»¤è¡ç»ç«¯ç¯å¢ä¸­è¾åºå¸¦æâHello Worldâå­æ ·çä¿¡æ¯å·²ç»æä¸ºäºäººä»¬å­¦ä¹ ä¸é¨æ°çç¼ç¨è¯­è¨ï¼æèæµè¯è¯¥è¯­è¨çæ§è¡ç¯å¢æ¯å¦æ­£å¸¸çç¬¬ä¸ä¸ªæ¼ç¤ºç¨åºãè¿æ ·åä¸ä»å¯ä»¥åè®©æä»¬å¯¹èªå·±è¦å­¦ä¹ çç¼ç¨è¯­è¨åå¶æ§è¡ç¯å¢æä¸ä¸ªæ´ä½çå°è±¡ï¼åæ¶ä¹ä¸ºè¯¥è¯­è¨çåºç¡è¯­æ³å­¦ä¹ æä¾äºä¸ä¸ªåå¥ç¹ãæ¥ä¸æ¥ï¼å°±è®©æä»¬é²è¯å°è¯´ï¼åä»ã[[ç¼ç¨ç¯å¢éç½®]]ãé£ç¯ç¬è®°æ«å°¾çé£ç Hello World ç¨åºå¼å§èèµ·å§ï¼å¶ä»£ç å¦ä¸æç¤ºã</p>
<pre><code class="language-python">#! /usr/bin/env python
'''
    Simple example to say hello
    
    Author: lingjie
    Created on: 2024-06-15
    '''

author_name = "owlman"
def say_hello(name: str) -&gt; None:
    '''
        Say hello by name.
     
        Args:
            name: name to greet
    '''
    print("Hello World! My name is", name)

if __name__ == "__main__":
    say_hello(author_name)
</code></pre>
<h2 id="ä¸ºä»£ç ç¼åæ³¨é">ä¸ºä»£ç ç¼åæ³¨é</h2>
<p>å¨ä¸è¿°ä»£ç ä¸­ï¼æä»¬é¦åçå°çåºè¯¥æ¯æ³¨éä¿¡æ¯ãéå¸¸æåµä¸ï¼ç¨åºåä»¬ç¼åæ³¨éçç®çæ¯è®©éè¯»ä»£ç çäººè½æ´å¥½å°çè§£èªå·±çè®¾è®¡æå¾ï¼è¿å¯¹äºä»£ç çåææµè¯åç»´æ¤å·¥ä½æçéå¸¸éè¦çç°å®æä¹ãå¨ Python çè¯­æ³è§åä¸­ï¼æ³¨éä¸»è¦æä»¥ä¸ä¸¤ç§å½¢å¼ã</p>
<ul>
<li>
<p><strong>ä»¥<code>#</code>ç¬¦å·å¼å¤´çåè¡æ³¨é</strong>ï¼è¿ç§å½¢å¼çæ³¨éå¯ä»¥å¨ä»£ç çä»»æå°æ¹ä»¥<code>#</code>ç¬¦å·å¼å¤´ç¼åæ³¨éä¿¡æ¯ï¼ç´è³å¶æå¨è¡ç»æä¸ºæ­¢ï¼ä¾å¦åä¸é¢è¿æ ·ã</p>
<pre><code class="language-python"># Python æ¯æå æ³è¿ç®
x = 7
y = 8
z = x + y # è¯·é® z = ï¼
</code></pre>
</li>
<li>
<p><strong>ç¨ä¸ä¸ªåå¼å·åæ¬èµ·æ¥çå­ç¬¦ä¸²</strong>ï¼ä¸¥æ ¼æ¥è¯´ï¼è¿ç§å½¢å¼çå­ç¬¦ä¸²å¹¶ä¸å±äºçæ­£çæ³¨éè¯­æ³ãä½ç±äºå®å¯ä»¥è¢«æ¾ç½®å¨ä»£ç ä¸­çä»»ä½ä½ç½®ä¸ï¼å¹¶ä¸å¯ç¨äºåç°åå«æ¢è¡ç¬¦çé¿ææ¬ä¿¡æ¯ï¼æä»¥å¸¸è¢«ç¨åºåä»¬ç¨æ¥ç¼åå¤è¡æ³¨éï¼ä¾å¦åä¸é¢è¿æ ·ã</p>
<pre><code class="language-python">'''
ç¤ºè Python ä¸­çå æ³è¿ç®
æ¶ååéï¼xãyãz
'''

x = 7
y = 8
z = x + y
print("z = ", z)
</code></pre>
<p><strong>éè¦åæ¬¡å¼ºè°çæ¯</strong>ï¼å¦æä¸¥æ ¼æç§ Python çè¯­æ³è§åæ¥è¯´ï¼ä¸è¿°å­ç¬¦ä¸²çä½ç¨ä¸çº¯ç²¹çæ³¨éè¯­æ³å¹¶ä¸å®å¨ç¸åãè½ç¶å¨å¤§å¤æ°æåµä¸ï¼è¿ç§å½¢å¼çå­ç¬¦ä¸²ä¸ä¼å¯¹ä»£ç çæ§è¡äº§çä»»ä½å½±åï¼ä½å¦ææä»¬å°è¿ç§å­ç¬¦ä¸²æ¾ç½®å¨äºå½æ°æç±»å®ä¹çå¼å¤´ï¼å®å°±ä¼è¢«å½ä½è¯¥å½æ°æç±»ç<strong>ææ¡£å­ç¬¦ä¸²ï¼docstringï¼</strong>æ¥å¤çï¼è¿å¯ä»¥éè¿<code>help()</code>å½æ°æ¥æ¥çè¯¥å½æ°æç±»çææ¡£è¯´æãä¾å¦å¨ä¸é¢ç Hello World ç¨åºä¸­ï¼æä»¬å°±ä½¿ç¨äºè¿ç§å¤è¡å­ç¬¦ä¸²å¯¹è±¡ä¸º<code>say_hello()</code>å½æ°ç¼åäºä¸ä¸ªææ¡£å­ç¬¦ä¸²ãè¯»èå¯ä»¥éè¿å¨ Python çäº¤äºå¼çé¢ä¸­è¾å¥<code>help(say_hello)</code>å½ä»¤æ¥æ¥çè¯¥å½æ°çææ¡£è¯´æï¼å·ä½å¦å¾ 1 æç¤ºã</p>
  
<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202601/691082-20260119121242284-497826193.png" class="lazyload"></p>
<p><strong>å¾ 1</strong>ï¼Python ä¸­çææ¡£å­ç¬¦ä¸²</p>
</li>
</ul>
<p>æ­£å¦æä»¬ä¹åæè¯´ï¼æ³¨éå­å¨çç®çæ¯è¯´æç¨åºåç¼åç¸å³ä»£ç çæå¾ï¼ä»¥æ­¤æ¥æé«ä»£ç çå¯è¯»æ§ï¼æ¹ä¾¿æ¥åçæµè¯ä¸ç»´æ¤å·¥ä½ãä¾å¦å¨ä¸é¢è¿æ®µç¤ºä¾ä»£ç ä¸­ï¼æä»¬ç¨æ³¨éè¯´æäºå®ç¨äºç¤ºèå¨ Python ä¸­æ§è¡å æ³è¿ç®ï¼å¹¶ä½¿ç¨äº<code>x</code>ã<code>y</code>ã<code>z</code>ä¸ä¸ªåéï¼å½ç¶äºï¼ç¼åè¿ç§ç»èæ·»è¶³å¼çæ³¨éå¨å®éçäº§ç¯å¢ä¸­å¹¶ä¸å¼å¾é¼å±ãå ä¸ºï¼æä»¬å¿é¡»èèå° Python æ¬èº«å°±æ¯ä¸é¨ç¨äºè¡¨è¾¾ä¿¡æ¯çè¯­è¨ï¼å®çä½ç¨é¤äºè®©æºå¨æç§å®çæå¾æ­£ç¡®æ§è¡ä¹å¤ï¼ä¹åºè¯¥è®©ä½¿ç¨è¿é¨è¯­è¨çäººç±»çå¾æå®çæå¾ã<strong>æ³¨éçä½ç¨åªè½æ¯è¾å©è¯´æï¼å¯ä¸æ¯åå½ Python èªèº«çç¿»è¯</strong>ãæ¢èè¨ä¹ï¼æä»¬åºè¯¥å°½éç¨ä»£ç æ¬èº«æ¥è¡¨è¾¾å®æè¦è¡¨è¾¾çæå¾ï¼èä¸æ¯å¤å¤é½åå©æ³¨éã</p>
<p>é¤äºè¯´æä»£ç çæå¾ä¹å¤ï¼æ³¨éè¿æä¸ä¸ªé¢å¤çä½ç¨ï¼<strong>å¨è°è¯è¿ç¨ä¸­ä¸´æ¶å»é¤æä¸è¡ä»£ç </strong>ãä¸¾ä¸ªä¾å­ï¼å¦ææå¨è°è¯ä¸é¢è¿å è¡ä»£ç çæ¶ååç°èªå·±çå½ä»¤è¡ç»ç«¯ä¸è½æ¾ç¤ºä¸­æï¼ä¸ºäºç¡®å®è¿ä¸æ¯ä»£ç æ¬èº«çé®é¢ï¼æå¯è½ä¼éæ©åä¸é¢è¿æ ·ï¼ä¸´æ¶æ³¨éæä¸­æçè¾åºï¼ç¶åå¢å ä¸æ¡è±æçè¾åºãå¨å¾å¤æ¶åï¼è¿ç§å©ç¨æ³¨éè¯­æ³æ¥ä¸´æ¶åæ¢è¦æ§è¡çä»£ç ï¼ä¹æ¯ä¸ç§å¾å¸¸ç¨çä»£ç è°è¯æå·§ã</p>
<pre><code class="language-python">name = "lingjie"
# print("ä½ å¥½ï¼", name)
print("Hello ", name)
</code></pre>
<h2 id="åéä¸å½æ°">åéä¸å½æ°</h2>
<p>ä¸é¢ï¼è®©æä»¬ç»§ç»­ä¹å Hello World ç¨åºçè®²è§£ãè¯»èå¨çå®è¯¥ç¨åºçæ³¨éè¯´æä¹åï¼æ¥ä¸æ¥ä¼çå°çæ¯ä¸ä¸ªç¨äºå®ä¹åéæå½æ°çè¯­å¥ãä¼æå¨ç¥ï¼ç±äºç¼ç¨è¯­è¨æ¯ä¸ç§è¡¨è¾¾æç»´æ´æ¥è¿äºæ°å­¦çäººç±»è¯­è¨ï¼æä»¥æä»¬å¨ç¨å®æè¿°ä¸ä»¶äºç©æ¶ï¼éå¸¸éè¦åå®æå¯¹å®çå®ä¹ï¼ä¾å¦ï¼æè¿°ä¸ä¸ªæ°æ®ï¼éå¸¸éè¦åå®ä¹ä¸ä¸ªåéï¼æè¿°ä¸ç»æä½ï¼éå¸¸éè¦åå®ä¹ä¸ä¸ªå½æ°ãä¸é¢ï¼å°±è®©æä»¬ä»åéçå®ä¹å¼å§ï¼å¸¦è¯»èéæ­¥äºè§£å¦ä½ä½¿ç¨ Python æ¥æè¿°ä¸ä»¶èªå·±æ³è®©è®¡ç®æºå®æçäºæå§ï¼</p>
<h3 id="åéçå®ä¹">åéçå®ä¹</h3>
<p>âåé"è¿ä¸ªæ¦å¿µææ©æºèªäºæ°å­¦ä¸­çä»£æ°è¿ç®ï¼ä¸ºäºæ¹ä¾¿æ¼ç®è¿ç¨çä¹¦åï¼æä»¬éå¸¸ä¼ç¨ä¸äºç®åçå­æ¯æ¥æä»£æ¼ç®è¿ç¨ä¸­ä¸æ­ååçå·²ç¥éææªç¥éï¼æ¯ç«å¨å¬å¼ä¸­å<code>x</code>ã<code>y</code>ã<code>z</code>è¿æ ·çå­æ¯æ»æ¯è¦æ¯å <span class="math inline">\(10^{55}\)</span> è¿æ ·çæ°å­æè <span class="math inline">\(\sum_{i=0}^{n}\)</span> è¿æ ·çè¡¨è¾¾å¼ç®åæ¹ä¾¿å¤äºãèå°äºè®¡ç®æºç¼ç¨è¯­è¨ä¸­ï¼åéçæ¦å¿µå¾å°äºè¿ä¸æ­¥æ©å±ï¼é¤äºæ¯æä¸ªæ°æ®å¼çæä»£å¤ï¼å®è¿å³èçè®¡ç®æºä¸­ç¨äºå­å¨è¯¥æ°æ®çä¸ååå­ç©ºé´ï¼æ¢èè¨ä¹ï¼åéç°å¨è¿æ¯ç¨åºç¨æ¥å­å¨æä¸ªæ°æ®çå®¹å¨ãå½ç¶äºï¼è¿äºå®¹å¨æ¢ç¶è½è¢«ç§°ä¸ºâåâéï¼ä¹å°±è¯´æå®ä»¬æå­å¨çæ°æ®æ¯ä¼éçç¨åºçæ§è¡èååçãç±äºåéæ¯ç¨åºæè¦æä½çåºæ¬å¯¹è±¡ï¼æä»¥å¨ç¼åç¨åºæ¶ï¼å®ä¹åéå¾å¾æ¯æä»¬é¦åè¦åçå·¥ä½ãå·ä½å° Python ä¸­ï¼ç¨äºå®ä¹åéçè¯­æ³è§åå¦ä¸ã</p>
<pre><code class="language-python">[åéå] = [åéå¼]
</code></pre>
<p>å¨è¿éï¼<code>[åéå]</code>æ¯æä»¬è¦å®ä¹çåéåç§°ï¼<code>[åéå¼]</code>åæ¯æä»¬è¦ä½¿ç¨è¯¥åéæè¿°çæ°æ®ãä¾å¦å¨ä¹åç Hello World ç¨åºä¸­ï¼<code>author_name = "lingjie"</code>å°±æ¯ä¸ä¸ªæ åçåéå®ä¹è¯­å¥ï¼å¶ä¸­ç<code>author_name</code>å°±æ¯<code>[åéå]</code>ï¼è<code>"lingjie"</code>åæ¯<code>[åéå¼]</code>ã</p>
<p>ä¸é¢ï¼è®©æä»¬åæ¥å·ä½è®¨è®ºä¸ä¸<code>[åéå]</code>çè®¾ç½®é®é¢ãåç»å¤§å¤æ°ç¼ç¨è¯­è¨ä¸æ ·ï¼Python ä¸­çåéåå¯ä»¥ç±å­æ¯ãæ°å­ä¸ä¸åçº¿ä»¥ä»»ä½é¡ºåºæåç»åèæï¼å¶ä¸­ä¸è½åå«ç©ºæ ¼ç¬¦ä»¥å<code>-</code>ã<code>$</code>è¿æ ·çç¹æ®ç¬¦å·ï¼å¹¶ä¸åªè½ä»¥å­æ¯ãä¸åçº¿å¼å¤´ï¼åä¸é¢è¿äºåéåé½æ¯ä¸è¢«åè®¸çï¼</p>
<pre><code class="language-python">$dollar = 100
2day = 10
'Week =11
\Month = 12
/Year = 14
my-name = "lingjie"
</code></pre>
<p>é¤æ­¤ä¹å¤ï¼æä»¬æä½¿ç¨çåéåè¿éè¦æ³¨æé¿å¼ Python è¯­è¨èªèº«è¦ä½¿ç¨çå³é®å­ï¼æä»¬å¯ä»¥å©ç¨è¯­è¨æ ååºä¸­ä¸ä¸ªåä¸º<code>keyword</code>çæ¨¡åæ¥è·åå½åå·²è¢« Python å ç¨çææå³é®å­ï¼å·ä½å¦å¾ 2 æç¤ºã</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202601/691082-20260119121346114-343341302.png" class="lazyload"></p>
<p><strong>å¾ 2</strong>ï¼Python ä¸­çå³é®å­</p>
<p>å½ç¶äºï¼åºäºä»£ç å¯è¯»æ§æ¹é¢çèèï¼æä»¬å¨éæ©åéåçæ¶åè¿åºè¯¥å°½éä½¿ç¨ææä¹çåè¯æåè¯ç»åï¼ä¸è½å¤ªè¿éæãå¨è¿éï¼ç¬èä¸ªäººæ´å¾åäºå»ºè®®è¯»èåºå¨åéçå½åä¸éµå®æç§ä¸è´çå½åè§èãè­¬å¦é©¼å³°å½åæ³ï¼éµå®è¿ç§å½åè§èçåéåéå¸¸ç±ä¸ä¸ªä»¥ä¸çåè¯ç»æï¼é¤äºé¦ä¸ªåè¯çå­æ¯ä¸æ¯å¤§åï¼å¶ä½ææåè¯çé¦å­æ¯åä¸ºå¤§åï¼ä¾å¦<code>myName</code>ã<code>myBook</code>ã<code>someValue</code>ã<code>getObject</code>ç­ãèå¨ Python ç¤¾åºä¸­ï¼äººä»¬éå¸¸æ´å¾åäºä½¿ç¨ä¸åçº¿æ¥åéè±æåè¯çèå½¢å½åæ³æ¥å½ååéï¼ä¾å¦<code>my_name</code>ã<code>my_book</code>ã<code>some_value</code>ã<code>get_object</code>ç­ãè½ç¶è¿äºå½åè§èå¹¶ä¸æ¯å¼ºå¶æ§çï¼ä½å®ä»¬å¯ä»¥å¸®å©æä»¬æ´å¥½å°çè§£ä»£ç çæå¾ï¼å°¤å¶æ¯å¨å¢éåä½ä¸­ï¼éµå®ç»ä¸çå½åè§èæ´æ¯è³å³éè¦ã</p>
<p>å¨ææ¡äº<code>[åéå]</code>çè®¾ç½®æ¹æ³ä¹åï¼æä»¬å°±å¯ä»¥æ¥çæ¥è®¨è®º<code>[åéå¼]</code>çè®¾ç½®é®é¢äºãå¦æè¯»èä¹åå­¦ä¹ è¿ C/C++/Java è¿ç±»ç¼ç¨è¯­è¨ï¼æ³å¿ä¸å®ä¼åç°å¨ Python ä¸­å®ä¹åéæ¯ä¸éè¦å£°æåéç±»åçãå ä¸º Python æ¯ä¸é¨å¨æç±»åè¯­è¨ï¼å®ä¼å¨è¿è¡æ¶èªå¨æ ¹æ®åéå¼çç±»åæ¥å³å®è¯¥åéçç±»åãä¹å°±æ¯è¯´ï¼Python è¯­è¨ä¸­çåéæ¯å¯ä»¥éæ¶æ¹åå¶å­å¨çæ°æ®ç±»åçãä¾å¦ï¼æä»¬å¯ä»¥åå°ä¸ä¸ªæ´æ°å¼èµç»ä¸ä¸ªåéï¼ç¶ååå°ä¸ä¸ªå­ç¬¦ä¸²å¼èµç»åä¸ä¸ªåéï¼è¿æ ·å°±å¯ä»¥è®©è¯¥åéçç±»åä»æ´æ°åæå­ç¬¦ä¸²äºï¼å°±åä¸é¢è¿æ ·ï¼</p>
<pre><code class="language-python">x = 100          # å°æ´æ°å¼èµç»åé x
print(x)         # è¾åºåé x çå¼ä¸º 100
x = "lingjie"    # åå°å­ç¬¦ä¸²å¼èµç»åä¸ä¸ªåé x
print(x)         # è¾åºåé x çå¼ä¸º "lingjie"
</code></pre>
<p>è³äº Python çåéä¸­ç©¶ç«å¯ä»¥å­å¨åªäºç±»åçæ°æ®ï¼æç¨åä¼å¨è®¨è®ºâå¯¹è±¡ä¸æ°æ®ç±»åâè¿ä¸è®®é¢æ¶åè¯¦ç»ä»ç»ãç°å¨ï¼è¯»èåªéè¦ç¥éå¨ Python ä¸­å®ä¹åéæ¶ï¼æä»¬åªéè¦æå®åéåååéå¼å³å¯ã</p>
<h3 id="å½æ°çå®ä¹">å½æ°çå®ä¹</h3>
<p>ååéä¸æ ·ï¼âå½æ°âè¿ä¸ªæ¦å¿µææ©ä¹æºèªäºæ°å­¦ï¼ç¨äºæè¿°è¿ç®åéä¹é´çå³ç³»ãä¾å¦ä¸è§å½æ°ä¸­çæ­£å¼¦å½æ° <span class="math inline">\(y = sin(x)\)</span>ï¼å®æè¿°çæ¯ä¸ä¸ªåé <span class="math inline">\(x\)</span> ä¸å¦ä¸ä¸ªåé <span class="math inline">\(y\)</span> ä¹é´çå³ç³»ãéçè®¡ç®æºç¼ç¨è¯­è¨çåå±ï¼å½æ°çæ¦å¿µä¹å¾å°äºç¸åºçæ©å±ï¼å®ç°å¨ä¸ä»å¯ä»¥è¡¨ç¤ºä¸¤ä¸ªåéä¹é´çå³ç³»ï¼è¿å¯ä»¥è¡¨ç¤ºä¸ç»æä½çéåï¼è¿äºæä½å¯ä»¥æ¥åè¾å¥å¹¶è¿åè¾åºãæ¢èè¨ä¹ï¼å½æ°å°±æ¯ä¸ç»å¯ä»¥è¢«è°ç¨æ¥æ§è¡ç¹å®ä»»å¡çä»£ç åãå¨ Python ä¸­ï¼å½æ°å®ä¹è¯­å¥çè¯­æ³è§åå¦ä¸ã</p>
<pre><code class="language-python">def [å½æ°åç§°]([åæ°åè¡¨]) -&gt; [è¿åå¼ç±»å]:
    '''
    [åè½è¯´æ]
    '''
    [å½æ°ä¸»ä½]
</code></pre>
<p>æ­£å¦è¯»èæè§ï¼æç§ Python çè¯­æ³è§åï¼å½æ°çå®ä¹è¯­å¥å¿é¡»è¦ä»¥<code>def</code>è¿ä¸ªå³é®å­å¼å¤´ï¼ç¶åéä¾æ¬¡å®ä¹<code>[å½æ°åç§°]</code>ã<code>[åæ°åè¡¨]</code>ã<code>[åè½è¯´æ]</code>ä»¥åè¦æ§è¡ç<code>[å½æ°ä¸»ä½]</code>ï¼å¶å·ä½è¯´æå¦ä¸ï¼</p>
<ul>
<li><code>[å½æ°åç§°]</code>æ¯è¢«å®ä¹å½æ°çåç§°ï¼å¨ Python ä¸­ï¼å½æ°çå½åè§åä¸åéæ¯ä¸æ ·çï¼è¯»èå¯ä»¥èªè¡åèä¹åå³äºåéå½åè§åçä»ç»æ¥äºè§£æ´å¤ç»èã</li>
<li><code>[åæ°åè¡¨]</code>æ¯è°ç¨å½æ°æ¶éè¦ä¼ å¥çåæ°åè¡¨ï¼å®å¯ä»¥ä¸ºç©ºï¼ä¹å¯ä»¥åå«ä¸ä¸ªæå¤ä¸ªåæ°ãæ¯ä¸ªåæ°ä¹é´ç¨éå·éå¼ï¼åæ°çå½åè§ååæ ·ä¸åéåä¸è´ãå¨ Python 3.5 ä¹åççæ¬ä¸­ï¼æä»¬è¿å¯ä»¥éè¿<code>åæ°å:åæ°ç±»åæ æ³¨</code>çå½¢å¼æ¥æ æ³¨ç¸åºåæ°çç±»åï¼ä¾å¦<code>name:str</code>ã<code>age:int</code>ã<code>height:float</code>ç­ãä½éè¦æ³¨æçæ¯ï¼åæ°ç±»åçæ æ³¨è¯­æ³æ¯å¯éçãä¹ä¸å·å¤å¼ºå¶æ§ççº¦æï¼æ¢è¨ä¹ï¼å®å¹¶ä¸ä¼å¨å½æ°è¢«è°ç¨æ¶å¯¹ä¼ å¥çåæ°å¼è¿è¡å®éçç±»åæ£æ¥ï¼ä½å®å¯ä»¥å¸®å©æä»¬æ´å¥½å°çè§£ä»£ç çæå¾ã</li>
<li><code>-&gt; [è¿åå¼ç±»å]</code>æ¯å½æ°è¿åå¼çç±»åæ æ³¨è¯­æ³ï¼å®ä¹æ¯å¯éçï¼ç¨äºè¯´æè¯¥å½æ°çè¿åå¼ç±»åãåæ ·éè¦æ³¨æçæ¯ï¼å®ä¹ä¸ä¼å¨å½æ°è¢«è°ç¨æ¶å¯¹è¿åå¼è¿è¡å®éçç±»åæ£æ¥ã</li>
<li><code>[åè½è¯´æ]</code>æ¯ä¹åæ¼ç¤ºè¿çææ¡£å­ç¬¦ä¸²ï¼å®æ¯ä¸ä¸ªç¨äºæè¿°å½æ°åè½åç¨æ³çå¤è¡å­ç¬¦ä¸²ï¼éå¸¸ä½äºå½æ°å®ä¹çç¬¬ä¸è¡ãå¨å½æ°çåè½è¿äºç®åæ¶ï¼è¿ä¸ªè¯´æå¯ä»¥çç¥ä¸åï¼ä½å¨å½æ°çåè½è¾ä¸ºå¤ææ¶ï¼ç¼åä¸ä¸ªæ¸æ°çåè½è¯´ææ¯éå¸¸æå¿è¦çã</li>
<li><code>[å½æ°ä¸»ä½]</code>æ¯å½æ°çå·ä½å®ç°é¨åï¼å¶ä¸­åå«äºè¯¥å½æ°æ§è¡çææä»£ç ã</li>
</ul>
<p>å¦æå·ä½å° Hello World ç¨åºä¸­ï¼<code>[å½æ°åç§°]</code>å¯¹åºçå°±æ¯<code>say_hello</code>ï¼<code>[åæ°åè¡¨]</code>å¨è¿éå°±æ¯ä¸å¯¹å°æ¬å·ä¸­ç<code>name:str</code>ï¼è<code>[åè½è¯´æ]</code>åæ¯æä»¬ä¹åå¨ Python äº¤äºå¼ç»ç«¯ä¸­ä½¿ç¨<code>help</code>å½æ°å±ç¤ºè¿çé£ä¸ªææ¡£å­ç¬¦ä¸²ãæåï¼å¶<code>[å½æ°ä¸»ä½]</code>ä¸­åªæä¸æ¡ç¨äºæå°ææ¬ä¿¡æ¯çè¯­å¥ã</p>
<h3 id="ä½ç¨åä¸å½åç©ºé´">ä½ç¨åä¸å½åç©ºé´</h3>
<p>ä¸ C/C++/Java è¿ç±»å¤§å®¶çæçç¼ç¨è¯­è¨ç¸æ¯ï¼Python è¯­æ³çæå¤§ç¹è²ä¹ä¸å°±æ¯ï¼å®ä¸æ¯ä½¿ç¨å¤§æ¬å·ï¼èæ¯ä½¿ç¨ææ¬ç¼©è¿æ ¼å¼æ¥è¡¨ç¤ºä¸åçä½ç¨åãå æ­¤ï¼æä»¬å¯ä»¥å¨ç¨äºå½æ°å®ä¹çè¯­æ³è§åä¸­çå°ï¼<code>[å½æ°ä¸»ä½]</code>æå¨çåºåä¸<code>def</code>æå¨çè¡ä¹é´å­å¨çåä¸ªç©ºæ ¼çææ¬ç¼©è¿ï¼è¿ä»£è¡¨çå®ä»¬å±äºä¸åçä½ç¨åã<strong>éè¦æ³¨æçæ¯</strong>ï¼è½ç¶å¨ Python çè¯­æ³è§åä¸ï¼å®ä¹ä½ç¨åçç¼©è¿æä½¿ç¨çç©ºæ ¼æ°æ¯å¯åçï¼ä½åä¸çº§ä½ç¨åä½¿ç¨çç¼©è¿å¿é¡»ä¿æç¸åçç©ºæ ¼æ°ï¼å¦åå°±ä¼åºç°éè¯¯ã</p>
<p>å¨åä¸ä¸ªä½ç¨ååï¼æä»¬éå¸¸é½æä¸ä¸ªç¬ç«çåéå½åç©ºé´å¯ä»¥ä½¿ç¨ï¼è¯»èå¯ä»¥å¨å¶ä¸­å®ä¹å¤ä¸ªå±é¨åéï¼å¹¶ç¼åå¤è¡è¯­å¥æ¥æ§è¡ä¸è¿äºåéç¸å³çæä½ï¼å®å¨ä¸å¿æå¿å½åä½ç¨åæä½¿ç¨çåéåä¸æä¸ªå¨å±ä½ç¨åæå¶ä»ä½ç¨åä¸­çåéå²çªãä¾å¦ï¼å¦ææä»¬å¨ä¹åç Hello World ç¨åºä¸­æ°å¢ä¸ä¸ªåä¸º<code>say_hello_to_me</code>çå½æ°ï¼å¹¶å¨è¯¥å½æ°éæ°å®ä¹ä¸ä¸ªåä¸º<code>author_name</code>çåéï¼é£ä¹å®å°±ä¼è¦çæä¹åå®ä¹çå¨å±åé<code>author_name</code>ï¼ä»èä½¿å¾è¯¥å½æ°åé¨çä»£ç å¯ä»¥ä½¿ç¨è¿ä¸ªåéåæ¥å¼ç¨æ°çå¼ï¼å·ä½å¦ä¸ã</p>
<pre><code class="language-python">author_name = "owlman"  # å¨å±åé   

def say_hello(name: str) -&gt; None:
    '''
        Say hello by name.
     
        Args:
            name: name to greet
    '''
    print("Hello World! My name is", name)

def say_hello_to_me() -&gt; None:
    '''
        Say hello to myself.
    '''
    author_name = "lingjie" # å±é¨åé
    say_hello(author_name)

if __name__ == "__main__":
    say_hello(author_name)  # è¾åºï¼Hello World! My name is owlman
    say_hello_to_me()       # è¾åºï¼Hello World! My name is lingjie
</code></pre>
<p>ä¸è¿°ä¿®æ¹çæ§è¡ç»æå¦å¾ 3 æç¤ºï¼è¯»èå¯ä»¥çå°ï¼å¨<code>say_hello_to_me</code>å½æ°ä¸­éæ°å®ä¹ç<code>author_name</code>åéå¹¶æ²¡æå½±åå°å¨å±åéçå¼ã</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202601/691082-20260119121454106-1927985191.png" class="lazyload"></p>
<p><strong>å¾ 3</strong>ï¼Python ä¸­çä½ç¨å</p>
<p>å¨ Python ä¸­ï¼é¤äºå¨å±ä½ç¨ååå±é¨ä½ç¨åä¹å¤ï¼è¿æä¸ç±»ä½ç¨åéå¸¸ç§°ä¸ºâåç½®ä½ç¨åâï¼builtinsï¼ãå®ç± Python çåç½®åç§°ç»æï¼ç±åç½®æ¨¡å builtins æä¾ï¼ï¼ä¾å¦åç½®å½æ° print å°±å±äºè¿ä¸ªä½ç¨åãåç½®åç§°å¨åç§°æ¥æ¾ç LEGB é¡ºåºä¸­ä½äºæåä¸æ­¥ï¼éå¸¸å¯ä»¥å¨ä»»ä½å°æ¹ä½¿ç¨ï¼ä½ä¹å¯ä»¥è¢«å±é¨æå¨å±åååéè¦çï¼shadowï¼ã</p>
<h2 id="å¯¹è±¡ä¸æ°æ®ç±»å">å¯¹è±¡ä¸æ°æ®ç±»å</h2>
<p>ç°å¨ï¼è®©æä»¬ååè¿å¤´æ¥éç¹å³æ³¨ä¸ä¸åéä¸­å¯ä»¥å­å¨çæ°æ®ç±»åãå¨è®¡ç®æºä¸­ï¼å¦æç¨åºæ³è¦å¯¹æä¸ååå­ç©ºé´ä¸­æ°æ®è¿è¡å­å¨åæä½ï¼é¦åè¦æç¡®çæ¯è¯¥ç©ºé´åæ°æ®çå­å¨å½¢å¼åæä½æ¹æ³ãè­¬å¦ï¼åéä¸­å­å¨çæ¯æ°æ®æ¬èº«è¿æ¯æ°æ®å¨åå­ä¸­çä½ç½®ï¼è¿å°å³å®çè¿äºæ°æ®çå¤å¶æ¹å¼ãåè­¬å¦ï¼åéä¸­çæ°æ®å¯ä»¥æ§è¡ä»ä¹æä½ï¼æ¯ç®æ¯è¿ç®è¿æ¯é»è¾å¤æ­ï¼äº¦ææ¯ææ¬å¤çï¼è¿å°±éè¦æä»¬å¯¹è¿äºåå­ç©ºé´ä¸­çæ°æ®ï¼å³åéçå¼è¿è¡å½ç±»ï¼è­¬å¦ç¨æ¥åç®æ¯è¿ç®çæ°æ®å½ä¸ºä¸ç±»ï¼ç¨äºææ¬å¤ççæ°æ®åå½ä¸ºå¦ä¸ç±»ï¼å¨ç¼ç¨æ¯è¯­ä¸ï¼è¿äºå½ç±»è¢«äººä»¬çº¦å®ä¿æå°ç§°ä¹ä¸ºâç±»åï¼typeï¼âãç®èè¨ä¹ï¼å°±æ¯åéä¸­çå¼æå±çç±»åå³å®äºè¯¥åéçå­å¨å½¢å¼åå¶å¯ä»¥æ§è¡çæä½ãä¸é¢ï¼æä»¬å·ä½ä»ç»ä¸ä¸å¨ Python ä¸­å¯ä»¥ä½¿ç¨çæ°æ®ç±»åï¼åä»è¯¥è¯­è¨æ¯æçåºæ¬æ°æ®ç±»åå¼å§ã</p>
<h3 id="åºæ¬æ°æ®ç±»å">åºæ¬æ°æ®ç±»å</h3>
<p>å¨ç¼ç¨è¯­è¨ä¸­ï¼åºæ¬æ°æ®ç±»åæçæ¯è¯­è¨æ¬èº«åç½®çãå¯ä»¥ç´æ¥ä½¿ç¨çæ°æ®ç±»åãPython è¯­è¨ä¸­æ¯æçåºæ¬æ°æ®ç±»åä¸»è¦æä»¥ä¸å­ç§ï¼</p>
<ul>
<li>
<p><strong><code>number</code>ç±»å</strong>ï¼å³æ°å­ç±»åï¼Python ä¸»è¦æ¯æçæ°å­ç±»ååå«æ¯ï¼<code>int</code>ï¼æ´æ°ç±»åï¼ã<code>float</code>ï¼æµ®ç¹ç±»åï¼ã<code>bool</code>ï¼å¸å°ç±»åï¼ã<code>complex</code>ï¼å¤æ°ç±»åï¼ãè¿äºæ°æ®ç±»åå¯ç¨äºæ§è¡åç§æ°å­¦è¿ç®ï¼åæ¬å æ³ãåæ³ãé¤æ³ãæ´é¤ãåä½ãä¹æ³åä¹æ¹ç­ï¼ä¸é¢æ¯ä¸äºæä½ç¤ºä¾ï¼</p>
<pre><code class="language-python">print(3+2)         # å æ³è¿ç®ï¼è¾åºç»ææ¯ 5
print(10.4-3)      # åæ³è¿ç®ï¼è¾åºç»ææ¯ 7.4
print(15/4)        # é¤æ³è¿ç®ï¼è¾åºç»ææ¯ 3.75
print(15//4)       # æ´é¤è¿ç®ï¼è¾åºç»ææ¯ 3
print(15%4)        # åä½è¿ç®ï¼è¾åºç»ææ¯ 3
print(2*3)         # ä¹æ³è¿ç®ï¼è¾åºç»ææ¯ 6
print(2**3)        # ä¹æ¹è¿ç®ï¼è¾åºç»ææ¯ 8
</code></pre>
<p><em>å¼å¾ä¸æçæ¯</em>ï¼Python å¨ 3.x çæ¬ä¹åéç¨äºéåºå®å¤§å°ç<code>int</code>ç±»åï¼è¿è®©å®å¯ä»¥èªå¨éåºä»»æå¤§å°çæ´æ°å¼ï¼å¯ä¸çéå¶æ¯è®¡ç®æºçå¯ç¨åå­éï¼ãå¨å¤çè¾å°çæ´æ°æ¶ï¼Python ä¼ä½¿ç¨è®¡ç®æºåºå±ç<code>int</code>ç±»åæ¥è¡¨ç¤ºå®ä»¬ãå½éè¦å¤çè¾å¤§çæ´æ°æ¶ï¼Python å°±ä¼èªå¨è½¬æ¢ä¸ºå ç¨ä½æ°æ´å¤çè¡¨ç¤ºå½¢å¼ãå½ç¶ï¼ä¸ºäºè½å¯¹è¾å¤§çæ´æ°å¼æ§è¡è¿ç®ï¼Python å¿é¡»è¦å°è¿äºè¿ç®æè§£æè¥å¹²ä¸ªè½ç´æ¥äº¤ç»è®¡ç®æºç¡¬ä»¶å¤ççå°åè¿ç®ååï¼å¶æè§£è¿ç¨ä¸æä»¬ç¨ç¬ç®çæ¹å¼æ¥è¿è¡é¿é¤æ³è¿ç®éå¸¸ç±»ä¼¼ãå°½ç®¡è¿ç§è¿ç®æ¹å¼çæçå¹¶ä¸é«ï¼å ä¸ºè¿éè¦æ§è¡æ´å¤æ­¥éª¤ï¼ï¼ä½æ¯å®ä»¬åè®¸ Python å°<code>int</code>ç±»åæ©å±è³ä»»æå¤§å°ã</p>
</li>
<li>
<p><strong><code>string</code>ç±»å</strong>ï¼å³å­ç¬¦ä¸²ç±»åãå¨ Python è¯­è¨ä¸­ï¼å­ç¬¦ä¸²ç±»åçæ°æ®å°±æ¯ç±ä¸å¯¹åå¼å·ãåå¼å·æä¸å¼å·æ¬ä½çä¸æ®µææ¬ä¿¡æ¯ï¼è¿æ®µææ¬ä¸­ææçç©ºæ ¼åå¶è¡¨ç¬¦é½ç§åæ ·ä¿çãå¨ä¸ç§å­ç¬¦ä¸²çè¡¨ç¤ºæ¹å¼ä¸­ï¼åå¼å·ä¸åå¼å·çä½ç¨å¨å¤§å¤æ°æ¶åæ¯ä¸æ ·çï¼åªæå½å­ç¬¦ä¸²æ¬èº«çåå®¹ä¸­åå«åå¼å·æ¶ï¼å®å°±åªè½ç¨åå¼å·æä¸å¼å·æ¥è¡¨ç¤ºãèä¸å¼å·åéå¸¸ç¨äºè¡¨ç¤ºåå«å¤è¡æå­çå­ç¬¦ä¸²ï¼åæ ·çï¼æä»¬ä¹å¯ä»¥å¨ä¸å¼å·ä¸­èªç±ä½¿ç¨åå¼å·ååå¼å·ãå¨ç¼ç¨æ´»å¨ä¸­ï¼å­ç¬¦ä¸²ç±»åçæ°æ®ä¸»è¦ç¨äºæ§è¡åç§ææ¬å¤çæä½ï¼åæ¬ææ¬çè¾å¥ãè¾åºãå­å¨ãæ¼æ¥åæªåç­ï¼ä¸é¢æ¯ä¸äºæä½ç¤ºä¾ï¼</p>
<pre><code class="language-python">name = "lingjie"                   # å­å¨ä¸è¬çå­ç¬¦ä¸²æ°æ®
I_am = "I'm "                      # å­å¨å¸¦åå¼å·çå­ç¬¦ä¸²æ°æ®
other = '''
age:  42
job: writer
'''                                # å­å¨å¤è¡å­ç¬¦ä¸²æ°æ®
message = I_am + name + other      # æ¼æ¥å­ç¬¦ä¸²æ°æ®å¹¶å­å¨

print(message)                     # è¾åºåé message ä¸­å­å¨çå­ç¬¦ä¸²æ°æ®
print(message[0:11])               # æªååéä¸­çæä¸æ®µå­ç¬¦ä¸²å¹¶è¾åº
print(r"Newlines are indicated by \n") # å¿½ç¥å­ç¬¦ä¸²ä¸­çè½¬ä¹å­ç¬¦å¹¶è¾åº
</code></pre>
<p>å¦å¤ï¼å¦æè¯»èæ³è¦è®© Python è¿è¡æ¶ç¯å¢å¿½ç¥å­ç¬¦ä¸²æ°æ®ä¸­ææçè½¬ä¹å­ç¬¦ï¼ä¹å¯ä»¥å¨è¡¨ç¤ºå­ç¬¦ä¸²çåå¼å·æåå¼å·ä¹åå ä¸ä¸ªåç¼<code>r</code>ãä¾å¦å¨ä¸é¢çæåä¸è¡ä»£ç ä¸­ï¼å¦ææä»¬å¸æçæ¯åæ ·è¾åºä¸é¢å­ç¬¦ä¸²ä¸­çæ¢è¡ç¬¦<code>\n</code>ï¼èä¸æ¯è®©å®åæ¥æ¢è¡ææã</p>
</li>
<li>
<p><strong><code>list</code>ç±»å</strong>ï¼å³åè¡¨ç±»åãå¨ Python è¯­è¨ä¸­ï¼åè¡¨ç±»åçæ°æ®å°±æ¯ç±ä¸å¯¹ä¸­æ¬å·æ¬ä½çå¯¹è±¡åºåï¼åºåä¸­çè¿äºå¯¹è±¡å½¼æ­¤ä¹é´éç¨éå·éå¼ï¼éå¸¸è¢«ç§°ä¸ºåè¡¨çåç´ ãè¿äºåç´ å¯ä»¥æ¯ Python æ¯æçä»»ææ°æ®ç±»åï¼æ¢å¯ä»¥æ¯è¿éæ­£å¨ä»ç»çå­å¤§åºæ¬æ°æ®ç±»åï¼ä¹å¯ä»¥æ¯æä»¬ç¨åè¦ä»ç»çèªå®ä¹ç±»åï¼æèéè¿å¼å¥ç¬¬ä¸æ¹åºè·å¾çæ©å±æ°æ®ç±»åãå¨åºäº Python çç¼ç¨ä¸­ï¼åè¡¨ç±»åçæ°æ®å¯ç¨äºæ§è¡éå¯¹ä¸æ´ä¸ªåç´ åºåçç¸å³æä½ï¼ä¾å¦ææ¹éå°æ§è¡å¢ãå ãæ¹ãæ¥ä»¥åæåºç­æä½ï¼ä¸é¢æ¯ä¸äºæä½ç¤ºä¾ï¼</p>
<pre><code class="language-python">list_1 = [                  # å°ä¸ä¸ªä¸åç±»åçæ°æ®å­å¨ä¸ºåè¡¨çåç´ 
    10,                     # åè¡¨çç¬¬ä¸ä¸ªåç´ ä¸ºæ°å­ç±»åçæ°æ®
    "string data",          # åè¡¨çç¬¬äºä¸ªåç´ ä¸ºå­ç¬¦ä¸²ç±»åçæ°æ®
    [1, 2, 3]               # åè¡¨çç¬¬ä¸ä¸ªåç´ ä¸ºåè¡¨ç±»åçæ°æ®
]
print(list_1)               # è¾åºåè¡¨ä¸­çææåç´ 
print(list_1[1])            # è¾åºç´¢å¼å¼ä¸º 1 çåç´ 
print(list_1[0:2])          # ä½¿ç¨åçæä½æå®è¦è¾åºçåè¡¨å­åºå
# è¯·æ³¨æï¼åè¡¨çç´¢å¼å¼æ¯ä» 0 å¼å§çï¼æä»¥è¿éè¾åºçæ¯ç¬¬äºä¸ªåç´ 
list_1[0] = 100             # å°ç´¢å¼å¼ä¸º 0 çåç´ ä¿®æ¹ä¸º 100
list_1.remove([1,2,3])      # æ¾å°å¹¶å é¤åè¡¨ä¸­çç¬¬ä¸ä¸ªåç´ 
print(list_1)               # éæ°è¾åºåè¡¨ä¸­çææåç´ 
list_1.append([7, 8, 9])    # å¨åè¡¨æ«å°¾éæ°æ·»å åç´ 
print(list_1)               # éæ°è¾åºåè¡¨ä¸­çææåç´ 
</code></pre>
</li>
<li>
<p><strong><code>tuple</code>ç±»å</strong>ï¼å³åç»ç±»åãå¨ Python è¯­è¨ä¸­ï¼åç»ç±»åçæ°æ®å¯ä»¥è¢«è§ä¸ºä¸ä¸ªåªè¯»çåè¡¨ãåç»ä¸­çåç´ ä¹å¯ä»¥æ¯ä»»æç±»åçæ°æ®ï¼è¿äºåç´ ä¼è¢«æ¾ç½®å¨ä¸å¯¹å°æ¬å·ä¸­ï¼å¹¶ç¨éå·éå¼ãç±äºåç»ä¸­çåç´ æ¯ä¸å¯ä¿®æ¹çï¼æä»¥è¯¥æ°æ®ç±»åéå¸¸ç¨äºæ§è¡ä¸æ¬¡æ§çæ¹éæ°æ®å­å¨ä»¥ååç§æ¥æ¾ãéåç­åªè¯»æä½ï¼ä¸é¢æ¯ä¸äºæä½ç¤ºä¾:</p>
<pre><code class="language-python">tuple_1 = ("abcd", 706, "lyy", 898, 5.2)    # å°ä¸äºæ°æ®å­å¨ä¸ºåç»çåç´ 
print(tuple_1)                              # è¾åºåç»ä¸­çææåç´ 
print(tuple_1[0])                           # è¾åºç´¢å¼å¼ä¸º 0 çåç´  
print(tuple_1[1:3])                         # ä½¿ç¨åçæä½æå®è¦è¾åºçåç»å­åºå
</code></pre>
</li>
<li>
<p><strong><code>set</code>ç±»å</strong>ï¼å³éåç±»åãå¨ Python è¯­è¨ä¸­ï¼éåç±»åçæ°æ®å¯ä»¥è¢«è§ä¸ºä¸ä¸ªåç´ ä¸è½éå¤çåè¡¨ãéåä¸­çåç´ è¢«æ¾ç½®å¨ä¸å¯¹å¤§æ¬å·ä¸­ï¼å¹¶ç¨éå·éå¼ãå½ç¶ï¼èèå°<code>{}</code>åæ¶ä¹æ¯ç¨åè¦ä»ç»çå­å¸ç±»åæä½¿ç¨çç¬¦å·ï¼ç©ºéåå°±éè¦è°ç¨<code>set()</code>å½æ°æ¥å®æåå§åäºãç±äºéåä¸­çåç´ æ¯ä¸è½éå¤çï¼æä»¥è¯¥æ°æ®ç±»åéå¸¸ç¨äºå¨æ§è¡æ°æ®å­å¨æ¶éè¦å é¤åä½æ°æ®çæä½ï¼ä¸é¢æ¯ä¸äºæä½ç¤ºä¾ï¼</p>
<pre><code class="language-python">set_0 = set()               # ç©ºéåéè¦éè¿è°ç¨ set() æ¥å®æåå§å
set_1 = {18,19,18,20,21,20} # å¦æå­å¨å°éåä¸­çåç´ å­å¨éå¤
print(set_1)                # æä»¬å°±ä¼çå°ç¸åçåç´ åªä¼è¢«ä¿çä¸ä¸ª
</code></pre>
</li>
<li>
<p><strong><code>dictionary</code>ç±»å</strong>ï¼å³å­å¸ç±»åãå¨ Python è¯­è¨ä¸­ï¼å­å¸ç±»åçæ°æ®å¯ä»¥è¢«è§ä¸ºä¸ä¸ªåç´ ä¸º<code>[é®]:[å¼]</code>ç»æçåè¡¨ãå­å¸ä¸­çæ¯ä¸ªåç´ é½å¿é¡»æ¯ä¸ä¸ª<code>[é®]:[å¼]</code>ç»æçæ°æ®ï¼å®ä»¬å°ä¼è¢«æ¾ç½®å¨ä¸å¯¹å¤§æ¬å·ä¸­ï¼å¹¶ç¨éå·éå¼ãè¯¥æ°æ®ç±»åéå¸¸ç¨äºæ§è¡ä¸äºé®å¼æ¥æ¾ç¸å³çæä½ï¼ä¸é¢æ¯ä¸äºæä½ç¤ºä¾ï¼</p>
<pre><code class="language-python">map_1 = { # å°ä¸¤ä¸ª[é®]:[å¼]ç»æçæ°æ®å­å¨ä¸ºå­å¸çåç´ 
    "name" : "lingjie",    # name æ¯é®ï¼lingjie æ¯å¼
    "age" : "25"           # age æ¯é®ï¼25 æ¯å¼
}
print(map_1)               # è¾åºå­å¸ä¸­çææåç´ 
map_1["sex"] = "boy"       # æ·»å ä¸ä¸ªé®ä¸º sexï¼å¼ä¸º boy çåç´  
print(map_1)               # éæ°è¾åºå­å¸ä¸­çææåç´ 

# å¦ææ³å é¤å­å¸ä¸­çæå®åç´ æ¶ï¼å¯ä»¥ä½¿ç¨ del è¯­å¥æ¥å®æ
del map_1["age"]           # å é¤é®ä¸º age çåç´ 
print(map_1)               # éæ°è¾åºå­å¸ä¸­çææåç´ 
</code></pre>
</li>
</ul>
<h3 id="èªå®ä¹ç±»å">èªå®ä¹ç±»å</h3>
<p>é¤äºä¸è¿°åºæ¬æ°æ®ç±»åä¹å¤ï¼Python è¯­è¨è¿æ¯æç¨åºåéè¿èªå®ä¹ç±»åçæ¹å¼æ¥å¼å¥æ´å¤æçæ°æ®ç±»åï¼ä»¥ä¾¿è·å¾æ´å¼ºå¤§çè¡¨è¾¾è½åãåç»å¤§å¤æ°æ¯æé¢åå¯¹è±¡çç¼ç¨è¯­è¨ä¸æ ·ï¼è¿ä¸æ©å±å¯ç¨æ°æ®ç±»åçè½åæ¯éè¿ä¸ç§å«åâç±»å®ä¹âçè¯­å¥æ¥å®æçï¼è¯¥è¯­å¥çè¯­æ³è§åå·ä½å¦ä¸ã</p>
<pre><code class="language-python">class [ç±»ååç§°]([ç¶ç±»]):
    '''
    [ç±»åçåè½è¯´æ]
    '''
    [ç±»åçå±æ§åæ¹æ³]
</code></pre>
<p>å¨é¢åå¯¹è±¡è®¾è®¡çæ¦å¿µä¸­ï¼âç±»âå¯ä»¥è¢«è§ä¸ºæ¯å¯¹æä¸ç§æ°æ®ç±»åçç»ææè¿°ãè¿ç§æè¿°éå¸¸æ¯æ½è±¡çï¼Python è§£éå¨éè¦è´è´£å°è¯¥æ½è±¡æè¿°å·ç°åä¸ºåå­ä¸­å®éå¯æä½çæ°æ®ï¼è¿ä¸è¿ç¨è¢«ç§°ä¸ºâå®ä¾åâï¼å®ä¾åçç»æåè¢«ç§°ä¸ºè¯¥ç±»åçâå®ä¾âæâå¯¹è±¡âãèè¿ç§æ½è±¡åçæè¿°éå¸¸ä¸»è¦ç± <strong>å±æ§</strong> å <strong>æ¹æ³</strong> ä¸¤é¨åç»æãå¨äºè§£äºè¿äºæ¦å¿µä¹åï¼æä»¬å°±å¯ä»¥å¼å§å¯¹ä¸è¿°è¯­æ³è§ååä¸ä¸ªå·ä½çè§£éäºã</p>
<p>å¨ Python ä¸­ï¼ç±»å®ä¹è¯­å¥éå¸¸ä¼ä»¥<code>class</code>å³é®å­å¼å¤´ãç´§æ¥çï¼æä»¬éè¦ä¸ºå¶æå®ä¸ä¸ª<code>[ç±»ååç§°]</code>ï¼èªå®ä¹ç±»åçå½åè§åä¸åéæ¯å®å¨ä¸è´çï¼åªä¸è¿å¨ä¹ æ¯ä¸ï¼æä»¬éå¸¸ä¼éæ©é¦å­æ¯å¤§åçåç§°ãåæ¥çæ¯éè¦å¨ä¸å¯¹å°æ¬å·ä¸­æå®å½åç±»åç»§æ¿èªåªä¸ä¸ª<code>[ç¶ç±»]</code>ï¼å¨ Python 3.x ä¸­ï¼ææèªå®ä¹çç±»åé½ä¼é»è®¤ç»§æ¿èª<code>object</code>ç±»ï¼æä»¥å¦ææ²¡æç¹å«æå®çç¶ç±»ï¼è¿éå¶å®æ¯å¯ä»¥çç¥çãåæ¥ä¸æ¥ï¼<code>[ç±»åçåè½è¯´æ]</code>çé¨åå¶å®å°±æ¯ç¨äºæè¿°è¯¥ç±»åçææ¡£å­ç¬¦ä¸²ï¼æä»¬å¯ä»¥ç¨å®å¯¹è¯¥ç±»åçè®¾è®¡æå¾åä¸ªè¯´æï¼åæ¬è¯¥ç±»åå¨è¢«å®ä¾åæ¶æéçåæ°ãè¯¥ç±»åææ¥æçå±æ§ä»¥åå¯æ§è¡çæä½ç­ãæåï¼æä»¬å°±å¯ä»¥å¼å§å®ä¹<code>[ç±»åçå±æ§åæ¹æ³]</code>äºã</p>
<p>ç±»åçå±æ§éå¸¸æçæ¯å¯ä»¥å­å¨å¨è¯¥ç±»åå¶å®ä¾ä¸­çæ°æ®ï¼ä¾å¦ï¼å¦ææä»¬æ³èªå®ä¹ä¸ä¸ªè¡¨ç¤ºâä¹¦âè¿ä¸ªæ¦å¿µçèªå®ä¹ç±»åï¼å®çä¹¦åãä½èãåºçç¤¾ç­å­æ°æ®é½å±äºâä¹¦âè¿ä¸ªç±»åçå±æ§ãå·ä½å°äº Python è¿é¨ç¼ç¨è¯­è¨ä¸­ï¼èªå®ä¹ç±»åçå±æ§åæ¬å®ä¾å±æ§ä¸ç±»å±æ§ä¸¤ç§ï¼å®ä»¬çä¸»è¦åºå«å¦ä¸ã</p>
<ul>
<li>
<p>å¨æ°æ®çå½å±é®é¢ä¸ï¼å®ä¾å±æ§ä¸­çæ°æ®ç±è¯¥ç±»åçæ¯ä¸ªå®ä¾åèªæ¥æï¼ç¸äºç¬ç«ï¼èç±»å±æ§ä¸­çæ°æ®æä¸åªæä¸ä»½ï¼ç±è¯¥ç±»åçææå®ä¾å±æçå±æ§ãä¹å°±æ¯è¯´ï¼ç±»å±æ§å¯ä»¥ç´æ¥éè¿<code>[ç±»ååç§°]</code>æ¥è®¿é®çæ°æ®ï¼èå®ä¾å±æ§åæ¯éè¦åå°ç±»åå®ä¾åæå·ä½çå¯¹è±¡ï¼ç¶åéè¿è¯¥å¯¹è±¡æè½è®¿é®çæ°æ®ã</p>
</li>
<li>
<p>å±æ§çå®ä¹æ¹å¼ä¸ï¼å®ä¾å±æ§éè¦å¨ä¸ä¸ªåä¸º<code>__init__()</code>ç¹æ®æ¹æ³ä¸­éè¿<code>self</code>è¿ä¸ªå³é®å­æ¥å®ä¹ï¼è¯¥æ¹æ³ä¼å¨ç±»åè¢«å®ä¾åæ¶è¢«èªå¨è°ç¨ï¼å¹¶å¯¹è¯¥å±æ§æ§è¡åå§åæä½ï¼å®ä¾å±æ§çå®ä¹å°±å±äºè¯¥åå§åæä½çä¸é¨åãèç±»å±æ§çå®ä¹åªéå¨ä¸è¿°è¯­æ³è§èä¸­<code>[ç±»åçå±æ§åæ¹æ³]</code>æå¨çç¼©è¿åºåæ§è¡åéæ·»å æä½å³å¯ï¼æ²¡æç¹å®çä½ç½®ãä¾å¦ï¼å¦ææä»¬æ³ä¸ºä¹åè®¨è®ºçâä¹¦âè¿ä¸ªç±»åæ·»å ä¸ä¸ªåä¸º<code>help</code>çç±»å±æ§åä¹¦åãä½èãåºçç¤¾ç­å®ä¾å±æ§ï¼æä»¬å¯ä»¥åä¸é¢è¿æ ·æ¥å®ä¹å®ä»¬ã</p>
</li>
</ul>
<pre><code class="language-python">class Book:
    help = '''è¿éå®ä¹çæ¯ä¸ä¸ªç±»å±æ§ã'''

    def __init__(self, book_data):
        # è¿éå°å®ä¹ä¸ä¸ªå®ä¾å±æ§ï¼
        self.name = book_data["name"]
        self.author = book_data["author"]
        self.pub = book_data["pub"]
</code></pre>
<p>å¨ä¸è¿°ä»£ç ä¸­ï¼<code>__init__</code>å°±æ¯è¯¥èªå®ä¹ç±»åçä¸ä¸ªæ¹æ³ãå¨é¢åå¯¹è±¡çæ¦å¿µä¸­ï¼ç±»åçæ¹æ³éå¸¸æçæ¯è¯¥ç±»åå¯ä»¥æ§è¡çæä½ãæä»¬å¯ä»¥ä½¿ç¨<code>def</code>å³é®å­å¨ä¸è¿°è¯­æ³è§èä¸­<code>[ç±»åçå±æ§åæ¹æ³]</code>æå¨çç¼©è¿åºåä¸ºèªå®ä¹çç±»åæ·»å æ¹æ³ãå·ä½æ·»å æ¹å¼ä¸ä¹åä»ç»çå½æ°å®ä¹è¯­å¥æ¯ä¸æ ·çï¼åªä¸è¿å¨å®ä¹æ¹æ³æ¶éè¦è®°ä½ä¸ç¹ï¼<strong>å®çåæ°åè¡¨ä¸­å¿é¡»è¦æä¸ä¸ªåä¸º<code>self</code>çåæ°ï¼ä¸å¿é¡»æ¯ç¬¬ä¸ä¸ªåæ°</strong>ãè¿ä¸ª<code>self</code>åæ°ç¨äºææ¶å½åè¢«ç§°ä½çå®ä¾ï¼å®å¯ä»¥è®©æä»¬å¨æ¹æ³ä¸­è®¿é®è¯¥å®ä¾çå±æ§åå¶ä»æ¹æ³ãä¸é¢æ¯ä¸ä¸ªç¤ºä¾ï¼å±ç¤ºäºå¦ä½ä¸ºä¹åçâä¹¦âç±»åæ·»å ä¸ä¸ªåä¸º<code>update_name</code>çæ¹æ³ï¼ç¨äºä¿®æ¹ä¹¦åã</p>
<pre><code class="language-python">class Book:
    help = '''è¿æ¯ä¸ä¸ªç±»å±æ§ï¼ç¨äºæä¾å½åç±»å¸®å©ä¿¡æ¯ã'''

    def __init__(self, book_data):
        self.name = book_data["name"]
        self.author = book_data["author"]
        self.pub = book_data["pub"]

    def update_name(self, new_name):
        '''ä¿®æ¹ä¹¦åçæ¹æ³'''
        self.name = new_name
</code></pre>
<p>å¼å¾ä¸æçæ¯ï¼è½ç¶<code>__init__()</code>æ¹æ³å¨ä½¿ç¨æ¹å¼ä¸ä¸ä¼ ç»é¢åå¯¹è±¡ç¼ç¨è¯­è¨ä¸­çæé å½æ°éå¸¸ç±»ä¼¼ï¼ä½å®å¶å®åªæ¯ä¼è¢«æé å½æ°èªå¨è°ç¨çåå§åæ¹æ³ï¼è Python ä¸­çæ­£çæé å½æ°æ¯å¦ä¸ä¸ªåä¸º<code>__new__()</code>çç¹æ®æ¹æ³ãåªä¸è¿å¨å¤§å¤æ°æåµä¸ï¼æä»¬æ¯ä¸éè¦éæ°å®ä¹æé æ¹æ³çï¼å®ä¹å¥½åå§åæ¹æ³å°±è¶³å¤äºãä¸ä¹ç¸å¯¹å°ï¼å¦ææä»¬éè¦å¨éæ¯ä¸ä¸ªèªå®ä¹ç±»åçå®ä¾æ¶éè¦æ§è¡æäºæå®çæä½ï¼å°±éè¦éè¿å®ä¹å¦ä¸ä¸ªåä¸º<code>__del__()</code>çç¹æ®æ¹æ³æ¥å®ç°ãå½ç¶ï¼èèå°è¯¥æ¹æ³åªä¼å¨æä»¬æ¾å¼è°ç¨<code>del</code>æä½ç¬¦æ Python çåå¾åæ¶æºå¶éæ¯ç¸å³å®ä¾æ¶æä¼è¢«è°ç¨ï¼èåå¾åæ¶éæ¯å®ä¾çæ¶æºæ¯ä¸ç¡®å®çï¼æå¹¶ä¸å»ºè®®è¯»èå¨éå¿è¦çæåµä¸å»å®ä¹è¿ä¸ªæ¹æ³ï¼å®ä¸è¬åªä¼å¨éè¦æå¨éæ¾æäºéè¦çè¿è¡æ¶èµæºæ¶æä¼è¢«å®ä¹ãä¸é¢ï¼è®©æä»¬æ¥å®æ´å°å±ç¤ºä¸ä¸å¨ Python è¯­è¨ä¸­èªå®ä¹ä¸ä¸ª<code>Book</code>ç±»çå¨é¨ä»£ç ï¼</p>
<pre><code class="language-python">class Book:
    help = '''è¿æ¯ä¸ä¸ªç±»å±æ§ï¼ç¨äºæä¾å½åç±»å¸®å©ä¿¡æ¯ã'''
    
    def __init__(self, book_data):
        '''
        å®ä¹ Book ç±»çåå§åæ¹æ³ï¼è¯¥æ¹æ³éè¦å®ä¹ä»¥ä¸ä¸¤ä¸ªåæ°ï¼
            selfï¼è¿æ¯åå§åæ¹æ³å¿é¡»è¦æçåæ°ï¼
                ç¨äºææ¶å°è¢«åå§åçå®ä¾ï¼
            book_dataï¼è¿æ¯å­å¸ç±»åçæ°æ®å¯¹è±¡ï¼
                    ç¨äºæä¾åå§åæ¶æè¦æä¾çæ°æ®ï¼
        '''
        # å®ä¹ä¸ä¸ªå®ä¾å±æ§ï¼
        self.name = book_data["name"]
        self.author = book_data["author"]
        self.pub = book_data["pub"]
    
    def update_name(self, new_name) :
        '''
        å®ä¹ Book ç±»ä¸­ç¨äºä¿®æ¹ä¹¦åçæ¹æ³ï¼å®éè¦å®ä¹ä»¥ä¸ä¸¤ä¸ªåæ°ï¼
            selfï¼ç¨äºææ¶å½åè¢«ç§°ä½çå®ä¾ï¼
            new_nameï¼ç¨äºæå®æ°ä¹¦åçå­ç¬¦ä¸²å¯¹è±¡ï¼
        '''

        self.name = new_name

    def __del__(self):
        '''
        å®ä¹ Book ç±»ä¸­ç¨äºéæ¯å®ä¾çæ¹æ³ï¼å®éè¦å®ä¹ä»¥ä¸åæ°ï¼
            selfï¼ç¨äºææ¶å½åè¢«ç§°ä½çå®ä¾ï¼
        '''
        print("delete ", self.name)        
</code></pre>
<p>å¨å®æèªå®ä¹ç±»åçå¨ä½ä¹åï¼æä»¬å°±å¯ä»¥å¯¹è¯¥ç±»åè¿è¡å®ä¾åå¹¶ä»ç»ç¸å³æä½äºãä¾å¦ï¼æä»¬å¨ä¸é¢ä»¥<code>Book</code>ç±»ä¸ºä¾ï¼æ¼ç¤ºäºå¦ä½æ¥çè¯¥ç±»çå¸®å©ä¿¡æ¯ãåå»ºä¸ä¸ªå®ä¾ãä¿®æ¹ä¹¦åä»¥åéæ¯å®ä¾ç­æä½ã</p>
<pre><code class="language-python"># éè¿ç±»å±æ§æ¥æ¥ç Book ç±»æä¾çå¸®å©ä¿¡æ¯ï¼
print(Book.help)
# åå»ºå®ä¾ï¼
my_book = Book({
    "name" : "Python å¿«éå¥é¨",
    "author" : "lingjie",
    "pub" : "äººæ°é®çµåºçç¤¾" 
})
# ä¿®æ¹ä¹¦åï¼
my_book.update_name("Python 3 å¿«éå¥é¨")
# éæ¯å®ä¾ï¼è¿éåªåæ¼ç¤ºä¹ç¨ï¼ä¸å»ºè®®æå¨éæ¯å®ä¾ï¼ï¼
del my_book
</code></pre>
<h2 id="è¡¨è¾¾å¼ä¸è¯­å¥">è¡¨è¾¾å¼ä¸è¯­å¥</h2>
<p>ä¼æå¨ç¥ï¼è®¡ç®æºç¨åºæ¬è´¨ä¸å°±æ¯ä¸ç»ç¨æä¸é¨ç¼ç¨è¯­è¨ç¼åèæçæä»¤åºåï¼äººç±»ç¨è¿é¨è¯­è¨è¡¨è¾¾èªå·±çæå¾ï¼èè®¡ç®æºåå©ç¨è¿é¨è¯­è¨çè§£éå¨æç¼è¯å¨çè§£äººç±»çæå¾ï¼å¹¶å°è¯¥æå¾è½¬æ¢ææºå¨æä»¤å¹¶æ§è¡å®ãæä»¥ï¼ç¨åºåçä»»å¡å°±æ¯è¦å­¦ä¼ç¨ç¼ç¨è¯­è¨æ¥è¡¨è¿°èªå·±çæå¾ãåææçè¯­è¨ä¸æ ·ï¼äººä»¬è¡¨è¿°æå¾çåºæ¬ååéå¸¸è¢«ç§°ä¸ºâè¯­å¥âãæä»¬å¨ä¸ä¸èä¸­å­¦ä¹ çåéåå¶æ°æ®ç±»åå°±ç¸å½äºäººç±»è¯­è¨ä¸­çâåè¯âåâå¨è¯âï¼å®ä»¬æè¡¨è¾¾çæ¯ç¨åºè¦è½½å¥å°åå­ä¸­çæ°æ®åå¶å¯æ§è¡çæä½ï¼èç°å¨å°±æ¯è¦å­¦ä¹ å¦ä½æç§èªå·±çæå¾å°è¿äºâåè¯âåâå¨è¯âç»ç»ææ§å¶ç¨åºæµç¨çâè¯­å¥âäºãä¸é¢ï¼è®©æä»¬ä»æåºæ¬çè¡¨è¾¾å¼è¯­å¥å¼å§ä»ç»ã</p>
<h3 id="è¡¨è¾¾å¼ä¸èµå¼">è¡¨è¾¾å¼ä¸èµå¼</h3>
<p>æ è®ºæä»¬ä½¿ç¨çæ¯äººç±»è¯­è¨è¿æ¯è®¡ç®æºç¼ç¨è¯­è¨ï¼ç¼åè¯­å¥çç¬¬ä¸æ­¥æ¯è¦æç¡®èªå·±è¦è¡¨è¾¾çåå®¹ãè¯¥åå®¹å¯ä»¥æ¯æ§è¡æä¸ªå¨ä½ï¼ä¹å¯ä»¥æ¯åç°æä¸ªç¶æãå½ç¶ï¼å¨æ²¡æä¹ æ¯ç¨ Python è¯­è¨è¡¨è¾¾èªå·±æå¾ä¹åï¼ä¸å¦¨åç¨èªå·±çæçäººç±»è¯­è¨å°è¦è¡¨è¾¾çåå®¹ååºæ¥ï¼ç¶ååè¯çå°å¶ç¿»è¯æç¼ç¨è¯­è¨ãä¸¾ä¸ªä¾å­ï¼å¦ææä»¬æ³ç¨èªç¶è¯­è¨æ¥æè¿°å°äººæ°å¸çå¸å¼æ¢ç®æç¾åçè¿ç¨ï¼éå¸¸ä¼ç¨ä»¥ä¸ä¸ä¸ªç­å¥æ¥æè¿°å¶å·ä½è¦æ§è¡çæ­¥éª¤ï¼</p>
<ul>
<li>åè·åäººæ°å¸çå¸å¼ï¼100ã</li>
<li>ååå¾äººæ°å¸å¯¹ç¾åçæ±çï¼0.1404ã</li>
<li>å°äººæ°å¸çå¸å¼ä¹ä»¥æ±çï¼å³ä¸ºç¾åå¸å¼ã</li>
</ul>
<p>ä¸é¢ï¼è®©æä»¬åç¨ Python è¯­è¨æ¥ç¿»è¯ä¸ä¸ä¸é¢è¿ä¸ä¸ªç­å¥ï¼</p>
<pre><code class="language-python">CNY = 100
ex_rate = 0.1404
USD = CNY * ex_rate
</code></pre>
<p>ä¸è¿°ä»£ç ä¸­åºç°äºä¸æ¡ Python è¯­å¥ãå®ä»¬é½æ¯éæç§<code>[åéåç§°] = [è¡¨è¾¾å¼])</code>è¿æ ·çè¯­æ³è§åç¼åèæï¼ä¸»è¦ä½ç¨æ¯å°èµå¼æä½ç¬¦ï¼<code>=</code>ï¼å³ä¾§çè¡¨è¾¾å¼èµç»å·¦ä¾§çåéï¼éå¸¸è¢«ç§°ä¸º<strong>èµå¼è¯­å¥</strong>ãå¦å¤ï¼å¦æè¢«èµå¼ç<code>[åéåç§°]</code>æ¯ç¬¬ä¸æ¬¡åºç°å½åä½ç¨åä¸­çè¯ï¼å®ä»¬åæ¶ä¹åå½äºåéå®ä¹è¯­å¥çè§è²ãå¨è¿ç±»è¯­å¥ä¸­ï¼åéè¢«èµäºçå¼åå¶æ°æ®ç±»åå°±åå³äºèµå¼æä½ç¬¦å³ä¾§çè¡¨è¾¾å¼äºãå¦å¤å¨ Python ä¸­ï¼éå¸¸ä¸ä¸ªé»è¾è¡ä»£è¡¨çä¸æ¡ç¬ç«çè¯­å¥ãå¦ææä¸æ¡èµå¼è¯­å¥å å³ä¾§çè¡¨è¾¾å¼è¿é¿èå½±åäºä»£ç çå¯è¯»æ§ï¼ä»£ç ç¼è¾å¨å¯è½ä¼å¯¹å¶è¿è¡èªå¨æ¢è¡ï¼ä½å®å¨ Python è¿è¡æ¶ç¯å¢çæ¥ä¾ç¶å±äºåä¸é»è¾è¡ãä¾å¦ï¼æä»¬å¯ä»¥å¯¹ä¹åç<code>say_hello</code>å½æ°åä¸äºä¿®æ¹ï¼è®©å®è¾åºçåå®¹ä¸°å¯ä¸äºã</p>
<pre><code class="language-python">def say_hello(name):
    # çç¥ä¹åçä»£ç 
    message = "\nThis is an object-oriented,open-source programming language often used for rapid application development.Python's simple syntax emphasizes readability,reducing the cost of program maintenance, while its large library of functions and calls encourages reuse and extensibility."
    print(message)
</code></pre>
<p>ä¸è¿°ä»£ç å¨ VS Code ç¼è¾å¨ä¸­çæ¾ç¤ºææå¦ä¸å¾æç¤ºï¼è¯»èå¯ä»¥çå°ï¼æä»¬å¨<code>say_hello</code>å½æ°çä½ç¨åä¸­æ°å¢äºä¸ä¸ªåä¸º<code>message</code>çåéï¼ç»å®èµå¼äºä¸ä¸ªæ¯è¾é¿çå­ç¬¦ä¸²ï¼è½ç¶ç¼è¾å¨å°å¶èªå¨æ¢è¡æäºä¸è¡åå®¹ï¼ä½å®ä»¬å¨é»è¾ä¸ä¾ç¶è¢«è§ä¸ºåä¸è¡åå®¹æ¥è¾åºçï¼å¦å¾ 4 æç¤ºã</p>

<p><img alt="img" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202601/691082-20260119122055490-241848591.png" class="lazyload"></p>
<p><strong>å¾ 4</strong>ï¼Python ä¸­çé»è¾è¡ä¸ç¼è¾å¨çèªå¨æ¢è¡</p>
<p>å¨ç¼ç¨è¯­è¨ä¸­ï¼<strong>è¡¨è¾¾å¼</strong>éå¸¸æ¯ç±ä¸ä¸ªæå¤ä¸ªåéåè¿ç®ç¬¦ï¼ææä½ç¬¦ï¼ç»åèæï¼ä¸»è¦ä½ç¨æ¯æ§è¡æç§è®¡ç®æé»è¾å¤æ­ï¼å¹¶è¿åä¸ä¸ªç»æãè¡¨è¾¾å¼å¯ä»¥æ¯ç®åçï¼ä¹å¯ä»¥æ¯å¤æçï¼å·ä½åå³äºå®ä»¬åå«çè¿ç®ç¬¦ææä½ç¬¦ãä¸é¢ï¼è®©æä»¬æ¥å¯¹ç¼ç¨ä¸­ä¼ç¨å°çè¡¨è¾¾å¼åä¸ä¸ªç®åçæ´çã</p>
<ul>
<li>
<p><strong>å¸¸éè¡¨è¾¾å¼</strong>ï¼ è¿ç§è¡¨è¾¾å¼éå¸¸å°±æ¯æä¸æ°æ®ç±»åçå­é¢å¸¸éï¼å³ç´æ¥ä½¿ç¨å·ä½çå­é¢å¼æ¥è¡¨ç¤ºæä¸æ°æ®ãè­¬å¦ï¼æä»¬å¨ä¹åç¤ºä¾ä¸­ä½¿ç¨ç<code>100</code>ã<code>0.1404</code>ã<code>"lingjie"</code>ç­é½å±äºå¸¸éè¡¨è¾¾å¼ãå¨ Python ä¸­ï¼æä»¬å¯ä»¥ä½¿ç¨æ´æ°ãæµ®ç¹æ°ãå­ç¬¦ä¸²ç­å­é¢å¸¸éæ¥è¡¨ç¤ºå¸¸éè¡¨è¾¾å¼ã</p>
</li>
<li>
<p><strong>åéè¡¨è¾¾å¼</strong>ï¼ è¿ç§è¡¨è¾¾å¼å°±æ¯å­å¨äºæä¸ç±»åæ°æ®çåéï¼å³ç´æ¥ä½¿ç¨å·²è¢«å®ä¹çåéæ¥è¡¨ç¤ºæä¸æ°æ®ãè­¬å¦ï¼æä»¬å¨ä¹åç¤ºä¾ä¸­ä½¿ç¨ç<code>CNY</code>ã<code>ex_rate</code>ã<code>USD</code>ç­é½å±äºåéè¡¨è¾¾å¼ã</p>
</li>
<li>
<p><strong>ç®æ¯è¡¨è¾¾å¼</strong>ï¼ è¿ç§è¡¨è¾¾å¼éå¸¸ç±ä¸ä¸ªæå¤ä¸ªåéåç®æ¯è¿ç®ç¬¦ç»æï¼å®çä¸»è¦ä½ç¨æ¯æ§è¡ç®æ¯è¿ç®ãè­¬å¦ä¸é¢çä¾å­ä¸­ï¼<code>CNY * ex_rate</code>å°±æ¯ä¸ä¸ªå¸åçç®æ¯è¡¨è¾¾å¼ãå¨ Python ä¸­ï¼æä»¬å¸¸ç¨å°çç®æ¯è¿ç®ç¬¦ä¸»è¦åæ¬å æ³<code>+</code>ãåæ³<code>-</code>ãä¹æ³<code>*</code>ãé¤æ³<code>/</code>ãæ´é¤<code>//</code>ãåä½<code>%</code>åä¹æ¹<code>**</code>è¿ä¸ç§ã</p>
</li>
<li>
<p><strong>å³ç³»è¡¨è¾¾å¼</strong>ï¼ è¿ç§è¡¨è¾¾å¼éå¸¸ç±ä¸ä¸ªæå¤ä¸ªåéåå³ç³»è¿ç®ç¬¦ç»æï¼å®çä¸»è¦ä½ç¨æ¯æ§è¡å³ç³»å¤æ­ãè­¬å¦ï¼<code>CNY &gt;= 0</code>å°±æ¯ä¸ä¸ªå¸åçå³ç³»è¡¨è¾¾å¼ãå¨ Python ä¸­ï¼æä»¬å¸¸ç¨å°çå³ç³»è¿ç®ç¬¦ä¸»è¦åæ¬å¤§äº<code>&gt;</code>ãå°äº<code>&lt;</code>ãå¤§äºç­äº<code>&gt;=</code>ãå°äºç­äº<code>&lt;=</code>ãç­äº<code>==</code>åä¸ç­äº<code>!=</code>è¿å­ç§ã</p>
</li>
<li>
<p><strong>é»è¾è¡¨è¾¾å¼</strong>ï¼ è¿ç§è¡¨è¾¾å¼éå¸¸ç±ä¸ä¸ªæå¤ä¸ªåéåé»è¾è¿ç®ç¬¦ç»æï¼å®çä¸»è¦ä½ç¨æ¯æ§è¡é»è¾å¤æ­ãè­¬å¦ï¼<code>CNY &gt;= 0 and ex_rate &gt;= 0</code>å°±æ¯ä¸ä¸ªå¸åçé»è¾è¡¨è¾¾å¼ãå¨ Python ä¸­ï¼æä»¬å¸¸ç¨å°çé»è¾è¿ç®ç¬¦ä¸»è¦åæ¬ä¸<code>and</code>ãæ<code>or</code>åé<code>not</code>è¿ä¸ç§ã</p>
</li>
<li>
<p><strong>å½æ°è°ç¨è¡¨è¾¾å¼</strong>ï¼ è¿ç§è¡¨è¾¾å¼éå¸¸éæç§<code>[å½æ°åç§°]([åæ°åè¡¨])</code>è¿æ ·çè¯­æ³è§åç¼åèæï¼å®çä¸»è¦ä½ç¨æ¯éè¿è°ç¨å½æ°çå¨ä½æ¥æ§è¡æä¸ç»é¢åå®ä¹å¥½çæä½ãè­¬å¦ï¼<code>print(USD)</code>å°±æ¯ä¸ä¸ªå¸åçå½æ°è°ç¨è¾¾å¼ã</p>
</li>
<li>
<p><strong>ä¸åè¡¨è¾¾å¼</strong>ï¼ è¿ç§è¡¨è¾¾å¼éå¸¸éæç§<code>[è¡¨è¾¾å¼_1] if [æ¡ä»¶] else [è¡¨è¾¾å¼_2]</code>è¿æ ·çè¯­æ³è§åç¼åèæï¼å®çä¸»è¦ä½ç¨æ¯æ ¹æ®æä¸æ¡ä»¶æ¥å³å®è¿ååªä¸ªè¡¨è¾¾å¼çå¼ãè­¬å¦ï¼<code>"Positive" if CNY &gt;= 0 else "Negative"</code>å°±æ¯ä¸ä¸ªå¸åçä¸åè¾¾å¼ï¼å®ä¼å¨<code>CNY</code>çå¼å¤§äºæç­äº<code>0</code>æ¶è¿åå­ç¬¦ä¸²<code>"Positive"</code>ï¼å¦åè¿åå­ç¬¦ä¸²<code>"Negative"</code>ã</p>
</li>
<li>
<p><strong>æåè®¿é®è¡¨è¾¾å¼</strong>ï¼è¿ç§è¡¨è¾¾å¼éå¸¸éæç§<code>[å¯¹è±¡åç§°].[å±æ§]</code>æ<code>[å¯¹è±¡åç§°].[æ¹æ³]([åæ°åè¡¨])</code>è¿æ ·çè¯­æ³è§åç¼åèæï¼å®çä¸»è¦ä½ç¨æ¯éè¿ç¹ç¬¦å·æ¥è®¿é®æå®å¯¹è±¡çå±æ§åæ¹æ³ãè­¬å¦ï¼è¯»èå¨ä¸ä¸èä¸­çå°ç<code>my_book.update_name("Python 3 å¿«éå¥é¨")</code>å°±æ¯ä¸ä¸ªå¸åçå¯¹è±¡æä½è¾¾å¼ã</p>
</li>
<li>
<p><strong>åç´ æµè¯è¡¨è¾¾å¼</strong>ï¼ è¿ç§è¡¨è¾¾å¼éå¸¸éæç§<code>[åç´ ] in [å¯è¿­ä»£å¯¹è±¡]</code>æ<code>[åç´ ] not in [å¯è¿­ä»£å¯¹è±¡]</code>è¿æ ·çè¯­æ³è§åç¼åèæï¼å®çä¸»è¦ä½ç¨æ¯æµè¯æä¸ªæå®çå¼æ¯å¦å­å¨äºæå®çå¯è¿­ä»£å¯¹è±¡ä¸­ãå¨è¿éï¼<code>[å¯è¿­ä»£å¯¹è±¡]</code>éå¸¸æçæ¯åè¡¨ãåç»ãéåæå­å¸ç­æ°æ®ç±»åçå®ä¾ãè­¬å¦ï¼å¦æ<code>name_list</code>æ¯ä¸ä¸ªåå«å¤ä¸ªå­ç¬¦ä¸²çåè¡¨ï¼é£ä¹<code>"lingjie" in name_list</code>å°±æ¯ä¸ä¸ªæåæµè¯è¡¨è¾¾å¼ï¼å®ä¼å¨<code>name_list</code>ä¸­åå«å­ç¬¦ä¸²<code>"lingjie"</code>æ¶è¿å<code>True</code>ï¼å¦åè¿å<code>False</code>ã</p>
</li>
<li>
<p><strong>åç´ è®¿é®è¡¨è¾¾å¼</strong>ï¼ è¿ç§è¡¨è¾¾å¼éå¸¸éæç§<code>[å¯è¿­ä»£å¯¹è±¡][ç´¢å¼]</code>æ<code>[å¯è¿­ä»£å¯¹è±¡][é®]</code>è¿æ ·çè¯­æ³è§åç¼åèæï¼å®çä¸»è¦ä½ç¨æ¯éè¿ç´¢å¼æé®æ¥è®¿é®æå®çå¯è¿­ä»£å¯¹è±¡ä¸­çåç´ ãå¨è¿éï¼<code>[å¯è¿­ä»£å¯¹è±¡]</code>éå¸¸æçæ¯åè¡¨ãåç»ãéåæå­å¸ç­æ°æ®ç±»åçå®ä¾ãè­¬å¦ï¼å¦æ<code>name_list</code>æ¯ä¸ä¸ªåå«å¤ä¸ªå­ç¬¦ä¸²çåè¡¨ï¼é£ä¹<code>name_list[0]</code>å°±æ¯ä¸ä¸ªåç´ è®¿é®è¡¨è¾¾å¼ï¼å®ä¼è¿ååè¡¨ä¸­ç¬¬ä¸ä¸ªåç´ çå¼ã</p>
</li>
<li>
<p><strong>éååçè¡¨è¾¾å¼</strong>ï¼ è¿ç§è¡¨è¾¾å¼éå¸¸éæç§<code>[å¯è¿­ä»£å¯¹è±¡][èµ·å§ç´¢å¼:ç»æç´¢å¼]</code>è¿æ ·çè¯­æ³è§åç¼åèæï¼å®çä¸»è¦ä½ç¨æ¯éè¿åçæä½æ¥è®¿é®æå®çå¯è¿­ä»£å¯¹è±¡ä¸­çä¸æ®µåç´ åºåãå¨è¿éï¼<code>[å¯è¿­ä»£å¯¹è±¡]</code>éå¸¸æçæ¯åè¡¨ãåç»æå­ç¬¦ä¸²ç­æ°æ®ç±»åçå®ä¾ãè­¬å¦ï¼å¦æ<code>name_list</code>æ¯ä¸ä¸ªåå«å¤ä¸ªå­ç¬¦ä¸²çåè¡¨ï¼é£ä¹<code>name_list[0:2]</code>å°±æ¯ä¸ä¸ªéååçè¡¨è¾¾å¼ï¼å®ä¼è¿ååè¡¨ä¸­ç¬¬ä¸ä¸ªåç¬¬äºä¸ªåç´ ç»æçå­åºåã</p>
</li>
<li>
<p><strong>åä¸æ§æµè¯è¡¨è¾¾å¼</strong>ï¼è¿ç§è¡¨è¾¾å¼éå¸¸éæç§<code>[åéåç§°_1] is [åéåç§°_2]</code>æ<code>[åéåç§°_1] is not [åéåç§°_2]</code>è¿æ ·çè¯­æ³è§åç¼åèæï¼å®çä¸»è¦ä½ç¨æ¯æµè¯<code>[åéåç§°_1]</code>å<code>[åéåç§°_2]</code>æ¯å¦æåçæ¯ç¸åçå¯¹è±¡ãåä¸æ§è¿ç®ç¬¦ï¼<code>is</code>å<code>is not</code>ï¼åå³ç³»è¿ç®ç¬¦ï¼<code>==</code>å<code>!=</code>ï¼çåºå«æ¯ï¼åèæ¯è¾çæ¯å¯¹è±¡å¨åå­ä¸­çä½ç½®ï¼èåèæ¯è¾çæ¯å¯¹è±¡ä¸­å­å¨çå¼ãä¸é¢ï¼è®©æä»¬ç¨å ä¸ªå·ä½çç¤ºä¾æ¥å¸®å©è¯»èå æ·±çè§£ï¼</p>
<pre><code class="language-python"># ç¤ºä¾1ï¼ç¸åçå¼ï¼ä¸åçå¯¹è±¡
list1 = [1, 2, 3]
list2 = [1, 2, 3]  # å¼ç¸åä½ä¸åå¯¹è±¡

print(list1 == list2)  # è¾åº: True (å¼ç¸ç­)
print(list1 is list2)  # è¾åº: False (ä¸æ¯åä¸ä¸ªå¯¹è±¡)

# ç¤ºä¾2ï¼ç¸åçå¯¹è±¡
list3 = list1
print(list1 == list3)  # è¾åº: True (å¼ç¸ç­)
print(list1 is list3)  # è¾åº: True (åä¸ä¸ªå¯¹è±¡)

# ç¤ºä¾3ï¼å°æ´æ°é©»çç°è±¡ï¼é©»çæ¯ Python çä¸ç§åå­ä¼åæºå¶ï¼
a = 256
b = 256
print(a == b)  # è¾åº: True
print(a is b)  # è¾åº: True (Python å¯¹å°æ´æ°è¿è¡ç¼å­ä¼å)

c = 257
d = 257
print(c == d)  # è¾åº: True
print(c is d)  # è¾åº: False (å¤§äº 256 çæ´æ°ä¸ç¼å­)

# ç¤ºä¾4ï¼None æ¯è¾
x = None
y = None
print(x == y)  # è¾åº: True
print(x is y)  # è¾åº: True (None æ¯åä¾å¯¹è±¡)

# ç¤ºä¾5ï¼å­ç¬¦ä¸²é©»ç
s1 = "hello"
s2 = "hello"
print(s1 == s2)  # è¾åº: True
print(s1 is s2)  # è¾åº: True (ç­å­ç¬¦ä¸²ä¼è¢«é©»ç)

s3 = "hello world!"
s4 = "hello world!"
print(s3 == s4)  # è¾åº: True
print(s3 is s4)  # è¾åº: False (é¿å­ç¬¦ä¸²ä¸ä¼é©»ç)
</code></pre>
</li>
<li>
<p><strong>Python æ¨å¯¼å¼</strong>ï¼è¿ç§è¡¨è¾¾å¼éå¸¸éæç§<code>[åç´ ] for [åç´ ] in [å¯è¿­ä»£å¯¹è±¡]</code>æ<code>[åç´ ] for [åç´ ] in [å¯è¿­ä»£å¯¹è±¡] if [æ¡ä»¶è¡¨è¾¾å¼]</code>è¿æ ·çè¯­æ³è§åç¼åèæï¼å®çä¸»è¦ä½ç¨æ¯éè¿éåæå®çå¯è¿­ä»£å¯¹è±¡æ¥çæä¸ä¸ªæ°çå¯è¿­ä»£å¯¹è±¡ãå¨è¿éï¼<code>[å¯è¿­ä»£å¯¹è±¡]</code>éå¸¸æçæ¯åè¡¨ãåç»æéåç­æ°æ®ç±»åçå®ä¾ãè­¬å¦ï¼</p>
<ul>
<li>
<p>å¦æ<code>name_list</code>æ¯ä¸ä¸ªåå«å¤ä¸ªå­ç¬¦ä¸²çåè¡¨ï¼é£ä¹<code>[name for name in name_list]</code>æ<code>[name for name in name_list if len(name) &gt; 3]</code>å°±æ¯ä¸ä¸ªåè¡¨æ¨å¯¼å¼ï¼åèä¼ç¨<code>name_list</code>ä¸­çææåç´ åå»ºä¸ä¸ªæ°çåè¡¨ï¼èåèåä¼ç¨<code>name_list</code>ä¸­ææé¿åº¦å¤§äº 3 çåç´ åå»ºä¸ä¸ªæ°çåè¡¨ã</p>
</li>
<li>
<p>å¦æ<code>phone_book</code>æ¯ä¸ä¸ªåå«å¤ä¸ªçµè¯å·ç çå­å¸ï¼é£ä¹<code>{name:phone for name, phone in phone_book.items()}</code>æ<code>{name:phone for name, phone in phone_book.items() if len(phone) == 11}</code>å°±æ¯ä¸ä¸ªå­å¸æ¨å¯¼å¼ï¼åèä¼ç¨<code>phone_book</code>ä¸­çææåç´ åå»ºä¸ä¸ªæ°çå­å¸ï¼èåèåä¼ç¨<code>phone_book</code>ä¸­ææçµè¯å·ç é¿åº¦ä¸º 11 çåç´ åå»ºä¸ä¸ªæ°çå­å¸ã</p>
</li>
<li>
<p>å¦æ<code>number_set</code>æ¯ä¸ä¸ªåå«å¤ä¸ªæ´æ°çéåï¼é£ä¹<code>{num for num in number_set}</code>æ<code>{num for num in number_set if num % 2 == 0}</code>å°±æ¯ä¸ä¸ªéåæ¨å¯¼å¼ï¼åèä¼ç¨<code>number_set</code>ä¸­çæææ´æ°åå»ºä¸ä¸ªæ°çéåï¼èåèåä¼ç¨<code>number_set</code>ä¸­ææå¶æ°åå»ºä¸ä¸ªæ°çéåã</p>
</li>
<li>
<p>å¦æ<code>name_tuple</code>æ¯ä¸ä¸ªåå«å¤ä¸ªå­ç¬¦ä¸²çåç»ï¼é£ä¹<code>(name for name in name_tuple)</code>æ<code>(name for name in name_tuple if len(name) &gt; 3)</code>å°±æ¯ä¸ä¸ªçæå¨æ¨å¯¼å¼ï¼åèä¼ç¨<code>name_tuple</code>ä¸­çææåç´ åå»ºä¸ä¸ªçæå¨å¯¹è±¡ï¼èåèåä¼ç¨<code>name_tuple</code>ä¸­ææé¿åº¦å¤§äº 3 çåç´ æ¥åå»ºä¸ä¸ªçæå¨å¯¹è±¡ãå¨è¿éï¼å®ä¹æä»¥è¢«ç§°ä¸ºçæå¨æ¨å¯¼å¼ï¼èä¸æ¯åç»æ¨å¯¼å¼ï¼æ¯å ä¸ºå®æ§è¡çæ¯ä¸ç§è¢«ç§°ä¸ºâæ°æ§æ±å¼âçæä½ãä¹å°±æ¯è¯´ï¼è¯¥æ¨å¯¼å¼è¿åçæ¯ä¸ä¸ªçæå¨å¯¹è±¡ï¼èä¸æ¯ä¸ä¸ªæ°çåç»ãè¿ä¸ªçæå¨å¯¹è±¡éè¦éè¿è°ç¨<code>next()</code>å½æ°æä½¿ç¨<code>for</code>å¾ªç¯æ¥å¨æãæéå°çæåç´ ï¼èä¸æ¯ä¸æ¬¡æ§å°çæææåç´ ï¼è¿æå©äºå¨å¤çå¤§éæ°æ®æ¶èçåå­ç©ºé´ãä¾å¦ï¼å¦ææä»¬æ³è¦ä»ä¸ä¸ªåå«å¤§éå­ç¬¦ä¸²çåç»ä¸­ç­éåºææé¿åº¦å¤§äº 3 çå­ç¬¦ä¸²ï¼æä»¬å¯ä»¥ä½¿ç¨çæå¨æ¨å¯¼å¼æ¥å®ç°è¿ä¸ç¹ï¼èä¸æ¯ä¸æ¬¡æ§å°å°ææç¬¦åæ¡ä»¶çå­ç¬¦ä¸²é½å­å¨å¨åå­ä¸­ï¼å°±åä¸é¢è¿æ ·ï¼</p>
<pre><code class="language-python"># è¿éåè®¾æä»¬æä¸ä¸ªåå«å¤§éå­ç¬¦ä¸²çææ¬æä»¶ large_data.txtï¼
# æ¯è¡ä¸ä¸ªå­ç¬¦ä¸²ï¼æä»¬å¯ä»¥åå°å¶è¯»åä¸ºä¸ä¸ªåç»ã
with open("large_data.txt", "r") as f:
    name_tuple = tuple(f.read().splitlines())
# ä½¿ç¨çæå¨æ¨å¯¼å¼æ¥ç­éåºææé¿åº¦å¤§äº 3 çå­ç¬¦ä¸²
long_names = (name for name in name_tuple if len(name) &gt; 3)
# ä½¿ç¨ for å¾ªç¯æ¥å¨æå°çæå¹¶å¤çè¿äºå­ç¬¦ä¸²
for name in long_names:
    print(name) # è¿éä¼éä¸ªè¾åºææé¿åº¦å¤§äº 3 çå­ç¬¦ä¸²
</code></pre>
<p>å½ç¶ï¼å¦æéè¦ä¸æ¬¡æ§å°è·å¾ä¸ä¸ªæ°çåç»ï¼æä»¬ä¹å¯ä»¥ä½¿ç¨<code>tuple()</code>å½æ°æ¥å°çæå¨æ¨å¯¼å¼çç»æè½¬æ¢ä¸ºä¸ä¸ªåç»å¯¹è±¡ï¼ä¾å¦ï¼æä»¬å¯ä»¥å¯¹ä¸è¿°<code>long_names</code>çæå¨å¯¹è±¡æ§è¡å¦ä¸æä½ï¼</p>
<pre><code class="language-python"># ä½¿ç¨ tuple() å½æ°å°çæå¨æ¨å¯¼å¼çç»æè½¬æ¢ä¸ºä¸ä¸ªæ°çåç»
long_names_tuple = tuple(long_names)
# ç°å¨ long_names_tuple å°±æ¯ä¸ä¸ªåå«ææé¿åº¦å¤§äº 3 çå­ç¬¦ä¸²çæ°åç»
print(long_names_tuple) # è¿éä¼è¾åºææé¿åº¦å¤§äº 3 çå­ç¬¦ä¸²
</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="æµç¨æ§å¶è¯­å¥">æµç¨æ§å¶è¯­å¥</h3>
<p>å¨å®éç¼ç¨å·¥ä½ä¸­ï¼æä»¬æ´å¤æ¶åä½¿ç¨çæ¯ç±è¡¨è¾¾å¼åå¶ä»æµç¨æ§å¶è¯­æ³å±åç»åèæçï¼è¿äºè¯­å¥å¾å¾è¢«ç¨äºè¡¨è¿°æ¯ç®åçèµå¼æä½æ´å¤æçæµç¨æ§å¶æå¾ï¼æä»¬å°å¶ç»ç§°ä¸ºæµç¨æ§å¶è¯­å¥ãæç§å·ä½çä½ç¨ï¼æä»¬å¯ä»¥å°æµç¨æ§å¶è¯­å¥ç»åä¸ºæ¡ä»¶ãå¾ªç¯åè·³è½¬ä¸ç§è¯­å¥ãä¸é¢ï¼è®©æä»¬åå«æ¥ä»ç»ä¸ä¸å®ä»¬ã</p>
<p>å°ç®åä¸ºæ­¢ï¼æä»¬æçå°çææç¨åºé½æ¯æç§è¯­å¥åºç°çé¡ºåºä¸è·¯æ§è¡å°åºçï¼åºæ¬æ²¡æä»»ä½åºåè½åãå¦ææä»¬å¸æèªå·±ç¼åçç¨åºè½å·å¤ä¸å®çâéæºåºåâè½åï¼å°±å¾è®©å®æ§è¡æ¡ä»¶å¤æ­ãå¨ç¼ç¨è¯­è¨ä¸­ï¼æä»¬ç¨æ¥è¡¨è¿°æ¡ä»¶å¤æ­çè¯­å¥å«å<strong>æ¡ä»¶è¯­å¥</strong>ãæ¡ä»¶è¯­å¥å¨ç¼ç¨è®¾è®¡æ¦å¿µä¸­å±äºæµç¨æ§å¶è¯­å¥ä¸­çä¸ç§ï¼å®çä¸»è¦ä½ç¨æ¯æ ¹æ®æä¸ç±ç¨åºåé¢åæå®çæ¡ä»¶æ¥å³å®æ¯æ§è¡è¿æ¯è·³è¿æé¨åçè¯­å¥ï¼è¿äºè¯­å¥éå¸¸è¢«ç§°ä¹ä¸ºæ¡ä»¶åæ¯ï¼ã</p>
<p>å¨ Python ä¸­ï¼æ¡ä»¶è¯­å¥ä¸»è¦æçæ¯ä»¥<code>if</code>å³é®å­å¼å¤´çæ¡ä»¶å¤æ­è¯­å¥ï¼è¿ç§è¯­å¥ä¹æ¯ç¼ç¨è®¾è®¡ä¸­æå¸¸è§ãæåºæ¬çä¸ç§æµç¨æ§å¶è¯­å¥ï¼å®æ ¹æ®æ¡ä»¶åæ¯çå¤å°ï¼å¯ä»¥åä¸ºä»¥ä¸ä¸ç§å½¢å¼ã</p>
<ul>
<li>
<p>ååæ¯å½¢å¼ï¼è¿ç§å½¢å¼ç<code>if</code>è¯­å¥åªç¨äºæå®å¨ææ¡ä»¶æç«æ¶éè¦æ§è¡çæ¡ä»¶åæ¯ï¼å·ä½è¯­æ³å¦ä¸ï¼</p>
<pre><code class="language-python">if [æ¡ä»¶è¡¨è¾¾å¼]:
    [åæ¯è¯­å¥]
</code></pre>
</li>
<li>
<p>ååæ¯å½¢å¼ï¼è¿ç§å½¢å¼ç<code>if</code>è¯­å¥ä¼åæ¶æå®å¨ææ¡ä»¶æç«æä¸æç«æ¶éè¦æ§è¡çæ¡ä»¶åæ¯ï¼å·ä½è¯­æ³å¦ä¸ï¼</p>
<pre><code class="language-python">if [æ¡ä»¶è¡¨è¾¾å¼]:
    [åæ¯è¯­å¥]
else:
    [åæ¯è¯­å¥]
</code></pre>
</li>
<li>
<p>å¤åæ¯å½¢å¼ï¼è¿ç§å½¢å¼ç<code>if</code>è¯­å¥ä¼æ ¹æ®å¤ä¸ªæ¡ä»¶æ¥å³å®ç¨åºéè¦æ§è¡çæ¡ä»¶åæ¯ï¼å·ä½è¯­æ³å¦ä¸ï¼</p>
<pre><code class="language-python">if [æ¡ä»¶è¡¨è¾¾å¼]:
    [åæ¯è¯­å¥]
elif [æ¡ä»¶è¡¨è¾¾å¼]:
    [åæ¯è¯­å¥]
elif [æ¡ä»¶è¡¨è¾¾å¼]:
    [åæ¯è¯­å¥]
...
else:
    [åæ¯è¯­å¥]
</code></pre>
</li>
</ul>
<p>å¨è¿éï¼<code>[æ¡ä»¶è¡¨è¾¾å¼]</code>ä¸»è¦ä¼æ¯ä¸äºè¿åå¸å°ç±»åçè¡¨è¾¾å¼ï¼è­¬å¦å³ç³»è¡¨è¾¾å¼ãé»è¾è¡¨è¾¾å¼ç­ãè<code>[åæ¯è¯­å¥]</code>çé¨ååæ¢å¯ä»¥æ¯ç®åçè¡¨è¾¾å¼è¯­å¥ï¼ä¹å¯ä»¥æ¯ä¸ä¸ªéç¨åä¸ç¼©è¿æ ¼å¼çè¯­å¥åãä¸é¢ï¼æä»¬éè¿ä¸ä¸ªå·ä½çä¾å­æ¥æ¼ç¤ºä¸ä¸<code>if</code>è¯­å¥çç¨æ³ãå¤§å®¶é½ç¥éï¼è´§å¸çå¸å¼éå¸¸ä¸ä¼ä¸ºè´æ°ï¼åºäºè¿ä¸ç¹ï¼æä»¬å¯ä»¥å¯¹ä¹åå¸å¼æ¢ç®ä»£ç ååºå¦ä¸ä¿®æ¹ï¼</p>
<pre><code class="language-python">ex_rate = 0.1404
CNY = 200
if CNY &gt;= 0:
    USD = CNY * ex_rate
    print("æ¢ç®çç¾åå¸å¼ä¸ºï¼", USD)

# ç»§ç»­åé¢çä»£ç ...
</code></pre>
<p>å¨è¿ç§æåµä¸ï¼æä»¬åªä¼å¨<code>CNY</code>çå¼å¤§äºæå¤§äº<code>0</code>æ¶æä¼çå°è¾åºç»æãä½æ¯è¿ç§åæ³æä¸ªé®é¢ï¼é£å°±æ¯ä¸æ¦<code>CNY</code>çå¼ä¸ºè´æ°ï¼æä»¬å¨æ§è¡è¿æ®µä»£ç æ¶å°çä¸å°ä»»ä½åé¦ä¿¡æ¯ï¼çè³ä¸ç¡®å®ç¨åºæ¯å¦è¿è¡è¿ãä¸ºäºè§£å³é®é¢ï¼æä»¬è¦è®©ä»£ç å¨æ¡ä»¶ä¸æç«æ¶ä¹è¾åºä¸æ¡æç¤ºä¿¡æ¯ï¼</p>
<pre><code class="language-python">ex_rate = 0.1404
CNY = 200
if CNY &gt;= 0:
    USD = CNY * ex_rate
    print("æ¢ç®çç¾åå¸å¼ä¸ºï¼", USD)
else:
    print("äººæ°å¸çå¸å¼ä¸è½ä¸ºè´æ°ï¼")

# ç»§ç»­åé¢çä»£ç ...
</code></pre>
<p>å½ç¶ï¼å¦ææä»¬è¿æ³ç¡®ä¿<code>ex_rate</code>çå¼ä¹ä¸æ¯è´æ°ï¼ä¹å¯ä»¥ç»§ç»­å°ä»£ç ä¿®æ¹æä¸ä¸ªå¤åæ¯å¤æ­ï¼</p>
<pre><code class="language-python">ex_rate = -0.1404  # ç°å¨æ±çä¸ºè´å¼ã
CNY = 200
if CNY &lt; 0:
    print("äººæ°å¸çå¸å¼ä¸è½ä¸ºè´æ°ï¼")
elif ex_rate &lt; 0:
    print("äººæ°å¸å¯¹ç¾åçæ±çä¸è½ä¸ºè´æ°ï¼")
else:
    USD = CNY * ex_rate
    print("æ¢ç®çç¾åå¸å¼ä¸ºï¼", USD)

# ç»§ç»­åé¢çä»£ç ...
</code></pre>
<p>å¨æµè¯ä¸é¢è¿äºæ¡ä»¶è¯­å¥æ¶ï¼ç»å¿çè¯»èå¯è½å·²ç»åç°äºä¸ä¸ªé®é¢ï¼é£å°±æ¯è¿äºæ¡ä»¶è¯­å¥é½åªè½æ§è¡ä¸æ¬¡ãèæä»¬å¦ææ³æµè¯ä¸åçæ°æ®ï¼å°±å¾å»ä¿®æ¹ä»£ç æ¬èº«ï¼è¿ç§æµè¯æ¹æ³ä¸ä»æä½ä¸æ¹ä¾¿ï¼èä¸æ ¹æ¬æ²¡æåæ³é¢å¯¹æµ·éçæµè¯æ°æ®ãå¦ææ³è¦è§£å³è¿ä¸ªé®é¢ï¼æä»¬å°±å¾æ³åæ³è®©ç¨åºè½æ ¹æ®æä»¬ææå®çæ¡ä»¶æ¥éå¤æ§è¡æé¨åçè¯­å¥ï¼èè¿å°±æ¶åå°äºç¼ç¨è¯­è¨ä¸­å¦ä¸ç§æµç¨æ§å¶è¯­å¥ï¼<strong>å¾ªç¯è¯­å¥</strong>ã</p>
<p>å¨ Python ä¸­ï¼å¾ªç¯è¯­å¥ä¸»è¦æ<code>for</code>è¯­å¥å<code>while</code>è¯­å¥ä¸¤ç§å½¢å¼ãä¸é¢ï¼å°±è®©æä»¬åå«æ¥ä»ç»ä¸ä¸å®ä»¬ãä»ä½¿ç¨ä¹ æ¯ä¸æ¥è¯´ï¼<code>for</code>è¯­å¥çæ´ä¸ªå¾ªç¯è¿ç¨éå¸¸ä¼ç±æç§éåæä½æ¥é©±å¨ï¼å¶å·ä½è¯­æ³å¦ä¸ï¼</p>
<pre><code class="language-python">for [å¾ªç¯åé] in [è¢«éåå¯¹è±¡]ï¼
    [è¢«å¾ªç¯è¯­å¥]
</code></pre>
<p>ä¸é¢å·ä½è§£éä¸ä¸ä¸è¿°è¯­æ³æ ¼å¼ä¸­æ¶åå°çè¯­æ³ååãé¦åï¼<code>[å¾ªç¯åé]</code>çä½ç¨æ¯è¯»å<code>[è¢«éåå¯¹è±¡]</code>ä¸­çæ¯ä¸ä¸ªå¼ï¼ç±äºè¿ä¸ªåéå°è¢«ç¨äºé©±å¨æ´ä¸ªå¾ªç¯çæ§è¡ï¼æèè¢«ç§°ä¹ä¸ºå¾ªç¯åéï¼ç¶åï¼<code>[è¢«éåå¯¹è±¡]</code>éå¸¸ä¼æ¯ä¸ä¸ªå¯è¢«éåçæ°æ®ç»æå¯¹è±¡ï¼åªè¦è¯¥å¯¹è±¡ä¸­çæåä¸ä¸ªåç´ å°æªè¢«<code>[å¾ªç¯åé]</code>è¯»åï¼å¾ªç¯å°±ä¼ä¸ç´æ§è¡ä¸å»ï¼æåï¼<code>[è¢«å¾ªç¯è¯­å¥]</code>å°±æ¯è¯¥å¾ªç¯è¦éå¤æ§è¡çè¯­å¥ï¼å®æ¢å¯ä»¥æ¯ç®åçè¡¨è¾¾å¼è¯­å¥ï¼ä¹å¯ä»¥æ¯ä¸ä¸ªéç¨äºåä¸ç¼©è¿æ ¼å¼çè¯­å¥åãä¾å¦ï¼å¦æä½ æ³å¨å½ä»¤è¡ç»ç«¯ä¸­éè¡è¾åºä» 0 å° 9 è¿åä¸ªæ°å­ï¼å°±å¯ä»¥åä¸é¢è¿æ ·åï¼</p>
<pre><code class="language-python">for item in range(0, 10): # çæä¸ä¸ªåå« 0 å° 9 çæ´æ°åºå
    print(item)
</code></pre>
<p><code>while</code>è¯­å¥ä¸<code>for</code>è¯­å¥ç¸æ¯ï¼æå¤§çåºå«å¨äºå®å¹¶æ²¡æä¸º<code>[å¾ªç¯åé]</code>é¢çåºå®çè¯­æ³ååï¼å¶å·ä½è¯­æ³å¦ä¸ï¼</p>
<pre><code class="language-python">while [å¾ªç¯æ¡ä»¶æµè¯]:
    [è¢«å¾ªç¯è¯­å¥]
else: # å¯éçè¯­å¥
    [å¾ªç¯ç»æåæ§è¡çè¯­å¥]
</code></pre>
<p>æ­£å¦è¯»èæè§ï¼<code>while</code>è¯­å¥ä¸­çè¯­æ³åååªæä¸¤ä¸ªï¼å¨<code>[å¾ªç¯æ¡ä»¶æµè¯]</code>å¤ï¼æä»¬åªéè¦è®¾ç½®ä¸ä¸ªè½è¿åå¸å°ç±»åçè¡¨è¾¾å¼å³å¯ãåªè¦è¯¥è¡¨è¾¾å¼æµè¯çç»æ<code>True</code>ï¼å¾ªç¯å°±ä¼ä¸ç´æ§è¡ä¸å»ï¼ç´å°å®å æ»¡è¶³æä¸æ¡ä»¶èè¿å<code>False</code>ä¸ºæ­¢ï¼è<code>[è¢«å¾ªç¯è¯­å¥]</code>å°±æ¯è¯¥å¾ªç¯è¦éå¤æ§è¡çè¯­å¥ï¼åæ ·çï¼å®æ¢å¯ä»¥æ¯ç®åçè¡¨è¾¾å¼è¯­å¥ï¼ä¹å¯ä»¥æ¯ä¸ä¸ªéç¨äºåä¸ç¼©è¿æ ¼å¼çè¯­å¥åãå¦å¤ï¼å¦ææä»¬æ³å¨<code>while</code>å¾ªç¯ç»æåæ§è¡æäºç¹å®çæä½ï¼ä¹å¯ä»¥å¨<code>while</code>è¯­å¥çæ«å°¾æ·»å ä¸ä¸ªå¯éç<code>else</code>è¯­å¥åæ¥å®ç°ãéè¦æ³¨æçæ¯ï¼<code>else</code>è¯­å¥åä¸­çè¯­å¥åªä¼å¨å¾ªç¯æ­£å¸¸ç»ææ¶æä¼è¢«æ§è¡ï¼èä¸ä¼å¨å¾ªç¯è¢«æåç»æ­¢æ¶è¢«æ§è¡ã</p>
<p>ä¸<code>for</code>è¯­å¥çè¯­æ³æ ¼å¼ç¸æ¯ï¼<code>while</code>è¯­å¥æ¾ç¶å·ææ´é«çèªç±åº¦ï¼å®åè®¸ç¨åºåæ´çµæ´»å°å®æå¾ªç¯çæ§è¡æ¹å¼ï¼å½ç¶äºï¼è¿ä¹æå³çå®æ´å®¹æåºéï¼ï¼å æ­¤å¨ä¹ æ¯ä¸æ´éåç¨æ¥æè¿°ä¸äºæ§è¡æ¬¡æ°ä¸ç¡®å®çå¾ªç¯æä½ãä¾å¦ï¼å¦ææä»¬éè¦åºäº<code>readLine(text)</code>å½æ°æ¥ç¼åä¸ä¸ªå¾ªç¯è¯­å¥æ¥å®ç°ä¸ä¸ªéè¡è¯»åå¤è¡ææ¬çåè½ï¼ç±äº<code>text</code>å¯¹è±¡ææåçå¤è¡ææ¬æ¯ç±å¶è°ç¨æ¹æå®çï¼æä»¥æä»¬æ æ³äºåç¥éè¯¥å¾ªç¯è¯­å¥ç©¶ç«éè¦è¯»åå¤å°è¡ææ¬ï¼ä½åªè¦è½ç¡®å®è¯¥å½æ°ä¼å¨è¯»åå®ææææ¬ä¹åä¼è¿å<code>False</code>ï¼å°±å¯ä»¥å©ç¨ä¸é¢è¿ä¸ª<code>while</code>è¯­å¥æ¥ä½¿ç¨è¿ä¸ªå½æ°ã</p>
<pre><code class="language-python">num = 1
while line := readLine(text): # è¿éä½¿ç¨äº Python 3.8+ æä¾çæµ·è±¡è¿ç®ç¬¦
    print(f"{num}. {line}")   # è¿éä½¿ç¨äº f-string æ¥å®ç°æ ¼å¼åè¾åº
    num = num + 1
else:
    print(f"è¯»åå®æ¯ï¼å±è¯»åäº {num - 1} è¡ææ¬ã")
</code></pre>
<p>éè¦ç¹å«è¯´æçæ¯ï¼æä»¬å¨ä¸è¿°<code>while</code>è¯­å¥ç<code>[å¾ªç¯æ¡ä»¶æµè¯]</code>å¤ä½¿ç¨äºèª Python 3.8 çæ¬ä¹åå¼å¥çæµ·è±¡è¿ç®ç¬¦ï¼<code>:=</code>ï¼ï¼å®çä½ç¨æ¯å°å³ä¾§çè¡¨è¾¾å¼ç»æèµå¼ç»å·¦ä¾§çåéï¼å¹¶è¿åè¯¥åéçå¼ãè¿æ ·ï¼æä»¬å°±å¯ä»¥å¨æ¯æ¬¡å¾ªç¯ä¸­ç´æ¥è¯»åææ¬è¡å¹¶å°å¶å­å¨å°<code>line</code>åéä¸­ï¼èä¸éè¦å¨å¾ªç¯ä½åååç¬æ§è¡ä¸æ¬¡èµå¼æä½äºï¼å¦åï¼åæä»¬æçæç C/C++/Java è¯­è¨ä¸ä¸æ ·ï¼Python çè¯­æ³è§åæ¯ä¸åè®¸å¨<code>while</code>è¯­å¥ç<code>[å¾ªç¯æ¡ä»¶æµè¯]</code>å¤ç´æ¥æ§è¡èµå¼æä½çãå¦æè¯»èä½¿ç¨çæ¯ Python 3.8 ä¹åççæ¬ï¼å°±éè¦å°ä¸è¿°ä»£ç ä¿®æ¹æä¸é¢è¿æ ·ï¼</p>
<pre><code class="language-python">num = 1
line = readLine(text) # åè¯»åç¬¬ä¸è¡ææ¬
while line: # åªè¦ line ä¸ä¸ºç©ºï¼å°±ç»§ç»­å¾ªç¯
    print(f"{num}. {line}") # ä½¿ç¨ f-string æ ¼å¼åè¾åº
    num = num + 1
    line = readLine(text) # åè¯»åä¸ä¸è¡ææ¬
else:
    print(f"è¯»åå®æ¯ï¼å±è¯»åäº {num - 1} è¡ææ¬ã")
</code></pre>
<p>å½ç¶äºï¼å¦ææä»¬ç¡¬è¦ç¨<code>for</code>å¾ªç¯å®ç°ä¸é¢è¿æ ·çå¾ªç¯ï¼ä¹æ¯å¯ä»¥åå°çï¼èä¸<code>while</code>å¾ªç¯ä¹å¯ä»¥ç¨æ¥æ§è¡å¾ªç¯æ¬¡æ°ç¡®å®çéåæä½ï¼è¿éåªæ¯ç¬èå¨ä½¿ç¨ä¹ æ¯ä¸æåçå»ºè®®ï¼å¹¶ä¸å­å¨ç»å¯¹çä¸å®ä¹è§ãå¦å¤ï¼å¨ç¨åºæ§è¡è¿ç¨ä¸­ï¼æä»¬å¸¸å¸¸ä¼éå°ä¸äºéè¦æåç»æå½åæ§è¡ååï¼è­¬å¦æ¡ä»¶è¯­å¥ãå¾ªç¯è¯­å¥ï¼çç¹æ®æåµï¼è¿æ¶åå°±ä¼éè¦ç¨å°ä¸ç§è½è®©ç¨åºç´æ¥æ¹åæ§è¡ä½ç½®çè¯­å¥ï¼æä»¬ç§°ä¹ä¸º<strong>è·³è½¬è¯­å¥</strong>ï¼ä¸é¢æ¥ä»ç»ä¸ä¸ Python è¯­è¨ä¸­å¸¸ç¨çå ç§è·³è½¬è¯­å¥ã</p>
<ul>
<li>
<p><code>break</code>è¯­å¥ï¼è¯¥è·³è½¬è¯­å¥çä½ç¨å°±æ¯è®©ç¨åºçæµç¨ç´æ¥è·³åºå½åæ­£å¨æ§è¡çæ¡ä»¶è¯­å¥ä¸å¾ªç¯è¯­å¥ãä¾å¦ï¼å¦ææä»¬å¸æä¹åé£ä¸ªè¯»åææ¬çå¾ªç¯å¨éå°ç©ºè¡æ¶å°±åæ­¢è¯»åï¼å°±å¯ä»¥åä¸é¢è¿æ ·åï¼</p>
<pre><code class="language-python">num = 1
while line := readLine(text):
    if line == "":
        break
    print(f"{num}. {line}") 
    num = num + 1
else:
    print(f"è¯»åå®æ¯ï¼å±è¯»åäº {num - 1} è¡ææ¬ã")
</code></pre>
</li>
<li>
<p><code>return</code>è¯­å¥ï¼è¯¥è·³è½¬è¯­å¥çä½ç¨æ¯è®©ç¨åºçæµç¨ç»æ­¢å½åå½æ°çæ§è¡ï¼å¹¶å°æå®çæ°æ®ï¼å¦ææçè¯ï¼è¿åç»è¯¥å½æ°çè°ç¨æ¹ãä¾å¦ï¼å¦ææä»¬å¸æå°ä¹åé£ä¸ªè¯»åææ¬çå¾ªç¯æ¾å°ä¸ä¸ªåä¸º<code>process_text</code>çå½æ°ä¸­ï¼å¹¶è®©å®å¨éå°ç©ºè¡æ¶å°±åæ­¢è¯»åï¼å¹¶è¿åç»è°ç¨æ¹ä¸ä¸ª<code>False</code>å¼ï¼å°±å¯ä»¥åä¸é¢è¿æ ·åï¼</p>
<pre><code class="language-python">def process_text(text):
    num = 1
    while line := readLine(text):
        if line == "":
            return False
        print(f"{num}. {line}") 
        num = num + 1
    else:
        print(f"è¯»åå®æ¯ï¼å±è¯»åäº {num - 1} è¡ææ¬ã")
    return True  # è¿å True è¡¨ç¤ºè¯»åæå
</code></pre>
<p>è¿æ ·ä¸æ¥ï¼æä»¬å°±å¯ä»¥å¨è°ç¨è¯¥å½æ°æ¶æ ¹æ®è¿åå¼æ¥å¤æ­è¦è¯»åçææ¬ä¸­æ¯å¦åå«ç©ºè¡äºãä¾å¦ï¼</p>
<pre><code class="language-python">text = '''è¿æ¯ä¸ä¸ªå¤è¡ææ¬ç¤ºä¾ã
ä¸é¢æ¯ä¸ä¸ªç©ºè¡ã

è¿æ¯æåä¸è¡ã'''
if not process_text(text):
    print("è¯»åææ¬æ¶éå°ç©ºè¡ï¼åæ­¢è¯»åã")
else:
    print("ææ¬è¯»åæåã")
</code></pre>
</li>
<li>
<p><code>continue</code>è¯­å¥ï¼è¯¥è·³è½¬è¯­å¥åªè½è¢«è¿ç¨å¨å¾ªç¯è¯­å¥ä¸­ï¼ä½ç¨æ¯è®©ç¨åºçæµç¨åæ­¢å½åè¿ä¸è½®çå¾ªç¯æä½ï¼ç´æ¥è¿å¥ä¸ä¸è½®å¾ªç¯ãä¾å¦ï¼å¦ä»æå¾å¤ææ¬æ ¼å¼æ¯ç¨ç©ºè¡æ¥åå²æ®µè½çï¼ä¾å¦ Markdownï¼ãè¿æ¶åï¼å¦ææä»¬è§å¾éå°ç©ºè¡å°±ç´æ¥åæ­¢è¯»åçæ¹å¼ä¸å¦¥å½ï¼ç¨åºåªéä¸è¾åºç©ºè¡å°±å¯ä»¥äºï¼ä¹å¯ä»¥åä¸é¢è¿æ ·åï¼</p>
<pre><code class="language-python">num = 1
while line := readLine(text):
    if line == "":
        continue
    print(f"{num}. {line}")
    num = num + 1
else:
    print(f"è¯»åå®æ¯ï¼å±è¯»åäº {num - 1} è¡ææ¬ã")
</code></pre>
</li>
<li>
<p><code>pass</code>è¯­å¥ï¼è¯¥è¯­å¥è¡¨ç¤ºç¨åºå¨å½åä½ç½®ä¸æ§è¡ä»»ä½æä½ï¼å¹¶ç»§ç»­æ§è¡å½åè¿­ä»£ä¸­çä¸ä¸è¡è¯­å¥ãå®éå¸¸è¢«ç¨æ¥å ä½ï¼è¡¨ç¤ºå½åè¿ä¸è¡è¯­å¥æ¯ç©ºçãä¾å¦ï¼å¯¹äºä¸é¢ä½¿ç¨<code>continue</code>è¯­å¥å®ç°çåè½ï¼æä»¬ä¹å¯ä»¥ä½¿ç¨<code>pass</code>è¯­å¥æ¥å®ç°åæ ·çææï¼å·ä½åæ³å¦ä¸ï¼</p>
<pre><code class="language-python">num = 1
while line := readLine(text):
    if line == "":
        pass  # ä¸æ§è¡ä»»ä½æä½
    else:
        print(f"{num}. {line}")
        num = num + 1
else:
    print(f"è¯»åå®æ¯ï¼å±è¯»åäº {num - 1} è¡ææ¬ã")
</code></pre>
</li>
</ul>
<h3 id="ä¸äºä¸ç¨è¯­å¥">ä¸äºä¸ç¨è¯­å¥</h3>
<p>å¨ Python è¯­è¨ä¸­ï¼é¤äºåºæ¬çæµç¨æ§å¶è¯­å¥ä¹å¤ï¼è¿æä¸äºä¸é¨ç¨äºå¤çç¹å®åºæ¯çè¯­å¥ãä¸é¢ï¼æä»¬æ¥ä»ç»ä¸ä¸è¿äºä¸ç¨è¯­å¥ã</p>
<ul>
<li>
<p><code>with</code>è¯­å¥ï¼è¯¥è¯­å¥çä½ç¨æ¯ç¨äºç®åèµæºç®¡çï¼éå¸¸è¢«ç¨æ¥å¤çæä»¶ãç½ç»è¿æ¥ç­éè¦å¨ä½¿ç¨åéæ¾çèµæºãå®ä¼èªå¨å¤çèµæºçæå¼åå³é­ï¼ç¡®ä¿èµæºå¨ä½¿ç¨å®æ¯åè¢«æ­£ç¡®éæ¾ãä¾å¦ï¼å¦ææä»¬å¸æè¯»åä¸ä¸ªæä»¶ä¸­çåå®¹ï¼å¯ä»¥åä¸é¢è¿æ ·åï¼</p>
<pre><code class="language-python">with open("example.txt", "r") as file:
    for line in file:
        print(line.strip())
</code></pre>
</li>
<li>
<p><code>try</code>ã<code>except</code>ã<code>finally</code>è¯­å¥ï¼è¿äºè¯­å¥çä½ç¨æ¯ç¨äºå¤çå¼å¸¸æåµï¼ç¡®ä¿ç¨åºå¨éå°éè¯¯æ¶ä¸ä¼å´©æºãå®ä»¬éå¸¸è¢«ç¨æ¥æè·åå¤çè¿è¡æ¶éè¯¯ãä¾å¦ï¼å¦ææä»¬å¸æå¨è¯»åæä»¶æ¶å¤çå¯è½åºç°çæä»¶ä¸å­å¨éè¯¯ï¼å¯ä»¥åä¸é¢è¿æ ·åï¼</p>
<pre><code class="language-python">try:
    with open("example.txt", "r") as file:
        for line in file:
            print(line.strip())
except FileNotFoundError:
    print("æä»¶ä¸å­å¨ï¼è¯·æ£æ¥æä»¶è·¯å¾ã")
finally:
    print("æä»¶è¯»åæä½ç»æã")
</code></pre>
<p>å¨ä¸è¿°ä»£ç ä¸­ï¼<code>try</code>è¯­å¥åä¸­çä»£ç ä¼å°è¯æ§è¡ï¼å¦æåºç°<code>FileNotFoundError</code>å¼å¸¸ï¼åä¼è·³è½¬å°<code>except</code>è¯­å¥åä¸­æ§è¡ç¸åºçéè¯¯å¤çé»è¾ãæ è®ºæ¯å¦åçå¼å¸¸ï¼<code>finally</code>è¯­å¥åä¸­çä»£ç é½ä¼è¢«æ§è¡ï¼éå¸¸ç¨äºæ¸çèµæºæè®°å½æ¥å¿ã</p>
</li>
<li>
<p><code>yield</code>è¯­å¥ï¼è¯¥è¯­å¥çä½ç¨æ¯ç¨äºå®ä¹çæå¨å½æ°ï¼å®å¯ä»¥å¨å½æ°æ§è¡è¿ç¨ä¸­æåå¹¶è¿åä¸ä¸ªå¼ï¼ç­å¾ä¸ä¸æ¬¡è°ç¨æ¶ç»§ç»­æ§è¡ãçæå¨å½æ°éå¸¸è¢«ç¨æ¥å¤çå¤§éæ°æ®ææ éåºåãä¾å¦ï¼å¦ææä»¬å¸æåå»ºä¸ä¸ªçæå¨å½æ°æ¥éè¡è¯»åæä»¶åå®¹ï¼å¯ä»¥åä¸é¢è¿æ ·åï¼</p>
<pre><code class="language-python">def read_lines(file_path):
    with open(file_path, "r") as file:
        for line in file:
            yield line.strip()  # ä½¿ç¨ yield è¿åæ¯ä¸è¡åå®¹
</code></pre>
<p>å¨ä½¿ç¨è¯¥çæå¨å½æ°æ¶ï¼æä»¬å¯ä»¥åä¸é¢è¿æ ·éè¡è¯»åæä»¶åå®¹ï¼</p>
<pre><code class="language-python">    for line in read_lines("example.txt"):
        print(line)
</code></pre>
</li>
<li>
<p><code>assert</code>è¯­å¥ï¼è¯¥è¯­å¥çä½ç¨æ¯ç¨äºå¨ç¨åºè¿è¡æ¶æ£æ¥æä¸ªæ¡ä»¶æ¯å¦æç«ï¼å¦æä¸æç«ï¼åä¼æåºä¸ä¸ª<code>AssertionError</code>å¼å¸¸ãå®éå¸¸è¢«ç¨æ¥è¿è¡è°è¯åæµè¯ãä¾å¦ï¼å¦ææä»¬å¸æå¨è¯»åææ¬æ¶ç¡®ä¿æ¯ä¸è¡é½ä¸æ¯ç©ºè¡ï¼å°±å¯ä»¥åä¸é¢è¿æ ·åï¼</p>
<pre><code class="language-python">num = 1
while line := readLine(text):
    assert line != "", "è¯»åå°ç©ºè¡ï¼ç¨åºç»æ­¢ã"
    print(f"{num}. {line}")
    num = num + 1
else:
    print(f"è¯»åå®æ¯ï¼å±è¯»åäº {num - 1} è¡ææ¬ã")
</code></pre>
</li>
</ul>
<h2 id="æ ååºçä½¿ç¨">æ ååºçä½¿ç¨</h2>
<p>é¤äºææ¡åºæ¬è¯­æ³ä¹å¤ï¼ç¨åºåçç¼ç¨è½åå®éä¸æ¯åå³äºä»å¦ä½æ ¹æ®èªå·±é¢å¯¹çé®é¢æ¾å°éç¨çç¨åºåºï¼åæ¬æ¡æ¶ï¼ï¼å¹¶å¨åççæ¶é´åææ¡å®ä»¬çä½¿ç¨æ¹æ³ï¼å¹¶ç¨å®å¿«éå°æå»ºèªå·±çé¡¹ç®ãå¨ Python è¯­è¨ä¸­ï¼æä»¬å¯ä»¥ä½¿ç¨çç¨åºåºï¼ä¸æ¡æ¶ï¼éå¸¸å¯ä»¥è¢«åä¸ºä¸¤å¤§ç±»ï¼ä¸ç±»æ¯ç± Python å®æ¹æä¾çæ ååºï¼å¦ä¸ç±»åæ¯ç±ç¨åºåèªå·±æç¹å®ç¬¬ä¸æ¹å¼åçæ©å±åºãä¸é¢ï¼è®©æä»¬åæ¥å·ä½ä»ç»ä¸ä¸æ ååºçä½¿ç¨æ¹æ³ã</p>
<p>æ ååºæ¯ Python è¿è¡æ¶ç¯å¢çä¸é¨åï¼éå¸¸ä¼éçè¯¥è¿è¡æ¶ç¯å¢ä¸åè¢«å®è£å°æä»¬çè®¡ç®æºè®¾å¤ä¸­ãPython å®æ¹æä¾çæ ååºéå¸¸åºå¤§ï¼æ¶åçèå´ä¹ååå¹¿æ³ï¼å¶ä¸­åå«äºå¤ä¸ªåç½®æ¨¡å (ä»¥ C ç¼å)ï¼ç¨åºåä»¬å¿é¡»ä¾é å®ä»¬æ¥å®ç°ç³»ç»çº§çåè½ï¼ä¾å¦æä»¶çè¾å¥è¾åºï¼ï¼æ­¤å¤è¿æå¤§éä»¥ Python ç¼åçæ¨¡åï¼æä¾äºæ¥å¸¸ç¼ç¨ä¸­è®¸å¤é®é¢çæ åè§£å³æ¹æ¡ãä¸é¢ï¼æä»¬æ¥åä¸¾ä¸äºå¨å®éå¼åä¸­å¸¸å¸¸ä¼ç¨å°æ ååºæ¨¡åã</p>
<ul>
<li><code>sys</code>æ¨¡åï¼è¯¥æ¨¡åä¸»è¦ç¨äºè®¿é®åä¿®æ¹ç³»ç»ç¸å³ä¿¡æ¯ï¼ä¾å¦æ¥çå½åä½¿ç¨ç Python çæ¬ãç³»ç»ç¯å¢åéãæ¨¡åä¿¡æ¯å Python è§£éå¨ç¸å³ä¿¡æ¯ç­ã</li>
<li><code>os</code>æ¨¡åï¼è¯¥æ¨¡åä¸»è¦ç¨äºæ¯ææ§è¡æä½ç³»ç»ç¸å³çæä½ï¼å®æä¾äºè®¿é®æä½ç³»ç»åºå± API çæ¹å¼ãä¾å¦ï¼è°ç¨å¯æ§è¡è¾å¥è¾åºãæä»¶è¯»åãè¯»åå¼å¸¸éè¯¯ä¿¡æ¯ãè¿ç¨çº¿ç¨ç®¡çãæä»¶ç®¡çãè°åº¦ç¨åºç­æä½ç APIã</li>
<li><code>re</code>æ¨¡åï¼è¯¥æ¨¡åä¸»è¦ç¨äºæ¯ææ­£åè¡¨è¾¾å¼æä½ãéå¸¸æåµä¸ï¼å¨é¢å¯¹å¤§éå­ç¬¦ä¸²å¤çéæ±çæ¶åï¼ä½¿ç¨æ­£åè¡¨è¾¾å¼æ¯æå¿«éææçæ¹å¼ã</li>
<li><code>math</code>æ¨¡åï¼è¯¥æ¨¡åä¸»è¦ç¨äºæ¯ææ°å­¦è¿ç®ï¼å®æä¾äºå¯¹ C è¯­è¨æ åå®ä¹çæ°å­¦å½æ°è®¿é®ãä¾å¦ï¼å®ç°æ°è®ºçåç§è¡¨ç¤ºæ¹æ³ãå¹åå¯¹æ°å½æ°ãä¸è§å½æ°ãå¸¸éåå¨çåèªç¶å¸¸æ°ç­ã</li>
<li><code>random</code>æ¨¡åï¼è¯¥æ¨¡åä¸»è¦ç¨äºçæä¼ªéæºæ°ï¼å¯ä»¥æ¨¡æç°å®ä¸çä¸­éæºåæ°ãéæºæ½å¥ç­ãéè¦æ³¨æçæ¯ï¼çå®çéæºæ°åæ¬æ¯éè¿ç©çè¿ç¨å®è·µå¾åºç»è®ºï¼èä¼ªéæºæ°åæ¯éè¿è®¡ç®æºçç¹å®ç®æ³çæçæ°ï¼æä»¥åèæ¯å¯é¢æµçãæè§å¾çï¼åªæ¯å¾ªç¯å¨æè¾é¿ï¼å¹¶ä¸è½ä¸ç°å®åºæ¯ç¸ååã</li>
<li><code>logging</code>æ¨¡åï¼è¯¥æ¨¡åæ¯ä¸»è¦ç¨äºæ¯ææ§è¡ä¸æ¥å¿è®°å½ç¸å³çå·¥ä½ï¼å®æä¾äºå¯¹åºç¨ç¨åºååºå½æ°çæ¥å¿è®°å½ï¼æ¥å¸¸å¼åä¸­æä»¬ç»å¸¸éè¦éè¿æ¥å¿æå°åºå½åç¨åºçè¿è¡ç¶æï¼å®æ¶æ¥çå¯è½åºç°çå æ å¼å¸¸åéè¯¯ä¿¡æ¯ã</li>
<li><code>json</code>æ¨¡åï¼è¯¥æ¨¡åä¸»è¦ç¨äºæ¯æ JSON æ°æ®çç¼ç åè§£ç ãå¨æ¥å¸¸å¼åä¸­ï¼æä»¬ç»å¸¸éè¦å¨ç¨åºçååç«¯ä¹é´ä¼ è¾ JSON æ ¼å¼çæ°æ®ï¼å¹¶å¯¹å¶è¿è¡åºåååååºååæä½ï¼èåºåååååºååæ¬è´¨ä¸å°±æ¯ç¼ç åè§£ç çå·¥ä½ã</li>
<li><code>socket</code>æ¨¡åï¼è¯¥æ¨¡åä¸»è¦ç¨äºæ§è¡ä¸åºå±ç½ç»ç¸å³çæä½ï¼å®æä¾äº BSD æ åç Socket APIï¼å¯ä»¥éè¿è®¿é®åºå±æä½ç³»ç» Socket çç¸å³æ¥å£è¿è¡ç½ç»éè®¯ã</li>
<li><code>urllib</code>æ¨¡åï¼è¯¥æ¨¡åä¸»è¦ç¨äºæ§è¡ä¸ URLï¼ç»ä¸èµæºå®ä½ç¬¦ï¼å¤çç¸å³çæä½ï¼å¶ä¸­éæäºç¨äºåæå® URL åéè¯·æ±å¹¶å¤çå¶ååºæ°æ®çåç§å½æ°ã</li>
<li><code>threading</code>æ¨¡åï¼è¯¥æ¨¡åä¸»è¦ç¨äºæ§è¡ä¸å¤çº¿ç¨å¹¶è¡ç¸å³çæä½ï¼éå¯¹å¤çº¿ç¨å¹¶åçé®é¢å¯ä»¥ç»æ°æ®å åæ­¥éï¼ä¸æ¬¡åªè½è®©ä¸ä¸ªçº¿ç¨å¤çæ°æ®ï¼ä»èé¿ååºç°æ°æ®è¯»åæ··ä¹±ãå¨ CPython è§£éå¨ä¸ï¼å ä¸º GILï¼å¨å±è§£éå¨éï¼éæºå¶çå­å¨çï¼è¢«è®¾è®¡æçº¿ç¨å®å¨ï¼æä»¥åä¸æ¶é´åªè½æ§è¡ä¸ä¸ªçº¿ç¨ï¼è¿å°±å¯¼è´äºå¤çº¿ç¨ä¸è½åæ¥åºè®¡ç®æºçå¤æ ¸ç¹æ§ã</li>
<li><code>multiprocessing</code>æ¨¡åï¼è¯¥æ¨¡åä¸»è¦ç¨äºæ§è¡ä¸å¤è¿ç¨å¹¶è¡ç¸å³çæä½ï¼å®çåè½ä¸<code>threading</code>æ¨¡åå¾ç±»ä¼¼ï¼ä¸åçæ¯è¿ç¨åºå¯ä»¥åå»ºå­è¿ç¨é¿å¼ GILï¼ä»èå¼¥è¡¥çº¿ç¨åºå­å¨çå£å¿ååæ¥è®¡ç®æºçå¤æ ¸ç¹æ§ã</li>
<li><code>asyncio</code>æ¨¡åï¼è¿æ¯ä¸ä¸ªæ¯æç¨<code>async/await</code>å³é®å­ç¼åå¹¶åæä½çæ¨¡åï¼å®ä¸ºå¤ä¸ªå¼æ­¥æ¡æ¶æä¾åºç¡åè½ï¼è½å¤å¸®å©ç¨åºåä»¬å®ç°é«æ§è½çç½ç»ãWeb æå¡å¨ãæ°æ®åºè¿æ¥ååå¸å¼ä»»å¡éåç­ã</li>
<li><code>copy</code>æ¨¡åï¼è¯¥æ¨¡åä¸»è¦ç¨äºæ§è¡ä¸æµå±ãæ·±å±å¤å¶ç¸å³çæä½ãæä»¬é½ç¥éè¦å¶ä½å¯¹è±¡å¯æ¬ï¼æ¯æ æ³éè¿ç®åå¼ä¼ éåå»ºæ°åéçæ¹å¼åå°ï¼å ä¸ºæ°åéææåçåå­ç©ºé´ä¾æ§æ¯åå¯¹è±¡æ¬èº«ï¼æä»¥å¯¹æ°åéè¿è¡ä»»ä½æä½é½ä¼æ¹ååå¯¹è±¡ãé£ä¹ï¼ <code>copy</code>æ¨¡åå°±æä¾äºå¶ä½å¯¹è±¡å¯æ¬çåç§æ¹æ³ï¼ä¼å¼è¾ä¸ä¸ªæ°çåå­ç©ºé´å­æ¾å¯æ¬å¯¹è±¡ï¼ä¿®æ¹æä½ä¸ä¼å¯¹åå¯¹è±¡æä»»ä½å¹²é¢ã</li>
<li><code>profile</code>ã<code>pstats</code>æ¨¡åï¼è¿ä¸¤ä¸ªæ¨¡åä¸»è¦ç¨äºæ§è¡ä¸æ§è½åæç¸å³çæä½ãå¶ä¸­ï¼<code>profile</code>æ¨¡åæä¾äº<code>profile</code>å<code>cProfile</code>ä¸¤ç§ä¸åå®ç°çæ§è½åæå·¥å·ï¼å¯ç¨æ¥æè¿°ç¨åºåä¸ªé¨åçæ§è¡æ¶é´åé¢çï¼ç»è®¡åçä¿¡æ¯å¯ä»¥éè¿<code>pstats</code>æ¨¡åä¿å­å¹¶ä½¿ç¨ã</li>
<li><code>unittest</code>æ¨¡åï¼è¯¥æ¨¡åä¸»è¦ç¨äºæ§è¡ä¸ååæµè¯ç¸å³çæä½ï¼å®å¨è®¾è®¡ä¸åå° JUnit åå¶ä»ä¸»æµæµè¯åºçå¯åï¼å æ­¤å¨ä½¿ç¨æ¹å¼æ¹é¢ä¸å®ä»¬æçç¸ä¼¼çé£æ ¼ã</li>
</ul>
<p>å¨ Python è¯­è¨ä¸­ï¼ä½¿ç¨æ ååºçæ¹å¼æ¯éå¸¸ç®åä¸ç´è§çï¼å¤§ä½ä¸åªéè¦æ§è¡ä¸¤ä¸ªæ­¥éª¤å³å¯ãä¸é¢ï¼è®©æä»¬åå©ä¸ä¸ªä½¿ç¨<code>threading</code>æ¨¡åçç¤ºä¾æ¥ä¸ºè¯»èæ¼ç¤ºä¸ä¸è¿ä¸¤ä¸ªæ­¥éª¤ãå·ä½åæ³æ¯å¨ä¹ååå»ºç<code>say_hello</code>é¡¹ç®çæ ¹ç®å½åå»ºä¸ä¸ªåä¸ºç<code>example_threading.py</code>æä»¶ï¼å¹¶å¨å¶ä¸­è¾å¥å¦ä¸ä»£ç ï¼</p>
<pre><code class="language-python"># ç¬¬ä¸æ­¥ï¼ä½¿ç¨ import è¯­å¥å¨å½åä½ç¨åä¸­å¯¼å¥è¦ä½¿ç¨çæ¨¡åï¼
import threading
import time
# å¦æåªéè¦å¯¼å¥ time æ¨¡åä¸­ç sleep å½æ°ï¼
# ä¹å¯ä»¥ä½¿ç¨ from ... import è¯­å¥ï¼ä¾å¦ï¼
# from time import sleep 

# ç¬¬äºæ­¥ï¼æ ¹æ®å®æ¹ææ¡£ä¸­çè¯´æï¼æ ¹æ®èªå·±çéè¦æ¥è°ç¨æ¨¡åæä¾çæ¹æ³ï¼
def loop():
    print('thread %s is running...' % threading.current_thread().name)
    n = 0
    while (n &lt; 5):
        n = n + 1
        print('thread %s &gt;&gt;&gt; %s' % (threading.current_thread().name, n))
        time.sleep(1) # ç­å¾ 1 ç§
        # å¦æä¹åæ¯ä½¿ç¨ from ... import è¯­å¥å¯¼å¥ç sleep å½æ°ï¼
        # è¿éå°±åªéè°ç¨ sleep(1) å³å¯

    print('thread %s ended.' % threading.current_thread().name)

print('thread %s is running...' % threading.current_thread().name)
t = threading.Thread(target=loop, name='LoopThread')
t.start()
t.join()
print('thread %s ended.' % threading.current_thread().name)
</code></pre>
<p>å¨ä¿å­äºä¸è¿°ä»£ç ä¹åï¼æä»¬å°±å¯ä»¥å¨ç»ç«¯ä¸­è¿è¡<code>python example_threading.py</code>å½ä»¤æ¥æ§è¡å®ãå¦æä¸åé¡ºå©ï¼æä»¬å°ä¼çå°ç±»ä¼¼ä¸é¢çè¾åºï¼</p>
<pre><code class="language-python">thread MainThread is running...
thread LoopThread is running...
thread LoopThread &gt;&gt;&gt; 1
thread LoopThread &gt;&gt;&gt; 2
thread LoopThread &gt;&gt;&gt; 3
thread LoopThread &gt;&gt;&gt; 4
thread LoopThread &gt;&gt;&gt; 5
thread LoopThread ended.
thread MainThread ended.
</code></pre>
<p>æ­£å¦è¯»èæè§ï¼ä½¿ç¨æ ååºçæ­¥éª¤éå¸¸ç®åï¼ç¬¬ä¸æ­¥æ¯ä½¿ç¨<code>import</code>è¯­å¥å°éè¦ä½¿ç¨çæ¨¡åå¯¼å¥å°å½åä½ç¨åä¸­ï¼ç¬¬äºæ­¥åæ¯æ ¹æ® Python æ ååºçææ¡£æ¥éæ©è¦è°ç¨çæ¹æ³ï¼ç¨äºå®ç°èªå·±çéæ±ãå³äºè¿æ¹é¢çä¿¡æ¯ï¼è¯»èå¯ä»¥åå¾Python å®æ¹ç<a href="https://docs.python.org/3/library/index.html" target="_blank" rel="noopener nofollow">çº¿ä¸ææ¡£</a>æ¥æ¥éãéè¦æ³¨æçæ¯ï¼Python çæ ååºæ¯éå¸¸åºå¤§çï¼åå«äºå¤§éçæ¨¡ååå½æ°ï¼å æ­¤å¨å®éå¼åä¸­ï¼æä»¬éå¸¸åªä¼ä½¿ç¨å¶ä¸­çä¸å°é¨åãä¸ºäºæ´å¥½å°ææ¡æ ååºçä½¿ç¨æ¹æ³ï¼å»ºè®®è¯»èå¨ç¼åä»£ç æ¶å¤åèå®æ¹ææ¡£ï¼å¹¶ç»åå®ééæ±è¿è¡å­¦ä¹ åå®è·µã</p>
<h2 id="å­¦ä¹ ææéªæ¶">å­¦ä¹ ææéªæ¶</h2>
<p>ç°å¨ï¼æä»¬å°±åºæ¬ä»ç»å®äº Python è¿é¨ç¼ç¨è¯­è¨çåºæ¬è¯­æ³è§åãå¦ææ³è¦ä½¿ç¨è¿é¨è¯­è¨å®æåç§å·ä½åºç¨çå¼åå·¥ä½ï¼ææ¡å®çåºæ¬è¯­æ³è§ååå¶æ ååºçä½¿ç¨æ¹æ³æ çæ¯åå³æ¡ä»¶ãè½ç¶å¨è¿ä¸ªç³»åçåç»­ç¬è®°ä¸­ï¼æä¼åè®¾è¯»èå·²ç»æ»¡è¶³äºè¿ä¸åå³æ¡ä»¶ï¼ä½å¯¹äºâææ¡âç¨åº¦ï¼æä»¬è¿æ¯å¸æååè¯»èçº¦å®ä»¥ä¸æ åãé¦åï¼è¯»èéè¦ææ¡çæ¯ Python è¯­è¨çæ åè¯­æ³ï¼åæ¬çµæ´»è¿ç¨åç§è¡¨è¾¾å¼è¯­å¥ãæ¡ä»¶è¯­å¥ãå¾ªç¯è¯­å¥ï¼ä»¥åä¼ä½¿ç¨æ ååºæä¾çåç§æ°æ®ç±»ååæ°æ®ç»æï¼ææ¡è¿ä¸è½åçæ åæ¯è½çè§£ä¸é¢ä»£ç ä¸­å®ç°çåç§æåºç®æ³ï¼å¹¶è½æ­£ç¡®å°è°ç¨å®ä»¬ï¼</p>
<pre><code class="language-python">import random

# çº¿æ§æç´¢
def linear_search(arr, target):  
    for i in range(len(arr)):
        if arr[i] == target:
            return i
    return -1

# äºåæç´¢
def binary_search(arr, target):
    left, right = 0, len(arr) - 1
    while left &lt;= right:
        mid = (left + right) // 2
        if arr[mid] == target:
            return mid
        elif arr[mid] &lt; target:
            left = mid + 1
        else:
            right = mid - 1
    return -1

# éæ©æåº
def selection_sort(arr):
    n = len(arr)
    for i in range(n - 1):
        min_idx = i
        for j in range(i + 1, n):
            if arr[j] &lt; arr[min_idx]:
                min_idx = j
        arr[i], arr[min_idx] = arr[min_idx], arr[i]
    return arr

# å¿«éæåº
def quick_sort(arr):
    if len(arr) &lt;= 1:
        return arr
    pivot = arr[0]
    left = [x for x in arr[1:] if x &lt; pivot]
    right = [x for x in arr[1:] if x &gt;= pivot]
    return quick_sort(left) + [pivot] + quick_sort(right)
</code></pre>
<p>æåï¼å¨æçæ³çæåµä¸ï¼è¯»èè¿åºè¯¥å·å¤ä¸äºè½åºäºæ ååºæ¥ç¼åèªå¨åèæ¬çè½åï¼ä¾å¦è½çè§£å¹¶å¤è¿°ä¸é¢è¿æ®µå®ç° Git æäº¤æä½çèªå¨åèæ¬ã</p>
<pre><code class="language-python"># -*- coding: utf-8 -*-
"""
æ¬èæ¬éç¨äºå¨ Linux æ macOS ç³»ç»ä¸èªå¨åæ§è¡ Git æäº¤æä½ï¼
Windows ç¨æ·å¯ä»¥èªè¡è°æ´ä¸ä¸èæ¬ä¸­æ§è¡çå½ä»¤ã
ä½¿ç¨æ¹æ³ï¼å°èæ¬ä¿å­ä¸º git_commit.pyï¼å¹¶å¨ç»ç«¯ä¸­è¿è¡ python git_commit.py &lt;git_dir&gt; [commit_message]
å¶ä¸­ &lt;git_dir&gt; æ¯ Git ä»åºçè·¯å¾ï¼commit_message æ¯å¯éçæäº¤ä¿¡æ¯ã
"""

import os
import sys
import time

if not len(sys.argv) in range(2, 4):
    print("Usage: git_commit.py &lt;git_dir&gt; [commit_message]") 
    exit(1)

title = "=    Starting " + sys.argv[0] + "......    ="
n = len(title)
print(n*'=')
print(title)
print(n*'=')

os.chdir(sys.argv[1])
print("work_dir: " + sys.argv[1])
if len(sys.argv) == 3 and sys.argv[2] != "":
    commit_message = sys.argv[2]
else:
    commit_message = "committed at " + time.strftime("%Y-%m-%d",time.localtime(time.time()))

os.system("git add .")
os.system("git commit -m '"+ commit_message + "'")

print("Commit is complete!")

print(n*'=')    
print("=     Done!" + (n-len("=     Done!")-1)*' ' + "=")
print(n*'=')
</code></pre>
<p>éè¦è¯´æçæ¯ï¼ç±äºæä»¬å¨è¿éä¸ºäºè®©ä¸è¿°ç¤ºä¾æ¾å¾æµæ¾ææä¸äºï¼éæ©äºç¨<code>os</code>æ ååºæ¨¡åä¸­ç<code>system()</code>æ¹æ³æ¥æ§è¡èæ¬çå¤é¨å½ä»¤ï¼ä½è¿ä¼å¸¦æ¥è¯¸å¦ shell æ³¨å¥ä¹ç±»çå®å¨é£é©ï¼ä¾å¦æ¶ææ§è¡<code>rm -rf /</code>è¿æ ·çå½ä»¤ï¼ãå æ­¤å¨å®éå¼åä¸­ï¼æä»¬æ´æ¨èä½¿ç¨<code>subprocess</code>è¿ä¸ªæ ååºæ¨¡åæ¥æ§è¡èæ¬çå¤é¨å½ä»¤ï¼è½ç¶ä½¿ç¨èµ·æ¥ä¼æ´å¤æä¸äºï¼ä½å®ä¼è®©èæ¬çæ§è¡æ´å®å¨ï¼ä¹è½æ´å¥½å¤çä¸ç¨æ·çäº¤äºã</p>
<p>å¦æè¯»èå¨åºäºä»¥ä¸æ åçèªææ£éªä¸­éå°äºä¸äºä¸å¯åé¿çé®é¢ï¼æä»¬ä¼å¼ºçå»ºè®®ååè¿å¤´å»è¡¥ä¹ ä¸ä¸ Python è¯­è¨çåºç¡ç¥è¯ï¼ä¾å¦å»éè¯»ä¸ä¸æå¨ã[[å³äºPythonçå­¦ä¹ |Python çå­¦ä¹ è·¯çº¿å¾]]ãä¸æä¸­æ¨èçåºç¡ææï¼ç­è¾¾å°äºæä»¬å¨è¿éçº¦å®çå¯¹åºç¡ç¥è¯çâææ¡âæ åï¼åç»§ç»­å­¦ä¹ åé¢çåå®¹ï¼ä»¥ä¾¿å®ç°æå¥½çå­¦ä¹ ææã</p>
<h2 id="å°ç»">å°ç»</h2>
<p>å¨è¿ç¯ç¬è®°ä¸­ï¼æä»¬é¦åä»ç»äº Python è¯­è¨çåºæ¬è¯­æ³è§åï¼åæ¬åéãæ°æ®ç±»åãè¡¨è¾¾å¼è¯­å¥ãæ¡ä»¶è¯­å¥ãå¾ªç¯è¯­å¥ãå½æ°ãæ¨¡åãç±»åå¼å¸¸å¤çç­ãæ¥çï¼æä»¬ä»ç»äº Python æ ååºçä½¿ç¨æ¹æ³ï¼å¹¶ç»åºäºä¸ä¸ªä½¿ç¨æ ååºå®ç°å¤çº¿ç¨çç¤ºä¾ãæåï¼æä»¬ç»åºäºå­¦ä¹ ææéªæ¶çæ åï¼å¹¶å¸æè¯»èè½æ ¹æ®è¿ä¸ªæ åæ¥æ£éªèªå·±çå­¦ä¹ ææã</p>

</div>
<div class="clear"></div>

        <p class="postfoot">
            posted on 
<span id="post-date" data-last-update-days="0.0006944444444444445" data-date-updated="2026-01-20 11:35">2026-01-20 11:34</span>&nbsp;
<a href="https://www.cnblogs.com/owlman">åæ°</a>&nbsp;
éè¯»(<span id="post_view_count">132</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19505712);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19505712', targetLink: 'https://www.cnblogs.com/owlman/p/19505712', title: 'Python å­¦ä¹ ç¬è®°ï¼åºç¡è¯­æ³å­¦ä¹ ' })">ä¸¾æ¥</a>

        </p>
     ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ APEXå®æç¬¬10ç¯ï¼ææææä½ ç»APEXæè¡¥ä¸ ]]></title>
    <link>https://www.cnblogs.com/jyzhao/p/19508942/apex-shi-zhan-di10pian-shou-ba-shou-jiao-ni-geiape</link>
    <guid>353027752934ae770e06a6aebb1e27fa</guid>
    <description>
    <![CDATA[ 
    <a name="top"></a>
    <h2><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/jyzhao/p/19508942/apex-shi-zhan-di10pian-shou-ba-shou-jiao-ni-geiape" title="åå¸äº 2026-01-20 22:15">
    <span role="heading" aria-level="2">APEXå®æç¬¬10ç¯ï¼ææææä½ ç»APEXæè¡¥ä¸</span>
    

</a>
</h2>
    <small>
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-20 22:15">2026-01-20 22:15</span>&nbsp;
<a href="https://www.cnblogs.com/jyzhao">AlfredZhao</a>&nbsp;
éè¯»(<span id="post_view_count">11</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19508942);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19508942', targetLink: 'https://www.cnblogs.com/jyzhao/p/19508942/apex-shi-zhan-di10pian-shou-ba-shou-jiao-ni-geiape', title: 'APEXå®æç¬¬10ç¯ï¼ææææä½ ç»APEXæè¡¥ä¸' })">ä¸¾æ¥</a>
</small>
    <div class="entry">
        <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>è¿ä¸æææ¯ä¸æ²¡ä»ä¹é¾åº¦ï¼ä½å´å¾éè¦ï¼å ä¸ºä»»ä½ä¼ä¸çº§è½¯ä»¶ï¼å®æåºç¨è¡¥ä¸æ¯å¾å¿è¦çï¼å¯ä»¥ææè§é¿å¾å¤å·²ç¥bugã</p>
<p>ä¸é¢æä»¬å°±ä»¥ <code>APEX 24.2</code> çæ¬ä¸ºä¾ï¼ä½¿ç¨MOSå¯ä»¥ç´æ¥æå°ææ°çè¡¥ä¸éä¿¡æ¯ï¼è¿æ¯ä¸ä¸ªæåæåå¸çbundleåï¼å¶ä¸­å·²ç»åå«äºç®åææ°ç <code>24.2.12</code> è¡¥ä¸éï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/635610/202601/635610-20260120221500169-644256984.jpg" alt="" loading="lazy"></p>
<p>ç¹å» <code>Download</code>ï¼ä¸è½½ï¼åªæ2.6Må¤§å°ã</p>
<p><img src="https://img2024.cnblogs.com/blog/635610/202601/635610-20260120221500138-290754377.jpg" alt="" loading="lazy"></p>
<p>ç¶åä¸¥æ ¼æç§READMEè¯´æè¿è¡æä½å³å¯ãè¿éæç§ç¬èçLinuxç¯å¢ï¼å®éæ§è¡æ­¥éª¤å¦ä¸ï¼</p>
<h2 id="1ä¸è½½çè¡¥ä¸ä»è´¨ä¸ä¼ å°apexç¯å¢çä»»æç®å½ä¸">1.ä¸è½½çè¡¥ä¸ä»è´¨ä¸ä¼ å°APEXç¯å¢çä»»æç®å½ä¸</h2>
<ul>
<li>p37366599_242_GENERIC.zip</li>
</ul>
<h2 id="2è§£åè¡¥ä¸ä»è´¨">2.è§£åè¡¥ä¸ä»è´¨</h2>
<ul>
<li>unzip p37366599_242_GENERIC.zip</li>
</ul>
<h2 id="3å³é­ordsæå¡">3.å³é­ORDSæå¡</h2>
<p>å®è£æ¶è¦æ±å³é­ORDSä»¥é»æ­¢å¯¹ORDSåAPEXçè®¿é®ï¼</p>
<blockquote>
<ol start="3">
<li>
<p>Preventing Access to Oracle REST Data Services</p>
<p>It is important that no developers or end users access Oracle APEX while you are applying the patch. This section describes how to prevent access to Oracle APEX.</p>
<p>Stopping Oracle REST Data Services:</p>
<p>To learn more about stopping the Oracle REST Data Services server, see Oracle REST Data Services Installation and Configuration Guide:</p>
<p><a href="https://docs.oracle.com/en/database/oracle/oracle-rest-data-services/index.html" target="_blank" rel="noopener nofollow">https://docs.oracle.com/en/database/oracle/oracle-rest-data-services/index.html</a></p>
</li>
</ol>
</blockquote>
<h2 id="4åæ¢å°37366599ç®å½ä¸">4.åæ¢å°37366599ç®å½ä¸</h2>
<ul>
<li>cd 37366599</li>
</ul>
<h2 id="5è®¾ç½®nls_langç¯å¢åé">5.è®¾ç½®NLS_LANGç¯å¢åé</h2>
<ul>
<li>NLS_LANG=American_America.AL32UTF8</li>
<li>export NLS_LANG</li>
</ul>
<h2 id="6sysç¨æ·æ§è¡èæ¬">6.sysç¨æ·æ§è¡èæ¬</h2>
<p>å®æ¹å®è£è¯´æè¯¦ç»çç»åºäºå ç§ä¸åæåµï¼å¯¹åºç¬èå®éæåµï¼åªæ¯å¨æä¸ä¸ªPDBä¸å®è£äºAPEXï¼<br>
å æ­¤è¿éåªå¨å®è£äºAPEXçPDBä¸æ§è¡è¿ä¸ªèæ¬å³å¯ï¼</p>
<ul>
<li>@catpatch.sql</li>
</ul>
<p>æ§è¡å®æï¼ç¡®è®¤æ²¡ææ¥éï¼åæ¥è¯¢ä¸APEXç»ä»¶ç¶æOKï¼</p>
<pre><code class="language-SQL">SELECT comp_id, comp_name, version, status 
FROM dba_registry 
WHERE comp_id = 'APEX';
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/635610/202601/635610-20260120221500130-878148293.jpg" alt="" loading="lazy"></p>
<h2 id="7-éå¯¹imagesç®å½çæ´æ°">7. éå¯¹imagesç®å½çæ´æ°</h2>
<blockquote>
<p>Install the Patch Set Exception's changes in the images directory</p>
<p>cp -rf /tmp/images ORACLE_APEX_HOME/apex</p>
</blockquote>
<p>ç¬èæ³¨ï¼ç¹å«éè¦æ³¨æä¸è¿ä¸ªæ·è´ï¼æå¥½åä½¿ç¨å½ä»¤ <code>ords config list</code> æ¥è¯¢ç¡®è®¤ä¸ï¼èªå·±çéç½®æ¯å¦ç¸åï¼æ¯å¦ç¬èè¿éè·¯å¾å°±ä¸æ¯é»è®¤çimagesï¼</p>
<blockquote>
<p>standalone.static.path                   /u02/app/apex/apex_images              Global</p>
</blockquote>
<p>è¿æ¯å ä¸ºç¬èä¹åå®è£æ¯æåæ¬çimageså¤å¶äºä¸ä»½apex_imagesï¼æä»¥è¿éåºè¯¥ææ°çimagesä¸é¢çæä»¶æ·è´å°apex_imagesè¿ä¸ªç®å½ä¸æå¯¹ï¼å¦æä½ æ²¡æè¿æ ·çæåµï¼å°±ç´æ¥å¤å¶å½ä»¤å³å¯ã</p>
<h2 id="8å¯å¨ordsç»å½apexéªè¯">8.å¯å¨ORDSï¼ç»å½APEXéªè¯</h2>
<p>ä¸åæ­£å¸¸ï¼APEXä¸»é¡µè¿é <code>Available Updates</code> æ¾ç¤ºç³»ç»å·²æ¯ææ°ç¶æï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/635610/202601/635610-20260120221500019-1301140551.jpg" alt="" loading="lazy"></p>
<p>APEXçé¢çå³ä¸è§è¿å¯ä»¥çå°å·ä½çæ¬å·ï¼å°±æ¯æä»¬æ¬æ¬¡å®è£ç <code>Oracle APEX 24.2.12</code>ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/635610/202601/635610-20260120221459988-1096283148.jpg" alt="" loading="lazy"></p>
<p>è³æ­¤ï¼å·²å®æç»APEXæè¡¥ä¸çå¨é¨å·¥ä½ã</p>

</div>
<div id="MySignature" role="contentinfo">
    <a href="https://www.cnblogs.com/jyzhao/" target="_blank">AlfredZhao</a>Â©çæææãä»Oracleèµ·èªï¼é¢ç¥ç²¾å½©çITææ¯ãã<br>
è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/jyzhao/p/19508942/apex-shi-zhan-di10pian-shou-ba-shou-jiao-ni-geiape" target="_blank">https://www.cnblogs.com/jyzhao/p/19508942/apex-shi-zhan-di10pian-shou-ba-shou-jiao-ni-geiape</a>
<hr>
<div style="text-align:center; margin-top:30px;">
  <p style="font-size:14px;color:#555;">
    ð æè°¢éè¯»ï¼æ¬¢è¿å³æ³¨æçå¬ä¼å· <b>ãèµµéå®ã</b>
  </p>
  <img src="https://images.cnblogs.com/cnblogs_com/jyzhao/824234/o_250208075013_qrcode-zjy.jpg" width="160" style="border:1px solid #ddd;border-radius:8px;">
</div>
</div>
<div class="clear"></div>

        <div class="clear"></div>
        
</div>
    <ul class="postmetadata">
        <vc:categories-tags blog-app="jyzhao" blog-id="186567" post-id="19508942"></vc:categories-tags>
    </ul>
 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Flinkæºç éè¯»ï¼Kafka Connector ]]></title>
    <link>https://www.cnblogs.com/Jackeyzhe/p/19508927</link>
    <guid>52654da949fcb05e8e891777bcbca596</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Jackeyzhe/p/19508927" title="åå¸äº 2026-01-20 22:03">
    <span role="heading" aria-level="2">Flinkæºç éè¯»ï¼Kafka Connector</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/1828322/202601/1828322-20260120220247061-350106518.png" alt="Flinkæºç éè¯»ï¼Kafka Connector" class="desc_img">
        æ¬ææä»¬æ¥æ¢³ç Kafka Connector ç¸å³çæºç ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æ¬ææä»¬æ¥æ¢³ç Kafka Connector ç¸å³çæºç ã</p>
<h3 id="èªå®ä¹-source-å-sink">èªå®ä¹ Source å Sink</h3>
<p>å¨ä»ç» Kafka Connector ä¹åï¼æä»¬åæ¥çä¸ä¸å¨ Flink ä¸­æ¯å¦ä½æ¯æèªå®ä¹ Source å Sink çãæä»¬æ¥çä¸å¼  Flink å®æ¹ææ¡£æä¾çå¾ã</p>
<p><img alt="tableconnector" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1768288302/Blog/flink/22/table_connectors.png" class="lazyload"></p>
<p>è¿å¼ å¾å±ç¤ºäº Connector çåºæ¬ä½ç³»ç»æï¼ä¸å±æ¶æä¹éå¸¸æ¸æ°ã</p>
<h4 id="metadata">Metadata</h4>
<p>é¦åæ¯æä¸å±ç MetaDataï¼CREATE TABLE ä¼æ´æ° Catalogï¼ç¶åè¢«è½¬æ¢ä¸º TableAPI ç CatalogTableï¼CatalogTable å®ä¾ç¨äºè¡¨ç¤ºå¨æè¡¨ï¼Source æ Sink è¡¨ï¼çåä¿¡æ¯ã</p>
<h4 id="planning">Planning</h4>
<p>å¨è§£æåä¼åç¨åºæ¶ï¼ä¼å° CatalogTable è½¬æ¢ä¸º DynamicTableSource å DynamicTableSinkï¼åå«ç¨äºæ¥è¯¢åæå¥æ°æ®ï¼è¿ä¸¤ä¸ªå®ä¾çåå»ºé½éè¦å¯¹åºçå·¥åç±»ï¼å·¥åç±»çå®æ´è·¯å¾éè¦æ¾å°è¿ä¸ªéç½®æä»¶ä¸­ã</p>
<pre><code class="language-bash">META-INF/services/org.apache.flink.table.factories.Factory
</code></pre>
<p>å¦ææéè¦çè¯ï¼æä»¬è¿å¯ä»¥å¨è§£æè¿ç¨ä¸­éç½®ç¼ç åè§£ç æ¹æ³ã</p>
<p>å¨ Source ç«¯ï¼éè¿ä¸ä¸ªæ¥å£æ¯æä¸åçæ¥è¯¢è½åã</p>
<ul>
<li>
<p>ScanTableSourceï¼ç¨äºæ¶è´¹ changelog æµï¼æ«æçæ°æ®æ¯æ insertãupdataãdelete ä¸ç§ç±»åãScanTableSource è¿æ¯æå¾å¤å¶ä»çåè½ï¼ é½æ¯éè¿æ¥å£æä¾çãå·ä½å¯ä»¥çåèè¿ä¸ªè¿æ¥</p>
<pre><code class="language-bash">https://nightlies.apache.org/flink/flink-docs-release-2.2/docs/dev/table/sourcessinks/#source-abilities
</code></pre>
</li>
<li>
<p>LookupTableSourceï¼LookupTableSource ä¸ä¼å¨éè¯»åè¡¨çæ°æ®ï¼å®å¨éè¦æ¶ä¼åéè¯·æ±ï¼æå è½½æ°æ®ãç®ååªæ¯æ insert-only åæ´æ¨¡å¼ã</p>
</li>
<li>
<p>VectorSearchTableSourceï¼ä½¿ç¨ä¸ä¸ªè¾å¥åéæ¥æç´¢æ°æ®ï¼å¹¶è¿åæç¸ä¼¼ç Top-K è¡æ°æ®ã</p>
</li>
</ul>
<p>å¨ Sink ç«¯ï¼éè¿ DynamicTableSink æ¥å®ç°å·ä½çåå¥é»è¾ï¼è¿éä¹æä¾äºä¸äºç¨äºæ©å±è½åçæ¥å£ãå·ä½åè</p>
<pre><code class="language-bash">https://nightlies.apache.org/flink/flink-docs-release-2.2/docs/dev/table/sourcessinks/#sink-abilities
</code></pre>
<h4 id="runtime">Runtime</h4>
<p>é»è¾è§£æå®æåï¼ä¼å° Runtime å±ãè¿éå°±æ¯å®ä¹å ä¸ª Providerï¼å¨ Provider ä¸­å®ç°åè¿æ¥å¨å·ä½çäº¤äºé»è¾ã</p>
<h4 id="å°ç»">å°ç»</h4>
<p>å½æä»¬éè¦åå»ºä¸ä¸ªèªå®ä¹ç Source å Sink æ¶ï¼å°±å¯ä»¥éè¿ä»¥ä¸æ­¥éª¤å®ç°ã</p>
<ol>
<li>
<p>å®ä¹ Flink SQL ç DDLï¼éè¦å®ä¹ç¸åºç Optionsã</p>
</li>
<li>
<p>å®ç° DynamicTableSourceFactory å DynamicTableSinkFactoryï¼å¹¶æå®ç°ç±»çå·ä½è·¯å¾åå°éç½®æä»¶ä¸­ã</p>
</li>
<li>
<p>å®ç° DynamicTableSource å DynamicTableSinkï¼è¿ééè¦å¤ç SQL å±çåæ°æ®ã</p>
</li>
<li>
<p>æä¾ Providerï¼å°é»è¾å±ä¸åºå± DataStream å³èèµ·æ¥ã</p>
</li>
<li>
<p>ç¼ååºå±ç®å­ï¼å®ç° Source å Sink æ¥å£ã</p>
</li>
</ol>
<h3 id="kafka-connector-çå®ç°">Kafka Connector çå®ç°</h3>
<p>å¸¦çè¿äºç¥è¯ï¼æä»¬ä¸èµ·æ¥çä¸ä¸ Kafka Connector ç¸å³çæºç ã</p>
<p>Kafka Connector ä»£ç ç®åå·²ç»æ¯ä¸ä¸ªç¬ç«çé¡¹ç®äºãé¡¹ç®å°åæ¯</p>
<pre><code class="language-bash">https://github.com/apache/flink-connector-kafka
</code></pre>
<h4 id="factory">Factory</h4>
<p>æä»¬é¦åæ¾å°å®ä¹çå·¥åç±»</p>
<pre><code class="language-java">org.apache.flink.streaming.connectors.kafka.table.KafkaDynamicTableFactory
org.apache.flink.streaming.connectors.kafka.table.UpsertKafkaDynamicTableFactory
</code></pre>
<p>ä»¥ KafkaDynamicTableFactory ä¸ºä¾ï¼å®åæ¶å®ç°äº DynamicTableSourceFactory å DynamicTableSinkFactory ä¸¤ä¸ªæ¥å£ã</p>
<p>KafkaDynamicTableFactory åå«ä»¥ä¸å ä¸ªæ¹æ³ã</p>
<p><img alt="KafkaDynamicTableFactory" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1768294001/Blog/flink/22/KafkaDynamicTableFactory.png" class="lazyload"></p>
<ul>
<li>
<p>factoryIdentifierï¼è¿åä¸ä¸ªå¯ä¸æ è¯ç¬¦ï¼å¯¹åº Flink SQL ä¸­ connector='xxx' è¿ä¸ªéç½®ã</p>
</li>
<li>
<p>requiredOptionsï¼å¿å¡«éç½®éåã</p>
</li>
<li>
<p>optionalOptionsï¼éå¡«éç½®éåã</p>
</li>
<li>
<p>forwardOptionsï¼ç´æ¥ä¼ éå° Runtime å±çéç½®éåã</p>
</li>
<li>
<p>createDynamicTableSourceï¼åå»º DynamicTableSourceã</p>
</li>
<li>
<p>createDynamicTableSinkï¼åå»º DynamicTableSinkã</p>
</li>
</ul>
<h4 id="source-ç«¯">Source ç«¯</h4>
<p>å·¥åç±»ç createDynamicTableSource æ¹æ³åå»ºäº DynamicTableSourceï¼æä»¬æ¥çä¸ä¸åå»ºçé»è¾ã</p>
<pre><code class="language-java">public DynamicTableSource createDynamicTableSource(Context context) {
    final TableFactoryHelper helper = FactoryUtil.createTableFactoryHelper(this, context);

    final Optional&lt;DecodingFormat&lt;DeserializationSchema&lt;RowData&gt;&gt;&gt; keyDecodingFormat =
            getKeyDecodingFormat(helper);

    final DecodingFormat&lt;DeserializationSchema&lt;RowData&gt;&gt; valueDecodingFormat =
            getValueDecodingFormat(helper);

    helper.validateExcept(PROPERTIES_PREFIX);

    final ReadableConfig tableOptions = helper.getOptions();

    validateTableSourceOptions(tableOptions);

    validatePKConstraints(
            context.getObjectIdentifier(),
            context.getPrimaryKeyIndexes(),
            context.getCatalogTable().getOptions(),
            valueDecodingFormat);

    final StartupOptions startupOptions = getStartupOptions(tableOptions);

    final BoundedOptions boundedOptions = getBoundedOptions(tableOptions);

    final Properties properties = getKafkaProperties(context.getCatalogTable().getOptions());

    // add topic-partition discovery
    final Duration partitionDiscoveryInterval =
            tableOptions.get(SCAN_TOPIC_PARTITION_DISCOVERY);
    properties.setProperty(
            KafkaSourceOptions.PARTITION_DISCOVERY_INTERVAL_MS.key(),
            Long.toString(partitionDiscoveryInterval.toMillis()));

    final DataType physicalDataType = context.getPhysicalRowDataType();

    final int[] keyProjection = createKeyFormatProjection(tableOptions, physicalDataType);

    final int[] valueProjection = createValueFormatProjection(tableOptions, physicalDataType);

    final String keyPrefix = tableOptions.getOptional(KEY_FIELDS_PREFIX).orElse(null);

    final Integer parallelism = tableOptions.getOptional(SCAN_PARALLELISM).orElse(null);

    return createKafkaTableSource(
            physicalDataType,
            keyDecodingFormat.orElse(null),
            valueDecodingFormat,
            keyProjection,
            valueProjection,
            keyPrefix,
            getTopics(tableOptions),
            getTopicPattern(tableOptions),
            properties,
            startupOptions.startupMode,
            startupOptions.specificOffsets,
            startupOptions.startupTimestampMillis,
            boundedOptions.boundedMode,
            boundedOptions.specificOffsets,
            boundedOptions.boundedTimestampMillis,
            context.getObjectIdentifier().asSummaryString(),
            parallelism);
}
</code></pre>
<p>å¨è¿ä¸ªæ¹æ³ä¸­ï¼é¦åè¦è·åå° key å value çè§£ç æ ¼å¼ãæ¥çæ¯åç§åæ°æ ¡éªåè·åå¿è¦çå±æ§ãæååå»º KafkaDynamicSource å®ä¾ã</p>
<p>è·åè§£ç æ ¼å¼éè¦ç¨å° DeserializationFormatFactory å·¥åï¼DeserializationFormatFactory æå¤ä¸ªå®ç°ç±»ï¼å¯¹åºäºå¤ç§æ ¼å¼çååºååæ¹æ³ã</p>
<p><img alt="DeserializationFormatFactory" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1768297428/Blog/flink/22/DeserializationFormatFactory.png" class="lazyload"></p>
<p>æä»¬æ¥çæ¯è¾å¸¸è§ç Json æ ¼å¼çå·¥å JsonFormatFactoryã</p>
<pre><code class="language-java">public DecodingFormat&lt;DeserializationSchema&lt;RowData&gt;&gt; createDecodingFormat(
        DynamicTableFactory.Context context, ReadableConfig formatOptions) {
    FactoryUtil.validateFactoryOptions(this, formatOptions);
    JsonFormatOptionsUtil.validateDecodingFormatOptions(formatOptions);

    final boolean failOnMissingField = formatOptions.get(FAIL_ON_MISSING_FIELD);
    final boolean ignoreParseErrors = formatOptions.get(IGNORE_PARSE_ERRORS);
    final boolean jsonParserEnabled = formatOptions.get(DECODE_JSON_PARSER_ENABLED);
    TimestampFormat timestampOption = JsonFormatOptionsUtil.getTimestampFormat(formatOptions);

    return new ProjectableDecodingFormat&lt;DeserializationSchema&lt;RowData&gt;&gt;() {
        @Override
        public DeserializationSchema&lt;RowData&gt; createRuntimeDecoder(
                DynamicTableSource.Context context,
                DataType physicalDataType,
                int[][] projections) {
            final DataType producedDataType =
                    Projection.of(projections).project(physicalDataType);
            final RowType rowType = (RowType) producedDataType.getLogicalType();
            final TypeInformation&lt;RowData&gt; rowDataTypeInfo =
                    context.createTypeInformation(producedDataType);
            if (jsonParserEnabled) {
                return new JsonParserRowDataDeserializationSchema(
                        rowType,
                        rowDataTypeInfo,
                        failOnMissingField,
                        ignoreParseErrors,
                        timestampOption,
                        toProjectedNames(
                                (RowType) physicalDataType.getLogicalType(), projections));
            } else {
                return new JsonRowDataDeserializationSchema(
                        rowType,
                        rowDataTypeInfo,
                        failOnMissingField,
                        ignoreParseErrors,
                        timestampOption);
            }
        }

        @Override
        public ChangelogMode getChangelogMode() {
            return ChangelogMode.insertOnly();
        }

        @Override
        public boolean supportsNestedProjection() {
            return jsonParserEnabled;
        }
    };
}
</code></pre>
<p>å¨åå»ºè§£ç æ ¼å¼æ¶ï¼æéè¦çæ¯åå»ºè¿è¡æ¶çè§£ç å¨ï¼ä¹å°±æ¯ DeserializationSchemaï¼å¨ JsonFormatFactory ä¸­ï¼æ JsonParserRowDataDeserializationSchema å JsonRowDataDeserializationSchema ä¸¤ç§å®ç°ï¼åå«æ¯ç¨äºå° JsonParser å JsonNode è½¬æ¢æä¸º RowDataï¼å·ä½çé»è¾é½å¨ createNotNullConverter æ¹æ³ä¸­ã</p>
<p>äºè§£å®è§£ç æ ¼å¼åï¼æä»¬æè§è§æåå° KafkaDynamicSourceï¼å®å®ç°äºä¸ä¸ªæ¥å£ ScanTableSourceãSupportsReadingMetadataãSupportsWatermarkPushDownãåå«ç¨äºæ¶è´¹æ°æ®ï¼è¯»ååæ°æ®åçææ°´å°ã</p>
<pre><code class="language-java">public ScanRuntimeProvider getScanRuntimeProvider(ScanContext context) {
    final DeserializationSchema&lt;RowData&gt; keyDeserialization =
            createDeserialization(context, keyDecodingFormat, keyProjection, keyPrefix);

    final DeserializationSchema&lt;RowData&gt; valueDeserialization =
            createDeserialization(context, valueDecodingFormat, valueProjection, null);

    final TypeInformation&lt;RowData&gt; producedTypeInfo =
            context.createTypeInformation(producedDataType);

    final KafkaSource&lt;RowData&gt; kafkaSource =
            createKafkaSource(keyDeserialization, valueDeserialization, producedTypeInfo);

    return new DataStreamScanProvider() {
        @Override
        public DataStream&lt;RowData&gt; produceDataStream(
                ProviderContext providerContext, StreamExecutionEnvironment execEnv) {
            if (watermarkStrategy == null) {
                watermarkStrategy = WatermarkStrategy.noWatermarks();
            }
            DataStreamSource&lt;RowData&gt; sourceStream =
                    execEnv.fromSource(
                            kafkaSource, watermarkStrategy, "KafkaSource-" + tableIdentifier);
            providerContext.generateUid(KAFKA_TRANSFORMATION).ifPresent(sourceStream::uid);
            return sourceStream;
        }

        @Override
        public boolean isBounded() {
            return kafkaSource.getBoundedness() == Boundedness.BOUNDED;
        }

        @Override
        public Optional&lt;Integer&gt; getParallelism() {
            return Optional.ofNullable(parallelism);
        }
    };
}
</code></pre>
<p>å¨ ScanRuntimeProvider çé»è¾ä¸­ï¼åè·åå°ååºååå¨ï¼ä¹å°±æ¯ååæä»¬æå°ç DeserializationSchemaã</p>
<p><img alt="KafkaSource" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1768318497/Blog/flink/22/KafkaSource.png" class="lazyload"></p>
<p>ç¶åå¼å§åå»º KafkaSource å®ä¾ï¼å®æ¯ Source çå®ç°ç±»ï¼ä¹å°±æ¯æ§è¡å¼æå±äºï¼è¿ä¸ªè¿ç¨ä¼ä¾æ¬¡åå»ºå¾ä¸­è¿äºç±»ã</p>
<p>KafkaSource ä¸­ä¸»è¦æ¯åå»º KafkaSourceReader å KafkaSourceEnumeratorï¼KafkaSourceEnumerator æ¯è´è´£ååçç¸å³çé»è¾ï¼åæ¬åçåéååçåç°ç­ã</p>
<p>KafkaSourceReader ä¸­ä¸»è¦æ¯å State ç¸å³çé»è¾ï¼åæ¬è§¦åå¿«ç§åå®æ Checkpoint éç¥çæ¹æ³ãå½å Snapshot æ¶ï¼ä¼è®°å½æ´»è· split ç offsetï¼åæ¶å° split ä½ä¸ºç¶ææäº¤ãå½ Checkpoint å®ææ¶ï¼ä¼è°ç¨ <code>KafkaSourceFetcherManager.commitOffsets</code> æäº¤ offsetã</p>
<pre><code class="language-java">public List&lt;KafkaPartitionSplit&gt; snapshotState(long checkpointId) {
    List&lt;KafkaPartitionSplit&gt; splits = super.snapshotState(checkpointId);
    if (!commitOffsetsOnCheckpoint) {
        return splits;
    }

    if (splits.isEmpty() &amp;&amp; offsetsOfFinishedSplits.isEmpty()) {
        offsetsToCommit.put(checkpointId, Collections.emptyMap());
    } else {
        Map&lt;TopicPartition, OffsetAndMetadata&gt; offsetsMap =
                offsetsToCommit.computeIfAbsent(checkpointId, id -&gt; new HashMap&lt;&gt;());
        // Put the offsets of the active splits.
        for (KafkaPartitionSplit split : splits) {
            // If the checkpoint is triggered before the partition starting offsets
            // is retrieved, do not commit the offsets for those partitions.
            if (split.getStartingOffset() &gt;= 0) {
                offsetsMap.put(
                        split.getTopicPartition(),
                        new OffsetAndMetadata(split.getStartingOffset()));
            }
        }
        // Put offsets of all the finished splits.
        offsetsMap.putAll(offsetsOfFinishedSplits);
    }
    return splits;
}


public void notifyCheckpointComplete(long checkpointId) throws Exception {
    LOG.debug("Committing offsets for checkpoint {}", checkpointId);
    ...

    ((KafkaSourceFetcherManager) splitFetcherManager)
            .commitOffsets(
                    committedPartitions,
                    (ignored, e) -&gt; {...});
}
</code></pre>
<p>KafkaSourceFetcherManager è´è´£ç®¡ç fetcher çº¿ç¨ï¼æäº¤ Offsetã</p>
<p>KafkaPartitionSplitReader ç fetch æ¹æ³ç¨æ¥æ¶è´¹ Kafka çæ°æ®ã</p>
<pre><code class="language-java">public RecordsWithSplitIds&lt;ConsumerRecord&lt;byte[], byte[]&gt;&gt; fetch() throws IOException {
    ConsumerRecords&lt;byte[], byte[]&gt; consumerRecords;
    try {
        consumerRecords = consumer.poll(Duration.ofMillis(POLL_TIMEOUT));
    } catch (WakeupException | IllegalStateException e) {
        // IllegalStateException will be thrown if the consumer is not assigned any partitions.
        // This happens if all assigned partitions are invalid or empty (starting offset &gt;=
        // stopping offset). We just mark empty partitions as finished and return an empty
        // record container, and this consumer will be closed by SplitFetcherManager.
        KafkaPartitionSplitRecords recordsBySplits =
                new KafkaPartitionSplitRecords(
                        ConsumerRecords.empty(), kafkaSourceReaderMetrics);
        markEmptySplitsAsFinished(recordsBySplits);
        return recordsBySplits;
    }
    KafkaPartitionSplitRecords recordsBySplits =
            new KafkaPartitionSplitRecords(consumerRecords, kafkaSourceReaderMetrics);
    List&lt;TopicPartition&gt; finishedPartitions = new ArrayList&lt;&gt;();
    for (TopicPartition tp : consumer.assignment()) {
        long stoppingOffset = getStoppingOffset(tp);
        long consumerPosition = getConsumerPosition(tp, "retrieving consumer position");
        // Stop fetching when the consumer's position reaches the stoppingOffset.
        // Control messages may follow the last record; therefore, using the last record's
        // offset as a stopping condition could result in indefinite blocking.
        if (consumerPosition &gt;= stoppingOffset) {
            LOG.debug(
                    "Position of {}: {}, has reached stopping offset: {}",
                    tp,
                    consumerPosition,
                    stoppingOffset);
            recordsBySplits.setPartitionStoppingOffset(tp, stoppingOffset);
            finishSplitAtRecord(
                    tp, stoppingOffset, consumerPosition, finishedPartitions, recordsBySplits);
        }
    }

    // Only track non-empty partition's record lag if it never appears before
    consumerRecords
            .partitions()
            .forEach(
                    trackTp -&gt; {
                        kafkaSourceReaderMetrics.maybeAddRecordsLagMetric(consumer, trackTp);
                    });

    markEmptySplitsAsFinished(recordsBySplits);

    // Unassign the partitions that has finished.
    if (!finishedPartitions.isEmpty()) {
        finishedPartitions.forEach(kafkaSourceReaderMetrics::removeRecordsLagMetric);
        unassignPartitions(finishedPartitions);
    }

    // Update numBytesIn
    kafkaSourceReaderMetrics.updateNumBytesInCounter();

    return recordsBySplits;
}
</code></pre>
<p>è³æ­¤ï¼Source ç«¯ç¸å³çæºç æä»¬å°±æ¢³çå®äºãæ¥ä¸æ¥æä»¬åç Sink ç«¯çä»£ç ã</p>
<h4 id="sink-ç«¯">Sink ç«¯</h4>
<p>æä»¬ä»å·¥åç±»ä¸­ç createDynamicTableSink æ¹æ³å¼å§ã</p>
<pre><code class="language-java">public DynamicTableSink createDynamicTableSink(Context context) {
    final TableFactoryHelper helper =
            FactoryUtil.createTableFactoryHelper(
                    this, autoCompleteSchemaRegistrySubject(context));

    final Optional&lt;EncodingFormat&lt;SerializationSchema&lt;RowData&gt;&gt;&gt; keyEncodingFormat =
            getKeyEncodingFormat(helper);

    final EncodingFormat&lt;SerializationSchema&lt;RowData&gt;&gt; valueEncodingFormat =
            getValueEncodingFormat(helper);

    helper.validateExcept(PROPERTIES_PREFIX);

    final ReadableConfig tableOptions = helper.getOptions();

    final DeliveryGuarantee deliveryGuarantee = validateDeprecatedSemantic(tableOptions);
    validateTableSinkOptions(tableOptions);

    KafkaConnectorOptionsUtil.validateDeliveryGuarantee(tableOptions);

    validatePKConstraints(
            context.getObjectIdentifier(),
            context.getPrimaryKeyIndexes(),
            context.getCatalogTable().getOptions(),
            valueEncodingFormat);

    final DataType physicalDataType = context.getPhysicalRowDataType();

    final int[] keyProjection = createKeyFormatProjection(tableOptions, physicalDataType);

    final int[] valueProjection = createValueFormatProjection(tableOptions, physicalDataType);

    final String keyPrefix = tableOptions.getOptional(KEY_FIELDS_PREFIX).orElse(null);

    final Integer parallelism = tableOptions.getOptional(SINK_PARALLELISM).orElse(null);

    return createKafkaTableSink(
            physicalDataType,
            keyEncodingFormat.orElse(null),
            valueEncodingFormat,
            keyProjection,
            valueProjection,
            keyPrefix,
            getTopics(tableOptions),
            getTopicPattern(tableOptions),
            getKafkaProperties(context.getCatalogTable().getOptions()),
            getFlinkKafkaPartitioner(tableOptions, context.getClassLoader()).orElse(null),
            deliveryGuarantee,
            parallelism,
            tableOptions.get(TRANSACTIONAL_ID_PREFIX),
            tableOptions.get(TRANSACTION_NAMING_STRATEGY));
}
</code></pre>
<p>å Source çæµç¨å¾ç¸ä¼¼ï¼è¿éé¦åæ¯è·å key å value çç¼ç æ ¼å¼ï¼ç¶ååäºå¾å¤æ ¡éªï¼æåæ¯åå»º KafkaDynamicSink å®ä¾ã</p>
<p>è·åç¼ç æ ¼å¼ç¨å°çå·¥åç±»æ¯ SerializationFormatFactoryï¼æä»¬åé¢ä»ç»ç JsonFormatFactory ä¹å®ç°äº SerializationFormatFactoryï¼å æ­¤å®æ¢æä¾äºè§£ç æ ¼å¼ï¼åæä¾äºç¼ç æ ¼å¼ãç¼ç æ ¼å¼ç¨å°çç¼ç å¨æ¯ JsonRowDataSerializationSchemaï¼éè¿ RowDataToJsonConverters å° RowData è½¬æ¢æ JsonNodeã</p>
<p>å¨ KafkaDynamicSink ç getSinkRuntimeProvider æ¹æ³ä¸­ï¼ä¸»è¦å°±æ¯åå»º KafkaSink å®ä¾ã</p>
<p><img alt="KafkaSink" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1768363734/Blog/flink/22/KafkaSink.png" class="lazyload"></p>
<p>KafkaSink ç±»å®ç°äº TwoPhaseCommittingStatefulSink æ¥å£ï¼å³æ¯æä¸¤é¶æ®µæäº¤ãå®åå»ºäº KafkaWrter å KafkaCommiterã</p>
<p>åå»º KafkaWriter æ¶ï¼å¦æéç½®çæ¯ ExactlyOnce æ¨¡å¼ï¼åä¼åå»ºåº ExactlyOnceKafkaWriterï¼å¦ååå»º KafkaWriterãWriter çæ­£å®ç°ä¸¤é¶æ®µæäº¤çæ¯ ExactlyOnceKafkaWriterãå®å¨å¯å¨æ¶ï¼ä¼è°ç¨ <code>producer.beginTransaction</code> å¼å¯ä¸ä¸ªäºå¡ãæ°æ®åå¥æ¶ä¼è°ç¨ <code>KafkaWriter.write</code> æ¹æ³ï¼æ­¤æä½ä¼è¢«æ è®°ä¸ºäºå¡åçæä½ãå½ Sink æ¶å° Barrier æ¶ï¼ä¼åè°ç¨ flush æ¹æ³ï¼å°ç¼å²åºçæ°æ®é½åéå° Kafka Brokerï¼ç¶åè°ç¨ prepareCommit æ¹æ³é¢æäº¤ãé¢æäº¤æ¹æ³ä¸­è®°å½ epoch å transactionalId è¿åç»æ¡æ¶å±ã</p>
<pre><code class="language-java">public Collection&lt;KafkaCommittable&gt; prepareCommit() {
    // only return a KafkaCommittable if the current transaction has been written some data
    if (currentProducer.hasRecordsInTransaction()) {
        KafkaCommittable committable = KafkaCommittable.of(currentProducer);
        LOG.debug("Prepare {}.", committable);
        currentProducer.precommitTransaction();
        return Collections.singletonList(committable);
    }

    // otherwise, we recycle the producer (the pool will reset the transaction state)
    producerPool.recycle(currentProducer);
    return Collections.emptyList();
}
</code></pre>
<p>ç¶æä¿å­æ¶ï¼ä¼å°é¢æäº¤ç transactionalId å­å°ç¶æä¸­ã</p>
<pre><code class="language-java">public List&lt;KafkaWriterState&gt; snapshotState(long checkpointId) throws IOException {
    // recycle committed producers
    TransactionFinished finishedTransaction;
    while ((finishedTransaction = backchannel.poll()) != null) {
        producerPool.recycleByTransactionId(
                finishedTransaction.getTransactionId(), finishedTransaction.isSuccess());
    }
    // persist the ongoing transactions into the state; these will not be aborted on restart
    Collection&lt;CheckpointTransaction&gt; ongoingTransactions =
            producerPool.getOngoingTransactions();
    currentProducer = startTransaction(checkpointId + 1);
    return createSnapshots(ongoingTransactions);
}

private List&lt;KafkaWriterState&gt; createSnapshots(
        Collection&lt;CheckpointTransaction&gt; ongoingTransactions) {
    List&lt;KafkaWriterState&gt; states = new ArrayList&lt;&gt;();
    int[] subtaskIds = this.ownedSubtaskIds;
    for (int index = 0; index &lt; subtaskIds.length; index++) {
        int ownedSubtask = subtaskIds[index];
        states.add(
                new KafkaWriterState(
                        transactionalIdPrefix,
                        ownedSubtask,
                        totalNumberOfOwnedSubtasks,
                        transactionNamingStrategy.getOwnership(),
                        // new transactions are only created with the first owned subtask id
                        index == 0 ? ongoingTransactions : List.of()));
    }
    LOG.debug("Snapshotting state {}", states);
    return states;
}
</code></pre>
<p>å½ Checkpoint å®ææ¶ï¼ä¼è°ç¨ <code>KafkaCommitter.commit</code> æ¹æ³ãå¨ commit æ¹æ³ä¸­ä¼è°ç¨ <code>producer.commitTransaction</code> æ­£å¼æäº¤äºå¡ã</p>
<p>FlinkKafkaInternalProducer æ¯ Flink åé¨å°è£çä¸ Kafka çäº§èçäº¤äºç±»ï¼ææä¸ Kafka çäº§èçäº¤äºé½éè¿å®æ§è¡ã</p>
<p>å³äº Kafka Connector ç Sink ç«¯çæºç æä»¬å°±æ¢³çå°è¿éã</p>
<h3 id="æ»ç»">æ»ç»</h3>
<p>æåè¿æ¯æ»ç»ä¸ä¸ãæ¬ææä»¬åäºè§£äº Flink ä¸­èªå®ä¹ Source å Sink çæµç¨ãæç§è¿ä¸ªæµç¨ï¼æä»¬æ¢³çäº Kafka Connector çæºç ãå¨ Source ç«¯ï¼Flink Kafka å°è£äºå¯¹æ¶è´¹è Offset çæäº¤é»è¾ãå¨ Sink ç«¯ç»åäº Kafka æä¾çäºå¡æ¯æå®ç°äºä¸¤é¶æ®µæäº¤çé»è¾ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-20 22:03">2026-01-20 22:03</span>&nbsp;
<a href="https://www.cnblogs.com/Jackeyzhe">Jackeyzhe</a>&nbsp;
éè¯»(<span id="post_view_count">4</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19508927);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19508927', targetLink: 'https://www.cnblogs.com/Jackeyzhe/p/19508927', title: 'Flinkæºç éè¯»ï¼Kafka Connector' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>