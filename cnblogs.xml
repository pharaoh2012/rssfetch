<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-01-07T01:17:51.576Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ OddAgentï¼ä¸ä¸ªéç¨çæå¾ãæä»¤è¯å«æ¡æ¶ ]]></title>
    <link>https://www.cnblogs.com/oddmeta/p/19450366</link>
    <guid>4af681b5d77ec62cdef0b14fc4675162</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/oddmeta/p/19450366" title="åå¸äº 2026-01-07 09:02">
    <span role="heading" aria-level="2">OddAgentï¼ä¸ä¸ªéç¨çæå¾ãæä»¤è¯å«æ¡æ¶</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3718265/202601/3718265-20260107090149523-2082541314.png" alt="OddAgentï¼ä¸ä¸ªéç¨çæå¾ãæä»¤è¯å«æ¡æ¶" class="desc_img">
        ä»¥[å°è½åå­¦](https://x.oddmeta.net "å°è½åå­¦")èè¨ï¼å¥¹æ¯æå¤©æ°é¢æ¥ï¼ä¼è®®è°åº¦ï¼æºè½å®¶å±æ§å¶ç­å¤ç§æºè½ä½åè½ï¼å¥¹çåæ³æ¯é¨ç½²å¤ä¸ªä¸åçæºè½ä½ï¼ä¹å³ï¼å¯å¨å¤ä¸ªoddagentï¼æ¯ä¸ªoddagentéç½®ä¸ä¸ªæºè½ä½éç½®ï¼å¹¶ç»å®ä¸ä¸ªç«¯å£ï¼ç¶ååç½®ä¸ä¸ªå·¥ä½æµæ¥åç¨æ·è¾å¥ï¼å¹¶æ ¹æ®ç¨æ·çè¾åºåå¯¼å°ä¸åçoddagentè¿å»å¤çã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="20260106-oddagentä¸ä¸ªéç¨çæå¾æä»¤è¯å«æ¡æ¶">20260106 OddAgentï¼ä¸ä¸ªéç¨çæå¾ãæä»¤è¯å«æ¡æ¶</h1>
<p></p><div class="toc"><div class="toc-container-header">ç®å½</div><ul><li><a href="#20260106-oddagentä¸ä¸ªéç¨çæå¾æä»¤è¯å«æ¡æ¶" rel="noopener nofollow">20260106 OddAgentï¼ä¸ä¸ªéç¨çæå¾ãæä»¤è¯å«æ¡æ¶</a><ul><li><a href="#ä¸åè½ç¹æ§" rel="noopener nofollow">ä¸ãåè½ç¹æ§</a><ul><li><a href="#1-æ¡æ¶ç¹æ§" rel="noopener nofollow">1. æ¡æ¶ç¹æ§</a></li><li><a href="#2-ç¤ºä¾åè½" rel="noopener nofollow">2. ç¤ºä¾åè½</a></li></ul></li><li><a href="#äºå¿«éå¼å§" rel="noopener nofollow">äºãå¿«éå¼å§</a></li><li><a href="#ä¸åå»ºä½ èªå·±çæºè½ä½é¡¹ç®" rel="noopener nofollow">ä¸ãåå»ºä½ èªå·±çæºè½ä½é¡¹ç®</a><ul><li><a href="#1-æ­¥éª¤ä¸å¨ä»»æä½ æ³è¦çç®å½ä¸åå»ºä¸ä¸ªç®å½" rel="noopener nofollow">1. æ­¥éª¤ä¸ï¼å¨ä»»æä½ æ³è¦çç®å½ä¸åå»ºä¸ä¸ªç®å½</a></li><li><a href="#2-æ­¥éª¤äºä¸è½½é¡¹ç®éç½®æ ·ä¾" rel="noopener nofollow">2. æ­¥éª¤äºï¼ä¸è½½é¡¹ç®éç½®æ ·ä¾</a></li></ul></li><li><a href="#åéç½®ä½ èªå·±çç³»ç»éç½®" rel="noopener nofollow">åãéç½®ä½ èªå·±çç³»ç»éç½®</a><ul><li><a href="#1-å¤§æ¨¡åéç½®" rel="noopener nofollow">1. å¤§æ¨¡åéç½®</a></li><li><a href="#2-æºè½ä½éç½®" rel="noopener nofollow">2. æºè½ä½éç½®</a></li></ul></li><li><a href="#äº-æºè½ä½æè½éç½®" rel="noopener nofollow">äº. æºè½ä½æè½éç½®</a></li><li><a href="#å­è¿è¡æµè¯ä½ èªå·±çæºè½ä½" rel="noopener nofollow">å­ãè¿è¡æµè¯ä½ èªå·±çæºè½ä½</a><ul><li><a href="#1-å¯å¨oddagentæºè½ä½åå°" rel="noopener nofollow">1. å¯å¨oddagentæºè½ä½åå°</a></li><li><a href="#2-å¯å¨æµè¯çé¢" rel="noopener nofollow">2. å¯å¨æµè¯çé¢</a><ul><li><a href="#1çé¢æµè¯" rel="noopener nofollow">1ï¼çé¢æµè¯</a></li><li><a href="#2å®éapiæµè¯" rel="noopener nofollow">2ï¼å®éAPIæµè¯</a></li></ul></li></ul></li><li><a href="#ä¸è¿é¶ç¨æ³åæ¶è¿è¡å¤ä¸ªæºè½ä½" rel="noopener nofollow">ä¸ãè¿é¶ç¨æ³ï¼åæ¶è¿è¡å¤ä¸ªæºè½ä½</a><ul><li><a href="#1-ç¨ä¸ä¸ªoddagentæå®" rel="noopener nofollow">1. ç¨ä¸ä¸ªoddagentæå®</a></li><li><a href="#2-ç¨å¤ä¸ªoddagentåå¼é¨ç½²" rel="noopener nofollow">2. ç¨å¤ä¸ªoddagentåå¼é¨ç½²</a></li></ul></li><li><a href="#å«å¹¿èåä¹" rel="noopener nofollow">å«ãå¹¿èåä¹</a></li></ul></li></ul></div><p></p>
<p>æ³èªå·±å¨ææ¥ææä¸ä¸ªå®å¨å±äºä½ èªå·±çâå°ç±åå­¦âãâå°èºâåï¼å¦ææä½ è¿ä¹ä¸ä¸ªæ³æ³ï¼èåä¸ç¥éè¯¥å¦ä½å¼å§çè¯ï¼é£ä¹<a href="https://pypi.org/project/oddagent/" title="OddAgent" target="_blank" rel="noopener nofollow">OddAgent</a>é¡¹ç®å¯ä»¥æä¸ºä½ éå¸¸å®¹æä¸æçå¼æºé¡¹ç®ã</p>
<p>æ¬æ¥è¿ä¸ªåè½æ¯<a href="https://x.oddmeta.net" title="å°è½åå­¦" target="_blank" rel="noopener nofollow">å°è½åå­¦</a>å¨2024å¹´åå°±å·²ç»æ¯æï¼ç±äºåéµå­å¬å¸èæ¿è¯´éè¦åä¸ä¸ªåºäºLLMçæºè½å©æç³»ç»ï¼å æ­¤å°±åä»å°è½åå­¦é¡¹ç®éæç¸å³çä»£ç æäºä¸ä¸åºæ¥ï¼åç¬æäºä¸ä¸ªOddAgenté¡¹ç®åºæ¥ï¼ä½ä¸ºä¸ä¸ªåºäºLLMçæºè½å©æç³»ç»ï¼æä¾å¤è½®é®ç­ãæµå¼AIèå¤©ç­åè½ç¬ç«é¡¹ç®æ¥æ¼è¿ã</p>
<p>OddAgentä½ä¸ºä¸ä¸ªéç¨çæå¾ãæä»¤è¯å«æ¡æ¶ï¼è·ä¸å¡æ å³ï¼ææè¯å«çåç¡®çï¼å¯è¯å«çè½åï¼å®å¨ç±ä½ çæºè½ä½ææ¯éç½®æä»¶å³å®ã</p>
<p>åæ¶ï¼<font color="red"><strong>OddAgentåªè´è´£è¯å«æå¾ãæä»¤</strong></font>ï¼ä¸è´è´£å®ç°å·ä½çåè½ãéè¿OddAgentè¯å«åºæ¥æå¾ãæä»¤åï¼ä½ éè¦<font color="red"><strong>èªè¡å®ç°å·¥å·</strong></font>é»è¾ï¼å¹¶è°ç¨å¯¹åºçå·¥å·ï¼å®æç¸åºçåè½ã</p>
<div align="center">
  <img alt="OddAgent Logo" width="400" data-src="https://www.oddmeta.net/wp-content/uploads/2025/11/OddAgent_400x200.png" class="lazyload">
<p><a href="https://docs.oddmeta.net/" target="_blank" rel="noopener nofollow"><img alt="Documentation" loading="lazy" data-src="https://img.shields.io/badge/Documentation-Online-green.svg" class="lazyload"></a><br>
<a href="LICENSE" target="_blank" rel="noopener nofollow"><img alt="License" loading="lazy" data-src="https://img.shields.io/badge/License-MIT-blue.svg" class="lazyload"></a></p>
</div>
<h2 id="ä¸åè½ç¹æ§">ä¸ãåè½ç¹æ§</h2>
<h3 id="1-æ¡æ¶ç¹æ§">1. æ¡æ¶ç¹æ§</h3>
<ul>
<li>æ¯æå¤è½®å¯¹è¯</li>
<li>æ¯ææµå¼AIèå¤©æ¥å£</li>
<li>å·¥å·æ¨¡æ¿åå¤ç</li>
<li>æ¯æè¯­é³å¯¹è¯ï¼éè¦èªè¡é¨ç½² <a href="https://github.com/oddmeta/oddasr" title="OddAsré¡¹ç®" target="_blank" rel="noopener nofollow">OddAsré¡¹ç®</a>ï¼å¹¶å¨config.jsonä¸­å°OddAsré¨ç½²çIPå°åæåOddAsræå¨çæå¡å¨ï¼</li>
</ul>
<blockquote>
<p>OddAsré¡¹ç®ä½äºï¼<a href="https://github.com/oddmeta/oddasr" target="_blank" rel="noopener nofollow">https://github.com/oddmeta/oddasr</a> ï¼è¥éè¦è¯­é³çæ¯æï¼è¯·èªè¡é¨ç½²ã</p>
</blockquote>
<h3 id="2-ç¤ºä¾åè½">2. ç¤ºä¾åè½</h3>
<p>æ ¹æ®è§é¢ä¼è®®çåè½ç¹æ§ï¼å¨ç¤ºä¾ä¸­å®ç°äºå¦ä¸çå©æåè½ï¼</p>
<ul>
<li>é¢çº¦ä¼è®®æå¡ï¼å¯åå»ºæå®æ¶é´ãå°ç¹çä¼è®®ã</li>
<li>åå»ºä¼è®®æå¡ã</li>
<li>ç»æä¼è®®æå¡ã</li>
<li>å å¥ä¼è®®æå¡ï¼å¯å å¥æå®ä¼è®®ã</li>
<li>éåºä¼è®®æå¡ã</li>
<li>éè¯·åä¼äººæå¡ï¼å¯éè¯·æå®ä¼è®®çåä¼äººã</li>
<li>ææ­åä¼äººæå¡ï¼å¯ææ­æå®ä¼è®®çåä¼äººã</li>
<li>æå¼æåå¤´æå¡ã</li>
<li>å³é­æåå¤´æå¡ã</li>
<li>æå¼éº¦åé£æå¡ã</li>
<li>å³é­éº¦åé£æå¡ã</li>
<li>åéåæµæå¡ã</li>
<li>åæ­¢åæµæå¡ã</li>
<li>æå¼åå£°å­å¹æå¡ã</li>
<li>æå¼ä¼è®®çºªè¦æå¡ã</li>
<li>å³é­ä¼è®®çºªè¦æå¡ã</li>
</ul>
<h2 id="äºå¿«éå¼å§">äºãå¿«éå¼å§</h2>
<p>å»ºè®®å¨ä¸ä¸ªèæç¯å¢éå®è£ï¼ä»¥é¿åä¸å¶å®çäº§ååé¡¹ç®å²çªãæä¸ªäººä¹ æ¯ç¨condaï¼ä½ ç¨venv, uvï¼poetryä»ä¹ä¹é½OKãä¸é¢ä»¥condaä¸ºä¾ä»ç»æ´ä¸ªå®è£ã</p>
<p>ç¯å¢è¦æ±: Python 3.10+</p>
<ul>
<li>
<ol>
<li>åå»ºæµè¯ç¨çèæç¯å¢</li>
</ol>
</li>
</ul>
<pre><code class="language-bash">conda create -n oddagent_test python==3.12
conda activate oddagent_test
</code></pre>
<ul>
<li>
<ol start="2">
<li>å¨èæç¯å¢éå®è£OddAgent</li>
</ol>
</li>
</ul>
<pre><code class="language-bash">pip install -i https://pypi.org/simple/ oddagent
</code></pre>
<blockquote>
<p>éå®æ¹çéåç«å¯è½ä¸ä¸å®è½æ¾å°ææ°çæ¬ï¼å æ­¤å»ºè®®ä½¿ç¨pypiå®æ¹æºã</p>
</blockquote>
<h2 id="ä¸åå»ºä½ èªå·±çæºè½ä½é¡¹ç®">ä¸ãåå»ºä½ èªå·±çæºè½ä½é¡¹ç®</h2>
<h3 id="1-æ­¥éª¤ä¸å¨ä»»æä½ æ³è¦çç®å½ä¸åå»ºä¸ä¸ªç®å½">1. æ­¥éª¤ä¸ï¼å¨ä»»æä½ æ³è¦çç®å½ä¸åå»ºä¸ä¸ªç®å½</h3>
<p>å¦ï¼<code>d:\\myagent</code> æè <code>/home/user/myagent</code></p>
<h3 id="2-æ­¥éª¤äºä¸è½½é¡¹ç®éç½®æ ·ä¾">2. æ­¥éª¤äºï¼ä¸è½½é¡¹ç®éç½®æ ·ä¾</h3>
<p>é¡¹ç®éç½®æ ·ä¾ï¼<a href="https://oddmeta.net/tools/oddagent/config.json.sample" target="_blank" rel="noopener nofollow">https://oddmeta.net/tools/oddagent/config.json.sample</a><br>
æºè½ä½éç½®æ ·ä¾ï¼<a href="https://oddmeta.net/tools/oddagent/conference_config.json" target="_blank" rel="noopener nofollow">https://oddmeta.net/tools/oddagent/conference_config.json</a></p>
<p>ä¸è½½å¥½åæ¾å¨ä½ åé¢åå»ºçç®å½ä¸ãç¶åå¤å¶<code>config.json.sample</code>ï¼å¹¶å°å¶æ¹åä¸º<code>config.json</code></p>
<p>ç¶åå¼å§è°æ´è®¾ç½®config.jsonééç½®ä½ èªå·±çç³»ç»éç½®</p>
<h2 id="åéç½®ä½ èªå·±çç³»ç»éç½®">åãéç½®ä½ èªå·±çç³»ç»éç½®</h2>
<p>å¨<code>config.json</code>ç³»ç»éç½®éï¼å¿æ¹çåå®¹ä¸»è¦æ¯ä¸¤ä¸ªï¼</p>
<ul>
<li>å¤§æ¨¡åéç½®ï¼éè¦å°ä½ èªå·±ç¨çå¤§æ¨¡åçå°å<code>GPT_URL</code>ï¼æ¨¡åå<code>MODEL</code>ï¼ä»¥å<code>API_KEY</code>å¨éç½®éå¡«ä¸ä¸</li>
<li>æºè½ä½çéç½®ï¼æå®OddAgentå¯ç¨åªä¸ªæºè½ä½ãå¦æä½ æå¤ä¸ªä¸åçæºè½ä½å¸æåæ¶è¿è¡çè¯ï¼å¯ä»¥åèåé¢çä»ç»ã<code>è¿é¶ç¨æ³ï¼åæ¶è¿è¡å¤ä¸ªæºè½ä½</code>ã</li>
</ul>
<p>ä¸é¢æ¯ä¸ä¸ªç³»ç»éç½®çç¤ºä¾ã</p>
<h3 id="1-å¤§æ¨¡åéç½®">1. å¤§æ¨¡åéç½®</h3>
<pre><code class="language-bash">  "GPT_URL": "https://qianfan.baidubce.com/v2/chat/completions",
  "MODEL": "ernie-4.5-turbo-128k",
  "API_KEY": "your api key",
</code></pre>
<h3 id="2-æºè½ä½éç½®">2. æºè½ä½éç½®</h3>
<pre><code class="language-bash">  "TOOL_CONFIG_FILE_EXT": "_config.py",
  "TOOL_CONFIG_FILE": "agents/xiaoluo/xiaoluo_config.py",
</code></pre>
<h2 id="äº-æºè½ä½æè½éç½®">äº. æºè½ä½æè½éç½®</h2>
<p>OddAgentæ¯æéè¿JSONæä»¶éç½®ä¸åçæºè½ä½æè½ï¼éç½®æä»¶ä½äºä½ çé¡¹ç®æ ¹ç®å½ä¸<code>agents</code>ç®å½ä¸ã</p>
<p>å¨agent_tool_listå­æ®µä¸é¢ï¼å°ä½ è¦å®ç°çåè½ä¸ä¸ªä¸ªå è¿å»ï¼</p>
<ul>
<li><code>tool_name</code>ï¼ å·¥å·åãå»ºè®®å¯ä»¥æ¯å®éè¿ä¸ªå·¥å·å¨å®ç°æ¶éè¦è°ç¨çAPIçåå­ã</li>
<li><code>name</code>: è¯¦ç»å·¥å·åãä¸ä¸ªå®éçãç¨æ·è¦ä»¥çå¨æçåå­ã</li>
<li><code>description</code>: å·¥å·å·ä½ä»ç»ã</li>
<li><code>example</code>: å¯éãå¦æè¿ä¸ªå·¥å·æ¯éè¦å¸¦è°ç¨åæ°çï¼å»ºè®®å¨è¿éå·ä½ä»ç»ä¸ä¸ï¼è¿éçä»ç»æ¯ä¼å¸¦å¨promptæç¤ºè¯ééç»å¤§æ¨¡åï¼è®©å¤§æ¨¡åæ¥æ´æ¸æ¥æç½çäºè§£è¿ä¸ªå·¥å·æå¯¹åºçæå¾ï¼intentï¼ï¼ä»¥åæ´åç¡®çå»è§£æåºæ­¤å·¥å·å¯¹åºçslot(æ§½ä½)ã</li>
<li><code>parameters</code>: å¯éãå¦æè¿ä¸ªå·¥å·æ¯éè¦å¸¦è°ç¨åæ°çï¼ææçåæ°éè¦å¨è¿éåç¤ºä¸ä¸ãåexampleä¸æ ·ï¼è¿éçåå®¹ä¹æ¯ä¼å¨promptéå¸¦ç»å¤§æ¨¡åçï¼ä»¥ä¾¿å¤§æ¨¡åæ´ç²¾åçè§£ææå¾åæ§½ä½ã</li>
<li><code>enabled</code>: å¯ç¨ä¸å¦</li>
<li><code>tool_api_url</code>: ãä¸å»ºè®®ä½¿ç¨ãè¯å«åºå·¥å·æå¾åï¼å®éå®ç°è¯¥å·¥å·æéè¦è°ç¨çAPIçå°åã</li>
<li><code>tool_api_headers</code>: ãä¸å»ºè®®ä½¿ç¨ãè°ç¨å·¥å·APIæ¶ï¼éè¦å¨APIçå¤´ä¿¡æ¯éå¸¦çåæ°åè¡¨ï¼å¦è®¤è¯çtokenã</li>
<li><code>tool_api_method</code>: ãä¸å»ºè®®ä½¿ç¨ãè°ç¨å·¥å·APIæ¶ï¼ä½¿ç¨çæ¹æ³ï¼methodï¼ï¼æ¯å¦ï¼GET/POST/PUT/DELETEç­ã</li>
</ul>
<p>æ³¨æäºé¡¹ï¼<br>
<font color="red"><strong>å½åå¼æºçæ¬æ¯ä¸ªtoolåªæä¾ä¸ä¸ªparameteræ§½ä½çæ¯æï¼è¯·åå¡«åå¤ä¸ªparameterï¼å¦åæµè¯æ¶ä¼ä¸ç´å¨è¦æ±ä½ è¡¥åã</strong></font></p>
<p>ä»¥ä¸æ¯ä¸ä¸ªç¤ºä¾éç½®ã</p>
<pre><code class="language-json">{
  "global_variants": [],
  "agent_tool_list": [],
    {
      "tool_name": "meeting_schedule",
      "name": "é¢çº¦ä¼è®®",
      "description": "é¢çº¦ä¼è®®æå¡ï¼å¯åå»ºæå®æ¶é´ãå°ç¹çä¼è®®ã",
      "example": "JSONï¼[{'name': 'time', 'desc': 'ä¼è®®æ¶é´ï¼æ ¼å¼ä¸ºyyyy-MM-dd HH:mm:ss', 'value': ''} ]\nè¾å¥ï¼å¸®æé¢çº¦ä¸ä¸ª2046å¹´4æ18æ¥10:00:00çä¼è®®\nç­ï¼{ 'time': '2046-04-18 10:00:00'}",
      "parameters": [
        {"name": "time", "desc": "ä¼è®®æ¶é´ï¼æ ¼å¼ä¸ºyyyy-MM-dd HH:mm:ss", "type": "string", "required": false},
      ],
      "enabled": true,
      "tool_api_url": "https://api.oddmeta.net/api/meeting_schedule",
      "tool_api_headers": "{'Content-Type': 'application/json', 'Authorization': '{{ api_key }}'}",
      "tool_api_method": "POST"
    }
  ]
}
</code></pre>
<h2 id="å­è¿è¡æµè¯ä½ èªå·±çæºè½ä½">å­ãè¿è¡æµè¯ä½ èªå·±çæºè½ä½</h2>
<h3 id="1-å¯å¨oddagentæºè½ä½åå°">1. å¯å¨oddagentæºè½ä½åå°</h3>
<p>å¨ä½ åå»ºçèªå·±çæºè½ä½é¡¹ç®çç®å½ä¸ï¼æå¼ä¸ä¸ªterminalå½ä»¤è¡ï¼ç¶åå¯å¨oddagentãå½ç¶ä½ ä¹å¯ä»¥èªå·±åä¸ªç®åçèæ¬æ¥å®ç°å¯å¨æèèªå¨å¯å¨ã</p>
<p>å¯å¨å½ä»¤ï¼<code>oddagent -c config.json</code></p>
<h3 id="2-å¯å¨æµè¯çé¢">2. å¯å¨æµè¯çé¢</h3>
<h4 id="1çé¢æµè¯">1ï¼çé¢æµè¯</h4>
<p>oddagentåå°å äºä¸ä¸ªç®åçWebçé¢ï¼ä¸é¨ç¨äºæµè¯åè°è¯ä½ çæºè½ä½æè½éç½®ï¼é»è®¤çå°åæ¯ï¼<a href="http://localhost:5050" target="_blank" rel="noopener nofollow">http://localhost:5050</a><br>
ç»å®çIPåç«¯å£å¯ä»¥å¨ç³»ç»éç½®ï¼config.jsonï¼éä¿®æ¹ã<br>
æå¼åççé¢å¦ä¸å¾æç¤º<br>
<img alt="" loading="lazy" data-src="https://kb.oddmeta.net/uploads/omassistant/images/m_b5793dcf08ff15d2caaf770a7707884b_r.png" class="lazyload"><br>
å¨è¿ä¸ªçé¢éï¼ä½ å¯ä»¥éæ©å³è¾¹çå½ä»¤è¯ç¶ååéè¯·æ±å°oddagentï¼ç¶åççå®æ¯å¦æ­£ç¡®çè§£æå¹¶è¿åäºä½ è¦çæå¾åæ§½ä½ï¼å¦ææä¸äºå½ä»¤è¯è¯´æ³æªè½æ­£ç¡®è¯å«åºæå¾åæ§½ä½çè¯ï¼å¯ä»¥åç»§ç»­å¯¹ä½ çæºè½ä½ææ¯éç½®éåè°æ´ã</p>
<h4 id="2å®éapiæµè¯">2ï¼å®éAPIæµè¯</h4>
<p>OddAgentåªåæå¾ãæä»¤çè¯å«ï¼æä»¥å®éåºæ¯éåºæ¬ä¸é½æ¯å¨ä½ èªå·±çäº§åéç¨APIæ¥è°ç¨OddAgentè¯å«æå¾æä»¤ï¼ç¶åèªè¡å»å®ç°ç¸åºçåè½ã<br>
ä»¥ä¸æ¯ä¸ä¸ªAPIè°ç¨OddAgentçå®æ´ç¤ºä¾ä»£ç ï¼</p>
<pre><code class="language-python">import json
import requests

API_BASE_URL = 'http://127.0.0.1:5050/oddagent/chat'                # APIå°å

def recognize_intent(message):
    """è°ç¨api_oddagent_chat API"""
    try:
        response = requests.post(
            API_BASE_URL,
            json={
                'question': message, 
                'api_mode': 1 # æ¨¡æAPIç»æï¼0-ä¸æ¨¡æï¼1-æ¨¡æï¼2-èªå®ä¹API
                }, 
            headers={'Content-Type': 'application/json'},
            timeout=30
        )
        response.raise_for_status()
        data = response.json()
        return { 'err_code': 200, 'message': 'success', 'data': data}
    except Exception as e:
        print(f"APIè°ç¨å¤±è´¥: {str(e)}")
        return { 'err_code': 500, 'message': f'APIè°ç¨å¤±è´¥: {str(e)}', 'data': None }

if __name__ == '__main__':
    json_response = recognize_intent("å¼ä¸ªå¨ä¾ä¼")
    print(json.dumps(json_response, ensure_ascii=False, indent=2))
</code></pre>
<p>è¿è¡æµè¯ä»£ç ï¼<code>python test_oddagent.py</code></p>
<p>è°ç¨åè¿åçç»æï¼</p>
<pre><code class="language-json">{
  "err_code": 200,
  "message": "success",
  "data": {
    "answer": {
      "data": "[æ¨¡æAPIæ¨¡å¼] åè£æåï¼",
      "err_code": 0,
      "message": "[meeting_create] APIè°ç¨æå",
      "slots": {
        "meeting_name": "å¨ä¾ä¼"
      },
      "tool_name": "meeting_create"
    }
  }
}
</code></pre>
<p>å¶ä¸­ï¼</p>
<ul>
<li><code>tool_name</code>: è¯å«åºæ¥çæå¾ï¼ç±æºè½ä½æè½éç½®æä»¶æéç½®ï¼</li>
<li><code>slots</code>: è¯¥æå¾å·¥å·å¯¹åºçæ§½ä½å¼ã</li>
</ul>
<p>åæ¬¡å¼ºå¶ï¼OddAgentä½ä¸ºä¸ä¸ªéç¨çæå¾ãæä»¤è¯å«æ¡æ¶ï¼è·ä¸å¡æ å³ï¼ææå®å¨ç±ä½ çæºè½ä½ææ¯éç½®æä»¶å³å®ã</p>
<h2 id="ä¸è¿é¶ç¨æ³åæ¶è¿è¡å¤ä¸ªæºè½ä½">ä¸ãè¿é¶ç¨æ³ï¼åæ¶è¿è¡å¤ä¸ªæºè½ä½</h2>
<p>å¨ä¸äºæåµä¸ï¼å­å¨åæ¶è¿è¡å¤ä¸ªæºè½ä½çéæ±ï¼å»ºè®®çæ¹æ¡æä¸¤ç§ã</p>
<h3 id="1-ç¨ä¸ä¸ªoddagentæå®">1. ç¨ä¸ä¸ªoddagentæå®</h3>
<p>å¨ç³»ç»éç½®ï¼config.jsonï¼éï¼ä½ å¯ä»¥å° <code>TOOL_CONFIG_FILE</code> è®¾ç½®ä¸º<code>agents/xiaoluo/*</code>ï¼ç¶åæä½ æºè½ä½éç½®é½æ¾å° <code>agents/xiaoluo</code> ç®å½ä¸ï¼è¿æ · oddagent å¨å¯å¨çæ¶åå°±ä¼å»è¯»å è¿ä¸ªç®å½ä¸ææç <code>*_config.json</code> ç»å°¾çæä»¶ï¼å¹¶å°ä»ä»¬å è½½èµ·æ¥ã</p>
<h3 id="2-ç¨å¤ä¸ªoddagentåå¼é¨ç½²">2. ç¨å¤ä¸ªoddagentåå¼é¨ç½²</h3>
<p>ä¸ºæ¯ä¸ªæºè½ä½å¯ç¨ä¸ä¸ªç³»ç»éç½®ï¼config1.json, config2.json, config3.json...ï¼ï¼å¹¶å¨æ¯ä¸ªç³»ç»éç½®éè®¾ç½®</p>
<ul>
<li><code>TOOL_CONFIG_FILE</code>: æåå¯¹åºæºè½ä½çéç½®æä»¶ãå¦ï¼<code>conference_config.py</code>ï¼<code>smarthome_iot_config.py</code>...</li>
<li><code>BACKEND_PORT</code>: ä½¿ç¨ä¸åçç«¯å£ï¼å¦ï¼5050ï¼5051ï¼5052ï¼5053...</li>
</ul>
<p>ä»¥<a href="https://x.oddmeta.net" title="å°è½åå­¦" target="_blank" rel="noopener nofollow">å°è½åå­¦</a>èè¨ï¼å¥¹æ¯æå¤©æ°é¢æ¥ï¼ä¼è®®è°åº¦ï¼æºè½å®¶å±æ§å¶ç­å¤ç§æºè½ä½åè½ï¼å¥¹çåæ³æ¯é¨ç½²å¤ä¸ªä¸åçæºè½ä½ï¼ä¹å³ï¼å¯å¨å¤ä¸ªoddagentï¼æ¯ä¸ªoddagentéç½®ä¸ä¸ªæºè½ä½éç½®ï¼å¹¶ç»å®ä¸ä¸ªç«¯å£ï¼ç¶ååç½®ä¸ä¸ªå·¥ä½æµæ¥åç¨æ·è¾å¥ï¼å¹¶æ ¹æ®ç¨æ·çè¾åºåå¯¼å°ä¸åçoddagentè¿å»å¤çã</p>
<p>ä¸é¢æ¯å°è½åå­¦çä¸ä¸ªæºè½ä½ç¤ºä¾ã</p>
<pre><code class="language-bash">\---oddagent
    |   config.json
    |   config.json.sample
    |
    +---agents
    |   \---xiaoluo
    |       |   conference_config.py
    |       |   GAB_config.py
    |       |   odd_bookmark_config.py
    |       |   smarthome_iot_config.py
    |       |   tpad_work_hour.py
    |       |   weather_config.py
    |       |   xiaoluo_config.py
    |       |   __init__.py
</code></pre>
<p>å¦ææ³ç¨ä¸ä¸ªoddagentæå®ï¼é£ä½ å°±å¨ç³»ç»éç½®config.jsonéå° <code>TOOL_CONFIG_FILE</code> è®¾ç½®ä¸º<code>agents/xiaoluo/*</code>ï¼ç¶åå¨<code>config.json</code>æå¨çç®å½ä¸ï¼ <code>oddagent -c config.json</code> å¯å¨ oddagent å³å¯ã<br>
å¦ææ³ç¨å¤ä¸ª oddagentåå¼é¨ç½²çè¯ï¼å°±æç³»ç»éç½®config.jsonå¤å¶å¤ä»½ï¼å¹¶ä¿®æ¹æ¯ä¸ªç³»ç»éç½®ä¸­å¯¹åºç<code>TOOL_CONFIG_FILE</code>å<code>BACKEND_PORT</code>ï¼ç¶ååæ¯ä¸ªoddagentåå«å¯å¨å³å¯ï¼ <code>oddagent -c config1.json</code> , <code>oddagent -c config2.json</code> ...</p>
<h2 id="å«å¹¿èåä¹">å«ãå¹¿èåä¹</h2>
<p>æ°å»ºäºä¸ä¸ªææ¯äº¤æµç¾¤ï¼æ¬¢è¿å¤§å®¶ä¸èµ·å å¥è®¨è®ºã<br>
æ«ç å å¥AIææ¯äº¤æµç¾¤ï¼å¾®ä¿¡ï¼<br>
å³æ³¨æçå¬ä¼å·ï¼å¥¥å¾·å<br>
<strong><font color="red">è®©æä»¬ä¸èµ·å­¦ä¹ äººå·¥æºè½ï¼ä¸èµ·è¿½èµ¶è¿ä¸ªæ¶ä»£ã</font></strong><br>
(è¥äºç»´ç è¿æäºï¼å¯ç§ä¿¡æ)<br>
æäº+wx: oddmeta äº¤æµç¾¤: 8655372</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-07 09:03">2026-01-07 09:02</span>&nbsp;
<a href="https://www.cnblogs.com/oddmeta">ç¨åºåèå¥¥</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19450366);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19450366', targetLink: 'https://www.cnblogs.com/oddmeta/p/19450366', title: 'OddAgentï¼ä¸ä¸ªéç¨çæå¾ãæä»¤è¯å«æ¡æ¶' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ FastAPI + TinyDBå¹¶åé·é±ä¸å®æï¼åå«æ°æ®éä¹±çè§£å³æ¹æ¡ ]]></title>
    <link>https://www.cnblogs.com/ymtianyu/p/19450340</link>
    <guid>8b7d4dde06107a64e84064c75fffe1b0</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ymtianyu/p/19450340" title="åå¸äº 2026-01-07 08:54">
    <span role="heading" aria-level="2">FastAPI + TinyDBå¹¶åé·é±ä¸å®æï¼åå«æ°æ®éä¹±çè§£å³æ¹æ¡</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ¬æéå¯¹å¨FastAPIæ¡æ¶ä¸ä½¿ç¨TinyDBï¼JSONæä»¶æ°æ®åºï¼æ¶ï¼å å¤äººåæ¶è¯»åå¯¼è´çå¹¶åæ°æ®å²çªé®é¢ï¼è¿è¡äºæ·±åº¦åæãæç« éè¿çå¨çæ¯å»è§£éäºé®é¢æ ¹æºï¼å¹¶è¯¦ç»æä¾äºæä»¶éãåå­æä½éåååºç¨å±ä¹è§éä¸ç§ç±æµå¥æ·±çå®æè§£å³æ¹æ¡ï¼éæå¯ç´æ¥æ´åçä»£ç ç¤ºä¾ãåæ¶ï¼æç¡®äºåæ¹æ¡çéç¨åºæ¯ä¸å±éæ§ï¼ä¸ºå¼åèå¨è½»éçº§ä¸çäº§çº§åºç¨ä¹é´æä¾å¹³æ»è¿æ¸¡çæè·¯ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><strong style="color: rgba(186, 55, 42, 1)">ä½ çFastAPIåºç¨å¨å¤äººåæ¶ä¿®æ¹æ°æ®æ¶ï¼ä¼ä¸ä¼åºç°æ°æ®éä¹±æä¸¢å¤±ï¼</strong></p>
<p>è¯åä¸ä¸ï¼å¢ééä¸ä¸ªç¨äºç®¡çåé¨èµæºçå·¥å·çªç¶âæ½é£âäºãå ä¸ªåäºåæ¶æäº¤ç³è¯·ï¼ç»æåå°æ°æ®æ¾ç¤ºï¼æçç³è¯·è®°å½ç¥ç§æ¶å¤±ï¼æçèµæºæ°éå¯¹ä¸ä¸ãä¸æ¥æ¥å¿ï¼åç°å¤§å®¶é½å¨åä¸ç§å¯¹åä¸ä¸ª<code style="color: rgba(186, 55, 42, 1)">db.json</code>æä»¶è¿è¡äºè¯»åãè¿å°±æ¯ä¸ºäºè½»éèéç¨TinyDBï¼ä¸ä¸ªçº¯Pythonçãä»¥JSONæä»¶ä¸ºå­å¨çæ°æ®åºï¼åï¼ææå¯è½çåå°æåå°âå¹¶åâå¸¦æ¥ççãð¯</p>
<p>è¿ç¯æç« ï¼æå°åä½ ä¸èµ·æè§£è¿ä¸ªé®é¢ï¼å¹¶åäº«å¦ä½ç¨å ä¸ªè½»éçº§æ¹æ¡ï¼è®©è¿ä¸ªåºäºFastAPIåTinyDBçåºç¨ç¨³å®å°æ¯æèµ·äºæ¥åæ°åæ¬¡çå¹¶åè¯·æ±ãå®ä¸æ¯ä¸å¥æ¾ä¹åæµ·èçåçæ¶æï¼ä½ç»å¯¹æ¯ä½ å¨ååå¼åãå°åå·¥å·æç¹å®è½»éåºæ¯ä¸ï¼æ§ä»·æ¯æé«çè§£å³æ¹æ¡ã</p>
<h2>ð æ ¸å¿æè¦</h2>
<p>æ¬æéå¯¹å¨FastAPIæ¡æ¶ä¸ä½¿ç¨TinyDBï¼JSONæä»¶æ°æ®åºï¼æ¶éå°çå¹¶ååå¥æ°æ®å²çªãéä¹±é®é¢ï¼æ·±å¥æµåºå°è§£éäºé®é¢æ ¹æºï¼å¹¶æä¾äºä»âæä»¶éâå°âåå­éåâåå°âä¹è§éâçä¸ç§ç±æµå¥æ·±çå®æè§£å³æ¹æ¡ï¼å¸®å©ä½ æ ¹æ®å®éåºæ¯éæ©ï¼ç¡®ä¿æ°æ®ä¸è´æ§ã</p>
<h2>ð¶ââï¸ ä¸»è¦åå®¹èç»</h2>
<div>
<p>ð ä¸ãé®é¢æ ¹æºï¼ä¸ºä»ä¹ç®åçJSONæä»¶ä¼âææ¶âï¼</p>
<p>ð ï¸ äºãè§£å³æ¹æ¡ï¼ä»âéâå°âéåâçä¸å±é²å¾¡</p>
<p>- æ¹æ¡ä¸ï¼æä»¶éï¼fcntl / portalockerï¼ââ ç»æä»¶ä¸ä¸ªâè¯·å¿ææ°âç</p>
<p>- æ¹æ¡äºï¼åå­æä½éåï¼asyncio.Queueï¼ââ è®©è¯·æ±æå¥½éï¼ä¸ä¸ªä¸ä¸ªæ¥</p>
<p>- æ¹æ¡ä¸ï¼åºç¨å±ä¹è§éï¼çæ¬å·æ ¡éªï¼ââ âææ¹çæ¶åï¼ä¸è¥¿è¿æ¯åæ¥çæ ·å­åï¼â</p>
<p>ð» ä¸ãå®æä»£ç ï¼å°æ¹æ¡èå¥FastAPIä¾èµé¡¹ä¸è·¯ç±</p>
<p>â ï¸ åãéè¦æéä¸è¾¹çæ¢è®¨ï¼è¿ä¸æ¯é¶å¼¹</p>
</div>
<h2>ð ç¬¬ä¸é¨åï¼é®é¢ä¸èæ¯</h2>
<p>æ³è±¡ä¸ä¸ï¼TinyDBç<code style="color: rgba(186, 55, 42, 1)">db.json</code>æä»¶å°±æ¯ä¸ä¸ªå±äº«çç¬è®°æ¬ãFastAPIçæ¯ä¸ªå·¥ä½è¿ç¨ï¼Workerï¼å°±åä¸ä¸ªå¿«éè®°å½åã</p>
<p>å½ç¨æ·Açè¯·æ±å°æ¥æ¶ï¼è®°å½å1æå¼ç¬è®°æ¬ï¼è¯»å°æä¸ªå¼ï¼æ¯å¦åºå­ä¸º5ï¼ï¼åå¤å°å¶æ¹ä¸º4ã</p>
<p><strong style="color: rgba(186, 55, 42, 1)">å°±å¨è¿âè¯»å°âåâæ¹åâçæ¯«ç§ä¹é´</strong>ï¼ç¨æ·Bçè¯·æ±ä¹æ¥äºãè®°å½å2ä¹æå¼äºåä¸ä¸ªç¬è®°æ¬ï¼ä»è¯»å°çåºå­<strong>ä»ç¶æ¯5</strong>ï¼å ä¸ºè®°å½å1è¿æ²¡ååå»ï¼ï¼ç¶åä»ä¹è®¡ç®ï¼å°åºå­æ¹ä¸º3ã</p>
<p>ç»æå°±æ¯ï¼æ è®ºè°æåä¿å­ï¼å¦ä¸ä¸ªäººçä¿®æ¹é½ä¼è¢«å®å¨è¦çãè¿å°±æ¯å¸åçâå¹¶ååå²çªâãå¨é«å¹¶åçWeb APIåºæ¯ä¸ï¼è¿ä¸ªé®é¢ä¼è¢«æ¥å§æ¾å¤§ã</p>
<h2>ð ï¸ ç¬¬äºé¨åï¼æ ¸å¿åçä¸æ­¥éª¤</h2>
<h3>ð¯ æ¹æ¡ä¸ï¼æä»¶éï¼æç´æ¥çç©çéç¦»ï¼</h3>
<p>åçï¼å¨è¯»åæä»¶åï¼åç»è¿ä¸ªæä»¶å ä¸æç³»ç»çº§çéãå¶ä»è¿ç¨å°è¯å éæ¶ï¼ä¼è¢«é»å¡æå¤±è´¥ï¼ç´å°éè¢«éæ¾ãè¿å°±åç»ç¬è®°æ¬çæ¿é´é¨ä¸äºéï¼ä¸æ¬¡åªè¿ä¸ä¸ªäººã</p>
<p><strong style="color: rgba(186, 55, 42, 1)">éç¨åºæ¯ï¼</strong> ä½å¹¶åï¼å¦åé¨å·¥å·ï¼ãè¯»åä¸é£ä¹é¢ç¹çåºæ¯ã</p>
<pre class="highlighter-hljs" style="background-color: rgba(246, 248, 250, 1); padding: 15px; border-radius: 5px; overflow-x: auto"><code># å®è£ï¼pip install portalocker
import portalocker

def safe_update_db():
    with open('db.json', 'r+') as f:
        portalocker.lock(f, portalocker.LOCK_EX)  # è·åç¬å é
        # å¨è¿éå®å¨å°è¯»ååä¿®æ¹æ°æ®
        data = json.load(f)
        data['counter'] += 1
        f.seek(0)
        json.dump(data, f)
        f.truncate()
        # éåºwithåæ¶ï¼éä¼èªå¨éæ¾</code></pre>
<h3>ð¯ æ¹æ¡äºï¼åå­æä½éåï¼åè¿ç¨åçç§©åºç»´æ¤èï¼</h3>
<p>åçï¼å©ç¨Pythonç<code style="color: rgba(186, 55, 42, 1)">asyncio.Queue</code>ï¼å°ææå¯¹TinyDBçåæä½å°è£æä»»å¡ï¼æ¾å¥ä¸ä¸ªéåãç±ä¸ä¸ªåç¬çâæ¶è´¹èâåç¨ä»éåä¸­ä¾æ¬¡ååºä»»å¡æ§è¡ãè¿æ ·ï¼æ è®ºå¤é¨è¯·æ±å¤ä¹å¹¶åï¼å¯¹æ°æ®åºçåæä½é½æ¯<strong>ä¸²è¡å</strong>çã</p>
<p><strong style="color: rgba(186, 55, 42, 1)">ä¼ç¹ï¼</strong> å®å¨å¨åå­ä¸­æä½ï¼éåº¦æå¿«ï¼é¿åäºæä»¶éå¯è½å¸¦æ¥çæ­»éæè·¨å¹³å°é®é¢ãéå¸¸éåFastAPIçå¼æ­¥æ¨¡å¼ã</p>
<p><strong style="color: rgba(186, 55, 42, 1)">å³é®è­¦åï¼</strong> æ­¤æ¹æ¡ä»å¨<u>åä¸ªæå¡è¿ç¨</u>åææãå¦æä½ ä½¿ç¨å¤ä¸ªå·¥ä½è¿ç¨ï¼å¦<span style="color: rgba(186, 55, 42, 1)"><code>Uvicorn with --workers 4</code></span>ï¼ï¼æ¯ä¸ªè¿ç¨æèªå·±çåå­åéåï¼å²çªä¾ç¶ä¼åçãæ­¤æ¶éæ­éæ¹æ¡ä¸ææ¹æ¡ä¸ã</p>
<h3>ð¯ æ¹æ¡ä¸ï¼åºç¨å±ä¹è§éï¼åºäºçæ¬çå²çªæ£æµï¼</h3>
<p>åçï¼ä¸é»æ­¢âè¯»âï¼åªå¨âåâçæ¶åæ£æ¥å²çªãä¸ºæ¯æ¡æ°æ®å¢å ä¸ä¸ª<code style="color: rgba(186, 55, 42, 1)">version</code>å­æ®µãæ¯æ¬¡è¯»åæ°æ®æ¶ï¼è¿å¸¦çæ¬å·ä¸èµ·è¯»åºãä¿®æ¹åååæ¶ï¼æ£æ¥å½åæä»¶ä¸­ççæ¬å·æ¯å¦åèªå·±è¯»å°ççæ¬å·ä¸è´ãå¦æä¸è´ï¼ååå¥ï¼å¹¶å°çæ¬å·+1ï¼å¦æä¸ä¸è´ï¼åè¯´æå¨æ­¤æé´æ°æ®å·²è¢«ä»äººä¿®æ¹ï¼æ¬æ¬¡æä½å¤±è´¥ï¼éè¦æç¤ºç¨æ·éè¯ã</p>
<p>è¿å°±åä¸¤ä¸ªäººç¼è¾å¨çº¿ææ¡£ï¼ç³»ç»ä¼æç¤ºä½ âå¨ä½ ç¼è¾æé´ï¼ææ¡£å·²è¢«ä»äººæ´æ°âã</p>
<h2>ð» ç¬¬ä¸é¨åï¼å®ææ¼ç¤ºï¼æ´åæ¹æ¡äºä¸ä¸ï¼</h2>
<p>ä¸é¢æ¯ä¸ä¸ªå¨FastAPIä¸­æ´å<strong>åå­éå</strong>ä¸<strong>ä¹è§é</strong>çæ ¸å¿ç¤ºä¾ï¼</p>
<pre class="highlighter-hljs" style="background-color: rgba(246, 248, 250, 1); padding: 15px; border-radius: 5px; overflow-x: auto"><code>from fastapi import FastAPI, Depends, HTTPException
from contextlib import asynccontextmanager
import asyncio
from tinydb import TinyDB, Query
import json
from pydantic import BaseModel

app = FastAPI()
write_queue = asyncio.Queue()
db_path = 'db.json'

# æ°æ®æ¨¡å
class ItemUpdate(BaseModel):
    item_id: int
    new_value: str
    read_version: int  # å®¢æ·ç«¯ä¼ æ¥çè¯»åæ¶ççæ¬å·

# å¯å¨æ¶å¯å¨åä»»å¡æ¶è´¹è
@asynccontextmanager
async def lifespan(app: FastAPI):
    # å¯å¨æ¶
    asyncio.create_task(db_write_consumer())
    yield
    # å³é­æ¶...

app = FastAPI(lifespan=lifespan)

async def db_write_consumer():
    """åæä½æ¶è´¹èï¼å¸¸é©»åå°ï¼ä¸²è¡å¤çåéå"""
    while True:
        task_data = await write_queue.get()
        await _perform_safe_write(task_data)
        write_queue.task_done()

async def _perform_safe_write(task_data: dict):
    """æ§è¡å¸¦ä¹è§éæ£æ¥çåå¥"""
    with TinyDB(db_path) as db:
        Item = Query()
        record = db.get(Item.id == task_data['item_id'])
        if not record:
            # å¤çè®°å½ä¸å­å¨çæåµ...
            return
        # ä¹è§éæ£æ¥ï¼ï¼ï¼
        if record['version'] != task_data['read_version']:
            raise ValueError(f"æ°æ®çæ¬å²çªãå½åçæ¬{record['version']}ï¼æäº¤çæ¬{task_data['read_version']}")
        # éè¿æ£æ¥ï¼æ§è¡æ´æ°
        db.update({
            'value': task_data['new_value'],
            'version': record['version'] + 1  # çæ¬å·éå¢
        }, Item.id == task_data['item_id'])

@app.put("/update_item/")
async def update_item(update: ItemUpdate):
    """æ´æ°æ¥å£"""
    try:
        # å°åæä½å°è£æä»»å¡ï¼æ¾å¥éåï¼ç­å¾æ¶è´¹èå¤ç
        await write_queue.put(update.dict())
        # è¿éå¯ä»¥è¿åä¸ä¸ªä»»å¡IDï¼è®©å®¢æ·ç«¯è½®è¯¢ç»æï¼æèä½¿ç¨WebSocketæ¨é
        return {"message": "æ´æ°è¯·æ±å·²å å¥éå"}
    except asyncio.QueueFull:
        raise HTTPException(status_code=429, detail="ç³»ç»ç¹å¿ï¼è¯·ç¨åéè¯")

@app.get("/get_item/{item_id}")
async def get_item(item_id: int):
    """è¯»åæ¥å£ï¼è¿åæ°æ®åå½åçæ¬å·"""
    with TinyDB(db_path) as db:
        Item = Query()
        record = db.get(Item.id == item_id)
        if record:
            return {"value": record['value'], "version": record['version']}
        raise HTTPException(status_code=404, detail="Item not found")</code></pre>
<h2>â ï¸ ç¬¬åé¨åï¼æ³¨æäºé¡¹ä¸è¿é¶æè</h2>
<div>
<p>ð¨ <strong style="color: rgba(186, 55, 42, 1)">éè¦æéï¼</strong></p>
<p>1. <strong>æ§è½ç¶é¢ï¼</strong> æææ¹æ¡çæ ¸å¿é½æ¯âä¸²è¡ååâãè¿æå³çä½ çæ°æ®åºåååéå­å¨ä¸éãå¯¹äºè¶é«å¹¶ååå¥åºæ¯ï¼JSONæä»¶æ¬èº«å°±ä¼æä¸ºç¶é¢ã</p>
<p>2. <strong>å¤è¿ç¨éå¶ï¼</strong> åå­éåæ¹æ¡å¨åè¿ç¨åå®ç¾ï¼å¤è¿ç¨ééååå¸å¼éï¼å¦Rediséï¼æåå½å°æ°æ®åºæ¹æ¡ã</p>
<p>3. <strong>æéæ¢å¤ï¼</strong> éåä¸­çä»»å¡å¨æå¡éå¯æ¶ä¼ä¸¢å¤±ãå¯¹æ°æ®ä¸è´æ§è¦æ±æé«çåºæ¯ï¼éè¦å¼å¥æä¹åæ¶æ¯éåï¼å¦RabbitMQï¼æç´æ¥ä½¿ç¨çæ­£çæ°æ®åºã</p>
</div>
<p><strong>ååæèï¼</strong> ææ¯éåæ°¸è¿æ¯æè¡¡çèºæ¯ãTinyDBçä¼ç¹æ¯æè´ç®åãæ éå¤é¨æå¡ãä½å½ä½ çå¹¶ååä¸è´æ§è¦æ±å¢é¿å°ä¸å®é¶æ®µæ¶ï¼å°±æ¯èèåçº§å°SQLiteï¼æ¯ææ´å®åçäºå¡åå¹¶åæ§å¶ï¼ãPostgreSQLç­æ´å¼ºå¤§æ°æ®åºçæ¶åäºãæ¬æ¬¡å®æçæ¹æ¡ï¼æ¯ä½ ä»âç©å·é¡¹ç®âå¹³ç¨³è¿æ¸¡å°âçäº§ç³»ç»âçä¸åº§å³é®æ¡¥æ¢ã</p>
<p style="text-align: center">---<strong>åå¨æå</strong>---<br>å¸æè¿ä»½æ»ç»è½å¸®ä½ é¿å¼ä¸äºåãå¦æè§å¾æç¨ï¼ä¸å¦¨ç¹ä¸ª èµð æ æ¶èâ­ æ è®°ä¸ä¸ï¼æ¹ä¾¿éæ¶åé¡¾ãä¹æ¬¢è¿å³æ³¨æï¼åç»­ä¸ºä½ å¸¦æ¥æ´å¤ç±»ä¼¼çå®æè§£æãæä»»ä½çé®ææ³æ³ï¼æä»¬è¯è®ºåºè§ï¼ä¸èµ·äº¤æµå¼åä¸­çåç§å¿å¾ä¸é®é¢ã</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-07 08:55">2026-01-07 08:54</span>&nbsp;
<a href="https://www.cnblogs.com/ymtianyu">ä¸åç¨åºåªå</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19450340);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19450340', targetLink: 'https://www.cnblogs.com/ymtianyu/p/19450340', title: 'FastAPI + TinyDBå¹¶åé·é±ä¸å®æï¼åå«æ°æ®éä¹±çè§£å³æ¹æ¡' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ PHP å¼æ­¥ä¸å¤çº¿ç¨ ä» TrueAsync å±ææªæ¥ ]]></title>
    <link>https://www.cnblogs.com/catchadmin/p/19450129</link>
    <guid>a515235606c58dab7f14a5194cfa7dbc</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/catchadmin/p/19450129" title="åå¸äº 2026-01-07 07:12">
    <span role="heading" aria-level="2">PHP å¼æ­¥ä¸å¤çº¿ç¨ ä» TrueAsync å±ææªæ¥</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="php-å¼æ­¥ä¸å¤çº¿ç¨-ä»-trueasync-å±ææªæ¥">PHP å¼æ­¥ä¸å¤çº¿ç¨ ä» TrueAsync å±ææªæ¥</h1>
<p>RFC TrueAsync 1.7 è®¨è®ºä¸­æä¸ªé®é¢ï¼è¿ä¸ªæè®®ä¼å¦ä½ä¸ PHP æ ¸å¿æªæ¥çååäºå¨ï¼è¦è®¾è®¡å¥½è¯­è¨çé¿ææ¼è¿ï¼è³å°å¾å¯¹ PHP çåå±æ¹åæåºæ¬å¤æ­ãæ¬æè¯å¾åç­è¿ä¸ªé®é¢ã</p>
<p>TrueAsync é¡¹ç®ä¸ä»æ¯ PHP æ ¸å¿ç async æ¹å¨ï¼è¿åæ¬åç­ä»¥ä¸é®é¢æéçå¶ä»ç ç©¶ï¼</p>
<ul>
<li>PHP è½å¨å¤å¤§ç¨åº¦ä¸åå¤çº¿ç¨æ¹ååå±ï¼</li>
<li>æ¯å¦å­å¨æ ¹æ¬æ§éå¶ï¼</li>
<li>å®ç°çæ­£çå¤çº¿ç¨å¯è½éè¦åªäºæ ¸å¿æ¹å¨ï¼</li>
<li>å¯ä»¥å®ç°åªäºè¯­è¨æ½è±¡ï¼</li>
</ul>
<p>æ¬æä¸æ¯ PHP å¤çº¿ç¨çè¯¦å°½ç»¼è¿°ï¼ä¹ä¸è¿½æ±æ¯ä¸ªç»èçææ¯ç²¾ç¡®æ§æå¤§ä¼å¯è¯»æ§ãä½å¸æå®å¯¹ PHP å¼åèæåèä»·å¼ï¼è½ä¸ºåç»­è®¨è®ºæä¾æ¹åã</p>
<p><a href="https://catchadmin.com/post/2026-01/multithreading-in-php-looking-to-the-future" target="_blank" rel="noopener nofollow">åæ PHP å¼æ­¥ä¸å¤çº¿ç¨ ä» TrueAsync å±ææªæ¥</a></p>
<h2 id="åå²">åå²</h2>
<p>å å¹´åè¦ç» PHP åºç¨å é«å®¹éé¥æµï¼æè¯´åä¸å°ãçå° Swoole æ¶æåæ³æµè¯ä¸ä¸ãè½ä¸è½åä¸ä¸ª APIï¼çæåå¤çå¤§éæ°æ®çåæ¶ä¸ææ¢å®¢æ·ç«¯ï¼</p>
<p>æä»¬ç» PHP åäºä¸ªä¼åç OpenTelemetryï¼åæ¹åæ°æ®ï¼æ¶éæå¤§åååå°ä¸­é´é¥æµæå¡å¨ãæ°æ®åç¼©ï¼JSON ç»æç¨ MessagePack åºååã</p>
<p>åè®¾æ¯ï¼ç¨åçº¿ç¨åç¨éæ­¥æå»ºé¥æµæ°æ®ï¼å®æ¶æè¾¾å°éå¼æ¶åéãæ²¡æè·¨çº¿ç¨äº¤äºï¼ä»£ç åºè¯¥å¿«ãççåï¼</p>
<p>å®éªç»æï¼é¥æµè®© API ååéååãåè®¾éäºãä¸ºä»ä¹ï¼æ¦å¿µä¸çèµ·æ¥æ²¡é®é¢ãSwoole å·²ç»è®© PHP å½æ°éé»å¡ï¼åç¨åºè¯¥é«ææå¯¹ãåªéåºéäºï¼</p>
<p>ç¬¬äºçæ¹æï¼é¥æµåªå¨ä¸ä¸ªè¯·æ±æé´æ¶éï¼ç«å³æç»ä½ä¸è¿ç¨å»èåãåç¼©ãåéãè¿çæ§è½å¥½å¤äºãä½ä¸åºè¯¥åï¼è¿ç¨é´æ°æ®èµ°ç®¡éï¼ä¸ç«¯åºååå¦ä¸ç«¯ååºååãç®¡éå¨åå­éï¼ä½ç³»ç»è°ç¨å¼éä¸å°ã</p>
<p>åæ¥æ¾å°åå ï¼é¥æµæ°æ®éå¤§ï¼åç¼©ç¸å¯¹ API è¯·æ±å¤çåæå¤ªå¤ CPUãSwoole åç¨å¯¹ I/O é«æï¼ä½å¸®ä¸äº CPU å¯éåä»»å¡ã</p>
<p>è¿ä¸ªæ¡ä¾è¯´æåçº¿ç¨åç¨è§£å³ä¸äºææé®é¢ãä¹è¯´æå¤çº¿ç¨è½è¡¥ååç¨ï¼ç»æ´å¤é®é¢æä¾å·¥å·ã</p>
<h2 id="åçº¿ç¨--offload">åçº¿ç¨ + offload</h2>
<p>æ CPU å¯éåå·¥ä½å¸è½½å°åç¬è¿ç¨ä¸æ¯ä»ä¹æ°åæãè¿ä¸ªæ¨¡å¼å¨ä¸åè¯­è¨åæ¡æ¶ä¸­ç¬ç«åºç°ï¼å« <code>Single-threaded + offload</code>ã</p>
<p>æä¸ªæ¯æ¹ï¼ä¸ä¸ªäººå¿«éåæ£ä¿¡ä»¶ï¼æ¯å°æ¶å åå°ï¼ï¼éåè£¹ç±å¶ä»åå·¥ç¨å¡è½¦è£èµ°ãåæ£åè¦æ¯èªå·±å»æ¬åè£¹ï¼ä¿¡ä»¶éåå°±å å°å¤©è±æ¿äºã</p>
<p><code>Single-threaded + offload</code> æ¨¡åæä»»å¡åä¸¤ç±»ï¼</p>
<ul>
<li><strong>I/O-bound ä»»å¡</strong> â è¯»æä»¶ãç½ç»è°ç¨ãæ°æ®åºè®¿é®ãå¤§é¨åæ¶é´å¨ç­å¤é¨ä¸çãéè¿å¹¶å asyncï¼åç¨ã<code>await</code>ï¼ï¼ä¸ä¸ªçº¿ç¨è½å®¹çº³å åä¸ªè¿ç±»æä½ã</li>
<li><strong>CPU-bound ä»»å¡</strong> â åç¼©ãå å¯ãè§£æãè®¡ç®ãCPU æ»¡è´è·è·ï¼åé å¹¶åä¸å¤ï¼å¾ä¸æ´å¤æ ¸å¿ã</li>
</ul>
<p>æ¨¡åå¨ç©çä¸åç¦»è¿ä¸¤ç±»ä»»å¡ï¼ä¸»çº¿ç¨ï¼<code>Event Loop</code>ï¼åªç®¡ I/Oï¼CPU ä»»å¡æç»åç¬ççº¿ç¨æè¿ç¨ï¼<code>Workers</code>ï¼ã</p>
<p>Node.js é åçº¿ç¨ <code>Event Loop</code> åºåï¼å¾éåç½ç»åºç¨ãä½å¼åèè¦æ¯å¨è¯·æ±å¤çå¨éç´æ¥å¤çå¾åæåç¼©è§é¢ï¼æå¡å¨å°±ååçäºãåæ¥å äº <code>Worker Threads</code>ï¼ä¸é¨è· CPU å¯éåæä½ã</p>
<p>Python èµ°äºç±»ä¼¼è·¯çº¿ã<code>asyncio</code> åºæ¥åï¼I/O-bound ä»£ç æäºå¥½å·¥å·ï¼ä½ GILï¼å¨å±è§£éå¨éï¼æ¡çï¼åè¿ç¨åæ²¡æ³çæ­£ CPU å¹¶è¡ï¼åè¿ç¯æç« æ¶é®é¢å·²è§£å³ï¼ãé»å¡æä½æ <code>loop.run_in_executor()</code> å <code>asyncio.to_thread()</code>ï¼Python 3.9+ï¼ï¼æéæ´»å¸è½½å°çº¿ç¨æ± æè¿ç¨æ± ã<code>Event Loop</code> ä¿æååºï¼è®¡ç®å¹¶è¡è·ã</p>
<p>PHP/Swoole ä¹æ¯è¿ä¸ªæ¶æï¼<code>Request Workers</code> ç¨åç¨å¤ç HTTP è¯·æ±ï¼<code>Task Workers</code> è·éè®¡ç®ãéè¿ UnixSocket æç®¡ééä¿¡ï¼åè¿ç¨è½å¤çæ¯ç§çº¦ 10 ä¸æ¬¡æä½ã</p>
<h3 id="æ¨¡åçä¼å¿">æ¨¡åçä¼å¿</h3>
<p><strong>1. èµæºæç</strong></p>
<p>åçº¿ç¨ <code>Event Loop</code> è½ä»¥æå°å¼éæå¡å åä¸ªå¹¶å I/O æä½ãåç¨ä»»å¡é´åæ¢æ¯æä½ç³»ç»çº¿ç¨ä¸ä¸æåæ¢ä¾¿å®å¾å¤ãCPU-bound ä»»å¡å¨å¤æ ¸ä¸çæ­£å¹¶è¡ââæ¯ä¸ª worker å ä¸ä¸ªæ ¸å¿ï¼äºä¸å¹²æ°ã</p>
<p><strong>2. å¼åç®å</strong></p>
<p><code>Event Loop</code> éçä»£ç ä¸ç¨äºæ¥éãä¿¡å·éè¿äºå¤çº¿ç¨ç¼ç¨çç©æå¿ãåçº¿ç¨æ¨¡åä¸æ¬¡åªè·ä¸ä¸ªä»»å¡ï¼ç«ææ¡ä»¶ä¸å¯è½åºç°ã<code>Workers</code> å¹¶è¡è·ï¼ä½åªè¦éµå¾ª <code>Shared Nothing</code>ï¼åæ­¥é®é¢å°±ä¸å­å¨ã</p>
<p>å¤çº¿ç¨ä»£ç ååçº¿ç¨ async ä»£ç çå¤æåº¦å·®è·å¾å¤§ãç°ä»£è¯­è¨åæ¡æ¶é½å¥çåçº¿ç¨ async å»ï¼ä¸èµ°ç»å¸å¤çº¿ç¨ã</p>
<p><strong>3. ç¼è¯å¨/è¿è¡æ¶æ´ç®å</strong></p>
<p>åçº¿ç¨æ¨¡åç async å½æ°å¯¹ç¼è¯å¨åè¿è¡æ¶ç®åå¾å¤ãå¥½çå¤çº¿ç¨è¯­è¨éè¦èªå·±çä»£ç çæç®¡éãPHP æä¸ªç¡¬çº¦æï¼é¨åä»£ç ç¨ C åçï¼æ²¡æ³å¯¹çº¿ç¨ãåå­ç®¡çãåæ°ä¼ éåé«æçå­èç çº§ä¼åãGo çè®¾è®¡å¤æåºåï¼ä¸ææ ãå¤æ GCï¼é½æ¯é«æ goroutines å channels å¿éçãPHP ç GC åé¢ä¼è®²ï¼åå«æ¾æ¾ã</p>
<p><strong>4. æå¨è´è½½åé</strong></p>
<p>å¼åèå¯ä»¥ä¸»å¨å¨è¯·æ±å¤çä»£ç å worker æ± ä¹é´åéè´è½½ãæå¨æ§å¶è½ä»ç¡¬ä»¶æ¦¨åºçè®ºæå¤§å¼ãä½è¿ä¹æ¯ç¼ºç¹ã</p>
<h3 id="æ¨¡åçå£å¿">æ¨¡åçå£å¿</h3>
<p><strong>1. æå¨è´è½½åé</strong></p>
<p>æå¨åéæ¯åååãå¼åèå¯ä»¥éå¯¹ç¹å®ä»»å¡ä¼åï¼ä¹å¯è½è¯¯å¤ä»ä¹è¯¥æ¾ I/O ä»£ç ãä»ä¹è¯¥æ¾ workersãI/O ä»£ç å¡äºéæ´»ä¼è¿è½½ï¼ååºåæ¢ãå»¶è¿ä¸åã</p>
<p>è¿ä¸ªæ¨¡åè¦æ± PHP å¼åèæè¶³å¤æè½ï¼æèä¾èµæ¡æ¶ä½èæä¾çç°ææ¹æ¡ã</p>
<p><strong>2. ä¸éåææä»»å¡</strong></p>
<p><code>Single-threaded + offload</code> å¾éå Web æå¡å¨ãAPIãå¾®æå¡ââä¸»è¦è´è½½æ¯æ°æ®åºãæä»¶ç³»ç»ãç½ç»è°ç¨è¿äº I/Oãä½æ¯ä¸æ­¥é½è¦å¯éè®¡ç®çåºæ¯ââç§å­¦è®¡ç®ãæ¸²æãæºå¨å­¦ä¹ ââè¿ä¸ªæ¨¡åææå°±å·®äºãé£äºåºæ¯æ´éåå®å¨å¤çº¿ç¨ã</p>
<p>ä½ å¯è½è¯´ï¼è½æ¥åï¼åå¤å¥½äºï¼ä½ PHP æ¬èº«åå¤å¥½å¤çº¿ç¨äºåï¼</p>
<h2 id="php-åå¤å¥½å¤çº¿ç¨äºå">PHP åå¤å¥½å¤çº¿ç¨äºåï¼</h2>
<p>å¼å TrueAsync æ¶ï¼æé¾çè®¨è®ºä¹ä¸æ¯"ä¸ºä»ä¹ PHP æ²¡æ async"ãè§£é PHP ä¸ºä»ä¹è¿æ²¡åå¤å¥½å¤çº¿ç¨å¯è½åæ ·é¾ãä¸è¿åèèå¤çº¿ç¨æ¬èº«ãæä»¬ä¸ºä»ä¹éè¦å®ï¼æèæ¢ä¸ªé®æ³ï¼æä»¬ä¸ºä»ä¹ä¸éè¦å®ï¼</p>
<p><strong>å¤çº¿ç¨ä¸æ¯å¹¶è¡æ§è¡ä»£ç çå¿è¦æ¡ä»¶ã</strong></p>
<p>"å¹¶è¡å¿é¡»å¤çº¿ç¨"è¿ä¸ªæ³æ³æ©å°±å»å¨ç¨åºåèå­éäºï¼å°±å"é»æ´ä¼å¸ä¸è¥¿"å»å¨æµè¡æåéä¸æ ·ã</p>
<p>å¹¶è¡æ§è¡å®å¨å¯ä»¥ç¨è¿ç¨ï¼è¿ç¨å½¼æ­¤éç¦»ï¼80386 æ¶æå°±æäºï¼ãè¿ç¨éè¿ IPC éä¿¡ï¼å®æç¶æéè¿ä¿¡å·ï¼æä½ç³»ç»äºä»¶ï¼è·è¸ªãé£ä¸ºä»ä¹è¿è¦çº¿ç¨ï¼</p>
<p>è¦èå®åç­è¿ä¸ªé®é¢ï¼å¾ç©¿è¶åå»è¯·å½å¹´åå³å®çäººè§£éï¼Edsger DijkstraãFernando CorbatÃ³ãBarbara LiskovãRichard Rashidãåä¸ªè±å£ç§æºå¥½ãä½å°±ç®ä»ä»¬é½æ¥äºï¼å¯è½ä¹è¯´ä¸åºç´æ¥ç­æ¡ã</p>
<p>ä¸é¢è¿ä¸ªè¯´æ³æ¯éçï¼</p>
<blockquote>
<p>çº¿ç¨æ¯ä¸ºäºè®©å¹¶è¡ä»£ç ä¸ç¨é¢å¤å·¥å·å°±è½å±äº«åå­ã</p>
</blockquote>
<p>è¿ç¨ä¹è½å±äº«åå­ï¼ä½å¾ææ®µæ å°å°å°åç©ºé´ï¼é¢å¤å·¥å·ï¼ãçº¿ç¨é»è®¤å±äº«ææåå­ãçº¿ç¨ A è½è®¿é®çåé <code>x</code>ï¼çº¿ç¨ B å¨åä¸å°åä¹è½è®¿é®ï¼ä¸ç¨ä»»ä½æå·§â¦â¦ä½ç­ç­ï¼å¤ä¸ªçº¿ç¨æ²¡æ³å¨ä¸å é¢å¤å·¥å·çæåµä¸å®å¨ä½¿ç¨å±äº«åéã</p>
<p>æ´åç¡®çè¯´æ³æ¯ï¼</p>
<blockquote>
<p>çº¿ç¨æ¯ä¸ºäºå¨ä»»å¡é´ä¼ éåå­æ¶æ²¡æé¢å¤å¼éã</p>
</blockquote>
<p>å¦æçº¿ç¨ç¨åå­ä¼ æ¶æ¯ï¼ä¿è¯åä¸æ¶é´åªæä¸ä¸ªçº¿ç¨è½è®¿é®æååå­åºåï¼é£å¨åå­å CPU ä¸¤æ¹é¢é½æ¯æé«æçãçº¿ç¨å»æé¿åå±äº«åå­ãè¿ä¸ªæ¨¡åå« <code>Shared Nothing</code>ã</p>
<p><strong>çº¿ç¨æ¯ä¸ºäºå¨ä»»å¡é´é«æä¼ æ°æ®ã</strong> è·"é»æ´ä¸å¸ä¸è¥¿"ä¸æ ·æ¯äºå®ã</p>
<h2 id="php-åå­æ¨¡å">PHP åå­æ¨¡å</h2>
<p>PHP æä¹å¤çåå­ï¼ç®åçæ½è±¡æ¨¡åï¼</p>
<ul>
<li>ä»£ç </li>
<li>æ°æ®</li>
<li>PHP VM ç¶æ</li>
</ul>
<p>çº¿ç¨é´å±äº« PHP ä»£ç å·²ç»è½åå°ï¼PHP JIT è§£å³äºï¼ãå¶ä»ç»ä»¶ç´§å¯è¦åï¼æä¸å¼ãæ¯å¦ PHP ç¨ä¸ä¸ªå¨å± <code>object_store</code> å­ææåå»ºå¯¹è±¡çå¼ç¨ãPHP åå­ç®¡çå¨æ¯ç»åä¸ª PHP VM çå¯¹è±¡è®¾è®¡çï¼ä¸é¢åå¤çº¿ç¨ãPHP åå¾æ¶éå¨å¤çä¸äºä¸åçº¿ç¨çæ°æ®ï¼çè³è¦å®å¨åæ VMï¼å ä¸ºå®ç´æ¥æ¹å¯¹è±¡ç <code>refcount</code>ã</p>
<p>æä»¥ <strong>PHP æ¯ä¸¥æ ¼çåçº¿ç¨æ¨¡åï¼å¸¦ stop-the-world GC</strong>ã</p>
<h2 id="å¨çº¿ç¨é´ç§»å¨-php-vm">å¨çº¿ç¨é´ç§»å¨ PHP VM</h2>
<p>PHP ç¨çº¿ç¨å±é¨å­å¨ï¼<code>Thread-Local Storage</code>ï¼TLSï¼ä¿å­æ¯ä¸ªçº¿ç¨ç VM ç¶æãè¿å¯¹ ZTSï¼Zend Thread Safetyï¼æ¨¡å¼ä¸çº¿ç¨é´éç¦»å¾å³é®ã</p>
<p>ç°ä»£ PHP æå»ºç¨ C11 æ åç <code>__thread</code>ï¼MSVC éæ¯ <code>__declspec(thread)</code>ï¼è·å VM ç¶ææéãéåº¦å¾å¿«ï¼x86_64 ä¸å°±æ¯ä» FS æ GS å¯å­å¨çåºåè¯»ä¸ä¸ªåç§»éã</p>
<pre><code class="language-asm">; offset - ç¼è¯æ¶è®¡ç®çå¸¸éåç§»é
; fs - åå­æ®µçåºå°å
mov rax, QWORD PTR fs:offset
</code></pre>
<p>FS/GS å¯¹æ¯ä¸ªçº¿ç¨å¯ä¸ï¼æä½ç³»ç»ä¿è¯ï¼ï¼è¯»åºæ¥çæ»æ¯æ­£ç¡®ç VM ç¶ææéã</p>
<p>è½å¨çº¿ç¨é´ç§»å¨ VM ç¶æï¼å°±è½å®ç°ç±»ä¼¼ Go åç¨æ actors çåè½ãç°ä»£ VM éè¿èªå®ä¹ä»£ç çæä¼ ä¸ä¸æï¼ç¨ CPU å¯å­å¨ä¼  VM ç¶æãPHP åä¸å°è¿ä¸ªï¼å ä¸ºåºå±ç¨ C å½æ°ï¼C æ²¡æ³ç»æ¯ä¸ªå½æ°ä¼ éå¼ä¸ä¸æåæ°ãå¨çº¿ç¨é´ç§»å¨ PHP VM ç¶æä¼æå¤±ä¸å®æ§è½ã</p>
<p>ä½å¦æåªç§»å¨æ§è¡ä»£ç éè¦çé£ä¸å°é¨å VM ç¶æå¢ï¼æ¯å¦ PHP Fiber åæ¢æ¶ä¼å¤å¶æåå¨å±ç»æï¼<code>zend_executor_globals</code>ï¼çé¨åæéã</p>
<p>å¦ææ PHP VM æ¦å¿µä¸åæä¸¤é¨åï¼</p>
<ul>
<li><strong>PHP VM shared</strong>ãç±»ãå½æ°ãå¸¸éãini æä»¤ãå¯æ§è¡ä»£ç ã</li>
<li><strong>PHP VM movable</strong>ãéè¦ç§»å¨ç VM é¨åã</li>
</ul>
<p><img alt="PHP Memory Model" loading="lazy" data-src="https://image.catchadmin.com/202601060808667.png" class="lazyload"></p>
<p>æäºç»æå¯ä»¥æ è®°ä¸ºå±äº«ï¼æäºæ è®°ä¸ºå¯ç§»å¨ï¼<code>Executor Globals</code> çè³å¯ä»¥ææå±äº«åå¯ç§»å¨ä¸¤é¨åï¼å®ç°çº¿ç¨é´é«æç VM ç¶æç§»å¨ãæ©å±å¨å±ç»æä¸ä¼å ä¸ºå¤ä¸å±é´æ¥èæå¤±æ§è½ï¼å ä¸ºå®ä»¬æ¬æ¥å°±å¨ç¨é´æ¥è®¿é®ã</p>
<p>é®é¢åºå¨ä»£ç ç¼è¯ç¸å³çç»æä¸ãPHP éè¿ <code>include</code>/<code>require</code>ã<code>eval</code> åèªå¨å è½½æ¯å¨æçï¼è¿è®© VM ç¶æå¾é¾ææææå±äº«åå¯ç§»å¨ä¸¤é¨åãå¦æè½è§£å³è¿ä¸ªé®é¢ï¼PHP å°±è½ä»¥å¾å°çå¼éå¨çº¿ç¨é´ç§»å¨é¨å VM ç¶æã</p>
<h2 id="å¨çº¿ç¨é´ä¼ éå¯¹è±¡">å¨çº¿ç¨é´ä¼ éå¯¹è±¡</h2>
<p>PHP è¦æ¹ä»ä¹æè½å®å¨å°å¨çº¿ç¨é´ä¼ éå¯¹è±¡ï¼æä¹åï¼</p>
<p>ä»è¯­è¨å±é¢çãåè®¾ <code>$obj</code> éæä¸ª <code>SomeObject</code> å®ä¾ï¼è¦åå°å¦ä¸ä¸ªçº¿ç¨ãè½åå°åï¼</p>
<pre><code class="language-php">$obj = new SomeObject();

$thread = new Thread(function () use ($obj) {
    echo $obj-&gt;someMethod();
});

$thread-&gt;join();
</code></pre>
<p><code>SomeObject</code> åªå±äº <code>$obj</code>ï¼å¯ä»¥å®å¨å°æå°åä»ä¸ä¸ªçº¿ç¨ç§»å°å¦ä¸ä¸ªãä¸»çº¿ç¨ç <code>$obj</code> ä¼è¢«éæ¯ï¼</p>
<pre><code class="language-php">$obj = new SomeObject();
$thread = new Thread(function () use ($obj) {
    echo $obj-&gt;someMethod();
});

// $obj å¨è¿éæªå®ä¹
$thread-&gt;join();
</code></pre>
<p>ä¸é¢çä»£ç è· C++ å Rust çç§»å¨è¯­ä¹å®å¨ä¸æ ·ãè¿ç§çº¿ç¨é´ä¼ åå­çæ¹å¼ï¼</p>
<ul>
<li><strong>å®å¨</strong>ãåªæä¸ä¸ªçº¿ç¨æ¥æå¯¹è±¡ã</li>
<li><strong>æ²¡æå¤å¶æåºååå¼é</strong>ã</li>
</ul>
<p>ä¸ºäºè®©è¡ä¸ºå¯é¢æµãéæåæå¨è½è¯»æï¼åºè¯¥å ç¹æ®çç§»å¨è¯­æ³ï¼</p>
<pre><code class="language-php">$obj = new SomeObject();

// consume $obj è¡¨ç¤ºç§»å¨å¯¹è±¡
$thread = new Thread(function () use (consume $obj) {
    echo $obj-&gt;someMethod();
});

// $obj å¨è¿éæªå®ä¹ãå¨ PHP9 ä¸­åºè¯¥å¨è¿éæ¥åéè¯¯ã
echo $obj;
</code></pre>
<p>ççä¸éï¼</p>
<p>ä½ç§»å¨ <code>refcount = 1</code> çå¯¹è±¡æé®é¢ã</p>
<p>çä¸ªåç±»æ çä¾å­ï¼</p>
<pre><code class="language-php">$electronics = new CategoryNode('Electronics');
$categoriesTree = new Tree();
$categoriesTree-&gt;addToPath('/products/electronics', $electronics);
$categoriesTree-&gt;addToPath('/popular/electronics', $electronics);  
// åä¸ä¸ªåç±»ï¼
</code></pre>
<p><code>$electronics</code> å¨æ éåºç°ä¸¤æ¬¡ï¼<code>refcount = 2</code>ï¼ãæ <code>$categoriesTree</code> ç§»å°å¦ä¸ä¸ªçº¿ç¨ä¼ææ ·ï¼</p>
<p>è¦å®å¨ç§»å¨ï¼å¿é¡»ä¿è¯å¾éææå¯¹è±¡é½æ²¡æå¤é¨å¼ç¨ï¼</p>
<pre><code class="language-php">$node = new CategoryNode('Electronics');
$categoriesTree = new Tree();
$categoriesTree-&gt;addToPath('/products/electronics', $node);

$favourites = [$node];  // å¤é¨å¼ç¨ï¼
$thread = new Thread(function () use ($categoriesTree) {
    // $categoriesTree è¢«ç§»å¨
});

// $favourites[0] ç°å¨æåå¦ä¸ä¸ªçº¿ç¨ä¸­çåå­
// æ¬ç©ºæéï¼
</code></pre>
<p>å®å¨ç§»å¨éè¦ï¼</p>
<ul>
<li><strong>å®æ´å¾éå</strong>ï¼æ£æ¥ææåµå¥å¯¹è±¡ã</li>
<li><strong>Refcount æ£æ¥</strong>ï¼å¾éæ¯ä¸ªå¯¹è±¡é½è¦æ¥ã</li>
<li><strong>èº«ä»½ä¿ç</strong>ï¼å¾åçéå¤é¡¹å¾ä¿æéå¤ã</li>
</ul>
<p>å¯ä»¥ä¸ºæ­¤è®¾è®¡ç®æ³ï¼å«æ·±æ·è´ãç®åå®ç°å¤§æ¦è¿æ ·ï¼</p>
<pre><code class="language-php">// æ·±æ·è´ä¼ªä»£ç 
// çº¿ç¨ A ä¸­çæºå¾
$node = new Node('A');        // addr: 0x1000
$tree-&gt;left = $node;          // addr: 0x1000
$tree-&gt;right = $node;         // addr: 0x1000 (ç¸åå¼ç¨)

// æ·±æ·è´å°çº¿ç¨ Bï¼å¸¦ MM çä¼ªä»£ç ï¼
$copied_map = [];  // åå¸è¡¨: addr_source -&gt; addr_target
function deepCopyToThread(object $obj, Thread $target_thread_mm) 
{
    $source_addr = get_object_address($obj);
    if (isset($copied_map[$source_addr])) {
        return $copied_map[$source_addr];  // å·²ç»å¤å¶ï¼
    }
    // å¨å¦ä¸ä¸ªçº¿ç¨ç MM ä¸­åéåå­
    $new_addr = $target_thread_mm-&gt;allocate(sizeof($obj));
    $copied_map[$source_addr] = $new_addr;
    // å¤å¶å¯¹è±¡æ°æ®
    memcpy($new_addr, $source_addr, sizeof($obj));
    // éåå±æ§
    foreach ($obj-&gt;properties as $prop) {
        if (is_object($prop)) {
            $new_prop_addr = deepCopyToThread($prop, $target_thread_mm);
            // æ´æ°æ°å¯¹è±¡ä¸­çæé
            update_property($new_addr, $prop, $new_prop_addr);
        }
    }
    return $new_addr;
}
// çº¿ç¨ B ä¸­çç»æï¼
// $newTree-&gt;left (addr: 0x2500) === $newTree-&gt;right (addr: 0x2500)
// èº«ä»½ä¿çï¼
</code></pre>
<p>æ·±æ·è´æ¶é´å¤æåº¦ O(N + E)ï¼N æ¯å¯¹è±¡æ°ï¼E æ¯å¼ç¨æ°ãç©ºé´å¤æåº¦ O(N)ââåå¸è¡¨ + æ°å¯¹è±¡ + éå½æ ã</p>
<p>æ¯åºååå¿«ï¼å ä¸ºä¸ç¨è½¬æ¢ä¼ è¾æ ¼å¼ï¼ä½æ¶çåå³äºæ°æ®å½¢ç¶åå¾å¤§å°ãä¹å¯ä»¥æ··åï¼<code>refcount = 1</code> çç§»å¨ï¼å¶ä»çæ·±æ·è´ã</p>
<p>ç»æï¼</p>
<ul>
<li>PHP å¼åèä¸ç¨ç®¡å¯¹è±¡æä¹ä¼ å°å¦ä¸ä¸ªçº¿ç¨ã</li>
<li>æå¥½æåµï¼åå­ç´æ¥ç§»å¨ï¼<code>refcount = 1</code>ï¼ã</li>
<li>æåæåµï¼æ·±æ·è´ï¼ä¿çèº«ä»½ï¼<code>refcount &gt; 1</code>ï¼ã</li>
</ul>
<p>ççè¿è¡ï¼</p>
<ul>
<li>PHP è¯­æ³æ¹å¨æå°</li>
<li>å¯ä»¥éæ­¥æ¹</li>
<li>å¤çº¿ç¨è½ç¨äº</li>
</ul>
<p>ä½æ ¸å¿å±é¢æ²¡é£ä¹ç¾å¥½ãè¦è®©å¯¹è±¡ç§»å¨æçï¼PHP éè¦è·¨çº¿ç¨çåå­ç®¡çæºå¶ãç°å¨åä¸å°ã</p>
<h2 id="å¤çº¿ç¨-php-åå­ç®¡çå¨">å¤çº¿ç¨ PHP åå­ç®¡çå¨</h2>
<p>PHP åå­ç®¡çå¨ç±»ä¼¼ jemalloc æ tcmalloc è¿äºç°ä»£åéå¨ãåºå«æ¯ï¼å®æ²¡æä»å¦ä¸ä¸ªçº¿ç¨éæ¾åå­çæ­£ç¡®ç®æ³ã</p>
<p>åºæ¯ï¼</p>
<ul>
<li>çº¿ç¨ A åå»ºå¯¹è±¡ã</li>
<li>ç§»å¨ï¼åæ ·ï¼ç»çº¿ç¨ Bã</li>
<li>B ä¸åéè¦ï¼è¦éæ¾ã</li>
</ul>
<p>æ¯ä¸ª PHP çº¿ç¨æèªå·±çåå­ç®¡çå¨ï¼<code>Memory Manager</code>ï¼MMï¼ãB æ³éæ¾ A åéçåå­å°±åºé®é¢äºãB ç MM ä¸è®¤è¯ A çåå­ï¼éæ¾ä¼åºéãB ç´æ¥è®¿é® A ç MM ç»æä¹ä¸è¡ï¼éè¦åæ­¥ãç°ä»£é«æ§è½å¤çº¿ç¨åéå¨ç¨å»¶è¿éæ¾ï¼<code>deferred free</code>ï¼è§£å³è¿ä¸ªé®é¢ã</p>
<p>å»¶è¿éæ¾çæè·¯ï¼</p>
<ul>
<li>B ç MM çå°ä¸ä¸ªä¸è®¤è¯çæéã</li>
<li>æ¾å°åªä¸ª MM æ¥æå®ï¼ç»é£ä¸ª MM çéååæ¶æ¯è¯´å¯ä»¥éæ¾äºã</li>
<li>A ç MM å¤çéåï¼å¨èªå·±çä¸ä¸æééæ¾ã</li>
</ul>
<p><img alt="Cross thread deferred free" loading="lazy" data-src="https://image.catchadmin.com/202601060809112.png" class="lazyload"></p>
<p>ç¨ç°ä»£æ éç»æï¼è¿ä¸ªç®æ³ååéé«ï¼ä¸åçº¿ç¨è½å¹¶è¡éæ¾åå­ï¼å ä¹ä¸ç¨éã</p>
<p>å¤çº¿ç¨ PHP åå­ç®¡çå¨ä¸ºä»¥åä¸å¯è½çæ¹å¨æå¼äºé¨ã</p>
<h2 id="å±äº«å¯¹è±¡">å±äº«å¯¹è±¡</h2>
<p>è½ç¨æå°æä½æåå­ä»ä¸ä¸ªçº¿ç¨ä¼ å°å¦ä¸ä¸ªå¾å¥½ï¼ä½å¦æè½åå»ºä¸å¼å§å°±è®¾è®¡æè·¨çº¿ç¨å±äº«çå¯¹è±¡å¢ï¼</p>
<p>å¾å¤æå¡å¯ä»¥æå»ºæä¸å¯åå¯¹è±¡ï¼åºè¯¥è½å¨è¿ç¨é´å±äº«ï¼çåå­ãå å¿« worker å¯å¨ã</p>
<p>ä½ <code>refcount</code> æ¡çï¼å®è®©ææ PHP å¯¹è±¡å®éä¸é½æ¯å¯åçãè½ç»è¿åï¼</p>
<h3 id="ä»£çå¯¹è±¡">ä»£çå¯¹è±¡</h3>
<p>ç¬¬ä¸ç§æ¹æ³æ¯ä»£çå¯¹è±¡ï¼å¼ç¨å­å¨ææçº¿ç¨å¯è®¿é®çå±äº«åå­æ± éççå®å¯¹è±¡ãä»£çåªå­æ è¯ç¬¦ææéï¼å ä¸è®¿é®æ°æ®çæ¹æ³ãç¼ºç¹ï¼</p>
<ul>
<li>è®¿é®æ°æ®/å±æ§åæ¢</li>
<li>Reflection API åç±»åæ£æ¥æ´å¤æ</li>
</ul>
<p>PHP å·²ç»æå¼ºå¤§çä»£çæºå¶ãä»£çå±äº«å¯¹è±¡å¨æäºåºæ¯ä¸éï¼æ¯å¦è®¡æ°å¨è¡¨æ Swoole/Table è¿æ ·çæ°æ®è¡¨ã</p>
<h3 id="å¸¦æ-gc_share-æ å¿çå±äº«å¯¹è±¡">å¸¦æ GC_SHARE æ å¿çå±äº«å¯¹è±¡</h3>
<p>PHP æä¸ªåç½®æºå¶éè¿ <code>GC_IMMUTABLE</code> æ å¿å®ç°ä¸å¯ååç´ ï¼ç¨äºï¼</p>
<ul>
<li>åé¨å­ç¬¦ä¸²ï¼<code>IS_STR_INTERNED</code>ï¼ââæ´ä¸ª PHP è¿ç¨å­å¨çå­ç¬¦ä¸²å¸¸é</li>
<li>ä¸å¯åæ°ç»ï¼<code>IS_ARRAY_IMMUTABLE</code>ï¼ââæ¯å¦ <code>zend_empty_array</code></li>
<li>opcache éçå¸¸éââå¸¦å¸¸éæ°æ®çç¼è¯ä»£ç </li>
</ul>
<p><code>GC_IMMUTABLE</code> è®©å¼æè·³è¿è¿äºç»æç <code>refcount</code> ä¿®æ¹ï¼</p>
<pre><code class="language-c">// Zend/zend_types.h
// ä¸º zend_refcounted_h å¢å  refcount çå½æ°
static zend_always_inline void zend_gc_try_addref(zend_refcounted_h *p) {
    if (!(p-&gt;u.type_info &amp; GC_IMMUTABLE)) {
        ZEND_RC_MOD_CHECK(p);
        ++p-&gt;refcount;
    }
}
</code></pre>
<p>ç±»ä¼¼æºå¶å¯ä»¥æ¯æ <code>SharedObjects</code>ï¼æ¯å¦å ä¸ª <code>GC_SHARE</code> æ å¿ã</p>
<p>æ§è½åææ¾ç¤ºï¼æ£æ¥ <code>GC_SHARE</code> ç»åç¬ç <code>refcount++</code> å äº +34% å¼éï¼å¾®åºåæµè¯ï¼ãå®éåºç¨é <code>refcount</code> æä½åªå æ»å·¥ä½ä¸å°é¨åï¼å½±åå ä¹çä¸åºæ¥ï¼</p>
<ul>
<li>çå®æä½ï¼æ°ç»/å¯¹è±¡ï¼ï¼+3â9%</li>
<li>å®éåºç¨ï¼+0.05â0.5%</li>
</ul>
<p>è¿è§£å³äºä¸åé®é¢ï¼å¦ä¸åæ¯ç»è¿äºå¯¹è±¡è®¾è®¡ GCãç¨åå­ <code>refcount</code> ä¸çæ³ï¼å¤çº¿ç¨è®¿é®åä¸å¯¹è±¡æ¶ä¼åæ¢ãå»¶è¿éæ¾ç®æ³å¯è½æ´åéã</p>
<h2 id="åºäºåºåçåå­">åºäºåºåçåå­</h2>
<p>åºäºåºåçåå­ï¼<code>Region-based memory</code>ï¼å¨é¢å Web çè¯­è¨éè¶æ¥è¶æµè¡ã</p>
<p>æè·¯ï¼ç»ç¹å®ä»»å¡æçº¿ç¨å¨åç¬åºååéåå­ï¼ä¸éè¦æ¶æ´ä½éæ¾ãé¿åäºéä¸ªå¯¹è±¡ç®¡ççå¤ææ§ï¼GC ä¹ç®åäºã</p>
<p>æ¯å¦ PHP MM å¯ä»¥ä¿è¯å¯¹è±¡å¨ç»å®å°ç¹å® PHP å¯¹è±¡çåºåéåå»ºãåºåçå½å¨æç­äºå¯¹è±¡çå½å¨æã</p>
<p>å¯¹è±¡éæ¯æ¶æ´ä¸ªåºåç´æ¥éæ¾ï¼ä¸ç¨éåå­å¯¹è±¡ãè¿ç§å¯¹è±¡è¦"ç§»å¨"å°å¦ä¸ä¸ªçº¿ç¨ï¼å¯ä»¥é¿åæ·±æ·è´ã</p>
<p>PHP VM å®ç°åºäºåºåçåå­æé®é¢ï¼æ¯å¦å¨å±å¯¹è±¡åè¡¨ãæä½ç ç¼å­ãä½é«æå®ç°çæºä¼ä¸æ¯é¶ï¼å¼å¾ç»§ç»­ç ç©¶ã</p>
<p>ææçåºäºåºåçåå­ç®æ³è½ä¸º actors æå¼é¨ââæéç¦»åå­çç¹æ®å¯¹è±¡ã</p>
<p><strong>Actors æ¯å¤çº¿ç¨ç¼ç¨éææ¹ä¾¿ãæå¼ºå¤§ãæå®å¨çå·¥å·ã</strong></p>
<h2 id="åç¨åçº¿ç¨åä½">åç¨åçº¿ç¨åä½</h2>
<p>ä»åç¨è§åº¦çï¼<code>Thread</code> æ¯ä¸ª <code>Awaitable</code> å¯¹è±¡ãåç¨å¯ä»¥ç­ <code>Thread</code> ç»æèä¸é»å¡å¶ä»åç¨ãä¸ä¸ªçº¿ç¨è½æç®¡å¾å¤ç­éä»»å¡çåç¨ãæå¡å®ä»¬ççº¿ç¨å¯¹æ°è¯·æ±ä¿æå¿«éååºï¼å ä¸ºç­ <code>Thread</code> ä¸é»å¡ <code>Event Loop</code>ã</p>
<pre><code class="language-php">use Async\await;
use Async\Thread;

$thread = new Thread(function() {
    // ç¡¬ä»¶å¯éåä»»å¡å¨è¿é
    return 42;
});

$result = await($thread); 
// åç¨å¨è¿éæåï¼ç´å° Thread å®æ
</code></pre>
<p>è¿ç§æ¹å¼è½å®ç°æ CPU å¯éåä»»å¡åç®åä¸å¡é»è¾çèå¤©åºæ¯ã<br>
<img alt="åç¨åçº¿ç¨åä½" loading="lazy" data-src="https://image.catchadmin.com/202601060809533.png" class="lazyload"></p>
<p>å¾éæ¯ä¸ªç¤ºä¾æ¶æãåºç¨æä¸¤ä¸ªçº¿ç¨æ± ï¼å¸¦å¹¶åå¤ä»»å¡çè¯·æ±å¤ççº¿ç¨ï¼åè· CPU å¯éåä»»å¡ç worker çº¿ç¨ãåç¨å¤çè¯·æ±ï¼worker è·éä»»å¡æ¶å¯ä»¥å®å¨æåï¼è·å®ç»§ç»­ã</p>
<pre><code class="language-php">use Async\await;
use Async\ThreadPool;

final readonly class ImageDto
{
    public function __construct(
    public int $width,
    public int $height,
    public string $text,
) {}
}

$pool = new ThreadPool(2);
$dto = new ImageDto(
    width: 200,
    height: 200,
    text: 'Hello TrueAsync!'
);

$image = $pool-&gt;enqueue(function (ImageDto $dto) {
    $img = imagecreatetruecolor($dto-&gt;width, $dto-&gt;height);

    $white = imagecolorallocate($img, 255, 255, 255);
    $black = imagecolorallocate($img, 0, 0, 0);

    imagefill($img, 0, 0, $white);
    imagestring($img, 5, 20, 90, $dto-&gt;text, $black);

    ob_start();
    imagepng($img);
    imagedestroy($img);
    return ob_get_clean();
}, $dto);

$response-&gt;setHeader('Content-Type', 'image/png');
$response-&gt;write($image);
$response-&gt;end();
</code></pre>
<p>åç¨ä»£ç æ¯é¡ºåºçï¼è¯»èµ·æ¥åæ®éä»£ç ï¼<code>ThreadPool::enqueue</code> åå¨åä¸çº¿ç¨è°ç¨åè°ä¸æ ·ãDTO è·¨çº¿ç¨ä¼ ï¼ç»æå­ç¬¦ä¸²ä¸ä¼å¨åå­éå¤å¶ä¸¤æ¬¡ã</p>
<h2 id="åå¾æ¶éå¨åæç¶ææ¨¡å¼">åå¾æ¶éå¨åæç¶ææ¨¡å¼</h2>
<p>ç°ä»£å PHP åå­ç®¡çå¨ä¸æ¯æ¹è¿å¤çº¿ç¨ç¯å¢å¯ä¸è¦åçäºãæ²¡æé«æ GCï¼å¤çº¿ç¨ PHP ä¼ææ§è½é®é¢åå¾ªç¯å¼ç¨å¯¼è´çåå­æ³æ¼ã</p>
<p>PHP GC ç¨ä¸¤ç§ç®æ³ï¼å¼ç¨è®¡æ°åä¸»è¦åå­ç®¡çï¼å¹¶åå¾ªç¯æ¶éï¼Concurrent Cycle Collectionï¼Bacon-Rajanï¼2001ï¼å¤çå¾ªç¯ãå¼ç¨è®¡æ°æ¯æ¬¡èµå¼é½éå¢/éåï¼æ²¡åæ­¥çè¯å¤çº¿ç¨ä¸å®å¨ãæ¯æ¬¡èµå¼ç¨åå­æä½å¼éå¤ªå¤§ï¼ä¸åæ­¥å°±æç«æåæ³æ¼ãå¾ªç¯æ¶éå¨è½ç¶å«"å¹¶å"ï¼ä½åªå¨åçº¿ç¨åå·¥ä½ï¼ç¨é¢è²æ è®°ï¼PURPLE â GREY â WHITE/BLACKï¼æ¾å¾ªç¯ï¼ä¹ä¸æ¯çº¿ç¨å®å¨çã</p>
<p>å¥½æ¶æ¯æ¯ï¼å½å GC å®ç°å¨å¤çº¿ç¨ç¯å¢è½å·¥ä½ï¼å ä¸ºå®è·åå­ç®¡çå¨åå¼ï¼ä¸ä¾èµåå­å¨åªåéã</p>
<p>ä½ PHP è¦è¿å¥æç¶æåºç¨çå¤çº¿ç¨æ¶ä»£ï¼GC å¾éåºï¼</p>
<ul>
<li>å¨åç¬çº¿ç¨å¹¶è¡è·ï¼ä¸å½±åä¸å¡ä»£ç ã</li>
<li>å°½å¿«éæ¾èµæºã</li>
<li>æä¾æ³æ¼æ£æµãæ¥å¿ãé¥æµçé¢å¤å·¥å·ï¼é¿æ¶é´è¿è¡çåºç¨ç¹å«éè¦ï¼ã</li>
</ul>
<p>å¾ªç¯æ¶éå¨å¯ä»¥æ¹æå¨å¤çº¿ç¨ç¯å¢å·¥ä½ï¼å¨åç¬çº¿ç¨å¤çå¼ç¨ï¼æé«æ´ä½ååºæ§ãè¿å¯è½å¤ç¨äºï¼</p>
<h2 id="actors">Actors</h2>
<p><code>ThreadPool</code> åçº¿ç¨é´ä¼ å¯¹è±¡æç¨ï¼ä½éè¦å¼åèçæ³¨æåãæè½åç²¾åãæä¸ªæ´å¥½çå¤çº¿ç¨ç¼ç¨æ½è±¡ï¼èä½çº¿ç¨/åå­å¤ææ§ï¼å®ç¾å¥åä¸å¡é»è¾ï¼actorsã</p>
<p><strong>Actors æ¯å¹¶åå¹¶è¡ç¼ç¨æ¨¡åï¼è®¡ç®çåºæ¬ååæ¯ actorã</strong></p>
<p>æ¯ä¸ª actorï¼</p>
<ul>
<li>æèªå·±çéç¦»ç¶æ</li>
<li>é¡ºåºå¤çæ¶æ¯</li>
<li>åªéè¿æ¶æ¯è·å¶ä» actors äº¤äº</li>
<li>å¯è½å¨åç¬çº¿ç¨è·</li>
</ul>
<p>å¯ä»¥æ actor æ³æå¯¹è±¡ï¼è¿è®©å¤çº¿ç¨ PHP è½ç¨çæç OOP æ¨¡å¼ã</p>
<p>æ³è±¡ä¸ä¸ªæå¾å¤æ¿é´çèå¤©æå¡å¨ãæ¯ä¸ªæ¿é´æ¯åç¬çå¯¹è±¡ã</p>
<pre><code class="language-php">use Async\Actor;

class ChatRoom extends Actor
{
    private array $messages = [];
    private string $name;

    public function __construct(string $name)
    {
        $this-&gt;name = $name;
    }

    public function postMessage(string $user, string $text): void
    {
        $this-&gt;messages[] = [
            'user' =&gt; $user,
            'text' =&gt; $text,
            'time' =&gt; time()
        ];
    }

    public function getMessages(): array
    {
        return $this-&gt;messages;
    }
}

spawn(function() {
   $room = new ChatRoom('general');
   $room-&gt;postMessage('Alice', 'Hello!');  // å¨å¦ä¸ä¸ªçº¿ç¨ä¸­è¿è¡ï¼æååç¨ï¼
   $messages = $room-&gt;getMessages();       // å¨å¦ä¸ä¸ªçº¿ç¨ä¸­è¿è¡ï¼æååç¨ï¼
   echo json_encode($messages);
});
</code></pre>
<p><code>ChatRoom</code> å¯¹è±¡ç¹æ®ãå®ä»¬çæ°æ®å PHP VM ç¶ææ¬å°åäºï¼æ¹ä¾¿å¨çº¿ç¨é´ç§»å¨ãæ¯ä¸ªæ¹æ³å¨èªå·±ççº¿ç¨è·ï¼ä½ä»»ä½æ¶å»åªæä¸ä¸ªçº¿ç¨è½æ§è¡ç»å® actor çæ¹æ³ã</p>
<p>è¯­ä¹ä¸ï¼åºç±» <code>Actor</code> å®ä¹äº PHP VM ååå­ç®¡çå¨çå·¥ä½æ¹å¼ï¼è®© <code>ChatRoom</code> å¯¹è±¡è½å®å¨å°å¨åç¬çº¿ç¨è·ãç±»ç±»åä¸åª"å­"æ¹æ³åå±æ§ä¿¡æ¯ï¼è¿å­ MM å GC è¯¥æä¹æä½è¿ç±»å¯¹è±¡ãRustãC++ ä¹æç±»ä¼¼åæ³ãå¥½å¤ï¼ä¸æ¹è¯­æ³ï¼ç¬¦å OOP å²å­¦ã</p>
<p>ç¤ºä¾çèµ·æ¥ååç¨éè·çæ®éé¡ºåºä»£ç ãä½ <code>postMessage</code> å <code>getMessages</code> å¨å¦ä¸ä¸ªçº¿ç¨è·ï¼ä¸ä¼ç´æ¥æ§è¡ãåç¨ç» actor éååæ¶æ¯ï¼è¿å¥ç­å¾ï¼actor å¨å¦ä¸ä¸ªçº¿ç¨è·å®æ¹æ³è¿åç»æåææ¢å¤ã</p>
<p>è¿è·çæç PHP OOP ä¸å²çªï¼<code>Actor</code> éå <code>__call</code>ï¼</p>
<pre><code class="language-php">class Actor 
{
    private $threadPool;

    public function __call(string $name, array $arguments): mixed
    {
        if(current_thread_id() === $this-&gt;threadPool-&gt;getThreadIdForActor($this)) {
            // å¦ææä»¬å¨åä¸ä¸ªçº¿ç¨ä¸­ï¼ç´æ¥è¿è¡æ¹æ³
            return $this-&gt;$name(...$arguments);
        }
    
        // å¦åå°è°ç¨æéç» actor
        return $this-&gt;threadPool-&gt;enqueueActorMethod($this, $name, $arguments);
    }
}
</code></pre>
<p><code>enqueueActorMethod</code> æ <code>postMessage</code> å å° actor éåï¼è®¢éç»æäºä»¶ï¼è°ç¨ <code>Async\suspend()</code> æååç¨ã</p>
<p>Actor ä»£ç é¡ºåºæ§è¡ï¼è§£å³ç«ææ¡ä»¶ï¼å¤çº¿ç¨å¼åå¯¹å¼åèéæã</p>
<p>å¹¶è¡æ§é æ¯ä¸ª <code>ChatRoom</code> actor è½å¨åç¬çº¿ç¨è·æ¥å®ç°ï¼</p>
<pre><code class="language-php">spawn(function() {
   $room = new ChatRoom('room1');
   $room-&gt;postMessage('Alice', 'Hello!');
   $messages = $room-&gt;getMessages();
   echo json_encode($messages);
});

spawn(function() {
   $room = new ChatRoom('room2');
   $room-&gt;postMessage('Bob', 'Hi there!');
   $messages = $room-&gt;getMessages();
   echo json_encode($messages);
});
</code></pre>
<p><code>ChatRoom</code> å®ä¾è½å¨ä¸åçº¿ç¨å¹¶è¡è·ï¼å ä¸ºæ¯ä¸ª actor æèªå·±çæ§è¡çº¿ç¨ãå¯ä¸ç PHP VM ç¶æååå­ã</p>
<p>åå»º 100 ä¸ªèå¤©å®¤ï¼</p>
<pre><code class="language-php">use Async\Actor;

$rooms = [
    'general' =&gt; new ChatRoom('general'),
    'random'  =&gt; new ChatRoom('random'),
    'tech'    =&gt; new ChatRoom('tech'),
    // ... 97 ä¸ªæ´å¤æ¿é´
];

// å¤çè¯·æ±çåç¨
HttpServer::onRequest(function(Request $request, Response $response) use ($rooms) {
   // HTTP è¯·æ±å¤ç
   $roomName = $request-&gt;getQueryParam('room');
   $room = $rooms[$roomName] ?? null;
   
   if (!$room) {
      $response-&gt;setStatus(404);
      $response-&gt;write('Room not found');
      $response-&gt;end();
      return;
   }
   
   // è°ç¨çèµ·æ¥æ¯åæ­¥çï¼ä½å¨å¦ä¸ä¸ªçº¿ç¨ä¸­è¿è¡ï¼
   $room-&gt;postMessage($request-&gt;getQueryParam('user'), $request-&gt;getQueryParam('text'));
   $messages = $room-&gt;getMessages();
   
   $response-&gt;setHeader('Content-Type',  'application/json');  
   $response-&gt;write(json_encode($messages));
   $response-&gt;end();
});
</code></pre>
<p>æ¯ä¸ªèå¤©å®¤é¡ºåºå¤çæ¶æ¯ï¼è·å¶ä»æ¿é´å¹¶è¡ã</p>
<p>Actors ä¸éè¦äºæ¥éãéãå¤æåæ­¥ææå¨çº¿ç¨æ± äº¤äºãå®ä»¬æ¯ç°æçé«çº§å¹¶è¡åæ¹æ¡ã</p>
<p>ä¸ä¸ªèå¤©å®¤è¦ç»å¦ä¸ä¸ªåæ¶æ¯ä¹è¡ï¼å ä¸º actors æ¯ <code>SharedObject</code>ï¼è½è·¨çº¿ç¨äº¤äºï¼</p>
<pre><code class="language-php">class Rooms extends Actor
{
    private array $rooms = [];
    
    public function __construct(string ...$roomNames)
    {
       foreach ($roomNames as $name) {
           $this-&gt;rooms[$name] = new ChatRoom($name);
       }
    }
    
    public function broadcastMessage(string $fromRoom, string $user, string $text): void
    {
        foreach ($this-&gt;rooms as $name =&gt; $room) {
            if ($name !== $fromRoom) {
                // éé»å¡è°ç¨
                $room-&gt;postMessageAsync($user, $text);
            }
        }
    }
}

spawn(function() {
   $rooms = new Rooms('general', 'room1', 'room2', 'room3');
   $rooms-&gt;broadcastMessage('general', 'Alice', 'Hello!');
});
</code></pre>
<h3 id="actor-åé¨">Actor åé¨</h3>
<p>PHP VM ä¿è¯ actor åææå¯¹è±¡ï¼</p>
<ul>
<li>è¦ä¹åªå±äºè¯¥ actorï¼å¨å¶å¯ä¸åºååé</li>
<li>è¦ä¹ä»å¶ä»åºåæçº¿ç¨ç§»å¨è¿æ¥</li>
<li>è¦ä¹æ¯å¦ä¸ä¸ª <code>SharedObject</code> æå¦ä¸ä¸ª actor</li>
</ul>
<p>Actor è¦ä¹æ¥æèªå·±çåºåï¼è¦ä¹åªç¨æ¾å¼å±äº«çä¸å¯åå¯¹è±¡ï¼å¦åç«æè¿æ¯ä¼æã</p>
<p>åå­ç®¡çå¨ä¿è¯ actor æ¹æ³åææåå­æä½èªå¨ç»å®å°ä¸ actor å³èçåºåã</p>
<p>æ¹æ³éè¿ <code>Scheduler</code> æå¡ç MPMC æ¶æ¯éåæ§è¡ã<code>Scheduler</code> å¨ actors é´åé CPU æ¶é´ï¼æä¾å¹¶ååå¹¶è¡æ§è¡ã</p>
<p><img alt="Actor åé¨" loading="lazy" data-src="https://image.catchadmin.com/202601060810207.png" class="lazyload"></p>
<h2 id="ç»è®º">ç»è®º</h2>
<p>è¿äºå¬çé½ä¸éï¼ä½ä»ä¹æ¶åè½çæ­£ç¨ä¸ï¼</p>
<p><code>Single-threaded + offload</code> æ¨¡åå¯è½å¾å¿«åºç°ï¼å¾å¤ç»ä»¶å·²ç»å°±ç»ªãTrueAsync åçº¿ç¨åç¨å·²å° beta çãå®éªæ§çå¤çº¿ç¨åå­ç®¡çå¨ååå»ºçº¿ç¨ç API å·²ç»å®ç°ã</p>
<p>Actors éè¦æ´å¤å¼åæ¶é´ï¼å ä¸ºæ¶å PHP æ ¸å¿å¾å¤é¨åï¼ä½ä»æ¯ PHP 9 çç°å®ç®æ ï¼ç»å¸åºæä¾ä¸ç§å®å¨çå¤çº¿ç¨ç¼ç¨è¯­è¨ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-07 07:12">2026-01-07 07:12</span>&nbsp;
<a href="https://www.cnblogs.com/catchadmin">JaguarJack</a>&nbsp;
éè¯»(<span id="post_view_count">15</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19450129);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19450129', targetLink: 'https://www.cnblogs.com/catchadmin/p/19450129', title: 'PHP å¼æ­¥ä¸å¤çº¿ç¨ ä» TrueAsync å±ææªæ¥' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬ä¸å¨ï¼å¾ªç¯ç¥ç»ç½ç» ï¼äºï¼å¾ªç¯ç¥ç»ç½ç» ]]></title>
    <link>https://www.cnblogs.com/Goblinscholar/p/19449622</link>
    <guid>0da244c276f569724c463ace69095fb9</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Goblinscholar/p/19449622" title="åå¸äº 2026-01-06 22:53">
    <span role="heading" aria-level="2">å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬ä¸å¨ï¼å¾ªç¯ç¥ç»ç½ç» ï¼äºï¼å¾ªç¯ç¥ç»ç½ç»</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æ­¤åç±»ç¨äºè®°å½å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨çå­¦ä¹ ç¬è®°ã<br>
è¯¾ç¨ç¸å³ä¿¡æ¯é¾æ¥å¦ä¸ï¼</p>
<ol>
<li>åè¯¾ç¨è§é¢é¾æ¥ï¼<a href="https://www.bilibili.com/video/BV1FT4y1E74V?buvid=XU762317353676D786954061C192FE625463B&amp;from_spmid=playlist.playlist-detail.0.0&amp;is_story_h5=false&amp;mid=zqernykrmpf7XfIorMR%2FnA%3D%3D&amp;plat_id=116&amp;share_from=ugc&amp;share_medium=android&amp;share_plat=android&amp;share_session_id=ce0bc526-db69-428a-962e-c65ed8c267bc&amp;share_source=COPY&amp;share_tag=s_i&amp;spmid=united.player-video-detail.0.0&amp;timestamp=1713085655&amp;unique_k=DfBgvFW&amp;up_id=8654113&amp;vd_source=e035e9878d32f414b4354b839a4c31a4" target="_blank" rel="noopener nofollow">[åè¯­å­å¹]å´æ©è¾¾æ·±åº¦å­¦ä¹ deeplearning.ai</a></li>
<li>githubè¯¾ç¨èµæï¼å«è¯¾ä»¶ä¸ç¬è®°:<a href="https://github.com/robbertliu/deeplearning.ai-andrewNG" target="_blank" rel="noopener nofollow">å´æ©è¾¾æ·±åº¦å­¦ä¹ æå­¦èµæ</a></li>
<li>è¯¾ç¨éå¥ç»ä¹ ï¼ä¸­è±ï¼ä¸ç­æ¡ï¼<a href="https://blog.csdn.net/u013733326/article/details/79827273" target="_blank" rel="noopener nofollow">å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾åä¹ é¢ä¸ç­æ¡</a></li>
</ol>
<p>æ¬ç¯ä¸ºç¬¬äºè¯¾çç¬¬ä¸å¨åå®¹ï¼<a href="https://www.bilibili.com/video/BV1FT4y1E74V?spm_id_from=333.788.videopod.episodes&amp;vd_source=e035e9878d32f414b4354b839a4c31a4&amp;p=152" target="_blank" rel="noopener nofollow">1.2</a>å°<a href="https://www.bilibili.com/video/BV1FT4y1E74V?spm_id_from=333.788.player.switch&amp;vd_source=e035e9878d32f414b4354b839a4c31a4&amp;p=154" target="_blank" rel="noopener nofollow">1.4</a>çåå®¹ã</p>
<hr>
<p>æ¬å¨ä¸ºç¬¬äºè¯¾çç¬¬ä¸å¨åå®¹ï¼ä¸ CV ç¸å¯¹åºçï¼è¿ä¸è¯¾ææåå®¹çä¸­å¿åªæä¸ä¸ªï¼<strong>èªç¶è¯­è¨å¤çï¼Natural Language Processingï¼NLPï¼</strong>ã<br>
åºç¨å¨æ·±åº¦å­¦ä¹ éï¼å®æ¯ä¸é¨ç¨æ¥è¿è¡<strong>ææ¬ä¸åºåä¿¡æ¯å»ºæ¨¡</strong>çæ¨¡ååææ¯ï¼æ¬è´¨ä¸æ¯å¨å¨è¿æ¥ç½ç»ä¸ç»è®¡è¯­è¨æ¨¡ååºç¡ä¸çä¸æ¬¡âç»æåç¹åâï¼ä¹æ¯äººå·¥æºè½ä¸­<strong>æè´´è¿äººç±»æç»´è¡¨è¾¾æ¹å¼</strong>çéè¦ç ç©¶æ¹åä¹ä¸ã<br>
<strong>è¿ä¸æ´èè¯¾åæ ·æ¶åå¤§ééè¦åå¤æ¶åçåå®¹ï¼æ¨ªè·¨æºå¨å­¦ä¹ ãæ¦çç»è®¡ãçº¿æ§ä»£æ°ä»¥åè¯­è¨å­¦ç´è§ã</strong><br>
è¯­è¨ä¸åå¾åé£æ ·âç´è§å¯è§âï¼æ´å¤æ¯æ½è±¡ç¬¦å·ä¸ä¸ä¸æå³ç³»çç»åï¼å æ­¤<strong>çè§£é¨æ§åèæ´é«</strong>ã<br>
å æ­¤ï¼æåæ ·ä¼å°½éè¡¥è¶³å¿è¦çèæ¯ç¥è¯ï¼å°½å¯è½ç¨æ¯å»åå®ä¾éä½çè§£é¾åº¦ã<br>
æ¬ç¯çåå®¹å³äº<strong>å¾ªç¯ç¥ç»ç½ç»</strong>ï¼å¨ NLP ä¸­ï¼å¾ªç¯ç¥ç»ç½ç»å°±åå·ç§¯ç½ç»å¨ CV ä¸­ä¸æ ·ï¼æ¯å¤çåºåæ°æ®çæ ¸å¿ç¹åæ¨¡åï¼ä¸é¨ç¨äºææä¸ä¸æä¾èµã</p>
<h1 id="1-nlp-ä¸­çç¬¦å·è§è">1. NLP ä¸­çç¬¦å·è§è</h1>
<p>å¨æ­£å¼å¼å§å¼å¥å¾ªç¯ç¥ç»ç½ç»åï¼æä»¬åæ ·éè¦åäºè§£ä¸äºç¸å³çç¬¦å·è§èï¼ä¸»è¦æ¯å¨æ°æ®çè¡¨ç¤ºæ¹é¢ã</p>
<h2 id="11-æ¨¡åçè¾å¥ä¸è¾åº">1.1 æ¨¡åçè¾å¥ä¸è¾åº</h2>
<p><img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260106225017927-302231808.png" alt="image.png" loading="lazy"><br>
åå¤è¿°ä¸ä¸ï¼</p>
<ol>
<li><span class="math inline">\(x^{&lt;t&gt;}\)</span> ï¼<strong>è¾å¥åºåå¨ç¬¬ <span class="math inline">\(t\)</span> ä¸ªæ¶é´æ­¥çè¾å¥</strong>ã</li>
<li><span class="math inline">\(y^{&lt;t&gt;}\)</span> ï¼<strong>è¾åºåºåå¨ç¬¬ <span class="math inline">\(t\)</span> ä¸ªæ¶é´æ­¥çè¾åº</strong>ã</li>
<li><span class="math inline">\(T_x\)</span>ï¼<strong>è¾å¥åºåçé¿åº¦</strong>ã</li>
<li><span class="math inline">\(T_y\)</span>ï¼<strong>è¾åºåºåçé¿åº¦</strong>ã</li>
</ol>
<p>ç°å¨ï¼ç»åæä»¬ä¹åçç¬¦å·è§èï¼å°±å¯ä»¥ç¥éï¼<br>
<strong><span class="math inline">\(X^{(n)&lt;t&gt;}\)</span> ä»£è¡¨ä¸æ¹æ¬¡è¾å¥ä¸­ç¬¬ <span class="math inline">\(n\)</span> ä¸ªæ ·æ¬çç¬¬ <span class="math inline">\(t\)</span> ä¸ªåç´ ã</strong></p>
<h2 id="12-è¯å¸vocabulary">1.2 è¯å¸ï¼Vocabularyï¼</h2>
<p>ç»è¿ä¸ä¸é¨åï¼æä»¬ç¥éï¼<span class="math inline">\(x^{&lt;t&gt;}\)</span> ä»£è¡¨äºä¸ä¸ªåºåä¸­çæä¸ä¸ªåç´ ã<br>
ä½æ¯åæä¸ä¸ªæ°çé®é¢ï¼å¨ NLP ä»»å¡ä¸­ï¼<span class="math inline">\(x^{&lt;t&gt;}\)</span> å¾å¾æ¯ä¸ä¸ª<strong>ç¦»æ£çç¬¦å·</strong>ï¼ä¾å¦æä¸ªå·ä½çè¯ï¼å¦ <em>hello</em>ã<em>Hi</em>ï¼ï¼èç¥ç»ç½ç»æ¬è´¨ä¸åªè½å¤ç<strong>æ°å¼åé</strong>ï¼å¹¶ä¸è½ç´æ¥çè§£âè¯âè¿ä¸æ½è±¡æ¦å¿µã</p>
<p>å æ­¤ï¼å¨å°ææ¬åºåéå¥æ¨¡åä¹åï¼æä»¬å¿é¡»åå®æä¸ä»¶äºæï¼ç»âè¯âä¸ä¸ªè½è¾å¥ç½ç»çè¡¨ç¤ºæ¹æ³ï¼<strong>å³å»ºç«ä¸ç§ä»âè¯âå°âæ°å¼è¡¨ç¤ºâçæ å°è§åã</strong><br>
æ¾ç¶ï¼è¿ç§æ å°å³ç³»å¿é¡»æ¯<strong>ç¡®å®ä¸å¯ä¸ç</strong>ï¼å³æ¯ä¸ä¸ªè¯é½å¯¹åºä¸ä¸ªå¯ä¸çæ°å¼è¡¨ç¤ºã<br>
è<strong>å¶ä¸­ä¸ç§</strong>è¡¨ç¤ºæ¹æ³ï¼å°±æ¯æä»¬å¨å¤åç±»æ ç­¾è¡¨ç¤ºä¸­ä½¿ç¨ç<strong>ç¬ç­ç¼ç </strong>ã<br>
æä»¬çä¸ä¸ªç®åçç¤ºä¾ï¼<br>
åè®¾æä»¬å½åç<strong>è¯å¸</strong>åªåå« 4 ä¸ªè¯ï¼</p>
<p></p><div class="math display">\[{\text{hello},\ \text{Hi},\ \text{thanks},\ \text{bye}}
\]</div><p></p><p>æä»¬å¯ä»¥ä¸ºè¯å¸ä¸­çæ¯ä¸ä¸ªè¯åéä¸ä¸ªå¯ä¸çç´¢å¼ï¼</p>
<p></p><div class="math display">\[\text{hello}\rightarrow 1,\quad \text{Hi}\rightarrow 2,\quad \text{thanks}\rightarrow 3,\quad \text{bye}\rightarrow 4
\]</div><p></p><p>å¨è¿ç§è®¾å®ä¸ï¼æ¯ä¸ä¸ªè¯é½å¯ä»¥ç¨ä¸ä¸ª<strong>é¿åº¦ä¸º 4 çç¬ç­åé</strong>æ¥è¡¨ç¤ºã<br>
ä¾å¦ï¼</p>
<ul>
<li><span class="math inline">\(\text{hello}\)</span> å¯¹åºçè¡¨ç¤ºä¸ºï¼<span class="math inline">\(x = [1,0,0,0]\)</span></li>
<li><span class="math inline">\(\text{Hi}\)</span> å¯¹åºçè¡¨ç¤ºä¸ºï¼<span class="math inline">\(x = [0,1,0,0]\)</span><br>
<strong>è¯å¸ä¸­çæ¯ä¸ªè¯é½æä¸ä»æä¸ä¸ªä½ç½®ä¸º 1ï¼å¶ä½ä½ç½®å¨é¨ä¸º 0ã</strong><br>
ä»æ¨¡åçè§åº¦æ¥çï¼è¿æ ·çè¡¨ç¤ºæ¹å¼æå³çï¼æ¨¡åå¨ä»»ææ¶å»æ¥æ¶å°çè¾å¥ï¼æ¬è´¨ä¸æ¯ä¸ä¸ªé«ç»´ç¨çåéï¼è¿æ­£å¥½æ»¡è¶³âè¯ â æ°å¼åéâçä¸å¯¹ä¸æ å°è¦æ±ï¼å æ­¤è½å¤ç´æ¥ä½ä¸ºç¥ç»ç½ç»çè¾å¥ã</li>
</ul>
<p>ç¶èï¼å¨çå®ç NLP ä»»å¡ä¸­ï¼ä¸ä¸ªä¸å¯å¿½è§çç°å®é®é¢æ¯ï¼<strong>è¯å¸çè§æ¨¡éå¸¸éå¸¸å·¨å¤§ã</strong><br>
å¨å¸¸è§çè¯­è¨å»ºæ¨¡æç¿»è¯ä»»å¡ä¸­ï¼è¯å¸å¤§å°å¾å¾è¾¾å°<strong>æ°ä¸çè³ç¾ä¸çº§å«</strong>ã<br>
è¿æå³çï¼</p>
<ul>
<li>ç¬ç­åéçç»´åº¦æé«</li>
<li>åéæåº¦ç¨ç</li>
<li>è®¡ç®åå­å¨ææ¬é½éå¸¸ä¸ç»æµ</li>
</ul>
<p>å æ­¤ï¼å¨å®éæ¨¡åä¸­ï¼æä»¬å¾å¾ä¼éç¨ä¸ç§æ´ç´§åãä¹æ´å·è¯­ä¹è¡¨è¾¾è½åçè¯è¡¨ç¤ºæ¹æ³ï¼å«å<strong>è¯åéï¼Embeddingï¼</strong> ï¼æä»¬ä¼å¨ä¹åçåå®¹è¯¦ç»å±å¼å®ã<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260106224853098-1209020991.png" alt="image.png" loading="lazy"><br>
æ­¤å¤ï¼è¿ä¼åºç°å¦ä¸ä¸ªé®é¢ï¼  <strong>æµè¯æå®éä½¿ç¨æ¶ï¼å¯è½ä¼éå°è¯å¸ä¸­ä»æªåºç°è¿çè¯ã</strong><br>
å¯¹äºè¿ç§<strong>ä¸å¨è¯å¸ä¸­çè¯ï¼Out-Of-Vocabularyï¼OOVï¼</strong>ï¼å¸¸è§çä¸ç§å¤çæ¹å¼æ¯å¨è¯å¸ä¸­é¢å¤å¼å¥ä¸ä¸ªç¹æ®æ è®°<code>&lt;UNK&gt;</code>ï¼ç¨äºç»ä¸è¡¨ç¤ºæææªç¥è¯ï¼è¿ç§æ¹å¼è½ç¶ç®åï¼ä½ä¹ä¼ä¸¢å¤±ä¸åæªç¥è¯ä¹é´çå·®å¼æ§ï¼è¿ä¹æ¯åç»­å­è¯å»ºæ¨¡æ¹æ³è¦è§£å³çé®é¢ä¹ä¸ã</p>
<p>è¿äºæä»¬é½ä¼å¨ä¹åçå®éæ¼ç¤ºä¸­è¯¦ç»å±å¼ï¼ç°å¨ï¼åäºè§£ç®åçç¬¦å·è§èåï¼æä»¬æ­£å¼å¼å§å¼å¥å¾ªç¯ç¥ç»ç½ç»ã</p>
<h1 id="2-å¾ªç¯ç¥ç»ç½ç»recurrent-neural-networkrnn">2. å¾ªç¯ç¥ç»ç½ç»ï¼Recurrent Neural Networkï¼RNNï¼</h1>
<p>å¨<a href="https://www.cnblogs.com/Goblinscholar/p/19437798" target="_blank">ä¸ä¸ç¯</a>å¯¹åºåæ¨¡åçä»ç»ä¸­ï¼æä»¬å·²ç»ç¥éï¼å¨è¿æ¥ç½ç»åå·ç§¯ç½ç»å¹¶ä¸éåç¨æ¥å¤çåºåæ°æ®ã<br>
æä»¬éè¦ä¸ç§æ¨¡åï¼<strong>å¨å¤çå½åè¾å¥çåæ¶ï¼è½å¤ä¿çå¹¶æ´æ°å¯¹âè¿å»ä¿¡æ¯âçè¡¨ç¤ºï¼è®©æ¨¡åå¨çè§£å½ååå®¹æ¶ï¼ä¸æ¯å­¤ç«å°âçè¿ä¸å»âï¼èæ¯åºäºæ´ä¸ªä¸ä¸ææ¥å¤æ­ã</strong><br>
èè¿ï¼å°±æ¯ RNN çåºæ¬ææ³ã<br>
RNNææ©å¯è¿½æº¯å° Jordanï¼1986ï¼å¯¹åºåè¿æ¥ä¸»ä¹æ¨¡åçç ç©¶ï¼èç°ä»£æ·±åº¦å­¦ä¹ ä¸­å¸¸ç¨ç RNN åºæ¬å½¢å¼ï¼åæ¥æºäº Elman å¨1990å¹´åè¡¨çä¸ç¯è®ºæï¼ <a href="https://langev.com/pdf/elman90findingStructure.pdf?" target="_blank" rel="noopener nofollow">Finding Structure in Time</a>ä¸­æåºçéå½ç¶æç½ç»ç»æã<br>
å¯ä»¥çå°ï¼å°½ç®¡è®ºæè·ä»å·²æå åå¹´ï¼ä½åæåç CNN ä¸æ ·ï¼RNN çææ³å¹¶æ²¡æè¢«æ¶é´æ·¹æ²¡ï¼èæ¯ä¸æ­è¢«æ¨å¹¿ååæ°ï¼æç»æä¸ºç°ä»£ NLP ä¸­ä¸å¯æç¼ºçåºç¡æ¨¡åã</p>
<p>ç°å¨ï¼æä»¬ç¨ä¸ä¸ªæç®åç<strong>åå±å¾ªç¯ç¥ç»ç½ç»</strong>æ¥ä»ç» RNN çä¼ æ­è¿ç¨åå¶ç¹ç¹ã</p>
<h2 id="21-åå±å¾ªç¯ç¥ç»ç½ç»çç»æ">2.1 åå±å¾ªç¯ç¥ç»ç½ç»çç»æ</h2>
<p>æ¥çè¯¾ç¨éè¿æ ·ä¸ä¸ªå¾ªç¯ç½ç»ç<strong>ä¼ æ­ç¤ºæå¾</strong>ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260106224834808-1322487049.png" alt="image.png" loading="lazy"><br>
ä½ å¯è½ä¼è§å¾ï¼è¿ä¸ªç»æçèµ·æ¥å¥½åä¸åä¼ ç»æä¹ä¸çâåå±ç½ç»âï¼åèæ´åæ¯ä¸å±é½ç´æ¥æ¥æ¶åå§è¾å¥çå¨è¿æ¥ç½ç»ã<br>
å¶å®è¿æ­£ä½ç°äº RNN ä¸ FN æ CNN çæ¬è´¨åºå«ï¼<strong>å¨ RNN ä¸­ï¼æ¯ä¸ªæ¶é´æ­¥çéèç¶æä¸ä¼ç´æ¥ä¼ ç»ä¸ä¸å±ï¼èæ¯ä¼ éç»ä¸ä¸ä¸ªæ¶é´æ­¥çèªèº«ã</strong><br>
ä¹å°±æ¯è¯´ï¼è¿ä¸ªç½ç»çå®éç»ææ¯è¿æ ·çï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260106224835295-122620775.png" alt="image.png" loading="lazy"><br>
ä¹å°±æ¯è¯´ï¼RNN æ¬è´¨ä¸å°±æ¯<strong>å¨å¨è¿æ¥å±åºç¡ä¸å äºæ¶é´ç»´åº¦çå¾ªç¯è¿æ¥</strong>ã<br>
ä½ ä¼åç°ï¼<strong>å¦ææå¼ä¼ æ­é»è¾ä¸çï¼åå±å¾ªç¯ç½ç»å®éä¸å°±æ¯ä¸å±å¨è¿æ¥å±ã</strong><br>
ä½è¿ä¹æ°æ°è¯´æäºå®çä¼ æ­é»è¾çéè¦æ§ï¼å°åºæ¯æä¹æ ·çè®¾è®¡è½è®©åå±çå¨è¿æ¥å±ä¸è·èæä¸º NLP çåºç³ï¼<br>
æä»¬ç»§ç»­ã</p>
<h2 id="22-åå±å¾ªç¯ç¥ç»ç½ç»çæ­£åä¼ æ­">2.2 åå±å¾ªç¯ç¥ç»ç½ç»çæ­£åä¼ æ­</h2>
<p>äºè§£äº RNN çåºæ¬é»è¾åï¼ ç°å¨ï¼æä»¬å°±æ¥æ¼ç¤ºä¸ä¸åå± RNN çå·ä½ä¼ æ­è¿ç¨ä¸­çä¸äºç»èï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260106224834545-1669402886.png" alt="image.png" loading="lazy"><br>
äºè§£äºè¿äºåï¼æä»¬è§èä¸ä¸åå± RNN çæ­£åä¼ æ­è¿ç¨ï¼</p>
<ol>
<li><strong>åå§ç¶æ</strong><br>
RNN å¨ç¬¬ä¸ä¸ªæ¶é´æ­¥è¾å¥ç¬¬ä¸ä¸ªåç´  <span class="math inline">\(x^{&lt;1&gt;}\)</span>ï¼ä¾å¦âé©âï¼æ¶ï¼åæ¶ä¼å¼å¥åå§çä¼ªæ¿æ´»å¼ (<span class="math inline">\(a^{&lt;0&gt;}\)</span>) ä½ä¸ºç½ç»çåå§ç¶æï¼<span class="math inline">\(a^{&lt;0&gt;}\)</span> éå¸¸è®¾ä¸ºé¶åéæéæºåå§åã</li>
<li><strong>éæ­¥å¤çåºå</strong><br>
æ¯ä¸ªæ¶é´æ­¥ï¼RNN ä¼å°å½åè¾å¥ <span class="math inline">\(x^{&lt;t&gt;}\)</span> ä¸ä¸ä¸æ¶é´æ­¥çéèç¶æ <span class="math inline">\(a^{&lt;t-1&gt;}\)</span> ä¸èµ·è¾å¥ç½ç»ï¼è®¡ç®å½åçéèç¶æ <span class="math inline">\(a^{&lt;t&gt;}\)</span>,ä¾å¦å¨ç¬¬äºæ­¥ï¼è¾å¥ä¸º <span class="math inline">\(x^{&lt;2&gt;}\)</span>ï¼âä¿¡âï¼å <span class="math inline">\(a^{&lt;1&gt;}\)</span>ï¼å¾å° <span class="math inline">\(a^{&lt;2&gt;}\)</span>ã</li>
<li><strong>è¾åºçæ</strong><br>
æ¯ä¸æ­¥çéèç¶æ <span class="math inline">\(a^{&lt;t&gt;}\)</span> é½ä¼äº§çä¸ä¸ªé¢æµè¾åº <span class="math inline">\(\hat{y}^{&lt;t&gt;}\)</span>ãè¾åºä¸ä»ä¾èµå½åè¾å¥ï¼ä¹åå«äºåé¢æ¶é´æ­¥çåå²ä¿¡æ¯ï¼è¿å°±æ¯ RNN è½å¤âè®°å¿âåºåä¸ä¸æçåå ã</li>
<li><strong>ä¿¡æ¯ä¼ é</strong><br>
éèç¶æä¼æ²¿æ¶é´æ­¥ååä¼ éï¼ä½¿åç»­æ¶é´æ­¥çè¾åºè½å¤å©ç¨ä¹åææçåºåä¿¡æ¯ï¼æç»ä¸æ­¥è¾åº <span class="math inline">\(\hat{y}^{&lt;T_x&gt;}\)</span> åå«æ´ä¸ªåºåçä¿¡æ¯ï¼å¯ç¨äºå®æ´åºåçé¢æµæå¤æ­ã</li>
</ol>
<p>æç½äºä¼ æ­é»è¾åï¼æä»¬ä¾¿å¯ä»¥æ´å¥½å°çè§£ RNN æ­£åä¼ æ­çå¬å¼è¡¨è¾¾ï¼æä»¬å<strong>è¯´æä¸ä¸ç½ç»ä¸­çåæ°è¡¨ç¤ºï¼</strong><br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260106225018168-1671840978.png" alt="image.png" loading="lazy"><br>
ç°å¨ä¾¿æåºæ­£åä¼ æ­çéå¼å¦ä¸ï¼</p>
<p></p><div class="math display">\[a^{&lt;t&gt;} = g(W_{aa} a^{&lt;t-1&gt;} + W_{ax} x^{&lt;t&gt;} + b_a)
\]</div><p></p><p></p><div class="math display">\[y^{&lt;t&gt;} = g(W_{ya} a^{&lt;t&gt;} + b_y)
\]</div><p></p><p>æ»ç»ä¸ä¸ï¼RNN çæ­£åä¼ æ­å°±æ¯<strong>æ¯ä¸ªæ¶é´æ­¥å°å½åè¾å¥åä¸ä¸éèç¶æç»åï¼æ´æ°å½åéèç¶æå¹¶çæè¾åºï¼éèç¶ææ²¿æ¶é´æ­¥ä¼ éï¼ä»èä½¿ç½ç»è½å¤éæ­¥ç´¯ç§¯åå©ç¨åºååå²ä¿¡æ¯</strong>ã</p>
<p>äºè§£äºæ­£åä¼ æ­çå¤§è´æµç¨åï¼æä»¬åçç RNN çååä¼ æ­æ¯å¦ä½è¿è¡çã</p>
<h2 id="23-åå±å¾ªç¯ç¥ç»ç½ç»çååä¼ æ­">2.3 åå±å¾ªç¯ç¥ç»ç½ç»çååä¼ æ­</h2>
<p>ç»è¿ä¸ä¸é¨åï¼æä»¬å·²ç»ç¥éï¼RNN çæ­£åä¼ æ­ï¼æ¬è´¨ä¸æ¯å¨<strong>æ¶é´ç»´åº¦ä¸åå¤ä½¿ç¨åä¸ç»åæ°</strong>ï¼å¹¶éè¿éèç¶ææåå²ä¿¡æ¯ååä¼ éã</p>
<p>é£ä¹é®é¢èªç¶å°±æ¥äºï¼  <strong>è¿äºè·¨æ¶é´æ­¥ä¼ éçä¿¡æ¯ï¼ååä¼ æ­æ¶è¯¥æä¹âç®æ¢¯åº¦âï¼</strong></p>
<p>ç­æ¡æ¯ï¼ æä¹è¿å»å°±æä¹åæ¥ââRNN çååä¼ æ­ï¼å¹¶ä¸æ¯å¨âå±âä¹é´ä¼ æ­ï¼èæ¯<strong>å¨æ¶é´ç»´åº¦ä¸ååä¼ æ­</strong>ï¼è¿ç§ä¼ æ­è¢«ç§°ä¸º <strong>BPTTï¼Backpropagation Through Timeï¼</strong> ã<br>
æä»¬æ¥ç®è¦æ¼ç¤ºä¸ä¸è¿ä¸ªè¿ç¨ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260106225121561-283647183.png" alt="image.png" loading="lazy"></p>
<p>å¨çç£å­¦ä¹ ä¸­ï¼ååä¼ æ­çèµ·ç¹æ°¸è¿æ¯<strong>æå¤±å½æ°</strong>ï¼å¯¹äº RNN æ¥è¯´ï¼æå¤±éå¸¸æ¯<strong>æææ¶é´æ­¥æå¤±çç´¯å </strong>ï¼é»è®¤ <span class="math inline">\(T_x = T_y\)</span>ï¼ï¼</p>
<p></p><div class="math display">\[\mathcal{L}
=
\sum_{t=1}^{T_x}
\mathcal{L}^{&lt;t&gt;}(\hat{y}^{&lt;t&gt;}, y^{&lt;t&gt;})
\]</div><p></p><p>ä¹å°±æ¯è¯´ï¼<strong>æ¯ä¸ä¸ªæ¶é´æ­¥çè¾åºé½ä¼å¯¹æ»æå¤±äº§çè´¡ç®</strong>ã<br>
èå¯¹äºåæ­¥çæå¤±ï¼æå¸¸ç¨çä»ç¶æ¯æä»¬æ¯è¾çæç<a href="https://www.cnblogs.com/Goblinscholar/p/19133349" target="_blank">äº¤åçµæå¤±</a>,ä½ å¯ä»¥éè¿é¾æ¥æ¥çæä»¬ä¹åçä»ç»ï¼åºç¨å¨ RNN ä¸­ï¼å®çå¬å¼æ¯è¿æ ·çï¼</p>
<p></p><div class="math display">\[\mathcal{L}
=
\sum_{t=1}^{T_x}
\left(
- \sum_{k=1}^{C} y_k^{&lt;t&gt;} \log \hat{y}_k^{&lt;t&gt;}
\right)
\]</div><p></p><p>å æ­¤ï¼ååä¼ æ­æ¶ï¼æä»¬ä¼ä»æåä¸ä¸ªæ¶é´æ­¥å¼å§ï¼éæ­¥ååï¼ææ¯ä¸ªæ¶é´æ­¥çè¯¯å·®ä¿¡å·å¾åä¼ ï¼ ç±äºåæ°å¨æææ¶é´æ­¥å±äº«ï¼æ¯ä¸ªæ¶é´æ­¥çæå¤±é½ä¼éè¿æ¶é´é¾è·¯å¯¹è¿äºåæ°äº§çæ¢¯åº¦è´¡ç®ï¼æç»ç¨äºæ´æ°çæ¢¯åº¦ï¼æ¯<strong>æ²¿æ¶é´ç»´åº¦ååä¼ æ­åï¼åæ¶é´æ­¥è´¡ç®çç»¼åç»æ</strong>ã</p>
<p>è¿å°±æ¯åå±å¾ªç¯ç¥ç»ç½ç»çååä¼ æ­ï¼è¿æ ·æä»¬å°±å¯¹ RNN çåºæ¬è¿è¡é»è¾æäºå¤§ä½çäºè§£ã</p>
<h1 id="3æ»ç»">3.æ»ç»</h1>
<table>
<thead>
<tr>
<th>æ¦å¿µ</th>
<th>åç</th>
<th>æ¯å»</th>
</tr>
</thead>
<tbody>
<tr>
<td>åºåæ°æ®</td>
<td>æ°æ®åç´ å·æ<strong>æç¡®é¡ºåº</strong>ï¼å½åçè§£ä¾èµåå²ä¸ä¸æ</td>
<td>ä¸å¥è¯çææè¦ä»åå¾åè¯»ï¼ä¸è½åªçä¸­é´ä¸ä¸ªè¯ã</td>
</tr>
<tr>
<td>æ¶é´æ­¥ <span class="math inline">\(t\)</span></td>
<td>åºåä¸­ç¬¬ <span class="math inline">\(t\)</span> ä¸ªä½ç½®ï¼ç¨äºå±å¼æ¶é´ç»´åº¦</td>
<td>æ¶é´è½´ä¸çç¬¬ <span class="math inline">\(t\)</span> å¸§ç»é¢ã</td>
</tr>
<tr>
<td>è¾å¥ <span class="math inline">\(x^{}\)</span></td>
<td>ç¬¬ <span class="math inline">\(t\)</span> ä¸ªæ¶é´æ­¥éå¥æ¨¡åçè¾å¥åé</td>
<td>å½åè¿ä¸ç§ä½ å¬å°çä¸ä¸ªè¯ã</td>
</tr>
<tr>
<td>é¢æµè¾åº <span class="math inline">\(\hat{y}^{}\)</span></td>
<td>æ¨¡åå¨ç¬¬ <span class="math inline">\(t\)</span> ä¸ªæ¶é´æ­¥ç»åºçé¢æµç»æ</td>
<td>å¬å°ä¸å¥è¯åï¼æ­¤å»ä½ ååºçå¤æ­ã</td>
</tr>
<tr>
<td>åºåé¿åº¦ <span class="math inline">\(T_x, T_y\)</span></td>
<td>è¾å¥åºåä¸è¾åºåºåçé¿åº¦ï¼å¯ç¸åæä¸åï¼</td>
<td>ä¸æ®µè¯çå­æ° vs ä½ åç­æ¶è¯´äºå å¥è¯ã</td>
</tr>
<tr>
<td>è¯å¸ï¼Vocabularyï¼</td>
<td>ä»è¯å°ç´¢å¼ç<strong>ä¸ä¸æ å°è¡¨</strong></td>
<td>çµè¯ç°¿ï¼åå­ â çµè¯å·ç </td>
</tr>
<tr>
<td>RNN æ ¸å¿ææ³</td>
<td>å½åç¶æç±<strong>å½åè¾å¥ + è¿å»ç¶æ</strong>å±åå³å®</td>
<td>ä½ çè§£ä¸å¥è¯æ¶ï¼ä¼ä¸æ­ä¿®æ­£ä¹åççè§£ã</td>
</tr>
<tr>
<td>BPTT</td>
<td>æ¢¯åº¦æ²¿æ¶é´ç»´åº¦ååä¼ æ­</td>
<td>ä»å¥å°¾ååå»åæï¼æ¯åªä¸æ­¥çè§£éäºã</td>
</tr>
<tr>
<td>æ¢¯åº¦ç´¯ç§¯</td>
<td>åæ°æ¢¯åº¦æ¥èªæææ¶é´æ­¥çç»¼åè´¡ç®</td>
<td>æ¯ä¸å¥è¯çéè¯¯é½ä¼å½±åä½ ä¸æ¬¡ççè§£æ¹å¼ã</td>
</tr>
</tbody>
</table>
<p>ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.0020833333333333333" data-date-updated="2026-01-06 22:56">2026-01-06 22:53</span>&nbsp;
<a href="https://www.cnblogs.com/Goblinscholar">å¥å¸æå­¦è</a>&nbsp;
éè¯»(<span id="post_view_count">30</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19449622);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19449622', targetLink: 'https://www.cnblogs.com/Goblinscholar/p/19449622', title: 'å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬ä¸å¨ï¼å¾ªç¯ç¥ç»ç½ç» ï¼äºï¼å¾ªç¯ç¥ç»ç½ç»' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å¤§éè³ç®ï¼å¦ä½ç¨æè½»éçä»£ç å®ç°è·¨å¢éçå¾®æå¡å¥çº¦ï¼ ]]></title>
    <link>https://www.cnblogs.com/jieky/p/19449427</link>
    <guid>c40fdcb99391f52722e7fd529c401ca1</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/jieky/p/19449427" title="åå¸äº 2026-01-06 21:27">
    <span role="heading" aria-level="2">å¤§éè³ç®ï¼å¦ä½ç¨æè½»éçä»£ç å®ç°è·¨å¢éçå¾®æå¡å¥çº¦ï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="å¤§éè³ç®å¦ä½ç¨æè½»éçä»£ç å®ç°è·¨å¢éçå¾®æå¡å¥çº¦">å¤§éè³ç®ï¼å¦ä½ç¨æè½»éçä»£ç å®ç°è·¨å¢éçå¾®æå¡å¥çº¦ï¼</h1>
<h3 id="1-äºåå¹´çæ¶æé¿å¾ä»å æ³å°åæ³">1. äºåå¹´çæ¶æé¿å¾ï¼ä»å æ³å°åæ³</h3>
<p>åé¦æçèä¸çæ¶¯ï¼æä¸ä¸ªæ¶é´åæ è®©æå°è±¡æ·±å»ï¼</p>
<ul>
<li><strong>2006 å¹´ï¼</strong> èº«è¾¹åäºå¼å§è°è®º DDDï¼é¢åé©±å¨è®¾è®¡ï¼åé©¬ä¸Â·ç¦åçãä¼ä¸åºç¨æ¶ææ¨¡å¼ããé£æ¯<strong>æ±ç¥</strong>çå¹´ä»£ï¼æä»¬è¯å¾éè¿å¢å æ¨¡å¼çå¤æåº¦æ¥é©¯æä»£ç çæ··ä¹±ã</li>
<li><strong>2016 å¹´ï¼</strong> å¾®æå¡æµªæ½®è¢­æ¥ï¼æå¼å¥äº <strong>ABP æ¡æ¶</strong>ãé£æ¯<strong>å·¥å·</strong>çå¹´ä»£ï¼éåæ¡æ¶æä¾äºå¼ç®±å³ç¨çåè½ï¼ä½ä¹å¸¦æ¥äºä¸å¯å¿½è§çä¾èµè´æåâå¨å®¶æ¡¶âå¼çæç¼ã</li>
<li><strong>2026 å¹´ï¼</strong> ç«å¨å³å° 45 å²çæ¶é´ç¹ï¼æåä¸äº <strong>NexusContract</strong>ãè¿æ¯<strong>åå½+AI</strong>çå¹´ä»£ãå¨è§è¿äºæ æ°è¿åº¦è®¾è®¡çç²æ«åï¼ææç½äºä¸ä¸ªéçï¼<strong>æ¶æçå°ä¸¥å¨äºè¾¹ççæ¸æ°ï¼èéåè½çå ç ã</strong></li>
</ul>
<h3 id="2-ç°ç¶ä¹çè¢«éåå·¥å·ç»æ¶çå¥çº¦">2. ç°ç¶ä¹çï¼è¢«âéåå·¥å·âç»æ¶çå¥çº¦</h3>
<p>å¨æ¯ä»å¯¹è´¦ãç¬¬ä¸æ¹éæï¼å¦é¶èãæ¯ä»å®ï¼è¿ç§å¸åçå¼æåºæ¯ä¸­ï¼æä»¬ç»å¸¸é·å¥ä»¥ä¸æ³¥æ½­ï¼</p>
<ul>
<li><strong>å¼ºè¦åç SDKï¼</strong> ä¸ºäºç¨ä¸ä¸ªæ¥å£ï¼ä¸å¾ä¸æä¸ä¸æ´å¥ä¸å¡é»è¾ SDKï¼éé¢çè³åå«æ°æ®åºä¾èµã</li>
<li><strong>éå¼é­æ³ï¼</strong> é è¿è¡æ¶æ¨æ­ãå¨å±åå°åç¡¬ç¼ç æ¥çæµå­æ®µåï¼ä¸æ¦ä¸æ¸¸åè®®åæ´ï¼æ´ä¸ªç³»ç»ç¬é´å´©æºã</li>
<li><strong>æ²éææ¬ï¼</strong> ä¸åå¢éä¹é´å¯ä¸çâå¥çº¦âææ¡£ç«æ¯åå¹´åç Markdown æªå¾ï¼ç¼ºä¹å¼ºç±»åçº¦æã</li>
</ul>
<h3 id="3-nexuscontract-çåæ ¸repr-p-æ¨¡å¼">3. NexusContract çåæ ¸ï¼REPR-P æ¨¡å¼</h3>
<p>æä»¬æ©å±äº <a href="https://fast-endpoints.com/" target="_blank" rel="noopener nofollow">FastEndpoints</a> å¡å¯¼ç <strong>REPR (Request-Endpoint-Response)</strong> æ¨¡å¼ï¼éè¿ <strong>Proxying (ä»£çå)</strong> æºå¶å®ç°äºé»è¾ä¸åè®®çå½»åºè§£è¦ã</p>
<p><strong>æ ¸å¿å®ªæ³ï¼æ¾å¼è¾¹çä¼äºéå¼é­æ³ã</strong><br>
å¨ NexusContract ä¸­ï¼å¥çº¦ï¼Contractï¼æ¯ä¸å¯åçè¯­ä¹åæ ¸ï¼æ¯å¢éé´å¯ä¸çæ³å¾ã</p>
<h3 id="4-æ ¸å¿å®ç°å¨å¯å¨é¶æ®µå·å»åæ°æ®">4. æ ¸å¿å®ç°ï¼å¨å¯å¨é¶æ®µâå·å»âåæ°æ®</h3>
<p>ä¸ºäºè¿½æ±æè´çæ§è½ï¼æä¸ºæ¡æ¶å¶å®äºä¸¤ä¸ªä¸¥èçææ¯å³ç­ï¼</p>
<h4 id="a-åæ°æ®å·å»-frozen-metadata">A. åæ°æ®å·å» (Frozen Metadata)</h4>
<p>æä»¬æç»è¿è¡æ¶åå°ãææçåæ°æ®æåãçº¦æå®¡è®¡é½å¨å¯å¨é¶æ®µå®æå¹¶ç¼å­ãå¯å¨å®æåï¼ç»æå­å¥ä¸å¯åç <code>ReflectionCache</code>ã</p>
<ul>
<li><strong>è¿è¡æï¼</strong> O(1) æ¥è¯¢ï¼é¶åå°å¼éã</li>
<li><strong>ç¡®å®æ§ï¼</strong> ç¡®ä¿ P50 ä¸ P99 æ²çº¿é«åº¦éåï¼æ¶é¤äº GC å¯¼è´çæ³¢å¨ã</li>
</ul>
<h4 id="b-é¢ç¼è¯æå½±-expression-tree">B. é¢ç¼è¯æå½± (Expression Tree)</h4>
<p>æä»¬å©ç¨ <strong>Expression Treeï¼è¡¨è¾¾å¼æ ï¼</strong> å°å¯¹è±¡çæ å°é»è¾é¢ç¼è¯ä¸º IL ä»£ç ãç¸æ¯è¿è¡æ¶åå°éåï¼æä»¬å°æä»¤æ¶èåå°äºæ°åï¼æ§è½ç­åäºç¡¬ç¼ç æ å°ã</p>
<h3 id="5-æ¶æçº¢çº¿ç¨-nxc-è¯æ­ç æå«ç¡®å®æ§">5. æ¶æçº¢çº¿ï¼ç¨ NXC è¯æ­ç æå«ç¡®å®æ§</h3>
<p>æä»¬ä¸æåºå«ä¹æ¨¡ç³çå¼å¸¸ï¼æ¯ä¸å¤å¤±æé½æå¶å¯ä¸ç´¢å¼ã</p>
<ul>
<li><strong>NXC1xx (éæçº¢çº¿)</strong>ï¼æ¶æè¿è§ãä¾å¦ <strong>ãå³ç­ A-401ã</strong> å¼ºå¶è¦æ±æå¤§åµå¥æ·±åº¦ â¤ 3ãè®¾è®¡å¤ªå¤æï¼ç³»ç»å°æç»å¯å¨ã</li>
<li><strong>NXC2xx/3xx (è¿è¡è¯æ­)</strong>ï¼ç²¾ç¡®éå®åºåæ¥æä¸åè§æå¥ååè®®å¯¹é½å¤±è´¥ã</li>
</ul>
<h3 id="6-ä»£ç å±ç¤ºåå½çº¯ç²¹ç-poco">6. ä»£ç å±ç¤ºï¼åå½çº¯ç²¹ç POCO</h3>
<pre><code class="language-csharp">/// &lt;summary&gt;
/// ç»ä¸ä¸åå¥çº¦ï¼çº¯åãå¼ºç±»åãæ¾å¼è¾¹ç
/// &lt;/summary&gt;
[ApiOperation("payment.order.create", HttpVerb.POST)]
public class OrderRequest : IApiRequest&lt;OrderResponse&gt;
{
    [ApiField("mer_order_no", IsRequired = true)]
    public string OrderNo { get; set; }

    [ApiField("card_no", IsEncrypted = true)] // è§¦åãè§å R-201ãéªè¯ï¼å¿é¡»æ¾å¼éå®åç§°
    public string CardNo { get; set; }

    [ApiField("txn_amt")]
    public long Amount { get; set; }
}

</code></pre>
<h3 id="7-ç»è¯­">7. ç»è¯­</h3>
<p>å¨è½¯ä»¶æ¶æçä¸çéï¼æä»¬æ»æ¯ä¹ æ¯äºåå æ³ï¼è®¤ä¸ºåè½è¶å¤è¶å¼ºå¤§ãä½çæ­£çå·¥ä¸çº§ä½åï¼å¾å¾æ¢äºå¨å³é®æ¶å»åä¸æ¥ååæ³ã</p>
<p><strong>å¨ç½ç»å»¶è¿ç 3 ç§é»æä¸­ï¼æä»¬è¦è®©åé¨å¤çç 50 å¾®ç§éªèå¾åææã</strong></p>
<h3 id="ï¸-é¡¹ç®å°åä¸æºç ">ðï¸ é¡¹ç®å°åä¸æºç </h3>
<p>æ¬é¡¹ç®å·²æ­£å¼å¼æºï¼æ¬¢è¿åä½åè¡ææ­£ãäº¤æµï¼</p>
<ul>
<li><strong>GitHub:</strong> <a href="https://github.com/NexusContract/PubSoft.NexusContract" target="_blank" rel="noopener nofollow">NexusContract</a></li>
<li><strong>æ ¸å¿çå¿µï¼</strong> Kernelized Contract Integration (KCI) Framework</li>
<li><strong>éç¨åºæ¯ï¼</strong> é«æ§è½æ¯ä»éæãè·¨å¢éå¾®æå¡å¥çº¦ç®¡çãå¼æåè®®éæè½¬æ¢ã</li>
</ul>
<hr>
<p><strong>å³äºä½èï¼</strong><br>
ä¸åå¨ .NET éµè¥æ½è¡ 20 å¹´çæ¶æå¸ï¼ä» .NET Framework 1.1 å°ä»å¤©ç .NET 10ï¼ä¾ç¶å¯¹å¹²åçä»£ç ä¿æç­ç±ã</p>

</div>
<div id="MySignature" role="contentinfo">
    <p>______________________________________<br>çæ´»ï¼è¦ç¨å£äººçè¸æé¢å¯¹ï¼ç¨ç§å­¦çæ¹æ³æ¯éï¼ <br>&nbsp; &nbsp; &nbsp; &nbsp; ç¨çå¸çå¾¡è³å»èï¼ç¨æ¸æ´çç©ºæ°æ´èºï¼ <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ç¨å°çªçæè§å»ç¡ï¼ç¨å¤ªé³çç­æçæ°´ã<br>______________________________________</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-06 21:27">2026-01-06 21:27</span>&nbsp;
<a href="https://www.cnblogs.com/jieky">æ¶å¤±è</a>&nbsp;
éè¯»(<span id="post_view_count">71</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19449427);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19449427', targetLink: 'https://www.cnblogs.com/jieky/p/19449427', title: 'å¤§éè³ç®ï¼å¦ä½ç¨æè½»éçä»£ç å®ç°è·¨å¢éçå¾®æå¡å¥çº¦ï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ AUC çä¸¤ç§ç­ä»·å®ä¹ï¼ä»æåºæ¦çå° ROC æ²çº¿çç»ä¸çè§£ ]]></title>
    <link>https://www.cnblogs.com/GlenTt/p/19449279</link>
    <guid>b28e2a1591ded509937d2cd5a50e4516</guid>
    <description>
    <![CDATA[ 
		<h2>
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/GlenTt/p/19449279" title="åå¸äº 2026-01-06 20:27">
    <span role="heading" aria-level="2">AUC çä¸¤ç§ç­ä»·å®ä¹ï¼ä»æåºæ¦çå° ROC æ²çº¿çç»ä¸çè§£</span>
    

</a>

		</h2>
		<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="auc-çä¸¤ç§ç­ä»·å®ä¹ä»æåºæ¦çå°-roc-æ²çº¿çç»ä¸çè§£">AUC çä¸¤ç§ç­ä»·å®ä¹ï¼ä»æåºæ¦çå° ROC æ²çº¿çç»ä¸çè§£</h1>
<p>å¨æ¨èç³»ç»ä¸å¹¿åæåºä¸­ï¼AUC æ¯æå¸¸ç¨ãä¹æå®¹æè¢«è¯¯è§£çç¦»çº¿è¯ä¼°ææ ä¹ä¸ãå¾å¤äººåæ¶æ¥è§¦è¿ä¸¤ç§è¯´æ³ï¼<br>
ä¸ç§æ¯âROC æ²çº¿ä¸é¢ç§¯âï¼å¦ä¸ç§æ¯âæ­£æ ·æ¬æå¨è´æ ·æ¬åé¢çæ¦çâã<strong>è¿å¹¶ä¸æ¯ä¸¤ç§ä¸åçææ ï¼èæ¯åä¸ä¸ªææ çä¸¤ç§å®å¨ç­ä»·çå®ä¹</strong>ã</p>
<h2 id="ä¸auc-çæ¬è´¨ä¸ä¸ªæåºæ¦ç">ä¸ãAUC çæ¬è´¨ï¼ä¸ä¸ªæåºæ¦ç</h2>
<h3 id="1-é®é¢è®¾å®">1. é®é¢è®¾å®</h3>
<p>åè®¾æä»¬é¢å¯¹çæ¯ä¸ä¸ªäºåç±» / æåºé®é¢ï¼</p>
<ul>
<li>æ¯ä¸ªæ ·æ¬ <span class="math inline">\(x_i\)</span> æçå®æ ç­¾ <span class="math inline">\(y_i \in {0,1}\)</span></li>
<li>æ¨¡åç»åºä¸ä¸ªè¿ç»­é¢æµåæ° <span class="math inline">\(s_i \in \mathbb{R}\)</span></li>
<li>åæ°è¶å¤§ï¼æ¨¡åè®¤ä¸ºæ ·æ¬âè¶å¯è½æ¯æ­£æ ·æ¬â</li>
</ul>
<p>å®ä¹ï¼</p>
<ul>
<li>æ­£æ ·æ¬éå<p></p><div class="math display">\[P = { i \mid y_i = 1 }
\]</div><p></p></li>
<li>è´æ ·æ¬éå<p></p><div class="math display">\[N = { j \mid y_j = 0 }
\]</div><p></p></li>
</ul>
<h3 id="2-auc-çæ¦çå®ä¹ææ¬è´¨å®ä¹">2. AUC çæ¦çå®ä¹ï¼ææ¬è´¨å®ä¹ï¼</h3>
<p><strong>AUC çæ¦çå®ä¹æ¯ï¼</strong></p>
<p>ä»æ­£æ ·æ¬éåä¸­éæºæ½åä¸ä¸ªæ ·æ¬ï¼ä»è´æ ·æ¬éåä¸­éæºæ½åä¸ä¸ªæ ·æ¬ï¼<br>
æ­£æ ·æ¬çé¢æµåæ°å¤§äºè´æ ·æ¬é¢æµåæ°çæ¦çã</p>
<p>å¶æ°å­¦å½¢å¼ä¸ºï¼</p>
<p></p><div class="math display">\[\mathrm{AUC}
=

\frac{1}{|P|\cdot|N|}
\sum_{p \in P}\sum_{n \in N}
\left[
\mathbb{I}(s_p &gt; s_n)
+
\frac{1}{2}\mathbb{I}(s_p = s_n)
\right]
\]</div><p></p><p>å¶ä¸­ï¼</p>
<ul>
<li><span class="math inline">\(\mathbb{I}(\cdot)\)</span> ä¸ºæç¤ºå½æ°</li>
<li>å½ <span class="math inline">\(s_p = s_n\)</span> æ¶è®°ä¸º <span class="math inline">\(0.5\)</span>ï¼è¡¨ç¤ºéæºæå¹³</li>
</ul>
<h3 id="3-è¿ä¸ç¹æå³çä»ä¹">3. è¿ä¸ç¹æå³çä»ä¹ï¼</h3>
<ul>
<li>AUC <strong>ä¸ä¾èµä»»ä½éå¼</strong></li>
<li>AUC <strong>ä¸æ¯ä¸ä¸ªåç±»ææ ï¼èæ¯ä¸ä¸ªæåºææ </strong></li>
<li>AUC è¡¡éçæ¯ï¼<br>
<strong>æ¨¡åæ¯å¦å¾åäºææ­£æ ·æ¬æ´ä½æå¨è´æ ·æ¬åé¢</strong></li>
</ul>
<p>è¿ä¹æ¯ä¸ºä»ä¹å¨æ¨èç³»ç»ä¸­ï¼å³ä¾¿æç»æ²¡ææç¡®çâæ­£è´åç±»å³ç­âï¼AUC ä¾ç¶æ¯ææ ¸å¿çç¦»çº¿è¯ä¼°ææ ä¹ä¸ã</p>
<h2 id="äºroc-æ²çº¿å®ä¹å ä½è§è§ä¸çåä¸ä¸ªé">äºãROC æ²çº¿å®ä¹ï¼å ä½è§è§ä¸çåä¸ä¸ªé</h2>
<h3 id="1-roc-æ²çº¿å¦ä½æé ">1. ROC æ²çº¿å¦ä½æé </h3>
<p>ç»å®ä¸ç»é¢æµåæ° <span class="math inline">\(s_i\)</span>ï¼æä»¬å¼å¥ä¸ä¸ªéå¼ <span class="math inline">\(\tau\)</span>ï¼</p>
<ul>
<li>è¥ <span class="math inline">\(s_i \ge \tau\)</span>ï¼é¢æµä¸ºæ­£ç±»</li>
<li>è¥ <span class="math inline">\(s_i &lt; \tau\)</span>ï¼é¢æµä¸ºè´ç±»</li>
</ul>
<p>å¨æ¯ä¸ä¸ªéå¼ <span class="math inline">\(\tau\)</span> ä¸ï¼å¯ä»¥è®¡ç®ï¼</p>
<ul>
<li>çé³æ§çï¼TPRï¼<p></p><div class="math display">\[\mathrm{TPR}(\tau)
=

\frac{\mathrm{TP}}{\mathrm{P}}
\]</div><p></p></li>
<li>åé³æ§çï¼FPRï¼<p></p><div class="math display">\[\mathrm{FPR}(\tau)
=

\frac{\mathrm{FP}}{\mathrm{N}}
\]</div><p></p></li>
</ul>
<p>å½éå¼ <span class="math inline">\(\tau\)</span> ä» <span class="math inline">\(+\infty\)</span> è¿ç»­ä¸éå° <span class="math inline">\(-\infty\)</span> æ¶ï¼<br>
ç¹å¯¹ <span class="math inline">\((\mathrm{FPR}(\tau), \mathrm{TPR}(\tau))\)</span> å¨å¹³é¢ä¸å½¢æä¸æ¡æ²çº¿ï¼å³ <strong>ROC æ²çº¿</strong>ã</p>
<h3 id="2-auc-ç-roc-å®ä¹">2. AUC ç ROC å®ä¹</h3>
<p><strong>AUC å®ä¹ä¸º ROC æ²çº¿ä¸æ¹çé¢ç§¯ï¼</strong></p>
<p></p><div class="math display">\[\mathrm{AUC}
=

\int_0^1 \mathrm{TPR}(\mathrm{FPR}) , d(\mathrm{FPR})
\]</div><p></p><p>è¿æ¯ä¸ä¸ª<strong>å ä½æä¹ä¸çå®ä¹</strong>ã</p>
<h2 id="ä¸ä¸¤ç§å®ä¹ä¸ºä»ä¹æ¯å®å¨ç­ä»·ç">ä¸ãä¸¤ç§å®ä¹ä¸ºä»ä¹æ¯å®å¨ç­ä»·çï¼</h2>
<p>ä¸ä¸ªç»è®¡å­¦ä¹ ä¸­çç»å¸ç»è®ºæ¯ï¼</p>
<p></p><div class="math display">\[\boxed{
\mathrm{AUC}
=

P(s^+ &gt; s^-)
}
\]</div><p></p><p>å¶ä¸­ <span class="math inline">\(s^+\)</span> è¡¨ç¤ºæ­£æ ·æ¬åæ°ï¼<span class="math inline">\(s^-\)</span> è¡¨ç¤ºè´æ ·æ¬åæ°ã</p>
<p>ç´è§è§£éå¦ä¸ï¼</p>
<ul>
<li>ROC æ²çº¿æ¬è´¨æ¯å¨ <strong>æç§ score ä»é«å°ä½æ«ææåºç»æ</strong></li>
<li>æ¯éå°ä¸ä¸ªæ­£æ ·æ¬ï¼TPR å¢å </li>
<li>æ¯éå°ä¸ä¸ªè´æ ·æ¬ï¼FPR å¢å </li>
<li>æä¸ªæ­£æ ·æ¬æ¯å¦âæ©äºâè´æ ·æ¬è¢«æ«æå°ï¼æ­£å¯¹åºäº<p></p><div class="math display">\[s^+ &gt; s^-
\]</div><p></p></li>
</ul>
<p>å æ­¤ï¼</p>
<blockquote>
<p><strong>ROC æ²çº¿ä¸é¢ç§¯ï¼ç­ä»·äºæææ­£è´æ ·æ¬å¯¹ä¸­ï¼æåºæ­£ç¡®çæ¯ä¾ã</strong></p>
</blockquote>
<p>ROC åªæ¯å°âæåºå³ç³»âç¨å ä½æ¹å¼è¿è¡äºè¡¨è¾¾ã</p>
<h2 id="åä¸ä¸ªå®æ´å¯æç®çä¾å­">åãä¸ä¸ªå®æ´ãå¯æç®çä¾å­</h2>
<h3 id="1-æ ·æ¬ä¸é¢æµåæ°">1. æ ·æ¬ä¸é¢æµåæ°</h3>
<table>
<thead>
<tr>
<th>æ ·æ¬</th>
<th>label</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>1</td>
<td>0.90</td>
</tr>
<tr>
<td>B</td>
<td>1</td>
<td>0.60</td>
</tr>
<tr>
<td>C</td>
<td>0</td>
<td>0.70</td>
</tr>
<tr>
<td>D</td>
<td>0</td>
<td>0.40</td>
</tr>
<tr>
<td>E</td>
<td>0</td>
<td>0.20</td>
</tr>
</tbody>
</table>
<ul>
<li>æ­£æ ·æ¬ï¼A, B</li>
<li>è´æ ·æ¬ï¼C, D, E</li>
<li>æ­£è´æ ·æ¬å¯¹æ»æ°ï¼<span class="math inline">\(2 \times 3 = 6\)</span></li>
</ul>
<hr>
<h3 id="2-ææ¦çå®ä¹éå¯¹æ¯è¾">2. ææ¦çå®ä¹éå¯¹æ¯è¾</h3>
<table>
<thead>
<tr>
<th>æ­£æ ·æ¬</th>
<th>è´æ ·æ¬</th>
<th>æ¯å¦æåºæ­£ç¡®</th>
</tr>
</thead>
<tbody>
<tr>
<td>A(0.90)</td>
<td>C(0.70)</td>
<td>â</td>
</tr>
<tr>
<td>A(0.90)</td>
<td>D(0.40)</td>
<td>â</td>
</tr>
<tr>
<td>A(0.90)</td>
<td>E(0.20)</td>
<td>â</td>
</tr>
<tr>
<td>B(0.60)</td>
<td>C(0.70)</td>
<td>â</td>
</tr>
<tr>
<td>B(0.60)</td>
<td>D(0.40)</td>
<td>â</td>
</tr>
<tr>
<td>B(0.60)</td>
<td>E(0.20)</td>
<td>â</td>
</tr>
</tbody>
</table>
<ul>
<li>æåºæ­£ç¡®å¯¹æ°ï¼5</li>
<li>æ»å¯¹æ°ï¼6</li>
</ul>
<p></p><div class="math display">\[\mathrm{AUC} = \frac{5}{6} \approx 0.833
\]</div><p></p><h2 id="äºå¯¹åºçè®¡ç®ä»£ç ">äºãå¯¹åºçè®¡ç®ä»£ç </h2>
<p>ä¸é¢ç»åºä¸¤ç§ AUC è®¡ç®å®ç°ã</p>
<h3 id="1-æ¦çå®ä¹ä¸¤ä¸¤æ¯è¾å®ä¹ç´è¯">1. æ¦çå®ä¹ï¼ä¸¤ä¸¤æ¯è¾ï¼å®ä¹ç´è¯ï¼</h3>
<pre><code class="language-python">def auc_pairwise(labels, scores):
    """
    åºäº AUC çæ¦çå®ä¹ï¼Pairwise Comparisonï¼è¿è¡è®¡ç®ã

    è¾å¥ï¼
    - labels: List[int] æ 1D array
        æ ·æ¬çå®æ ç­¾ï¼åå¼ä¸º {0, 1}
        1 è¡¨ç¤ºæ­£æ ·æ¬ï¼0 è¡¨ç¤ºè´æ ·æ¬
    - scores: List[float] æ 1D array
        æ¨¡åå¯¹æ¯ä¸ªæ ·æ¬ç»åºçé¢æµåæ°ï¼åæ°è¶å¤§è¡¨ç¤ºè¶å¾åæ­£ç±»

    è¾åºï¼
    - auc: float
        AUC å¼ï¼åå¼èå´ [0, 1]

    æ ¸å¿ææ³ï¼
    éæºåä¸ä¸ªæ­£æ ·æ¬ p åä¸ä¸ªè´æ ·æ¬ nï¼
    ç»è®¡ P(score_p &gt; score_n) çæ¯ä¾
    """

    # æåæ­£æ ·æ¬ (label=1) çé¢æµåæ°
    pos_scores = [s for l, s in zip(labels, scores) if l == 1]

    # æåè´æ ·æ¬ (label=0) çé¢æµåæ°
    neg_scores = [s for l, s in zip(labels, scores) if l == 0]

    # æåºæ­£ç¡®çæ­£è´æ ·æ¬å¯¹æ°éï¼åè®¸ 0.5 çæå¹³è´¡ç®ï¼
    correct = 0.0

    # æ­£è´æ ·æ¬å¯¹çæ»æ°é |P| * |N|
    total = len(pos_scores) * len(neg_scores)

    # å¯¹æææ­£è´æ ·æ¬å¯¹è¿è¡ä¸¤ä¸¤æ¯è¾
    for sp in pos_scores:        # sp: positive sample score
        for sn in neg_scores:    # sn: negative sample score
            if sp &gt; sn:
                # æ­£æ ·æ¬åæ°ä¸¥æ ¼å¤§äºè´æ ·æ¬åæ°ï¼æåºæ­£ç¡®
                correct += 1.0
            elif sp == sn:
                # åæ°ç¸ç­ï¼æçº¦å®è®¡ä¸º 0.5ï¼éæºæå¹³ï¼
                correct += 0.5
            # sp &lt; sn æ¶ä¸å åï¼è¡¨ç¤ºæåºéè¯¯

    # AUC = æåºæ­£ç¡®çæ¯ä¾
    return correct / total
</code></pre>
<p><strong>å¤æåº¦åæï¼</strong></p>
<ul>
<li>æ¶é´å¤æåº¦ï¼<p></p><div class="math display">\[O(|P| \cdot |N|)
\]</div><p></p>å¶ä¸­ <span class="math inline">\(|P|\)</span> ä¸ºæ­£æ ·æ¬æ°ï¼<span class="math inline">\(|N|\)</span> ä¸ºè´æ ·æ¬æ°</li>
<li>ç©ºé´å¤æåº¦ï¼<p></p><div class="math display">\[O(|P| + |N|)
\]</div><p></p></li>
</ul>
<p><strong>éç¨åºæ¯ï¼</strong></p>
<ul>
<li>ä¸¥æ ¼å¯¹åº AUC çæ¦çå®ä¹</li>
<li>éåæå­¦ãçè®ºéªè¯ãå°è§æ¨¡æ°æ®</li>
<li>ä¸éç¨äºå·¥ç¨åå¤§è§æ¨¡ç¦»çº¿è®¡ç®</li>
</ul>
<hr>
<h3 id="2-æåº--rank-based-å®ç°å·¥ç¨ææ³">2. æåº / Rank-based å®ç°ï¼å·¥ç¨ææ³ï¼</h3>
<pre><code class="language-python">import numpy as np

def auc_rank(labels, scores):
    """
    åºäºæåºï¼Rank / MannâWhitney Uï¼ç AUC è®¡ç®æ¹æ³ã

    è¾å¥ï¼
    - labels: List[int] æ 1D numpy array
        æ ·æ¬çå®æ ç­¾ï¼åå¼ä¸º {0, 1}
    - scores: List[float] æ 1D numpy array
        æ¨¡åé¢æµåæ°ï¼åæ°è¶å¤§è¡¨ç¤ºè¶å¯è½ä¸ºæ­£æ ·æ¬

    è¾åºï¼
    - auc: float
        AUC å¼ï¼åå¼èå´ [0, 1]

    æ ¸å¿ææ³ï¼
    1. æé¢æµåæ°ä»å°å°å¤§æåº
    2. æ«ææåºåçæ ·æ¬åºå
    3. æ¯éå°ä¸ä¸ªæ­£æ ·æ¬ï¼ç»è®¡å¶åé¢å·²æå¤å°è´æ ·æ¬
       è¿äºè´æ ·æ¬é½è¢«è¯¥æ­£æ ·æ¬âæ­£ç¡®å°æå¨åé¢â
    """

    # è½¬ä¸º numpy arrayï¼ä¾¿äºæåºååéåæä½
    labels = np.asarray(labels)
    scores = np.asarray(scores)

    # è·åæç§ score ä»å°å°å¤§æåºåçç´¢å¼
    order = np.argsort(scores)

    # ææåºåçé¡ºåºéææ ç­¾
    labels_sorted = labels[order]

    # æ­£æ ·æ¬æ°é |P|
    n_pos = np.sum(labels_sorted == 1)

    # è´æ ·æ¬æ°é |N|
    n_neg = np.sum(labels_sorted == 0)

    # å·²æ«æå°çè´æ ·æ¬æ°éï¼åç¼è´æ ·æ¬è®¡æ°ï¼
    neg_count = 0

    # æåºæ­£ç¡®çæ­£è´æ ·æ¬å¯¹æ°é
    correct = 0.0

    # ä»ä½åå°é«åæ«æ
    for l in labels_sorted:
        if l == 1:
            # å½åæ¯æ­£æ ·æ¬ï¼
            # å®åé¢çææè´æ ·æ¬é½æ»¡è¶³ score_neg &lt; score_pos
            correct += neg_count
        else:
            # å½åæ¯è´æ ·æ¬ï¼å¢å è´æ ·æ¬è®¡æ°
            neg_count += 1

    # AUC = æåºæ­£ç¡®çæ­£è´æ ·æ¬å¯¹ / æ»æ­£è´æ ·æ¬å¯¹
    return correct / (n_pos * n_neg)
</code></pre>
<p><strong>å¤æåº¦åæï¼</strong></p>
<ul>
<li>æ¶é´å¤æåº¦ï¼<p></p><div class="math display">\[O(n \log n)
\]</div><p></p>ä¸»è¦æ¥èªæåºæä½ï¼å¶ä¸­ <span class="math inline">\(n = |P| + |N|\)</span></li>
<li>ç©ºé´å¤æåº¦ï¼<p></p><div class="math display">\[O(n)
\]</div><p></p></li>
</ul>
<p><strong>å·¥ç¨è¯´æï¼</strong></p>
<ul>
<li>ä¸ MannâWhitney U ç»è®¡éå®å¨ç­ä»·</li>
<li>æ¯å·¥ä¸çç¦»çº¿ AUC è®¡ç®ï¼Spark / MapReduce / Flinkï¼ççè®ºåºç¡</li>
<li>å¯èªç¶æ©å±ä¸ºåæ¡¶ãå userãåå®éªç»ç AUC ç»è®¡</li>
</ul>

</div>
<div class="clear"></div>

		<p class="postfoot">
			posted on 
<span id="post-date" data-last-update-days="0.0006944444444444445" data-date-updated="2026-01-06 20:28">2026-01-06 20:27</span>&nbsp;
<a href="https://www.cnblogs.com/GlenTt">GlenTt</a>&nbsp;
éè¯»(<span id="post_view_count">21</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19449279);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19449279', targetLink: 'https://www.cnblogs.com/GlenTt/p/19449279', title: 'AUC çä¸¤ç§ç­ä»·å®ä¹ï¼ä»æåºæ¦çå° ROC æ²çº¿çç»ä¸çè§£' })">ä¸¾æ¥</a>

		</p>
	 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æ§è½æå4åï¼ä½¿ç¨Granianä½ä¸ºDjangoé¡¹ç®çASGIæå¡å¨ ]]></title>
    <link>https://www.cnblogs.com/deali/p/19449242</link>
    <guid>34a183ec83010b54501b7079b4c8f4f0</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/deali/p/19449242" title="åå¸äº 2026-01-06 20:11">
    <span role="heading" aria-level="2">æ§è½æå4åï¼ä½¿ç¨Granianä½ä¸ºDjangoé¡¹ç®çASGIæå¡å¨</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="åè¨">åè¨</h2>
<p>æè¿æåç»§ç»­å¨å¼å DjangoStarter çæ°çæ¬äºã</p>
<p>ä¹åä¸ºäºå®ç° docker é¨ç½²ï¼ææ Nginx æåè¿äº DjangoStarter ç compose éç½®éäºï¼ä¸è¿è¿å¸¦æ¥äºéç½®çå¤æåº¦ï¼ç¹å«æ¯è¿è¦æ­éæ¡æ¶å®ç° URL prefix ä¹ç±»çåè½ã</p>
<p>ä» v3.2.x çæ¬å¼å§ï¼æå°±å¯å¨äºåæ³è®¡åï¼ç®åä»£ç ååè½ï¼åå°å¿æºè´æï¼è¿ä¸ª Nginx å®¹å¨ä¹æ¯æä¸ç´æ³å»æçã</p>
<p>æè¿åç° Granian è¿ä¸ª Rust å¼åç ASGI æå¡å¨ï¼æ§è½é«ï¼èä¸è¿å¯ä»¥æ¯æéææä»¶ï¼æ­£å¥½å®ç¾ç¬¦åæçéæ±ï¼äºæ¯è¿æ¬¡æ­£å¥½æ¿æ¥æ¿æ¢åæ¬ä½¿ç¨ç Daphne</p>
<h2 id="granian">Granian</h2>
<p>é¡¹ç®ä¸»é¡µ: <a href="https://github.com/emmett-framework/granian" target="_blank" rel="noopener nofollow">https://github.com/emmett-framework/granian</a></p>
<p>Granian æ¯ä¸æ¬¾é«æ§è½ Python Web Serverï¼æ¯æ ASGIãWSGIãRSGIï¼åºäº Rust ç¼åï¼å¯å¨éåº¦å¿«ãå¹¶åè½åå¼ºï¼éå¸¸éå Django / FastAPI / Starletteã</p>
<p>å®æ¹æè¿°ä¸º âA Rust HTTP server for Python applications built on top of Hyper/Tokioâã</p>
<p>ç¹ç¹ï¼</p>
<ul>
<li>æ¯æ <strong>ASGI 3</strong>ã<strong>RSGI</strong>ï¼Rust-Server-Gateway Interfaceï¼å <strong>WSGI</strong> æ¥å£ã</li>
<li>æ¯æ HTTP/1 å HTTP/2ï¼æªæ¥è®¡å HTTP/3ï¼åè®®ã</li>
<li>æ¯æéææä»¶ç´åº (âDirect static files servingâ)ã</li>
</ul>
<h2 id="ä½¿ç¨æ¹å¼">ä½¿ç¨æ¹å¼</h2>
<p>å¾ç®åï¼ä¸éè¦ä¿®æ¹ä»£ç ï¼åªéè¦ä¿®æ¹å¯å¨å½ä»¤ã</p>
<p>ç®åæ­é DjangoStarter ä½¿ç¨çå¯å¨å½ä»¤æ¯è¿æ ·çï¼</p>
<pre><code class="language-bash">granian --interface asgi --host 0.0.0.0 --port 8000 --static-path-route /static --static-path-mount ./static-dist config.asgi:application
</code></pre>
<p>ç±»ä¼¼ uvicornï¼è¿ä¸ª granian ä¹æ¯æç­éè½½ï¼å ä¸ª <code>--reload</code> åæ°å°±è¡äº</p>
<h2 id="æ§è½æµè¯">æ§è½æµè¯</h2>
<p>æ¬æ¬¡ç¨ wrk è¿è¡æ§è½æµè¯</p>
<h3 id="æµè¯æ°æ®">æµè¯æ°æ®</h3>
<p>ä»¥ä¸æ°æ®å¨è¾è®¯äº 2 cores CPU + 2G åå­çæå¡å¨ä¸æµå¾ã</p>
<p>django 5.x + ninja + daphne</p>
<pre><code>$ wrk -t4 -c200 -d30s http://127.0.0.1:9876/api/django-starter/monitoring/health
Running 30s test @ http://127.0.0.1:9876/api/django-starter/monitoring/health
  4 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.97s     0.00us   1.97s   100.00%
    Req/Sec    38.55     55.33   343.00     90.23%
  1343 requests in 30.04s, 760.03KB read
  Socket errors: connect 0, read 0, write 0, timeout 1342
Requests/sec:     44.70
Transfer/sec:     25.30KB
</code></pre>
<p>django 5.x + ninja + granian</p>
<pre><code>$ wrk -t4 -c200 -d30s http://127.0.0.1:9875/api/django-starter/monitoring/hea
lth
Running 30s test @ http://127.0.0.1:9875/api/django-starter/monitoring/health
  4 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.20s    93.05ms   1.72s    82.69%
    Req/Sec    83.13    105.81   460.00     83.72%
  4980 requests in 30.04s, 2.85MB read
Requests/sec:    165.76
Transfer/sec:     97.31KB
</code></pre>
<p>å ä¸ºå¥½å¥ï¼æè¿æ¾å°ä¹åä¸ä¸ªå¾èçé¡¹ç®ï¼ä½¿ç¨WSGIé¨ç½²çè¿è¡å¯¹æ¯ã</p>
<p>ä»¥ä¸æ°æ®å¨ç§æäºç 4 cores CPU + 2G åå­æå¡å¨ä¸æµå¾ã</p>
<p>å ä¸ºæ¯å®å¨ä¸åçæå¡å¨ç¡¬ä»¶ï¼æ°æ®ä»ä¾åèã</p>
<p>Django 3.x + drf + uwsgi + nginx</p>
<pre><code>$ wrk -t4 -c200 -d30s http://127.0.0.1:9001/api/health/
Running 30s test @ http://127.0.0.1:9001/api/health/
  4 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   295.30ms  373.95ms   1.96s    85.14%
    Req/Sec   205.54     68.42   380.00     73.73%
  19583 requests in 30.09s, 5.83MB read
  Socket errors: connect 0, read 0, write 0, timeout 474
  Non-2xx or 3xx responses: 12
Requests/sec:    650.89
Transfer/sec:    198.32KB
</code></pre>
<p>Django 3.x + ninja + uwsgi + nginx</p>
<pre><code>$ wrk -t4 -c200 -d30s http://127.0.0.1:9001/api2/health
Running 30s test @ http://127.0.0.1:9001/api2/health
  4 threads and 200 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   203.75ms  280.30ms   1.95s    88.44%
    Req/Sec   250.81    108.59   500.00     61.21%
  22542 requests in 30.06s, 5.68MB read
  Socket errors: connect 0, read 0, write 0, timeout 420
  Non-2xx or 3xx responses: 12
Requests/sec:    749.88
Transfer/sec:    193.35KB
</code></pre>
<h3 id="ç»è®º">ç»è®º</h3>
<p>ä»¥ä¸æ¯ä½¿ç¨ AI å¯¹ä¸é¢çæµè¯æ°æ®è¿è¡åæçç»è®ºï¼ä¸è¿ ASGI å uWSGI ä¸å¨åä¸å°æå¡å¨è¿è¡æµè¯ï¼å¶å®å¾é¾ç´æ¥å¯¹æ¯ãç®åçæ¥åæ¢å° Granian ç¡®å®å¯ä»¥æé«4åçæ§è½ã</p>
<p>â  Daphne å¨ Django + ASGI ä¸çæ§è½è¡¨ç°éå¸¸å·®</p>
<ul>
<li>å»¶è¿ç´æ¥é£å° <strong>1.9 ç§çº§å«</strong>ï¼</li>
<li>wrk 200 å¹¶åå ä¹æå®åæï¼</li>
<li><strong>1343 è¯·æ±é 1342 è¶æ¶</strong>ï¼ç­äºå®å¨é¡¶ä¸ä½ã</li>
</ul>
<p>è¯´ç½äºï¼<strong>Daphne æ´åæ¯å¼åç¯å¢æå¡å¨ï¼ä¸æ¨èä¸çäº§é«å¹¶åã</strong></p>
<p>â¡ Granian æ§è½æ¯ Daphne å¥½ 3â4 åï¼ä½ä»ç¶æé</p>
<ul>
<li>æ¯ç§å¤ç <strong>165 req/s</strong>ï¼åæºæ¿ãåä»£ç ï¼ã</li>
<li>å»¶è¿ä»ç¶å¨ <strong>1.2s</strong> å·¦å³ï¼è¿ä¸ç®çæ³ï¼å¨é«å¹¶åä¸ä»ååï¼ã</li>
<li>ä¼ç¹æ¯ ASGI åç + Rust å®ç°ï¼æ¯ Daphne å¼ºå¤ªå¤ã</li>
</ul>
<p>ç´è§æåï¼<strong>Granian è½ç¨ï¼ä½ä½ å«ææå®å uWSGI é£æ ·ææµéã</strong></p>
<p>â¢ uWSGIï¼WSGIï¼è¡¨ç°ç¢¾åï¼åæºå¯è¾¾ 650â750 req/s çº§å«</p>
<ul>
<li>æ§è½ç´æ¥æ¯ granian ç <strong>4ï½5 å</strong>ã</li>
<li>è½ç¶æ¯èæ¶æï¼WSGIï¼ï¼ä½è°ä¼æçãç¨³å®ãåéæºå¶å¼ºï¼æåè½åè¿å¼ºäºåç±» ASGI æå¡ã</li>
</ul>
<p>ç®èè¨ä¹ï¼<strong>å¦æä¸ç¨å¼æ­¥ï¼WSGI ä¾æ§æ¯ Django çæå¼ºé¨ç½²æ¹å¼ï¼æ§è½å±é¢ï¼ã</strong></p>
<h2 id="docker-compose">docker-compose</h2>
<p>è¿æ¯ç²¾ç®åç compose éç½®</p>
<pre><code class="language-yaml">services:
  app:
    image: ${APP_IMAGE_NAME}:${APP_IMAGE_TAG}
    container_name: $APP_NAME-app
    command:
      - granian
      - --interface
      - asgi
      - --host
      - 0.0.0.0
      - --port
      - "${APP_INTERNAL_PORT:-8000}"
      - --static-path-route
      - /static
      - --static-path-mount
      - /project/static-dist
      - config.asgi:application
</code></pre>
<h2 id="å½ä»¤è¡åæ°">å½ä»¤è¡åæ°</h2>
<p>å®çå½ä»¤è¡ç»æå¾ç®åï¼</p>
<pre><code class="language-bash">granian [OPTIONS] APP
</code></pre>
<p>å¶ä¸­ï¼</p>
<ul>
<li><strong>APP</strong> æ¯å¥å£ï¼ä¾å¦ï¼<code>config.asgi:application</code></li>
<li><strong>OPTIONS</strong> æ¯åç§éç½®åæ°</li>
</ul>
<p>ä¸é¢æåç±»æ´çææåæ°ï¼éå¸¦è¯´æä¸å»ºè®®ï¼ã</p>
<h3 id="-åºç¡åæ°å¯å¨å¿è¦é¡¹">ð§© åºç¡åæ°ï¼å¯å¨å¿è¦é¡¹ï¼</h3>
<table>
<thead>
<tr>
<th>åæ°</th>
<th>è¯´æ</th>
<th>é»è®¤å¼</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>APP</code></td>
<td><strong>è¦å¯å¨çåºç¨å¥å£</strong>ï¼å¦ <code>mysite.asgi:application</code>ï¼</td>
<td>å¿å¡«</td>
</tr>
<tr>
<td><code>--interface</code></td>
<td>æ¥å£ç±»åï¼<code>asgi</code> / <code>asginl</code> / <code>rsgi</code> / <code>wsgi</code></td>
<td>rsgi</td>
</tr>
<tr>
<td><code>--host</code></td>
<td>çå¬å°å</td>
<td>127.0.0.1</td>
</tr>
<tr>
<td><code>--port</code></td>
<td>ç«¯å£</td>
<td>8000</td>
</tr>
<tr>
<td><code>--uds</code></td>
<td>ä½¿ç¨ Unix Domain Socket</td>
<td>æ </td>
</tr>
<tr>
<td><code>--http</code></td>
<td>HTTP çæ¬ï¼<code>1</code>ã<code>2</code>ã<code>auto</code></td>
<td>auto</td>
</tr>
<tr>
<td><code>--workers</code></td>
<td>Worker è¿ç¨æ°</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>ð DjangoãFastAPI ç¨æ·ä¸è¬åï¼</p>
<pre><code>--interface asgi
</code></pre>
<h3 id="ï¸-éææä»¶æå¡django-ä¸ç¨éç½®">ðï¸ éææä»¶æå¡ï¼Django ä¸ç¨éç½®ï¼</h3>
<p>Granian åç½®éææä»¶æå¡ï¼</p>
<table>
<thead>
<tr>
<th>åæ°</th>
<th>è¯´æ</th>
<th>é»è®¤å¼</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--static-path-route</code></td>
<td>URL è·¯ç±åç¼ï¼ä¾å¦ <code>/static</code></td>
<td>/static</td>
</tr>
<tr>
<td><code>--static-path-mount</code></td>
<td>æä»¶ç®å½ï¼ä¾å¦ <code>/project/static-dist</code></td>
<td>æ </td>
</tr>
<tr>
<td><code>--static-path-expires</code></td>
<td>ç¼å­æ¶é´ï¼ç§ï¼</td>
<td>86400</td>
</tr>
</tbody>
</table>
<p>ç¤ºä¾ï¼</p>
<pre><code>--static-path-route /static --static-path-mount /project/static-dist
</code></pre>
<h3 id="ï¸-å¤è¿ç¨çº¿ç¨äºä»¶å¾ªç¯éé¡¹">âï¸ å¤è¿ç¨ãçº¿ç¨ãäºä»¶å¾ªç¯éé¡¹</h3>
<p>Worker / Thread</p>
<table>
<thead>
<tr>
<th>åæ°</th>
<th>è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--workers</code></td>
<td>Worker æ°é</td>
</tr>
<tr>
<td><code>--blocking-threads</code></td>
<td>é»å¡çº¿ç¨æ°</td>
</tr>
<tr>
<td><code>--runtime-threads</code></td>
<td>Runtime çº¿ç¨æ°</td>
</tr>
<tr>
<td><code>--runtime-blocking-threads</code></td>
<td>Runtime I/O é»å¡çº¿ç¨</td>
</tr>
</tbody>
</table>
<p>å»ºè®®ï¼</p>
<ul>
<li><strong>CPU Ã 2</strong> å·¦å³ç worker å®¹ééå¸¸å¤ç¨</li>
<li>å¤§é¨å ASGI é¡¹ç®ä¸éè¦è° thread åæ°</li>
</ul>
<h3 id="-äºä»¶å¾ªç¯--runtime">ð äºä»¶å¾ªç¯ &amp; Runtime</h3>
<table>
<thead>
<tr>
<th>åæ°</th>
<th>è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--loop</code></td>
<td>äºä»¶å¾ªç¯ï¼<code>auto</code>ã<code>asyncio</code>ã<code>rloop</code>ã<code>uvloop</code></td>
</tr>
<tr>
<td><code>--task-impl</code></td>
<td>task æ§è¡å¨ï¼<code>asyncio</code> / <code>rust</code></td>
</tr>
<tr>
<td><code>--runtime-mode</code></td>
<td>åçº¿ç¨ <code>st</code> / å¤çº¿ç¨ <code>mt</code></td>
</tr>
</tbody>
</table>
<p>éç¨å»ºè®®ï¼</p>
<ul>
<li>æ®éé¡¹ç®ï¼ç¨é»è®¤å³å¯</li>
<li>é«å¹¶åï¼<code>--task-impl rust</code> æ§è½æ´å¼º</li>
</ul>
<h3 id="-http1-ä¸-http2-ç¸å³åæ°">ð HTTP/1 ä¸ HTTP/2 ç¸å³åæ°</h3>
<table>
<thead>
<tr>
<th>ç±»å«</th>
<th>å¸¸ç¨éç½®</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTTP/1</td>
<td><code>--http1-buffer-size</code>ã<code>--http1-keep-alive</code></td>
</tr>
<tr>
<td>HTTP/2</td>
<td><code>--http2-*</code> ä¸ç³»ååæ°æ§å¶ flow controlãçªå£ãkeepaliveãstream æ°éç­</td>
</tr>
</tbody>
</table>
<p>å¤§é¨åé¡¹ç®æ éè°æ´ï¼é»è®¤å³å¯ã</p>
<h3 id="-æ¥å¿logging">ð æ¥å¿ï¼Loggingï¼</h3>
<table>
<thead>
<tr>
<th>åæ°</th>
<th>è¯´æ</th>
<th>é»è®¤</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--log / --no-log</code></td>
<td>å¯ç¨æ¥å¿</td>
<td>enabled</td>
</tr>
<tr>
<td><code>--log-level</code></td>
<td>æ¥å¿ç­çº§</td>
<td>info</td>
</tr>
<tr>
<td><code>--log-config</code></td>
<td>ä½¿ç¨ JSON éç½®æä»¶</td>
<td>æ </td>
</tr>
<tr>
<td><code>--access-log</code></td>
<td>å¼å¯ access log</td>
<td>disabled</td>
</tr>
<tr>
<td><code>--access-log-fmt</code></td>
<td>Access log æ ¼å¼</td>
<td>æ </td>
</tr>
</tbody>
</table>
<p>å¦æä½ å¸æçäº§ç¯å¢æ Nginx æ ·å¼ç access logï¼</p>
<pre><code>--access-log --access-log-fmt "%a %r %s %b"
</code></pre>
<h3 id="-ç­éè½½å¼åç¯å¢ç¨">ð ç­éè½½ï¼å¼åç¯å¢ç¨ï¼</h3>
<table>
<thead>
<tr>
<th>åæ°</th>
<th>è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--reload</code></td>
<td>å¼å¯èªå¨éè½½</td>
</tr>
<tr>
<td><code>--reload-paths</code></td>
<td>æå®çæ§ç®å½</td>
</tr>
<tr>
<td><code>--reload-ignore-*</code></td>
<td>å¿½ç¥ç®å½ãè·¯å¾ãpattern</td>
</tr>
</tbody>
</table>
<p>ä¾å¦ï¼</p>
<pre><code>--reload --reload-paths src/
</code></pre>
<h3 id="-https">ð HTTPS</h3>
<table>
<thead>
<tr>
<th>åæ°</th>
<th>è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--ssl-certificate</code></td>
<td>è¯ä¹¦æä»¶</td>
</tr>
<tr>
<td><code>--ssl-keyfile</code></td>
<td>å¯é¥æä»¶</td>
</tr>
<tr>
<td><code>--ssl-ca</code></td>
<td>CA</td>
</tr>
<tr>
<td><code>--ssl-client-verify</code></td>
<td>å®¢æ·ç«¯è¯ä¹¦éªè¯</td>
</tr>
</tbody>
</table>
<p>ï¼ä¸è¬ååä»£çäº¤ç» Nginx å HTTPSï¼</p>
<h3 id="-å¶ä»æç¨ä½ä¸å¸¸æ¹çåæ°">ð§° å¶ä»æç¨ä½ä¸å¸¸æ¹çåæ°</h3>
<table>
<thead>
<tr>
<th>åæ°</th>
<th>è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--working-dir</code></td>
<td>åæ¢ WorkDir</td>
</tr>
<tr>
<td><code>--env-files</code></td>
<td>å è½½ç¯å¢åéæä»¶</td>
</tr>
<tr>
<td><code>--factory</code></td>
<td>APP æ¯ factory function æ¶ä½¿ç¨</td>
</tr>
<tr>
<td><code>--url-path-prefix</code></td>
<td>åºç¨æè½½åç¼</td>
</tr>
<tr>
<td><code>--process-name</code></td>
<td>èªå®ä¹è¿ç¨å</td>
</tr>
<tr>
<td><code>--pid-file</code></td>
<td>åå¥ PID æä»¶</td>
</tr>
<tr>
<td><code>--version</code></td>
<td>æ¾ç¤ºçæ¬</td>
</tr>
<tr>
<td><code>--help</code></td>
<td>æ¾ç¤ºå¸®å©</td>
</tr>
</tbody>
</table>

</div>
<div id="MySignature" role="contentinfo">
    å¾®ä¿¡å¬ä¼å·ï¼ãç¨åºè®¾è®¡å®éªå®¤ã
ä¸æ³¨äºäºèç½ç­é¨æ°ææ¯æ¢ç´¢ä¸å¢éææ·å¼åå®è·µï¼åæ¬æ¶æè®¾è®¡ãæºå¨å­¦ä¹ ä¸æ°æ®åæç®æ³ãç§»å¨ç«¯å¼åãLinuxãWebååç«¯å¼åç­ï¼æ¬¢è¿ä¸èµ·æ¢è®¨ææ¯ï¼åäº«å­¦ä¹ å®è·µç»éªã
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-06 20:12">2026-01-06 20:11</span>&nbsp;
<a href="https://www.cnblogs.com/deali">ç¨åºè®¾è®¡å®éªå®¤</a>&nbsp;
éè¯»(<span id="post_view_count">24</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19449242);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19449242', targetLink: 'https://www.cnblogs.com/deali/p/19449242', title: 'æ§è½æå4åï¼ä½¿ç¨Granianä½ä¸ºDjangoé¡¹ç®çASGIæå¡å¨' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Zsh éç½®ç¬è®° ]]></title>
    <link>https://www.cnblogs.com/owlman/p/19449225</link>
    <guid>248670bc7bb3e6216c26b650fbc95f3d</guid>
    <description>
    <![CDATA[ 
        <h2 class="post-title">
            <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/owlman/p/19449225" title="åå¸äº 2026-01-06 20:01">
    <span role="heading" aria-level="2">Zsh éç½®ç¬è®°</span>
    

</a>

        </h2>
        <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>[!NOTE] ç¬è®°è¯´æ</p>
<p>è¿ç¯ç¬è®°ä¸»è¦è®°å½äºæå¨ä½¿ç¨ Zsh è¿æ¬¾ Shell çè¿ç¨ä¸­æè®°å½çä¸äºå¿å¾ä¸ä½ä¼ãå®å°ä¼è¢«å­å¨å¨æä¸ªäººç <a href="https://github.com/owlman/CS_Studynotes" target="_blank" rel="noopener nofollow">è®¡ç®æºä¸ä¸ç¬è®°åº</a> ä¸­ï¼ä»¥ä¾¿æ¥åæ¥éã</p>
</blockquote>
<h2 id="zsh-ç®ä»">Zsh ç®ä»</h2>
<p>Z shellï¼ä»¥ä¸ç®ç§° Zshï¼æ¯ä¿ç½Â·å¼æ¯å¡å¾·ï¼Paul Falstadï¼äº 1990 å¹´å¨æ®ææ¯é¡¿å¤§å­¦æ±å­¦æ¶ç¼åçãä¸æ¬¾å¯ç¨ä½äº¤äºå¼ç»å½ç ShellãZsh å¯¹ <a href="https://zh.wikipedia.org/wiki/Bourne_shell" target="_blank" rel="noopener nofollow">Bourne shell</a>ååºäºå¤§éæ¹è¿ï¼åæ¶å å¥äº <a href="https://zh.wikipedia.org/wiki/Bash" target="_blank" rel="noopener nofollow">Bash</a>ã<a href="https://zh.wikipedia.org/wiki/Korn_shell" target="_blank" rel="noopener nofollow">ksh</a> å <a href="https://zh.wikipedia.org/wiki/Tcsh" target="_blank" rel="noopener nofollow">tcsh</a> çæäºåè½ã</p>
<p>2019 å¹´ï¼ç±äºæ°çæ¬ç Bash v5 å°å¼æºæææ¹æäº GPLv3 åè®®ï¼è Apple å¬å¸ä¸è´¯é¿åå¨ç³»ç»ç»ä»¶ä¸­å¼å¥ GPLv3 è½¯ä»¶ãäºæ¯èªä»é£æ¶èµ·ï¼macOS ç³»ç»ä¸çé¢ç½® Shell å°±å·²ä» Bash æ¹ä¸ºäº Zshãå¦å¤ï¼<a href="https://zh.wikipedia.org/wiki/Kali_Linux" target="_blank" rel="noopener nofollow">Kali Linux</a> ä¹ä½¿ç¨ Zsh ä½ä¸ºé¢ç½® Shellãå¶ä¸»è¦ç¹æ§åæ¬ï¼</p>
<ul>
<li>æä¾å¯ç¼ç¨çå½ä»¤è¡è¡¥å¨åè½ï¼è¯¥åè½å¯å¸®å©ç¨æ·é®å¥å¸¸ç¨å½ä»¤éé¡¹ååæ°ï¼</li>
<li>æä¾å¯ç¼ç¨çå½ä»¤è¡çé¢ï¼åæ¬å°æç¤ºè¡ä¿¡æ¯æ¾ç¤ºå¨å±å¹å³ä¾§ï¼ä»¥åèªå¨éèè¿é¿æä»¤ç­åè½ï¼</li>
<li>æä¾å¯ä¸ä»»æ Shell å±äº«çå½ä»¤è¡åå²è®°å½ï¼</li>
<li>å¯å¨ä¸åå©å¤é¨ç¨åºçæåµä¸å®ç°æä»¶çæ¥æ¾ï¼</li>
<li>æ¹è¿äºéå¯¹åé/æ°ç»çå¤çæ¹å¼ï¼</li>
<li>åè®¸å¨åç¼å²åºåç¼è¾å¤è¡å½ä»¤ï¼</li>
<li>æ¯æéå¯¹å½ä»¤çæ¼åæ£æ¥ï¼</li>
<li>æ¯æå¤ç§å¼å®¹æ¨¡å¼ï¼ä¾å¦ï¼Zsh å¯å¨è¿è¡ä¸º<code>/bin/sh</code>çæåµä¸ä¼ªè£æ Bourne shellï¼</li>
<li>æ¯æä»¥å è½½æ¨¡åçæ¹å¼å¼å¥é¢å¤çåè½ï¼åæ¬æ¯æ Unix åå¥æ¥å­æ§å¶ãFTP å®¢æ·ç«¯ç­ï¼</li>
<li>æä¾æ<code>where</code>å½ä»¤ï¼è¯¥å½ä»¤çä½¿ç¨æ¹æ³ä¸<code>which</code>å½ä»¤ç±»ä¼¼ï¼ä½è¿åçæ¯æå®æä»¤å¨<code>$PATH</code>ä¸­çå¨é¨ä½ç½®ï¼èä¸æ¯å®å½åæä¼åå¹éçä½ç½®ï¼</li>
<li>åè®¸ç¨æ·ä¸ºæå®ç®å½è®¾ç½®å«åï¼ä¾å¦ï¼ç¨æ·å¯ä»¥ä¸º<code>/usr/bin</code>è®¾ç½®å«å<code>/u</code>ï¼è¿æ ·å¨è¾å¥<code>/u</code>æ¶ï¼Zsh ä¼èªå¨å°å¶æ¿æ¢ä¸º<code>/usr/bin</code>ï¼</li>
</ul>
<h2 id="å®è£æ­¥éª¤">å®è£æ­¥éª¤</h2>
<p>å¨å®è£ä¹åï¼æå¸æè¯»èç¡®å®èªå·±æ¯å¨ç±» UNIX ç³»ç»ä¸ï¼å ä¸º Zsh æ¯å¨ç±» UNIX ç³»ç»ä¸è¿è¡ç Shell ç¨åºï¼å¦ææ¨ä½¿ç¨çæ¯ Windows ç³»ç»ï¼æ¨èä½¿ç¨ Windows Subsystem for Linuxï¼WSLï¼ãä¸é¢ä¹¦å½æ­£ä¼ ï¼Zsh å¨æ¯ä¸ªæä½ç³»ç»ä¸­çå®è£æ¹å¼å¹¶ä¸å®å¨ç¸åï¼ä¸é¢æ¯å¶å¨å ç§å¸¸è§ Linux/UNIX ç³»ç»ä¸çå®è£å½ä»¤ï¼</p>
<pre><code class="language-bash"># macOS ç³»ç»ä¸çå®è£å½ä»¤ï¼
brew install zsh

# ubuntu/debian ç³»ç»ä¸çå®è£å½ä»¤ï¼
sudo apt install zsh

# CentOS ç³»ç»ä¸çå®è£å½ä»¤ï¼
sudo yum install zsh

# ArchLinux/Manjaro ç³»ç»ä¸çå®è£å½ä»¤ï¼
sudo pacman -S zsh
</code></pre>
<p>å¦ææ¨ä½¿ç¨çæ¯ä¸è¿°æä½ç³»ç»ä¹ä¸ï¼å¨æ§è¡å®ç¸åºçå®è£å½ä»¤ä¹åï¼å°±å¯ä»¥ä½¿ç¨<code>cat /etc/shells</code>å½ä»¤æ¥çå½åç³»ç»å¯ä»¥ç¨ç Shell äºãç¶åï¼åªè¦å¨è¯¥å½ä»¤è¿åçç»æä¸­çå°<code>/bin/zsh</code>ï¼å°±è¯´æ Zsh å·²ç»å®è£å¥½äºï¼å¦å¾ 1 æç¤ºã</p>

<p><img alt="å¾ 1ï¼å½åå¯ç¨ç Shell" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202601/691082-20260106195509700-1475784110.png" class="lazyload"></p>
<p><strong>å¾ 1</strong>ï¼å½åå¯ç¨ç Shell</p>
<p>æ¥ä¸æ¥ï¼æä»¬å¯ä»¥ä½¿ç¨<code>chsh -s /bin/zsh</code>å½ä»¤å° Zsh è®¾ç½®ä¸ºç³»ç»é»è®¤ Shell äºãå¦æå°ç®åä¸ºæ­¢çæä½ä¸åé¡ºå©ï¼ç°å¨åªéè¦éæ°å¯å¨ä¸ä¸ª Shell ä¼è¯ï¼éå¸¸æ¯ä¸ä¸ªå½ä»¤è¡ç»ç«¯çªå£ï¼ï¼å°±ä¼çå° Zsh çåå§éç½®äºï¼å¦å¾ 2 æç¤ºã</p>

<p><img alt="å¾ 2ï¼Zsh çéç½®å¼å¯¼çé¢" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202601/691082-20260106195545492-898979643.png" class="lazyload"></p>
<p><strong>å¾ 2</strong>ï¼Zsh çéç½®å¼å¯¼çé¢</p>
<p>å¨ä¸è¿°çé¢ä¸­ï¼å¦ææä»¬è¾å¥<code>q</code>ä¼ç´æ¥éåºéç½®å¼å¯¼ï¼ä¸ä¸æ¬¡è¿è¡ zsh æ¶ä¼åæ¬¡è¿å¥éç½®å¼å¯¼ãå¦æè¾å¥<code>0</code>ï¼ä¹ä¼éåºéç½®å¼å¯¼ï¼ä½æ¯ä¼å¨å½åç¨æ·ç®å½çæä¸ä¸ªç©ºç½çæä»¶<code>.zshrc</code>ï¼è·¯å¾ä¸º<code>~/.zshrc</code>ï¼ï¼å¹¶ä¸ä¸ä¼åè¿å¥éç½®å¼å¯¼çé¢ãæ¢è¨ä¹ï¼Zsh ä¼ä¸ä¼å¨å¯å¨æ¶è¿å¥éç½®å¼å¯¼çé¢åå³äºå½åç¨æ·ç®å½ä¸æ¯å¦å­å¨<code>.zshrc</code>æä»¶ï¼è¯¥æä»¶æ¯ Zsh çé»è®¤éç½®æä»¶ï¼äººä»¬å¯ä»¥ä½¿ç¨ vim ç¼è¾å¨æå¼å®å¹¶è¿è¡æºç çº§å«çæå¨éç½®ãèå¦ææä»¬å¨è¿éè¾å¥<code>1</code>ï¼å°±ä¼å¼å§è¿è¡ä¸ç³»åèªå®ä¹çéç½®ãä½éå¸¸æåµä¸ï¼èèå°<code>.zshrc</code>æä»¶ä¸­åé¡¹éç½®çå¤ææ§ï¼æä»¬å¨è¿éå¹¶ä¸æ¨èè¯»èç´æ¥è¿è¡æå¨éç½®ï¼ä½¿ç¨ Oh-My-Zsh æ¥è¿è¡éç½®ä¼æ¯æ´å¥½çéæ©ã</p>
<h2 id="oh-my-zsh">Oh-My-Zsh</h2>
<p>Oh-My-Zsh æ¯ä¸æ¬¾ Zsh çéç½®ç®¡çå·¥å·ï¼å®æä¾äºä¸°å¯çä¸»é¢åæä»¶ï¼å¯ä»¥æå¤§å°ç¾åå½ä»¤è¡çé¢ï¼å¹¶æé«å·¥ä½æçãæä»¬éè¦è¿é¡¹å·¥å·çåå å¨äºï¼åçç Zsh è½ç¶å¾å¼ºå¤§ï¼ä½å­å¨çä»¥ä¸å ä¸ªéç½®ææ¬æ¹é¢çé®é¢ï¼</p>
<ul>
<li>ç¨å¤æçéç½®å°±éè¦ä½¿ç¨ç¼ç çæ¹å¼ä¿®æ¹<code>.zshrc</code>æä»¶ï¼</li>
<li>å½ä»¤çèªå¨è¡¥å¨åæç¤ºéè¦æå¨è°æï¼</li>
<li>å¼å¥ç¬¬ä¸æ¹ä¸»é¢ä¸æä»¶çç¸å³éç½®å°±æ´ä¸ºå¤æäºã</li>
</ul>
<p>è Oh-My-Zsh çä½ç¨å°±æ¯æè¿äºå¤æçéç½®ä¸æ¬¡æ§æåå¥½ï¼ç¡®ä¿å¼ç®±å³ç¨ï¼å®ç¸å¯¹äº Bashãåç Zsh çä¼å¿å¦è¡¨ 1 æç¤ºï¼</p>
<table>
<thead>
<tr>
<th>é¡¹ç®</th>
<th>Bash</th>
<th>åç Zsh</th>
<th>Oh My Zsh</th>
</tr>
</thead>
<tbody>
<tr>
<td>èªå¨è¡¥å¨</td>
<td>åºç¡</td>
<td>å¼º</td>
<td><strong>éå¸¸å¼º</strong></td>
</tr>
<tr>
<td>éç½®é¾åº¦</td>
<td>ä½</td>
<td>é«</td>
<td><strong>ä½</strong></td>
</tr>
<tr>
<td>æä»¶ç³»ç»</td>
<td>æ </td>
<td>æ </td>
<td><strong>æ</strong></td>
</tr>
<tr>
<td>ä¸»é¢</td>
<td>åºæ¬æ </td>
<td>æ</td>
<td><strong>å¤§éç°æ</strong></td>
</tr>
<tr>
<td>ä¸æéåº¦</td>
<td>å¿«</td>
<td>æ¢</td>
<td><strong>æå¿«</strong></td>
</tr>
</tbody>
</table>
<p><strong>è¡¨ 1</strong>ï¼Bashãåç Zsh ä¸ Oh My Zsh çå¯¹æ¯</p>
<p>å¨äºè§£ Oh-My-Zsh çåºæ¬ä¿¡æ¯ä»¥åæè½åæ¥çåè½ä¹åï¼æä»¬ç°å¨å°±æ¥æ¼ç¤ºä¸ä¸å®çå®è£æ­¥éª¤ï¼</p>
<ul>
<li>
<p>å¨å®è£ Oh-My-Zsh ä¹åï¼éè¦ç¡®ä¿æ¬å°å·²ç»å®è£äº Gitï¼å³äº Git çå®è£ä¸éç½®æ­¥éª¤ï¼è¯»èå¯åèæå¨ã[[Git ä½¿ç¨ç¬è®°]]ãä¸­çè®°å½ï¼</p>
</li>
<li>
<p>æå¼ Zsh ç»ç«¯çªå£ï¼å¹¶å¨ç¨æ·ç®å½ä¸ä½¿ç¨ curl æ wget å½ä»¤ä¸è½½ Oh-My-Zsh çå®è£èæ¬ï¼å¹¶æ§è¡å®ï¼</p>
<pre><code class="language-bash"># ä½¿ç¨ curl ä¸è½½èæ¬å¹¶å®è£ï¼
sh -c "$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"

# ä½¿ç¨ wget ä¸è½½èæ¬å¹¶å®è£ï¼
sh -c "$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)"
</code></pre>
</li>
<li>
<p>å¨æ§è¡ä¸è¿°å½ä»¤è¿ç¨ä¸­ï¼æä»¬éè¦åæ Oh-My-Zsh ä½¿ç¨èªèº«çéç½®æ¨¡æ¿è¦çå·²æç<code>.zshrc</code>æä»¶ï¼å¦å¾ 3 æç¤ºï¼ç±äºæå·²å®æéç½®ï¼ä¸ä¾¿æªå¾ï¼æ­¤å¤å¼ç¨æ¥èª<a href="https://www.haoyep.com/posts/zsh-config-oh-my-zsh/" target="_blank" rel="noopener nofollow">ç½ç»çæªå¾</a>ï¼ï¼</p>
  
<p><img alt="å¾ 3ï¼Oh-My-Zsh çå®è£çé¢" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202601/691082-20260106195313417-1869352098.png" class="lazyload"></p>
<p><strong>å¾ 3</strong>ï¼Oh-My-Zsh çå®è£è¿ç¨</p>
</li>
</ul>
<p>å¾å®è£é¡ºå©å®æä¹åï¼ç¨æ·ç<code>home</code>ç®å½ä¸ä¼åºç°ä¸ä¸ªåä¸º<code>.oh-my-zsh</code>çç®å½ï¼è¯¥ç®å½ä¸­å­å¨çå°±æ¯ Oh-My-Zsh æ¡æ¶æ¬èº«ï¼åå¶ä¸»é¢åæä»¶çå®ç°ä»£ç ãä¸é¢ï¼æä»¬ä»åè½æä»¶ãå¤è§éç½®ä¸å¿«æ·å½ä»¤ä¸ä¸ªæ¹é¢æ¥ä»ç»åºäº Oh-My-Zsh éç½® Zsh çä¸»è¦æ¹æ³ã</p>
<h3 id="åè½æä»¶">åè½æä»¶</h3>
<p>Oh-My-Zsh çæ ¸å¿ç«äºåä¸»è¦æ¥èªäºå®ææä¾çé£å¥æå·å¼æ¾æ§çï¼é«åº¦å¯å®å¶çæä»¶ç³»ç»ï¼è¿è®©æä»¬å¯ä»¥æ ¹æ®èªå·±çåå¥½è¿è¡éæ©åéç½®ï¼æé ä¸ä¸ªå¯æä¸ªæ§çå½ä»¤è¡ç»ç«¯çé¢ãä¸é¢æ¯æä¸ªäººå¸¸ç¨çä¸äºæä»¶åå¶ç¸å³ä»ç»ï¼</p>
<table>
<thead>
<tr>
<th>æä»¶</th>
<th>åè½</th>
<th>ä½¿ç¨è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>z</code></td>
<td>å¯å®ç°æºè½ç®å½è·³è½¬ã</td>
<td><code>z &lt;ç®å½å&gt;</code> ï¼è¯¥ç®å½éåå²è®°å½ä¸­åºç°è¿ï¼</td>
</tr>
<tr>
<td><code>git</code></td>
<td>å¯ç¨<code>ga</code>ã<code>gc</code>ç­å¿«æ·å½ä»¤ã</td>
<td><code>gc -m "commit message"</code></td>
</tr>
<tr>
<td><code>extract</code></td>
<td>æä¾<code>x</code>åç¼©åè§£åå½ä»¤ã</td>
<td><code>x file_name.tar.gz</code></td>
</tr>
<tr>
<td><code>web-search</code></td>
<td>å¯å®ç°ç½é¡µæç´¢ã</td>
<td><code>google &lt;æç´¢åå®¹&gt;</code>æ<code>baidu &lt;æç´¢åå®¹&gt;</code></td>
</tr>
<tr>
<td><code>you-should-use</code></td>
<td>å½ä»¤è¡éè¯¯æç¤ºåè½ã</td>
<td>å¨å½ä»¤è¾å¥éè¯¯æ¶ï¼ä¼ç»åºæ­£ç¡®çå½ä»¤æç¤ºã</td>
</tr>
<tr>
<td><code>zsh-completions</code></td>
<td>å½ä»¤è¡èªå¨è¡¥é½åè½ã</td>
<td>å¨è¾å¥å½ä»¤æ¶æ<code>Tab</code>é®ä¼èªå¨è¡¥é½ã</td>
</tr>
<tr>
<td><code>zsh-autosuggestions</code></td>
<td>å½ä»¤è¡èªå¨æç¤ºåè½ã</td>
<td>å¨è¾å¥å½ä»¤æ¶ä¼èªå¨ç»åºæç¤ºã</td>
</tr>
<tr>
<td><code>zsh-syntax-highlighting</code></td>
<td>å½ä»¤è¡è¯­æ³é«äº®åè½ã</td>
<td>å¨è¾å¥å½ä»¤æ¶ä¼æ ¹æ®è¯­æ³é«äº®ã</td>
</tr>
</tbody>
</table>
<p>å¨ Oh-My-Zsh ä¸­å®è£åå¯ç¨æä»¶éå¸¸å¯æç§ä»¥ä¸ä¸ä¸ªæ­¥éª¤æ¥è¿è¡ï¼å¦ææ¯èªå¸¦æä»¶ï¼åå¯è·³è¿ç¬¬ä¸æ­¥ï¼ï¼</p>
<ol>
<li>
<p>å¦ææä»¬è¦å¯ç¨çä¸æ¯ Oh-My-Zsh çåç½®æä»¶ï¼é£è¯¥æä»¶éå¸¸ä¼å¨ Github ä¸æç¬ç«çä»åºï¼äººä»¬éè¦åä½¿ç¨<code>git clone</code>å½ä»¤å°å¶ä¸è½½å° Oh-My-Zsh å®è£ç®å½ä¸ç<code>custom/plugins</code>ç®å½ä¸­ï¼èåç½®æä»¶åå·²å­å¨äº Oh-My-Zsh å®è£ç®å½ä¸ç<code>plugins</code>ç®å½ä¸­ï¼æ éä¸è½½ï¼ï¼ä¾å¦ï¼æä»¬ç°å¨è¦å¯ç¨çæ¯<code>zsh-autosuggestions</code>æä»¶ï¼è¿æ¯ä¸ä¸ªç¬¬ä¸æ¹æä»¶ï¼è¿å°±éè¦åæ§è¡ä»¥ä¸å½ä»¤ï¼å°å¶ä¸è½½å° Oh-My-Zsh å®è£ç®å½ä¸ç<code>custom/plugins</code>ç®å½ä¸­ï¼</p>
<pre><code class="language-bash">git clone https://github.com/zsh-users/zsh-autosuggestions $ZSH_CUSTOM/plugins/zsh-autosuggestions
</code></pre>
</li>
<li>
<p>ä½¿ç¨ vim è¿æ ·çææ¬ç¼è¾å¨æå¼<code>.zshrc</code>æä»¶ï¼å¹¶å¨å¶ä¸­æ¾å°<code>plugins</code>å­æ®µï¼å¹¶å°è¦å¯ç¨çæä»¶åç§°æ·»å å°è¯¥å­æ®µä¸­ï¼è¯¥å­æ®µçå¼æ¯ä¸ä¸ªç¨ç©ºç½ç¬¦åéçå­ç¬¦ä¸²ï¼ï¼ä¾å¦ï¼å¦ææä»¬ç°å¨è¦å¯ç¨çæä»¶åæ¬<code>z</code>ã<code>git</code>ã<code>extract</code>ã<code>web-search</code>ã<code>you-should-use</code>ã<code>zsh-completions</code>ã<code>zsh-autosuggestions</code>ã<code>zsh-syntax-highlighting</code>ï¼é£ä¹<code>.zshrc</code>æä»¶ä¸­<code>plugins</code>å­æ®µçå¼å°±è¯¥è¢«è®¾ç½®å¦ä¸ï¼</p>
<pre><code class="language-bash">plugins=(
    z 
    git
    extract
    web-search
    you-should-use 
    zsh-completions 
    zsh-autosuggestions 
    zsh-syntax-highlighting 
    zsh-history-substring-search
)
</code></pre>
</li>
<li>
<p>ä¿å­å¹¶å³é­<code>.zshrc</code>æä»¶ï¼ç¶åæ§è¡<code>source ~/.zshrc</code>æ<code>omz reload</code>å½ä»¤ä½¿éç½®çæãä¾å¦ï¼å¾ 4 æç¤ºçæ¯å¯ç¨<code>extract</code>æä»¶ä¹åï¼ä½¿ç¨<code>x</code>å½ä»¤è§£åæä»¶çææï¼</p>
 
<p><img alt="å¾ 4ï¼extract æä»¶çææ" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202601/691082-20260106195637290-2033293748.png" class="lazyload"></p>
<p><strong>å¾ 4</strong>ï¼extract æä»¶çææ</p>
</li>
</ol>
<h3 id="å¤è§éç½®">å¤è§éç½®</h3>
<p>å¨ Oh-My-Zsh ä¸­ï¼æä»¬å¯ä»¥éè¿ä¸ç§è¢«ç§°ä¹ä¸ºâä¸»é¢âçç¹æ®æä»¶æ¥éç½® Zsh çé¢æåç°çå¤è§ï¼ç®çæ¯éè¿åç§ç¹å®çé¢è²åæç¤ºä¿¡æ¯è®©å½ä»¤è¡çé¢çæç¨æ§åç¾è§æ§è¾¾å°ä¸ä¸ªå¹³è¡¡ãOh-My-Zsh åç½®äºå¤§éçä¸»é¢ï¼å®ä»¬é½è¢«å­æ¾å¨ Oh-My-Zsh å®è£ç®å½ä¸ç<code>themes</code>ç®å½ä¸­ï¼ä¹å¯ä»¥åå¾ <a href="https://github.com/ohmyzsh/ohmyzsh/wiki/Themes" target="_blank" rel="noopener nofollow">Oh-My-Zsh å®æ¹ææ¡£</a>æ¥çï¼ï¼å¦å¾ 5 æç¤ºï¼</p>

<p><img alt="å¾ 5ï¼Oh-My-Zsh åç½®çä¸»é¢" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202601/691082-20260106195719176-616308269.png" class="lazyload"></p>
<p><strong>å¾ 5</strong>ï¼Oh-My-Zsh åç½®çä¸»é¢</p>
<p>å¦ææä»¬æ³å¯ç¨ä¸è¿°ä»»æä¸ä¸ª Oh-My-Zsh çåç½®ä¸»é¢ï¼å°±åªéå°<code>.zshrc</code>æä»¶ä¸­ç<code>ZSH_THEME</code>åéå¼ä¿®æ¹ä¸ºè¯¥ä¸»é¢çåç§°å³å¯ï¼ä¾å¦ï¼åè®¾ç°å¨è¦å¯ç¨çæ¯<code>agnoster</code>ä¸»é¢ï¼æä»¬å°±åªéè¦æ§è¡ä»¥ä¸æ­¥éª¤ï¼</p>
<ul>
<li>
<p>åä½¿ç¨ vim è¿æ ·çææ¬ç¼è¾å¨æå¼<code>.zshrc</code>æä»¶ï¼</p>
</li>
<li>
<p>æ¾å°<code>ZSH_THEME</code>åéï¼å¹¶å°å®çå¼è®¾ç½®å¦ä¸å³å¯ï¼</p>
<pre><code class="language-bash">ZSH_THEME="agnoster" # é»è®¤ä¸»é¢ä¸º robbyrussell
</code></pre>
</li>
<li>
<p>ä¿å­å¹¶å³é­<code>.zshrc</code>æä»¶ï¼ç¶åæ§è¡<code>source ~/.zshrc</code>å½ä»¤ä½¿éç½®çæï¼å¶ææå¦å¾ 6 æç¤ºï¼</p>
  
<p><img alt="å¾ 6ï¼agnoster ä¸»é¢çææ" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202601/691082-20260106195816172-926042684.png" class="lazyload"></p>
<p><strong>å¾ 6</strong>ï¼agnoster ä¸»é¢çææ</p>
</li>
</ul>
<p>å½ç¶ï¼é¤äºä¸è¿°åç½®ä¸»é¢ä¹å¤ï¼æä»¬è¿å¯ä»¥éæ©å®è£å¶ä»å¼æºçä¸»é¢ï¼ä¾å¦ï¼<a href="https://github.com/romkatv/powerlevel10k" target="_blank" rel="noopener nofollow">powerlevel10k</a>å°±æ¯ä¸ä¸ªéå¸¸åæ¬¢è¿çï¼åè½å¼ºå¤§çä¸»é¢ï¼å®æä¾äºä¸°å¯çéç½®éé¡¹ï¼å¯ä»¥è®©æä»¬æé åºåç§ä¸ªæ§åçå½ä»¤è¡çé¢ï¼å¶å®è£ä¸éç½®æ­¥éª¤å¦ä¸ï¼</p>
<ol>
<li>
<p>ä½¿ç¨<code>git clone</code>å½ä»¤å°ä¸»é¢ä¸è½½å° Oh-My-Zsh å®è£ç®å½ä¸ç<code>custom/themes</code>ç®å½ä¸­ï¼</p>
<pre><code class="language-bash">git clone --depth=1 https://github.com/romkatv/powerlevel10k.git $ZSH_CUSTOM/themes/powerlevel10k
</code></pre>
</li>
<li>
<p>ä½¿ç¨ vim è¿æ ·çææ¬ç¼è¾å¨æå¼<code>.zshrc</code>æä»¶ï¼å¹¶å¨å¶ä¸­æ¾å°<code>ZSH_THEME</code>åéï¼å¹¶å°å®çå¼è®¾ç½®ä¸ºæä»¬ååä¸è½½çä¸»é¢åç§°å³å¯ï¼</p>
<pre><code class="language-bash">ZSH_THEME="powerlevel10k/powerlevel10k"
</code></pre>
</li>
<li>
<p>ä¿å­å¹¶å³é­<code>.zshrc</code>æä»¶ï¼ç¶åæ§è¡<code>source ~/.zshrc</code>æ<code>omz reload</code>å½ä»¤ä½¿éç½®çæãå¨è¯¥ä¸»é¢éç½®é¦æ¬¡çææ¶ä¼å¯å¨ä¸ä¸ªéç½®åå¯¼ï¼ä¹åä¹å¯ä»¥éè¿æ§è¡<code>p10k configure</code>å½ä»¤æ¥å¯å¨è¯¥åå¯¼ï¼ï¼å¼å¯¼æä»¬å®æä¸»é¢çéç½®ï¼å¦å¾ 7 æç¤ºï¼</p>
 
<p><img alt="å¾ 7ï¼powerlevel10k ä¸»é¢çéç½®åå¯¼" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202601/691082-20260106195900044-666707535.png" class="lazyload"></p>
<p><strong>å¾ 7</strong>ï¼powerlevel10k ä¸»é¢çéç½®åå¯¼</p>
</li>
<li>
<p>æ¥ä¸æ¥ï¼æä»¬åªéè¦æ ¹æ®ä¸è¿°éç½®åå¯¼çæç¤ºï¼æç§èªå·±çåæ¬¢ä¸æ­¥ä¸æ­¥å°ååºéæ©ï¼å°±å¯ä»¥å®æä¸»é¢çéç½®ï¼æä¸ªäººçéç½®ææå¦å¾ 8 æç¤ºï¼</p>
 
<p><img alt="å¾ 8ï¼powerlevel10k ä¸»é¢çéç½®ææ" loading="lazy" data-src="https://img2024.cnblogs.com/blog/691082/202601/691082-20260106195953413-92453986.png" class="lazyload"></p>
<p><strong>å¾ 8</strong>ï¼powerlevel10k ä¸»é¢çéç½®ææ</p>
</li>
</ol>
<h3 id="å¿«æ·å½ä»¤">å¿«æ·å½ä»¤</h3>
<p>å¯¹äºç±»ä¼¼äºè¿å¥æä¸ªç¹å®å·¥ä½ç®å½çå¸¸ç¨å½ä»¤ï¼Zsh æä¾äºä¸ç§è¢«ç§°ä¸º alias çæºå¶ï¼è®©æä»¬å¯ä»¥ä¸ºå¶è®¾ç½®ä¸ä¸ªå¿«æ·å½ä»¤ãä¾å¦ï¼<code>~/working/notes</code>ç®å½æ¯æä»¬æ¯æ¬¡åç¬è®°æ¶è¦æå¼çç®å½ï¼å¦ææä»¬æ³ä½¿ç¨ Zsh ç alias æºå¶ä¸º<code>cd ~/working/notes</code>å½ä»¤è®¾ç½®ä¸ä¸ªå¿«æ·å½ä»¤ï¼å°±å¯ä»¥ä½¿ç¨ vim ç¼è¾å¨æå¼å¨<code>.zshrc</code>æä»¶ï¼å¹¶å¨å¶ä¸­æ°å½çä½ç½®ä¸æ·»å å¦ä¸éç½®ï¼</p>
<pre><code class="language-bash">alias cd-notes="cd ~/working/notes"
</code></pre>
<p>éç½®å®æåï¼æä»¬å°±å¯ä»¥ä½¿ç¨<code>cd-notes</code>è¿ä¸ªå¿«æ·å½ä»¤å½ä»¤æ¥æ§è¡è¿å¥<code>~/working/notes</code>ç®å½äºãå½ç¶ï¼é¤äºæå¨éç½®ç Zsh alias ä¹å¤ï¼å¨å®è£äºOh-My-Zsh ä¹åï¼æä»¬è¿å¯ä»¥ä½¿ç¨è¯¥æ¡æ¶æåç½®çä¸ç³»åå¸¸ç¨ç aliasãä¾å¦å¨å¯ç¨äº<code>git</code>æä»¶ä¹åï¼æä»¬å°±å¯ä»¥ä½¿ç¨å®æä¾ç alias æ¥æ§è¡ git ç¸å³æä½äºï¼å·ä½å½ä»¤åè¡¨å¯æ¥é Oh-My-Zsh å®æ¹æä¾ç <a href="https://github.com/ohmyzsh/ohmyzsh/tree/master/plugins/git" target="_blank" rel="noopener nofollow">git æä»¶ææ¡£</a>ã</p>

</div>
<div class="clear"></div>

        <p class="postfoot">
            posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-06 20:01">2026-01-06 20:01</span>&nbsp;
<a href="https://www.cnblogs.com/owlman">åæ°</a>&nbsp;
éè¯»(<span id="post_view_count">26</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19449225);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19449225', targetLink: 'https://www.cnblogs.com/owlman/p/19449225', title: 'Zsh éç½®ç¬è®°' })">ä¸¾æ¥</a>

        </p>
     ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ C# ä¸ä¾èµ OpenCV çå¾åå¤çç®æ³ï¼æ»¤æ³¢ãéåä¸è¾¹ç¼æ£æµ ]]></title>
    <link>https://www.cnblogs.com/1312mn/p/19444713</link>
    <guid>8648fc63492903f5c871b5d8dd5e75bd</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/1312mn/p/19444713" title="åå¸äº 2026-01-06 14:28">
    <span role="heading" aria-level="2">C# ä¸ä¾èµ OpenCV çå¾åå¤çç®æ³ï¼æ»¤æ³¢ãéåä¸è¾¹ç¼æ£æµ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="åè¨">åè¨</h2>
<p>æ°å­å¾åå¤çä½ä¸ºè®¡ç®æºè§è§åå¤åªä½ææ¯çåºç¡åå®¹ï¼å¶æ ¸å¿ä¸ä»å¨äºçè§£ç®æ³åçï¼æ´å¨äºå¨æå®ç°ä¸éªè¯ãä¸ºäºæ·±å¥ææ¡æ¬é¡¹ç®éæ©ä»åºå±åç´ çº§å«åºåï¼ä½¿ç¨C#è¯­è¨æå¨å®ç°åç±»ç»å¸å¾åå¤çç®æ³ï¼é¿åä¾èµç°æçé«çº§å¾ååºã</p>
<p>è¿ç§"ä»é¶å¼å§"çæ¹å¼è½ç¶å¼åææ¬è¾é«ï¼å´è½çæ­£åæ¸æ¯ä¸ªæä½èåçæ°å­¦é»è¾ä¸å·¥ç¨ç»èï¼ä¹ä¸ºåç»­å­¦ä¹ æ´å¤æçè§è§ä»»å¡æä¸åå®åºç¡ã</p>
<h2 id="é¡¹ç®ä»ç»">é¡¹ç®ä»ç»</h2>
<p>é¡¹ç®æ¯ä¸ä¸ªåºäº.NET å¹³å°å¼åçæ¡é¢çº§æ°å­å¾åå¤çå·¥å·ï¼å¨éè¿å¾å½¢åçé¢ç´è§å±ç¤ºå¤ç§å¾åå¤çç®æ³çææã</p>
<p>æ´ä¸ªç³»ç»å´ç»System.Drawing.Bitmapç±»å¼åï¼ç´æ¥æä½åç´ æ°æ®å®æåç±»åæ¢ï¼æ¶µçå ä½æä½ãç°åº¦è°æ´ãåªå£°æ¨¡æãæ»¤æ³¢å»åªãè¾¹ç¼æ£æµãå¾ååå²ç­å¤ä¸ªæ¨¡åã</p>
<p>é¡¹ç®ä»£ç ç»ææ¸æ°ï¼åè½å®æ´ï¼æ¢å¯ç¨äºå­¦ä¹ åèï¼ä¹éåä½ä¸ºå¼åé¡¹ç®ã</p>
<h2 id="é¡¹ç®åè½">é¡¹ç®åè½</h2>
<p>1ãæ¯æå¾åçæå¼ãä¿å­ååºæ¬ä¿¡æ¯æ¾ç¤ºï¼å¦å°ºå¯¸ãé¢è²æ·±åº¦ç­ï¼</p>
<p>2ãæä¾ç°åº¦åè½¬æ¢ä¸ç°åº¦ç´æ¹å¾å¯è§ååè½</p>
<p>3ãå®ç°åºæ¬å ä½åæ¢ï¼æè½¬ãæ¾å¤§ãç¼©å°ãéå</p>
<p>4ãæ¯æçº¿æ§ç°åº¦åæ¢ä¸ç´æ¹å¾åè¡¡åä»¥å¢å¼ºå¾åå¯¹æ¯åº¦</p>
<p>5ãå¯æ·»å é«æ¯åªå£°ä¸æ¤çåªå£°ï¼å¹¶éå¥å¤ç§å»åªæ»¤æ³¢å¨</p>
<p>6ãéæå¤ç§è¾¹ç¼æ£æµç®å­ï¼RobertsãSobelãLaplacianãLoGãWallisãååæ¢¯åº¦ç­</p>
<p>7ãæä¾äºå¼åå¤çåè¿­ä»£éå¼åå²æ¹æ³</p>
<p>8ãåå«äºå¼å¾ååå¤çåè½ï¼å¦å­¤ç«ç¹å»é¤ãè½®å»æåãåºåæµéç­</p>
<p>9ãå®ç°éæ©å¼æ©èæ»¤æ³¢ï¼LSMFï¼ä¸KNNå¹³æ»æ»¤æ³¢ç­è¿é¶å»åªç­ç¥<br>
10ãåç½®å®æ´çæ¤éï¼Undoï¼ä¸éåï¼Redoï¼æºå¶ï¼ä¾¿äºæä½åæº¯ä¸ææå¯¹æ¯</p>
<h2 id="é¡¹ç®ç¹ç¹">é¡¹ç®ç¹ç¹</h2>
<p>1ãåæä»åç´ çº§å«æå¨å®ç°ç®æ³ï¼ä¸ä¾èµOpenCVç­å°è£åºï¼å¼ºååççè§£</p>
<p>2ãçé¢éç¨WPFæå»ºï¼äº¤äºåå¥½ï¼åæ°è¾å¥å¨æçæï¼æä½æµç¨æ¸æ°</p>
<p>3ãææå¤çæä½åå¯éï¼æ¯æå¤æ­¥åå²è®°å½ï¼æåå®éªçµæ´»æ§</p>
<p>4ãä»£ç æ¨¡ååç¨åº¦é«ï¼æ¯ä¸ªåè½å¯¹åºç¬ç«æ¹æ³ï¼ä¾¿äºéè¯»ä¸æ©å±<br>
5ãå¼é¡¾å®ç¨æ§ï¼æ¢è½éªè¯çè®ºï¼ä¹è½å¤ççå®å¾åä»»å¡</p>
<h2 id="é¡¹ç®ææ¯">é¡¹ç®ææ¯</h2>
<table>
<thead>
<tr>
<th>ææ¯ç±»å«</th>
<th>å·ä½è¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td>å¼åè¯­è¨</td>
<td>C#</td>
</tr>
<tr>
<td>è¿è¡å¹³å°</td>
<td>.NET Frameworkï¼ä½¿ç¨ <code>System.Drawing.Bitmap</code> å¤çä½å¾ï¼</td>
</tr>
<tr>
<td>UI æ¡æ¶</td>
<td>WPFï¼Windows Presentation Foundationï¼</td>
</tr>
<tr>
<td>å¾åæ°æ®è®¿é®</td>
<td>éè¿ <code>Bitmap.GetPixel</code> / <code>SetPixel</code> å <code>HBITMAP</code> æéä¸ WPF <code>Image</code> æ§ä»¶å¯¹æ¥</td>
</tr>
<tr>
<td>å³é®ç®æ³å®ç°</td>
<td>åçº¿æ§æå¼ï¼ç¨äºç¼©æ¾/æè½¬ï¼ãå·ç§¯æ ¸è¿ç®ï¼ç¨äºæ»¤æ³¢ä¸è¾¹ç¼æ£æµï¼ãç´æ¹å¾ç»è®¡ãåªå£°æ¨¡åæ¨¡æç­</td>
</tr>
<tr>
<td>è¾å©ææ¯</td>
<td>ä½¿ç¨ <code>Operation</code> ç±»å°è£æä½åå²ï¼æ¯æ Undo/Redoï¼éè¿ Interop è°ç¨ Win32 API å®ç°ä½å¾è½¬æ¢</td>
</tr>
</tbody>
</table>
<h2 id="é¡¹ç®ä»£ç ">é¡¹ç®ä»£ç </h2>
<h3 id="ä¸ºå¾çæ·»å é«æ¯åªå£°">ä¸ºå¾çæ·»å é«æ¯åªå£°</h3>
<pre><code class="language-csharp">/// &lt;summary&gt;
/// ä¸ºå¾çæ·»å é«æ¯åªå£°
/// &lt;/summary&gt;
private void GaussNoise(int k)
{
    Random ran = new Random(GetRandomSeed());
    Bitmap bmp_ = new Bitmap(bmp.Width, bmp.Height);
    for (int i = 0; i &lt; bmp.Width; i++)
    {
        for (int j = 0; j &lt; bmp.Height; j++)
        {
            double r1 = ran.NextDouble();
            double r2 = ran.NextDouble();
            double result = Math.Sqrt((-2) * Math.Log(r2)) * Math.Sin(2 * Math.PI * r1);
            result *= k;
            Color c = bmp.GetPixel(i, j);

            int rr = (int)(c.R + result),
                gg = (int)(c.G + result),
                bb = (int)(c.B + result);
            if (rr &gt; 255) rr = 255;
            else if (rr &lt; 0) rr = 0;
            if (gg &gt; 255) gg = 255;
            else if (gg &lt; 0) gg = 0;
            if (bb &gt; 255) bb = 255;
            else if (bb &lt; 0) bb = 0;
            bmp_.SetPixel(i, j, Color.FromArgb(c.A, rr, gg, bb));
        }
    }
    UpdateImg(ref bmp_);
}
</code></pre>
<h3 id="ä¸ºå¾çæ·»å æ¤çåªå£°">ä¸ºå¾çæ·»å æ¤çåªå£°</h3>
<pre><code class="language-csharp">/// &lt;summary&gt;
/// ä¸ºå¾çæ·»å æ¤çåªå£°
/// &lt;/summary&gt;
/// &lt;param name="SNR"&gt;ä¿¡åªæ¯&lt;/param&gt;
/// &lt;param name="pa"&gt;å¾çä¸ºæç¹çæ¦ç&lt;/param&gt;
private void SaltNoise(double SNR, double pa)
{
    // åªå£°ç¹çæ°é
    int NP = (int)(bmp.Width * bmp.Height * (1 - SNR));
    Bitmap bmp_ = new Bitmap(bmp);
    Random rand = new Random();
    for (int i = 0; i &lt; NP; i++)
    {
        int r = rand.Next(0, bmp.Height), c = rand.Next(0, bmp.Width);
        double prob = rand.NextDouble();
        if (prob &gt; pa)
        {
            bmp_.SetPixel(c, r, Color.FromArgb(255, 255, 255));
        }
        else
        {
            bmp_.SetPixel(c, r, Color.FromArgb(0, 0, 0));
        }
    }
    UpdateImg(ref bmp_);
}
</code></pre>
<h2 id="é¡¹ç®ææ">é¡¹ç®ææ</h2>
<p>é¡¹ç®è¿è¡ç¨³å®ï¼è½å¤åç¡®è¿ååç±»ç»å¸å¾åå¤çç®æ³çé¢æææãä¾å¦ï¼å¨å¯¹èªç¶å¾åè¿è¡ç°åº¦ååï¼ç´æ¹å¾åè¡¡åæ¾èæåäºæ´ä½å¯¹æ¯åº¦ï¼æ·»å æ¤çåªå£°åï¼ä¸­å¼æ»¤æ³¢æææå¶äºåªç¹èä¿çè¾¹ç¼ï¼ä½¿ç¨SobelæLoGç®å­å¯æ¸æ°æåç©ä½è½®å»ã</p>
<p><img src="https://img2024.cnblogs.com/blog/576536/202601/576536-20260105210103962-1763205682.png" width="50%" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p><img src="https://img2024.cnblogs.com/blog/576536/202601/576536-20260105210118061-1765878502.png" width="50%" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p><img src="https://img2024.cnblogs.com/blog/576536/202601/576536-20260105210140975-938016934.png" width="50%" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p><img src="https://img2024.cnblogs.com/blog/576536/202601/576536-20260105210152223-942589643.png" width="50%" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<h2 id="æ»ç»">æ»ç»</h2>
<p>é¡¹ç®ä¸ä»æ¯ä¸æ¬¡è§è§çå­¦ä¹ ï¼æ´æ¯ä¸åºå¯¹æ°å­å¾åå¤çç¥è¯ä½ç³»çæ·±åº¦å®è·µãéè¿äº²æç¼åæ¯ä¸ä¸ªåç´ æä½ï¼å¯ä»¥ç©¿éAPIçé»ç®±ï¼çæ­£çè§£"å¾å"å¨è®¡ç®æºä¸­çè¡¨ç¤ºæ¹å¼ä»¥ååç±»åæ¢çæ¬è´¨ãè¿ç§èªåºåä¸çå­¦ä¹ è·¯å¾ï¼è½ç¥æ¾ç¬¨æï¼å´æä¸ºæå®ãå¯¹äºå¸æå¤¯å®å¾åå¤çåºç¡çå¤§å®¶èè¨ï¼è¿ä¸ªé¡¹ç®æ çæ¯ä¸éçåèã</p>
<h2 id="å³é®è¯">å³é®è¯</h2>
<p>æ°å­å¾åå¤çãC#ãåç´ æä½ãå ä½åæ¢ãç°åº¦åæ¢ãåªå£°æå¶ãè¾¹ç¼æ£æµãå¾ååå²ãWPFãç´æ¹å¾åè¡¡å</p>
<h2 id="æå">æå</h2>
<p>å¦æä½ è§å¾è¿ç¯æç« å¯¹ä½ æå¸®å©ï¼ä¸å¦¨ç¹ä¸ªèµæ¯æä¸ä¸ï¼ä½ çæ¯ææ¯æç»§ç»­åäº«ç¥è¯çå¨åãå¦ææä»»ä½çé®æéè¦è¿ä¸æ­¥çå¸®å©ï¼æ¬¢è¿éæ¶çè¨ã</p>
<p>ä¹å¯ä»¥å å¥å¾®ä¿¡å¬ä¼å·[DotNetææ¯å ] ç¤¾åºï¼ä¸å¶ä»ç­ç±ææ¯çåè¡ä¸èµ·äº¤æµå¿å¾ï¼å±åæé¿ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/576536/202505/576536-20250527195524293-1794896295.png" width="50%" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.0006944444444444445" data-date-updated="2026-01-06 14:29">2026-01-06 14:28</span>&nbsp;
<a href="https://www.cnblogs.com/1312mn">å°ç ç¼å </a>&nbsp;
éè¯»(<span id="post_view_count">326</span>)&nbsp;
è¯è®º(<span id="post_comment_count">2</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19444713);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19444713', targetLink: 'https://www.cnblogs.com/1312mn/p/19444713', title: 'C# ä¸ä¾èµ OpenCV çå¾åå¤çç®æ³ï¼æ»¤æ³¢ãéåä¸è¾¹ç¼æ£æµ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä¸ºä»ä¹è¯´ IO æä½å¼æ­¥æææä¹ ]]></title>
    <link>https://www.cnblogs.com/kklldog/p/19449864</link>
    <guid>b14a7327c3b1ad104ba0c77fa47e814e</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/kklldog/p/19449864" title="åå¸äº 2026-01-07 01:32">
    <span role="heading" aria-level="2">ä¸ºä»ä¹è¯´ IO æä½å¼æ­¥æææä¹</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>ä¸ºä»ä¹è¯´ IO æä½å¼æ­¥æææä¹ï¼CPU å¯éæä½å¼æ­¥æ²¡ææä¹</p>
<h2 id="èæ¯ä¸é®é¢">èæ¯ä¸é®é¢</h2>
<p>å¨åç«¯å¼åä¸­ï¼æä»¬ç»å¸¸è®¨è®ºå¼æ­¥ç¼ç¨æ¨¡åï¼å°¤å¶æ¯å¨ Node.jsãNetty ç­ææ¯æ ä¸­ãä¸ä¸ªæ®éçå±è¯æ¯ï¼å¼æ­¥å¯¹äº IO æä½ æææ¾èï¼èå¯¹äº CPU å¯éåæä½ å´æä¹ä¸å¤§ï¼çè³å¯è½èµ·åä½ç¨ãè¿èåçåå æ¯ä»ä¹ï¼</p>
<p>æ¬æçç®æ å°±æ¯æ·±å¥è®¡ç®æºçåºå±è¿è¡æºå¶ï¼ä»æ ¹æ¬ä¸è§£éæ¸æ¥è¿ä¸¤ç±»æä½çæ¬è´¨åºå«ï¼ä»èéæå¼æ­¥ççæ­£ä»·å¼æå¨ã</p>
<hr>
<h2 id="æ ¸å¿åçä¸ç±»æ¯">æ ¸å¿åçä¸ç±»æ¯</h2>
<p>è¦çè§£è¿ä¸ªé®é¢çæ ¸å¿ï¼å³é®å¨äºåç­ä¸ä¸ªé®é¢ï¼å¨æ§è¡ä»»å¡æ¶ï¼CPU å°åºæ¯å¨âç­å«äººå¹²æ´»âï¼è¿æ¯å¨âèªå·±äº²èªå¹²æ´»âï¼</p>
<h3 id="æ ¸å¿é»è¾è°å¨å¹²æ´»ä¸ä¸ªé¤åçæ¯å»">æ ¸å¿é»è¾ï¼è°å¨å¹²æ´»ï¼ä¸ä¸ªé¤åçæ¯å»</h3>
<p>æä»¬å¯ä»¥ç¨ä¸ä¸ªç®åçé¤åæ¨¡åæ¥ç´è§å°çè§£ã</p>
<h3 id="io-æä½å¼æ­¥ææç¨çåºæ¯">IO æä½ï¼å¼æ­¥ææç¨çåºæ¯ï¼</h3>
<ol>
<li>åºæ¯å®ä¹: å¸åç IO æä½åæ¬è¯»åæä»¶ãè¯·æ±æ°æ®åºãè®¿é®ç½ç»æ¥å£ç­ã</li>
<li>æ ¸å¿ç¹å¾: IO æä½çæ ¸å¿ç¹å¾æ¯ CPU å¨å¤§é¨åæ¶é´éé½å¨âç­âãå¯¹äº CPU èè¨ï¼è¿äºæä½ææ¢ãCPU æ§è¡æä»¤çéåº¦æ¯çº³ç§çº§ (ns)ï¼èä¸æ¬¡ç½ç»æç£ç IO çèæ¶æ¯æ¯«ç§çº§ (ms)ï¼ä¸¤èç¸å·®æ°ä¸ªæ°éçº§ã</li>
</ol>
<h3 id="å¾®æ³¢çæ¯å»">å¾®æ³¢çæ¯å»:</h3>
<ul>
<li>è¿ä¸ªè¿ç¨å¥½æ¯ä½ ï¼CPUï¼å¨é¤ååå¨ç¨å¾®æ³¢çç­é¥­ï¼æ§è¡ IO æä½ï¼ãçæ­£å¹²æ´»çæ¯å¾®æ³¢çï¼ç¡¬ç/ç½å¡ï¼ãå·¨å¤§çéåº¦å·®å¼æå³çï¼ä½ æä¸ä¸å¾®æ³¢ççå¼å³ï¼åé IO è¯·æ±ï¼ï¼ç¶åå¾®æ³¢çå¯è½éè¦è½¬å¾é¿æ¶é´æè½æé¥­ç­å¥½ã</li>
<li>åæ­¥æ¨¡å¼ï¼ä½ æä¸å¾®æ³¢ççå¼å³ï¼ç¶ååä¸ªéåä¸æ ·ç«å¨å®é¢åå¹²ç­ï¼ç´å°é¥­ç­å¥½ãå¨è¿æé´ï¼ä½ ä»ä¹å«çäºä¹åä¸äºï¼è¿æå¤§å°æµªè´¹äº CPU èµæºã</li>
<li>å¼æ­¥æ¨¡å¼ï¼ä½ æä¸å¼å³ï¼å®ä¸ªé¹éï¼è®¾ç½®åè°ï¼ï¼ç¶åå°±ç«å»è½¬èº«å»åèãææ«å«çãç­å¾®æ³¢çâå®âçä¸å£°ï¼ä¸­æ­éç¥ï¼ï¼ä½ ååæ¥å¤çç­å¥½çé¥­ãè¿ç§æ¨¡å¼æå¤§å°æåäº CPU å©ç¨çã</li>
</ul>
<h3 id="ç»è®º">ç»è®º</h3>
<p>IO æä½éåå¼æ­¥ï¼å ä¸ºå·¥ä½ä¸»è¦ç±å¤é¨è®¾å¤å®æï¼CPU æ¬èº«å¤äºé²ç½®ç¶æãå¼æ­¥ç¼ç¨æ¨¡åå¯ä»¥ææå©ç¨è¿æ®µå®è´µçé²ç½®æ¶é´å»å¤çå¶ä»ä»»å¡ã</p>
<h3 id="cpu-å¯éæä½å¼æ­¥æä¹ä¸å¤§">CPU å¯éæä½ï¼å¼æ­¥æä¹ä¸å¤§ï¼</h3>
<p>åºæ¯å®ä¹: å¸åç CPU å¯éåæä½åæ¬è§é¢è½¬ç ãæ°æ®å å¯è§£å¯ãå¤æçæ°å­¦è®¡ç®ãè®­ç»ç¥ç»ç½ç»ç­ã</p>
<h3 id="åé¸è¾£åè±ä¸æ¯å»">åé¸è¾£åè±ä¸æ¯å»:</h3>
<ul>
<li>è¿ä¸ªè¿ç¨å¥½æ¯å°çº¢æ³è¦(CPU main thread)åä¸çé¸è¾£åè±ä¸ï¼CPU å¯éæä½ï¼ã</li>
<li>å¨è¿ç§åºæ¯ä¸å¼ºè¡âå¼æ­¥âï¼è¡ä¸ºå°±åæäºï¼å°çº¢å¼å«å°æï¼CPU another threadï¼æ¥æ¿å¥¹ååè±ï¼å¥¹è·å»æ¦æ¡å­,ç­å°æåå¥½åè±ä¸äºï¼å°çº¢ååæ¥ç»§ç»­èµ·æ²¹éç§åè±ä¸ã</li>
<li>è¿ç§è¡ä¸ºçåææ¯ï¼ååè±ä¸çæ»å·¥ä½éä¸ç¹æ²¡å°ï¼åèå ä¸ºå°çº¢å¨åè±ä¸åå¥½ååæ¬¡æ¥ç®¡ç§èè¿ä»¶äºèå¼å¥äºé¢å¤çâä¸ä¸æåæ¢å¼éâï¼å¯¼è´æ´ä½æçåå¾æ´ä½ã</li>
<li>å¯è½æåå­¦ä¸çè§£ï¼è§å¾è¿ä¸ªæ²¡é®é¢åï¼å°çº¢ææç©ºåºæ¥äºåï¼å»åå«çäºæäºåï¼è¿ä¸æ¯æçæé«äºåï¼ççæ¯è¿æ ·åï¼å°çº¢ä¸å¼å«å°æååè±ï¼é£å°æè¿æ¶åä¹æ¯ç©ºé²çåãå°æç´æ¥å»æ¦æ¡å­ï¼å°çº¢ç´æ¥ååè±ä¸ç¶åç§åè±ä¸ï¼è¿ä¸ªè¿ç¨ææ¯æçæé«çã</li>
</ul>
<h3 id="ç»è®º-1">ç»è®º</h3>
<p>CPU å¯éåä»»å¡ä¸éåå¼æ­¥ï¼å ä¸ºè°åº¦å¶ä»çº¿ç¨æ¥å®æ CPU å¯éæä½çæçä¸å¦å½åçº¿ç¨ç´æ¥è®¡ç®é«ãå¼ºè¡åæ¢ä»»å¡åªä¼å¸¦æ¥ä¸å¿è¦çå¼éã</p>
<h2 id="æ·±å¥ææ¯è§è§è®¡ç®æºå¦ä½å¤çä»»å¡">æ·±å¥ææ¯è§è§ï¼è®¡ç®æºå¦ä½å¤çä»»å¡</h2>
<p>ä»æ´ææ¯çå±é¢æ¥çï¼è¿ä¸¤ç§åºæ¯çåºå±æºå¶å·®å¼å·¨å¤§ã</p>
<h3 id="io-å¯éådma-çåå³">IO å¯éåï¼DMA çåå³</h3>
<p>CPU å¨æ§è¡ IO æä½æ¶ä¹æä»¥å¯ä»¥âè±èº«âï¼å³é®å¨äº DMAï¼ç´æ¥å­å¨å¨è®¿é®ï¼ æºå¶ã</p>
<p>å½æä»¬çä»£ç æ§è¡ä¸ä¸ª IO è¯·æ±ï¼ä¾å¦ Node.js ä¸­ç fs.readFile()ï¼æ¶ï¼CPU å®éä¸åªæ¯åç£çæ§å¶å¨ä¸è¾¾ä¸ä¸ªæä»¤ï¼âæè¿ä¸ªæä»¶çæ°æ®è¯»å°åå­çè¿ä¸ªä½ç½®ï¼å®æåéç¥æãâ</p>
<p>æä»¤ä¸è¾¾åï¼CPU å°±ç«å»è¢«éæ¾ï¼å¯ä»¥å»å¤çå¶ä»ä»»å¡äºãçæ­£çæ°æ®æ·è´å·¥ä½ç± DMA æ§å¶å¨å¨æè´è´£ï¼å®ä¼å¨ç£çååå­ä¹é´ç´æ¥æ¬è¿æ°æ®ï¼æ´ä¸ªè¿ç¨ä¸éè¦å ç¨ CPUãå·¥ä½å®æåï¼DMA ä¼éè¿ä¸ä¸ªä¸­æ­ä¿¡å·éç¥ CPUã</p>
<p>å æ­¤ï¼è¿ä¸ªè¿ç¨å¯ä»¥ç²¾ç¼å°æ»ç»ä¸ºï¼å¼æ­¥ IO = CPU å¤åå·¥ä½ + ä¸­æ­éç¥ã</p>
<h3 id="cpu-å¯éåçº¿ç¨çç«äº">CPU å¯éåï¼çº¿ç¨çç«äº</h3>
<p>å¯¹äº CPU å¯éåä»»å¡ï¼æåµå®å¨ä¸åãè¿ç±»ä»»å¡éè¦æç»­å ç¨ CPU çæ ¸å¿è®¡ç®èµæºï¼ä¾å¦ ALUï¼ç®æ¯é»è¾ååï¼ åå¯å­å¨ã</p>
<ul>
<li>åçº¿ç¨é»å¡: å¨ä¸ä¸ªåçº¿ç¨ç¯å¢ï¼å¦ Node.js ä¸»çº¿ç¨ï¼ä¸­æ§è¡ä¸ä¸ªèæ¶å¾é¿çè®¡ç®ä»»å¡ï¼ä¼å¯¼è´æ´ä¸ªç¨åºåæ­»ãå ä¸º CPU å¨åå¨è®¡ç®ï¼æ ¹æ¬æ æååºä»»ä½å¶ä»äºä»¶ï¼å¦ç½ç»è¯·æ±ãç¨æ·ç¹å»ï¼ã</li>
<li>å¤çº¿ç¨å¼é: å¨å¤çº¿ç¨ç¯å¢ä¸­ï¼å¦æå¤§éå¹¶åç CPU å¯éåä»»å¡å¨å°æ°å ä¸ª CPU æ ¸å¿ä¸è¿è¡ï¼ä¼å¯¼è´ CPU é¢ç¹è¿è¡ä¸ä¸æåæ¢ (Context Switch)ãæä½ç³»ç»éè¦ä¸æ­å°ä¿å­å½åçº¿ç¨çè¿è¡ç¶æï¼ä¾å¦å¯å­å¨éçå¼ãç¨åºè®¡æ°å¨ç­ï¼ï¼åå è½½ä¸ä¸ä¸ªçº¿ç¨çç¶æãè¿ä¸ªâä¿å­ç°åºâåâæ¢å¤ç°åºâçè¿ç¨æ¬èº«å°±ä¼æ¶èå¤§é CPU èµæºï¼å¯¼è´å®éç¨äºè®¡ç®çæ¶é´åå°ã</li>
</ul>
<h2 id="ç¹æ®æåµä½æ¶-cpu-æä½éè¦å¼æ­¥">ç¹æ®æåµï¼ä½æ¶ CPU æä½éè¦âå¼æ­¥âï¼</h2>
<p>è½ç¶ CPU å¯éåæä½éè¿å¼æ­¥æ æ³æé«æ´ä½ååéï¼ä½å¨ä¸ç§ç¹æ®åºæ¯ä¸ï¼è¿ç§âå¼æ­¥âæ¯ææä¹çã</p>
<ol>
<li>æ ¸å¿ç®ç: æ­¤æ¶ï¼å¼æ­¥çç®çä¸åæ¯æåæçï¼èæ¯ä¸ºäºä¿æååºæ§ (Responsiveness)ã</li>
<li>åºæ¯ä¸¾ä¾: æå¸åçå°±æ¯ GUI çé¢ï¼ä¾å¦æµè§å¨ãåè®¾ä½ å¨ç½é¡µä¸­ç¨ JavaScript æ§è¡ä¸ä¸ªå¤§è§æ¨¡çåæ­¥è®¡ç®ï¼UI æ¸²æçº¿ç¨ä¼è¢«å®å¨é»å¡ï¼å¯¼è´é¡µé¢å¡æ­»ï¼ç¨æ·æ æ³è¿è¡ä»»ä½æä½ã</li>
<li>è§£å³æ¹æ¡: æä»¬å¯ä»¥éè¿ Web Worker å°è®¡ç®ä»»å¡æ¾å°ä¸ä¸ªç¬ç«ççº¿ç¨ä¸­ï¼æèä½¿ç¨ setTimeout å°å¤§ä»»å¡æåæè®¸å¤å°ååçæ§è¡ã</li>
<li>æ¬è´¨åæ: è¿ç§âå¼æ­¥åâå¤çå¹¶æ²¡æåå°æ»çè®¡ç®æ¶é´ï¼çè³å¯è½å ä¸ºåæ¢å¼éèåæ¢ï¼ï¼ä½å®çæ ¸å¿ä»·å¼å¨äºé¿åä¸»çº¿ç¨è¢«å µå¡ï¼ä»èä¿è¯äºçé¢çæµçåç¨æ·çäº¤äºä½éªã</li>
</ol>
<hr>
<h2 id="æ»ç»ä¸å»¶ä¼¸">æ»ç»ä¸å»¶ä¼¸</h2>
<p>éè¿ä»¥ä¸çåæï¼æä»¬å¯ä»¥æ¸æ°å°çå° IO å¯éåå CPU å¯éåä»»å¡å¨æ¬è´¨ä¸çåºå«ï¼ä»¥åå¼æ­¥æ¨¡åéç¨æ§çæ ¹æºã</p>
<table>
<thead>
<tr>
<th style="text-align: left">ç¹æ§</th>
<th style="text-align: left">IO å¯éå (IO-Bound)</th>
<th style="text-align: left">CPU å¯éå (CPU-Bound)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left"><strong>ä¸»è¦ç¶é¢</strong></td>
<td style="text-align: left">ç½ç»ãç¡¬çãæ°æ®åº</td>
<td style="text-align: left">CPU è®¡ç®è½å</td>
</tr>
<tr>
<td style="text-align: left"><strong>CPU ç¶æ</strong></td>
<td style="text-align: left">å¤§é¨åæ¶é´å¨ç­å¾</td>
<td style="text-align: left">å¤§é¨åæ¶é´å¨å¨éè¿è½¬</td>
</tr>
<tr>
<td style="text-align: left"><strong>å¼æ­¥çä»·å¼</strong></td>
<td style="text-align: left">æé«ãå©ç¨ç­å¾æ¶é´å¤çå¶ä»å¹¶åè¯·æ±ï¼é«å¹¶åçæ ¸å¿ï¼ã</td>
<td style="text-align: left">ä½ãåæ¢å¶ä»çº¿ç¨æ¥ä»£æ¿å½åçº¿ç¨è®¡ç®ä¸ä¼ææ§è½æåï¼åªè¦å¼é</td>
</tr>
<tr>
<td style="text-align: left"><strong>å¸åä¾å­</strong></td>
<td style="text-align: left">Web æå¡å¨æ¥å£ãæä»¶ä¸ä¼ ä¸è½½</td>
<td style="text-align: left">è§é¢åç¼©ãåºåé¾æç¿ãå¾åæ¸²æ</td>
</tr>
<tr>
<td style="text-align: left"><strong>æä½³ç­ç¥</strong></td>
<td style="text-align: left">å¼æ­¥éé»å¡ (Async/Await, Reactive)</td>
<td style="text-align: left">å¤è¿ç¨ãå¤çº¿ç¨å¹¶è¡ (Parallelism)</td>
</tr>
</tbody>
</table>
<p>ä¸å¥è¯æ»ç»ï¼</p>
<p>å¼æ­¥æ¯ä¸ºäºå¡«è¡¥ CPU çç©ºçªæãIO æä½æå·¨å¤§çç©ºçªæï¼æä»¥å¼æ­¥ææä¹ï¼CPU å¯éæä½åæ¢å¶ä»çº¿ç¨æ¥ä»£æ¿å½åçº¿ç¨è®¡ç®ä¸ä¼ææ§è½æåï¼åªè¦å¼éã</p>
<h2 id="å³æ³¨æçå¬ä¼å·ä¸èµ·ç©è½¬ææ¯">å³æ³¨æçå¬ä¼å·ä¸èµ·ç©è½¬ææ¯</h2>
<p><img src="https://static.xbaby.xyz/qrcode.jpg" alt="" loading="lazy"></p>

</div>
<div id="MySignature" role="contentinfo">
    <div id="AllanboltSignature">        
<p id="PSignature" style="border-top: #e0e0e0 1px dashed; border-right: #e0e0e0 1px dashed; border-bottom: #e0e0e0 1px dashed; border-left: #e0e0e0 1px dashed; padding-top: 10px; padding-right: 10px; padding-bottom: 10px; padding-left: 10px; font-family: å¾®è½¯éé»; font-size: 11px">       
QQç¾¤ï¼1022985150 VXï¼kklldog ä¸èµ·æ¢è®¨å­¦ä¹ .NETææ¯
<br>
ä½èï¼<a href="http://www.cnblogs.com/kklldog" target="_blank">Agile.Zhou(kklldog)</a>            
<br> 
åºå¤ï¼<a href="http://www.cnblogs.com/kklldog/" target="_blank">http://www.cnblogs.com/kklldog/</a>
<br>æ¬æçæå½ä½èååå®¢å­å±æï¼æ¬¢è¿è½¬è½½ï¼ä½æªç»ä½èåæå¿é¡»ä¿çæ­¤æ®µå£°æï¼ä¸å¨æç« é¡µé¢ææ¾ä½ç½®ç»åºåæè¿æ¥ï¼å¦åä¿çè¿½ç©¶æ³å¾è´£ä»»çæå©ã
 </p>  
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-07 01:32">2026-01-07 01:32</span>&nbsp;
<a href="https://www.cnblogs.com/kklldog">Agile.Zhou</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19449864);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19449864', targetLink: 'https://www.cnblogs.com/kklldog/p/19449864', title: 'ä¸ºä»ä¹è¯´ IO æä½å¼æ­¥æææä¹' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>