<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-01-05T04:54:09.242Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ æºè½ä½æ¶ä»£çè¯­è¨å¤å´ï¼ä» TIOBE 2025 å¹´åº¦è¯­è¨å° 2026 å¹´ C# æºè½ä½çæçå¨é¢å´èµ· ]]></title>
    <link>https://www.cnblogs.com/shanyou/p/19441004</link>
    <guid>e7f4eb509e6aae048e861a773593da08</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/shanyou/p/19441004" title="åå¸äº 2026-01-05 09:21">
    <span role="heading" aria-level="2">æºè½ä½æ¶ä»£çè¯­è¨å¤å´ï¼ä» TIOBE 2025 å¹´åº¦è¯­è¨å° 2026 å¹´ C# æºè½ä½çæçå¨é¢å´èµ·</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><font face="å¾®è½¯éé» Light" size="3">2026 å¹´ 1 æï¼éç TIOBE ææ°æ­£å¼å®£å¸ C# ä¸º 2025 å¹´åº¦ç¼ç¨è¯­è¨ï¼å¨çè½¯ä»¶å·¥ç¨é¢åè¿æ¥äºä¸ä¸ªå³å®æ§çè½¬æç¹ [1]ãè¿ä¸è£èªä¸ä»æ¯å¯¹ C# è¿å»ä¸å¹´å¨æç´¢ç­åº¦åå¼åèæ´»è·åº¦ä¸åå¾æå¤§å¢å¹çè®¤å¯ï¼æ´æ¯ä¸ä¸ªæ»åææ ï¼æ­ç¤ºäºåºå±ææ¯èå¼çæ·±å»åè¿ãå¦æè¯´è¿å»åå¹´æ¯ Python ä¾é æ°æ®ç§å­¦åæ¨¡åè®­ç»ç¡®ç«é¸æçæ¶ä»£ï¼é£ä¹ 2025 å¹´çæ°æ®è¡¨æï¼è¡ä¸éå¿æ­£å¨ä»âæ¨¡åæå»ºâåâç³»ç»ç¼æâè½¬ç§»ã</font></p><p><font face="å¾®è½¯éé» Light" size="3">éçäººå·¥æºè½ä»çæå¼åå®¹ï¼Generative AIï¼åæºè½ä½ç³»ç»ï¼Agentic AIï¼æ¼è¿ï¼ä¼ä¸å¯¹å¼åè¯­è¨çéæ±åçäºæ ¹æ¬æ§ååãæºè½ä½ç³»ç»è¦æ±å·å¤é¿å¨æçç¶æç®¡çãå¤æçå¹¶åå¤çè½åãç¡®å®æ§çç±»åå®å¨ä»¥åä¼ä¸çº§çå¯è§æµæ§ââè¿äºæ­£æ¯ C# å.NET çæç³»ç»çä¼ ç»å¼ºé¡¹ã</font></p><h1><font face="å¾®è½¯éé» Light"><font size="3">ä¸ã</font><font size="3">TIOBE 2025 å¤å³ï¼å¼åèæç»ªçç»ææ§è½¬å</font></font></h1><font size="3"></font><font size="3"></font><h5><font size="3"><font face="å¾®è½¯éé» Light" style="font-weight: normal">1.1 èå©çè§£åå­¦ï¼C# çäºæ¬¡å å</font></font></h5><p><font face="å¾®è½¯éé» Light" size="3">2026 å¹´åï¼TIOBE ææ°å¬å¸äº 2025 å¹´çå¹´åº¦ç¼ç¨è¯­è¨å¾ä¸»ââC# [1]ãè¿æ¯ C# å¨ä¸å¹´åç¬¬äºæ¬¡è·æ­¤æ®è£ï¼ä¸ä¸æ¬¡æ¯å¨ 2023 å¹´ï¼ï¼æ å¿çå¶ä»ä¸ç§è¢«è§ä¸ºâä¼ ç»ä¼ä¸çº§è¯­è¨âçè§è²ï¼æåè½¬åä¸ºç°ä»£äºåçå AI åºç¨çæ ¸å¿åé ãTIOBE çè¯éæ åå¹¶éåºäºç»å¯¹å¸åºä»½é¢ï¼èæ¯åºäºå¹´åº¦å¢é¿çï¼è¿ä½¿å¶æä¸ºææå¼åèå´è¶£è¿ç§»çæä½³é£åæ ã</font></p><p><font face="å¾®è½¯éé» Light" size="3">æ°æ®æ¾ç¤ºï¼å°½ç®¡ Python ä¾ç¶å­åå¶å¨æ°æ®ç§å­¦ååçº§ç¼ç¨æå­¦ä¸­çç»å¯¹ä¼å¿å æ®æ»æ¦é¦ä½ï¼ä½å¶å¢é¿æ²çº¿å·²å¨ 2025 å¹´åºç°ææ¾çå¹³å°æ ãç¸æ¯ä¹ä¸ï¼C# å±ç°åºäºå¼ºå²çâé¿å°¾æåºâï¼ä¸ä»ç¨³åºäºå¶å¨æ¸¸æå¼åï¼Unityï¼åä¼ä¸åç«¯ï¼ASP.NET Coreï¼çåºæ¬çï¼æ´å¨ AI å·¥ç¨åé¢åå®ç°äºçåå¼å¢é¿ ãTIOBE CEO Paul Jansen æåºï¼C# æ­£å¨ä»¥åææªæçéåº¦èé£ Java çå¸åºä»½é¢ï¼ä¸¤èå¨ 2025 å¹´åºçå·®è·å·²ç¼©å°è³ä¸è¶³ 1 ä¸ªç¾åç¹ ãè¿ç§æ­¤æ¶å½¼é¿çæå¿ï¼å®éä¸åæ äºå·¥ä¸çå¯¹äºæå»ºå¤§è§æ¨¡ãé«æ§è½ AI åºç¨ç³»ç»çå¡å®éæ©ã</font></p><p></p><h5><font face="å¾®è½¯éé» Light" size="3"><font style="font-weight: normal">1.2 è¶è¶è¯­æ³çé©±å¨åï¼ä¸ºä½æ¯ 2025ï¼</font></font></h5><p><font face="å¾®è½¯éé» Light" size="3">C# çå¤å´å¹¶éå¶ç¶ï¼èæ¯ä¸å¤§å®è§è¶å¿å¨ 2025 å¹´äº¤æ±çç»æï¼</font></p><ol><li><p><font face="å¾®è½¯éé» Light" size="3">å¯¹âèå¼±æ§âçåå¦ï¼Fatigue with Fragilityï¼ï¼ å¨ AI ååè®¾è®¡é¶æ®µï¼Python çå¨æç¹æ§åèæ¬åççµæ´»æ§æ¯å·¨å¤§çä¼å¿ãç¶èï¼éç AI é¡¹ç®ä»å®éªå®¤èµ°åçäº§ç¯å¢ï¼Productionï¼ï¼ä»ç®åç RAGï¼æ£ç´¢å¢å¼ºçæï¼æ¼è¿ä¸ºå¤æçæºè½ä½å·¥ä½æµï¼Python ä»£ç åºçå¯ç»´æ¤æ§é®é¢æ¥çå¸æ¾ ãå¤§åä¼ä¸å¼å§å¯»æ±ä¸ç§æ¢è½æä¾ç±»ä¼¼äº Python çå¼åæçï¼åè½ä¿è¯ C++/Java çº§å«ç¨³å¥æ§çè¯­è¨ãC# å­åå¶å¼ºå¤§çç±»åç³»ç»ï¼Type Systemï¼åç¼è¯å¨æ£æ¥ï¼æä¸ºäºè§£å³è¿ä¸âå·¥ç¨åé¸¿æ²âçæä½³åéè ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">å¨æ çæçç»ä¸ï¼Unified Ecosystemsï¼ï¼ å¾®è½¯å¨ 2025 å¹´å®æäºå¶å¼åææ¯æ çæ·±åº¦æ´åãä» Azure äºåºç¡è®¾æ½ï¼å° Visual Studio å¼åç¯å¢ï¼åå° Azure AI Foundry æ¨¡åæå¡ï¼C# å¼åèé¦æ¬¡è½å¤å¨åä¸ä¸ªçæç³»ç»ä¸­æ ç¼å®æä»æ¨¡åå¾®è°ãåºç¨ç¼æå°äºç«¯é¨ç½²çå¨æµç¨ ãè¿ç§âåä¸æ âï¼Single Stackï¼ä¼å¿æå¤§å°éä½äºä¸ä¸æåæ¢çææ¬ï¼å¸å¼äºå¤§éåæ¬å  AI å¼åèè½¬å Python ç.NET å¼åèåå½ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">ç®åç»æµå­¦çååï¼Performance Criticalityï¼ï¼ éçå¤§æ¨¡åæ¨çææ¬çå±é«ä¸ä¸ï¼åºç¨å±çè¿è¡æ¶æçéæ°æä¸ºå³æ³¨ç¦ç¹ã2025 å¹´åå¸ç.NET 10 å¨å¼ éå¤çï¼Tensor Primitivesï¼ååå­ç®¡çä¸ççªç ´æ§æ¹è¿ï¼ä½¿å¾ C# å¨æ§è¡è½»éçº§æ¨çååéè¿ç®æ¶çæ§è½è¶³ä»¥åª²ç¾çè³è¶è¶ä¼ ç»ç Python æ°æ®æ ï¼ä»èä¸ºä¼ä¸èçäºå¯è§çè®¡ç®èµæºææ¬ ã</font></p></li></ol><h5><font face="å¾®è½¯éé» Light" size="3"><font style="font-weight: normal">1.3 Python çå¹³å°æä¸ C# çè¿å»</font></font></h5><p><font face="å¾®è½¯éé» Light" size="3">2025 å¹´çæäºå¹¶é Python çè¡°è½ï¼èæ¯å·¥å·é¾çååãPython ä¾ç¶æ¯ AI ç ç©¶ å è®­ç» çéç¨è¯­ï¼ææç PyTorch å TensorFlow ç­æ ¸å¿åº ãä½å¨ AI åºç¨ å ç¼æå±ââå³å¦ä½å°å¤§æ¨¡åçè½åè½¬åä¸ºå·ä½ä¸å¡æµç¨çé¢åââC# æ­£å¨éæ°å¤ºåé¢å°ãTIOBE çæ°æ®æç¤ºï¼éçâAI å·¥ç¨âï¼AI Engineeringï¼éæ¸ä»âæ°æ®ç§å­¦âï¼Data Scienceï¼ä¸­å¥ç¦»åºæ¥æä¸ºç¬ç«å­¦ç§ï¼å·¥å·é¾æ­£å¨åçåè£ï¼Python è´è´£ç¼å¶æ¨¡åï¼è C# è´è´£ç®¡çåææ¥è¿äºæ¨¡åãè¿ç§åå·¥å°å¨ 2026 å¹´éçæºè½ä½ç³»ç»çæ®åèåå¾æ´å æ¸æ°ã</font></p><p></p><h1>äºãæºè½ä½é©å½ï¼ä»å¯¹è¯å°ç¼æ</h1><p><font face="å¾®è½¯éé» Light" size="3">è¦çè§£ C# ä¸ºä½è½å¨ 2026 å¹´è¿æ¥çåï¼å¿é¡»é¦åçè§£ AI åå±çæ ¸å¿è¶å¿ï¼ä»çæå¼ AI åæºè½ä½ AI çè·è¿ã</font></p><h5><font face="å¾®è½¯éé» Light" size="3"><font style="font-weight: normal">2.1 æºè½ä½ï¼Agentic AIï¼çå®ä¹ä¸ææ</font></font></h5><p><font face="å¾®è½¯éé» Light" size="3">æºè½ä½ AI ä¸ä»ä»æ¯è½å¤åç­é®é¢çèå¤©æºå¨äººï¼å®ä»¬æ¯è½å¤æç¥ç¯å¢ãè¿è¡æ¨çè§åãè°ç¨å·¥å·å¹¶æ§è¡å¤æ­¥ä»»å¡çèªä¸»ç³»ç» ãä¸ä¼ ç»çå½ä»¤å¼ç¨åºä¸åï¼æºè½ä½ç³»ç»çæ§è¡è·¯å¾å¾å¾æ¯éç¡®å®æ§çï¼ä¾èµäºå¤§æ¨¡åï¼LLMï¼çå®æ¶å³ç­ã</font></p><p><font face="å¾®è½¯éé» Light" size="3">è¿ç§èå¼è½¬ç§»ç»è½¯ä»¶æ¶æå¸¦æ¥äºåææªæçææï¼</font></p><ul><li><p><font face="å¾®è½¯éé» Light" size="3">ç¶æç®¡ççå¤ææ§ï¼ ä¸ä¸ªå¤æçæºè½ä½ä»»å¡ï¼å¦âå®¡æ ¸ä¸ç¬è´·æ¬¾âï¼å¯è½æç»­æ°å¤©ï¼æé´æ¶åå¤æ¬¡äººæºäº¤äºåå¤é¨ API è°ç¨ãç³»ç»å¿é¡»è½å¤æä¹åä¿å­æºè½ä½çè®°å¿ï¼Memoryï¼åæ§è¡ç¶æï¼Stateï¼ï¼å¹¶å¨æéåæ¢å¤ ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">å¤æºè½ä½åä½ï¼Multi-Agent Orchestrationï¼ï¼ å¤æçä»»å¡å¾å¾éè¦å¤ä¸ªä¸èæºè½ä½ï¼å¦âç ç©¶åâãâç¨åºåâãâå®¡æ ¸åâï¼ååå·¥ä½ãå¦ä½å®ä¹å®ä»¬ä¹é´çéè®¯åè®®ãä»²è£æºå¶åäº¤æ¥æµç¨ï¼æ¯ä¸ä¸ªæå¶å¤æçåå¸å¼ç³»ç»é®é¢ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">ç¡®å®æ§ä¸éç¡®å®æ§çèåï¼ ä¼ä¸åºç¨éè¦ç»ææ¯å¯é¢æµä¸åè§çï¼ä½ LLM æ¬è´¨ä¸æ¯æ¦çæ§çãå¦ä½å¨ä»£ç å±é¢ä¸ºä¸å¯é ç LLM å ä¸âæ¤æ âï¼æ¯å·¥ç¨å®æ½çå³é®ã</font></p></li></ul><h5><font face="å¾®è½¯éé» Light" size="3"><font style="font-weight: normal">2.2 ç¼æå±çå´èµ·ï¼C# çå¤©ç¶æåº</font></font></h5><p><font face="å¾®è½¯éé» Light" size="3">æ­£æ¯è¿äºææï¼è®© C# çä¼å¿å¾ä»¥åååæ¥ã</font></p><ul><li><p><font face="å¾®è½¯éé» Light" size="3">å¼ºç±»åç³»ç»çå®å¨ç½ï¼ å¨ Python ä¸­ï¼æºè½ä½ä¹é´ä¼ éçæ¶æ¯å¾å¾æ¯æ¾æ£çå­å¸ï¼Dictionaryï¼ï¼ææå¨è¿è¡æ¶å¯¼è´ç±»åéè¯¯ãC# åè®¸å¼åèå®ä¹ä¸¥æ ¼çæ¥å£ï¼Interfaceï¼åæ°æ®å¥çº¦ï¼Data Contractï¼ï¼ç¡®ä¿æºè½ä½ä¹é´çäº¤äºå¨ç¼è¯æå°±ç»è¿éªè¯ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">å¹¶åä¸å¼æ­¥å¤çï¼ æºè½ä½ç³»ç»æ¯é«åº¦ I/O å¯éåçï¼ç­å¾ LLM ååºãç­å¾ API è¿åï¼ãC# ç async/await æ¨¡å¼åä»»å¡å¹¶è¡åºï¼TPLï¼æä¾äºæ¯ Python asyncio æ´æçãæ´é«æ§è½çå¹¶åæ¨¡åï¼è½å¤è½»æ¾æ¯ææåä¸ä¸ä¸ªå¹¶åæºè½ä½å®ä¾ ã</font></p></li></ul><p><font face="å¾®è½¯éé» Light" size="3">ä¼ä¸çº§æä¹ååºå ï¼.NET çææ¥æ OrleansãDurable Functions ç­æççåå¸å¼è¿è¡æ¶ææ¯ãå¾®è½¯æºè½ä½æ¡æ¶ç´æ¥ç»§æ¿äºè¿äºåºå ï¼ä½¿å¾ C# æºè½ä½å¤©çå·å¤âæ°¸çâçè½åââå³å¨è¿ç¨éå¯ææå¡å¨æéåï¼ä¾ç¶è½ä»æ­ç¹æ ç¼ç»§ç»­æ§è¡</font> ã</p><p></p><h1>ä¸ã å¾®è½¯æºè½ä½æ¡æ¶ï¼Microsoft Agent Frameworkï¼ï¼ç»ä¸çæ°å¼æ</h1><p><font face="å¾®è½¯éé» Light" size="3">2025 å¹´ 10 æï¼å¾®è½¯æ­£å¼æ¨åºäº Microsoft Agent Frameworkï¼ä»¥ä¸ç®ç§° MAFï¼ï¼è¿ä¸ä»æ¯ä¸ä¸ªæ°ç SDKï¼æ´æ¯ C# å¨æºè½ä½é¢åç¡®ç«å°ä½çåºç³ ã</font></p><h5><font face="å¾®è½¯éé» Light" size="3"><font style="font-weight: normal">3.1 åå²æ§çç»ä¸ï¼Semantic Kernel ä¸ AutoGen çèå</font></font></h5><p><font face="å¾®è½¯éé» Light" size="3">å¨ MAF è¯çä¹åï¼å¾®è½¯ç AI å¼åçæå­å¨åè£ï¼</font></p><ul><li><p><font face="å¾®è½¯éé» Light" size="3">Semantic Kernel (SK)ï¼ ä½ä¸ºä¸ä¸ªä¼ä¸çº§ SDKï¼SK æé¿å° LLM éæå°ç°æçåºç¨ä¸­ï¼æä¾æä»¶ï¼Pluginï¼åè®°å¿ï¼Memoryï¼çæ½è±¡ï¼ä½å¨å¤æºè½ä½å¤æç¼æä¸ç¥æ¾ä¹å ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">AutoGenï¼ ä½ä¸ºä¸ä¸ªæºèªå¾®è½¯ç ç©¶é¢ç Python é¡¹ç®ï¼AutoGen å¼åäºå¤æºè½ä½å¯¹è¯ï¼Group Chatï¼çåæ²³ï¼æå¶çµæ´»ä½ç¼ºä¹çäº§ç¯å¢æéçç±»åå®å¨åå¯è§æµæ§ ã</font></p></li></ul><p><font face="å¾®è½¯éé» Light" size="3">MAF çæ¨åºå®£åäºè¿ç§åè£çç»æãå®å° AutoGen çåæ°ç¼ææ¨¡å¼ï¼Orchestration Patternsï¼éæå¨ Semantic Kernel åå®çä¼ä¸çº§å°åºä¹ä¸ ãå¯¹äº C# å¼åèèè¨ï¼è¿æå³çä»ä»¬é¦æ¬¡æ¥æäºä¸ä¸ªæ¢å·å¤åæ²¿ç ç©¶è½åï¼åç¬¦åä¼ä¸åè§è¦æ±çåçæ¡æ¶ãMAF å°äº 2026 å¹´ç¬¬ä¸å­£åº¦æ­£å¼åç¨ï¼GAï¼ï¼è¿è¢«è§ä¸º C# æºè½ä½åºç¨çåçèµ·è·çº¿ã</font></p><h5><font face="å¾®è½¯éé» Light" size="3"><font style="font-weight: normal">3.2 æ ¸å¿æ¶æè§£æ</font></font></h5><p><font face="å¾®è½¯éé» Light" size="3">MAF å¼å¥äºä¸å¥å¨æ°çãåºäºå¾ï¼Graph-basedï¼çæ¶æä½ç³»ï¼åä»£äºæ©ææ¾æ£çäºä»¶é©±å¨æ¨¡åã</font></p><h6><font face="å¾®è½¯éé» Light" size="3"><font style="font-weight: normal">3.2.1 å·¥ä½æµå¼æï¼Workflow Engineï¼</font></font></h6><p><font face="å¾®è½¯éé» Light" size="3">MAF çæ ¸å¿æ¯å·¥ä½æµå¼æï¼å®å°æºè½ä½çäº¤äºå»ºæ¨¡ä¸ºç± æ§è¡å¨ï¼Executorsï¼ å è¾¹ï¼Edgesï¼ ç»æçæåå¾ 12ã</font></p><ul><li><p><font face="å¾®è½¯éé» Light" size="3">ç¡®å®æ§ç¼æï¼ å¼åèå¯ä»¥ä½¿ç¨ C# ä»£ç æ¾å¼å®ä¹æµç¨çæµè½¬é»è¾ãä¾å¦ï¼åªæå½âé£é©è¯ä¼°æºè½ä½âè¾åºçç½®ä¿¡åº¦ä½äº 0.8 æ¶ï¼æµç¨æä¼æµè½¬å°âäººå·¥å®¡æ ¸èç¹âãè¿ç§é»è¾å¨ C# ä¸­æ¯å¼ºç±»åçï¼ç¼è¯å¨ä¼æ£æ¥æ¯ä¸æ¡è¾¹çè¾å¥è¾åºç±»åæ¯å¦å¹é 12ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">ç¶æç®¡çï¼State Managementï¼ï¼ MAF å¼å¥äº AgentThread çæ¦å¿µï¼ç¨äºæä¹åä¿å­å¯¹è¯åå²åä¸ä¸æãä¸ Python ä¸­å¸¸è§çåå­å­å¨ä¸åï¼C# çç MAF å¯ä»¥éè¿ä¾èµæ³¨å¥ï¼DIï¼è½»æ¾éæ Cosmos DB æ SQL Server ä½ä¸ºæä¹ååç«¯ï¼ç¡®ä¿ä¼ä¸æ°æ®çå®å¨æ§ 12ã</font></p></li></ul><h6><font face="å¾®è½¯éé» Light" size="3"><font style="font-weight: normal">3.2.2 ç¼ææ¨¡å¼ï¼Orchestration Patternsï¼</font></font></h6><p><font face="å¾®è½¯éé» Light" size="3">MAF åçæ¯æå¤ç§å¤æçåä½æ¨¡å¼ï¼ä½¿ C# å¼åèè½å¤åæ­ç§¯æ¨ä¸æ ·æå»ºç³»ç»ï¼</font></p><ul><li><p><font face="å¾®è½¯éé» Light" size="3">Magentic ç¼æï¼ åå° Magentic-One ç ç©¶çå¯åï¼è¿ç§æ¨¡å¼åå«ä¸ä¸ªä¸»æ§çâç»çæºè½ä½âï¼Managerï¼åå¤ä¸ªâå·¥æºè½ä½âï¼Workerï¼ãç»çç»´æ¤ä¸ä¸ªå¨æçä»»å¡è´¦æ¬ï¼Task Ledgerï¼ï¼æ ¹æ®ä»»å¡è¿å±å¨æææ´¾å·¥æºè½ä½ï¼å¦ WebSurferãCoderï¼å»æ§è¡å·ä½æä½ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">ç¾¤èæ¨¡å¼ï¼Group Chatï¼ï¼ åè®¸å¤ä¸ªæºè½ä½å¨ä¸ä¸ªå±äº«çä¸ä¸æä¸­è½®æµåè¨ãC# å¼åèå¯ä»¥éè¿å®ç° ITerminationStrategy æ¥å£æ¥ç²¾ç¡®æ§å¶ç¾¤èä½æ¶ç»æï¼ä¾å¦ï¼å½è¾¾æå±è¯æå°è¯æ¬¡æ°èå°½æ¶ï¼ï¼èä¸æ¯ä¾èµèå¼±çæç¤ºè¯æä»¤ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">äººå¨åè·¯ï¼Human-in-the-Loopï¼ï¼ MAF å°äººå·¥å¹²é¢è§ä¸ºä¸ç§æ åçå·¥ä½æµç¶æãç³»ç»å¯ä»¥å¨å³é®èç¹æèµ·ï¼åºååå½åç¶æï¼ç­å¾äººç±»ç¨æ·éè¿ UI æ¹ååï¼åååºååå¹¶ç»§ç»­æ§è¡ãè¿ç§æºå¶å¯¹äºéèåæ³å¾ç­é«é£é©é¢åçåºç¨è³å³éè¦ã</font></p></li></ul><h5><font face="å¾®è½¯éé» Light" size="3"><font style="font-weight: normal">3.3 å¼åçâéä¸è§âï¼DevUI, AG-UI, OpenTelemetry</font></font></h5><p><font face="å¾®è½¯éé» Light" size="3">ä¸ºäºè§£å³ AI ç³»ç»âé»çâé¾ä»¥è°è¯ççç¹ï¼MAF å¼å¥äºè¢«ç§°ä¸ºâéä¸è§âçéå¥å·¥å·ï¼æå¤§å°æåäº C# å¼åèçä½éªï¼</font></p><ol><li><p><font face="å¾®è½¯éé» Light" size="3">DevUIï¼è°è¯å±ï¼ï¼ è¿æ¯ä¸ä¸ªåç¯å¼åå·¥å·ï¼æä¾å¯è§åççé¢æ¥å±ç¤ºæºè½ä½çâæç»´é¾âï¼Chain of Thoughtï¼ãå¼åèå¯ä»¥åæ¥ç X åçä¸æ ·ï¼æ¸æ°å°çå°æºè½ä½å¨æ¯ä¸æ­¥æ¯å¦ä½è¿è¡æ¨çãè°ç¨äºåªä¸ªå·¥å·ãä»¥åä¸ºä»ä¹ååºäºæä¸ªå³ç­ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">AG-UIï¼äº¤äºå±ï¼ï¼ è¿æ¯ä¸ä¸ªæ ååçä»£ç-ç¨æ·äº¤äºåè®®ãå®è§£è¦äºåç«¯æºè½ä½é»è¾ä¸åç«¯å±ç¤ºãC# åç«¯å¯ä»¥éè¿è¯¥åè®®ååç«¯æµå¼ä¼ è¾ç»æåæ°æ®ï¼å¦ JSON è¡¨æ ¼ãå¾è¡¨éç½®ï¼ï¼èåç«¯ï¼æ è®ºæ¯ React è¿æ¯ Blazorï¼åªéå®ç°æ åæ¸²æå¨å³å¯ãè¿ä½¿å¾å¨æ å¼ååå¾å¼å¸¸é«æ ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">OpenTelemetryï¼å¯è§æµå±ï¼ï¼ MAF ä¸.NET ç OpenTelemetry æ·±åº¦éæãå¨ Azure Monitor æ Aspire Dashboard ä¸­ï¼å¼åèå¯ä»¥çå°å®æ´çåå¸å¼è¿½è¸ªï¼Traceï¼ï¼çæ§ Token æ¶èãå»¶è¿ä»¥åå¤é¨ API çæéçãè¿å¯¹äº 2026 å¹´ä¼ä¸å¤§è§æ¨¡é¨ç½² AI æºè½ä½åçè¿ç»´çæ§æ¯å¿ä¸å¯å°ç 18ã</font></p></li></ol><h4><font face="å¾®è½¯éé» Light" size="3"><hr><font style="font-weight: normal"> </font></font></h4><h1>åãææ¯æ·±æ½ï¼.NET 10 ä¸ C# 14 çåºå±é©æ°</h1><p><font face="å¾®è½¯éé» Light" size="3">2026 å¹´ C# å¨æºè½ä½é¢åçç«äºåï¼ä¸ä»ä»æ¥èªäºä¸å±çæ¡æ¶ï¼æ´æ¥èªäºåºå±çç¡¬æ ¸æ§è½æåã.NET 10 å C# 14 çåå¸ï¼ç³»ç»æ§å°æ¶é¤äº C# å¨ AI å¼åä¸­ç¸å¯¹äº Python çæåå åç­æ¿ã</font></p><h5><font face="å¾®è½¯éé» Light" size="3"><font style="font-weight: normal">4.1 System.Numerics.Tensorsï¼ç»ç» NumPy ä¾èµ</font></font></h5><p><font face="å¾®è½¯éé» Light" size="3">é¿æä»¥æ¥ï¼Python å¨ AI ççç»æ²»åå¾å¤§ç¨åº¦ä¸å½åäº NumPy åå¶èåç C/C++ ä¼ååºã.NET 10 éè¿éæ System.Numerics.Tensors åºï¼åè¿ä¸å£ååèµ·äºæ­£é¢ææ ã</font></p><p><font face="å¾®è½¯éé» Light" size="3"><a href="https://img2024.cnblogs.com/blog/510/202601/510-20260105092037994-1794180972.png"><img width="1747" height="752" title="image" style="display: inline; background-image: none" alt="image" src="https://img2024.cnblogs.com/blog/510/202601/510-20260105092038972-1464504355.png" border="0"></a></font></p><p><font face="å¾®è½¯éé» Light" size="3"></font></p><p><font face="å¾®è½¯éé» Light" size="3">.NET 10 å¼å¥äº Tensor&lt;T&gt;ãTensorSpan&lt;T&gt; å ReadOnlyTensorSpan&lt;T&gt; ç­é«æ§è½ç±»å ãè¿äºç±»ååè®¸ C# ä»£ç ç´æ¥å¨åå­ä¸­æä½å¤ç»´æ°ç»ï¼å©ç¨ CPU ç SIMDï¼åæä»¤å¤æ°æ®ï¼æä»¤éè¿è¡å éãåºåæµè¯æ¾ç¤ºï¼å¨è½»éçº§æ¨çååéè¿ç®ï¼å¦ RAG ç³»ç»ä¸­çä½å¼¦ç¸ä¼¼åº¦è®¡ç®ï¼åºæ¯ä¸ï¼C# çæ§è½å¯ä»¥åª²ç¾çè³å¨æäºæåµä¸è¶è¶ NumPyï¼ä¸æ éè·¨è¶ Python ä¸ C ä¹é´çäºæä½è¾¹çï¼Marshalling Overheadï¼ãè¿å¯¹äºæå»ºä½å»¶è¿çå®æ¶æºè½ä½ç³»ç»è³å³éè¦ã</font></p><h5><font face="å¾®è½¯éé» Light" size="3"><font style="font-weight: normal">4.2 AVX-512 ä¸æ¨çä¼å</font></font></h5><p><font face="å¾®è½¯éé» Light" size="3">éç AI æ¨çä»äºç«¯åè¾¹ç¼ä¾§åéç¨æå¡å¨è¿ç§»ï¼CPU æ¨ççéè¦æ§æ¥çæåã.NET 10 å¯¹ Intel AVX-512 æä»¤éçåçæ¯æï¼åæ¬ VNNI - åéç¥ç»ç½ç»æä»¤ï¼ï¼ä½¿å¾ C# åºç¨è½å¤ååææç°ä»£æå¡å¨ CPUï¼å¦ Intel Xeon Scalableï¼ç AI å éè½å ãè¿æå³çä¼ä¸å¯ä»¥å¨ç°æç.NET æå¡å¨éç¾¤ä¸é«æè¿è¡éååçå¤§æ¨¡åï¼å¦ Phi-3&nbsp; çéåçæ¬ï¼ï¼èæ éä¸ºæ¯ä¸ªç®åçæºè½ä½ä»»å¡é½éå¤æè´µç GPU èµæº ãè¿ç§âCPU æ¨çåå¥½âçç¹æ§ï¼å¤§å¤§éä½äºä¼ä¸é¨ç½²å¤§è§æ¨¡æºè½ä½éç¾¤çé¨æ§ã</font></p><h5><font face="å¾®è½¯éé» Light" size="3"><font style="font-weight: normal">4.3 C# 14ï¼è¯­ä¹è¡¨è¾¾åçè¿å</font></font></h5><p><font face="å¾®è½¯éé» Light" size="3">C# 14 çè¯­è¨ç¹æ§æ´æ°ï¼è´åäºåå°å®ä¹æºè½ä½åæ°æ®ç»ææ¶çæ ·æ¿ä»£ç ï¼ä½¿å¶å¨è¡¨è¾¾åä¸æ´å æ¥è¿ Python çç®æ´æ§ï¼åæ¶ä¿æéæç±»åçå®å¨æ§ ã</font></p><ul><li><p><font face="å¾®è½¯éé» Light" size="3">field å³é®å­ï¼ è¿ä¸ç¹æ§ç®åäºå±æ§ï¼Propertyï¼çå®ä¹ï¼åè®¸å¼åèå¨å±æ§è®¿é®å¨ä¸­ç´æ¥è®¿é®éå¼çæçåå¤å­æ®µãè¿å¨å®ä¹æºè½ä½çåé¨ç¶ææ¨¡åæ¶éå¸¸æç¨ï¼ä½¿å¾ä»£ç æ´å ç´§åæè¯»ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">æ©å±æåï¼Extension Membersï¼ï¼ C# 14 åè®¸åæ¥å£æ·»å æ©å±å±æ§åéææ¹æ³ãè¿å¯¹äºæ©å± AI SDK çè½åè³å³éè¦ãä¾å¦ï¼å¼åèå¯ä»¥ä¸ºæ åç IChatClient æ¥å£æ·»å ç¹å®é¢åçæ©å±æ¹æ³ï¼èæ éä¿®æ¹åå§åºä»£ç æåå»ºå¤æçåè£ç±»ãè¿æå¤§å°å¢å¼ºäºå¤æºè½ä½ç³»ç»çå¯ç»åæ§ï¼Composabilityï¼ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">éå¼ Span è½¬æ¢ï¼ è¿ä¸ç¹æ§ç®åäºä¸ååå­è¡¨ç¤ºå½¢å¼ä¹é´çè½¬æ¢ï¼ä½¿å¾å¨åéæ°æ®åºãLLM è¾å¥ååºç¨é»è¾ä¹é´ä¼ éæ°æ®åå¾æ´å æµçåé«æ ã</font></p></li></ul><h5><font face="å¾®è½¯éé» Light" size="3"><font style="font-weight: normal">4.4 TypeChat ä¸ç»æåè¾åº</font></font></h5><p><font face="å¾®è½¯éé» Light" size="3">å¨æºè½ä½å¼åä¸­ï¼æå¤´ç¼çé®é¢ä¹ä¸æ¯å¦ä½è®© LLM ç¨³å®å°è¾åºç¨åºå¯è¯»ç JSON æ°æ®ãå¾®è½¯æ¨åºç TypeChat åºä¸ C# çå¼ºç±»åç³»ç»ç®ç´æ¯å¤©ä½ä¹å ã</font></p><ul><li><p><font face="å¾®è½¯éé» Light" size="3">åçï¼ å¼åèåªéå®ä¹ C# çç±»ï¼Classï¼ææ¥å£ï¼Interfaceï¼æ¥æè¿°ææçæ°æ®ç»æãTypeChat ä¼èªå¨æ ¹æ®è¿äºç±»åå®ä¹çæ Promptï¼å¹¶å¨ LLM è¿åç»æåï¼å©ç¨ C# ç¼è¯å¨è¿è¡ååºåååéªè¯ãå¦æéªè¯å¤±è´¥ï¼å®çè³ä¼èªå¨æå»ºä¿®å¤æç¤ºè¯è®© LLM éè¯ã</font></p></li></ul><p><font face="å¾®è½¯éé» Light" size="3">ä»·å¼ï¼ è¿ç§æºå¶å° LLM çéç¡®å®æ§è¾åºè¢«çº¦æå¨ç¡®å®ç C# ç±»åç³»ç»ä¸­ï¼ä¸ºæå»ºå¯é çä¸å¡æºè½ä½æä¾äºåå®çä¿éãå¨.NET 10 ä¸­ï¼è¿ç§è½åè¢«è¿ä¸æ­¥éæè¿ MAFï¼æä¸ºæ åçå¼åèå¼ ã</font></p><p><br></p><p><font face="å¾®è½¯éé» Light" size="3"></font></p><h1>äºãå±æ 2026ï¼æºè½ä½ç½æ ¼ä¸ IDE çè¿å</h1><h5><font face="å¾®è½¯éé» Light" size="3" style="font-weight: normal">5.1 Visual Studio 2026ï¼æºè½ä½åç IDE</font></h5><p><font face="å¾®è½¯éé» Light" size="3">2025 å¹´åºåå¸ç Visual Studio 2026 æä¸ºé¦ä¸ªâæºè½ä½åçâï¼Agent-Nativeï¼ç IDE ã</font></p><ul><li><p><font face="å¾®è½¯éé» Light" size="3">æºè½ä½è°è¯å¨ï¼ å¼åèå°ä¸ååªæ¯è°è¯ä»£ç è¡ï¼èæ¯è°è¯æºè½ä½çâæç»´âãVS 2026 å°æ¯æå¨æºè½ä½æ¨çå¾ªç¯ä¸­è®¾ç½®æ­ç¹ï¼æ¥çå½åçä¸ä¸æçªå£ãå·¥å·è°ç¨å æ å Token ä½¿ç¨æåµ ã</font></p></li><li><p><font face="å¾®è½¯éé» Light" size="3">Aspire éæï¼.NET Aspire å°æä¸ºæºè½ä½ç¼æçæ åå®¹å¨åæ¹æ¡ï¼æä¾å¼ç®±å³ç¨çæå¡åç°ãéç½®ç®¡çåé¥æµéæï¼è®©å¤æºè½ä½ç³»ç»çæ¬å°å¼åä½éªååä½åºç¨ä¸æ ·ç®å ã</font></p></li></ul><h5><font face="å¾®è½¯éé» Light" size="3" style="font-weight: normal">5.2 æºè½ä½æå¡ç½æ ¼ï¼Agentic Service Meshï¼</font></h5><p><font face="å¾®è½¯éé» Light" size="3">éçæºè½ä½æ°éçæ¿å¢ï¼ä¼ä¸åé¨å°æ¶ç°åºâæºè½ä½æ³¨åè¡¨âåâæºè½ä½äºèåè®®âï¼A2Aï¼çéæ± ãæªæ¥çä¼ä¸è½¯ä»¶æ¶æï¼å°åºç°å¤§éæ¯ç± C# ç¼åçãæç¾ä¸åä¸ªä¸èæºè½ä½ç»æçåºå¤§åä½ç½ç»ã</font></p><h1>ç»è¯­</h1><p><font face="å¾®è½¯éé» Light" size="3">C# è£èº TIOBE 2025 å¹´åº¦ç¼ç¨è¯­è¨ï¼ç»éæ§æ¶ä»£çä½æï¼èæ¯æ°æ¶ä»£çæåãå¨äººå·¥æºè½ä»âçæâè¿åâè¡å¨âçå³é®èç¹ï¼è¡ä¸å¯¹è½¯ä»¶å·¥ç¨çä¸¥è°¨æ§ãæ§è½åå¯ç»´æ¤æ§æåºäºæ´é«è¦æ±ãéè¿.NET 10 çåºå±éæåå¾®è½¯æºè½ä½æ¡æ¶çé¡¶å±è®¾è®¡ï¼C# æåå°éå¡äºèªå·±ï¼ä» Python æä¸­æ¥è¿äº AI åºç¨ç¼æçæ¥åæ£ã</font></p><p><font face="å¾®è½¯éé» Light" size="3">2026 å¹´ï¼å¯¹äº C# å¼åèèè¨ï¼å°æ¯é»éæ¶ä»£ãä»ä»¬æä¸­çå·¥å·ä¸åä»ä»æ¯æå»º Web é¡µé¢æ CRUD æ¥å£çé²å­ï¼èæ¯ææ¥æ°å­å³å¨åãç¼ææºè½ä½ç½ç»çææãå¨è¿ä¸ªæºè½ä½é©±å¨çæ°ä¸çéï¼C# ä¸ä»æ¯åä¸èï¼æ´æ¯å®ä¹èã</font></p><p><font face="å¾®è½¯éé» Light" size="3"><br></font></p><p><font face="å¾®è½¯éé» Light" size="3">ç¸å³é¾æ¥ï¼</font></p><p><font face="å¾®è½¯éé» Light" size="3">[1] <b>TIOBE Index: <a href="https://www.tiobe.com/tiobe-index/" rel="noopener nofollow">https://www.tiobe.com/tiobe-index/</a></b></font></p><p><br></p><p><font face="å¾®è½¯éé» Light" size="3"></font></p><p><font face="å¾®è½¯éé» Light" size="3"></font></p>
</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬¢è¿å¤§å®¶æ«æä¸é¢äºç»´ç æä¸ºæçå®¢æ·ï¼æ¶ä½ ä¸äº</p>
<img src="https://images.cnblogs.com/cnblogs_com/shanyou/57459/o_220125090408_%E9%82%80%E8%AF%B7%E4%BA%8C%E7%BB%B4%E7%A0%81-258px.jpeg" width="170">
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.00625" data-date-updated="2026-01-05 09:30">2026-01-05 09:21</span>&nbsp;
<a href="https://www.cnblogs.com/shanyou">å¼ åå</a>&nbsp;
éè¯»(<span id="post_view_count">358</span>)&nbsp;
è¯è®º(<span id="post_comment_count">4</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19441004);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19441004', targetLink: 'https://www.cnblogs.com/shanyou/p/19441004', title: 'æºè½ä½æ¶ä»£çè¯­è¨å¤å´ï¼ä» TIOBE 2025 å¹´åº¦è¯­è¨å° 2026 å¹´ C# æºè½ä½çæçå¨é¢å´èµ·' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ åæ³¨æå å·¥ï¼è®©ä½ çå¾è¡¨æä½è¯»èçç¼ç ]]></title>
    <link>https://www.cnblogs.com/wang_yb/p/19440010</link>
    <guid>b0cdaaf538f404bdce50ae205380af18</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/wang_yb/p/19440010" title="åå¸äº 2026-01-04 23:10">
    <span role="heading" aria-level="2">åæ³¨æå å·¥ï¼è®©ä½ çå¾è¡¨æä½è¯»èçç¼ç</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æ³è±¡ä¸ä¸ï¼ä½ èµ°è¿ä¸ä¸ªæ¤æ»¡äººçæ¿é´ï¼æååä½ ææ--ä½ å ä¹ç«å»å°±è½çå°ä»ã</p>
<p>è¿æ¯å ä¸ºâææâè¿ä¸ªå¨ä½å¨ä½ çå¤§èè¿è¡æ·±å¥æèä¹åï¼å°±å·²ç»è¢«æ³¨æå°äºã</p>
<p>åæ¯å¦å½ä½ èµ°å¨ççææçå¤§è¡ä¸ï¼å¦æææäººç©¿çé½æ¯é»ç°è²çå¤§è¡£ï¼èæ­¤æ¶æä¸ä¸ªäººç©¿çé²çº¢è²çé£è¡£ï¼ä½ ä¼çåªéï¼</p>
<p>æ¯«æ çé®ï¼ä½ çç®åä¼ç¬é´è¢«é£æ¹çº¢è²å¸å¼ã</p>
<p>è¿å°±æ¯<strong>åæ³¨æå å·¥</strong>ï¼æä»¬çå¤§èè½å¨æç­æ¶é´åï¼çº¦200-250æ¯«ç§ï¼èªå¨æ£æµå°æäºè§è§ç¹å¾ï¼èæ éæä»¬ææè¯å°å»å¯»æ¾ã</p>
<p>å¨æ°æ®å¯è§åä¸­ï¼<strong>åæ³¨æå å·¥</strong>å°±æ¯æä»¬ç¨æ¥å¼å¯¼è¯»èæ³¨æåçâè§è§é­æ¯âã</p>
<p>éè¿å·§å¦å°æ¹åé¢è²ãå¤§å°ãå½¢ç¶ç­è§è§å±æ§ï¼æä»¬å¯ä»¥è®©å¾è¡¨ä¸­çå³é®ä¿¡æ¯ï¼å¦æå¤§å¼ãæå°å¼ãå¼å¸¸å¼ï¼åæåææä¸æ ·âè·³åºæ¥âï¼ç¬¬ä¸æ¶é´æä½è¯»èçç¼çã</p>
<h1 id="1-åæ³¨æå å·¥çå®ç¨æå·§">1. åæ³¨æå å·¥çå®ç¨æå·§</h1>
<ol>
<li><strong>å°å³æ¯å¤</strong>ï¼ä¸è¦è¿åº¦ä½¿ç¨çªåºææï¼å¦åä¼å¤±å»ç¦ç¹</li>
<li><strong>ä¸è´æ§åå</strong>ï¼å¨æ´ä¸ªæ¥åæä»ªè¡¨æ¿ä¸­ä½¿ç¨ç¸åççªåºé¢è²ç¼ç </li>
<li><strong>èèè²ç²ç¨æ·</strong>ï¼é¿åä»ä¾é é¢è²åºåï¼å¯ç»åå½¢ç¶ãçº¹çç­</li>
<li><strong>ä¸ä¸æç¸å³</strong>ï¼æ ¹æ®æ°æ®ç¹ç¹åè§ä¼èæ¯éæ©åéççªåºæ¹å¼</li>
<li><strong>æµè¯ææ</strong>ï¼è®©å¶ä»äººæ¥çä½ çå¾è¡¨ï¼ç¡®è®¤çªåºæææ¯å¦è¾¾å°é¢æ</li>
</ol>
<h1 id="2-åæ³¨æå å·¥å®ä¾">2. åæ³¨æå å·¥å®ä¾</h1>
<p>æ¦å¿µä»ç»å®äºï¼ä¸é¢ç´æ¥çä»£ç ï¼ççå®éæåµä¸å¦ä½ä½¿ç¨<strong>åæ³¨æå å·¥</strong>æ¥æé«æä»¬çå¯è§åææã</p>
<h2 id="21-çªåºæå¤§å¼åæå°å¼">2.1. çªåºæå¤§å¼åæå°å¼</h2>
<pre><code class="language-python"># ç¤ºä¾1ï¼çªåºæå¤§å¼åæå°å¼
# åå»ºæ°æ®
np.random.seed(42)
categories = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H']
values = np.random.randint(10, 100, size=8)

# æ¾åºæå¤§å¼åæå°å¼çç´¢å¼
max_idx = np.argmax(values)
min_idx = np.argmin(values)

# åå»ºå¾è¡¨
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# å·¦å¾ï¼æ²¡æåæ³¨æå å·¥
bars1 = ax1.bar(categories, values, color='lightblue', edgecolor='black')

# å³å¾ï¼æåæ³¨æå å·¥ï¼çªåºæå¤§æå°å¼ï¼
colors = ['lightblue'] * len(values)
colors[max_idx] = '#FF6B6B'  # çº¢è²çªåºæå¤§å¼
colors[min_idx] = '#4ECDC4'  # éè²çªåºæå°å¼

bars2 = ax2.bar(categories, values, color=colors, edgecolor='black')

# å¨æå¤§å¼åæå°å¼ä¸æ·»å æ ç­¾
ax2.text(max_idx, values[max_idx] + 2, f'æå¤§: {values[max_idx]}',
         ha='center', fontweight='bold', color='#FF6B6B')
ax2.text(min_idx, values[min_idx] + 2, f'æå°: {values[min_idx]}',
         ha='center', fontweight='bold', color='#4ECDC4')

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://img2024.cnblogs.com/blog/83005/202601/83005-20260104230912188-646033135.png" alt="" loading="lazy"></p>
<p>å·¦å¾ä¸­ï¼æææ±å­é½æ¯ç¸åçèè²ï¼è¯»èéè¦éä¸ªæ¯è¾æè½æ¾åºæå¤§å¼åæå°å¼ã</p>
<p>å³å¾ä¸­ï¼æå¤§å¼ç¨éç®ççº¢è²æ åºï¼æå°å¼ç¨éè²æ åºï¼è¯»èä¸ç¼å°±è½çå°å³é®æ°æ®ç¹ã</p>
<p><strong>åæ³¨æå å·¥çå¥½å¤</strong>ï¼å°±åå¨äººç¾¤ä¸­ä¸ºéè¦äººç©æ´ä¸ç¹å«çå¸½å­ï¼è¯»èæ éè´¹åå¯»æ¾å°±è½ç«å³è¯å«å³é®æ°æ®ç¹ã</p>
<h2 id="22-çªåºå¼å¸¸å¼">2.2. çªåºå¼å¸¸å¼</h2>
<pre><code class="language-python"># ç¤ºä¾2ï¼çªåºå¼å¸¸å¼
# åå»ºåå«å¼å¸¸å¼çæ°æ®
np.random.seed(42)
data_normal = np.random.normal(50, 10, 100)
data_outliers = np.array([5, 125, 130])  # å¼å¸¸å¼
all_data = np.concatenate([data_normal, data_outliers])

# è¯å«å¼å¸¸å¼ï¼ç®åæ¹æ³ï¼è¶åºå¹³åå¼Â±2åæ åå·®ï¼
mean_val = np.mean(all_data)
std_val = np.std(all_data)
outlier_indices = np.where((all_data &lt; mean_val - 2*std_val) | (all_data &gt; mean_val + 2*std_val))[0]

# åå»ºå¾è¡¨
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# å·¦å¾ï¼æ²¡æåæ³¨æå å·¥
scatter1 = ax1.scatter(range(len(all_data)), all_data, alpha=0.7, c='gray', s=50)
ax1.axhline(y=mean_val, color='black', linestyle='--', alpha=0.5, label=f'å¹³åå¼: {mean_val:.1f}')
ax1.axhline(y=mean_val + 2*std_val, color='red', linestyle=':', alpha=0.5, label='Â±2æ åå·®')
ax1.axhline(y=mean_val - 2*std_val, color='red', linestyle=':', alpha=0.5)

# å³å¾ï¼æåæ³¨æå å·¥ï¼çªåºå¼å¸¸å¼ï¼
colors = ['gray'] * len(all_data)
sizes = [50] * len(all_data)

# çªåºå¼å¸¸å¼
for idx in outlier_indices:
    colors[idx] = '#FF6B6B'  # çº¢è²
    sizes[idx] = 150  # æ´å¤§

scatter2 = ax2.scatter(range(len(all_data)), all_data, alpha=0.7, c=colors, s=sizes)
ax2.axhline(y=mean_val, color='black', linestyle='--', alpha=0.5, label=f'å¹³åå¼: {mean_val:.1f}')
ax2.axhline(y=mean_val + 2*std_val, color='red', linestyle=':', alpha=0.5, label='Â±2æ åå·®')
ax2.axhline(y=mean_val - 2*std_val, color='red', linestyle=':', alpha=0.5)

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://img2024.cnblogs.com/blog/83005/202601/83005-20260104230912194-1976550473.png" alt="" loading="lazy"></p>
<p>å·¦å¾ä¸­ï¼å¼å¸¸å¼æ··å¨æ®éæ°æ®ç¹ä¸­ï¼é¾ä»¥ç«å³è¯å«ã</p>
<p>å³å¾ä¸­ï¼å¼å¸¸å¼ç¨æ´å¤§ççº¢è²ç¹çªåºæ¾ç¤ºï¼å³ä½¿æ°æ®éå¾å¤§ï¼è¯»èä¹è½ç«å³æ³¨æå°è¿äºç¹æ®ç¹ã</p>
<p><strong>åæ³¨æå å·¥çå¥½å¤</strong>ï¼å°±åå¨å¹³éæ¹é¢ä¸æ è®°åºæ¶æ¼ªçèµ·æºï¼å¼å¸¸å¼ä¸åéèå¨æ°æ®æµ·æ´ä¸­ï¼èæ¯æä¸ºåæçéç¹ã</p>
<h2 id="23-çªåºè¶å¿ååç¹">2.3. çªåºè¶å¿ååç¹</h2>
<pre><code class="language-python"># ç¤ºä¾3ï¼çªåºè¶å¿ååç¹
# åå»ºåå«è¶å¿ååçæ¶é´åºåæ°æ®
np.random.seed(42)
time_points = np.arange(0, 100)
trend_change_point = 45

# åæ®µåå»ºè¶å¿æ°æ®
trend1 = 30 + 0.5 * np.arange(0, trend_change_point) + np.random.normal(0, 2, trend_change_point)
trend2 = trend1[-1] - 0.8 * np.arange(0, 100 - trend_change_point) + np.random.normal(0, 2, 100 - trend_change_point)
data = np.concatenate([trend1, trend2])

# åå»ºå¾è¡¨
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# å·¦å¾ï¼æ²¡æåæ³¨æå å·¥
line1 = ax1.plot(time_points, data, color='gray', alpha=0.8, linewidth=2)

# å³å¾ï¼æåæ³¨æå å·¥ï¼çªåºè¶å¿ååç¹ï¼
line2 = ax2.plot(time_points, data, color='gray', alpha=0.6, linewidth=2)

# çªåºè¶å¿åååºå
ax2.axvspan(trend_change_point-5, trend_change_point+5, alpha=0.3, color='#FF6B6B', label='è¶å¿åååºå')
ax2.scatter(trend_change_point, data[trend_change_point], color='#FF6B6B', s=200, zorder=5, label='ååç¹')
ax2.plot(time_points[:trend_change_point+1], data[:trend_change_point+1], color='#4ECDC4', linewidth=3, alpha=0.8, label='ä¸åè¶å¿')
ax2.plot(time_points[trend_change_point:], data[trend_change_point:], color='#45B7D1', linewidth=3, alpha=0.8, label='ä¸éè¶å¿')

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://img2024.cnblogs.com/blog/83005/202601/83005-20260104230912195-715553153.png" alt="" loading="lazy"></p>
<p>å·¦å¾å±ç¤ºäºä¸ä¸ªå®æ´çè¶å¿çº¿ï¼ä½ååç¹ä¸ææ¾ã</p>
<p>å³å¾ä½¿ç¨ä¸åé¢è²åºåè¶å¿æ®µï¼å¹¶ç¨é´å½±åºååçªåºç¹æ è®°åååºåï¼ä½¿è¶å¿è½¬æä¸ç®äºç¶ã</p>
<p><strong>åæ³¨æå å·¥çå¥½å¤</strong>ï¼å°±åå¨éè·¯å°å¾ä¸æ è®°åºè½¬å¼¯å¤ï¼è¯»èè½ç«å³çå°è¶å¿ååçå³é®æ¶å»ã</p>
<h2 id="24-çªåºç¹å®ç±»å«">2.4. çªåºç¹å®ç±»å«</h2>
<pre><code class="language-python"># ç¤ºä¾4ï¼çªåºç¹å®ç±»å«
# åå»ºé¥¼å¾æ°æ®
categories = ["çµå­äº§å", "æè£", "é£å", "å®¶å±", "ä¹¦ç±", "å¶ä»"]
values = [25, 18, 22, 15, 10, 10]
highlight_category = "é£å"  # è¦çªåºçç±»å«
highlight_idx = categories.index(highlight_category)

# åå»ºå¾è¡¨
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# å·¦å¾ï¼æ²¡æåæ³¨æå å·¥
colors1 = ["#FF9AA2", "#FFB7B2", "#FFDAC1", "#E2F0CB", "#B5EAD7", "#C7CEEA"]
wedges1, texts1, autotexts1 = ax1.pie(
    values, labels=categories, autopct="%1.1f%%", colors=colors1, startangle=90
)

# å³å¾ï¼æåæ³¨æå å·¥ï¼çªåºç¹å®ç±»å«ï¼
# å°çªåºç±»å«çé¢è²æ¹ä¸ºéç®çé¢è²ï¼å¶ä»ç±»å«ç¨ç°åº¦
colors2 = ["lightgray"] * len(categories)
colors2[highlight_idx] = "#FF6B6B"  # çªåºç±»å«ç¨çº¢è²

# çªåºæ¾ç¤ºï¼å°ç¹å®ç±»å«"æåº"
explode = [0] * len(categories)
explode[highlight_idx] = 0.1

wedges2, texts2, autotexts2 = ax2.pie(
    values,
    labels=categories,
    autopct="%1.1f%%",
    colors=colors2,
    explode=explode,
    startangle=90,
)

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://img2024.cnblogs.com/blog/83005/202601/83005-20260104230912185-501416555.png" alt="" loading="lazy"></p>
<p>å·¦å¾ä¸­ï¼ææç±»å«è§è§æéç¸åï¼è¯»èéè¦éè¯»æ ç­¾æç¾åæ¯æè½æ¾å°ç¹å®ç±»å«ã</p>
<p>å³å¾ä¸­ï¼ç®æ ç±»å«è¢«"æåº"å¹¶ç¨éç®ççº¢è²æ¾ç¤ºï¼å¶ä»ç±»å«åç¨ç°è²æ·¡åï¼è¯»èä¸ç¼å°±è½çå°éç¹ã</p>
<p><strong>åæ³¨æå å·¥çå¥½å¤</strong>ï¼å°±åå¨åå±å¢ä¸­ä¸ºç¬å±èæä¸èåç¯ï¼ç¹å®ç±»å«ç«å³æä¸ºè§è§ç¦ç¹ã</p>
<p>åæ ·ï¼å¨ç»å¶<strong>å¤æ¡æçº¿å¾</strong>ï¼ä¹å°±æ¯ä¿ç§°çâé¢æ¡å¾âï¼æ¶ï¼å¦ææ¯æ¡çº¿é½ç¨é«é¥±ååº¦çé¢è²ï¼ç»é¢ä¼éå¸¸æ··ä¹±ï¼è¯»èä¸ç¥éè¯¥çåªä¸æ¡ã</p>
<p>ä¹å¯ä»¥ç¨ä¸é¢é¥¼å¾ç±»ä¼¼çæè·¯ï¼éä½ééç¹æ°æ®ç<strong>ä¸éæåº¦</strong>ï¼<code>Alpha</code>ï¼å<strong>çº¿å®½</strong>ï¼<code>Linewidth</code>ï¼ï¼åªä¿çéç¹æ°æ®çé²ææ ·å¼ã</p>
<p>è¿å°±åèå°ä¸çèåç¯ï¼ç¯åæå¨åªéï¼è§ä¼å°±çåªéã</p>
<pre><code class="language-python"># æ¨¡ææ¶é´åºåæ°æ®
x = np.linspace(0, 10, 100)
# çæ5æ¡å¹²æ°çº¿
lines = [np.sin(x + i) * (1 + i/10) for i in range(5)]
# çæ1æ¡éç¹çº¿ï¼æ¯å¦è¿æ¯æä»¬å¬å¸çäº§åï¼
main_line = np.sin(x) * 2.5 + 1

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))

# --- å¾1ï¼æ²¡æåæ³¨æå å·¥ ---
# å¸åçé¢æ¡å¾ï¼ææçº¿é½å¨äºå¤ºæ³¨æå
for i, line in enumerate(lines):
    ax1.plot(x, line, label=f'Competitor {i}')
ax1.plot(x, main_line, label='Our Product')

# --- å¾2ï¼æåæ³¨æå å·¥ ---
# ç­ç¥ï¼å¼±åèæ¯ï¼çªåºåæ¯
for line in lines:
    ax1.plot(x, line) # å·¦å¾é»è¾
    # å³å¾é»è¾ï¼ç°è²ãç»çº¿ãåéæ
    ax2.plot(x, line, color='lightgray', linewidth=1, alpha=0.6)

# éç¹çº¿ï¼æ·±éè²ãå ç²ãä¸éæ
ax2.plot(x, main_line, color='teal', linewidth=3, label='Our Product')

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://img2024.cnblogs.com/blog/83005/202601/83005-20260104230912198-1217895469.png" alt="" loading="lazy"></p>
<h1 id="3-æ»ç»">3. æ»ç»</h1>
<p><strong>åæ³¨æå å·¥</strong>æ¯æ°æ®å¯è§åä¸­ç"è§è§è¯­æ³"ï¼å®éè¿é¢è®¤ç¥çè§è§ç¹å¾å¼å¯¼è¯»èçæ³¨æåã</p>
<p>å°±åçç»çå¯¼æ¸¸ä¼æåºé£æ¯ä¸­çäº®ç¹ï¼ææçæ°æ®å¯è§ååºè¯¥å¼å¯¼è¯»èç«å³çå°æ°æ®æäºä¸­<strong>æå³é®</strong>çé¨åã</p>
<p>æ°æ®å¯è§åä¸ä»ä»æ¯ææ°æ®ç»åºæ¥ï¼æ´æ¯ä¸åº<strong>æ³¨æåçç®¡çèºæ¯</strong>ã</p>
<ul>
<li><strong>ä¸è¦è®©è¯»èçç¼çå»âå·¥ä½â</strong>ï¼å¦æä»ä»¬éè¦è±å¥½å ç§éå»æ¾æå¤§å¼ï¼é£æ¯æä»¬è®¾è®¡èçå¤±èã</li>
<li><strong>å©ç¨å¯¹æ¯</strong>ï¼é¢è²ï¼äº®/æï¼ãå¤§å°ï¼å¤§/å°ï¼ãä½ç½®ï¼å/åï¼ï¼è¿äºç©çå±æ§çå¯¹æ¯è½ç¬é´è§¦åå¤§èçâç³»ç»1âï¼ç´è§ç³»ç»ï¼ã</li>
</ul>
<p>ä¸æ¬¡ä½¿ç¨ <code>Matplotlib</code> ç»å¾æ¶ï¼å¨ <code>plt.show()</code> ä¹åï¼è¯·åä¸æ¥é®èªå·±ä¸ä¸ªé®é¢ï¼â<strong>æè¿å¼ å¾éï¼ææ³è®©è¯»èç¬¬ä¸ç¼çå°çæ¯ä»ä¹ï¼</strong>â</p>
<p>ä¸æ¦ç¡®å®äºç­æ¡ï¼å°±è¯·å¤§èå°ä½¿ç¨ä¸è¿°æå·§ï¼æå®âæ¨âå°è¯»èç¼åå§ï¼</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-04 23:11">2026-01-04 23:10</span>&nbsp;
<a href="https://www.cnblogs.com/wang_yb">wang_yb</a>&nbsp;
éè¯»(<span id="post_view_count">101</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19440010);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19440010', targetLink: 'https://www.cnblogs.com/wang_yb/p/19440010', title: 'åæ³¨æå å·¥ï¼è®©ä½ çå¾è¡¨æä½è¯»èçç¼ç' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å¦ä½ç¨ AI + OpenSpec é©±å¨å¢éè¿­ä»£å¼å ]]></title>
    <link>https://www.cnblogs.com/zh94/p/19439980</link>
    <guid>3f473d9ac64631d967faddf73eb10d02</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/zh94/p/19439980" title="åå¸äº 2026-01-04 22:49">
    <span role="heading" aria-level="2">å¦ä½ç¨ AI + OpenSpec é©±å¨å¢éè¿­ä»£å¼å</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>ä»æ··ä¹±å°æåºï¼ä»å£å£ç¸ä¼ å°ç¥è¯æ²æ·ï¼æä»¬ç¨ä¸æ¬¡å®è·µæ¢ç´¢äº AI è¾å©å¢éå¼åçå®æ´æ¶æ</p>
<h2 id="ä¸ä¸ªçå®ççç¹">ä¸ä¸ªçå®ççç¹</h2>
<p>ä½ æ¯å¦éå°è¿è¿æ ·çåºæ¯ï¼</p>
<ol>
<li>åä¸ªæ­£åè¡¨è¾¾å¼ï¼AI ç§ææã</li>
<li>åä¸ªç¬ç«èæ¬ï¼AI çé¦ã</li>
<li>åä¸ªç«é·ç½é¡µï¼AI çç Xï¼</li>
</ol>
<p>ä½æ¯ä¸æ¦å° AI æè¿ä¸ä¸ªåºå¤§çå¾®æå¡é¡¹ç®éï¼å®ä¼¼ä¹ç«å»éæºä¸ºäºâæ°æå°ç½âï¼</p>
<p>ç±äº AI æ æ³çè§£ä¸å¹´ååä¸çé£æ®µâå¥è©ä»£ç âç©¶ç«ä¸ºä½ï¼å¯¼è´æ¯æ¬¡å¯¹è¯é½åâå¼ç²çâï¼Review AI çæä»£ç çæ¶é´ï¼æ¯èªå·±éåä¸éè¿è¦é¿ã</p>
<p>è¿äºé®é¢çæ¬è´¨å¶å®æ¯ï¼<strong>ç¼ºä¹ä¸ä¸ªç»æåçãAI å¯çè§£çç¥è¯ç®¡çä½ç³»</strong>ã</p>
<p>æè¿ï¼æä»¬å¨ä¸ä¸ªå¤æçå¾®æå¡é¡¹ç®ä¸­ï¼æ¢ç´¢å¹¶å®è·µäºä¸å¥ <strong>âäººæºååè¿­ä»£å¼åâçå®æ´æ¶æ</strong>ãæ´ä¸ªè¿ç¨æ²¡æé¢å¤ç¼åä¸è¡å·¥å·ä»£ç ï¼ä»éè¿å¯¹è¯åç°æå·¥å·é¾ï¼å°±è®© AI ä»âé¡¹ç®å°ç½âæé¿ä¸ºâçæä¸å¡çå¼åä¼ä¼´âã</p>
<p>æ¬æå°å®æ´è¿åè¿ä¸è¿ç¨ï¼å¹¶æ»ç»åºå¯å¤å¶çæ¹æ³è®ºã</p>
<h2 id="ç¬¬ä¸æ­¥å»ºç«-ai-å¯çè§£çé¡¹ç®å¤§è">ç¬¬ä¸æ­¥ï¼å»ºç« AI å¯çè§£çâé¡¹ç®å¤§èâ</h2>
<p>å¤§å¤æ°å¢éçææ¡£æ¯åç»äººççï¼èé AIï¼</p>
<ul>
<li>â é£ä¹¦/Confluence/Wiki éçè®¾è®¡ææ¡£å¤ªå¤ï¼å¤ªæã</li>
<li>â æ£è½å¨åå¤ç README â AI æä¸ä½éç¹ã</li>
<li>â èµæ·±åå·¥èä¸­çéæ§ç¥è¯ â AI æ°¸è¿å­¦ä¸ä¼ã</li>
</ul>
<p>æä»¬çè§£æ³æ¯å¼å¥ <strong>OpenSpec</strong> è§èï¼å¹¶åºäºå®æå»ºä¸æ´å¥âç¥è¯è¿­ä»£ä½ç³»âã</p>
<p>OpenSpec æ ¸å¿çå¿µæå¶ç®åï¼è®© AI æç¡®ç¥éâç¥è¯å¨åªãå¦ä½ç¨ãä»¥åä¸ºä»ä¹è¿æ ·åâã</p>
<h3 id="11-æ­å»ºç¥è¯éª¨æ¶">1.1 æ­å»ºâç¥è¯éª¨æ¶â</h3>
<p>æ è®ºæ¯æ°é¡¹ç®è¿æ¯åå²é¡¹ç®ï¼ç¬¬ä¸æ­¥é½æ¯éè¿å½ä»¤è¡åå§åä¸ä¸ªæ åçç¥è¯ç®å½ç»æï¼</p>
<pre><code class="language-bash">cd /path/to/your-project
openspec init
</code></pre>
<p>çæçç®å½ç»æï¼ä¾¿æ¯é¡¹ç®çâç¥è¯éª¨æ¶âï¼</p>
<pre><code>openspec/
 âââ AGENTS.md       # ãå¤§èæä»¤ãAI å·¥ä½æåï¼å¼åè§èãæµè¯ç­ç¥ãéè¯¯ç è®¾è®¡ç­ï¼
 âââ project.md      # ãé¿æè®°å¿ãé¡¹ç®ä¸ä¸æï¼ç®æ ãæ ¸å¿æ¯è¯­ãææ¡£ç´¢å¼ï¼
 âââ specs/          # ãæè½æ ãå·²å®ç°è½åçè§èï¼åäºä»ä¹ï¼
 âââ changes/        # ãç­æè®°å¿ãå¾å¤ççåæ´ææ¡ï¼è¦åä»ä¹ï¼
 âââ docs/           # ãç¥è¯åºãè¯¦ç»ææ¡£ï¼ä¸ºä»ä¹è¿æ ·åï¼
</code></pre>
<p>æ­¤ä¸¾çæ ¸å¿å¨äºä¸º AI æä¾ä¸ä¸ªæç¡®çç»æåç´¢å¼ï¼èéä¸è¡èå°å¡å¥ææææ¡£ã</p>
<p>å¶ä¸­ <code>docs</code> å¹¶éOpenSpecè§èï¼èæ¯èªè¡åå»ºçç®å½ï¼åç»­ç¨ä½è¯¦ç»ç´¢å¼æ¶ä½¿ç¨ï¼éè¦æå¨åå»ºã</p>
<h3 id="12-è®©-ai-è®¤è¯ä½ çé¡¹ç®">1.2 è®© AI âè®¤è¯âä½ çé¡¹ç®</h3>
<p>å¯¹äºå·²æé¡¹ç®ï¼AI èµ·åé¢å¯¹ä¸çç©ºç½ãæä»¬éç¨ <strong>âç´¢å¼å± + æç»å±â</strong> çåå±ç»ææ¥å¡«åç¥è¯ã</p>
<p><strong>ç´¢å¼å±ï¼<code>AGENTS.md</code> &amp; <code>project.md</code>ï¼</strong></p>
<p>è¿éä¸åé¿ç¯å¤§è®ºï¼åªæä¾âå°å¾âã</p>
<ul>
<li><code>AGENTS.md</code>ï¼å®ä¹ AI çæ ¸å¿å¼åè§èï¼å¦å½åãéè¯¯ç ãæµè¯ç­ç¥ï¼ã</li>
<li><code>project.md</code>ï¼éè¿°ä¸å¡å±æ§ç¥è¯ï¼å¦é¡¹ç®ç®æ ãæ ¸å¿æ¯è¯­ãéæ±æ¦è¦ï¼ï¼å¹¶ææåé¡¹è¯¦ç»ææ¡£å¨ <code>docs/</code> ä¸­çä½ç½®ç´¢å¼ã</li>
</ul>
<p><strong>æç»å±ï¼<code>openspec/docs/</code>ï¼</strong>ï¼è¿éå­æ¾çæ­£çâå¹²è´§âï¼è¯¦ç»çæ¶æè®¾è®¡ãå¤æçéæ±ææ¡£ãä¸å¡é»è¾è¯´æã</p>
<p>å·¥ä½æµå½¢æé­ç¯ï¼å½ AI æ¥å°ä»»å¡ â åè¯» <code>AGENTS.md</code>ï¼è·åè§èï¼â åè¯» <code>project.md</code>ï¼è·åä¸å¡èæ¯ï¼â æ ¹æ®ç´¢å¼å®ä½å° <code>docs/</code> ä¸çå·ä½ææ¡£ â æ·±å»çè§£ä¸ä¸æåå¼å§å·¥ä½ã</p>
<p>ææ£çæ¯ï¼ä½ æ éæå¨ç¼åè¿äºç´¢å¼ãåªéåèµ·ä¸ä¸ª OpenSpec ææ¡ï¼éè¿å¯¹è¯å¼å¯¼ AI èªå·±å»æ¢³çé¡¹ç®æ¶æåä¸å¡ï¼å®ä¾¿è½èªå¨çæåå§ç <code>project.md</code> åå®¹ã</p>
<blockquote>
<p><strong>ç¥è¯è¿­ä»£æç¤º</strong>ï¼åç»­å¨ docs/ ä¸ç»´æ¤æ°ç¥è¯æ¶ï¼éå¼å¯¼ AI åºäºæ´æ°åçç¥è¯åºï¼éæ°æ»ç»çææ°ç project.mdãä¸ºæ­¤ï¼æä»¬å¯ä»¥å®ä¹ä¸ä¸ªãææ¡£ç®¡çæåãä½ä¸ºååï¼ç¡®ä¿ AI æ¯æ¬¡è¿­ä»£æ¶é½è½éµå¾ªï¼ä»èä¿éä¸å¡ç¥è¯çæç»­æææ§åä¸è´æ§ã</p>
</blockquote>
<h2 id="ç¬¬äºæ­¥åä½æºå¶åç®¡çä»£ç ä¸æ ·ç®¡çç¥è¯">ç¬¬äºæ­¥ï¼åä½æºå¶ââåç®¡çä»£ç ä¸æ ·ç®¡çâç¥è¯â</h2>
<p>å»ºç«äºåå§ç¥è¯åºï¼è¿éè®©ç¥è¯éçé¡¹ç®è¿­ä»£èæ´æ°ãæä»¬å¼å¥äºä¸å¥ <strong>Change-Drivenï¼åæ´é©±å¨ï¼</strong> çåä½æµç¨ï¼å¹¶å°å¶ä½ä¸ºå¢éæ ¸å¿ååä¸¥æ ¼æ§è¡ã</p>
<p>æææ°çéæ±æåæ´ï¼é½å¿é¡»ä¸¥æ ¼éè¿ OpenSpec åèµ·ææ¡ï¼</p>
<ol>
<li><strong>éæ±åæ´ â åèµ· OpenSpec ææ¡</strong>
<ul>
<li>å¼åæ°éæ±æ¶ï¼å¿é¡»éè¿ OpenSpec åå»ºææ¡ï¼<code>changes/proposal-xxx.md</code>ï¼ã</li>
<li>äººå·¥å®¡æ¥éç¹ï¼æ ¸å¯¹ AI çæçææ¡ä¸­ <strong>Whyï¼èæ¯ï¼ãWhatï¼ç®æ ï¼ãImpactï¼å½±åï¼</strong> æ¯å¦æ¸æ°ä¸è´ï¼ç¡®ä¿äººä¸ AI ççè§£å¯¹é½ã</li>
</ul>
</li>
<li><strong>AI è¾å©å®ç°</strong>
<ul>
<li>AI è¯»åå·²éè¿çææ¡ï¼ç»å <code>specs/</code> ä¸­å·²æçè½åè§èï¼çææä¿®æ¹ä»£ç åæµè¯ç¨ä¾ã</li>
<li>äººå·¥è¿è¡ Code Reviewã</li>
</ul>
</li>
<li><strong>ç¥è¯æ²æ·ï¼å½æ¡£ï¼</strong>
<ul>
<li>è¿è¡ <code>openspec archive</code> å½ä»¤ã</li>
<li>AI å°èªå¨ææ¬æ¬¡åæ´ææ¶åçæ°ç¥è¯ãæ°è§èï¼æ´æ°å° <code>specs/</code> å <code>docs/</code> ä¸­ï¼å®æç¥è¯å¥åºã</li>
</ul>
</li>
</ol>
<p>éè¿è¿ä¸ªæµç¨ï¼æ¯ä¸æ¬¡éæ±è¿­ä»£åå¶äº§ççä»£ç ï¼é½å®æ´å°é­ç¯å¹¶æ²æ·å° OpenSpec ä½ç³»éãAI å¨å¤çåç»­éæ±æ¶ï¼ä¾¿æäºå¯è¿½æº¯ååé´çâåå²ç»éªâã</p>
<h2 id="å®è·µå»ºè®®ä¸åºæ¯èé">å®è·µå»ºè®®ä¸åºæ¯èé</h2>
<p>å¨å®éæä½ä¸­ï¼ä½ è¿ä¼éå°ä¸äºå·ä½é®é¢ï¼ä¾å¦ï¼</p>
<p><strong>Qï¼å¾®æå¡é¡¹ç®ä¸å­æå¡ä¼å¤ï¼åºè¯¥æ¯ä¸ªæå¡åå§åä¸å¥ OpenSpecï¼è¿æ¯æ´ä¸ªé¡¹ç®å±ç¨ä¸å¥ï¼</strong></p>
<p>æä»¬çç»éªåæ¯ï¼<strong>åºäºç¥è¯ç¬ç«æ§è¿è¡å¤æ­</strong>ã</p>
<ul>
<li>å¦ææä¸ªæ¨¡åï¼å¦ç¨æ·ä¸­å¿ï¼çä¸å¡ç¥è¯ä¸å¶ä»æ¨¡åéååº¦å¾ä½ï¼ä¾å¦&lt;30%ï¼ï¼ç¬ç«åå§åä¸ä¸ª OpenSpec ç®å½æ¯æ´æ¸æ°çéæ©ã</li>
<li>å¦æå¤ä¸ªæå¡å±äº«å¤§éå±æ§ä¸å¡ç¥è¯ï¼éååº¦&gt;70%ï¼ï¼å±ç¨ä¸å¥OpenSpec æ´è½ä¿è¯ç¥è¯çä¸è´æ§å AI ççè§£æçã</li>
</ul>
<p>ä¸åçä¸å¡æ¶æéè¦çµæ´»éç¨ä¸åçç­ç¥ã</p>
<h2 id="èµ°åäºº--aiçå¢éåä½">èµ°åâäºº + AIâçå¢éåä½</h2>
<p>å½è¿å¥ä»¥ç¥è¯ä¸ºæ ¸å¿çè¿­ä»£ä½ç³»ç¨³åºè¿è¡åï¼ä½ ä¼åç°ï¼</p>
<ul>
<li>éæ§ç¥è¯è¢«å½»åºæ¾æ§åã</li>
<li>æ°æåï¼åæ¬ AIï¼ å­¦ä¹ ææ¬å¤§å¹éä½ã</li>
<li>å¨åç»­ç¼åæ¥å£ææ¡£ãæ¶æè¿­ä»£æä»£ç éææ¶ï¼AI çæè½å°è¢«æåæ¾å¤§ã</li>
</ul>
<p>æªæ¥çé«æå¢éåä½ï¼æ¯ <strong>âäºº + AIâ</strong> çæ·±åº¦èåãè®© AI æä¸ºå¢éå¿ å®çâç¥è¯ä¼ä¼´âèä¸ä»ä»æ¯ä¸´æ¶çâä»£ç å©æâï¼è¿ï¼ææ¯ AI æ¶ä»£å¢éå¼åçæ­£ç¡®æå¼æ¹å¼ã</p>
<hr>
<p><strong>æ¬¢è¿æ¥å¸¸äº¤æµ</strong></p>
<p>AI é©±å¨å¢éå¼åæ¯è¿ä¸ªæ¶ä»£çæ°å½é¢ï¼æ¬¢è¿å¤§å®¶å å¾®ä¿¡äºç¸äº¤æµå¿å¾ã</p>
<p>ð æ³è¦è¿ç¾¤çæåï¼æ«ç æ¶å¤æ³¨ âAIå®éªç¾¤âï¼çå°æ¶æ¯åä¼ç¬¬ä¸æ¶é´æä½ è¿ç¾¤ã</p>
<p>ç¾¤å®ä½ï¼AIå·¥å·ææ/å®æç»éªäºå©<br>
ç¾¤è§åï¼ä¸æ°´ç¾¤ãä¸å¹¿åãå¹²è´§ä¼å</p>
<p>æ¬¢è¿è®¿é®è¯¥é¾æ¥è·åç¾¤ä¿¡æ¯ï¼<a href="https://zhaozhihao.com/archives/KRMxDLo4" target="_blank" rel="noopener nofollow">https://zhaozhihao.com/archives/KRMxDLo4</a></p>
<hr>
<p><strong>å¥½æç« å¼å¾è¢«æ´å¤äººçè§ï¼æ¢ç¶çå°è¿éäºï¼éæç¹ä¸ªèµðåå³æ³¨ï¼å¹¶è½¬åç»æ´å¤çæåå§ï¼æè°¢ã</strong></p>
<blockquote>
<p>ä½èï¼æ°å­çå½è´¾åæ¯ãå¾®ä¿¡ï¼x_h886688</p>
</blockquote>
<p>å¬ä¼å·åæå°åï¼<a href="https://mp.weixin.qq.com/s/CJPCsYoQOo5Ib1Q8f0IZBA" target="_blank" rel="noopener nofollow">å¦ä½ç¨ AI + OpenSpec é©±å¨å¢éè¿­ä»£å¼å</a><br>
ä¸ªäººç½ç«åæå°åï¼<a href="https://zhaozhihao.com/archives/rGL0TwgK" target="_blank" rel="noopener nofollow">å¦ä½ç¨ AI + OpenSpec é©±å¨å¢éè¿­ä»£å¼å</a></p>

</div>
<div id="MySignature" role="contentinfo">
    <br>
<fieldset style="padding: 10px; margin: 10px; background-color: #fff; width: 850px; border: 1px solid black; font-size: blod">
<p><span style="color: black">çæå£°æ</span></p>
<hr style="color: black">
<p><span style="color: black">ä½èï¼éå¬é</span></p>
<p><span style="color: black">åºå¤ï¼</span><a style="color: black" href="https://www.cnblogs.com/zh94/" target="_blank">éå¬éçææ¯åå®¢--https://www.cnblogs.com/zh94/</a></p>
<p><span style="color: black">æ¨çæ¯ææ¯å¯¹åä¸»æå¤§çé¼å±ï¼æè°¢æ¨çè®¤çéè¯»ã</span></p>
<p><span style="color: black">æ¬æçæå½ä½èææï¼æ¬¢è¿è½¬è½½ï¼ä½æªç»ä½èåæå¿é¡»ä¿çæ­¤æ®µå£°æï¼ä¸å¨æç« é¡µé¢ææ¾ä½ç½®ç»åºåæè¿æ¥ï¼å¦åä¿çä»»ä½è¿½ç©¶æ³å¾è´£ä»»çæå©ã</span></p>
</fieldset>

<div style="padding: 10px; margin: 10px; background-color: #fff; width: 850px; border: 0px solid black; font-size: blod">
     <img src="https://images.cnblogs.com/cnblogs_com/zh94/1586631/o_211225012748_weixin_saoma.png">&nbsp;&nbsp;&nbsp;&nbsp;<img src="https://images.cnblogs.com/cnblogs_com/zh94/1586631/o_211225012748_weixin_saoma.png">
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-04 22:49">2026-01-04 22:49</span>&nbsp;
<a href="https://www.cnblogs.com/zh94">éå¬é</a>&nbsp;
éè¯»(<span id="post_view_count">39</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19439980);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19439980', targetLink: 'https://www.cnblogs.com/zh94/p/19439980', title: 'å¦ä½ç¨ AI + OpenSpec é©±å¨å¢éè¿­ä»£å¼å' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Flinkæºç éè¯»ï¼Watermarkæºå¶ ]]></title>
    <link>https://www.cnblogs.com/Jackeyzhe/p/19439749</link>
    <guid>b4b72d0d837925c64d2012811afba67b</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Jackeyzhe/p/19439749" title="åå¸äº 2026-01-04 20:59">
    <span role="heading" aria-level="2">Flinkæºç éè¯»ï¼Watermarkæºå¶</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/1828322/202601/1828322-20260104205855506-262249653.png" alt="Flinkæºç éè¯»ï¼Watermarkæºå¶" class="desc_img">
        åé¢æä»¬å·²ç»æ¢³çäº Flink ç¶æå Checkpoint ç¸å³çæºç ãä»æ¬æå¼å§ï¼æä»¬åæ¥å³æ³¨å¦å¤å ä¸ªæ ¸å¿æ¦å¿µï¼å³æ¶é´ãWatermark åçªå£ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>åé¢æä»¬å·²ç»æ¢³çäº Flink ç¶æå Checkpoint ç¸å³çæºç ãä»æ¬æå¼å§ï¼æä»¬åæ¥å³æ³¨å¦å¤å ä¸ªæ ¸å¿æ¦å¿µï¼å³æ¶é´ãWatermark åçªå£ã</p>
<h3 id="åå¨åé¢">åå¨åé¢</h3>
<p>å¨ Flink ä¸­ Watermark æ¯ç¨æ¥è§£å³æ°æ®ä¹±åºé®é¢çï¼å®ä¹æ¯çªå£å³é­çè§¦åæ¡ä»¶ãå¯¹äº Watermark çæ¦å¿µåç¨æ³è¿ä¸çæçåå­¦å¯ä»¥åéè¯»<a href="https://jackeyzhe.github.io/2025/06/30/Flink%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E6%97%B6%E9%97%B4%E4%B8%8EWatermark/" target="_blank" rel="noopener nofollow">Flinkå­¦ä¹ ç¬è®°ï¼æ¶é´ä¸Watermark</a>ä¸æãä¸é¢æä»¬è¿å¥æ­£é¢ï¼å¼å§æ¢³ç Watermark ç¸å³çæºç ã</p>
<h3 id="watermark-å®ä¹">Watermark å®ä¹</h3>
<p>Watermark çå®ä¹éå¸¸ç®åï¼å®ç»§æ¿äº <code>StreamElement</code> ç±»ï¼åé¨åªæä¸ä¸ª timestamp åéã</p>
<pre><code class="language-java">@PublicEvolving
public class Watermark extends StreamElement {

    /** The watermark that signifies end-of-event-time. */
    public static final Watermark MAX_WATERMARK = new Watermark(Long.MAX_VALUE);

    /** The watermark that signifies is used before any actual watermark has been generated. */
    public static final Watermark UNINITIALIZED = new Watermark(Long.MIN_VALUE);

    // ------------------------------------------------------------------------

    /** The timestamp of the watermark in milliseconds. */
    protected final long timestamp;

    /** Creates a new watermark with the given timestamp in milliseconds. */
    public Watermark(long timestamp) {
        this.timestamp = timestamp;
    }

    /** Returns the timestamp associated with this {@link Watermark} in milliseconds. */
    public long getTimestamp() {
        return timestamp;
    }

    // ------------------------------------------------------------------------

    @Override
    public boolean equals(Object o) {
        return this == o
                || o != null
                        &amp;&amp; o.getClass() == this.getClass()
                        &amp;&amp; ((Watermark) o).timestamp == timestamp;
    }

    @Override
    public int hashCode() {
        return (int) (timestamp ^ (timestamp &gt;&gt;&gt; 32));
    }

    @Override
    public String toString() {
        return "Watermark @ " + timestamp;
    }
}
</code></pre>
<h3 id="watermark-å¤çè¿ç¨">Watermark å¤çè¿ç¨</h3>
<p>æä»¬åæ¥åé¡¾ä¸ä¸ Watermark ççææ¹æ³ã</p>
<pre><code class="language-java">SingleOutputStreamOperator&lt;Event&gt; withTimestampsAndWatermarks = source
        .assignTimestampsAndWatermarks(
                WatermarkStrategy.forBoundedOutOfOrderness(Duration.ofSeconds(20))
        );
</code></pre>
<h4 id="åå§å">åå§å</h4>
<p>å¨å®ä¹ Watermark çæ¶åï¼æä»¬è°ç¨ assignTimestampsAndWatermarks æ¹æ³ã</p>
<pre><code class="language-java">public SingleOutputStreamOperator&lt;T&gt; assignTimestampsAndWatermarks(
        WatermarkStrategy&lt;T&gt; watermarkStrategy) {
    final WatermarkStrategy&lt;T&gt; cleanedStrategy = clean(watermarkStrategy);
    // match parallelism to input, to have a 1:1 source -&gt; timestamps/watermarks relationship
    // and chain
    final int inputParallelism = getTransformation().getParallelism();
    final TimestampsAndWatermarksTransformation&lt;T&gt; transformation =
            new TimestampsAndWatermarksTransformation&lt;&gt;(
                    "Timestamps/Watermarks",
                    inputParallelism,
                    getTransformation(),
                    cleanedStrategy,
                    false);
    getExecutionEnvironment().addOperator(transformation);
    return new SingleOutputStreamOperator&lt;&gt;(getExecutionEnvironment(), transformation);
}
</code></pre>
<p>è¿ä¸ªæ¹æ³æ¥æ¶äºä¸ä¸ª WatermarkStrategy åæ°ï¼æå®å°è£å° TimestampsAndWatermarksTransformation ä¸­ä¹åï¼å°±æ·»å å° transformations åè¡¨ä¸­äºãå¨çæ StreamGraph çè¿ç¨ä¸­ï¼ä¼è°ç¨æ¯ä¸ª transformation ç transform æ¹æ³ã</p>
<p><img alt="transform" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1766047572/Blog/flink/15/watermarkTranslate.png" class="lazyload"></p>
<p>éè¿è¿ä¸ªè°ç¨é¾è·¯ï¼åå»ºåºäº TimestampsAndWatermarksOperatorFactoryï¼å¨åå§å StreamTask æ¶ï¼ä¼è°ç¨ <code>TimestampsAndWatermarksOperatorFactory.createStreamOperator</code> æ¹æ³æ¥åå»º TimestampsAndWatermarksOperatorï¼å¹¶è°ç¨å®ç open æ¹æ³ã</p>
<p>å¨è¿ä¸ª open æ¹æ³ä¸­ï¼ä¸»è¦æ¯çæ timestampAssigner å watermarkGeneratorãtimestampAssigner æ¯ç¨äºæåæ¶é´æ³ï¼watermarkGenerator æ¯ç¨äºçæ Watermarkã</p>
<p>çæå®æä¹åæ³¨åäºä¸ä¸ªå®æ¶å¨ï¼å°æå®æ¶é´åä¼è°ç¨ onProcessingTime æ¹æ³ã</p>
<pre><code class="language-java">public void onProcessingTime(long timestamp) throws Exception {
    watermarkGenerator.onPeriodicEmit(wmOutput);

    final long now = getProcessingTimeService().getCurrentProcessingTime();
    getProcessingTimeService().registerTimer(now + watermarkInterval, this);
}
</code></pre>
<p>è¿ä¸ªæ¹æ³çé»è¾ä¹å¾ç®åï¼ååéåå»ºå¹¶åé Watermarkï¼ç¶ååæ³¨åä¸ä¸ªå®æ¶å¨ã</p>
<h4 id="åé-watermark">åé Watermark</h4>
<p><img alt="emitWatermark" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1766112568/Blog/flink/15/emitWatermark.png" class="lazyload"></p>
<p>æä»¬ä»¥ BoundedOutOfOrdernessWatermarks ä¸ºä¾ï¼å®åä¸æ¸¸åéäºä¸ä¸ª Watermarkï¼æ¶é´æ³ä¸º maxTimestamp - outOfOrdernessMillis - 1ï¼maxTimestamp æ¯å½åæå¤§çäºä»¶æ¶é´æ³ï¼outOfOrdernessMillis æ¯æä»¬å®ä¹çå¨ææ¶é´æ¯«ç§å¼ï¼ãéåå¨ WatermarkEmitter.emitWatermark æ¹æ³ä¸­ï¼æ´æ°äºå½å Watermark çå¼ãæå RecordWriterOutput.emitWatermark åæ¯åä¸æ¸¸å¹¿æ­å½åç Watermarkã</p>
<h4 id="ä¸æ¸¸å¤ç">ä¸æ¸¸å¤ç</h4>
<p>ä¸æ¸¸å¤çæ¹æ³æä»¬ä» <code>StreamOneInputProcessor.processInput</code> å¥æï¼åæ¥çå·ä½çè°ç¨é¾è·¯ã</p>
<p><img alt="processWatermark" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1766133213/Blog/flink/15/processWatermark.png" class="lazyload"></p>
<p>å¨ inputWatermark æ¹æ³ä¸­ï¼åæ¯å¯¹ alignedSubpartitionStatuses è¿è¡è°æ´ï¼alignedSubpartitionStatuses è¿ä¸ªåéä¸»è¦æ¯ç¨æ¥è·åæå°ç Watermarkãæåè°ç¨äº <code>findAndOutputNewMinWatermarkAcrossAlignedSubpartitions</code> æ¹æ³ãè¿ä¸ªæ¹æ³ä¸­ï¼ä¼è·åå°ææä¸æ¸¸æå°ç Watermarkï¼å¦æå®å¤§äºæè¿åéçä¸ä¸ª Watermarkï¼å°±ä¼åä¸æ¸¸åéã</p>
<pre><code class="language-java">public void emitWatermark(Watermark watermark) throws Exception {
    watermarkGauge.setCurrentWatermark(watermark.getTimestamp());
    operator.processWatermark(watermark);
}
</code></pre>
<p>è¿ä¸ªåéæ¹æ³ä¸­ï¼è°ç¨äº <code>operator.processWatermark</code>ï¼æä»¬æ¥ççè¿ä¸ªå¤çæ¹æ³ã</p>
<p><img alt="advanceWatermark" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1766136153/Blog/flink/15/advanceWatermark.png" class="lazyload"></p>
<p>å¨ tryAdvanceWatermark æ¹æ³ä¸­å¦æ Watermark çæ¶é´å¤§äº eventTimeTimersQueue éåä¸­å¤´èç¹çæ¶é´ï¼é£ä¹å¯¹ eventTimeTimersQueue è¿ä¸ªéåè¿è¡åºéæä½ï¼è¿ä¸ªæä½æå³çè§¦åäºçªå£è®¡ç®ã</p>
<pre><code class="language-java">public boolean tryAdvanceWatermark(
        long time, InternalTimeServiceManager.ShouldStopAdvancingFn shouldStopAdvancingFn)
        throws Exception {
    currentWatermark = time;
    InternalTimer&lt;K, N&gt; timer;
    boolean interrupted = false;
    while ((timer = eventTimeTimersQueue.peek()) != null
            &amp;&amp; timer.getTimestamp() &lt;= time
            &amp;&amp; !cancellationContext.isCancelled()
            &amp;&amp; !interrupted) {
        keyContext.setCurrentKey(timer.getKey());
        eventTimeTimersQueue.poll();
        triggerTarget.onEventTime(timer);
        taskIOMetricGroup.getNumFiredTimers().inc();
        // Check if we should stop advancing after at least one iteration to guarantee progress
        // and prevent a potential starvation.
        interrupted = shouldStopAdvancingFn.test();
    }
    return !interrupted;
}
</code></pre>
<p>ä¹å Watermark å°±éçæ°æ®æµä¸ç´å° sink èç¹ï¼å¨ StreamSink ä¸­ï¼æ¯æç¨æ·èªå·±å®ç°æ¹æ³å sink ä¸­åå¥ Watermarkï¼é¤æ­¤ä¹å¤ä»ä¹ä¹ä¸åã</p>
<h3 id="æ»ç»">æ»ç»</h3>
<p>æ¬ææä»¬ä¸èµ·æ¢³çäº Watermark ç¸å³çæºç ï¼ä» Watermark çå®ä¹ï¼å° Watermark çå¤çè¿ç¨ãå¤çè¿ç¨åæäºåå§åãä¸æ¸¸åéåä¸æ¸¸å¤çä¸é¨åãå¨ä¸æ¸¸å¤çé¨åï¼å³äºè§¦åçªå£è®¡ç®çé¨åæä»¬ç®åå¸¦è¿äºï¼åé¢ä¼åè¯¦ç»ä»ç»è¿é¨åã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-04 20:59">2026-01-04 20:59</span>&nbsp;
<a href="https://www.cnblogs.com/Jackeyzhe">Jackeyzhe</a>&nbsp;
éè¯»(<span id="post_view_count">40</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19439749);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19439749', targetLink: 'https://www.cnblogs.com/Jackeyzhe/p/19439749', title: 'Flinkæºç éè¯»ï¼Watermarkæºå¶' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ãAzure Web AppãGithub Actioné¨ç½²Jaråå°App Serviceæ¥400éè¯¯ ]]></title>
    <link>https://www.cnblogs.com/lulight/p/19439653</link>
    <guid>986b341ddc4b1536bd4322805a099abe</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/lulight/p/19439653" title="åå¸äº 2026-01-04 20:07">
    <span role="heading" aria-level="2">ãAzure Web AppãGithub Actioné¨ç½²Jaråå°App Serviceæ¥400éè¯¯</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<h1>é®é¢æè¿°</h1>
<p>éè¿github acitoné¨ç½²azure app serviceæå¡çæ¶åï¼éè§400æ¥éã</p>
<p>æ¥éä¿¡æ¯éå¸¸ç®åï¼</p>
<blockquote>
<p>Starting deployment for web app...<br>Package deployment using OneDeploy initiated.<br>Error: Failed to deploy web package to App Service.<br><span style="color: rgba(255, 0, 0, 1)"><strong>Error: Deployment Failed, Error: Failed to deploy web package using OneDeploy to App Service.</strong></span><br>Bad Request (CODE: 400)</p>
</blockquote>
<p> è¿ä¸ªé®é¢åºè¯¥å¦ä½è°æ¥å¢ï¼</p>
<p>&nbsp;</p>
<h1>é®é¢è§£ç­</h1>
<p>å¨Github Acitonä¸­ï¼ä½¿ç¨ Azure WebApp(azure/webapps-deploy@v3)æ¥é¨ç½²App Serviceçåºç¨, è¿æ¬¡é¨ç½²çæ¯ä¸ä¸ªjaråã</p>
<p>Github Action  èæ¬:</p>
<blockquote>
<p>- name: Azure WebApp<br>uses: azure/webapps-deploy@v3<br>with:<br>app-name: '&lt;app service name&gt;'<br>package: ${{ github.workspace }}/target/*.jar<br> </p>
</blockquote>
<p>æ¥çAzureææ¡£ï¼ä»ç»é¨ç½²javaåºç¨æ¶ï¼ä½¿ç¨az cliå½ä»¤ï¼github actionåmaven æä»¶é½æ¯ä½¿ç¨çKudu OneDeployæ¥å£( https://&lt;your web app&gt;.scm.chinacloudsites.cn/api/publish?type=jar )</p>
<p><img alt="image" width="666" height="235" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2127802/202601/2127802-20260104200136753-968729769.png" class="lazyload"></p>
<p>(ææ¡£é¾æ¥ï¼<a href="https://docs.azure.cn/zh-cn/app-service/configure-language-java-deploy-run?tabs=linux&amp;pivots=java-tomcat#deploying-your-app" target="_blank" rel="noopener nofollow">https://docs.azure.cn/zh-cn/app-service/configure-language-java-deploy-run?tabs=linux&amp;pivots=java-tomcat#deploying-your-app</a>)</p>
<p>&nbsp;</p>
<p>æ ¹æ®ä»¥ä¸ä¿¡æ¯ï¼å°±å°è¯ä½¿ç¨az webapp deployå½ä»¤ç´æ¥é¨ç½²jarååºç¨ï¼åç°å¤äºä¸å¥éè¯¯æç¤ºä¿¡æ¯ï¼</p>
<blockquote>
<p><span style="color: rgba(255, 0, 255, 1)">&gt; <strong>az webapp deploy --resource-group &lt;your resource group name&gt; --name &lt;your app service name&gt; --src-path myjava.jar --type jar</strong></span></p>
<p>Initiating deployment<br>Deploying from local path: myjava.jar<br>An error occurred during deployment. Status Code: 400, </p>
<p><strong><span style="color: rgba(255, 0, 0, 1)">Details: "Artifact type = 'Jar' cannot be deployed to stack = 'TOMCAT'. Site should be configured to run with stack = JAVA", </span></strong></p>
<p>Please visit https://XXXXXXXXX.scm.chinacloudsites.cn/api/deployments/latest to get more information about your deployment</p>
</blockquote>
<p>è¿å¥éè¯¯æ¶æ¯éå¸¸å³é®(Artifact type = 'Jar' cannot be deployed to stack = 'TOMCAT'. Site should be configured to run with stack = JAVA")ã</p>
<p>å¨æ¥çApp Serviceçéç½®ä¿¡æ¯åï¼Stackæç¶è®¾ç½®ä¸ºTomcatã</p>
<p><img alt="image" width="666" height="465" loading="lazy" style="border: 2px solid rgba(0, 0, 139, 1)" data-src="https://img2024.cnblogs.com/blog/2127802/202601/2127802-20260104200345561-1920215021.png" class="lazyload"></p>
<p>å ä¸ºè¿éåªæä¸¤ç§éé¡¹( Tomcat åJava SE )ãäºæ¯ï¼ä¿®æ¹ä¸ºJava SEåï¼åæ¬¡é¨ç½²jaråã</p>
<p><img alt="image" width="666" height="194" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2127802/202601/2127802-20260104200429417-812362535.png" class="lazyload"></p>
<p>æåã</p>
<p>&nbsp;</p>
<p>å½é®é¢è§£å³åï¼æ³è¿ä¸æ­¥éªè¯æ¯å¦æ¯one deployæ¥å£å¯¹jaråçå¼ºå¶éå¶ã</p>
<p>æ°å¥½kuduä¹æ¯å¼æºé¡¹ç®ï¼æä»¥ï¼è¿å¥github kudu ä»åº (æºç ï¼<a href="https://github.com/projectkudu/kudu/tree/master" target="_blank" rel="noopener nofollow">https://github.com/projectkudu/kudu/tree/master</a> )ï¼ä½¿ç¨éè¯¯æ¶æ¯å³é®å­æ´åºæç´¢âcannot be deployed to stackâï¼æç»ï¼å®ä½å° PushDeploymentController.cs ä¸­ï¼æå¦ä¸çéªè¯æ¡ä»¶ï¼</p>
<ul>
<li>å½é¨ç½²çæä»¶ä¸ºJaræ¶ï¼éè¦å¤æ­ç®æ App ServiceçStackåªè½æ¯JavaSEãå¦æä¸æ¯ï¼è¿å400çç¶æç </li>
</ul>
<p><img alt="image" width="666" height="110" loading="lazy" data-src="https://img2024.cnblogs.com/blog/2127802/202601/2127802-20260104200518388-1579422340.png" class="lazyload"></p>
<p>&nbsp;</p>
<h2>éå½ä¸ï¼ä½¿ç¨ curl å½ä»¤ç´æ¥è°ç¨æ¥å£ä¹å¯ä»¥å¤ç°é®é¢ï¼ææåaz webapp deployå½ä»¤ç¸å</h2>
<div class="cnblogs_code">
<pre><span style="background-color: rgba(255, 255, 0, 1)">curl -<span style="color: rgba(0, 0, 0, 1)">X POST \

     </span>-<span style="color: rgba(0, 0, 0, 1)">u user:password \

     </span>-T <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">/Users/Downloads/xxxxx-0.0.1-SNAPSHOT.jar</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)"> \

     </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">https://xxxxx.scm.chinacloudsites.cn/api/publish?type=jar</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)"> \

     </span>-<span style="color: rgba(0, 0, 0, 1)">v



</span></span>* Host xxxxx.scm.chinacloudsites.cn:<span style="color: rgba(128, 0, 128, 1)">443</span><span style="color: rgba(0, 0, 0, 1)"> was resolved.

</span>*<span style="color: rgba(0, 0, 0, 1)"> IPv6: (none)

</span>* IPv4: <span style="color: rgba(128, 0, 128, 1)">159.27</span>.<span style="color: rgba(128, 0, 128, 1)">20.0</span>

*   Trying <span style="color: rgba(128, 0, 128, 1)">159.27</span>.<span style="color: rgba(128, 0, 128, 1)">20.0</span>:<span style="color: rgba(128, 0, 128, 1)">443</span><span style="color: rgba(0, 0, 0, 1)">...

</span>* Connected to xxxxx.scm.chinacloudsites.cn (<span style="color: rgba(128, 0, 128, 1)">159.27</span>.<span style="color: rgba(128, 0, 128, 1)">20.0</span>) port <span style="color: rgba(128, 0, 128, 1)">443</span>

* ALPN: curl offers h2,http/<span style="color: rgba(128, 0, 128, 1)">1.1</span>

* (<span style="color: rgba(128, 0, 128, 1)">304</span>) (OUT), TLS handshake, Client hello (<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">):

</span>*  CAfile: /etc/ssl/<span style="color: rgba(0, 0, 0, 1)">cert.pem

</span>*<span style="color: rgba(0, 0, 0, 1)">  CApath: none

</span>* (<span style="color: rgba(128, 0, 128, 1)">304</span>) (IN), TLS handshake, Server hello (<span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">):

</span>* (<span style="color: rgba(128, 0, 128, 1)">304</span>) (OUT), TLS handshake, Client hello (<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">):

</span>* (<span style="color: rgba(128, 0, 128, 1)">304</span>) (IN), TLS handshake, Server hello (<span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">):

</span>* (<span style="color: rgba(128, 0, 128, 1)">304</span>) (IN), TLS handshake, Unknown (<span style="color: rgba(128, 0, 128, 1)">8</span><span style="color: rgba(0, 0, 0, 1)">):

</span>* (<span style="color: rgba(128, 0, 128, 1)">304</span>) (IN), TLS handshake, Certificate (<span style="color: rgba(128, 0, 128, 1)">11</span><span style="color: rgba(0, 0, 0, 1)">):

</span>* (<span style="color: rgba(128, 0, 128, 1)">304</span>) (IN), TLS handshake, CERT verify (<span style="color: rgba(128, 0, 128, 1)">15</span><span style="color: rgba(0, 0, 0, 1)">):

</span>* (<span style="color: rgba(128, 0, 128, 1)">304</span>) (IN), TLS handshake, Finished (<span style="color: rgba(128, 0, 128, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">):

</span>* (<span style="color: rgba(128, 0, 128, 1)">304</span>) (OUT), TLS handshake, Finished (<span style="color: rgba(128, 0, 128, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">):

</span>* SSL connection <span style="color: rgba(0, 0, 255, 1)">using</span> TLSv1.<span style="color: rgba(128, 0, 128, 1)">3</span> / AEAD-AES256-GCM-SHA384 / [blank] /<span style="color: rgba(0, 0, 0, 1)"> UNDEF

</span>* ALPN: server accepted http/<span style="color: rgba(128, 0, 128, 1)">1.1</span>

*<span style="color: rgba(0, 0, 0, 1)"> Server certificate:

</span>*  subject: C=CN; ST=Shanghai; O=Shanghai Blue Cloud Technology Co., Ltd.; CN=*<span style="color: rgba(0, 0, 0, 1)">.chinacloudsites.cn

</span>*  start date: Dec <span style="color: rgba(128, 0, 128, 1)">19</span> <span style="color: rgba(128, 0, 128, 1)">00</span>:<span style="color: rgba(128, 0, 128, 1)">00</span>:<span style="color: rgba(128, 0, 128, 1)">00</span> <span style="color: rgba(128, 0, 128, 1)">2025</span><span style="color: rgba(0, 0, 0, 1)"> GMT

</span>*  expire date: Jun <span style="color: rgba(128, 0, 128, 1)">17</span> <span style="color: rgba(128, 0, 128, 1)">23</span>:<span style="color: rgba(128, 0, 128, 1)">59</span>:<span style="color: rgba(128, 0, 128, 1)">59</span> <span style="color: rgba(128, 0, 128, 1)">2026</span><span style="color: rgba(0, 0, 0, 1)"> GMT

</span>*  subjectAltName: host <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">xxxxx.scm.chinacloudsites.cn</span><span style="color: rgba(128, 0, 0, 1)">"</span> matched cert<span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(128, 0, 0, 1)">s "*.scm.chinacloudsites.cn"</span>

*  issuer: C=US; O=DigiCert Inc; CN=<span style="color: rgba(0, 0, 0, 1)">DigiCert Basic RSA CN CA G2

</span>*<span style="color: rgba(0, 0, 0, 1)">  SSL certificate verify ok.

</span>* <span style="color: rgba(0, 0, 255, 1)">using</span> HTTP/<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">.x

</span>* Server auth <span style="color: rgba(0, 0, 255, 1)">using</span> Basic with user <span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(128, 0, 0, 1)">deploypoc</span><span style="color: rgba(128, 0, 0, 1)">'</span>

&gt; POST /api/publish?type=jar HTTP/<span style="color: rgba(128, 0, 128, 1)">1.1</span>

&gt;<span style="color: rgba(0, 0, 0, 1)"> Host: xxxxx.scm.chinacloudsites.cn

</span>&gt;<span style="color: rgba(0, 0, 0, 1)"> Authorization: Basic xxxxxxxxxxxxxxxx

</span>&gt; User-Agent: curl/<span style="color: rgba(128, 0, 128, 1)">8.7</span>.<span style="color: rgba(128, 0, 128, 1)">1</span>

&gt; Accept: *<span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">

&gt; Content-Length: 25578166

&gt; Expect: 100-continue

&gt; 

* Done waiting for 100-continue

&lt; HTTP/1.1 400 Bad Request

&lt; Content-Type: text/plain; charset=utf-8

&lt; Date: Wed, 31 Dec 2025 03:42:36 GMT

&lt; Server: Kestrel

&lt; Set-Cookie: ARRAffinity=xxxx;Path=/;HttpOnly;Secure;Domain=xxxxx.scm.chinacloudsites.cn

&lt; Set-Cookie: ARRAffinitySameSite=xxxxx;Path=/;HttpOnly;SameSite=None;Secure;Domain=xxxxx.scm.chinacloudsites.cn

&lt; Transfer-Encoding: chunked

&lt; 

* HTTP error before end of send, stop sending

* abort upload after having sent 589824 bytes

* Closing connection

<span style="background-color: rgba(255, 255, 0, 1)">Artifact type = 'Jar' cannot be deployed to stack = 'TOMCAT'. Site should be configured to run with stack = JAVA%   </span> </span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1>åèèµæ</h1>
<p>App Serviceé¨ç½²Javaåºç¨ï¼<a href="https://docs.azure.cn/zh-cn/app-service/configure-language-java-deploy-run?tabs=linux&amp;pivots=java-tomcat#deploying-your-app" target="_blank" rel="noopener nofollow">https://docs.azure.cn/zh-cn/app-service/configure-language-java-deploy-run?tabs=linux&amp;pivots=java-tomcat#deploying-your-app</a></p>
<p>Kudu One Deploy Source Code ï¼ <a href="https://github.com/projectkudu/kudu/blob/master/Kudu.Services/Deployment/PushDeploymentController.cs#L304" target="_blank" rel="noopener nofollow">https://github.com/projectkudu/kudu/blob/master/Kudu.Services/Deployment/PushDeploymentController.cs#L304</a></p>
<p>&nbsp;</p>
</div>
<div id="MySignature" role="contentinfo">
    <div style="background: #1c5f55;height: 36px;width: 618px;padding: 14px 5px 0px 3px;">
  <p style="
    font-weight: bold;
    color: white;
">å½å¨å¤æçç¯å¢ä¸­é¢ä¸´é®é¢ï¼æ ¼ç©ä¹ééï¼æµèéä¹å¾æ¸ï¼å®ä»¥å¨ä¹å¾çã äºä¸­ï¼æ°æ¯å¦æ­¤!</p>
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-04 20:07">2026-01-04 20:07</span>&nbsp;
<a href="https://www.cnblogs.com/lulight">è·¯è¾¹ä¸¤çç¯</a>&nbsp;
éè¯»(<span id="post_view_count">32</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19439653);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19439653', targetLink: 'https://www.cnblogs.com/lulight/p/19439653', title: 'ãAzure Web AppãGithub Actioné¨ç½²Jaråå°App Serviceæ¥400éè¯¯' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ è®©WinFormsåæ¬¡ä¼å¤§ ]]></title>
    <link>https://www.cnblogs.com/xdesigner/p/19438384/Make_WinForms_Great_Again</link>
    <guid>a0896da9d654c4cb0ac9e261aa377cc6</guid>
    <description>
    <![CDATA[ 
		<h2>
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/xdesigner/p/19438384/Make_WinForms_Great_Again" title="åå¸äº 2026-01-04 15:49">
    <span role="heading" aria-level="2">è®©WinFormsåæ¬¡ä¼å¤§</span>
    

</a>

		</h2>
		<div class="postText">    <div id="cnblogs_post_description" style="display: none">
        
        æ¬é¡¹ç®å°±æ¯ä¸é¨å¸®å©å°WinForms åºç¨ç¨åºè¿ç§»å° Blazor WASMå¹³å°ä¸ï¼å³ä½¿è¿äºç¨åºä½¿ç¨GDI+åè½ï¼æä»¬ä¹é¢æå°å¯¹è¿äºç¨åºæºç çä¿®æ¹éä¸è¶è¿10%ãè¿æå¤§çéä½WinFormsè½¯ä»¶ç°ä»£åçææ¬åé£é©ã
æä»¬çé¿æç®æ æ¯è½å°å¨ç1000äº¿è¡ç»è¿å¸åºéªè¯çC#ä»£ç è½éè·æ°çï¼å¨ç°ä»£Webåç«¯å¹³å°ä¸ç»§ç»­åæ¥ä»·å¼ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="è®©-winforms-åæ¬¡ä¼å¤§-httpsgithubcomdcsoft-yyfmwga">è®© WinForms åæ¬¡ä¼å¤§ <a href="https://github.com/dcsoft-yyf/MWGA" target="_blank" rel="noopener nofollow">https://github.com/dcsoft-yyf/MWGA</a></h1>
<h2 id="æ´æ°æ¥å¿">æ´æ°æ¥å¿</h2>
<ul>
<li>2026-1-4 :ç¬¬ä¸æ»´è¡ <a href="https://dcsoft-yyf.github.io/MWGA/WinFormCalculator.html" target="_blank" rel="noopener nofollow">https://dcsoft-yyf.github.io/MWGA/WinFormCalculator.html</a></li>
</ul>
<h2 id="å¨ç-winforms-ç°ä»£åç°ç¶">å¨ç WinForms ç°ä»£åç°ç¶</h2>
<p>å¨çèå´åï¼ä¼°è®¡WinFormså¼åèçº¦æ300ä¸è³500ä¸äººï¼å .NETå¼åèæ»æ°ç40%è³50%ãçäº§ç¯å¢ä¸­è¿è¡ç1000ä¸è³1500ä¸ä¸ªWinFormsåºç¨ç¨åºãå¨è¿äºåºç¨ä¸­ï¼60%è³80%æç°ä»£åæ¹é éæ±ï¼å¶ä¸­40%è³60%ä¼åéæ©Webåè¿ç§»ï¼æ¶åçC#ä»£ç å¯è½æ<code>æ°åäº¿è¡</code>ãæ ¸å¿é©±å¨å ç´ åæ¬ç½é¡µç«¯è®¿é®ãçé¢ç°ä»£åãè·¨å¹³å°æ¯æãäºéæåå®å¨åè§ãç±äºå¯å¤ç¨C#ä»£ç ä¸å·å¤åºäºæµè§å¨çè·¨å¹³å°è½åï¼Blazor WebAssemblyæä¸ºç­é¨éæ©ã</p>
<p>ä½æ¯æå¤§éçWinFormsä½¿ç¨äº<code>System.Drawing</code>æ¨¡åè°ç¨<code>GDI+</code>è¿è¡å¤æçèªå®ä¹ç»å¾åäº¤äºï¼è¿äºé¨åé¾ä»¥éè¿ç®åçæ§ä»¶æ å°è¿ç§»ï¼éå¸¸éè¦éåæå¤§å¹ä¿®æ¹ãä¸ºæ­¤ï¼å¸åºä¸å¯¹ä½æ¹å¨ãå¯å¤ç¨ä¸å¡é»è¾åç»å¾ä»£ç çç°ä»£åè¿ç§»è§£å³æ¹æ¡éæ±å¼ºçãä½é¿æä»¥æ¥ä¸ç´ç¼ºä¹ææå·¥å·åæ¹æ³ï¼å¯¼è´è®¸å¤ä¼ä¸é¢ä¸´é«æçéåææ¬åé£é©ã</p>
<h2 id="é¡¹ç®ç®ä»">é¡¹ç®ç®ä»</h2>
<p>æ¬é¡¹ç®å°±æ¯ä¸é¨å¸®å©å°WinForms åºç¨ç¨åºè¿ç§»å° Blazor WASMå¹³å°ä¸ï¼å³ä½¿è¿äºç¨åºä½¿ç¨GDI+åè½ï¼æä»¬ä¹é¢æå°å¯¹è¿äºç¨åºæºç çä¿®æ¹éä¸è¶è¿<code>10%</code>ãè¿æå¤§çéä½WinFormsè½¯ä»¶ç°ä»£åçææ¬åé£é©ã</p>
<p>æä»¬çé¿æç®æ æ¯è½å°å¨ç<code>1000äº¿</code>è¡ç»è¿å¸åºéªè¯çC#ä»£ç è½éè·æ°çï¼å¨ç°ä»£Webåç«¯å¹³å°ä¸ç»§ç»­åæ¥ä»·å¼ã</p>
<h2 id="å¨çå¾è¿ç§»-winforms-åºç¨å¸åºè§æ¨¡ä¼°ç®ç¾å">å¨çå¾è¿ç§» WinForms åºç¨å¸åºè§æ¨¡ä¼°ç®ï¼ç¾åï¼</h2>
<p>åè®¾éè¦è¿ç§»ç WinForms åºç¨çº¦ 50 ä¸ â 200 ä¸ ä¸ªï¼åºç¨å¤æåº¦åå¸ï¼ç®å 60%ãä¸­ç­ 30%ãå¤æ 10%ã</p>
<ul>
<li>æç¤ºä¾ååºç¨è¿ç§»ææ¬ä¸­ä½æ°ä¼°ç®ï¼ç¾åï¼ï¼å æåä»·çº¦ 5.5 ä¸ç¾å/åºç¨ã</li>
<li>TAMï¼æ»å¯å¯»åå¸åºï¼ä¼°ç®ï¼çº¦ 275 äº¿ â 1,100 äº¿ ç¾åï¼50 ä¸ â 200 ä¸ åºç¨ Ã 5.5 ä¸ç¾åï¼ã</li>
<li>å·¥å·/è®¸å¯æ¨¡å¼å¯å¯»åå¸åºï¼5 å â 2 ä¸ ç¾å/åºç¨ï¼ï¼çº¦ 25 äº¿ â 400 äº¿ ç¾åã</li>
<li>å¤æåºç¨ï¼10%ï¼å¸åºï¼çº¦ 5 ä¸ â 20 ä¸ ä¸ªï¼ææ¯ä¾ 15 ä¸ç¾åè®¡çº¦ 75 äº¿ â 300 äº¿ ç¾åã</li>
</ul>

</div>
<div class="clear"></div>
</div>
		<p class="postfoot">
			posted on 
<span id="post-date" data-last-update-days="0.004166666666666667" data-date-updated="2026-01-04 15:55">2026-01-04 15:49</span>&nbsp;
<a href="https://www.cnblogs.com/xdesigner">è¢æ°¸ç¦ çµå­çåï¼å»çä¿¡æ¯å</a>&nbsp;
éè¯»(<span id="post_view_count">1399</span>)&nbsp;
è¯è®º(<span id="post_comment_count">12</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19438384);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19438384', targetLink: 'https://www.cnblogs.com/xdesigner/p/19438384/Make_WinForms_Great_Again', title: 'è®©WinFormsåæ¬¡ä¼å¤§' })">ä¸¾æ¥</a>

		</p>
	 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ è¯»ååç¦»é¢ä¸´çé®é¢åå¶è§£å³æ¹æ¡ ]]></title>
    <link>https://www.cnblogs.com/huang-changfan/p/19185323</link>
    <guid>d3d0a296443c28956ef875681ebbc7c0</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/huang-changfan/p/19185323" title="åå¸äº 2026-01-04 15:48">
    <span role="heading" aria-level="2">è¯»ååç¦»é¢ä¸´çé®é¢åå¶è§£å³æ¹æ¡</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="1è¯»ååç¦»å¸¦æ¥çé®é¢åè§£å³æ¹æ³">1.è¯»ååç¦»å¸¦æ¥çé®é¢åè§£å³æ¹æ³</h1>
<h2 id="11-å»¶æ¶é®é¢">1.1 å»¶æ¶é®é¢</h2>
<p>ä¸»ä»å¤å¶ï¼ä¸»åºä¸ä»åºä¹é´ç±äºç½ç»ï¼è®¾å¤å·®å¼ï¼è´è½½æåµç­ï¼å¿ç¶å­å¨å»¶æ¶ï¼å»¶æ¶æå¤§æå°ï¼åªè¦å»¶æ¶ä¿æåä¸ä¸ªåççèå´åæ¯å¯ä»¥æ¥åçã</p>
<p>1.1.1é æä¸»ä»å»¶æ¶çåè§åå </p>
<ul>
<li>ä¸»ä»è®¾å¤å·®å¼ï¼ä¾å¦ä¸»åºæ§è½è¾å¥½ï¼ä»åºæ§è½è¾å·®ï¼å¯¹äºåæ ·çåå¥ææ´æ°æä½ï¼ä¸»åºè½è¾å¿«å®æï¼ä»åºè±è´¹æ¶é´è¾å¤ï¼å¦æç³»ç»æç»­ç»´æé«é¢çåå¥æ´æ°ï¼ä¸»åºä¸ä»åºä¹é´çå·®å¼ä¼è¢«éæ¸æå¤§ãå¯¼è´ä¸»ä»çå»¶è¿è¶æ¥è¶å¤§ãå¯¹äºè¿ç§æåµï¼éè¦å°½éä¿è¯ä¸»ä»æå¡å¨æ§è½ä¸è´ï¼ä½¿å¾ä¸¤ç§å¤çç¸åéçæ°æ®è±è´¹çæ¶é´å°½å¯è½æ¥è¿ãè¿æ ·ä¸è¬æåµèè¨ä¸»ä»å»¶æ¶å¯ä»¥ä¿è¯å¨ä¸ä¸ªåçèå´ï¼ä¸ä¼åºç°å¾å¤§çå·®å¼ã</li>
<li>ä»åºä¸æ§è¡äºè¿å¤ä»»å¡ï¼ç±äºä»åºæ¯åªè¯»çï¼å ä¸ç¸æ¯äºä¸»åºèè¨éè¦æ§æ²¡é£ä¹é«ï¼æä»¥å¶ä»ç³»ç»å¯è½ä¼ä»åºè¿è¡å¤§éçæ°æ®åæ­¥æåæä¸å¡ï¼å¯¼è´ä»åºè¢«å ç¨è¿å¤èµæºï¼å¤çä»ä¸»åºåæ­¥è¿æ¥çæ¥å¿è¾æ¢ï¼é æäºå»¶è¿ãæ­¤æ¶éè¦æ³¨æä»åºçååï¼èèè´è½½åè¡¡æéç¨å¶ä»æ¹å¼ä½¿å¾ä»åºè´è½½ä¸è¦å¤ªé«ï¼é æè¾é¿å»¶è¿ã</li>
<li>å¤§äºå¡ï¼å¦æä¸»åºæ§è¡ä¸ä¸ªè¦æ´æ°æå é¤å¤§éæ°æ®çSQLï¼ä¾å¦ä¸»åºé½éè¦æ§è¡20s.é£ä¹å¯¹äºè¯­å¥ææ°æ®ï¼åå³äºbinlogæ ¼å¼ï¼å¤å¶å°ä»åºï¼ä»åºä¹éè¦æ§è¡20s.è¿æ ·ä¸»ä»ä¹é´å°±å¤©ç¶çå­å¨ä¸ä¸ªå»¶è¿ï¼è¿ä¸ªå»¶æ¶ç±äºå¡çæ§è¡æ¶é´å³å®ãæä»¥éè¦é¿åå¤§äºå¡ï¼å¼åè¿ç¨ä¸­å°±éè¦æ³¨æï¼åæ¶éè¦æ·»å çæ§ï¼å¯¹äºæ§è¡æåµè¿è¡çæ§é¢è­¦ã</li>
</ul>
<p>æé«ä»åºå¤å¶æ§è½çæ¹æ³ï¼ä»åºçioçº¿ç¨éè¿è¯»åä¸»åºçæ¥å¿ï¼ç¶åsqlçº¿ç¨å°è¯»åæ¥å¿åå®¹æ§è¡ï¼å¦ææ§è¡sqlççº¿ç¨æ¯åçº¿ç¨æ§è¡æçä¼åä½ãä¸»åºåå¥æ¶æ¯å¯ä»¥å¹¶ååå¥çï¼å¦æä»åºæ§è¡éç¨å¤çº¿ç¨æ§è¡ï¼å¯ä»¥æé«ä»åºçå¤å¶æçéä½å»¶è¿ãMySQLä¼å¤æ­å¯ä»¥å¹¶åæ§è¡çé¨åè¯­å¥ä½¿ç¨å¤ä¸ªçº¿ç¨å¹¶åæ§è¡ã</p>
<h2 id="12--è¯»ååç¦»çææè¯»ä¸è´æ§">1.2  è¯»ååç¦»çææï¼è¯»ä¸è´æ§</h2>
<p>ä¸»ä»çå»¶è¿æ»ä¼å­å¨ï¼é£ä¹ä¸ä¸ªæä½åå¥ä¸»åºï¼æ­¤æ¶ä»ä»åºè¯»åæ°æ®ï¼å¯è½è¯»å°å¯è½è¯»ä¸å°ï¼è¿åå³äºä»åºçå»¶è¿ä»¥åè¯»åçæ¶æºãå¦æä¸»ä»å»¶è¿å¤§äºï¼åå¥ä¸»åºä¸è¯»åä»åºçé´éï¼é£ä¹è¯»åçä»åºå°±ä¸ä¼å­å¨è¿æ¬¡åå¥æä½ãåä¹å°±å¯ä»¥è¯»åå°è¿æ¬¡åå¥æä½ãè¿ä¸¤ç§æåµå­å¨ä¸å®çéæºæåï¼ä¾å¦ç¨æ·åå¥ä¸»åºåï¼å¾å¿«è¿è¡äºè¯»åï¼å¯è½è¿æ¬¡è¯»åçä»åºæ²¡æå½åçåå¥æ°æ®ãå¦æç¨æ·éäºä¸æ®µæ¶é´æè¯»åï¼è¿æ¬¡å¯è½å¯ä»¥å¨ä»åºä¸­è¯»åå¯¹äºçæä½ã<br>
ç±æ­¤å¼åäºè¯»ä¸è´çé®é¢ï¼æäºæä½å¯ä»¥æ¥åä¸å®ç¨åº¦çå»¶è¿ï¼æäºæä½ä¸è½æ¥æ¶å»¶è¿ï¼éè¦ä¿è¯ååç«å³å¯è§ã</p>
<h3 id="121-è¯»ä¹æå">1.2.1 è¯»ä¹æå</h3>
<p><img src="https://img2024.cnblogs.com/blog/1435315/202511/1435315-20251129211311701-1878061974.png" alt="image" loading="lazy"><br>
ä¾å¦ç¨æ·ç¼è¾èªå·±çä¸»é¡µä¿¡æ¯ï¼ä¿å­åå·æ°é¡µé¢è·åèªå·±çä¸»é¡µä¿¡æ¯ãç¬¬ä¸ä¸ªæä½æ¯åæä½ï¼è¯·æ±ä¼è¢«è·¯ç±å°ä¸»åºï¼ç¬¬äºä¸ªæä½æ¯è¯»æä½ä¼è¢«è·¯ç±å°ä»åºã<br>
å¦æä¸»åºä¸ä»åºä¹é´å­å¨å»¶æ¶ï¼ä¸ç¬¬äºæ¬¡è¯»åæä½çä»åºè¿æ²¡æåæ¶åæ­¥ä¸»åºçæ°æ®ï¼æ­¤æ¶å°±ä¼åºç°æªå¼çç°è±¡ï¼ç¨æ·ç¼è¾åæ§è¡ä¿å­ï¼æç¤ºä¿å­æåãä½ä»å·æ°é¡µé¢ï¼åç°é¡µé¢è¿æ¯ä¿®æ¹åçä¿¡æ¯ã<br>
è¿æ¾ç¶ä¼å¯¹ç¨æ·é æå°æ°ï¼æèæä¸è´æ§è¢«ç ´åï¼è®°å½æç¤ºäºç¨æ·ä¿å­æåï¼é£ä¹å·æ°é¡µé¢è¯»åæ¶åºè¯¥è¯»åå°ä¿å­çæ°æ®ï¼ä½å®éæåµç¡®æ²¡æè¯»åå°ãè¿ç§ä¸ä¸è´æ§å¯è½è¿ä¼å¯¼è´ç¨æ·éå¤æä½ï¼é ææå¤±ï¼ä¾å¦ç¨æ·æ§è¡ä¸ä¸ªæä½æç¤ºæåï¼ç¶åç¨æ·æ¥è¯¢ï¼åç°æ²¡æè®°å½åæçæä½ï¼ä»å¯è½ä¼åæ¬¡æ§è¡è¿ä¸ªæä½ï¼åç»­ä¸»ä»åæ­¥å®æ¯åï¼ä»ä¼æ¥è¯¢å°ä¸¤æ¬¡æä½ï¼å¯ä»çé¢ææ¯åªè¿è¡ä¸æ¬¡æä½ã<br>
éå¯¹ç¨æ·åå¥åï¼éè¦è¯»åå°èªå·±åå¥çææ°æ°æ®ï¼è¿ç§è¯»ä¸è´æ§ç§°ä¸ºè¯»å·±æåã</p>
<p>å¦ä½ä¿è¯è¯»å·±æåçéç¦»çº§å«ï¼</p>
<ul>
<li>è¯»ä¸»åºï¼ç®åç²æ´ç´æ¥è¯»ä¸»åºï¼å¦æå½åçè¯»æä½å¯¹ä¸è´æ§è¦å»è¾é«ï¼ç´æ¥è¯»ä¸»åºï¼è¿æ¬¡è¯·æ±è¯å®ä¿è¯è¯»çä¸è´æ§ï¼å¯¹äºåä¸ä¸ªå®ä¾å°±ä¸å­å¨ä¸è´æ§é®é¢äºãä½å¶ç¼ºç¹ä¹å¾ææ¾ï¼è¯»ååç¦»æ¯ä¸ºäºå°è¯»æä½è·¯ç±å°ä»åºï¼éä½ä¸»åºè´è½½ï¼ä½¿å¾ç³»ç»æä¾æ´å¤çååéãå¦æå¤æ°è¯»è¯·æ±æåè¿æ¯è¢«è·¯ç±å°äºä¸»åºï¼æ©å±æ§éä½äºï¼å¤§éæä½é½ä¾èµä¸»åºï¼æ²¡æè¢«å¥ç¦»åºæ¥ã</li>
<li>å¤æ­ä¸»ä»ç¹ä½ï¼éæ©åéçä»åº<br>
ä¾å¦ç¨æ·åå¥ä¸»åºåï¼å½åbindlogçç¹ä½æ¯100.æ§è¡<code>show slave status;</code>è·åä»åºåæ­¥ä¸»åºçç¹ä½ä¿¡æ¯ï¼å¦æå½åä»åºçç¹ä½ä¿¡æ¯å¤§äºç­äºä¸»åºï¼é£ä¹ä¸»åºä¹åçåæä½å¨è¯¥ä»åºæ¯å¯è§çã<br>
<img src="https://img2024.cnblogs.com/blog/1435315/202511/1435315-20251129213640521-349884627.png" alt="image" loading="lazy"><br>
ä¾å¦ä¸å¾ï¼å¦æä¸»åºåå¥çæ¶çç¹ä½å°äºç­äºå½åä»åºçç¹ä½ï¼é£ä¹æ­¤æ¬¡è¯»åæä½å¯¹ä¹åçåå¥æä½å¯è§ã<br>
å½ç¶ï¼å¦æä¸»ä»å»¶æ¶æ¯è¾å¤§ï¼ä¾å¦30s.ä¸å¯è½ç­å°ä»åºåæ­¥å¥½ä¹ååæ¥è¯¢ä»åºï¼å»¶æ¶è¾å¤§æåµï¼æå®æ¶é´åæ²¡ææ»¡è¶³æ¡ä»¶çä»åºéè¦è§¦åéçº§é»è¾ï¼å¯ç´æ¥æ¥è¯¢ä¸»åºãåæ¶æ·»å å¥½çæ§ï¼å»¶æ¶è¾¾å°ä¸ééè¦åè­¦ï¼åæ¶ç»è®¡å¥½è·¯ç±ä»åºå¤±è´¥è¢«è½¬åå°ä¸»åºçæä½ï¼æ³åæ³ä¼åå¯¹åºé®é¢ã</li>
</ul>
<p>å½ç¶ä¹ä¸æ¯ææçæä½éè¦è¯»å·±æåï¼è¿éè¦æ ¹æ®å·ä½ä¸å¡æåµåæãä»¥ä¸ä¾ä¸ºä¾ï¼å¯¹äºç¨æ·ç¼è¾èªå·±ä¸»é¡µä¿¡æ¯ï¼å¯¹äºç¨æ·æ¬äººæ¥è¯´è¯å®æ¯éè¦è¯»å·±æåçãå½å¯¹äºå¶ä»äººæ¥è¯´åä¸éè¦è¯»å·±æåï¼è®¿é®å¶ä»äººçä¸»é¡µï¼ç±äºèªå·±ä¸å¯è½ç¼è¾ä»äººçä¸»é¡µï¼æä»¥ä¸»é¡µçåæä½å¯¹ä»äººæ¥è¯´æ¯ä¸å¯è§çï¼æ­¤æ¶ç´æ¥è¯»åä»åºå³å¯ï¼ç­å¾ä»åºåæ­¥å¥½å¯¹åºæ°æ®åï¼æè¯»åææ°æ°æ®ä¹æ¯å¯ä»¥æ¥åçãè¿æ ·çè¯»åå¶ä»ç¨æ·çä¸»é¡µä¼¼ä¹æ²¡æé®é¢ï¼ä½æ¶åæ­¥å¥½å°±ä½æ¶è¯»åææ°æ°æ®ï¼ä½æ¯å­å¨å¤ä¸ªä»åºåä¼å¸¦æ¥æ°çé®é¢ï¼è¿å°±æ¯ä¸ä¸èçåè°è¯»é®é¢ã</p>
<h3 id="122åºäºsharding-jdbcå®ç°è¯»ä¹æå">1.2.2åºäºsharding jdbcå®ç°è¯»ä¹æåã</h3>
<ul>
<li>åºæ¬ç¯å¢ï¼ä¸ä¸»ä¸¤ä»åºäºjdbcãä¸»åº3310ç«¯å£ï¼ä»åº3311ï¼3312ç«¯å£.</li>
<li>å®ç°æè·¯ï¼èªå®ä¹ä»åºéæ©ç®æ³ï¼å¦æéè¦è¯»å·±æåï¼å°è¯·æ±è·¯ç±å°åéçä»åºï¼å¦ææ²¡æä»åºç¬¦åæ¡ä»¶ï¼è·¯ç±å°ä¸»åºã</li>
<li>æ´ä½æµç¨ï¼
<ol>
<li>å®æ¶Jobè¯»åä¸»åºä»åºç¹ä½ä¿¡æ¯è®°å½å¨Redisä¸­ã</li>
<li>å¯¹äºéè¦è®°å½ç¹ä½ä¿¡æ¯çåæä½æ·»å æ³¨è§£ï¼åå¥åè®°å½äºå¡æäº¤æ¶çç¹ä½ä¿¡æ¯</li>
<li>è¯»è¯·æ±æ·»å æ³¨è§£ï¼æ è¯å½åè¯·æ±æ¯å¦éè¦è¯»ä¹æåï¼è®°å½å¨ä¸ä¸æä¸­ã</li>
<li>æ ¹æ®å½åç¨æ·åå¥æä½æ¶è®°å½çç¹ä½ï¼éæ©åéçä»åºï¼å¦ææ²¡æç¬¦åæ¡ä»¶çï¼éçº§å°ä¸»åºã</li>
</ol>
</li>
</ul>
<pre><code>    /**  
     * 1.å®æ¶Jobè¯»åä¸»åºä»åºç¹ä½ä¿¡æ¯è®°å½å¨Redisä¸­ã
     * æ¯500mså·æ°ä¸»åºä¸åºç¹ä½ä¿¡æ¯
     *
     * @throws SQLException
     */
    @Scheduled(fixedRate = 5000) // æ¯500msæ´æ°ä¸æ¬¡
    public void refreshSlavePositon() throws SQLException {
        log.info("zookeeper info ={}", JSON.toJSONString(this.zookeeperCurrentVersionInfoHolder));
        //åå¥ä»åºç¹ä½
        Map&lt;String, Connection&gt; slaveConnection = getSlaveConnection();
        slaveConnection.forEach((slaveName, connection) -&gt; {
            try {
                log.info("slave={} url={}", slaveName, connection.getMetaData().getURL());
            } catch (SQLException e) {
                throw new RuntimeException(e);
            }
            BinlogPosition binlogPosition = this.getSlaveBinLogPoint(connection);
            redisTemplate.&lt;String, String&gt;opsForHash().put(slavesPositionInfoCachePreKey, slaveName, JSON.toJSONString(binlogPosition));
        });

        //åå¥ä¸»åºç¹ä½
        Connection masterConnection = getMasterConnection();
        log.info("masterConnection url={}", masterConnection.getMetaData().getURL());
        BinlogPosition binlogPosition = this.getMasterBinLogPoint(masterConnection);
        redisTemplate.&lt;String, String&gt;opsForHash().put(slavesPositionInfoCachePreKey, MASTER_DB_NAME, JSON.toJSONString(binlogPosition));
    }
</code></pre>
<pre><code>/**
 * 2.å¯¹äºéè¦è®°å½ç¹ä½ä¿¡æ¯çåæä½æ·»å æ³¨è§£ï¼åå¥åè®°å½äºå¡æäº¤æ¶çç¹ä½ä¿¡æ¯
 */
@Slf4j
@Aspect
@Component
public class CacheUserBinlogPositionAspect {

    @Autowired
    private BinlogPositionService binLogService;

    @Pointcut("@annotation(com.example.annotation.CacheUserBinlogPosition)")
    public void cacheUserMasterPositionCut() {
    }

    @AfterReturning(pointcut = "cacheUserMasterPositionCut()", returning = "result")
    public Object cacheMasterPosition(JoinPoint joinPoint, Object result) throws Throwable {
        String uid = UserManager.getUid();

        // æ³¨åäºå¡åè°ï¼ç±äºæ§è¡å°æ¹åé¢æ¶ï¼äºå¡çåé¢è¿æ²¡ææäº¤ï¼æä»¥éè¦æ³¨åäºå¡æäº¤åæ§è¡è·åç¹ä½æ¹æ³ï¼ä»¥ç¡®ä¿è·åæäº¤åçç¹ä½ä¿¡æ¯
        TransactionSynchronizationManager.registerSynchronization(
                new TransactionSynchronization() {
                    @Override
                    public void afterCommit() {
                        // å¨äºå¡æäº¤åæ§è¡
                        try {
                            //è·åä¸»åºç¹ä½
                            BinlogPosition masterDBPosition = binLogService.getMasterBinLogPoint();
                            //ç¼å­å½åç¨æ·ä¸»åºç¹ä½
                            binLogService.cacheUserBinlogPosition(uid, masterDBPosition);
                        } catch (Exception e) {
                            log.error("è®°å½binlogç¹ä½å¤±è´¥", e);
                        }
                    }
                }
        );

        return result;
    }
}
</code></pre>
<pre><code>/**
 * 3. è¯»è¯·æ±æ·»å æ³¨è§£ï¼æ è¯å½åè¯·æ±æ¯å¦éè¦è¯»ä¹æåï¼è®°å½å¨ä¸ä¸æä¸­ã
 */
@Slf4j
@Aspect
@Component
public class ReadConsistencyAspect {

    @Pointcut("@annotation(com.example.annotation.ReadSelfWrite)")
    public void readSelfWritePointCut() {
    }

    @Before(value = "readSelfWritePointCut()")
    public void readSelfWritePoint(JoinPoint joinPoint) throws Throwable {
        //å¯¹äºæ æ³¨äºè¯»å·±æåçæ¥å£ï¼ä¸ä¸æä¸­è®¾ç½®å¯¹åºå±æ§
        ReadConsistencyManager.setReadSelfWrite();
    }
}
</code></pre>
<pre><code>  /**
   *4. æ ¹æ®å½åç¨æ·åå¥æä½æ¶è®°å½çç¹ä½ï¼éæ©åéçä»åºï¼å¦ææ²¡æç¬¦åæ¡ä»¶çï¼éçº§å°ä¸»åºã
  */
  @Slf4j
public class BinlogAwareLoadBalanceAlgorithm implements ReadQueryLoadBalanceAlgorithm {

    private Properties properties;

    @Override
    public Properties getProps() {
        return this.properties;

    }

    @Override
    public void init(Properties properties) {
        this.properties = properties;
    }

    @Override
    public String getType() {
        return "BINLOG_AWARE";
    }

    /**
     * read query load-balance algorithm.
     * @param name read query logic data source name
     * @param writeDataSourceName name of write data source
     * @param readDataSourceNames names of read data sources
     * @param context context
     * @return
     */
    @Override
    public String getDataSource(String name, String writeDataSourceName, List&lt;String&gt; readDataSourceNames, TransactionConnectionContext context) {
        return this.getDataSource(name, writeDataSourceName, readDataSourceNames);
    }

    /**
     * éæ©æ°æ®æºçæ ¸å¿æ¹æ³
     *
     * @param name                read query logic data source name
     * @param writeDataSourceName ä¸»åºåç§°
     * @param readDataSourceNames ä»åºåç§°åè¡¨
     * @return éæ©çæ°æ®æºåç§°
     */
    public String getDataSource(String name, String writeDataSourceName, List&lt;String&gt; readDataSourceNames) {
        try {
            if (ReadConsistencyManager.readSelfWrite()) {
                //è¦æ±è¯»ä¹æå
                return getDb(writeDataSourceName, readDataSourceNames);
            } else {
                //ä¸è¦æ±è¯»ä¹æå
                return loadBalance(readDataSourceNames);
            }
        } finally {
            //æ¸çThread Local
            ReadConsistencyManager.clear();
        }
    }

    /**
     * è·åå¤§äºç­äºç¨æ·å½åå­å¨ç¹ä½ä¿¡æ¯çä»åºï¼å¦ææ²¡æä»åºæ»¡è¶³æ¡ä»¶ï¼è¿åä¸»åºãå­å¨çç¹ä½ä¸ä¸ä¼è¿ææåµä¸ã
     * @param writeDataSourceName
     * @param readDataSourceNames
     * @return
     */
    private String getDb(String writeDataSourceName, List&lt;String&gt; readDataSourceNames) {
        //è¯¥ç±»è¢«SPIåå»ºï¼æ æ³éè¿springå®¹å¨æ³¨å¥ï¼æä»¥éè¿åä¾æ¨¡å¼ä»å®¹å¨ä¸­è·åservice
        BinlogPositionService binlogPositionService = Singleton.getBinlogPositionServiceInstance();
        //è·åç¨æ·ç¹ä½
        BinlogPosition positionInfo = binlogPositionService.getUserPosition(UserManager.getUid());
        //å­å¨ç¹ä½ä¿¡æ¯
        if (positionInfo.isEffective()) {
            //å¯ä»¥æ¾å°åå«æå®ç¹ä½çä»åºï¼è¿åå¯¹äºä»åº
            List&lt;String&gt; containsSpecPositionSourceName = binlogPositionService.getContainSpecPositionSlave(positionInfo);
            if (CollectionUtils.isNotEmpty(containsSpecPositionSourceName)) {
                return loadBalance(containsSpecPositionSourceName);
            }

            //æ²¡ææ¥è¯¢å°æ»¡è¶³æ¡ä»¶çä»åºï¼æ¥è¯¢ä¸»åº
            return writeDataSourceName;
        } else {
            //æ²¡æç¹ä½ä¿¡æ¯,ç¨æ·æ²¡ææ§è¡è¿åæä½
            //æ­¤æ¶ï¼ä»»éä¸ä¸ªä»åºå³å¯
            return loadBalance(slaveNames);
        }
    }

    /**
     * è´è½½åè¡¡ç­ç¥éæºéæ©
     *
     * @param readDataSourceNames
     * @return
     */
    private String loadBalance(List&lt;String&gt; readDataSourceNames) {
        return readDataSourceNames.get(ThreadLocalRandom.current().nextInt(readDataSourceNames.size()));
    }
</code></pre>
<p>ä»¥ä¸ç­ç¥å®å¨ç¨æ·ç¹ä½ä¿¡æ¯æ²¡æè¿ææ¶é´çåºç¡ä¸å¯ä¿è¯è¯»å·±æåãå¦æç¹ä½è®¾ç½®äºè¿ææ¶é´ï¼åéè¦è°æ´é»è¾ãï¼å¦æä¿è¯ç¹ä½ä¿¡æ¯ä¸ä¼è¿æï¼æèå­å¨å°ç¨æ·ä¾§å§ç»ä¼æç¹ä½ä¿¡æ¯ï¼å°±ä¸éè¦èå¥ä¸åé»è¾äºï¼<br>
å¦æç¹ä½è®¾ç½®äºè¿ææ¶é´ï¼æ²¡æè·åå°ç¹ä½ä¿¡æ¯å¯è½å­å¨ä¸¤ç§æåµã<br>
1.ç¨æ·æ²¡ææ§è¡åæä½ã<br>
2.ç¨æ·æ§è¡äºåæä½ï¼ä½å½åæ¶é´å·²ç»è¶è¿ç¹ä½çè¿ææ¶é´ã<br>
ç±äº1.2å¨ç¹ä½ä¸å­å¨çæåµä¸ï¼æ æ³åºåå·ä½æ¯åªä¸ç§æåµãæä»¥æ­¤æ¶å°±éè¦å¤æ­ä¸»ä»åæ­¥å»¶æ¶ï¼éåå»¶è¿æ¶é´å°äºç­äºè¿ææ¶é´çä»åºï¼æ»¡è¶³æ¡ä»¶çä»åºå³å¯ä»¥è¯»åå°ä¹ååå¥çæ°æ®ã<br>
è¯æè¿ç¨å¦ä¸ï¼<br>
<img src="https://img2024.cnblogs.com/blog/1435315/202511/1435315-20251130170958176-301806385.png" alt="image" loading="lazy"><br>
<img src="https://img2024.cnblogs.com/blog/1435315/202511/1435315-20251130171047342-618582452.png" alt="image" loading="lazy"><br>
<img src="https://img2024.cnblogs.com/blog/1435315/202511/1435315-20251130171106033-569878748.png" alt="image" loading="lazy"><br>
å»¶è¿æ¶é´å°äºç­äºè¿ææ¶é´çä»åºï¼å¯ä»¥è¯»åå°ä¹åçåå¥æ°æ®ï¼ä½å¦æå»¶æ¶æ¶é´å¤§äºè¿ææ¶é´ï¼å®éå­å¨ä¸¤ç§æåµï¼ä¸ç§æ¯å¯ä»¥è¯»åå°ï¼ä¸ç§æ¯æ æ³è¯»åå°ã<br>
æ­¤æ¶ç±äºç¹ä½å·²ç»è¿æï¼æ æ³åºååºæ¥ãæä»¥ç»ä¸èµ°éçº§é»è¾æ¥ä¸»åºã<br>
ä»åºåå«åå¥çæ¡ä»¶ï¼Ît â¥ Lã<br>
å»¶æ¶æ¶é´(L)å¤§äºè¿ææ¶é´ï¼6sï¼<br>
Ît = 10ç§, L = 8ç§<br>
æ¡ä»¶ï¼10 â¥ 8 â<br>
ç»æï¼ä»åºå·²åå«åå¥ï¼å¯ä»¥å®å¨è¯»å</p>
<p>Ît = 7ç§, L = 9ç§<br>
æ¡ä»¶ï¼7 â¥ 9 â<br>
ç»æï¼ä»åºè¿æªåæ­¥åå¥ï¼è¯»åä¼å¾å°æ§æ°æ®<br>
ä¾å¦ç¨æ·åå¥åï¼æ°æ®è¢«åæ­¥å°äºææä»åºï¼ç¨æ·ç¬¬äºå¤©åèµ·æ¥è¯¢è¯·æ±ï¼æ­¤æ¶ç¹ä½ä¿¡æ¯ä»¥åè¿æï¼ä¸ç¨æ·åå¥ä¸»åºæ°æ®å·²ç»åæ­¥å°ææä»åºã<br>
ç¨æ·æ­¤æ¶éè¦å¤æ­ä¸»ä»å»¶æ¶ï¼åè®¾æ­¤æ¶ä¸»ä»å»¶æ¶è¾¾å°30s.ä½æ¯ç¨æ·æ¨å¤©çæ°æ®æ©å·²åå¥ï¼æ­¤æ¶è¿æ¯ä¼è¢«è·¯ç±å°ä¸»åºã</p>
<pre><code>/**
     * è·åå¤§äºç­äºç¨æ·å½åå­å¨ç¹ä½ä¿¡æ¯çä»åºï¼å¦ææ²¡æä»åºæ»¡è¶³æ¡ä»¶ï¼è¿åä¸»åºã
     * @param writeDataSourceName
     * @param readDataSourceNames
     * @return
     */
    private String getDb(String writeDataSourceName, List&lt;String&gt; readDataSourceNames) {
        //è¯¥ç±»è¢«SPIåå»ºï¼æ æ³éè¿springå®¹å¨æ³¨å¥ï¼æä»¥ç´æ¥ä»å®¹å¨ä¸­è·åservice
        BinlogPositionService binlogPositionService = Singleton.getBinlogPositionServiceInstance();
        //è·åç¨æ·ç¹ä½
        BinlogPosition positionInfo = binlogPositionService.getUserPosition(UserManager.getUid());
        //å­å¨ææçç¹ä½ä¿¡æ¯
        if (positionInfo.isEffective()) {
            //å¯ä»¥æ¾å°åå«æå®ç¹ä½çä»åºï¼è¿åå¯¹äºä»åº
            List&lt;String&gt; containsSpecPositionSourceName = binlogPositionService.getContainSpecPositionSlave(positionInfo);
            if (CollectionUtils.isNotEmpty(containsSpecPositionSourceName)) {
                return loadBalance(containsSpecPositionSourceName);
            }

            //æ²¡ææ¥è¯¢å°æ»¡è¶³æ¡ä»¶çä»åºï¼æ¥è¯¢ä¸»åº
            return writeDataSourceName;
        } else {
            //æ²¡æç¹ä½ä¿¡æ¯å­å¨ä¸¤ç§æåµ
            //case1 ç¨æ·æ²¡ææ§è¡è¿åæä½
            //æ­¤æ¶ï¼ä»»éä¸ä¸ªä»åºå³å¯
            //case2 ç¨æ·æ§è¡åæä½ï¼ä½å­å¨çç¨æ·ç¹ä½ä¿¡æ¯å·²è¿æã
            //å¯å°ç¨æ·ç¹ä½ä¿¡æ¯è¿ææ¶é´ï¼è®¾ç½®ä¸ºä¸»ä»å»¶è¿çä¸åãç¨æ·ç¹ä½è¿ææ¯ä¸»ä»å»¶è¿çä¸åï¼è¿æåä¸è¬æåµä¸ï¼ä»åºé½åæ­¥äºå¯¹åºç¹ä½æ°æ®ã
            //ä½ä¹å¯è½å­å¨æ²¡æåæ­¥çæåµï¼æ­¤æ¶å°±éè¦å¤æ­ä¸»ä»åæ­¥å»¶æ¶ï¼éåå»¶è¿æ¶é´å°äºç­äºè¿ææ¶é´çä»åºã
            //æèï¼å°ç¹ä½ä¿¡æ¯ä¸è®¾ç½®è¿ææ¶é´ï¼è¿æ ·å§ç»å¯ä»¥éè¿ç¹ä½æ¯è¾ï¼ç¶åéè¿å®æ¶ä»»å¡ï¼å¤æ­å­å¨çç¹ä½ä¿¡æ¯å°äºææä»åºå½åç¹ä½å°±å°å¶æ¸ç©ºã
            Set&lt;String&gt; slaveNames = binlogPositionService.getReasonablyDelayedSlave();
            if (CollectionUtils.isNotEmpty(slaveNames)) {
                return loadBalance(slaveNames);
            }

            //æ²¡æç¬¦åæ¡ä»¶çï¼éçº§ä¸»åºã
            return writeDataSourceName;
        }
    }
</code></pre>
<p>ç±äºShrding Jdbcçèªå®ä¹æ¥è¯¢è´è½½åè¡¡ç®æ³ä½¿ç¨SPIå è½½çï¼æä»¥è¿éè¦æå®èªå®ä¹ç®æ³SPIæä»¶ã<br>
å¨<code>resource</code>ç®å½ä¸åå»ºä¸ä¸ªMETA-INF/servicesæä»¶å¤¹ï¼æ·»å ä¸ä¸ªåä¸ºorg.apache.shardingsphere.readwritesplitting.spi.ReadQueryLoadBalanceAlgorithmçæä»¶ã<br>
æä»¶ä¸­æ·»å èªå®ä¹å®ç°äºReadQueryLoadBalanceAlgorithmçå·ä½ç±»çè·¯åºã</p>
<pre><code>#SPI load
com.example.config.BinlogAwareLoadBalanceAlgorithm
</code></pre>
<h3 id="123-åè°è¯»">1.2.3 åè°è¯»</h3>
<p>åè°è¯»å¦ä¸å¾æç¤ºï¼å¦æç¨æ·Aæ´æ°ææå¥äºæ°æ®ï¼è¿ä¸ªè¡ä¸ºå¯¹ç¨æ·Bä¸å¯è§ï¼ç¨æ·Båªéè¦æ¥è¯¢ä»åºå³å¯ï¼ä»åºä½æ¶åæ­¥äºå¯¹åºæ°æ®ï¼å°±ä½æ¶è¯»åå³å¯ãç±äºåå¥æä½æ¯ç¨æ·Aè¿è¡çï¼æä»¥ç¨æ·Bæ éè¯»å·±æåçä¿è¯ãä½å¦æç¨æ·Bç¬¬ä¸æ¬¡è¯»åçä»åºï¼å·²ç»åæ­¥äºç¨æ·Açåå¥ææ´æ°åå®¹ï¼æ­¤æ¶ç¨æ·Bå¯ä»¥æ¥çå°Açåå¥ææ´æ°ãä½æ¯ç¨æ·Båæ¬¡å·æ°é¡µé¢ï¼æ­¤æ¶è¯»è¯·æ±è¢«è·¯ç±å°å¦å¤ä¸ä¸ªä»åºï¼æ­¤ä»åºå ä¸ºç½ç»é®é¢æ¹ä»åºæ²¡æåæ­¥ç¨æ·Açåå¥ææ´æ°ãæ­¤æ¶å¯¹ç¨æ·Bæ¥è¯´ï¼ç¬¬ä¸æ¬¡çå°äºåå®¹ï¼ç¬¬äºæ¬¡åæ²¡æçå°åå®¹ãç¨æ·é¦åä»æ°é²å¯æ¬è¯»åï¼ç¶åä»éæ§å¯æ¬è¯»åï¼æ¶é´ä¼¼ä¹åéäºãä¸ºäºé²æ­¢è¿ç§å¼å¸¸ï¼æä»¬éè¦åè°è¯»ãåè°è¯»æä¾çä¿è¯æ¯ï¼ä¸ä¼è¯»åå°æ¯ä¹åè¯»åæ°æ®æ´æ§çæ°æ®ãä¹å°±è¯´åè°è¯»è¯»åçæ°æ®ï¼ä¿æåè°éå¢ï¼æ¯ä¸æ¬¡è¯»åçæ°æ®çæ¬åªä¼å¤§äºæç­äºåä¸æ¬¡è¯»åçæ°æ®ã<br>
<img src="https://img2024.cnblogs.com/blog/1435315/202511/1435315-20251129215659292-1491477398.png" alt="image" loading="lazy"></p>
<p>å¦ä½ä¿è¯åè°è¯»éç¦»çº§å«ï¼</p>
<ul>
<li>åä¸ä¸ªç¨æ·æ¯ä¸ªè¯·æ±è·¯ç±å°åºå®çä»åºï¼å°±å½ä¸ªæ°æ®åºèè¨ï¼æ°æ®çæ¬æ¯éå¢çï¼è¯»ååä¸ªå®ä¾ï¼è¯»åçæ°æ®çæ¬åªä¼å¤§äºæç­äºä¸ä¸æ¬¡è¯»åçæ°æ®ã</li>
<li>è®°å½ç¬¬ä¸æ¬¡è¯»åæ°æ®åºçç¹ä½ä¿¡æ¯ï¼ä¿è¯åç»­è¯·æ±åªä¼è¢«è·¯ç±å°æ¯è®°å½ç¹ä½ç¸ç­ææ´æ°çæ°æ®åºã</li>
</ul>
<p>å¦æä»ä»åªæ¯éè¦åè°è¯»çä¿è¯ï¼å°è¯»æä½æ ¹æ®ç¨æ·uid hashåè·¯ç±å°åºå®ä»åºæ¯å®ç°æç®åçæ¹å¼ãä½æäºå¨åè°è¯»çåºç¡ä¸ï¼éè¦ä¿è¯è¯»ä¹æåçæ··åæåµæ¶ï¼è·¯ç±å°åºå®ä»åºè¿ä¸ªæ¹æ¡å°±ä¸è¡äºï¼è·¯ç±å°åºå®ä»åºåªè½æ»¡è¶³åè°è¯»çä¸è´æ§ï¼ä½æ æ³æ»¡è¶³è¯»å·±æåãä¸ä¸èä¼è¯´æåè°è¯»+è¯»å·±æåçæ··åæåµã</p>
<h3 id="124-åºäºshrding-jdbcå®ç°åè°è¯»">1.2.4 åºäºShrding Jdbcå®ç°åè°è¯»</h3>
<pre><code>/**
 *1. è¯»ä¸è´æ§åé¢æ·»å åè°è¯»æ è¯
 * è¯»ä¸è´æ§æ³¨è§£ï¼ç¨äºæ è¯å½è¯»è¯·æ±çä¸è´æ§çº§å«
 */
@Slf4j
@Aspect
@Component
public class ReadConsistencyAspect {
    
    //è¯»å·±æå
    @Pointcut("@annotation(com.example.annotation.ReadSelfWrite)")
    public void readSelfWritePointCut() {
    }

    @Before(value = "readSelfWritePointCut()")
    public void readSelfWritePoint(JoinPoint joinPoint) throws Throwable {
        //å¯¹äºæ æ³¨äºè¯»ä¹æåçæ¥å£ï¼ä¸ä¸æä¸­è®¾ç½®å¯¹åºå±æ§
        ReadConsistencyManager.setReadSelfWrite();
    }

    //åè°è¯»
    @Pointcut("@annotation(com.example.annotation.MonotonicRead)")
    public void monotonicReadPointCut() {
    }

    @Before(value = "monotonicReadPointCut()")
    public void monotonicReadPoint(JoinPoint joinPoint) throws Throwable {
        //å¯¹äºæ æ³¨äºè¯»ä¹æåçæ¥å£ï¼ä¸ä¸æä¸­è®¾ç½®å¯¹äºå±æ§
        ReadConsistencyManager.setMonotonicRead();
    }

}
</code></pre>
<pre><code>/**
     * 2.èªå®ä¹ç®æ³ä¸­ï¼åè°è¯»éæ©ååºã
     *
     * @param name                read query logic data source name
     * @param writeDataSourceName ä¸»åºåç§°
     * @param readDataSourceNames ä»åºåç§°åè¡¨
     * @return éæ©çæ°æ®æºåç§°
     */
    public String getDataSource(String name, String writeDataSourceName, List&lt;String&gt; readDataSourceNames) {
        try {

            if (ReadConsistencyManager.readSelfWrite()) {
                //2.åªè¦æ±è¯»ä¹æå
                return getDb(writeDataSourceName, readDataSourceNames);
            } else if (ReadConsistencyManager.monotonicRead()) {
                //3.åªè¦æ±åè°è¯»ï¼æ ¹æ®å¯ä¸æ è¯ååºå³å¯ï¼ï¼æ­¤å¤ä½¿ç¨uid hashååä½ï¼å°è¯·æ±è·¯ç±å°æå®ååºã
                //ç±äºhashCodeå¯è½ç®åºè´æ°ï¼æä»¥å°å¶ä¸0x7ffffffæä½ç¸ä¸ï¼ä½¿å¶é¦ä½ç½®0åä¸ºæ­£æ°ã
                return readDataSourceNames.get((UserManager.getUid().hashCode() &amp; Integer.MAX_VALUE) % readDataSourceNames.size());
            } else {
                //4.ä¸è¦æ±è¯»ä¹æå+åè°è¯»
                return loadBalance(readDataSourceNames);
            }
        } finally {
            //æ¸çThread Local
            ReadConsistencyManager.clear();
        }
    }
</code></pre>
<h3 id="125-è¯»å·±æååè°è¯»">1.2.5 è¯»å·±æå+åè°è¯»</h3>
<p>åé¢æå°ï¼è¯»å·±æåååè°è¯»ï¼ä½è¿ä¸¤ä¸ªæ··åçæåµå¢ãè¿ä¸¤ä¸ªè¯»ä¸è´æ§æ¯ç¬ç«çï¼æ»¡è¶³å¶ä¸­ä¸ä¸ªå¹¶ä¸è½æå³çæ»¡è¶³å¦å¤ä¸ä¸ªãä½ææ¶ä¼éè¦å½åçè¯·æ±éè¦åæ¶æ»¡è¶³ä¸¤ä¸ªè¯»ä¸è´æ§çè¦æ±ã<br>
ä¾å¦å½åç¨æ·ç¼è¾èªå·±ä¸»é¡µï¼åç»­è¯»åèªå·±ä¸»é¡µè¦æ»¡è¶³è¯»å·±æåï¼æ­¤æ¶å¨ç¨æ·çæ¥ï¼ç¼è¾åè¯»åèªå·±çä¸»é¡µé½æ²¡æé®é¢ï¼å¯ä»¥çå°ä¿®æ¹åçæ°æ®ãä½æ¯è¯»åå«äººä¸»é¡µå¢ï¼æ­¤æ¶å°±æ²¡æä»»ä½ä¿è¯äºã<br>
ä¾å¦ç¨æ·å½åææ°çæ´æ°å·²ç»åæ­¥å°ææä»åºï¼S1,S2ï¼ï¼å½åè¯»åæ»¡è¶³è¯»å·±æåï¼è¯·æ±è¢«è·¯ç±å°ä»»ä¸ä¸ªä»åºå³å¯ï¼è¯¥ä»åºæèªå·±ææ°åå¥çæ°æ®ï¼æ»¡è¶³è¯»å·±æåï¼åæ¶å½åä»åºS1æç¨æ·Bçæ´æ°æä½ï¼ä½ç±äºç½ç»åå ï¼ç¨æ·Bçææ°æ°æ®æ²¡æè¢«åæ­¥å°ä»åºS2,æ­¤æ¶ç¨æ·å¦æåªä¿è¯è¯»å·±æåï¼ç¬¬ä¸æ¬¡è¢«è·¯ç±å°S1æ»¡è¶³è¯»å·±æåï¼ç¨æ·åæ¶æ¥çç¨æ·Bçä¸»é¡µï¼ç¬¬ä¸æ¬¡è¢«è·¯ç±å°S1å¯ä»¥çå°ä¿®æ¹è¿åçåå®¹ï¼ç¬¬äºæ¬¡è¢«è·¯ç±å°S2åæ æ³çå°ç¨æ·ä¿®æ¹åçåå®¹ï¼S1ï¼S2åæ»¡è¶³è¯»å·±æåï¼ä½åå¥æä½æ¯å¶ä»ç¨æ·Båå¥çï¼å¯¹å½åç¨æ·æ¥è¯´æç¥ä¸å°ï¼ä½æ­¤æ¶è¯»åå¶ä»ç¨æ·åå­å¨åè°è¯»çé®é¢ã<br>
æèæ¯è´­ç©è½¦åºæ¯ï¼ç¨æ·éè¦æ»¡è¶³è¯»å·±æåï¼å³æ·»å å°è´­ç©è½¦çåå®¹éè¦æ·»å åé©¬ä¸å¯è§ï¼åæ¶å¤æ¬¡è¯»åèªå·±è´­ç©è½¦éè¦æ»¡è¶³åè°è¯»ï¼ä¸è½åºç°æ°æ®åéçç°è±¡ã<br>
ä¸¤ç§è¯»ä¸è´æ§éè¦æ ¹æ®å·ä½åºæ¯å·ä½æ»¡è¶³å¯¹äºä¸è´æ§è¦æ±ã</p>
<p>æ¢ç¶è¦å®ç°è¯»å·±æå+åè°è¯»ï¼å¦ä½ä¿è¯è¿ä¸¤ç§è¯»ä¸è´æ§ï¼æ¬è´¨ä¸ä¸ä¸è´é®é¢é½æ¯è¯»åçæ°æ®çæ¬é æçï¼è¯»åå°æ¯å½ååºè¯¥çè§çæ°æ®çæ¬æ´æ§ççæ¬å¯¼è´çãæ è®ºæ¶è¯»å·±æåï¼è¯»åæ°æ®çæ¬ â¥ èªå·±æååå¥çæ¬ï¼ï¼è¿æ¯åè°è¯»ï¼è¯»åçæ¬è¦ â¥ æåä¸æ¬¡è¯»åçæ°æ®çæ¬ï¼ï¼æä»¥åªè¦ä¿è¯äºè¯»åçæ°æ®çæ¬ â¥ max(æåè¯»åçæ¬, æååå¥çæ¬)ï¼å³å¯ä¿è¯ä¸¤ç§ä¸è´æ§ã</p>
<p>æä»¥å·ä½å®ç°ç­ç¥ä¸ºï¼<strong>æ ¹æ®ç¨æ·è®°å½çç¹ä½ï¼åä¿è¯è¯»å·±æåï¼è·åä¸ä¸ªæ»¡è¶³æ¡ä»¶çæ°æ®çæ¬ï¼ç¶åè¯»åè¯¥æ°æ®çæ¬ï¼å¹¶ä¸è®°å½å½åè¯»åççæ¬ï¼å°å¶æä¸ºææ°ç¹ä½ã</strong><br>
åç»­è¯»åæä½å¿é¡»å¤§äºç­äºå½åç¹ä½ï¼å³ä¸ä¼åºç°åéç°è±¡ãåå¥æä½æ¶åå¥ä¸»åºï¼åæ¶æ´æ°ç¹ä½(åå¥æä½æ¯åå¥ä¸»åºï¼ç¹ä½ä¿æåè°éå¢)ï¼å³ä¸ä¼åºç°è¿èè¯»å·±æåæåµã<br>
æä»¥æåè¯»åçæ°æ®çæ¬ â¥ max(æåè¯»åçæ¬, æååå¥çæ¬)ï¼å³å¯ä¿è¯ä¸¤ç§ä¸è´æ§ã</p>
<p>Lâ = å½åå·²ç¥æå¤§çæ¬ç¹ä½<br>
Váµ£â = è¯»æä½å®éçæ¬<br>
Vâ = åæä½äº§ççæ¬<br>
è®¾åæä½ w(x,v) å¨ r(x) ä¹åï¼<br>
w(x,v) åï¼L â¥ v (åæä½æ´æ°è§åï¼è®°å½åå¥ç¹ä½)<br>
r(x) è¦æ±ï¼Váµ£ â¥ L (è¯»æä½è¦æ±ï¼å³å½åè¯»åæ°æ®å¯æ¬è¦å¤§äºç­äºè®°å½çç¨æ·å¯æ¬)<br>
ç±ä¼ éæ§ï¼Váµ£ â¥ L â¥ vï¼å³å½åè¯»æä½å¯ä»¥è¯»åå°èªå·±ææ°åå¥çæ°æ®<br>
å³ Váµ£ â¥ v æ»¡è¶³è¯»å·±æåã</p>
<p>è®¾ râ(x) å¨ râ(x) ä¹åï¼<br>
râ(x) åï¼L â¥ Váµ£â (è¯»æä½æ´æ°è§åï¼è¯»åæ°æ®åè®°å½å½åè¯»åç¹ä½ï¼å³L â¥ Váµ£â)<br>
râ(x) è¦æ±ï¼Váµ£â â¥ L (è¯»æä½è¦æ±ï¼è¯»åè¦æ±è¯»åæ°æ®å¿é¡»å¤§äºç­äºè®°å½ç¹ä½)<br>
ç±ä¼ éæ§ï¼Váµ£â â¥ L â¥ Váµ£âï¼å³ç¬¬äºæ¬¡è¯»åçæ°æ®ï¼å¿å¾å¤§äºç­äºç¬¬ä¸æ¬¡è¯»åæ°æ®ä¸ä¼åºç°åéã<br>
å³ Váµ£â â¥ Váµ£â æ»¡è¶³åè°è¯»ã</p>
<h3 id="126-åºäºsahrding-jdbcå®ç°è¯»å·±æååè°è¯»">1.2.6 åºäºSahrding Jdbcå®ç°è¯»å·±æå+åè°è¯»</h3>
<pre><code>/**
     * éæ©æ°æ®æºçæ ¸å¿æ¹æ³
     *
     * @param name                read query logic data source name
     * @param writeDataSourceName ä¸»åºåç§°
     * @param readDataSourceNames ä»åºåç§°åè¡¨
     * @return éæ©çæ°æ®æºåç§°
     */
    public String getDataSource(String name, String writeDataSourceName, List&lt;String&gt; readDataSourceNames) {
        try {

            if (ReadConsistencyManager.readSelfWrite() &amp;&amp; ReadConsistencyManager.monotonicRead()) {
                //å¦ææ¯è¯»ä¹æå+åè°è¯»
                //åæ ¹æ®è¯»ä¹æåï¼è·åè½è¯»åçåºã
                //æ­¤æ¶æä¸ç§æ¸ç©º
                //1. å­å¨ç¹ä½ä¿¡æ¯ï¼å¯ä»¥æ¾å°æ»¡è¶³ç¹ä½çä»åºï¼éæ©ä»åºã
                //2. å­å¨ç¹ä½ä¿¡æ¯ï¼æ æ³æ¾å°æ»¡è¶³ç¹ä½çä»åºï¼éæ©ä¸»åºã
                String dbName = getDb(writeDataSourceName, readDataSourceNames);

                //è·åå½åè¯»ååºçç¹ä½ä¿¡æ¯ï¼å¹¶ç¼å­
                //åç»­è¯·æ±å¿é¡»å¤§äºç­äºå­å¨çææ°ç¹ä½ã
                BinlogPositionService binlogPositionService = Singleton.getBinlogPositionServiceInstance();
                BinlogPosition specDbPosition = binlogPositionService.getPositionFromCache(dbName);
                binlogPositionService.cacheUserBinlogPosition(UserManager.getUid(), specDbPosition);

                return dbName;
            } else if (ReadConsistencyManager.readSelfWrite()) {
                //2.åªè¦æ±è¯»ä¹æå
                return getDb(writeDataSourceName, readDataSourceNames);
            } else if (ReadConsistencyManager.monotonicRead()) {
                //3.åªè¦æ±åè°è¯»ï¼æ ¹æ®å¯ä¸æ è¯ååºå³å¯ï¼
                return readDataSourceNames.get((UserManager.getUid().hashCode() &amp; Integer.MAX_VALUE) % readDataSourceNames.size());
            } else {
                //4.ä¸è¦æ±è¯»ä¹æå+åè°è¯»
                return loadBalance(readDataSourceNames);
            }
        } finally {
            //æ¸çThread Local
            ReadConsistencyManager.clear();
        }
    }

</code></pre>
<h2 id="13-é«å¯ç¨ç¯---æéåæ¢">1.3 é«å¯ç¨ç¯ - æéåæ¢</h2>
<h3 id="131-åæ¢çä¸è´æ§é®é¢">1.3.1 åæ¢çä¸è´æ§é®é¢</h3>
<p>åæ¢åï¼é¦åè¦è®¨è®ºï¼ä¸»ä»æ°æ®ä¸è´æ§é®é¢ãå¦ææ¯é¢æçåæ¢ï¼å³ä¸»åºæ²¡æå®æºçæåµä¸ãè¿ç§æåµä¸è´æ§æ¯å¾å®¹æä¿è¯çã<br>
å·ä½åæ¢æµç¨å¦ä¸ã<br>
1.å¤æ­å¤åº B ç°å¨ç seconds_behind_masterï¼å¦æå°äºæä¸ªå¼ï¼æ¯å¦ 5 ç§ï¼ç»§ç»­ä¸ä¸æ­¥ï¼å¦åæç»­éè¯è¿ä¸æ­¥ï¼<br>
2.æä¸»åº A æ¹æåªè¯»ç¶æï¼å³æ readonly è®¾ç½®ä¸º trueï¼<br>
3.å¤æ­å¤åº B ç seconds_behind_master çå¼ï¼ç´å°è¿ä¸ªå¼åæ 0 ä¸ºæ­¢ï¼<br>
4.æå¤åº B æ¹æå¯è¯»åç¶æï¼ä¹å°±æ¯æ readonly è®¾ç½®ä¸º falseï¼<br>
5.æä¸å¡è¯·æ±åå°å¤åº Bã<br>
åæ¢åæ°æ®ä¸»ä»æ°æ®æ¯ä¸è´çï¼ä¸æ²¡æä¸¢å¤±ã</p>
<p>é£å¦ææ¯ä¸»åºå®æºå¢ï¼è¿æ¶æåµå°±æ¯è¾å¤æå¢ã<br>
é¦åï¼æä»¬ä¸»ä»å¤å¶çæåµä¸ï¼æ°æ®æä¸¤ä¸ªå¤§ççº¦æã<br>
çº¦æ1ï¼å®¢æ·ç«¯æ¶å°æåååºä¿è¯ä¸»åºäºå¡å·²æäº¤å¹¶æä¹åã<br>
çº¦æ2ï¼ä»åºè¯»åä¸»åºbinlogåå¥relay logæåï¼ä¸»åºå¿å®åå¥å¯¹åºbinlogã<br>
çº¦æ1ï¼ç±MySQLä¿è¯ï¼çº¦æ2ï¼ä¹å¾å®¹æçåºï¼ä»åºä¸­ç»§æ¥å¿çåå®¹å°±æ¯ä¸»åºçbinlogåå®¹ï¼åå¥äºä»åºä¸­ç»§æ¥å¿ï¼ä¸»åºå¿å®ä¼å­å¨å¯¹åºæ¥å¿åå®¹ã<br>
é£ä¹ä¸»è¦åºæ¯å¦ä¸ï¼</p>
<table>
<thead>
<tr>
<th>åºæ¯ç¼å·</th>
<th>å®¢æ·ç«¯æ¥æ¶ååº</th>
<th>ä¸»åºbinlogåå¥ç¶æ</th>
<th>ä»åºready blogç¶æ</th>
<th>æç»åæ¢åä¸»ä»æ°æ®ç¶æ</th>
<th>åæ¢ä»åºåå®¢æ·ç«¯ä¸ä»åºä¸è´æ§</th>
<th>å¤æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>â æå</td>
<td>â å·²åå¥</td>
<td>â å·²åå¥</td>
<td>ä¸è´</td>
<td>ä¸è´</td>
<td>æ®éæåµ</td>
</tr>
<tr>
<td>2</td>
<td>â æå</td>
<td>â å·²åå¥</td>
<td>â æªåå¥</td>
<td>æ°æ®ä¸¢å¤±</td>
<td>ä¸ä¸è´ï¼å®¢æ·ç«¯æ¥æ¶å°æåååºï¼åæ¢åä»åºæ²¡ææ°æ®</td>
<td>å¨æ­£ç¡®éç½®ååæ­¥æåµä¸ä¼åºç°ï¼å¦æåºç°éçº§åä¼åºç°è¿ç§æåµã</td>
</tr>
<tr>
<td>3</td>
<td>â æå</td>
<td>â æªåå¥</td>
<td>â å·²åå¥</td>
<td></td>
<td></td>
<td>ä¸ä¼åºç°ï¼è¿åçº¦æ2</td>
</tr>
<tr>
<td>4</td>
<td>â æå</td>
<td>â æªåå¥</td>
<td>â æªåå¥</td>
<td></td>
<td></td>
<td>ä¸ä¼åºç°ï¼è¿åçº¦æ1ï¼çº¦æ2</td>
</tr>
<tr>
<td>5</td>
<td>â å¤±è´¥</td>
<td>â å·²åå¥</td>
<td>â å·²åå¥</td>
<td>ä¸è´</td>
<td>ä¸ä¸è´ï¼å®¢æ·ç«¯æ¥æ¶å°å¤±è´¥ååºï¼åæ¢åä»åºå·²ç»å®ææä½</td>
<td>å¯è½åºç°ï¼ä¸»ä»é½åå¥binlogåï¼è¿åå®¢æ·ç«¯å¤±è´¥ï¼å¦ç½ç»æéã</td>
</tr>
<tr>
<td>6</td>
<td>â å¤±è´¥</td>
<td>â å·²åå¥</td>
<td>â æªåå¥</td>
<td>æ°æ®ä¸¢å¤±</td>
<td>è®¤ç¥ä¸è´ï¼å®¢æ·ç«¯æ¥æ¶å¤±è´¥æ¶æ¯ï¼ä»åºä¹æ²¡ææ°æ®ã</td>
<td>å¯è½åºç°ï¼ä»åºéçº§ï¼åå¥ä¸»åºæåï¼ååºå®¢æ·ç«¯åæéãå¨æ­£ç¡®éç½®ååæ­¥æåµä¸ä¼åºç°ï¼å¦æåºç°éçº§åä¼åºç°è¿ç§æåµã</td>
</tr>
<tr>
<td>7</td>
<td>â å¤±è´¥</td>
<td>â æªåå¥</td>
<td>â å·²åå¥</td>
<td></td>
<td></td>
<td>ä¸ä¼åºç°ï¼è¿æ³çº¦æ2</td>
</tr>
<tr>
<td>8</td>
<td>â å¤±è´¥</td>
<td>â æªåå¥</td>
<td>â æªåå¥</td>
<td>ä¸è´</td>
<td>è®¤ç¥ä¸è´ï¼å®¢æ·ç«¯æ¥æ¶å¤±è´¥ï¼ä¸»ä»é½æ²¡æåå¥ã</td>
<td>ä¼åºç°ï¼ä¸»åºåå¥åç´æ¥æäºï¼æSQLè¯­æ³éè¯¯ï¼é¿åº¦è¶é¿ç­ä¸»åºå°±ç´æ¥æªæ§è¡ã</td>
</tr>
<tr>
<td>9</td>
<td>â² è¶æ¶æªç¥</td>
<td>â å·²åå¥</td>
<td>â å·²åå¥</td>
<td>ä¸è´</td>
<td>æªç¥ï¼éè¦éè¯ææ¥è¯¢ã</td>
<td>å¯è½åºç°ï¼è¶æ¶äºã</td>
</tr>
<tr>
<td>10</td>
<td>â² è¶æ¶æªç¥</td>
<td>â å·²åå¥</td>
<td>â æªåå¥</td>
<td>æ°æ®ä¸¢å¤±</td>
<td>æªç¥ï¼éè¦éè¯ææ¥è¯¢ã</td>
<td>å¯è½åºç°ï¼è¶æ¶äºãåæ¶ä»åºç±ååæ­¥éçº§ä¸ºå¼æ­¥ã</td>
</tr>
<tr>
<td>11</td>
<td>â² è¶æ¶æªç¥</td>
<td>â æªåå¥</td>
<td>â å·²åå¥</td>
<td></td>
<td></td>
<td>ä¸ä¼åºç°ï¼è¿æ³çº¦æ2</td>
</tr>
<tr>
<td>12</td>
<td>â² è¶æ¶æªç¥</td>
<td>â æªåå¥</td>
<td>â æªåå¥</td>
<td>ä¸è´</td>
<td>æªç¥ï¼éè¦éè¯ææ¥è¯¢ã</td>
<td>å¯è½åºç°ï¼ç½ç»æéã</td>
</tr>
</tbody>
</table>
<p>è¯»ååç¦»åºæ¯ä¸ï¼ç¨æ·ä¸å³æ³¨ä¸»ä»æ°æ®æ¯å¦ä¸è´ï¼ç¨æ·åªå³æ³¨å®¢æ·ç«¯æ¥æ¶ååºï¼ä¸åæ¢åä»åºæ°æ®ç¶æãæä»¥æä»¬æåè¿ä¸¤åã<br>
å»é¤ä¸å¯è½åºç°åååä¸è´çæåµï¼ä¿çä¸ä¸è´çæåµå¦ä¸:</p>
<table>
<thead>
<tr>
<th>åºæ¯ç¼å·</th>
<th>å®¢æ·ç«¯</th>
<th>åæ¢åä»åº</th>
<th>å®¢æ·ç«¯ä¸ä»åºæ°æ®ä¸è´æ§</th>
<th>å®¢æ·ç«¯ä¸ä»åºä¸è´æ§</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>â æå</td>
<td>â æªåå¥</td>
<td>ä¸¢å¤±æ°æ®</td>
<td>ä¸ä¸è´ï¼å®¢æ·ç«¯æ¥æ¶æåï¼åæ¢åä»åºæ²¡ææ°æ®</td>
</tr>
<tr>
<td>2</td>
<td>â å¤±è´¥</td>
<td>â å·²åå¥</td>
<td>å¹½çµæ°æ®</td>
<td>ä¸ä¸è´ï¼å®¢æ·ç«¯æ¥æ¶å¤±è´¥ï¼åæ¢åä»åºææ°æ®</td>
</tr>
<tr>
<td>3</td>
<td>â² è¶æ¶æªç¥</td>
<td>â å·²åå¥</td>
<td>æªç¥ï¼éè¦æ¥è¯¢æéè¯</td>
<td>ä¸è´ï¼è¶æ¶æªç¥ï¼éè¦éæ°æ¥è¯¢ã</td>
</tr>
<tr>
<td>4</td>
<td>â² è¶æ¶æªç¥</td>
<td>â æªåå¥</td>
<td>æªç¥ï¼éè¦æ¥è¯¢æéè¯</td>
<td>ä¸è´ï¼è¶æ¶æªç¥ï¼éè¦éæ°æ¥è¯¢ã</td>
</tr>
</tbody>
</table>
<p>åºæ¯1ï¼ææ¾æ°æ®ä¸¢å¤±äºï¼åé¨ç»è¿å¥½ï¼æä½ä»¥äºå¡ä¸ºåä½ï¼å³ä½¿æ°æ®ä¸¢å¤±ï¼æ´ä½æ°æ®ç¶æä¹æ¯ä¸è´çãé¢ææ¯ç±ä¸è´æ§ç¶æAè½¬ç§»å°ä¸è´æ§ç¶æBãå³ä½¿æ²¡æè½¬ç§»å°ä¸è´æ§ç¶æB,ä½æ°æ®ä¹ä¿æäºä¹åçä¸è´æ§ç¶æAï¼ä¹æ¯å®å¨çãä¾å¦ç¶æï¼Aç¨æ·æ£å100ï¼Bç¨æ·å¢å 100.å³ä½¿è¿ä¸ªäºå¡æä½ä¸¢å¤±ï¼Aç¨æ·é±ä¹æ²¡ææ£åï¼Bç¨æ·é±ä¹æ²¡å¢å è¿æ¯ä¸è´çãä½æ¶åç¬¬ä¸æ¹ç³»ç»ä¸è´æ§æ¢æ²¡æåæ³å¾å°ä¿è¯äºï¼äºå¡åªè½ä¿è¯åé¨ç³»ç»çä¸è´æ§ï¼ä¾å¦æ¯åå»ºä¸ä¸ªè®¢åï¼åç»­æ ¹æ®è¿ä¸ªè®¢åè°ç¨ç¬¬ä¸æ¹æ¥å£è½¬è´¦ï¼ç¶åæ´æ°è®¢åç¶æãå¦æè¿ä¸ªè®¢åæ°æ®ä¸¢å¤±ï¼åæ¶ä¹è°ç¨äºç¬¬ä¸æ¹æ¥å£å®æäºç¶æãé£è¿ä¸ªå°±éè¦å¯¹è´¦å»å¤çäºãç³»ç»åå½åæ100ç¬è®¢åï¼ç¬¬ä¸æ¹ç³»ç»æ101ç¬ï¼éè¿çæ§æ¾åºä¸ä¸è´æ§çæ°æ®ï¼è¦ä¹å¨ç¬¬ä¸æ¹ç³»ç»ä¸­éæè®¢åï¼æå¨åé¨ç³»ç»æ¢å¤æ°æ®ã<br>
åºæ¯2ï¼å¹½çµæ°æ®ï¼å®¢æ·æ¥æ¶ååºå¤±è´¥ï¼ä½æ°æ®åå¥äºï¼è¿æ¶ç¨æ·å¯è½éå¤æä½ï¼æäºæä½æ¯è¦ççï¼éå¤æä½ä»¥æåä¸æ¬¡ä¸ºåå³å¯ï¼ä¾å¦ä¿®æ¹ä¸ªäººä¸»é¡µãéå¤åå¥åé¢è¦çåé¢å³å¯ï¼å¤æ¬¡æä½æ¯å®å¨çã<br>
ä½æäºä¸åè®¸åºç°éå¤æ°æ®çæä½ï¼å°±éè¦ç»åä¸å¡åºæ¯èèå¹ç­æä½ã<br>
åºæ¯3ï¼4ï¼å¯¹äºå®¢æ·æ¥è¯´ï¼æ¥æ¶çæ¯è¶æ¶ãé£ä¹åæ¢åï¼ä»åºæ°æ®æ è®ºæ¯å­å¨è¿æ¯ä¸¢å¤±é½æ¯å¯ä»¥æ¥åçï¼æ¯è¾æ²¡ææç¡®çè¿åæåæå¤±è´¥ãéå¯¹è¿äºè¿åï¼éè¦åæ¥è¯¢ä¸æ¬¡ï¼åæ¶èèéè¯æå¹ç­å»éå³å¯ã</p>
<p>ä¸è¿°å°±æ¯åæ¢åçä¸è´æ§é®é¢ï¼éè¦æ ¹æ®ä¸å¡éè¦æ§å»åç¸å¯¹äºçååºæä½ãå¯¹äºä¸éè¦çä¸å¡æ°æ®ï¼ä¸¢å¤±æéå¤é½æ¯å¯æ¥æ¶çã<br>
å¯¹äºéè¦çæ°æ®å°±éè¦èèå¥½åç§æåµï¼è½éè¿çæ§ç­ææ®µï¼è¯å«æç»æ°æ®çä¸è´æ§æåµï¼å ä¸åå¥½é¢æ¡ï¼åºç°é®é¢è½å¿«éä¿®å¤å³å¯ã<br>
æ¯ç«ï¼çæ­£çä¸ä¸è´æåµç¸å¯¹æ¥è¯´è¿æ¯è¾å°çï¼å¤§å¤æ°æåµé½æ¯æ­£å¸¸æåµï¼ä½ä¹è¦èèå°æåæåµã</p>
<h3 id="132-åºäºzookeeperçå¨æéç½®åæ¢">1.3.2 åºäºZookeeperçå¨æéç½®åæ¢</h3>
<pre><code class="language-xml">        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.shardingsphere&lt;/groupId&gt;
            &lt;artifactId&gt;shardingsphere-cluster-mode-core&lt;/artifactId&gt;
            &lt;version&gt;5.2.1&lt;/version&gt;

            &lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;org.yaml&lt;/groupId&gt;
                    &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.yaml&lt;/groupId&gt;
            &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt;
            &lt;version&gt;1.33&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.shardingsphere&lt;/groupId&gt;
            &lt;artifactId&gt;shardingsphere-cluster-mode-repository-zookeeper&lt;/artifactId&gt;
            &lt;version&gt;5.3.0&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre>
<pre><code class="language-yaml">  # ShardingSphereè¯»ååç¦»éç½®ï¼
  shardingsphere:
    mode:
      type: Cluster
      repository:
        type: ZooKeeper
        props:
          namespace: governance_ds
          server-lists: hcf.com:2181
          retryIntervalMilliseconds: 500
          timeToLiveSeconds: 60
          maxRetries: 3
          operationTimeoutMilliseconds: 5000
      overwrite: false
</code></pre>
<p>åºç¨å¯å¨ï¼éç½®ä¿¡æ¯ä¸ä¼ å°zookeeperãåç»­ç´æ¥ä¿®æ¹zookeeperä¸­çéç½®ä¿¡æ¯ãshrding-jdbcä¼æ¶å°éç¥ï¼ä¿®æ¹å¯¹åºéç½®ï¼å¦åçè§åï¼ä¸»ä»æ°æ®æºç­ã<br>
<img src="https://img2024.cnblogs.com/blog/1435315/202601/1435315-20260103213755857-1418909837.png" alt="image" loading="lazy"></p>
<p>ä¸»ï¼3311ï¼ä»1ï¼3312ï¼ä»2ï¼3313<br>
<img src="https://img2024.cnblogs.com/blog/1435315/202601/1435315-20260103212522657-533951894.png" alt="image" loading="lazy"></p>
<p>ä¿®æ¹zookeeperä¸çéç½®ãåè£ä¸»åºå®æºï¼3312åä¸ºæ°çä¸»åºï¼3313ä¿æä»åºã<br>
<img src="https://img2024.cnblogs.com/blog/1435315/202601/1435315-20260103212539665-780073460.png" alt="image" loading="lazy"><br>
<img src="https://img2024.cnblogs.com/blog/1435315/202601/1435315-20260103212657920-1583796145.png" alt="image" loading="lazy"><br>
å¯ä»¥çå°ï¼zookeeperä¸­versionsä¸æ°å¢ä¸ä¸ªçæ¬å·ä¸º1çéç½®ï¼å¨éé¢å¡«åä¿®æ¹åéç½®ï¼ç¶åå°active_versionä¿®æ¹ä¸º1ï¼åç»­é¡¹ç®ä¸­æ°æ®æºä¹å·æ°äºãä¸»åºåä¸º3312ï¼ä»åºåä¸ºäº3313.</p>
<p><a href="https://github.com/GCMH/Read-Write-Separation" target="_blank" rel="noopener nofollow">å®æ´ä»£ç è¯¦è§https://github.com/GCMH/Read-Write-Separation</a></p>
<p>åèèµæï¼<br>
[1].ãæ°æ®å¯éååºç¨ç³»ç»è®¾è®¡ã<br>
[2].ãMySQL45è®²ã<br>
[3]. <a href="http://shardingsphere.apache.org/document/current/en/overview/" target="_blank" rel="noopener nofollow">Shrding Jdbc</a></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.0006944444444444445" data-date-updated="2026-01-04 15:49">2026-01-04 15:48</span>&nbsp;
<a href="https://www.cnblogs.com/huang-changfan">gcmh</a>&nbsp;
éè¯»(<span id="post_view_count">278</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19185323);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19185323', targetLink: 'https://www.cnblogs.com/huang-changfan/p/19185323', title: 'è¯»ååç¦»é¢ä¸´çé®é¢åå¶è§£å³æ¹æ¡' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ .NET+AI | åºäº Microsoft Agent Framework ä¸æ­¥æ­¥éæ Agent Skillsï¼è®©ä½ ç AI Agent æ´æºè½ ]]></title>
    <link>https://www.cnblogs.com/sheng-jie/p/19442149</link>
    <guid>e95e50c4e1230f44af7485aecd6d6260</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/sheng-jie/p/19442149" title="åå¸äº 2026-01-05 11:50">
    <span role="heading" aria-level="2">.NET+AI | åºäº Microsoft Agent Framework ä¸æ­¥æ­¥éæ Agent Skillsï¼è®©ä½ ç AI Agent æ´æºè½</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="åºäº-microsoft-agent-framework-å®ç°-agent-skills-éæ">åºäº Microsoft Agent Framework å®ç° Agent Skills éæ</h1>
<h2 id="å¼è¨">å¼è¨</h2>
<p>éç AI Agent ææ¯çå¿«éåå±ï¼å¦ä½è®© Agent å·å¤å¯å¤ç¨ãå¯æ©å±çä¸ä¸è½åæä¸ºä¸ä¸ªéè¦è¯¾é¢ã<a href="https://agentskills.io" target="_blank" rel="noopener nofollow">Agent Skills</a> è§èæä¾äºä¸ç§æ ååçæ¹å¼æ¥å®ä¹ååå Agent æè½ï¼è <a href="https://github.com/microsoft/ai-agents" target="_blank" rel="noopener nofollow">Microsoft Agent Framework (MAF)</a> åæä¾äºæå»º AI Agent çå¼ºå¤§åºç¡è®¾æ½ã</p>
<p>æ¬æå°æ·±å¥ä»ç»å¦ä½åºäº MAF çä¸ä¸ææ©å±ï¼<code>AIContextProvider</code>ï¼å®ç° Agent Skills çéæï¼åæ¬æ ¸å¿æ¶æè®¾è®¡ãå³é®ç»ä»¶å®ç°ä»¥åå®éåºç¨ç¤ºä¾ã</p>
<blockquote>
<p>æºç å·²ä¸ä¼ è³GitHubï¼ææ«æ«ç ï¼<strong>å å¥ã.NET+AI ç¤¾åºç¾¤ãï¼å³å¯è·åã.NET+AI å¬å¼èµæåã</strong>ã</p>
</blockquote>
<hr>
<h2 id="æ¶ææ¦è¿°">æ¶ææ¦è¿°</h2>
<h3 id="æ´ä½æ¶æ">æ´ä½æ¶æ</h3>
<p>Maf.AgentSkills é¡¹ç®éç¨äº MAF å®æ¹æ¨èç <code>AIContextProviderFactory</code> æ¨¡å¼ï¼å®ç°äºä¸ MAF çæ ç¼éæãæ´ä½æ¶æå¦ä¸ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/577140/202601/577140-20260105114837837-1484392163.png" alt="" loading="lazy"></p>
<h3 id="ææ¯æ ">ææ¯æ </h3>
<ul>
<li><strong>ç®æ æ¡æ¶</strong>: .NET 10.0</li>
<li><strong>æ ¸å¿ä¾èµ</strong>:
<ul>
<li><code>Microsoft.Agents.AI</code> - MAF æ ¸å¿æ¡æ¶</li>
<li><code>Microsoft.Extensions.AI</code> - AI æ½è±¡å±</li>
<li><code>YamlDotNet</code> - YAML Frontmatter è§£æ</li>
<li><code>Microsoft.Extensions.DependencyInjection</code> - ä¾èµæ³¨å¥æ¯æ</li>
</ul>
</li>
</ul>
<hr>
<h2 id="æ ¸å¿è®¾è®¡çå¿µ">æ ¸å¿è®¾è®¡çå¿µ</h2>
<h3 id="1-æ¸è¿å¼æ«é²-progressive-disclosure">1. æ¸è¿å¼æ«é² (Progressive Disclosure)</h3>
<p>Agent Skills çæ ¸å¿çå¿µä¹ä¸æ¯<strong>æ¸è¿å¼æ«é²</strong>ï¼Agent é¦ååªè·åæè½çåæ°æ®ï¼åç§°åæè¿°ï¼ï¼åªæå¨çæ­£éè¦ä½¿ç¨æä¸ªæè½æ¶ï¼æå è½½å®æ´çæä»¤åå®¹ã</p>
<p>è¿ç§è®¾è®¡æå ä¸ªéè¦ä¼å¿ï¼</p>
<ol>
<li><strong>åå° Token æ¶è</strong>ï¼ç³»ç»æç¤ºåªåå«ç®ç­çæè½åè¡¨ï¼èä¸æ¯æææè½çå®æ´åå®¹</li>
<li><strong>æé«æç</strong>ï¼Agent å¯ä»¥å¿«éå¤æ­åªäºæè½ä¸å½åä»»å¡ç¸å³</li>
<li><strong>æéå è½½</strong>ï¼è¯¦ç»æä»¤ä»å¨éè¦æ¶è·åï¼é¿åä¿¡æ¯è¿è½½</li>
</ol>
<p><img src="https://img2024.cnblogs.com/blog/577140/202601/577140-20260105114837828-1786264926.png" alt="" loading="lazy"></p>
<p><strong>ä¿¡æ¯è·åæµç¨</strong>ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/577140/202601/577140-20260105114837954-307200857.png" alt="" loading="lazy"></p>
<h3 id="2-ç¬¦å-maf-è®¾è®¡æ¨¡å¼">2. ç¬¦å MAF è®¾è®¡æ¨¡å¼</h3>
<p>é¡¹ç®ä¸¥æ ¼éµå¾ª MAF ç <code>AIContextProviderFactory</code> æ¨¡å¼ï¼è¿æ¯ MAF æ¨èçä¸ä¸ææ³¨å¥æ¹å¼ï¼</p>
<pre><code class="language-csharp">// MAF æ åæ¨¡å¼
AIAgent agent = chatClient.CreateAIAgent(new ChatClientAgentOptions
{
    AIContextProviderFactory = ctx =&gt; new MyContextProvider(
        chatClient,
        ctx.SerializedState,
        ctx.JsonSerializerOptions)
});
</code></pre>
<p>éè¿å®ç° <code>AIContextProvider</code> æ½è±¡ç±»ï¼æä»¬å¯ä»¥ï¼</p>
<ul>
<li>å¨æ¯æ¬¡ Agent è°ç¨åæ³¨å¥æè½ä¿¡æ¯</li>
<li>å¨ææä¾ InstructionsãMessages å Tools</li>
<li>æ¯æçº¿ç¨ç¶æçåºåååååºåå</li>
</ul>
<h3 id="3-å®å¨ç¬¬ä¸">3. å®å¨ç¬¬ä¸</h3>
<p>æè½ç³»ç»æ¶åæä»¶è¯»ååå¯è½çèæ¬æ§è¡ï¼å æ­¤å®å¨æ§æ¯é¦è¦èèï¼</p>
<ul>
<li><strong>è·¯å¾éåé²æ¤</strong>ï¼æææä»¶æä½é½ç»è¿è·¯å¾å®å¨éªè¯</li>
<li><strong>ç¬¦å·é¾æ¥æ£æµ</strong>ï¼é²æ­¢éè¿ç¬¦å·é¾æ¥éé¸</li>
<li><strong>èæ¬æ§è¡é»è®¤ç¦ç¨</strong>ï¼éè¦æ¾å¼å¯ç¨å¹¶éç½®ç½åå</li>
<li><strong>å½ä»¤æ§è¡ç½åå</strong>ï¼åªåè®¸é¢å®ä¹çå½ä»¤</li>
</ul>
<p><img src="https://img2024.cnblogs.com/blog/577140/202601/577140-20260105114838100-771593506.png" alt="" loading="lazy"></p>
<hr>
<h2 id="å³é®ç»ä»¶è¯¦è§£">å³é®ç»ä»¶è¯¦è§£</h2>
<h3 id="1-skillscontextprovider---æè½ä¸ä¸ææä¾å¨">1. SkillsContextProvider - æè½ä¸ä¸ææä¾å¨</h3>
<p><code>SkillsContextProvider</code> æ¯æ´ä¸ªç³»ç»çæ ¸å¿ï¼å®ç»§æ¿èª MAF ç <code>AIContextProvider</code> æ½è±¡ç±»ï¼</p>
<pre><code class="language-csharp">public sealed class SkillsContextProvider : AIContextProvider
{
    private readonly IChatClient _chatClient;
    private readonly SkillLoader _skillLoader;
    private readonly SkillsOptions _options;
    private SkillsState _state;

    // æé å½æ°1ï¼åå»ºæ°å®ä¾
    public SkillsContextProvider(IChatClient chatClient, SkillsOptions? options = null)
    {
        _chatClient = chatClient;
        _options = options ?? new SkillsOptions();
        
        var settings = new SkillsSettings(_options.AgentName, _options.ProjectRoot);
        _skillLoader = new SkillLoader();
        _state = new SkillsState();

        // èªå¨å è½½æè½
        LoadSkills(settings);
    }

    // æé å½æ°2ï¼ä»åºååç¶ææ¢å¤ï¼æ¯æçº¿ç¨æä¹åï¼
    public SkillsContextProvider(
        IChatClient chatClient,
        JsonElement serializedState,
        JsonSerializerOptions? jsonSerializerOptions = null)
    {
        // ååºååæ¢å¤ç¶æ...
    }

    // å¨ Agent è°ç¨åæ³¨å¥æè½ä¸ä¸æ
    public override ValueTask&lt;AIContext&gt; InvokingAsync(
        InvokingContext context,
        CancellationToken cancellationToken = default)
    {
        // çææè½ç³»ç»æç¤º
        var instructions = GenerateSkillsPrompt(_state.AllSkills);
        
        // åå»ºæè½å·¥å·
        var tools = CreateSkillsTools(_state);

        return ValueTask.FromResult(new AIContext
        {
            Instructions = instructions,
            Tools = tools
        });
    }

    // åºååç¶æä»¥æ¯æçº¿ç¨æä¹å
    public override JsonElement Serialize(JsonSerializerOptions? jsonSerializerOptions = null)
    {
        var state = new { Options = _options, State = _state };
        return JsonSerializer.SerializeToElement(state, jsonSerializerOptions);
    }
}
</code></pre>
<p><strong>å³é®è®¾è®¡ç¹</strong>ï¼</p>
<ol>
<li><strong>åæé å½æ°æ¨¡å¼</strong>ï¼ä¸ä¸ªç¨äºåå»ºæ°å®ä¾ï¼ä¸ä¸ªç¨äºä»åºååç¶ææ¢å¤</li>
<li><strong>InvokingAsync</strong>ï¼å¨æ¯æ¬¡ Agent è°ç¨åè¢«è°ç¨ï¼è¿å <code>AIContext</code> æ³¨å¥æè½ä¿¡æ¯</li>
<li><strong>Serialize</strong>ï¼æ¯æå°æè½ç¶æåºååï¼ç¨äºçº¿ç¨æä¹ååºæ¯</li>
</ol>
<p><img src="https://img2024.cnblogs.com/blog/577140/202601/577140-20260105114837897-1781124143.png" alt="" loading="lazy"></p>
<h3 id="2-skillloader---æè½å è½½å¨">2. SkillLoader - æè½å è½½å¨</h3>
<p><code>SkillLoader</code> è´è´£ä»æä»¶ç³»ç»åç°åå è½½æè½ï¼</p>
<pre><code class="language-csharp">public sealed class SkillLoader
{
    private readonly SkillParser _parser;

    /// &lt;summary&gt;
    /// ä»æå®ç®å½å è½½æææè½
    /// &lt;/summary&gt;
    public IEnumerable&lt;SkillMetadata&gt; LoadSkillsFromDirectory(
        string skillsDirectory, 
        SkillSource source)
    {
        if (!Directory.Exists(skillsDirectory))
            yield break;

        foreach (var skillDir in Directory.GetDirectories(skillsDirectory))
        {
            var skill = TryLoadSkill(skillDir, source);
            if (skill is not null)
                yield return skill;
        }
    }

    private SkillMetadata? TryLoadSkill(string skillDirectory, SkillSource source)
    {
        var skillFilePath = Path.Combine(skillDirectory, "SKILL.md");

        if (!File.Exists(skillFilePath))
            return null;

        // å®å¨æ£æ¥ï¼éªè¯ç¬¦å·é¾æ¥
        if (PathSecurity.IsSymbolicLink(skillFilePath))
        {
            var realPath = PathSecurity.GetRealPath(skillFilePath);
            if (!PathSecurity.IsPathSafe(realPath, skillDirectory))
                return null;
        }

        return _parser.Parse(skillFilePath, source);
    }
}
</code></pre>
<p><strong>æè½ç®å½ç»æ</strong>ï¼</p>
<pre><code>~/.maf/{agent-name}/skills/     # ç¨æ·çº§æè½
{project-root}/.maf/skills/     # é¡¹ç®çº§æè½ï¼ä¼åçº§æ´é«ï¼
</code></pre>
<p>æ¯ä¸ªæè½æ¯ä¸ä¸ªç¬ç«çç®å½ï¼åå« <code>SKILL.md</code> æä»¶ï¼</p>
<pre><code>skills/
âââ web-research/
â   âââ SKILL.md
â   âââ search.py
â   âââ templates/
â       âââ report.md
âââ code-review/
â   âââ SKILL.md
â   âââ checklist.md
âââ pdf-tools/
    âââ SKILL.md
    âââ split_pdf.py
    âââ merge_pdf.py
</code></pre>
<p><strong>æè½å è½½æµç¨</strong>ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/577140/202601/577140-20260105114838125-1683611629.png" alt="" loading="lazy"></p>
<h3 id="3-skillparser---æè½è§£æå¨">3. SkillParser - æè½è§£æå¨</h3>
<p><code>SkillParser</code> è´è´£è§£æ SKILL.md æä»¶ç YAML Frontmatterï¼</p>
<pre><code class="language-csharp">public sealed class SkillParser
{
    private const string FrontmatterDelimiter = "---";

    public SkillMetadata Parse(string skillFilePath, SkillSource source)
    {
        var content = File.ReadAllText(skillFilePath);
        var skillDirectory = Path.GetDirectoryName(skillFilePath)!;
        var directoryName = Path.GetFileName(skillDirectory);

        // æå YAML Frontmatter
        var frontmatter = ExtractFrontmatter(content);
        if (frontmatter is null)
            throw new SkillParseException(skillFilePath, 
                "SKILL.md must have YAML frontmatter delimited by '---'.");

        // è§£æ YAML
        var yamlData = _yamlDeserializer.Deserialize&lt;SkillFrontmatter&gt;(frontmatter);

        // éªè¯å¿éå­æ®µ
        if (string.IsNullOrWhiteSpace(yamlData.Name))
            throw new SkillParseException(skillFilePath, "Skill 'name' is required.");

        if (string.IsNullOrWhiteSpace(yamlData.Description))
            throw new SkillParseException(skillFilePath, "Skill 'description' is required.");

        // éªè¯åç§°æ ¼å¼åç®å½å¹é
        SkillValidator.ValidateName(yamlData.Name);
        SkillValidator.ValidateNameMatchesDirectory(yamlData.Name, directoryName);

        return new SkillMetadata(
            Name: yamlData.Name,
            Description: yamlData.Description,
            Path: skillDirectory,
            Source: source,
            License: yamlData.License,
            AllowedTools: AllowedTool.Parse(yamlData.AllowedTools)
        );
    }
}
</code></pre>
<p><strong>SKILL.md æ ¼å¼ç¤ºä¾</strong>ï¼</p>
<pre><code class="language-markdown">---
name: web-research
description: A skill for conducting comprehensive web research
license: MIT
allowed-tools: web_search fetch_url
---

# Web Research Skill

## When to Use
Use this skill when researching topics online...

## Instructions
1. Clarify the research scope
2. Search strategically
3. Synthesize information
...
</code></pre>
<h3 id="4-skillstoolfactory---å·¥å·å·¥å">4. SkillsToolFactory - å·¥å·å·¥å</h3>
<p><code>SkillsToolFactory</code> æ ¹æ®éç½®åå»ºæè½ç¸å³çå·¥å·ï¼</p>
<pre><code class="language-csharp">public sealed class SkillsToolFactory
{
    public IReadOnlyList&lt;AITool&gt; CreateTools()
    {
        var tools = new List&lt;AITool&gt;();

        // é»è®¤å¯ç¨çå®å¨å·¥å·
        if (_options.EnableReadSkillTool)
            tools.Add(new ReadSkillTool(_loader, _stateProvider).ToAIFunction());

        if (_options.EnableReadFileTool)
            tools.Add(new ReadFileTool(_stateProvider).ToAIFunction());

        if (_options.EnableListDirectoryTool)
            tools.Add(new ListDirectoryTool(_loader, _stateProvider).ToAIFunction());

        // éè¦æ¾å¼å¯ç¨çé«å±å·¥å·
        if (_options.EnableExecuteScriptTool)
            tools.Add(new ExecuteScriptTool(_stateProvider, _options).ToAIFunction());

        if (_options.EnableRunCommandTool &amp;&amp; _options.AllowedCommands.Count &gt; 0)
            tools.Add(new RunCommandTool(_stateProvider, _options).ToAIFunction());

        return tools;
    }
}
</code></pre>
<p><strong>åç½®å·¥å·</strong>ï¼</p>
<table>
<thead>
<tr>
<th>å·¥å·å</th>
<th>åè½</th>
<th>é»è®¤ç¶æ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>read_skill</code></td>
<td>è¯»å SKILL.md å®æ´åå®¹</td>
<td>â å¯ç¨</td>
</tr>
<tr>
<td><code>read_skill_file</code></td>
<td>è¯»åæè½ç®å½ä¸­çæä»¶</td>
<td>â å¯ç¨</td>
</tr>
<tr>
<td><code>list_skill_directory</code></td>
<td>ååºæè½ç®å½åå®¹</td>
<td>â å¯ç¨</td>
</tr>
<tr>
<td><code>execute_skill_script</code></td>
<td>æ§è¡æè½ä¸­çèæ¬</td>
<td>â ç¦ç¨</td>
</tr>
<tr>
<td><code>run_skill_command</code></td>
<td>è¿è¡ç½ååå½ä»¤</td>
<td>â ç¦ç¨</td>
</tr>
</tbody>
</table>
<p><strong>å·¥å·åå»ºå³ç­æµç¨</strong>ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/577140/202601/577140-20260105114838189-800056356.png" alt="" loading="lazy"></p>
<h3 id="5-chatclientextensions---ä¾¿æ·æ©å±æ¹æ³">5. ChatClientExtensions - ä¾¿æ·æ©å±æ¹æ³</h3>
<p>ä¸ºäºç®åä½¿ç¨ï¼é¡¹ç®æä¾äº <code>ChatClient</code> çæ©å±æ¹æ³ï¼</p>
<pre><code class="language-csharp">public static class ChatClientExtensions
{
    public static AIAgent CreateSkillsAgent(
        this IChatClient chatClient,
        Action&lt;SkillsOptions&gt;? configureSkills = null,
        Action&lt;ChatClientAgentOptions&gt;? configureAgent = null)
    {
        var skillsOptions = new SkillsOptions();
        configureSkills?.Invoke(skillsOptions);

        var agentOptions = new ChatClientAgentOptions
        {
            AIContextProviderFactory = ctx =&gt;
            {
                // æ£æ¥æ¯å¦ä»åºååç¶ææ¢å¤
                if (ctx.SerializedState.ValueKind != JsonValueKind.Undefined)
                {
                    return new SkillsContextProvider(
                        chatClient,
                        ctx.SerializedState,
                        ctx.JsonSerializerOptions);
                }

                // åå»ºæ°å®ä¾
                return new SkillsContextProvider(chatClient, skillsOptions);
            }
        };

        configureAgent?.Invoke(agentOptions);
        return chatClient.CreateAIAgent(agentOptions);
    }
}
</code></pre>
<hr>
<h2 id="å®ç°ç»è">å®ç°ç»è</h2>
<h3 id="agent-è°ç¨å®æ´æµç¨">Agent è°ç¨å®æ´æµç¨</h3>
<p>ä»¥ä¸æ¯ Agent æ§è¡ä»»å¡æ¶çå®æ´è°ç¨æµç¨ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/577140/202601/577140-20260105114837850-1773548166.png" alt="" loading="lazy"></p>
<h3 id="1-æè½ç³»ç»æç¤ºçæ">1. æè½ç³»ç»æç¤ºçæ</h3>
<p>æè½ä¿¡æ¯éè¿ç³»ç»æç¤ºæ³¨å¥å° Agent ä¸­ãç³»ç»æç¤ºéç¨æ¸è¿å¼æ«é²çè®¾è®¡ï¼</p>
<pre><code class="language-csharp">public static class SkillsPromptTemplates
{
    public const string SystemPromptTemplate = """
        ## Skills System

        You have access to a skills library that provides specialized capabilities.

        {skills_locations}

        **Available Skills:**

        {skills_list}

        ---

        ### How to Use Skills (Progressive Disclosure) - CRITICAL

        Skills follow a **progressive disclosure** pattern - you know they exist 
        (name + description above), but you **MUST read the full instructions 
        before using them**.

        **MANDATORY Workflow:**

        1. **Recognize when a skill applies**: Check if the user's task matches 
           any skill's description above
        2. **Read the skill's full instructions FIRST**: Use `read_skill` tool 
           to get the complete SKILL.md content
        3. **Follow the skill's instructions precisely**: SKILL.md contains 
           step-by-step workflows and examples
        4. **Execute scripts only after reading**: Use the exact script paths 
           and argument formats from SKILL.md

        **IMPORTANT RULES:**

        â ï¸ **NEVER call `execute_skill_script` without first reading the skill 
           with `read_skill`**
        
        â **Correct Workflow Example:**
        ```
        User: "Split this PDF into pages"
        1. Recognize: "split-pdf" skill matches this task
        2. Call: read_skill("split-pdf") â Get full instructions
        3. Learn: SKILL.md shows the actual script path and argument format
        4. Execute: Use the exact command format from SKILL.md
        ```

        Remember: **Read first, then execute.** This ensures you use skills correctly!
        """;
}
</code></pre>
<h3 id="2-æè½ç¶æç®¡ç">2. æè½ç¶æç®¡ç</h3>
<p>æè½ç¶æéè¿ <code>SkillsState</code> ç±»ç®¡çï¼æ¯æåºååï¼</p>
<pre><code class="language-csharp">public sealed class SkillsState
{
    public IReadOnlyList&lt;SkillMetadata&gt; UserSkills { get; init; } = [];
    public IReadOnlyList&lt;SkillMetadata&gt; ProjectSkills { get; init; } = [];
    public DateTimeOffset LastRefreshed { get; init; }

    /// &lt;summary&gt;
    /// è·åæææè½ï¼é¡¹ç®çº§æè½ä¼åçº§æ´é«
    /// &lt;/summary&gt;
    public IReadOnlyList&lt;SkillMetadata&gt; AllSkills
    {
        get
        {
            var projectSkillNames = ProjectSkills
                .Select(s =&gt; s.Name)
                .ToHashSet(StringComparer.OrdinalIgnoreCase);
            
            var userSkillsWithoutOverrides = UserSkills
                .Where(s =&gt; !projectSkillNames.Contains(s.Name));
            
            return [.. ProjectSkills, .. userSkillsWithoutOverrides];
        }
    }

    public SkillMetadata? GetSkill(string name)
    {
        return ProjectSkills.FirstOrDefault(s =&gt; 
                s.Name.Equals(name, StringComparison.OrdinalIgnoreCase))
            ?? UserSkills.FirstOrDefault(s =&gt; 
                s.Name.Equals(name, StringComparison.OrdinalIgnoreCase));
    }
}
</code></pre>
<h3 id="3-è·¯å¾å®å¨éªè¯">3. è·¯å¾å®å¨éªè¯</h3>
<p>æææä»¶æä½é½ç»è¿ä¸¥æ ¼çè·¯å¾å®å¨éªè¯ï¼</p>
<pre><code class="language-csharp">public static class PathSecurity
{
    /// &lt;summary&gt;
    /// è§£æå®å¨è·¯å¾ï¼é²æ­¢è·¯å¾éåæ»å»
    /// &lt;/summary&gt;
    public static string? ResolveSafePath(string basePath, string relativePath)
    {
        var fullPath = Path.GetFullPath(Path.Combine(basePath, relativePath));
        var normalizedBase = Path.GetFullPath(basePath);

        // ç¡®ä¿è§£æåçè·¯å¾ä»å¨åºç¡è·¯å¾å
        if (!fullPath.StartsWith(normalizedBase, StringComparison.OrdinalIgnoreCase))
            return null;

        return fullPath;
    }

    /// &lt;summary&gt;
    /// æ£æ¥æ¯å¦æ¯ç¬¦å·é¾æ¥
    /// &lt;/summary&gt;
    public static bool IsSymbolicLink(string path)
    {
        var fileInfo = new FileInfo(path);
        return fileInfo.Attributes.HasFlag(FileAttributes.ReparsePoint);
    }

    /// &lt;summary&gt;
    /// éªè¯è·¯å¾æ¯å¦å®å¨
    /// &lt;/summary&gt;
    public static bool IsPathSafe(string targetPath, string allowedBasePath)
    {
        var normalizedTarget = Path.GetFullPath(targetPath);
        var normalizedBase = Path.GetFullPath(allowedBasePath);
        
        return normalizedTarget.StartsWith(normalizedBase, StringComparison.OrdinalIgnoreCase);
    }
}
</code></pre>
<hr>
<h2 id="ä½¿ç¨æ¹æ³">ä½¿ç¨æ¹æ³</h2>
<h3 id="åºæ¬ç¨æ³">åºæ¬ç¨æ³</h3>
<pre><code class="language-csharp">using Maf.AgentSkills.Agent;
using OpenAI;

// åå»º ChatClient
var chatClient = new OpenAIClient(apiKey)
    .GetChatClient("gpt-4")
    .AsIChatClient();

// åå»ºæ¯ææè½ç Agent
var agent = chatClient.CreateSkillsAgent(
    configureSkills: options =&gt;
    {
        options.AgentName = "my-assistant";
        options.ProjectRoot = Directory.GetCurrentDirectory();
    },
    configureAgent: options =&gt;
    {
        options.ChatOptions = new() 
        { 
            Instructions = "You are a helpful assistant." 
        };
    });

// ä½¿ç¨ Agent
var thread = agent.GetNewThread();
var response = await agent.RunAsync("What skills do you have?", thread);
Console.WriteLine(response.Text);
</code></pre>
<h3 id="çº¿ç¨åºåå">çº¿ç¨åºåå</h3>
<p>æè½ç¶æå¯ä»¥éçº¿ç¨ä¸èµ·åºååï¼æ¯ææä¹åä¼è¯ï¼</p>
<pre><code class="language-csharp">// åºååçº¿ç¨
var serializedThread = thread.Serialize();

// ä¿å­å°æ°æ®åºææä»¶
await SaveThreadAsync(userId, serializedThread);

// ç¨åæ¢å¤å¹¶ç»§ç»­å¯¹è¯
var restoredThread = agent.DeserializeThread(serializedThread);
var response = await agent.RunAsync("Continue our chat", restoredThread);
</code></pre>
<p><strong>åºåå/ååºååæµç¨</strong>ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/577140/202601/577140-20260105114837994-620347996.png" alt="" loading="lazy"></p>
<h3 id="ä¾èµæ³¨å¥éæ">ä¾èµæ³¨å¥éæ</h3>
<pre><code class="language-csharp">var builder = Host.CreateApplicationBuilder(args);

// æ³¨å ChatClient
builder.Services.AddChatClient(sp =&gt;
{
    return new OpenAIClient(apiKey)
        .GetChatClient("gpt-4")
        .AsIChatClient();
});

// æ³¨åæè½ Agent
builder.Services.AddSingleton&lt;AIAgent&gt;(sp =&gt;
{
    var chatClient = sp.GetRequiredService&lt;IChatClient&gt;();
    
    return chatClient.CreateSkillsAgent(
        configureSkills: options =&gt;
        {
            options.AgentName = "di-agent";
            options.ProjectRoot = Directory.GetCurrentDirectory();
            
            options.ToolsOptions.EnableReadSkillTool = true;
            options.ToolsOptions.EnableReadFileTool = true;
        });
});

var host = builder.Build();
var agent = host.Services.GetRequiredService&lt;AIAgent&gt;();

var thread = agent.GetNewThread();

var path = "E:\\GitHub\\My\\dotnet-agent-skills\\NET+AIï¼ææ¯æ å¨æ¯è§£å¯.pdf";
var response = await agent.RunAsync($"è¯·å°æå®ç®å½ï¼{path}çæä»¶æåå3é¡µ", thread);
</code></pre>
<h3 id="å¯ç¨èæ¬æ§è¡">å¯ç¨èæ¬æ§è¡</h3>
<pre><code class="language-csharp">var agent = chatClient.CreateSkillsAgent(
    configureSkills: options =&gt;
    {
        options.AgentName = "power-assistant";
        options.ProjectRoot = Directory.GetCurrentDirectory();
        
        // å¯ç¨èæ¬æ§è¡ï¼éè¦æ¾å¼å¼å¯ï¼
        options.ToolsOptions.EnableExecuteScriptTool = true;
        options.ToolsOptions.AllowedScriptExtensions = [".py", ".ps1", ".cs"];
        options.ToolsOptions.ScriptTimeoutSeconds = 60;
        
        // å¯ç¨å½ä»¤æ§è¡ï¼ç½ååæ¨¡å¼ï¼
        options.ToolsOptions.EnableRunCommandTool = true;
        options.ToolsOptions.AllowedCommands = ["git", "npm", "dotnet"];
    });
</code></pre>
<hr>
<h2 id="å®å¨èé">å®å¨èé</h2>
<h3 id="1-é»è®¤å®å¨">1. é»è®¤å®å¨</h3>
<p>é¡¹ç®éµå¾ª"é»è®¤å®å¨"ååï¼</p>
<ul>
<li><strong>èæ¬æ§è¡é»è®¤ç¦ç¨</strong>ï¼<code>EnableExecuteScriptTool = false</code></li>
<li><strong>å½ä»¤æ§è¡é»è®¤ç¦ç¨</strong>ï¼<code>EnableRunCommandTool = false</code></li>
<li><strong>åªè¯»å·¥å·é»è®¤å¯ç¨</strong>ï¼<code>ReadSkill</code>, <code>ReadFile</code>, <code>ListDirectory</code></li>
</ul>
<h3 id="2-è·¯å¾éåé²æ¤">2. è·¯å¾éåé²æ¤</h3>
<p>æææä»¶æä½é½éå¶å¨æè½ç®å½åï¼</p>
<pre><code class="language-csharp">// è¯»åæä»¶æ¶éªè¯è·¯å¾
var safePath = PathSecurity.ResolveSafePath(skill.Path, relativePath);
if (safePath is null)
{
    return JsonSerializer.Serialize(new
    {
        success = false,
        error = "Path traversal attempt detected"
    });
}
</code></pre>
<h3 id="3-èæ¬æ§è¡ç½åå">3. èæ¬æ§è¡ç½åå</h3>
<p>å³ä½¿å¯ç¨äºèæ¬æ§è¡ï¼ä¹åªåè®¸ç¹å®æ©å±åï¼</p>
<pre><code class="language-csharp">public class SkillsToolsOptions
{
    public List&lt;string&gt; AllowedScriptExtensions { get; set; } = [".py", ".ps1", ".sh", ".cs"];
    public int ScriptTimeoutSeconds { get; set; } = 30;
    public int MaxOutputSizeBytes { get; set; } = 50 * 1024; // 50KB
}
</code></pre>
<h3 id="4-å½ä»¤æ§è¡ç½åå">4. å½ä»¤æ§è¡ç½åå</h3>
<p>å½ä»¤æ§è¡éç¨ä¸¥æ ¼çç½ååæºå¶ï¼</p>
<pre><code class="language-csharp">options.AllowedCommands = ["git", "npm", "dotnet"]; // åªåè®¸è¿äºå½ä»¤
</code></pre>
<hr>
<h2 id="æä½³å®è·µ">æä½³å®è·µ</h2>
<h3 id="1-æè½è®¾è®¡åå">1. æè½è®¾è®¡åå</h3>
<ul>
<li><strong>åä¸èè´£</strong>ï¼æ¯ä¸ªæè½ä¸æ³¨äºä¸ä¸ªé¢å</li>
<li><strong>æ¸æ°æè¿°</strong>ï¼description å­æ®µè¦è¶³å¤æè¿°æè½ç¨é</li>
<li><strong>è¯¦ç»æä»¤</strong>ï¼SKILL.md æ­£æè¦åå«å®æ´çä½¿ç¨è¯´æ</li>
<li><strong>ç¤ºä¾é©±å¨</strong>ï¼æä¾å·ä½çä½¿ç¨ç¤ºä¾</li>
</ul>
<h3 id="2-ç®å½ç»ç»">2. ç®å½ç»ç»</h3>
<pre><code># æ¨èçæè½ç®å½ç»æ
my-skill/
âââ SKILL.md              # å¿éï¼æè½å®ä¹æä»¶
âââ README.md             # å¯éï¼è¯¦ç»ææ¡£
âââ scripts/              # èæ¬æä»¶
â   âââ main.py
â   âââ utils.py
âââ templates/            # æ¨¡æ¿æä»¶
â   âââ output.md
âââ config/               # éç½®æä»¶
    âââ settings.json
</code></pre>
<h3 id="3-skillmd-ç¼åè§è">3. SKILL.md ç¼åè§è</h3>
<pre><code class="language-markdown">---
name: my-skill
description: Brief description under 1024 characters
license: MIT
allowed-tools: web_search file_write
---

# Skill Name

## Overview
Clear explanation of what this skill does.

## When to Use
- Situation 1
- Situation 2

## Prerequisites
- Required tools or dependencies

## Instructions
Step-by-step workflow:

1. First step
2. Second step
3. Third step

## Available Scripts

### script.py
- **Purpose**: What it does
- **Arguments**: `--input &lt;file&gt; --output &lt;file&gt;`
- **Example**: `python script.py --input data.csv --output result.json`

## Examples

### Example 1: Basic Usage
...
</code></pre>
<h3 id="4-é¡¹ç®çº§-vs-ç¨æ·çº§æè½">4. é¡¹ç®çº§ vs ç¨æ·çº§æè½</h3>
<ul>
<li><strong>ç¨æ·çº§æè½</strong> (<code>~/.maf/{agent}/skills/</code>)ï¼éç¨æè½ï¼éç¨äºå¤ä¸ªé¡¹ç®</li>
<li><strong>é¡¹ç®çº§æè½</strong> (<code>{project}/.maf/skills/</code>)ï¼é¡¹ç®ç¹å®æè½ï¼å¯è¦çååç¨æ·çº§æè½</li>
</ul>
<hr>
<h2 id="æ»ç»">æ»ç»</h2>
<p>Maf.AgentSkills é¡¹ç®å±ç¤ºäºå¦ä½åºäº Microsoft Agent Framework å®ç° Agent Skills éæã</p>
<p><strong>æ ¸å¿è®¾è®¡è¦ç¹</strong>ï¼</p>
<ol>
<li><strong>éµå¾ª MAF æ¨¡å¼</strong>ï¼ä½¿ç¨ <code>AIContextProviderFactory</code> å®ç°æ ä¾µå¥å¼éæ</li>
<li><strong>æ¸è¿å¼æ«é²</strong>ï¼éè¿ä¸å±ç»æï¼åæ°æ® â æä»¤ â èµæºï¼ä¼å Token ä½¿ç¨</li>
<li><strong>å®å¨ç¬¬ä¸</strong>ï¼é»è®¤ç¦ç¨å±é©æä½ï¼éç¨ç½ååæºå¶</li>
<li><strong>çº¿ç¨åºåå</strong>ï¼å®æ´æ¯æä¼è¯æä¹å</li>
<li><strong>ä¾èµæ³¨å¥åå¥½</strong>ï¼æäºéæå°ç°æåºç¨</li>
</ol>
<p>éè¿è¿å¥å®ç°ï¼å¼åèå¯ä»¥è½»æ¾ä¸º AI Agent æ·»å å¯å¤ç¨çä¸ä¸æè½ï¼ä½¿ Agent è½å¤å®ææ´å¤æçä»»å¡ã</p>
<hr>
<h2 id="åèèµæ">åèèµæ</h2>
<ul>
<li><a href="https://agentskills.io" target="_blank" rel="noopener nofollow">Agent Skills è§è</a></li>
<li><a href="https://github.com/microsoft/agent-framework" target="_blank" rel="noopener nofollow">Microsoft Agent Framework</a></li>
<li><a href="https://github.com/dotnet/extensions" target="_blank" rel="noopener nofollow">Microsoft.Extensions.AI</a></li>
</ul>
<hr>

</div>
<div id="MySignature" role="contentinfo">
    <div style="display: block; border: 2px solid #6ecaa8; padding: 10px; background: aliceblue">  
<img src="https://files.cnblogs.com/files/sheng-jie/maf-course-card-scan.bmp">
<blockquote>
<b>ðé¢å.NETå¼åèçAI Agent å¼åè¯¾ç¨ã.NET+AI | æºè½ä½å¼åè¿é¶ãå·²ä¸çº¿ï¼æ¬¢è¿æ«ç å å¥å­¦ä¹ ãð</b>
</blockquote>
</div>

<img src="https://files.cnblogs.com/files/sheng-jie/scan-follow.bmp">
<blockquote>
<b>
å³æ³¨æçå¬ä¼å·ãå AI èè¡ãï¼æä»¬å¾®ä¿¡ä¸è§ä¸æ£ã
<br>
éç½¢æ­¤æï¼å¦ææ¨è§å¾æ¬æä¸éå¹¶æææ¶è·ï¼è¯·ãæèµãæãæ¨èãï¼ä¹å¯ãè¯è®ºãçä¸æ¨çé®é¢æå»ºè®®ä¸æäº¤æµã

ä½ çæ¯ææ¯æä¸æ­åä½ååäº«çä¸ç«­å¨åï¼</b>
</blockquote>

<div style="display: block; border: 2px solid #6ecaa8; padding: 10px; background: aliceblue" id="AllanboltSignature">    
        <div>ä½èï¼<a href="http://www.jianshu.com/u/39ec0e6b1844" target="_blank">ãå£æ°ã</a></div>
        <div>åºå¤ï¼<a href="http://www.cnblogs.com/sheng-jie/" target="_blank">http://www.cnblogs.com/sheng-jie/</a></div>
        <div>æ¬æçæå½ä½èååå®¢å­å±æï¼æ¬¢è¿è½¬è½½ï¼ä½æªç»ä½èåæå¿é¡»ä¿çæ­¤æ®µå£°æï¼ä¸å¨æç« é¡µé¢ææ¾ä½ç½®ç»åºåæé¾æ¥ï¼å¦åä¿çè¿½ç©¶æ³å¾è´£ä»»çæå©ã</div>  
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-05 11:50">2026-01-05 11:50</span>&nbsp;
<a href="https://www.cnblogs.com/sheng-jie">ãå£æ°ã</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19442149);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19442149', targetLink: 'https://www.cnblogs.com/sheng-jie/p/19442149', title: '.NET+AI | åºäº Microsoft Agent Framework ä¸æ­¥æ­¥éæ Agent Skillsï¼è®©ä½ ç AI Agent æ´æºè½' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ åºäºopenspec-cnçSDDè§èé©±å¨å¼åå®æ ]]></title>
    <link>https://www.cnblogs.com/shiningrise/p/19441876</link>
    <guid>286a14a86a6e0180b76e1276b5c71b09</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/shiningrise/p/19441876" title="åå¸äº 2026-01-05 11:12">
    <span role="heading" aria-level="2">åºäºopenspec-cnçSDDè§èé©±å¨å¼åå®æ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="è§èé©±å¨å¼å-ç®åä»ç»">è§èé©±å¨å¼å ç®åä»ç»</h2>
<p>è§èé©±å¨å¼åï¼Specification Driven Developmentï¼ç®ç§° SDD æ SpecDDï¼æ¯ä¸ç§ä»¥è§èä¸ºæ ¸å¿çè½¯ä»¶å·¥ç¨æ¹æ³ï¼æ¢åå«ä¼ ç»ææ·å¼åè¡çåºçæ··ååæ¨¡å¼ï¼ä¹åå±åºéé AI æ¶ä»£çæ°åå¼åèå¼ï¼æ ¸å¿æ¯è®©è§èæä¸ºå¼åå¨æµç¨çæ ¸å¿æå¼ä¸æ§è¡ä¾æ®</p>
<h1 id="æ°å»ºé¡¹ç®äºç»´ç çæå¨è±æåqrcodecreator">æ°å»ºé¡¹ç®ï¼äºç»´ç çæå¨ï¼è±æåï¼QrcodeCreatorï¼</h1>
<h2 id="æ°å»ºç®å½-qrcodecreator">æ°å»ºç®å½ QrcodeCreator</h2>
<p>å¨QrcodeCreatorç®å½æå¼cursor</p>
<h2 id="æ­¥éª¤1å¨å±å®è£cli">æ­¥éª¤1ï¼å¨å±å®è£CLI</h2>
<pre><code>npm install -g @studyzy/openspec-cn@latest
</code></pre>
<h2 id="æ­¥éª¤2å¨é¡¹ç®ä¸­åå§åopenspec">æ­¥éª¤2ï¼å¨é¡¹ç®ä¸­åå§åOpenSpec</h2>
<pre><code>openspec-cn init
</code></pre>
<p>éæ©cursorç¼è¾å¨</p>
<p><img src="https://wxy-blog.oss-cn-hangzhou.aliyuncs.com/wxy-blog/2025/20260105101011477.png" alt="" loading="lazy"></p>
<p>çæå¦ä¸ç®å½ç»æï¼</p>
<p><img src="https://wxy-blog.oss-cn-hangzhou.aliyuncs.com/wxy-blog/2026/20260105101532472.png" alt="" loading="lazy"></p>
<p>å¤å¶ä»¥ä¸åå®¹å°cursorå¯¹è¯æ¡</p>
<pre><code>1. å¡«åæ¨çé¡¹ç®ä¸ä¸æï¼
   "è¯·éè¯» openspec/project.md å¹¶å¸®æå¡«å
    æçé¡¹ç®è¯¦æãææ¯æ åçº¦å®è§è"
</code></pre>
<p>ä¿®æ¹ï¼project.md</p>
<p><img src="https://wxy-blog.oss-cn-hangzhou.aliyuncs.com/wxy-blog/2026/20260105105705596.png" alt="" loading="lazy"></p>
<h2 id="æ°å»ºææ¡">æ°å»ºææ¡</h2>
<pre><code>AIå¯¹è¯æ¡ï¼æï¼ææ³åå»ºä¸ä¸ªè§èææ¡:æ°å¢ä¸å¼ htmlé¡µé¢,æ ¹æ®è¾å¥çç½åçæäºç»´ç 
</code></pre>
<p>çæå¦ä¸æä»¶</p>
<p><img src="https://wxy-blog.oss-cn-hangzhou.aliyuncs.com/wxy-blog/2026/20260105102929047.png" alt="" loading="lazy"></p>
<pre><code>ä¿®æ¹ææ¡ï¼add-url-qrcode-generator  ä¸ä½¿ç¨pythonï¼ä»ä½¿ç¨html+javascriptå®ç°qrcodeçæåè½
</code></pre>
<h2 id="çæä»£ç ">çæä»£ç </h2>
<pre><code>è¾å¥å½ä»¤/openspec-apply çæä»£ç 
</code></pre>
<h2 id="å½æ¡£">å½æ¡£</h2>
<pre><code>/openspec-archive add-url-qrcode-generator
</code></pre>
<h2 id="å®æåçé¡¹ç®ç»æ">å®æåçé¡¹ç®ç»æ</h2>
<p><img src="https://wxy-blog.oss-cn-hangzhou.aliyuncs.com/wxy-blog/2026/20260105110141451.png" alt="" loading="lazy"></p>
<p>ä½¿ç¨æµè§å¨æå¼index.html</p>
<p><img src="https://wxy-blog.oss-cn-hangzhou.aliyuncs.com/wxy-blog/2026/20260105110229694.png" alt="" loading="lazy"></p>
<h1 id="openspec-cné¡¹ç®ç½å">openspec-cné¡¹ç®ç½å</h1>
<p><a href="https://github.com/studyzy/OpenSpec-cn" target="_blank" rel="noopener nofollow">studyzy/OpenSpec-cn: OpenSpecæ±åç</a></p>
<p>é¡¹ç®å®æå±ç¤ºç½åï¼<br>
<a href="https://qrcode.wxy.vip/" target="_blank" rel="noopener nofollow">https://qrcode.wxy.vip/</a></p>

</div>
<div id="MySignature" role="contentinfo">
    æ¬¢è¿åä¸´:<font size="3"><font size="3"><a href="http://shiningrise.cnblogs.com/" target="_blank"><font size="3"><font size="3">http://shiningrise.cnblogs.com</font></font></a><br><br></font></font>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.005555555555555556" data-date-updated="2026-01-05 11:20">2026-01-05 11:12</span>&nbsp;
<a href="https://www.cnblogs.com/shiningrise">shiningrise</a>&nbsp;
éè¯»(<span id="post_view_count">10</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19441876);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19441876', targetLink: 'https://www.cnblogs.com/shiningrise/p/19441876', title: 'åºäºopenspec-cnçSDDè§èé©±å¨å¼åå®æ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä»æå¨å°èªå¨ï¼åºäº Mutating Admission Webhook å®ç° Envoy Sidecar èªå¨æ³¨å¥ ]]></title>
    <link>https://www.cnblogs.com/MrVolleyball/p/19441540</link>
    <guid>73b40b5324350ff8763e5854c4016782</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/MrVolleyball/p/19441540" title="åå¸äº 2026-01-05 11:04">
    <span role="heading" aria-level="2">ä»æå¨å°èªå¨ï¼åºäº Mutating Admission Webhook å®ç° Envoy Sidecar èªå¨æ³¨å¥</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        å¨å¾®æå¡è§æ¨¡ä¸æ­æ©å¤§çåºæ¯ä¸ï¼æå¨ä¸ºæ¯ä¸ª Pod æ³¨å¥ Envoy Sidecar å·²ç»é¾ä»¥ç»´æ¤ãæ¬æä»å®éå·¥ç¨é®é¢åºåï¼è¯¦ç»è®²è§£å¦ä½å©ç¨ Kubernetes ç Mutating Admission Webhook æºå¶ï¼å®ç° Envoy Sidecar çèªå¨æ³¨å¥ãåå®¹æ¶µçè¯ä¹¦çæãWebhook éç½®ãæ³¨å¥æå¡å®ç°ï¼ä»¥ååºäº Namespace / Pod Label çç²¾ç»åæ³¨å¥æ§å¶
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="åè¨">åè¨</h2>
<p>ä¸ä¸å°èæä»¬è¯¦ç»è®¨è®ºäºå¦ä½åæµéå«æï¼å¹¶ä¸ä½¿ç¨initContainersæ¥åèªå¨å«æçéç½®ãä½æ¯ç®åè¿æä¸ä¸ªé®é¢ï¼å¦ææä»¬çç³»ç»æå¥½å ç¾ä¸ªå¾®æå¡ï¼é£ä½ä¸ºéè¦çä»£çenvoyï¼æ¯æå¨æ³¨å¥çï¼é¾éæ¯ä¸ªå¾®æå¡é½è¦æå¨ç¼è¾ä¸æ¬¡ ï¼è¿æ¾ç¶æ¯ä¸å¯æ¿åçï¼æä»¥è¿ä¸èï¼æä»¬æ¥è¯¦ç»è®¨è®ºä¸ä¸èªå¨æ³¨å¥çé®é¢</p>
<h2 id="ç¯å¢åå¤">ç¯å¢åå¤</h2>
<p>ç±äºæ¬èåªè®¨è®ºå®¹å¨æ³¨å¥ï¼æä»¥åªéè¦åå¤ä¸ä¸ªæ®éçdeploymentå°±è¡äº</p>
<pre><code>apiVersion: apps/v1
kind: Deployment
metadata:
  name: backend
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      app: backend
  template:
    metadata:
      labels:
        app: backend
    spec:
      containers:
      - image: backend-service:v1
        imagePullPolicy: Never
        name: backend
        ports:
        - containerPort: 10000
          protocol: TCP
        resources: {}
      restartPolicy: Always
</code></pre>
<h2 id="mutating-admission-webhooks">mutating admission webhooks</h2>
<p><img alt="auto_injection_1" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1416773/202601/1416773-20260105102513029-709020086.png" class="lazyload"></p>
<p>ç®åæ¥è¯´ï¼å°±æ¯å½podéå¯çæ¶åï¼ä¼åèµ·ä¸ç³»åçè¿ç¨ï¼å¶ä¸­å¨mutating admission controller è¿éï¼k8sæä¾äºä¸ä¸ªwebhooksï¼å¯ä»¥åè°å°æå®çå°æ¹å»ï¼æä»¥æä»¬éè¦åå»ºä¸ä¸ªserveræ¥å¤çè¯¥åè°ï¼æ·»å ä¸ä¸ªå®¹å¨è¿å»ï¼å®æå®¹å¨æ³¨å¥çå·¥ä½</p>
<h4 id="åå»ºç¸å³è¯ä¹¦">åå»ºç¸å³è¯ä¹¦</h4>
<pre><code>cd /etc/kubernetes/pki
</code></pre>
<p>åå»ºopenssl.cnf</p>
<pre><code>[ req ]
distinguished_name = req_distinguished_name
req_extensions = v3_req
prompt = no

[ req_distinguished_name ]
CN = sidecar-webhook.default.svc

[ v3_req ]
keyUsage = keyEncipherment, dataEncipherment
extendedKeyUsage = serverAuth
subjectAltName = @alt_names

[ alt_names ]
DNS.1 = sidecar-webhook
DNS.2 = sidecar-webhook.default
DNS.3 = sidecar-webhook.default.svc

</code></pre>
<p>ä»k8sæ ¹è¯ä¹¦ä¸­åå»ºè¯ä¹¦</p>
<pre><code>sudo openssl req -x509 -newkey rsa:2048 \
  -keyout tls.key \
  -out tls.crt \
  -days 365 -nodes \
  -config openssl.cnf \
  -extensions v3_req
</code></pre>
<h4 id="åå»ºmutatingwebhookconfiguration">åå»ºMutatingWebhookConfiguration</h4>
<pre><code>mytls=`cat tls.crt | base64 | tr -d '\n'`

echo 'apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: sidecar-injector
webhooks:
- name: sidecar.demo.io
  clientConfig:
    service:
      name: sidecar-webhook
      namespace: default
      path: /mutate
    caBundle: '$mytls'
  rules:
  - apiGroups: [""]
    apiVersions: ["v1"]
    operations: ["CREATE"]
    resources: ["pods"]
  admissionReviewVersions: ["v1"]
  sideEffects: None' | kubectl apply -f -

</code></pre>
<h4 id="åå»ºæå¡æ¥æ¥æ¶webhook">åå»ºæå¡æ¥æ¥æ¶webhook</h4>
<p><a href="https://github.com/wilsonchai8/myblog/blob/main/micro_service/injection/inject.go" target="_blank" rel="noopener nofollow">èªå¨æ³¨å¥æå¡</a></p>
<p>è¿æ²¡ä»ä¹å¯è¯´çï¼éè¦æ³¨æçå°±æ¯æ³¨å¥podçéç½®ç´æ¥åå¨äºä»£ç éé¢ï¼å¹¶ä¸æ³¨å¥äº2ä¸ªé¨åï¼é¦åæ¯sidecar containerï¼å¶æ¬¡æ¯sidecarçvolumeséç½®ï¼podçº§å«çï¼</p>
<pre><code>        patch := []map[string]interface{}{
                {
                        "op":   "add",
                        "path": "/spec/containers/-",
                        "value": map[string]interface{}{
                                "image":           "registry.cn-beijing.aliyuncs.com/wilsonchai/envoy:v1.32-latest",
                                "imagePullPolicy": "IfNotPresent",
                                "name":            "envoy",
                                "args":            []string{"-c", "/etc/envoy/envoy.yaml"},
                                "volumeMounts": []map[string]interface{}{
                                        {
                                                "mountPath": "/etc/envoy",
                                                "name":      "envoy-config",
                                        },
                                },
                        },
                },
                {
                        "op":   "add",
                        "path": "/spec/volumes/-",
                        "value": map[string]interface{}{
                                "configMap": map[string]interface{}{
                                        "defaultMode": 420,
                                        "name":        "envoy-config",
                                },
                                "name": "envoy-config",
                        },
                },
        }

</code></pre>
<pre><code>â¶ go run inject.go
2025/12/29 14:58:19 Webhook listening on :8443

</code></pre>
<p>æå¼8443ç«¯å£ä»¥ä¾¿æ¥æ¶è¯·æ±</p>
<h4 id="åå»ºè®¿é®è·¯å¾">åå»ºè®¿é®è·¯å¾</h4>
<p>æä»¬çæå¡å¨éç¾¤å¤ï¼æä»¥åå»ºä¸ä¸ªendpointæåéç¾¤ä¹å¤</p>
<pre><code>echo 'apiVersion: v1
kind: Service
metadata:
  name: sidecar-webhook
spec:
  ports:
  - port: 443
    targetPort: 8443
    protocol: TCP
  type: ClusterIP

---

apiVersion: v1
kind: Endpoints
metadata:
  name: sidecar-webhook
  namespace: default
subsets:
- addresses:
  - ip: 10.22.12.178
  ports:
  - port: 8443
    protocol: TCP' | kubectl apply -f -
</code></pre>
<h4 id="éªè¯">éªè¯</h4>
<p>éå¯backendæå¡ï¼<code>kubectl rollout restart deploy backend</code></p>
<pre><code>cannot bind '0.0.0.0:10000': Address already in use

</code></pre>
<p>åºç°äºæ¥éï¼è¿åºè¯¥æ¯ç±äºenvoyæ¯çå¬10000ç«¯å£ï¼backendæå¡çå¬çä¹æ¯10000ç«¯å£ï¼ç°å¨å®ä»¬å¨ä¸ä¸ªnet namespaceï¼å°±è¯å®è¦æ¥éäºï¼æä»¥æ¹ä¸ä¸envoyçéç½®ï¼çå¬å¦å¤ä¸ä¸ªç«¯å£å§ï¼10000æ¹æ10001</p>
<pre><code>      listeners:
        - name: ingress_listener
          address:
            socket_address:
              address: 0.0.0.0
              port_value: 10001
</code></pre>
<p>åæ¬¡éå¯æ¥çpodç¶æ</p>
<pre><code>â¶ kubectl get pod -owide -l app=backend
NAME                       READY   STATUS    RESTARTS   AGE    IP             NODE     NOMINATED NODE   READINESS GATES
backend-6bdf5d484b-5czgx   2/2     Running   0          100s   10.244.0.184   wilson   &lt;none&gt;           &lt;none&gt;

</code></pre>
<p>æ¥çè¯¦æ</p>
<p><img alt="auto_injection_2" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1416773/202601/1416773-20260105102617163-829810931.png" class="lazyload"></p>
<p>èªå¨æ³¨å¥äºenvoyå®¹å¨</p>
<p>è³æ­¤ï¼æ¶æå¾å¦ä¸ï¼</p>
<p><img alt="auto_injection_3" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1416773/202601/1416773-20260105102624936-2006056597.png" class="lazyload"></p>
<h2 id="ç²¾ç»åæ³¨å¥">ç²¾ç»åæ³¨å¥</h2>
<p>æç§ç®åçéç½®ï¼åªè¦æpod createï¼å°±ç«å»åè°éç¾¤å¤çæ³¨å¥æå¡ï¼å¦æk8séç¾¤çæå¡å¾å¤ï¼å¹¶ä¸é¢ç¹çcreate/destroyï¼é£å°±ä¼å¯¹æ³¨å¥æå¡äº§çè¾å¤§çååãå¦æå¨è¿äºæå¡ä¸­ï¼åªæä¸äºæå¡æ¯éè¦ä½¿ç¨èªå¨æ³¨å¥åè½çï¼é£ å°±éè¦æ´ç²¾ç»åçæ³¨å¥ç®¡ç</p>
<h4 id="namespaceææ ç­¾">namespaceææ ç­¾</h4>
<p>é¦åè¦è°æ´ä¸ä¸MutatingWebhookConfiguration</p>
<pre><code>apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: sidecar-injector
webhooks:
- name: sidecar.demo.io
  namespaceSelector:
    matchLabels:
      sidecar-inject: "true"
...
</code></pre>
<p>å ä¸æ ç­¾ <code>sidecar-inject: "true"</code>ï¼åªææ»¡è¶³è¿ä¸ªæ ç­¾ï¼æä¼åè°å°å¤é¨çæ³¨å¥æå¡ï¼è¿æ ·å°±å¯ä»¥å¤§å¤§åè½»æ³¨å¥æå¡çååäº</p>
<p>åç»namespaceæä¸æ ç­¾</p>
<pre><code>kubectl label ns default sidecar-inject=true
</code></pre>
<p>default namespaceéé¢ææçpodï¼é½ä¼åè°è³å¤é¨æ³¨å¥æå¡</p>
<h4 id="pod-ææ ç­¾">pod ææ ç­¾</h4>
<p>è¿æ¬¡ä¸å¨namespaceä¸ï¼èæ¯åºäºæä¸ªpod label</p>
<pre><code>apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: sidecar-injector
webhooks:
- name: sidecar.demo.io
  objectSelector:
    matchLabels:
      sidecar-inject-pod: "true"
...
</code></pre>
<p>ç¶ååç»deploymentææ ç­¾ï¼è¿éè¦æ³¨ææçæ¯podçæ ç­¾</p>
<pre><code>kubectl patch deployment backend \
  --type='merge' \
  -p '{
    "spec": {
      "template": {
        "metadata": {
          "labels": {
            "sidecar-inject-pod": "true"
          }
        }
      }
    }
  }'
</code></pre>
<h2 id="å°ç»">å°ç»</h2>
<p>æ¬æè¯¦ç»æè¿°äºæä¹åèªå¨æ³¨å¥ï¼k8séç½®ä¿®æ¹+å¤é¨æ³¨å¥æå¡ãå¶ä¸­éè¦æ³¨å¥çpodæ¯åæ­»å¨æ³¨å¥æå¡çï¼è¿é¨åå¯ä»¥æ½åºæ¥ï¼å°éç½®åæconfigmapï¼æèå¨å¶ä»çéç½®ä¸­å¿ä¸­ï¼è¿æ ·å°±ä¸ç¨é¢ç¹çä¿®æ¹æ³¨å¥æå¡äº</p>
<p>å¦å¤mutating webhookså¯ä»¥æ¦æªå¤§é¨åk8sæ¯æçèµæºï¼å¹¶ä¸åéå°æéç½®çå¤é¨æå¡ä¸­è¿è¡éè¦çéç½®ï¼è¿å°±ä¸ååæ¯podèªå¨æ³¨å¥ï¼èæ¯èµæºæ¦æªãæ¯å¦æéè¦æ¦æªconfigmap</p>
<pre><code>echo 'apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: callback-configmap
webhooks:
- name: sidecar.demo.io
  clientConfig:
    service:
      name: sidecar-webhook
      namespace: default
      path: /mutate
    caBundle: '$mytls'
  rules:
  - apiGroups: [""]
    apiVersions: ["v1"]
    operations: ["CREATE", "UPDATE"]
    resources: ["configmaps"]
  admissionReviewVersions: ["v1"]
  sideEffects: None' | kubectl apply -f -
</code></pre>
<p>resourcesåæ´ä¸ºconfigmapä¹åï¼å°±å¯ä»¥ç´æ¥åè°å°å¤é¨æå¡ãæ¬ç« ç±äºç¯å¹æéï¼å°±ä¸å¯¹è¿ä¸ªè¯é¢å±å¼äºï¼è¿ä¸ªä»¥åæéè¦åæ¥è¯¦ç»è®¨è®º</p>
<h2 id="èç³»æ">èç³»æ</h2>
<ul>
<li>èç³»æï¼åæ·±å¥çäº¤æµ</li>
</ul>
<p><img alt="" width="500" height="200" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1416773/202411/1416773-20241121135740959-1907948957.png#" class="lazyload"></p>
<hr>
<p>è³æ­¤ï¼æ¬æç»æ<br>
å¨ä¸æçå­¦æµï¼æææ±¤æ¼æ°´çï¼è¯·åä½ä¸åèµæ...</p>

</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/MrVolleyball/" target="_blank">itæçå</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/MrVolleyball/p/19441540" target="_blank">https://www.cnblogs.com/MrVolleyball/p/19441540</a></p>
<div>æ¬æçæå½ä½èååå®¢å­å±æï¼æ¬¢è¿è½¬è½½ï¼ä½æªç»ä½èåæå¿é¡»å¨æç« é¡µé¢ç»åºåæè¿æ¥ï¼å¦åä¿çè¿½ç©¶æ³å¾è´£ä»»çæå©ã </div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-05 11:04">2026-01-05 11:04</span>&nbsp;
<a href="https://www.cnblogs.com/MrVolleyball">itæçå</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19441540);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19441540', targetLink: 'https://www.cnblogs.com/MrVolleyball/p/19441540', title: 'ä»æå¨å°èªå¨ï¼åºäº Mutating Admission Webhook å®ç° Envoy Sidecar èªå¨æ³¨å¥' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>