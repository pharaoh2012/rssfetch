<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-01-15T04:37:46.918Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ ä½ ç IP å½å±å°ï¼æ¯åè¢«æåºæ¥çï¼ ]]></title>
    <link>https://www.cnblogs.com/yupi/p/19486536</link>
    <guid>bbff8a77bdd9cbe544648f1dd8c1e745</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/yupi/p/19486536" title="åå¸äº 2026-01-15 11:41">
    <span role="heading" aria-level="2">ä½ ç IP å½å±å°ï¼æ¯åè¢«æåºæ¥çï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/2225420/202601/2225420-20260115111608009-63796805.png" alt="ä½ ç IP å½å±å°ï¼æ¯åè¢«æåºæ¥çï¼" class="desc_img">
        å¾å¤å¹³å°é½ä¼æ¾ç¤ºç¨æ· IP å½å±å°çï¼è¿å¾æ­£å¸¸ãä¸è¿ä½ ç IP å½å±å°ï¼æ¯æä¹è¢«è·åå°çï¼
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p class="md-end-block md-heading"><span class="md-plain">ä½ æ¯å°é¿å·´ï¼æ­£å¨å®¶éå·å·æ¬£èµä¸é¨å¾ç²¾å½©çåå®¹ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ ï¼å¯ï¼çä¸éå~</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372037193-016caa3d-6e15-4095-bb44-d07f8757a0a9.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372037193-016caa3d-6e15-4095-bb44-d07f8757a0a9.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä¸æ¶å´èµ·ï¼ä½ çä¸äºä¸æ¡è¯è®ºï¼ä½èçæ°ï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">ç»æåååºå»ï¼ä½ å°±åç°è¯è®ºä¸é¢ç«ç¶æ¾ç¤ºï¼<span class="md-pair-s"><code>åäº¬</code></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ å¤§æå¤±è²ï¼åï¼ä¿ºè¢«å®ä½äºï¼è¿ç½ç«å¨çæ§ä¿ºï¼ä¿ºè¦ä¸¾æ¥å®ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372054775-27081238-090f-44c8-9b2a-9598f82d4ba5.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372054775-27081238-090f-44c8-9b2a-9598f82d4ba5.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">è¿æ¶ï¼ç¨åºåé±¼ç®çªç¶åºç°å¨ä½ èº«åï¼æ¦çé¼»è¡è¯´ï¼æ·¡å®ï¼å¾å¤å¹³å°é½ä¼æ¾ç¤ºç¨æ· IP å½å±å°çï¼è¿å¾æ­£å¸¸ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ åäºä¸è·³ï¼é¢ï¼ä½ è°åï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®ï¼ææ¯å¤å¸èæç®¡ç¼ç¨çç¥â¦â¦ç²¾ï¼ä¸é¢ææ¥ç§æ®ä¸ä¸ ââ ä½ ç IP å½å±å°ï¼æ¯æä¹è¢«è·åå°çï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372090241-334885e1-97b5-4416-943b-1e0fe5151883.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372090241-334885e1-97b5-4416-943b-1e0fe5151883.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">â­ï¸ æ¬æå¯¹åºè§é¢çï¼<span class="md-meta-i-c  md-link"><a href="https://www.bilibili.com/video/BV1xCi9BJEx1/" rel="noopener nofollow"><span class="md-plain">https://bilibili.com/video/BV1xCi9BJEx1</span></a></span></span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">æä¹è·åä½ ç IP å½å±å°ï¼</span></h2>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®ï¼ä½ ä¸ç½çæ¶åï¼ä½ ççµèè¦è·æå¡å¨éä¿¡æ¥è·åç½é¡µåæ°æ®ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">å°±åå¯å¿«éä¸æ ·ï¼å¿«éåè¦æåè£¹éå°ä½ å®¶ï¼å¾ç¥éä½ å®¶çå°åãè¿ä¸ªå°åå°±æ¯ <span class="md-pair-s "><strong>IP å°å</strong><span class="md-plain">ï¼å¯ä»¥çè§£ä¸ºä½ çç½ç»é¨çå·ã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372121596-87026ac2-a25f-4ec2-aa34-ff7e1558e61f.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372121596-87026ac2-a25f-4ec2-aa34-ff7e1558e61f.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ ï¼ä½å¹³å°æ¯æä¹éè¿ IP å°åç¥éä¿ºå¨ âåäº¬â çå¢ï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®ï¼è¿å°±æ¶åå°äºèç½çç»ç»å½¢å¼äºã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä¸ºäºæ¹ä¾¿ç®¡çåè·¯ç±ï¼å¨çäºèç½è¢«ååä¸ºè®¸å¤ä¸ªå·¨å¤§çç½ç»é¢å°ï¼æä»¬ææ¯ä¸ªé¢å°å«å <span class="md-pair-s "><strong>èªæ²»ç³»ç»</strong><span class="md-plain">ï¼Autonomous Systemï¼ï¼ç®ç§° ASã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372147676-5aaa0966-c057-49a0-8904-976413769559.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372147676-5aaa0966-c057-49a0-8904-976413769559.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">è¿äº AS ä¸è¬ç±çµä¿¡ãèéè¿æ ·çè¿è¥åï¼ISPï¼ï¼æèå¤§åäºèç½å¬å¸è¿è¥ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372164004-46da66d1-f38e-4df3-8c90-43594de30bf1.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372164004-46da66d1-f38e-4df3-8c90-43594de30bf1.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">æ¯ä¸ª AS è´è´£ç®¡çä¸å¤§æ¹ IP å°åï¼å¹¶è§åæ°æ®åçä¼ è¾è·¯çº¿ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">è¿è¥åå¨æ¿å°è¿äº IP åï¼ä¼æ ¹æ®èªå·±çæºæ¿é¨ç½²ï¼æä¸åç IP å°åæ®µååç»ä¸ååå¸çç½ç»è®¾å¤ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372190013-3a4e3749-03ea-4527-811f-09222ceab6e8.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372190013-3a4e3749-03ea-4527-811f-09222ceab6e8.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä¸ºäºæ¹ä¾¿ç®¡çï¼æ¯ä¸ª AS é½æä¸ä¸ªå¨çå¯ä¸çç¼å·ï¼å« <span class="md-pair-s "><strong>ASN</strong><span class="md-plain">ï¼Autonomous System Numberï¼èªæ²»ç³»ç»ç¼å·ã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372231843-fa61be3e-9494-4daa-a6ea-53bc74c07248.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372231843-fa61be3e-9494-4daa-a6ea-53bc74c07248.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">æ¯å¦ AS4808 æ¯ä¸­å½èéåäº¬çç½ç»ï¼èéä¼æå¶ä¸­ä¸æ®µ IPï¼æ¯å¦ 123.xx.xx.0 å° 123.xx.xx.255ï¼åéç»ä»ä»¬å¨åäº¬çæ¥å¥æºæ¿ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372264641-acc9322c-c2c6-4ba4-a22a-863ab69f9263.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372264641-acc9322c-c2c6-4ba4-a22a-863ab69f9263.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ ï¼æä»¥æ³æ¥ä¿º IP çä½ç½®ï¼å³é®å°±æ¯æ¾å° ASNï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®ï¼ææ´ç®åçæ¹æ³ãå¨çæå¾å¤ä¸ä¸çæºæï¼å¦ MaxMindãIP2Locationï¼ä¸é¨æ¶éå¹¶æ±æ»äºè¿äº AS åé¨ <span class="md-pair-s "><strong>IP æ®µååå¸çæ å°å³ç³»</strong><span class="md-plain">ï¼åæäº <span class="md-pair-s "><strong>IP å°çä½ç½®æ°æ®åº</strong><span class="md-plain">ã</span></span></span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372280484-e44efc1d-a9f1-4e05-ad20-d814b032194b.png"><img data-src="https://pic.yupi.icu/1/1768372280484-e44efc1d-a9f1-4e05-ad20-d814b032194b.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">æ°æ®åºéä¼è®°å½ï¼è¿ä¸ª IP æ®µå±äº AS4808ï¼ä¸­å½èéï¼ï¼ä¸ç®ååéç»äºåäº¬å¸çæä¸ªæ¥å¥èç¹ãå°±ç¥éä½ å¤§æ¦æå±çä½ç½®äºã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372297133-f37748ea-f2d4-4657-9eeb-bcb553481dca.png"><img data-src="https://pic.yupi.icu/1/1768372297133-f37748ea-f2d4-4657-9eeb-bcb553481dca.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">æä»¬æå¼ <span class="md-meta-i-c  md-link"><a href="https://ip.sb/" rel="noopener nofollow"><span class="md-plain">è¿ä¸ªç½ç«</span></a><span class="md-plain"> æ¥ä¸ä¸ï¼å°±è½çå°ä½ å®¶ IP çå®æ´ä¿¡æ¯ï¼</span></span></span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">Addressï¼123.xx.xx.xxï¼ä½ ç IP å°åï¼</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">ISPï¼China Unicomï¼ç½ç»æå¡æä¾åï¼ä¸­å½èéï¼</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">ASNï¼AS4808ï¼èªæ²»ç³»ç»ç¼å·ï¼</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">ASN Organizationï¼China Unicomï¼ASN æå±çè¿è¥åï¼</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">Locationï¼åäº¬ ä¸­å½ï¼å°çä½ç½®ï¼</span></p>
</li>
</ul>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1766730225647-2a92cea2-c4ac-426c-b527-e18689331ba3.png"><img data-src="https://pic.yupi.icu/1/1766730225647-2a92cea2-c4ac-426c-b527-e18689331ba3.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ æ¿å¨äºï¼åï¼ä¸ç®äºç¶åï¼</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">è½å®ä½å¤ç²¾ç¡®ï¼</span></h2>
<p class="md-end-block md-p"><span class="md-plain">ä½ ç´§å¼ èµ·æ¥ï¼ç­ç­ï¼é£å¹³å°ç®¡çåå²ä¸æ¯è½é¡ºçç½çº¿æ¾å°ä¿ºå®¶é¨çå·ï¼ä¿ºè¿å°±æç½çº¿æäºï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372379305-0b1bdcb0-1bd5-4616-9ae8-baecef1da76c.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372379305-0b1bdcb0-1bd5-4616-9ae8-baecef1da76c.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®ï¼å«æï¼éè¿ IP å°åå®ä½çç²¾ç¡®åº¦ï¼åå³äºæ°æ®æ¥æºã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ååææä»¬ç¨çæ¥è¯¢å·¥å·ï¼è¿æå¾®åãæé³è¿äºç¤¾äº¤å¹³å°ï¼å®ä»¬é½æ¯åºäº ASN åè¿è¥åæ°æ®æ¥å®ä½çï¼éå¸¸åªè½å®ä½å°å¸çº§æèåºçº§ï¼æ¯å¦å¹¿ä¸æ·±å³ãä¸æµ·æµ¦ä¸è¿ç§ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372397016-93ec54fe-d8d1-4910-85da-4afd17ee4c1b.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372397016-93ec54fe-d8d1-4910-85da-4afd17ee4c1b.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ ï¼åæ­£ä¸ä¼æ¾ç¤ºå° âææ æå®¤â å¯¹å§ï¼é£ä¿ºå¨æ°é»éçå°æäººè¯´ âé¡ºçç½çº¿æäººâ æ¯æä¹åäºï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®ï¼æ³è¦æ¾å°ä½ ç <span class="md-pair-s "><strong>ç²¾ç¡®å®ä½</strong><span class="md-plain">ï¼å¯ä»¥æ¥è¯¢è¿è¥åé£è¾¹è¯¦ç»çåéè®°å½ï¼è®°å½çåªä¸ª IP å¨ä»ä¹æ¶é´åéç»äºåªä¸ªç¨æ·ï¼çè³æå·ä½çå®è£å°åã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372413678-07cd3b42-d32b-40a8-a300-cda1bd3cddd7.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372413678-07cd3b42-d32b-40a8-a300-cda1bd3cddd7.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½æ¯ï¼è¿äºæ°æ®æä¸¥æ ¼çéç§ä¿æ¤ï¼åªææ§æ³é¨é¨ä¾æ³è°æ¥çæ¶åæè½æ¥è¯¢ãæ®éäººåæ®éå¹³å°æ¯æ¥ä¸å°çï¼æä»¥å«æå¿ãä¸åäºå¿äºï¼ä¸æé¬¼æ²é¨ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372442687-556b75a9-b9d0-43ce-901f-c8d49e5ed7ad.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372442687-556b75a9-b9d0-43ce-901f-c8d49e5ed7ad.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ è¥æææï¼çæ¥å¨ç½ç»ä¸ä¹ä¸è½ä¹±è¯´è¯åâ¦â¦</span></p>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®ï¼ä¸è¿ï¼è¿æå¶ä»ç²¾ç¡®å®ä½çæ¹æ³ãæ¯å¦ä½ ç» APP å¼äº <span class="md-pair-s "><strong>GPS æé</strong><span class="md-plain">ï¼APP å°±è½ç´æ¥è¯»åä½ ææºéç <span class="md-pair-s "><strong>ç»çº¬åº¦åæ </strong><span class="md-plain">ï¼ç²¾åº¦å¯ä»¥è¾¾å° 10 ç±³ä»¥åã</span></span></span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372463971-80401611-f5b8-47c1-8214-615d2ff327e1.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372463971-80401611-f5b8-47c1-8214-615d2ff327e1.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">åªæä½ å³äº GPSï¼åªè¦ä½ å¼äº <span class="md-pair-s "><strong>WiFi æèçæ«ææé</strong><span class="md-plain">ï¼APP ç§æ ·è½å®ä½ãå®ä»¬ä¼æ«æä½ éè¿å ä¸ª WiFi çç¹å¾ IDï¼BSSIDï¼ï¼ç¶åå»äºç«¯æ°æ®åºä¸æ¯å¯¹ï¼åç°ä½ å¨å´è¿å ä¸ª WiFi é½å¨ææ åå­æ¥¼éï¼å°±è½åæ¨åºä½ ä¹å¨é£éã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372497577-b7f25ef3-6e48-4142-9524-1b17235ad169.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372497577-b7f25ef3-6e48-4142-9524-1b17235ad169.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ å¿æä½æ¸ï¼è¿å¥½æçææºæéæ²¡æä¹±å¼â¦â¦ ä½æ¯é±¼ç®ï¼å¹³å°ä¸ºä»ä¹è¦æ¾ç¤º IP å½å±å°å¢ï¼ä¼ä¸ä¼ä¾µç¯ç¨æ·çéç§åï¼</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">ä¼ä¸ä¼ä¾µç¯éç§ï¼</span></h2>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®ï¼å¶å®è¿ä¸ªåè½æ¯æä¾æ®çã2022 å¹´ 6 æï¼å½å®¶ç½ä¿¡ååå¸äºãäºèç½ç¨æ·è´¦å·ä¿¡æ¯ç®¡çè§å®ãï¼è¦æ±å¹³å°å±ç¤º <span class="md-pair-s "><strong>åçèå´å</strong><span class="md-plain"> ç IP å½å±å°ä¿¡æ¯ï¼ç®çæ¯ä¾¿äºå¬ä¼çç£ï¼åå°ç½ç»ä¸çä¸å®ä¿¡æ¯ä¼ æ­ã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372529398-bab19e00-5873-4bfe-ad26-32c3161cc210.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372529398-bab19e00-5873-4bfe-ad26-32c3161cc210.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">èä¸ä½ çï¼æ­£è§å¹³å°åªæ¾ç¤ºå¤§è´å°åºï¼å¹¶ä¸æ¶åä½ çå·ä½ä¸ªäººèº«ä»½ä¿¡æ¯ï¼ä¹ä¸ä¼æ´é²ä½ æ¯è°ãä½å¨åªéã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ ï¼åæ¥å¦æ­¤ï¼ä½å¦æä¿ºæ¯ä¸ªå¤§ææï¼ç²ä¸ä¸å°±ç¥éä¿ºå¤§æ¦å¨åªéäºï¼ä¸ä¸äººå¤åéå¤§ï¼ä¸å°å¿æä¿ºé®å°äºæä¹åï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372558521-55aff509-6e0e-4dc2-bf03-45f545743226.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372558521-55aff509-6e0e-4dc2-bf03-45f545743226.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">å¯¹äºï¼ä¿ºè½ä¸è½ä¿®æ¹èªå·±ç IP å½å±å°å¢ï¼</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">æä¹ä¿®æ¹ IP å½å±å°ï¼</span></h2>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®åç¬ï¼è¿å¤ªç®åäºï¼ä½ åªéè¦ä¹°ä¸å¼ é«éç¥¨ï¼ä»åäº¬å°å¤©æ´¥ï¼åä¸ªå°æ¶å°±æå®äº~</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ ä¸æèè¢ï¼å¦åï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372575431-f23871b2-abda-4b6b-baf9-8138e3716b0c.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372575431-f23871b2-abda-4b6b-baf9-8138e3716b0c.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®ï¼å¼å¼ï¼ä¸è¿è¿ææ´ç®åçæ¹å¼ ââ éè¿ä»£çæå¡å¨ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä»£çæå¡å¨å°±åç½ç»ä¸­è½¬ç«ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">æ­£å¸¸æåµä¸ï¼ä½ çè¯·æ±æ¯ç´æ¥åç»ç®æ ç½ç«çã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½å¦æç¨äºä»£çæå¡å¨ï¼ä½ çè¯·æ±ä¼ååå°ä»£çæå¡å¨ï¼åç±å®è½¬åç»ç®æ ç½ç«ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">è¿æ ·ä¸æ¥ï¼ç®æ ç½ç«çå°çå°±æ¯ä»£çæå¡å¨ç IPï¼èä¸æ¯ä½ ççå® IPã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372596427-8d36fe1d-56fd-41a7-a2dc-f6a1f3f0fa8d.png"><img data-src="https://pic.yupi.icu/1/1768372596427-8d36fe1d-56fd-41a7-a2dc-f6a1f3f0fa8d.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ æç¶å¤§æï¼ä¿ºæäºï¼å°±åä¿ºè®©æåå¸®å¿å¯å¿«éï¼å¯ä»¶å°åæ¾ç¤ºçæ¯æåå®¶ï¼èä¸æ¯ä¿ºå®¶ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372615262-30ad1092-c9fc-4647-b9ca-8e0c66667381.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372615262-30ad1092-c9fc-4647-b9ca-8e0c66667381.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®ï¼æ¥ï¼æç»ä½ æ¼ç¤ºä¸ä¸ãæ¯å¦æå¨åäº¬æå°æå¡å¨ï¼å¯ä»¥ç¨ä¸ä¸ªå« Nginx çé«æ§è½ Web æå¡å¨è½¯ä»¶æ¥éç½®ä»£çã</span></p>
<p class="md-end-block md-p"><span class="md-plain">é¦åï¼æå¨æå¡å¨ä¸å®è£ Nginxï¼è¿éå©ç¨äºå®å¡ Linux é¢æ¿æéå®è£ï¼ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1766732645069-485cd70c-06e1-477c-88bb-e34ba1ea466a.png"><img data-src="https://pic.yupi.icu/1/1766732645069-485cd70c-06e1-477c-88bb-e34ba1ea466a.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ç¶åç¼è¾éç½®æä»¶ <span class="md-pair-s"><code>nginx.conf</code><span class="md-plain">ï¼éç½®ä¸ä¸ªç®åçæ­£åä»£çï¼ä¹å°±æ¯è®©ä½ çè¯·æ±éè¿ä»£çæå¡å¨è½¬ååºå»ã</span></span></span></p>
<pre class="md-fences md-end-block ty-contain-cm modeLoaded"><span><span class="cm-comment"># ç®ææ­£åä»£çï¼æ³¨æï¼ä»æ¯æ HTTP æµéï¼ä¸æ¯æ HTTPSï¼<br><span><span class="cm-variable-2">server&nbsp;{<br><span>&nbsp; &nbsp;<span class="cm-string-2">listen&nbsp;8080;<br><span>&nbsp; &nbsp;<br><span>&nbsp; &nbsp;<span class="cm-variable-2">location&nbsp;/ {<br><span>&nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment"># å¿é¡»éç½® DNS è§£æå¨<br><span>&nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">resolver&nbsp;8.8.8.8;<br><span>&nbsp; &nbsp; &nbsp; &nbsp;<br><span>&nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment"># è®¾ç½®ä»£çç®æ <br><span>&nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string-2">proxy_pass&nbsp;<span class="cm-variable-2">http://$http_host$request_uri;<br><span>&nbsp; &nbsp; &nbsp; &nbsp;<br><span>&nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment"># éèçå® IPï¼é²æ­¢æ³é²ç»ç®æ ç½ç«<br><span>&nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">proxy_set_header&nbsp;<span class="cm-number">X-Real-IP&nbsp;<span class="cm-string">"";<br><span>&nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">proxy_set_header&nbsp;<span class="cm-number">X-Forwarded-For&nbsp;<span class="cm-string">"";<br><span>&nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">proxy_set_header&nbsp;<span class="cm-number">Via&nbsp;<span class="cm-string">"";<br><span>&nbsp; }<br><span>}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1766736492381-d78b1be3-3dfd-4355-bdfa-760a0217b0f0.png"><img data-src="https://pic.yupi.icu/1/1766736492381-d78b1be3-3dfd-4355-bdfa-760a0217b0f0.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">éç½®å¥½ä¹åï¼éå¯ Nginxï¼æèéè½½éç½®ï¼ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1766736519515-286d6104-629c-4191-9d1f-53a63cda6b8b.png"><img data-src="https://pic.yupi.icu/1/1766736519515-286d6104-629c-4191-9d1f-53a63cda6b8b.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">æ¥ä¸æ¥ï¼å½ä½ éè¿è¿å°æå¡å¨ç 8080 ç«¯å£è®¿é® HTTP ç½ç«æ¶ï¼ç½ç«çå°çå°±æ¯è¿å°åäº¬æå¡å¨ç IP äºã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1766736870475-0f8fd398-bc1d-4709-be53-8f29016297fe.png"><img data-src="https://pic.yupi.icu/1/1766736870475-0f8fd398-bc1d-4709-be53-8f29016297fe.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä¸è¿è¿ä¸ªç®æéç½®åªè½ä»£ç HTTP ç½ç«ï¼å¦æè¦ä»£ç HTTPSï¼éè¦æ´å¤æçéç½®æèä½¿ç¨ä¸é¨çä»£çè½¯ä»¶ãä¸è¿æè·¯æ¯ä¸æ ·çï¼é½æ¯éè¿ä¸­è½¬æå¡å¨æ¥éèçå® IPã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372657964-bb42875a-a7c3-4a33-b867-1491ae9461a5.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372657964-bb42875a-a7c3-4a33-b867-1491ae9461a5.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ å´å¥å°æèè¶³è¹ï¼é¿å·´é¿å·´ï¼ä¿ºä¹è¦è¿æ ·åï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®ï¼ææ¯è½ç¶ä¸é¾ï¼ä½ä½ è¦æ³¨æåçä½¿ç¨ææ¯ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">å¦ææ¯æ­£å¸¸çææ¯å­¦ä¹ ãä¼ä¸åºç¨ï¼å®å¨æ²¡é®é¢ï¼å¾å¤å¬å¸é½ä¼ç¨ä»£çæå¡å¨æ¥ç®¡çç½ç»æµéã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½åä¸ä¸è¦ç¨æ¥éé¿å¹³å°è§åæèåè¿è§çäºæãèä¸ç°å¨å¾å¤å¹³å°é½ææ£æµæºå¶ï¼è½è¯å«åºä½ æ¯ä¸æ¯ç¨äºä»£çè®¿é®ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ å¥½å¥éï¼å®ä»¬æ¯æä¹æ£æµåºæ¥çï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®ï¼å¸¸è§çæ¹æ³æè¿å ç§</span></p>
<ol class="ol-list" start="">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">æ£æ¥ HTTP è¯·æ±å¤´ï¼ä»£çè®¿é®æ¶ä¼æä¸äºç¹æ®çè¯·æ±å¤´ä¿¡æ¯ï¼æ¯å¦ X-Forwarded-For</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">æ£æ¥ IP å°ååºï¼æäºæå¡ä¼ç»´æ¤å·²ç¥çä»£çæå¡å¨ IP é»åå</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">åæè®¿é®è¡ä¸ºï¼æ¯å¦åä¸ä¸ª IP ç­æ¶é´åæå¤§éä¸åç¨æ·çè¯·æ±ï¼å°±å¾å¯è½æ¯ä»£ç</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">WebRTC æ³é²æ£æµãæµè§å¨å¨å®ç°è§é¢éè¯æ¶ä¼å°è¯å»ºç«ç¹å¯¹ç¹è¿æ¥ï¼è¿ä¸ªè¿ç¨ä¸­å¯è½æ´é²ä½ ççå® IP å°åï¼å³ä½¿ä½ ç¨äºä»£çä¹æ²¡ç¨</span></p>
</li>
</ol>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372695420-061b6985-858d-4060-bec5-ae2ba3db6bd3.png"><img data-src="https://pic.yupi.icu/1/1768372695420-061b6985-858d-4060-bec5-ae2ba3db6bd3.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ ï¼çæ¥æ³å®å¨éè IPï¼è¿æç¹å¿é¾åâ¦â¦</span></p>
<p class="md-end-block md-p"><span class="md-plain">é±¼ç®ï¼æä»¥æå¥½è¿æ¯åè§ä½¿ç¨ç½ç»ï¼ä¸åè¿è§çäºæå¦ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">å°é¿å·´ï¼æç½äºæç½äºï¼ä¿ºè¦å¨ä½ çåå®¹ä¸è¯è®ºï¼ççèªå·±çå½å±å°~</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1768372713956-43a65d81-2801-41c7-98eb-d379a8c1ae3f.png"><img style="display: block; margin-left: auto; margin-right: auto" data-src="https://pic.yupi.icu/1/1768372713956-43a65d81-2801-41c7-98eb-d379a8c1ae3f.png" class="lazyload"></span></p>
<h2 class="md-end-block md-heading"><span class="md-plain">æ´å¤ç¼ç¨å­¦ä¹ èµæº</span></h2>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/course" rel="noopener nofollow"><span class="md-plain">Javaåç«¯ç¨åºåå¿åé¡¹ç®å®ææç¨+æ¯è®¾ç½ç«</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/" rel="noopener nofollow"><span class="md-plain">ç¨åºååè´¹ç¼ç¨å­¦ä¹ äº¤æµç¤¾åºï¼èªå­¦å¿å¤ï¼</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/course/cv" rel="noopener nofollow"><span class="md-plain">ç¨åºåä¿å§çº§æ±èåç®åæåï¼æ¾å·¥ä½å¿å¤ï¼</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.mianshiya.com/" rel="noopener nofollow"><span class="md-plain">ç¨åºååè´¹é¢è¯å·é¢ç½ç«å·¥å·ï¼æ¾å·¥ä½å¿å¤ï¼</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640584449888772098" rel="noopener nofollow"><span class="md-plain">ææ°Javaé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Javaæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640586673306091521" rel="noopener nofollow"><span class="md-plain">ææ°Pythoné¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Pythonæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640586014108303362" rel="noopener nofollow"><span class="md-plain">ææ°åç«¯é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + åç«¯æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640586867363954689" rel="noopener nofollow"><span class="md-plain">ææ°æ°æ®ç»æåç®æ³é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + ç®æ³æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1644279832026075138" rel="noopener nofollow"><span class="md-plain">ææ°C++é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ãC++æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1641797333479903234" rel="noopener nofollow"><span class="md-plain">ææ°æ°æ®åºé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + æ°æ®åºæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640589994284695553" rel="noopener nofollow"><span class="md-plain">ææ°Redisé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Redisæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1641035880439271426" rel="noopener nofollow"><span class="md-plain">ææ°è®¡ç®æºåºç¡å¥é¨å­¦ä¹ è·¯çº¿ + è®¡ç®æºåºç¡æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1641366118197153793" rel="noopener nofollow"><span class="md-plain">ææ°å°ç¨åºå¥é¨å­¦ä¹ è·¯çº¿ + å°ç¨åºå¼åæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="http://sqlmother.yupi.icu/" rel="noopener nofollow"><span class="md-plain">ææ°SQLé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + SQLæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640586295529324545" rel="noopener nofollow"><span class="md-plain">ææ°Linuxé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Linuxæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640588753362108417" rel="noopener nofollow"><span class="md-plain">ææ°Git/GitHubé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Gitæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640587909942099969" rel="noopener nofollow"><span class="md-plain">ææ°æä½ç³»ç»é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + æä½ç³»ç»æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640588119619551233" rel="noopener nofollow"><span class="md-plain">ææ°è®¡ç®æºç½ç»é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + è®¡ç®æºç½ç»æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640588392073150465" rel="noopener nofollow"><span class="md-plain">ææ°è®¾è®¡æ¨¡å¼é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + è®¾è®¡æ¨¡å¼æç¨</span></a></span></p>
</li>
<li class="md-list-item md-focus-container">
<p class="md-end-block md-p md-focus"><span class="md-meta-i-c md-link md-expand"><a href="https://www.code-nav.cn/post/1640648711119892481" rel="noopener nofollow"><span class="md-plain">ææ°è½¯ä»¶å·¥ç¨é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + è½¯ä»¶å·¥ç¨æç¨</span></a></span></p>
</li>
</ul>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-15 11:42">2026-01-15 11:41</span>&nbsp;
<a href="https://www.cnblogs.com/yupi">ç¨åºåé±¼ç®</a>&nbsp;
éè¯»(<span id="post_view_count">76</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19486536);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19486536', targetLink: 'https://www.cnblogs.com/yupi/p/19486536', title: 'ä½ ç IP å½å±å°ï¼æ¯åè¢«æåºæ¥çï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ # Gorse Master å·¥ä½åçè¯¦è§£ ]]></title>
    <link>https://www.cnblogs.com/wanber/p/19486510</link>
    <guid>2075e03e4c607ec45816fe9c4428608c</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/wanber/p/19486510" title="åå¸äº 2026-01-15 11:36">
    <span role="heading" aria-level="2"># Gorse Master å·¥ä½åçè¯¦è§£</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p>Master æ¯æ´ä¸ª Gorse ç³»ç»ç"å¤§è"å"ææ¥å®"</p>
</blockquote>
<h2 id="-master-å¨æ¶æä¸­çä½ç½®">ð Master å¨æ¶æä¸­çä½ç½®</h2>
<pre><code>ââââââââââââââââââââââââââââââââââââââââââââââââââââ
â                  Master (å¤§è)                    â
â          ç«¯å£: 8086 (gRPC) + 8088 (HTTP)         â
ââââââ¬ââââââââââââââ¬âââââââââââââââââ¬âââââââââââââââ
     â             â                â
     â éç½®åæ­¥     â æ¨¡åä¸å       â ä»»å¡åé
     â¼             â¼                â¼
âââââââââââ  ââââââââââââ    ââââââââââââ
â Server  â  â Worker-1 â    â Worker-2 â
â (APIå±) â  â (è®¡ç®å±) â    â (è®¡ç®å±) â
âââââââââââ  ââââââââââââ    ââââââââââââ
     â             â                â
     âââââââââââââââ´âââââââââââââââââ
                   â
        ââââââââââââ´âââââââââââ
        â                     â
   ââââââ¼ââââââ        âââââââ¼âââââ
   â  MySQL   â        â  Redis   â
   â (æ°æ®)   â        â (ç¼å­)   â
   ââââââââââââ        ââââââââââââ
</code></pre>
<hr>
<h2 id="-master-çå­å¤§èè´£">ð¯ Master çå­å¤§èè´£</h2>
<h3 id="1-ä»»å¡è°åº¦-">1. <strong>ä»»å¡è°åº¦</strong> ð</h3>
<p>å®æè§¦åè®­ç»ä»»å¡ï¼æ§å¶æ´ä¸ªæ¨èç³»ç»ççå½å¨æ</p>
<h3 id="2-æ°æ®å è½½-">2. <strong>æ°æ®å è½½</strong> ð¦</h3>
<p>ä» MySQL å è½½ç¨æ·/ç©å/åé¦æ°æ®ï¼æå»ºè®­ç»æ°æ®é</p>
<h3 id="3-æ¨¡åè®­ç»-">3. <strong>æ¨¡åè®­ç»</strong> ð§®</h3>
<p>è®­ç»ååè¿æ»¤æ¨¡åãCTR æ¨¡åï¼ä¿å­æ¨¡ååæ°</p>
<h3 id="4-automl-ä¼å-">4. <strong>AutoML ä¼å</strong> ð§</h3>
<p>èªå¨æç´¢æä½³è¶åæ°ï¼æåæ¨èè´¨é</p>
<h3 id="5-éç½®åå-ï¸">5. <strong>éç½®åå</strong> âï¸</h3>
<p>éè¿ gRPC å Server/Worker ååéç½®åæ°æ®åºè¿æ¥ä¿¡æ¯</p>
<h3 id="6-ç»è®¡çæ§-">6. <strong>ç»è®¡çæ§</strong> ð</h3>
<p>æ¶éç³»ç»ææ ï¼æä¾ Dashboard åçæ§æ¥å£</p>
<hr>
<h2 id="ï¸-master-çæ ¸å¿ç»æ">ðï¸ Master çæ ¸å¿ç»æ</h2>
<pre><code class="language-go">// master.go:62-100
type Master struct {
    // gRPC æå¡å¨ï¼ä¸ Worker/Server éä¿¡ï¼
    grpcServer *grpc.Server
    
    // REST API æå¡å¨ï¼Dashboard + ç®¡çæ¥å£ï¼
    RestServer server.RestServer
    
    // æ°æ®åºè¿æ¥
    metaStore  meta.Database    // åæ°æ®ï¼SQLiteï¼
    blobStore  blob.Store       // æ¨¡åæä»¶å­å¨
    DataClient  data.Database   // ç¨æ·æ°æ®ï¼MySQLï¼
    CacheClient cache.Database  // æ¨èç¼å­ï¼Redisï¼
    
    // ååè¿æ»¤æ¨¡å
    collaborativeFilteringModelMutex sync.RWMutex
    collaborativeFilteringMeta       meta.Model[cf.Score]
    
    // CTR æ¨¡å
    clickThroughRateModelMutex sync.RWMutex
    clickThroughRateMeta        meta.Model[ctr.Score]
    
    // äºä»¶ééï¼è§¦åè®­ç»ï¼
    fitTicker    *time.Ticker              // å®æ¶å¨
    importedChan *parallel.ConditionChannel // æ°æ®å¯¼å¥äºä»¶
    triggerChan  *parallel.ConditionChannel // æå¨è§¦åäºä»¶
}
</code></pre>
<hr>
<h2 id="-master-å¯å¨æµç¨è¯¦è§£">ð Master å¯å¨æµç¨è¯¦è§£</h2>
<h3 id="step-1-åå»º-master-å®ä¾mastergo103-144">Step 1: åå»º Master å®ä¾ï¼master.go:103-144ï¼</h3>
<pre><code class="language-go">func NewMaster(cfg *config.Config, cacheFolder string, standalone bool) *Master {
    // 1. è®¾ç½®è¿½è¸ªæä¾èï¼OpenTelemetryï¼
    tp, _ := cfg.Tracing.NewTracerProvider()
    otel.SetTracerProvider(tp)
    
    // 2. è®¾ç½® OpenAI å®¢æ·ç«¯ï¼å¦æä½¿ç¨ LLM æåºï¼
    clientConfig := openai.DefaultConfig(cfg.OpenAI.AuthToken)
    openAIClient := openai.NewClientWithConfig(clientConfig)
    
    // 3. åå»ºå®æ¶å¨ï¼é»è®¤æ¯å°æ¶è®­ç»ä¸æ¬¡ï¼
    duration := cfg.Recommend.Collaborative.FitPeriod  // å¦ 60m
    fitTicker := time.NewTicker(duration)
    
    // 4. åå»ºäºä»¶éé
    importedChan := parallel.NewConditionChannel()  // æ°æ®å¯¼å¥éç¥
    triggerChan := parallel.NewConditionChannel()   // æå¨è§¦åéç¥
    
    m := &amp;Master{
        cachePath:    cacheFolder,
        openAIClient: openAIClient,
        fitTicker:    fitTicker,
        importedChan: importedChan,
        triggerChan:  triggerChan,
        RestServer: server.RestServer{
            Config:     cfg,
            HttpHost:   cfg.Master.HttpHost,
            HttpPort:   cfg.Master.HttpPort,
        },
    }
    return m
}
</code></pre>
<p><strong>å³é®éç½®</strong>ï¼</p>
<ul>
<li>â <code>FitPeriod</code>ï¼è®­ç»å¨æï¼é»è®¤ 60 åéï¼</li>
<li>â <code>CacheFolder</code>ï¼å­å¨æ¨¡åååæ°æ®çè·¯å¾</li>
<li>â <code>Standalone</code>ï¼æ¯å¦ç¬ç«æ¨¡å¼ï¼åå« Worker åè½ï¼</li>
</ul>
<hr>
<h3 id="step-2-å¯å¨æå¡mastergo147-283-æ ¸å¿">Step 2: å¯å¨æå¡ï¼master.go:147-283ï¼â­ æ ¸å¿</h3>
<pre><code class="language-go">func (m *Master) Serve() {
    var err error
    
    // 1ï¸â£ è¿æ¥ Blob Storeï¼å­å¨æ¨¡åæä»¶ï¼
    if m.Config.S3.Endpoint != "" {
        m.blobStore, _ = blob.NewS3(m.Config.S3)  // AWS S3
    } else if m.Config.GCS.Bucket != "" {
        m.blobStore, _ = blob.NewGCS(m.Config.GCS)  // Google Cloud Storage
    } else {
        m.blobStore = blob.NewPOSIX(m.cachePath)  // æ¬å°æä»¶ç³»ç»
    }
    
    // 2ï¸â£ è¿æ¥ Meta Databaseï¼SQLiteï¼å­å¨åæ°æ®ï¼
    m.metaStore, _ = meta.Open(
        fmt.Sprintf("sqlite://%s/meta.sqlite3", m.cachePath),
        m.Config.Master.MetaTimeout,
    )
    m.metaStore.Init()
    
    // 3ï¸â£ è¿æ¥ Data Databaseï¼MySQL/PostgreSQLï¼
    m.DataClient, _ = data.Open(
        m.Config.Database.DataStore,  // "mysql://user:pass@host/db"
        m.Config.Database.DataTablePrefix,
    )
    m.DataClient.Init()
    
    // 4ï¸â£ è¿æ¥ Cache Databaseï¼Redisï¼
    m.CacheClient, _ = cache.Open(
        m.Config.Database.CacheStore,  // "redis://host:6379"
        m.Config.Database.CacheTablePrefix,
    )
    m.CacheClient.Init()
    
    // 5ï¸â£ å è½½å·²ä¿å­çæ¨¡ååæ°æ®
    metaStr, _ := m.metaStore.Get(meta.COLLABORATIVE_FILTERING_MODEL)
    if metaStr != nil {
        m.collaborativeFilteringMeta.FromJSON(*metaStr)
        log.Logger().Info("loaded collaborative filtering model",
            zap.String("type", m.collaborativeFilteringMeta.Type),
            zap.Any("params", m.collaborativeFilteringMeta.Params),
            zap.Any("score", m.collaborativeFilteringMeta.Score))
    }
    
    // 6ï¸â£ å¯å¨ä»»å¡è°åº¦å¾ªç¯ï¼åå° goroutineï¼â­â­â­
    go m.RunTasksLoop()
    
    // 7ï¸â£ å¯å¨ gRPC æå¡å¨ï¼åå° goroutineï¼
    go func() {
        log.Logger().Info("start rpc server",
            zap.String("host", m.Config.Master.Host),
            zap.Int("port", m.Config.Master.Port))  // é»è®¤ 8086
        
        lis, _ := net.Listen("tcp", 
            fmt.Sprintf("%s:%d", m.Config.Master.Host, m.Config.Master.Port))
        
        m.grpcServer = grpc.NewServer()
        
        // æ³¨åæå¡
        protocol.RegisterMasterServer(m.grpcServer, m)              // Master æå¡
        protocol.RegisterCacheStoreServer(m.grpcServer, ...)        // Cache ä»£ç
        protocol.RegisterDataStoreServer(m.grpcServer, ...)         // Data ä»£ç
        protocol.RegisterBlobStoreServer(m.grpcServer, ...)         // Blob å­å¨
        
        m.grpcServer.Serve(lis)
    }()
    
    // 8ï¸â£ å¯å¨ HTTP æå¡å¨ï¼Dashboardï¼
    m.StartHttpServer()  // é»è®¤ç«¯å£ 8088
}
</code></pre>
<p><strong>å¯å¨é¡ºåºå¾</strong>ï¼</p>
<pre><code>Master å¯å¨
    â
1. è¿æ¥ Blob Store (S3/GCS/æ¬å°)
    â
2. è¿æ¥ Meta Store (SQLite)
    â
3. è¿æ¥ Data Store (MySQL)
    â
4. è¿æ¥ Cache Store (Redis)
    â
5. å è½½å·²ä¿å­çæ¨¡å
    â
6. å¯å¨ä»»å¡è°åº¦å¾ªç¯ (goroutine)
    â
7. å¯å¨ gRPC æå¡å¨ (8086)
    â
8. å¯å¨ HTTP æå¡å¨ (8088)
    â
â Master å°±ç»ªï¼
</code></pre>
<hr>
<h2 id="-ä»»å¡è°åº¦å¾ªç¯mastergo295-323-ææ ¸å¿">ð ä»»å¡è°åº¦å¾ªç¯ï¼master.go:295-323ï¼â­â­â­ ææ ¸å¿</h2>
<pre><code class="language-go">func (m *Master) RunTasksLoop() {
    defer util.CheckPanic()
    
    // åå°çæ§æ°æ®å¯¼å¥
    go func() {
        m.importedChan.Signal()  // é¦æ¬¡ç«å³è§¦å
        for {
            if m.checkDataImported() {  // æ£æ¥æ¯å¦ææ°æ°æ®å¯¼å¥
                m.importedChan.Signal()
            }
            time.Sleep(time.Second)  // æ¯ç§æ£æ¥ä¸æ¬¡
        }
    }()
    
    // ä¸»å¾ªç¯ï¼ç­å¾è§¦åäºä»¶
    for {
        select {
        case &lt;-m.fitTicker.C:      // å®æ¶è§¦åï¼å¦æ¯å°æ¶ï¼
        case &lt;-m.importedChan.C:    // æ°æ®å¯¼å¥è§¦å
        case &lt;-m.triggerChan.C:     // æå¨è§¦å
        }
        
        // æ§è¡å®æ´çè®­ç»æµç¨
        err := m.runLoadDatasetTask()  // 1. å è½½æ°æ®é
        if err != nil {
            log.Logger().Error("failed to load dataset", zap.Error(err))
            continue
        }
        
        // åç»­è¿ä¼è°ç¨ï¼å¨å®éä»£ç ä¸­ï¼ï¼
        // m.runFitCollaborativeFilteringTask()  // 2. è®­ç»ååè¿æ»¤æ¨¡å
        // m.runFitClickModelTask()              // 3. è®­ç» CTR æ¨¡å
        // m.runCacheTask()                      // 4. çææ¨èç¼å­
    }
}
</code></pre>
<p><strong>è°åº¦æµç¨å¾</strong>ï¼</p>
<pre><code>ââââââââââââââââââââââââââââââââââââââââ
â         ä¸»å¾ªç¯ï¼æ°¸ä¸åæ­¢ï¼            â
ââââââââââââââ¬ââââââââââââââââââââââââââ
             â
    ââââââââââ´âââââââââ
    â  ç­å¾è§¦åäºä»¶    â
    â  - å®æ¶å¨         â
    â  - æ°æ®å¯¼å¥       â
    â  - æå¨è§¦å       â
    ââââââââââ¬âââââââââ
             â
             â¼
    âââââââââââââââââââ
    â 1. å è½½æ°æ®é   â  â tasks.go:loadDataset()
    â    ä» MySQL     â
    â    æå»ºè®­ç»é   â
    ââââââââââ¬âââââââââ
             â
             â¼
    âââââââââââââââââââ
    â 2. è®­ç» CF æ¨¡å â  â tasks.go:fitCollaborativeFiltering()
    â    BPR/ALS      â
    â    è¯ä¼°æ§è½     â
    ââââââââââ¬âââââââââ
             â
             â¼
    âââââââââââââââââââ
    â 3. AutoML ä¼å  â  â tasks.go:optimizeCollaborativeFiltering()
    â    æç´¢æä½³åæ° â
    â    (å¯é)       â
    ââââââââââ¬âââââââââ
             â
             â¼
    âââââââââââââââââââ
    â 4. è®­ç» CTR æ¨¡åâ  â tasks.go:fitClickModel()
    â    FM/DeepFM    â
    ââââââââââ¬âââââââââ
             â
             â¼
    âââââââââââââââââââ
    â 5. ååä»»å¡ç»   â  â Worker æ§è¡æ¨èè®¡ç®
    â    Worker       â
    ââââââââââ¬âââââââââ
             â
             â¼
    âââââââââââââââââââ
    â 6. ç­å¾ä¸æ¬¡è§¦å â
    âââââââââââââââââââ
</code></pre>
<hr>
<h2 id="-ä»»å¡-1å è½½æ°æ®étasksgo51-149">ð¦ ä»»å¡ 1ï¼å è½½æ°æ®éï¼tasks.go:51-149ï¼</h2>
<pre><code class="language-go">func (m *Master) loadDataset() (datasets Datasets, err error) {
    ctx, span := m.tracer.Start(context.Background(), "Load Dataset", 1)
    defer span.End()
    
    // 1ï¸â£ åå»ºéä¸ªæ§åæ¨èå¨ï¼æµè¡ãææ°ç­ï¼
    nonPersonalizedRecommenders := make([]*logics.NonPersonalized, 0)
    for _, cfg := range m.Config.Recommend.NonPersonalized {
        recommender, _ := logics.NewNonPersonalized(cfg, ...)
        nonPersonalizedRecommenders = append(nonPersonalizedRecommenders, recommender)
    }
    
    // 2ï¸â£ ä» MySQL å è½½æ°æ®
    log.Logger().Info("load dataset",
        zap.Any("positive_feedback_types", m.Config.Recommend.DataSource.PositiveFeedbackTypes),
        zap.Uint("item_ttl", m.Config.Recommend.DataSource.ItemTTL))
    
    datasets.clickDataset, datasets.rankingDataset, err = m.LoadDataFromDatabase(
        ctx, 
        m.DataClient,
        m.Config.Recommend.DataSource.PositiveFeedbackTypes,  // ["purchase", "like"]
        m.Config.Recommend.DataSource.ReadFeedbackTypes,      // ["click", "view"]
        m.Config.Recommend.DataSource.ItemTTL,                // ç©åè¿ææ¶é´
        m.Config.Recommend.DataSource.PositiveFeedbackTTL,    // åé¦è¿ææ¶é´
        evaluator,
        nonPersonalizedRecommenders,
    )
    
    // 3ï¸â£ ä¿å­éä¸ªæ§åæ¨èç»æå° Redis
    for i, recommender := range nonPersonalizedRecommenders {
        scores := recommender.PopAll()
        m.CacheClient.AddScores(ctx, cache.NonPersonalized, recommender.Name(), scores)
    }
    
    // 4ï¸â£ åå¥ç»è®¡æ°æ®å° Redis
    m.CacheClient.AddTimeSeriesPoints(ctx, []cache.TimeSeriesPoint{
        {Name: cache.NumUsers, Value: float64(datasets.rankingDataset.CountUsers())},
        {Name: cache.NumItems, Value: float64(datasets.rankingDataset.CountItems())},
        {Name: cache.NumFeedback, Value: float64(len(datasets.clickDataset.Target))},
    })
    
    // 5ï¸â£ åå²è®­ç»éåæµè¯é
    datasets.rankingTrainSet, datasets.rankingTestSet = 
        datasets.rankingDataset.SplitCF(numTestUsers, seed)
    datasets.clickTrainSet, datasets.clickTestSet = 
        datasets.clickDataset.Split(testRatio, seed)
    
    return datasets, nil
}
</code></pre>
<p><strong>å è½½æ°æ®æµç¨</strong>ï¼</p>
<pre><code>MySQL æ°æ®åº
    â
    â SELECT * FROM users
    â SELECT * FROM items  
    â SELECT * FROM feedbacks WHERE feedback_type IN ('purchase', 'like')
    â
âââââââââââââââââââââââââââ
â  LoadDataFromDatabase   â
â  - è¿æ»¤è¿ææ°æ®         â
â  - è¿æ»¤éèç©å         â
â  - æå»ºç¨æ·-ç©åç©éµ    â
ââââââââââââ¬âââââââââââââââ
           â
           ââââ rankingDataset (ååè¿æ»¤ç¨)
           â    - ç¨æ·æ°: 10,000
           â    - ç©åæ°: 50,000
           â    - åé¦æ°: 500,000
           â
           ââââ clickDataset (CTR æ¨¡åç¨)
                - æ­£æ ·æ¬: 300,000
                - è´æ ·æ¬: 200,000
</code></pre>
<hr>
<h2 id="-ä»»å¡-2è®­ç»ååè¿æ»¤æ¨¡å">ð§® ä»»å¡ 2ï¼è®­ç»ååè¿æ»¤æ¨¡å</h2>
<pre><code class="language-go">func (m *Master) fitCollaborativeFiltering(datasets Datasets) {
    // 1ï¸â£ éæ©æ¨¡åç±»å
    modelName := m.Config.Recommend.Collaborative.Model
    // å¯é: bpr, als, item-cf, user-cf
    
    // 2ï¸â£ è®¾ç½®è¶åæ°
    params := model.Params{
        model.NFactors:   50,      // éåéç»´åº¦
        model.Lr:         0.01,    // å­¦ä¹ ç
        model.Reg:        0.01,    // æ­£åå
        model.NEpochs:    100,     // è®­ç»è½®æ°
        model.InitMean:   0,
        model.InitStdDev: 0.1,
    }
    
    // 3ï¸â£ åå»ºå¹¶è®­ç»æ¨¡å
    var cfModel cf.MatrixFactorization
    switch modelName {
    case "bpr":
        cfModel = cf.NewBPR(params)
    case "als":
        cfModel = cf.NewALS(params)
    }
    
    // 4ï¸â£ è®­ç»
    log.Logger().Info("start training", 
        zap.String("model", modelName),
        zap.Any("params", params))
    
    cfModel.Fit(datasets.rankingTrainSet, datasets.rankingTestSet, ...)
    
    // 5ï¸â£ è¯ä¼°æ¨¡å
    scores := cfModel.Evaluate(datasets.rankingTestSet)
    log.Logger().Info("model trained",
        zap.Float32("Precision@10", scores.Precision),
        zap.Float32("Recall@10", scores.Recall),
        zap.Float32("NDCG@10", scores.NDCG))
    
    // 6ï¸â£ ä¿å­æ¨¡å
    modelBytes := cfModel.Marshal()
    m.blobStore.Put("models/cf_model.bin", modelBytes)
    
    // 7ï¸â£ ä¿å­åæ°æ®
    m.collaborativeFilteringMeta = meta.Model[cf.Score]{
        Type:   modelName,
        Params: params,
        Score:  scores,
    }
    m.metaStore.Set(meta.COLLABORATIVE_FILTERING_MODEL, 
        m.collaborativeFilteringMeta.ToJSON())
}
</code></pre>
<hr>
<h2 id="-ä»»å¡-3automl-è¶åæ°ä¼åå¯é">ð§ ä»»å¡ 3ï¼AutoML è¶åæ°ä¼åï¼å¯éï¼</h2>
<pre><code class="language-go">func (m *Master) optimizeCollaborativeFiltering(datasets Datasets) {
    // ä½¿ç¨ TPE (Tree-structured Parzen Estimator) ç®æ³
    
    study, _ := goptuna.CreateStudy("cf-optimize", 
        goptuna.StudyOptionSampler(tpe.NewSampler()))
    
    // å®ä¹ä¼åç®æ 
    objective := func(trial goptuna.Trial) (float64, error) {
        // 1ï¸â£ éæ ·è¶åæ°
        nFactors := trial.SuggestInt("n_factors", 10, 100)
        lr := trial.SuggestFloat("lr", 0.001, 0.1)
        reg := trial.SuggestFloat("reg", 0.001, 0.1)
        
        // 2ï¸â£ ä½¿ç¨è¿ç»åæ°è®­ç»æ¨¡å
        params := model.Params{
            model.NFactors: nFactors,
            model.Lr:       lr,
            model.Reg:      reg,
        }
        cfModel := cf.NewBPR(params)
        cfModel.Fit(datasets.rankingTrainSet, datasets.rankingTestSet, ...)
        
        // 3ï¸â£ è¿åè¯ä¼°ææ ï¼è¶å¤§è¶å¥½ï¼
        scores := cfModel.Evaluate(datasets.rankingTestSet)
        return float64(scores.NDCG), nil
    }
    
    // 4ï¸â£ è¿è¡ä¼åï¼é»è®¤ 10 æ¬¡è¯éªï¼
    for i := 0; i &lt; m.Config.Recommend.Collaborative.OptimizeTrials; i++ {
        study.Optimize(objective, 1)
        
        log.Logger().Info("optimization progress",
            zap.Int("trial", i+1),
            zap.Float64("best_ndcg", study.GetBestValue()))
    }
    
    // 5ï¸â£ ä½¿ç¨æä½³åæ°éæ°è®­ç»
    bestParams := study.GetBestParams()
    log.Logger().Info("found best params", zap.Any("params", bestParams))
}
</code></pre>
<p><strong>AutoML æç´¢ç©ºé´</strong>ï¼</p>
<pre><code>è¶åæ°èå´ï¼
- n_factors:  [10, 20, 50, 100]        # éåéç»´åº¦
- lr:         [0.001, 0.01, 0.05, 0.1] # å­¦ä¹ ç
- reg:        [0.001, 0.01, 0.1]       # æ­£åå
- n_epochs:   [50, 100, 200]           # è®­ç»è½®æ°

ç®æ ï¼æå¤§å NDCG@10
æ¹æ³ï¼TPE (è´å¶æ¯ä¼å)
è¯éªæ¬¡æ°ï¼10 æ¬¡ï¼é»è®¤ï¼
</code></pre>
<hr>
<h2 id="-grpc-æå¡éç½®åå">ð¡ gRPC æå¡ï¼éç½®åå</h2>
<h3 id="serverworker-è¯·æ±éç½®">Server/Worker è¯·æ±éç½®</h3>
<pre><code class="language-go">// rpc.go
func (m *Master) GetMeta(ctx context.Context, nodeInfo *protocol.NodeInfo) (*protocol.Meta, error) {
    // 1ï¸â£ è®°å½èç¹ä¿¡æ¯
    log.Logger().Info("node connected",
        zap.String("node_type", nodeInfo.NodeType.String()),
        zap.String("uuid", nodeInfo.Uuid),
        zap.String("version", nodeInfo.BinaryVersion))
    
    // 2ï¸â£ åºååéç½®ä¸º JSON
    configJson, _ := json.Marshal(m.Config)
    
    // 3ï¸â£ è¿ååæ°æ®
    return &amp;protocol.Meta{
        Config:             string(configJson),
        ConfigVersion:      m.Config.Version,
        RankingModelName:   m.collaborativeFilteringMeta.Type,
        RankingModelVersion: m.collaborativeFilteringMeta.Version,
        // ... å¶ä»åæ°æ®
    }, nil
}
</code></pre>
<h3 id="worker-è¯·æ±æ¨¡å">Worker è¯·æ±æ¨¡å</h3>
<pre><code class="language-go">func (m *Master) GetRankingModel(ctx context.Context, req *protocol.VersionInfo) (*protocol.Model, error) {
    // 1ï¸â£ è¯»åæ¨¡ååæ°æ®
    m.collaborativeFilteringModelMutex.RLock()
    meta := m.collaborativeFilteringMeta
    m.collaborativeFilteringModelMutex.RUnlock()
    
    // 2ï¸â£ ä» Blob Store è¯»åæ¨¡åæä»¶
    modelBytes, _ := m.blobStore.Get("models/cf_model.bin")
    
    // 3ï¸â£ è¿åæ¨¡å
    return &amp;protocol.Model{
        Name:    meta.Type,
        Version: meta.Version,
        Data:    modelBytes,
    }, nil
}
</code></pre>
<hr>
<h2 id="-master-çæ°æ®æµ">ð¨ Master çæ°æ®æµ</h2>
<pre><code>ââââââââââââââââââââââââââââââââââââââââââââââ
â              Master æ°æ®æµ                  â
âââââââââ¬âââââââââââââââââââââââââââââââââââââ
        â
   è¾å¥æº â
âââââââââââââââââ
â MySQL         â
â - users       â
â - items       â
â - feedbacks   â
âââââââââ¬ââââââââ
        â å è½½
        â¼
ââââââââââââââââââââ
â Dataset          â
â - 10K ç¨æ·       â
â - 50K ç©å       â
â - 500K åé¦      â
ââââââââââ¬ââââââââââ
         â è®­ç»
         â¼
ââââââââââââââââââââ
â CF Model (BPR)   â
â UserFactor: 10KÃ50â
â ItemFactor: 50KÃ50â
ââââââââââ¬ââââââââââ
         â ä¿å­
         ââââ Blob Store (æ¨¡åæä»¶)
         ââââ Meta Store (åæ°æ®)
                 â
                 â åå
                 â¼
        ââââââââââââââââââ
        â Worker         â
        â - ä¸è½½æ¨¡å     â
        â - è®¡ç®æ¨è     â
        â - åå¥ Redis   â
        ââââââââââââââââââ
</code></pre>
<hr>
<h2 id="ï¸-master-çéç½®ç®¡ç">âï¸ Master çéç½®ç®¡ç</h2>
<h3 id="éç½®ç­æ´æ°">éç½®ç­æ´æ°</h3>
<pre><code class="language-go">// Master çæ§éç½®æä»¶åå
func (m *Master) watchConfig() {
    watcher, _ := fsnotify.NewWatcher()
    watcher.Add("config.toml")
    
    for {
        select {
        case event := &lt;-watcher.Events:
            if event.Op&amp;fsnotify.Write == fsnotify.Write {
                // éæ°å è½½éç½®
                newConfig, _ := config.LoadConfig("config.toml")
                m.Config = newConfig
                
                log.Logger().Info("config reloaded")
                
                // è§¦åéæ°è®­ç»
                m.triggerChan.Signal()
            }
        }
    }
}
</code></pre>
<hr>
<h2 id="-master-çæ§ææ ">ð Master çæ§ææ </h2>
<h3 id="prometheus-ææ ">Prometheus ææ </h3>
<pre><code class="language-go">// metrics.go

// ç¨æ·åç©åç»è®¡
UsersTotal = prometheus.NewGauge(...)
ItemsTotal = prometheus.NewGauge(...)
ImplicitFeedbacksTotal = prometheus.NewGauge(...)

// æ¨¡åæ§è½
ModelPrecision = prometheus.NewGauge(...)
ModelRecall = prometheus.NewGauge(...)
ModelNDCG = prometheus.NewGauge(...)

// è®­ç»æ¶é¿
TrainingDuration = prometheus.NewHistogram(...)

// åå­ä½¿ç¨
MemoryInUse = prometheus.NewGauge(...)
</code></pre>
<h3 id="dashboard-è®¿é®">Dashboard è®¿é®</h3>
<pre><code class="language-bash"># HTTP æ¥å£
GET http://master:8088/api/dashboard/stats
# è¿åï¼
{
  "num_users": 10000,
  "num_items": 50000,
  "num_feedbacks": 500000,
  "model_precision": 0.23,
  "model_recall": 0.45,
  "model_ndcg": 0.67
}

# Prometheus ææ 
GET http://master:8088/metrics
</code></pre>
<hr>
<h2 id="-master-vs-server-å¯¹æ¯">ð¯ Master vs Server å¯¹æ¯</h2>
<table>
<thead>
<tr>
<th>ç¹æ§</th>
<th>Master</th>
<th>Server</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ä½ç¨</strong></td>
<td>å¤§èï¼è°åº¦è®­ç»ï¼</td>
<td>æï¼æä¾ APIï¼</td>
</tr>
<tr>
<td><strong>ç¶æ</strong></td>
<td>æç¶æï¼å­å¨æ¨¡åï¼</td>
<td>æ ç¶æï¼åªè¯»ç¼å­ï¼</td>
</tr>
<tr>
<td><strong>å®ä¾æ°</strong></td>
<td>1 ä¸ªï¼åä¾ï¼</td>
<td>N ä¸ªï¼å¯æ©å±ï¼</td>
</tr>
<tr>
<td><strong>ç«¯å£</strong></td>
<td>8086 (gRPC) + 8088 (HTTP)</td>
<td>8087 (HTTP)</td>
</tr>
<tr>
<td><strong>ä¸»è¦å·¥ä½</strong></td>
<td>è®­ç»æ¨¡åãåéä»»å¡</td>
<td>è¯»åç¼å­ãè¿åæ¨è</td>
</tr>
<tr>
<td><strong>æ°æ®åº</strong></td>
<td>è¯»å MySQL/Redis</td>
<td>åªè¯» Redis</td>
</tr>
<tr>
<td><strong>CPU ä½¿ç¨</strong></td>
<td>é«ï¼è®­ç»å¯éï¼</td>
<td>ä½ï¼åªè¯»ç¼å­ï¼</td>
</tr>
<tr>
<td><strong>åå­ä½¿ç¨</strong></td>
<td>é«ï¼å è½½æ°æ®éï¼</td>
<td>ä½ï¼æ éå­å¨ï¼</td>
</tr>
<tr>
<td><strong>æéå½±å</strong></td>
<td>æ æ³è®­ç»ï¼ä½æ¨èç»§ç»­</td>
<td>é¨åå®ä¾å¤±è´¥ï¼å¶ä»ç»§ç»­</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="-æ ¸å¿è¦ç¹æ»ç»">ð¡ æ ¸å¿è¦ç¹æ»ç»</h2>
<h3 id="master-çæ¬è´¨">Master çæ¬è´¨</h3>
<pre><code>Master = ä»»å¡è°åº¦å¨ + æ¨¡åè®­ç»å¨ + éç½®ç®¡çå¨

æ ¸å¿å·¥ä½ï¼
1. å®æä» MySQL å è½½æ°æ®
2. è®­ç»ååè¿æ»¤æ¨¡å
3. åéæ¨èè®¡ç®ä»»å¡ç» Worker
4. éè¿ gRPC ååéç½®ç» Server/Worker
5. çæ§ç³»ç»ç¶æ

NOT åçäºï¼
â ä¸æä¾æ¨è APIï¼Server åï¼
â ä¸è®¡ç®æ¨èç»æï¼Worker åï¼
â ä¸é¢åç»ç«¯ç¨æ·ï¼åªé¢åéç¾¤åé¨ï¼
</code></pre>
<h3 id="master-çè°åº¦å¨æ">Master çè°åº¦å¨æ</h3>
<pre><code>é»è®¤éç½®ï¼
- è®­ç»å¨æï¼60 åéï¼FitPeriodï¼
- AutoML å¨æï¼360 åéï¼OptimizePeriodï¼
- æ°æ®æ£æ¥ï¼1 ç§ï¼æ£æ¥æ¯å¦ææ°æ°æ®å¯¼å¥ï¼

å¯ä»¥éè¿ä»¥ä¸æ¹å¼è§¦åè®­ç»ï¼
1. å®æ¶å¨å°æï¼æ¯å°æ¶ï¼
2. æ°æ®å¯¼å¥ï¼API æå¥å¤§éåé¦åï¼
3. æå¨è§¦åï¼Dashboard ç¹å»æé®ï¼
</code></pre>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-15 11:37">2026-01-15 11:36</span>&nbsp;
<a href="https://www.cnblogs.com/wanber">ææ¯æ¼«æ¸¸</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19486510);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19486510', targetLink: 'https://www.cnblogs.com/wanber/p/19486510', title: '# Gorse Master å·¥ä½åçè¯¦è§£' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ ä¸æè·ä¸ªåï¼.NET 10 å¤§æ´æ°è®¡ç®å¯¹éµ Javaï¼ç»æä»¤äººæå¤ ]]></title>
    <link>https://www.cnblogs.com/sdcb/p/19484525/20261113-big-integer-dotnet-10-vs-java</link>
    <guid>9f38dd951b6a47bbb8de5c5c31048521</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/sdcb/p/19484525/20261113-big-integer-dotnet-10-vs-java" title="åå¸äº 2026-01-15 08:50">
    <span role="heading" aria-level="2">ä¸æè·ä¸ªåï¼.NET 10 å¤§æ´æ°è®¡ç®å¯¹éµ Javaï¼ç»æä»¤äººæå¤</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="å¼è¨ä»ç»éªå¼å°æ éå¤§">å¼è¨ï¼ä»âç»éªå¼âå°æ éå¤§</h2>
<p>æå¯¹æ°å¼è®¡ç®çæ§å¿µï¼æ¥èªåä¸­æ¶ä»£çé¾ç¼­ç»çç½å§ãé£æ¶ç©ãä¼å¥ãï¼æè®©æçè¿·çä¸æ¯ææªçè£å¤ï¼èæ¯è§è²é¢æ¿éé£æ¡é¿é¿ç<strong>ç»éªå¼</strong>ãççæ°å­ä¸æ­è·³å¨ãç´¯ç§¯ï¼æç»âå®âä¸å£°åçº§ï¼é£ç§ç®åçæ°å¼é©±å¨æ´ä¸ªä¸çè¿è½¬çæè§ï¼å®å¨å¤ªå¥å¦äºã</p>
<p>å½æ¶èªå­¦ç¼ç¨ï¼ä» G-BASIC éåªæ 16 ä½ç <code>INTEGER</code>ï¼å°ç¬¬ä¸æ¬¡åç° QBASIC <code>LONG</code> è½å­ä¸â20äº¿âæ¶çå´å¥ï¼åå°å¦ä»æä¸ºä¸å .NET ç¨åºåï¼ææ¡çè®ºä¸âæ éå¤§âç <code>System.Numerics.BigInteger</code>ãæå¯¹å¤§æ°çè¿·æä»æªæ¹åï¼åªæ¯çæéä¹èæ¥ï¼</p>
<blockquote>
<p><strong>ä½ä¸º .NET å¼åèï¼ææéç <code>BigInteger</code> å°åºå¤ä¸å¤å¿«ï¼ç¹å«æ¯åéå£ Java ç <code>BigInteger</code> ç¸æ¯ï¼ç©¶ç«è°æ´èä¸ç­¹ï¼</strong></p>
</blockquote>
<p>å°¤å¶æ¯æ¶åé«ç²¾åº¦è®¡ç®ãå¯ç å­¦ç­å³é®é¢åæ¶ï¼è¿ä¸ä»æ¯å¥½å¥ï¼æ´æ¯å³ä¹æ§è½çä¸¥èæ·é®ãä»å¤©ï¼æå°±éè¿ä¸æ¬¡è¯¦å°½çå¯¹æ¯æµè¯ï¼å« .NET 10ãJava 21ä»¥åJava 8ï¼ï¼æ¥ä¸ºå¤§å®¶æ­æç­æ¡ãç»æå¯è½åºä¹ææï¼è¯·å¡å¿çå°æåï¼ææ«è¿æä¸ä¸ªé«æ§è½çâå½©èâã</p>
<hr>
<h2 id="å®éªç®æ ä¸èå´">å®éªç®æ ä¸èå´</h2>
<p>æä»¬å¯¹æ¯è¿ä¸å¥å®ç°ï¼</p>
<ul>
<li><strong>.NET</strong>ï¼<code>System.Numerics.BigInteger</code>ï¼åºäº .NET 10ï¼</li>
<li><strong>Java</strong>ï¼<code>java.math.BigInteger</code>
<ul>
<li><strong>Java 21ï¼ææ°LTSï¼</strong>ï¼ä»£è¡¨æªæ¥è¶å¿</li>
<li><strong>Java 8ï¼å½åå­éæå¤§ï¼</strong>ï¼ä»£è¡¨åºå¤§çç°ç¶</li>
</ul>
</li>
</ul>
<h3 id="æµè¯æä½3ç±»è¦çå¸¸è§å¤§æ°ç­ç¹">æµè¯æä½ï¼3ç±»ï¼è¦çå¸¸è§å¤§æ°ç­ç¹ï¼</h3>
<ol>
<li><strong>ADD_MOD</strong>ï¼<code>(a + b) mod m</code>ï¼å æ³ + åæ¨¡ï¼</li>
<li><strong>MUL_MOD</strong>ï¼<code>(a * b) mod m</code>ï¼ä¹æ³ + åæ¨¡ï¼</li>
<li><strong>MODPOW</strong>ï¼<code>a^e mod m</code>ï¼æ¨¡å¹ï¼å¯ç å­¦ç­åºæ¯çæ§è½ç­ç¹ï¼</li>
</ol>
<h3 id="ä½å®½3æ¡£">ä½å®½ï¼3æ¡£ï¼</h3>
<ul>
<li>256 / 1024 / 4096 bits</li>
</ul>
<h3 id="è®¡æ¶å£å¾å°½éæå¶åªå£°">è®¡æ¶å£å¾ï¼å°½éæå¶åªå£°ï¼</h3>
<ul>
<li><strong>ç­èº«</strong>ï¼é¢ç­ 5 æ¬¡ï¼è®© JITï¼å³æ¶ç¼è¯å¨ï¼åååæ¥ã</li>
<li><strong>æµé</strong>ï¼æ­£å¼è· 11 æ¬¡ï¼åä¸­ä½æ°ï¼é¿ååæ¬¡æå¨å¹²æ°ã</li>
<li><strong>ææ </strong>ï¼<code>nsPerOp</code>ï¼æ¯æ¬¡æä½èæ¶å¤å°çº³ç§ï¼ï¼è¿ä¸ªå¼<strong>è¶å°è¶å¥½</strong>ã</li>
<li><strong>é²ä½å¼</strong>ï¼ç¨ <code>XOR</code> èåæ¯æ¬¡è®¡ç®ç»æï¼é²æ­¢èªæçç¼è¯å¨ææ´ä¸ªå¾ªç¯ä¼åæã</li>
</ul>
<hr>
<h2 id="æµè¯ç¯å¢">æµè¯ç¯å¢</h2>
<blockquote>
<p>è¯´æï¼ä»¥ä¸æ¯å¨åä¸ Linux å®¹å¨åå®æãå®¹å¨æèµæºéå¶ï¼å æ­¤âçå°ç CPU æ ¸æ°/åå­âä¸å®¿ä¸»æºä¸å®å¨ä¸è´ã</p>
</blockquote>
<ul>
<li><strong>OS</strong>ï¼Ubuntu 24.04.3 LTS</li>
<li><strong>CPUï¼å®¿ä¸»æºåå·ï¼</strong>ï¼AMD EPYC 7763 64-Core Processor<br>
<strong>å®¹å¨å¯ç¨æ ¸å¿æ°</strong>ï¼2 æ ¸ï¼åå®¹å¨éå¶ï¼</li>
<li><strong>åå­</strong>ï¼2GBï¼å®¹å¨éå¶ï¼</li>
<li><strong>.NET</strong>
<ul>
<li>SDKï¼10.0.101</li>
<li>Runtimeï¼10.0.1</li>
<li>ç¯å¢åéï¼<code>DOTNET_GCServer=1</code></li>
</ul>
</li>
<li><strong>Java</strong>
<ul>
<li>Java 21ï¼OpenJDK 21.0.9ï¼LTSï¼</li>
<li>Java 8ï¼Temurin(OpenJDK) 1.8.0_472-b08ï¼å¹¿æ³ä½¿ç¨ç 8u ç³»åï¼</li>
<li>JVM åæ°ï¼ä¸¤çæ¬ä¸è´ï¼ï¼
<ul>
<li><code>-Xms1g -Xmx1g</code>ï¼æ Java å åºå®ä¸º 1GBï¼é¿åå å¨ææ©å¼ å¹²æ°ï¼</li>
<li><code>-XX:+UseG1GC</code></li>
<li><code>-XX:+AlwaysPreTouch</code>ï¼å°½éåå°è¿è¡ä¸­é¡µåéæ°å¨ï¼</li>
</ul>
</li>
</ul>
</li>
<li><strong>ä¸è´æ§çº¦æ</strong>
<ul>
<li>Java 8/Java 21 ä½¿ç¨<strong>åä¸ä»½æºç </strong>ï¼ä»ä½¿ç¨ Java 8 è¯­æ³ï¼ï¼å¹¶ä¸ <strong>ç¨ Java 8 ç <code>javac</code> ç¼è¯</strong>ï¼classfile=52.0ï¼ååå«å¨ Java 8 / Java 21 ä¸è¿è¡ï¼ä»èå°½éæå·®å¼å½å å°è¿è¡æ¶/JIT/åºå®ç°ï¼èä¸æ¯ç¼è¯å¨çæå·®å¼ã</li>
</ul>
</li>
</ul>
<hr>
<h2 id="èµåææ²net-biginteger-ççä¸å¬å¹³å">èµåææ²ï¼.NET BigInteger ççâä¸å¬å¹³âåï¼</h2>
<p>æäººå¯è½æ³é®ï¼</p>
<blockquote>
<p>â.NET BigInteger æ¯æ¬¡è¿ç®é½ä¼åå»ºæ°çå¯¹è±¡ï¼ä¸å¯åï¼ï¼ä¸å¬å¹³ãâ</p>
</blockquote>
<p>è¿å¥è¯å¨âå¤§æ°åºæ¯âéåºæ¬æç«ï¼ä½<strong>Java BigInteger åæ ·æ¯ä¸å¯åç±»å</strong>ï¼<code>add/multiply/mod/xor/modPow</code> é½ä¼è¿åæ°å¼ï¼ä¸å¡ä»£ç å±é¢ä½ å¹¶æ²¡æå¬å¼ç in-place API å¯ä»¥å¤ç¨åé¨ç¼å²ã</p>
<p>å æ­¤ï¼å¨æ¬æçâä¸»å¯¹æ¯âï¼.NET vs Javaï¼éï¼åæ¹é½å¨ä¸å¯åèå¼ä¸è¿è¡ï¼è¿ç¹æ¯å¬å¹³çã</p>
<hr>
<h2 id="å®éªä¸net-biginteger-vs-java-21-biginteger">å®éªä¸ï¼.NET BigInteger vs Java 21 BigInteger</h2>
<h3 id="31-å®æ´æºä»£ç ">3.1 å®æ´æºä»£ç </h3>
<h4 id="java-æºç bigintbenchjava">Java æºç ï¼<code>BigIntBench.java</code></h4>
<blockquote>
<p>å¼å®¹ Java 8 è¯­æ³ï¼åä¸ä»½ä»£ç å¨ Java 21 ä¸è¿è¡ã</p>
</blockquote>
<pre><code class="language-java">import java.math.BigInteger;
import java.util.*;

public class BigIntBench {
    // SplitMix64 RNG (deterministic, fast)
    static final class SplitMix64 {
        private long x;
        SplitMix64(long seed) { this.x = seed; }
        long nextLong() {
            long z = (x += 0x9E3779B97F4A7C15L);
            z = (z ^ (z &gt;&gt;&gt; 30)) * 0xBF58476D1CE4E5B9L;
            z = (z ^ (z &gt;&gt;&gt; 27)) * 0x94D049BB133111EBL;
            return z ^ (z &gt;&gt;&gt; 31);
        }
        void nextBytes(byte[] dst) {
            int i = 0;
            while (i &lt; dst.length) {
                long v = nextLong();
                for (int k = 0; k &lt; 8 &amp;&amp; i &lt; dst.length; k++) {
                    dst[i++] = (byte)(v &gt;&gt;&gt; (56 - 8*k)); // big-endian stream
                }
            }
        }
    }

    static BigInteger[] genBigInts(int bitSize, int count, long seed) {
        SplitMix64 rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        BigInteger[] arr = new BigInteger[count];
        byte[] buf = new byte[byteLen];
        int topBit = (bitSize - 1) % 8;
        int keepBits = topBit + 1;
        int firstMask = (keepBits == 8) ? 0xFF : ((1 &lt;&lt; keepBits) - 1);
        byte topMask = (byte)(1 &lt;&lt; topBit);
        for (int i = 0; i &lt; count; i++) {
            rng.nextBytes(buf);
            // Ensure exact bit length:
            // - mask away unused top bits when bitSize is not byte-aligned
            // - set the top bit so the number has the requested bit length
            buf[0] &amp;= (byte)firstMask;
            buf[0] |= topMask;
            arr[i] = new BigInteger(1, buf);
        }
        return arr;
    }

    static BigInteger genModulus(int bitSize, long seed) {
        SplitMix64 rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        byte[] buf = new byte[byteLen];
        rng.nextBytes(buf);
        int topBit = (bitSize - 1) % 8;
        int keepBits = topBit + 1;
        int firstMask = (keepBits == 8) ? 0xFF : ((1 &lt;&lt; keepBits) - 1);
        buf[0] &amp;= (byte)firstMask;
        buf[0] |= (byte)(1 &lt;&lt; topBit);
        buf[buf.length - 1] |= 1; // odd
        return new BigInteger(1, buf);
    }

    enum Op { ADD_MOD, MUL_MOD, MODPOW }

    static final class Result {
        final String lang;
        final int bits;
        final Op op;
        final long ops;
        final double nsPerOp;
        final long checksum;
        Result(String lang, int bits, Op op, long ops, double nsPerOp, long checksum) {
            this.lang = lang; this.bits = bits; this.op = op; this.ops = ops; this.nsPerOp = nsPerOp; this.checksum = checksum;
        }
        String toJson() {
            return String.format(Locale.ROOT,
                    "{\"lang\":\"%s\",\"bits\":%d,\"op\":\"%s\",\"ops\":%d,\"nsPerOp\":%.3f,\"checksum\":%d}",
                    lang, bits, op.name(), ops, nsPerOp, checksum);
        }
    }

    static long runOnce(Op op, BigInteger[] a, BigInteger[] b, BigInteger[] e, BigInteger mod, int outer) {
        BigInteger acc = BigInteger.ZERO;
        int n = a.length;
        switch (op) {
            case ADD_MOD:
                for (int o = 0; o &lt; outer; o++) {
                    for (int i = 0; i &lt; n; i++) {
                        BigInteger r = a[i].add(b[i]).mod(mod);
                        acc = acc.xor(r);
                    }
                }
                break;

            case MUL_MOD:
                for (int o = 0; o &lt; outer; o++) {
                    for (int i = 0; i &lt; n; i++) {
                        BigInteger r = a[i].multiply(b[i]).mod(mod);
                        acc = acc.xor(r);
                    }
                }
                break;

            case MODPOW:
                // here we use a.length as n; e can be same length
                for (int o = 0; o &lt; outer; o++) {
                    for (int i = 0; i &lt; n; i++) {
                        BigInteger r = a[i].modPow(e[i], mod);
                        acc = acc.xor(r);
                    }
                }
                break;

            default:
                throw new IllegalArgumentException("Unknown op: " + op);
        }
        return acc.longValue();
    }

    static Result bench(String lang, int bits, Op op, BigInteger[] a, BigInteger[] b, BigInteger[] e, BigInteger mod, long targetOps, int warmups, int measures) {
        int n = a.length;
        int outer = (int)Math.max(1, targetOps / n);
        long actualOps = (long)n * outer;

        // warmup
        long ck = 0;
        for (int i = 0; i &lt; warmups; i++) {
            ck ^= runOnce(op, a, b, e, mod, outer);
        }

        long[] times = new long[measures];
        for (int i = 0; i &lt; measures; i++) {
            long t0 = System.nanoTime();
            long c = runOnce(op, a, b, e, mod, outer);
            long t1 = System.nanoTime();
            ck ^= c;
            times[i] = (t1 - t0);
        }
        Arrays.sort(times);
        long median = times[times.length / 2];
        double nsPerOp = (double)median / (double)actualOps;
        return new Result(lang, bits, op, actualOps, nsPerOp, ck);
    }

    static void printHuman(List&lt;Result&gt; results) {
        System.out.println("Java BigInteger benchmark");
        System.out.println("java.version=" + System.getProperty("java.version"));
        System.out.println("java.vm.name=" + System.getProperty("java.vm.name"));
        System.out.println();
        System.out.printf(Locale.ROOT, "%-6s %-9s %-12s %-12s\n", "Bits", "Op", "ns/op(med)", "ops/run");
        for (Result r : results) {
            System.out.printf(Locale.ROOT, "%-6d %-9s %-12.3f %-12d\n", r.bits, r.op.name(), r.nsPerOp, r.ops);
        }
        System.out.println();
        System.out.println("checksum=" + results.stream().mapToLong(x -&gt; x.checksum).reduce(0L, (x,y)-&gt;x^y));
    }

    public static void main(String[] args) {
        boolean json = false;
        for (String a : args) if (a.equals("--json")) json = true;

        int warmups = 5;
        int measures = 11;

        int[] bitSizes = new int[]{256, 1024, 4096};
        List&lt;Result&gt; results = new ArrayList&lt;&gt;();

        for (int bits : bitSizes) {
            BigInteger mod = genModulus(bits, 0xA1B2C3D4E5F60708L ^ bits);

            // add/mul datasets
            int nAddMul = 1024;
            BigInteger[] a = genBigInts(bits, nAddMul, 0x1111222233334444L ^ bits);
            BigInteger[] b = genBigInts(bits, nAddMul, 0x9999AAAABBBBCCCCL ^ bits);

            // modpow datasets (smaller)
            int nPow = 256;
            BigInteger[] ap = genBigInts(bits, nPow, 0x13579BDF2468ACE0L ^ bits);
            BigInteger[] ep = genBigInts(Math.min(bits, 512), nPow, 0x0FEDCBA987654321L ^ bits);

            long addOps;
            long mulOps;
            long powOps;
            if (bits == 256) {
                addOps = 2_000_000L;
                mulOps = 500_000L;
                powOps = 8_000L;
            } else if (bits == 1024) {
                addOps = 1_000_000L;
                mulOps = 120_000L;
                powOps = 1_500L;
            } else {
                addOps = 200_000L;
                mulOps = 20_000L;
                powOps = 250L;
            }

            results.add(bench("java", bits, Op.ADD_MOD, a, b, null, mod, addOps, warmups, measures));
            results.add(bench("java", bits, Op.MUL_MOD, a, b, null, mod, mulOps, warmups, measures));
            results.add(bench("java", bits, Op.MODPOW, ap, null, ep, mod, powOps, warmups, measures));
        }

        if (json) {
            for (Result r : results) System.out.println(r.toJson());
        } else {
            printHuman(results);
        }
    }
}
</code></pre>
<h4 id="net-æºç programcsbiginteger-é¨å">.NET æºç ï¼<code>Program.cs</code>ï¼BigInteger é¨åï¼</h4>
<blockquote>
<p>è¿æ¯âä¸»å¯¹æ¯âç¨ç .NET åºåç¨åºã</p>
</blockquote>
<pre><code class="language-csharp">using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Globalization;
using System.Linq;
using System.Numerics;

sealed class SplitMix64
{
    private ulong _x;
    public SplitMix64(ulong seed) =&gt; _x = seed;

    public ulong NextUInt64()
    {
        ulong z = (_x += 0x9E3779B97F4A7C15UL);
        z = (z ^ (z &gt;&gt; 30)) * 0xBF58476D1CE4E5B9UL;
        z = (z ^ (z &gt;&gt; 27)) * 0x94D049BB133111EBUL;
        return z ^ (z &gt;&gt; 31);
    }

    public void NextBytes(byte[] dst)
    {
        int i = 0;
        while (i &lt; dst.Length)
        {
            ulong v = NextUInt64();
            for (int k = 0; k &lt; 8 &amp;&amp; i &lt; dst.Length; k++)
            {
                dst[i++] = (byte)(v &gt;&gt; (56 - 8 * k)); // big-endian stream
            }
        }
    }
}

enum Op { ADD_MOD, MUL_MOD, MODPOW }

record Result(string Lang, int Bits, Op Op, long Ops, double NsPerOp, long Checksum)
{
    public string ToJson() =&gt; string.Create(CultureInfo.InvariantCulture,
        $"{{\"lang\":\"{Lang}\",\"bits\":{Bits},\"op\":\"{Op}\",\"ops\":{Ops},\"nsPerOp\":{NsPerOp:F3},\"checksum\":{Checksum}}}");
}

static class BigIntBench
{
    static BigInteger[] GenBigInts(int bitSize, int count, ulong seed)
    {
        var rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        var arr = new BigInteger[count];
        var buf = new byte[byteLen];
        int topBit = (bitSize - 1) % 8;
        byte topMask = (byte)(1 &lt;&lt; topBit);

        for (int i = 0; i &lt; count; i++)
        {
            rng.NextBytes(buf);
            buf[0] |= topMask;
            // unsigned + big-endian prevents negative
            arr[i] = new BigInteger(buf, isUnsigned: true, isBigEndian: true);
        }
        return arr;
    }

    static BigInteger GenModulus(int bitSize, ulong seed)
    {
        var rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        var buf = new byte[byteLen];
        rng.NextBytes(buf);
        int topBit = (bitSize - 1) % 8;
        buf[0] |= (byte)(1 &lt;&lt; topBit);
        buf[^1] |= 1; // odd
        return new BigInteger(buf, isUnsigned: true, isBigEndian: true);
    }

    static long RunOnce(Op op, BigInteger[] a, BigInteger[] b, BigInteger[] e, BigInteger mod, int outer)
    {
        BigInteger acc = BigInteger.Zero;
        int n = a.Length;

        switch (op)
        {
            case Op.ADD_MOD:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                    {
                        var r = (a[i] + b[i]) % mod;
                        acc ^= r;
                    }
                break;

            case Op.MUL_MOD:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                    {
                        var r = (a[i] * b[i]) % mod;
                        acc ^= r;
                    }
                break;

            case Op.MODPOW:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                    {
                        var r = BigInteger.ModPow(a[i], e[i], mod);
                        acc ^= r;
                    }
                break;
        }

        return (long)(acc &amp; long.MaxValue); // stable checksum
    }

    static Result Bench(string lang, int bits, Op op, BigInteger[] a, BigInteger[] b, BigInteger[] e, BigInteger mod, long targetOps, int warmups, int measures)
    {
        int n = a.Length;
        int outer = (int)Math.Max(1, targetOps / n);
        long actualOps = (long)n * outer;

        long ck = 0;
        for (int i = 0; i &lt; warmups; i++)
            ck ^= RunOnce(op, a, b, e, mod, outer);

        long[] timesNs = new long[measures];
        for (int i = 0; i &lt; measures; i++)
        {
            var sw = Stopwatch.StartNew();
            long c = RunOnce(op, a, b, e, mod, outer);
            sw.Stop();
            ck ^= c;
            // Stopwatch ticks to ns
            timesNs[i] = (long)(sw.ElapsedTicks * (1_000_000_000.0 / Stopwatch.Frequency));
        }

        Array.Sort(timesNs);
        long median = timesNs[timesNs.Length / 2];
        double nsPerOp = (double)median / actualOps;
        return new Result(lang, bits, op, actualOps, nsPerOp, ck);
    }

    static void PrintHuman(List&lt;Result&gt; results)
    {
        Console.WriteLine("C# BigInteger benchmark");
        Console.WriteLine($"dotnet.version={Environment.Version}");
        Console.WriteLine($"os={System.Runtime.InteropServices.RuntimeInformation.OSDescription}");
        Console.WriteLine($"arch={System.Runtime.InteropServices.RuntimeInformation.OSArchitecture}");
        Console.WriteLine();
        Console.WriteLine($"{ "Bits",-6} {"Op",-9} {"ns/op(med)",-12} {"ops/run",-12}");
        foreach (var r in results)
            Console.WriteLine(string.Create(CultureInfo.InvariantCulture, $"{r.Bits,-6} {r.Op,-9} {r.NsPerOp,-12:F3} {r.Ops,-12}"));
        Console.WriteLine();
        long checksum = 0;
        foreach (var r in results) checksum ^= r.Checksum;
        Console.WriteLine($"checksum={checksum}");
    }

    public static int Main(string[] args)
    {
        bool json = args.Any(a =&gt; a == "--json");

        int warmups = 5;
        int measures = 11;
        int[] bitSizes = [256, 1024, 4096];

        var results = new List&lt;Result&gt;();

        foreach (int bits in bitSizes)
        {
            var mod = GenModulus(bits, 0xA1B2C3D4E5F60708UL ^ (uint)bits);

            int nAddMul = 1024;
            var a = GenBigInts(bits, nAddMul, 0x1111222233334444UL ^ (uint)bits);
            var b = GenBigInts(bits, nAddMul, 0x9999AAAABBBBCCCCUL ^ (uint)bits);

            int nPow = 256;
            var ap = GenBigInts(bits, nPow, 0x13579BDF2468ACE0UL ^ (uint)bits);
            var ep = GenBigInts(Math.Min(bits, 512), nPow, 0x0FEDCBA987654321UL ^ (uint)bits);

            long addOps = bits switch { 256 =&gt; 2_000_000L, 1024 =&gt; 1_000_000L, _ =&gt; 200_000L };
            long mulOps = bits switch { 256 =&gt; 500_000L, 1024 =&gt; 120_000L, _ =&gt; 20_000L };
            long powOps = bits switch { 256 =&gt; 8_000L, 1024 =&gt; 1_500L, _ =&gt; 250L };

            results.Add(Bench("csharp", bits, Op.ADD_MOD, a, b, null!, mod, addOps, warmups, measures));
            results.Add(Bench("csharp", bits, Op.MUL_MOD, a, b, null!, mod, mulOps, warmups, measures));
            results.Add(Bench("csharp", bits, Op.MODPOW, ap, null!, ep, mod, powOps, warmups, measures));
        }

        if (json)
        {
            foreach (var r in results) Console.WriteLine(r.ToJson());
        }
        else
        {
            PrintHuman(results);
        }

        return 0;
    }
}
</code></pre>
<h3 id="32-è¿è¡æ¹å¼å¯å¤ç°å½ä»¤">3.2 è¿è¡æ¹å¼ï¼å¯å¤ç°å½ä»¤ï¼</h3>
<pre><code class="language-bash"># Java 21
cd /app/bigintbench/java
javac BigIntBench.java
java -Xms1g -Xmx1g -XX:+UseG1GC -XX:+AlwaysPreTouch BigIntBench --json

# .NET 10
cd /app/bigintbench/csharp
dotnet build -c Release
DOTNET_GCServer=1 dotnet run -c Release -- --json
</code></pre>
<h3 id="33-å®éªä¸åå§è¾åºjsonl">3.3 å®éªä¸åå§è¾åºï¼JSONLï¼</h3>
<h4 id="java-21results_java21jsonl">Java 21ï¼<code>results_java21.jsonl</code></h4>
<pre><code class="language-jsonl">{"lang":"java","bits":256,"op":"ADD_MOD","ops":1999872,"nsPerOp":139.589,"checksum":0}
{"lang":"java","bits":256,"op":"MUL_MOD","ops":499712,"nsPerOp":387.031,"checksum":0}
{"lang":"java","bits":256,"op":"MODPOW","ops":7936,"nsPerOp":17764.884,"checksum":0}
{"lang":"java","bits":1024,"op":"ADD_MOD","ops":999424,"nsPerOp":284.672,"checksum":0}
{"lang":"java","bits":1024,"op":"MUL_MOD","ops":119808,"nsPerOp":3094.540,"checksum":0}
{"lang":"java","bits":1024,"op":"MODPOW","ops":1280,"nsPerOp":264577.852,"checksum":0}
{"lang":"java","bits":4096,"op":"ADD_MOD","ops":199680,"nsPerOp":900.735,"checksum":0}
{"lang":"java","bits":4096,"op":"MUL_MOD","ops":19456,"nsPerOp":32062.554,"checksum":0}
{"lang":"java","bits":4096,"op":"MODPOW","ops":256,"nsPerOp":3422756.113,"checksum":0}
</code></pre>
<h4 id="net-10results_csharpjsonl">.NET 10ï¼<code>results_csharp.jsonl</code></h4>
<pre><code class="language-jsonl">{"lang":"csharp","bits":256,"op":"ADD_MOD","ops":1999872,"nsPerOp":146.261,"checksum":0}
{"lang":"csharp","bits":256,"op":"MUL_MOD","ops":499712,"nsPerOp":560.246,"checksum":0}
{"lang":"csharp","bits":256,"op":"MODPOW","ops":7936,"nsPerOp":169713.608,"checksum":0}
{"lang":"csharp","bits":1024,"op":"ADD_MOD","ops":999424,"nsPerOp":297.335,"checksum":0}
{"lang":"csharp","bits":1024,"op":"MUL_MOD","ops":119808,"nsPerOp":4792.760,"checksum":0}
{"lang":"csharp","bits":1024,"op":"MODPOW","ops":1280,"nsPerOp":1938407.720,"checksum":0}
{"lang":"csharp","bits":4096,"op":"ADD_MOD","ops":199680,"nsPerOp":1280.760,"checksum":0}
{"lang":"csharp","bits":4096,"op":"MUL_MOD","ops":19456,"nsPerOp":36894.568,"checksum":0}
{"lang":"csharp","bits":4096,"op":"MODPOW","ops":256,"nsPerOp":20617970.004,"checksum":0}
</code></pre>
<hr>
<h2 id="å®éªäºå å¥-java-8-çç°ç¶ä¸»æµå¤äºä»ä¹ä½ç½®">å®éªäºï¼å å¥ Java 8 ââçâç°ç¶ä¸»æµâå¤äºä»ä¹ä½ç½®</h2>
<p>è¿ä¸ç»çå³é®ç¹æ¯ï¼<strong>åä¸ä»½ Java æºç ç¨ Java 8 ç¼è¯</strong>ï¼åå«å¨ Java 8 ä¸ Java 21 ä¸è¿è¡ï¼å°½éé¿åâç¼è¯å¨äº§ç©å·®å¼âã</p>
<h3 id="41-è¿è¡æ¹å¼">4.1 è¿è¡æ¹å¼</h3>
<pre><code class="language-bash"># ç¼è¯ï¼Java 8ï¼
/path/to/jdk8/bin/javac BigIntBench.java

# è¿è¡ï¼Java 8ï¼
/path/to/jdk8/bin/java -Xms1g -Xmx1g -XX:+UseG1GC -XX:+AlwaysPreTouch BigIntBench --json

# è¿è¡ï¼Java 21ï¼
java -Xms1g -Xmx1g -XX:+UseG1GC -XX:+AlwaysPreTouch BigIntBench --json
</code></pre>
<h3 id="42-å®éªäºåå§è¾åºjsonl">4.2 å®éªäºåå§è¾åºï¼JSONLï¼</h3>
<h4 id="java-8results_java8jsonl">Java 8ï¼<code>results_java8.jsonl</code></h4>
<pre><code class="language-jsonl">{"lang":"java","bits":256,"op":"ADD_MOD","ops":1999872,"nsPerOp":207.335,"checksum":0}
{"lang":"java","bits":256,"op":"MUL_MOD","ops":499712,"nsPerOp":468.248,"checksum":0}
{"lang":"java","bits":256,"op":"MODPOW","ops":7936,"nsPerOp":17697.113,"checksum":0}
{"lang":"java","bits":1024,"op":"ADD_MOD","ops":999424,"nsPerOp":390.906,"checksum":0}
{"lang":"java","bits":1024,"op":"MUL_MOD","ops":119808,"nsPerOp":3089.474,"checksum":0}
{"lang":"java","bits":1024,"op":"MODPOW","ops":1280,"nsPerOp":277395.652,"checksum":0}
{"lang":"java","bits":4096,"op":"ADD_MOD","ops":199680,"nsPerOp":990.708,"checksum":0}
{"lang":"java","bits":4096,"op":"MUL_MOD","ops":19456,"nsPerOp":30692.214,"checksum":0}
{"lang":"java","bits":4096,"op":"MODPOW","ops":256,"nsPerOp":3468269.539,"checksum":0}
</code></pre>
<hr>
<h2 id="å¯è§åä¸æ»ç»">å¯è§åä¸æ»ç»</h2>
<p>ä»ä¸ä¸ª .NET ç¨åºåçè§è§æ¥çï¼è¿æ¬¡çæµè¯ç»æå¯ä»¥è¯´æ¢å¨æçä¹ä¸­ï¼åæäºåºä¹ææã</p>
<ol>
<li><strong>ADD_MOD (å æ³+åæ¨¡)</strong>: å¨è¿ä¸ªé¡¹ç®ä¸ï¼.NET å Java 21 å ä¹æäºä¸ªå¹³æï¼å·®è·å¾®ä¹å¶å¾®ãå¯ä»¥è¯´ï¼å¨åºç¡çå æ³è¿ç®ä¸ï¼.NET è¡¨ç°å¾ç¸å½ä¸éã<br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260114225530983-1114904260.png" alt="bar_csharp_baseline_add_mod" loading="lazy"></li>
<li><strong>MUL_MOD (ä¹æ³+åæ¨¡)</strong>: ä»è¿éå¼å§ï¼å·®è·åºç°äºã.NET ææ¾æ¢äº Javaï¼æ§è½é¸¿æ²å¼å§åå¾âèç¼å¯è§âã<br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260114225554833-1748112213.png" alt="bar_csharp_baseline_mul_mod" loading="lazy"></li>
<li><strong>MODPOW (æ¨¡å¹)</strong>: è¿æ¯å·®è·æå¤§çå°æ¹ã.NET å¨è¿é¡¹æµè¯ä¸­è¢« Java 21 æå¼äº <strong>6å°9å</strong> çå·®è·ãå¯¹äºä»äºå¯ç å­¦æéè¦å¤§éå¤§æ°è¿ç®çå¼åèæ¥è¯´ï¼è¿æ¯ä¸ä¸ªéå¸¸åºç¼çä¿¡å·ã<br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260114225547260-463566788.png" alt="bar_csharp_baseline_modpow" loading="lazy"></li>
<li><strong>Java 8 vs Java 21</strong>: æ¯«æ çé®ï¼Java 21 å¨ç»å¤§å¤æ°æåµä¸é½æ¯èè¿ç Java 8 è¦å¿«ãä¸è¿æè¶£çæ¯ï¼å¨ <code>MUL_MOD</code> ç 1024 å 4096 ä½æµè¯ä¸­ï¼Java 8 å±ç¶åºç°äºâåè¶âçç°è±¡ãè¿å¯è½æ¯ç±äº JIT ç­ç¥ãç®æ³éæ©çéå¼å·®å¼ï¼ææ¯åçº¯çæµéè¯¯å·®ãè½ç¶è¿ä¸å½±åâJava 21æ´å¿«âçæ»ä½ç»è®ºï¼ä½ä¹æéæä»¬æ§è½æµè¯çå¤ææ§ã</li>
</ol>
<p>æ»èè¨ä¹ï¼è¿æ¬¡å¯¹å³è®©æä»¬æ¸æ¥å°çå°ï¼å¨å¤æçå¤§æ°è¿ç®ä¸ï¼.NET ç <code>BigInteger</code> ç¡®å®è¿æå¾é¿çè·¯è¦èµ°ã</p>
<hr>
<h2 id="one-more-thingå½å¤æ´ç»åº">One More Thingï¼å½âå¤æ´âç»åº</h2>
<p>å¨å¯»æ¾ .NET å¤§æ°æ§è½ä¼åæ¹æ¡çè¿ç¨ä¸­ï¼æä»¬èªç¶è½æ³å°äºä¸çæ æ GMP ââå®æ¯ GNU Multi-Precision Arithmetic Libraryï¼å¾å¤æ°å­¦è½¯ä»¶/å¯ç å­¦å®ç°é½ä¼ç¨å®åé«æ§è½å¤§æ´æ°è¿ç®ã</p>
<p>æç¢°å·§ä¹ä¸ºå®åäºä¸ä¸ª .NET å°è£ï¼<a href="https://github.com/sdcb/Sdcb.Arithmetic" target="_blank" rel="noopener nofollow">Sdcb.Arithmetic</a>ã</p>
<p>ä½å¿é¡»æåå£°æï¼<strong>è®© GMP ä½ä¸ºâå¤æ´âå å¥è¿åºå¯¹æ¯ï¼æ¯âä¸å¬å¹³âç</strong>ãåå å¾ç®åï¼</p>
<ul>
<li><strong>è¯­è¨ä¼å¿</strong>ï¼GMP æ¯åç C/æ±ç¼ï¼è .NET å Java æ¯å¨èææºä¸è¿è¡çæç®¡è¯­è¨ã</li>
<li><strong>åå­ç­ç¥</strong>ï¼GMP é¼å±ä½¿ç¨ <strong>in-place API</strong>ï¼å¯ä»¥ç´æ¥å¨åå°ä¿®æ¹æ°å¼ï¼å¤§å¤§åå°äºåå­åéå GC ååãè .NET å Java ç <code>BigInteger</code> åæ¯ä¸å¯åå¯¹è±¡ã</li>
</ul>
<p>æä»¥ï¼è¿é¨åçç»ææ´åæ¯ä¸ä¸ªâå½©èâï¼å±ç¤ºçæ¯ï¼<strong>å¦æä½ æ¿æå¼å¥åçä¾èµï¼å¹¶æ¹åç¼ç é£æ ¼ï¼.NET çå¤§æ°æ§è½å¯ä»¥è¾¾å°ææ ·çé«åº¦ã</strong></p>
<h3 id="71-å®¢ä¸²å®éªå®æ´æºä»£ç net-biginteger--gmpinteger-ååº">7.1 å®¢ä¸²å®éªå®æ´æºä»£ç ï¼.NET BigInteger + GmpInteger ååºï¼</h3>
<blockquote>
<p>ä¸é¢ä»£ç ä¼åæ¶è¾åºä¸¤å¥ç»æï¼<code>csharp_bigint</code> ä¸ <code>csharp_gmp_inplace</code>ï¼ä»æ¯ JSONLï¼ã</p>
</blockquote>
<p><strong><code>Program.cs</code>ï¼å®¢ä¸²çï¼å®æ´ï¼</strong></p>
<pre><code class="language-csharp">using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Globalization;
using System.Linq;
using System.Numerics;
using Sdcb.Arithmetic.Gmp;

sealed class SplitMix64
{
    private ulong _x;
    public SplitMix64(ulong seed) =&gt; _x = seed;

    public ulong NextUInt64()
    {
        ulong z = (_x += 0x9E3779B97F4A7C15UL);
        z = (z ^ (z &gt;&gt; 30)) * 0xBF58476D1CE4E5B9UL;
        z = (z ^ (z &gt;&gt; 27)) * 0x94D049BB133111EBUL;
        return z ^ (z &gt;&gt; 31);
    }

    public void NextBytes(byte[] dst)
    {
        int i = 0;
        while (i &lt; dst.Length)
        {
            ulong v = NextUInt64();
            for (int k = 0; k &lt; 8 &amp;&amp; i &lt; dst.Length; k++)
                dst[i++] = (byte)(v &gt;&gt; (56 - 8 * k));
        }
    }
}

enum Op { ADD_MOD, MUL_MOD, MODPOW }

record Result(string Impl, int Bits, Op Op, long Ops, double NsPerOp, long Checksum)
{
    public string ToJson() =&gt; string.Create(CultureInfo.InvariantCulture,
        $"{{\"lang\":\"{Impl}\",\"bits\":{Bits},\"op\":\"{Op}\",\"ops\":{Ops},\"nsPerOp\":{NsPerOp:F3},\"checksum\":{Checksum}}}");
}

static class BenchUtil
{
    public static void MaskToBitSize(byte[] buf, int bitSize)
    {
        int topBit = (bitSize - 1) % 8;
        int keepBits = topBit + 1;
        int firstMask = keepBits == 8 ? 0xFF : ((1 &lt;&lt; keepBits) - 1);
        buf[0] &amp;= (byte)firstMask;
        buf[0] |= (byte)(1 &lt;&lt; topBit);
    }

    public static string ToHex(byte[] bytes) =&gt; Convert.ToHexString(bytes);
}

static class BigIntegerBench
{
    public static BigInteger[] Gen(int bitSize, int count, ulong seed)
    {
        var rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        var arr = new BigInteger[count];
        var buf = new byte[byteLen];

        for (int i = 0; i &lt; count; i++)
        {
            rng.NextBytes(buf);
            BenchUtil.MaskToBitSize(buf, bitSize);
            arr[i] = new BigInteger(buf, isUnsigned: true, isBigEndian: true);
        }
        return arr;
    }

    public static BigInteger GenModulus(int bitSize, ulong seed)
    {
        var rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        var buf = new byte[byteLen];
        rng.NextBytes(buf);
        BenchUtil.MaskToBitSize(buf, bitSize);
        buf[^1] |= 1;
        return new BigInteger(buf, isUnsigned: true, isBigEndian: true);
    }

    public static long RunOnce(Op op, BigInteger[] a, BigInteger[] b, BigInteger[] e, BigInteger mod, int outer)
    {
        BigInteger acc = BigInteger.Zero;
        int n = a.Length;

        switch (op)
        {
            case Op.ADD_MOD:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                        acc ^= (a[i] + b[i]) % mod;
                break;

            case Op.MUL_MOD:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                        acc ^= (a[i] * b[i]) % mod;
                break;

            case Op.MODPOW:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                        acc ^= BigInteger.ModPow(a[i], e[i], mod);
                break;
        }

        return (long)(acc &amp; long.MaxValue);
    }
}

static class GmpIntegerBench
{
    public static GmpInteger[] Gen(int bitSize, int count, ulong seed)
    {
        var rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        var arr = new GmpInteger[count];
        var buf = new byte[byteLen];

        for (int i = 0; i &lt; count; i++)
        {
            rng.NextBytes(buf);
            BenchUtil.MaskToBitSize(buf, bitSize);
            arr[i] = GmpInteger.Parse(BenchUtil.ToHex(buf), 16);
        }
        return arr;
    }

    public static GmpInteger GenModulus(int bitSize, ulong seed)
    {
        var rng = new SplitMix64(seed);
        int byteLen = (bitSize + 7) / 8;
        var buf = new byte[byteLen];
        rng.NextBytes(buf);
        BenchUtil.MaskToBitSize(buf, bitSize);
        buf[^1] |= 1;
        return GmpInteger.Parse(BenchUtil.ToHex(buf), 16);
    }

    public static long RunOnce(Op op, GmpInteger[] a, GmpInteger[] b, GmpInteger[] e, GmpInteger mod, int outer)
    {
        using var acc = GmpInteger.From(0);
        using var tmp = GmpInteger.From(0);

        int n = a.Length;
        switch (op)
        {
            case Op.ADD_MOD:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                    {
                        GmpInteger.AddInplace(tmp, a[i], b[i]);
                        GmpInteger.ModInplace(tmp, tmp, mod);
                        GmpInteger.BitwiseXorInplace(acc, acc, tmp);
                    }
                break;

            case Op.MUL_MOD:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                    {
                        GmpInteger.MultiplyInplace(tmp, a[i], b[i]);
                        GmpInteger.ModInplace(tmp, tmp, mod);
                        GmpInteger.BitwiseXorInplace(acc, acc, tmp);
                    }
                break;

            case Op.MODPOW:
                for (int o = 0; o &lt; outer; o++)
                    for (int i = 0; i &lt; n; i++)
                    {
                        GmpInteger.PowerModInplace(tmp, a[i], e[i], mod);
                        GmpInteger.BitwiseXorInplace(acc, acc, tmp);
                    }
                break;
        }

        return acc.GetHashCode();
    }

    public static void DisposeAll(GmpInteger[] xs)
    {
        foreach (var x in xs) x.Dispose();
    }
}

static class Runner
{
    static Result BenchBigInteger(int bits, Op op, BigInteger[] a, BigInteger[] b, BigInteger[] e, BigInteger mod, long targetOps, int warmups, int measures)
    {
        int n = a.Length;
        int outer = (int)Math.Max(1, targetOps / n);
        long actualOps = (long)n * outer;

        long ck = 0;
        for (int i = 0; i &lt; warmups; i++) ck ^= BigIntegerBench.RunOnce(op, a, b, e, mod, outer);

        long[] timesNs = new long[measures];
        for (int i = 0; i &lt; measures; i++)
        {
            var sw = Stopwatch.StartNew();
            long c = BigIntegerBench.RunOnce(op, a, b, e, mod, outer);
            sw.Stop();
            ck ^= c;
            timesNs[i] = (long)(sw.ElapsedTicks * (1_000_000_000.0 / Stopwatch.Frequency));
        }
        Array.Sort(timesNs);
        long median = timesNs[timesNs.Length / 2];
        return new Result("csharp_bigint", bits, op, actualOps, (double)median / actualOps, ck);
    }

    static Result BenchGmpInteger(int bits, Op op, GmpInteger[] a, GmpInteger[] b, GmpInteger[] e, GmpInteger mod, long targetOps, int warmups, int measures)
    {
        int n = a.Length;
        int outer = (int)Math.Max(1, targetOps / n);
        long actualOps = (long)n * outer;

        long ck = 0;
        for (int i = 0; i &lt; warmups; i++) ck ^= GmpIntegerBench.RunOnce(op, a, b, e, mod, outer);

        long[] timesNs = new long[measures];
        for (int i = 0; i &lt; measures; i++)
        {
            var sw = Stopwatch.StartNew();
            long c = GmpIntegerBench.RunOnce(op, a, b, e, mod, outer);
            sw.Stop();
            ck ^= c;
            timesNs[i] = (long)(sw.ElapsedTicks * (1_000_000_000.0 / Stopwatch.Frequency));
        }
        Array.Sort(timesNs);
        long median = timesNs[timesNs.Length / 2];
        return new Result("csharp_gmp_inplace", bits, op, actualOps, (double)median / actualOps, ck);
    }

    public static int Run(string[] args)
    {
        bool json = args.Any(a =&gt; a == "--json");

        int warmups = 5;
        int measures = 11;
        int[] bitSizes = [256, 1024, 4096];

        var results = new List&lt;Result&gt;();

        foreach (int bits in bitSizes)
        {
            long addOps = bits switch { 256 =&gt; 2_000_000L, 1024 =&gt; 1_000_000L, _ =&gt; 200_000L };
            long mulOps = bits switch { 256 =&gt; 500_000L, 1024 =&gt; 120_000L, _ =&gt; 20_000L };
            long powOps = bits switch { 256 =&gt; 8_000L, 1024 =&gt; 1_500L, _ =&gt; 250L };

            // BigInteger data
            var modB = BigIntegerBench.GenModulus(bits, 0xA1B2C3D4E5F60708UL ^ (uint)bits);
            var aB = BigIntegerBench.Gen(bits, 1024, 0x1111222233334444UL ^ (uint)bits);
            var bB = BigIntegerBench.Gen(bits, 1024, 0x9999AAAABBBBCCCCUL ^ (uint)bits);
            var apB = BigIntegerBench.Gen(bits, 256, 0x13579BDF2468ACE0UL ^ (uint)bits);
            var epB = BigIntegerBench.Gen(Math.Min(bits, 512), 256, 0x0FEDCBA987654321UL ^ (uint)bits);

            // GmpInteger data (same seeds/bit sizes)
            using var modG = GmpIntegerBench.GenModulus(bits, 0xA1B2C3D4E5F60708UL ^ (uint)bits);
            var aG = GmpIntegerBench.Gen(bits, 1024, 0x1111222233334444UL ^ (uint)bits);
            var bG = GmpIntegerBench.Gen(bits, 1024, 0x9999AAAABBBBCCCCUL ^ (uint)bits);
            var apG = GmpIntegerBench.Gen(bits, 256, 0x13579BDF2468ACE0UL ^ (uint)bits);
            var epG = GmpIntegerBench.Gen(Math.Min(bits, 512), 256, 0x0FEDCBA987654321UL ^ (uint)bits);

            try
            {
                results.Add(BenchBigInteger(bits, Op.ADD_MOD, aB, bB, null!, modB, addOps, warmups, measures));
                results.Add(BenchBigInteger(bits, Op.MUL_MOD, aB, bB, null!, modB, mulOps, warmups, measures));
                results.Add(BenchBigInteger(bits, Op.MODPOW, apB, null!, epB, modB, powOps, warmups, measures));

                results.Add(BenchGmpInteger(bits, Op.ADD_MOD, aG, bG, null!, modG, addOps, warmups, measures));
                results.Add(BenchGmpInteger(bits, Op.MUL_MOD, aG, bG, null!, modG, mulOps, warmups, measures));
                results.Add(BenchGmpInteger(bits, Op.MODPOW, apG, null!, epG, modG, powOps, warmups, measures));
            }
            finally
            {
                GmpIntegerBench.DisposeAll(aG);
                GmpIntegerBench.DisposeAll(bG);
                GmpIntegerBench.DisposeAll(apG);
                GmpIntegerBench.DisposeAll(epG);
            }
        }

        if (json)
        {
            foreach (var r in results) Console.WriteLine(r.ToJson());
        }

        return 0;
    }
}

public static class Program
{
    public static int Main(string[] args) =&gt; Runner.Run(args);
}
</code></pre>
<p><strong><code>gmpbench.csproj</code>ï¼å®¢ä¸²çé¡¹ç®æä»¶ï¼</strong></p>
<pre><code class="language-xml">&lt;Project Sdk="Microsoft.NET.Sdk"&gt;
  &lt;PropertyGroup&gt;
    &lt;OutputType&gt;Exe&lt;/OutputType&gt;
    &lt;TargetFramework&gt;net10.0&lt;/TargetFramework&gt;
    &lt;Nullable&gt;enable&lt;/Nullable&gt;
    &lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include="Sdcb.Arithmetic.Gmp" Version="*" /&gt;
    &lt;PackageReference Include="Sdcb.Arithmetic.Gmp.runtime.linux-x64" Version="*" /&gt;
  &lt;/ItemGroup&gt;
&lt;/Project&gt;
</code></pre>
<h3 id="72-å®¢ä¸²å®éªåå§è¾åºjsonl">7.2 å®¢ä¸²å®éªåå§è¾åºï¼JSONLï¼</h3>
<pre><code class="language-jsonl">{"lang":"csharp_bigint","bits":256,"op":"ADD_MOD","ops":1999872,"nsPerOp":146.261,"checksum":0}
{"lang":"csharp_bigint","bits":256,"op":"MUL_MOD","ops":499712,"nsPerOp":560.246,"checksum":0}
{"lang":"csharp_bigint","bits":256,"op":"MODPOW","ops":7936,"nsPerOp":169713.608,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":256,"op":"ADD_MOD","ops":1999872,"nsPerOp":76.644,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":256,"op":"MUL_MOD","ops":499712,"nsPerOp":114.690,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":256,"op":"MODPOW","ops":7936,"nsPerOp":13931.914,"checksum":0}
{"lang":"csharp_bigint","bits":1024,"op":"ADD_MOD","ops":999424,"nsPerOp":297.335,"checksum":0}
{"lang":"csharp_bigint","bits":1024,"op":"MUL_MOD","ops":119808,"nsPerOp":4792.760,"checksum":0}
{"lang":"csharp_bigint","bits":1024,"op":"MODPOW","ops":1280,"nsPerOp":1938407.720,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":1024,"op":"ADD_MOD","ops":999424,"nsPerOp":97.260,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":1024,"op":"MUL_MOD","ops":119808,"nsPerOp":562.235,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":1024,"op":"MODPOW","ops":1280,"nsPerOp":218715.147,"checksum":0}
{"lang":"csharp_bigint","bits":4096,"op":"ADD_MOD","ops":199680,"nsPerOp":1280.760,"checksum":0}
{"lang":"csharp_bigint","bits":4096,"op":"MUL_MOD","ops":19456,"nsPerOp":36894.568,"checksum":0}
{"lang":"csharp_bigint","bits":4096,"op":"MODPOW","ops":256,"nsPerOp":20617970.004,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":4096,"op":"ADD_MOD","ops":199680,"nsPerOp":179.720,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":4096,"op":"MUL_MOD","ops":19456,"nsPerOp":5431.441,"checksum":0}
{"lang":"csharp_gmp_inplace","bits":4096,"op":"MODPOW","ops":256,"nsPerOp":2662198.492,"checksum":0}
</code></pre>
<h3 id="73-å®¢ä¸²å¯è§åä»¥gmpä¸ºåºå">7.3 å®¢ä¸²å¯è§åï¼ä»¥GMPä¸ºåºåï¼</h3>
<p><img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260114225617406-1423853952.png" alt="bar_gmp_baseline_add_mod" loading="lazy"><br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260114225622152-863625745.png" alt="bar_gmp_baseline_mul_mod" loading="lazy"><br>
<img src="https://img2024.cnblogs.com/blog/233608/202601/233608-20260114225625327-2119127781.png" alt="bar_gmp_baseline_modpow" loading="lazy"></p>
<hr>
<h2 id="æ»ç»ä¸å±æ">æ»ç»ä¸å±æ</h2>
<p>ä»è¿æ¬¡âç¡¬ç¢°ç¡¬âçå¯¹å³ä¸­ï¼æä»¬å¯ä»¥æ¸æ°å°çå°ï¼å¨åºç¡å æ³ä¸ï¼.NET <code>BigInteger</code> ä¸ Java ä¸åä¼¯ä»²ï¼ä½å¨ä¹æ³ï¼å°¤å¶æ¯<strong>æ¨¡å¹è¿ç®</strong>ï¼å¯¹å¯ç å­¦ç­åºæ¯æå¶éè¦ï¼ä¸ï¼.NET ç®åç¡®å®å­å¨ææ¾çç­æ¿ï¼å¤§å¹è½åäº Javaã</p>
<p>æ¿è®¤ä¸è¶³æ¯æ¹è¿çå¼å§ãå¯¹äºç»å¤§å¤æ°ä¸å¡åºæ¯ï¼åç½®ç <code>BigInteger</code> ä¾ç¶å¤ç¨ä¸æ¹ä¾¿ãä½å¦æä½ çåºç¨å¤äºæ§è½ææåºï¼å¦å å¯ç®æ³ãç§å­¦è®¡ç®ï¼ï¼é£ä¹ä¹è®¸æ¯æ¶åèèä¸äºâéæ­¦å¨âäºã</p>
<p>è¿ä¹æ­£æ¯æå¼åå¹¶ç»´æ¤ <strong><a href="https://github.com/sdcb/Sdcb.Arithmetic" target="_blank" rel="noopener nofollow">Sdcb.Arithmetic</a></strong> çåè¡·ãå®éè¿å°è£ GMP ç­é«æ§è½åçåºï¼ä¸º .NET å¸¦æ¥äº<strong>åå°ä¿®æ¹ï¼in-placeï¼</strong>ä»¥åé«è¾¾æ°åçæ§è½æåï¼å¦æä¸­å®éªæç¤ºï¼ãå¦æä½ å¯¹æ§è½ææè´è¿½æ±ï¼æèæ³çç .NET å¨å¤§æ°è®¡ç®ä¸çæéï¼æ¬¢è¿å» GitHub ç¹ä¸ª Star â­ï¼è¯ä¸è¯è¿ä¸ªåºã</p>
<p>æè°¢éè¯»ï¼å¦æä½ è§å¾è¿ä¸¤ä¸ªè¯­è¨çå¯¹æ¯åææææï¼æèå¯¹ .NET é«æ§è½ç¼ç¨æå´è¶£ï¼æ¬¢è¿å¨è¯è®ºåºçè¨äº¤æµï¼ä¹æ¬¢è¿å å¥æç <strong>.NETéªæä½ QQç¾¤ï¼495782587</strong>ï¼æä»¬ä¸èµ·æ¢ç´¢æ´å¤ææ¯ç¡¬æ ¸ç©æ³ã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-15 08:50">2026-01-15 08:50</span>&nbsp;
<a href="https://www.cnblogs.com/sdcb">.NETéªæä½</a>&nbsp;
éè¯»(<span id="post_view_count">626</span>)&nbsp;
è¯è®º(<span id="post_comment_count">8</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19484525);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19484525', targetLink: 'https://www.cnblogs.com/sdcb/p/19484525/20261113-big-integer-dotnet-10-vs-java', title: 'ä¸æè·ä¸ªåï¼.NET 10 å¤§æ´æ°è®¡ç®å¯¹éµ Javaï¼ç»æä»¤äººæå¤' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½ï¼Windows/Linuxï¼ ]]></title>
    <link>https://www.cnblogs.com/tokepson/p/19358930</link>
    <guid>bec0490eaf43fd73090bf6e88fb55e04</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/tokepson/p/19358930" title="åå¸äº 2026-01-15 00:58">
    <span role="heading" aria-level="2">Mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½ï¼Windows/Linuxï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/3027557/202601/3027557-20260115005726963-1064528741.png" alt="Mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½ï¼Windows/Linuxï¼" class="desc_img">
        ### Mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½ï¼Windows/Linuxï¼

&gt;åè¨ï¼
åååï¼ï¼ï¼ä¸å¤è¯´äºï¼ç´æ¥çæ­£æå§

### Windows
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h3 id="mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½windowslinux">Mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½ï¼Windows/Linuxï¼</h3>
<blockquote>
<p>åè¨ï¼<br>
åååï¼ï¼ï¼ä¸å¤è¯´äºï¼ç´æ¥çæ­£æå§</p>
</blockquote>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202601/3027557-20260115005731844-1896204594.jpg" alt="20160513024330_39701" loading="lazy"></p>
<h3 id="windows">Windows</h3>
<p><em>ç¸å³æç¨ï¼</em> <a href="https://blog.csdn.net/R_Feynman_/article/details/147523049" target="_blank" rel="noopener nofollow">ç¬¬ä¸éï¼MySQLä¸è½½è¶ç»æç¨ï¼è¯¦ç»å°æ¯ä¸å°æ­¥ï¼</a></p>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216182550108-1208756501.png" alt="image" width="800" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216182516662-1356207044.png" alt="image" width="800" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216182251339-1241286922.png" alt="image" width="800" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216182213741-1061580300.png" alt="image" width="800" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216182006041-375477595.png" alt="image" width="800" loading="lazy"></p>
<p>ï¼æ²¡æå®ï¼æå¾æäºï¼ç­ä¸æ¬¡åç¢°å°åè¡¥ä¸å§ï¼ç´¯äºï¼å°æ¶ååè¡¥åäºMySQLå¸¸ç¨å½ä»¤ï¼ä»¥åä¸äºå¯è½ä¼åºç°çæ¼æ´ââââä¸è¬æ¥è®²æ­£å¸¸å®è£å°±è¡ï¼åªå¨å®¢æ·æºä½¿ç¨Customï¼æå¡å¨ä½¿ç¨ç¨Serverï¼é½å®è£å°±ç¨Fullï¼åé¢åå¡«åç¨æ·åå¯ç å³å¯ï¼å¶ä»æç¨ä¹æåè¯¦ç»è§£éï¼</p>
<hr>
<h3 id="linuxubuntu">Linuxï¼Ubuntuï¼</h3>
<p><em>ç¸å³æç¨ï¼</em> <a href="https://www.cnblogs.com/zhuchunlin/p/18562893" target="_blank">MySQL - ä¸è½½ä¸å®è£éç½®ï¼Linuxï¼</a></p>
<pre><code class="language-bash">sudo apt-get update
</code></pre>
<pre><code class="language-bash">sudo apt-get install -y mysql-server mysql-client
</code></pre>
<pre><code class="language-bash">sudo vi /etc/mysql/mysql.conf.d/mysqld.cnf
</code></pre>
<p>æ¾å°[mysqld]éé¡¹ç»ä¸­çbind-addressï¼ç¶åä½¿ç¨i é®è¿å¥ç¼è¾æ¨¡å¼ï¼å¹¶è¾å¥#æ³¨éæè¯¥è¡ãä¿®æ¹çæç»ç»æå¦ä¸å¾æåä¸è¡æç¤ºã</p>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216184740806-1135866084.png" alt="image" width="800" loading="lazy"></p>
<pre><code class="language-bash">sudo systemctl status mysql #æ¥çmysqlæå¡çç¶æ
</code></pre>
<pre><code class="language-bash">sudo systemctl start mysql #å¯å¨MySQLæå¡
</code></pre>
<pre><code class="language-bash">sudo systemctl stop mysql #åæ­¢MySQLæå¡
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216184846284-1413312583.png" alt="image" width="600" loading="lazy"></p>
<pre><code class="language-bash">sudo vim /etc/mysql/debian.cnf
</code></pre>
<pre><code># MySQLå®¢æ·ç«¯éç½®æä»¶
# åªåå«å®¢æ·ç«¯ç¸å³çéç½®éé¡¹

[client]
# é»è®¤è¿æ¥å°æ¬å°MySQL
host = localhost
user = root
socket = /var/run/mysqld/mysqld.sock

[mysql]
# è®¾ç½®å½ä»¤æç¤ºç¬¦
prompt = (\u@\h) [\d]&gt;\_
# å¯ç¨èªå¨è¡¥å¨
auto-rehash = TRUE
# æ¾ç¤ºåå
column-names = TRUE

[mysqladmin]
[mysqlcheck]
[mysqldump]
[mysqlimport]
[mysqlshow]
[mysqlslap]

</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216185117506-12438712.png" alt="image" width="600" loading="lazy"></p>
<p>ä½¿ç¨æä»¶ä¸­çåå§ç¨æ·ååå¯ç ç»å½mysql</p>
<pre><code class="language-bash">mysql -u debian-sys-maint -p pfdKSjeFFhJtdGkr
</code></pre>
<pre><code class="language-bash">update mysql.user set authentication_string=password('123456') where user='root' and host='localhost';
</code></pre>
<p><strong>éå°çéè¯¯é®é¢</strong></p>
<pre><code># ç¬¬1åéï¼æ£æ¥æå¡ç¶æ
sudo systemctl status mysql
sudo systemctl restart mysql

# ç¬¬2åéï¼ä¿®å¤æä»¶æé
sudo chmod 644 /etc/mysql/debian.cnf

# ç¬¬3åéï¼ç»å½ç³»ç»è´¦æ·
mysql --defaults-extra-file=/etc/mysql/debian.cnf

# ç¬¬4åéï¼éç½®rootå¯ç ï¼å¨MySQLä¸­æ§è¡ï¼
ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';
FLUSH PRIVILEGES;
exit;

# ç¬¬5åéï¼æµè¯ç»å½
mysql -u root -p123456
</code></pre>
<p><img src="https://img2024.cnblogs.com/blog/3027557/202512/3027557-20251216194106977-213894387.png" alt="image" loading="lazy"></p>
<p><strong>æµè¯ææ</strong></p>
<pre><code class="language-bash">SELECT VERSION(), USER(), NOW();
SELECT 1+2*3-4/5;
</code></pre>
<hr>
<h3 id="linuxcentos">Linuxï¼CentOSï¼</h3>
<p><em>ç¸å³æç¨ï¼</em> <a href="https://cloud.tencent.com/developer/article/2372374" target="_blank" rel="noopener nofollow">Linux MySQLä¸è½½å®è£è¯¦ç»æç¨ï¼CentOSçï¼</a></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-15 00:58">2026-01-15 00:58</span>&nbsp;
<a href="https://www.cnblogs.com/tokepson">TokE648</a>&nbsp;
éè¯»(<span id="post_view_count">46</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19358930);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19358930', targetLink: 'https://www.cnblogs.com/tokepson/p/19358930', title: 'Mysqlä¸è½½é¨ç½²æ¹æ³å¤ä»½ï¼Windows/Linuxï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ Flinkæºç éè¯»ï¼JobManagerçHAæºå¶ ]]></title>
    <link>https://www.cnblogs.com/Jackeyzhe/p/19484622</link>
    <guid>426abbc2dbe37130daba894a07fe9ee8</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Jackeyzhe/p/19484622" title="åå¸äº 2026-01-14 23:45">
    <span role="heading" aria-level="2">Flinkæºç éè¯»ï¼JobManagerçHAæºå¶</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/1828322/202601/1828322-20260114234320282-1778052120.png" alt="Flinkæºç éè¯»ï¼JobManagerçHAæºå¶" class="desc_img">
        JobManager å¨ Flink éç¾¤ä¸­åæ¥çéè¦çä½ç¨ï¼åæ¬ä»»å¡è°åº¦åèµæºç®¡çç­å·¥ä½ãå¦æ JobManager å®æºï¼é£ä¹æ´ä¸ªéç¾¤çä»»å¡é½å°å¤±è´¥ãä¸ºäºè§£å³ JobManager çåç¹é®é¢ï¼Flink ä¹è®¾è®¡äº HA æºå¶æ¥ä¿éæ´ä¸ªéç¾¤çç¨³å®æ§ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>JobManager å¨ Flink éç¾¤ä¸­åæ¥çéè¦çä½ç¨ï¼åæ¬ä»»å¡è°åº¦åèµæºç®¡çç­å·¥ä½ãå¦æ JobManager å®æºï¼é£ä¹æ´ä¸ªéç¾¤çä»»å¡é½å°å¤±è´¥ãä¸ºäºè§£å³ JobManager çåç¹é®é¢ï¼Flink ä¹è®¾è®¡äº HA æºå¶æ¥ä¿éæ´ä¸ªéç¾¤çç¨³å®æ§ã</p>
<h3 id="åºæ¬æ¦å¿µ">åºæ¬æ¦å¿µ</h3>
<p>å¨ JobManager å¯å¨æ¶ï¼è°ç¨ <code>HighAvailabilityServicesUtils.createHighAvailabilityServices</code> æ¥åå»º HA æå¡ï¼HA ä¾èµçæå¡é½è¢«å°è£å¨ HighAvailabilityServices ä¸­ãå½å Flink åé¨æ¯æä¸¤ç§é«å¯ç¨æ¨¡å¼ï¼åå«æ¯ ZooKeeper å KUBERNETESã</p>
<pre><code class="language-java">case ZOOKEEPER:
    return createZooKeeperHaServices(configuration, executor, fatalErrorHandler);
case KUBERNETES:
    return createCustomHAServices(
            "org.apache.flink.kubernetes.highavailability.KubernetesHaServicesFactory",
            configuration,
            executor);
</code></pre>
<p>HighAvailabilityServices ä¸­æä¾çå³é®ç»ä»¶åæ¬ï¼</p>
<ul>
<li>
<p>LeaderRetrievalServiceï¼æå¡åç°ï¼ç¨äºè·åå½å leader çå°åãç®åç¨å°æå¡åç°çç»ä»¶æ ResourceManagerãDispatcherãJobManagerãClusterRestEndpointã</p>
</li>
<li>
<p>LeaderElectionï¼éä¸¾æå¡ï¼ä»å¤ä¸ªåéèä¸­éåºä¸ä¸ªä½ä¸º leaderãç¨å°éä¸¾æå¡çåæ ·æ¯ ResourceManagerãDispatcherãJobManagerãClusterRestEndpoint è¿åä¸ªã</p>
</li>
<li>
<p>CheckpointRecoveryFactoryï¼Checkpoint æ¢å¤ç»ä»¶çå·¥åç±»ï¼æä¾äºåå»º CompletedCheckpointStore å CheckpointIDCounter çæ¹æ³ãCompletedCheckpointStore æ¯ç¨äºå­å¨å·²å®æç checkpoint çåä¿¡æ¯ï¼CheckpointIDCounter æ¯ç¨äºçæ checkpoint IDã</p>
</li>
<li>
<p>ExecutionPlanStoreï¼ç¨äºå­å¨æ§è¡è®¡åã</p>
</li>
<li>
<p>JobResultStoreï¼ç¨äºå­å¨ä½ä¸ç»æï¼è¿éæä¸¤ç§ç¶æï¼ä¸ç§æ¯ dirtyï¼è¡¨ç¤ºä½ä¸æ²¡æè¢«å®å¨æ¸çï¼å¦ä¸ç§æ¯ cleanï¼è¡¨ç¤ºä½ä¸æ¸çå·¥ä½å·²ç»æ§è¡å®æäºã</p>
</li>
<li>
<p>BlobStoreï¼å­å¨ä½ä¸è¿è¡æé´çä¸äºäºè¿å¶æä»¶ã</p>
</li>
</ul>
<h4 id="éä¸¾æå¡">éä¸¾æå¡</h4>
<p>Flink çéä¸¾æ¯ä¾é  LeaderElection å LeaderContender éåå®æçãLeaderElection æ¯ LeaderElectionService çä»£çæ¥å£ï¼æä¾äºæ³¨ååéèãç¡®è®¤ leader å å¤æ­åéèæ¯å¦æ¯ leader ä¸ä¸ªæ¥å£ãLeaderContender åæ¯ç¨æ¥è¡¨ç¤ºåéèå¯¹è±¡ãå½ä¸ä¸ª LeaderContender å½é leader åï¼LeaderElectionService ä¼ä¸ºå¶çæä¸ä¸ª leaderSessionIdï¼LeaderContender ä¼è°ç¨ confirmLeadershipAsync åå¸èªå·±çå°åãéä¸¾æå¡çå·ä½å®ç°å¨ LeaderElectionDriver æ¥å£ä¸­ã</p>
<h4 id="æå¡åç°">æå¡åç°</h4>
<p>æå¡åç°çä½ç¨æ¯è·ååç»ä»¶ç leader å°åãæå¡åç°ä¾èµ LeaderRetrievalService å LeaderRetrievalListenerãLeaderRetrievalService å¯ä»¥å¯å¨ä¸ä¸ªçå¬ï¼å½ææ°ç leader å½éæ¶ï¼ä¼è°ç¨ LeaderRetrievalListener ç notifyLeaderAddress æ¹æ³ã</p>
<h4 id="ä¿¡æ¯ä¿å­">ä¿¡æ¯ä¿å­</h4>
<p>å½ leader åçåæ¢æ¶ï¼æ°ç leader éè¦è·åå°æ§ leader å­å¨çä¿¡æ¯ï¼è¿å°±éè¦æ§ leader æè¿äºä¿¡æ¯å­å¨ä¸ä¸ªå¬å±çå­å¨ä¸ãå®å¯ä»¥æ¯ ZooKeeper æ Kubernetes çå­å¨ï¼ä¹å¯ä»¥æ¯åå¸å¼æä»¶ç³»ç»çå­å¨ã</p>
<h3 id="åºäº-zookeeper-ç-ha">åºäº ZooKeeper ç HA</h3>
<h4 id="éä¸¾æå¡-1">éä¸¾æå¡</h4>
<p>åé¢æä»¬æå°äºéä¸¾æå¡ä¸»è¦ä¾èµ LeaderElection å LeaderContender éåå®æãæä»¬å°±ä»¥ JobManager ä¸ºä¾ï¼çä¸ä¸æºé ZooKeeper çéä¸¾æµç¨çå·ä½å®ç°ã</p>
<p><img alt="ZKLeaderElection" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1767924499/Blog/flink/20/ZKLeaderElection.png" class="lazyload"></p>
<p>å¾ä¸­ JobMasterServiceLeadershipRunner æ¯ LeaderContender çå®ç°ç±»ãå¨å¯å¨æå¡æ¶ï¼ä¼å LeaderElection æ³¨åèªå·±çä¿¡æ¯ï¼å®éæ§è¡èæ¯ DefaultLeaderElectionServiceãå®ååå»ºäº LeaderElectionDriverï¼ç¶åå° LeaderContender ä¿å­å¨ leaderContenderRegistry ä¸­ãéä¸¾çæ ¸å¿é»è¾å°è£å¨ LeaderElectionDriver ä¸­ã</p>
<p>å¨åå»º LeaderElectionDriver æ¶ï¼ä¼åå»º LeaderLatch å¯¹è±¡å TreeCache å¯¹è±¡ï¼ LeaderLatch å°è£äºä¸ ZooKeeper å³èçåè°ï¼ä¼æ¥æ¶ä¸ä¸ª LeaderElectionDriver ä½ä¸ºçå¬ãTreeCache ä¸»è¦ç¨äºçå¬ ZooKeeper ä¸­ leader èç¹çåæ´ã</p>
<pre><code class="language-java">public ZooKeeperLeaderElectionDriver(
        CuratorFramework curatorFramework, LeaderElectionDriver.Listener leaderElectionListener)
        throws Exception {
    ...
    this.leaderLatch = new LeaderLatch(curatorFramework, ZooKeeperUtils.getLeaderLatchPath());
    this.treeCache =
            ZooKeeperUtils.createTreeCache(
                    curatorFramework,
                    "/",
                    new ZooKeeperLeaderElectionDriver.ConnectionInfoNodeSelector());

    treeCache
            .getListenable()
            .addListener(
                    (client, event) -&gt; {
                        switch (event.getType()) {
                            case NODE_ADDED:
                            case NODE_UPDATED:
                                Preconditions.checkNotNull(
                                        event.getData(),
                                        "The ZooKeeper event data must not be null.");
                                handleChangedLeaderInformation(event.getData());
                                break;
                            case NODE_REMOVED:
                                Preconditions.checkNotNull(
                                        event.getData(),
                                        "The ZooKeeper event data must not be null.");
                                handleRemovedLeaderInformation(event.getData().getPath());
                                break;
                        }
                    });

    leaderLatch.addListener(this);
    ...
    leaderLatch.start();
    treeCache.start();
}
</code></pre>
<p>æä»¬è¿å¥å° LeaderLatch ç start æ¹æ³ãå®çåé¨æ¯å¨ ZooKeeper ä¸åå»º latch-xxx èç¹ãxxx æ¯å½å LeaderLatch ç IDï¼å®ç± ZooKeeper çæï¼ID æå°çå½é Leaderã</p>
<pre><code class="language-java">private void checkLeadership(List&lt;String&gt; children) throws Exception {
    if (this.debugCheckLeaderShipLatch != null) {
        this.debugCheckLeaderShipLatch.await();
    }

    String localOurPath = (String)this.ourPath.get();
    List&lt;String&gt; sortedChildren = LockInternals.getSortedChildren("latch-", sorter, children);
    int ourIndex = localOurPath != null ? sortedChildren.indexOf(ZKPaths.getNodeFromPath(localOurPath)) : -1;
    this.log.debug("checkLeadership with id: {}, ourPath: {}, children: {}", new Object[]{this.id, localOurPath, sortedChildren});
    if (ourIndex &lt; 0) {
        this.log.error("Can't find our node. Resetting. Index: " + ourIndex);
        this.reset();
    } else if (ourIndex == 0) {
        this.lastPathIsLeader.set(localOurPath);
        this.setLeadership(true);
    } else {
        this.setLeadership(false);
        String watchPath = (String)sortedChildren.get(ourIndex - 1);
        Watcher watcher = new Watcher() {
            public void process(WatchedEvent event) {
                if (LeaderLatch.this.state.get() == LeaderLatch.State.STARTED &amp;&amp; event.getType() == EventType.NodeDeleted) {
                    try {
                        LeaderLatch.this.getChildren();
                    } catch (Exception ex) {
                        ThreadUtils.checkInterrupted(ex);
                        LeaderLatch.this.log.error("An error occurred checking the leadership.", ex);
                    }
                }

            }
        };
        BackgroundCallback callback = new BackgroundCallback() {
            public void processResult(CuratorFramework client, CuratorEvent event) throws Exception {
                if (event.getResultCode() == Code.NONODE.intValue()) {
                    LeaderLatch.this.getChildren();
                }

            }
        };
        ((ErrorListenerPathable)((BackgroundPathable)this.client.getData().usingWatcher(watcher)).inBackground(callback)).forPath(ZKPaths.makePath(this.latchPath, watchPath));
    }

}
</code></pre>
<p>å½é Leader åï¼ä¼åè° LeaderElectionDriver ç isLeader æ¹æ³ï¼å¦ææªå½éï¼åç»§ç»­çå¬ latch èç¹çåæ´ãisLeader ä¼ç»§ç»­åè° LeaderElection ç onGrantLeadership æ¹æ³ï¼æ¥çè°ç¨ LeaderContender ç grantLeadershipãè¿æ¶ä¼å¯å¨ JobMaster æå¡ï¼ç¶åè°ç¨ LeaderElection ç confirmLeadershipAsync æ¥ç¡®è®¤å½éæåãç¡®è®¤çè¿ç¨æ¯ç± LeaderElectionDriver æ¥æ§è¡çãä¸»è¦ä½ç¨æ¯æå½å leader çä¿¡æ¯ååå° ZooKeeper ç connection_info èç¹ã</p>
<pre><code class="language-java">public void publishLeaderInformation(String componentId, LeaderInformation leaderInformation) {
    Preconditions.checkState(running.get());

    if (!leaderLatch.hasLeadership()) {
        return;
    }

    final String connectionInformationPath =
            ZooKeeperUtils.generateConnectionInformationPath(componentId);

    LOG.debug(
            "Write leader information {} for component '{}' to {}.",
            leaderInformation,
            componentId,
            ZooKeeperUtils.generateZookeeperPath(
                    curatorFramework.getNamespace(), connectionInformationPath));

    try {
        ZooKeeperUtils.writeLeaderInformationToZooKeeper(
                leaderInformation,
                curatorFramework,
                leaderLatch::hasLeadership,
                connectionInformationPath);
    } catch (Exception e) {
        leaderElectionListener.onError(e);
    }
}
</code></pre>
<h4 id="æå¡åç°-1">æå¡åç°</h4>
<p>æ¢³çå®éä¸¾æå¡çæºç åï¼æä»¬åæ¥çä¸ä¸æå¡åç°çè¿ç¨ãæä»¬ä»¥ TaskManager è·å JobManager ç leader ä¸ºä¾ã</p>
<p><img alt="ZKLeaderRetrieval" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1767929447/Blog/flink/20/ZKLeaderRetrieval.png" class="lazyload"></p>
<p>å½æä»¬å¾ TaskManager æ·»å ä»»å¡æ¶ï¼ä¼è°ç¨ JobLeaderService ç addJob æ¹æ³ãè¿éä¼åè·å LeaderRetrievalï¼ç¶åè°ç¨ start æ¹æ³æ³¨å LeaderRetrievalListener çå¬ï¼å¹¶åå»º LeaderRetrievalDriverãå¨ LeaderRetrievalDriver ä¸­ä¸»è¦æ¯å ZooKeeper æ³¨å connection_info èç¹çåæ´ã</p>
<p>å¦æåçåæ´ï¼ZooKeeper ä¼åè° <code>LeaderRetrievalDriver.retrieveLeaderInformationFromZooKeeper</code> æ¹æ³ãæä»¬ä» ZooKeeper è·åå° leader çå°åå sessionId åï¼å°±åè° <code>LeaderRetrievalService.notifyLeaderAddress</code> æ¹æ³ãæç»è°ç¨å° JobLeaderService ç notifyLeaderAddress æ¹æ³ï¼è¿ä¸ªæ¹æ³ä¸­å°±æ¯æ­å¼ä¸æ§ leader çè¿æ¥ï¼å¢å ä¸æ° leader çè¿æ¥ã</p>
<h4 id="ä¿¡æ¯ä¿å­-1">ä¿¡æ¯ä¿å­</h4>
<p>æåæä»¬åæ¥çä¿¡æ¯ä¿å­ç¸å³çæºç ãå¨ JobManager å®æä¸æ¬¡ Checkpoint æ¶ï¼ä¼æ§è¡ <code>CheckpointCoordinator.completePendingCheckpoint</code> æ¹æ³ï¼è·éè°ç¨é¾è·¯å¯ä»¥æ¾å° <code>ZooKeeperStateHandleStore.addAndLock</code> æ¹æ³ï¼è¿éä¼æç¶æåå¥å°æä»¶ç³»ç»ä¸­ï¼ç¶åææä»¶è·¯å¾ä¿å­å¨ ZooKeeper ä¸­ã</p>
<pre><code class="language-java">public RetrievableStateHandle&lt;T&gt; addAndLock(String pathInZooKeeper, T state)
        throws PossibleInconsistentStateException, Exception {
    checkNotNull(pathInZooKeeper, "Path in ZooKeeper");
    checkNotNull(state, "State");
    final String path = normalizePath(pathInZooKeeper);
    final Optional&lt;Stat&gt; maybeStat = getStat(path);

    if (maybeStat.isPresent()) {
        if (isNotMarkedForDeletion(maybeStat.get())) {
            throw new AlreadyExistException(
                    String.format("ZooKeeper node %s already exists.", path));
        }

        Preconditions.checkState(
                releaseAndTryRemove(path),
                "The state is marked for deletion and, therefore, should be deletable.");
    }

    final RetrievableStateHandle&lt;T&gt; storeHandle = storage.store(state);
    final byte[] serializedStoreHandle = serializeOrDiscard(storeHandle);
    try {
        writeStoreHandleTransactionally(path, serializedStoreHandle);
        return storeHandle;
    } catch (KeeperException.NodeExistsException e) {
        // Transactions are not idempotent in the curator version we're currently using, so it
        // is actually possible that we've re-tried a transaction that has already succeeded.
        // We've ensured that the node hasn't been present prior executing the transaction, so
        // we can assume that this is a result of the retry mechanism.
        return storeHandle;
    } catch (Exception e) {
        if (indicatesPossiblyInconsistentState(e)) {
            throw new PossibleInconsistentStateException(e);
        }
        // In case of any other failure, discard the state and rethrow the exception.
        storeHandle.discardState();
        throw e;
    }
}
</code></pre>
<p>è³æ­¤ï¼åºäº ZooKeeper ç HA é»è¾æä»¬å°±æ¢³çå®äºãä» 1.12 çæ¬å¼å§ï¼Flink è¿æ¯æäº Kubernetes é«å¯ç¨ï¼ä¸é¢æä»¬åæ¥ä¸ä¸å®æ¯å¦ä½å®ç°çã</p>
<h3 id="åºäº-kubernetes-ç-ha">åºäº Kubernetes ç HA</h3>
<h4 id="éä¸¾æå¡-2">éä¸¾æå¡</h4>
<p>éè¿åé¢çå­¦ä¹ ï¼æä»¬å·²ç»äºè§£å°ï¼éä¸¾çä¸»è¦é»è¾æ¯å¨ LeaderElectionDriver ä¸­ï¼å æ­¤ï¼æä»¬ç´æ¥æ¥ç KubernetesLeaderElectionDriver çé»è¾å³å¯ãåå»º KubernetesLeaderElectionDriver æ¶ï¼åå»ºå¹¶å¯å¨äº KubernetesLeaderElectorãè¿ä¸ªç±»ä¼¼äº ZooKeeper é»è¾ä¸­ LeaderLatchï¼ä¼è· Kubernetes åºå±çéä¸¾é»è¾äº¤äºï¼åæ¶æ³¨åçå¬ã</p>
<pre><code class="language-java">public KubernetesLeaderElector(
        NamespacedKubernetesClient kubernetesClient,
        KubernetesLeaderElectionConfiguration leaderConfig,
        LeaderCallbackHandler leaderCallbackHandler,
        ExecutorService executorService) {
    this.kubernetesClient = kubernetesClient;
    this.leaderElectionConfig =
            new LeaderElectionConfigBuilder()
                    .withName(leaderConfig.getConfigMapName())
                    .withLeaseDuration(leaderConfig.getLeaseDuration())
                    .withLock(
                            new ConfigMapLock(
                                    new ObjectMetaBuilder()
                                            .withNamespace(kubernetesClient.getNamespace())
                                            .withName(leaderConfig.getConfigMapName())
                                            // Labels will be used to clean up the ha related
                                            // ConfigMaps.
                                            .withLabels(
                                                    KubernetesUtils.getConfigMapLabels(
                                                            leaderConfig.getClusterId()))
                                            .build(),
                                    leaderConfig.getLockIdentity()))
                    .withRenewDeadline(leaderConfig.getRenewDeadline())
                    .withRetryPeriod(leaderConfig.getRetryPeriod())
                    .withReleaseOnCancel(true)
                    .withLeaderCallbacks(
                            new LeaderCallbacks(
                                    leaderCallbackHandler::isLeader,
                                    leaderCallbackHandler::notLeader,
                                    newLeader -&gt;
                                            LOG.info(
                                                    "New leader elected {} for {}.",
                                                    newLeader,
                                                    leaderConfig.getConfigMapName())))
                    .build();
    this.executorService = executorService;

    LOG.info(
            "Create KubernetesLeaderElector on lock {}.",
            leaderElectionConfig.getLock().describe());
}
</code></pre>
<p>éä¸¾æååï¼ä¼åè° <code>LeaderElectionListener.onGrantLeadership</code> æ¹æ³ãåç»­çè°ç¨é¾è·¯è¿æ¯ä¼è°ç¨å° <code>KubernetesLeaderElectionDriver.publishLeaderInformation</code> æ¹æ³ãè¿ä¸ªæ¹æ³æ¯æ leader ä¿¡æ¯åå° Kubernetes ç configMap ä¸­ã</p>
<pre><code class="language-java">public void publishLeaderInformation(String componentId, LeaderInformation leaderInformation) {
    Preconditions.checkState(running.get());

    try {
        kubeClient
                .checkAndUpdateConfigMap(
                        configMapName,
                        updateConfigMapWithLeaderInformation(componentId, leaderInformation))
                .get();
    } catch (InterruptedException | ExecutionException e) {
        leaderElectionListener.onError(e);
    }

    LOG.debug(
            "Successfully wrote leader information {} for leader {} into the config map {}.",
            leaderInformation,
            componentId,
            configMapName);
}
</code></pre>
<h4 id="æå¡åç°-2">æå¡åç°</h4>
<p>æå¡åç°çé»è¾å¨ KubernetesLeaderRetrievalDriver ç±»ä¸­ï¼å¨åå»ºæ¶ï¼ä¼å°åé¨ç±» ConfigMapCallbackHandlerImpl æ³¨åä¸ºçå¬åè°ç±»ã</p>
<p>å½ configMap ææ°å¢æåæ´åï¼ä¼åè° <code>LeaderRetrievalService.notifyLeaderAddress</code> æ¹æ³ã</p>
<pre><code class="language-java">private class ConfigMapCallbackHandlerImpl
        implements FlinkKubeClient.WatchCallbackHandler&lt;KubernetesConfigMap&gt; {

    @Override
    public void onAdded(List&lt;KubernetesConfigMap&gt; configMaps) {
        // The ConfigMap is created by KubernetesLeaderElectionDriver with
        // empty data. We don't really need to process anything unless the retriever was started
        // after the leader election has already succeeded.
        final KubernetesConfigMap configMap = getOnlyConfigMap(configMaps, configMapName);
        final LeaderInformation leaderInformation = leaderInformationExtractor.apply(configMap);
        if (!leaderInformation.isEmpty()) {
            leaderRetrievalEventHandler.notifyLeaderAddress(leaderInformation);
        }
    }

    @Override
    public void onModified(List&lt;KubernetesConfigMap&gt; configMaps) {
        final KubernetesConfigMap configMap = getOnlyConfigMap(configMaps, configMapName);
        leaderRetrievalEventHandler.notifyLeaderAddress(
                leaderInformationExtractor.apply(configMap));
    }
    ...
}
</code></pre>
<h4 id="ä¿¡æ¯ä¿å­-2">ä¿¡æ¯ä¿å­</h4>
<p>ä¿¡æ¯ä¿å­çé»è¾å ZooKeeper ä¹éå¸¸ç±»ä¼¼ãå³åæ state ä¿å­å¨æä»¶ç³»ç»ï¼ç¶åæå­å¨è·¯å¾åå° Kubernetes åå° configMap ä¸­ãå·ä½å¯ä»¥ç <code>KubernetesStateHandleStore.addAndLock</code> æ¹æ³ã</p>
<h3 id="æ»ç»">æ»ç»</h3>
<p>æ¬ææä»¬ä¸èµ·æ¢³çäº Flink ä¸­ JobManager ç HA æºå¶ç¸å³æºç ãç®å Flink æ¯æ ZooKeeper å Kubernetes ä¸¤ç§å®ç°ãå¨æ¢³çè¿ç¨ä¸­ï¼æä»¬ä»¥ JobManager ä¸ºä¾ï¼å¶ä»å ä¸ªç¨å°é«å¯ç¨çæå¡çéä¸¾é»è¾ä¹æ¯ä¸æ ·çã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-14 23:46">2026-01-14 23:45</span>&nbsp;
<a href="https://www.cnblogs.com/Jackeyzhe">Jackeyzhe</a>&nbsp;
éè¯»(<span id="post_view_count">15</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19484622);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19484622', targetLink: 'https://www.cnblogs.com/Jackeyzhe/p/19484622', title: 'Flinkæºç éè¯»ï¼JobManagerçHAæºå¶' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å°ç½å­¦AIå¼å01ï¼åå»ºç¬¬ä¸ä¸ªç¤ºä¾Agent ]]></title>
    <link>https://www.cnblogs.com/jyzhao/p/19484508/xiao-bai-xueai-kai-fa01-chuang-jian-di-yi-ge-shi-l</link>
    <guid>445f0dafcb9d3942e311ecccb283a175</guid>
    <description>
    <![CDATA[ 
    <a name="top"></a>
    <h2><a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/jyzhao/p/19484508/xiao-bai-xueai-kai-fa01-chuang-jian-di-yi-ge-shi-l" title="åå¸äº 2026-01-14 23:43">
    <span role="heading" aria-level="2">å°ç½å­¦AIå¼å01ï¼åå»ºç¬¬ä¸ä¸ªç¤ºä¾Agent</span>
    

</a>
</h2>
    <small>
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-14 23:43">2026-01-14 23:43</span>&nbsp;
<a href="https://www.cnblogs.com/jyzhao">AlfredZhao</a>&nbsp;
éè¯»(<span id="post_view_count">20</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19484508);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19484508', targetLink: 'https://www.cnblogs.com/jyzhao/p/19484508/xiao-bai-xueai-kai-fa01-chuang-jian-di-yi-ge-shi-l', title: 'å°ç½å­¦AIå¼å01ï¼åå»ºç¬¬ä¸ä¸ªç¤ºä¾Agent' })">ä¸¾æ¥</a>
</small>
    <div class="entry">
        <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>å¨ LangChain å¼åä¸­ï¼æä»¬çæ ¸å¿å·¥ä½æ¯å Promptï¼æç¤ºè¯ï¼ã</p>
<p>é¤æ­¤ä¹å¤ï¼è¿éè¦äºè§£ä¸pythonåºç¡ï¼ç®åäºè§£å³å¯ï¼ä¸éè¦ç³»ç»å­¦ä¹ ï¼è¿å°±æ¯AIæ¶ä»£å¯¹ææ¯ç±å¥½èççº¢å©ã</p>
<h2 id="01--æå»ºç¬ç«çpythonç¯å¢">01 | æå»ºç¬ç«çpythonç¯å¢</h2>
<p>ä½¿ç¨minicondaæå»ºç¬ç«çpythonç¯å¢ã</p>
<p>å®æ¹ç½ç«ï¼<a href="https://www.anaconda.com/" target="_blank" rel="noopener nofollow">https://www.anaconda.com/</a></p>
<p>éæ©éåä½ çï¼æè¿éç´æ¥éæ©å¾å½¢åå®è£çMinicondaï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/635610/202601/635610-20260114224646258-840865368.jpg" alt="" loading="lazy"></p>
<p>ä¸è½½åå®è£ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/635610/202601/635610-20260114224646142-163182582.jpg" alt="" loading="lazy"></p>
<p>å³é­å¹¶éæ°æå¼ç»ç«¯ãæ­¤æ¶ä½ ä¼çå°å½ä»¤è¡åé¢å¤äºä¸ª (base)ï¼è¿è¯´æ Conda å·²ç»æ¥ç®¡äºç¯å¢ã</p>
<p>ç¶ååå»º Python 3.12 ä¸å±å­¦ä¹ ç¯å¢ï¼</p>
<pre><code class="language-BASH"># åå»ºç¯å¢å¹¶æå® Python çæ¬
conda create -n lc python=3.12 -y

# æ¿æ´»ç¯å¢
conda activate lc
</code></pre>
<p>Tipsï¼å¦æåå»ºç¯å¢ï¼éå°è®©åææå¡/æ¡æ¬¾ä¹ç±»ï¼ç´æ¥ææç¤ºå½ä»¤æ§è¡åæå³å¯ã</p>
<p>åé¢æµè¯ä¸ååè½çpythonç¨åºè¯å®åä¸äºå¼ç¨åç§ç±»åçåï¼æä»¬ç»ä¸æ¾å° requirements.txt ä¸­ï¼åç»­æ°ç¯å¢ä¹å¯ä»¥ç´æ¥ä¸é®å®è£éè¦å¼å¥çç¸å³åã</p>
<pre><code class="language-BASH">pip install -r requirements.txt
</code></pre>
<p>å®æç»´æ¤requirements.txtæä»¶ï¼</p>
<pre><code class="language-BASH">langchain
langchain-openai
python-dotenv
</code></pre>
<h2 id="02--åå»ºç¬¬ä¸ä¸ªç¤ºä¾agent">02 | åå»ºç¬¬ä¸ä¸ªç¤ºä¾Agent</h2>
<p>è¿éä»¿ç§LangChainå®æ¹ææ¡£ï¼æå»ºä¸ä¸ªç®åçAgentã</p>
<ul>
<li><a href="https://docs.langchain.com/oss/python/langchain/quickstart" target="_blank" rel="noopener nofollow">https://docs.langchain.com/oss/python/langchain/quickstart</a></li>
</ul>
<p>å ä¸ºç¬èææ¶æ²¡æClaudeæ¨¡åå¯ç¨ï¼æä»¥æ¿æ¢ä¸ºå½åçæ¨¡åï¼å¨æä»¬å­¦ä¹ æµè¯é¶æ®µï¼åºæ¬æ¯æ²¡å¥å½±åçã</p>
<p>vi basic.py</p>
<pre><code class="language-python">import os
from dotenv import load_dotenv
from langchain.agents import create_agent
from langchain_openai import ChatOpenAI
from langchain.tools import tool

# å è½½ .env æä»¶ä¸­ç SILICONFLOW_API_KEY
load_dotenv()

# 1. å®ä¹å·¥å·ï¼å¿é¡»è¦åæ¸æ°ç Docstringï¼å½æ°æ³¨éï¼
@tool
def get_weather(city: str) -&gt; str:
    """è·åæå®åå¸çå®æ¶å¤©æ°æåµã"""
    return f"{city} çå¤©æ°æ»æ¯é´é¨è¿è¿ï¼"

# 2. åå§å SiliconFlow æ¨¡å
llm = ChatOpenAI(
    model="deepseek-ai/DeepSeek-V3", 
    api_key=os.getenv("SILICONFLOW_API_KEY"),
    base_url="https://api.siliconflow.cn/v1",
    temperature=0.1
)

# 3. åå»º Agent
agent = create_agent(
    model=llm,
    tools=[get_weather],
    system_prompt="ä½ æ¯ä¸ä¸ªä¹äºå©äººçå¤©æ°å©æã"
)

# 4. è¿è¡
if __name__ == "__main__":
    response = agent.invoke(
        {"messages": [{"role": "user", "content": "åäº¬å¤©æ°æä¹æ ·ï¼"}]}
    )
    # æå°æåä¸æ¡æ¶æ¯ï¼AI çåç­ï¼
    print(response["messages"][-1].content)
</code></pre>
<h2 id="03--å¢å¼ºè¿ä¸ªç¤ºä¾agent">03 | å¢å¼ºè¿ä¸ªç¤ºä¾Agent</h2>
<p>æ±åå¹¶ç¨å¾®æ¹é ä¸å®æ¹çç¤ºä¾ï¼ä½¿å¶éç¨äºæä»¬çæµè¯ç¯å¢ï¼</p>
<p>vi enhance.py</p>
<pre><code class="language-PYTHON">import os
from dataclasses import dataclass
from dotenv import load_dotenv

from langchain_openai import ChatOpenAI
from langchain.agents import create_agent
from langchain.tools import tool, ToolRuntime
from langgraph.checkpoint.memory import InMemorySaver
from langchain.agents.structured_output import ToolStrategy

load_dotenv()

# 1. å®ä¹ç³»ç»æç¤ºè¯ï¼è¦æ± AI åä¸ªâè°é³æ¢âä¸å®¶ï¼
SYSTEM_PROMPT = """ä½ æ¯ä¸ä½ä¸ä¸çèµæ·±å¤©æ°é¢æ¥åï¼è¯´è¯æå¶å¹½é»ï¼ç¹å«åæ¬¢è®²âè°é³æ¢âã

ä½ ææä½¿ç¨ä»¥ä¸ä¸¤ä¸ªå·¥å·ï¼
- get_weather_for_location: è·åç¹å®åå¸çå¤©æ°ã
- get_user_location: è·åå½åç¨æ·çæå¨å°ã

å¦æç¨æ·è¯¢é®å¤©æ°ï¼è¯·å¡å¿ç¡®è®¤å°ç¹ãå¦æç¨æ·è¯´çæ¯âæè¿å¿âæâæè¿éâï¼è¯·è°ç¨ get_user_location è·åä»ä»¬çä½ç½®ã"""

# 2. å®ä¹ä¸ä¸æç»æï¼å­å¨ç¨æ·ä¿¡æ¯ï¼
@dataclass
class Context:
    """èªå®ä¹è¿è¡æ¶ä¸ä¸æã"""
    user_id: str

# 3. å®ä¹å·¥å·
@tool
def get_weather_for_location(city: str) -&gt; str:
    """è·åæå®åå¸çå¤©æ°æåµã"""
    return f"{city} çå¤©æ°æ»æ¯é³åç¿çï¼"

@tool
def get_user_location(runtime: ToolRuntime[Context]) -&gt; str:
    """æ ¹æ®ç¨æ· ID è·åå¶å°çä½ç½®ã"""
    user_id = runtime.context.user_id
    # æ¨¡ææ°æ®åºï¼ç¨æ· 1 å¨åäº¬ï¼å¶ä»å¨ç æµ·
    return "åäº¬" if user_id == "1" else "ç æµ·"

# 4. éç½®ä½ çæ¨¡å (SiliconFlow)
model = ChatOpenAI(
    model="deepseek-ai/DeepSeek-V3",
    api_key=os.getenv("SILICONFLOW_API_KEY"),
    base_url="https://api.siliconflow.cn/v1",
    temperature=0.7  # ç¨å¾®æé«éæºæ§ï¼è®©è°é³æ¢æ´æåæ
)

# 5. å®ä¹ååºæ ¼å¼ï¼æ±åå­æ®µæè¿°ï¼è®© AI æç½å¡«ä»ä¹ï¼
@dataclass
class ResponseFormat:
    """Agent çç»æååå¤æ ¼å¼ã"""
    # å¹½é»çè°é³æ¢åå¤
    punny_response: str
    # ä»»ä½å³äºå¤©æ°çæè¶£ä¿¡æ¯ï¼å¦ææçè¯ï¼
    weather_conditions: str | None = None

# 6. è®¾ç½®è®°å¿å­å¨
checkpointer = InMemorySaver()

# 7. åå»º Agent
agent = create_agent(
    model=model,
    system_prompt=SYSTEM_PROMPT,
    tools=[get_user_location, get_weather_for_location],
    context_schema=Context,
    response_format=ToolStrategy(ResponseFormat),
    checkpointer=checkpointer
)

# --- è¿è¡æµè¯ ---

# è®¾ç½®ä¼è¯ ID
config = {"configurable": {"thread_id": "test_user_001"}}

# ç¬¬ä¸æ¬¡æé®
print("--- ç¬¬ä¸æ¬¡å¯¹è¯ ---")
response = agent.invoke(
    {"messages": [{"role": "user", "content": "å¤é¢å¤©æ°æä¹æ ·ï¼"}]},
    config=config,
    context=Context(user_id="1")
)

# è®¿é®ç»æåç»æ
res = response['structured_response']
print(f"AI: {res.punny_response}")
print(f"è¯¦æ: {res.weather_conditions}")

print("\n--- ç¬¬äºæ¬¡å¯¹è¯ï¼æµè¯è®°å¿ï¼ ---")
# ç¬¬äºæ¬¡æé®
response = agent.invoke(
    {"messages": [{"role": "user", "content": "è°¢è°¢ä½ ï¼æå¨åªéï¼"}]},
    config=config,
    context=Context(user_id="1")
)

res = response['structured_response']
print(f"AI: {res.punny_response}")
</code></pre>
<p>è¿æ®µç¤ºä¾ä»£ç çæ ¸å¿é»è¾æ¯ï¼</p>
<p><strong>ç¬¬ä¸æ¬¡å¯¹è¯ï¼</strong></p>
<p>ç¨æ·é®ï¼âå¤é¢å¤©æ°æä¹æ ·ï¼âï¼æ²¡è¯´å°ç¹ï¼ã<br>
AI æèï¼ç³»ç»æç¤ºè¯åè¯æï¼å¦æå°ç¹ä¸æï¼åå»æ¥ç¨æ·å¨åªã<br>
å¨ä½ï¼AI è°ç¨ get_user_location -&gt; å¾å°âåäº¬â -&gt; è°ç¨ get_weather_for_location -&gt; å¾å°å¤©æ°ã<br>
åå¤ï¼æ ¹æ® ResponseFormat ååºä¸ä¸ªè°é³æ¢ã</p>
<p><strong>ç¬¬äºæ¬¡å¯¹è¯ï¼</strong></p>
<p>ç¨æ·é®ï¼âè°¢è°¢ä½ ï¼æå¨åªéï¼â<br>
AI æèï¼ç±äºæ thread_id å checkpointerï¼AI è®°å¾ä¸ä¸æ¬¡æ¥è¯¢çç»æã<br>
å¨ä½ï¼å®ä¸éè¦åæ¬¡æ¥å·¥å·ï¼ç´æ¥ä»è®°å¿éæåä¿¡æ¯å¹¶åå¤ã</p>
<p>ç¶åæå·¥å°ä»£ç ä¸­ç user_id æ¹ä¸º2ï¼åæ¬¡è¿è¡ï¼å°±ä¼æ ¹æ®å·¥å· <code>get_user_location</code> ä¸­çç¤ºä¾é»è¾ï¼å¾å°å°ç¹ä¸ºâç æµ·âï¼ä¸¤æ¬¡æ§è¡çææåèå¦ä¸ï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/635610/202601/635610-20260114224646132-69223909.jpg" alt="" loading="lazy"></p>
<p>è¯¥æ®µç¤ºä¾ä»£ç è½ç¶ç®åï¼ä½å¶å®å·²ç»è½å±ç°åºä¸ä¸ªä¼ä¸çº§ AI æºè½ä½ï¼Agentï¼çç¼©å½±ãå®æ¶µçäºç°ä»£ AI å¼åä¸­ææ ¸å¿çä¸ä¸ªæ¯æ±ï¼å·¥å·è°ç¨ï¼Tool Useï¼ãä¸ä¸æè®°å¿ï¼Memoryï¼ãä»¥åç»æåè¾åºï¼Structured Outputï¼ã</p>

</div>
<div id="MySignature" role="contentinfo">
    <a href="https://www.cnblogs.com/jyzhao/" target="_blank">AlfredZhao</a>Â©çæææãä»Oracleèµ·èªï¼é¢ç¥ç²¾å½©çITææ¯ãã<br>
è½¬è½½è¯·æ³¨æåæé¾æ¥ï¼<a href="https://www.cnblogs.com/jyzhao/p/19484508/xiao-bai-xueai-kai-fa01-chuang-jian-di-yi-ge-shi-l" target="_blank">https://www.cnblogs.com/jyzhao/p/19484508/xiao-bai-xueai-kai-fa01-chuang-jian-di-yi-ge-shi-l</a>
<hr>
<div style="text-align:center; margin-top:30px;">
  <p style="font-size:14px;color:#555;">
    ð æè°¢éè¯»ï¼æ¬¢è¿å³æ³¨æçå¬ä¼å· <b>ãèµµéå®ã</b>
  </p>
  <img src="https://images.cnblogs.com/cnblogs_com/jyzhao/824234/o_250208075013_qrcode-zjy.jpg" width="160" style="border:1px solid #ddd;border-radius:8px;">
</div>
</div>
<div class="clear"></div>

        <div class="clear"></div>
        
</div>
    <ul class="postmetadata">
        <vc:categories-tags blog-app="jyzhao" blog-id="186567" post-id="19484508"></vc:categories-tags>
    </ul>
 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ FastAPIç¼å­æéå®æï¼ææææä½ ç¨Redisä¸ºæ¥å£æ³¨å¥âè®°å¿â ]]></title>
    <link>https://www.cnblogs.com/ymtianyu/p/19485724</link>
    <guid>40333e9ac49058715b111f17795826f7</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/ymtianyu/p/19485724" title="åå¸äº 2026-01-15 11:14">
    <span role="heading" aria-level="2">FastAPIç¼å­æéå®æï¼ææææä½ ç¨Redisä¸ºæ¥å£æ³¨å¥âè®°å¿â</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ¬æå°è¯¦ç»ä»ç»å¦ä½å¨FastAPIåºç¨ä¸­éæRediså®ç°é«æçæ°æ®ç¼å­ãåå®¹æ¶µçRedisçæ ¸å¿ä½ç¨ä¸ä¼å¿ãå¨ä¸»è¦æä½ç³»ç»ä¸çå®è£ä¸éç½®æ­¥éª¤ãå¿é¡»ææ¡çå¸¸ç¨å½ä»¤ï¼å¹¶éè¿ä¸ä¸ªå®æ´çå®æç¤ºä¾ï¼å±ç¤ºå¦ä½ç¼åä¸ä¸ªå¯å¤ç¨çç¼å­è£é¥°å¨æ¥æ¾èæåæ¥å£æ§è½ï¼æååäº«ç¼å­ç­ç¥çæ³¨æäºé¡¹ä¸è¿é¶æèã
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>ä½ çFastAPIæ¥å£æ¯ä¸æ¯å¨é«å¹¶åä¸è¶æ¥è¶æ¢ï¼æ°æ®åºé¢é¢åè­¦ï¼</p>
<p>ä¸ä¸ªæ¡ä¾ï¼ä¸ä¸ªæ ¸å¿æ¥è¯¢æ¥å£ï¼å¨æ¥æ´»ä»5ä¸æ¶ï¼å¹³åååºæ¶é´å°±é£åå°äº1.2ç§ãææ¥ååç°ï¼è¶è¿80%çè¯·æ±é½å¨éå¤æ¥è¯¢æ°æ®åºéé£å æ¡å ä¹ä¸åçç­ç¹æ°æ®ãå¨å¼å¥Redisç¼å­åï¼è¿ä¸ªæ¥å£ç<strong style="color: rgba(186, 55, 42, 1)">å¹³åååºæ¶é´ç´æ¥éå°äº0.2ç§ä»¥å</strong>ï¼æ°æ®åºè´è½½ä¸éäº70%ãè¿ï¼å°±æ¯ç¼å­çé­åã</p>
<p>ä»å¤©ï¼æä»¬å°±æ¥èèå¦ä½ä¸ºä½ FastAPIé¡¹ç®è£ä¸Redisè¿ä¸ªâé«éç¼å­âï¼è®©å®æ¥æâè®°å¿âï¼ä¸åæ¯æ¬¡é½å»å»å°éå¤å³å¨ã</p>
<h2>ð æ¬æä½ å°å­¦å°ï¼</h2>
<div>
<p>ð¯ 1. Redisæ¯ä»ä¹ï¼ä¸ºä»ä¹å®æ¯ç¼å­çé¦éï¼</p>
<p>ð¯ 2. å¦ä½å¿«éå®è£ãéç½®Redisã</p>
<p>ð¯ 3. å¿é¡»ææ¡çRedisæ ¸å¿å½ä»¤ã</p>
<p>ð¯ 4. ç¼åä¸ä¸ªéç¨çFastAPIç¼å­è£é¥°å¨ï¼ä¸å³æ°¸é¸ã</p>
</div>
<hr style="border: none; height: 1px; background: linear-gradient(90deg, rgba(0, 0, 0, 0), rgba(52, 152, 219, 1), rgba(0, 0, 0, 0)); margin: 20px 0">
<h2>ð§ ç¬¬ä¸é¨åï¼é®é¢ä¸èæ¯ - ä¸ºä»ä¹éè¦ç¼å­ï¼</h2>
<p>æ³è±¡ä¸ä¸ï¼ä½ æ¯é¤åï¼ä½ çWebæå¡ï¼çæå¡åï¼APIæ¥å£ï¼ãæ¯æ¬¡å®¢äººï¼å®¢æ·ç«¯ï¼ç¹ä¸ä»½âä»æ¥ç¹è²èâï¼ç­é¨æ°æ®ï¼ï¼ä½ é½éå¾è·ååå¨ï¼æ°æ®åºï¼é®å¨å¸ä¸éï¼å°½ç®¡è¿éèä¸å¤©é½ä¸ä¼åãç»æå°±æ¯ï¼ä½ ç´¯è¶´äºï¼åå¨ä¹è¢«ä½ é®ç¦äºï¼å®¢äººè¿å«ä¸èæ¢ã</p>
<p>ç¼å­ï¼å°±åæ¯ä½ å¨ååæ¾äºä¸ªå°æ¬å­ï¼Redisï¼ãç¬¬ä¸æ¬¡æå®¢äººç¹âä»æ¥ç¹è²èâï¼ä½ å»åå¨é®äºï¼ç¶å<strong style="color: rgba(186, 55, 42, 1)">æèååä»·æ ¼è®°å¨æ¬å­ä¸</strong>ãæ¥ä¸æ¥åæå®¢äººç¹ï¼ä½ ç´æ¥çä¸ç¼æ¬å­å°±åè¯ä»ï¼éåº¦å¿«äºååãåªæå½ç¹è²èæ´æ¢äºï¼æ°æ®åæ´ï¼ï¼ä½ æéè¦å»æ´æ°å°æ¬å­ã</p>
<p>å¨ææ¯å±é¢ï¼ç¼å­ä¸»è¦è§£å³ä¸¤ä¸ªé®é¢ï¼<strong style="color: rgba(186, 55, 42, 1)">1. æåæ°æ®è¯»åéåº¦</strong>ï¼åå­è¿å¿«äºç£ç/ç½ç»ï¼ï¼<strong style="color: rgba(186, 55, 42, 1)">2. åè½»åç«¯æ°æ®åºåå</strong>ã</p>
<h2>âï¸ ç¬¬äºé¨åï¼Redisæ ¸å¿ä¸å®è£éç½®</h2>
<h3>ð¯ Redisæ¯ä»ä¹ï¼</h3>
<p>Redisæ¯ä¸ä¸ªå¼æºãåºäºåå­ãå¯æä¹åç<code style="color: rgba(186, 55, 42, 1)">é®å¼å¯¹(Key-Value)</code>å­å¨ç³»ç»ãå®æ¯æå¤ç§æ°æ®ç»æï¼å­ç¬¦ä¸²ãåå¸ãåè¡¨ãéåç­ï¼ï¼æ§è½æé«ï¼å¸¸è¢«ç¨ä½æ°æ®åºãç¼å­åæ¶æ¯ä¸­é´ä»¶ãå¯¹äºç¼å­åºæ¯ï¼æä»¬ä¸»è¦çä¸­å®ï¼<strong style="color: rgba(186, 55, 42, 1)">åå­å­å¨éåº¦æå¿«</strong>ã<strong style="color: rgba(186, 55, 42, 1)">æ°æ®ç»æä¸°å¯</strong>ã<strong style="color: rgba(186, 55, 42, 1)">æ¯æè®¾ç½®è¿ææ¶é´</strong>ã</p>
<h3>ð¯ å®è£Redisï¼åå¹³å°éç¨æ­¥éª¤ï¼</h3>
<div>
<p><strong>1. macOS (ä½¿ç¨Homebrew):</strong></p>
<div>
<p>- æå¼ç»ç«¯ï¼æ§è¡ï¼<code style="color: rgba(186, 55, 42, 1)">brew install redis</code></p>
<p>- å¯å¨æå¡ï¼<code style="color: rgba(186, 55, 42, 1)">brew services start redis</code></p>
</div>
<p><strong>2. Linux (ä»¥Ubuntuä¸ºä¾):</strong></p>
<div>
<p>- æ´æ°åç®¡çå¨ï¼<code style="color: rgba(186, 55, 42, 1)">sudo apt update</code></p>
<p>- å®è£Redisï¼<code style="color: rgba(186, 55, 42, 1)">sudo apt install redis-server</code></p>
<p>- å¯å¨æå¡ï¼<code style="color: rgba(186, 55, 42, 1)">sudo systemctl start redis</code></p>
</div>
<p><strong>3. Windows:</strong></p>
<div>
<p>å®æ¹ä¸æ¯æWindowsåçå®è£ï¼ä½å¯ä»¥éè¿ï¼</p>
<p>- ä½¿ç¨WSL2ï¼æ¨èï¼å¨WSLçUbuntuä¸­æLinuxæ¹æ³å®è£ï¼ã</p>
<p>- æä¸è½½å¾®è½¯ç»´æ¤çæ§çæ¬Windowsç§»æ¤çï¼ä¸æ¨èç¨äºçäº§ï¼ã</p>
</div>
</div>
<p>å®è£å®æåï¼å¨ç»ç«¯è¾å¥ <code style="color: rgba(186, 55, 42, 1)">redis-cli ping</code>ï¼å¦æè¿å <code style="color: rgba(186, 55, 42, 1)">PONG</code>ï¼æ­åä½ ï¼Redisæå¡å·²æåè¿è¡ï¼</p>
<h3>ð¯ ä½ å¿é¡»ææ¡ç5ä¸ªRedisç¼å­æ ¸å¿å½ä»¤</h3>
<div>
<p><strong>1. SETï¼ è®¾ç½®é®å¼å¯¹</strong></p>
<pre class="language-dockerfile highlighter-hljs"><code>SET user:1001 '{"name": "Alice", "age": 30}' EX 60
# é®ï¼user:1001ï¼ å¼ï¼JSONå­ç¬¦ä¸²ï¼ EX 60è¡¨ç¤º60ç§åè¿æ</code></pre>
<p><strong>2. GETï¼ è·åé®å¯¹åºçå¼</strong></p>
<pre class="language-sql highlighter-hljs"><code>GET user:1001</code></pre>
<p><strong>3. EXISTSï¼ æ£æ¥é®æ¯å¦å­å¨</strong></p>
<pre class="language-dockerfile highlighter-hljs"><code>EXISTS user:1001 # è¿å1(å­å¨)æ0(ä¸å­å¨)</code></pre>
<p><strong>4. DELï¼ å é¤ä¸ä¸ªæå¤ä¸ªé®</strong></p>
<pre class="language-sql highlighter-hljs"><code>DEL user:1001 user:1002</code></pre>
<p><strong>5. TTLï¼ æ¥çé®çå©ä½çå­æ¶é´(ç§)</strong></p>
<pre class="language-dockerfile highlighter-hljs"><code>TTL user:1001 # è¿åå©ä½ç§æ°ï¼-1è¡¨ç¤ºæ°¸ä¸è¿æï¼-2è¡¨ç¤ºé®ä¸å­å¨</code></pre>
</div>
<h2>ð ç¬¬ä¸é¨åï¼FastAPIæ´åRediså®ææ¼ç¤º</h2>
<p>çè®ºè¯´åå¤ï¼ä¸å¦ä¸è¡ä»£ç ãè®©æä»¬å¼å§å®æï¼æå»ºä¸ä¸ªå¸¦ç¼å­çFastAPIåºç¨ã</p>
<h3>ð¯ ç¬¬ä¸æ­¥ï¼å®è£ä¾èµ</h3>
<pre class="highlighter-hljs" style="background-color: rgba(246, 248, 250, 1); padding: 15px; border-radius: 5px; overflow-x: auto"><code>pip install fastapi uvicorn redis python-dotenv</code></pre>
<h3>ð¯ ç¬¬äºæ­¥ï¼é¡¹ç®ç»æä¸éç½®</h3>
<pre class="highlighter-hljs" style="background-color: rgba(246, 248, 250, 1); padding: 15px; border-radius: 5px; overflow-x: auto"><code>your_project/
âââ main.py
âââ cache.py
âââ .env
âââ requirements.txt</code></pre>
<p>å¨<code style="color: rgba(186, 55, 42, 1)">.env</code>æä»¶ä¸­éç½®Redisè¿æ¥ï¼</p>
<pre class="highlighter-hljs" style="background-color: rgba(246, 248, 250, 1); padding: 15px; border-radius: 5px; overflow-x: auto"><code>REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=  # é»è®¤æ å¯ç ï¼çäº§ç¯å¢ä¸å®è¦è®¾ï¼
CACHE_DEFAULT_TTL=3600  # é»è®¤ç¼å­è¿ææ¶é´1å°æ¶</code></pre>
<h3>ð¯ ç¬¬ä¸æ­¥ï¼åå»ºRedisè¿æ¥ä¸ç¼å­å·¥å·ç±» (cache.py)</h3>
<pre class="language-python highlighter-hljs"><code>import redis.asyncio as redis  # ä½¿ç¨å¼æ­¥å®¢æ·ç«¯
import json
from functools import wraps
from typing import Any, Optional
import os
from dotenv import load_dotenv

load_dotenv()

class RedisCache:
    def __init__(self):
        self.redis_client: Optional[redis.Redis] = None
        self.default_ttl = int(os.getenv(âCACHE_DEFAULT_TTLâ, 3600))

    async def connect(self):
        """è¿æ¥Redis"""
        if not self.redis_client:
            self.redis_client = redis.Redis(
                host=os.getenv(âREDIS_HOSTâ, âlocalhostâ),
                port=int(os.getenv(âREDIS_PORTâ, 6379)),
                db=int(os.getenv(âREDIS_DBâ, 0)),
                password=os.getenv(âREDIS_PASSWORDâ),
                decode_responses=True  # èªå¨è§£ç è¿åå­ç¬¦ä¸²
            )
        return self.redis_client

    async def disconnect(self):
        """å³é­è¿æ¥"""
        if self.redis_client:
            await self.redis_client.close()

    def cache_key(self, func_name: str, *args, **kwargs) -&gt; str:
        """çæå¯ä¸çç¼å­é®"""
        # ç®åç¤ºä¾ï¼å°å½æ°åååæ°åºåååæ¼æ¥
        arg_str = â_â.join([str(arg) for arg in args])
        kwarg_str = â_â.join([fâ{k}_{v}â for k, v in sorted(kwargs.items())])
        return fâfastapi_cache:{func_name}:{arg_str}:{kwarg_str}â.strip(â:â)

    async def get(self, key: str) -&gt; Any:
        """ä»ç¼å­è·åæ°æ®"""
        if not self.redis_client:
            await self.connect()
        data = await self.redis_client.get(key)
        if data:
            try:
                return json.loads(data)  # ååºååJSON
            except json.JSONDecodeError:
                return data  # å¦æä¸æ¯JSONï¼è¿ååå§å­ç¬¦ä¸²
        return None

    async def set(self, key: str, value: Any, ttl: Optional[int] = None) -&gt; bool:
        """è®¾ç½®ç¼å­"""
        if not self.redis_client:
            await self.connect()
        if isinstance(value, (dict, list)):
            value = json.dumps(value)  # åºååå¤æå¯¹è±¡
        expire_time = ttl if ttl is not None else self.default_ttl
        return await self.redis_client.setex(key, expire_time, value)

    async def delete(self, key: str) -&gt; int:
        """å é¤ç¼å­"""
        if not self.redis_client:
            await self.connect()
        return await self.redis_client.delete(key)

# å¨å±ç¼å­å®ä¾
cache = RedisCache()

def cached(ttl: Optional[int] = None):
    """ç¼å­è£é¥°å¨ï¼å¯å¤ç¨äºä»»ä½å¼æ­¥å½æ°"""
    def decorator(func):
        @wraps(func)
        async def wrapper(*args, **kwargs):
            # çæç¼å­é®
            key = cache.cache_key(func.__name__, *args, **kwargs)
            # å°è¯ä»ç¼å­è·å
            cached_result = await cache.get(key)
            if cached_result is not None:
                print(fâCache HIT for key: {key}â)
                return cached_result
            # ç¼å­æªå½ä¸­ï¼æ§è¡åå½æ°
            print(fâCache MISS for key: {key}â)
            result = await func(*args, **kwargs)
            # å°ç»æå­å¥ç¼å­
            await cache.set(key, result, ttl)
            return result
        return wrapper
    return decorator</code></pre>
<h3>ð¯ ç¬¬åæ­¥ï¼å¨FastAPIåºç¨ä¸­ä½¿ç¨ (main.py)</h3>
<pre class="highlighter-hljs" style="background-color: rgba(246, 248, 250, 1); padding: 15px; border-radius: 5px; overflow-x: auto"><code>from fastapi import FastAPI, Depends, HTTPException
from cache import cache, cached
import asyncio

app = FastAPI(title=âFastAPI Redisç¼å­æ¼ç¤ºâ)

# åºç¨å¯å¨åå³é­äºä»¶
@app.on_event(âstartupâ)
async def startup_event():
    await cache.connect()
    print(ââ Redis connectedâ)

@app.on_event(âshutdownâ)
async def shutdown_event():
    await cache.disconnect()
    print(âð Redis disconnectedâ)

# --- æ¨¡æä¸ä¸ªèæ¶çæ°æ®æ¥è¯¢å½æ° ---
async def fetch_user_data_from_db(user_id: int):
    """æ¨¡æä»æ°æ®åºæ¥è¯¢ç¨æ·æ°æ®ï¼èæ¶æä½ï¼"""
    await asyncio.sleep(2)  # æ¨¡æ2ç§çIOå»¶è¿
    return {âidâ: user_id, ânameâ: fâç¨æ·_{user_id}â, âscoreâ: user_id * 10}

# --- åºç¨ç¼å­çæ¥å£ ---
@app.get(â/user/{user_id}â)
@cached(ttl=30)  # ä¸ºæ­¤æ¥å£åç¬è®¾ç½®30ç§ç¼å­
async def get_user(user_id: int):
    """è·åç¨æ·ä¿¡æ¯ï¼å¸¦ç¼å­ï¼"""
    data = await fetch_user_data_from_db(user_id)
    return {âsourceâ: âdatabase (cached later)â, âdataâ: data}

@app.get(â/user/{user_id}/freshâ)
async def get_user_fresh(user_id: int):
    """è·åç¨æ·ä¿¡æ¯ï¼å¼ºå¶æ¥æ°æ®åºï¼ä¸ç¼å­ï¼"""
    data = await fetch_user_data_from_db(user_id)
    return {âsourceâ: âdatabase (fresh)â, âdataâ: data}

@app.delete(â/cache/user/{user_id}â)
async def delete_user_cache(user_id: int):
    """æå¨å é¤æä¸ªç¨æ·çç¼å­"""
    # æ³¨æï¼è¿ééè¦æ¨¡æçæåæ¥å£ä¸è´çç¼å­é®ï¼å®æä¸­å¯è½éè¦æ´å¤æçé®ç®¡ç
    key_pattern = fâfastapi_cache:get_user:{user_id}â
    deleted = await cache.delete(key_pattern)
    if deleted:
        return {âmessageâ: fâCache for user {user_id} deleted.â}
    raise HTTPException(status_code=404, detail=âCache key not foundâ)

if __name__ == â__main__â:
    import uvicorn
    uvicorn.run(âmain:appâ, host=â0.0.0.0â, port=8000, reload=True)</code></pre>
<p>ç°å¨ï¼è¿è¡<code style="color: rgba(186, 55, 42, 1)">python main.py</code>å¹¶è®¿é® <code style="color: rgba(186, 55, 42, 1)">http://localhost:8000/docs</code> æ¥çèªå¨çæçAPIææ¡£ã</p>
<p><strong style="color: rgba(186, 55, 42, 1)">æµè¯ææï¼</strong></p>
<div>
<p>- é¦æ¬¡è®¿é® <code style="color: rgba(186, 55, 42, 1)">/user/1</code>ï¼ä¼ç­å¾çº¦2ç§ï¼è¿åæ¥æºä¸º<span style="color: rgba(186, 55, 42, 1)"><code>database</code></span>ã</p>
<p>- <strong>30ç§å</strong>åæ¬¡è®¿é® <code style="color: rgba(186, 55, 42, 1)">/user/1</code>ï¼ç¬é´è¿åï¼æ¥æºæ°æ®æ¥èªç¼å­ï¼æ§å¶å°ä¼æå°<span style="color: rgba(186, 55, 42, 1)"><code>Cache HIT</code></span>ã</p>
<p>- è®¿é® <code style="color: rgba(186, 55, 42, 1)">/user/1/fresh</code> åæ»æ¯è®¿é®âæ°æ®åºâã</p>
<p>- è°ç¨ <code style="color: rgba(186, 55, 42, 1)">DELETE /cache/user/1</code> å¯ä»¥æå¨æ¸é¤ç¼å­ã</p>
</div>
<h2>ð¡ ç¬¬åé¨åï¼æ³¨æäºé¡¹ä¸è¿é¶æè</h2>
<div>
<p><strong>1. ç¼å­ç©¿éï¼</strong> æ¥è¯¢ä¸ä¸ªä¸å­å¨çæ°æ®ï¼å¦<span style="color: rgba(186, 55, 42, 1)"><code>user_id=-1</code></span>ï¼ï¼ç¼å­æ°¸è¿ä¸ä¼å½ä¸­ï¼è¯·æ±æ¯æ¬¡é½æå°æ°æ®åºã</p>
<div>
<p>- <strong>è§£å³æ¹æ¡ï¼</strong> å³ä½¿æ²¡æ¥å°æ°æ®ï¼ä¹ç¼å­ä¸ä¸ªç©ºå¼æç¹æ®æ è®°ï¼å¦<span style="color: rgba(186, 55, 42, 1)"><code>NULL</code></span>ï¼ï¼å¹¶è®¾ç½®ä¸ä¸ªè¾ç­çè¿ææ¶é´ã</p>
</div>
<p><strong>2. ç¼å­éªå´©ï¼</strong> å¤§éç¼å­é®å¨åä¸æ¶å»è¿æï¼å¯¼è´ææè¯·æ±ç¬é´æ¶åæ°æ®åºã</p>
<div>
<p>- <strong>è§£å³æ¹æ¡ï¼</strong> ä¸ºç¼å­è¿ææ¶é´æ·»å ä¸ä¸ªéæºå¼ï¼å¦<span style="color: rgba(186, 55, 42, 1)"><code>åºç¡TTL + random.randint(0, 300)</code></span>ï¼ï¼é¿åéä½å¤±æã</p>
</div>
<p><strong>3. ç¼å­æ´æ°ç­ç¥ï¼</strong> æ°æ®åæ´æ¶ï¼å¦ä½åæ­¥æ´æ°ç¼å­ï¼å¸¸ç¨âåæ¶å é¤âï¼Cache-Asideï¼ã</p>
<div>
<p>- æ´æ°æ°æ®åºåï¼<strong style="color: rgba(186, 55, 42, 1)">ç«å³å é¤</strong>å¯¹åºçç¼å­é®ãä¸æ¬¡è¯»åæ¶èªç¶åæºå¹¶éæ°ç¼å­ã</p>
</div>
<p><strong>4. åºååï¼</strong> ç¼å­å¤æå¯¹è±¡ï¼å¦Pydanticæ¨¡åï¼æ¶ï¼è¦ç¡®ä¿å®ä»¬è½è¢«JSONåºååãå¯ä»¥ä½¿ç¨<span style="color: rgba(186, 55, 42, 1)"><code>.dict()</code></span>æ¹æ³å°å¶è½¬ä¸ºå­å¸ã</p>
<p><strong>5. é®çè®¾è®¡ï¼</strong> æ¸æ°çé®å½åç©ºé´ï¼å¦<span style="color: rgba(186, 55, 42, 1)"><code>app:entity:id</code></span>ï¼ä¾¿äºç®¡çåæ¹éæä½ï¼ä½¿ç¨<span style="color: rgba(186, 55, 42, 1)"><code>KEYS</code></span>æ<span style="color: rgba(186, 55, 42, 1)"><code>SCAN</code></span>å½ä»¤ï¼çäº§ç¯å¢æç¨<span style="color: rgba(186, 55, 42, 1)"><code>KEYS</code></span>ï¼ã</p>
<p><strong>6. æéè¦çä¸ç¹ï¼</strong> <strong style="color: rgba(186, 55, 42, 1)">ç¼å­ä¸æ¯ä¸è½çï¼å®æ¯ä¸ç§ç¨ç©ºé´æ¢æ¶é´çæè¡¡ã</strong> ä¸è¦ç¼å­é¢ç¹ååçæ°æ®ãæå°ç»æéæå·²ç»å¾å¿«çæ¥è¯¢ãå§ç»çæ§ç¼å­å½ä¸­çï¼å®æ¯è¡¡éç¼å­æççå³é®ææ ã</p>
</div>
<hr style="border: none; height: 1px; margin: 40px 0">
<p style="text-align: center">---<strong>åå¨æå</strong>---<br>å¸æè¿ä»½æ»ç»è½å¸®ä½ é¿å¼ä¸äºåãå¦æè§å¾æç¨ï¼ä¸å¦¨ç¹ä¸ª èµð æ æ¶èâ­ æ è®°ä¸ä¸ï¼æ¹ä¾¿éæ¶åé¡¾ãä¹æ¬¢è¿å³æ³¨æï¼åç»­ä¸ºä½ å¸¦æ¥æ´å¤ç±»ä¼¼çå®æè§£æãæä»»ä½çé®ææ³æ³ï¼æä»¬è¯è®ºåºè§ï¼ä¸èµ·äº¤æµå¼åä¸­çåç§å¿å¾ä¸é®é¢ã</p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-15 11:14">2026-01-15 11:14</span>&nbsp;
<a href="https://www.cnblogs.com/ymtianyu">ä¸åç¨åºåªå</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19485724);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19485724', targetLink: 'https://www.cnblogs.com/ymtianyu/p/19485724', title: 'FastAPIç¼å­æéå®æï¼ææææä½ ç¨Redisä¸ºæ¥å£æ³¨å¥âè®°å¿â' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å¦ä½ä¸æ­¥æ­¥å° ASP.NET MVC åçº§ä¸º.NET ]]></title>
    <link>https://www.cnblogs.com/powertoolsteam/p/19486260</link>
    <guid>eef0fda8e9295eb819c7b747ea7da91f</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/powertoolsteam/p/19486260" title="åå¸äº 2026-01-15 10:55">
    <span role="heading" aria-level="2">å¦ä½ä¸æ­¥æ­¥å° ASP.NET MVC åçº§ä¸º.NET</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h2 id="å¼è¨">å¼è¨</h2>
<p>å° ASP.NET MVC åºç¨ä».NET Framework åçº§å°ç°ä»£.NET å¹¶ä¸æ¯ç®åççæ¬æåãæ­¤æ¬¡è¿ç§»ä»£è¡¨äºè¿è¡æ¶ãæç®¡æ¨¡åãéç½®ç³»ç»ãä¾èµæ³¨å¥å HTTP æµæ°´çº¿æ¶æçè½¬åãè®¸å¤å¢éä½ä¼°äºè¿ä¸ç¹ï¼æå®å½ä½æ åçæ¡æ¶åçº§ï¼ç»æå¨æµç¨åææåç°ä»ä»¬åºç¨ä¸­çæ ¸å¿åè®¾å·²ç»ä¸åæç«ã</p>
<p>å¥½æ¶æ¯æ¯ï¼Microsoft æä¾äºæç¡®çæå¯¼åæ¨¡å¼ï¼ä½¿å¾æ­£ç¡®æä½æ¶è¿ç§»è¿ç¨å¯é¢æµãæ¬æä»ç»äºä¸ä¸ªå®ç¨çéæ­¥ç­ç¥ï¼å¦ä½å°åºäº.NET Framework æå»ºç ASP.NET MVC 5 åºç¨è¿ç§»å°è¿è¡å¨ç°ä»£.NET ä¸ç ASP.NET Coreï¼åæ¶æå¤§éåº¦å°åå°é£é©ååæºæ¶é´ã</p>
<p>æ¬æåæ¯ä¸ºå·²ç»äºè§£ ASP.NET MVC å¹¶å¸ææä¸æ¡åå®å¯è¡ãåå¤å¥½çäº§çå¼åèåçã</p>
<h3 id="æ­¥éª¤1æ ¹æ®åºç¨å¤§å°éæ©è¿ç§»è·¯å¾">æ­¥éª¤1ï¼æ ¹æ®åºç¨å¤§å°éæ©è¿ç§»è·¯å¾</h3>
<p>éæ©è¿ä¸¤æ¡è·¯ä¸­çä¸æ¡ï¼</p>
<ol>
<li>
<p><strong>å¤§å¤æ°çå®åºç¨çå¢éè¿ç§»</strong><br>
ä½ ä¼å¨æ§åºç¨åé¢æ­å»ºä¸ä¸ªæ°ç ASP.NET Core åºç¨ï¼éæ­¥è¿ç§»è·¯ç±ååè½ï¼è¿ç§»æ¶ä¿ææ§åºç¨çå­å¨ãMicrosoft æ¨èè¿ç§æ¹æ³ç¨äºå¤§è§æ¨¡è¿ç§»ã</p>
</li>
<li>
<p><strong>å°ååºç¨ç Big Bang è¿ç§»</strong><br>
ä½ åå»ºä¸ä¸ªæ°ç ASP.NET Core MVC åºç¨ï¼ç§»æ¤æ§å¶å¨ãè§å¾åæå¡ï¼ç´å°ä¸åè¿è¡å®æ¯ï¼ç¶ååæ¢ã</p>
</li>
</ol>
<p>å¦æä¸ç¡®å®ï¼é»è®¤éç¨å¢éè¿ç§»ï¼å ä¸ºè¿æ ·å¯ä»¥éä½åæ¢é£é©ã</p>
<h3 id="æ­¥éª¤2æ¸ç¹ä»ä¹ä¼é»æ¡ä½ ">æ­¥éª¤2ï¼æ¸ç¹ä»ä¹ä¼é»æ¡ä½ </h3>
<p>ååºè¿ç§»è¿ç¨ä¸­å¸¸éè¦æ¹è¿çä¾èµååºç¨åè½ï¼</p>
<ul>
<li>
<p><strong>System.Web çä½¿ç¨</strong><br>
å HttpContext.CurrentãHttpModulesãHttpHandlersãGlobal.asax ä»¥åç»å¸æµæ°´çº¿åè½è¿äºåè½ä¸ä¼ç´æ¥è¿ç§»ã</p>
</li>
<li>
<p><strong>è®¤è¯ä¸ææ</strong><br>
ASP.NET Core éç¨äºä¸åçæ¨¡å¼ã</p>
</li>
<li>
<p><strong>ä¼è¯ãç¼å­ãéç½®ãæ¥å¿</strong><br>
API åæ¨¡å¼åä¸ç¸åï¼éè¦ææè¯çè¿ç§»è§åã</p>
</li>
</ul>
<p>å¿«éå¯¹ä½ ç NuGet ååä¸ªå¼å®¹æ§æ£æ¥ãå¯¹äºæ¯ä¸ªè½¯ä»¶åï¼æ£æ¥å®æ¯å¦æ¯æ netstandard2.0 æç°ä»£ç½ç»çæ¬ï¼æèæ¯å¦æ ASP.NET Core æ¿ä»£åãæ è®°ææä¸ System.Web ç¸å³çåå®¹ã</p>
<h3 id="æ­¥éª¤3å¨æ¥è§¦ä»£ç åå»ºç«å®å¨åºçº¿">æ­¥éª¤3ï¼å¨æ¥è§¦ä»£ç åå»ºç«å®å¨åºçº¿</h3>
<p>å»ç»å½åç¶æï¼</p>
<ol>
<li>ç»ä»åºæ è®°</li>
<li>ç¡®ä¿ä½ è½æå»ºè§£å³æ¹æ¡å¹¶è¿è¡æµè¯å¥ä»¶</li>
<li>å¦æè¦ççè¾å°ï¼å¯ä»¥å¢å æå å¼ºæµè¯<br>
éç¹å³æ³¨å³é®è·¯ç±ãæææµç¨åæéè¦çä¸å¡æä½ã</li>
</ol>
<p>å¦ææ æ³å¿«éæ·»å æµè¯ï¼è³å°è¦è®°å½çé¾æµè¯èæ¬åé¢æè¾åºã</p>
<h3 id="æ­¥éª¤4ååçº§åºåèèç½é¡µåºç¨">æ­¥éª¤4ï¼ååçº§åºï¼åèèç½é¡µåºç¨</h3>
<p>è¿æ¯æ ææé«çæä½ãå¦æè¿æ²¡æåï¼å°±æè§£å³æ¹æ¡åæå å±ï¼ç½é¡µé¡¹ç®ãåºç¨æå¡ãååãæ°æ®è®¿é®ãå±äº«å·¥å·ã</p>
<p>åç§»æ¤ç±»åºãå¦æå¯è½ï¼æåºè½¬æ¢æç®æ  NetStandard2.0 ä½ä¸ºæ¡¥æ¥ï¼æèç´æ¥é¢åç°ä»£ .NETãä¿®å¤ç¼è¯éè¯¯å¹¶æ¿æ¢ä¸æ¯æç APIã</p>
<p>Microsoft çéç¨ç§»æ¤æå¯¼æ¯è¯ä¼°é¡¹ç®ï¼å¹¶ä»¥éä½åå§åçº§åå¤ææ§çæ¹å¼æ¨è¿åä¸ªé¨åã</p>
<h3 id="æ­¥éª¤5å³å®æ¯å¦ä½¿ç¨è¿ç§»å·¥å·">æ­¥éª¤5ï¼å³å®æ¯å¦ä½¿ç¨è¿ç§»å·¥å·</h3>
<p>ä½ å¯ä»¥ä½¿ç¨ä¸¤ä¸ª Microsoft æ¯æçå·¥å·æä»¤æ¥å å¿«é¨åå·¥ä½éåº¦ï¼</p>
<ol>
<li>
<p><strong>.NET åçº§å©æ</strong><br>
å®å¸®å©åçº§é¡¹ç®å¹¶åæä¸å¼å®¹é®é¢ï¼åæ¬ .NET Framework é¡¹ç®ãå¨æå¸®å©çå°æ¹ä½¿ç¨å®ï¼ä½ä¸è¦ææå®è½å®å¨æ ASP.NET MVC 5 åºç¨èªå¨è½¬åä¸º ASP.NET Core MVCã</p>
</li>
<li>
<p><strong>ASP.NET Framework åºç¨çè¿ç§»å·¥å·</strong><br>
Microsoft æåºï¼å° ASP.NET æ¡æ¶ MVCãWeb API å Web Forms é¡¹ç®åçº§å° ASP.NET Coreï¼æä¾ä¸ç¨çç°ä»£åå·¥å·ã</p>
</li>
</ol>
<p>å¦æä½ æ¿æï¼ä½ ä»ç¶å¯ä»¥æå¨å®ææææä½ï¼ä½å·¥å·å¯ä»¥åå°æ¯ç¥çæºæ¢°ç¼è¾ã</p>
<h3 id="æ­¥éª¤6åå»ºæ°ç-aspnet-core-mvc-ä¸»æºåºç¨">æ­¥éª¤6ï¼åå»ºæ°ç ASP.NET Core MVC ä¸»æºåºç¨</h3>
<p>å³ä½¿æ¯å¢éè¿ç§»ï¼è¿ä¸æ­¥ä¹å¿é¡»ï¼å ä¸ºä½ éè¦ä¸ä¸ª ASP.NET Core åºç¨æè½å¨ç°ä»£.NET ä¸è¿è¡ã</p>
<p>åå»ºä¸ä¸ªæ°ç ASP.NET æ ¸å¿ MVC é¡¹ç®ï¼ä½¿ç¨æ åç ASP.NET æ ¸å¿ MVC æ¨¡æ¿ãæ·»å ä½ çæ ¸å¿åãæ¥å¿ãéç½®å DI ç»æã</p>
<p>å¨ ASP.NET Core ä¸­ï¼Program.cs éç½®ä¸»æºåä¸­é´ä»¶æµæ°´çº¿ãæ²¡æ Global.asaxãæ·»å ä¸äºä½ è¯å®éè¦çåºç¡ä¸­é´ä»¶ï¼è·¯ç±ãéææä»¶ãè®¤è¯åææï¼å¦éç¨ï¼ãMVC ç«¯ç¹ã</p>
<p>æå°ç¤ºä¾å½¢ç¶ï¼</p>
<pre><code class="language-csharp">var builder = WebApplication.CreateBuilder(args);

builder.Services.AddControllersWithViews();

var app = builder.Build();

app.UseStaticFiles();
app.UseRouting();

app.MapControllerRoute(
    name: "default",
    pattern: "{controller=Home}/{action=Index}/{id?}");

app.Run();
</code></pre>
<h3 id="æ­¥éª¤7åç§»å¨è·¯ç±ç¶åæ¯æ§å¶å¨æåæ¯è§å¾">æ­¥éª¤7ï¼åç§»å¨è·¯ç±ï¼ç¶åæ¯æ§å¶å¨ï¼æåæ¯è§å¾</h3>
<p>Microsoft ç MVC å°æ ¸å¿ç¤ºä¾æ»ç¥ä»è®¾ç½®å¼å§ï¼ç¶åæ¯æ§å¶å¨åè§å¾ï¼æåæ¯éæåå®¹åå®¢æ·ç«¯ä¾èµãéµå¾ªè¿ä¸ªé¡ºåºï¼å ä¸ºè¿æ ·å¯ä»¥è®©è¿ç§»å¨æ¯ä¸æ­¥é½å¯æµè¯ã</p>
<p><strong>è¿ç§»è·¯ç±</strong><br>
å¨ MVC 5 ä¸­ï¼ä½ å¾å¯è½ç¨è¿ RouteConfigï¼å¯è½è¿ç¨äºå±æ§è·¯ç±ãå¨ ASP.NET Core ä¸­ï¼ä½ éç½®ä¸­é´ä»¶æµæ°´çº¿åç«¯ç¹æ å°ä¸­çè·¯ç±ã</p>
<p><strong>è¿ç§»æ§å¶å¨</strong><br>
ä¸æ¬¡è¿ç§»ä¸ä¸ªæ§å¶å¨ãå¤å¶ä¸ä¸ªæ§å¶å¨ç±»ãéè¿æ´æ¢å½åç©ºé´åæ¿æ¢ä¾èµ System.Web çä»£ç æ¥ä¿®å¤ç¼è¯éè¯¯ãç¨æ§å¶å¨ HttpContext è®¿é®æ¿ä»£ HttpContext.Current æ¨¡å¼ã</p>
<p><strong>è¿ç§»è§å¾</strong><br>
Razor è¯­æ³ç±»ä¼¼ï¼ä½è¾å©å¨åä¸äºåè½ææä¸åãéè¦çå°æ¹è½¬æ¢ HTML è¾å©å·¥å·ï¼å¿è¦æ¶ä½¿ç¨æ ç­¾è¾å©å·¥å·ã</p>
<p>ä½ å¾å¯è½ä¼å¼å¥ ViewImports.cshtml å ViewStart.cshtml çæ¨¡å¼ã</p>
<h3 id="æ­¥éª¤8ç§»å¨éææä»¶åå®¢æ·ç«¯ä¾èµ">æ­¥éª¤8ï¼ç§»å¨éææä»¶åå®¢æ·ç«¯ä¾èµ</h3>
<p><strong>éææä»¶</strong><br>
å¨ MVC 5 ä¸­ï¼ä½ å¯è½ç¨è¿åå®¹åèæ¬ççº¦å®ãå¨ ASP.NET Core ä¸­ï¼é»è®¤æ¯ wwwroot å  UseStaticFiles ä¸­é´ä»¶ã</p>
<p><strong>æç»ä¸ç²¾ç®</strong><br>
å¦æä½ ä¾èµ System.Web.Optimizationï¼å¯ä»¥ç¨ç°ä»£åç«¯æå»ºæµæ°´çº¿æå¶ä»æ¯æçæ¹æ³æ¿ä»£å®ã</p>
<p>Microsoft çç¤ºä¾è¿ç§»æµç¨æç¡®æåºéæåå®¹åå®¢æ·ç«¯ä¾èµæ¯æ©æè¿ç§»æ­¥éª¤ã</p>
<h3 id="æ­¥éª¤9å°éç½®ä»-webconfig-è¿ç§»å°-appsettings">æ­¥éª¤9ï¼å°éç½®ä» Web.config è¿ç§»å° appsettings</h3>
<p>ç¡®å®ä½ å¨ Web.config ä¸­å­å¨äºä»ä¹ï¼è¿æ¥ä¸²ãåºç¨è®¾ç½®ãè®¤è¯è®¾ç½®ãèªå®ä¹éç½®é¨åã</p>
<p>å°è®¾ç½®è¿ç§»å° appsettings.json åç¯å¢ç¹å®ç appsettings æä»¶ä¸­ãéè¿æå»ºå¨è¯»å ASP.NET æ ¸å¿éç½®ç³»ç»ä¸­çè®¾ç½®ã</p>
<p>Microsoft æä¸é¨ç MVC è¿ç§»ç¤ºä¾ä¸­çè¿ç§»éç½®æåã</p>
<h3 id="æ­¥éª¤10è¿ç§»è®¤è¯åææ">æ­¥éª¤10ï¼è¿ç§»è®¤è¯åææ</h3>
<p>ç¡®å®ä½ å½åçè®¤è¯æ¨¡åï¼è¡¨åè®¤è¯ãOWIN cookiesãASP.NET MVC 5 ä¸­çèº«ä»½ãWindows è®¤è¯ã</p>
<p>å¨ ASP.NET Core ä¸­å®ç°ç±»ä¼¼çï¼</p>
<ol>
<li>å¨ DI ä¸­éç½®è®¤è¯æå¡</li>
<li>å¨æµç¨ä¸­å å¥ä¸­é´ä»¶</li>
<li>ç«¯å£ææå±æ§åç­ç¥</li>
</ol>
<p>Microsoft ç MVC è¿ç§»ç¤ºä¾æåäºéå¯¹è®¤è¯åèº«ä»½è¿ç§»çä¸é¨æå¯¼ï¼å ä¸ºè¿éå¸¸æ¯è¾ä¸ºç¹éçé¨åä¹ä¸ã</p>
<h3 id="æ­¥éª¤11è¿ç§»æ°æ®è®¿é®">æ­¥éª¤11ï¼è¿ç§»æ°æ®è®¿é®</h3>
<p><strong>å¦æä½ ä½¿ç¨å®ä½æ¡æ¶6</strong><br>
ä½ éå¸¸å¯ä»¥ä¿ç EF6 ä¸æ®µæ¶é´ï¼å³ä½¿æ¯å¨ç°ä»£.NET ä¸ï¼è¿åå³äºä½ çéç½®ãä»é¿è¿æ¥çï¼è®¸å¤å¢éè½¬å EF Core ä»¥è·åç°ä»£åçæ¨¡å¼ååè½ã</p>
<p><strong>å¦æä½ ç¨ ADO.NET æ Dapper</strong><br>
è¿äºéå¸¸è½å¹²åå°ç§»æ¤ï¼ä½ä½ ä¼æ´æ°éç½®åä¾èµæ³¨å¥æ¨¡å¼ã</p>
<h3 id="æ­¥éª¤12è¿è¡åºç¨ä¿®å¤è¿è¡æ¶é®é¢ç¶åè¿è¡ä¼å">æ­¥éª¤12ï¼è¿è¡åºç¨ï¼ä¿®å¤è¿è¡æ¶é®é¢ï¼ç¶åè¿è¡ä¼å</h3>
<p>æè¿ä¸ªå¸åé¡ºåºä¿®å¤è¿è¡æ¶é®é¢ï¼</p>
<ol>
<li>éç½®ä¸ç¯å¢å·®å¼</li>
<li>ä¸­é´ä»¶æåºé®é¢</li>
<li>èº«ä»½éªè¯ä¸ Cookie</li>
<li>ä¼è¯ä¸ç¼å­è¡ä¸º</li>
</ol>
<p>è¿è¡èªå¨åæµè¯åçé¾æµè¯ãå¨éå½æåµä¸æ·»å ç»æåæ¥å¿åå¥åº·æ£æ¥ã</p>
<h3 id="æ­¥éª¤13å¦æä½ éæ©äºå¢éè¿ç§»è®¾ç½®åé¨core-åºç¨">æ­¥éª¤13ï¼å¦æä½ éæ©äºå¢éè¿ç§»ï¼è®¾ç½®"åé¨"Core åºç¨</h3>
<p>å¯¹äºå¢éè¿ç§»ï¼å³é®ä¸¾æªæ¯å° ASP.NET æ ¸å¿åºç¨ç½®äºç°æç.NET Framework åºç¨ä¹åï¼å¹¶éè·¯ç±è¿ç§»ãMicrosoft å³äºå¢éè¿ç§»ç"å¥é¨æå"æ¨èéç¨ä»£çåçº¿æ¹æ³è¿è¡å¤§è§æ¨¡è¿ç§»ã</p>
<p>ä½ çæµç¨åæï¼</p>
<ol>
<li>è·¯ç± A ç± ASP.NET æ ¸å¿å¤çï¼å¶ä»ææè·¯ç±ä»£çå° MVC 5</li>
<li>ä¸æ¬¡ç§»å¨ä¸ä¸ªåç´åç</li>
<li>å½ææè·¯çº¿é½è¢«è¿ç§»åï¼å³é­æ§ç MVC 5 åºç¨</li>
</ol>
<h3 id="æ­¥éª¤14çäº§åæ¢æ¸å">æ­¥éª¤14ï¼çäº§åæ¢æ¸å</h3>
<p><strong>ä¸»æ</strong><br>
å³å® IIS å¨æµç¨ä¸­ãIIS å¨æµç¨å¤ï¼è¿æ¯å®¹å¨ã</p>
<p><strong>å¯è§æµæ§</strong><br>
å¨å¢éè¿ç§»è¿ç¨ä¸­ï¼ä¸¤ä¸ªåºç¨çæ¥å¿ãææ åè¿½è¸ªé½å¯¹é½äºã</p>
<p><strong>å®å¨</strong><br>
Cookie è®¾ç½®ãæ°æ®ä¿æ¤å¯é¥ãTLSãå¤´é¨ã</p>
<p><strong>æ§è½</strong><br>
è¿ç§»åç¡®è®¤ç¼å­åä¼è¯è¡ä¸ºã</p>
<h2 id="ç»è®º">ç»è®º</h2>
<p>å° ASP.NET MVC åºç¨ä».NET Framework è¿ç§»å°ç°ä»£.NET æ¯ä¸é¡¹æç¥æèµï¼èéæºæ¢°åçº§ãæ­£ç¡®æ§è¡æ¶ï¼å®è½å¸¦æ¥æ´æ¸æ°çæ¶æãæ§è½æåãäºåå¤åº¦æåä»¥åé¿æå¹³å°æ¯æã</p>
<p>éè¿å°è¿ç§»æåä¸ºæè®¡åãå¯æµè¯çæ­¥éª¤ï¼å¹¶ä¼åå³æ³¨æ¶æèéè¯­æ³ï¼å¢éå¯ä»¥èªä¿¡å°ç°ä»£åï¼åæ¶ä¸æ°ä¹±çäº§ç³»ç»ã</p>
<p>è¿ç§æ¹æ³å¨ç°å®ä¼ä¸è¿ç§»ä¸­å·²è¢«åå¤è¯æææï¼å¹¶ä¸ç¬¦å Microsoft æ¨èç ASP.NET åºç¨ç°ä»£åæç¥ã</p>

</div>
<div id="MySignature" role="contentinfo">
    <hr>
<br>
<p style="font-size: 16px; font-family: å¾®è½¯éé», é»ä½, Arial; color: #000">æ¬ææ¯ç±è¡èåææ¯å¼åå¢éåå¸ï¼è½¬è½½è¯·æ³¨æåºå¤ï¼<a href="https://www.grapecity.com.cn/" target="_blank">è¡èåå®ç½</a></p>
<!--p style="font-size: 16px; font-family: å¾®è½¯éé», é»ä½, Arial; color: #000">äºè§£ä¼ä¸çº§ä½ä»£ç å¼åå¹³å°ï¼è¯·åå¾<a href="https://www.grapecity.com.cn/solutions/huozige" target="_blank">æ´»å­æ ¼</a>
</p><p style="font-size: 16px; font-family: å¾®è½¯éé», é»ä½, Arial; color: #000">äºè§£å¯åµå¥æ¨ç³»ç»çå¨çº¿ Excelï¼è¯·åå¾<a href="https://www.grapecity.com.cn/developer/spreadjs" target="_blank">SpreadJSçº¯åç«¯è¡¨æ ¼æ§ä»¶</a></p>
<p style="font-size: 16px; font-family: å¾®è½¯éé», é»ä½, Arial; color: #000">äºè§£åµå¥å¼çåä¸æºè½åæ¥è¡¨è½¯ä»¶ï¼è¯·åå¾<a href="https://www.grapecity.com.cn/solutions/wyn" target="_blank">Wyn Enterprise
</a></p-->

<br>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-15 10:55">2026-01-15 10:55</span>&nbsp;
<a href="https://www.cnblogs.com/powertoolsteam">è¡èåææ¯å¢é</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19486260);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19486260', targetLink: 'https://www.cnblogs.com/powertoolsteam/p/19486260', title: 'å¦ä½ä¸æ­¥æ­¥å° ASP.NET MVC åçº§ä¸º.NET' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ vivo å¾®æå¡æ¶æå®è·µä¹ Dubbo æ§è½ä¼å ]]></title>
    <link>https://www.cnblogs.com/vivotech/p/19486239</link>
    <guid>36d01478759fc8e0c4acd4682af37e67</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/vivotech/p/19486239" title="åå¸äº 2026-01-15 10:52">
    <span role="heading" aria-level="2">vivo å¾®æå¡æ¶æå®è·µä¹ Dubbo æ§è½ä¼å</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        å¨Javaææ¯æ åºæ¯ï¼vivoä¸»è¦åºäº Apache Dubbo æ¡æ¶æ¥ä½ä¸ºå¾®æå¡ä¹é´çéä¿¡æ¡¥æ¢ï¼å¨åé¨ä¸å¡çå¤§è§æ¨¡å®è·µè¿ç¨ä¸­ï¼æä»¬ç¢°å°äºè´¨éãæ§è½åå®¹éç­æ¹é¢çææï¼éè¿ä¸ç³»åçæ©å±ä¸ä¼åï¼è¾å¥½çè§£å³äºç¸å³é®é¢ï¼å©åä¸å¡æ´å¥½ä¿éè´¨éï¼èçç®åææ¬ï¼æåç åæçã
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<blockquote>ä½èï¼äºèç½ä¸­é´ä»¶å¢é-Zhang Zhenwei<br>æ¬æä¸º2025å¹´ vivo å¼åèå¤§ä¼äºèç½ææ¯ä¸åºåäº«åå®¹ä¹ä¸ï¼å¨å¾®ä¿¡å¬ä¼å·ãvivoäºèç½ææ¯ãå¯¹è¯æ¡åå¤ã2025VDCãè·å 2025VDC äºèç½ææ¯ä¼åºè®®é¢ç¸å³èµæã<br><br>å¨Javaææ¯æ åºæ¯ï¼vivoä¸»è¦åºäº Apache Dubbo æ¡æ¶æ¥ä½ä¸ºå¾®æå¡ä¹é´çéä¿¡æ¡¥æ¢ï¼å¨åé¨ä¸å¡çå¤§è§æ¨¡å®è·µè¿ç¨ä¸­ï¼æä»¬ç¢°å°äºè´¨éãæ§è½åå®¹éç­æ¹é¢çææï¼éè¿ä¸ç³»åçæ©å±ä¸ä¼åï¼è¾å¥½çè§£å³äºç¸å³é®é¢ï¼å©åä¸å¡æ´å¥½ä¿éè´¨éï¼èçç®åææ¬ï¼æåç åæçã</blockquote>
<p>&nbsp;</p>
<p>1åéçå¾ææ¡æ ¸å¿è§ç¹ð</p>

<img data-caption="" data-size="normal" data-rawwidth="864" data-rawheight="1232" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-4520d869a91ec5f5c3c43de8d1c39c83~resize:0:q75.gif?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-c778a0fab3719ab0ee7ef7b6e70b29da&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-4520d869a91ec5f5c3c43de8d1c39c83~resize:1440:q75.gif?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-43a419cd3574f9956446278827cc71ac&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-4520d869a91ec5f5c3c43de8d1c39c83~resize:1440:q75.gif?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-832fdf7dbe52a479345bbccd0b79ebb0&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>&nbsp;</p>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="1540" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-9b55ae883b615bbe0e824925bb1c7012~resize:0:q75.png?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-c88d609f3488d9199fa1cdf9f47df007&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-78fa6d5a5ad5191be91dabfc38b627b2~resize:1440:q75.png?source=1f5c5e47&amp;expiration=1768448939&amp;auth_key=1768448939-0-0-535c67c9c475f2d576ad309b7e802807&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-9b55ae883b615bbe0e824925bb1c7012~resize:1440:q75.png?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-f0c513cce9a78acc4c0b67d3a659455e&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p><em>å¾1 VS å¾2ï¼æ¨æ´å¾åäºåªå¼ å¾æ¥è¾å©çè§£å¨æå¢ï¼æ¬¢è¿å¨è¯è®ºåºçè¨ã</em></p>
<p>&nbsp;</p>
<h2>ä¸ãDubbo å¨ vivo çæ¼è¿åç¨</h2>
<h2>1.1 vivo å¾®æå¡ç°ç¶</h2>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-c8e51bfdd00f756cb9b0f4211b6eeeef~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-57e14872d50e250e4671e4cccb6df122&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-3ae10d872624950422f7d4a52c95dc6b~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448939&amp;auth_key=1768448939-0-0-fe0abad9b3be5212a90972c0bc3f89d2&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-c8e51bfdd00f756cb9b0f4211b6eeeef~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-a3fe80ba0ac01cfa9374097d56ba56f5&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>vivoèª2015å¹´éè¿å¾®æå¡æ¶æåçº§ä»¥èµè½ä¸å¡å¢é¿ï¼éè¿å¨ç½æ²»çï¼äº2018å¹´å®æäºå¨ç½Javaææ¯æ RPCæ¡æ¶ç»ä¸ä¸ºDubboã ç®åï¼è¯¥æ¶æé«ææ¯æäº5äº¿ç¨æ·ãè¦ç60+å°åºçä¸å¡ä½éï¼å®ç°äºä¸çº§å¾®æå¡å¨åä¸çº§æºå¨ä¸çç¨³å®è¿è¡ï¼æ¥åRPCè°ç¨éé«è¾¾8000äº¿æ¬¡ã</p>
<p>&nbsp;</p>
<h2>1.2 Dubboå¨vivoçæ¼è¿åå²</h2>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-dd7efc1163e924bc5605d75d829f3790~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-e5936dd99daa3d46496446df5f3d6384&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-5bd44f738fe76e76acf00b81edbfa3ee~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-effad177242a085c4a9ce115ffce615d&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-dd7efc1163e924bc5605d75d829f3790~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-ad71afaa03fba2c30bc4e0b3271d3384&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>Dubbo æ¯ä¸æ¬¾ RPC æå¡å¼åæ¡æ¶ï¼ä¸»è¦ç¨äºè§£å³å¾®æå¡æ¶æä¸­çéä¿¡ä¸æå¡æ²»çé®é¢ãå®æä¾äºæå¡å®ä¹ï¼æå¡åç°ãè´è½½åè¡¡ãæµéç®¡æ§ç­ä¸°å¯è½åãvivoå¨2015å¹´ï¼å¼å¥å¼æºç¤¾åºDubboä½ä¸ºJavaææ¯æ RPCæ¡æ¶ãèéä¸å¡è§æ¨¡åå±ï¼ä¸å¡ä¾§æµ®ç°æ¡æ¶çæ¬ç¢çåç°è±¡ï¼äº§çæ²»çå°é¾ï¼ç»´æ¤ææ¬é«ç­é®é¢ã å¨19å¹´ï¼vivoå¼å¥å¼æºç¤¾åº2.7.* çæ¬åå¸ä½ä¸ºç¬¬ä¸ä¸ªåºçº¿çæ¬ï¼å¯¹ä¸å¡ä¾§è¿è¡äºçæ¬æ¶æãéååå¸ä¸¤ä¸ªå¤§åºçº¿çæ¬ï¼åå«ä¸ºå»ºè®¾ä¸ä¸­å¿åç¦»è½åï¼ååºç¨çº§æ³¨ååç°è½åã</p>
<p>&nbsp;</p>
<h2>1.3 Dubboæ§è¡æ ¸å¿é¾è·¯ï¼æ¦è¦ï¼</h2>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-d7845ca97d67cd4cc6b4f78b9374efb9~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-33fc9cd18540e0d391a93f1266ec6532&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-e8cef37940ef98e5b983a9bf53a64b90~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-ee5f9584f95763cbf90faf4d9f487d27&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-d7845ca97d67cd4cc6b4f78b9374efb9~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-6724b04cb5843b2142e16bb79d18f9f7&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>æä»¬åç®è¦ä»ç»ä¸ä¸Dubboçæ´ä½æµç¨ã æµç¨å¯åä¸ºä¸ä¸ä¸¤é¨åãä¸åé¨ååç°äºç±æä¾æ¹ãæ¶è´¹æ¹ãæ³¨åä¸­å¿ååæ°æ®ä¸­å¿ï¼ååå®æçæå¡æ³¨åä¸å¼å¥ã ä¸åé¨åä¸ºè°ç¨æµç¨ãDubboéç¨å¾®åæ ¸ä¸æä»¶åè®¾è®¡ï¼åé¨å¤ä¸ªæ½è±¡å±æ¬¡ã</p>
<p>&nbsp;</p>
<p> æ»ä½èè¨ï¼ä¸æ¬¡RPCæµç¨å¯åä¸ºä¸¤ç±»ï¼ </p>
<ul>
<li>ä¸æ¯å¯å¨å³å°±ç»ªçéæè¿ç¨ï¼å¦ä»£ççæãæå¡åè¡¨ç¼å­ï¼ </li>
<li>äºæ¯æ¯æ¬¡è°ç¨åéå¨æè®¡ç®çé¨åï¼å¦è·¯ç±ãè´è½½åè¡¡ãåºååï¼ç¼è§£ç ï¼ï¼è¿äºå¸¸æ¯æ§è½ç­ç¹ã</li>

</ul>
<p>&nbsp;</p>
<h2>äºãDubbo è·¯ç±æ©å±åä¼å</h2>
<h2>2.1 Dubboè·¯ç±ç®ä»</h2>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-6dd772f935cd449a1eb900ccdfbbcfe7~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-fff7dc5f04355d05f59e4cffae65ad66&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-92b612b1372299eb16bab6f2d305df86~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-1e1da5974b9f0a859d746a9d8f010441&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-6dd772f935cd449a1eb900ccdfbbcfe7~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-f83732ba6cd52b502891bee214090226&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>Dubboè·¯ç±æ¯ä¸å¥åºäºè§åçç²¾ç»åæµéæ²»çç»ä»¶ï¼å¶å·¥ä½æµç¨ç±æå¡æ²»çä¾§åDubboä¸åè·¯ç±ç­ç¥ï¼ä»èç¡®ä¿RPCè¯·æ±è½å¤è¢«ç²¾åçè·¯ç±è³é¢æçæå¡å®ä¾åè¡¨ãè¯¥æºå¶æ¯æ¯æç°åº¦åå¸ãæºæ¿å®¹ç¾ãç¯å¢éç¦»ç­æµéæ²»çè½åçææ¯åºç³ã å¼æºçæ¬çDubboæä¾äºåºç¨çº§æ ç­¾è·¯ç±ãæ¡ä»¶è·¯ç±åèæ¬è·¯ç±ç­æ ¸å¿è·¯ç±è½åãæä»¬å¨å¶åºç¡ä¸ï¼æ©å±å®ç°äºæ¥å£çº§æ ç­¾è·¯ç±ä¸å°±è¿è·¯ç±ä¸¤ç§å¢å¼ºæºå¶ã</p>
<p>&nbsp;</p>
<h2>2.2 å°±è¿è·¯ç±</h2>
<h3>2.2.1 å°±è¿è·¯ç±èæ¯è¯´æ</h3>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-493b71599990cc0c26504cbce2f9ce73~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448939&amp;auth_key=1768448939-0-0-9f5d534a9c61cfcea4901d7ad414f292&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-440622969c0de6ff3f22b695cdf13a30~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448940&amp;auth_key=1768448940-0-0-1a497fff0b5729b2cb0d066b0b1c128a&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-493b71599990cc0c26504cbce2f9ce73~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-25f336ea2f66a5a1a1b7b92e3a205f13&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>ä¸è¬æåµä¸ï¼åæºæ¿åé¨çç½ç»è°ç¨å¹³åæ¶å»¶å¨0.1mså·¦å³ï¼èååå¤æºæ¿é´çå¹³åæ¶å»¶å¨1ms-5msï¼è·¨å°åæºæ¿ä¹é´çç½ç»æ¶å»¶åæ´å¤§ã åè®¾åé¨æå¡å­å¨å¤§éè·¨æºæ¿è°ç¨ï¼å°¤å¶éå¯¹rtææä¸å¡ï¼å¯è½å ä¸ºè¯·æ±å»¶æ¶çå¢å ï¼å½±åæå¡è´¨éç¨æ·ä½éªã å æ­¤Dubboå°±è¿è·¯ç±åºè¿èçï¼å¶å¯å®ç°RPCè¿ç¨ä¼åä½¿ç¨åæºæ¿è¿è¡è°ç¨ã å¯ä»¥çå°ä¸å¾ï¼æä¾æ¹å¨æ³¨åä¼ä¸æ¥æºæ¿ä¿¡æ¯ï¼æ¶è´¹æ¹è°ç¨ç»è¿å°±è¿è·¯ç±ï¼åªå¹éåæºæ¿çæä¾æ¹èç¹åè¡¨ã</p>
<p>&nbsp;</p>
<h3>2.2.2 å°±è¿è·¯ç±åºæ¯åæ</h3>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-4e6941681d2808b5d5e21aebf05d94c5~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-ab6893c2cf71a2630c35ee52ca1d67e6&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-a9ac3f92430891f1ec3a9c570b157dbc~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-76d8a2ab99dc781a931ff4fb13384217&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-4e6941681d2808b5d5e21aebf05d94c5~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-373b607364a5efd6f2eafec53a152c23&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>æä»¬ççæ³æ¹æ¡å¦ä¸æ¹æç¤ºï¼æ¯å¤æºæ¿å±äº«æ³¨åä¸­å¿ï¼æµéå¨å°±è¿è·¯ç±çå¹²æ¶ä¸ï¼å¨åæºæ¿åæµè½¬ã ä½æ­¤æ¹æ¡é¢ä¸´ä¸æ¹ä¸¤ä¸ªé®é¢ï¼ å­å¨é¨åä¸å¡åæºæ¿é¨ç½²ç°è±¡ï¼è¥å¼ºå¶è¿è¡åæºæ¿è°ç¨ï¼ä¼é ææ¶è´¹æ¹æ å¯ç¨æä¾èã åæ¶å­å¨å¤æºæ¿éååé¨ç½²ç°è±¡ï¼è¥æºæ¿é´é¨ç½²è§æ¨¡å·®å¼è¾å¤§ï¼åæºæ¿è°ç¨å¯è½é æå°è§æ¨¡é¨ç½²æºæ¿çä¸å¡éç¾¤éªå´©ã</p>
<p>&nbsp;</p>
<h3>2.2.3 å°±è¿è·¯ç±å®è·µ</h3>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-0f8ce3b11ab7b81f20241b6115827e3d~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-edfc55e932a4f74cd078d8716974120f&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-b2c05e67b81945f23c431414a8c7e40f~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-a0d250f09e8d9e4c620e3a2b573385c3&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-0f8ce3b11ab7b81f20241b6115827e3d~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-b3bdf2534e22d4f33adff6377581121b&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>ä¸ºè§£å³åæçé®é¢ï¼æä»¬æç»å®ç°å¦ä¸ï¼</p>
<ul>
<li>ä¸­é´ä»¶èåCI/CDä¾§ï¼å¨æä¾æ¹æå¡é¨ç½²æ¶ä¸æ¥æºæ¿ä¿¡æ¯ã</li>
<li>æ¶è´¹æ¹è°ç¨ç»è¿å°±è¿è·¯ç±æ¶ä¼éåæä¾æ¹åè¡¨ï¼ä¼åç­éåæºæ¿æä¾æ¹å®ä¾ã</li>
<li>æ°å¢éå¼å¤æ­ï¼å½åæºæ¿æä¾æ¹æºå¨è§æ¨¡ä½äºéå¼æ¶ï¼è·¯ç±ä¼èªå¨éçº§è¿è¡å¨éè®¿é®ãè¿æ ·å¯ä»¥ææé¿ååæºæ¿é¨ç½²çæ æä¾èé®é¢ ï¼ä»¥åéä½éååé¨ç½²æ¶çéç¾¤éªå´©é£é©ã</li>

</ul>
<p>&nbsp;</p>
<p>ç¨ä¸è¾¹çä¸ä¸ªè¯·æ±ä¸¾ä¾ï¼å¨å°±è¿è·¯ç±é¶æ®µï¼ </p>
<ul>
<li><strong>è¯·æ±1 </strong>åç°åæºæ¿æä¾èé¨ç½²è§æ¨¡è¶è¿éå¼ï¼å±äºå®å¨è°ç¨ï¼ç´æ¥è¿æ»¤åº01æºæ¿èç¹ã </li>
<li><strong>è¯·æ±2 </strong>åç°åæºæ¿æ å¯ç¨æä¾èï¼åç´æ¥è§¦åéçº§è§åï¼è¿åå¨éèç¹ã</li>
<li><strong>è¯·æ±3 </strong>å¨å°±è¿è·¯ç±é¶æ®µï¼åç°åæºæ¿è½æå¯ç¨æä¾èé¨ç½²ï¼ä½è§æ¨¡ä½äºéå¼ï¼ä¹ç´æ¥è§¦åéçº§è§åï¼è¿åå¨éèç¹ã</li>

</ul>
<p>&nbsp;</p>
<p>ç»¼ä¸ï¼å°±è¿è·¯ç±éè¿ç®åçåæ°æ®æ è®°åçµæ´»çéå¼è§åï¼å®ç°äºæµéçèªå¨ä¼åä¸éç¦»ãå¶æ¹é è¿ç¨å¯¹ä¸å¡ä»£ç æ ä¾µå¥ï¼å¹¶å¸¦æ¥å»¶è¿éä½ãç½ç»å¸¦å®½ææ¬ä¸éãç¨³å®æ§æåçå·¨å¤§æ¶çã</p>
<p>&nbsp;</p>
<h2>2.3 æ ç­¾è·¯ç±è½åè¯´æ</h2>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-61edb3db431bc4193c1531273874f3fc~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-b0bd2799964e134a6cf0ca33eb28eadd&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-60a5458159a4fdbea83e44839242b155~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-727145d4de3964b50f4b3d575cab6626&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-61edb3db431bc4193c1531273874f3fc~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-2739644d2b302b2345f4c773c071a8e4&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>æ¥ä¸æ¥æ¯æ ç­¾è·¯ç±ï¼æ ç­¾è·¯ç±æ¯ä¸ç§å¨å¾®æå¡æ¶æä¸­ç¨äºå®ç°æµéç²¾ç»æ§å¶çæå¡æ²»çç­ç¥ã</p>
<p>&nbsp;</p>
<p>å¶æ ¸å¿ææ³æ¯éè¿æ§å¶é¢ä¸ºæå¡å®ä¾æä¸èªå®ä¹æ ç­¾ï¼æ ç­¾è·¯ç±æ ¹æ®æ¶è´¹æ¹è°ç¨æ¶æå®çæ ç­¾ï¼å°è¯·æ±æµéè·¯ç±å°å¹éè¿äºæ ç­¾çæä¾æ¹å®ä¾ã å¨Dubboè¯­ä¹ä¸­ï¼Dubboæ ç­¾åä¸ºå¨ææ ç­¾ä¸éææ ç­¾ï¼å¦å¾æç¤ºï¼æä»¬ç¨éè¿éç½®ä¸­å¿ä¸åå¨ææ ç­¾ï¼æ è®°gray1åå«aèç¹ï¼æ è®°gray2åå«cèç¹ï¼ç¨äºæ è¯ä¸¤ä¸ªç°åº¦ç¯å¢ã èæä¾æ¹é¨ç½²æ¶å¯ä»¥èªå¸¦éææ ç­¾ï¼éææ ç­¾éDubboæ³¨ååç°æµç¨è¢«æ¶è´¹æ¹å¨åå­ç¼å­ã</p>
<p>&nbsp;</p>
<p>ä»¥ä¸ä¸ªè¯·æ±ä¸¾ä¾ï¼ </p>
<ul>
<li><strong>è¯·æ±1</strong> æå®äºgray1ï¼æ ç­¾è·¯ç±ä¼éåæä¾æ¹åè¡¨ä¸gray1å¯¹åºçåè¡¨è¿è¡äº¤éè®¡ç®ï¼æåè¿æ»¤aèç¹ã </li>
<li><strong>è¯·æ±2</strong> æå®gray3ï¼æ ç­¾è·¯ç±åç°æ å¯ç¨èç¹ï¼åè¯·æ±ä¼éçº§å°æ æ ç­¾çæºå¨ï¼æåè¿æ»¤b,d,eèç¹ã </li>
<li><strong>è¯·æ±3</strong> æªæå®æ ç­¾ï¼è¯´ææ¯åºçº¿ç¯å¢è°ç¨ï¼æ ç­¾è·¯ç±ä¼ç­éæªææ ç­¾çæºå¨ï¼æåè¿æ»¤b,d,eèç¹ã</li>

</ul>
<p>&nbsp;</p>
<h2>2.4 æä»¬åç°çæ§è½é®é¢</h2>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-9ef3cf11ecbb0efc87f39b15ce75aac1~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-49286aeeff8d93175c7dec9006b30cba&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-b621a89981982a32ad345fc2a1cd69ca~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-4a756986fa361a6aa2be9d849699032e&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-9ef3cf11ecbb0efc87f39b15ce75aac1~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-c3cfa16483b29b29695b82858bebb231&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>å¨vivoå¤§è§æ¨¡ Dubbo æä¾æ¹éç¾¤åºæ¯ä¸ï¼é«å³°æè¯¥ä¸å¡æ¶è´¹æ¹ä¾§åºç¨çæ´ä½ CPU å©ç¨ççº¦ä¸º60%ï¼èå¶ä¸­è´è½½åè¡¡æ¨¡ååè·¯ç±æ¨¡åç CPU å ç¨çç«è¶è¿äº30%ï¼ éè¿ç«ç°å¾åæå¯ä»¥è§å¯å°è¿äºé®é¢å­å¨å±æ§ ï¼ ç¸å³æ¹æ³åæ¶åéåæä½ï¼å¶æ¶é´å¤æåº¦ä¸æä¾æ¹èç¹æ°éææ­£ç¸å³ãå¨å¤§è§æ¨¡éç¾¤é¨ç½²ç¯å¢ä¸ï¼è·¯ç±ä¸è´è½½åè¡¡æ¨¡åå éåè®¡ç®äº§çäºææ¾çèµæºæ¶è ã</p>
<p>&nbsp;</p>
<h3>2.4.1 è·¯ç±ä¼åå®è·µ--åå°éåè¿ç®</h3>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-5b93aa7b8a8291b38812919e85a7d6fc~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-1991905b0f0868877570d11e84a0a71a&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-4747bf8d44c8e57242787dc67cef8597~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-8750c2bee3ab59df5a9efc0d23acf222&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-5b93aa7b8a8291b38812919e85a7d6fc~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-4920185afe79bb34de9f1dad2c4d24f8&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p><strong>ä¼åæè·¯</strong></p>
<ul>
<li>éä½æ¶è´¹æ¹ä¾§éåæ¬¡æ°ï¼æä»¬åç°é¨åä¸å¡æ¯å®å¨ä¸ä½¿ç¨åºç¨çº§æ ç­¾è·¯ç±çï¼èä¸ºäºæ¯æéææ ç­¾åºæ¯ï¼åºç¨çº§è·¯ç±å¯¹äºä¸å¸¦æ ç­¾çè¯·æ±ï¼è¿æ¯éè¦å¨ééåï¼ä»¥ç­éæ éææ ç­¾çèç¹ãè¿é¨åæ æéåä¼é æç®åç©ºè½¬æµªè´¹ãå æ­¤æä»¬ç¬¬ä¸ä¸ªä¼åæ¯å¯¹æ­¤ç±»ä¸å¡å³é­äºåºç¨çº§è·¯ç±ã</li>

</ul>
<p>&nbsp;</p>
<ul>
<li>æ ¹æ®ç«ç°å¾æä»¬äºè§£å°ï¼å¨è´è½½åè¡¡ä¸­ï¼è´è½½åè¡¡å¨éè¦å¨ééåèç¹ä»¥è·åæéãé£ä¹è¿æ¶æä»¬å¯ä»¥è¯å¾éä½åä¸è´è½½åè¡¡è®¡ç®çèç¹æ°ï¼å¨è´è½½åè¡¡åï¼æä»¬æ°å¢äºèæåç»ãå½è·¯ç±ç­éåçå®ä¾è§æ¨¡è¶è¿éå¼åï¼èæåç»æ¨¡åä¼å°å®ä¾åè¡¨æåæå¤ä¸ªå°è§æ¨¡åç»ï¼éè¿å¯¹åç»éæºéæ©ï¼åæ°çº§éä½äºè¿å¥è´è½½åè¡¡çèç¹æ°ï¼éä½äºè´è½½åè¡¡éåæ¬¡æ°ã</li>

</ul>
<p>&nbsp;</p>
<h3>2.4.2 è·¯ç±ä¼åå®è·µ</h3>
<p><strong>1.å¼å¥ä½å¾ç¼å­</strong></p>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-0bd880378122174885b7f4b7dba34016~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-0a711e87dc9312fbe25a8b3ac8d8ee63&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-9042c36cb0fa9545aa82b000b53ab16a~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-10d84e9f37527d6cfde3083cc87b3ef9&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-0bd880378122174885b7f4b7dba34016~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-ae28bdf6bc0922e662f8117dca5ce462&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>ç±ç«ç°å¾ç°è±¡åç°ï¼æ è®ºæ¯å°±è¿è·¯ç±ï¼è¿æ¯æ ç­¾è·¯ç±ï¼ç­éæµç¨ä»¥åäº¤éè®¡ç®æµç¨ä¾ç¶å­å¨å¤§ééåæä½å¸¦æ¥ç®åæèãé¦åå¼å¥ç¼å­åå°éåã</p>
<p>&nbsp;</p>
<p>å¯¹äºæ ç­¾è·¯ç±ï¼å¯ä»¥å¯¹æä¾èèç¹åå¦ä¸åç±»ï¼ å¸¦å¨ææ ç­¾çèç¹ï¼å¸¦éææ ç­¾çèç¹ï¼æªææ ç­¾çèç¹ï¼æä»¬å¯ä»¥æåå¨å»ºç«è·¯ç±åæ°æ®çæ¶åï¼å¯¹ä¸åç§ç±»èç¹è¿è¡ç¼å­ã</p>
<p>&nbsp;</p>
<p>æä»¬å¨æ ç­¾è·¯ç±åè®¾ç½®äºç¼å­ååï¼å¯¹ä¸è¿°ä¸ç±»èç¹ï¼è¿è¡äºåç±»ç¼å­ã ç±»ä¼¼çï¼å¨å°±è¿è·¯ç±åï¼å¯¹ä¸åæºæ¿çæä¾èåè¡¨ï¼ç´æ¥è¿è¡ç¼å­ã åæ¶ï¼æä»¬ä»¥ä½å¾å½¢å¼ç»ç»äºç¼å­ã</p>
<p>&nbsp;</p>
<p>ä»¥å¾ä¸­è¯·æ±ä¸ºä¾ï¼å¨éèç¹ä¸ºa,b,cè³jï¼10ä¸ªèç¹ã å¨åºç¨çº§æ ç­¾è·¯ç±ä¸­å±ç»´æ¤åä»½ç¼å­ï¼ægray1ï¼gray2ï¼éææ ç­¾ä½å¾ï¼æ æ ç­¾ä½å¾ãç±»ä¼¼çï¼æ¥å£çº§ç»´æ¤ä¸¤ä»½ï¼åå«ä¸ºgrayAæ ç­¾ä½å¾ï¼ä¸æ æ ç­¾ä½å¾ãæåæ¯å°±è¿è·¯ç±ï¼ç»´æ¤æºæ¿çº§å«çä½å¾ç¼å­ã</p>
<p>&nbsp;</p>
<p>è¯·æ±ä¸ä»loc1æºæ¿åèµ·æºå¸¦åºç¨çº§æ ç­¾gray1ï¼æ¥å£çº§æ ç­¾garyAãç»ååºç¨æ ç­¾è·¯ç±ä¸è¿ç®ï¼å¯ç¨åè¡¨ä¸ºa,b,gï¼ç»è¿æ¥å£çº§è·¯ç±ä¸è¿ç®ï¼ä¾ç¶a,b,gãç»è¿å°±è¿è·¯ç±ä¸è¿ç®åï¼åªä¿çabãç±æ­¤æä»¬å®æäºè·¯ç±æ§è¡å¤æåº¦ä»O(n) -&gt; O(1ï¼çææã</p>
<p>&nbsp;</p>
<p><strong>2.ç¼å­ä¸è´æ§</strong></p>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-f811e8e9fb00bbe5ffd33112e82ec48b~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-98f97c27574402e3a8270bfdbf1fc594&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-26836095e55c622e21da8ce2dad96f0b~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-a6b01e49ea496bac50f23e34c481d381&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-f811e8e9fb00bbe5ffd33112e82ec48b~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-ad50020b99db3d71b0e93c7017a08b58&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>&nbsp;</p>
<p>æä»¬å¨è·¯ç±å å¥epochæ³ï¼ç¨äºç¼å­çæ¬æ¯å¯¹ã æ¶è´¹æ¹åèµ·è¯·æ±æ¶ï¼ä¼æºå¸¦ææ°å·²ç»ä»¥ä½å¾å½¢å¼å¨å­å¥½çæä¾æ¹åè¡¨ï¼ä»¥åå¯¹åºçepochæ³ãæ¯å°æ°ä¸çº§è·¯ç±æ¶ï¼æ°è·¯ç±ä¼æ¯å¯¹èªèº«ç¼å­epochæ³ä¸åå§epochæ¯å¦ä¸è´ã å¦æä¸è´ï¼åè¯æè§å¾æ¯ä¸è´çï¼ç´æ¥ä½¿ç¨èªèº«ä½å¾ç¼å­ä¸ä¸ä¸é¶æ®µçä½å¾ç»æè¿è¡ä¸ä½è¿ç®ã å¦æä¸ä¸è´ï¼åè¯æå½åè·¯ç±ç¼å­å¾æ´æ°ï¼é£ä¹ä¼ç´æ¥å®æ¶ç¨ææ°è·¯ç±éç½®è§åä¸ä¸ä¸é¶æ®µçè®¡ç®çä½å¾ç»æè¿è¡éåè®¡ç®ã</p>
<p>&nbsp;</p>
<p><strong>3.ä¸»å¨ç¼å­æ´æ°ç­ç¥</strong></p>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-40ab016664d8b416f698e05e290b4872~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-2ffc1bad032cc54e302fdc42ffbbd97f&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-2a4a584e5d0ef25d3a266827e4ac58e7~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-7d7a86c108c9486b0dff832990acf650&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-40ab016664d8b416f698e05e290b4872~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-39c4d2d5342cb6c7de0ae5a3b20f5e74&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>&nbsp;</p>
<p>å¨æä¾æ¹æç»­åå¸è¿ç¨ä¸­ï¼æ¶è´¹æ¹æç»­è¿è¡æå¡å¼å¥ï¼æå¡å­å¸ä¾§ä¼åæ­¥å·æ°ææ°çInvokeråè¡¨ï¼å¹¶è®¡ç®æ°çepochæ³ï¼å¹¶å°ææ°çinvokeråè¡¨æ´æ°éç¥è³è·¯ç±å¨ï¼ç¨äºæåå»ºç«ææ°ç¼å­ï¼åæ¶è·¯ç±å¨æ´æ°ä¸æå¡å­å¸ä¸è´çepochã</p>
<p>&nbsp;</p>
<h2>2.5 è·¯ç±ä¼åæ»ç»</h2>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-0a53cd57af4cf843f6c849293ec0cbb3~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-71530d285dbb8b3abb9446dc7590f605&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-ceaaad18ca85a8a9070af09c298b18e2~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-3fef20dbe14f9397709a48dce71ae5e0&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-0a53cd57af4cf843f6c849293ec0cbb3~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-2f88166a195bb530b619900f5256d4c5&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>&nbsp;</p>
<ol>
<li>vivoéè¿å»ºè®¾å°±è¿è·¯ç±è½åï¼æ¾èéä½äºRTæææ§ä¸å¡çè¯·æ±å»¶è¿ï¼åæ¶å¢å¼ºäºä¸å¡çå¯ç¨æ§ä¸å¤æºæ¿å®¹ç¾è½åã</li>
<li>éå¯¹è·¯ç±é¾ï¼æä»¬ä»ä¸¤å¤§æ¹åè¿è¡äºç³»ç»æ§ä¼åï¼ <br><strong>- ç²¾ç®é¾è·¯ï¼</strong>å¹¶æ°å¢èæåç»ï¼åå°éåçç®åæ¶èã <br><strong>- å¼å¥ä½å¾ç¼å­ç»æï¼</strong>å¤§å¹å éè·¯ç±äº¤éè®¡ç®éåº¦ï¼ä¾æä¸»å¨ç¼å­æ´æ°ä¸ epoch çæ¬æ¯å¯¹æºå¶ï¼ä¿è¯äºç¼å­è§å¾çå¼ºä¸è´æ§ã</li>

</ol>
<p>&nbsp;</p>
<p><strong>ä¼åææï¼</strong> éçæå¡æä¾æ¹è§æ¨¡ä¸æ­æ©å¤§ï¼CPU ä½¿ç¨çå TPS æ§è½æåæææåæ¾èãå¨ä¸¤åèç¹è§æ¨¡ä¸ï¼TPS æåè¶100%ï¼CPU å©ç¨çä¹éä½27%</p>
<p>&nbsp;</p>
<h2>ä¸ãDubboè´è½½åè¡¡æ©å±åä¼å</h2>
<p>å¨ä¸æ¬¡RPCè°ç¨ç»è¿è·¯ç±ç­éåï¼æ¶è´¹èç«¯å¿é¡»ä»å¤ä¸ªæå¡å®ä¾ä¸­ï¼éæ©ä¸ä¸ªèç¹æ¥åèµ·è¯·æ±ãè¿ä¸ªéæ©ç­ç¥ï¼å¯è½ç´æ¥å½±åäºç³»ç»çååéãååºå»¶è¿ãèµæºå©ç¨çç­æ ¸å¿ææ ã èDubboçè´è½½åè¡¡å¨ï¼æ­£æ¯æ¿æè¿ä¸å³é®å³ç­çæ ¸å¿ç»ä»¶ã</p>
<p>&nbsp;</p>
<h2>3.1 Dubboè´è½½åè¡¡ä¼åèæ¯ä»ç»</h2>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-0ac87a3490df9473568e0bb94510b37b~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-f3834109e8faf92b7949aa1fa46c43a2&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-96733d24099b636d59c785e36247ed16~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-77f1e50f27b9b2a6b26e6cfc01d5a522&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-0ac87a3490df9473568e0bb94510b37b~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-8d8d5bc739ac757cad92570fedfe4b65&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>&nbsp;</p>
<p>å¨vivoçäºèç½ä¸å¡é«éåå±è¿ç¨ä¸­ï¼ç±äºæç»­å¼å¥äºä¸åå¹´ä»½ãä¸åä¾åºåçæå¡å¨ï¼å¹¶èèå°æ©å°å®å¾çå½±åï¼è¿äºæå¡å¨ä¹é´å­å¨æ¾èçç®åå·®å¼ã å°½ç®¡åå®ä¾æ¥æ¶çæµéåºæ¬ä¸è´ï¼ä½å¨ä¸å¡é«å³°æï¼å®ä¾é´CPUå©ç¨çè¡¨ç°åºææ¾çä¸å¹³è¡¡ç°è±¡ã è¯¥ç°è±¡å¯¼è´ä¸å¡éç¾¤æ´é²åºè¥å¹²é®é¢ï¼å¦æ´ä½éç¾¤ç®åå©ç¨ä¸ååï¼ä½ç®åæºå¨å è´è½½è¿é«æå¼åè¶æ¶ï¼å¹¶ä¸é¢ç¹è§¦åè´è½½åè­¦è¢«è¿«äººå·¥å¹²é¢ç­ã</p>
<p>&nbsp;</p>
<p><strong>å¤æ³¨ï¼</strong> å¯ä»¥çå°Dubboåç½®èªéåºè´è½½ç­ç¥ï¼å®ççå¿µæ¯è½å¤åºäºæå¡ç«¯çå¤ä¸ªå®æ¶ææ ï¼å¨æè®¡ç®èç¹è´è½½ï¼å¹¶éæ©ç©ºé²èç¹è¿è¡è°ç¨ï¼å®ç°æºè½åçå¼¹æ§è´è½½è°åº¦ã ä½æ¯è¿ééè¦è¯´æï¼vivoå»ºè®¾èªéåºç­ç¥æ¶æè¾æ©ï¼åæå¼æºç¤¾åºèªéåºç­ç¥å°å¤äºææ¡é¶æ®µï¼åªå­å¨åå§çç¤¾åºè®¨è®ºçæ¬ãåç»­vivoå¯¹äºèªéåºç­ç¥è½åçåæä¸å¢å¼ºæ¯åºäºæ­¤åå§çæ¬æè·¯çè¿è¡çãå½åå¼æºç¤¾åºå·²ç»æä¾äºæ­£å¼çæ¬ï¼ä¸vivoå®ç°ååå§å®ç°æè¾å¤§å·®å¼ã</p>
<p>&nbsp;</p>
<h2>3.2 ç¤¾åºè®¨è®ºçèªéåºè´è½½åè¡¡</h2>
<h3>3.2.1 ç¤¾åºè®¨è®ºçèªéåºè´è½½åè¡¡ææ¯æ¹æ¡</h3>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-a3cb3dcfab36b27aecf116df2db6e1ca~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-fe51d64c67bc646e9102445f01b0e960&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-d78d1b5afe014c27532e7385ef00c91e~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448939&amp;auth_key=1768448939-0-0-c3690d894a885c74a2eca7d471ad784b&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-a3cb3dcfab36b27aecf116df2db6e1ca~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-26742502862239aa6e3198179ea817bf&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>&nbsp;</p>
<p>åå§æ¹æ¡æµç¨ç±3é¨åææã</p>
<ol>
<li>æä¾æ¹æ´æ°èªèº«CPUå©ç¨çï¼æ¯æ¬¡ææ éRPCç»æè¿åã</li>
<li>æ¶è´¹æ¹å¼æ­¥è®¡ç®æä¾æ¹è´è½½ï¼å¹¶å¯¹è´è½½è¿è¡æ´æ°å¹¶ç¼å­ã</li>
<li>æ¶è´¹æ¹ä½¿ç¨P2Cç®æ³ï¼è¿éå¯¹P2Cåä¸ä¸ªç®åçä»ç»ï¼æ¯æ¬¡è´è½½åè¡¡éæºæéä¸¤ä¸ªèç¹ï¼å¹¶ç´æ¥éæ©è´è½½è¾å°çé£ä¸ªèç¹è¿è¡è°ç¨ã</li>

</ol>
<p>&nbsp;</p>
<p>å³ä¾§æ¯æ¶è´¹æ¹éç¨çåç¹ææ ï¼åæ¬æä¾æ¹cpuè´è½½ï¼ååºæ¶é´ç­åæ°ã ä¸è¾¹æ¯æ¶è´¹æ¹åºäºééææ å¯¹è´è½½è®¡ç®çå¬å¼ å¯ä»¥ç´æ¥ç®æçè§£ä¸ºæ¶è´¹æ¹è®¡ç®çæä¾æ¹å®ä¾è´è½½å¼ï¼ä¸å®ä¾CPUè´è½½å¼ï¼å¨éè¯·æ±æ°ï¼RTï¼åæ­£ç¸å³ï¼ä¸è¯·æ±æåçï¼æééç½®å¼åè´ç¸å³ã</p>
<p>&nbsp;</p>
<h3>3.2.2 ç¤¾åºè®¨è®ºçèªéåºè´è½½åè¡¡åæµç»æ</h3>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-4326b1f4bd8046eb754179aefa88d2a5~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-6b3fb0506c74f7374abb597cd438443b&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-0ed0497563d54f67a8f33b242621b3c7~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-d06dde7405fe51ed8c3c4aa35c61507f&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-4326b1f4bd8046eb754179aefa88d2a5~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-aaa87a8caf8a926d8031681f75f921c4&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>&nbsp;</p>
<p>ä»ç»æå¯ä»¥çåºï¼èªéåºç­ç¥ä½¿ä¸åç®åçæºå¨å¨æµéæ¿è½½ä¸åºç°æ¸æ°åå±ï¼ä½ç°äºç®æ³åºäºèç¹è´è½½è¿è¡å¨ææµéè°åº¦çæææ§ã ä½ä¹è§å¯å°ï¼è¯¥çæ¬ä¸­CPUå©ç¨çå­å¨ææ¾æ³¢å¨ï¼æ­¤è¡ä¸ºå¯è½ä¼å¼å¥æå¡è´¨éé£é©ãåæ­¥åæï¼å©ç¨çéè¡åå å¯è½æ¯æµéè°æ´æºå¶å°æªå®ç°å¹³æ»è¿æ¸¡ã</p>
<p>&nbsp;</p>
<h3>3.2.3 ç¤¾åºè®¨è®ºçæ³¢å¨åå åæ</h3>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-425e0574c9e9aaed4f0fceb73fc2a8a2~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-bbb7ed992ab66a196ed8ab4a6a2e983f&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-71ac99eed41f0fef6dee5fada47c37ff~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-be68e68ada96b1988ac2e4adb142c686&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-425e0574c9e9aaed4f0fceb73fc2a8a2~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-3cf065f34275edbc5e352c1c1eabdbc7&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>&nbsp;</p>
<p>ä»¥æç®åçåèç¹åºæ¯ä¸ºä¾ï¼åè®¾å­å¨èç¹ P1 å P2ã åå§é¶æ®µï¼P2 è´è½½è¾é«ãå¨æä¾æ¹å°æ´æ°çè´è½½ææ è¿åä¹åï¼æ¶è´¹æ¹æç»­å°è¯·æ±éä¸­åå¾è´è½½è¾ä½ç P1ï¼å¯¼è´ P1 çè´è½½è¿éåè³å³°å¼ï¼è P2 æ­¤æ¶æ è°ç¨ï¼è´è½½æå¥æä½æ°´å¹³ã éåï¼æ¶è´¹æ¹æ´æ°äºè´è½½æ°æ®ï¼ä¸¤ä¸ªèç¹çè´è½½è§å¾ç¶æåçåè½¬ï¼ä»¥æ­¤å¾ªç¯å¾å¤ã</p>
<p>&nbsp;</p>
<p>åºäºä¸è¿°åæï¼æä»¬å¯ä»¥ä»ä¸¤ä¸ªå³é®æ¹åçæä¼åï¼</p>
<ol>
<li>æ¹è¿ P2C çæµéåéæºå¶ï¼é¿åèç¹å¨ç­æ¶é´åè¢«éä¸­è®¿é®ï¼</li>
<li>æ¯å¢å¼ºææ å¹³æ»æµè½¬è½åï¼æå¶ç­ææå¨å¸¦æ¥çå³ç­å¹²æ°ï¼ä»èæåç³»ç»çæ´ä½ç¨³å®æ§ã</li>

</ol>
<p>&nbsp;</p>
<h2>3.3 vivoçèªéåºè´è½½åè¡¡ä¼å</h2>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-e73e2fc7fb029ed23ac1bec43411c3e8~resize:0:q75.png?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-22f2e2d45750a72a1e68499347f51650&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-5296d4e5d3fba52d89d7ad748a08ef80~resize:1440:q75.png?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-2bcfd9594ef1633b308b01b16c931e73&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-e73e2fc7fb029ed23ac1bec43411c3e8~resize:1440:q75.png?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-49e1d1eb2b000276ebda4f822331f227&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>&nbsp;</p>
<ul>
<li>å¯¹P2Cçæµéååç­ç¥è¿è¡è°æ´ï¼åæçæºå¶æ¯ä¸ç§âèµ¢èéåâçæ¨¡å¼ï¼ç®æ³ç´æ¥å°æµéå¨é¨å¯¼åäºå½åè´è½½æä½çèç¹ã P2Cè¿ç¨ä¼æ ¹æ®èç¹çè´è½½è®¡ç®æ¦çç³»æ°ï¼è´è½½ä½çèç¹è¢«éä¸­çæ¦çæ´é«ï¼ä½è´è½½é«çèç¹ä¹ä¸ä¼åä¹åä¸æ ·è¢«è¢«å®å¨å¿½ç¥ãè¿ä¸æ¹è¿ä¸ä»ä»æ ¹æºä¸æ¶é¤äºæææµéç¬é´æ¶ååä¸èç¹æå¸¦æ¥çéè¡é£é©ï¼ä¹æ¾èæåäºéç¾¤èµæºçæ´ä½å©ç¨çï¼å®ç°äºP2Cèç¹é´è´è½½çâåå³°å¡«è°·âã</li>

</ul>
<p>&nbsp;</p>
<ul>
<li>å°è´è½½è®¡ç®ä¸è´è½½è°åº¦åç¦»ãå¦å¾æç¤ºï¼è´è½½åè¡¡å¼å¥äºä¸ä¸ªç¬ç«çæéè®¡ç®ååãè¯¥ååçæ ¸å¿ç®æ æ¯ç»´æ¤ä¸ä¸ªç¨³å®çãå¨å±çãæµéè°åº¦è§å¾ã å®çè®¾è®¡æè·¯æ¯ï¼æ¶è´¹æ¹æ ¹æ®è´è½½å¼ï¼è®¡ç®ä¸ä¸ªå¹³æ»çï¼è¿è´¯ååçèææéï¼ä»èé´æ¥éè¿æ­¤èææéï¼ä½¿å¾å½åçæµéåéè¿ç¨å§ç»ä¿æç¨³æã</li>

</ul>
<p>&nbsp;</p>
<ul>
<li>P2Cè¿ç¨å°åºäºä¸è¿°èææéè¿è¡èç¹éæ©ã</li>

</ul>
<p>&nbsp;</p>
<h2>3.4 vivoèªéåºè´è½½åè¡¡åæµææå±ç¤º</h2>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-308be7d113936025060c10aa8f540d1e~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-c2c5f659af293cfe7ca3c851bc488bd5&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-272300d8f587153204aa42e1977dce2f~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-60e43e1ef642e7b3c8185a8b80cfab95&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-308be7d113936025060c10aa8f540d1e~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-7a67d7bbf4fb63edb1851723b081fd8f&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>&nbsp;</p>
<p>å·¦ä¾§ä»å·¦è³å³ä¾æ¬¡å±ç¤ºäºéæºç®æ³ãåå§çæ¬èªéåºç­ç¥ï¼ä»¥åvivoåé¨ä¼ååçèªéåºç­ç¥ï¼å¨åç®åéç½®éç¾¤çåæµç¯å¢ä¸­çåæµè¡¨ç°ï¼ vivoä¼åçæ¬ä¸ä»å®ç°äºæ´ä¼çæµéåå±ï¼è¿å°åèç¹CPUå©ç¨çæ¶æè³åºæ¬ä¸è´çæ°´å¹³ï¼å¹¶å§ç»ä¿æç¨³å®ï¼ä½¿å¾éç¾¤è¾¾æé«æãé«ååä¸ç¨³å®è¿è¡ççæ³ç¶æã</p>
<p>&nbsp;</p>
<p>å³ä¾§åç°äºåå§ç­ç¥ä¸vivoçèªéåºç­ç¥ï¼ç¸å¯¹éæºç­ç¥å¨å¤é¡¹æ ¸å¿ææ ä¸çè¡¨ç°ï¼åæ¬TPSãå¹³åRTç­ï¼å¯çåºæ­¤æ¬¡ä¼åæææ¾èï¼åé¡¹ææ åæå¤§å¹æåã</p>
<p>&nbsp;</p>
<h2>3.5 vivoèªéåºè´è½½åè¡¡çäº§ç¯å¢ä½¿ç¨ææ</h2>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-e19862457a601ad96852de5ef3d932ed~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-79ba353fba4d8b5e5a732d64c58fc7c6&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-4043ca89026b52387100e088e8bccc65~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-4b488e2a1e18a6876b122c0110057de4&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-e19862457a601ad96852de5ef3d932ed~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-e6dd9a69b6d41e134276371db75286c3&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>&nbsp;</p>
<p>&nbsp;</p>
<ul>
<li><strong>æåæå¡å®¹éï¼</strong>å¨åç­éç¾¤è§æ¨¡ä¸ï¼æ°ç­ç¥å¯å°éç¾¤æµéååä¸éå¹³åæåçº¦15%ï¼ææå¢å¼ºäºæ´ä½éç¾¤æ¿è½½è½åã</li>
<li><strong>æåæå¡è´¨éï¼</strong>æ¨å¹¿æ°ç­ç¥åï¼ç®æ³å¨é«å³°æå¯æææå¶è¶æ¶çï¼è¯·æ±å¤±è´¥çä¸éè¶è¿50%ã</li>
<li><strong>å®ç°ææéæ¬ï¼</strong>æ°ç®æ³éè¿æ´ç²¾åçæµéè°åº¦ï¼æ¾èèçäºCPUèµæºå ç¨ï¼é¢è®¡æ¯å¹´å¯ä¸ºä¸å¡éä½ç¾ä¸åçº§å«çè®¡ç®ææ¬ã</li>
<li><strong>ä¼åè¿ç»´äººåæå¥ï¼</strong>æ°è´è½½ç­ç¥å¤§å¹åå°äºä½ç®åæºå¨çå©ç¨çåè­¦é¢çãä¸å¡æ¹æ éå¨æµéé«å³°æé´ä¸é¨è¿è¡éç¾¤å®ä¾çéææéè°æ´ï¼åè½»äºè¿ç»´è´æã</li>

</ul>
<p>&nbsp;</p>
<h2>åãææ¯ææ</h2>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-a820cd13083e03da65d182c7a3599814~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-8321934529123c240d67e3da92e94a3b&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-2104b8d05c5d25b48a3be8bd24657044~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-6fb96e82d885822d686b4e03f8f38d1f&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-a820cd13083e03da65d182c7a3599814~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-6f41b2259be9307f4f0a5d0a0c19b912&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>&nbsp;</p>
<p><strong>å¨Dubboè·¯ç±å±é¢ï¼</strong>æä»¬éç¹è§£å³ä¸¤å¤§<strong>çç¹</strong>ï¼<strong>ä¸æ¯</strong>è·¯ç±ç­éæ¶çå¤§ééåæä½å¯¼è´æ¶è´¹ç«¯CPUèµæºæµªè´¹ï¼<strong>äºæ¯</strong>è·¨æºæ¿è°ç¨å¯¹RTææä¸å¡çæ§è½å½±åã </p>
<p>&nbsp;</p>
<p>éå¯¹è·¯ç±éåæçé®é¢ï¼æä»¬å®æ½4é¡¹ä¼åï¼</p>
<ul>
<li>å³é­æªä½¿ç¨çè·¯ç±ï¼åå°æ æè®¡ç®ï¼</li>
<li>å¼å¥ä½å¾ç¼å­æºå¶ï¼å°è·¯ç±ç­éå¤æåº¦ä» O(n) éè³ O(1)ï¼å¤§å¹æåæ§è¡æçï¼</li>
<li>æ°å¢åç»è·¯ç±åè½ï¼ææåå°è¿å¥è´è½½åè¡¡æ¨¡åçå®ä¾æ°éï¼åè½»åç»­å¤çååã</li>
<li>å»ºè®¾å°±è¿è·¯ç±è½åï¼æ¾èæåäºè·¨æºæ¿è°ç¨çä¸å¡ä½éªï¼æé«æå¡è´¨éã</li>

</ul>
<p>&nbsp;</p>
<p><strong>å¨è´è½½åè¡¡æ¹é¢ï¼</strong>æä»¬ååé¢ä¸´çåéæç­ç¥é¾ä»¥ééåºå±è®¾æ½å·®å¼ï¼å¯¼è´ç®åå©ç¨çä½çé®é¢ãä¸ºæ­¤ï¼æä»¬åºäºç¤¾åºçæ¬æå»ºäºvivoèªéåºè´è½½åè¡¡è½åï¼éç¹ä¼åP2Cç®æ³å¹¶å¼å¥æéè®¡ç®ååï¼å®ç°æµéèªéåºä¸å¹³æ»è°åº¦ï¼æç»æ¾èæåæå¡å®¹éä¸è´¨éï¼åæ¶å®ç°éæ¬åèçº¦äººåçç®æ ã</p>
<p>&nbsp;</p>
<h2>äºãæªæ¥å±æ</h2>

<img data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="608" data-watermark="original" data-original-src="https://pic-private.zhihu.com/v2-89fbe2c273534949396e18897392578a~resize:0:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-395b33711181a946d5a127657c10427c&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False&amp;draft_token=1995081903410280048" data-watermark-src="https://pic-private.zhihu.com/v2-dad8e4eb1b09fd1a2ff02d302d57dc52~resize:1440:q75.jpg?source=1f5c5e47&amp;expiration=1768448938&amp;auth_key=1768448938-0-0-97208e885e1d4cb3cf624fdd62c27150&amp;protocol=v2&amp;sampling=False&amp;animatedImagePlayCount=1&amp;overTime=60&amp;incremental=False&amp;sceneCode=article_draft_web&amp;animatedImageAutoPlay=False&amp;retryCount=3&amp;precoder=False" data-private-watermark-src="" data-src="https://pic-out.zhimg.com/v2-89fbe2c273534949396e18897392578a~resize:1440:q75.jpg?animatedImageAutoPlay=false&amp;animatedImagePlayCount=1&amp;auth_key=1768446254-0-0-55d8e966af469f74cfd7554b9defb1f9&amp;bizSceneCode=article_draft&amp;expiration=1768446254&amp;incremental=false&amp;mid=f9f550d3db68b8e79861d6625bbfd2e2&amp;overTime=60&amp;precoder=false&amp;protocol=v2&amp;retryCount=3&amp;sampling=false&amp;sceneCode=editor_copy_outbound&amp;source=bfcaadb1" class="lazyload">
<p>&nbsp;</p>
<p>æåæ¯vivoå¯¹äºDubboæªæ¥å¨å¬å¸åæ¼è¿çä¸äºè®¡åä¸æèï¼</p>
<p>&nbsp;</p>
<ul>
<li><strong>æ¨è¿Dubboä¸å¼æºç¤¾åºçæ¬å¯¹é½ï¼</strong> ç®åå¬å¸åé¨çDubboåºçº¿çæ¬åºäºå¼æºç¤¾åº2.7.*æå»ºï¼èç¤¾åºç°å·²æ¼è¿è³3.*çæ¬ï¼ç¤¾åº3.*çæ¬å¨é¢æ¯ææ°ä¸ä»£é«æ§è½éä¿¡åè®®ï¼å·å¤æ´å¼ºçäºåçç¹æ§ãé£ä¹æªæ¥æä»¬ä¹å°æç»­æ¨è¿vivoåé¨åºçº¿çæ¬åçº§ï¼å¼å¥æ´å¤ä¼ç§çå¼æºè½åä¸æ¨¡åï¼æ´å¥½å°æ¥æ±äºåçæ¶æã</li>

</ul>
<p>&nbsp;</p>
<ul>
<li><strong>æå»ºè·¨è¯­è¨çç»ä¸å¾®æå¡æ²»çå¹³å°ï¼</strong> å½åvivoçæå¡æ²»çè½åä¸»è¦å´ç»JavaåC++ææ¯æ ï¼éçå¬å¸ä¸å¡é«éåå±ï¼å¦GoãPythonç­è¯­è¨éæ¸å¹¿æ³åºç¨ãç®åï¼è·¨è¯­è¨æå¡è°ç¨çéæ±æ¾èå¢é¿ï¼åæ¶ä¹å¸¦æ¥äºææ¯æ ç¢çåãæ²»çè½åä¸ååãéç½®æ¨¡åä¸ç»ä¸ãå¼åè®¤ç¥ä¸ä¸è´ç­ææãä¸ºæ­¤ï¼æä»¬è®¡åå»ºè®¾ä¸å¥æ ååçãè¯­è¨æ å³çå¾®æå¡æ²»çå¹³å°ãè¯¥å¹³å°å°æä¾ç»ä¸çæå¡åç°ãæµéçæ§ãæµéæ²»çä»¥åæå¡è§æµè½åãçæ­£å®ç°âå¤è¯­è¨å¼åï¼ä¸ä½åæ²»çâçç®æ ï¼ä»¥éä½æªæ¥çç³»ç»å¤ææ§ä¸è¿ç»´ææ¬ã</li>

</ul>
</div>
<div id="MySignature" role="contentinfo">
    åäº« vivo äºèç½ææ¯å¹²è´§ä¸æ²é¾æ´»å¨ï¼æ¨èææ°è¡ä¸å¨æä¸ç­é¨ä¼è®®ã
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.006944444444444444" data-date-updated="2026-01-15 11:02">2026-01-15 10:52</span>&nbsp;
<a href="https://www.cnblogs.com/vivotech">vivoäºèç½ææ¯</a>&nbsp;
éè¯»(<span id="post_view_count">8</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19486239);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19486239', targetLink: 'https://www.cnblogs.com/vivotech/p/19486239', title: 'vivo å¾®æå¡æ¶æå®è·µä¹ Dubbo æ§è½ä¼å' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ c#å®ç°åè£¹æ£é¢åçå ç§æ¹å¼ ]]></title>
    <link>https://www.cnblogs.com/axing/p/19483856</link>
    <guid>faf320e5674f4b74943959cbd75231d8</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/axing/p/19483856" title="åå¸äº 2026-01-15 10:46">
    <span role="heading" aria-level="2">c#å®ç°åè£¹æ£é¢åçå ç§æ¹å¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><span>&nbsp; æ è®ºæ¯è·¨å¢çµåè¿æ¯å¶é ä¸åæ£è®¾å¤ï¼å¨åè£¹æµè½¬åºå¥åºçåºæ¯ï¼ä¸ºäºä¿è¯åè£¹åæ£è®¡ååæµéæ°æ®ç»å®çå®æ§ï¼ç»å¸¸ä¼éå°é¢åæ£åçéæ±ï¼ä¸é¢æå°±éè¿ä¸¤ç§å®ç°åçæ¥å®ç°è¿ä¸åè½ã</span></p>
<p>&nbsp; &nbsp; ä¸:OpenCVSharp éè¿é¢åè½®å»/é¢è²/è¾¹ç¼ç­ç»åæ£æµå®ç°</p>
<p>&nbsp; &nbsp; äº:éè¿OCRè¯å«é¢ååå®¹,æ ¹æ®ææåå²ç¹åæ ç¹æå°å¤çç©å½¢æ¥å®ä½é¢åä½ç½®(æ£é¢åçåºæ¯éæ±æ¯çæ¸é¢ååå®¹ï¼å½ç¶æ³è¦æ£åå®æ´é¢åå¾çï¼å¯ä»¥æ·»å é¢åå°ºå¯¸,è§åä¿¡æ¯ç­ç»´åº¦è®¡ç®æèç´æ¥ç¨ç¬¬ä¸ç§æ¹å¼)</p>
<p>&nbsp; &nbsp; ä¸:YOLO+Labelmeæ å®å·¥å·ï¼éè¿æ¨¡åè®­ç»å®ä½æ£å(è¿ä¸ªæ½æ¶é´åç¬å±å¼ä¸ç¯è§£é)</p>
<p><strong><span style="font-family: å®ä½, &quot;Songti SC&quot;; font-size: 16px">æ¹å¼ä¸:OpencvSharp éè¿è½®å»/é¢è²/è¾¹ç¼æ£æµ</span></strong></p>
<p><strong><span style="font-family: å®ä½, &quot;Songti SC&quot;; font-size: 16px">ãã</span></strong>è¿ç§æ¹å¼å¯¹äºåè£¹åé¢åé¢è²æææ¾å·®å¼çåºæ¯å¾åå¥½ï¼å¯¹äºåè£¹é¢è²åé¢åé¢è²æ¥è¿çææä¸è¬ï¼å»ºè®®èèç¬¬äºç§æ¹å¼ï¼ï¼è½ç¶å¯ä»¥æ ¹æ®é¢åæ ·å¼æèæå­èéå¯åº¦ç­å¤éç»´åº¦æ¥ç»ååæï¼ä½æ¯è¿äºå¤æï¼å¹¶ä¸å®å¶åç¨åº¦å¾é«ï¼åºè¯å°è¯´ï¼åççææ:</p>
<p>&nbsp;</p>
<p><span>&nbsp; &nbsp; &nbsp; &nbsp; åå¾ï¼</span></p>
<p><span>ãã<img src="https://img2024.cnblogs.com/blog/116076/202601/116076-20260114185329554-1784692153.png" alt="333" width="439" height="328" loading="lazy"></span></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;ã&nbsp;éè¿æ¾ç¤ºå¢å¼ºåçææå¾:</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;<img src="https://img2024.cnblogs.com/blog/116076/202601/116076-20260114185355689-1585898524.png" alt="zsvvyv" width="367" height="536" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/116076/202509/116076-20250924180326264-1688793031.png" alt="116076-20250310125032345-1793233350[1]" width="519" height="244" loading="lazy"></p>
<p>åºè¯å°è¯´ï¼éä¸æ ¸å¿ä»£ç :</p>
<div class="cnblogs_code">
<pre>staticvoidProcessSingleImage(<span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)"> imagePath)
{
</span><span style="color: rgba(0, 0, 255, 1)">if</span> (!<span style="color: rgba(0, 0, 0, 1)">File.Exists(imagePath))
    {
        Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æä»¶ä¸å­å¨!</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        Console.ReadKey();
</span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)">;
    }

</span><span style="color: rgba(0, 0, 255, 1)">try</span><span style="color: rgba(0, 0, 0, 1)">
    {
        Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¤ç: {Path.GetFileName(imagePath)}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

</span><span style="color: rgba(0, 0, 255, 1)">var</span> stopwatch =<span style="color: rgba(0, 0, 0, 1)"> Stopwatch.StartNew();

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ£æµé¢å</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> results =<span style="color: rgba(0, 0, 0, 1)"> _detector.DetectLabels(imagePath);

        stopwatch.Stop();
        Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æ£æµèæ¶: {stopwatch.ElapsedMilliseconds}ms</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æ¾å° {results.Count} ä¸ªé¢ååºå</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

</span><span style="color: rgba(0, 0, 255, 1)">if</span> (results.Count == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æªæ£æµå°é¢å!</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            Console.ReadKey();
</span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)">;
        }

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¾ç¤ºç»æ</span>
<span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> result <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> results)
        {
            Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">- {result.DetectionMethod}: ç½®ä¿¡åº¦ {result.Confidence:F2}, </span><span style="color: rgba(128, 0, 0, 1)">"</span> +<span style="color: rgba(0, 0, 0, 1)">
$</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ä½ç½® [{result.BoundingBox.X}, {result.BoundingBox.Y}, </span><span style="color: rgba(128, 0, 0, 1)">"</span> +<span style="color: rgba(0, 0, 0, 1)">
$</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">{result.BoundingBox.Width}, {result.BoundingBox.Height}]</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        }

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> åå»ºè¾åºç®å½</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> outputDir =<span style="color: rgba(0, 0, 0, 1)"> _config.OutputDirectory;
</span><span style="color: rgba(0, 0, 255, 1)">if</span> (!<span style="color: rgba(0, 0, 0, 1)">Directory.Exists(outputDir))
            Directory.CreateDirectory(outputDir);

</span><span style="color: rgba(0, 0, 255, 1)">var</span> baseName =<span style="color: rgba(0, 0, 0, 1)"> Path.GetFileNameWithoutExtension(imagePath);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ä¿å­å¯è§åç»æ</span>
<span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (_config.SaveVisualized)
        {
</span><span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> original = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> Bitmap(imagePath))
            {
                Bitmap bitResult </span>=<span style="color: rgba(0, 0, 0, 1)"> ImageProcessor.DrawBoundingBoxesSafe(original, results);

</span><span style="color: rgba(0, 0, 255, 1)">var</span> visPath = Path.Combine(outputDir, $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">{baseName}_detected.png</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                ImageProcessor.SaveImage(bitResult, visPath);
                Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¯è§åç»æå·²ä¿å­: {visPath}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            }
        }

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ä¿å­æ å¾ç»æ </span>
<span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (_config.SaveCropped)
        {
</span><span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> mat =<span style="color: rgba(0, 0, 0, 1)"> Cv2.ImRead(imagePath))
            {
</span><span style="color: rgba(0, 0, 255, 1)">for</span> (<span style="color: rgba(0, 0, 255, 1)">int</span> i = <span style="color: rgba(128, 0, 128, 1)">0</span>; i &lt; results.Count; i++<span style="color: rgba(0, 0, 0, 1)">)
                {
</span><span style="color: rgba(0, 0, 255, 1)">var</span> cropped =<span style="color: rgba(0, 0, 0, 1)"> _detector.CropLabel(mat, results[i].BoundingBox);
</span><span style="color: rgba(0, 0, 255, 1)">if</span> (cropped != <span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">)
                    {
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å¾åå¢å¼º</span>
                        _detector.EnhanceImage(<span style="color: rgba(0, 0, 255, 1)">ref</span><span style="color: rgba(0, 0, 0, 1)"> cropped);

</span><span style="color: rgba(0, 0, 255, 1)">var</span> cropPath = Path.Combine(outputDir, $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">{baseName}_label_{i + 1}.png</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        Console.WriteLine(cropped);

                        ImageProcessor.SaveImage(cropped, cropPath);
                        Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æ å¾å·²ä¿å­: {cropPath}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

                        cropped.Dispose();
                    }
                }
            }
        }

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ä¿å­æ£æµç»æå°JSON</span>
        SaveResultsToJson(results, Path.Combine(outputDir, $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">{baseName}_results.json</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));

        Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">\nå¤çå®æ! æä»»æé®ç»§ç»­...</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">); 
    }
</span><span style="color: rgba(0, 0, 255, 1)">catch</span><span style="color: rgba(0, 0, 0, 1)"> (Exception ex)
    {
        Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¤çå¤±è´¥: {ex.Message}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    }
}</span></pre>
</div>
<p>éè¿è½®å»æ£æµãé¢è²æ£æµåè¾¹ç¼æ£æµä¸ç§æ¹å¼ç»åå®ä½é¢åä½ç½®</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">public</span> List&lt;DetectionResult&gt; DetectLabels(<span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)"> imagePath)
    {
</span><span style="color: rgba(0, 0, 255, 1)">var</span> results = <span style="color: rgba(0, 0, 255, 1)">new</span> List&lt;DetectionResult&gt;<span style="color: rgba(0, 0, 0, 1)">();

</span><span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> mat =<span style="color: rgba(0, 0, 0, 1)"> Cv2.ImRead(imagePath, OpenCvSharp.ImreadModes.Color))
        {
</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (mat.Empty())
thrownew FileNotFoundException($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æ æ³å è½½å¾å: {imagePath}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¹æ³1: è½®å»æ£æµ</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> contourResults =<span style="color: rgba(0, 0, 0, 1)"> DetectByContours(mat);
            results.AddRange(contourResults);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¹æ³2: é¢è²æ£æµ</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> colorResults =<span style="color: rgba(0, 0, 0, 1)"> DetectByColor(mat);
            results.AddRange(colorResults);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¹æ³3: è¾¹ç¼æ£æµ</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> edgeResults =<span style="color: rgba(0, 0, 0, 1)"> DetectByEdges(mat);
            results.AddRange(edgeResults);
        }

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> åå¹¶åç­éç»æ</span>
<span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> FilterResults(results);
    }</span></pre>
</div>
<p>è½®å»æ£æµ</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">private</span> List&lt;DetectionResult&gt;<span style="color: rgba(0, 0, 0, 1)"> DetectByContours(OpenCvSharp.Mat src)
    {
</span><span style="color: rgba(0, 0, 255, 1)">var</span> results = <span style="color: rgba(0, 0, 255, 1)">new</span> List&lt;DetectionResult&gt;<span style="color: rgba(0, 0, 0, 1)">(); 
</span><span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> gray = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenCvSharp.Mat())
</span><span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> binary = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenCvSharp.Mat())
        {
            Cv2.CvtColor(src, gray, ColorConversionCodes.BGR2GRAY);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> äºå¼å</span>
            Cv2.Threshold(gray, binary, <span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">255</span>, ThresholdTypes.Binary |<span style="color: rgba(0, 0, 0, 1)"> ThresholdTypes.Otsu);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å½¢æå­¦æä½</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> kernel = Cv2.GetStructuringElement(MorphShapes.Rect, <span style="color: rgba(0, 0, 255, 1)">new</span> OpenCvSharp.Size(<span style="color: rgba(128, 0, 128, 1)">3</span>, <span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">));
            Cv2.MorphologyEx(binary, binary, MorphTypes.Close, kernel);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¥æ¾è½®å»</span>
<span style="color: rgba(0, 0, 0, 1)">            Cv2.FindContours(binary, outvar contours, outvar hierarchy,
                RetrievalModes.External, ContourApproximationModes.ApproxSimple);

</span><span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> contour <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> contours)
            {
</span><span style="color: rgba(0, 0, 255, 1)">var</span> area =<span style="color: rgba(0, 0, 0, 1)"> Cv2.ContourArea(contour); 
</span><span style="color: rgba(0, 0, 255, 1)">if</span> (area &lt; _minArea || area &gt;<span style="color: rgba(0, 0, 0, 1)"> _maxArea)
</span><span style="color: rgba(0, 0, 255, 1)">continue</span><span style="color: rgba(0, 0, 0, 1)">;

                Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">é¢ç§¯ï¼{area}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 0, 255, 1)">var</span> rect =<span style="color: rgba(0, 0, 0, 1)"> Cv2.BoundingRect(contour);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è®¡ç®å®½é«æ¯</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> aspectRatio = (<span style="color: rgba(0, 0, 255, 1)">double</span>)rect.Width /<span style="color: rgba(0, 0, 0, 1)"> rect.Height;

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> é¢åéå¸¸ä¸ºç©å½¢ï¼å®½é«æ¯å¨ä¸å®èå´å</span>
<span style="color: rgba(0, 0, 255, 1)">if</span> (aspectRatio &gt; <span style="color: rgba(128, 0, 128, 1)">0.5</span> &amp;&amp; aspectRatio &lt; <span style="color: rgba(128, 0, 128, 1)">3.0</span><span style="color: rgba(0, 0, 0, 1)">)
                {
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è®¡ç®ç©å½¢åº¦</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> rectArea = rect.Width *<span style="color: rgba(0, 0, 0, 1)"> rect.Height;
</span><span style="color: rgba(0, 0, 255, 1)">var</span> rectangularity = area /<span style="color: rgba(0, 0, 0, 1)"> rectArea;
Console.WriteLine(rectangularity);
</span><span style="color: rgba(0, 0, 255, 1)">if</span> (rectangularity &gt; <span style="color: rgba(128, 0, 128, 1)">0.55</span><span style="color: rgba(0, 0, 0, 1)">)
                    {
                        results.Add(</span><span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> DetectionResult
                        {
                            BoundingBox </span>=<span style="color: rgba(0, 0, 0, 1)"> rect.ToRectangle(),
                            Confidence </span>=<span style="color: rgba(0, 0, 0, 1)"> rectangularity,
                            DetectionMethod </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Contour</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
                        });
                    }
                }
            }
        }

</span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> results;
    }</span></pre>
</div>
<p>2.é¢è²æ£æµ</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">private</span> List&lt;DetectionResult&gt;<span style="color: rgba(0, 0, 0, 1)"> DetectByColor(OpenCvSharp.Mat src)
    {
</span><span style="color: rgba(0, 0, 255, 1)">var</span> results = <span style="color: rgba(0, 0, 255, 1)">new</span> List&lt;DetectionResult&gt;<span style="color: rgba(0, 0, 0, 1)">();

</span><span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> hsv = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenCvSharp.Mat())
</span><span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> mask = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenCvSharp.Mat())
        {
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è½¬æ¢å°HSVè²å½©ç©ºé´</span>
<span style="color: rgba(0, 0, 0, 1)">            Cv2.CvtColor(src, hsv, ColorConversionCodes.BGR2HSV);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å®ä¹ç½è²/æµè²èå´</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> lowerWhite1 = <span style="color: rgba(0, 0, 255, 1)">new</span> Scalar(<span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">200</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 0, 255, 1)">var</span> upperWhite1 = <span style="color: rgba(0, 0, 255, 1)">new</span> Scalar(<span style="color: rgba(128, 0, 128, 1)">180</span>, <span style="color: rgba(128, 0, 128, 1)">30</span>, <span style="color: rgba(128, 0, 128, 1)">255</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 0, 255, 1)">var</span> lowerWhite2 = <span style="color: rgba(0, 0, 255, 1)">new</span> Scalar(<span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">180</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 0, 255, 1)">var</span> upperWhite2 = <span style="color: rgba(0, 0, 255, 1)">new</span> Scalar(<span style="color: rgba(128, 0, 128, 1)">180</span>, <span style="color: rgba(128, 0, 128, 1)">80</span>, <span style="color: rgba(128, 0, 128, 1)">255</span><span style="color: rgba(0, 0, 0, 1)">);

</span><span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> mask1 = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenCvSharp.Mat())
</span><span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> mask2 = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenCvSharp.Mat())
            {
                Cv2.InRange(hsv, lowerWhite1, upperWhite1, mask1);
                Cv2.InRange(hsv, lowerWhite2, upperWhite2, mask2);
                Cv2.BitwiseOr(mask1, mask2, mask);
            }

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å½¢æå­¦æä½</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> kernel = Cv2.GetStructuringElement(MorphShapes.Rect, <span style="color: rgba(0, 0, 255, 1)">new</span> OpenCvSharp.Size(<span style="color: rgba(128, 0, 128, 1)">5</span>, <span style="color: rgba(128, 0, 128, 1)">5</span><span style="color: rgba(0, 0, 0, 1)">));
            Cv2.MorphologyEx(mask, mask, MorphTypes.Close, kernel);
            Cv2.MorphologyEx(mask, mask, MorphTypes.Open, kernel);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¥æ¾è½®å»</span>
<span style="color: rgba(0, 0, 0, 1)">            Cv2.FindContours(mask, outvar contours, outvar hierarchy,
                RetrievalModes.External, ContourApproximationModes.ApproxSimple);

</span><span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> contour <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> contours)
            {
</span><span style="color: rgba(0, 0, 255, 1)">var</span> area =<span style="color: rgba(0, 0, 0, 1)"> Cv2.ContourArea(contour);

</span><span style="color: rgba(0, 0, 255, 1)">if</span> (area &lt; _minArea || area &gt;<span style="color: rgba(0, 0, 0, 1)"> _maxArea)
</span><span style="color: rgba(0, 0, 255, 1)">continue</span><span style="color: rgba(0, 0, 0, 1)">;

</span><span style="color: rgba(0, 0, 255, 1)">var</span> rect =<span style="color: rgba(0, 0, 0, 1)"> Cv2.BoundingRect(contour);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è®¡ç®é¢è²åååº¦</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> uniformity =<span style="color: rgba(0, 0, 0, 1)"> CalculateColorUniformity(src, rect);

</span><span style="color: rgba(0, 0, 255, 1)">if</span> (uniformity &gt;<span style="color: rgba(0, 0, 0, 1)"> _confidenceThreshold)
                {
                    results.Add(</span><span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> DetectionResult
                    {
                        BoundingBox </span>=<span style="color: rgba(0, 0, 0, 1)"> rect.ToRectangle(),
                        Confidence </span>=<span style="color: rgba(0, 0, 0, 1)"> uniformity,
                        DetectionMethod </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Color</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
                    });
                }
            }
        }

</span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> results;
    }
</span><span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">.è¾¹ç¼æ£æµ

</span><span style="color: rgba(0, 0, 255, 1)">private</span> List&lt;DetectionResult&gt;<span style="color: rgba(0, 0, 0, 1)"> DetectByEdges(OpenCvSharp.Mat src)
    {
</span><span style="color: rgba(0, 0, 255, 1)">var</span> results = <span style="color: rgba(0, 0, 255, 1)">new</span> List&lt;DetectionResult&gt;<span style="color: rgba(0, 0, 0, 1)">();

</span><span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> gray = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenCvSharp.Mat())
</span><span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> edges = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenCvSharp.Mat())
        {
            Cv2.CvtColor(src, gray, ColorConversionCodes.BGR2GRAY);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> éåª</span>
            Cv2.GaussianBlur(gray, gray, <span style="color: rgba(0, 0, 255, 1)">new</span> OpenCvSharp.Size(<span style="color: rgba(128, 0, 128, 1)">5</span>, <span style="color: rgba(128, 0, 128, 1)">5</span>), <span style="color: rgba(128, 0, 128, 1)">1.5</span><span style="color: rgba(0, 0, 0, 1)">);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è¾¹ç¼æ£æµ</span>
            Cv2.Canny(gray, edges, <span style="color: rgba(128, 0, 128, 1)">50</span>, <span style="color: rgba(128, 0, 128, 1)">150</span><span style="color: rgba(0, 0, 0, 1)">);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è¨è</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> kernel = Cv2.GetStructuringElement(MorphShapes.Rect, <span style="color: rgba(0, 0, 255, 1)">new</span> OpenCvSharp.Size(<span style="color: rgba(128, 0, 128, 1)">3</span>, <span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">));
            Cv2.Dilate(edges, edges, kernel, iterations: </span><span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¥æ¾è½®å»</span>
<span style="color: rgba(0, 0, 0, 1)">            Cv2.FindContours(edges, outvar contours, outvar hierarchy,
                RetrievalModes.External, ContourApproximationModes.ApproxSimple);

</span><span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> contour <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> contours)
            {
</span><span style="color: rgba(0, 0, 255, 1)">var</span> area =<span style="color: rgba(0, 0, 0, 1)"> Cv2.ContourArea(contour);

</span><span style="color: rgba(0, 0, 255, 1)">if</span> (area &lt; _minArea || area &gt;<span style="color: rgba(0, 0, 0, 1)"> _maxArea)
</span><span style="color: rgba(0, 0, 255, 1)">continue</span><span style="color: rgba(0, 0, 0, 1)">;

</span><span style="color: rgba(0, 0, 255, 1)">var</span> rect =<span style="color: rgba(0, 0, 0, 1)"> Cv2.BoundingRect(contour);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è®¡ç®è¾¹ç¼å¯åº¦</span>
<span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> roi = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenCvSharp.Mat(edges, rect))
                {
</span><span style="color: rgba(0, 0, 255, 1)">var</span> totalPixels = roi.Rows *<span style="color: rgba(0, 0, 0, 1)"> roi.Cols;
</span><span style="color: rgba(0, 0, 255, 1)">var</span> edgePixels =<span style="color: rgba(0, 0, 0, 1)"> Cv2.CountNonZero(roi);
</span><span style="color: rgba(0, 0, 255, 1)">var</span> edgeDensity = (<span style="color: rgba(0, 0, 255, 1)">double</span>)edgePixels /<span style="color: rgba(0, 0, 0, 1)"> totalPixels;

</span><span style="color: rgba(0, 0, 255, 1)">if</span> (edgeDensity &gt; <span style="color: rgba(128, 0, 128, 1)">0.1</span> &amp;&amp; rect.Width &gt; <span style="color: rgba(128, 0, 128, 1)">100</span> &amp;&amp; rect.Height &gt; <span style="color: rgba(128, 0, 128, 1)">100</span><span style="color: rgba(0, 0, 0, 1)">)
                    {
                        results.Add(</span><span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> DetectionResult
                        {
                            BoundingBox </span>=<span style="color: rgba(0, 0, 0, 1)"> rect.ToRectangle(),
                            Confidence </span>=<span style="color: rgba(0, 0, 0, 1)"> edgeDensity,
                            DetectionMethod </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Edge</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
                        });
                    }
                }
            }
        }

</span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> results;
    }</span></pre>
</div>
<p><strong data-brushtype="text"><span>æ¹å¼äº:éè¿OCRè¯å«é¢ååå®¹,æ ¹æ®ææåå²ç¹åæ ç¹æå°å¤çç©å½¢æ¥å®ä½é¢åä½ç½®</span></strong></p>
<p><span>&nbsp; &nbsp; OCRåºç¡æ¨¡åç¨çæ¯SVTR-LCNetè¿ä¸ªæ¶æçç½ç»æ¨¡åï¼è®ºææ¯å¬å¼çï¼æä»¬å¨è¿ä¸ªåºç¡ä¸åçå¤ç°ä¸è°ä¼ãè¯ä¸å¤è¯´ï¼åçææ</span></p>
<p><span>&nbsp; &nbsp; ç¸æºæç§åå§åè£¹å¾ç</span></p>
<p><span>&nbsp; &nbsp;&nbsp;<img src="https://img2024.cnblogs.com/blog/116076/202601/116076-20260114185618097-2092867094.png" alt="ScreenShot_2026-01-14_185601_117" width="458" height="383" loading="lazy"></span></p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; OCRè¯å«åå²ææ(æ ¹æ®è¯å«æå­è§åº¦èªå¨æ ¡æ­£)</p>
<p>ãã<img src="https://img2024.cnblogs.com/blog/116076/202601/116076-20260114185658596-1401802679.png" alt="640" loading="lazy"></p>
<p>ããå®ä½å°æ¯ä¸ªè¯å«åå®¹çç©å½¢åæ ï¼è·åææå½åå¾çææåå²ç©å½¢çæå°å¤æ¥ç©å½¢ï¼ç¶åè£åï¼å°±å¯ä»¥å¾å°åå«ææé¢ååå®¹çå¾ç</p>
<p>ãã<img src="https://img2024.cnblogs.com/blog/116076/202601/116076-20260114185730759-1515244179.png" alt="640 (1)" width="840" height="547" loading="lazy"></p>
<p>ããæ é¢åææ(å®éä¼æ¯é¢åå°ï¼ä½æ¯æ»¡è¶³å®¢æ·éæ±ï¼åå«äºææé¢ååå®¹)</p>
<p>ãã<img src="https://img2024.cnblogs.com/blog/116076/202601/116076-20260114185752661-1398249190.png" alt="640 (2)" width="849" height="536" loading="lazy"></p>
<p>ãã<img src="https://img2024.cnblogs.com/blog/116076/202509/116076-20250924180326264-1688793031.png" alt="116076-20250310125032345-1793233350[1]" loading="lazy"></p>
<p>ããåºè¯ä¸å¤è¯´ï¼éä¸ä»£ç </p>
<p>ãã</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(128, 128, 128, 1)">&lt;summary&gt;</span>
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> è¿åé¢åå¾ç
</span><span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(128, 128, 128, 1)">&lt;/summary&gt;</span>
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(128, 128, 128, 1)">&lt;param name="errorMsg"&gt;</span><span style="color: rgba(0, 128, 0, 1)">å¼å¸¸ä¿¡æ¯</span><span style="color: rgba(128, 128, 128, 1)">&lt;/param&gt;</span>
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(128, 128, 128, 1)">&lt;param name="IsEnhanceImage"&gt;</span><span style="color: rgba(0, 128, 0, 1)">é¢åæ¯å¦å¢å¼º</span><span style="color: rgba(128, 128, 128, 1)">&lt;/param&gt;</span>
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(128, 128, 128, 1)">&lt;param name="IsSaveLocl"&gt;</span><span style="color: rgba(0, 128, 0, 1)">æ¯å¦æ¬å°ä¿å­</span><span style="color: rgba(128, 128, 128, 1)">&lt;/param&gt;</span>
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(128, 128, 128, 1)">&lt;returns&gt;&lt;/returns&gt;</span>
<span style="color: rgba(0, 0, 255, 1)">public</span> Bitmap GetLabelImageByBitmap(outstring errorMsg, <span style="color: rgba(0, 0, 255, 1)">bool</span> IsEnhanceImage = <span style="color: rgba(0, 0, 255, 1)">true</span>, <span style="color: rgba(0, 0, 255, 1)">bool</span> IsSaveLocl = <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">)
 {
     Bitmap croppedImage </span>= <span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">;
     errorMsg </span>= <span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)">.Empty;
     </span><span style="color: rgba(0, 0, 255, 1)">try</span><span style="color: rgba(0, 0, 0, 1)">
     {
         </span><span style="color: rgba(0, 0, 255, 1)">if</span> (!<span style="color: rgba(0, 0, 0, 1)">File.Exists(imagePath))
         {
             ShellLine.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">è¯·ç¡®ä¿ {imagePath} å­å¨</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
             errorMsg </span>= $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">è¯·ç¡®ä¿ {imagePath} å­å¨</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
             returnnew Bitmap(</span><span style="color: rgba(128, 0, 128, 1)">10</span>, <span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">);
         }
         </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">å¾çç®å½</span>
         <span style="color: rgba(0, 0, 255, 1)">string</span> imageDir =<span style="color: rgba(0, 0, 0, 1)"> Path.GetDirectoryName(debugImagePath);
         </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (Directory.Exists(imageDir))
         {
             Directory.CreateDirectory(imageDir);
         }
         Bitmap bitmap1 </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> Bitmap(imagePath);
         </span><span style="color: rgba(0, 0, 255, 1)">var</span> rr =<span style="color: rgba(0, 0, 0, 1)"> oCR.GetOCRDataStr(bitmap1, debugImagePath);

         </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è¯»åJSONæä»¶</span>
         <span style="color: rgba(0, 0, 255, 1)">string</span> jsonFilePath = imageDir + <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">\\content.json</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;

         </span><span style="color: rgba(0, 0, 255, 1)">if</span> (!<span style="color: rgba(0, 0, 0, 1)">File.Exists(jsonFilePath))
         {
             errorMsg </span>= $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æªæ¾å°JSONæä»¶ï¼è¯·ç¡®ä¿ {jsonFilePath} å­å¨</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
             ShellLine.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æªæ¾å°JSONæä»¶ï¼è¯·ç¡®ä¿ {jsonFilePath} å­å¨</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
             returnnew Bitmap(imagePath);
         }

         </span><span style="color: rgba(0, 0, 255, 1)">string</span> preRotatedImage = imageDir + <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">\\preRotatedImg.jpg</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
         </span><span style="color: rgba(0, 0, 255, 1)">if</span> (!<span style="color: rgba(0, 0, 0, 1)">File.Exists(preRotatedImage))
         {
             errorMsg </span>= $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æªæ¾å°é¢åæä»¶ï¼è¯·ç¡®ä¿åè£¹é¢åæ¸æ°ä¸å­å¨</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
             ShellLine.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æªæ¾å°é¢åæä»¶ï¼è¯·ç¡®ä¿åè£¹é¢åæ¸æ°ä¸å­å¨</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
             returnnew Bitmap(imagePath);
         }

         </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è§£æç©å½¢æ°æ®å¹¶è®¡ç®æå°å¤æ¥ç©å½¢</span>
         List&lt;Rectangle&gt; rectangles =<span style="color: rgba(0, 0, 0, 1)"> ParseRectanglesFromJson(jsonFilePath);
         </span><span style="color: rgba(0, 0, 255, 1)">if</span> (rectangles.Count == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
         {
             errorMsg </span>= <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æªå¨JSONæä»¶ä¸­æ¾å°ææçç©å½¢æ°æ®</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
             ShellLine.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æªå¨JSONæä»¶ä¸­æ¾å°ææçç©å½¢æ°æ®</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
             returnnew Bitmap(imagePath);
         }

         Rectangle boundingRect </span>=<span style="color: rgba(0, 0, 0, 1)"> CalculateBoundingRectangle(rectangles);
         ShellLine.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">æå°å¤æ¥ç©å½¢: X={boundingRect.X}, Y={boundingRect.Y}, Width={boundingRect.Width}, Height={boundingRect.Height}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
         ShellLine.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">åå« {rectangles.Count} ä¸ªåç´ </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

         </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å è½½å¾çå¹¶è¿è¡è£åª</span>
         <span style="color: rgba(0, 0, 255, 1)">using</span> (Bitmap originalImage = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> Bitmap(preRotatedImage))
         {
             </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ç¡®ä¿ç©å½¢å¨å¾çèå´å</span>
             Rectangle safeRect =<span style="color: rgba(0, 0, 0, 1)"> GetSafeRectangle(boundingRect, originalImage);
             </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è£åªå¾ç</span>
             croppedImage =<span style="color: rgba(0, 0, 0, 1)"> CropImage(originalImage, safeRect);
             </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (IsEnhanceImage)
             {
                 </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å¢å¼ºæ¾ç¤º </span>
                 EnhanceImage(<span style="color: rgba(0, 0, 255, 1)">ref</span><span style="color: rgba(0, 0, 0, 1)"> croppedImage);
             }
             </span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)"> (IsSaveLocl)
             {
                 </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ä¿å­ç»æ</span>
                 <span style="color: rgba(0, 0, 255, 1)">string</span> outputPath =<span style="color: rgba(0, 0, 0, 1)"> Path.Combine(
                     Path.GetDirectoryName(preRotatedImage),
                     Path.GetFileNameWithoutExtension(preRotatedImage) </span>+ <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">_cropped_enhanced.jpg</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

                 croppedImage.Save(outputPath, ImageFormat.Jpeg);
                 ShellLine.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¤çå®æï¼ç»æå·²ä¿å­å°: {outputPath}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
             }
             </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ¾ç¤ºè£åªåºåä¿¡æ¯</span>
             ShellLine.WriteLine($<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">\nè£åªåºåä¿¡æ¯:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
             ShellLine.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  åå§å¾çå°ºå¯¸: {originalImage.Width}x{originalImage.Height}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
             ShellLine.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  è£åªåºå: {safeRect.X}, {safeRect.Y}, {safeRect.Width}x{safeRect.Height}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
             ShellLine.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  å¢å¼ºåå¾çå°ºå¯¸: {croppedImage.Width}x{croppedImage.Height}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
             </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> croppedImage;
         }
     }
     </span><span style="color: rgba(0, 0, 255, 1)">catch</span><span style="color: rgba(0, 0, 0, 1)"> (Exception ex)
     {
         errorMsg </span>= $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¤çè¿ç¨ä¸­åºç°éè¯¯: {ex.Message}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
         ShellLine.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å¤çè¿ç¨ä¸­åºç°éè¯¯: {ex.Message}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
         ShellLine.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">å æ è·è¸ª: {ex.StackTrace}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
         returnnew Bitmap(imagePath);
     }
     </span><span style="color: rgba(0, 0, 255, 1)">finally</span><span style="color: rgba(0, 0, 0, 1)">
     {
         </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> éæ¾èµæº</span>
         croppedImage?<span style="color: rgba(0, 0, 0, 1)">.Dispose();
     }
 }</span></pre>
</div>
<p>ããå¾çå¢å¼ºæ¾ç¤ºï¼æéè¦å¯ä»¥è°ç¨</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(128, 128, 128, 1)">&lt;summary&gt;</span>
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> å¾çå¢å¼ºæ¾ç¤º
</span><span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(128, 128, 128, 1)">&lt;/summary&gt;</span>
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(128, 128, 128, 1)">&lt;param name="image"&gt;&lt;/param&gt;</span>
publicvoidEnhanceImage(<span style="color: rgba(0, 0, 255, 1)">ref</span><span style="color: rgba(0, 0, 0, 1)"> Bitmap image)
 {
     </span><span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> mat =<span style="color: rgba(0, 0, 0, 1)"> image.ToMat())
     </span><span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> lab = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenCvSharp.Mat())
     {
         </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è½¬æ¢ä¸ºLabè²å½©ç©ºé´</span>
<span style="color: rgba(0, 0, 0, 1)">         Cv2.CvtColor(mat, lab, ColorConversionCodes.BGR2Lab);

         Cv2.Split(lab, outvar labChannels);

         </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å¯¹äº®åº¦ééè¿è¡ç´æ¹å¾åè¡¡å</span>
         Cv2.EqualizeHist(labChannels[<span style="color: rgba(128, 0, 128, 1)">0</span>], labChannels[<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">]);

         Cv2.Merge(labChannels, lab);
         Cv2.CvtColor(lab, mat, ColorConversionCodes.Lab2BGR);

         </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> éæ¾éé</span>
         <span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> channel <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> labChannels)
             channel.Dispose();

         </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ´æ°å¾å</span>
<span style="color: rgba(0, 0, 0, 1)">         image.Dispose();
         image </span>=<span style="color: rgba(0, 0, 0, 1)"> mat.ToBitmap();
     }
 }</span></pre>
</div>
<p>ããè·ååå«ææåå²å­ç¬¦çæå°å¤æ¥ç©å½¢</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è®¡ç®åå«ææç©å½¢çæå°å¤æ¥ç©å½¢</span>
  <span style="color: rgba(0, 0, 255, 1)">static</span> Rectangle CalculateBoundingRectangle(List&lt;Rectangle&gt;<span style="color: rgba(0, 0, 0, 1)"> rectangles)
  {
      </span><span style="color: rgba(0, 0, 255, 1)">if</span> (rectangles.Count == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
          thrownew ArgumentException(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ç©å½¢åè¡¨ä¸ºç©º</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

      </span><span style="color: rgba(0, 0, 255, 1)">int</span> minX = <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">.MaxValue;
      </span><span style="color: rgba(0, 0, 255, 1)">int</span> minY = <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">.MaxValue;
      </span><span style="color: rgba(0, 0, 255, 1)">int</span> maxX = <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">.MinValue;
      </span><span style="color: rgba(0, 0, 255, 1)">int</span> maxY = <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">.MinValue;

      </span><span style="color: rgba(0, 0, 255, 1)">foreach</span> (Rectangle rect <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> rectangles)
      {
          minX </span>=<span style="color: rgba(0, 0, 0, 1)"> Math.Min(minX, rect.X);
          minY </span>=<span style="color: rgba(0, 0, 0, 1)"> Math.Min(minY, rect.Y);
          maxX </span>= Math.Max(maxX, rect.X +<span style="color: rgba(0, 0, 0, 1)"> rect.Width);
          maxY </span>= Math.Max(maxY, rect.Y +<span style="color: rgba(0, 0, 0, 1)"> rect.Height);
      }

      </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ·»å ä¸äºè¾¹è·ï¼ä½¿è£åªæ´ç¾è§</span>
      <span style="color: rgba(0, 0, 255, 1)">int</span> margin = <span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">;
      minX </span>= Math.Max(<span style="color: rgba(128, 0, 128, 1)">0</span>, minX -<span style="color: rgba(0, 0, 0, 1)"> margin);
      minY </span>= Math.Max(<span style="color: rgba(128, 0, 128, 1)">0</span>, minY -<span style="color: rgba(0, 0, 0, 1)"> margin);
      maxX </span>= maxX +<span style="color: rgba(0, 0, 0, 1)"> margin;
      maxY </span>= maxY +<span style="color: rgba(0, 0, 0, 1)"> margin;

      returnnew Rectangle(minX, minY, maxX </span>- minX, maxY -<span style="color: rgba(0, 0, 0, 1)"> minY);
  }

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ç¡®ä¿ç©å½¢å¨å¾çèå´å</span>
<span style="color: rgba(0, 0, 255, 1)">static</span><span style="color: rgba(0, 0, 0, 1)"> Rectangle GetSafeRectangle(Rectangle rect, Bitmap image)
  {
      </span><span style="color: rgba(0, 0, 255, 1)">int</span> x = Math.Max(<span style="color: rgba(128, 0, 128, 1)">0</span>, Math.Min(rect.X, image.Width - <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">));
      </span><span style="color: rgba(0, 0, 255, 1)">int</span> y = Math.Max(<span style="color: rgba(128, 0, 128, 1)">0</span>, Math.Min(rect.Y, image.Height - <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">));
      </span><span style="color: rgba(0, 0, 255, 1)">int</span> width = Math.Min(rect.Width, image.Width -<span style="color: rgba(0, 0, 0, 1)"> x);
      </span><span style="color: rgba(0, 0, 255, 1)">int</span> height = Math.Min(rect.Height, image.Height -<span style="color: rgba(0, 0, 0, 1)"> y);

      returnnew Rectangle(x, y, width, height);
  }

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è£åªå¾ç</span>
<span style="color: rgba(0, 0, 255, 1)">static</span><span style="color: rgba(0, 0, 0, 1)"> Bitmap CropImage(Bitmap source, Rectangle cropArea)
  {
      Bitmap target </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> Bitmap(cropArea.Width, cropArea.Height);

      </span><span style="color: rgba(0, 0, 255, 1)">using</span> (Graphics g =<span style="color: rgba(0, 0, 0, 1)"> Graphics.FromImage(target))
      {
          g.DrawImage(source, </span><span style="color: rgba(0, 0, 255, 1)">new</span> Rectangle(<span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">, cropArea.Width, cropArea.Height),
              cropArea, GraphicsUnit.Pixel);
      }
      </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> target;
  }</span></pre>
</div>
<p><strong><span>ããç»æè¯­</span></strong></p>
<p><strong>&nbsp;&nbsp; &nbsp;ããæè°¢åä½èå¿æ¥éï¼ &nbsp;å¦ææ¨ææ´å¥½çæ³æ³æ¬¢è¿ä¸èµ·äº¤æµï¼æä¸æçä¹å¯ä»¥å¾®ä¿¡å¬ä¼å·èç³»åä¸»ï¼ä½èå¬ä¼å·ä¼ç»å¸¸åä¸äºå®ç¨çå°å·¥å·ådemoæºç ï¼éè¦çå¯ä»¥å»ççï¼å¦å¤ï¼å¦æè§å¾æ¬ç¯åæå¯¹æ¨æèèº«è¾¹æåæå¸®å©çï¼éº»ç¦ç¹ä¸ªå³æ³¨ï¼èµ äººç«ç°ï¼æçä½é¦ï¼æ¨çæ¯æå°±æ¯æåä½æå¤§çå¨åï¼æè°¢æ¨çå³æ³¨ï¼æå¾åæ¨ä¸èµ·æ¢è®¨ï¼åä¼ï¼</strong></p>
<p><img src="https://img2024.cnblogs.com/blog/116076/202509/116076-20250924180748850-573212949.gif" alt="640" loading="lazy"></p>
<p>&nbsp;</p>
</div>
<div id="MySignature" role="contentinfo">
    <div id="AllanboltSignature1" style="color:green;">        
<p id="PSignature" style="border-top: red 1px dashed; border-right: red 1px dashed; border-bottom: red 1px dashed; border-left:  red 1px dashed;            padding-top: 50px;padding-right: 10px;padding-bottom: 10px;padding-left: 250px;            background: url(https://images.cnblogs.com/cnblogs_com/axing/1657506/o_2002281642338.jpg) #e5f1f4 no-repeat 1% 20%;           font-family: å¾®è½¯éé»; font-size:11px;">            
<br> 
ä½èï¼<a href="http://www.cnblogs.com/axing/" target="_blank" style="color:Red;">Stephen-kzx</a>            
<br> 
åºå¤ï¼<a href="http://www.cnblogs.com/axing/" target="_blank" style="color:Red;">http://www.cnblogs.com/axing/</a>
<br> 
å¬ä¼å·ï¼<font color="red">ä¼å®æ¶åäº«åå·¥ä½ä¸­æèçæ´»ä¸­éå°çå°æ¸¸æåå°å·¥å·æºç ãæå´è¶£çå¸®å¿ç¹ä¸å³æ³¨ï¼ææ©ï¼</font>
<br>æ¬æçæå½ä½èååå®¢å­å±æï¼æ¬¢è¿è½¬è½½ï¼ä½æªç»ä½èåæå¿é¡»ä¿çæ­¤æ®µå£°æï¼ä¸å¨æç« é¡µé¢ææ¾ä½ç½®ç»åºåæè¿æ¥ï¼å¦åä¿çè¿½ç©¶æ³å¾è´£ä»»çæå©ã

</p>
</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.0006944444444444445" data-date-updated="2026-01-15 10:47">2026-01-15 10:46</span>&nbsp;
<a href="https://www.cnblogs.com/axing">ä½ä»¥è§£å¿§å¯æ*ç </a>&nbsp;
éè¯»(<span id="post_view_count">7</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19483856);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19483856', targetLink: 'https://www.cnblogs.com/axing/p/19483856', title: 'c#å®ç°åè£¹æ£é¢åçå ç§æ¹å¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>