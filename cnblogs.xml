<?xml version="1.0" encoding="UTF-8" ?>
    <rss version="2.0">
    <channel>
        <title><![CDATA[ ä¸»é¡µ - åå®¢å­ ]]></title>
        <link><![CDATA[ https://www.cnblogs.com/ ]]></link>
        <lastBuildDate>2026-01-09T12:35:13.556Z</lastBuildDate>
        <description><![CDATA[
        ä¸»é¡µ - åå®¢å­ RSS
    ]]></description>
        <language>zh-cn</language>
        <item>
    <title><![CDATA[ Flinkæºç éè¯»ï¼Taskæ°æ®äº¤äº ]]></title>
    <link>https://www.cnblogs.com/Jackeyzhe/p/19463278</link>
    <guid>6a8e436530e1c28164345f05f0039b7b</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Jackeyzhe/p/19463278" title="åå¸äº 2026-01-09 20:11">
    <span role="heading" aria-level="2">Flinkæºç éè¯»ï¼Taskæ°æ®äº¤äº</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/1828322/202601/1828322-20260109201055245-933532869.png" alt="Flinkæºç éè¯»ï¼Taskæ°æ®äº¤äº" class="desc_img">
        ç»è¿åé¢çå­¦ä¹ ï¼Flink çå ä¸ªæ ¸å¿æ¦å¿µç¸å³çæºç å®ç°æä»¬å·²ç»äºè§£äºãæ¬ææä»¬æ¥æ¢³ç Task çæ°æ®äº¤äºç¸å³çæºç ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>ç»è¿åé¢çå­¦ä¹ ï¼Flink çå ä¸ªæ ¸å¿æ¦å¿µç¸å³çæºç å®ç°æä»¬å·²ç»äºè§£äºãæ¬ææä»¬æ¥æ¢³ç Task çæ°æ®äº¤äºç¸å³çæºç ã</p>
<h3 id="æ°æ®è¾åº">æ°æ®è¾åº</h3>
<p>è¯ä¸å¤è¯´ï¼æä»¬ç´æ¥è¿å¥æ­£é¢ãé¦åæ¥ç Task çæ°æ®è¾åºï¼å¨è¿å¥æµç¨ä¹åï¼æä»¬åä»ç»å ä¸ªåºæ¬æ¦å¿µã</p>
<h4 id="åºæ¬æ¦å¿µ">åºæ¬æ¦å¿µ</h4>
<ul>
<li>
<p>RecordWriterOutputï¼å®æ¯ Output æ¥å£çä¸ä¸ªå·ä½å®ç°ç±»ï¼åºå±ä½¿ç¨ RecordWriter æ¥åéæ°æ®ã</p>
</li>
<li>
<p>RecordWriterï¼æ°æ®åå¥çæ§è¡èï¼è´è´£å°æ°æ®åå° ResultPartitionã</p>
</li>
<li>
<p>ResultPartition å ResultSubpartitionï¼ResultPartition æ¯ ExecutionGraph ä¸­ä¸ä¸ªèç¹çè¾åºç»æï¼ä¸æ¸¸çæ¯ä¸ªéè¦ä»å½å ResultPartition æ¶è´¹æ°æ®ç Task é½ä¼æä¸ä¸ª ResultSubpartitionã</p>
</li>
<li>
<p>ChannelSelectorï¼ç¨æ¥å³å®ä¸ä¸ª Record è¦è¢«åå°åªä¸ª Subpartition ä¸­ã</p>
</li>
<li>
<p>LocalBufferPoolï¼ç¨æ¥ç®¡ç Buffer çç¼å²æ± ãå¨ä»ç»ååçåçæ¶ï¼æä»¬æå°è¿ã</p>
</li>
</ul>
<p>å¯¹è¿äºåºæ¬æ¦å¿µæäºä¸å®çäºè§£ä¹åï¼æä»¬æ¥çæ°æ®è¾åºçå·ä½æµç¨ã</p>
<h4 id="æ§è¡æµç¨">æ§è¡æµç¨</h4>
<p>æä»¬ä»¥ map ä¸ºä¾ï¼çä¸ä¸æ°æ®çè¾åºè¿ç¨ã</p>
<p><img alt="DataOutput" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1767175113/Blog/flink/18/RecordOutput.png" class="lazyload"></p>
<p>å¨ <code>StreamMap.processElement</code> æ¹æ³ä¸­ï¼è°ç¨å® map æ¹æ³ä¹åï¼å°±ä¼è°ç¨ <code>output.collect</code> æ¹æ³å°æ°æ®è¾åºï¼è¿éç output å°±æ¯ RecordWriterOutputãå¨ RecordWriterOutput ä¸­ï¼ä¼è°ç¨ RecordWriter ç emit æ¹æ³ã</p>
<pre><code class="language-java">private &lt;X&gt; void pushToRecordWriter(StreamRecord&lt;X&gt; record) {
    serializationDelegate.setInstance(record);

    try {
        recordWriter.emit(serializationDelegate);
    } catch (IOException e) {
        throw new UncheckedIOException(e.getMessage(), e);
    }
}
</code></pre>
<p>è¿éç serializationDelegate æ¯ç¨æ¥å¯¹ record è¿è¡åºååçãRecordWriter æä¸¤ä¸ªå®ç°ç±»ï¼ä¸ä¸ªæ¯ ChannelSelectorRecordWriterï¼å¦ä¸ä¸ªæ¯ BroadcastRecordWriterãChannelSelectorRecordWriter éè¦åè°ç¨ ChannelSelector éæ©å¯¹åºç subparitionï¼ç¶åè¿è¡åå¥ãBroadcastRecordWriter åæ¯åå°ææç subparitionã</p>
<p>æ¥ä¸æ¥å°±æ¯è°ç¨ <code>BufferWritingResultPartition.emitRecord</code> æ¥åå¥æ°æ®ã</p>
<pre><code class="language-java">public void emitRecord(ByteBuffer record, int targetSubpartition) throws IOException {
    totalWrittenBytes += record.remaining();

    BufferBuilder buffer = appendUnicastDataForNewRecord(record, targetSubpartition);

    while (record.hasRemaining()) {
        // full buffer, partial record
        finishUnicastBufferBuilder(targetSubpartition);
        buffer = appendUnicastDataForRecordContinuation(record, targetSubpartition);
    }

    if (buffer.isFull()) {
        // full buffer, full record
        finishUnicastBufferBuilder(targetSubpartition);
    }

    // partial buffer, full record
}
</code></pre>
<p>è¿éæ record åå¥å° buffer ä¸­ï¼å¦æ buffer ä¸å¤ï¼åä¼ä» LocalBufferPool ä¸­ç³è¯·æ°ç bufferï¼ç³è¯·å°ä¹åå°±ä¼ç»§ç»­åå¥ãä¸é¢æ¯å·ä½çç³è¯·è¿ç¨ã</p>
<pre><code class="language-java">private MemorySegment requestMemorySegment(int targetChannel) {
    MemorySegment segment = null;
    synchronized (availableMemorySegments) {
        checkDestroyed();

        if (!availableMemorySegments.isEmpty()) {
            segment = availableMemorySegments.poll();
        } else if (isRequestedSizeReached()) {
            // Only when the buffer request reaches the upper limit(i.e. current pool size),
            // requests an overdraft buffer.
            segment = requestOverdraftMemorySegmentFromGlobal();
        }

        if (segment == null) {
            return null;
        }

        if (targetChannel != UNKNOWN_CHANNEL) {
            if (++subpartitionBuffersCount[targetChannel] == maxBuffersPerChannel) {
                unavailableSubpartitionsCount++;
            }
        }

        checkAndUpdateAvailability();
    }
    return segment;
}
</code></pre>
<p>å¦ææå¯ç¨åå­ï¼å°±ç´æ¥ä»éåä¸­åºéãå¦æè¾¾å°äºæ¬å° BufferPool çä¸éï¼å°±ä»å¨å±ç NetworkBufferPool ä¸­ç³è¯·ï¼ç³è¯·ä¸å°å°±ä¼é»å¡åå¥è¿ç¨ï¼ç­å¾ç³è¯·ãæåè¿ä¼æ£æ¥å¹¶æ´æ°å¯ç¨åå­ç¶æã</p>
<p>æäºå¯ç¨ç buffer ä¹åï¼å°±ä¼è°ç¨ addToSubpartitionï¼æç»æ°æ®å­å¨å¨ PipelinedSubpartition ç buffers éåä¸­ã</p>
<pre><code class="language-java">private void addToSubpartition(
        BufferBuilder buffer,
        int targetSubpartition,
        int partialRecordLength,
        int minDesirableBufferSize)
        throws IOException {
    int desirableBufferSize =
            subpartitions[targetSubpartition].add(
                    buffer.createBufferConsumerFromBeginning(), partialRecordLength);

    resizeBuffer(buffer, desirableBufferSize, minDesirableBufferSize);
}
</code></pre>
<h3 id="æ°æ®è¾å¥">æ°æ®è¾å¥</h3>
<p>çå®äºæ°æ®è¾åºçè¿ç¨ä¹åï¼æä»¬åæ¥çä¸ä¸æ°æ®è¾å¥çè¿ç¨ãé¦åè¿æ¯äºè§£å ä¸ªåºæ¬æ¦å¿µã</p>
<h4 id="åºæ¬æ¦å¿µ-1">åºæ¬æ¦å¿µ</h4>
<ul>
<li>
<p>InputGateï¼InputGate æ¯å¯¹è¾å¥çå°è£ï¼ä¸ JobGraph ä¸­ç JobEdge ä¸ä¸å¯¹åºï¼æ¯ä¸ª InputGate æ¶è´¹ä¸æ¸¸ä¸ä¸ªæå¤ä¸ª Resultpartitionã</p>
</li>
<li>
<p>InputChannelï¼InputChannel æ¯å ExecutionGraph ä¸­ç ExecutionEdge ä¸ä¸å¯¹åºçãæ¯ä¸ª InputChannel æ¥æ¶ä¸ä¸ª ResultSubpartition çè¾åºï¼InputChannel ä¸»è¦å³æ³¨ LocalInputChannel å RemoteInputChannel ä¸¤ç§å®ç°ã</p>
</li>
</ul>
<h4 id="æ§è¡æµç¨-1">æ§è¡æµç¨</h4>
<p>äºè§£äºå·ä½æ¦å¿µä¹åï¼æä»¬åçæ°æ®è¾å¥çå·ä½æµç¨ã</p>
<p><img alt="RecordInput" loading="lazy" data-src="https://res.cloudinary.com/dxydgihag/image/upload/v1767531100/Blog/flink/18/RecordInput.png" class="lazyload"></p>
<p>æ°æ®è¾å¥çå¥å£æ¯ <code>StreamTask.processInput</code> æ¹æ³ï¼è¿ä¸ªæ¹æ³ä¸­ä¸»è¦æ¯è°ç¨ <code>inputProcessor.processInput</code> æ¹æ³ï¼æä»¬ä»¥ StreamOneInputProcessor ä¸ºä¾ãè¿ä¸ªæ¹æ³å°±æ¯è°ç¨ <code>input.emitNext</code> æ¹æ³ã</p>
<pre><code class="language-java">public DataInputStatus emitNext(DataOutput&lt;T&gt; output) throws Exception {

    while (true) {
        // get the stream element from the deserializer
        if (currentRecordDeserializer != null) {
            RecordDeserializer.DeserializationResult result;
            try {
                result = currentRecordDeserializer.getNextRecord(deserializationDelegate);
            } catch (IOException e) {
                throw new IOException(
                        String.format("Can't get next record for channel %s", lastChannel), e);
            }
            if (result.isBufferConsumed()) {
                currentRecordDeserializer = null;
            }

            if (result.isFullRecord()) {
                final boolean breakBatchEmitting =
                        processElement(deserializationDelegate.getInstance(), output);
                if (canEmitBatchOfRecords.check() &amp;&amp; !breakBatchEmitting) {
                    continue;
                }
                return DataInputStatus.MORE_AVAILABLE;
            }
        }

        Optional&lt;BufferOrEvent&gt; bufferOrEvent = checkpointedInputGate.pollNext();
        if (bufferOrEvent.isPresent()) {
            // return to the mailbox after receiving a checkpoint barrier to avoid processing of
            // data after the barrier before checkpoint is performed for unaligned checkpoint
            // mode
            if (bufferOrEvent.get().isBuffer()) {
                processBuffer(bufferOrEvent.get());
            } else {
                DataInputStatus status = processEvent(bufferOrEvent.get(), output);
                if (status == DataInputStatus.MORE_AVAILABLE &amp;&amp; canEmitBatchOfRecords.check()) {
                    continue;
                }
                return status;
            }
        } else {
            if (checkpointedInputGate.isFinished()) {
                checkState(
                        checkpointedInputGate.getAvailableFuture().isDone(),
                        "Finished BarrierHandler should be available");
                return DataInputStatus.END_OF_INPUT;
            }
            return DataInputStatus.NOTHING_AVAILABLE;
        }
    }
}
</code></pre>
<p>è¿éæ¯è°ç¨ <code>checkpointedInputGate.pollNext</code> æ¥è·åè¾å¥çæ°æ®ãå®çåé¨å°±æ¯è°ç¨ InputGate ç pollNext æ¹æ³æ¥è·åæ°æ®ãå½è·åå°å®æ´æ°æ®ä¹åï¼å°±ä¼è°ç¨ processElement æ¥å¤çæ°æ®ã</p>
<p>æä»¬ä»¥ SingleInputGate ä¸ºä¾ç InputGate ç pollNext æ¹æ³ãå®çåé¨è°ç¨é¾è·¯å¯ç¨ä¸ç´è¿½è¸ªå° readBufferFromInputChannel æ¹æ³ï¼è¿ä¸ªæ¹æ³åä¼è°ç¨ <code>inputChannel.getNextBuffer</code>ï¼è¿éäº¤ç» InputChannel æ¥å·ä½æ§è¡æ°æ®è¯»åã</p>
<pre><code class="language-java">public Optional&lt;BufferAndAvailability&gt; getNextBuffer() throws IOException {
    checkError();

    if (!toBeConsumedBuffers.isEmpty()) {
        return getBufferAndAvailability(toBeConsumedBuffers.removeFirst());
    }

    ResultSubpartitionView subpartitionView = this.subpartitionView;
    if (subpartitionView == null) {
        // There is a possible race condition between writing a EndOfPartitionEvent (1) and
        // flushing (3) the Local
        // channel on the sender side, and reading EndOfPartitionEvent (2) and processing flush
        // notification (4). When
        // they happen in that order (1 - 2 - 3 - 4), flush notification can re-enqueue
        // LocalInputChannel after (or
        // during) it was released during reading the EndOfPartitionEvent (2).
        if (isReleased) {
            return Optional.empty();
        }

        // this can happen if the request for the partition was triggered asynchronously
        // by the time trigger
        // would be good to avoid that, by guaranteeing that the requestPartition() and
        // getNextBuffer() always come from the same thread
        // we could do that by letting the timer insert a special "requesting channel" into the
        // input gate's queue
        subpartitionView = checkAndWaitForSubpartitionView();
    }

    BufferAndBacklog next = subpartitionView.getNextBuffer();
    // ignore the empty buffer directly
    while (next != null &amp;&amp; next.buffer().readableBytes() == 0) {
        next.buffer().recycleBuffer();
        next = subpartitionView.getNextBuffer();
        numBuffersIn.inc();
    }

    if (next == null) {
        if (subpartitionView.isReleased()) {
            throw new CancelTaskException(
                    "Consumed partition " + subpartitionView + " has been released.");
        } else {
            return Optional.empty();
        }
    }

    Buffer buffer = next.buffer();

    if (buffer instanceof FullyFilledBuffer) {
        List&lt;Buffer&gt; partialBuffers = ((FullyFilledBuffer) buffer).getPartialBuffers();
        int seq = next.getSequenceNumber();
        for (Buffer partialBuffer : partialBuffers) {
            toBeConsumedBuffers.add(
                    new BufferAndBacklog(
                            partialBuffer,
                            next.buffersInBacklog(),
                            buffer.getDataType(),
                            seq++));
        }

        return getBufferAndAvailability(toBeConsumedBuffers.removeFirst());
    }

    return getBufferAndAvailability(next);
}
</code></pre>
<p>æä»¬åæ¥ç LocalInputChannelï¼åè·åå°äº subpartitionViewï¼å¹¶è°ç¨ getNextBufferï¼è¿éå¶å®å°±æ¯ä» PipelinedSubpartition ç buffers éåä¸­è¯»åæ°æ®ã</p>
<p>RemoteInputChannel åéè¦ä» receivedBuffers ä¸­è¯»åæ°æ®ï¼è¿ä¸ªéåçæ°æ®å°±æ¯æ¶è´¹ä¸æ¸¸æ°æ®åä¿å­çã</p>
<p>è³æ­¤ï¼Flink ä¸­ Task çæ°æ®è¾å¥åè¾åºè¿ç¨çæºç å°±æ¢³çå®äºï¼æ´å åºå±ç Netty ç¸å³ä»£ç æä»¬å¨åé¢ç»§ç»­æ¢³çã</p>
<h3 id="æ»ç»">æ»ç»</h3>
<p>æåç®åæ»ç»ä¸ä¸ï¼æ¬ææä»¬æ¢³çäº Task çæ°æ®è¾åºåè¾å¥çè¿ç¨ãè¾åºè¿ç¨ä¸»è¦æ¯å©ç¨ RecordWriter å°æ°æ®åå¥å° Buffer ä¸­ï¼è¾å¥è¿ç¨åæ¯å©ç¨ InputChannel ä» Buffer æ¶è´¹çè¿ç¨ãå¦æä½ ç Flink ä»»å¡æ°æ®éç¹å«å¤§ï¼å¹¶ä¸æ²¡ä»ä¹å¤æçé»è¾ï¼å¯ä»¥èèéå½è°æ´ localBufferPool çå¤§å°æ¥è°ä¼ä»»å¡çååã</p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-09 20:11">2026-01-09 20:11</span>&nbsp;
<a href="https://www.cnblogs.com/Jackeyzhe">Jackeyzhe</a>&nbsp;
éè¯»(<span id="post_view_count">0</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19463278);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19463278', targetLink: 'https://www.cnblogs.com/Jackeyzhe/p/19463278', title: 'Flinkæºç éè¯»ï¼Taskæ°æ®äº¤äº' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å¬ä¼å·æ¨èæºå¶æ´çï¼ç§æå·æä¹æç¤¾äº¤æµéåèµ·æ¥ ]]></title>
    <link>https://www.cnblogs.com/reachteam/p/19463233</link>
    <guid>c1bbd77ef1e4ce0077e0c8ba1aa44ec2</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/reachteam/p/19463233" title="åå¸äº 2026-01-09 19:39">
    <span role="heading" aria-level="2">å¬ä¼å·æ¨èæºå¶æ´çï¼ç§æå·æä¹æç¤¾äº¤æµéåèµ·æ¥</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<h1 data-heading="true">01 èæ¯</h1>
<p><span>æè¿æä»¬è½¯ä»¶å¢éåå äºä¸ä¸ªé«æ ¡å³äºå¬ä¼å·è¿è¥çåäº«ï¼å¬å®æºæå¯åï¼æä»¥æéç¹æ´çæä¸ç¯ç¬è®°ï¼ååºæ¥ç»å¤§å®¶åèã</span></p>
<p><span>ä» 2023 å¹´å¼å§ï¼å¬ä¼å·çååä¸ååªæ¯è®¢éæ¨éé£ä¸å¥äºï¼ç°å¨æ´åæ¯ç¤¾äº¤ä¿¡å· + ç®æ³æ¨èä¸èµ·å¨ååãææ°æ®æå°ï¼2025 å¹´æç§æ/è½¯ä»¶å°å·éè¿ç¤¾äº¤æ¨èæ¿å°çæµéå æ¯å·²ç»å° 45.9%ï¼çè³è¶è¿äºä¼ ç»è®¢éæ¨éã</span></p>
<p><span>æä»¥è¿ç¯æç« æ³è§£å³çå°±ä¸ä»¶äºï¼</span></p>
<p><span>ç§æå·å°åºè¦æä¹åï¼æè½æ´å®¹æè¢«æ¨èï¼ä¹æ´å®¹æè¢«è½¬åã</span></p>
<p><span>ä¸é¢æ 6 ä¸ªæ¹åè®²æ¸æ¥ï¼ææ¯é»è¾ãå³é®ææ ãååæµç¨ãè´¦å·å·®å¼ãæ¼è¿ååãæ¡ä¾åå¯æä½å»ºè®®ã</span></p>
<h2 data-heading="true"><span>02 æ¨èç³»ç»å¤§æ¦æä¹è·</span></h2>
<h3 data-heading="true"><span>2.1 ä¸ç±»ä¿¡å·æéè¦</span></h3>
<p><span>2025 å¹´ä¹åï¼å¬ä¼å·çæ¨èæ´å¼ºè°ä¸ç±»ä¿¡å·ä¸èµ·çï¼</span></p>
<p><span>1. ç¤¾äº¤å³ç³»ï¼æåçè¿ãè½¬åãå¨çç­</span></p>
<p><span>2. å´è¶£æ ç­¾ï¼ä½ æ¯ä»ä¹äººç¾¤ï¼åå®¹æ¯ä»ä¹ä¸»é¢</span></p>
<p><span>3. è¡ä¸ºæ°æ®ï¼ç¹å»ãåçãå®è¯»ãæ»å¨éåº¦ãç¹èµåçå¨ä»ä¹æ¶å</span></p>
<p><span>ç³»ç»ä¼åä»åå®¹éæåå³é®è¯ï¼åç»åç¨æ·è¡ä¸ºæ´æ°ç»åï¼æåå³å®ç»è°æ´å¤æåãå¯ä»¥æå®çè§£æä¸ä¸ªå¾ªç¯ï¼åæåä¸å°æ³¢ï¼çåé¦ï¼åå³å®è¦ä¸è¦ç»§ç»­ç»éã</span></p>
<p><span>å¦å¤æä¸ç¹å¾å³é®ï¼æç« ååºå»ä¹åéå¸¸ 1 å° 3 åéåå°±ä¼åä¸è½®è´¨éè¯ä¼°ï¼ä¸»é¢ä»·å¼ãé»è¾ç»æãååæ§ãä»¥å AI çæçè¿¹è¿äºé½ä¼è¢«ç»¼åå¤æ­ã</span></p>
<h3 data-heading="true"><span>2.2 ææ æéé¿ä»ä¹æ ·</span></h3>
<p><span>åæå¤§çæ¾å¨è¿ãæ°å­æ¯ç ç©¶æ´çå£å¾ï¼å¤§å®¶çè¶å¿åéç¹å°±è¡ã</span></p>
<p><span>è¡¨ 1ï¼å¬ä¼å·ç®æ³æ ¸å¿æéåé</span></p>
<table>
<thead>
<tr><th><span>æéç»´åº¦</span></th><th><span>å·ä½ææ </span></th><th><span>æéå æ¯</span></th><th><span>å³é®éå¼ï¼ç¤ºä¾ï¼</span></th></tr>
</thead>
<tbody>
<tr>
<td><span>ç¤¾äº¤ä¼ æ­ç³»æ°</span></td>
<td><span>å¥½åæ¨èçãè½¬åå°æåå/ç¤¾ç¾¤æ¬¡æ°ãè·¨åå±ä¼ æ­æ·±åº¦</span></td>
<td><span>35%</span></td>
<td><span>ç¤¾äº¤æ¨èæµéå æ¯ â¥ 45%</span></td>
</tr>
<tr>
<td><span>åå®¹è´¨éå å­</span></td>
<td><span>å®è¯»çï¼â¥65%ï¼ãå¹³åéè¯»æ¶é¿ï¼â¥2 åéï¼ãåååº¦ï¼3 åæéï¼</span></td>
<td><span>30%</span></td>
<td><span>å®è¯»ç â¥ 50%</span></td>
</tr>
<tr>
<td><span>ç¨æ·è¡ä¸ºç»å</span></td>
<td><span>ç¹å»çãæ»å¨éåº¦ãç¹èµæ¶é´ç¹ç­å¾®è§è¡ä¸º</span></td>
<td><span>20%</span></td>
<td><span>ç¹å»ç â¥ 15%</span></td>
</tr>
<tr>
<td><span>è´¦å·ä¿¡èªä½ç³»</span></td>
<td><span>æ´æ°é¢çãè¿è§è®°å½ãç¨æ·æè¯ç</span></td>
<td><span>10%</span></td>
<td><span>æ¥æ´å¯æå 300% åå§æ¨è</span></td>
</tr>
<tr>
<td><span>å®æ¶æµéåå¼</span></td>
<td><span>15 åéå¨æè°æ´</span></td>
<td><span>5%</span></td>
<td><span>å·å¯å¨æç¹å»ç &gt; 8%</span></td>
</tr>
</tbody>
</table>
<p><span>å¦å¤è¿æä¸ç»å¸¸è§æåå£å¾ï¼æå¼çå¤§æ¦å  40%ï¼äºå¨çï¼èµ/å¨ç/æ¶èï¼å  30%ï¼åäº«çå  20%ï¼å®è¯»çå  10%ã</span></p>
<p><span>æéä¸¤ç¹ï¼</span></p>
<p><span>1. ååçæ¨èæéä¼æ´é«ï¼ç ç©¶å£å¾éæå°æ¯è½¬è½½ç 3 åï¼</span></p>
<p><span>2. è®¤è¯ç±»åä¹ä¼å½±åæéï¼æ¿åº &gt; åªä½ &gt; ä¼ä¸ &gt; ä¸ªä½ï¼ï¼è®¤è¯è´¦å·å¨æç´¢éæ´å®¹ææ¿å°é åæå</span></p>
<h3 data-heading="true"><span>2.3 è¿å å¹´ååæä¹åäº</span></h3>
<p><span>ç®åæé¶æ®µæä¸ä¸ï¼</span></p>
<p><span>1. 2013 å° 2017ï¼è®¢éä¸ºä¸»ï¼å³æ³¨å°±è½æ¶å°</span></p>
<p><span>2. 2017 å° 2020ï¼å¼å§å¼å¥ç¤¾äº¤æ¨èï¼çä¸çç­å¥å£åºç°</span></p>
<p><span>3. 2020 å° 2023ï¼ç®æ³æ¨èéæ­¥åå¼ºï¼å¼å§æ¨èæªå³æ³¨åå®¹</span></p>
<p><span>4. 2023 è³ä»ï¼ç¤¾äº¤ + ç®æ³åé©±å¨æ´ææ¾ï¼æåç¸å³å¥å£çæéåé«</span></p>
<h2 data-heading="true"><span>03 æµéæ± èµé©¬ï¼æç« ä¸ºå¥ä¼çªç¶ç</span></h2>
<h3 data-heading="true"><span>3.1 å·å¯å¨é£ä¸å³å¾å³é®</span></h3>
<p><span>æç« ååºå»ä¹åï¼éå¸¸ä¼åæ¿å°ä¸å°æ³¢æµè¯æåï¼æ¯å¦ 500 å° 1000 æ¬¡ï¼ï¼ç³»ç»ä¸»è¦çä¸é¡¹ï¼ç¹å»çãå®è¯»çãäºå¨çã</span></p>
<p><span>ç ç©¶éç»äºä¸äºå¸¸è§éå¼ååèï¼</span></p>
<p><span>1. å·å¯å¨æï¼0 å° 24 å°æ¶ï¼ç¹å»çè¦è½å° 8% ä»¥ä¸ï¼æ´å¯è½è¿ä¸ä¸å±</span></p>
<p><span>2. è¿å¥çåæåï¼å®è¯»çæå¥½è½ç»´æ 55% ä»¥ä¸ï¼äºå¨ç 3% ä»¥ä¸</span></p>
<h3 data-heading="true"><span>3.2 å¤è½®æ¨èä¸æ¯ä¸æ¬¡æ§ç»å®</span></h3>
<p><span>éè¿ç¬¬ä¸è½®æµè¯åï¼ä¼æäºæ¬¡ãä¸æ¬¡çè³æ´å¤è½®çæ¨èï¼æ¯ä¸è½®æåéä¼åå¤§ã</span></p>
<p><span>å¦å¤ç³»ç»ä¼æ 15 åéä¸è½®å¨æè°æ´æµéï¼æä»¥åä¸ç¯æç« çæ°æ®ä¼ä¸ç´ååãéè¯»éå° 1 ä¸è¿ä¸ªéçº§åï¼ææ¶è¿ä¼è§¦åäººå·¥å®¡æ ¸ã</span></p>
<h3 data-heading="true"><span>3.3 ç¤¾äº¤æ©æ£ä¼å¸¦æ¥æ¾å¤§</span></h3>
<p><span>å½ç¨æ·ç¹å¨çæèè½¬åï¼æç« å°±ä¼æ²¿çç¤¾äº¤ç½ç»æ©æ£ãæè´¦å·çæ°æ®éï¼æåç¸å³å¥å£è´¡ç®çéè¯»éè½å° 45.9%ã</span></p>
<p><span>æ¯è¾å®¹æè§¦ååäº«çåå ä¸è¬æ¯è¿ä¸ç±»ï¼</span></p>
<p><span>1. åå®¹æ¬èº«æç¤¾äº¤ä»·å¼ï¼å±é¸£ãå®ç¨ãè¯é¢æ§ï¼</span></p>
<p><span>2. æä¸­åæ¸æ¥åäº«å¨æºï¼æ¯å¦è½¬ç»åäºãè½¬ç»åå­¦ãè½¬ç»ç¾¤éè°ï¼</span></p>
<p><span>3. åå®¹ééåäº«åºæ¯ï¼å·¥ä½ç¾¤ãåå­¦ç¾¤ãè¡ä¸ç¾¤è½ç¨å¾ä¸ï¼</span></p>
<h3 data-heading="true"><span>3.4 å¬åå¥å£ä¹å¾éè¦</span></h3>
<p><span>è¡¨ 2ï¼å¬ä¼å·ä¸»è¦æµéæ¥æºåå¸</span></p>
<table>
<thead>
<tr><th><span>æµéæ¥æº</span></th><th><span>å æ¯</span></th><th><span>ç¹ç¹</span></th></tr>
</thead>
<tbody>
<tr>
<td><span>æ¨èæµé</span></td>
<td><span>54.5%</span></td>
<td><span>ç®æ³æ¨èä¸ºä¸»</span></td>
</tr>
<tr>
<td><span>å¬ä¼å·æ¶æ¯</span></td>
<td><span>16.52%</span></td>
<td><span>è®¢éç¨æ·</span></td>
</tr>
<tr>
<td><span>å¬ä¼å·ä¸»é¡µ</span></td>
<td><span>13.17%</span></td>
<td><span>ä¸»å¨è®¿é®</span></td>
</tr>
<tr>
<td><span>æä¸æ</span></td>
<td><span>10.44%</span></td>
<td><span>ç²¾åæç´¢</span></td>
</tr>
<tr>
<td><span>èå¤©ä¼è¯</span></td>
<td><span>2.88%</span></td>
<td><span>ç§ååäº«</span></td>
</tr>
<tr>
<td><span>æåå</span></td>
<td><span>0.96%</span></td>
<td><span>æåååäº«</span></td>
</tr>
<tr>
<td><span>æåæ¨è</span></td>
<td><span>0.12%</span></td>
<td><span>å¥½åç´æ¥æ¨è</span></td>
</tr>
</tbody>
</table>
<p><span>è¡¥åä¸¤ç¹ï¼</span></p>
<p><span>1. çä¸çæ¯å¾éè¦çå¬åå¥å£ï¼çæ¬¾éçä¸çå æ¯è½å° 60% å° 70%</span></p>
<p><span>2. æä¸æå æ¯å¤§æ¦ 10.44%ï¼æ é¢å³é®è¯åå¾å¥½ï¼æç´¢æµéå æ¯ä¹å¯è½å¾å¯è§</span></p>
<h2 data-heading="true"><span>04 ä¸åè´¦å·çå·®å¼</span></h2>
<h3 data-heading="true"><span>4.1 è®¤è¯åè´¦å·ä¿¡èª</span></h3>
<p><span>è®¤è¯ç±»åä¼å½±åæéåä¿¡ä»»ï¼æ¿åº &gt; åªä½ &gt; ä¼ä¸ &gt; ä¸ªä½ï¼ã</span></p>
<p><span>åæ¶ä¹ä¼çè¿äºï¼æ³¨åæ¶é´ãè¿è§è®°å½ãç²ä¸æ´»è·åº¦ï¼å¸¸è¯»ç¨æ·ï¼ãæ´æ°é¢çï¼åæå¤ä¸ååå æ¯é«æ´å ä¼ï¼ã</span></p>
<h3 data-heading="true"><span>4.2 æ°å·åèå·ä¸ä¸æ ·</span></h3>
<p><span>æ°å·ä¸è¬ä¼æè§å¯æï¼åææåå¯è½æ¯è¾å°ï¼å¹³å°ä¼åå¤æ­ä½ æ¯ä¸æ¯ç¨³å®çæ­£å¸¸åä½èï¼æ ç­¾æ¸ä¸æ¸æ°ï¼åå®¹åä¸åè§ã</span></p>
<p><span>èå·å ä¸ºç»åç§¯ç´¯æ´å®æ´ï¼æ¨èæ´å®¹æç²¾åï¼ä½é¿æä¸æ´»è·æèè´¨éä¸æ»ä¹å¯è½è¢«éæã</span></p>
<h3 data-heading="true"><span>4.3 åç´é¢åæ´åé¦ï¼ä½å«ä¹±è·</span></h3>
<p><span>ç§æãæè²ç­åç´é¢åå¨åç±»éå¯è½æ´å®¹ææ¿å°å¾æï¼ä½åææ¯å®ä½è¶³å¤ç»ï¼åå®¹æç»­åç´è¾åºï¼å¹¶ä¸ç¨åéãæ ç­¾ç­æ¹å¼å¼ºåè¯å«ã</span></p>
<h2 data-heading="true"><span>05 ç§æå·æä¹åæ´å®¹æèµ·é</span></h2>
<p><span>ææ´å»ºè®®æææ å½æé¨æ§ï¼èä¸æ¯å½ KPIã</span></p>
<h3 data-heading="true"><span>5.1 æ é¢åæç¹å»çé¡¶èµ·æ¥</span></h3>
<p><span>æ é¢å¯ä»¥ç¨ä¸ä¸ªæ¯è¾ç¨³çç»æï¼çç¹åºæ¯ + æ°æ®èä¹¦ + æç»ªå±é¸£ã</span></p>
<p><span>ç¤ºä¾ï¼æä½ ä»¬è´¦å·æ¹åæ¿æ¢å³å¯ï¼ï¼</span></p>
<p><span>1. ææçµèåå¿«äºï¼3 ä¸ª Windows è®¾ç½®ç«å»è§æ</span></p>
<p><span>2. å«åè¢«éé±¼äºï¼æ ¡å­/ä¼ä¸é®ç®±æå¸¸è§ç 5 ç§è¯éª</span></p>
<p><span>3. ä» 0 å° 1ï¼ç¨ 10 åéæ­å¥½ä¸ä¸ªèªå¨åæ¥è¡¨æµç¨</span></p>
<h3 data-heading="true"><span>5.2 åå®¹ç»æè¦ç§é¡¾å®è¯»</span></h3>
<p><span>ä¸ä¸ªæ¯è¾å¥½ç¨çåæ³æ¯ï¼å¼å¤´ç´æ¥ç»ç»è®ºï¼ä¸­é´ä¿æä¿¡æ¯å¯åº¦ï¼å¤§æ¦æ¯ 300 å­ä¸ä¸ªå³é®ç¹ï¼ï¼ç»å°¾ç»è¡å¨å»ºè®®ææé®ï¼å¼å¯¼è¯è®º/æ¶è/è½¬åã</span></p>
<h3 data-heading="true"><span>5.3 ååæ¯åºç</span></h3>
<p><span>ç ç©¶éæå°åååº¦å»ºè®®å¤§äº 70%ãå¦æç¨ AI åè¾å©ï¼ä¹å»ºè®®ææ¯ä¾åç¨éè¯´æ¸æ¥ï¼é¿åè¢«ç³»ç»è¯¯å¤æä½è´¨ã</span></p>
<h3 data-heading="true"><span>5.4 æå¯è½¬ååè¿æ­£æ</span></h3>
<p><span>æç«  25% / 50% / 75% çä½ç½®ï¼å¯ä»¥é¡ºæå ä¸å¥è¯ï¼åè¯è¯»èè¿æ®µéåè½¬ç»è°ã</span></p>
<p><span>æ¯å¦ï¼è¿ä»½ææ¥æ¸åè½¬ç» IT åäº/åå­¦ï¼è¿æ®µè®¾ç½®è½¬å°ç¾¤éï¼å¤§å®¶å°è¸©åã</span></p>
<h3 data-heading="true"><span>5.5 ååºå»åç 2 å°æ¶å«æµªè´¹</span></h3>
<p><span>å·å¯å¨æ°æ®å¾å³é®ï¼å»ºè®®åæåé©¬ä¸ç¨ç§å­ç¨æ·æ©æ£ä¸æ³¢ï¼ç¤¾ç¾¤ãåäºç¾¤ãåå­¦ç¾¤ï¼ï¼åæç¹å»ãå®è¯»ãäºå¨è·èµ·æ¥ã</span></p>
<h3 data-heading="true"><span>5.6 æ¯å¨å°±ç¯ 3 ä¸ªææ </span></h3>
<p><span>1. ç¤¾äº¤æ¨èæµéå æ¯ï¼ç®æ å¼å¯åè 45%ï¼</span></p>
<p><span>2. èåæ ç¹å»éï¼è½çåºäºå¨æ·±åº¦ï¼</span></p>
<p><span>3. 48 å°æ¶äºå¨çï¼è½çåºåå®¹å³æ¶å½±ååï¼</span></p>
<p><span>å¦å¤æ é¢ãå°é¢ãå¼å¤´æ®µè½é½å¯ä»¥åå°èå´ A/B æµè¯ï¼æ¾æåéçç»åã</span></p>
<h2 data-heading="true"><span>06 æ¡ä¾ç»æä»¬çæç¤º</span></h2>
<p><span>è¿éåå ä¸ªç ç©¶éçå¸åç°è±¡ï¼ä¸»è¦çè§å¾ï¼</span></p>
<p><span>1. ææç« éè¯» 48 ä¸ï¼çä¸çè´¡ç® 60%</span></p>
<p><span>2. ææ°å·ç²ä¸ä¸å¤ï¼åç¯ 10 ä¸+ï¼çä¸çè´¡ç® 98%</span></p>
<p><span>3. æçæ¯ä¼ æ­æ¡ä¾ï¼ç¬¬ 1 å¤© 500+ï¼ç¬¬ 2 å¤© 1 ä¸+ï¼ç¬¬ 3 å¤©æååå·å±</span></p>
<p><span>å±åç¹å¶å®å¾æ´ç´ ï¼å·å¯å¨è¿å³ï¼ç¤¾äº¤æ©æ£è¢«ç¹çï¼åå®¹è´¨éè½æä½å®è¯»åäºå¨ã</span></p>
<h2 data-heading="true"><span>07 é£é©ååè§å«è¸©å</span></h2>
<p><span>å¸¸è§è¯¯åºï¼</span></p>
<p><span>1. è¿½ç­ç¹ä½åå®ä½ä¸æ­ï¼å®¹æç½å¿</span></p>
<p><span>2. ä¾èµå·éï¼å¹³å°ææ ææµéææ¥ï¼é£é©å¾é«</span></p>
<p><span>3. åªè¦æåä¸è¦è´¨éï¼å®è¯»çæå¾å¾å¿«ï¼æ¨èä¹ä¼å¾å¿«å</span></p>
<p><span>åè§æ¹é¢ï¼</span></p>
<p><span>1. åååº¦å°½éåå° 70% ä»¥ä¸</span></p>
<p><span>2. æ é¢åæ­£æåææè¯æ«æï¼å°ç¨ç»å¯¹åãå¤¸å¤§åè¡¨è¿°</span></p>
<p><span>3. å¾çç´ ææ³¨æçæï¼ç¨ CC0 ç«ç¹æèåè§äºå</span></p>
<h2 data-heading="true"><span>08 æ»ç»</span></h2>
<p><span>ä¸å¥è¯æ»ç»ï¼å¬ä¼å·ç°å¨æ¯ç¤¾äº¤ä¿¡å· + ç®æ³æ¨èä¸èµ·å¨è·ï¼ç§æå·æ³èµ·éï¼æ ¸å¿è¿æ¯ä¸ä»¶äºï¼å·å¯å¨æ°æ®è¿å³ãåå®¹æ´å®¹æè¢«è½¬åãé¿æåæååååç´ã</span></p>
<p><span>å¦æä½ åªæ³ååæå°æ¹å¨ï¼å»ºè®®ä»è¿ 3 ä¸ªå¼å§ï¼</span></p>
<p><span>1. åæå 0 å° 2 å°æ¶ï¼æç¹å»çãå®è¯»çãäºå¨çåè·èµ·æ¥</span></p>
<p><span>2. ææ¸åãæ­¥éª¤ãæéæµç¨åå¾æ´å¯æªå¾è½¬åï¼é¡ºæåæ¸æ¥è½¬ç»è°</span></p>
<p><span>3. è¿ç»­åä¸ä¸ªç»åæ¹åï¼æ¯å¦æ ¡å­ç½ç»å®å¨ãç³»ç»ä½¿ç¨æåãåå¬æçï¼ï¼è®©æ ç­¾ç¨³å®ä¸æ¥</span></p>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0.0006944444444444445" data-date-updated="2026-01-09 19:40">2026-01-09 19:39</span>&nbsp;
<a href="https://www.cnblogs.com/reachteam">H5å¼åææ¯</a>&nbsp;
éè¯»(<span id="post_view_count">3</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19463233);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19463233', targetLink: 'https://www.cnblogs.com/reachteam/p/19463233', title: 'å¬ä¼å·æ¨èæºå¶æ´çï¼ç§æå·æä¹æç¤¾äº¤æµéåèµ·æ¥' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ MAFå¿«éå¥é¨ï¼11ï¼å¹¶è¡å·¥ä½æµ ]]></title>
    <link>https://www.cnblogs.com/edisontalk/p/-/quick-start-on-maf-chatper11</link>
    <guid>dc5c053d27601d259b31b8109c0577d1</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/edisontalk/p/-/quick-start-on-maf-chatper11" title="åå¸äº 2026-01-09 18:30">
    <span role="heading" aria-level="2">MAFå¿«éå¥é¨ï¼11ï¼å¹¶è¡å·¥ä½æµ</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/381412/202601/381412-20260104201029946-1112217715.png" alt="MAFå¿«éå¥é¨ï¼11ï¼å¹¶è¡å·¥ä½æµ" class="desc_img">
        å¨å®éä¸å¡åºæ¯ä¸­ï¼å¾å¾éè¦å¨å·¥ä½æµä¸­è®©å¤ä¸ªAgentåæ¶è¿è¡åéè¿èåç»æååä¸äºæ°æ®åææå³ç­åç°ï¼è¿æ¶å°±éè¦å¹¶è¡æ§è¡æºå¶ãæ¬æä»ç»äºMAFä¸­å¹¶è¡å·¥ä½æµä»¥åå¦ä½å®ç°âFan-Out/Fan-Inâçå·¥ä½æ¨¡å¼ï¼æåéè¿ä¸ä¸ªè·¨å¢çµåä»·æ ¼æ¥è¯¢æºè½å®ä»·çæ¡ä¾ä»ç»äºè¿ç§æ¨¡å¼çä»£ç å®ç°ã
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>å¤§å®¶å¥½ï¼ææ¯Edisonã</p>
<p>æè¿æä¸ç´å¨è·çå£æ°çã<a class="normal_text_link mp_article_text_link" href="https://www.cnblogs.com/sheng-jie/p/19200934" target="_blank" data-itemshowtype="0" data-linktype="2">.NET+AIæºè½ä½å¼åè¿é¶</a>ãè¯¾ç¨å­¦ä¹ MAFçå¼åæå·§ï¼æå¼ºçæ¨èä½ ä¹ä¸è½¦è·æä¸èµ·åºåï¼</p>
<p><a class="normal_text_link mp_article_text_link" href="https://www.cnblogs.com/edisontalk/p/-/quick-start-on-maf-chatper10" target="_blank" data-itemshowtype="0" data-linktype="2">ä¸ä¸ç¯</a>ï¼<span>æä»¬å­¦ä¹ äºMAFä¸­å¦ä½è¿è¡å¾ªç¯ï¼loopï¼è·¯ç±<span>ãæ¬ç¯ï¼æä»¬æ¥äºè§£ä¸å¨MAFä¸­å¦ä½å¹¶è¡æ§è¡ï¼fan-out/fan-inï¼çå·¥ä½æµã</span></span></p>
<h1><strong>1 å¹¶è¡æ§è¡æ¨¡å¼</strong></h1>
<p><span data-pm-slice="0 0 []"><span><span>å¨å®éä¸å¡åºæ¯ä¸­ï¼å¾å¾éè¦å¨å·¥ä½æµä¸­è®©å¤ä¸ªAgentåæ¶è¿è¡åéè¿èåç»æååä¸äºæ°æ®åææå³ç­åç°ï¼è¿æ¶å°±éè¦å¹¶è¡æ§è¡æºå¶<span>ã</span></span></span></span></p>
<p><span data-pm-slice="0 0 []"><span><span>å¨MAFä¸­ï¼æä»¬å¯ä»¥ä½¿ç¨ Fan-Out/Fan-In æ¨¡å¼æ¥å®ç°è¿ä¸ªç®ç<span>ï¼å¦ä¸ä»£ç çæ®µæç¤ºï¼</span></span></span></span></p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> workflow = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> WorkflowBuilder(startExecutor)
    .AddFanOutEdge(startExecutor, [amazonExecutor, ebayExecutor, shopeeExecutor])
    .AddFanInEdge([amazonExecutor, ebayExecutor, shopeeExecutor], strategyExecutor)
    .WithOutputFrom(strategyExecutor)
    .Build();</span></pre>
</div>
<p><span data-pm-slice="0 0 []"><span><span><span><span data-pm-slice="0 0 []"><span><span>å¯ä»¥çå°ï¼æä»¬éè¿MAFç AddFanOutEdge å AddFanInEdge æ¥å®ç°äºå¹¶è¡æ§è¡çç®çï¼æåéè¿ä¸ä¸ªèªå®ä¹çæ§è¡å¨æ¥åèåã</span></span></span></span></span></span></span></p>
<p><span data-pm-slice="0 0 []"><span><span><span><span data-pm-slice="0 0 []"><span><span>æ ¸å¿æ¦å¿µè¡¥åï¼</span></span></span></span></span></span></span></p>
<ul>
<li><span data-pm-slice="0 0 []"><span><span><span><span data-pm-slice="0 0 []"><span><span>Fan-Out Edge =&gt; å¹¶åæ§è¡è¾¹</span></span></span></span></span></span></span></li>
<li><span data-pm-slice="0 0 []"><span><span><span><span data-pm-slice="0 0 []"><span><span>Fan-In Edge =&gt; æ±èè¾¹</span></span></span></span></span></span></span></li>
</ul>
<h1><strong>2 å¹¶è¡å·¥ä½æµå®éªæ¡ä¾</strong></h1>
<p><span data-pm-slice="0 0 []"><span><span><span><span data-pm-slice="0 0 []"><span><span><span>åè®¾æä»¬æ¯ä¸ä¸ªè·¨å¢çµåå¢éï¼æ³è¦å®æ¶çæ§åä¸ä¸ªååå¨å¤ä¸ªçµåå¹³å°ï¼å¦äºé©¬éãeBayãShopeeç­ï¼çå®ä»·ç­ç¥ï¼å¨æ£æµå°ç«äºå¯¹æéä»·æ¶å¿«éååºååºå³ç­ã</span></span></span></span></span></span></span></span></p>
<p><span data-pm-slice="0 0 []"><span><span><span><span data-pm-slice="0 0 []"><span><span><span><span>å æ­¤ï¼æä»¬çç®æ æ¯ï¼éç½®ä¸ä¸ª&nbsp;<span>Fan-Out + Fan-In<span>&nbsp;å·¥ä½æµï¼å®ç°ä¸æ¬¡æ¥è¯¢ãå¹¶è¡æåãæºè½å³ç­çä¼ä¸çº§æ¨¡å¼ã</span></span></span></span></span></span></span></span></span></span></span></p>
<h3><strong><span><span>2.1 å³é®ä¾èµåå¼å¥</span></span></strong></h3>
<p><span data-pm-slice="0 0 []"><span><span><span><span data-pm-slice="0 0 []"><span><span><span><span><span><span><span>å¨ä»å¤©çè¿ä¸ªæ¡ä¾ä¸­ï¼æä»¬ä»ç¶åå»ºäºä¸ä¸ª.NETæ§å¶å°åºç¨ç¨åºï¼å®è£äºä»¥ä¸NuGetåï¼</span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul class="list-paddingleft-1">
<li><span>Microsoft.Agents.AI.OpenAI</span></li>
<li><span>Microsoft.Agents.AI.Workflows</span></li>
<li><span>Microsoft.Extensions.AI.OpenAI</span></li>
</ul>
<h3><span><span>2.2 å®ä¹æ°æ®ä¼ è¾æ¨¡å</span></span></h3>
<p><span><span>é¦åï¼æä»¬å®ä¹ä¸ä¸å¨è¿ä¸ªå·¥ä½æµä¸­éè¦çæä¼ éçæ°æ®æ¨¡åï¼</span></span></p>
<p><span><span>PriceQueryDto ï¼ä»·æ ¼æ¥è¯¢æ¨¡åDTO</span></span></p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">internal</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> PriceQueryDto
{
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">string</span> ProductId { <span style="color: rgba(0, 0, 255, 1)">get</span>; <span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">; }
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">string</span> ProductName { <span style="color: rgba(0, 0, 255, 1)">get</span>; <span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">; }
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">string</span> TargetRegion { <span style="color: rgba(0, 0, 255, 1)">get</span>; <span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">; }
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> PriceQueryDto(<span style="color: rgba(0, 0, 255, 1)">string</span> productId, <span style="color: rgba(0, 0, 255, 1)">string</span> productName, <span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)"> targetRegion)
    {
        ProductId </span>=<span style="color: rgba(0, 0, 0, 1)"> productId;
        ProductName </span>=<span style="color: rgba(0, 0, 0, 1)"> productName;
        TargetRegion </span>=<span style="color: rgba(0, 0, 0, 1)"> targetRegion;
    }
}</span></pre>
</div>
<h3><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;p&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;background-color: rgb(255, 255, 255);outline: 0px;visibility: visible;line-height: 1.75em;margin-top: 16px;margin-bottom: 16px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><span>2.3 å®ä¹Agents&amp;Executors</span></span></h3>
<p><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;text-transform: none;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;text-align: left;line-height: 1.75em;margin-bottom: 8px;margin-top: 8px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><strong>ï¼1ï¼ä»·æ ¼æ¥è¯¢ï¼</strong>å°è£åå¤§çµåå¹³å°çä»·æ ¼æ¥è¯¢é»è¾ï¼æ¨¡æå¶APIååºï¼ä»ä»åæ¼ç¤ºç¨æ å®éé»è¾</span>ï¼</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">internal</span> <span style="color: rgba(0, 0, 255, 1)">sealed</span> <span style="color: rgba(0, 0, 255, 1)">class</span> PlatformPriceExecutor : Executor&lt;ChatMessage&gt;<span style="color: rgba(0, 0, 0, 1)">
{
    </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">readonly</span> <span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)"> _instructions;
    </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">readonly</span><span style="color: rgba(0, 0, 0, 1)"> IChatClient _chatClient;

    </span><span style="color: rgba(0, 0, 255, 1)">public</span> PlatformPriceExecutor(<span style="color: rgba(0, 0, 255, 1)">string</span> id, IChatClient chatClient, <span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)"> platformInstructions)
        : </span><span style="color: rgba(0, 0, 255, 1)">base</span><span style="color: rgba(0, 0, 0, 1)">(id)
    {
        _chatClient </span>=<span style="color: rgba(0, 0, 0, 1)"> chatClient;
        _instructions </span>=<span style="color: rgba(0, 0, 0, 1)"> platformInstructions;
    }

    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">override</span> <span style="color: rgba(0, 0, 255, 1)">async</span> ValueTask HandleAsync(ChatMessage message, IWorkflowContext context, CancellationToken cancellationToken = <span style="color: rgba(0, 0, 255, 1)">default</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        </span><span style="color: rgba(0, 0, 255, 1)">var</span> messages = <span style="color: rgba(0, 0, 255, 1)">new</span> List&lt;ChatMessage&gt;<span style="color: rgba(0, 0, 0, 1)">
        {
            </span><span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)">(ChatRole.System, _instructions),
            message
        };

        </span><span style="color: rgba(0, 0, 255, 1)">var</span> response = <span style="color: rgba(0, 0, 255, 1)">await</span><span style="color: rgba(0, 0, 0, 1)"> _chatClient.GetResponseAsync(messages, cancellationToken: cancellationToken);
        </span><span style="color: rgba(0, 0, 255, 1)">var</span> replyMessage = <span style="color: rgba(0, 0, 255, 1)">new</span> ChatMessage(ChatRole.Assistant, response.Text ?? <span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)">.Empty)
        {
            AuthorName </span>= <span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">.Id
        };

        </span><span style="color: rgba(0, 0, 255, 1)">await</span><span style="color: rgba(0, 0, 0, 1)"> context.SendMessageAsync(replyMessage, cancellationToken: cancellationToken);
        Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">â {this.Id} å®ææ¥è¯¢</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    }
}</span></pre>
</div>
<p><strong><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;text-transform: none;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;text-align: left;line-height: 1.75em;margin-bottom: 8px;margin-top: 8px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><span>ï¼2ï¼<span>å¹¿æ­æ¥è¯¢è¯·æ±æ§è¡å¨<span>ï¼</span></span></span></span></strong><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;text-transform: none;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;text-align: left;line-height: 1.75em;margin-bottom: 8px;margin-top: 8px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]">è´è´£å¹¿æ­ä»·æ ¼æ¥è¯¢è¯·æ±å°åå¤§çµåå¹³å°å¹¶åæ¾TurnTokenã</span></p>
<p><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;text-transform: none;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;text-align: left;line-height: 1.75em;margin-bottom: 8px;margin-top: 8px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]">NOTEï¼åªæåæ¾äºTurnTokenæè½çæ­£å¼å¯æ§è¡åç»­LLMèç¹ï¼</span></p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">internal</span> <span style="color: rgba(0, 0, 255, 1)">sealed</span> <span style="color: rgba(0, 0, 255, 1)">class</span> PriceQueryStartExecutor() : Executor&lt;PriceQueryDto&gt;<span style="color: rgba(0, 0, 0, 1)">(nameof(PriceQueryStartExecutor))
{
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">override</span> <span style="color: rgba(0, 0, 255, 1)">async</span> ValueTask HandleAsync(PriceQueryDto query, IWorkflowContext context, CancellationToken cancellationToken = <span style="color: rgba(0, 0, 255, 1)">default</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        </span><span style="color: rgba(0, 0, 255, 1)">var</span> userPrompt = $<span style="color: rgba(128, 0, 0, 1)">@"</span><span style="color: rgba(128, 0, 0, 1)">ååID: {query.ProductId}
åååç§°: {query.ProductName}
ç®æ åºå: {query.TargetRegion}

è¯·æ¥è¯¢è¯¥ååå¨ä½ çå¹³å°ä¸çå½åä»·æ ¼ãåºå­ç¶æåééä¿¡æ¯ã</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;
        </span><span style="color: rgba(0, 0, 255, 1)">await</span> context.SendMessageAsync(<span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> ChatMessage(ChatRole.User, userPrompt), cancellationToken: cancellationToken);
        </span><span style="color: rgba(0, 0, 255, 1)">await</span> context.SendMessageAsync(<span style="color: rgba(0, 0, 255, 1)">new</span> TurnToken(emitEvents: <span style="color: rgba(0, 0, 255, 1)">true</span><span style="color: rgba(0, 0, 0, 1)">), cancellationToken: cancellationToken);

        Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ð¡ Fan-out ä»·æ ¼æ¥è¯¢å¹¿æ­å·²åé</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    }
}</span></pre>
</div>
<p><strong><strong><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;text-transform: none;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;text-align: left;line-height: 1.75em;margin-bottom: 8px;margin-top: 8px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><span>ï¼3ï¼<span>å®ä»·èå<span>ï¼</span></span></span></span></strong></strong><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;text-transform: none;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;text-align: left;line-height: 1.75em;margin-bottom: 8px;margin-top: 8px;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;strong&quot;,&quot;attributes&quot;:{},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]">æ¨¡ææ¶éå°ææå¹³å°çå®ä»·ä¹åæ§è¡çæ°æ®èåæä½ã</span></p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">internal</span> <span style="color: rgba(0, 0, 255, 1)">sealed</span> <span style="color: rgba(0, 0, 255, 1)">class</span> PricingStrategyExecutor : Executor&lt;ChatMessage&gt;<span style="color: rgba(0, 0, 0, 1)">
{
    </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">readonly</span> List&lt;ChatMessage&gt; _messages =<span style="color: rgba(0, 0, 0, 1)"> [];
    </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">readonly</span> <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> _targetCount;

    </span><span style="color: rgba(0, 0, 255, 1)">public</span> PricingStrategyExecutor(<span style="color: rgba(0, 0, 255, 1)">int</span> targetCount) : <span style="color: rgba(0, 0, 255, 1)">base</span><span style="color: rgba(0, 0, 0, 1)">(nameof(PricingStrategyExecutor))
    {
        _targetCount </span>=<span style="color: rgba(0, 0, 0, 1)"> targetCount;
    }

    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">override</span> <span style="color: rgba(0, 0, 255, 1)">async</span> ValueTask HandleAsync(ChatMessage message, IWorkflowContext context, CancellationToken cancellationToken = <span style="color: rgba(0, 0, 255, 1)">default</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        </span><span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">._messages.Add(message);
        Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ð å·²æ¶é {_messages.Count}/{_targetCount} ä¸ªå¹³å°æ°æ® - æ¥èª {message.AuthorName}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

        </span><span style="color: rgba(0, 0, 255, 1)">if</span> (<span style="color: rgba(0, 0, 255, 1)">this</span>._messages.Count == <span style="color: rgba(0, 0, 255, 1)">this</span><span style="color: rgba(0, 0, 0, 1)">._targetCount)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">var</span> platformData = <span style="color: rgba(0, 0, 255, 1)">string</span>.Join(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(0, 0, 255, 1)">this</span>._messages.Select(m =&gt; $<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">â¢ {m.AuthorName}: {m.Text}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));
            </span><span style="color: rgba(0, 0, 255, 1)">var</span> strategyReport = $<span style="color: rgba(128, 0, 0, 1)">@"</span><span style="color: rgba(128, 0, 0, 1)">ââââââââââââââââââââââââââââââââ
ð å¤å¹³å°ä»·æ ¼æ±æ»ï¼å± {this._messages.Count} ä¸ªå¹³å°ï¼
ââââââââââââââââââââââââââââââââ

{platformData}

ââââââââââââââââââââââââââââââââ
ð¡ æºè½å®ä»·å»ºè®®
ââââââââââââââââââââââââââââââââ
åºäºä»¥ä¸æ°æ®ï¼å»ºè®®åæç«äºå¯¹æä»·æ ¼åºé´ï¼å¶å®å·®å¼åå®ä»·ç­ç¥ã
èèå ç´ ï¼åºå­ååãééææ¬ãå¹³å°ä½£éçãç®æ å©æ¶¦çã</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;

            </span><span style="color: rgba(0, 0, 255, 1)">await</span><span style="color: rgba(0, 0, 0, 1)"> context.YieldOutputAsync(strategyReport, cancellationToken);

            Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">â¨ Fan-in å®ä»·ç­ç¥çæå®æ</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        }
    }
}</span></pre>
</div>
<h3>2.4 æå»ºå·¥ä½æµ</h3>
<p>ç°å¨ä¸äºä¿±å¤ï¼åªæ¬ ä¸ä¸ªWorkflowï¼ç°å¨Let's do it!</p>
<p>Step1: è·åChatClient</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> chatClient = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenAIClient(
        </span><span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> ApiKeyCredential(openAIProvider.ApiKey),
        </span><span style="color: rgba(0, 0, 255, 1)">new</span> OpenAIClientOptions { Endpoint = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> Uri(openAIProvider.Endpoint) })
    .GetChatClient(openAIProvider.ModelId)
    .AsIChatClient();</span></pre>
</div>
<p>Step2: å®ä¾åèªå®ä¹Agent &amp; Executors</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> amazonExecutor = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> PlatformPriceExecutor(
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">AmazonPriceAgent</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
    chatClient,
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ä½ æ¯Amazonå¹³å°ä»·æ ¼æ¥è¯¢Agentãè¿åæ ¼å¼ï¼ä»·æ ¼=$XXXï¼åºå­ç¶æ=åè¶³/ç´§å¼ ï¼ééè¯´æ=Primeä¼ååè¿è´¹/æ åééã</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
);
</span><span style="color: rgba(0, 0, 255, 1)">var</span> ebayExecutor = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> PlatformPriceExecutor(
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">eBayPriceAgent</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
    chatClient,
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ä½ æ¯eBayå¹³å°ä»·æ ¼æ¥è¯¢Agentãè¿åæ ¼å¼ï¼ä»·æ ¼=$XXXï¼ååç¶æ=å¨æ°/äºæXXæ°ï¼è¿è´¹è¯´æ=åé®/ä¹°å®¶æ¿æã</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
);
</span><span style="color: rgba(0, 0, 255, 1)">var</span> shopeeExecutor = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> PlatformPriceExecutor(
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ShopeePriceAgent</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
    chatClient,
    </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ä½ æ¯Shopeeå¹³å°ä»·æ ¼æ¥è¯¢Agentãè¿åæ ¼å¼ï¼ä»·æ ¼=$XXXï¼å«ç¨ï¼ï¼åºå=ä¸åäº/å°æ¹¾ï¼ä¿éä¿¡æ¯=æ»¡åæ´»å¨/æ ã</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
);
</span><span style="color: rgba(0, 0, 255, 1)">var</span> startExecutor = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> PriceQueryStartExecutor();
</span><span style="color: rgba(0, 0, 255, 1)">var</span> strategyExecutor = <span style="color: rgba(0, 0, 255, 1)">new</span> PricingStrategyExecutor(<span style="color: rgba(128, 0, 128, 1)">3</span>);</pre>
</div>
<p>Step3: åå»ºå¹¶è¡æ§è¡å·¥ä½æµ</p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> workflow = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> WorkflowBuilder(startExecutor)
        .AddFanOutEdge(startExecutor, [amazonExecutor, ebayExecutor, shopeeExecutor])
        .AddFanInEdge([amazonExecutor, ebayExecutor, shopeeExecutor], strategyExecutor)
        .WithOutputFrom(strategyExecutor)
        .Build();
Console.OutputEncoding </span>=<span style="color: rgba(0, 0, 0, 1)"> Encoding.UTF8;
Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">â Loop Workflow æå»ºå®æ</span><span style="color: rgba(128, 0, 0, 1)">"</span>);</pre>
</div>
<h3><span><span>2.5 æµè¯å·¥ä½æµ</span></span></h3>
<p><span><span>å®ä¹æ¥è¯¢çååæ¯IPhone15ï¼</span></span></p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> priceQuery = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> PriceQueryDto(
    productId: </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">IPHONE15-PRO-256</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
    productName: </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">iPhone 15 Pro 256GB</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,
    targetRegion: </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">US</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">
);</span></pre>
</div>
<p><span><span>éè¿Streamingæµå¼æ§è¡ï¼</span></span></p>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">await</span> <span style="color: rgba(0, 0, 255, 1)">using</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> run = <span style="color: rgba(0, 0, 255, 1)">await</span><span style="color: rgba(0, 0, 0, 1)"> InProcessExecution.StreamAsync(workflow, priceQuery))
{
    </span><span style="color: rgba(0, 0, 255, 1)">await</span> <span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> evt <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> run.WatchStreamAsync())
    {
        </span><span style="color: rgba(0, 0, 255, 1)">switch</span><span style="color: rgba(0, 0, 0, 1)"> (evt)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">case</span><span style="color: rgba(0, 0, 0, 1)"> ExecutorInvokedEvent started:
                Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ð {started.ExecutorId} å¼å§è¿è¡</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">case</span><span style="color: rgba(0, 0, 0, 1)"> ExecutorCompletedEvent completed:
                Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">â {completed.ExecutorId} ç»æè¿è¡</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">case</span><span style="color: rgba(0, 0, 0, 1)"> WorkflowOutputEvent outputEvent:
                Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">ð Fan-in æ±æ»è¾åºï¼</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">{outputEvent.Data}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">case</span><span style="color: rgba(0, 0, 0, 1)"> WorkflowErrorEvent errorEvent:
                Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">â¨ æ¶å° Workflow Error Eventï¼</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">{errorEvent.Data}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
    }
}</span></pre>
</div>
<p>æµè¯ç»æå¦ä¸å¾æç¤ºï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/381412/202601/381412-20260104200929287-1279437489.png" alt="image" loading="lazy" style="display: block; margin-left: auto; margin-right: auto"></p>
<p>å¯ä»¥çè§ï¼ç»è¿å¹¶è¡æ§è¡ä»·æ ¼æ¥è¯¢åï¼ç±èåæ§è¡å¨è¿è¡äºä»·æ ¼æ±æ»å¹¶åéç»LLMè¿è¡äºæç»çå®ä»·å»ºè®®ã</p>
<h1><strong><span>3 å°ç»</span></strong></h1>
<p>æ¬æä»ç»äºMAFä¸­å¹¶è¡å·¥ä½æµä»¥åå¦ä½å®ç°âFan-Out/Fan-In<span data-pm-slice="2 3 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;margin: 8px;text-align: left;&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><span data-pm-slice="0 0 []"><span data-pm-slice="1 1 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;letter-spacing: 0.578px;text-align: left;margin: 8px;&quot;,&quot;data-pm-slice&quot;:&quot;6 3 []&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;node&quot;,{&quot;tagName&quot;:&quot;span&quot;,&quot;attributes&quot;:{&quot;style&quot;:&quot;outline: 0px;max-width: 100%;color: rgb(34, 34, 34);font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;orphans: 2;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;background-color: rgb(255, 255, 255);text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;min-height: 1em;text-align: left;visibility: visible;font-family: system-ui, -apple-system, BlinkMacSystemFont, \&quot;Helvetica Neue\&quot;, \&quot;PingFang SC\&quot;, \&quot;Hiragino Sans GB\&quot;, \&quot;Microsoft YaHei UI\&quot;, \&quot;Microsoft YaHei\&quot;, Arial, sans-serif;font-size: 15px;letter-spacing: 0.544px;caret-color: var(--weui-BRAND);box-sizing: border-box !important;overflow-wrap: break-word !important;&quot;,&quot;data-pm-slice&quot;:&quot;0 0 []&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]">âçå·¥ä½æ¨¡å¼ï¼æåéè¿ä¸ä¸ªè·¨å¢çµåä»·æ ¼æ¥è¯¢æºè½å®ä»·çæ¡ä¾ä»ç»äºè¿ç§æ¨¡å¼çä»£ç å®ç°ã</span></span></span></p>
<p>ä¸ä¸ç¯ï¼æä»¬å°ç»§ç»­å­¦ä¹ MAFä¸­å·¥ä½æµçå¤éè·¯ç±å·¥ä½æµã</p>
<h1>ç¤ºä¾æºç </h1>
<p>GitHub:&nbsp;<a href="https://github.com/EdisonTalk/MAFD" target="_blank" rel="noopener nofollow">https://github.com/EdisonTalk/MAFD</a></p>
<h1>åèèµæ</h1>
<p><span data-pm-slice="0 0 []"><span>å£æ°ï¼ã<a href="https://www.cnblogs.com/sheng-jie/p/19200934" target="_blank">.NET + AI æºè½ä½å¼åè¿é¶</a>ãï¼æ¨èææ°ï¼âââââï¼</span></span></p>
<p><span data-pm-slice="0 0 []"><span>Microsoft Learnï¼<span>ã<a href="https://learn.microsoft.com/en-us/agent-framework/overview/agent-framework-overview?wt.mc_id=MVP_397012" target="_blank" rel="noopener nofollow">Agent Framework Tutorials</a>ã</span></span></span></p>
<div><span data-pm-slice="0 0 []"><span>&nbsp;</span></span></div>
<p style="text-align: center"><img src="https://images.cnblogs.com/cnblogs_com/edisonchou/1647700/o_200902144330EdisonTalk-Footer.jpg" alt="" style="width: 65%; border: 1px solid rgba(221, 221, 221, 1); border-radius: 3px; box-shadow: 0 4px 8px rgba(3, 27, 78, 0.12)"></p>
<div id="Copyright">
<p>ä½èï¼<span style="text-decoration: underline">ç±è¿ªç</span></p>
<p>åºå¤ï¼<a title="from" href="https://edisontalk.cnblogs.com" target="_blank">https://edisontalk.cnblogs.com</a></p>
<p>æ¬æçæå½ä½èååå®¢å­å±æï¼æ¬¢è¿è½¬è½½ï¼ä½æªç»ä½èåæå¿é¡»ä¿çæ­¤æ®µå£°æï¼ä¸å¨æç« é¡µé¢ææ¾ä½ç½®ç»åºåæé¾æ¥ã</p>
</div>
</div>
<div id="MySignature" role="contentinfo">
    <div align="center"><a href="https://weibo.com/u/2068032061?s=6uyXnP" target="_blank"><img border="0" src="http://service.t.sina.com.cn/widget/qmd/2068032061/d643d182/10.png"></a></div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-09 18:30">2026-01-09 18:30</span>&nbsp;
<a href="https://www.cnblogs.com/edisontalk">EdisonZhou</a>&nbsp;
éè¯»(<span id="post_view_count">9</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19439665);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19439665', targetLink: 'https://www.cnblogs.com/edisontalk/p/-/quick-start-on-maf-chatper11', title: 'MAFå¿«éå¥é¨ï¼11ï¼å¹¶è¡å·¥ä½æµ' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ EF Coreèªå®ä¹æ å°PostgreSQLåçå½æ° ]]></title>
    <link>https://www.cnblogs.com/netry/p/19452236/efcore_jsonb_extract_path_text_in_postgredb</link>
    <guid>0f0f5f3ad285c1f7ad2ec78b32c0d8ea</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/netry/p/19452236/efcore_jsonb_extract_path_text_in_postgredb" title="åå¸äº 2026-01-09 15:09">
    <span role="heading" aria-level="2">EF Coreèªå®ä¹æ å°PostgreSQLåçå½æ°</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="èæ¯">èæ¯</h1>
<p>å¨ ASP.NET Core åºç¨å¼åä¸­ï¼ä½¿ç¨ PostgreSQLç<code>jsonb</code>ç±»åå­å¨å¤è¯­è¨æ°æ®æ¯ä¸ç§å¸¸è§çæ¹æ¡ãè¿ç§æ¹å¼ç¸æ¯ä¼ ç»çå¤åå­å¨æç¬ç«ç¿»è¯è¡¨ï¼å¨æ¨¡å¼å®ä¹ä¸æ´å çµæ´»ã</p>
<p>ä¾å¦ï¼å¯¹äºä¸ä¸ªåå«å¤è¯­è¨ç®ä»çâèºæ¯å®¶âå®ä½ï¼æä»¬éå¸¸å¦ä¸å®ä¹ï¼</p>
<pre class="language-cs" data-lines-highlight="[6,7]"><code class="language-cs" data-lines-highlight="[6,7]">public class ArtistEntity 
{
    public int Id { get; set; }

    // ä½¿ç¨ jsonb å­å¨å¤è¯­è¨å­å¸ï¼Key=è¯­è¨ä»£ç (en, zh-CN), Value=åå®¹
    [Column(TypeName = "jsonb")] 
    public Dictionary&lt;string, string&gt; Biography { get; set; } = [];
}</code></pre><h1 id="æ§è½èé">æ§è½èé</h1>
<p>è½ç¶å­å¨æ¹ä¾¿ï¼ä½å¨è¯»åæ¶ä¼é¢ä¸´æµéåæ§è½é®é¢ãå¨å¤§å¤æ°ä¸å¡åºæ¯ä¸­ï¼åç«¯ä»éè¦å±ç¤ºå½åç¨æ·è¯­è¨ï¼å¦è±è¯­ï¼çåå®¹ãå¦æç´æ¥æ¥è¯¢å®ä½ï¼EF Coreä¼å°åå«ææè¯­è¨çJSONBå¯¹è±¡å®æ´å è½½å°åå­ä¸­ãå¯¹äºåå«å åç§è¯­è¨çé¿ææ¬å­æ®µï¼è¿ä¸ä»æµªè´¹æ°æ®åº I/Oï¼ä¹å¢å äºç½ç»ä¼ è¾å¼éã</p>
<p>å°è¯ä½¿ç¨EF Coreçå­å¸ç´¢å¼å¨è¯­æ³ï¼</p>
<pre class="language-cs" data-lines-highlight="[2]"><code class="language-cs" data-lines-highlight="[2]">// ææçæç SQL æ¯ç´æ¥åå¼
var bio = context.Artists.Select(x =&gt; x.Biography["en"]).FirstOrDefault();</code></pre><p>æ ¹æ® <a href="https://www.npgsql.org/efcore/mapping/json.html?tabs=data-annotations%2Ccomplex-types%2Cjsondocument" title="Npgsql EF Core Provider" target="_blank" rel="noopener nofollow">Npgsql EF Core Provider</a> ææ¡£ï¼è½ç¶ Provider æä¾äºå¦<code>EF.Functions.JsonContains</code>ã<code>EF.Functions.JsonExists</code>ç­ä¸°å¯ç JSONB æä½å½æ°ï¼ä½å¨å¤ç Dictionary ç´¢å¼å¨çæå½±ç¿»è¯æ¶ä»å­å¨å±éæ§ãå¨æäºå¤æç Select æå½±ä¸­ï¼å®å¯è½æ æ³çææä¼ç<code> -&gt;&gt;</code> æä½ç¬¦ï¼æèå¯¼è´æ¥è¯¢å¨å®¢æ·ç«¯æ±å¼ã</p>
<p>ç®åNpgsqlç<code>EF.Functions</code>ä¸­å¹¶æ²¡æç´æ¥å¯¹åº<code>jsonb_extract_path_text</code>çæ¹æ³ï¼èè¿ä¸ªåçå½æ°æ°æ°æ¯è§£å³æ­¤ç±»éæ±æç´æ¥çæ¹å¼ãå®è½å¨æ°æ®åºæå¡ç«¯å®æè§£æï¼ä»è¿åæå®è·¯å¾çææ¬å¼ã</p>
<h1 id="ä»ä¹æ¯-jsonb_extract_path_text">ä»ä¹æ¯ jsonb_extract_path_textï¼</h1>
<p><code>jsonb_extract_path_text</code>æ¯PostgreSQLçåçå½æ°ï¼ç­åäºæä½ç¬¦ <code>#&gt;&gt;</code>ï¼ï¼ä¸é¨ç¨äºä» JSON æ°æ®ä¸­æ ¹æ®è·¯å¾æåææ¬ã</p>
<p>ç¸æ¯äºç´æ¥è¿å JSON å¯¹è±¡ï¼å®è½ç´æ¥è¿åçº¯ææ¬ï¼text ç±»åï¼ï¼éå¸¸éåæåå¤è¯­è¨å­å¸ä¸­çåä¸è¯­è¨å¼ã<br>
åè®¾æ°æ®åºéç <code>Biography</code> å­æ®µå­å¨å¦ä¸ JSONï¼</p>
<pre><code>{
  "en": "Hello World",
  "zh-CN": "ä½ å¥½ä¸ç",
  "fr": "Bonjour le monde"
}
</code></pre>
<p>å¦ææä»¬åªæ³è·åä¸­æç®ä»ï¼</p>
<pre><code>-- ä½¿ç¨å½æ°æå 'zh-CN' é®çå¼
SELECT jsonb_extract_path_text("Biography", 'zh-CN') 
FROM "Artists";

-- ç»æä»è¿åå­ç¬¦ä¸²ï¼ "ä½ å¥½ä¸ç"
</code></pre>
<p>è¿ç§å¤çæ¹å¼å®å¨å¨æ°æ®åºç«¯å®æï¼ä¼ è¾å°åºç¨å±çåªæè¿4ä¸ªå­ç¬¦ï¼èä¸æ¯åå«è±æåæ³æçå®æ´JSON å¯¹è±¡ã</p>
<h1 id="è§£å³æ¹æ¡æ å°èªå®ä¹å½æ°">è§£å³æ¹æ¡ï¼æ å°èªå®ä¹å½æ°</h1>
<p>ä¸ºäºå¨EF Coreä¸­ä½¿ç¨<code>jsonb_extract_path_text</code>ï¼æä»¬å¯ä»¥éè¿èªå®ä¹å½æ°æ å°æ¥å®ç°ã</p>
<h3 id="ä»ä¹æ¯-ef-coreèªå®ä¹å½æ°">ä»ä¹æ¯ EF Coreèªå®ä¹å½æ°ï¼</h3>
<p>EF Core çèªå®ä¹å½æ°æ å°ï¼User-defined function mappingï¼åè®¸å¼åè C#æ¹æ³ç´æ¥æ å°å°æ°æ®åºä¸­ç SQL å½æ°ãå¨ LINQ æ¥è¯¢ä¸­ä½¿ç¨è¿äºè¢«æ å°ç C# æ¹æ³æ¶ï¼EF Coreä¸ä¼å¨å®¢æ·ç«¯æ§è¡å®ä»¬ï¼èæ¯å°å®ä»¬âç¿»è¯âæå¯¹åºç SQL çæ®µåéç»æ°æ®åºæ§è¡ãè¿å°±åæ¯ç»äºä½ ä¸æé¥åï¼è®©ä½ è½å¤ä» C# ä»£ç ä¸­ç´æ¥è°ç¨æ°æ®åºç¹æçãå¼ºå¤§çåçè½åï¼å¦ PostgreSQL ç JSON å¤çãGIS å°çä¿¡æ¯è®¡ç®ç­ï¼ï¼èæ éç¼ååçç SQL å­ç¬¦ä¸²ã</p>
<h3 id="1-å®ä¹å½æ°å­æ ¹">1. å®ä¹å½æ°å­æ ¹</h3>
<p>å¨ C# ä¸­å®ä¹ä¸ä¸ªéææ¹æ³ä½ä¸ºå­æ ¹ï¼Stubï¼ï¼ç¨äºåè¯ EF Core å³ä½¿ç¿»è¯ SQLã</p>
<pre class="language-cs" data-lines-highlight="[4,5,6,7]"><code class="language-cs" data-lines-highlight="[4,5,6,7]">public static class DbFunctionsExtensions
{
    // æ­¤æ¹æ³ä»ç¨äº EF Core æ¥è¯¢æ å°ï¼å®¢æ·ç«¯è°ç¨æ¶æåºå¼å¸¸
    public static string JsonExtractPathText(this Dictionary&lt;string, string&gt; json, string key)
    {
        throw new NotSupportedException("æ­¤æ¹æ³ä»ç¨äº EF Core æ¥è¯¢æ å°ï¼ä¸å¯å¨å®¢æ·ç«¯æ§è¡ã");
    }
}</code></pre><h3 id="2-éç½®æ¨¡åæ å°">2. éç½®æ¨¡åæ å°</h3>
<p>å¨ <code>OnModelCreating</code> ä¸­éè¿ Fluent API è¿è¡æ å°å³ç³»éç½®,  <code>HasDbFunction</code> å°å¶æ å°å°æ°æ®åºå½æ° <code>jsonb_extract_path_text</code>ã</p>
<pre class="language-cs" data-lines-highlight="[3,4,5,6,7]"><code class="language-cs" data-lines-highlight="[3,4,5,6,7]">protected override void OnModelCreating(ModelBuilder modelBuilder)
{
    modelBuilder.HasDbFunction(typeof(DbFunctionsExtensions)
            .GetMethod(nameof(DbFunctionsExtensions.JsonExtractPathText),
                [typeof(Dictionary&lt;string, string&gt;), typeof(string)])!)
        .HasName("jsonb_extract_path_text")
        .IsBuiltIn();
}</code></pre><p>æèï¼ä¹å¯ä»¥ä½¿ç¨ <code>[DbFunction] </code>ç¹æ§ç´æ¥éç½®æ å°å³ç³»ï¼è¿æ ·ä»£ç æ´å ç´§åã</p>
<pre class="language-cs" data-lines-highlight="[1,6]"><code class="language-cs" data-lines-highlight="[1,6]">using Microsoft.EntityFrameworkCore;

public static class DbFunctionsExtensions
{
    // æ å°å° PostgreSQL çåç½®å½æ° jsonb_extract_path_text
    [DbFunction("jsonb_extract_path_text", IsBuiltIn = true)]
    public static string JsonExtractPathText(this Dictionary&lt;string, string&gt; json, string key)
    {
       throw new NotSupportedException("æ­¤æ¹æ³ä»ç¨äº EF Core æ¥è¯¢æ å°ï¼ä¸å¯å¨å®¢æ·ç«¯æ§è¡ã");
    }
}</code></pre><h3 id="3-ä½¿ç¨ç¤ºä¾">3. ä½¿ç¨ç¤ºä¾</h3>
<p>éç½®å®æåï¼å¯ä»¥å¨ LINQ æ¥è¯¢ä¸­ç´æ¥è°ç¨è¯¥æ©å±æ¹æ³ï¼</p>
<pre class="language-cs" data-lines-highlight="[6]"><code class="language-cs" data-lines-highlight="[6]">var query = db.Artists
    .Select(entity =&gt; new 
    {
        Id = entity.Id,
        // æ°æ®åºä»è¿åå½åè¯­è¨çææ¬
        Bio = entity.Biography.JsonExtractPathText(CultureInfo.CurrentUICulture.Name)
    });</code></pre><p>çæç SQL å°è°ç¨åç<code>jsonb_extract_path_text</code>å½æ°ï¼é¿åäºå¨éä¼ è¾ JSON æ°æ®ã<br>
<img src="https://img2024.cnblogs.com/blog/1181943/202601/1181943-20260107143638710-1533499015.png" alt="image" loading="lazy"></p>
<h2 id="ç´¢å¼ä¼åç­ç¥">ç´¢å¼ä¼åç­ç¥</h2>
<p>éå¯¹ JSONB å­æ®µçæ¥è¯¢ä¼åï¼éè¦æ ¹æ®å·ä½éæ±éæ©åéçç´¢å¼ç±»åã</p>
<ol>
<li>GIN ç´¢å¼ï¼éç¨äºâåå«âç±»æ¥è¯¢ï¼å¦ Biography æ¯å¦åå« en é®ï¼ã</li>
</ol>
<pre><code>builder.Entity&lt;ArtistEntity&gt;()
    .HasIndex(x =&gt; x.Biography)
    .HasMethod("gin");
</code></pre>
<ol start="2">
<li>å½æ°ç´¢å¼ (B-Tree)ï¼å¦æä¸å¡ä¸­å­å¨å¤§éåºäºç¹å®è¯­è¨ï¼å¦è±æåç§°ï¼çç²¾ç¡®æ¥æ¾ææåºéæ±ï¼GIN ç´¢å¼æçè¾ä½ãæ­¤æ¶åºéå¯¹ç­ç¹è¯­è¨åå»ºå½æ°ç´¢å¼ï¼</li>
</ol>
<pre><code>-- éå¯¹è±è¯­åå®¹å»ºç« B-Tree ç´¢å¼
CREATE INDEX idx_artist_bio_en ON "Artists" (( "Biography" -&gt;&gt; 'en' ));
</code></pre>
<h2 id="éç¨åºæ¯ä¸å±éæ§">éç¨åºæ¯ä¸å±éæ§</h2>
<p>è½ç¶éè¿ <code>jsonb_extract_path_text</code> å¯ä»¥åå°ç½ç»ä¼ è¾ï¼ä½è¿å¹¶ä¸æ¯ææåºæ¯ä¸çä¸è½è§£ã</p>
<ul>
<li>
<p>é«å¹¶åè¯»åï¼å³ä¾¿åå°äºä¼ è¾éï¼è§£æ JSONB å¨æ°æ®åºå±é¢ä¾ç¶æ CPU å¼éãå¦æé¢ä¸´æé«å¹¶åçè¯»åè¯·æ±ï¼å¦é¦é¡µç­é¨åè¡¨ï¼ï¼é¢ç¹è®©æ°æ®åºè§£æ JSON å¹¶ä¸æ¯æä¼è§£ãå¨è¿ç§æåµä¸ï¼åºå½å¼å¥åºç¨å±ç¼å­ï¼å¦ Redisï¼æä½¿ç¨ä¸é¨çæç´¢å¼æï¼å¦ Elasticsearchï¼ã</p>
</li>
<li>
<p>æ°æ®ç»æå¤æåº¦ï¼æ­¤æ¹æ³æéåæå¹³ç Key-Value ç»æãå¦æ JSON ç»æéå¸¸å¤æä¸åµå¥æ·±ï¼ç»´æ¤è·¯å¾æ å°ä¼åå¾å°é¾ã</p>
</li>
<li>
<p>æ°æ®åºè´è½½ï¼å°æ°æ®å¤çé»è¾ä¸æ¨å°æ°æ®åºè½ç¶æ¹ä¾¿ï¼ä½ä¼å¢å æ°æ®åº CPU è´è½½ãå¨æ°æ®åºèµæºå·²æ¯ç¶é¢çç³»ç»ä¸­ï¼éè°¨æä½¿ç¨ã</p>
</li>
</ul>
<p>éè¿è¿ç§æ¹å¼ï¼æä»¬å¨ä¿æå¼åä¾¿å©æ§çåæ¶ï¼éè¿å©ç¨æ°æ®åºåçè½åï¼è§£å³äºä¸ä¸ªå·ä½çæ§è½é®é¢ãå¼åèåºæ ¹æ®å®éçæ°æ®éçº§åè®¿é®æ¨¡å¼ï¼å³å®æ¯éç¨æ­¤ç´è¿æ¹æ¡è¿æ¯å¼å¥æ´å¤æçç¼å­æ¶æã</p>
<h1 id="åèé¾æ¥">åèé¾æ¥</h1>
<ul>
<li><a href="https://learn.microsoft.com/en-us/ef/core/querying/user-defined-function-mapping" target="_blank" rel="noopener nofollow">https://learn.microsoft.com/en-us/ef/core/querying/user-defined-function-mapping</a></li>
<li><a href="https://github.com/npgsql/efcore.pg/issues/2703" target="_blank" rel="noopener nofollow">https://github.com/npgsql/efcore.pg/issues/2703</a></li>
</ul>

</div>
<div id="MySignature" role="contentinfo">
    

  
  <div id="MySignature1" style=" color:0; font-size: small">
            <p>
          ä½èï¼ 
          <a href="https://www.cnblogs.com/netry/"></a><a href="https://www.cnblogs.com/netry/" target="_blank">é©¬è¡ç©ºçåå®¢</a>
      </p>
      <p>
          åºå¤ï¼
          <a href="https://www.cnblogs.com/netry/p/19452236/efcore_jsonb_extract_path_text_in_postgredb" target="_blank">https://www.cnblogs.com/netry/p/19452236/efcore_jsonb_extract_path_text_in_postgredb</a>
      </p>
       
 
      <p>
          æ¬æçæå½ä½èååå®¢å­å±æï¼æ¬¢è¿è½¬è½½ï¼ä½æªç»ä½èåæå¿é¡»ä¿çæ­¤æ®µå£°æï¼ä¸å¨æç« é¡µé¢ææ¾ä½ç½®ç»åºåæé¾æ¥ã
      </p>
  </div>


</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-09 15:09">2026-01-09 15:09</span>&nbsp;
<a href="https://www.cnblogs.com/netry">é©¬è¡ç©ºçåå®¢</a>&nbsp;
éè¯»(<span id="post_view_count">75</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19452236);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19452236', targetLink: 'https://www.cnblogs.com/netry/p/19452236/efcore_jsonb_extract_path_text_in_postgredb', title: 'EF Coreèªå®ä¹æ å°PostgreSQLåçå½æ°' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ 51åçæº_æé®æ£æµ ]]></title>
    <link>https://www.cnblogs.com/WIRO/p/19461450</link>
    <guid>479696b768c0514a29c64ab9998813e7</guid>
    <description>
    <![CDATA[ 
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/WIRO/p/19461450" title="åå¸äº 2026-01-09 14:49">
    <span role="heading" aria-level="2">51åçæº_æé®æ£æµ</span>
    

</a>

		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<h1 id="51åçæº_æé®æ£æµ">51åçæº_æé®æ£æµ</h1>
<h2 id="ä¸ç¬ç«æé®ä»ç»">ä¸ãç¬ç«æé®ä»ç»</h2>
<p>è½»è§¦æé®ç¸å½äºæ¯ä¸ç§çµå­å¼å³</p>
<p>æä¸æ¶å¼å³æ¥éï¼æ¾å¼æ¶å¼å³æ­å¼ï¼å®ç°åçæ¯éè¿è½»è§¦æé®åé¨çéå±å¼¹çååå¼¹å¨æ¥å®ç°æ¥éåæ­å¼</p>
<p><img src="https://img2024.cnblogs.com/blog/3732387/202601/3732387-20260109144754276-1163410502.png" alt="image-20260109110408710" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3732387/202601/3732387-20260109144754526-1860924412.png" alt="image-20260109110503289" loading="lazy"></p>
<p>ç±äºæºæ¢°ç¹çå¼¹æ§ä½ç¨ï¼æé®å¼å³å¨é­åæ¶ä¸ä¼é©¬ä¸ç¨³å®çæ¥éï¼å¨æ­å¼æ¶ä¹ä¸ä¼ä¸ä¸å­æ­å¼ãå èå¨é­ååæ­å¼çç¬é´åä¼´éçä¸è¿ä¸²çæå¨ãæå¨æ¶é´çé¿ç­ç±æé®çæºæ¢°ç¹æ§å³å®ï¼ä¸è¬ä¸º5mså°10msã</p>
<p>æé®ç¨³å®é­åæ¶é´çé¿ç­ç±æä½äººåçæé®å¨ä½å³å®ï¼ä¸è¬ä¸ºé¶ç¹å ç§è³æ°ç§ãæé®æå¨ä¼å¼èµ·æé®è¢«è¯¯è¯»å¤æ¬¡ãä¸ºäºç¡®ä¿CPUå¯¹æé®çä¾æ¬¡é­åä»ä½ä¸æ¬¡å¤çï¼å¿é¡»åæ¶è¿è¡æ¶æã</p>
<p>æé®æ¶ææä¸¤ç§æ¹å¼ï¼ä¸ç§æ¯ç¡¬ä»¶æ¶æï¼å¦ä¸ç§æ¯è½¯ä»¶æ¶æãä¸ºäºä½¿çµè·¯æ´å ç®åï¼éå¸¸éç¨è½¯ä»¶æ¶æã</p>
<p>è½¯ä»¶æ¶æä¸è¬æ¥è¯´ä¸ä¸ªç®åçæé®æ¶æå°±æ¯åè¯»åæé®çç¶æï¼å¦æå¾å°æé®æä¸ä¹åï¼å»¶æ¶10msï¼åæ¬¡è¯»åæé®ç¶æï¼å¦ææé®è¿æ¯æä¸ç¶æï¼é£ä¹è¯´ææé®å·²ç»æä¸ãå¶ä¸­çå»¶æ¶10mså°±æ¯è½¯ä»¶æ¶æå¤çã</p>
<p>å¸¸ç¨çè½¯ä»¶å»æå¨æ¹æ³ï¼</p>
<ol>
<li>åè®¾ç½®IOå£ä¸ºé«çµå¹³ï¼ç±äºå¼åæ¿IOæä¸æçµé»ï¼é»è®¤IOä¸ºé«çµå¹³ï¼</li>
<li>è¯»åIOå£çµå¹³ç¡®è®¤æ¯å¦ææé®æä¸ï¼</li>
<li>å¦ææIOçµå¹³ä¸ºä½çµå¹³åï¼å»¶æ¶å ä¸ªæ¯«ç§ï¼</li>
<li>åè¯»åè¯¥IOçµå¹³ï¼å¦æä»ä¸ºä½çµå¹³ï¼è¯´ææé®æä¸ï¼</li>
<li>æ§è¡ç¸åºæé®çç¨åºï¼</li>
</ol>
<h2 id="äºç¬ç«æé®æ£æµåç">äºãç¬ç«æé®æ£æµåç</h2>
<p>ç¬ç«æé®çµè·¯æææ¯ç±åä¸ªæé®çä¸ä¸ªç®¡èè¿æ¥å¨ä¸èµ·æ¥å°ï¼æé®å¶å®å¼èåå«æ¥å°åçæºIOå£ã</p>
<p>åçæºçIOå£æ¢å¯ä½ä¸ºè¾åºä¹å¯ä½ä¸ºè¾å¥ä½¿ç¨ï¼å½æ£æµæé®æ¶ç¨çæ¯å®çè¾å¥åè½ï¼ç¬ç«æé®çä¸ç«¯æ¥å°ï¼å¦ä¸ç«¯ä¸åçæºçæä¸ªIOå£ç¸è¿ï¼å¼å§æ¶åç»IOå£èµä¸é«çµå¹³ï¼ç¶åè®©åçæºä¸æ­æ£æµè¯¥IOå£æ¯å¦åä¸ºä½çµå¹³ï¼å½æé®é­åæ¶ï¼ç¸å½äºè¯¥IOå£éè¿æé®ä¸å°ç¸è¿ï¼åæä½çµå¹³ï¼ç¨åºä¸æ¦æ£æµå°IOå£åä¸ºä½çµå¹³åè¯´ææé®è¢«æä¸ï¼ç¶åæ§è¡ç¸åºçæä»¤ã</p>
<p><img src="https://img2024.cnblogs.com/blog/3732387/202601/3732387-20260109144754146-1606670533.png" alt="image-20260109110908433" loading="lazy"></p>
<h2 id="ä¸ç¬ç«æé®åºç¨å®è·µ">ä¸ãç¬ç«æé®åºç¨å®è·µ</h2>
<h3 id="1å®ç°æé®æ§å¶ledåè½">1ï¼å®ç°æé®æ§å¶LEDåè½</h3>
<pre><code class="language-c">#include &lt;REGX52.H&gt;
#include "Delay.h"

/**
 * ä¸»å½æ°
 */
void main()
{
	while(1)
	{
		if(P3_1 == 0)  			  // å¦æK1æé®æä¸ï¼åä¸ºä½çµå¹³
		{
			Delay(20);			  // å»¶æ¶æ¶æ
			while(P3_1 == 0);	  // æ¾ææ£æµ
			Delay(20);			  // å»¶æ¶æ¶æ
		
			P2_0 = ~P2_0;		  // LED1 åå
		}
	}
}
</code></pre>
<p>è¿æ®µä»£ç ä¾æ§å­å¨ä¸çµæçæåµï¼ä¸é¢æ¯æ¹è¿ï¼</p>
<pre><code class="language-c">#include &lt;REGX52.H&gt;
#include "Delay.h"

void main()
{
    while(1)
    {
        if(P3_1 == 0)              // æ£æµæé®æ¯å¦æä¸
        {
            Delay(10);             // å»¶æ¶æ¶æ
            if(P3_1 == 0)          // åæ¬¡ç¡®è®¤æé®ç¡®å®æä¸
            {
                P2_0 = ~P2_0;      // æ§è¡LEDåå
                
                // ç­å¾æé®éæ¾ï¼é¿åè¿æ
                while(P3_1 == 0);  // ç­å¾æé®æ¾å¼
            }
        }
    }
}
</code></pre>
<h3 id="2æé®æ§å¶ledç¯äºè¿å¶æ¾ç¤º">2ï¼æé®æ§å¶LEDç¯äºè¿å¶æ¾ç¤º</h3>
<pre><code class="language-c">#include &lt;REGX52.H&gt;
#include "Delay.h"

void main()
{
	unsigned char LEDNum=0;
	while(1)
	{
		if(P3_1==0)					//å¦æK1æé®æä¸
		{
			Delay(10);				//å»¶æ¶æ¶æ
			if(P3_1==0)
			{
			  LEDNum++;				//åéèªå¢
			  P2=~LEDNum;			//åéååè¾åºç»LED
				while(P3_1==0);	    //æ¾ææ£æµ
			}
		}
	}
}

//  å®ç°åçï¼
//  +000  LEDNum 0000 0000  	åå â&gt;  1111 1111
//  +001  LEDNum 0000 0001  	åå â&gt;  1111 1110
//  +002  LEDNum 0000 0010  	åå â&gt;  1111 1101
//  +003  LEDNum 0000 0011  	åå â&gt;  1111 1100
//  Â·Â·Â·
//  +255  LEDNum 1111 1111  	åå â&gt;  0000 0000
//  +256  æº¢åº -&gt; LEDNum 0000 0000  éæ°å¼å§è®¡æ°
</code></pre>
<h3 id="3æé®å®ç°ledå·¦å³ç§»å¨">3ï¼æé®å®ç°LEDå·¦å³ç§»å¨</h3>
<pre><code class="language-c">#include &lt;REGX52.H&gt;
#include "Delay.h"

unsigned char LEDNum;

void main()
{
	P2=~0x01;					//ä¸çµé»è®¤LED1ç¹äº® 0000 0001 åå -&gt; 1111 1110
	while(1)
	{
		if(P3_0==0)			    //å¦æK1æé®æä¸ï¼å³ç§»
		{ 
			Delay(20);
			while(P3_0==0);
			Delay(20);
			
			LEDNum++;			 //LEDNumèªå¢
			if(LEDNum&gt;=8)		 //éå¶LEDNumèªå¢èå´
				LEDNum=0;
			P2=~(0x01&lt;&lt;LEDNum);	 //LEDçç¬¬LEDNumä½ç¹äº®
		}
		if(P3_1==0)				 //å¦æK2æé®æä¸ï¼å·¦ç§»
		{
			Delay(20);
			while(P3_1==0);
			Delay(20);
			
			if(LEDNum==0)		 //LEDNumåå°0ååä¸º7
				LEDNum=7;
			else				 //LEDNumæªåå°0ï¼èªå
				LEDNum--;
			P2=~(0x01&lt;&lt;LEDNum);  //LEDçç¬¬LEDNumä½ç¹äº®
		}
	}
}
</code></pre>
<p><code>P2=~(0x01&lt;&lt;LEDNum);</code>  å®ç°åçå¦ä¸ï¼</p>
<table>
<thead>
<tr>
<th>LEDNum</th>
<th>0x01 &lt;&lt; LEDNum (äºè¿å¶)</th>
<th>ååå (äºè¿å¶)</th>
<th>ææè¯´æ</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td><code>0000 0001</code></td>
<td><code>1111 1110</code></td>
<td>LED0äº®ï¼å¶ä»ç­</td>
</tr>
<tr>
<td>1</td>
<td><code>0000 0010</code></td>
<td><code>1111 1101</code></td>
<td>LED1äº®ï¼å¶ä»ç­</td>
</tr>
<tr>
<td>2</td>
<td><code>0000 0100</code></td>
<td><code>1111 1011</code></td>
<td>LED2äº®ï¼å¶ä»ç­</td>
</tr>
<tr>
<td>3</td>
<td><code>0000 1000</code></td>
<td><code>1111 0111</code></td>
<td>LED3äº®ï¼å¶ä»ç­</td>
</tr>
<tr>
<td>4</td>
<td><code>0001 0000</code></td>
<td><code>1110 1111</code></td>
<td>LED4äº®ï¼å¶ä»ç­</td>
</tr>
<tr>
<td>5</td>
<td><code>0010 0000</code></td>
<td><code>1101 1111</code></td>
<td>LED5äº®ï¼å¶ä»ç­</td>
</tr>
<tr>
<td>6</td>
<td><code>0100 0000</code></td>
<td><code>1011 1111</code></td>
<td>LED6äº®ï¼å¶ä»ç­</td>
</tr>
<tr>
<td>7</td>
<td><code>1000 0000</code></td>
<td><code>0111 1111</code></td>
<td>LED7äº®ï¼å¶ä»ç­</td>
</tr>
</tbody>
</table>
<h2 id="åç©éµæé®">åãç©éµæé®</h2>
<p>ç¬ç«é®çä¸åçæºè¿æ¥æ¶ï¼æ¯ä¸ä¸ªæé®é½éè¦åçæºçä¸ä¸ªI/Oå£ãè¥æåçæºç³»ç»éè¦è¾å¤æé®ï¼å¦æç¨ç¬ç«æé®ä¾¿ä¼å ç¨è¿å¤çI/Oå£èµæºã</p>
<p>å½ç¨å°å¤ä¸ªæé®æ¶ï¼ä¸ºäºåå°I/Oå£å¼èï¼å¼å¥äºç©éµæé®ãæ¯å¦4*4ç©éµé®çã</p>
<p>å¯¹äº4*4ç©éµé®çï¼å¼åæ¿ä¸éå¸¸å°16ä¸ªæé®ææ4è¡4åãç¬¬ä¸è¡å°æ¯ä¸ªæé®çä¸ç«¯è¿æ¥å¨ä¸èµ·ææè¡çº¿ï¼ç¬¬ä¸åå°æ¯ä¸ªæé®çå¦ä¸ç«¯è¿æ¥å¨ä¸èµ·ææåçº¿ï¼è¿æ ·ä¾¿ä¸å±æ4è¡4åå±8æ ¹çº¿ãå°è¿8æ ¹çº¿è¿æ¥å°åçæºç8ä¸ªI/Oå£ä¸ï¼éè¿ç¨åºæ«æé®çå¯ä»¥æ£æµ16ä¸ªé®ã</p>
<p>æ è®ºæ¯ç¬ç«é®çè¿æ¯ç©éµé®çï¼åçæºæ£æµå¶æ¯å¦è¢«æä¸çä¾æ®é½æ¯ä¸æ ·çï¼å³æ£æµä¸è¯¥é®å¯¹åºçI/Oå£æ¯å¦ä¸ºä½çµå¹³ãç¬ç«é®çæä¸ç«¯åºå®ä¸ºä½çµå¹³èç©éµé®çä¸¤ç«¯é½ä¸åçæºI/Oå£ç¸è¿ï¼å¨æ£æµæ¶éç¼ç¨éè¿åçæºI/Oå£éåºä½çµå¹³ãæ£æµæ¹æ³æå¸¸ç¨çæ¯è¡åæ«æåçº¿ç¿»è½¬æ³ã</p>
<ul>
<li>è¡åæ«ææ³æ£æµæ¶ï¼åéä¸åä¸ºä½çµå¹³ï¼å¶ä½å åå¨ä¸ºé«çµå¹³ï¼æ­¤æ¶ç¡®å®åæ°ï¼ç¶åç«å³è½®æµæ£æµä¸æ¬¡åè¡æ¯å¦æä½çµå¹³ï¼è¥æ£æµå°æä¸è¡ä¸ºä½çµå¹³ï¼æ­¤æ¶ç¡®å®äºè¡æ°ï¼ä¾¿å¯ä»¥ç¡®è®¤å½åè¢«æä¸çé®æ¯åªä¸è¡åªä¸åçãç¨åæ ·æ¹æ³è½®æµéååä¸æ¬¡ä½çµå¹³ï¼åè½®æµæ£æµä¸æ¬¡åè¡æ¯å¦åä¸ºä½çµå¹³ï¼è¿æ ·å³å¯æ£æµå®ææçæé®ï¼å½ææé®è¢«æä¸æ¶ä¾¿å¯å¤æ­åºæä¸çé®æ¯åªä¸ä¸ªé®ã</li>
<li>çº¿ç¿»è½¬æ³æ£æµæ¶ï¼å°±æ¯ä½¿ææè¡çº¿ä¸ºä½çµå¹³æ¶ï¼æ£æµææåçº¿æ¯å¦æä½çµå¹³ï¼å¦ææï¼å°±è®°å½åçº¿å¼ï¼ç¶ååç¿»è½¬ï¼ä½¿ææåçº¿é½ä¸ºä½çµå¹³ï¼æ£æµææè¡çº¿çå¼ãç±äºææé®æä¸ï¼è¡çº¿çå¼ä¹ä¼æååï¼è®°å½è¡çº¿çå¼ï¼ä»èå°±å¯ä»¥æ£æµå°å¨é¨æé®ã</li>
</ul>
<p><strong>ç©éµæé®ä¹éè¦æé®æ¶æã</strong></p>
<p><img src="https://img2024.cnblogs.com/blog/3732387/202601/3732387-20260109144754496-78745305.png" alt="image-20260109120836392" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3732387/202601/3732387-20260109144754398-1331883375.png" alt="image-20260109121508035" loading="lazy"></p>
<p><img src="https://img2024.cnblogs.com/blog/3732387/202601/3732387-20260109144754445-1533630463.png" alt="image-20260109123822715" loading="lazy"></p>
<p>ä»¥ç¬¬ä¸åä»£ç ä½ä¸ºç¤ºä¾ï¼ç®åä»ç»ä¸ <strong>éåæ«æ</strong> çæ£æµåçï¼</p>
<p><img src="https://img2024.cnblogs.com/blog/3732387/202601/3732387-20260109144754216-452685151.png" alt="image-20260109124004422" loading="lazy"></p>
<ul>
<li><code>P1=0xFF;</code> ææææé®ç«¯å£ç½®ä¸ºé«çµå¹³ï¼ä¹å°±æ¯å³é­æææé®</li>
<li><code>P1_3=0;</code>  å°ç¬¬ä¸åæé®ç½®ä¸ºä½çµå¹³ï¼å¶ä»æé®ä¾æ§ä¸ºé«çµå¹³ï¼å³é­ç¶æï¼</li>
<li>ä½¿ç¨  <code>Ifå¤æ­</code>  æ£æµè¡æé®ï¼å¦ææä¸è¡ä¸ºä½çµå¹³ï¼å°±è¿å <code>KeyNumber</code> ç¼å·</li>
</ul>
<p>å¶ä»3åæé®çæ£æµåçåä¸</p>
<h2 id="äºç©éµæé®åºç¨å®è·µ">äºãç©éµæé®åºç¨å®è·µ</h2>
<h3 id="1å®ç°lcd1602æ¾ç¤ºæé®ç¼å·">1ï¼å®ç°LCD1602æ¾ç¤ºæé®ç¼å·</h3>
<p>main.c</p>
<pre><code class="language-c">#include &lt;REGX52.H&gt;
#include "Delay.h"		  //åå«Delayå¤´æä»¶
#include "LCD1602.h"	  //åå«LCD1602å¤´æä»¶
#include "MatrixKey.h"	  //åå«ç©éµé®çå¤´æä»¶

unsigned char KeyNum;

void main()
{
	LCD_Init();							          //LCDåå§å
	LCD_ShowString(1,1,"MatrixKey:");	          //LCDæ¾ç¤ºå­ç¬¦ä¸²
	while(1)
	{
		KeyNum=MatrixKey();				          //è·åç©éµé®çé®ç 
		if(KeyNum)						          //å¦æææé®æä¸
		{
			LCD_ShowNum(2,1,KeyNum,2);	          //LCDæ¾ç¤ºé®ç 
		}
	}
}
</code></pre>
<p>Delay.c</p>
<pre><code class="language-c">
void Delay(unsigned int xms)
{
	unsigned char i, j;
	while(xms--)
	{
		i = 2;
		j = 239;
		do
		{
			while (--j);
		} while (--i);
	}
}
</code></pre>
<p>Delay.h</p>
<pre><code class="language-c">#ifndef __DELAY_H__
#define __DELAY_H__

void Delay(unsigned int xms);

#endif

</code></pre>
<p>LCD1602.c</p>
<pre><code class="language-c">#include &lt;REGX52.H&gt;

//å¼èéç½®ï¼
sbit LCD_RS=P2^6;
sbit LCD_RW=P2^5;
sbit LCD_EN=P2^7;
#define LCD_DataPort P0

//å½æ°å®ä¹ï¼
/**
  * @brief  LCD1602å»¶æ¶å½æ°ï¼12MHzè°ç¨å¯å»¶æ¶1ms
  * @param  æ 
  * @retval æ 
  */
void LCD_Delay()
{
	unsigned char i, j;

	i = 2;
	j = 239;
	do
	{
		while (--j);
	} while (--i);
}

/**
  * @brief  LCD1602åå½ä»¤
  * @param  Command è¦åå¥çå½ä»¤
  * @retval æ 
  */
void LCD_WriteCommand(unsigned char Command)
{
	LCD_RS=0;
	LCD_RW=0;
	LCD_DataPort=Command;
	LCD_EN=1;
	LCD_Delay();
	LCD_EN=0;
	LCD_Delay();
}

/**
  * @brief  LCD1602åæ°æ®
  * @param  Data è¦åå¥çæ°æ®
  * @retval æ 
  */
void LCD_WriteData(unsigned char Data)
{
	LCD_RS=1;
	LCD_RW=0;
	LCD_DataPort=Data;
	LCD_EN=1;
	LCD_Delay();
	LCD_EN=0;
	LCD_Delay();
}

/**
  * @brief  LCD1602è®¾ç½®åæ ä½ç½®
  * @param  Line è¡ä½ç½®ï¼èå´ï¼1~2
  * @param  Column åä½ç½®ï¼èå´ï¼1~16
  * @retval æ 
  */
void LCD_SetCursor(unsigned char Line,unsigned char Column)
{
	if(Line==1)
	{
		LCD_WriteCommand(0x80|(Column-1));
	}
	else if(Line==2)
	{
		LCD_WriteCommand(0x80|(Column-1+0x40));
	}
}

/**
  * @brief  LCD1602åå§åå½æ°
  * @param  æ 
  * @retval æ 
  */
void LCD_Init()
{
	LCD_WriteCommand(0x38);//å«ä½æ°æ®æ¥å£ï¼ä¸¤è¡æ¾ç¤ºï¼5*7ç¹éµ
	LCD_WriteCommand(0x0c);//æ¾ç¤ºå¼ï¼åæ å³ï¼éªçå³
	LCD_WriteCommand(0x06);//æ°æ®è¯»åæä½åï¼åæ èªå¨å ä¸ï¼ç»é¢ä¸å¨
	LCD_WriteCommand(0x01);//åæ å¤ä½ï¼æ¸å±
}

/**
  * @brief  å¨LCD1602æå®ä½ç½®ä¸æ¾ç¤ºä¸ä¸ªå­ç¬¦
  * @param  Line è¡ä½ç½®ï¼èå´ï¼1~2
  * @param  Column åä½ç½®ï¼èå´ï¼1~16
  * @param  Char è¦æ¾ç¤ºçå­ç¬¦
  * @retval æ 
  */
void LCD_ShowChar(unsigned char Line,unsigned char Column,char Char)
{
	LCD_SetCursor(Line,Column);
	LCD_WriteData(Char);
}

/**
  * @brief  å¨LCD1602æå®ä½ç½®å¼å§æ¾ç¤ºæç»å­ç¬¦ä¸²
  * @param  Line èµ·å§è¡ä½ç½®ï¼èå´ï¼1~2
  * @param  Column èµ·å§åä½ç½®ï¼èå´ï¼1~16
  * @param  String è¦æ¾ç¤ºçå­ç¬¦ä¸²
  * @retval æ 
  */
void LCD_ShowString(unsigned char Line,unsigned char Column,char *String)
{
	unsigned char i;
	LCD_SetCursor(Line,Column);
	for(i=0;String[i]!='\0';i++)
	{
		LCD_WriteData(String[i]);
	}
}

/**
  * @brief  è¿åå¼=XçYæ¬¡æ¹
  */
int LCD_Pow(int X,int Y)
{
	unsigned char i;
	int Result=1;
	for(i=0;i&lt;Y;i++)
	{
		Result*=X;
	}
	return Result;
}

/**
  * @brief  å¨LCD1602æå®ä½ç½®å¼å§æ¾ç¤ºæç»æ°å­
  * @param  Line èµ·å§è¡ä½ç½®ï¼èå´ï¼1~2
  * @param  Column èµ·å§åä½ç½®ï¼èå´ï¼1~16
  * @param  Number è¦æ¾ç¤ºçæ°å­ï¼èå´ï¼0~65535
  * @param  Length è¦æ¾ç¤ºæ°å­çé¿åº¦ï¼èå´ï¼1~5
  * @retval æ 
  */
void LCD_ShowNum(unsigned char Line,unsigned char Column,unsigned int Number,unsigned char Length)
{
	unsigned char i;
	LCD_SetCursor(Line,Column);
	for(i=Length;i&gt;0;i--)
	{
		LCD_WriteData(Number/LCD_Pow(10,i-1)%10+'0');
	}
}

/**
  * @brief  å¨LCD1602æå®ä½ç½®å¼å§ä»¥æç¬¦å·åè¿å¶æ¾ç¤ºæç»æ°å­
  * @param  Line èµ·å§è¡ä½ç½®ï¼èå´ï¼1~2
  * @param  Column èµ·å§åä½ç½®ï¼èå´ï¼1~16
  * @param  Number è¦æ¾ç¤ºçæ°å­ï¼èå´ï¼-32768~32767
  * @param  Length è¦æ¾ç¤ºæ°å­çé¿åº¦ï¼èå´ï¼1~5
  * @retval æ 
  */
void LCD_ShowSignedNum(unsigned char Line,unsigned char Column,int Number,unsigned char Length)
{
	unsigned char i;
	unsigned int Number1;
	LCD_SetCursor(Line,Column);
	if(Number&gt;=0)
	{
		LCD_WriteData('+');
		Number1=Number;
	}
	else
	{
		LCD_WriteData('-');
		Number1=-Number;
	}
	for(i=Length;i&gt;0;i--)
	{
		LCD_WriteData(Number1/LCD_Pow(10,i-1)%10+'0');
	}
}

/**
  * @brief  å¨LCD1602æå®ä½ç½®å¼å§ä»¥åå­è¿å¶æ¾ç¤ºæç»æ°å­
  * @param  Line èµ·å§è¡ä½ç½®ï¼èå´ï¼1~2
  * @param  Column èµ·å§åä½ç½®ï¼èå´ï¼1~16
  * @param  Number è¦æ¾ç¤ºçæ°å­ï¼èå´ï¼0~0xFFFF
  * @param  Length è¦æ¾ç¤ºæ°å­çé¿åº¦ï¼èå´ï¼1~4
  * @retval æ 
  */
void LCD_ShowHexNum(unsigned char Line,unsigned char Column,unsigned int Number,unsigned char Length)
{
	unsigned char i,SingleNumber;
	LCD_SetCursor(Line,Column);
	for(i=Length;i&gt;0;i--)
	{
		SingleNumber=Number/LCD_Pow(16,i-1)%16;
		if(SingleNumber&lt;10)
		{
			LCD_WriteData(SingleNumber+'0');
		}
		else
		{
			LCD_WriteData(SingleNumber-10+'A');
		}
	}
}

/**
  * @brief  å¨LCD1602æå®ä½ç½®å¼å§ä»¥äºè¿å¶æ¾ç¤ºæç»æ°å­
  * @param  Line èµ·å§è¡ä½ç½®ï¼èå´ï¼1~2
  * @param  Column èµ·å§åä½ç½®ï¼èå´ï¼1~16
  * @param  Number è¦æ¾ç¤ºçæ°å­ï¼èå´ï¼0~1111 1111 1111 1111
  * @param  Length è¦æ¾ç¤ºæ°å­çé¿åº¦ï¼èå´ï¼1~16
  * @retval æ 
  */
void LCD_ShowBinNum(unsigned char Line,unsigned char Column,unsigned int Number,unsigned char Length)
{
	unsigned char i;
	LCD_SetCursor(Line,Column);
	for(i=Length;i&gt;0;i--)
	{
		LCD_WriteData(Number/LCD_Pow(2,i-1)%2+'0');
	}
}
</code></pre>
<p>LCD1602.h</p>
<pre><code class="language-c">#ifndef __LCD1602_H__
#define __LCD1602_H__

//ç¨æ·è°ç¨å½æ°ï¼
void LCD_Init();
void LCD_ShowChar(unsigned char Line,unsigned char Column,char Char);
void LCD_ShowString(unsigned char Line,unsigned char Column,char *String);
void LCD_ShowNum(unsigned char Line,unsigned char Column,unsigned int Number,unsigned char Length);
void LCD_ShowSignedNum(unsigned char Line,unsigned char Column,int Number,unsigned char Length);
void LCD_ShowHexNum(unsigned char Line,unsigned char Column,unsigned int Number,unsigned char Length);
void LCD_ShowBinNum(unsigned char Line,unsigned char Column,unsigned int Number,unsigned char Length);

#endif

</code></pre>
<p>MatrixKey.c</p>
<pre><code class="language-c">#include &lt;REGX52.H&gt;
#include "Delay.h"

/**
  * @brief  ç©éµé®çè¯»åæé®é®ç 
  * @param  æ 
  * @retval KeyNumber æä¸æé®çé®ç å¼
			å¦ææé®æä¸ä¸æ¾ï¼ç¨åºä¼åçå¨æ­¤å½æ°ï¼æ¾æçä¸ç¬é´ï¼è¿åæé®é®ç ï¼æ²¡ææé®æä¸æ¶ï¼è¿å0
  */
unsigned char MatrixKey()
{
	unsigned char KeyNumber=0;
	
	P1=0xFF;  // 1111 1111 å¨é¨ç½®é«çµå¹³ï¼æ²¡ææé®æä¸
	P1_3=0;   // æ£æµç¬¬ä¸å
	if(P1_7==0){Delay(20);while(P1_7==0);Delay(20);KeyNumber=1;}
	if(P1_6==0){Delay(20);while(P1_6==0);Delay(20);KeyNumber=5;}
	if(P1_5==0){Delay(20);while(P1_5==0);Delay(20);KeyNumber=9;}
	if(P1_4==0){Delay(20);while(P1_4==0);Delay(20);KeyNumber=13;}
	
	P1=0xFF;  // 1111 1111 å¨é¨ç½®é«çµå¹³ï¼æ²¡ææé®æä¸
	P1_2=0;   // æ£æµç¬¬äºå
	if(P1_7==0){Delay(20);while(P1_7==0);Delay(20);KeyNumber=2;}
	if(P1_6==0){Delay(20);while(P1_6==0);Delay(20);KeyNumber=6;}
	if(P1_5==0){Delay(20);while(P1_5==0);Delay(20);KeyNumber=10;}
	if(P1_4==0){Delay(20);while(P1_4==0);Delay(20);KeyNumber=14;}
	
	P1=0xFF;  // 1111 1111 å¨é¨ç½®é«çµå¹³ï¼æ²¡ææé®æä¸
	P1_1=0;   // æ£æµç¬¬ä¸å
	if(P1_7==0){Delay(20);while(P1_7==0);Delay(20);KeyNumber=3;}
	if(P1_6==0){Delay(20);while(P1_6==0);Delay(20);KeyNumber=7;}
	if(P1_5==0){Delay(20);while(P1_5==0);Delay(20);KeyNumber=11;}
	if(P1_4==0){Delay(20);while(P1_4==0);Delay(20);KeyNumber=15;}
	
	P1=0xFF;  // 1111 1111 å¨é¨ç½®é«çµå¹³ï¼æ²¡ææé®æä¸
	P1_0=0;   // æ£æµç¬¬åå
	if(P1_7==0){Delay(20);while(P1_7==0);Delay(20);KeyNumber=4;}
	if(P1_6==0){Delay(20);while(P1_6==0);Delay(20);KeyNumber=8;}
	if(P1_5==0){Delay(20);while(P1_5==0);Delay(20);KeyNumber=12;}
	if(P1_4==0){Delay(20);while(P1_4==0);Delay(20);KeyNumber=16;}
	
	return KeyNumber;
}
</code></pre>
<p>MatrixKey.h</p>
<pre><code class="language-c">#ifndef __MATRIXKEY_H__
#define __MATRIXKEY_H__

unsigned char MatrixKey();

#endif

</code></pre>
<h3 id="2ä½¿ç¨ç©éµé®çå®ç°å¯ç éåè½">2ï¼ä½¿ç¨ç©éµé®çå®ç°å¯ç éåè½</h3>
<p>åªéè¦ä¿®æ¹main.c ,å¶ä½ä»£ç åä¸</p>
<pre><code class="language-c">#include &lt;REGX52.H&gt;
#include "Delay.h"
#include "LCD1602.h"
#include "MatrixKey.h"

unsigned char KeyNum;
unsigned int Password,Count;

void main()
{
	LCD_Init();
	LCD_ShowString(1,1,"Password:");
	while(1)
	{
		KeyNum=MatrixKey();
		if(KeyNum)
		{
			if(KeyNum&lt;=10)	                      //å¦æS1~S10æé®æä¸ï¼è¾å¥å¯ç 
			{                                    
				if(Count&lt;4)	                       //å¦æè¾å¥æ¬¡æ°å°äº4
				{                                  
					Password*=10;				   //å¯ç å·¦ç§»ä¸ä½
					Password+=KeyNum%10;		   //è·åä¸ä½å¯ç 
					Count++;	                   //è®¡æ¬¡å ä¸
				}
				LCD_ShowNum(2,1,Password,4);	   //æ´æ°æ¾ç¤º
			}                                    
			if(KeyNum==11)	                       //å¦æS11æé®æä¸ï¼ç¡®è®¤
			{                                    
				if(Password==2345)	               //å¦æå¯ç ç­äºæ­£ç¡®å¯ç 
				{                                  
					LCD_ShowString(1,14,"OK ");	   //æ¾ç¤ºOK
					Password=0;		               //å¯ç æ¸é¶
					Count=0;		               //è®¡æ¬¡æ¸é¶
					LCD_ShowNum(2,1,Password,4);   //æ´æ°æ¾ç¤º
				}
				else				               //å¦å
				{
					LCD_ShowString(1,14,"ERR");	   //æ¾ç¤ºERR
					Password=0;		               //å¯ç æ¸é¶
					Count=0;		               //è®¡æ¬¡æ¸é¶
					LCD_ShowNum(2,1,Password,4);   //æ´æ°æ¾ç¤º
				}
			}
			if(KeyNum==12)	                       //å¦æS12æé®æä¸ï¼åæ¶
			{
				Password=0;		                   //å¯ç æ¸é¶
				Count=0;		                   //è®¡æ¬¡æ¸é¶
				LCD_ShowNum(2,1,Password,4);	   //æ´æ°æ¾ç¤º
			}
		}
	}
}
</code></pre>
<p><code>Password*=10;				   //å¯ç å·¦ç§»ä¸ä½</code></p>
<p><code>Password+=KeyNum%10;		   //è·åä¸ä½å¯ç  </code></p>
<p><strong>å¾è¡¨ï¼æé®åºå 5 â 6 â 3 â 8 çå¤çè¿ç¨</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left">æé®</th>
<th style="text-align: left">è¿ç®å Password</th>
<th style="text-align: left">Password Ã 10</th>
<th style="text-align: left">KeyNum % 10</th>
<th style="text-align: left">è¿ç®å Password</th>
<th style="text-align: left">è§£é</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">5</td>
<td style="text-align: left">0</td>
<td style="text-align: left">0 Ã 10 = 0</td>
<td style="text-align: left">5 % 10 = 5</td>
<td style="text-align: left"><strong>5</strong></td>
<td style="text-align: left">ç¬¬ä¸ä¸ªæ°å­ç´æ¥å­å¥</td>
</tr>
<tr>
<td style="text-align: left">6</td>
<td style="text-align: left">5</td>
<td style="text-align: left">5 Ã 10 = 50</td>
<td style="text-align: left">6 % 10 = 6</td>
<td style="text-align: left"><strong>56</strong></td>
<td style="text-align: left">5ç§»å°åä½ï¼6æ¾å¨ä¸ªä½</td>
</tr>
<tr>
<td style="text-align: left">3</td>
<td style="text-align: left">56</td>
<td style="text-align: left">56 Ã 10 = 560</td>
<td style="text-align: left">3 % 10 = 3</td>
<td style="text-align: left"><strong>563</strong></td>
<td style="text-align: left">56åä¸º560ï¼3æ¾å¨ä¸ªä½</td>
</tr>
<tr>
<td style="text-align: left">8</td>
<td style="text-align: left">563</td>
<td style="text-align: left">563 Ã 10 = 5630</td>
<td style="text-align: left">8 % 10 = 8</td>
<td style="text-align: left"><strong>5638</strong></td>
<td style="text-align: left">563åä¸º5630ï¼8æ¾å¨ä¸ªä½</td>
</tr>
</tbody>
</table>

</div>
<div class="clear"></div>

		</div>
		<div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-09 14:50">2026-01-09 14:49</span>&nbsp;
<a href="https://www.cnblogs.com/WIRO">Q&amp;25</a>&nbsp;
éè¯»(<span id="post_view_count">12</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19461450);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19461450', targetLink: 'https://www.cnblogs.com/WIRO/p/19461450', title: '51åçæº_æé®æ£æµ' })">ä¸¾æ¥</a>
</div>
	 ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å°ç½ä¹è½çæçLLM-RLç®æ³ï¼PPO/DPO/GRPO/GSPO ]]></title>
    <link>https://www.cnblogs.com/aifrontiers/p/19461279</link>
    <guid>77111ffa109c6624dab271adf6c85bdc</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/aifrontiers/p/19461279" title="åå¸äº 2026-01-09 14:29">
    <span role="heading" aria-level="2">å°ç½ä¹è½çæçLLM-RLç®æ³ï¼PPO/DPO/GRPO/GSPO</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>åæ: <a href="https://mp.weixin.qq.com/s/9KT9LrMTXDGHSvGFrQhRkg" target="_blank" rel="noopener nofollow">https://mp.weixin.qq.com/s/9KT9LrMTXDGHSvGFrQhRkg</a></p>
<p><strong>LLM-RLå¾ææç« æ¨è</strong></p>
<p><a href="https://mp.weixin.qq.com/s/cx3qY42Lp0L3RaSOgsH77A" target="_blank" rel="noopener nofollow">å°ç½ä¹è½çæçRL-PPO</a></p>
<p><a href="https://mp.weixin.qq.com/s/nfN0dWT3ZfDuW7ZGfaG6dA" target="_blank" rel="noopener nofollow">æ¶èï¼å¼ºåå­¦ä¹ ä»å¥é¨å°å°ç¥ï¼5 æ¬ç»å¸ææ + 8 å¤§å®æé¡¹ç® + 7ä¸ªåè´¹è§é¢ï¼ä¸ç«å¼æå®</a></p>
<p><a href="https://mp.weixin.qq.com/s/4_6CBXMJhqmiYKSzsAXncg" target="_blank" rel="noopener nofollow">å°ç½ä¹è½çæçRLHFï¼åºç¡ç¯</a></p>
<p><a href="https://mp.weixin.qq.com/s/8O7W8--x14-b1d3M9IS_3w" target="_blank" rel="noopener nofollow">å°ç½ä¹è½çæçRLHF-PPOï¼åçç¯</a></p>
<p>å¼ºåå­¦ä¹  (RL, Reinforcement Learning) å·²æä¸ºå¤§æ¨¡ååè®­ç»çå³é®ç¯èï¼å¨åå ç¯ä¸­ï¼æä»¬å¯¹LLM-RLä¸­æåºç¡ãææ ¸å¿çPPOç®æ³åäºè¯¦ç»çæè§£ï¼æéè¦çå¯ä»¥ç¹å»ä¸é¢é¾æ¥éè¯»ï¼æ¬ç¯å°ä»ç»å¶ä»ä¸»æµçLLM-RLç®æ³ãè¯»å®è¿ç¯åï¼ä½ ä¼åç°ï¼ä¸ç®¡æ¯åªç§LLM-RLç®æ³ï¼æ¬è´¨é½æ¯å°äººç±»åå¥½èå¥å°å¤§æ¨¡åä¸­ï¼å·®å¼ç¹å¨äºä»¥ä½ç§æ¹å¼/æ´é«æå°ææåå¥½æ°æ®çä»·å¼ãå¦ä½å¨éä½ç®åèµæºéæ±ä¸ä¿è¯æ¨¡åæ§è½ãå¦ä½æé«ç®æ³ç¨³å®æ§ã</p>
<p>å¨ä»ç»LLM-RLåç±»ç­ç¥ç®æ³åï¼æä»¬å°åè§£éä¸äºåºæ¬æ¦å¿µï¼æ¶µçå¼ºåå­¦ä¹ çè§£ãä»·å¼å½æ°ãNLPä¸­çå¼ºåå­¦ä¹ ã éåï¼ä»ç»RLHFçèµ·æºãè®¾è®¡æè·¯ãå¦ä½ä¸å¤§æ¨¡åRLHFç®æ³å³èçãåå¯¹LLM-RLä¸»æµçï¼DPOãGRPOãGSPOï¼ç­ç¥ä¼åç®æ³è¿è¡ç»è´è®²è§£ï¼å¦åä¸ªç®æ³åçãè®­ç»è¿ç¨ãä¼ç¼ºç¹ç­ãä¸ºäºè½å¤æ´å¥½å°å¯¹æ¯åä¸ªç®æ³ï¼ä¹ä¼æå¸¦ä»ç»ä¸PPOç®æ³ã</p>
<h1 id="1-åºæ¬æ¦å¿µ">1 åºæ¬æ¦å¿µ</h1>
<h2 id="11-å¼ºåå­¦ä¹ çè§£">1.1 å¼ºåå­¦ä¹ çè§£</h2>
<p><img alt="" loading="lazy" data-src="https://pcnzmyb3bo4o.feishu.cn/space/api/box/stream/download/asynccode/?code=OTMwOTMzOTA2YzdjZGU1MDdhZmZiN2M3NWQyNDc2OWJfbEtSeHF6VHJWSVluYU11WUxUVUMxMHppWGZqWmFkdUVfVG9rZW46RDB1RWIwajRpbzAxbXF4OEVDbWNNRWNIbnZnXzE3Njc5MzY0Nzc6MTc2Nzk0MDA3N19WNA" class="lazyload"></p>
<p>å¼ºåå­¦ä¹ å³é®å¨äºã<strong>å¼ºå</strong>ãè¿ä¸ªè¯ï¼ç®åçè§£å°±æ¯ã<strong>ç¨åé¦å¼ºåè¡ä¸º</strong>ãï¼å³ç¨å¥æ©è§åè®©æºè½ä½èªå·±å¨è¯éä¸­ç­éåºææè¡ä¸ºï¼åéè¿éå¤åé¦æè¿äºè¡ä¸ºå·©åºææä¼ç­ç¥ï¼æ¬è´¨å°±æ¯ã<strong>å¥æ©é©±å¨çè¡ä¸ºç­éä¸å·©åº</strong>ãï¼å±ä»¬ç»åä¹<strong>è®­ç»å°çåä¸</strong>çä¾å­éè¯è§£éä¸è¿å¥è¯ã</p>
<ul>
<li>
<p><strong>å¥æ©é©±å¨</strong>ï¼RLæ´ä¸ªå­¦ä¹ è¿ç¨çæ ¸å¿å¨åæ¥èª<strong>å¥å±</strong> å <strong>æ©ç½/æ å¥å±</strong>çå³æ¶åé¦ï¼æ¯å¦å°çåå¯¹<strong>åä¸</strong>å°±ç»é¶é£ï¼å¥å±ï¼ï¼æ²¡åå¯¹å°±ä¸ç»é¶é£ï¼æ å¥å±ï¼ï¼å°ççè¡ä¸ºéæ©å®å¨ç±è¿ç§åé¦é©±å¨ã</p>
</li>
<li>
<p><strong>è¡ä¸ºç­é</strong>ï¼æºè½ä½ï¼å°çï¼ä¼å¨å¨ä½ç©ºé´éä¸æ­å°è¯ä¸åè¡ä¸ºï¼èå¥æ©å°±åä¸ä¸ªç­éå¨ï¼<strong>è¢«å¥å±çè¡ä¸ºä¼è¢«ä¿çï¼è¢«æ©ç½/æ å¥å±çè¡ä¸ºä¼è¢«æ·æ±°</strong>ãæ¯å¦å°çä¸å¼å§å¯è½å°è¯è¹¦è·³ãè¶´çãæå°¾å·´ç­å¨ä½ï¼è¿äºå¨ä½é½æ²¡å¾å°é¶é£ï¼å°±ä¼æ¢æ¢è¢«ç­éæï¼åªæ<strong>åä¸</strong>è¿ä¸ªå¨ä½è½æ¿å°é¶é£ï¼å°±ä¼è¢«ç­éåºæ¥ã</p>
</li>
<li>
<p><strong>è¡ä¸ºå·©åº</strong>ï¼è¢«ç­éåºæ¥çææè¡ä¸ºï¼ä¼å¨ä¸æ¬¡æ¬¡éå¤çã<strong>è¡ä¸ºâå¥å±</strong>ãå¾ªç¯ä¸­è¢«å¼ºåï¼æç»åæç¨³å®çæ¡ä»¶åå°ãæ¯å¦å°çæ¯æ¬¡ååä¸é½è½æ¿å°é¶é£ï¼éå¤æ¬¡æ°å¤äºï¼å®å°±ä¼æ<strong>å¬å°æä»¤âåä¸</strong>è¿ä¸ªè¡ä¸ºåºå®ä¸æ¥ï¼å½¢æç¨³å®çæè½ã</p>
</li>
</ul>
<p>ç®åæ¥è¯´ï¼ã<strong>å¼ºå</strong>ãä¸æ¯å¢å¼ºè½åï¼èæ¯å¼ºåã<strong>å¨ä½ - å¥å±ä¹é´</strong>ãçå³èï¼è®©æºè½ä½æ¢æ¢è®°ä½<strong>åä»ä¹è½æ¿å°å¥½å¤ï¼åä»ä¹ä¼åäº</strong>ãå°±åè®­ç»å°çæ¶ï¼ä½ ä¸ç¨å¼ºè¡æ°å®çè¿è®©å®åä¸ï¼åªéè¦ç¨é¶é£çå¥æ©ï¼è®©å®èªå·±æåº<strong>åä¸=æåç</strong>è¿ä¸ªè§å¾ï¼æåå½¢æç¨³å®çè¡ä¸ºä¹ æ¯ã</p>
<p>æ¥ä¸æ¥ï¼æä»¬ç»§ç»­ä»¥<strong>è®­ç»å°çåä¸ä¸ºä¾ï¼</strong>çè§£ä¸å¼ºåå­¦ä¹ çå³é®è¦ç´ ãå­¦ä¹ è¿ç¨ã</p>
<p>å¼ºåå­¦ä¹ ç2ä¸ªæ ¸å¿è§è²ï¼</p>
<ul>
<li>
<p><strong>æºè½ä½ï¼Agentï¼</strong>ï¼è¦å­¦ä¹ <strong>åä¸</strong>æè½ç<strong>å°ç</strong></p>
</li>
<li>
<p><strong>ç¯å¢ï¼Environmentï¼</strong>ï¼å°çæå¤çè®­ç»åºæ¯ï¼æ¯å¦å®¶éçå®¢åãæ·å¤çé¢å­ç­ï¼</p>
</li>
</ul>
<p>å¼ºåå­¦ä¹ ç3ä¸ªå³é®è¦ç´ ï¼</p>
<ul>
<li>
<p><strong>ç¶æç©ºé´</strong> <span class="math inline">\(S\)</span>ï¼è®­ç»ç¯å¢ä¸­ææå¯è½åºç°çåºæ¯éåãæ¯å¦å°çå¯è½ç«ç/è¶´ç/å¯¹çç©å·å«ï¼ä¹å¯è½èº«è¾¹æéçäººç»è¿ï¼è¿äºä¸åçç¶æé½å±äºç¶æç©ºé´</p>
</li>
<li>
<p><strong>å¨ä½ç©ºé´</strong> <span class="math inline">\(A\)</span>ï¼å°çè½ååºçææå¨ä½éåãæ¯å¦å°çå¯ä»¥ç«çä¸å¨ãè¶´çä¼æ¯ãæå°¾å·´ãè·³è·ãåä¸ï¼è¿äºé½æ¯å®å¨ä½ç©ºé´éçåå®¹</p>
</li>
<li>
<p><strong>å¥å±</strong> <span class="math inline">\(R\)</span>ï¼å°çå¤äºæä¸ªç¶æãååºæä¸ªå¨ä½æ¶ï¼ç»åºçå³æ¶åé¦ãæ¯å¦å°çååº<strong>åä¸</strong>å¨ä½æ¶ï¼ç»å®ä¸åé¶é£ï¼å¦æå°çä¹±è¹¦ä¹±è·³ä¸éåï¼å°±ä¸ç»é¶é£çè³è½»å£°å¶æ­¢ã</p>
</li>
</ul>
<p>é£å°çï¼æºè½ä½ï¼åè®­ç»ç¯å¢æ¯æä¹äºå¨çï¼æç»å­¦ä¼åä¸çå¢ï¼æä»¬ä»¥è®­ç»ä¸­ <span class="math inline">\(t\)</span>æ¶å»çäºå¨è¿ç¨ä¸ºä¾ï¼</p>
<ul>
<li>
<p>å½åç¶æ<span class="math inline">\(S\_t\)</span>ï¼å°çæ­£ç«å¨å®¢åéççä½ ï¼æ­¤æ¶å®è¿æ²¡ååºç®æ å¨ä½ï¼æä»¥æ²¡æ¿å°å¥å±ï¼å³æ¶å¥å±<span class="math inline">\(R\_t\)</span>= 0</p>
</li>
<li>
<p>å°ççå¨ä½<span class="math inline">\(A\_t\)</span>ï¼ä½ ååº<strong>åä¸</strong>çæä»¤åï¼å°çå¯è½ååºåç§ååºï¼æ¯å¦è¹¦è·³ãå¯è½è¶´çï¼ä¹å¯è½å¶ç¶ååº<strong>åä¸</strong>çå¨ä½ï¼</p>
</li>
<li>
<p>æ°ç¶æ <span class="math inline">\(S\_{t+1}\)</span>ä¸æ°åé¦ä¸<span class="math inline">\(R\_{t+1}\)</span>ï¼å¦æå°çåæåçå¨ä½<span class="math inline">\(A\_t\)</span>=åä¸ï¼è®­ç»ç¶æå°±åæ<strong>å°çå¤äºåä¸ç¶æ</strong><span class="math inline">\(S\_{t+1}\)</span>ï¼ä¸»äººç«å»ç»å®ä¸åé¶é£ä½ä¸ºå¥å±<span class="math inline">\(R\_{t+1}\)</span>=2 çæ­£åå¥å±ï¼å¦æå°çåçæ¯å¶ä»å¨ä½ï¼<span class="math inline">\(S\_{t+1}\)</span>å¯è½åæå°çè¶´çæå°çè¹¦è·³ï¼ä¸»äººä¸ç»é¶é£<span class="math inline">\(R_{t+1}\)</span>=0ã</p>
</li>
</ul>
<p>è¿æ ·çäºå¨ä¼ä¸æ¬¡æ¬¡éå¤ï¼ä¸»äººåå¤ååºæä»¤ï¼å°çå¨ä¸åç¶æä¸å°è¯ä¸åå¨ä½ï¼å¹¶æ ¹æ®æ¯å¦æ¿å°é¶é£ï¼å¥å±ï¼æ»ç»ç»éªãæç»ï¼å°çï¼æºè½ä½ï¼å°±ä¼å­¦å°ä¸å¥æä¼ç©æ³ï¼å½æ¥æ¶å°<strong>åä¸</strong>æä»¤æ¶ï¼ç«å»ååº<strong>åä¸</strong>å¨ä½ï¼ä»¥æ­¤ç¨³å®æ¿å°é¶é£å¥å±ï¼è¿å°±æ¯å¼ºåå­¦ä¹ çæ ¸å¿é»è¾ã</p>
<h2 id="12-ä»·å¼å½æ°">1.2 ä»·å¼å½æ°</h2>
<p>åé¢æå°ç<strong>å³æ¶å¥å±</strong><span class="math inline">\(R\_t\)</span>ï¼åªåæ äºå½åç¶æ<span class="math inline">\(S\_t\)</span>çæ¶çï¼å¿½ç¥äºå½åç¶æåå¨ä½å¯¹æªæ¥æ¶ççå½±åãæ´åççè®¡ç®æ¹å¼ï¼éè¦å¼é¡¾<strong>å³æ¶æ¶ç</strong>å<strong>æªæ¥æ¶ç</strong>ï¼å¬å¼å¦ä¸ï¼</p>
<p></p><div class="math display">\[V\_t = R_t + \gamma V_{t+1}
\]</div><p></p><p>å¶ä¸­ï¼</p>
<ul>
<li>
<p><span class="math inline">\(V_t\)</span>ï¼<span class="math inline">\(t\)</span>æ¶å»çæ»æ¶çï¼åå«å³æ¶åæªæ¥æ¶çï¼</p>
</li>
<li>
<p><span class="math inline">\(R_t\)</span>ï¼<span class="math inline">\(t\)</span>æ¶å»çå³æ¶æ¶ç</p>
</li>
<li>
<p><span class="math inline">\(V_{t+1}\)</span>ï¼ <span class="math inline">\(t+1\)</span>æ¶å»çæ»æ¶çï¼å¯¹ <span class="math inline">\(t\)</span>æ¶å»èè¨å±äºæªæ¥æ¶ç</p>
</li>
<li>
<p><span class="math inline">\(\gamma\)</span>ï¼ææ£å å­ï¼ç¨æ¥è°èæªæ¥æ¶çå¨å½åæ»æ¶çä¸­çæé</p>
</li>
</ul>
<p>æ­¤å¤ä¸å±å¼å¼ºåå­¦ä¹ ä»·å¼å½æ°çåè®¾ä¸æ¨å¯¼ï¼ä»æä¾ç®åç»è®ºï¼æ¹ä¾¿è¯»èèç¦äºæ´å¥½ççè§£åç±»ç®æ³ç­ç¥çå·ä½åæ³åç´è§çè§£ã</p>
<h2 id="13-nlpä¸­çå¼ºåå­¦ä¹ ">1.3 NLPä¸­çå¼ºåå­¦ä¹ </h2>
<p>å¯¹åºå°<span class="math inline">\(NLP\)</span> ä¸ï¼å¤§è¯­è¨æ¨¡åå°±æ¯æºè½ä½ï¼è¾å¥çæç¤ºè¯ <span class="math inline">\(prompt\)</span> å°±å¯¹åºç¶æ <span class="math inline">\(S\)</span>ï¼è¾åºä¸ä¸ä¸ª<span class="math inline">\(token\)</span> å°±æ¯å¨ä½ <span class="math inline">\(A\)</span>ï¼å¯¹ <span class="math inline">\(prompt+response\)</span> è¿è¡æåå°±æ¯å¥å± <span class="math inline">\(R\)</span>ï¼æ´ä½ç®æ å°±æ¯ç»å®<span class="math inline">\(prompt\)</span>ï¼è°æ´ç­ç¥æ¨¡åï¼çæç¬¦åäººç±»åå¥½ç<span class="math inline">\(response\)</span>ã</p>
<h1 id="2-rlhfçèµ·æº">2 RLHFçèµ·æº</h1>
<p>è®ºææ é¢ï¼Deep Reinforcement Learning from Human Preferences</p>
<p>è®ºæå°åï¼<a href="https://arxiv.org/pdf/1706.03741" target="_blank" rel="noopener nofollow">https://arxiv.org/pdf/1706.03741</a></p>
<p><img alt="" loading="lazy" data-src="https://pcnzmyb3bo4o.feishu.cn/space/api/box/stream/download/asynccode/?code=NjQ4NmIwNjk2OWY5YTJmNmQ2ZTc0MTRkYzgyMzc0M2RfdmtWakxvWmJkTmh1cFBUVUlDbVRicUdUMWIzbFlwUmdfVG9rZW46QktmZ2IxMXFYb1c4VHZ4bG5JNmNITWwzbnpiXzE3Njc5MzY0Nzc6MTc2Nzk0MDA3N19WNA" class="lazyload"></p>
<p>è¿ç¯åè¡¨äº2017å¹´NIPSçè®ºææ¯å¼ºåå­¦ä¹ é¢åçå¼åæ§ææï¼å¶æ ¸å¿è®¾è®¡ç´æ¥å¥ å®äºå¤§æ¨¡åRLHFçææ¯åºç¡ï¼æä»¬æ¥ççè¿ç¯è®ºæå°åºååºäºåªäºå¼åæ°å·¥ä½ãä»¥åå¦ä½å¯¹RLHFå¸¦æ¥å¯åçã</p>
<h2 id="21-æç« çæ ¸å¿é®é¢åæ°ä¸æ¹æ³">2.1 æç« çæ ¸å¿ï¼é®é¢ãåæ°ä¸æ¹æ³</h2>
<ul>
<li>
<p><strong>è§£å³çé®é¢</strong>ï¼ä¼ ç»å¼ºåå­¦ä¹ çæ ¸å¿æè·¯æ¯ä¸ºä»»å¡æå·¥è®¾è®¡æç¡®å¥å±å½æ°ï¼ç¨ä»¥å¼å¯¼æºè½ä½å­¦ä¹ ãè¿ç§æ¨¡å¼å¯¹äºç®åçåºç¨åºæ¯è¿è¡ï¼ä¸æ¦æ¶åå¤æåºæ¯ï¼å¦æºå¨äººæ§å¶ãæ¸¸æï¼ä¼é¢ä¸´å¥å±å½æ°é¾ä»¥ç²¾åå®ä¹ãå¥å±è®¾è®¡è¿èäººç±»çå®éæ±çé®é¢ï¼ç´æ¥å½±åæ¯æºè½ä½è¡ä¸ºä¸äººç±»åå¥½ä¸¥ééä½ï¼æ¯å¦æºå¨äººä¸ºééç®åå¥å±è§åä¼åºç°è·è¡å¼è¡èµ°ï¼æºè½é©¾é©¶æºè½ä½ä¸ºè¿½æ±å¾åå¥å±èå¿½è§äººç±»æ´çéçå¹³ç¨³é©¾é©¶ä½éªã</p>
</li>
<li>
<p><strong>æ ¸å¿åæ°</strong>ï¼èå¼æå·¥è®¾è®¡å¥å±ï¼æåºã<strong>ç¨äººç±»åå¥½åé¦é©±å¨å¼ºåå­¦ä¹ </strong>ãï¼æ éçå®å¥å±å½æ°å°±å¯ä»¥è®©æºè½ä½å¯¹é½äººç±»éæ±ï¼å¤§å¹éä½äººç±»çç£ææ¬ã</p>
</li>
<li>
<p><strong>å³é®æ¹æ³</strong>ï¼æå»ºã<strong>åå¥½æ¶éâå¥å±å»ºæ¨¡âç­ç¥ä¼å</strong>ãä¸é¶æ®µé­ç¯ãâ  åå¥½æ¶éï¼è®©éä¸å®¶å¯¹æ¯1-2ç§ç­è½¨è¿¹çæ®µï¼å¦æºå¨äººåç©ºç¿»æè´¥çæ®µï¼ï¼å¿«éç»åºåå¥½å¤æ­ï¼â¡ å¥å±å»ºæ¨¡ï¼ç¨Bradley-Terryæ¨¡åè®­ç»å¥å±æ¨¡åï¼æåäººç±»åå¥½èåçéæ§è§åï¼â¢ ç­ç¥ä¼åï¼éè¿A2Cï¼æ¸¸æåºæ¯ï¼ãTRPOï¼æºå¨äººåºæ¯ï¼ç®æ³ï¼ç»åæåçå¥å±æ¨¡åæç»­æ´æ°ç­ç¥ã</p>
</li>
</ul>
<h2 id="22-æ¹æ³ææ">2.2 æ¹æ³ææ</h2>
<p>è®ºæå¨å¤ä¸ªåºæ¯éªè¯äºæææ¹æ³çæææ§ï¼â  MuJoCoæºå¨äººä»»å¡ï¼8é¡¹ï¼ï¼ä»700æ¡äººç±»æ¥è¯¢ï¼æ§è½å°±æ¥è¿æå·¥å¥å±æ¹æ¡ï¼1400æ¡æ¥è¯¢å®ç°åè¶ï¼â¡ Atariæ¸¸æï¼7é¡¹ï¼ï¼5500æ¡æ¥è¯¢è®©å¤æ°ä»»å¡æ§è½æ¾èæåï¼â¢ å¯è®­ç»novelè¡ä¸ºï¼1å°æ¶åæä¼æºå¨äººè¿ç»­åç©ºç¿»ç­äººç±»é¾ä»¥æ¼ç¤ºçå¨ä½ãæ ¸å¿äº®ç¹æ¯ä»éä¸å°1%çç¯å¢äº¤äºåé¦ï¼å°±è½è¾¾å°çè³è¶è¶ä¼ ç»æ¹æ³ã</p>
<h2 id="23-å¯¹å¤§æ¨¡årlhfçå¯å">2.3 å¯¹å¤§æ¨¡åRLHFçå¯å</h2>
<p>è®ºæçæ ¸å¿ææ³ä¸è®¾è®¡ï¼è¢«RLHFå®æ´ç»§æ¿å¹¶ééææ¬åºæ¯ï¼åæä¼ç»åºè¯¦ç»è§£è¯»ï¼ï¼æä¸ºå¶æ ¸å¿ææ¯æ¡æ¶ï¼</p>
<ul>
<li>
<p><strong>æ ¸å¿é»è¾å¤ç¨</strong>ï¼RLHFç´æ¥åé´ã<strong>ç¨äººç±»åå¥½æ¿ä»£æå·¥å¥å±</strong>ãçæè·¯ï¼è§£å³å¤§æ¨¡åå¯¹è¯è¿è´¯æ§ãç¤¼è²æ§ç­é¾ä»¥éåçé®é¢ï¼é¿åå¤§æ¨¡åæ æ³å¯¹é½äººç±»åå¥½ã</p>
</li>
<li>
<p><strong>ä¸æ­¥æµç¨ç§æ</strong>ï¼è®©æ æ³¨åå¿«éå¯¹æ¯ä¸¤æ¡ææ¬ï¼éåºäººç±»åå¥½ï¼è®­ç»æ¨¡åå­¦ä¼æä¹ç»ææ¬æåï¼å°äººç±»åå¥½æåèåå°PPOç®æ³ä¸­ä¼åå¤§æ¨¡ååæ°</p>
</li>
<li>
<p><strong>å³é®çªç ´çæ¯æ</strong>ï¼å¤§æ¨¡åææ¬ä»»å¡ç»´åº¦æé«ï¼å¨éæ æ³¨ä¸ç°å®ï¼å¾çäºè®ºæéªè¯çã<strong>å°éåé¦å³å¯é©±å¨æ¨¡åä¼å</strong>ãï¼RLHFä»ç¨æ°ä¸æ¡åå¥½æ°æ®å°±å®ç°äºé®ç­è´¨éè·åã</p>
</li>
</ul>
<p>ä»ä¸é¢çæè¿°å¯ä»¥çåºï¼è®ºææåºçã<strong>å¥å±é¾å®ä¹</strong>ããã<strong>ä¸é¶æ®µé­ç¯</strong>ããã<strong>ä½ææ¬åé¦</strong>ãææäºRLHFçææ¯åºç³ï¼å¯åäºOpenAIçç åäººåå°ã<strong>æºè½ä½å¯¹é½äººç±»åå¥½</strong>ãè¿ä¸æ³æ³ï¼ä»æºå¨äººãæ¸¸æé¢åæåè¿ç§»è³å¤§æ¨¡åï¼æä¸ºChatGPTä¸å¤çç«çéè¦åå ã</p>
<h1 id="3-rlhf-ppo">3 RLHF-PPO</h1>
<p>è®ºææ é¢ï¼Training language models to follow instructions with human feedback è®ºæå°åï¼ <a href="https://arxiv.org/pdf/2203.02155" target="_blank" rel="noopener nofollow">https://arxiv.org/pdf/2203.02155</a></p>
<p>PPOï¼Proximal Policy Optimizationï¼ç®æ³æ¯ InstructGPT æ¨¡åå®ç°äººç±»åé¦å¼ºåå­¦ä¹ ï¼RLHFï¼çæ ¸å¿ï¼æ ¸å¿ææ³æ¯éè¿çº¦æç­ç¥æ´æ°å¹åº¦ï¼å¨ä¿è¯è®­ç»ç¨³å®æ§çåæä¸ï¼æå¤§åäººç±»åå¥½å¯¼åçå¥å±ï¼åæ¶é¿åç­ç¥è¿åº¦åç¦»åå§çç£æ¨¡åã</p>
<h2 id="31-rlhf-ppoçåå¤§æ¨¡å">3.1 RLHF-PPOçåå¤§æ¨¡å</h2>
<p>ç¸æ¯ä¼ ç»PPOç®æ³ï¼RLHF-PPOæ¨¡åæ¶ææ´ä¸ºå¤æï¼ä¸å±åå«4ä¸ªæ¨¡åï¼æ¯ä¼ ç»PPOå¤åºäº<strong>åèæ¨¡åï¼Reference Modelï¼</strong> å<strong>å¥å±æ¨¡åï¼Reward Modelï¼</strong>ã</p>
<p>**åå¤§æ¨¡åä½ç¨ååæ°åå§åï¼</p>
<ul>
<li>
<p><strong>Actor Model</strong> <span class="math inline">\(\pi_{\theta}\)</span> ï¼ç¨SFTåçæ¨¡åä½ä¸ºåå§æ¨¡åï¼éè¿PPOè®­ç»è°æ´åæ°ï¼å¾å°æç»çæ¨¡åï¼ä½¿å¶çæçåç­æ´ç¬¦åäººç±»åå¥½ï¼<strong>åæ°å¯å</strong>ã</p>
</li>
<li>
<p><strong>Reference Model</strong> <span class="math inline">\(\pi_{base}\)</span>ï¼SFTåçæ¨¡åï¼ç¨äºéå¶Actor Modelä¸è¦åç¦»Reference Modelå¤ªè¿ï¼<strong>åæ°å»ç»</strong>ã</p>
</li>
<li>
<p><strong>Reward Model</strong> <span class="math inline">\(r\_{\theta}\)</span>ï¼å¯¹æ¨¡ååç­æåï¼è¡¨ç¤ºè´´åäººç±»åå¥½çç¨åº¦ï¼è®­ç»å®åï¼å¨PPOä¸­æ¯<strong>åæ°å»ç»</strong>çã</p>
</li>
<li>
<p><strong>Critic Model</strong> <span class="math inline">\(V_{t}\)</span>ï¼ç¨äºé¢æµæææ»æ¶çï¼ä¸ºä¼å¿å½æ° <span class="math inline">\(A_{t}\)</span>æä¾åºçº¿ï¼ä½¿ç­ç¥æ´æ°æ´ç¨³å®ï¼<strong>åæ°å¯å</strong>ã</p>
</li>
</ul>
<h2 id="32-rlhf-ppoçè®­ç»è¿ç¨">3.2 RLHF-PPOçè®­ç»è¿ç¨</h2>
<p><img alt="" loading="lazy" data-src="https://pcnzmyb3bo4o.feishu.cn/space/api/box/stream/download/asynccode/?code=Yjc5OTNjZTM1YzJlOGI2NzI3OTJmMWY5ZjhhMDcyZTdfRE5zQmFSQWR5dHFnRlhTY2s2N3lqWnNQdk5iVEVCRDNfVG9rZW46WE9OY2JQck1mb0EwZG94b1Mxb2NoSFBZblJnXzE3Njc5MzY0Nzc6MTc2Nzk0MDA3N19WNA" class="lazyload"></p>
<p>æä»¬åé¡¾ä¸ä¸RLHFéçæ´ä½æµç¨ï¼å¦ä¸å¾æç¤ºï¼</p>
<p>Step 1ï¼æ¶éæ¼ç¤ºæ°æ®ï¼è®­ç»çç£ç­ç¥ï¼SFTï¼</p>
<p>Step 2ï¼æ¶éå¯¹æ¯æ°æ®ï¼è®­ç»å¥å±æ¨¡åï¼RMï¼</p>
<p>Step 3ï¼ç¨å¼ºåå­¦ä¹ ï¼PPOï¼ä¼åç­ç¥æ¨¡å</p>
<p>æ´ä¸ªæµç¨çæ ¸å¿æ¯<strong>ç¨äººç±»åå¥½æ°æ®ï¼æ¼ç¤ºãæåºï¼æå¯¼æ¨¡åè®­ç»</strong>ï¼æç»è®©å¤§æ¨¡åè¾åºæ¢æç¨ãåç¬¦åäººç±»æå¾çåå®¹ã</p>
<p>ä¸é¢ï¼éç¹è®¨è®ºPPOç®æ³çè®­ç»è¿ç¨</p>
<h3 id="ç»éªæ°æ®æ¶é">ç»éªæ°æ®æ¶é</h3>
<ul>
<li>
<p>å°ä¸ä¸ªbatchçpromptåç»å½åçActoræ¨¡å<span class="math inline">\(\pi_{\theta}\)</span>ï¼çæå¯¹åºçååºåºåresponse</p>
</li>
<li>
<p>å¯¹äºååºåºåçæ¯ä¸ªtokenï¼è®¡ç®ä»¥ä¸ä¸­é´åéï¼</p>
<ul>
<li>
<p>Actoræ¨¡åçå¯¹æ°æ¦ç<span class="math inline">\(log(\pi_\theta(a_t | s_t))\)</span></p>
</li>
<li>
<p>Referenceæ¨¡åçå¯¹æ°æ¦ç<span class="math inline">\(log(\pi_{base}(a_t | s_t))\)</span></p>
</li>
<li>
<p>Criticæ¨¡åæ ¹æ®å½åç¶æ <span class="math inline">\(s\_t\)</span>çä»·å¼ä¼°è®¡ $V_t $</p>
</li>
<li>
<p>è®¡ç®æ¯ä¸ªtokençKLæ£åº¦<span class="math inline">\(kl = log(\pi_\theta(a_t | s_t)) - log(\pi_{base}(a_t | s_t)) = log \frac {\pi_\theta(a_t | s_t)}{\pi_{base}(a_t | s_t)}\)</span></p>
</li>
<li>
<p>è¥è¯¥tokenä½äºåºåçæåä¸ä¸ªï¼éè¿Reward Model è®¡ç®äººç±»åå¥½åæ°<span class="math inline">\(r_{\theta}\)</span></p>
</li>
<li>
<p>ç»å Reward Model è®¡ç®äººç±»åå¥½åæ°<span class="math inline">\(r_{\theta}\)</span>ï¼åªå¨æåä¸æ­¥ï¼å æ¯ä¸ªtoken ç KL æ©ç½ ï¼è®¡ç®åºæ¯ä¸ªtokençæç»å³æ¶å¥å±ä¿¡å· $R_t $ï¼ä»¥deepspeed-chatçRLHFä¸ºä¾ï¼ $R_t $çè®¡ç®å¦ä¸</p>
</li>
</ul>
<p>$$\begin{align} R_t = \begin{cases} -kl\_ctl *(log\frac{\pi_\theta(a_t | s_t)}{\pi_{base}(a_t | s_t)}), &amp;\text t\not =T \\ -kl\_ctl *(log\frac{\pi_\theta(a_t | s_t)}{\pi_{base}(a_t | s_t)}) + r_\theta, &amp;\text t=T \end{cases} \end{align}$$</p>
<ul>
<li>ä½¿ç¨æç»å³æ¶å¥å±ä¿¡å· $R_t $åCriticæ¨¡åçä»·å¼ä¼°è®¡ $V_t $ï¼éè¿ GAE (Generalized Advantage Estimation) æ¹æ³è®¡ç®æ¯ä¸ª token çä¼å¿ <span class="math inline">\(Adv_t\)</span>ï¼è®¡ç®å¦ä¸</li>
</ul>
</li>
</ul>
<p></p><div class="math display">\[\begin{align} \delta_t = R_t + \gamma*V_{t+1} - V_t \\ Adv_t = \delta_t + \gamma* \lambda*Adv_{t+1} \end{align}
\]</div><p></p><p>å°åé¢æ¶éå°çç»éªæ°æ®ï¼promptã<span class="math inline">\(log(\pi_\theta(a_t | s_t))\)</span>ã<span class="math inline">\(log(\pi_{base}(a_t | s_t))\)</span> ã<span class="math inline">\(Adv_t\)</span>ã...ï¼æææ¹æ¬¡ï¼æ¾å°ç»éªæ± ä¸­</p>
<p>å¦æå¯¹ä¸è¿°è®¡ç®è¿ç¨æçæï¼å¯ä»¥åç<a href="https://mp.weixin.qq.com/s/8O7W8--x14-b1d3M9IS_3w" target="_blank" rel="noopener nofollow">å°ç½ä¹è½çæçRLHF-PPOï¼åçç¯</a>ï¼æç« æè¯¦ç»è§£è¯»ã</p>
<h3 id="æ¨¡ååæ°æ´æ°">æ¨¡ååæ°æ´æ°</h3>
<ul>
<li>
<p>å¾ªç¯epochsæ¬¡</p>
<ul>
<li>
<p>å¯¹ç»éªæ± çæ¯ä¸ªbatchæ°æ®</p>
<ul>
<li>
<p>Actor Modelåæ°æ´æ°ï¼ PPOæ´æ°æ¨¡å <span class="math inline">\(\pi_{\theta}\)</span> åæ°ï¼è¿éä¸ºäºé²æ­¢ç­ç¥æ¨¡å <span class="math inline">\(\pi_{\theta}\)</span> è¿åº¦åç¦»åèæ¨¡å <span class="math inline">\(\pi_{base}\)</span> ï¼æä¸¤ç§å½¢å¼ä¿è¯æ¨¡åå¨æéçç©ºé´éå¾®è°åæ°ï¼ä¸ç§æ¯å¼å¥PPO-KLæ£åº¦ï¼</p>
<p>$$\begin{align} L^{PPO-KL}(\theta) = E_{\tau \sim {\pi_{base}}}^t [\frac{\pi_\theta(a_t | s_t)}{\pi_{base}(a_t | s_t)} A_{t} - \beta D_{KL}(\pi_{base}(.|x_t) || \pi_{\theta}(.|x_t))] \end {align}$$</p>
<p>å¦ä¸ç§PPO-CLIPæ¯è¾ç´æ¥ï¼å¨ç®æ å½æ°ä¸­ï¼éå¶æ°æ§æ¨¡åçå·®è·å¨çº¦å®çåºé´åï¼</p>
<p>$$\begin{align} L^{PPO-CLIP}(\theta) = E_{\tau \sim {\pi_{base}}}^t [min( \frac{\pi_\theta(a_t | s_t)}{\pi_{base}(a_t | s_t)} A_{t},  \ clip(\frac{\pi_\theta(a_t | s_t)}{\pi_{base}(a_t | s_t)}, 1-\varepsilon,1+\varepsilon)A_{t})] \end {align}$$</p>
</li>
<li>
<p>Critic Modelåæ°æ´æ°ï¼$$\begin{align} L^{Critic}({\phi}) &amp;= E_t [(R_t + \gamma V_{t+1} - V_t)^2] \end {align}$$</p>
<p><span class="math inline">\(V\_{t}\)</span>: Criticæ¨¡åå¯¹ <span class="math inline">\(t\)</span>æ¶å»æ¶ççé¢ä¼°ï¼å³æªæ¥åå³æ¶æ¶ççæ´ä½é¢ä¼°</p>
<p>$ R_t + \gamma*V_{t+1}<span class="math inline">\(: è®¡ç®å¾å°çå³æ¶æ¶ç\)</span>R_{t}$ ,<span class="math inline">\(\gamma*V_{t+1}\)</span> ä¸ºCriticæ¨¡åé¢æµåº <span class="math inline">\(t+1\)</span>æ¶å»ä¹åçæææ¶ç</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="æ¨¡ååæ°åæ­¥">æ¨¡ååæ°åæ­¥</h3>
<ul>
<li>
<p><strong>ç­ç¥åæ°æ´æ°</strong>ï¼å®æç»éªæ± çæ°æ®è®­ç»è¿­ä»£åï¼ç¨æ°è®­ç»å¾å°çActoræ¨¡ååæ°ãCriticæ¨¡ååæ°æ¿æ¢æ§çæ¨¡ååæ°ã</p>
</li>
<li>
<p><strong>ä¸¢å¼æ§æ°æ®</strong>ï¼å è¿æ¹æ°æ®æ¯ç¨æ§ç­ç¥æ¨¡åæ¶éçï¼ä¸ç°æçæ°ç­ç¥æ¨¡ååå·®è¾å¤§ï¼éè¦æ§éæ ·çåè®¾ä¸ååç¡®ï¼æä»¥å¿é¡»ä¸¢å¼å½åè¿æ¹æ°æ®ã</p>
</li>
<li>
<p><strong>å¾ªç¯è®­ç»æµç¨</strong>ï¼åå°æ°æ®æ¶éé¶æ®µï¼ç¨æ´æ°åçç­ç¥æ¨¡åä¸ç¯å¢éæ°äº¤äºï¼ééå¨æ°çæ°æ®ï¼ä¹åéå¤æ´ä¸ªè®­ç»æµç¨ï¼ç´å°ç­ç¥æ§è½ç¨³å®æ¶æï¼æè¾¾å°é¢è®¾çè®­ç»æ­¥æ°ã</p>
</li>
</ul>
<p>ä»¥ä¸å°±æ¯PPOç®æ³è®­ç»å¨æµç¨çè¯´æï¼æ ¸å¿ç¯èåæ¬ï¼ç»éªæ°æ®æ¶éãæ¨¡ååæ°æ´æ°åæ¨¡ååæ°åæ­¥</p>
<h2 id="33-rlhf-ppoçä¼ç¼ºç¹">3.3 RLHF-PPOçä¼ç¼ºç¹</h2>
<p><strong>ä¼ç¹</strong>ï¼â  ç¨³å®æ§å¼ºï¼é è£åª/KLæ©ç½éå¶ç­ç¥æ´æ°å¹ï¼éä½å´©åé£é©ï¼ææ¶æï¼â¡ æè½å°ï¼æ éTRPOçäºé¶è®¡ç®ï¼ç¨Adamä¼åå¨å³å¯ï¼æ ¸å¿è¶åæ°ï¼å¦clipç³»æ°ãGAEåæ°ï¼æè°è¯</p>
<p><strong>ç¼ºç¹</strong>ï¼â  è®­ç»ææ¬é«ï¼æ¶å4ä¸ªæ¨¡åçè¿ç®/æ´æ°ï¼æ¯åç»­æ¹è¿éç¹ï¼â¡ æ¢¯åº¦ä¿¡æ¯æµªè´¹ï¼clipæºå¶ä¼æªæ­å¤§éæ¢¯åº¦ï¼ææ¢è®­ç»ãéå¶ç­ç¥ç²¾ç»åº¦ï¼â¢ æ ·æ¬å©ç¨çä½ï¼æ¬è´¨æ¯on-policyæ¶æï¼ç­ç¥åæ­¥é¶æ®µéä¸¢å¼æ§æ°æ®ï¼æ°æ¨¡åæ¯æ¬¡æ¶éæ°æ®é½ä¼å¸¦æ¥ç®åãæ¶é´ææ¬ã</p>
<h1 id="4-dpo">4 DPO</h1>
<p>è®ºææ é¢ï¼Direct Preference Optimization: Your Language Model is Secretly a Reward Model è®ºæå°åï¼<a href="https://arxiv.org/pdf/2305.18290" target="_blank" rel="noopener nofollow">https://arxiv.org/pdf/2305.18290</a></p>
<p><img alt="" loading="lazy" data-src="https://pcnzmyb3bo4o.feishu.cn/space/api/box/stream/download/asynccode/?code=MDZmMGZkNDRkMGQ1OWQ3MTVhNGIyNWU4NjRhMDU0ODdfY2tTR0xJOTFQckFnTUl2RTFvNjJ5NUk1eVlaang1dXdfVG9rZW46UkZyWGJNWmtlb3ZBM1N4UlUxVmNmOUlDbmtBXzE3Njc5MzY0Nzc6MTc2Nzk0MDA3N19WNA" class="lazyload"></p>
<p>å¦åææè¿°ï¼PPOç®æ³è½è¢«è¯å®ææï¼ä½ä¹æ´é²è¯¸å¤çç¹ãå¦éåæ¶ç»´æ¤åè¿è¡åä¸ªæ¨¡åï¼å¯¹è®¡ç®èµæºåæ¾å­çè¦æ±æé«ï¼è®­ç»è¿ç¨è¿ä¼´éå¼ºåå­¦ä¹ ï¼RLï¼å¸¸è§çä¸ç¨³å®æ§é®é¢ï¼ä¸æ¬¡å®æ´çPPOè®­ç»ï¼è¦çå¤ä¸ªç¯èï¼è°ä¼çé¾åº¦è¾å¤§ã</p>
<p>è½å¦æ¾å°ä¸ç§æ¹æ³ï¼ç»è¿æ¾å¼è®­ç»å¥å±æ¨¡ååå¤æçå¼ºåå­¦ä¹ ç¯èï¼åºäºäººç±»åå¥½æ°æ®ç´æ¥ä¼åç­ç¥æ¨¡åå¢ï¼</p>
<p>DPOæ­£æ¯å¨è¿ä¸èæ¯ä¸è¯ççåæ°æ¹æ³ï¼ç±æ¯å¦ç¦å¤§å­¦ç ç©¶å¢éæåºãå¶æ ¸å¿ææ³æ¯æå¼ã<strong>åè®­ç»å¥å±æ¨¡åï¼åç¨RLä¼åç­ç¥</strong>ãçä¸¤æ­¥æµç¨ï¼ç´æ¥å°äººç±»åå¥½æ°æ®è½¬åä¸ºå¯¹ç­ç¥åæ°çäºåç±»æå¤±ä¼åï¼å¤§å¹ç®åäºè®­ç»é¾è·¯ã</p>
<h2 id="41-dpoç®æ³çåç">4.1 DPOç®æ³çåç</h2>
<p>DPO çå³é®çè®ºæ¯æå¨äºäººç±»åå¥½æ°æ®ééèçå¥å±è§åï¼èéå¯¹è¿ä¸ªè§åï¼å­å¨ä¸ä¸ª<strong>æä¼ç­ç¥</strong> <span class="math inline">\(\pi^*\)</span>ï¼</p>
<p>æ¢è½è®©æ¨¡åè·å¾çææå¥å±å°½å¯è½é«ï¼åè½æ§å¶ç­ç¥æ¨¡å<span class="math inline">\(\pi_\theta\)</span>ååèæ¨¡å <span class="math inline">\(\pi_{ref}\)</span>ä¹é´çå·®å¼å¨åççèå´åã</p>
<p>è®ºæè¿ä¸æ­¥è¯æäºï¼è¿ä¸ªæä¼ç­ç¥ <span class="math inline">\(\pi^*\)</span>ãåèç­ç¥æ¨¡å <span class="math inline">\(\pi_{ref}\)</span>ä»¥ååå¥½æ°æ®éèççå¥å±å½æ°<span class="math inline">\(r_{\theta}\)</span> ï¼ä¸èä¹é´ææç¡®çæ°å­¦å³ç³»ï¼è¯¦ç»çæ¨å¯¼è¿ç¨è§è®ºæãè¿æå³çï¼ä¸ç¨åç¬è®­ç»ä¸ä¸ªå¥å±æ¨¡åï¼ç´æ¥æ¿åå¥½æ°æ®å°±è½ä¼åç­ç¥æ¨¡åã</p>
<p>å·ä½æ¥è¯´ï¼DPO è®©æ­£å¨è®­ç»çæ¨¡å<span class="math inline">\(\pi_\theta\)</span>ï¼å¨é¢å¯¹åä¸ä¸ªè¾å¥æç¤º <span class="math inline">\(x\)</span>æ¶ï¼çæäººç±»åå¥½çåç­<span class="math inline">\(y_w\)</span>ï¼èä¸æ¯è¢«å¦å®çåç­<span class="math inline">\(y_l\)</span>ãå¯¹åºçæå¤±å½æ°å®ä¹å¦ä¸ï¼</p>
<p></p><div class="math display">\[\begin{align} L_{DPO}(\pi_\theta, \pi_{ref}) = -E_{(x, y_w, y_l) \sim {D}}[log(\sigma(\beta * (log\frac{\pi_\theta(y_w | x)}{\pi_{ref}(y_w | x)} - log\frac{\pi_\theta(y_l | x)}{\pi_{ref}(y_l | x)})))] \end {align}
\]</div><p></p><p>æä»¬æ¥æè§£è¿ä¸ªå¬å¼çå ä¸ªå³é®é¨åï¼</p>
<ul>
<li>
<p><strong>æ°æ®æ¥æº</strong> <span class="math inline">\(D\)</span> : æ¯äººç±»æ æ³¨çåå¥½æ°æ®éï¼æ¯ä¸ªæ ·æ¬æ¯ "æç¤º <span class="math inline">\(x\)</span> + æ´ä¼åç­<span class="math inline">\(y_w\)</span> + è¾å·®åç­<span class="math inline">\(y\_l\)</span>" çç»å</p>
</li>
<li>
<p><strong>æ¦çæ¯çæ¯è¾</strong>:</p>
<ul>
<li>
<p><span class="math inline">\(log\frac{\pi_\theta(y_w | x)}{\pi_{ref}(y_w | x)}\)</span>ï¼åæ å½åæ¨¡å<span class="math inline">\(\pi_\theta\)</span>ç¸æ¯åèæ¨¡å<span class="math inline">\(\pi_{ref}\)</span>å¾åäºçæä¼è´¨åç­<span class="math inline">\(y_w\)</span>çç¨åº¦ï¼è¿ä¸ªå¼è¶å¤§è¶å¥½</p>
</li>
<li>
<p><span class="math inline">\(log\frac{\pi_\theta(y_l | x)}{\pi_{ref}(y_l | x)}\)</span>ï¼åæ å½åæ¨¡å<span class="math inline">\(\pi_\theta\)</span>ç¸æ¯åèæ¨¡å<span class="math inline">\(\pi_{ref}\)</span>å¾åäºçæå·®åç­<span class="math inline">\(y_l\)</span>çç¨åº¦ï¼è¿ä¸ªå¼è¶å°è¶å¥½</p>
</li>
<li>
<p>è¿ä¸¤ä¸ªæ¦çæ¯çå·®å¼ï¼å°±æ¯æ¨¡åå­¦å°ç<strong>ä¼è´¨åç­æ¯å·®åç­å¥½å¤å°</strong>çä¿¡å·ï¼ä¸¤èç¸å·®è¶å¤§ï¼è¯´ææ¨¡åè¶è½åºåå¥½åï¼å¹¶ä¸è¶åç±å¥½çåç­ï¼ç¸å½äºæåå¥½è½¬åæäºéå¼å¥å±ã</p>
</li>
</ul>
</li>
<li>
<p><strong>è°æ§å å­</strong> <span class="math inline">\(\beta\)</span>ï¼ç¨æ¥æ§å¶<span class="math inline">\(\pi_\theta\)</span>å<span class="math inline">\(\pi_{ref}\)</span>çåç¦»ç¨åº¦ï¼<span class="math inline">\(\beta\)</span>è¶å¤§ï¼è¡¨ææ¨¡åéè¦æ´ææ¾çåå¥½å·®å¼ï¼æä¼è®¤å®ä¸ä¸ªåç­æ¯å¦ä¸ä¸ªå¥½ã</p>
</li>
<li>
<p><strong>æå¤±çä½ç¨</strong>ï¼<span class="math inline">\(Sigmoid\)</span>æå¥å±ä¿¡å·è½¬ææ´ä¼åç­çæ¦çï¼åç¨è´å¯¹æ°ä¼¼ç¶æå¤±æ¥è®­ç»ï¼æ¬è´¨æ¯è®©æ¨¡åå°½å¯è½åç¡®å°åºåå¥½åç­åå·®åç­ã</p>
</li>
</ul>
<h2 id="42-dpoçè®­ç»è¿ç¨">4.2 DPOçè®­ç»è¿ç¨</h2>
<p><strong>æ°æ®åå¤</strong>ï¼æ¶éäººç±»åå¥½æ°æ®é (<span class="math inline">\(x, y_w, y_l\)</span>)</p>
<p><strong>æ¨¡ååå§å</strong>ï¼</p>
<ul>
<li>
<p><strong>Actor Model</strong> <span class="math inline">\(\pi_{\theta}\)</span> ï¼ç¨SFTåçæ¨¡åä½ä¸ºåå§æ¨¡åï¼<strong>åæ°å¯å</strong>ã</p>
</li>
<li>
<p><strong>Reference Model</strong> <span class="math inline">\(\pi_{ref}\)</span>ï¼SFTåçæ¨¡åï¼<strong>åæ°å»ç»</strong>ã</p>
</li>
</ul>
<p><strong>è®­ç»è¿ç¨</strong>ï¼</p>
<ul>
<li>
<p>å¾ªç¯epochsæ¬¡</p>
<ul>
<li>
<p>ä» æ°æ®é<span class="math inline">\(D\)</span>ä¸­æ½å (<span class="math inline">\(x, y_w, y_l\)</span>) batchæ°æ®</p>
<ul>
<li>
<p>å¯¹äºæ¯ä¸ªæ ·æ¬ï¼è®¡ç®å¬å¼ï¼7ï¼ä¸­çä¸­é´åéå¼ <span class="math inline">\(\pi_\theta(y_w | x)\)</span>ã<span class="math inline">\(\pi_{ref}(y_w | x)\)</span>ã<span class="math inline">\(\pi_\theta(y_l | x)\)</span>ã<span class="math inline">\(\pi_{ref}(y_w | x)\)</span>åå¶å¯¹æ°æ¦çãéå¸¸æ¯è®¡ç®åºåçæ»å¯¹æ°æ¦çï¼ <span class="math inline">\(log \pi_theta(y | x) = \sum_t log \pi_\theta(token_t | x, y_{&lt;t})\)</span></p>
</li>
<li>
<p>ä»£å¥ DPO æå¤±å½æ°å¬å¼ï¼è®¡ç®æå¤±ï¼ä½¿ç¨æ¢¯åº¦ä¸éæ´æ° <span class="math inline">\(\pi_{\theta}\)</span> çåæ°ã</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>éå¤æ­¤è¿ç¨ï¼ç´å°æ¨¡åæ¶ææè¾¾å°é¢å®è®­ç»æ­¥æ°ã</p>
</li>
</ul>
<h2 id="43-dpoçä¼ç¼ºç¹">4.3 DPOçä¼ç¼ºç¹</h2>
<p><strong>ä¼ç¹</strong>ï¼â  è®­ç»é¾è·¯æç®åï¼ç´æ¥ä»åå¥½æ°æ®éæåéå¼çå¥å±ä¿¡æ¯ï¼æ²¡æå¤æçæ°æ®éæ ·è¿ç¨ï¼çæäºè®­ç»å¥å±æ¨¡åãä»·å¼å½æ°çæ­¥éª¤ãâ¡ èµæºå ç¨å°ï¼ä»æåèæ¨¡ååç­ç¥æ¨¡åï¼æ¾å­åè®¡ç®èµæºçæ¶èå¤§å¹éä½ï¼è®­ç»ä¹æ´ç¨³å®ãæ´å®¹æè½å°ã</p>
<p><strong>ç¼ºç¹</strong>ï¼â  ä¾èµå¤§éé«è´¨éäºååå¥½æ°æ®ï¼è½ç¶å¯ä»¥åå©å¼æº LLM çæä¼è´¨æ°æ®ï¼ä½æ°æ®æ¶éä»æé¾åº¦ï¼â¡ ééåºæ¯è¾å±éï¼å é«åº¦ä¾èµåå¥½æ°æ®ï¼é¾ä»¥è¦çå¤ææ¨çä»»å¡ï¼è½åä¸éä¸å PPOï¼ä»èå¨æµç¨ç®åãè®­ç»ææ¬ä½ã</p>
<h1 id="5-grpo">5 GRPO</h1>
<p>è®ºææ é¢ï¼DeepSeekMath: Pushing the Limits of Mathematical Reasoning in Open Language Models</p>
<p>è®ºæå°åï¼<a href="https://arxiv.org/pdf/2402.03300" target="_blank" rel="noopener nofollow">https://arxiv.org/pdf/2402.03300</a></p>
<p><img alt="" loading="lazy" data-src="https://pcnzmyb3bo4o.feishu.cn/space/api/box/stream/download/asynccode/?code=MTZlZjMwYmQwZTgxMDBmYTM4ZWI2NDllMmY2M2IzNjBfaTFNcTZLa0JBUllDVnZTZ2ZseDJSaFMzaUdEb3RRRXJfVG9rZW46VmV2U2I2OHhSb2JRREZ4RmphYWNlRVJwbnNlXzE3Njc5MzY0Nzc6MTc2Nzk0MDA3N19WNA" class="lazyload"></p>
<p>DeepSeekå¢éåç°ï¼PPOç®æ³ä¸­Criticæ¨¡åï¼åæ°è§æ¨¡ä¸Actoræ¨¡åç¸å½ï¼æ¾èå¢å äºLLMè®­ç»çåå­å ç¨ä¸è®¡ç®ææ¬ï¼æ´å³é®çæ¯ï¼å¾å¤LLMä»»å¡ï¼å¦æ°å­¦æ¨çãä»£ç çæç­ï¼ï¼å¥å±ä¿¡å·ç¨çï¼ä»åºåæ«å°¾ç±RMç»åºå¥å±ï¼ï¼å¯¼è´è®­ç»è½ç²¾åä¼°è®¡æ¯ä¸ªtokenä»·å¼çCriticæ¨¡åå¼å¸¸å°é¾ã</p>
<p>Criticæ¨¡åçæ ¸å¿ä½ç¨æ¯ä¸ºä¼å¿å½æ°è®¡ç®æä¾åºçº¿ä»¥éä½æ¹å·®ï¼è½å¦ç¨æ´é«ææ¹å¼æ¿ä»£Criticå®ç°è¯¥ç®æ å¢ï¼ä¸ºæ­¤ï¼DeepSeekå¢éæåºGRPOï¼Group Relative Policy Optimizationï¼ç®æ³ï¼çªç ´äºå¯¹Criticæ¨¡åçä¾èµï¼ä¸ºç­ç¥æ¨¡åçé«æä¼åå¼è¾äºæ°è·¯å¾ã</p>
<h2 id="51-grpoçåç">5.1 GRPOçåç</h2>
<p>GRPOåæ¶äºPPOä¸­ç¨äºä¼°è®¡ä»·å¼çCriticæ¨¡åï¼éè¿åä¸Promptä¸çç¾¤ä½ä¿¡æ¯æ¥æé åºçº¿ãå³ï¼éå¯¹åä¸ª Promptï¼è®©ç­ç¥æ¨¡åçæ <span class="math inline">\(G\)</span> ä¸ªä¸åè¾åº <span class="math inline">\({\{o_1, o_2, ..., o_G\}}\)</span>ï¼ç¨å¥å±æ¨¡åç»æ¯ä¸ªè¾åºæå <span class="math inline">\(r={\{r_1, r_2, ..., r_G\}}\)</span>ï¼è®¡ç®è¿ç»å¥å±çåå¼ä¸æ åå·®ï¼åå°æ¯ä¸ªè¾åºçåå§å¥å±å½ä¸åï¼å¾å°ä¼å¿</p>
<p></p><div class="math display">\[\begin{align} \hat{A}_{i,t} = \widetilde{r}_i = \frac{r_i - mean(r)}{std(r)} \end{align}
\]</div><p></p><p>ç±ä¸å¼å¾å°åæ ç¾¤ç»ç¸å¯¹å¥½åçåæ°ï¼ä»¥æ­¤æ¿ä»£ Critic æä¾çä¼å¿åºçº¿ã</p>
<p>ç±æ­¤çåºï¼GRPOçè®­ç»ä»éä¸ä¸ªæ¨¡åï¼</p>
<ul>
<li>
<p><strong>ç­ç¥æ¨¡å</strong> <span class="math inline">\(\\pi_{\theta}\)</span> ï¼ç±SFTæ¨¡ååå§åï¼æ ¹æ®ç»åç¸å¯¹å¥å±å¨ææ´æ°åæ°ï¼åæ°åå</p>
</li>
<li>
<p><strong>åèæ¨¡å</strong> <span class="math inline">\(\pi_{ref}\)</span>ï¼å»ç»åæ°çSFTï¼åæ°ä¸å</p>
</li>
<li>
<p><strong>å¥å±æ¨¡å</strong> <span class="math inline">\(r\_{\theta}\)</span>ï¼ç¨äºè¯ä¼°çæçå®æ´ååºåºåçè´¨éï¼ä¸ºç­ç¥æ¨¡åæä¾ä¼åæ¹åï¼å»ç»åæ°</p>
</li>
</ul>
<p>GRPOç®æ³æ²¿ç¨ PPO ç clip é¶æ®µç»æï¼ä¼å¿ä¼°è®¡è¢«æ¿æ¢ä¸ºç»åå½ä¸åå¥å±ï¼</p>
<p></p><div class="math display">\[\begin{align}
J_{GPRO}(\theta) = E[q\sim P(Q), {o_i} \sim \pi_{\theta_{old}(O|q)}] 
\frac{1}{G} \sum_{i=1}^G \frac{1}{|o_i|} \sum_{t=1}^{|o_i|} {\{min [ratio_t *\hat{A}_{i,t}, clip(ratio_t, 1-\varepsilon, 1+\varepsilon)\}}*\hat{A}_{i,t}] - \beta D_{KL}[\pi_\theta || \pi_{ref}]\}

\end {align}\]</div><p></p><p>å¼ï¼9ï¼çä¸­é´åéæè§£å¦ä¸ï¼</p>
<ul>
<li>
<p>$\hat{A}_{i,t} $ ç±å¬å¼ï¼8ï¼ç»åºï¼ä½ç¨äºåºåä¸­æ¯ä¸ä¸ª tokenï¼å°±æ¯è¯´ï¼ææ token å±äº«åä¸ä¸ªä¼å¿</p>
</li>
<li>
<p><span class="math inline">\(ratio_t=\frac{\pi_\theta(o_{i,t} |q, o_{i,&lt;t})}{\pi_{old}(o_{i,t} |q, o_{i,&lt;t})}\)</span>, ï¼å³æ°æ§ç­ç¥å¯¹åä¸å¨ä½çæ¦çæ¯</p>
</li>
<li>
<p><span class="math inline">\(\beta D_{KL}[\pi_\theta || \pi_{ref}]\)</span>ï¼çº¦æ ç­ç¥æ¨¡åä¸è¦åç¦»åèæ¨¡åå¤ªè¿</p>
</li>
</ul>
<h2 id="52-grpoçè®­ç»è¿ç¨">5.2 GRPOçè®­ç»è¿ç¨</h2>
<p><img alt="" loading="lazy" data-src="https://pcnzmyb3bo4o.feishu.cn/space/api/box/stream/download/asynccode/?code=MDlkYzg3MTJiNDhhNTRkNzExMDVkODJkNzMwOGM4OGRfZjJ3cmZwRWRTZjNTR2Fwak5VblZFeWxMbGEza1FISWJfVG9rZW46WVBqZ2JZVWRvbzY4OUZ4YWNjSmN6MFVHbnpoXzE3Njc5MzY0Nzc6MTc2Nzk0MDA3N19WNA" class="lazyload"></p>
<ul>
<li>
<p><strong>è¾å¥é¡¹</strong>ï¼åå§ç­ç¥æ¨¡å <span class="math inline">\(\pi_{\theta_{init}}\)</span> ãå¥å±æ¨¡å <span class="math inline">\(r_{\theta}\)</span>ãä»»å¡æç¤ºé <span class="math inline">\(D\)</span>ï¼ä»¥åè¶åæ° <span class="math inline">\(\varepsilon\)</span>,<span class="math inline">\(\beta\)</span>ï¼æ§å¶è®­ç»ç¨³å®æ§ãæ´æ°æ­¥é¿ç­ï¼ã</p>
</li>
<li>
<p><strong>å¤å±å¾ªç¯ï¼æ»è¿­ä»£è½®æ¬¡</strong> <span class="math inline">\(I\)</span></p>
<p>æ¯ä¸è½®å¤å±å¾ªç¯åå«ä»¥ä¸æä½ï¼</p>
<ul>
<li>
<p>å¤å¶å½åç­ç¥æ¨¡å<span class="math inline">\(\pi_{\theta}\)</span>çåæ°å¹¶å»ç»ï¼å°å¶ä½ä¸ºåèæ¨¡å<span class="math inline">\(\pi_{ref}\)</span></p>
</li>
<li>
<p>è¿å¥åå±å¾ªç¯ï¼æ­¥é¿<span class="math inline">\(M\)</span>ï¼ï¼æ§è¡ç­ç¥çæ´æ°</p>
<ul>
<li>
<p>éæ ·ä»»å¡ä¸æ§ç­ç¥ï¼ä»ä»»å¡æç¤ºé <span class="math inline">\(D\)</span>ä¸­éæ ·ä¸ä¸ªæ¹æ¬¡ <span class="math inline">\(D_b\)</span>, å°å½åç­ç¥æ¨¡å<span class="math inline">\(\pi_{\theta}\)</span>æå­ä¸ºæ§ç­ç¥ <span class="math inline">\(\pi_{\theta_{old}}\)</span>ï¼ç¨äºåç»­çæåéè¾åºï¼</p>
</li>
<li>
<p>çæåéè¾åºå¹¶è®¡ç®å¥å±ï¼å¯¹æ¹æ¬¡ä¸­æ¯ä¸ªä»»å¡qï¼ç¨æ§ç­ç¥æ§ç­ç¥ <span class="math inline">\(\pi_{\theta_{old}}\)</span>çæGä¸ªåéè¾åº <span class="math inline">\({\{o_1, o_2, ..., o_G\}}\)</span>ï¼ç¨å¥å±æ¨¡å $$r_{\theta}$$ä¸ºæ¯ä¸ªåéè¾åºè®¡ç®å¥å± <span class="math inline">\({\{r_1, r_2, ..., r_G\}}\)</span></p>
</li>
<li>
<p>è®¡ç®ç»ç¸å¯¹ä¼å¿ï¼ ç±å¬å¼ï¼8ï¼è®¡ç®ç¾¤ç»ç¸å¯¹ä¼å¿ $\hat{A}_{i,t} $</p>
</li>
<li>
<p>ä¼åç­ç¥æ¨¡åï¼å¬å¼ï¼9)ï¼10ï¼çæ¢¯åº¦æ´æ°ç­ç¥æ¨¡å<span class="math inline">\(\pi_{\theta}\)</span>çåæ°</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="53-grpoç®æ³çä¼ç¼ºç¹">5.3 GRPOç®æ³çä¼ç¼ºç¹</h2>
<p><strong>ä¼ç¹</strong>ï¼â  ç¨³å®æ§æ´å¼ºï¼æ éä¾èµä»·å¼å½æ°ï¼åªè¦å¥å±æ¨¡åè½ç¸å¯¹å¤æ­ç¾¤ä½åç­ç¥ä¼å£ï¼éä½å¯¹ä»·å¼ä¼°è®¡ç²¾åº¦çä¾èµéä½å¯¹ä»·å¼ä¼°è®¡ç²¾åº¦çä¾èµï¼æåç®æ³ç¨³å®æ§ï¼â¡ è®­ç»ææ¬æ´ä½ï¼æ²¡æäºCritic æ¨¡åï¼æ¾å­å ç¨åå°å¤§å¹éä½ï¼ç¸åç¡¬ä»¶å¯è®­ç»æ´å¤§æ¨¡åææ´å¤§batchï¼â¢ æå®ç°ä¸ééå¹¶è¡ï¼ç»ååç­ç¥å¯ç¬ç«ä¸ç¯å¢äº¤äºãæ¶éæ°æ®ï¼ä¾¿äºå©ç¨åå¸å¼æ¡æ¶å®ç°å¹¶è¡è®­ç»å éã</p>
<p><strong>ç¼ºç¹</strong>ï¼â å­å¨åºæåå·®ï¼å½ä¸åæåå¥½ç­ç­æ¡æåé¿éè¯¯è¾åºï¼ä¸æ åå·®å½ä¸åä½¿æ¨¡åä¼åä¼åç®åé®é¢ï¼å¥å±ç¨³å®ï¼ï¼å¿½è§é¾é¢ï¼å¥å±æ³¢å¨å¤§ï¼ ï¼â¡ ç®æ ä¸ä¸è´é®é¢ï¼å¥å±å½æ°éå¯¹å®æ´åºåæåï¼éç­å¾å®æ´åç­ï¼ï¼èGRPOä¼åç®æ çéè¦æ§éæ ·åºäºtokençº§å«è®¡ç®æå¤±ï¼ä¸¤èç®æ å­å¨åå·®ï¼â¢ é«æ¹å·®åä¸ç¨³å®é®é¢ï¼GRPO å¨ token çº§å«è®¡ç®éè¦æ§éæ ·æéï¼åä¸ªtokenåªè¢«éæ ·ä¸æ¬¡ï¼é¾ä»¥æ ¡æ­£åç¦»åå§ç­ç¥ç token åå¸ï¼æå¼å¥é«æ¹å·®åªå£°ï¼å¯¼è´æ¢¯åº¦ä¼°è®¡ä¸ç¨³å®ã</p>
<h1 id="6-gspo">6 GSPO</h1>
<p>è®ºææ é¢ï¼Group Sequence Policy Optimization</p>
<p>è®ºæå°åï¼<a href="https://arxiv.org/pdf/2507.18071" target="_blank" rel="noopener nofollow">https://arxiv.org/pdf/2507.18071</a></p>
<p><img alt="" loading="lazy" data-src="https://pcnzmyb3bo4o.feishu.cn/space/api/box/stream/download/asynccode/?code=Nzk5NmQ1NWY1YzgwZTFjM2YxZGY4YmZkNTk0YjhjYzhfOXY3TnhGQTdCeG8wN0xlcWhNSWhYWW5yWmppRXBmSUdfVG9rZW46SkEwUGI2OXAwb0xKMzF4d0NtS2NwNVg1bmJ3XzE3Njc5MzY0Nzc6MTc2Nzk0MDA3N19WNA" class="lazyload"></p>
<p>GSPO(Group Sequence Policy Optimizationï¼ç»åºåç­ç¥ä¼å)æ¨å¨è§£å³GRPOä¸­è®­ç»è¿ç¨ä¸­å­å¨çåºæåå·®ãç®æ ä¸ä¸è´ãé«æ¹å·®åä¸ç¨³å®çé®é¢ãGSPOå°RLä¸­éè¦æ§éæ ·çåä½ä»ä»¤ççº§å«æåè³æ´ä¸ªåºåçº§å«ï¼åå¼å¥äºåºåé¿åº¦å½ä¸åï¼ ç¡®ä¿ä¸åé¿åº¦çé®é¢äº«æå¬å¹³çä¼åå°ºåº¦ï¼ä»æ ¹æºè§£å³è®­ç»ç¨³å®æ§é®é¢ï¼å®ç¾éé MoE äºæ¶æã</p>
<h2 id="61-gspoçåçåè®­ç»è¿ç¨">6.1 GSPOçåçåè®­ç»è¿ç¨</h2>
<p>é¦åï¼æä»¬æ¥çä¸GRPOåGSPOçç®æ å½æ°</p>
<ul>
<li>GRPOç®æ å½æ°</li>
</ul>
<p><img alt="image" loading="lazy" data-src="https://img2024.cnblogs.com/blog/3719074/202601/3719074-20260109142311393-1595710452.png" class="lazyload"></p>
<p>å¶ä¸­ï¼<span class="math inline">\(ratio_t=\frac{\pi_\theta(o_{i,t} |q, o_{i,&lt;t})}{\pi_{old}(o_{i,t} |q, o_{i,&lt;t})}\)</span></p>
<ul>
<li>GSPOç®æ å½æ°</li>
</ul>
<p></p><div class="math display">\[ \begin{align}
J_{GSPO}(\theta) = E[x\sim D, {\{y_i}\}_{i=1}^G \sim \pi_{\theta_{old}(.|x)}] [
\frac{1}{G} \sum_{i=1}^G min (s_i(\theta) *\hat{A}_i, clip(s_i(\theta), 1-\varepsilon, 1+\varepsilon)*\hat{A}_i)]

\end {align} \]</div><p></p><p>å¶ä¸­ï¼<span class="math inline">\(s_i(\theta)=(\frac{\pi_\theta(y_i |x)}{\pi_{old}(y_i |x)}) ^{(\frac{1}{|y_i|})} = exp(\frac{1}{|y_i|} \sum_{t=1}^{|y_i|}log\frac{\pi_\theta(y_{i,t} |x, y_{i,&lt;t})}{\pi_{old}(y_{i,t} |x, y_{i,&lt;t})})\)</span> ï¼<span class="math inline">\(|y_i|\)</span>æ¯ååº<span class="math inline">\(y_i\)</span> çé¿åº¦ï¼é¿åº¦å½ä¸ åæ¯å³é®ï¼ç¡®ä¿ä¸åé¿åº¦åºåçéè¦æ§æ¯çå·æå¯æ¯æ§ï¼é²æ­¢æ¯çå åºåè¿é¿èå§çæ³¢å¨ãæ³¨æï¼è®ºæéä¸ºäºç®åï¼å¨å¬å¼ï¼11ï¼ä¸­æ²¡æå KLï¼å®éåºç¨ä¸­æ¯æç¨KLçã</p>
<p>éè¿å¯¹æ¯GRPOä¸GSPOçæ ¸å¿å¬å¼ï¼è½æ¸æ°çåºä¸¤èå¨éè¦æ§éæ ·åä½ä¸è®¡ç®é»è¾ä¸çå³é®å·®å¼ã</p>
<p>åçGRPOçç®æ å½æ°ï¼å¶å æä¼å¿çè®¡ç®æ ¸å¿èç¦äº<strong>tokençº§å«</strong>çï¼å¦<span class="math inline">\(ratio_t=\frac{\pi_\theta(o_{i,t} |q, o_{i,&lt;t})}{\pi_{old}(o_{i,t} |q, o_{i,&lt;t})}\)</span>, æç¤ºï¼éå¯¹ç¬¬ <span class="math inline">\(i\)</span>ä¸ªåºåä¸­çç¬¬<span class="math inline">\(t\)</span>ä¸ªtokenè¿è¡è¿ç®ã</p>
<p>ä¸¾ä¸ªç´è§ä¾å­ï¼è¥ä¸ä¸ªç»åå«5æ¡æ ·æ¬åºåï¼æ¯æ¡åºåæ20ä¸ªtokenï¼GRPOéè¦ä¸ºè¿5æ¡åºåçæ¯ä¸ä¸ªtokenåå«è®¡ç®å æä¼å¿ã</p>
<p>ä¸¤æ¬¡å¹³åæä½ï¼åå±åå¯¹åæ¡åºåç20ä¸ªtokenåå¹³åï¼å¤å±åå¯¹5æ¡ä¸ååºååå¹³åï¼<strong>æ¬è´¨å°±æ¯ç®æ¯å¹³å</strong>ï¼æç»å¾å°æ¢¯åº¦æ´æ°çææä¿¡å·ã</p>
<p>åçGSPOçç®æ å½æ°ï¼ä»å¬å¼<span class="math inline">\(s_i(\theta)=(\frac{\pi_\theta(y_i |x)}{\pi_{old}(y_i |x)}) ^{(\frac{1}{|y_i|})} = exp(\frac{1}{|y_i|} \sum_{t=1}^{|y_i|}log\frac{\pi_\theta(y_{i,t} |x, y_{i,&lt;t})}{\pi_{old}(y_{i,t} |x, y_{i,&lt;t})})\)</span>, å¯ä»¥çåºï¼å¶å æä¼å¿çè®¡ç®åä½ç´æ¥åçº§ä¸º<strong>åºåçº§å«ï¼</strong>åå±å¹³åç±ç®æ¯å¹³åæ¬åä¸ºäºå ä½å¹³åï¼å¤å±çè®¡ç®é»è¾ä¾ç¶ä¸åã</p>
<p>GSPOçè®­ç»è¿ç¨åGRPOåºæ¬ä¸è´ï¼å·®å«å¨äºç®æ å½æ°ä¸­éè¦æ§éæ ·è®¡ç®é»è¾ï¼è¿éä¸åè¿å¤è§£éã</p>
<h2 id="62-gspoçä¼ç¼ºç¹">6.2 GSPOçä¼ç¼ºç¹</h2>
<p><strong>ä¼ç¹</strong>ï¼â  æåè®­ç»ç¨³å®æ§ï¼GRPO å¨ token çº§è¿è¡éè¦æ§éæ ·æ¶ï¼è¥ææ¶é´æ­¥çæéè¯¯ tokenï¼æ­¤æ¶ä¼å¿ä¸º <span class="math inline">\(A\_t &lt;0\)</span>ï¼æ§ç­ç¥çæè¯¥ token çæ¦çæä½ï¼å¦<span class="math inline">\(1e^{-8}\)</span>ï¼ï¼æ°ç­ç¥çææ¦çå³ä½¿ä»ä¸º 0.001ï¼éè¦æ§æ¯å¼ä¹ä¼é£åè³ <span class="math inline">\(10^5\)</span>ï¼éè¿å¬å¼(9) (10)åç°ï¼å¨<span class="math inline">\(A_t &lt;0\)</span>æåµä¸ï¼è¿ä¹å¤§çéè¦æ§æ¯å¼ä¸ä¼è¢«è£åªï¼è¿èé ææå¤±å½æ°çå¤§æ³¢å¨ï¼åªå£°ä¼ä¸æ­ç´¯ç§¯ï¼çè³æ¨¡åä¼è®­å´©ãè GSPO ä»¥åºåä¸ºåä½è®¡ç®éè¦æ§éæ ·æ¯å¼ï¼å³ä¾¿ä¸ªå« tokençéè¦æ§æ¯å¼é£åï¼ç»è¿å ä½å¹³åå(ç»è¿Logè¿ç®ãç®æ¯å¹³åãææ°è¿ç®)ï¼ä¹ä¼è¢«å¹³æ»ï¼ä¸ä¼é ææ¯å¼çå¤§å¹æ³¢å¨ï¼ä»èé¿åäºæå¤±å½æ°çéè¡ï¼ä¿éäºè®­ç»ç¨³å®æ§ï¼â¡ éé MoE æ¶ææ¨¡åï¼GRPO éç¨ token çº§éè¦æ§éæ ·ï¼éä¾èµè·¯ç±éæ¾ç­æå·§æè½ç¨³å®è®­ç»ï¼è GSPO åºäºåºåçº§è®¡ç®éè¦æ§éæ ·ï¼æ éè¿ç±»å¤ææä½å³å¯å®ç° MoE æ¨¡åçç¨³å®è®­ç»ï¼å¤§å¹ç®åäºè®­ç»æµç¨ï¼åæ¶éæ¾äº MoE æ¨¡åçæ½åã</p>
<p><strong>ç¼ºç¹</strong>ï¼â  è®¡ç®å¤æåº¦åé«ï¼ç¸æ¯ GRPO ç token çº§éè¦æ§éæ ·ï¼GSPO åæ¢ä¸ºåºåçº§è®¡ç®åï¼ç®æ³çå®ç°é¾åº¦ä¸è®¡ç®ææ¬ææå¢å ã</p>
<h1 id="7-åèèµæ">7 åèèµæ</h1>
<p><a href="https://zhuanlan.zhihu.com/p/1932791271363154917" target="_blank" rel="noopener nofollow">https://zhuanlan.zhihu.com/p/1932791271363154917</a></p>
<p><a href="https://mp.weixin.qq.com/s/gSUw8bXraKy0RzVU_Crwcw" target="_blank" rel="noopener nofollow">https://mp.weixin.qq.com/s/gSUw8bXraKy0RzVU_Crwcw</a></p>
<p><a href="https://arxiv.org/pdf/1706.03741" target="_blank" rel="noopener nofollow">https://arxiv.org/pdf/1706.03741</a></p>
<p><a href="https://arxiv.org/pdf/2305.18290" target="_blank" rel="noopener nofollow">https://arxiv.org/pdf/2305.18290</a></p>
<p><a href="https://arxiv.org/pdf/2402.03300" target="_blank" rel="noopener nofollow">https://arxiv.org/pdf/2402.03300</a></p>
<p><a href="https://arxiv.org/pdf/2507.18071" target="_blank" rel="noopener nofollow">https://arxiv.org/pdf/2507.18071</a></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-09 14:29">2026-01-09 14:29</span>&nbsp;
<a href="https://www.cnblogs.com/aifrontiers">AI-Frontiers</a>&nbsp;
éè¯»(<span id="post_view_count">33</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19461279);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19461279', targetLink: 'https://www.cnblogs.com/aifrontiers/p/19461279', title: 'å°ç½ä¹è½çæçLLM-RLç®æ³ï¼PPO/DPO/GRPO/GSPO' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å¹²æ Claude Codeï¼è¿ä¸ªå¼æº AI ç¼ç¨å·¥å·æç¯äºï¼ ]]></title>
    <link>https://www.cnblogs.com/yupi/p/19460549</link>
    <guid>149209251423a058de9db3e6369e570d</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/yupi/p/19460549" title="åå¸äº 2026-01-09 11:30">
    <span role="heading" aria-level="2">å¹²æ Claude Codeï¼è¿ä¸ªå¼æº AI ç¼ç¨å·¥å·æç¯äºï¼</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        <img src="https://img2024.cnblogs.com/blog/2225420/202601/2225420-20260109111409828-677596839.png" alt="å¹²æ Claude Codeï¼è¿ä¸ªå¼æº AI ç¼ç¨å·¥å·æç¯äºï¼" class="desc_img">
        æè¿æèº«è¾¹å¾å¤ç¨åºåæåå¼å§ä» Claude Code è½¬åäºå¦ä¸ä¸ªå·¥å·ï¼æ­£æ¯çªç¶å¤§ç«çå¼æºé¡¹ç® OpenCodeã
    </div>
<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p class="md-end-block md-heading"><span class="md-plain">å¤§å®¶å¥½ï¼ææ¯ç¨åºåé±¼ç®ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">Claude Code ä¸ç´æ¯å¤§å®¶å¬è®¤ç AI ç¼ç¨å½ä»¤è¡å·¥å· Top 1ï¼å¨ AI åç¨åºååå­éå ä¹æ¯ç¥ä¸è¬çå­å¨ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/happy-new-year-claude-coders-v0-o2quvbl99lag1.png"><img data-src="https://pic.yupi.icu/1/happy-new-year-claude-coders-v0-o2quvbl99lag1.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½æ¯ï¼è¿çç©æå¿å¯¹ä¸­å½ç¨æ·å¯ä¸å¤ªåå¥½â¦â¦</span></p>
<p class="md-end-block md-p"><span class="md-plain">é¦åï¼å¦æä½ æ³è¦ä½¿ç¨ Claude Codeï¼å°±å¿é¡»è¦æç¹æ®çç½ç» + å®æ¹è´¦å·ï¼å¦åå°±ä¼çå°ä¸ççº¢ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/cannotuseclaude.png"><img data-src="https://pic.yupi.icu/1/cannotuseclaude.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">æ­¤å¤ï¼2025 å¹´ 9 æï¼Anthropic å¬å¸ä¸ç¥éæ½ä»ä¹é£ï¼çªç¶å®£å¸ <span class="md-pair-s "><strong>å¨é¢ç¦æ­¢ä¸­å½æ§è¡ä¼ä¸ä½¿ç¨ Claude æå¡</strong><span class="md-plain">ï¼ä¸ä»åæ¬ä¸­å½å¤§éä¼ä¸ï¼è¿æµ·å¤ä¸­èµæ§è¡è¶è¿ 50% çå¬å¸é½å¨å°ç¦èå´åï¼</span></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">çè³ Anthropic è¿ç¹å«ç¹åäºä¸­å½ï¼æå±ä»¬ç§°ä¸º <span class="md-pair-s "><strong>æå¯¹å½å®¶</strong><span class="md-plain">ï¼</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20250905164631315.png"><img data-src="https://pic.yupi.icu/1/image-20250905164631315.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">å¤©ä¸è¦ Claude Code ä¹ç£ï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½æ¯æè¿æèº«è¾¹å¾å¤ç¨åºåæåå¼å§ä» Claude Code è½¬åäºå¦ä¸ä¸ªå·¥å·ï¼æ­£æ¯çªç¶å¤§ç«çå¼æºé¡¹ç® OpenCodeã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107174223010.png"><img data-src="https://pic.yupi.icu/1/image-20260107174223010.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">è¿ç©æåªç¨äºåå¹´çæ¶é´ï¼å°±å¨ GitHub ä¸æ¶¨å°äº 5.2w Starï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">è¿æ¯ä¸ªä»ä¹æ¦å¿µï¼æ¯æå¨ GitHub ä¸å¼æºçå åä¸ªé¡¹ç®çæ»åå èµ·æ¥é½å¤ï¼æäºæäºâ¦â¦</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/opencodestarhistory.png"><img data-src="https://pic.yupi.icu/1/opencodestarhistory.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">OpenCode å°åºæ¯ä»ä¹ï¼å­ä»ä¹è¿ä¹ç«ï¼</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">å¥æ¯ OpenCodeï¼</span></h2>
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://opencode.ai/" rel="noopener nofollow"><span class="md-plain">OpenCode</span></a><span class="md-plain"> æ¯ä¸æ¬¾ 100% å¼æºç AI ç¼ç¨å½ä»¤è¡å·¥å·ï¼å¯ä»¥å¨ <span class="md-pair-s "><strong>ç»ç«¯ãIDEãçè³æ¡é¢åºç¨</strong><span class="md-plain"> ä¸­ä½¿ç¨ã</span></span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/screenshot.png"><img data-src="https://pic.yupi.icu/1/screenshot.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ å¯è½ä¼é®ï¼è¿ç©æå¿è· Claude Code æå¥åºå«ï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">è¯è¯ä¸å°±ç¥éäºï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">æ¥ä¸æ¥æå¸¦å¤§å®¶å®æä¸ä¸ï¼ä»é¶å¼å§å®è£ãéç½®ãå°å®éåä»£ç ï¼ä¸æ¡é¾æå¡~</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">ä» 0 å¼å§ä¸æ OpenCode</span></h2>
<h3 class="md-end-block md-heading"><span class="md-plain">1ãå®è£è¿è¡ OpenCode</span></h3>
<p class="md-end-block md-p"><span class="md-plain">ç´æ¥è¿å¥ OpenCode å®ç½ï¼å¤å¶ä¸è¡å½ä»¤ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107174407894.png"><img data-src="https://pic.yupi.icu/1/image-20260107174407894.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">å½ä»¤å¦ä¸ï¼</span></p>
<pre class="md-fences md-end-block ty-contain-cm modeLoaded"><span><span class="cm-builtin">curl&nbsp;<span class="cm-attribute">-fsSL&nbsp;https://opencode.ai/install |&nbsp;<span class="cm-builtin">bash</span></span></span></span></pre>
<p class="md-end-block md-p"><span class="md-plain">ç¶åå¨ç»ç«¯ä¸­æ§è¡ï¼å°±å¯ä»¥å®æå®è£äºã</span></p>
<p class="md-end-block md-p"><span class="md-plain">å®è£å®æä¹åï¼è¾å¥ <span class="md-pair-s"><code>opencode</code><span class="md-plain"> è¿å¥ç¨åºï¼æ¥ä¸æ¥ä½ å°±å¯ä»¥æå¿«å°ä½¿ç¨äº~</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107174646918.png"><img data-src="https://pic.yupi.icu/1/image-20260107174646918.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">åæ¥ä¸ªç»å¸ç Hello Worldï¼AI æåç»åºäºåå¤ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107174755331.png"><img data-src="https://pic.yupi.icu/1/image-20260107174755331.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">æ­åï¼å°è¿éä½ å·²ç»ææ¡äº OpenCode ç 70% äºã</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h3 class="md-end-block md-heading"><span class="md-plain">2ãéæ©æ¨¡å¼åæ¨¡å</span></h3>
<p class="md-end-block md-p"><span class="md-plain">OpenCode æ¯æ 2 ç§æ¨¡å¼ï¼é»è®¤æ¯ Build æ¨¡å¼ï¼ç¨æ¥æå»ºåºç¨ãçæä»£ç ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">æä¸ä¸ Tab é®ï¼å°±å¯ä»¥åæ¢å° Plan æ¨¡å¼ï¼ç¨äºçææ§è¡è®¡åã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107174952823.png"><img data-src="https://pic.yupi.icu/1/image-20260107174952823.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">æä¸ä¸ <span class="md-pair-s"><code>Ctrl + p</code><span class="md-plain"> é®ï¼å¯ä»¥æå¼å½ä»¤é¢æ¿ï¼éé¢æå åä¸ªåç½®å½ä»¤ãæä»¬åæ¥è¯çåæ¢ä¸ä¸å¤§æ¨¡åï¼</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107175255527.png"><img data-src="https://pic.yupi.icu/1/image-20260107175255527.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">é»è®¤æä¾äº 4 ä¸ªåè´¹æ¨¡åï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107175409282.png"><img data-src="https://pic.yupi.icu/1/image-20260107175409282.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">å¥½å®¶ä¼ï¼è¿æºè°±ææ°ç GLM-4.7 ç«ç¶ä¹åè´¹ï¼é£æç Coding Plan å¥é¤ä¸æ¯ç½å¼äºï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107175513490.png"><img data-src="https://pic.yupi.icu/1/image-20260107175513490.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">é¤äºåè´¹çæ¨¡åå¤ï¼OpenCode æ¯æè¶å¤ç AI æ¨¡åï¼ä½ å¯ä»¥èªç±éæ©ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107175614359.png"><img data-src="https://pic.yupi.icu/1/image-20260107175614359.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">éä¸­æ¨¡ååï¼éç½®èªå·±ç API Key å°±å¥½äºï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107175657296.png"><img data-src="https://pic.yupi.icu/1/image-20260107175657296.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">å¦æä½ ä¹åæ <span class="md-pair-s "><strong>Claude Pro/Max è®¢éè´¦å·</strong><span class="md-plain">ï¼å¯ä»¥ç´æ¥ç»å½ä½¿ç¨ï¼æ ç¼ä» Claude Code è¿ç§»è¿æ¥ã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107175745963.png"><img data-src="https://pic.yupi.icu/1/image-20260107175745963.png" class="lazyload"></span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h3 class="md-end-block md-heading"><span class="md-plain">3ãå¿«æ·æä»¤</span></h3>
<p class="md-end-block md-p"><span class="md-plain">OpenCode æ¯æææ å½ä»¤ï¼è¾å¥ <span class="md-pair-s"><code>/</code><span class="md-plain">ï¼è½çå°å¾å¤æä½ï¼æ¯å¦æ¥çæ¨¡ååè¡¨ãæ¥ç Agentsãç®¡ç MCPãåæ¢ä¸»é¢ç­ç­ï¼</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107175926346.png"><img data-src="https://pic.yupi.icu/1/image-20260107175926346.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">æ¯æå åä¸ªä¸åçä¸»é¢ï¼é¢å¼é½æºé«çï¼ä»è¿ç¹ä¹è½çåºæ¥ OpenCode å¾æ³¨éç¨æ·çä½éªï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107180108430.png"><img data-src="https://pic.yupi.icu/1/image-20260107180108430.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">è¾å¥ <span class="md-pair-s"><code>@</code><span class="md-plain"> å¯ä»¥å¿«éå³èç®å½æä»¶ï¼ç» AI æ·»å ä¸ä¸æï¼ </span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107182710150.png"><img data-src="https://pic.yupi.icu/1/image-20260107182710150.png" class="lazyload"></span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h3 class="md-end-block md-heading"><span class="md-plain">4ãäº¤äºä½éª</span></h3>
<p class="md-end-block md-p"><span class="md-plain">ç¸æ¯äº Claude Codeï¼OpenCode çæ¯æå½ä»¤è¡çäº¤äºä½éªææ»¡äºï¼çè³æè§å¾å®æ¯ä¸ä¸ªä¼ªè£æå½ä»¤è¡çæ¡é¢åºç¨ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ å¯ä»¥ç¹å»ææ¡æ¶æ¯ï¼ç¶åä¼å¼¹åºä¸ä¸ªæ¶æ¯å¨ä½æ¡ï¼ä½ å¯ä»¥æ¤åæ¶æ¯å AI çåå¤ï¼ä¹å¯ä»¥å¤å¶ãæèåºäºå½åå¯¹è¯æ°å¼ä¸ä¸ªå¯¹è¯æ¡ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107180609525.png"><img data-src="https://pic.yupi.icu/1/image-20260107180609525.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ å¯ä»¥éè¿é¼ æ ä¸ä¸æ»å¨æ¥åæ¢éåï¼å¹¶ä¸å¯ä»¥ç´æ¥éè¿é¼ æ ç¹å»è¿å¥ä¸ä¸æ­¥ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½ å¯ä»¥æ <span class="md-pair-s"><code>Ctrl + p</code><span class="md-plain"> é®æå¼å½ä»¤é¢æ¿ï¼ç¶åå¼å¯ä¾§è¾¹æ ï¼</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107181100523.png"><img data-src="https://pic.yupi.icu/1/image-20260107181100523.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ç¶åçé¢å°±åæäºè¿æ ·ï¼ä½ ç®¡è¿å«å½ä»¤è¡ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107181218259.png"><img data-src="https://pic.yupi.icu/1/image-20260107181218259.png" class="lazyload"></span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h3 class="md-end-block md-heading"><span class="md-plain">5ãLSP æ¯æ</span></h3>
<p class="md-end-block md-p"><span class="md-plain">ç»å¿çä½ ä¸å®çå°äºï¼å³è¾¹çä¾§è¾¹æ æä¸ª <span class="md-pair-s"><code>LSP</code><span class="md-plain">ï¼è¿æ¯ä»ä¹é¬¼ä¸è¥¿ï¼èè²æ¹ï¼</span></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">LSPï¼Language Server Protocol è¯­è¨æå¡å¨åè®®ï¼æ¯å¾®è½¯å¼åçä¸ç§éä¿¡åè®®ï¼ç¨äºè®©ä»£ç ç¼è¾å¨åè¯­è¨æå¡å¨ä¹é´è¿è¡éä¿¡ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">ç®åæ¥è¯´ï¼<span class="md-pair-s "><strong>LSP å°±æ¯è®©ç¼è¾å¨çæä»£ç çææ¯ã</strong></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">æ¯å¦ä½ å¨ VS Code éåä»£ç ï¼è¾å¥ <span class="md-pair-s"><code>console.</code><span class="md-plain"> å®ä¼èªå¨æç¤º <span class="md-pair-s"><code>log</code><span class="md-plain">ãç¹å»å½æ°åè½è·³è½¬å°ä»£ç å®ä¹ãåéä»£ç ä¼ç»çº¢çº¿æéãè¿äºä»£ç ç¼è¾å¨çåè½ï¼èåé½æ¯ LSP å¨å¹²æ´»ã</span></span></span></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">OpenCode æ¯æ LSPï¼æå³ç AI è½çæ­£çè§£ä½ çä»£ç ç»æï¼èä¸æ¯æä»£ç å½æ®éæå­ççï¼æ¹èµ·æ¥æ´ç²¾åã</span></p>
<p class="md-end-block md-p"><span class="md-plain">æ¯å¦æè®© AI ä»ç»æç AI ç­é¢å¹³å°é¡¹ç®ä¸­ææä»·å¼çä»£ç ï¼LSP å°±æ´¾ä¸ç¨åºäºãå®è½å¸® AI å¿«éå®ä½ææ®µä»£ç å¨åªéè¢«è°ç¨ãå¼ç¨äºåªäºåéï¼èä¸æ¯è®© AI å»å»å°å¨å±æç´¢ææ¬ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107181807464.png"><img data-src="https://pic.yupi.icu/1/image-20260107181807464.png" class="lazyload"></span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h3 class="md-end-block md-heading"><span class="md-plain">6ãåå°ä¹åçä¼è¯</span></h3>
<p class="md-end-block md-p"><span class="md-plain">å¦æä½ ä¸å°å¿å³é­äº OpenCodeï¼ä¸ç¨æå¿ï¼å¯ä»¥æå¼å½ä»¤é¢æ¿ï¼éä¸­ âSwitch sessionâ åæ¢ä¼è¯ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107183241477.png"><img data-src="https://pic.yupi.icu/1/image-20260107183241477.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">å°±è½åå°ä¹åçèå¤©äºï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107183320692.png"><img data-src="https://pic.yupi.icu/1/image-20260107183320692.png" class="lazyload"></span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">æ¡é¢ç OpenCode</span></h2>
<p class="md-end-block md-p"><span class="md-plain">å³ä½¿ OpenCode æ¯æäºè¿ä¹å¤æ¹è¿ç¨æ·ä½éªçäº¤äºï¼ä½æä¼°è®¡å¤§å¤æ°åå­¦è¿æ¯ä¸åæ¬¢å°é»æ¡çã</span></p>
<p class="md-end-block md-p"><span class="md-plain">æ²¡å³ç³»ï¼OpenCode è¿æä¾äºæ¡é¢åºç¨çæ¬ï¼macOSãWindowsãLinux å¨ç«¯æ¯æï¼è¿æ¯ççè¦å·æ­» Claude Code çèå¥åâ¦â¦</span></p>
<blockquote>
<p class="md-end-block md-p"><span class="md-plain">æè·¯ï¼<span class="md-link md-pair-s"><a href="https://opencode.ai/download" rel="noopener nofollow">https://opencode.ai/download</a></span></span></p>
</blockquote>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107182151987.png"><img data-src="https://pic.yupi.icu/1/image-20260107182151987.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä¸è¿å½ææçæ»¡èç­è¡å®è£å¹¶æå¼å®æ¶ï¼ç«ç¶æ¥éäºï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107183123854.png"><img data-src="https://pic.yupi.icu/1/image-20260107183123854.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ç»è¿ä¸çªææ¥ï¼åç°åæ¥æ¯æå¼äºä»£çï¼å³é­ä¹åå°±æ­£å¸¸è¿è¡äºã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107183605119.png"><img data-src="https://pic.yupi.icu/1/image-20260107183605119.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä½æ¯ç¨æ¯äº Cursorï¼è¿ä¸ªäº¤äºä½éªççæç¹æ·è¡äºï¼ä¸æ¨èå¤§å®¶ä½¿ç¨ã</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">OpenCode æ©å±è½å</span></h2>
<p class="md-end-block md-p"><span class="md-plain">å°ç®åä¸ºæ­¢ï¼æè§å¾ OpenCode å¨åç«¯ç¨æ·ä½éªä¸å¨æ¹é¢ç¢¾å Claude Codeï¼èä¸ OpenCode å®å¨å¼å®¹ Claude Code ç Skills ç³»ç»ï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">Skills æ¯ä¸ç§ç» AI åå¤çè½åæ©å±åãä½ å¯ä»¥æå®çè§£æç»æ°åäºåå¤çå·¥ä½äº¤æ¥ææ¡£ï¼éé¢åå«ä»»å¡æ§è¡æ¹æ³ãå·¥å·ä½¿ç¨è¯´æãæ¨¡æ¿ç´ æç­ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">æ¯å¦ä½ å¯ä»¥åå»ºä¸ä¸ª <span class="md-pair-s"><code>å¬å¸ä»£ç è§è Skill</code><span class="md-plain">ï¼æä»£ç é£æ ¼ãå½åè§åãæ³¨éè¦æ±ç­åè¿å»ãä¹å Claude Code çæçä»£ç å°±ä¼èªå¨éµå¾ªè¿äºè§èï¼ä¸ç¨æ¯æ¬¡é½éå¤è¯´æã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">æ ¹æ®å®æ¹ææ¡£ï¼OpenCode ä¼èªå¨æç´¢è¿äºä½ç½®ç Skillsï¼</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-pair-s"><code>.opencode/skill/&lt;name&gt;/SKILL.md</code><span class="md-plain">ï¼é¡¹ç®ç®å½ï¼</span></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-pair-s"><code>~/.config/opencode/skill/&lt;name&gt;/SKILL.md</code><span class="md-plain">ï¼ç¨æ·ç®å½ï¼</span></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-pair-s"><code>.claude/skills/&lt;name&gt;/SKILL.md</code><span class="md-plain">ï¼Claude Code å¼å®¹ï¼</span></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-pair-s"><code>~/.claude/skills/&lt;name&gt;/SKILL.md</code><span class="md-plain">ï¼Claude Code å¼å®¹ï¼</span></span></p>
</li>
</ul>
<p class="md-end-block md-p"><span class="md-plain">ä¹å°±æ¯è¯´ï¼å¦æä½ ä¹åç» Claude Code åå»ºè¿èªå®ä¹ Skillsï¼ç´æ¥æ¿è¿æ¥å°±è½ç¨ï¼åæ¯æ ç¼è¿ç§»ã</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">Oh My OpenCode å¼ææä»¶</span></h2>
<p class="md-end-block md-p"><span class="md-plain">å¦æä½ è§å¾ OpenCode è¿ä¸å¤å¼ºï¼å¯ä»¥è¯è¯ <span class="md-pair-s"><code>Oh My OpenCode</code><span class="md-plain"> è¿ä¸ªå¼æºç OpenCode å¢å¼ºæä»¶ï¼å·²ç» 1w Star äºã</span></span></span></p>
<blockquote>
<p class="md-end-block md-p"><span class="md-plain">é¡¹ç®å°åï¼<span class="md-link md-pair-s"><a href="https://github.com/code-yeongyu/oh-my-opencode" rel="noopener nofollow">https://github.com/code-yeongyu/oh-my-opencode</a></span></span></p>
</blockquote>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107184457429.png"><img data-src="https://pic.yupi.icu/1/image-20260107184457429.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">è¿ä¸ªæä»¶æå¤çï¼ççç¨æ·è¯ä»·ï¼</span></p>
<blockquote>
<p class="md-end-block md-p"><span class="md-plain">"It made me cancel my Cursor subscription."ï¼å®è®©æåæ¶äº Cursor è®¢éï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">"Knocked out 8000 eslint warnings with Oh My Opencode, just in a day"ï¼ä¸å¤©åç¨å®è§£å³äº 8000 ä¸ª eslint è­¦åï¼</span></p>
</blockquote>
<p class="md-end-block md-p">&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">Oh My OpenCode çæ ¸å¿åè½æ¯å¼å¥äºä¸ä¸ªå« <span class="md-pair-s "><strong>Sisyphus</strong><span class="md-plain"> çæºè½ä½ç¼æç³»ç»ã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">æç¹å°å»æäºä¸ä¸ï¼</span></p>
<blockquote>
<p class="md-end-block md-p"><span class="md-plain">è¥¿è¥¿å¼æ¯ï¼Sisyphusï¼æ¯å¤å¸èç¥è¯ä¸­ä¸ä½å æ¬ºéªä¼ç¥ãæææå¨èè¢«è¯¸ç¥æ©ç½çå½çï¼ä»çæ©ç½æ¯æ°¸æ æ­¢å¢å°å°ä¸åå·¨ç³æ¨ä¸å±±é¡¶ï¼èç³å¤´ä¸å°å±±é¡¶ä¾¿ä¼æ»è½ï¼å¦æ­¤å¨èå¤å§ï¼è±¡å¾çå¾å³æ åãæ°¸æ ä¼æ­¢çä»»å¡ï¼ä¹ä»£è¡¨çä¸ç§å¯¹èè¯å½è¿çæäºç²¾ç¥ã</span></p>
</blockquote>
<p class="md-end-block md-p"><span class="md-plain">è¿ä¸ªç³»ç»å¯ä»¥ï¼</span></p>
<ol class="ol-list" start="">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">å¹¶è¡è°åº¦å¤ä¸ª AI æ¨¡åï¼æ¯å¦è®© GPT debug çåæ¶è®© Gemini ååç«¯</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">èªå¨ä»»å¡ç®¡çï¼ä¸å®æä»»å¡ä¸è®©åï¼åè¥¿è¥¿å¼æ¯æ¨ç³å¤´ä¸æ ·é²èä¸è</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">æºè½ä»£ç å®¡æ¥ï¼èªå¨æ£æµå¹¶æ¸ç AI çæçåä½æ³¨é</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">LSP æ·±åº¦éæï¼æä¾éå½åãè·³è½¬å®ä¹ç­ IDE çº§åè½</span></p>
</li>
</ol>
<p class="md-end-block md-p"><span class="md-plain">ç®åæ¥è¯´ï¼Sisyphus å°±æ¯ä¸ä¸ª AI çå·¥ï¼å®è½åæ¶ææ¥å¤ä¸ª AI æ¨¡åå¹²æ´»ï¼è¿ä¼ç¯çå®ä»¬æä»»å¡åå®ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/omo.png"><img data-src="https://pic.yupi.icu/1/omo.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">è½ç¶å®æ¹è¯´ç¨ä¸è¡å½ä»¤å°±è½å®æå®è£ï¼ä½æå»ºè®®ä½ åå®è£ bunï¼åæ§è¡ npx æ¥å®è£ï¼å¦åå¯è½ä¼æ¥éã</span></p>
<pre class="md-fences md-end-block ty-contain-cm modeLoaded"><span><span class="cm-builtin">npm&nbsp;install bun&nbsp;<span class="cm-attribute">-g<br><span>npx oh-my-opencode install</span></span></span></span></pre>
<p class="md-end-block md-p"><span class="md-plain">å®è£è¿ç¨ä¸­ï¼å¯è½ä¼é®ä½ ææ²¡ææäºæ¨¡åçè®¢éï¼æåæ­£å¥é½æ²¡æï¼ä¸ç´é "No" å°±è¡äºï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107185251337.png"><img data-src="https://pic.yupi.icu/1/image-20260107185251337.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">å®è£å®æåï¼åæ¬¡è¿å¥ OpenCodeï¼ä¹ååªéè¦å¨ä½ çæç¤ºè¯éå ä¸ <span class="md-pair-s"><code>ultrawork</code><span class="md-plain">ï¼æ <span class="md-pair-s"><code>ulw</code><span class="md-plain">ï¼è¿ä¸ªå¼æåè¯­ï¼å°±è½æ¿æ´»å¨é¨å¢å¼ºåè½ãèªå¨è°åº¦å¤ä¸ª AI æ¨¡ååæ¶å·¥ä½ãæ·±åº¦æ¢ç´¢ä»£ç åºãé²èä¸èå°æ§è¡ã</span></span></span></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä¸é¢æä»¬è¯è¯çï¼æ­£å¥½æ¥éªè¯ä¸ä¸ OpenCode åé¡¹ç®çè½åå¦ä½ï¼è½ä¸è½æ Claude Code ä¸èè¸¹é£ï¼</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">å®æé¡¹ç® - ç¨ OpenCode åä¸ª AI å¥åº·å©æ</span></h2>
<p class="md-end-block md-p"><span class="md-plain">æè¿èèéå¢ç <span class="md-pair-s"><code>èèé¿ç¦</code><span class="md-plain"> AI å¥åº·å©æç«äºï¼å°éå£ãå¬å¸æ¥¼ä¸ççµè§å¹¿åä¸­éå¤å¯è§ä½çèå¸çèº«å½±ã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/mayiafuad.jpeg"><img data-src="https://pic.yupi.icu/1/mayiafuad.jpeg" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">è½ç¶æè¿æ²¡æç¨è¿å®ï¼ä½æ¯å¬è¯´å®å¯ä»¥éè¿æç®è¤ãææ¥åæä¾ AI åè¯ï¼è¿è½æºè½åç­å»å­¦ç§æ®åæ²»çå»ºè®®ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">é£æä»¬ä¹æ¥åä¸ªç±»ä¼¼çå¥åº·å°å©æç½ç«å§ï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">åæèèé¿ç¦ï¼ä»æé±¼ç®é¿å¤ã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107194117758.png"><img data-src="https://pic.yupi.icu/1/image-20260107194117758.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ååæä¸ä¸ï¼æä»¬è¦åçæ¯åå«åç«¯ + åç«¯çå¨æ é¡¹ç®ï¼èä¸åç«¯è¿éè¦è°ç¨ AI å¤§æ¨¡åæ¥çæåå®¹ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">è¿éæéæ©ç¨ <span class="md-pair-s "><strong>Vercel AI Gateway</strong><span class="md-plain"> æ¥å®ç° AI è½åï¼è¿æ¯ä¸æ¬¾ç®åæç¨ç AI ç½å³ã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1760687990497-90720fbb-0df6-4ede-87b8-64b8702994e9-20251028181254840.png"><img data-src="https://pic.yupi.icu/1/1760687990497-90720fbb-0df6-4ede-87b8-64b8702994e9-20251028181254840.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä»ä¹æ¯ AI ç½å³ï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">ç®åæ¥è¯´ï¼å®å°±åæ¯ç«è½¦ç«çæ£ç¥¨å£ï¼ä½ çåºç¨åæ¥çè¯·æ±åç»è¿ç½å³ï¼ç½å³å¸®ä½ å¤çè®¤è¯ãéæµãçæ§ç­ä¸ç³»åå¤æçæä½ï¼ç¶åæè¯·æ±è½¬åç» AI å¤§æ¨¡åã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1761645642401-683e786e-3e06-420a-abce-cd43f7bfa901.png"><img data-src="https://pic.yupi.icu/1/1761645642401-683e786e-3e06-420a-abce-cd43f7bfa901.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">èä¸ Vercel AI Gateway æ¯æå¯¹æ¥ 500 å¤ä¸ªå¤§æ¨¡åï¼è¿æåè´¹é¢åº¦ï¼éå¸¸éåå­¦ä¹ åå°é¡¹ç®ã</span></p>
<blockquote>
<p class="md-end-block md-p"><span class="md-plain">æè·¯ï¼<span class="md-link md-pair-s"><a href="https://vercel.com/ai-gateway" rel="noopener nofollow">https://vercel.com/ai-gateway</a></span></span></p>
</blockquote>
<p class="md-end-block md-p">&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">1ï¼é¦åä½ éè¦æ³¨åç»å½ Vercelï¼ç¶åå¨æ§å¶å°åå»º API Keyï¼æ³¨æä¸è¦æ³é²å¦ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/1760688078133-7b91b6f3-2fc4-4bb4-b2c1-d517699f0968-20251028181254879.png"><img data-src="https://pic.yupi.icu/1/1760688078133-7b91b6f3-2fc4-4bb4-b2c1-d517699f0968-20251028181254879.png" class="lazyload"></span></p>
<p class="md-end-block md-p">&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">2ï¼å¯å¨ OpenCodeï¼åæ¢æ¨¡åå°ç¼ç¨è½åå¾å¼ºãå¹¶ä¸åè´¹ç GLM-4.7ï¼ç¶åè¾å¥è¿æ®µæç¤ºè¯ï¼</span></p>
<pre class="md-fences md-end-block ty-contain-cm modeLoaded"><span>ä½ æ¯ä¸ä½ä¸ä¸çç¨åºåï¼è¯·å¸®æå¼åãæ¯æ¥å¥åº·å°å©æãç½ç«ï¼ç¨æ·å¯ä»¥éè¿å AI èå¤©æ¥è®°å½åç®¡çæ¯æ¥å¥åº·ç¶æã<br><span><span>â<br><span><span class=" cm-header cm-header2">## å¼åè¦æ±<br><span><span>â<br><span><span class="cm-block-start cm-variable-2">1.&nbsp;<span class="cm-variable-2">éè¦åå«å®æ´çåç«¯ååç«¯ï¼åç«¯ä½¿ç¨ Node.js<br><span><span class="cm-block-start cm-variable-2">2.&nbsp;<span class="cm-variable-2">ä½¿ç¨ Vercel ç AI Gateway å®ç° AI è½åï¼éè¦åéè¿å®æ¹ææ¡£æ¥è·åç¨æ³ï¼https://vercel.com/docs/ai-gateway/getting-started<br><span><span class="cm-block-start cm-variable-2">3.&nbsp;<span class="cm-variable-2">ä»¥å®ææ ¸å¿åè½ä¸ºç®æ ï¼ç¡®ä¿é¡¹ç®å¯ä»¥æ­£å¸¸è¿è¡<br><span><span class="cm-block-start cm-variable-2">4.&nbsp;<span class="cm-variable-2">æ´ä½ç½ç«çé¢éç¨æ¸æ°çç»¿è²å¥åº·é£æ ¼ï¼ååºå¼ééåç§å°ºå¯¸çè®¾å¤<br><span><span class="cm-block-start cm-variable-2">5.&nbsp;<span class="cm-variable-2">AI éè¦ä¸»å¨è¯¢é®ç¨æ·çå¥åº·ç¶åµï¼æ¯å¦ç¡ç ãè¿å¨ãé¥®é£ç­</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p class="md-end-block md-p"><span class="md-plain">ç¹å»åéåï¼OpenCode ä¼èªå¨ä½¿ç¨ç½é¡µæåå·¥å·è¯»å Vercel AI Gateway çå®æ¹ææ¡£ï¼å­¦ä¹ ææ°çç¨æ³ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107190151933.png"><img data-src="https://pic.yupi.icu/1/image-20260107190151933.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">å¤§æ¦ 5 åéå·¦å³ï¼AI å°±å®æäºå¨é¨ä»£ç ççæï¼å¹¶ä¸èªå¨å®è£äºä¾èµã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107190629349.png"><img data-src="https://pic.yupi.icu/1/image-20260107190629349.png" class="lazyload"></span></p>
<p class="md-end-block md-p">&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">3ï¼æç´æ¥æä¹åæ¿å°ç Vercel ç API Key æä¾ç» AIï¼è®©å®å¸®æå¯å¨é¡¹ç®ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107190751628.png"><img data-src="https://pic.yupi.icu/1/image-20260107190751628.png" class="lazyload"></span></p>
<p class="md-end-block md-p">&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">4ï¼å¯å¨é¡¹ç®æååï¼æå¼æµè§å¨è®¿é® <span class="md-pair-s"><code>localhost:3000</code><span class="md-plain">ï¼æµè¯ä¸ä¸ææã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">ç»ææ¥éäºï¼æ æ³è°ç¨ AIã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107191838608.png"><img data-src="https://pic.yupi.icu/1/image-20260107191838608.png" class="lazyload"></span></p>
<p class="md-end-block md-p">&nbsp;</p>
<p class="md-end-block md-p"><span class="md-plain">å¯è½æ¯ AI å¯¹ Vercel AI Gateway ææ¡£ççè§£ä¸å°ä½ï¼å¯¼è´åéäºè°ç¨ AI çä»£ç ãäºæ¯æåæ¬¡æææ¡£è¾å¥ç» AIï¼è®©å®åæä¸æ¬¡ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107191719979.png"><img data-src="https://pic.yupi.icu/1/image-20260107191719979.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ç»æåæ¥éäºï¼æææå·²ç»ç» AI æä¾äº API Keyï¼ç³»ç»è¿æ¯æ¥é âç¼ºå° API Keyâã</span></p>
<p class="md-end-block md-p"><span class="md-plain">äºæ¯æåè°äºä¸æ¬¡ AIï¼åè¯å® âè¿ä¸ª key æä¹åå·²ç»æä¾ç»ä½ äºâã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107192718301.png"><img data-src="https://pic.yupi.icu/1/image-20260107192718301.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ç»è¿å¤§æ¦ 5 æ¬¡å·¦å³çæ¥éåä¿®å¤ï¼ä»ç¶ä¸è½æ­£å¸¸ä½¿ç¨ï¼æéº»äºåâ¦â¦</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107193542108.png"><img data-src="https://pic.yupi.icu/1/image-20260107193542108.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">äºæ¯ï¼ææä¸ä¸ªé¬¼ç¹å­ï¼æ¢ç¶è¦è· Claude Code æ¯è¾ï¼é£æä¸å¦¨å°è¯ç¨ Claude Code ä¿®å¤è¿ä¸ª OpenCode è§£å³ä¸äºçé®é¢ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107193829543.png"><img data-src="https://pic.yupi.icu/1/image-20260107193829543.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">è¯è¯çï¼è¾å¥æç¤ºè¯ï¼</span></p>
<pre class="md-fences md-end-block ty-contain-cm modeLoaded"><span>ç°å¨é¡¹ç®åç«¯ AI åè½ä¸å¯ç¨<br><span>è¯·åè https://vercel.com/docs/ai-gateway/getting-started ææ¡£<br><span>å¸®æä¿®å¤åç«¯ï¼ç¡®ä¿é¡¹ç®è½æ­£å¸¸è¿è¡</span></span></span></pre>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107193701784.png"><img data-src="https://pic.yupi.icu/1/image-20260107193701784.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">Claude Code æåä¿®å¤äºé®é¢ï¼ç»äºè½å¤æ­£å¸¸ä½¿ç¨äºï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107194915666.png"><img data-src="https://pic.yupi.icu/1/image-20260107194915666.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ð¡ æ³¨æï¼å¦æä½ éå°äºè°ç¨ AI ç½ç»è¶æ¶çé®é¢ï¼å¯ä»¥è®© AI æè°ç¨ç baseURL æ¹ä¸º <span class="md-link md-pair-s"><a href="https://ai-gateway.vercel.sh/v1" rel="noopener nofollow">https://ai-gateway.vercel.sh/v1</a></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä¹åç±»ä¼¼çä»»å¡æç¨ Claude Code / Cursor + GLMï¼ä¸å° 10 åéå°±æå®äºãè¿æ¬¡ç«ç¶è±äº 20 åéå·¦å³ï¼è¿è¦ç»è¿æ¥åææ¯ï¼æè½æ­£å¸¸ä½¿ç¨ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">è¿è®©æä¸å¾ä¸æç OpenCode çè½åäºãèä¸æè§ GLM å¤§æ¨¡åå¨ OpenCode ä¸­å¥½ååç¬¨äºï¼ä¸ç¥éæ¯ä¸æ¯æçéè§â¦â¦ </span></p>
<p class="md-end-block md-p"><span class="md-plain">ä¸è¡ï¼å¤§å®¶æ OpenCode å¹å¾è¿ä¹çæ¹ï¼æå¾åè¯è¯ï¼ä¸å®æ¯æç¨æ³çé®é¢ï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107195050357.png"><img data-src="https://pic.yupi.icu/1/image-20260107195050357.png" class="lazyload"></span></p>
<h3 class="md-end-block md-heading"><span class="md-plain">Ultrawork æ¨¡å¼</span></h3>
<p class="md-end-block md-p"><span class="md-plain">è¿è®°å¾åé¢æå°ç <span class="md-pair-s"><code>ultrawork</code><span class="md-plain">ï¼æ <span class="md-pair-s"><code>ulw</code><span class="md-plain">ï¼å¼æåè¯­ä¹ï¼æèµ·ï¼</span></span></span></span></span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107195327425.png"><img data-src="https://pic.yupi.icu/1/image-20260107195327425.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">è¿å¥ææç¶æäºï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107195346575.png"><img data-src="https://pic.yupi.icu/1/image-20260107195346575.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">å¯ä»¥æ¥çå­ä»£çè¿è¡è¯¦æï¼åæ <span class="md-pair-s"><code>Ctrl + x</code><span class="md-plain"> é®ï¼åææ¹åé®æ¥æ¥çä¸åçä»£çã</span></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">èä¸å½åå°ä»»å¡å®ææ¶ï¼ä¼æä¸ä¸ªæç¤ºãå¯ä»¥çå° âç ç©¶ Vercel AI SDK å¯¹è¯æ¨¡å¼â çä»»å¡å·²ç»å®æã</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107195605772.png"><img data-src="https://pic.yupi.icu/1/image-20260107195605772.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä¸è¿ä½ çæä¹çï¼æç­äºå°è¿ 10 åéï¼ä»»å¡è¿æ²¡ç»æâ¦â¦</span></p>
<p class="md-end-block md-p"><span class="md-plain">ççè¿ä¸ªä»»å¡åè¡¨ï¼éè¦è¿ä¹å¤æåï¼è¿æ°æ®åºé½ç»æå¹²åºæ¥äºï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107200237753.png"><img alt="=" data-src="https://pic.yupi.icu/1/image-20260107200237753.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">æå·²ç»æ²¡èå¿ç­ä¸å»äºï¼æ¯ç­å§ï¼</span></p>
<p class="md-end-block md-p"><span class="md-plain">çæ¥è¿ç§ä¸ç®å¤ªå¤æçå·¥ä½å¹¶ä¸è½åæ¥åºå¤ä»£ççä¼å¿ãå°±åä½ åªæ¯è¦æå°ä¸å¼ çº¸ï¼æ²¡å¿è¦åå¨å¨å¬å¸çäººï¼æçç ç©¶æå°ççº¸å¼ ç±»åãæçç ç©¶æå°æºçç¶æãæçç ç©¶æä¹æå°å§¿å¿æ´ä¼éã</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">æå</span></h2>
<p class="md-end-block md-p"><span class="md-plain">ç»è¿ä¸è¿°ç®åçæµè¯ï¼æææ¶å¯¹ OpenCode ä¿æè§æç¶æã</span></p>
<p class="md-end-block md-p"><span class="md-plain">åç«¯åçç¡®å®å¾ä¸éï¼ä½åç«¯çè½åæè§è· Claude Code è¿æå·®è·ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">å¦æåªæ¯è¿½æ±åç«¯ä½¿ç¨æ¹ä¾¿ï¼é£æä¸ºä»ä¹ä¸ç¨ Cursorï¼</span></p>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="https://pic.yupi.icu/1/image-20260107200720088.png"><img data-src="https://pic.yupi.icu/1/image-20260107200720088.png" class="lazyload"></span></p>
<p class="md-end-block md-p"><span class="md-plain">ä¸è¿ OpenCode çæåè¯´æäºä¸ä¸ªéçï¼<span class="md-pair-s "><strong>è°ç¦»ç¨æ·è¿ãè°è½åç°çç¹ï¼è°å°±æè¶è¶å·¨å¤´çæºä¼ã</strong></span></span></p>
<p class="md-end-block md-p"><span class="md-plain">Claude Code ç¡®å®å¾å¼ºï¼ä½å®å¯¹ä¸­å½ç¨æ·çå°ç¦ï¼ç»äºå¼æºç¤¾åºä¸ä¸ªç»ä½³çæºä¼ãOpenCode æä½äºè¿ä¸ªçç¹ï¼ç¨æ´å¼æ¾çæ¹å¼èµ¢å¾äºç¨æ·çå¿ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">è½ç¶æææå¾æé«ï¼ä½æ¯ç« OpenCode å®å¨å¼æºåè´¹ï¼å¯¹äºåæ¬¢æè¾çç¨åºåæ¥è¯´ï¼å¯å®å¶æ§æ´å¼ºãä½ çè³å¯ä»¥ fork ä¸ä»½èªå·±é­æ¹ï¼æ³æä¹ç©å°±æä¹ç©ã</span></p>
<p class="md-end-block md-p"><span class="md-plain">OKï¼å°±èå°è¿éãä½ ç¨è¿ OpenCode åï¼æ¬¢è¿è¯è®ºåºèèä½ çä½éª~</span></p>
<p class="md-end-block md-p">&nbsp;</p>
<h2 class="md-end-block md-heading"><span class="md-plain">æ´å¤ç¼ç¨å­¦ä¹ èµæº</span></h2>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/course" rel="noopener nofollow"><span class="md-plain">Javaåç«¯ç¨åºåå¿åé¡¹ç®å®ææç¨+æ¯è®¾ç½ç«</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/" rel="noopener nofollow"><span class="md-plain">ç¨åºååè´¹ç¼ç¨å­¦ä¹ äº¤æµç¤¾åºï¼èªå­¦å¿å¤ï¼</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/course/cv" rel="noopener nofollow"><span class="md-plain">ç¨åºåä¿å§çº§æ±èåç®åæåï¼æ¾å·¥ä½å¿å¤ï¼</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.mianshiya.com/" rel="noopener nofollow"><span class="md-plain">ç¨åºååè´¹é¢è¯å·é¢ç½ç«å·¥å·ï¼æ¾å·¥ä½å¿å¤ï¼</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640584449888772098" rel="noopener nofollow"><span class="md-plain">ææ°Javaé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Javaæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640586673306091521" rel="noopener nofollow"><span class="md-plain">ææ°Pythoné¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Pythonæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640586014108303362" rel="noopener nofollow"><span class="md-plain">ææ°åç«¯é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + åç«¯æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640586867363954689" rel="noopener nofollow"><span class="md-plain">ææ°æ°æ®ç»æåç®æ³é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + ç®æ³æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1644279832026075138" rel="noopener nofollow"><span class="md-plain">ææ°C++é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ãC++æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1641797333479903234" rel="noopener nofollow"><span class="md-plain">ææ°æ°æ®åºé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + æ°æ®åºæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640589994284695553" rel="noopener nofollow"><span class="md-plain">ææ°Redisé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Redisæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1641035880439271426" rel="noopener nofollow"><span class="md-plain">ææ°è®¡ç®æºåºç¡å¥é¨å­¦ä¹ è·¯çº¿ + è®¡ç®æºåºç¡æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1641366118197153793" rel="noopener nofollow"><span class="md-plain">ææ°å°ç¨åºå¥é¨å­¦ä¹ è·¯çº¿ + å°ç¨åºå¼åæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="http://sqlmother.yupi.icu/" rel="noopener nofollow"><span class="md-plain">ææ°SQLé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + SQLæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640586295529324545" rel="noopener nofollow"><span class="md-plain">ææ°Linuxé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Linuxæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640588753362108417" rel="noopener nofollow"><span class="md-plain">ææ°Git/GitHubé¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + Gitæç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640587909942099969" rel="noopener nofollow"><span class="md-plain">ææ°æä½ç³»ç»é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + æä½ç³»ç»æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640588119619551233" rel="noopener nofollow"><span class="md-plain">ææ°è®¡ç®æºç½ç»é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + è®¡ç®æºç½ç»æç¨</span></a></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-meta-i-c  md-link"><a href="https://www.code-nav.cn/post/1640588392073150465" rel="noopener nofollow"><span class="md-plain">ææ°è®¾è®¡æ¨¡å¼é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + è®¾è®¡æ¨¡å¼æç¨</span></a></span></p>
</li>
<li class="md-list-item md-focus-container">
<p class="md-end-block md-p md-focus"><span class="md-meta-i-c md-link md-expand"><a href="https://www.code-nav.cn/post/1640648711119892481" rel="noopener nofollow"><span class="md-plain">ææ°è½¯ä»¶å·¥ç¨é¶åºç¡å¥é¨å­¦ä¹ è·¯çº¿ + è½¯ä»¶å·¥ç¨æç¨</span></a></span></p>
</li>
</ul>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-09 11:30">2026-01-09 11:30</span>&nbsp;
<a href="https://www.cnblogs.com/yupi">ç¨åºåé±¼ç®</a>&nbsp;
éè¯»(<span id="post_view_count">883</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19460549);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19460549', targetLink: 'https://www.cnblogs.com/yupi/p/19460549', title: 'å¹²æ Claude Codeï¼è¿ä¸ªå¼æº AI ç¼ç¨å·¥å·æç¯äºï¼' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ çº¿ç¨æ± åé«å¹¶å ]]></title>
    <link>https://www.cnblogs.com/philry/p/19359433</link>
    <guid>2ec106a0634139d28708295596e90a44</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/philry/p/19359433" title="åå¸äº 2026-01-09 09:14">
    <span role="heading" aria-level="2">çº¿ç¨æ± åé«å¹¶å</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<div>
<div><strong><span style="font-size: 18px">å¤çº¿ç¨</span></strong></div>
<div><strong><span style="font-size: 16px">Javaåå»ºçº¿ç¨çå ç§æ¹å¼æåªäºï¼</span></strong></div>
<div>å¸¸è§æä»¥ä¸äºç§æ¹å¼åå»ºä½¿ç¨å¤çº¿ç¨ï¼</div>
<div><strong>1ï¼å®ç°&nbsp;Runnable&nbsp;æ¥å£ï¼</strong></div>
<ul>
<li>
<div>å®ç°&nbsp;Runnable&nbsp;æ¥å£ç&nbsp;run()&nbsp;æ¹æ³ï¼ä½¿ç¨&nbsp;Thread&nbsp;ç±»çæé å½æ°ä¼ å¥&nbsp;Runnable&nbsp;å¯¹è±¡ï¼è°ç¨&nbsp;start()&nbsp;æ¹æ³å¯å¨çº¿ç¨ã</div>
</li>
<li>
<div>ä¾å­ï¼Thread thread = new Thread(new MyRunnable()); thread.start();</div>
</li>
</ul>
<div><strong>2ï¼ç»§æ¿&nbsp;Thread&nbsp;ç±»ï¼</strong></div>
<ul>
<li>
<div>ç»§æ¿&nbsp;Thread&nbsp;ç±»å¹¶éå&nbsp;run()&nbsp;æ¹æ³ï¼ç´æ¥åå»º&nbsp;Thread&nbsp;å­ç±»å¯¹è±¡å¹¶è°ç¨&nbsp;start()&nbsp;æ¹æ³å¯å¨çº¿ç¨ã</div>
</li>
<li>
<div>ä¾å­ï¼MyThread thread = new MyThread(); thread.start();</div>
</li>
</ul>
<div><strong>3ï¼ä½¿ç¨&nbsp;Callable&nbsp;å&nbsp;FutureTaskï¼</strong></div>
<ul>
<li>
<div>å®ç°&nbsp;Callable&nbsp;æ¥å£ç&nbsp;call()&nbsp;æ¹æ³ï¼ä½¿ç¨&nbsp;FutureTask&nbsp;åè£&nbsp;Callable&nbsp;å¯¹è±¡ï¼åéè¿&nbsp;Thread&nbsp;å¯å¨ã</div>
</li>
<li>
<div>ä¾å­ï¼FutureTask&lt;Integer&gt; task = new FutureTask&lt;&gt;(new MyCallable()); Thread thread = new Thread(task); thread.start();</div>
</li>
</ul>
<div><strong>4ï¼ä½¿ç¨çº¿ç¨æ± ï¼ExecutorServiceï¼ï¼</strong></div>
<ul>
<li>
<div>éè¿&nbsp;ExecutorService&nbsp;æäº¤&nbsp;Runnable&nbsp;æ&nbsp;Callable&nbsp;ä»»å¡ï¼ä¸ç´æ¥åå»ºåç®¡ççº¿ç¨ï¼éåç®¡çå¤§éå¹¶åä»»å¡ã</div>
</li>
<li>
<div>ä¾å­ï¼ExecutorService executor = Executors.newFixedThreadPool(10); executor.submit(new MyRunnable());</div>
</li>
</ul>
<div><strong>5ï¼CompletableFutureï¼æ¬è´¨ä¹æ¯çº¿ç¨æ± ï¼é»è®¤ forkjoinpoolï¼ï¼</strong></div>
<ul>
<li>
<div>Java 8 å¼å¥çåè½ï¼éå¸¸æ¹ä¾¿å°è¿è¡å¼æ­¥ä»»å¡è°ç¨ï¼ä¸éè¿&nbsp;thenApplyãthenAccept&nbsp;ç­æ¹æ³å¯ä»¥è½»æ¾å¤çå¼æ­¥ä»»å¡ä¹é´çä¾èµå³ç³»ã</div>
</li>
<li>
<div>CompletableFuture&lt;Void&gt; future1 = CompletableFuture.runAsync(() -&gt; {});</div>
</li>
</ul>
<div>
<div>&nbsp;</div>
<div><strong><span style="font-size: 18px">çº¿ç¨çå½å¨æåäºç§ç¶æ</span></strong></div>
<div><img width="476" data-src="https://img2024.cnblogs.com/blog/2337379/202512/2337379-20251216211723582-789203954.png" class="lazyload"></div>
<h3>&nbsp;</h3>
<h3>1ãNew(åå§åç¶æ)</h3>
<div>&nbsp;&nbsp; &nbsp;ç¨newè¯­å¥åå»ºççº¿ç¨å¤äºæ°å»ºç¶æï¼æ­¤æ¶å®åå¶ä»Javaå¯¹è±¡ä¸æ ·ï¼ä»ä»å¨å åºä¸­è¢«åéäºåå­ãå¦ï¼Thread t = new MyThread();</div>
<div>2ãRunnable(å°±ç»ªç¶æ)</div>
<div>&nbsp;&nbsp; &nbsp;å½è°ç¨çº¿ç¨å¯¹è±¡çstart()æ¹æ³ï¼çº¿ç¨å³è¿å¥å°±ç»ªç¶æãå¤äºå°±ç»ªç¶æççº¿ç¨ï¼åªæ¯è¯´ææ­¤çº¿ç¨å·²ç»åå¥½äºåå¤ï¼Javaèææºä¼ä¸ºå®åå»ºæ¹æ³è°ç¨æ åç¨åºè®¡æ°å¨ãå¤äºè¿ä¸ªç¶æççº¿ç¨ä½äºå¯è¿è¡æ± ä¸­ï¼ç­å¾è·å¾CPUçä½¿ç¨æï¼å¹¶ä¸æ¯è¯´æ§è¡äºstart()æ­¤çº¿ç¨ç«å³å°±ä¼æ§è¡ã</div>
<h3>3ãRunning(è¿è¡ç¶æ)</h3>
<div>&nbsp;&nbsp; &nbsp;å½å°±ç»ªç¶æä¸­ççº¿ç¨è·å¾äºCUPæ§è¡èµæºï¼æ§è¡run()ä¸­çä»£ç ï¼è¿æ ·ççº¿ç¨æä»¬ç§°ä¸ºè¿è¡ç¶æççº¿ç¨ã</div>
<div>4ãBlocked(é»å¡ç¶æ)</div>
<div>&nbsp; &nbsp; å¤äºè¿è¡ä¸­ççº¿ç¨ï¼ç±äºæç§åå æ¾å¼å¯¹cpuçä½¿ç¨æï¼å¤äºé»å¡ç¶æï¼ç´å°å¶è¿å¥å°±ç»ªç¶æï¼æææºä¼åæ¬¡è¢«cpuè°ç¨è¿å¥è¿è¡ç¶æã</div>
<div>æ ¹æ®é»å¡åå ä¸åï¼é»å¡åä¸ºä¸ç§ï¼</div>
<div>ç­å¾é»å¡ï¼è¿è¡ç¶æä¸­ççº¿ç¨æ§è¡waitæ¹æ³ï¼è¿å¥ç­å¾éåï¼ç­å¾é»å¡ï¼Javaèææºå°±ä¼æçº¿ç¨æ¾å°è¿ä¸ªå¯¹è±¡çç­å¾æ± ä¸­ï¼</div>
<div>åæ­¥é»å¡ï¼çº¿ç¨è·ååæ­¥éå¤±è´¥ï¼å ä¸ºéè¢«å¶ä»çº¿ç¨å ç¨ï¼ï¼Javaèææºå°±ä¼æè¿ä¸ªçº¿ç¨æ¾å°è¿ä¸ªå¯¹è±¡çéæ± ä¸­ï¼</div>
<div>å¶ä»é»å¡ï¼éè¿è°ç¨sleepæ¹æ³æèjoinæ¹æ³æèååºI/Oè¯·æ±æ¶ï¼çº¿ç¨ä¼è¿å¥é»å¡ç¶æï¼å½sleep()ç¶æè¶æ¶ï¼æèjoin()ç­å¾çº¿ç¨ç»æ­¢æèè¶æ¶ï¼æèI/Oå¤çå®æ¯ï¼çº¿ç¨éæ°è½¬å¥å°±ç»ªç¶æï¼</div>
<h3>5ãTerminatedï¼ç»æ­¢ç¶æ)</h3>
<div>
<div>
<div>&nbsp;&nbsp; &nbsp;æ­£å¸¸ç»æï¼çº¿ç¨æ§è¡å®</div>
<div>&nbsp;&nbsp; &nbsp;å¼å¸¸éåº</div>
</div>
</div>
<div>
<div>
<div>&nbsp;&nbsp; &nbsp;å¼å¸¸éåºï¼é¤äºç¨åºæé®é¢å¯¼è´çå¼å¸¸çéåºï¼è¿å¯ä»¥ä½¿ç¨å±äº«åéçæ¹å¼ï¼å®ä¹ä¸ªbooleanæ è¯ç­ï¼éåºï¼æèInterruptä¸­æ­çº¿ç¨,æåºå¼å¸¸ï¼æè·å¼å¸¸breakï¼è·³åºå¾ªç¯ç¶æï¼</div>
<div>&nbsp;&nbsp; &nbsp;è°ç¨stop()ï¼ä¼é ææ­»éï¼çº¿ç¨ä¸å®å¨ï¼ä¸å»ºè®®ä½¿ç¨</div>
<div>&nbsp;</div>
<div><strong><span style="font-size: 18px">çº¿ç¨åºæ¬æ¹æ³</span></strong></div>
<div>1ãçº¿ç¨ç­å¾ï¼waitï¼</div>
<div>&nbsp; &nbsp;&nbsp;è°ç¨è¯¥æ¹æ³ï¼çº¿ç¨è¿å¥waitingç¶æï¼åªæç­å¾å¦å¤ççº¿ç¨éç¥æè¢«ä¸­æ­æä¼è¿åï¼è°ç¨wait()åï¼ä¼éæ¾å¯¹è±¡éï¼å ä¸ºwaitæ¹æ³ä¸è¬ç¨å¨åæ­¥æ¹æ³æèåæ­¥ä»£ç åä¸­ã</div>
<div>2ãçº¿ç¨ç¡ç ï¼sleepï¼</div>
<div>å¼ºè¿«ä¸çº¿ç¨ç¡ Næ¯«ç§ï¼sleepä¸ä¼éæ¾å½åéï¼å¯¼è´çº¿ç¨è¿å¥Timed-watingç¶æã</div>
<div>3ãçº¿ç¨è®©æ­¥ï¼yieldï¼</div>
<div>&nbsp; &nbsp; yeildä¼ä½¿å½åçº¿ç¨è®©åºcpuæ§è¡æ¶é´çï¼ä¸å¶ä»çº¿ç¨ä¸èµ·éæ°ç«äºcpuæ¶é´çï¼ä¸è¬æåµä¸ï¼ä¼åçº§é«çåå¾å°ï¼ä½ä¹ä¸ä¸å®ï¼æçç³»ç»å¯¹ä¼åçº§ä¸ææã</div>
<div>4ãçº¿ç¨ä¸­æ­ï¼interruptï¼</div>
<div>&nbsp; &nbsp; å¨runåé¨æ ¹æ®thread.isIterrupted() å®å¨ç»æ­¢çº¿ç¨ãè°ç¨ä¸ä¸ªçº¿ç¨çinterrupt() æ¹æ³ä¸­æ­ä¸ä¸ªçº¿ç¨ï¼å¹¶ä¸æ¯å¼ºè¡å³é­è¿ä¸ªçº¿ç¨ï¼ä»ä»æ¯æ¹åäºåé¨ç»´æ¤çä¸­æ­æ è¯ä½ï¼æ¯çº¿ç¨åºæçä¸ä¸ªæ è¯ä½ãå¯ä»¥è°ç¨staticæ¹æ³isIterrupted() å¤å®å½åçº¿ç¨æ¯å¦å¤äºä¸­æ­ç¶æï¼</div>
<div>&nbsp; &nbsp; 1ï¼å¦æä¸ä¸ªæ­£å¸¸çº¿ç¨ï¼è°ç¨interrupt() ï¼æ¯ä¸è½è¢«ææ­çï¼æå°ä¸­æ­æ å¿ä½ç½®ä¸ºtrue</div>
<div>&nbsp; &nbsp; 2ï¼å¦æä¸ä¸ªsleepæèwaitççº¿ç¨ï¼è°ç¨interrupt() ï¼æ¹æ³åæåºInterruptedException( InterruptedExceptionè¡¨ç¤ºä¸ä¸ªé»å¡è¢«ä¸­æ­äº)ï¼çº¿ç¨çä¸­æ­æ å¿ä½ä¼è¢«å¤ä½æfalseï¼ç¸å½äºç¨å¼å¸¸ååºäºè¿ä¸ªä¸­æ­ï¼æä»¥éæ¾ä¸­æ­æ å¿ä½ã</div>
<div>5ãjoinï¼ç­å¾å¶ä»çº¿ç¨ç»æ­¢ï¼</div>
<div>&nbsp; &nbsp; å½åçº¿ç¨è°ç¨joinï¼ï¼ï¼åçº¿ç¨è½¬ä¸ºé»å¡ç¶æï¼egï¼Açº¿ç¨ä¸­æå¥äºB.join()ï¼åBåæ§è¡ï¼æ§è¡å®ï¼Açº¿ç¨ç»§ç»­æ§è¡ï¼å¸¸è§çæ¯ä¸»çº¿ç¨çæå¹¶å¯å¨äºå­çº¿ç¨ï¼éè¦ç¨å°å­çº¿ç¨è¿åç»æçåºæ¯ï¼</div>
<div>6ãçº¿ç¨å¤éï¼notifyï¼</div>
<div>&nbsp; &nbsp; Objectç±»ä¸­çnotifyå¤éå¨æ­¤å¯¹è±¡çè§å¨ä¸ç­å¾çåä¸ªçº¿ç¨ï¼</div>
<div>&nbsp; &nbsp; notifyAllå¤éå¨æ­¤å¯¹è±¡çè§å¨ä¸ç­å¾çææçº¿ç¨ï¼</div>
<div>7ãå¶ä»å¸¸ç¨æ¹æ³</div>
</div>
<table><colgroup><col><col></colgroup>
<tbody>
<tr>
<td>
<div>æ¹æ³åè½</div>
</td>
<td>
<div>æ¹æ³å</div>
</td>
</tr>
<tr>
<td>
<div>&nbsp;å¤æ­ä¸ä¸ªçº¿ç¨æ¯å¦å­æ´»ï¼</div>
</td>
<td>
<div>isAlive()&nbsp;&nbsp;</div>
</td>
</tr>
<tr>
<td>
<div>ç¨åºä¸­æ´»è·ççº¿ç¨æ°ï¼</div>
</td>
<td>
<div>activeCount()&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</div>
</td>
</tr>
<tr>
<td>
<div>å¾å°å½åçº¿ç¨ï¼</div>
</td>
<td>
<div>currentThread()&nbsp;&nbsp; &nbsp;</div>
</td>
</tr>
<tr>
<td>
<div>è®¾ç½®ä¸ä¸ªçº¿ç¨çä¼åçº§ï¼</div>
</td>
<td>
<div>setPriority()&nbsp; &nbsp;</div>
</td>
</tr>
<tr>
<td>
<div>è·åä¸ä¸ªçº¿ç¨çä¼åçº§ï¼</div>
</td>
<td>
<div>getPriority()&nbsp;&nbsp; &nbsp;&nbsp;</div>
</td>
</tr>
<tr>
<td>
<div>çº¿ç¨æ¯å¦ä¸ºå®æ¤çº¿ç¨ï¼</div>
</td>
<td>
<div>isDaemon()&nbsp;&nbsp; &nbsp;&nbsp;</div>
</td>
</tr>
</tbody>
</table>
<div>&nbsp;</div>
</div>
</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div><strong><span style="font-size: 18px">çº¿ç¨æ± </span></strong></div>
<div>çº¿ç¨æ± çåºæ¬æ¦å¿µæ¯ï¼å¨åºç¨ç¨åºå¯å¨æ¶åå»ºä¸å®æ°éççº¿ç¨ï¼å¹¶å°å®ä»¬ä¿å­å¨çº¿ç¨æ± ä¸­ãå½éè¦æ§è¡ä»»å¡æ¶ï¼ä»çº¿ç¨æ± ä¸­è·åä¸ä¸ªç©ºé²ççº¿ç¨ï¼å°ä»»å¡åéç»è¯¥çº¿ç¨æ§è¡ãå½ä»»å¡æ§è¡å®æ¯åï¼çº¿ç¨å°è¿åå°çº¿ç¨æ± ï¼å¯ä»¥è¢«å¶ä»ä»»å¡å¤ç¨ã</div>
<div>çº¿ç¨æ± åå»ºæä¸¤ç§æ¹å¼ï¼ä¸ç§æ¯Executorsä½¿ç¨é»è®¤æ¹æ³åå»ºï¼å¦ä¸ç§æ¯éè¿ThreadPoolExecutorèªå®ä¹ï¼ä¸æ¨èåèæ¯å ä¸ºåèçéç½®å¾å¤é½æ¯åå¾integerå¾æå¤§å¼ï¼å¾å®¹æé æOOMã</div>
<div>å·¥ä½ä¸­å°±æ¯éè¦ä»¥new ThreadPoolExecutorçæ¹å¼åå»ºçº¿ç¨æ± çï¼å¶ä½çä¸å®å¨ã&nbsp; &nbsp;&nbsp;</div>
<div>
<div><img width="692" data-src="https://img2024.cnblogs.com/blog/2337379/202512/2337379-20251216211723799-1699157165.png" class="lazyload"></div>
</div>
<div>ä½¿ç¨çº¿ç¨æ± çä¸è¬æ­¥éª¤å¦ä¸ï¼&nbsp;</div>
<div>
<div>1ãåå»ºçº¿ç¨æ± ï¼ä½¿ç¨ThreadPoolExecutorç±»æ¥åå»ºçº¿ç¨æ± ã</div>
<div>&nbsp;&nbsp; &nbsp;ExecutorService executor = Executors.newFixedThreadPool(5); // åå»ºåºå®å¤§å°ççº¿ç¨æ± &nbsp;</div>
</div>
<div>
<div>2ãæäº¤ä»»å¡ï¼å°ä»»å¡æäº¤ç»çº¿ç¨æ± ã</div>
<div>&nbsp;&nbsp; &nbsp;executor.execute(new MyRunnable()); // æäº¤Runnableä»»å¡</div>
<div>&nbsp;&nbsp; &nbsp;Future&lt;String&gt; future = executor.submit(new MyCallable()); // æäº¤Callableä»»å¡ï¼å¹¶è¿åFutureå¯¹è±¡</div>
</div>
<div>
<div>3ãå³é­çº¿ç¨æ± ï¼å¨ä¸åéè¦çº¿ç¨æ± æ¶ï¼éè¦è°ç¨shutdown()æ¹æ³æ¥å³é­çº¿ç¨æ± ãè¿å°åæ­¢æ¥åæ°ä»»å¡ï¼å¹¶éæ¸å³é­çº¿ç¨æ± ä¸­ççº¿ç¨ã</div>
<div>&nbsp;&nbsp; &nbsp;executor.shutdown();</div>
</div>
<div>
<div>&nbsp;&nbsp; &nbsp;<strong><span style="font-size: 16px">çº¿ç¨æ± æ ¸å¿æ¦å¿µï¼</span></strong></div>
</div>
<div>ã&nbsp;&nbsp;int &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;corePoolSizeããã&nbsp;&nbsp; æ ¸å¿çº¿ç¨æ°</div>
<div>ããint &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;maximumPoolSizeãæå¤§çº¿ç¨æ°</div>
<div>ããlong&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;keepAliveTimeãã&nbsp; &nbsp;ç©ºé²çº¿ç¨æå¤§å­æ´»æ¶é´</div>
<div>ããTimeUnit &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; unitãããããã&nbsp; &nbsp; &nbsp; &nbsp;æ¶é´åä½ï¼mï¼hï¼d</div>
<div>ããBlockingQueue&lt;Runnable&gt; workQueueãã&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;é»å¡ä»»å¡éå</div>
<div>ããThreadFactory &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; threadFactoryãã&nbsp; &nbsp; åå»ºçº¿ç¨å·¥å</div>
<div>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; RejectedExecutionHandler &nbsp;&nbsp; handlerãã&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;æç»ç­ç¥</div>
<h3>ThreadPoolExecutoråæ°è¯¦è§£</h3>
<div>æä»¬å¯ä»¥éè¿ä¸é¢çåºæ¯çè§£ThreadPoolExecutorä¸­çåä¸ªåæ°;</div>
<div>aå®¢æ·(ä»»å¡)å»é¶è¡(çº¿ç¨æ± )åçä¸å¡,ä½é¶è¡åå¼å§è¥ä¸,çªå£æå¡åè¿æªå°±ä½(ç¸å½äºçº¿ç¨æ± ä¸­åå§çº¿ç¨æ°éä¸º0),</div>
<div>äºæ¯ç»ç(çº¿ç¨æ± ç®¡çè)å°±å®æ1å·å·¥ä½äººå(åå»º1å·çº¿ç¨æ§è¡ä»»å¡)æ¥å¾aå®¢æ·(åå»ºçº¿ç¨);</div>
<div>å¨aå®¢æ·ä¸å¡è¿æ²¡åå®æ¶,bå®¢æ·(ä»»å¡)åæ¥äº,äºæ¯ç»ç(çº¿ç¨æ± ç®¡çè)å°±å®æ2å·å·¥ä½äººå(åå»º2å·çº¿ç¨æ§è¡ä»»å¡)æ¥å¾bå®¢æ·(ååå»ºäºä¸ä¸ªæ°ççº¿ç¨);åè®¾è¯¥é¶è¡æ»å±å°±2ä¸ªçªå£(æ ¸å¿çº¿ç¨æ°éæ¯2);</div>
<div>ç´§æ¥çå¨a,bå®¢æ·é½æ²¡æç»æçæåµä¸cå®¢æ·æ¥äº,äºæ¯ç»ç(çº¿ç¨æ± ç®¡çè)å°±å®æcå®¢æ·ååå°é¶è¡å¤§åçåº§ä½ä¸(ç©ºä½ç¸å½äºæ¯ä»»å¡éå)ç­å,</div>
<div>å¹¶åç¥ä»: å¦æ1ã2å·å·¥ä½äººåç©ºåº,cå°±å¯ä»¥åå»åçä¸å¡;</div>
<div>æ­¤æ¶då®¢æ·åå°äºé¶è¡,(å·¥ä½äººåé½å¨å¿,å¤§ååº§ä½ä¹æ»¡äº)äºæ¯ç»çèµ¶ç´§å®æä¸´æ¶å·¥(æ°åå»ºççº¿ç¨)å¨å¤§å ç«ç,ææpadè®¾å¤ç»då®¢æ·åçä¸å¡;</div>
<div>åå¦åé¢çä¸å¡é½æ²¡æç»æçæ¶åeå®¢æ·åæ¥äº,æ­¤æ¶æ­£å¼å·¥ä½äººåé½ä¸äº,ä¸´æ¶å·¥ä¹ä¸äº,åº§ä½ä¹æ»¡äº(ä¸´æ¶å·¥å æ­£å¼åå·¥çæ»æ°éå°±æ¯æå¤§çº¿ç¨æ°),äºæ¯ç»çåªè½æãè¶åºé¶è¡æå¤§æ¥å¾è½åå¤çåæ³ã(é¥±åå¤çæºå¶)ææ¥æ¥å¾eå®¢æ·;</div>
<div>æå,è¿æ¥åä¸å¡çäººå°äº,å¤§åçä¸´æ¶å·¥ç©ºé²æ¶é´ä¹è¶è¿äº1ä¸ªå°æ¶(æå¤§ç©ºé²æ¶é´),ç»çå°±ä¼è®©è¿é¨åç©ºé²çåå·¥äººä¸ç­.(éæ¯çº¿ç¨)</div>
<div>ä½æ¯ä¸ºäºä¿è¯é¶è¡é¶è¡æ­£å¸¸å·¥ä½(æä¸ä¸ªallowCoreThreadTimeoutåéæ§å¶æ¯å¦åè®¸éæ¯æ ¸å¿çº¿ç¨,é»è®¤false),å³ä½¿æ­£å¼å·¥é²ç,ä¹ä¸å¾æåä¸ç­,æä»¥1ã2å·å·¥ä½äººåç»§ç»­å¾ç(æ± åä¿ææ ¸å¿çº¿ç¨æ°é);</div>
<div>2ãè¯¦ç»è§£é</div>
<div>ãã1)ã&nbsp;æ ¸å¿çº¿ç¨æ°</div>
<div>ããããå½çº¿ç¨æ¯IOå¯éåæ¶ï¼ä¸»è¦æ¶èç£ççè¯»åæ§è½ï¼å¯ä»¥è®¾ç½®ä¸º2*nï¼nä¸ºå½åæå¡å¨æ ¸æ°ï¼æ¯å¦8æ ¸16Gçæå¡å¨è®¾ç½®ä¸º16ï¼Runtime.getRuntime().availableProcessors()è·åï¼</div>
<div>ããããå½çº¿ç¨æ¯CPUå¯éåæ¶ï¼ä¸»è¦æ¶ècpuæ§è½ï¼è®¾ç½®ä¸ºn+1</div>
<div>ãã2)ãæå¤§çº¿ç¨æ°</div>
<div>ããããå½æ ¸å¿çº¿ç¨æ ¸æ¶æ¯éåé½æ»¡äºä¹åæä¼å»åå»ºæå¤§çº¿ç¨ï¼ç´å°è¾¾å°æå¤§çº¿ç¨æ°ï¼ä¹åççº¿ç¨å°±ä¼æ§è¡æç»ç­ç¥</div>
<div>ãã3)ã&nbsp;é»å¡æ¶æ¯éå</div>
<div>ããããArrayBlockingQueueï¼åºäºæ°ç»çåè¿ååºéåï¼æ­¤éååå»ºæ¶å¿é¡»æå®å¤§å°ï¼è¯»åç¨ä¸æéï¼æ§è½è¾å·®ï¼</div>
<div>ããããLinkedBlockingQueueï¼åºäºé¾è¡¨çåè¿ååºéåï¼å¦æåå»ºæ¶æ²¡ææå®æ­¤éåå¤§å°ï¼åé»è®¤ä¸ºInteger.MAX_VALUEï¼ä¸è¬æ¯ç¨è¿ä¸ªï¼æå®äºå¤§å°åéå¶å·ä½å¤§å°ï¼åæ ¸è¯»åä¸¤æéè¿è¡æä½ï¼æä»¥æ§è½è¾å¥½</div>
<div>ããããsynchronousQueueï¼è¿ä¸ªéåæ¯è¾ç¹æ®ï¼å®ä¸ä¼ä¿å­æäº¤çä»»å¡ï¼èæ¯å°ç´æ¥æ°å»ºä¸ä¸ªçº¿ç¨æ¥æ§è¡æ°æ¥çä»»å¡ã</div>
<div>ããããæ³¨æï¼å½æ ¸å¿çº¿ç¨æ°æ»¡äºä¹åï¼æ°çº¿ç¨ä¼åå­å¨å¨æ¶æ¯éåä¸­ï¼å½æ¶æ¯éåä¹æ»¡äºä¹åæä¼å»åå»ºæå¤§çº¿ç¨ï¼ç´å°è¾¾å°æå¤§çº¿ç¨æ°ï¼ä¹åççº¿ç¨å°±ä¼æ§è¡æç»ç­ç¥</div>
<div>ãã4)ã&nbsp;çº¿ç¨å·¥å</div>
<div>ããããåå»ºçº¿ç¨çç±»ï¼å¯ä»¥ç¨é»è®¤å·¥åï¼ä¹å¯ä»¥èªå®ä¹çº¿ç¨å·¥åå®ç°&nbsp;implements ThreadFactoryç±»ï¼å®ç°newThreadæ¹æ³ï¼èªå®ä¹å·¥åçè¯å¯ä»¥è®¾ç½®çº¿ç¨åæèå®ä¹è¾å©çº¿ç¨</div>
<div>ãã5)ãæç»ç­ç¥</div>
<div>ããããThreadPoolExecutor.AbortPolicy:ä¸¢å¼ä»»å¡å¹¶æåºRejectedExecutionExceptionå¼å¸¸ã</div>
<div>ããããThreadPoolExecutor.DiscardPolicyï¼ä¸¢å¼ä»»å¡ï¼ä½æ¯ä¸æåºå¼å¸¸ã</div>
<div>ããããThreadPoolExecutor.DiscardOldestPolicyï¼ä¸¢å¼éåæåé¢çä»»å¡ï¼ç¶åéæ°æäº¤è¢«æç»çä»»å¡</div>
<div>ããããThreadPoolExecutor.CallerRunsPolicyï¼ç±è°ç¨çº¿ç¨ï¼æäº¤ä»»å¡ççº¿ç¨ï¼å¤çè¯¥ä»»å¡</div>
<div>&nbsp;</div>
<div><strong>çº¿ç¨æ± çä¸»è¦ä¼ç¹åæ¬ï¼</strong></div>
<div>1ãéç¨çº¿ç¨ï¼çº¿ç¨æ± ä¼å¨åé¨ç»´æ¤ä¸ç»å¯éç¨ççº¿ç¨ï¼é¿åäºé¢ç¹å°åå»ºåéæ¯çº¿ç¨çå¼éï¼æé«äºçº¿ç¨çå©ç¨çã</div>
<div>2ãæ§å¶å¹¶ååº¦ï¼çº¿ç¨æ± å¯ä»¥éå¶å¹¶åæ§è¡ççº¿ç¨æ°éï¼é²æ­¢ç³»ç»è¿è½½ãéè¿è°æ´çº¿ç¨æ± çå¤§å°ï¼å¯ä»¥æ§å¶å¹¶ååº¦ï¼é¿åèµæºæ¶èè¿å¤§ã</div>
<div>3ãæä¾çº¿ç¨ç®¡çåçæ§ï¼çº¿ç¨æ± æä¾äºä¸äºç®¡çåçæ§æºå¶ï¼ä¾å¦çº¿ç¨æ± çåå»ºãéæ¯ãçº¿ç¨ç¶æççæ§ç­ï¼æ¹ä¾¿å¼åäººåè¿è¡çº¿ç¨çç®¡çåè°è¯ã</div>
<div>4ãæä¾ä»»å¡éåï¼çº¿ç¨æ± éå¸¸ä¼ä½¿ç¨ä»»å¡éåæ¥å­å¨å¾æ§è¡çä»»å¡ï¼è¿æ ·å¯ä»¥å®ç°ä»»å¡çç¼å²åè°åº¦ã</div>
<div>&nbsp;</div>
<div><strong>çº¿ç¨æ± çä¸äºç¼ºç¹åæ¬ï¼</strong></div>
<div>1ãéè¦åçéç½®ï¼çº¿ç¨æ± çæ§è½åææåå°éç½®åæ°çå½±åï¼éè¦æ ¹æ®å·ä½çåºç¨åºæ¯åç¡¬ä»¶ç¯å¢æ¥åçéç½®çº¿ç¨æ± çå¤§å°ãä»»å¡éåçå¤§å°ç­åæ°ã</div>
<div>2ãå¯è½å¼åèµæºæ³é²ï¼å¦æçº¿ç¨æ± ä¸­ççº¿ç¨é¿æ¶é´é²ç½®èä¸è¢«ä½¿ç¨ï¼å¯è½ä¼å¯¼è´èµæºçæµªè´¹åæ³é²ã</div>
<div>3ãå¯è½å¼åæ­»éï¼å¨ä½¿ç¨çº¿ç¨æ± æ¶ï¼å¦æä»»å¡ä¹é´å­å¨ä¾èµå³ç³»ï¼å¯è½ä¼å¼åæ­»éé®é¢ï¼éè¦é¢å¤çæ³¨æåå¤çã</div>
<div>&nbsp;</div>
<div>
<div>
<div>
<div><strong><span style="font-size: 16px">éç¹é¢è¯é®é¢</span></strong></div>
<div>1ãsleepåwaitçåºå«ï¼</div>
<div>&nbsp; &nbsp; 1)ãsleepå±äºThreadç±»ï¼è®©åºcpuï¼ä½æ¯çæ§ç¶æä¾ç¶ä¿æèï¼æå®æ¶é´å°äºï¼å°±ä¼æ¢å¤è¿è¡ï¼</div>
<div>&nbsp; &nbsp; 2)ãwaitå±äºObjectç±»æ¹æ³ï¼éæ¾å¯¹è±¡éï¼è¿å¥ç­å¾éå®æ± ï¼éè¦notify()æè½éæ°è¿å¥è¿è¡ç¶æï¼</div>
<div>2ãwait()ãnotify() éæ¾éé®é¢ï¼</div>
<div>&nbsp; &nbsp; 1)ãwait()ä¼ç«å»éæ¾synchronized(obj)ä¸­çobjé,ä»¥ä¾¿å¶ä»çº¿ç¨å¯ä»¥æ§è¡obj.notify()</div>
<div>&nbsp; &nbsp; <span>2)ã</span>ä½æ¯notify()ä¸ä¼ç«å»ç«å»éæ¾sycronized(obj)ä¸­çobjé,å¿é¡»è¦ç­notify()æå¨çº¿ç¨æ§è¡å®synchronized(obj)åä¸­çææä»£ç æä¼éæ¾è¿æé.yield(),sleep()ä¸ä¼éæ¾éã</div>
<div>&nbsp;</div>
<div><span style="font-size: 15px"><strong>å¼æ­¥çº¿ç¨é´æ°æ®åæ­¥ä¼ éçåç§æ¹å¼</strong></span></div>
<div>æå¨è®¾ç½®ãçº¿ç¨æ± è®¾ç½®TaskDecoratorãä½¿ç¨InheritableThreadLocalãä½¿ç¨TransmittableThreadLocal</div>
<div>ä¸»çº¿ç¨</div>
</div>
</div>
<div>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> @description ç¨æ·ä¸ä¸æä¿¡æ¯</span>
<span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> OauthContext {
    </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">static</span>  <span style="color: rgba(0, 0, 255, 1)">final</span>  ThreadLocal&lt;LoginVal&gt; loginValThreadLocal=<span style="color: rgba(0, 0, 255, 1)">new</span> ThreadLocal&lt;&gt;<span style="color: rgba(0, 0, 0, 1)">();
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span><span style="color: rgba(0, 0, 0, 1)">  LoginVal get(){
        </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> loginValThreadLocal.get();
    }
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> set(LoginVal loginVal){
        loginValThreadLocal.set(loginVal);
    }
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> clear(){
        loginValThreadLocal.remove();
    }
}</span></pre>
</div>
<p>&nbsp;</p>
</div>
<div>1ãæå¨è®¾ç½®</div>
<div>æ¯æ§è¡ä¸æ¬¡å¼æ­¥çº¿ç¨é½è¦åä¸ºä¸¤æ­¥ï¼</div>
<div>&nbsp; &nbsp; 1)ãè·åç¶çº¿ç¨çå¼</div>
<div>&nbsp; &nbsp; 2)ãå°å¼è®¾ç½®å°å­çº¿ç¨ï¼è¾¾å°å¤ç¨ï¼ ä»£ç å¦ä¸ï¼</div>
<div>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> handlerAsync() {
        LoginVal loginVal </span>= OauthContext.get();  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">1. è·åç¶çº¿ç¨çloginVal</span>
        log.info("ç¶çº¿ç¨çå¼ï¼{}"<span style="color: rgba(0, 0, 0, 1)">,OauthContext.get());
        CompletableFuture.runAsync(()</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">{
           OauthContext.set(loginVal);   </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">2. è®¾ç½®å­çº¿ç¨çå¼ï¼å¤ç¨</span>
           log.info("å­çº¿ç¨çå¼ï¼{}"<span style="color: rgba(0, 0, 0, 1)">,OauthContext.get());
        });
    }</span></pre>
</div>
<p>&nbsp;</p>
</div>
<div><strong>2ãçº¿ç¨æ± è®¾ç½®TaskDecorator</strong></div>
<div>TaskDecoratoræ¯ä¸ä¸ªæ§è¡åè°æ¹æ³çæ¥å£ï¼ä¸»è¦åºç¨äºä¼ éä¸ä¸æï¼æèæä¾ä»»å¡ççæ§/ç»è®¡ä¿¡æ¯ã</div>
<div>é¦åéè¦å»å®ç°å®ï¼ä»£ç å¦ä¸ï¼</div>
</div>
<div>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> @description ä¸ä¸æè£é¥°å¨</span>
<span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">class</span> ContextTaskDecorator <span style="color: rgba(0, 0, 255, 1)">implements</span><span style="color: rgba(0, 0, 0, 1)"> TaskDecorator {
    @Override
    </span><span style="color: rgba(0, 0, 255, 1)">public</span><span style="color: rgba(0, 0, 0, 1)"> Runnable decorate(Runnable runnable) {
        LoginVal loginVal </span>= OauthContext.get();  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">è·åç¶çº¿ç¨çloginVal</span>
        <span style="color: rgba(0, 0, 255, 1)">return</span> () -&gt;<span style="color: rgba(0, 0, 0, 1)"> {
            </span><span style="color: rgba(0, 0, 255, 1)">try</span><span style="color: rgba(0, 0, 0, 1)"> {
                OauthContext.set(loginVal);  </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> å°ä¸»çº¿ç¨çè¯·æ±ä¿¡æ¯ï¼è®¾ç½®å°å­çº¿ç¨ä¸­</span>
                runnable.run();  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> æ§è¡å­çº¿ç¨</span>
            } <span style="color: rgba(0, 0, 255, 1)">finally</span><span style="color: rgba(0, 0, 0, 1)"> {
                OauthContext.clear();  </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> çº¿ç¨ç»æï¼æ¸ç©ºè¿äºä¿¡æ¯ï¼å¦åå¯è½é æåå­æ³æ¼</span>
<span style="color: rgba(0, 0, 0, 1)">            }
        };
    }
}</span></pre>
</div>
<p>è¿éæåªæ¯è®¾ç½®äºLoginValï¼å®éå¼åä¸­å¶ä»çå±äº«æ°æ®ï¼æ¯å¦SecurityContextï¼RequestAttributes....</p>
</div>
<div>
<div>TaskDecoratoréè¦ç»åçº¿ç¨æ± ä½¿ç¨ï¼å®éå¼åä¸­å¼æ­¥çº¿ç¨å»ºè®®ä½¿ç¨çº¿ç¨æ± ï¼åªéè¦å¨å¯¹åºççº¿ç¨æ± éç½®ä¸ä¸ï¼ä»£ç å¦ä¸ï¼</div>
</div>
<div>
<div class="cnblogs_code">
<pre>@Bean("taskExecutor"<span style="color: rgba(0, 0, 0, 1)">)
</span><span style="color: rgba(0, 0, 255, 1)">public</span><span style="color: rgba(0, 0, 0, 1)"> ThreadPoolTaskExecutor taskExecutor() {
        ThreadPoolTaskExecutor poolTaskExecutor </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> ThreadPoolTaskExecutor();
        poolTaskExecutor.setCorePoolSize(xx);
        poolTaskExecutor.setMaxPoolSize(xx);
        poolTaskExecutor.setKeepAliveSeconds(xx);   </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è®¾ç½®çº¿ç¨æ´»è·æ¶é´ï¼ç§ï¼</span>
        poolTaskExecutor.setQueueCapacity(xx);  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> è®¾ç½®éåå®¹é</span>
        poolTaskExecutor.setTaskDecorator(<span style="color: rgba(0, 0, 255, 1)">new</span> ContextTaskDecorator()); <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">è®¾ç½®TaskDecoratorï¼ç¨äºè§£å³ç¶å­çº¿ç¨é´çæ°æ®å¤ç¨</span>
        poolTaskExecutor.setRejectedExecutionHandler(<span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> ThreadPoolExecutor.CallerRunsPolicy());
        poolTaskExecutor.setWaitForTasksToCompleteOnShutdown(</span><span style="color: rgba(0, 0, 255, 1)">true</span>);  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> ç­å¾ææä»»å¡ç»æååå³é­çº¿ç¨æ± </span>
        <span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> poolTaskExecutor;
    }</span></pre>
</div>
<p>æ­¤æ¶ä¸å¡ä»£ç å°±ä¸éè¦å»è®¾ç½®å­çº¿ç¨çå¼ï¼ç´æ¥ä½¿ç¨å³å¯ï¼ä»£ç å¦ä¸ï¼</p>
</div>
<div>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> handlerAsync() {
        log.info(</span>"ç¶çº¿ç¨çç¨æ·ä¿¡æ¯ï¼{}"<span style="color: rgba(0, 0, 0, 1)">, OauthContext.get());
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">æ§è¡å¼æ­¥ä»»å¡ï¼éè¦æå®ççº¿ç¨æ± </span>
        CompletableFuture.runAsync(()-&amp;gt; log.info("å­çº¿ç¨çç¨æ·ä¿¡æ¯ï¼{}"<span style="color: rgba(0, 0, 0, 1)">, OauthContext.get()),taskExecutor);
    }</span></pre>
</div>
<p>è¿éä½¿ç¨çæ¯CompletableFutureæ§è¡å¼æ­¥ä»»å¡ï¼ä½¿ç¨@Asyncè¿ä¸ªæ³¨è§£åæ ·æ¯å¯è¡çã</p>
</div>
<div>
<div>æ³¨æï¼æ è®ºä½¿ç¨ä½ç§æ¹å¼ï¼é½éè¦æå®çº¿ç¨æ± </div>
<div>&nbsp;</div>
</div>
<div><strong><span style="font-size: 14px">3ãä½¿ç¨InheritableThreadLocal</span></strong></div>
<div>è¿ç§æ¹æ¡ä¸å»ºè®®ä½¿ç¨ï¼InheritableThreadLocalè½ç¶è½å¤å®ç°ç¶å­çº¿ç¨é´çå¤ç¨ï¼ä½æ¯å¨çº¿ç¨æ± ä¸­ä½¿ç¨ä¼å­å¨å¤ç¨çé®é¢ï¼è¿ç§æ¹æ¡ä½¿ç¨ä¹æ¯éå¸¸ç®åï¼ç´æ¥ç¨InheritableThreadLocalæ¿æ¢ThreadLocalå³å¯ï¼ä»£ç å¦ä¸ï¼</div>
<div>
<div class="cnblogs_code">
<pre><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> @description ç¨æ·ä¸ä¸æä¿¡æ¯</span>
<span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> OauthContext {
    </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">static</span>  <span style="color: rgba(0, 0, 255, 1)">final</span>  InheritableThreadLocal&lt;LoginVal&gt; loginValThreadLocal=<span style="color: rgba(0, 0, 255, 1)">new</span> InheritableThreadLocal&lt;&gt;<span style="color: rgba(0, 0, 0, 1)">();
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span><span style="color: rgba(0, 0, 0, 1)">  LoginVal get(){
        </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> loginValThreadLocal.get();
    }
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> set(LoginVal loginVal){
        loginValThreadLocal.set(loginVal);
    }
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">static</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> clear(){
        loginValThreadLocal.remove();
    }
}</span></pre>
</div>
<p>&nbsp;</p>
</div>
<div><strong><span style="font-size: 15px">4ãä½¿ç¨TransmittableThreadLocal</span></strong></div>
<div><span>TransmittableThreadLocalæ¯é¿éå¼æºçå·¥å·ï¼å¼¥è¡¥äºInheritableThreadLocalçç¼ºé·ï¼å¨ä½¿ç¨çº¿ç¨æ± ç­ä¼æ± åå¤ç¨çº¿ç¨çæ§è¡ç»ä»¶æåµä¸ï¼æä¾ThreadLocalå¼çä¼ éåè½ï¼è§£å³å¼æ­¥æ§è¡æ¶ä¸ä¸æä¼ éçé®é¢ã</span></div>
<div>&nbsp;</div>
<div><strong>TransmittableThreadLocalåç</strong></div>
<div><span>TransimittableThreadLocalç»§æ¿äºInheritableThreadLocalï¼å¹¶å®ç°TtlCopieræ¥å£ï¼å®éé¢åªæä¸ä¸ªcopyæ¹æ³ãæä»¥ä¸»è¦æ¯å¯¹InheritableThreadLocalçæ©å±ã</span></div>
<div>
<div><span>å¨TransimittableThreadLocalä¸­æ·»å holderå±æ§ãè¿ä¸ªå±æ§çä½ç¨å°±æ¯è¢«æ è®°ä¸ºå·å¤çº¿ç¨ä¼ éèµæ ¼çå¯¹è±¡é½ä¼è¢«æ·»å å°è¿ä¸ªå¯¹è±¡ä¸­ã</span></div>
<div>è¦æ è®°ä¸ä¸ªç±»ï¼å¯ä»¥ç»è¿ä¸ªç±»æ°å¢ä¸ä¸ªTypeå­æ®µï¼è¿æä¸ä¸ªæ¹æ³å°±æ¯å°å·å¤è¿ç§ç±»åççå¯¹è±¡é½æ·»å å°ä¸ä¸ªéæå¨å±éåä¸­ï¼ä¹åä½¿ç¨æ¶ï¼è¿ä¸ªéåéçææå¼é½å·å¤è¿ä¸ªæ è®°ã</div>
<div>åºç¨ä»£ç æ¯éè¿TtlExecutorså·¥å·ç±»å¯¹çº¿ç¨æ± å¯¹è±¡è¿è¡åè£ãå·¥å·ç±»åªæ¯ç®åçå¤æ­ï¼è¾å¥ççº¿ç¨æ± æ¯å¦å·²ç»è¢«åè£è¿ãéç©ºæ ¡éªç­ï¼ç¶åè¿ååè£ç±»ExecutorServiceTtlWrapperãæ ¹æ®ä¸åççº¿ç¨æ± ç±»åï¼æä¸ååçåè£ç±»ã</div>
<div>è¿å¥åè£ç±»ExecutorServiceTtlWrapperãå¯ä»¥æ³¨æå°ä¸è®ºæ¯éè¿ExecutorServiceTtlWrapper#submitæ¹æ³æèæ¯ExecutorTtlWrapper#executeæ¹æ³ï¼é½ä¼å°çº¿ç¨å¯¹è±¡åè£æTtlCallableæèTtlRunnableï¼ç¨äºå¨çæ­£æ§è¡runæ¹æ³ååä¸äºä¸å¡é»è¾ã</div>
</div>
<div><span>æä»¥ï¼éç¹çæ ¸å¿é»è¾åºè¯¥æ¯å¨TtlCallable#call()æèTtlRunnable#run()ä¸­ãä»¥ä¸ä»¥TtlCallableä¸ºä¾ï¼TtlRunnableåçç±»ä¼¼ã</span></div>
<div><span>æ»çæ¥è¯´å¨åå»ºTtlCallableå¯¹è±¡æ¯ï¼è°ç¨capture()æ¹æ³æè·è°ç¨æ¹çæ¬å°çº¿ç¨åéï¼å¨call()æ§è¡æ¶ï¼å°æè·å°ççº¿ç¨åéï¼æ¿æ¢å°çº¿ç¨æ± æå¯¹åºè·åå°ççº¿ç¨çæ¬å°åéä¸­ï¼å¹¶ä¸å¨æ§è¡å®æä¹åï¼å°å¶æ¬å°åéæ¢å¤å°è°ç¨ä¹åã</span></div>
<div><span>&nbsp;</span></div>
<div>&nbsp;</div>
<div><strong><span style="font-size: 18px">é«å¹¶å</span></strong></div>
<div><img width="361" data-src="https://img2024.cnblogs.com/blog/2337379/202512/2337379-20251216211723738-355204496.png" class="lazyload"></div>
<div><strong><span style="font-size: 16px">é«å¹¶åç³»ç»ç³»ç»ææ </span></strong></div>
<div><span>1ãQPSï¼Queries Per Second</span>ï¼</div>
<div>QPS æ¯æ¯ç§è¯·æ±æ°ï¼æ¯è¡¡éä¿¡æ¯ç³»ç»å¨ä¸ç§éåæ¥æ¶å°çæç´¢æµéçä¸ç§å¸¸è§åº¦éææ ï¼è¢«å¹¿æ³åºç¨å¨ä»»ä½è¯·æ±-ååºçç³»ç»ä¸­ãå¯¹äºé«å¹¶åçç³»ç»ï¼å¿é¡»è¦å³æ³¨ QPSï¼è¿æ ·ä½ æè½æå¯¼ä½ çç³»ç»ä½æ¶éè¦è¿è¡æ©å®¹ã</div>
<div>2ãTPSï¼Transactions Per Secondï¼</div>
<div>TPS æ¯æ¯ç§çäºå¡æ°éï¼æ¯è½¯ä»¶æµè¯ç»æçæµéåä½ï¼ä¸ä¸ªäºå¡æ¯æä¸ä¸ªå®¢æ·ç«¯åæå¡å¨åéè¯·æ±ç¶åæå¡å¨ååºååºçè¿ç¨ãå®¢æ·ç«¯å¨åéè¯·æ±æ¶å¼å§è®¡æ¶ï¼æ¶å°æå¡å¨ååºåç»æè®¡æ¶ï¼ç¨æ¥è®¡ç®ä½¿ç¨çæ¶é´åå®æçäºå¡ä¸ªæ°ã</div>
<div>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;QPS VS TPS</div>
<div>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;QPS åºæ¬å¯ä»¥çè§£ä¸ºç±»ä¼¼äº TPSï¼ä½ä¸åçæ¯ï¼å¯¹äºä¸ä¸ªé¡µé¢çä¸æ¬¡è®¿é®ï¼å½¢æä¸ä¸ª TPSï¼ä½ä¸æ¬¡é¡µé¢è¯·æ±ï¼å¯è½ä¼äº§çå¤æ¬¡å¯¹æå¡å¨çè¯·æ±ï¼å°±æ¯è¯´ä¼æå¤ä¸ª QPSã</div>
<div>3ãRTï¼Response-timeï¼</div>
<div>RT å³ååºæ¶é´ï¼æ¯æä¸ä¸ªè¯·æ±ä»å¼å§å°æåæ¶å°ååºæ°æ®ç»ææè±è´¹çæ»æ¶é´ï¼å®çæ°å¼å¤§å°ç´æ¥ååºäºç³»ç»çå¿«æ¢ã</div>
<div>4ãå¹¶åæ°</div>
<div><span>å¹¶åæ°æ¯æç³»ç»åæ¶è½å¤ççè¯·æ±æ°éï¼è¿ä¸ªææ ååºäºç³»ç»çè´è½½è½åãå¹¶åæå³çå¯ä»¥åæ¶è¿è¡å¤ä¸ªå¤çï¼å¹¶åå¨ç°ä»£ç¼ç¨ä¸­æ å¤ä¸å¨ã</span></div>
<div>5ãååé</div>
<div>ç³»ç»çååéåå¤çå¯¹ CPU çæ¶èãå¤é¨æ¥å£ãIO ç­å¤ä¸ªå ç´ ç´§å¯ç¸å³ï¼åä¸ªå¤çè¯·æ±å¯¹ CPU æ¶èè¶é«ï¼å¤é¨ç³»ç»æ¥å£ãIO éåº¦è¶æ¢ï¼ç³»ç»çååè½åè¶ä½ï¼åä¹è¶é«ãç³»ç»ååéæå ä¸ªéè¦ææ åæ°ï¼QPS/TPSãå¹¶åæ°ãååºæ¶é´ã</div>
<div><span style="font-family: Arial">&nbsp;</span></div>
<div>
<div>&nbsp;&nbsp; &nbsp;QPS/TPSï¼æ¯ç§è¯·æ±/äºå¡æ°éã</div>
<div>&nbsp;&nbsp; &nbsp;å¹¶åæ°ï¼ ç³»ç»åæ¶å¤ççè¯·æ±/äºå¡æ°ã</div>
<div>&nbsp;&nbsp; &nbsp;ååºæ¶é´ï¼ ä¸è¬åè¯·æ±å¹³åååºæ¶é´ã</div>
<div>çè§£äºä¸é¢ä¸ä¸ªææ çæä¹ä¹åï¼å°±è½æ¨ç®åºå®ä»¬ä¹é´çå³ç³»ï¼</div>
<div>QPS(TPS) = å¹¶åæ°/å¹³åååºæ¶é´</div>
<div>å¹¶åæ° = QPS*å¹³åååºæ¶é´</div>
<div>&nbsp;</div>
<div><strong><span style="font-size: 18px">å®éä¸¾ä¾</span></strong></div>
<div>æå®ç´æ­ä¸å¡è¦æ±é¢ä¼°è®¡ç®å¯¹åºçåä¸ªææ ãæ­£å¸¸å¨è¿è¡æµéä¼°ç®çæ¶åï¼ä¼éç¨äºå«å®å¾ï¼å¦ææ¯å¤© 80% çè®¿é®éä¸­å¨ 20% çæ¶é´æ®µéï¼é£è¿ä¸ª 20% çæ¶é´å°±è¢«ç§°ä¸ºå³°å¼æ¶é´ã</div>
<div>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span>å³°å¼æ¶é´ç QPS = ï¼æ» PV æ° * 80%ï¼/ï¼æ¯å¤©ç§æ° * 20%ï¼</span></div>
<div>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span>éè¦çæºå¨æ°é = å³°å¼æ¶é´ç QPS / åå°æºå¨ç QPS</span></div>
<div>æ¯å¤©300w PV çå¨åå°æºå¨ä¸ï¼è¿å°æºå¨éè¦å¤å°QPSï¼</div>
<div>&nbsp; &nbsp;&nbsp;( 3000000 * 0.8 ) / (86400 * 0.2 ) = 139 (QPS)</div>
<div>å¦æä¸å°æºå¨çQPSæ¯58ï¼éè¦å å°æºå¨æ¥æ¯æï¼</div>
<div>&nbsp; &nbsp;&nbsp;139 / 58 = 3</div>
<div>é«å¹¶åç³»ç»çç®æ ä»ç³»ç»å±é¢çï¼æé«æ§è½ãé«å¯ç¨åé«æ©å±ä¸ä¸ªç®æ </div>
</div>
<div>&nbsp;</div>
<div><strong><span style="font-size: 18px">é«å¹¶åè§£å³æ¹æ¡</span></strong></div>
<div><span>ä½¿ç¨åå¸å¼å¾®æå¡æ¶ææ¨¡å¼ãéç¾¤é¨ç½²ä¸è´è½½åè¡¡ãç¨åå¸å¼ç¼å­ãä½¿ç¨æ¶æ¯éåãååºåè¡¨ãè¯»ååç¦»ãéæµåçæ­ãå¨éåç¦»ãä½¿ç¨åå¸å¼æ°æ®åºãæ°æ®åºä¼åã</span></div>
<div><strong>1ãä½¿ç¨åå¸å¼å¾®æå¡æ¶ææ¨¡å¼</strong></div>
<div>å°ä¸ä¸ªç³»ç»æåä¸ºå¤ä¸ªå­ç³»ç»ã&nbsp;å¾®æå¡æ¶ææåï¼æå¸¸è§çå°±æ¯Spring Cloud åSpring Cloud Alibabaãç¶åæ¯ä¸ªç³»ç»è¿ä¸ä¸ªæ°æ®åºï¼è¿æ ·æ¬æ¥å°±ä¸ä¸ªåºï¼ç°å¨å¤ä¸ªæ°æ®åºï¼è¿æ ·å°±å¯ä»¥æé«å¹¶åã</div>
<div><strong>2ãéç¾¤é¨ç½²ä¸è´è½½åè¡¡</strong></div>
<div>å°ç³»ç»é¨ç½²å¨å¤å°æå¡å¨ä¸ï¼éç¨è´è½½åè¡¡å°ç¨æ·è¯·æ±ååå°ååå°åä¸ªæå¡å¨è¿è¡å¤çï¼ åæåå°æå¡å¨çååï¼è¿ç§æ¹å¼å¯ä»¥éè¿æ·»å æ°çæå¡å¨æèæå¡èç¹æ¥æé«ç³»ç»çæ´ä½å¤çè½åï¼ æé«ç³»ç»çå¹¶åå¤çè½ååæ´ä½æ§è½ã</div>
<div>è´è½½åè¡¡ï¼Load Balancingï¼æ¯ä¸ç§åå¸å¼ç³»ç»æ¶æä¸­çææ¯ï¼ç¨äºå°ç½ç»è¯·æ±æä»»å¡åæ£å°å¤ä¸ªæå¡å¨æèµæºä¸ã</div>
<div>æ¯å¦ï¼å½ç³»ç»é¢ä¸´å¤§éç¨æ·è®¿é®ï¼è´è½½è¿é«çæ¶åï¼éå¸¸ä¼ä½¿ç¨å¢å æå¡å¨æ°éæ¥è¿è¡æ¨ªåæ©å±æ¥æé«æ´ä¸ªç³»ç»çå¤çè½åã</div>
<div>è´è½½åè¡¡å¯ä»¥å¨ä¸åçå±æ¬¡ä¸å®ç°ï¼åæ¬ï¼</div>
<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;ç¡¬ä»¶è´è½½åè¡¡å¨ï¼&nbsp;ä½¿ç¨ä¸é¨çç¡¬ä»¶è®¾å¤æ¥å®ç°è´è½½åè¡¡ï¼å¦ç¡¬ä»¶è´è½½åè¡¡å¨ã</div>
<div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;è½¯ä»¶è´è½½åè¡¡å¨ï¼&nbsp;å¨åºç¨å±æç½ç»å±ä½¿ç¨è½¯ä»¶æ¥å®ç°è´è½½åè¡¡ï¼å¦ååä»£çæå¡å¨ãè´è½½åè¡¡ç®æ³ã</div>
<div>å¨è´è½½åè¡¡çè®¾è®¡ä¸­ï¼æå ç§å¸¸è§çè´è½½åè¡¡ç­ç¥ï¼</div>
<div>&nbsp; &nbsp;&nbsp;1ãè½®è¯¢ï¼Round Robinï¼ï¼&nbsp;å°è¯·æ±ä¾æ¬¡åéç»æå¡å¨åè¡¨ä¸­çæ¯ä¸ªæå¡å¨ï¼æ¯æ¬¡è¯·æ±åç§»å¨å°ä¸ä¸ä¸ªæå¡å¨ãéç¨äºæå¡å¨æ§è½ç¸è¿çæåµã</div>
<div>&nbsp; &nbsp; &nbsp; 2ãå æè½®è¯¢ï¼Weighted Round Robinï¼ï¼&nbsp;ç±»ä¼¼äºè½®è¯¢ï¼ä½æ¯ä¸ªæå¡å¨æä¸åçæéï¼å¯ä»¥æ ¹æ®æå¡å¨æ§è½è°æ´æéã</div>
<div>&nbsp; &nbsp; &nbsp; 3ãæå°è¿æ¥ï¼Least Connectionsï¼ï¼&nbsp;å°è¯·æ±åéç»å½åè¿æ¥æ°æå°çæå¡å¨ï¼ä»¥ç¡®ä¿è´è½½åè¡¡ãéç¨äºé¿è¿æ¥çæåµã</div>
<div>&nbsp; &nbsp; &nbsp; 4ãå ææå°è¿æ¥ï¼Weighted Least Connectionsï¼ï¼&nbsp;ç±»ä¼¼äºæå°è¿æ¥ï¼ä½æ¯ä¸ªæå¡å¨æä¸åçæéï¼å¯ä»¥æ ¹æ®æå¡å¨æ§è½è°æ´æéã</div>
<div>&nbsp; &nbsp; &nbsp; 5ãéæºï¼Randomï¼ï¼&nbsp;éæºéæ©ä¸ä¸ªæå¡å¨æ¥å¤çè¯·æ±ï¼éç¨äºç®åçè´è½½åè¡¡éæ±ã</div>
<div>&nbsp; &nbsp; &nbsp; 6ãIP åå¸ï¼IP Hashï¼ï¼&nbsp;æ ¹æ®å®¢æ·ç«¯ IP å°åçåå¸å¼æ¥éæ©æå¡å¨ï¼å¯ä»¥ç¡®ä¿åä¸å®¢æ·ç«¯çè¯·æ±å§ç»åéå°åä¸æå¡å¨ã</div>
<div><strong>3ãåå¸å¼ç¼å­</strong></div>
<div>å¤§é¨åçé«å¹¶ååºæ¯ï¼é½æ¯è¯»å¤åå°ï¼é£ä½ å®å¨å¯ä»¥å¨æ°æ®åºåç¼å­éé½åä¸ä»½ï¼ç¶åè¯»çæ¶åå¤§éèµ°ç¼å­ä¸å°±å¾äºãæ¯ç«äººå®¶redisè½»è½»æ¾æ¾åæºå ä¸çå¹¶ååãæ²¡é®é¢çãæä»¥ä½ å¯ä»¥èçèèèä½ çé¡¹ç®éï¼é£äºæ¿è½½ä¸»è¦è¯·æ±è¯»åºæ¯ï¼æä¹ç¨ç¼å­æ¥æé«å¹¶åãï¼ç¼å­ä½ ä¹å¯ä»¥èèéç¾¤ï¼ä¸è¿åæå°±æ¯ä½ çæå¡å¨å¾æ¯ææä¹å¤é«è´è·çä¸­é´ä»¶ãä¿è¯è¯´æ²¡æä»»ä½äºç©å ä¸å±è§£å³ä¸äºçï¼å¦æä¸å±ä¸è¡ï¼å°±å¨å ä¸å±è§£å³ï¼</div>
<div>
<div>ä¸äºå¸¸è§çåå¸å¼ç¼å­ç³»ç»åæ¬ï¼ï¼</div>
<div>&nbsp;&nbsp; &nbsp;1)ãRedisï¼&nbsp;Redis æ¯ä¸ç§åºäºåå­çé®å¼å­å¨ç³»ç»ï¼æ¯æå¤ç§æ°æ®ç»æï¼å¦å­ç¬¦ä¸²ãåå¸ãåè¡¨ç­ï¼éç¨äºå¿«éè¯»åååå¥åºæ¯ã&nbsp;&nbsp;</div>
<div>&nbsp;&nbsp; &nbsp;2)ãMemcachedï¼&nbsp;Memcached ä¹æ¯ä¸ç§åºäºåå­çé®å¼å­å¨ç³»ç»ï¼éç¨äºåå¸å¼ç¼å­åç¼å­å±äº«ã</div>
<div>&nbsp; &nbsp; 3)ãHazelcastï¼&nbsp;Hazelcast æ¯ä¸ä¸ªå¼æºçåå¸å¼æ°æ®å­å¨åè®¡ç®å¹³å°ï¼æ¯æåå¸å¼ç¼å­ãåå¸å¼è®¡ç®ç­ã</div>
<div>&nbsp; &nbsp; 4)ãCouchbaseï¼&nbsp;Couchbase æ¯ä¸ä¸ªåå¸å¼ç¼å­åæ°æ®åºç³»ç»ï¼ç»åäºç¼å­åææ¡£å­å¨çåè½ã</div>
<div>&nbsp; &nbsp; 5)ãEhcacheï¼&nbsp;Ehcache æ¯ä¸ä¸ª Java ç¼å­åºï¼å¯ä»¥ä½ä¸ºæ¬å°ç¼å­æåå¸å¼ç¼å­ä½¿ç¨ã</div>
<div>å½ç¶ï¼è¿éä½¿ç¨æå¤çè¿æ¯Redisã</div>
</div>
<div><strong>4ãMQ(æ¶æ¯éå)</strong></div>
<div>å¯è½ä½ è¿æ¯ä¼åºç°é«å¹¶ååçåºæ¯ï¼æ¯å¦è¯´ä¸ä¸ªä¸å¡æä½éè¦é¢ç¹ææ°æ®åºå åæ¬¡ï¼å¢å æ¹å¢å æ¹ï¼ç¯äºãé£é«å¹¶åç»å¯¹ææä½ çç³»ç»ï¼äººå®¶æ¯ç¼å­ä½ è¦æ¯ç¨redisæ¥æ¿è½½åé£è¯å®ä¸è¡ï¼æ°æ®éæ¶å°±è¢«LRU(æ·æ±°ææä¸ç»å¸¸ä½¿ç¨ç)äºï¼æ°æ®æ ¼å¼è¿æ æ¯ç®åï¼æ²¡æäºå¡æ¯æãæä»¥è¯¥ç¨mysqlè¿å¾ç¨mysqlåãé£ä½ ååï¼ç¨MQå§ï¼å¤§éçåè¯·æ±çå¥MQéï¼æéæ¢æ¢ç©å¿ï¼åè¾¹ç³»ç»æ¶è´¹åæ¢æ¢åï¼æ§å¶å¨mysqlæ¿è½½èå´ä¹åãæä»¥ä½ å¾èèèèä½ çé¡¹ç®éï¼é£äºæ¿è½½å¤æåä¸å¡é»è¾çåºæ¯éï¼å¦ä½ç¨MQæ¥å¼æ­¥åï¼æåå¹¶åæ§ãMQåæºæå ä¸å¹¶åä¹æ¯okçãï¼è¿ä¸ªæ¯æ ¹æ®èªå·±çä¸å¡æ¥ç¨çï¼ä¸è¬ä¸­å°åé¡¹ç®ç¨rabbitmqå°±å¤äºï¼å»ºè®®æ¥å¿ç¨kafkaï¼è¿æ ·æ¥å¿çæ°éå¤å°±å¯ä»¥å¾å¥½çè§£å³ï¼</div>
<div>&nbsp;</div>
<div><strong>5ãååºåè¡¨</strong></div>
<div>å¯è½å°äºæåæ°æ®åºå±é¢è¿æ¯åä¸äºæé«å¹¶åçè¦æ±ï¼å¥½å§ï¼é£ä¹å°±å°ä¸ä¸ªæ°æ®åºæåä¸ºå¤ä¸ªåºï¼å¤ä¸ªåºæ¥ææ´é«çå¹¶åï¼ç¶åå°ä¸ä¸ªè¡¨æåä¸ºå¤ä¸ªè¡¨ï¼æ¯ä¸ªè¡¨çæ°æ®éä¿æå°ä¸ç¹ï¼æé«sqlè·çæ§è½ãï¼è¿ä¸ªåæä½ çæå¡å¨å¾æ¯æï¼ä¸ç¶å¼å¾åä¸½è±å¨ï¼</div>
<div>1.ä»ä¹æ¯ååºåè¡¨ï¼</div>
<div>1.1 ååº</div>
<div>
<div>ååºæ¯æå¨è¡¨æ°éä¸åçæåµä¸å¯¹åºè¿è¡ååã</div>
<div>ä¸¾ä¾ï¼å¦ä¸å¾ï¼æ°æ®åºA ä¸­å­æ¾äº user å order ä¸¤å¼ è¡¨ï¼å°ä¸¤å¼ è¡¨ååå°ä¸¤ä¸ªæ°æ®åºä¸­ï¼userè¡¨æ¾å° database Aï¼orderè¡¨æ¾å° database B</div>
<div>1.2 åè¡¨</div>
<div>åè¡¨æ¯æå¨åºæ°éä¸åçæåµä¸å¯¹è¡¨è¿è¡ååã</div>
<div>ä¸¾ä¾ï¼å¦ä¸å¾ï¼æ°æ®åº A ä¸­å­æ¾äº userè¡¨ï¼å° userè¡¨ååæ user1 å user2 ä¸¤å¼ è¡¨å¹¶æ¾å° database Aä¸­ã</div>
<div>1.3 ååºåè¡¨</div>
<div>ååºåè¡¨æ¯æåºåè¡¨é½ååï¼æ°éé½åçååã</div>
<div>ä¸¾ä¾ï¼å¦ä¸å¾ï¼æ°æ®åº A ä¸­å­æ¾äº userè¡¨ï¼å° userè¡¨ååæ user1ãuser2ãuser3ãuser4 åå¼ è¡¨ï¼user1 å user2 æ¾å° database Aä¸­ï¼user3 å user4 æ¾å° database B ä¸­ã</div>
<div>2. å¦ä½åååºåè¡¨ï¼</div>
<div><span>ä¸»æµçååæ¹å¼æ 3ç§ï¼æ°´å¹³ååãåç´åååæ··åååã</span></div>
<div>2.1 æ°´å¹³åå</div>
<div>æ°´å¹³åååå«æ°´å¹³ååºåæ°´å¹³åè¡¨ã</div>
<div>2.1.1 æ°´å¹³åè¡¨</div>
<div><span>æ°´å¹³åè¡¨æçè¡¨ç»æä¸åï¼å°åè¡¨æ°æ®ååæå¤è¡¨ãåååçç»æï¼æ¯ä¸ªè¡¨çç»æä¸æ ·ï¼æ°æ®ä¸ä¸æ ·ï¼ææè¡¨çæ°æ®å¹¶éä¸ºå¨éæ°æ®ã</span></div>
<div>ä¸¾ä¾ï¼å¦ä¸å¾ï¼orderè¡¨ï¼æç§ oder_id çæ°æ®èå´æ°´å¹³ååååæäº order1 å order2 è¡¨ï¼ä¸¤ä¸ªè¡¨çç»æä¸æ ·ï¼æ°æ®ä¸åã</div>
<div>2.1.2 æ°´å¹³ååº</div>
<div><span>æ°´å¹³ååºæ¯æï¼å°è¡¨æ°´å¹³ååååå°ä¸åçæ°æ®åºï¼ä½¿å¾æ¯ä¸ªåºå·æç¸åçè¡¨ï¼è¡¨ä¸­çæ°æ®ä¸ç¸åï¼æ°´å¹³ååºä¸è¬æ¯ä¼´éæ°´å¹³åè¡¨ã</span></div>
<div>ä¸¾ä¾ï¼å¦ä¸å¾ï¼order è¡¨ï¼æ°´å¹³åååï¼åå° database A å database B ä¸­ï¼è¿æ ·åæ¥ä¸ä¸ªåºå°±è¢«æåæ 2ä¸ªåºã</div>
<div>2.2 åç´åå</div>
<div>åç´åååå«åç´ååºååç´åè¡¨ã</div>
<div>2.2.1 åç´åè¡¨</div>
<div><span>åç´åè¡¨æå°å­å¨ä¸å¼ è¡¨ä¸­çå­æ®µååå°å¤å¼ è¡¨ãåååçç»æï¼æ¯ä¸ªè¡¨çç»æä¸ä¸æ ·ï¼æ°æ®ä¹ä¸ä¸æ ·ï¼ææè¡¨çå­æ®µå¹¶éæ¯åè¡¨çå­æ®µã</span></div>
<div>ä¸¾ä¾ï¼å¦ä¸å¾ï¼order è¡¨ï¼æ ¹æ®å­æ®µåç´ååï¼ååå order_baseè¡¨åå«ä¸é¨åå­æ®µçæ°æ® å order_infoè¡¨åå«å¦ä¸é¨åå­æ®µçæ°æ®ã</div>
<div>2.2.2 åç´ååº</div>
<div>åç´ååºæçæ¯ï¼å°åä¸ªåºä¸­çè¡¨åå°å¤ä¸ªåºï¼æ¯ä¸ªåºåå«çè¡¨ä¸ä¸æ ·ã</div>
<div>ä¸¾ä¾ï¼å¦ä¸å¾ï¼database A ä¸­ç order è¡¨ å userè¡¨ï¼åç´ååºä¸º database A åå« orderè¡¨ï¼database B åå« user è¡¨ã</div>
<div>2.3 æ··ååå</div>
<div>æ··åååå¶å®å°±æ¯æ°´å¹³ååååç´ååçç»å</div>
</div>
<div><strong>6ãè¯»ååç¦»</strong></div>
<div>è¿ä¸ªå°±æ¯è¯´å¤§é¨åæ¶åæ°æ®åºå¯è½ä¹æ¯è¯»å¤åå°ï¼æ²¡å¿è¦ææè¯·æ±é½éä¸­å¨ä¸ä¸ªåºä¸å§ï¼å¯ä»¥æä¸ªä¸»ä»æ¶æï¼ä¸»åºåå¥ï¼ä»åºè¯»åï¼æä¸ä¸ªè¯»ååç¦»ãè¯»æµéå¤ªå¤çæ¶åï¼è¿å¯ä»¥å æ´å¤çä»åºã</div>
<div><strong>&nbsp;</strong></div>
<div><strong>7ãéæµåçæ­</strong></div>
<div>éæµï¼Rate Limitingï¼åçæ­ï¼Circuit Breakingï¼æ¯åå¸å¼ç³»ç»ä¸­å¸¸ç¨çä¸¤ç§æµéæ§å¶åå®¹éæºå¶ã</div>
<div>å¹¶åéé«çæåµä¸ï¼å©ç¨SpringCloudçHystrixç»ä»¶(çæ§åçæ­å¨)è¿è¡éæµçæ­å¤çï¼ é¦åä¿æ¤æ ¸å¿ç³»ç»çå®å¨æ§ï¼</div>
<div><img width="382" data-src="https://img2024.cnblogs.com/blog/2337379/202512/2337379-20251216211723623-638076462.png" class="lazyload"></div>
<div>&nbsp;</div>
<div><strong>8ãå¨éåç¦»</strong></div>
<div>å°cssãhtmlãjpgã&nbsp;js&nbsp;ç­&nbsp;éææä»¶åå¨æé¡µé¢åºåå¼</div>
<div>&nbsp;</div>
<div><strong>9ãä½¿ç¨åå¸å¼æ°æ®åº</strong></div>
<div>åå¸å¼æ°æ®åºæ¯ä¸ç§æ°æ®åºç³»ç»ï¼å°æ°æ®åæ£å­å¨å¨å¤ä¸ªç©çèç¹ææå¡å¨ä¸ï¼ä»¥æé«ç³»ç»çæ§è½ãå¯æ©å±æ§åå¯ç¨æ§ã</div>
<div>
<div>åå¸å¼æ°æ®åºåç±»ï¼</div>
<div>1.åå¸å¼å³ç³»åæ°æ®åº</div>
<div>è¿ç±»æ°æ®åºå°å³ç³»åæ°æ®åºçç¹æ§ä¸åå¸å¼ç³»ç»çä¼å¿ç¸ç»åï¼æä¾äºæ¯æSQLæ¥è¯¢åäºå¡çè½åã</div>
<div>ä¸äºä¾å­åæ¬ï¼Google Cloud SpannerãTiDBä¸ç§å¨çåå¸å¼çå³ç³»åæ°æ®åºï¼æä¾äºå¼ºä¸è´æ§åæ°´å¹³æ©å±è½åã</div>
<div>2.åå¸å¼åå¼æ°æ®åº</div>
<div>è¿ç±»æ°æ®åºä»¥åå¼å­å¨æ¹å¼å­å¨æ°æ®ï¼éç¨äºå¤§è§æ¨¡åæåæ¥è¯¢éæ±ã</div>
<div>Apache Cassandraï¼ä¸ä¸ªåå¸å¼çNoSQLæ°æ®åºï¼éç¨äºé«å¯ç¨æ§åå¯æ©å±æ§çåºæ¯ã</div>
<div>HBaseï¼ä¸ä¸ªåºäºHadoopçåå¸å¼åå¼æ°æ®åºï¼éç¨äºå¤§æ°æ®å­å¨åå®æ¶æ¥è¯¢ã</div>
<div><span>3.</span>åå¸å¼ææ¡£æ°æ®åº</div>
<div>è¿ç±»æ°æ®åºä»¥ææ¡£ä¸ºåä½å­å¨æ°æ®ï¼éç¨äºåç»æåæ°æ®ã</div>
<div>MongoDBï¼ä¸ä¸ªé¢åææ¡£çNoSQLæ°æ®åºï¼æ¯æåå¸å¼é¨ç½²åæ°´å¹³æ©å±ã</div>
<div>Couchbaseï¼ä¸ä¸ªåå¸å¼NoSQLæ°æ®åºï¼æ¯æææ¡£åé®å¼æ°æ®æ¨¡åã</div>
<div>ä½¿ç¨åå¸å¼æ°æ®åºç³»ç»ï¼å¦åå¸å¼ NoSQL æ°æ®åºï¼æ¥æé«æ°æ®å­å¨åæ¥è¯¢çå¹¶åå¤çè½åã</div>
<div><strong>10ãæ°æ®åºä¼å</strong></div>
<div>ä¼åæ°æ®åºçè®¾è®¡ãç´¢å¼ãæ¥è¯¢è¯­å¥ç­ï¼æé«æ°æ®åºçè¯»åæ§è½ã</div>
<div>ç»¼åè¿ç¨ä¸è¿°é«å¹¶åæ¶æè§£å³æ¹æ¡ï¼é½å¯ä»¥æå»ºåºå·æé«æ§è½ãé«å¯ç¨åå¯æ©å±æ§çç³»ç»ï¼æ»¡è¶³å¤§éå¹¶åè¯·æ±çéæ±ã</div>
</div>
</div>
<div>&nbsp;</div>
</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-09 09:14">2026-01-09 09:14</span>&nbsp;
<a href="https://www.cnblogs.com/philry">å¤§èæ2ç¹0</a>&nbsp;
éè¯»(<span id="post_view_count">139</span>)&nbsp;
è¯è®º(<span id="post_comment_count">1</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19359433);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19359433', targetLink: 'https://www.cnblogs.com/philry/p/19359433', title: 'çº¿ç¨æ± åé«å¹¶å' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ GISä¸­çâé«åº¦âå°åºæä»ä¹ï¼ä¸æåæ¸æ­£é«ãæ­£å¸¸é«ä¸å¤§å°é«çåºå« ]]></title>
    <link>https://www.cnblogs.com/charlee44/p/19458808</link>
    <guid>a41e3b48c6758ced7a58a0d6b79345a5</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/charlee44/p/19458808" title="åå¸äº 2026-01-08 21:56">
    <span role="heading" aria-level="2">GISä¸­çâé«åº¦âå°åºæä»ä¹ï¼ä¸æåæ¸æ­£é«ãæ­£å¸¸é«ä¸å¤§å°é«çåºå«</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                    <div id="cnblogs_post_description" style="display: none">
        
        æ·±å¥è§£æ GIS ä¸­é«ç¨åèç³»ç»çæ ¸å¿æ¦å¿µââå¤§å°æ°´åé¢ãä¼¼å¤§å°æ°´åé¢ä¸åèæ¤­çé¢çå³ç³»ï¼åæ¸æ­£é«ãæ­£å¸¸é«ä¸å¤§å°é«çåºå«åè½¬æ¢æ¹æ³ï¼å¹¶ä»ç»æå½é«ç¨åºåä¸å¨çéåæ¨¡åã
    </div>
<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<blockquote>
<p><strong>èéèªãGISåºç¡åçä¸ææ¯å®è·µãç¬¬2ç«  å°çç©ºé´åèç³»ç»</strong><br>
ä½èåååå®¹ï¼è½¬è½½è¯·æ³¨æåºå¤ã</p>
</blockquote>
<p><img alt="GISåºç¡åçä¸ææ¯å®è·µ" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260108214912483-1927447549.jpg" class="lazyload"></p>
<h2 id="23-é«ç¨åèç³»ç»">2.3 é«ç¨åèç³»ç»</h2>
<p>ä½¿ç¨ç»åº¦åçº¬åº¦è¡¨ç¤ºçå°çåæ ç³»æ¯ä¸ç§æ°´å¹³åæ ç³»ç»ï¼è¿éçæ°´å¹³åæ ç³»ç»å¹¶ä¸è¡¨ç¤ºå¶å°±æ¯å¹³é¢åæ ç³»çææï¼æ´åç¡®çå«ä¹æ¯å¶è¡¨è¾¾äºä¸ç»´ç©ºé´åæ ç³»çä¸¤ä¸ªç»´åº¦ï¼ï¼ç¼ºå°å¯¹äºç¬¬ä¸ç»´åº¦ä¹å°±æ¯é«ç¨çåèï¼ä¹å°±æ¯æ¬èæä»¬è¦ä»ç»çï¼é«ç¨åèç³»ç»ãé«ç¨åèç³»ç»æ¯ä¸ç§åç´åæ ç³»ã</p>
<h3 id="231-å¤§å°æ°´åé¢">2.3.1 å¤§å°æ°´åé¢</h3>
<p>æä»¬ç¥éï¼åèæ¤­çä½æ¯å¯¹å°çè¡¨é¢çä¸ç§é¼è¿ãé£ä¹é®é¢æ¥äºï¼åèæ¤­çä½æ¯ç¨åé©¬æéå±±æå¨çé«åº¦è¿è¡é¼è¿ï¼è¿æ¯ä»¥é©¬éäºçº³æµ·æ²çé«åº¦è¿è¡é¼è¿ï¼ç­æ¡è¯å®é½ä¸æ¯ãå¶å®ï¼è¿å¶ä¸­è¿éèäºå¦ä¸ä¸ªé¼å°çèªç¶è¡¨é¢çåèé¢ï¼é£å°±æ¯æ¬èæä»¬è¦è®²çââå¤§å°æ°´åé¢ï¼Geoidï¼ã</p>
<p>å°çåæ ç³»çç¬¬ä¸ç»´åº¦éå¸¸ä½¿ç¨æµ·æé«åº¦ï¼Elevationï¼ï¼èä¸æ¯å°çå¿çè·ç¦»ãç¶èé®é¢å¨äºï¼é«åº¦çå¼æ¯ä¸ä¸ªç¸å¯¹éï¼éè¦ä¸ä¸ªèµ·ç®ç¹ãå¹¶ä¸ï¼è¿ä¸ªé«åº¦å¿é¡»æ²¿çéåæ¹åï¼éé¤æ¹åï¼ææç©çæä¹ï¼æ³ä¸æ³ä¸ºä»ä¹å»ºç­ç©æ»æ¯è¦ä¿®çä¸å°é¢åç´ï¼ãæä»¬è¯´å°âæµ·æâè¿ä¸ªåè¯ï¼å°±ä¼èæ³å°é«åº¦çå¼åºè¯¥æ¯ä¸ä¸ªç®æ å°ç©è·ç¦»æµ·å¹³é¢çé«å·®ãäºå®ä¹ç¡®å®å¦æ­¤ï¼æä»¬å¯ä»¥å®ä¸ä¸ªå¹³åæµ·å¹³é¢ä½ä¸ºé«ç¨çèµ·ç®ç¹ï¼å¹¶ä¸åè®¾è¿ä¸ªæµ·å¹³é¢å®å¨éæ­¢ï¼å¹¶ä¸å»¶ä¼¸å°ææå¤§éä¸é¨ï¼çæäºä¸ä¸ªå¯é­çæ²é¢ââè¿ä¸ªæ²é¢å°±æ¯å¤§å°æ°´åé¢ã</p>
<p>ä¸åèæ¤­çé¢ä¸åçæ¯ï¼åèæ¤­çé¢æ¯æ°å­¦æ¨¡åå¾å°çï¼å¤å¤å¹³æ»ä¸å¹³æ´ï¼èå¤§å°æ°´åé¢è½ç¶å¹³æ»ä½ä¸å¹³æ´ï¼æ¯ä¸ä¸ªä¸è§åä½è¿ç»­çé­åæ²é¢ãè¿å¶ä¸­çåå å¨äºï¼å°çè´¨éåå¸ä¸ååï¼é æå°ççå¼ååºä¹æ¯åå¸ä¸åçãåè®¾å°ççä½å®å¨è¢«æ°´è¦çï¼æ°´çé«åº¦ä¹ä¸ä¼æ¯å®å¨ä¸æ ·ï¼å¨å°çå±é¨å¯åº¦æ´å¤§çå°æ¹ï¼å°çæ½å çå¼åå°±ä¼è¶å¤§ï¼é ææ°´ä½è¶é«ãæ¢å¥è¯è¯´ï¼å¤§å°æ°´åé¢æ¯ä¸ä¸ªéåç­å¿é¢ï¼éåæ¹åï¼éåæ¹åï¼å¨å¶ä»»ä½å°æ¹é½ä¸å¶è¡¨é¢åç´ï¼ç±äºè´¨éï¼å¼åï¼ä¸åï¼æ¯ä¸ªä½ç½®çéåæ¹åä¸ä¸æ ·ï¼ç»æå°±æ¯å¤§å°æ°´åé¢å¹¶ä¸å¹³æ´ãå¦ä¸å¾2.8æç¤ºã</p>
<p><img alt="å¾2.8 å¤§å°æ°´åé¢ä¸æè½¬æ¤­çä½" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260108214935061-1081980360.png" class="lazyload"></p>
<h3 id="232-ä¸çº§é¼è¿">2.3.2 ä¸çº§é¼è¿</h3>
<p>ç°å¨æä»¬å·²ç»æäºå¤§å°æ°´åé¢ãåèæ¤­çé¢åå¤§å°åºåé¢ãé£ä¹å®ä»¬çå³ç³»æ¯å¦ä½å¢ï¼ç®åæ¥è¯´ï¼å®ä»¬å±åç»æäºå¯¹å°çèªç¶è¡¨é¢çä¸çº§é¼è¿ã</p>
<ul>
<li>å¤§å°æ°´åé¢æ¯å¯¹å°çèªç¶è¡¨é¢çç¬¬ä¸çº§é¼è¿ãå¤§å°æ°´åé¢éè¿éåç­å¿ï¼ç¡®å®äºä¸ä¸ªé«ç¨èµ·ç®é¢ï¼å®è¿æ¯å°çèªç¶è¡¨é¢å¹³æ´å¾å¤ï¼ä½æ¯ä¸æ¯å®å¨å¹³æ´ãå°çèªç¶è¡¨é¢å·æä»ç ç©æçå³°ï¼+8800ç±³ï¼å°é©¬éäºçº³æµ·æ²ï¼-11,000ç±³ï¼çé«å·®ï¼ä½å¤§å°æ°´åé¢ä¸åèæ¤­çé¢çåå·®èå´ä¸è¶è¿200mï¼ä»+85ç±³çå°å²å°-106ç±³çå°åº¦åé¨ï¼ã</li>
<li>åèæ¤­çé¢æ¯å¯¹å°çèªç¶è¡¨é¢çç¬¬äºçº§é¼è¿ãå°çèªç¶è¡¨é¢åå¤§å°æ°´åé¢é½æ¯ä¸è§åçæ²é¢ï¼æ æ³éè¿æ°å­¦æ¨¡åå¯¹å¶è¿è¡è¡¨è¾¾ï¼è¿ä¹æå³çé¾ä»¥å¯¹å¶è¿è¡æµç®ååæãéè¿å°å¤§å°æ°´åé¢æåæä¸ä¸ªæè½¬æ¤­çä½ï¼ä½¿æä»¬å¯ä»¥å¯¹å°çèªç¶è¡¨é¢è¿è¡ç©ºé´å ä½è®¡ç®ãåèæ¤­çé¢æ¯æµéè®¡ç®çåºåé¢ã</li>
<li>å¤§å°åºåé¢æ¯å¯¹å°çèªç¶è¡¨é¢çç¬¬ä¸æé¼è¿ãåèæ¤­çä½æ¯å¯¹å°ççä½çæ½è±¡ï¼ä½å¤§å°åºåé¢è§£å³çæ¯è¿ä¸ªåèæ¤­çä½å¦ä½ææ¾çé®é¢ï¼å¤§å°åºåé¢è¦ä¹ä¸å°çèªç¶è¡¨é¢çå±é¨åºåå·æè¾å¥½çéååº¦ï¼ä»¥ä¾¿è§£å³å±é¨åºåç²¾åº¦çé®é¢ï¼è¦ä¹è®©æ¤­çä½ä¸­å¿ä½äºå°çè´¨å¿ï¼ä»¥ä¾¿å·æå¨çèå´å¯ä½¿ç¨çä¾¿æ·æ§ã</li>
</ul>
<h3 id="233-é«ç¨ç³»ç»">2.3.3 é«ç¨ç³»ç»</h3>
<h4 id="1-ä¼¼å¤§å°æ°´åé¢">1 ä¼¼å¤§å°æ°´åé¢</h4>
<p>å¦åæè¿°ï¼å¤§å°æ°´åé¢ç¡®å®äºé«ç¨çèµ·ç®é¢ãé£ä¹ï¼å°çè¡¨é¢ä¸ä¸ç¹å°å¤§å°æ°´åé¢å¿ç¶æä¸ä¸ªé«åº¦ï¼è¿ä¸ªé«åº¦å°±æ¯æ­£é«ï¼Orthometric Heightï¼ãæ­£é«å°±æ¯æä»¬éå¸¸æä¹ä¸æè¯´çæµ·ææèæµ·æé«åº¦ï¼ä¹å«åé«ç¨ï¼Elevationï¼ãè¿ä¸ªé«ç¨ç³»ç»å°±æ¯æ­£é«ç³»ç»ã</p>
<p>ç¶èï¼å¤§å°æ°´åé¢çé®é¢æ¯å¶ä»ä»åªæ¯ä¸ä¸ªçæ³åçæ¨¡åï¼æ¯ä¸è½åç¡®æµéçãå®¢è§å°è¯´ï¼å¤§å°æ°´åé¢æåæ³çå¤§éä¸é¨çæµ·å¹³é¢æ æ³è¢«éæµï¼æ²¡æç°å®æä¹ãä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼å°±å¼å¥äºä¸ä¸ªæ°å­¦è¾å©é¢ï¼ä¼¼å¤§å°æ°´åé¢ï¼Quasi-geoidï¼ãä¼¼å¤§å°æ°´åé¢éç¨å¹³åæ­£å¸¸éåå¼æ¥æåæ°´åé¢æ²çº¿ï¼å¤§å°æä¸ç¹çéåå¼æ æ³ç²¾ç¡®æ±åï¼ï¼å¯¼è´ä¸¤èå¨æµ·æ´ä¸å®å¨éåï¼å¨å¤§éä¸æ2 ~ 4ç±³çå¾®å°å·®å¼ãå¦æä¸è½çè§£ä¸è¦ç´§ï¼æä»¬å¯ä»¥å®æ§ççè§£ï¼ä¼¼å¤§å°æ°´åé¢æ¯å¯¹å¤§å°æ°´åé¢çæ°å­¦è¿ä¼¼ï¼ä¼¼å¤§å°æ°´åé¢å¯ä»¥ç²¾ç¡®æ±å¾ï¼å¤§å°æ°´åé¢ä¸å¯ä»¥ç²¾ç¡®æ±å¾ã</p>
<p>åæ ·çï¼å°çè¡¨é¢ä¸ä¸ç¹å°ä¼¼å¤§å°æ°´åé¢ä¹æä¸ä¸ªé«åº¦ï¼æä»¬æè¿ä¸ªé«åº¦å«åæ­£å¸¸é«ï¼Normal heightï¼ï¼å¶é«ç¨å°±æ¯æ­£å¸¸é«ç³»ç»ãæ­£å ä¸ºä¼¼å¤§å°æ°´åé¢æ¯å¤§å°æ°´åé¢å¾è¿ä¼¼ä¸å¯æ±åï¼æä»¥ä¸è¬ä½¿ç¨æ­£å¸¸é«æ¥æ¿ä»£æ­£é«ï¼æ­£å¸¸é«ç³»ç»ç»æä¹å¯ä»¥ç§°ä¸ºæµ·æé«åº¦ãæå½ç®åéç¨çæ³å®é«ç¨ç³»ç»å°±æ¯æ­£å¸¸é«ç³»ç»ã</p>
<p>æ­£é«åæ­£å¸¸é«ï¼å¤§å°æ°´åé¢åä¼¼å¤§å°æ°´åé¢çç¤ºæå¾å¦ä¸å¾2.9æç¤ºï¼</p>
<p><img alt="å¾2.9 æ­£é«ãæ­£å¸¸é«ä¸å¤§å°é«" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260108214955486-1506573538.png" class="lazyload"></p>
<h4 id="2-é«ç¨ç³»ç»">2 é«ç¨ç³»ç»</h4>
<p>å¦å¾2.9ä¸­æç¤ºï¼é¤äºæ­£é«ç³»ç»åæ­£å¸¸é«ç³»ç»ï¼è¿æä¸ç±»å¸¸ç¨çé«ç¨ç³»ç»å°±æ¯å¤§å°é«ç³»ç»ãæè°å¤§å°é«ï¼æçæ¯ä»¥åèæ¤­çé¢ä¸ºåºåé¢çé«ç¨ç³»ç»ï¼å¶å¼æ¯å°é¢ä¸ä¸ç¹æ²¿è¯¥ç¹çæ¤­çé¢æ³çº¿å°åèæ¤­çé¢çè·ç¦»ãå¤§å°é«ä¹ç§°ä¸ºæ¤­çé«ã</p>
<p>è½ç¶æä»¬ä¸è¬éç¨çé«ç¨ç³»ç»æ¯æ­£å¸¸é«ç³»ç»ï¼ä½å¨å®éçä½¿ç¨è¿ç¨ä¸­ï¼æçæ¶åç¥éæ­£å¸¸é«éè¦è®¡ç®å¤§å°é«ï¼æçæ¶ååéè¦éè¿å¤§å°é«æ¥è®¡ç®æ­£å¸¸é«ãä¸ä¸ªå¾å¸åçä¾å­å°±æ¯ï¼GPSï¼Global Positioning Systemï¼å¨çå®ä½ç³»ç»ï¼è·åçé«ç¨ä¸è¬æ¯å¤§å°é«ï¼é£ä¹å¦ä½å¾å°æä»¬æ³è¦çæ­£å¸¸é«å¢ï¼</p>
<p>å¦ä¸è¡¨2.4æè¿°ï¼å¯¹äºé«ç¨ç³»ç»ä¸­åéï¼æä»¬æå¦ä¸å®ä¹ï¼</p>

<table>
<thead>
<tr>
<th style="text-align: center">ç¬¦å·</th>
<th style="text-align: center">åç§°</th>
<th style="text-align: center">å«ä¹</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center"><span class="math inline">\(H_n\)</span></td>
<td style="text-align: center">æ­£å¸¸é«ï¼Normal Heightï¼</td>
<td style="text-align: center">å°é¢ä¸ä¸ç¹æ²¿éåæ¹åå°ä¼¼å¤§å°æ°´åé¢çè·ç¦»</td>
</tr>
<tr>
<td style="text-align: center"><span class="math inline">\(H_o\)</span></td>
<td style="text-align: center">æ­£é« ï¼Orthometric Heightï¼</td>
<td style="text-align: center">å°é¢ä¸ä¸ç¹æ²¿éåæ¹åå°å¤§å°æ°´åé¢çè·ç¦»</td>
</tr>
<tr>
<td style="text-align: center"><span class="math inline">\(H_g\)</span></td>
<td style="text-align: center">å¤§å°é«ï¼Geodetic Heightï¼</td>
<td style="text-align: center">å°é¢ä¸ä¸ç¹æ²¿æ¤­çé¢æ³çº¿æ¹åå°åèæ¤­çé¢çè·ç¦»</td>
</tr>
<tr>
<td style="text-align: center"><span class="math inline">\(\zeta\)</span></td>
<td style="text-align: center">é«ç¨å¼å¸¸ï¼Height Anomalyï¼</td>
<td style="text-align: center">ä¼¼å¤§å°æ°´åé¢å°åèæ¤­çé¢çè·ç¦»</td>
</tr>
<tr>
<td style="text-align: center"><span class="math inline">\(N\)</span></td>
<td style="text-align: center">å¤§å°æ°´åé¢å·®è·ï¼Geoid Undulationï¼</td>
<td style="text-align: center">å¤§å°æ°´åé¢å°åèæ¤­çé¢çè·ç¦»</td>
</tr>
</tbody>
</table>
<p>å°å®ä»¬å¨ç¤ºæå¾ä¸­æ è¯ï¼å¦ä¸å¾2.10æç¤ºï¼<br>
<img alt="å¾2.10 æ­£é«ãæ­£å¸¸é«ä¸å¤§å°é«" loading="lazy" data-src="https://img2024.cnblogs.com/blog/1000410/202601/1000410-20260108215018227-1527820031.png" class="lazyload"></p>
<p>æ ¹æ®å¾ç¤ºå¾æ¾ç¶å¯ä»¥å¾å°å¦ä¸å¬å¼ï¼</p>
<p></p><div class="math display">\[H_g = H_n + \zeta \tag{2.6}
\]</div><p></p><p></p><div class="math display">\[H_g = H_o + N \tag{2.7}
\]</div><p></p><p>åå°ä¹åæå°çé®é¢ï¼GPSè·åçé«ç¨ä¸ºå¤§å°é«<span class="math inline">\(H_g\)</span>ï¼é£ä¹åéè¿å¤§å°æµéçæ¹æ³ï¼å¯ä»¥ç²¾ç¡®ç¡®å®é«ç¨å¼å¸¸<span class="math inline">\(\zeta\)</span>ï¼æ ¹æ®å¬å¼2.6ï¼å¤§å°é«åå»é«ç¨å¼å¸¸å°±å¯ä»¥å¾å°æ­£å¸¸é«<span class="math inline">\(H_n\)</span>ï¼æ­£å¸¸é«å¯ä»¥ç¨æ¥ä»£æ¿æ­£é«ï¼æ­£é«å³æå¸¸ç¨çæµ·æé«åº¦ãå¨å®éçåºç¨ä¸­ï¼ææ¶éè¦å¤§å°é«ï¼ææ¶éè¦æ­£å¸¸é«ï¼å¯æ ¹æ®ä¸è¿°å¬å¼çµæ´»è½¬æ¢ã</p>
<h4 id="3-é«ç¨åºå">3 é«ç¨åºå</h4>
<p>å¦2.3.1èæè¿°ï¼å¤§å°æ°´åé¢ä½¿ç¨ä¸ä¸ªåæ³çå¹³åæµ·å¹³é¢ä½ä¸ºé«ç¨èµ·ç¹ï¼åºåï¼ï¼è¿ä¸ªå¹³åæµ·é¢å¯ä»¥éè¿å¨åå°çéªæ½®ç«è§æµãè®¡ç®ãç»¼åå¾å°ãæå½æ ¹æ®å®éçè§æµç»æä¹ä¸ï¼å»ºç«å¤ä¸ªé«ç¨åºåé¢ï¼å¶ä¸­æå¸¸ç¨çä¸¤ä¸ªå½å®¶é«ç¨åºåæ¯ï¼</p>
<ul>
<li>1956é»æµ·é«ç¨åºåï¼æ°´ååç¹é«ç¨72.289ç±³ã</li>
<li>1985å½å®¶é«ç¨åºåï¼æ°´ååç¹é«ç¨72.260ç±³ã</li>
</ul>
<p>ç®åï¼1985å½å®¶é«ç¨åºåå·²ç»å¨é¨æ¿ä»£1956é»æµ·é«ç¨åºåï¼ä¹åææä½¿ç¨1956é»æµ·é«ç¨åºåçé«ç¨ç»æé½éè¦éè¿ä¸å¼2.8è¿è¡è½¬æ¢ï¼</p>
<p></p><div class="math display">\[H_{85} = H_{56} - 0.029
\]</div><p></p><p>æ­¤å¤ï¼å½éä¸éç¨çè¿æç¾å½å½å®¶å°çç©ºé´ææ¥å±ï¼National Geospatial-Intelligence Agencyï¼NGAï¼åå¸çEGMï¼Earth Gravitational Modelsï¼å°çéåæ¨¡åï¼å¤§å°æ°´åé¢ãè¿ä¸ªå¤§å°æ°´åé¢æ¨¡åæ¯ç»¼åå©ç¨ç°æå¨çå¤§ééåæ°æ®è®¡ç®åºæ¥çï¼éç¨äºå¨çèå´ãç®åå·²ç»åå¸äºEGM84ãEGM96ãEGM2008åEGM2020åä¸ªçæ¬ã</p>
<hr>
<p>æ¬æèéèªä½èæ°ä¹¦ãGISåºç¡åçä¸ææ¯å®è·µãç¬¬2ç« ãä¹¦ä¸­ç³»ç»è®²è§£ GIS æ ¸å¿çè®ºä¸å¤è¯­è¨å®æï¼éåå¼åèä¸é«æ ¡å¸çã</p>
<p>ð <strong>éå¥èµæºå¼æº</strong>ï¼<a href="https://github.com/fafa1899/GISBasic" target="_blank" rel="noopener nofollow">GitHub</a> | <a href="https://gitcode.com/charlee44/GISBasic" target="_blank" rel="noopener nofollow">GitCode</a></p>
<p>ð <strong>æ¯ææ­£ç</strong>ï¼<a href="https://item.jd.com/14603137.html" target="_blank" rel="noopener nofollow">äº¬ä¸</a>ï½<a href="https://product.dangdang.com/29988568.html" target="_blank" rel="noopener nofollow">å½å½</a></p>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-08 21:56">2026-01-08 21:56</span>&nbsp;
<a href="https://www.cnblogs.com/charlee44">charlee44</a>&nbsp;
éè¯»(<span id="post_view_count">167</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19458808);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19458808', targetLink: 'https://www.cnblogs.com/charlee44/p/19458808', title: 'GISä¸­çâé«åº¦âå°åºæä»ä¹ï¼ä¸æåæ¸æ­£é«ãæ­£å¸¸é«ä¸å¤§å°é«çåºå«' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
<item>
    <title><![CDATA[ å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬ä¸å¨ï¼å¾ªç¯ç¥ç»ç½ç» ï¼åï¼RNN ä¸­çæ¢¯åº¦ç°è±¡ ]]></title>
    <link>https://www.cnblogs.com/Goblinscholar/p/19458774</link>
    <guid>a8f6e844a2c3160bb55c5788647e57f8</guid>
    <description>
    <![CDATA[ 
            <h1 class="postTitle">
                <a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/Goblinscholar/p/19458774" title="åå¸äº 2026-01-08 21:37">
    <span role="heading" aria-level="2">å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬ä¸å¨ï¼å¾ªç¯ç¥ç»ç½ç» ï¼åï¼RNN ä¸­çæ¢¯åº¦ç°è±¡</span>
    

</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown">
<p>æ­¤åç±»ç¨äºè®°å½å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨çå­¦ä¹ ç¬è®°ã<br>
è¯¾ç¨ç¸å³ä¿¡æ¯é¾æ¥å¦ä¸ï¼</p>
<ol>
<li>åè¯¾ç¨è§é¢é¾æ¥ï¼<a href="https://www.bilibili.com/video/BV1FT4y1E74V?buvid=XU762317353676D786954061C192FE625463B&amp;from_spmid=playlist.playlist-detail.0.0&amp;is_story_h5=false&amp;mid=zqernykrmpf7XfIorMR%2FnA%3D%3D&amp;plat_id=116&amp;share_from=ugc&amp;share_medium=android&amp;share_plat=android&amp;share_session_id=ce0bc526-db69-428a-962e-c65ed8c267bc&amp;share_source=COPY&amp;share_tag=s_i&amp;spmid=united.player-video-detail.0.0&amp;timestamp=1713085655&amp;unique_k=DfBgvFW&amp;up_id=8654113&amp;vd_source=e035e9878d32f414b4354b839a4c31a4" target="_blank" rel="noopener nofollow">[åè¯­å­å¹]å´æ©è¾¾æ·±åº¦å­¦ä¹ deeplearning.ai</a></li>
<li>githubè¯¾ç¨èµæï¼å«è¯¾ä»¶ä¸ç¬è®°:<a href="https://github.com/robbertliu/deeplearning.ai-andrewNG" target="_blank" rel="noopener nofollow">å´æ©è¾¾æ·±åº¦å­¦ä¹ æå­¦èµæ</a></li>
<li>è¯¾ç¨éå¥ç»ä¹ ï¼ä¸­è±ï¼ä¸ç­æ¡ï¼<a href="https://blog.csdn.net/u013733326/article/details/79827273" target="_blank" rel="noopener nofollow">å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾åä¹ é¢ä¸ç­æ¡</a></li>
</ol>
<p>æ¬ç¯ä¸ºç¬¬äºè¯¾çç¬¬ä¸å¨åå®¹ï¼<a href="https://www.bilibili.com/video/BV1FT4y1E74V?spm_id_from=333.788.videopod.episodes&amp;vd_source=e035e9878d32f414b4354b839a4c31a4&amp;p=158" target="_blank" rel="noopener nofollow">1.8</a>çåå®¹ä»¥åä¸äºç¸å³åºç¡çè¡¥åã</p>
<hr>
<p>æ¬å¨ä¸ºç¬¬äºè¯¾çç¬¬ä¸å¨åå®¹ï¼ä¸ CV ç¸å¯¹åºçï¼è¿ä¸è¯¾ææåå®¹çä¸­å¿åªæä¸ä¸ªï¼<strong>èªç¶è¯­è¨å¤çï¼Natural Language Processingï¼NLPï¼</strong>ã<br>
åºç¨å¨æ·±åº¦å­¦ä¹ éï¼å®æ¯ä¸é¨ç¨æ¥è¿è¡<strong>ææ¬ä¸åºåä¿¡æ¯å»ºæ¨¡</strong>çæ¨¡ååææ¯ï¼æ¬è´¨ä¸æ¯å¨å¨è¿æ¥ç½ç»ä¸ç»è®¡è¯­è¨æ¨¡ååºç¡ä¸çä¸æ¬¡âç»æåç¹åâï¼ä¹æ¯äººå·¥æºè½ä¸­<strong>æè´´è¿äººç±»æç»´è¡¨è¾¾æ¹å¼</strong>çéè¦ç ç©¶æ¹åä¹ä¸ã<br>
<strong>è¿ä¸æ´èè¯¾åæ ·æ¶åå¤§ééè¦åå¤æ¶åçåå®¹ï¼æ¨ªè·¨æºå¨å­¦ä¹ ãæ¦çç»è®¡ãçº¿æ§ä»£æ°ä»¥åè¯­è¨å­¦ç´è§ã</strong><br>
è¯­è¨ä¸åå¾åé£æ ·âç´è§å¯è§âï¼æ´å¤æ¯æ½è±¡ç¬¦å·ä¸ä¸ä¸æå³ç³»çç»åï¼å æ­¤<strong>çè§£é¨æ§åèæ´é«</strong>ã<br>
å æ­¤ï¼æåæ ·ä¼å°½éè¡¥è¶³å¿è¦çèæ¯ç¥è¯ï¼å°½å¯è½ç¨æ¯å»åå®ä¾éä½çè§£é¾åº¦ã<br>
æ¬ç¯çåå®¹å³äº<strong>RNN ä¸­çæ¢¯åº¦ç°è±¡</strong>ï¼æ¯å¯¹ RNN ä¸­å­å¨çé®é¢çéè¿°ï¼ä¹æ¯å¯¹ä¹åçé¨æ§æºå¶çå¼å¥åå®¹ã</p>
<h1 id="1-rnn-ä¸­çæ¢¯åº¦ç°è±¡">1. RNN ä¸­çæ¢¯åº¦ç°è±¡</h1>
<p>å¨å¾ä¹ä¹åï¼æä»¬å°±ä»ç»è¿æ·±åº¦å­¦ä¹ è®­ç»ä¸­ç<a href="https://www.cnblogs.com/Goblinscholar/p/19190303" target="_blank">æ¢¯åº¦ç°è±¡</a>ï¼è¿ç§æåµä¸»è¦åºç°å¨æ·±å±ç¥ç»ç½ç»ä¸­ï¼å¨ååä¼ æ­ä¸­éçå±å±çæ¢¯åº¦è®¡ç®å¯¼è´æ¢¯åº¦è¿å¤§æè¿å°ï¼ä»èåºç°æ¢¯åº¦çç¸æèæ¢¯åº¦æ¶å¤±ï¼å¯¼è´ç½ç»æ æ³è®­ç»ã<br>
èå¨ RNN ä¸­ï¼å³ä½¿æ¯æä»¬æ¼ç¤ºè¿çåå± RNN ï¼ä¹å¯è½äº§çæ¢¯åº¦ç°è±¡ï¼èä¸è¿ä¸é®é¢ä¼æ¾å¾<strong>æ´å éè½ï¼å´ä¹æ´å ä¸¥é</strong>ï¼å¶åå å°±å¨äº RNN ç<strong>æ¶é´ååä¼ æ­</strong>ç¹æ§ã</p>
<h2 id="11-rnn-çæ·±åº¦">1.1 RNN çæ·±åº¦</h2>
<p>é¦åï¼æä»¬ç¥éï¼<strong>RNN çâæ·±åº¦âå¹¶ä¸ä½ç°å¨ç©ºé´ç»æä¸ï¼èæ¯ä½ç°å¨æ¶é´ç»´åº¦ä¸ã</strong><br>
å æ­¤ï¼è½ç¶æä»¬ç»åºæ¥ç RNN çèµ·æ¥åªæä¸å±ï¼ä½å¨è®­ç»æ¶ï¼RNN ä¼å¨æ¶é´ç»´åº¦ä¸è¢«âå±å¼âä¸ºä¸ä¸ª<strong>å±äº«åæ°çæ·±å±ç½ç»</strong>ï¼å°±åè¿æ ·ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260108213552905-491823195.png" alt="image.png" loading="lazy"></p>
<p>ä¹å°±æ¯è¯´ï¼å¦æåºåé¿åº¦ä¸º <span class="math inline">\(T\)</span>ï¼é£ä¹å¨ååä¼ æ­æ¶ï¼æ¢¯åº¦å°±éè¦æ²¿çæ¶é´è½´ï¼ä»ç¬¬ <span class="math inline">\(T\)</span> ä¸ªæ¶å»ä¸è·¯åä¼ åç¬¬ <span class="math inline">\(1\)</span> ä¸ªæ¶å»ã<br>
éè¦è¯´æçæ¯ï¼è¿éæ¶é´å±å¼çé¿åº¦ <span class="math inline">\(T\)</span> æçæ¯ <strong>RNN å¨æ¶é´ç»´åº¦ä¸çéæ¨æ­¥æ°</strong>ï¼å¨æä»¬ä»ç»çåºç¡ RNN åºæ¯ä¸ï¼éå¸¸ç­åäºè¾å¥åºåçé¿åº¦ <span class="math inline">\(T_x\)</span>ï¼èéçæåºåçé¿åº¦ <span class="math inline">\(T_y\)</span>ã<br>
æç»ï¼ä»ææä¸çï¼è¿ç¸å½äºï¼  <strong>åä¸ç»æéç©éµè¢«åå¤ç¸ä¹äº <span class="math inline">\(T\)</span> æ¬¡ã</strong></p>
<p>å æ­¤ï¼å¨ RNN ä¸­ï¼æä»¬åæ ·æå¿è¦äºè§£è®­ç»ä¸­åºç°æ¢¯åº¦ç°è±¡çå¤çæ¹æ³ã</p>
<h2 id="12-æ¢¯åº¦çç¸çå¤çæ¢¯åº¦è£åªgradient-clipping">1.2 æ¢¯åº¦çç¸çå¤çï¼æ¢¯åº¦è£åªï¼Gradient Clippingï¼</h2>
<p>å¨ RNN çæ¢¯åº¦é®é¢ä¸­ï¼<strong>æ¢¯åº¦çç¸éå¸¸æ¯æåãä¹æ¯æå®¹æè¢«è§å¯å°çç°è±¡</strong>ã<br>
å¶è¡¨ç°éå¸¸ç´è§ï¼æå¤±å½æ°å¨è®­ç»è¿ç¨ä¸­å§çéè¡ï¼çè³ç´æ¥åä¸º NaNï¼åæ°æ´æ°å®å¨å¤±æ§ï¼æ¨¡åæ æ³ç»§ç»­è®­ç»ã<br>
ä¸æ¢¯åº¦æ¶å¤±ä¸åï¼æ¢¯åº¦çç¸å¹¶ä¸æ¯âå­¦ä¸å°âï¼èæ¯ <strong>âå­¦å¾å¤ªçâ</strong>ã<br>
å æ­¤ï¼ç¸æ¯æ¢¯åº¦æ¶å¤±ï¼æ¢¯åº¦çç¸é®é¢æ´å®¹æè¢«æ§å¶åç¼è§£ãè¿å¾å¥½çè§£ï¼ä¸è¥¿å¤äºæä»¬å¯ä»¥æï¼ä½å°äºæä»¬ä¸è½å­ç©ºåé åºæ¥ã<br>
èå¶ä¸­ä¸ç§æå¸¸è§ãä¹æç´æ¥çæ¹æ³ï¼å°±æ¯<strong>æ¢¯åº¦è£åªï¼Gradient Clippingï¼</strong>ã</p>
<p>æ¢¯åº¦è£åªçææ³éå¸¸ç®åï¼å¯ä»¥æ¦æ¬ä¸ºä¸å¥è¯ï¼</p>
<blockquote>
<p><strong>å½æ¢¯åº¦è¿å¤§æ¶ï¼ä¸è®©å®ç»§ç»­æ¾å¤§æ´æ°å¹åº¦ã</strong></p>
</blockquote>
<p>ä¹å°±æ¯è¯´ï¼æä»¬å¹¶ä¸è¯å¾æ¹åæ¢¯åº¦çâæ¹åâï¼èåªæ¯<strong>éå¶æ¢¯åº¦çâå¤§å°â</strong>ï¼ä»èé¿åä¸æ¬¡åæ°æ´æ°æ­¥é¿è¿å¤§ï¼ç ´åè®­ç»ç¨³å®æ§ã</p>
<p>åæä¸ªæ¯æ¹ï¼å¨ä¸å¡éªè½¦æ¶ï¼æä»¬çæ¹åæ¯å¯¹çï¼ä½éåº¦å¤ªå¿«å®¹ææï¼æä»¥æä»¬éè¿âå¹è½¦âæ¥æ§å¶é£é©ã<br>
æ¢¯åº¦è£åªï¼æ¬è´¨ä¸å°±æ¯ååä¼ æ­é¶æ®µçâæ°å¼å¹è½¦âã</p>
<p>å¨å®éä½¿ç¨ä¸­ï¼æå¸¸è§çæ¯<strong>åºäºæ¢¯åº¦èæ°ï¼normï¼çè£åªæ¹å¼</strong>ã<br>
è®¾ææåæ°çæ¢¯åº¦æ¼æ¥æä¸ä¸ªåé <span class="math inline">\(g\)</span>ï¼å¶ <strong><span class="math inline">\(L_2\)</span> èæ°</strong>ä¸ºï¼</p>
<p></p><div class="math display">\[\lVert g \rVert_=\sqrt{g_1^2 + g_2^2 + \cdots + g_n^2}  
\]</div><p></p><p>æä»¬ç¨ <strong><span class="math inline">\(L_2\)</span> èæ°</strong>è¡¡éæ¢¯åº¦ç<strong>æ´ä½å¤§å°</strong>ï¼å®åæ çæ¯<strong>è¿ä¸æ¬¡ååä¼ æ­ä¸­ï¼åæ°æ´æ°âæ»ä½æå¤æ¿è¿â</strong>ã</p>
<p>ä¸ä¸æ­¥ï¼ç»å®ä¸ä¸ª<strong>éå¼ <span class="math inline">\(c\)</span></strong>ï¼æ¢¯åº¦è£åªçè§åæ¯ï¼</p>
<p></p><div class="math display">\[g =
\begin{cases}
g, &amp; \lVert g \rVert \le c \\
\dfrac{c}{\lVert g \rVert} \, g, &amp; \lVert g \rVert &gt; c
\end{cases}
\]</div><p></p><p>ä¹å°±æ¯è¯´ï¼</p>
<ul>
<li>å¦ææ¢¯åº¦èæ°å¨å¯æ¥åèå´åï¼<strong>ä¸åä»»ä½å¤çã</strong></li>
<li>å¦ææ¢¯åº¦èæ°è¶è¿éå¼ï¼<strong>æ´ä½ç¼©æ¾ï¼ä½¿å¶èæ°æ°å¥½ç­äº <span class="math inline">\(c\)</span>ã</strong></li>
</ul>
<p>è¿æ ·æä½ä¸æ¥ï¼ä½ ä¼åç°ï¼<strong>æ¢¯åº¦è£åªå¹¶ä¸ä¼æ¹åæ¢¯åº¦ååéä¹é´çç¸å¯¹æ¯ä¾ï¼åªæ¯ç»ä¸ç¼©æ¾å¶å¤§å°å°åéç¨åº¦ã</strong></p>
<p>è¿æ ·ï¼å¨ååä¼ æ­ä¸­ï¼æ¢¯åº¦è£åªå°±ä¼<strong>é»æ­âææ°çº§æ¾å¤§âçæåæåµ</strong>ï¼ ä¿è¯åæ°æ´æ°å§ç»å¤å¨ä¸ä¸ªç¨³å®åºé´ï¼ä»èè®©è®­ç»è¿ç¨âè³å°å¯ä»¥ç»§ç»­è¿è¡ä¸å»âã<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260108213603856-931372748.png" alt="image.png" loading="lazy"><br>
è¦å¼ºè°çæ¯ï¼å¨å®éè®­ç»ä¸­æ¶ï¼<strong>æ¢¯åº¦è£åªå ä¹æ¯é»è®¤éç½®</strong>ï¼èä¸æ¯å¯éæå·§ã</p>
<p>ä½æ¯ï¼æ¢¯åº¦è£åªä¹æå¶å±éæ§ï¼<strong>æ¢¯åº¦è£åªåªè½ç¼è§£æ¢¯åº¦çç¸ï¼æ æ³è§£å³æ¢¯åº¦æ¶å¤±ã</strong><br>
åå å¾ç®åï¼</p>
<ul>
<li>æ¢¯åº¦çç¸æ¯âæ°å¼è¿å¤§âçé®é¢ â å¯ä»¥å¼ºè¡åç¼©</li>
<li>æ¢¯åº¦æ¶å¤±æ¯âä¿¡å·æ¬èº«æ¥è¿äº 0â â è£åªæ è½ä¸ºå</li>
</ul>
<p>å æ­¤ï¼å¯¹äºæ¢¯åº¦æ¶å¤±è¿ä¸æ´å¸¸è§ä¹æ´é¾ç¼è§£çæ¢¯åº¦ç°è±¡ï¼æä»¬éè¦å«çè§£å³æ¹æ¡ï¼è¿ä¹æ¯æä»¬ä¸é¢è¦è®¨è®ºçä¸»è¦åå®¹ã</p>
<h1 id="2-rnn-ä¸­çæ¢¯åº¦æ¶å¤±é¿è·ç¦»ä¾èµé®é¢">2. RNN ä¸­çæ¢¯åº¦æ¶å¤±ï¼é¿è·ç¦»ä¾èµé®é¢</h1>
<p>æä»¬ç¥éï¼<a href="https://www.cnblogs.com/Goblinscholar/p/19449622" target="_blank">RNN</a> æé¿å¤çåºåæ°æ®ï¼å¹¶è½å¤éæ­¥ç§¯ç´¯åå²ä¿¡æ¯ãç¶èï¼å¨é¿åºåè®­ç»ä¸­ï¼æ¢¯åº¦æ¶å¤±ä¼è®©æ©ææ¶é´æ­¥çå½±åè¢«éæ¸âæ¹æâï¼è¿å°±å¯¼è´äºèåç <strong>é¿è·ç¦»ä¾èµé®é¢</strong>ï¼æ¨¡åé¾ä»¥ææåºåä¸­ç¸éè¾è¿çä¿¡æ¯ã<br>
æä»¬ç¨ä¹åçååä¼ æ­ä¾å­æ¥æ¼ç¤ºä¸ä¸è¿ä¸ªé®é¢ï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260108213553401-1851089098.png" alt="image.png" loading="lazy"><br>
æ³¨ææä»¬æ çº¢çå­ä½ï¼<strong>å½åºåè¿é¿æ¶ï¼ä¸ç»å°¾è·ç¦»å¾è¿çæåå æ­¥ä¿¡æ¯å¾é¾å®ç°æææ´æ°ãå æ­¤æ¢¯åº¦å·²ç»å¨å±å±è¿ä¹ä¸­æå©æ å äºã</strong><br>
è¿æ ·å¸¦æ¥çåææ¯ä»ä¹ï¼æ¥ççï¼<br>
<img src="https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260108213555854-2054969424.png" alt="image.png" loading="lazy"></p>
<p>è¿å°±æ¯ RNN ä¸­çæ¢¯åº¦æ¶å¤±ç°è±¡ï¼<strong>å®ç´æ¥å¯¼è´ RNN é¾ä»¥ææåºåä¸­ç¸éè¾è¿çä¾èµå³ç³»</strong>ï¼æ¾ç¶ï¼è¿å¯¹æ¨¡åæ§è½çå½±åæ¯å·¨å¤§çã</p>
<p>é£ä¹å¦ä½ç¼è§£ RNN ä¸­çæ¢¯åº¦æ¶å¤±ç°è±¡ï¼<br>
ä½ å¯è½æ³å°äºæä»¬ä¹åä»ç»è¿ç<a href="https://www.cnblogs.com/Goblinscholar/p/19359236" target="_blank">æ®å·®ç½ç»</a>ï¼å³éè¿å¨ RNN ä¸­å¼å¥<strong>æ®å·®è¿æ¥</strong>ï¼ä¸ºæ¢¯åº¦æä¾äºä¸æ¡ç´æ¥ä¼ éçéè·¯ï¼å¯ä»¥å¨ä¸å®ç¨åº¦ä¸ç¼è§£æ¢¯åº¦æ¶å¤±é®é¢ï¼ä½¿æ·±å±æé¿åºåçè®­ç»æ´å ç¨³å®ãè¿çç¡®æ¯ä¸ç§å¯è¡çæ¹è¿æ¹æ¡ãä½æ®å·®è·¯å¾è½ç¶æä¾äºæ¢¯åº¦ç´éééï¼ä½<strong>æ æ³è¿è¡ä¿¡æ¯éæ©æ§æ§å¶</strong>ï¼å¯¹äºéå¸¸é¿åºåä»ç¶å­å¨æ¢¯åº¦è¡°åã<br>
å æ­¤ï¼å¨ RNN ä¸­ï¼æä»¬æä¸ç§æ´å¥½çææ¯ï¼<strong>é¨æ§æºå¶</strong>ï¼è¿æ¯å¨å®éå®éªåé¨ç½²ä¸­æä»¬æ´å¸¸ä½¿ç¨çæ¹æ³ï¼å®ä¸ä»è½ä¿ææ¢¯åº¦ç¨³å®ä¼ éï¼è¿è½æºè½æ§å¶ä¿¡æ¯æµã<br>
å¶åçè¾ä¸ºå¤æï¼æä»¬ç»è¿æ¬ç¯çå¼ç¨ï¼å¨ä¸ä¸ç¯æ¥è¯¦ç»å±å¼å®ã</p>
<h1 id="3-æ»ç»">3. æ»ç»</h1>
<table>
<thead>
<tr>
<th>æ¦å¿µ</th>
<th>åç</th>
<th>æ¯å»</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>æ¢¯åº¦ç°è±¡ï¼Gradient Phenomenaï¼</strong></td>
<td>å¨æ·±å±ç½ç»æ RNN çååä¼ æ­ä¸­ï¼æ¢¯åº¦å¯è½è¿å¤§æè¿å°ï¼å¯¼è´è®­ç»ä¸ç¨³å®ï¼å³æ¢¯åº¦çç¸ææ¢¯åº¦æ¶å¤±</td>
<td>å°±åæ°´æµç®¡éï¼å¦ææ°´åè¿å¤§ç®¡éçè£ï¼æ°´åè¿å°åæ æ³è¾éæ°´</td>
</tr>
<tr>
<td><strong>RNN çâæ·±åº¦â</strong></td>
<td>RNN å¨æ¶é´ç»´åº¦ä¸å±å¼ä¸ºå±äº«åæ°çæ·±å±ç½ç»ï¼æ¢¯åº¦éè¦æ²¿æ¶é´è½´ååä¼ æ­ï¼è¿ç»­ä¹ä»¥æéç©éµ <span class="math inline">\(T\)</span> æ¬¡</td>
<td>å¥½æ¯ä¸ä¸ªæ¥åèµï¼æ¯ä¸æ£é½å¿é¡»ä¼ éè½éï¼æ¥åæ£è¶å¤ï¼æ»è½éæèè¶å¤§</td>
</tr>
<tr>
<td><strong>æ¢¯åº¦è£åªï¼Gradient Clippingï¼</strong></td>
<td>å½æ¢¯åº¦èæ°è¶è¿éå¼ <span class="math inline">\(c\)</span> æ¶ï¼å¯¹æ¢¯åº¦æ´ä½ç¼©æ¾ï¼ä½¿å¶èæ°ç­äº <span class="math inline">\(c\)</span>ï¼ä¸æ¹åæ¢¯åº¦æ¹åï¼åªè°æ´å¤§å°</td>
<td>å°±åç»è¿å¿«ä¸å¡çè½¦è£å¹è½¦ï¼ä¿æå®å¨éåº¦</td>
</tr>
<tr>
<td><strong>RNN çé¿è·ç¦»ä¾èµé®é¢</strong></td>
<td>æ¢¯åº¦å¨å±å±è¿ä¹æé¿åºåååä¼ æ­ä¸­éæ¸è¶è¿ 0ï¼æ©ææ¶é´æ­¥çå½±åè¢«âæ¹æâï¼å¯¼è´é¿è·ç¦»ä¾èµé¾ä»¥å­¦ä¹ </td>
<td>åä¼ è¯æ¸¸æï¼ä¿¡æ¯ç»è¿å¤ªå¤äººï¼æå¼å§çè¯æ¢æ¢è¢«æ¨¡ç³çè³å¿æ</td>
</tr>
</tbody>
</table>

</div>
<div class="clear"></div>

            </div>
            <div class="postDesc">posted @ 
<span id="post-date" data-last-update-days="0" data-date-updated="2026-01-08 21:37">2026-01-08 21:37</span>&nbsp;
<a href="https://www.cnblogs.com/Goblinscholar">å¥å¸æå­¦è</a>&nbsp;
éè¯»(<span id="post_view_count">143</span>)&nbsp;
è¯è®º(<span id="post_comment_count">0</span>)&nbsp;
&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(19458774);return false;">æ¶è</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: '', targetType: 'blogPost', targetId: '19458774', targetLink: 'https://www.cnblogs.com/Goblinscholar/p/19458774', title: 'å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨äºï¼èªç¶è¯­è¨å¤ç  ç¬¬ä¸å¨ï¼å¾ªç¯ç¥ç»ç½ç» ï¼åï¼RNN ä¸­çæ¢¯åº¦ç°è±¡' })">ä¸¾æ¥</a>
</div>
         ]]>
    </description>
    </item>
        </channel>
        </rss>