{
  "title": "主页 - 博客园",
  "link": "https://www.cnblogs.com/",
  "description": "主页 - 博客园 RSS",
  "entries": [
    {
      "title": "Sdcb Chats 1.8：又一次底层重构，彻底将模型提供商解耦",
      "link": "https://www.cnblogs.com/sdcb/p/19503012/20260119-chats-180",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/sdcb/p/19503012/20260119-chats-180\" id=\"cb_post_title_url\" title=\"发布于 2026-01-20 08:45\">\n    <span>Sdcb Chats 1.8：又一次底层重构，彻底将模型提供商解耦</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>这是又一篇补档文章，Chats已经发布了1.10，但2025年11月5日发布的1.8版本对我个人来说意义非凡，因为它彻底改变了项目对“模型提供商”的支持方式，从“写死在代码里”变成了“完全配置化”，为后续的可维护性和扩展性打下了坚实基础。</p>\n<p>如果你还不了解 <strong>Sdcb Chats</strong>：简单说，这是一个支持多家主流模型服务商的 AI 网关。它不只能让你在一个统一界面里聚合管理所有模型，同时也兼容标准 API 协议，支持 Docker 一键部署。</p>\n<p>这篇文章聊聊 <strong>Chats 1.8 系列（1.8.0 + 1.8.1）</strong>。它不像“加一个新按钮”那样轻松，而是做了大量“地基工程”：把“模型提供商支持”从静态参考表迁移到了模型实例本身，并且补上了大量用户能直接感知到的体验升级。</p>\n<hr />\n<h2 id=\"18-的核心从静态参考表到模型实例级配置\">1.8 的核心：从“静态参考表”到“模型实例级配置”</h2>\n<p>到 chats 1.7.2 发布以来，已经支持有 18 个模型提供商，我当时为这 18 家模型提供商每一个模型都做了信息和数据跟踪，放到了 ModelReference 表，这个表有 297 条记录了，各大模型提供商卷大模型的速度越来越快，模型更新换代也越来越频繁，要可持续地维护这个表是非常困难的。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170804080-2002986397.png\" /></p>\n<p>除此之外，代码中还有大量根据模型名称写死的逻辑，这导致越来越难以维护。我和项目的合作维护者讨论过许多次，有许多不同的意见，有的说可以继续沿用这种写死的方式，有的说应该做成配置化的方式，但我觉得可持续的维护能力才是我对 chats 项目最重要的承诺，所以我决定在 1.8 版本里彻底重构模型提供商的支持方式，做成完全配置化的方式，这样未来无论是新增模型提供商，还是调整已有模型的支持逻辑，都可以通过配置来完成，而不需要动代码。这个改动虽然在短期内增加了不少工作量，但我相信从长远来看，这会大大提升项目的可维护性和扩展性。</p>\n<p>更技术一点地说：<strong>1.8.0 把“模型能力配置”从 <code>ModelReference</code> 这种静态参考表，迁移到了 <code>Model</code>（模型实例）本身</strong>——模型不再依赖“引用一条固定模板”，而是每个模型实例都拥有完整、可编辑、可验证的能力配置。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170804780-1304764941.png\" /></p>\n<h3 id=\"18-个模型能力字段落到-model终于能真正按实例定制\">18 个“模型能力字段”落到 Model：终于能真正“按实例定制”</h3>\n<p>这次迁移不是口头上的“配置化”，而是实打实的数据库变更：在 <code>src/scripts/db-migration/1.8/1.8.0.sql</code> 里，<code>Model</code> 表新增了一批能力字段（AllowSearch/AllowVision/AllowToolCall/温度范围/上下文窗口/最大输出 token/推理选项/图片尺寸/API 类型等），并且清理了多张静态参考表（<code>ModelReference</code>、<code>ModelProvider</code>、<code>Tokenizer</code>、<code>CurrencyRate</code>、<code>ReasoningResponseKind</code> ……）。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170805164-1145274511.png\" /></p>\n<h3 id=\"第三种-api-类型imagegeneration图像模型终于名正言顺\">第三种 API 类型：ImageGeneration（图像模型终于“名正言顺”）</h3>\n<p>1.8.0 新增了 <code>ApiType.ImageGeneration</code>，把图像生成从“勉强兼容”的逻辑里拎了出来：ChatCompletion / Response / ImageGeneration 三分天下，<code>ChatFactory</code> 也按 <code>ApiType</code> 分派到不同实现。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170805662-834816800.avif\" /></p>\n<h3 id=\"模型验证框架把填错配置的坑提前堵住\">模型验证框架：把“填错配置”的坑提前堵住</h3>\n<p>当能力配置变成“每个模型实例 18 个字段都可编辑”之后，靠用户自觉显然不现实。所以 1.8.0 加了 <code>UpdateModelRequest</code> 的验证框架（包含自定义验证特性和单测），把温度范围、token 上限、字段组合合法性都系统化了。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170806121-2000732051.avif\" /></p>\n<h3 id=\"快速添加模型把配置很多字段的摩擦降下来\">快速添加模型：把“配置很多字段”的摩擦降下来</h3>\n<p>为了对冲“字段变多导致的配置成本”，1.8.0 在后台做了 Quick Add/批量添加模型的流程优化，并补上了默认配置（<code>src/FE/constants/modelDefaults.ts</code> 里能看到一些默认能力/范围策略）。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170806489-55622397.avif\" /></p>\n<h3 id=\"图像链路重构从手写解析器到-imagesharp--全屏预览\">图像链路重构：从“手写解析器”到 ImageSharp + 全屏预览</h3>\n<p>1.8.0 还把图像处理这条链路整体重构了一遍：后端用 ImageSharp 替代了手写解析/嗅探逻辑（代码量直接少了一大截），前端新增了全屏 <code>ImagePreview</code> 组件，支持缩放动画、键盘导航和更顺滑的浏览体验。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170806876-1841292448.avif\" /></p>\n<h3 id=\"骨架屏与按需加载把等待变成可预期\">骨架屏与按需加载：把“等待”变成“可预期”</h3>\n<p>1.8.0 在聊天消息加载、管理后台的模型管理等页面补了骨架屏，并做了按需加载/渐进式渲染：这不是性能“变快了多少 ms”的问题，而是用户感知上从“卡住了”变成“正在加载”。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170807288-1746826065.avif\" /></p>\n<hr />\n<h2 id=\"181在架构变好之后把体验也抠到位\">1.8.1：在“架构变好”之后，把“体验也抠到位”</h2>\n<p>如果说 1.8.0 是地基，那么 1.8.1 更像是把常用路径都重新打磨了一遍：权限、推理内容展示、文件预览、聊天列表性能……这些都是你每天用 Chats 时能立刻感知到的变化。</p>\n<h3 id=\"全新的用户-模型权限管理终于能规模化授权了\">全新的“用户-模型权限”管理：终于能规模化授权了</h3>\n<p>1.8.1 新增了 <code>/admin/user-models</code>（按用户维度管理），同时在模型管理页也增加了“按模型维度管理用户”的入口。更关键的是它的交互设计：<strong>URL 作为状态唯一数据源</strong>，筛选/搜索/展开状态都能分享、刷新不丢。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170807703-1850645716.png\" /><br />\n<img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170808024-210681632.avif\" /></p>\n<h3 id=\"推理内容生命周期追踪--自动折叠屏幕终于不被思考占满\">推理内容“生命周期追踪 + 自动折叠”：屏幕终于不被思考占满</h3>\n<p>推理模型越来越多，推理内容越来越长，UI 不能只“展示”——还得帮用户“管理注意力”。1.8.1 给 <code>ReasoningContent</code> 增加了 <code>finished</code> 语义：推理进行中自动展开、结束后自动折叠；工具调用区块也做了自动折叠与动画，且尊重用户手动操作优先级。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170808347-1492521170.avif\" /></p>\n<h3 id=\"filepreview-组件重构附件展示不再各写一套\">FilePreview 组件重构：附件展示不再“各写一套”</h3>\n<p>1.8.1 引入了统一的 <code>FilePreview</code> 组件：图片/视频/音频直接预览，文档类显示图标+文件名+下载按钮；同时后端把文件处理从 Controller 下沉到了 Service 层，类型检查也更集中。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170808792-1929118479.avif\" /></p>\n<h3 id=\"聊天列表缓存打开就快一点刷新也稳一点\">聊天列表缓存：打开就快一点，刷新也稳一点</h3>\n<p>聊天列表不是什么“酷功能”，但它决定了你每天打开 Chats 的第一感受。1.8.1 里新增了 <code>chatCache.ts</code>：以用户名绑定缓存键、24 小时过期、登出自动清理，并配合并行 API 加载，让首屏更“有感”。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170809126-410299424.png\" /></p>\n<h3 id=\"提供商侧tokenpony-加入azure-openai-更名为-azure-ai-foundry\">提供商侧：TokenPony 加入，Azure OpenAI 更名为 Azure AI Foundry</h3>\n<p>1.8.1 新增了 TokenPony（ID=19），同时把 Azure OpenAI 的命名更新为 Azure AI Foundry（枚举值不变，属于代码层重命名），并补了一个小迁移脚本清理 Azure Host 里的 <code>api-version</code> 参数：<code>src/scripts/db-migration/1.8/1.8.1.sql</code>。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/233608/202601/233608-20260119170809460-172595794.png\" /></p>\n<h3 id=\"兼容性与稳定性openai-26-升级后推理内容解析修复\">兼容性与稳定性：OpenAI 2.6 升级后推理内容解析修复</h3>\n<p>1.8.1 还处理了一个很“现实”的问题：OpenAI 客户端升级到 2.6.0 后，推理内容的解析/解码出现兼容性问题，导致部分推理段无法正确读取。这个点不显眼，但它直接影响你对推理模型的信任感，所以也被纳入 1.8.1 里修掉了。</p>\n<hr />\n<h2 id=\"升级提醒18-系列需要手动跑-sql-server-迁移脚本\">升级提醒：1.8 系列需要手动跑 SQL Server 迁移脚本</h2>\n<p>和 1.7 一样：Sdcb Chats 的数据库变更 <strong>不支持自动数据迁移</strong>。升级到 1.8 时请务必先备份数据库，并手动执行迁移脚本：</p>\n<ul>\n<li>1.8.0：<code>src/scripts/db-migration/1.8/1.8.0.sql</code></li>\n<li>1.8.1：<code>src/scripts/db-migration/1.8/1.8.1.sql</code>（清理 Azure AI Foundry 的 Host 参数）</li>\n</ul>\n<p>如果你用的是 SQLite/Postgres……老规矩：把脚本丢给 AI 先改，再边跑边修；或者能接受删库的话，让 Chats 启动时自动建新表结构也行。</p>\n<hr />\n<p>感谢大家的阅读！喜欢的朋友请给我的Github项目一个star：<a href=\"https://github.com/sdcb/chats\" rel=\"noopener nofollow\" target=\"_blank\">https://github.com/sdcb/chats</a><br />\n如果你好奇的话，这是完整的更新日志：<a href=\"https://github.com/sdcb/chats/blob/main/doc/zh-CN/release-notes/README.md\" rel=\"noopener nofollow\" target=\"_blank\">https://github.com/sdcb/chats/blob/main/doc/zh-CN/release-notes/README.md</a><br />\n有什么想法也欢迎在评论区留言交流，也欢迎加入我的 Chats微信群：<br />\n<img alt=\"\" src=\"https://io.starworks.cc:88/cv-public/2026/chats-wxg-qr.png\" /></p>\n<p>（如果你更喜欢用QQ，可以用QQ群：<strong>498452653</strong>）我们一起探索更多AI技术硬核玩法。</p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-20 08:45</span>&nbsp;\n<a href=\"https://www.cnblogs.com/sdcb\">.NET骚操作</a>&nbsp;\n阅读(<span id=\"post_view_count\">50</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "蓝牙基础(九)：详解蓝牙 GAP、SDP、ATT、GATT 的历史背景与设计哲学",
      "link": "https://www.cnblogs.com/liwen01/p/19492724",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/liwen01/p/19492724\" id=\"cb_post_title_url\" title=\"发布于 2026-01-20 08:42\">\n    <span>蓝牙基础(九)：详解蓝牙 GAP、SDP、ATT、GATT 的历史背景与设计哲学</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<p class=\"js_darkmode__1\"><strong class=\"js_darkmode__2\">liwen01 2026.01.01</strong></p>\n<h2 class=\"js_darkmode__3\"><span class=\"js_darkmode__4\">前言</span></h2>\n<p class=\"js_darkmode__5\">我们现在使用的蓝牙，它不是一蹴而就的，它经历了从<strong class=\"js_darkmode__6\">电缆替代者</strong>（经典蓝牙）到&nbsp;<strong class=\"js_darkmode__7\">万物互联基石</strong>（低功耗蓝牙）的演变。</p>\n<p class=\"js_darkmode__8\">要理解&nbsp;<code class=\"js_darkmode__9\">SDP</code>、<code class=\"js_darkmode__10\">GAP</code>、<code class=\"js_darkmode__11\">ATT</code>、<code class=\"js_darkmode__12\">GATT</code>&nbsp;这些类似重叠的协议，需要回到蓝牙技术发展的历史背景和设计哲学。</p>\n<h2 class=\"js_darkmode__13\"><span class=\"js_darkmode__14\">（一）历史背景</span></h2>\n<h3 class=\"js_darkmode__15\"><span class=\"js_darkmode__16\">（1）早期无线通信的春秋战国</span></h3>\n<p class=\"js_darkmode__17\">在蓝牙标准诞生之初，不同厂家对<strong class=\"js_darkmode__18\">如何发现对方</strong>、<strong class=\"js_darkmode__19\">如何加密</strong>、<strong class=\"js_darkmode__20\">如何连接</strong>有不同的理解。如果没有一个统一的框架，A 厂家的手机可能根本搜不到 B 厂家的耳机。</p>\n<p class=\"js_darkmode__21\"><strong class=\"js_darkmode__22\">GAP</strong>&nbsp;(Generic Access Profile) 的存在是为了定义<strong class=\"js_darkmode__23\">通用的行为准则</strong>，设计目的有两个：</p>\n<p class=\"js_darkmode__24\"><strong class=\"js_darkmode__25\">（A）标准化流程</strong>：它规定了所有蓝牙设备必须如何打招呼（广播）、如何交换名片（发现）以及如何建立外交关系（连接）。</p>\n<p class=\"js_darkmode__26\"><strong class=\"js_darkmode__27\">（B）解耦</strong>：它让上层应用不需要关心底层的物理跳频或链路层状态转换，只需知道自己是<strong class=\"js_darkmode__28\">中心设备</strong>（Central）还是&nbsp;<strong class=\"js_darkmode__29\">外围设备</strong>（Peripheral）。</p>\n<h3 class=\"js_darkmode__30\"><span class=\"js_darkmode__31\">（2）解决经典蓝牙业务繁杂问题</span></h3>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161205390-1764873844.png\" />\n<p class=\"js_darkmode__33\">经典蓝牙（BR/EDR）的设计初衷是取代各种电缆（串口线、打印线、耳机线）。</p>\n<p class=\"js_darkmode__34\">因此，它承载了非常多的特定协议（Profiles），如 HFP（通话）、A2DP（音乐）、SPP（串口）。</p>\n<p class=\"js_darkmode__35\"><strong class=\"js_darkmode__36\">SDP</strong>&nbsp;(Service Discovery Protocol) 就是蓝牙世界里的<strong class=\"js_darkmode__37\">黄页服务</strong>，设计目的也有两个：</p>\n<p class=\"js_darkmode__38\"><strong class=\"js_darkmode__39\">（A）动态查询：</strong>&nbsp;经典蓝牙设备通常功能复杂，当手机连接音箱时，它不知道这个音箱是否带麦克风（HFP），也不知其音质等级（A2DP）。</p>\n<p class=\"js_darkmode__40\"><strong class=\"js_darkmode__41\">（B）按需建立：</strong>&nbsp;通过 SDP，设备可以先查询对方支持哪些服务，获取连接这些服务所需的<strong class=\"js_darkmode__42\">端口号</strong>（如 RFCOMM 通道），然后再建立真正的业务连接，节省了系统资源。</p>\n<h3 class=\"js_darkmode__43\"><span class=\"js_darkmode__44\">（3）解决BLE极致功耗问题</span></h3>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161608250-1350751949.png\" />\n<p class=\"js_darkmode__46\">2010年左右，蓝牙 4.0 (BLE) 问世。此时的设计目标变了：不再是传输高带宽的音频，而是传输极小的数据（如温度、心率），且要求一颗纽扣电池能用一年。</p>\n<p class=\"js_darkmode__47\">经典蓝牙的协议栈（包括 SDP）对于这些小传感器来说太重、太费电了。</p>\n<p class=\"js_darkmode__48\"><strong class=\"js_darkmode__49\">为了极致省电，蓝牙设计者提出了 ATT 和 GATT 的组合：</strong></p>\n<p class=\"js_darkmode__50\">传感器数据通常非常简单（就是一个数值），比如温度湿度传感器。</p>\n<p class=\"js_darkmode__51\"><strong class=\"js_darkmode__52\">（A）ATT (Attribute Protocol)：极简的搬运工</strong></p>\n<p class=\"js_darkmode__53\"><strong class=\"js_darkmode__54\">ATT</strong>&nbsp;弃了复杂的握手，将所有数据简化为<strong class=\"js_darkmode__55\">属性（Attribute）</strong>。它只负责最简单的操作：读、写、通知。它像是一个高效的仓库搬运工，只认<strong class=\"js_darkmode__56\">货架号（Handle）</strong>，不问数据背后的逻辑。</p>\n<p class=\"js_darkmode__57\">但是ATT的属性（Attribute）太底层了，一堆 handle 很难管理，所以就有了GATT 。</p>\n<p class=\"js_darkmode__58\"><strong class=\"js_darkmode__59\">（B）GATT (Generic Attribute Profile)：逻辑的架构师</strong></p>\n<p class=\"js_darkmode__60\"><strong class=\"js_darkmode__61\">GATT</strong>&nbsp;的目的是在 ATT 之上建立了一套层级结构（Service &gt; Characteristic），把 ATT 相关的属性打包。</p>\n<p class=\"js_darkmode__62\">GATT 是声明式的，它不需要像 SDP 那样进行复杂的动态交互，而是通过简单的属性列表直接告诉对方：<strong class=\"js_darkmode__63\">我的 0x0012 货架放的是心率数据</strong></p>\n<h2 class=\"js_darkmode__64\"><span class=\"js_darkmode__65\">（二）GAP（Generic Access Profile）</span></h2>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161618653-435478667.png\" />\n<p class=\"js_darkmode__67\"><strong class=\"js_darkmode__68\">GAP</strong>（Generic Access Profile，通用访问配置文件）是蓝牙协议栈中最基础、最重要的配置文件之一。</p>\n<p class=\"js_darkmode__69\">可以把它看做是蓝牙设备的<strong class=\"js_darkmode__70\">身份证</strong>和<strong class=\"js_darkmode__71\">外交官</strong>。它定义了设备如何互相发现、建立连接以及确保基本的互操作性。</p>\n<h3 class=\"js_darkmode__72\"><span class=\"js_darkmode__73\">（1）GAP 的核心作用</span></h3>\n<p class=\"js_darkmode__74\">为确保不同厂商的设备能够互相发现并建立连接，GAP 的核心作用有4个：</p>\n<p class=\"js_darkmode__75\"><strong class=\"js_darkmode__76\">（A）模式与过程 (Modes and Procedures)：</strong>&nbsp;设备如何被发现（广播）以及如何发现别人（扫描）。</p>\n<p class=\"js_darkmode__77\"><strong class=\"js_darkmode__78\">（B）角色 (Roles)：</strong>&nbsp;定义设备在蓝牙网络中的身份（如手机是 Central，手环是 Peripheral）。</p>\n<p class=\"js_darkmode__79\"><strong class=\"js_darkmode__80\">（C）安全 (Security)：</strong>&nbsp;定义安全级别和配对模式的基础。</p>\n<p class=\"js_darkmode__81\"><strong class=\"js_darkmode__82\">（D）数据格式 (Data Formats)：</strong>&nbsp;定义广播数据和扫描响应数据的通用格式。</p>\n<h3 class=\"js_darkmode__83\"><span class=\"js_darkmode__84\">（2）GAP 四大核心角色(Roles)</span></h3>\n<p class=\"js_darkmode__85\">在连接建立之前，GAP 首先定义了设备在链路层表现出的<strong class=\"js_darkmode__86\">身份</strong>。这决定了谁负责发信号，谁负责找信号。</p>\n<p class=\"js_darkmode__87\">在低功耗蓝牙 (BLE) 中，GAP 定义了四种特定的角色。这些角色决定了链路层 (Link Layer) 的状态。</p>\n<p class=\"js_darkmode__88\"><strong class=\"js_darkmode__89\">（A）Broadcaster（广播者）：</strong>&nbsp;仅发送广播数据，<strong class=\"js_darkmode__90\">不支持</strong>建立连接，比如：温度传感器、Beacon。此时链路层处于 Advertising State 状态。</p>\n<p class=\"js_darkmode__91\"><strong class=\"js_darkmode__92\">（B）Observer（观察者）：</strong>&nbsp;仅扫描广播数据，<strong class=\"js_darkmode__93\">不支持</strong>发起连接，比如：仅用于数据采集的网关，此时链路层处于 Scanning State 状态。</p>\n<p class=\"js_darkmode__94\"><strong class=\"js_darkmode__95\">（C）Peripheral（外设）：</strong>&nbsp;发送广播，<strong class=\"js_darkmode__96\">支持</strong>被连接。通常是数据提供方，通常是性能受限、对功耗敏感的设备，比如：智能手环、心率带、智能锁。</p>\n<p class=\"js_darkmode__97\">此时链路层处于Advertising / Connection (Slave) 状态</p>\n<p class=\"js_darkmode__98\"><strong class=\"js_darkmode__99\">（D）Central（中心设备）：</strong>&nbsp;扫描广播，<strong class=\"js_darkmode__100\">发起</strong>连接。通常是控制方和数据处理方,一般拥有更强处理能力和电量的设备,比如：智能手机、平板电脑。</p>\n<p class=\"js_darkmode__101\">此时链路层处于Scanning / Connection (Master) 状态</p>\n<p class=\"js_darkmode__102\"><strong class=\"js_darkmode__103\">注意</strong>： 一个设备可以在不同时间切换不同角色，甚至在 V5.x 中通过多重连接拓扑同时扮演不同角色。</p>\n<h3 class=\"js_darkmode__104\"><span class=\"js_darkmode__105\">（3）GAP 的操作模式、过程、连接参数</span></h3>\n<p class=\"js_darkmode__106\"><strong class=\"js_darkmode__107\">（A）发现模式 (Discoverability Modes)</strong>&nbsp;:有三种发现模式：</p>\n<p class=\"js_darkmode__108\"><strong class=\"js_darkmode__109\">不可被发现模式 (Non-Discoverable Mode)：</strong>&nbsp;设备不发送广播，或者发送的广播不支持被发现（仅用于维持现有连接或广播特定非发现数据）。</p>\n<p class=\"js_darkmode__110\"><strong class=\"js_darkmode__111\">有限可发现模式 (Limited Discoverable Mode)：</strong>&nbsp;设备在短时间内（通常有超时限制）可被发现。常用于按下按钮后的配对状态。</p>\n<p class=\"js_darkmode__112\"><strong class=\"js_darkmode__113\">一般可发现模式 (General Discoverable Mode)：</strong>&nbsp;设备在很长一段时间内都可以被发现。这是大多数消费电子产品的默认状态。</p>\n<p class=\"js_darkmode__114\"><strong class=\"js_darkmode__115\">（B）连接模式 (Connectability Modes)</strong>&nbsp;有三种:</p>\n<p class=\"js_darkmode__116\"><strong class=\"js_darkmode__117\">不可连接 (Non-Connectable)：</strong>&nbsp;仅广播数据，拒绝连接请求。</p>\n<p class=\"js_darkmode__118\"><strong class=\"js_darkmode__119\">定向可连接 (Directed Connectable)：</strong>&nbsp;仅接受来自特定（已绑定）设备的连接请求，用于快速重连。</p>\n<p class=\"js_darkmode__120\"><strong class=\"js_darkmode__121\">无向可连接 (Undirected Connectable)：</strong>&nbsp;接受任何设备的连接请求。</p>\n<p class=\"js_darkmode__122\"><strong class=\"js_darkmode__123\">（C）发现过程 (Discovery Procedures)</strong></p>\n<p class=\"js_darkmode__124\">作为中心设备（Central）或观察者（Observer），GAP 定义了如何去发现周围设备：</p>\n<p class=\"js_darkmode__125\"><strong class=\"js_darkmode__126\">有限发现过程 (Limited Discovery Procedure)：</strong>&nbsp;仅过滤并显示处于<strong class=\"js_darkmode__127\">有限可发现模式</strong>的设备。</p>\n<p class=\"js_darkmode__128\"><strong class=\"js_darkmode__129\">一般发现过程 (General Discovery Procedure)：</strong>&nbsp;发现所有可发现的设备。</p>\n<p class=\"js_darkmode__130\"><strong class=\"js_darkmode__131\">（D）连接参数 (Connection Parameters)</strong></p>\n<p class=\"js_darkmode__132\">在 GAP 中，定义了中心设备和外围设备建立连接时必须协商的关键参数。这些参数直接影响<strong class=\"js_darkmode__133\">功耗</strong>和<strong class=\"js_darkmode__134\">数据吞吐量</strong>。</p>\n<p class=\"js_darkmode__135\"><strong class=\"js_darkmode__136\">连接间隔 (Connection Interval)：</strong>&nbsp;两次通信之间的时间间隔（7.5ms ~ 4.0s）。</p>\n<p class=\"js_darkmode__137\">间隔越短，速度越快但耗电；间隔越长，越省电。</p>\n<p class=\"js_darkmode__138\"><strong class=\"js_darkmode__139\">外围设备延迟 (Peripheral Latency/Slave Latency)：</strong>&nbsp;允许外围设备在没有数据发送时跳过连接事件的次数。这对低功耗至关重要。</p>\n<p class=\"js_darkmode__140\"><strong class=\"js_darkmode__141\">监督超时 (Supervision Timeout)：</strong>&nbsp;如果超过这个时间没有通信，连接被视为断开。</p>\n<p class=\"js_darkmode__142\">在蓝牙 5.3 引入了 Connection Subrating (连接子速率)，虽然这主要是链路层的功能，</p>\n<p class=\"js_darkmode__143\">但在 GAP 层面，它允许设备在保持低占空比（省电）的同时，能够更快速地切换到高占空比（高性能）模式，而无需完全重新协商连接参数。</p>\n<h3 class=\"js_darkmode__144\"><span class=\"js_darkmode__145\">（4）GAP 与底层（Link Layer）的协调逻辑</span></h3>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161632014-1638310985.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<p class=\"js_darkmode__147\">在架构图中，GAP 位于&nbsp;<strong class=\"js_darkmode__148\">L2CAP</strong>&nbsp;和&nbsp;<strong class=\"js_darkmode__149\">Link Layer (LL)</strong>&nbsp;之上。它的管理指令是自上而下下达的：</p>\n<p class=\"js_darkmode__150\"><strong class=\"js_darkmode__151\">GAP 发指令：</strong>&nbsp;应用层告诉 GAP&nbsp;<strong class=\"js_darkmode__152\">我要连接那台名为 'Apple Watch' 的设备</strong>。</p>\n<p class=\"js_darkmode__153\"><strong class=\"js_darkmode__154\">GAP 调度：</strong>&nbsp;GAP 检查当前配置，并命令 Link Layer 进入&nbsp;<strong class=\"js_darkmode__155\">Initiating State（发起状态）</strong>。</p>\n<p class=\"js_darkmode__156\"><strong class=\"js_darkmode__157\">LL 执行：</strong>&nbsp;Link Layer 在空中监听对方的广播包，并在极短的窗口期内完成握手。</p>\n<p class=\"js_darkmode__158\"><strong class=\"js_darkmode__159\">GAP 反馈：</strong>&nbsp;连接成功后，GAP 会通知上层（如 GATT 或应用层）：<strong class=\"js_darkmode__160\">链路已建立，可以开始传输数据了</strong>。</p>\n<h3 class=\"js_darkmode__161\"><span class=\"js_darkmode__162\">（5）为什么手环设备能省电</span></h3>\n<p class=\"js_darkmode__163\">这里我们以蓝牙手环来举例，从手环的初始化、连接、进入静默期、调整 这个周期来看它是如何进行功耗管理的。</p>\n<p class=\"js_darkmode__164\"><strong class=\"js_darkmode__165\">初始化：</strong>&nbsp;手环 GAP 设置为&nbsp;<strong class=\"js_darkmode__166\">Peripheral</strong>，每 1 秒发一次广播。</p>\n<p class=\"js_darkmode__167\"><strong class=\"js_darkmode__168\">连接：</strong>&nbsp;手机&nbsp;<strong class=\"js_darkmode__169\">Central</strong>&nbsp;发现手环，GAP 建立连接，初始连接间隔设为&nbsp;<strong class=\"js_darkmode__170\">30ms</strong>（为了快速同步数据）。</p>\n<p class=\"js_darkmode__171\"><strong class=\"js_darkmode__172\">进入静默期：</strong>&nbsp;数据同步完了，App 进入后台。此时手机 GAP 发起<strong class=\"js_darkmode__173\">连接参数更新请求</strong>。</p>\n<p class=\"js_darkmode__174\"><strong class=\"js_darkmode__175\">调整：</strong>&nbsp;连接间隔被拉长到&nbsp;<strong class=\"js_darkmode__176\">500ms</strong>，且设置了&nbsp;<strong class=\"js_darkmode__177\">Slave Latency = 10</strong>。这意味着手环即使每 500ms 该醒来一次，但如果没数据，它可以连续<strong class=\"js_darkmode__178\">睡</strong>&nbsp;10 次，也就是 5 秒钟才跟手机通信一次。</p>\n<p class=\"js_darkmode__179\">结果就是：这种由 GAP 协调的参数调整，让你的手环续航从 3 天延长到了 20 天。</p>\n<h2 class=\"js_darkmode__180\"><span class=\"js_darkmode__181\">（三）SDP (Service Discovery Protocol)</span></h2>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161648229-1416782711.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<p class=\"js_darkmode__183\"><strong class=\"js_darkmode__184\">SDP</strong>&nbsp;(Service Discovery Protocol) 是 金典蓝牙(BR/EDR)设备的&nbsp;<strong class=\"js_darkmode__185\">黄页电话簿</strong>。</p>\n<p class=\"js_darkmode__186\">在两个<strong class=\"js_darkmode__187\">金典蓝牙</strong>设备建立连接后，必须通过 SDP 来查询对方：<strong class=\"js_darkmode__188\">你到底支持哪些功能？怎么连接这些功能？</strong></p>\n<h3 class=\"js_darkmode__189\"><span class=\"js_darkmode__190\">（1）SDP 的核心概念与适用范围</span></h3>\n<p class=\"js_darkmode__191\">SDP 提供了一种机制，允许客户端应用程序发现服务器应用程序提供的服务以及这些服务的属性。</p>\n<p class=\"js_darkmode__192\">它不定义具体的服务操作（那是各个 Profile 的事），只负责发现。</p>\n<p class=\"js_darkmode__193\"><strong class=\"js_darkmode__194\">重要前提</strong>： SDP 主要用于 蓝牙经典 (BR/EDR) 技术，虽然 BLE 设备主要用 GATT，但双模设备（Dual Mode，同时支持 Classic 和 BLE）依然必须实现 SDP 栈以支持经典蓝牙部分的功能。</p>\n<h3 class=\"js_darkmode__195\"><span class=\"js_darkmode__196\">（2）SDP 架构与角色 (Architecture &amp; Roles)</span></h3>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161702037-464956041.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<p class=\"js_darkmode__198\">SDP 采用简单的&nbsp;<strong class=\"js_darkmode__199\">Client-Server (客户端-服务器)</strong>&nbsp;模型：</p>\n<p class=\"js_darkmode__200\"><strong class=\"js_darkmode__201\">SDP Server (服务端)：</strong>&nbsp;通常是提供服务的设备（如蓝牙音箱），它维护一个服务记录数据库。</p>\n<p class=\"js_darkmode__202\"><strong class=\"js_darkmode__203\">SDP Client (客户端)：</strong>&nbsp;通常是想要使用服务的设备（如手机），它向服务端发起查询。</p>\n<p class=\"js_darkmode__204\">常见的查询方式有：</p>\n<p class=\"js_darkmode__205\"><strong class=\"js_darkmode__206\">服务搜索 (Service Search)：</strong>&nbsp;客户端问：你这里有支持 UUID 为 0x110B（音频接收）的服务吗？</p>\n<p class=\"js_darkmode__207\"><strong class=\"js_darkmode__208\">属性获取 (Service Attribute)：</strong>&nbsp;客户端问：对于这个音频服务，你的连接通道是多少？</p>\n<p class=\"js_darkmode__209\"><strong class=\"js_darkmode__210\">服务浏览 (Service Browsing)：</strong>&nbsp;客户端请求查看服务器上所有可公开的服务列表。</p>\n<h3 class=\"js_darkmode__211\"><span class=\"js_darkmode__212\">（3）SDP 的核心组件、数据模型</span></h3>\n<p class=\"js_darkmode__213\">SDP 服务器维护的数据库由一系列 Service Records (服务记录) 组成。</p>\n<p class=\"js_darkmode__214\"><strong class=\"js_darkmode__215\">（1）Service Record (服务记录)</strong></p>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161715276-1451476449.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<p class=\"js_darkmode__217\"><strong class=\"js_darkmode__218\">Service Record Handle:</strong>&nbsp; 每一个服务（如<strong class=\"js_darkmode__219\">免提通话</strong>、<strong class=\"js_darkmode__220\">串口通信</strong>）都对应一条记录，这是 SDP 服务器分配给某一个服务的索引号。</p>\n<p class=\"js_darkmode__221\">在一台设备（Server）上，每一个服务记录都有一个唯一的句柄，长度为32位，称为 Handle。</p>\n<p class=\"js_darkmode__222\"><strong class=\"js_darkmode__223\">分配规则</strong>： 范围是 0x00000000 到 0xFFFFFFFF。通常 0x00000000 是保留给 SDP 服务本身的。</p>\n<p class=\"js_darkmode__224\"><strong class=\"js_darkmode__225\">（2）Service Attributes (服务属性)</strong></p>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161727144-2105630239.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<p class=\"js_darkmode__227\">每条记录包含多个属性，描述该服务的细节。属性由&nbsp;<strong class=\"js_darkmode__228\">Attribute ID</strong>&nbsp;和&nbsp;<strong class=\"js_darkmode__229\">Attribute Value</strong>&nbsp;组成。</p>\n<p class=\"js_darkmode__230\"><strong class=\"js_darkmode__231\">Attribute ID</strong>&nbsp; (属性 ID)： 定义了该属性的含义，由蓝牙 SIG 统一规定，例如：</p>\n<ul class=\"list-paddingleft-1 js_darkmode__232\">\n<li><code class=\"js_darkmode__234\">0x0001</code>：始终代表&nbsp;<code class=\"js_darkmode__235\">ServiceClassIDList</code>（服务类别列表）。</li>\n<li><code class=\"js_darkmode__237\">0x0100</code>：始终代表&nbsp;<code class=\"js_darkmode__238\">ServiceName</code>（服务名称）。</li>\n</ul>\n<p class=\"js_darkmode__239\">客户端通过这个 ID 告诉服务器：请把这个服务的 ServiceName（0x0100） 告诉我。</p>\n<p class=\"js_darkmode__240\"><strong class=\"js_darkmode__241\">Attribute Value</strong>&nbsp;(属性值) ： 这是最具体的数据，它的格式叫 Data Element，可以是一个整数、一个字符串、一个布尔值，甚至是一个嵌套的列表。</p>\n<p class=\"js_darkmode__242\"><strong class=\"js_darkmode__243\">（3）UUID (通用唯一标识符)</strong></p>\n<p class=\"js_darkmode__244\">UUID 这是 SDP 的灵魂，它是一个全球唯一的标签，用来标识<strong class=\"js_darkmode__245\">这就是 A2DP 音频</strong>或<strong class=\"js_darkmode__246\">这就是串口协议</strong>。</p>\n<p class=\"js_darkmode__247\"><strong class=\"js_darkmode__248\">关键点</strong>： UUID 通常是作为<strong class=\"js_darkmode__249\">Attribute Value</strong>的一部分出现的。</p>\n<p class=\"js_darkmode__250\">比如在&nbsp;<code class=\"js_darkmode__251\">ServiceClassIDList</code>&nbsp;这个属性（ID 为&nbsp;<code class=\"js_darkmode__252\">0x0001</code>）里，它的值通常就是一个 UUID（如&nbsp;<code class=\"js_darkmode__253\">0x110B</code>&nbsp;代表 A2DP Audio Sink）。</p>\n<p class=\"js_darkmode__254\">一般16位 UUID（简短版）用于官方标准服务，128位 UUID（完整版）用于厂商自定义服务。</p>\n<p class=\"js_darkmode__255\"><strong class=\"js_darkmode__256\">（4）Handle、Attribute ID、Value、UUID 的区别</strong></p>\n<p class=\"js_darkmode__257\"><strong class=\"js_darkmode__258\">Handle</strong>&nbsp;(32位)<strong class=\"js_darkmode__259\">：</strong>找到那个服务记录的钥匙。</p>\n<p class=\"js_darkmode__260\"><strong class=\"js_darkmode__261\">Attribute ID</strong>&nbsp;(16位)：指明你想看记录里的哪一项。</p>\n<p class=\"js_darkmode__262\"><strong class=\"js_darkmode__263\">Attribute Value</strong>：那一项里存的实际数据。</p>\n<p class=\"js_darkmode__264\"><strong class=\"js_darkmode__265\">UUID</strong>：存在数据里的<strong class=\"js_darkmode__266\">标准身份标签</strong>。</p>\n<h3 class=\"js_darkmode__267\"><span class=\"js_darkmode__268\">（4）SDP 协议过程 (Protocol Procedures)</span></h3>\n<p class=\"js_darkmode__269\">SDP 定义了三种主要的 PDU (协议数据单元) 交互模式，运行在 L2CAP 协议之上（通常使用 PSM&nbsp;<code class=\"js_darkmode__270\">0x0001</code>）。</p>\n<p class=\"js_darkmode__271\"><strong class=\"js_darkmode__272\">（A）Service Search Transaction (服务搜索)</strong></p>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161746937-210164031.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<p class=\"js_darkmode__274\"><strong class=\"js_darkmode__275\">Client 问:</strong>&nbsp;你有支持 UUID 为&nbsp;<code class=\"js_darkmode__276\">0x1101</code>&nbsp;(Serial Port) 的服务吗？</p>\n<p class=\"js_darkmode__277\"><strong class=\"js_darkmode__278\">Server 答:</strong>&nbsp;有，对应的 Service Record Handle 是&nbsp;<code class=\"js_darkmode__279\">0x00010005</code>。</p>\n<p class=\"js_darkmode__280\"><strong class=\"js_darkmode__281\">用途:</strong>&nbsp;仅获取记录的句柄，不获取具体细节。</p>\n<p class=\"js_darkmode__282\"><strong class=\"js_darkmode__283\">（B）Service Attribute Transaction (属性获取)</strong></p>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161807388-333043667.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<p class=\"js_darkmode__285\"><strong class=\"js_darkmode__286\">Client 问:</strong>&nbsp;请给我 Handle 为&nbsp;<code class=\"js_darkmode__287\">0x00010005</code>&nbsp;的所有属性（或者特定属性，如协议列表）。</p>\n<p class=\"js_darkmode__288\"><strong class=\"js_darkmode__289\">Server 答:</strong>&nbsp;这是属性列表：ID&nbsp;<code class=\"js_darkmode__290\">0x0001</code>&nbsp;是...，ID&nbsp;<code class=\"js_darkmode__291\">0x0004</code>&nbsp;是...</p>\n<p class=\"js_darkmode__292\"><strong class=\"js_darkmode__293\">用途:</strong>&nbsp;已知句柄，获取详细信息。</p>\n<p class=\"js_darkmode__294\"><strong class=\"js_darkmode__295\">（C）Service Search Attribute Transaction (搜索并获取)</strong></p>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161820643-1809280923.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<p class=\"js_darkmode__297\"><strong class=\"js_darkmode__298\">Client 问:</strong>&nbsp;查找支持 UUID&nbsp;<code class=\"js_darkmode__299\">0x1101</code>&nbsp;的服务，并直接把它们的协议列表属性发给我。</p>\n<p class=\"js_darkmode__300\"><strong class=\"js_darkmode__301\">Server 答:</strong>&nbsp;找到了，这是数据...</p>\n<p class=\"js_darkmode__302\"><strong class=\"js_darkmode__303\">用途:</strong>&nbsp;<strong class=\"js_darkmode__304\">最高效的方式</strong>，一次交互完成搜索和读取，减少空中交互时间。</p>\n<h2 class=\"js_darkmode__305\"><span class=\"js_darkmode__306\">（四）ATT (Attribute Protocol)</span></h2>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161831665-1799709478.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<p class=\"js_darkmode__308\"><strong class=\"js_darkmode__309\">ATT</strong>&nbsp;(Attribute Protocol) 是蓝牙低功耗 (BLE) 世界的&nbsp;<strong class=\"js_darkmode__310\">搬运工</strong>。它是 BLE 通信的最底层数据传输协议。</p>\n<p class=\"js_darkmode__311\">上层的 GATT (Generic Attribute Profile) 几乎所有的操作（读、写、通知）都是通过 ATT 协议定义的 PDU (协议数据单元) 来完成的。</p>\n<h3 class=\"js_darkmode__312\"><span class=\"js_darkmode__313\">（1）ATT 的核心架构与角色</span></h3>\n<p class=\"js_darkmode__314\">ATT 定义了两个核心角色，这两个角色完全独立于 GAP 的<strong class=\"js_darkmode__315\">主机/从机</strong>或<strong class=\"js_darkmode__316\">中心/外围</strong>角色。</p>\n<p class=\"js_darkmode__317\"><strong class=\"js_darkmode__318\">服务器 (Server):</strong>:数据持有者,它存储了所有的状态、数据和配置信息（即<strong class=\"js_darkmode__319\">属性</strong>）。它通常是传感器设备（如心率带、温度计）。</p>\n<p class=\"js_darkmode__320\"><strong class=\"js_darkmode__321\">注意</strong>：在大多数情况下，BLE 外围设备 (Peripheral) 充当 ATT Server，但这并不是强制的。</p>\n<p class=\"js_darkmode__322\"><strong class=\"js_darkmode__323\">客户端</strong>&nbsp;(Client)：数据请求者，它向服务器发起请求，或者接收服务器推送的数据。通常是手机、网关或平板电脑。</p>\n<h3 class=\"js_darkmode__324\"><span class=\"js_darkmode__325\">（2）ATT 的属性（数据单元）</span></h3>\n<p class=\"js_darkmode__326\">ATT 层传输的最小单位就是&nbsp;<strong class=\"js_darkmode__327\">Attribute</strong>&nbsp;(属性)。服务器本质上就是一个巨大的属性列表（Attribute Table）。每一个属性都由以下四个元素组成：</p>\n<p class=\"js_darkmode__328\"><strong class=\"js_darkmode__329\">Attribute Handle</strong>：handle 长度16bit，它是属性的<strong class=\"js_darkmode__330\">地址</strong>或索引。客户端通过句柄来找到它要读写的数据。范围：0x0001 ~ 0xFFFF。</p>\n<p class=\"js_darkmode__331\"><strong class=\"js_darkmode__332\">Attribute Type</strong>&nbsp;：定义这到底是什么数据。使用 UUID 标识（如 0x2800 代表<strong class=\"js_darkmode__333\">服务声明</strong>，0x2A37 代表<strong class=\"js_darkmode__334\">心率测量值</strong>）。</p>\n<p class=\"js_darkmode__335\"><strong class=\"js_darkmode__336\">Attribute Value</strong>&nbsp;：实际的数据载体。长度可变（0 ~ 512 字节）。</p>\n<p class=\"js_darkmode__337\"><strong class=\"js_darkmode__338\">Attribute Permissions</strong>：定义谁可以访问该属性（读/写/加密要求）。注意：权限不通过空中传输，仅存在于服务器内部逻辑中。</p>\n<h3 class=\"js_darkmode__339\"><span class=\"js_darkmode__340\">（3）ATT PDU 类型 (通信方式)</span></h3>\n<p class=\"js_darkmode__341\">ATT 协议定义了 6 种基本的通信交互模式 (PDU Types)。理解这 6 种模式是理解 BLE 数据流的关键。</p>\n<p class=\"js_darkmode__342\"><strong class=\"js_darkmode__343\">（A）请求</strong>&nbsp;(<strong class=\"js_darkmode__344\">Request</strong>) 由 Client -&gt; Server，客户端发送请求，<strong class=\"js_darkmode__345\">必须</strong>等待服务器回复响应，比如：手机读取手环电量 (<code class=\"js_darkmode__346\">Read Request</code>)。 特点是：串行，慢，但可靠。</p>\n<p class=\"js_darkmode__347\"><strong class=\"js_darkmode__348\">（B）响应</strong>(<strong class=\"js_darkmode__349\">Response</strong>)：由 Server -&gt; Client，服务器对请求的回复，比如：手环回复电量值 (<code class=\"js_darkmode__350\">Read Response</code>)。</p>\n<p class=\"js_darkmode__351\"><strong class=\"js_darkmode__352\">（C）命令</strong>&nbsp;(<strong class=\"js_darkmode__353\">Command</strong>)：由 Client -&gt; Server 。客户端发送数据，<strong class=\"js_darkmode__354\">不需要</strong>服务器回复。也叫 \"Write without Response\"。比如：手机快速向智能灯泡发送调色指令。</p>\n<p class=\"js_darkmode__355\">特点是：由底层链路层保证数据到达，应用层不确认，速度最快</p>\n<p class=\"js_darkmode__356\"><strong class=\"js_darkmode__357\">（D）通知</strong>&nbsp;(<strong class=\"js_darkmode__358\">Notification</strong>)： 由 Server -&gt; Client。服务器主动推送数据，<strong class=\"js_darkmode__359\">不需要</strong>客户端确认。比如：心率带每秒推送一次实时心率。特点是：最常用的数据上报方式，吞吐量高。</p>\n<p class=\"js_darkmode__360\"><strong class=\"js_darkmode__361\">（E）指示</strong>&nbsp;(<strong class=\"js_darkmode__362\">Indication</strong>)：由Server -&gt; Client。服务器主动推送数据，<strong class=\"js_darkmode__363\">必须</strong>等待客户端回复确认。在收到确认前，服务器不能发下一条。比如：血糖仪发送血糖结果（数据至关重要，必须确保对方应用层收到了）。</p>\n<p class=\"js_darkmode__364\">特点是：慢，但在应用层极其可靠</p>\n<p class=\"js_darkmode__365\"><strong class=\"js_darkmode__366\">（F）确认</strong>&nbsp;(<strong class=\"js_darkmode__367\">Confirmation</strong>)：由 Client -&gt; Server。是客户端收到指示 (Indication) 后的回复。</p>\n<h3 class=\"js_darkmode__368\"><span class=\"js_darkmode__369\">（4）增强型 ATT (Enhanced ATT, EATT)</span></h3>\n<p class=\"js_darkmode__370\">增强型 ATT (Enhanced ATT, EATT) 这是从蓝牙 5.2 引入并在 V5.3 中继续强化的重要特性。</p>\n<p class=\"js_darkmode__371\"><strong class=\"js_darkmode__372\">传统 ATT (Legacy ATT):</strong>&nbsp;是<strong>顺序 (Sequential)</strong>的。如果你发送了一个 Read Request，在收到 Read Response 之前，你不能发送任何其他请求。</p>\n<p class=\"js_darkmode__373\">这就像单行道，容易造成阻塞（Head-of-Line Blocking）。</p>\n<p class=\"js_darkmode__374\"><strong class=\"js_darkmode__375\">增强型 ATT (EATT):</strong>&nbsp;它运行在 L2CAP 的增强型基于信用的流量控制 (Enhanced Credit Based Flow Control) 模式之上。</p>\n<p class=\"js_darkmode__376\">它的特点是：</p>\n<ul class=\"list-paddingleft-1 js_darkmode__377\">\n<li><strong class=\"js_darkmode__379\">支持并发 (Concurrent):</strong>&nbsp;允许同时执行多个 ATT 事务。</li>\n<li><strong class=\"js_darkmode__381\">低延迟：</strong>&nbsp;优先级高的命令不会被前面正在处理的大数据包阻塞。</li>\n<li><strong class=\"js_darkmode__383\">MTU:</strong>&nbsp;EATT 的 MTU 是独立配置的，通常更灵活。</li>\n</ul>\n<p class=\"js_darkmode__384\">在 V5.3 设备中，如果双方都支持 EATT，设备将优先建立 EATT 信道以提升用户体验（如音频流传输时的同时控制操作）。</p>\n<h3 class=\"js_darkmode__385\"><span class=\"js_darkmode__386\">（5）ATT MTU (最大传输单元)</span></h3>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161848815-585472060.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<p class=\"js_darkmode__388\">ATT_MTU 决定了在一个数据包中最多能传多少字节的有效载荷。默认值为 23 字节 (BLE 4.0)。</p>\n<p class=\"js_darkmode__389\"><strong class=\"js_darkmode__390\">典型值：</strong>&nbsp;为247 字节 (常见的 DLE 扩展后数值) 或 512 字节 (最大)。</p>\n<p class=\"js_darkmode__391\">ATT连接建立后，客户端通常会发起&nbsp;<code class=\"js_darkmode__392\">Exchange MTU Request</code>，双方协商使用两者支持的较小值。</p>\n<h2 class=\"js_darkmode__393\"><span class=\"js_darkmode__394\">（五）GATT (Generic Attribute Profile)</span></h2>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161900151-965016108.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<p class=\"js_darkmode__396\">如果 ATT 是负责运输数据的<strong class=\"js_darkmode__397\">卡车</strong>，那么&nbsp;<strong class=\"js_darkmode__398\">GATT</strong>&nbsp;(Generic Attribute Profile) 就是定义货物如何打包、存放、分类以及如何进行存取操作的<strong class=\"js_darkmode__399\">仓库管理规范</strong>。</p>\n<h3 class=\"js_darkmode__400\"><span class=\"js_darkmode__401\">（1）GATT 核心概念与角色 (Roles)</span></h3>\n<p class=\"js_darkmode__402\">GATT 定义了两个在数据交换中完全不同的角色。请注意，这与链路层的主机 (Central/Master) 和从机 (Peripheral/Slave) 概念是独立的，尽管通常存在某种映射关系。</p>\n<p class=\"js_darkmode__403\"><strong class=\"js_darkmode__404\">GATT Server (服务端):</strong>&nbsp;拥有数据并接受数据访问请求的设备。它的职责是存储数据（Services 和 Characteristics），响应 Client 的读/写请求，或主动向 Client 推送数据。比如智能手环(存有心率数据)</p>\n<p class=\"js_darkmode__405\"><strong class=\"js_darkmode__406\">GATT Client (客户端):</strong>&nbsp;发起命令和请求，试图读取或写入数据的设备。它的职责是执行服务发现 (Service Discovery)，发起读写操作，接收 Server 推送的数据。比如智能手机（想要读取手环的心率）。</p>\n<h3 class=\"js_darkmode__407\"><span class=\"js_darkmode__408\">（2）GATT 数据层级结构 (Hierarchy)</span></h3>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161916556-43068230.png\" />\n<p class=\"js_darkmode__410\">GATT 最重要的贡献是定义了严格的数据层级结构，使得不同厂商的设备可以互相理解。</p>\n<p class=\"js_darkmode__411\"><strong class=\"js_darkmode__412\">（A）Profile (配置文件)</strong>&nbsp;Profile 实际上不是 GATT 协议本身定义的实体，而是由 Bluetooth SIG 或厂商定义的<strong class=\"js_darkmode__413\">集合</strong>。一个 Profile 可能包含一个或多个 Service。</p>\n<p class=\"js_darkmode__414\"><strong class=\"js_darkmode__415\">（B）Service (服务)</strong>&nbsp;:Service 是数据和相关行为的逻辑集合，用于实现特定的功能或特性。这里分三种服务：</p>\n<p class=\"js_darkmode__416\"><strong class=\"js_darkmode__417\">Primary Service (首要服务):</strong>&nbsp;暴露设备主要功能的服务。</p>\n<p class=\"js_darkmode__418\"><strong class=\"js_darkmode__419\">Secondary Service (次要服务):</strong>&nbsp;仅作为被引用的辅助服务（较少见）。</p>\n<p class=\"js_darkmode__420\"><strong class=\"js_darkmode__421\">Include Service (引用服务):</strong>&nbsp;一个服务可以引用另一个服务（类似于编程中的&nbsp;<code class=\"js_darkmode__422\"><a class=\"wx_topic_link\">#include</a></code>），例如<strong class=\"js_darkmode__423\">跑步服务</strong>可能引用<strong class=\"js_darkmode__424\">心率服务</strong>。</p>\n<p class=\"js_darkmode__425\"><strong class=\"js_darkmode__426\">（C）Characteristic (特征)</strong>&nbsp;:Characteristic 是 GATT 中最小的逻辑数据单元，包含实际的数据值。它由三个主要部分组成：</p>\n<p class=\"js_darkmode__427\"><strong class=\"js_darkmode__428\">Declaration (声明):</strong>&nbsp;包含属性（读、写、通知等）、Handle（句柄）和 UUID。</p>\n<p class=\"js_darkmode__429\"><strong class=\"js_darkmode__430\">Value (值):</strong>&nbsp;实际的数据（例如：心率值&nbsp;<code class=\"js_darkmode__431\">0x48</code>）。</p>\n<p class=\"js_darkmode__432\"><strong class=\"js_darkmode__433\">Descriptor (描述符):</strong>&nbsp;（可选）关于特征的额外信息。</p>\n<p class=\"js_darkmode__434\"><strong class=\"js_darkmode__435\">（D）Descriptor (描述符)</strong>&nbsp;:对 Characteristic 的进一步描述或配置。</p>\n<p class=\"js_darkmode__436\">最著名的 Descriptor 是&nbsp;<strong class=\"js_darkmode__437\">CCCD (Client Characteristic Configuration Descriptor)<strong class=\"js_darkmode__438\">。Client 必须写入这个描述符来</strong>开启</strong>&nbsp;Server 的通知 (Notify) 或指示 (Indicate) 功能。</p>\n<h3 class=\"js_darkmode__439\"><span class=\"js_darkmode__440\">（3）GATT 核心操作流程 (GATT Procedures)</span></h3>\n<p class=\"js_darkmode__441\"><strong class=\"js_darkmode__442\">（A）配置与发现 (Discovery)</strong></p>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116161949206-724330768.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<p class=\"js_darkmode__444\">Client 连接 Server 后，通常不知道 Server 有什么功能，需要进行发现：</p>\n<ul class=\"list-paddingleft-1 js_darkmode__445\">\n<li>\n<p class=\"js_darkmode__447\"><strong class=\"js_darkmode__448\">Discover Primary Services:</strong>&nbsp;找出设备支持的所有主要服务。</p>\n</li>\n<li>\n<p class=\"js_darkmode__450\"><strong class=\"js_darkmode__451\">Discover Characteristics:</strong>&nbsp;找出某个服务下有哪些特征。</p>\n</li>\n<li>\n<p class=\"js_darkmode__453\"><strong class=\"js_darkmode__454\">Discover Descriptors:</strong>&nbsp;找出特征下有哪些描述符。</p>\n</li>\n<li>\n<p class=\"js_darkmode__456\"><strong class=\"js_darkmode__457\">Exchange MTU:</strong>&nbsp;协商最大传输单元，以决定一次能传多少字节（蓝牙 4.2/5.0+ 之后非常重要，以提高吞吐量）。</p>\n</li>\n</ul>\n<p class=\"js_darkmode__458\"><strong class=\"js_darkmode__459\">（B）数据读取 (Client -&gt; Server)</strong></p>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116162000883-391759881.png\" />\n<ul class=\"list-paddingleft-1 js_darkmode__461\">\n<li><strong class=\"js_darkmode__463\">Read Characteristic Value:</strong>&nbsp;读取某个句柄的值。</li>\n<li><strong class=\"js_darkmode__465\">Read Blob:</strong>&nbsp;读取长数据的片段（当数据超过 MTU 时）。</li>\n<li><strong class=\"js_darkmode__467\">Read Multiple:</strong>&nbsp;一次性读取多个句柄的值。</li>\n</ul>\n<p class=\"js_darkmode__468\"><strong class=\"js_darkmode__469\">（C）数据写入 (Client -&gt; Server)</strong></p>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116162012058-1758124561.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<ul class=\"list-paddingleft-1 js_darkmode__471\">\n<li><strong class=\"js_darkmode__473\">Write Request:</strong>&nbsp;Client 写入数据，Server&nbsp;<strong class=\"js_darkmode__474\">必须回复</strong>&nbsp;(Ack)。可靠，但慢。</li>\n<li><strong class=\"js_darkmode__476\">Write Command (Write without Response):</strong>&nbsp;Client 写入数据，Server&nbsp;<strong class=\"js_darkmode__477\">不回复</strong>。速度快，用于高吞吐量场景（如 OTA 升级）。</li>\n<li><strong class=\"js_darkmode__479\">Signed Write:</strong>&nbsp;带有签名的写入，用于未加密连接但需要认证的场景。</li>\n</ul>\n<p class=\"js_darkmode__480\"><strong class=\"js_darkmode__481\">（D）服务器发起的数据推送 (Server -&gt; Client)</strong></p>\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/555985/202601/555985-20260116162012058-1758124561.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" />\n<p class=\"js_darkmode__483\">这是 BLE 低功耗的关键，Client 不需要一直轮询 (Polling)，而是订阅后等待 Server 推送。</p>\n<ul class=\"list-paddingleft-1 js_darkmode__484\">\n<li><strong class=\"js_darkmode__486\">Notification (通知):</strong>&nbsp;Server 发送数据给 Client，Client&nbsp;<strong class=\"js_darkmode__487\">不回复</strong>。速度快，但如果丢包不会重传。</li>\n<li><strong class=\"js_darkmode__489\">Indication (指示):</strong>&nbsp;Server 发送数据给 Client，Client&nbsp;<strong class=\"js_darkmode__490\">必须回复</strong>&nbsp;Confirmation。可靠，但在收到回复前 Server 不能发下一条，速度较慢。</li>\n</ul>\n<p class=\"js_darkmode__491\">注意： 要启用 Notification 或 Indication，Client 必须先在对应的 CCCD (描述符) 中写入特定的值。</p>\n<h2 class=\"js_darkmode__492\"><span class=\"js_darkmode__493\">结尾</span></h2>\n<p class=\"js_darkmode__494\">随着低功耗蓝牙的普及，Host 层的改进越来越趋向于<strong class=\"js_darkmode__495\">高效率</strong>和<strong class=\"js_darkmode__496\">低延迟</strong>。理解 GAP 的连接管理、ATT 的原子操作以及 GATT 的层级解构，是开发高性能蓝牙产品的基本。</p>\n<p class=\"js_darkmode__497\">希望这篇文章能有助于你更好地理解蓝牙协议栈及其工作原理。</p>\n<center>------------------End------------------</center><center>如需获取更多内容</center><center>请关注<span style=\"color: rgba(0, 0, 255, 1); font-size: large;\">&nbsp;liwen01&nbsp;</span>公众号</center>\n<div>\n<div class=\"appmsg_card_context wx_profile_card wx-root wx_tap_card wx_card_root common-webchat\">\n<div class=\"wx_profile_card_inner\">\n<div class=\"wx_profile_card_bd\">\n<div class=\"wx_profile weui-flex\">\n<div class=\"wx_profile_bd weui-flex weui-flex__item\">\n<div class=\"weui-flex__item\">\n<div class=\"wx_profile_nickname_wrp\">&nbsp;</div>\n<div class=\"wx_profile_tips\" id=\"js_a11y_wx_profile_tips\">&nbsp;</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-20 08:42</span>&nbsp;\n<a href=\"https://www.cnblogs.com/liwen01\">liwen01</a>&nbsp;\n阅读(<span id=\"post_view_count\">25</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "字符串分割并展开成表格的SQL实现方法",
      "link": "https://www.cnblogs.com/davablog/p/19497701",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/davablog/p/19497701\" id=\"cb_post_title_url\" title=\"发布于 2026-01-20 08:08\">\n    <span>字符串分割并展开成表格的SQL实现方法</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<h1>一、场景案例</h1>\n<div>在数据开发类项目中，常常会遇到需要将字符串进行切割并展开成表格的场景，如以下两种常见的案例：</div>\n<ol>\n<li>标签类型数据：如将员工标签类型的数据\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: rgba(128, 128, 128, 1);\">-</span><span style=\"color: rgba(0, 0, 0, 1);\"> 技能：Java、Spring、微服务、项目管理\n</span><span style=\"color: rgba(128, 128, 128, 1);\">-</span><span style=\"color: rgba(0, 0, 0, 1);\"> 项目经验：电商、金融、教育<br /></span><span style=\"color: rgba(128, 128, 128, 1);\">-</span> 工作风格：#执行力强 #跨部门协作 #数据驱动</pre>\n</div>\n</li>\n<li>分类层级数据：如将组织部门层级数据：“/集团/分公司/信息技术部/数据团队”</li>\n</ol>\n<p>除此之外，在一些特定的业务场景中，如证券场景中，需要将一笔回购合约涉及到的多个质押券进行拆分（提取每个质押券有质押数量及对应标准券转换比例），数据示例如下：</p>\n<p><img alt=\"image\" class=\"lazyload\" /></p>\n<p>&nbsp;另外，API请求的返回的数据多为半结构化的字典列表数据，需要将每行数据从列表中进行提取出来再进行后续的处理，如以下数据：</p>\n<div class=\"cnblogs_code\">\n<pre>{\"data\"<span style=\"color: rgba(0, 0, 0, 1);\">: [<br />　　 {</span>\"AMOUNT\":-9000,\"SUB_TYPE_NAME\":\"债券分销\",\"BRANCH_NAME\":\"银行间\",\"TYPE_NAME\":\"收入\",\"BUSI_DATE\":\"20250831\",\"PROJECT_NAME\":\"调整1月分销佣金-24****MTN001\"<span style=\"color: rgba(0, 0, 0, 1);\">},\n    {</span>\"AMOUNT\":-1075.61,\"SUB_TYPE_NAME\":\"债券分销\",\"BRANCH_NAME\":\"银行间\",\"TYPE_NAME\":\"收入\",\"BUSI_DATE\":\"20250531\",\"PROJECT_NAME\":\"调整计提1月及3月分销佣金\"<span style=\"color: rgba(0, 0, 0, 1);\">}\n    ],\n</span>\"success\":<span style=\"color: rgba(0, 0, 255, 1);\">true</span><span style=\"color: rgba(0, 0, 0, 1);\">\n}</span></pre>\n</div>\n<h1>二，各类主流SQL方言实现方法</h1>\n<p>针对这类场景，目前没有标准SQL函数支持实现该功能。各类SQL方言通过自定义方法进行支持，以下是常用的实现方法。</p>\n<div id=\"tvoo-1768690884647\">\n<h2>Spark/Hive SQL</h2>\n</div>\n<div>采用split + explode（及升级版posexplode）。以下为测试案例：</div>\n<div><img alt=\"0\" class=\"lazyload\" /></div>\n<div>&nbsp;利用该方法可以轻松的回购质押券进行拆分处理：</div>\n<div>\n<p><img alt=\"image\" class=\"lazyload\" height=\"265\" width=\"905\" /></p>\n</div>\n<h2 id=\"hxy0-1768690884655\">PostgreSQL</h2>\n<div>有两种方法：</div>\n<div>方法一：首先利用string_to_array将字符串切割成数组，然后利用unnest将数组扩展成表</div>\n<div><img alt=\"image\" class=\"lazyload\" height=\"140\" width=\"455\" /></div>\n<div>方法二：直接利用regexp_split_to_table将字符串切割并转换成表</div>\n<div><img alt=\"image\" class=\"lazyload\" height=\"151\" width=\"457\" /></div>\n<div>\n<div class=\"cnblogs_code\"><img class=\"code_img_closed lazyload\" id=\"code_img_closed_384da3ac-fe03-4ded-b878-03d509f19394\" /><img class=\"code_img_opened lazyload\" id=\"code_img_opened_384da3ac-fe03-4ded-b878-03d509f19394\" style=\"display: none;\" />\n<div class=\"cnblogs_code_hide\" id=\"cnblogs_code_open_384da3ac-fe03-4ded-b878-03d509f19394\">\n<pre><span style=\"color: rgba(0, 0, 255, 1);\">select</span> string_to_array(<span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">apple,banana,orange</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">,</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>) <span style=\"color: rgba(0, 0, 255, 1);\">as</span><span style=\"color: rgba(0, 0, 0, 1);\"> item;\n</span><span style=\"color: rgba(0, 0, 255, 1);\">select</span> string_to_array(<span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">apple|banana|orange</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">|</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>) <span style=\"color: rgba(0, 0, 255, 1);\">as</span><span style=\"color: rgba(0, 0, 0, 1);\"> item;\n</span><span style=\"color: rgba(0, 0, 255, 1);\">select</span> unnest(string_to_array(<span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">apple,banana,orange</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">,</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>)) <span style=\"color: rgba(0, 0, 255, 1);\">as</span><span style=\"color: rgba(0, 0, 0, 1);\"> item;\n\n</span><span style=\"color: rgba(0, 0, 255, 1);\">select</span> regexp_split_to_array(<span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">apple|banana|orange</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">\\|</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>) <span style=\"color: rgba(0, 0, 255, 1);\">as</span><span style=\"color: rgba(0, 0, 0, 1);\"> item;\n</span><span style=\"color: rgba(0, 0, 255, 1);\">select</span> regexp_split_to_table(<span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">apple|banana|orange</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">\\|</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>) <span style=\"color: rgba(0, 0, 255, 1);\">as</span> item;</pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\n</div>\n<h2 id=\"AoqL-1768690884660\">Oracle</h2>\n<div>利用connect by + Level来实现</div>\n<div>\n<p><img alt=\"0\" class=\"lazyload\" /></p>\n<div class=\"cnblogs_code\"><img class=\"code_img_closed lazyload\" id=\"code_img_closed_0763077f-3809-4cd8-a83d-7e204a54ea87\" /><img class=\"code_img_opened lazyload\" id=\"code_img_opened_0763077f-3809-4cd8-a83d-7e204a54ea87\" style=\"display: none;\" />\n<div class=\"cnblogs_code_hide\" id=\"cnblogs_code_open_0763077f-3809-4cd8-a83d-7e204a54ea87\">\n<pre><span style=\"color: rgba(0, 0, 255, 1);\">WITH</span> CTE_DATA <span style=\"color: rgba(0, 0, 255, 1);\">AS</span><span style=\"color: rgba(0, 0, 0, 1);\"> (\n    </span><span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">tom</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span> <span style=\"color: rgba(0, 0, 255, 1);\">AS</span> NAME, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">apple,banana,cherry</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span> <span style=\"color: rgba(0, 0, 255, 1);\">AS</span> FRUIT <span style=\"color: rgba(0, 0, 255, 1);\">FROM</span><span style=\"color: rgba(0, 0, 0, 1);\"> DUAL\n)\n</span><span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> NAME, REGEXP_SUBSTR(FRUIT, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">[^,]+</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span>, <span style=\"color: rgba(0, 0, 255, 1);\">LEVEL</span>) <span style=\"color: rgba(0, 0, 255, 1);\">AS</span><span style=\"color: rgba(0, 0, 0, 1);\"> FRUIT\n</span><span style=\"color: rgba(0, 0, 255, 1);\">FROM</span><span style=\"color: rgba(0, 0, 0, 1);\"> CTE_DATA\nCONNECT </span><span style=\"color: rgba(0, 0, 255, 1);\">BY</span> REGEXP_SUBSTR(FRUIT, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">[^,]+</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span>, <span style=\"color: rgba(0, 0, 255, 1);\">LEVEL</span>) <span style=\"color: rgba(0, 0, 255, 1);\">IS</span> <span style=\"color: rgba(128, 128, 128, 1);\">NOT</span> <span style=\"color: rgba(0, 0, 255, 1);\">NULL</span><span style=\"color: rgba(0, 0, 0, 1);\">\n;</span></pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\n</div>\n<h2 id=\"7fPr-1768690884678\">MySQL</h2>\n<div>5.x+版本只能使用数字辅助表+SUBSTRING_INDEX。</div>\n<div>\n<p><img alt=\"image\" class=\"lazyload\" height=\"360\" width=\"926\" /></p>\n</div>\n<div>\n<div class=\"cnblogs_code\"><img class=\"code_img_closed lazyload\" id=\"code_img_closed_2f00195d-6b1a-4823-9aaf-ce74dfcdb1ee\" /><img class=\"code_img_opened lazyload\" id=\"code_img_opened_2f00195d-6b1a-4823-9aaf-ce74dfcdb1ee\" style=\"display: none;\" />\n<div class=\"cnblogs_code_hide\" id=\"cnblogs_code_open_2f00195d-6b1a-4823-9aaf-ce74dfcdb1ee\">\n<pre><span style=\"color: rgba(0, 0, 255, 1);\">CREATE</span> <span style=\"color: rgba(0, 0, 255, 1);\">TABLE</span> <span style=\"color: rgba(0, 0, 255, 1);\">IF</span> <span style=\"color: rgba(128, 128, 128, 1);\">NOT</span> <span style=\"color: rgba(128, 128, 128, 1);\">EXISTS</span> numbers (n <span style=\"color: rgba(0, 0, 255, 1);\">INT</span> <span style=\"color: rgba(0, 0, 255, 1);\">PRIMARY</span> <span style=\"color: rgba(0, 0, 255, 1);\">KEY</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n</span><span style=\"color: rgba(0, 0, 255, 1);\">INSERT</span> <span style=\"color: rgba(0, 0, 255, 1);\">INTO</span><span style=\"color: rgba(0, 0, 0, 1);\"> numbers\n</span><span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> a.N <span style=\"color: rgba(128, 128, 128, 1);\">+</span> b.N <span style=\"color: rgba(128, 128, 128, 1);\">*</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">10</span> <span style=\"color: rgba(128, 128, 128, 1);\">+</span> c.N <span style=\"color: rgba(128, 128, 128, 1);\">*</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">100</span> <span style=\"color: rgba(128, 128, 128, 1);\">+</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span> <span style=\"color: rgba(0, 0, 255, 1);\">AS</span><span style=\"color: rgba(0, 0, 0, 1);\"> n\n</span><span style=\"color: rgba(0, 0, 255, 1);\">FROM</span> (<span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">0</span> <span style=\"color: rgba(0, 0, 255, 1);\">AS</span> N <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">2</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">3</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">4</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">5</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">6</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">7</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">8</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">9</span><span style=\"color: rgba(0, 0, 0, 1);\">) a\n</span><span style=\"color: rgba(0, 0, 255, 1);\">CROSS</span> <span style=\"color: rgba(128, 128, 128, 1);\">JOIN</span> (<span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">0</span> <span style=\"color: rgba(0, 0, 255, 1);\">AS</span> N <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">2</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">3</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">4</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">5</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">6</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">7</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">8</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">9</span><span style=\"color: rgba(0, 0, 0, 1);\">) b\n</span><span style=\"color: rgba(0, 0, 255, 1);\">CROSS</span> <span style=\"color: rgba(128, 128, 128, 1);\">JOIN</span> (<span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">0</span> <span style=\"color: rgba(0, 0, 255, 1);\">AS</span> N <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">2</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">3</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">4</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">5</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">6</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">7</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">8</span> <span style=\"color: rgba(0, 0, 255, 1);\">UNION</span> <span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">9</span><span style=\"color: rgba(0, 0, 0, 1);\">) c;\n</span><span style=\"color: rgba(0, 128, 128, 1);\">--</span><span style=\"color: rgba(0, 128, 128, 1);\"> 使用数字表分割</span>\n<span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span><span style=\"color: rgba(0, 0, 0, 1);\">\nSUBSTRING_INDEX(\nSUBSTRING_INDEX(</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">a,b,c,d</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">,</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(0, 0, 0, 1);\">, numbers.n),\n</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">,</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(0, 0, 0, 1);\">,\n</span><span style=\"color: rgba(128, 128, 128, 1);\">-</span><span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span><span style=\"color: rgba(0, 0, 0, 1);\">\n) </span><span style=\"color: rgba(0, 0, 255, 1);\">AS</span><span style=\"color: rgba(0, 0, 0, 1);\"> part\n</span><span style=\"color: rgba(0, 0, 255, 1);\">FROM</span><span style=\"color: rgba(0, 0, 0, 1);\"> numbers\n</span><span style=\"color: rgba(0, 0, 255, 1);\">WHERE</span> numbers.n <span style=\"color: rgba(128, 128, 128, 1);\">&lt;=</span> LENGTH(<span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">a,b,c,d</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>) <span style=\"color: rgba(128, 128, 128, 1);\">-</span> LENGTH(<span style=\"color: rgba(255, 0, 255, 1);\">REPLACE</span>(<span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">a,b,c,d</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">,</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(255, 0, 0, 1);\">''</span>)) <span style=\"color: rgba(128, 128, 128, 1);\">+</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span>;</pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\n<p>8.0+版本可使用json_table</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span><span style=\"color: rgba(0, 0, 0, 1);\"> \n    o.order_id,\n    j.product_id\n</span><span style=\"color: rgba(0, 0, 255, 1);\">FROM</span><span style=\"color: rgba(0, 0, 0, 1);\"> orders o\n</span><span style=\"color: rgba(128, 128, 128, 1);\">JOIN</span><span style=\"color: rgba(0, 0, 0, 1);\"> JSON_TABLE(\n    CONCAT(</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">[\"</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(255, 0, 255, 1);\">REPLACE</span>(o.product_ids, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">,</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">\",\"</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>), <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">\"]</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(0, 0, 0, 1);\">),\n    </span><span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">$[*]</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span> COLUMNS (product_id <span style=\"color: rgba(0, 0, 255, 1);\">INT</span> PATH <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">$</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n) </span><span style=\"color: rgba(0, 0, 255, 1);\">AS</span> j;</pre>\n</div>\n<h2 id=\"AoqL-1768690884660\">SQL Server</h2>\n</div>\n<div>早期版本无内置函数，只能通过自定义表值函数（TVF）或者XML方法</div>\n<div>\n<div class=\"cnblogs_code\"><img class=\"code_img_closed lazyload\" id=\"code_img_closed_f7b1138f-107e-4278-9ae3-23f7365d8755\" /><img class=\"code_img_opened lazyload\" id=\"code_img_opened_f7b1138f-107e-4278-9ae3-23f7365d8755\" style=\"display: none;\" />\n<div class=\"cnblogs_code_hide\" id=\"cnblogs_code_open_f7b1138f-107e-4278-9ae3-23f7365d8755\">\n<pre><span style=\"color: rgba(0, 0, 255, 1);\">CREATE</span> <span style=\"color: rgba(0, 0, 255, 1);\">FUNCTION</span><span style=\"color: rgba(0, 0, 0, 1);\"> dbo.SplitString\n(\n    </span><span style=\"color: rgba(0, 128, 0, 1);\">@String</span> <span style=\"color: rgba(0, 0, 255, 1);\">NVARCHAR</span>(<span style=\"color: rgba(255, 0, 255, 1);\">MAX</span><span style=\"color: rgba(0, 0, 0, 1);\">),\n    </span><span style=\"color: rgba(0, 128, 0, 1);\">@Delimiter</span> <span style=\"color: rgba(0, 0, 255, 1);\">CHAR</span>(<span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n)\n</span><span style=\"color: rgba(0, 0, 255, 1);\">RETURNS</span> <span style=\"color: rgba(0, 128, 0, 1);\">@Results</span> <span style=\"color: rgba(0, 0, 255, 1);\">TABLE</span><span style=\"color: rgba(0, 0, 0, 1);\"> \n(\n    ID </span><span style=\"color: rgba(0, 0, 255, 1);\">INT</span> <span style=\"color: rgba(255, 0, 255, 1);\">IDENTITY</span>(<span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span>,<span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span><span style=\"color: rgba(0, 0, 0, 1);\">),\n    Value </span><span style=\"color: rgba(0, 0, 255, 1);\">NVARCHAR</span>(<span style=\"color: rgba(255, 0, 255, 1);\">MAX</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n)\n</span><span style=\"color: rgba(0, 0, 255, 1);\">AS</span>\n<span style=\"color: rgba(0, 0, 255, 1);\">BEGIN</span>\n    <span style=\"color: rgba(0, 0, 255, 1);\">DECLARE</span> <span style=\"color: rgba(0, 128, 0, 1);\">@pos</span> <span style=\"color: rgba(0, 0, 255, 1);\">INT</span> <span style=\"color: rgba(128, 128, 128, 1);\">=</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">0</span>\n    <span style=\"color: rgba(0, 0, 255, 1);\">DECLARE</span> <span style=\"color: rgba(0, 128, 0, 1);\">@slice</span> <span style=\"color: rgba(0, 0, 255, 1);\">NVARCHAR</span>(<span style=\"color: rgba(255, 0, 255, 1);\">MAX</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n\n    </span><span style=\"color: rgba(0, 0, 255, 1);\">IF</span> <span style=\"color: rgba(128, 128, 128, 1);\">RIGHT</span>(<span style=\"color: rgba(0, 128, 0, 1);\">@String</span>, <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span>) <span style=\"color: rgba(128, 128, 128, 1);\">!=</span> <span style=\"color: rgba(0, 128, 0, 1);\">@Delimiter</span>\n        <span style=\"color: rgba(0, 0, 255, 1);\">SET</span> <span style=\"color: rgba(0, 128, 0, 1);\">@String</span> <span style=\"color: rgba(128, 128, 128, 1);\">=</span> <span style=\"color: rgba(0, 128, 0, 1);\">@String</span> <span style=\"color: rgba(128, 128, 128, 1);\">+</span> <span style=\"color: rgba(0, 128, 0, 1);\">@Delimiter</span>\n\n    <span style=\"color: rgba(0, 0, 255, 1);\">WHILE</span> <span style=\"color: rgba(255, 0, 255, 1);\">CHARINDEX</span>(<span style=\"color: rgba(0, 128, 0, 1);\">@Delimiter</span>, <span style=\"color: rgba(0, 128, 0, 1);\">@String</span>) <span style=\"color: rgba(128, 128, 128, 1);\">&gt;</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">0</span>\n    <span style=\"color: rgba(0, 0, 255, 1);\">BEGIN</span>\n        <span style=\"color: rgba(0, 0, 255, 1);\">SET</span> <span style=\"color: rgba(0, 128, 0, 1);\">@pos</span> <span style=\"color: rgba(128, 128, 128, 1);\">=</span> <span style=\"color: rgba(255, 0, 255, 1);\">CHARINDEX</span>(<span style=\"color: rgba(0, 128, 0, 1);\">@Delimiter</span>, <span style=\"color: rgba(0, 128, 0, 1);\">@String</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n        </span><span style=\"color: rgba(0, 0, 255, 1);\">SET</span> <span style=\"color: rgba(0, 128, 0, 1);\">@slice</span> <span style=\"color: rgba(128, 128, 128, 1);\">=</span> <span style=\"color: rgba(128, 128, 128, 1);\">LEFT</span>(<span style=\"color: rgba(0, 128, 0, 1);\">@String</span>, <span style=\"color: rgba(0, 128, 0, 1);\">@pos</span> <span style=\"color: rgba(128, 128, 128, 1);\">-</span> <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n        \n        </span><span style=\"color: rgba(0, 0, 255, 1);\">INSERT</span> <span style=\"color: rgba(0, 0, 255, 1);\">INTO</span> <span style=\"color: rgba(0, 128, 0, 1);\">@Results</span> (Value) <span style=\"color: rgba(0, 0, 255, 1);\">VALUES</span> (<span style=\"color: rgba(0, 128, 0, 1);\">@slice</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n        </span><span style=\"color: rgba(0, 0, 255, 1);\">SET</span> <span style=\"color: rgba(0, 128, 0, 1);\">@String</span> <span style=\"color: rgba(128, 128, 128, 1);\">=</span> <span style=\"color: rgba(255, 0, 255, 1);\">STUFF</span>(<span style=\"color: rgba(0, 128, 0, 1);\">@String</span>, <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span>, <span style=\"color: rgba(0, 128, 0, 1);\">@pos</span>, <span style=\"color: rgba(255, 0, 0, 1);\">''</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n    </span><span style=\"color: rgba(0, 0, 255, 1);\">END</span>\n    \n    <span style=\"color: rgba(0, 0, 255, 1);\">RETURN</span>\n<span style=\"color: rgba(0, 0, 255, 1);\">END</span>\n\n<span style=\"color: rgba(0, 128, 128, 1);\">--</span><span style=\"color: rgba(0, 128, 128, 1);\"> 使用示例</span>\n<span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(128, 128, 128, 1);\">*</span> <span style=\"color: rgba(0, 0, 255, 1);\">FROM</span> dbo.SplitString(<span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">张三,李四,王五</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">,</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>)</pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\n<div class=\"cnblogs_code\"><img class=\"code_img_closed lazyload\" id=\"code_img_closed_3ed525c1-7f6f-49ac-9b5f-2bc138b81373\" /><img class=\"code_img_opened lazyload\" id=\"code_img_opened_3ed525c1-7f6f-49ac-9b5f-2bc138b81373\" style=\"display: none;\" />\n<div class=\"cnblogs_code_hide\" id=\"cnblogs_code_open_3ed525c1-7f6f-49ac-9b5f-2bc138b81373\">\n<pre><span style=\"color: rgba(0, 0, 255, 1);\">DECLARE</span> <span style=\"color: rgba(0, 128, 0, 1);\">@str</span> <span style=\"color: rgba(0, 0, 255, 1);\">NVARCHAR</span>(<span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">100</span>) <span style=\"color: rgba(128, 128, 128, 1);\">=</span> <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">苹果|香蕉|橙子</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(0, 0, 0, 1);\">;\n</span><span style=\"color: rgba(0, 0, 255, 1);\">DECLARE</span> <span style=\"color: rgba(0, 128, 0, 1);\">@separator</span> <span style=\"color: rgba(0, 0, 255, 1);\">CHAR</span>(<span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span>) <span style=\"color: rgba(128, 128, 128, 1);\">=</span> <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">|</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(0, 0, 0, 1);\">;\n\n</span><span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> \n    <span style=\"color: rgba(255, 0, 255, 1);\">LTRIM</span>(<span style=\"color: rgba(255, 0, 255, 1);\">RTRIM</span>(m.n.value(<span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">.[1]</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">NVARCHAR(100)</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>))) <span style=\"color: rgba(0, 0, 255, 1);\">AS</span><span style=\"color: rgba(0, 0, 0, 1);\"> SplitValue\n</span><span style=\"color: rgba(0, 0, 255, 1);\">FROM</span><span style=\"color: rgba(0, 0, 0, 1);\"> \n    (</span><span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span> <span style=\"color: rgba(255, 0, 255, 1);\">CAST</span>(<span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">&lt;x&gt;</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span> <span style=\"color: rgba(128, 128, 128, 1);\">+</span> <span style=\"color: rgba(255, 0, 255, 1);\">REPLACE</span>(<span style=\"color: rgba(0, 128, 0, 1);\">@str</span>, <span style=\"color: rgba(0, 128, 0, 1);\">@separator</span>, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">&lt;/x&gt;&lt;x&gt;</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>) <span style=\"color: rgba(128, 128, 128, 1);\">+</span> <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">&lt;/x&gt;</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span> <span style=\"color: rgba(0, 0, 255, 1);\">AS</span> XML)) <span style=\"color: rgba(0, 0, 255, 1);\">AS</span><span style=\"color: rgba(0, 0, 0, 1);\"> t(x)\n</span><span style=\"color: rgba(0, 0, 255, 1);\">CROSS</span><span style=\"color: rgba(0, 0, 0, 1);\"> APPLY \n    x.nodes(</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">/x</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>) <span style=\"color: rgba(0, 0, 255, 1);\">AS</span> m(n);</pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\n<p>2016之后的版本可使用原生方法STRING_SPLIT</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: rgba(0, 128, 128, 1);\">--</span><span style=\"color: rgba(0, 128, 128, 1);\">带序号的版本（SQL Server 2022+）</span>\n<span style=\"color: rgba(0, 0, 255, 1);\">SELECT</span><span style=\"color: rgba(0, 0, 0, 1);\"> value, ordinal\n</span><span style=\"color: rgba(0, 0, 255, 1);\">FROM</span> STRING_SPLIT(<span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">a,b,c</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(255, 0, 0, 1);\">'</span><span style=\"color: rgba(255, 0, 0, 1);\">,</span><span style=\"color: rgba(255, 0, 0, 1);\">'</span>, <span style=\"color: rgba(128, 0, 0, 1); font-weight: bold;\">1</span>) <span style=\"color: rgba(0, 128, 128, 1);\">--</span><span style=\"color: rgba(0, 128, 128, 1);\"> 第三个参数启用序号</span></pre>\n</div>\n</div>\n<h1>三、结论</h1>\n<div>　　Spark SQL、PostgreSQL最方便，思路也比较相似，都是先将字符串拆分数组，然后扩展成表。SQLServer新版本实现较为方法，直接一个函数搞定。Oracle利用其connect by来实现，也相对便捷，只是相对主流SQL方言比较小众一点。Mysql新版本相对方便一点，老版本需要辅助表增加维护成本。</div>\n<h1>四、参考链接</h1>\n<div><a href=\"https://www.kimi.com/share/19bd8855-80d2-8885-8000-00003449be16\" rel=\"noopener nofollow\" target=\"_blank\">https://www.kimi.com/share/19bd8855-80d2-8885-8000-00003449be16</a></div>\n<div><a href=\"https://www.kimi.com/share/19bd8885-e842-8472-8000-000042aa28d0\" rel=\"noopener nofollow\" target=\"_blank\">https://www.kimi.com/share/19bd8885-e842-8472-8000-000042aa28d0</a></div>\n<div><a href=\"https://chat.deepseek.com/share/h9bv2i75c90jcfz3uo\" rel=\"noopener nofollow\" target=\"_blank\">https://chat.deepseek.com/share/h9bv2i75c90jcfz3uo</a></div>\n<div><a href=\"http://blog.itpub.net/16436858/viewspace-624191/\" rel=\"noopener nofollow\">http://blog.itpub.net/16436858/viewspace-624191/</a></div>\n<div>&nbsp;</div>\n<div>&nbsp;</div>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-20 08:08</span>&nbsp;\n<a href=\"https://www.cnblogs.com/davablog\">大汪的数据之路</a>&nbsp;\n阅读(<span id=\"post_view_count\">0</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "unity性能优化-实际开发中需要注意的点",
      "link": "https://www.cnblogs.com/pipicfan/p/19503936",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/pipicfan/p/19503936\" id=\"cb_post_title_url\" title=\"发布于 2026-01-19 22:55\">\n    <span>unity性能优化-实际开发中需要注意的点</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<p><strong>unity性能优化-实际开发中需要注意的点</strong></p>\n<p><a id=\"heading_0\"></a><strong>性能优化建议</strong></p>\n<p>在进行下面优化之前，建议先使用 <strong>Unity Profiler</strong> 定位真实的瓶颈。</p>\n<p><strong>优化核心原则：</strong></p>\n<p><strong>能缓存的就缓存</strong>（变量、组件、材质）。</p>\n<p><strong>能不更新就不更新</strong>（降低 update 频率，使用事件驱动或Coroutine）。</p>\n<p><strong>避免在循环中分配内存</strong>（减少 new 关键字，使用对象池）。</p>\n<p><a id=\"heading_1\"></a><strong>1.复杂数学计算，比如mesh顶点数据的创建，大小和归一化属性都非常耗费 CPU（都涉及计算平方根）</strong></p>\n<p>可以使用对象池来空间换时间处理，涉及开根号的用平方比较</p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119225507554-1515541958.png\" /></p>\n<p><a id=\"heading_2\"></a><strong>2.shader的合批处理</strong></p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119230139424-582581237.png\" /></p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119230139503-1658596290.png\" /></p>\n<p><a id=\"heading_3\"></a><strong>3.一些List，Vector不要用集合，而是指定它的大小</strong></p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119230139380-946016432.png\" /></p>\n<p><a id=\"heading_4\"></a><strong>4.不要再update里面去大量调用Component（新手容易忽略重要）</strong></p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119225506870-1113031628.png\" /></p>\n<p><a id=\"heading_5\"></a><strong>5.优化字符串对比</strong></p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119230139483-820107562.png\" /></p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119230139441-648476313.png\" /></p>\n<p><a id=\"heading_6\"></a><strong>6.常量的字符串写成类的成员变量</strong></p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119225506734-1746349249.png\" /></p>\n<p><a id=\"heading_7\"></a><strong>7.裁剪引擎，去掉音频</strong></p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119225507500-1539839110.png\" /></p>\n<p><a id=\"heading_8\"></a><strong>8.裁剪引擎，去掉物理，注意此时包括包围盒都不能使用</strong></p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119230139347-1887459637.png\" /></p>\n<p><a id=\"heading_9\"></a><strong>9.固定帧率，减少帧率</strong></p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119230139518-121341222.png\" /></p>\n<p><a id=\"heading_10\"></a><strong>10.避免使用拆箱装箱</strong></p>\n<p>在C#中，装箱（Boxing）和拆箱（Unboxing）是指值类型与引用类型之间的转换。装箱是将值类型转换为对象类型（通常是将值类型包装在堆上），而拆箱则是从对象类型还原为值类型。</p>\n<p><a id=\"heading_11\"></a><strong>装箱（Boxing）开销</strong></p>\n<p><strong>内存分配</strong>：</p>\n<p>装箱过程中，会在堆上分配内存来存储值类型的数据。堆内存的分配通常比栈内存的分配慢，因为堆内存需要处理垃圾回收（Garbage Collection），而且堆内存分配涉及更多的管理操作。</p>\n<p><strong>数据复制</strong>：</p>\n<p>装箱需要将值类型的数据从栈上复制到新分配的堆对象中。这涉及到数据的复制操作，增加了额外的开销。</p>\n<p><strong>垃圾回收</strong>：</p>\n<p>装箱产生的堆对象最终会由垃圾回收器（GC）回收。垃圾回收是一个耗时的过程，会影响应用程序的性能。</p>\n<p><a id=\"heading_12\"></a><strong>拆箱（Unboxing）开销</strong></p>\n<p><strong>类型检查</strong>：</p>\n<p>拆箱过程中，需要进行类型检查，以确保对象确实是预期的值类型。这涉及到运行时的类型元数据访问和检查，增加了开销。</p>\n<p><strong>数据复制</strong>：</p>\n<p>拆箱需要将堆上的数据复制回栈上。这同样涉及数据的复制操作，带来了额外的性能开销。</p>\n<p><a id=\"heading_13\"></a><strong>避免装箱和拆箱的方法</strong></p>\n<p><strong>使用泛型</strong>：泛型可以减少装箱和拆箱的需要，因为泛型可以在编译时确定类型，而不需要在运行时进行类型转换，但是泛型带来另一个问题，即转换为il2cpp的时候，代码会膨胀，这个后面可以再说</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\"> 使用泛型避免装箱和拆箱</span>\nList&lt;intnumbers = <span style=\"color: rgba(0, 0, 255, 1);\">new</span> List&lt;<span style=\"color: rgba(0, 0, 255, 1);\">int</span><span style=\"color: rgba(0, 0, 0, 1);\">();\nnumbers.Add(</span><span style=\"color: rgba(128, 0, 128, 1);\">42</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n</span><span style=\"color: rgba(0, 0, 255, 1);\">int</span> number = numbers[<span style=\"color: rgba(128, 0, 128, 1);\">0</span>];</pre>\n</div>\n<p>&nbsp;</p>\n<br />\n<p><strong>避免频繁的值类型到引用类型的转换</strong>：在设计程序时，尽量减少值类型与引用类型之间的转换。如果可能，尽量使用值类型本身来进行计算和处理。</p>\n<p><strong>使用struct而不是类</strong>：在某些情况下，可以使用struct来代替类，因为struct是值类型，不需要装箱和拆箱。</p>\n<p><strong>避免接口调用</strong>：接口调用通常需要装箱，特别是在接口接受值类型参数时。尽量避免在接口方法中使用值类型参数</p>\n<p><a id=\"heading_14\"></a><strong>11.GameObject.Instantiate  和 SetParent</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: rgba(0, 128, 128, 1);\"> 1</span> <span style=\"color: rgba(0, 0, 255, 1);\">public</span> <span style=\"color: rgba(0, 0, 255, 1);\">class</span><span style=\"color: rgba(0, 0, 0, 1);\"> ESDRoadEdgePool\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 2</span> <span style=\"color: rgba(0, 0, 0, 1);\">{\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 3</span>     <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">public int amountToPool = 100; </span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\"> 池中对象的数量 </span>\n<span style=\"color: rgba(0, 128, 128, 1);\"> 4</span>     <span style=\"color: rgba(0, 0, 255, 1);\">public</span> <span style=\"color: rgba(0, 0, 255, 1);\">int</span> amountToPool = <span style=\"color: rgba(128, 0, 128, 1);\">25</span><span style=\"color: rgba(0, 0, 0, 1);\">;\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 5</span>     \n<span style=\"color: rgba(0, 128, 128, 1);\"> 6</span>     pooledObjects = <span style=\"color: rgba(0, 0, 255, 1);\">new</span> List&lt;GameObject&gt;<span style=\"color: rgba(0, 0, 0, 1);\">();\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 7</span> \n<span style=\"color: rgba(0, 128, 128, 1);\"> 8</span>     <span style=\"color: rgba(0, 0, 255, 1);\">for</span> (<span style=\"color: rgba(0, 0, 255, 1);\">int</span> i = <span style=\"color: rgba(128, 0, 128, 1);\">0</span>; i &lt; amountToPool; i++<span style=\"color: rgba(0, 0, 0, 1);\">)\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 9</span> <span style=\"color: rgba(0, 0, 0, 1);\">    {\n</span><span style=\"color: rgba(0, 128, 128, 1);\">10</span>         GameObject obj = Instantiate(objectToPool); <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\"> 实例化可以缩减</span>\n<span style=\"color: rgba(0, 128, 128, 1);\">11</span>         obj.SetActive(<span style=\"color: rgba(0, 0, 255, 1);\">false</span>);                       <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\"> 可以预先设置预制体的activeSelf</span>\n<span style=\"color: rgba(0, 128, 128, 1);\">12</span>         obj.transform.parent = <span style=\"color: rgba(0, 0, 255, 1);\">this</span>.transform;      <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\"> 可以合并到Instantiate中</span>\n<span style=\"color: rgba(0, 128, 128, 1);\">13</span> <span style=\"color: rgba(0, 0, 0, 1);\">        pooledObjects.Add(obj);\n</span><span style=\"color: rgba(0, 128, 128, 1);\">14</span>         \n<span style=\"color: rgba(0, 128, 128, 1);\">15</span>            \n<span style=\"color: rgba(0, 128, 128, 1);\">16</span>         GameObject obj =<span style=\"color: rgba(0, 0, 0, 1);\"> Instantiate(objectToPool, transform);\n</span><span style=\"color: rgba(0, 128, 128, 1);\">17</span> <span style=\"color: rgba(0, 0, 0, 1);\">        pooledObjects.Add(obj);\n</span><span style=\"color: rgba(0, 128, 128, 1);\">18</span> <span style=\"color: rgba(0, 0, 0, 1);\">    }\n</span><span style=\"color: rgba(0, 128, 128, 1);\">19</span> }</pre>\n</div>\n<p>&nbsp;</p>\n<p><a id=\"heading_15\"></a><strong>12.嵌套循环中new Vector3等</strong></p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:csharp;gutter:true;\">　</pre>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: rgba(0, 128, 128, 1);\"> 1</span> <span style=\"color: rgba(0, 0, 255, 1);\">for</span>(<span style=\"color: rgba(0, 0, 255, 1);\">int</span> i = <span style=\"color: rgba(128, 0, 128, 1);\">0</span>; i &lt; count; i++<span style=\"color: rgba(0, 0, 0, 1);\">)\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 2</span> <span style=\"color: rgba(0, 0, 0, 1);\">{\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 3</span> <span style=\"color: rgba(0, 0, 0, 1);\">    ...\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 4</span>     Vector2 p1l_uv = <span style=\"color: rgba(0, 0, 255, 1);\">new</span> Vector2(offest.x, uvStart /<span style=\"color: rgba(0, 0, 0, 1);\"> 10f);\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 5</span>     Vector2 p1r_uv = <span style=\"color: rgba(0, 0, 255, 1);\">new</span> Vector2(offest.y, uvStart /<span style=\"color: rgba(0, 0, 0, 1);\"> 10f);\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 6</span>     Vector2 p2l_uv = <span style=\"color: rgba(0, 0, 255, 1);\">new</span> Vector2(offest.x, (uvStart + distance) / <span style=\"color: rgba(128, 0, 128, 1);\">10</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 7</span>     Vector2 p2r_uv = <span style=\"color: rgba(0, 0, 255, 1);\">new</span> Vector2(offest.y, (uvStart + distance) / <span style=\"color: rgba(128, 0, 128, 1);\">10</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 8</span> <span style=\"color: rgba(0, 0, 0, 1);\">    ...\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 9</span> <span style=\"color: rgba(0, 0, 0, 1);\">}\n</span><span style=\"color: rgba(0, 128, 128, 1);\">10</span> \n<span style=\"color: rgba(0, 128, 128, 1);\">11</span> <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\"> 可以将对象创建挪到循环外进行复用</span>\n<span style=\"color: rgba(0, 128, 128, 1);\">12</span> \n<span style=\"color: rgba(0, 128, 128, 1);\">13</span> Vector2 p1l_uv = <span style=\"color: rgba(0, 0, 255, 1);\">new</span><span style=\"color: rgba(0, 0, 0, 1);\"> Vector2();\n</span><span style=\"color: rgba(0, 128, 128, 1);\">14</span> Vector2 p1r_uv = <span style=\"color: rgba(0, 0, 255, 1);\">new</span><span style=\"color: rgba(0, 0, 0, 1);\"> Vector2();\n</span><span style=\"color: rgba(0, 128, 128, 1);\">15</span> Vector2 p2l_uv = <span style=\"color: rgba(0, 0, 255, 1);\">new</span><span style=\"color: rgba(0, 0, 0, 1);\"> Vector2();\n</span><span style=\"color: rgba(0, 128, 128, 1);\">16</span> Vector2 p2r_uv = <span style=\"color: rgba(0, 0, 255, 1);\">new</span><span style=\"color: rgba(0, 0, 0, 1);\"> Vector2();\n</span><span style=\"color: rgba(0, 128, 128, 1);\">17</span> \n<span style=\"color: rgba(0, 128, 128, 1);\">18</span> <span style=\"color: rgba(0, 0, 255, 1);\">for</span>(<span style=\"color: rgba(0, 0, 255, 1);\">int</span> i = <span style=\"color: rgba(128, 0, 128, 1);\">0</span>; i &lt; count; i++<span style=\"color: rgba(0, 0, 0, 1);\">)\n</span><span style=\"color: rgba(0, 128, 128, 1);\">19</span> <span style=\"color: rgba(0, 0, 0, 1);\">{\n</span><span style=\"color: rgba(0, 128, 128, 1);\">20</span> <span style=\"color: rgba(0, 0, 0, 1);\">    ...\n</span><span style=\"color: rgba(0, 128, 128, 1);\">21</span>     <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\"> 同时可以使用Vector3.Set来一次性对向量的每个分量进行赋值</span>\n<span style=\"color: rgba(0, 128, 128, 1);\">22</span>     p1l_uv.Set(offest.x, uvStart /<span style=\"color: rgba(0, 0, 0, 1);\"> 10f);\n</span><span style=\"color: rgba(0, 128, 128, 1);\">23</span>     p1r_uv.Set(offest.y, uvStart /<span style=\"color: rgba(0, 0, 0, 1);\"> 10f);\n</span><span style=\"color: rgba(0, 128, 128, 1);\">24</span>     p2l_uv.Set(offest.x, (uvStart + distance) / <span style=\"color: rgba(128, 0, 128, 1);\">10</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n</span><span style=\"color: rgba(0, 128, 128, 1);\">25</span>     p2r_uv.Set(offest.y, (uvStart + distance) / <span style=\"color: rgba(128, 0, 128, 1);\">10</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n</span><span style=\"color: rgba(0, 128, 128, 1);\">26</span> <span style=\"color: rgba(0, 0, 0, 1);\">    ...\n</span><span style=\"color: rgba(0, 128, 128, 1);\">27</span> }</pre>\n</div>\n<p>&nbsp;</p>\n</div>\n<p><a id=\"heading_16\"></a><strong>13.每帧循环调用的计算逻辑，可以使用对象池替代</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: rgba(0, 128, 128, 1);\"> 1</span> <span style=\"color: rgba(0, 0, 255, 1);\">for</span> (<span style=\"color: rgba(0, 0, 255, 1);\">int</span> i = <span style=\"color: rgba(128, 0, 128, 1);\">0</span>; i &lt; len - <span style=\"color: rgba(128, 0, 128, 1);\">1</span>; i++<span style=\"color: rgba(0, 0, 0, 1);\">)\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 2</span> <span style=\"color: rgba(0, 0, 0, 1);\">{\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 3</span> <span style=\"color: rgba(0, 0, 0, 1);\">    ...\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 4</span>     SquareCell cell = <span style=\"color: rgba(0, 0, 255, 1);\">new</span><span style=\"color: rgba(0, 0, 0, 1);\"> SquareCell();\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 5</span> <span style=\"color: rgba(0, 0, 0, 1);\">    ...\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 6</span> <span style=\"color: rgba(0, 0, 0, 1);\"> }\n</span><span style=\"color: rgba(0, 128, 128, 1);\"> 7</span>  \n<span style=\"color: rgba(0, 128, 128, 1);\"> 8</span>  <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\"> 加入对象池</span>\n<span style=\"color: rgba(0, 128, 128, 1);\"> 9</span>  <span style=\"color: rgba(0, 0, 255, 1);\">public</span> <span style=\"color: rgba(0, 0, 255, 1);\">class</span><span style=\"color: rgba(0, 0, 0, 1);\"> SquareCellPool\n</span><span style=\"color: rgba(0, 128, 128, 1);\">10</span> <span style=\"color: rgba(0, 0, 0, 1);\"> {\n</span><span style=\"color: rgba(0, 128, 128, 1);\">11</span>     <span style=\"color: rgba(0, 0, 255, 1);\">public</span> <span style=\"color: rgba(0, 0, 255, 1);\">static</span><span style=\"color: rgba(0, 0, 0, 1);\"> SquareCell Allocate()\n</span><span style=\"color: rgba(0, 128, 128, 1);\">12</span> <span style=\"color: rgba(0, 0, 0, 1);\">    {\n</span><span style=\"color: rgba(0, 128, 128, 1);\">13</span>         <span style=\"color: rgba(0, 0, 255, 1);\">if</span> (pool.TryDequeue(<span style=\"color: rgba(0, 0, 255, 1);\">out</span> <span style=\"color: rgba(0, 0, 255, 1);\">var</span><span style=\"color: rgba(0, 0, 0, 1);\"> cell))\n</span><span style=\"color: rgba(0, 128, 128, 1);\">14</span> <span style=\"color: rgba(0, 0, 0, 1);\">        {\n</span><span style=\"color: rgba(0, 128, 128, 1);\">15</span>             totalCount--<span style=\"color: rgba(0, 0, 0, 1);\">;\n</span><span style=\"color: rgba(0, 128, 128, 1);\">16</span>             <span style=\"color: rgba(0, 0, 255, 1);\">return</span><span style=\"color: rgba(0, 0, 0, 1);\"> cell;\n</span><span style=\"color: rgba(0, 128, 128, 1);\">17</span> <span style=\"color: rgba(0, 0, 0, 1);\">        }\n</span><span style=\"color: rgba(0, 128, 128, 1);\">18</span>     \n<span style=\"color: rgba(0, 128, 128, 1);\">19</span>         <span style=\"color: rgba(0, 0, 255, 1);\">for</span> (<span style=\"color: rgba(0, 0, 255, 1);\">int</span> i = <span style=\"color: rgba(128, 0, 128, 1);\">0</span>; i &lt; poolInterval; i++<span style=\"color: rgba(0, 0, 0, 1);\">)\n</span><span style=\"color: rgba(0, 128, 128, 1);\">20</span> <span style=\"color: rgba(0, 0, 0, 1);\">        {\n</span><span style=\"color: rgba(0, 128, 128, 1);\">21</span>             SquareCell newCell = <span style=\"color: rgba(0, 0, 255, 1);\">new</span><span style=\"color: rgba(0, 0, 0, 1);\"> SquareCell();\n</span><span style=\"color: rgba(0, 128, 128, 1);\">22</span> <span style=\"color: rgba(0, 0, 0, 1);\">            pool.Enqueue(newCell);\n</span><span style=\"color: rgba(0, 128, 128, 1);\">23</span>             totalCount++<span style=\"color: rgba(0, 0, 0, 1);\">;\n</span><span style=\"color: rgba(0, 128, 128, 1);\">24</span> <span style=\"color: rgba(0, 0, 0, 1);\">        }\n</span><span style=\"color: rgba(0, 128, 128, 1);\">25</span>     \n<span style=\"color: rgba(0, 128, 128, 1);\">26</span>         <span style=\"color: rgba(0, 0, 255, 1);\">if</span> (totalCount &gt; <span style=\"color: rgba(128, 0, 128, 1);\">65535</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n</span><span style=\"color: rgba(0, 128, 128, 1);\">27</span> <span style=\"color: rgba(0, 0, 0, 1);\">        {\n</span><span style=\"color: rgba(0, 128, 128, 1);\">28</span>             Debug.LogError(<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">Pool Out of Count!</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span> +<span style=\"color: rgba(0, 0, 0, 1);\"> totalCount);\n</span><span style=\"color: rgba(0, 128, 128, 1);\">29</span>             <span style=\"color: rgba(0, 0, 255, 1);\">return</span> <span style=\"color: rgba(0, 0, 255, 1);\">null</span><span style=\"color: rgba(0, 0, 0, 1);\">;\n</span><span style=\"color: rgba(0, 128, 128, 1);\">30</span> <span style=\"color: rgba(0, 0, 0, 1);\">        }\n</span><span style=\"color: rgba(0, 128, 128, 1);\">31</span>         cell =<span style=\"color: rgba(0, 0, 0, 1);\"> pool.Dequeue();\n</span><span style=\"color: rgba(0, 128, 128, 1);\">32</span>         totalCount--<span style=\"color: rgba(0, 0, 0, 1);\">;\n</span><span style=\"color: rgba(0, 128, 128, 1);\">33</span>         <span style=\"color: rgba(0, 0, 255, 1);\">return</span><span style=\"color: rgba(0, 0, 0, 1);\"> cell;\n</span><span style=\"color: rgba(0, 128, 128, 1);\">34</span> <span style=\"color: rgba(0, 0, 0, 1);\">    }\n</span><span style=\"color: rgba(0, 128, 128, 1);\">35</span>  }</pre>\n</div>\n<p>&nbsp;</p>\n<br />\n<p><a id=\"heading_17\"></a><strong>14.Shader中处理逻辑能不使用高精度可以使用低精度的</strong></p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119225508259-375921676.png\" /></p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119225507827-2125826982.png\" /></p>\n<p><a id=\"heading_18\"></a><strong>15.避免 Camera.main</strong></p>\n<p>在 Unity 中，Camera.main 实际上是调用了 GameObject.FindWithTag(\"MainCamera\")，这是一个非常耗时的操作</p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119225502907-593523569.png\" /></p>\n<p>发现unity文档里面,这块其实也是做了缓存gameobject</p>\n<p><img src=\"https://img2024.cnblogs.com/blog/357310/202601/357310-20260119225506505-1590491376.jpg\" /></p>\n<p>但是缓存肯定还是最快的,因为gameobject也有开销</p>\n<p><strong>本文档会陆续补充更新，优化无止境</strong></p>\n</div>\n<div id=\"MySignature\">\n    我自豪 我是一名软件工程师。\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-19 22:55</span>&nbsp;\n<a href=\"https://www.cnblogs.com/pipicfan\">pipicfan</a>&nbsp;\n阅读(<span id=\"post_view_count\">52</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "DeploySharp 全面支持 YOLO26 系列，助力开发者快速部署落地应用",
      "link": "https://www.cnblogs.com/guojin-blogs/p/19503930",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/guojin-blogs/p/19503930\" id=\"cb_post_title_url\" title=\"发布于 2026-01-19 22:47\">\n    <span>DeploySharp 全面支持 YOLO26 系列，助力开发者快速部署落地应用</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        <img alt=\"DeploySharp 全面支持 YOLO26 系列，助力开发者快速部署落地应用\" class=\"desc_img\" src=\"https://img2024.cnblogs.com/blog/2933426/202601/2933426-20260119224728680-943487144.png\" />\n        DeploySharp是一个专为C#开发者设计的跨平台模型部署框架，全面支持YOLOv26系列模型，包括目标检测、实例分割、姿态估计和旋转框检测。该框架提供多引擎支持(OpenVINO/ONNX Runtime/TensorRT)、两种图像处理库选择(ImageSharp/OpenCvSharp)以及跨平台运行时兼容性。通过模块化架构和NuGet包生态，开发者可以快速部署YOLOv26模型，实现从模型加载到推理执行的端到端解决方案。项目开源且支持多种硬件设备，为计算机视觉应用落地提供高效工具。\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"deploysharp-全面支持-yolo26-系列助力开发者快速部署落地应用\">DeploySharp 全面支持 YOLO26 系列，助力开发者快速部署落地应用</h1>\n<h2 id=\"一deploysharp-简介\">一、DeploySharp 简介</h2>\n<p>DeploySharp 是一个专为 C# 开发者设计的跨平台模型部署框架，旨在提供从模型加载、配置管理到推理执行的端到端解决方案。该项目由 椒颜皮皮虾开发并开源，遵循 Apache 2.0 许可协议，目前在 GitHub 上获得了广泛关注。</p>\n<p>DeploySharp 采用了清晰的模块化架构设计：</p>\n<ul>\n<li><strong>根命名空间</strong>：<code>DeploySharp</code> 作为统一入口，集成模型加载、推理执行等核心功能</li>\n<li><strong>子命名空间</strong>：通过 <code>DeploySharp.Engine</code>、<code>DeploySharp.Data</code>、<code>DeploySharp.Model</code> 等子命名空间实现模块化分层</li>\n<li><strong>泛型设计</strong>：关键类采用泛型设计，支持图像处理、分类、检测等多任务标准数据交互</li>\n</ul>\n<p><strong>项目地址</strong>：</p>\n<pre><code>https://github.com/guojin-yan/DeploySharp.git\n</code></pre>\n<h3 id=\"1-多引擎支持\">1. 多引擎支持</h3>\n<p>DeploySharp 原生支持三种主流推理引擎：</p>\n<table>\n<thead>\n<tr>\n<th>推理引擎</th>\n<th>状态</th>\n<th>支持设备</th>\n<th>性能特点</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>OpenVINO</td>\n<td>完成</td>\n<td>CPU、GPU0(集显)、GPU1(独显)、NPU</td>\n<td>Intel 硬件优化</td>\n</tr>\n<tr>\n<td>ONNX Runtime</td>\n<td>完成</td>\n<td>CPU、GPU(CUDA/DML)</td>\n<td>跨平台兼容性好</td>\n</tr>\n<tr>\n<td>TensorRT</td>\n<td>完成</td>\n<td>GPU(TensorRT)</td>\n<td>NVIDIA GPU 极致性能</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"2-图像处理支持\">2. 图像处理支持</h3>\n<p>框架提供了两种图像处理库的选择：</p>\n<table>\n<thead>\n<tr>\n<th>图像处理库</th>\n<th>特点</th>\n<th>适用场景</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ImageSharp</td>\n<td>纯 C# 实现，跨平台兼容性好，无原生依赖</td>\n<td>跨平台应用、Web 应用</td>\n</tr>\n<tr>\n<td>OpenCvSharp</td>\n<td>OpenCV 的 C# 封装，功能强大，性能优异</td>\n<td>桌面应用、高性能场景</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"3-跨平台运行时支持\">3. 跨平台运行时支持</h3>\n<p>DeploySharp 兼容了广泛的 .NET 运行时环境：</p>\n<ul>\n<li>.NET Framework 4.8 / 4.8.1</li>\n<li>.NET Core 3.1</li>\n<li>.NET 5.0</li>\n<li>.NET 6.0</li>\n<li>.NET 7.0</li>\n<li>.NET 8.0</li>\n<li>.NET 9.0</li>\n<li>.NET 10.0</li>\n</ul>\n<h3 id=\"4-nuget-包生态\">4. NuGet 包生态</h3>\n<h4 id=\"41-核心包\">4.1 核心包</h4>\n<table>\n<thead>\n<tr>\n<th>包名</th>\n<th>描述</th>\n<th>NuGet 链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>JYPPX.DeploySharp</td>\n<td>DeploySharp API 核心库</td>\n<td><a href=\"https://www.nuget.org/packages/JYPPX.DeploySharp/\" rel=\"noopener nofollow\" target=\"_blank\"><img alt=\"NuGet\" class=\"lazyload\" /></a></td>\n</tr>\n</tbody>\n</table>\n<p><strong>核心包功能</strong>：</p>\n<ul>\n<li>推理引擎抽象接口</li>\n<li>数据结构定义</li>\n<li>模型配置基类</li>\n<li>性能分析工具</li>\n<li>日志系统</li>\n<li>可视化基础功能</li>\n</ul>\n<h4 id=\"42-图像处理扩展包\">4.2 图像处理扩展包</h4>\n<table>\n<thead>\n<tr>\n<th>包名</th>\n<th>描述</th>\n<th>NuGet 链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>JYPPX.DeploySharp.ImageSharp</td>\n<td>使用 ImageSharp 的图像处理扩展</td>\n<td><a href=\"https://www.nuget.org/packages/JYPPX.DeploySharp.ImageSharp/\" rel=\"noopener nofollow\" target=\"_blank\"><img alt=\"NuGet\" class=\"lazyload\" /></a></td>\n</tr>\n<tr>\n<td>JYPPX.DeploySharp.OpenCvSharp</td>\n<td>使用 OpenCvSharp 的图像处理扩展</td>\n<td><a href=\"https://www.nuget.org/packages/JYPPX.DeploySharp.OpenCvSharp/\" rel=\"noopener nofollow\" target=\"_blank\"><img alt=\"NuGet\" class=\"lazyload\" /></a></td>\n</tr>\n</tbody>\n</table>\n<p><strong>扩展包功能</strong>：</p>\n<ul>\n<li>图像加载和保存</li>\n<li>图像预处理实现</li>\n<li>可视化功能实现</li>\n<li>批量处理支持</li>\n</ul>\n<h3 id=\"5--模型支持列表\">5.  模型支持列表</h3>\n<p>截至目前，DeploySharp 已经完成了以下模型的封装，更多模型持续更新中：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align: center;\">Model Name</th>\n<th style=\"text-align: center;\">Model Type</th>\n<th style=\"text-align: center;\">OpenVINO</th>\n<th style=\"text-align: center;\">ONNX Runtime</th>\n<th style=\"text-align: center;\">TensorRT</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv5</strong></td>\n<td style=\"text-align: center;\">Detection</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv5</strong></td>\n<td style=\"text-align: center;\">Segmentation</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv6</strong></td>\n<td style=\"text-align: center;\">Detection</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv7</strong></td>\n<td style=\"text-align: center;\">Detection</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv8</strong></td>\n<td style=\"text-align: center;\">Detection</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv8</strong></td>\n<td style=\"text-align: center;\">Segmentation</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv8</strong></td>\n<td style=\"text-align: center;\">Pose</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv8</strong></td>\n<td style=\"text-align: center;\">Oriented Bounding Boxes</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv9</strong></td>\n<td style=\"text-align: center;\">Detection</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv9</strong></td>\n<td style=\"text-align: center;\">Segmentation</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv10</strong></td>\n<td style=\"text-align: center;\">Detection</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv11</strong></td>\n<td style=\"text-align: center;\">Detection</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv11</strong></td>\n<td style=\"text-align: center;\">Segmentation</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv11</strong></td>\n<td style=\"text-align: center;\">Pose</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv11</strong></td>\n<td style=\"text-align: center;\">Oriented Bounding Boxes</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLOv12</strong></td>\n<td style=\"text-align: center;\">Detection</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>Anomalib</strong></td>\n<td style=\"text-align: center;\">Segmentation</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>PP-YOLOE</strong></td>\n<td style=\"text-align: center;\">Detection</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>DEIMv2</strong></td>\n<td style=\"text-align: center;\">Detection</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>RFDETR</strong></td>\n<td style=\"text-align: center;\">Detection</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>RFDETR</strong></td>\n<td style=\"text-align: center;\">Segmentation</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>RTDETR</strong></td>\n<td style=\"text-align: center;\">Detection</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLO26</strong></td>\n<td style=\"text-align: center;\">Detection</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLO26</strong></td>\n<td style=\"text-align: center;\">Segmentation</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLO26</strong></td>\n<td style=\"text-align: center;\">Pose</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n<tr>\n<td style=\"text-align: center;\"><strong>YOLO26</strong></td>\n<td style=\"text-align: center;\">Oriented Bounding Boxes</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n<td style=\"text-align: center;\">✅</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"二deploysharp-对-yolov26-的全面支持\">二、DeploySharp 对 YOLOv26 的全面支持</h2>\n<p>DeploySharp 框架为 YOLOv26 系列模型提供了全方位的支持，涵盖了目标检测、实例分割、姿态估计和旋转框检测四种主要任务类型。</p>\n<h3 id=\"21-支持的-yolov26-模型类型\">2.1 支持的 YOLOv26 模型类型</h3>\n<table>\n<thead>\n<tr>\n<th>模型类型</th>\n<th>功能描述</th>\n<th>枚举值</th>\n<th>配置类</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>YOLOv26Det</td>\n<td>目标检测</td>\n<td><code>ModelType.YOLOv26Det</code></td>\n<td><code>Yolov26DetConfig</code></td>\n</tr>\n<tr>\n<td>YOLOv26Seg</td>\n<td>实例分割</td>\n<td><code>ModelType.YOLOv26Seg</code></td>\n<td><code>Yolov26SegConfig</code></td>\n</tr>\n<tr>\n<td>YOLOv26Pose</td>\n<td>人体姿态估计</td>\n<td><code>ModelType.YOLOv26Pose</code></td>\n<td><code>Yolov26PoseConfig</code></td>\n</tr>\n<tr>\n<td>YOLOv26Obb</td>\n<td>旋转框检测</td>\n<td><code>ModelType.YOLOv26Obb</code></td>\n<td><code>Yolov26ObbConfig</code></td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"22-架构设计\">2.2 架构设计</h3>\n<p>DeploySharp 为 YOLOv26 提供了三层架构设计：</p>\n<h4 id=\"接口层-iyolov26xxxmodel\">接口层 (IYolov26XxxModel)</h4>\n<p>在核心库 <code>DeploySharp</code> 中定义了统一的接口：</p>\n<pre><code class=\"language-csharp\">// YOLOv26 检测接口\n// IYolov26DetModel 继承自 IYolov10DetModel\n// 这种设计使得 YOLOv26 可以复用 YOLOv10 的成熟实现\npublic abstract class IYolov26DetModel : IYolov10DetModel\n{\n    /// &lt;summary&gt;\n    /// 构造函数，接收模型配置\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"config\"&gt;YOLOv26 检测模型配置对象&lt;/param&gt;\n    public IYolov26DetModel(Yolov26DetConfig config) : base(config)\n    {\n        // 使用日志系统记录模型初始化信息\n        MyLogger.Log.Info($\"Initializing {this.GetType().Name}, Config:\\n{config}\");\n    }\n}\n</code></pre>\n<h4 id=\"配置层-yolov26xxxconfig\">配置层 (Yolov26XxxConfig)</h4>\n<p>每种模型类型都有对应的配置类，提供灵活的参数设置：</p>\n<pre><code class=\"language-csharp\">// YOLOv26 检测配置类\n// 继承自 Yolov10DetConfig，复用 YOLOv10 的成熟配置\npublic class Yolov26DetConfig : Yolov10DetConfig\n{\n    /// &lt;summary&gt;\n    /// 默认构造函数\n    /// &lt;/summary&gt;\n    public Yolov26DetConfig() { }\n\n    /// &lt;summary&gt;\n    /// 带模型路径的构造函数\n    /// 自动设置合理的默认参数\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"modelPath\"&gt;模型文件路径&lt;/param&gt;\n    public Yolov26DetConfig(string modelPath)\n    {\n\t\t...\n    }\n}\n</code></pre>\n<h4 id=\"实现层-yolov26xxxmodel\">实现层 (Yolov26XxxModel)</h4>\n<p>分别提供 ImageSharp 和 OpenCvSharp 两种实现，开发者可以根据需求选择。</p>\n<h3 id=\"23-类继承关系图\">2.3 类继承关系图</h3>\n<pre><code>YoloDetConfig (基类)\n    ├── Yolov8DetConfig\n    ├── Yolov10DetConfig\n    └── Yolov26DetConfig (继承自 Yolov10DetConfig)\n\nYoloModel (基类)\n    ├── Yolov8DetModel\n    ├── Yolov10DetModel\n    └── Yolov26DetModel (继承自 Yolov10DetModel)\n</code></pre>\n<p>这种继承设计的优势：</p>\n<ol>\n<li><strong>代码复用</strong>：YOLOv26 可以复用 YOLOv10 的成熟实现</li>\n<li><strong>一致性</strong>：保持与其他 YOLO 版本的 API 一致性</li>\n<li><strong>易维护</strong>：共享的代码逻辑集中管理</li>\n</ol>\n<h2 id=\"三yolov26-目标检测代码实现\">三、YOLOv26 目标检测代码实现</h2>\n<h3 id=\"31-使用-imagesharp-作为图像处理库--tensorrt-推理后端\">3.1 使用 ImageSharp 作为图像处理库 + TensorRT 推理后端</h3>\n<h4 id=\"1nuget-包安装\">（1）NuGet 包安装</h4>\n<p>使用 ImageSharp 作为图像处理库、TensorRT 作为推理后端时，需要安装以下核心包：</p>\n<p><strong>DeploySharp 基础库及扩展库</strong>：</p>\n<pre><code>JYPPX.DeploySharp\nJYPPX.DeploySharp.ImageSharp\n</code></pre>\n<p><strong>TensorRT Runtime 库</strong>：</p>\n<pre><code>JYPPX.TensorRT.CSharp.API.runtime.win-x64.cuda11\n或\nJYPPX.TensorRT.CSharp.API.runtime.win-x64.cuda12\n</code></pre>\n<p><strong>注意</strong>：TensorRT Runtime 库的版本需根据本地设备安装的 CUDA 版本进行选择。</p>\n<h4 id=\"2代码实现\">（2）代码实现</h4>\n<p>以下代码可直接复制运行：</p>\n<pre><code class=\"language-csharp\">using DeploySharp.Model;       // 引入模型相关定义\nusing DeploySharp.Data;        // 引入数据处理相关\nusing DeploySharp.Engine;      // 引入推理引擎核心\nusing DeploySharp;             // 引入 DeploySharp 主库\nusing SixLabors.ImageSharp;    // ImageSharp 图像处理库\nusing SixLabors.ImageSharp.PixelFormats; // ImageSharp 像素格式\n\nnamespace DeploySharp.ImageSharp.Demo\n{\n    /// &lt;summary&gt;\n    /// YOLO26目标检测演示类\n    /// 该类展示了如何加载 TensorRT 引擎文件，对图像进行推理并可视化结果。\n    /// &lt;/summary&gt;\n    public class YOLOv26DetDemo\n    {\n        public static void Run()\n        {\n            // ==========================================\n            // 1. 路径配置\n            // ==========================================\n            \n            // 模型下载提示：模型和测试图片可以前往QQ群(945057948)下载\n            // 设置 .engine 文件路径。\n            // 注意：TensorRT 的 .engine 文件是硬件相关的，即在 RTX 3090 上生成的 engine 通常不能在 RTX 4090 上运行。\n            string modelPath = @\"D:\\Program Files\\TensorRT-10.13.0.35-cu11\\bin\\yolo26s.engine\";\n            \n            // 设置待推理的图片路径\n            string imagePath = @\"E:\\Data\\image\\bus.jpg\";\n            // ==========================================\n            // 2. 模型配置初始化\n            // ==========================================\n            \n            // 创建  YOLO26 的配置对象，传入模型路径\n            Yolov26DetConfig config = new Yolov26DetConfig(modelPath);\n            \n            // 设置最大批处理大小。\n            // 即使只推理一张图片，设置适当的 BatchSize 有时也能利用 GPU 并行能力。\n            // 此处设为 2 表示引擎内部最大可以一次处理 2 张图，但要首先保证模型支持。\n            config.MaxBatchSize = 2;\n            \n            // 显式指定推理后端为 TensorRT。\n            // DeploySharp 支持多种后端（如 ONNX Runtime, OpenVINO 等），这里强制使用 TensorRT 以获得最佳性能。\n            config.SetTargetInferenceBackend(InferenceBackend.TensorRT);\n            // ==========================================\n            // 3. 类别字典定义\n            // ==========================================\n            \n            // COCO 数据集的 80 个类别名称列表\n            // YOLO 模型通常输出的是类别的索引（0-79），我们需要将其映射为人类可读的字符串。\n            List&lt;string&gt; d = new List&lt;string&gt; { \"person\", \"bicycle\", \"car\", \"motorcycle\", \"airplane\", \"bus\",\n                \"train\", \"truck\", \"boat\", \"traffic light\", \"fire hydrant\", \"stop sign\", \"parking meter\", \"bench\",\n                \"bird\", \"cat\", \"dog\", \"horse\", \"sheep\", \"cow\", \"elephant\", \"bear\", \"zebra\", \"giraffe\", \"backpack\",\n                \"umbrella\", \"handbag\", \"tie\", \"suitcase\", \"frisbee\", \"skis\", \"snowboard\", \"sports ball\", \"kite\",\n                \"baseball bat\", \"baseball glove\", \"skateboard\", \"surfboard\", \"tennis racket\", \"bottle\", \"wine glass\",\n                \"cup\", \"fork\", \"knife\", \"spoon\", \"bowl\", \"banana\", \"apple\", \"sandwich\", \"orange\", \"broccoli\", \"carrot\",\n                \"hot dog\", \"pizza\", \"donut\", \"cake\", \"chair\", \"couch\", \"potted plant\", \"bed\", \"dining table\", \"toilet\",\n                \"tv\", \"laptop\", \"mouse\", \"remote\", \"keyboard\", \"cell phone\", \"microwave\", \"oven\", \"toaster\", \"sink\",\n                \"refrigerator\", \"book\", \"clock\", \"vase\", \"scissors\", \"teddy bear\", \"hair drier\", \"toothbrush\" };\n            // 将列表转换为字典，Key 为索引，Value 为类别名称\n            Dictionary&lt;int, string&gt; CategoryDict = new Dictionary&lt;int, string&gt;();\n            for (int i = 0; i &lt; d.Count; i++)\n            {\n                CategoryDict[i] = d[i];\n            }\n            \n            // 将类别字典赋值给配置对象，用于后续结果解析\n            config.CategoryDict = CategoryDict;\n            // ==========================================\n            // 4. 模型实例化\n            // ==========================================\n            \n            // 根据配置初始化检测器模型。\n            // 此步骤会加载 engine 文件到内存，并初始化 GPU 上下文。\n            Yolov26DetModel model = new Yolov26DetModel(config);\n            \n            // 使用 SixLabors.ImageSharp 加载图片。\n            // Image.Load 会自动根据文件扩展名解码图片。\n            var img = Image.Load(imagePath);\n            // ==========================================\n            // 5. 模型推理与性能测试\n            // ==========================================\n            \n            // 执行第一次推理。\n            // 注意：TensorRT 的首次推理通常包含 Kernel 初始化等开销，速度会比后续推理慢。\n            DetResult[] result = model.Predict(img);\n            \n            // 执行第二次推理。\n            // 这次推理的时间更能代表模型在实际场景中的平均推理速度。\n            result = model.Predict(img);\n            \n            // 执行第三次推理（可选），用于进一步取平均值或确保稳定性。\n            result = model.Predict(img);\n            \n            // 打印推理性能分析记录。\n            // 这通常会输出预处理、推理、后端处理各阶段的耗时（毫秒级）。\n            model.ModelInferenceProfiler.PrintAllRecords();\n            \n            // 初始化一个列表，虽然本例未直接使用，但在处理多图结果时可能会用到。\n            List&lt;Image&lt;Rgb24&gt;&gt; resultsMat = new List&lt;Image&lt;Rgb24&gt;&gt;();\n            // ==========================================\n            // 6. 结果可视化与保存\n            // ==========================================\n            \n            // 将推理结果绘制在原图上。\n            // Visualize.DrawDetResult 会根据 DetResult 中的坐标和置信度画框和文字。\n            // 需要将 img 强制转换为 Image&lt;Rgb24&gt;，因为 DrawDetResult 通常需要特定的像素格式。\n            var resultImg = Visualize.DrawDetResult(result, (Image&lt;Rgb24&gt;)img, new VisualizeOptions(1.0f));\n            // 保存带有检测框的图片到当前目录下。\n            // 文件名包含配置的模型类型，便于区分不同模型的结果。\n            resultImg.Save(@$\"./result_{config.ModelType}.jpg\");\n        }\n    }\n}\n</code></pre>\n<h4 id=\"3代码详解\">（3）代码详解</h4>\n<ol>\n<li>\n<p><strong>配置模型参数</strong>：</p>\n<pre><code class=\"language-csharp\">Yolov26DetConfig config = new Yolov26DetConfig(modelPath);\nconfig.MaxBatchSize = 2;\nconfig.SetTargetInferenceBackend(InferenceBackend.TensorRT);\n</code></pre>\n<ul>\n<li>创建配置对象，使用 TensorRT 引擎进行推理</li>\n<li>设置最大批量大小为 2，支持最多 2 张图片的批量推理</li>\n</ul>\n</li>\n<li>\n<p><strong>创建模型实例</strong>：</p>\n<pre><code class=\"language-csharp\">Yolov26DetModel model = new Yolov26DetModel(config);\n</code></pre>\n<p>模型实例化时会自动加载 .engine 文件并初始化 TensorRT 引擎。</p>\n</li>\n<li>\n<p><strong>执行推理</strong>：</p>\n<pre><code class=\"language-csharp\">DetResult[] result = model.Predict(img);\n</code></pre>\n<p><code>Predict()</code> 方法返回检测结果数组，每个元素包含边界框、置信度和类别信息。</p>\n</li>\n<li>\n<p><strong>性能分析</strong>：</p>\n<pre><code class=\"language-csharp\">model.ModelInferenceProfiler.PrintAllRecords();\n</code></pre>\n<p>打印详细的性能统计，包括预处理、推理、后处理各阶段的耗时。</p>\n</li>\n</ol>\n<h4 id=\"4结果展示\">（4）结果展示</h4>\n<p>控制台打印输出：</p>\n<p><img alt=\"image-20260116231024791\" class=\"lazyload\" /></p>\n<p>推理结果图片：</p>\n<p><img alt=\"result_YOLOv26Det\" class=\"lazyload\" /></p>\n<h3 id=\"32-使用-opencvsharp做图像处理库onnx-runtime推理后端\">3.2 使用 OpenCvSharp做图像处理库+ONNX Runtime推理后端</h3>\n<h4 id=\"1nuget-包安装-1\">（1）NuGet 包安装</h4>\n<p>使用 OpenCvSharp 作为图像处理库、ONNX Runtime 作为推理后端时，需要安装以下核心包：</p>\n<p><strong>DeploySharp 基础库及扩展库</strong>：</p>\n<pre><code>JYPPX.DeploySharp\nJYPPX.DeploySharp.OpenCvSharp\n</code></pre>\n<p><strong>OpenCvSharp Runtime 库</strong>：</p>\n<pre><code>OpenCvSharp4.runtime.win\n</code></pre>\n<p><strong>可选加速包</strong>：ONNX Runtime 支持多种推理加速方式，除默认 CPU 加速外，可根据需求安装以下 NuGet 包：</p>\n<table>\n<thead>\n<tr>\n<th>加速方式</th>\n<th>NuGet 包名</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>OpenVINO 加速</td>\n<td>Intel.ML.OnnxRuntime.OpenVino</td>\n</tr>\n<tr>\n<td>DirectML 加速</td>\n<td>Microsoft.AI.DirectML</td>\n</tr>\n<tr>\n<td>CUDA 加速</td>\n<td>Microsoft.ML.OnnxRuntime.Gpu</td>\n</tr>\n</tbody>\n</table>\n<p>更多加速方式请参考 ONNX Runtime 官方文档。本节以 DirectML 为例进行演示。</p>\n<h4 id=\"2代码实现-1\">（2）代码实现</h4>\n<p>推理代码如下所示，可直接复制运行：</p>\n<pre><code class=\"language-csharp\">using OpenCvSharp;            // 引入 OpenCvSharp，用于图像的读取、显示和矩阵操作\nusing DeploySharp.Model;      // 引入模型定义和配置类\nusing DeploySharp.Data;       // 引入数据处理相关的类\nusing DeploySharp.Engine;     // 引入推理引擎核心接口和枚举\nusing DeploySharp;            // 引入 DeploySharp 主库和可视化工具\nnamespace DeploySharp.OpenCvSharp.Demo\n{\n    /// &lt;summary&gt;\n    ///  YOLO26 目标检测演示 (基于 ONNX Runtime + OpenCvSharp)\n    /// 本示例展示了如何加载 ONNX 模型，并配置使用 DirectML 在 GPU 上进行推理。\n    /// &lt;/summary&gt;\n    public class Yolov26DetDemo\n    {\n        public static void Run()\n        {\n            // ==========================================\n            // 1. 路径配置\n            // ==========================================\n            \n            // 模型下载提示：模型和测试图片可以前往QQ群(945057948)下载\n            // 注意：此处加载的是标准的 .onnx 模型文件，而不是 TensorRT 的 .engine 文件。\n            // ONNX 模型具有良好的跨平台特性。\n            string modelPath = @\"E:\\Model\\yolov28\\yolo26s.onnx\";\n            \n            // 设置待检测的图片路径\n            string imagePath = @\"E:\\Data\\image\\bus.jpg\";\n            // ==========================================\n            // 2. 模型配置与推理后端设置\n            // ==========================================\n            \n            // 创建  YOLO26 的配置对象，传入模型路径\n            Yolov26DetConfig config = new Yolov26DetConfig(modelPath);\n            \n            // [关键步骤] 设置推理后端为 ONNX Runtime。\n            // 这意味着模型将通过 ONNX Runtime 进行加载和执行，而不是 TensorRT。\n            config.SetTargetInferenceBackend(InferenceBackend.OnnxRuntime);\n            \n            // 设置目标设备类型为 GPU 0。\n            // 这是一个逻辑设定，具体执行取决于 ONNX Runtime 的提供程序。\n            config.SetTargetDeviceType(DeviceType.GPU0);\n            \n            // [关键步骤] 设置 ONNX Runtime 的具体执行提供程序为 DML (DirectML)。\n            // DirectML 是 Windows 上的高性能硬件加速接口，支持 AMD、NVIDIA 和 Intel 显卡。\n            // 如果不加这一行，ONNX Runtime 可能默认使用 CPU 进行推理，速度较慢。\n            config.SetTargetOnnxRuntimeDeviceType(OnnxRuntimeDeviceType.DML);\n            // ==========================================\n            // 3. 类别字典定义 (COCO 80类)\n            // ==========================================\n            \n            // 定义 COCO 数据集的 80 个类别名称\n            // 这些名称将用于在结果可视化时标注检测到的物体\n            List&lt;string&gt; d = new List&lt;string&gt; { \"person\", \"bicycle\", \"car\", \"motorcycle\", \"airplane\", \"bus\",\n                \"train\", \"truck\", \"boat\", \"traffic light\", \"fire hydrant\", \"stop sign\", \"parking meter\", \"bench\",\n                \"bird\", \"cat\", \"dog\", \"horse\", \"sheep\", \"cow\", \"elephant\", \"bear\", \"zebra\", \"giraffe\", \"backpack\",\n                \"umbrella\", \"handbag\", \"tie\", \"suitcase\", \"frisbee\", \"skis\", \"snowboard\", \"sports ball\", \"kite\",\n                \"baseball bat\", \"baseball glove\", \"skateboard\", \"surfboard\", \"tennis racket\", \"bottle\", \"wine glass\",\n                \"cup\", \"fork\", \"knife\", \"spoon\", \"bowl\", \"banana\", \"apple\", \"sandwich\", \"orange\", \"broccoli\", \"carrot\",\n                \"hot dog\", \"pizza\", \"donut\", \"cake\", \"chair\", \"couch\", \"potted plant\", \"bed\", \"dining table\", \"toilet\",\n                \"tv\", \"laptop\", \"mouse\", \"remote\", \"keyboard\", \"cell phone\", \"microwave\", \"oven\", \"toaster\", \"sink\",\n                \"refrigerator\", \"book\", \"clock\", \"vase\", \"scissors\", \"teddy bear\", \"hair drier\", \"toothbrush\" };\n            // 构建&lt;索引, 类别名&gt;字典\n            Dictionary&lt;int, string&gt; CategoryDict = new Dictionary&lt;int, string&gt;();\n            for (int i = 0; i &lt; d.Count; i++)\n            {\n                CategoryDict[i] = d[i];\n            }\n            \n            // 将类别字典赋值给配置对象\n            config.CategoryDict = CategoryDict;\n            // ==========================================\n            // 4. 模型初始化\n            // ==========================================\n            \n            // 实例化模型，传入配置。\n            // 此时 DeploySharp 会根据配置加载 ONNX 模型，并初始化 DirectML 会话。\n            Yolov26DetModel model = new Yolov26DetModel(config);\n            \n            // 使用 OpenCvSharp 读取图片到 Mat 对象中\n            // Mat 是 OpenCV 中用于存储图像数据的核心矩阵结构\n            Mat img = Cv2.ImRead(imagePath);\n            // ==========================================\n            // 5. 模型推理 (预热与测试)\n            // ==========================================\n            \n            // 执行多次推理。\n            // 第一次推理通常包含模型加载、内存分配等初始化开销，耗时较长。\n            Result[] result = model.Predict(img);\n            \n            // 后续推理用于测试稳定的推理速度。\n            result = model.Predict(img);\n            result = model.Predict(img);\n            result = model.Predict(img);\n            \n            // 打印性能分析记录。\n            // 这将输出推理过程中各阶段（如预处理、推理执行、后处理）的耗时统计。\n            model.ModelInferenceProfiler.PrintAllRecords();\n            \n            // 初始化列表，用于存储处理后的图像（本例主要用于演示）\n            List&lt;Mat&gt; resultsMat = new List&lt;Mat&gt;();\n            // ==========================================\n            // 6. 结果可视化与显示\n            // ==========================================\n            \n            // 调用可视化工具，将检测框（矩形框）和类别标签绘制在原图上。\n            // VisualizeOptions(1.0f) 可能指定了缩放比例或字体大小等参数。\n            var resultImg = Visualize.DrawDetResult(result, img, new VisualizeOptions(1.0f));\n            \n            // 将绘制好的图像加入列表\n            resultsMat.Add(resultImg);\n            \n            // 使用 OpenCV 的窗口显示结果图像。\n            // \"image\" 是窗口的标题。\n            Cv2.ImShow(\"image\", resultImg);\n            \n            // 等待按键输入。\n            // 参数 0 表示无限期等待，直到用户按下键盘任意键。\n            // 这是为了防止控制台程序执行完毕后窗口立即闪退。\n            Cv2.WaitKey();\n        }\n    \n    }\n}\n</code></pre>\n<h4 id=\"3代码详解-1\">（3）代码详解</h4>\n<p>上述代码与 3.1 节的代码结构基本相似，主要区别在于推理后端的配置：</p>\n<ol>\n<li>\n<p><strong>设置推理后端为 ONNX Runtime</strong>：</p>\n<pre><code class=\"language-csharp\">config.SetTargetInferenceBackend(InferenceBackend.OnnxRuntime);\n</code></pre>\n</li>\n<li>\n<p><strong>设置推理设备为 GPU</strong>（此处使用独显设备）：</p>\n<pre><code class=\"language-csharp\">config.SetTargetDeviceType(DeviceType.GPU0);\n</code></pre>\n</li>\n<li>\n<p><strong>配置 DirectML 加速</strong>：DirectML 是 Windows 上的高性能硬件加速接口，支持 AMD、NVIDIA 和 Intel 显卡，使用简单且无需复杂配置。</p>\n<pre><code class=\"language-csharp\">config.SetTargetOnnxRuntimeDeviceType(OnnxRuntimeDeviceType.DML);\n</code></pre>\n</li>\n</ol>\n<h4 id=\"4结果展示-1\">（4）结果展示</h4>\n<p>控制台输出如下。使用 DirectML 调用显卡加速，虽在速度上与 TensorRT 相比有所差距，但其配置简单、无需复杂设置的优势依然明显，适合快速开发验证。</p>\n<p><img alt=\"image-20260116221718516\" class=\"lazyload\" /></p>\n<h3 id=\"33-使用-opencvsharp-作为图像处理库--openvino-推理后端\">3.3 使用 OpenCvSharp 作为图像处理库 + OpenVINO 推理后端</h3>\n<h4 id=\"1nuget-包安装-2\">（1）NuGet 包安装</h4>\n<p>使用 OpenCvSharp 作为图像处理库、OpenVINO 作为推理后端时，需要安装以下核心包：</p>\n<p><strong>DeploySharp 基础库及扩展库</strong>：</p>\n<pre><code>JYPPX.DeploySharp\nJYPPX.DeploySharp.OpenCvSharp\n</code></pre>\n<p><strong>Runtime 库</strong>：</p>\n<pre><code>OpenCvSharp4.runtime.win\nOpenVINO.runtime.win\n</code></pre>\n<h4 id=\"2代码实现-2\">（2）代码实现</h4>\n<p>推理代码如下所示，可直接复制运行：</p>\n<pre><code class=\"language-csharp\">using OpenCvSharp;            // 引入 OpenCvSharp，用于图像的读取、显示和矩阵操作\nusing DeploySharp.Model;      // 引入模型定义和配置类\nusing DeploySharp.Data;       // 引入数据处理相关的类\nusing DeploySharp.Engine;     // 引入推理引擎核心接口和枚举\nusing DeploySharp;            // 引入 DeploySharp 主库和可视化工具\nnamespace DeploySharp.OpenCvSharp.Demo\n{\n    /// &lt;summary&gt;\n    ///  YOLO26 目标检测演示 (基于OpenVINO  + OpenCvSharp)\n    /// &lt;/summary&gt;\n    public class Yolov26DetDemo\n    {\n        public static void Run()\n        {\n            // ==========================================\n            // 1. 路径配置\n            // ==========================================\n            \n            // 模型下载提示：模型和测试图片可以前往QQ群(945057948)下载\n            // 注意：此处加载的是标准的 .onnx 模型文件，而不是 TensorRT 的 .engine 文件。\n            // ONNX 模型具有良好的跨平台特性。\n            string modelPath = @\"E:\\Model\\yolov28\\yolo26s.onnx\";\n            \n            // 设置待检测的图片路径\n            string imagePath = @\"E:\\Data\\image\\bus.jpg\";\n            // ==========================================\n            // 2. 模型配置\n            // ==========================================\n            \n            // 创建 YOLO26Det 的配置对象，传入模型路径\n            Yolov26DetConfig config = new Yolov26DetConfig(modelPath);\n            \n            // ==========================================\n            // 3. 类别字典定义 (COCO 80类)\n            // ==========================================\n            \n            // 定义 COCO 数据集的 80 个类别名称\n            // 这些名称将用于在结果可视化时标注检测到的物体\n            List&lt;string&gt; d = new List&lt;string&gt; { \"person\", \"bicycle\", \"car\", \"motorcycle\", \"airplane\", \"bus\",\n                \"train\", \"truck\", \"boat\", \"traffic light\", \"fire hydrant\", \"stop sign\", \"parking meter\", \"bench\",\n                \"bird\", \"cat\", \"dog\", \"horse\", \"sheep\", \"cow\", \"elephant\", \"bear\", \"zebra\", \"giraffe\", \"backpack\",\n                \"umbrella\", \"handbag\", \"tie\", \"suitcase\", \"frisbee\", \"skis\", \"snowboard\", \"sports ball\", \"kite\",\n                \"baseball bat\", \"baseball glove\", \"skateboard\", \"surfboard\", \"tennis racket\", \"bottle\", \"wine glass\",\n                \"cup\", \"fork\", \"knife\", \"spoon\", \"bowl\", \"banana\", \"apple\", \"sandwich\", \"orange\", \"broccoli\", \"carrot\",\n                \"hot dog\", \"pizza\", \"donut\", \"cake\", \"chair\", \"couch\", \"potted plant\", \"bed\", \"dining table\", \"toilet\",\n                \"tv\", \"laptop\", \"mouse\", \"remote\", \"keyboard\", \"cell phone\", \"microwave\", \"oven\", \"toaster\", \"sink\",\n                \"refrigerator\", \"book\", \"clock\", \"vase\", \"scissors\", \"teddy bear\", \"hair drier\", \"toothbrush\" };\n            // 构建&lt;索引, 类别名&gt;字典\n            Dictionary&lt;int, string&gt; CategoryDict = new Dictionary&lt;int, string&gt;();\n            for (int i = 0; i &lt; d.Count; i++)\n            {\n                CategoryDict[i] = d[i];\n            }\n            \n            // 将类别字典赋值给配置对象\n            config.CategoryDict = CategoryDict;\n            // ==========================================\n            // 4. 模型初始化\n            // ==========================================\n            \n            // 实例化模型，传入配置。\n            // 此时 DeploySharp 会根据配置加载 ONNX 模型，并初始化 DirectML 会话。\n            Yolov26DetModel model = new Yolov26DetModel(config);\n            \n            // 使用 OpenCvSharp 读取图片到 Mat 对象中\n            // Mat 是 OpenCV 中用于存储图像数据的核心矩阵结构\n            Mat img = Cv2.ImRead(imagePath);\n            // ==========================================\n            // 5. 模型推理 (预热与测试)\n            // ==========================================\n            \n            // 执行多次推理。\n            // 第一次推理通常包含模型加载、内存分配等初始化开销，耗时较长。\n            Result[] result = model.Predict(img);\n            \n            // 后续推理用于测试稳定的推理速度。\n            result = model.Predict(img);\n            result = model.Predict(img);\n            result = model.Predict(img);\n            \n            // 打印性能分析记录。\n            // 这将输出推理过程中各阶段（如预处理、推理执行、后处理）的耗时统计。\n            model.ModelInferenceProfiler.PrintAllRecords();\n            \n            // 初始化列表，用于存储处理后的图像（本例主要用于演示）\n            List&lt;Mat&gt; resultsMat = new List&lt;Mat&gt;();\n            // ==========================================\n            // 6. 结果可视化与显示\n            // ==========================================\n            \n            // 调用可视化工具，将检测框（矩形框）和类别标签绘制在原图上。\n            // VisualizeOptions(1.0f) 可能指定了缩放比例或字体大小等参数。\n            var resultImg = Visualize.DrawDetResult(result, img, new VisualizeOptions(1.0f));\n            \n            // 将绘制好的图像加入列表\n            resultsMat.Add(resultImg);\n            \n            // 使用 OpenCV 的窗口显示结果图像。\n            // \"image\" 是窗口的标题。\n            Cv2.ImShow(\"image\", resultImg);\n            \n            // 等待按键输入。\n            // 参数 0 表示无限期等待，直到用户按下键盘任意键。\n            // 这是为了防止控制台程序执行完毕后窗口立即闪退。\n            Cv2.WaitKey();\n        }\n    \n    }\n}\n</code></pre>\n<h4 id=\"3代码详解-2\">（3）代码详解</h4>\n<p>上述代码与 3.2 节的代码结构基本相似。使用 OpenVINO 作为推理后端时，通常无需额外设置，因为 DeploySharp 默认支持 OpenVINO。</p>\n<p>若设备配备英特尔的集成显卡、独立显卡或 NPU，可通过以下代码指定推理设备以获得更好的性能：</p>\n<pre><code class=\"language-csharp\">config.SetTargetInferenceBackend(InferenceBackend.OpenVINO);\nconfig.SetTargetDeviceType(DeviceType.GPU0);   // 设置设备为集显\n// 或\nconfig.SetTargetDeviceType(DeviceType.GPU1);  // 设置推理设备为独立显卡\n// 或\nconfig.SetTargetDeviceType(DeviceType.NPU);  // 设置推理设备为 NPU\n</code></pre>\n<h4 id=\"4结果展示-2\">（4）结果展示</h4>\n<p>控制台输出如下。使用 OpenVINO 在 CPU 上进行推理时，虽因设备限制推理速度有限，但 OpenVINO 已是 CPU 环境下推理速度最快的工具之一，且配置简单，全面支持英特尔全系设备，欢迎开发者使用。</p>\n<p><img alt=\"image-20260116223936848\" class=\"lazyload\" /></p>\n<h2 id=\"四yolov26-实例分割\">四、YOLOv26 实例分割</h2>\n<h3 id=\"41-代码使用示例\">4.1 代码使用示例</h3>\n<pre><code class=\"language-csharp\">using OpenCvSharp;            // 引入 OpenCvSharp，用于图像读取、显示及矩阵操作\nusing DeploySharp.Model;      // 引入模型配置相关的类\nusing DeploySharp.Data;       // 引入数据结果定义相关的类\nusing DeploySharp.Engine;     // 引入推理引擎核心接口\nusing DeploySharp;            // 引入 DeploySharp 主库及可视化工具\n\nnamespace DeploySharp.OpenCvSharp.Demo\n{\n    /// &lt;summary&gt;\n    /// YOLO26Seg 实例分割演示类\n    /// 本示例展示如何加载 TensorRT 引擎文件，对图像进行实例分割推理，并将掩码绘制在原图上。\n    /// &lt;/summary&gt;\n    public class Yolov26SegDemo\n    {\n        public static void Run()\n        {\n            // ==========================================\n            // 1. 路径配置\n            // ==========================================\n            \n            // 模型下载提示：模型和测试图片可以前往QQ群(945057948)下载\n            // 设置 TensorRT 引擎文件路径。\n            // 注意：这里使用的是 .engine 文件，它是针对特定 GPU 和 TensorRT 版本编译的。\n            // 文件名中的 '-seg' 表示这是一个带有分割头的实例分割模型。\n            string modelPath = @\"D:\\Program Files\\TensorRT-10.13.0.35-cu11\\bin\\yolo26s-seg.engine\";\n            \n            // 设置待推理的图片路径\n            string imagePath = @\"E:\\Data\\image\\bus.jpg\";\n\n\n            // ==========================================\n            // 2. 模型配置与初始化\n            // ==========================================\n            \n            // 创建 YOLO26Seg (实例分割) 的配置对象，传入模型路径\n            Yolov26SegConfig config = new Yolov26SegConfig(modelPath);\n            \n            // [关键设置] 指定推理后端为 TensorRT。\n            // 利用 TensorRT 可以在 NVIDIA GPU 上获得极高的推理速度。\n            config.SetTargetInferenceBackend(InferenceBackend.TensorRT);\n            \n            // 实例化模型。\n            // 此时会加载引擎文件，初始化 GPU 显存上下文。\n            Yolov26SegModel model = new Yolov26SegModel(config);\n\n\n            // ==========================================\n            // 3. 图像加载\n            // ==========================================\n            \n            // 使用 OpenCvSharp 读取图片。\n            // img 是一个 Mat 对象，包含了图像的像素数据。\n            Mat img = Cv2.ImRead(imagePath);\n\n\n            // ==========================================\n            // 4. 模型推理 (预热与性能测试)\n            // ==========================================\n            \n            // 执行第一次推理。\n            // 首次运行通常包含模型加载、显存分配等开销，耗时较长。\n            var result = model.Predict(img);\n            \n            // 执行后续多次推理。\n            // 这是为了排除初始化开销，测试模型在稳定状态下的推理速度。\n            result = model.Predict(img);\n            result = model.Predict(img);\n            result = model.Predict(img);\n            \n            // 打印推理性能分析记录。\n            // 这将输出预处理、推理计算、后处理（包括掩码生成）各阶段的耗时。\n            model.ModelInferenceProfiler.PrintAllRecords();\n\n\n            // ==========================================\n            // 5. 结果可视化\n            // ==========================================\n            \n            // 调用可视化工具，绘制分割结果。\n            // 注意这里使用的是 DrawSegResult (绘制分割结果)，而不是 DrawDetResult (绘制检测框)。\n            // 该函数会将检测到的物体框、类别标签以及彩色的半透明掩码绘制在原图上。\n            var resultImg = Visualize.DrawSegResult(result, img, new VisualizeOptions(1.0f));\n            \n            // 使用 OpenCV 窗口显示渲染后的结果图像。\n            Cv2.ImShow(\"image\", resultImg);\n            \n            // 等待按键输入，防止窗口闪退。\n            Cv2.WaitKey();\n        }\n    }\n}\n\n</code></pre>\n<h3 id=\"42-代码详解\">4.2 代码详解</h3>\n<ol>\n<li>\n<p><strong>创建分割配置</strong>：</p>\n<pre><code class=\"language-csharp\">Yolov26SegConfig config = new Yolov26SegConfig(modelPath);\nconfig.SetTargetInferenceBackend(InferenceBackend.TensorRT);\n</code></pre>\n<p><code>Yolov26SegConfig</code> 是 YOLOv26 分割模型的配置类。</p>\n</li>\n<li>\n<p><strong>执行分割推理</strong>：</p>\n<pre><code class=\"language-csharp\">var result = model.Predict(img);\n</code></pre>\n<p>分割推理返回 <code>SegResult[]</code> 数组，每个元素包含边界框、置信度、类别和分割掩码。</p>\n</li>\n<li>\n<p><strong>可视化分割结果</strong>：</p>\n<pre><code class=\"language-csharp\">var resultImg = Visualize.DrawSegResult(result, img, new VisualizeOptions(1.0f));\n</code></pre>\n<p><code>DrawSegResult</code> 会为每个检测到的对象绘制不同颜色的掩码，叠加在原图上。</p>\n</li>\n</ol>\n<h3 id=\"43-分割结果展示\">4.3 分割结果展示</h3>\n<h4 id=\"控制台输出\">控制台输出</h4>\n<p>以下三张截图分别展示了在 TensorRT GPU、ONNX Runtime(DirectML) GPU、OpenVINO CPU 设备下的推理性能。不同引擎各有优势，开发者可根据自身硬件环境选择最适合的方案。</p>\n<p><strong>TensorRT GPU：</strong></p>\n<p><img alt=\"image-20260116231515663\" class=\"lazyload\" /></p>\n<p><strong>ONNX Runtime (DirectML) GPU：</strong></p>\n<p><img alt=\"image-20260116231805014\" class=\"lazyload\" /></p>\n<p><strong>OpenVINO CPU：</strong></p>\n<p><img alt=\"image-20260116231630904\" class=\"lazyload\" /></p>\n<h4 id=\"推理结果绘制\">推理结果绘制</h4>\n<p>下图为官方预训练模型导出后的推理结果示例：</p>\n<p><img alt=\"image-20260116231431298\" class=\"lazyload\" /></p>\n<h2 id=\"五yolov26-人体姿态估计\">五、YOLOv26 人体姿态估计</h2>\n<h3 id=\"51-功能介绍\">5.1 功能介绍</h3>\n<p>YOLO26 Pose 模型用于检测人体关键点，通常支持 17 个关键点（头部、颈部、肩膀、手肘、手腕、臀部、膝盖、脚踝等）。</p>\n<p><strong>关键点定义</strong>（COCO 格式）：</p>\n<table>\n<thead>\n<tr>\n<th>关键点</th>\n<th>名称</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0</td>\n<td>nose</td>\n<td>鼻子</td>\n</tr>\n<tr>\n<td>1</td>\n<td>left_eye</td>\n<td>左眼</td>\n</tr>\n<tr>\n<td>2</td>\n<td>right_eye</td>\n<td>右眼</td>\n</tr>\n<tr>\n<td>3</td>\n<td>left_ear</td>\n<td>左耳</td>\n</tr>\n<tr>\n<td>4</td>\n<td>right_ear</td>\n<td>右耳</td>\n</tr>\n<tr>\n<td>5</td>\n<td>left_shoulder</td>\n<td>左肩</td>\n</tr>\n<tr>\n<td>6</td>\n<td>right_shoulder</td>\n<td>右肩</td>\n</tr>\n<tr>\n<td>7</td>\n<td>left_elbow</td>\n<td>左肘</td>\n</tr>\n<tr>\n<td>8</td>\n<td>right_elbow</td>\n<td>右肘</td>\n</tr>\n<tr>\n<td>9</td>\n<td>left_wrist</td>\n<td>左腕</td>\n</tr>\n<tr>\n<td>10</td>\n<td>right_wrist</td>\n<td>右腕</td>\n</tr>\n<tr>\n<td>11</td>\n<td>left_hip</td>\n<td>左髋</td>\n</tr>\n<tr>\n<td>12</td>\n<td>right_hip</td>\n<td>右髋</td>\n</tr>\n<tr>\n<td>13</td>\n<td>left_knee</td>\n<td>左膝</td>\n</tr>\n<tr>\n<td>14</td>\n<td>right_knee</td>\n<td>右膝</td>\n</tr>\n<tr>\n<td>15</td>\n<td>left_ankle</td>\n<td>左踝</td>\n</tr>\n<tr>\n<td>16</td>\n<td>right_ankle</td>\n<td>右踝</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"52-代码使用示例\">5.2 代码使用示例</h3>\n<pre><code class=\"language-csharp\">using OpenCvSharp;            // 引入 OpenCvSharp，用于图像的读取、显示和矩阵操作\nusing DeploySharp.Model;      // 引入模型定义和配置类\nusing DeploySharp.Data;       // 引入数据结果相关的类\nusing DeploySharp.Engine;     // 引入推理引擎核心接口\nusing DeploySharp;            // 引入 DeploySharp 主库和可视化工具\nusing System;                 // 引入 System 命名空间以使用 Console\n\nnamespace DeploySharp.OpenCvSharp.Demo\n{\n    /// &lt;summary&gt;\n    /// YOLO26Pose 姿态估计演示类\n    /// 本示例展示了如何加载 ONNX 模型进行人体关键点检测，并可视化骨骼连接。\n    /// &lt;/summary&gt;\n    public class Yolov26PoseDemo\n    {\n        public static void Run()\n        {\n            // ==========================================\n            // 1. 路径配置\n            // ==========================================\n            \n            // 模型下载提示：模型和测试图片可以前往QQ群(945057948)下载\n            // 设置 ONNX 模型文件路径。\n            // '-pose' 后缀表示这是一个专门用于姿态估计（关键点检测）的模型。\n            string modelPath = @\"E:\\Model\\yolov28\\yolo26s-pose.onnx\";\n            \n            // 设置待推理的图片路径\n            string imagePath = @\"E:\\Data\\image\\demo_9.jpg\";\n\n\n            // ==========================================\n            // 2. 模型配置与初始化\n            // ==========================================\n            \n            // 创建 YOLO26Pose (姿态估计) 的配置对象，传入模型路径\n            Yolov26PoseConfig config = new Yolov26PoseConfig(modelPath);\n            \n            // [关键设置] 设置推理后端为 ONNX Runtime。\n            // 这使得模型可以跨平台运行，不仅限于 NVIDIA GPU（取决于 ONNX Runtime 的安装提供程序）。\n            config.SetTargetInferenceBackend(InferenceBackend.OnnxRuntime);\n            \n            // 实例化姿态估计模型。\n            // 模型加载时会解析 ONNX 图结构，准备好输入输出节点。\n            Yolov26PoseModel model = new Yolov26PoseModel(config);\n\n\n            // ==========================================\n            // 3. 图像加载\n            // ==========================================\n            \n            // 使用 OpenCvSharp 读取图片。\n            Mat img = Cv2.ImRead(imagePath);\n\n\n            // ==========================================\n            // 4. 模型推理与结果查看\n            // ==========================================\n            \n            // 执行推理。\n            // 第一次推理通常较慢，包含初始化开销。\n            var result = model.Predict(img);\n            \n            // 执行多次推理以测试稳定状态下的性能。\n            result = model.Predict(img);\n            result = model.Predict(img);\n            result = model.Predict(img);\n            \n            // 打印第一个结果的详细信息到控制台。\n            // 姿态估计的 Result 对象通常包含检测框信息以及一个关键点数组。\n            // 这一行有助于开发者调试，查看模型输出的原始数据结构。\n            Console.WriteLine(result[0].ToString());\n            \n            // 打印性能分析记录，查看各阶段耗时。\n            model.ModelInferenceProfiler.PrintAllRecords();\n\n\n            // ==========================================\n            // 5. 结果可视化\n            // ==========================================\n            \n            // 调用可视化工具，绘制姿态估计结果。\n            // 注意这里使用的是 DrawPoses，它会自动将识别出的关键点（如眼睛、肩膀、肘部等）\n            // 用圆点标出，并根据人体结构连接成骨架。\n            // VisualizeOptions(1.0f) 可能指定了绘制时的线条粗细或字体缩放比例。\n            var resultImg = Visualize.DrawPoses(result, img, new VisualizeOptions(1.0f));\n            \n            // 显示结果图像。\n            Cv2.ImShow(\"image\", resultImg);\n            \n            // 等待按键，防止窗口闪退。\n            Cv2.WaitKey();\n        }\n    }\n}\n\n</code></pre>\n<h3 id=\"53-代码详解\">5.3 代码详解</h3>\n<ol>\n<li>\n<p><strong>创建姿态估计配置</strong>：</p>\n<pre><code class=\"language-csharp\">Yolov26PoseConfig config = new Yolov26PoseConfig(modelPath);\nconfig.SetTargetInferenceBackend(InferenceBackend.OnnxRuntime);\n</code></pre>\n<p><code>Yolov26PoseConfig</code> 是 YOLOv26 姿态估计模型的配置类。</p>\n</li>\n<li>\n<p><strong>执行姿态估计推理</strong>：</p>\n<pre><code class=\"language-csharp\">var result = model.Predict(img);\n</code></pre>\n<p>姿态估计推理返回 <code>KeyPointResult[]</code> 数组，每个元素包含人体边界框、置信度和 17 个关键点坐标。</p>\n</li>\n<li>\n<p><strong>可视化姿态估计结果</strong>：</p>\n<pre><code class=\"language-csharp\">var resultImg = Visualize.DrawPoses(result, img, new VisualizeOptions(1.0f));\n</code></pre>\n<p><code>DrawPoses</code> 会绘制人体骨架（连接关键点）和关键点标记。</p>\n</li>\n</ol>\n<h3 id=\"54-结果展示\">5.4 结果展示</h3>\n<h4 id=\"控制台输出-1\">控制台输出</h4>\n<p>以下截图展示了在 ONNX Runtime CPU 设备下的推理性能：</p>\n<p><img alt=\"image-20260116232926313\" class=\"lazyload\" /></p>\n<h4 id=\"推理结果绘制-1\">推理结果绘制</h4>\n<p>下图为官方预训练模型导出后的推理结果示例：</p>\n<p><img alt=\"image-20260116232942723\" class=\"lazyload\" /></p>\n<h2 id=\"六yolov26-旋转框检测\">六、YOLOv26 旋转框检测</h2>\n<p>YOLOv26 OBB (Oriented Bounding Box) 模型用于检测旋转物体，生成带有旋转角度的边界框。这对于检测航空影像中的建筑物、遥感图像中的车辆等场景非常重要。</p>\n<h3 id=\"61-代码使用示例\">6.1 代码使用示例</h3>\n<p>以下代码演示如何使用 TensorRT 引擎进行旋转目标检测：</p>\n<pre><code class=\"language-csharp\">using OpenCvSharp;            // 引入 OpenCvSharp，用于图像读取、显示及绘图\nusing DeploySharp.Model;      // 引入模型配置相关的类\nusing DeploySharp.Data;       // 引入数据结果定义相关的类\nusing DeploySharp.Engine;     // 引入推理引擎核心接口\nusing DeploySharp;            // 引入 DeploySharp 主库及可视化工具\nnamespace DeploySharp.OpenCvSharp.Demo\n{\n    /// &lt;summary&gt;\n    /// YOLOv26 OBB 旋转目标检测演示类\n    /// 本示例展示如何加载 TensorRT 引擎文件，对图像进行旋转目标检测，并绘制旋转框。\n    /// &lt;/summary&gt;\n    public class Yolov26ObbDemo\n    {\n        public static void Run()\n        {\n            // ==========================================\n            // 1. 路径配置\n            // ==========================================\n            \n            // 模型下载提示：模型和测试图片可以前往 QQ 群（945057948）下载\n            // '-obb' 表示该模型用于输出旋转边界框\n            string modelPath = @\"D:\\Program Files\\TensorRT-10.13.0.35-cu11\\bin\\yolo26s-obb.engine\";\n            \n            // 设置待推理的图片路径\n            // plane.png 是旋转目标检测的经典测试图（飞机停机坪通常包含各种角度的飞机）。\n            string imagePath = @\"E:\\Data\\image\\plane.png\";\n            // ==========================================\n            // 2. 模型配置与初始化\n            // ==========================================\n            \n            // 创建 YOLOv26 OBB (旋转目标检测) 的配置对象，传入模型路径\n            Yolov26ObbConfig config = new Yolov26ObbConfig(modelPath);\n            \n            // [关键设置] 指定推理后端为 TensorRT。\n            // 这将调用 NVIDIA GPU 进行高性能计算。\n            // 注意：因为使用的是 .engine 文件，所以必须选择 TensorRT 后端。\n            config.SetTargetInferenceBackend(InferenceBackend.TensorRT);\n            \n            // 实例化旋转目标检测模型。\n            Yolov26ObbModel model = new Yolov26ObbModel(config);\n            // ==========================================\n            // 3. 图像加载\n            // ==========================================\n            \n            // 使用 OpenCvSharp 读取图片。\n            Mat img = Cv2.ImRead(imagePath);\n            // ==========================================\n            // 4. 模型推理\n            // ==========================================\n            \n            // 执行推理。\n            var result = model.Predict(img);\n            \n     \n            // 如果需要测试纯推理速度（排除初始化开销），可以取消注释进行多次循环。\n            result = model.Predict(img);\n            result = model.Predict(img);\n            result = model.Predict(img);\n            \n            // 打印性能分析记录。\n            // 这将显示预处理、TensorRT 推理、后处理（包含 OBB 解码）的耗时。\n            model.ModelInferenceProfiler.PrintAllRecords();\n            // ==========================================\n            // 5. 结果可视化\n            // ==========================================\n            \n            // 调用可视化工具，绘制旋转检测结果。\n            // DrawObbResult 会根据检测到的 x, y, w, h 和 angle (角度) 绘制旋转矩形。\n            var resultImg = Visualize.DrawObbResult(result, img, new VisualizeOptions(1.0f));\n            \n            // [可选] 调整图片大小以适应屏幕\n            // 航拍图通常分辨率很大，可以缩小显示。\n            //Cv2.Resize(resultImg, resultImg, new Size(resultImg.Width / 4, resultImg.Height / 4));\n            \n            // 显示结果图像。\n            Cv2.ImShow(\"image\", resultImg);\n            \n            // 等待按键，防止窗口闪退。\n            Cv2.WaitKey();\n        }\n    }\n}\n</code></pre>\n<h3 id=\"62-代码详解\">6.2 代码详解</h3>\n<ol>\n<li>\n<p><strong>创建旋转框检测配置</strong>：</p>\n<pre><code class=\"language-csharp\">Yolov26ObbConfig config = new Yolov26ObbConfig(modelPath);\nconfig.SetTargetInferenceBackend(InferenceBackend.TensorRT);\n</code></pre>\n<p><code>Yolov26ObbConfig</code> 是 YOLOv26 旋转框检测模型的配置类。</p>\n</li>\n<li>\n<p><strong>执行旋转框检测推理</strong>：</p>\n<pre><code class=\"language-csharp\">ObbResult[] result = model.Predict(img);\n</code></pre>\n<p>旋转框检测推理返回 <code>ObbResult[]</code> 数组，每个元素包含中心点、宽度、高度、旋转角度和类别信息。</p>\n</li>\n<li>\n<p><strong>可视化旋转框检测结果</strong>：</p>\n<pre><code class=\"language-csharp\">var resultImg = Visualize.DrawObbResult(result, img, new VisualizeOptions(1.0f));\n</code></pre>\n<p><code>DrawObbResult</code> 会绘制旋转的边界框（四边形），而不是普通的轴对齐矩形。</p>\n</li>\n</ol>\n<h3 id=\"63-旋转框检测结果展示\">6.3 旋转框检测结果展示</h3>\n<h4 id=\"控制台输出-2\">控制台输出</h4>\n<p>以下截图展示了在 TensorRT GPU 设备下的推理性能：</p>\n<p><img alt=\"image-20260116233931296\" class=\"lazyload\" /></p>\n<h4 id=\"推理结果绘制-2\">推理结果绘制</h4>\n<p>下图为官方预训练模型导出后的推理结果示例：</p>\n<p><img alt=\"image-20260116233543902\" class=\"lazyload\" /></p>\n<h2 id=\"七跨引擎支持\">七、跨引擎支持</h2>\n<p>DeploySharp 原生支持 OpenVINO、ONNX Runtime、TensorRT 三大主流推理引擎，为开发者在 CPU、GPU、NPU 等不同硬件设备上部署模型提供了最全面的解决方案。集成的 YOLOv26 系列默认支持所有推理引擎，开发者可根据实际硬件环境选择最优的推理方案。</p>\n<h3 id=\"71-引擎性能对比\">7.1 引擎性能对比</h3>\n<table>\n<thead>\n<tr>\n<th>引擎</th>\n<th>优势</th>\n<th>适用场景</th>\n<th>性能特点</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>OpenVINO</td>\n<td>Intel 硬件优化，支持多种设备（CPU、GPU0、GPU1、NPU）</td>\n<td>Intel CPU、Intel GPU、NPU</td>\n<td>Intel 硬件加速</td>\n</tr>\n<tr>\n<td>ONNX Runtime</td>\n<td>广泛支持，跨平台，兼容性好</td>\n<td>CPU、GPU(CUDA/DML)、移动端</td>\n<td>平衡性能与兼容性</td>\n</tr>\n<tr>\n<td>TensorRT</td>\n<td>NVIDIA GPU 极致性能，经过专门优化</td>\n<td>NVIDIA GPU 高性能场景</td>\n<td>最佳 GPU 性能</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"72-引擎选择建议\">7.2 引擎选择建议</h3>\n<p>根据硬件环境和应用场景选择合适的推理引擎：</p>\n<table>\n<thead>\n<tr>\n<th>硬件环境</th>\n<th>推荐引擎</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Intel CPU/GPU</td>\n<td>OpenVINO</td>\n<td>Intel 硬件优化，性能最佳</td>\n</tr>\n<tr>\n<td>NVIDIA GPU</td>\n<td>TensorRT</td>\n<td>极致性能，适合高频推理</td>\n</tr>\n<tr>\n<td>NVIDIA GPU (需要灵活性)</td>\n<td>ONNX Runtime (CUDA)</td>\n<td>兼容性好，易于切换</td>\n</tr>\n<tr>\n<td>通用 CPU</td>\n<td>ONNX Runtime</td>\n<td>跨平台兼容性好</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"73-引擎切换示例\">7.3 引擎切换示例</h3>\n<pre><code class=\"language-csharp\">// 切换到 OpenVINO\nconfig.SetTargetInferenceBackend(InferenceBackend.OpenVINO);\nconfig.TargetDeviceType = DeviceType.CPU;\n\n// 切换到 ONNX Runtime (CUDA)\nconfig.SetTargetInferenceBackend(InferenceBackend.OnnxRuntime);\nconfig.TargetDeviceType = DeviceType.GPU;\n\n// 切换到 TensorRT\nconfig.SetTargetInferenceBackend(InferenceBackend.TensorRT);\nconfig.TargetDeviceType = DeviceType.GPU;\n</code></pre>\n<p><strong>注意</strong>：切换推理引擎可能需要重新加载模型，建议在应用启动时确定使用的引擎。</p>\n<h2 id=\"八性能优化建议\">八、性能优化建议</h2>\n<h3 id=\"81-预热机制\">8.1 预热机制</h3>\n<p>首次推理通常较慢，因为需要加载模型、初始化推理引擎、编译计算图等。建议执行几次预热推理。</p>\n<pre><code class=\"language-csharp\">// 预热模型（执行 3 次推理）\nfor (int i = 0; i &lt; 3; i++)\n{\n    model.Predict(img);\n}\n\n// 实际推理\nvar result = model.Predict(img);\n</code></pre>\n<h3 id=\"82-批量推理\">8.2 批量推理</h3>\n<p>对于大量图像，使用批量推理可以提高吞吐量，前提是模型支持多 Batch Size。</p>\n<pre><code class=\"language-csharp\">// 设置批量大小为 4\nconfig.InferBatch = 4;\n\n// 准备批量图像\nvar imageList = new List&lt;Image&lt;Rgb24&gt;&gt;();\nimageList.Add(Image.Load&lt;Rgb24&gt;(@\"path1.jpg\"));\nimageList.Add(Image.Load&lt;Rgb24&gt;(@\"path2.jpg\"));\nimageList.Add(Image.Load&lt;Rgb24&gt;(@\"path3.jpg\"));\nimageList.Add(Image.Load&lt;Rgb24&gt;(@\"path4.jpg\"));\n\n// 执行批量推理\nvar results = model.Predict(imageList);\n</code></pre>\n<h3 id=\"83-设备选择\">8.3 设备选择</h3>\n<p>根据硬件选择最优设备：</p>\n<pre><code class=\"language-csharp\">// Intel 环境：使用 OpenVINO\nconfig.SetTargetInferenceBackend(InferenceBackend.OpenVINO);\n\n// NVIDIA 环境：使用 TensorRT 或 ONNX Runtime (CUDA)\nconfig.SetTargetInferenceBackend(InferenceBackend.TensorRT);\nconfig.TargetDeviceType = DeviceType.GPU;\n</code></pre>\n<h2 id=\"九总结\">九、总结</h2>\n<p>DeploySharp 对 YOLOv26 系列提供了全面而深入的支持，包括：</p>\n<ol>\n<li><strong>四种任务类型全覆盖</strong>：检测、分割、姿态估计、旋转框检测</li>\n<li><strong>双图像处理库支持</strong>：ImageSharp 和 OpenCvSharp</li>\n<li><strong>三推理引擎兼容</strong>：OpenVINO、ONNX Runtime、TensorRT</li>\n<li><strong>完善的配置系统</strong>：灵活的参数设置</li>\n<li><strong>详细的性能分析</strong>：内置性能分析器</li>\n<li><strong>丰富的可视化选项</strong>：支持多种结果展示方式</li>\n</ol>\n<p>YOLOv26 的简化的输出格式和优化的架构，结合 DeploySharp 的封装和优化，使得开发者可以轻松地将 YOLOv26 集成到各种 C# 应用中，构建高效、准确的计算机视觉解决方案。</p>\n<p>随着 YOLO 系列的持续发展，DeploySharp 也将持续跟进，为开发者提供最新模型的支持。期待 YOLOv26 及未来版本的更多创新和突破。</p>\n<h2 id=\"技术支持\">技术支持</h2>\n<p>如有问题或建议，欢迎通过以下方式交流：</p>\n<ul>\n<li>📧 <strong>GitHub Issues</strong>：在项目仓库提 Issue 或 Pull Request</li>\n<li>💬 <strong>QQ 交流群</strong>：加入 <strong>945057948</strong>，回复更方便更快哦</li>\n</ul>\n<p><img alt=\"QQ群二维码\" class=\"lazyload\" /></p>\n<hr />\n<p><em>作者：Guojin Yan</em><br />\n<em>版本：0.0.6.1</em><br />\n<em>最后更新：2026年1月</em></p>\n<hr />\n<p><strong>【文章声明】</strong></p>\n<p>本文主要内容基于作者的研究与实践，部分表述借助AI工具进行了辅助优化。由于技术局限性，文中可能存在错误或疏漏之处，恳请各位读者批评指正。如果内容无意中侵犯了您的权益，请及时通过公众号后台与我们联系，我们将第一时间核实并妥善处理。感谢您的理解与支持！</p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-19 22:47</span>&nbsp;\n<a href=\"https://www.cnblogs.com/guojin-blogs\">椒颜皮皮虾</a>&nbsp;\n阅读(<span id=\"post_view_count\">60</span>)&nbsp;\n评论(<span id=\"post_comment_count\">1</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "吴恩达深度学习课程五：自然语言处理  第二周：词嵌入（二）词嵌入模型原理",
      "link": "https://www.cnblogs.com/Goblinscholar/p/19503620",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/Goblinscholar/p/19503620\" id=\"cb_post_title_url\" title=\"发布于 2026-01-19 20:35\">\n    <span>吴恩达深度学习课程五：自然语言处理  第二周：词嵌入（二）词嵌入模型原理</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>此分类用于记录吴恩达深度学习课程的学习笔记。<br />\n课程相关信息链接如下：</p>\n<ol>\n<li>原课程视频链接：<a href=\"https://www.bilibili.com/video/BV1FT4y1E74V?buvid=XU762317353676D786954061C192FE625463B&amp;from_spmid=playlist.playlist-detail.0.0&amp;is_story_h5=false&amp;mid=zqernykrmpf7XfIorMR%2FnA%3D%3D&amp;plat_id=116&amp;share_from=ugc&amp;share_medium=android&amp;share_plat=android&amp;share_session_id=ce0bc526-db69-428a-962e-c65ed8c267bc&amp;share_source=COPY&amp;share_tag=s_i&amp;spmid=united.player-video-detail.0.0&amp;timestamp=1713085655&amp;unique_k=DfBgvFW&amp;up_id=8654113&amp;vd_source=e035e9878d32f414b4354b839a4c31a4\" rel=\"noopener nofollow\" target=\"_blank\">[双语字幕]吴恩达深度学习deeplearning.ai</a></li>\n<li>github课程资料，含课件与笔记:<a href=\"https://github.com/robbertliu/deeplearning.ai-andrewNG\" rel=\"noopener nofollow\" target=\"_blank\">吴恩达深度学习教学资料</a></li>\n<li>课程配套练习（中英）与答案：<a href=\"https://blog.csdn.net/u013733326/article/details/79827273\" rel=\"noopener nofollow\" target=\"_blank\">吴恩达深度学习课后习题与答案</a></li>\n</ol>\n<p>本篇为第五课的第二周内容，<a href=\"https://www.bilibili.com/video/BV1FT4y1E74V?spm_id_from=333.788.videopod.episodes&amp;vd_source=e035e9878d32f414b4354b839a4c31a4&amp;p=166\" rel=\"noopener nofollow\" target=\"_blank\">2.4</a>到<a href=\"https://www.bilibili.com/video/BV1FT4y1E74V?spm_id_from=333.788.videopod.episodes&amp;vd_source=e035e9878d32f414b4354b839a4c31a4&amp;p=167\" rel=\"noopener nofollow\" target=\"_blank\">2.5</a>的内容以及一些相关知识的补充。</p>\n<hr />\n<p>本周为第五课的第二周内容，与 CV 相对应的，这一课所有内容的中心只有一个：<strong>自然语言处理（Natural Language Processing，NLP）</strong>。<br />\n应用在深度学习里，它是专门用来进行<strong>文本与序列信息建模</strong>的模型和技术，本质上是在全连接网络与统计语言模型基础上的一次“结构化特化”，也是人工智能中<strong>最贴近人类思维表达方式</strong>的重要研究方向之一。<br />\n<strong>这一整节课同样涉及大量需要反复消化的内容，横跨机器学习、概率统计、线性代数以及语言学直觉。</strong><br />\n语言不像图像那样“直观可见”，更多是抽象符号与上下文关系的组合，因此<strong>理解门槛反而更高</strong>。<br />\n因此，我同样会尽量补足必要的背景知识，尽可能用比喻和实例降低理解难度。<br />\n本周的内容关于词嵌入，是一种<strong>相对于独热编码，更能保留语义信息的文本编码方式</strong>。通过词嵌入，模型不再只是“记住”词本身，而是能够<strong>基于语义关系进行泛化</strong>，在一定程度上实现类似“<strong>举一反三</strong>”的效果。词嵌入是 NLP 领域中最重要的基础技术之一。</p>\n<p>本篇的内容关于<strong>词嵌入模型原理</strong>，是了解基础内容后的下一步引入。</p>\n<h1 id=\"1-词嵌入矩阵\">1. 词嵌入矩阵</h1>\n<p>在<a href=\"https://www.cnblogs.com/Goblinscholar/p/19494158\" target=\"_blank\">上一篇</a>中，我们知道通过词嵌入可以实现词汇的特征化表示，这种序列信息编码方式相比独热编码不仅节约了存储和时间成本，而且可以量化词汇的语义来提升模型性能。<br />\n那么要如何训练一个可以输出对词汇合适编码的词嵌入模型呢？<br />\n实际上，词嵌入模型的原理和我们之前介绍过的<a href=\"https://www.cnblogs.com/Goblinscholar/p/19423276\" target=\"_blank\">图像风格转换</a>有些类似，就像其首先要随机初始化目标图像一样，词嵌入模型的第一步，并不是“理解语义”，而是<strong>先给每个词一个可以被学习的数值载体</strong>。<br />\n具体来说是这样的：<br />\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260119203403821-212247932.png\" /></p>\n<p>如图所示，假设我们的词表大小为 <span class=\"math inline\">\\(|V|\\)</span>，词向量维度设为 <span class=\"math inline\">\\(d\\)</span>，那么词嵌入本质上就是一个矩阵，每一行对应词表中的一个词，我们称之为<strong>词嵌入矩阵</strong>。</p>\n<p></p><div class=\"math display\">\\[\\mathbf{E}\n=\n\\begin{bmatrix}\nv_{1,1} &amp; v_{1,2} &amp; v_{1,3} &amp; \\cdots &amp; v_{1,d} \\\\\nv_{2,1} &amp; v_{2,2} &amp; v_{2,3} &amp; \\cdots &amp; v_{2,d} \\\\\nv_{3,1} &amp; v_{3,2} &amp; v_{3,3} &amp; \\cdots &amp; v_{3,d} \\\\\n\\vdots  &amp; \\vdots  &amp; \\vdots  &amp; \\ddots &amp; \\vdots  \\\\\nv_{|V|,1} &amp; v_{|V|,2} &amp; v_{|V|,3} &amp; \\cdots &amp; v_{|V|,d}\n\\end{bmatrix}\n\\]</div><p></p><p>这里需要强调的是，在课程中，吴恩达老师常在词嵌入矩阵中使用列向量来表示词向量，以匹配矩阵乘法的约定。但在实际工程代码中，通常视作行向量（矩阵行对应词向量）。<strong>这只是约定问题</strong>，取决于实现方式：教学中列向量便于公式推导，代码中行向量更高效。了解后，根据场景选择即可。<br />\n回到正题，在模型初始化阶段，词嵌入矩阵<strong>并不包含任何语义信息</strong>，通常采用随机初始化，或者服从均值为 0 的正态分布。<br />\n我们之前就说过，词向量并不是我们手工设定的，而是在模型学习得到的，在我们完成词嵌入矩阵的初始化后，<strong>词嵌入模型的目的就是不断传播和优化词嵌入矩阵，得到对语义编码合理的词向量</strong>，从而进行下一步应用。</p>\n<p>到这里就会发现，学习词嵌入矩阵的过程和图像风格转换的过程非常相似：一开始是随机噪声，但在损失函数的约束下，逐步学习得到结构化、有意义的结果。</p>\n<p>在完成词嵌入矩阵的初始化后，<strong>模型训练的核心任务就是设计合理的上下文预测目标，让矩阵中每一行（词向量）逐步调整位置，从而携带语义信息。</strong></p>\n<h1 id=\"2-早期词嵌入模型\">2. 早期词嵌入模型</h1>\n<p>在 2003 年，一篇论文 <a href=\"https://www.jmlr.org/papers/volume3/bengio03a/bengio03a.pdf\" rel=\"noopener nofollow\" target=\"_blank\">A Neural Probabilistic Language Model</a>，首次展示了一个神经网络语言模型，它不仅预测下一个词的概率分布，还通过一个嵌入层将词索引映射为实值向量。这些向量成为了词的稠密表示，也就是我们今天所说的<strong>词嵌入（word embeddings）</strong>。<br />\n尽管当时论文中并没有直接使用“word embedding”这个术语，但其核心思想：<strong>通过神经网络学习词的分布式向量表示</strong>——正是现代词嵌入模型的理论源头。</p>\n<h2 id=\"21-词嵌入模型原理\">2.1 词嵌入模型原理</h2>\n<p>这一部分我们展开一下，用早期的模型介绍一下最经典的一类词嵌入模型：<strong>预测型词嵌入模型</strong>的基本逻辑：<br />\n<img alt=\"image.png\" src=\"https://img2024.cnblogs.com/blog/3708248/202601/3708248-20260119202257923-2120601282.png\" /><br />\n图中简要描述了该模型的传播逻辑，补充一些细节如下：</p>\n<ol>\n<li><strong>嵌入层（Embedding Layer）</strong>：在图中的左半部分，完成的是<strong>存储词嵌入矩阵和根据索引查找机制提取词向量</strong>的工作，我们称完成这部分内容的结构为<strong>嵌入层</strong>。</li>\n<li><strong>窗口大小 <span class=\"math inline\">\\(t\\)</span></strong>：这是一个超参数，当预测序列中第 <span class=\"math inline\">\\(n\\)</span> 个词汇时，我们使用其之前 <span class=\"math inline\">\\(t\\)</span> 个词汇作为序列信息。<strong>在现代，前文如果不足 <span class=\"math inline\">\\(t\\)</span> 个，则会使用特殊符号填充。</strong></li>\n<li><strong>联合更新</strong>：在反向传播过程中，<strong>嵌入层和网络的其他参数同时更新</strong>。这意味着每次看到训练样本，嵌入矩阵中涉及的<strong>词向量会和网络参数一起沿梯度方向调整</strong>，使其更有利于下一个词的预测。</li>\n</ol>\n<p>那词向量具体是怎么更新来学习语义的呢？我们展开说说：</p>\n<h2 id=\"22-词向量的语义学习\">2.2 词向量的语义学习</h2>\n<p>举个例子来理解一下词向量的更新逻辑：<br />\n假设训练语料中出现了许多关于水果的句子，比如：</p>\n<pre><code>I like to eat apple.\nShe bought a banana yesterday.\nOrange juice is tasty.\n</code></pre>\n<p>现在，模型的任务是<strong>根据上下文预测下一个词</strong>。当看到句子 <code>\"I like to eat apple\"</code> 时，模型会预测下一个词可能是 <code>\"apple\"</code>。<br />\n这时，反向传播时，模型会调整 <strong>“apple”对应的词向量</strong>以及上下文中其他词的向量，使得网络更容易正确预测 <code>\"apple\"</code>。</p>\n<p>同理，当训练样本中出现 <code>\"banana\"</code> 或 <code>\"orange\"</code> 时，这些词的向量也会因为相似的上下文而被调整到<strong>相互靠近的位置</strong>：<code>\"apple\"</code>, <code>\"banana\"</code>, <code>\"orange\"</code> <strong>这些同类型的词常出现在类似的上下文</strong>（如 eat、juice、like 等）<br />\n最终模型通过梯度更新，让这些词向量在向量空间中<strong>彼此靠近</strong>，从而自然捕捉到语义相似性。</p>\n<p>这样的效果就是：即使模型从未显式告知“它们都是水果”，词向量也会因为上下文模式相似而自动聚集在一起，形成<strong>语义簇（semantic cluster）</strong>，即向量空间中，语义相近的词自然聚在一起形成的群体。<br />\n这时，面对下面这两句话：</p>\n<pre><code>训练：I like orange juice.\n测试：I love apple _____. \n</code></pre>\n<p>模型即使<strong>没见过测试语句，也可以通过<code>\"love 和 like\"</code>、<code>\"apple 和 orange\"</code> 在向量空间的距离相近得到更可靠的答案，从而提高模型性能。</strong></p>\n<p>用一句话总结一下：<strong>同类型的词汇往往出现在相似的上下文中，因此在更新后更加相似，最终在向量空间中形成语义簇，极大增强了模型的泛化能力。</strong></p>\n<p>你会发现，<strong>在词嵌入模型中，词向量的语义结构并不是显式教给模型的，而是在上下文预测任务中自然而然学到的，模型并没有专门去“训练合适编码”，而是在预测中让相似的词不断靠近。</strong><br />\n同样是对数据进行编码，词嵌入和我们之前介绍的<a href=\"https://www.cnblogs.com/Goblinscholar/p/19418306\" target=\"_blank\">人脸识别</a>又有所不同。</p>\n<p>当然，既然是早期模型，自然有值得优化的地方，我们继续：</p>\n<h2 id=\"23-早期词嵌入模型的局限\">2.3 早期词嵌入模型的局限</h2>\n<p>尽管 A Neural Probabilistic Language Model 成功提出了通过神经网络学习词向量的思路，但作为早期模型，它在实际应用和理论上存在一些明显的局限性：</p>\n<table>\n<thead>\n<tr>\n<th>局限类别</th>\n<th>具体说明</th>\n<th>影响</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>计算开销大</strong></td>\n<td>输入是 <span class=\"math inline\">\\(t\\)</span> 个词独热向量拼接，输出是词表大小 <span class=\"math inline\">\\(V\\)</span> 的 softmax</td>\n<td>词表大时计算量高，训练预测速度慢</td>\n</tr>\n<tr>\n<td><strong>上下文窗口固定</strong></td>\n<td>每次预测只使用前 <span class=\"math inline\">\\(t\\)</span> 个词</td>\n<td>无法捕捉长距离依赖，语义建模受限</td>\n</tr>\n<tr>\n<td><strong>梯度更新效率低</strong></td>\n<td>嵌入矩阵和网络参数同时更新，每个样本只涉及部分词向量</td>\n<td>收敛慢，低频词向量质量不稳定</td>\n</tr>\n<tr>\n<td><strong>没有显式建模语义规律</strong></td>\n<td>语义相似性完全依赖上下文共现</td>\n<td>稀有词或低频词向量质量差，泛化能力有限，无法处理多义词</td>\n</tr>\n</tbody>\n</table>\n<p>因此，为了解决这些问题，自然有人发明新的技术和模型，我们在之后几篇就来详细介绍这些内容。</p>\n<h1 id=\"3-总结\">3. 总结</h1>\n<table>\n<thead>\n<tr>\n<th>概念</th>\n<th>原理</th>\n<th>比喻</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>词嵌入矩阵（Embedding Matrix）</strong></td>\n<td>将词表中每个词映射为可学习的稠密向量，矩阵行（或列）对应词向量。初始化随机或正态分布，通过梯度更新学习语义信息。</td>\n<td>类似图像风格转换中的“随机噪声图像”，逐步在训练中形成结构化图像。</td>\n</tr>\n<tr>\n<td><strong>嵌入层（Embedding Layer）</strong></td>\n<td>存储词嵌入矩阵并提供索引查找功能，将词索引映射为词向量。</td>\n<td>就像一本“词向量字典”，根据索引直接查到对应的向量。</td>\n</tr>\n<tr>\n<td><strong>上下文预测训练</strong></td>\n<td>利用前 <span class=\"math inline\">\\(t\\)</span> 个词预测下一个词，通过反向传播更新嵌入矩阵和网络参数，使语义相似的词向量靠近。</td>\n<td>好比让水果类词（apple, banana, orange）在向量空间里自然聚成一簇，通过相似上下文学习它们的关系。</td>\n</tr>\n<tr>\n<td><strong>语义簇（Semantic Cluster）</strong></td>\n<td>在向量空间中，语义相近的词自然聚集，捕捉词汇之间的语义关系。</td>\n<td>词向量像朋友一样，常在同一圈子（上下文）出现就靠近在一起。</td>\n</tr>\n<tr>\n<td><strong>早期词嵌入模型局限</strong></td>\n<td>计算开销大（softmax over 大词表）上下文窗口固定、 梯度更新效率低 、无显式语义建模（如多义词）。</td>\n<td>模型像老式拼字游戏，效率低且只能看到局部信息，难以捕捉远距离或复杂规律。</td>\n</tr>\n</tbody>\n</table>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-19 20:35</span>&nbsp;\n<a href=\"https://www.cnblogs.com/Goblinscholar\">哥布林学者</a>&nbsp;\n阅读(<span id=\"post_view_count\">24</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "使用 AI 编程工具的一点实践体会：为什么要减少对话轮次、一次把需求说清楚",
      "link": "https://www.cnblogs.com/YpEng-Codeme/p/19503631",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/YpEng-Codeme/p/19503631\" id=\"cb_post_title_url\" title=\"发布于 2026-01-19 20:25\">\n    <span>使用 AI 编程工具的一点实践体会：为什么要减少对话轮次、一次把需求说清楚</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        在使用 Cursor、ChatGPT 等 AI 编程工具的过程中，我逐渐意识到：\n相比多轮对话不断修补需求，用更少的对话轮次一次性描述清楚核心需求，\n反而更容易得到符合预期的实现。\n本文结合实际使用经验，分析了对话轮次过多导致结果偏离的原因，\n以及在什么情况下应当重新编辑问题而不是继续对话修补。\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"使用-ai-编程工具的一点实践体会为什么要减少对话轮次一次把需求说清楚\">使用 AI 编程工具的一点实践体会：为什么要减少对话轮次、一次把需求说清楚</h1>\n<h2 id=\"一背景\">一、背景</h2>\n<p>随着 Cursor、Copilot、ChatGPT 等 AI 编程工具在日常开发中的普及，<br />\n越来越多的开发者开始尝试用 AI 来完成：</p>\n<ul>\n<li>单个功能模块</li>\n<li>小型系统原型</li>\n<li>重复性或模板化代码</li>\n</ul>\n<p>我自己在实际使用这些工具的过程中，也逐渐形成了一些使用习惯。<br />\n其中<strong>最重要的一点体会是：</strong></p>\n<blockquote>\n<p><strong>在让 AI 写代码时，应尽量减少对话轮次，用尽可能清晰、完整的描述一次性说明核心需求。</strong></p>\n</blockquote>\n<p>这篇文章主要记录我在实践中总结出的原因、经验以及适用边界。</p>\n<hr />\n<h2 id=\"二常见的错误使用方式\">二、常见的错误使用方式</h2>\n<p>在刚开始使用 AI 编程工具时，我（以及身边不少同事）都会下意识采用类似下面的方式：</p>\n<ol>\n<li>先描述一个比较模糊的需求</li>\n<li>看 AI 生成的代码</li>\n<li>发现不符合预期</li>\n<li>继续在当前对话中补充或修改需求</li>\n<li>重复上述过程</li>\n</ol>\n<p>这种方式在<strong>简单问题</strong>上通常没什么问题，<br />\n但在以下场景中，很容易出现偏差：</p>\n<ul>\n<li>模块之间存在关联</li>\n<li>功能有前后依赖关系</li>\n<li>有较多隐含约束（性能、扩展性、结构等）</li>\n</ul>\n<p>最终结果往往是：</p>\n<blockquote>\n<p><strong>代码越来越“补丁化”，整体实现逐渐偏离最初的目标。</strong></p>\n</blockquote>\n<hr />\n<h2 id=\"三为什么对话轮次越多结果越容易偏离\">三、为什么对话轮次越多，结果越容易偏离？</h2>\n<h3 id=\"31-模型理解是上下文驱动的\">3.1 模型理解是“上下文驱动”的</h3>\n<p>AI 模型并不是像人一样“始终记得最初的目标”，而是：</p>\n<ul>\n<li>基于当前上下文进行概率推断</li>\n<li>更倾向于满足<strong>最近一轮对话中的显式要求</strong></li>\n</ul>\n<p>当我们不断追加新指令时：</p>\n<ul>\n<li>新需求可能与旧需求存在隐性冲突</li>\n<li>模型会尝试“局部修补”，而不是整体重构</li>\n</ul>\n<p>久而久之，最初的设计目标就会被逐渐稀释。</p>\n<hr />\n<h3 id=\"32-人在补充需求时往往是局部视角\">3.2 人在补充需求时，往往是“局部视角”</h3>\n<p>在多轮对话中，人通常是在<strong>针对当前不满意的点进行修正</strong>，例如：</p>\n<ul>\n<li>“这里能不能换成异步？”</li>\n<li>“这个字段我不想要了”</li>\n<li>“这个函数再加一个参数”</li>\n</ul>\n<p>但问题在于：</p>\n<ul>\n<li>这些修改<strong>可能影响其它模块</strong></li>\n<li>AI 并不知道你是否接受连带变化</li>\n<li>你自己也未必在当下考虑到了所有影响</li>\n</ul>\n<p>最终就会出现：</p>\n<ul>\n<li>功能能跑</li>\n<li>结构却越来越奇怪</li>\n</ul>\n<hr />\n<h3 id=\"33-模型限制--问题拆解方式的叠加效应\">3.3 模型限制 + 问题拆解方式的叠加效应</h3>\n<p>偏离预期，往往不是单一原因造成的，而是：</p>\n<ul>\n<li>模型在长对话中的抽象能力下降</li>\n<li>人在提问时逐渐变成“修 bug 式提问”</li>\n<li>缺乏一次“全局视角”的重新校准</li>\n</ul>\n<p>这三点叠加在一起，就很容易让结果走偏。</p>\n<hr />\n<h2 id=\"四更推荐的使用方式少轮次--高质量输入\">四、更推荐的使用方式：少轮次 + 高质量输入</h2>\n<h3 id=\"41-一次性描述清楚核心需求\">4.1 一次性描述清楚“核心需求”</h3>\n<p>这里说的“一次性”，并不是要求把所有细节都写死，而是至少要说明清楚：</p>\n<ul>\n<li>这个模块/系统<strong>要解决什么问题</strong></li>\n<li>有哪些核心功能</li>\n<li>功能之间是否有关联</li>\n<li>哪些点是<strong>不能随意改动的约束</strong></li>\n</ul>\n<p>示例思路：</p>\n<pre><code class=\"language-text\">我要实现一个 XXX 系统，主要包含 A / B / C 三个功能。\n其中：\n- A 和 B 之间存在依赖关系\n- C 的实现不能影响 A 的调用方式\n- 性能优先级高于代码简洁性\n</code></pre>\n<hr />\n<h3 id=\"42-接受非核心问题的逐步优化\">4.2 接受“非核心问题”的逐步优化</h3>\n<p>在一次高质量描述后，AI 生成的结果通常会：</p>\n<ul>\n<li>核心结构基本正确</li>\n<li>功能逻辑大体符合预期</li>\n<li>细节上存在一些小问题</li>\n</ul>\n<p>这些小问题通常包括：</p>\n<ul>\n<li>命名不够优雅</li>\n<li>局部代码不够简洁</li>\n<li>样式或美观问题</li>\n</ul>\n<p>👉 <strong>这些问题是适合通过“少量追加对话”来优化的。</strong></p>\n<hr />\n<h2 id=\"五什么时候应该停止对话重新编辑问题\">五、什么时候应该“停止对话，重新编辑问题”？</h2>\n<p>这是一个非常关键的判断点。</p>\n<h3 id=\"51-明确应该重来的一些信号\">5.1 明确应该重来的一些信号</h3>\n<p>如果出现以下情况之一，<strong>强烈建议重新编辑需求，而不是继续对话修补</strong>：</p>\n<ul>\n<li>新需求会影响多个已有功能</li>\n<li>修改一个功能，会连带影响其它模块</li>\n<li>你发现自己在“打补丁”而不是在设计</li>\n<li>你已经很难用一句话说明当前代码结构</li>\n</ul>\n<p>此时继续对话，大概率只会让问题更复杂。</p>\n<hr />\n<h3 id=\"52-正确的做法\">5.2 正确的做法</h3>\n<p>更好的方式是：</p>\n<ol>\n<li>停止当前对话</li>\n<li>回顾当前代码和真实需求</li>\n<li>在<strong>新的对话中重新整理描述</strong></li>\n<li>把之前暴露出的缺陷明确写进去</li>\n</ol>\n<p>例如：</p>\n<pre><code class=\"language-text\">在之前的实现中，我发现 A 和 B 的设计存在耦合问题。\n这次希望：\n- 明确拆分 A / B 的职责\n- 保证后续扩展 C 功能时不需要修改 A\n</code></pre>\n<hr />\n<h2 id=\"六关于一次性描述和灵活调整的平衡\">六、关于“一次性描述”和“灵活调整”的平衡</h2>\n<p>需要强调的是：</p>\n<blockquote>\n<p><strong>减少对话轮次 ≠ 一次性把一切写到极致完美</strong></p>\n</blockquote>\n<p>更合理的平衡是：</p>\n<ul>\n<li>核心设计、关键约束：一次说明清楚</li>\n<li>非核心细节、体验优化：允许少量调整</li>\n<li>结构性缺陷、系统性问题：直接重来</li>\n</ul>\n<p>把 AI 当成一个：</p>\n<blockquote>\n<p><strong>执行能力很强，但不具备全局自省能力的助手</strong></p>\n</blockquote>\n<p>而不是一个会自动“帮你纠偏”的高级工程师。</p>\n<hr />\n<h2 id=\"七总结\">七、总结</h2>\n<p>结合自己的实际使用经验，我目前形成的结论是：</p>\n<ol>\n<li>AI 编程工具非常依赖输入质量</li>\n<li>对话轮次越多，越容易偏离最初目标</li>\n<li>核心问题应一次性描述清楚</li>\n<li>结构性问题不要通过“补丁式对话”修复</li>\n<li>重新编辑问题，往往比继续对话更高效</li>\n</ol>\n<p>后续我也会结合具体案例（包括错误示范和正确示范）进一步补充说明。</p>\n<hr />\n<blockquote>\n<p><strong>这篇文章并不是否定多轮对话的价值，而是希望在合适的场景下，用更合理的方式使用 AI。</strong></p>\n</blockquote>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-19 20:25</span>&nbsp;\n<a href=\"https://www.cnblogs.com/YpEng-Codeme\">YounGp_oo</a>&nbsp;\n阅读(<span id=\"post_view_count\">73</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "WebDataset使用指南：构建高效深度学习数据管道",
      "link": "https://www.cnblogs.com/aurora-zzm/p/19503592/webdataset_usage",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/aurora-zzm/p/19503592/webdataset_usage\" id=\"cb_post_title_url\" title=\"发布于 2026-01-19 20:04\">\n    <span>WebDataset使用指南：构建高效深度学习数据管道</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<blockquote>\n<p>在深度学习项目实践中，数据加载往往成为限制训练速度的关键瓶颈。当数据集规模达到数百万甚至数十亿样本时，传统的文件系统随机访问方式会导致I/O效率急剧下降，让昂贵的GPU资源处于闲置等待状态。WebDataset通过<strong>流式处理</strong>和<strong>顺序读取</strong>的设计理念，可以极大提升数据加载性能。</p>\n</blockquote>\n<h2 id=\"什么是webdataset\">什么是WebDataset？</h2>\n<p>WebDataset是一个基于TAR归档格式的深度学习数据加载库，专为处理超大规模数据集而设计。其核心思想是将<strong>大量小文件打包成较大的TAR文件</strong>，通过顺序读取替代随机访问，极大提升I/O效率。</p>\n<p>本质上，<em><strong>wds格式文件就是遵循了额外约定的tar文件，并且一般不压缩，使得可以实现流式读取。</strong></em></p>\n<h3 id=\"与传统方式的对比\">与传统方式的对比</h3>\n<table>\n<thead>\n<tr>\n<th>特性</th>\n<th>传统文件系统</th>\n<th>WebDataset</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>访问模式</strong></td>\n<td>随机访问，高延迟</td>\n<td>顺序读取，高吞吐</td>\n</tr>\n<tr>\n<td><strong>存储效率</strong></td>\n<td>文件系统元数据开销大</td>\n<td>TAR容器减少元数据</td>\n</tr>\n<tr>\n<td><strong>分布式支持</strong></td>\n<td>需要复杂协调机制</td>\n<td>天然支持分片和数据并行</td>\n</tr>\n<tr>\n<td><strong>网络传输</strong></td>\n<td>小文件传输效率低</td>\n<td>大文件流式传输</td>\n</tr>\n<tr>\n<td><strong>使用便捷性</strong></td>\n<td>需要解压和预处理</td>\n<td>直接读取，无需解压</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"webdataset的核心原理\">WebDataset的核心原理</h2>\n<h3 id=\"顺序读取的优势\">顺序读取的优势</h3>\n<p>传统深度学习数据集由数百万个小文件组成，训练时需要随机访问这些文件。机械硬盘的随机读取速度通常只有顺序读取的1/100，即使固态硬盘也存在明显差距。WebDataset通过将相关文件打包成TAR归档，将随机I/O转换为顺序I/O，充分利用现代存储系统的吞吐能力。</p>\n<h3 id=\"分片机制\">分片机制</h3>\n<p>WebDataset将大数据集分割为多个TAR文件（分片），每个分片包含数千个样本。这种设计带来多重好处：</p>\n<ul>\n<li><strong>并行加载</strong>：不同分片可由不同工作进程并行读取</li>\n<li><strong>分布式训练</strong>：每个训练节点可处理不同的分片子集</li>\n<li><strong>容错性</strong>：单个分片损坏不影响整个数据集</li>\n</ul>\n<h3 id=\"样本组织规范\">样本组织规范</h3>\n<p>WebDataset遵循严格的命名约定：<em><strong>同一样本的所有文件共享相同的前缀key，通过扩展名区分数据类型。</strong></em></p>\n<blockquote>\n<p>前缀key：tar文件内部，某个文件的路径的第一个句点之前的部分</p>\n</blockquote>\n<p>文件可以有多个后缀，甚至没有后缀（这样在字典中的键就是空字符）；而且相同前缀key的（同一样本中的）文件数量可以不固定。<br />\n示例TAR文件内容结构：</p>\n<pre><code>images17/image194.left.jpg  \nimages17/image194.right.jpg  \nimages17/image194.json  \nimages17/image12.left.jpg  \nimages17/image12.json  \nimages3/image14  \n</code></pre>\n<p>读取之后，会得到像这样的字典</p>\n<pre><code class=\"language-python\">[\n{ “__key__”: “images17/image194”, “left.jpg”: b”...”, “right.jpg”: b”...”, “json”: b”...”}  \n{ “__key__”: “images17/image12”, “left.jpg”: b”...”, “json”: b”...”}  \n{ “__key__”: “images3/image14”, “”: b””}  \n]\n</code></pre>\n<h2 id=\"创建webdataset格式数据集\">创建WebDataset格式数据集</h2>\n<h3 id=\"使用tarwriter-api\">使用TarWriter API</h3>\n<pre><code class=\"language-python\">import webdataset as wds\nimport json\n\ndef create_webdataset(output_path, samples):\n    \"\"\"创建WebDataset格式数据集\"\"\"\n    with wds.TarWriter(output_path) as sink:\n        for i, (image_data, label, metadata) in enumerate(samples):\n            sink.write({\n                \"__key__\": f\"sample{i:06d}\",      # 样本唯一标识\n                \"jpg\": image_data,               # 图像数据（字节格式）\n                \"cls\": str(label).encode(),      # 类别标签\n                \"json\": json.dumps(metadata).encode()  # 元数据\n            })\n</code></pre>\n<h2 id=\"读取和处理webdataset数据集\">读取和处理WebDataset数据集</h2>\n<h3 id=\"基础数据管道\">基础数据管道</h3>\n<pre><code class=\"language-python\">import webdataset as wds\nimport torch\nfrom torchvision import transforms\n\n# 定义数据预处理\npreprocess = transforms.Compose([\n    transforms.RandomResizedCrop(224),\n    transforms.RandomHorizontalFlip(),\n    transforms.ToTensor(),\n    transforms.Normalize(mean=[0.485, 0.456, 0.406], \n                         std=[0.229, 0.224, 0.225])\n])\n\n# 创建WebDataset数据管道\ndataset = (wds.WebDataset(\"dataset-{000000..000099}.tar\")  # 100个分片\n    .shuffle(1000)                    # 样本级打乱\n    .decode(\"pil\")                    # 解码为PIL图像\n    .to_tuple(\"jpg\", \"cls\")           # 提取图像和标签\n    .map_tuple(preprocess, lambda x: int(x))  # 应用预处理\n    .batched(32)                      # 批处理\n\t)\n\n# 创建DataLoader\ndataloader = torch.utils.data.DataLoader(\n    dataset, \n    batch_size=None,  # 批处理已在管道中完成\n    num_workers=4\n)\n</code></pre>\n<h3 id=\"高级数据处理技巧\">高级数据处理技巧</h3>\n<p>WebDataset支持复杂的数据处理管道，包括多模态数据融合和动态增强：</p>\n<pre><code class=\"language-python\">def create_advanced_pipeline():\n    \"\"\"创建高级数据处理管道\"\"\"\n    \n    # 图像增强\n    image_augmentation = transforms.Compose([\n        transforms.RandomChoice([\n            transforms.ColorJitter(brightness=0.2, contrast=0.2),\n            transforms.GaussianBlur(3),\n            transforms.RandomAffine(degrees=15, scale=(0.9, 1.1))\n        ]),\n        transforms.RandomHorizontalFlip(),\n    ])\n    \n    # 文本预处理\n    def text_preprocessing(text_bytes):\n        text = text_bytes.decode(\"utf-8\").lower().strip()\n        # 应用文本清洗和分词逻辑\n        return text\n    \n    dataset = (wds.WebDataset(\"multimodal-{000000..000050}.tar\")\n        .shuffle(5000)  # 大缓冲区提高随机性\n        .decode(\"pil\", handler=wds.warn_and_continue)  # 错误处理\n        .rename(image=\"jpg;png;jpeg\", text=\"txt;json\", caption=\"caption;text\")\n        .map_dict(  # 对不同字段应用不同处理\n            image=image_augmentation,\n            text=text_preprocessing,\n            caption=text_preprocessing\n        )\n        .to_tuple(\"image\", \"text\", \"caption\")  # 多模态输出\n        .batched(16, partial=False)  # 精确批大小控制\n    )\n    \n    return dataset\n</code></pre>\n<h2 id=\"分布式训练集成\">分布式训练集成</h2>\n<h3 id=\"单机多gpu训练\">单机多GPU训练</h3>\n<pre><code class=\"language-python\">import webdataset as wds\nimport torch.distributed as dist\n\ndef setup_distributed_training():\n    \"\"\"设置分布式训练环境\"\"\"\n    \n    # 初始化进程组\n    dist.init_process_group(backend=\"nccl\")\n    local_rank = int(os.environ[\"LOCAL_RANK\"])\n    world_size = dist.get_world_size()\n    \n    # 根据rank配置设备\n    torch.cuda.set_device(local_rank)\n    \n    return local_rank, world_size\n\ndef create_distributed_loader(url_pattern, batch_size=32):\n    \"\"\"创建分布式数据加载器\"\"\"\n    \n    local_rank, world_size = setup_distributed_training()\n    \n    dataset = (wds.WebDataset(\n            url_pattern, \n            resampled=True,  # 启用重采样以支持无限数据流\n            nodesplitter=wds.split_by_node,\n            splitter=wds.split_by_worker\n        )\n        .shuffle(1000)\n        .decode(\"pil\")\n        .to_tuple(\"jpg\", \"cls\")\n        .batched(batch_size)\n    )\n    \n    loader = wds.WebLoader(\n        dataset,\n        batch_size=None,\n        num_workers=4,\n        shuffle=False  # 打乱已在数据管道中处理\n    )\n    \n    # 设置epoch长度\n    loader = loader.with_epoch(10000)  # 每个epoch处理10000个批次\n    \n    return loader\n</code></pre>\n<h3 id=\"多节点训练配置\">多节点训练配置</h3>\n<p>对于跨多个服务器的训练任务，WebDataset提供完整的多节点支持：</p>\n<pre><code class=\"language-python\">def multi_node_training_setup():\n    \"\"\"多节点训练配置\"\"\"\n    \n    dataset = (wds.WebDataset(\"dataset-{000000..012345}.tar\")\n        .shuffle(10000)\n        .decode(\"torchrgb\")  # 直接解码为PyTorch张量\n        .split_by_node  # 自动按节点分割数据\n        .split_by_worker  # 按工作进程分割\n        .to_tuple(\"image\", \"label\")\n        .batched(64)\n    )\n    \n    # 使用WebLoader优化性能\n    loader = wds.WebLoader(\n        dataset,\n        batch_size=None,\n        num_workers=8,\n        persistent_workers=True  # 保持工作进程活跃\n    )\n    \n    return loader\n</code></pre>\n<h2 id=\"性能优化最佳实践\">性能优化最佳实践</h2>\n<h3 id=\"分片策略优化\">分片策略优化</h3>\n<p>分片大小对性能有显著影响，建议根据存储类型选择：</p>\n<ul>\n<li><strong>本地硬盘</strong>：256MB-1GB/分片</li>\n<li><strong>网络存储</strong>：1-4GB/分片</li>\n<li><strong>云对象存储</strong>：4-16GB/分片</li>\n</ul>\n<pre><code class=\"language-python\">def optimize_shard_size(base_url, target_size_mb=1024):\n    \"\"\"根据目标大小优化分片策略\"\"\"\n    # 计算样本平均大小\n    sample_size = estimate_average_sample_size()\n    samples_per_shard = (target_size_mb * 1024 * 1024) // sample_size\n    \n    return f\"{base_url}-{{000000..999999}}.tar\", samples_per_shard\n</code></pre>\n<h3 id=\"缓存策略\">缓存策略</h3>\n<p>对于远程数据集，使用缓存可以显著减少网络传输：</p>\n<pre><code class=\"language-python\">dataset = (wds.WebDataset(\"https://example.com/dataset-{000000..000999}.tar\")\n    .cache_dir(\"./cache\")  # 本地缓存目录\n    .cache_size(10 * 1024 ** 3)  # 10GB缓存大小\n    .shuffle(10000)\n    .decode(\"pil\")\n)\n</code></pre>\n<h3 id=\"内存优化技巧\">内存优化技巧</h3>\n<p>处理超大图像或视频时，使用流式解码避免内存溢出：</p>\n<pre><code class=\"language-python\">def streamed_video_processing():\n    \"\"\"流式视频处理避免内存溢出\"\"\"\n    \n    dataset = (wds.WebDataset(\"video-dataset.tar\")\n        .shuffle(100)\n        .decode(\"rgb8\", handler=wds.ignore_and_continue)  # 流式解码\n        .map(video_frame_sampling)  # 帧采样\n        .slice(0, 100)  # 限制序列长度\n        .batched(1)  # 视频批处理大小为1\n    )\n    \n    return dataset\n</code></pre>\n<h2 id=\"故障排除与调试\">故障排除与调试</h2>\n<h3 id=\"常见问题解决\">常见问题解决</h3>\n<ol>\n<li><strong>内存不足</strong>：减少批大小或使用流式解码</li>\n<li><strong>数据加载慢</strong>：增加分片大小或调整工作进程数</li>\n<li><strong>样本不匹配</strong>：检查TAR文件中同一样本的文件命名一致性</li>\n</ol>\n<h3 id=\"调试技巧\">调试技巧</h3>\n<pre><code class=\"language-python\"># 启用详细日志\nimport os\nos.environ[\"WDS_VERBOSE_CACHE\"] = \"1\"\nos.environ[\"GOPEN_VERBOSE\"] = \"1\"\n\n# 检查数据样本\ndataset = wds.WebDataset(\"dataset.tar\")\nfor sample in dataset.take(5):  # 只取前5个样本\n    print(\"Sample keys:\", list(sample.keys()))\n    for key, value in sample.items():\n        print(f\"{key}: {type(value)}, size: {len(value) if hasattr(value, '__len__') else 'N/A'}\")\n</code></pre>\n<h2 id=\"随机读取\">随机读取</h2>\n<p>虽然wds格式是为了流式读取而设计的，随机读取有些违背其使用理念，但是只能流式读取也有些不方便。比如当想随机查找第n个样本（比如bad case）时，随机读取还是更加方便快捷。<br />\n在安装官方的webdataset python库时，还会同步安装 wids 这个库，会可以帮助wds格式数据集实现随机读取。<a href=\"https://www.bing.com/ck/a?!&amp;&amp;p=8c306290ed0a41aeda3ad41f03f82846e4e663c8ea4b25152258d8546b6dc558JmltdHM9MTc2ODc4MDgwMA&amp;ptn=3&amp;ver=2&amp;hsh=4&amp;fclid=18e4bf87-a076-62ee-3329-aa52a19c6398&amp;u=a1aHR0cHM6Ly9weXBpLm9yZy9wcm9qZWN0L3dpZHMv&amp;ntb=1\" rel=\"noopener nofollow\" target=\"_blank\">wids · PyPI</a> 中给出了一个DEMO.</p>\n<p>但是如果可以获取样本所在tar文件路径和key，直接基于webdataset的接口读取也不会很慢，不应该使用wids；另外，我发现wids的相关资料很少，，很久都不更新了，官方好像也不在意这个功能，我自己尝试了一下感觉意义不大。</p>\n<h2 id=\"结论\">结论</h2>\n<p>WebDataset通过创新的流式数据加载范式，彻底解决了大规模深度学习训练中的数据I/O瓶颈。其核心优势在于：</p>\n<ol>\n<li><strong>卓越性能</strong>：顺序读取相比随机访问带来3-10倍的性能提升</li>\n<li><strong>分布式友好</strong>：天然支持多节点、多GPU训练场景</li>\n<li><strong>灵活性</strong>：支持任意数据类型和复杂的多模态场景</li>\n<li><strong>易用性</strong>：与PyTorch生态无缝集成，API设计简洁直观</li>\n</ol>\n<p>随着深度学习数据集规模的不断增长，WebDataset已成为处理TB级甚至PB级数据的标准工具。掌握WebDataset的使用技巧，对于构建高效、可扩展的深度学习系统至关重要。</p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-19 20:04</span>&nbsp;\n<a href=\"https://www.cnblogs.com/aurora-zzm\">一苇江湖</a>&nbsp;\n阅读(<span id=\"post_view_count\">25</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "AI新手入门：10分钟用Spring AI打造你的第一个智能心理咨询师",
      "link": "https://www.cnblogs.com/freshman118/p/19503473",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/freshman118/p/19503473\" id=\"cb_post_title_url\" title=\"发布于 2026-01-19 18:57\">\n    <span>AI新手入门：10分钟用Spring AI打造你的第一个智能心理咨询师</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>大家好！我是你们的 AI 技术向导。今天带来一篇超级实用的 Spring AI 上手教程，专为零基础的 AI 爱好者设计。无需高深技术背景，只需 10 分钟，你就能创建一个能对话的智能体！</p>\n<h2 id=\"什么是-spring-ai\">什么是 Spring AI？</h2>\n<p>Spring AI 是 Spring 生态中用于简化 AI 应用开发的框架，让开发者能轻松集成大语言模型。今天的 Demo 将基于阿里云的 DashScope 平台，创建一个专业的心理咨询师智能体。</p>\n<h2 id=\"环境准备\">环境准备</h2>\n<p>首先，我们需要创建一个 Spring 项目。推荐使用 IDEA 开发工具：</p>\n<ol>\n<li>打开 IDEA，选择新建 Spring 项目</li>\n</ol>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<ol>\n<li>设置 Spring Boot 版本以及依赖</li>\n</ol>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<ol>\n<li>项目创建成功后，进入下一步</li>\n</ol>\n<h2 id=\"添加关键依赖\">添加关键依赖</h2>\n<p>在项目的 pom.xml 文件中，添加以下两个核心依赖：</p>\n<pre><code class=\"language-xml\">&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.cloud.ai&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-ai-alibaba-agent-framework&lt;/artifactId&gt;\n    &lt;version&gt;1.1.0.0-M5&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.cloud.ai&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-ai-alibaba-starter-dashscope&lt;/artifactId&gt;\n    &lt;version&gt;1.1.0.0-M5&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>这两个依赖分别提供了智能体框架和 DashScope 模型的支持。</p>\n<h2 id=\"编写核心代码\">编写核心代码</h2>\n<p>在 com.jackson.aiagent 包下创建 AgentExample.java 文件：</p>\n<pre><code class=\"language-java\">package com.jackson.aiagent;\n\n// 导入必要的类\npublic class AgentExample {\n    public static void main(String[] args) throws Exception {\n        // 1. 创建模型实例（记得替换成你自己的API Key）\n        DashScopeApi dashScopeApi = DashScopeApi.builder()\n                .apiKey(\"sk-309xxxxxxxxxxxxxxxxxxxxxxxx\")\n                .build();\n        ChatModel chatModel = DashScopeChatModel.builder()\n                .dashScopeApi(dashScopeApi)\n                .build();\n\n        // 2. 创建智能体角色\n        ReactAgent agent = ReactAgent.builder()\n                .name(\"智能心理咨询师\")\n                .model(chatModel)\n                .instruction(\"你是一名10年经验的资深心理咨询师.\")\n                .build();\n\n        // 3. 与智能体对话\n        var response = agent.call(\"抑郁症有些什么症状？该如何缓解？\");\n        System.out.println(response.getText());\n    }\n}\n</code></pre>\n<h2 id=\"运行你的第一个-ai-智能体\">运行你的第一个 AI 智能体</h2>\n<p>代码编写完成后，直接运行 main 方法。你会看到控制台输出类似以下内容：</p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<h2 id=\"技术要点解析\">技术要点解析</h2>\n<ul>\n<li>​<strong>API Key 配置</strong>​：需要到 DashScope 平台申请自己的 API Key</li>\n<li>​<strong>智能体定制</strong>​：通过 instruction 参数定义智能体的专业背景</li>\n<li>​<strong>对话交互</strong>​：使用 call 方法即可与智能体进行对话</li>\n</ul>\n<h2 id=\"拓展思路\">拓展思路</h2>\n<p>这个 Demo 虽然简单，但已经包含了 AI 智能体的核心要素。你可以尝试：</p>\n<ul>\n<li>更换不同的专业角色（如法律顾问、编程助手等）</li>\n<li>设计更复杂的对话流程</li>\n<li>集成到 Web 应用中提供在线服务</li>\n</ul>\n<h2 id=\"总结\">总结</h2>\n<p>通过这个教程，我们见证了 Spring AI 的强大之处——用极简的代码实现智能对话功能。作为 AI 新手，这是一个完美的起点。未来你可以在此基础上探索更复杂的 AI 应用场景。</p>\n<p><strong>动手试试吧！</strong> 在评论区分享你的第一个智能体作品，遇到问题随时提问哦~</p>\n<hr />\n<p><em>本文基于技术文档整理，适合 AI 入门学习。实际开发中请参考官方最新文档。</em></p>\n<p>_Reference: _https://github.com/alibaba/spring-ai-alibaba</p>\n\n</div>\n<div id=\"MySignature\">\n    <p>本文来自博客园，作者：<a href=\"https://www.cnblogs.com/freshman118/\" target=\"_blank\">90后小陈老师</a>，转载请注明原文链接：<a href=\"https://www.cnblogs.com/freshman118/p/19503473\" target=\"_blank\">https://www.cnblogs.com/freshman118/p/19503473</a></p>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-19 18:57</span>&nbsp;\n<a href=\"https://www.cnblogs.com/freshman118\">90后小陈老师</a>&nbsp;\n阅读(<span id=\"post_view_count\">62</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "[python] python-docx-template模板化Word文档生成指北",
      "link": "https://www.cnblogs.com/luohenyueji/p/19503461",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/luohenyueji/p/19503461\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäºŽ 2026-01-19 18:51\">\n    <span>[python] python-docx-templateæ¨¡æ¿åŒ–Wordæ–‡æ¡£ç”ŸæˆæŒ‡åŒ—</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>python-docxåº“çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ç¨‹åºåŒ–åˆ›å»ºå…¨æ–°çš„Wordæ–‡æ¡£ï¼Œä½†åœ¨åŸºäºŽå·²æœ‰æ¨¡æ¿æ›¿æ¢å…¶éƒ¨åˆ†å†…å®¹æ—¶ï¼Œå…¶æ“ä½œä¼šéžå¸¸ç¹çã€‚ç”¨æˆ·éœ€è¦å…ˆè§£æžæ–‡æ¡£ç»“æž„ã€å®šä½å…·ä½“ä½ç½®ã€æ‰‹åŠ¨æ›¿æ¢å†…å®¹ï¼Œå¹¶ç»´æŠ¤åŽŸæœ‰æ ¼å¼ä¸Žå¸ƒå±€ï¼Œå¯¼è‡´å¼€å‘æ•ˆçŽ‡è¾ƒä½Žã€‚ç›¸å…³ä½¿ç”¨æ–¹æ³•å¯å‚è€ƒï¼š<a href=\"https://www.cnblogs.com/luohenyueji/p/19479110\" target=\"_blank\">åŸºäºŽpython-docxåº“çš„Wordæ–‡æ¡£è‡ªåŠ¨å¤„ç†å…¨è§£</a>ã€‚</p>\n<p>python-docx-templateæ­£æ˜¯ä¸ºè§£å†³è¿™ä¸€ç—›ç‚¹è€Œè®¾è®¡çš„ã€‚å®ƒå€Ÿé‰´Jinja2æ¨¡æ¿å¼•æ“Žçš„æ€è·¯ï¼Œå…è®¸åœ¨Wordæ–‡æ¡£ä¸­ç›´æŽ¥æ’å…¥ç±»ä¼¼<code>{{variable}}</code>çš„å ä½ç¬¦ï¼ŒéšåŽä»…ç”¨å‡ è¡Œä»£ç å³å¯å®Œæˆæ•°æ®å¡«å……ï¼Œæ— éœ€å…³å¿ƒåº•å±‚æ–‡æ¡£ç»“æž„ï¼Œå®Œç¾Žé€‚é…åŸºäºŽæ¨¡æ¿ä¿®æ”¹æ–‡æ¡£çš„åœºæ™¯ã€‚</p>\n<p><img alt=\"\" src=\"https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/CSDN/%5Bpython%5D%20python-docx-template%E6%A8%A1%E6%9D%BF%E5%8C%96Word%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90%E6%8C%87%E5%8C%97/imgs/1.jpg\" /></p>\n<p>python-docx-templateåŸºäºŽpython-docxå®žçŽ°æ–‡æ¡£è¯»å†™åŠŸèƒ½ï¼Œå¹¶å€ŸåŠ©jinja2æä¾›çµæ´»çš„æ¨¡æ¿æ ‡ç­¾æ”¯æŒï¼Œå…¶è®¾è®¡æ€è·¯å¦‚ä¸‹ï¼š</p>\n<ol>\n<li>\n<p>ç”¨Wordåˆ¶ä½œæ¨¡æ¿<br />\nåœ¨Microsoft Wordä¸­è‡ªç”±è®¾è®¡æ–‡æ¡£æ ¼å¼ï¼Œå¦‚æ’å…¥å›¾ç‰‡ã€è®¾ç½®é¡µçœ‰é¡µè„šã€è°ƒæ•´è¡¨æ ¼æ ·å¼ï¼Œå……åˆ†åˆ©ç”¨Wordå¼ºå¤§çš„æŽ’ç‰ˆåŠŸèƒ½ã€‚</p>\n</li>\n<li>\n<p>æ’å…¥æ¨¡æ¿å˜é‡<br />\nåœ¨éœ€è¦åŠ¨æ€å†…å®¹çš„ä½ç½®ï¼Œç›´æŽ¥è¾“å…¥Jinja2é£Žæ ¼çš„æ ‡ç­¾ï¼Œä¾‹å¦‚<code>{{company_name}}</code>æˆ–<code>{%for item in list%}</code>ã€‚</p>\n</li>\n<li>\n<p>ä¿å­˜ä¸ºæ¨¡æ¿æ–‡ä»¶<br />\nå°†æ–‡æ¡£ä¿å­˜ä¸ºæ™®é€šçš„.docxæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å³æˆä¸ºå¯å¤ç”¨çš„æ¨¡æ¿ã€‚</p>\n</li>\n<li>\n<p>ç”¨Pythonæ‰¹é‡ç”Ÿæˆ<br />\nåŠ è½½æ¨¡æ¿å¹¶ä¼ å…¥å­—å…¸æˆ–å¯¹è±¡ï¼Œpython-docx-templateä¼šè‡ªåŠ¨æ›¿æ¢æ ‡ç­¾ï¼Œç”Ÿæˆæœ€ç»ˆæ–‡æ¡£ã€‚</p>\n</li>\n</ol>\n<p>python-docx-templateçš„å®˜æ–¹ä»£ç ä»“åº“åœ°å€ä¸ºï¼š<a href=\"https://github.com/elapouya/python-docx-template\" rel=\"noopener nofollow\" target=\"_blank\">python-docx-template</a>ï¼Œè¯¦ç»†æ–‡æ¡£å¯å‚é˜…ï¼š<a href=\"https://docxtpl.readthedocs.io/\" rel=\"noopener nofollow\" target=\"_blank\">python-docx-template doc</a>ã€‚æœ¬æ–‡ä½¿ç”¨çš„python-docx-templateç‰ˆæœ¬ä¸º0.20.2ï¼Œå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p>\n<blockquote>\n<p>pip install docxtpl</p>\n</blockquote>\n<p>å…¶ä¸­ï¼Œdocxtplæ˜¯python-docx-templateåº“çš„æ­£å¼åˆ†å‘åç§°ï¼ŒäºŒè€…æŒ‡ä»£åŒä¸€å·¥å…·ã€‚</p>\n<p></p><div class=\"toc\"><div class=\"toc-container-header\">ç›®å½•</div><ul><li><a href=\"#1-ä½¿ç”¨è¯´æ˜Ž\" rel=\"noopener nofollow\">1 ä½¿ç”¨è¯´æ˜Ž</a><ul><li><a href=\"#11-æ ¸å¿ƒæ¦‚å¿µ\" rel=\"noopener nofollow\">1.1 æ ¸å¿ƒæ¦‚å¿µ</a><ul><li><a href=\"#111-æ ‡ç­¾è¯´æ˜Ž\" rel=\"noopener nofollow\">1.1.1 æ ‡ç­¾è¯´æ˜Ž</a></li><li><a href=\"#112-å¸¸è§å…ƒç´\" rel=\"noopener nofollow\">1.1.2 å¸¸è§å…ƒç´ </a></li></ul></li><li><a href=\"#12-å¤æ‚å…ƒç´\" rel=\"noopener nofollow\">1.2 å¤æ‚å…ƒç´ </a><ul><li><a href=\"#121-å¯Œæ–‡æœ¬\" rel=\"noopener nofollow\">1.2.1 å¯Œæ–‡æœ¬</a></li><li><a href=\"#122-å¯Œæ–‡æœ¬æ®µè½\" rel=\"noopener nofollow\">1.2.2 å¯Œæ–‡æœ¬æ®µè½</a></li><li><a href=\"#123-æµ®åŠ¨å¯¹è±¡\" rel=\"noopener nofollow\">1.2.3 æµ®åŠ¨å¯¹è±¡</a></li><li><a href=\"#124-å­æ–‡æ¡£\" rel=\"noopener nofollow\">1.2.4 å­æ–‡æ¡£</a></li></ul></li><li><a href=\"#13-è¡¥å……æ“ä½œ\" rel=\"noopener nofollow\">1.3 è¡¥å……æ“ä½œ</a><ul><li><a href=\"#131-è½¬ä¹‰æ“ä½œ\" rel=\"noopener nofollow\">1.3.1 è½¬ä¹‰æ“ä½œ</a></li><li><a href=\"#132-èŽ·å–æœªå®šä¹‰å˜é‡\" rel=\"noopener nofollow\">1.3.2 èŽ·å–æœªå®šä¹‰å˜é‡</a></li><li><a href=\"#133-jinjaè‡ªå®šä¹‰è¿‡æ»¤å™¨\" rel=\"noopener nofollow\">1.3.3 Jinjaè‡ªå®šä¹‰è¿‡æ»¤å™¨</a></li><li><a href=\"#134-microsoft-word-2016ç‰¹æ®Šè¡Œä¸ºè¯´æ˜Ž\" rel=\"noopener nofollow\">1.3.4 Microsoft Word 2016ç‰¹æ®Šè¡Œä¸ºè¯´æ˜Ž</a></li></ul></li></ul></li><li><a href=\"#2-å‚è€ƒ\" rel=\"noopener nofollow\">2 å‚è€ƒ</a></li></ul></div><p></p>\n<h1 id=\"1-ä½¿ç”¨è¯´æ˜Ž\">1 ä½¿ç”¨è¯´æ˜Ž</h1>\n<h2 id=\"11-æ ¸å¿ƒæ¦‚å¿µ\">1.1 æ ¸å¿ƒæ¦‚å¿µ</h2>\n<h3 id=\"111-æ ‡ç­¾è¯´æ˜Ž\">1.1.1 æ ‡ç­¾è¯´æ˜Ž</h3>\n<p>python-docx-templateå…è®¸åœ¨Wordæ–‡æ¡£ä¸­ä½¿ç”¨Jinja2æ ‡ç­¾å’Œè¿‡æ»¤å™¨ã€‚ä½†ä¸ºç¡®ä¿å…¶åœ¨Wordä¸­æ­£å¸¸è¿ä½œï¼Œéœ€éµå¾ªè‹¥å¹²é™åˆ¶ã€‚</p>\n<p>å¸¸è§„Jinja2æ ‡ç­¾ä»…èƒ½åœ¨åŒä¸€æ®µè½å†…ä¸”åŒä¸€æ–‡æœ¬è¿è¡Œä¸­ä½¿ç”¨ï¼Œè‹¥éœ€æŽ§åˆ¶æ®µè½ã€è¡¨æ ¼è¡Œæˆ–åŒ…å«æ ·å¼çš„å®Œæ•´æ–‡æœ¬è¿è¡Œï¼Œåˆ™å¿…é¡»ä½¿ç”¨åŽç»­ç« èŠ‚ä»‹ç»çš„å¤æ‚å…ƒç´ æ ‡ç­¾è¯­æ³•ã€‚</p>\n<p>ä¸¾ä¾‹è€Œè¨€ï¼Œè‹¥åˆ›å»ºä¸€ä¸ªæ‰€æœ‰å­—ç¬¦æ ·å¼ç›¸åŒçš„æ®µè½ï¼ŒWordå†…éƒ¨åªä¼šç”Ÿæˆä¸€ä¸ªæ–‡æœ¬è¿è¡Œå¯¹è±¡ã€‚ä½†è‹¥åœ¨è¯¥æ®µè½ä¸­å°†éƒ¨åˆ†æ–‡å­—è®¾ç½®ä¸ºåŠ ç²—ï¼ŒWordä¼šå°†åŽŸæœ‰æ–‡æœ¬è¿è¡Œæ‹†åˆ†ä¸ºä¸‰ä¸ªç‹¬ç«‹éƒ¨åˆ†ï¼Œåˆ†åˆ«å¯¹åº”æ™®é€šæ ·å¼ã€åŠ ç²—æ ·å¼åŠæ¢å¤åŽçš„æ™®é€šæ ·å¼ã€‚</p>\n<p><strong>æ ‡ç­¾</strong></p>\n<p>è‹¥è¦å¯¹æ®µè½ã€è¡¨æ ¼è¡Œã€è¡¨æ ¼åˆ—ä»¥åŠæ–‡æœ¬æ®µè¿›è¡Œç®¡ç†ï¼Œéœ€ä½¿ç”¨ä»¥ä¸‹ä¸“ç”¨è¯­æ³•ï¼š</p>\n<ul>\n<li>æ®µè½æ ‡ç­¾ï¼š<code>{%p jinja2_tag %}</code></li>\n<li>è¡¨æ ¼è¡Œæ ‡ç­¾ï¼š<code>{%tr jinja2_tag %}</code></li>\n<li>è¡¨æ ¼åˆ—æ ‡ç­¾ï¼š<code>{%tc jinja2_tag %}</code></li>\n<li>æ–‡æœ¬æ®µæ ‡ç­¾ï¼š<code>{%r jinja2_tag %}</code></li>\n</ul>\n<p>è¿™äº›ä»¥<code>{% %}</code>åŒ…è£¹çš„å†…å®¹æ˜¯Jinja2æ¨¡æ¿è¯­æ³•æ ‡ç­¾ï¼Œå¼•æ“Žä¼šè¯†åˆ«å¹¶æ‰§è¡Œå…¶ä¸­çš„é€»è¾‘ã€‚ä¸€ä¸ªå®Œæ•´çš„æ¨¡æ¿æ ‡ç­¾åŸºæœ¬ç»“æž„å¦‚ä¸‹ï¼š</p>\n<pre><code>{% æŒ‡ä»¤å…³é”®å­— å‚æ•°/æ¡ä»¶ %}  // èµ·å§‹æ ‡ç­¾\nå†…å®¹                      // è¢«æ ‡ç­¾æŽ§åˆ¶çš„æ–‡æœ¬\n{% ç»“æŸå…³é”®å­— %}          // ç»“æŸæ ‡ç­¾\n</code></pre>\n<p>é€šè¿‡æ­¤ç±»æ ‡ç­¾ï¼Œpython-docx-templateå¯è‡ªåŠ¨å°†æ ‡å‡†Jinja2æ ‡ç­¾ï¼Œå³åŽ»é™¤å‰ç¼€<code>p</code>ã€<code>tr</code>ã€<code>tc</code>ã€<code>r</code>åŽçš„å†…å®¹ï¼Œç²¾ç¡®åµŒå…¥åˆ°æ–‡æ¡£XMLæºç çš„ç›¸åº”ä½ç½®ã€‚</p>\n<p><img alt=\"\" src=\"https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/CSDN/%5Bpython%5D%20python-docx-template%E6%A8%A1%E6%9D%BF%E5%8C%96Word%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90%E6%8C%87%E5%8C%97/imgs/2.jpg\" /></p>\n<p>å‡è®¾æ¨¡æ¿å†…å®¹å¦‚ä¸‹ï¼š</p>\n<pre><code>{%p if display_paragraph %}\nä¸€æ®µæˆ–å¤šæ®µæ–‡æœ¬å†…å®¹\n{%p endif %}\n</code></pre>\n<p>æ— è®ºdisplay_paragraphå˜é‡å–å€¼å¦‚ä½•ï¼Œé¦–å°¾ä¸¤ä¸ªåŒ…å«<code>{%p ... %}</code>æ ‡ç­¾çš„æ®µè½ï¼Œéƒ½ä¸ä¼šå‡ºçŽ°åœ¨æœ€ç»ˆç”Ÿæˆçš„docxæ–‡æ¡£ä¸­ã€‚<br />\nåªæœ‰å½“display_paragraphçš„å€¼ä¸ºTrueæ—¶ï¼Œä»¥ä¸‹å†…å®¹æ‰ä¼šè¢«ä¿ç•™åœ¨ç”Ÿæˆçš„æ–‡æ¡£é‡Œï¼š</p>\n<pre><code>ä¸€æ®µæˆ–å¤šæ®µæ–‡æœ¬å†…å®¹\n</code></pre>\n<p>å¯¹äºŽæ¨¡æ¿é‡Œçš„æ ‡ç­¾æ ¼å¼éœ€éµå¾ªå¦‚ä¸‹è¦æ±‚ï¼Œå¦åˆ™æ— æ³•ç”Ÿæˆæ­£ç¡®ç»“æžœï¼š</p>\n<ul>\n<li>èµ·å§‹æ ‡ç­¾åˆ†éš”ç¬¦åŽå¿…é¡»åŠ ç©ºæ ¼ï¼Œç»“æŸæ ‡ç­¾åˆ†éš”ç¬¦å‰å¿…é¡»åŠ ç©ºæ ¼ï¼š\n<ul>\n<li>é”™è¯¯ç¤ºä¾‹ï¼š<pre><code>{%if something%}\n{%pif display_paragraph%}\n</code></pre>\n</li>\n<li>æ­£ç¡®ç¤ºä¾‹ï¼š<pre><code>{% if something %}\n{%p if display_paragraph %}\n</code></pre>\n</li>\n</ul>\n</li>\n<li>åŒä¸€æ®µè½ã€è¡Œã€åˆ—æˆ–æ–‡æœ¬æ®µå†…ï¼Œç¦æ­¢è¿žç»­ä½¿ç”¨æ ‡ç­¾åˆ†éš”ç¬¦ï¼š\n<ul>\n<li>é”™è¯¯ç¤ºä¾‹ï¼š<pre><code>{%p{%tr{%tc{%r\n</code></pre>\n</li>\n</ul>\n</li>\n<li>æ ‡ç­¾ä¸Žå†…å®¹ä¸å¯å†™åœ¨åŒä¸€è¡Œï¼Œéœ€æ¢è¡ŒæŽ’ç‰ˆï¼š\n<ul>\n<li>é”™è¯¯ç¤ºä¾‹ï¼š<pre><code>{%p if display_paragraph %}Here is my paragraph {%p endif %}\n</code></pre>\n</li>\n<li>æ­£ç¡®ç¤ºä¾‹ï¼š<pre><code>{%p if display_paragraph %}\nHere is my paragraph\n{%p endif %}\n</code></pre>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"112-å¸¸è§å…ƒç´ \">1.1.2 å¸¸è§å…ƒç´ </h3>\n<p><strong>æ˜¾ç¤ºå˜é‡</strong></p>\n<p>Jinja2æ¨¡æ¿é‡Œï¼Œå¯ä»¥ç”¨åŒå¤§æ‹¬å·æ¥æ˜¾ç¤ºå˜é‡ï¼š</p>\n<pre><code>{{ &lt;å˜é‡å&gt; }}\n</code></pre>\n<p>å¦‚æžœå˜é‡æ˜¯æ™®é€šå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²é‡Œçš„ç‰¹æ®Šç¬¦å·ä¼šè‡ªåŠ¨è½¬æ¢æˆå¯¹åº”çš„æ ¼å¼ï¼š</p>\n<ul>\n<li><code>\\n</code> â†’ æ¢è¡Œ</li>\n<li><code>\\a</code> â†’ åˆ†æ®µ</li>\n<li><code>\\t</code> â†’ åˆ¶è¡¨ç¬¦ï¼ˆæŒ‰ä¸€ä¸‹ Tab é”®çš„æ•ˆæžœï¼‰</li>\n<li><code>\\f</code> â†’ åˆ†é¡µç¬¦</li>\n</ul>\n<p>å¦‚æžœå˜é‡æ˜¯å¯Œæ–‡æœ¬ï¼ˆRichTextï¼‰å¯¹è±¡ï¼Œå¿…é¡»åœ¨å˜é‡åå‰åŠ ä¸€ä¸ª<code>r</code>ï¼Œæ˜Žç¡®è¡¨ç¤ºè¦æ¸²æŸ“è¿™ä¸ªå¯Œæ–‡æœ¬å†…å®¹ï¼š</p>\n<pre><code>{{r &lt;å˜é‡å&gt; }}\n</code></pre>\n<p>æ³¨æ„ï¼Œ<code>r</code>è¦ç´§è·Ÿåœ¨å·¦å¤§æ‹¬å·çš„åŽé¢ã€‚</p>\n<p>æ­¤å¤–ï¼Œå˜é‡åä¸­ç¦æ­¢ç›´æŽ¥ä½¿ç”¨<code>&lt;</code>,<code>&gt;</code>, <code>&amp;</code>è¿™ç±»å­—ç¬¦ï¼Œé™¤éžç”¨äº†è½¬ä¹‰è¯­æ³•ã€‚</p>\n<p><strong>æ³¨é‡Š</strong></p>\n<p>å¯ä»¥åœ¨æ¨¡æ¿ä¸­æ·»åŠ ç±»Jinja2é£Žæ ¼çš„æ³¨é‡Šï¼Œæ³¨é‡Šä¸ä¼šè¢«æ¸²æŸ“åˆ°æœ€ç»ˆæ–‡ä»¶ï¼š</p>\n<pre><code>{#p è¿™æ˜¯ä¸€ä¸ªæ®µè½ç±»åž‹çš„æ³¨é‡Š #}\n{#tr è¿™æ˜¯ä¸€ä¸ªè¡¨æ ¼è¡Œç±»åž‹çš„æ³¨é‡Š #}\n{#tc è¿™æ˜¯ä¸€ä¸ªè¡¨æ ¼å•å…ƒæ ¼ç±»åž‹çš„æ³¨é‡Š #}\n</code></pre>\n<p>åœ¨æ‰§è¡Œå¦‚ä¸‹ä»£ç å¯¹æ¨¡æ¿æ–‡ä»¶è¿›è¡Œæ¸²æŸ“æ“ä½œæ—¶ï¼Œæ¨¡æ¿ä¸­åŽŸæœ‰çš„æ‰€æœ‰æ³¨é‡Šä¿¡æ¯å‡ä¼šè¢«æ¸…é™¤ï¼Œä¸ä¼šä¿ç•™åœ¨æœ€ç»ˆçš„æ¸²æŸ“ç»“æžœä¸­ï¼š</p>\n<pre><code class=\"language-python\"># https://github.com/elapouya/python-docx-template/blob/master/tests/comments.py\nfrom docxtpl import DocxTemplate\nimport os\n\n# data: https://github.com/elapouya/python-docx-template/blob/master/tests/templates/comments_tpl.docx\ntpl = DocxTemplate(\"templates/comments_tpl.docx\")\n\ntpl.render({})\nos.makedirs(\"output\",exist_ok=True)\ntpl.save(\"output/comments.docx\")\n</code></pre>\n<p><strong>æ–‡æœ¬çš„æ‹†åˆ†ä¸Žåˆå¹¶</strong></p>\n<p>è‹¥åŒ…å«Jinja2æ ‡ç­¾çš„æ–‡æœ¬è¿‡é•¿ï¼Œä¼šå¯¼è‡´å¯è¯»æ€§ä¸‹é™ï¼Œä¾‹å¦‚ï¼š</p>\n<pre><code>æˆ‘çš„æˆ¿å­ä½äºŽ{% if living_in_town %}åŸŽå¸‚åŒºåŸŸ{% else %}ä¹¡æ‘åœ°åŒº{% endif %}ï¼Œæˆ‘éžå¸¸å–œæ¬¢å®ƒã€‚\n</code></pre>\n<p>å€ŸåŠ©<code>{%-</code>è¯­æ³•ï¼Œå¯å°†Jinja2æ ‡ç­¾ä¸Žä¸Šä¸€è¡Œå†…å®¹åˆå¹¶ï¼ŒåŒæ—¶å€ŸåŠ©<code>-%}</code>è¯­æ³•ï¼Œå¯å°†Jinja2æ ‡ç­¾ä¸Žä¸‹ä¸€è¡Œå†…å®¹åˆå¹¶ã€‚æ­¤æ—¶å¯ä½¿ç”¨å›žè½¦é”®ï¼ˆEnterï¼‰æˆ–Shift+Enterå¯¹æ–‡æœ¬è¿›è¡Œæ‹†åˆ†æŽ’ç‰ˆï¼Œå†é€šè¿‡ä¸Šè¿°çš„æ ‡ç­¾è¯­æ³•å°†æ‹†åˆ†åŽçš„å†…å®¹åˆå¹¶ä¸ºä¸€ä¸ªæ•´ä½“ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>\n<pre><code>æˆ‘çš„æˆ¿å­ä½äºŽ\n{%- if living_in_town -%}\nåŸŽå¸‚åŒºåŸŸ\n{%- else -%}\nä¹¡æ‘åœ°åŒº\n{%- endif -%}\nï¼Œæˆ‘éžå¸¸å–œæ¬¢å®ƒã€‚\n</code></pre>\n<p>æ¸²æŸ“ä»£ç å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-python\">from docxtpl import DocxTemplate\ntpl = DocxTemplate(\"template.docx\")\ncontext = {\"living_in_town\": True}\n\ntpl.render(context)\ntpl.save(\"output/output.docx\")\n</code></pre>\n<p><strong>è¡¨æ ¼</strong></p>\n<p>å¯ä»¥ä½¿ç”¨<code>colspan</code>æ ‡ç­¾å®žçŽ°è¡¨æ ¼å•å…ƒæ ¼çš„æ°´å¹³åˆå¹¶ï¼š</p>\n<pre><code>{% colspan &lt;var&gt; %}\n</code></pre>\n<p><code>&lt;var&gt;</code>å¿…é¡»ä¸ºæ•´æ•°ï¼Œç”¨äºŽæŒ‡å®šéœ€è¦åˆå¹¶çš„åˆ—æ•°ã€‚ä¹Ÿå¯é€šè¿‡Jinja2æ¨¡æ¿å¼•æ“Žè‡ªåŠ¨è®¡ç®—ï¼Œå¦‚å†…ç½®è¿‡æ»¤å™¨counté€šè¿‡ç®¡é“ç¬¦|æŽ¥æ”¶col_labelsï¼Œç”¨äºŽç»Ÿè®¡å…¶å…ƒç´ æ•°é‡ï¼š</p>\n<pre><code>{% colspan col_labels|count %}\n</code></pre>\n<p>ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨<code>colspan</code>æ ‡ç­¾ã€<code>tr</code>å’Œ<code>tc</code>æ ‡ç­¾åŠ¨æ€å¡«å……ä¸€ä¸ªè¡¨æ ¼ï¼š</p>\n<pre><code class=\"language-python\"># https://github.com/elapouya/python-docx-template/blob/master/tests/dynamic_table.py\nfrom docxtpl import DocxTemplate\nimport os\n# data: https://github.com/elapouya/python-docx-template/blob/master/tests/templates/dynamic_table_tpl.docx\ntpl = DocxTemplate(\"templates/dynamic_table_tpl.docx\")\n\ncontext = {\n    \"col_labels\": [\"fruit\", \"vegetable\", \"stone\", \"thing\"],\n    \"tbl_contents\": [\n        {\"label\": \"yellow\", \"cols\": [\"banana\", \"capsicum\", \"pyrite\", \"taxi\"]},\n        {\"label\": \"red\", \"cols\": [\"apple\", \"tomato\", \"cinnabar\", \"doubledecker\"]},\n        {\"label\": \"green\", \"cols\": [\"guava\", \"cucumber\", \"aventurine\", \"card\"]},\n    ],\n}\n\ntpl.render(context)\nos.makedirs(\"output\",exist_ok=True)\ntpl.save(\"output/dynamic_table.docx\")\n</code></pre>\n<p>ä¹Ÿå¯ä»¥åœ¨forå¾ªçŽ¯ä¸­å®žçŽ°å•å…ƒæ ¼æ°´å¹³åˆå¹¶ï¼š</p>\n<pre><code>{% hm %}\n</code></pre>\n<p>ä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨<code>hm</code>æ ‡ç­¾å®žçŽ°å•å…ƒæ ¼æ°´å¹³åˆå¹¶ï¼š</p>\n<pre><code class=\"language-python\"># https://github.com/elapouya/python-docx-template/blob/master/tests/horizontal_merge.py\nfrom docxtpl import DocxTemplate\nimport os\n# data: https://github.com/elapouya/python-docx-template/blob/master/tests/templates/horizontal_merge_tpl.docx\ntpl = DocxTemplate(\"templates/horizontal_merge_tpl.docx\")\ntpl.render({})\nos.makedirs(\"output\",exist_ok=True)\ntpl.save(\"output/horizontal_merge.docx\")\n</code></pre>\n<p>æ­¤å¤–ï¼Œè¿˜å¯ä»¥åœ¨forå¾ªçŽ¯ä¸­å®žçŽ°å•å…ƒæ ¼åž‚ç›´åˆå¹¶ï¼š</p>\n<pre><code>{% vm %}\n</code></pre>\n<p>ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•å®žçŽ°è¡¨æ ¼å•å…ƒæ ¼çš„åž‚ç›´åˆå¹¶æ•ˆæžœï¼š</p>\n<pre><code class=\"language-python\"># https://github.com/elapouya/python-docx-template/blob/master/tests/vertical_merge.py\nfrom docxtpl import DocxTemplate\n\n# data: https://github.com/elapouya/python-docx-template/blob/master/tests/templates/vertical_merge_tpl.docx\ntpl = DocxTemplate(\"templates/vertical_merge_tpl.docx\")\n\ncontext = {\n    \"items\": [\n        {\"desc\": \"Python interpreters\", \"qty\": 2, \"price\": \"FREE\"},\n        {\"desc\": \"Django projects\", \"qty\": 5403, \"price\": \"FREE\"},\n        {\"desc\": \"Guido\", \"qty\": 1, \"price\": \"100,000,000.00\"},\n    ],\n    \"total_price\": \"100,000,000.00\",\n    \"category\": \"Book\",\n}\n\ntpl.render(context)\ntpl.save(\"output/vertical_merge.docx\")\n</code></pre>\n<p>è‹¥éœ€è¦ä¿®æ”¹è¡¨æ ¼å•å…ƒæ ¼çš„èƒŒæ™¯è‰²ï¼Œå¿…é¡»å°†ä»¥ä¸‹æ ‡ç­¾æ”¾ç½®åœ¨å•å…ƒæ ¼å†…å®¹çš„æœ€å¼€å¤´ä½ç½®ï¼š</p>\n<pre><code>{% cellbg &lt;var&gt; %}\n</code></pre>\n<p><code>&lt;var&gt;</code>å¿…é¡»å¡«å†™é¢œè‰²çš„åå…­è¿›åˆ¶ç¼–ç ï¼Œä¸”æ— éœ€åŒ…å«äº•å·ï¼ˆ#ï¼‰ã€‚</p>\n<h2 id=\"12-å¤æ‚å…ƒç´ \">1.2 å¤æ‚å…ƒç´ </h2>\n<p><img alt=\"\" src=\"https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/CSDN/%5Bpython%5D%20python-docx-template%E6%A8%A1%E6%9D%BF%E5%8C%96Word%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90%E6%8C%87%E5%8C%97/imgs/3.jpg\" /></p>\n<h3 id=\"121-å¯Œæ–‡æœ¬\">1.2.1 å¯Œæ–‡æœ¬</h3>\n<p>å¯Œæ–‡æœ¬ï¼ˆRich Textï¼‰æ˜¯ç›¸å¯¹äºŽçº¯æ–‡æœ¬ï¼ˆPlain Textï¼‰è€Œè¨€çš„ä¸€ç§æ–‡æœ¬æ ¼å¼ã€‚å®ƒä¸ä»…åŒ…å«æ–‡å­—å†…å®¹ï¼Œè¿˜æ”¯æŒä¸ºæ–‡å­—æ·»åŠ å„ç§æ ¼å¼å±žæ€§åŠå¤šåª’ä½“å…ƒç´ ï¼Œä»Žè€Œå‘ˆçŽ°å‡ºæ›´ä¸ºä¸°å¯Œçš„è§†è§‰æ•ˆæžœã€‚è¿™ç§æ ¼å¼çš„ç¼–è¾‘å’Œå¤„ç†ä¹Ÿå¯ä»¥é€šè¿‡åœ¨Microsoft Wordè½¯ä»¶ä¸­é¢„å…ˆå®šä¹‰å­—ç¬¦æ ·å¼æ¥å®žçŽ°ã€‚</p>\n<p>åœ¨python-docx-templateä¸­ä½¿ç”¨å¯Œæ–‡æœ¬çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>\n<ol>\n<li>åœ¨Wordæ¨¡æ¿ä¸­ï¼Œä¸ºå¯Œæ–‡æœ¬å®šä¹‰ä¸€ä¸ªå ä½ç¬¦ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨<code>{{r rich_text_var}}</code>ï¼Œå…¶ä¸­çš„rè¡¨ç¤ºå¯Œæ–‡æœ¬ã€‚</li>\n<li>åœ¨Pythonä»£ç ä¸­ï¼Œåˆ©ç”¨RichTextç±»æž„å»ºå¸¦æœ‰æ ¼å¼çš„æ–‡æœ¬å†…å®¹ã€‚</li>\n<li>æ¸²æŸ“æ¨¡æ¿æ—¶ï¼Œå ä½ç¬¦ä¼šè¢«æ›¿æ¢ä¸ºå¯Œæ–‡æœ¬å†…å®¹ï¼Œå¹¶ä¿ç•™æ‰€æœ‰å·²å®šä¹‰çš„æ ¼å¼æ ·å¼ã€‚</li>\n</ol>\n<p>åœ¨ä»£ç ä¸­ä½¿ç”¨RichTextç±»æ—¶ï¼Œè¿˜å¯é€šè¿‡ä»¥ä¸‹æ ‡è®°æŽ§åˆ¶æ–‡æœ¬æ ¼å¼ï¼š</p>\n<ul>\n<li>æ¢è¡Œï¼š<code>\\n</code>ï¼›</li>\n<li>æ¢æ®µï¼š<code>\\a</code>ï¼›</li>\n<li>åˆ†é¡µï¼š<code>\\f</code>ã€‚</li>\n</ul>\n<p>ä»¥ä¸‹ä¸ºç”Ÿæˆå¯Œæ–‡æœ¬Wordæ–‡æ¡£çš„ç¤ºä¾‹ï¼š</p>\n<pre><code class=\"language-python\"># https://github.com/elapouya/python-docx-template/blob/master/tests/richtext.py\nfrom docxtpl import DocxTemplate, RichText\n\n# data: https://github.com/elapouya/python-docx-template/blob/master/tests/templates/richtext_tpl.docx\ntpl = DocxTemplate(\"templates/richtext_tpl.docx\")\n\nrt = RichText()\n\n# å‘å¯Œæ–‡æœ¬å¯¹è±¡ä¸­æ·»åŠ å†…å®¹ï¼Œä¾æ¬¡æ¼”ç¤ºä¸åŒçš„æ–‡æœ¬æ ¼å¼è®¾ç½®\nrt.add(\"a rich text\", style=\"myrichtextstyle\")  # ä½¿ç”¨è‡ªå®šä¹‰æ ·å¼\nrt.add(\" with \")                                \nrt.add(\"some italic\", italic=True)              # æ–œä½“æ–‡æœ¬\nrt.add(\" and \")\nrt.add(\"some violet\", color=\"#ff00ff\")          # ç´«è‰²æ–‡æœ¬ï¼ˆåå…­è¿›åˆ¶é¢œè‰²ç ï¼‰\nrt.add(\" and \")\nrt.add(\"some striked\", strike=True)             # åˆ é™¤çº¿æ–‡æœ¬\nrt.add(\" and \")\nrt.add(\"some Highlighted\", highlight=\"#ffff00\") # é»„è‰²é«˜äº®æ–‡æœ¬\nrt.add(\" and \")\nrt.add(\"some small\", size=14)                   # å°å­—å·æ–‡æœ¬ï¼ˆ14ç£…ï¼‰\nrt.add(\" or \")\nrt.add(\"big\", size=60)                          # å¤§å­—å·æ–‡æœ¬ï¼ˆ60ç£…ï¼‰\nrt.add(\" text.\")\nrt.add(\"\\nYou can add an hyperlink, here to \")\n# æ·»åŠ å¸¦è¶…é“¾æŽ¥çš„æ–‡æœ¬ï¼Œbuild_url_id ç”¨äºŽåˆ›å»ºURLæ ‡è¯†å¹¶å…³è”åˆ°æŒ‡å®šé“¾æŽ¥\nrt.add(\"bing\", url_id=tpl.build_url_id(\"http://bing.com\"))\nrt.add(\"\\nEt voilÃ  ! \")\n# æ¼”ç¤ºæ¢è¡Œç¬¦æ•ˆæžœ\nrt.add(\"\\n1st line\")\nrt.add(\"\\n2nd line\")\nrt.add(\"\\n3rd line\")\n# \\a ç”¨äºŽåˆ›å»ºæ–°æ®µè½\nrt.add(\"\\aA new paragraph : &lt;cool&gt;\\a\")\n# \\f ç”¨äºŽæ’å…¥åˆ†é¡µç¬¦\nrt.add(\"--- A page break here (see next page) ---\\f\")\n\n# å¾ªçŽ¯æ¼”ç¤ºä¸åŒç±»åž‹çš„ä¸‹åˆ’çº¿æ ·å¼\nfor ul in [\n    \"single\",       # å•ä¸‹åˆ’çº¿\n    \"double\",       # åŒä¸‹åˆ’çº¿\n    \"thick\",        # ç²—ä¸‹åˆ’çº¿\n    \"dotted\",       # ç‚¹ä¸‹åˆ’çº¿\n    \"dash\",         # çŸ­åˆ’çº¿ä¸‹åˆ’çº¿\n    \"dotDash\",      # ç‚¹åˆ’çº¿ä¸‹åˆ’çº¿\n    \"dotDotDash\",   # åŒç‚¹åˆ’çº¿ä¸‹åˆ’çº¿\n    \"wave\",         # æ³¢æµªçº¿ä¸‹åˆ’çº¿\n]:\n    rt.add(\"\\nUnderline : \" + ul + \" \\n\", underline=ul)\n\n# æ¼”ç¤ºä¸åŒå­—ä½“çš„è®¾ç½®\nrt.add(\"\\nFonts :\\n\", underline=True)\nrt.add(\"Arial\\n\", font=\"Arial\")                \nrt.add(\"Courier New\\n\", font=\"Courier New\")    \nrt.add(\"Times New Roman\\n\", font=\"Times New Roman\") \n\n# æ¼”ç¤ºä¸Šæ ‡å’Œä¸‹æ ‡æ–‡æœ¬\nrt.add(\"\\n\\nHere some\")\nrt.add(\"superscript\", superscript=True)        # ä¸Šæ ‡æ–‡æœ¬\nrt.add(\" and some\")\nrt.add(\"subscript\", subscript=True)            # ä¸‹æ ‡æ–‡æœ¬\n\n# åˆ›å»ºä¸€ä¸ªæ–°çš„å¯Œæ–‡æœ¬å¯¹è±¡ï¼Œå¹¶å°†ä¹‹å‰åˆ›å»ºçš„rtå¯¹è±¡åµŒå…¥å…¶ä¸­ï¼Œå®žçŽ°å¯Œæ–‡æœ¬åµŒå¥—\nrt_embedded = RichText(\"an example of \")\nrt_embedded.add(rt)\n\n# æž„å»ºæ¸²æŸ“ä¸Šä¸‹æ–‡ï¼Œå°†åµŒå¥—çš„å¯Œæ–‡æœ¬å¯¹è±¡èµ‹å€¼ç»™æ¨¡æ¿ä¸­çš„ \"example\" å˜é‡\ncontext = {\n    \"example\": rt_embedded,\n}\n\n# å°†ä¸Šä¸‹æ–‡æ•°æ®æ¸²æŸ“åˆ°Wordæ¨¡æ¿ä¸­\ntpl.render(context)\n# ä¿å­˜æ¸²æŸ“åŽçš„Wordæ–‡æ¡£åˆ°æŒ‡å®šè·¯å¾„\ntpl.save(\"output/richtext.docx\")\n</code></pre>\n<h3 id=\"122-å¯Œæ–‡æœ¬æ®µè½\">1.2.2 å¯Œæ–‡æœ¬æ®µè½</h3>\n<p>è‹¥è¦ç²¾ç»†æŽ§åˆ¶å•ä¸ªæ®µè½çš„æ ·å¼ï¼Œå¯åœ¨ä»£ç ä¸­ä½¿ç”¨<code>RichTextParagraph()</code>æˆ–<code>RP()</code>å¯¹è±¡ã€‚æ­¤å¯¹è±¡éœ€é€šè¿‡<code>{{p &lt;var&gt; }}</code>è¯­æ³•æ·»åŠ è‡³æ¨¡æ¿ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-python\"># https://github.com/elapouya/python-docx-template/blob/master/tests/richtextparagraph.py\nfrom docxtpl import DocxTemplate, RichText, RichTextParagraph\n\n# data: https://github.com/elapouya/python-docx-template/blob/master/tests/templates/richtext_paragraph_tpl.docx\ntpl = DocxTemplate(\"templates/richtext_paragraph_tpl.docx\")\n\n# åˆ›å»ºå¯Œæ–‡æœ¬æ®µè½å¯¹è±¡ç»„åˆä¸åŒæ ·å¼çš„æ®µè½\nrtp = RichTextParagraph()\n# åˆ›å»ºå¯Œæ–‡æœ¬å¯¹è±¡ï¼Œç”¨äºŽè®¾ç½®æ–‡æœ¬çš„å­—ç¬¦æ ·å¼\nrt = RichText()\n\n# å‘å¯Œæ–‡æœ¬æ®µè½ä¸­æ·»åŠ æ–‡æœ¬ï¼Œå¹¶æŒ‡å®šè‡ªå®šä¹‰æ ·å¼myrichparastyle\nrtp.add(\n    \"The rich text paragraph function allows paragraph styles to be added to text\",\n    parastyle=\"myrichparastyle\",\n)\n# æ·»åŠ æ–‡æœ¬å¹¶ä½¿ç”¨å†…ç½®æ®µè½æ ·å¼IntenseQuote\nrtp.add(\"Any built in paragraph style can be used\", parastyle=\"IntenseQuote\")\n# æ·»åŠ æ–‡æœ¬å¹¶ä½¿ç”¨è‡ªå®šä¹‰æ ·å¼createdStyle\nrtp.add(\n    \"or you can add your own, unlocking all style options\", parastyle=\"createdStyle\"\n)\n# æ·»åŠ æ–‡æœ¬å¹¶ä½¿ç”¨é»˜è®¤æ™®é€šæ®µè½æ ·å¼normal\nrtp.add(\n    \"To use, just create a style in your template word doc with the formatting you want \"\n    \"and call it in the code.\",\n    parastyle=\"normal\",\n)\n\n# æ¼”ç¤ºä¸åŒåˆ—è¡¨æ ·å¼çš„ä½¿ç”¨\nrtp.add(\"This allows for the use of\")\nrtp.add(\"custom bullet\\apoints\", parastyle=\"SquareBullet\")  # æ–¹å½¢é¡¹ç›®ç¬¦å·æ ·å¼\nrtp.add(\"Numbered Bullet Points\", parastyle=\"BasicNumbered\")  # æ•°å­—ç¼–å·æ ·å¼\nrtp.add(\"and Alpha Bullet Points.\", parastyle=\"alphaBracketNumbering\")  # å­—æ¯ç¼–å·æ ·å¼\n\n# æ¼”ç¤ºæ–‡æœ¬å¯¹é½æ–¹å¼çš„è®¾ç½®\nrtp.add(\"You can\", parastyle=\"normal\")  # é»˜è®¤å·¦å¯¹é½\nrtp.add(\"set the\", parastyle=\"centerAlign\")  # åº”ç”¨è‡ªå®šä¹‰æ ·å¼å±…ä¸­å¯¹é½\nrtp.add(\"text alignment\", parastyle=\"rightAlign\")  # åº”ç”¨è‡ªå®šä¹‰æ ·å¼å³å¯¹é½\n\n# æ¼”ç¤ºè¡Œé—´è·æ ·å¼ï¼šç´§å‡‘è¡Œé—´è·\nrtp.add(\n    \"as well as the spacing between lines of text. Like this for example, \"\n    \"this text has very tight spacing between the lines.\\aIt also has no space between \"\n    \"paragraphs of the same style.\",\n    parastyle=\"TightLineSpacing\",\n)\n# æ¼”ç¤ºè¡Œé—´è·æ ·å¼ï¼šå®½è¡Œé—´è·\nrtp.add(\n    \"Unlike this one, which has extra large spacing between lines for when you want to \"\n    \"space things out a bit or just write a little less.\",\n    parastyle=\"WideLineSpacing\",\n)\n# æ¼”ç¤ºæ®µè½èƒŒæ™¯è‰²æ ·å¼ï¼šç»¿è‰²èƒŒæ™¯\nrtp.add(\n    \"You can also set the background colour of a line.\", parastyle=\"LineShadingGreen\"\n)\n\n# æž„å»ºå¯Œæ–‡æœ¬å­—ç¬¦ä¸²ï¼Œæ¼”ç¤ºå­—ç¬¦çº§æ ·å¼\nrt.add(\"This works with \")\nrt.add(\"Rich \", bold=True)  # åŠ ç²—\nrt.add(\"Text \", italic=True)  # æ–œä½“\nrt.add(\"Strings\", underline=\"single\")  # å•ä¸‹åˆ’çº¿\nrt.add(\" too.\")\n\n# å°†å¯Œæ–‡æœ¬å¯¹è±¡æ·»åŠ åˆ°å¯Œæ–‡æœ¬æ®µè½ä¸­ï¼Œå¹¶æŒ‡å®šæ–¹å½¢é¡¹ç›®ç¬¦å·æ ·å¼\nrtp.add(rt, parastyle=\"SquareBullet\")\n\n# æž„å»ºæ¸²æŸ“ä¸Šä¸‹æ–‡ï¼Œå°†å¯Œæ–‡æœ¬æ®µè½å¯¹è±¡ç»‘å®šåˆ°æ¨¡æ¿ä¸­çš„exampleå˜é‡\ncontext = {\n    \"example\": rtp,\n}\n\n# å°†ä¸Šä¸‹æ–‡æ•°æ®æ¸²æŸ“åˆ° Word æ¨¡æ¿ä¸­\ntpl.render(context)\n# ä¿å­˜æ¸²æŸ“åŽçš„ Word æ–‡æ¡£åˆ°æŒ‡å®šè·¯å¾„\ntpl.save(\"output/richtext_paragraph.docx\")\n</code></pre>\n<h3 id=\"123-æµ®åŠ¨å¯¹è±¡\">1.2.3 æµ®åŠ¨å¯¹è±¡</h3>\n<p><strong>å›¾ç‰‡æ’å…¥</strong></p>\n<p>å¯åœ¨æ–‡æ¡£ä¸­åŠ¨æ€æ’å…¥å•å¼ æˆ–å¤šå¼ å›¾ç‰‡ï¼Œå½“å‰å·²æ”¯æŒJPEGå’ŒPNGæ ¼å¼ã€‚åªéœ€åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨<code>{{ &lt;var&gt; }}</code>æ ¼å¼çš„æ ‡ç­¾å³å¯ã€‚å›¾ç‰‡åµŒå…¥ä»£ç å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-python\">myimage = InlineImage(tpl, image_descriptor='test_files/python_logo.png', width=Mm(20), height=Mm(10))\n</code></pre>\n<p>ä½¿ç”¨æ—¶åº”ä¼ å…¥æ¨¡æ¿å¯¹è±¡ä¸Žå›¾ç‰‡æ–‡ä»¶è·¯å¾„ï¼Œå®½é«˜ä¸ºå¯é€‰å‚æ•°ã€‚å®½åº¦å’Œé«˜åº¦éœ€é€šè¿‡<code>Mm</code>ï¼ˆæ¯«ç±³ï¼‰ã€<code>Inches</code>ï¼ˆè‹±å¯¸ï¼‰æˆ– <code>Pt</code>ï¼ˆç£…ï¼‰ç­‰ç±»è¿›è¡Œå•ä½å®šä¹‰ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-python\"># https://github.com/elapouya/python-docx-template/blob/master/tests/inline_image.py\nfrom docxtpl import DocxTemplate, InlineImage\nfrom docx.shared import Mm\nimport jinja2\n# data: https://github.com/elapouya/python-docx-template/blob/master/tests/templates/inline_image_tpl.docx\ntpl = DocxTemplate(\"templates/inline_image_tpl.docx\")\n\n# å®šä¹‰æ¸²æŸ“æ¨¡æ¿æ‰€éœ€çš„ä¸Šä¸‹æ–‡æ•°æ®\ncontext = {\n    # åªè®¾ç½®å®½æˆ–è€…é«˜ï¼Œåˆ™å›¾ç‰‡è‡ªé€‚åº”å˜åŒ–\n    \"myimage\": InlineImage(tpl, \"templates/python_logo.png\", width=Mm(20)),\n    # æ‰‹åŠ¨æŒ‡å®šå®½é«˜åº¦\n    \"myimageratio\": InlineImage(\n        tpl, \"templates/python_jpeg.jpg\", width=Mm(30), height=Mm(60)\n    ),\n    # å®šä¹‰å›¾ç‰‡+æè¿°\n    \"frameworks\": [\n        {\n            \"image\": InlineImage(tpl, \"templates/django.png\", height=Mm(10)),\n            \"desc\": \"The web framework for perfectionists with deadlines\",\n        },\n        {\n            \"image\": InlineImage(tpl, \"templates/zope.png\", height=Mm(10)),\n            \"desc\": \"Zope is a leading Open Source Application Server \"\n            \"and Content Management Framework\",\n        },\n        {\n            \"image\": InlineImage(tpl, \"templates/pyramid.png\", height=Mm(10)),\n            \"desc\": \"Pyramid is a lightweight Python web framework aimed at taking \"\n            \"small web apps into big web apps.\",\n        },\n        {\n            \"image\": InlineImage(tpl, \"templates/bottle.png\", height=Mm(10)),\n            \"desc\": \"Bottle is a fast, simple and lightweight WSGI micro web-framework \"\n            \"for Python\",\n        },\n        {\n            \"image\": InlineImage(tpl, \"templates/tornado.png\", height=Mm(10)),\n            \"desc\": \"Tornado is a Python web framework and asynchronous networking \"\n            \"library.\",\n        },\n    ],\n}\n\n# autoescapeæ˜¯å¦å¼€å¯è‡ªåŠ¨è½¬ä¹‰ï¼ŒæŠŠæ¨¡æ¿å˜é‡ä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬æ¢æˆæ— å®³çš„HTMå®žä½“\njinja_env = jinja2.Environment(autoescape=True)\n# ä½¿ç”¨ä¸Šä¸‹æ–‡æ•°æ®å’Œè‡ªå®šä¹‰çš„jinja2çŽ¯å¢ƒæ¸²æŸ“Wordæ¨¡æ¿\ntpl.render(context, jinja_env)\ntpl.save(\"output/inline_image.docx\")\n</code></pre>\n<p><strong>æ›¿æ¢æ–‡æ¡£ä¸­çš„å›¾ç‰‡</strong></p>\n<p>å¯å¯¹æ–‡æ¡£ä¸­çš„çŽ°æœ‰å›¾ç‰‡è¿›è¡Œæ›¿æ¢ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼šå…ˆåœ¨æ¨¡æ¿ä¸­æ’å…¥ä¸€å¼ å ä½å›¾ï¼ŒæŒ‰å¸¸è§„æµç¨‹æ¸²æŸ“æ¨¡æ¿ï¼Œä¹‹åŽå†å°†å ä½å›¾æ›¿æ¢ä¸ºç›®æ ‡å›¾ç‰‡ã€‚è¯¥æ–¹æ³•æ”¯æŒæ‰¹é‡å¤„ç†æ–‡æ¡£å†…çš„æ‰€æœ‰åª’ä½“æ–‡ä»¶ï¼Œä¸”æ›¿æ¢åŽçš„å›¾ç‰‡å°†ç»´æŒåŽŸå ä½å›¾çš„çºµæ¨ªæ¯”ã€‚åœ¨æ¨¡æ¿ä¸­æ’å…¥å›¾ç‰‡æ—¶ï¼Œåªéœ€æŒ‡å®šæ–‡ä»¶åå³å¯ã€‚è¯¥æ›¿æ¢æ“ä½œåŒæ—¶å¯¹é¡µçœ‰ã€é¡µè„šåŠæ­£æ–‡åŒºåŸŸç”Ÿæ•ˆã€‚</p>\n<p>ä¾‹å¦‚ï¼Œæ›¿æ¢å ä½å›¾<code>dummy_header_pic.jpg</code>çš„è¯­æ³•ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-python\">tpl.replace_pic('dummy_header_pic.jpg', 'header_pic_i_want.jpg')\n</code></pre>\n<p>æ³¨æ„ï¼Œåœ¨å°†å›¾ç‰‡æ‰‹åŠ¨æ’å…¥Wordæ¨¡æ¿æ—¶ï¼ŒæŸäº›ç‰ˆæœ¬çš„Wordä¼šè‡ªåŠ¨å¯¹å…¶é‡å‘½åå¹¶å­˜å‚¨ã€‚è¿™å¯¼è‡´å›¾ç‰‡åœ¨docxæ–‡ä»¶å†…çš„å®žé™…æ–‡ä»¶åä¸ŽåŽŸæ–‡ä»¶åå®Œå…¨ä¸åŒï¼Œä»Žè€Œå¯èƒ½å¼•å‘æ‰¾ä¸åˆ°å›¾ç‰‡çš„é—®é¢˜ã€‚è‹¥ä¸ç¡®å®šå›¾ç‰‡çš„å…·ä½“ä½ç½®ï¼Œå¯å°†docxæ–‡ä»¶è§†ä¸ºzipåŽ‹ç¼©åŒ…è¿›è¡Œè§£åŽ‹ï¼ŒéšåŽåœ¨<code>word\\document.xml</code>æ–‡ä»¶ä¸­ï¼Œé€šè¿‡æŸ¥æ‰¾<code>pic:nvPicPr</code>èŠ‚ç‚¹æ¥å®šä½å›¾ç‰‡ä¿¡æ¯ã€‚å…·ä½“æ­¥éª¤å¯å‚è€ƒï¼š<a href=\"https://blog.csdn.net/qq_42780731/article/details/106946284\" rel=\"noopener nofollow\" target=\"_blank\">pythonä½¿ç”¨docxtplåº“å¯¹å›¾ç‰‡è¿›è¡Œæ›¿æ¢</a>ã€‚</p>\n<p>åœ¨æ‰¾åˆ°ç›®æ ‡å›¾ç‰‡å¯¹åº”çš„<code>pic:nvPicPr</code>èŠ‚ç‚¹åŽï¼Œå…¶<code>name</code>å±žæ€§çš„å€¼å³ä¸ºå›¾ç‰‡åœ¨æ–‡æ¡£ä¸­å®žé™…å­˜å‚¨çš„æ–‡ä»¶åã€‚æ­¤å¤„çš„æ–‡ä»¶åå¯èƒ½ä¸åŒ…å«å›¾ç‰‡æ ¼å¼åŽç¼€ï¼Œæ›¿æ¢å›¾ç‰‡çš„ç¤ºä¾‹ä»£ç å¯èƒ½å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-python\">tpl.replace_pic('Picture 1','header_pic_i_want.jpg')\n</code></pre>\n<h3 id=\"124-å­æ–‡æ¡£\">1.2.4 å­æ–‡æ¡£</h3>\n<p>æ¨¡æ¿å˜é‡å¯åŒ…å«å¤æ‚çš„å­æ–‡æ¡£å¯¹è±¡ï¼Œä¸”èƒ½é€šè¿‡python-docxçš„æ–‡æ¡£æ“ä½œæ–¹æ³•ä»Žé›¶æž„å»ºã€‚å…·ä½“æ­¥éª¤ä¸ºï¼šå…ˆä»Žæ¨¡æ¿å¯¹è±¡ä¸­èŽ·å–å­æ–‡æ¡£å¯¹è±¡ï¼Œå†å°†å…¶å½“ä½œpython-docxæ–‡æ¡£å¯¹è±¡ä½¿ç”¨ã€‚è¯¥åŠŸèƒ½éœ€è¦å®‰è£…é¢å¤–ä¾èµ–ï¼š</p>\n<blockquote>\n<p>pip install \"docxtpl[subdoc]\"</p>\n</blockquote>\n<p>ä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•åˆ›å»ºå­æ–‡æ¡£ï¼Œå¹¶å°†è¯¥å­æ–‡æ¡£åµŒå…¥åˆ°ä¸»æ¨¡æ¿ä¸­ï¼Œæœ€ç»ˆç”Ÿæˆå¹¶ä¿å­˜æ–°çš„æ–‡æ¡£ï¼š</p>\n<pre><code class=\"language-python\"># https://github.com/elapouya/python-docx-template/blob/master/tests/subdoc.py\nfrom docxtpl import DocxTemplate\nfrom docx.shared import Inches\n\n# data: https://github.com/elapouya/python-docx-template/blob/master/tests/templates/subdoc_tpl.docx\n# 1. åŠ è½½Wordæ¨¡æ¿æ–‡ä»¶ï¼ˆæŒ‡å®šæ¨¡æ¿æ–‡ä»¶è·¯å¾„ï¼‰\ntpl = DocxTemplate(\"templates/subdoc_tpl.docx\")\n\n# 2. åˆ›å»ºä¸€ä¸ªæ–°çš„å­æ–‡æ¡£å¯¹è±¡\nsd = tpl.new_subdoc()\n\n# 3. å‘ä¸‹æ–‡æ¡£ä¸­æ·»åŠ æ®µè½å†…å®¹\np = sd.add_paragraph(\"This is a sub-document inserted into a bigger one\")\np = sd.add_paragraph(\"It has been \")\n# ä¸ºæ–‡æœ¬ç‰‡æ®µè®¾ç½®è‡ªå®šä¹‰æ ·å¼\np.add_run(\"dynamically\").style = \"dynamic\"\np.add_run(\" generated with python by using \")\n# ä¸ºæ–‡æœ¬ç‰‡æ®µè®¾ç½®æ–œä½“æ ·å¼\np.add_run(\"python-docx\").italic = True\np.add_run(\" library\")\n\n# 4. å‘ä¸‹æ–‡æ¡£æ·»åŠ æ ‡é¢˜\nsd.add_heading(\"Heading, level 1\", level=1)\n# å‘ä¸‹æ–‡æ¡£æ·»åŠ å¸¦æ ·å¼çš„æ®µè½ï¼ˆIntenseQuoteæ ·å¼ä¸ºå†…ç½®æ ·å¼ï¼‰\nsd.add_paragraph(\"This is an Intense quote\", style=\"IntenseQuote\")\n\n# 5. å‘ä¸‹æ–‡æ¡£æ’å…¥å›¾ç‰‡\nsd.add_paragraph(\"A picture :\")\nsd.add_picture(\"templates/python_logo.png\", width=Inches(1.25))\n\n# 6. å‘ä¸‹æ–‡æ¡£æ’å…¥è¡¨æ ¼\nsd.add_paragraph(\"A Table :\")\n# åˆ›å»ºè¡¨æ ¼ï¼ˆåˆå§‹1è¡Œ3åˆ—ï¼Œä½œä¸ºè¡¨å¤´ï¼‰\ntable = sd.add_table(rows=1, cols=3)\n# èŽ·å–è¡¨å¤´å•å…ƒæ ¼å¹¶è®¾ç½®å†…å®¹\nhdr_cells = table.rows[0].cells\nhdr_cells[0].text = \"Qty\"\nhdr_cells[1].text = \"Id\"\nhdr_cells[2].text = \"Desc\"\n\n# å®šä¹‰è¡¨æ ¼æ•°æ®\nrecordset = ((1, 101, \"Spam\"), (2, 42, \"Eggs\"), (3, 631, \"Spam,spam, eggs, and ham\"))\n# å¾ªçŽ¯æ·»åŠ æ•°æ®è¡Œåˆ°è¡¨æ ¼\nfor item in recordset:\n    row_cells = table.add_row().cells\n    row_cells[0].text = str(item[0])  # æ•°é‡ï¼ˆè½¬ä¸ºå­—ç¬¦ä¸²ï¼‰\n    row_cells[1].text = str(item[1])  # IDï¼ˆè½¬ä¸ºå­—ç¬¦ä¸²ï¼‰\n    row_cells[2].text = item[2]       # æè¿°\n\ncontext = {\n    \"mysubdoc\": sd,\n}\n\ntpl.render(context)\ntpl.save(\"output/subdoc.docx\")\n</code></pre>\n<p>æ­¤å¤–è‡ªpython-docx-template V0.12.0ç‰ˆæœ¬èµ·ï¼Œæ”¯æŒå°†å·²æœ‰çš„.docxæ–‡ä»¶ä½œä¸ºå­æ–‡æ¡£è¿›è¡Œåˆå¹¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<pre><code class=\"language-python\"># https://github.com/elapouya/python-docx-template/blob/master/tests/merge_docx.py\nfrom docxtpl import DocxTemplate\n\n# data: https://github.com/elapouya/python-docx-template/blob/master/tests/templates\ntpl = DocxTemplate(\"templates/merge_docx_master_tpl.docx\")\nsd = tpl.new_subdoc(\"templates/merge_docx_subdoc.docx\")\n\ncontext = {\n    \"mysubdoc\": sd,\n}\n\ntpl.render(context)\ntpl.save(\"output/merge_docx.docx\")\n</code></pre>\n<h2 id=\"13-è¡¥å……æ“ä½œ\">1.3 è¡¥å……æ“ä½œ</h2>\n<p><img alt=\"\" src=\"https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/CSDN/%5Bpython%5D%20python-docx-template%E6%A8%A1%E6%9D%BF%E5%8C%96Word%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90%E6%8C%87%E5%8C%97/imgs/4.jpg\" /></p>\n<h3 id=\"131-è½¬ä¹‰æ“ä½œ\">1.3.1 è½¬ä¹‰æ“ä½œ</h3>\n<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œpython-docx-templateä¸ä¼šå¯¹å†…å®¹è¿›è¡Œè½¬ä¹‰ã€‚è¿™æ˜¯å› ä¸ºåœ¨ä½¿ç”¨æ¨¡æ¿è¯­æ³•ä¿®æ”¹Wordæ–‡æ¡£æ—¶ï¼Œåº•å±‚å®žé™…ä¸Šæ˜¯åœ¨å¤„ç†XMLç»“æž„ï¼Œè€Œåƒ<code>&lt;</code>ã€<code>&gt;</code> å’Œ<code>&amp;</code>è¿™æ ·çš„å­—ç¬¦åœ¨XMLä¸­å…·æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œå¿…é¡»ç»è¿‡è½¬ä¹‰æ‰èƒ½æ­£ç¡®æ˜¾ç¤ºã€‚ä»¥ä¸‹æä¾›å‡ ç§å®žçŽ°è½¬ä¹‰çš„æ–¹æ³•ï¼š</p>\n<ol>\n<li>\n<p>ä¸Šä¸‹æ–‡å®šä¹‰æ—¶ä½¿ç”¨<code>R()</code>åŒ…è£¹å†…å®¹ï¼Œæ¨¡æ¿ä¸­æ·»åŠ <code>r</code>æ ‡è®°ï¼š</p>\n<pre><code class=\"language-python\">context = { 'var': R('my text') }\n</code></pre>\n<p>æ¨¡æ¿ä¸­å†™æ³•ï¼š<code>{{r &lt;var&gt; }}</code></p>\n</li>\n<li>\n<p>ä¸Šä¸‹æ–‡ä¿æŒåŽŸå§‹å­—ç¬¦ä¸²ï¼Œæ¨¡æ¿ä¸­ä½¿ç”¨<code>|e</code>è¿‡æ»¤å™¨ï¼š</p>\n<pre><code class=\"language-python\">context = { 'var':'my text' }\n</code></pre>\n<p>æ¨¡æ¿ä¸­å†™æ³•ï¼š<code>{{ &lt;var&gt;|e }}</code></p>\n</li>\n<li>\n<p>ä¸Šä¸‹æ–‡ä½¿ç”¨<code>escape()</code>å‡½æ•°å¤„ç†å†…å®¹ï¼Œæ¨¡æ¿ç›´æŽ¥å¼•ç”¨ï¼š</p>\n<pre><code class=\"language-python\">context = { 'var': escape('my text') }\n</code></pre>\n<p>æ¨¡æ¿ä¸­å†™æ³•ï¼š<code>{{ &lt;var&gt; }}</code></p>\n</li>\n<li>\n<p>è°ƒç”¨<code>render</code>æ–¹æ³•æ—¶å¯ç”¨è‡ªåŠ¨è½¬ä¹‰ï¼Œé»˜è®¤å€¼ä¸º<code>autoescape=False</code>ï¼š</p>\n<pre><code class=\"language-python\">tpl.render(context, autoescape=True)\n</code></pre>\n</li>\n</ol>\n<p>åœ¨æ–‡æ¡£ä¸­æ’å…¥ä»£ç æ¸…å•æ—¶ï¼Œå¦‚æžœéœ€è¦åŒæ—¶è½¬ä¹‰æ–‡æœ¬å¹¶å¤„ç†æ¢è¡Œç¬¦ï¼ˆ<code>\\n</code>ï¼‰ã€æ®µè½ç¬¦ï¼ˆ<code>\\a</code>ï¼‰å’Œæ¢é¡µç¬¦ï¼ˆ<code>\\f</code>ï¼‰ï¼Œå¯ä»¥åœ¨Pythonä»£ç ä¸­ä½¿ç”¨<code>Listing</code>ç±»ã€‚</p>\n<p>ä¾‹å¦‚ï¼š</p>\n<pre><code class=\"language-python\">context = { \n    'mylisting': Listing('the listing\\nwith\\nsome\\nlines \\a and some paragraph \\a and special chars : &lt;&gt;&amp;') \n}\n</code></pre>\n<p>åœ¨æ¨¡æ¿ä¸­ç›´æŽ¥å¼•ç”¨å³å¯ï¼š</p>\n<pre><code>{{ mylisting }}\n</code></pre>\n<p>ä½¿ç”¨<code>Listing()</code>èƒ½å¤Ÿä¿æŒå½“å‰å­—ç¬¦æ ·å¼ï¼Œé™¤éžé‡åˆ°<code>\\a</code>åˆ†éš”ç¬¦ï¼Œå®ƒä¼šåœ¨è¯¥ä½ç½®å¼€å§‹ä¸€ä¸ªæ–°çš„æ®µè½ã€‚</p>\n<p>ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-python\"># https://github.com/elapouya/python-docx-template/blob/master/tests/escape.py\nfrom docxtpl import DocxTemplate, R, Listing\n# data: https://github.com/elapouya/python-docx-template/blob/master/tests/templates/escape_tpl.docx\ntpl = DocxTemplate(\"templates/escape_tpl.docx\")\n\ncontext = {\n    \"myvar\": R(\n        '\"less than\" must be escaped : &lt;, this can be done with RichText() or R()'\n    ),\n    \"myescvar\": 'It can be escaped with a \"|e\" jinja filter in the template too : &lt; ',\n    \"nlnp\": R(\n        \"Here is a multiple\\nlines\\nstring\\aand some\\aother\\aparagraphs\",\n        color=\"#ff00ff\",\n    ),\n    \"mylisting\": Listing(\"the listing\\nwith\\nsome\\nlines\\nand special chars : &lt;&gt;&amp; ...\"),\n    \"page_break\": R(\"\\f\"),\n    \"new_listing\": \"\"\"\nThis is a new listing\nHere is a \\t tab\\a\nHere is a page break : \\f\nThat's it\n\"\"\",\n    \"some_html\": (\n        \"HTTP/1.1 200 OK\\n\"\n        \"Server: Apache-Coyote/1.1\\n\"\n        \"Cache-Control: no-store\\n\"\n    ),\n}\n\ntpl.render(context)\ntpl.save(\"output/escape.docx\")\n</code></pre>\n<p>æ­¤å¤–ï¼Œè‹¥éœ€åœ¨æœ€ç»ˆç”Ÿæˆçš„Wordæ–‡æ¡£ä¸­æ˜¾ç¤ºç”±Jinja2æ¸²æŸ“åŽçš„ç‰¹æ®Šå­—ç¬¦<code>%</code>ã€<code>{</code>æˆ–<code>}</code>ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼è¿›è¡Œè½¬ä¹‰ï¼š</p>\n<ul>\n<li>æ˜¾ç¤º<code>%%</code> â†’ ä½¿ç”¨<code>{_% %_}</code></li>\n<li>æ˜¾ç¤º<code>{{ }}</code> â†’ ä½¿ç”¨<code>{_{ }_}</code></li>\n</ul>\n<h3 id=\"132-èŽ·å–æœªå®šä¹‰å˜é‡\">1.3.2 èŽ·å–æœªå®šä¹‰å˜é‡</h3>\n<p>è¦èŽ·å–æ¨¡æ¿æ¸²æŸ“æ—¶æ‰€éœ€çš„æœªå®šä¹‰å˜é‡ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p>\n<pre><code class=\"language-python\">from docxtpl import DocxTemplate\ntpl = DocxTemplate('template.docx')\n\ncontext = {'name': 'å¼ ä¸‰', 'age': 30}\n# æ³¨æ„ï¼šdepartmentå˜é‡æœªå®šä¹‰\n\n# æ£€æµ‹ç¼ºå¤±å˜é‡\nmissing = tpl.get_undeclared_template_variables(context=context)\nprint(f\"ç¼ºå¤±çš„å˜é‡: {missing}\")\n\n# èŽ·å–æ‰€æœ‰å˜é‡ï¼ˆä¸ä¼ contextï¼‰\nall_vars = tpl.get_undeclared_template_variables()\nprint(f\"æ¨¡æ¿æ‰€æœ‰å˜é‡: {all_vars}\")\n</code></pre>\n<p>æ¨¡æ¿æ–‡æ¡£çš„å†…å®¹åŒ…å«ï¼š</p>\n<pre><code>å§“åï¼š{{name}}\nå¹´é¾„ï¼š{{age}}\néƒ¨é—¨ï¼š{{department}}\n</code></pre>\n<p>è‹¥æœªä¼ é€’ <code>context</code> å‚æ•°ï¼Œè¯¥æ–¹æ³•å°†è¿”å›žæ¨¡æ¿ä¸­æ‰€æœ‰éœ€è¦èµ‹å€¼çš„å˜é‡åçš„é›†åˆã€‚æ­¤ç»“æžœå¯ç”¨äºŽå‘ç”¨æˆ·æç¤ºè¾“å…¥ï¼Œæˆ–å†™å…¥æ–‡ä»¶ä¾›åŽç»­æ‰‹åŠ¨å¤„ç†ã€‚</p>\n<h3 id=\"133-jinjaè‡ªå®šä¹‰è¿‡æ»¤å™¨\">1.3.3 Jinjaè‡ªå®šä¹‰è¿‡æ»¤å™¨</h3>\n<p>Python-docx-templateçš„renderæ–¹æ³•æ”¯æŒä¸€ä¸ªå¯é€‰å‚æ•°jinja_envï¼Œä½œä¸ºå…¶ç¬¬äºŒä¸ªå‚æ•°ã€‚é€šè¿‡ä¼ é€’è‡ªå®šä¹‰çš„JinjaçŽ¯å¢ƒå¯¹è±¡ï¼Œå¯ä»¥å®žçŽ°è‡ªå®šä¹‰è¿‡æ»¤å™¨çš„æ·»åŠ ï¼Œä»Žè€Œçµæ´»æ‰©å±•æ•°æ®å¤„ç†é€»è¾‘ã€‚ä»¥ä¸‹ä¸ºå…·ä½“ç¤ºä¾‹ã€‚</p>\n<p>æ¨¡æ¿wordå†…å®¹å¦‚ä¸‹ï¼š</p>\n<pre><code>=== å§“åå±•ç¤ºå¯¹æ¯” ===\nåŽŸå§‹åå­—: {{ name }}\næ–¹æ³•A (Pythonå¤„ç†): {{ name_upper }}\næ–¹æ³•B (æ¨¡æ¿è¿‡æ»¤å™¨): {{ name|upper }}\n</code></pre>\n<p>å¯¹åº”çš„Pythonæ¸²æŸ“ä»£ç ï¼š</p>\n<pre><code class=\"language-python\">from docxtpl import DocxTemplate\nimport jinja2\n\n# å‡†å¤‡æ•°æ®\ndata = {'name': 'zhangsan'}\n\n# Pythonä¸­å¤„ç†\ndata['name_upper'] = data['name'].upper()\n\n# å®šä¹‰è¿‡æ»¤å™¨\ndef my_upper(text):\n    return text.upper()\n\ndoc = DocxTemplate(\"template.docx\")\n\n#åˆ›å»ºçŽ¯å¢ƒå¹¶æ³¨å†Œè¿‡æ»¤å™¨\nenv = jinja2.Environment()\nenv.filters['upper'] = my_upper \n\ndoc.render(data, env) \ndoc.save(\"output/compare.docx\")\nprint(f\"åŽŸå§‹æ•°æ®: {data['name']}\")\nprint(f\"Pythonå¤„ç†ç»“æžœ: {data['name_upper']}\")\nprint(f\"æ¨¡æ¿è¿‡æ»¤å™¨ç»“æžœ: {data['name'].upper()}\")\n</code></pre>\n<h3 id=\"134-microsoft-word-2016ç‰¹æ®Šè¡Œä¸ºè¯´æ˜Ž\">1.3.4 Microsoft Word 2016ç‰¹æ®Šè¡Œä¸ºè¯´æ˜Ž</h3>\n<p>MS Word 2016ä¼šå¿½ç•¥æ–‡æ¡£ä¸­çš„åˆ¶è¡¨ç¬¦ï¼Œè¿™æ˜¯è¯¥ç‰ˆæœ¬ç‰¹æœ‰çš„æƒ…å†µã€‚ç±»ä¼¼LibreOfficeæˆ–WordPadç­‰å…¶ä»–ç¼–è¾‘å·¥å…·åˆ™æ— æ­¤é—®é¢˜ã€‚åŒæ ·ï¼Œä»¥Jinja2æ ‡ç­¾å¼€å¤´ä¸”å¸¦æœ‰å‰å¯¼ç©ºæ ¼çš„è¡Œï¼Œå…¶ç©ºæ ¼ä¹Ÿä¼šè¢«å¿½ç•¥ã€‚</p>\n<p>ä¸ºè§£å†³ä¸Šè¿°é—®é¢˜ï¼Œå¯ä½¿ç”¨<code>RichText</code>è¿›è¡Œå¤„ç†ï¼š</p>\n<pre><code class=\"language-python\">tpl.render({\n    'test_space_r': RichText('          '),\n    'test_tabs_r': RichText(5 * '\\t'),\n})\n</code></pre>\n<p>åœ¨æ¨¡æ¿ä¸­ï¼Œé€šè¿‡<code>{{r ... }}</code>è¯­æ³•è°ƒç”¨ï¼š</p>\n<pre><code>{{r test_space_r}} ç©ºæ ¼å°†è¢«ä¿ç•™\n{{r test_tabs_r}} åˆ¶è¡¨ç¬¦å°†æ­£å¸¸æ˜¾ç¤º\n</code></pre>\n<h1 id=\"2-å‚è€ƒ\">2 å‚è€ƒ</h1>\n<ul>\n<li><a href=\"https://www.cnblogs.com/luohenyueji/p/19479110\" target=\"_blank\">åŸºäºŽpython-docxåº“çš„Wordæ–‡æ¡£è‡ªåŠ¨å¤„ç†å…¨è§£</a></li>\n<li><a href=\"https://github.com/elapouya/python-docx-template\" rel=\"noopener nofollow\" target=\"_blank\">python-docx-template</a></li>\n<li><a href=\"https://docxtpl.readthedocs.io/\" rel=\"noopener nofollow\" target=\"_blank\">python-docx-template doc</a></li>\n<li><a href=\"https://blog.csdn.net/qq_42780731/article/details/106946284\" rel=\"noopener nofollow\" target=\"_blank\">pythonä½¿ç”¨docxtplåº“å¯¹å›¾ç‰‡è¿›è¡Œæ›¿æ¢</a></li>\n</ul>\n\n</div>\n<div id=\"MySignature\">\n    <p>æœ¬æ–‡æ¥è‡ªåšå®¢å›­ï¼Œä½œè€…ï¼š<a href=\"https://www.cnblogs.com/luohenyueji/\" target=\"_blank\">è½ç—•çš„å¯’å‡</a>ï¼Œè½¬è½½è¯·æ³¨æ˜ŽåŽŸæ–‡é“¾æŽ¥ï¼š<a href=\"https://www.cnblogs.com/luohenyueji/p/19503461\" target=\"_blank\">https://www.cnblogs.com/luohenyueji/p/19503461</a></p>\n\n<div style=\"text-align: center;\">\n    <img src=\"https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/wechat/content/%E5%8A%A0%E6%B2%B9%E9%B8%AD.gif\" />\n</div>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-19 18:51</span>&nbsp;\n<a href=\"https://www.cnblogs.com/luohenyueji\">è½ç—•çš„å¯’å‡</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">28</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    }
  ]
}