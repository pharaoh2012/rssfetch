{
  "title": "主页 - 博客园",
  "link": "https://www.cnblogs.com/",
  "description": "主页 - 博客园 RSS",
  "entries": [
    {
      "title": "主定理学习笔记",
      "link": "https://www.cnblogs.com/xiaoniu142857/p/19554323",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/xiaoniu142857/p/19554323\" id=\"cb_post_title_url\" title=\"发布于 2026-01-30 16:31\">\n    <span>主定理学习笔记</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>主定理（Master Theorem）是用于分析分治算法复杂度的重要定理。</p>\n<h2 id=\"前置知识\">前置知识</h2>\n<h3 id=\"渐进符号的概念\">渐进符号的概念</h3>\n<h4 id=\"1-紧确渐进界\">1. <span class=\"math inline\">\\(\\mathcal{\\Theta}\\)</span>（紧确渐进界）</h4>\n<p>若存在正常数 <span class=\"math inline\">\\(c_1,c_2,n_0\\)</span> 使得 <span class=\"math inline\">\\(\\forall n\\ge n_0\\)</span> 都有：</p>\n<p></p><div class=\"math display\">\\[0\\le c_1\\cdot g(n)\\le f(n)\\le c_2\\cdot g(n)\n\\]</div><p></p><p>则记 <span class=\"math inline\">\\(f(n)=\\mathcal{\\Theta}(g(n))\\)</span>。<span class=\"math inline\">\\(\\mathcal{\\Theta}\\)</span> 是等价关系，表示 <span class=\"math inline\">\\(f,g\\)</span> 增长速度同阶，类似 <span class=\"math inline\">\\(=\\)</span>。</p>\n<h4 id=\"2-渐进上界\">2. <span class=\"math inline\">\\(\\mathcal{O}\\)</span>（渐进上界）</h4>\n<p>若存在正常数 <span class=\"math inline\">\\(c,n_0\\)</span> 使得 <span class=\"math inline\">\\(\\forall n\\ge n_0\\)</span> 都有：</p>\n<p></p><div class=\"math display\">\\[0\\le f(n)\\le c\\cdot g(n)\n\\]</div><p></p><p>则记 <span class=\"math inline\">\\(f(n)=\\mathcal{O}(g(n))\\)</span>。<span class=\"math inline\">\\(\\mathcal{O}\\)</span> 是拟序关系，类似 <span class=\"math inline\">\\(\\le\\)</span>（小于等于）。</p>\n<h4 id=\"3-渐进下界\">3. <span class=\"math inline\">\\(\\mathcal{\\Omega}\\)</span>（渐进下界）</h4>\n<p>若存在正常数 <span class=\"math inline\">\\(c,n_0\\)</span> 使得 <span class=\"math inline\">\\(\\forall n\\ge n_0\\)</span> 都有：</p>\n<p></p><div class=\"math display\">\\[0\\le c\\cdot g(n)\\le f(n)\n\\]</div><p></p><p>则记 <span class=\"math inline\">\\(f(n)=\\mathcal{\\Omega}(g(n))\\)</span>。<span class=\"math inline\">\\(\\mathcal{\\Omega}\\)</span> 也是拟序关系，类似 <span class=\"math inline\">\\(\\ge\\)</span>（大于等于）。</p>\n<p>三者如下图所示。</p>\n<p><img alt=\"\" src=\"https://oi-wiki.org/basic/images/order.png\" /></p>\n<h3 id=\"常用性质\">常用性质</h3>\n<ol>\n<li><span class=\"math inline\">\\(f(n)=\\mathcal{\\Theta}(g(n))\\Leftrightarrow f(n)=\\mathcal{O}(g(n)) \\land f(n)=\\mathcal{\\Omega}(g(n))\\)</span></li>\n<li><span class=\"math inline\">\\(f(n)=\\mathcal{\\Theta}(f(n))\\)</span></li>\n<li><span class=\"math inline\">\\(c\\cdot \\mathcal{\\Theta}(f(n))=\\mathcal{\\Theta}(f(n))\\)</span>（<span class=\"math inline\">\\(c&gt;0\\)</span> 且 <span class=\"math inline\">\\(c\\)</span> 与 <span class=\"math inline\">\\(n\\)</span> 无关）</li>\n<li><span class=\"math inline\">\\(\\mathcal{\\Theta}(f(n))+\\mathcal{\\Theta}(g(n))=\\mathcal{\\Theta}(f(n)+g(n))=\\mathcal{\\Theta}(\\max(f(n),g(n)))\\)</span></li>\n<li><span class=\"math inline\">\\(\\mathcal{\\Theta}(f(n))\\mathcal{\\Theta}(g(n))=\\mathcal{\\Theta}(f(n)g(n))\\)</span></li>\n<li><span class=\"math inline\">\\(\\mathcal{\\Theta}(\\log_b n)=\\mathcal{\\Theta}(\\log_2 n)\\)</span>（<span class=\"math inline\">\\(b&gt;1\\)</span>）</li>\n</ol>\n<p><strong>性质 2~6 同样适用于 <span class=\"math inline\">\\(\\mathcal{O}\\)</span> 和 <span class=\"math inline\">\\(\\mathcal{\\Omega}\\)</span></strong>。</p>\n<p>这些性质会在后面的证明中用到。</p>\n<h2 id=\"主定理简化版\">主定理简化版</h2>\n<p>设 <span class=\"math inline\">\\(T\\left(n\\right)\\)</span> 为分治算法处理规模为 <span class=\"math inline\">\\(n\\)</span> 的问题的复杂度，且满足：</p>\n<p></p><div class=\"math display\">\\[T\\left(n\\right)=\n\\begin{cases}\naT\\left(\\frac{n}{b}\\right)+\\mathcal{O}\\left(n^d\\right) &amp; \\text{if}\\;n\\ge b\\\\\n\\mathcal{O}\\left(1\\right) &amp; \\text{if}\\;n&lt;b\n\\end{cases}\n\\]</div><p></p><p>其中：</p>\n<ul>\n<li><span class=\"math inline\">\\(a\\)</span>：子问题个数（<span class=\"math inline\">\\(a\\in \\mathbb{Z},a\\ge 1\\)</span>）。</li>\n<li><span class=\"math inline\">\\(\\frac{n}{b}\\)</span>：每个子问题大小（<span class=\"math inline\">\\(b\\in \\mathbb{R},b&gt;1\\)</span>）。</li>\n<li><span class=\"math inline\">\\(\\mathcal{O}\\left(n^d\\right)\\)</span>：合并子问题的解得到原问题解的额外复杂度（<span class=\"math inline\">\\(d\\ge 0\\)</span>）。</li>\n</ul>\n<p>则有：</p>\n<p></p><div class=\"math display\">\\[T\\left(n\\right)=\\begin{cases}\n\\mathcal{O}\\left(n^{\\log_b a}\\right) &amp; \\text{if} \\; d&lt;\\log_b a \\\\\n\\mathcal{O}\\left(n^d \\log n\\right) &amp; \\text{if} \\; d=\\log_b a \\\\\n\\mathcal{O}\\left(n^d\\right) &amp; \\text{if} \\; d&gt;\\log_b a\n\\end{cases}\n\\]</div><p></p><p>这对于 OI 来说已经够用了。</p>\n<h3 id=\"例子\">例子</h3>\n<ul>\n<li>对于归并排序，<span class=\"math inline\">\\(a=2,b=2,d=1\\)</span>，有 <span class=\"math inline\">\\(d=\\log_ba\\)</span>，因此时间复杂度为 <span class=\"math inline\">\\(O(n\\log n)\\)</span>。</li>\n<li>对于 <span class=\"math inline\">\\(a=2,b=2,d=2\\)</span> 的完全二叉树上背包问题，有 <span class=\"math inline\">\\(d&gt;\\log_ba\\)</span>，因此时间复杂度为 <span class=\"math inline\">\\(O(n^2)\\)</span>。</li>\n</ul>\n<h3 id=\"证明\">证明</h3>\n<p>不失一般性地，假设 <span class=\"math inline\">\\(n\\)</span> 是 <span class=\"math inline\">\\(b\\)</span> 的整数次幂。</p>\n<p>考虑递归树。若根节点算一层，则树高为 <span class=\"math inline\">\\(\\log_b n+1\\)</span>。单独计算叶子节点，展开得：</p>\n<p></p><div class=\"math display\">\\[\\begin{aligned}\nT\\left(n\\right)&amp;=\\mathcal{O}\\left(a^{\\log_bn}\\right)+\\sum_{k=0}^{\\log_b n-1}a^k\\cdot \\mathcal{O}\\left(\\left(\\frac{n}{b^k}\\right)^d\\right)\\\\\n&amp;=\\mathcal{O}\\left(a^{\\log_bn}\\right)+\\sum_{k=0}^{\\log_b n-1}\\mathcal{O}\\left(a^k\\right)\\cdot \\mathcal{O}\\left(\\left(\\frac{n}{b^k}\\right)^d\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\sum_{k=0}^{\\log_b n-1}\\mathcal{O}\\left(a^k\\cdot \\frac{n^d}{\\left(b^d\\right)^k}\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\sum_{k=0}^{\\log_b n-1}\\mathcal{O}\\left(\\left(\\frac{a}{b^d}\\right)^k\\cdot n^d\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(\\sum_{k=0}^{\\log_b n-1}\\left(\\frac{a}{b^d}\\right)^k\\cdot n^d\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(n^d\\cdot\\sum_{k=0}^{\\log_b n-1}\\left(\\frac{a}{b^d}\\right)^k\\right)\\\\\n\\end{aligned}\n\\]</div><p></p><p>设 <span class=\"math inline\">\\(p=\\frac{a}{b^d}\\)</span>，则：</p>\n<p></p><div class=\"math display\">\\[\\begin{cases}\np&gt;1 &amp; \\text{if} \\; d&lt;\\log_ba \\\\\np=1 &amp; \\text{if} \\; d=\\log_ba \\\\\n0&lt;p&lt;1 &amp; \\text{if} \\; d&gt;\\log_ba  \\\\\n\\end{cases}\n\\]</div><p></p><p>且</p>\n<p></p><div class=\"math display\">\\[T\\left(n\\right)=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(n^d\\cdot\\sum_{k=0}^{\\log_b n-1}p^k\\right)\n\\]</div><p></p><h4 id=\"情况-1\">情况 1（<span class=\"math inline\">\\(d&lt;\\log_ba\\)</span>）</h4>\n<p>此时 <span class=\"math inline\">\\(p&gt;1\\)</span>。</p>\n<p>由等比数列求和公式，得：</p>\n<p></p><div class=\"math display\">\\[\\begin{aligned}\nT\\left(n\\right)&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(n^d\\cdot \\frac{p^{\\log_bn}-1}{p-1}\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(n^d\\cdot \\left(p^{\\log_bn}-1\\right)\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(n^d\\cdot \\left(\\left(\\frac{a}{b^d}\\right)^{\\log_bn}-1\\right)\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(n^d\\cdot \\left(\\frac{a^{\\log_bn}}{b^{d\\log_bn}}-1\\right)\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(n^d\\cdot\\left(\\frac{n^{\\log_b a}}{n^d}-1\\right)\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(n^{\\log_b a}-n^d\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)\n\\end{aligned}\n\\]</div><p></p><h4 id=\"情况-2\">情况 2（<span class=\"math inline\">\\(d=\\log_ba\\)</span>）</h4>\n<p>此时 <span class=\"math inline\">\\(p=1\\)</span>。</p>\n<p></p><div class=\"math display\">\\[\\begin{aligned}\nT\\left(n\\right)&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(n^d\\cdot \\log_bn\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(n^d\\log n\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^d\\log n\\right)\n\\end{aligned}\n\\]</div><p></p><h4 id=\"情况-3\">情况 3（<span class=\"math inline\">\\(d&gt;\\log_ba\\)</span>）</h4>\n<p>此时 <span class=\"math inline\">\\(0&lt;p&lt;1\\)</span>。</p>\n<p>由等比数列求和公式，得：</p>\n<p></p><div class=\"math display\">\\[\\begin{aligned}\nT\\left(n\\right)&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(n^d\\cdot \\frac{p^{\\log_bn}-1}{p-1}\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(n^d\\cdot \\frac{1-p^{\\log_bn}}{1-p}\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^{\\log_ba}\\right)+\\mathcal{O}\\left(n^d\\right)\\cdot \\mathcal{O}\\left(1\\right)\\\\\n&amp;=\\mathcal{O}\\left(n^d\\right)\n\\end{aligned}\n\\]</div><p></p><p>注意 <span class=\"math inline\">\\(p-1&lt;0\\)</span>，故应将分母化为 <span class=\"math inline\">\\(1-p\\)</span>。</p>\n<p>证毕。</p>\n<h2 id=\"主定理完整版\">主定理完整版</h2>\n<p><span class=\"math inline\">\\(\\mathcal{O}(n^d)\\)</span> 被换成了更一般的 <span class=\"math inline\">\\(f(n)\\)</span>。</p>\n<p></p><div class=\"math display\">\\[T(n)=aT(\\frac{n}{b})+f(n)\\quad(n\\ge b)\n\\]</div><p></p><p>则有：</p>\n<p></p><div class=\"math display\">\\[T(n)=\\begin{cases}\n\\Theta(n^{\\log_b a}) &amp; \\text{if}\\;f(n)=O(n^{\\log_b a-\\epsilon})\\\\\n\\Theta(f(n)) &amp; \\text{if}\\;f(n)=\\Omega(n^{\\log_b a+\\epsilon})\\\\\n\\Theta(n^{\\log_b a}\\log^{k+1}n) &amp; \\text{if}\\;f(n)=\\Theta(n^{\\log_b a}\\log^k n)\n\\end{cases}\n\\]</div><p></p><p>其中 <span class=\"math inline\">\\(\\epsilon&gt;0,k\\ge 0\\)</span>。</p>\n<p>注意其中第二条还必须满足存在正常数 <span class=\"math inline\">\\(c&lt;1,n_0\\)</span> 使得 <span class=\"math inline\">\\(\\forall n\\ge n_0\\)</span> 都有 <span class=\"math inline\">\\(a f(\\frac{n}{b}) \\le c f(n)\\)</span>。</p>\n<p>证明比较繁琐，这里不作展开。思路大致就是代入关于 <span class=\"math inline\">\\(f(n)\\)</span> 的渐进符号然后化简。</p>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-30 16:31</span>&nbsp;\n<a href=\"https://www.cnblogs.com/xiaoniu142857\">xiaoniu142857</a>&nbsp;\n阅读(<span id=\"post_view_count\">0</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "7个神级技巧，彻底去除网站的 AI 味儿！",
      "link": "https://www.cnblogs.com/yupi/p/19554255",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/yupi/p/19554255\" id=\"cb_post_title_url\" title=\"发布于 2026-01-30 16:18\">\n    <span>7个神级技巧，彻底去除网站的 AI 味儿！</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        <img alt=\"7个神级技巧，彻底去除网站的 AI 味儿！\" class=\"desc_img\" src=\"https://img2024.cnblogs.com/blog/2225420/202601/2225420-20260130151301505-853845577.png\" />\n        现在 AI 开发网站的能力已经非常强了。但为啥我用 AI 搓出来的网站一股子 AI 味儿？而这些网站看起来干净很多呢？这就是接下来我要分享的。\n    </div>\n<div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<p class=\"md-end-block md-heading\"><span class=\"md-plain\">大家好，我是程序员鱼皮。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">先做个小测试，下面这几个网站，你能看出哪些是 AI 做的吗？</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">公布答案：<span class=\"md-pair-s \"><strong>全都是 AI 做的！</strong></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">是不是觉得有点意外？</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">“为啥我用 AI 搓出来的网站一股子 AI 味儿？而这些网站看起来干净很多呢？”</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这就是接下来我要分享的：</span></p>\n<ul class=\"ul-list\">\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">什么是 AI 编程的 AI 味儿？</span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">为什么网站会有 AI 味儿？</span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">怎么去除网站的 AI 味儿？</span></p>\n</li>\n</ul>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">点个收藏，我们开始~</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">⭐️ 推荐观看本文对应视频版，效果更明显：<span class=\"md-link md-pair-s\"><a href=\"https://bilibili.com/video/BV1QF6EBiErM\" rel=\"noopener nofollow\">https://bilibili.com/video/BV1QF6EBiErM</a></span></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h2 class=\"md-end-block md-heading\"><span class=\"md-plain\">什么是 AI 味儿？</span></h2>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">所谓的 AI 味儿，就是那种一眼就能看出是 AI 生成的网站，界面样式和内容风格都千篇一律。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">1）配色死板：蓝紫渐变色用到吐。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">2）布局死板：首屏放个大标题，下面三个卡片并排。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">3）字体死板：基本上就是 Inter、Roboto 等几种固定的字体。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">4）Emoji 泛滥：什么 🐟4️⃣🐶 之类的，满屏幕都是表情图标。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">5）内容空洞：基本没有真实图片，文字风格也比较刻板。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">用户看这些网站时就一个感觉：我在跟机器人聊天。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h2 class=\"md-end-block md-heading\"><span class=\"md-plain\">为什么网站会有 AI 味儿？</span></h2>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">说了这么多问题，到底为啥会这样？</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">核心原因就俩字：<span class=\"md-pair-s \"><strong>求稳</strong><span class=\"md-plain\">。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">举个例子，为啥 AI 那么爱用蓝紫渐变色？</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">因为 AI 的训练数据里，很多现代网站采用 Tailwind 样式库，而这个库的默认主色调就是蓝紫色。AI 在学习数亿行代码时，这些颜色出现的频率是最高的，于是 AI 就认为 “现代化网站 ≈ 蓝紫色渐变”。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">并且 AI 学会了一个生存法则：<span class=\"md-pair-s \"><strong>用最常见的 = 最不容易出错</strong><span class=\"md-plain\">。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">所以当你让 AI “开发一个现代化的网站” 时，AI 为了求稳，就会选择使用蓝紫渐变色。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-pair-s \"><strong>那怎么破局？</strong></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">很简单，从 “请求者” 变成 “指挥官”。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">不要只说需求：给我做个网站</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">而是要明确要求：用深灰色背景、手绘图标、不对称布局、拒绝蓝紫色。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">用强有力的约束条件，逼着 AI 偏离它的舒适区。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h2 class=\"md-end-block md-heading\"><span class=\"md-plain\">怎么去除网站的 AI 味儿？</span></h2>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">下面分享我总结的 7 个方法，保证让你的网站摆脱 AI 味儿。</span></p>\n<h3 class=\"md-end-block md-heading\"><span class=\"md-plain\">方法 1、让 AI 参考真实网站</span></h3>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">最简单粗暴的一招，你看到好看的网站，直接让 AI 学。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">有 4 种具体的做法：</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">1）如果你使用 Cursor 或者 Claude Code 等 AI 编程工具，或者利用 <span class=\"md-meta-i-c  md-link\"><a href=\"https://www.firecrawl.dev/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Firecrawl MCP</span></a><span class=\"md-plain\">，让 AI 能够直接读取网页。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">你只需要跟 AI 说：</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>请访问 ai.codefather.cn，提取它的配色方案、字体选择和布局结构，然后生成类似风格的网站。</span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">AI 会自己去看那个网站，然后学着做。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">2）如果 AI 大模型支持图片理解，你还可以把网页截图提供给 AI，搭配文字能让 AI 还原网站更准确。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">效果如图：</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">3）如果你用的 AI 大模型不支持图片理解、纯文本理解又不到位，可以先利用 <span class=\"md-pair-s \"><strong>截图转代码</strong><span class=\"md-plain\"> 工具，比如 <span class=\"md-meta-i-c  md-link\"><a href=\"https://github.com/abi/screenshot-to-code\" rel=\"noopener nofollow\"><span class=\"md-plain\">Screenshot to Code</span></a><span class=\"md-plain\">。</span></span></span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">把喜欢的网站截个图，上传上去，它直接给你转成代码。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">然后你再把代码喂给 AI，让它参考着做。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">准确度会高很多，抄样式肯定不如抄代码来的直接。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">4）此外，还可以直接套用现成的网站模板或者 GitHub 上的开源项目。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">推荐几个不错的网站模板资源：</span></p>\n<ul class=\"ul-list\">\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://html5up.net/\" rel=\"noopener nofollow\"><span class=\"md-plain\">HTML5 UP</span></a><span class=\"md-plain\">：免费的响应式网站合集，极简风格</span></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://cn.wordpress.org/themes/\" rel=\"noopener nofollow\"><span class=\"md-plain\">WordPress 官方主题库</span></a><span class=\"md-plain\">：1 万多个免费主题，啥类型都有</span></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://startbootstrap.com/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Start Bootstrap</span></a><span class=\"md-plain\">：Bootstrap 生态的免费网站模板库</span></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://colorlib.com/wp/free-wordpress-themes/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Colorlib</span></a><span class=\"md-plain\">：提供不少免费的网站模板，设计精美</span></span></p>\n</li>\n</ul>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这些网站模板都有源代码，你选个不错的下载下来，把代码丢给 AI 让它去改改内容就好了，样式基本准确还原。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h3 class=\"md-end-block md-heading\"><span class=\"md-plain\">方法 2、设计优先开发</span></h3>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这个方法特别适合做大项目。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">简单来说，就是 <span class=\"md-pair-s \"><strong>不要上来就让 AI 梭哈整个项目</strong><span class=\"md-plain\">。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">比如传统做法是这样的：帮我做一个包含用户系统、后台管理的完整 SaaS 平台。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">然后 AI 哗啦哗啦给你生成几十个文件，结果做完后发现页面风格不对，重新返工，浪费 Tokens。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">推荐的做法是 <span class=\"md-pair-s \"><strong>拆分步骤</strong><span class=\"md-plain\">，先让 AI 做个前端网站 Demo，纯静态页面就好。对设计满意了之后，再让 AI 基于 Demo 代码，用同样的风格开发完整项目。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">你像我生成出下面这种破玩意，肯定是不能让 AI 继续开发的！</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这里推荐一个很强大的 AI 设计工具 <span class=\"md-meta-i-c  md-link\"><a href=\"https://stitch.withgoogle.com/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Google Stitch</span></a><span class=\"md-plain\">。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">你只需要输入一段描述，它就能生成专业的界面原型。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">甚至你在纸上画个草图，拍照上传，它都能识别出来转成代码。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">你还可以人工修改设计的主题风格，或者人工标注要修改的部分，让 AI 帮你快速调整。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">设计完成后，导出文件或下载代码，再喂给 Cursor 等 AI 编程工具继续开发。这样风格就定下来了，不会跑偏。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">当然，如果你会用 <span class=\"md-meta-i-c  md-link\"><a href=\"https://www.figma.com/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Figma</span></a><span class=\"md-plain\"> 这种更专业的设计工具，你可以先在 Figma 里把网站设计得清清楚楚。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">然后搭配 <span class=\"md-meta-i-c  md-link\"><a href=\"https://github.com/GLips/Figma-Context-MCP\" rel=\"noopener nofollow\"><span class=\"md-plain\">Figma MCP</span></a><span class=\"md-plain\"> 扩展，让 AI 直接读取你的 Figma 设计文件，按照设计生成代码。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">此外，还有个工具叫 <span class=\"md-meta-i-c  md-link\"><a href=\"https://www.onlook.ai/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Onlook</span></a><span class=\"md-plain\">，号称为设计师准备的 Cursor，可以让设计师直接可视化编辑网页代码，设计和开发无缝衔接。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h3 class=\"md-end-block md-heading\"><span class=\"md-plain\">方法 3、丰富网站图片</span></h3>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">一般 AI 生成的网站是没有图片的，我们可以通过添加图片让网站更个性化。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">没必要让 AI 从 0 开始生图，只要告诉 AI 去主动找图、到哪里找图就好。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">图片资源主要包括插画、图标、真实照片和占位图这几类。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">1）插画库 <span class=\"md-meta-i-c  md-link\"><a href=\"https://undraw.co/\" rel=\"noopener nofollow\"><span class=\"md-plain\">unDraw</span></a><span class=\"md-plain\">：有非常多免费的 SVG 插画，而且可以自定义颜色。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">2）图标库 <span class=\"md-meta-i-c  md-link\"><a href=\"https://iconify.design/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Iconify</span></a><span class=\"md-plain\">：20 多万个免费矢量图标</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">3）真实照片 <span class=\"md-meta-i-c  md-link\"><a href=\"https://www.pexels.com/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Pexels</span></a><span class=\"md-plain\">：免费高质量图库，还提供了 API 快速搜索图片</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">4）占位图 <span class=\"md-meta-i-c  md-link\"><a href=\"https://picsum.photos/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Picsum Photos</span></a><span class=\"md-plain\">：直接用 URL 指定图片尺寸，每次刷新都是不同的真实照片</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">如果你的 AI 编程工具支持网页读取，可以直接让 AI 从这些网站搜索图片：</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>我要开发一个摄影作品集网站<br /><span>请根据需要，为网站搜索并集成图片资源：<br /><span><span class=\"cm-block-start cm-variable-2\">1.&nbsp;<span class=\"cm-variable-2\">插画：使用 undraw.co，搜索与网站内容相关的插画<br /><span><span class=\"cm-block-start cm-variable-2\">2.&nbsp;<span class=\"cm-variable-2\">图标：使用 Iconify 图标库<br /><span><span class=\"cm-block-start cm-variable-2\">3.&nbsp;<span class=\"cm-variable-2\">真实照片：使用 Pexels 搜索真实照片<br /><span><span class=\"cm-block-start cm-variable-2\">4.&nbsp;<span class=\"cm-variable-2\">占位图：使用 Picsum Photos 作为临时占位图</span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这下，生成的网站看起来成熟多了吧？</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h3 class=\"md-end-block md-heading\"><span class=\"md-plain\">方法 4、提示词约束</span></h3>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">就算不搞那些花里胡哨的工具，只要跟 AI 对话时，把你的要求说清楚，一样能让网站变专业。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">Claude 官方的 Cookbook 中有篇文章 <span class=\"md-meta-i-c  md-link\"><a href=\"https://platform.claude.com/cookbook/coding-prompting-for-frontend-aesthetics\" rel=\"noopener nofollow\"><span class=\"md-plain\">Frontend Aesthetics</span></a><span class=\"md-plain\">（前端美学），专门讲怎么避免让 AI 生成具有 AI 味儿的通用设计。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">下面讲几个我自己常用的提示词技巧。</span></p>\n<h4 class=\"md-end-block md-heading\"><span class=\"md-plain\">1）反向提示</span></h4>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">不要只说 “要什么”，更要说 “不要什么”。</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>设计禁止清单：<br /><span>❌ 紫色/靛蓝色渐变<br /><span>❌ 纯平背景色（必须有噪点或渐变）<br /><span>❌ Hero + 三卡片布局<br /><span>❌ 完美居中对齐<br /><span>❌ 高深的专业名词和无意义的空话<br /><span>❌ Emoji 作为功能图标<br /><span>❌ 线性动画 ease-in-out</span></span></span></span></span></span></span></span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">你把这些禁止项写清楚，AI 就不敢乱来了。</span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h4 class=\"md-end-block md-heading\"><span class=\"md-plain\">2）角色设定</span></h4>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">给 AI 定个人设，比如：</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>你是一位资深独立设计师，专注于《反主流》的网页美学。<br /><span>你鄙视千篇一律的 SaaS 模板，认为软件界面应该有触感和灵魂。<br /><span>你的创意边界：<br /><span>- \"现代但不要紫色\" → 可以试试深灰+橙色<br /><span>- \"极简但要有温度\" → 用大留白+手绘插画<br /><span>- \"科技感但不要冰冷\" → 用深色+暖色点缀</span></span></span></span></span></span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这样 AI 就知道，它不是在做标准答案，而是在做有个性的设计。</span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h4 class=\"md-end-block md-heading\"><span class=\"md-plain\">3）拒绝空洞文案</span></h4>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">AI 特别喜欢写那些 “听起来很厉害但啥也没说” 的文案。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">你得明确告诉它文案的要求：</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>网站的文字内容必须做到：<br /><span>- 具体化：\"每天节省 2 小时重复劳动\"（不要说\"提升生产力\"）<br /><span>- 口语化：\"用起来就像呼吸一样自然\"（不要说\"卓越的用户体验\"）<br /><span>- 带情绪：\"再也不用在 10 个群里找文件了\"（不要说\"高效协作\"）<br /><span>- 甚至可以挑衅：\"别再假装你会看完那些 PPT 了\"</span></span></span></span></span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这样文案就会更有人味儿了。</span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h4 class=\"md-end-block md-heading\"><span class=\"md-plain\">4）语境注入</span></h4>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">AI 老是生成通用设计，是因为它不知道你要传达什么 “感觉”。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">所以我们可以尝试 <span class=\"md-pair-s \"><strong>先给 AI 喂情绪，再提设计</strong><span class=\"md-plain\">。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">比如你要做个具有科技感的博客网站，可以这么说：</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>先阅读这段话：《黑客与画家》 - 编程语言是用来思考的<br /><span><span>​<br /><span>现在根据这种冷静、理性的情绪设计博客首页：<br /><span>- 配色：深灰+冷蓝<br /><span>- 布局：理性、有序<br /><span>- 感觉：沉思的、专注的</span></span></span></span></span></span></span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">AI 会把视觉参数（颜色、间距、字体）和文本的情感特征（冷静、理性）对齐，生成有特定氛围的设计。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">就像给演员说戏，不是告诉他演得开心一点，而是让他回忆一段开心的记忆，情绪自然就出来了。</span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h4 class=\"md-end-block md-heading\"><span class=\"md-plain\">5）复用提示词</span></h4>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">前面讲了这么多约束条件，你不能每次都重复人工编写一遍吧？</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">所以要保存提示词为项目规则文件 <span class=\"md-meta-i-c  md-link\"><a href=\"https://agents.md/\" rel=\"noopener nofollow\"><span class=\"md-plain\">AGENTS.md</span></a><span class=\"md-plain\">，便于多次复用。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://agents.md/\" rel=\"noopener nofollow\"><span class=\"md-plain\">AGENTS.md</span></a><span class=\"md-plain\"> 是一个开放标准，让不同的 AI 工具都能读取同一份规则文件，主流的 AI 编程工具（Cursor、Claude Code、Windsurf 等）都支持。</span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">比如这里我给大家准备了一套提示词模板，包含了前面讲的所有技巧：</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span><span class=\" cm-header cm-header1\"># 项目设计规则（AGENTS.md）<br /><span><span>​<br /><span><span class=\" cm-header cm-header2\">## 角色设定<br /><span>你是一位资深独立设计师，专注于 \"反主流\" 的网页美学。<br /><span>你鄙视千篇一律的 SaaS 模板，追求每个像素都有温度。<br /><span><span>​<br /><span><span class=\" cm-header cm-header2\">## ❌ 绝对禁止项<br /><span><span>​<br /><span><span class=\" cm-header cm-header3\">### 配色禁止<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">紫色/靛蓝色/蓝紫渐变（#6366F1、#8B5CF6）<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">纯平背景色（必须有噪点纹理或渐变）<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">Tailwind 默认色板<br /><span><span>​<br /><span><span class=\" cm-header cm-header3\">### 布局禁止<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">Hero + 三卡片布局<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">完美居中对齐<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">等宽多栏（必须不对称）<br /><span><span>​<br /><span><span class=\" cm-header cm-header3\">### 文案禁止<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">高深的专业名词和无意义的空话<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">Lorem Ipsum 占位文本<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">被动语态和长句<br /><span><span>​<br /><span><span class=\" cm-header cm-header3\">### 组件禁止<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">Shadcn/Material UI 默认组件（必须深度定制）<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">Emoji 作为功能图标<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">线性动画（ease-in-out）<br /><span><span>​<br /><span><span class=\" cm-header cm-header2\">## ✅ 必须遵守项<br /><span><span>​<br /><span><span class=\" cm-header cm-header3\">### 文案风格<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">口语化，像朋友聊天<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">具体化，有数字和场景<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">可以幽默、自嘲、甚至挑衅<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">每句话不超过 15 个字<br /><span><span>​<br /><span><span class=\" cm-header cm-header3\">### 图片系统<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">图标：使用 Iconify 图标库（https://iconify.design）<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">占位图：使用 Picsum Photos（https://picsum.photos）<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">真实图片：使用 Pexels 搜索（https://www.pexels.com）<br /><span><span class=\"cm-block-start cm-variable-2\">-&nbsp;<span class=\"cm-variable-2\">插画：使用 unDraw（https://undraw.co）</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">保存这个文件为 <span class=\"md-pair-s\"><code>AGENTS.md</code><span class=\"md-plain\">，放在项目根目录，以后每次跟 AI 对话，它都会自动读取这个文件，按照你的要求来工作。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">举个例子，输入跟之前一毛一样的需求 “帮我做个动漫视频网站”，有了规则文件后，效果立竿见影！</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h3 class=\"md-end-block md-heading\"><span class=\"md-plain\">方法 5、Agent Skills</span></h3>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">如果你觉得自己写提示词太麻烦，还有个更省事的办法 —— <span class=\"md-pair-s \"><strong>Agent Skills</strong><span class=\"md-plain\">。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">简单来说，Agent Skills 就是别人封装好的专业技能包，你直接在 AI 编程工具中安装就能用，让 AI 学会各种专业技能，比如制作 PPT、整理 Excel 表格等等。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">如果想让 AI 开发的网站更精美独特，可以用下面 2 个 Skills。</span></p>\n<h4 class=\"md-end-block md-heading\"><span class=\"md-plain\">Frontend-design</span></h4>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这是 Anthropic 官方出品的 <span class=\"md-meta-i-c  md-link\"><a href=\"https://github.com/anthropics/skills/tree/main/skills/frontend-design\" rel=\"noopener nofollow\"><span class=\"md-plain\">前端设计技能</span></a><span class=\"md-plain\">，可以教 AI 生成专业设计感网站。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">用法很简单，以 Claude Code 为例。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">首先打开 Claude Code 并输入命令，添加官方技能市场：</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>/plugin marketplace add anthropics/skills</span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这就像是在你的 AI 助手里开通了一个技能商店，接下来你就可以从商店中获取技能了。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">在 Claude Code 中输入命令，安装官方提供的技能包：</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>/plugin install example-skills@anthropic-agent-skills</span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这个 example-skills 包含了一堆官方示例技能，包括前端设计、网页测试、动图制作等等。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">装完之后，你就可以直接让 AI 使用这些技能了。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">比如你输入：帮我开发个人作品集网站。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">AI 会主动问你：我发现你安装了前端设计技能，需要用它来生成更具设计感的页面吗？</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">确认之后，AI 会利用技能生成代码，告别蓝紫渐变、生成独特风格的精美页面。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">不用每次都给 AI 输入一大堆相同的提示词，装一次技能就行了。</span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h4 class=\"md-end-block md-heading\"><span class=\"md-plain\">UI UX Pro Max</span></h4>\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://ui-ux-pro-max-skill.nextlevelbuilder.io/\" rel=\"noopener nofollow\"><span class=\"md-plain\">UI UX Pro MAX</span></a><span class=\"md-plain\"> 是我现在用下来最顺手的去 AI 味儿技能了，专门用于提升 AI 的设计能力。</span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">它支持几乎目前所有主流的 AI 编程工具，比如 Claude Code、Cursor、VS Code、Codex 等等。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">用法很简单，首先按照 <span class=\"md-meta-i-c  md-link\"><a href=\"https://github.com/nextlevelbuilder/ui-ux-pro-max-skill\" rel=\"noopener nofollow\"><span class=\"md-plain\">开源仓库文档</span></a><span class=\"md-plain\"> 的指引，安装官方提供的命令行工具：</span></span></span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span><span class=\"cm-builtin\">npm&nbsp;install&nbsp;<span class=\"cm-attribute\">-g&nbsp;uipro-cli</span></span></span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">然后进入到你的项目目录下，根据使用的 AI 工具执行对应的命令。比如我这里用 Cursor：</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>uipro init&nbsp;<span class=\"cm-attribute\">--ai&nbsp;cursor</span></span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">它会自动把技能安装到 Cursor 的配置目录里。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">接下来，当你让 AI 开发一个网站时，可以使用斜杠命令手动触发技能，或者让 AI 自动识别技能。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">1）AI 会根据你的需求识别出产品类型和需要的页面类型</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">2）然后调用 <span class=\"md-pair-s\"><code>search.py</code><span class=\"md-plain\"> 搜索脚本，在 data 目录里进行多维度搜索，找到适合的配色、字体、布局风格</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">3）综合搜索结果，生成完整的设计方案（主色调、字体组合、间距规范等）</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">4）最后，再按照设计方案生成代码</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这样一来，生成的界面既专业又有设计感。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">AI 不需要把所有规则都背下来，而是用到哪个查哪个，这就是 Agent Skills 的精髓。</span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h3 class=\"md-end-block md-heading\"><span class=\"md-plain\">方法 6、反 AI 味儿组件库</span></h3>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">前面提到，AI 为了保险，默认会选最主流的组件库，比如 Tailwind CSS、Shadcn UI 等。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这些库虽然专业，但也最容易产生 AI 味儿。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">所以我们可以反其道而行之，明确告诉 AI 用一些 <span class=\"md-pair-s \"><strong>小众但有特色</strong><span class=\"md-plain\"> 的组件库。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">比如 <span class=\"md-meta-i-c  md-link\"><a href=\"https://ui.aceternity.com/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Aceternity UI</span></a><span class=\"md-plain\"> 这个库专门做那种炫酷效果，什么闪光粒子（Sparkles）、极光背景（Aurora Background）、流星效果（Meteors），都是高计算量的视觉组件。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">AI 很难从零写出这么复杂的效果，但你直接让 AI 用这个库，几行代码就能搞定。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">要注意，对于这些相对小众的组件库，AI 可能不太熟悉用法。建议安装 Context7 插件，可以实时查询最新文档。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">或者直接把官方文档地址发给 AI 让它参考：</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>必须使用 Aceternity UI 设计网站<br /><span>你需要阅读官方文档来了解最新的使用方法：https://ui.aceternity.com/components</span></span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">网站的逼格立刻就上去了，完全不像 AI 生成的。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">还有很多我觉得有特点的 UI 组件库：</span></p>\n<ul class=\"ul-list\">\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://magicui.design/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Magic UI</span></a><span class=\"md-plain\">：150+ 动画组件，专门做微交互、流光边框、文字渐变</span></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://daisyui.com/\" rel=\"noopener nofollow\"><span class=\"md-plain\">DaisyUI</span></a><span class=\"md-plain\">：30+ 主题，有 cyberpunk、retro、cupcake 等风格</span></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://brutalistui.site/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Brutalist UI</span></a><span class=\"md-plain\">：粗野主义风格，粗边框、硬阴影、高对比</span></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://ui.glass/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Glass UI</span></a><span class=\"md-plain\">：玻璃拟态效果，半透明、模糊背景</span></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://github.com/ikun-svelte/ikun-ui\" rel=\"noopener nofollow\"><span class=\"md-plain\">ikun-ui</span></a><span class=\"md-plain\">：基于 Svelte.js 和 UnoCSS 的组件库</span></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.radix-ui.com/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Radix UI</span></a><span class=\"md-plain\">：无样式原语组件，完全自定义</span></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://mantine.dev/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Mantine</span></a><span class=\"md-plain\">：100+ 组件，功能丰富</span></span></p>\n</li>\n</ul>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">像我练习时长两年半，最喜欢 <span class=\"md-meta-i-c  md-link\"><a href=\"https://github.com/ikun-svelte/ikun-ui\" rel=\"noopener nofollow\"><span class=\"md-plain\">ikun-ui</span></a><span class=\"md-plain\"> 了~</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h3 class=\"md-end-block md-heading\"><span class=\"md-plain\">方法 7、自主配色（扩展知识）</span></h3>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">如果你想让网站更独特，完全走自己的路，那就得人工设计配色方案了。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这个方法适合有设计基础的朋友，可以用一些快速生成个性化配色的工具，比如：</span></p>\n<ul class=\"ul-list\">\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://coolors.co/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Coolors</span></a><span class=\"md-plain\">：主流的配色生成器，按空格键随机生成，支持导出多种格式</span></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://color.adobe.com/\" rel=\"noopener nofollow\"><span class=\"md-plain\">Adobe Color</span></a><span class=\"md-plain\">：Adobe 官方的专业配色工具</span></span></p>\n</li>\n</ul>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">生成好配色后，把色值告诉 AI，让它严格按照你的配色方案来设计。这样出来的网站，配色绝对独特。</span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h2 class=\"md-end-block md-heading\"><span class=\"md-plain\">实战案例</span></h2>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">前面我讲的这些方法是可以结合使用的。下面分享几个实战例子，大家可以感受下效果。</span></p>\n<h3 class=\"md-end-block md-heading\"><span class=\"md-plain\">案例 1、个人技术博客</span></h3>\n<h4 class=\"md-end-block md-heading\"><span class=\"md-plain\">优化前</span></h4>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">直接输入提示词：</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>开发个人技术博客网站首页</span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">效果是这样的，一眼 AI……</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h4 class=\"md-end-block md-heading\"><span class=\"md-plain\">优化后</span></h4>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">使用 <span class=\"md-pair-s\"><code>AGENTS.md</code><span class=\"md-plain\"> 提示词规则 + UI UX Pro Max 技能：</span></span></span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>开发个人技术博客网站首页</span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">得到的网站更有极客范儿，内容更充实。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h3 class=\"md-end-block md-heading\"><span class=\"md-plain\">案例 2、SaaS 产品落地页</span></h3>\n<h4 class=\"md-end-block md-heading\"><span class=\"md-plain\">优化前</span></h4>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">直接输入提示词：</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>开发 SaaS 产品《服务器运维监控平台》的落地页</span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">效果是这样的，又是蓝紫配色，一眼 AI……</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h4 class=\"md-end-block md-heading\"><span class=\"md-plain\">优化后</span></h4>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">使用 <span class=\"md-pair-s\"><code>AGENTS.md</code><span class=\"md-plain\"> 提示词规则 + UI UX Pro Max 技能 + 语境注入 + 反 AI 味儿组件库：</span></span></span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>开发 SaaS 产品《服务器运维监控平台》的落地页<br /><span><span>​<br /><span>先阅读这段话感受氛围：《黑客帝国》你选择蓝色药丸还是红色药丸？<br /><span>必须使用 Aceternity UI 设计网站<br /><span>你需要阅读官方文档来了解最新的使用方法：https://ui.aceternity.com/components</span></span></span></span></span></span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">网站背景变成了代码雨，也更像一个专业产品介绍页：</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h3 class=\"md-end-block md-heading\"><span class=\"md-plain\">案例 3、健身 APP 落地页（移动端）</span></h3>\n<h4 class=\"md-end-block md-heading\"><span class=\"md-plain\">优化前</span></h4>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">直接输入提示词：</span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>开发健身 APP 落地页（移动端）</span></pre>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">效果…… 这啥玩意，不评价了……</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h4 class=\"md-end-block md-heading\"><span class=\"md-plain\">优化后</span></h4>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">使用 <span class=\"md-pair-s\"><code>AGENTS.md</code><span class=\"md-plain\"> 提示词规则 + UI UX Pro Max 技能 + 反 AI 味儿组件库：</span></span></span></p>\n<pre class=\"md-fences md-end-block ty-contain-cm modeLoaded\"><span>开发健身 APP 落地页（移动端）<br /><span><span>​<br /><span>必须使用 IKun UI 设计网站<br /><span>你需要阅读官方文档来了解最新的使用方法：https://ikun-ui.netlify.app</span></span></span></span></span></pre>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">这下得到的页面更真实可用了，对比还是非常明显的吧！</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h2 class=\"md-end-block md-heading\"><span class=\"md-plain\">最后</span></h2>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">看到这里你应该意识到，现在 AI 开发网站的能力已经非常强了。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">有朋友觉得 AI 生成的效果不理想，可能只是因为没给它足够明确的指令。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">就像一个厨师，你只说做个好吃的，他为了保险只能做最大众化的家常菜。但你说 “多放辣椒、不要花椒、多放豆瓣酱”，他就能做出你想要的味道。</span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-pair-s \"><strong>记住，AI 是工具，你才是主导者。</strong></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-plain\">学会了或者学废了的朋友们，点个赞吧~ 你可以在我免费开源的<span class=\"md-meta-i-c  md-link\"><a href=\"https://github.com/liyupi/ai-guide\" rel=\"noopener nofollow\"><span class=\"md-plain\">《AI 编程零基础入门教程》</span></a><span class=\"md-plain\">中学到更多 AI 编程技巧。</span></span></span></p>\n<p class=\"md-end-block md-p\"><span class=\"md-image md-img-loaded\"><img class=\"lazyload\" /></span></p>\n<p class=\"md-end-block md-p\">&nbsp;</p>\n<h2 class=\"md-end-block md-heading\"><span class=\"md-plain\">更多编程学习资源</span></h2>\n<ul class=\"ul-list\">\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/course\" rel=\"noopener nofollow\"><span class=\"md-plain\">Java前端程序员必做项目实战教程+毕设网站</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/\" rel=\"noopener nofollow\"><span class=\"md-plain\">程序员免费编程学习交流社区（自学必备）</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/course/cv\" rel=\"noopener nofollow\"><span class=\"md-plain\">程序员保姆级求职写简历指南（找工作必备）</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.mianshiya.com/\" rel=\"noopener nofollow\"><span class=\"md-plain\">程序员免费面试刷题网站工具（找工作必备）</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1640584449888772098\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新Java零基础入门学习路线 + Java教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1640586673306091521\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新Python零基础入门学习路线 + Python教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1640586014108303362\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新前端零基础入门学习路线 + 前端教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1640586867363954689\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新数据结构和算法零基础入门学习路线 + 算法教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1644279832026075138\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新C++零基础入门学习路线、C++教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1641797333479903234\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新数据库零基础入门学习路线 + 数据库教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1640589994284695553\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新Redis零基础入门学习路线 + Redis教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1641035880439271426\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新计算机基础入门学习路线 + 计算机基础教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1641366118197153793\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新小程序入门学习路线 + 小程序开发教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"http://sqlmother.yupi.icu/\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新SQL零基础入门学习路线 + SQL教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1640586295529324545\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新Linux零基础入门学习路线 + Linux教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1640588753362108417\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新Git/GitHub零基础入门学习路线 + Git教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1640587909942099969\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新操作系统零基础入门学习路线 + 操作系统教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1640588119619551233\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新计算机网络零基础入门学习路线 + 计算机网络教程</span></a></span></p>\n</li>\n<li class=\"md-list-item\">\n<p class=\"md-end-block md-p\"><span class=\"md-meta-i-c  md-link\"><a href=\"https://www.code-nav.cn/post/1640588392073150465\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新设计模式零基础入门学习路线 + 设计模式教程</span></a></span></p>\n</li>\n<li class=\"md-list-item md-focus-container\">\n<p class=\"md-end-block md-p md-focus\"><span class=\"md-meta-i-c md-link md-expand\"><a href=\"https://www.code-nav.cn/post/1640648711119892481\" rel=\"noopener nofollow\"><span class=\"md-plain\">最新软件工程零基础入门学习路线 + 软件工程教程</span></a></span></p>\n</li>\n</ul>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-30 16:18</span>&nbsp;\n<a href=\"https://www.cnblogs.com/yupi\">程序员鱼皮</a>&nbsp;\n阅读(<span id=\"post_view_count\">20</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "上天翼云，一键开启你的AI助手“Moltbot”（原名Clawdbot）！",
      "link": "https://www.cnblogs.com/developer-tianyiyun/p/19554208",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/developer-tianyiyun/p/19554208\" id=\"cb_post_title_url\" title=\"发布于 2026-01-30 16:13\">\n    <span>上天翼云，一键开启你的AI助手“Moltbot”（原名Clawdbot）！</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<p align=\"center\">现在，上天翼云</p>\n<p align=\"center\">即刻拥有“<strong>7x24</strong><strong>小时在线的AI助手</strong>”——</p>\n<p align=\"center\">“<strong>Moltbot</strong>”（原名Clawdbot）！<br />\n<br />\n</p>\n<h3 align=\"center\"><strong>什么是“Moltbot”？</strong></h3>\n<h3 align=\"center\"><strong>你的私人AI“超级助理”！</strong></h3>\n<p>“Moltbot”不是普通的聊天机器人，它是扎根在你工作流中的智能管家：</p>\n<ul>\n<li><strong>超级智能助手</strong></li>\n</ul>\n<p>支持接入多种主流LLM（如Claude、GPT系列），集各家之所长。</p>\n<ul>\n<li><strong>多平台无缝集成</strong></li>\n</ul>\n<p>可轻松集成到iMessage、QQ、飞书、钉钉等平台…随时随地可用。</p>\n<ul>\n<li><strong>记忆力超好</strong></li>\n</ul>\n<p>记住你的习惯、项目细节，像老搭档一样懂你。</p>\n<ul>\n<li><strong>技能多多</strong></li>\n</ul>\n<p>安装插件，让它写代码、找资料、做报表、管理日程…无所不能。</p>\n<ul>\n<li><strong>自动化大师</strong></li>\n</ul>\n<p>设置任务流，自动整理日报、爬取数据、监控信息，告别重复劳动。</p>\n<p>&nbsp;</p>\n<p>在天翼云，既可以通过“<strong>息壤应用托管</strong>”平台运行“Moltbot”，也可以选择<strong>弹性云主机、AI云电脑</strong>一键部署，获得前所未有的强大保障与极致轻松：</p>\n<h3 align=\"center\"><strong>开通入口一</strong></h3>\n<h3 align=\"center\"><strong>通过息壤应用托管实现Moltbot部署</strong></h3>\n<p>在天翼云“息壤应用托管”平台运行“Moltbot”，甩掉服务器、环境配置等技术包袱，提供强大稳定的云端算力，为用户提供“<strong>资源-平台-服务-模型-组件-MCP</strong>”等一体化AI应用配套；支持应用一键订阅，真正开箱即用。从部署到管理的所有技术脏活累活，它替你搞定，让你只专注业务创新，快速落地像“Moltbot”这样的优质智能应用。</p>\n<p>&nbsp;<img alt=\"\" class=\"lazyload\" /></p>\n<p><strong>1.登录天翼云官网</strong>，进入天翼云控制台并点击<strong>【息壤-应用托管】</strong>；</p>\n<p><strong>2.</strong>在应用市场中找到“<strong>Moltbot</strong>”，点击<strong>【开启应用】</strong>；</p>\n<p><strong>3.</strong>根据指引完成简单配置，点击<strong>【部署应用】</strong>，你的AI助手即刻上岗！</p>\n<p>&nbsp;<img alt=\"\" class=\"lazyload\" /></p>\n<p align=\"center\"><strong>复制链接</strong></p>\n<p align=\"center\"><strong><span style=\"text-decoration: underline;\"><a href=\"https://www.ctyun.cn/products/application\" rel=\"noopener nofollow\">https://www.ctyun.cn/products/application</a></span></strong></p>\n<p align=\"center\"><strong>进入息壤应用托管</strong><br />\n<br />\n</p>\n<h3 align=\"center\"><strong>开通入口二</strong></h3>\n<h3 align=\"center\"><strong>通过AI云电脑实现Moltbot部署</strong></h3>\n<ul>\n<li><strong>智能与安全兼得</strong></li>\n</ul>\n<p>把Moltbot部署在云端隔离环境，数据全程留存在云端，办公智能，使用安心。</p>\n<ul>\n<li><strong>多系统支持，Windows用户也能轻松上车</strong></li>\n</ul>\n<p>额外支持Windows系统，云电脑老用户也能切换体验，让AI智能体真正走进日常办公。</p>\n<ul>\n<li><strong>免设置，零门槛体验</strong></li>\n</ul>\n<p>云电脑已内置大模型，点击桌面Moltbot图标可零门槛体验，技术小白也会用。</p>\n<p>&nbsp;<img alt=\"\" class=\"lazyload\" /></p>\n<p align=\"center\">无论你是小白用户还是进阶玩家</p>\n<p align=\"center\">都可以根据链接中的指引完成配置</p>\n<p align=\"center\"><strong><span style=\"text-decoration: underline;\"><a href=\"https://www.ctyun.cn/document/10027004/11091012\" rel=\"noopener nofollow\">https://www.ctyun.cn/document/10027004/11091012</a></span></strong></p>\n<p align=\"center\">&nbsp;</p>\n<h3 align=\"center\"><strong>开通入口三</strong></h3>\n<h3 align=\"center\"><strong>通过弹性云主机实现Moltbot部署</strong></h3>\n<p><strong>1.登录天翼云官网</strong>，进入天翼云控制台-计算控制台-弹性云主机页；</p>\n<p><strong>2.</strong>点击<strong>【创建云主机】</strong>，云主机规格推荐【通用型-s6.large.2】。镜像类型选择云镜像市场，并选取【Moltbot-v2026.1.24-3-CtyunOS25.07】镜像。</p>\n<p><strong>3.</strong>根据指引完成简单配置，点击<strong>【立即购买】</strong>，你的AI助手随时待命！<strong>复制链接</strong></p>\n<p align=\"center\"><strong>使用云主机一键部署Moltbot（Clawdbot）</strong></p>\n<p align=\"center\"><strong><span style=\"text-decoration: underline;\"><a href=\"https://www.ctyun.cn/document/10026730/11091001\" rel=\"noopener nofollow\">https://www.ctyun.cn/document/10026730/11091001</a></span></strong></p>\n<p>&nbsp;</p>\n<p>依托云基础设施的坚实底座，Moltbot全方位赋能办公全场景：7×24小时弹性云主机保障AI助手永不离线，Moltbot AI云电脑将云端AI能力融入工作流，微信、WPS、飞书、钉钉、QQ等常用办公软件一键导入、无缝衔接，零部署零学习，智能办公高效直达，让效率时刻在线。<br />\n<br />\n</p>\n<p align=\"center\">0门槛开启“Moltbot”智能时代</p>\n<p align=\"center\">\n让智能AI助手</p>\n<p align=\"center\">成为你效率跃升的秘密武器！</p>\n<p>&nbsp;</p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-30 16:13</span>&nbsp;\n<a href=\"https://www.cnblogs.com/developer-tianyiyun\">天翼云开发者社区</a>&nbsp;\n阅读(<span id=\"post_view_count\">0</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "国内四大AI编程IDE对比（二）：从零构建桌面应用实测（补上Trae，幸亏补上了）",
      "link": "https://www.cnblogs.com/haibindev/p/19554073",
      "published": "",
      "description": "<div class=\"postTitle\">\n\t\t<h1><a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/haibindev/p/19554073\" id=\"cb_post_title_url\" title=\"发布于 2026-01-30 15:54\">\n    <span>国内四大AI编程IDE对比（二）：从零构建桌面应用实测（补上Trae，幸亏补上了）</span>\n    \n\n</a>\n</h1>\n\t</div>\n\t    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        <img alt=\"国内四大AI编程IDE对比（二）：从零构建桌面应用实测（补上Trae，幸亏补上了）\" class=\"desc_img\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260119212931111-1543567697.png\" />\n        在上一篇对比中，我们从直观感受和技术架构角度审视了四大AI编程IDE。但说实话，那些都只是表面功夫——真正的考验在于**实战能力**。\n\n作为一名在视频技术、后端架构领域深耕十余年的开发者，我深知：再炫酷的功能，不如能跑起来的代码。所以今天，我要来点硬核的——让这三大AI IDE从零开始构建一个完整的C++桌面录屏程序。\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"国内四大ai编程ide对比二从零构建桌面应用实测补上trae\">国内四大AI编程IDE对比（二）：从零构建桌面应用实测（补上Trae）</h1>\n<h2 id=\"前言\">前言</h2>\n<p>在上一篇对比中，我们从直观感受和技术架构角度审视了四大AI编程IDE。但说实话，那些都只是表面功夫——真正的考验在于<strong>实战能力</strong>。</p>\n<p>作为一名在视频技术、后端架构领域深耕十余年的开发者，我深知：再炫酷的功能，不如能跑起来的代码。所以今天，我要来点硬核的——让这三大AI IDE从零开始构建一个完整的C++桌面录屏程序。</p>\n<p>为什么选C++？因为难度高、依赖少，而且我太熟悉了，能精准判断它们的表现。</p>\n<p>测试规则很简单：</p>\n<ul>\n<li>每个IDE独立创建目录</li>\n<li>统一要求：<strong>\"开始前先阅读仓库根目录PRJ.md，后续所有实现都以它为准\"</strong></li>\n<li>看谁能最快生成可运行的项目</li>\n</ul>\n<p>废话不多说，上硬菜。</p>\n<hr />\n<h2 id=\"一百度comate老牌ai的翻车现场\">一、百度Comate：老牌AI的\"翻车\"现场</h2>\n<h3 id=\"11-对需求的理解\">1.1 对需求的理解</h3>\n<p>百度做人工智能很多年了，文心大模型算得上是国内第一批对话模型（这个说法有待考证，但确实资历够老）。按说应该实力雄厚。</p>\n<p><img alt=\"1\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121112498-557233913.jpg\" /></p>\n<p>输入要求后，Comate给出了项目理解，看起来还算靠谱。</p>\n<p><img alt=\"3\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121229146-1673647540.png\" /></p>\n<h3 id=\"12-代码生成阶段\">1.2 代码生成阶段</h3>\n<p>Comate很快就完成了代码生成，告诉我可以构建了。我看了一下目录结构，第一反应就有点懵：</p>\n<p><img alt=\"4\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121238235-524015797.png\" /></p>\n<p><strong>问题一：怎么只有一个cpp文件？</strong> 其他的只有头文件，这是完整项目吗？</p>\n<p><strong>问题二：.rc资源文件竟然没有对话框资源描述</strong>，只有一个菜单和字符串。</p>\n<p>不过，Comate有个我挺喜欢的功能——<strong>每个函数上方都有快捷按键</strong>，可以直接调用AI辅助编程。这一点其他两家暂时没发现。</p>\n<p><img alt=\"5\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121244389-1444300064.png\" /></p>\n<p>好吧，继续编译看看。</p>\n<h3 id=\"13-编译阶段的灾难\">1.3 编译阶段的灾难</h3>\n<p><img alt=\"7\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121252778-1329247887.png\" /></p>\n<p>果然，它发现了没有源文件。接下来等待创建完成，然后开始编译——<strong>噩梦开始了</strong>。</p>\n<p><img alt=\"8\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121258859-1001444747.png\" /><br />\n<img alt=\"9\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121303617-1841188384.png\" /></p>\n<p>Comate发现语法错误，但它完全没有理解到问题本质（缺少头文件引用），反而误判为\"文件编码错误\"，就开始删除文件、重新生成。</p>\n<p>更离谱的是，再次编译时出现了读取报错行数的bug，然后陷入了一个死循环：</p>\n<blockquote>\n<p>编译报错 → 删除文件 → 重新生成 → 再次报错 → 再次删除</p>\n</blockquote>\n<p>我不得不人工提醒它加上头文件。</p>\n<p><img alt=\"10\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121309995-187838857.png\" /></p>\n<h3 id=\"14-运行失败的挣扎\">1.4 运行失败的挣扎</h3>\n<p>在我的辅助下，终于成功编译了。但是——<strong>程序无法运行，没有对话框，启动后立刻退出</strong>。</p>\n<p><img alt=\"12\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121315873-1424363537.png\" /></p>\n<p>因为到这时，它依然没有在资源文件中填写对话框资源。</p>\n<p>在我反复三次告知\"启动失败\"后，它终于发现了这个问题。</p>\n<p><img alt=\"14\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121321954-1903595145.png\" /></p>\n<p>资源有了，继续编译。Comate又花了大量时间调试log——关键是<strong>它自己删掉了log文件，却自己不知道</strong>，然后发现构建失败，却始终没能解决log问题。</p>\n<p>我不得不启动Visual Studio，手动帮它解决了这个问题。</p>\n<h3 id=\"15-最后的挣扎\">1.5 最后的挣扎</h3>\n<p>之后Comate一直尝试解决\"没有对话框界面\"的问题，想通过创建消息框来验证。这个思路是好的，但可惜又陷入了编译问题，多次都无法解决。</p>\n<p><strong>到这里已经一个半小时了</strong>。我只能停下——毕竟只是测试，不能花大量时间帮AI解决编译问题吧。</p>\n<hr />\n<h2 id=\"二阿里通义灵码千问加持下的幻觉\">二、阿里通义灵码：千问加持下的\"幻觉\"</h2>\n<h3 id=\"21-对需求的理解\">2.1 对需求的理解</h3>\n<p>通义灵码是阿里云基于通义代码大模型开发的智能编码助手，有千问加持，理论上应该还不错。</p>\n<p><img alt=\"1\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121338598-894258991.png\" /></p>\n<p>输入要求后，Lingma给出了项目理解，感觉差不多，还贴心地生成了一个待办列表。</p>\n<p><img alt=\"2\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121343350-1073863525.png\" /></p>\n<h3 id=\"22-生成阶段的次数过多警告\">2.2 生成阶段的\"次数过多\"警告</h3>\n<p>但是生成没多久，Lingma就弹出提示：<strong>\"使用次数过多\"</strong>。</p>\n<p>我迷惑了——现在都是IDE在自动执行啊，顶多5分钟，这就次数过多了？</p>\n<p><img alt=\"3\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121348811-708759815.png\" /></p>\n<h3 id=\"23-编译阶段的乱码和错误\">2.3 编译阶段的乱码和错误</h3>\n<p>生成完成后的结构如下：</p>\n<p><img alt=\"4\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121354925-186141498.png\" /></p>\n<p>相比Comate，Lingma合理一点：至少每个类都有cpp文件。但高兴没多久，终端执行编译脚本时出现了中文乱码。</p>\n<p><img alt=\"5\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121400249-65973951.png\" /></p>\n<p>接下来和Comate一样，出现了编译语法错误。这次不是头文件包含问题，而是和系统定义冲突了。</p>\n<p><img alt=\"7\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121406131-1236232869.png\" /></p>\n<p>但它依然没有能力发现这一点，我只能手动给它重命名。</p>\n<h3 id=\"24-资源文件和ai幻觉\">2.4 资源文件和AI幻觉</h3>\n<p>然后我发现Lingma对资源文件的生成上同样没有写入对话框资源。</p>\n<p>接下来，Lingma进入了自己的\"幻觉阶段\"——它告诉我编译好了，生成了可执行文件。</p>\n<p><img alt=\"9\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121413886-1382904502.png\" /></p>\n<p>可是<strong>输出目标目录下，根本没有任何东西</strong>。这就是AI幻觉么？</p>\n<p><img alt=\"10\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121418557-790638576.png\" /></p>\n<p>接着又是枯燥的编译错误，甚至出现了定义了<code>std::wstring</code>宽字符串却赋值给<code>std::string</code>的低级错误。</p>\n<p><img alt=\"13\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121424977-206129183.png\" /></p>\n<p>最后经过我手动修复，终于成功编译了exe文件。然而，同样无法使用——没有界面。</p>\n<p>到此我的测试结束了。</p>\n<hr />\n<h2 id=\"三腾讯codebuddy相对表现最好的选手\">三、腾讯CodeBuddy：相对表现最好的选手</h2>\n<h3 id=\"31-对需求的理解\">3.1 对需求的理解</h3>\n<p>CodeBuddy是腾讯云推出的AI代码助手。最近还更新了，据说<strong>90%代码由CodeBuddy自己生成，能力比肩Claude Code</strong>。而且CodeBuddy还有国际版，整合了GPT-5、Gemini等AI模型。</p>\n<p><img alt=\"1\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121437013-25238881.png\" /></p>\n<p>输入要求后，CodeBuddy给出了项目理解，比较简洁，而且生成了任务清单。</p>\n<p><img alt=\"2\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121442039-1017011081.png\" /></p>\n<p>这一点体验比较好——后面我使用CodeBuddy的时候，它经常会对我提出的要求制作清单，然后按照清单逐项完成。</p>\n<h3 id=\"32-改动计划\">3.2 改动计划</h3>\n<p>这是它生成的改动计划，逻辑清晰，步骤明确。</p>\n<p><img alt=\"3\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121447599-1511103472.png\" /></p>\n<h3 id=\"33-代码生成结构\">3.3 代码生成结构</h3>\n<p>代码生成完成后的目录结构：</p>\n<p><img alt=\"4\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121453593-510275934.png\" /></p>\n<p>我第一眼觉得：<strong>怎么这么少？好像缺乏核心的编码模块</strong>。不过有可能它是要分步完成。</p>\n<p>但有一个惊喜：<strong>CodeBuddy生成的资源文件有界面对话框的描述</strong>！这在Comate和Lingma里都没有。这是个好现象，到目前位置，这个IDE感觉比百度Comate和阿里Lingma专业一点。</p>\n<h3 id=\"34-逐步补全的过程\">3.4 逐步补全的过程</h3>\n<p>接下来就是它逐步补全代码的过程，从界面交互上看，体验是比较好的：</p>\n<p><img alt=\"7\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121502959-202095881.png\" /></p>\n<p><img alt=\"8\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121507816-1798577475.png\" /></p>\n<h3 id=\"35-同样无法运行的结局\">3.5 同样无法运行的结局</h3>\n<p>然而，CodeBuddy也开始进入\"解决exe运行不起来、没有界面\"的阶段。反复修改都始终定位不到关键问题点。</p>\n<p>经过我的提示，才发现是<strong>MFC没有正确初始化</strong>的问题。然后是和另外两家同样的问题：MFC程序的入口函数问题。</p>\n<p><img alt=\"10\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129121512935-1315165421.png\" /></p>\n<p>它花了大约十几分钟反复解决这个问题，都没有进展。我放弃了，结束测试。</p>\n<p><strong>补充</strong>：以上codeBuddy模型我是手动选择了kimi-k2-thingk，后来我把codebuddy的模型切换成了deepseek，然后重新测试了一遍，这是在deepseek下IDE对项目的认知：<br />\n<img alt=\"11\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260129173119338-804712388.png\" /></p>\n<p>这次不知道为什么，没有生成任务清单，直接就开始生成了编译了。然后我又测试了20多分钟吧，它又陷入了修正MFC资源文件和编译错误中，感觉切换模型并没有什么明显的提高。</p>\n<hr />\n<h2 id=\"四字节跳动traesolo模式创造奇迹\">四、字节跳动Trae：Solo模式创造奇迹</h2>\n<p>本来以为测试到此为止了，但想起字节跳动的Trae还没试过。抱着\"多一个参考\"的心态，我也把它加进来了。</p>\n<h3 id=\"41-ide模式下的表现\">4.1 IDE模式下的表现</h3>\n<p>Trae的模型选择默认是Auto模式，这倒省心。</p>\n<p>首先是对md文件的理解，和其他几家差不多，就不贴图了。Trae也有类似的任务清单机制：</p>\n<p><img alt=\"2\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260130155213917-354366266.png\" /><br />\n<img alt=\"3\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260130155217325-1265067368.png\" /></p>\n<p>不过Trae对于程序界面采用了和其他三家AI不同的策略：<strong>不用MFC对话框，而是用MFC窗口</strong>。</p>\n<p>没过多久，代码也生成完毕了：</p>\n<p><img alt=\"4\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260130155223481-143215757.png\" /></p>\n<p>使用过程中，也会弹出\"模型思考次数达到上限\"的提示：</p>\n<p><img alt=\"6\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260130155228649-1843176243.png\" /></p>\n<p>接下来就是编译和解决问题的过程。意外的是——很快，Trae也陷入了死循环：不停删除文件→创建文件→发现错误→删除文件。</p>\n<p><img alt=\"7\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260130155233620-263150802.png\" /></p>\n<p>于是我直接结束了IDE模式的测试。</p>\n<h3 id=\"42-solo模式的意外发现\">4.2 Solo模式的意外发现</h3>\n<p>不过Trae还有一个<strong>Solo模式</strong>，看着界面很不一样，我抱着\"试一试\"的心态点进去——结果给了我意外的惊喜：</p>\n<p><img alt=\"1\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260130155516140-1965198109.png\" /></p>\n<p>Solo模式的布局完全不同：编辑区在右侧，左侧是任务区（看来支持多个任务同时运行），中间是AI思考和对话区域。</p>\n<p>让它阅读文档后开始执行，刚开始也是跟IDE模式同样的过程。但这次生成的代码是<strong>分开了头文件和源文件</strong>：</p>\n<p><img alt=\"3\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260130155248008-137584944.png\" /></p>\n<p>中间也还是有编译问题，但这次我并没有手动帮它指出错误。<strong>它自己循环了几次之后解决了问题</strong>，然后生成了exe可执行文件。</p>\n<p>但是运行还是没有界面。我想着可能也就到此为止了——其他几个最多也就到这个程度，准备结束了。</p>\n<p>不过我发现，它<strong>自己在检查程序是否出现了界面</strong>：</p>\n<p><img alt=\"6\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260130155304081-259621923.png\" /></p>\n<p>于是我等了一会儿，继续和它交互。经过几轮之后，<strong>它还真的解决了界面的问题</strong>：</p>\n<p><img alt=\"8\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260130155309367-118932972.png\" /></p>\n<p>虽然说是DOS风格吧，但最起码——这也是这几个国产AI IDE的纪录了：终于有个IDE能完成最初的目标了！</p>\n<h3 id=\"43-自动化测试的震撼\">4.3 自动化测试的震撼</h3>\n<p>当然，测试了一下，还是不能正常录制。我继续给它反馈。反馈了几回后，Trae开始自己做自动化测试了：</p>\n<p><img alt=\"10\" src=\"https://img2024.cnblogs.com/blog/254714/202601/254714-20260130155315341-672284183.png\" /></p>\n<p>这下好了——我不用管了。它自己想办法打印日志，然后自己读日志，再去修改代码，再次测试。</p>\n<p>最终用时接近2个小时，<strong>它解决了问题，现在终于有个IDE可以完整实现最初的目标了</strong>。</p>\n<p>说实话，这种AI自动化测试能力，我之前只在Python、Web项目开发中见过，没想到对C++桌面应用也可以。这确实让我开了眼界。</p>\n<blockquote>\n<p>不过话说，现在用着是免费的，等将来收费了，这种模式这额度不得一天就给干没了？</p>\n</blockquote>\n<hr />\n<h2 id=\"五总结与反思\">五、总结与反思</h2>\n<h3 id=\"51-四家表现对比\">5.1 四家表现对比</h3>\n<table>\n<thead>\n<tr>\n<th>维度</th>\n<th>百度Comate</th>\n<th>阿里通义灵码</th>\n<th>腾讯CodeBuddy</th>\n<th>字节Trae（Solo模式）</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>需求理解</td>\n<td>⭐⭐⭐⭐</td>\n<td>⭐⭐⭐⭐</td>\n<td>⭐⭐⭐⭐⭐</td>\n<td>⭐⭐⭐⭐</td>\n</tr>\n<tr>\n<td>代码结构</td>\n<td>⭐⭐</td>\n<td>⭐⭐⭐</td>\n<td>⭐⭐⭐⭐</td>\n<td>⭐⭐⭐⭐</td>\n</tr>\n<tr>\n<td>资源文件</td>\n<td>⭐⭐</td>\n<td>⭐⭐</td>\n<td>⭐⭐⭐⭐</td>\n<td>⭐⭐⭐</td>\n</tr>\n<tr>\n<td>编译能力</td>\n<td>⭐</td>\n<td>⭐</td>\n<td>⭐⭐</td>\n<td>⭐⭐⭐</td>\n</tr>\n<tr>\n<td>错误定位</td>\n<td>⭐</td>\n<td>⭐</td>\n<td>⭐⭐</td>\n<td>⭐⭐⭐⭐</td>\n</tr>\n<tr>\n<td><strong>最终完成度</strong></td>\n<td>❌</td>\n<td>❌</td>\n<td>❌</td>\n<td>✅</td>\n</tr>\n<tr>\n<td>整体体验</td>\n<td>⭐⭐</td>\n<td>⭐⭐</td>\n<td>⭐⭐⭐</td>\n<td>⭐⭐⭐⭐</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"52-共性问题分析\">5.2 共性问题分析</h3>\n<p>四款IDE都暴露了一些共同问题：</p>\n<ol>\n<li><strong>编译配置薄弱</strong>：都不擅长处理C++的复杂编译配置</li>\n<li><strong>资源文件缺失</strong>：除了CodeBuddy略有改进，其他都未能正确生成对话框资源</li>\n<li><strong>错误定位不准</strong>：无法精准定位编译错误的根本原因（除了Trae Solo模式）</li>\n<li><strong>存在AI幻觉</strong>：会告诉用户\"编译成功\"但实际并没有生成文件</li>\n<li><strong>陷入死循环</strong>：遇到问题时容易陷入重复错误的循环</li>\n</ol>\n<h3 id=\"53-我的判断\">5.3 我的判断</h3>\n<p>坦率地说，<strong>前三家IDE都没能完成这次从零构建的挑战</strong>。它们都理解了需求，都生成了代码，都有完整功能，但在编译、头文件包含、MFC入口函数、工程设置上频繁出错。</p>\n<p><strong>但字节Trae的Solo模式给了我一个惊喜：</strong></p>\n<ul>\n<li>它通过自主调试、自动化测试，最终解决了所有问题</li>\n<li>虽然花了近2小时，但这是<strong>唯一成功完成项目</strong>的AI IDE</li>\n<li>它的自动化测试能力，让我看到了AI编程的未来可能</li>\n</ul>\n<p><strong>如果给这四家排个序：</strong></p>\n<ol>\n<li><strong>字节Trae（Solo模式）</strong>：唯一完成任务，自动化测试能力惊艳</li>\n<li><strong>腾讯CodeBuddy</strong>：任务清单机制优秀，但未能完成最终目标</li>\n<li><strong>百度Comate</strong>：函数快捷按键创新，但编译阶段灾难级</li>\n<li><strong>阿里通义灵码</strong>：AI幻觉明显，体验最差</li>\n</ol>\n<h3 id=\"54-给开发者的建议\">5.4 给开发者的建议</h3>\n<p>这次测试让我对AI编程IDE有了更清醒的认识：</p>\n<ol>\n<li><strong>Solo模式值得关注</strong>：字节Trae的Solo模式展现了AI自主编程的可能性</li>\n<li><strong>自动化测试是关键</strong>：AI能否自己写测试、自己跑测试，决定了它能否解决复杂问题</li>\n<li><strong>不要指望\"一键完成\"</strong>：至少现阶段，这些AI IDE仍需开发者深度参与</li>\n<li><strong>C++支持有待提升</strong>：复杂的项目配置，AI IDE还很吃力</li>\n<li><strong>选择适合的场景</strong>：Python、Web项目可能比C++更适合AI辅助开发</li>\n</ol>\n<p><strong>下一篇预告：</strong> 我会测试\"现有工程重构能力\"，看看这些AI IDE能否理解并重构一个真实的项目代码。</p>\n<hr />\n<p><strong>作者简介：</strong> 10年+视频技术、后端架构、AI应用开发经验，曾任某互联网大厂技术专家。对AI编程工具、云原生架构、视频处理技术有深入研究。</p>\n<hr />\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/254714/202307/254714-20230701143418754-1351786962.jpg\" /></p>\n<p><strong>合作请加WX：hbstream</strong><br />\n<strong>（<a href=\"http://haibindev.cnblogs.com\" target=\"_blank\">http://haibindev.cnblogs.com</a>），转载请注明作者和出处</strong></p>\n\n\n</div>\n<div class=\"clear\"></div>\n\n\t<div class=\"postDesc\">posted on \n<span id=\"post-date\">2026-01-30 15:54</span>&nbsp;\n<a href=\"https://www.cnblogs.com/haibindev\">haibindev</a>&nbsp;\n阅读(<span id=\"post_view_count\">14</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "同学！你见过会“流血”的算法吗？C++深搜遍历图的每条路径可视化程序！",
      "link": "https://www.cnblogs.com/lixingqiu/p/19553822",
      "published": "",
      "description": "<h1 class=\"postTitle\"><a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/lixingqiu/p/19553822\" id=\"cb_post_title_url\" title=\"发布于 2026-01-30 15:19\">\n    <span>同学！你见过会“流血”的算法吗？C++深搜遍历图的每条路径可视化程序！</span>\n    \n\n</a>\n</h1>\n\t<div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<p><img alt=\"C++深搜遍历图的每条路径可视化程序.mp4_20260130_150827.397\" class=\"lazyload\" height=\"393\" width=\"524\" /></p>\n<p>&nbsp;</p>\n<p>你知道吗？最近我在抖音上刷到一个超燃的视频（号：pxcoding），背景音乐是那首经典的《燃烧的火焰》——对，就是日本《排球女将》的主题曲，一下子就把人拉回了那个热血的70/80年代。</p>\n<p>但画面里演的不是小鹿纯子扣球，而是一颗蓝色的小火箭，在黑色背景上嗖嗖地飞，身后拖着红色的尾巴，像血液在血管里流淌一样，从一个点流到另一个点。这就是用C++精灵库（sprites.h）写的一个程序——让它自动找出从A点到C点的所有路径。<br />这玩意儿到底在搞什么？</p>\n<p>简单来说，就是这个C++程序运行后会生成了A、B、C、D、E五个点，把它们两两相连，做成一张网。然后小火箭从A出发，要去C，它要尝试每一条可能的路。最酷的是，这不是枯燥的代码运行，而是一场视觉盛宴：<br />当小火箭决定前往下一个邻居节点时，它的画笔颜色会变成红色（HSV颜色模式里的H=0,表示颜色的色相为0,即红色），然后放慢速度（speed(1)），缓缓爬过去，真的就像鲜血在黑色的血管网络里缓缓流淌。到了之后，它恢复原速，停顿半秒，让你看清楚它的轨迹。如果走不通？没关系，它开始\"时光倒流\"——画笔颜色变成青色，以同样的速度缓缓退回去，就像血液回流一样。这种回溯的过程，其实就是计算机里经典的深度优先搜索（DFS）算法的可视化。<br />你看代码里这段：</p>\n<div class=\"cnblogs_code\">\n<pre>visitor.color(<span style=\"color: rgba(128, 0, 128, 1);\">0</span>).speed(<span style=\"color: rgba(128, 0, 128, 1);\">1</span>).go(nb).speed(<span style=\"color: rgba(128, 0, 128, 1);\">0</span>).wait(<span style=\"color: rgba(128, 0, 128, 1);\">0.5</span>);</pre>\n</div>\n<p>简单几行，就把冷冰冰的算法变成了看得见的\"血液流动\"。你可能会问，C++精灵库默认的角色为什么是小火箭？🚀<br />这可不是随便选的。你想啊，小火箭代表着什么？冲破大气层，冲向星辰大海！这库的设计者用心了——它就是给少年们准备的最好的礼物。</p>\n<p>说到这，我就想起了最近中国科学院大学成立星际航行学院的新闻。看着屏幕上的小火箭在图结构中穿梭寻找路径，不正是象征着我们这些正值年少的同学们吗？精力旺盛，充满好奇，在知识的网络中探索每一条可能的路径，为了明天的星辰大海做准备。</p>\n<p><img alt=\"C++深搜遍历图的每条路径可视化程序.mp4_20260130_150933.404\" class=\"lazyload\" height=\"320\" width=\"427\" /></p>\n<p>&nbsp;</p>\n<p>很多人以为学编程就是对着黑框框（命令行）敲枯燥的代码。但C++精灵库完全打破了这种印象：可视化即时反馈：你写的不是抽象的逻辑，而是看得见的小精灵在屏幕上跳舞。<br /> <br />而且这玩意儿真有学习价值！你在玩的过程中，不知不觉就理解了图的遍历、递归回溯、深度优先搜索这些大学数据结构课的核心概念。等真到了课堂上，你脑子里想的不是\"vis数组标记访问状态\"，而是\"小火箭变红又变青，血液流过去又流回来\"。</p>\n<p>同学们，我们的征途是星辰大海。就像这段代码里的小火箭，从A点出发，不畏曲折，遍历每一条可能的路径，最终到达C点。</p>\n<p>说到底，C++ 精灵库最棒的地方就是：它把专业的编程逻辑，变成了少年能轻松感知、亲手操作的可视化场景。不用再对着冰冷的代码空想，而是看着自己写的程序，让小火箭在屏幕上 “跑” 起来，这种成就感，比单纯背知识点强一百倍！如果你也觉得编程学习太无聊，不妨试试这个精灵库，用玩的心态学编程，说不定你会发现，原来编程可以这么有趣，原来星辰大海的编程梦，离自己这么近。 想看视频效果，网址在这里：<a href=\"https://www.douyin.com/video/7600985547170958627\" rel=\"noopener nofollow\" target=\"_blank\">https://www.douyin.com/video/7600985547170958627</a></p>\n<p>以下是这个C++程序的所有代码：</p>\n<div class=\"cnblogs_code\">\n<pre>#include <span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">sprites.h</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span>  <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">包含C++精灵库 </span>\n#include &lt;vector&gt;<span style=\"color: rgba(0, 0, 0, 1);\">\n#include </span>&lt;map&gt;\n<span style=\"color: rgba(0, 0, 255, 1);\">using</span> <span style=\"color: rgba(0, 0, 255, 1);\">namespace</span><span style=\"color: rgba(0, 0, 0, 1);\"> std;\nSprite visitor{</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">res/circle_blue.png</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span>};      <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">建立角色叫visitor</span>\nSprite pathshower;    <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">输出路径A-&gt;B-C...的角色 </span>\nPoint A={randint(<span style=\"color: rgba(128, 0, 128, 1);\">200</span>,<span style=\"color: rgba(128, 0, 128, 1);\">300</span>),randint(<span style=\"color: rgba(128, 0, 128, 1);\">200</span>,<span style=\"color: rgba(128, 0, 128, 1);\">300</span><span style=\"color: rgba(0, 0, 0, 1);\">)};\nPoint B</span>={randint(-<span style=\"color: rgba(128, 0, 128, 1);\">300</span>,-<span style=\"color: rgba(128, 0, 128, 1);\">200</span>),randint(<span style=\"color: rgba(128, 0, 128, 1);\">200</span>,<span style=\"color: rgba(128, 0, 128, 1);\">300</span><span style=\"color: rgba(0, 0, 0, 1);\">)};\nPoint C</span>={randint(-<span style=\"color: rgba(128, 0, 128, 1);\">300</span>,-<span style=\"color: rgba(128, 0, 128, 1);\">200</span>),randint(-<span style=\"color: rgba(128, 0, 128, 1);\">300</span>,-<span style=\"color: rgba(128, 0, 128, 1);\">200</span><span style=\"color: rgba(0, 0, 0, 1);\">)};\nPoint D</span>={randint(<span style=\"color: rgba(128, 0, 128, 1);\">200</span>,<span style=\"color: rgba(128, 0, 128, 1);\">300</span>),randint(-<span style=\"color: rgba(128, 0, 128, 1);\">300</span>,-<span style=\"color: rgba(128, 0, 128, 1);\">200</span><span style=\"color: rgba(0, 0, 0, 1);\">)};\nPoint E</span>={<span style=\"color: rgba(128, 0, 128, 1);\">0</span>,randint(-<span style=\"color: rgba(128, 0, 128, 1);\">350</span>,-<span style=\"color: rgba(128, 0, 128, 1);\">330</span><span style=\"color: rgba(0, 0, 0, 1);\">)};\nvector</span>&lt;Point&gt; v =<span style=\"color: rgba(0, 0, 0, 1);\"> {A,B,C,D,E};\nvector</span>&lt;Point&gt; path;      <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">存储路径 </span>\n<span style=\"color: rgba(0, 0, 255, 1);\">int</span> anscounter = <span style=\"color: rgba(128, 0, 128, 1);\">0</span>;      <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">存储路径总数 </span>\nmap&lt;Point,<span style=\"color: rgba(0, 0, 255, 1);\">string</span>&gt; dict={{A,<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">A</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span>},{B,<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">B</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span>},{C,<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">C</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span>},{D,<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">D</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span>},{E,<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">E</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span>}};<span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">节点：名字的 映射 </span>\nmap&lt;Point,<span style=\"color: rgba(0, 0, 255, 1);\">bool</span>&gt; visited = {{A,<span style=\"color: rgba(0, 0, 255, 1);\">false</span>},{B,<span style=\"color: rgba(0, 0, 255, 1);\">false</span>},{C,<span style=\"color: rgba(0, 0, 255, 1);\">false</span>},{D,<span style=\"color: rgba(0, 0, 255, 1);\">false</span>},{E,<span style=\"color: rgba(0, 0, 255, 1);\">false</span><span style=\"color: rgba(0, 0, 0, 1);\">} };\nmap</span>&lt;Point,vector&lt;Point&gt; &gt; graph =<span style=\"color: rgba(0, 0, 0, 1);\"> { {A,{B,C,D,E}}, {B,{A,C,D,E}}, {C,{A,B,D,E}}, {D,{A,B,C,E}}, {E,{A,B,C,D}} };\n</span><span style=\"color: rgba(0, 0, 255, 1);\">void</span> dfs(Point P){  <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\"> 深度优先搜索图 </span>\n   <span style=\"color: rgba(0, 0, 255, 1);\">if</span>(P==C){  <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">到达终点C，则输出路径 </span>\n     anscounter++<span style=\"color: rgba(0, 0, 0, 1);\">;\n     </span><span style=\"color: rgba(0, 0, 255, 1);\">string</span> cntstr =<span style=\"color: rgba(0, 0, 0, 1);\"> to_string(anscounter);\n     </span><span style=\"color: rgba(0, 0, 255, 1);\">string</span> s = <span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">第</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span> + cntstr + <span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">条路径:A</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(0, 0, 0, 1);\">;\n     </span><span style=\"color: rgba(0, 0, 255, 1);\">for</span>(<span style=\"color: rgba(0, 0, 255, 1);\">int</span> i=<span style=\"color: rgba(128, 0, 128, 1);\">1</span>;i&lt;path.size();i++)s=s+ <span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">-&gt;</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span> +<span style=\"color: rgba(0, 0, 0, 1);\"> dict[path[i]];\n     pathshower.write(s,</span><span style=\"color: rgba(128, 0, 128, 1);\">30</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n     visitor.wait(</span><span style=\"color: rgba(128, 0, 128, 1);\">3</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n     pathshower.cleartxts(</span><span style=\"color: rgba(128, 0, 128, 1);\">1</span>);  <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">清除最早写的文字 </span>\n     <span style=\"color: rgba(0, 0, 255, 1);\">return</span><span style=\"color: rgba(0, 0, 0, 1);\"> ;\n    } </span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">到了终点C，则等待3秒种</span>\n   <span style=\"color: rgba(0, 0, 255, 1);\">for</span>(Point &amp;nb:graph[P]) <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">遍历P的邻接节点</span>\n<span style=\"color: rgba(0, 0, 0, 1);\">   {\n     </span><span style=\"color: rgba(0, 0, 255, 1);\">if</span>(visited[nb]==<span style=\"color: rgba(0, 0, 255, 1);\">true</span>)<span style=\"color: rgba(0, 0, 255, 1);\">continue</span>; <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">已经访问过了，则跳过\n     </span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">可视化到邻居节点 </span>\n     visitor.color(<span style=\"color: rgba(128, 0, 128, 1);\">0</span>).speed(<span style=\"color: rgba(128, 0, 128, 1);\">1</span>).go(nb).speed(<span style=\"color: rgba(128, 0, 128, 1);\">0</span>).wait(<span style=\"color: rgba(128, 0, 128, 1);\">0.5</span>);   <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">角色到达邻居节点 </span>\n     visited[nb]=<span style=\"color: rgba(0, 0, 255, 1);\">true</span>;          <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">标记此邻居节点已访问 </span>\n     path.push_back(nb);         <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">存入路径 </span>\n     dfs(nb);                   <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">从这个节点重新开始dfs </span>\n     visited[nb]=<span style=\"color: rgba(0, 0, 255, 1);\">false</span>;        <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">撤销标记 </span>\n     path.pop_back();          <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">节点弹出\n     </span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">可视化回退，像时光倒流，红色的血液又流回去了。 </span>\n     visitor.color(<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">cyan</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span>).speed(<span style=\"color: rgba(128, 0, 128, 1);\">1</span>).go(P).speed(<span style=\"color: rgba(128, 0, 128, 1);\">0</span>).wait(<span style=\"color: rgba(128, 0, 128, 1);\">0.1</span><span style=\"color: rgba(0, 0, 0, 1);\">);     \n   } \n}\n</span><span style=\"color: rgba(0, 0, 255, 1);\">int</span> main(){        <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">主功能块 </span>\n    g_screen-&gt;bgcolor(<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">black</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n    pathshower.hide().color(</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">yellow</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span>).speed(<span style=\"color: rgba(128, 0, 128, 1);\">0</span>).pu().sety(<span style=\"color: rgba(128, 0, 128, 1);\">300</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n    visitor.scale(</span><span style=\"color: rgba(128, 0, 128, 1);\">0.5</span>).speed(<span style=\"color: rgba(128, 0, 128, 1);\">0</span>).color(<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">cyan</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(0, 0, 0, 1);\">).pu();\n    </span><span style=\"color: rgba(0, 0, 255, 1);\">for</span>(<span style=\"color: rgba(0, 0, 255, 1);\">int</span> i=<span style=\"color: rgba(128, 0, 128, 1);\">0</span>;i&lt;v.size();i++<span style=\"color: rgba(0, 0, 0, 1);\">)\n       </span><span style=\"color: rgba(0, 0, 255, 1);\">if</span>(i==<span style=\"color: rgba(128, 0, 128, 1);\">2</span>)visitor.go(v[i]).mark(dict[v[i]],<span style=\"color: rgba(128, 0, 128, 1);\">30</span>,-<span style=\"color: rgba(128, 0, 128, 1);\">18</span>,-<span style=\"color: rgba(128, 0, 128, 1);\">18</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n       </span><span style=\"color: rgba(0, 0, 255, 1);\">else</span> visitor.go(v[i]).mark(dict[v[i]],<span style=\"color: rgba(128, 0, 128, 1);\">30</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n    </span><span style=\"color: rgba(0, 0, 255, 1);\">for</span>(<span style=\"color: rgba(0, 0, 255, 1);\">int</span> i=<span style=\"color: rgba(128, 0, 128, 1);\">0</span>;i&lt;v.size();i++<span style=\"color: rgba(0, 0, 0, 1);\">){\n    </span><span style=\"color: rgba(0, 0, 255, 1);\">for</span>(<span style=\"color: rgba(0, 0, 255, 1);\">int</span> j=i+<span style=\"color: rgba(128, 0, 128, 1);\">1</span>;j&lt;v.size();j++<span style=\"color: rgba(0, 0, 0, 1);\">)\n       visitor.pu().go(v[i]).dot(</span><span style=\"color: rgba(128, 0, 128, 1);\">10</span>,<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">blue</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(0, 0, 0, 1);\">).pd().go(v[j]); \n    }\n    visitor.dot(</span><span style=\"color: rgba(128, 0, 128, 1);\">10</span>,<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">blue</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(0, 0, 0, 1);\">).pu(); \n    g_screen</span>-&gt;savepng(<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">res/graph.png</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n    g_screen</span>-&gt;bgpic(<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">res/graph.png</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(0, 0, 0, 1);\">);\n    visitor.clear();    \n    visited[A]</span>=<span style=\"color: rgba(0, 0, 255, 1);\">true</span><span style=\"color: rgba(0, 0, 0, 1);\">;\n    path.push_back(A);\n    visitor.pensize(</span><span style=\"color: rgba(128, 0, 128, 1);\">4</span>).go(A).wait(<span style=\"color: rgba(128, 0, 128, 1);\">1</span><span style=\"color: rgba(0, 0, 0, 1);\">).pd();\n    dfs(A);\n    \n    visitor.hide().done();     </span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">完成了</span>\n   <span style=\"color: rgba(0, 0, 255, 1);\">return</span> <span style=\"color: rgba(128, 0, 128, 1);\">0</span>;    <span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">返回0</span>\n}</pre>\n</div>\n<p>&nbsp;</p>\n\n</div>\n<div class=\"clear\"></div>\n\n\t<div class=\"postDesc\">posted on \n<span id=\"post-date\">2026-01-30 15:19</span>&nbsp;\n<a href=\"https://www.cnblogs.com/lixingqiu\">李兴球</a>&nbsp;\n阅读(<span id=\"post_view_count\">45</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": ".NET 10 与智能体时代的架构演进：以 File-Based Apps 为核心的 C# 生态重塑",
      "link": "https://www.cnblogs.com/shanyou/p/19553650",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/shanyou/p/19553650\" id=\"cb_post_title_url\" title=\"发布于 2026-01-30 14:59\">\n    <span>.NET 10 与智能体时代的架构演进：以 File-Based Apps 为核心的 C# 生态重塑</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        .NET 10 的 File-Based Apps 最具杀伤力的特性在于其所谓的“成长路径”（Grow-up Story）。与 Python 不同，Python 脚本在规模扩大后往往面临性能重构或维护性崩塌；而 C# 脚本本身就是完整的 C# 代码。\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>在计算技术的发展史上，编程语言的演进往往是为了适应生产力的核心变革。从早期的机器指令到高级语言，再到当代以云原生为中心的框架，每一代技术都在试图降低人类与机器之间的沟通壁垒。然而，随着.NET 10 的发布，微软通过推出“基于文件的应用程序”（File-Based Apps，通常通过 dotnet file 命令调用）这一功能，标志着 C# 正在经历一场根本性的范式转移。这一特性并非仅仅是 CLI 工具链的微小更新，而是 C# 试图在智能体（Agentic AI）时代夺取生态话语权的战略王牌。在智能体时代，代码的生命周期正在发生质变：代码不再仅仅是由人类在 IDE 中通过漫长的开发周期编写、审查和部署，而是越来越多地由大语言模型（LLM）根据实时需求生成、分发并立即执行 3。</p>\n<h2 id=\"智能体时代的代码范式转移与-c-的战略转型\"><strong>智能体时代的代码范式转移与 C# 的战略转型</strong></h2>\n<p>传统的 C# 开发模式，即所谓的“工程导向型”开发，要求开发者创建一个复杂的项目结构，包括项目文件（.csproj）、解决方案文件（.sln）、属性设置以及依赖项配置。虽然这种结构在构建大规模企业级软件时提供了卓越的可维护性和类型安全性，但在快速迭代、脚本编写以及 AI 驱动的动态代码生成场景下，这种“工程仪式感”成为了巨大的阻碍。相比之下，Python 凭借其“无须配置、即写即用”的特性，长期占据了 AI 研发和脚本工具领域的统治地位。</p>\n<p>.NET 10 的 File-Based Apps 旨在彻底消除这种摩擦。它允许开发者（以及 AI 智能体）在单个 .cs 文件中直接编写逻辑，通过内嵌指令指定依赖和环境，直接运行。这种转变意味着 C# 正在从一种“重型工程语言”进化为一种兼具“脚本灵活性”与“原生高性能”的全场景语言。在智能体生态中，这种灵活性是至关重要的，因为 AI 智能体需要一种能够像 Python 一样“丝滑”地生成并执行的代码格式，同时又希望保留 C# 在性能、并发处理和类型安全方面的工业级优势。</p>\n<h3 id=\"智能体生成的代码特性分析\"><strong>智能体生成的代码特性分析</strong></h3>\n<p>在 AI 驱动的开发流程中，代码的生成具有以下核心特征，这些特征直接决定了.NET 10 架构调整的必要性：</p>\n<ol>\n<li><strong>原子性与自包含性</strong>：AI 倾向于生成独立的代码块来解决特定问题。传统的.csproj 文件与源代码的分离增加了 LLM 的上下文复杂度和解析成本。</li>\n<li><strong>即时执行需求</strong>：在“代码解释器”（Code Interpreter）模式下，智能体生成代码后需要立即得到运行结果。任何繁琐的脚手架搭建步骤都会增加系统延迟，降低交互体验。</li>\n<li><strong>动态分发</strong>：代码可能通过网络协议、消息队列实时分发到边缘节点或沙箱执行环境。单文件格式（含配置）是最理想的分发媒介。</li>\n</ol>\n<h2 id=\"file-based-apps-的核心技术架构\"><strong>File-Based Apps 的核心技术架构</strong></h2>\n<p>.NET 10 引入的基于文件的应用模型，本质上是 MSBuild 项目系统的高度抽象化与虚拟化。当执行 dotnet file.cs 或 dotnet run file.cs 时，.NET SDK 并非在解释代码，而是在后台动态构建了一个“虚拟项目” 。</p>\n<h3 id=\"虚拟项目系统的运行机制\"><strong>虚拟项目系统的运行机制</strong></h3>\n<p>这一机制的精髓在于 SDK 能够自动识别源文件顶部的特定指令，并将其转化为 MSBuild 能够理解的元数据。根据官方技术文档，SDK 会在系统的临时目录（例如 &lt;temp&gt;/dotnet/runfile/）下，根据文件路径的哈希值创建一个隔离的构建空间 。这种设计确保了单文件脚本在运行时不会污染源代码所在的目录，同时也避免了手动创建 bin 和 obj 文件夹的繁杂 。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align: left;\">关键特性</th>\n<th style=\"text-align: left;\">传统工程模式 (.csproj)</th>\n<th style=\"text-align: left;\">基于文件的应用 (File-Based Apps)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: left;\"><strong>元数据存储</strong></td>\n<td style=\"text-align: left;\">外部 XML 文件 (.csproj)</td>\n<td style=\"text-align: left;\">文件顶部内嵌指令</td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>构建产物</strong></td>\n<td style=\"text-align: left;\">当前目录的 /bin 和 /obj</td>\n<td style=\"text-align: left;\">系统临时目录（基于哈希隔离）</td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>依赖管理</strong></td>\n<td style=\"text-align: left;\">&lt;PackageReference&gt; 节点</td>\n<td style=\"text-align: left;\">#:package 指令</td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>SDK 规范</strong></td>\n<td style=\"text-align: left;\">&lt;Project Sdk=\"...\"&gt; 属性</td>\n<td style=\"text-align: left;\">#:sdk 指令</td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>发布模式</strong></td>\n<td style=\"text-align: left;\">需手动配置 AOT 或裁剪</td>\n<td style=\"text-align: left;\">默认启用 Native AOT 发布</td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>转换路径</strong></td>\n<td style=\"text-align: left;\">无</td>\n<td style=\"text-align: left;\">支持 dotnet project convert 一键转换</td>\n</tr>\n</tbody>\n</table>\n<p>这种虚拟化架构不仅支持控制台程序，通过指定 #:sdk Microsoft.NET.Sdk.Web，甚至可以仅凭一个文件构建出完整的 ASP.NET Core Minimal API 接口。</p>\n<h3 id=\"指令系统directives消除-xml-仪式的关键\"><strong>指令系统（Directives）：消除 XML 仪式的关键</strong></h3>\n<p>为了实现“自包含”的目标，.NET 10 引入了一套以 #: 为前缀的指令系统。这些指令必须放置在 C# 文件的最顶部，用于定义程序的运行环境和外部依赖。</p>\n<ul>\n<li><strong>#:package</strong>：用于引用 NuGet 包。例如 #:package Newtonsoft.Json@13.0.3 允许脚本直接调用 JSON 处理库，而无需手动编辑项目文件。</li>\n<li><strong>#:sdk</strong>：定义项目所使用的 SDK 类型。默认值为 Microsoft.NET.Sdk，但可以扩展为 Web SDK 或 Aspire AppHost SDK，极大地扩展了单文件应用的能力边界。</li>\n<li><strong>#:property</strong>：允许设置 MSBuild 属性。例如 #:property TargetFramework=net10.0 或 #:property PublishAot=false。这对于调整编译行为（如禁用默认启用的 Native AOT）至关重要。</li>\n<li><strong>#:project</strong>：实现跨工程引用。通过 #:project../SharedLib/Lib.csproj，单文件应用可以复用现有的企业级类库，真正做到了轻量化与工程化的有机结合。</li>\n</ul>\n<p>这种设计直接解决了 AI 在编写代码时的“配置泄露”问题。LLM 只需要输出一段纯文本，就能包含从逻辑到依赖的所有信息，使其在自动化编排中表现得与 Python 同样高效 3。</p>\n<h2 id=\"c-与-python-的丝滑竞争性能与体验的平衡\"><strong>C# 与 Python 的“丝滑”竞争：性能与体验的平衡</strong></h2>\n<p>.NET 10 的这一革新被广泛认为是.NET 向 Python 腹地发起的一次强力进攻。在开发者体验（DX）层面，.NET 10 极力抹平了 C# 与 Python 在脚本编写上的鸿沟，同时在执行效率上形成了降维打击。</p>\n<h3 id=\"脚本化体验的演进\"><strong>脚本化体验的演进</strong></h3>\n<p>从 C# 9 引入的顶级语句（Top-level statements）开始，.NET就在逐步削减 C# 的冗余结构。到了.NET 10，顶级语句与 File-Based Apps 结合，使得简单的脚本缩减到了极致。例如，一个获取系统信息的脚本在.NET 10 中仅需数行代码，且通过 dotnet run sysinfo.cs 即可直接运行，这种体验已经完全达到了 Python 的水平。</p>\n<p>此外，Unix 系系统（Linux、macOS）中的 Shebang 支持进一步增强了 C# 的“脚本感”。通过在文件头添加 #!/usr/bin/env dotnet 并设置执行权限，C# 文件可以像 Bash 脚本一样直接执行。</p>\n<h3 id=\"性能维度的断层优势\"><strong>性能维度的断层优势</strong></h3>\n<p>虽然 Python 在易用性上占据先机，但在性能敏感的任务中，其解释执行和全局解释器锁（GIL）始终是瓶颈。C# 的单文件应用在底层依然运行在高性能的.NET 运行时之上，这意味着它天然支持：</p>\n<ol>\n<li><strong>真并发处理</strong>：利用 Task Parallel Library (TPL) 实现高效的多线程任务并行。</li>\n<li><strong>现代内存技术</strong>：通过 Span&lt;T&gt;、Memory&lt;T&gt; 等零拷贝技术，处理海量数据流时的性能远超 Python 原生实现。</li>\n<li><strong>JIT 与 Native AOT 优化</strong>：.NET 10 的 JIT 编译器在内联优化和去虚化方面有了显著提升，同时 File-Based Apps 默认开启 Native AOT 发布模式，能够生成秒开且占用极低内存的原生二进制文件。</li>\n</ol>\n<p>在智能体处理复杂逻辑、进行大规模并行计算或执行高频数据转换时，C# 的这些性能特性确保了智能体能够更快地响应，同时在云端运行时的资源消耗更低 3。</p>\n<h2 id=\"智能体生态中的王牌microsoft-agent-framework\"><strong>智能体生态中的“王牌”：Microsoft Agent Framework</strong></h2>\n<p>.NET 10 对 File-Based Apps 的投入，其实是为其更高层级的 AI 战略——<strong>Microsoft Agent Framework (MAF)</strong> 打铺垫。MAF 是微软统一了 Semantic Kernel 和 AutoGen 核心能力后的产物，旨在为开发者提供一套构建、编排和观察智能体系统的标准库 4。</p>\n<h3 id=\"智能体协作模式与代码执行\"><strong>智能体协作模式与代码执行</strong></h3>\n<p>MAF 定义了多种智能体协作模式，而在这些模式中，单文件应用的轻量化特性成为了关键的催化剂：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align: left;\">协作模式 (MAF Patterns)</th>\n<th style=\"text-align: left;\">智能体交互逻辑</th>\n<th style=\"text-align: left;\">File-Based Apps 的贡献</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: left;\"><strong>顺序模式 (Sequential)</strong></td>\n<td style=\"text-align: left;\">智能体 A 生成数据，传递给智能体 B。</td>\n<td style=\"text-align: left;\">快速生成轻量化数据预处理脚本。</td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>并发模式 (Concurrent)</strong></td>\n<td style=\"text-align: left;\">多个智能体并行处理子任务。</td>\n<td style=\"text-align: left;\">每个智能体可独立生成、执行 C# 任务，互不干扰。</td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>移交模式 (Handoff)</strong></td>\n<td style=\"text-align: left;\">动态根据上下文将控制权移交给专家智能体。</td>\n<td style=\"text-align: left;\">专家智能体可即时编译执行专用的计算逻辑。</td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>群组聊天 (GroupChat)</strong></td>\n<td style=\"text-align: left;\">多个智能体通过对话达成共识。</td>\n<td style=\"text-align: left;\">智能体可作为协作产物，实时生成并共享可运行的代码段。</td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>主从模式 (Magentic)</strong></td>\n<td style=\"text-align: left;\">管理者智能体协调专门智能体执行任务。</td>\n<td style=\"text-align: left;\">降低工具调用（Tool Calling）中生成代码的复杂度和延迟。</td>\n</tr>\n</tbody>\n</table>\n<p>在 MAF 中，智能体通常需要调用外部工具。通过 HostedCodeInterpreterTool（托管代码解释器工具），智能体被授予了执行其生成的 C# 代码的权限。传统的项目结构会使得这种动态执行变得异常笨重，而.NET 10 允许智能体直接将一段带有 #:package 指令的代码发送给解释器，解释器无需创建项目即可直接完成编译和运行。</p>\n<h3 id=\"ai-智能体的黄金三角开发观察与交互\"><strong>AI 智能体的“黄金三角”：开发、观察与交互</strong></h3>\n<p>微软在.NET 10 中提出了针对智能体开发的“黄金三角”架构：<strong>DevUI</strong>、<strong>AG-UI</strong> 和 <strong>OpenTelemetry</strong>。</p>\n<ul>\n<li><strong>DevUI</strong>：提供了一个可视化界面，用于观察智能体的推理过程、决策路径和状态变化。它允许开发者像调试代码一样“调试”智能体的思维逻辑 。</li>\n<li><strong>AG-UI (Agent-User Interaction)</strong>：这是一个标准化的协议，用于定义智能体与用户之间的交互。它不仅支持流式文本输出，还支持“生成式 UI”，即智能体可以动态地向前端推送图表、卡片或交互式组件 。</li>\n<li><strong>OpenTelemetry</strong>：为智能体系统提供了深度观测能力。由于智能体运行涉及到大量的 LLM 调用和动态代码执行，通过 OpenTelemetry 可以精确追踪令牌（Token）消耗、模型响应延迟以及代码执行的性能指标。</li>\n</ul>\n<p>File-Based Apps 完美契合了这一架构。当智能体需要通过 AG-UI 推送一个复杂的动态图表时，它可以生成一个单文件的 C# 后端逻辑，利用.NET 的绘图或数据处理库快速计算结果，并通过流式接口返回给前端。</p>\n<h2 id=\"构建与发布native-aot-的默认革命\"><strong>构建与发布：Native AOT 的默认革命</strong></h2>\n<p>在智能体和微服务时代，冷启动时间和内存占用是衡量架构优劣的关键指标。File-Based Apps 在发布阶段（dotnet publish）默认启用了 <strong>Native AOT (Ahead-of-Time)</strong> 编译技术。</p>\n<h3 id=\"native-aot-的技术影响\"><strong>Native AOT 的技术影响</strong></h3>\n<p>Native AOT 彻底改变了.NET 程序的部署方式。它不再需要将中间语言（IL）代码打包并在运行时通过 JIT 编译，而是直接生成特定平台的原生机器码 。</p>\n<ol>\n<li><strong>极致的启动速度</strong>：省去了运行时 JIT 编译的时间，单文件应用可以在毫秒级启动，这对于响应式的 AI 智能体任务至关重要1。</li>\n<li><strong>极低的内存足迹</strong>：不需要加载庞大的 JIT 编译器和相关的运行时元数据，Native AOT 生成的二进制文件内存占用极小，非常适合部署在资源受限的容器或边缘设备中 。</li>\n<li><strong>更强的安全性</strong>：由于运行时不存在 IL 代码和 JIT，攻击者通过利用 JIT 漏洞进行代码注入的难度显著增加 。</li>\n</ol>\n<p>此外，为了进一步优化 AI 场景下的开发效率，.NET 10 对编译管道进行了并行化增强。即使是在构建复杂的单文件 Web API 时，开发者也能感受到显著缩短的编译等待时间。</p>\n<h3 id=\"产物管理与临时目录逻辑\"><strong>产物管理与临时目录逻辑</strong></h3>\n<p>为了确保单文件脚本的整洁性，.NET 10 引入了精细的产物清理机制。默认情况下，构建产物会根据文件内容的哈希值进行存储，这意味着如果脚本内容没有变化，SDK 会复用之前的构建缓存。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align: left;\">命令</th>\n<th style=\"text-align: left;\">执行效果</th>\n<th style=\"text-align: left;\">适用场景</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: left;\">dotnet build app.cs</td>\n<td style=\"text-align: left;\">在临时目录生成构建产物，不直接执行。</td>\n<td style=\"text-align: left;\">预编译检查。</td>\n</tr>\n<tr>\n<td style=\"text-align: left;\">dotnet run app.cs</td>\n<td style=\"text-align: left;\">快速编译并启动应用。</td>\n<td style=\"text-align: left;\">脚本开发与即时测试。</td>\n</tr>\n<tr>\n<td style=\"text-align: left;\">dotnet publish app.cs</td>\n<td style=\"text-align: left;\">生成 Native AOT 优化后的原生二进制文件。</td>\n<td style=\"text-align: left;\">生产环境分发或 AI 工具链打包。</td>\n</tr>\n<tr>\n<td style=\"text-align: left;\">dotnet clean file-based-apps</td>\n<td style=\"text-align: left;\">清除所有单文件应用的缓存产物。</td>\n<td style=\"text-align: left;\">系统维护，释放磁盘空间。</td>\n</tr>\n</tbody>\n</table>\n<p>此外，开发者可以通过设置 #:property OutputPath=./output 来强制将产物输出到指定位置，从而平衡了自动化构建与手动管理的灵活性。</p>\n<h2 id=\"智能体时代的安全性与治理\"><strong>智能体时代的安全性与治理</strong></h2>\n<p>AI 实时生成并执行代码，这在带来生产力飞跃的同时，也引发了前所未有的安全挑战。.NET 10 在设计 File-Based Apps 时，充分考虑了动态代码执行的安全边界。</p>\n<h3 id=\"配置隔离与机密管理\"><strong>配置隔离与机密管理</strong></h3>\n<p>在单文件脚本中硬编码密钥是极大的安全隐患。为此，.NET 10 为 File-Based Apps 提供了专门的“用户机密”（User Secrets）支持。SDK 会基于文件路径的哈希值，为每个脚本生成一个稳定的 UserSecretsId。</p>\n<p>开发者可以使用 CLI 轻松管理机密：dotnet user-secrets set \"ApiKey\" \"your-key\" --file script.cs。这种机制确保了即使 AI 生成的代码被分发或共享，敏感的认证信息依然安全地存储在开发者的本地机器中，而不会随代码泄露。</p>\n<h3 id=\"隔离运行环境\"><strong>隔离运行环境</strong></h3>\n<p>虽然.NET 10 官方文档中并未明确提及针对 AI 生成代码的内置“沙箱”功能，但其架构设计提供了多种隔离手段：</p>\n<ul>\n<li><strong>Stdin 管道模式</strong>：通过 echo '...' | dotnet run - 执行代码时，SDK 不会加载当前目录的任何配置文件或启动配置，提供了一个相对洁净的执行环境 。</li>\n<li><strong>临时目录隔离</strong>：每个脚本拥有独立的构建输出路径，防止了不同智能体任务之间的文件冲突和覆盖 。</li>\n<li><strong>权限最小化建议</strong>：官方指南建议在生产环境中，AI 生成的代码应在非特权容器中通过 dotnet publish 后的原生二进制文件执行，以限制其对宿主系统的访问能力 。</li>\n</ul>\n<h2 id=\"模型上下文协议mcp与工具集成\"><strong>模型上下文协议（MCP）与工具集成</strong></h2>\n<p>在智能体时代，智能体需要与各种外部服务交互。.NET 10 对 <strong>Model Context Protocol (MCP)</strong> 的支持，为 File-Based Apps 提供了强大的扩展能力。</p>\n<p>MCP 允许 AI 智能体以标准化的方式访问数据库、API 和文件系统。在.NET 10 中，开发者可以利用单文件应用快速编写一个 MCP 服务器。例如，通过 #:sdk Microsoft.NET.Sdk 结合相关的 MCP 库，几行代码就能让智能体获得对企业内部数据的查询权限。这种“微型服务器”模式极大缩短了 AI 落地到具体业务场景的路径。</p>\n<h3 id=\"动态工具发现与调用\"><strong>动态工具发现与调用</strong></h3>\n<p>结合 Microsoft Agent Framework，智能体可以动态发现这些单文件工具。当智能体识别出需要进行复杂的财务审计计算时，它可以生成一个专门的 C# 脚本，将其作为一个临时工具加载，执行完毕后再行释放。这种“随用随建”的模式是智能体时代灵活性要求的极致体现。</p>\n<h2 id=\"开发者工具与生态现状\"><strong>开发者工具与生态现状</strong></h2>\n<p>虽然.NET 10 在 SDK 层面已经做好了全面准备，但生态系统的完善仍需时日。目前，各开发工具对 File-Based Apps 的支持程度不一：</p>\n<ol>\n<li><strong>VS Code 与 C# Dev Kit</strong>：已提供深度支持，包括语法高亮、IntelliSense 以及对内嵌指令的智能提示。</li>\n<li><strong>JetBrains Fleet / Rider</strong>：Fleet 作为轻量化 IDE 已经原生支持，而 Rider 目前正通过更新逐步完善对非项目文件模式的调试支持。</li>\n<li><strong>Visual Studio 2026</strong>：作为旗舰 IDE，它正在引入更强大的“单文件模式”视图，允许开发者在没有 .sln 的情况下高效管理这些脚本。</li>\n</ol>\n<p>尽管如此，仍有一些限制需要注意。例如，目前的单文件应用模式尚不支持跨多文件的复杂逻辑（除非通过 #:project 引用其他项目），且类型定义必须放在顶级语句之后 。</p>\n<h2 id=\"总结c-的成长逻辑\"><strong>总结：C# 的“成长”逻辑</strong></h2>\n<p>.NET 10 的 File-Based Apps 最具杀伤力的特性在于其所谓的“成长路径”（Grow-up Story）。与 Python 不同，Python 脚本在规模扩大后往往面临性能重构或维护性崩塌；而 C# 脚本本身就是完整的 C# 代码。</p>\n<p>当一个由 AI 智能体初步生成的原型脚本证明了其业务价值，开发者只需执行一次 dotnet project convert，就能将其瞬间转化为标准的生产级工程。这意味着企业可以在享受 AI 带来极致敏捷性的同时，无缝衔接到成熟的持续集成、持续部署（CI/CD）和观测体系中。</p>\n<p>从战略层面看，.NET 10 并不是在改变 C# 的核心，而是在拓宽 C# 的边界。它通过 dotnet file 这一王牌，成功地在智能体生态中构建了一座连接“AI 灵活性”与“企业级稳定性”的桥梁。在未来的智能体时代，这种能够随智能体需求而“忽大忽小”、既能“秒开”又能“扛鼎”的技术平台，将成为开发者和 AI 智能体共同的首选。正如业内所评价的那样，.NET 10 终于让 C# 摆脱了“企业级沉重”的标签，以一种前所未有的“丝滑”姿态，全速切入了 AI 智能体的核心版图 。</p>\n<h4 id=\"引用的著作\"><strong>引用的著作</strong></h4>\n<ol>\n<li>File-based apps - .NET | Microsoft Learn <a href=\"https://learn.microsoft.com/en-us/dotnet/core/sdk/file-based-apps\" rel=\"noopener nofollow\" target=\"_blank\">https://learn.microsoft.com/en-us/dotnet/core/sdk/file-based-apps</a></li>\n<li>New Features in .NET 10 and C# 14 | by Anton Martyniuk | CodeX - Medium <a href=\"https://medium.com/codex/new-features-in-net-10-and-c-14-8f52d614c356\" rel=\"noopener nofollow\" target=\"_blank\">https://medium.com/codex/new-features-in-net-10-and-c-14-8f52d614c356</a></li>\n<li>dotnet run app.cs - Run C# Without a Project File in .NET 10 <a href=\"https://codewithmukesh.com/blog/file-based-apps-dotnet-10/\" rel=\"noopener nofollow\" target=\"_blank\">https://codewithmukesh.com/blog/file-based-apps-dotnet-10/</a></li>\n<li>dotnet run in .NET 10: Single-File C# Is Finally Here - DEV Community <a href=\"https://dev.to/mashrulhaque/dotnet-run-in-net-10-single-file-c-is-finally-here-1gdi\" rel=\"noopener nofollow\" target=\"_blank\">https://dev.to/mashrulhaque/dotnet-run-in-net-10-single-file-c-is-finally-here-1gdi</a></li>\n<li>Microsoft Agent Framework Workflows Orchestrations <a href=\"https://learn.microsoft.com/en-us/agent-framework/user-guide/workflows/orchestrations/magentic\" rel=\"noopener nofollow\" target=\"_blank\">https://learn.microsoft.com/en-us/agent-framework/user-guide/workflows/orchestrations/magentic</a></li>\n</ol>\n\n\n</div>\n<div id=\"MySignature\">\n    <p>欢迎大家扫描下面二维码成为我的客户，扶你上云</p>\n<img src=\"https://images.cnblogs.com/cnblogs_com/shanyou/57459/o_220125090408_%E9%82%80%E8%AF%B7%E4%BA%8C%E7%BB%B4%E7%A0%81-258px.jpeg\" width=\"170\" />\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-30 14:59</span>&nbsp;\n<a href=\"https://www.cnblogs.com/shanyou\">张善友</a>&nbsp;\n阅读(<span id=\"post_view_count\">122</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "keycloak~深入了解DefaultSegmentedDataContainer对象解决内存泄漏",
      "link": "https://www.cnblogs.com/lori/p/19553603",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/lori/p/19553603\" id=\"cb_post_title_url\" title=\"发布于 2026-01-30 14:53\">\n    <span>keycloak~深入了解DefaultSegmentedDataContainer对象解决内存泄漏</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<ul>\n<li>源码来自infinispan: git@github.com:infinispan/infinispan.git</li>\n</ul>\n<p>基于Infinispan 内部架构的了解，让我为你详细解释 <code>DefaultSegmentedDataContainer</code> 中 TTL 的存储位置：</p>\n<h2 id=\"defaultsegmenteddatacontainer-中-ttl-的存储结构\">DefaultSegmentedDataContainer 中 TTL 的存储结构</h2>\n<h3 id=\"核心结构层次\">核心结构层次</h3>\n<pre><code>DefaultSegmentedDataContainer\n│\n├── DataSegment[] segments  ← 分段数组（根据 key 的 hash 分配）\n│   │\n│   └── ConcurrentHashMap&lt;Object, InternalCacheEntry&gt;\n│       │\n│       └── InternalCacheEntry&lt;K, V&gt;  ← 每个缓存条目对象\n│           │\n│           ├── key          : K         ← 缓存键\n│           ├── value        : V         ← 缓存值\n│           ├── metadata     : Metadata  ← 元数据（包含TTL信息）★\n│           ├── created      : long      ← 创建时间戳\n│           └── lastUsed     : long      ← 最后访问时间戳\n</code></pre>\n<h3 id=\"ttl-信息的具体位置\">TTL 信息的具体位置</h3>\n<p><strong>TTL 不是存储在 <code>DefaultSegmentedDataContainer</code> 的直接属性中，而是在每个 <code>InternalCacheEntry</code> 对象的 <code>Metadata</code> 属性里。</strong></p>\n<p>Infinispan 中有多种 <code>InternalCacheEntry</code> 实现类，根据是否有过期时间分类：</p>\n<table>\n<thead>\n<tr>\n<th>实现类</th>\n<th>特点</th>\n<th>TTL 相关属性</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>ImmortalCacheEntry</code></td>\n<td>永不过期</td>\n<td>无 TTL 属性</td>\n</tr>\n<tr>\n<td><code>MortalCacheEntry</code></td>\n<td>有 lifespan</td>\n<td><code>lifespan</code>, <code>created</code></td>\n</tr>\n<tr>\n<td><code>TransientCacheEntry</code></td>\n<td>有 maxIdle</td>\n<td><code>maxIdle</code>, <code>lastUsed</code></td>\n</tr>\n<tr>\n<td><code>TransientMortalCacheEntry</code></td>\n<td>同时有两者</td>\n<td><code>lifespan</code>, <code>maxIdle</code>, <code>created</code>, <code>lastUsed</code></td>\n</tr>\n<tr>\n<td><code>MetadataImmortalCacheEntry</code></td>\n<td>使用 Metadata 对象</td>\n<td><code>metadata.lifespan()</code>, <code>metadata.maxIdle()</code></td>\n</tr>\n<tr>\n<td><code>MetadataMortalCacheEntry</code></td>\n<td>使用 Metadata 对象</td>\n<td><code>metadata.lifespan()</code>, <code>metadata.maxIdle()</code></td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"下面的缓存sessions表示永不过期因为它的类型是immortalcacheentry\">下面的缓存sessions表示永不过期，因为它的类型是<code>ImmortalCacheEntry</code></h3>\n<p><img alt=\"图片\" src=\"https://img2024.cnblogs.com/blog/118538/202601/118538-20260130134811178-1293318584.png\" /></p>\n<h3 id=\"下面的缓存sessions是有过期时间的它的类型是transientmortalcacheentry\">下面的缓存sessions是有过期时间的，它的类型是<code>TransientMortalCacheEntry</code></h3>\n<p><img alt=\"图片\" src=\"https://img2024.cnblogs.com/blog/118538/202601/118538-20260130135258276-537962783.png\" /></p>\n<h3 id=\"实际的-ttl-属性\">实际的 TTL 属性</h3>\n<pre><code>对于 Keycloak 的会话缓存，通常使用 **带 Metadata 的条目**，TTL 信息在：\n</code></pre>\n<pre><code class=\"language-java\">InternalCacheEntry entry = ...;\n\n// 获取 lifespan (生命周期 TTL)\nlong lifespan = entry.getLifespan();      // 返回毫秒值，-1 表示永不过期\n\n// 获取 maxIdle (空闲 TTL)  \nlong maxIdle = entry.getMaxIdle();        // 返回毫秒值，-1 表示永不过期\n\n// 获取创建时间\nlong created = entry.getCreated();        // 创建时的时间戳\n\n// 获取最后访问时间\nlong lastUsed = entry.getLastUsed();      // 最后访问的时间戳\n\n// 检查是否过期\nboolean expired = entry.isExpired(System.currentTimeMillis());\n\n// 计算过期时间点\nlong expiryTime = entry.expiryTime();     // 返回具体的过期时间戳\n</code></pre>\n<h3 id=\"在-jvm-调试时查看-ttl\">在 JVM 调试时查看 TTL</h3>\n<p>如果你想在调试器中查看某个缓存项的 TTL，路径是：</p>\n<pre><code>DefaultSegmentedDataContainer\n  └── segments (DataSegment[])\n      └── [segment index] \n          └── entries (ConcurrentHashMap)\n              └── [key]\n                  └── InternalCacheEntry 对象\n                      ├── metadata\n                      │   ├── lifespan   ← 这里是 TTL（毫秒）\n                      │   └── maxIdle    ← 这里是空闲超时（毫秒）\n                      ├── created        ← 创建时间戳\n                      └── lastUsed       ← 最后访问时间戳\n</code></pre>\n<h3 id=\"过期判断逻辑\">过期判断逻辑</h3>\n<pre><code class=\"language-java\">// 在 InternalCacheEntry 中的过期检查逻辑（简化版）：\npublic boolean isExpired(long now) {\n    // lifespan 检查\n    if (lifespan &gt; 0 &amp;&amp; (created + lifespan) &lt;= now) {\n        return true;\n    }\n    // maxIdle 检查\n    if (maxIdle &gt; 0 &amp;&amp; (lastUsed + maxIdle) &lt;= now) {\n        return true;\n    }\n    return false;\n}\n</code></pre>\n<h3 id=\"keycloak-中-ttl-的设置来源\">Keycloak 中 TTL 的设置来源</h3>\n<p>当 Keycloak 写入会话时，TTL 值来自 <code>SessionTimeouts</code> 类的计算：</p>\n<pre><code class=\"language-java\">// 写入缓存时设置 TTL\ncache.put(key, value, lifespanMs, TimeUnit.MILLISECONDS, maxIdleMs, TimeUnit.MILLISECONDS);\n</code></pre>\n<p>这些值最终会被封装到 <code>InternalCacheEntry</code> 的 <code>metadata</code> 或对应属性中。</p>\n<pre><code class=\"language-plaintext\">DefaultSegmentedDataContainer\n│\n├── DataSegment[] segments  ← 分段数组（根据 key 的 hash 分配）\n│   │\n│   └── ConcurrentHashMap&lt;Object, InternalCacheEntry&gt;\n│       │\n│       └── InternalCacheEntry&lt;K, V&gt;  ← 每个缓存条目对象\n│           │\n│           ├── key          : K         ← 缓存键\n│           ├── value        : V         ← 缓存值\n│           ├── metadata     : Metadata  ← 元数据（包含TTL信息）★\n│           ├── created      : long      ← 创建时间戳\n│           └── lastUsed     : long      ← 最后访问时间戳\n</code></pre>\n<pre><code class=\"language-java\">InternalCacheEntry entry = ...;\n\n// 获取 lifespan (生命周期 TTL)\nlong lifespan = entry.getLifespan();      // 返回毫秒值，-1 表示永不过期\n\n// 获取 maxIdle (空闲 TTL)  \nlong maxIdle = entry.getMaxIdle();        // 返回毫秒值，-1 表示永不过期\n\n// 获取创建时间\nlong created = entry.getCreated();        // 创建时的时间戳\n\n// 获取最后访问时间\nlong lastUsed = entry.getLastUsed();      // 最后访问的时间戳\n\n// 检查是否过期\nboolean expired = entry.isExpired(System.currentTimeMillis());\n\n// 计算过期时间点\nlong expiryTime = entry.expiryTime();     // 返回具体的过期时间戳\n</code></pre>\n<pre><code class=\"language-plaintext\">DefaultSegmentedDataContainer\n  └── segments (DataSegment[])\n      └── [segment index] \n          └── entries (ConcurrentHashMap)\n              └── [key]\n                  └── InternalCacheEntry 对象\n                      ├── metadata\n                      │   ├── lifespan   ← 这里是 TTL（毫秒）\n                      │   └── maxIdle    ← 这里是空闲超时（毫秒）\n                      ├── created        ← 创建时间戳\n                      └── lastUsed       ← 最后访问时间戳\n</code></pre>\n<pre><code class=\"language-java\">// 在 InternalCacheEntry 中的过期检查逻辑（简化版）：\npublic boolean isExpired(long now) {\n    // lifespan 检查\n    if (lifespan &gt; 0 &amp;&amp; (created + lifespan) &lt;= now) {\n        return true;\n    }\n    // maxIdle 检查\n    if (maxIdle &gt; 0 &amp;&amp; (lastUsed + maxIdle) &lt;= now) {\n        return true;\n    }\n    return false;\n}\n</code></pre>\n<pre><code class=\"language-java\">// 写入缓存时设置 TTL\ncache.put(key, value, lifespanMs, TimeUnit.MILLISECONDS, maxIdleMs, TimeUnit.MILLISECONDS);\n</code></pre>\n\n\n</div>\n<div id=\"MySignature\">\n    <p></p>\n<div class=\"navgood\">\n<p>作者：仓储大叔，张占岭，<br />\n荣誉：微软MVP<br />QQ：853066980</p>\n\n<p><strong>支付宝扫一扫，为大叔打赏!</strong>\n<br /><img src=\"https://images.cnblogs.com/cnblogs_com/lori/237884/o_IMG_7144.JPG\" /></p>\n</div>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-30 14:53</span>&nbsp;\n<a href=\"https://www.cnblogs.com/lori\">张占岭</a>&nbsp;\n阅读(<span id=\"post_view_count\">5</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "实现鸿蒙（HarmonyOS）视频聊天、屏幕分享",
      "link": "https://www.cnblogs.com/zhuweisky/p/19553527",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/zhuweisky/p/19553527\" id=\"cb_post_title_url\" title=\"发布于 2026-01-30 14:52\">\n    <span>实现鸿蒙（HarmonyOS）视频聊天、屏幕分享</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        随着搭配原生鸿蒙（HarmonyOS）系统的电脑和手机越来越普及，之前实现的Windows和安卓版的视频聊天屏幕分享Demo，现在有必要实现一个鸿蒙版了！\n    </div>\n<div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<p>　随着搭配原生鸿蒙（HarmonyOS）系统的电脑和手机越来越普及，之前实现的<a href=\"https://www.cnblogs.com/zhuweisky/p/17579589.html\" target=\"_blank\">安卓版视频聊天屏幕分享的Demo</a>，现在有必要实现一个鸿蒙版了，该鸿蒙版的Demo可以与之前的安卓版和PC版互通的。&nbsp;</p>\n<p>　现在，我们来看看具体的实现过程，文末有Demo源码可以下载。</p>\n<h2>一. 开发环境</h2>\n<p>开发工具：DevEco Studio 6.0</p>\n<p>开发语言：ArkTS</p>\n<p>测试手机：华为 Mate 60 Pro&nbsp;&nbsp;</p>\n<p>HarmonyOS：6.0.0</p>\n<p>&nbsp; &nbsp; &nbsp;&nbsp;<img alt=\"screenshot_20260130_142928\" height=\"518\" src=\"https://img2024.cnblogs.com/blog/9005/202601/9005-20260130143205582-1489185788.jpg\" width=\"240\" /></p>\n<h2>二．<strong>功能介绍</strong></h2>\n<p class=\"p\">&nbsp; &nbsp; &nbsp; 鸿蒙手机端登录成功后，运行的主界面如下图所示：&nbsp;</p>\n<p>&nbsp; &nbsp; &nbsp;&nbsp;<img alt=\"IMG_1768891881_009\" height=\"505\" src=\"https://img2024.cnblogs.com/blog/20404/202601/20404-20260120145037184-1457081903.jpg\" width=\"234\" /></p>\n<h3>1. 视频聊天</h3>\n<p class=\"p\">（1）每个登录的用户都可向其他任意在线用户发送视频聊天请求。</p>\n<p class=\"p\">（2）当收到来自其他在线用户的视频聊天邀请时，可接受或拒绝对方的请求。</p>\n<p class=\"p\">（3）当接受其他在线用户的视频聊天邀请时，即可开启视频聊天。&nbsp;</p>\n<h3 class=\"p\">2. 屏幕分享</h3>\n<p class=\"p\">（1）每个登录的用户都可向其他任意在线用户发送屏幕分享请求；当对方未响应时，可主动取消屏幕分享请求。</p>\n<p class=\"p\">（2）当收到来自其他在线用户请求屏幕分享时，可接受或拒绝对方的请求。</p>\n<p class=\"p\">（3）当发送方收到其他在线用户同意屏幕分享时，即可观看对方的屏幕。</p>\n<h2>三．<strong>具体实现</strong></h2>\n<p>&nbsp; &nbsp; &nbsp; 下面我们讲一下Demo中核心的代码实现，</p>\n<h3><strong>1.自定义消息类型 InformationTypes</strong></h3>\n<div class=\"cnblogs_code\">\n<pre>export <span style=\"color: rgba(0, 0, 255, 1);\">enum</span><span style=\"color: rgba(0, 0, 0, 1);\"> informationType{\n\n</span><span style=\"color: rgba(0, 128, 0, 1);\">/*</span><span style=\"color: rgba(0, 128, 0, 1);\">*\n * 视频请求\n * </span><span style=\"color: rgba(0, 128, 0, 1);\">*/</span><span style=\"color: rgba(0, 0, 0, 1);\">\n\n  VideoRequest </span>= <span style=\"color: rgba(128, 0, 128, 1);\">0</span><span style=\"color: rgba(0, 0, 0, 1);\">,\n  </span><span style=\"color: rgba(0, 128, 0, 1);\">/*</span><span style=\"color: rgba(0, 128, 0, 1);\">*\n   *  对方同意连接摄像头\n   * </span><span style=\"color: rgba(0, 128, 0, 1);\">*/</span><span style=\"color: rgba(0, 0, 0, 1);\">\n  VideoResult </span>= <span style=\"color: rgba(128, 0, 128, 1);\">1</span><span style=\"color: rgba(0, 0, 0, 1);\">,\n  </span><span style=\"color: rgba(0, 128, 0, 1);\">/*</span><span style=\"color: rgba(0, 128, 0, 1);\">*\n   *  通知对方 挂断 视频连接\n   * </span><span style=\"color: rgba(0, 128, 0, 1);\">*/</span><span style=\"color: rgba(0, 0, 0, 1);\">\n  CloseVideo </span>= <span style=\"color: rgba(128, 0, 128, 1);\">2</span><span style=\"color: rgba(0, 0, 0, 1);\">,\n\n  </span><span style=\"color: rgba(0, 128, 0, 1);\">/*</span><span style=\"color: rgba(0, 128, 0, 1);\">*\n   *  通知好友 网络原因，导致 视频中断\n   * </span><span style=\"color: rgba(0, 128, 0, 1);\">*/</span><span style=\"color: rgba(0, 0, 0, 1);\">\n   NetReasonCloseVideo </span>= <span style=\"color: rgba(128, 0, 128, 1);\">3</span><span style=\"color: rgba(0, 0, 0, 1);\">,\n\n  </span><span style=\"color: rgba(0, 128, 0, 1);\">/*</span><span style=\"color: rgba(0, 128, 0, 1);\">*\n   * 通知对方(忙线中) 挂断 视频连接\n   * </span><span style=\"color: rgba(0, 128, 0, 1);\">*/</span><span style=\"color: rgba(0, 0, 0, 1);\">\n  BusyLine </span>= <span style=\"color: rgba(128, 0, 128, 1);\">4</span><span style=\"color: rgba(0, 0, 0, 1);\">,\n\n  </span><span style=\"color: rgba(0, 128, 0, 1);\">/*</span><span style=\"color: rgba(0, 128, 0, 1);\">*\n   * 远程桌面请求\n   * </span><span style=\"color: rgba(0, 128, 0, 1);\">*/</span><span style=\"color: rgba(0, 0, 0, 1);\">\n  DesktopRequest </span>= <span style=\"color: rgba(128, 0, 128, 1);\">5</span><span style=\"color: rgba(0, 0, 0, 1);\">,\n\n  </span><span style=\"color: rgba(0, 128, 0, 1);\">/*</span><span style=\"color: rgba(0, 128, 0, 1);\">*\n   *  回复远程桌面请求的结果\n   * </span><span style=\"color: rgba(0, 128, 0, 1);\">*/</span><span style=\"color: rgba(0, 0, 0, 1);\">\n  DesktopResult </span>= <span style=\"color: rgba(128, 0, 128, 1);\">6</span><span style=\"color: rgba(0, 0, 0, 1);\">,\n\n  </span><span style=\"color: rgba(0, 128, 0, 1);\">/*</span><span style=\"color: rgba(0, 128, 0, 1);\">*\n   * 主动取消远程桌面请求\n   * </span><span style=\"color: rgba(0, 128, 0, 1);\">*/</span><span style=\"color: rgba(0, 0, 0, 1);\">\n  CancelDesktop </span>= <span style=\"color: rgba(128, 0, 128, 1);\">7</span><span style=\"color: rgba(0, 0, 0, 1);\">,\n\n  </span><span style=\"color: rgba(0, 128, 0, 1);\">/*</span><span style=\"color: rgba(0, 128, 0, 1);\">*\n   * 对方（主人端）主动断开远程桌面\n   * </span><span style=\"color: rgba(0, 128, 0, 1);\">*/</span><span style=\"color: rgba(0, 0, 0, 1);\">\n  OwnerCloseDesktop </span>= <span style=\"color: rgba(128, 0, 128, 1);\">8</span><span style=\"color: rgba(0, 0, 0, 1);\">,\n\n  </span><span style=\"color: rgba(0, 128, 0, 1);\">/*</span><span style=\"color: rgba(0, 128, 0, 1);\">*\n   * 客人端断开远程桌面连接\n   * </span><span style=\"color: rgba(0, 128, 0, 1);\">*/</span><span style=\"color: rgba(0, 0, 0, 1);\">\n  GuestCloseDesktop </span>= <span style=\"color: rgba(128, 0, 128, 1);\">9</span><span style=\"color: rgba(0, 0, 0, 1);\">\n}</span></pre>\n</div>\n<h3>2. 发送视频请求</h3>\n<p>（1）当发起视频聊天时，将显示视频聊天窗口,并发送视频连接请求</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">获取到多媒体管理器</span>\n@State multimediaManager: IMultimediaManager =<span style=\"color: rgba(0, 0, 0, 1);\"> MultimediaManagerFactory.GetSingleton();\nButton(</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">请求视频会话</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span>).type(ButtonType.Normal).borderRadius(<span style=\"color: rgba(128, 0, 128, 1);\">5</span>).backgroundColor(<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">#DBDCDE</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span>).fontColor(Color.Black).fontWeight(<span style=\"color: rgba(128, 0, 128, 1);\">300</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n.onClick(()</span>=&gt;<span style=\"color: rgba(0, 0, 0, 1);\">{\n</span><span style=\"color: rgba(0, 0, 255, 1);\">if</span>(!<span style=\"color: rgba(0, 0, 255, 1);\">this</span>.pathStack) <span style=\"color: rgba(0, 0, 255, 1);\">return</span><span style=\"color: rgba(0, 0, 0, 1);\">;\n</span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">发送视频连接请求 </span>\n<span style=\"color: rgba(0, 0, 255, 1);\">this</span>.multimediaManager.sendCustomizedMessage(<span style=\"color: rgba(0, 0, 255, 1);\">this</span>.connectID,informationType.VideoRequest,[],<span style=\"color: rgba(128, 0, 0, 1);\">''</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n</span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">跳转到视频请求页面</span>\n<span style=\"color: rgba(0, 0, 255, 1);\">this</span>.pathStack.pushPath({ name:<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">video</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span> ,param:<span style=\"color: rgba(0, 0, 255, 1);\">this</span><span style=\"color: rgba(0, 0, 0, 1);\">.connectID})\n})</span></pre>\n</div>\n<p>&nbsp;（2）连接自己的摄像头，预览自己的视频</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">只需要在模板层调用这个组件，就会连接到自己的摄像头</span>\nCameraPreview()</pre>\n</div>\n<p>（3）当发送聊天邀请时，将显示视频邀请窗口&nbsp; &nbsp;</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img alt=\"IMG_1768892392_012\" height=\"505\" src=\"https://img2024.cnblogs.com/blog/20404/202601/20404-20260120145906525-807654024.jpg\" width=\"234\" />&nbsp;</p>\n<h3>3. 回复对方视频请求</h3>\n<p>（1）当收到对方的视频聊天邀请时，将显示视频邀请窗口&nbsp; &nbsp;</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<img alt=\"IMG_1768892490_013\" height=\"505\" src=\"https://img2024.cnblogs.com/blog/20404/202601/20404-20260120150023513-1437224293.jpg\" width=\"234\" /></p>\n<p>&nbsp;&nbsp;（2）发送回复视频聊天请求消息</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">同意对方的视频邀请\n</span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">connectID - 对方的ID</span>\n\n<span style=\"color: rgba(0, 0, 255, 1);\">this</span>.multimediaManager.sendCustomizedMessage(<span style=\"color: rgba(0, 0, 255, 1);\">this</span>.connectID,informationType.VideoResult,[<span style=\"color: rgba(128, 0, 128, 1);\">1</span>],<span style=\"color: rgba(128, 0, 0, 1);\">''</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n\n</span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">拒绝对方的视频邀请</span>\n<span style=\"color: rgba(0, 0, 255, 1);\">this</span>.multimediaManager.sendCustomizedMessage(<span style=\"color: rgba(0, 0, 255, 1);\">this</span>.connectID,informationType.CloseVideo,[],<span style=\"color: rgba(128, 0, 0, 1);\">''</span>)</pre>\n</div>\n<h3>4. 收到对方视频请求的回复</h3>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">设置收到来自服务器或其它客户端的自定义消息</span>\n<span style=\"color: rgba(0, 0, 255, 1);\">this</span>.multimediaManager.setCustomizedMessageListener((srcUserID: <span style=\"color: rgba(0, 0, 255, 1);\">string</span>, msgType: number, msg: number[], tag: <span style=\"color: rgba(0, 0, 255, 1);\">string</span>)=&gt;<span style=\"color: rgba(0, 0, 0, 1);\">{\n                          </span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">对方回复视频请求的结果</span>\n                          <span style=\"color: rgba(0, 0, 255, 1);\">if</span>(msgType ==<span style=\"color: rgba(0, 0, 0, 1);\"> informationType.VideoResult){\n                            </span><span style=\"color: rgba(0, 0, 255, 1);\">const</span> res = <span style=\"color: rgba(0, 0, 255, 1);\">new</span><span style=\"color: rgba(0, 0, 0, 1);\"> Stream(msg)\n                            </span><span style=\"color: rgba(0, 0, 255, 1);\">const</span> <span style=\"color: rgba(0, 0, 255, 1);\">bool</span> =<span style=\"color: rgba(0, 0, 0, 1);\"> res.readBoolean()\n                            </span><span style=\"color: rgba(0, 0, 255, 1);\">if</span>(<span style=\"color: rgba(0, 0, 255, 1);\">bool</span><span style=\"color: rgba(0, 0, 0, 1);\">){\n                             </span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">当对方回复同意时，将连接到对方的麦克风和摄像头，开始视频聊天会话</span>\n                              <span style=\"color: rgba(0, 0, 255, 1);\">this</span>.isAnswer = <span style=\"color: rgba(0, 0, 255, 1);\">true</span><span style=\"color: rgba(0, 0, 0, 1);\">;\n                            }</span><span style=\"color: rgba(0, 0, 255, 1);\">else</span><span style=\"color: rgba(0, 0, 0, 1);\">{\n                             </span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">否则直接挂断</span>\n                              <span style=\"color: rgba(0, 0, 255, 1);\">this</span><span style=\"color: rgba(0, 0, 0, 1);\">.promptAction.showToast({\n                                message: `对方挂断`,\n                                duration: </span><span style=\"color: rgba(128, 0, 128, 1);\">1000</span><span style=\"color: rgba(0, 0, 0, 1);\">\n                              })\n                              </span><span style=\"color: rgba(0, 0, 255, 1);\">this</span>.isAnswer = <span style=\"color: rgba(0, 0, 255, 1);\">false</span><span style=\"color: rgba(0, 0, 0, 1);\">;\n                              </span><span style=\"color: rgba(0, 0, 255, 1);\">this</span>.isOnVideo = <span style=\"color: rgba(0, 0, 255, 1);\">false</span><span style=\"color: rgba(0, 0, 0, 1);\">;\n                              </span><span style=\"color: rgba(0, 0, 255, 1);\">this</span>.connect2me = <span style=\"color: rgba(0, 0, 255, 1);\">false</span><span style=\"color: rgba(0, 0, 0, 1);\">;\n                              </span><span style=\"color: rgba(0, 0, 255, 1);\">this</span>.pageStack.removeByName(<span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(128, 0, 0, 1);\">video</span><span style=\"color: rgba(128, 0, 0, 1);\">\"</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n                            }\n                          }\n\n})    </span></pre>\n</div>\n<p>&nbsp;当对方回复同意时，将连接到对方的麦克风和摄像头，开始视频聊天会话：</p>\n<div class=\"cnblogs_code\">\n<pre> <span style=\"color: rgba(0, 0, 255, 1);\">if</span>(<span style=\"color: rgba(0, 0, 255, 1);\">this</span><span style=\"color: rgba(0, 0, 0, 1);\">.isAnswer){\n      </span><span style=\"color: rgba(0, 0, 255, 1);\">this</span>.cameraConnector = <span style=\"color: rgba(0, 0, 255, 1);\">new</span><span style=\"color: rgba(0, 0, 0, 1);\"> CameraConnector()\n      </span><span style=\"color: rgba(0, 0, 255, 1);\">this</span>.microphoneConnector = <span style=\"color: rgba(0, 0, 255, 1);\">new</span><span style=\"color: rgba(0, 0, 0, 1);\"> MicrophoneConnector()\n      \n      </span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">设置摄像头的索引</span>\n        <span style=\"color: rgba(0, 0, 255, 1);\">this</span>.multimediaManager.setCameraDeviceIndex(<span style=\"color: rgba(0, 0, 255, 1);\">this</span>.switchCamera?<span style=\"color: rgba(128, 0, 128, 1);\">1</span>:<span style=\"color: rgba(128, 0, 128, 1);\">0</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n      </span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">开始连接对方摄像头</span>\n        <span style=\"color: rgba(0, 0, 255, 1);\">this</span>.cameraConnector.beginConnect(<span style=\"color: rgba(0, 0, 255, 1);\">this</span><span style=\"color: rgba(0, 0, 0, 1);\">.connectID)\n      </span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">开始连接对方麦克风</span>\n        <span style=\"color: rgba(0, 0, 255, 1);\">this</span>.microphoneConnector.beginConnect(<span style=\"color: rgba(0, 0, 255, 1);\">this</span><span style=\"color: rgba(0, 0, 0, 1);\">.connectID)\n      </span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\">启动定时器计时</span>\n        <span style=\"color: rgba(0, 0, 255, 1);\">this</span><span style=\"color: rgba(0, 0, 0, 1);\">.timer()\n    }</span></pre>\n</div>\n<h3>5. 实现屏幕分享</h3>\n<p class=\"p\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;屏幕分享的请求/应答逻辑几乎与视频聊天请求/应答逻辑是一模一样的。这里就不再罗列响应的代码了。</p>\n<p class=\"p\">　　&nbsp; 下面的截图是以Windows与鸿蒙互动为例：Windows端作为请求方，鸿蒙端作为应答方。（反过来也是一样的）</p>\n<p class=\"p\">（1）PC端发起请求&nbsp;</p>\n<p class=\"p\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img alt=\"1234\" height=\"123\" src=\"https://img2024.cnblogs.com/blog/9005/202601/9005-20260130145738014-1390202129.png\" width=\"377\" /></p>\n<p class=\"p\">（2）鸿蒙端收到对方的屏幕分享请求时，将显示请求窗口。</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img alt=\"IMG_1768890229_008\" height=\"505\" src=\"https://img2024.cnblogs.com/blog/20404/202601/20404-20260120142332871-1956298305.jpg\" width=\"234\" /></p>\n<p>&nbsp;（3）当鸿蒙端同意请求时，PC端就可以观看鸿蒙手机的屏幕了。</p>\n<p>&nbsp; &nbsp; &nbsp; &nbsp;<img alt=\"QQ_1768891224958\" height=\"321\" src=\"https://img2024.cnblogs.com/blog/20404/202601/20404-20260120144027779-1099460013.png\" width=\"570\" /></p>\n<h2>&nbsp;四. 源码下载</h2>\n<p>&nbsp;1. 鸿蒙端源码：<strong>&nbsp;<span class=\"style1\"><a href=\"https://dl.oraycn.com/DownLoadFiles/OMCS/VideoChatMini_HarmonyOS.rar\" rel=\"noopener nofollow\">VideoChatMini_HarmonyOS.rar</a>&nbsp;</span></strong></p>\n<p>&nbsp;2.&nbsp;Android 端：<strong><a href=\"https://dl.oraycn.com/DownLoadFiles/OMCS/VideoChatMini.Android.rar\" rel=\"noopener nofollow\" target=\"_blank\">VideoChatMini.Android.rar</a></strong></p>\n<p>&nbsp;3. 服务端 + PC 端：<strong><a href=\"https://dl.oraycn.com/DownLoadFiles/OMCS/VideoChatMini.rar\" rel=\"noopener nofollow\" target=\"_blank\">VideoChatMini.rar</a></strong>&nbsp;</p>\n<p>在这里，我也给出了PC端的源码，PC端项目对应的目录是 VideoChatMini.ClientWPF。服务端和PC端都是 C# 开发的（开发环境是 VS2022），PC端UI使用的是WPF。</p>\n<p>鸿蒙端、PC端、安卓端是可以互通的，也就是可以相互视频通话，以及观看屏幕/桌面。</p>\n<p>在实现了该Demo的鸿蒙手机版后，接下来，我还会实现该Demo的鸿蒙PC版，到时再分享给大家！</p>\n<p>&nbsp;</p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-30 14:52</span>&nbsp;\n<a href=\"https://www.cnblogs.com/zhuweisky\">zhuweisky</a>&nbsp;\n阅读(<span id=\"post_view_count\">12</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "[译] Kubernetes 1.23 到 1.24：一次让 Reddit 宕机超 5 小时的升级踩坑",
      "link": "https://www.cnblogs.com/manuscript/p/19553451",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/manuscript/p/19553451\" id=\"cb_post_title_url\" title=\"发布于 2026-01-30 14:36\">\n    <span>[译] Kubernetes 1.23 到 1.24：一次让 Reddit 宕机超 5 小时的升级踩坑</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p><img alt=\"可爱的异常朋友们\" src=\"https://img2024.cnblogs.com/blog/3735354/202601/3735354-20260130141655469-583522255.png\" /><br />\n<em>可爱的异常朋友们</em></p>\n<p>还记得这个 <code>500</code> 错误页面吗？似乎是好久以前的事了。那时候的它既可爱又有趣。而现在，我们那只可怜的 Snoo 正被如山的点赞压得喘不过气来。不幸的是，如果你在美国时间 3 月 14 日下午尝试浏览 Reddit，你可能已经在这次 <a href=\"https://www.reddit.com/r/shittychangelog/comments/11rhs8z/in_celebration_of_pi_day_we_took_the_site_down/\" rel=\"noopener nofollow\" target=\"_blank\">314 分钟的宕机事故</a> 中看到了那只倒霉的 Snoo（而且还是在 <a href=\"https://en.wikipedia.org/wiki/Pi_Day\" rel=\"noopener nofollow\" target=\"_blank\">Pi Day</a>！）。或许你只看到了空空如也的主页，或者一个报错信息。不管怎样，Reddit 确实挂了。但这并不是你的网络问题，而是我们的锅。</p>\n<p>今天我们将聊聊这次 Pi Day 宕机事件，但在此之前，我想先肯定我们团队的付出。在过去的几年里，我们一直致力于提高系统的可用性。事实上，我们的 CTO 写过一篇<a href=\"https://www.reddit.com/r/RedditEng/comments/10egj46/seeing_the_forest_in_the_trees_two_years_of/\" rel=\"noopener nofollow\" target=\"_blank\">很棒的博文</a>，详细介绍了我们这几年来的改进。按照 Reddit 的传统艺能，我就直接把那张图偷来贴在这儿了。</p>\n<p><img alt=\"Reddit 的每日可用时间与当前 SLO 目标\" src=\"https://img2024.cnblogs.com/blog/3735354/202601/3735354-20260130141902771-1701752015.png\" /><br />\n<em>Reddit 的每日可用时间与当前 SLO 目标</em></p>\n<p>正如你所见，我们在提升 Reddit 可用性方面取得了显著进展。虽然我们一直在强调改进并努力降低变更风险，但我们尚未在所有领域达到预期目标，因此我们深知某些变更仍然存在不合理的风险。Kubernetes 版本和组件升级对我们来说，依然是一个容易“搬起石头砸自己脚”（footgun）的巨大隐患。事实上，这也正是导致我们 3.14 宕机的主要诱因。</p>\n<h1 id=\"太长不看版\">太长不看版</h1>\n<ul>\n<li><strong>升级必要与风险</strong>：升级工作（尤其是 Kubernetes 集群升级）存在一定风险，但又是必须推进的任务。我们将通过充分的测试与验证尽可能降低风险，尽管如此，后续仍有大量工作等待完成；</li>\n<li><strong>隐蔽的升级深坑</strong>：在我们操作的特定集群上，从 Kubernetes 1.23 升级到 1.24 的过程中，我们踩到了一个前所未见且极其隐蔽的坑。我们花了几个小时才最终决定回滚（而回滚本身也是一个高风险操作）；</li>\n<li><strong>备份恢复的痛点</strong>：备份恢复令人讨厌。我们现有的流程有大量问题需要改进。但幸运的是，这次它奏效了；</li>\n<li><strong>后知后觉的根因</strong>：直到我们恢复完成数小时后，才发现了那个极其隐蔽的根本原因；</li>\n<li><strong>还没有全军覆没</strong>：并非所有服务都中断了。我们的现代服务 API 层都保持弹性运行，但这影响了依赖关系中最关键的遗留节点，因此影响范围仍然包括大多数用户流，我们的现代化进程中仍需更多工作；</li>\n<li><strong>将危机化为动力</strong>：我们决心利用这次宕机事件，彻底改变我们长期以来的一些主要架构和流程决策，确保未来的集群升级安全无恙。</li>\n</ul>\n<h1 id=\"故障的开始\">故障的开始</h1>\n<p>这事说起来有点讽刺意味。我们团队刚完成了一次之前不太成功的 Kubernetes 升级经验总结，那次问题并不严重，而且根因也已经完全解决了。所以我们又开始对同一个集群进行另一次升级了。</p>\n<p>今年我们一直在大力进行内部整顿，试图让系统处于更加易于维护的状态。管理 k8s 集群在很多方面都很痛苦。Reddit 自 2009 年起就在云上运行，并且较早地采用了 k8s。在此过程中我们积累了一堆使用 kubeadm 工具构建的定制化集群。其中一些集群甚至大到无法通过各种云托管服务来支持。这段历史导致了升级节奏的不一致以及集群间配置的分裂。用 DevOps 的话说，我们养了一群需要精心照料的宠物，而不是管理一群标准化的牛。</p>\n<blockquote>\n<p>译者注：其中 “宠物与牛” 对应 DevOps 中的 “Pets vs Cattle”。我没有想出更好的简化翻译方式，可以参考<a href=\"https://cloudscaling.com/blog/cloud-computing/the-history-of-pets-vs-cattle/\" rel=\"noopener nofollow\" target=\"_blank\">此文章</a>进行理解。</p>\n</blockquote>\n<p>计算团队（Compute Team）负责管理与运行工作负载相关的基础设施，并花费了大量时间来定义和完善我们的升级流程来改善现状。升级会先在专用的集群集上测试，然后按照优先级从低到高的顺序发布到生产环境。这次升级是我们团队本季度的重点任务之一，而作为公司最重要的集群之一：运行着我们技术栈中“遗留部分”（社区亲切地称为 Old Reddit）的集群，已准备好升级到下一个版本。负责此项工作的工程师在 UTC 时间 19:00 刚过就启动了升级，起初的 2 分钟一切正常。然后混乱降临。</p>\n<p><img alt=\"Reddit 边缘流量，按 RPS 统计\" src=\"https://img2024.cnblogs.com/blog/3735354/202601/3735354-20260130142503354-821822164.png\" /><br />\n<em>Reddit 边缘流量，按 RPS 统计</em></p>\n<p>网站瞬间陷入瘫痪。我们立即创建了事故工单，并召集所有人手排查问题。在 <a href=\"https://en.wikipedia.org/wiki/Countdown\" rel=\"noopener nofollow\" target=\"_blank\">T+3</a> 分钟内已全员就位。我们发现的第一件事是：受影响的集群完全丢失了所有指标（上图显示的是我们 CDN 边缘的统计数据，这些数据特意与主数据分开展示）。我们完全摸不着头脑。唯一明显的线索是 DNS 解析失败了。我们无法解析 Consul（用于跨环境动态 DNS 的服务）中的记录，也无法解析集群内的 DNS 条目。但奇怪的是，公共 DNS 记录的解析却一切正常。我们顺着这条线索查了一会却一无所获。这是我们在之前的任何升级或测试中从未见过的新问题。</p>\n<p>面对部署失败，立即回滚是首选方案，我们第一时间也考虑过这点。但亲爱的 Redditor 们，k8s 并没有官方支持的降级流程。因为在升级过程中，k8s 会自动执行许多架构、数据迁移操作，所以没有回头路。因此，降级意味着必须从备份中恢复并重新加载状态！</p>\n<p>我们向来谨慎，备份当然是升级流程中的标准动作。然而这个备份和恢复程序是几年前写的。尽管它在我们的小型测试集群中经过了反复、全面的测试，但它并没有完全跟上生产环境的变化，而且我们从未在生产集群上使用过它，更别说在这个集群上了。这意味着我们不确定执行恢复操作需要多久，但初步估计至少是数小时的停机时间。因此我们决定继续调查并尝试找到解决方案。</p>\n<h1 id=\"故障的表现形式\">故障的表现形式</h1>\n<p>大约过去了 30 分钟，我们仍然没有找到明确的线索。更多人加入了电话会议。来自不同值班轮换的六位工程师正在一线排查，而其他几十人则在观察并提供建议。又过了 30 分钟，我们有了一些眉目，但仍无定论。是时候启动应急预案了，我们分出了一部分计算团队成员去准备从备份中恢复系统的流程。</p>\n<p>在此期间，我们几个人仔细查看了日志。尝试重启组件，心想或许有些组件陷入了无限循环或连接池泄漏。同时也注意到以下几点：</p>\n<ul>\n<li>Pod 的启动和停止极慢；</li>\n<li>容器镜像拉取极慢（在多千兆带宽下，拉取 &lt;100MB 的镜像需要数分钟）；</li>\n<li>控制平面日志大量刷新，但没有明显的错误信息。</li>\n</ul>\n<p>在某个时刻，我们发现<a href=\"https://www.cni.dev/\" rel=\"noopener nofollow\" target=\"_blank\">容器网络接口（CNI）</a> Calico 工作异常。它的 Pod 状态不健康。Calico 在我们环境中有三个关键组件：</p>\n<ul>\n<li><strong>calico-kube-controllers</strong>：负责根据集群状态采取行动，将 IP 池分配给节点供 Pod 使用；</li>\n<li><strong>calico-typha</strong>：一个聚合、缓存代理，位于 Calico 其他组件和控制平面之间，以减轻 K8s API 的负载；</li>\n<li><strong>calico-node</strong>：网络的核心。在每个节点上运行的代理，负责为 Pod 动态配置网络接口。</li>\n</ul>\n<p>我们首先发现 <code>calico-kube-controllers</code> Pod 卡在了 <code>ContainerCreating</code>状态。作为集群控制平面升级的一部分，我们也需要将容器运行时升级到适配的版本。该环境使用 CRI-O 作为容器运行时。最近在某个主机上升级 CRI-O 时发现了一个低危 bug：一个或多个容器退出后，会随机且低概率地卡在重新启动过程中。快速的解决方法是删除该 Pod，它会被重新创建，然后就可以继续操作了。但这次的情况并非如此，这不是问题所在。</p>\n<p>接下来我们决定重启 <code>calico-typha</code> 服务。情况开始有趣起来：在删除所有 Pod 后，等待重启却并未触发新 Pod 创建。等待数分钟后，依旧没有新 Pod 生成。为了打破僵局，我们对控制平面组件进行了滚动重启，但情况依然没有变化。最后尝试了最经典的重启大法，关闭整个控制平面再重新打开，不过这一尝试也未能奏效。</p>\n<p>此时有人发现 API 服务器日志中出现了大量写入操作超时。但并非写入本身的超时，而是集群上<a href=\"https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/\" rel=\"noopener nofollow\" target=\"_blank\">准入控制器</a>调用超时。Reddit 使用了多个不同的准入控制器 Webhook。在这个集群上，唯一监视所有资源的准入控制器是 <a href=\"https://www.openpolicyagent.org/\" rel=\"noopener nofollow\" target=\"_blank\">Open Policy Agent（OPA）</a>。由于 OPA 本身已经宕机，我们趁此机会删除了它的 Webhook 配置。超时立即消失了，但集群依然没有恢复。</p>\n<h1 id=\"回滚流程\">回滚流程</h1>\n<p>此时宕机已经持续了两个多小时，我们已经想不出什么好办法了。是时候做出艰难的决定了：从备份中恢复。考虑到大部分正在运行的工作节点都会因为恢复而失效，我们开始终止这些节点，这样在控制平面恢复后就不用再进行漫长的协调工作了。不幸的是，由于这是我们最大的集群，这个过程也相当耗时，所有 API 调用大约需要 20 分钟才能完成。</p>\n<p>完成上述步骤后，我们着手进行恢复工作，这是所有参与者之前从未执行过的流程，更不用说在我们最容易出现故障的单点故障上进行恢复了。简而言之，恢复流程如下：</p>\n<p>随后我们开始了恢复工作，这是所有参与者之前从未执行过的流程，一个从未有人在我们“最喜欢的单点故障”核心集群上执行过的流程：</p>\n<blockquote>\n<p>译者注：这里最后一句是原文作者的一个黑色幽默。</p>\n</blockquote>\n<ol>\n<li><strong>缩容至单节点</strong>：终止其他控制平面，只保留一个；</li>\n<li><strong>组件版本回滚</strong>：将仅存节点上的 K8s 组件回滚到旧版本；</li>\n<li><strong>单点数据恢复</strong>：执行 etcd 数据恢复操作；</li>\n<li><strong>重建高可用</strong>：启动新的控制平面节点，并将它们加入集群以同步数据，重建高可用。</li>\n</ol>\n<p>立刻，我们遇到了问题。这个程序是针对已过时的 Kubernetes 版本编写的，而且早于我们切换到 CRI-O 的时间点，意味着所有指令都是基于 Docker 的。命令语法变了，参数失效了，我们不得不现场重写程序。</p>\n<p>我们立即发现了一些问题。该流程是基于一个现已停止维护的 k8s 版本编写的，而且早于我们切换到 CRI-O 的时间，这意味着所有指令都是针对 Docker 编写的。导致了一些令人困惑的变量，例如命令语法已更改、参数不再有效，我们不得不重写该流程用来适应这些变化。但正如你即将看到的，在某个时刻对我们造成了不利影响。</p>\n<p>在我们环境中并非把所有控制节点一视同仁。会给它们编号，第一个节点通常被视为“特殊性”的，将它作为操作基准，实际它们功能是一样的。但我们没有设置主机名来反映它们在控制节点中的身份，而是保留 AWS 默认主机名（如 <code>ip-10-1-0-42.ec2.internal</code>）。恢复流程要求我们应该终止除第特殊节点外的所有控制节点，然后将备份恢复到该节点，然后用新节点替换其他节点。</p>\n<p>第一个节点的恢复完成了。随着集群自动缩放器（Cluster Autoscaler）启动，其他节点开始陆续上线。这是一个好兆头，表明网络恢复了。但当时我们还没做好充分准备，因为：这是一个大型集群，仅靠单节点控制平面很可能在高负载下崩溃。所以我们希望在真正开始扩容前，先让另外两个控制节点恢复上线。因此关闭了自动缩放器以争取时间将系统恢复到已知状态。然而当我们启动它俩时，却遇到了新的难题：AWS 提示我们控制节点急需的那款服务器型号库存不足，这让我们进退两难。因为当时自动化部署命令（Terraform apply）已经运行了，如果强行中断，很可能把后台的资源状态文件（State）搞乱，引发一连串未知的连锁反应。在那个节骨眼上，我们要尽量避免让局势雪上加霜。好在最终 AWS 腾出了资源，服务器启动成功，我们随即开始尝试将它们加入集群。</p>\n<blockquote>\n<p>译者注：最后的问题是通过 IaC 工具 <a href=\"https://developer.hashicorp.com/terraform\" rel=\"noopener nofollow\" target=\"_blank\">Terraform</a> 在 AWS 上一键部署控制节点，但配置中让控制节点使用的云服务器没货了导致一直卡在部署中。</p>\n</blockquote>\n<p>下一个问题出现了：新节点无法加入。每次都会卡住，没有错误提示，原因是无法连接到第一个节点上的 etcd。几位工程师再次研究连接失败的原因，其余同事则计划如何从冷启动开始，缓慢而优雅地恢复工作负载。只用了几分钟就找到了问题所在：我们的恢复流程对操作顺序和恢复目标都有严格的规定，但备份流程却没有限制。我们的备份流程可以在任何控制平面节点上执行，但恢复必须在同一节点上执行。然而恢复时没有这么做。这意味着，由于主机名不匹配，正常工作的节点提供的 TLS 证书对其他任何设备都无效，无法与其通信。由于缺乏文档，我们费了一番周折才生成了新的有效证书。新节点成功加入，我们又拥有了一个正常运行的高可用性控制平面。</p>\n<p>与此同时，主要响应团队开始恢复流量。这是我们很长一段时间以来遇到的最长宕机时间，因此我们采取了极其保守的策略，最初只恢复了大约 1% 的流量。Reddit 依赖大量的缓存才能勉强维持运行。如果立即恢复所有流量，下游服务可能因准备不足，在突发的大流量冲击下出现<a href=\"https://en.wikipedia.org/wiki/Thundering_herd_problem\" rel=\"noopener nofollow\" target=\"_blank\">惊群效应</a>（Thundering Herd Problem）问题。</p>\n<p>在服务中断的情况下，这种情况往往会更加严重，因为闲置的服务通常会缩容来节省资源。我们有一些工具可以帮助解决这个问题，将在另一篇博文中介绍，但关键在于我们不想一下子就把所有资源都用光。我们从 1% 开始，逐步小幅恢复：5%、10%、20%、35%、55%、80%、100%，网站基本恢复了正常。一些特别敏感的旧服务通过手动重启的方式确保它们在流量恢复后不会出现故障。</p>\n<p>成功了！故障已经恢复。</p>\n<p>但我们仍然不知道它最初为什么发生。</p>\n<h1 id=\"通过日志锁定故障\">通过日志锁定故障</h1>\n<p>我们随即展开了进一步调查。开始搜寻所有能想到的线索，试图缩小故障发生的时间范围，希望能从指标崩溃前的最后时刻找到一些线索。然而并没有。不过这次一个历史决策帮了忙：我们的日志代理（Logging Agent）没有受到影响。指标是 k8s 原生的，但日志级别非常低。因此我们保留了这些日志。</p>\n<p>我们首先尝试找出故障发生的确切时刻。控制平面的 API 日志在 UTC 时间 19:04:49 突然激增，日志量一瞬间增加了 5 倍。但其中唯一的线索是我们之前已经发现的：调用 OPA 超时。接下来我们检查了故障发生确切时刻的 OPA 日志。在控制平面 API 开始大量输出日志前约 5 秒，OPA 日志完全停止了。陷入了死胡同。真的是这样吗？</p>\n<p>Calico 在某个时间点开始出现故障。我们查看了该时间段的日志，发现了下一个线索。</p>\n<p><img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/3735354/202601/3735354-20260130142813912-1970003575.png\" /><br />\n<em>为了保持沟通的一致性，所有 Reddit 指标和事件活动均以 UTC 时间为准。由于我们的日志系统过于精确，此处的日志时间戳采用的是美国中部时间。</em></p>\n<p>混乱爆发的前两秒，集群中所有 <code>calico-node</code> 守护进程开始丢弃通往第一个控制平面节点的路由。这是预期行为，因为该控制节点在升级过程中会离线。但出乎意料的是，所有节点的路由都开始断开。就在这时，我恍然大悟。</p>\n<p>Calico 的默认工作方式是，集群每个节点都与其他所有节点直接建立对等连接，形成一个网状网络。这在小型集群中非常有效，因为它能显著降低管理的复杂性。但在大型集群中，这种方式会变得非常繁重；这些连接（各节点都要将路由传播到其他节点）的扩展性很差。这时就需要用到路由反射器（Route Reflectors）：它的理念是指定少量节点与所有节点建立对等连接，而其余节点只与这些反射器建立对等连接。这样可以显著减少连接数，并降低 CPU 和网络开销。从理论上讲，路由反射器非常理想，并且可以扩展到更多的节点数量（建议在节点数 &gt;100 时使用，而我们的节点数起码要在后面加个零）。然而 Calico 对路由反射器的配置比较晦涩难懂，难以追踪。这正是我们问题的根源所在。</p>\n<p>路由反射器是几年前由前任团队设置的。随着时间的推移、人员流动和团队发展，所有了解其存在的人员都已离职或跳槽。只有我们规模最大、历史最悠久的集群还在使用它们。因此，没人意识到它可能存在问题。此外，Calico 的配置方式无法通过代码轻松管理。路由反射器配置的一部分需要下载 Calico 特有的数据（这些数据只能通过其 CLI 界面管理，而不是标准的 Kubernetes API），然后手动编辑并上传。要实现这一点，就需要编写自定义工具。不幸的是，我们当时并没有这样做。因此路由反射器的配置没有被提交到任何地方，导致我们没有任何记录，工程师也无法追踪问题。一位工程师碰巧记得我们曾使用过这个功能，并在这次事后分析过程中进行了研究，发现这才是真正影响我们并影响我们的方式。</p>\n<h1 id=\"故障总结\">故障总结</h1>\n<p>它究竟是如何崩溃的？这真是最出乎意料的事情之一。在研究过程中，我们发现路由反射器的配置方式是将控制平面节点设置为反射器，并让所有其他节点都使用这些反射器。这相当直接，而且在自动扩缩容集群中，控制平面节点是唯一始终可用的节点，这样做也合乎逻辑。然而，这种配置方式存在一个隐蔽的缺陷。请看下面的代码，看看你能不能发现它。提示一下：我们当时升级到的版本是 k8s 1.24。</p>\n<p><img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/3735354/202601/3735354-20260130143018457-1152758608.png\" /><br />\n<em>一个令人毛骨悚然的 Kubernetes 对象在 YAML 中的内容</em></p>\n<p>路由反射器的 <code>nodeSelector</code> 和 <code>peerSelector</code> 指向标签 <code>node-role.kubernetes.io/master</code>。在 k8s 1.20 版本中，将其术语<a href=\"https://github.com/kubernetes/enhancements/blob/master/keps/sig-cluster-lifecycle/kubeadm/2067-rename-master-label-taint/README.md\" rel=\"noopener nofollow\" target=\"_blank\">从 <code>master</code> 更改为 <code>control-plane</code></a>。在 1.24 版本中，他们<a href=\"https://github.com/kubernetes/kubernetes/pull/107533\" rel=\"noopener nofollow\" target=\"_blank\">移除了对 master 的引用</a>。这就是导致我们服务中断的原因：k8s 节点标签。</p>\n<p>但这并非全部原因。实际上真正的根因更加系统性，也是我们多年来一直在努力解决的问题之一：不一致。</p>\n<p>Reddit 的几乎每个 k8s 集群都以某种方式进行了定制。无论是仅在该集群上运行的独特组件、独特的工作负载、仅在单个可用区运行的开发集群，还是其他各种因素，都存在差异。这是自然增长的必然结果，也导致了我们难以追踪的频繁宕机。计算团队的一项重要任务就是简化这些定制化n欸容，使我们的环境更加同质化。</p>\n<p>在过去两年里，我们投入了大量精力来打破原有模式，推动构建以可持续性为核心的基础设施。越来越多的组件正在实现标准化，并在不同环境间共享，而非到处采用定制配置。我们拥有更多可以进行可靠测试的预生产集群，而不是贸然投入生产环境。我们正在开发用于管理整个集群生命周期的工具，力求使所有集群尽可能保持一致，并可根据需要重新创建或复制。我们正朝着仅在绝对必要时才使用定制组件的方向发展，并努力在合理的情况下将这些定制组件打造为新的标准。尤为重要的是，我们在尽可能地对所有组件进行编码，以确保应用的一致性，并清晰地记录我们为实现当前目标所做的选择。对于无法编码的内容，我们也在详细记录，并评估如何用更好的替代方案来取代这些特殊情况。这是一条漫长而艰难的道路，但这是我们自己选择的路，这样才能为我们的工程师和用户提供更好的体验。</p>\n<h1 id=\"尾声\">尾声</h1>\n<p>感谢你读到这里，在此我们也想衷心感谢社区每位成员一直以来的关注和支持。没有你们，就不会有今天的 Reddit。正是有了大家，我们才能始终充满热情地持续建设这个平台——尽管过程中难免经历起伏（值得高兴的是，随着我们对网站可靠性的持续投入，宕机的情况正变得越来越少！）。</p>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-30 14:36</span>&nbsp;\n<a href=\"https://www.cnblogs.com/manuscript\">怎么还在写代码</a>&nbsp;\n阅读(<span id=\"post_view_count\">30</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "MWGA如何帮助7万行Winforms程序快速迁移到WEB前端",
      "link": "https://www.cnblogs.com/xdesigner/p/19553109",
      "published": "",
      "description": "<h2>\n\t\t\t<a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/xdesigner/p/19553109\" id=\"cb_post_title_url\" title=\"发布于 2026-01-30 13:58\">\n    <span>MWGA如何帮助7万行Winforms程序快速迁移到WEB前端</span>\n    \n\n</a>\n\n\t\t</h2>\n\t\t<div class=\"postText\">    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        <img alt=\"MWGA如何帮助7万行Winforms程序快速迁移到WEB前端\" class=\"desc_img\" src=\"https://img2024.cnblogs.com/blog/12406/202601/12406-20260130144632826-1346196419.png\" />\n        我们借助 MWGA 成功将一个约 7 万行 C# 代码的成熟商业 WinForms 程序迁移至 Web 前端，整个过程快速且代码改动量极小，验证了其在复杂项目迁移中的不可思议的迁移能力。本文将以该案例为基础，概述迁移的核心思路与显著成果。\n    </div>\n<div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<h1>1.前言</h1>\n<p><span>MWGA，是 Make Winforms Great Again 的缩写，是一个帮助 WinForms 程序快速迁移到 Blazor WASM 平台的高效工具软件。近期，我们借助 MWGA 成功将一个约 7 万行 C# 代码的成熟商业 WinForms 程序迁移至 Web 前端，整个过程快速且代码改动量极小，验证了其在复杂项目迁移中的不可思议的迁移能力。本文将以该案例为基础，概述迁移的核心思路与显著成果。</span></p>\n<p><span style=\"font-size: 18px;\">&nbsp;MWGA下载地址【https://github.com/dcsoft-yyf/MWGA】，时间轴功能演示地址【https://dcsoft-yyf.github.io/MWGA/dctimeline.html】</span></p>\n<h1>2.案例程序说明</h1>\n<p><span>本次迁移的对象是一款面向医院行业的商业软件——“时间轴”，主要用于患者体温单曲线图、跨机构居民健康档案数据可视化、手术室排程及住院患者数据分析。该软件功能复杂，紧密贴合医疗临床需求，具有以下特点：</span></p>\n<p><span><strong>（1）代码量大：</strong>总计约 7 万行 C# 代码，其中包含近 4 万行与文档排版和 GDI+ 绘图相关的核心逻辑。</span></p>\n<p><span><strong>（2）界面复杂：</strong>实现了可交互的时间轴、动态区域展开/收缩、超链接文本、多数据层叠加（如血压曲线、疼痛指数、用药记录）等高级可视化功能。</span></p>\n<p><span><strong>（3）市场验证：</strong>已在国内及台湾地区的多家医院稳定部署使用，是一个经过实践检验的成熟产品。</span></p>\n<p><span>这是用来展示跨医疗机构的居民健康档案数据的展示界面：</span></p>\n<p><img alt=\"图片1.1\" src=\"https://img2024.cnblogs.com/blog/12406/202601/12406-20260130143016981-191503376.png\" /></p>\n<p><span>这个界面很复杂，将门诊、社区医院、住院、手术等数据串联在一起，形成不同的时间区域，时间区域可以展开和收缩，里面还有超连接文本。用户可以点击左边的坐标尺来显示和隐藏线条，当体温值过高和过低时会有小箭头并伴随纵向文本。</span></p>\n<p><span>下图是医院内部手术室排程的界面，白色区域是已经开始的手术，灰色区域是计划中的手术，红色块表示发生意外的手术。</span></p>\n<p><span>&nbsp;<img alt=\"图片2.1\" src=\"https://img2024.cnblogs.com/blog/12406/202601/12406-20260130143206198-1969301511.png\" /></span></p>\n<p><span>这个软件产品还卖到台湾医院了，下图为台湾医院中的住院患者数据展示界面，这里的阴影区域，上边缘是血压的收缩压，下边缘是舒张压，还有一个红色折线表示疼痛指数，上面的表格显示了住院时间，下面的表格显示了用药情况，可以明确展示出用药和血压及疼痛指数之间时间上的先后关系。</span></p>\n<p><span>&nbsp;<img alt=\"图片3.1\" src=\"https://img2024.cnblogs.com/blog/12406/202601/12406-20260130143432992-255326497.png\" /></span></p>\n<p><span>这个软件紧密贴合医院临床需求，功能强大，是一个经过市场考验的软件产品。</span></p>\n<p>&nbsp;</p>\n<h1>3.迁移过程与成果</h1>\n<p><span>借助 MWGA，我们以极低的成本完成了这个庞大项目的 Web 化迁移。整个过程遵循高度标准化的流程，核心环节如下：</span></p>\n<h2>第一，创建项目</h2>\n<p><span>使用VS.NET2022创建一个Blazor WASM9.0的项目。并将原有 WinForms 项目的全部源代码与资源文件复制其中，包括C#代码文件、Form.Designer.cs、Form.resx文件。</span></p>\n<h2>第二，引用MWGA程序集</h2>\n<p><span>仅需引用一个独立的 DCSoft.MWGA.dll 程序集（约 4MB），即可获得完整的 WinForms 到 WebAssembly 的运行时支持。最新的MWGA程序文件下载地址为</span></p>\n<p><span>【https://github.com/dcsoft-yyf/MWGA】。</span></p>\n<h2>第三，配置应用入口</h2>\n<p><span>通过MWGA提供的标准化引导模式，在Blazor应用中快速建立WinForms应用的运行环境。只需在HTML页面中添加一个指定的容器元素并进行简单配置，即可将WinForms主窗体启动并渲染于该容器内。</span></p>\n<h2>第四，适配性调整C#代码</h2>\n<p><span>针对 Web 环境与桌面环境的差异（WEB前端编程相对于WinForms编程最大的差异就是异步编程模式），我们对少量代码进行了适配性修改，主要集中在异步化改造方面（例如文件对话框的调用），以确保在浏览器中的流畅交互。绝大部分业务逻辑、界面布局和 GDI+ 绘图代码均无需改动。</span></p>\n<p><span>案例程序中的其他代码不需要动，比如几万行的文档排版和绘图代码就不需要修改，例如：</span></p>\n<div class=\"cnblogs_code\">\n<pre><span><span style=\"color: rgba(0, 0, 255, 1);\">if</span> (text == <span style=\"color: rgba(0, 0, 255, 1);\">null</span><span style=\"color: rgba(0, 0, 0, 1);\">)\n{\n    </span><span style=\"color: rgba(0, 128, 0, 1);\">//</span><span style=\"color: rgba(0, 128, 0, 1);\"> 否则只显示日数</span>\n    text = dtm.Day.ToString(<span style=\"color: rgba(0, 0, 255, 1);\">this</span><span style=\"color: rgba(0, 0, 0, 1);\">.Config.DateFormatString);\n}\nfullWidth </span>= g.MeasureString(text, txtFont, <span style=\"color: rgba(128, 0, 128, 1);\">10000</span><span style=\"color: rgba(0, 0, 0, 1);\">, centerFormat).Width;\n</span><span style=\"color: rgba(0, 0, 255, 1);\">if</span> (rect2.Width &lt;<span style=\"color: rgba(0, 0, 0, 1);\"> fullWidth)\n{\n    rect2.X </span>= rect2.X - (fullWidth - rect2.Width) / <span style=\"color: rgba(128, 0, 128, 1);\">2</span><span style=\"color: rgba(0, 0, 0, 1);\">;\n    rect2.Width </span>=<span style=\"color: rgba(0, 0, 0, 1);\"> fullWidth;\n}\n</span><span style=\"color: rgba(128, 128, 128, 1);\">////////////////////////////////////////////////////////////////////////\n</span><span style=\"color: rgba(0, 0, 255, 1);\">if</span><span style=\"color: rgba(0, 0, 0, 1);\"> (clipRectangle.IntersectsWith(rect2))\n{\n    Color tc </span>= line == <span style=\"color: rgba(0, 0, 255, 1);\">null</span> ? <span style=\"color: rgba(0, 0, 255, 1);\">this</span><span style=\"color: rgba(0, 0, 0, 1);\">.Config.ForeColor : line.TextColor;\n    tc </span>= line != <span style=\"color: rgba(0, 0, 255, 1);\">null</span> &amp;&amp; line.BlankDateWhenNoData == <span style=\"color: rgba(0, 0, 255, 1);\">true</span> &amp;&amp; <span style=\"color: rgba(0, 0, 255, 1);\">this</span>._NoDataInDocument == <span style=\"color: rgba(0, 0, 255, 1);\">true</span> ?<span style=\"color: rgba(0, 0, 0, 1);\"> Color.Transparent : tc;\n    g.DrawString(\n        text,\n        txtFont,\n        GetRuntimeForeColor(tc),\n        rect2,\n        centerFormat);\n}</span></span></pre>\n</div>\n<h2>第五，处理资源文件</h2>\n<p><span>借助MWGA提供的资源管理兼容方案，原有的.resx文件及其在Designer.cs中的初始化代码可被自动识别和处理，无需手动修改。</span></p>\n<p><span>例如WinForms程序会使用Forms.resx文件来存储窗体中使用到的资源，包括字符串或者图片。只需要添加几行代码，就借助MWGA实现了无缝资源迁移。</span></p>\n<h2>第六，测试与成果展示</h2>\n<p><span>完成上述步骤后，项目可直接编译为 Blazor WASM 应用。我们在多个平台和浏览器中进行了测试，均获得一致且良好的运行效果。</span></p>\n<p><span>经过迁移，这款 7 万行代码的 WinForms 应用成功转变为可通过浏览器直接访问的 Web 应用，并在不同环境下展现了出色的兼容性：</span></p>\n<p><span>在谷歌浏览器中运行界面如下所示：</span></p>\n<p><span>&nbsp;<img alt=\"图片4.1\" src=\"https://img2024.cnblogs.com/blog/12406/202601/12406-20260130143718943-197134343.png\" /></span></p>\n<p><span>在FireFox中运行的效果：</span></p>\n<p><span>&nbsp;<img alt=\"5.1\" src=\"https://img2024.cnblogs.com/blog/12406/202601/12406-20260130143927409-1236436650.png\" /></span></p>\n<p><span>在iPad中的运行效果如下：</span></p>\n<p><span><img alt=\"pad运行界面\" src=\"https://img2024.cnblogs.com/blog/12406/202601/12406-20260130134547503-1283099790.png\" /></span></p>\n<p>&nbsp;</p>\n<p><span>在安卓平板中的运行效果如下：</span></p>\n<div style=\"text-align: left;\"><span><span>&nbsp;<img alt=\"安卓运行界面\" src=\"https://img2024.cnblogs.com/blog/12406/202601/12406-20260130134603834-759222409.png\" /></span></span></div>\n<div style=\"text-align: left;\"><span>该软件在统信操作系统中的运行效果如下：</span></div>\n<div style=\"text-align: left;\"><span><span>&nbsp;<img alt=\"统信界面\" src=\"https://img2024.cnblogs.com/blog/12406/202601/12406-20260130144431614-984185403.png\" /></span></span></div>\n<p><span>迁移后的 Web 应用完整保留了原桌面版的所有交互逻辑和界面效果，包括复杂的 GDI+ 绘图、鼠标拖拽、点击响应等行为，用户体验与原生版本高度一致。</span></p>\n<p><span>公开演示地址：为方便体验，我们提供了该案例的在线演示，大家可通过以下链接访问：【https://dcsoft-yyf.github.io/MWGA/dctimeline.html】</span></p>\n<p>&nbsp;</p>\n<h1>4.结论与价值</h1>\n<p><span>本次迁移工作验证了以下结论：</span></p>\n<p><span><strong>1、修改量极低：</strong>面对 7 万行代码，仅对不足 1% 的代码进行了必要的适配性调整，核心业务逻辑与绘图代码得以完全复用。相较于重写或采用其他迁移方案，基于MWGA的改造成本几乎可以忽略不计。</span></p>\n<p><span><strong>2、功能完整迁移：</strong>复杂的用户界面和交互行为被高保真还原至Web前端。</span></p>\n<p><span><strong>3、真正的跨平台：</strong>生成的应用可无缝运行于 Windows、Linux、Android、iOS 及统信 UOS、麒麟等国产操作系统的现代浏览器中。</span></p>\n<p><span><strong>4、双线发展：</strong>借助MWGA和条件编译等技术手段，可以让同一份C#代码同时编译成 .exe 和 .wasm文件，让开发组织用较低的成本同时维护一个软件的Windows桌面版和WEB前端版。让软件产品适应更多的应用场景，为客户系统的平滑升级争取更多的时间。</span></p>\n<p><span><strong>5、信创适配：</strong>对于中国的开发者，MWGA能将基于MS Windows的WinForms程序快速迁移到跨平台的WEB前端，大量软件产品有望躲过信创的斩杀线。</span></p>\n<p>&nbsp;</p>\n<p><span>当然WinForms程序不仅仅是UI控件和GDI+，还有很多其他的操作，比如连接数据库、访问本地文件、连接硬件设备等等，而MWGA运行在WEB浏览器沙盒中，没有能力完整的复现WinForms的全部功能集。但是MWGA的设计目标也不是解决所有的问题，单单是解决UI和GDI+的功能迁移问题就足以创造巨大的价值。</span></p>\n<p><span>MWGA可以说创造了一个WEB前端框架，但是采用了WinForms编程模型。这是一种跨界融合，使得WinForms开发者无需更换技术栈即可参与WEB前端开发。同时，C#的强类型特性与GDI+严谨的编程模型也有助于减少AI编程产生的隐形BUG。</span></p>\n<p><span>全球数百万开发者过去20年在WinForms技术栈上投资巨大，可能过千亿美元，在云原生成为主流的今天，这些资产常被视为“沉没成本”，让成千上万的企业CTO倍感纠结。而MWGA有望盘活这些“沉没资产”，它率先探索出一条全新的技术路径，随着该路径的不断成熟，有望为全球WinForms技术栈延寿数年，可能会对全球的企业级软件研发领域带来不小的震荡。</span></p>\n<p><span>【MWGA是南京都昌信息科技有限公司完全自主独立研发的软件产品，具有所有版权。】</span></p>\n\n</div>\n<div class=\"clear\"></div>\n</div>\n\t\t<p class=\"postfoot\">\n\t\t\tposted on \n<span id=\"post-date\">2026-01-30 13:58</span>&nbsp;\n<a href=\"https://www.cnblogs.com/xdesigner\">袁永福 电子病历，医疗信息化</a>&nbsp;\n阅读(<span id=\"post_view_count\">40</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n\n\t\t</p>"
    }
  ]
}