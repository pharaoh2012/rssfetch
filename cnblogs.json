{
  "title": "ä¸»é¡µ - åšå®¢å›­",
  "link": "https://www.cnblogs.com/",
  "description": "ä¸»é¡µ - åšå®¢å›­ RSS",
  "entries": [
    {
      "title": "SpringCloud  å¾®æœåŠ¡å®ç°ä¸€åˆ™ (Eureka + Hystrix)",
      "link": "https://www.cnblogs.com/dddy/p/19613850",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/dddy/p/19613850\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-13 23:42\">\n    <span>SpringCloud  å¾®æœåŠ¡å®ç°ä¸€åˆ™ (Eureka + Hystrix)</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>2018-1-29</p>\n<h1 id=\"spring\">Spring</h1>\n<p>[[N_SpringBoot]]</p>\n<hr />\n<h1 id=\"å¾®æœåŠ¡æ¶æ„\">å¾®æœåŠ¡æ¶æ„</h1>\n<h2 id=\"ä»€ä¹ˆæ˜¯å¾®æœåŠ¡\">ä»€ä¹ˆæ˜¯å¾®æœåŠ¡?</h2>\n<p>ä¾‹å¦‚ä¸€ä¸ªå•†åŸç³»ç»Ÿ, æœ‰ ç”¨æˆ·æ¨¡å—, äº§å“æ¨¡å—, è®¢å•æ¨¡å—, æ”¯ä»˜æ¨¡å—, åœ¨ä¼ ç»Ÿçš„MVCç»“æ„ä¸­,<br />\nè¿™äº›éƒ½é›†ä¸­åœ¨ä¸€ä¸ªå¾ˆé‡çš„JVMè¿›ç¨‹ä¸­.</p>\n<p>è¿™æœ‰å‡ ä¸ªé—®é¢˜:</p>\n<ul>\n<li>é¡¹ç›®è¿‡äºè‡ƒè‚¿å½“å¤§å¤§å°å°çš„åŠŸèƒ½æ¨¡å—éƒ½é›†ä¸­åœ¨åŒä¸€é¡¹ç›®çš„æ—¶å€™, æ•´ä¸ªé¡¹ç›®å¿…ç„¶ä¼šå˜å¾—è‡ƒè‚¿, è®©å¼€å‘è€…éš¾ä»¥ç»´æŠ¤</li>\n<li>èµ„æºæ— æ³•éš”ç¦», æ•´ä¸ªå•ä½“ç³»ç»Ÿçš„å„ä¸ªåŠŸèƒ½æ¨¡å—éƒ½ä¾èµ–äºåŒæ ·çš„æ•°æ®åº“, å†…å­˜ç­‰èµ„æº, ä¸€æ—¦æŸä¸ªåŠŸèƒ½æ¨¡å—å¯¹èµ„æºä½¿ç”¨ä¸å½“, æ•´ä¸ªç³»ç»Ÿéƒ½ä¼šè¢«æ‹–å®</li>\n</ul>\n<p><strong>è§£å†³çš„é—®é¢˜</strong></p>\n<p>ç®€è€Œè¨€ä¹‹,å¾®æœåŠ¡æ¶æ„é£æ ¼æ˜¯ä¸€ç§å°†å•ä¸ªåº”ç”¨ç¨‹åºä½œä¸ºä¸€å¥—å°å‹æœåŠ¡å¼€å‘çš„æ–¹æ³•, æ¯ç§åº”ç”¨ç¨‹åºéƒ½åœ¨è‡ªå·±çš„è¿›ç¨‹ä¸­è¿è¡Œ, å¹¶ä¸è½»é‡çº§æœºåˆ¶(<strong>é€šå¸¸æ˜¯HTTPèµ„æºAPI</strong>)è¿›è¡Œé€šä¿¡;<br />\nè¿™äº›æœåŠ¡æ˜¯å›´ç»•ä¸šåŠ¡åŠŸèƒ½æ„å»ºçš„, å¯ä»¥é€šè¿‡å…¨è‡ªåŠ¨éƒ¨ç½²æœºåˆ¶ç‹¬ç«‹éƒ¨ç½²;  è¿™äº›æœåŠ¡çš„é›†ä¸­ç®¡ç†æœ€å°‘,<strong>å¯ä»¥ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ç¼–å†™</strong>, å¹¶ä½¿ç”¨ä¸åŒçš„æ•°æ®å­˜å‚¨æŠ€æœ¯;</p>\n<p>æœ¬ä¾‹å¦‚: æŠŠå•†å“æ¨¡å—, è®¢å•æ¨¡å—ç‹¬ç«‹åˆ†ä¸ºä¸€ä¸ªæœåŠ¡,å‚ç›´æ‹†åˆ†,å®ƒä»¬ç›´æ¥ä½¿ç”¨APIé€šè®¯, è¿™æ ·å³æ—¶è®¢å•ç³»ç»Ÿå‡ºé”™, åªæ˜¯ä¸èƒ½ä¸‹è®¢å•ä¸å½±å“å•†å“æœåŠ¡</p>\n<p><img alt=\"983980-20170501194607023-1194438149\" class=\"lazyload\" /></p>\n<p><strong>ç‰¹å¾</strong><br />\nå®˜æ–¹çš„å®šä¹‰:</p>\n<ol>\n<li>ä¸€äº›åˆ—çš„ç‹¬ç«‹çš„æœåŠ¡å…±åŒç»„æˆç³»ç»Ÿ</li>\n<li>å•ç‹¬éƒ¨ç½², è·‘åœ¨è‡ªå·±çš„è¿›ç¨‹ä¸­</li>\n<li>æ¯ä¸ªæœåŠ¡ä¸ºç‹¬ç«‹çš„ä¸šåŠ¡å¼€å‘</li>\n<li>åˆ†å¸ƒå¼ç®¡ç†</li>\n<li>éå¸¸å¼ºè°ƒéš”ç¦»æ€§</li>\n</ol>\n<p>å¤§æ¦‚çš„æ ‡å‡†:</p>\n<ol>\n<li>åˆ†å¸ƒå¼æœåŠ¡ç»„æˆçš„ç³»ç»Ÿ</li>\n<li>æŒ‰ç…§ä¸šåŠ¡, è€Œä¸æ˜¯æŠ€æœ¯æ¥åˆ’åˆ†ç»„ç»‡</li>\n<li>åšæœ‰ç”Ÿå‘½çš„äº§å“è€Œä¸æ˜¯é¡¹ç›®</li>\n<li>å¼ºæœåŠ¡ä¸ªä½“å’Œå¼±é€šä¿¡ï¼ˆ Smart endpoints and dumb pipes ï¼‰</li>\n<li>è‡ªåŠ¨åŒ–è¿ç»´ï¼ˆ DevOps ï¼‰</li>\n<li>é«˜åº¦å®¹é”™æ€§</li>\n<li>å¿«é€Ÿæ¼”åŒ–å’Œè¿­ä»£</li>\n</ol>\n<blockquote>\n<p><strong>å¾®æœåŠ¡æ¶æ„æ˜¯ä¸€ä¸ªè½¯ä»¶æ¶æ„ æŠŠä¸€ä¸ªå•ä½“åº”ç”¨, æŒ‰ç…§ &lt;ä¸šåŠ¡è¾¹ç•Œ&gt; è¿›è¡Œå‚ç›´æ‹†åˆ†ä¸ºæ¯ä¸ªç‹¬ç«‹çš„æœåŠ¡åº”ç”¨</strong></p>\n</blockquote>\n<blockquote>\n<p><a href=\"https://www.cnblogs.com/imyalost/p/6792724.html\" target=\"_blank\">å¾®æœåŠ¡æ¶æ„</a></p>\n</blockquote>\n<hr />\n<h2 id=\"å®ç°å¼•ç”³çš„é—®é¢˜ä¸è§’è‰²\">å®ç°å¼•ç”³çš„é—®é¢˜ä¸è§’è‰²</h2>\n<p>å¾®æœåŠ¡æ¶æ„éœ€è¦çš„åŠŸèƒ½æˆ–ä½¿ç”¨åœºæ™¯</p>\n<ol>\n<li>\n<p>æˆ‘ä»¬æŠŠæ•´ä¸ªç³»ç»Ÿæ ¹æ®ä¸šåŠ¡æ‹†åˆ†æˆå‡ ä¸ªå­ç³»ç»Ÿ(<strong>å¾®æœåŠ¡</strong>);</p>\n</li>\n<li>\n<p>æ¯ä¸ªå­ç³»ç»Ÿå¯ä»¥éƒ¨ç½²å¤šä¸ªåº”ç”¨, <code>å¤šä¸ªåº”ç”¨ä¹‹é—´ä½¿ç”¨è´Ÿè½½å‡è¡¡</code>;</p>\n</li>\n<li>\n<p>éœ€è¦ä¸€ä¸ªæœåŠ¡<strong>æ³¨å†Œä¸­å¿ƒ</strong>, æ‰€æœ‰çš„æœåŠ¡éƒ½åœ¨æ³¨å†Œä¸­å¿ƒæ³¨å†Œ, è´Ÿè½½å‡è¡¡ä¹Ÿæ˜¯é€šè¿‡åœ¨æ³¨å†Œä¸­å¿ƒæ³¨å†Œçš„æœåŠ¡æ¥ä½¿ç”¨ä¸€å®šç­–ç•¥æ¥å®ç°;</p>\n</li>\n<li>\n<p>æ‰€æœ‰çš„å®¢æˆ·ç«¯éƒ½é€šè¿‡åŒä¸€ä¸ªç½‘å…³åœ°å€è®¿é—®åå°çš„æœåŠ¡, é€šè¿‡<strong>è·¯ç”±é…ç½®</strong>, ç½‘å…³æ¥åˆ¤æ–­ä¸€ä¸ªURLè¯·æ±‚ç”±å“ªä¸ªæœåŠ¡å¤„ç†; è¯·æ±‚è½¬å‘åˆ°æœåŠ¡ä¸Šçš„æ—¶å€™ä¹Ÿä½¿ç”¨<strong>è´Ÿè½½å‡è¡¡</strong>;</p>\n</li>\n<li>\n<p>æœåŠ¡ä¹‹é—´æœ‰æ—¶å€™ä¹Ÿéœ€è¦ç›¸äº’è®¿é—®; ä¾‹å¦‚æœ‰ä¸€ä¸ªç”¨æˆ·æ¨¡å—, å…¶ä»–æœåŠ¡åœ¨å¤„ç†ä¸€äº›ä¸šåŠ¡çš„æ—¶å€™, è¦è·å–ç”¨æˆ·æœåŠ¡çš„ç”¨æˆ·æ•°æ®;</p>\n</li>\n<li>\n<p>éœ€è¦ä¸€ä¸ª<strong>æ–­è·¯å™¨</strong>, åŠæ—¶å¤„ç†æœåŠ¡è°ƒç”¨æ—¶çš„è¶…æ—¶å’Œé”™è¯¯, é˜²æ­¢ç”±äºå…¶ä¸­ä¸€ä¸ªæœåŠ¡çš„é—®é¢˜è€Œå¯¼è‡´æ•´ä½“ç³»ç»Ÿçš„ç˜«ç—ª;</p>\n</li>\n<li>\n<p>è¿˜éœ€è¦ä¸€ä¸ª<strong>ç›‘æ§</strong>åŠŸèƒ½, ç›‘æ§æ¯ä¸ªæœåŠ¡è°ƒç”¨èŠ±è´¹çš„æ—¶é—´ç­‰;</p>\n</li>\n</ol>\n<br />\n<hr />\n<h2 id=\"ä¸€ä¸ªzookeeper-å’Œ-eureka-æ¯”è¾ƒ\">ä¸€ä¸ªZooKeeper å’Œ Eureka æ¯”è¾ƒ</h2>\n<p><code>ZooKeeper</code>æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„, å¼€æ”¾æºç çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºåè°ƒæœåŠ¡, æ˜¯Googleçš„Chubbyä¸€ä¸ªå¼€æºçš„å®ç°, æ˜¯Hadoopå’ŒHbaseçš„é‡è¦ç»„ä»¶; å®ƒæ˜¯ä¸€ä¸ªä¸ºåˆ†å¸ƒå¼åº”ç”¨æä¾›ä¸€è‡´æ€§æœåŠ¡çš„è½¯ä»¶, æä¾›çš„åŠŸèƒ½åŒ…æ‹¬: é…ç½®ç»´æŠ¤, åŸŸåæœåŠ¡, åˆ†å¸ƒå¼åŒæ­¥, ç»„æœåŠ¡ç­‰;</p>\n<p><code>Eureka</code>æ˜¯Netflixå¼€å‘çš„æœåŠ¡å‘ç°æ¡†æ¶, æœ¬èº«æ˜¯ä¸€ä¸ªåŸºäºRESTçš„æœåŠ¡, ä¸»è¦ç”¨äºå®šä½è¿è¡Œåœ¨AWSåŸŸä¸­çš„ä¸­é—´å±‚æœåŠ¡, ä»¥è¾¾åˆ°è´Ÿè½½å‡è¡¡å’Œä¸­é—´å±‚æœåŠ¡æ•…éšœè½¬ç§»çš„ç›®çš„; SpringCloudå°†å®ƒé›†æˆåœ¨å…¶å­é¡¹ç›®spring-cloud-netflixä¸­, ä»¥å®ç°SpringCloudçš„æœåŠ¡å‘ç°åŠŸèƒ½;</p>\n<p>ZooKeeper å’Œ Eureka æ¡†æ¶éƒ½åœ¨SpringCloudä¸­é›†æˆå®ƒä»¬ä½œä¸º<code>æ³¨å†Œä¸­å¿ƒ</code>, å®ƒä»¬ä¸»è¦ä¾§é‡ç‚¹ä¸åŒ</p>\n<ul>\n<li>Zoopkeeperä¿è¯CP:<br />\nå½“å‘æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢æœåŠ¡åˆ—è¡¨æ—¶, æˆ‘ä»¬å¯ä»¥å®¹å¿æ³¨å†Œä¸­å¿ƒè¿”å›çš„æ˜¯å‡ åˆ†é’Ÿä»¥å‰çš„æ³¨å†Œä¿¡æ¯, ä½†æ˜¯ä¸èƒ½æ¥å—æœåŠ¡ç›´æ¥downæ‰ä¸å¯ç”¨; ä¹Ÿå°±æ˜¯è¯´, æœåŠ¡æ³¨å†ŒåŠŸèƒ½å¯¹å¯ç”¨æ€§çš„è¦æ±‚è¦é«˜äºä¸€è‡´æ€§; ä½†æ˜¯zkä¼šå‡ºç°è¿™æ ·çš„ä¸€ç§æƒ…å†µ, å½“masterèŠ‚ç‚¹å› ç½‘è·¯æ•…éšœä¸å…¶ä»–èŠ‚ç‚¹å¤±å»è”ç³»æ—¶, å‰©ä½™çš„èŠ‚ç‚¹ä¼šé‡æ–°è¿›è¡Œleaderé€‰ä¸¾; é—®é¢˜åœ¨äº, é€‰ä¸¾leaderçš„æ—¶é—´å¤ªé•¿, 30~120s, ä¸”é€‰ä¸¾æœŸé—´æ•´ä¸ªzké›†ç¾¤æ˜¯éƒ½æ˜¯ä¸å¯ç”¨çš„, è¿™å°±å¯¼è‡´åœ¨é€‰ä¸¾æœŸé—´æ³¨å†ŒæœåŠ¡ç˜«ç—ª, åœ¨äº‘éƒ¨ç½²çš„ç¯å¢ƒä¸‹, å› ç½‘ç»œé—®é¢˜ä½¿å¾—zké›†ç¾¤å¤±å»masterèŠ‚ç‚¹æ˜¯è¾ƒå¤§æ¦‚ç‡ä¼šå‘ç”Ÿçš„äº‹, è™½ç„¶æœåŠ¡èƒ½å¤Ÿæœ€ç»ˆæ¢å¤, ä½†æ˜¯æ¼«é•¿çš„é€‰ä¸¾æ—¶é—´å¯¼è‡´çš„æ³¨å†Œé•¿æœŸä¸å¯ç”¨æ˜¯ä¸èƒ½å®¹å¿çš„;</li>\n</ul>\n<blockquote>\n<p>ZooKeeperæ˜¯ä»¥Fast Paxosç®—æ³•ä¸ºåŸºç¡€ä¿æŒä¸€è‡´æ€§, è¿™ä¸ªç®—æ³•å¯èƒ½ä¼šäº§ç”Ÿé—®é¢˜æ˜¯éœ€è¦ä¸€ä¸ªLeaderæ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§. æ‰€ä»¥å®ƒå¿…é¡»æœ‰ä¸€ä¸ªLeaderèŠ‚ç‚¹.</p>\n</blockquote>\n<ul>\n<li>Eurekaä¿è¯AP:<br />\nEurekaçœ‹æ˜ç™½äº†è¿™ä¸€ç‚¹, å› æ­¤åœ¨è®¾è®¡æ—¶å°±ä¼˜å…ˆä¿è¯å¯ç”¨æ€§; Eurekaå„ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¹³ç­‰çš„, å‡ ä¸ªèŠ‚ç‚¹æŒ‚æ‰ä¸å½±å“æ­£å¸¸èŠ‚ç‚¹çš„å·¥ä½œ, å‰©ä½™çš„èŠ‚ç‚¹ä¾ç„¶å¯ä»¥æä¾›æ³¨å†Œå’ŒæŸ¥è¯¢æœåŠ¡; è€ŒEurekaçš„å®¢æˆ·ç«¯åœ¨å‘æŸä¸ªEurekaæ³¨å†Œæ—¶å¦‚æœå‘ç°è¿æ¥å¤±è´¥, åˆ™ä¼šè‡ªåŠ¨åˆ‡æ¢è‡³å…¶ä»–çš„èŠ‚ç‚¹, åªè¦æœ‰ä¸€å°Eurekaè¿˜åœ¨, å°±èƒ½ä¿è¯æ³¨å†ŒæœåŠ¡å¯ç”¨ï¼ˆä¿è¯å¯ç”¨æ€§ï¼‰, åªä¸è¿‡æŸ¥åˆ°çš„ä¿¡æ¯å¯èƒ½ä¸æ˜¯æœ€æ–°çš„ï¼ˆä¸ä¿è¯ä¸€è‡´æ€§ï¼‰;</li>\n</ul>\n<br />\n<hr />\n<h1 id=\"spring-cloud-å¾®æœåŠ¡çš„å®ç°\">Spring Cloud å¾®æœåŠ¡çš„å®ç°</h1>\n<p><strong>é¡ºä¾¿è§£å†³: å®ç°å¼•ç”³çš„é—®é¢˜ä¸è§’è‰²</strong></p>\n<p>Spring Cloud æ˜¯ä¸€ç³»åˆ—æ¡†æ¶çš„æœ‰åºé›†åˆ, å®ƒåˆ©ç”¨ Spring Boot çš„å¼€å‘ä¾¿åˆ©æ€§ç®€åŒ–äº†åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼€å‘,<br />\næ¯”å¦‚æœåŠ¡å‘ç°, æœåŠ¡ç½‘å…³, æœåŠ¡è·¯ç”±, é“¾è·¯è¿½è¸ªç­‰; Spring Cloud å¹¶ä¸é‡å¤é€ è½®å­, è€Œæ˜¯å°†å¸‚é¢ä¸Šå¼€å‘å¾—æ¯”è¾ƒå¥½çš„æ¨¡å—é›†æˆè¿›å»,<br />\nè¿›è¡Œå°è£…, ä»è€Œå‡å°‘äº†å„æ¨¡å—çš„å¼€å‘æˆæœ¬; æ¢å¥è¯è¯´: Spring Cloud æä¾›äº†æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿæ‰€éœ€çš„\"å…¨å®¶æ¡¶\";</p>\n<p>åŸºç¡€å‡†å¤‡</p>\n<blockquote>\n<p>é¦–å…ˆçš„é¦–å…ˆéœ€è¦ä¸€ä¸ªMavené¡¹ç›®, ä½œä¸ºçˆ¶æ¨¡å—. ä»¥ä¾¿ç®¡ç†</p>\n</blockquote>\n<p>è¯¥çˆ¶é¡¹ç›®çš„ pom.xmlçš„å®Œæ•´é…ç½®</p>\n<pre><code class=\"language-xml\">&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\txsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n\t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n\t&lt;groupId&gt;yang&lt;/groupId&gt;\n\t&lt;artifactId&gt;spring_cloud_parent&lt;/artifactId&gt;\n\t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n\t&lt;packaging&gt;pom&lt;/packaging&gt;\n\n\t&lt;name&gt;spring cloud parent dome&lt;/name&gt;\n\n\t&lt;properties&gt;\n  \t\t&lt;spring-cloud.version&gt;Finchley.RELEASE&lt;/spring-cloud.version&gt;\n\t\t&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n\t&lt;/properties&gt;\n\n\t&lt;parent&gt;\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n\t\t&lt;version&gt;2.0.5.RELEASE&lt;/version&gt;\n\t\t   &lt;relativePath/&gt;\n\t&lt;/parent&gt;\n\n\t&lt;dependencies&gt;\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;junit&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;junit&lt;/artifactId&gt;\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\n\t\t&lt;/dependency&gt;\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\n\t\t&lt;/dependency&gt;\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\n\t\t\t&lt;optional&gt;true&lt;/optional&gt;\n\t\t&lt;/dependency&gt;\n\t\t\n\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n\t\t&lt;/dependency&gt;\n\t&lt;/dependencies&gt;\n\n    &lt;dependencyManagement&gt;\n        &lt;dependencies&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;\n                &lt;version&gt;${spring-cloud.version}&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n        &lt;/dependencies&gt;\n    &lt;/dependencyManagement&gt;\n\n&lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n\n</code></pre>\n<p><a href=\"spring_cloud_parent.rar\" rel=\"noopener nofollow\" target=\"_blank\">æ‰“åŒ…</a></p>\n<br />\n<hr />\n<h2 id=\"1-æ³¨å†Œä¸­å¿ƒå®ç°åŸºäºeureka\">1. æ³¨å†Œä¸­å¿ƒå®ç°(åŸºäºEureka)</h2>\n<p><strong>è¿™é‡Œä¾¿è§£å†³å¼•ç”³å‡ºæ¥çš„ç¬¬ä¸‰ä¸ªé—®é¢˜,æ‰€æœ‰çš„æœåŠ¡éƒ½å¯ä»¥åœ¨æ³¨å†Œä¸­å¿ƒæ‰¾åˆ°</strong></p>\n<p>eurekaæ˜¯ä¸€ä¸ªé«˜å¯ç”¨çš„ç»„ä»¶, å®ƒæ²¡æœ‰åç«¯ç¼“å­˜, æ¯ä¸€ä¸ªå®ä¾‹æ³¨å†Œä¹‹åéœ€è¦å‘æ³¨å†Œä¸­å¿ƒå‘é€å¿ƒè·³ï¼ˆå› æ­¤å¯ä»¥åœ¨å†…å­˜ä¸­å®Œæˆï¼‰,<br />\nåœ¨é»˜è®¤æƒ…å†µä¸‹erureka serverä¹Ÿæ˜¯ä¸€ä¸ªeureka client ,å¿…é¡»è¦æŒ‡å®šä¸€ä¸ª server;<br />\nè§ä¸‹:application.yml<br />\né€šè¿‡eureka.client.registerWithEureka: falseå’ŒfetchRegistry: falseæ¥è¡¨æ˜è‡ªå·±æ˜¯ä¸€ä¸ªeureka server.</p>\n<h3 id=\"eureka_server\">eureka_server</h3>\n<p>åœ¨è¿™é‡Œ, é‡‡ç”¨Eurekaä½œä¸ºæœåŠ¡æ³¨å†Œä¸å‘ç°çš„ç»„ä»¶,<br />\nåœ¨spring cloud parent domeåŸºç¡€ä¸‹åˆ›å»ºä¸€ä¸ªmavenå­æ¨¡å—å·¥ç¨‹ä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒ, å³ <code>eureka_server</code><br />\nå®ƒä¾èµ–<code>spring-cloud-starter-netflix-eureka-server</code> è¿™ä¸ª<code>starter</code> æ³¨æ„groupIdæ˜¯ org.springframework.cloud</p>\n<pre><code class=\"language-xml\"> &lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n</code></pre>\n<h4 id=\"domeä»£ç \">domeä»£ç </h4>\n<p><code>@EnableEurekaServer</code>è¡¨é¢å®ƒæ˜¯ä¸€ä¸ª EurekaServer</p>\n<pre><code class=\"language-java\">@SpringBootApplication\n@EnableEurekaServer\npublic class Application {\n\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(Application.class).web(true).run(args);\n    }\n\n}\n</code></pre>\n<h4 id=\"applicationyml\">application.yml</h4>\n<pre><code class=\"language-yml\">server:\n  port: 8761\neureka:\n  instance:\n    hostname: 127.0.0.1\n  client:\n    registerWithEureka: false  æ˜¯å¦å°†è‡ªå·±æ³¨å†Œåˆ°Eureka Server, é»˜è®¤ä¸ºtrue; ç”±äºå½“å‰åº”ç”¨å°±æ˜¯Eureka Server, æ•…è€Œè®¾ä¸ºfalse\n    fetchRegistry: false  è¡¨ç¤ºæ˜¯å¦ä»Eureka Severè·å–æ³¨å†Œä¿¡æ¯, é»˜è®¤ä¸ºtrue; å› ä¸ºè¿™æ˜¯ä¸€ä¸ªå•èŠ‚ç‚¹çš„Eureka Server, ä¸éœ€è¦åŒæ­¥å…¶ä»–çš„Eureka ServerèŠ‚ç‚¹çš„æ•°æ®, æ•…è€Œè®¾ä¸ºfalse\n    serviceUrl:\n      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/\n</code></pre>\n<h4 id=\"æµ‹è¯•\">æµ‹è¯•</h4>\n<p>å¯åŠ¨Spring Booté¡¹ç›®, è®¿é—®: <a href=\"http://127.0.0.1:8761\" rel=\"noopener nofollow\" target=\"_blank\">http://127.0.0.1:8761</a></p>\n<p>Instances currently registered with Eureka å¯çœ‹åˆ°æ³¨å†Œçš„æœåŠ¡</p>\n<p>å‚è€ƒå®˜æ–¹æ–‡æ¡£: <a href=\"https://cloud.spring.io/spring-cloud-static/Finchley.SR2/multi/multi_spring-cloud-eureka-server.html\" rel=\"noopener nofollow\" target=\"_blank\">https://cloud.spring.io/spring-cloud-static/Finchley.SR2/multi/multi_spring-cloud-eureka-server.html</a></p>\n<br />\n<hr />\n<h2 id=\"2-æœåŠ¡æä¾›è€…åŸºäºeureka\">2. æœåŠ¡æä¾›è€…(åŸºäºEureka)</h2>\n<p><strong>è¿™é‡Œä¾¿ è§£å†³å¼•ç”³å‡ºæ¥çš„ç¬¬ä¸€ä¸ªé—®é¢˜, æœåŠ¡, è¿™é‡Œçš„eureka_clientå¯æœ‰å¤šä¸ªä¸æ–­çš„æ‰©å±•æœåŠ¡</strong><br />\nå½“clientå‘serveræ³¨å†Œæ—¶, å®ƒä¼šæä¾›ä¸€äº›å…ƒæ•°æ®, ä¾‹å¦‚ä¸»æœºå’Œç«¯å£, URL, ä¸»é¡µç­‰; Eureka server ä»æ¯ä¸ªclientå®ä¾‹æ¥æ”¶å¿ƒè·³æ¶ˆæ¯;<br />\nå¦‚æœå¿ƒè·³è¶…æ—¶, åˆ™é€šå¸¸å°†è¯¥å®ä¾‹ä»æ³¨å†Œserverä¸­åˆ é™¤;</p>\n<h3 id=\"eureka_client\">eureka_client</h3>\n<p>åˆ›å»ºä¸€ä¸ªmavenå­æ¨¡å—å·¥ç¨‹ <code>eureka_client</code><br />\nå®ƒä¾èµ–<code>spring-cloud-starter-netflix-eureka-client</code> è¿™ä¸ª<code>starter</code> æ³¨æ„groupIdæ˜¯ org.springframework.cloud</p>\n<pre><code class=\"language-xml\">&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n</code></pre>\n<h4 id=\"domeä»£ç -1\">domeä»£ç </h4>\n<p>é€šè¿‡æ³¨è§£<code>@EnableEurekaClient</code> è¡¨æ˜è‡ªå·±æ˜¯ä¸€ä¸ªeureka client.</p>\n<pre><code class=\"language-java\">@SpringBootApplication\n@EnableEurekaClient\n@RestController\npublic class ServiceHiApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run( ServiceHiApplication.class, args );\n    }\n\n    @Value(\"${server.port}\")\n    String port;\n\n    @RequestMapping(\"/hi\")\n    public String home(@RequestParam(value = \"name\", defaultValue = \"NAME\") String name) {\n        return \"hi \" + name + \" ,i am from port:\" + port;\n    }\n\n}\n</code></pre>\n<p>ä»…ä»…<code>@EnableEurekaClient</code>æ˜¯ä¸å¤Ÿçš„,<br />\nè¿˜éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æ³¨æ˜è‡ªå·±çš„æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„åœ°å€<code>defaultZone</code><br />\néœ€è¦æŒ‡æ˜<code>spring.application.name</code> è¿™ä¸ªå¾ˆé‡è¦, è¿™åœ¨ä»¥åçš„æœåŠ¡ä¸æœåŠ¡ä¹‹é—´ç›¸äº’è°ƒç”¨ä¸€èˆ¬éƒ½æ˜¯æ ¹æ®è¿™ä¸ªname ;</p>\n<h4 id=\"applicationyml-1\">application.yml</h4>\n<pre><code class=\"language-yml\">server:\n  port: 8762\n\nspring:\n  application:\n    name: service-hi\n\neureka:\n  client:\n    serviceUrl:\n      defaultZone: http://127.0.0.1:8761/eureka/\n</code></pre>\n<h4 id=\"æµ‹è¯•-1\">æµ‹è¯•</h4>\n<ul>\n<li>å¯åŠ¨ eureka_client</li>\n<li>å†å¯åŠ¨ eureka_server</li>\n</ul>\n<blockquote>\n<p>å¯åœ¨ Instances currently registered with Eureka çœ‹åˆ°<code>eureka_client</code> [SERVICE-HI]å·²è¢«æ³¨å†Œ</p>\n</blockquote>\n<p>å‚è€ƒå®˜æ–¹æ–‡æ¡£: <a href=\"https://cloud.spring.io/spring-cloud-static/Finchley.SR2/multi/multi__service_discovery_eureka_clients.html\" rel=\"noopener nofollow\" target=\"_blank\">https://cloud.spring.io/spring-cloud-static/Finchley.SR2/multi/multi__service_discovery_eureka_clients.html</a></p>\n<blockquote>\n<p><a href=\"https://www.fangzhipeng.com/springcloud/2018/08/30/sc-f1-eureka/\" rel=\"noopener nofollow\" target=\"_blank\">https://www.fangzhipeng.com/springcloud/2018/08/30/sc-f1-eureka/</a></p>\n</blockquote>\n<br />\n<hr />\n<h2 id=\"3-æœåŠ¡æ¶ˆè´¹è€…ç¾¤åŸºäºribbonè´Ÿè½½å‡è¡¡\">3. æœåŠ¡æ¶ˆè´¹è€…ç¾¤(åŸºäºribbonè´Ÿè½½å‡è¡¡)</h2>\n<p><strong>è¿™é‡Œä¾¿ è§£å†³å¼•ç”³å‡ºæ¥çš„ç¬¬äºŒä¸ªé—®é¢˜: æ¯ä¸ªå­ç³»ç»Ÿå¯ä»¥éƒ¨ç½²å¤šä¸ªåº”ç”¨, å¤šä¸ªåº”ç”¨ä¹‹é—´ä½¿ç”¨è´Ÿè½½å‡è¡¡</strong></p>\n<p>Spring Cloud Ribbonæ˜¯ä¸€ä¸ªåŸºäºHTTPå’ŒTCPçš„å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å·¥å…·, å®ƒåŸºäºNetflix Ribbonå®ç°; é€šè¿‡Spring Cloudçš„å°è£…,<br />\nå¯ä»¥è®©æˆ‘ä»¬è½»æ¾åœ°å°†é¢å‘æœåŠ¡çš„RESTæ¨¡ç‰ˆè¯·æ±‚è‡ªåŠ¨è½¬æ¢æˆå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„æœåŠ¡è°ƒç”¨;</p>\n<p>æ›´è¯¦ç»†çš„:</p>\n<p><code>Ribbon</code>æ˜¯Netflixå‘å¸ƒçš„å¼€æºé¡¹ç›®, ä¸»è¦åŠŸèƒ½æ˜¯æä¾›å®¢æˆ·ç«¯çš„è½¯ä»¶è´Ÿè½½å‡è¡¡ç®—æ³•, å°†Netflixçš„ä¸­é—´å±‚æœåŠ¡è¿æ¥åœ¨ä¸€èµ·;<br />\nRibbonå®¢æˆ·ç«¯ç»„ä»¶æä¾›ä¸€ç³»åˆ—å®Œå–„çš„é…ç½®é¡¹å¦‚è¿æ¥è¶…æ—¶, é‡è¯•ç­‰; ç®€å•çš„è¯´,</p>\n<p>å°±æ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­åˆ—å‡º<code>Load Balancer</code>åé¢æ‰€æœ‰çš„æœºå™¨, Ribbonä¼šè‡ªåŠ¨çš„å¸®åŠ©ä½ åŸºäºæŸç§è§„åˆ™ï¼ˆå¦‚ç®€å•è½®è¯¢, éšæœºè¿æ¥ç­‰ï¼‰å»è¿æ¥è¿™äº›æœºå™¨;<br />\næˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“ä½¿ç”¨Ribbonå®ç°è‡ªå®šä¹‰çš„è´Ÿè½½å‡è¡¡ç®—æ³•; ç®€å•åœ°è¯´, Ribbonæ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨;<br />\nRibbonå·¥ä½œæ—¶åˆ†ä¸ºä¸¤æ­¥:<br />\nç¬¬ä¸€æ­¥å…ˆé€‰æ‹© Eureka Server, å®ƒä¼˜å…ˆé€‰æ‹©åœ¨åŒä¸€ä¸ªZoneä¸”è´Ÿè½½è¾ƒå°‘çš„Server;<br />\nç¬¬äºŒæ­¥å†æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„ç­–ç•¥, åœ¨ä»Serverå–åˆ°çš„æœåŠ¡æ³¨å†Œåˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªåœ°å€;<br />\nå…¶ä¸­Ribbonæä¾›äº†å¤šç§ç­–ç•¥, ä¾‹å¦‚è½®è¯¢, éšæœº, æ ¹æ®å“åº”æ—¶é—´åŠ æƒç­‰;</p>\n<p>å‡†å¤‡</p>\n<ul>\n<li>å¯åŠ¨ eureka_server (æ³¨å†Œä¸­å¿ƒ)</li>\n<li>å¯åŠ¨ eureka_client (æœåŠ¡)</li>\n<li>æŠŠç«¯å£8762 æ”¹ä¸€ä¸‹ 8763 å†å¯åŠ¨ eureka_client è¿™æ ·ä¾¿æœ‰äº†ä¸¤ä¸ªæœåŠ¡,ç»„æˆä¸€ä¸ªç¾¤</li>\n</ul>\n<blockquote>\n<p>å¯åœ¨ Instances currently registered with Eureka çœ‹åˆ°[SERVICE-HI]å¯ç”¨æ•°æ˜¯2</p>\n</blockquote>\n<h3 id=\"eureka_client-1\">eureka_client</h3>\n<p>åˆ›å»ºä¸€ä¸ªmavenå­æ¨¡å—å·¥ç¨‹ <code>ribbon</code></p>\n<ul>\n<li>pom.xmlå¤§æ¦‚ä¸»ä½“</li>\n</ul>\n<pre><code class=\"language-xml\">    &lt;parent&gt;\n        &lt;groupId&gt;yang&lt;/groupId&gt;\n        &lt;artifactId&gt;spring_cloud_parent&lt;/artifactId&gt;\n        &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;/parent&gt;\n\n    &lt;artifactId&gt;ribbon&lt;/artifactId&gt;\n    &lt;name&gt;ribbon&lt;/name&gt;\n    &lt;url&gt;http://maven.apache.org&lt;/url&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-netflix-ribbon&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n</code></pre>\n<h4 id=\"domeä»£ç -2\">domeä»£ç </h4>\n<p>é€šè¿‡æ³¨è§£<code>@EnableEurekaClient</code> è¡¨æ˜å®ƒä¹Ÿæ˜¯ä¸€ä¸ªeurekaclient(æˆ–è€…è¯´eurekaclientç­‰åŒäºä¸€ä¸ªæœåŠ¡?)</p>\n<p><code> @Bean</code> ç®¡ç†ä¸€ä¸ªbean</p>\n<p><code>@LoadBalanced</code>æ³¨è§£è¡¨æ˜è¿™ä¸ªrestRemplateå¼€å¯è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½;</p>\n<pre><code class=\"language-java\">@SpringBootApplication\n@EnableEurekaClient\n@EnableDiscoveryClient\npublic class Application {\n\n    public static void main(String[] args) {\n        SpringApplication.run( Application.class, args );\n    }\n\n    @Bean\n    @LoadBalanced\n    RestTemplate restTemplate() {\n        return new RestTemplate();\n    }\n\n}\n\n</code></pre>\n<h4 id=\"applicationyml-2\">application.yml</h4>\n<p>æŒ‡å®šæ³¨å†Œä¸­å¿ƒåœ°å€, ä»¥åŠè‡ªå·±çš„åç§°</p>\n<pre><code class=\"language-yml\">eureka:\nclient:\n    serviceUrl:\n    defaultZone: http://127.0.0.1:8761/eureka/\nserver:\nport: 8764\nspring:\napplication:\n    name: ribbon\n</code></pre>\n<h4 id=\"è°ƒç”¨ä»£ç \">è°ƒç”¨ä»£ç </h4>\n<p>åˆ›å»ºä¸€ä¸ªService è°ƒç”¨<code>SERVICE-HI</code>çš„hi æ¥å£<br />\næ³¨æ„è¿™é‡Œurlçš„SERVICE-HI,å®ƒåœ¨ribbonä¸­å®ƒä¼šæ ¹æ®æœåŠ¡åæ¥é€‰æ‹©å…·ä½“çš„æœåŠ¡å®ä¾‹, æ ¹æ®æœåŠ¡å®ä¾‹åœ¨è¯·æ±‚çš„æ—¶å€™ä¼šç”¨å…·ä½“çš„urlæ›¿æ¢æ‰æœåŠ¡å</p>\n<pre><code class=\"language-java\">@Service\npublic class HelloService {\n    @Autowired\n    RestTemplate restTemplate;\n\n        public String hiService(String name) {\n            return restTemplate.getForObject(\"http://SERVICE-HI/hi?name=\"+name,String.class);\n        }\n}\n\n</code></pre>\n<p>ä¸€ä¸ªcontrollerä¸­, è°ƒç”¨HelloService çš„æ–¹æ³•</p>\n<pre><code class=\"language-java\">@RestController\npublic class HelloControler {\n\n    @Autowired\n    HelloService helloService;\n\n    @GetMapping(value = \"/hi\")\n    public String hi(@RequestParam String name) {\n        return helloService.hiService( name );\n    }\n}\n\n</code></pre>\n<p>åœ¨æ³¨å†Œä¸­å¿ƒé¡µé¢, ä¼šçœ‹åˆ°ä¸‰ä¸ªæœåŠ¡: <a href=\"http://127.0.0.1:8761/\" rel=\"noopener nofollow\" target=\"_blank\">http://127.0.0.1:8761/</a><br />\n<img alt=\"20190129170623\" class=\"lazyload\" /></p>\n<p>åœ¨æµè§ˆå™¨ä¸Šå¤šæ¬¡è®¿é—®http://127.0.0.1:8764/hi?name=è´Ÿè½½å‡è¡¡, æµè§ˆå™¨ä¼šäº¤æ›¿æ˜¾ç¤º,è¿™è¯´æ˜ä¼šè½®æµè®¿é—®ä¸åŒçš„ä¸»æœº</p>\n<p><br /><br /><br /></p>\n<p>-<strong>ç›®å‰æ¶æ„</strong></p>\n<p><img alt=\"20190129170751\" class=\"lazyload\" /></p>\n<ul>\n<li>\n<p>ä¸€ä¸ªæœåŠ¡æ³¨å†Œä¸­å¿ƒ, eureka server,ç«¯å£ä¸º8761</p>\n</li>\n<li>\n<p>service-hiå·¥ç¨‹è·‘äº†ä¸¤ä¸ªå®ä¾‹, ç«¯å£åˆ†åˆ«ä¸º8762, 8763, åˆ†åˆ«å‘æœåŠ¡æ³¨å†Œä¸­å¿ƒæ³¨å†Œ</p>\n</li>\n<li>\n<p>sercvice-ribbonç«¯å£ä¸º8764,å‘æœåŠ¡æ³¨å†Œä¸­å¿ƒæ³¨å†Œ</p>\n</li>\n</ul>\n<blockquote>\n<p>å½“sercvice-ribboné€šè¿‡restTemplateè°ƒç”¨service-hiçš„hiæ¥å£æ—¶, å› ä¸ºç”¨ribbonè¿›è¡Œäº†è´Ÿè½½å‡è¡¡, ä¼šè½®æµçš„è°ƒç”¨service-hi: 8762å’Œ8763 ä¸¤ä¸ªç«¯å£çš„hiæ¥å£;</p>\n</blockquote>\n<blockquote>\n<p><a href=\"https://www.fangzhipeng.com/springcloud/2018/08/30/sc-f2-ribbon/\" rel=\"noopener nofollow\" target=\"_blank\">https://www.fangzhipeng.com/springcloud/2018/08/30/sc-f2-ribbon/</a></p>\n</blockquote>\n<h2 id=\"4-æ–­è·¯å™¨åŸºäºhystrix\">4. æ–­è·¯å™¨(åŸºäºHystrix)</h2>\n<p><strong>è¿™é‡Œä¾¿ è§£å†³å¼•ç”³å‡ºæ¥çš„ç¬¬å…­ä¸ªé—®é¢˜: åŠæ—¶å¤„ç†æœåŠ¡è°ƒç”¨æ—¶çš„è¶…æ—¶å’Œé”™è¯¯, é˜²æ­¢ç”±äºå…¶ä¸­ä¸€ä¸ªæœåŠ¡çš„é—®é¢˜è€Œå¯¼è‡´æ•´ä½“ç³»ç»Ÿçš„ç˜«ç—ª;</strong></p>\n<p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­, æ ¹æ®ä¸šåŠ¡æ¥æ‹†åˆ†æˆä¸€ä¸ªä¸ªçš„æœåŠ¡, æœåŠ¡ä¸æœåŠ¡ä¹‹é—´å¯ä»¥ç›¸äº’è°ƒç”¨ï¼ˆRPCï¼‰, åœ¨Spring Cloudå¯ä»¥ç”¨RestTemplate+Ribbonå’ŒFeignæ¥è°ƒç”¨;<br />\nä¸ºäº†ä¿è¯å…¶é«˜å¯ç”¨, å•ä¸ªæœåŠ¡é€šå¸¸ä¼šé›†ç¾¤éƒ¨ç½²; ç”±äºç½‘ç»œåŸå› æˆ–è€…è‡ªèº«çš„åŸå› , æœåŠ¡å¹¶ä¸èƒ½ä¿è¯100%å¯ç”¨, å¦‚æœå•ä¸ªæœåŠ¡å‡ºç°é—®é¢˜, è°ƒç”¨è¿™ä¸ªæœåŠ¡å°±ä¼šå‡ºç°çº¿ç¨‹é˜»å¡,<br />\næ­¤æ—¶è‹¥æœ‰å¤§é‡çš„è¯·æ±‚æ¶Œå…¥, Servletå®¹å™¨çš„çº¿ç¨‹èµ„æºä¼šè¢«æ¶ˆè€—å®Œæ¯•, å¯¼è‡´æœåŠ¡ç˜«ç—ª; æœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„ä¾èµ–æ€§, æ•…éšœä¼šä¼ æ’­, ä¼šå¯¹æ•´ä¸ªå¾®æœåŠ¡ç³»ç»Ÿé€ æˆç¾éš¾æ€§çš„ä¸¥é‡åæœ,<br />\nè¿™å°±æ˜¯æœåŠ¡æ•…éšœçš„\"é›ªå´©\"æ•ˆåº”;</p>\n<p>Netflixå¼€æºäº†Hystrixç»„ä»¶, å®ç°äº†æ–­è·¯å™¨æ¨¡å¼, SpringCloudå¯¹è¿™ä¸€ç»„ä»¶è¿›è¡Œäº†æ•´åˆ;  åœ¨å¾®æœåŠ¡æ¶æ„ä¸­, ä¸€ä¸ªè¯·æ±‚éœ€è¦è°ƒç”¨å¤šä¸ªæœåŠ¡æ˜¯éå¸¸å¸¸è§</p>\n<ul>\n<li>\n<p>æ­£å¸¸æƒ…å†µçš„è°ƒç”¨:<br />\n<img alt=\"8d8d524c312c27d\" class=\"lazyload\" /></p>\n<p>è¾ƒåº•å±‚çš„æœåŠ¡å¦‚æœå‡ºç°æ•…éšœ, ä¼šå¯¼è‡´è¿é”æ•…éšœ; å½“å¯¹ç‰¹å®šçš„æœåŠ¡çš„è°ƒç”¨çš„ä¸å¯ç”¨è¾¾åˆ°ä¸€ä¸ªé˜€å€¼ï¼ˆHystric æ˜¯5ç§’20æ¬¡ï¼‰ æ–­è·¯å™¨å°†ä¼šè¢«æ‰“å¼€;</p>\n</li>\n<li>\n<p>å½“æŸä¸ªæœåŠ¡downæ‰å<br />\n<img alt=\"1f208d62046f\" class=\"lazyload\" /></p>\n</li>\n</ul>\n<p>æ–­è·¯æ‰“å¼€å, å¯ç”¨é¿å…è¿é”æ•…éšœ, fallbackæ–¹æ³•å¯ä»¥ç›´æ¥è¿”å›ä¸€ä¸ªå›ºå®šå€¼;</p>\n<h3 id=\"æ”¹é€ å®ç°\">æ”¹é€ å®ç°</h3>\n<p>æ”¹é€  ribbon é¡¹ç›®<br />\né¦–å…ˆåœ¨pox.xmlæ–‡ä»¶ä¸­åŠ å…¥<code>spring-cloud-starter-netflix-hystrix</code>çš„<code>starter</code> æ³¨æ„groupIdæ˜¯ org.springframework.cloud</p>\n<h4 id=\"æ”¹é€ poxxml\">æ”¹é€ pox.xml</h4>\n<pre><code class=\"language-xml\">    &lt;!-- æ–­è·¯å™¨ç»„ä»¶ --&gt;\n     &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n</code></pre>\n<p>åœ¨ç¨‹åºçš„å¯åŠ¨ç±»Application åŠ <code>@EnableHystrix</code>æ³¨è§£å¼€å¯Hystrix:</p>\n<h4 id=\"æ”¹é€ å¯åŠ¨ç±»\">æ”¹é€ å¯åŠ¨ç±»</h4>\n<pre><code class=\"language-java\">@SpringBootApplication\n@EnableEurekaClient\n@EnableDiscoveryClient\n@EnableHystrix\npublic class Application {\n\n    public static void main(String[] args) {\n        SpringApplication.run( Application.class, args );\n    }\n\n    @Bean\n    @LoadBalanced\n    RestTemplate restTemplate() {\n        return new RestTemplate();\n    }\n\n}\n\n</code></pre>\n<h4 id=\"helloservice\">HelloService</h4>\n<p>æ”¹é€ HelloServiceç±», åœ¨hiServiceæ–¹æ³•ä¸ŠåŠ ä¸Š<code>@HystrixCommand</code>æ³¨è§£; è¯¥æ³¨è§£å¯¹è¯¥æ–¹æ³•åˆ›å»ºäº†ç†”æ–­å™¨çš„åŠŸèƒ½, å¹¶æŒ‡å®šäº†<code>fallbackMethod</code>ç†”æ–­æ–¹æ³•, <code>hiError</code></p>\n<pre><code class=\"language-java\">\n@Service\npublic class HelloService {\n\t @Autowired\n\t  RestTemplate restTemplate;\n\t \n\t    @HystrixCommand(fallbackMethod = \"hiError\")\n\t    public String hiService(String name) {\n\t        return restTemplate.getForObject(\"http://SERVICE-HI/hi?name=\"+name,String.class);\n\t    }\n\t    \n\t    public String hiError(String name) {\n\t        return \"hi,\"+name+\", æŠ±æ­‰è¯¥æœåŠ¡, å·²ç»downæ‰äº† :(\";\n\t    }\n}\n\n</code></pre>\n<h4 id=\"æµ‹è¯•-2\">æµ‹è¯•</h4>\n<ul>\n<li>å¯åŠ¨ eureka_server (æ³¨å†Œä¸­å¿ƒ)</li>\n<li>å¯åŠ¨ eureka_client (æœåŠ¡)</li>\n<li>å¯åŠ¨ ribbon (è´Ÿè½½å‡è¡¡)</li>\n</ul>\n<p>è®¿é—®è¯¥è´Ÿè½½å‡è¡¡æœåŠ¡url:<br />\n<a href=\"http://127.0.0.1:8764/hi?name=%E6%B5%8B%E6%B5%8B%E8%AF%95%E8%AF%95\" rel=\"noopener nofollow\" target=\"_blank\">http://127.0.0.1:8764/hi?name=æµ‹æµ‹è¯•è¯•</a></p>\n<p>æ­£å¸¸è¾“å‡º:</p>\n<blockquote>\n<p>hi æµ‹æµ‹è¯•è¯• ,i am from port:8762</p>\n</blockquote>\n<p>å¦‚æœæŠŠeureka_client donw, å°±ä¼šè¾“å‡º</p>\n<blockquote>\n<p>hi,æµ‹æµ‹è¯•è¯•, æŠ±æ­‰è¯¥æœåŠ¡, å·²ç»downæ‰äº† ğŸ˜¦</p>\n</blockquote>\n<h2 id=\"4-è·¯å™¨ç½‘å…³åŸºäºzuul\">4. è·¯å™¨ç½‘å…³(åŸºäºZuul)</h2>\n<p><strong>è¿™é‡Œä¾¿ è§£å†³å¼•ç”³å‡ºæ¥çš„ç¬¬å››ä¸ªé—®é¢˜: æ‰€æœ‰çš„å®¢æˆ·ç«¯éƒ½é€šè¿‡åŒä¸€ä¸ªç½‘å…³åœ°å€è®¿é—®åå°çš„æœåŠ¡, é€šè¿‡è·¯ç”±é…ç½®, ç½‘å…³æ¥åˆ¤æ–­ä¸€ä¸ªURLè¯·æ±‚ç”±å“ªä¸ªæœåŠ¡å¤„ç†;</strong></p>\n<p>Zuul çš„ä¸»è¦åŠŸèƒ½æ˜¯è·¯ç”±è½¬å‘å’Œè¿‡æ»¤å™¨; è·¯ç”±åŠŸèƒ½æ˜¯å¾®æœåŠ¡çš„ä¸€éƒ¨åˆ†, æ¯”å¦‚ï¼api/userè½¬å‘åˆ°åˆ°useræœåŠ¡,<br />\n/api/shopè½¬å‘åˆ°åˆ°shopæœåŠ¡; zuulé»˜è®¤å’ŒRibbonç»“åˆå®ç°äº†è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½;</p>\n<h3 id=\"åˆ›å»º\">åˆ›å»º</h3>\n<p>åˆ›å»ºä¸€ä¸ªmavenå­æ¨¡å—å·¥ç¨‹ <code>zuul</code><br />\npom.xml ä¸»ä½“ä¾èµ–</p>\n<pre><code class=\"language-xml\">&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-netflix-zuul&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n</code></pre>\n<h3 id=\"domeä»£ç -3\">domeä»£ç </h3>\n<p>é€šè¿‡æ³¨è§£<code>@EnableEurekaClient</code> è¡¨æ˜å®ƒä¹Ÿæ˜¯ä¸€ä¸ªeureka client<br />\né€šè¿‡æ³¨è§£<code>@EnableZuulProxy</code> å¼€å¯zuulçš„åŠŸèƒ½</p>\n<pre><code class=\"language-java\">/**\n * è·¯ç”±ç½‘å…³\n */\n@SpringBootApplication\n@EnableZuulProxy\n@EnableEurekaClient\n@EnableDiscoveryClient\npublic class Application {\n\n    public static void main(String[] args) {\n        SpringApplication.run( Application.class, args );\n    }\n\n}\n\n</code></pre>\n<h3 id=\"applicationyml-3\">application.yml</h3>\n<p>é¦–å…ˆæŒ‡å®šæœåŠ¡æ³¨å†Œä¸­å¿ƒçš„åœ°å€ä¸ºhttp://localhost:8761/eureka/, æœåŠ¡çš„ç«¯å£ä¸º8769, æœåŠ¡åä¸ºzuul;<br />\nä»¥/api-a/ å¼€å¤´çš„è¯·æ±‚éƒ½è½¬å‘ç»™ribbonæœåŠ¡;<br />\nä»¥/api-b/å¼€å¤´çš„è¯·æ±‚éƒ½è½¬å‘ç»™service-hiæœåŠ¡;</p>\n<pre><code class=\"language-yml\">eureka:\n  client:\n    serviceUrl:\n      defaultZone: http://127.0.0.1:8761/eureka/\nserver:\n  port: 8769\nspring:\n  application:\n    name: zuul\nzuul:\n  routes:\n    api-a:\n      path: /api-a/**\n      serviceId: RIBBON\n    api-b:\n      path: /api-b/**\n      serviceId: SERVICE-HI\n\n</code></pre>\n<h3 id=\"æµ‹è¯•-3\">æµ‹è¯•</h3>\n<p>å¯åŠ¨, æ³¨å†Œä¸­å¿ƒ(erureka server) , æœåŠ¡åº”ç”¨(erureka client), è´Ÿè½½å‡è¡¡(ribbon), è·¯ç”±(zuul)<br />\nè®¿é—®api-a,api-béƒ½æ˜¯æœ‰æ•ˆçš„, ä½†æ˜¯æŠŠè´Ÿè½½å‡è¡¡åœæ‰,api-a å°±æ— æ•ˆäº†..<br />\n<a href=\"http://127.0.0.1:8769/api-a/hi?name=ddd\" rel=\"noopener nofollow\" target=\"_blank\">http://127.0.0.1:8769/api-a/hi?name=ddd</a><br />\n<a href=\"http://127.0.0.1:8769/api-b/hi?name=ddd\" rel=\"noopener nofollow\" target=\"_blank\">http://127.0.0.1:8769/api-b/hi?name=ddd</a></p>\n<p>ç½‘å…³ä¸å•æ­¢é›†ä¸­API è½¬å‘, å®ƒè¿˜å¯å¯ä»¥åšä¸€ä¸‹å®‰å…¨è¿‡æ»¤çš„åŠŸèƒ½... å¾…ç ”ç©¶</p>\n<h2 id=\"5-å¾®æœåŠ¡ç›‘æ§åŸºäºspring-boot-admin\">5. å¾®æœåŠ¡ç›‘æ§(åŸºäºSpring Boot Admin)</h2>\n<p>å®˜æ–¹2.1.2 æ–‡æ¡£: <a href=\"http://codecentric.github.io/spring-boot-admin/2.1.2/\" rel=\"noopener nofollow\" target=\"_blank\">http://codecentric.github.io/spring-boot-admin/2.1.2/</a></p>\n<h3 id=\"ç«¯ç‚¹endpoints\">ç«¯ç‚¹(Endpoints)</h3>\n<p>Actuator endpoints let you monitor and interact with your application.</p>\n<p>æ‰§è¡Œå™¨ç«¯ç‚¹, å¯ä»¥è®©ä½ ç›‘æ§åº”ç”¨ç¨‹åºå¹¶ä¸ä¹‹äº¤äº’; (æ¢å¥è¯è¯´, æä¾›ä¸€ä¸ªå¯ä»¥ä¸ç»„ä»¶æœåŠ¡äº¤äº’çš„æ¥å£,åŒ…æ‹¬ä½†ä¸é™äºç›‘æ§, è·å– æœåŠ¡ç»„ä»¶çš„è¿è¡Œä¿¡æ¯)</p>\n<p>å®ƒå†…ç½®äº†ä¸€äº›ç«¯ç‚¹ è§æ–‡æ¡£, Spring Boot Admin ç›‘æ§è·å–ç»„ä»¶æœåŠ¡çš„ä¿¡æ¯å°±æ˜¯é€šè¿‡è¿™äº›ç«¯ç‚¹.</p>\n<blockquote>\n<p>æ–‡æ¡£: <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html\" rel=\"noopener nofollow\" target=\"_blank\">https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html</a></p>\n</blockquote>\n<blockquote>\n<p><a href=\"https://blog.csdn.net/liupeifeng3514/article/details/80558414\" rel=\"noopener nofollow\" target=\"_blank\">https://blog.csdn.net/liupeifeng3514/article/details/80558414</a></p>\n</blockquote>\n<h3 id=\"è¸©å‘æŒ‡å—\">è¸©å‘æŒ‡å—!!</h3>\n<ul>\n<li>è¢«ç›‘æ§æœåŠ¡åº”ç”¨é¡¹ç›®æ·»åŠ  <code>spring-boot-starter-actuator</code>!!</li>\n</ul>\n<pre><code class=\"language-xml\">  &lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n<ul>\n<li>ç„¶ååœ¨ <code>application.yml</code> é…ç½®æš´éœ²çš„ç«¯ç‚¹</li>\n</ul>\n<p>//è¿™é‡Œç®€å•ç²—æš´, æš´éœ²æ‰€æœ‰ç«¯ç‚¹</p>\n<pre><code class=\"language-yml\">management:\n  endpoints:\n    web:\n      exposure:\n        include: \"*\"  \n        exclude: configprops # é…ç½®ä¿¡æ¯configpropsçš„ç«¯ç‚¹, æ’é™¤æ‰æ²¡ä»€ä¹ˆæ„ä¹‰, ä¸”å½“å‰ç‰ˆæœ¬å­˜åœ¨BUG. (ä¸€ç›´æŠ›å‡ºservlet aync å¼‚å¸¸)\n  endpoint:\n    health:\n      show-details: ALWAYS\n</code></pre>\n<p>ä»¥ä¸‹åˆ›å»º <code>Spring Boot Admin server</code> æœåŠ¡åº”ç”¨</p>\n<h3 id=\"åˆ›å»º-1\">åˆ›å»º</h3>\n<p>åˆ›å»ºä¸€ä¸ªmavenå­æ¨¡å—å·¥ç¨‹ ``<br />\npom.xml ä¸»ä½“ä¾èµ–</p>\n<pre><code class=\"language-xml\"> \n &lt;dependency&gt;\n    &lt;groupId&gt;de.codecentric&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-admin-starter-server&lt;/artifactId&gt;\n    &lt;version&gt;2.1.2&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n  &lt;!-- tag::dependency-eureka[] --&gt;\n  &lt;dependency&gt;\n      &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;\n  &lt;/dependency&gt;\n  &lt;!-- end::dependency-eureka[]  --&gt;\n\n</code></pre>\n<h3 id=\"domeä»£ç -4\">domeä»£ç </h3>\n<p>é€šè¿‡æ³¨è§£<code>@EnableDiscoveryClient</code> spring ä¼šç›´æ¥ æ•´åˆåˆ°æ³¨å†Œä¸­å¿ƒ(è¿™é‡Œæ˜¯eureka, æ‰€æœ‰ä¸Šé¢çš„ä¾èµ–æ˜¯spring-cloud-starter-netflix-eureka-client)<br />\né€šè¿‡æ³¨è§£<code>@EnableAdminServer</code> è¡¨æ˜å®ƒæ˜¯ spring-boot-admin æœåŠ¡</p>\n<pre><code class=\"language-java\">/**\n * ç›‘æ§\n * \n * @author yangfh\n * 2019å¹´1æœˆ30æ—¥\n */\n@Configuration\n@EnableAutoConfiguration\n@EnableDiscoveryClient\n@EnableAdminServer\npublic class SpringBootAdminApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(SpringBootAdminApplication.class, args);\n    }\n\n    @Configuration\n    public static class SecurityPermitAllConfig extends WebSecurityConfigurerAdapter {\n        @Override\n        protected void configure(HttpSecurity http) throws Exception {\n          http.authorizeRequests().anyRequest().permitAll()  \n               .and().csrf().disable();\n        }\n    }\n}\n\n</code></pre>\n<h3 id=\"applicationyml-4\">application.yml</h3>\n<pre><code class=\"language-yml\">server:\n  port: 8800\nspring:\n  application:\n    name: admin\neureka:\n  instance:\n    leaseRenewalIntervalInSeconds: 10\n    health-check-url-path: /actuator/health\n  client:\n    serviceUrl:\n      defaultZone: http://localhost:8761/eureka/ # æœåŠ¡æ³¨å†Œä¸­å¿ƒ\nmanagement: \n  endpoints:\n    web:\n      exposure:\n        include: '*' #æš´éœ²æ‰€æœ‰ç«¯ç‚¹\n      exclude: configprops #é…ç½®ä¿¡æ¯configpropsçš„ç«¯ç‚¹, æ’é™¤æ‰æ²¡ä»€ä¹ˆæ„ä¹‰, ä¸”å½“å‰ç‰ˆæœ¬å­˜åœ¨BUG.(java.lang.IllegalStateException: Calling [asyncError()])\n  endpoint:\n      health:\n        show-details: ALWAYS\n\n</code></pre>\n<h3 id=\"æµ‹è¯•-4\">æµ‹è¯•</h3>\n<p>å¯åŠ¨, æ³¨å†Œä¸­å¿ƒ(erureka server) , Spring Boot Adminç›‘æ§(admin)</p>\n<p>å¯ä»¥è®¿é—®Spring Boot Admin (admin)çš„åœ°å€: <a href=\"http://localhost:8800/\" rel=\"noopener nofollow\" target=\"_blank\">http://localhost:8800/</a>, åœ¨æ³¨å†Œä¸­å¿ƒåªæœ‰è‡ªå·±, æ‰€ä»¥åªèƒ½çœ‹åˆ°è‡ªå·±çš„ä¸€äº›ä¿¡æ¯</p>\n<h3 id=\"ç›‘æ§å…¶ä»–æœåŠ¡åº”ç”¨\">ç›‘æ§å…¶ä»–æœåŠ¡åº”ç”¨</h3>\n<p>å¦‚æœ ç›´æ¥å¯åŠ¨ erureka client, åœ¨Spring Boot Admin æ˜¯çœ‹ä¸åˆ°çš„è¯¥åº”ç”¨çš„è¯¦ç»†ä¿¡æ¯çš„, çº¢å‰</p>\n<ul>\n<li>æ”¹é€  erureka client æ·»åŠ  ä¾èµ–</li>\n</ul>\n<pre><code class=\"language-xml\">  &lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n<ul>\n<li>application.yml å¼€æ”¾ç«¯ç‚¹</li>\n</ul>\n<pre><code class=\"language-yml\">management:\n  endpoints:\n    web:\n      exposure:\n        include: \"*\"  \n  endpoint:\n    health:\n      show-details: ALWAYS\n</code></pre>\n<ul>\n<li>å¯åŠ¨</li>\n</ul>\n<p><img alt=\"20190129170623\" class=\"lazyload\" /></p>\n<p><a href=\"spring_cloud_parent.zip\" rel=\"noopener nofollow\" target=\"_blank\">yeah~</a></p>\n<h3 id=\"è‡ªå®šä¹‰ç«¯ç‚¹\">è‡ªå®šä¹‰ç«¯ç‚¹</h3>\n<p>åªéœ€è¦ä¸‰ä¸ªæ³¨è§£@endpoint, @ReadOperation, @Selector</p>\n<pre><code class=\"language-java\">@Endpoint(id = \"customPoint\")\n@Component\npublic class StatusEndPoint {\n \n\t@ReadOperation\n\tpublic String getCustom(@Selector String name) {\n\t\treturn \"MyName is .\" + name;\n\t}\n \n}\n</code></pre>\n<p>ä¸€ä¸ªè‡ªå®šä¹‰CPU ç«¯ç‚¹, å¦å¤–ä¸€ç§æ–¹å¼</p>\n<pre><code class=\"language-java\">package net.jk.admin.controller;\n\nimport java.lang.management.ManagementFactory;\nimport java.util.Iterator;\nimport java.util.List;\nimport java.util.Optional;\n\nimport javax.annotation.PostConstruct;\nimport javax.management.Attribute;\nimport javax.management.AttributeList;\nimport javax.management.MBeanServer;\nimport javax.management.ObjectName;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Component;\n\nimport io.micrometer.core.instrument.Gauge;\nimport io.micrometer.core.instrument.MeterRegistry;\n\n/**\n * \n * @author yangfh\n * 2019å¹´4æœˆ10æ—¥\n */\n@Component\npublic class CpuMetrics {\n\tprivate final static String METRICS_NAME = \"process.cpu.load\";\n\n    @Autowired\n    private MeterRegistry meterRegistry;\n\n    @PostConstruct\n    public void init() {\n        Gauge.builder(METRICS_NAME, this, CpuMetrics::getProcessCpuLoad)\n            .baseUnit(\"%\")\n            .description(\"CPU Load\")\n            .register(meterRegistry);\n    }\n\n    public Double getProcessCpuLoad() {\n        try {\n            MBeanServer mbs = ManagementFactory.getPlatformMBeanServer();\n            ObjectName name = ObjectName.getInstance(\"java.lang:type=OperatingSystem\");\n            AttributeList list = mbs.getAttributes(name, new String[]{\"ProcessCpuLoad\"});\n\n            return Optional.ofNullable(list)\n                    .map(l -&gt; l.isEmpty() ? null: l)\n                    .map(List::iterator)\n                    .map(Iterator::next)\n                    .map(Attribute.class::cast)\n                    .map(Attribute::getValue)\n                    .map(Double.class::cast)\n                    .orElse(null);\n\n        } catch (Exception ex) {\n            return null;\n        }\n    }\n}\n\n</code></pre>\n<p>The CPU metrics will then be available at /actuator/metrics/process.cpu.load:</p>\n<p><a href=\"https://stackoverflow.com/questions/37985719/spring-boot-actuator-to-give-cpu-usage/52150306#52150306?newreg=a0e9d98d127247d1b3f275e775bba2f3\" rel=\"noopener nofollow\" target=\"_blank\">https://stackoverflow.com/questions/37985719/spring-boot-actuator-to-give-cpu-usage/52150306#52150306?newreg=a0e9d98d127247d1b3f275e775bba2f3</a></p>\n<p>å‚è€ƒæ–‡æ¡£: <a href=\"http://codecentric.github.io/spring-boot-admin/2.1.2/\" rel=\"noopener nofollow\" target=\"_blank\">http://codecentric.github.io/spring-boot-admin/2.1.2/</a><br />\nå‚è€ƒ2.xéƒ¨åˆ†ç«¯ç‚¹: <a href=\"https://www.baeldung.com/spring-boot-actuators#boot-2x-actuator\" rel=\"noopener nofollow\" target=\"_blank\">https://www.baeldung.com/spring-boot-actuators#boot-2x-actuator</a><br />\nç«¯ç‚¹å®‰å…¨: <a href=\"https://segmentfault.com/a/1190000015309478?utm_source=tag-newest\" rel=\"noopener nofollow\" target=\"_blank\">https://segmentfault.com/a/1190000015309478?utm_source=tag-newest</a></p>\n<h2 id=\"spring-session\">Spring-Session</h2>\n<p>åˆ†å¸ƒå¼Sessionçš„é—®é¢˜</p>\n<blockquote>\n<p>é‡å¹³è¡¡HTTP sessionå¯èƒ½ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆ;<br />\nä¸ºäº†å­˜å‚¨å¤§é‡çš„session, ä¼šéœ€è¦å¾ˆå¤§çš„å †ç©ºé—´, è¿™ä¼šå¯¼è‡´åƒåœ¾æ”¶é›†, ä»è€Œå¯¹æ€§èƒ½äº§ç”Ÿè´Ÿé¢å½±å“;<br />\näº‘åŸºç¡€è®¾æ–½é€šå¸¸ä¼šç¦æ­¢TCPå¤šæ’­ï¼ˆmulticastï¼‰, ä½†æ˜¯sessionç®¡ç†å™¨å¸¸å¸¸ä¼šä½¿ç”¨è¿™ç§æœºåˆ¶æ¥å‘ç°å“ªä¸€ä¸ªåº”ç”¨æœåŠ¡å™¨å®ä¾‹åŠ å…¥æˆ–ç¦»å¼€äº†é›†ç¾¤;</p>\n</blockquote>\n<blockquote>\n<p>å› æ­¤, æ›´ä¸ºé«˜æ•ˆçš„åŠæ³•æ˜¯å°†HTTP sessionçŠ¶æ€ä¿å­˜åœ¨ç‹¬ç«‹çš„æ•°æ®å­˜å‚¨ä¸­, è¿™ä¸ªå­˜å‚¨ä½äºè¿è¡Œåº”ç”¨ç¨‹åºä»£ç çš„JVMä¹‹å¤–;<br />\nä¾‹å¦‚, æˆ‘ä»¬å¯ä»¥å°†100ä¸ªTomcatå®ä¾‹é…ç½®ä¸ºä½¿ç”¨Redisæ¥å­˜å‚¨sessionçŠ¶æ€, å½“Tomcatå®ä¾‹å¢åŠ æˆ–å‡å°‘çš„æ—¶å€™,<br />\nRedisä¸­æ‰€å­˜å‚¨çš„sessionå¹¶ä¸ä¼šå—åˆ°å½±å“; åŒæ—¶, å› ä¸ºRedisæ˜¯ä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„, æ‰€ä»¥å®ƒå¯ä»¥ä½¿ç”¨ä¸Šç™¾GBç”šè‡³TBçº§åˆ«çš„RAM,<br />\nå®ƒä¸ä¼šæ¶‰åŠåˆ°åƒåœ¾æ”¶é›†çš„é—®é¢˜;</p>\n</blockquote>\n<p><a href=\"https://www.cnblogs.com/river2005/p/6415879.html\" target=\"_blank\">https://www.cnblogs.com/river2005/p/6415879.html</a></p>\n<p>Spring Sessionè®¤ä¸ºç¬¬ä¸€ä¸ªé—®é¢˜, ä¹Ÿå°±æ˜¯åœ¨é«˜å¯ç”¨å¯æ‰©å±•çš„é›†ç¾¤ä¸­å­˜å‚¨æ•°æ®å·²ç»é€šè¿‡å„ç§æ•°æ®å­˜å‚¨æ–¹æ¡ˆå¾—åˆ°äº†è§£å†³, å¦‚Redis, GemFireä»¥åŠApache Geodeç­‰ç­‰,</p>\n<p>å› æ­¤, Spring Sessionå®šä¹‰äº†ä¸€ç»„æ ‡å‡†çš„æ¥å£, å¯ä»¥é€šè¿‡å®ç°è¿™äº›æ¥å£é—´æ¥è®¿é—®åº•å±‚çš„æ•°æ®å­˜å‚¨; Spring Sessionå®šä¹‰äº†å¦‚ä¸‹æ ¸å¿ƒæ¥å£: Session, ExpiringSessionä»¥åŠSessionRepository, é’ˆå¯¹ä¸åŒçš„æ•°æ®å­˜å‚¨, å®ƒä»¬éœ€è¦åˆ†åˆ«å®ç°;</p>\n<p>org.springframework.session.Sessionæ¥å£å®šä¹‰äº†sessionçš„åŸºæœ¬åŠŸèƒ½, å¦‚è®¾ç½®å’Œç§»é™¤å±æ€§; è¿™ä¸ªæ¥å£å¹¶ä¸å…³å¿ƒåº•å±‚æŠ€æœ¯, å› æ­¤èƒ½å¤Ÿæ¯”servlet HttpSessioné€‚ç”¨äºæ›´ä¸ºå¹¿æ³›çš„åœºæ™¯ä¸­;<br />\norg.springframework.session.ExpiringSessionæ‰©å±•äº†Sessionæ¥å£, å®ƒæä¾›äº†åˆ¤æ–­sessionæ˜¯å¦è¿‡æœŸçš„å±æ€§; RedisSessionæ˜¯è¿™ä¸ªæ¥å£çš„ä¸€ä¸ªæ ·ä¾‹å®ç°;<br />\norg.springframework.session.SessionRepositoryå®šä¹‰äº†åˆ›å»º, ä¿å­˜, åˆ é™¤ä»¥åŠæ£€ç´¢sessionçš„æ–¹æ³•; å°†Sessionå®ä¾‹çœŸæ­£ä¿å­˜åˆ°æ•°æ®å­˜å‚¨çš„é€»è¾‘æ˜¯åœ¨è¿™ä¸ªæ¥å£çš„å®ç°ä¸­ç¼–ç å®Œæˆçš„; ä¾‹å¦‚, RedisOperationsSessionRepositoryå°±æ˜¯è¿™ä¸ªæ¥å£çš„ä¸€ä¸ªå®ç°, å®ƒä¼šåœ¨Redisä¸­åˆ›å»º, å­˜å‚¨å’Œåˆ é™¤session;</p>\n<h3 id=\"httpsession-with-jdbc-guide\"><a href=\"https://docs.spring.io/spring-session/docs/2.1.5.RELEASE/reference/html5/guides/boot-redis.html\" rel=\"noopener nofollow\" target=\"_blank\">HttpSession with JDBC Guide</a></h3>\n<p>å¯ç”¨redis ç®¡ç†session æ³¨æ„å®ƒä¾èµ–ä¸ redis æ‰€ä»¥éœ€è¦é…ç½® redis ?</p>\n<pre><code class=\"language-xml\">&lt;!-- redis \n  redis:\n    database: 0\n    port: 6379\n    pool:\n      max-idle: 8\n      min-idle: 0\n      max-active: 8\n      max-wait: -1\n    host: 127.0.0.1\n    timeout: 5000\n    --&gt;\n   &lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.session&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-session-data-redis&lt;/artifactId&gt;\n  &lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.session&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-session-data-redis&lt;/artifactId&gt;\n  &lt;/dependency&gt;\n</code></pre>\n<p><a href=\"https://blog.csdn.net/andyliulin/article/details/80850317\" rel=\"noopener nofollow\" target=\"_blank\">https://blog.csdn.net/andyliulin/article/details/80850317</a></p>\n<h1 id=\"spring-cloud-oauth20-æ•´åˆ\">Spring Cloud OAuth2.0 æ•´åˆ</h1>\n<h2 id=\"oauth20-æ¦‚è¦\">OAuth2.0 æ¦‚è¦</h2>\n<p>OAuth2 æ˜¯ä¸€ä¸ªå¼€æ”¾æˆæƒæ ‡å‡†åè®®, å®ƒå…è®¸ç”¨æˆ·è®©ç¬¬ä¸‰æ–¹åº”ç”¨è®¿é—®è¯¥ç”¨æˆ·åœ¨æŸæœåŠ¡çš„ç‰¹å®šç§æœ‰èµ„æº,<br />\nä½†æ˜¯ä¸æä¾›è´¦å·å¯†ç ä¿¡æ¯ç»™ç¬¬ä¸‰æ–¹åº”ç”¨;</p>\n<pre><code>+--------+                               +---------------+\n|        |--(A)- Authorization Request -&gt;|   Resource    |\n|        |                               |     Owner     |\n|        |&lt;-(B)-- Authorization Grant ---|               |\n|        |                               +---------------+\n|        |\n|        |                               +---------------+\n|        |--(C)-- Authorization Grant --&gt;| Authorization |\n| Client |                               |     Server    |\n|        |&lt;-(D)----- Access Token -------|               |\n|        |                               +---------------+\n|        |\n|        |                               +---------------+\n|        |--(E)----- Access Token ------&gt;|    Resource   |\n|        |                               |     Server    |\n|        |&lt;-(F)--- Protected Resource ---|               |\n+--------+                               +---------------+\n\n                Figure 1: Abstract Protocol Flow\n\n</code></pre>\n<ol>\n<li>\n<p>èµ„æºæ‹¥æœ‰è€…ï¼ˆresource ownerï¼‰: èƒ½æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºçš„ä¸€ä¸ªå®ä½“, å¯ä»¥æ˜¯ä¸€ä¸ªäºº, é‚£æˆ‘ä»¬ç§°ä¹‹ä¸ºæœ€ç»ˆç”¨æˆ·<strong>ä¸€èˆ¬ä¸ºä¸ªäººç”¨æˆ·</strong>;</p>\n</li>\n<li>\n<p>èµ„æºæœåŠ¡å™¨ï¼ˆresource serverï¼‰: å­˜å‚¨å—ä¿æŠ¤èµ„æº, å®¢æˆ·ç«¯é€šè¿‡access tokenè¯·æ±‚èµ„æº,<br />\nèµ„æºæœåŠ¡å™¨å“åº”å—ä¿æŠ¤èµ„æºç»™å®¢æˆ·ç«¯(<strong>å­˜å‚¨å¹¶å“åº”ç»™æœ‰æƒé™è®¿é—®å®¢æˆ·ç«¯ çš„æœåŠ¡å™¨, æ¯”å¦‚ç”¨æˆ·ä¸Šä¼ çš„ç§æœ‰ç›¸å†Œ</strong>);</p>\n</li>\n<li>\n<p>æˆæƒæœåŠ¡å™¨ï¼ˆauthorization serverï¼‰: æˆåŠŸéªŒè¯èµ„æºæ‹¥æœ‰è€…å¹¶è·å–æˆæƒä¹‹å,<br />\næˆæƒæœåŠ¡å™¨é¢å‘æˆæƒä»¤ç‰Œï¼ˆAccess Tokenï¼‰ç»™å®¢æˆ·ç«¯(<strong>è´Ÿè´£è®¤è¯å¹¶æˆæƒç»™å®¢æˆ·ç«¯</strong>);</p>\n</li>\n<li>\n<p>å®¢æˆ·ç«¯ï¼ˆclientï¼‰: ç¬¬ä¸‰æ–¹åº”ç”¨, ä¹Ÿå¯ä»¥æ˜¯å®ƒè‡ªå·±çš„å®˜æ–¹åº”ç”¨; å…¶æœ¬èº«ä¸å­˜å‚¨èµ„æº,<br />\nè€Œæ˜¯èµ„æºæ‹¥æœ‰è€…æˆæƒé€šè¿‡å, ä½¿ç”¨å®ƒçš„æˆæƒï¼ˆæˆæƒä»¤ç‰Œï¼‰è®¿é—®å—ä¿æŠ¤èµ„æº, ç„¶åå®¢æˆ·ç«¯æŠŠç›¸åº”çš„æ•°æ®å±•ç¤ºå‡ºæ¥/æäº¤åˆ°æœåŠ¡å™¨;<br />\n(<strong>ä¸€ä¸ªå¾®æœåŠ¡,æˆ–è€…è¯´ä»¥ä¸€ä¸ªç‹¬ç«‹çš„åº”ç”¨, æˆ–æ‰‹æœºæˆ–web..</strong>)</p>\n</li>\n</ol>\n<h2 id=\"oauth20-æˆæƒæ–¹å¼\">OAuth2.0 æˆæƒæ–¹å¼</h2>\n<p>å®¢æˆ·ç«¯å¿…é¡»å¾—åˆ°ç”¨æˆ·çš„æˆæƒï¼ˆauthorization grantï¼‰, æ‰èƒ½è·å¾—ä»¤ç‰Œï¼ˆaccess tokenï¼‰;</p>\n<p>OAuth 2.0å®šä¹‰äº†å››ç§æˆæƒæ–¹å¼;</p>\n<p>æˆæƒç æ¨¡å¼ï¼ˆauthorization codeï¼‰<br />\nç®€åŒ–æ¨¡å¼ï¼ˆimplicitï¼‰<br />\nå¯†ç æ¨¡å¼ï¼ˆresource owner password credentialsï¼‰<br />\nå®¢æˆ·ç«¯æ¨¡å¼ï¼ˆclient credentialsï¼‰</p>\n<p>å‚è€ƒ: <a href=\"http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html\" rel=\"noopener nofollow\" target=\"_blank\">ç†è§£OAuth 2.0</a></p>\n<p>Spring Security OAuth æ˜¯å»ºç«‹åœ¨ Spring Security çš„åŸºç¡€ä¹‹ä¸Š OAuth2.0 åè®®å®ç°çš„ä¸€ä¸ªç±»åº“,<br />\nå®ƒæä¾›äº†æ„å»º<strong>Authorization****Server, Resource Server</strong> å’Œ<strong>Client</strong> ä¸‰ç§ Spring åº”ç”¨ç¨‹åºè§’è‰²æ‰€éœ€è¦çš„åŠŸèƒ½;</p>\n<blockquote>\n<p>è‡³å°‘ä¾èµ–, å½“ç„¶æ•°æ®åº“å­˜å‚¨å®ç°è¿˜éœ€è¦Jdbc etc..</p>\n</blockquote>\n<pre><code class=\"language-xml\">&lt;dependency&gt;\n&nbsp;&nbsp; &nbsp;&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n&nbsp;&nbsp; &nbsp;&lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt;\n&nbsp;&lt;/dependency&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n  &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n<h2 id=\"æˆæƒæœåŠ¡è§’è‰²\">æˆæƒæœåŠ¡è§’è‰²</h2>\n<p>spring oa2 æä¾› <code>AuthorizationServerConfigurerAdapter</code> é…ç½®é€‚é…å™¨ç±», æ¥é…ç½®æˆæƒæœåŠ¡ç«¯è§’è‰²<br />\né€šå¸¸çš„åšæ³•æ˜¯ åˆ›å»ºä¸€ä¸ªé…ç½®ç±» ç»§æ‰¿è‡ª<code>AuthorizationServerConfigurerAdapter</code>,</p>\n<p>è¿˜æœ‰éœ€è¦<code>@EnableAuthorizationServer</code>æ³¨è§£è¡¨æ˜å®ƒæ˜¯ä¸€ä¸ª oauthæˆæƒæœåŠ¡å™¨,</p>\n<p>è¿™ä¸ªæ³¨è§£åŠ å“ªéƒ½è¡Œ,åªè¦æ˜¯é…springç®¡ç†çš„bean, å»ºè®®æ˜¯åŠ åœ¨è¿™ä¸ªé…ç½®ç±»é‡Œé¢,æ–¹ä¾¿åˆ†ç±»</p>\n<p>è¯¥æ³¨è§£å¯¼å…¥äº†ä¸¤ä¸ªé…ç½®ç±»<code>@Import({AuthorizationServerEndpointsConfiguration.class, AuthorizationServerSecurityConfiguration.class})</code>åé¢ç ”ç©¶..</p>\n<p>ç¤ºä¾‹å¦‚ä¸‹:</p>\n<pre><code class=\"language-java\">@Configuration\n@EnableAuthorizationServer\npublic class AuthorizationServerConfiguration  extends AuthorizationServerConfigurerAdapter {\n  @Override\n\tpublic void configure(AuthorizationServerSecurityConfigurer security) throws Exception {\n\t}\n\n\t@Override\n\tpublic void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n\t}\n\n\t@Override\n\tpublic void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {\n\t}\n}\n</code></pre>\n<p>ç°åœ¨æ¥ç ”ç©¶è¿™ä¸‰ä¸ªé…ç½®:</p>\n<h3 id=\"authorizationserversecurityconfigurer\">AuthorizationServerSecurityConfigurer</h3>\n<p>AuthorizationServerSecurityConfigurer: ç”¨æ¥é…ç½®ä»¤ç‰Œç«¯ç‚¹çš„å®‰å…¨çº¦æŸ; ç®€å•è¯´é…ç½®å¦‚ä¸‹ä»¤ç‰Œç«¯ç‚¹çš„å®‰å…¨è§„åˆ™</p>\n<pre><code class=\"language-s\">/oauth/authorize: æˆæƒç«¯ç‚¹; \n/oauth/token: ä»¤ç‰Œç«¯ç‚¹; \n/oauth/confirm_access: ç”¨æˆ·ç¡®è®¤æˆæƒæäº¤ç«¯ç‚¹; \n/oauth/error: æˆæƒæœåŠ¡é”™è¯¯ä¿¡æ¯ç«¯ç‚¹; \n/oauth/check_token: ç”¨äºèµ„æºæœåŠ¡è®¿é—®çš„ä»¤ç‰Œè§£æç«¯ç‚¹; \n/oauth/token_key: æä¾›å…¬æœ‰å¯†åŒ™çš„ç«¯ç‚¹, å¦‚æœä½ ä½¿ç”¨JWTä»¤ç‰Œçš„è¯; \n</code></pre>\n<p>ä¾‹å¦‚ <code>security.sslOnly()</code> æ–¹æ³•é…ç½®, åªå…è®¸httpsè®¿é—®è¿™äº›ç«¯ç‚¹, demoæ²¡å•¥å¥½é…ç½®çš„.</p>\n<h4 id=\"demoä»£ç \">demoä»£ç </h4>\n<pre><code class=\"language-java\">  /**\n    * AuthorizationServerSecurityConfigurer: ç”¨æ¥é…ç½®ä»¤ç‰Œç«¯ç‚¹çš„å®‰å…¨çº¦æŸ; \n    */\n  @Override\n  public void configure(AuthorizationServerSecurityConfigurer security) throws Exception {\n      security.tokenKeyAccess(\"permitAll()\")\n\t        \t.checkTokenAccess(\"permitAll()\");//å…è®¸æ¥å£/oauth/check_token è¢«è°ƒç”¨\n      security.allowFormAuthenticationForClients();     //å…è®¸è¡¨å•è®¤è¯\n  }\n</code></pre>\n<blockquote>\n<p>éœ€è¦æ³¨æ„ä¸€ä¸‹ <code>tokenKeyAccess</code>å’Œ<code>checkTokenAccess</code> å…è®¸è¢«è®¿é—®, ä¸ç„¶æ— æ³•æ£€æŸ¥toket(401)</p>\n</blockquote>\n<h3 id=\"clientdetailsserviceconfigurer\">ClientDetailsServiceConfigurer</h3>\n<p><code>ClientDetailsServiceConfigurer</code> å®šä¹‰é…ç½®å®¢æˆ·ç«¯çš„è¯¦ç»†é…ç½®, æœ‰å‡ ä¸ªé‡è¦çš„å±æ€§å¦‚ä¸‹åˆ—è¡¨:</p>\n<pre><code class=\"language-s\">clientId: ï¼ˆå¿…é¡»çš„ï¼‰ç”¨æ¥æ ‡è¯†å®¢æˆ·çš„Id; \nsecret: ï¼ˆéœ€è¦å€¼å¾—ä¿¡ä»»çš„å®¢æˆ·ç«¯ï¼‰å®¢æˆ·ç«¯å®‰å…¨ç , å¦‚æœæœ‰çš„è¯; \nscope: ç”¨æ¥é™åˆ¶å®¢æˆ·ç«¯çš„è®¿é—®èŒƒå›´, å¦‚æœä¸ºç©ºï¼ˆé»˜è®¤ï¼‰çš„è¯, é‚£ä¹ˆå®¢æˆ·ç«¯æ‹¥æœ‰å…¨éƒ¨çš„è®¿é—®èŒƒå›´; \nauthorizedGrantTypes: æ­¤å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨çš„æˆæƒç±»å‹, é»˜è®¤ä¸ºç©º; (æˆæƒç±»å‹ å‚è€ƒoauth2.0çš„è§„èŒƒ)\nauthorities: æ­¤å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨çš„æƒé™ï¼ˆåŸºäºSpring Security authoritiesï¼‰; \n</code></pre>\n<p>å®¢æˆ·ç«¯è¯¦ç»†ä¿¡æ¯å¯ä¿å­˜åˆ°æ•°æ®åº“,å†é€šè¿‡æ•°æ®åº“åˆå§‹åŒ–, <code>new JdbcClientDetailsService(dataSource);</code>,<br />\nå®ƒéœ€è¦è¡¨<code>oauth_client_details</code> spring oauth2 æ‰€æœ‰é»˜è®¤è¡¨å‚è€ƒæœ«å°¾<strong>spring OAuth2 é»˜è®¤çš„è¡¨ç»“æ„</strong></p>\n<pre><code class=\"language-sql\">create table oauth_client_details (\n  client_id VARCHAR(256) PRIMARY KEY,\n  resource_ids VARCHAR(256),\n  client_secret VARCHAR(256),\n  scope VARCHAR(256),\n  authorized_grant_types VARCHAR(256),\n  web_server_redirect_uri VARCHAR(256),\n  authorities VARCHAR(256),\n  access_token_validity INTEGER,\n  refresh_token_validity INTEGER,\n  additional_information VARCHAR(4096),\n  autoapprove VARCHAR(256)\n);\n</code></pre>\n<h4 id=\"demoä»£ç -1\">demoä»£ç </h4>\n<pre><code class=\"language-java\">  /**\n    * ClientDetailsServiceConfigurer\n    * å®šä¹‰å®¢æˆ·è¯¦ç»†ä¿¡æ¯æœåŠ¡çš„é…ç½®å™¨; å®¢æˆ·ç«¯è¯¦ç»†ä¿¡æ¯å¯ä»¥è¢«åˆå§‹åŒ–, æˆ–è€…æ‚¨å¯ä»¥ç›´æ¥å¼•ç”¨ä¸€ä¸ªç°æœ‰çš„å­˜å‚¨; \n    */\n  @Override\n  public void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n    /** å¼•ç”¨å­˜å‚¨å®ç°\n      * clients.withClientDetails(clientDetails());\n      */\n    //dome ä½¿ç”¨å†…å­˜ ä¸¤ä¸ªå®¢æˆ·ç«¯ ä¸€ä¸ªä½¿ç”¨ authorization_code è®¤è¯, ä¸€ä¸ªä½¿ç”¨password è®¤è¯\n    clients.inMemory() \n          .withClient(\"client_abc\") // client_id\n          .secret(\"client_abc_s\") // client_secret\n          \n          /** è¯¥clientå…è®¸çš„æˆæƒç±»å‹&lt;br&gt;\n            * authorization_code: æˆæƒç ç±»å‹; \n            * implicit: éšå¼æˆæƒç±»å‹; \n            * password: èµ„æºæ‰€æœ‰è€…ï¼ˆå³ç”¨æˆ·ï¼‰å¯†ç ç±»å‹; \n            * client_credentials: å®¢æˆ·ç«¯å‡­æ®ï¼ˆå®¢æˆ·ç«¯IDä»¥åŠKeyï¼‰ç±»å‹; \n            * refresh_token: é€šè¿‡ä»¥ä¸Šæˆæƒè·å¾—çš„åˆ·æ–°ä»¤ç‰Œæ¥è·å–æ–°çš„ä»¤ç‰Œ; \n            */\n          .authorizedGrantTypes(\"authorization_code\") \n          .scopes(\"app\") // å…è®¸çš„æˆæƒèŒƒå›´\n    .and()\n      .withClient(\"client_pss\")\n      .secret(\"client_pss_c\")\n      .authorizedGrantTypes(\"password\") \n      .scopes(\"app\"); // å…è®¸çš„æˆæƒèŒƒå›´\n      \n  }\n  @Bean\n  public ClientDetailsService clientDetails() {\n      return new JdbcClientDetailsService(dataSource);\n  }\n</code></pre>\n<h3 id=\"authorizationserverendpointsconfigurer\">AuthorizationServerEndpointsConfigurer</h3>\n<p>AuthorizationServerEndpointsConfigurer: ç”¨æ¥é…ç½®æˆæƒä»¥åŠä»¤ç‰Œçš„è®¿é—®ç«¯ç‚¹å’Œä»¤ç‰ŒæœåŠ¡, æ¯”å¦‚: é…ç½®ä»¤ç‰Œçš„ç­¾åä¸å­˜å‚¨æ–¹å¼</p>\n<pre><code class=\"language-java\">  /**\n    * AuthorizationServerSecurityConfigurer: ç”¨æ¥é…ç½®ä»¤ç‰Œç«¯ç‚¹çš„å®‰å…¨çº¦æŸ; \n    */\n  @Override\n  public void configure(AuthorizationServerSecurityConfigurer security) throws Exception {\n      /**\n        * æŒ‡å®štoket å­˜å‚¨\n        * endpoints.tokenStore(redisTokenStore())\n        * endpoints.tokenStore(jdbcTokenStore() );\n        */\n      endpoints.tokenStore(jdbcTokenStore() );\n      /**\n        * password ç±»å‹è¿˜éœ€è¦è®¾ç½® authenticationManager\n        */\n      endpoints.userDetailsService(userDetailsServiceImpl );\n      endpoints.authenticationManager(authenticationManager);\n\n  }\n</code></pre>\n<blockquote>\n<p>éœ€è¦æ³¨æ„ä¸€ä¸‹ <code>tokenKeyAccess</code>å’Œ<code>checkTokenAccess</code> å…è®¸è¢«è®¿é—®, ä¸ç„¶æ— æ³•æ£€æŸ¥toket</p>\n</blockquote>\n<h4 id=\"ä»¤ç‰Œçš„ç”Ÿæˆæ–¹å¼\">ä»¤ç‰Œçš„ç”Ÿæˆæ–¹å¼</h4>\n<p><code>tokenGranter</code>å±æ€§å¯¹è±¡,<br />\nè¿™ä¸ªå±æ€§å°±å¾ˆç‰›Bäº†, å½“ä½ è®¾ç½®äº†è¿™ä¸ªä¸œè¥¿ï¼ˆå³ TokenGranter æ¥å£å®ç°ï¼‰, é‚£ä¹ˆæˆæƒå°†ä¼šäº¤ç”±ä½ æ¥å®Œå…¨æŒæ§, å¹¶ä¸”ä¼šå¿½ç•¥æ‰ä¸Šé¢çš„è¿™å‡ ä¸ªå±æ€§, è¿™ä¸ªå±æ€§ä¸€èˆ¬æ˜¯ç”¨ä½œæ‹“å±•ç”¨é€”çš„, å³æ ‡å‡†çš„å››ç§æˆæƒæ¨¡å¼å·²ç»æ»¡è¶³ä¸äº†ä½ çš„éœ€æ±‚çš„æ—¶å€™, æ‰ä¼šè€ƒè™‘ä½¿ç”¨è¿™ä¸ª;</p>\n<h4 id=\"ä»¤ç‰Œçš„å­˜å‚¨æ–¹å¼\">ä»¤ç‰Œçš„å­˜å‚¨æ–¹å¼</h4>\n<p><code>tokenStore</code>å±æ€§å¯¹è±¡,é»˜è®¤æƒ…å†µéªŒè¯çš„toketä¼šä¿å­˜åœ¨å†…å­˜ä¸­, è¿™æ ·å½“æœåŠ¡å™¨é‡å¯æ˜¯, ä¼šå¯¼è‡´æ‰€æœ‰toketæ— æ•ˆ;<br />\nåœ¨æ­¤å¯ä»¥é…ç½® å°†toketå­˜å‚¨åˆ°æ•°æ®åº“æˆ–è€…redis</p>\n<blockquote>\n<p>é…ç½®ä»£ç </p>\n</blockquote>\n<pre><code class=\"language-java\">    //endpoints.tokenStore(redisTokenStore())\n    endpoints.tokenStore(jdbcTokenStore() );\n    /**\n    * tokenå­˜å‚¨æ•°æ®åº“\n    */\n    @Bean\n    public JdbcTokenStore jdbcTokenStore(){\n        return new JdbcTokenStore(dataSource);\n    }\n     /**\n      *  tokenå­˜å‚¨redis\n      */\n    @Autowired\n    private RedisConnectionFactory redisConnectionFactory;\n    @Bean\n    RedisTokenStore redisTokenStore(){\n        return new RedisTokenStore(redisConnectionFactory);\n    }\n</code></pre>\n<blockquote>\n<p>JDBC å®ƒéœ€è¦è¡¨<code>oauth_client_details</code> spring oauth2 æ‰€æœ‰é»˜è®¤è¡¨å‚è€ƒæœ«å°¾<strong>spring OAuth2 é»˜è®¤çš„è¡¨ç»“æ„</strong></p>\n</blockquote>\n<pre><code class=\"language-sql\">  create table oauth_client_token (\n    token_id VARCHAR(256),\n    token LONG VARBINARY,\n    authentication_id VARCHAR(256) PRIMARY KEY,\n    user_name VARCHAR(256),\n    client_id VARCHAR(256)\n  );\n</code></pre>\n<h4 id=\"ä»¤ç‰Œçš„è®¿é—®ç«¯ç‚¹\">ä»¤ç‰Œçš„è®¿é—®ç«¯ç‚¹</h4>\n<p>AuthorizationServerEndpointsConfigurer è¿™ä¸ªé…ç½®å¯¹è±¡(AuthorizationServerConfigurer çš„ä¸€ä¸ªå›è°ƒé…ç½®é¡¹<br />\næœ‰ä¸€ä¸ªå«åš pathMapping() çš„æ–¹æ³•ç”¨æ¥é…ç½®ç«¯ç‚¹URLé“¾æ¥, å®ƒæœ‰ä¸¤ä¸ªå‚æ•°:<br />\nç¬¬ä¸€ä¸ªå‚æ•°: String ç±»å‹çš„, è¿™ä¸ªç«¯ç‚¹URLçš„é»˜è®¤é“¾æ¥;<br />\nç¬¬äºŒä¸ªå‚æ•°: String ç±»å‹çš„, ä½ è¦è¿›è¡Œæ›¿ä»£çš„URLé“¾æ¥;<br />\nä»¥ä¸Šçš„å‚æ•°éƒ½å°†ä»¥ \"/\" å­—ç¬¦ä¸ºå¼€å§‹çš„å­—ç¬¦ä¸², æ¡†æ¶çš„é»˜è®¤URLé“¾æ¥å¦‚ä¸‹åˆ—è¡¨, å¯ä»¥ä½œä¸ºè¿™ä¸ª pathMapping() æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°:</p>\n<pre><code class=\"language-s\">  /oauth/authorize: æˆæƒç«¯ç‚¹; \n  /oauth/token: ä»¤ç‰Œç«¯ç‚¹; \n  /oauth/confirm_access: ç”¨æˆ·ç¡®è®¤æˆæƒæäº¤ç«¯ç‚¹; \n  /oauth/error: æˆæƒæœåŠ¡é”™è¯¯ä¿¡æ¯ç«¯ç‚¹; \n  /oauth/check_token: ç”¨äºèµ„æºæœåŠ¡è®¿é—®çš„ä»¤ç‰Œè§£æç«¯ç‚¹; \n  /oauth/token_key: æä¾›å…¬æœ‰å¯†åŒ™çš„ç«¯ç‚¹, å¦‚æœä½ ä½¿ç”¨JWTä»¤ç‰Œçš„è¯; \n</code></pre>\n<h4 id=\"passwordè®¤è¯æ–¹å¼\">passwordè®¤è¯æ–¹å¼</h4>\n<p>è¯·æ³¨æ„å¦‚æœæ˜¯<code>password</code>éªŒè¯æ–¹å¼, é‚£å¿…é¡»è¦åœ¨æ­¤æ³¨å…¥ <code>AuthenticationManager </code> é…ç½®å¯¹è±¡</p>\n<pre><code class=\"language-java\">endpoints.userDetailsService(userDetailsServiceImpl );\nendpoints.authenticationManager(authenticationManager);\n</code></pre>\n<h4 id=\"å…¶ä»–å±æ€§\">å…¶ä»–å±æ€§</h4>\n<p><code>authorizationCodeServices</code>: è¿™ä¸ªå±æ€§æ˜¯ç”¨æ¥è®¾ç½®æˆæƒç æœåŠ¡çš„ï¼ˆå³ AuthorizationCodeServices çš„å®ä¾‹å¯¹è±¡ï¼‰*<strong>ä¸»è¦ç”¨äº \"authorization_code\" æˆæƒç ç±»å‹æ¨¡å¼</strong></p>\n<h3 id=\"demoä»£ç -2\">demoä»£ç </h3>\n<pre><code class=\"language-java\">  /**\n    * AuthorizationServerEndpointsConfigurer: ç”¨æ¥é…ç½®æˆæƒä»¥åŠä»¤ç‰Œçš„è®¿é—®ç«¯ç‚¹å’Œä»¤ç‰ŒæœåŠ¡ï¼ˆæ¯”å¦‚: é…ç½®ä»¤ç‰Œçš„ç­¾åä¸å­˜å‚¨æ–¹å¼ï¼‰\n    * \n   **/\n  @Override\n  public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {\n    /**\n      * æŒ‡å®štoket å­˜å‚¨\n      * endpoints.tokenStore(redisTokenStore())\n      * endpoints.tokenStore(jdbcTokenStore() );\n      */\n    endpoints.tokenStore(jdbcTokenStore() );\n    /**\n      * password ç±»å‹è¿˜éœ€è¦è®¾ç½® authenticationManager\n      */\n    endpoints.userDetailsService(userDetailsServiceImpl );\n    endpoints.authenticationManager(authenticationManager);\n  }\n  /**\n    * tokenå­˜å‚¨æ•°æ®åº“\n    */\n  @Bean\n  public JdbcTokenStore jdbcTokenStore(){\n      return new JdbcTokenStore(dataSource);\n  }\n  \n  /**\n    *  tokenå­˜å‚¨redis\n    \n  @Autowired\n  private RedisConnectionFactory redisConnectionFactory;\n  @Bean\n  RedisTokenStore redisTokenStore(){\n      return new RedisTokenStore(redisConnectionFactory);\n  }\n    */\n    \n\n</code></pre>\n<h3 id=\"å¦å¤–æˆæƒæœåŠ¡ç«¯çš„é…ç½®-spring-security\">å¦å¤–æˆæƒæœåŠ¡ç«¯çš„é…ç½® spring security</h3>\n<pre><code class=\"language-java\">@Configuration\n@EnableWebSecurity\n@EnableGlobalMethodSecurity(prePostEnabled = true)\npublic class WebSecurityConfig extends WebSecurityConfigurerAdapter {\n    //spring Security 5.0 ä¹‹åå¿…é¡»æŒ‡å®šå¯†ç åŠ å¯†è§„åˆ™, ä¸ç„¶ä¼šæŠ¥é”™\n    @Bean\n    public static NoOpPasswordEncoder passwordEncoder() {\n        return (NoOpPasswordEncoder) NoOpPasswordEncoder.getInstance();\n    }\n\n\t@Override\n\tprotected void configure(HttpSecurity http) throws Exception {\n//\t\thttp\n//\t\t\t.authorizeRequests()\n//\t\t\t.antMatchers(\"/oauth/**\").permitAll()//oauth å¼€æ”¾çš„èµ„æº\n//\t\t\t.anyRequest().authenticated()\n//\t\t\t.and()\n//\t\t\t// è®¾ç½®ç™»é™†é¡µ\n//\t\t\t.formLogin().and().logout().permitAll();\n\t\t http\n         .requestMatchers().anyRequest()\n         .and()\n             .authorizeRequests()\n             .antMatchers(\"/oauth/*\").permitAll();//oauth å¼€æ”¾çš„èµ„æº\n\t\t// å…³é—­CSRFè·¨åŸŸ\n\t\thttp.csrf().disable();\n\n\t}\n\t\n\t@Override\n  @Bean\n  public AuthenticationManager authenticationManagerBean() throws Exception {\n      return super.authenticationManagerBean();\n  }\n\n}\n\n</code></pre>\n<p><code>AuthenticationManager</code> beanä¹Ÿæ˜¯åœ¨è¿™é‡Œé…ç½®</p>\n<p><strong>å†å¦å¤– <code>UserDetailsService</code> ç®€å•å†™æ­»å†ä»£ç </strong></p>\n<pre><code class=\"language-java\">@Service\npublic class UserDetailsServiceImpl implements UserDetailsService{\n\n\t@Override\n\tpublic UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n\t\t// TODO Auto-generated method stub\n\t\tif(\"admin\".equals(username) ) {\n\t\t\treturn new UserDetailsImpl(\"admin\",\"123\");\n\t\t}\n\t\tthrow new  UsernameNotFoundException(username);\n\t}\n\n}\n\n</code></pre>\n<h2 id=\"èµ„æºæœåŠ¡è§’è‰²\">èµ„æºæœåŠ¡è§’è‰²</h2>\n<p>spring oa2 æä¾› <code>ResourceServerConfiguration</code> é…ç½®é€‚é…å™¨ç±», æ¥é…ç½®èµ„æºæœåŠ¡ç«¯è§’è‰²<br />\né€šå¸¸çš„åšæ³•æ˜¯ åˆ›å»ºä¸€ä¸ªé…ç½®ç±» ç»§æ‰¿è‡ª<code>ResourceServerConfiguration</code>,</p>\n<p>è¿˜æœ‰éœ€è¦<code>@EnableResourceServer</code>æ³¨è§£è¡¨æ˜å®ƒæ˜¯ä¸€ä¸ª oauth èµ„æºæœåŠ¡å™¨</p>\n<pre><code class=\"language-java\">@Configuration\n@EnableResourceServer \npublic class ResourceServerConfiguration extends ResourceServerConfigurerAdapter  {\n  \t@Override\n\tpublic void configure(ResourceServerSecurityConfigurer resources) throws Exception {\n\t}\n\n\t@Override\n\tpublic void configure(HttpSecurity http) throws Exception {\n\t\thttp.authorizeRequests().anyRequest().authenticated();\n\t}\n}\n</code></pre>\n<p>ç°åœ¨æ¥ç ”ç©¶è¿™ä¸¤ä¸ªé…ç½®:</p>\n<h3 id=\"resourceserversecurityconfigurer\">ResourceServerSecurityConfigurer</h3>\n<h4 id=\"demoä»£ç -3\">demoä»£ç </h4>\n<p><code>resource_id</code> å³æ˜¯æˆæƒç«¯ <code>ClientDetailsServiceConfigurer</code>é…ç½®çš„å®¢æˆ·ç«¯ID</p>\n<pre><code class=\"language-java\">\t@Value(\"${security.oauth2.resource.id}\")\n\tString resource_id;\n\n\t@Override\n\tpublic void configure(ResourceServerSecurityConfigurer resources) throws Exception {\n\t\t  resources.resourceId(resource_id).stateless(true);\n\t}\n</code></pre>\n<p>åœ¨æ­¤æä¸€ä¸‹ <code>ResourceServerSecurityConfigurer</code> çš„ <code>tokenServices</code> å±æ€§, ç”¨äºé…ç½®æˆæƒæœåŠ¡çš„ä¿¡æ¯, é€‚ç”¨èµ„æºä¸æˆæƒåˆ†ç¦»</p>\n<h3 id=\"httpsecurity\">HttpSecurity</h3>\n<h3 id=\"demoä»£ç -4\">demoä»£ç </h3>\n<pre><code class=\"language-JAVA\">@Configuration\n@EnableResourceServer \npublic class ResourceServerConfiguration extends ResourceServerConfigurerAdapter  {\n\t\n\t@Value(\"${security.oauth2.resource.id}\")\n\tString resource_id;\n\t@Override\n\tpublic void configure(ResourceServerSecurityConfigurer resources) throws Exception {\n\t\t  resources.resourceId(resource_id).stateless(true);\n\t}\n\t@Override\n\tpublic void configure(HttpSecurity http) throws Exception {\n    \thttp\n\t        .antMatcher(\"/protect/**\").authorizeRequests()\n\t        .anyRequest().permitAll();\n          /*\n\t\t  http\n\t        .requestMatchers().anyRequest()\n\t        .and()\n\t        .anonymous()\n\t        .and()\n\t        .authorizeRequests()\n//\t\t\t.antMatchers(\"/protect/**\").access(\"#oauth2.hasScope('app') and hasRole('ROLE_USER')\")\n\t\t\t.antMatchers(\"/protect/**\").authenticated();\n      */\n\t}\n\t\n}\n\n</code></pre>\n<h4 id=\"permitall-å’Œ-anonymous\">permitAll å’Œ anonymous</h4>\n<p><code>permitAll()</code> æ–¹æ³•æŒ‡æ‰€æœ‰ç™»å½•å’Œæœªç™»å½•äººå‘˜éƒ½å¯ä»¥è®¿é—®, è¿™ä¸ªä¼šç»è¿‡ security filter<br />\n<code>anonymous()</code> æ‰€æœ‰äººéƒ½èƒ½è®¿é—®, ä½†æ˜¯è¿™ä¸ªä¸ä¼šç»è¿‡  security filter</p>\n<h3 id=\"å—ä¿æŠ¤çš„èµ„æº\">å—ä¿æŠ¤çš„èµ„æº</h3>\n<pre><code class=\"language-java\">@RestController\n@RequestMapping(\"/protect\")\npublic class IndexController {\n\t\n\t@RequestMapping(\"/hi\")\n\tpublic Map&lt;String,String&gt; getForMap(String uri){\n\t\tMap&lt;String, String&gt; ret = new HashMap&lt;String, String&gt;();\n\t\tret.put(\"hi\", \"è¿™æ˜¯å—ä¿æŠ¤çš„èµ„æº\");\n\t\treturn ret;\n\t\t\n\t}\n\t\n}\n\n</code></pre>\n<h2 id=\"æµ‹è¯•æˆæƒç æ–¹å¼\">æµ‹è¯•æˆæƒç æ–¹å¼</h2>\n<h3 id=\"å®¢æˆ·ç«¯è·å–æˆæƒcode\">å®¢æˆ·ç«¯è·å–æˆæƒcode</h3>\n<p><strong>Get è®¿é—®</strong><br />\n<code>127.0.0.1:8802/oauth/authorize?client_id=client_abc&amp;client_secret=client_abc_s&amp;response_type=code&amp;redirect_uri=http://www.baidu.com</code></p>\n<p>å¦‚æœæœªç™»é™† -&gt; ä¼šè¢«<code>WebSecurityConfig</code>çš„å®‰å…¨è¿‡æ»¤æ‹¦æˆªåˆ°,è·³è½¬åˆ°ç™»é™†ç•Œé¢(èµ°ä¸€èˆ¬çš„spring securityæµç¨‹), -&gt; ç™»é™†æˆåŠŸå -&gt;è·³è½¬ Approval ç”¨æˆ·æˆæƒé¡µé¢ -&gt; å¦‚æœç”¨æˆ·åŒæ„æˆæƒ -&gt; å°†ä¼šé‡å®šå‘åˆ°<code>http://www.baidu.com/?code=Dwps7B</code> codeæ˜¯ç”¨äºç”³è¯·toketçš„æˆæƒç </p>\n<blockquote>\n<p>å¦‚æœæŠ¥é”™: <code>User must be authenticated with Spring Security before authorization can be completed.</code></p>\n</blockquote>\n<p>åŸå› æ˜¯è¢«spring security æ‹¦æˆªäº†,<code>WebSecurityConfig</code>çš„<code>HttpSecurity</code>é…ç½®å¼€æ”¾<code>\t.antMatchers(\"/oauth/**\").permitAll()</code> URLå¹¶æ²¡æœ‰ç”Ÿæ•ˆ,<br />\nå†åŸå› æ˜¯: è¯¥ä¾‹,å³æ˜¯æˆæƒæœåŠ¡å™¨,åˆæ˜¯èµ„æºæœåŠ¡å™¨, <code>ResourceServerConfiguration</code> çš„é…ç½®è¿‡æ»¤å™¨(order=3)ä¼˜å…ˆäº<code>WebSecurityConfig</code>@Order(100)</p>\n<p><code>HttpSecurity.antMatcher(Stiring ...)</code>//è¿™ä¸ªæ–¹æ³•,<strong>ä»…åœ¨åŒ¹é…è¯¥uriæ—¶è¿™ä¸ªè¿‡æ»¤å™¨æ‰ä¼šè°ƒç”¨(æˆ–è€…ç”Ÿæ•ˆ)</strong></p>\n<pre><code class=\"language-java\">\t@Override\n\tpublic void configure(HttpSecurity http) throws Exception {\n\t\thttp\n\t        .antMatcher(\"/protect/**\").authorizeRequests()\n\t        .anyRequest().permitAll();\n\t}\n</code></pre>\n<h3 id=\"æ ¹æ®codeè·å–toket\">æ ¹æ®codeè·å–toket</h3>\n<p><strong>Post è®¿é—®</strong><br />\n<code>127.0.0.1:8802/oauth/token?client_id=client_abc&amp;client_secret=client_abc_s&amp;grant_type=authorization_code&amp;redirect_uri=http://www.baidu.com&amp;code=Dwps7B</code></p>\n<p>ä»¥postè®¿é—®é™„åŠ code ç”³è¯·toket:</p>\n<pre><code class=\"language-json\">{\n    \"access_token\": \"21bc25aa-2aa0-4f81-a6b6-5733081aa2af\",\n    \"token_type\": \"bearer\",\n    \"expires_in\": 43199,//è¿‡æœŸæ—¶é—´\n    \"scope\": \"app\"\n}\n</code></pre>\n<h3 id=\"æ ¹æ®toketè®¿é—®å—ä¿æŠ¤çš„èµ„æº\">æ ¹æ®toketè®¿é—®å—ä¿æŠ¤çš„èµ„æº</h3>\n<p><strong>Get è®¿é—®</strong><br />\n<code>127.0.0.1:8802/protect/hi?access_token=21bc25aa-2aa0-4f81-a6b6-5733081aa2af</code></p>\n<pre><code class=\"language-json\">{\n    \"hi\": \"è¿™æ˜¯å—ä¿æŠ¤çš„èµ„æº\"\n}\n</code></pre>\n<p>å¦‚æœæ²¡æœ‰toket,æˆ–è€…é”™è¯¯toket,<code>ResourceServerConfiguration</code>é…ç½®å®‰å…¨æ‹¦æˆªåˆ°.</p>\n<h3 id=\"æ£€æŸ¥toketæœ‰æ•ˆæ€§\">æ£€æŸ¥toketæœ‰æ•ˆæ€§</h3>\n<p><strong>Get è®¿é—®</strong><br />\n<code>127.0.0.1:8802/oauth/check_token?token=21bc25aa-2aa0-4f81-a6b6-5733081aa2af</code></p>\n<pre><code class=\"language-json\">{\n    \"active\": true,\n    \"exp\": 1558725020,\n    \"user_name\": \"admin\",\n    \"client_id\": \"client_abc\",\n    \"scope\": [\n        \"app\"\n    ]\n}\n</code></pre>\n<h2 id=\"èµ„æºæœåŠ¡ä¸æˆæƒæœåŠ¡åˆ†ç¦»\">èµ„æºæœåŠ¡ä¸æˆæƒæœåŠ¡åˆ†ç¦»</h2>\n<p>ä¸Šèµ„æºæœåŠ¡é…ç½®æè¿‡: <code>ResourceServerSecurityConfigurer</code></p>\n<blockquote>\n<p>åœ¨æ­¤æä¸€ä¸‹ <code>ResourceServerSecurityConfigurer</code> çš„ <code>tokenServices</code> å±æ€§, ç”¨äºé…ç½®æˆæƒæœåŠ¡çš„ä¿¡æ¯, é€‚ç”¨èµ„æºä¸æˆæƒåˆ†ç¦»</p>\n</blockquote>\n<p>RemoteTokenServices , å®ƒå°†å…è®¸èµ„æºæœåŠ¡å™¨é€šè¿‡HTTPè¯·æ±‚æ¥è§£ç ä»¤ç‰Œï¼ˆä¹Ÿå°±æ˜¯æˆæƒæœåŠ¡çš„ /oauth/check_token ç«¯ç‚¹ï¼‰; å¦‚æœä½ çš„èµ„æºæœåŠ¡æ²¡æœ‰å¤ªå¤§çš„è®¿é—®é‡çš„è¯, é‚£ä¹ˆä½¿ç”¨RemoteTokenServices å°†ä¼šå¾ˆæ–¹ä¾¿ï¼ˆæ‰€æœ‰å—ä¿æŠ¤çš„èµ„æºè¯·æ±‚éƒ½å°†è¯·æ±‚ä¸€æ¬¡æˆæƒæœåŠ¡ç”¨ä»¥æ£€éªŒtokenå€¼ï¼‰, æˆ–è€…ä½ å¯ä»¥é€šè¿‡ç¼“å­˜æ¥ä¿å­˜æ¯ä¸€ä¸ªtokenéªŒè¯çš„ç»“æœ;</p>\n<p>æ–°å»ºä¸€ä¸ª</p>\n<pre><code class=\"language-xml\">  &lt;dependency&gt;\n&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt;\n&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;/dependency&gt;\n  &lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n  &lt;/dependency&gt;\n</code></pre>\n<pre><code class=\"language-java\">\n/**\n * //èµ„æºæœåŠ¡ \n * åˆ†ç¦»\n * @author yangfh\n * 2019å¹´5æœˆ20æ—¥\n*/\n@Configuration\n@EnableResourceServer \npublic class ResourceServerConfiguration extends ResourceServerConfigurerAdapter  {\n\t\n\tString resource_id = \"client_abc\";\n\tString resource_s = \"client_abc_s\";\n\t\n\t@Override\n\tpublic void configure(ResourceServerSecurityConfigurer resources) throws Exception {\n\t\t  resources.resourceId(resource_id).stateless(true);\n\t\t  resources.tokenServices(remoteTokenServices());\n\t}\n\t@Override\n\tpublic void configure(HttpSecurity http) throws Exception {\n\t\thttp\n\t        .antMatcher(\"/protect/**\").authorizeRequests()\n\t        .anyRequest().permitAll();\n\t}\n\t@Bean\n\t public RemoteTokenServices remoteTokenServices() {\n\t\tRemoteTokenServices remoteTokenServices = new RemoteTokenServices();\n\t\tremoteTokenServices.setClientId(resource_id);\n\t\tremoteTokenServices.setClientSecret(resource_s);\n\t\tremoteTokenServices.setCheckTokenEndpointUrl(\"http://127.0.0.1:8802/oauth/check_token\");\n\t\treturn remoteTokenServices;\n\t }\n} \n\n</code></pre>\n<pre><code class=\"language-json\">{\n    \"hi\": \"è¿™æ˜¯å—ä¿æŠ¤çš„èµ„æº Oauth2ResServerApplication\"\n}\n</code></pre>\n<blockquote>\n<p><a href=\"https://www.cnblogs.com/xingxueliao/p/5911292.html\" target=\"_blank\">Spring Cloud OAuth2.0</a><br />\n<a href=\"https://www.cnblogs.com/Irving/p/9343377.html\" target=\"_blank\">Spring Cloud å¾®æœåŠ¡ä¸­æ­å»º OAuth2.0 è®¤è¯æˆæƒæœåŠ¡</a></p>\n</blockquote>\n<blockquote>\n<p><a href=\"https://github.com/spring-projects/spring-security-oauth/blob/master/spring-security-oauth2/src/test/resources/schema.sql\" rel=\"noopener nofollow\" target=\"_blank\">spring OAuth2 é»˜è®¤çš„è¡¨ç»“æ„</a><br />\n<a href=\"schema.sql\" rel=\"noopener nofollow\" target=\"_blank\">spring OAuth2 é»˜è®¤çš„è¡¨ç»“æ„æœ¬åœ°æ–‡ä»¶</a></p>\n</blockquote>\n<h1 id=\"è¸©å‘æŒ‡å—spring-admin\">è¸©å‘æŒ‡å—:(spring admin)</h1>\n<h2 id=\"é…ç½®context-path-ç«¯ç‚¹è·¯å¾„ä¸å¯¹\">é…ç½®context-path ç«¯ç‚¹è·¯å¾„ä¸å¯¹</h2>\n<p>å¦‚æœé¡¹ç›®é…ç½®æœ‰ server.servlet.context-path å±æ€§, æƒ³è¦è¢« spring boot admin ç›‘æ§, å°±è¦åœ¨å®¢æˆ·ç«¯()é…ç½®adminçš„ä»¥ä¸‹å±æ€§(æŒ‡å®šç›‘æ§ç«¯ç‚¹uri)</p>\n<pre><code class=\"language-yml\"># ä¾‹ server.servlet.context-path=/iot_video_serve/ # ä¸èƒ½/iot_video_serve é‚£å°±æ˜¯ç»å¯¹è·¯å¾„,\neureka.instance.leaseRenewalIntervalInSeconds=10\neureka.client.serviceUrl.defaultZone=http://192.168.10.140:8761/eureka/\n# eureka.client.serviceUrl.defaultZone=http://127.0.0.1:8761/eureka/\neureka.instance.metadata-map.management.context-path=${server.servlet.context-path}actuator\neureka.instance.health-check-url-path=${server.servlet.context-path}actuator/health\neureka.instance.status-page-url-path=${server.servlet.context-path}actuator/info\n\n</code></pre>\n<h2 id=\"for-linux-boot-admin-æœªçŸ¥ä¸»æœºå¼‚å¸¸\">for linux boot admin æœªçŸ¥ä¸»æœºå¼‚å¸¸</h2>\n<p>è®¿é—®ç±»ä¼¼<code>http://192.168.10.140:8800/instances/b339b067eaa3/actuator/health</code> å®ä¾‹ç›‘æ§ç«¯ç‚¹æŠ›å‡ºæœªçŸ¥ä¸»æœºå¼‚å¸¸,<br />\næ— æ³•è·å–å®ä¾‹ç›‘æ§æ•°æ®, åŸå› æ˜¯linux,è¦æŠŠæœºå™¨å æ˜ å°„åˆ°æœ¬æœº, ä¿®æ”¹hosts?åé¢å†è¯´!(<a href=\"https://www.jb51.net/article/134954.htm\" rel=\"noopener nofollow\" target=\"_blank\">https://www.jb51.net/article/134954.htm</a>)<br />\nå‚è€ƒ: <a href=\"https://www.cnblogs.com/yinjihuan/p/10487835.html\" target=\"_blank\">https://www.cnblogs.com/yinjihuan/p/10487835.html</a></p>\n<p><strong>è¿˜æœ‰ä¸ªé…ç½® å·¨å‘</strong></p>\n<pre><code class=\"language-c\">//é…ç½®åœ¨Eureka æ³¨å†Œä¸­å¿ƒä»¥IPåœ°å€è®¿é—®å®ä¾‹, å¦åˆ™ä¼šä»¥`ä¸»æœºå:ç«¯å£`è®¿é—®,\n//è¿™ä¼šé€ æˆadminå®ä¾‹è¿è¡Œåœ¨windownsä¸Š, å¯ä»¥ç›‘æ§windownsä¸‹è¿è¡Œçš„å®ä¾‹, linux æ˜¾ç„¶ä¸æ”¯æŒ windowså¹³å°çš„ä¸»æœºå:ç«¯å£,å±€åŸŸç½‘è®¿é—®åè®®\neureka.instance.prefer-ip-address=true\n</code></pre>\n<blockquote>\n<p><a href=\"https://www.cnblogs.com/fangwu/p/8975990.html\" target=\"_blank\">https://www.cnblogs.com/fangwu/p/8975990.html</a></p>\n</blockquote>\n<p>ç›®å‰é…ç½®</p>\n<pre><code class=\"language-s\">####### eureka.client #######\nspring.application.name=iot_video_server\nspring.cloud.refresh.refreshable=none\nspring.devtools.restart.enabled=false\n\neureka.client.serviceUrl.defaultZone=http://192.168.10.140:8761/eureka/\n#eureka.client.serviceUrl.defaultZone=http://127.0.0.1:8761/eureka/\neureka.instance.prefer-ip-address=true\neureka.instance.leaseRenewalIntervalInSeconds=10\neureka.instance.metadata-map.management.context-path=${server.servlet.context-path}actuator\neureka.instance.health-check-url-path=${server.servlet.context-path}actuator/health\neureka.instance.status-page-url-path=${server.servlet.context-path}actuator/info\n</code></pre>\n<p><a href=\"https://www.cnblogs.com/liukaifeng/p/10052594.html\" target=\"_blank\">SpringCloud Eurekaå‚æ•°é…ç½®é¡¹è¯¦è§£</a></p>\n<p>å¦å¤–è¿˜æœ‰æ³¨æ„ä¸‹é…ç½® ç«¯ç‚¹å…è®¸è·¨åŸŸ</p>\n<pre><code class=\"language-java\">@Configuration\n\tpublic static class SecurityPermitAllConfig extends WebSecurityConfigurerAdapter {\n\t\t@Override\n\t\tprotected void configure(HttpSecurity http) throws Exception {\n\t\t\thttp.csrf()\n\t        .ignoringAntMatchers(\"/actuator/**\"); //ç«¯ç‚¹url å¿½ç•¥ csrf\n\n\t\t}\n\t}\n</code></pre>\n<h1 id=\"è¸©å‘æŒ‡å—eureka\">è¸©å‘æŒ‡å—:(Eureka)</h1>\n<h2 id=\"è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼\">è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼</h2>\n<p>EMERGENCY! EUREKA MAY BE INCORRECTLY CLAIMING INSTANCES ARE UP WHEN THEY'RE NOT. RENEWALS ARE LESSER THAN THRESHOLD AND HENCE THE INSTANCES ARE NOT BEING EXPIRED JUST TO BE SAFE.</p>\n<p>é»˜è®¤æƒ…å†µä¸‹, å¦‚æœEureka Serveråœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªå¾®æœåŠ¡å®ä¾‹çš„å¿ƒè·³, Eureka Serverå°†ä¼šæ³¨é”€è¯¥å®ä¾‹ï¼ˆé»˜è®¤90ç§’ï¼‰;</p>\n<p>ä½†æ˜¯å½“ç½‘ç»œåˆ†åŒºæ•…éšœå‘ç”Ÿæ—¶, å¾®æœåŠ¡ä¸Eureka Serverä¹‹é—´æ— æ³•æ­£å¸¸é€šä¿¡, ä»¥ä¸Šè¡Œä¸ºå¯èƒ½å˜å¾—éå¸¸å±é™©äº†â€”â€”å› ä¸ºå¾®æœåŠ¡æœ¬èº«å…¶å®æ˜¯å¥åº·çš„, æ­¤æ—¶æœ¬ä¸åº”è¯¥æ³¨é”€è¿™ä¸ªå¾®æœåŠ¡;<br />\nEurekaé€šè¿‡\"<code>è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼</code>\"æ¥è§£å†³è¿™ä¸ªé—®é¢˜â€”â€”å½“Eureka ServerèŠ‚ç‚¹åœ¨çŸ­æ—¶é—´å†…ä¸¢å¤±è¿‡å¤šå®¢æˆ·ç«¯æ—¶ï¼ˆå¯èƒ½å‘ç”Ÿäº†ç½‘ç»œåˆ†åŒºæ•…éšœï¼‰, é‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹å°±ä¼šè¿›å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼; ä¸€æ—¦è¿›å…¥è¯¥æ¨¡å¼, Eureka Serverå°±ä¼šä¿æŠ¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯, ä¸å†åˆ é™¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„æ•°æ®ï¼ˆä¹Ÿå°±æ˜¯ä¸ä¼šæ³¨é”€ä»»ä½•å¾®æœåŠ¡ï¼‰; å½“ç½‘ç»œæ•…éšœæ¢å¤å, è¯¥Eureka ServerèŠ‚ç‚¹ä¼šè‡ªåŠ¨é€€å‡ºè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼;</p>\n<p>ç»¼ä¸Š, è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼æ˜¯ä¸€ç§åº”å¯¹ç½‘ç»œå¼‚å¸¸çš„å®‰å…¨ä¿æŠ¤æªæ–½; å®ƒçš„æ¶æ„å“²å­¦æ˜¯å®å¯åŒæ—¶ä¿ç•™æ‰€æœ‰å¾®æœåŠ¡ï¼ˆå¥åº·çš„å¾®æœåŠ¡å’Œä¸å¥åº·çš„å¾®æœåŠ¡éƒ½ä¼šä¿ç•™ï¼‰, ä¹Ÿä¸ç›²ç›®æ³¨é”€ä»»ä½•å¥åº·çš„å¾®æœåŠ¡; ä½¿ç”¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼, å¯ä»¥è®©Eurekaé›†ç¾¤æ›´åŠ çš„å¥å£®, ç¨³å®š;</p>\n<pre><code class=\"language-yml\">\neureka.client.registry-fetch-interval-seconds :è¡¨ç¤ºeureka clienté—´éš”å¤šä¹…å»æ‹‰å–æœåŠ¡æ³¨å†Œä¿¡æ¯, é»˜è®¤ä¸º30ç§’, å¯¹äºapi-gateway, å¦‚æœè¦è¿…é€Ÿè·å–æœåŠ¡æ³¨å†ŒçŠ¶æ€, å¯ä»¥ç¼©å°è¯¥å€¼, æ¯”å¦‚5ç§’\neureka.server.enable-self-preservation=false #æ˜¯å¦å¼€å¯è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼, é»˜è®¤ä¸ºtrue; ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç¦ç”¨\neureka.server.eviction-interval-timer-in-ms=60000 #æ¸…ç†æ— æ•ˆèŠ‚ç‚¹çš„æ—¶é—´é—´éš”, é»˜è®¤60000æ¯«ç§’, å³60ç§’\n</code></pre>\n<blockquote>\n<p><a href=\"https://www.jianshu.com/p/c18d140ad9f6\" rel=\"noopener nofollow\" target=\"_blank\">https://www.jianshu.com/p/c18d140ad9f6</a></p>\n</blockquote>\n<h1 id=\"é™„å½•-springcloud_å±æ€§é…ç½®\">é™„å½• springcloud_å±æ€§é…ç½®</h1>\n<p>Part XIX. Appendix: Compendium of Configuration Properties</p>\n<p>[[springcloud_æ‰€æœ‰é…ç½®é¡¹_application.properties]]</p>\n\n\n</div>\n<div id=\"MySignature\">\n    é¢„é˜²è€å¹´ç—´å‘†ï¼Œä¿æŒç»ˆèº«å­¦ä¹ !    â€”â€” <a href=\"https://www.cnblogs.com/dddy/\" target=\"_blank\">daidaidaiyu</a>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-13 23:42</span>&nbsp;\n<a href=\"https://www.cnblogs.com/dddy\">daidaidaiyu</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">0</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "2026å¹´äº’è”ç½‘è¡Œä¸šåå¤§çƒ­é—¨è¯é¢˜ï¼šAIç‹‚é£™ä¸æŠ€æœ¯å¹³æƒçš„åå­—è·¯å£",
      "link": "https://www.cnblogs.com/nf01/p/19613794",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/nf01/p/19613794\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-13 23:11\">\n    <span>2026å¹´äº’è”ç½‘è¡Œä¸šåå¤§çƒ­é—¨è¯é¢˜ï¼šAIç‹‚é£™ä¸æŠ€æœ¯å¹³æƒçš„åå­—è·¯å£</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"å½“å¤§æ¨¡å‹ä»å·¥å…·è¿›åŒ–ä¸ºä¼™ä¼´æˆ‘ä»¬æ­£ç«™åœ¨äº’è”ç½‘å†å²çš„è½¬æŠ˜ç‚¹ä¸Š\">å½“å¤§æ¨¡å‹ä»\"å·¥å…·\"è¿›åŒ–ä¸º\"ä¼™ä¼´\"ï¼Œæˆ‘ä»¬æ­£ç«™åœ¨äº’è”ç½‘å†å²çš„è½¬æŠ˜ç‚¹ä¸Š</h1>\n<hr />\n<blockquote>\n<p><em>å†™åœ¨å‰é¢ï¼š2026å¹´çš„äº’è”ç½‘è¡Œä¸šï¼Œçƒ­é—¹å¾—è®©äººæœ‰äº›åº”æ¥ä¸æš‡ã€‚ä»AI Agentçš„å…¨é¢çˆ†å‘ï¼Œåˆ°å›½äº§å¤§æ¨¡å‹çš„ç™¾å®¶äº‰é¸£ï¼Œä»è§†é¢‘ç”Ÿæˆçš„ç‹‚é£™çªè¿›ï¼Œåˆ°AIç¡¬ä»¶çš„æ‚„ç„¶å´›èµ·â€”â€”è¿™å¯èƒ½æ˜¯è¿‘åå¹´æ¥æŠ€æœ¯å˜é©æœ€å¯†é›†çš„ä¸€å¹´ã€‚æœ¬æ–‡5000ä½™å­—ï¼Œå¸¦ä½ ç³»ç»Ÿæ€§æ¢³ç†å½“ä¸‹äº’è”ç½‘è¡Œä¸šæœ€çƒ­é—¨çš„è¯é¢˜ï¼Œæ¢ç©¶çƒ­æ½®èƒŒåçš„é€»è¾‘ï¼Œå¹¶å°è¯•å›ç­”ä¸€ä¸ªæ ¹æœ¬é—®é¢˜ï¼šè¿™ä¸€æ¬¡çš„æŠ€æœ¯æµªæ½®ï¼Œç©¶ç«Ÿä¼šæŠŠæˆ‘ä»¬å¸¦å‘ä½•æ–¹ï¼Ÿ</em></p>\n</blockquote>\n<hr />\n<h2 id=\"ä¸€ai-agentä»å›ç­”é—®é¢˜åˆ°ä»£æ›¿æ“ä½œ\">ä¸€ã€AI Agentï¼šä»\"å›ç­”é—®é¢˜\"åˆ°\"ä»£æ›¿æ“ä½œ\"</h2>\n<p>å¦‚æœè¦ç”¨ä¸€ä¸ªè¯æ¥å½¢å®¹2026å¹´äº’è”ç½‘è¡Œä¸šçš„ä¸»é¢˜ï¼Œ<strong>AI Agentï¼ˆæ™ºèƒ½ä½“ï¼‰</strong> ç»å¯¹å½“ä¹‹æ— æ„§ã€‚</p>\n<p>è¿˜è®°å¾—2023å¹´ChatGPTæ¨ªç©ºå‡ºä¸–æ—¶ï¼Œæˆ‘ä»¬æƒŠå¹äºå®ƒèƒ½\"å›ç­”é—®é¢˜\"ï¼›2024å¹´ï¼Œæˆ‘ä»¬å¼€å§‹ä¹ æƒ¯å®ƒèƒ½\"ç”Ÿæˆå†…å®¹\"ï¼›è€Œåˆ°äº†2026å¹´ï¼Œè¡Œä¸šç„¦ç‚¹å·²ç»å®Œå…¨è½¬å‘â€”â€”<strong>AIèƒ½æ›¿æˆ‘\"å¹²æ´»\"äº†å—ï¼Ÿ</strong></p>\n<p>ç­”æ¡ˆæ˜¯ï¼šä¸ä»…èƒ½ï¼Œè€Œä¸”æ­£åœ¨åŠ é€Ÿæ¸—é€ã€‚</p>\n<h3 id=\"11-ä»€ä¹ˆæ˜¯ai-agentç®€å•æ¥è¯´\">1.1 ä»€ä¹ˆæ˜¯AI Agentï¼Ÿç®€å•æ¥è¯´</h3>\n<p>ä¼ ç»ŸAIåŠ©æ‰‹ï¼ˆæ¯”å¦‚Siriã€å°çˆ±åŒå­¦ï¼‰æ˜¯\"ä½ é—®ä¸€å¥ï¼Œå®ƒç­”ä¸€å¥\"çš„äº¤äº’æ¨¡å¼ã€‚è€ŒAI Agentåˆ™å…·å¤‡äº†<strong>è§„åˆ’ã€å·¥å…·ä½¿ç”¨ã€è®°å¿†å’Œè‡ªä¸»å†³ç­–</strong>å››å¤§èƒ½åŠ›ã€‚ä½ å¯ä»¥ç»™å®ƒä¸€ä¸ªç›®æ ‡ï¼ˆæ¯”å¦‚\"å¸®æˆ‘è®¢ä¸€å¼ ä¸‹å‘¨å»ä¸Šæµ·çš„æœºç¥¨ï¼Œè¦é çª—åº§ä½ï¼Œä»·æ ¼åœ¨1500å…ƒä»¥å†…\"ï¼‰ï¼Œå®ƒä¼šè‡ªå·±åˆ†æéœ€æ±‚ã€æœç´¢ä¿¡æ¯ã€æ¯”è¾ƒé€‰é¡¹ã€å®Œæˆæ“ä½œâ€”â€”å…¨ç¨‹ä¸éœ€è¦ä½ å†åŠ¨æ‰‹ã€‚</p>\n<h3 id=\"12-å·¨å¤´éƒ½åœ¨å¸ƒå±€\">1.2 å·¨å¤´éƒ½åœ¨å¸ƒå±€</h3>\n<p>2026å¹´åˆï¼ŒOpenAIå‘å¸ƒäº†GPT-5ï¼Œå…¶æ ¸å¿ƒå–ç‚¹å°±æ˜¯<strong>Agentæ¨¡å¼</strong>çš„å…¨é¢å‡çº§ã€‚ç”¨æˆ·åªéœ€ç»™å‡ºä¸€ä¸ªé«˜å±‚æ¬¡æŒ‡ä»¤ï¼ŒGPT-5å°±èƒ½è‡ªä¸»æ‹†è§£ä»»åŠ¡ã€è°ƒç”¨å„ç§å·¥å…·ï¼ˆæµè§ˆå™¨ã€æ–‡æ¡£ã€ä»£ç ç¼–è¯‘å™¨ç­‰ï¼‰ã€åˆ†æ­¥æ‰§è¡Œï¼Œæœ€ç»ˆäº¤ä»˜å®Œæ•´ç»“æœã€‚</p>\n<blockquote>\n<p><em>\"æˆ‘ä»¬å¸Œæœ›è®©AIæˆä¸ºä½ çš„'æ•°å­—å‘˜å·¥'ï¼Œè€Œä¸ä»…ä»…æ˜¯'æ•°å­—ç™¾ç§‘å…¨ä¹¦'ã€‚\"</em> â€”â€” OpenAI CEO Sam Altman</p>\n</blockquote>\n<p>å›½å†…è¿™è¾¹ï¼Œç™¾åº¦çš„\"æ–‡å¿ƒä¸€è¨€\"ã€å­—èŠ‚çš„\"è±†åŒ…\"ã€é˜¿é‡Œçš„\"é€šä¹‰åƒé—®\"éƒ½åœ¨å¿«é€Ÿè¿­ä»£Agentèƒ½åŠ›ã€‚ç™¾åº¦æ›´æ˜¯å°†Agentæ¦‚å¿µèå…¥äº†æœç´¢å’Œåœ°å›¾äº§å“ï¼Œå–Šå‡ºäº†\"æœç´¢å³æœåŠ¡\"çš„å£å·ã€‚</p>\n<h3 id=\"13-ä¸ºä»€ä¹ˆ2026å¹´æ˜¯agentå…ƒå¹´\">1.3 ä¸ºä»€ä¹ˆ2026å¹´æ˜¯Agentå…ƒå¹´ï¼Ÿ</h3>\n<p><strong>ä¸‰ä¸ªæ¡ä»¶çš„æˆç†Ÿï¼š</strong></p>\n<ol>\n<li><strong>å¤§æ¨¡å‹èƒ½åŠ›è·ƒå‡</strong>ï¼šæ¨ç†æˆæœ¬å¤§å¹…ä¸‹é™ï¼Œæ¨¡å‹å“åº”é€Ÿåº¦åŠ å¿«ï¼Œå¤šæ¨¡æ€èƒ½åŠ›å¢å¼º</li>\n<li><strong>å·¥å…·ç”Ÿæ€å®Œå–„</strong>ï¼šæµè§ˆå™¨è‡ªåŠ¨åŒ–ã€APIæ¥å£ã€æ–‡ä»¶ç³»ç»Ÿæ“ä½œç­‰åŸºç¡€è®¾æ–½æ—¥è¶‹æˆç†Ÿ</li>\n<li><strong>ç”¨æˆ·éœ€æ±‚è§‰é†’</strong>ï¼š996æµªæ½®ä¸‹ everyoneéƒ½åœ¨å¯»æ‰¾\"æ•ˆç‡è§£è¯\"ï¼Œè€æ¿ä»¬æ¸´æœ›AIå¸®è‡ªå·±æ‰“å·¥</li>\n</ol>\n<p><strong>ä¸€å¥è¯æ€»ç»“ï¼š</strong> 2026å¹´ï¼ŒAIä¸å†åªæ˜¯\"åº”ç­”æœº\"ï¼Œè€Œæ˜¯å¼€å§‹çœŸæ­£\"å¹²æ´»\"äº†ã€‚è¿™ä¸€è½¬å˜çš„å½±å“ï¼Œå¯èƒ½æ¯”å½“å¹´ç§»åŠ¨äº’è”ç½‘çš„è¯ç”Ÿè¿˜è¦æ·±è¿œã€‚</p>\n<hr />\n<h2 id=\"äºŒå›½äº§å¤§æ¨¡å‹ç™¾å®¶äº‰é¸£ä¸æ·˜æ±°èµ›å¹¶è¡Œ\">äºŒã€å›½äº§å¤§æ¨¡å‹ï¼šç™¾å®¶äº‰é¸£ä¸æ·˜æ±°èµ›å¹¶è¡Œ</h2>\n<h3 id=\"21-ç™¾æ¨¡å¤§æˆ˜è¿›å…¥ä¸‹åŠåœº\">2.1 \"ç™¾æ¨¡å¤§æˆ˜\"è¿›å…¥ä¸‹åŠåœº</h3>\n<p>2024å¹´ï¼Œå›½å†…å¤§æ¨¡å‹èµ›é“å¯ä»¥ç”¨\"ç–¯ç‹‚\"æ¥å½¢å®¹â€”â€”æ®ä¸å®Œå…¨ç»Ÿè®¡ï¼Œé‚£ä¸€å¹´å†’å‡ºäº†è¶…è¿‡200ä¸ªå¤§æ¨¡å‹ã€‚ä½†åˆ°äº†2026å¹´ï¼Œå‰§æƒ…æ€¥è½¬ç›´ä¸‹ï¼š<strong>æ´»ä¸‹æ¥çš„ä¸è¶…è¿‡20å®¶ï¼Œå…¶ä»–çš„éƒ½æˆäº†\"ç‚®ç°\"ã€‚</strong></p>\n<p>è¿™ä¸æ˜¯å±è¨€è€¸å¬ã€‚2025å¹´ä¸‹åŠå¹´å¼€å§‹ï¼ŒæŠ•èµ„äººå˜å¾—å¼‚å¸¸å†·é™ã€‚é‚£äº›\"PPTèèµ„\"ã€Demoæ¼‚äº®ä½†è½åœ°å›°éš¾çš„å…¬å¸ï¼Œè¦ä¹ˆè¢«è¿«åˆå¹¶ï¼Œè¦ä¹ˆæ‚„ç„¶é€€åœºã€‚å¹¸å­˜è€…æœ‰ä¸¤ç±»ï¼š</p>\n<ul>\n<li><strong>æœ‰åœºæ™¯çš„</strong>ï¼šå­—èŠ‚ï¼ˆè±†åŒ…+é£ä¹¦ï¼‰ã€é˜¿é‡Œï¼ˆé€šä¹‰+é’‰é’‰ï¼‰ã€ç™¾åº¦ï¼ˆæ–‡å¿ƒ+æœç´¢ï¼‰</li>\n<li><strong>æœ‰èµ„é‡‘çš„</strong>ï¼šæ™ºè°±AIã€MiniMaxã€é˜¶è·ƒæ˜Ÿè¾°</li>\n</ul>\n<h3 id=\"22-deepseekå¸¦æ¥çš„å†²å‡»æ³¢\">2.2 DeepSeekå¸¦æ¥çš„å†²å‡»æ³¢</h3>\n<p>2025å¹´æœ«ï¼Œä¸€åŒ¹é»‘é©¬æ€å‡ºé‡å›´â€”â€”<strong>DeepSeek</strong>ã€‚</p>\n<p>è¿™ä¸ªç”±å›½å†…å›¢é˜Ÿæ‰“é€ çš„å¤§æ¨¡å‹ï¼Œåœ¨å¤šé¡¹åŸºå‡†æµ‹è¯•ä¸­é€¼è¿‘GPT-4æ°´å¹³ï¼Œä½†æ¨ç†æˆæœ¬åªæœ‰å¯¹æ–¹çš„1/10ã€‚æ›´é‡è¦çš„æ˜¯ï¼ŒDeepSeeké€‰æ‹©äº†<strong>å¼€æº</strong>è·¯çº¿ï¼Œå¼€æ”¾äº†æ¨¡å‹æƒé‡å’ŒæŠ€æœ¯æŠ¥å‘Šã€‚</p>\n<blockquote>\n<p><em>\"æˆ‘ä»¬å¸Œæœ›è®©æ¯ä¸€å®¶ä¸­å›½å…¬å¸éƒ½ç”¨å¾—èµ·é¡¶çº§AIã€‚\"</em> â€”â€” DeepSeekåˆ›å§‹äºº</p>\n</blockquote>\n<p>æ­¤ä¸¾ç›´æ¥ç‚¹ç‡ƒäº†è¡Œä¸šä»·æ ¼æˆ˜ã€‚å„å¤§å‚å•†è¢«è¿«è·Ÿè¿›ï¼ŒAPIè°ƒç”¨ä»·æ ¼ä¸€é™å†é™ã€‚æœ‰äººè¯´DeepSeekæ˜¯\"è¡Œä¸šå…¬æ•Œ\"ï¼Œä¹Ÿæœ‰äººè¯´å®ƒæ˜¯\"æ™®æƒ å…ˆé”‹\"ã€‚æ— è®ºå¦‚ä½•ï¼Œ<strong>2026å¹´ï¼Œå¤§æ¨¡å‹çš„\"å¹³æƒæ—¶ä»£\"çœŸçš„æ¥äº†ã€‚</strong></p>\n<h3 id=\"23-åº”ç”¨å±‚çš„æœºä¼šåœ¨å“ªé‡Œ\">2.3 åº”ç”¨å±‚çš„æœºä¼šåœ¨å“ªé‡Œï¼Ÿ</h3>\n<p>åº•å±‚æ¨¡å‹çš„ç«äº‰è¶‹äºç™½çƒ­åŒ–ï¼Œä½†æŠ•èµ„äººçœŸæ­£å…³å¿ƒçš„ï¼Œæ˜¯<strong>åº”ç”¨å±‚</strong>çš„çˆ†å‘ã€‚</p>\n<p>ç›®å‰æ¥çœ‹ï¼Œè½åœ°æœ€å¿«çš„èµ›é“åŒ…æ‹¬ï¼š</p>\n<ul>\n<li><strong>AIå†™ä½œ/åŠå…¬</strong>ï¼šWPS AIã€Notion AIã€ç§˜å¡”å†™ä½œçŒ«</li>\n<li><strong>AIç¼–ç¨‹</strong>ï¼šCursorã€Devinï¼ˆç¡…è°·æ˜æ˜Ÿäº§å“ï¼‰ã€å›½å†…å„ç§\"AIç¨‹åºå‘˜\"</li>\n<li><strong>AIæ•™è‚²</strong>ï¼šä½œä¸šå¸®AIã€çŒ¿è¾…å¯¼AIã€å°çŒ¿AI</li>\n<li><strong>AIè¥é”€</strong>ï¼šå„ç§AIç”Ÿæˆæ–‡æ¡ˆã€å›¾ç‰‡ã€è§†é¢‘çš„å·¥å…·</li>\n</ul>\n<p><strong>ç»“è®ºï¼šä¸å…¶å·æ¨¡å‹ï¼Œä¸å¦‚å·åº”ç”¨ã€‚</strong> 2026å¹´ï¼Œè¿™å¥è¯æ­£åœ¨æˆä¸ºè¡Œä¸šå…±è¯†ã€‚</p>\n<hr />\n<h2 id=\"ä¸‰è§†é¢‘ç”Ÿæˆsoraä¸å†æ˜¯å”¯ä¸€ç­”æ¡ˆ\">ä¸‰ã€è§†é¢‘ç”Ÿæˆï¼šSoraä¸å†æ˜¯å”¯ä¸€ç­”æ¡ˆ</h2>\n<h3 id=\"31-æ–‡å­—ç”Ÿæˆè§†é¢‘è¿›å…¥å®ç”¨é˜¶æ®µ\">3.1 \"æ–‡å­—ç”Ÿæˆè§†é¢‘\"è¿›å…¥å®ç”¨é˜¶æ®µ</h3>\n<p>2024å¹´åˆï¼ŒOpenAIå‘å¸ƒSoraï¼Œæ¼”ç¤ºäº†60ç§’é«˜æ¸…è§†é¢‘ç”Ÿæˆèƒ½åŠ›ï¼Œå…¨ä¸–ç•Œä¸ºä¹‹éœ‡åŠ¨ã€‚ä¸¤å¹´åçš„ä»Šå¤©ï¼ŒSoraæ—©å·²ä¸æ˜¯å”¯ä¸€é€‰é¡¹ã€‚</p>\n<p><strong>å›½å†…ç©å®¶é›†ä½“å‘åŠ›ï¼š</strong></p>\n<ul>\n<li><strong>å¿«æ‰‹å¯çµ</strong>ï¼šä¸»æ‰“\"äººäººå¯ç”¨\"ï¼Œç”Ÿæˆé€Ÿåº¦æå¿«ï¼Œå·²è¿­ä»£åˆ°2.0ç‰ˆæœ¬</li>\n<li><strong>å­—èŠ‚å³æ¢¦</strong>ï¼šèƒŒé æŠ–éŸ³ç”Ÿæ€ï¼Œä¸€é”®ç”ŸæˆçŸ­è§†é¢‘ç´ æ</li>\n<li><strong>MiniMax</strong>ï¼šåœ¨é•¿è§†é¢‘ç”Ÿæˆæ–¹é¢æœ‰ç‹¬ç‰¹ä¼˜åŠ¿</li>\n<li><strong>Runway Gen-3</strong>ï¼šä¾ç„¶æ˜¯å…¨çƒåˆ›ä½œè€…çš„é¦–é€‰å·¥å…·</li>\n</ul>\n<h3 id=\"32-è¡Œä¸šå½±å“å½±è§†åˆ¶ä½œæ­£åœ¨è¢«é‡å¡‘\">3.2 è¡Œä¸šå½±å“ï¼šå½±è§†åˆ¶ä½œæ­£åœ¨è¢«é‡å¡‘</h3>\n<p>è¿‡å»ï¼Œä¸€æ”¯30ç§’çš„å¹¿å‘Šç‰‡ï¼Œä»åˆ›æ„åˆ°æˆç‰‡å¯èƒ½éœ€è¦ä¸€å‘¨ã€è€—è´¹æ•°ä¸‡å…ƒã€‚å¦‚ä»Šï¼Œ<strong>ç”¨AIç”Ÿæˆè§†é¢‘ç´ æ+äººå·¥åæœŸè°ƒæ•´ï¼Œ2å°æ—¶å°±èƒ½æå®š</strong>ï¼Œæˆæœ¬ä¸è¶³åŸæ¥çš„1/10ã€‚</p>\n<p>è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿ</p>\n<ul>\n<li><strong>çŸ­è§†é¢‘åˆ›ä½œè€…</strong>ï¼šå†ä¹Ÿä¸ç”¨ä¸ºç´ æå‘æ„ï¼ŒAIå¸®ä½ \"é€ \"</li>\n<li><strong>MCNæœºæ„</strong>ï¼šä¸€äºº+AI = è¿‡å»ä¸€ä¸ªå›¢é˜Ÿçš„ç”Ÿäº§åŠ›</li>\n<li><strong>ä¸­å°å¹¿å‘Šå…¬å¸</strong>ï¼šç»ˆäºèƒ½ç”¨å¾—èµ·\"å¤§ç‰‡çº§\"æ•ˆæœ</li>\n</ul>\n<p>å½“ç„¶ï¼Œ<strong>\"AIç”Ÿæˆè§†é¢‘\"ç›®å‰ä»æœ‰æ˜æ˜¾çŸ­æ¿</strong>ï¼š</p>\n<ul>\n<li>ç‰©ç†è§„å¾‹æŠŠæ¡ä¸å‡†ï¼ˆç‰©ä½“ç©¿æ¨¡ã€æ¶²ä½“å˜å½¢ç­‰é—®é¢˜å¸¸è§ï¼‰</li>\n<li>äººç‰©ä¸€è‡´æ€§éš¾ä»¥ç»´æŒï¼ˆç”Ÿæˆå¤šé•œå¤´æ—¶è„¸ä¼šå˜ï¼‰</li>\n<li>ç‰ˆæƒäº‰è®®ä¸æ–­ï¼ˆè®­ç»ƒæ•°æ®æ¥æºé—®é¢˜ï¼‰</li>\n</ul>\n<h3 id=\"33-2026å¹´ä¸€ä¸ªäººäººéƒ½æ˜¯å¯¼æ¼”çš„æ—¶ä»£æ­£åœ¨é™ä¸´\">3.3 2026å¹´ï¼šä¸€ä¸ª\"äººäººéƒ½æ˜¯å¯¼æ¼”\"çš„æ—¶ä»£æ­£åœ¨é™ä¸´</h3>\n<p>å½“æŠ€æœ¯é—¨æ§›è¶³å¤Ÿä½ï¼Œåˆ›æ„å°†æˆä¸ºå”¯ä¸€çš„ç¨€ç¼ºèµ„æºã€‚è¿™å¥è¯è¯´äº†åå¹´ï¼Œç°åœ¨ç»ˆäºè¦å®ç°äº†ã€‚</p>\n<hr />\n<h2 id=\"å››aiç¡¬ä»¶é™¤äº†æ‰‹æœºå’Œç”µè„‘è¿˜æœ‰ä»€ä¹ˆ\">å››ã€AIç¡¬ä»¶ï¼šé™¤äº†æ‰‹æœºå’Œç”µè„‘ï¼Œè¿˜æœ‰ä»€ä¹ˆï¼Ÿ</h2>\n<h3 id=\"41-ai-pinå‡‰äº†ä½†æ–¹å‘æ²¡é”™\">4.1 AI Pinï¼šå‡‰äº†ï¼Œä½†æ–¹å‘æ²¡é”™</h3>\n<p>2024å¹´ï¼ŒAI Pinï¼ˆå¦‚Humane Pinã€Rabbit R1ï¼‰æ¦‚å¿µçˆ†ç«ï¼Œè¢«è®¤ä¸ºæ˜¯\"æ›¿ä»£æ‰‹æœº\"çš„ä¸‹ä¸€ä»£ç¡¬ä»¶ã€‚ç„¶è€Œç°å®å¾ˆæ®‹é…·ï¼š<strong>AI Pinå¸‚åœºè¡¨ç°æƒ¨æ·¡</strong>ï¼Œå‡ºè´§é‡è¿œä½äºé¢„æœŸã€‚</p>\n<p>åŸå› ä¸å¤æ‚ï¼š<strong>åŠŸèƒ½æ‰‹æœºéƒ½èƒ½åšï¼Œå•ç‹¬ç¡¬ä»¶æ²¡å¿…è¦ï¼›äº¤äº’ä½“éªŒä¸å¤Ÿè‡ªç„¶ï¼›ç»­èˆªå’Œå‘çƒ­é—®é¢˜ä¸¥é‡ã€‚</strong></p>\n<h3 id=\"42-aiçœ¼é•œ2026å¹´æ–°é£å£\">4.2 AIçœ¼é•œï¼š2026å¹´æ–°é£å£ï¼Ÿ</h3>\n<p>ä½†èµ„æœ¬æ²¡æœ‰æ­»å¿ƒã€‚2026å¹´ï¼Œ<strong>AIçœ¼é•œ</strong>æˆä¸ºæ–°ç„¦ç‚¹ã€‚</p>\n<p><strong>Metaä¸Ray-Banåˆä½œçš„AIçœ¼é•œ</strong>å·²ç»è¿­ä»£åˆ°ç¬¬ä¸‰ä»£ï¼Œæ”¯æŒå®æ—¶ç¿»è¯‘ã€ç‰©ä½“è¯†åˆ«ã€è¯­éŸ³åŠ©æ‰‹ç­‰åŠŸèƒ½ã€‚æ‰å…‹ä¼¯æ ¼æ–­è¨€ï¼š\"çœ¼é•œæ˜¯AIæœ€åˆé€‚çš„è½½ä½“ï¼Œå› ä¸ºå®ƒç¦»çœ¼ç›æœ€è¿‘ã€ç¦»è€³æœµæœ€è¿‘ã€‚\"</p>\n<p>å›½å†…ç©å®¶é—»é£è€ŒåŠ¨ï¼š</p>\n<ul>\n<li><strong>å°ç±³</strong>ï¼šè¢«æ›æ­£åœ¨ç ”å‘AIçœ¼é•œï¼Œå®šä½\"å¹´è½»äººçš„ç¬¬ä¸€ä¸ªAIè®¾å¤‡\"</li>\n<li><strong>å­—èŠ‚</strong>ï¼šé€šè¿‡æŠ•èµ„æ–¹å¼å¸ƒå±€AR/VRç¡¬ä»¶</li>\n<li><strong>åä¸º</strong>ï¼šMateç³»åˆ—åç»­å¯èƒ½é›†æˆAIçœ¼é•œåŠŸèƒ½</li>\n</ul>\n<h3 id=\"43-æœºå™¨äººä»æ¦‚å¿µåˆ°ä¸Šå²—\">4.3 æœºå™¨äººï¼šä»\"æ¦‚å¿µ\"åˆ°\"ä¸Šå²—\"</h3>\n<p>é™¤äº†ç©¿æˆ´è®¾å¤‡ï¼Œ<strong>AIæœºå™¨äºº</strong>ä¹Ÿåœ¨2026å¹´åŠ é€Ÿè½åœ°ã€‚</p>\n<ul>\n<li><strong>ç‰¹æ–¯æ‹‰Optimus</strong>ï¼šå·²ç»åœ¨å·¥å‚\"æ‰“å·¥\"ï¼Œè¿›è¡Œç®€å•è£…é…å·¥ä½œ</li>\n<li><strong>æ³¢å£«é¡¿åŠ¨åŠ›Atlas</strong>ï¼šå®£å¸ƒè¿›å…¥å•†ä¸šåŒ–é˜¶æ®µ</li>\n<li><strong>å›½å†…ä¼˜å¿…é€‰ã€è¾¾é—¼ç§‘æŠ€</strong>ï¼šåœ¨æœåŠ¡æœºå™¨äººé¢†åŸŸæŒç»­çªç ´</li>\n</ul>\n<blockquote>\n<p><em>\"æœªæ¥åå¹´ï¼Œæ¯ä¸ªå®¶åº­å¯èƒ½éƒ½ä¼šæœ‰ä¸€å°æœºå™¨äººã€‚\"</em> â€”â€” é©¬æ–¯å…‹é¢„æµ‹</p>\n</blockquote>\n<p><strong>ä½†è¯·æ³¨æ„ï¼š</strong> ç›®å‰èƒ½å•†ç”¨çš„æœºå™¨äººä¸»è¦è¿˜æ˜¯\"ä¸“ç”¨å‹\"ï¼ˆæ‰«åœ°çš„æ‰«åœ°ã€æ¬è´§çš„æ¬è´§ï¼‰ï¼Œ\"é€šç”¨å‹\"å®¶åº­æœºå™¨äººç¦»æˆ‘ä»¬è¿˜æœ‰è·ç¦»ã€‚</p>\n<hr />\n<h2 id=\"äº”aiç›‘ç®¡ä¸æ•°æ®å®‰å…¨å½“æŠ€æœ¯è·‘å¾—æ¯”æ³•å¾‹å¿«\">äº”ã€AIç›‘ç®¡ä¸æ•°æ®å®‰å…¨ï¼šå½“æŠ€æœ¯è·‘å¾—æ¯”æ³•å¾‹å¿«</h2>\n<h3 id=\"51-å…¨çƒç›‘ç®¡åŠ é€Ÿ\">5.1 å…¨çƒç›‘ç®¡åŠ é€Ÿ</h3>\n<p>2026å¹´ï¼ŒAIç›‘ç®¡ä¸å†æ˜¯\"çº¸ä¸Šè°ˆå…µ\"ã€‚</p>\n<ul>\n<li><strong>æ¬§ç›ŸAIæ³•æ¡ˆ</strong>ï¼š2025å¹´æ­£å¼ç”Ÿæ•ˆï¼Œå¯¹é«˜é£é™©AIåº”ç”¨å®æ–½ä¸¥æ ¼ç›‘ç®¡</li>\n<li><strong>ç¾å›½</strong>ï¼šå„å·åˆ†åˆ«ç«‹æ³•ï¼ŒåŠ å·èµ°äº†æœ€å‰æ²¿</li>\n<li><strong>ä¸­å›½</strong>ï¼šç½‘ä¿¡åŠå‘å¸ƒã€Šç”Ÿæˆå¼AIç®¡ç†åŠæ³•ã€‹å‡çº§ç‰ˆï¼Œå¼ºè°ƒå†…å®¹æ ‡è¯†å’Œç‰ˆæƒä¿æŠ¤</li>\n</ul>\n<h3 id=\"52-ç‰ˆæƒæˆ˜äº‰æ„ˆæ¼”æ„ˆçƒˆ\">5.2 ç‰ˆæƒæˆ˜äº‰æ„ˆæ¼”æ„ˆçƒˆ</h3>\n<p>AIè®­ç»ƒæ•°æ®çš„ç‰ˆæƒé—®é¢˜ï¼Œå·²ç»ä»\"å­¦æœ¯è®¨è®º\"å‡çº§ä¸º\"å•†ä¸šæˆ˜äº‰\"ã€‚</p>\n<ul>\n<li><strong>å¥½è±å vs AIå…¬å¸</strong>ï¼šå¤šèµ·é›†ä½“è¯‰è®¼æ­£åœ¨è¿›è¡Œä¸­</li>\n<li><strong>æ–‡å­—å·¥ä½œè€…è”ç›Ÿ</strong>ï¼šè¦æ±‚AIå…¬å¸æ”¯ä»˜ç¨¿é…¬</li>\n<li><strong>éŸ³ä¹è¡Œä¸š</strong>ï¼šAIç”ŸæˆéŸ³ä¹æ³›æ»¥ï¼ŒSpotifyç­‰å¹³å°è¢«è¦æ±‚ä¸‹æ¶</li>\n</ul>\n<p><strong>ä¸€ä¸ªæœ‰æ„æ€çš„æ‚–è®ºï¼š</strong></p>\n<blockquote>\n<p>AIå…¬å¸è¯´ï¼š\"æˆ‘ä»¬ç”¨å…¬å¼€æ•°æ®è®­ç»ƒï¼Œæ˜¯åˆç†ä½¿ç”¨ã€‚\"<br />\nç‰ˆæƒæ–¹è¯´ï¼š\"ä½ çš„'å…¬å¼€'æ²¡ç»è¿‡æˆ‘åŒæ„ã€‚\"</p>\n</blockquote>\n<p>è¿™åœºäº‰è®ºï¼Œ2026å¹´ä¸ä¼šæœ‰ç­”æ¡ˆï¼Œä½†ä¸€å®šä¼šè¶Šæ¥è¶Šæ¿€çƒˆã€‚</p>\n<h3 id=\"53-aiæ±¡æŸ“è¢«å¿½è§†çš„å±æœº\">5.3 \"AIæ±¡æŸ“\"ï¼šè¢«å¿½è§†çš„å±æœº</h3>\n<p>è¿˜æœ‰ä¸€ä¸ªè¢«ä½ä¼°çš„è¯é¢˜ï¼š<strong>AIç”Ÿæˆå†…å®¹çš„æ±¡æŸ“é—®é¢˜</strong>ã€‚</p>\n<p>å½“äº’è”ç½‘ä¸ŠAIç”Ÿæˆçš„å†…å®¹è¶Šæ¥è¶Šå¤šï¼Œ<strong>\"äººç±»æ•°æ®æ¯ç«­\"</strong>æ­£åœ¨æˆä¸ºæ–°çš„ç„¦è™‘ã€‚å¦‚æœæ¨¡å‹ç»§ç»­ç”¨AIç”Ÿæˆçš„æ•°æ®è®­ç»ƒï¼Œä¼šå¯¼è‡´\"æ¨¡å‹å´©æºƒ\"ï¼ˆmodel collapseï¼‰ã€‚å¦‚ä½•åŒºåˆ†\"äººç±»æ™ºæ…§\"å’Œ\"æœºå™¨æµæ°´è´¦\"ï¼Œå°†æˆä¸ºå¹³å°å’Œç›‘ç®¡æ–¹çš„æ ¸å¿ƒæŒ‘æˆ˜ã€‚</p>\n<hr />\n<h2 id=\"å…­ç¤¾äº¤ä¸å†…å®¹å¹³å°æµé‡é‡æ–°åˆ†é…\">å…­ã€ç¤¾äº¤ä¸å†…å®¹å¹³å°ï¼šæµé‡é‡æ–°åˆ†é…</h2>\n<h3 id=\"61-çŸ­è§†é¢‘èµ›é“çš„ç»ˆå±€\">6.1 çŸ­è§†é¢‘èµ›é“çš„ç»ˆå±€ï¼Ÿ</h3>\n<p>2026å¹´ï¼ŒçŸ­è§†é¢‘æ±Ÿæ¹–å·²ç»è¶‹äºç¨³å®šï¼š</p>\n<ul>\n<li><strong>æŠ–éŸ³+TikTok</strong>ï¼šå…¨çƒåˆ¶éœ¸</li>\n<li><strong>å¿«æ‰‹</strong>ï¼šä¸‹æ²‰å¸‚åœºç¨³å¦‚è€ç‹—</li>\n<li><strong>è§†é¢‘å·</strong>ï¼šä¾æ‰˜å¾®ä¿¡ç”Ÿæ€æŒç»­å¢é•¿</li>\n<li><strong>å°çº¢ä¹¦</strong>ï¼šä»\"ç§è‰ç¤¾åŒº\"è¿›åŒ–ä¸º\"æœç´¢å…¥å£\"ï¼ŒDAUå±¡åˆ›æ–°é«˜</li>\n</ul>\n<p>æœ‰è¶£çš„æ˜¯ï¼Œ<strong>\"æœç´¢\"æ­£åœ¨å›å½’</strong>ã€‚å¹´è½»äººä¸å†åªä¾èµ–ç®—æ³•æ¨èï¼Œè€Œæ˜¯ä¸»åŠ¨åœ¨å°çº¢ä¹¦ã€æŠ–éŸ³ä¸Š\"æœç­”æ¡ˆ\"ã€‚è¿™è®©ç™¾åº¦æœ‰ç‚¹å°´å°¬ï¼Œä¹Ÿè®©å†…å®¹å¹³å°çœ‹åˆ°äº†æ–°çš„å•†ä¸šåŒ–ç©ºé—´ã€‚</p>\n<h3 id=\"62-ç§å¯†ç¤¾äº¤å‡æ¸©\">6.2 ç§å¯†ç¤¾äº¤å‡æ¸©</h3>\n<p>ä¸æ­¤åŒæ—¶ï¼Œ<strong>ç§å¯†ç¤¾äº¤</strong>æ­£åœ¨å¤å…´ã€‚</p>\n<ul>\n<li><strong>Discord</strong>ï¼šä»æ¸¸æˆç¤¾åŒºæ‰©å±•ä¸º\"å…´è¶£é£åœ°\"</li>\n<li><strong>Telegram</strong>ï¼šä»˜è´¹åŠŸèƒ½ä¸Šçº¿ï¼Œç”¨æˆ·ä¸å‡åå¢</li>\n<li><strong>å„ç§\"å°ç¾¤\"ç¤¾äº¤</strong>ï¼šå¾®ä¿¡ç¾¤ã€Slack Workspaceã€DiscordæœåŠ¡å™¨â€¦â€¦</li>\n</ul>\n<p><strong>é€»è¾‘å¾ˆå¥½ç†è§£ï¼š</strong> å…¬å…±å¹³å°çš„å™ªéŸ³å¤ªå¤§äº†ï¼Œäººä»¬æ¸´æœ›\"å®‰é™çš„å°åœˆå­\"ã€‚</p>\n<h3 id=\"63-åˆ›ä½œè€…ç»æµ20\">6.3 åˆ›ä½œè€…ç»æµ2.0</h3>\n<p>\"æ‰€æœ‰å¹³å°éƒ½åœ¨æŠ¢åˆ›ä½œè€…\"â€”â€”è¿™å·²ç»ä¸æ˜¯æ–°é—»ï¼Œä½†2026å¹´çš„æ–°å˜åŒ–æ˜¯ï¼š</p>\n<ul>\n<li><strong>å¹³å°åˆ†æˆæ¯”ä¾‹ä¸Šè°ƒ</strong>ï¼šæŠ–éŸ³ã€Bç«™çº·çº·\"è®©åˆ©\"</li>\n<li><strong>åˆ›ä½œè€…ä¿é™©</strong>å‡ºç°ï¼šå¹³å°å¼€å§‹ä¸ºåˆ›ä½œè€…æä¾›åŒ»ç–—ã€å…»è€ä¿éšœ</li>\n<li><strong>AIè¾…åŠ©å·¥å…·æ™®åŠ</strong>ï¼šä¸€ä¸ªäººå°±æ˜¯ä¸€æ”¯å›¢é˜Ÿ</li>\n</ul>\n<p><strong>\"äººäººéƒ½æ˜¯åˆ›ä½œè€…\"çš„æ—¶ä»£ï¼Œå†…å®¹ä¾›ç»™ä¸¥é‡è¿‡å‰©â€”â€”æ€ä¹ˆåŠï¼Ÿç­”æ¡ˆåªæœ‰ä¸€ä¸ªï¼šå·è´¨é‡ã€‚</strong></p>\n<hr />\n<h2 id=\"ä¸ƒè‡ªåŠ¨é©¾é©¶è½åœ°æ¯”é¢„æœŸå¿«\">ä¸ƒã€è‡ªåŠ¨é©¾é©¶ï¼šè½åœ°æ¯”é¢„æœŸå¿«</h2>\n<h3 id=\"71-l3çº§è‡ªåŠ¨é©¾é©¶2026å¹´æˆçœŸ\">7.1 L3çº§è‡ªåŠ¨é©¾é©¶ï¼š2026å¹´æˆçœŸ</h3>\n<p>2026å¹´ï¼Œ<strong>L3çº§è‡ªåŠ¨é©¾é©¶</strong>ï¼ˆæœ‰æ¡ä»¶è‡ªåŠ¨åŒ–ï¼Œåœ¨ç‰¹å®šè·¯æ®µå¯ä»¥è„±æ‰‹ï¼‰ç»ˆäºåœ¨ä¸­å›½è½åœ°ï¼š</p>\n<ul>\n<li><strong>åä¸ºé—®ç•Œ</strong>ï¼šADS 3.0ç‰ˆæœ¬æ¨é€ï¼Œçš„é«˜é€ŸNOAå…¨å›½é€š</li>\n<li><strong>è”šæ¥NOP+</strong>ï¼šåŸå¸‚NOAåŠŸèƒ½å¼€æ”¾</li>\n<li><strong>å°é¹XNGP</strong>ï¼šæŒç»­è¿­ä»£ï¼Œä½“éªŒæ¥è¿‘\"è€å¸æœº\"</li>\n</ul>\n<p><strong>ä½†è¯·æ³¨æ„ï¼š</strong> L3ä»ç„¶æœ‰ä¸¥æ ¼çš„ä½¿ç”¨æ¡ä»¶ï¼ˆé«˜é€Ÿå…¬è·¯ã€å¿«é€Ÿè·¯ã€å¤©æ°”è‰¯å¥½ç­‰ï¼‰ï¼Œå®Œå…¨\"æ— äººé©¾é©¶\"ï¼ˆL4/L5ï¼‰è¿˜è¿œã€‚</p>\n<h3 id=\"72-å•†ä¸šåŒ–ç ´å±€\">7.2 å•†ä¸šåŒ–ç ´å±€</h3>\n<p>Robotaxiï¼ˆæ— äººå‡ºç§Ÿè½¦ï¼‰ä¹Ÿåœ¨åŠ é€Ÿï¼š</p>\n<ul>\n<li><strong>ç™¾åº¦èåœå¿«è·‘</strong>ï¼šå¤šä¸ªåŸå¸‚å•†ä¸šåŒ–è¿è¥</li>\n<li><strong>Waymo</strong>ï¼šåœ¨ç¾å›½æŒç»­æ‰©å¼ </li>\n<li><strong>Cruise</strong>ï¼šè™½ç„¶2024å¹´å‡ºäº†å®‰å…¨äº‹æ•…ï¼Œä½†2026å¹´å·²æ¢å¤è¿è¥</li>\n</ul>\n<p><strong>ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡ï¼š</strong> 2026å¹´å¾ˆå¤šäººå¼€å§‹è®¨è®º\"è¦ä¸è¦ä¹°è½¦\"ã€‚å½“Robotaxiè¶³å¤Ÿä¾¿å®œä¸”æ–¹ä¾¿ï¼Œå…»è½¦çš„æˆæœ¬ï¼ˆåœè½¦ã€ä¿é™©ã€æ²¹è´¹/ç”µè´¹ï¼‰ä¼¼ä¹è¶Šæ¥è¶Šä¸åˆ’ç®—ã€‚</p>\n<hr />\n<h2 id=\"å…«web3ä¸åŒºå—é“¾å†·é—¨ä½†æ²¡æ­»\">å…«ã€Web3ä¸åŒºå—é“¾ï¼šå†·é—¨ä½†æ²¡æ­»</h2>\n<h3 id=\"81-æ¯”ç‰¹å¸ä»æ³¡æ²«åˆ°èµ„äº§\">8.1 æ¯”ç‰¹å¸ï¼šä»\"æ³¡æ²«\"åˆ°\"èµ„äº§\"</h3>\n<p>2026å¹´ï¼Œæ¯”ç‰¹å¸ä¾ç„¶æ˜¯æœ€\"å‡ºåœˆ\"çš„åŠ å¯†èµ„äº§ã€‚è™½ç„¶ä»·æ ¼æ³¢åŠ¨å‰§çƒˆï¼Œä½†<strong>ä¸»æµæœºæ„æ¥çº³åº¦æŒç»­æé«˜</strong>ï¼š</p>\n<ul>\n<li>è´è±å¾·ã€å¯Œè¾¾ç­‰ä¼ ç»Ÿé‡‘èå·¨å¤´ç»§ç»­å¸ƒå±€åŠ å¯†èµ„äº§</li>\n<li>æ›´å¤šçš„ETFäº§å“ä¸Šçº¿</li>\n<li>ç”šè‡³æœ‰å›½å®¶ï¼ˆå¦‚è¨å°”ç“¦å¤šï¼‰æŠŠæ¯”ç‰¹å¸å®šä¸ºæ³•å®šè´§å¸</li>\n</ul>\n<h3 id=\"82-web3åº”ç”¨ä»åœ¨æ¢ç´¢\">8.2 Web3åº”ç”¨ï¼šä»åœ¨æ¢ç´¢</h3>\n<p>\"Web3å»ä¸­å¿ƒåŒ–äº’è”ç½‘\"çš„æ„¿æ™¯ï¼Œç›®å‰æ¥çœ‹ä¾ç„¶é¥è¿œã€‚<strong>DeFiï¼ˆå»ä¸­å¿ƒåŒ–é‡‘èï¼‰ã€NFTã€GameFi</strong> è¿™äº›æ¦‚å¿µç»å†è¿‡å±±è½¦è¡Œæƒ…ï¼Œæ³¡æ²«ç ´äº†ä¸€æ‰¹åˆä¸€æ‰¹ã€‚</p>\n<p>ä½†åº•å±‚æŠ€æœ¯åœ¨è¿›æ­¥ï¼š</p>\n<ul>\n<li><strong>Layer 2è§£å†³æ–¹æ¡ˆ</strong>è®©ä»¥å¤ªåŠæ›´å¿«ã€æ›´ä¾¿å®œ</li>\n<li><strong>ZKï¼ˆé›¶çŸ¥è¯†è¯æ˜ï¼‰</strong> æŠ€æœ¯å¼€å§‹åº”ç”¨äºéšç§è®¡ç®—</li>\n<li><strong>å»ä¸­å¿ƒåŒ–èº«ä»½ï¼ˆDIDï¼‰</strong> åœ¨ä¸€äº›å‚ç›´åœºæ™¯è½åœ°</li>\n</ul>\n<p><strong>æ€»ç»“ï¼šWeb3ä¸æ˜¯å‡‰äº†ï¼Œè€Œæ˜¯ä»\"æŠ•æœºæ³¡æ²«\"å›å½’\"æŠ€æœ¯åŸºå»º\"ã€‚</strong></p>\n<hr />\n<h2 id=\"ä¹è¿œç¨‹åŠå…¬ä¸åä½œå¸¸æ€åŒ–çš„çº¢åˆ©\">ä¹ã€è¿œç¨‹åŠå…¬ä¸åä½œï¼šå¸¸æ€åŒ–çš„çº¢åˆ©</h2>\n<h3 id=\"91-æ··åˆåŠå…¬æˆä¸ºæ ‡é…\">9.1 æ··åˆåŠå…¬æˆä¸ºæ ‡é…</h3>\n<p>2026å¹´ï¼Œ<strong>\"ä¸‰å¤©åŠå…¬å®¤+ä¸¤å¤©åœ¨å®¶\"</strong> å·²ç»æˆä¸ºå¤§å¤šæ•°çŸ¥è¯†å·¥ä½œè€…çš„å¸¸æ€ã€‚</p>\n<ul>\n<li><strong>Slackã€é£ä¹¦ã€é’‰é’‰</strong>ï¼šåŠŸèƒ½è¶Šæ¥è¶Šå¼ºå¤§ï¼Œæ–‡æ¡£ã€å®¡æ‰¹ã€ä¼šè®®ã€OKRå…¨è¦†ç›–</li>\n<li><strong>Notionã€Confluence</strong>ï¼šçŸ¥è¯†ç®¡ç†æˆä¸ºä¼ä¸šçš„\"åŸºç¡€è®¾æ–½\"</li>\n<li><strong>Figmaã€Miro</strong>ï¼šåœ¨çº¿åä½œå·¥å…·è®©\"å¼‚åœ°è®¾è®¡\"æˆä¸ºå¯èƒ½</li>\n</ul>\n<h3 id=\"92-aiåŒäº‹æ¥äº†\">9.2 \"AIåŒäº‹\"æ¥äº†</h3>\n<p>æ›´å…³é”®çš„å˜åŒ–æ˜¯ï¼š<strong>ä½ çš„åŒäº‹å¯èƒ½ä¸å…¨æ˜¯\"äºº\"äº†ã€‚</strong></p>\n<ul>\n<li><strong>AIä¼šè®®çºªè¦</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆä¼šè®®æ‘˜è¦ã€å¾…åŠäº‹é¡¹</li>\n<li><strong>AIå‘¨æŠ¥</strong>ï¼šè‡ªåŠ¨æ±‡æ€»ä½ ä¸€å‘¨çš„å·¥ä½œå†…å®¹</li>\n<li><strong>AIå®¢æœ</strong>ï¼š7Ã—24å°æ—¶åœ¨çº¿ï¼Œè§£ç­”é‡å¤é—®é¢˜</li>\n</ul>\n<p><strong>2026å¹´çš„èŒåœºç”Ÿå­˜æ³•åˆ™ï¼š</strong> è¦ä¹ˆä½ ä¼šç”¨AIï¼Œè¦ä¹ˆä½ è¢«ä¼šç”¨AIçš„äººå–ä»£ã€‚</p>\n<hr />\n<h2 id=\"åäº‘è®¡ç®—ä¸åŸºç¡€è®¾æ–½aiæ—¶ä»£çš„å–é“²äºº\">åã€äº‘è®¡ç®—ä¸åŸºç¡€è®¾æ–½ï¼šAIæ—¶ä»£çš„\"å–é“²äºº\"</h2>\n<h3 id=\"101-äº‘å‚å•†çš„aiè½¬å‹\">10.1 äº‘å‚å•†çš„\"AIè½¬å‹\"</h3>\n<p>AIçˆ†å‘å¸¦æ¥å·¨å¤§çš„ç®—åŠ›éœ€æ±‚ï¼Œäº‘å‚å•†èµšå¾—ç›†æ»¡é’µæ»¡ã€‚</p>\n<ul>\n<li><strong>AWSã€Azureã€é˜¿é‡Œäº‘</strong>ï¼šAIç®—åŠ›æˆä¸ºå¢é•¿æœ€å¿«çš„ä¸šåŠ¡çº¿</li>\n<li><strong>GPUç§Ÿèµ</strong>æˆä¸ºæ–°çƒ­ç‚¹ï¼šA100ã€H100æ˜¾å¡ä¸€å¡éš¾æ±‚</li>\n<li><strong>è¾¹ç¼˜è®¡ç®—</strong>å‡æ¸©ï¼šAIæ¨ç†æ­£åœ¨ä»äº‘ç«¯èµ°å‘ç»ˆç«¯</li>\n</ul>\n<h3 id=\"102-å›½äº§æ›¿ä»£åŠ é€Ÿ\">10.2 \"å›½äº§æ›¿ä»£\"åŠ é€Ÿ</h3>\n<p>å—åœ°ç¼˜æ”¿æ²»å½±å“ï¼Œ<strong>å›½äº§èŠ¯ç‰‡</strong>çš„éœ€æ±‚æš´æ¶¨ï¼š</p>\n<ul>\n<li><strong>åä¸ºæ˜‡è…¾</strong>ï¼šæŒç»­è¿­ä»£ï¼Œéƒ¨åˆ†åœºæ™¯å¯æ›¿ä»£è‹±ä¼Ÿè¾¾</li>\n<li><strong>å¯’æ­¦çºªã€æ™¯å˜‰å¾®</strong>ï¼šå›½äº§AIèŠ¯ç‰‡å‚å•†è·å¾—æ›´å¤šå¸‚åœºæœºä¼š</li>\n<li><strong>ç®—åŠ›ç§Ÿèµå¹³å°</strong>ï¼šå¸®åŠ©ä¸­å°ä¼ä¸š\"ç”¨å¾—èµ·\"AI</li>\n</ul>\n<p><strong>ä¸€å¥è¯ï¼šAIæ—¶ä»£çš„åŸºç¡€è®¾æ–½ï¼Œæ°¸è¿œæ˜¯\"ç¡¬é€šè´§\"ã€‚</strong></p>\n<hr />\n<h2 id=\"ç»“è¯­ç«™åœ¨æµªæ½®ä¹‹å·…æˆ‘ä»¬åœ¨ç­‰å¾…ä»€ä¹ˆ\">ç»“è¯­ï¼šç«™åœ¨æµªæ½®ä¹‹å·…ï¼Œæˆ‘ä»¬åœ¨ç­‰å¾…ä»€ä¹ˆï¼Ÿ</h2>\n<p>å†™åˆ°è¿™é‡Œï¼Œä½ ä¼šå‘ç°2026å¹´çš„äº’è”ç½‘è¡Œä¸šå‘ˆç°å‡ºä¸€ä¸ªæ¸…æ™°çš„å›¾æ™¯ï¼š<strong>AIä»\"å·¥å…·\"è¿›åŒ–ä¸º\"ä¼™ä¼´\"ï¼ŒæŠ€æœ¯åˆ›æ–°ä»\"å°‘æ•°äººçš„æ¸¸æˆ\"èµ°å‘\"æ™®æƒ æ—¶ä»£\"ã€‚</strong></p>\n<p>ä½†ç¹è£ä¹‹ä¸‹ï¼Œä¹Ÿæœ‰éšå¿§ï¼š</p>\n<ul>\n<li>AIçš„ç‰ˆæƒã€ä¼¦ç†ã€ç›‘ç®¡é—®é¢˜æ—¥ç›Šå°–é”</li>\n<li>æµé‡çº¢åˆ©è§é¡¶ï¼Œå¢é‡ç«äº‰è½¬å‘å­˜é‡åšå¼ˆ</li>\n<li>å…¨çƒç»æµä¸ç¡®å®šæ€§ä¾ç„¶å­˜åœ¨ï¼Œèµ„æœ¬å¸‚åœºè¶‹äºä¿å®ˆ</li>\n</ul>\n<p><strong>ä½œä¸ºä¸€ä¸ªæ™®é€šç”¨æˆ·ã€ä¸€ä¸ªä»ä¸šè€…ã€ä¸€ä¸ªå…³æ³¨ç§‘æŠ€çš„äººï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•çœ‹å¾…è¿™ä¸€åˆ‡ï¼Ÿ</strong></p>\n<p>æˆ‘çš„ç­”æ¡ˆæ˜¯ï¼š<strong>ä¿æŒå¥½å¥‡ï¼Œä¿æŒè­¦æƒ•ï¼Œä¿æŒè¡ŒåŠ¨ã€‚</strong></p>\n<p>æŠ€æœ¯æµªæ½®ä¸å¯é˜»æŒ¡ï¼Œä½†æ¯ä¸€æ¬¡æµªæ½®éƒ½æ˜¯ä¸€æ¬¡é‡æ–°æ´—ç‰Œçš„æœºä¼šã€‚çœŸæ­£å€¼é’±çš„ä¸æ˜¯æŠ€æœ¯æœ¬èº«ï¼Œè€Œæ˜¯<strong>ç”¨æŠ€æœ¯è§£å†³çœŸå®é—®é¢˜çš„èƒ½åŠ›</strong>ã€‚</p>\n<blockquote>\n<p><em>\"æœªæ¥å·²ç»åˆ°æ¥ï¼Œåªæ˜¯åˆ†å¸ƒä¸å‡ã€‚\"</em> â€”â€” ç§‘å¹»ä½œå®¶å¨å»‰Â·å‰å¸ƒæ£®</p>\n</blockquote>\n<hr />\n<h2 id=\"-äº’åŠ¨æ—¶é—´\">ğŸ“¢ äº’åŠ¨æ—¶é—´</h2>\n<p>è¯»å®Œè¿™ç¯‡æ–‡ç« ï¼Œä½ æœ€å…³æ³¨å“ªä¸ªè¯é¢˜ï¼Ÿ</p>\n<ul>\n<li>A. AI Agentâ€”â€”æœ€æœŸå¾…\"AIå¸®æˆ‘æ‰“å·¥\"</li>\n<li>B. å›½äº§å¤§æ¨¡å‹â€”â€”æƒ³æ”¯æŒå›½è´§ä½†ä¸çŸ¥é“æ€ä¹ˆé€‰</li>\n<li>C. è§†é¢‘ç”Ÿæˆâ€”â€”æƒ³è¯•è¯•åš\"AIå¯¼æ¼”\"</li>\n<li>D. AIç¡¬ä»¶â€”â€”ç­‰å¾…ä¸€ä¸ª\"åˆ’æ—¶ä»£\"çš„äº§å“</li>\n<li>E. è‡ªåŠ¨é©¾é©¶â€”â€”å…³å¿ƒä»€ä¹ˆæ—¶å€™èƒ½çœŸæ­£\"è„±æ‰‹\"</li>\n<li>F. å…¶ä»–â€”â€”è¯„è®ºåŒºèŠèŠ</li>\n</ul>\n<p><strong>ä¹Ÿæ¬¢è¿ä½ åœ¨è¯„è®ºåŒºåˆ†äº«ï¼š2026å¹´ï¼Œä½ æœ€æƒ³ç”¨AIå¸®ä½ åšä»€ä¹ˆï¼Ÿ</strong></p>\n<blockquote>\n<p><em>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹ä¸ªèµã€åœ¨çœ‹ã€è½¬å‘é€ç»™æœ‹å‹ã€‚ä½ çš„æ”¯æŒæ˜¯æˆ‘æŒç»­è¾“å‡ºçš„åŠ¨åŠ›ã€‚</em></p>\n</blockquote>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-13 23:11</span>&nbsp;\n<a href=\"https://www.cnblogs.com/nf01\">å†œå¤«è¿ç»´</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">0</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "Vue3è§£æå­¦ä¹  - handlers æ¨¡å—",
      "link": "https://www.cnblogs.com/aleafshit/p/19613786",
      "published": "",
      "description": "<div class=\"postcontent\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>æ¬¢è¿å¤§å®¶äº¤æµè®¨è®ºï¼Œä¹Ÿæ¬¢è¿æå‡ºé—®é¢˜æˆ–ä¸åŒè§‚ç‚¹ã€‚æœ¬æ–‡åŸºäºä¸ªäººå¯¹æºç çš„ç†è§£ä¸æ•´ç†ï¼Œéš¾å…å­˜åœ¨åå·®æˆ–ä¸å®Œæ•´ä¹‹å¤„ï¼Œå¦‚æœä½ æœ‰æ›´æ·±å…¥çš„è§è§£æˆ–å‘ç°é”™è¯¯ï¼ŒæœŸå¾…ä¸€èµ·æ¢è®¨ä¸ä¿®æ­£ã€‚</p>\n<hr />\n<h1 id=\"ä¸€handlers-çš„æ ¸å¿ƒè®¾è®¡ç›®æ ‡\">ä¸€ã€handlers çš„æ ¸å¿ƒè®¾è®¡ç›®æ ‡</h1>\n<p>ä¸€å¥è¯æ€»ç»“ï¼š</p>\n<blockquote>\n<p>ä¸åŒæ•°æ®ç»“æ„ï¼Œç”¨ä¸åŒçš„ä»£ç†ç­–ç•¥ï¼Œåšåˆ°â€œæœ€å°æ‹¦æˆª + ç²¾ç¡®è§¦å‘â€ã€‚</p>\n</blockquote>\n<p>å“åº”å¼ç³»ç»Ÿæœ¬è´¨ä¸Šæ˜¯ä¸¤ä»¶äº‹ï¼š</p>\n<ol>\n<li>\n<p><strong>ä¾èµ–æ”¶é›†ï¼ˆtrackï¼‰</strong>ï¼šè¯»å–æ—¶è®°å½•ä¾èµ–</p>\n</li>\n<li>\n<p><strong>å‰¯ä½œç”¨è§¦å‘ï¼ˆtriggerï¼‰</strong>ï¼šå†™å…¥æ—¶è§¦å‘æ›´æ–°</p>\n</li>\n</ol>\n<p>ä½†ä¸åŒç±»å‹çš„æ•°æ®ï¼š</p>\n<ul>\n<li>\n<p>å˜æ›´æ–¹å¼ä¸åŒ</p>\n</li>\n<li>\n<p>å¯æ‹¦æˆªèƒ½åŠ›ä¸åŒ</p>\n</li>\n</ul>\n<p>å› æ­¤ Vue æŠŠä»£ç†é€»è¾‘æ‹†æˆä¸‰å¥—ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>ç±»å‹</th>\n<th>å˜æ›´æ–¹å¼</th>\n<th>Proxy èƒ½åŠ›</th>\n<th>æ–¹æ¡ˆ</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Object</td>\n<td>å±æ€§èµ‹å€¼</td>\n<td>å¯å®Œæ•´æ‹¦æˆª</td>\n<td>baseHandlers</td>\n</tr>\n<tr>\n<td>Array</td>\n<td>å±æ€§ + æ–¹æ³•</td>\n<td>æ–¹æ³•æ— æ³•ç›´æ¥æ‹¦æˆª</td>\n<td>é‡å†™æ•°ç»„æ–¹æ³•</td>\n</tr>\n<tr>\n<td>Map/Set</td>\n<td>æ–¹æ³•é©±åŠ¨</td>\n<td>åªèƒ½æ‹¦æˆª get</td>\n<td>è¿”å›é‡å†™æ–¹æ³•</td>\n</tr>\n</tbody>\n</table>\n<p>è¿™ä¸æ˜¯â€œå¤æ‚â€ï¼Œè€Œæ˜¯å¯¹ JavaScript è¯­ä¹‰è¾¹ç•Œçš„å·¥ç¨‹å¦¥åã€‚</p>\n<hr />\n<h1 id=\"äºŒobjectç±»ç»§æ‰¿ä½“ç³»\">äºŒã€Objectï¼šç±»ç»§æ‰¿ä½“ç³»</h1>\n<p>Object çš„ handler åœ¨ <code>baseHandlers.ts</code> ä¸­ï¼Œé€šè¿‡ç±»ç»§æ‰¿ç»„ç»‡ï¼š</p>\n<h2 id=\"1-basereactivehandleræŠ½è±¡åŸºç±»\">1. BaseReactiveHandlerï¼ˆæŠ½è±¡åŸºç±»ï¼‰</h2>\n<p>è¿™æ˜¯ç»Ÿä¸€å…¥å£ï¼Œè´Ÿè´£ï¼š</p>\n<ul>\n<li>\n<p>get æ‹¦æˆª</p>\n</li>\n<li>\n<p>ref è§£åŒ…</p>\n</li>\n<li>\n<p>æ·±/æµ…å“åº”å¼é€’å½’</p>\n</li>\n<li>\n<p>ä¾èµ–æ”¶é›†</p>\n</li>\n</ul>\n<p>æ ¸å¿ƒèŒè´£ï¼š</p>\n<pre><code class=\"language-bash\">è®¿é—®å±æ€§ â†’ track â†’ è¿”å›å“åº”å¼å€¼\n</code></pre>\n<hr />\n<h2 id=\"2-mutablereactivehandlerå¯å˜å¯¹è±¡\">2. MutableReactiveHandlerï¼ˆå¯å˜å¯¹è±¡ï¼‰</h2>\n<p>è¿™æ˜¯æœ€å¸¸è§çš„ reactive ç‰ˆæœ¬ï¼š</p>\n<h3 id=\"set\">set</h3>\n<p>è§¦å‘ä¸¤ç§æ“ä½œç±»å‹ï¼š</p>\n<ul>\n<li>\n<p>TriggerOpTypes.ADDï¼ˆæ–°å¢å±æ€§ï¼‰</p>\n</li>\n<li>\n<p>TriggerOpTypes.SETï¼ˆä¿®æ”¹å·²æœ‰å±æ€§ï¼‰</p>\n</li>\n</ul>\n<p>åŒºåˆ† ADD / SET çš„æ„ä¹‰åœ¨äºï¼š</p>\n<pre><code class=\"language-bash\">æ–°å¢å±æ€§ â‰  ä¿®æ”¹å±æ€§\n</code></pre>\n<p>æŸäº›ä¾èµ–åªå…³å¿ƒç»“æ„å˜åŒ–ï¼ˆæ¯”å¦‚ for...inã€Object.keysï¼‰ã€‚</p>\n<hr />\n<h3 id=\"deleteproperty\">deleteProperty</h3>\n<p>è§¦å‘ï¼š</p>\n<pre><code class=\"language-bash\">TriggerOpTypes.DELETE\n</code></pre>\n<hr />\n<h3 id=\"has\">has</h3>\n<p>ç”¨äºï¼š</p>\n<pre><code class=\"language-bash\">key in obj\n</code></pre>\n<p>ä¾èµ–æ”¶é›†ï¼š</p>\n<pre><code class=\"language-bash\">TrackOpTypes.HAS\n</code></pre>\n<hr />\n<h3 id=\"ownkeys\">ownKeys</h3>\n<p>ç”¨äºï¼š</p>\n<pre><code class=\"language-bash\">for...in / Object.keys / Reflect.ownKeys\n</code></pre>\n<p>ä¾èµ–æ”¶é›†ï¼š</p>\n<pre><code class=\"language-bash\">TrackOpTypes.ITERATE\n</code></pre>\n<p>è¿™ä¸€æ­¥æ˜¯å¾ˆå¤šäººå¿½ç•¥çš„å…³é”®ï¼š</p>\n<blockquote>\n<p>éå†ç»“æ„æœ¬èº«ä¹Ÿæ˜¯ä¾èµ–ã€‚</p>\n</blockquote>\n<hr />\n<h2 id=\"3-readonlyreactivehandleråªè¯»\">3. ReadonlyReactiveHandlerï¼ˆåªè¯»ï¼‰</h2>\n<p>åªè¯»ç‰ˆæœ¬ç›´æ¥é˜»æ–­å†™æ“ä½œï¼š</p>\n<ul>\n<li>\n<p>set â†’ è­¦å‘Š + ä¸æ‰§è¡Œ</p>\n</li>\n<li>\n<p>deleteProperty â†’ è­¦å‘Š + ä¸æ‰§è¡Œ</p>\n</li>\n</ul>\n<p>ä½† <strong>è¯»å–ä»ç„¶ä¼š track</strong>ã€‚</p>\n<p>å› ä¸ºåªè¯»ä¸ç­‰äºâ€œæ— ä¾èµ–â€ã€‚</p>\n<hr />\n<h1 id=\"ä¸‰arrayæ–¹æ³•é‡å†™ç­–ç•¥\">ä¸‰ã€Arrayï¼šæ–¹æ³•é‡å†™ç­–ç•¥</h1>\n<p>æ•°ç»„çš„é—®é¢˜åœ¨äºï¼š</p>\n<blockquote>\n<p>å¤§éƒ¨åˆ†å˜æ›´ä¸æ˜¯é€šè¿‡å±æ€§èµ‹å€¼ï¼Œè€Œæ˜¯é€šè¿‡æ–¹æ³•ã€‚</p>\n</blockquote>\n<p>ä¾‹å¦‚ï¼š</p>\n<pre><code class=\"language-bash\">arr.push()\narr.splice()\narr.shift()\n</code></pre>\n<p>Proxy æ— æ³•ç›´æ¥æ‹¦æˆªæ–¹æ³•è°ƒç”¨ã€‚</p>\n<p>Vue3 çš„æ–¹æ¡ˆæ˜¯ï¼š</p>\n<blockquote>\n<p>åœ¨ get trap ä¸­è¿”å›â€œé‡å†™ç‰ˆæœ¬â€çš„æ•°ç»„æ–¹æ³•ã€‚</p>\n</blockquote>\n<hr />\n<h2 id=\"arrayinstrumentationsts\">arrayInstrumentations.ts</h2>\n<p>è¿”å›â€œé‡å†™ç‰ˆæœ¬â€çš„æ–¹æ³•å¯¹è±¡ã€‚</p>\n<p>å½“è®¿é—®æ•°ç»„æ–¹æ³•æ—¶ï¼š</p>\n<pre><code class=\"language-bash\">proxy.push\n</code></pre>\n<p>BaseReactiveHandler çš„ get trap ä¼šåˆ¤æ–­ï¼š</p>\n<pre><code class=\"language-bash\">æ˜¯ä¸æ˜¯æ•°ç»„ï¼Ÿ\næ˜¯ä¸æ˜¯è¢«é‡å†™çš„æ–¹æ³•ï¼Ÿ\n</code></pre>\n<p>å¦‚æœæ˜¯ï¼š</p>\n<p>â†’ è¿”å›â€é‡å†™ç‰ˆæœ¬â€œæ–¹æ³•</p>\n<p>è¿™äº›æ–¹æ³•å†…éƒ¨ï¼š</p>\n<ol>\n<li>\n<p>å…ˆæš‚åœä¾èµ–æ”¶é›†ï¼ˆé¿å…æ­»å¾ªç¯ï¼‰</p>\n</li>\n<li>\n<p>è°ƒç”¨åŸå§‹æ•°ç»„æ–¹æ³•</p>\n</li>\n<li>\n<p>æ‰‹åŠ¨ trigger</p>\n</li>\n</ol>\n<p>è¿™å°±æ˜¯ï¼š</p>\n<blockquote>\n<p>ç”¨å‡½æ•°åŒ…è£…æ¨¡æ‹Ÿâ€œæ–¹æ³•æ‹¦æˆªâ€ã€‚</p>\n</blockquote>\n<hr />\n<h1 id=\"å››map--setå·¥å‚å‡½æ•°ä½“ç³»\">å››ã€Map / Setï¼šå·¥å‚å‡½æ•°ä½“ç³»</h1>\n<p>é›†åˆç±»å‹æ¯”æ•°ç»„æ›´æç«¯ï¼š</p>\n<blockquote>\n<p>æ‰€æœ‰å˜æ›´éƒ½é€šè¿‡æ–¹æ³•ã€‚</p>\n</blockquote>\n<pre><code class=\"language-bash\">map.set()\nmap.delete()\nset.add()\n</code></pre>\n<p>Proxy èƒ½æ‹¦æˆªçš„åªæœ‰ï¼š</p>\n<pre><code class=\"language-bash\">get\n</code></pre>\n<p>å› æ­¤ Vue é‡‡ç”¨çº¯å·¥å‚å‡½æ•°æ¨¡å¼ï¼Œè€Œä¸æ˜¯ç±»ç»§æ‰¿ã€‚</p>\n<hr />\n<h2 id=\"1-åªæ‹¦æˆª-get\">1. åªæ‹¦æˆª get</h2>\n<p>collectionHandlers çš„ç­–ç•¥ï¼š</p>\n<pre><code class=\"language-bash\">get â†’ è¿”å›é‡å†™åçš„æ–¹æ³•\n</code></pre>\n<p>å’Œæ•°ç»„ç±»ä¼¼ï¼Œä½†æ›´å½»åº•ã€‚</p>\n<hr />\n<h2 id=\"2-å››ç§-handler-ç»„åˆ\">2. å››ç§ handler ç»„åˆ</h2>\n<p>åˆ›å»ºå¯¼å‡º 4 ä¸ªå…¨å±€ä»£ç†å¯¹è±¡ï¼š</p>\n<ol>\n<li>\n<p>mutableCollectionHandlersï¼ˆæ·±å“åº”å¼ï¼‰</p>\n</li>\n<li>\n<p>shallowCollectionHandlersï¼ˆæµ…å“åº”å¼ï¼‰</p>\n</li>\n<li>\n<p>readonlyCollectionHandlersï¼ˆåªè¯»ï¼‰</p>\n</li>\n<li>\n<p>shallowReadonlyCollectionHandlersï¼ˆæµ…åªè¯»ï¼‰</p>\n</li>\n</ol>\n<p>è¿™äº›ä¸æ˜¯æ‰‹å†™çš„ï¼Œè€Œæ˜¯é€šè¿‡ï¼š</p>\n<pre><code class=\"language-bash\">createInstrumentationsGetter(isReadonly, shallow)\n</code></pre>\n<p>åŠ¨æ€ç”Ÿæˆã€‚</p>\n<hr />\n<h2 id=\"3-createinstrumentations-æ ¸å¿ƒå·¥å‚\">3. createInstrumentations æ ¸å¿ƒå·¥å‚</h2>\n<p>è¿™ä¸ªå·¥å‚å‡½æ•°è´Ÿè´£ï¼š</p>\n<ul>\n<li>\n<p>æ„é€ é‡å†™åçš„ Map/Set æ–¹æ³•</p>\n</li>\n<li>\n<p>åœ¨æ–¹æ³•å†…éƒ¨è®¿é—®åŸå§‹å¯¹è±¡</p>\n</li>\n</ul>\n<p>å…³é”®ç‚¹ï¼š</p>\n<pre><code class=\"language-bash\">ReactiveFlags.RAW â†’ æ‹¿åˆ°åŸå§‹æ•°æ®\n</code></pre>\n<p>é¿å…ä»£ç†å¥—ä»£ç†å¯¼è‡´çš„é€’å½’é—®é¢˜ã€‚</p>\n<hr />\n<h1 id=\"äº”track--trigger-çš„ç²¾ç»†æ§åˆ¶\">äº”ã€Track / Trigger çš„ç²¾ç»†æ§åˆ¶</h1>\n<p>è¿™æ˜¯ Vue 3 å“åº”å¼ç³»ç»Ÿçš„çµé­‚æ”¹è¿›ä¹‹ä¸€ã€‚</p>\n<p>è¯»å–æ“ä½œè¢«åˆ†ä¸ºï¼š</p>\n<ul>\n<li>\n<p>GET</p>\n</li>\n<li>\n<p>HAS</p>\n</li>\n<li>\n<p>ITERATE</p>\n</li>\n</ul>\n<p>å†™å…¥æ“ä½œè¢«åˆ†ä¸ºï¼š</p>\n<ul>\n<li>\n<p>SET</p>\n</li>\n<li>\n<p>ADD</p>\n</li>\n<li>\n<p>DELETE</p>\n</li>\n</ul>\n<p>å®ƒä»¬ä¸æ˜¯ç®€å•çš„ä¸€å¯¹ä¸€å…³ç³»ã€‚</p>\n<hr />\n<h2 id=\"ç²¾ç¡®è§¦å‘çš„æ„ä¹‰\">ç²¾ç¡®è§¦å‘çš„æ„ä¹‰</h2>\n<p>å…³é”®è§„åˆ™ï¼š</p>\n<blockquote>\n<p>å¹¶ä¸æ˜¯æ‰€æœ‰å†™æ“ä½œéƒ½åº”è¯¥è§¦å‘æ‰€æœ‰ä¾èµ–ã€‚</p>\n</blockquote>\n<p>ä¾‹å¦‚ï¼š</p>\n<ul>\n<li>\n<p>GET ä¾èµ–åªå…³å¿ƒ SET</p>\n</li>\n<li>\n<p>ITERATE ä¾èµ–å…³å¿ƒ ADD / DELETE</p>\n</li>\n<li>\n<p>HAS ä¾èµ–åªå…³å¿ƒ key æ˜¯å¦å­˜åœ¨</p>\n</li>\n</ul>\n<p>å¦‚æœä¸åŒºåˆ†ï¼š</p>\n<pre><code class=\"language-bash\">ä»»ä½•å†™æ“ä½œ â†’ å…¨éƒ¨ effect è§¦å‘\n</code></pre>\n<p>è¿™ä¼šå¯¼è‡´ï¼š</p>\n<ul>\n<li>\n<p>ä¸å¿…è¦çš„é‡æ¸²æŸ“</p>\n</li>\n<li>\n<p>æ€§èƒ½é›ªå´©</p>\n</li>\n<li>\n<p>å‰¯ä½œç”¨é£æš´</p>\n</li>\n</ul>\n<p>Vue 2 çš„å“åº”å¼å°±å±äºç²—ç²’åº¦è§¦å‘ã€‚</p>\n<p>Vue 3 çš„ handlers è®¾è®¡æœ¬è´¨æ˜¯ï¼š</p>\n<blockquote>\n<p>æŠŠâ€œè¯»ç±»å‹â€å’Œâ€œå†™ç±»å‹â€å»ºç«‹æ˜ å°„å…³ç³»ã€‚</p>\n</blockquote>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"itemdesc\">\n                å‘è¡¨äº \n<span id=\"post-date\">2026-02-13 23:02</span>&nbsp;\n<a href=\"https://www.cnblogs.com/aleafshit\">death_ray</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">0</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n\n            </div>"
    },
    {
      "title": "å‘å¸ƒå›­å­çš„ç¬¬ä¸€ä¸ªBç«™è§†é¢‘ï¼æå‰ç¥å¤§å®¶æ˜¥èŠ‚å¿«ä¹ï¼",
      "link": "https://www.cnblogs.com/cmt/p/19613749",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/cmt/p/19613749\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-13 22:42\">\n    <span>å‘å¸ƒå›­å­çš„ç¬¬ä¸€ä¸ªBç«™è§†é¢‘ï¼æå‰ç¥å¤§å®¶æ˜¥èŠ‚å¿«ä¹ï¼</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>å›­å­å…¥é©»Bç«™å•¦ï¼Œä»Šå¤©å‘å¸ƒäº†ç¬¬ä¸€ä¸ªè§†é¢‘ï¼Œæå‰ç¥å¤§å®¶æ˜¥èŠ‚å¿«ä¹ï¼æ¬¢è¿å¤§å®¶å‰å¾€Bç«™æ§åœºï¼</p>\n<p></p>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-13 22:42</span>&nbsp;\n<a href=\"https://www.cnblogs.com/cmt\">åšå®¢å›­å›¢é˜Ÿ</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">0</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "ã€Azure App Serviceã€‘32ä½ Windows App Service æœ€å¤§èƒ½ä½¿ç”¨å¤šå°‘å†…å­˜ï¼Ÿ",
      "link": "https://www.cnblogs.com/lulight/p/19613358",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/lulight/p/19613358\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-13 19:13\">\n    <span>ã€Azure App Serviceã€‘32ä½ Windows App Service æœ€å¤§èƒ½ä½¿ç”¨å¤šå°‘å†…å­˜ï¼Ÿ</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h2 id=\"é—®é¢˜æè¿°\">é—®é¢˜æè¿°</h2>\n<p>åœ¨ä½¿ç”¨ Windows-based Azure Web Appï¼ˆ32ä½ï¼‰æ—¶ï¼Œç»å¸¸é‡åˆ°ä»¥ä¸‹ç–‘é—®ï¼š</p>\n<ul>\n<li>è¿›ç¨‹å†…å­˜ä¸Šé™æ˜¯å¤šå°‘ï¼Ÿ</li>\n<li>ä¸åŒæ‰˜ç®¡æ¨¡å¼ä¸‹å¯ç”¨å†…å­˜å¦‚ä½•è®¡ç®—ï¼Ÿ</li>\n</ul>\n<p>æœ¬æ–‡å°†é’ˆå¯¹è¿™äº›é—®é¢˜è¿›è¡Œè¯¦ç»†è§£ç­”ã€‚<br />\n<img alt=\"image\" class=\"lazyload\" /></p>\n<hr />\n<h2 id=\"é—®é¢˜è§£ç­”\">é—®é¢˜è§£ç­”</h2>\n<h3 id=\"ä¸€32-ä½ç¨‹åºæœ€å¤§èƒ½ä½¿ç”¨å¤šå°‘å†…å­˜\">ä¸€ã€32 ä½ç¨‹åºæœ€å¤§èƒ½ä½¿ç”¨å¤šå°‘å†…å­˜ï¼Ÿ</h3>\n<p><strong>ç†è®ºä¸Šé™çº¦ä¸º 4GB</strong></p>\n<p>32 ä½ç¨‹åºçš„å†…å­˜åœ°å€ç”± 32 ä¸ªäºŒè¿›åˆ¶ä½ç»„æˆï¼Œå› æ­¤ç†è®ºä¸Šå¯ä»¥æœ‰ 2Â³Â² = 4,294,967,296 ç§ä¸åŒçš„å†…å­˜åœ°å€ã€‚æ¯ä¸ªå†…å­˜åœ°å€æŒ‡å‘ 1 Byte çš„ç©ºé—´ï¼Œæ‰€ä»¥ï¼š</p>\n<blockquote>\n<p>32 ä½åœ°å€ç©ºé—´ = 2Â³Â² Byte (4<em>1024</em>1024*1024 B) â‰ˆ 4GB</p>\n</blockquote>\n<p><strong>ä¸ºä»€ä¹ˆæ–‡æ¡£ä¸­æåˆ° 2GBï¼Ÿ</strong></p>\n<p>Windows é»˜è®¤å°† 4GB è™šæ‹Ÿåœ°å€ç©ºé—´åˆ’åˆ†ä¸ºï¼š</p>\n<ul>\n<li><strong>2GB ç”¨æˆ·æ€</strong>ï¼šä¾›åº”ç”¨ç¨‹åºä½¿ç”¨</li>\n<li><strong>2GB å†…æ ¸æ€</strong>ï¼šä¾›æ“ä½œç³»ç»Ÿä½¿ç”¨</li>\n</ul>\n<p>å› æ­¤ï¼Œé»˜è®¤æƒ…å†µä¸‹å•è¿›ç¨‹å¯ç”¨ç”¨æˆ·æ€å†…å­˜ä¸º <strong>2GB</strong>ã€‚è¿™åªæ˜¯é»˜è®¤è¡Œä¸ºï¼Œå¹¶é 32 ä½ç¨‹åºçš„ç»å¯¹ä¸Šé™ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚å¯ç”¨ Large Address Aware + ç‰¹å®šç³»ç»Ÿé…ç½®ï¼‰ï¼Œå¯ä»¥è¶…è¿‡ 2GBã€‚</p>\n<hr />\n<h3 id=\"äºŒin-process-ä¸-out-of-process-æ¨¡å‹å¯¹å†…å­˜çš„å½±å“\">äºŒã€In-Process ä¸ Out-Of-Process æ¨¡å‹å¯¹å†…å­˜çš„å½±å“</h3>\n<p><img alt=\"image\" class=\"lazyload\" /></p>\n<h4 id=\"ä¸¤ç§æ‰˜ç®¡æ¨¡å¼å¯¹æ¯”\">ä¸¤ç§æ‰˜ç®¡æ¨¡å¼å¯¹æ¯”</h4>\n<table>\n<thead>\n<tr>\n<th>ç‰¹æ€§</th>\n<th>In-Process</th>\n<th>Out-of-Process</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å®¿ä¸»è¿›ç¨‹</td>\n<td><code>w3wp.exe</code>ï¼ˆIIS å·¥ä½œè¿›ç¨‹ï¼‰</td>\n<td><code>dotnet.exe</code>ï¼ˆç‹¬ç«‹è¿›ç¨‹ï¼‰</td>\n</tr>\n<tr>\n<td>è¿›ç¨‹æ•°é‡</td>\n<td>åº”ç”¨ä¸ IIS å…±äº«åŒä¸€è¿›ç¨‹</td>\n<td>åº”ç”¨è¿è¡Œåœ¨ç‹¬ç«‹è¿›ç¨‹ä¸­</td>\n</tr>\n<tr>\n<td>å†…å­˜éš”ç¦»</td>\n<td>ä¸ IIS å…±äº«å†…å­˜ç©ºé—´</td>\n<td>ç‹¬ç«‹å†…å­˜ç©ºé—´</td>\n</tr>\n<tr>\n<td>æ€§èƒ½</td>\n<td>æ›´é«˜ï¼ˆæ— è¿›ç¨‹é—´é€šä¿¡å¼€é”€ï¼‰</td>\n<td>ç•¥ä½ï¼ˆéœ€é€šè¿‡ HTTP ä»£ç†ï¼‰</td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"image\" class=\"lazyload\" /></p>\n<h4 id=\"in-process-æ¨¡å¼å†…å­˜è¡Œä¸º\">In-Process æ¨¡å¼å†…å­˜è¡Œä¸º</h4>\n<ul>\n<li>åº”ç”¨ä»£ç ç›´æ¥è¿è¡Œåœ¨ <code>w3wp.exe</code> è¿›ç¨‹ä¸­</li>\n<li>å†…å­˜ä¸Šé™å— <code>w3wp.exe</code> è¿›ç¨‹é™åˆ¶ï¼š\n<ul>\n<li>32 ä½ï¼šçº¦ <strong>2GB</strong>ï¼ˆWindows ç”¨æˆ·æ€é»˜è®¤é™åˆ¶ï¼‰</li>\n<li>64 ä½ï¼šå— Sandbox é™åˆ¶</li>\n</ul>\n</li>\n<li><strong>æ³¨æ„</strong>ï¼šåº”ç”¨å†…å­˜ + IIS æ¨¡å—å†…å­˜ å…±åŒå ç”¨è¿›ç¨‹ç©ºé—´</li>\n</ul>\n<h4 id=\"out-of-process-æ¨¡å¼å†…å­˜è¡Œä¸º\">Out-of-Process æ¨¡å¼å†…å­˜è¡Œä¸º</h4>\n<ul>\n<li>åº”ç”¨è¿è¡Œåœ¨ç‹¬ç«‹çš„ <code>dotnet.exe</code> è¿›ç¨‹ä¸­</li>\n<li>Kestrel ä½œä¸ºè¾¹ç¼˜æœåŠ¡å™¨ï¼ŒIIS ä»…ä½œä¸ºåå‘ä»£ç†</li>\n<li>å†…å­˜ä¸Šé™ç‹¬ç«‹è®¡ç®—ï¼š\n<ul>\n<li>32 ä½ï¼šçº¦ <strong>4GB</strong>ï¼ˆå¯å¯»å€ä¸Šé™ï¼‰</li>\n<li>64 ä½ï¼šå— Sandbox é™åˆ¶</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"azure-app-service-sandbox-é™åˆ¶\">Azure App Service Sandbox é™åˆ¶</h4>\n<p>åœ¨ Azure App Service ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªæ ¸å¿ƒé™åˆ¶ï¼š</p>\n<blockquote>\n<p><strong>Sandbox é™åˆ¶</strong>ï¼šè¿›ç¨‹å®é™…èƒ½è·å¾—çš„æœ€å¤§ç‰©ç†å†…å­˜ = æœºå™¨ç‰©ç†å†…å­˜ Ã— 75%</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th>App Service Plan</th>\n<th>ç‰©ç†å†…å­˜</th>\n<th>64ä½è¿›ç¨‹å¯ç”¨å†…å­˜ï¼ˆçº¦ï¼‰</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>B1/S1</td>\n<td>1.75 GB</td>\n<td>~1.3 GB</td>\n</tr>\n<tr>\n<td>B2/S2</td>\n<td>3.5 GB</td>\n<td>~2.6 GB</td>\n</tr>\n<tr>\n<td>B3/S3</td>\n<td>7 GB</td>\n<td>~5.25 GB</td>\n</tr>\n<tr>\n<td>P1v2</td>\n<td>3.5 GB</td>\n<td>~2.6 GB</td>\n</tr>\n<tr>\n<td>P2v2</td>\n<td>7 GB</td>\n<td>~5.25 GB</td>\n</tr>\n<tr>\n<td>P3v2</td>\n<td>14 GB</td>\n<td>~10.5 GB</td>\n</tr>\n</tbody>\n</table>\n<p><strong>æ€»ç»“ï¼š</strong></p>\n<ul>\n<li><strong>32 ä½è¿›ç¨‹</strong>ï¼šæ°¸è¿œæ— æ³•çªç ´çº¦ 4GB çš„å¯å¯»å€é™åˆ¶ï¼ˆå—æ‰˜ç®¡æ¨¡å¼å½±å“ä¸å¤§ï¼‰</li>\n<li><strong>64 ä½è¿›ç¨‹</strong>ï¼šä¼šè§¦åŠ Sandbox é™åˆ¶ï¼ˆæœ€å¤§çº¦ä¸ºç‰©ç†å†…å­˜çš„ 75%ï¼‰</li>\n</ul>\n<hr />\n<h3 id=\"ä¸‰å¤šä¸ªè™šæ‹Ÿç›®å½•æ—¶çš„å†…å­˜è®¡ç®—æ–¹å¼\">ä¸‰ã€å¤šä¸ªè™šæ‹Ÿç›®å½•æ—¶çš„å†…å­˜è®¡ç®—æ–¹å¼</h3>\n<p>å½“åŒä¸€ App Service ä¸‹å­˜åœ¨å¤šä¸ªè™šæ‹Ÿç›®å½•ï¼ˆvdirï¼‰æ—¶ï¼š</p>\n<h4 id=\"in-process-æ¨¡å¼\">In-Process æ¨¡å¼</h4>\n<ul>\n<li>æ‰€æœ‰è™šæ‹Ÿç›®å½•å…±äº«åŒä¸€ä¸ª <code>w3wp.exe</code> è¿›ç¨‹</li>\n<li>å†…å­˜ä¸Šé™ä¸ºè¯¥è¿›ç¨‹çš„æ€»ä¸Šé™ï¼ˆ32ä½çº¦2GBï¼Œ64ä½å—Sandboxé™åˆ¶ï¼‰</li>\n<li>å„åº”ç”¨é—´æ— å†…å­˜éš”ç¦»ï¼Œä¸€ä¸ªåº”ç”¨å†…å­˜æ³„æ¼å¯èƒ½å½±å“å…¶ä»–åº”ç”¨</li>\n</ul>\n<h4 id=\"out-of-process-æ¨¡å¼\">Out-of-Process æ¨¡å¼</h4>\n<ul>\n<li>æ¯ä¸ªè™šæ‹Ÿç›®å½•ä¼šç”Ÿæˆç‹¬ç«‹çš„ <code>dotnet.exe</code> è¿›ç¨‹</li>\n<li>æ¯ä¸ªè¿›ç¨‹å•ç‹¬è®¡ç®—å¯ç”¨å†…å­˜ä¸Šé™ï¼š\n<ul>\n<li>32 ä½ â†’ çº¦ 4GBï¼ˆå®é™…å¯èƒ½æ›´ä½ï¼Œå–å†³äºç³»ç»Ÿé…ç½®ï¼‰</li>\n<li>64 ä½ â†’ å— Sandbox é™åˆ¶ï¼ˆæœºå™¨å†…å­˜ Ã— 75%ï¼‰</li>\n</ul>\n</li>\n<li>å¤šä¸ªç«™ç‚¹å…±äº«åŒä¸€å° VM çš„ç‰©ç†å†…å­˜ï¼Œè¿›ç¨‹é—´ä¼šç›¸äº’ç«äº‰èµ„æº</li>\n<li><strong>ä¼˜åŠ¿</strong>ï¼šè¿›ç¨‹éš”ç¦»ï¼Œä¸€ä¸ªåº”ç”¨å´©æºƒä¸å½±å“å…¶ä»–åº”ç”¨</li>\n</ul>\n<hr />\n<h3 id=\"å››scmkuduè¿›ç¨‹æ˜¯å¦è®¡å…¥æ€»å†…å­˜\">å››ã€SCMï¼ˆKuduï¼‰è¿›ç¨‹æ˜¯å¦è®¡å…¥æ€»å†…å­˜ï¼Ÿ</h3>\n<p><strong>æ˜¯çš„</strong>ã€‚SCM è¿›ç¨‹ä¹Ÿè¿è¡Œåœ¨åŒä¸€å° VM ä¸Šï¼Œå…¶å†…å­˜å ç”¨ä¼šä¸€å¹¶è®¡å…¥ App Service Plan çš„ç‰©ç†å†…å­˜ä½¿ç”¨é‡ã€‚</p>\n<p><strong>Kudu å…¸å‹å†…å­˜å ç”¨</strong>ï¼šçº¦ 200MB - 500MBï¼ˆè§†æ“ä½œè€Œå®šï¼‰</p>\n<hr />\n<h3 id=\"äº”å¦‚ä½•ç›‘æ§-app-service-å†…å­˜ä½¿ç”¨\">äº”ã€å¦‚ä½•ç›‘æ§ App Service å†…å­˜ä½¿ç”¨ï¼Ÿ</h3>\n<h4 id=\"æ–¹æ³•ä¸€azure-portal-æŒ‡æ ‡\">æ–¹æ³•ä¸€ï¼šAzure Portal æŒ‡æ ‡</h4>\n<p>åœ¨ Azure Portal ä¸­æŸ¥çœ‹ App Service çš„ <strong>Metrics</strong>ï¼š</p>\n<ul>\n<li><code>Memory working set</code>ï¼šå½“å‰å·¥ä½œé›†å†…å­˜</li>\n<li><code>Private Bytes</code>ï¼šè¿›ç¨‹ç§æœ‰å†…å­˜</li>\n</ul>\n<h4 id=\"æ–¹æ³•äºŒkudu-è¿›ç¨‹ç®¡ç†å™¨\">æ–¹æ³•äºŒï¼šKudu è¿›ç¨‹ç®¡ç†å™¨</h4>\n<p>è®¿é—® <code>https://&lt;your-app&gt;.scm.chinacloudsites.cn/ProcessExplorer/</code> æŸ¥çœ‹ï¼š</p>\n<ul>\n<li>å„è¿›ç¨‹çš„å†…å­˜å ç”¨è¯¦æƒ…</li>\n<li><code>w3wp.exe</code> å’Œ <code>dotnet.exe</code> çš„å®æ—¶å†…å­˜çŠ¶æ€</li>\n</ul>\n<h4 id=\"æ–¹æ³•ä¸‰application-insights\">æ–¹æ³•ä¸‰ï¼šApplication Insights</h4>\n<p>å¯ç”¨ Application Insights åï¼Œå¯ç›‘æ§ï¼š</p>\n<ul>\n<li>å†…å­˜ä½¿ç”¨è¶‹åŠ¿</li>\n<li>å†…å­˜å¼‚å¸¸å‘Šè­¦</li>\n<li>GC è¡Œä¸ºåˆ†æ</li>\n</ul>\n<hr />\n<h2 id=\"æ€»ç»“\">æ€»ç»“</h2>\n<table>\n<thead>\n<tr>\n<th>åœºæ™¯</th>\n<th>å†…å­˜ä¸Šé™</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>32 ä½è¿›ç¨‹ï¼ˆç†è®ºï¼‰</td>\n<td>~4GB</td>\n</tr>\n<tr>\n<td>32 ä½è¿›ç¨‹ï¼ˆWindows é»˜è®¤ï¼‰</td>\n<td>~2GB</td>\n</tr>\n<tr>\n<td>64 ä½è¿›ç¨‹</td>\n<td>ç‰©ç†å†…å­˜ Ã— 75%</td>\n</tr>\n<tr>\n<td>In-Processï¼ˆ32ä½ï¼‰</td>\n<td>~2GBï¼ˆä¸IISå…±äº«ï¼‰</td>\n</tr>\n<tr>\n<td>Out-of-Processï¼ˆ32ä½ï¼‰</td>\n<td>~4GBï¼ˆç‹¬ç«‹è¿›ç¨‹ï¼‰</td>\n</tr>\n</tbody>\n</table>\n<p><strong>å»ºè®®</strong>ï¼š</p>\n<ol>\n<li>å¦‚æœåº”ç”¨å¯¹å†…å­˜éœ€æ±‚è¾ƒé«˜ï¼Œæ¨èä½¿ç”¨ <strong>64 ä½</strong> é…ç½®</li>\n<li>å¯¹äºéœ€è¦è¿›ç¨‹éš”ç¦»çš„åœºæ™¯ï¼Œé€‰æ‹© <strong>Out-of-Process</strong> æ¨¡å¼</li>\n<li>å®šæœŸç›‘æ§å†…å­˜ä½¿ç”¨ï¼Œé¿å…è§¦åŠä¸Šé™å¯¼è‡´åº”ç”¨å¼‚å¸¸</li>\n</ol>\n<hr />\n<h2 id=\"å‚è€ƒèµ„æ–™\">å‚è€ƒèµ„æ–™</h2>\n<ul>\n<li>\n<p>Virtual Address Space (Memory Management) : <a href=\"https://learn.microsoft.com/en-us/windows/win32/memory/virtual-address-space\" rel=\"noopener nofollow\" target=\"_blank\">https://learn.microsoft.com/en-us/windows/win32/memory/virtual-address-space</a></p>\n</li>\n<li>\n<p>.NET GC - Heap hard limit percent : <a href=\"https://learn.microsoft.com/en-us/dotnet/core/runtime-config/garbage-collector#heap-hard-limit-percent\" rel=\"noopener nofollow\" target=\"_blank\">https://learn.microsoft.com/en-us/dotnet/core/runtime-config/garbage-collector#heap-hard-limit-percent</a></p>\n</li>\n<li>\n<p>ASP.NET Core Module (In-Process vs Out-of-Process) : <a href=\"https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/aspnet-core-module\" rel=\"noopener nofollow\" target=\"_blank\">https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/aspnet-core-module</a></p>\n</li>\n<li>\n<p>Azure App Service Sandbox : <a href=\"https://github.com/projectkudu/kudu/wiki/Azure-Web-App-sandbox\" rel=\"noopener nofollow\" target=\"_blank\">https://github.com/projectkudu/kudu/wiki/Azure-Web-App-sandbox</a></p>\n</li>\n</ul>\n\n\n</div>\n<div id=\"MySignature\">\n    <div style=\"background: #1c5f55; height: 36px; width: 618px; padding: 14px 5px 0px 3px;\">\n  <p style=\"font-weight: bold; color: white;\">å½“åœ¨å¤æ‚çš„ç¯å¢ƒä¸­é¢ä¸´é—®é¢˜ï¼Œæ ¼ç‰©ä¹‹é“éœ€ï¼šæµŠè€Œé™ä¹‹å¾æ¸…ï¼Œå®‰ä»¥åŠ¨ä¹‹å¾ç”Ÿã€‚ äº‘ä¸­ï¼Œæ°æ˜¯å¦‚æ­¤!</p>\n</div>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-13 19:13</span>&nbsp;\n<a href=\"https://www.cnblogs.com/lulight\">ç¼–ç è€…å¢å¸ƒ</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">19</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "å°å®¹é‡32å•ç‰‡æœºä¹Ÿä¸Šbootloaderï¼Ÿæ‹†æœºçƒ§å½•çš„è‹¦è°æ‡‚ï¼Œèƒ½ä¸ŠæŠ“ç´§ä¸Š",
      "link": "https://www.cnblogs.com/pie-o/p/19613316",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/pie-o/p/19613316\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-13 18:54\">\n    <span>å°å®¹é‡32å•ç‰‡æœºä¹Ÿä¸Šbootloaderï¼Ÿæ‹†æœºçƒ§å½•çš„è‹¦è°æ‡‚ï¼Œèƒ½ä¸ŠæŠ“ç´§ä¸Š</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        åŸºäºè¡¨é©±åŠ¨æ„é€ çš„æ’ä»¶æœºåˆ¶ï¼Œå®ç°å•ç‰‡æœºä¸Šçš„bootloaderï¼Œä¸»è¦æ˜¯å¯¹é€šä¿¡ï¼Œåè®®ä»¥åŠbootè¿‡ç¨‹è¿›è¡Œäº†æ’ä»¶åŒ–æ”¹é€ \n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<blockquote>\n<p>é¦–å‘äº21icè®ºå›<br />\n<a href=\"https://bbs.21ic.com/icview-3453440-1-1.html\" rel=\"noopener nofollow\" target=\"_blank\">å°å®¹é‡32å•ç‰‡æœºä¹Ÿä¸Šbootloaderï¼Ÿæ‹†æœºçƒ§å½•çš„è‹¦è°æ‡‚ï¼Œèƒ½ä¸ŠæŠ“ç´§ä¸Š</a></p>\n</blockquote>\n<h2 id=\"å‰è¨€\">å‰è¨€</h2>\n<p>åœ¨ç ”å‘é˜¶æ®µéœ€è¦æ›´æ–°ç¨‹åºæ—¶ï¼Œç›´æ¥ä½¿ç”¨è°ƒè¯•å™¨è¿›è¡Œçƒ§å½•å³å¯ï¼Œä½†æ˜¯å¦‚æœæƒ³è¦å¯¹ä¸€ä¸ªå°è£…å¥½çš„äº§å“è¿›è¡Œç¨‹åºå‡çº§æ—¶ï¼Œä¸€èˆ¬éƒ½æ˜¯æ²¡æœ‰å¼•å‡ºçƒ§å½•æ¥å£çš„ï¼Œæ­¤æ—¶åªæœ‰æ‹†æœºä¸€é€”ã€‚</p>\n<p>å¦‚æœåªæœ‰ä¸€ä¸¤ä¸ªéœ€è¦æ›´æ–°ï¼Œé‚£ä¹ˆæ‹†ä¹Ÿå°±æ‹†äº†ï¼Œä½†æœ‰ä¸Šç™¾ä¸ªå‘¢ï¼Œæ­¤æ—¶ébootloaderä¸å¯ã€‚æœ¬æ–‡ä¸»æ—¨æ˜¯åœ¨å°å®¹é‡çš„32å•ç‰‡æœºä¸Šè¿›è¡Œå¼€å‘ï¼Œæ¯”å¦‚stm32f103èŠ¯ç‰‡ï¼Œè¿™æ ·çš„ä¸»æ§èŠ¯ç‰‡èµ„æºæ¯”è¾ƒç´§å¼ ï¼Œä½†æ˜¯å¦‚æœæœ‰æ¡ä»¶ä¸Šbootloaderï¼Œå»ºè®®ä¸€å®šè¦åšçš„ï¼ŒåŠŸèƒ½ä¸éœ€è¦å¤æ‚ï¼Œåªéœ€å®ç°æœ€åŸºæœ¬çš„å…¨é‡æ›´æ–°å°±è¡Œã€‚</p>\n<p>åœ¨è¿™åŸºç¡€ä¸Šï¼Œæˆ‘æ›´æƒ³å®ç°çš„æ˜¯ä¸€æ’ä»¶å¼çš„å·¥å…·ï¼ŒåŒ…æ‹¬bootæµç¨‹ã€äº¤äº’åè®®ã€æ•°æ®æµä»¥åŠflashé©±åŠ¨è¿™4ä¸ªç›¸å…³çš„æ’ä»¶ï¼Œå½“é¢å¯¹å¤šç§åº”ç”¨åœºæ™¯æ—¶ï¼Œè¿™æ ·çš„æ’ä»¶å¼è®¾è®¡å°†æå¤§æé«˜ä»£ç çš„å¤ç”¨èƒ½åŠ›ï¼Œæ–¹ä¾¿æ›¿æ¢ã€æ–°å¢ä»¥åŠåˆ é™¤ï¼Œä»è€Œæ”¹å˜ç¨‹åºçš„è¡Œä¸ºï¼Œå¹¶ä¸”æ›´ä¸ºé‡è¦çš„æ˜¯è¿™ç§æ”¹å˜æ²¡æœ‰å½±å“åˆ°ç¨‹åºçš„ä¸»ä½“æ¡†æ¶ã€‚</p>\n<p>æ¯”å¦‚ä¸€ä¸ªé¡¹ç›®ä¸­é€šè¿‡CANæ€»çº¿è¿›è¡Œæ›´æ–°ï¼Œè€Œå¦ä¸€ä¸ªé¡¹ç›®ä½¿ç”¨485ï¼Œè¿™æ—¶å€™åªéœ€è¦æ›´æ¢ç›¸åº”çš„æ’ä»¶å°±å¯å®ç°åŠŸèƒ½çš„è°ƒæ•´ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„<strong>ç­–ç•¥åŒæœºåˆ¶åˆ†ç¦»</strong></p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<hr />\n<h2 id=\"æŠ€æœ¯è¦ç‚¹\">æŠ€æœ¯è¦ç‚¹</h2>\n<h3 id=\"è¡¨é©±åŠ¨è®¾è®¡\">è¡¨é©±åŠ¨è®¾è®¡</h3>\n<p>ç½‘ä¸Šå…³äºè¡¨é©±åŠ¨çš„ä»‹ç»æœ‰å¾ˆå¤šï¼Œå¹¶ä¸”å®ç°èµ·æ¥ä¹Ÿæ˜¯å„å¼å„æ ·ï¼Œä½†æ˜¯æ€»ä½“è€Œè¨€ä½¿ç”¨è¿™ç§æ–¹æ³•çš„æ ¸å¿ƒè¿˜æ˜¯æŠ½è±¡ä¸è¾¨è¯†ï¼Œè¿™è¦æ±‚å¼€å‘è€…å¿…é¡»å¯¹è¦å®ç°çš„åº”ç”¨æœ‰ä¸€ä¸ªå…¨é¢çš„äº†è§£å’Œè®¤çŸ¥ï¼Œè¿™æ ·æ‰èƒ½ä»æ— åºä¸­è¯†åˆ«å‡ºæœ‰åºçš„ä¸»ä½“éƒ¨åˆ†ï¼Œè€Œè¿™éƒ¨åˆ†å¿…ç„¶æˆä¸ºç¨‹åºçš„æ¡†æ¶éƒ¨åˆ†ï¼Œæ˜¯é™æ€çš„ï¼Œå›ºå®šçš„ï¼Œè€Œå…¶ä½™çš„ä¾æ‰˜æ¡†æ¶å­˜åœ¨çš„é›¶æ•£éƒ¨åˆ†ï¼Œå±äºæ˜“å˜çš„ï¼Œå¯æ›¿æ¢çš„ã€‚</p>\n<p>è¦åšåˆ°ä»¥ä¸Šè¾¨è¯†å’Œåˆ†ç¦»çš„æ“ä½œï¼Œè¿˜çœŸçš„éœ€è¦ä¸å°‘åŠŸåº•ã€‚å…¶å®åªè¦æ¶‰åŠåˆ°æŸç§èŒƒå¼çš„ä½¿ç”¨ï¼Œéƒ½æˆ–å¤šæˆ–å°‘çš„æœ‰ä¸€äº›ç“¶é¢ˆï¼Œæˆ‘ç°åœ¨ä¹Ÿæ­£åœ¨å­¦ä¹ è¿™ç§æ–¹å¼ï¼Œå®ƒçš„éš¾ç‚¹åœ¨äºæ€ä¹ˆæ„é€ è¿™äº›è¡¨ï¼Œè¡¨çš„ç»“æ„è¯¥æ€ä¹ˆè®¾è®¡ï¼Œå¯ä»¥è®¤ä¸ºè¿™ä¸ªè¡¨å°±æ˜¯ä¸€ä¸ªç»“æ„åŒ–çš„è§£ç©ºé—´ï¼Œæ‰€è°“è§£ç©ºé—´å°±æ˜¯å¯¹è¡¨è¿›è¡Œè¾“å…¥çš„æ‰€æœ‰å“åº”ã€‚</p>\n<p>æ‰€ä»¥ä¸€ä¸ªå¥½çš„è¡¨ï¼Œå¿…ç„¶æœ‰ä¸€ä¸ªå¯ä»¥è¦†ç›–å¯èƒ½è¾“å…¥æƒ…å†µçš„æ‰€æœ‰å“åº”ï¼Œå½“ç„¶é™¤äº†è§£ç©ºé—´çš„ç¡®å®šå¤–ï¼Œæ±‚è§£çš„æ–¹æ³•ï¼Œæˆ–è€…è¯´æŠŠè¾“å…¥å˜æ¢åˆ°è§£ç©ºé—´çš„æ–¹æ³•ä¹Ÿæ˜¯ä¸å¯ç¼ºå°‘çš„ï¼Œè¿™äº›éƒ½æå¤§è€ƒéªŒå¼€å‘è€…çš„èƒ½åŠ›å’Œæ°´å¹³ã€‚</p>\n<p>ç›¸æ¯”äºæˆ‘ä¹‹å‰å†™ä»£ç çš„æ€è·¯ï¼Œé‚£éƒ½æ˜¯ç›´æˆªäº†å½“çš„ï¼Œå¹³å¿ƒè€Œè®ºï¼Œä»ä»»ä¸€ä¸ªå±€éƒ¨æ¥çœ‹è¿™ç§ä»£ç ï¼Œå®Œå…¨æ˜¯å¿ƒä¸­æ‰€æ€æ‰€æƒ³çš„ä¸€ä¸€æ˜ å°„ï¼Œä¹Ÿå°±æ˜¯å®Œå…¨æŠŠæˆ‘ä»¬çš„æ€è€ƒè¿‡ç¨‹è½¬åŒ–ä¸ºä»£ç ï¼Œè¿™æ ·çš„ä»£ç åº”è¯¥æ˜¯å¾ˆç¬¦åˆé€»è¾‘çš„ä¸æ˜¯å—ã€‚</p>\n<p>ä½†æ˜¯ä»å±€éƒ¨ä¸Šå‡çš„ç³»ç»Ÿçš„æ•´ä½“ï¼Œå°±ä¼šå‘ç°å±€éƒ¨çš„ç‰‡é¢å’Œæ¾æ•£ï¼Œè¿™æ ·çš„ä»£ç çš„æ¯ä¸ªéƒ¨åˆ†éƒ½ä¼šç¬¦åˆåŸæœ¬çš„é¢„æœŸï¼Œä½†ä¹Ÿä»…æ­¤è€Œå·²ï¼Œä¸€æŠŠé’¥åŒ™åªèƒ½é…ä¸€æŠŠé”ï¼Œä½†å”¯æœ‰é“ä¸æ‰ä¸æŒ‘é”ã€‚</p>\n<h3 id=\"è¡¨é©±åŠ¨ä¸çŠ¶æ€æœºç»“åˆ\">è¡¨é©±åŠ¨ä¸çŠ¶æ€æœºç»“åˆ</h3>\n<p>ä¸Šé¢åªä»‹ç»äº†è¡¨é©±åŠ¨çš„æ¦‚å¿µï¼Œç°åœ¨ä»‹ç»ä¸€ç§åº”ç”¨åœºæ™¯ï¼Œé‚£å°±æ˜¯å®ç°çŠ¶æ€æœºã€‚æˆ‘ä»¬éƒ½çŸ¥é“åœ¨ç¨‹åºä¸­çš„çŠ¶æ€æœºå°±æ˜¯é€šè¿‡å®šä¹‰ä¸€ç»„æœ‰é™çŠ¶æ€å’Œå…¶è½¬ç§»çš„è§„åˆ™æ¥æ§åˆ¶ç³»ç»Ÿè¡Œä¸ºçš„æ¨¡å‹ï¼Œä¸€èˆ¬æœ‰4ä¸ªç»„æˆéƒ¨åˆ†ï¼šçŠ¶æ€ã€äº‹ä»¶ã€è½¬æ¢å’ŒåŠ¨ä½œï¼Œé‚£ä¹ˆè¦æƒ³åŸºäºè¡¨é©±åŠ¨å®ç°çŠ¶æ€æœºï¼Œå°±éœ€è¦æŠŠè¿™4ä¸ªéƒ¨åˆ†æ·»åŠ åˆ°è¡¨ç»“æ„ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<pre><code class=\"language-c\">typedef struct{\n\tState CurState;\n\tEvent CurEvent;\n\tvoid (*Action)(void);\n\tState NextState;\n\n}TransitionItem_t;\n</code></pre>\n<p>è¿™æ ·åŸºæœ¬çš„ç»“æ„å°±æ˜¯è¡¨ä¸­æ¯ä¸€é¡¹çš„å†…å®¹ï¼Œè€Œä¸€ä¸ªè¡¨ä¸­æœ‰å¤šå°‘é¡¹ï¼Œå°±çœ‹å¼€å‘è€…è‡ªå·±æ€ä¹ˆç†è§£é—®é¢˜å’Œè§£æé—®é¢˜çš„äº†ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œç°åœ¨æœ‰ä¸€ä¸ªæŒ‰é”®å’Œä¸€ä¸ªLEDç¯ï¼Œè¦å®ç°å•å‡»æ—¶ï¼ŒLEDç¯å¸¸äº®ï¼Œåœ¨å¸¸äº®è¿‡ç¨‹ä¸­é•¿æŒ‰æ—¶ï¼ŒLEDé—ªçƒï¼Œåœ¨é—ªçƒè¿‡ç¨‹ä¸­å•å‡»ï¼ŒLEDå¸¸ç­ã€‚</p>\n<p>åœ¨é‡åˆ°è¿™ç§åº”ç”¨æ—¶ï¼Œä¸è¦ç›´æ¥å¼€å§‹å†™ä»£ç ï¼Œæ— è®ºå¤šç®€å•ï¼Œå…ˆåˆ†æä¸€ä¸‹ï¼Œç”»ä¸ªçŠ¶æ€å›¾ï¼š</p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p>ç„¶åæ ¹æ®çŠ¶æ€å›¾ï¼Œå®šä¹‰çŠ¶æ€è¡¨ï¼š</p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p>ä¸Šé¢è¿™ä¸ªçŠ¶æ€è¡¨å°±å¯ä»¥å®Œå…¨è®¾è®¡åˆ°æˆ‘ä»¬çš„ä»£ç ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<pre><code class=\"language-c\">TransitionItem_t FsmTable[] = {\n\t{LED_OFFï¼ŒKEY_CLICK,LightUp,LED_ON},\n\t{LED_ONï¼ŒKEY_LONG,Toggle,LED_TOGGLE},\n\t{LED_TOGGLEï¼ŒKEY_CLICK,LightOff,LED_OFF}\n}\n</code></pre>\n<p>é‚£ä¹ˆç°åœ¨è¡¨ç»“æ„æœ‰äº†ï¼Œæˆ–è€…è¯´è§£ç©ºé—´æœ‰äº†ï¼Œæ€ä¹ˆæ±‚è§£å‘¢ï¼Œæœ€ç®€å•çš„å°±æ˜¯æŸ¥è¡¨ï¼Œå¯¹æ¯”ä¸¤ä¸ªå…ƒç´ ï¼Œå½“å‰çŠ¶æ€ä»¥åŠå‘ç”Ÿçš„äº‹ä»¶ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­å°±æ˜¯(LED_OFF,KEY_CLICK)ã€(LED_ON,KEY_LONG)ä»¥åŠ(LED_TOGGLEï¼ŒKEY_CLICK)ï¼Œï¼ˆæœ‰æ²¡æœ‰ç‚¹åƒå¤šå…ƒç¦»æ•£å‡½æ•°ï¼Œå¯ä»¥ç»“åˆç€åŠ æ·±å¯¹æ¯”ç†è§£ï¼‰ã€‚</p>\n<p>åªè¦ç¬¦åˆè¿™ä¸‰ä¸ªå®šä¹‰å¥½çš„ç»„åˆä¹‹ä¸€ï¼Œé‚£ä¹ˆå¿…ç„¶å‘ç”ŸåŠ¨ä½œï¼Œå¦‚æœä¸å±äºä¸‰ä¸ªä¹‹ä¸€ï¼Œé‚£ä¹ˆä»€ä¹ˆååº”éƒ½æ²¡æœ‰ï¼Œä¹Ÿä¸å½±å“ç°æœ‰çŠ¶æ€ï¼Œé©±åŠ¨ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<pre><code class=\"language-c\">void RunFsm(TransitionItem_t *fsm,int fsm_size){\n\t/* åˆ¤æ–­æ˜¯å¦ä¸ºç©ºæŒ‡é’ˆ */\n\tif(fsm){\n\t\tfor(int i = 0;i&lt;fsm_size;i++){\n\t\t/* æ¡ä»¶å¯¹æ¯” */\n\t\t\tif(fsm[i].CurState == GlobalState &amp;&amp; fsm[i].CurEvent == GlobalEvent){\n\t\t\t/* æ‰§è¡ŒåŠ¨ä½œ */\n\t\t\t\tfsm[i].Action();\n\t\t\t\t/* æ‰§è¡ŒçŠ¶æ€è½¬ç§» */\n\t\t\t\tGlobalState = fsm[i].NextState;\n\t\t\t}\n\t\t}\n\t}\n}\n</code></pre>\n<h3 id=\"bootloaderç®€ä»‹\">Bootloaderç®€ä»‹</h3>\n<p>Bootloaderæ˜¯åµŒå…¥å¼ç³»ç»Ÿä¸­ä¸€æ®µç‰¹æ®Šçš„å¼•å¯¼ç¨‹åºï¼Œç”¨äºå›ºä»¶åŠ è½½æˆ–æ›´æ–°ç­‰åŠŸèƒ½ï¼Œåœ¨èŠ¯ç‰‡å‘ç”Ÿå¤ä½æ—¶é¦–å…ˆä¼šè¿›å…¥Bootloaderè¿›è¡Œå¼•å¯¼ï¼Œå†³å®šæ˜¯å¦æ›´æ–°æˆ–è·³è½¬åº”ç”¨ç¨‹åºã€‚</p>\n<p>åœ¨è¿™é‡Œä½¿ç”¨çš„æ˜¯å°å®¹é‡çš„å•ç‰‡æœºï¼Œæ‰€ä»¥Bootloaderç¨‹åºå°½é‡ç²¾ç®€ï¼Œè¿™æ ·å¯ä»¥ç»™åº”ç”¨ç¨‹åºè®©å‡ºæ›´å¤šçš„ç©ºé—´ï¼Œä¸€èˆ¬ç®€å•çš„åº”ç”¨ä¸‹æˆ‘ä»¬ä¼šè¿›è¡Œåˆ†åŒºï¼Œåˆ†ä¸ºBootloaderåŒºå’ŒAppåŒºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p>å¯ä»¥çœ‹åˆ°å¤§è‡´ä¸Šæœ€ç®€å•çš„åˆ†åŒºæ–¹æ¡ˆå°±æ˜¯è¿™æ ·ï¼Œå…¶ä¸­appæœ‰æ•ˆæ ‡å¿—æ”¾åœ¨äº†BootloaderåŒºæœ«å°¾ï¼Œè¿™ä¸ªæ ‡å¿—å°±æ˜¯Bootloaderè¿›è¡Œå¼•å¯¼çš„æ¡ä»¶ã€‚</p>\n<p>å¯¹äºå›ºä»¶å‡çº§æ¥è¯´ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡Bootloaderå¯¹AppåŒºåŸŸè¿›è¡Œæ“¦å†™åŠ¨ä½œï¼Œæ•°æ®æ¥æºäºå¤–éƒ¨ï¼Œå†…å®¹å°±æ˜¯Appå·¥ç¨‹ç¼–è¯‘å‡ºæ¥çš„binæ–‡ä»¶ï¼Œå¦‚æœåœ¨æ²¡æœ‰å…¶ä»–é¢å¤–Flashçš„æ”¯æŒä¸‹ï¼Œè¿›è¡Œå‡çº§çš„é£é™©è¿˜æ˜¯è›®å¤§çš„ï¼Œæ‰€ä»¥éœ€è¦æœ‰ä¸€å®šçš„å®‰å…¨æ ¡éªŒæªæ–½ã€‚</p>\n<p>æ€»çš„æ¥è¯´ï¼Œè¦å®ç°ä¸€ä¸ªåŸºæœ¬çš„Bootloaderï¼Œæµç¨‹è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå¤§è‡´å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šå›¾çš„æµç¨‹ä¸­æ˜¾ç¤ºäº†ä¸¤ç§å¤ä½æƒ…å†µï¼Œå³ä¸Šç”µå¤ä½å’Œè½¯ä»¶å¤ä½ï¼Œå…¶ä¸­è½¯ä»¶å¤ä½æ˜¯ä»åº”ç”¨ç¨‹åºä¸­è¿›è¡Œçš„å¤ä½ï¼Œæ˜¯ä¸“é—¨ä¸ºå›ºä»¶å‡çº§è®¾å®šçš„ï¼Œè¡¨ç¤ºå­˜åœ¨æ›´æ–°è¯·æ±‚ï¼Œå½“ç„¶å¯ä»¥é™„åŠ æ›´å¤šçš„ä¿¡æ¯ï¼ŒåŒæ—¶è½¯ä»¶å¤ä½æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯ä¸ä¼šæ”¹å˜RAMçš„æ•°æ®ã€‚</p>\n<p>ä¸ç®¡å“ªç§å¤ä½ï¼Œåªè¦å­˜åœ¨æ›´æ–°è¯·æ±‚ï¼Œå°±ä¼šç¬¬ä¸€æ—¶é—´æŠŠAppæœ‰æ•ˆæ ‡å¿—ä½æ¸…é™¤ï¼Œè¿™æ ·å¦‚æœåœ¨æ›´æ–°è¿‡ç¨‹ä¸­å‘ç”Ÿä»»ä½•é—®é¢˜ï¼Œæ ‡å¿—ä½éƒ½æ˜¯æ— æ•ˆçš„ï¼Œé¿å…å‘ç”Ÿé”™è¯¯è·³è½¬çš„é—®é¢˜ï¼Œåªæœ‰å®Œæˆå…¨éƒ¨çš„æ›´æ–°æµç¨‹ï¼ŒåŒ…æ‹¬æ ¡éªŒç­‰æ“ä½œåæ‰ä¼šæ ‡è®°æœ‰æ•ˆã€‚</p>\n<p>åŒæ—¶ï¼Œå¦‚æœæ˜¯æ­£å¸¸çš„ä¸Šç”µå¤ä½ï¼Œæˆ–è€…æ›´æ–°å¤±è´¥åï¼Œéƒ½ä¼šåœç•™åœ¨Bootloaderä¸­ï¼Œç­‰å¾…è¶…æ—¶ï¼Œåˆ¤æ–­æœ‰æ•ˆæ ‡å¿—ï¼Œå†³å®šæ˜¯å¦è·³è½¬ã€‚</p>\n<h2 id=\"ç»¼åˆå®è·µ\">ç»¼åˆå®è·µ</h2>\n<p>ç°åœ¨ç»è¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œå·²ç»å¤§è‡´å¯¹æ¶‰åŠçš„æŠ€æœ¯è¦æ±‚æœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯å¯¹æ’ä»¶å¼çš„Bootloaderè¿›è¡Œè®¾è®¡äº†ã€‚</p>\n<p>æœ‰ä¸€ä¸ªå¾ˆæ ¸å¿ƒçš„æ¦‚å¿µï¼Œå°±æ˜¯<strong>ç­–ç•¥ä¸æœºåˆ¶åˆ†ç¦»</strong>ï¼Œå¯¹åº”åˆ°æˆ‘ä»¬çš„è®¾è®¡ä¸­ï¼Œæœºåˆ¶å°±æ˜¯BootloaderåŠŸèƒ½ï¼Œç­–ç•¥å°±æ˜¯å®ç°åŠŸèƒ½çš„æ–¹å¼ã€‚</p>\n<p>ä¹ä¸€çœ‹ï¼Œç­–ç•¥è¿˜æ¯”è¾ƒå¥½ç†è§£ï¼Œæœºåˆ¶è¦æ€ä¹ˆç†è§£å‘¢ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§å®¹å™¨ã€æ¡†æ¶æˆ–æ¨¡å‹ï¼Œç”šè‡³å°±æ˜¯ä¸€å¥—å›ºåŒ–è§„åˆ™ï¼Œç­–ç•¥åƒåƒä¸‡ï¼Œä½†éƒ½å¿…é¡»æ˜ å°„åˆ°æœºåˆ¶çš„è§„åˆ™åŸŸä¸­æ‰èƒ½åœ¨æœºåˆ¶çš„ä¸–ç•Œä¸­å­˜åœ¨ã€‚</p>\n<p>å½“ç„¶æ¯ä¸ªäººæœ‰æ¯ä¸ªäººçš„ç†è§£ï¼Œä¸åŒçš„ç†è§£ä¹Ÿäº§ç”Ÿä¸åŒçš„ä»£ç ï¼Œç°åœ¨ä»‹ç»ä¸€ä¸‹æˆ‘å¯¹Bootloaderæœºåˆ¶çš„ç†è§£ï¼Œå…ˆä¸Šå›¾å¤§è‡´æè¿°ä¸€ä¸‹ï¼š</p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p>ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ°æœ‰4ä¸ªä¸»è¦çš„å…ƒç´ ï¼Œä¹Ÿå¯ä»¥çœ‹ä½œèŠ‚ç‚¹ï¼ŒåŒ…æ‹¬é€šä¿¡æµç¨‹ã€åè®®äº¤äº’æµç¨‹ã€Bootæµç¨‹ä»¥åŠFlashé©±åŠ¨ï¼Œå¯ä»¥è®¤ä¸ºè¦å®ç°ä¸€ä¸ªæœ€åŸºç¡€çš„Bootloaderå¿…é¡»è¦æœ‰è¿™4ä¸ªå…ƒç´ ï¼Œè€Œè¿™äº›ä¹Ÿæ˜¯æœºåˆ¶æ‰€å›ºæœ‰çš„æˆåˆ†ï¼Œæ‰€æœ‰ç­–ç•¥éƒ½æ˜¯ä½œç”¨åœ¨è¿™4ä¸ªå…ƒç´ ä¹‹ä¸Šçš„ã€‚</p>\n<p>å…¶ä¸­ä¸ºä»€ä¹ˆFlashä¸å…¶ä»–3ä¸ªä¸ä¸€æ ·ï¼Œæ˜¯å› ä¸ºåœ¨å®ç°ä¸­ï¼ŒFlashè¯»å†™éƒ½æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œå¹¶ä¸”ç”±Bootæµç¨‹ç›´æ¥æ§åˆ¶ï¼›è€Œæµç¨‹çš„æ§åˆ¶å°±å¯ä»¥ä½¿ç”¨çŠ¶æ€æœºæ¥å®ç°ï¼Œæœ¬è´¨ä¸Šæ¥è¯´ï¼ŒçŠ¶æ€æœºæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æœºåˆ¶ï¼Œè€Œç°åœ¨é€šè¿‡è¡¨é©±åŠ¨æ–¹æ³•ï¼Œå¢å¼ºäº†è¿™ä¸€æœºåˆ¶çš„é€šç”¨æ€§å’Œçµæ´»æ€§ï¼Œåªéœ€è¦æ›´æ¢çŠ¶æ€è¡¨ï¼Œå°±å¯ä»¥å®ç°ç­–ç•¥çš„æ”¹å˜ã€‚</p>\n<p>é‚£ä¹ˆç°åœ¨å±€éƒ¨å…ƒç´ éƒ½ä»‹ç»å®Œäº†ï¼Œè¯¥æ€ä¹ˆåœ¨å„å…ƒç´ ä¹‹é—´å»ºç«‹å…³è”å‘¢ï¼Œå¯ä»¥æœ‰æ¶ˆæ¯ã€è®¢é˜…å‘å¸ƒç­‰æ–¹å¼ï¼Œä½†æ˜¯ï¼Œè¿™äº›éƒ½å¤§æå°ç”¨äº†ï¼Œé€šè¿‡æ¢³ç†ï¼Œå‘ç°å®Œå…¨å¯ä»¥ä½¿ç”¨é“¾å¼é€šçŸ¥çš„æ–¹å¼æ¥å»ºç«‹å…³ç³»ã€‚</p>\n<p>åœ¨ä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ°æµå‘ä¸­æ ‡è¯†çš„1.1ã€1.2ç­‰å­—æ ·ï¼Œç”¨å‰åçº§æ¥æè¿°çš„è¯å°±æ˜¯ï¼Œç”±å‰çº§<strong>ä¸»åŠ¨é€šçŸ¥</strong>åçº§è¯¥åšä»€ä¹ˆï¼Œå¦åˆ™åçº§ä»€ä¹ˆéƒ½ä¸åšï¼Œå½“ç„¶è¿™ä¸ªå‰åçº§å¯ä»¥ä¸æ˜¯å›ºå®šçš„å‰åçº§ï¼Œæ˜¯ç›¸å¯¹çš„å‰åçº§ï¼Œå¯ä»¥æƒ³è±¡ä¸€ä¸‹ç¯å½¢é“¾è¡¨ï¼Œä»¥ä¸Šå°±æ˜¯æˆ‘æ‰€è®¾è®¡çš„æœºåˆ¶å†…å®¹ï¼Œå®ƒçš„çº¦æŸï¼Œæˆ–è€…è¯´åº”ç”¨æ¡ä»¶å¯ä»¥å½’çº³ä»¥ä¸‹å‡ ç‚¹ï¼š</p>\n<ul>\n<li>å•å‘æµæ§ï¼Œé“¾å¼è§¦å‘</li>\n<li>æœºåˆ¶ç»“æ„å›ºå®šï¼Œéœ€è¯†åˆ«æˆ–è½¬åŒ–ç­–ç•¥ä»¥æ»¡è¶³ç»“æ„è¦æ±‚</li>\n</ul>\n<p>ä¸‹é¢ç»™å‡ºå®ç°æœºåˆ¶çš„ä¸»è¦ä»£ç ï¼š<br />\nçŠ¶æ€æœºçš„ç»“æ„ï¼š</p>\n<pre><code class=\"language-c\">/* çŠ¶æ€è¡¨ç»“æ„å®šä¹‰ */\ntypedef struct\n{\n/* çŠ¶æ€è¡¨äº‹ä»¶é¡¹ */\n&nbsp; &nbsp; uint32_t Event;\n/* çŠ¶æ€è¡¨çŠ¶æ€é¡¹ */\n&nbsp; &nbsp; uint32_t State;\n/* çŠ¶æ€è¡¨åŠ¨ä½œé¡¹ */\n&nbsp; &nbsp; int (*Action)(uint32_t *event, void *arg);\n/* çŠ¶æ€è¡¨è½¬ç§»é¡¹ */\n&nbsp; &nbsp; uint32_t NextState;\n\n} TransitionItem_t;\n\ntypedef struct\n\n/* åŸºç±»çŠ¶æ€æœºå®šä¹‰ */\n{\n/* çŠ¶æ€è¡¨ */\n&nbsp; &nbsp; TransitionItem_t *FsmTable;\n/* å½“å‰çŠ¶æ€ */\n&nbsp; &nbsp; uint32_t CurState;\n/* å½“å‰å‘ç”Ÿäº‹ä»¶ */\n&nbsp; &nbsp; uint32_t CurEvent;\n/* çŠ¶æ€è¡¨å°ºå¯¸ */\n&nbsp; &nbsp; uint32_t FsmSize;\n\n} BaseFsm_t;\n\n</code></pre>\n<p>å®šä¹‰äº†çŠ¶æ€è¡¨çš„ç»“æ„ï¼Œä»¥åŠåŸºç±»çŠ¶æ€æœºçš„ç»“æ„ï¼ŒåŸºç±»çŠ¶æ€æœºæä¾›ç»™4ä¸ªå…ƒç´ ä½¿ç”¨ï¼Œå…¶æ¬¡æ˜¯è¿è¡ŒçŠ¶æ€æœºçš„é©±åŠ¨ä»£ç ï¼š</p>\n<pre><code class=\"language-c\">int RunFsm(BaseFsm_t *fsm, void *arg)\n{\n/* é˜²æ­¢ç©ºæŒ‡é’ˆé”™è¯¯ */\n&nbsp; &nbsp; if (fsm-&gt;FsmTable != NULL)\n&nbsp; &nbsp; {\n\n&nbsp; &nbsp; &nbsp; &nbsp; for (uint32_t i = 0; i &lt; fsm-&gt;FsmSize; i++)\n&nbsp; &nbsp; &nbsp; &nbsp; {\n&nbsp; &nbsp; &nbsp; &nbsp; /* (çŠ¶æ€,äº‹ä»¶)å…ƒç»„å¯¹æ¯” */\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (fsm-&gt;CurState == fsm-&gt;FsmTable[i].State &amp;&amp; fsm-&gt;CurEvent == fsm-&gt;FsmTable[i].Event)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {\n\t\t\t\t/* é˜²æ­¢ç©ºæŒ‡é’ˆé”™è¯¯ */\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (fsm-&gt;FsmTable[i].Action != NULL)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* æ‰§è¡ŒåŠ¨ä½œ */\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fsm-&gt;FsmTable[i].Action(&amp;fsm-&gt;CurEvent, arg);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n\t\t\t\t/* çŠ¶æ€è½¬ç§» */\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fsm-&gt;CurState = fsm-&gt;FsmTable[i].NextState;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;\n\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n\n&nbsp; &nbsp; &nbsp; &nbsp; }\n\n&nbsp; &nbsp; }\n&nbsp; &nbsp; else\n\n&nbsp; &nbsp; {\n&nbsp; &nbsp; &nbsp; &nbsp; return -1;\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; return 0;\n\n}\n</code></pre>\n<p>æ¥ä¸‹æ¥æ˜¯é€šä¿¡æµç¨‹çš„ç»“æ„è®¾è®¡ï¼š</p>\n<pre><code class=\"language-c\">/* é€šä¿¡æµç¨‹çš„ç»“æ„è®¾è®¡ */\ntypedef struct\n{\n&nbsp; &nbsp; struct\n&nbsp; &nbsp; {\n\t&nbsp; &nbsp; /* æµç¨‹æ§åˆ¶çŠ¶æ€è¡¨ */\n&nbsp; &nbsp; &nbsp; &nbsp; BaseFsm_t *Fsm;\n&nbsp; &nbsp; &nbsp; &nbsp; /* é©±åŠ¨å™¨ç”±å¤–éƒ¨æä¾› ä¸»è¦æ˜¯æ¯ç§é€šä¿¡é©±åŠ¨æ–¹å¼å·®å¼‚æ¯”è¾ƒå¤§ï¼Œåšä¸åˆ°é€šç”¨ */\n&nbsp; &nbsp; &nbsp; &nbsp; void *Driver;\n&nbsp; &nbsp; &nbsp; &nbsp; /* ç”¨äºé€šçŸ¥æµç¨‹è·¯å¾„ä¸­ä¸‹ä¸€èŠ‚ç‚¹ï¼Œé€‚ç”¨äºå•ä¸€è·¯å¾„ */\n&nbsp; &nbsp; &nbsp; &nbsp; void *Linkto;\n&nbsp; &nbsp; } PrivateArea;\n\n&nbsp; &nbsp; /* åˆå§‹åŒ– ä¼ å…¥çŠ¶æ€æœºå’Œé©±åŠ¨å™¨ éƒ½ç”±ç”¨æˆ·æ ¹æ®æ¡†æ¶è‡ªå®šä¹‰ */\n&nbsp; &nbsp; void (*Init)(BaseFsm_t *fsm, void *driver, void *link);\n\t/* è·å–çŠ¶æ€æœº */\n&nbsp; &nbsp; BaseFsm_t *(*GetFsm)(void);\n\t/* è·å–é€šä¿¡é©±åŠ¨å™¨ */\n&nbsp; &nbsp; void *(*GetDriver)(void);\n\t/* è·å–ä¸‹ä¸€èŠ‚ç‚¹ */\n&nbsp; &nbsp; void *(*GetLink)(void);\n\n} DataStreamHandle_t;\n</code></pre>\n<p>é€šä¿¡èŠ‚ç‚¹å¯ä»¥è®¤ä¸ºæ˜¯æ•´ä¸ªæœºåˆ¶çš„è§¦å‘èŠ‚ç‚¹ï¼Œå› ä¸ºæ‰€æœ‰çš„äº‹ä»¶æµéƒ½å¯ä»¥ç”±é€šä¿¡æ¥å¼•å¯¼ï¼ŒåŒ…æ‹¬æ— é€šä¿¡é€ æˆçš„è¶…æ—¶äº‹ä»¶æµï¼›ç»§æ‰¿äº†ä¸Šé¢çš„åŸºç±»çŠ¶æ€è¡¨ï¼Œæ‰©å±•äº†é€šä¿¡å¿…è¦çš„é©±åŠ¨å™¨ï¼Œè¿˜æœ‰ä¸€äº›æ–¹æ³•å®šä¹‰ã€‚</p>\n<p>å…¶æ¬¡æ˜¯äº¤äº’åè®®æµç¨‹çš„ç»“æ„å®šä¹‰ï¼š</p>\n<pre><code class=\"language-c\">typedef struct\n{\n&nbsp; &nbsp; struct\n&nbsp; &nbsp; {\n\t&nbsp; &nbsp; /* æµç¨‹æ§åˆ¶çŠ¶æ€è¡¨ */\n&nbsp; &nbsp; &nbsp; &nbsp; BaseFsm_t *Fsm;\n&nbsp; &nbsp; &nbsp; &nbsp; /* ç”¨äºé€šçŸ¥æµç¨‹è·¯å¾„ä¸­ä¸‹ä¸€èŠ‚ç‚¹ï¼Œé€‚ç”¨äºå•ä¸€è·¯å¾„ */\n&nbsp; &nbsp; &nbsp; &nbsp; void *Linkto;\n&nbsp; &nbsp; &nbsp; &nbsp; /* åè®®ä½“ - å°è£…ä¸è§£æåè®®ä¸­çš„æ•°æ®æˆ–åè®®ç‰¹å¾ */\n&nbsp; &nbsp; &nbsp; &nbsp; void *ProtoBody;\n&nbsp; &nbsp; } PrivateArea;\n\t/* åˆå§‹åŒ– ä¼ å…¥çŠ¶æ€æœºå’Œåè®®ä½“ éƒ½ç”±ç”¨æˆ·æ ¹æ®æ¡†æ¶è‡ªå®šä¹‰ */\n&nbsp; &nbsp; void (*Init)(BaseFsm_t *fsm, void *link, void *data_body);\n\t/* è·å–çŠ¶æ€æœº */\n&nbsp; &nbsp; BaseFsm_t *(*GetFsm)(void);\n\t/* è·å–åè®®ä½“ */\n&nbsp; &nbsp; void *(*GetProtoBody)(void);\n\t/* è·å–ä¸‹ä¸€èŠ‚ç‚¹ */\n&nbsp; &nbsp; void *(*GetLink)(void);\n\n} ProtocalHandle_t;\n</code></pre>\n<p>åŒæ ·çš„ï¼Œç»§æ‰¿äº†åŸºç±»çš„çŠ¶æ€è¡¨ï¼ŒåŒæ—¶æ‰©å±•äº†ä¸€ä¸ªåè®®ä½“å±æ€§ï¼Œè¿™ä¸ªå±æ€§çš„ç»“æ„æ˜¯è‡ªå®šä¹‰çš„ï¼Œä½“ç°åè®®çš„é€šå¼ï¼Œç”¨äºå°è£…å’Œè§£ææ•°æ®ä½¿ç”¨ã€‚</p>\n<p>æœ€åå°±æ˜¯Bootæµç¨‹çš„ç»“æ„å®šä¹‰ï¼š</p>\n<pre><code class=\"language-c\">typedef struct\n{\n&nbsp; &nbsp; struct\n&nbsp; &nbsp; {\n\t&nbsp; &nbsp; /* æµç¨‹æ§åˆ¶çŠ¶æ€è¡¨ */\n&nbsp; &nbsp; &nbsp; &nbsp; BaseFsm_t *Fsm;\n\t\t/* flashé©±åŠ¨å™¨ */\n&nbsp; &nbsp; &nbsp; &nbsp; void *FlashDriver;\n\t\t/* ç”¨äºé€šçŸ¥æµç¨‹è·¯å¾„ä¸­ä¸‹ä¸€èŠ‚ç‚¹ï¼Œé€‚ç”¨äºå•ä¸€è·¯å¾„ */\n&nbsp; &nbsp; &nbsp; &nbsp; void *Linkto;\n\n&nbsp; &nbsp; } PrivateArea;\n\n&nbsp; &nbsp; void (*Init)(BaseFsm_t *fsm, void *link, void *driver);\n&nbsp; &nbsp; BaseFsm_t *(*GetFsm)(void);\n&nbsp; &nbsp; void *(*GetFlashDriver)(void);\n&nbsp; &nbsp; void *(*GetLink)(void);\n\n} BootloaderHandle_t;\n</code></pre>\n<p>åŸºæœ¬å’Œä¸Šé¢çš„ç»“æ„å¤§åŒå°å¼‚ï¼Œè‡³æ­¤æ•´ä¸ªæœºåˆ¶çš„ç»“æ„å°±å®šä¹‰å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ¡†æ¶çš„æ­å»ºäº†ã€‚</p>\n<p>é¦–å…ˆï¼Œä¸€èˆ¬çš„é€šä¿¡æ¥æ”¶åŠŸèƒ½éƒ½ä¼šåœ¨ä¸­æ–­ä¸­è¿›è¡Œï¼Œå› ä¸ºè¿™æ ·å®æ—¶æ€§æœ€é«˜ï¼Œèƒ½åŠæ—¶çš„å¤„ç†æ•°æ®ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„é€šä¿¡æµç¨‹çš„è§¦å‘å¯ä»¥ç»“åˆæ¥æ”¶ä¸­æ–­æ¥è¿›è¡Œï¼Œä»¥CANæ¥æ”¶ä¸­æ–­ä¸¾ä¾‹ï¼š</p>\n<pre><code class=\"language-c\">void HAL_CAN_RxFifo0MsgPendingCallback(CAN_HandleTypeDef *hcan)\n\n{\n\tuint8_t i = 0;\n\t\n&nbsp; if (hcan-&gt;Instance == CAN1)\n&nbsp; {\n\n&nbsp; &nbsp; HAL_CAN_GetRxMessage(hcan, CAN_RX_FIFO0, &amp;CANxRxHeader, CANRecvBuf);\n&nbsp; &nbsp; if (CANxRxHeader.DLC &gt; 0)\n&nbsp; &nbsp; {\n&nbsp; &nbsp;  /* ä½œä¸ºè§¦å‘æ¡ä»¶ */\n&nbsp; &nbsp; &nbsp; CanMsgRecved = 1;\n&nbsp; &nbsp; }\n&nbsp; }\n}\n</code></pre>\n<p>è¿™æ ·ï¼Œé€šè¿‡çŠ¶æ€æœºå°±å¯ä»¥æ§åˆ¶é€šä¿¡çš„æµç¨‹ï¼ŒåŒæ—¶ä¼ å…¥é€šä¿¡ç”¨çš„é©±åŠ¨å™¨ï¼Œå› ä¸ºæˆ‘ä»¬è®¾è®¡çš„æ—¶å€™éƒ½æ˜¯é‡‡ç”¨<code>void *</code>è¿™ç§æŠ½è±¡æŒ‡é’ˆï¼Œæ‰€ä»¥çµæ´»ç¨‹åº¦å¾ˆé«˜ã€‚ç„¶åå°±æ˜¯åè®®äº¤äº’æµç¨‹å’ŒBootæµç¨‹çš„ä½¿ç”¨ï¼Œè¿™äº›éƒ½å¯ä»¥æ”¾åˆ°ä»¥æŸä¸€æ—¶åŸºä¸ºå‘¨æœŸè¿è¡Œçš„ä»£ç å—ä¸­ï¼š</p>\n<pre><code class=\"language-c\">&nbsp;while (1)\n&nbsp;{\n\t&nbsp;\n\t/* 1msæ—¶åŸº */\n&nbsp; &nbsp; if (TIMEBASE_HOOK(TimeBaseScope, OPT_TIMEBASE_1MS))\n&nbsp; &nbsp; {\n\n&nbsp; &nbsp; &nbsp; TIMEBASE_DROP(TimeBaseScope, OPT_TIMEBASE_1MS);\n&nbsp; &nbsp; &nbsp; /* å•è·¯å¾„æµç¨‹ï¼Œæ€»æ˜¯é€šè¿‡å‰çº§ä¸»åŠ¨é€šçŸ¥åçº§è¯¥åšä»€ä¹ˆ(è‡ªå®šä¹‰äº‹ä»¶)ï¼ŒåŒæ—¶åçº§ç»§æ‰¿(ä¼ å…¥)å‰çº§çš„é—äº§(è¾“å‡ºå†…å®¹) */\n\t\t/* æ”¾å…¥çŠ¶æ€æœºåœ¨ç›´æ¥æ¥æ”¶æ•°æ®çš„åœ°æ–¹ */\n&nbsp; &nbsp; &nbsp; RunFsm(DataStreamHandle.GetFsm(), DataStreamHandle.GetDriver());\n&nbsp; &nbsp; &nbsp; \n&nbsp; &nbsp; &nbsp; /* åè®®çŠ¶æ€æœºï¼Œä¼ å…¥æ•°æ®æ”¶å‘æ¥å£çš„åŸç”Ÿæ•°æ®å½¢å¼ æ¯”å¦‚canæŠ¥æ–‡å½¢å¼ï¼Œä¸²å£å½¢å¼ */\n&nbsp; &nbsp; &nbsp; RunFsm(ProtocolHandle.GetFsm(), DataStreamHandle.GetDriver());\n\n&nbsp; &nbsp; &nbsp; /* bootæµç¨‹çŠ¶æ€æœº */\n&nbsp; &nbsp; &nbsp; RunFsm(BootloaderHandle.GetFsm(), ProtocolHandle.GetDataBody());\n&nbsp; &nbsp; }\n}\n</code></pre>\n<p>å› ä¸ºé€šè¿‡é“¾å¼ä¼ é€’æ¶ˆæ¯é€šçŸ¥ï¼Œåœ¨å•è·¯å¾„æµç¨‹ä¸­ï¼Œæ€»æ˜¯å¯ä»¥é€šè¿‡å‰çº§ä¸»åŠ¨é€šçŸ¥åçº§è¯¥åšä»€ä¹ˆ(è‡ªå®šä¹‰äº‹ä»¶)ï¼ŒåŒæ—¶åçº§ç»§æ‰¿(ä¼ å…¥)å‰çº§çš„é—äº§(è¾“å‡ºå†…å®¹)ã€‚</p>\n<p>ä»¥ä¸Šæ•´ä¸ªæœºåˆ¶çš„æ¡†æ¶çš„å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥ä¸»è¦å°±æ˜¯ç­–ç•¥çš„å®šä¹‰äº†ï¼Œå…¶å®å°±æ˜¯è¯†åˆ«å‡ºè‡ªå®šä¹‰ç­–ç•¥ä¸­çš„äº‹ä»¶ã€çŠ¶æ€ä»¥åŠè½¬ç§»ï¼Œå¹¶æŠŠè¿™äº›ä»¥çŠ¶æ€è¡¨çš„æ–¹å¼å‘ˆç°å‡ºæ¥ã€‚</p>\n<p>é¦–å…ˆç»™å‡ºé€šä¿¡çŠ¶æ€å›¾ï¼š</p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p>é€šä¿¡æµç¨‹ä¸­å®šä¹‰çš„äº‹ä»¶å’ŒçŠ¶æ€å®å®šä¹‰ï¼Œä»¥åŠçŠ¶æ€è¡¨å®šä¹‰ï¼š</p>\n<pre><code class=\"language-c\">/* é€šä¿¡äº‹ä»¶æµè‡ªå®šä¹‰å® &gt;&gt;&gt;&gt;&gt;&gt; */\n\n/* æ— äº‹ä»¶ */\n#define E_DATA_NONE 0\n/* æœ‰æ•°æ®è¿›å…¥ */\n#define E_DATA_IN (CAST_U32(0X01) &lt;&lt; 0)\n/* æ•°æ®è¶…æ—¶ */\n#define E_DATA_TIMEOUT (CAST_U32(0X01) &lt;&lt; 1)\n/* æ•°æ®æ¥æ”¶ç»“æŸ */\n#define E_DATA_END (CAST_U32(0X01) &lt;&lt; 2)\n/* æ•°æ®è¯·æ±‚åè®®å¤„ç† å› ä¸ºåªæœ‰è‡ªå·±çŸ¥é“è‡ªå·±ä»€ä¹ˆæƒ…å†µï¼Œå½“ç„¶å¾—ä¸»åŠ¨é€šçŸ¥ */\n#define E_DATA_LINK_PTO (CAST_U32(0X01) &lt;&lt; 3)\n/* ç­‰å¾…åè®®ç»™è¿‡æ¥æ¶ˆæ¯ */\n#define E_DATA_RET_PTO (CAST_U32(0X01) &lt;&lt; 4)\n  \n/* è‡ªå®šä¹‰çŠ¶æ€å® */\n\n/* ç©ºçŠ¶æ€ */\n#define S_DATA_NONE 0\n/* æ¥æ”¶çŠ¶æ€ */\n#define S_DATA_READING (CAST_U32(0X01) &lt;&lt; 0)\n/* æ•°æ®æ¥æ”¶å®ŒæˆçŠ¶æ€ */\n#define S_DATA_READ_END (CAST_U32(0X01) &lt;&lt; 1)\n/* ç­‰å¾…åè®®åé¦ˆçŠ¶æ€ */\n#define S_DATA_WAIT_PTO (CAST_U32(0X01) &lt;&lt; 2)\n/* é€šä¿¡äº‹ä»¶æµè‡ªå®šä¹‰å® &lt;&lt;&lt;&lt;&lt;&lt; */\n\nTransitionItem_t DataStreamTable[] = {\n\n&nbsp; &nbsp; {E_DATA_IN, S_DATA_NONE, BufData, S_DATA_READING},\n&nbsp; &nbsp; {E_DATA_TIMEOUT, S_DATA_READING, ResetData, S_DATA_NONE},\n&nbsp; &nbsp; {E_DATA_END, S_DATA_READING, LinkProto, S_DATA_READ_END},\n&nbsp; &nbsp; {E_DATA_LINK_PTO, S_DATA_READ_END, NULL, S_DATA_WAIT_PTO},\n&nbsp; &nbsp; {E_DATA_RET_PTO, S_DATA_WAIT_PTO, SendResp, S_DATA_NONE}\n\n};\n\n</code></pre>\n<p>å…¶æ¬¡æ˜¯äº¤äº’åè®®çŠ¶æ€å›¾ï¼š</p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p>å¯¹åº”çš„äº‹ä»¶ã€çŠ¶æ€ä»¥åŠçŠ¶æ€è¡¨å®šä¹‰å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-c\">/* åè®®æ”¶åˆ°é€šä¿¡çš„é€šçŸ¥ */\n\n#define E_PROTO_RECV_DATA (CAST_U32(0X01) &lt;&lt; 0)\n\n/* åè®®è§£æå®Œæˆ */\n\n#define E_PROTO_PARSE_OK (CAST_U32(0X01) &lt;&lt; 1)\n\n/* Bootåé¦ˆ */\n\n#define E_PROTO_RET_BOOT (CAST_U32(0X01) &lt;&lt; 2)\n\n/* ç©ºçŠ¶æ€ */\n#define S_PROTO_NONE 0\n/* è§£æçŠ¶æ€ */\n#define S_PROTO_PARSE (CAST_U32(0X01) &lt;&lt; 1)\n/* ç­‰å¾…Bootåé¦ˆçŠ¶æ€ */\n#define S_PROTO_WAIT_BOOT (CAST_U32(0X01) &lt;&lt; 2)\n/* çŠ¶æ€è¡¨å®šä¹‰ */\nTransitionItem_t ProtoTable[] = {\n\n&nbsp; &nbsp; {E_PROTO_RECV_DATA, S_PROTO_NONE, ParseData, S_PROTO_PARSE},\n&nbsp; &nbsp; {E_PROTO_PARSE_OK, S_PROTO_PARSE, LinkBoot, S_PROTO_WAIT_BOOT},\n&nbsp; &nbsp; {E_PROTO_RET_BOOT, S_PROTO_WAIT_BOOT, RetData, S_PROTO_NONE}\n\n};\n</code></pre>\n<p>æœ€åæ˜¯Bootæµç¨‹çš„çŠ¶æ€å›¾ï¼š</p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p>å¯¹åº”çš„äº‹ä»¶ã€çŠ¶æ€ä»¥åŠçŠ¶æ€è¡¨å®šä¹‰å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-c\">/* Bootæ”¶åˆ°åè®®çš„é€šçŸ¥ */\n#define E_BOOT_RECV_PROTO (CAST_U32(0X01) &lt;&lt; 0)\n/* Bootèµ·å§‹å‘½ä»¤ */\n#define E_BOOT_CMD_START (CAST_U32(0X01) &lt;&lt; 1)\n/* Bootæ›´æ–°å‘½ä»¤ */\n#define E_BOOT_CMD_UPDATE (CAST_U32(0X01) &lt;&lt; 2)\n/* Bootç»“æŸå‘½ä»¤ */\n#define E_BOOT_CMD_END (CAST_U32(0X01) &lt;&lt; 3)\n/* Bootè·³è½¬å‘½ä»¤ */\n#define E_BOOT_CMD_JUMP (CAST_U32(0X01) &lt;&lt; 4)\n\n#define S_BOOT_NONE 0\n/* Bootå‡†å¤‡çŠ¶æ€ */\n#define S_BOOT_READY (CAST_U32(0X01) &lt;&lt; 1)\n/* Bootæ›´æ–°çŠ¶æ€ */\n#define S_BOOT_UPDATE (CAST_U32(0X01) &lt;&lt; 2)\n/* Bootç»“æŸçŠ¶æ€ */\n#define S_BOOT_END (CAST_U32(0X01) &lt;&lt; 3)\n\n/* çŠ¶æ€è¡¨å®šä¹‰ */\nTransitionItem_t BootTable[] = {\n&nbsp; &nbsp; {E_BOOT_RECV_PROTO | E_BOOT_CMD_START, S_BOOT_NONE ResetBoot, S_BOOT_READY},\n&nbsp; &nbsp; {E_BOOT_RECV_PROTO | E_BOOT_CMD_UPDATE, S_BOOT_READY, Update, S_BOOT_UPDATE},\n&nbsp; &nbsp; {E_BOOT_RECV_PROTO | E_BOOT_CMD_UPDATE, S_BOOT_UPDATE, Update, S_BOOT_UPDATE},\n&nbsp; &nbsp; {E_BOOT_RECV_PROTO | E_BOOT_CMD_END, S_BOOT_UPDATE, Check, S_BOOT_END},\n&nbsp; &nbsp; {E_BOOT_RECV_PROTO | E_BOOT_CMD_JUMP, S_BOOT_END, JumpApp, S_BOOT_NONE}\n\n};\n</code></pre>\n<p>å¯ä»¥çœ‹åˆ°çŠ¶æ€è¡¨ä¸­çš„äº‹ä»¶é¡¹éƒ½æ˜¯å¤šç§äº‹ä»¶çš„ç»„åˆï¼Œå› ä¸ºæˆ‘ä»¬çš„äº‹ä»¶å®å®šä¹‰æ˜¯é€šè¿‡ç§»ä½æ“ä½œè¿›è¡Œçš„ï¼Œæ‰€ä»¥æä¾›äº†ç»„åˆäº‹ä»¶çš„èƒ½åŠ›ã€‚</p>\n<p>è‡³æ­¤ï¼ŒBootloaderçš„æœºåˆ¶å’Œç­–ç•¥éƒ½åˆ¶å®šå®Œæ¯•äº†ï¼Œè¿™é‡Œåªæ¼”ç¤ºäº†æ¯”è¾ƒç®€å•çš„ç­–ç•¥åŠŸèƒ½ï¼Œä½†å› ä¸ºæœºåˆ¶æä¾›äº†ç­–ç•¥æ›´æ¢çš„èƒ½åŠ›ï¼Œæ‰€ä»¥å®ç°æ›´å¤æ‚çš„åŠŸèƒ½åªéœ€è¦åˆ¶å®šç›¸åº”çš„ç­–ç•¥çŠ¶æ€è¡¨å³å¯ã€‚</p>\n<p>å®ç°è¿™ä¸ªæœºåˆ¶ä¹Ÿç®—æ˜¯ä¸€ä¸ªå°è¯•ï¼Œå­¦åˆ°äº†å¾ˆå¤šï¼ŒåŒæ—¶å‘¢ä¹Ÿæ¥è§¦åˆ°æ›´é«˜çº§çš„å†…å®¹ï¼Œè¿˜æœ‰å¾…è¿›ä¸€æ­¥æ·±å…¥äº†è§£ã€‚</p>\n<p>å¾®ä¿¡å…¬ä¼—å·ï¼šè½¯è¶´è¶´çš„å·¥ç¨‹å¸ˆ</p>\n<p><img alt=\"dd83fca0b5541e763cf671018f89542e\" class=\"lazyload\" /></p>\n\n\n</div>\n<div id=\"MySignature\">\n    <p>æœ¬æ–‡æ¥è‡ªåšå®¢å›­ï¼Œä½œè€…ï¼š<a href=\"https://www.cnblogs.com/pie-o/\" target=\"_blank\">pie_thn</a>ï¼Œè½¬è½½è¯·æ³¨æ˜åŸæ–‡é“¾æ¥ï¼š<a href=\"https://www.cnblogs.com/pie-o/p/19613316\" target=\"_blank\">https://www.cnblogs.com/pie-o/p/19613316</a></p>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-13 18:54</span>&nbsp;\n<a href=\"https://www.cnblogs.com/pie-o\">pie_thn</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">14</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "Volcano v1.14 é‡ç£…å‘å¸ƒï¼è¿ˆå‘ AI ç»Ÿä¸€è°ƒåº¦æ–°çºªå…ƒ",
      "link": "https://www.cnblogs.com/huaweiyun/p/19612682",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/huaweiyun/p/19612682\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-13 16:35\">\n    <span>Volcano v1.14 é‡ç£…å‘å¸ƒï¼è¿ˆå‘ AI ç»Ÿä¸€è°ƒåº¦æ–°çºªå…ƒ</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<p>æœ¬æ–‡åˆ†äº«è‡ªåä¸ºäº‘ç¤¾åŒºã€Š<a href=\"https://bbs.huaweicloud.com/blogs/474065?utm_source=zhihu&amp;utm_medium=bbs-ex&amp;utm_campaign=other&amp;utm_content=content\" rel=\"noopener nofollow\" target=\"_blank\">Volcano v1.14 é‡ç£…å‘å¸ƒï¼è¿ˆå‘ AI ç»Ÿä¸€è°ƒåº¦æ–°çºªå…ƒ</a>ã€‹</p>\n<p>åŒ—äº¬æ—¶é—´2026å¹´1æœˆï¼Œ<strong>Volcano</strong>[1] v1.14 æ­£å¼å‘å¸ƒã€‚éšç€ AI ä¸šåŠ¡å½¢æ€ä»å•ä¸€çš„ç¦»çº¿è®­ç»ƒå‘åœ¨çº¿æ¨ç†ã€Agent æ™ºèƒ½ä½“ç­‰å¤šå…ƒåŒ–åœºæ™¯å»¶ä¼¸ï¼Œè°ƒåº¦ç³»ç»Ÿé¢ä¸´ç€å‰æ‰€æœªæœ‰çš„æŒ‘æˆ˜ã€‚<strong>v1.14</strong>[2] é€šè¿‡æ¶æ„çº§çš„åˆ›æ–°ï¼Œåœ¨ä¿æŒå¤§è§„æ¨¡æ‰¹é‡è®¡ç®—ä¼˜åŠ¿çš„åŒæ—¶ï¼Œè¡¥é½äº†å¯¹å»¶è¿Ÿæ•æ„Ÿå‹ä¸šåŠ¡çš„è°ƒåº¦çŸ­æ¿ï¼Œå‘ç€ <strong>â€œAIè®­æ¨ã€RLã€Agentå…¨åœºæ™¯ç»Ÿä¸€è°ƒåº¦å¹³å°â€</strong> çš„ç›®æ ‡è¿ˆå‡ºäº†åšå®ä¸€æ­¥ã€‚</p>\n<p><img alt=\"download\" class=\"lazyload\" /></p>\n<h1><span class=\"prefix\"><span class=\"content\"><strong>ç‰ˆæœ¬äº®ç‚¹</strong></span></span></h1>\n<p>v1.14.0 ç‰ˆæœ¬å¸¦æ¥ä»¥ä¸‹é‡ç£…æ›´æ–°ï¼š</p>\n<p><strong>ç»Ÿä¸€è°ƒåº¦å¹³å°æ¶æ„</strong></p>\n<ul>\n<li>å¤šè°ƒåº¦å™¨æ¶æ„å‡çº§ï¼šåŠ¨æ€èŠ‚ç‚¹åˆ†ç‰‡æœºåˆ¶ (Alpha)</li>\n<li>AI Agent å·¥ä½œè´Ÿè½½æé€Ÿè°ƒåº¦èƒ½åŠ› (Alpha)</li>\n</ul>\n<p><strong>ç½‘ç»œæ‹“æ‰‘æ„ŸçŸ¥è°ƒåº¦å¢å¼º</strong></p>\n<ul>\n<li>HyperNode çº§ Binpack ç­–ç•¥</li>\n<li>SubGroup çº§ç²¾ç»†åŒ–æ‹“æ‰‘æ„ŸçŸ¥</li>\n<li>PodGroup ä¸ SubGroup å¤šå±‚çº§ Gang Scheduling</li>\n<li>Volcano Job åˆ†åŒºæ”¯æŒ</li>\n</ul>\n<p><strong>æ··éƒ¨èƒ½åŠ›å¢å¼º</strong></p>\n<ul>\n<li>å…¨é¢æ”¯æŒé€šç”¨æ“ä½œç³»ç»Ÿï¼ˆUbuntuã€CentOS ç­‰ï¼‰</li>\n<li>Cgroup V2 å…¨é¢é€‚é…</li>\n<li>CPU åŠ¨æ€å‹åˆ¶</li>\n<li>åŸºäº Cgroup V2 çš„å†…å­˜ QoS</li>\n<li>æ”¯æŒ CPU Burst</li>\n<li>æ”¯æŒ systemd driver è‡ªåŠ¨æ£€æµ‹</li>\n</ul>\n<p><strong>å¼‚æ„ç¡¬ä»¶æ”¯æŒ</strong></p>\n<ul>\n<li>æ˜‡è…¾ vNPU è°ƒåº¦ï¼ˆæ”¯æŒ MindCluster å’Œ HAMi æ¨¡å¼ï¼‰</li>\n</ul>\n<p><strong>Volcano Global å¢å¼º</strong></p>\n<ul>\n<li>HyperJob å¤šé›†ç¾¤ä½œä¸šè‡ªåŠ¨æ‹†åˆ†</li>\n<li>æ•°æ®æ„ŸçŸ¥å¤šé›†ç¾¤è°ƒåº¦</li>\n</ul>\n<p><strong>Volcano Dashboard å¢å¼º</strong></p>\n<ul>\n<li>PodGroup å…¨æ™¯å¯è§†åŒ–</li>\n<li>Job / Queue å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†</li>\n</ul>\n<h2><span class=\"prefix\"><span class=\"content\"><strong>å¤šè°ƒåº¦å™¨æ¶æ„å‡çº§ï¼šåŠ¨æ€èŠ‚ç‚¹åˆ†ç‰‡æœºåˆ¶ (Alpha)</strong></span></span></h2>\n<p>éšç€ Volcano æ‰¿è½½çš„å·¥ä½œè´Ÿè½½ç±»å‹æ—¥ç›Šä¸°å¯Œã€è§„æ¨¡æŒç»­æ‰©å¤§ï¼Œå•ä¸€è°ƒåº¦å™¨æ¶æ„é€æ¸æ˜¾éœ²ç“¶é¢ˆã€‚æ‰¹é‡è®­ç»ƒã€AI Agentã€å¾®æœåŠ¡ç­‰ä¸åŒç±»å‹çš„å·¥ä½œè´Ÿè½½ï¼Œå¯¹è°ƒåº¦æ—¶å»¶ã€èµ„æºåˆ©ç”¨æ¨¡å¼çš„è¯‰æ±‚å„ä¸ç›¸åŒã€‚å•è°ƒåº¦å™¨éš¾ä»¥å…¼é¡¾ï¼Œè€Œé™æ€èµ„æºåˆ’åˆ†åˆä¼šé€ æˆåˆ©ç”¨ç‡ä½ä¸‹ã€‚<br />\næ–°å¼•å…¥çš„ Sharding Controller æ„å»ºäº†ä¸€å¥—å¯æ‰©å±•çš„å¤šè°ƒåº¦å™¨æ¶æ„ï¼Œèƒ½å¤Ÿæ ¹æ®é›†ç¾¤å®æ—¶çŠ¶æ€ï¼Œä¸ºæ¯ä¸ªè°ƒåº¦å™¨åŠ¨æ€è®¡ç®—å€™é€‰èŠ‚ç‚¹æ± ã€‚ä¸ä¼ ç»Ÿçš„é™æ€åˆ†åŒºä¸åŒï¼ŒSharding Controller é‡‡ç”¨åŠ¨æ€è®¡ç®—çš„æ–¹å¼åˆ’åˆ†èµ„æºï¼Œè€Œéå¼ºåˆ¶ç¡¬éš”ç¦»ã€‚è¿™ç§çµæ´»æœºåˆ¶è®© Volcano çœŸæ­£æˆä¸º\"ä¸€ä¸ªå¹³å°è°ƒåº¦æ‰€æœ‰è´Ÿè½½\"çš„ç»Ÿä¸€è°ƒåº¦å¹³å°ï¼ŒåŒæ—¶ä¿æŒé«˜ååã€ä½æ—¶å»¶ã€‚<br />\n</p>\n<p><strong>æ ¸å¿ƒèƒ½åŠ›</strong>ï¼š</p>\n<ul>\n<li><strong>åŠ¨æ€åˆ†ç‰‡ç­–ç•¥</strong>ï¼šæ”¯æŒå¤šç§ç­–ç•¥æ¥è®¡ç®—åŠ¨æ€å€™é€‰èŠ‚ç‚¹æ± ã€‚å½“å‰ç‰ˆæœ¬ç‡å…ˆæ”¯æŒåŸºäº CPU åˆ©ç”¨ç‡çš„åˆ†ç‰‡ç­–ç•¥ï¼Œå¹¶é‡‡ç”¨äº†å¯æ‰©å±•çš„æ¶æ„è®¾è®¡ï¼Œä»¥ä¾¿æœªæ¥è½»æ¾é›†æˆæ›´å¤šåˆ†ç‰‡ç®—æ³•ã€‚</li>\n<li><strong>èŠ‚ç‚¹æ± åŒ–ç®¡ç†</strong>ï¼šå¼•å…¥ NodeShard CRDï¼Œä¸ºç‰¹å®šè°ƒåº¦å™¨ç®¡ç†ä¸“å±çš„åŠ¨æ€å€™é€‰èŠ‚ç‚¹æ± ã€‚</li>\n<li><strong>æ”¯æŒå¤§è§„æ¨¡é›†ç¾¤</strong>ï¼šé€šè¿‡åœ¨å¤šä¸ªè°ƒåº¦å™¨ä¹‹é—´çµæ´»åˆ†é…è´Ÿè½½ï¼Œå¤©ç„¶é€‚é…å¤§è§„æ¨¡é›†ç¾¤åœºæ™¯ã€‚</li>\n<li><strong>å¤šè°ƒåº¦å™¨ååŒ</strong>ï¼šæ”¯æŒå¤šç§è°ƒåº¦å™¨ç»„åˆçš„æ— ç¼åä½œã€‚æ— è®ºæ˜¯éƒ¨ç½²å¤šä¸ª Batch Scheduler è¿›è¡Œè´Ÿè½½åˆ†æ‹…ï¼Œè¿˜æ˜¯æ··åˆéƒ¨ç½² Agent Scheduler ä¸ Batch Scheduler ä»¥åº”å¯¹ä¸åŒä¸šåŠ¡éœ€æ±‚ï¼Œéƒ½èƒ½çµæ´»é€‚é…ã€‚</li>\n\n</ul>\n<p>é…ç½®ç¤ºä¾‹ï¼š</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:csharp;gutter:true;\"># Sharding Controller å¯åŠ¨å‚æ•°\n--scheduler-configs=\"volcano:volcano:0.0:0.6:false:2:100,agent-scheduler:agent:0.7:1.0:true:2:100\"\n--shard-sync-period=60s\n--enable-node-event-trigger=true\n\n# å‚æ•°æ ¼å¼: name:type:min_util:max_util:prefer_warmup:min_nodes:max_nodes</pre>\n</div>\n<p>ç›¸å…³ PRï¼šhttps://github.com/volcano-sh/volcano/pull/4777<br />\nè®¾è®¡æ–‡æ¡£ï¼š<strong>Sharding Controller Design</strong>[3]<br />\næ„Ÿè°¢ç¤¾åŒºå¼€å‘è€…ï¼š@ssfffss, @Haoran, @qi-min</p>\n<h2><span class=\"prefix\"><span class=\"content\"><strong>AI Agent å·¥ä½œè´Ÿè½½æé€Ÿè°ƒåº¦ (Alpha)</strong></span></span></h2>\n<p>AI Agent ç±»ä¸šåŠ¡å¯¹æ—¶å»¶æåº¦æ•æ„Ÿï¼Œä»»åŠ¡åˆ›å»ºé¢‘ç¹ä¸”ç”Ÿå‘½å‘¨æœŸçŸ­ï¼Œå¯¹è°ƒåº¦å™¨çš„å“åº”é€Ÿåº¦å’Œååé‡æå‡ºäº†ä¸¥è‹›è¦æ±‚ã€‚åŸç”Ÿ Volcano Batch Scheduler ä¸“ä¸ºæ‰¹é‡è®¡ç®—è®¾è®¡ï¼ŒæŒ‰å›ºå®šå‘¨æœŸå¤„ç† Podï¼Œéš¾ä»¥æ»¡è¶³ Agent åœºæ™¯çš„æ¯«ç§’çº§å“åº”éœ€æ±‚ã€‚<br />\nä¸ºæ‰“é€ å…¼å®¹æ‰¹é‡è®¡ç®—ä¸å»¶è¿Ÿæ•æ„Ÿå‹ä¸šåŠ¡çš„ç»Ÿä¸€è°ƒåº¦å¹³å°ï¼Œv1.14 å¼•å…¥äº†ä¸“ç”¨çš„ <strong>Agent Scheduler</strong>ã€‚å®ƒé€šè¿‡ Sharding Controller ä¸æ‰¹é‡è°ƒåº¦å™¨ååŒå·¥ä½œï¼Œå„å¸å…¶èŒåˆæ— ç¼é…åˆï¼ŒçœŸæ­£å®ç°\"ä¸€ä¸ªå¹³å°ã€å¤šç§è´Ÿè½½\"ã€‚<br />\n</p>\n<p><strong>æ ¸å¿ƒèƒ½åŠ›</strong>ï¼š</p>\n<ul>\n<li><strong>æé€Ÿè°ƒåº¦é€šé“</strong>ï¼šä¸“ä¸ºå»¶è¿Ÿæ•æ„Ÿå‹è´Ÿè½½ï¼ˆå¦‚ AI Agentï¼‰æ‰“é€ çš„ç‹¬ç«‹è°ƒåº¦å™¨ï¼Œæä¾›æè‡´å“åº”é€Ÿåº¦ã€‚</li>\n<li><strong>å¤š Worker å¹¶è¡Œå¤„ç†</strong>ï¼šé‡‡ç”¨å¤š Worker å¹¶å‘æ¶ˆè´¹è°ƒåº¦é˜Ÿåˆ—çš„æ¶æ„ï¼Œå¤§å¹…æå‡è°ƒåº¦ååé‡ã€‚</li>\n<li><strong>ä¹è§‚å¹¶å‘æ§åˆ¶</strong>ï¼šå¼•å…¥ Conflict-Aware Binder æœºåˆ¶ï¼Œåœ¨å®é™…ç»‘å®šå‰é¢„å…ˆè§£å†³å†²çªï¼Œå‡å°‘æ— æ•ˆæ“ä½œã€‚</li>\n<li><strong>å¢å¼ºå‹è°ƒåº¦é˜Ÿåˆ—</strong>ï¼šä¼˜åŒ–é˜Ÿåˆ—æœºåˆ¶ï¼Œæ”¯æŒç´§æ€¥ä»»åŠ¡é‡è¯•ï¼Œç¡®ä¿å…³é”®ä»»åŠ¡ä¸é˜»å¡ã€‚</li>\n<li><strong>ç»Ÿä¸€å¹³å°èåˆ</strong>ï¼šé€šè¿‡ Sharding Controller ä¸æ‰¹é‡è°ƒåº¦å™¨æ— ç¼åä½œï¼Œå…±äº«é›†ç¾¤èµ„æºã€‚</li>\n\n</ul>\n<p>ç›¸å…³ PRï¼š</p>\n<p>https://github.com/volcano-sh/volcano/pull/4804,<br />\nhttps://github.com/volcano-sh/volcano/pull/4801,<br />\nhttps://github.com/volcano-sh/volcano/pull/4805<br />\nè®¾è®¡æ–‡æ¡£ï¼š<strong>Agent Scheduler Design</strong>[4]<br />\næ„Ÿè°¢ç¤¾åŒºå¼€å‘è€…ï¼š@qi-min, @JesseStutler, @handan-yxh</p>\n<h2><span class=\"prefix\"><span class=\"content\"><strong>ç½‘ç»œæ‹“æ‰‘æ„ŸçŸ¥è°ƒåº¦å¢å¼º</strong></span></span></h2>\n<p>Volcano v1.14.0 å¯¹ç½‘ç»œæ‹“æ‰‘æ„ŸçŸ¥è°ƒåº¦è¿›è¡Œäº†è¿›ä¸€æ­¥å¢å¼ºï¼Œæ»¡è¶³åˆ†å¸ƒå¼å·¥ä½œè´Ÿè½½ï¼ˆåŒ…æ‹¬ LLM è®­ç»ƒã€æ¨ç†ã€HPC å’Œå…¶ä»–ç½‘ç»œå¯†é›†å‹åº”ç”¨ï¼‰æ—¥ç›Šå¢é•¿çš„éœ€æ±‚ã€‚<br />\n</p>\n<p><strong>æ ¸å¿ƒå¢å¼º</strong>ï¼š</p>\n<ul>\n<li><strong>SubGroup çº§ç²¾ç»†åŒ–æ‹“æ‰‘æ„ŸçŸ¥</strong>ï¼šæ”¯æŒåœ¨ SubGroup / Partition ç²’åº¦è®¾ç½®ç½‘ç»œæ‹“æ‰‘çº¦æŸï¼Œè°ƒåº¦é¢—ç²’åº¦æ›´ç²¾ç»†ã€‚</li>\n<li><strong>çµæ´»çš„ç½‘ç»œå±‚çº§çº¦æŸ</strong>ï¼šæ–°å¢ highestTierNameï¼Œæ”¯æŒæŒ‰åç§°æŒ‡å®šå…è®¸è·¨è¶Šçš„æœ€é«˜ç½‘ç»œå±‚çº§ã€‚</li>\n<li><strong>å¤šå±‚çº§ Gang Scheduling</strong>ï¼šåŒæ—¶æ”¯æŒ PodGroup çº§åˆ«å’Œ SubGroup çº§åˆ«çš„ Gang Schedulingï¼Œç¡®ä¿åˆ†å¸ƒå¼ä»»åŠ¡çš„æ•´ä½“æ€§ã€‚</li>\n<li><strong>Volcano Job åˆ†åŒº</strong>ï¼šæ”¯æŒå°† Job æ‹†åˆ†ä¸ºå¤šä¸ªåˆ†åŒºï¼ˆPartitionï¼‰ï¼Œä¾¿äºç®¡ç† TP/PP/DP ç­‰å¹¶è¡Œç­–ç•¥ï¼Œå¹¶ä¼˜åŒ–ç½‘ç»œäº²å’Œæ€§ã€‚</li>\n<li><strong>HyperNode çº§ Binpacking</strong>ï¼šåœ¨ HyperNodeï¼ˆå¦‚äº¤æ¢æœºã€æœºæ¶ï¼‰å±‚çº§è¿›è¡Œèµ„æºè£…ç®±ï¼Œå‡å°‘ç½‘ç»œç¢ç‰‡ï¼Œæå‡é€šä¿¡æ•ˆç‡ã€‚</li>\n\n</ul>\n<p>é…ç½®ç¤ºä¾‹ - Volcano Jobï¼š</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:csharp;gutter:true;\">apiVersion: batch.volcano.sh/v1alpha1\nkind: Job\nmetadata:\nname: llm-training-job\nspec:\nnetworkTopology:\nmode: hard\nhighestTierAllowed: 2 # æ•´ä¸ª Job æœ€å¤šè·¨è¶Š Tier 2 HyperNode\ntasks:\n- name: trainer\nreplicas: 8\npartitionPolicy:\ntotalPartitions: 2 # æ‹†åˆ†ä¸º 2 ä¸ªåˆ†åŒº\npartitionSize: 4 # æ¯ä¸ªåˆ†åŒº 4 ä¸ª Pod\nminPartitions: 2 # è‡³å°‘éœ€è¦ 2 ä¸ªåˆ†åŒº\nnetworkTopology:\nmode: hard\nhighestTierAllowed: 1 # å•ä¸ªåˆ†åŒºå¿…é¡»åœ¨ Tier 1 å†…\ntemplate:\nspec:\ncontainers:\n- name: trainer\nimage: training-image:v1\nresources:\nrequests:\nnvidia.com/gpu: 8</pre>\n</div>\n<p>ç›¸å…³ PRï¼š</p>\n<p>https://github.com/volcano-sh/volcano/pull/4721,<br />\nhttps://github.com/volcano-sh/volcano/pull/4810,<br />\nhttps://github.com/volcano-sh/volcano/pull/4795,<br />\nhttps://github.com/volcano-sh/volcano/pull/4785,<br />\nhttps://github.com/volcano-sh/volcano/pull/4889</p>\n<p>è®¾è®¡æ–‡æ¡£ï¼š<strong>Network Topology Aware Scheduling</strong>[5]<br />\næ„Ÿè°¢ç¤¾åŒºå¼€å‘è€…ï¼š@ouyangshengjia, @3sunny, @zhaoqi, @wangyang0616, @MondayCha, @Tau721</p>\n<h2><span class=\"prefix\"><span class=\"content\"><strong>æ··éƒ¨èƒ½åŠ›å…¨é¢å‡çº§ï¼šæ”¯æŒé€šç”¨æ“ä½œç³»ç»Ÿ</strong></span></span></h2>\n<p>æœ¬æ¬¡å‘å¸ƒå¯¹ Volcano çš„æ··éƒ¨èƒ½åŠ›è¿›è¡Œäº†å…¨é¢æ”¹è¿›ï¼Œå…¶ä¸­ä¸€ä¸ªé‡è¦é‡Œç¨‹ç¢‘æ˜¯ï¼šVolcano æ··éƒ¨èƒ½åŠ›<strong>æ­£å¼æ”¯æŒé€šç”¨æ“ä½œç³»ç»Ÿ</strong>ï¼ˆUbuntuã€CentOS ç­‰ï¼‰ï¼Œä¸å†å±€é™äº OpenEulerã€‚è¿™æ„å‘³ç€æ›´å¤šç”¨æˆ·å¯ä»¥ä½¿ç”¨ Volcano Agent å®ç°åœ¨ç¦»çº¿æ··éƒ¨ï¼Œæå‡é›†ç¾¤æ•´ä½“èµ„æºåˆ©ç”¨ç‡ã€‚</p>\n<h3><span class=\"prefix\"><span class=\"content\"><strong>CPU åŠ¨æ€å‹åˆ¶ (CPU Suppression)</strong></span></span></h3>\n<p>åœ¨çº¿ä¸šåŠ¡æµé‡é€šå¸¸å…·æœ‰æ½®æ±ç‰¹æ€§ã€‚ä¸ºäº†åœ¨ä¿éšœåœ¨çº¿ä¸šåŠ¡ SLA çš„åŒæ—¶æœ€å¤§åŒ–èµ„æºåˆ©ç”¨ï¼Œç¦»çº¿ Pod çš„ CPU é…é¢éœ€è¦éšåœ¨çº¿ç”¨é‡åŠ¨æ€è°ƒæ•´ï¼šåœ¨çº¿ç”¨é‡é«˜æ—¶å‹åˆ¶ç¦»çº¿é…é¢ï¼Œç”¨é‡å›è½æ—¶é€æ­¥æ¢å¤ï¼Œå®ç°è‡ªé€‚åº”çš„èµ„æºåˆ†é…ã€‚</p>\n<p>æ ¸å¿ƒè®¾è®¡ï¼š</p>\n<ul>\n<li>æ ¹æ®èŠ‚ç‚¹å¯åˆ†é… CPU å’Œå®æ—¶ç”¨é‡ï¼ŒåŠ¨æ€è°ƒæ•´ BestEffort root cgroup çš„ CPU é…é¢ã€‚</li>\n<li>é‡‡ç”¨\"ç›‘æ§-äº‹ä»¶-å¤„ç†\"æ¶æ„ï¼Œå¹¶å®æ–½ä¿å®ˆæ›´æ–°ç­–ç•¥ï¼Œæœ‰æ•ˆæŠ‘åˆ¶æŠ–åŠ¨ã€‚</li>\n\n</ul>\n<p>é…ç½®ç¤ºä¾‹ï¼š</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:csharp;gutter:true;\">cpuThrottlingConfig:\n\nenable: true\n\ncpuThrottlingThreshold: 80 # BE é…é¢ä¸Šé™ä¸ºå¯åˆ†é… CPU çš„ 80%\n\ncpuJitterLimitPercent: 1 # é…é¢å˜åŒ–è¶…è¿‡ 1% æ‰è§¦å‘æ›´æ–°\ncpuRecoverLimitPercent: 10 # å•æ¬¡æ¢å¤ä¸Šé™ 10%</pre>\n</div>\n<h3><span class=\"prefix\"><span class=\"content\"><strong>å†…å­˜ QoS (Cgroup V2)</strong></span></span></h3>\n<p>åŸºäº Cgroup V2 å®ç°æ··éƒ¨åœºæ™¯çš„å†…å­˜éš”ç¦»ã€‚æ–°å¢ ColocationConfiguration CRDï¼Œæ”¯æŒä¸ºæŒ‡å®šå·¥ä½œè´Ÿè½½é…ç½®å†…å­˜ QoS ç­–ç•¥ã€‚</p>\n<p>æ ¸å¿ƒèƒ½åŠ›ï¼š</p>\n<ul>\n<li><strong>New API</strong>ï¼šé€šè¿‡æ ‡ç­¾é€‰æ‹©å™¨å®šä¹‰å†…å­˜éš”ç¦»ç­–ç•¥çš„ ColocationConfiguration CRD</li>\n<li><strong>åŠ¨æ€è®¡ç®—</strong>ï¼š\n<ul>\n<li>memory.high = pod.limits.memory * highRatio %</li>\n<li>memory.low = pod.requests.memory * lowRatio %</li>\n<li>memory.min = pod.requests.memory * minRatio %</li>\n</ul>\n</li>\n<li><strong>ç»Ÿä¸€æ¥å£</strong>ï¼šå¯é æ£€æµ‹å’Œæ”¯æŒ Cgroup V2 ç¯å¢ƒ</li>\n</ul>\n<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:csharp;gutter:true;\">apiVersion: config.volcano.sh/v1alpha1\n\nkind: ColocationConfiguration\n\nmetadata:\n\nname: colo-config1\n\nspec:\n\nselector:\n\n*matchLabels:*\n\n  *app: offline-test*\nmemoryQos:\n\n*highRatio: 100  \\# memory.high \\= memory.limits \\* 100%*\n\n*lowRatio: 50    \\# memory.low \\= memory.requests \\* 50%*  \n*minRatio: 0     \\# memory.min \\= memory.requests \\* 0%*</pre>\n</div>\n<h3><span class=\"prefix\"><span class=\"content\"><strong>CPU Burst ä¸ Cgroup V2 å…¨é¢æ”¯æŒ</strong></span></span></h3>\n<p>CPU Burst èƒ½åŠ›å·²æ‰©å±•è‡³é€šç”¨æ“ä½œç³»ç»Ÿã€‚åŒæ—¶ï¼ŒVolcano Agent ç°å·²å…¨é¢é€‚é… Cgroup V2 ç¯å¢ƒï¼Œæ”¯æŒè‡ªåŠ¨æ£€æµ‹ Cgroup ç‰ˆæœ¬åŠé©±åŠ¨ç±»å‹ï¼ˆå¦‚ systemd driverï¼‰ï¼Œæ— éœ€äººå·¥å¹²é¢„å³å¯åœ¨ç°ä»£ Linux å‘è¡Œç‰ˆä¸Šæ— ç¼è¿è¡Œã€‚</p>\n<p>ç›¸å…³ PRï¼š</p>\n<p>https://github.com/volcano-sh/volcano/pull/4632,</p>\n<p>https://github.com/volcano-sh/volcano/pull/4945,</p>\n<p>https://github.com/volcano-sh/volcano/pull/4913,</p>\n<p>https://github.com/volcano-sh/volcano/pull/4984</p>\n<p>è®¾è®¡æ–‡æ¡£ï¼š<strong>CPU Throttle Design</strong>[6], <strong>Agent Cgroup V2 Adaptation</strong>[7]</p>\n<p>æ„Ÿè°¢ç¤¾åŒºå¼€å‘è€…ï¼š@Haibara-Ai97, @JesseStutler, @ouyangshengjia</p>\n<h2><span class=\"prefix\"><span class=\"content\"><strong>æ˜‡è…¾ vNPU è°ƒåº¦</strong></span></span></h2>\n<p>v1.14 åŸç”Ÿé›†æˆäº†æ˜‡è…¾ vNPUï¼ˆè™šæ‹Ÿ NPUï¼‰è°ƒåº¦èƒ½åŠ›ï¼Œå®ç°æ˜‡è…¾ AI å¤„ç†å™¨åœ¨å¤šä¸ªå·¥ä½œè´Ÿè½½ä¹‹é—´çš„é«˜æ•ˆç®—åŠ›å¤ç”¨ã€‚æä¾›ä¸¤ç§æ¨¡å¼ï¼Œçµæ´»é€‚é…ä¸åŒéƒ¨ç½²åœºæ™¯ã€‚</p>\n<p><strong>æ”¯æŒæ¨¡å¼</strong>ï¼š</p>\n<p><strong>1. MindCluster æ¨¡å¼</strong></p>\n<ul>\n<li>é›†æˆè‡ª Ascend MindCluster è°ƒåº¦æ’ä»¶ï¼šhttps://gitcode.com/Ascend/mind-cluster\n<ul>\n<li>æ”¯æŒæ˜‡è…¾ 310P ç³»åˆ—çš„åŠ¨æ€è™šæ‹ŸåŒ–</li>\n</ul>\n</li>\n</ul>\n<p><strong>2. HAMi æ¨¡å¼</strong></p>\n<ul>\n<li>ç”± HAMi ç¤¾åŒºå¼€å‘\n<ul>\n<li>åŒæ—¶æ”¯æŒæ˜‡è…¾ 310 å’Œ 910 ç³»åˆ—</li>\n<li>æ”¯æŒå¼‚æ„æ˜‡è…¾é›†ç¾¤ï¼ˆ910Aã€910B2ã€910B3ã€310Pï¼‰</li>\n</ul>\n</li>\n</ul>\n<p>è°ƒåº¦å™¨é…ç½®ï¼š</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:csharp;gutter:true;\"># MindCluster æ¨¡å¼\n\n- name: deviceshare\n\narguments:\n\n*deviceshare.AscendMindClusterVNPUEnable: true*\n# HAMi æ¨¡å¼\n\n- name: deviceshare\n\narguments:\n\n*deviceshare.AscendHAMiVNPUEnable: true*  \n*deviceshare.SchedulePolicy: binpack  \\# æˆ– spread*</pre>\n</div>\n<p>ç›¸å…³ PRï¼š</p>\n<p>https://github.com/volcano-sh/volcano/pull/4656,<br />\nhttps://github.com/volcano-sh/volcano/pull/4717<br />\nä½¿ç”¨æ–‡æ¡£ï¼š<strong>How to Use vNPU</strong>[8]<br />\næ„Ÿè°¢ç¤¾åŒºå¼€å‘è€…ï¼š@JackyTYang, @DSFans2014</p>\n<h2><span class=\"prefix\"><span class=\"content\"><strong>Volcano Global å¢å¼º</strong></span></span></h2>\n<p>Volcano Global v0.3.0 å¼•å…¥äº†ä¸¤ä¸ªé‡è¦åŠŸèƒ½ï¼Œé€šè¿‡åŸºäºè®¡ç®—èµ„æºå’Œæ•°æ®å±€éƒ¨æ€§çš„æ™ºèƒ½è°ƒåº¦ï¼Œæ˜¾è‘—æ‰©å±•äº† Volcano Global å¯¹ AI/ML å’Œå¤§æ•°æ®å·¥ä½œè´Ÿè½½çš„èƒ½åŠ›ã€‚</p>\n<h3><span class=\"prefix\"><span class=\"content\"><strong>HyperJobï¼šå¤šé›†ç¾¤ä½œä¸šè‡ªåŠ¨æ‹†åˆ†</strong></span></span></h3>\n<p>éšç€ AI è®­ç»ƒå·¥ä½œè´Ÿè½½è§„æ¨¡å’Œå¤æ‚æ€§çš„å¢é•¿ï¼Œä¼ä¸šè¶Šæ¥è¶Šé¢ä¸´è·¨å¤šä¸ªå¼‚æ„é›†ç¾¤ç®¡ç†å¤§è§„æ¨¡è®­ç»ƒä½œä¸šçš„æŒ‘æˆ˜ã€‚HyperJob æ˜¯æ„å»ºåœ¨ Volcano Job ä¹‹ä¸Šçš„æ›´é«˜çº§æŠ½è±¡ã€‚å®ƒç»„åˆå¤šä¸ª Volcano Job æ¨¡æ¿ï¼Œå°†è®­ç»ƒèƒ½åŠ›æ‰©å±•åˆ°å•é›†ç¾¤è¾¹ç•Œä¹‹å¤–ï¼ŒåŒæ—¶ä¿ç•™æ¯ä¸ªé›†ç¾¤å†…ç°æœ‰ Volcano Job çš„å…¨éƒ¨èƒ½åŠ›ã€‚</p>\n<p><strong>æ ¸å¿ƒèƒ½åŠ›</strong>ï¼š</p>\n<ul>\n<li><strong>Karmada æ·±åº¦é›†æˆ</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆ PropagationPolicyï¼Œç²¾å‡†é…ç½®é›†ç¾¤äº²å’Œæ€§ä¸å‰¯æœ¬è°ƒåº¦ã€‚</li>\n<li><strong>çŠ¶æ€ç»Ÿä¸€èšåˆ</strong>ï¼šå°†å„é›†ç¾¤å­ä»»åŠ¡çŠ¶æ€æ±‡æ€»ä¸ºç»Ÿä¸€çš„ HyperJob çŠ¶æ€ï¼Œå…¨å±€å¯è§‚æµ‹ã€‚</li>\n<li><strong>è‡ªåŠ¨èµ„æºç”Ÿæˆ</strong>ï¼šæ ¹æ® ReplicatedJob å®šä¹‰è‡ªåŠ¨åˆ›å»º VCJob å’Œ PropagationPolicyã€‚</li>\n\n</ul>\n<p>HyperJob èµ„æºç¤ºä¾‹ï¼ˆè·¨ 2 ä¸ªé›†ç¾¤æ‹†åˆ†å¤§è§„æ¨¡è®­ç»ƒä½œä¸šï¼Œå…± 256 ä¸ª GPUï¼‰ï¼š</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:csharp;gutter:true;\">apiVersion: training.volcano.sh/v1alpha1\n\nkind: HyperJob\n\nmetadata:\n\nname: llm-training\n\nspec:\n\nreplicatedJobs:\n\n- name: trainer\n\nreplicas: 2\n\ntemplateSpec:\n\n  tasks:\n\n  \\- name: worker\n\n    replicas: 128\n\n    template:\n\n      spec:\n\n        containers:\n\n        \\- name: trainer\n\n          image: training-image:v1\n\n          resources:\n\n            requests:  \n              nvidia.com/gpu: 1</pre>\n</div>\n<h3><span class=\"prefix\"><span class=\"content\"><strong>æ•°æ®æ„ŸçŸ¥è°ƒåº¦</strong></span></span></h3>\n<p>åœ¨ AI è®­ç»ƒå’Œå¤§æ•°æ®åˆ†æç­‰é«˜æ€§èƒ½è®¡ç®—åœºæ™¯ä¸­ï¼Œä»»åŠ¡æ‰§è¡Œä¸ä»…ä¾èµ–è®¡ç®—èµ„æºï¼Œè¿˜ä¸¥é‡ä¾èµ–æ•°æ®èµ„æºã€‚åœ¨å¤šé›†ç¾¤ç¯å¢ƒä¸­ï¼Œè°ƒåº¦å™¨å¯èƒ½ä¼šå°†ä»»åŠ¡åˆ†æ´¾åˆ°ä¸æ•°æ®æºç‰©ç†è·ç¦»è¾ƒè¿œçš„é›†ç¾¤ï¼Œå¯¼è‡´è·¨åœ°åŸŸå¸¦å®½æˆæœ¬è¿‡é«˜å’Œ I/O å»¶è¿Ÿè¿‡é«˜ã€‚</p>\n<p>æ•°æ®æ„ŸçŸ¥è°ƒåº¦æ¡†æ¶å¼•å…¥ <strong>DataDependencyController</strong>ï¼Œæ‰“é€šäº†é€»è¾‘æ•°æ®éœ€æ±‚ä¸ç‰©ç†é›†ç¾¤åˆ†å¸ƒçš„å£å’ã€‚é€šè¿‡å¤–éƒ¨æ’ä»¶ï¼ˆå¦‚ Amoroï¼‰å®æ—¶è·å–æ•°æ®åˆ†å¸ƒä¿¡æ¯ï¼Œè‡ªåŠ¨å°†è°ƒåº¦çº¦æŸæ³¨å…¥ Karmadaï¼Œå®ç°\"è®¡ç®—éšæ•°æ®è€ŒåŠ¨\"çš„å…¨è‡ªåŠ¨å·¥ä½œæµã€‚</p>\n<p><strong>æ ¸å¿ƒèƒ½åŠ›</strong>ï¼š</p>\n<ul>\n<li><strong>æ’ä»¶åŒ–æ¶æ„</strong>ï¼šå¯æ‰©å±•æ”¯æŒ Amoroã€Hiveã€S3 ç­‰å¤šç§æ•°æ®ç³»ç»Ÿã€‚</li>\n<li><strong>å£°æ˜å¼ API</strong>ï¼šDataSourceClaim / DataSource CRDï¼Œé‡‡ç”¨\"å£°æ˜-ç¼“å­˜\"æ¨¡å¼ã€‚</li>\n<li><strong>è‡ªåŠ¨äº²å’Œæ³¨å…¥</strong>ï¼šå°†æ•°æ®å±€éƒ¨æ€§è½¬åŒ–ä¸º ClusterAffinity çº¦æŸï¼Œæ³¨å…¥ ResourceBindingã€‚</li>\n</ul>\n<p>è¯¦è§ï¼š <strong>Volcano Global v0.3.0 Release Notes</strong>[9]<br />\næ„Ÿè°¢ç¤¾åŒºå¼€å‘è€…ï¼š@JesseStutler, @fx147, @Monokaix, @zhoujinyu, @anryko, @tanberBro</p>\n<h2><span class=\"prefix\"><span class=\"content\"><strong>Volcano Dashboard v0.2.0</strong></span></span></h2>\n<p>Volcano Dashboard v0.2.0 å¯¹èµ„æºç®¡ç†èƒ½åŠ›è¿›è¡Œäº†é‡å¤§å¢å¼ºï¼Œä½¿å¾—é€šè¿‡ Web ç•Œé¢ç®¡ç† Volcano èµ„æºæ›´åŠ ä¾¿æ·ã€‚<br />\n<strong>æ ¸å¿ƒå¢å¼º</strong>ï¼š</p>\n<ul>\n<li><strong>PodGroup å…¨æ™¯å¯è§†åŒ–</strong>ï¼šè·¨å‘½åç©ºé—´æŸ¥çœ‹ã€æœç´¢ã€è¿‡æ»¤ PodGroupï¼Œæ”¯æŒ YAML è¯­æ³•é«˜äº®ã€‚</li>\n<li><strong>Job ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼šç›´æ¥åœ¨ç•Œé¢åˆ›å»ºã€åˆ é™¤ Volcano Jobï¼Œæ“ä½œæ›´ä¾¿æ·ã€‚</li>\n<li><strong>Queue ç®¡ç†å¢å¼º</strong>ï¼šåœ¨çº¿ç¼–è¾‘ Queue é…é¢ã€æƒé‡ï¼Œæ”¯æŒ YAML ç›´æ¥ä¿®æ”¹ã€‚</li>\n<li><strong>å®‰å…¨åŠ å›º</strong>ï¼šé»˜è®¤é…ç½® SELinuxã€Seccompã€é root è¿è¡ŒåŠç¦æ­¢ææƒï¼Œä¿éšœç”Ÿäº§å®‰å…¨ã€‚</li>\n\n</ul>\n<p>è¯¦è§ï¼š <strong>Volcano Dashboard v0.2.0 Release Notes</strong>[10]<br />\næ„Ÿè°¢ç¤¾åŒºå¼€å‘è€…ï¼š@vzhou-p, @Shrutim1505, @JesseStutler, @karanBRAVO, @Sayan4444, @jayesh9747, @Alivestars24, @kuldeep, @Monokaix</p>\n<h2><span class=\"prefix\"><span class=\"content\"><strong>è°ƒåº¦å™¨ç¨³å®šæ€§ä¸æ€§èƒ½æå‡</strong></span></span></h2>\n<p><strong>Reclaim é‡æ„ä¸å¢å¼º</strong><br />\nå¯¹ Reclaim Action è¿›è¡Œäº†å…¨é¢é‡æ„ï¼Œå¹¶ä¿®å¤äº† Capacity Plugin ä¸­çš„å…³é”®é€»è¾‘é—®é¢˜ï¼Œå¤§å¹…æå‡å¤šç§Ÿæˆ·é›†ç¾¤èµ„æºå›æ”¶çš„å‡†ç¡®æ€§ã€ç¨³å®šæ€§å’Œæ€§èƒ½ã€‚<br />\nä¸»è¦æ”¹è¿›ï¼š</p>\n<ul>\n<li><strong>Reclaim Action é‡æ„</strong>ï¼šé‡æ„äº† reclaim å·¥ä½œæµï¼Œæé«˜ä»£ç å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§å’Œæµ‹è¯•è¦†ç›–ç‡ã€‚</li>\n<li><strong>å¢å¼ºçš„ Capacity Plugin é€»è¾‘</strong>ï¼šä¿®å¤äº† reclaimableFn å’Œ preemptiveFnï¼Œæ­£ç¡®å¤„ç†æ ‡é‡èµ„æºå¹¶é˜²æ­¢é”™è¯¯çš„æŠ¢å å†³ç­–ã€‚</li>\n<li><strong>ç¨³å®šæ€§æå‡</strong>ï¼šè§£å†³äº†èµ„æºè®¡ç®—ä¸­çš„è¾¹ç¼˜æƒ…å†µï¼Œé˜²æ­¢è°ƒåº¦æ­»å¾ªç¯å’Œè¯¯é©±é€ã€‚</li>\n\n</ul>\n<p>ç›¸å…³ PRï¼š</p>\n<p>https://github.com/volcano-sh/volcano/pull/4794,<br />\nhttps://github.com/volcano-sh/volcano/pull/4659,<br />\nhttps://github.com/volcano-sh/volcano/pull/4919<br />\næ„Ÿè°¢ç¤¾åŒºå¼€å‘è€…ï¼š@guoqinwill, @hajnalmt</p>\n<h2><span class=\"prefix\"><span class=\"content\"><strong>æ”¯æŒ Kubernetes 1.34</strong></span></span></h2>\n<p>Volcano ç‰ˆæœ¬ç´§è·Ÿ Kubernetes ç¤¾åŒºã€‚v1.14 å·²å…¨é¢æ”¯æŒæœ€æ–°çš„ Kubernetes v1.34ï¼Œå¹¶é€šè¿‡å®Œæ•´çš„å•å…ƒæµ‹è¯•å’Œ E2E æµ‹è¯•ä¿éšœåŠŸèƒ½ä¸ç¨³å®šæ€§ã€‚<br />\nç›¸å…³ PRï¼šhttps://github.com/volcano-sh/volcano/pull/4704<br />\næ„Ÿè°¢ç¤¾åŒºå¼€å‘è€…ï¼š@suyiiyii, @tunedev</p>\n<h1><span class=\"prefix\"><span class=\"content\"><strong>æ€»ç»“ï¼šVolcano v1.14.0 â€” AI æ—¶ä»£çš„ç»Ÿä¸€è°ƒåº¦å¹³å°</strong></span></span></h1>\n<p>Volcano v1.14 æ˜¯ä¸€ä¸ªé‡Œç¨‹ç¢‘å¼çš„ç‰ˆæœ¬ã€‚é€šè¿‡å¼•å…¥å¤šè°ƒåº¦å™¨æ¶æ„å’Œ Agent Schedulerï¼ŒVolcano æ­£å¼è¿ˆå…¥ç»Ÿä¸€è°ƒåº¦å¹³å°æ–°é˜¶æ®µï¼Œæ—¢èƒ½é«˜æ•ˆå¤„ç†æ‰¹é‡ AI è®­ç»ƒï¼Œåˆèƒ½æ»¡è¶³ AI Agent çš„æè‡´æ—¶å»¶è¦æ±‚ã€‚ç½‘ç»œæ‹“æ‰‘æ„ŸçŸ¥å¢å¼ºã€é€šç”¨æ“ä½œç³»ç»Ÿæ··éƒ¨æ”¯æŒã€æ˜‡è…¾ vNPU é›†æˆï¼Œè¿›ä¸€æ­¥å¤¯å®äº† Volcano åœ¨ AI åŸºç¡€è®¾æ–½é¢†åŸŸçš„é¢†å…ˆåœ°ä½ã€‚<br />\nåŒæ—¶ï¼ŒVolcano Global v0.3.0 é€šè¿‡ HyperJob å®ç°å¤§è§„æ¨¡åˆ†å¸ƒå¼è®­ç»ƒå’Œæ•°æ®æ„ŸçŸ¥è°ƒåº¦ï¼Œæ‰©å±•äº†å¤šé›†ç¾¤èƒ½åŠ›ã€‚Volcano Dashboard v0.2.0 é€šè¿‡å…¨é¢çš„èµ„æºç®¡ç†åŠŸèƒ½æ˜¾è‘—æ”¹å–„äº†ç”¨æˆ·ä½“éªŒã€‚</p>\n<p><strong>ç«‹å³ä½“éªŒ Volcano v1.14ï¼Œå…±å¯ AI æ—¶ä»£ç»Ÿä¸€è°ƒåº¦æ–°ç¯‡ç« ï¼</strong></p>\n<p><strong>v1.14.0 å‘å¸ƒåœ°å€ï¼š</strong>https://github.com/volcano-sh/volcano/releases/tag/v1.14.0<br />\n<strong>Volcano Global v0.3.0 å‘å¸ƒåœ°å€ï¼š</strong>https://github.com/volcano-sh/volcano-global/releases/tag/v0.3.0<br />\n<strong>Volcano Dashboard v0.2.0 å‘å¸ƒåœ°å€ï¼š</strong>https://github.com/volcano-sh/dashboard/releases/tag/v0.2.0</p>\n<h1><span class=\"prefix\"><span class=\"content\"><strong>è‡´   è°¢</strong></span></span></h1>\n<p>Volcano v1.14 ç”Ÿæ€ç‰ˆæœ¬ï¼ˆå« Volcano Global v0.3.0ã€Dashboard v0.2.0ï¼‰å…±æœ‰ 55 ä½ç¤¾åŒºè´¡çŒ®è€…å‚ä¸ã€‚è¡·å¿ƒæ„Ÿè°¢æ¯ä¸€ä½è´¡çŒ®è€…ï¼š</p>\n<table>\n<tbody>\n<tr><th>@3sunny</th><th>@3th4novo</th><th>@acsoto</th>\n</tr>\n<tr>\n<td>@Alivestars24</td>\n<td>@Aman-Cool</td>\n<td>@anryko</td>\n\n\n</tr>\n<tr>\n<td>@archlitchi</td>\n<td>@dafu-wu</td>\n<td>@DSFans2014</td>\n\n\n</tr>\n<tr>\n<td>@FAUST-BENCHOU</td>\n<td>@fengruotj</td>\n<td>@Freshwlnd</td>\n\n\n</tr>\n<tr>\n<td>@fx147</td>\n<td>@goyalpalak18</td>\n<td>@guoqinwill</td>\n\n\n</tr>\n<tr>\n<td>@Haibara-Ai97</td>\n<td>@hajnalmt</td>\n<td>@halcyon-r</td>\n\n\n</tr>\n<tr>\n<td>@handan-yxh</td>\n<td>@JackyTYang</td>\n<td>@jayesh9747</td>\n\n\n</tr>\n<tr>\n<td>@JesseStutler</td>\n<td>@jiahuat</td>\n<td>@karanBRAVO</td>\n\n\n</tr>\n<tr>\n<td>@kingeasternsun</td>\n<td>@kiritoxkiriko</td>\n<td>@kube-gopher</td>\n\n\n</tr>\n<tr>\n<td>@kuldeep</td>\n<td>@LiZhenCheng9527</td>\n<td>@medyagh</td>\n\n\n</tr>\n<tr>\n<td>@MondayCha</td>\n<td>@Monokaix</td>\n<td>@mvinchoo</td>\n\n\n</tr>\n<tr>\n<td>@neeraj542</td>\n<td>@nitindhiman314e</td>\n<td>@ouyangshengjia</td>\n\n\n</tr>\n<tr>\n<td>@PersistentJZH</td>\n<td>@qi-min</td>\n<td>@rhh777</td>\n\n\n</tr>\n<tr>\n<td>@ruanwenjun</td>\n<td>@RushabhMehta2005</td>\n<td>@sailorvii</td>\n\n\n</tr>\n<tr>\n<td>@Sayan4444</td>\n<td>@Shrutim1505</td>\n<td>@ssfffss</td>\n\n\n</tr>\n<tr>\n<td>@suyiiyii</td>\n<td>@tanberBro</td>\n<td>@Tau721</td>\n\n\n</tr>\n<tr>\n<td>@vzhou-p</td>\n<td>@wangyang0616</td>\n<td>@weapons97</td>\n\n\n</tr>\n<tr>\n<td>@Wonki4</td>\n<td>@zhaoqi612</td>\n<td>@zhengchenyu</td>\n\n\n</tr>\n<tr>\n<td>@zhoujinyu</td>\n<td>@zjj2wry</td>\n<td>&nbsp;</td>\n\n\n</tr>\n\n\n</tbody>\n\n\n</table>\n<p><strong>ç›¸å…³é“¾æ¥</strong></p>\n<p>[1] Volcano: <em>https://volcano.sh/en/</em><br />\n[2] Volcano v1.14.0: <em>https://github.com/volcano-sh/volcano/releases/tag/v1.14.0</em><br />\n[3] Sharding Controller Design: <em>https://github.com/volcano-sh/volcano/blob/v1.14.0/docs/design/sharding_controller.md</em><br />\n[4] Agent Scheduler Design: <em>https://github.com/volcano-sh/volcano/blob/v1.14.0/docs/design/agent-scheduler.md</em><br />\n[5] Network Topology Aware Scheduling: <em>https://github.com/volcano-sh/volcano/blob/v1.14.0/docs/design/Network%20Topology%20Aware%20Scheduling.md</em><br />\n[6] CPU Throttle Design: <em>https://github.com/volcano-sh/volcano/blob/v1.14.0/docs/design/cpu-throttle-design.md</em><br />\n[7] Agent Cgroup V2 Adaptation: <em>https://github.com/volcano-sh/volcano/blob/v1.14.0/docs/design/agent-cgroup-v2-adaptation.md</em><br />\n[8] How to Use vNPU: <em>https://github.com/volcano-sh/volcano/blob/v1.14.0/docs/user-guide/how_to_use_vnpu.md</em><br />\n[9] Volcano Global v0.3.0 Release Notes: <em>https://github.com/volcano-sh/volcano-global/releases/tag/v0.3.0</em><br />\n[10] Volcano Dashboard v0.2.0 Release Notes: <em>https://github.com/volcano-sh/dashboard/releases/tag/v0.2.0</em></p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-13 16:35</span>&nbsp;\n<a href=\"https://www.cnblogs.com/huaweiyun\">åä¸ºäº‘å¼€å‘è€…è”ç›Ÿ</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">0</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "Admin.NETå¼€æºç‰ˆå¾®æœåŠ¡æ”¹é€ è®°å½•",
      "link": "https://www.cnblogs.com/shiningrise/p/19612443",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/shiningrise/p/19612443\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-13 15:44\">\n    <span>Admin.NETå¼€æºç‰ˆå¾®æœåŠ¡æ”¹é€ è®°å½•</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"adminnetå¼€æºç‰ˆå¾®æœåŠ¡æ”¹é€ è®°å½•\">Admin.NETå¼€æºç‰ˆå¾®æœåŠ¡æ”¹é€ è®°å½•</h1>\n<h2 id=\"å°†adminnetcoreé¡¹ç›®æ‹†åˆ†æˆä¸¤ä¸ªé¡¹ç›®adminnetcommonadminnetcore\">å°†Admin.NET.Coreé¡¹ç›®æ‹†åˆ†æˆä¸¤ä¸ªé¡¹ç›®ï¼šAdmin.NET.Commonï¼ŒAdmin.NET.Core</h2>\n<p>Admin.NET.Commonæ”¾åŸºç¡€å·¥å…·ç±»</p>\n<p>Admin.NET.Coreæ”¾æ¡†æ¶æ ¸å¿ƒç±»åº“</p>\n<h2 id=\"aspireappapphostä¸­çš„apphostcsé…ç½®\">AspireApp.AppHostä¸­çš„AppHost.csé…ç½®ï¼š</h2>\n<pre><code>using Aspire.Hosting;\nusing Aspire.Hosting.Dapr;\nusing AspireApp.AppHost;\n\nvar builder = DistributedApplication.CreateBuilder(args);\n\nvar postgresQL = builder.AddPostgres(\"postgresQL\")\n                        .WithImage(\"ankane/pgvector\")\n                        .WithImageTag(\"latest\")\n                        .WithLifetime(ContainerLifetime.Persistent)\n                        .WithHealthCheck()\n                        .WithPgWeb();\nvar postgres = postgresQL.AddDatabase(\"postgres\");\nvar postgres2 = postgresQL.AddDatabase(\"postgres2\");\n\n//var redis = builder.AddRedis(\"redis\").WithLifetime(ContainerLifetime.Persistent)\n//                    .WithHealthCheck()\n//                    .WithRedisCommander();\n\n// ä½¿ç”¨ RabbitMQ ä½œä¸º Pub/Sub ç»„ä»¶\n//var rabbitmq = builder.AddRabbitMQ(\"rabbitmq\")\n//                        .WithLifetime(ContainerLifetime.Persistent)\n//                        .WithHealthCheck()\n//                        .WithManagementPlugin();\n\n// 1. å®šä¹‰å…±äº«ç›®å½•çš„ç»å¯¹è·¯å¾„ï¼ˆå»ºè®®æŒ‡å‘ admin-net-core çš„å®é™…ç›®å½•æˆ–ç‹¬ç«‹çš„ shared ç›®å½•ï¼‰\nvar uploadPath = Path.GetFullPath(\"../Admin.NET/Admin.NET.Core/wwwroot/upload\");\n\n// ç¡®ä¿ç›®å½•å­˜åœ¨\nif (!Directory.Exists(uploadPath))\n{\n    Directory.CreateDirectory(uploadPath);\n}\n\n// Admin.NET.Core ä½¿ç”¨ Furion çš„ Knife4j UIï¼Œä¸ä½¿ç”¨ Aspire çš„ Swagger UI\nvar core = builder.AddProject&lt;Projects.Admin_NET_Core&gt;(\"admin-net-core\")\n    .WithReference(postgres)\n    .WaitFor(postgres)\n    .WithSwaggerUI();\n\nvar baseApi = builder.AddProject&lt;Projects.Base&gt;(\"base\")\n    .WithReference(postgres2)\n    .WithSwaggerUI()\n    .WithReference(core)\n    .WaitFor(postgres2)\n    .WaitFor(core);\n\nvar yarp = builder.AddProject&lt;Projects.AspireApp_Yarp&gt;(\"aspireapp-yarp\")\n    .WithEndpoint( port: 5008, scheme: \"http\", name: \"yarp-http\")    // æŒ‡å®šå”¯ä¸€åç§°\n    .WithEndpoint( port: 7008, scheme: \"https\", name: \"yarp-https\") // æŒ‡å®šå”¯ä¸€åç§°\n    .WithReference(core)\n    .WithReference(baseApi)\n    .WaitFor(core)\n    .WaitFor(baseApi);\n\n//var frontend = builder.AddNodeApp(\n//       \"frontend\",\n//       scriptPath: \"scripts/run-pnpm.cjs\",\n//       workingDirectory: \"../Web\",\n//       args: new[] { \"dev\" }\n//   )\n//   .WithReference(yarp)\n//   .WaitFor(yarp);\n\nbuilder.Build().Run();\n\n\n</code></pre>\n<h2 id=\"aipç½‘å…³aspireappyarp\">AIPç½‘å…³ï¼šAspireApp.Yarp</h2>\n<p>Program.cs</p>\n<pre><code>var builder = WebApplication.CreateBuilder(args);\n\nbuilder.AddServiceDefaults();\nbuilder.Services.AddReverseProxy()\n                .LoadFromConfig(builder.Configuration.GetSection(\"ReverseProxy\"))\n                .AddServiceDiscoveryDestinationResolver();\n\nvar app = builder.Build();\n\napp.MapDefaultEndpoints();\napp.MapReverseProxy();\n\napp.MapGet(\"/\", () =&gt; \"Hello World!\");\n\napp.Run();\n\n</code></pre>\n<p>appsettings.json</p>\n<pre><code>{\n  \"Logging\": {\n    \"LogLevel\": {\n      \"Default\": \"Information\",\n      \"Microsoft.AspNetCore\": \"Warning\"\n    }\n  },\n  \"AllowedHosts\": \"*\",\n  \"ReverseProxy\": {\n    \"Routes\": {\n      \"core\": {\n        \"ClusterId\": \"core\",\n        \"Match\": {\n          \"Path\": \"/core/{**remainder}\"\n        },\n        \"Transforms\": [\n          { \"PathRemovePrefix\": \"/core\" },\n          { \"PathPrefix\": \"/\" },\n          { \"RequestHeaderOriginalHost\": \"true\" }\n        ]\n      },\n      \"base\": {\n        \"ClusterId\": \"base\",\n        \"Match\": {\n          \"Path\": \"/base/{**remainder}\"\n        },\n        \"Transforms\": [\n          { \"PathRemovePrefix\": \"/base\" },\n          { \"PathPrefix\": \"/\" },\n          { \"RequestHeaderOriginalHost\": \"true\" }\n        ]\n      }\n    },\n    \"Clusters\": {\n      \"core\": {\n        \"Destinations\": {\n          \"base_destination\": {\n            \"Address\": \"http+https://admin-net-core\"\n          }\n        }\n      },\n      \"base\": {\n        \"Destinations\": {\n          \"base_destination\": {\n            \"Address\": \"http+https://base\"\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre>\n<h2 id=\"ä¸šåŠ¡é¡¹ç›®baseé¡¹ç›®è°ƒç”¨æ ¸å¿ƒé¡¹ç›®coreé¡¹ç›®çš„æ–¹æ³•\">ä¸šåŠ¡é¡¹ç›®(baseé¡¹ç›®)è°ƒç”¨æ ¸å¿ƒé¡¹ç›®(coreé¡¹ç›®ï¼‰çš„æ–¹æ³•</h2>\n<p>æˆ‘ä»¬ä½¿ç”¨Refitæ¥æœåŠ¡è°ƒç”¨</p>\n<p>åœ¨baseé¡¹ç›®ä¸­çš„Startup.csä¸­</p>\n<pre><code>        // æ³¨å†Œ JwtTokenHandler - ç”¨äºè‡ªåŠ¨æ·»åŠ  JWT Token åˆ° Refit è¯·æ±‚\n        services.AddTransient&lt;JwtTokenHandler&gt;();\n        \n        // é…ç½® Refit å®¢æˆ·ç«¯å¹¶æ·»åŠ  JWT Token å¤„ç†å™¨\n        //ç³»ç»Ÿé…ç½®\n        services.AddRefitClient&lt;IConfigService&gt;(refitSettings)\n               .ConfigureHttpClient(c =&gt; c.BaseAddress = new(\"https+http://admin-net-core\"))\n               .AddHttpMessageHandler&lt;JwtTokenHandler&gt;();\n        //ç³»ç»Ÿèœå•     \n        services.AddRefitClient&lt;IMenuService&gt;(refitSettings)\n               .ConfigureHttpClient(c =&gt; c.BaseAddress = new(\"https+http://admin-net-core\"))\n               .AddHttpMessageHandler&lt;JwtTokenHandler&gt;();\n        //ç»„ç»‡æœºæ„\n        services.AddRefitClient&lt;IOrgService&gt;(refitSettings)\n               .ConfigureHttpClient(c =&gt; c.BaseAddress = new(\"https+http://admin-net-core\"))\n               .AddHttpMessageHandler&lt;JwtTokenHandler&gt;();\n        //æ–‡ä»¶\n        services.AddRefitClient&lt;IFileService&gt;(refitSettings)\n               .ConfigureHttpClient(c =&gt; c.BaseAddress = new(\"https+http://admin-net-core\"))\n               .AddHttpMessageHandler&lt;JwtTokenHandler&gt;();\n\n        services.AddRefitClient&lt;ITest&gt;(refitSettings)\n            .ConfigureHttpClient(c =&gt; c.BaseAddress = new(\"https+http://apiservice\"))\n            .AddHttpMessageHandler&lt;JwtTokenHandler&gt;();\n</code></pre>\n<p>å…¶ä¸­æœ€é‡è¦çš„æƒé™æ¥å£è°ƒç”¨</p>\n<pre><code>using Refit;\nusing GetAttribute = Refit.GetAttribute;\nnamespace Base.Rest;\n\npublic interface IMenuService\n{\n    [Get(\"/api/sysMenu/getOwnBtnPermList\")]\n    Task&lt;List&lt;string&gt;&gt; GetOwnBtnPermList();\n\n    [Get(\"/api/sysMenu/getAllBtnPermList\")]\n    Task&lt;List&lt;string&gt;&gt; GetAllBtnPermList();\n}\n</code></pre>\n<p>ä¿®æ”¹baseé¡¹ç›®çš„æƒé™éªŒè¯æ–¹æ³•JwtHandler.cs</p>\n<p>IConfigService  IMenuService å°±æ˜¯æˆ‘ä»¬å®šä¹‰çš„Refitæ¥å£ï¼Œè¿™æ ·ï¼Œæ¯æ¬¡æƒé™éªŒè¯å°±ä¼šè°ƒç”¨coreé¡¹ç›®çš„APIæ¥å£</p>\n<pre><code>using Admin.NET.Core;\nusing Admin.NET.Core.Service;\nusing Base.Rest;\nusing Furion;\nusing Furion.Authorization;\nusing Furion.DataEncryption;\nusing Microsoft.AspNetCore.Authorization;\nusing Microsoft.AspNetCore.Http;\nusing System;\nusing System.Threading.Tasks;\n\nnamespace Admin.NET.Application;\n\npublic class JwtHandler : AppAuthorizeHandler\n{\n    private readonly SysCacheService _sysCacheService = App.GetRequiredService&lt;SysCacheService&gt;();\n    private readonly IConfigService _sysConfigService = App.GetRequiredService&lt;IConfigService&gt;();\n    private static readonly IMenuService SysMenuService = App.GetRequiredService&lt;IMenuService&gt;();\n\n    /// &lt;summary&gt;\n    /// è‡ªåŠ¨åˆ·æ–°Token\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"context\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"httpContext\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public override async Task HandleAsync(AuthorizationHandlerContext context, DefaultHttpContext httpContext)\n    {\n        // è‹¥å½“å‰è´¦å·å­˜åœ¨é»‘åå•ä¸­åˆ™æˆæƒå¤±è´¥\n        if (_sysCacheService.ExistKey($\"{CacheConst.KeyBlacklist}{context.User.FindFirst(ClaimConst.UserId)?.Value}\"))\n        {\n            context.Fail();\n            context.GetCurrentHttpContext().SignoutToSwagger();\n            return;\n        }\n\n        var tokenExpire = await _sysConfigService.GetTokenExpire();\n        var refreshTokenExpire = await _sysConfigService.GetRefreshTokenExpire();\n        if (JWTEncryption.AutoRefreshToken(context, context.GetCurrentHttpContext(), tokenExpire.Result, refreshTokenExpire.Result))\n        {\n            await AuthorizeHandleAsync(context);\n        }\n        else\n        {\n            context.Fail(); // æˆæƒå¤±è´¥\n            var currentHttpContext = context.GetCurrentHttpContext();\n            if (currentHttpContext == null) return;\n\n            // è·³è¿‡ç”±äº SignatureAuthentication å¼•å‘çš„å¤±è´¥\n            if (currentHttpContext.Items.ContainsKey(SignatureAuthenticationDefaults.AuthenticateFailMsgKey)) return;\n            currentHttpContext.SignoutToSwagger();\n        }\n    }\n\n    public override async Task&lt;bool&gt; PipelineAsync(AuthorizationHandlerContext context, DefaultHttpContext httpContext)\n    {\n        // å·²è‡ªåŠ¨éªŒè¯ Jwt Token æœ‰æ•ˆæ€§\n        return await CheckAuthorizeAsync(httpContext);\n    }\n\n    /// &lt;summary&gt;\n    /// æƒé™æ ¡éªŒæ ¸å¿ƒé€»è¾‘\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"httpContext\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    private static async Task&lt;bool&gt; CheckAuthorizeAsync(DefaultHttpContext httpContext)\n    {\n        // ç™»å½•æ¨¡å¼åˆ¤æ–­PCã€APP\n        if (App.User.FindFirst(ClaimConst.LoginMode)?.Value == ((int)LoginModeEnum.APP).ToString())\n            return true;\n\n        // æ’é™¤è¶…ç®¡\n        if (App.User.FindFirst(ClaimConst.AccountType)?.Value == ((int)AccountTypeEnum.SuperAdmin).ToString())\n            return true;\n\n        // è·¯ç”±åç§°\n        var routeName = httpContext.Request.Path.StartsWithSegments(\"/api\")\n            ? httpContext.Request.Path.Value![5..].Replace(\"/\", \":\")\n            : httpContext.Request.Path.Value![1..].Replace(\"/\", \":\");\n\n        // è·å–ç”¨æˆ·æ‹¥æœ‰æŒ‰é’®æƒé™é›†åˆ\n        var ownBtnPermList = await SysMenuService.GetOwnBtnPermList();\n        if (ownBtnPermList.Exists(u =&gt; routeName.Equals(u, StringComparison.CurrentCultureIgnoreCase)))\n            return true;\n\n        // è·å–ç³»ç»Ÿæ‰€æœ‰æŒ‰é’®æƒé™é›†åˆ\n        var allBtnPermList = await SysMenuService.GetAllBtnPermList();\n        return allBtnPermList.TrueForAll(u =&gt; !routeName.Equals(u, StringComparison.CurrentCultureIgnoreCase));\n    }\n}\n</code></pre>\n<h2 id=\"é¡¹ç›®åœ°å€\">é¡¹ç›®åœ°å€</h2>\n<p><a href=\"https://gitee.com/shiningrise/aspire-app\" rel=\"noopener nofollow\" target=\"_blank\">AspireApp: Admin.NETå¾®æœåŠ¡ç‰ˆ</a></p>\n<p><a href=\"https://gitee.com/zuohuaijun/Admin.NET\" rel=\"noopener nofollow\" target=\"_blank\">Admin.NET: ğŸ”¥ğŸ”¥ğŸ”¥ Admin.NET åŸºäº .NET8/10 (Furion/SqlSugar) å®ç°çš„é€šç”¨æƒé™å¼€å‘æ¡†æ¶ï¼Œå‰ç«¯é‡‡ç”¨ Vue3/Element-plusï¼Œä»£ç ç®€æ´ã€æ˜“æ‰©å±•ã€‚æ•´åˆæœ€æ–°æŠ€æœ¯ï¼Œæ¨¡å—æ’ä»¶å¼å¼€å‘ï¼Œå‰åç«¯åˆ†ç¦»ï¼Œå¼€ç®±å³ç”¨ã€‚é›†æˆå¤šç§Ÿæˆ·ã€ç¼“å­˜ã€æ•°æ®æ ¡éªŒã€é‰´æƒã€äº‹ä»¶æ€»çº¿ã€åŠ¨æ€APIã€é€šè®¯ã€è¿œç¨‹è¯·æ±‚ã€ä»»åŠ¡è°ƒåº¦ã€æ‰“å°ç­‰ä¼—å¤šé»‘ç§‘æŠ€ã€‚è®©å¼€å‘æ›´ç®€å•ã€æ›´é€šç”¨ã€æ›´æµè¡Œï¼</a></p>\n\n\n</div>\n<div id=\"MySignature\">\n    æ¬¢è¿å…‰ä¸´:<font size=\"3\"><font size=\"3\"><a href=\"http://shiningrise.cnblogs.com/\" target=\"_blank\"><font size=\"3\"><font size=\"3\">http://shiningrise.cnblogs.com</font></font></a><br /><br /></font></font>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-13 15:44</span>&nbsp;\n<a href=\"https://www.cnblogs.com/shiningrise\">shiningrise</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">78</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "Nano-vLLM-Ascend(æŒç»­æ›´æ–°ä¸­)",
      "link": "https://www.cnblogs.com/linzm14/p/19611415",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/linzm14/p/19611415\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-13 11:38\">\n    <span>Nano-vLLM-Ascend(æŒç»­æ›´æ–°ä¸­)</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h2 id=\"nano-vllm-ascend\"><a href=\"https://github.com/linzm1007/nano-vllm-ascend\" rel=\"noopener nofollow\" target=\"_blank\">Nano-vLLM-Ascend</a></h2>\n<p>é¡¹ç›®é“¾æ¥ï¼š<a href=\"https://github.com/linzm1007/nano-vllm-ascend\" rel=\"noopener nofollow\" target=\"_blank\">https://github.com/linzm1007/nano-vllm-ascend</a><br />\nnano-vllmæ˜¯githubå¼€æºçš„ä¸€ä¸ªgpuæ¨ç†é¡¹ç›®ï¼ŒåŸºäºå¼€æºç‰ˆæœ¬å¼„çš„ä¸€ä¸ªascend npuç‰ˆæœ¬æ¨ç†å°demoï¼Œæ—¨åœ¨å¸®åŠ©åˆå­¦è€…äº†è§£æ¨ç†çš„æ•´ä½“æµç¨‹ï¼ŒåŒºåˆ«äºvllmï¼Œnano-vllmä½“é‡æ›´å°ï¼Œéº»é›€è™½å°äº”è„ä¿±å…¨ï¼Œæ›´æœ‰åŠ©äºåˆå­¦è€…å­¦ä¹ ï¼Œéå¸¸é€‚åˆç”¨äºç›¸å…³æ¦‚å¿µçš„ç†è§£ã€‚</p>\n<h2 id=\"æ¡†æ¶å±‚æµç¨‹å›¾\">æ¡†æ¶å±‚æµç¨‹å›¾</h2>\n<p><img alt=\"nona-vllmæ¡†æ¶\" class=\"lazyload\" /></p>\n<h2 id=\"æ¨¡å‹å±‚æµç¨‹å›¾\">æ¨¡å‹å±‚æµç¨‹å›¾</h2>\n<p><img alt=\"Qwen3-0.6B\" class=\"lazyload\" /></p>\n<h2 id=\"ç‰¹æ€§\">ç‰¹æ€§</h2>\n<ul>\n<li>ğŸ“– <strong>å¯è¯»ä»£ç åº“</strong> - æ ¸å¿ƒçº¦2428è¡ŒPythonä»£ç çš„æ¸…æ™°å®ç°</li>\n<li>âš¡ <strong>ä¼˜åŒ–å¥—ä»¶</strong> - å¼ é‡å¹¶è¡Œã€torchair Ascend IRå›¾ç¼–è¯‘å’Œå›¾ç¼“å­˜ã€èåˆç®—å­ã€å‰ç¼€ç¼“å­˜ç­‰</li>\n</ul>\n<ul>\n<li>[âœ…] å¾…å®Œæˆï¼šç›®å‰åªæ”¯æŒå•ç®—å­, npuå›¾æ¨¡å¼å®ç°</li>\n<li>[âœ…] æ”¯æŒCPUç¯å¢ƒè¿è¡Œï¼š<a href=\"https://github.com/linzm1007/nano-vllm-cpu\" rel=\"noopener nofollow\" target=\"_blank\">nano-vllm-cpu ä»£ç ä»“åº“</a></li>\n<li>[âœ…] æ€§èƒ½ä¼˜åŒ–</li>\n<li>[â³] æ”¯æŒæ¨¡å‹: Qwen3-0.6Bã€Qwen3-32Bã€Qwen2-0.5Bã€Qwen2.5-0.5Bã€Qwen2.5-0.5B-Instructã€Llama-3.2-1B-Instructã€Qwen3-30B-A3Bã€Qwen3-VL-2B-Instructã€MiniCPM4-0.5B</li>\n<li>[âœ…] æ”¯æŒä¸€ä¸ªmoeæ¨¡å‹:Qwen3-30B-A3B(æš‚æ—¶ä¸æ”¯æŒå…¥å›¾)</li>\n<li>[ğŸ“…] æ”¯æŒä¸€ä¸ªomniæ¨¡å‹</li>\n<li>[âœ…] æ”¯æŒä¸€ä¸ªvlæ¨¡å‹:Qwen3-VL-2B-Instruct(æš‚æ—¶ä¸æ”¯æŒå…¥å›¾)</li>\n<li>[âœ…] å®ç°page attention</li>\n<li>[ğŸ“…] å®ç°ä¸€ä¸ªè‡ªå®šä¹‰ç®—å­</li>\n<li>[ğŸ“…] æ”¯æŒåœ¨çº¿æ¨ç†</li>\n</ul>\n<p>torchairæ¥å£å‚è€ƒ <a href=\"https://www.hiascend.com/document/detail/zh/Pytorch/710/modthirdparty/torchairuseguide/torchair_00008.html\" rel=\"noopener nofollow\" target=\"_blank\">https://www.hiascend.com/document/detail/zh/Pytorch/710/modthirdparty/torchairuseguide/torchair_00008.html</a><br />\nèåˆç®—å­æ¥å£å‚è€ƒ <a href=\"https://www.hiascend.com/document/detail/zh/Pytorch/720/apiref/torchnpuCustomsapi/context/torch_npu-npu_fused_infer_attention_score_v2.md\" rel=\"noopener nofollow\" target=\"_blank\">https://www.hiascend.com/document/detail/zh/Pytorch/720/apiref/torchnpuCustomsapi/context/torch_npu-npu_fused_infer_attention_score_v2.md</a><br />\nattentionå®ç°å‚è€ƒ <a href=\"https://gitee.com/omniai/omniinfer/blob/master/omni/layers/attention/backend/attention.py\" rel=\"noopener nofollow\" target=\"_blank\">https://gitee.com/omniai/omniinfer/blob/master/omni/layers/attention/backend/attention.py</a>  forward_vanillaå‡½æ•°</p>\n<h2 id=\"æ”¯æŒçš„æ¨¡å‹\">æ”¯æŒçš„æ¨¡å‹</h2>\n<table>\n<thead>\n<tr>\n<th>æ¶æ„</th>\n<th>æ¨¡å‹</th>\n<th>ç¤ºä¾‹ HF æ¨¡å‹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Qwen3ForCausalLM</td>\n<td>Qwen3-0.6B,Qwen3-32B</td>\n<td></td>\n</tr>\n<tr>\n<td>Qwen2ForCausalLM</td>\n<td>Qwen2-0.5B</td>\n<td></td>\n</tr>\n<tr>\n<td>LlamaForCausalLM</td>\n<td>Llama-3.2-1B-Instruct</td>\n<td></td>\n</tr>\n<tr>\n<td>Qwen3MoeForCausalLM</td>\n<td>Qwen3-30B-A3B</td>\n<td></td>\n</tr>\n<tr>\n<td>Qwen3VLForConditionalGeneration</td>\n<td>Qwen2.5-VL-3B-Instruct</td>\n<td></td>\n</tr>\n<tr>\n<td>MiniCPMForCausalLM</td>\n<td>MiniCPM4-0.5B</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"ä»£ç è¡Œæ•°\">ä»£ç è¡Œæ•°</h2>\n<p>ğŸ“Š æ€»ä½“æ•°æ®</p>\n<table>\n<thead>\n<tr>\n<th>èŒƒå›´</th>\n<th>æ–‡ä»¶æ•°</th>\n<th>æ€»è¡Œæ•°</th>\n<th>å æ¯”</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>nanovllm å…¨éƒ¨</td>\n<td>20 ä¸ª</td>\n<td>4,652 è¡Œ</td>\n<td>100%</td>\n</tr>\n<tr>\n<td>models ç›®å½•</td>\n<td>5 ä¸ª</td>\n<td>2,224 è¡Œ</td>\n<td>47.8%</td>\n</tr>\n<tr>\n<td>é™¤ models å¤–</td>\n<td>15 ä¸ª</td>\n<td>2,428 è¡Œ</td>\n<td>52.2%</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"æ¨ç†ä¼˜åŒ–æŠ€æœ¯å¤§çº²\">æ¨ç†ä¼˜åŒ–æŠ€æœ¯å¤§çº²</h2>\n<p>ğŸ“š <strong>å®Œæ•´æŠ€æœ¯æ–‡æ¡£</strong>ï¼š<a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/inference_optimization_guide.md\" rel=\"noopener nofollow\" target=\"_blank\">LLM æ¨ç†ä¼˜åŒ–æŠ€æœ¯å¤§çº²</a></p>\n<p>æœ¬æ–‡æ¡£æ•´ç†äº† LLM æ¨ç†é¢†åŸŸçš„ <strong>20 å¤§ç±»å…³é”®æŠ€æœ¯</strong>ï¼Œåˆ†ä¸º 7 ä¸ªå±‚æ¬¡ï¼š</p>\n<h3 id=\"-æ ¸å¿ƒæŠ€æœ¯åŸºç¡€å¿…å¤‡\">ğŸ”¥ æ ¸å¿ƒæŠ€æœ¯ï¼ˆåŸºç¡€å¿…å¤‡ï¼‰</h3>\n<ul>\n<li><strong>KV Cache ç®¡ç†</strong>ï¼šPageAttentionã€Prefix Cachingã€KV Cache å‹ç¼©</li>\n<li><strong>Attention ä¼˜åŒ–</strong>ï¼šFlashAttentionã€GQA/MQAã€ç¨€ç–æ³¨æ„åŠ›</li>\n<li><strong>æ‰¹å¤„ç†ç­–ç•¥</strong>ï¼šContinuous Batchingã€Dynamic Batching</li>\n</ul>\n<h3 id=\"-æ€§èƒ½ä¼˜åŒ–è¿›é˜¶\">ğŸš€ æ€§èƒ½ä¼˜åŒ–ï¼ˆè¿›é˜¶ï¼‰</h3>\n<ul>\n<li><strong>é‡åŒ–æŠ€æœ¯</strong>ï¼šINT8/INT4/FP8ã€AWQã€GPTQã€GGUF</li>\n<li><strong>æŠ•æœºé‡‡æ ·</strong>ï¼šSpeculative Decodingã€Medusaã€Lookahead</li>\n<li><strong>è§£ç ä¼˜åŒ–</strong>ï¼šParallel Decodingã€Token Tree Verification</li>\n</ul>\n<h3 id=\"ï¸-ç³»ç»Ÿæ¶æ„\">ğŸ—ï¸ ç³»ç»Ÿæ¶æ„</h3>\n<ul>\n<li><strong>è°ƒåº¦ç­–ç•¥</strong>ï¼šFCFSã€SJFã€Priority-basedã€Preemption</li>\n<li><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼šMemory Poolã€Swappingã€Offloading</li>\n<li><strong>å¹¶è¡Œç­–ç•¥</strong>ï¼šTensor/Pipeline/Expert/Sequence Parallelism</li>\n</ul>\n<h3 id=\"-ç‰¹æ®Šåœºæ™¯\">ğŸ§  ç‰¹æ®Šåœºæ™¯</h3>\n<ul>\n<li><strong>é•¿ä¸Šä¸‹æ–‡</strong>ï¼šRoPE Scalingã€StreamingLLMã€Ring Attention</li>\n<li><strong>å¤šæ¨¡æ€</strong>ï¼šVision-Languageã€Audio-Languageã€Unified Architecture</li>\n<li><strong>MoE ä¼˜åŒ–</strong>ï¼šExpert Routingã€Load Balancingã€All-to-All é€šä¿¡</li>\n</ul>\n<h3 id=\"-åº•å±‚ä¼˜åŒ–\">âš¡ åº•å±‚ä¼˜åŒ–</h3>\n<ul>\n<li><strong>å›¾ç¼–è¯‘</strong>ï¼šTorchAirã€TensorRT-LLMã€Torch.compile</li>\n<li><strong>ç®—å­èåˆ</strong>ï¼šQKV Fusionã€Custom CUDA/Triton Kernels</li>\n<li><strong>é€šä¿¡ä¼˜åŒ–</strong>ï¼šNCCL/HCCLã€RDMAã€GPUDirect</li>\n</ul>\n<h3 id=\"-è¯„ä¼°è§‚æµ‹\">ğŸ“Š è¯„ä¼°è§‚æµ‹</h3>\n<ul>\n<li><strong>æ€§èƒ½åˆ†æ</strong>ï¼šMemory/Compute Profilingã€Roofline Analysis</li>\n<li><strong>å…³é”®æŒ‡æ ‡</strong>ï¼šTTFTã€TPOTã€Throughputã€GPU Utilization</li>\n</ul>\n<h3 id=\"-å‰æ²¿è¶‹åŠ¿\">ğŸ”® å‰æ²¿è¶‹åŠ¿</h3>\n<ul>\n<li><strong>æ¨¡å‹æ¶æ„</strong>ï¼šMamba/RWKVã€Mixture of Depthsã€RetNet</li>\n<li><strong>æœåŠ¡åŒ–</strong>ï¼šDisaggregated Servingã€Elastic Scaling</li>\n<li><strong>æ–°å…´æ–¹å‘</strong>ï¼šæ¨ç†è’¸é¦ã€Early Exitã€Hardware-Aware NAS</li>\n</ul>\n<hr />\n<h2 id=\"attention\">Attention</h2>\n<h3 id=\"pageattention\">PageAttention</h3>\n<p><strong>PageAttention</strong> æ˜¯ vLLM çš„æ ¸å¿ƒåˆ›æ–°æŠ€æœ¯ï¼Œçµæ„Ÿæ¥è‡ªæ“ä½œç³»ç»Ÿçš„<strong>è™šæ‹Ÿå†…å­˜åˆ†é¡µæœºåˆ¶</strong>ï¼Œç”¨äºé«˜æ•ˆç®¡ç† LLM æ¨ç†ä¸­çš„ KV Cacheã€‚</p>\n<h4 id=\"æ ¸å¿ƒæ¦‚å¿µ\">æ ¸å¿ƒæ¦‚å¿µ</h4>\n<p>ä¼ ç»Ÿ KV Cache åˆ†é…æ–¹å¼ä¼šä¸ºæ¯ä¸ªåºåˆ—é¢„åˆ†é…æœ€å¤§å¯èƒ½é•¿åº¦çš„è¿ç»­å†…å­˜ï¼Œå¯¼è‡´ä¸¥é‡çš„å†…å­˜æµªè´¹å’Œç¢ç‰‡ã€‚PageAttention å€Ÿé‰´æ“ä½œç³»ç»Ÿåˆ†é¡µæ€æƒ³ï¼Œå°† KV Cache åˆ’åˆ†ä¸ºå›ºå®šå¤§å°çš„ blockï¼ŒæŒ‰éœ€åŠ¨æ€åˆ†é…ã€‚</p>\n<h4 id=\"å…³é”®æŠ€æœ¯ç‚¹\">å…³é”®æŠ€æœ¯ç‚¹</h4>\n<table>\n<thead>\n<tr>\n<th>æŠ€æœ¯</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Block ç®¡ç†</strong></td>\n<td>å°† KV Cache åˆ’åˆ†ä¸ºå›ºå®šå¤§å°çš„ blockï¼ˆå¦‚ 16/32 tokensï¼‰ï¼Œæ¯ä¸ª block ç‹¬ç«‹åˆ†é…</td>\n</tr>\n<tr>\n<td><strong>Block Table</strong></td>\n<td>ç±»ä¼¼é¡µè¡¨çš„æ•°æ®ç»“æ„ï¼Œè®°å½•é€»è¾‘ token ä½ç½®åˆ°ç‰©ç† block çš„æ˜ å°„å…³ç³»</td>\n</tr>\n<tr>\n<td><strong>éè¿ç»­å­˜å‚¨</strong></td>\n<td>åŒä¸€åºåˆ—çš„ KV Cache å¯ä»¥åˆ†æ•£åœ¨å¤šä¸ªä¸è¿ç»­çš„ block ä¸­</td>\n</tr>\n<tr>\n<td><strong>å†…å­˜å…±äº«</strong></td>\n<td>å¹¶è¡Œè§£ç ï¼ˆå¦‚ beam searchï¼‰æ—¶å¯å…±äº« prompt çš„ KV cache</td>\n</tr>\n<tr>\n<td><strong>Copy-on-Write</strong></td>\n<td>å†™æ—¶å¤åˆ¶æœºåˆ¶ï¼Œä»…åœ¨éœ€è¦ä¿®æ”¹æ—¶æ‰å¤åˆ¶ block</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"å†…å­˜ä½¿ç”¨å¯¹æ¯”\">å†…å­˜ä½¿ç”¨å¯¹æ¯”</h4>\n<pre><code>ä¼ ç»Ÿæ–¹å¼ï¼š\n- åºåˆ—é•¿åº¦ 1000ï¼Œæœ€å¤§æ”¯æŒ 4096\n- å†…å­˜å ç”¨ï¼š4096 * hidden_size\n- æµªè´¹ç‡ï¼šçº¦ 75%\n\nPageAttentionï¼š\n- åºåˆ—é•¿åº¦ 1000ï¼Œblock_size=16\n- éœ€è¦ blockï¼š1000/16 = 63 ä¸ª\n- å®é™…åˆ†é…ï¼š63 * 16 = 1008 tokens\n- æµªè´¹ç‡ï¼šä»… 0.8%\n</code></pre>\n<h4 id=\"ä»£ç å®ç°\">ä»£ç å®ç°</h4>\n<pre><code class=\"language-python\"># nanovllm/layers/attention.py\n# Block Table æ˜ å°„\nblock_table = context.block_tables  # æ˜ å°„è¡¨\n\n# Slot Mapping - å°† token æ˜ å°„åˆ° block ä¸­çš„å…·ä½“ä½ç½®\n# slot_mapping æ ¼å¼ï¼š[block_idx, offset_in_block]\ncontext.slot_mapping\n\n# åˆ†é¡µå­˜å‚¨ KV Cache\ntorch_npu._npu_reshape_and_cache(\n    k, v,\n    k_cache.view(num_blocks, block_size, num_kv_heads, head_dim),\n    v_cache.view(num_blocks, block_size, num_kv_heads, head_dim),\n    slot_mapping.int()\n)\n</code></pre>\n<h4 id=\"ä¼˜åŠ¿\">ä¼˜åŠ¿</h4>\n<ol>\n<li><strong>å†…å­˜æ•ˆç‡</strong>ï¼šæŒ‰éœ€åˆ†é…ï¼Œæ— å†…éƒ¨ç¢ç‰‡</li>\n<li><strong>åŠ¨æ€æ‰©å±•</strong>ï¼šåºåˆ—å¢é•¿æ—¶åªéœ€åˆ†é…æ–° block</li>\n<li><strong>å†…å­˜å…±äº«</strong>ï¼šå¤šä¸ªåºåˆ—å¯å…±äº«ç›¸åŒçš„ prompt KV Cache</li>\n<li><strong>é«˜ååé‡</strong>ï¼šæ”¯æŒæ›´å¤§çš„ batch size</li>\n</ol>\n<h4 id=\"è¯¦ç»†å¯¹æ¯”\">è¯¦ç»†å¯¹æ¯”</h4>\n<p>ğŸ“„ <strong>è¯¦ç»†æŠ€æœ¯æ–‡æ¡£</strong>ï¼š<a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/pageattention_comparison.md\" rel=\"noopener nofollow\" target=\"_blank\">HuggingFace Transformers æ—©æœŸå®ç°ä¸ PageAttention å¯¹æ¯”</a></p>\n<p>åŒ…å«ï¼š</p>\n<ul>\n<li>æ—©æœŸ Transformers ä»£ç å®ç°åˆ†æ</li>\n<li>å†…å­˜æµªè´¹çš„é‡åŒ–å¯¹æ¯”ï¼ˆ75% vs 6.25%ï¼‰</li>\n<li>ä¸åŒ batch size å’Œåºåˆ—é•¿åº¦çš„è¯¦ç»†å¯¹æ¯”è¡¨</li>\n<li>vLLM è®ºæ–‡æ•°æ®æ¥æºè¯´æ˜</li>\n<li>å®é™…ä»£ç ç¤ºä¾‹å’Œåœºæ™¯åˆ†æ</li>\n</ul>\n<hr />\n<h3 id=\"flashattention\">FlashAttention</h3>\n<p><strong>FlashAttention</strong> æ˜¯æ–¯å¦ç¦å¤§å­¦æå‡ºçš„ <strong>IO æ„ŸçŸ¥</strong> æ³¨æ„åŠ›ä¼˜åŒ–ç®—æ³•ï¼Œé€šè¿‡åˆ†å—è®¡ç®—å’Œå‡å°‘ HBMï¼ˆé«˜å¸¦å®½å†…å­˜ï¼‰è®¿é—®æ¥æå‡æ€§èƒ½ã€‚</p>\n<h4 id=\"æ ¸å¿ƒé—®é¢˜\">æ ¸å¿ƒé—®é¢˜</h4>\n<p>æ ‡å‡† Attention å®ç°éœ€è¦å­˜å‚¨ä¸­é—´ç»“æœï¼ˆæ³¨æ„åŠ›çŸ©é˜µï¼‰åˆ° HBMï¼Œå¯¼è‡´ï¼š</p>\n<ul>\n<li><strong>å†…å­˜ç“¶é¢ˆ</strong>ï¼šHBM å¸¦å®½è¿œä½äºè®¡ç®—é€Ÿåº¦</li>\n<li><strong>O(NÂ²) å†…å­˜</strong>ï¼šåºåˆ—é•¿åº¦çš„å¹³æ–¹çº§å†…å­˜å¢é•¿</li>\n<li><strong>å¤šæ¬¡æ•°æ®æ¬è¿</strong>ï¼šQã€Kã€V éœ€è¦å¤šæ¬¡è¯»å†™ HBM</li>\n</ul>\n<h4 id=\"æ ¸å¿ƒåˆ›æ–°\">æ ¸å¿ƒåˆ›æ–°</h4>\n<table>\n<thead>\n<tr>\n<th>æŠ€æœ¯</th>\n<th>åŸç†</th>\n<th>æ•ˆæœ</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Tilingï¼ˆåˆ†å—ï¼‰</strong></td>\n<td>å°† Qã€Kã€V åˆ†å—åŠ è½½åˆ°é«˜é€Ÿ SRAM</td>\n<td>å‡å°‘ HBM è®¿é—®æ¬¡æ•°</td>\n</tr>\n<tr>\n<td><strong>Online Softmax</strong></td>\n<td>æµå¼è®¡ç®— softmaxï¼Œæ— éœ€å®Œæ•´æ³¨æ„åŠ›çŸ©é˜µ</td>\n<td>å†…å­˜é™è‡³ O(N)</td>\n</tr>\n<tr>\n<td><strong>Recomputation</strong></td>\n<td>åå‘ä¼ æ’­æ—¶é‡æ–°è®¡ç®—ä¸­é—´å€¼</td>\n<td>ç‰ºç‰²è®¡ç®—æ¢å†…å­˜</td>\n</tr>\n<tr>\n<td><strong>Kernel Fusion</strong></td>\n<td>å¤šä¸ªæ“ä½œèåˆä¸ºå•ä¸ª CUDA kernel</td>\n<td>å‡å°‘ kernel å¯åŠ¨å¼€é”€</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"å†…å­˜å±‚æ¬¡ç»“æ„å¯¹æ¯”\">å†…å­˜å±‚æ¬¡ç»“æ„å¯¹æ¯”</h4>\n<pre><code>GPU å†…å­˜å±‚æ¬¡ï¼š\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  HBM (High Bandwidth Memory)        â”‚  â† 1.5 TB/sï¼Œå®¹é‡å¤§ä½†é€Ÿåº¦æ…¢\nâ”‚  - å®¹é‡ï¼š40-80 GB                   â”‚  â† æ ‡å‡† Attention åœ¨æ­¤é¢‘ç¹è¯»å†™\nâ”‚  - å»¶è¿Ÿï¼šé«˜                         â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  SRAM (Static RAM / Shared Memory)  â”‚  â† 19 TB/sï¼Œå®¹é‡å°ä½†é€Ÿåº¦å¿«\nâ”‚  - å®¹é‡ï¼š~100 KB per SM             â”‚  â† FlashAttention ä¸»è¦åœ¨æ­¤è®¡ç®—\nâ”‚  - å»¶è¿Ÿï¼šæä½                       â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n</code></pre>\n<h4 id=\"è®¡ç®—æµç¨‹å¯¹æ¯”\">è®¡ç®—æµç¨‹å¯¹æ¯”</h4>\n<p><strong>æ ‡å‡† Attentionï¼š</strong></p>\n<pre><code>1. ä» HBM åŠ è½½ Q, K, V\n2. è®¡ç®— S = QK^T â†’ å†™å…¥ HBM\n3. è®¡ç®— P = softmax(S) â†’ å†™å…¥ HBM  \n4. è®¡ç®— O = PV â†’ å†™å…¥ HBM\nâŒ å¤šæ¬¡ HBM è¯»å†™ï¼Œå†…å­˜å ç”¨ O(NÂ²)\n</code></pre>\n<p><strong>FlashAttentionï¼š</strong></p>\n<pre><code>1. åˆ†å—åŠ è½½ Qáµ¢, Kâ±¼, Vâ±¼ åˆ° SRAM\n2. åœ¨ SRAM ä¸­è®¡ç®— softmax\n3. ç´¯åŠ ç»“æœåˆ°è¾“å‡º\n4. ä¸¢å¼ƒä¸­é—´ç»“æœï¼Œé‡å¤ç›´åˆ°å®Œæˆ\nâœ… ä»…éœ€ O(N) å†…å­˜ï¼Œå¤§å¹…å‡å°‘ HBM è®¿é—®\n</code></pre>\n<h4 id=\"ä»£ç å®ç°-1\">ä»£ç å®ç°</h4>\n<pre><code class=\"language-python\"># nanovllm/layers/attention_ori.py\nfrom flash_attn import (\n    flash_attn_varlen_func,      # Prefill é˜¶æ®µ\n    flash_attn_with_kvcache      # Decode é˜¶æ®µ\n)\n\n# Prefill - å¤„ç†å˜é•¿åºåˆ—ï¼Œæ”¯æŒ PageAttention\nflash_attn_varlen_func(\n    q, k, v,\n    max_seqlen_q=max_seqlen_q,\n    cu_seqlens_q=cu_seqlens_q,    # ç´¯è®¡é•¿åº¦æ”¯æŒå˜é•¿\n    causal=True,                  # å› æœæ©ç \n    block_table=block_table       # PageAttention block table\n)\n\n# Decode - å• token æ¨ç†ï¼Œå¤ç”¨åˆ†é¡µ KV Cache\nflash_attn_with_kvcache(\n    q.unsqueeze(1),               # [batch, 1, num_heads, head_dim]\n    k_cache, v_cache,             # åˆ†é¡µ KV ç¼“å­˜\n    cache_seqlens=context_lens,   # å®é™…åºåˆ—é•¿åº¦\n    block_table=block_table       # block table æ˜ å°„\n)\n</code></pre>\n<h4 id=\"æ€§èƒ½æ”¶ç›Š\">æ€§èƒ½æ”¶ç›Š</h4>\n<ul>\n<li><strong>å†…å­˜æ•ˆç‡</strong>ï¼šä» O(NÂ²) é™è‡³ O(N)</li>\n<li><strong>è®¡ç®—é€Ÿåº¦</strong>ï¼šA100 ä¸Šå¯è¾¾ <strong>2-4 å€</strong>åŠ é€Ÿ</li>\n<li><strong>åºåˆ—é•¿åº¦</strong>ï¼šæ”¯æŒæ›´é•¿çš„ä¸Šä¸‹æ–‡ï¼ˆå¦‚ 100K+ tokensï¼‰</li>\n</ul>\n<hr />\n<h3 id=\"ä¸‰ç§-attention-å®ç°å¯¹æ¯”\">ä¸‰ç§ Attention å®ç°å¯¹æ¯”</h3>\n<p>æœ¬é¡¹ç›®åŒ…å«ä¸‰ç§ Attention å®ç°ï¼Œé€‚ç”¨äºä¸åŒåœºæ™¯ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>ç‰¹æ€§</th>\n<th>attention_ori.py</th>\n<th>attention.py</th>\n<th>attention_torch_native.py</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>åº•å±‚å®ç°</strong></td>\n<td>Flash Attention åº“</td>\n<td>NPU åŸç”Ÿç®—å­</td>\n<td>PyTorch åŸç”Ÿ</td>\n</tr>\n<tr>\n<td><strong>é€‚ç”¨å¹³å°</strong></td>\n<td>CUDA GPU</td>\n<td>åä¸ºæ˜‡è…¾ NPU</td>\n<td>é€šç”¨ï¼ˆCPU/GPUï¼‰</td>\n</tr>\n<tr>\n<td><strong>æ€§èƒ½</strong></td>\n<td>â­â­â­â­â­</td>\n<td>â­â­â­â­â­</td>\n<td>â­â­</td>\n</tr>\n<tr>\n<td><strong>å¯è¯»æ€§</strong></td>\n<td>â­â­</td>\n<td>â­â­</td>\n<td>â­â­â­â­â­</td>\n</tr>\n<tr>\n<td><strong>ç”¨é€”</strong></td>\n<td>ç”Ÿäº§ç¯å¢ƒï¼ˆGPUï¼‰</td>\n<td>ç”Ÿäº§ç¯å¢ƒï¼ˆNPUï¼‰</td>\n<td>å­¦ä¹ è°ƒè¯•</td>\n</tr>\n</tbody>\n</table>\n<p><strong>é€‰æ‹©å»ºè®®ï¼š</strong></p>\n<ul>\n<li><strong>ç”Ÿäº§ç¯å¢ƒï¼ˆGPUï¼‰</strong>ï¼šä½¿ç”¨ <code>attention_ori.py</code>ï¼ˆFlash Attentionï¼‰</li>\n<li><strong>ç”Ÿäº§ç¯å¢ƒï¼ˆæ˜‡è…¾ NPUï¼‰</strong>ï¼šä½¿ç”¨ <code>attention.py</code>ï¼ˆNPU ç®—å­ï¼‰</li>\n<li><strong>å­¦ä¹ /è°ƒè¯•</strong>ï¼šä½¿ç”¨ <code>attention_torch_native.py</code>ï¼ˆæ˜“äºç†è§£ï¼‰</li>\n</ul>\n<h2 id=\"æ–‡æ¡£ç´¢å¼•\">æ–‡æ¡£ç´¢å¼•</h2>\n<p>æœ¬ç›®å½•åŒ…å«é¡¹ç›®å„æ¨¡å—çš„è¯¦ç»†æµç¨‹å›¾æ–‡æ¡£ï¼Œä½¿ç”¨ Mermaid è¯­æ³•ç»˜åˆ¶ã€‚</p>\n<h3 id=\"engine-æ¨¡å—æµç¨‹å›¾\">Engine æ¨¡å—æµç¨‹å›¾</h3>\n<table>\n<thead>\n<tr>\n<th>æ–‡æ¡£</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/engine/sequence_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/engine/sequence_flowchart.md</a></td>\n<td>Sequence åºåˆ—çŠ¶æ€ç®¡ç†æµç¨‹</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/engine/block_manager_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/engine/block_manager_flowchart.md</a></td>\n<td>BlockManager KVç¼“å­˜å—ç®¡ç†æµç¨‹</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/engine/scheduler_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/engine/scheduler_flowchart.md</a></td>\n<td>Scheduler è°ƒåº¦å™¨æµç¨‹</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/engine/model_runner_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/engine/model_runner_flowchart.md</a></td>\n<td>ModelRunner æ¨¡å‹è¿è¡Œå™¨æµç¨‹</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/engine/llm_engine_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/engine/llm_engine_flowchart.md</a></td>\n<td>LLMEngine ä¸»å¼•æ“æµç¨‹</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"layers-æ¨¡å—æµç¨‹å›¾\">Layers æ¨¡å—æµç¨‹å›¾</h3>\n<table>\n<thead>\n<tr>\n<th>æ–‡æ¡£</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/linear_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/layers/linear_flowchart.md</a></td>\n<td>çº¿æ€§å±‚ä¸å¼ é‡å¹¶è¡Œç­–ç•¥</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/attention_torch_native_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/layers/attention_torch_native_flowchart.md</a></td>\n<td>PyTorchåŸç”ŸAttentionå®ç°</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/attention_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/layers/attention_flowchart.md</a></td>\n<td>NPUä¸“ç”¨Attentionå®ç°</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/attention_ori_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/layers/attention_ori_flowchart.md</a></td>\n<td>Flash Attentionä¼˜åŒ–å®ç°</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/sampler_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/layers/sampler_flowchart.md</a></td>\n<td>é‡‡æ ·å™¨ï¼ˆæ¸©åº¦é‡‡æ ·ï¼‰</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/rotary_embedding_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/layers/rotary_embedding_flowchart.md</a></td>\n<td>RoPEä½ç½®ç¼–ç </td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/layernorm_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/layers/layernorm_flowchart.md</a></td>\n<td>RMSNormå½’ä¸€åŒ–å±‚</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/embed_head_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/layers/embed_head_flowchart.md</a></td>\n<td>è¯åµŒå…¥ä¸LM Head</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/layers/activation_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/layers/activation_flowchart.md</a></td>\n<td>SwiGLUæ¿€æ´»å‡½æ•°</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"models-æ¨¡å—æµç¨‹å›¾\">Models æ¨¡å—æµç¨‹å›¾</h3>\n<table>\n<thead>\n<tr>\n<th>æ–‡æ¡£</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/models/llama_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/models/llama_flowchart.md</a></td>\n<td>Llamaæ¨¡å‹æ¶æ„</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/models/qwen3_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/models/qwen3_flowchart.md</a></td>\n<td>Qwen3æ¨¡å‹æ¶æ„</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/models/qwen3_vl_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/models/qwen3_vl_flowchart.md</a></td>\n<td>Qwen3-VLå¤šæ¨¡æ€æ¨¡å‹æ¶æ„</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/models/qwen3_moe_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/models/qwen3_moe_flowchart.md</a></td>\n<td>Qwen3-MoEç¨€ç–ä¸“å®¶æ¨¡å‹æ¶æ„</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/models/mini_cpm4_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/models/mini_cpm4_flowchart.md</a></td>\n<td>MiniCPM4æ¨¡å‹æ¶æ„</td>\n</tr>\n<tr>\n<td><a href=\"https://github.com/linzm1007/nano-vllm-ascend/blob/main/docs/models/models_map_flowchart.md\" rel=\"noopener nofollow\" target=\"_blank\">docs/models/models_map_flowchart.md</a></td>\n<td>æ¨¡å‹æ³¨å†Œæ˜ å°„å…³ç³»</td>\n</tr>\n</tbody>\n</table>\n<hr />\n<h2 id=\"benchæ•°æ®\">benchæ•°æ®</h2>\n<p>ä»…ä¾›å‚è€ƒï¼Œç¡¬è½¯æ¡ä»¶ä¸åŒï¼Œè·‘å‡ºçš„æ•°æ®ä¹Ÿä¼šæœ‰å·®å¼‚</p>\n<h4 id=\"ä¸åŒæ¨¡å‹å¯¹æ¯”\">ä¸åŒæ¨¡å‹å¯¹æ¯”</h4>\n<table>\n<thead>\n<tr>\n<th>model</th>\n<th>Output Tokens</th>\n<th>Time (s)</th>\n<th>Throughput (tokens/s)</th>\n<th>TP</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Qwen3-0.6B</td>\n<td>143,770</td>\n<td>36.82</td>\n<td>3904.20</td>\n<td>1</td>\n</tr>\n<tr>\n<td>Qwen2-0.5B</td>\n<td>143,770</td>\n<td>20.71</td>\n<td>6940.84</td>\n<td>1</td>\n</tr>\n<tr>\n<td>Qwen2.5-0.5B-Instruct</td>\n<td>143,770</td>\n<td>19.82</td>\n<td>7252.67</td>\n<td>1</td>\n</tr>\n<tr>\n<td>Llama-3.2-1B-Instruct</td>\n<td>143,770</td>\n<td>25.45</td>\n<td>5648.50</td>\n<td>1</td>\n</tr>\n<tr>\n<td>Qwen3-32B</td>\n<td>143,770</td>\n<td>206.69</td>\n<td>695.59</td>\n<td>2</td>\n</tr>\n<tr>\n<td>Qwen3-32B</td>\n<td>143,770</td>\n<td>119.86</td>\n<td>1199.50</td>\n<td>4</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"å…¶ä»–æ¡†æ¶å¯¹æ¯”2025-12-30\">å…¶ä»–æ¡†æ¶å¯¹æ¯”(2025-12-30)</h4>\n<p>vLLM Nano-vLLM æ•°æ®æ¥æº <a href=\"https://github.com/GeeeekExplorer/nano-vllm\" rel=\"noopener nofollow\" target=\"_blank\">https://github.com/GeeeekExplorer/nano-vllm</a></p>\n<table>\n<thead>\n<tr>\n<th>Inference Engine</th>\n<th>Output Tokens</th>\n<th>Time (s)</th>\n<th>Throughput (tokens/s)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>vLLM</td>\n<td>133,966</td>\n<td>98.37</td>\n<td>1361.84</td>\n</tr>\n<tr>\n<td>Nano-vLLM</td>\n<td>133,966</td>\n<td>93.41</td>\n<td>1434.13</td>\n</tr>\n<tr>\n<td>Nano-vLLM-Ascend python torchåŸç”Ÿå®ç°</td>\n<td>4805</td>\n<td>257.49</td>\n<td>18.66</td>\n</tr>\n<tr>\n<td>Nano-vLLM-Ascend èåˆç®—å­+å›¾ç¼–è¯‘bs=256</td>\n<td>133,966</td>\n<td>33.88</td>\n<td>3954.20</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"å›¾æ¨¡å¼ä¸åŒbså¯¹æ¯”2025-12-30\">å›¾æ¨¡å¼ä¸åŒbså¯¹æ¯”(2025-12-30)</h4>\n<table>\n<thead>\n<tr>\n<th>Batch Size</th>\n<th>Output Tokens</th>\n<th>Time (s)</th>\n<th>Throughput (tokens/s)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>bs=16</td>\n<td>133,966</td>\n<td>107.23</td>\n<td>1249.37</td>\n</tr>\n<tr>\n<td>bs=32</td>\n<td>133,966</td>\n<td>75.89</td>\n<td>1765.35</td>\n</tr>\n<tr>\n<td>bs=48</td>\n<td>133,966</td>\n<td>64.84</td>\n<td>2066.22</td>\n</tr>\n<tr>\n<td>bs=64</td>\n<td>133,966</td>\n<td>54.06</td>\n<td>2478.31</td>\n</tr>\n<tr>\n<td>bs=128</td>\n<td>133,966</td>\n<td>43.08</td>\n<td>3109.56</td>\n</tr>\n<tr>\n<td>bs=256</td>\n<td>133,966</td>\n<td>33.88</td>\n<td>3954.20</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"å•ç®—å­paddingå’Œnon-paddingå¯¹æ¯”2025-12-30\">å•ç®—å­Paddingå’ŒNon-paddingå¯¹æ¯”(2025-12-30)</h4>\n<p>bs=256</p>\n<table>\n<thead>\n<tr>\n<th>Prepare Strategy</th>\n<th>Output Tokens</th>\n<th>Time (s)</th>\n<th>Throughput (tokens/s)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Padding</td>\n<td>133,966</td>\n<td>158.46</td>\n<td>845.41</td>\n</tr>\n<tr>\n<td>Non-padding</td>\n<td>133,966</td>\n<td>152.14</td>\n<td>880.55</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"ç¯å¢ƒæ­å»ºå‚è€ƒvllm-ascend\">ç¯å¢ƒæ­å»ºï¼ˆå‚è€ƒvllm-ascendï¼‰</h2>\n<p><a href=\"https://docs.vllm.ai/projects/vllm-ascend-cn/zh-cn/latest/quick_start.html\" rel=\"noopener nofollow\" target=\"_blank\">https://docs.vllm.ai/projects/vllm-ascend-cn/zh-cn/latest/quick_start.html</a></p>\n<p>ubuntu</p>\n<pre><code># Update DEVICE according to your device (/dev/davinci[0-7])\nexport DEVICE=/dev/davinci0\n# Update the vllm-ascend image\n# Atlas A2:\n# export IMAGE=quay.io/ascend/vllm-ascend:v0.14.0rc1\n# Atlas A3:\n# export IMAGE=quay.io/ascend/vllm-ascend:v0.14.0rc1-a3\nexport IMAGE=quay.io/ascend/vllm-ascend:v0.14.0rc1\ndocker run --rm \\\n--name vllm-ascend \\\n--shm-size=1g \\\n--device $DEVICE \\\n--device /dev/davinci_manager \\\n--device /dev/devmm_svm \\\n--device /dev/hisi_hdc \\\n-v /usr/local/dcmi:/usr/local/dcmi \\\n-v /usr/local/bin/npu-smi:/usr/local/bin/npu-smi \\\n-v /usr/local/Ascend/driver/lib64/:/usr/local/Ascend/driver/lib64/ \\\n-v /usr/local/Ascend/driver/version.info:/usr/local/Ascend/driver/version.info \\\n-v /etc/ascend_install.info:/etc/ascend_install.info \\\n-v /root/.cache:/root/.cache \\\n-p 8000:8000 \\\n-it $IMAGE bash\n# Install curl\napt-get update -y &amp;&amp; apt-get install -y curl\n</code></pre>\n<h2 id=\"å®‰è£…ä¾èµ–\">å®‰è£…ä¾èµ–</h2>\n<pre><code class=\"language-bash\">pip install .\n</code></pre>\n<h2 id=\"æ¨¡å‹ä¸‹è½½\">æ¨¡å‹ä¸‹è½½</h2>\n<pre><code class=\"language-bash\">huggingface-cli download --resume-download Qwen/Qwen3-0.6B \\\n  --local-dir ~/huggingface/Qwen3-0.6B/ \\\n  --local-dir-use-symlinks False\n</code></pre>\n<h2 id=\"å¿«é€Ÿå¼€å§‹\">å¿«é€Ÿå¼€å§‹</h2>\n<p>è¯·å‚è§ example.py äº†è§£ç”¨æ³•ã€‚è¯¥ API ä¸ vLLM çš„æ¥å£åŸºæœ¬ä¸€è‡´ï¼Œä»…åœ¨ LLM.generate æ–¹æ³•ä¸Šå­˜åœ¨ä¸€äº›ç»†å¾®å·®å¼‚ï¼š</p>\n<pre><code class=\"language-python\">from nanovllm import LLM, SamplingParams\nllm = LLM(\"/YOUR/MODEL/PATH\", enforce_eager=True, tensor_parallel_size=1)\nsampling_params = SamplingParams(temperature=0.6, max_tokens=256)\nprompts = [\"Hello, Nano-vLLM.\"]\noutputs = llm.generate(prompts, sampling_params)\noutputs[0][\"text\"]\n</code></pre>\n<h2 id=\"exampleè¿è¡Œç»“æœ\">exampleè¿è¡Œç»“æœ</h2>\n<p><img alt=\"result-image\" class=\"lazyload\" /></p>\n<h2 id=\"benchç¯å¢ƒ\">benchç¯å¢ƒ</h2>\n<p>ä»…ä¾›å‚è€ƒ<br />\nascend-dmi -c #æŸ¥çœ‹</p>\n<ul>\n<li>ç¡¬ä»¶ç¯å¢ƒâ€‹ï¼š\n<ul>\n<li>1.æ˜¾å¡:A3 910C</li>\n<li>2.é©±åŠ¨ç‰ˆæœ¬:24.1.rc3.10</li>\n<li>3.å›ºä»¶ç‰ˆæœ¬:7.5.0.109.220</li>\n</ul>\n</li>\n<li>â€‹è½¯ä»¶ç¯å¢ƒâ€‹ï¼š\n<ul>\n<li>1.CANNåŒ… 8.3.RC1</li>\n<li>2.PTAç‰ˆæœ¬ï¼štorch-npu 2.5.1.post2+gitd7a85f8ï¼Œtorch 2.5.1</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"benchmark\">Benchmark</h2>\n<p>See <code>bench.py</code> for benchmark.</p>\n<p><strong>Test Configuration:</strong></p>\n<ul>\n<li>Model: Qwen3-0.6B</li>\n<li>Total Requests: 256 sequences</li>\n<li>Input Length: Randomly sampled between 100â€“1024 tokens</li>\n<li>Output Length: Randomly sampled between 100â€“1024 tokens</li>\n</ul>\n<p><strong>Performance Results:</strong><br />\nNano-vLLM-Ascend å®åœ¨å¤ªæ…¢äº†åªè·‘äº†10æ¡seq</p>\n<table>\n<thead>\n<tr>\n<th>Inference Engine</th>\n<th>Output Tokens</th>\n<th>Time (s)</th>\n<th>Throughput (tokens/s)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>vLLM</td>\n<td>133,966</td>\n<td>98.37</td>\n<td>1361.84</td>\n</tr>\n<tr>\n<td>Nano-vLLM</td>\n<td>133,966</td>\n<td>93.41</td>\n<td>1434.13</td>\n</tr>\n<tr>\n<td>Nano-vLLM-Ascend</td>\n<td>4805</td>\n<td>257.49</td>\n<td>18.66</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"qwen3-06b-layers\">qwen3-0.6B layers</h2>\n<pre><code class=\"language-angular2html\">ModuleList(\n  (0-27): 28 x Qwen3DecoderLayer(\n    (self_attn): Qwen3Attention(\n      (qkv_proj): QKVParallelLinear()\n      (o_proj): RowParallelLinear()\n      (rotary_emb): RotaryEmbedding()\n      (attn): Attention()\n      (q_norm): RMSNorm()\n      (k_norm): RMSNorm()\n    )\n    (mlp): Qwen3MLP(\n      (gate_up_proj): MergedColumnParallelLinear()\n      (down_proj): RowParallelLinear()\n      (act_fn): SiluAndMul()\n    )\n    (input_layernorm): RMSNorm()\n    (post_attention_layernorm): RMSNorm()\n  )\n)\n\n</code></pre>\n\n\n</div>\n<div id=\"MySignature\">\n    è“å¤©å’Œç™½äº‘æ˜¯æ ‡é…ã€‚\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-13 11:38</span>&nbsp;\n<a href=\"https://www.cnblogs.com/linzm14\">linzm14</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">58</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "çº¿ä¸ŠæœåŠ¡é‡å¯åï¼Œä»nacoså–ä¸åˆ°é…ç½®äº†ï¼Œæ€ä¹ˆå›äº‹",
      "link": "https://www.cnblogs.com/grey-wolf/p/19611093",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/grey-wolf/p/19611093\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-02-13 10:19\">\n    <span>çº¿ä¸ŠæœåŠ¡é‡å¯åï¼Œä»nacoså–ä¸åˆ°é…ç½®äº†ï¼Œæ€ä¹ˆå›äº‹</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"èƒŒæ™¯\">èƒŒæ™¯</h1>\n<p>å‰ä¸€é˜µï¼Œçº¿ä¸ŠæŸä¸ªæœåŠ¡å‡çº§ï¼Œå…¸å‹çš„spring bootåº”ç”¨ï¼Œå¼•å…¥äº†spring cloudï¼Œä¸»è¦æ˜¯ä¸ºäº†ä½¿ç”¨nacosæ¥ç»Ÿä¸€ç®¡ç†é…ç½®ã€‚</p>\n<p>å…¸å‹çš„bootstrap.ymlé…ç½®å¦‚ä¸‹ï¼ŒåŒ…å«äº†ç”¨æˆ·åå¯†ç ï¼š</p>\n<p><img alt=\"image-20260213093118522\" src=\"https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260213093118522.png\" /></p>\n<p>æœåŠ¡å¯åŠ¨æ—¶ï¼Œå°±ä¼šå»nacosè¯»å–é…ç½®ï¼Œè¯»å–é…ç½®å½“ç„¶è¦å…ˆç™»å½•ï¼Œè¿™é‡Œé…ç½®çš„ç”¨æˆ·åå¯†ç å°±æ˜¯ç™»å½•ç”¨çš„ã€‚</p>\n<p>æˆ‘ä»¬é‡åˆ°çš„é—®é¢˜æ˜¯ï¼Œçº¿ä¸Šé‚£ä¸ªæœåŠ¡ï¼Œä¸æ˜¯ç¬¬ä¸€æ¬¡ä¸Šçº¿ï¼Œä¸€ç›´è·‘å¾—å¥½å¥½çš„ï¼Œæœ¬æ¬¡æ›´æ–°ä¸»è¦æ˜¯æ›´æ–°äº†fat jarï¼Œæ”¹äº†ç‚¹ä¸šåŠ¡é€»è¾‘ï¼Œåƒbootstrap.ymlè¿™äº›æ²¡ä»»ä½•æ”¹åŠ¨ã€‚ç»“æœè¿ç»´åŒäº‹æ›¿æ¢äº†jaråŒ…åä¸€é‡å¯ï¼Œè¯´å¯åŠ¨ä¸äº†ï¼Œè¯´ä½ è¿™ä¸ªåŒ…æ˜¯ä¸æ˜¯æœ‰é—®é¢˜å•Šã€‚</p>\n<h1 id=\"å®šä½è¿‡ç¨‹\">å®šä½è¿‡ç¨‹</h1>\n<h2 id=\"æŠ“åŒ…\">æŠ“åŒ…</h2>\n<p>è¿‡å»è¿ç»´é‚£è¾¹çœ‹äº†ä¸‹ï¼Œå‘ç°æŠ¥é”™æ˜¯è¯´ä»€ä¹ˆæ•°æ®åº“è¿ä¸ä¸Šï¼Œipä¸€çœ‹ï¼Œæ˜¯å¼€å‘ç¯å¢ƒçš„æ•°æ®åº“ipï¼Œæˆ‘å°±æ„Ÿè§‰æ˜¯ä¸æ˜¯æ²¡å–åˆ°nacosé‡Œçš„é…ç½®ï¼Œæ‰€ä»¥ç”¨äº†é»˜è®¤çš„å¼€å‘ç¯å¢ƒé…ç½®äº†ï¼ˆfat jarä¸­æœ‰é»˜è®¤çš„å¼€å‘ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼‰ã€‚</p>\n<p>æˆ‘å°±è¯´è¿™å¾—æŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œnacosçš„ç›‘å¬ç«¯å£æ˜¯8848ï¼Œä¸»è¦ç”¨äºç™»å½•ï¼Œè·å–tokenï¼›è¿˜æœ‰9849ï¼Œç”¨äºæœåŠ¡æ³¨å†Œã€é…ç½®æ‹‰å–ç­‰ã€‚</p>\n<pre><code class=\"language-shell\">tcpdump -i any tcp port 8848 or tcp port 9848 -w nacos.pcap\n</code></pre>\n<p>æŠŠåŒ…æŠ“ä¸‹æ¥ä¸€çœ‹ï¼Œå‘ç°ç¡®å®æ²¡æ‹‰å–åˆ°é…ç½®ï¼Œä½†æ˜¯ï¼ŒåŸå› æ˜¯ç™»å½•å°±å¤±è´¥äº†ã€‚</p>\n<p>æŠ¥æ–‡å¦‚ä¸‹ï¼š</p>\n<p><img alt=\"image-20260213093813785\" src=\"https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260213093813785.png\" /></p>\n<h2 id=\"ç½‘é¡µç«¯ç™»å½•\">ç½‘é¡µç«¯ç™»å½•</h2>\n<p>éš¾é“æ˜¯å¯†ç é”™äº†å—ï¼Œç„¶ååŒæ ·çš„ç”¨æˆ·å¯†ç ï¼Œåœ¨nacosç®¡ç†ç³»ç»Ÿé‚£é‡Œç™»å½•ï¼Œå‘ç°æ˜¯æ­£å¸¸çš„ã€‚è¿™ä¸ªç¡®å®æ˜¯å¾ˆå¥‡æ€ªï¼ŒF12çœ‹äº†ä¸‹ï¼Œçœ‹äº†æ¥å£ä¹Ÿæ˜¯ä¸Šé¢é‚£ä¸ªæ¥å£ã€‚</p>\n<p><img alt=\"image-20260213094323596\" src=\"https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260213094323596.png\" /></p>\n<p>å”¯ä¸€ä¸åŒçš„ä¹Ÿå°±æ˜¯å‚æ•°æºå¸¦æ–¹å¼æœ‰ä¸€ç‚¹å·®å¼‚ï¼š</p>\n<p><img alt=\"image-20260213094353557\" src=\"https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260213094353557.png\" /></p>\n<p>è¿™ä¸ªç½‘é¡µç«¯ï¼Œæ˜¯ç”¨æˆ·åã€å¯†ç éƒ½åœ¨formè¡¨å•çš„http bodyé‡Œã€‚è€Œapié‚£è¾¹ï¼Œæ˜¯usernameåœ¨urlé‡Œï¼Œå¯†ç åœ¨bodyé‡Œã€‚</p>\n<h2 id=\"æ‹‰äºº\">æ‹‰äºº</h2>\n<p>ç„¶åæˆ‘ä»¬å°±ç¡®è®¤æ˜¯nacos æœåŠ¡ç«¯æ„Ÿè§‰æœ‰ç‚¹é—®é¢˜ã€‚å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿæ‰¾äº†å…¶ä»–ç±»ä¼¼çš„æœåŠ¡Aï¼ŒæŠŠé‚£ä¸ªæœåŠ¡Aç”¨çš„nacosç”¨æˆ·åã€å¯†ç æ‹¿è¿‡æ¥ï¼Œé…ç½®åˆ°æœ¬æœåŠ¡é‡Œï¼Œé‡å¯ï¼Œå‘ç°ç«Ÿç„¶ä¹ŸæŠ¥åŒæ ·çš„é”™è¯¯ã€‚</p>\n<p>ç„¶åå°±æ„Ÿè§‰æ˜¯nacosæœåŠ¡ç«¯å‡ºäº†é—®é¢˜ï¼Œæ‰¾åˆ°å¯¹åº”è´Ÿè´£çš„åŒäº‹ï¼Œä¸€èµ·æ¥çœ‹ã€‚æˆ‘ä»¬è¿˜æµ‹äº†ä¸‹ï¼ŒæŠŠæœåŠ¡Aè‡ªå·±é‡å¯äº†ä¸‹ï¼Œå‘ç°é‡å¯ä¹Ÿå¯åŠ¨ä¸èµ·æ¥äº†ï¼ŒåŒæ ·æ˜¯æç¤º403ï¼Œç”¨æˆ·æ‰¾ä¸åˆ°ã€‚</p>\n<p>æ¥ä¸‹æ¥ï¼Œç»§ç»­æµ‹è¯•ï¼Œå½“æ—¶æ˜¯æ€€ç–‘æ˜¯ä¸æ˜¯å¯†ç æœ‰ç‰¹æ®Šå­—ç¬¦å¯¼è‡´çš„ï¼Œç„¶ånacosè´Ÿè´£äººï¼ŒæŠŠæˆ‘ä»¬çš„ç”¨æˆ·çš„å¯†ç é‡ç½®äº†ä¸‹ï¼Œç„¶åæˆ‘ä»¬é‡è¯•ï¼Œå‘ç°å¯ä»¥äº†ã€‚</p>\n<p>æœ€ç»ˆçš„è§£å†³ï¼Œå°±æ˜¯é ï¼š</p>\n<p>æŠŠç”¨æˆ·çš„å¯†ç é‡ç½®ä¸€ä¸‹ï¼Œä¹Ÿå°±æ˜¯æ”¹ä¸€ä¸‹å¯†ç å°±å¥½äº†ï¼ˆä½†ä¸æ˜¯ç‰¹æ®Šå­—ç¬¦çš„é—®é¢˜ï¼Œæˆ‘ä»¬è¯•ç€æ”¹æˆäº†æœ‰ç‰¹æ®Šå­—ç¬¦çš„å¯†ç ï¼Œå‘ç°è¿˜æ˜¯å¯ä»¥æˆåŠŸå¯åŠ¨çš„ï¼‰ã€‚</p>\n<p>è¿™ä¸ªäº‹å½“æ—¶ä¹Ÿå°±äº†äº†ï¼Œæ²¡ç®¡äº†ã€‚</p>\n<h1 id=\"ç»§ç»­æ¢ç´¢\">ç»§ç»­æ¢ç´¢</h1>\n<h2 id=\"ç™»å½•æ¥å£\">ç™»å½•æ¥å£</h2>\n<p>ä»Šå¤©ç©ºäº†åï¼Œæ„Ÿè§‰è¿™ä¸ªäº‹æƒ…è¿˜æ˜¯æœ‰ç‚¹å¤æ€ªï¼Œä¸ºä»€ä¹ˆå¯†ç é‡ç½®åå°±å¥½äº†ï¼Œå½“æ—¶æˆ‘å°±æ€€ç–‘ï¼šnacosæœåŠ¡ç«¯å†…éƒ¨ä¼°è®¡æœ‰ç¼“å­˜ï¼Œå¯èƒ½æ˜¯ç¼“å­˜å‡ºé—®é¢˜äº†ï¼Œç„¶åé‡ç½®å¯†ç è¿™ä¸ªåŠ¨ä½œï¼Œå°±å¯¼è‡´ç¼“å­˜å˜å¾—æ­£å¸¸äº†ã€‚</p>\n<p>ç½‘ä¸Šæ²¡æ‰¾åˆ°ç‰¹åˆ«åŒ¹é…æˆ‘è¿™ä¸ªæ¡ˆä¾‹çš„ï¼Œç¿»äº†åŠå¤©ï¼Œçœ‹åˆ°æœ‰nacosæºç è§£æçš„ï¼Œäºæ˜¯æˆ‘å°±æƒ³ç€ä»£ç æ‹‰ä¸‹æ¥çœ‹ä¸€ä¸‹ç®—äº†ã€‚</p>\n<p>çº¿ä¸Šçš„nacosç‰ˆæœ¬ä¸ç¡®å®šï¼Œä½†åº”è¯¥æ˜¯2.2.2ï¼Œå› ä¸ºæˆ‘çœ‹äº†ä¸‹å¼€å‘ç¯å¢ƒå°±æ˜¯è¿™ä¸ªç‰ˆæœ¬ã€‚</p>\n<p>æ‰¾äº†å¯¹åº”çš„æºç ï¼š</p>\n<p><a href=\"https://github.com/alibaba/nacos/tree/2.2.2\" rel=\"noopener nofollow\" target=\"_blank\">https://github.com/alibaba/nacos/tree/2.2.2</a></p>\n<p><a href=\"https://github.com/alibaba/nacos/releases/tag/2.2.0\" rel=\"noopener nofollow\" target=\"_blank\">https://github.com/alibaba/nacos/releases/tag/2.2.0</a></p>\n<p>ç›´æ¥ä¸‹äº†ä¸ªzipåŒ…ï¼Œideaé‡Œæ‰“å¼€ã€‚</p>\n<p>å…¨å±€æœç´¢login\"ï¼Œå‘ç°å¦‚ä¸‹ä»£ç ï¼š</p>\n<p>com.alibaba.nacos.plugin.auth.impl.controller.UserController#login</p>\n<p><img alt=\"image-20260213095720124\" src=\"https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260213095720124.png\" /></p>\n<p><img alt=\"image-20260213095743794\" src=\"https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260213095743794.png\" /></p>\n<p>ç„¶åï¼Œè¿™é‡Œæœ‰ä¸ªæ ¹æ®ç”¨æˆ·åï¼ŒæŸ¥æ‰¾ç”¨æˆ·è¯¦ç»†ä¿¡æ¯çš„ï¼š</p>\n<p><img alt=\"image-20260213095803120\" src=\"https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260213095803120.png\" /></p>\n<p>ä¸‹é¢è¿™é‡Œï¼Œå…ˆæ˜¯å»ä¸€ä¸ªç¼“å­˜mapé‡ŒæŸ¥è¯¢ï¼Œå¦‚æœæ²¡å¼€å¯ä¸€ä¸ªcacheEnabledçš„å¼€å…³ï¼Œåˆ™ä¼šç»§ç»­å»æŸ¥æ•°æ®åº“ï¼Œä»¥æ•°æ®åº“çš„ä¸ºå‡†ï¼š</p>\n<pre><code class=\"language-java\">private Map&lt;String, User&gt; userMap = new ConcurrentHashMap&lt;&gt;();\n</code></pre>\n<p><img alt=\"image-20260213095851520\" src=\"https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260213095851520.png\" /></p>\n<p>æˆ‘çœ‹äº†ä¸‹ï¼Œæˆ‘ä»¬æœ¬åœ°å¼€å‘ç¯å¢ƒçš„å¼€å…³ï¼Œåæ­£æ˜¯é»˜è®¤æ‰“å¼€çš„ï¼Œæˆ‘ä¼°è®¡ï¼Œçº¿ä¸Šä¹Ÿæ˜¯è¿™æ ·ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜¯å…è®¸ç¼“å­˜çš„ï¼Œè¿™éƒ½å¹´æœ«äº†ï¼Œè¿ç»´æ”¾å‡äº†ï¼Œä¸æ‰“æ‰°äº†ã€‚</p>\n<p>å…·ä½“çš„ç¼“å­˜å¼€å…³æ˜¯è¿™ä¸ªï¼š</p>\n<pre><code class=\"language-java\">public static final String NACOS_CORE_AUTH_CACHING_ENABLED = \"nacos.core.auth.caching.enabled\";\n</code></pre>\n<p>é…ç½®æ–‡ä»¶ä¸­æ˜¯å¼€å¯çš„ï¼š</p>\n<pre><code class=\"language-shell\">[root@COMPASS-NACOS-1 nacos]# cat conf/application.properties |grep caching\n### Turn on/off caching of auth information. By turning on this switch, the update of auth information would have a 15 seconds delay.\nnacos.core.auth.caching.enabled=true\n</code></pre>\n<p>é‚£å°±æ˜¯äº†ï¼Œåº”è¯¥å°±æ˜¯ç¼“å­˜é‡Œçš„ç”¨æˆ·æ•°æ®æœ‰é—®é¢˜ã€‚</p>\n<p>é‚£ä¸ºå•¥ï¼Œé‡ç½®å¯†ç å°±å¥½äº†å‘¢ï¼Ÿ</p>\n<h2 id=\"ä¿®æ”¹å¯†ç æ¥å£\">ä¿®æ”¹å¯†ç æ¥å£</h2>\n<p>ä¿®æ”¹å¯†ç è¿™ä¸ªï¼Œæˆ‘ä»¬å½“æ—¶è¿˜æµ‹è¯•äº†ï¼Œè‡ªå·±æ”¹å¯†ç è¿˜ä¸è¡Œï¼Œå¿…é¡»æ˜¯nacosè´Ÿè´£äººé‚£ä¸ªç®¡ç†è´¦å·æ”¹äº†æ‰ç”Ÿæ•ˆçš„ã€‚</p>\n<p>å¦å¤–ï¼Œæˆ‘çœ‹äº†ä¸‹ï¼Œä¸Šé¢é‚£ä¸ªç™»å½•æ¥å£é‡Œï¼ŒæŸ¥ç”¨æˆ·çš„sqlå¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-java\">    public User findUserByUsername(String username) {\n        String sql = \"SELECT username,password FROM users WHERE username=? \";\n        return databaseOperate.queryOne(sql, new Object[] {username}, USER_ROW_MAPPER);\n    }\n</code></pre>\n<p>é‚£ä¿®æ”¹å¯†ç ï¼Œå…¨å±€æœä¸€ä¸‹<code>update users</code>ï¼š</p>\n<p><img alt=\"image-20260213100640175\" src=\"https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260213100640175.png\" /></p>\n<pre><code class=\"language-shell\">com.alibaba.nacos.plugin.auth.impl.controller.UserController#updateUser\n</code></pre>\n<p><img alt=\"image-20260213100822326\" src=\"https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260213100822326.png\" /></p>\n<p>æˆ‘ä»¬å‘ç°ï¼Œæ”¹å¯†ç çš„æ¥å£ï¼Œæœ´å®æ— åï¼Œå°±æ˜¯æ”¹ä¸‹æ•°æ®åº“ï¼Œæ²¡æ¶‰åŠåˆ°æ¸…ä¸‹ç¼“å­˜å•¥çš„ï¼š</p>\n<p><img alt=\"image-20260213100836452\" src=\"https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260213100836452.png\" /></p>\n<p>é‚£å°±ä»é‚£ä¸ªç¼“å­˜çš„mapç€æ‰‹ï¼Œçœ‹äº†ä¸‹ï¼š</p>\n<pre><code class=\"language-shell\">com.alibaba.nacos.plugin.auth.impl.users.NacosUserDetailsServiceImpl#reload\n</code></pre>\n<p>ç»“æœå‘ç°äº†ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œè¿™é‡Œæ¯éš”15sæ‰§è¡Œä¸€æ¬¡ï¼Œä»æ•°æ®åº“åŠ è½½useræ•°æ®åˆ°ç¼“å­˜ï¼š</p>\n<p><img alt=\"image-20260213101021274\" src=\"https://dump-1252523945.cos.ap-shanghai.myqcloud.com/img/image-20260213101021274.png\" /></p>\n<p>é‚£å°±ç†è§£äº†ï¼Œæ”¹å¯†ç æ˜¯åªæ“ä½œæ•°æ®åº“ï¼›ç„¶åå®šæ—¶ä»»åŠ¡å»æ•°æ®åº“æŸ¥è¯¢æœ€æ–°æ•°æ®ï¼Œæ”¾åˆ°ç¼“å­˜é‡Œï¼Œè¿™æ ·å‘¢ï¼Œç¼“å­˜æ•°æ®å°±å’Œæ•°æ®åº“æ•°æ®ä¸€è‡´äº†ã€‚</p>\n<p>å¦ä¸€ä¸ªçŒœæµ‹ï¼šç¼“å­˜æ¯15ç§’ä»æ•°æ®åº“åŒæ­¥ï¼Œç¼“å­˜æ•°æ®æœ‰é—®é¢˜ï¼Œæ˜¯ä¸æ˜¯è¯´æ˜æœ‰é—®é¢˜çš„å¯èƒ½æ˜¯æ•°æ®åº“å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œæ•°æ®åº“é‡Œçš„ç”¨æˆ·æ•°æ®å‡ºäº†é—®é¢˜ï¼Œé€šè¿‡ä¿®æ”¹å¯†ç çš„æ–¹å¼æ‰æ­£å¸¸ï¼Œç„¶å15ç§’åï¼Œç¼“å­˜é‡Œæ•°æ®å˜å¾—æ­£å¸¸ã€‚</p>\n<p>è‡³äºæ•°æ®åº“æ•°æ®ä¸ºå•¥å‡ºäº†é—®é¢˜ï¼Œè¿™ä¸ªå°±ä¸å¥½æ‰¾äº†ï¼Œæœ¬ç¯‡å°±ä¸æ¢ç©¶äº†ã€‚</p>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-02-13 10:19</span>&nbsp;\n<a href=\"https://www.cnblogs.com/grey-wolf\">ä¸‰å›½æ¢¦å›</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">129</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    }
  ]
}