{
  "title": "主页 - 博客园",
  "link": "https://www.cnblogs.com/",
  "description": "主页 - 博客园 RSS",
  "entries": [
    {
      "title": "LangChain4j 工具调用实战",
      "link": "https://www.cnblogs.com/BNTang/p/19432093",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/BNTang/p/19432093\" id=\"cb_post_title_url\" title=\"发布于 2026-01-02 15:32\">\n    <span>LangChain4j 工具调用实战</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>你有没有遇到过这种场景：</p>\n<ul>\n<li>用户问 AI：\"帮我查下今天上海的天气\"</li>\n<li>AI 回答：\"抱歉，我无法获取实时信息。\"</li>\n</ul>\n<p><strong>问题的核心是：AI 没有工具。</strong>就像给你一双手脚，让你去盖房子，你也做不到。但如果给你一套工具箱，情况就完全不同了。</p>\n<p><strong>今天我们就来给 AI 装上一套工具箱</strong>，让它能够从博客园实时获取最新技术文章。</p>\n<h2 id=\"什么是工具调用\">什么是工具调用？</h2>\n<p>简单来说，工具调用就是让 AI 能够\"借用\"外部能力。</p>\n<p>这些能力包括但不限于：</p>\n<ul>\n<li>联网搜索</li>\n<li>调用第三方 API</li>\n<li>读写文件</li>\n<li>查询数据库</li>\n<li>执行代码</li>\n</ul>\n<p><strong>但有一个关键点要特别注意</strong>：</p>\n<p>工具调用 <strong>不是</strong> AI 自己去执行这些工具，而是 AI 说\"我需要调用 XX 工具\"，真正执行的是我们的应用程序。</p>\n<p>流程是这样的：</p>\n<pre><code>用户提问 → AI 分析意图 → AI 决定调用工具\n→ 我们的程序执行工具 → 把结果返回给 AI → AI 继续回答\n</code></pre>\n<h2 id=\"要实现的目标\">要实现的目标</h2>\n<p>让 AI 能够查询博客园用户的最新文章，并提取这些信息：</p>\n<ul>\n<li>文章标题</li>\n<li>文章链接</li>\n<li>发布日期</li>\n<li>摘要内容</li>\n<li>阅读数、评论数、推荐数</li>\n</ul>\n<p><strong>实现方案</strong>：用 Jsoup 抓取博客园页面，把数据整理后返回给 AI。</p>\n<h2 id=\"快速了解流程\">快速了解流程</h2>\n<p>完整流程其实很简单：</p>\n<ol>\n<li>用户提问 → 2. AI 分析意图 → 3. AI 决定调用工具 → 4. 程序执行工具 → 5. 结果返回给 AI → 6. AI 整理后回复用户</li>\n</ol>\n<p><strong>核心就是</strong>：AI 不直接调用工具，而是告诉我们的程序\"我需要调用这个工具\"，程序执行完后把结果给 AI，AI 再基于结果回答用户。</p>\n<blockquote>\n<p>想看详细的调用链路？文章最后有完整的时序图，包你一看就懂。</p>\n</blockquote>\n<h2 id=\"动手实现四步搞定\">动手实现（四步搞定）</h2>\n<h3 id=\"步骤-1引入依赖\">步骤 1：引入依赖</h3>\n<p>先在 <code>pom.xml</code> 中加入 Jsoup（网页爬虫库）：</p>\n<pre><code class=\"language-xml\">&lt;dependency&gt;\n    &lt;groupId&gt;org.jsoup&lt;/groupId&gt;\n    &lt;artifactId&gt;jsoup&lt;/artifactId&gt;\n    &lt;version&gt;1.20.1&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<h3 id=\"步骤-2编写工具类\">步骤 2：编写工具类</h3>\n<p>在 <code>tools</code> 包下创建一个工具类，用 <code>@Tool</code> 注解告诉 LangChain4j：\"这是一个工具\"。</p>\n<p><strong>⚠️ 重点</strong>：工具描述一定要写清楚，AI 能否正确调用工具全看这个描述！</p>\n<pre><code class=\"language-java\">/**\n * 博客园文章搜索工具\n * 用于从博客园抓取用户的最新文章信息\n *\n * @author BNTang\n */\n@Slf4j\npublic class CnblogsArticleTool {\n\n    /**\n     * 从指定用户的博客园主页获取最新的技术文章列表。\n     * 支持提取文章标题、链接、发布日期、摘要、阅读数、评论数和推荐数等信息。\n     *\n     * @param input 博客园用户名或URL，可选地附加\"|N\"来限制结果数量\n     * @return 技术文章列表的JSON格式，包含详细信息，若失败则返回错误信息\n     */\n    @Tool(name = \"cnblogsSearch\", value = \"\"\"\n            从博客园获取最新文章。输入可以是：\n            - 博客园用户名（例如：'someUser'）\n            - 完整的个人主页URL（例如：'https://www.cnblogs.com/someUser/'）\n            可选择性地附加'|N'来限制结果数量，例如：'someUser|5'。\n            返回包含标题、链接、日期、摘要、阅读数、评论数、推荐数的JSON数组。\n            \"\"\"\n    )\n    public String searchCnblogsArticles(@P(value = \"用户名或URL（可选地附加|限制数量）\") String input) {\n        if (input == null || input.trim().isEmpty()) {\n            return \"{\\\"error\\\":\\\"Empty input\\\"}\";\n        }\n\n        String[] parts = input.trim().split(\"\\\\|\", 2);\n        String target = parts[0].trim();\n        int limit = 10;\n        if (parts.length == 2) {\n            try {\n                limit = Math.max(1, Math.min(100, Integer.parseInt(parts[1].trim())));\n            } catch (NumberFormatException ignored) { /* keep default */ }\n        }\n\n        String url;\n        if (target.startsWith(\"http://\") || target.startsWith(\"https://\")) {\n            url = target;\n        } else {\n            url = \"https://www.cnblogs.com/\" + target + \"/\";\n        }\n\n        Document doc = fetchDocumentWithRetries(url, 3, 8000);\n        if (doc == null) {\n            return \"{\\\"error\\\":\\\"Failed to fetch or parse page\\\"}\";\n        }\n\n        // 选择博客文章的主容器\n        Elements dayElements = doc.select(\".day\");\n\n        List&lt;ArticleInfo&gt; results = new ArrayList&lt;&gt;();\n\n        for (Element dayEl : dayElements) {\n            if (results.size() &gt;= limit) {\n                break;\n            }\n\n            // 提取标题和链接\n            Element titleEl = dayEl.selectFirst(\".postTitle a, .postTitle2\");\n            if (titleEl == null) {\n                continue;\n            }\n\n            String title = titleEl.text().trim();\n            // 移除\"[置顶]\"标记\n            title = title.replaceAll(\"^\\\\[置顶]\\\\s*\", \"\");\n\n            String href = titleEl.absUrl(\"href\");\n            if (href.isEmpty()) {\n                href = titleEl.attr(\"href\").trim();\n            }\n\n            // 去重检查\n            boolean seen = false;\n            for (ArticleInfo r : results) {\n                if (r.url.equals(href)) {\n                    seen = true;\n                    break;\n                }\n            }\n            if (seen) {\n                continue;\n            }\n\n            // 提取日期\n            String date = \"\";\n            Element dateEl = dayEl.selectFirst(\".dayTitle a\");\n            if (dateEl != null) {\n                date = dateEl.text().trim();\n            }\n\n            // 提取摘要\n            String summary = \"\";\n            Element summaryEl = dayEl.selectFirst(\".c_b_p_desc, .postCon\");\n            if (summaryEl != null) {\n                summary = summaryEl.text().trim();\n                // 移除\"阅读全文\"链接文本\n                summary = summary.replaceAll(\"阅读全文$\", \"\").trim();\n                // 限制摘要长度\n                if (summary.length() &gt; 200) {\n                    summary = summary.substring(0, 200) + \"...\";\n                }\n            }\n\n            // 提取统计信息\n            String viewCount = \"0\";\n            String commentCount = \"0\";\n            String diggCount = \"0\";\n\n            Element postDesc = dayEl.selectFirst(\".postDesc\");\n            if (postDesc != null) {\n                Element viewEl = postDesc.selectFirst(\".post-view-count\");\n                if (viewEl != null) {\n                    viewCount = extractNumber(viewEl.text());\n                }\n\n                Element commentEl = postDesc.selectFirst(\".post-comment-count\");\n                if (commentEl != null) {\n                    commentCount = extractNumber(commentEl.text());\n                }\n\n                Element diggEl = postDesc.selectFirst(\".post-digg-count\");\n                if (diggEl != null) {\n                    diggCount = extractNumber(diggEl.text());\n                }\n            }\n\n            if (!title.isEmpty() &amp;&amp; !href.isEmpty()) {\n                results.add(new ArticleInfo(title, href, date, summary, viewCount, commentCount, diggCount));\n            }\n        }\n\n        if (results.isEmpty()) {\n            return \"{\\\"message\\\":\\\"未找到文章。\\\"}\";\n        }\n\n        StringBuilder sb = new StringBuilder();\n        sb.append(\"[\");\n        for (int i = 0; i &lt; results.size(); i++) {\n            ArticleInfo article = results.get(i);\n            sb.append(\"{\");\n            sb.append(\"\\\"title\\\":\").append(jsonEscape(article.title)).append(\",\");\n            sb.append(\"\\\"url\\\":\").append(jsonEscape(article.url)).append(\",\");\n            sb.append(\"\\\"date\\\":\").append(jsonEscape(article.date)).append(\",\");\n            sb.append(\"\\\"summary\\\":\").append(jsonEscape(article.summary)).append(\",\");\n            sb.append(\"\\\"viewCount\\\":\").append(article.viewCount).append(\",\");\n            sb.append(\"\\\"commentCount\\\":\").append(article.commentCount).append(\",\");\n            sb.append(\"\\\"diggCount\\\":\").append(article.diggCount);\n            sb.append(\"}\");\n            if (i &lt; results.size() - 1) {\n                sb.append(\",\");\n            }\n        }\n        sb.append(\"]\");\n        return sb.toString();\n    }\n\n    /**\n     * 带重试机制获取网页文档\n     *\n     * @param url         目标URL\n     * @param maxAttempts 最大尝试次数\n     * @param timeoutMs   超时时间（毫秒）\n     * @return Jsoup文档对象，失败返回null\n     */\n    private Document fetchDocumentWithRetries(String url, int maxAttempts, int timeoutMs) {\n        String userAgent = \"Mozilla/5.0 (compatible; Bot/1.0; +https://example.com/bot)\";\n        int attempt = 0;\n        while (attempt &lt; maxAttempts) {\n            attempt++;\n            try {\n                return Jsoup.connect(url)\n                        .userAgent(userAgent)\n                        .timeout(timeoutMs)\n                        .referrer(\"https://www.google.com\")\n                        .get();\n            } catch (IOException e) {\n                log.warn(\"第{}次尝试获取 {} 失败: {}\", attempt, url, e.getMessage());\n                try {\n                    Thread.sleep(500L * attempt);\n                } catch (InterruptedException ignored) {\n                    Thread.currentThread().interrupt();\n                    break;\n                }\n            }\n        }\n        log.error(\"所有尝试均失败，无法获取 {}\", url);\n        return null;\n    }\n\n    /**\n     * 从文本中提取数字\n     *\n     * @param text 包含数字的文本，如\"阅读(123)\"\n     * @return 提取的数字字符串\n     */\n    private String extractNumber(String text) {\n        if (text == null) {\n            return \"0\";\n        }\n        text = text.replaceAll(\"[^0-9]\", \"\");\n        return text.isEmpty() ? \"0\" : text;\n    }\n\n    /**\n     * JSON字符串转义\n     *\n     * @param s 待转义的字符串\n     * @return 转义后的JSON字符串\n     */\n    private String jsonEscape(String s) {\n        if (s == null) {\n            return \"\\\"\\\"\";\n        }\n        String escaped = s.replace(\"\\\\\", \"\\\\\\\\\")\n                .replace(\"\\\"\", \"\\\\\\\"\")\n                .replace(\"\\n\", \"\\\\n\")\n                .replace(\"\\r\", \"\\\\r\");\n        return \"\\\"\" + escaped + \"\\\"\";\n    }\n\n    /**\n     * 文章信息类\n     */\n    private static class ArticleInfo {\n        String title;\n        String url;\n        String date;\n        String summary;\n        String viewCount;\n        String commentCount;\n        String diggCount;\n\n        ArticleInfo(String title, String url, String date, String summary,\n                    String viewCount, String commentCount, String diggCount) {\n            this.title = title;\n            this.url = url;\n            this.date = date;\n            this.summary = summary;\n            this.viewCount = viewCount;\n            this.commentCount = commentCount;\n            this.diggCount = diggCount;\n        }\n    }\n}\n</code></pre>\n<p><strong>核心逻辑</strong>：</p>\n<ol>\n<li>解析用户输入（支持用户名或 URL）</li>\n<li>用 Jsoup 抓取博客园页面</li>\n<li>用 CSS 选择器提取文章信息</li>\n<li>返回 JSON 格式的结果</li>\n</ol>\n<h3 id=\"步骤-3把工具绑定到-ai-service\">步骤 3：把工具绑定到 AI Service</h3>\n<pre><code class=\"language-java\">public AiCodeHelperService aiCodeHelperService() {\n    ChatMemory chatMemory = MessageWindowChatMemory.withMaxMessages(10);\n\n    return AiServices.builder(AiCodeHelperService.class)\n            .chatModel(qwenChatModel)\n            .chatMemory(chatMemory)\n            .contentRetriever(contentRetriever)\n            .tools(new CnblogsArticleTool())  // ← 绑定工具\n            .build();\n}\n</code></pre>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/2105804/202601/2105804-20260102134201705-1158921879.png\" /></p>\n<h3 id=\"步骤-4测试一下\">步骤 4：测试一下</h3>\n<p>写个单元测试：</p>\n<pre><code class=\"language-java\">@Test\nvoid chatWithTools() {\n    String result = aiCodeHelperService.chat(\n        \"帮我查下博客园用户 BNTang 的最新文章\"\n    );\n    System.out.println(result);\n}\n</code></pre>\n<p><strong>关键来了</strong>，在工具方法里打断点，Debug 运行：</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/2105804/202601/2105804-20260102134527464-344030566.png\" /></p>\n<p><strong>你会看到断点真的停下来了！</strong></p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/2105804/202601/2105804-20260102134605221-2143614017.png\" /></p>\n<p>这说明 <strong>AI 真的调用了我们的工具</strong>！</p>\n<p>工具把数据返回给 AI 后，AI 会整理成自然语言：</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/2105804/202601/2105804-20260102134407815-1435969741.png\" /></p>\n<p>在 Debug 模式下，你还能看到 AI Service 加载了工具：</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/2105804/202601/2105804-20260102134818678-1880921390.png\" /></p>\n<p>以及工具的完整调用链路：</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/2105804/202601/2105804-20260102135157469-2000354683.png\" /></p>\n<p><strong>完美运行！</strong></p>\n<h2 id=\"工具定义的两种方式\">工具定义的两种方式</h2>\n<p>前面用的是声明式定义（注解），LangChain4j 也支持编程式定义：</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/2105804/202601/2105804-20260102135244721-1011469314.png\" /></p>\n<p><strong>简单场景用声明式，需要动态创建工具用编程式。</strong></p>\n<h2 id=\"还能做更多\">还能做更多</h2>\n<p>除了搜索，工具调用还能实现这些功能：</p>\n<ul>\n<li>读写本地文件</li>\n<li>生成 PDF 报告</li>\n<li>执行 Shell 命令</li>\n<li>生成图表</li>\n<li>调用企业内部 API</li>\n</ul>\n<p><strong>更棒的是</strong>：这些工具不一定都要自己写，可以通过 MCP（Model Context Protocol）协议直接用别人开发好的工具。</p>\n<h2 id=\"完整的调用链路\">完整的调用链路</h2>\n<p>如果想深入理解工具调用的每一步，看这个时序图就对了：</p>\n<div class=\"mermaid\">sequenceDiagram\n      autonumber\n\n      participant U2 as 🧪 Test(用户)\n      participant B1 as AiCodeHelperService\n      participant L1 as LangChain4j框架\n      participant L2 as ChatModel(LLM)\n      participant B3 as CnblogsArticleTool\n      participant T1 as Jsoup(网页抓取)\n\n      Note over U2,T1: chatWithTools() 测试流程\n\n      U2-&gt;&gt;B1: chat(\"帮我查询博客园用户 BNTang 的最新技术文章...\")\n      B1-&gt;&gt;L1: 转发请求\n      L1-&gt;&gt;L1: 加载 system-prompt.txt\n      L1-&gt;&gt;L1: 添加 ChatMemory(最近10条消息)\n      L1-&gt;&gt;L2: 发送用户消息\n\n      L2-&gt;&gt;L2: 分析意图\n      L2-&gt;&gt;L2: 识别需要调用 cnblogsSearch 工具\n\n      L2--&gt;&gt;L1: 返回工具调用请求\n      L1-&gt;&gt;B3: searchCnblogsArticles(\"BNTang\")\n\n      B3-&gt;&gt;B3: 解析输入参数\n      B3-&gt;&gt;B3: 构造URL (https://www.cnblogs.com/BNTang/)\n\n      B3-&gt;&gt;T1: fetchDocumentWithRetries(url, 3, 8000)\n      T1-&gt;&gt;T1: 发送HTTP请求\n      T1--&gt;&gt;B3: 返回HTML文档\n\n      B3-&gt;&gt;B3: 解析HTML (.day 元素)\n      B3-&gt;&gt;B3: 提取文章信息(标题、链接、日期、摘要等)\n      B3-&gt;&gt;B3: 生成JSON结果\n\n      B3--&gt;&gt;L1: 返回文章列表JSON\n      L1-&gt;&gt;L2: 发送工具结果给LLM\n\n      L2-&gt;&gt;L2: 基于工具结果生成最终回复\n      L2--&gt;&gt;L1: 返回最终答案\n      L1--&gt;&gt;B1: 返回结果\n      B1--&gt;&gt;U2: 返回 String 结果\n\n      U2-&gt;&gt;U2: System.out.println(result)\n</div><p><strong>时序图解读</strong>：</p>\n<ol>\n<li><strong>用户发起请求</strong>（步骤 1-4）：Test 调用 Service，Service 转发给 LangChain4j 框架</li>\n<li><strong>AI 分析意图</strong>（步骤 5-7）：LLM 分析用户问题，决定需要调用 <code>cnblogsSearch</code> 工具</li>\n<li><strong>工具执行</strong>（步骤 8-17）：Tool 用 Jsoup 抓取博客园页面，解析数据</li>\n<li><strong>结果返回</strong>（步骤 18-21）：工具结果返回给 LLM，LLM 生成最终答案</li>\n</ol>\n<p><strong>关键点</strong>：工具执行在应用侧（B3、T1），不在 AI 服务器（L2）。</p>\n<h2 id=\"写在最后\">写在最后</h2>\n<p>工具调用是让 AI 突破能力边界的关键技术。</p>\n<p><strong>记住三个要点</strong>：</p>\n<ol>\n<li>工具描述写清楚，AI 才能正确调用</li>\n<li>工具在应用侧执行，不在 AI 服务器</li>\n<li>声明式定义简单，编程式定义灵活</li>\n</ol>\n<p>通过 LangChain4j 的 <code>@Tool</code> 注解，只需要几行代码，就能让 AI 拥有\"超能力\"。</p>\n<hr />\n<p><strong>系列文章持续更新中，关注我不错过每一篇干货。</strong></p>\n<p><strong>这篇文章对你有用的话，点个赞、在看支持一下吧！</strong></p>\n<hr />\n<p><strong>相关文章推荐</strong>：</p>\n<ul>\n<li><a href=\"https://mp.weixin.qq.com/s/XhmFIeKpJR37AqqLg46b5w\" rel=\"noopener nofollow\" target=\"_blank\">智谱 GLM-4.7 编程第一</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s/8fRzTXtAJ8_IfX2OggGDsw\" rel=\"noopener nofollow\" target=\"_blank\">LangChain4j 结构化输出实战</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s/KtaNzGc3wbVKPwMTVl1z4g\" rel=\"noopener nofollow\" target=\"_blank\">让 AI 不再失忆</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s/pnCbt98Ob4hb8sj9WPVV3g\" rel=\"noopener nofollow\" target=\"_blank\">Claude Code 免费指南</a></li>\n</ul>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-02 15:32</span>&nbsp;\n<a href=\"https://www.cnblogs.com/BNTang\">BNTang</a>&nbsp;\n阅读(<span id=\"post_view_count\">0</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "格式塔原理：数据可视化如何引导观众的注意力",
      "link": "https://www.cnblogs.com/wang_yb/p/19431960",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/wang_yb/p/19431960\" id=\"cb_post_title_url\" title=\"发布于 2026-01-02 15:05\">\n    <span>格式塔原理：数据可视化如何引导观众的注意力</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>在数据分析中，我们常说：“一张好的图表胜过千言万语。”</p>\n<p>但很多时候，我们做出来的图表却是“千言万语堵在心口难开”。读者看了半天，抓不住重点。</p>\n<p>这是为什么？</p>\n<p>因为人类的视觉感知遵循一套被称为 <strong>格式塔（Gestalt）</strong> 的心理学原理。</p>\n<p>简单来说，当我们看到一组物体时，大脑会自动将它们视为一个整体或一种模式，而不是孤立的碎片。</p>\n<p>下面我们用 <code>Python</code> 的 <code>Matplotlib</code> 库，来演示 <strong>格式塔（Gestalt）</strong> 心理学中的 6 个核心原理，看看如何利用这些原理“控制”读者的注意力。</p>\n<h1 id=\"1-邻近原理距离产生关系\">1. 邻近原理：距离产生“关系”</h1>\n<p><strong>邻近原理</strong>就是距离越近，关系越亲，我们的大脑会自动把靠得近的物体归为一类。</p>\n<p>就像在一个派对上，站在一起聊天的几个人，你会下意识觉得他们是一伙的。</p>\n<pre><code class=\"language-python\"># 邻近原理\n# 创建测试数据\nnp.random.seed(42)\ndata_a = np.random.normal(5, 1.5, 30)\ndata_b = np.random.normal(10, 1.5, 30)\ndata_c = np.random.normal(15, 1.5, 30)\n\n# 不使用邻近原理\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))\n\n# 左侧：未应用邻近原理（所有点均匀分布）\nall_data = np.concatenate([data_a, data_b, data_c])\nx_positions = np.arange(90)\nax1.scatter(x_positions, all_data, alpha=0.7)\nax1.grid(True, alpha=0.3)\n\n# 右侧：应用邻近原理（按组聚集）\nfor i, (data, x_offset) in enumerate(zip([data_a, data_b, data_c], [0, 30, 60])):\n    x_positions = np.arange(len(data)) + x_offset\n    ax2.scatter(x_positions, data, alpha=0.7, label=f'组{i+1}')\n\nplt.tight_layout()\nplt.show()\n</code></pre>\n\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/83005/202601/83005-20260102150252034-156796734.png\" /></p>\n<p><strong>设计要点</strong>：将相关的数据点或元素放在靠近的位置，可以让观众自然地理解它们属于同一类别或具有某种关联。</p>\n<h1 id=\"2-相似原理相似的性格吸引\">2. 相似原理：相似的“性格”吸引</h1>\n<p><strong>相似原理</strong>就是长得像的，就是一家人，当物体在颜色、形状或大小上相似时，大脑会将它们分为一组。</p>\n<p>比如在足球场上，穿着相同颜色球衣的人，你不需要看清他们的脸，就知道他们是队友。</p>\n<pre><code class=\"language-python\"># 相似原理\n# 创建测试数据\ncategories = [\"A\", \"B\", \"C\", \"D\", \"E\"]\nvalues1 = [12, 16, 14, 18, 15]\nvalues2 = [8, 11, 9, 12, 10]\nx_pos = np.arange(len(categories))\n\n# 相似原理示例\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))\n\n# 左侧：未应用相似原理（随机颜色和样式）\nbars1 = ax1.bar(x_pos - 0.2, values1, 0.4, color=colors1, edgecolor=\"black\")\nbars2 = ax1.bar(\n    x_pos + 0.2, values2, 0.4, color=colors2, edgecolor=\"black\", hatch=hatches[0]\n)\n\n# 为每组条形添加不同图案\nfor i, bar in enumerate(bars2):\n    bar.set_hatch(hatches[i % len(hatches)])\n\n# 右侧：应用相似原理（一致的颜色和样式）\nax2.bar(x_pos - 0.2, values1, 0.4, color=\"skyblue\", edgecolor=\"black\", label=\"数据集1\")\nax2.bar(\n    x_pos + 0.2, values2, 0.4, color=\"lightcoral\", edgecolor=\"black\", label=\"数据集2\"\n)\n\nplt.tight_layout()\nplt.show()\n</code></pre>\n\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/83005/202601/83005-20260102150251991-767107594.png\" /></p>\n<p><strong>设计要点</strong>：使用一致的颜色、形状或样式来表示相同类型的数据，可以大大降低观众的认知负担。</p>\n<h1 id=\"3-包围原理边界创造归属感\">3. 包围原理：边界创造\"归属感\"</h1>\n<p>包围原理就是有围墙的地方就是家。如果在某些物体周围加上边界或背景色，它们就被视为一个独立的群体。</p>\n<p>这个原理甚至比 <strong>“邻近”</strong> 和 <strong>“相似”</strong> 更强大。</p>\n<p>比如，草地上散落着羊群，一旦你用栅栏圈住其中几只，大家就会认为这几只是被特别选中的。</p>\n<pre><code class=\"language-python\"># 包围原理\n# 创建测试数据\nnp.random.seed(42)\nx1 = np.random.normal(2, 0.8, 50)\ny1 = np.random.normal(3, 0.8, 50)\n\nx2 = np.random.normal(5, 0.8, 50)\ny2 = np.random.normal(5, 0.8, 50)\n\n# 包围原理示例\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))\n\n# 左侧：未应用包围原理\nax1.scatter(x1, y1, alpha=0.7, color=\"blue\")\nax1.scatter(x2, y2, alpha=0.7, color=\"red\")\n\n# 右侧：应用包围原理\nfrom matplotlib.patches import Ellipse\n\nax2.scatter(x1, y1, alpha=0.7, color=\"blue\", label=\"组A\")\nax2.scatter(x2, y2, alpha=0.7, color=\"red\", label=\"组B\")\n\n# 添加包围区域\nellipse1 = Ellipse((2, 3), width=4, height=3, edgecolor=\"blue\")\nellipse2 = Ellipse((5, 5), width=4, height=3, edgecolor=\"red\")\n\nax2.add_patch(ellipse1)\nax2.add_patch(ellipse2)\n\nplt.tight_layout()\nplt.show()\n</code></pre>\n\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/83005/202601/83005-20260102150252070-854536119.png\" /></p>\n<p><strong>设计要点</strong>：使用边界、背景色或容器将相关的数据元素包围起来，可以明确地告诉观众这些元素属于同一组。</p>\n<h1 id=\"4-闭合原理大脑的自动补全\">4. 闭合原理：大脑的\"自动补全\"</h1>\n<p><strong>闭合原理</strong>就是大脑是天生的“补图高手”。即使图形不完整，只要有足够的提示，大脑也会自动脑补出缺失的部分。</p>\n<p>比如看到一个虚线画圆，你不会觉得那是断断续续的线段，你会直接说：“这是一个圆”。</p>\n<pre><code class=\"language-python\"># 闭合原理示例\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))\n\n# 创建一些不完整的数据点\nnp.random.seed(42)\nangles = np.linspace(0, 2*np.pi, 7)[:-1]  # 故意少一个点形成不闭合\nradii = np.random.uniform(3, 5, 6)\nx = radii * np.cos(angles)\ny = radii * np.sin(angles)\n\n# 左侧：不完整的形状（未利用闭合原理）\nax1.plot(x, y, 'o-', linewidth=2, markersize=8)\n\n# 右侧：闭合的形状（应用闭合原理）\n# 添加缺失的点使形状闭合\nangles_closed = np.linspace(0, 2*np.pi, 7)\nradii_closed = np.append(radii, radii[0])  # 回到起点\nx_closed = radii_closed * np.cos(angles_closed)\ny_closed = radii_closed * np.sin(angles_closed)\n\nax2.plot(x_closed, y_closed, 'o-', linewidth=2, markersize=8)\nax2.fill(x_closed, y_closed, alpha=0.3)  # 填充增强闭合感\n\nplt.tight_layout()\nplt.show()\n</code></pre>\n\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/83005/202601/83005-20260102150252005-1834837851.png\" /></p>\n<p><strong>设计要点</strong>：我们不需要展示每一个细节，可以利用观众的自动补全能力来简化图表。</p>\n<p>但要<strong>注意</strong>，过于不完整的图形可能导致误解。</p>\n<h1 id=\"5-连续原理流畅的视觉路径\">5. 连续原理：流畅的\"视觉路径\"</h1>\n<p><strong>连续原理</strong>就是顺藤摸瓜。我们的视线倾向于跟随平滑、连续的路径，而不是剧烈折线或不规则的排列。</p>\n<p>比如排队时，如果队伍弯弯曲曲但每个人都看着前一个人的后脑勺，你知道这还是一条队。</p>\n<pre><code class=\"language-python\"># 连续原理示例\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))\n\n# 创建数据\nnp.random.seed(42)\ntime = np.arange(0, 10, 0.1)\nsignal1 = np.sin(time) + np.random.normal(0, 0.1, len(time))\nsignal2 = np.cos(time) + np.random.normal(0, 0.1, len(time))\n\n# 左侧：不连续的展示\nax1.plot(time[:50], signal1[:50], 'b-', linewidth=2, label='信号A (第一部分)')\nax1.plot(time[70:], signal1[70:], 'b--', linewidth=2, label='信号A (第二部分)')\nax1.plot(time[:40], signal2[:40], 'r-', linewidth=2, label='信号B (第一部分)')\nax1.plot(time[60:], signal2[60:], 'r--', linewidth=2, label='信号B (第二部分)')\n\n# 右侧：连续的展示\nax2.plot(time, signal1, 'b-', linewidth=2, label='信号A')\nax2.plot(time, signal2, 'r-', linewidth=2, label='信号B')\n\nplt.tight_layout()\nplt.show()\n</code></pre>\n\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/83005/202601/83005-20260102150252039-1585935589.png\" /></p>\n<p><strong>设计要点</strong>：保持线条、形状或元素的连续性可以帮助观众追踪数据的变化趋势。在折线图、面积图中尤其重要。</p>\n<h1 id=\"6-连接原理看得见的关系线\">6. 连接原理：看得见的\"关系线\"</h1>\n<p><strong>连接原理</strong>就是藕断丝连。被线连接的物体，被视为强关联。这个视觉信号比颜色和距离都要强。</p>\n<p>比如，两个人站得再远，如果手里牵着一根绳子，你也会觉得他们俩在互动。</p>\n<pre><code class=\"language-python\"># 连接原理示例 - 散点图版本\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))\n\n# 创建散点数据：4个相关点集，每个点集有5个点\nnp.random.seed(42)\nn_points = 5\nn_groups = 4\n\n# 为每组生成相关点\ngroups = []\nfor i in range(n_groups):\n    center_x = np.random.uniform(2, 8)\n    center_y = np.random.uniform(2, 8)\n\n    # 生成围绕中心的相关点\n    x_points = center_x + np.random.normal(0, 0.8, n_points)\n    y_points = center_y + np.random.normal(0, 0.8, n_points)\n\n    # 添加一些趋势\n    trend = np.random.uniform(-1, 1)\n    y_points = y_points + trend * (x_points - center_x)\n\n    groups.append((x_points, y_points))\n\n# 左侧：未应用连接原理（独立的散点）\ncolors = [\"blue\", \"red\", \"green\", \"orange\"]\nmarkers = [\"o\", \"s\", \"^\", \"D\"]\n\nfor i, (x_points, y_points) in enumerate(groups):\n    ax1.scatter(\n        x_points,\n        y_points,\n        color=colors[i],\n        marker=markers[i],\n        alpha=0.7,\n        s=80,\n        label=f\"数据集{i+1}\",\n    )\n\n\n# 右侧：应用连接原理（连接相关散点）\nfor i, (x_points, y_points) in enumerate(groups):\n    # 首先绘制连接线\n    # 按照x值排序，使连接线更有序\n    sorted_indices = np.argsort(x_points)\n    sorted_x = x_points[sorted_indices]\n    sorted_y = y_points[sorted_indices]\n\n    ax2.plot(\n        sorted_x,\n        sorted_y,\n        color=colors[i],\n        linewidth=2,\n        alpha=0.5,\n        linestyle=\"--\",\n        label=f\"数据集{i+1}趋势线\",\n    )\n\n    # 然后绘制散点（在线上方，避免被线遮挡）\n    ax2.scatter(\n        x_points,\n        y_points,\n        color=colors[i],\n        marker=markers[i],\n        alpha=0.7,\n        s=80,\n        edgecolor=\"black\",\n        linewidth=1,\n    )\n\nplt.tight_layout()\nplt.show()\n</code></pre>\n\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/83005/202601/83005-20260102150251985-1606569356.png\" /></p>\n<p><strong>设计要点</strong>：在散点图中，连接相关数据点的线可以帮助观众识别出数据的模式、趋势或分组关系。</p>\n<p>这就像在地图上连接各个城市来显示旅行路线一样，使相关的点之间建立了明确的视觉联系。</p>\n<h1 id=\"7-总结\">7. 总结</h1>\n<p>做数据可视化，不仅仅是写代码画图，更是一场 <strong>“注意力争夺战”</strong>。<br />\n通过这 6 个格式塔原理，我们不是在改变数据本身，而是在优化数据的呈现方式，让读者的脑力消耗降到最低。</p>\n<p>每次我们画图时，不妨问自己一句：</p>\n<ul>\n<li>“这些数据应该是一组吗？它们靠得够近吗？”（邻近）</li>\n<li>“重点数据突出了吗？”（包围/相似）</li>\n<li>“视线流动顺畅吗？”（连续）</li>\n</ul>\n<p>最好的可视化不是展示所有数据，而是引导观众看到最重要的信息。格式塔原理就是我们实现这一目标的强大工具。</p>\n<p>希望这篇文章能帮助你在创建数据可视化时，更加有意地引导观众的注意力。</p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-02 15:05</span>&nbsp;\n<a href=\"https://www.cnblogs.com/wang_yb\">wang_yb</a>&nbsp;\n阅读(<span id=\"post_view_count\">14</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "独立开发者的 2025：我为什么还在做一个“看起来很普通”的客服系统",
      "link": "https://www.cnblogs.com/sheng_chao/p/19431954",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/sheng_chao/p/19431954\" id=\"cb_post_title_url\" title=\"发布于 2026-01-02 15:02\">\n    <span>独立开发者的 2025：我为什么还在做一个“看起来很普通”的客服系统</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        过去几年里，技术社区反复讨论同样几个话题：AI、出海、SaaS、独立开发者。热度在变，说法在升级，但真正把一个系统长期跑起来的人，感受往往更具体也更现实。这篇文章，算是一次不太宏大的回顾——记录我在 2025 年围绕一个客服系统所做的选择、踩过的坑，以及一些被现实反复校正过的认知。\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<p>过去几年里，技术社区反复讨论同样几个话题：AI、出海、SaaS、独立开发者。<br />\n热度在变，说法在升级，但真正把一个系统长期跑起来的人，感受往往更具体也更现实。<br />\n2025 年对我来说，并不是一个有明显拐点的年份，没有爆发式增长，也没有戏剧性转向，只是持续做事、持续暴露问题、持续修正判断的一年。<br />\n这篇文章，算是一次不太宏大的回顾——记录我在 2025 年围绕一个客服系统所做的选择、踩过的坑，以及一些被现实反复校正过的认知。</p>\n<hr />\n<h2 id=\"一2025一个看似普通其实很残酷的一年\">一、2025：一个“看似普通、其实很残酷”的一年</h2>\n<p>如果只看技术社区的热词，2025 年似乎并不特别。<br />\nAI、出海、SaaS、独立开发者，这些词在过去几年里已经被反复讨论，甚至有些“疲劳”。</p>\n<p>但真正身处其中的人，大多能感受到一种很微妙的变化：</p>\n<p><strong>机会并没有消失，但容错率在急剧下降。</strong></p>\n<ul>\n<li>流量不再自然增长</li>\n<li>用户不再愿意“陪你一起成熟”</li>\n<li>技术红利逐步变成工程与耐力的比拼</li>\n</ul>\n<p>你依然可以做产品、写代码、发布版本，但<strong>每一次决策的代价都变得更真实、更不可逆</strong>。</p>\n<hr />\n<h3 id=\"表面平静底层在加速分化\">表面平静，底层在加速分化</h3>\n<p>从外部看，2025 年不像 2020 那样剧烈，也不像 2022 那样充满不确定性。<br />\n但从内部看，它更像是一个<strong>分水岭年份</strong>：</p>\n<ul>\n<li>大厂在收缩战线，只保留“确定性强”的方向</li>\n<li>中小团队开始意识到，靠融资和故事续命越来越难</li>\n<li>独立开发者要么更专业，要么更快放弃</li>\n</ul>\n<p><strong>“能跑起来”已经不算本事，“能活下去”才是。</strong></p>\n<hr />\n<h3 id=\"技术依然重要但不再是护城河本身\">技术依然重要，但不再是护城河本身</h3>\n<p>2025 年我最大的一个感受是：</p>\n<blockquote>\n<p>技术没有贬值，但“只靠技术”的路径，正在快速变窄。</p>\n</blockquote>\n<p>框架在变，模型在升级，工具链越来越完善。<br />\n一个功能，从想法到落地，前所未有地快。</p>\n<p>但这也意味着：</p>\n<ul>\n<li>同质化速度极快</li>\n<li>抄一个“能用的版本”几乎没有门槛</li>\n<li>真正拉开差距的，是长期维护、稳定性、细节和取舍</li>\n</ul>\n<p>很多项目不是死于“做不出来”，<br />\n而是死于 <strong>“做到一半，发现后面的路太长”</strong>。</p>\n<hr />\n<h3 id=\"对独立开发者而言这是清醒的一年\">对独立开发者而言，这是“清醒”的一年</h3>\n<p>如果说前几年还可以抱有某种浪漫幻想，<br />\n那么 2025 年更像是一年集体清醒期：</p>\n<ul>\n<li>你开始认真计算服务器、运维、支持成本</li>\n<li>你意识到每一个“免费用户”都在消耗注意力</li>\n<li>你必须直面一个问题：<strong>这东西有没有人愿意长期用、长期付费</strong></li>\n</ul>\n<p>对我来说，这一年并没有发生什么戏剧性的转折。<br />\n没有爆发式增长，也没有彻底放弃。</p>\n<p>只是逐渐意识到：<br />\n<strong>如果要继续做，就必须把它当成一件长期、甚至有点枯燥的事来对待。</strong></p>\n<hr />\n<h3 id=\"正是在这样的背景下我继续推进了-升讯威在线客服与营销系统\">正是在这样的背景下，我继续推进了 升讯威在线客服与营销系统</h3>\n<p>在 2025 年，我仍然选择把时间投入到一个看起来并不“性感”的方向——客服系统。</p>\n<p>不是因为它新，<br />\n而是因为它<strong>足够现实</strong>：</p>\n<ul>\n<li>足够考验工程能力</li>\n<li>足够暴露产品取舍</li>\n<li>也足够真实地反映“有没有人在用”</li>\n</ul>\n<p>后面的章节，我会具体聊聊这一年里踩过的坑、做过的取舍，以及一些被反复验证过的反直觉结论。</p>\n<p>但所有这些，都源于同一个前提：</p>\n<blockquote>\n<p><strong>2025 年，不再是“试试看”的年份了。</strong></p>\n</blockquote>\n<p>如果你还在做事，大概率和我一样，已经意识到了这一点。</p>\n<hr />\n<h2 id=\"二我为什么在-2025-年还要做一个客服系统\">二、我为什么在 2025 年还要做一个“客服系统”</h2>\n<p>如果只从“赛道选择”的角度看，<br />\n在 2025 年做客服系统，几乎是一个<strong>反直觉</strong>的决定。</p>\n<p>它不新、不酷、不在风口上。<br />\n也很难用一句话讲出“颠覆性”。</p>\n<p>但正因为如此，它反而成了一个非常诚实的选择。</p>\n<hr />\n<h3 id=\"客服系统是一面照妖镜\">客服系统是一面“照妖镜”</h3>\n<p>我一直觉得，客服系统是 SaaS 产品里非常特殊的一类：</p>\n<ul>\n<li>它不解决“增长”，而是暴露问题</li>\n<li>它不创造幻想，而是承接情绪</li>\n<li>它每天面对的，都是系统最真实、最糟糕的状态</li>\n</ul>\n<p>当一切都运转良好时，客服系统几乎是隐形的；<br />\n<strong>只有当别的地方出问题，它才会被频繁打开。</strong></p>\n<p>这意味着两件事：</p>\n<ol>\n<li>它对稳定性和实时性的要求极端苛刻</li>\n<li>它几乎无法靠“营销叙事”掩盖真实体验</li>\n</ol>\n<p><strong>好不好用，用几天就知道。</strong></p>\n<hr />\n<h3 id=\"红海并不等于没问题可解决\">“红海”并不等于“没问题可解决”</h3>\n<p>客服系统常被视为红海产品，但我在实际使用和调研中发现的却是另一种景象：</p>\n<ul>\n<li>功能很多，但长期使用体验割裂</li>\n<li>演示很好看，真实场景却频繁卡壳</li>\n<li>对销售友好，对工程师不友好</li>\n</ul>\n<p>尤其是对中小团队来说，常见的困境是：</p>\n<ul>\n<li>SaaS 版本限制多、定制难</li>\n<li>私有化版本部署复杂、维护成本高</li>\n<li>出了问题，很难快速定位到底是哪一层在出错</li>\n</ul>\n<p><strong>不是没有产品，而是“能安心长期用的产品”不多。</strong></p>\n<hr />\n<h3 id=\"我想验证一件事工程导向能不能做出好产品\">我想验证一件事：工程导向能不能做出好产品</h3>\n<p>在 2025 年继续做客服系统，对我来说更像一次验证，而不是押注。</p>\n<p>我想验证的不是“能不能做成一个大平台”，<br />\n而是一个更具体、也更残酷的问题：</p>\n<blockquote>\n<p>如果从一开始就以工程可控性、可维护性为核心，<br />\n能不能反过来，做出一个真正对用户友好的系统？</p>\n</blockquote>\n<p>这意味着很多不讨巧的选择：</p>\n<ul>\n<li>把时间花在日志、遥测、异常采集上</li>\n<li>花精力设计清晰、可预期的系统边界</li>\n<li>接受“功能慢一点，但稳定优先”的节奏</li>\n</ul>\n<p>这些东西在 Demo 里几乎看不出来，<br />\n但在第 100 次、第 1000 次使用时，会被反复感知。</p>\n<hr />\n<h3 id=\"升讯威在线客服与营销系统-只是这个验证过程的载体\">升讯威在线客服与营销系统 只是这个验证过程的载体</h3>\n<p>在这个过程中，我做了一个叫 <strong>升讯威在线客服与营销系统</strong> 的客服系统。</p>\n<p>但它并不是一个“先定产品、再找用户”的项目，<br />\n更像是一个<strong>长期承载思考和取舍的容器</strong>：</p>\n<ul>\n<li>哪些功能值得做，哪些应该克制</li>\n<li>哪些问题应该由系统解决，哪些必须交还给人</li>\n<li>在 SaaS 和私有化之间，边界应该如何划分</li>\n</ul>\n<p>很多决策，并不是“行业最佳实践”，<br />\n而是一次次被现实逼出来的选择。</p>\n<hr />\n<h3 id=\"为什么是-2025而不是更早或更晚\">为什么是 2025，而不是更早或更晚</h3>\n<p>如果是更早几年，我可能会更激进；<br />\n如果再晚几年，可能会更保守。</p>\n<p>2025 刚好处在一个微妙的位置：</p>\n<ul>\n<li>技术足够成熟，可以把基础问题解决好</li>\n<li>用户足够理性，不再被概念牵着走</li>\n<li>我自己，也已经不再执着于“做一个看起来很厉害的东西”</li>\n</ul>\n<p>而是更在意：</p>\n<blockquote>\n<p><strong>这个系统，在真实世界里，能不能被长期信任。</strong></p>\n</blockquote>\n<p>这就是我在 2025 年，仍然选择做一个客服系统的核心原因。</p>\n<hr />\n<h2 id=\"三2025-年我真正踩过的-5-个坑\">三、2025 年我真正踩过的 5 个坑</h2>\n<p>这一年里，我越来越清楚一件事：</p>\n<blockquote>\n<p>真正决定一个系统能不能“长期活着”的，<br />\n往往不是你最得意的那部分代码。</p>\n</blockquote>\n<p>下面这 5 个坑，都不是概念问题，而是<strong>上线之后、真实使用中反复出现</strong>的问题。</p>\n<hr />\n<h3 id=\"坑一把功能完整误当成系统可用\">坑一：把“功能完整”误当成“系统可用”</h3>\n<p>这是最早、也是最隐蔽的一个坑。</p>\n<p>在开发初期，很容易用 checklist 思维判断进度：</p>\n<ul>\n<li>会话有了</li>\n<li>转接有了</li>\n<li>访客追踪有了</li>\n<li>历史记录能查</li>\n</ul>\n<p><strong>看起来一切都齐了。</strong></p>\n<p>但真正上线后才发现，客服系统的“可用”，并不取决于有没有功能，而取决于：</p>\n<ul>\n<li>高峰期会不会卡</li>\n<li>网络抖动时会不会丢消息</li>\n<li>客服端卡死后能不能恢复</li>\n</ul>\n<p>这些问题，只有在<strong>真实用户、真实压力</strong>下才会暴露。</p>\n<p>后来我不得不承认：<br />\n<strong>客服系统不是功能型产品，而是稳定性型产品。</strong></p>\n<hr />\n<h3 id=\"坑二低估实时系统的复杂度\">坑二：低估“实时系统”的复杂度</h3>\n<p>理论上，一个客服系统就是：</p>\n<blockquote>\n<p>WebSocket + 消息转发 + 状态同步</p>\n</blockquote>\n<p>实际写起来，完全不是一回事。</p>\n<p>只要系统存在：</p>\n<ul>\n<li>多客服</li>\n<li>多会话</li>\n<li>多设备登录</li>\n<li>客服/访客随时上下线</li>\n</ul>\n<p>就必然会遇到这些问题：</p>\n<ul>\n<li>状态不同步</li>\n<li>幽灵会话</li>\n<li>已关闭的连接仍然被认为“在线”</li>\n<li>消息已发送，但对方并未真正接收</li>\n</ul>\n<p>最痛苦的是：<br />\n<strong>这些问题很难稳定复现。</strong></p>\n<p>后来我才真正理解，实时系统的核心不是“快”，<br />\n而是 <strong>状态一致性的收敛能力</strong>。</p>\n<hr />\n<h3 id=\"坑三把日志当成事后工具\">坑三：把日志当成“事后工具”</h3>\n<p>一开始，我也和很多人一样：</p>\n<ul>\n<li>出问题了，再加日志</li>\n<li>定位到了，再删一部分</li>\n</ul>\n<p>直到有一天我意识到：</p>\n<blockquote>\n<p>在客服系统里，如果你需要“复现问题”，<br />\n这个问题本身就已经很严重了。</p>\n</blockquote>\n<p>很多用户反馈的问题，本质是：</p>\n<ul>\n<li>“刚刚还能用，现在不行了”</li>\n<li>“有时候会断”</li>\n<li>“偶尔收不到消息”</li>\n</ul>\n<p>如果没有<strong>结构化、可关联的日志和遥测数据</strong>，<br />\n你根本无法判断问题发生在哪一层。</p>\n<p>从那之后，我开始把日志、异常、遥测当作<strong>系统的一部分</strong>，<br />\n而不是附加模块。</p>\n<hr />\n<h3 id=\"坑四以为-saas-和私有化只是部署方式不同\">坑四：以为 SaaS 和私有化只是“部署方式不同”</h3>\n<p>这是一个非常典型、也非常昂贵的认知错误。</p>\n<p>在早期，我下意识地认为：</p>\n<blockquote>\n<p>SaaS 跑得通，私有化就是“多打个包”。</p>\n</blockquote>\n<p>真正开始支持私有化之后才发现：</p>\n<ul>\n<li>网络环境完全不可控</li>\n<li>依赖服务可能被裁剪</li>\n<li>客户更关心“可诊断性”而不是“自动化”</li>\n</ul>\n<p>很多在 SaaS 下理所当然的假设，在私有化环境中都会失效。</p>\n<p><strong>它们不是同一个产品，只是共享了一部分代码。</strong></p>\n<hr />\n<h3 id=\"坑五忽视非功能需求的长期成本\">坑五：忽视“非功能需求”的长期成本</h3>\n<p>性能、稳定性、可观测性、安全性，<br />\n这些东西在需求评审时，往往排在最后。</p>\n<p>但在客服系统里，它们会以一种非常直接的方式反噬你：</p>\n<ul>\n<li>一次卡顿，就可能造成大量负面体验</li>\n<li>一次异常，客服就会怀疑“是不是系统问题”</li>\n<li>一次数据异常，信任成本要用很久才能修复</li>\n</ul>\n<p>我在 2025 年学到的最重要一课是：</p>\n<blockquote>\n<p><strong>非功能需求不是“以后再补”的东西，<br />\n它们决定了你以后还有没有机会补。</strong></p>\n</blockquote>\n<hr />\n<h2 id=\"四产品层面的-3-个反直觉认知\">四、产品层面的 3 个反直觉认知</h2>\n<p>在 2025 年之前，我对“做产品”这件事，多少还带着一点工程师式的理想主义。<br />\n但真正把一个系统放进长期、真实使用场景后，很多直觉其实是错的。</p>\n<p>下面这 3 个认知，都是踩坑之后才慢慢形成的。</p>\n<hr />\n<h3 id=\"认知一用户真正渴望的不是更多能力而是更少意外\">认知一：用户真正渴望的，不是“更多能力”，而是“更少意外”</h3>\n<p>在做客服系统之前，我也以为：</p>\n<blockquote>\n<p>功能多一点，总是好的。</p>\n</blockquote>\n<p>但真实情况恰恰相反。</p>\n<p>对客服来说，一个“好用”的系统，往往意味着：</p>\n<ul>\n<li>今天和昨天的行为是一致的</li>\n<li>高峰期不会突然变慢</li>\n<li>操作之后的结果是可预期的</li>\n</ul>\n<p>他们并不关心系统“还能不能再多做点事”，<br />\n他们更关心的是：</p>\n<blockquote>\n<p><strong>它会不会在关键时刻出问题。</strong></p>\n</blockquote>\n<p>很多功能一旦进入真实使用场景，就会暴露出维护成本、理解成本、误操作成本。<br />\n这些成本，不会出现在 PRD 里，但会长期存在于用户的心理负担中。</p>\n<hr />\n<h3 id=\"认知二真正能被长期使用的系统往往是没有存在感的\">认知二：真正能被长期使用的系统，往往是“没有存在感”的</h3>\n<p>这是一个很反产品直觉的结论。</p>\n<p>我们习惯于强调：</p>\n<ul>\n<li>易用性</li>\n<li>交互细节</li>\n<li>视觉反馈</li>\n</ul>\n<p>但在客服系统这种<strong>高频、长时间使用</strong>的产品里，<br />\n“存在感”本身，反而是一种负担。</p>\n<p>当系统足够稳定、足够顺滑时，用户甚至不会意识到它在“帮忙”。<br />\n它更像空气或地面——<br />\n<strong>只有消失或出问题时，才会被注意到。</strong></p>\n<p>我后来发现，很多所谓的“高级设计”，<br />\n在长期使用中都会被用户下意识地绕开。</p>\n<hr />\n<h3 id=\"认知三对中小团队来说可控性往往比自动化更重要\">认知三：对中小团队来说，“可控性”往往比“自动化”更重要</h3>\n<p>在产品设计层面，“自动化”听起来永远是正确方向。<br />\n但在真实环境中，它是有前提的。</p>\n<p>对中小团队而言：</p>\n<ul>\n<li>人少，但责任清晰</li>\n<li>出问题时，希望知道“哪里坏了”</li>\n<li>更愿意手动介入，而不是面对黑盒</li>\n</ul>\n<p>这意味着：</p>\n<ul>\n<li>清晰的状态</li>\n<li>可追溯的操作</li>\n<li>可解释的结果</li>\n</ul>\n<p>往往比“全自动”更有价值。</p>\n<p>我在 2025 年最大的转变之一，是开始主动压制某些看起来很“聪明”的设计，<br />\n转而强调：</p>\n<blockquote>\n<p><strong>系统是否让人安心。</strong></p>\n</blockquote>\n<hr />\n<h2 id=\"五2025-年我对-升讯威在线客服与营销系统-的几个关键取舍\">五、2025 年我对 升讯威在线客服与营销系统 的几个关键取舍</h2>\n<p>在前面的章节里，我提到过不少“坑”和认知转变。<br />\n但如果这些东西不能反映到具体决策中，它们就只是感悟。</p>\n<p>2025 年，对 升讯威在线客服与营销系统 来说，不是快速扩张的一年，<br />\n而是一年持续做选择、并且<strong>不断否定“看起来更诱人方案”</strong>的过程。</p>\n<p>下面这几个取舍，基本决定了它今天的形态。</p>\n<hr />\n<h3 id=\"取舍一同时提供-saas-和私有化而不是二选一\">取舍一：同时提供 SaaS 和私有化，而不是二选一</h3>\n<p>这是一个从一开始就很“反效率”的决定。</p>\n<p>从纯开发成本看，<br />\nSaaS + 私有化意味着：</p>\n<ul>\n<li>两套部署逻辑</li>\n<li>更多环境差异</li>\n<li>更高的维护复杂度</li>\n</ul>\n<p>但真实需求非常明确：</p>\n<ul>\n<li>有些团队需要“即开即用”</li>\n<li>有些团队必须“完全可控”</li>\n</ul>\n<p>我不想用一种模式去强迫所有人适应。</p>\n<p>最终的取舍是：<br />\n<strong>共享核心能力，但承认它们是两类不同用户。</strong></p>\n<p>这也直接影响了后面很多架构决策。</p>\n<hr />\n<h3 id=\"取舍二克制功能扩张把精力花在系统边界上\">取舍二：克制功能扩张，把精力花在“系统边界”上</h3>\n<p>在 2025 年，我刻意放慢了新增功能的节奏。</p>\n<p>不是因为没想法，<br />\n而是越来越清楚：</p>\n<blockquote>\n<p>客服系统真正的复杂度，不在功能数量，而在系统边界。</p>\n</blockquote>\n<p>比如：</p>\n<ul>\n<li>哪些状态是“强一致”的</li>\n<li>哪些问题必须在服务端解决</li>\n<li>哪些异常可以交给人工兜底</li>\n</ul>\n<p>这些决定，远比“加一个新功能”更影响长期体验。</p>\n<p>很多时候，我选择<strong>不做</strong>，<br />\n而不是做一个“可能有用”的功能。</p>\n<hr />\n<h3 id=\"取舍三优先工程可诊断性而不是全自动体验\">取舍三：优先工程可诊断性，而不是“全自动体验”</h3>\n<p>这是一个非常工程师导向的选择。</p>\n<p>在 升讯威在线客服与营销系统 中，我把相当一部分精力，<br />\n投入到了普通用户几乎看不到的地方：</p>\n<ul>\n<li>更清晰的日志结构</li>\n<li>更明确的错误分类</li>\n<li>更可追溯的会话和事件链路</li>\n</ul>\n<p>这意味着：</p>\n<ul>\n<li>短期内体验并不会“惊艳”</li>\n<li>但一旦出问题，更容易被定位和解释</li>\n</ul>\n<p>对我来说，这比“自动处理一切”更重要。</p>\n<hr />\n<h3 id=\"取舍四国际化不是加语言包而是提前约束设计\">取舍四：国际化不是“加语言包”，而是提前约束设计</h3>\n<p>在 2025 年，我开始认真推进国际化相关工作。</p>\n<p>但这个过程很快让我意识到：<br />\n国际化并不是后期优化，而是<strong>设计约束</strong>。</p>\n<ul>\n<li>文案长度</li>\n<li>时间与时区</li>\n<li>权限与角色命名</li>\n<li>默认行为假设</li>\n</ul>\n<p>这些一旦在早期写死，后期改动成本会非常高。</p>\n<p>所以在 升讯威在线客服与营销系统 中，<br />\n我宁愿慢一点，也要避免“只为单一市场优化”的捷径。</p>\n<hr />\n<h3 id=\"取舍五把-升讯威在线客服与营销系统-当成一个长期系统而不是可卖的功能集合\">取舍五：把 升讯威在线客服与营销系统 当成一个长期系统，而不是“可卖的功能集合”</h3>\n<p>这是所有取舍背后的底层判断。</p>\n<p>如果目标是尽快卖掉，<br />\n有很多更聪明、更激进的做法。</p>\n<p>但在 2025 年，我更关心的是：</p>\n<ul>\n<li>它能不能在真实环境中稳定跑几年</li>\n<li>它是否经得起不断有人接手、维护</li>\n<li>它会不会在某一天变成“没人敢动的系统”</li>\n</ul>\n<p>这决定了我对技术债、对重构、对节奏的态度。</p>\n<hr />\n<h2 id=\"六2026我打算继续做的-3-件小而确定的事\">六、2026：我打算继续做的 3 件“小而确定的事”</h2>\n<p>如果说 2025 年是一个不断做减法、校正方向的年份，<br />\n那对 2026 年，我反而没有太多宏大的规划。</p>\n<p>不是因为没有野心，<br />\n而是越来越清楚：</p>\n<blockquote>\n<p>在一个长期系统里，<br />\n<strong>真正重要的不是“下一步有多远”，而是“这一步能不能站稳”。</strong></p>\n</blockquote>\n<p>所以在 2026 年，我给自己定下的目标非常克制，只做三件“小而确定”的事。</p>\n<hr />\n<h3 id=\"第一件事把稳定从结果变成能力\">第一件事：把“稳定”从结果，变成能力</h3>\n<p>在 2025 年，稳定更多是一个结果导向的判断：<br />\n“最近没出什么大问题”。</p>\n<p>但到了 2026 年，我希望把它前移，变成一种<strong>系统能力</strong>：</p>\n<ul>\n<li>问题是否能被提前发现</li>\n<li>异常是否有明确归因</li>\n<li>在不同环境下，行为是否可预测</li>\n</ul>\n<p>这意味着我会继续投入在：</p>\n<ul>\n<li>更完整的可观测性</li>\n<li>更明确的系统状态模型</li>\n<li>更保守、但可验证的变更策略</li>\n</ul>\n<p>稳定不应该依赖“经验和小心”，<br />\n而应该来自<strong>结构本身</strong>。</p>\n<hr />\n<h3 id=\"第二件事把国际化真正跑一遍而不是支持一下\">第二件事：把国际化真正跑一遍，而不是“支持一下”</h3>\n<p>在 2025 年，国际化更多是设计层面的准备。<br />\n到了 2026 年，我希望让它进入真实运行状态。</p>\n<p>这包括：</p>\n<ul>\n<li>真正的非中文用户</li>\n<li>真正不同的使用习惯</li>\n<li>真正不同的部署环境</li>\n</ul>\n<p>而不是只停留在“可以切换语言”。</p>\n<p>这一步不一定会带来明显增长，<br />\n但它会非常清楚地暴露：</p>\n<blockquote>\n<p>升讯威在线客服与营销系统 的哪些设计是通用的，<br />\n哪些其实是隐含假设。</p>\n</blockquote>\n<hr />\n<h3 id=\"第三件事更明确地知道谁不适合用-升讯威在线客服与营销系统\">第三件事：更明确地知道“谁不适合用 升讯威在线客服与营销系统”</h3>\n<p>这是一个看起来有些反商业，但我认为非常必要的目标。</p>\n<p>在 2026 年，我希望能更清楚地回答一个问题：</p>\n<ul>\n<li><strong>什么样的团队，用 升讯威在线客服与营销系统 会很舒服</strong></li>\n<li><strong>什么样的团队，用它反而会痛苦</strong></li>\n</ul>\n<p>这包括：</p>\n<ul>\n<li>技术能力与期望的匹配</li>\n<li>对可控性 vs 自动化的偏好</li>\n<li>对私有化与合规的真实需求</li>\n</ul>\n<p>一个产品如果试图取悦所有人，<br />\n最终往往谁都留不住。</p>\n<hr />\n<h2 id=\"七结尾给同样在慢慢做事的人\">七、结尾：给同样在“慢慢做事”的人</h2>\n<p>写到这里，其实已经很清楚了。<br />\n这不是一篇“阶段性胜利”的复盘，也不是某种成功经验。</p>\n<p>它更像是一次记录：<br />\n在一个不再奖励冲动和幻想的阶段，<br />\n一个人如何选择继续把事情做好。</p>\n<hr />\n<p>在 2025 年，我越来越少问自己：</p>\n<ul>\n<li>这个方向是不是风口</li>\n<li>这个产品能不能快速放大</li>\n</ul>\n<p>而是反复确认一些更朴素的问题：</p>\n<ul>\n<li>它是不是在解决真实问题</li>\n<li>它有没有在变得更稳定</li>\n<li>如果明年继续做，我是否还能心安</li>\n</ul>\n<p>很多时候，继续做下去，并不是因为看到了希望，<br />\n而是因为<strong>已经看清了现实，仍然觉得值得</strong>。</p>\n<hr />\n<p>如果你也在做一个进展缓慢、反馈稀疏、很难被外人理解的项目，<br />\n那你大概能体会这种状态：</p>\n<ul>\n<li>每一步都很小</li>\n<li>每一次改动都要反复权衡</li>\n<li>很难兴奋，但也不再轻易动摇</li>\n</ul>\n<p>这并不浪漫，<br />\n但它可能是少数真正可持续的节奏。</p>\n<hr />\n<p>我不确定 升讯威在线客服与营销系统 会走到哪一步，<br />\n也不打算在这里承诺什么结果。</p>\n<p>我能确定的只有一件事：</p>\n<blockquote>\n<p><strong>它至少是按照我能长期负责的方式，被认真对待的。</strong></p>\n</blockquote>\n<p>如果你刚好也在寻找一个<br />\n可控、工程友好、愿意陪你走很久的客服系统，<br />\n你大概能理解我为什么会把它做成现在这个样子。</p>\n<p>项目叫 <strong>升讯威在线客服与营销系统</strong>。</p>\n<p>如果没有，也没关系。<br />\n能在这个阶段，继续慢慢把事做好，本身就已经很难得了。</p>\n<hr />\n<h2 id=\"独立者的产品成果\">独立者的产品成果</h2>\n<blockquote>\n<p><a href=\"https://kf.shengxunwei.com\" rel=\"noopener nofollow\" target=\"_blank\">https://kf.shengxunwei.com</a></p>\n</blockquote>\n<p><strong>可全天候 7 × 24 小时挂机运行，网络中断，拔掉网线，手机飞行模式，不掉线不丢消息，欢迎实测。</strong></p>\n<h3 id=\"访客端轻量直观秒级响应的沟通入口\">访客端：轻量直观、秒级响应的沟通入口</h3>\n<p>访客端是客户接触企业的第一窗口，我们精心打磨每一处交互细节，确保用户无需任何学习成本即可发起对话。无论是嵌入式聊天窗口、悬浮按钮，还是移动端自适应支持，都实现了真正的“即点即聊”。系统支持智能欢迎语、来源识别、设备类型判断，可自动记录访客路径并呈现于客服端，帮助企业更好地理解用户意图。在性能方面，访客端采用异步加载与自动重连机制，即使网络波动也能保障消息顺畅送达，真正做到——轻量不失稳定，简单不失智能。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/78019/202506/78019-20250601110426304-100322970.png\" /></p>\n<h3 id=\"客服端软件为高效率沟通而生\">客服端软件：为高效率沟通而生</h3>\n<p>客服端是客服人员的作战平台，我们构建了一个专注、高效、响应迅速的桌面级体验。系统采用多标签会话设计，让客服可同时处理多组对话；访客轨迹、历史会话、地理位置、设备信息、来源渠道等关键信息一目了然，协助客服快速做出判断。内置快捷回复、常用文件、表情支持和智能推荐功能，大幅降低重复劳动成本。同时，系统还支持智能分配、会话转接、转人工、自定义状态等多种机制，保障团队协作流畅，让客服不仅能应对高峰，更能稳定交付满意度。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/78019/202506/78019-20250601110431346-1228494411.png\" /></p>\n<h3 id=\"web-管理后台\">Web 管理后台：</h3>\n<p>Web 管理后台是企业对客服系统的“驾驶舱”，从接入配置、坐席管理，到数据统计、权限控制，一切尽在掌握。你可以灵活设置接待策略、工作时间、转接规则，支持按部门/标签/渠道精细分配访客，满足复杂业务场景。系统还内置访问监控、聊天记录检索、客服绩效统计、错失会话提醒等运营级功能，助力管理者洞察服务瓶颈，持续优化资源配置。支持私有化部署、分权限管理、日志记录与数据导出，为追求安全性与高可控性的企业，提供真正“掌握在自己手里的客服系统”。</p>\n<p><img alt=\"\" src=\"https://img2024.cnblogs.com/blog/78019/202506/78019-20250601110403917-63642615.png\" /></p>\n<h2 id=\"希望能够打造-开放开源共享努力打造一款优秀的社区开源产品\">希望能够打造： 开放、开源、共享。努力打造一款优秀的社区开源产品。</h2>\n<p>钟意的话请给个赞支持一下吧，谢谢~</p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-02 15:02</span>&nbsp;\n<a href=\"https://www.cnblogs.com/sheng_chao\">升讯威在线客服系统</a>&nbsp;\n阅读(<span id=\"post_view_count\">20</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "2025年终总结——在奔跑中前行",
      "link": "https://www.cnblogs.com/lucky_hu/p/19430418",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/lucky_hu/p/19430418\" id=\"cb_post_title_url\" title=\"发布于 2026-01-01 17:27\">\n    <span>2025年终总结——在奔跑中前行</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h3 id=\"导航\">导航</h3>\n<ul>\n<li>前言</li>\n<li>职场人的核心竞争力是什么</li>\n<li>拥抱AI，拥抱大模型</li>\n<li>尝试自媒体</li>\n<li>读毛选</li>\n<li>写过的文章</li>\n<li>结语</li>\n<li>参考</li>\n</ul>\n<br />\n<section>\n    <a href=\"https://img.zhikestreet.com/2026-01-01_165557_428.png?imageView2/0/q/75|watermark/2/text/NTJJbnRlcnZpZXc=/font/5a6L5L2T/fontsize/240/fill/IzBFMDkwNQ==/dissolve/100/gravity/SouthEast/dx/10/dy/10\" rel=\"noopener nofollow\"><img alt=\"\" src=\"https://img.zhikestreet.com/2026-01-01_165557_428.png?imageView2/0/q/75|watermark/2/text/NTJJbnRlcnZpZXc=/font/5a6L5L2T/fontsize/240/fill/IzBFMDkwNQ==/dissolve/100/gravity/SouthEast/dx/10/dy/10\" style=\"display: block; margin-left: auto; margin-right: auto;\" /></a>\n</section> \n<br />\n<h3 id=\"前言\">前言</h3>\n<blockquote>\n<p>不是先学好了再干，而是干起来再学习，干就是学习。——《毛选》</p>\n</blockquote>\n<p>2025年，对于笔者而言，是极不平凡的一年。</p>\n<p>这一年，有快乐、有焦虑、有遗憾、有成长。</p>\n<p><strong>忙碌了一整年，回顾了这一年的经历，笔者对主要工作做了梳理和总结，同时要有一些自己的感悟,或许能与您产生共鸣。</strong></p>\n<h3 id=\"职场人的核心竞争力是什么\">职场人的核心竞争力是什么</h3>\n<blockquote>\n<p>对大部分企业而言，增长才是的核心竞争力,技术不是。</p>\n</blockquote>\n<p>在很多年的技术职业生涯中，笔者曾坚定地认为把产品做好，技术方案做好，兢兢业业，持续迭代，就一定能赢得公司的认可。(请参考<a href=\"https://www.52interview.com/solutions/31\" rel=\"noopener nofollow\" target=\"_blank\">《技术更迭，一往无前》</a>)</p>\n<p>然而,随着工作年限的增长,发现很多企业并不这么认为。他们更看重的是业绩的增长,技术只是实现增长的手段之一。</p>\n<p><strong>结论：让业绩增长才是职场人的核心竞争力。</strong></p>\n<h3 id=\"拥抱ai拥抱大模型\">拥抱AI，拥抱大模型</h3>\n<blockquote>\n<p>一定不能让自己被AI列车甩下，无论是玩还是工作，一定要经常使用它们。</p>\n</blockquote>\n<p>2025年的年初，deepseek-r1的强势发布，让AI大模型在业界引起了轩然大波，各个行业开始纷纷拥抱AI大模型。</p>\n<p>2025年的年末，Manus被Meta收购，在科技界十分轰动。</p>\n<p>过去，我们认为AI只是个玩具，离自己很远。</p>\n<p>而现在，它已经能够做具体的工作了。</p>\n<h3 id=\"尝试自媒体\">尝试自媒体</h3>\n<blockquote>\n<p>转型，不一定非的转行。</p>\n</blockquote>\n<p>2025年的国庆节后，笔者开始做视频号。</p>\n<p>主要基于两点考虑：</p>\n<ul>\n<li>希望能够突破自我，拓宽自己的视野。</li>\n<li>培养兴趣、爱好，丰富自己的生活。</li>\n</ul>\n<p>干技术工作十几年了，如果只是沉浸在技术领域,那未免有些枯燥。<br />\n何况，生活不止是工作，还有诗和远方。</p>\n<br />\n<section>\n    <a href=\"https://img.zhikestreet.com/2026-01-01_160015_444-min.png?imageView2/0/q/75|watermark/2/text/NTJJbnRlcnZpZXc=/font/5a6L5L2T/fontsize/240/fill/IzBFMDkwNQ==/dissolve/100/gravity/SouthEast/dx/10/dy/10\" rel=\"noopener nofollow\"><img alt=\"\" src=\"https://img.zhikestreet.com/2026-01-01_160015_444-min.png?imageView2/0/q/75|watermark/2/text/NTJJbnRlcnZpZXc=/font/5a6L5L2T/fontsize/240/fill/IzBFMDkwNQ==/dissolve/100/gravity/SouthEast/dx/10/dy/10\" style=\"display: block; margin-left: auto; margin-right: auto;\" /></a>\n</section> \n<br />\n<br />\n<section>\n    <a href=\"https://img.zhikestreet.com/2026-01-01_160113_397.png?imageView2/0/q/75|watermark/2/text/NTJJbnRlcnZpZXc=/font/5a6L5L2T/fontsize/240/fill/IzBFMDkwNQ==/dissolve/100/gravity/SouthEast/dx/10/dy/10\" rel=\"noopener nofollow\"><img alt=\"\" src=\"https://img.zhikestreet.com/2026-01-01_160113_397.png?imageView2/0/q/75|watermark/2/text/NTJJbnRlcnZpZXc=/font/5a6L5L2T/fontsize/240/fill/IzBFMDkwNQ==/dissolve/100/gravity/SouthEast/dx/10/dy/10\" style=\"display: block; margin-left: auto; margin-right: auto;\" /></a>\n</section> \n<br />\n<p>做视频很花心思，也很有挑战性，也没啥收益。<br />\n每次期待有粉丝关注，也算是一种成就感。</p>\n<h3 id=\"读毛选\">读毛选</h3>\n<blockquote>\n<p>内心强大才是真正的强大。</p>\n</blockquote>\n<p>2025年，职场遭遇困境，几乎快要到了面临抉择的时候，笔者开始阅读《毛选》。<br />\n就这样，深一脚，浅一脚挺了过来。</p>\n<p>不管是企业还是个人，都有遇到困难的时候。</p>\n<p>有时候，逃避问题很容易，直面问题需要莫大的勇气。</p>\n<p>\"贵人成全你，小人成就你。\"，经历过风雨的人，深有感受。</p>\n<section>\n    <a href=\"https://img.zhikestreet.com/20260101162415_666_2-min.png?imageView2/0/q/75|watermark/2/text/NTJJbnRlcnZpZXc=/font/5a6L5L2T/fontsize/240/fill/IzBFMDkwNQ==/dissolve/100/gravity/SouthEast/dx/10/dy/10\" rel=\"noopener nofollow\"><img alt=\"\" src=\"https://img.zhikestreet.com/20260101162415_666_2-min.png?imageView2/0/q/75|watermark/2/text/NTJJbnRlcnZpZXc=/font/5a6L5L2T/fontsize/240/fill/IzBFMDkwNQ==/dissolve/100/gravity/SouthEast/dx/10/dy/10\" style=\"display: block; margin-left: auto; margin-right: auto;\" /></a>\n</section> \n<br />\n<section>\n    <a href=\"https://img.zhikestreet.com/1767255242289-min.jpg?imageView2/0/q/75|watermark/2/text/NTJJbnRlcnZpZXc=/font/5a6L5L2T/fontsize/240/fill/IzBFMDkwNQ==/dissolve/100/gravity/SouthEast/dx/10/dy/10\" rel=\"noopener nofollow\"><img alt=\"\" src=\"https://img.zhikestreet.com/1767255242289-min.jpg?imageView2/0/q/75|watermark/2/text/NTJJbnRlcnZpZXc=/font/5a6L5L2T/fontsize/240/fill/IzBFMDkwNQ==/dissolve/100/gravity/SouthEast/dx/10/dy/10\" style=\"display: block; margin-left: auto; margin-right: auto;\" /></a>\n</section> \n<br />\n<h3 id=\"写过的文章\">写过的文章</h3>\n<blockquote>\n<p>经验创造价值，分享成就未来。</p>\n</blockquote>\n<ul>\n<li><a href=\"https://www.cnblogs.com/lucky_hu/collections/29080\" target=\"_blank\">《AI工作流实战》</a></li>\n</ul>\n<br />\n<section>\n    <a href=\"https://www.52interview.com/book/100\" rel=\"noopener nofollow\"><img alt=\"\" src=\"https://img.zhikestreet.com/2026-01-01_164320_875.png\" style=\"display: block; margin-left: auto; margin-right: auto;\" /></a>\n</section> \n<br />\n<h3 id=\"结语\">结语</h3>\n<blockquote>\n<p>我们都在奔跑,但是短暂地停下来思考,是为了更好地再出发。</p>\n</blockquote>\n<p>过去的一年，为了\"柴米油盐、三餐四季\"忙碌奔波。</p>\n<p>新的一年，希望可以多一点战略思考，发掘更多个人的潜力和强项，突破发展瓶颈，找到属于自己的赛道。</p>\n<p>以上只是笔者个人的一点点浅见,有理解不对的地方，请大家多多包含和指正。</p>\n<h3 id=\"致谢\">致谢</h3>\n<p>最后，分享一首《踏莎行·元旦》，祝您在新的一年里，一路向阳，温暖前行，万事无忧。</p>\n<blockquote>\n<p>爆竹庭前，树桃门右。香汤浴罢，五更后。高烧银烛，瑞烟喷金兽。萱堂次第了，相为寿。<br />\n改岁宜新、应时纳祐。从今诸事愿、胜如旧。人生强健，喜一年入手。休辞最后饮，酴酥酒。</p>\n</blockquote>\n<br />\n<section>\n <a href=\"https://www.52interview.com/\" rel=\"noopener nofollow\" target=\"_blank\"><img alt=\"\" src=\"https://img.zhikestreet.com/20210522-22216942.jpg\" style=\"display: block; margin-left: auto; margin-right: auto;\" /></a>\n</section> \n<br />\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-01 17:27</span>&nbsp;\n<a href=\"https://www.cnblogs.com/lucky_hu\">楠木大叔</a>&nbsp;\n阅读(<span id=\"post_view_count\">75</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "实用程序：解放双手！Python 打造 PDF 手写模拟器，轻松搞定手写作业",
      "link": "https://www.cnblogs.com/ChenAI-TGF/p/19430267",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/ChenAI-TGF/p/19430267\" id=\"cb_post_title_url\" title=\"发布于 2026-01-01 15:59\">\n    <span>实用程序：解放双手！Python 打造 PDF 手写模拟器，轻松搞定手写作业</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        本文介绍了一款基于Python开发的PDF手写模拟工具，可自动将电子文本转换为逼真手写效果并填充至PDF指定区域。该工具支持中英文独立配置字体、大小、颜色等参数，通过随机扰动算法模拟真实手写的行倾斜、字符偏移等不规则特性。用户可通过可视化界面框选填写区域、实时预览效果并保存配置模板。技术实现采用PyMuPDF处理PDF核心操作，结合tkinter构建GUI界面，Pillow实现图像渲染。开源项目地址已提供，可帮助学生高效完成手写作业需求，显著提升工作效率。\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"前言\">前言</h1>\n<p>作为学生，想必大家都有过被海量手写实验报告、课程作业支配的痛苦。要花费大量时间一笔一划地抄写到纸质文档中再进行扫描成pdf提交，不仅耗时耗力，手写的字迹还可能参差不齐，影响作业美观度。</p>\n<p>为了偷懒，博主开发了一款基于python的PDF手写模拟器，它能够模拟真实手写笔迹，将电脑上的文字批量填充到 PDF 指定区域，支持中文/英文分开配置、手写扰动效果自定义、配置模版复用等功能，生成的效果高度贴近真实手写，帮你彻底告别手动抄写的烦恼。首先来个界面以及效果预览：</p>\n<p><strong>代码已经开源在Github：<a href=\"https://github.com/ChenAI-TGF/PDF_HandWrite\" rel=\"noopener nofollow\" target=\"_blank\">https://github.com/ChenAI-TGF/PDF_HandWrite</a><br />\n欢迎大家下载，如果觉得有用的话可以给我点个Star，万分感谢！！<br />\n如果登不上Github的话也欢迎直接私信博主要代码</strong></p>\n<p><img alt=\"在这里插入图片描述\" class=\"lazyload\" /></p>\n<h2 id=\"流程思路总览\">流程思路总览</h2>\n<p>这款 PDF 手写模拟器的整体运作流程可以分为「用户操作流程」和「技术实现流程」两层，清晰易懂：</p>\n<h2 id=\"1--用户操作流程简单易上手\">1.  用户操作流程（简单易上手）</h2>\n<ol>\n<li>\n<p>打开目标 PDF：选择需要填写的实验报告、作业等 PDF 文件；<br />\n<img alt=\"在这里插入图片描述\" class=\"lazyload\" /><br />\n<img alt=\"在这里插入图片描述\" class=\"lazyload\" /></p>\n</li>\n<li>\n<p>框选填写区域：在 PDF 预览界面拖动鼠标，框选出需要插入文字的区域（红色矩形标记）；<br />\n<img alt=\"在这里插入图片描述\" class=\"lazyload\" /></p>\n</li>\n<li>\n<p>配置手写参数：分别在中文、英文/数字选项卡中调整字体、大小、颜色、扰动效果等参数；<br />\n<img alt=\"在这里插入图片描述\" class=\"lazyload\" /></p>\n</li>\n<li>\n<p>输入并预览文字：在右侧文本框输入需要填写的内容，开启「实时预览」查看手写效果；<br />\n<img alt=\"在这里插入图片描述\" class=\"lazyload\" /><br />\n<img alt=\"在这里插入图片描述\" class=\"lazyload\" /></p>\n</li>\n<li>\n<p>不满意可实时调整参数<br />\n<img alt=\"在这里插入图片描述\" class=\"lazyload\" /></p>\n</li>\n<li>\n<p>确认并保存：效果满意后确认应用笔迹，支持撤销、擦除错误内容，也可保存当前配置为模版，最后导出填写完成的 PDF。</p>\n</li>\n</ol>\n<p><img alt=\"在这里插入图片描述\" class=\"lazyload\" /></p>\n<h3 id=\"2--技术实现流程分层协作\">2.  技术实现流程（分层协作）</h3>\n<ol>\n<li>UI 交互层：基于 tkinter 搭建可视化界面，提供按钮、选项卡、文本框等交互组件，接收用户操作；</li>\n<li>参数配置层：管理中文/英文手写参数，支持配置保存（JSON）与加载，实现模版复用；</li>\n<li>PDF 操作层：基于 PyMuPDF 实现 PDF 的读取、页面渲染、文字插入、擦除、保存等核心操作；</li>\n<li>手写渲染层：核心逻辑层，实现文字排版、语言区分、手写扰动效果生成，最终将模拟手写文字插入 PDF。</li>\n</ol>\n<pre><code class=\"language-bash\">┌─────────────────────┐\n│  UI交互层（tkinter） │  # 可视化交互，接收操作\n└─────────────┬───────┘\n              ▼\n┌─────────────────────┐\n│  参数配置层（JSON）  │  # 参数管理，模版复用\n└─────────────┬───────┘\n              ▼\n┌─────────────────────┐\n│ PDF操作层（PyMuPDF） │  # PDF核心操作（读写/保存等）\n└─────────────┬───────┘\n              ▼\n┌─────────────────────┐\n│  手写渲染层（核心）  │  # 手写效果生成，文字插入\n└─────────────────────┘\n</code></pre>\n<h1 id=\"涉及的具体技术\">涉及的具体技术</h1>\n<p>这款工具基于 Python 生态的常用库开发，技术栈轻量化且实用性强，核心涉及以下技术：</p>\n<ol>\n<li><strong>tkinter</strong>：Python 内置 GUI 库，无需额外安装，负责搭建整个应用的可视化界面，实现按钮点击、参数调整、文本输入、PDF 预览等交互功能；</li>\n<li><strong>PyMuPDF（fitz）</strong>：核心 PDF 处理库，提供高效的 PDF 读取、写入、页面渲染、文字插入、红act标注（擦除功能）等接口，是实现 PDF 编辑的核心依赖；</li>\n<li><strong>Pillow（PIL）</strong>：图像处理库，将 PyMuPDF 渲染出的 PDF 页面像素数据，转换成 tkinter 画布可显示的图像格式，实现 PDF 页面的可视化预览；</li>\n<li><strong>JSON</strong>：轻量级数据格式，用于保存用户配置的手写参数模版（字体、大小、扰动值等），方便后续直接复用，无需重复调整；</li>\n<li><strong>Python 随机数与数学计算</strong>：实现手写效果的「不规则扰动」，模拟真实手写的位置偏移、大小波动、行倾斜等特性；</li>\n<li><strong>TTF 字体支持</strong>：读取自定义 TrueType 字体文件，支持切换不同手写风格字体，适配不同用户的手写习惯。</li>\n</ol>\n<h1 id=\"最终效果演示\">最终效果演示</h1>\n<p><img alt=\"在这里插入图片描述\" class=\"lazyload\" /></p>\n<h1 id=\"代码原理简单讲解手写字体生成--扰动效果\">代码原理简单讲解（手写字体生成 + 扰动效果）</h1>\n<p>我们重点讲解核心功能 —— 手写字体生成与扰动效果的实现，忽略 UI 搭建等辅助代码，聚焦核心逻辑：</p>\n<h2 id=\"一-手写字体生成文字插入-pdf-核心\">一、 手写字体生成（文字插入 PDF 核心）</h2>\n<p>这部分的核心是将文字按规则排版后，插入到 PDF 指定区域，关键步骤如下：</p>\n<ol>\n<li>\n<p><strong>文字与区域预处理</strong><br />\n首先获取文本框中的输入文字，按换行符 <code>\\n</code> 分割成多行，同时将用户框选的预览区域坐标（带缩放比例）转换为 PDF 实际坐标（除以缩放系数 <code>self.zoom</code>），得到真实的填写范围 <code>(x1, y1, x2, y2)</code>。</p>\n<pre><code class=\"language-python\"># 读取输入文字并分割行\ntext = self.text_editor.get(\"1.0\", tk.END).strip(\"\\n\")\nlines = text.split('\\n')\n# 转换为 PDF 实际坐标（去除预览缩放影响）\nx1, y1 = min(self.start_x, self.end_x)/self.zoom, min(self.start_y, self.end_y)/self.zoom\nx2, y2 = max(self.start_x, self.end_x)/self.zoom, max(self.start_y, self.end_y)/self.zoom\n</code></pre>\n</li>\n<li>\n<p><strong>语言区分与参数匹配</strong><br />\n通过 <code>is_chinese</code> 函数判断单个字符是中文还是英文/数字，分别匹配对应的配置参数（中文/英文独立的字体、大小、字距等），确保不同语言的手写效果适配合理。</p>\n<pre><code class=\"language-python\"># 判断是否为中文（含中文标点）\ndef is_chinese(self, char):\n    if '\\u4e00' &lt;= char &lt;= '\\u9fff': return True\n    if char in \"。，、？！：；“”‘’（）《》【】\": return True\n    return False\n\n# 遍历字符时匹配对应语言参数\nlang = 'zh' if self.is_chinese(char) else 'en'\np = self.params[lang]  # 获取对应语言的配置参数\n</code></pre>\n</li>\n<li>\n<p><strong>PDF 文字插入核心 API</strong><br />\n使用 PyMuPDF 的 <code>page.insert_text</code> 方法实现文字插入，这是手写字体生成的关键，核心参数说明如下：</p>\n<ul>\n<li><code>fitz.Point(final_x, final_y)</code>：文字的实际插入坐标（经排版和扰动调整后）；</li>\n<li><code>char</code>：要插入的单个字符（逐字符插入实现精细排版）；</li>\n<li><code>fontsize</code>：字符的实际大小（带大小抖动）；</li>\n<li><code>fontfile</code>：TTF 手写字体文件路径，决定字体风格；</li>\n<li><code>color</code>：文字颜色（默认纯黑，支持用户自定义）；</li>\n<li><code>morph</code>：变换矩阵，实现字符旋转效果（叠加行倾斜与字符旋转抖动）。</li>\n</ul>\n</li>\n<li>\n<p><strong>行与字符排版</strong><br />\n按行遍历文字，逐字符计算插入坐标，处理空格（单独预留间距），当字符横坐标超出框选区域右侧时自动换行，同时根据「行距参数」调整下一行的纵坐标，确保文字排版规整且不超出框选范围。</p>\n</li>\n</ol>\n<h2 id=\"二-扰动效果实现模拟真实手写不规则性\">二、 扰动效果实现（模拟真实手写不规则性）</h2>\n<p>这是工具的灵魂所在，通过「行级扰动」和「字符级扰动」两层效果，彻底摆脱打印体的规整感，贴近真实手写，对应代码中的配置参数：</p>\n<ol>\n<li>\n<p><strong>行级扰动（整行不规则性）</strong><br />\n针对每一行文字，添加整体的偏移和倾斜，模拟手写时「行不直、略有偏移」的特点，对应三个参数：</p>\n<ul>\n<li>行左右平移（<code>line_jitter_x</code>）：随机生成 <code>-line_jitter_x ~ line_jitter_x</code> 范围内的偏移量 <code>line_dx</code>，使每行文字左右轻微晃动；</li>\n<li>行上下平移（<code>line_jitter_y</code>）：随机生成 <code>-line_jitter_y ~ line_jitter_y</code> 范围内的偏移量 <code>line_dy</code>，使行与行之间的间距略有差异；</li>\n<li>行整行倾斜（<code>line_tilt</code>）：随机生成倾斜角度 <code>line_angle_deg</code>，转换为弧度后，通过 <code>tilt_y_offset = (curr_x - line_start_x) * math.tan(line_angle_rad)</code> 计算每个字符的Y轴偏移，实现整行轻微倾斜。</li>\n</ul>\n<pre><code class=\"language-python\"># 行级扰动参数计算\nline_dx = random.uniform(-p_line['line_jitter_x'].get(), p_line['line_jitter_x'].get())\nline_dy = random.uniform(-p_line['line_jitter_y'].get(), p_line['line_jitter_y'].get())\nline_angle_deg = random.uniform(-p_line['line_tilt'].get(), p_line['line_tilt'].get())\nline_angle_rad = math.radians(line_angle_deg)\n</code></pre>\n</li>\n<li>\n<p><strong>字符级扰动（单个字符不规则性）</strong><br />\n针对每个字符，添加位置、大小、旋转的细微差异，模拟手写时「每个字大小不一、略有晃动」的特点，对应三个参数：</p>\n<ul>\n<li>字位置抖动（<code>jitter_pos</code>）：随机生成 <code>(-jitter_pos ~ jitter_pos)</code> 的X、Y偏移量，使字符脱离严格的水平对齐；</li>\n<li>字大小抖动（<code>jitter_size</code>）：在基础字体大小上，随机增减 <code>(-jitter_size ~ jitter_size)</code> 的数值，生成 <code>char_jitter_fs</code>，使字符大小略有差异；</li>\n<li>字旋转抖动（<code>jitter_rot</code>）：随机生成 <code>(-jitter_rot ~ jitter_rot)</code> 的旋转角度，叠加行倾斜角度后，通过 <code>morph</code> 参数实现字符轻微旋转。</li>\n</ul>\n<pre><code class=\"language-python\"># 字符级扰动参数计算\nchar_jitter_x = random.uniform(-p['jitter_pos'].get(), p['jitter_pos'].get())\nchar_jitter_y = random.uniform(-p['jitter_pos'].get(), p['jitter_pos'].get())\nchar_jitter_rot = random.uniform(-p['jitter_rot'].get(), p['jitter_rot'].get())\nchar_jitter_fs = f_size + random.uniform(-p['jitter_size'].get(), p['jitter_size'].get())\n</code></pre>\n</li>\n<li>\n<p><strong>随机数控制（预览稳定 + 实际随机）</strong><br />\n为了保证实时预览时效果稳定可调整，设置随机数种子 <code>random.seed(42)</code> 固定扰动效果；实际应用笔迹时，不设置种子 <code>random.seed()</code>，生成随机的扰动效果，让每次生成的手写风格略有差异，更贴近真实场景。</p>\n<pre><code class=\"language-python\">if is_preview: random.seed(42)  # 预览模式：固定随机数，效果稳定\nelse: random.seed()  # 实际生成：随机种子，效果更真实\n</code></pre>\n</li>\n</ol>\n<h1 id=\"总结\">总结</h1>\n<p>这款 PDF 手写模拟器完美解决了手写作业、实验报告的痛点，兼具「实用性」和「灵活性」：</p>\n<ol>\n<li><strong>实用性拉满</strong>：无需手动抄写，一键生成手写风格 PDF，节省大量时间和精力，生成效果高度贴近真实手写；</li>\n<li><strong>自定义性强</strong>：中文/英文独立配置，支持字体、颜色、大小、字距行距调整，多层扰动参数可精细调控手写风格；</li>\n<li><strong>操作便捷</strong>：可视化界面友好，支持实时预览、撤销、擦除、模版复用，零基础用户也能快速上手；</li>\n<li><strong>技术轻量化</strong>：基于 Python 常用库开发，无需复杂环境配置，代码可灵活修改扩展。</li>\n</ol>\n<p>当然，这款工具还有优化空间，比如支持连笔效果、笔迹粗细变化、批量处理多个 PDF 等。如果大家有类似需求，可以基于这份代码进行二次开发，适配自己的使用场景。希望这款工具能帮大家解放双手，把更多时间投入到核心学习和研究中！</p>\n<p><strong>代码已经开源在Github：<a href=\"https://github.com/ChenAI-TGF/PDF_HandWrite\" rel=\"noopener nofollow\" target=\"_blank\">https://github.com/ChenAI-TGF/PDF_HandWrite</a><br />\n欢迎大家下载，如果觉得有用的话可以给我点个Star，万分感谢！！<br />\n如果登不上Github的话也欢迎直接私信博主要代码</strong></p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-01 15:59</span>&nbsp;\n<a href=\"https://www.cnblogs.com/ChenAI-TGF\">TTGF</a>&nbsp;\n阅读(<span id=\"post_view_count\">78</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "Perigon.CLI 10.0 重磅发布【AspNetCore开发模板和辅助工具】",
      "link": "https://www.cnblogs.com/msdeveloper/p/19430150/perigon-10-announce",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/msdeveloper/p/19430150/perigon-10-announce\" id=\"cb_post_title_url\" title=\"发布于 2026-01-01 15:18\">\n    <span>Perigon.CLI 10.0 重磅发布【AspNetCore开发模板和辅助工具】</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"-perigoncli-100-重磅发布\">🎉 Perigon.CLI 10.0 重磅发布</h1>\n<p><img alt=\"perigon_logo320\" src=\"https://img2024.cnblogs.com/blog/1074783/202601/1074783-20260101151334306-54452182.png\" /></p>\n<p>我们很高兴地宣布，Perigon.CLI 10.0 现已正式发布！此次更新带来了众多令人兴奋的新功能和改进，旨在提升开发者的生产力和开发体验。</p>\n<p>简而言之，Perigon是围绕<code>Aspire/AspNetCore/EF Core</code>等相关技术栈的开发辅助工具，帮助你快速构建可维护的项目，它主要提供：</p>\n<ul>\n<li><strong>项目脚手架</strong>：通过解决方案模板(Perigon.templates)，快速创建符合最佳实践的项目结构。</li>\n<li><strong>代码生成器</strong>：提供WebUI界面，用来通过实体来生成对应的增删改查代码，以及客户端请求服务的生成，极大减少重复劳动；同时提供自定义模板功能，满足不同项目需求。</li>\n<li><strong>MCP</strong>: 提供MCP支持，以与现有IDE中的AI集成。</li>\n<li><strong>命令行工具</strong>：用来创建解决方案/启动WebUI/生成客户端请求服务等。</li>\n</ul>\n<h2 id=\"由来\">由来</h2>\n<p>最初，它只是我个人在开发前后端项目时，为了减少重复劳动而开发的简单的项目分层脚手架和代码生成工具。当时(2020年)它叫<code>GT.CLI</code>和<code>GT.Framework.Web</code>。</p>\n<p>2021年，重构了结构，并开始在团队项目中使用，模板改名为<code>ater.web.templates</code>，CLI工具也经过两次大改，分别为<code>ater.droplet.cli</code>和<code>ater.dry</code>，它加入了一些公司内项目需求的功能，如提供更多开箱即用的模块。</p>\n<blockquote>\n<p>[!TIP]<br />\n以上工具可在<code>nuget</code>中找到，但都不再维护。</p>\n</blockquote>\n<h2 id=\"-现在\">✨ 现在</h2>\n<p>2025年.NET10发布，在年初，我开始计划进行全面的重构和优化，提供一个全新的版本，完全基于.NET10，不再兼容之前的版本，经过数月的开发和测试，最终发布了<code>Perigon.CLI</code>和<code>Perigon.templates</code>，该版本主要的特点包括：</p>\n<ul>\n<li>\n<p>操作界面从<code>Angular</code>改为<code>Blazer server</code>，使用<code>fluent-ui</code>组件库，从技术到视觉上都更贴近<code>NET</code>生态。</p>\n</li>\n<li>\n<p>在项目结构上，去复杂化，更加通用。去除了以下设计</p>\n<ul>\n<li><code>仓储模式</code></li>\n<li>默认使用<code>QueryDbContext</code>和<code>CommandDbContext</code>的设计，需要多一层DataAccess来抽象。</li>\n<li>默认生成业务接口类</li>\n<li><code>[Module]</code>特性，直接使用目录结构来区分模块</li>\n<li>其他不必要的抽象和复杂设计</li>\n</ul>\n</li>\n<li>\n<p>重构项目结构，并添加了更多通用和实用的功能</p>\n<ul>\n<li>引入Aspire：解决开发环境基础设施和多服务支持问题</li>\n<li>多服务支持：结合单体和微服务，一个解决方案都搞定</li>\n<li>多租户支持：通过配置在单租户和多租户间切换</li>\n<li>多数据库支持：通过工厂模式支持多种数据库</li>\n<li>多语言支持：内置多语言支持，方便国际化</li>\n<li>MCP支持：直接在IDE中调用工具生成代码</li>\n<li>源代码生成器支持(多语言和自动注入Manager)</li>\n</ul>\n</li>\n</ul>\n<p>更为重要的是，新版本确定了一些核心设计原则：</p>\n<ul>\n<li>通用且开放：不依托于特定设计模式或架构，优先使用通用且成熟的技术栈</li>\n<li>简单易用：不引入新的设计模式或理论，降低学习成本和心智负担</li>\n<li>以开发者为中心：提高开发效率和使用体验是主要目标</li>\n</ul>\n<p>现在，你可以通过我们的📚<a href=\"https://dusi.dev/docs/Perigon.html\" rel=\"noopener nofollow\" target=\"_blank\">官方文档</a>，了解如何安装和使用<code>Perigon.CLI</code>，并开始你的高效开发之旅！</p>\n<h2 id=\"未来\">🚀未来</h2>\n<p>未来将在三个方面持续改进：</p>\n<ul>\n<li>生产力。如今我们通过IDE和代码生成器避免重复性的工作。而今年使用code agent编程已经是非常平常的事情，其能力和效果无需多言，虽然还有些局限性，但其能力还在不断提升。我们会将更多AI编程的实践经验融入到工具中，进一步提升开发效率和开发体验。</li>\n<li>性能。在保持模板框架稳定的基础上，尽可能的提升性能，完善性能方面的最佳实践(文档说明)。</li>\n<li>生态。我们将基于<code>perigon</code>构建更多的内容，如身份验证系统，AIAgent系统等，也就是在基础框架的基础上，提供更多面向特定场景的解决方案。此外，还将尝试对模块进行打包和分发，进一步提高复用性和可维护性。</li>\n</ul>\n<h3 id=\"版本计划\">版本计划</h3>\n<p>对于<code>Perigon.CLI</code>，它将跟随<code>.NET</code>的版本迭代进行更新，计划每年发布一个大版本，单数版本会同时支持上一个LTS版本，偶数版本只支持当前LTS版本。</p>\n<p>对于``Perigon.templates<code>，它从</code>1.0.0`开始，由于它影响整个项目的结构和技术选型，未来主要专注于问题修复和性能提升。新的功能特性尽可能在不改变现有结构的前提下进行添加。</p>\n<h2 id=\"️️社区参与\">🏃‍♂️‍➡️社区参与</h2>\n<p>如果你对.NET开发有兴趣，并希望参与到Perigon.CLI的建设中来，欢迎访问我们的<a href=\"https://github.com/AterDev/Perigon.CLI\" rel=\"noopener nofollow\" target=\"_blank\">GitHub仓库</a>，提交你的想法、建议或贡献代码。我们期待与你一起打造更好的开发工具！</p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-01 15:18</span>&nbsp;\n<a href=\"https://www.cnblogs.com/msdeveloper\">TypingLearn</a>&nbsp;\n阅读(<span id=\"post_view_count\">81</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "2025年度总结",
      "link": "https://www.cnblogs.com/SilverGo/p/19428614",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/SilverGo/p/19428614\" id=\"cb_post_title_url\" title=\"发布于 2025-12-31 22:47\">\n    <span>2025年度总结</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"table-of-contents\">Table of Contents</h1>\n<ol>\n<li><a href=\"#org936be25\" rel=\"noopener nofollow\">2025年度总结</a></li>\n<li><a href=\"#org07aceb4\" rel=\"noopener nofollow\">关于Ctorch</a></li>\n<li><a href=\"#orgc1859ea\" rel=\"noopener nofollow\">关于CSP-J</a></li>\n<li><a href=\"#org1d85aae\" rel=\"noopener nofollow\">关于lambda演算、UTM（通用图灵机）、Coq</a></li>\n<li><a href=\"#org9a42a9e\" rel=\"noopener nofollow\">关于汇编</a></li>\n<li><a href=\"#orgabafce1\" rel=\"noopener nofollow\">一些感想</a></li>\n<li><a href=\"#org89cb23b\" rel=\"noopener nofollow\">资料</a></li>\n<li><a href=\"#org3319ea0\" rel=\"noopener nofollow\">结语</a></li>\n</ol>\n<p>Powered by GhostFace's Emacs.</p>\n<p><a id=\"org936be25\"></a></p>\n<h1 id=\"2025年度总结\">2025年度总结</h1>\n<p><a id=\"org07aceb4\"></a></p>\n<h2 id=\"关于ctorch\">关于Ctorch</h2>\n<p><strong>Ctorch 诞生的第166天。</strong><br />\n没想到，ct都这么大了，<strong>从一个单人项目到现在4人的小团队，从一个模糊的想法到如今近万行的代码，总计5个月13天。</strong></p>\n<p>不得不说，这段时间，学到了很多。</p>\n<p><strong>从来没有用过git的人，commit了近160次；<br />\n从来没有接触过汇编的人，为了极限优化、搞懂编译器行为，学了2个月的汇编；<br />\n曾经连类都没写过的人，写了5个几千行的类；<br />\n曾经连朴素矩阵乘都不会写的菜鸡，手搓了一个Strassen+分块的并行矩阵乘</strong>；<br />\n诸如此类，不再列举。</p>\n<p><a id=\"orgc1859ea\"></a></p>\n<h2 id=\"关于csp-j\">关于CSP-J</h2>\n<p>本蒟蒻已经很长时间没有更新过日志了，可能的原因是比较忙。</p>\n<p><strong>最近几个月，本人一直在忙CSP-J的准备、Ctorch的开发、Coq的学习与lambda演算上。<br />\n先在暑假发起了「挑战3个月达省一」的挑战（当然，挑战成功了）</strong>；</p>\n<p>这一段时间，刷的题比我之前一年刷的都多；</p>\n<p>20多天，我学习了：<strong>dp、图论、并查集、加权并查集、模拟退火等算法，之前一年也只学了排序；</strong></p>\n<p><strong>怎么说呢，之前一直没搞清楚的搜索算法，现在看来也不过如此。</strong></p>\n<p><a id=\"org1d85aae\"></a></p>\n<h2 id=\"关于lambda演算utm通用图灵机coq\">关于lambda演算、UTM（通用图灵机）、Coq</h2>\n<p>随后，先是因为知道了C++有个叫lambda表达式的东西，随后在洛谷上搜索，<strong>意外看到了一篇讲lambda演算的文章</strong>；</p>\n<p>抱着在学校上课无聊的心态，学习了lambda演算，结果一发不可收拾。</p>\n<p>学完之后，我得知<strong>lambda演算图灵完备，于是乎，我想起了一个好玩的东西：用无类型lambda演算手搓UTM（通用图灵机），这当然理论可行</strong>。</p>\n<p>反正我平时能够思考的时间很多，在问过AI后，得知这是一次非常困难但是收获极大的挑战，我便开始了我的构建。</p>\n<p><strong>一支笔，一个本，一个脑子，不看论文，不搜索，只思考。<br />\n每天上放学的路上，走着需要35min左右，这段时间，我就会不停地思考关于UTM的问题。<br />\n这个过程很爽，因为我在构建一个完整的世界，理论上，这台「仅仅依靠代入完成计算」的“计算机”可以完成任何工作，只要你想，甚至可以跑一个仿真的Windows.</strong></p>\n<p>写了快几十张纸，我才明白，AI说的那句：<strong>「lambda演算可以练习思维」</strong>，突然有一天，我看待调用、递归的感觉完全变了，我看函数的感觉也变了。</p>\n<p><strong>我们都觉得，是先有了数字，才有了函数;</strong><br />\n但是，Church数字告诉我们，<strong>数字也是函数</strong>。</p>\n<p>（这个名为LUTM的UTM仍在设计，不过，由于Ctorch对我的优先级更高，目前暂时停工，等2月16日发布Ctorch RC 1之后再继续）</p>\n<p><strong>学习完lambda演算后，我接触到了Coq。<br />\nCoq证明「加法左零律」的思路让我感觉无比震惊，这完全颠覆了我对数学归纳法的认知</strong>。</p>\n<p><strong>而且，Coq中对自然数的定义和lambda演算的列表出奇的一致。<br />\n怎么说呢，可能这就是「万变不离其宗」吧.</strong><br />\n但是仍然是为了Ctorch的开发，我暂停了Coq的学习。</p>\n<p><a id=\"org9a42a9e\"></a></p>\n<h2 id=\"关于汇编\">关于汇编</h2>\n<p>在这之后，我学习了Arm64汇编。<br />\n仅仅是写出一个Hello World，我就花了2天（当然，我在学校每天只有10min能用电脑，20min可以和AI对话）.<br />\n但仅此一次，我就明白了，C++中递归、调用是如何做的，本质其实就是将x29,x30寄存器的值修改；<br />\n我也明白了，什么是「栈溢出」，什么是「调用栈」。<br />\n几行的C++换成汇编就可能需要数十行，这让我写代码时会思考着汇编的样子。<br />\n不得不说，这确实是一次很好的历练。</p>\n<p><a id=\"orgabafce1\"></a></p>\n<h2 id=\"一些感想\">一些感想</h2>\n<p>回首这几个月我所经历的，可能比我之前一年学的都要多，都要杂；</p>\n<p><strong>这些知识无疑带给了我很强的塑造作用：<br />\n设计LUTM，锻炼了我进行2小时以上的深度思考的能力；<br />\n学习汇编，让我对底层有了掌控；<br />\n学习lambda演算，让我对函数有了更彻底的认识；<br />\n可以说，对一个初中生而言，这条路径独一无二。<br />\n我结识了一群志同道合的朋友，有了自己的团队、组织；<br />\n曾经那个被嘲笑“写这些有什么用”、“连个奖都拿不到”的人，如今竟成为一个开源项目的开发者、CSP-J的省一。</strong><br />\n<strong>毫无疑问，这是无比有价值的半年；</strong></p>\n<p><a id=\"org89cb23b\"></a></p>\n<h1 id=\"资料\">资料</h1>\n<p>下面放一点资料</p>\n<p>1.设计LUTM时与Deepseek的对话：<a href=\"https://chat.deepseek.com/share/wednovjlp5sa013j4q\" rel=\"noopener nofollow\" target=\"_blank\">https://chat.deepseek.com/share/wednovjlp5sa013j4q</a><br />\n2.文章：《恭喜自己，挑战成功》————CSP-J省一获奖感言：<a href=\"https://www.cnblogs.com/SilverGo/p/19223328\" target=\"_blank\">https://www.cnblogs.com/SilverGo/p/19223328</a><br />\n3.文章：《逆袭导论·初中生的宝书》：<a href=\"https://www.cnblogs.com/SilverGo/p/19284999\" target=\"_blank\">https://www.cnblogs.com/SilverGo/p/19284999</a><br />\n4.文章：《矩阵乘法优化》：<a href=\"https://www.cnblogs.com/SilverGo/p/19019364\" target=\"_blank\">https://www.cnblogs.com/SilverGo/p/19019364</a><br />\n5.Ctorch的github：<a href=\"https://github.com/ShengFlow/CTorch/tree/feature-nn.Module?tab=contributing-ov-file\" rel=\"noopener nofollow\" target=\"_blank\">https://github.com/ShengFlow/CTorch/tree/feature-nn.Module?tab=contributing-ov-file</a><br />\n6.以下是图片：<br />\n<img alt=\"截屏2025-12-28 10.22.19\" height=\"982\" src=\"https://img2024.cnblogs.com/blog/3357339/202512/3357339-20251231224442471-111964913.png\" width=\"1512\" /><br />\n<img alt=\"截屏2025-12-18 06.31.21\" height=\"982\" src=\"https://img2024.cnblogs.com/blog/3357339/202512/3357339-20251231224520016-1653169643.png\" width=\"1512\" /><br />\n<img alt=\"截屏2025-10-04 16.25.21\" height=\"982\" src=\"https://img2024.cnblogs.com/blog/3357339/202512/3357339-20251231224619686-610660255.png\" width=\"1512\" /></p>\n<p><a id=\"org3319ea0\"></a></p>\n<h1 id=\"结语\">结语</h1>\n<blockquote>\n<p>“Put yourself in places that are gonna cause you to stretch<br />\n让自己置身于能促使自己突破的境地<br /><br />\nA fighter isn't someone that never fails<br />\n真正的勇士并非永不失败<br /><br />\nA fighter is someone who never quits<br />\n而是永不言弃<br /><br />\nYou are more to me than you could never now<br />\n你对我而言远比自己想象的更重要<br /><br />\nAnd I know I've got a full room of fighters in here right<br />\n此刻我深知这满座皆是勇者”<br /></p>\n</blockquote>\n<blockquote>\n<p>“I see ,I like ,I go ,I get.<br />\n目之所及，心之所向，踏上征程，志在必得！”<br /></p>\n</blockquote>\n<blockquote>\n<p>“为天地立心，<br /><br />\n为生民立命，<br /><br />\n为往圣继绝学，<br /><br />\n为万世开太平”————宋·张载《横渠四句》<br /></p>\n</blockquote>\n<blockquote>\n<p>“身处低谷不自弃，我命由我不由天。<br /><br />\n无人扶我青云志，我自踏雪至山巅。<br /><br />\n若是命中无此运，亦可孤身登昆仑。<br /><br />\n红尘赠我三尺剑，酒换瘦马一世街。<br /><br />\n世人朝路乃绝涧，独见众生止步前。<br /><br />\n海到尽头天作岸，山登绝顶我为峰。<br /><br />\n如若东山能再起，大鹏展翅九万里。<br /><br />\n一入红尘梦易真，一朝悟透心境名。<br /><br />\n一朝悟道见真我，昔日枷锁皆云烟。<br /><br />\n天门将至百运开，拂尘轻笑问仙来。<br /><br />\n何须扶我青云志，我自凌云至山巅！”————徐霞客《青云志》<br /></p>\n</blockquote>\n<p><strong>2025，对我而言，注定是难忘的一年.</strong><br />\n<strong>诸位，新年快乐！</strong></p>\n<p><strong>预告：我们预计在2026.2.16（除夕）发布Ctorch RC v1.0，敬请期待，欢迎联系：QQ 1113109729，参与内测，感激不尽！</strong></p>\n<p>GhostFace<br />\n2025.12.31</p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2025-12-31 22:47</span>&nbsp;\n<a href=\"https://www.cnblogs.com/SilverGo\">Ghost-Face</a>&nbsp;\n阅读(<span id=\"post_view_count\">143</span>)&nbsp;\n评论(<span id=\"post_comment_count\">2</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "【大数据 & AI】Flink Agents 源码解读 --- (3) --- Agent",
      "link": "https://www.cnblogs.com/rossiXYZ/p/19369869",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/rossiXYZ/p/19369869\" id=\"cb_post_title_url\" title=\"å‘å¸ƒäºŽ 2025-12-31 19:17\">\n    <span>ã€å¤§æ•°æ® &amp; AIã€‘Flink Agents æºç è§£è¯» --- (3) --- Agent</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                <div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"å¤§æ•°æ®--aiflink-agents-æºç è§£è¯»-----3------agent\">ã€å¤§æ•°æ® &amp; AIã€‘Flink Agents æºç è§£è¯» --- (3) ---  Agent</h1>\n<p></p><div class=\"toc\"><div class=\"toc-container-header\">ç›®å½•</div><ul><li><a href=\"#å¤§æ•°æ®--aiflink-agents-æºç è§£è¯»-----3------agent\" rel=\"noopener nofollow\">ã€å¤§æ•°æ® &amp; AIã€‘Flink Agents æºç è§£è¯» --- (3) ---  Agent</a><ul><li><a href=\"#0x00-æ¦‚è¦\" rel=\"noopener nofollow\">0x00 æ¦‚è¦</a></li><li><a href=\"#0x01-æ ¸å¿ƒæŠ½è±¡\" rel=\"noopener nofollow\">0x01 æ ¸å¿ƒæŠ½è±¡</a><ul><li><a href=\"#11-agentæŠ½è±¡\" rel=\"noopener nofollow\">1.1 AgentæŠ½è±¡</a></li><li><a href=\"#12-action-æŠ½è±¡\" rel=\"noopener nofollow\">1.2 Action æŠ½è±¡</a></li><li><a href=\"#13-èµ„æºæŠ½è±¡\" rel=\"noopener nofollow\">1.3 èµ„æºæŠ½è±¡</a></li><li><a href=\"#14-æ‰§è¡ŒçŽ¯å¢ƒæŠ½è±¡\" rel=\"noopener nofollow\">1.4 æ‰§è¡ŒçŽ¯å¢ƒæŠ½è±¡</a></li><li><a href=\"#15-äº‹ä»¶æŠ½è±¡\" rel=\"noopener nofollow\">1.5 äº‹ä»¶æŠ½è±¡</a></li><li><a href=\"#16-é…ç½®æŠ½è±¡\" rel=\"noopener nofollow\">1.6 é…ç½®æŠ½è±¡</a></li></ul></li><li><a href=\"#0x02-workflow-style-agent-å’Œreactagent\" rel=\"noopener nofollow\">0x02 Workflow Style Agent å’ŒReActAgent</a><ul><li><a href=\"#21-ç‰¹æ€§\" rel=\"noopener nofollow\">2.1 ç‰¹æ€§</a><ul><li><a href=\"#211-è®¾è®¡ç†å¿µ\" rel=\"noopener nofollow\">2.1.1 è®¾è®¡ç†å¿µ</a></li><li><a href=\"#212-æŽ§åˆ¶æµ\" rel=\"noopener nofollow\">2.1.2 æŽ§åˆ¶æµ</a></li><li><a href=\"#213-å®šåˆ¶çº§åˆ«\" rel=\"noopener nofollow\">2.1.3 å®šåˆ¶çº§åˆ«</a></li><li><a href=\"#214-ä½¿ç”¨åœºæ™¯\" rel=\"noopener nofollow\">2.1.4 ä½¿ç”¨åœºæ™¯</a></li><li><a href=\"#215-å¼€å‘å¤æ‚åº¦\" rel=\"noopener nofollow\">2.1.5 å¼€å‘å¤æ‚åº¦</a></li><li><a href=\"#216-æ€»ç»“\" rel=\"noopener nofollow\">2.1.6 æ€»ç»“</a></li></ul></li><li><a href=\"#22-workflow\" rel=\"noopener nofollow\">2.2 workflow</a><ul><li><a href=\"#221-ä»£ç å¯¼è¯»\" rel=\"noopener nofollow\">2.2.1 ä»£ç å¯¼è¯»</a><ul><li><a href=\"#å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ\" rel=\"noopener nofollow\">å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ</a></li><li><a href=\"#åˆ›å»ºä»£ç†\" rel=\"noopener nofollow\">åˆ›å»ºä»£ç†</a></li><li><a href=\"#ä¸Ž-flink-é›†æˆ\" rel=\"noopener nofollow\">ä¸Ž Flink é›†æˆ</a></li></ul></li></ul></li><li><a href=\"#23-react-agent\" rel=\"noopener nofollow\">2.3 ReAct Agent</a><ul><li><a href=\"#231-ä»£ç å¯¼è¯»\" rel=\"noopener nofollow\">2.3.1 ä»£ç å¯¼è¯»</a><ul><li><a href=\"#å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ-1\" rel=\"noopener nofollow\">å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ</a></li><li><a href=\"#åˆ›å»º-react-agent\" rel=\"noopener nofollow\">åˆ›å»º ReAct Agent</a></li><li><a href=\"#ä¸Ž-flink-é›†æˆ-1\" rel=\"noopener nofollow\">ä¸Ž Flink é›†æˆ</a></li></ul></li></ul></li></ul></li><li><a href=\"#0x03-reactagent\" rel=\"noopener nofollow\">0x03 ReActAgent</a><ul><li><a href=\"#31-å®šä¹‰\" rel=\"noopener nofollow\">3.1 å®šä¹‰</a></li><li><a href=\"#32-æ·±åº¦å®šåˆ¶\" rel=\"noopener nofollow\">3.2 æ·±åº¦å®šåˆ¶</a><ul><li><a href=\"#321-reactagent-ç‰¹è‰²\" rel=\"noopener nofollow\">3.2.1 ReActAgent ç‰¹è‰²</a><ul><li><a href=\"#æµå¼å¤„ç†é€‚é…\" rel=\"noopener nofollow\">æµå¼å¤„ç†é€‚é…</a></li><li><a href=\"#ç‰¹å®šçš„è¡Œä¸ºæ¨¡å¼\" rel=\"noopener nofollow\">ç‰¹å®šçš„è¡Œä¸ºæ¨¡å¼</a></li><li><a href=\"#é”®æŽ§çŠ¶æ€æ”¯æŒ\" rel=\"noopener nofollow\">é”®æŽ§çŠ¶æ€æ”¯æŒ</a></li><li><a href=\"#llm-é›†æˆä¼˜åŒ–\" rel=\"noopener nofollow\">LLM é›†æˆä¼˜åŒ–</a></li><li><a href=\"#èµ„æºç®¡ç†æ–¹å¼\" rel=\"noopener nofollow\">èµ„æºç®¡ç†æ–¹å¼</a></li><li><a href=\"#ç±»åž‹ä¿¡æ¯å¤„ç†\" rel=\"noopener nofollow\">ç±»åž‹ä¿¡æ¯å¤„ç†</a></li><li><a href=\"#é”™è¯¯å¤„ç†æœºåˆ¶\" rel=\"noopener nofollow\">é”™è¯¯å¤„ç†æœºåˆ¶</a></li><li><a href=\"#ç»“æž„åŒ–è¾“å‡ºæ”¯æŒ\" rel=\"noopener nofollow\">ç»“æž„åŒ–è¾“å‡ºæ”¯æŒ</a></li><li><a href=\"#æç¤ºè¯æ¨¡æ¿ç³»ç»Ÿ\" rel=\"noopener nofollow\">æç¤ºè¯æ¨¡æ¿ç³»ç»Ÿ</a></li><li><a href=\"#å·¥å…·è°ƒç”¨é›†æˆ\" rel=\"noopener nofollow\">å·¥å…·è°ƒç”¨é›†æˆ</a></li><li><a href=\"#è¿è¡Œæ—¶åä½œ\" rel=\"noopener nofollow\">è¿è¡Œæ—¶åä½œ</a></li></ul></li></ul></li><li><a href=\"#33-å…¸åž‹æ‰§è¡Œæµç¨‹\" rel=\"noopener nofollow\">3.3 å…¸åž‹æ‰§è¡Œæµç¨‹</a></li><li><a href=\"#34-start_action-ä¸Ž-stop_action\" rel=\"noopener nofollow\">3.4 start_action ä¸Ž stop_action</a></li><li><a href=\"#35-è¾“å…¥è¾“å‡º\" rel=\"noopener nofollow\">3.5 è¾“å…¥è¾“å‡º</a><ul><li><a href=\"#351-äº‹ä»¶é©±åŠ¨æž¶æž„\" rel=\"noopener nofollow\">3.5.1 äº‹ä»¶é©±åŠ¨æž¶æž„</a></li><li><a href=\"#352-ç»Ÿä¸€çš„æ•°æ®å°è£\" rel=\"noopener nofollow\">3.5.2 ç»Ÿä¸€çš„æ•°æ®å°è£…</a></li><li><a href=\"#353-æ”¯æŒå¤šç§æ•°æ®ç±»åž‹\" rel=\"noopener nofollow\">3.5.3 æ”¯æŒå¤šç§æ•°æ®ç±»åž‹</a></li><li><a href=\"#354-å†…ç½®æ¨¡æ¿æ”¯æŒ\" rel=\"noopener nofollow\">3.5.4 å†…ç½®æ¨¡æ¿æ”¯æŒ</a></li></ul></li><li><a href=\"#36-æ¨¡æ¿ç³»ç»Ÿ\" rel=\"noopener nofollow\">3.6 æ¨¡æ¿ç³»ç»Ÿ</a><ul><li><a href=\"#361-å­—ç¬¦ä¸²æ¨¡æ¿\" rel=\"noopener nofollow\">3.6.1 å­—ç¬¦ä¸²æ¨¡æ¿</a></li><li><a href=\"#362-æ¶ˆæ¯æ¨¡æ¿\" rel=\"noopener nofollow\">3.6.2 æ¶ˆæ¯æ¨¡æ¿</a></li></ul></li><li><a href=\"#37-functiontool-ä¸Ž-action-çš„å…³è”åŠæ³¨å†Œæœºåˆ¶\" rel=\"noopener nofollow\">3.7 FunctionTool ä¸Ž Action çš„å…³è”åŠæ³¨å†Œæœºåˆ¶</a><ul><li><a href=\"#371-å®žé™…è½¬æ¢æµç¨‹\" rel=\"noopener nofollow\">3.7.1 å®žé™…è½¬æ¢æµç¨‹</a><ul><li><a href=\"#function-tool-æ³¨å†Œåˆ°-agent\" rel=\"noopener nofollow\">Function Tool æ³¨å†Œåˆ° Agent</a></li><li><a href=\"#ä¸Žæ¨¡åž‹äº¤äº’\" rel=\"noopener nofollow\">ä¸Žæ¨¡åž‹äº¤äº’</a></li></ul></li><li><a href=\"#372-agentplan-ç¼–è¯‘è¿‡ç¨‹ä¸­å·¥å…·çš„å¤„ç†\" rel=\"noopener nofollow\">3.7.2 AgentPlan ç¼–è¯‘è¿‡ç¨‹ä¸­å·¥å…·çš„å¤„ç†</a><ul><li><a href=\"#ç”¨æˆ·å®šä¹‰çš„-function-tool-è½¬æ¢ä¸º-action\" rel=\"noopener nofollow\">ç”¨æˆ·å®šä¹‰çš„ Function Tool è½¬æ¢ä¸º Action</a></li><li><a href=\"#å†…ç½®-tool-call-action\" rel=\"noopener nofollow\">å†…ç½® Tool Call Action</a></li><li><a href=\"#tool_call_action-å¦‚ä½•ç¼–è¯‘åˆ°agentplan\" rel=\"noopener nofollow\">TOOL_CALL_ACTION å¦‚ä½•ç¼–è¯‘åˆ°AgentPlan</a></li></ul></li><li><a href=\"#373-å·¥å…·è°ƒç”¨æµç¨‹\" rel=\"noopener nofollow\">3.7.3 å·¥å…·è°ƒç”¨æµç¨‹</a></li><li><a href=\"#374-å®Œæ•´æµç¨‹å›¾\" rel=\"noopener nofollow\">3.7.4 å®Œæ•´æµç¨‹å›¾</a></li><li><a href=\"#375-ä»£ç \" rel=\"noopener nofollow\">3.7.5 ä»£ç </a></li></ul></li></ul></li><li><a href=\"#0xff-å‚è€ƒ\" rel=\"noopener nofollow\">0xFF å‚è€ƒ</a></li></ul></li></ul></div><p></p>\n<h2 id=\"0x00-æ¦‚è¦\">0x00 æ¦‚è¦</h2>\n<p>Agentæ˜¯ Flink Agent æ¡†æž¶çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯æ‰§è¡Œå•å…ƒï¼Œç”¨äºŽå¤„ç†è¾“å…¥äº‹ä»¶å¹¶ç”Ÿæˆè¾“å‡ºäº‹ä»¶ã€‚ä¸»è¦åŠŸèƒ½å’Œç‰¹è‰²å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>äº‹ä»¶é©±åŠ¨å¤„ç†ï¼šåŸºäºŽäº‹ä»¶é©±åŠ¨æž¶æž„ï¼Œå“åº”ä¸åŒç±»åž‹çš„äº‹ä»¶ï¼ˆå¦‚ InputEventï¼ŒChatRequestEventç­‰ï¼‰ï¼Œé€šè¿‡å®šä¹‰actionsæ¥å¤„ç†ç‰¹å®šäº‹ä»¶ç±»åž‹ã€‚</li>\n<li>èµ„æºç®¡ç†ï¼šç®¡ç†å„ç§èµ„æºï¼Œå¦‚èŠå¤©æ¨¡åž‹ã€å·¥å…·ã€æç¤ºè¯ç­‰ã€‚æ”¯æŒå¤šç§èµ„æºç±»åž‹ï¼ˆCHAT_MOEL, TOOL, PROMPTç­‰ï¼‰ã€‚</li>\n<li>å¯æ‰©å±•æ€§ï¼šæ”¯æŒè‡ªå®šä¹‰çš„actionså’Œèµ„æºï¼Œå¯ä»¥é€šè¿‡ç»§æ‰¿Agentç±»æ¥åˆ›å»ºç‰¹å®šåŠŸèƒ½çš„Agentï¼Œå¦‚ReActAgentã€‚</li>\n<li>é…ç½®æ”¯æŒï¼šæ”¯æŒé€šè¿‡é…ç½®é€‰é¡¹è‡ªå®šä¹‰è¡Œä¸ºï¼Œæä¾›ç»Ÿä¸€çš„é…ç½®ç®¡ç†æœºåˆ¶ã€‚</li>\n<li>æ¨¡å—åŒ–è®¾è®¡ï¼šå°†åŠŸèƒ½åˆ†è§£ä¸ºç‹¬ç«‹çš„Actionsï¼Œæ¯ä¸ªactionè´Ÿè´£å¤„ç†ç‰¹å®šç±»åž‹çš„äº‹ä»¶ã€‚</li>\n<li>èµ„æºæŠ½è±¡ï¼šé€šè¿‡ ResourceDescriptor æŠ½è±¡èµ„æºå®šä¹‰ï¼Œæ”¯æŒä¸åŒç±»åž‹çš„èµ„æºï¼ˆæ¨¡åž‹ï¼Œå·¥å…·ï¼Œæç¤ºè¯ç­‰ï¼‰</li>\n<li>çŠ¶æ€ç®¡ç†ï¼šæä¾›çŸ­æœŸå†…å­˜ç®¡ç†æœºåˆ¶ï¼Œæ”¯æŒåŸºäºŽkeyçš„çŠ¶æ€éš”ç¦»ã€‚</li>\n<li>å¤šçŽ¯å¢ƒæ”¯æŒï¼šæ”¯æŒæœ¬åœ°æ‰§è¡ŒçŽ¯å¢ƒç”¨äºŽè°ƒè¯•ï¼Œæ”¯æŒè¿œç¨‹ Flink çŽ¯å¢ƒç”¨äºŽç”Ÿäº§ã€‚</li>\n</ul>\n<h2 id=\"0x01-æ ¸å¿ƒæŠ½è±¡\">0x01 æ ¸å¿ƒæŠ½è±¡</h2>\n<h3 id=\"11-agentæŠ½è±¡\">1.1 AgentæŠ½è±¡</h3>\n<p>Agent ä½œä¸ºåŸºç±»æä¾›äº†ï¼š</p>\n<ul>\n<li>èµ„æºç®¡ç†ï¼ˆresources å­—å…¸ï¼‰ã€‚</li>\n<li>Action æ³¨å†Œæœºåˆ¶ï¼ˆactions å­—å…¸ï¼‰ã€‚</li>\n<li>ç»Ÿä¸€çš„æŽ¥å£ä¾›æ‰§è¡ŒçŽ¯å¢ƒä½¿ç”¨ã€‚</li>\n</ul>\n<pre><code class=\"language-python\">class Agent(ABC):\n    \"\"\"Base class for defining agent logic.\n\n    Example:\n        Users have two ways to create an Agent\n\n        * Declare an Agent with decorators\n        ::\n\n            class MyAgent(Agent):\n                @action(InputEvent)\n                @staticmethod\n                def my_action(event: Event, ctx: RunnerContext) -&gt; None:\n                    action logic\n\n                @chat_model_connection\n                @staticmethod\n                def my_connection() -&gt; ResourceDescriptor:\n                    return ResourceDescriptor(clazz=OllamaChatModelConnection,\n                                              model=\"qwen2:7b\",\n                                              base_url=\"http://localhost:11434\")\n\n                @chat_model_setup\n                @staticmethod\n                def my_chat_model() -&gt; ResourceDescriptor:\n                    return ResourceDescriptor(clazz=OllamaChatModel,\n                                              connection=\"my_connection\")\n\n        * Add actions and resources to an Agent instance\n        ::\n\n            my_agent = Agent()\n            my_agent.add_action(name=\"my_action\",\n                                events=[InputEvent],\n                                func=action_function)\n                    .add_resource(name=\"my_connection\",\n                                  instance=ResourceDescriptor(\n                                        clazz=OllamaChatModelConnection,\n                                        arg1=xxx\n                                )\n                    .add_resource(\n                        name=\"my_connection\",\n                        instance=ResourceDescriptor(\n                            clazz=OllamaChatModelConnection,\n                            arg1=xxx\n                        )\n                    )\n                    .add_resource(\n                        name=\"my_chat_model\",\n                        instance=ResourceDescriptor(\n                            clazz=OllamaChatModelSetup,\n                            connection=\"my_connection\"\n                        )\n                    )\n    \"\"\"\n\n    _actions: Dict[str, Tuple[List[Type[Event]], Callable, Dict[str, Any]]]\n    _resources: Dict[ResourceType, Dict[str, Any]]\n    _mcp_servers: Dict[str, MCPServer]\n\n    def __init__(self) -&gt; None:\n        \"\"\"Init method.\"\"\"\n        self._actions = {}\n        self._resources = {}\n        for type in ResourceType:\n            self._resources[type] = {}\n\n    @property\n    def actions(self) -&gt; Dict[str, Tuple[List[Type[Event]], Callable, Dict[str, Any]]]:\n        \"\"\"Get added actions.\"\"\"\n        return self._actions\n\n    @property\n    def resources(self) -&gt; Dict[ResourceType, Dict[str, Any]]:\n        \"\"\"Get added resources.\"\"\"\n        return self._resources\n\n    def add_action(\n        self, name: str, events: List[Type[Event]], func: Callable, **config: Any\n    ) -&gt; \"Agent\":\n        \"\"\"Add action to agent.\n\n        Parameters\n        ----------\n        name : str\n            The name of the action, should be unique in the same Agent.\n        events: List[Type[Event]]\n            The type of events listened by this action.\n        func: Callable\n            The function to be executed when receive listened events.\n        **config: Any\n            Key named arguments can be used by this action in runtime.\n\n        Returns:\n        -------\n        Agent\n            The modified Agent instance.\n        \"\"\"\n        if name in self._actions:\n            msg = f\"Action {name} already defined\"\n            raise ValueError(msg)\n        self._actions[name] = (events, func, config if config else None)\n        return self\n\n    def add_resource(\n        self, name: str, instance: SerializableResource | ResourceDescriptor\n    ) -&gt; \"Agent\":\n        \"\"\"Add resource to agent instance.\n\n        Parameters\n        ----------\n        name : str\n            The name of the prompt, should be unique in the same Agent.\n        instance: SerializableResource | ResourceDescriptor\n            The serializable resource instance, or the descriptor of resource.\n\n        Returns:\n        -------\n        Agent\n            The agent to add the resource.\n        \"\"\"\n        if isinstance(instance, SerializableResource):\n            resource_type = instance.resource_type()\n        elif isinstance(instance, ResourceDescriptor):\n            resource_type = instance.clazz.resource_type()\n        else:\n            err_msg = f\"Unexpected resource {instance}\"\n            raise TypeError(err_msg)\n\n        if name in self._resources[resource_type]:\n            msg = f\"{resource_type.value} {name} already defined\"\n            raise ValueError(msg)\n\n        self._resources[resource_type][name] = instance\n        return self\n</code></pre>\n<h3 id=\"12-action-æŠ½è±¡\">1.2 Action æŠ½è±¡</h3>\n<p>Action æä¾›äº†ï¼š</p>\n<ul>\n<li>äº‹ä»¶ç›‘å¬æœºåˆ¶</li>\n<li>ä¸Žæ‰§è¡Œä¸Šä¸‹æ–‡çš„äº¤äº’æŽ¥å£</li>\n<li>ç»Ÿä¸€çš„æ‰§è¡ŒæŽ¥å£</li>\n</ul>\n<p>é€šè¿‡è£…é¥°å™¨æˆ–è€…add_actionæ–¹æ³•å®šä¹‰ã€‚</p>\n<pre><code class=\"language-python\">    @action(InputEvent)\n    @staticmethod\n    def start_action(event: InputEvent, ctx: RunnerContext) -&gt; None:\n        \"\"\"Start action to format user input and send chat request event.\"\"\"\n        usr_input = event.input\n</code></pre>\n<h3 id=\"13-èµ„æºæŠ½è±¡\">1.3 èµ„æºæŠ½è±¡</h3>\n<p>èµ„æºæŠ½è±¡åŒ…æ‹¬ï¼šæ¨¡åž‹è¿žæŽ¥ï¼ˆCHAT_MODEL_CONNECTION)ï¼Œå·¥å…·ï¼Œæç¤ºè¯ï¼ŒMCPæœåŠ¡å™¨ç­‰ã€‚</p>\n<pre><code class=\"language-python\">class ResourceDescriptor:\n    \"\"\"Descriptor of resource, includes the class and the initialize arguments.\"\"\"\n\n    _clazz: Type[Resource]\n    _arguments: Dict[str, Any]\n\n    def __init__(self, *, clazz: Type[Resource], **arguments: Any) -&gt; None:\n        \"\"\"Init method.\"\"\"\n        self._clazz = clazz\n        self._arguments = arguments\n\n    @property\n    def clazz(self) -&gt; Type[Resource]:\n        \"\"\"Get the class of the resource.\"\"\"\n        return self._clazz\n\n    @property\n    def arguments(self) -&gt; Dict[str, Any]:\n        \"\"\"Get the initialize arguments of the resource.\"\"\"\n        return self._arguments\n</code></pre>\n<h3 id=\"14-æ‰§è¡ŒçŽ¯å¢ƒæŠ½è±¡\">1.4 æ‰§è¡ŒçŽ¯å¢ƒæŠ½è±¡</h3>\n<p>æ‰§è¡Œä¸Šä¸‹æ–‡æä¾›ï¼š</p>\n<ul>\n<li>äº‹ä»¶å‘é€æœºåˆ¶</li>\n<li>èµ„æºè®¿é—®æŽ¥å£</li>\n<li>å†…å­˜ç®¡ç†</li>\n<li>é…ç½®è®¿é—®</li>\n</ul>\n<pre><code class=\"language-python\">class RunnerContext(ABC):\n    \"\"\"Abstract base class providing context for agent execution.\n\n    This context provides access to event handling.\n</code></pre>\n<h3 id=\"15-äº‹ä»¶æŠ½è±¡\">1.5 äº‹ä»¶æŠ½è±¡</h3>\n<p>å³ Event ä½“ç³»ï¼Œæä¾›äº†ï¼š</p>\n<ul>\n<li>ç»Ÿä¸€çš„äº‹ä»¶å¤„ç†æœºåˆ¶</li>\n<li>ç±»åž‹å®‰å…¨çš„äº‹ä»¶åˆ†å‘</li>\n<li>å¯æ‰©å±•çš„äº‹ä»¶ç±»åž‹ç³»ç»Ÿ</li>\n</ul>\n<pre><code class=\"language-python\">class Event(BaseModel, ABC, extra=\"allow\"):\n    \"\"\"Base class for all event types in the system. Event allow extra properties, but\n    these properties are required isinstance of BaseModel, or json serializable.\n\n    Attributes:\n    ----------\n    id : UUID\n        Unique identifier for the event, automatically generated using uuid4.\n    \"\"\"\n\n    id: UUID = Field(default_factory=uuid4)\n</code></pre>\n<h3 id=\"16-é…ç½®æŠ½è±¡\">1.6 é…ç½®æŠ½è±¡</h3>\n<p>AgentConfiguration æä¾›äº†ï¼š</p>\n<ul>\n<li>ç±»åž‹å®‰å…¨çš„é…ç½®é€‰é¡¹</li>\n<li>é»˜è®¤å€¼ç®¡ç†</li>\n<li>ä»Žæ–‡ä»¶åŠ è½½é…ç½®çš„èƒ½åŠ›</li>\n</ul>\n<pre><code class=\"language-python\">class AgentConfiguration(BaseModel, Configuration):\n    \"\"\"Base class for config objects in the system.\n    Provides a flat dict interface to access nested config values.\n    \"\"\"\n\n    conf_data: Dict[str, Any]\n\n    def __init__(self, conf_data: Dict[str, Any] | None = None) -&gt; None:\n        \"\"\"Initialize with optional configuration data.\"\"\"\n        if conf_data is None:\n            super().__init__(conf_data = {})\n        else:\n            super().__init__(conf_data = conf_data)\n\n</code></pre>\n<h2 id=\"0x02-workflow-style-agent-å’Œreactagent\">0x02 Workflow Style Agent å’ŒReActAgent</h2>\n<p>æœ‰ä¸¤ç§æœ€æ™®éçš„Agentsï¼š</p>\n<ul>\n<li><strong>Workflows</strong> æ˜¯ç”±é¢„å®šä¹‰çš„ä»£ç è·¯å¾„æ¥ç¼–æŽ’ LLM å’Œå·¥å…·çš„ç³»ç»Ÿã€‚</li>\n<li><strong>Agents</strong> åˆ™æ˜¯ LLM åŠ¨æ€æŒ‡å¯¼è‡ªèº«æµç¨‹å’Œå·¥å…·ä½¿ç”¨çš„ç³»ç»Ÿï¼Œå®ƒä»¬æŽŒæŽ§ç€è‡ªå·±å®Œæˆä»»åŠ¡çš„æ–¹å¼ã€‚</li>\n</ul>\n<p>å½“éœ€è¦å¤„ç†æ›´å¤æ‚ä»»åŠ¡æ—¶ï¼ŒWorkflows ä¸ºå®šä¹‰æ˜Žç¡®çš„ä»»åŠ¡æä¾›äº†å¯é¢„æµ‹æ€§å’Œä¸€è‡´æ€§ï¼ˆå¤çŽ°ï¼‰ï¼Œè€Œå½“éœ€è¦å¤§è§„æ¨¡çš„çµæ´»æ€§å’Œæ¨¡åž‹é©±åŠ¨çš„å†³ç­–æ—¶ï¼Œagents åˆ™æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</p>\n<p>å¯¹åº”è¿™ä¸¤ç§Agentï¼ŒFlink Agents æœ‰ä¸¤ç§ä¸åŒçš„Agentï¼šWorkflow Style Agent å’ŒReActAgentã€‚</p>\n<ul>\n<li>åœ¨ Flink-Agents ä¸­ï¼Œå·¥ä½œæµé£Žæ ¼çš„ä»£ç†ï¼ˆworkflow-style agentï¼‰æŠŠæŽ¨ç†ä¸Žè¡Œä¸ºç»„ç»‡æˆä¸€æ¡ç”±â€œåŠ¨ä½œï¼ˆactionï¼‰â€æž„æˆçš„æœ‰å‘å·¥ä½œæµï¼ŒåŠ¨ä½œä¹‹é—´é€šè¿‡äº‹ä»¶è¿žæŽ¥ã€‚è¿™ç§è®¾è®¡å€Ÿé‰´äº†å¤æ‚å¤šé˜¶æ®µä»»åŠ¡çš„ç¼–æŽ’éœ€æ±‚ï¼Œå¸Œæœ›ä»¥é€æ˜Žã€å¯æ‰©å±•ä¸”ä»¥æ•°æ®ä¸ºä¸­å¿ƒçš„æ–¹å¼åˆ©ç”¨ Apache Flink çš„æµå¼æž¶æž„æ¥å®Œæˆå·¥ä½œã€‚Workflow é€‚åˆä»»åŠ¡æ˜¯å¯ä»¥è¢«æ¸…é™¤çš„è§£æž„æˆå›ºå®šçš„å­ä»»åŠ¡å•å…ƒã€‚Workflow ç›¸å¯¹äºŽ Agent æœ‰ä¸ªå¤©ç„¶çš„ä¼˜åŠ¿å°±æ˜¯é«˜æ•ˆçŽ‡ï¼Œä¸”æ•ˆæžœéžå¸¸ç¨³å®šï¼Œæ‰§è¡ŒåŸºæœ¬éƒ½èƒ½åœ¨é¢„æœŸèŒƒå›´å†…ï¼Œä¸å¯é¢„çŸ¥æˆ–è€…è¯´æœªçŸ¥æ€§å¾ˆä½Žã€‚ç¼ºç‚¹è‡ªç„¶å°±æ˜¯ä¸å¤Ÿçµæ´»äº†ï¼Œé¢å¯¹ä¸€äº›å¼€æ”¾çš„æˆ–è€…æ— æ³•é¢„å®šä¹‰çš„ä»»åŠ¡å°±æ— æ³•å¤„ç†äº†ã€‚</li>\n<li>ReActï¼ˆReasoning and Actingï¼‰Agent æ˜¯ä¸€ç§é€šç”¨èŒƒå¼ï¼ŒæŠŠæŽ¨ç†ä¸Žè¡ŒåŠ¨èƒ½åŠ›ç»“åˆèµ·æ¥è§£å†³å¤æ‚ä»»åŠ¡ã€‚å€ŸåŠ©è¯¥èŒƒå¼ï¼Œç”¨æˆ·åªéœ€åœ¨æç¤ºè¯é‡ŒæŒ‡å®šç›®æ ‡å¹¶æä¾›å¯ç”¨å·¥å…·ï¼Œå¤§æ¨¡åž‹ä¾¿ä¼šè‡ªä¸»å†³å®šå¦‚ä½•è¾¾æˆç›®æ ‡å¹¶æ‰§è¡Œç›¸åº”åŠ¨ä½œã€‚ReActé€šè¿‡æ¨¡æ‹Ÿäººç±»çš„â€œReasoning-Actingâ€æ¨¡å¼ï¼Œä½¿LLMèƒ½å¤ŸåŠ¨æ€åœ°å†³å®šæ•°æ®éœ€æ±‚ ã€‚å…¶æ ¸å¿ƒæ˜¯ä¸€ä¸ªå¾ªçŽ¯ï¼šæ€è€ƒï¼ˆThoughtï¼‰ï¼š LLMé¦–å…ˆè¿›è¡Œå†…éƒ¨æŽ¨ç†ã€‚å®ƒåˆ†æžå½“å‰ä»»åŠ¡å’Œå·²æœ‰ä¿¡æ¯ï¼Œåˆ¤æ–­æ˜¯å¦ç¼ºå°‘å®Œæˆä»»åŠ¡æ‰€éœ€çš„çŸ¥è¯†ï¼Œå¹¶åˆ¶å®šä¸‹ä¸€æ­¥çš„è¡ŒåŠ¨è®¡åˆ’ã€‚åœ¨è¿™ä¸ªå¾ªçŽ¯ä¸­ï¼Œæ•°æ®æµæ˜¯æ ¹æ®LLMçš„â€œæ€è€ƒâ€ç»“æžœåŠ¨æ€ç”Ÿæˆçš„ã€‚å½“LLMåˆ¤æ–­éœ€è¦å¤–éƒ¨æ•°æ®æ—¶ï¼Œå®ƒä¼šä¸»åŠ¨è§¦å‘ä¸€ä¸ªâ€œè¡ŒåŠ¨â€æ¥èŽ·å–æ•°æ®ï¼Œç„¶åŽå°†èŽ·å–åˆ°çš„â€œè§‚å¯Ÿâ€æ•°æ®æ•´åˆè¿›è‡ªå·±çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œç”¨äºŽä¸‹ä¸€æ­¥çš„å†³ç­–ã€‚</li>\n</ul>\n<h3 id=\"21-ç‰¹æ€§\">2.1 ç‰¹æ€§</h3>\n<p>ä¸¤ç§Agentçš„è¯¦ç»†æ¢³ç†å¦‚ä¸‹ï¼š</p>\n<h4 id=\"211-è®¾è®¡ç†å¿µ\">2.1.1 è®¾è®¡ç†å¿µ</h4>\n<p>Workflow Style Agent</p>\n<ul>\n<li>å¯å®šåˆ¶æ¡†æž¶ï¼šçµæ´»çš„æ¡†æž¶ï¼Œå…è®¸ç”¨æˆ·å®šä¹‰è‡ªå·±çš„ä»£ç†é€»è¾‘</li>\n<li>äº‹ä»¶é©±åŠ¨æž¶æž„ï¼šé€»è¾‘è¢«ç»„ç»‡ä¸ºç”±äº‹ä»¶è¿žæŽ¥çš„åŠ¨ä½œæœ‰å‘å›¾</li>\n<li>æ¨¡å—åŒ–è®¾è®¡ï¼šç”¨æˆ·é€šè¿‡å®šä¹‰å•ä¸ªåŠ¨ä½œåŠå…¶äº¤äº’æ¥ç»„åˆä»£ç†</li>\n</ul>\n<p>ReActAgent</p>\n<ul>\n<li>é¢„æž„å»ºä»£ç†ï¼šåŸºäºŽ ReActï¼ˆæŽ¨ç†+è¡ŒåŠ¨ï¼‰èŒƒå¼çš„å†…ç½®ã€å³ç”¨åž‹ä»£ç†å®žçŽ°</li>\n<li>ä»¥ LLM ä¸ºä¸­å¿ƒï¼šä¸“é—¨ä¸º LLM åšå‡ºé‡‡å–ä½•ç§è¡ŒåŠ¨çš„å†³ç­–è€Œè®¾è®¡</li>\n<li>æ ‡å‡†åŒ–å·¥ä½œæµï¼šéµå¾ªå›ºå®šçš„â€œæ€ç»´â†’è¡ŒåŠ¨â†’è§‚å¯Ÿâ€å¾ªçŽ¯æ¨¡å¼</li>\n</ul>\n<h4 id=\"212-æŽ§åˆ¶æµ\">2.1.2 æŽ§åˆ¶æµ</h4>\n<p>Workflow Style Agent</p>\n<ul>\n<li>æ˜¾å¼æµç¨‹ï¼šç”¨æˆ·æ˜Žç¡®å®šä¹‰äº‹ä»¶å¦‚ä½•è§¦å‘åŠ¨ä½œ</li>\n<li>äº‹ä»¶è·¯ç”±ï¼šåŠ¨ä½œç”±ç‰¹å®šçš„äº‹ä»¶ç±»åž‹è§¦å‘</li>\n<li>çµæ´»æ¨¡å¼ï¼šå¯ä»¥å®žçŽ°å„ç§æ¨¡å¼ï¼Œå¦‚é¡ºåºã€åˆ†æ”¯æˆ–å¾ªçŽ¯å·¥ä½œæµ</li>\n</ul>\n<p>ReActAgent</p>\n<ul>\n<li>éšå¼æµç¨‹ï¼šå†³ç­–è¿‡ç¨‹åœ¨å†…éƒ¨ç”± LLM å¤„ç†</li>\n<li>å·¥å…·è°ƒç”¨ï¼šä½¿ç”¨ LLM çš„åŽŸç”Ÿå‡½æ•°è°ƒç”¨åŠŸèƒ½æ¥ç¡®å®šæ“ä½œ</li>\n<li>å›ºå®šæ¨¡å¼ï¼šéµå¾ªæ ‡å‡†çš„ ReAct æ¨¡å¼ï¼ˆæ€è€ƒâ†’è¡ŒåŠ¨â†’è§‚å¯Ÿï¼‰</li>\n</ul>\n<h4 id=\"213-å®šåˆ¶çº§åˆ«\">2.1.3 å®šåˆ¶çº§åˆ«</h4>\n<p>Workflow Style Agent</p>\n<ul>\n<li>é«˜åº¦å¯å®šåˆ¶ï¼šå¯¹ä»£ç†é€»è¾‘ã€åŠ¨ä½œå’Œäº‹ä»¶æµæ‹¥æœ‰å®Œå…¨æŽ§åˆ¶æƒ</li>\n<li>è‡ªå®šä¹‰åŠ¨ä½œï¼šç”¨æˆ·å®šä¹‰æ‰€æœ‰åŠ¨ä½œåŠå…¶è¡Œä¸º</li>\n<li>çµæ´»äº‹ä»¶ï¼šç”¨æˆ·å¯ä»¥å®šä¹‰è‡ªå®šä¹‰äº‹ä»¶ç±»åž‹å’Œå¤„ç†é€»è¾‘</li>\n</ul>\n<p>ReActAgent</p>\n<ul>\n<li>æœ‰é™å®šåˆ¶ï¼šå®šåˆ¶ä¸»è¦é€šè¿‡æç¤ºè¯ã€æ¨¡åž‹å’Œè¾“å‡ºæ¨¡å¼å®žçŽ°</li>\n<li>é¢„å®šä¹‰åŠ¨ä½œï¼šä½¿ç”¨å†…ç½®åŠ¨ä½œå¦‚ start_action å’Œ stop_action</li>\n<li>æ ‡å‡†æŽ¥å£ï¼šä¸ºç±»ä¼¼çš„ LLM ä»»åŠ¡æä¾›ä¸€è‡´çš„æŽ¥å£</li>\n</ul>\n<h4 id=\"214-ä½¿ç”¨åœºæ™¯\">2.1.4 ä½¿ç”¨åœºæ™¯</h4>\n<p>Workflow Style Agent</p>\n<ul>\n<li>å…·æœ‰å›ºå®šåºåˆ—æˆ–æ¡ä»¶åˆ†æ”¯çš„å¤šæ­¥éª¤æµç¨‹</li>\n<li>éœ€è¦ç²¾ç¡®æŽ§åˆ¶ä»£ç†è¡Œä¸ºçš„åœºæ™¯</li>\n<li>åœ¨é¢„å®šé¡ºåºä¸­ä¸Žå¤šä¸ªå¤–éƒ¨ç³»ç»Ÿé›†æˆ</li>\n</ul>\n<p>ReActAgent</p>\n<ul>\n<li>éœ€è¦ LLM æŽ¨ç†ä½¿ç”¨å“ªäº›å·¥å…·/æ“ä½œçš„ä»»åŠ¡</li>\n<li>å¸¦å·¥å…·ä½¿ç”¨çš„æ ‡å‡†é—®ç­”</li>\n<li>LLM åº”è¯¥åŠ¨æ€å†³å®šå·¥ä½œæµç¨‹çš„åœºæ™¯</li>\n</ul>\n<p>åªè¦â€œé—®é¢˜ä¸å¯å®Œå…¨ç©·ä¸¾ã€è¦è·¨å¤šç³»ç»ŸæŸ¥è¯ã€å¹¶ä¸”éœ€è¦åœ¨å¯¹è¯ä¸­æ¾„æ¸…/åå•†/å†³ç­–â€ï¼Œå°±æ›´åº”è¯¥ç”¨ReActAgentï¼Œè€Œä¸æ˜¯çº¯ Workflowã€‚</p>\n<h4 id=\"215-å¼€å‘å¤æ‚åº¦\">2.1.5 å¼€å‘å¤æ‚åº¦</h4>\n<p>Workflow Style Agent</p>\n<ul>\n<li>æ›´é«˜çµæ´»æ€§ï¼šéœ€è¦æ›´å¤šä»£ç ä½†æŽ§åˆ¶åŠ›æ›´å¼º</li>\n<li>è‡ªå®šä¹‰é€»è¾‘ï¼šéœ€è¦å®žçŽ°æ‰€æœ‰åŠ¨ä½œé€»è¾‘</li>\n<li>æ— ä¸»è§ï¼šå¼€å‘äººå‘˜æŽ§åˆ¶ä»£ç†è¡Œä¸ºçš„æ‰€æœ‰æ–¹é¢</li>\n</ul>\n<p>ReActAgent</p>\n<ul>\n<li>è¾ƒä½Žé—¨æ§›ï¼šæ›´å®¹æ˜“ä¸Šæ‰‹ï¼Œå…·æœ‰é¢„å®šä¹‰åŠŸèƒ½</li>\n<li>ä»£ç é‡å°‘ï¼šè®¾ç½®æ‰€éœ€çš„ä»£ç æœ€å°‘</li>\n<li>æœ‰ä¸»è§ï¼šä»£è¡¨å¼€å‘äººå‘˜åšå‡ºè®¸å¤šå†³ç­–</li>\n</ul>\n<h4 id=\"216-æ€»ç»“\">2.1.6 æ€»ç»“</h4>\n<p>ReActAgent ä¸ºæ ‡å‡†çš„åŸºäºŽ LLM çš„æŽ¨ç†ä»»åŠ¡æä¾›äº†çŽ°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œè€Œ Workflow Style Agent ä¸ºå¤æ‚çš„è‡ªå®šä¹‰ä»£ç†å®žçŽ°æä¾›äº†æœ€å¤§çš„çµæ´»æ€§ã€‚</p>\n<p>æœ‰äººæˆç§°ï¼šæ‹‰æŠ•èµ„ç”¨ Agent è®²æ•…äº‹ï¼Œåšä¸šåŠ¡è¸è¸å®žå®žç”¨ Workflow ã€‚è¿™å¥çŽ©ç¬‘èƒŒåŽæŠ˜å°„å‡ºçŽ°å®žçš„è€ƒé‡ï¼šWorkflow èƒœåœ¨ç¡®å®šæ€§ï¼Œè€Œ Agent èƒœåœ¨ä¸Šé™ã€‚</p>\n<h3 id=\"22-workflow\">2.2 workflow</h3>\n<p>å®˜æ–¹çš„å¿«é€Ÿå…¥é—¨ï¼ˆdocs\\content\\docs\\get-started\\quickstart\\workflow_agent.mdï¼‰é€šè¿‡ä¸¤ä¸ªæ¸è¿›å¼æµå¼ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ç”¨ Flink Agents æž„å»ºç”±å¤§æ¨¡åž‹é©±åŠ¨çš„æµæ°´çº¿ï¼š</p>\n<ul>\n<li><strong>è¯„è®ºåˆ†æž</strong>ï¼šç¤ºä¾‹ä¸€ ä¼šæŒç»­æŽ¥æ”¶å•†å“è¯„è®ºæµï¼Œå¹¶ç”¨å•ä¸ªä»£ç†ä»Žæ¯æ¡è¯„è®ºä¸­æå–è¯„åˆ†ï¼ˆ1-5ï¼‰ä»¥åŠä¸æ»¡æ„åŽŸå› ã€‚</li>\n<li><strong>äº§å“æ”¹è¿›å»ºè®®</strong>ï¼šåœ¨ç¤ºä¾‹ä¸€çš„åŸºç¡€ä¸Šï¼ŒæŒ‰çª—å£èšåˆæ¯æ¡è¯„è®ºçš„åˆ†æžç»“æžœï¼Œç”Ÿæˆå•†å“çº§åˆ«çš„æ±‡æ€»ï¼ˆè¯„åˆ†åˆ†å¸ƒã€å¸¸è§æŠ±æ€¨ï¼‰ï¼Œå†è°ƒç”¨ç¬¬äºŒä¸ªä»£ç†ä¸ºæ¯ä»¶å•†å“è¾“å‡ºå…·ä½“çš„æ”¹è¿›å»ºè®®ã€‚</li>\n</ul>\n<p>ä¸¤ä¸ªç¤ºä¾‹åˆåœ¨ä¸€èµ·ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ç”¨ Flink Agents æž„å»ºå¤šä»£ç†å·¥ä½œæµï¼Œå¹¶ç›´æŽ¥åœ¨ Flink ç‹¬ç«‹é›†ç¾¤ä¸Šè¿è¡Œã€‚</p>\n<h4 id=\"221-ä»£ç å¯¼è¯»\">2.2.1 ä»£ç å¯¼è¯»</h4>\n<h5 id=\"å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ\">å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ</h5>\n<p>åˆ›å»º Agents æ‰§è¡ŒçŽ¯å¢ƒï¼Œæ³¨å†Œå¯ä¾›ä»£ç†ä½¿ç”¨çš„èŠå¤©æ¨¡åž‹è¿žæŽ¥ã€‚</p>\n<pre><code class=\"language-Java\">// Set up the Flink streaming environment and the Agents execution environment.\nStreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();\nAgentsExecutionEnvironment agentsEnv =\n        AgentsExecutionEnvironment.getExecutionEnvironment(env);\n\n// Add Ollama chat model connection to be used by the ReviewAnalysisAgent.\nagentsEnv.addResource(\n        \"ollamaChatModelConnection\",\n        ResourceType.CHAT_MODEL_CONNECTION,\n        CustomTypesAndResources.OLLAMA_SERVER_DESCRIPTOR);\n</code></pre>\n<h5 id=\"åˆ›å»ºä»£ç†\">åˆ›å»ºä»£ç†</h5>\n<p>ä»¥ <code>ReviewAnalysisAgent</code> ä¸ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•å®šä¹‰æç¤ºè¯ã€å·¥å…·ã€èŠå¤©æ¨¡åž‹å’ŒåŠ¨ä½œï¼›ä»¥åŠå¦‚ä½•å¤„ç†èŠå¤©å“åº”å¹¶å‘é€è¾“å‡ºäº‹ä»¶ã€‚æ›´å¤šç»†èŠ‚è¯·å‚è€ƒ [å·¥ä½œæµä»£ç†] æ–‡æ¡£ã€‚<code>ProductSuggestionAgent</code> çš„ä»£ç ä¸Žä¹‹ç±»ä¼¼ã€‚</p>\n<pre><code class=\"language-Java\">/**\n * An agent that uses a large language model (LLM) to analyze product reviews and generate a\n * satisfaction score and potential reasons for dissatisfaction.\n *\n * &lt;p&gt;This agent receives a product review and produces a satisfaction score and a list of reasons\n * for dissatisfaction. It handles prompt construction, LLM interaction, and output parsing.\n */\npublic class ReviewAnalysisAgent extends Agent {\n\n    private static final ObjectMapper MAPPER = new ObjectMapper();\n\n    @Prompt\n    public static org.apache.flink.agents.api.prompt.Prompt reviewAnalysisPrompt() {\n        return REVIEW_ANALYSIS_PROMPT;\n    }\n\n    @ChatModelSetup\n    public static ResourceDescriptor reviewAnalysisModel() {\n        return ResourceDescriptor.Builder.newBuilder(OllamaChatModelSetup.class.getName())\n                .addInitialArgument(\"connection\", \"ollamaChatModelConnection\")\n                .addInitialArgument(\"model\", \"qwen3:8b\")\n                .addInitialArgument(\"prompt\", \"reviewAnalysisPrompt\")\n                .addInitialArgument(\"tools\", Collections.singletonList(\"notifyShippingManager\"))\n                .addInitialArgument(\"extract_reasoning\", \"true\")\n                .build();\n    }\n\n    /**\n     * Tool for notifying the shipping manager when product received a negative review due to\n     * shipping damage.\n     *\n     * @param id The id of the product that received a negative review due to shipping damage\n     * @param review The negative review content\n     */\n    @Tool(\n            description =\n                    \"Notify the shipping manager when product received a negative review due to shipping damage.\")\n    public static void notifyShippingManager(\n            @ToolParam(name = \"id\") String id, @ToolParam(name = \"review\") String review) {\n        CustomTypesAndResources.notifyShippingManager(id, review);\n    }\n\n    /** Process input event and send chat request for review analysis. */\n    @Action(listenEvents = {InputEvent.class})\n    public static void processInput(InputEvent event, RunnerContext ctx) throws Exception {\n        String input = (String) event.getInput();\n        MAPPER.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n        CustomTypesAndResources.ProductReview inputObj =\n                MAPPER.readValue(input, CustomTypesAndResources.ProductReview.class);\n\n        ctx.getShortTermMemory().set(\"id\", inputObj.getId());\n\n        String content =\n                String.format(\n                        \"{\\n\" + \"\\\"id\\\": %s,\\n\" + \"\\\"review\\\": \\\"%s\\\"\\n\" + \"}\",\n                        inputObj.getId(), inputObj.getReview());\n        ChatMessage msg = new ChatMessage(MessageRole.USER, \"\", Map.of(\"input\", content));\n\n        ctx.sendEvent(new ChatRequestEvent(\"reviewAnalysisModel\", List.of(msg)));\n    }\n\n    @Action(listenEvents = ChatResponseEvent.class)\n    public static void processChatResponse(ChatResponseEvent event, RunnerContext ctx)\n            throws Exception {\n        JsonNode jsonNode = MAPPER.readTree(event.getResponse().getContent());\n        JsonNode scoreNode = jsonNode.findValue(\"score\");\n        JsonNode reasonsNode = jsonNode.findValue(\"reasons\");\n        if (scoreNode == null || reasonsNode == null) {\n            throw new IllegalStateException(\n                    \"Invalid response from LLM: missing 'score' or 'reasons' field.\");\n        }\n        List&lt;String&gt; result = new ArrayList&lt;&gt;();\n        if (reasonsNode.isArray()) {\n            for (JsonNode node : reasonsNode) {\n                result.add(node.asText());\n            }\n        }\n\n        ctx.sendEvent(\n                new OutputEvent(\n                        new CustomTypesAndResources.ProductReviewAnalysisRes(\n                                ctx.getShortTermMemory().get(\"id\").getValue().toString(),\n                                scoreNode.asInt(),\n                                result)));\n    }\n}\n</code></pre>\n<h5 id=\"ä¸Ž-flink-é›†æˆ\">ä¸Ž Flink é›†æˆ</h5>\n<p>è¯»å–æ–‡æœ¬æ–‡ä»¶ä¸­çš„å•†å“è¯„è®ºæµä½œä¸ºè¾“å…¥ DataStreamï¼Œç”¨ <code>ReviewAnalysisAgent</code> åˆ†æžå¹¶ç”Ÿæˆç»“æžœ DataStreamï¼Œæœ€åŽæ‰“å°è¾“å‡ºã€‚</p>\n<pre><code class=\"language-Java\">// Read product reviews from input_data.txt file as a streaming source.\n// Each element represents a ProductReview.\nDataStream&lt;String&gt; productReviewStream =\n       env.fromSource(\n               FileSource.forRecordStreamFormat(\n                               new TextLineInputFormat(),\n                               new Path(inputDataFile.getAbsolutePath()))\n                       .build(),\n               WatermarkStrategy.noWatermarks(),\n               \"streaming-agent-example\");\n\n// Use the ReviewAnalysisAgent to analyze each product review.\nDataStream&lt;Object&gt; reviewAnalysisResStream =\n       agentsEnv\n               .fromDataStream(productReviewStream)\n               .apply(new ReviewAnalysisAgent())\n               .toDataStream();\n\n// Print the analysis results to stdout.\nreviewAnalysisResStream.print();\n\n// Execute the Flink pipeline.\nagentsEnv.execute();\n</code></pre>\n<h3 id=\"23-react-agent\">2.3 ReAct Agent</h3>\n<p>æœ¬å¿«é€Ÿå…¥é—¨ç”¨ä¸€ä¸ªè¿·ä½ ç¤ºä¾‹æ¼”ç¤ºå¦‚ä½•ç”¨ Flink Agents æž„å»ºæµå¼ ReAct Agentï¼š</p>\n<p><strong>è¯„è®ºåˆ†æž</strong> ä»£ç†æŒç»­æ¶ˆè´¹å•†å“è¯„è®ºæµï¼Œç”¨å•ä¸ªä»£ç†æå–è¯„åˆ†ï¼ˆ1-5ï¼‰ä»¥åŠä¸æ»¡æ„åŽŸå› ï¼›è‹¥è¯„è®ºæ¶‰åŠç‰©æµä¸æ»¡ï¼Œåˆ™è‡ªåŠ¨é€šçŸ¥ç‰©æµç»ç†ã€‚</p>\n<h4 id=\"231-ä»£ç å¯¼è¯»\">2.3.1 ä»£ç å¯¼è¯»</h4>\n<h5 id=\"å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ-1\">å‡†å¤‡ä»£ç†æ‰§è¡ŒçŽ¯å¢ƒ</h5>\n<p>åˆ›å»º Agents æ‰§è¡ŒçŽ¯å¢ƒï¼Œæ³¨å†Œå¯ç”¨çš„èŠå¤©æ¨¡åž‹è¿žæŽ¥ä¸Žå·¥å…·ã€‚</p>\n<pre><code class=\"language-python\"># Set up the Flink streaming environment and the Agents execution environment.\nenv = StreamExecutionEnvironment.get_execution_environment()\nagents_env = AgentsExecutionEnvironment.get_execution_environment(env)\n\n# Add Ollama chat model connection and notify shipping manager tool to be used\n# by the Agent.\nagents_env.add_resource(\n    \"ollama_server\",\n    ResourceDescriptor(clazz=OllamaChatModelConnection, request_timeout=120),\n).add_resource(\n    \"notify_shipping_manager\", Tool.from_callable(notify_shipping_manager)\n)\n</code></pre>\n<h5 id=\"åˆ›å»º-react-agent\">åˆ›å»º ReAct Agent</h5>\n<p>å®žä¾‹åŒ– ReAct Agentï¼Œé…ç½®èŠå¤©æ¨¡åž‹ã€æç¤ºè¯ä»¥åŠç»“æžœçš„è¾“å‡ºæ¨¡å¼ã€‚</p>\n<pre><code class=\"language-python\">review_analysis_react_agent = ReActAgent(\n    chat_model=ResourceDescriptor(\n        clazz=OllamaChatModelSetup,\n        connection=\"ollama_server\",\n        model=\"qwen3:8b\",\n        tools=[\"notify_shipping_manager\"],\n    ),\n    prompt=review_analysis_react_prompt,\n    output_schema=ProductReviewAnalysisRes,\n)\n</code></pre>\n<h5 id=\"ä¸Ž-flink-é›†æˆ-1\">ä¸Ž Flink é›†æˆ</h5>\n<p>è¯»å–å•†å“è¯„è®ºæ–‡æœ¬æ–‡ä»¶ç”Ÿæˆ Source DataStreamï¼Œç”¨ ReAct Agent åˆ†æžå¹¶ç”Ÿæˆç»“æžœ DataStreamï¼Œæœ€åŽæ‰“å°è¾“å‡ºã€‚</p>\n<pre><code class=\"language-python\"># Read product reviews from a text file as a streaming source.\n# Each line in the file should be a JSON string representing a ProductReview.\nproduct_review_stream = env.from_source(\n    source=FileSource.for_record_stream_format(\n        StreamFormat.text_line_format(),\n        f\"file:///{current_dir}/resources/\",\n    )\n    .monitor_continuously(Duration.of_minutes(1))\n    .build(),\n    watermark_strategy=WatermarkStrategy.no_watermarks(),\n    source_name=\"streaming_agent_example\",\n).map(\n    lambda x: ProductReview.model_validate_json(\n        x\n    )  # Deserialize JSON to ProductReview.\n)\n\n# Use the ReAct agent to analyze each product review and notify the shipping manager\n# when needed.\nreview_analysis_res_stream = (\n    agents_env.from_datastream(\n        input=product_review_stream, key_selector=lambda x: x.id\n    )\n    .apply(review_analysis_react_agent)\n    .to_datastream()\n)\n\n# Print the analysis results to stdout.\nreview_analysis_res_stream.print()\n</code></pre>\n<h2 id=\"0x03-reactagent\">0x03 ReActAgent</h2>\n<p>ReActAgent æ˜¯ Agent æŠ½è±¡çš„ä¸€ä¸ªå…·ä½“å®žçŽ°ï¼Œå±•ç¤ºäº†è¿™äº›æŠ½è±¡å¦‚ä½•ååŒå·¥ä½œã€‚</p>\n<ul>\n<li>èµ„æºç®¡ç†ï¼šç®¡ç†èŠå¤©æ¨¡åž‹å’Œæç¤ºè¯èµ„æº</li>\n<li>Actionå®šä¹‰ï¼šå®šä¹‰ start_action å’Œ stop_action å¤„ç†è¾“å…¥å’Œè¾“å‡º</li>\n<li>äº‹ä»¶å¤„ç†ï¼šå“åº” InputEvent å’Œ ChatResponseEvent</li>\n<li>é…ç½®ç®¡ç†ï¼šæ”¯æŒé”™è¯¯å¤„ç†ç­–ç•¥é…ç½®</li>\n<li>è¾“å‡ºæ ¼å¼åŒ–ï¼šæ”¯æŒåŸºäºŽ schema çš„è¾“å‡ºéªŒè¯å’Œæ ¼å¼åŒ–</li>\n</ul>\n<p>è¿™ç§æŠ½è±¡è®¾è®¡ä½¿å¾— Agent ç³»ç»Ÿå…·æœ‰é«˜åº¦çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡ç»„åˆä¸åŒçš„èµ„æºã€actionså’Œé…ç½®æ¥æž„å»ºæ»¡è¶³ç‰¹å®šéœ€æ±‚çš„Agentã€‚</p>\n<h3 id=\"31-å®šä¹‰\">3.1 å®šä¹‰</h3>\n<p>ReActAgent çš„å®šä¹‰å¦‚ä¸‹ã€‚</p>\n<pre><code class=\"language-python\">class ReActAgent(Agent):\n    \"\"\"Built-in implementation of ReAct agent which is based on the function\n    call ability of llm.\n\n    This implementation is not based on the foundational ReAct paper which uses\n    prompt to force llm output contain &lt;Thought&gt;, &lt;Action&gt; and &lt;Observation&gt; and\n    extract tool calls by text parsing. For a more robust and feature-rich\n    implementation we use the tool/function call ability of current llm, and get\n    the tool calls from response directly.\n\n    Example:\n        ::\n\n            class OutputData(BaseModel):\n                result: int\n\n\n            env = AgentsExecutionEnvironment.get_execution_environment()\n\n            # register resource to execution environment\n            (\n                env.add_resource(\n                    \"ollama\",\n                    ResourceDescriptor(clazz=OllamaChatModelConnection, model=model),\n                )\n                .add_resource(\"add\", add)\n                .add_resource(\"multiply\", multiply)\n            )\n\n            # prepare prompt\n            prompt = Prompt.from_messages(\n                messages=[\n                    ChatMessage(\n                        role=MessageRole.SYSTEM,\n                        content='An example of output is {\"result\": 30.32}.',\n                    ),\n                    ChatMessage(\n                        role=MessageRole.USER, content=\"What is ({a} + {b}) * {c}\"\n                    ),\n                ],\n            )\n\n            # create ReAct agent.\n            agent = ReActAgent(\n                chat_model=ResourceDescriptor(\n                    clazz=OllamaChatModelSetup,\n                    connection=\"ollama_server\",\n                    tools=[\"notify_shipping_manager\"],\n                ),\n                prompt=prompt,\n                output_schema=OutputData,\n            )\n    \"\"\"\n\n    def __init__(\n        self,\n        *,\n        chat_model: ResourceDescriptor,\n        prompt: Prompt | None = None,\n        output_schema: type[BaseModel] | RowTypeInfo | None = None,\n    ) -&gt; None:\n        \"\"\"Init method of ReActAgent.\n\n        Parameters\n        ----------\n        chat_model : ResourceDescriptor\n            The descriptor of the chat model used in this ReAct agent.\n        prompt : Optional[Prompt] = None\n            Prompt to instruct the llm, could include input and output example,\n            task and so on.\n        output_schema : Optional[Union[type[BaseModel], RowTypeInfo]] = None\n            The schema should be RowTypeInfo or subclass of BaseModel. When user\n            provide output schema, ReAct agent will add system prompt to instruct\n            response format of llm, and add output parser according to the schema.\n        \"\"\"\n        super().__init__()\n        self.add_resource(_DEFAULT_CHAT_MODEL, chat_model)\n\n        if output_schema:\n            if isinstance(output_schema, type) and issubclass(output_schema, BaseModel):\n                json_schema = output_schema.model_json_schema()\n            elif isinstance(output_schema, RowTypeInfo):\n                json_schema = str(output_schema)\n            else:\n                err_msg = f\"Output schema {output_schema.__class__} is not supported.\"\n                raise TypeError(err_msg)\n            schema_prompt = f\"The final response should be json format, and match the schema {json_schema}.\"\n            self._resources[ResourceType.PROMPT][_DEFAULT_SCHEMA_PROMPT] = (\n                Prompt.from_text(text=schema_prompt)\n            )\n\n        if prompt:\n            self._resources[ResourceType.PROMPT][_DEFAULT_USER_PROMPT] = prompt\n\n        self.add_action(\n            name=\"stop_action\",\n            events=[ChatResponseEvent],\n            func=self.stop_action,\n            output_schema=OutputSchema(output_schema=output_schema),\n        )\n</code></pre>\n<h3 id=\"32-æ·±åº¦å®šåˆ¶\">3.2 æ·±åº¦å®šåˆ¶</h3>\n<p>Flink å¯¹ ReActAgent åšäº†æ·±åº¦å®šåˆ¶ï¼Œä½¿å…¶èƒ½åœ¨åˆ†å¸ƒå¼æµå¤„ç†çŽ¯å¢ƒä¸­é«˜æ•ˆæ‰§è¡Œï¼Œå¹¶æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½æ¥ç®€åŒ– LLM åº”ç”¨å¼€å‘ã€‚</p>\n<h4 id=\"321-reactagent-ç‰¹è‰²\">3.2.1 ReActAgent ç‰¹è‰²</h4>\n<h5 id=\"æµå¼å¤„ç†é€‚é…\">æµå¼å¤„ç†é€‚é…</h5>\n<p>Flink å°†ä¼ ç»Ÿçš„ ReAct æ¨¡å¼é€‚é…åˆ°äº†æµå¤„ç†çŽ¯å¢ƒä¸­ï¼š</p>\n<ul>\n<li>é€šè¿‡ InputEvent å’Œ OutputEvent åŒ…è£…è¾“å…¥è¾“å‡ºæ•°æ®</li>\n<li>åˆ©ç”¨ Flink çš„äº‹ä»¶é©±åŠ¨æž¶æž„å®žçŽ°å¼‚æ­¥å¤„ç†</li>\n<li>é€šè¿‡ RunnerContext ç®¡ç†çŠ¶æ€å’Œèµ„æº</li>\n</ul>\n<pre><code class=\"language-python\">agents_env = AgentsExecutionEnvironment.get_execution_environment(env)\nagents_env.fromDataStream(dataStream) # ä»ŽDataStreamè¾“å…¥\nagents_env.fromTable(table) # ä»ŽTableè¾“å…¥\nagents_env.fromList(list) # ä»ŽListè¾“å…¥\n\nreview_analysis_res_stream = (\n        agents_env.from_datastream( # ä»ŽDataSteamåˆ›å»ºAgentæµç¨‹\n            input=product_review_stream, key_selector=lambda x: x.id\n        )\n        .apply(review_analysis_react_agent) # åº”ç”¨Agent\n        .to_datastream() # è½¬æ¢å›žStream\n    )\n</code></pre>\n<h5 id=\"ç‰¹å®šçš„è¡Œä¸ºæ¨¡å¼\">ç‰¹å®šçš„è¡Œä¸ºæ¨¡å¼</h5>\n<p>ReActAgent å®žçŽ°äº†ç‰¹å®šçš„ ReActï¼ˆReasoning + Actionï¼‰èŒƒå¼ï¼Œè¿™æ˜¯ä¸€ç§ç»“åˆæŽ¨ç†å’Œè¡ŒåŠ¨çš„ AI Agent æ¨¡å¼ã€‚å®ƒå†…ç½®äº†ä¸¤ä¸ªæ ¸å¿ƒåŠ¨ä½œï¼šstart_action()å’Œ stop_action()ã€‚ä½¿ç”¨é¢„å®šä¹‰çš„æµç¨‹æ¥å¤„ç†è¾“å…¥å¹¶ç”Ÿæˆè¾“å‡ºï¼Œè€Œéžè®©ç”¨æˆ·å®Œå…¨è‡ªå®šä¹‰è¡Œä¸ºé€»è¾‘ã€‚</p>\n<ul>\n<li>start_action æŽ¥æ”¶è¾“å…¥å¹¶å‘é€ ChatRequestEvent</li>\n<li>stop_action å¤„ç† ChatResponseEvent å¹¶äº§ç”Ÿæœ€ç»ˆè¾“å‡º</li>\n</ul>\n<h5 id=\"é”®æŽ§çŠ¶æ€æ”¯æŒ\">é”®æŽ§çŠ¶æ€æ”¯æŒ</h5>\n<p>æ”¯æŒFlinkçš„é”®æŽ§çŠ¶æ€ç‰¹æ€§</p>\n<pre><code class=\"language-python\">review_analysis_res_stream = (\n    agents_env.from_datastream(\n        input=product_review_stream, key_selector=lambda x: x.id\n    )\n    .apply(review_analysis_react_agent)\n    .to_datastream()\n)\n</code></pre>\n<h5 id=\"llm-é›†æˆä¼˜åŒ–\">LLM é›†æˆä¼˜åŒ–</h5>\n<p>ReActAgent ä¸“é—¨ä¸º LLM äº¤äº’è¿›è¡Œä¼˜åŒ–ï¼šå†…ç½®äº†æç¤ºè¯ç®¡ç†å’Œæ ¼å¼åŒ–åŠŸèƒ½ï¼›æ”¯æŒç»“æž„åŒ–è¾“å‡ºæ¨¡å¼ï¼Œå¯ä»¥æŒ‡å®šè¾“å‡ºçš„æ•°æ®schemaï¼›é›†æˆäº†é”™è¯¯å¤„ç†ç­–ç•¥ï¼Œå½“LLMè¾“å‡ºä¸ç¬¦åˆé¢„æœŸæ ¼å¼æ—¶å¯ä»¥é€‰æ‹©å¤±è´¥æˆ–è€…å¿½ç•¥ã€‚</p>\n<h5 id=\"èµ„æºç®¡ç†æ–¹å¼\">èµ„æºç®¡ç†æ–¹å¼</h5>\n<p>ReActAgent ä¸­è‡ªåŠ¨æ·»åŠ é»˜è®¤èµ„æºï¼Œç›¸æ¯”æ™®é€šçš„Agentï¼ŒReActAgent ä¼šè‡ªåŠ¨ä¸ºç”¨æˆ·è®¾ç½®å¥½å¿…è¦çš„èµ„æºï¼Œç®€åŒ–ä½¿ç”¨æµç¨‹ã€‚é€šè¿‡ç»Ÿä¸€çš„èµ„æºç®¡ç†ç³»ç»Ÿä¸ŽFlinké›†æˆã€‚ReActAgent é€šè¿‡ _DEFAULT_CHAT_MODEL ç­‰å¸¸é‡å¼•ç”¨åœ¨ AgentsExecutionEnvironment ä¸­æ³¨å†Œçš„èµ„æºã€‚</p>\n<pre><code class=\"language-python\">agents_env.add_resource(_DEFAULT_CHAT_MODEL, chat_model)\nagents_env.addResource(\"ollama_server\", ResourceDescriptor(...))\nagents_env.addResource(\"notify_shipping_manager\", Tool.from_callable(...))\n</code></pre>\n<h5 id=\"ç±»åž‹ä¿¡æ¯å¤„ç†\">ç±»åž‹ä¿¡æ¯å¤„ç†</h5>\n<p>Flink Agentèƒ½å¤Ÿå¤„ç†Flinkçš„ç±»åž‹ç³»ç»Ÿ</p>\n<pre><code class=\"language-python\">        if (outputSchema != null) {\n            String jsonSchema;\n            // æ”¯æŒRowTypeInfoå’ŒPOJOç±»åž‹\n            if (outputSchema instanceof RowTypeInfo) {\n            \t// å¤„ç†Rowç±»åž‹\n                jsonSchema = outputSchema.toString();\n                outputSchema = new OutputSchema((RowTypeInfo) outputSchema);\n            } else if (outputSchema instanceof Class) {\n            \t// å¤„ç†POJOç±»åž‹\n                try {\n                    jsonSchema = mapper.generateJsonSchema((Class&lt;?&gt;) outputSchema).toString();\n                } catch (JsonMappingException e) {\n                    throw new RuntimeException(e);\n                }\n            } \n</code></pre>\n<h5 id=\"é”™è¯¯å¤„ç†æœºåˆ¶\">é”™è¯¯å¤„ç†æœºåˆ¶</h5>\n<p>Flink ä¸º ReActAgent å®žçŽ°äº†çµæ´»çš„å¤„ç†å¤„ç†ç­–ç•¥ï¼Œè¿è¡Œç”¨æˆ·é€‰æ‹©åœ¨è§£æžå¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸è¿˜æ˜¯å¿½ç•¥é”™è¯¯ã€‚</p>\n<pre><code class=\"language-python\">        except Exception:\n            if error_handling_strategy == ErrorHandlingStrategy.IGNORE:\n                logging.warning(\n                    f\"The response of llm {output} doesn't match schema constraint, ignoring.\"\n                )\n                return\n            elif error_handling_strategy == ErrorHandlingStrategy.FAIL:\n                raise\n</code></pre>\n<h5 id=\"ç»“æž„åŒ–è¾“å‡ºæ”¯æŒ\">ç»“æž„åŒ–è¾“å‡ºæ”¯æŒ</h5>\n<p>Flink ä¸º ReActAgent æ·»åŠ äº†ç»“æž„åŒ–è¾“å‡ºçš„èƒ½åŠ›ï¼Œè¿™æ ·å¯ä»¥è®© LLM çš„è¾“å‡ºç¬¦åˆé¢„å®šä¹‰çš„æ•°æ®ç»“æž„ï¼Œä¾¿äºŽåŽç»­ç®¡ç†ã€‚</p>\n<pre><code class=\"language-python\">        if output_schema:\n            if isinstance(output_schema, type) and issubclass(output_schema, BaseModel):\n                json_schema = output_schema.model_json_schema()\n            elif isinstance(output_schema, RowTypeInfo):\n                json_schema = str(output_schema)\n            else:\n                err_msg = f\"Output schema {output_schema.__class__} is not supported.\"\n                raise TypeError(err_msg)\n            schema_prompt = f\"The final response should be json format, and match the schema {json_schema}.\"\n            self._resources[ResourceType.PROMPT][_DEFAULT_SCHEMA_PROMPT] = (\n                Prompt.from_text(text=schema_prompt)\n            )\n</code></pre>\n<h5 id=\"æç¤ºè¯æ¨¡æ¿ç³»ç»Ÿ\">æç¤ºè¯æ¨¡æ¿ç³»ç»Ÿ</h5>\n<p>Flink å®žçŽ°äº†ä¸€ä¸ªå®Œæ•´çš„æç¤ºè¯æ¨¡æ¿ç®¡ç†ç³»ç»Ÿï¼š</p>\n<ul>\n<li>æ”¯æŒå­—ç¬¦ä¸²æ¨¡æ¿å’Œæ¶ˆæ¯åˆ—è¡¨æ¨¡åž‹</li>\n<li>æä¾›æ ¼å¼åŒ–åŠŸèƒ½ï¼Œå¯ä»¥åŠ¨æ€æ›¿æ¢æ¨¡æ¿ä¸­çš„å ä½ç¬¦</li>\n<li>è‡ªåŠ¨å¤„ç†ä¸åŒç±»åž‹è¾“å…¥çš„è½¬æ¢</li>\n</ul>\n<h5 id=\"å·¥å…·è°ƒç”¨é›†æˆ\">å·¥å…·è°ƒç”¨é›†æˆ</h5>\n<p>Flink å°†å·¥å…·è°ƒç”¨é›†æˆåˆ° ReActAgentä¸­ã€‚</p>\n<pre><code class=\"language-python\"># æ³¨å†Œå·¥å…·èµ„æº\n    # Add Ollama chat model connection and notify shipping manager tool to be used\n    # by the Agent.\n    agents_env.add_resource(\n        \"ollama_server\",\n        ResourceDescriptor(clazz=OllamaChatModelConnection, request_timeout=120),\n    ).add_resource(\n        \"notify_shipping_manager\", Tool.from_callable(notify_shipping_manager)\n    )\n    \n# åœ¨Agent ä¸­ä½¿ç”¨å·¥å…·\n    # Create react agent\n    review_analysis_react_agent = ReActAgent(\n        chat_model=ResourceDescriptor(\n            clazz=OllamaChatModelSetup,\n            connection=\"ollama_server\",\n            model=\"qwen3:8b\",\n            tools=[\"notify_shipping_manager\"],\n        ),\n        prompt=review_analysis_react_prompt,\n        output_schema=ProductReviewAnalysisRes,\n    )\n</code></pre>\n<h5 id=\"è¿è¡Œæ—¶åä½œ\">è¿è¡Œæ—¶åä½œ</h5>\n<ul>\n<li>æ‰§è¡ŒçŽ¯å¢ƒè´Ÿè´£è°ƒåº¦å’Œè¿è¡ŒAgentä¸­çš„å„ä¸ªç»„ä»¶</li>\n<li>Agenté€šè¿‡RunnerContext è®¿é—®åœ¨çŽ¯å¢ƒä¸­æ³¨å†Œçš„èµ„æº</li>\n<li>æ•´ä¸ªè¿‡ç¨‹é‡‡ç”¨äº‹ä»¶é©±åŠ¨çš„æ–¹å¼ï¼Œé€šè¿‡å‘é€å’ŒæŽ¥æ”¶äº‹ä»¶æ¥æŽ¨è¿›æ‰§è¡Œæµç¨‹</li>\n</ul>\n<h3 id=\"33-å…¸åž‹æ‰§è¡Œæµç¨‹\">3.3 å…¸åž‹æ‰§è¡Œæµç¨‹</h3>\n<p>å¯¹äºŽ ReActAgent æ¥è¯´ï¼Œå…·ä½“é€‚é…æµç¨‹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>çŽ¯å¢ƒåˆå§‹åŒ–ï¼šé€šè¿‡ AgentsExecutionEnvironment.get_execution_environment(env) èŽ·å–é€‚å½“çš„æ‰§è¡ŒçŽ¯å¢ƒ</li>\n<li>èµ„æºé…ç½®ï¼šä½¿ç”¨ addResource() æ·»åŠ æ¨¡åž‹ã€å·¥å…·ç­‰èµ„æº</li>\n<li>è¾“å…¥è®¾ç½®ï¼šé€šè¿‡fromDataStream()ã€ fromTable()ç­‰è®¾ç½®è¾“å…¥æº</li>\n<li>Agentåº”ç”¨ï¼šä½¿ç”¨ apply()æ–¹æ³•åº”ç”¨Agent é€»è¾‘</li>\n<li>è¾“å‡ºèŽ·å–ï¼šé€šè¿‡ toDataStream() èŽ·å–å¤„ç†åŽçš„ DataStream</li>\n<li>æ‰§è¡Œï¼šé€šè¿‡execute() è§¦å‘Flinkä½œä¸šæ‰§è¡Œ</li>\n</ul>\n<p>å…¸åž‹çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>run å‡½æ•°æŽ¥æ”¶åˆ°è¾“å…¥æ•°æ®</li>\n<li>åˆ›å»ºInputEvent å¹¶å‘é€åˆ°äº‹ä»¶é˜Ÿåˆ—</li>\n<li>start_actionå¤„ç†InputEventï¼Œæ ¼å¼åŒ–è¾“å…¥å¹¶å‘é€ ChatRequestEvent</li>\n<li>LLMå¤„ç†åŽäº§ç”Ÿ ChatResponseEvent</li>\n<li>stop_action å¤„ç† ChatResponseEventï¼Œè§£æžç»“æžœå¹¶å‘é€ OutputEvent</li>\n<li>run å‡½æ•°æ”¶é›† OutputEvent å¹¶è¿”å›žç»“æžœ</li>\n</ul>\n<p>å…³é”®ç‰¹ç‚¹æ˜¯ï¼š</p>\n<ul>\n<li>äº‹ä»¶é©±åŠ¨ï¼šä½¿ç”¨äº‹ä»¶é˜Ÿåˆ—é©±åŠ¨æ•´ä¸ªæ‰§è¡Œæµç¨‹</li>\n<li>ä¸Šä¸‹æ–‡éš”ç¦»ï¼šæ¯ä¸ªé”®å€¼å¯¹åº”ç‹¬ç«‹çš„æ‰§è¡Œä¸Šä¸‹æ–‡</li>\n<li>å¼‚æ­¥æ”¯æŒï¼šè™½ç„¶æœ¬åœ°æ‰§è¡ŒçŽ¯å¢ƒå›žé€€åˆ°åŒæ­¥æ‰§è¡Œï¼Œä½†ä»ç„¶æ”¯æŒå¼‚æ­¥æŽ¥å£</li>\n<li>çŠ¶æ€ç®¡ç†ï¼šé€šè¿‡ LocalRunnerContext ç®¡ç†çŸ­æœŸè®°å¿†å’Œèµ„æºé…ç½®</li>\n</ul>\n<h3 id=\"34-start_action-ä¸Ž-stop_action\">3.4 start_action ä¸Ž stop_action</h3>\n<p><strong>æ•´ä½“æµç¨‹ç‰¹è‰²</strong></p>\n<p>è¿™ä¸¤ä¸ª action æž„æˆå®Œæ•´çš„ ReAct æ¨¡å¼ï¼š</p>\n<ul>\n<li>å¼€å§‹-ç»“æŸæ¨¡å¼ï¼šstart_action ä½œä¸ºå…¥å£ï¼Œå°†åŽŸå§‹è¾“å…¥è½¬åŒ–ä¸ºé€‚åˆ LLM å¤„ç†çš„æ ¼å¼ï¼›stop_action ä½œä¸ºå‡ºå£ï¼Œå°† LLM å“åº”è½¬æ¢ä¸ºç»“æž„åŒ–è¾“å‡ºã€‚</li>\n<li>ä¸­é—´å¤„ç†é€æ˜ŽåŒ–ï¼šç”¨æˆ·æ— éœ€å…³å¿ƒä¸­é—´æ­¥éª¤ï¼ˆå¦‚å·¥å…·è°ƒç”¨ã€ä¸Šä¸‹æ–‡æ£€ç´¢ç­‰ï¼‰ï¼Œè¿™äº›ç”±å†…ç½®çš„ CHAT_MODEL_ACTIONã€TOOL_CALL_ACTION ç­‰è‡ªåŠ¨å¤„ç†ã€‚</li>\n<li>å¯é…ç½®æ€§ï¼šæ”¯æŒè‡ªå®šä¹‰ Promptã€è¾“å‡º schema å®šä¹‰åŠé”™è¯¯å¤„ç†ç­–ç•¥ã€‚</li>\n</ul>\n<p><strong>åŠŸèƒ½</strong></p>\n<p>ReActAgent çš„ start_action ä¸Ž stop_action å„å…·ç‰¹å¾ï¼ŒäºŒè€…åˆ†åˆ«æ‰¿æ‹…å¯¹è¯çš„å‘èµ·ä¸Žç»ˆç»“èŒè´£ã€‚</p>\n<ul>\n<li>start_action è´Ÿè´£è¾“å…¥äº‹ä»¶çš„å¤„ç†ã€‚å®ƒé¦–å…ˆæŽ¥æ”¶ InputEventï¼Œä½œä¸ºæ•´ä¸ª Agent æµç¨‹çš„èµ·ç‚¹ï¼Œå¯æŽ¥å—åŽŸå§‹ç±»åž‹ã€å¤æ‚å¯¹è±¡æˆ– Row ç­‰å¤šç§æ•°æ®ã€‚è‹¥æä¾› Promptï¼Œåˆ™ä»¥æ­¤æ ¼å¼åŒ–ç”¨æˆ·è¾“å…¥ï¼Œå°†ç®€å•å­—ç¬¦ä¸²æˆ–å¤æ‚å¯¹è±¡ï¼ˆå¦‚ Row æˆ– POJOï¼‰çš„å±žæ€§è‡ªåŠ¨æå–å¹¶å¡«å…¥æ¨¡æ¿ã€‚éšåŽï¼Œç³»ç»Ÿè‡ªåŠ¨è¿½åŠ  schema promptï¼Œçº¦æŸå¤§æ¨¡åž‹è¾“å‡ºç»“æž„ï¼Œå†å°†æ•´ç†åŽçš„å†…å®¹å°è£…ä¸º ChatRequestEventï¼Œè§¦å‘åŽç»­å¤„ç†ï¼Œé»˜è®¤è°ƒç”¨ _DEFAULT_CHAT_MODEL å®Œæˆé¦–æ¬¡ç”Ÿæˆã€‚</li>\n<li>stop_action åˆ™å¤„ç†è¾“å‡ºäº‹ä»¶ã€‚å®ƒä»¥ ChatResponseEvent ä¸ºè¾“å…¥ï¼Œæ ‡å¿—å¤§æ¨¡åž‹ç”Ÿæˆå®Œæ¯•ï¼Œæ˜¯æ•´ä¸ªæµç¨‹çš„ç»ˆç‚¹ã€‚è¯¥åŠ¨ä½œæ”¯æŒæŒ‰ schema è§£æžä¸ŽéªŒè¯è¿”å›žç»“æžœï¼Œå¯å°† JSON æ–‡æœ¬è½¬æ¢ä¸º Pydantic æ¨¡åž‹æˆ– RowTypeInfo æŒ‡å®šç»“æž„ï¼Œå¹¶æä¾›é”™è¯¯å¤„ç†ç­–ç•¥ï¼ˆå¿½ç•¥æˆ–æŠ›å‡ºå¼‚å¸¸ï¼‰ï¼Œä¿è¯è¾“å‡ºç±»åž‹å®‰å…¨ä¸Žä¸šåŠ¡ä¸€è‡´æ€§ã€‚</li>\n</ul>\n<p><strong>ä¸Žå…¶ä»–ç»„ä»¶çš„åä½œ</strong></p>\n<p>åœ¨ ReActAgent åˆå§‹åŒ–æ—¶æ³¨å†Œè¿™ä¸¤ä¸ª actionï¼š</p>\n<pre><code class=\"language-python\">self.add_action(\n    name=\"stop_action\",\n    events=[ChatResponseEvent],\n    func=self.stop_action,\n    output_schema=OutputSchema(output_schema=output_schema),\n)\n</code></pre>\n<p>è¿™ä¸¤ä¸ª action ä¸Ž Agent å†…ç½®çš„å…¶ä»– actionï¼ˆå¦‚å·¥å…·è°ƒç”¨ã€ä¸Šä¸‹æ–‡æ£€ç´¢ï¼‰é…åˆå·¥ä½œï¼Œåœ¨ ActionExecutionOperator ä¸­å½¢æˆä¸€ä¸ªå®Œæ•´çš„äº‹ä»¶é©±åŠ¨å¤„ç†é“¾ã€‚</p>\n<h3 id=\"35-è¾“å…¥è¾“å‡º\">3.5 è¾“å…¥è¾“å‡º</h3>\n<p>Flink Agent çš„è¾“å…¥è¾“å‡ºå…·æœ‰ä»¥ä¸‹å‡ ä¸ªæ˜¾è‘—ç‰¹ç‚¹ï¼Œå¹¶é€šè¿‡ç‰¹å®šæœºåˆ¶ä¸ŽFlinkè¿›è¡Œé€‚é…ã€‚</p>\n<h4 id=\"351-äº‹ä»¶é©±åŠ¨æž¶æž„\">3.5.1 äº‹ä»¶é©±åŠ¨æž¶æž„</h4>\n<p>Flink Agent åŸºäºŽäº‹ä»¶é©±åŠ¨æ¨¡åž‹ï¼Œè¾“å…¥å’Œè¾“å‡ºéƒ½æ˜¯é€šè¿‡äº‹ä»¶å¯¹è±¡è¿›è¡Œä¼ é€’ï¼š</p>\n<ul>\n<li>è¾“å…¥ï¼šé€šè¿‡InputEvent å°è£…åŽŸå§‹æ•°æ®</li>\n<li>è¾“å‡ºï¼šé€šè¿‡OutputEventå°è£…å¤„ç†ç»“æžœ</li>\n<li>ä¸­é—´äº‹ä»¶ï¼šåŒ…æ‹¬ ChatRequestEventã€ChatResponseEventã€ToolRequestEventã€ToolResponseEventç­‰</li>\n</ul>\n<h4 id=\"352-ç»Ÿä¸€çš„æ•°æ®å°è£…\">3.5.2 ç»Ÿä¸€çš„æ•°æ®å°è£…</h4>\n<p>æ‰€æœ‰æ•°æ®éƒ½è¢«å°è£…æˆäº‹ä»¶å¯¹è±¡ï¼Œä¾¿äºŽAgentå†…éƒ¨æµè½¬å’Œå¤„ç†ã€‚</p>\n<h4 id=\"353-æ”¯æŒå¤šç§æ•°æ®ç±»åž‹\">3.5.3 æ”¯æŒå¤šç§æ•°æ®ç±»åž‹</h4>\n<p>è¾“å…¥æ”¯æŒå¤šç§æ•°æ®ç±»åž‹ï¼š</p>\n<ul>\n<li>åŸºæœ¬æ•°æ®ç±»åž‹</li>\n<li>Flink Rowå¯¹è±¡</li>\n<li>POJOå¯¹è±¡</li>\n<li>å¤æ‚åµŒå¥—ç»“æžœ</li>\n</ul>\n<p>è¾“å‡ºåŒæ ·æ”¯æŒçµæ´»çš„æ•°æ®ç»“æž„ï¼Œå¯ä»¥é€šè¿‡schemaè¿›è¡Œçº¦æŸ</p>\n<h4 id=\"354-å†…ç½®æ¨¡æ¿æ”¯æŒ\">3.5.4 å†…ç½®æ¨¡æ¿æ”¯æŒ</h4>\n<p>é€šè¿‡Promptç±»æ”¯æŒæ¨¡æ¿åŒ–è¾“å…¥å¤„ç†ï¼Œå¯ä»¥å®šä¹‰å¤æ‚çš„æç¤ºè¯æ¨¡æ¿</p>\n<h3 id=\"36-æ¨¡æ¿ç³»ç»Ÿ\">3.6 æ¨¡æ¿ç³»ç»Ÿ</h3>\n<p>æ¨¡æ¿å¯ä»¥ç”¨åœ¨æç¤ºè¯å’ŒSchemaã€‚Flink Agent ä¸­çš„æ¨¡æ¿ç³»ç»Ÿä¸»è¦åœ¨ Prompt ç±»ä¸­å®žçŽ°ï¼Œæ”¯æŒä¸¤ç§ç±»åž‹çš„æ¨¡æ¿ï¼š</p>\n<h4 id=\"361-å­—ç¬¦ä¸²æ¨¡æ¿\">3.6.1 å­—ç¬¦ä¸²æ¨¡æ¿</h4>\n<p>æœ€åŸºæœ¬çš„æ¨¡æ¿å½¢å¼ï¼Œå°±æ˜¯ä¸€ä¸ªåŒ…å«å ä½ç¬¦çš„å­—ç¬¦ä¸²ï¼š</p>\n<pre><code class=\"language-java\">        String specialTemplate = \"Handle special chars: {text} with symbols like @#$%^&amp;*()\";\n        Prompt specialPrompt = new Prompt(specialTemplate);\n\n        Map&lt;String, String&gt; specialVars = new HashMap&lt;&gt;();\n        specialVars.put(\"text\", \"Hello &amp; Welcome!\");\n\n        String result = specialPrompt.formatString(specialVars);\n\n</code></pre>\n<h4 id=\"362-æ¶ˆæ¯æ¨¡æ¿\">3.6.2 æ¶ˆæ¯æ¨¡æ¿</h4>\n<p>æ›´å¤æ‚çš„æ¨¡æ¿å½¢å¼ï¼ŒåŒ…å«å¤šä¸ª ChatMessage å¯¹è±¡ï¼Œå¯ä»¥æŒ‡å®šä¸åŒçš„è§’è‰²ã€‚</p>\n<pre><code class=\"language-python\">        List&lt;ChatMessage&gt; multipleMessages =\n                Arrays.asList(\n                        new ChatMessage(MessageRole.SYSTEM, \"You are a helpful assistant.\"),\n                        new ChatMessage(MessageRole.USER, \"First message\"),\n                        new ChatMessage(MessageRole.ASSISTANT, \"I understand\"),\n                        new ChatMessage(\n                                MessageRole.USER, \"Second message - this should be the response\"));\n\n        Prompt multiPrompt = new Prompt(multipleMessages);\n\n</code></pre>\n<p>æ¨¡æ¿çš„ç®¡ç†æµç¨‹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>æ¨¡æ¿åˆ›å»ºï¼šç”¨æˆ·åˆ›å»º Prompt  å¯¹è±¡ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–æ¶ˆæ¯åˆ—è¡¨ã€‚</li>\n<li>å˜é‡æ›¿æ¢ï¼šä½¿ç”¨ formatString() æˆ–è€… formatMessages() æ–¹æ³•å¯¹ä¼ å…¥å˜é‡æ˜ å°„è¿›è¡Œæ›¿æ¢</li>\n<li>LLM è°ƒç”¨ï¼šæ ¼å¼åŒ–çš„æ¶ˆæ¯è¢«å‘é€ç»™LLMè¿›è¡Œå¤„ç†ã€‚</li>\n</ul>\n<pre><code class=\"language-python\">class Prompt(SerializableResource, ABC):\n    \"\"\"Base prompt abstract.\"\"\"\n\n    @staticmethod\n    def from_messages(messages: Sequence[ChatMessage]) -&gt; \"Prompt\":\n        \"\"\"Create prompt from sequence of ChatMessage.\"\"\"\n        return LocalPrompt(template=messages)\n\n    @staticmethod\n    def from_text(text: str) -&gt; \"Prompt\":\n        \"\"\"Create prompt from text string.\"\"\"\n        return LocalPrompt(template=text)\n\n    @abstractmethod\n    def format_string(self, **kwargs: str) -&gt; str:\n        \"\"\"Generate text string from template with additional arguments.\"\"\"\n\n    @abstractmethod\n    def format_messages(\n        self, role: MessageRole = MessageRole.SYSTEM, **kwargs: str\n    ) -&gt; List[ChatMessage]:\n        \"\"\"Generate list of ChatMessage from template with additional arguments.\"\"\"\n\n    @classmethod\n    @override\n    def resource_type(cls) -&gt; ResourceType:\n        \"\"\"Get the resource type.\"\"\"\n        return ResourceType.PROMPT\n\nclass LocalPrompt(Prompt):\n    \"\"\"Prompt for a language model.\n\n    Attributes:\n    ----------\n    template : Union[Sequence[ChatMessage], str]\n        The prompt template.\n    \"\"\"\n\n    template: Sequence[ChatMessage] | str\n\n    def format_string(self, **kwargs: str) -&gt; str:\n        \"\"\"Generate text string from template with input arguments.\"\"\"\n        if isinstance(self.template, str):\n            return format_string(self.template, **kwargs)\n        else:\n            msgs = []\n            for m in self.template:\n                msg = f\"{m.role.value}: {format_string(m.content, **kwargs)}\"\n                if m.extra_args is not None and len(m.extra_args) &gt; 0:\n                    msg += f\"{m.extra_args}\"\n                msgs.append(msg)\n            return \"\\n\".join(msgs)\n\n    def format_messages(\n        self, role: MessageRole = MessageRole.SYSTEM, **kwargs: str\n    ) -&gt; List[ChatMessage]:\n        \"\"\"Generate list of ChatMessage from template with input arguments.\"\"\"\n        if isinstance(self.template, str):\n            return [\n                ChatMessage(role=role, content=format_string(self.template, **kwargs))\n            ]\n        else:\n            msgs = []\n            for m in self.template:\n                msg = ChatMessage(\n                    role=m.role, content=format_string(m.content, **kwargs)\n                )\n                msgs.append(msg)\n            return msgs\n</code></pre>\n<h3 id=\"37-functiontool-ä¸Ž-action-çš„å…³è”åŠæ³¨å†Œæœºåˆ¶\">3.7 FunctionTool ä¸Ž Action çš„å…³è”åŠæ³¨å†Œæœºåˆ¶</h3>\n<p>åœ¨ Flink Agents æ¡†æž¶ä¸­ï¼Œfunction tool ä¸Ž action çš„è”ç³»å’Œæ³¨å†Œæ¶‰åŠå¤šä¸ªç»„ä»¶å’Œæ­¥éª¤ã€‚</p>\n<h4 id=\"371-å®žé™…è½¬æ¢æµç¨‹\">3.7.1 å®žé™…è½¬æ¢æµç¨‹</h4>\n<p>å…·ä½“çš„å·¥å…·åˆ° prompt çš„è½¬æ¢è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>\n<ol>\n<li>å·¥å…·é€šè¿‡ @Tool æˆ– @tool æ³¨å†Œåˆ°æ‰§è¡ŒçŽ¯å¢ƒä¸­</li>\n<li>åœ¨åˆ›å»º ResourceDescriptor æ—¶ï¼Œé€šè¿‡ tools å‚æ•°å¼•ç”¨è¿™äº›å·²æ³¨å†Œçš„å·¥å…·</li>\n<li>å½“èŠå¤©æ¨¡åž‹ setup ç±»ï¼ˆå¦‚ OllamaChatModelSetupï¼‰åˆå§‹åŒ–æ—¶ï¼Œå®ƒä¼šèŽ·å–è¿™äº›å·¥å…·çš„å…ƒæ•°æ®ï¼ˆåŒ…æ‹¬åç§°å’Œæè¿°ï¼‰</li>\n<li>è¿™äº›å·¥å…·ä¿¡æ¯ä¼šè¢«è‡ªåŠ¨æ•´åˆåˆ°å‘é€ç»™ LLM çš„ç³»ç»Ÿ prompt ä¸­ï¼Œå‘ŠçŸ¥ LLM æœ‰å“ªäº›å¯ç”¨å·¥å…·åŠå…¶ç”¨é€”</li>\n</ol>\n<p>è¿™ç§æ–¹å¼ä½¿å¾—å¼€å‘è€…åªéœ€å…³æ³¨å·¥å…·çš„å®šä¹‰å’Œæ³¨å†Œï¼Œè€Œæ— éœ€æ‰‹åŠ¨ç¼–å†™å·¥å…·æè¿°åˆ° prompt ä¸­ï¼Œæé«˜äº†å¼€å‘æ•ˆçŽ‡å¹¶å‡å°‘äº†å‡ºé”™å¯èƒ½æ€§ã€‚</p>\n<h5 id=\"function-tool-æ³¨å†Œåˆ°-agent\">Function Tool æ³¨å†Œåˆ° Agent</h5>\n<p>Function tool é¦–å…ˆé€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼æ³¨å†Œåˆ°æ‰§è¡ŒçŽ¯å¢ƒä¸­ï¼š</p>\n<p><strong>æ–¹å¼ä¸€ï¼šä½¿ç”¨è£…é¥°å™¨</strong></p>\n<pre><code class=\"language-python\">    @tool\n    @staticmethod\n    def notify_shipping_manager(id: str, review: str) -&gt; None:\n        \"\"\"Notify the shipping manager when product received a negative review due to\n        shipping damage.\n\n        Parameters\n        ----------\n        id : str\n            The id of the product that received a negative review due to shipping damage\n        review: str\n            The negative review content\n        \"\"\"\n        # reuse the declared function, but for parsing the tool metadata, we write doc\n        # string here again.\n        notify_shipping_manager(id=id, review=review)\n</code></pre>\n<p><strong>æ–¹å¼äºŒï¼šä½¿ç”¨ add_resource æ–¹æ³•</strong></p>\n<p>å³ï¼Œåœ¨æ‰§è¡ŒçŽ¯å¢ƒæ³¨å†Œå·¥å…·èµ„æºã€‚</p>\n<pre><code class=\"language-python\">def add(a: int, b: int) -&gt; int:\n    \"\"\"Calculate the sum of a and b.\n\n    Parameters\n    ----------\n    a : int\n        The first operand\n    b : int\n        The second operand\n\n    Returns:\n    -------\n    int:\n        The sum of a and b\n    \"\"\"\n    return a + b\n\nenv.add_resource(\"add\", ResourceType.TOOL, add)\n</code></pre>\n<p><strong>æ–¹å¼ä¸‰ï¼šåœ¨ Agent æž„é€ å‡½æ•°ä¸­æ·»åŠ </strong></p>\n<pre><code class=\"language-python\">class MyAgent(Agent):\n    def __init__(self):\n        super().__init__()\n        self.add_resource(\"add\", add) # æ·»åŠ åˆ° TOOL ç±»åž‹èµ„æºä¸­\n</code></pre>\n<p><strong>æ–¹å¼å››ï¼šåœ¨  ReActAgent æž„å»ºæ—¶å€™ä¼ å…¥</strong></p>\n<p>å³ï¼Œé€šè¿‡ tools å‚æ•°æŒ‡å®šã€‚</p>\n<pre><code class=\"language-java\">    // Create ReAct agent.\n    private static ReActAgent getReActAgent() {\n        return new ReActAgent(\n                ResourceDescriptor.Builder.newBuilder(OllamaChatModelSetup.class.getName())\n                        .addInitialArgument(\"connection\", \"ollamaChatModelConnection\")\n                        .addInitialArgument(\"model\", \"qwen3:8b\")\n                        .addInitialArgument(\n                                \"tools\", Collections.singletonList(\"notifyShippingManager\"))\n                        .build(),\n                reviewAnalysisReactPrompt(),\n                CustomTypesAndResources.ProductReviewAnalysisRes.class);\n    }\n</code></pre>\n<h5 id=\"ä¸Žæ¨¡åž‹äº¤äº’\">ä¸Žæ¨¡åž‹äº¤äº’</h5>\n<p>Chat Model Setup ä¸­å¼•ç”¨å·¥å…·</p>\n<p>åœ¨åˆ›å»º Chat Model Setup æ—¶ï¼Œé€šè¿‡ tools å‚æ•°æŒ‡å®šè¦ä½¿ç”¨çš„å·¥å…·åˆ—è¡¨ï¼š</p>\n<pre><code class=\"language-python\">chat_model_descriptor = ResourceDescriptor(\nclazz=OllamaChatModelSetup,\nconnection=\"my_ollama_connection\",\nmodel=\"qwen3:8b\",\ntools=[\"notify_shipping_manager\"]   # å¼•ç”¨å·²æ³¨å†Œçš„å·¥å…·\n)\n</code></pre>\n<h4 id=\"372-agentplan-ç¼–è¯‘è¿‡ç¨‹ä¸­å·¥å…·çš„å¤„ç†\">3.7.2 AgentPlan ç¼–è¯‘è¿‡ç¨‹ä¸­å·¥å…·çš„å¤„ç†</h4>\n<p>Flink Agents å†…ç½®äº†ä¸€ä¸ª TOOL_CALL_ACTIONï¼Œï¼Œä¸“é—¨ç”¨äºŽè°ƒç”¨å·¥å…·ã€‚TOOL_CALL_ACTION ä¸Žç”¨æˆ·å®šä¹‰å·¥å…·å‡½æ•°çš„è”ç³»ä¸»è¦ä¾èµ–äºŽï¼š</p>\n<ul>\n<li>ç»Ÿä¸€çš„å‘½åç³»ç»Ÿï¼šå·¥å…·å‡½æ•°çš„åç§°ä½œä¸ºå”¯ä¸€æ ‡è¯†ç¬¦</li>\n<li>èµ„æºç®¡ç†æœºåˆ¶ï¼šé€šè¿‡ RunnerContext.get_resource() æ–¹æ³•æŒ‰åç§°æ£€ç´¢å·¥å…·</li>\n<li>æ ‡å‡†åŒ–æŽ¥å£ï¼šæ‰€æœ‰å·¥å…·éƒ½å®žçŽ°ç›¸åŒçš„ call() æŽ¥å£</li>\n<li>äº‹ä»¶é©±åŠ¨æž¶æž„ï¼šé€šè¿‡ ToolRequestEvent å’Œ ToolResponseEvent ä¼ é€’è°ƒç”¨ä¿¡æ¯</li>\n</ul>\n<p>è¿™ç§è®¾è®¡ä½¿å¾—ç³»ç»Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°å°† LLM çš„å·¥å…·è°ƒç”¨è¯·æ±‚è·¯ç”±åˆ°æ­£ç¡®çš„ç”¨æˆ·å®šä¹‰å‡½æ•°ï¼Œè€Œæ— éœ€ç¡¬ç¼–ç å…·ä½“çš„å‡½æ•°å¼•ç”¨ã€‚</p>\n<p><img alt=\"3-1\" class=\"lazyload\" /></p>\n<h5 id=\"ç”¨æˆ·å®šä¹‰çš„-function-tool-è½¬æ¢ä¸º-action\">ç”¨æˆ·å®šä¹‰çš„ Function Tool è½¬æ¢ä¸º Action</h5>\n<p>å½“ Agent è¢«ç¼–è¯‘æˆ AgentPlan æ—¶ï¼Œç³»ç»Ÿä¼šæ”¶é›†æ‰€æœ‰èµ„æºï¼ˆåŒ…æ‹¬å·¥å…·ï¼‰ ï¼Œè¿™äº›å·¥å…·ä¼šè¢«è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„ Actionï¼š</p>\n<ul>\n<li>åœ¨ _get_resource_providers å‡½æ•°ä¸­ï¼Œè¯†åˆ«å¸¦æœ‰ _is_tool å±žæ€§çš„èµ„æº</li>\n<li>ä½¿ç”¨ from_callable å°†å‡½æ•°è½¬æ¢ä¸ºå·¥å…·å¯¹è±¡</li>\n<li>å·¥å…·è¢«åŒ…è£…ä¸º ResourceProvider å¹¶å­˜å‚¨åœ¨ AgentPlan ä¸­ï¼Œå³é€šè¿‡ PythonSerializableResourceProvider åŒ…è£…å·¥å…·èµ„æº</li>\n</ul>\n<h5 id=\"å†…ç½®-tool-call-action\">å†…ç½® Tool Call Action</h5>\n<p>æ¡†æž¶æä¾›äº†ä¸€ä¸ªå†…ç½®çš„ TOOL_CALL_ACTIONï¼Œä¸“é—¨ç”¨äºŽè°ƒç”¨å·¥å…·ï¼š</p>\n<pre><code class=\"language-python\">TOOL_CALL_ACTION = Action(\n    name=\"tool_call_action\",\n    exec=PythonFunction.from_callable(process_tool_request),\n    listen_event_types=[f\"{ToolRequestEvent.__module__}.{ToolRequestEvent.__name__}\"],\n)\n</code></pre>\n<p>å¯¹åº”Action ä¸ºToolCallActionï¼Œå…¶ä¸­ processToolRequest å‡½æ•°ä¼šä¸Žç”¨æˆ·è‡ªå®šä¹‰çš„å·¥å…·å‡½æ•°ç›¸äº’å…³è”ã€‚å…·ä½“è”ç³»æœºåˆ¶å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>å‘½ååŒ¹é…ï¼šå½“ LLM å†³å®šè°ƒç”¨æŸä¸ªå·¥å…·æ—¶ï¼Œå®ƒä¼šåœ¨ tool_call ä¸­æŒ‡å®šå·¥å…·åç§°ï¼ˆå¦‚ \"notify_shipping_manager\"ï¼‰</li>\n<li>èµ„æºæŸ¥æ‰¾ï¼šTOOL_CALL_ACTION ä½¿ç”¨è¿™ä¸ªåç§°é€šè¿‡ ctx.get_resource(name, ResourceType.TOOL) æŸ¥æ‰¾å·²æ³¨å†Œçš„å·¥å…·</li>\n<li>åŠ¨æ€è°ƒç”¨ï¼šæ‰¾åˆ°å·¥å…·åŽï¼Œé€šè¿‡ tool.call(**kwargs) è°ƒç”¨ç”¨æˆ·å®šä¹‰çš„å®žé™…å‡½æ•°</li>\n</ul>\n<pre><code class=\"language-java\">public class ToolCallAction {\n    public static Action getToolCallAction() throws Exception {\n        return new Action(\n                \"tool_call_action\",\n                new JavaFunction(\n                        ToolCallAction.class,\n                        \"processToolRequest\",\n                        new Class[] {ToolRequestEvent.class, RunnerContext.class}),\n                List.of(ToolRequestEvent.class.getName()));\n    }\n\n    @SuppressWarnings(\"unchecked\")\n    public static void processToolRequest(ToolRequestEvent event, RunnerContext ctx) {\n        Map&lt;String, Boolean&gt; success = new HashMap&lt;&gt;();\n        Map&lt;String, String&gt; error = new HashMap&lt;&gt;();\n        Map&lt;String, ToolResponse&gt; responses = new HashMap&lt;&gt;();\n        Map&lt;String, String&gt; externalIds = new HashMap&lt;&gt;();\n        for (Map&lt;String, Object&gt; toolCall : event.getToolCalls()) {\n            String id = String.valueOf(toolCall.get(\"id\"));\n            Map&lt;String, Object&gt; function = (Map&lt;String, Object&gt;) toolCall.get(\"function\");\n            String name = (String) function.get(\"name\");// èŽ·å–å·¥å…·åç§°\n            Map&lt;String, Object&gt; arguments = (Map&lt;String, Object&gt;) function.get(\"arguments\"); // èŽ·å–å·¥å…·å‚æ•°\n\n            if (toolCall.containsKey(\"original_id\")) {\n                externalIds.put(id, (String) toolCall.get(\"original_id\"));\n            }\n\n            Tool tool = null;\n            try {\n                // ä»Žä¸Šä¸‹æ–‡èŽ·å–å¯¹åº”åç§°çš„å·¥å…·èµ„æº\n                tool = (Tool) ctx.getResource(name, ResourceType.TOOL);\n            } catch (Exception e) {\n                success.put(id, false);\n                responses.put(\n                        id, ToolResponse.error(String.format(\"Tool %s does not exist.\", name)));\n                error.put(id, e.getMessage());\n            }\n\n            if (tool != null) {\n                try {\n                    // è°ƒç”¨ç”¨æˆ·å®žé™…å·¥å…·\n                    ToolResponse response = tool.call(new ToolParameters(arguments));\n                    success.put(id, true);\n                    responses.put(id, response);\n                } catch (Exception e) {\n                    success.put(id, false);\n                    responses.put(\n                            id, ToolResponse.error(String.format(\"Tool %s execute failed.\", name)));\n                    error.put(id, e.getMessage());\n                }\n            }\n        }\n        // è¿”å›žå·¥å…·å“åº”äº‹ä»¶\n        ctx.sendEvent(new ToolResponseEvent(event.getId(), responses, success, error, externalIds));\n    }\n}\n</code></pre>\n<p>è¿™ä¸ª action ç›‘å¬ ToolRequestEvent äº‹ä»¶ï¼Œå¹¶æ‰§è¡Œå·¥å…·è°ƒç”¨ã€‚è°ƒç”¨å®ŒæˆåŽï¼Œå°†ç»“æžœé€šè¿‡ ToolReponseEvent è¿”å›žã€‚</p>\n<pre><code class=\"language-json\">    \"tool_call_action\": {\n      \"name\": \"tool_call_action\",\n      \"exec\": {\n        \"func_type\": \"PythonFunction\",\n        \"module\": \"flink_agents.plan.actions.tool_call_action\",\n        \"qualname\": \"process_tool_request\"\n      },\n      \"listen_event_types\": [\n        \"flink_agents.api.events.tool_event.ToolRequestEvent\"\n      ]\n    }\n</code></pre>\n<h5 id=\"tool_call_action-å¦‚ä½•ç¼–è¯‘åˆ°agentplan\">TOOL_CALL_ACTION å¦‚ä½•ç¼–è¯‘åˆ°AgentPlan</h5>\n<ul>\n<li>\n<p>åœ¨ AgentPlan.from_agent æ–¹æ³•ä¸­ï¼š</p>\n<ul>\n<li>å½“åˆ›å»º AgentPlan æ—¶ï¼Œä¼šæ”¶é›†æ‰€æœ‰åŠ¨ä½œï¼ŒåŒ…æ‹¬ç”¨æˆ·å®šä¹‰çš„åŠ¨ä½œå’Œå†…ç½®åŠ¨ä½œ</li>\n<li>ä»£ç ä¸­æ˜Žç¡®åŒ…å«äº†å†…ç½®åŠ¨ä½œï¼š<br />\nBUILT_IN_ACTIONS = [CHAT_MODEL_ACTION, TOOL_CALL_ACTION, CONTEXT_RETRIEVAL_ACTION]</li>\n<li>åœ¨ _get_actions(agent) å‡½æ•°ä¸­ï¼Œè¿™äº›å†…ç½®åŠ¨ä½œä¼šè¢«æ·»åŠ åˆ°åŠ¨ä½œåˆ—è¡¨ä¸­</li>\n</ul>\n</li>\n<li>\n<p>å…·ä½“ç¼–è¯‘è¿‡ç¨‹ï¼š</p>\n<ul>\n<li>AgentPlan.from_agent() æ–¹æ³•è°ƒç”¨ _get_actions(agent) èŽ·å–æ‰€æœ‰åŠ¨ä½œ</li>\n<li>_get_actions() å‡½æ•°ä¸ä»…æå–ç”¨æˆ·å®šä¹‰çš„åŠ¨ä½œï¼Œè¿˜ä¼šåŒ…å« BUILT_IN_ACTIONS</li>\n<li>è¿™äº›åŠ¨ä½œéšåŽè¢«ç¼–è¯‘è¿› AgentPlan çš„ actions å’Œ actions_by_event å­—æ®µä¸­</li>\n</ul>\n</li>\n<li>\n<p>åœ¨æœ€ç»ˆçš„ AgentPlan ä¸­ï¼š</p>\n<ul>\n<li>TOOL_CALL_ACTION ä¼šä½œä¸ºä¸€ä¸ªæ™®é€šçš„åŠ¨ä½œå­˜åœ¨äºŽ actions æ˜ å°„ä¸­</li>\n<li>å®ƒä¼šç›‘å¬ ToolRequestEvent äº‹ä»¶ç±»åž‹ï¼Œå¹¶åœ¨è¯¥äº‹ä»¶å‘ç”Ÿæ—¶è¢«è§¦å‘æ‰§è¡Œ</li>\n</ul>\n</li>\n</ul>\n<p>å› æ­¤ï¼ŒTOOL_CALL_ACTION ç¡®å®žä¼šè¢«ç¼–è¯‘åˆ° AgentPlan ä¸­ï¼Œä½œä¸ºå¤„ç†å·¥å…·è°ƒç”¨çš„æ ‡å‡†æœºåˆ¶ã€‚å½“ LLM å†³å®šè°ƒç”¨å·¥å…·æ—¶ï¼Œä¼šå‘å‡º ToolRequestEventï¼Œç„¶åŽ TOOL_CALL_ACTION å°±ä¼šè¢«è§¦å‘æ¥å®žé™…æ‰§è¡Œç›¸åº”çš„å·¥å…·è°ƒç”¨ã€‚</p>\n<h4 id=\"373-å·¥å…·è°ƒç”¨æµç¨‹\">3.7.3 å·¥å…·è°ƒç”¨æµç¨‹</h4>\n<p>æ•´ä¸ªæµç¨‹ä¸­ï¼Œå·¥å…·ä¸æ˜¯ç›´æŽ¥ç»‘å®šåˆ° ActionExecutionOperatorï¼Œè€Œæ˜¯é€šè¿‡ AgentPlan ä¸­çš„èµ„æºæä¾›è€…æœºåˆ¶ï¼Œåœ¨éœ€è¦æ—¶åŠ¨æ€èŽ·å–å’Œå®žä¾‹åŒ–ã€‚è¿™ç§è®¾è®¡å®žçŽ°äº†å·¥å…·ä¸Žæ“ä½œç¬¦çš„æ¾è€¦åˆï¼ŒåŒæ—¶æ”¯æŒå¤šç§ç±»åž‹çš„å·¥å…·ï¼ˆJavaã€Python ç­‰ï¼‰ã€‚</p>\n<ul>\n<li>LLM å†³å®šè°ƒç”¨æŸä¸ªå·¥å…·</li>\n<li>TOOL_CALL_ACTION å†…ç½®åŠ¨ä½œè¢«è§¦å‘</li>\n<li>é€šè¿‡ RunnerContext èŽ·å–å¯¹åº”å·¥å…·èµ„æº</li>\n<li>RunnerContextImpl.get_resource() æ–¹æ³•æ ¹æ®åç§°å’Œç±»åž‹æŸ¥æ‰¾å·¥å…·èµ„æº</li>\n<li>å·¥å…·å®žé™…åœ¨éœ€è¦æ—¶æ‰é€šè¿‡ ResourceProvider å®žä¾‹åŒ–</li>\n<li>é€šè¿‡ ToolCallFunction æŸ¥æ‰¾å¹¶æ‰§è¡Œç›¸åº”çš„å·¥å…·å‡½æ•°</li>\n<li>ç»“æžœä½œä¸ºæ–°äº‹ä»¶å‘é€åˆ°äº‹ä»¶é˜Ÿåˆ—</li>\n</ul>\n<h4 id=\"374-å®Œæ•´æµç¨‹å›¾\">3.7.4 å®Œæ•´æµç¨‹å›¾</h4>\n<p><img alt=\"3-2\" class=\"lazyload\" /></p>\n<h4 id=\"375-ä»£ç \">3.7.5 ä»£ç </h4>\n<p>åœ¨ agent_plan.pyä¸­å¤„ç†å·¥å…·èµ„æºçš„ä»£ç å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-python\">        # è¯†åˆ«å·¥å…·èµ„æºå¹¶åˆ›å»ºæä¾›è€…\n        elif hasattr(value, \"_is_tool\"):\n            if isinstance(value, staticmethod):\n                value = value.__func__\n\n            if callable(value):\n                # TODO: support other tool type.\n                tool = from_callable(func=value)\n                resource_providers.append(\n                    PythonSerializableResourceProvider.from_resource(\n                        name=name, resource=tool\n                    )\n                )\n    # æˆ–è€…é€šè¿‡add_resource æ·»åŠ çš„å·¥å…·            \n    for name, tool in agent.resources[ResourceType.TOOL].items():\n        resource_providers.append(\n            PythonSerializableResourceProvider.from_resource(\n                name=name, resource=from_callable(tool.func)\n            )\n        )                \n</code></pre>\n<p>æ€»ç»“æ¥è¯´ï¼Œfunction_tool  é€šè¿‡èµ„æºæ³¨å†Œæœºåˆ¶ä¸ŽAgentå…³è”ï¼Œç„¶åŽåœ¨ç¼–è¯‘é˜¶æ®µè¢«è½¬æ¢ä¸ºå¯åºåˆ—åŒ–çš„èµ„æºæä¾›è€…ï¼Œæœ€ç»ˆé€šè¿‡å†…ç½®çš„å·¥å…·è°ƒç”¨Actionæ¥æ‰§è¡Œã€‚è¿™ç§è®¾è®¡ä½¿å¾—å·¥å…·å¯ä»¥åœ¨åˆ†å¸ƒå¼çŽ¯å¢ƒç§æ­£ç¡®ä¼ è¾“å’Œæ‰§è¡Œã€‚</p>\n<h2 id=\"0xff-å‚è€ƒ\">0xFF å‚è€ƒ</h2>\n<p><a href=\"https://ce101.mintlify.app/core-tech/agent#7-2-5-multi-agent\" rel=\"noopener nofollow\" target=\"_blank\">https://ce101.mintlify.app/core-tech/agent#7-2-5-multi-agent</a></p>\n<p><a href=\"https://www.zhihu.com/question/1959742114519844109/answer/1983526566437880277\" rel=\"noopener nofollow\" target=\"_blank\">https://www.zhihu.com/question/1959742114519844109/answer/1983526566437880277</a></p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2025-12-31 19:17</span>&nbsp;\n<a href=\"https://www.cnblogs.com/rossiXYZ\">ç½—è¥¿çš„æ€è€ƒ</a>&nbsp;\né˜…è¯»(<span id=\"post_view_count\">70</span>)&nbsp;\nè¯„è®º(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">æ”¶è—</a>&nbsp;\n<a href=\"\">ä¸¾æŠ¥</a>\n</div>"
    },
    {
      "title": "从后端获取数据传输到前端进行显示(cpp-httplib+Vditor+Handlebars)",
      "link": "https://www.cnblogs.com/charlee44/p/19431854",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/charlee44/p/19431854\" id=\"cb_post_title_url\" title=\"发布于 2026-01-02 13:53\">\n    <span>从后端获取数据传输到前端进行显示(cpp-httplib+Vditor+Handlebars)</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        通过 cpp-httplib 后端提供 Markdown 文章的 JSON API，前端使用 Vite + Handlebars + Vditor 实现动态渲染与目录交互，完成了一个简单的前后端分离博客展示系统。\n    </div>\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\">\n<h1 id=\"1-引言\">1. 引言</h1>\n<p>在之前的文章中，笔者实现了一个渲染 Markdown 格式文章的网页前端 Vite 项目（参看<a href=\"https://charlee44.com/post.html?id=1f8bf6fca114499fb1db7e15e9777ac7\" rel=\"noopener nofollow\" target=\"_blank\">《给 Markdown 渲染网页增加一个目录组件(Vite+Vditor+Handlebars)》</a>）,以及一个支持 Markdown格式数据的静态文件服务的后端项目（参看<a href=\"https://charlee44.com/post.html?id=ae7a9a676916493f8f73c6217273b7eb\" rel=\"noopener nofollow\" target=\"_blank\">《使用cpp-httplib发布静态文件服务》</a>）。在这里，就将前端与后端打通，通过 cpp-httplib 提供的 API 接口动态返回 Markdown 文章数据，由前端 Vite 项目利用 Handlebars 模板与 Vditor 渲染引擎完成展示与交互。</p>\n<h1 id=\"2-实现\">2. 实现</h1>\n<h2 id=\"21-后端\">2.1 后端</h2>\n<p>JSON 是 HTTP 传输中事实上的标准数据格式，尤其是在现代 Web API（特别是 RESTful API）中，因此我们将后端的接口改成返回 JSON 格式数据的接口。按照 RESTful API 风格，命名为 <code>/api/v1/post</code>，使用 HTTP 的 Get 方法。具体代码如下：</p>\n<pre><code class=\"language-cpp\">#include &lt;httplib.h&gt;\n\n#include &lt;filesystem&gt;\n#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;nlohmann/json.hpp&gt;\n#include &lt;string&gt;\n\n#include \"BlogData.h\"\n\nusing namespace std;\nusing namespace nlohmann;\nnamespace fs = std::filesystem;\n\nint main() {\n  httplib::Server svr;\n\n  std::u8string docRoot =\n      u8\"D:/Work/HttpServer/public/最小二乘问题详解1：线性最小二乘\";\n\n  svr.Get(\"/api/v1/post\",\n          [&amp;](const httplib::Request&amp; req, httplib::Response&amp; res) {\n            DataTransfer::BlogData blogData;\n\n            {\n              fs::path blogMetaJsonPath = fs::path(docRoot) / \"meta.json\";\n              nlohmann::json blogMetaJson;\n              ifstream infile(blogMetaJsonPath);\n              infile &gt;&gt; blogMetaJson;\n              blogData.blogMeta = blogMetaJson;\n            }\n\n            {\n              fs::path blogContentPath =\n                  fs::path(docRoot) / u8\"最小二乘问题详解1：线性最小二乘.md\";\n              std::ifstream file(blogContentPath, std::ios::binary);\n\n              std::string content((std::istreambuf_iterator&lt;char&gt;(file)),\n                                  std::istreambuf_iterator&lt;char&gt;());\n              blogData.content = std::move(content);\n            }\n\n            // 构造响应 JSON\n            json response_data = blogData;\n\n            // 设置响应\n            res.set_header(\"Access-Control-Allow-Origin\",\n                           \"http://127.0.0.1:8000\");  // 允许跨域\n            res.set_content(response_data.dump(), \"application/json\");\n          });\n\n  std::cout &lt;&lt; \"Server listening on http://127.0.0.1:8080\\n\";\n  svr.listen(\"0.0.0.0\", 8080);\n\n  return 0;\n}\n</code></pre>\n<p>这段代码的实现非常简单，分别读取元数据 <code>meta.json</code> 和 文章内容 <code>最小二乘问题详解1：线性最小二乘.md</code> 文件，组织成 JSON 格式，设置到 HTTP 响应的内容中并且返回。其中，用到 nlohmann/json 对 结构体对象序列化和反序列化（参考<a href=\"https://charlee44.com/post.html?id=d5736f77509345b2a66a2de4a70beb31\" rel=\"noopener nofollow\" target=\"_blank\">《C++中JSON序列化和反序列化的实现》</a>）。</p>\n<p>另外需要注意的就是跨域问题。由于前端项目与后端项目是分离的，因此它们处在不同的域中，前端要请求后端的资源，就会发生跨域问题。解决办法就是在 HTTP 的响应头中设置允许跨域的键和值：</p>\n<pre><code class=\"language-cpp\">res.set_header(\"Access-Control-Allow-Origin\", \"http://127.0.0.1:8000\");  // 允许跨域\n</code></pre>\n<h2 id=\"22-前端\">2.2 前端</h2>\n<p>前端的修改就简单多了，只需要修改获取远端数据的接口就可以了：</p>\n<pre><code class=\"language-cpp\">const response = await fetch(\"http://127.0.0.1:8080/api/v1/post\");\nif (!response.ok) {\n    throw new Error(\"网络无响应\");\n}\nconst blogData = await response.json();\n//...\n</code></pre>\n<p>其实这也是前后端分离的优势，后端提供数据资源的获取，前端则负责数据的可视化。最终的效果如下所示：</p>\n<p><img alt=\"从后端访问数据到前端进行展示\" class=\"lazyload\" /></p>\n<h1 id=\"3-其他\">3. 其他</h1>\n<p>以上就是一个最简单的前后端分离 Web 项目。任何复杂功能都可以在此基础上进行扩展，只需搭配相应的架构设计，以更好地支持具体业务需求。</p>\n<p><a href=\"https://download.csdn.net/download/charlee44/92492805\" rel=\"noopener nofollow\" target=\"_blank\">实现代码</a></p>\n\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-02 13:53</span>&nbsp;\n<a href=\"https://www.cnblogs.com/charlee44\">charlee44</a>&nbsp;\n阅读(<span id=\"post_view_count\">0</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    },
    {
      "title": "手把手搞定FastAPI静态文件：安全、上传与访问",
      "link": "https://www.cnblogs.com/ymtianyu/p/19431849",
      "published": "",
      "description": "<h1 class=\"postTitle\">\n                <a class=\"postTitle2 vertical-middle\" href=\"https://www.cnblogs.com/ymtianyu/p/19431849\" id=\"cb_post_title_url\" title=\"发布于 2026-01-02 13:47\">\n    <span>手把手搞定FastAPI静态文件：安全、上传与访问</span>\n    \n\n</a>\n\n            </h1>\n            <div class=\"clear\"></div>\n            <div class=\"postBody\">\n                    <div id=\"cnblogs_post_description\" style=\"display: none;\">\n        \n        本文系统讲解了FastAPI框架中静态文件的加载、存储、安全设置以及媒体文件上传等核心功能，通过具体代码示例详细说明了如何挂载静态目录、设置安全防护、处理favicon请求和实现文件上传接口，并提供了一个可直接运行的完整实战案例，帮助开发者快速掌握在FastAPI项目中高效安全地管理各类文件资源。\n    </div>\n<div class=\"blogpost-body blogpost-body-html\" id=\"cnblogs_post_body\">\n<div>\n<p style=\"font-size: 18px; font-weight: bold; color: rgba(26, 26, 26, 1);\">你的FastAPI应用还在“裸奔”吗？超过70%的Web应用安全问题源于静态资源的不当配置！</p>\n<blockquote style=\"padding: 10px 15px; margin: 20px 0; background-color: rgba(249, 249, 249, 1); color: rgba(85, 85, 85, 1); font-style: italic;\">这篇文章将带你系统掌握FastAPI中静态文件处理的方方面面，不止是简单的“挂载”，更涵盖安全防护、性能技巧和实战坑点，包含一个可直接运行的完整示例。 <br /><br />- 📂 静态文件的加载、存储与应用场景<br />- 🛡️ 至关重要的静态文件安全设置<br />- 🎯 一行代码搞定网站favicon<br />- 🖼️ 处理图片等媒体文件的上传与访问</blockquote>\n<h2 style=\"color: rgba(44, 62, 80, 1); padding-bottom: 5px;\">✨ 目录一览</h2>\n<p>- 🚀 起步：为什么需要处理静态文件？<br />- 📁 FastAPI的“文件管家”：StaticFiles<br />- 🔒 给静态文件加把“锁”：安全设置详解<br />- ⭐ 小图标大学问：Favicon的处理<br />- 🎬 不止于图片：媒体文件的上传与响应<br />- 🧪 实战演练：一个完整的示例应用</p>\n<h2 style=\"color: rgba(44, 62, 80, 1); padding-bottom: 5px;\">🚀 起步：为什么需要处理静态文件？</h2>\n<p>你的API很酷，但用户访问 <code>http://localhost:8000/logo.png</code> 却得到404？这是因为FastAPI默认是个纯粹的API框架，<strong style=\"color: rgba(186, 55, 42, 1);\">它不会自动提供像图片、CSS、JavaScript这样的静态文件。</strong></p>\n<p>静态文件是那些内容固定、不经常改变的文件。它们对于构建一个完整的Web应用或API文档门户至关重要。</p>\n<h2 style=\"color: rgba(44, 62, 80, 1); padding-bottom: 5px;\">📁 FastAPI的“文件管家”：StaticFiles</h2>\n<p>引入<code>StaticFiles</code>，你就能轻松搭建一个文件服务器。其核心三步法：</p>\n<p>- 导入：<code>from fastapi.staticfiles import StaticFiles</code><br />- 挂载：将URL路径“挂载”到一个实际目录。<br />- 应用：使用<code>app.mount</code>方法。</p>\n<pre class=\"language-python highlighter-hljs\"><code>from fastapi import FastAPI\nfrom fastapi.staticfiles import StaticFiles\n\napp = FastAPI()\n\n# 将路径 “/static” 映射到项目下的 “static” 目录\napp.mount(\"/static\", StaticFiles(directory=\"static\"), name=\"static\")</code></pre>\n<p><strong style=\"color: rgba(186, 55, 42, 1);\">理解“挂载”</strong>：它意味着所有访问<code>/static/*</code>的请求，都会由<code>StaticFiles</code>实例去<code>./static</code>目录下查找对应文件。它不是API路由，而是一个独立的子应用。</p>\n<h2 style=\"color: rgba(44, 62, 80, 1); padding-bottom: 5px;\">🔒 给静态文件加把“锁”：安全设置详解</h2>\n<p>开放文件访问是危险的！错误的配置可能导致敏感文件泄露（如<code>.env</code>、<code>.git</code>目录）。</p>\n<p>1. <strong style=\"color: rgba(186, 55, 42, 1);\">限制目录访问范围</strong>：永远不要将根目录“<code>/</code>”挂载到静态文件服务。务必使用一个独立的、权限明确的子目录（如<code>static</code>、<code>assets</code>）。</p>\n<p>2. <strong style=\"color: rgba(186, 55, 42, 1);\">使用“html=True”安全地提供HTML</strong>：如果你想提供单页应用（如Vue/React构建的产物），可以设置<code>html=True</code>，并让<code>index.html</code>作为目录的默认页。</p>\n<pre class=\"language-python highlighter-hljs\"><code># 安全地提供前端构建产物目录\napp.mount(\"/app\", StaticFiles(directory=\"./frontend/dist\", html=True), name=\"spa_app\")</code></pre>\n<p>注意：<code>html=True</code>只对提供前端SPA友好，它本身并不是一个安全漏洞。真正的安全在于对<code>directory</code>参数的控制。</p>\n<h2 style=\"color: rgba(44, 62, 80, 1); padding-bottom: 5px;\">⭐ 小图标大学问：Favicon的处理</h2>\n<p>浏览器会自动请求<code>/favicon.ico</code>。如果你没处理，日志里就会堆满404错误，显得不专业。</p>\n<p>最简单的方法：直接把它当成一个静态文件处理。</p>\n<pre class=\"language-python highlighter-hljs\"><code># 方法：为favicon.ico单独设置一个路径路由（或将它放在static目录）\nfrom fastapi.responses import FileResponse\n\n@app.get(\"/favicon.ico\")\nasync def favicon():\n    return FileResponse(\"static/favicon.ico\")</code></pre>\n<p>这能一劳永逸地消除那个烦人的404请求。</p>\n<h2 style=\"color: rgba(44, 62, 80, 1); padding-bottom: 5px;\">🎬 不止于图片：媒体文件的上传与响应</h2>\n<p>静态文件是“读”，媒体文件则常涉及“写”（上传）。FastAPI处理上传非常优雅。</p>\n<p>- <strong style=\"color: rgba(186, 55, 42, 1);\">上传</strong>：使用<code>File</code>和<code>UploadFile</code>。<br />- <strong style=\"color: rgba(186, 55, 42, 1);\">存储</strong>：使用<code>shutil</code>或<code>aiofiles</code>写入特定目录（如<code>media/</code>）。<br />- <strong style=\"color: rgba(186, 55, 42, 1);\">访问</strong>：再次借助<code>StaticFiles</code>挂载<code>media/</code>目录。</p>\n<pre class=\"language-python highlighter-hljs\"><code>from fastapi import File, UploadFile\nimport shutil\nimport os\n\nUPLOAD_DIR = \"media\"\nos.makedirs(UPLOAD_DIR, exist_ok=True)\n\n@app.post(\"/upload/image/\")\nasync def upload_image(file: UploadFile = File(...)):\n    file_path = os.path.join(UPLOAD_DIR, file.filename)\n    with open(file_path, \"wb\") as buffer:\n        shutil.copyfileobj(file.file, buffer)\n    return {\"filename\": file.filename, \"url\": f\"/media/{file.filename}\"}\n\n# 挂载上传的媒体文件目录\napp.mount(\"/media\", StaticFiles(directory=\"media\"), name=\"media\")</code></pre>\n<h2 style=\"color: rgba(44, 62, 80, 1); padding-bottom: 5px;\">🧪 实战演练：一个完整的示例应用</h2>\n<p>下面是一个整合了上述所有知识点的完整<code>main.py</code>文件，复制即可运行体验。</p>\n<pre class=\"language-python highlighter-hljs\"><code>from fastapi import FastAPI, File, UploadFile, Request\nfrom fastapi.staticfiles import StaticFiles\nfrom fastapi.responses import FileResponse, HTMLResponse\nimport shutil\nimport os\nfrom pathlib import Path\n\napp = FastAPI()\n\n# 1. 创建必要的目录\nstatic_dir = Path(\"static\")\nmedia_dir = Path(\"media\")\nstatic_dir.mkdir(exist_ok=True)\nmedia_dir.mkdir(exist_ok=True)\n\n# 2. 挂载静态文件目录（存放CSS，JS，预置图片）\napp.mount(\"/static\", StaticFiles(directory=static_dir), name=\"static\")\n\n# 3. 挂载媒体文件目录（存放用户上传的图片）\napp.mount(\"/media\", StaticFiles(directory=media_dir), name=\"media\")\n\n# 4. 处理favicon请求\n@app.get(\"/favicon.ico\", include_in_schema=False)\nasync def get_favicon():\n    # 假设你的favicon.ico放在static目录下\n    return FileResponse(static_dir / \"favicon.ico\")\n\n# 5. 文件上传接口\n@app.post(\"/upload/\")\nasync def create_upload_file(file: UploadFile = File(...)):\n    # 保存上传的文件到media目录\n    save_path = media_dir / file.filename\n    with save_path.open(\"wb\") as buffer:\n        shutil.copyfileobj(file.file, buffer)\n    # 返回文件的访问URL\n    return {\"url\": f\"/media/{file.filename}\"}\n\n# 6. 一个简单的前端页面，用于演示和测试上传\n@app.get(\"/\", response_class=HTMLResponse)\nasync def main():\n    return \"\"\"\n    &lt;html&gt;\n        &lt;head&gt;\n            &lt;title&gt;FastAPI静态文件演示&lt;/title&gt;\n        &lt;/head&gt;\n        &lt;body&gt;\n            &lt;h2&gt;上传图片测试&lt;/h2&gt;\n            &lt;form action=\"/upload/\" enctype=\"multipart/form-data\" method=\"post\"&gt;\n            &lt;input name=\"file\" type=\"file\"&gt;\n            &lt;input type=\"submit\"&gt;\n            &lt;/form&gt;\n            &lt;br&gt;\n            &lt;h3&gt;尝试访问：&lt;/h3&gt;\n            &lt;ul&gt;\n                &lt;li&gt;&lt;a href=\"/static/example.txt\"&gt;预置的静态文件 (/static/example.txt)&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;上传后，访问：&lt;code&gt;/media/[你的文件名]&lt;/code&gt;&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/body&gt;\n    &lt;/html&gt;\n    \"\"\"\n\nif __name__ == \"__main__\":\n    import uvicorn\n    uvicorn.run(app, host=\"0.0.0.0\", port=8000)</code></pre>\n<p>运行后，访问 <code>http://localhost:8000</code> 即可体验上传和访问文件。记得先在<code>static/</code>目录下放个<code>example.txt</code>文件。</p>\n<div style=\"text-align: center; margin: 30px 0;\">---</div>\n<p style=\"text-align: center; font-size: 0.9em; color: rgba(102, 102, 102, 1);\">喜欢本文？不要错过✨，点赞👍收藏⭐关注我👆，一起学习更多有用的知识，完善你我的技能树！也请路过的大佬给些建议和指教👉👈🥺！</p>\n</div>\n</div>\n<div class=\"clear\"></div>\n\n            </div>\n            <div class=\"postDesc\">posted @ \n<span id=\"post-date\">2026-01-02 13:47</span>&nbsp;\n<a href=\"https://www.cnblogs.com/ymtianyu\">曲幽</a>&nbsp;\n阅读(<span id=\"post_view_count\">7</span>)&nbsp;\n评论(<span id=\"post_comment_count\">0</span>)&nbsp;\n&nbsp;\n<a href=\"\">收藏</a>&nbsp;\n<a href=\"\">举报</a>\n</div>"
    }
  ]
}